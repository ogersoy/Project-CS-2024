# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
This document studies enhancements to the IMS architecture and stage 2
procedures in order to support the requirements defined by SA1 as part of
eWebRTCi (Enhancements to WEBRTC interoperability).
The output of this work will not require changes to existing WebRTC enabled
web browsers.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[3] 3GPP TS 33.203: \"Access security for IP based services\".
[4] 3GPP TS 23.204: \"Support of Short Message Service (SMS) over generic 3GPP
Internet Protocol (IP) access; Stage 2\".
[5] 3GPP TS 24.341: \"Support of SMS over IP networks; Stage 3\".
[6] 3GPP TS 23.237: \"IP Multimedia Subsystem (IMS) Service Continuity; Stage
2\".
[7] 3GPP TS 23.003: \"Numbering, addressing and identification\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] apply.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
WTPF WebRTC Third Party Function
# 4 Assumptions and architectural requirements
Editor\'s note: This clause contains Assumptions and Architectural
requirements that are valid for all features studied as part of this TR
Editor\'s note: Based on the split of the document into different features for
study, whether this clause is really needed may be revisited later in the TR
work.
\- Minimize the impacts to IMS core.
# 5 WebRTC support of IMS subscriptions corresponding to users managed by
third parties
## 5.0 General description
Editor\'s note: clause 5 is related with SA1 requirements where \"The
subscription corresponds to a class of users supported by the WebRTC
environment (e.g., enterprise associates) rather than a single end user\".
This scenario is IMS subscription corresponding to the third party managed
users. (e.g. corporate users or the users of a web service such as a game).
The possible characteristics of this scenario are:
The number of the third party managed users may scale from a small number to
huge number.
Public User Id(s) for the third party managed user which may contain a part
whose definition is left for a 3rd party (Corporate / Web service).This
supports flexibility for the 3rd party to manage their services and users.
A unique P/S-CSCF to support all the users from the same third party may not
be feasible because of the huge number of users.
## 5.1 Architectural requirements
The architecture shall fulfil the following requirements:
Support scalability from small number of Public User Id(s) to huge number of
Public User Id(s) which are managed by the third party.
## 5.2 Solutions
### 5.2.1 Solution 1: Single HSS subscription for an unbounded number of users
NOTE: In this clause, the words IMPU and Public User Id are synonyms.
#### 5.2.1.1 Principles
The solution is based on following principles
1 The operator and a 3rd party can agree on a subscription where the 3rd party
may be granted a range-IMPU (set of IMPU defined using wildcarding) and be
responsible of allocating individual IMPU within the scope of this range-IMPU.
\- A range-IMPU corresponds to a set of IMPU (called \"individual IMPU\") that
share the same IMS services (the same subscription). As opposed to wildcard
IMPU defined in pre-Rel13 releases, there is no global routing associated with
the range-IMPU, i.e. different individual IMPU related with a range-IMPU may
be supported by different network functions (eP-CSCF, S-CSCF, AS...).
\- The number of users (\"individual IMPU\") of the 3rd party (service on WWW,
corporate,...) associated with a range-IMPU may be unbounded
\- The Third party and the IMS operator need only to negotiate one single
range-IMPU regardless of the number of individual users the Third party is
intending to manage. When the \"customer base\" of the Third party grows, the
Third party does not need to ask for more range-IMPU.
\- Any user corresponding to a Third party (user associated with the range-
IMPU negotiated with a Third party) may be served by any S-CSCF that supports
the feature: Users corresponding to a Third party may be spread onto all
S-CSCF that support the feature
\- Any User corresponding to a Third party (users associated with the range-
IMPU negotiated with the Third party) may be served by any eP-CSCF that is
configured to accept the security token from that Third party.
There is one HSS record for a range-IMPU. The HSS record for a range- IMPU
contains subscription data shared by all individual IMPU potentially
identified by the range-IMPU. The range-IMPU is not meant to be registered.
There is no record in HSS per individual IMPU. The structure of range-IMPU
needs to allow distinguishing range-IMPU from wildcard IMPU defined in pre-
Rel13 releases.
NOTE 1: For example such range-IMPU may be defined as  or  where \"my-game\"
is responsible of allocating individual IMPU within that scope. Nevertheless
all the capabilities currently allowed for wildcarding e.g. defining a set of
URIs via a full regular expression is allowed.
3 Terminating calls to individual IMPU are supported.
4 When the IMS registration of an individual IMPU takes place (including the
allocation of the S-CSCF for this individual IMPU and the retrieval of user
subscription from the HSS):
\- The 3rd party is responsible of (where needed) authenticating the end-user
and of allocating individual IMPU within the scope of the range-IMPU
\- The registration mechanisms described in TS 23.228 [2], Annex U.2.1.4 \"WIC
registration of individual Public User Identity from a pool of Public User
Identities\" support the corresponding procedures but need to be updated with
regard to the mapping between S-CSCF and individual IMPU.
\- The range-IMPU of a single HSS subscription may correspond to multiple
IMPI. In that case, in order to avoid that the Third party has to manage IMPI,
an optimization may consist in upgrading Cx in order that the HSS does not
check the IMPI it receives from I-CSCF in UAR.
\- After the registration of an individual IMPU, a binding is made for an
individual IMPU on the eP-CSCF. The eP-CSCF is then referenced (via Path
header data) from the registry on the S-CSCF for the individual IMPU (The
entity that is registered and identified on the eP-CSCF and on the S-CSCF is
not the range-IMPU but the individual IMPU)
NOTE 1: The solution aims at spreading the users of the 3rd party on various
eP-CSCF/ S-CSCF. It does not rely on routing per block of IMPU as was defined
for business trunking. Thus the registration of an individual IMPU within a
range- IMPU on an eP-CSCF / S-CSCF does not mean that the whole range-IMPU is
registered on this eP-CSCF / S-CSCF.
5 The HSS does not perform registration for an individual IMPU: there is no
storage of the S-CSCF serving an individual IMPU in the HSS as there is no
individual record in HSS for each individual IMPU / end-user that uses the
service of the 3rd party.
\- an assigned S-CSCF is not stored in the HSS for the range-IMPU itself
allowing I-CSCF to continue selecting S-CSCF (among a pool of S-CSCF) for each
individual IMPU that is registers. From the HSS perspective the range-IMPU
remains at the UN-REGISTERED state.
\- if not all S-CSCFs in operator\'s network are enhanced to support the
requirements from this solution, specific S-CSCF capability needs to be
provisioned in HSS indicating support of registration for individual IMPU
within the range-IMPU, in order for I-CSCF to select proper S-CSCF.
6 (in order to support incoming sessions) The relationship between individual
IMPU and S-CSCF is stored in another DB: the WUDB (\"WWW users DB\")
Editor\'s note: Whether other entities may also query WUBD, e.g. an AS is FFS.
7 I-CSCF are modified to consider the IMPU belonging to the domain associated
with WWW users (e.g. *.*.www@operator.com) as some kind of PSI: for any
incoming request, they look up the WUDB (instead of issuing a LIR to the HSS).
8 The range-IMPU corresponds to a pattern that is detected by I-CSCF and
S-CSCF as having a specific behaviour with regard to registration, i.e. by
analysis of the IMPU (as currently done for PSI -- Public Service Identity)
the S/I-CSCF can detect that the registration status of such IMPU is not
managed by the HSS,
9 WUDB/HSS status information need not be aligned as HSS stores the generic
subscription data that is valid for all IMPUs of the range-IMPU and does not
store the association between individual IMPU and S-CSCF while the WUDB only
stores the association between individual IMPU and S-CSCF.
10 There can be multiple contacts associated with an allocated IMPU. This
happens if the same user registers from two or more different WICs. These
different contacts may be supported by different eP-CSCF. Multi-registration
of individual IMPU and Forking are supported as described in clause 5.2.1.3.
11 As there is only one record in the HSS for an IMPU range, hence for
different terminals (that correspond to different data sessions), the usage of
following features is not assumed by this solution as for business trunking:
\- Allocation of a STN-SR or retrieval of UE SRVCC capabilities from the HSS.
Anyhow no procedure is defined that allows WebRTC clients to support SRVCC.
\- T-ADS related procedures involving the HSS. Anyhow no procedure is defined
that allows WebRTC clients to support T-ADS.
\- Retrieval of the location of an individual IMPU via the HSS. Network
provided location retrieval is still possible using PCC.
\- P-CSCF restoration using the HSS. P-CSCF restoration is still possible
using PCC.
\- Retrieval of the S-CSCF name from the HSS. The AS are assumed to get the
identity of the S-CSCF serving an UE via the iFC trigger from S-CSCF at the
registration of an individual IMPU.
12 The HSS is not modified by the solution: at registration, the S-CSCF issues
a SAR with a Server Assignment Type set to \"NO_ASSIGNMENT\" to request from
HSS the user profile without affecting the registration state of the IMPU and
the range IMPU remains non registered as seen by the HSS. Then the HSS is not
involved by the handling of originating / terminating calls targeting an
individual IMPU related with a range-IMPU subscription.
13 If S-CSCF restoration procedures need to be supported for IMPU associated
with a range-IMPU subscription, then the S-CSCF needs to store/get the
Restoration-Info in the WUDB and not in the HSS.
14 Service resiliency at the failure of a CSCF is defined in clause 5.2.1.3.4.
15 There is no need to align the WUDB and the HSS with regard to the IMPI as
the WUDB does not store IMPI.
16 A service profile modification for a Third party subscription is supported
as for baseline users: the HSS profile is updated and the subscription profile
pushed to the S-CSCF over Cx.
#### 5.2.1.2 Architecture
##### 5.2.1.2.1 Overview
Figure 5.2.1.2.1-1
The architecture correspond to the architecture of Rel-12 TS 23.228 [2], Annex
U augmented with the addition of:
WUDB WWW users DB: Database storing the relationship between an individual
IMPU and the S-CSCF serving that IMPU; There is one logical WUDB in the
network.
W6 Interface between the S-CSCF and the WUDB: the S-CSCF stores / removes in
WUDB the association between an individual IMPU and the S-CSCF serving that
IMPU;
W7 Interface between the I-CSCF and the WUDB: the I-CSCF reads in WUDB the
association between an individual IMPU and the S-CSCF serving that IMPU.
##### 5.2.1.2.2 Routing and usage of IMPU
This clause describes a solution for the case of a Third party 1) signing an
agreement with an IMS provider \"MNO\" and 2) wanting its users to be
addressed with a domain belonging to this Third party: e.g. \"xyz@third-party-
abc.com\".
When a peer initiates a session towards a user of this 3rd party, the session
targets the domain of the Third party (e.g. xyz@third-party-abc.com). In order
to ensure that the session is re-routed to an I-CSCF of the MNO, the Third
party needs to deploy a DNS server that, when being looked up for the domain
of the Third party, answers to NAPTR requests with the FQDN of I-CSCF of the
MNO (transforms a request for sip service in the domain of this Third party
onto a FQDN targeting the MNO e.g.third-party-abc.mno.com)
NOTE: This may e.g. take the form of IN NAPTR 100 50 \"s\" \"sip+D2T \" \"\"
third-party-abc.mno.com with \"s\" indicating that next step is to obtain SRV
record from third-party-abc.mno.com.
#### 5.2.1.3 Flows
##### 5.2.1.3.1 Flows related with the registration
##### 5.2.1.3.1.1 Registration information flow -- User not registered
{#registration-information-flow-user-not-registered .H6}
Figure 5.2.1.3.1.1: Registration -- User not registered
1\. Per existing procedures of Annex U of TS 23.228 [2], clause U.2.1.4.
2\. Per existing procedures of Annex U of TS 23.228 [2], clause U.2.1.4.
3\. The I-CSCF determines that the target Public User Identity belongs to the
set of identities for which the S-CSCF is not stored in the HSS but in the
WUDB. This determination may use the detection of the specific pattern
associated with Public User Identity related with a range-IMPU. It looks up
the WUDB for the S-CSCF name (WUDB Get (Public User Identity)).
4\. As the UE is not registered (there is no S-CSCF allocated to the
individual IMPU), the WUDB issues a rejection code and the Iâ€‘CSCF shall send a
Cx-Select-Pull Request to the HSS (Public User Identity, Private User
Identity, ePâ€‘CSCF network identifier) per existing procedures of TS 23.228 [2]
(clause 5.2.2.3, step 3).
Cx-Select-Pull Response is sent from the HSS to the Iâ€‘CSCF per existing
procedures of TS 23.228 [2] (clause 5.2.2.3, step 4) , including specific
S-CSCF capability indicating support of registration for individual IMPU
within the range-IMPU.
5\. (per existing procedures of TS 23.228 [2], clause 5.2.2.3, step 5) The
Iâ€‘CSCF shall determine the address of a candidate Sâ€‘CSCF based on S-CSCF
capability received from Cx-Select-Pull Response and forward the registration
Request to that S-CSCF.
6\. The S-CSCF determines that the target Public User Identity belongs to the
set of identities for which the S-CSCF is not stored in the HSS but in the
WUDB. Then the Sâ€‘CSCF shall send Cx-Pull (Public User Identity, Private User
Identity, Sâ€‘CSCF name) to the HSS while no Cx-Put is requested from the HSS.
NOTE: This corresponds to a SAR with a Server Assignment Type set to
\"NO_ASSIGNMENT\" to request from HSS the user profile without affecting the
registration state of those identities.
The HSS shall NOT store the Sâ€‘CSCF name for that user (No Cx-Put) and shall
return the Cx-Pull Response (user information) to the Sâ€‘CSCF. The user
information passed from the HSS to the Sâ€‘CSCF is as described in TS 23.228 [2]
(clause 5.2.2.3, step 7.
7\. The Sâ€‘CSCF shall send WUDB-Put (Public User Identity, Sâ€‘CSCF name) to the
WUDB. The WUDB stores the association in its DB and removes any previous
association.
8\. Based on the filter criteria, the Sâ€‘CSCF shall send register information
to the service control platform and perform whatever service control
procedures are appropriate. This allows the AS to get the identity of the
S-CSCF allocated to the individual IMPU.
9\. The Sâ€‘CSCF shall return the 200 OK information flow (home network contact
information, a GRUU set) to the Iâ€‘CSCF.
10\. The Iâ€‘CSCF shall send information flow 200 OK (home network contact
information, a GRUU set) to the Pâ€‘CSCF. The Iâ€‘CSCF shall release all
registration information after sending information flow 200 OK.
11\. The Pâ€‘CSCF shall store the home network contact information, and shall
send information flow 200 OK (a GRUU set) to the UE. The Pâ€‘CSCF may subscribe
at the PCRF to notifications of the status of the IMS Signalling connectivity
(see TS 23.203 [54] for more details).
If the S-CSCF receives the priority information of the MPS subscribed-UE as a
part of user profile from the HSS, the S-CSCF provides the priority
information to the P-CSCF and the P-CSCF stores this information for the MPS-
subscribed UE.
###### 5.2.1.3.1.2 Registration information flow -- User already registered
Figure 5.2.1.3.1.2: Registration -- User already registered
1\. Per existing procedures of Annex U of TS 23.228 [2], clause U.2.1.4.
2\. Per existing procedures of Annex U of TS 23.228 [2], clause U.2.1.4.
3\. The I-CSCF determines that the target Public User Identity belongs to the
set of identities for which the S-CSCF is not stored in the HSS but in the
WUDB. This determination may use the specific pattern associated with Public
User Identity related with a range-IMPU. It looks up the WUDB for the S-CSCF
name (WUDB Get (Public User Identity)).
4\. The WUDB answers with the identity of the S-CSCF.
5\. (per existing procedures of TS 23.228 [2]) The Iâ€‘CSCF shall forward the
registration Request to that S-CSCF.
6\. The S-CSCF determines that the target Public User Identity belongs to the
set of identities for which the S-CSCF is not stored in the HSS but in the
WUDB. Then the Sâ€‘CSCF shall send Cx-Pull (Public User Identity, Private User
Identity, Sâ€‘CSCF name) to the HSS while no Cx-Put is requested from the HSS.
NOTE: This corresponds to a SAR with a Server Assignment Type set to
\"NO_ASSIGNMENT\" to request from HSS the user profile without affecting the
registration state of those identities.
The HSS shall NOT store the Sâ€‘CSCF name for that user (No Cx-Put) and shall
return the Cx-Pull Response (user information) to the Sâ€‘CSCF. The user
information passed from the HSS to the Sâ€‘CSCF is as described in TS 23.228 [2]
(clause 5.2.2.3, step 7).
7\. The Sâ€‘CSCF shall send a WUDB-Put (Public User Identity, Sâ€‘CSCF name) to
the WUDB. The WUDB stores the association in its Data Base and removes any
previous association.
Note: Optionally as an optimisation, the Sâ€‘CSCF can detect that this is a re-
registration and omit the Cx- Pull /WUDB-Put request
8\. (per existing procedures of TS 23.228 [2]) Based on the filter criteria,
the Sâ€‘CSCF shall send register information to the service control platform and
perform whatever service control procedures are appropriate.
9\. (per existing procedures of TS 23.228 [2]) The Sâ€‘CSCF shall return the 200
OK information flow (home network contact information, a GRUU set) to the
Iâ€‘CSCF.
10\. (per existing procedures of TS 23.228 [2]) The Iâ€‘CSCF shall send
information flow 200 OK (home network contact information, a GRUU set) to the
Pâ€‘CSCF. The Iâ€‘CSCF shall release all registration information after sending
information flow 200 OK.
11\. (per existing procedures of TS 23.228 [2]) The ePâ€‘CSCF shall store the
home network contact information, and shall send information flow 200 OK (a
GRUU set) to the UE.
##### 5.2.1.3.1.3 De-registration information flow -- Mobile initiated {#de-
registration-information-flow-mobile-initiated .H6}
When the UE wants to de-register from the IMS then the UE shall perform
application level de-registration. De-registration is accomplished by a
registration with an expiration time of zero seconds. De-registration follows
the same path as defined in clause 5.2.1.3.1.1 \"Registration Information Flow
-- User not registered\".
Figure 5.2.1.3.1.3: De-registration - user currently registered
1\. The UE decides to initiate de-registration. To de-register, the UE sends a
new REGISTER request with an expiration value of zero seconds to eP-CSCF.
2\. REGISTER request is forwarded to I-CSCF.
3\. The I-CSCF determines that the target Public User Identity belongs to the
set of identities for which the S-CSCF is not stored in the HSS but in the
WUDB. This determination may use the specific pattern associated with Public
User Identity related with a range-IMPU. It looks up the WUDB for the S-CSCF
name (WUDB Get (Public User Identity)).
4\. The Iâ€‘CSCF shall determine the address of the Sâ€‘CSCF and forward the
REGISTER request to that S-CSCF.
5\. Based on the filter criteria, the Sâ€‘CSCF shall send de-register
information to the service control platform and perform whatever service
control procedures are appropriate.
6\. The Sâ€‘CSCF shall send WUDB-Put (Public User Identity, clear Sâ€‘CSCF name)
to the WUDB. The WUDB removes the association between user and S-CSFB in the
DB. The S-CSCF does not need to send Cx-Put to the HSS because no user
specific information related with individual IMPU related with a range-IMPU is
stored in HSS.
7\. The Sâ€‘CSCF shall return the 200 OK information flow to the Iâ€‘CSCF. The
Sâ€‘CSCF may release all registration information regarding this specific
registration of the Public User Identity after sending information flow 200
OK.
8\. The Iâ€‘CSCF shall send information flow 200 OK to the ePâ€‘CSCF.
9\. The ePâ€‘CSCF shall send information flow 200 OK to the UE. The ePâ€‘CSCF
releases all registration information regarding this specific registration of
the Public User Identity after sending information flow 200 OK.
##### 5.2.1.3.1.4 De-registration information flow -- Network initiated {#de-
registration-information-flow-network-initiated .H6}
The procedure for Network Initiated De-registration due to a Registration
Timeout procedure is as described in TS 23.228 [2] (clause 5.3.2.1) with the
modification that the S-CSCF does not initiate a Cx-Put (towards the HSS) but
a WUDB-Put.
The procedure for administrative Network Initiated De-registration is as
described in TS 23.228 [2] (clause 5.3.2.2.1) with the modification that the
procedure is not initiated by the HSS but by the WUDB.
##### 5.2.1.3.2 Flows related with the session set-up, modification and
release
The flows related with session set-up, modification and release are not
modified apart from the flows related with the handling an incoming session by
an I-CSCF. Thus, only the procedure for mobile terminating call is described
in this clause.
Figure 5.2.1.3.2: Incoming session (user already registered)
1\. The I-CSCF receives an incoming INVITE.
2\. The I-CSCF determines that the target Public User Identity belongs to the
set of identities for which the S-CSCF is not stored in the HSS but in the
WUDB. The Iâ€‘CSCF queries the WUDB for the identity of the S-CSCF of the target
IMPU.
3\. The WUDB responds with the address of the current Sâ€‘CSCF for the
terminating user (individual IMPU). If the WUDB responds that the user is not
registered, the I-CSCF rejects the session with the appropriate code.
4\. Iâ€‘CSCF forwards the INVITE request to the Sâ€‘CSCF that will handle the
session termination.
5\. Sâ€‘CSCF invokes whatever service logic is appropriate for this session
setup attempt.
6\. The sequence continues with the message flows as in the case of a
\"regular\" IMS termination call.
##### 5.2.1.3.3 Support of Multi-registration and forking
The user may register a Public User Identity on multiple different WIC(s).
The first registration of the Public User Identity takes place as described in
clause 5.2.1.3.1.1: \"Registration -- User not registered\". The S-CSCF stores
the Path header towards the corresponding eP-CSCF
Subsequent registration of the same Public User Identity takes place as
described in clause 5.2.1.3.1.2: \"Registration -- User already registered\".
It may correspond to a different eP-CSCF than the one used for the first /
other registration(s) of the Public User Identity onto different WIC(s) but
the mechanisms described in clause 5.2.1.3.1.2 ensure that the same S-CSCF is
used for all the registrations. The S-CSCF stores the Path header towards the
corresponding eP-CSCF that corresponds to the current new registration.
When a Public User Identity that is registered on multiple WIC(s) is targeted
by an incoming session, the S-CSCF applies the same forking algorithm than
defined for a regular Public User Identity. If the same user (Public User
Identity) happens to be registered on different WIC(s) served by the same eP-
CSCF, the forking, as for regular IMS users, takes place at the S-CSCF (as the
different registrations are associated with different Contacts).
##### 5.2.1.3.4 Service resiliency at the failure of a CSCF
Service resiliency at the failure of an I-CSCF works as for normal (non
WebRTC) users.
There is no mapping between a range-IMPU and an eP-CSCF or a S-CSCF. The
routing of signaling related with a Public User Id part of a range-IMPU does
not rely on the mapping between this range-IMPU and an eP-CSCF or a S-CSCF (as
is the case for the routing of signaling related with business trunking
users).
When an S-CSCF on which a user is registered fails, another S-CSCF is selected
by the I-CSCF during the regular re-registration process. Any S-CSCF that
supports the feature may be selected for that purpose.
When an eP-CSCF is detected as failed, another eP-CSCF is selected by the WIC.
Any eP-CSCF that is configured to accept the security token from the Third
party may be selected for that purpose.
NOTE: As an example, the SW downloaded by a Third party on the WIC may contain
a FQDN that refers to all the eP-CSCF that are configured to accept the
security token from this Third party.
The S-CSCF stores its restoration data on the WUDB. When a new S-CSCF is
elected it retrieves its restoration data from the WUDB.
#### 5.2.1.4 Impacts
Editor\'s note: It is FFS whether there are AS impacts. None are expected but
the AS may need to detect that an individual IMPU belongs to a range-IMPU
(corresponds to a pattern of a range-IMPU) in order to inhibit some procedures
listed in item 11 of Â§ 5.2.1.1.
The solution implies:
\- The addition of a new functional entity the WUDB (\"WWW users DB\") that
stores the association between an individual IMPU and the S-CSCF that
currently serves this individual IMPU.
\- IMS registration procedure are impacted as the S-CSCF does not
(de)associate their identity with the just (de)registered IMPU in the HSS but
in the WUDB.
\- S-CSCF and I-CSCF need to detect that an IMPU is an individual IMPU related
with an IMPU range and then the S-CSCF does not (de)associate their identity
with the just (de)registered IMPU in the HSS but in the WUDB.
\- Specific S-CSCF capability needs to be provisioned in HSS indicating
support of registration for individual IMPU within the range-IMPU.
\- I-CSCF looks up for the S-CSCF associated with an individual IMPU in the
WUDB and not in the HSS.
\- The standardization of the new W6 = W7 interfaces.
### 5.2.2 Solution 2: wIMPU Single HSS subscription
#### 5.2.2.1 Principles
This solution has the following characteristics:
\- Uses the wild carded Public User Identity (wIMPU) featured defined in TS
23.228 [2] as is with respect to registration, call origination and call
termination. Hence S-CSCF and HSS are not impacted.
\- A third party can be allocated one or more wIMPU ranges as needed.
\- A single IMS registration is performed per block of wIMPU as defined in TS
23.228 [2] (see clause 5.2.2.5.1).
\- The wIMPU Registrar holds the registration status/context of WICs. The
wIMPU Registrar is located outside the eP-CSCF.
\- The wIMPU Registrar is equivalent to HSS for webRTC users.
\- Each block of wIMPU allocated to a third party is associated with every eP-
CSCF deployed for service (see 5.2.2.2 for more details about this
association).
\- The solution supports two options: in the first option, identities are
allocated by the third party provider, while in the second option identities
are allocated by the IMS provider. In the second option, WIC use their
external (non-IMS identities) identities for communication purposes. This
means that third party users can be reached with their external (non-IMS)
identities. They can also initiate sessions using their external identities.
IMS identities are only used within the IMS domain. IMS identities are
allocated to a third-party external user at registration by the eP-CSCF, and a
binding is maintained between the external (non-IMS) identity and the
allocated individual IMPU within the wIMPU registrar as long as the WIC is
registered. External identities are SIP based. There is no static binding
between any external WIC identity and a specific IMPU upon successive
registration-deregistration cycles. Hence a WIC shall be allocated any
available individual IMPU within the wIMPU range in successive registration-
deregistration cycles.
\- The WWSF allocates a token to WIC based on any successful (web)
authentication it carries out. This token provides an identity assertion to
the WIC that it includes it in its registration requests.
\- Upon successful WIC authorization of an incoming WIC Registration Request,
the eP-CSCF stores in the wIMPU Registrar the binding between the WIC contact,
allocated individual IMPU (allocated either by the third party or the eP-CSCF)
as well as other relevant registration information for the WIC.
\- There can be multiple contacts associated with an allocated individual
IMPU. This happens if the same user registers from two or more different WICs
with the WWSF using the same credentials.
\- The eP-CSCF shall support forking a terminating session to an IMPU to all
its registered contacts to support the scenario where a user is registered
from multiple WICs and uses the same eP-CSCF (see 5.2.2.2 for additional
details).
\- When identities are allocated by the eP-CSCF, the eP-CSCF shall query the
wIMPU Registrar for originating sessions to retrieve the registration context
and perform the necessary request modification before routing the session
using standard IMS originating procedures. When identities are allocated by
the third party, the eP-CSCF uses standard IMS originating procedures to
handle the request.
\- For terminating sessions, the I-CSCF enhanced for webRTC (I-CSCF) shall
query the wIMPU Registrar to verify the registration status of a called IMPU
(or an external WIC identity if identities are allocated by the eP-CSCF)
before routing the session using standard IMS terminating procedures. The
I-CSCF shall use the domain name of the target webRTC user to distinguish
webRTC users from other IMS users. The I-CSCF shall be configured with the
domain names for webRTC users.
#### 5.2.2.2 Architecture
Figure 5.22.2-1 shows the webRTC architecture in support of wIMPU for webRTC
access
Figure 5.2.2.2-1: WebRTC IMS architecture and reference model for wIIMPU
Support
Scalability in this architecture shall be accomplished as follows:
Multiple wIMPUs may be used when a large number of identities are required by
a third party.
Each block of wIMPU allocated to a third party shall be assigned to all
deployed eP-CSCFs by the IMS provider. Hence every block of wIMPU allocated to
a third party shall be registered from all deployed eP-CSCFs, and intended to
be used by the third party, as per 5.2.2.5.1. A single serving CSCF shall
serve a block of wIMPU regardless of the number of eP-CSCFs from which it is
registered in accordance with IMS core. See clause 5.2.2.2.1 for forking
control.
There is no limit on the number of deployed eP-CSCFs to be accessed by a third
party.
A WIC can access any eP-CSCF available for service. The eP-CSCF to be
contacted can be discovered using normal DNS procedures in either option
(third party allocated identities or IMS provider allocated identities). Load
balancing can be supported using a unique FQDN configured in the WWSF.
Each WIC shall be associated with a single wIMPU for both options supported in
this solution. This association can be dynamic (IMS provider allocated
identities), or static (third party allocated identities). A WIC can access
any eP-CSCF at initial registration or re-registration (after deregistration).
##### 5.2.2.2.1 Control of Forking
Each block of wIMPU is allocated to all eP-CSCFs deployed for service, hence
the wIMPU block is registered from all allocated eP-CSCFs . This implies that
a terminating call to WIC who is allocated a specific IMPU will have to be
forked to all eP-CSCFs. This is clearly undesirable. In order to ensure that a
WIC is only contacted at the eP-CSCF where the WIC is actually registered,
caller preference feature, as defined in RFC 3841, shall be deployed in
conjunction with the parameters \"explicit\" and \"require\".
Every deployed eP-CSCF shall have a different vendor specific feature tag
provisioned in it. When the eP-CSCF registers the wIMPU with the IMS core, the
eP-CSCF feature tag is included in the contact information.
For a terminating session to a WIC, the I-CSCF locates in the wIMPU registrar
the record for the target WIC, and the individual IMPU allocated to it. If the
record is located, the I-CSCF ensures that the eP-CSCF contact information
where the individual IMPU is registered, including the feature tag for the eP-
CSCF, is included in a new header Accept-Contact, in addition to the
parameters \"explicit\" and \"require\", (as per RFC 3841), in the outgoing
request from the I-CSCF. When the INVITE request arrives at the S-CSCF serving
the wIMPU associated with the individual IMPU, the S-CSCF, in accordance with
RFC 3841 forwards the INVITE to the eP-CSCF where the WIC is registered in
accordance with the Accept-Contact header. Hence no forking will occur.
For the case, where a user is registered from multiple WICs hence the user has
two (or more) different contacts; 2 cases can be identified. In case 1, the
two (or more) registered contacts are associated with different eP-CSCFs. In
this case the registered contacts will have 2 different feature tags and the
S-CSCF shall forward an incoming INVITE to the appropriate eP-CSCFs using the
Accept-Contact header as described above. In case 2, the two (or more)
registered contacts are associated with the same eP-CSCF. In this case the eP-
CSCF handles forking as described in 5.2.2.3.2.
#### 5.2.2.3 Functional entities
##### 5.2.2.3.1 wIMPU Registrar
The wIMPU Registrar holds registration information for individual IMPUs
allocated to WICs. An entry is stored for every individual IMPU allocated to a
WIC regardless of who allocated the individual IMPU. A single entry may hold
multiple WIC contacts for the same individual IMPU. Each entry is created upon
successful WIC authorization, and can be updated upon registration of a new
contact, or registration. An entry is removed upon de-registration or
registration timer expiry.
##### 5.2.2.3.2 eP-CSCF
The eP-CSCF is a standard eP-CSCF enhanced for webRTC with the following
additional mandatory functions:
\- The eP-CSCF shall perform the WIC authorization at WIC registration. The
eP-CSCF can be configured to allocate the individual IMPU for webRTC users.
Otherwise allocation shall be done by the third party.
\- The eP-CSCF shall store in the wIMPU Registrar the binding between the
allocated specific IMPU, the WIC contact information, as well as other
registration related information for a successfully authenticated WIC for the
duration of the registration. The eP-CSCF shall remove the registration entry
once the registration expires or when the WIC is de-registered.
\- The eP-CSCF shall update the applicable entry in the wIMPU Registrar for
every re-registration of a WIC.
\- To handle originating sessions associated with wIMPU-based webRTC access,
the eP-CSCF shall query the wIMPU Registrar if identities were allocated by
the eP-CSCF to perform the necessary request modification before proceeding
with standard originating IMS procedures. If identities were not allocated by
the eP-CSCF, standard originating IMS procedures apply.
\- To handle terminating sessions associated with a wIMPU-based webRTC access,
the eP-CSCF shall query the wIMPU Registrar for the contact information of a
called webRTC user and shall support forking if the called webRTC user has
registered from multiple WICs.
\- The eP-CSCF shall be configurable with the domain names associated with
wIMPU-based webRTC access and for which the functions defined here apply.
\- The eP-CSCF shall be pre-provisioned with wIMPU allocated to third party
providers, as well as the eP-CSCF feature tag, to perform IMS registration,
(see 5.2.2.5.1 for more details).
##### 5.2.2.3.3 I-CSCF
The I-CSCF enhanced for wIMPU-based WebRTC access (I-CSCF) is a standard
I-CSCF with the following mandatory additional functions:
\- For terminating sessions, the I-CSCF shall initially query the wIMPU
Registrar to validate the registration status of a called webRTC user. If the
called webRTC user is registered, the I-CSCF shall modify the incoming SIP
INVITE as per clause 5.2.2.2 to handle forking before proceeding with standard
IMS procedures for terminating sessions. If the webRTC user is not registered
the session is rejected
\- The I-CSCF shall be configurable with the domain names for which such a
query is to be performed. This requires that DNS of any third party be
configured to ensure that terminating sessions to third party domains are
routed to the I-CSCF of the IMS service provider.
Not all I-CSCFs have to be enhanced to handle wIMPU-based WebRTC. Tarffic
segmentation through DNS can be setup so that domains related to wIMPU-based
WebRTC can terminate on enhanced I-CSCFs while other tarfiic can terminate on
non-enhanced I-CSCFs.
#### 5.2.2.4 Reference points
##### 5.2.2.4.1 W6 (eP-CSCFto wIMPU Registrar)
The W6 reference point is between the wIMPU Registrar and eP-CSCF.
##### 5.2.2.4.2 W7 (I-CSCF to wIMPU Registrar)
The W7 reference point is between the wIMPU Registrar and I-CSCF.
#### 5.2.2.5 Flows
##### 5.2.2.5.1 Block Registration of the wIMPU Range
A single IMS registration is required to register the wIMPU block as per
existing TS 23.228 [2] procedures
\- The eP-CSCF would need to trigger the registration of the wIMPU block with
IMS. The following are options for how to trigger the eP-CSCF to register each
wIMPU block:
\- The wIMPU block could be provisioned in the eP-CSCF so that the eP-CSCF
autonomously registers each block upon initialization.
\- The eP-CSCF could register an IMPU block upon receiving the first
individual IMPU registration request from a WIC.
\- There is a preference for option 1 for its simplicity.
The feature tag for the eP-CSCF to be used during registration shall also be
provisioned in the eP-CSCF.
Each block of wIMPU allocated to an eP-CSCF shall be registered as described
above.
Each block of wIMPU shall be provisioned in WWSF only if the third party
allocates the IMS identities.
##### 5.2.2.5.2 WIC Registration procedure
WIC registers with eP-CSCF using web based authentication. Upon successful
authorization, the eP-CSCF shall then bind the WIC to the selected individual
IMPU, shall update the registration status, and shall store the necessary
information in the wIMPU Registrar. The wIMPU can be allocated by third party
or the eP-CSCF.
Figure 5.2.2.5.2-1 shows a WIC registration flow to illustrate the above.
NOTE: The wIMPU block has already registered in HSS as per existing TS 23.228
[2] procedures (see clause 5.2.2.5.1).
Figure 5.2.2.5.2-1: eP-CSCF allocation of individual Public User Identity to
WIC based on web authentication
1\. From within a WebRTC-enabled browser, the user accesses a URI to the WWSF
to initiate an HTTPS connection to the WWSF. The TLS connection provides one-
way authentication of the server based on the server certificate. The browser
downloads and initializes the WIC from the WWSF. The WWSF authenticates the
user using a common web authentication procedure. Upon successful
authentication, the WWSF issues a security token for the user.
2\. The WIC shall open a WSS (secure Web Socket) connection to the eP-CSCF.
Standard cross-origin resource sharing (CORS [zz]) procedures are used to
ensure that the WIC originated from a WWSF authorized to access this eP-CSCF.
3\. The WIC shall send a REGISTER request to the eP-CSCF via the WSS (secure
Web Socket) connection. The request includes the user identity, as well as the
security token received from the WWSF as an attachment to the request. If the
user identity is allocated by the eP-CSCF, then the user external identity
(e.g SIP:Bob\@enterprise.com) shall be included in the REGISTER request. This
identity used during registration, will be the same identity that the WIC uses
at session origination, and is used, as well, to reach the WIC (terminating
session) by any other party.
4\. The eP-CSCF shall validate the contents of the security token in relation
to the user identity. The exact means for doing so are out of scope.
5\. The eP-CSCF shall query the registration status of the WIC.
6\. If the WIC is not registered, the eP-CSCF shall store the registration
information upon successful WIC authorization. If the individual IMPU is
already registered and the contact is different than the stored one, then this
is a new contact associated with the already allocated individual IMPU. If the
individual IMPU is already registered and the contact is the same as the
stored one then this is re-registration.
If the eP-CSCF allocates a individual IMPU to the registered WIC, it shall
store additionally the binding between the allocated individual IMPU and the
external received identity.
7 The eP-CSCF shall send the OK response back to the WIC.
##### 5.2.2.5.3 Origination
For WIC originating sessions arriving to the eP-CSCF, if the eP-CSCF allocated
the individual IMPU then the eP-CSCF shall first retrieve the registration
context for the WIC from the wIMPU Registrar. Following that, the eP-CSCF
follows standard IMS procedures to further process the session. This applies
to all originating sessions.
Figure 5.2.2.5.2-2 shows a session origination flow to illustrate the above
Figure 5.2.2.5.2-2: Session Origination
1 The WIC issues an originating session to the eP-CSCF. The identity included
in the session initiation request shall be the same identity used during the
WIC registration (e.g. SIP:Bob\@enterprise.com if the eP-CSCF allocated the
IMPU to the WIC).
2 This step is optional and is applicable only when the individual IMPU is
allocated by the eP-CSCF. In this step, the eP-CSCF retrieves the registration
context and modifies the originating request accordingly. The eP-CSCF includes
the allocated individual IMPU before proxying the session onwards. The
external address include in the from field in not touched.
3 The eP-CSCF then performs standard IMS session origination procedure.
##### 5.2.2.5.4 Termin**a** tion
For terminating sessions arriving at the I-CSCF, the I-CSCF shall verify the
registration status of the called IMPU by querying the wIMPU Registrar for
that purpose. If the user is registered, the I-CSCF performs the standard IMS
procedures for terminating sessions starting with the HSS query. The I-CSCF
shall also update the outgoing request according to clause 5.2.2.2 to handle
forking before proxying the request. If the user is not registered, the I-CSCF
shall reject the session with the appropriate code.
This additional step by the I-CSCF to support wIMPU-based webRTC clients shall
be performed by the I-CSCF based on configured domains associated with the
called WIC.
For terminating sessions arriving at the eP-CSCF, the eP-CSCF queries the
wIMPU Registrar for the contact information, the eP-CSCF shall fork the
session to all contacts associated with a called IMPU if applicable.
Figure 5.2.2.5.3-1 shows session termination flow to illustrate the above.
Figure 5.2.2.5.3-1: Session Termination
1 The I-CSCF receives a terminating session. The I-CSCF identifies this is a
session for a webRTC user using the configured domains for that purpose. This
requires that DNS for third parties be configured to ensure that terminating
sessions to third party domains are routed to the I-CSCF of the IMS service
provider. As an example, a WIC user reached with the same identity used during
the WIC registration (e.g. SIP:Bob\@enterprise.com if the eP-CSCF allocated
the IMPU to the WIC, requires that the I-CSCF be configured (see clause
5.2.2.3.3) so that all users pertaining to the domain enterprise.com are WIC
webRTC users.
2 The I-CSCF validates through the interaction with the wIMPU registrar if the
called webRTC user is registered and retrieves any registration context needed
to locate the individual IMPU and wIMPU associated with the called webRTC
user.
3 The I-CSCF then performs standard IMS session termination procedure to
locate the eP-CSCF for the wIMPU associated with the called webRTC user. The
I-CSCF shall modify the outgoing request before proxying it to handle forking
according to clause 5.2.2.2.1.
4 The eP-CSCF fetches the contact information for the individual IMPU from the
wIMPU registrar.
5 The eP-CSCF delivers the session to the WIC associated with the individual
IMPU.
#### 5.2.2.6 Solution Impacts
The proposed solution has impacts on the I-CSCF. The I-CSCF has to be
configured with the domain names for the third party to enable the I-CSCF to
distinguish webRTC users from non-webRTC users.
The eP-CSCF shall support forking to handle a WIC that has registered with
multiple contacts.
DNS configuration is required to ensure that terminating sessions to third
party domains are routed to the I-CSCF of the IMS service provider.
There are no impacts on the S-CSCF, or HSS.
There is a new database called wIMPU registrar equivalent to HSS for webRTC
users.
W6 and W7 interfaces shall be standardized.
### 5.2.3 Solution 3: HSS supports IMS subscriptions corresponding to users
managed by third parties
#### 5.2.3.1 Solution Principles
The solution has the following principles:
\- The solution does not require new interfaces or new network elements, i.e.
the architecture as defined in Rel-12 for WebRTC can be re-used without
modifications.
\- The IMS operator and a 3rd party can agree on a subscription where the 3rd
party may require a high number of IMPUs on a need basis and is responsible of
allocating individual IMPUs.
\- The 3rd party is responsible of (where needed) authenticating the end-user
and of allocating individual IMPU within the scope of the range-IMPU
\- The number of users which the 3rd party can support is not limited by the
solution, but controlled.
\- If the 3^rd^ party requires more IMPUs than the negotiated upper limit,
then it is enough to inform the IMS operator that more is needed and the upper
limit value is increased.
\- The solution does not require a separate data base, i.e. it relies on HSS
only, and does not require special configuration in I/S-CSCF when making new
business arrangements with third parties.
\- The 3rd party is responsible to authenticate the WIC, if needed, and
allocating an individual IMPU. The 3^rd^ party has a maximum freedom by
defining IMPUs, i.e. it is not restricted to IMPUs as *.*@operator.com but is
also allowed to allocate public IDs as *.*@3rdParty.operator.com without to
configure I/S-CSCF.
\- The HSS uses a profile which is configured or provisioned for each class
IMPU as a template. During the registration process the HSS creates a normal
user profile for the requested IMPU (based on the template) and stores the
related S-CSCF address. The HSS may control the number of IMPUs created out a
certain template, if needed. During de-registration of an IMPU the related
user profile may be deleted and becomes free for reuse.
\- The HSS can also use a profile which is additionally configured or
provisioned for each class IMPI as a template. During the registration process
the HSS creates a normal IMPI for the requested IMPU/IMPI pair (based on the
IMPI template). The HSS may control the number of IMPIs created out a certain
template, if needed. During de-registration of an IMPU/IMPI pair the related
IMPI may be deleted and becomes free for reuse. Only if no IMPI is registered
with an IMPU which was created from an IMPU template, the profile related to
that IMPU may be deleted and becomes free for reuse. Such an IMPI template may
be associated to a provisioned IMPU or a provisioned/configured IMPU template.
\- All registrations are handled as individual registrations, i.e. an
allocated IMPU looks like a dedicated IMPU towards the I-CSCF and S-CSCF;
changes to I-CSCF and S-CSCF are not required, i.e. all I/S-CSCF in the
network support this feature.
\- There can be multiple contacts (i.e. multiple WICs) associated with the
same allocated IMPU. This happens if the same user registers from two or more
different WICs with the WWSF using the same credentials.
\- An S-CSCF is independently assigned like done for any other individual
profile in the HSS today. The S-CSCF name is stored in the individual profile.
\- The Cx interface remains unchanged, no new interfaces or new protocols are
required.
\- The solution supports standard P/S-CSCF restoration procedures (restoration
data is stored in HSS).
\- Normal termination call handling is supported. The HSS keeps correct
registration states supporting interworking with existing application services
(e.g. NetLoc, T-ADS).
HSS storage is only used when a WIC performs registration, i.e. there is no
pre-allocation of any resources
The HSS has up-to-date registration information, i.e. existing IMS procedures
requiring registration status can be re-used, no sync procedures with another
data base is required.
#### 5.2.3.2 Reference Architecture
Figure 5.2.3.2-1 shows the standard WebRTC IMS architecture as it is defined
in TS 23.003 [7] and TS 23.228 [2].
The HSS, AS and related interfaces are shown in addition.
Figure 5.2.3.2-1: Standard WebRTC IMS architecture according TS 23.228 [2]
#### 5.2.3.3 Procedures
##### 5.2.3.3.1 WIC Registration for subscriptions belonging to a class of
users
The WWSF is provided with a range of public identities belonging to a
subscription for class of users. The WWSF can assign a unique IMPU/IMPI pair
from that given range. The WWSF may be located in a third party network and
have a business arrangement with the IMS operator.
Figure 5.2.3.3.1-1 shows a registration call flow where the WIC registers with
IMS based on web authentication with the WWSF and WWSF assigns identities for
a class of users.
Figure 5.2.3.3.1-1: WIC registration for class of users
1\. From within a WebRTC-enabled browser, the user accesses a URI to the WWSF
to initiate an HTTPS connection to the WWSF. The TLS connection provides one-
way authentication of the server based on the server certificate. The browser
downloads and initializes the WIC from the WWSF. The WWSF authenticates the
user using a common web authentication procedure.
The WWSF determines the Private User Identity and Public User Identity for the
WIC from an assigned range for class of users, issues a security token for the
user and returns the IMS identities and the security token to the WIC.
WWSF may decide not to authenticate the user. Unauthenticated users are
anonymous to the third party but may still be authorized for IMS service.
2\. The WIC opens a WSS (secure WebSocket) connection using cross-origin
mechanism to the eP-CSCF. Standard cross-origin resource sharing procedures
are used to ensure that the WIC originated from a WWSF authorized to access
this eP-CSCF.
3\. The WIC sends a REGISTER request to the eP-CSCF via the WSS (secure Web
Socket) connection. The request includes the user identity extracted from the
claims in the security token, as well as the security token received from the
WWSF as an attachment to the request.
4\. The eP-CSCF validates the contents of the security token and confirms that
the IMS identities being registered are authorized by the security token. The
eP-CSCF then forwards the authorized REGISTER request to IMS to initiate
authentication-less IMS registration using TNA (see TS 33.203 [3], Annex U)
procedures, with an indication that the authentication has already been
carried out.
5\. The Iâ€‘CSCF sends the Cx-Query to the HSS.
6\. The HSS checks whether the user is already registered and indicates if an
Sâ€‘CSCF is assigned. A Cx-Query Resp (indication of entry contact point, e.g.
Sâ€‘CSCF) is sent from the HSS to the Iâ€‘CSCF.
7\. The Iâ€‘CSCF determines the Sâ€‘CSCF and sends the register request towards
the S-CSCF.
8\. The Sâ€‘CSCF shall send Cx-Put/Cx-Pull to the HSS.
9\. The HSS analyses the IMS identities and identifies that the request
belongs to a subscription for a class of users for which it has a profile
template and requires a special handling. The HSS uses the template and
creates a normal user profile for the requested IMPU.
10\. The HSS returns the information flow Cx-Put Resp/Cx-Pull-Resp (user
information) to the Sâ€‘CSCF and stores the S-CSCF address into the user
profile. The Sâ€‘CSCF stores the user information for that indicated user.
11\. Based on the filter criteria, the Sâ€‘CSCF sends re-registration
information to the service control platform and perform whatever service
control procedures are appropriate.
12\. The Sâ€‘CSCF sends the 200 OK back to the Iâ€‘CSCF.
13\. The Iâ€‘CSCF sends the 200 OK to the ePâ€‘CSCF. The Iâ€‘CSCF releases all
registration information after sending the 200 OK.
14\. The ePâ€‘CSCF sends the 200 OK to the WIC.
##### 5.2.3.3.2 WIC Registration when two or more WICs sharing the same IMPU
If the same user registers from two or more different WICs (by using different
devices) using the same credentials towards the WWSF, multiple contact
addresses can be associated with the same allocated IMPU.
When a subsequent WIC uses the same credentials with the WWSF, the WWSF
assigns a different IMPI as done for the previous request, i.e. the IMPU is
the same but the IMPI is different.
The HSS when receiving the IMS identities (i.e. same IMPU, different IMPI) has
related profile templates available and creates a normal user profile for the
requested pair of IMPU/IMPI. The S-CSCF stores the relation between the new
contact address and the pair of IMPU/IMPI.
Normal shared IMPU procedures are re-used, also for session handling (e.g.
S-CSCF performs forking) and de-registration. The WWSF is required to follow
certain IMPI assignment rules. And the HSS shall be provisioned or configured
with a class IMPI as template for the IMPIs generated by the WWSF.
##### 5.2.3.3.3 WIC Session management related procedures for a class of users
Origination and termination and Session release procedures for WebRTC IMS
clients follow standard IMS procedures in the core network with the exception
that routing of all messages between the WIC and S-CSCF traverse the eP-CSCF
and that parameters of Iq+ procedures take into account the WebRTC-specific
extensions used by the WIC to send and receive media.
##### 5.2.3.3.4 WIC De-Registration for subscriptions belonging to a class of
users
De-registration procedure for WebRTC IMS clients follow standard IMS
procedures in the core network with the exception that routing of messages
between the WIC and S-CSCF traverse the eP-CSCF and the HSS deletes the
created user profile in its data base. The lifetime of the security should be
coordinated between the IMS provider and the WWSF provider (see TS 23.228 [2]
clause U.2.1.4).
##### 5.2.3.3.5 HSS keeps correct registration states for interworking with
existing application services
The HSS keeps correct registration states for all WICs as each WIC has a
separate entry in the HSS. This allows interworking support with existing
application services like NetLoc or T-ADS. An AS uses existing access keys
(e.g. IMPU/IMPI) for any data accessible via Sh as defined in TS 29.328 table
7.6.1. As there is no related IMSI available in HSS, the HSS cannot query the
SGSN, MME and AAA server to retrieve additional information.
5.2.3.3.6 Service resiliency at the failure of a CSCF
A WIC may register an assigned IMPU with all eP-CSCF available in the network
as all eP-CSCF support this feature; there is also no restriction due to the
assigned IMPU. When an eP-CSCF fails, the WIC may use the next (closest)
available eP-CSCF as long as it accepts the security token from the 3^rd^
party. Resiliency is similar as with standard IMS.
NOTE: The WIC may be assigned with a list of eP-CSCF by the WWSF, if not all
eP-CSCF in the network accept the security token from the 3^rd^ party.
When an I-CSCF fails, another I-CSCF is selected; there is no limitation as
all I-CSCF in the network support this feature. Resiliency is as with standard
IMS.
When an S-CSCF fails, on which an user is registered, another S-CSCF is
selected by the I-CSCF during the regular re-registration process. Any S-CSCF
within the network can be selected as all S-CSCF support this feature.
Resiliency is as with standard IMS.
#### 5.2.3.4 Impacts
The solution implies:
\- The HSS is required to identify if a registration request belongs to a
subscription for class of users.
\- Once a registration request for a class IMPU has been identified by the HSS
it uses the pre-configured profile creates a normal user profile for the
requested IMPU. For the support of multiple WICs using the same IMPU the HSS
creates the user profile based on the IMPU/IMPI pair.
\- During de-registration of an IMPU/IMPI pair the created IMPI is deleted in
the HSS.
\- During de-registration of the last IMPI of an IMPU the created user profile
is deleted in the HSS.
### 5.2.4 Solution 4: Single HSS subscription and enhanced AS
#### 5.2.4.1 Solution Principles
The solution has similar basic principle with 5.2.1.1. The main differences
are:
1 The WUDB keeps the real-time registration relationship between S-CSCF and
IMPU which is managed by 3rd party. During IMS registration, the 3rd party
registration is triggered. The AS receives the registration information and
sends the IMPU and S-CSCF information to WUDB. When the AS receives the
registration first time, it asks the WUDB to save this information. When all
IMS registrations are de-registered for the same IMPU, then the AS asks the
WUDB to remove this information.
2 In the terminating call, the I-CSCF is configured to treat the called IMPU
as PSI. The I-CSCF forwards the call request to an AS, and AS can check the
WUDB to find S-CSCF for routing.
3 A group of ASs are upgraded to support this feature for scalability.
4 The AS which performs the storage in the registration procedure can be
different with AS which check the WUDB in the mobile terminating.
5 if not all S-CSCFs in operator\'s network are enhanced to support the
requirements from this solution, specific S-CSCF capability needs to be
provisioned in HSS indicating support of registration for individual IMPU
within the range-IMPU, in order for I-CSCF to select S-CSCF.
#### 5.2.4.2 Architecture
Figure 5.2.4.2: Architecture
The architecture corresponds to the architecture of 23.228 Annex U with
following enhancement:
WUDB WWW users DB: Database storing the relationship between an individual
IMPU and the S-CSCF serving that IMPU;
W9 Interface between the AS and the WUDB: the AS stores / removes in WUDB the
association between an individual IMPU and the S-CSCF serving that IMPU;
W7 Interface between the I-CSCF and the WUDB: the I-CSCF reads in WUDB the
association between an individual IMPU and the S-CSCF serving that IMPU.
#### 5.2.4.3 Procedures
##### 5.2.4.3.1 Registration procedure
Figure 5.4.1.3.1: Registration
The most steps following the TS 23.228 [2], the enhancement are:
3\. The I-CSCF checks with WUDB to find the S-CSCF. If S-CSCF is not found,
the step 4 and 5 will be performed. Otherwise the step 4 and 5 will be
skipped.
5\. Specific S-CSCF capability is provisioned in HSS indicating support of
registration for individual IMPU within the range-IMPU and is included in the
response.
6\. I-CSCF selects S-CSCF based on received S-CSCF capability.
14\. The AS sends the IMPU and S-CSCF to WUDB. The WUDB holds the registration
relationship between S-CSCF and IMPU.
##### 5.2.4.3.2 MT procedure
##### 5.2.4.3.2.1 MT procedure with I-CSCF check {#mt-procedure-with-i-cscf-
check .H6}
Figure 5.2.4.3.2.1-1
The steps following the TS 23.228 [2] except:
2\. I-CSCF checks with WUDB for S-CSCF name. As optimization, the I-CSCF can
be configured to identify for which IMPU to follow this special handling.
##### 5.2.4.3.2.2 MT procedure with AS check {#mt-procedure-with-as-check .H6}
Figure 5.2.4.3.2.1-2
The steps following the TS 23.228 [2] except:
2\. I-CSCF is configured to treat the called IMPU as PSI. I-CSCF forwards the
INVITE to AS. The AS can be different with the AS in the registration
procedure. The AS in this procedure may be different with the AS in the
5.2.4.3.1.
3\. AS checks with WUDB for S-CSCF name and sends the INVITE to the Serving-
CSCF.
##### 5.2.4.3.3 Other session related procedure
There is no change on the MO, session modification and session release.
##### 5.2.4.3.4 Service resiliency, Multi-registration and forking
Service resiliency at the failure of a CSCF, support for Multi-registration
and forking are the same with solution 1.
#### 5.2.4.4 Impacts and evaluation
The solution implies:
Impact on S-CSCF is S-CSCF does not send Cx-Put to HSS in the IMS
registration.
Specific S-CSCF capability needs to be prvisioned in HSS indicating support of
registration for individual IMPU within the range-IMPU.
I-CSCF is configured to look up for S-CSCF from WUDB or based on S-CSCF
capability received from HSS in the IMS registration.
I-CSCF may be configured to look up for S-CSCF from WUDB rather than HSS in
the MT procedure.
There is a new database called WUDB equivalent to HSS for webRTC users.
W7 and W9 interface shall be standardized.
### 5.2.5 Solution 5: Decomposed architecture supports IMS subscriptions
corresponding to users managed by third parties
#### 5.2.5.1 Principles
The solution has the following principles:
1\. This solution decomposes eP-CSCF into a WebRTC Signalling Interworking
Function (WS-IWF) and P-CSCF, and eIMS-AGW into a WebRTC Media Interworking
Function (WM-IWF) and IMS-AGW. The WS-IWF and P-CSCF can be physically co-
located or physically separate. The WM-IWF and IMS-AGW can be physically co-
located or physically separate. When the WS-IWF and P-CSCF are physically co-
located, and the WM-IWF and IMS-AGW are physically co-located, this solution
is the same as solution 3 defined in clause 5.2.3. This clause only describes
how this solution works for IMS subscriptions corresponding to users managed
by third parties, when the WS-IWF and P-CSCF are physically separate and the
WM-IWF and IMS-AGW are physically separate.
2\. The solution principles listed in clause 5.2.3.1 apply to this solution
described in this alternative.
#### 5.2.5.2 Reference Architecture
Figure 5.2.5.2-1 shows the decomposed architecture.
The WebRTC Signalling Interworking Function (WS-IWF) acts as the signalling
mediation function between the WebRTC client and P-CSCF. The functionality of
the WS-IWF includes but is not restricted to:
\- Perform conversion between WebRTC signalling (e.g. HTTP/HTTPS/Websocket
signalling) and SIP signalling.
\- Provide interworking between W2 and W8.
\- Communicate with WAF to verify that the UE is executing a WIC from an
authorized WWSF.
\- Control the media plane interworking functions provided by the WM-IWF via
W6 interface.
\- Perform as the AF in the WebRTC call procedure which is responsible to
trigger the Rx session. Communicate with Policy and Charging Rules Function
(PCRF) by Rx interface to authorize the bearer resources and manage QoS.
The WebRTC media Interworking Function (WM-IWF) acts as the media mediation
function between the WebRTC client and the IMS-AGW. The functionality of the
WM-IWF includes but is not restricted to:
\- Support the media plane interworking extensions as needed for WICs.
\- Reside in the same network as the WS-IWF.
In this scenario, both WS-IWF and WM-IWF reside in the operator domain.
Figure 5.2.5.2-1: generic scenario of the decomposed architecture
NOTE: In this architecture, Rx session is moved from the P-CSCF to the WS-IWF.
Therefore, the P-CSCF needs to restrain Rx session when the accessing entity
is WS-IWF. The P-CSCF can decide not to initiate an Rx session based on the
receiving signalling from the WS-IWF, which has an indication to P-CSCF to
restrain Rx session. Alternatively, a dedicated P-CSCF can be deployed and
configured to never initiate any Rx session.
#### 5.2.5.4 W8 interface
The W8 interface corresponds to the Gm interface as defined between a UE and a
P-CSCF. Additionally the W8 interface is used to transmit an indication to
restrain Rx session in P-CSCF. Other mechanisms for the P-CSCF to decide not
to initiate an Rx session e.g. data configuration in P-CSCF based on the
address of WS-IWF have no impact on W8 interface.
#### 5.2.5.5 Procedures
##### 5.2.5.5.1 WIC Registration for subscriptions belonging to a class of
users
The WWSF is provided with a range of public identities belonging to a
subscription for class of users. The WWSF can assign a unique IMPU/IMPI pair
from that given range. The WWSF may be located in a third party network and
have a business arrangement with the IMS operator.
Figure 5.2.5.5.1-1 shows a registration call flow where the WIC registers with
IMS based on web authentication with the WWSF and WWSF assigns identities for
a class of users.
Figure 5.2.5.5.1-1: WIC registration for class of users
1\. From within a WebRTC-enabled browser, the user accesses a URI to the WWSF
to initiate an HTTPS connection to the WWSF. The TLS connection provides one-
way authentication of the server based on the server certificate. The browser
downloads and initializes the WIC from the WWSF. The WWSF authenticates the
user using a common web authentication procedure.
The WWSF determines the Private User Identity and Public User Identity for the
WIC from an assigned range for class of users, issues a security token for the
user and returns the IMS identities and the security token to the WIC.
WWSF may decide not to authenticate the user. Unauthenticated users are
anonymous to the third party but may still be authorized for IMS service.
2\. The WIC opens a WSS (secure WebSocket) connection using cross-origin
mechanism to the eP-CSCF. Standard cross-origin resource sharing procedures
are used to ensure that the WIC originated from a WWSF authorized to access
this eP-CSCF.
3\. The WIC sends a REGISTER request to the WS-IWF via the WSS (secure Web
Socket) connection. The request includes the user identity extracted from the
claims in the security token, as well as the security token received from the
WWSF as an attachment to the request.
4\. The WS-IWF validates the contents of the security token and confirms that
the IMS identities being registered are authorized by the security token. The
WS-IWF then forwards the authorized REGISTER request to P-CSCF to initiate
authentication-less IMS registration using TNA (see TS 33.203 [3], Annex U)
procedures, with an indication that the authentication has already been
carried out.
5\. The P-CSCF forwards the SIP registration message to I-CSCF.
6\. The Iâ€‘CSCF sends the Cx-Query to the HSS.
7\. The HSS checks whether the user is already registered and indicates if an
Sâ€‘CSCF is assigned. A Cx-Query Resp (indication of entry contact point, e.g.
Sâ€‘CSCF) is sent from the HSS to the Iâ€‘CSCF.
8\. The Iâ€‘CSCF determines the Sâ€‘CSCF and sends the register request towards
the S-CSCF.
9\. The Sâ€‘CSCF shall send Cx-Put/Cx-Pull to the HSS.
10\. The HSS analyses the IMS identities and identifies that the request
belongs to a subscription for a class of users for which it has a profile
template and requires a special handling. The HSS uses the template and
creates a normal user profile for the requested IMPU.
11\. The HSS returns the information flow Cx-Put Resp/Cx-Pull-Resp (user
information) to the Sâ€‘CSCF and stores the S-CSCF address into the user
profile. The Sâ€‘CSCF stores the user information for that indicated user.
12\. Based on the filter criteria, the Sâ€‘CSCF sends re-registration
information to the service control platform and perform whatever service
control procedures are appropriate.
13\. The Sâ€‘CSCF sends the 200 OK back to the Iâ€‘CSCF.
14\. The Iâ€‘CSCF sends the 200 OK to the Pâ€‘CSCF. The Iâ€‘CSCF releases all
registration information after sending the 200 OK.
15\. The P-CSCF forwards the 200 OK to the WS-IWF.
16\. The ePâ€‘CSCF sends the 200 OK to the WIC.
##### 5.2.5.5.2 WIC Session management related procedures for a class of users
Origination and termination and Session release procedures for WebRTC IMS
clients follow standard IMS procedures in the core network with the exception
that routing of all messages between the WIC and S-CSCF traverse the WS-IWF
and that parameters of W6 interface procedures take into account the WebRTC-
specific extensions used by the WIC to send and receive media.
##### 5.2.5.5.3 WIC De-Registration for subscriptions belonging to a class of
users
De-registration procedure for WebRTC IMS clients follow standard IMS
procedures in the core network with the exception that routing of messages
between the WIC and S-CSCF traverse the WS-IWF and the HSS deletes the created
user profile in its data base. The lifetime of the security should be
coordinated between the IMS provider and the WWSF provider (see TS 23.228 [2]
clause U.2.1.4).
#### 5.2.5.4 Impacts
The solution implies the following impacts:
\- The HSS is required to identify if a registration request belongs to a
subscription for class of users.
\- Once a registration request for a class IMPU has been identified by the HSS
it uses the pre-configured profile creates a normal user profile for the
requested IMPU.
\- During de-registration the created user profile is deleted in the HSS.
\- The P-CSCF needs to restrain Rx session via configuration or via receiving
an indication over the W8 interface.
## 5.3 Evaluation
### 5.3.1 High level Description of the solutions
At high level the various solutions are:
Solution 1: \"Single HSS subscription for an unbounded number of users\":
introduction of a new data base called WUDB where the mapping from individual
IMPU to S-CSCF is stored.
There is one HSS record for a range-IMPU (the set of IMPU allocated to a 3rd
party). The HSS record for a range-IMPU contains subscription data shared by
all individual IMPU potentially identified by the range-IMPU. The range-IMPU
is not meant to be registered. There is no record in HSS per individual IMPU.
Each individual IMPU is registered invividually
Routing in the network is per individual IMPU as different individual IMPU of
the same range-IMPU may be spread onto different eP-CSCF / S-CSCF
There is a total flexibility in the mapping between individual IMPU and eP-
CSCF / S-CSCF. For eP-CSCF allocation this can be supported by DNS load
balancing e.g. related with an unique FQDN configured in the WWSF.
There is no need to enforce mappings between an external-Id and an IMPU as the
user may keep the same IMPU even though it is served by different eP-CSCF /
S-CSCF upon successive registrations --deregistration cycles.
Solution 2: \"wIMPU Single HSS subscription\".
introduction of a new Data base called wIMPU registrar where the registration
status of individual IMPU is stored. eP-CSCF write in the wIMPU registrar and
I-CSCF look up the wIMPU registrar (e.g. to handle incoming sessions)
Uses the wildcarded Public User Identity (wIMPU) feature defined in TS 23.228
[2] \"as is\" with respect to registration, call origination and call
termination. Hence S-CSCF and HSS are not impacted.
Solution 3: \"HSS supports IMS subscriptions corresponding to users managed by
third parties: Using HSS templates:
The HSS uses a profile which is configured or provisioned for each class IMPU
as a template. During the registration process (of an individual IMPU) the HSS
creates a normal user profile for the requested IMPU (based on the template)
and stores the related S-CSCF address. The HSS may control the number of IMPUs
created out a certain template, if needed. During de-registration of an IMPU
the related user profile may be deleted and becomes free for reuse.
Otherwise no other change to the architecture ; This solution could be said to
correspond to an internal implementation within the HSS
There is a total flexibility in the mapping between individual IMPU and eP-
CSCF / S-CSCF
All procedures requiring an individual record per User in the HSS may be
reused. Whether they are really needed is questionable: for example SRVCC or
T-ADS are not meant for WebRTC UE for users of a third party (WIC running
above a browser)
Solution 4: is a variant of solution 1 so both solutions are described
together
Solution 5: is a variant of solution 3 so both solutions are described
together
Editor\'s note: Whether any solution supports procedures relying on the
communication from HSS to the serving node (MME, AAA server, etc.) i.e.
procedures relying on the knowledge of the IMSI is FFS.
Editor\'s note: All the solutions should describe how they support resiliency
/ recovery and scalability.
### 5.3.2 Evaluation Criteria
The table below includes the evaluation criteria for evaluating different
solutions:
Decomposition aspects are excluded from the evaluation below.
Consideration of the decomposed architecture vs. non-decomposed architecture
will be addressed as a subsequent evaluation.
Table 5.3.2-1
+----------------+----------------+----------------+----------------+ | Criteria | Solution 1 +4 | Solution 2 | Solution 3 +5 | +----------------+----------------+----------------+----------------+ | Provisioning | The 3rd party | Case 1: | The IMS | | impacts for | assigns the | Identities | operator and a | | third party | IMPU The 3rd | Allocated by | 3rd party can | | | party assigns | IMS provider: | agree on a | | | the IMPU | | subscription | | | (automatically | DNS for third | where the 3rd | | | generated | Party user | party may | | | based on user | domains | require a high | | | Identifiers | provisioned to | number of | | | within the | route | IMPUs on a | | | Third party | terminating | need basis and | | | service), | traffic to | is responsible | | | | third party | of allocating | | | Needs to be | domains to the | individual | | | configured | address of the | IMPUs. | | | with the | I-CSCF, or | | | | domain | FQDN for | The 3rd party | | | negotiated | I-CSCF. | assigns the | | | with the | | IMPU, IMPI and | | | operator and | Case | security | | | to use this | 2:Identities | token. The | | | domain when | Allocated by | IMPU has a | | | building IMPU | Third Party | format like | | | / IMPI for its | Provider |  | | | belongs to the | IMS identities | (including | | | Third party | allocated to | phone number | | | (and not to | third Party | ranges).. | | | the operator), | Identities | | | | the Third | | The | | | party needs to | DNS for third | configuration | | | configure DNS | Party user | is done once | | | records (e.g. | domains | when agreement | | | NAPTR) | provisioned to | with the | | | redirecting | route | operator is | | | the incoming | terminating | signed, no | | | sessions to an | traffic to | need to modify | | | I-CSCF of the | third party | it when the | | | operator. The | domains to the | number of | | | Configuration | address of the | Third party | | | is done once | I-CSCF, or | users grows. | | | when agreement | FQDN for | | | | with the | I-CSCF | | | | operator | | | | | signed, no | | | | | need to modify | | | | | it when the | | | | | number of | | | | | Third party | | | | | users grows | | | | | | | | | | It is also | | | | | possible for | | | | | the operator | | | | | to agree with | | | | | the Third | | | | | party on phone | | | | | number ranges. | | | +----------------+----------------+----------------+----------------+ | Provisioning | Configure the | Configure the | The HSS is | | impacts for | third party | third party | configured or | | IMS provider | domains in the | domains in the | provisioned | | | I-CSCF and | I-CSCF, | for each class | | | S-CSCF. Done | eP-CSCF, | IMPU with a | | | once, when | whenever there | related | | | agreement with | is a third | template which | | | the third part | party | allows | | | signed, no | agreement. | creating a | | | need to modify | | normal | | | it when the | Configure the | registration | | | number of | allocated | entry. | | | Third party | wIMPUs in the | | | | users grows. | eP-CSCF, and | | | | | the feature | | | | | tag for the | | | | | eP-CSCF | | | | | | | | | | Every time a | | | | | new wIMPU is | | | | | allocated to a | | | | | third party it | | | | | has to be | | | | | configured in | | | | | the eP-CSCF. | | +----------------+----------------+----------------+----------------+ | Impacts on | No impacts on | No impacts on | No impacts on | | Network | existing IMS | existing IMS | existing IMS | | Interfaces | interface. | interface. | interface. | | | | | | | | Two new | Two new | No new | | | interfaces are | interfaces are | Interfaces | | | required to | required to | Introduced. | | | enable | enable | | | | interworking | interworking | | | | between the | between the | | | | WUDB and both | wIMPU | | | | the S-CSCF and | registrar and | | | | I-CSCF | both the | | | | | eP-CSCF and | | | | | I-CSCF | | +----------------+----------------+----------------+----------------+ | eP-CSCF | No Impacts | It has to | No Impacts | | Functional | | support | | | impacts | | interworking | | | | | with the wIMPU | | | | | registrar to | | | | | manage WIC | | | | | registration | | | | | contexts. | | | | | | | | | | It has to | | | | | support | | | | | forking in | | | | | case a WIC | | | | | with 2 or more | | | | | contacts | | | | | accesses the | | | | | same eP-CSCF. | | | | | | | | | | It has to | | | | | pre-register | | | | | in IMS the | | | | | p | | | | | re-provisioned | | | | | wIMPUs and | | | | | include the | | | | | provisioned | | | | | vendor | | | | | specific | | | | | feature tag | | +----------------+----------------+----------------+----------------+ | HSS Functional | For 3^rd^ | No Impacts | During the | | impacts | party webRTC | | registration | | | subscriptions, | | process the | | | ignore the | | HSS creates a | | | IMPI received | | normal user | | | as part of a | | profile for | | | UAR | | the requested | | | | | IMPU (based on | | | | | the | | | | | provisioned | | | | | IMPU class | | | | | template). | +----------------+----------------+----------------+----------------+ | S-CSCF | The | No Impacts | No Impacts | | Functional | relationship | | | | impacts | between | | | | | individual | | | | | IMPU and | | | | | S-CSCF is | | | | | stored in the | | | | | WUDB and not | | | | | in HSS. | | | +----------------+----------------+----------------+----------------+ | I-CSCF | Determine | Domain names | No Impacts | | Functional | (e.g. Domain | for third | | | impacts | names for | party | | | | third party | providers to | | | | providers to | be configured. | | | | be configured) | | | | | that the | For any | | | | target Public | incoming | | | | User Identity | INVITE for a | | | | belongs to the | WIC user, the | | | | set of | I-CSCF | | | | identities for | validates the | | | | which the | wIMPU | | | | S-CSCF is not | registrar to | | | | stored in the | verify if the | | | | HSS but in the | WIC is | | | | WUDB. | registered. If | | | | | registered the | | | | Query the WUDB | I-CSCF | | | | for the | retrieves the | | | | identity of | WIC | | | | the S-CSCF of | registration | | | | the target | context, and | | | | IMPU. | includes the | | | | | Accept-Contact | | | | | header with | | | | | the proper | | | | | feature tag | | | | | fetched from | | | | | the WIC | | | | | registration | | | | | context in the | | | | | outgoing SIP | | | | | INVITE to the | | | | | S-CSCF after | | | | | HSS query. | | +----------------+----------------+----------------+----------------+ | New Functional | A new (WUDB) | A new data | No New | | Entity | data base is | base is | Functional | | | required to | required to | Entity | | | hold the | hold the | Introduced | | | registration | registration | | | | status and | status and | | | | registration | registration | | | | context for | context for | | | | registered WIC | registered WIC | | | | users. This | users. This | | | | new database | new database | | | | has interfaces | has interfaces | | | | towards S-CSCF | towards | | | | and I-CSCF | eP-CSCF and | | | | | I-CSCF | | +----------------+----------------+----------------+----------------+ | Scalability | The WUDB | The wIMPU | Not applicable | | for new | registrar is | registrar is | | | functional | fully scalable | fully scalable | | | Entity | since the | since the | | | | front end can | front end can | | | | be separated | be separated | | | | from the | from the | | | | actual | actual | | | | database. | database. | | +----------------+----------------+----------------+----------------+ | Scalability | Fully | Fully | Fully | | for S-CSCF | Scalable: | Scalable: | Scalable: | | | | | | | | Users are not | Multiple | No issue as | | | spread on | wIMPUs can be | all S-CSCF | | | S-CSCF per | allocated to a | support the | | | blocks of IMPU | third party. A | feature. | | | but per | wIMPU can be | | | | individual | serviced by | | | | IMPU: any | one S-CSCF as | | | | individual | per existing | | | | IMPU allocated | IMS | | | | to a third | procedures. | | | | party provider | | | | | can be | Each wIMPU | | | | allocated to | allocated to a | | | | any S-CSCF | third party | | | | | provider can | | | | The solution | be allocated | | | | requires the | to a different | | | | S-CSCF to | S-CSCF | | | | handle the | | | | | registration | | | | | of individual | | | | | IMPU | | | +----------------+----------------+----------------+----------------+ | Scalability of | Reduces the | No impact | Additional | | HSS | signalling | | processing | | | load on the | | power if | | | HSS as the HSS | | number of | | | is not | | registration | | | involved by | | requests | | | terminating | | increases. | | | sessions. | | | +----------------+----------------+----------------+----------------+ | Scalability | Fully | Fully | Fully | | for eP-CSCF | scalable: | scalable: | Scalable: | | | | | | | | Any number of | Any number of | No issue as | | | eP-CSCFs can | eP-CSCFs, | all eP-CSCF | | | be deployed at | supporting | support the | | | any time. A | this feature | feature. | | | FQDN, through | can be | | | | DNS | deployed at | | | | resolution, | any time. A | | | | can select any | FQDN, through | | | | eP-CSCF. | DNS | | | | Hence, a WIC | resolution, | | | | can deregister | shall select | | | | and reregister | anyone. Hence, | | | | to any eP-CSCF | a WIC can | | | | | deregister and | | | | | reregister to | | | | | any eP-CSCF | | +----------------+----------------+----------------+----------------+ | Support for | Supported: | Supported: | Supported: | | external | | | | | Identities | The IMPU has a | Support SIP | Requires 3^rd^ | | | format like | based non-IMS | party to | | | *.*@ | external | perform proper | | | doma | identities, | DNS data base | | | in-allocated-b | including | handling. | | | y-the-operator | allocation for | | | | where the 3rd | temporary | | | | party is free | Telephone | | | | to use any | numbers, | | | | \ | belonging to | | | | "external-Id\" | third party | | | | in the | provider users | | | | \"*.*\". The | | | | | 3rd party just | | | | | needs to be | | | | | configured | | | | | with the | | | | | doma | | | | | in-allocated-b | | | | | y-the-operator | | | | | and to use | | | | | this domain | | | | | when building | | | | | IMPU / IMPI | | | | | for its users. | | | +----------------+----------------+----------------+----------------+ | Extensibility | Supported: | Supported: | Supported: | | to Support | | | | | roaming | No additional | No additional | Solution uses | | scenarios | functionality | functionality | standard | | | to support | to support | eP-CSCF. | | | home-based or | home-based | | | | LBO : there is | routing. | | | | no impact on | | | | | eP-CSCF. | Local breakout | | | | | can be | | | | The WUDB does | supported with | | | | not need to | additional | | | | support | functionality | | | | roaming | to allow | | | | (interfaces | authorization | | | | only S-CSCF | of roaming WIC | | | | and I-CSCF) | users with | | | | | their home | | | | | third party | | | | | domains and | | | | | the wIMPU | | | | | registrar. | | | | | Hence the | | | | | wIMPU | | | | | registrar has | | | | | to support | | | | | roaming. This | | | | | implies that | | | | | W6 has to be a | | | | | roaming | | | | | interface. | | +----------------+----------------+----------------+----------------+ | Support for | Supported: | Supported: | Supported: | | Restoration | | | | | Procedures | Uses existing | No Impact to | S-CSCF data is | | | IMS | existing IMS | stored in HSS, | | | restoration | restoration | eP-CSCF data | | | procedures | procedures. | via PCC.. | | | | | | | | S-CSCF | | | | | Restoration | | | | | requires | | | | | support by | | | | | WUDB | | | +----------------+----------------+----------------+----------------+ | Resiliency | The usage of | The usage of | Optimal as | | | DNS with FQDN | DNS with FQDN | there are no | | | to determine | to locate | impacts to | | | an eP-CSCF | eP-CSCF | eP-CSCF, | | | ensures no | ensures no | S-CSCF and | | | single point | single point | I-CSCF and | | | of failure | of failure. | therefore all | | | (any eP-CSCF | | network | | | can support | The usage of | elements | | | any third | DNS for | support this | | | party IMPU). | terminating | feature | | | | traffic to any | without | | | The usage of | I-CSCF ensures | configuration. | | | DNS for | no single | | | | terminating | point of | | | | traffic to | failure | | | | I-CSCF ensures | | | | | no single | Using existing | | | | point of | IMS | | | | failure (any | Restoration | | | | I-CSCF | procedures | | | | enhanced for | ensures that | | | | the feature | active WIC | | | | can support | users are not | | | | any third | impacted by | | | | party IMPU). | any failure in | | | | | any S-CSCF, or | | | | The usage of | eP-CSCF. | | | | existing | | | | | S-CSCF | | | | | allocation | | | | | mechanisms | | | | | ensures no | | | | | single point | | | | | of failure | | | | | (any S-CSCF | | | | | enhanced for | | | | | the feature | | | | | can support | | | | | any third | | | | | party IMPU). | | | +----------------+----------------+----------------+----------------+ | Advantages of | Smooth | Smooth | Rel-12 WebRTC | | Solution | Deployment: | Deployment: | Architecture | | | eP-CSCFs can | eP-CSCFs can | as is can be | | | be deployed to | be deployed | re-used: | | | exclusively | exclusively to | | | | handle webRTC | carry webRTC | No need to | | | traffic | traffic | introduce and | | | through DNS | through DNS | manage a | | | configuration. | configuration. | second data | | | I-CSCFs can be | I-CSCFs can be | base! | | | deployed to | deployed and | | | | exclusively | configured | No new | | | handle webRTC | through DNS to | interfaces, no | | | traffic | carry | related | | | through DNS | exclusively | s | | | configuration. | webRTC | tandardisation | | | S-CSCF can be | traffic. Even | required | | | deployed | S-CSCF can be | | | | exclusively to | exclusively | All existing | | | carry webRTC | deployed for | network | | | traffic | webRTC taffic | elements can | | | (through | if need be | be reused, no | | | capabilities | (through | need for | | | c | capabilities | replacements | | | onfiguration). | c | | | | | onfiguration). | The solution | | | Minimum | | only relies on | | | Provisioning: | Minimum | HSS internal | | | No | Provisioning: | software | | | provisioning | No | processes | | | required for | provisioning | | | | third party | required for | Normal | | | providers, | third party | termination / | | | (other than | providers, | origination | | | the domain | (other than | call handling | | | allocated by | DNS) when | is supported, | | | the operator). | identities are | i.e. re-use of | | | IMS providers | allocated by | existing and | | | have to | the IMS | well proofed / | | | provision | service | stable IMS | | | third party | provider. IMS | procedures | | | domain name | providers have | | | | ranges in the | to provision | IMS services | | | I-CSCF. No | third party | are supported | | | w-IMPUs and | domain names | by normal AS, | | | feature tags | in the I-CSCF | ISC and Sh | | | provisioning | as well as the | procedures | | | in the | w-IMPUs and | | | | eP-CSCF. | feature tags | It saves the | | | | in the | investments of | | | Traffic | eP-CSCF. | existing | | | Separation: | | Rel-12 WebRTC | | | The use of a | Traffic | deployments | | | separate | Separation: | | | | (WUDB) | The use of a | Easy to | | | database for | separate | operate: | | | webRTC, in | database for | | | | addition to | webRTC, in | No up-to-date | | | optionally | addition to | configuration | | | using separate | optionally | is required in | | | control nodes | using separate | eP-CSCF, | | | as described | control nodes | S-CSCF or | | | above ensures | as described | I-CSCF when | | | that IMS | above ensures | making new | | | traffic is | that IMS | business | | | completely | traffic is | arrangements | | | unaffected by | completely | with third | | | webRTC | unaffected by | parties | | | traffic. | webRTC | | | | | traffic. | Using HSS | | | No impact on | | templates is | | | third Party | No impact on | common | | | Users: Third | third Party | practice | | | party can | Users: Third | | | | continue to | party users | No second data | | | use the same | don\'t have to | base is | | | identities | be aware of an | required to be | | | they have but | IMS identity | managed | | | just need to | that they have | | | | embed them in | to provide to | Smooth | | | a sip URI | people to | rollout: | | | format when | reach them. | | | | using the | They can | All existing | | | communication | continue to | network | | | capabilities | use the same | elements can | | | offered by | identities | support this | | | IMS. | they have but | feature from | | | | they have to | day 1 onwards, | | | Fully | be SIP based. | except HSS | | | Scalable: | | that needs to | | | Every node is | Fully | be upgraded | | | independently | Scalable: | | | | scalable. No | Every node is | Installed base | | | need to | independently | can be re-used | | | allocate | scalable | and extended | | | Multiple IMPU | | in the feature | | | ranges to a | Operational | is successful | | | third party in | Cost: | and traffic | | | order to split | Virtually | grows, but HSS | | | the load | non-existent | needs to be | | | between S-CSCF | for the | adapted | | | | scenario when | according the | | | Operational | the IMS | amount of | | | Cost: | provider | traffic | | | Virtually | allocates the | | | | non-existent. | identities. | Simple to | | | | | standardise: | | | | | | | | | | No new | | | | | interfaces and | | | | | functional | | | | | entities need | | | | | to be | | | | | specified | | | | | | | | | | No | | | | | controversial | | | | | discussions as | | | | | the solution | | | | | is realised by | | | | | help of HSS | | | | | internal | | | | | processes | | | | | which are | | | | | outside the | | | | | scope of 3GPP | | | | | s | | | | | tandardisation | | | | | | | | | | Easy to keep | | | | | Rel-13 time | | | | | frame in stage | | | | | 2 and stage 3, | | | | | no waste of | | | | | meeting time | +----------------+----------------+----------------+----------------+ | Limitations of | None | None | None | | Solution | | | | +----------------+----------------+----------------+----------------+ | Operational | None, given | None, given | No operational | | Impacts | the minimal | the minimal | impacts | | | provisioning | provisioning | | | | required. | required for | | | | | the case when | | | | | the IMS | | | | | provider | | | | | allocated the | | | | | IMS | | | | | identities. | | +----------------+----------------+----------------+----------------+
## 5.4 Conclusion
Solution 3 is endorsed as the solution for the key issue \"Single HSS
subscription for an unbounded number of users\".
Solution 5 is endorsed as an implementation specific alternative solution for
the key issue \"Single HSS subscription for an unbounded number of users\".
Existing Gm interface can be reused and no normative requirements will be
specified.
# 6 Third-party realization of communication services
## 6.0 General description
Editor\'s note: clause 6 is related with SA1 requirements for \"third-party
realization of communication services (e.g., enterprise) either instead or in
addition to those provided by the IMS operator\". It studies the case where
terminals use WebRTC based communication means and are first served by a Third
party entity (e.g. PBX) that provides some communications services but also
interfaces with an IMS network for other communication services.
## 6.1 Architectural requirements
Editor\'s note: When the registrar for the individual IMPU(s) related with the
Third part lies in the operator domain, the solution to support Third-party
realization of communication services (e.g., enterprise) depends on the
solution chosen in clause 5 of this TR.
\- When the registrar for the individual IMPU(s) related with the Third part
lies in the Third party domain:
\- When the communication services are provided by the 3^rd^ party instead of
those provided by the IMS operator, the business trunking architecture is
assumed and the usage of WebRTC between devices and the 3rd party is out of
scope of 3GPP.
\- When some communication services are provided by the 3^rd^ party (e.g.,
called party number transformation, call diversion, simultaneous ringing
within a call center) and the WebRTC Third Party Function (WTPF) handles both
user and control plane, the business trunking architecture is assumed and the
usage of WebRTC between devices and the 3^rd^ party is out of scope of 3GPP.
## 6.2 Solutions
### 6.2.1 Solution 1: WTPF interworking with IMS
#### 6.2.1.1 Overview
Editor\'s note: This description of this solution requires enhancements.
This solution addresses the case where:
A WebRTC Third Party Function (WTPF) interfaces the WebRTC Client and provides
3^rd^ party services (e.g., called party number transformation, call
diversion, simultaneous ringing within a call center) not implying user plane
handling.
the registrar for the individual IMPU(s) related with the Third party lies in
the Third party domain. Thus the WUDB defined in solution x of clause 5 does
not apply.
This solution relies on a mix of the business trunking architecture and of
architecture defined TS 23.228 [2] Annex U as part of 3GPP R12 in order to
support WebRTC based UE.
\- The user plane flows from the 3^rd^ party follow W3 specifications and are
handled in the network by an eIMS-AGW (as defined in R12 TS 23.228 [2] Annex
U).
\- The W8 interface between the WTPF and the IMS network is based on an
evolution of Gm. The Gm evolutions include the capability to control media
transport per W3 specifications.
\- The solution reuses the evolution of Iq defined in Rel12 to control media
transport per W3 specifications.
\- This support of W8 requires also an evolution of the P-CSCF.
\- The WTPF is responsible of authenticating the WIC (e.g. using procedures
similar to those described in TS 23.228 [2], clause U.2.1.4) and the WTPF
appears as a PBX that interfaces the IMS with a Gm like interface that has
been modified for the SDP to control media transport per W3 specifications.
\- It is assumed that the WTPF is trusted by the operator (as the WTFP
provides signalling that contains the identity of the user ). Whether the WTPF
actually belongs to the IMS operator or to the Third party depends on business
agreements with the Third Party.
\- W9 has a similar role to the role of W5.
\- W10 has a similar role to the role of W4.
Figure 6.2.1.1: Solution architecture and reference model
Editor\'s note: The exact impacts on P-CSCF and on Iq are FFS.
As with business trunking, 2 cases may be supported by this architecture:
Registration mode where the WTPF registers to the IMS network.
Static mode where the WTPF does not perform any registration procedures.
In both modes, the WTPF can be provisioned as a subscriber in the HSS.
#### 6.2.1.2 W8 interface
W8 corresponds to the interface as defined between a P-CSCF and a PBX for
business trunking with following modifications
The SDP refers to user plane flows corresponding to the W3 reference point
defined in TS 23.228 [2], Annex U and hence defined by IETF work on RTCWEB.
### 6.2.2 Solution 2: Decomposed Architecture for PBX
#### 6.2.2.1 Overview
This solution decomposes eP-CSCF into a WebRTC Signalling Interworking
Function (WS-IWF) and P-CSCF, and eIMS-AGW into a WebRTC Media Interworking
Function (WM-IWF) and IMS-AGW. The decomposed architecture is more flexible
for different deployment scenarios and has little impact to the existing IMS
core entities.
Editor\'s note: The extent to which there is impact to existing core network
entities needs to be verified and is FFS.
This solution can be used in the cases where:
\- The WS-IWF and WM-IWF are located in the third party domain and provide
third party services and communication interworking between WebRTC client and
non WebRTC terminals inside the third party domain. When WebRTC clients inside
the third party require other communication services outside the third party
domain, they access the IMS network via WS-IWF and WM-IWF.
Editor\'s note: It is FFS the relationship between the decomposed architecture
described in this clause and the release 12 architecture.
The WebRTC Signalling Interworking Function (WS-IWF) acts as the signalling
mediation function between the WebRTC client and P-CSCF. The functionality of
the WS-IWF includes but is not restricted to:
\- Perform conversion between WebRTC signalling (e.g. HTTP/HTTPS/Websocket
signalling) and SIP signalling.
\- Provide interworking between W2 and W8.
\- Communicate with WAF to verify that the UE is executing a WIC from an
authorized WWSF.
\- Control the media plane interworking functions provided by the WM-IWF via
W6 interface.
\- Perform as the AF in the WebRTC call procedure which is responsible to
trigger the Rx session. Communicate with Policy and Charging Rules Function
(PCRF) by Rx interface to authorize the bearer resources and manage QoS.
The WebRTC media Interworking Function (WM-IWF) acts as the media mediation
function between the WebRTC client and the IMS-AGW. The functionality of the
WM-IWF includes but is not restricted to:
\- Support the media plane interworking extensions as needed for WICs.
\- Reside in the same network as the WS-IWF.
Figure 6.2.2.1-1: generic scenario of the decomposed architecture
NOTE: In this architecture, Rx session is moved from the P-CSCF to the WS-IWF.
Therefore, the P-CSCF needs to restrain Rx session when the accessing entity
is WS-IWF as defined for PBX scenario.
#### 6.2.2.2 W8 interface
The W8 interface corresponds to the Gm interface as defined between a P-CSCF
and a PBX for business trunking, as specified in TS 23.228 [2], Annex S.
#### 6.2.2.3 Decomposed architecture for business trunking
The architecture for support of IP PBX is shown in Figure 6.2.2.3-1. The IP
PBX includes the WS-IWF, WM-IWF and the WWSF and WAF functionality.
Figure 6.2.2.3-1: decomposed architecture for business trunking
#### 6.2.2.4 Procedures
Two different modes of operation are supported
\- Registration mode, or
\- Static mode.
In both modes, the IPâ€‘PBX can be provisioned as a subscriber in the HSS.
In registration mode, the IPâ€‘PBX registers to and receives service from the
IMS network as specified in ETSI.
The procedures related to the decomposed architecture for business trunking
are the same as those described for an IP- PBX using static mode is described
in TS 23.228 [2] Annex S. In the case of the decomposed architecture for
business trunking, W8 interface is supported instead of Gm interface.
## 6.3 Evaluation
Editor\'s note: FFS.
## 6.4 Conclusion
Editor\'s note: FFS.
# 7 Interworking of Rel-12 or earlier IMS services with WebRTC
Editor\'s note: The first action to be carried out is to determine whether SA2
work is needed in this area.
## 7.0 General description
Editor\'s note: clause 7 is related with SA1 requirements for \"Address any
gaps identified to ensure interworking of Rel-12 or earlier IMS services
(e.g., Telepresence, presence) with webRTC\".
## 7.1 Architectural requirements
## 7.2 Solutions
### 7.2.1 Solution 1: WebRTC service control
#### 7.2.1.1 Solution Principles
This solution allows the IMS operator to provide different services based upon
the third party WebRTC server that is used to download the WIC from. Such
service differentiation can be as a result of, for example, different business
relationships and service level agreements between third party WebRTC servers
and the IMS operator.
The solution has the following principles:
\- The identity of the third party WebRTC server is transmitted to the S-CSCF
via eP-CSCF during the registration procedure. The S-CSCF can notify the AS
via which third party WebRTC server the WebRTC user is accessing the IMS core,
either in the registration procedures or in the call procedures. Thus the AS
can implement flexible service control according to not only the IMS user
service subscription but also certain third party WebRTC server service
control policy, where the third party service control policy is preconfigured
in the AS or downloaded from HSS.
NOTE 1: How the identity of the third party WebRTC server is used in the AS is
dependent on practical deployment and can be service specific and thus is not
described in this document.
#### 7.2.1.2 Reference Architecture
Figure 7.2.1.2-1 shows the standard WebRTC IMS architecture as it is defined
in TS 23.228 [2].
The HSS, AS and related interfaces are shown in addition for clarity.
Figure 7.2.1.2-1: WebRTC IMS architecture
#### 7.2.1.3 Procedures
##### 7.2.1.3.1 WIC Registration and service control of individual Public User
Identity
In this scenario, the user has an IMS subscription and accesses the IMS via a
WebRTC web server (WWSF). The WWSF may be located in a third party network and
have a business subscription with the IMS operator.
Figure 7.2.1.3.1-1 shows a registration and call procedure where the S-CSCF
obtains the WWSF identity and uses the WWSF identity to implement service
control together with AS.
Figure 7.2.1.3.1-1: WIC registration for class of users using web
authentication
Figure 7.2.1.3.1-1 is the same as the individual WebRTC user registration
procedure defined in TS 23.228 [2], but with the following differences:
4\. The eP-CSCF validates the contents of the security token and confirms that
the IMS identities being registered are authorized by the security token. If
the authorization token is valid, the eP-CSCF obtains the associated
authorization information, including the IMPI and IMPU of the associated user,
the WWSF identity, and the authorization token scope, as specified in TS
33.203 [3], Annex X.
5\. The eP-CSCF forwards the authorized REGISTER request to the IMS core
network to initiate authentication-less IMS registration using TNA (see TS
33.203 [3], Annex U) procedures, with an indication that the authentication
has already been carried out. The REGISTER message contains the WWSF identity.
8\. The Iâ€‘CSCF determines the Sâ€‘CSCF and forwards the register request towards
the S-CSCF, which contains the WWSF identity.
11\. The Sâ€‘CSCF sends register information including the WWSF identity to
application servers matching initial filter criteria in the downloaded service
profile.
17\. Sâ€‘CSCF can include the WWSF identity in the invite request that is sent
to application servers as a result of initial filter criteria evaluation.
#### 7.2.1.3 Impacts
The solution implies:
\- The eP-CSCF is required to include the WWSF identity in the REGISTER
message.
\- The WWSF identity is taken into consideration when the S-CSCF and the AS
perform service control.
### 7.2.2 Solution 2: Avoiding SRVCC false trigger
#### 7.2.2.1 Solution Principles
A SRVCC procedure applying to a bearer with QCI=1 is likely to fail if this
bearer is related to a WebRTC call initiated by a script running above a
browser. This is an issue when the script runs in a device that also supports
an IMS client capable of SRVCC as the device has indicated it is supporting in
its capabilities sent to the network
eNB will not trigger the SRVCC handover if certain pre-condition(s) are not
met and/or an explicit indication is given to eNB that SRVCC is not allowed.
Option 1: If voice session is initiated by WIC, UE ensures its SRVCC network
capability is set to \"not support\" in the MME. This can be done by UE
initiating TAU with an indication that SRVCC is not supported. However, this
will not take effect until the next IDLE to ACTIVE state because \"SRVCC
operation possible\" indication is only given in S1 AP Initial Context Setup
Request. Another issue is that this means the lower layers of the UE are able
to know / detect that a QCI= 1 bearer has been initiated due to a WebRTC call
Option 2: When QCI-1 is established for a session handled by eP-CSCF, PCRF
includes an explicit indication in addition to QCI-1 (similar to video SRVCC)
to indicate to eNB that this QCI-1 is not eligible for SRVCC.
Option 3: define new QCI-x with same characteristic as QCI-1. This is not
recommended to avoid the proliferation of new QCI values that intermediate
nodes (PGW, SGW need to know to map to proper QoS at transport level)
Option 4: When MME receives the SRVCC handover required message from source
eNB, MME determines that this QCI-1 is not established for the _PDN connection
that is established for well-known IMS APN and rejects the SRVCC handover
request or perform the PS handover including the QCI-1._
Option 5: During dedicated bearer setup with QCI-1, MME aware that this is not
related to the well-know IMS APN and gives an explicit indication to eNB that
this bearer is not eligible for SRVCC.
NOTE: The above option-4 and option-5 assume IMS APN is not used.
Option 6: During WebRTC session setup, no QCI=1 bearer is setup to avoid
SRVCC.
### 7.2.3 Solution 3: WebRTC with SMSMI
#### 7.2.3.1 Solution Principles
This solution requires the WIC to follow the UE procedure as defined for SMS
submit and Delivery without MSISDN as defined in TS 23.204 [4]. Namely, the
IMS registration requirements for SMSMI and the SMS packaging without MSISDN
as defined in TS 24.341 [5].
#### 7.2.3.2 Reference Architecture with SMSMI
Figure 7.2.3.2-1 shows a combined architecture with the standard WebRTC IMS
architecture as it is defined in TS 23.228 [2] and SMSMI as defined in TS
23.204 [4].
Figure 7.2.3.2-1: WebRTC IMS + SMSMI architecture
#### 7.2.3.3 Procedures
##### 7.2.3.3.1 WIC Registration with SMSMI capability.
The following call flows in Figure 7.2.3.3.1-1 show the IMS registration
requirement for SMSMI.
In this scenario, the user has an IMS subscription and accesses the IMS via a
WebRTC web server (WWSF). The WWSF may be located in a third party network and
have a business subscription with the IMS operator.
In other to allow WIC to send/receive SMS without MSISDN, it must include the
SMSMI support indication as defined in TS 24.341 [5] as shown in step 3 below.
Furthermore, IP-SM-GW (in step 11b) needs to be aware of the IMSI of the UE
during IMS registration either from the private user identity the WIC included
in Registration or from Public user identity, see TS 24.341 [5] clause 4.4.
Figure 7.2.3.3.1-1: WIC registration with SMSMI
After successful registration, WIC can send/receive SMS without MSISDN using
the procedure defined in TS 23.204 [4].
#### 7.2.3.4 Impacts
The solution implies:
\- WIC (if support this service) needs to include the SMSMI support indicator
in Register message.
\- The IMPI or IMPU used by the WIC for IMS registration needs to include IMSI
so the IP-SM-GW can derive the IMSI for later correlation of short message as
required by TS 24.341 [5].
Editor\'s note: It is FFS on how the IMSI can be acquired for some of the
WebRTC scenarios (e.g. WIC registration of individual Public User Identity
based on web authentication or from a pool of Public User Identities, etc).
NOTE: Because message waiting flag for SMS in general requires support of HSS
per user, therefore allowing SMS to work for \"WebRTC support of IMS
subscriptions corresponding to users managed by third parties\" may not be
possible because some of those solutions uses external database (e.g, WUDB) to
manage users.
### 7.2.4 Solution 4: WebRTC with Inter-UE Transfer (IUT)
#### 7.2.4.1 General
Inter-UE Transfer (IUT) can be used to transfer a video media of a MMTEL
session from a mobile terminal using normal IMS to a computer using WIC for
better user experience.
According to TS 23.237 [6] (Â§ 4.1.3 \"Inter-UE Transfer\") and 24.337 Â§ 9.3,
the following assumptions apply for Inter-UE Transfer:
\- The UEs involved in IUT Media Control Related Procedures can belong to
different IMS subscriptions under the same operator.
\- The Collaborative Session Control can be transferred between UEs
registering Public User identities that share the same service profile (and
thus belong to the same IMS subscription).
\- There is only one Controller UE within a Collaborative Session.
\- A Controllee UE is not aware of its role within a Collaborative session and
it is not aware of the Controller UE. In that respect any UE can undertake the
role of Controllee UE.
\- (24.337 Â§ 9.3) The information of UEs that belong to the same subscription
is required at the SCC AS for the purpose of authorizing that the requested
inter UE transfer to the UE is allowed, i.e. to prevent the SC UE from
performing Inter UE Transfer to a UE with a different user subscription.
A WebRTC based UE can undertake the role of the Controllee UE without any
specific issue provided that the Controller UE can be made aware of its
registration and that this transfer is authorized by the SCC AS.
The transfer of the Collaborative Session Control as part of Inter-UE Transfer
(IUT) requires UEs that use Public User identities that share the same service
profile. According to TS 23.228 [2] figure 4.6, the following relationship
between Public User identities and Private User identities under the same IMS
subscription can exist.
Figure 7.2.4.1-1: The relation of a shared Public User Identity and Private
User Identities
For example, a user who would like to transfer his IMS session from a WIC to a
UE using normal IMS (or vice versa) must require that the both IMS
registrations are using Public User identities that share the same service
profile.
On the network side, the IUT functionality as described in TS 23.237 [6],
namely the IUT functionality defined for SCC AS needs to be followed.
#### 7.2.4.2 Reference Architecture with IUT
Support of IUT for WebRTC based terminals does not require changes to the
reference architecture.
Figure 7.2.4.2-1: WebRTC IMS and IMS UE + IUT architecture
#### 7.2.4.3 Impacts
As defined in TS 23.228 [2], there are 3 ways for WIC to perform IMS
registration. In order to allow IUT, the following requirements can be stated
as in Table 7.2.4.3-1:
Table 7.2.4.3-1: IUT requirements for WIC registration
+----------------------------------+----------------------------------+ | WIC registration method as | IUT requirement for WebRTC | | defined in TS 23.228 [2] | | +----------------------------------+----------------------------------+ | 1. WIC registration of | NO additional requirement. | | individual Public User Identity | | | using IMS authentication. | | +----------------------------------+----------------------------------+ | 2. WIC registration of | The WWSF determines the Private | | individual Public User Identity | User Identity and Public User | | based on web authentication | Identity for the WIC and returns | | | the security token which is | | | issued by the WAF to the WIC. | | | | | | The public identity given to WIC | | | must be coordinated such that it | | | shares the same service profile | | | with the public user identity | | | that IMS client will be using | | | for registration. | +----------------------------------+----------------------------------+ | 3. WIC registration of | The WWSF is provided with a pool | | individual Public User Identity | of subscriptions, each | | from a pool of Public User | containing a single unique | | Identities | IMPU/IMPI pair, to IMS and can | | | assign individual Public and | | | Private User Identities from | | | this pool. | | | | | | IUT is not supported in this | | | scenario, as the IMPU/IMPI from | | | the pool is most likely not tied | | | to the same IMS subscription | | | than for the IMS client. | | | | | | The same applies to | | | registrations associated with | | | Single HSS subscription for an | | | unbounded number of users as | | | described in Â§ 5 of this TR. | +----------------------------------+----------------------------------+
## 7.3 Evaluation
## 7.4 Conclusion
### 7.4.1 Avoid SRVCC
Option 6 is selected to avoid SRVCC.
To avoid SRVCC false trigger, it is recommended not to use QCI I for WebRTC
traffic.
An APN based solution is not further considered as it is not possible to avoid
the WIC using the IMS APN.
### 7.4.2 WebRTC related IMS service control
The WebRTC related IMS service control can be done based on current
specifications. No normative work is expected on this aspect.
### 7.4.3 WebRTC with Inter-UE Transfer (IUT)
The Inter-UE transfer feature may be provided for webRTC enabled terminals
(supporting transfer between a WIC and a UE using a plain IMS client or
between 2 WIC(s) assuming that Procedures of either clause U.2.1.2 or of
clause U.2.1.3 of TS 23.228 [2] are used to authenticate the user on the
webRTC based terminal (WIC).
NOTE: This ensures that webRTC based terminals (WIC) and IMS terminals
involved in IUT do belong to the same subscription. Other cases (e.g. in case
of inter UE transfer between devices associated with an unique Third party
subscription) are not supported in this release of the specification.
Especially this may raise scalability issues when it would require that the
same SCC AS serves all users belonging to a third part related subscription
associated with a huge number of users.
There is no normative impact to support the feature.
# 8 Architectural aspects for minimizing the need for bearer level protocol
conversion
Editor\'s note: The first action to be carried out is to determine whether SA2
work is needed in this area.
## 8.0 General description
Editor\'s note: clause 8 is related with SA1 requirements for \"Minimize the
need for bearer level protocol conversion when supporting WebRTC media
capabilities between WebRTC IMS clients without the need to convert to/from
IMS protocols\".
## 8.1 Architectural requirements
## 8.2 Solutions
### 8.2.1 Solution 1: Transmit of WebRTC specific SDP information to establish
e2e media path
#### 8.2.1.1 Reference Architecture
This solution has no impact to the WebRTC architecture. Figure 8.2.1.1-1 shows
the standard WebRTC IMS architecture as it is defined in TS 23.228 [2]. The
eP-CSCF will be used in this document to represent the network entity which
performs the same media handling and signal converting function of eP-CSCF in
Release 13 architecture.
This document only highlights the key principle of this solution and no stage
2 impact is identified; the detailed procedure will be studied in stage 3
work.
Figure 8.2.1.1-1: Standard WebRTC IMS architecture according TS 23.228 [2]
#### 8.2.1.2 Solution Principles
The solution is based on the following principles:
For the originating side:
1 If the originating end-point is a WebRTC user, then the WebRTC specific SDP
information, which includes the SRTP, ICE and data channel related
information, in addition to the converted SDP generated by eP-CSCF, are
transmitted to the terminating end-point. In the SIP message, there exists an
indication that the originator of the call is a WebRTC user. When the SIP
response message received from the terminating side indicates that the
terminating end-point of the call is also a WebRTC user, the originating side
eP-CSCF forwards the terminating WebRTC user specific SDP information, which
including the SRTP, ICE and data channel related information, to the
originating side WebRTC user.
2 If the originating end-point is not a WebRTC user, then originating side eP-
CSCF or P-CSCF follows the call procedures defined in TS 23.228 [2], and will
not contain any WebRTC indication or related SDP information in the SIP invite
message. When the SIP response message is received from the terminating side,
there is no need for the eP-CSCF or P-CSCF to check whether there is an
indication that the terminating end-point is a WebRTC user.
For the terminating side:
1 If the terminating end-point is a WebRTC user, and the SIP invite message
received from the originating side indicates that the originating end-point of
the call is also a WebRTC user, then the terminating side eP-CSCF forwards the
originating WebRTC user specific SDP information, which including the SRTP,
ICE and data channel related information, to the terminating side WebRTC user.
And the terminating side eP-CSCF includes the terminating WebRTC user specific
SDP information in the SIP message sent to the originating side. In the SIP
message, there exists an indication that the terminator of the call is a
WebRTC user.
2 If the terminating end-point is a WebRTC user, but the SIP invite message
does not indicate that the caller is a WebRTC user and does not contain any
WebRTC specific SDP information, the terminating side eP-CSCF or P-CSCF
follows the call procedures defined in TS 23.228 [2], and will not contain any
WebRTC indication or related SDP information in the SIP response message, even
the terminating side is a WebRTC user.
3 If the terminating side is not a WebRTC user, there is no need for the eP-
CSCF or P-CSCF to check whether there is an indication that the originating
end-point is a WebRTC user. And the terminating side eP-CSCF or P-CSCF follows
the call procedures defined in TS 23.228 [2], and will not contain any WebRTC
indication or related SDP information in the SIP response message.
When both the originating WebRTC client and the terminating WebRTC client
obtains the peer side SDP information, the WebRTC clients can use the ICE
mechanism to notify each other communication address candidates (host,
reflexive, and relay), and choose a media path through connectivity checks. In
Figure 8.2.1.1-2, some possible (not all) e2e media path are illustrated. In
this case, the media path is not anchored in the eIMS-AGW and the bear level
conversion is not needed any more.
Editor\'s note: The interaction between OMR and the above described solution
is FFS.
Figure 8.2.1.1-2: e2e WebRTC media path
The eP-CSCF shall include WebRTC specific information in the forwarded SDP
including the SRTP, ICE and data channel related information from the WebRTC
client. The decision of bypassing IMS network media gateways is based on the
fact that both of the communicating sides are WebRTC clients, regardless of
whether the WebRTC clients are in the same IP realm or not, and the decision
can only be made until the originating side eP-CSCF receives the SDP answer
from the terminating side.
#### 8.2.1.3 Signalling Procedures
Figure 8.2.1.3-1 illustrates the call flow diagram establishing the e2e
communication between WebRTC clients through the IMS network. When both
communicating endpoints are WICs, the two WebRTC endpoints can achieve the e2e
media path via ICE procedure based on the negotiation of originating and
terminating side SDP. As specified in TS 23.228 [2], the eIMS-AGW shall
support the media plane interworking extensions including conversion between
SRTP and RTP, termination of ICE procedure and so on.
Figure 8.2.1.3-1: establishing e2e media path between two WebRTC clients
1 WebRTC client A initiates a call, creating a Session Description Protocol
(SDP) offer with SRTP and ICE description labelled as SDP1 and sending it to
the originating side eP-CSCF. SDP1 includes WIC IP address and port, with
DTLS-SRTP and ICE specific \"m=\" lines, offered by the WIC.
2 The eP-CSCF on the originating side of the call sends media information of
SDP1 to eIMS-AGW, and obtains local media information of eIMS-AGW. The eP-CSCF
then creates a translated offer SDP (SDP2) without DTLS media security and
without ICE description based on the original caller SDP1 and the local media
information of eIMS-AGW. The eP-CSCF then includes both SDP1, which is
indicated as the original WebRTC specific offer, and SDP2 in the SIP request
message. SDP2 contains the eIMS-AGW IP addresses and ports, with RTP media
specific \"m=\" lines, generated by the eP-CSCF.
NOTE 1: SDP2 is the offer generated by eP-CSCF when it receives a session
setup request from the WIC during existing procedures in TS 23.228 [2], clause
U.2 and translates the WebRTC offer to an offer in line with media
descriptions offered by an IMS UE.
Editor\'s note: It is FFS what must be added to ensure end-to-end
transparency.
3 When the IMS core receives the SIP request message it forwards the SIP
request to the terminating side, including all of the SDP information received
from the eP-CSCF.
4 The eP-CSCF on the terminating side receives and processes the SIP request
message from the IMS core. If the eP-CSCF detects the indication in the SIP
request message that the originator is a WebRTC client, then it uses the offer
SDP1 for session establishment. The eP-CSCF sends SDP1 to the terminating
WebRTC client B. The terminating side eP-CSCF knows that the WebRTC clients
can make an e2e communication, therefore, it will not send any media
information to the eIMs-AGW or apply any media resources from the eIMS-AGW.
NOTE 2: In the case the called party is not a WebRTC client, the eP-CSCF would
not send the WebRTC related SDP offer SDP1 to the called party. Instead SDP2
is sent for end-to-end Offer/Answer.
5 The WebRTC client B uses offer SDP1 from the WebRTC client A to negotiate
media information, and then creates and sends an Answer Session Description
Protocol (for example labeled as SDP1\') with SRTP and ICE description to eP-
CSCF.
6 The eP-CSCF on the terminating side creates a SIP response message then
includes the SDP1\', which is indicated as the WebRTC specific SDP, into the
SIP response message. Since the WebRTC clients A and B can make an e2e
communication, to avoid media stream interruption detection in the IMS core,
the terminating side eP-CSCF creates a SDP answer with a HOLD state for SDP2,
labelled as SDP2\', and includes SDP2\' into the SIP response message and
sends it to IMS core.
7 When IMS core receives this SIP response message, it will forward both
SDP1\' and SDP2\' to the originating side eP-CSCF.
8 The originating side eP-CSCF receives the SIP response message. If it
detects that the SIP response message contains WebRTC specific SDP1\', it
means that both the caller and callee are WebRTC users and an e2e media path
can be established. The eP-CSCF sends SDP1\' to WebRTC client A.
9 Both WebRTC Client A and WebRTC Client B perform connectivity tests on each
received transport address candidates to determine which of the received
transport addresses are actually reachable. Once the ICE connectivity tests
are concluded and there is an agreed candidate pair for media transport, the
media can begin flowing using the selected media path.
#### 8.2.1.4 Media plane related procedures
This clause demonstrate detailed procedures which include the media plane
related handlings, in order to help understanding of the e2e media path
solution from the media handling perspective.
Two optional solutions and corresponding procedures are provided. The operator
can choose either one to implement depending on the deployment. The two
procedures are basically the same, with the difference that,
\- In clause 8.2.1.4.1, the IMS core does not need to be enhanced to support
WebRTC. Therefore, besides the e2e media path between two WebRTC clients, some
IMS media resources, applied during the call establishment, are still
reserved, until the call releases.
\- In clause 8.2.1.4.2, the IMS core is enhanced to support WebRTC, e.g. the
IMS signalling server can recognize the WebRTC specific SDP. And there is no
more IMS media resource engaged in addition to the e2e media path between the
WebRTC clients, when the call is established.
##### 8.2.1.4.1 Media plane related procedures without IMS core enhanced to
support WebRTC accessing
Figure 8.2.1.4-1: Establishing e2e media path between two WebRTC clients
without IMS core enhanced
NOTE: The dashed line of NAT and TURN in the figure means that there may exist
NAT and TURN in the e2e media path, depending on the ICE connectivity test and
the final chosen address pairs.
1 WebRTC client A initiates a call, creating a Session Description Protocol
(SDP) offer with SRTP and ICE description labelled as SDP1 and sending it to
the originating side eP-CSCF. SDP1 includes WIC IP address and port, with
DTLS-SRTP and ICE specific \"m=\" lines, offered by the WIC.
2 The eP-CSCF on the originating side of the call sends media information of
SDP1 to eIMS-AGW, and obtains local media information of T1 reserved by eIMS-
AGW. The eP-CSCF then creates a translated offer SDP (SDP2) without DTLS media
security and without ICE description based on the original caller SDP1 and the
local media information of T1. The eP-CSCF then includes both SDP1, which is
indicated as the original WebRTC specific offer, and SDP2 in the SIP request
message. SDP2 contains the T1 IP addresses and ports, with RTP media specific
\"m=\" lines, generated by the eP-CSCF.
3 When the IMS core receives the SIP request message it forwards the SIP
request to the terminating side, including all of the SDP information received
from the eP-CSCF. As IMS signalling server does not understand SDP1, the IMS
core will transmit SDP1 transparently to the terminating side. IMS core may
use SDP2 to make some media reservation depending on the network
configuration.
4 If the IMS signalling server decides to perform some media plane
transcoding, it reserves T3 on the corresponding media gateway using SDP2.
Then the IMS signalling server updates SDP2 according to the local media
information of T3.
5 The eP-CSCF on the terminating side receives and processes the SIP request
message from the IMS core. If the eP-CSCF detects the indication in the SIP
request message that the originator is a WebRTC client, then it uses the offer
SDP1 for session establishment. The eP-CSCF sends SDP1 to the terminating
WebRTC client B. The terminating side eP-CSCF knows that the WebRTC clients
can make an e2e communication, therefore, it does not need to apply any media
resources for the WIC accessing side from the eIMS-AGW. But the eP-CSCF still
needs to reserve and configure media resource T4 towards the IMS core in step
8 to keep the procedures towards the IMS core unchanged.
6 The WebRTC client B uses offer SDP1 from the WebRTC client A to negotiate
and allocate local media, and then creates an Answer Session Description
Protocol (for example labeled as SDP1\') with SRTP and ICE description to eP-
CSCF.
7 The WebRTC client B sends an Answer Session Description Protocol (for
example labeled as SDP1\') with SRTP and ICE description to eP-CSCF.
8-9 The eP-CSCF on the terminating side creates a SIP response message then
includes the SDP1\', which is indicated as the WebRTC specific SDP, into the
SIP response message. Since the WebRTC clients A and B can make an e2e
communication, to avoid media stream interruption detection in the IMS core,
the terminating side eP-CSCF reserves and configures media resource T4 towards
the IMS core, and then creates a SDP answer with a HOLD state for SDP2,
labelled as SDP2\', and includes SDP2\' into the SIP response message and
sends it to IMS core.
10 When the IMS signalling server receives the SIP response from terminating
side, if it has allocated local resource before, it uses SDP2\' to configure
the termination T3.
11-12 The IMS signalling server reserves new termination T2 towards the
originating side and then updates SDP2\' according to the local media
information of T2. As to SDP1\' in the SIP response message received, as IMS
signalling server does not understand SDP1\', the IMS Signalling server will
transmit SDP1\' transparently to the originating side.
13 When the originating side eP-CSCF receives the SIP response from
terminating side, it uses SDP2\' to configure the local media resource T1. And
If it detects that the SIP response message contains WebRTC specific SDP1\',
it means that both the caller and callee are WebRTC users and an e2e media
path can be established. Therefore, it does not need to apply any media
resources for the WIC accessing side from the eIMS-AGW.
14 The originating side eP-CSCF sends SDP1\' to WebRTC client A.
15 Both WebRTC Client A and WebRTC Client B perform connectivity tests on each
received transport address candidates to determine which of the received
transport addresses are actually reachable. Once the ICE connectivity tests
are concluded and there is an agreed candidate pair for media transport, the
media can begin flowing using the selected media path.
##### 8.2.1.4.2 Media plane related procedures with IMS core enhanced to
support WebRTC accessing
Figure 8.2.1.4-2: Establishing e2e media path between two WebRTC clients with
IMS core enhanced
NOTE: The dashed line of NAT and TURN in the figure means that there may exist
NAT and TURN in the e2e media path, depending on the ICE connectivity test and
the final chosen address pairs.
1 WebRTC client A initiates a call, creating a Session Description Protocol
(SDP) offer with SRTP and ICE description labelled as SDP1 and sending it to
the originating side eP-CSCF. SDP1 includes WIC IP address and port, with
DTLS-SRTP and ICE specific \"m=\" lines, offered by the WIC.
2 The eP-CSCF on the originating side of the call sends media information of
SDP1 to eIMS-AGW, and obtains local media information of T1 reserved by eIMS-
AGW. The eP-CSCF then creates a translated offer SDP (SDP2) without DTLS media
security and without ICE description based on the original caller SDP1 and the
local media information of T1. The eP-CSCF then includes both SDP1, which is
indicated as the original WebRTC specific offer, and SDP2 in the SIP request
message. SDP2 contains the T1 IP addresses and ports, with RTP media specific
\"m=\" lines, generated by the eP-CSCF.
3 When the IMS core receives the SIP request message it forwards the SIP
request to the terminating side, including all of the SDP information received
from the eP-CSCF. The IMS core will transmit SDP1 transparently to the
terminating side. IMS core may use SDP2 to make some media reservation
depending on the network configuration.
4 If the IMS signalling server decides to perform some media plane
transcoding, it reserves T3 on the corresponding media gateway using SDP2.
Then the IMS signalling server updates SDP2 according to the local media
information of T3.
5 The eP-CSCF on the terminating side receives and processes the SIP request
message from the IMS core. If the eP-CSCF detects the indication in the SIP
request message that the originator is a WebRTC client, then it uses the offer
SDP1 for session establishment. The eP-CSCF sends SDP1 to the terminating
WebRTC client B. The terminating side eP-CSCF knows that the WebRTC clients
can make an e2e communication, therefore, it does not need to apply any media
resources for the WIC accessing side from the eIMS-AGW. In the case the IMS
core has enhanced to support WebRTC, the eP-CSCF in the terminating side can
be configured not to apply any local media resource.
6 The WebRTC client B uses offer SDP1 from the WebRTC client A to negotiate
and allocate local media, and then creates an Answer Session Description
Protocol (for example labeled as SDP1\') with SRTP and ICE description to eP-
CSCF.
7 The WebRTC client B sends an Answer Session Description Protocol (for
example labeled as SDP1\') with SRTP and ICE description to eP-CSCF.
8 The eP-CSCF on the terminating side creates a SIP response message then
includes the SDP1\', which is indicated as the WebRTC specific SDP, into the
SIP response message. Since the WebRTC clients A and B can make an e2e
communication, and the IMS signalling server support WebRTC, the eP-CSCF in
the terminating side can be configured not to apply any local media resource.
And the eP-CSCF includes the WebRTC specific SDP1\'and invalid SDP2\' in the
SIP response message sent to the IMS core.
9 When the IMS signalling server receives the SIP response from terminating
side, if there is WebRTC specific SDP1\' in the SIP response message, the IMS
signalling server releases the local media resources applied before.
10 The IMS signalling server forwards the WebRTC specific SDP1\' and SDP2\'
transparently to the originating side.
11 When the originating side eP-CSCF receives the SIP response from
terminating side, if it detects that the SIP response message contains WebRTC
specific SDP1\', it means that both the caller and callee are WebRTC users and
an e2e media path can be established. And the eP-CSCF releases the local media
resources applied before.
12 The originating side eP-CSCF sends SDP1\' to WebRTC client A.
15 Both WebRTC Client A and WebRTC Client B perform connectivity tests on each
received transport address candidates to determine which of the received
transport addresses are actually reachable. Once the ICE connectivity tests
are concluded and there is an agreed candidate pair for media transport, the
media can begin flowing using the selected media path.
### 8.2.2 Solution 2: OMR-based e2e media transport
#### 8.2.2.1 Reference Architecture
This solution has no impact to the WebRTC architecture.
#### 8.2.2.2 Solution Principles
The solution re-uses the Rel-10 OMR to achieve e2e media transport.
A new IP realm is defined for WebRTC access to IMS. All the operators share
the same IP realm when the WebRTC .
From the stage-3 aspect as per 29.079, the \"a line\" for WebRTC IP realm in
the SDP offer can be:
a=visited-realm:1 WebRTC.operator.net IN IP4 192.0.2.1 49170
In the originating side:
1\. If the originating end-point is a WebRTC user, the eP-CSCF will allocate
an eIMS-AGW and create a new visited realm instance for the incoming realm,
i.e. WebRTC specific realm. The eP-CSCF forwards connection information for
eIMS-AGW in the SDP offer along with prior SPD information and visited realm
instances for both the incoming and outgoing realms. When eP-CSCF receive the
SDP answer, if it finds the both end are WebRTC user by checking the IP realm
in the SDP answer, it will de-allocate the eIMS-AGW and forward the SDP answer
to originating end-point.
2 If the originating end-point is not a WebRTC user, then originating side eP-
CSCF or P-CSCF follows the call procedures defined in TS 23.228 [2].
In the terminating side:
1 If the terminating end-point is a WebRTC user, and the originating side
realm in the SDP offer is WebRTC specific, then the terminating side eP-CSCF
forwards the originating WebRTC user specific SDP information to the
terminating side WebRTC user. When eP-CSCF receives the SDP answer, it does
not allocate the eIMS-AGW and create a new visited realm instance for the
incoming realm, i.e. WebRTC specific realm. It forwards the SDP answer to the
originating side with the visited realm instances.
2 Otherwise, the terminating side eP-CSCF or P-CSCF follows the call
procedures defined in TS 23.228 [2].
When both the originating WebRTC client and the terminating WebRTC client
obtains the peer side SDP information, the WebRTC clients can use the ICE
mechanism to establish the e2e media transport.
#### 8.2.2.3 Procedures
Figure 8.2.2.3-1 illustrates the call flow diagram establishing the e2e
communication between WebRTC clients through the IMS network. IMS-ALG
represents zero or more IMS-ALG(s) that may be present on the signalling path
between eP-CSCF-1 and eP-CSCF-2, and TrGWa represents the zero or more TrGW(s)
respectively allocated by these IMS-ALG(s).
Figure 8.2.2.3-1: establishing e2e media path using OMR
1\. WebRTC client (WIC-1) initiates a call, creating a Session Description
Protocol (SDP) offer SDP1 and sending it to the originating side eP-CSCF. The
SDP offer may contain SRTP, ICE, Data channel information. The WIC-1 IP
address is IP1.
2\. The eP-CSCF-1 receives SDP offer from WIC-1. The eP-CSCF-1 creates a
WebRTC specific realm instance for the incoming realm, i.e. Rw. It allocates
eIMS-AGW1 between realm Rw and R1.
3\. The eP-CSCF-1 forwards connection information for eIMS-AGW1 in the SDP
offer along with IP realm instance Rw and R1 (outgoing realm).
4\. The IMS-ALG receives SDP offer from R1. It allocates TrGWa between realm
R1 and R2.
5\. IMS-ALG forwards connection information for TrGWa in the SDP offer along
with prior IP realm instance information Rw+R1 and visited realm instances for
both the incoming and outgoing realms.
6\. Since outgoing realm Rw is the same with the realm in the SDP offer, the
eP-CSCF-2 can avoid allocating an eIMS-AGW, and the previously allocated eIMS-
AGW1 and TrGWa can be bypassed.
7\. The eP-CSCF-2 forwards SDP offer to WIC-2.
8\. The eP-CSCF-2 receives an SDP answer with from WIC-2.
9\. The eP-CSCF-2 forwards the SDP answer after including an IP realm instance
for the connection information from the SDP answer in step 8. The IP realm
instance in the SDP answer identifies a corresponding realm instance from the
SDP offer associated with the same IP realm, thus uniquely identifying the
TrGWs and eIMS-AGW to be bypassed.
10\. IMS-ALG de-allocates TrGWa since there is no valid connection information
available in the SDP answer for realm Rw.
11\. IMS-ALG forwards the SDP answer.
12\. The eP-CSCF-1 de-allocates eIMS-AGW1 since there is no valid connection
information available in the SDP answer for realm Rw.
13\. The eP-CSCF-1 forwards the SDP answer to WIC-1.
14\. A user plane connection is now established without the need to allocate
any additional IMS-AGWs.
### 8.2.3 Solution 3: OMR-based e2ae media transport
#### 8.2.3.1 Reference Architecture
This solution has no impact to the WebRTC architecture.
#### 8.2.3.2 Solution Principles
This is a variant of Solution 2 (see clause 8.2.2) which complies with the
Lawful Interception requirements. The difference compared to Solution 2 is as
follows: when the eP-CSCF knows that the remote end is a WIC, instead of
bypassing the eIMS-AGWs, the eIMS-AGWs remain allocated but media plane
interworking is disabled, except when LI is needed.
This results in the following behaviour:
\- When LI is not performed, WebRTC media traverses the IMS-AGW, but remains
encapsulated with the WebRTC protocols.
\- When LI is performed, WebRTC media traverses the IMS-AGW, and media plane
interworking is performed, i.e. same as Rel-12.
Solution 3 only applies when there is no IMS media plane entity between the
eIMS-AGWs.
#### 8.2.3.3 Procedure
Figure 8.2.3.3-1 illustrates the call flow diagram establishing the e2ae
communication between WebRTC clients through the IMS network. I/S-CSCFs are
not shown for brevity.
Figure 8.2.3.3-1: establishing e2ae media path using OMR
1\. WebRTC client (WIC-1) initiates a call, creating a Session Description
Protocol (SDP) offer SDP1 and sends it to the originating side eP-CSCF. The
SDP offer may contain SRTP, ICE, Data Channel information. The WIC-1 IP
address is IP1.
2\. The eP-CSCF-1 receives SDP offer from WIC-1. The eP-CSCF-1 creates a
WebRTC specific realm instance for the incoming realm, i.e. Rw. It allocates
eIMS-AGW1 between realm Rw and R1.
3\. The eP-CSCF-1 forwards connection information for eIMS-AGW1 in the SDP
offer along with IP realm instance Rw and R1 (outgoing realm).
4\. eP-CSCF-2 allocates eIMS-AGW2 between realm Rw and R1.
5\. The eP-CSCF-2 forwards SDP offer to WIC-2.
6\. The eP-CSCF-2 receives an SDP answer from WIC-2.
7\. According to received SDP answer, the eP-CSCF-2 knows that there is no
bearer level protocol conversion because both ends of the session are in realm
Rw. So eP-CSCF-2 deactivates media plane interworking in eIMS-AGW2.
8\. The eP-CSCF-2 forwards the SDP answer including connection information for
eIMS-AGW2.
9\. According to received SDP answer, the eP-CSCF-1 knows that there is no
bearer level protocol conversion. So eP-CSCF-1 deactivates media plane
interworking in eIMS-AGW1.
10\. The eP-CSCF-1 forwards the SDP answer to WIC-1.
## 8.3 Evaluation
## 8.4 Conclusion
Because of Lawful Interception requirements, the solutions in clauses 8.2.1
and 8.2.2 are not accepted.
The solution in clause 8.2.3 is selected to minimize the need for bearer level
protocol conversion.
# 9 Architectural aspects to support for end to end WebRTC security
Editor\'s note: The first action to be carried out is to determine whether SA2
work is needed in this area.
## 9.0 General description
Editor\'s note: Clause 9 is related with SA1 requirements for \"Support for
end to end WebRTC security, subject to regulatory constraints, that avoids
conversion between WebRTC and IMS security protocols\".
## 9.1 Architectural requirements
## 9.2 Solutions
## 9.3 Evaluation
## 9.4 Conclusion
# 10 Conclusion
WebRTC support of IMS subscriptions corresponding to users managed by third
parties (clause 5 of the TR):
\- Conclusions are expressed in clause 5.4;
Third-party realization of communication services (clause 6 of the TR):
\- Work on this item is stopped: there will be no normative work on this topic
for Rel13;
Interworking of Rel-12 or earlier IMS services with WebRTC (clause 7 of the
TR) that actually corresponds to multiple key issues:
\- WebRTC service control: Conclusions are expressed in clause 7.4;
\- Avoiding SRVCC false trigger: Conclusions are expressed in clause 7.4;
\- WebRTC with SMSMI: Work on this item is stopped: there will be no normative
work on this topic for Rel-13;
\- WebRTC with Inter-UE Transfer (IUT): Conclusions are expressed in clause
7.4;
Architectural aspects for minimizing the need for bearer level protocol
conversion (clause 8 of the TR):
\- Conclusions are expressed in clause 8.4;
Architectural aspects to support for end to end WebRTC security:
\- This topic is under responsibility of SA WG3. Potential further SA WG2 work
on this item/key issue would be based on SA WG3 request.
#