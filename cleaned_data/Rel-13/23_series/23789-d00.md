# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document studies and evaluates architectural enhancements required
for 3GPP systems to provide monitoring service capability as per the service
requirements defined in TS 22.368 [2], clause 7.2.8 and TS 22.101 [10], clause
29.2.
The end-to-end application layer aspects between UEs and Application servers
including SCS (which can be located outside or inside the network operator\'s
domain) are out of the scope of this study.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.368: \"Service Requirements for Machine-Type Communications\".
[3] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
[4] OMA API Inventory:
\"http://technical.openmobilealliance.org/API/APIsInventory.aspx\".
[5] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[6] 3GPP TR 23.708: \"Architecture Enhancements for Service Capability
Exposure\".
[7] 3GPP TS 23.203: \"Policy and charging control architecture\".
[8] 3GPP TS 23.271: \"Functional stage 2 description of Location Services
(LCS)\".
[9] 3GPP TS 29.272: \"Mobility Management Entity (MME) and Serving GPRS
Support Node (SGSN) related interfaces based on Diameter protocol\".
[10] 3GPP TS 22.101: \"Service aspects; Service principles\".
[11] 3GPP TS 32.422: \"Telecommunication management; Subscriber and equipment
trace; Trace control and configuration management\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and TS 22.368 [2] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
MTC Machine Type Communications
M2M Machine-to-Machine
# 4 Architectural Assumptions
Monitoring feature is intended to use applicable architecture enhancements
determined as part of AESE work item. Any new service capability exposure and
interface should fit in Service Capability Exposure Framework defined in TR
23.708 [6].
# 5 Key Issues
## 5.1 Key Issue 1 - Monitoring
### 5.1.1 Description
Monitoring is intended for monitoring of configured events. This comprises of
means that allow for activating monitoring of specific events, the event
detection and the reporting to authorised users, e.g. for use by applications
or logging. For MTC Devices, it is desirable that the network detects and
reports events (including location) caused by those. If such an event is
detected, the network might be configured to perform special actions, e.g.
limit the access or reduce the allocated resource.
This key issue aim at studying and providing solutions for enhancements to
3GPP procedures for monitoring functionality and it\'s exposure that includes
configuration of monitoring events, monitoring event detection and reporting
to 3rd party application provider.
### 5.1.2 Required Functionality
The following architectural requirements need to be met:
**Configuration of Monitoring Events and actions by 3rd party application
provider:**
\- It needs to be possible to configure following monitoring events in the
3GPP system,
\- monitoring the association of the MTC Device and UICC and/or new IMSI-IMEI-
SV association.
\- Location of the MTC Device, and change in location of the MTC Device.
> NOTE 1: Location granularity for event request, or event report, or both
> could be at cell level (CGI/ECGI), LA/TA/RA level, Presence Area reporting
> level, or other formats e.g. shapes (e.g. polygons, circles etc.) or civic
> addresses (e.g. streets, districts etc.) as referenced by OMA Presence API
> [4].
\- loss of connectivity i.e. when the network considers it is no longer
possible to establish signalling between the MTC Device and the network.
> NOTE 2: The maximum detection time of loss of connectivity is on the order
> of 1 minute to 1 hour.
\- Communication failure.
\- Roaming status (i.e. Roaming or No Roaming) of the MTC device, and change
in roaming status of the MTC device.
> NOTE 3: Roaming status means whether the MTC device is in HPLMN or VPLMN.
\- Serving network of the MTC device, and change of the serving network of the
MTC device
\- Reporting the number of UEs present in a certain area, with a single report
or regular reporting.
\- It needs to be possible to allow configuration of the monitoring events,
wherever applicable, in the 3GPP system for one-time reporting of event(s), or
continuous reporting of event(s). Continuous reporting may be requested with
additional criteria such as maximum number of reports, reporting interval,
etc.
\- It needs to be possible to configure the action to be executed by the
network when configured monitoring event is detected, for example - reduce
services provided to the UE, restrict access of the UE, detach the UE, etc.
\- It needs to be possible to configure the maximum time between the actual
loss of connectivity and its detection.
\- It needs to be possible for the network to authorize a Service Request to
configure subscribed monitoring events/actions from 3rd party application
provider.
**Detection of Monitoring Events:**
\- It needs to be possible for the network to detect monitoring events. On
detection of the monitoring event the Network may execute a configured action.
**Reporting of Monitoring Events to 3^rd^ party application provider:**
\- It needs to be possible for the UE or network to report the detected events
to the 3rd party application provider. Event reporting may provide more
detailed information like the cause for a detected communication failure
event. Application layer reporting of monitoring events is outside the scope.
# 6 Solutions
## 6.1 Solution 1: Monitoring via HSS
### 6.1.1 Description
#### 6.1.1.1 General
An architecture model for monitoring via HSS is depicted in the following
figure.
Figure 6.1.1.1-1: Monitoring architecture model
The main idea of the reference architecture is that the SCEF receives the
monitoring event subscription request or status queries from SCS or
Application Server via API and distributes those to HSS in HPLMN. HSS based
monitoring functionality provides monitoring event reports via SCEF to SCS/AS.
Editor\'s note: Whether an IWF is needed in addition for providing specific
functionality is tbd.
#### 6.1.1.2 Flow for Monitoring event configuration
Figure 6.1.1.2-1 illustrates the procedure of monitoring event configuration.
Figure 6.1.1.2-1: Monitoring Configuration flow
1\. The SCS/AS sends a Monitoring Request to the SCEF.
2\. The SCEF checks that the SCS/AS is authorised to request monitoring and
that the SCS/AS has not exceeded its quota or rate of submitting monitoring
requests over Tsp. If this check fails the SCEF sends a Monitoring Request
Response message, i.e. proceeds with step 7.
Editor\'s note: The need for an IWF is FFS, e.g. the quota or rate
verification may be performed by an additional IWF if not performed by the
SCEF.
3\. More detailed authorization verification may be performed by the HSS,
which verifies whether the requested monitoring events are permitted for the
SCS/AS for the specifically targeted UE. If permitted, the HSS configures any
monitoring events that are managed by the HSS and stores the SCS/AS ID for
reporting when the event happens. If the HSS managed monitoring events require
also reporting from serving CN nodes the HSS configures monitoring events in
serving CN nodes.
4 The HSS sends a Subs-Notif Resp message indicating which monitoring events
are configured successfully and which failed, possibly indicating a cause per
failed monitoring event.
5\. If the HSS managed monitoring events require reporting from serving CN
nodes, the HSS configures monitoring events in serving CN nodes. Depending on
the event there may be different messages for configuring events or querying
state information. E.g. for UE reachability it may be the message UE-
REACHABILITY-NOTIFICATION-REQUEST. For other events it may be through the
existing subscription downloading procedures (e.g., during Attach/RAU/TAU
procedure etc. or as part of an Insert Subscriber Data procedure).
6\. The SGSN/MME configures the requested monitoring events and confirms
success or failure to HSS.
When the monitoring request requires the involvement of other nodes (e.g. eNB,
SGW, PGW/GGSN), the SGSN/MME propagates the monitoring request towards these
nodes.
7\. The SCEF sends a Monitoring Request Response indicating which monitoring
events are configured successfully and which failed, possibly indication a
cause per failed monitoring event.
Monitoring configuration data that is stored in HSS and relevant for the
SGSN/MME is sent to the SGSN/MME whenever the HSS provisions the SGSN/MME with
subscriber data, e.g. during an attach, or when a need for configuring events
occurs.
#### 6.1.1.3 Monitoring event reporting flows
##### 6.1.1.3.1 Monitoring event reporting via HSS
The figure 6.1.1.3.1-1 illustrates reporting monitoring events from SGSN/MME
to SCS/AS via SCEF.
Figure 6.1.1.3.1-1: Monitoring event reporting
1\. Depending on the monitoring event, the SGSN/MME detects a monitoring event
and reports it to HSS using the signalling that applies for the specific
event, e.g. UE-Activity-Notification for UEs that become reachable.
2\. Depending on the monitoring event the HSS forwards a received notification
or the HSS itself detects an event. The HSS reports the HSS or SGSN/MME
detected monitoring event to the SCEF using Sh Notification signalling. HSS
report includes the SCS/AS ID.
3\. The SCEF sends monitoring event report to the appropriate SCS/AS.
#### 6.1.1.4 Specific Monitoring Event handling
Using Sh interface, which is designed for providing Application Servers with
HSS based or HSS accessible information, the full set of information that is
defined for Sh becomes available for monitoring via HSS when Sh accessible
information is exposed by the SCEF. This includes already \"UE Reachability\"
as well as various other status information, like MM and SM status or also
location information (with granularity: node, registration area, cell, RAT,
time zone) and that with or without paging the UE for determining the
information.
Additional, not yet supported monitoring events are described in the
following.
**Monitoring Event: Change of the association between the ME and the UICC**
This event is configured in the HSS. Attach and other procedures today already
transfer any changed IMEI-SV to the HSS, to some extent depending on
activation of other features like ADD. This functionality is new only for the
HSS. The HSS compares the received IMEI-SV with the stored IMEI-SV and reports
any difference towards the SCS/AS that subscribed to that information.
As an action it may be configured in HSS that only the stored IMEI-SV is
permitted to receive services from the network. Any registration request from
a UE with a different IMEI-SV gets rejected by the HSS.
**Monitoring Event: Loss of connectivity**
For the \"loss of connectivity\" the serving MME/SGSN notifies the HSS when it
is no longer possible to establish signalling between the UE and the network.
The HSS notifies the SCS/AS. When subscribing to this event the SCS/AS may
provide a time period value after which \"loss of connectivity\" shall be
detected. It is up to operator\'s policy to determine what time values are
acceptable. This time period value should be considered by the serving node as
it determines the periodic RAU/TAU timers for the UE
NOTE: The network should ensure that the periodic RAU/TAU timers for the UE
remain above lower bound values both for preserving the battery of the UE and
for managing the signalling load of the network.
**Monitoring Event: Indication of roaming status**
This event is subscribed at the HSS, and the event reporting condition may be
per starting/stopping roaming, per serving PLMN change or per roaming country
change. Attach and other mobility management procedures already transfer
location update notification to HSS, and HSS can identify the roaming status
from the serving PLMN ID. Event reporting is triggering by the requested
condition. The HSS reports the notification (i.e. Roaming/No roaming, the
serving PLMN ID, roamed to country) to the SCEF.
In addition to the event condition to report when roaming starts/stops, the
serving PLMN or the visited country changes, the monitoring request also
indicates whether continuous reporting or a limited number of reports is
requested. A request for a single report is assumed to deliver immediately the
current status, like also any other request delivers as the first event report
the current status that is then the basis for any subsequent reports of
changes.
### 6.1.2 Impacts on existing nodes and functionality
The SCEF will need to:
\- use, for example, the Sh interface with enhancements, such as subscribing
to and receiving notifications for subscribed events, resolution of external
identifier(s) to internal identifiers used by the 3GPP system, etc.
The HSS will need to:
\- act basically unchanged for handling events or status queries that the HSS
already supports. For example, UE reachability and various other status
information is already offered via Sh.
\- The HSS needs to implement the new subscription related events when any new
events are identified and agreed as being added to the set of already
supported events.
> Other entities like SGSN/MME and SGW/PGW/GGSN will need to:
\- act basically unchanged for handling events or status queries that the
entities already supports.
\- implement new event monitoring and reporting actions when new events are
identified and agreed as being added to the set of already supported events.
### 6.1.3 Solution Evaluation
**Benefits:**
\- Session and subscription based monitoring are offered with efficient reuse
of already existing monitoring functionality.
\- Control of access to that monitoring functionality is performed by the
SCEF, not adding this to HSS functionality.
**Drawbacks:**
Increases performance needs for involved network entities, e.g. increases
signalling traffic and storage needs in HSS.
## 6.2 Solution 2: Monitoring via PCC
### 6.2.1 Description
#### 6.2.1.1 General
An architecture model for monitoring via PCC is depicted in the following
figure.
Figure 6.2.1.1-1: Monitoring architecture model - non-roaming
The main idea of the reference architecture is that the SCEF receives the
monitoring event subscription request or status queries from SCS or
Application Server via API and distributes those to PCRF in HPLMN. PCC based
monitoring functionality provides monitoring event reports via SCEF to SCS/AS.
The SCEF plays the role of an AF in PCC reference architecture.
#### 6.2.1.2 Flow for Monitoring event configuration
Figure 6.2.1.2-1 illustrates the procedure of monitoring event configuration.
Figure 6.2.1.2-1: Monitoring Configuration flow
1\. The SCS sends a Monitoring Request message (the external identity/MSISDN,
list of monitoring events) to the SCEF.
2\. The SCEF checks that the SCS or AS is authorised to send monitoring event
requests and that the SCS or AS has not exceeded its quota or rate of
submitting monitoring requests. If this check fails, the SCEF sends a
Monitoring Event Response message, i.e. proceeds with step 6.
3\. More detailed authorization verification may be performed by the HSS,
which verifies whether the requested monitoring events are permitted for the
SCS/AS for the specifically targeted UE.
4 The HSS sends a Monitoring Request Response message.
5\. If requested monitoring events are managed via PCC, the SCEF initiates
monitoring event configuration to PCRF.
6\. If the monitoring event can´t be reported immediately PCRF reply to SCEF
that the request is accepted.
7\. The SCEF sends a Monitoring Request Response message indicating which
monitoring events are configured successfully and which failed, possibly
indication a cause per failed monitoring event.
8\. If monitoring event requires continuous reporting, then the PCRF stores in
SPR, the monitoring event, the SCEF address and the ASP address to report.
9\. The SPR confirms to the PCRF that the event is stored.
10\. The PCRF provisions the PCEF using procedures from TS 23.203 [7]. The
procedures are shown extended to include SGSN/MME as depending on the PCC
events it will cause configuration of SGSN/MME, e.g. for location reporting.
11\. The PCRF reports to the SCEF that the monitoring event was configured and
its value.
12\. The SCEF sends a Monitoring Request Response message indicating which
monitoring events are configured successfully and which failed, possibly
indication a cause per failed monitoring event and the monitoring event value.
Monitoring configuration that is stored in HSS and relevant for SGSN/MME is
sent to SGSN/MME any time when the HSS provisions the SGSN/MME with subscriber
data, e.g. during an attach.
With above procedures, the HSS based monitoring events can be configured
similar to trace configuration (refer to TS 32.422 [11]) by the SCEF or
directly pre-configured (subscribed) in the HSS.
##### 6.2.1.2.1 Information flow to configure loss of connectivity
As shown in figure 6.2.1.2.1-1, the SCEF/AF may subscribe to \"release of
bearer\" over Rx, the media description or application identifier to identify
the service will also be provided, at the time a bearer is deactivated, PCC
Rules are removed; the PCRF reports that the bearer is released to the AF. The
SCEF will notify to the AS that connectivity for the user is lost.
Alternatively (not shown in the figure below), if the PDN connection is
deactivated, PCC Rules are removed, the PCRF reports that the AF session
should be released. The SCEF will notify to the AS that connectivity for the
user is lost.
Figure 6.2.1.2.1-1: IP-CAN session modification. Configuration of loss of
connectivity
1\. AF requests reporting existing event for \"release of bearer\" the AF
provides Media information or alternately an Application Identifier to the
PCRF. The subscriber-id and the monitoring event are provided over Rx.
2\. PCRF maps external subscriber-id to subscriber id known by the IP-CAN,
PCRF generates PCC Rules that includes Service Data Flow Templates based on
the media description or the application identifier received from the AF.
3\. PCRF provisions PCC Rules.
4\. PCEF sends an acknowledgment. The PCEF may establish or modify a bearer
for the installed PCC Rule.
#### 6.2.1.3 Monitoring event reporting flows
##### 6.2.1.3.1 Monitoring event reporting via PCRF
The figure 6.2.1.3.1-1 illustrates reporting monitoring event from GGSN/P-GW.
Figure 6.2.1.3.1-1: Monitoring event reporting flow
1\. PCC reporting as of TS 23.203 [7] informs the H-PCRF when configured
events happen.
2\. The PCRF sends a monitoring event report to the SCEF that has requested
the monitoring actions.
3\. The SCEF sends a monitoring event report to the SCS/AS that initiated the
monitoring session.
##### 6.2.1.3.2 Information flow to retrieve location
Figure 6.2.1.3.2-1. IP-CAN session modification. Reporting UE enters or leaves
reporting area
1\. PCEF is notified that UE entered or left the PRA-id, using procedures
defined for in clause 7.4.1 of TS 23.203 [7].
2\. PCRF reports to the AF in SCEF that the UE entered or left the PRA-id.
3\. SCEF reports it to the SCS/AS.
#### 6.2.1.4 Specific Monitoring Event handling
**Monitoring Event: Change of Location**
The AF (i.e. SCEF) may request to report a monitoring event change of point of
attachment/change of UE presence in a geographical area to the PCRF. If the
monitoring event requires persistent from IP-CAN session to IP-CAN session,
then the PCRF stores subscription to monitoring events in SPR, as well as the
SCEF address to report and the AS name to report. This information is used for
later notifications to the SCEF when the monitoring event is detected and
reported. Monitoring event is retrieved at IP-CAN session establishment and
monitoring reporting is a standalone transaction.
When this Monitoring Event is requested, already existing PCC based location
reporting functionality over Gx gets activated to report any location change
with the required location granularity, e.g. cell or TA, towards PCRF. The
PCRF deactivates the location reporting functionality when the first change of
location is reported over Gx.
The AF (i.e. SCEF) may request to report a change of UE presence in a
geographical area: This monitoring event is realized using Change of presence
in Presence Reporting Area that is defined over Gx with Presence reporting
area identifiers and lists of Presence Reporting Area elements defined in
SPR/UDR. In addition, the PRA identifier can be received over Rx interface is
extended to report that UE entered or left a reporting area.
In addition actions may be configured, like reducing service when the event
occurs. e.g. the PCC rules may be configured to reduce the maximum bitrate
when the UE moves outside the normally used area.
Editor\'s note: A translation function which maps from internal IPCAN location
identifiers to geographical location identifiers is needed, where to locate it
requires further investigation.
**Monitoring Event: Loss of connectivity/Communication failure**
If loss of the radio connection is of interest a GBR bearer has to be used as
this bearer gets released when the radio connection gets lost. This bearer is
managed using PCC and PCC informs the SCEF when the bearer is released. The
existence of a non-GBR bearer may be monitored in the same way. However this
bearer is not released when the radio connection is lost. This bearer might be
released by the P-GW when there is no activity for a long time. And then also
connectivity is lost. If the PDN connection is deactivated, PCC Rules are
removed; the PCRF reports that the AF session should be released. The SCEF
will notify to the AS that connectivity for the user is lost.
**Monitoring Event: Serving NW changes/Roaming changes**
The AF (i.e. SCEF) may request to report the serving NW. When this Monitoring
Event is requested, already existing event triggers to report serving NW
changes towards PCRF. The PCEF reports the serving NW that currently services
the UE. For the case of one time location, the PCRF deactivates the serving NW
event trigger immediate after the current serving NW is received.
In addition actions may be configured, like reducing service when the event
occurs using operator policies in PCRF.
### 6.2.2 Impacts on existing nodes and functionality
SCEF will need to:
\- Receive the monitoring event subscription request or status queries from
SCS/AS. Controlling access by Service Requestors to monitoring services and
information.
\- Distribute the monitoring event subscription request or status queries to
the HSS via Sh and/or to the PCRF via Rx.
\- Receive monitoring event reports or status information from the HSS or the
PCRF (when subscribed via Rx) and transfer those to the SCS.
\- Contact DRA to find PCRF(s) serving UE´s IP-CAN session(s). Contact one of
the PCRFs to subscribe or unsubscribe to event triggers to report change of
location or change of service network.
PCRF will need to:
\- act basically unchanged for loss of connectivity or communication failure
event reporting that PCC already supports.
\- For change of point of attachment reporting, PCC can perform location
reporting with different location granularity over Gx interface allowing for
detecting a changed point of attachment. The PCRF removes the event trigger
when the change of point of attachment is detected. The PCRF reports the
change of point of attachment to the AF.
\- For change of UE presence in a geographical area reporting, to report this
event to the AF, extensions to Rx are required to send an indication that the
UE entered or left a certain PRA, when the event is locally configured in the
SPR, the monitoring event reporting is a standalone transaction.
### 6.2.3 Solution Evaluation
**Benefits:**
\- Session and subscription based monitoring are offered with efficient reuse
of already existing monitoring functionality.
\- Control of access to that monitoring functionality is performed by the
SCEF, not adding this to PCC based monitoring.
\- SCS and Application server can access 3GPP monitoring functionality via a
single SCEF provided interface.
**Drawbacks:**
\- Using the SCEF to unify access PCC based monitoring may introduce
session/context based functionality for the SCEF. It is however likely that
any other approach offering continuous reporting of session/bearer events may
also need to establish some session for this.
## 6.3 Solution 3 - Monitoring via MME/SGSN and HSS
### 6.3.1 General description
The main idea of this solution is to use direct new interface between MME/SGSN
and Service Capability Exposure Function (SCEF) for monitoring event
configuration, reporting etc. Further this solution includes also the
functionality of HSS based monitoring and reporting. Thereby gaining
flexibility to configure and/or report monitoring events via HSS or via direct
new interface.
The monitoring via HSS path is intended for infrequent events reporting or
when MME/SGSN based monitoring is not available (i.e. when a MME/SGSN does not
support a requested monitoring feature).
Before the detection and reporting of Monitoring events, the Monitoring
configuration data is provided to the network entities which perform the
detection and reporting of Monitoring events. The Monitoring configuration
data provides the information related to the detection/reporting of Monitoring
events, such as: the Monitoring event type, corresponding actions to the
event, the identity of AS which subscribes via SCEF the Monitoring events, the
activation/deactivation of each Monitoring event, etc.
To support MTC Monitoring feature in roaming scenario, roaming agreement needs
to be made between HPLMN and VPLMN, and the new direct interfaces need to be
designed to support roaming.
#### 6.3.1.1 MTC monitoring configuration at SGSN/MME
Figure 6.3.1.1-1 illustrates the procedure of MTC Monitoring configuration at
SGSN/MME.
Figure 6.3.1.1-1: Monitoring call flow at SGSN/MME
1\. The SCS/AS sends a Monitoring Request message to the SCEF with the
configuration for a particular monitoring event such as Monitoring Event ID
and associated parameters, Monitoring Event Priority, Monitoring Destination
node etc.
2\. The SCEF checks that the SCS/AS is authorised to send monitoring requests
and that the SCS has not exceeded its quota or rate of submitting monitoring
requests. If this check fails the SCEF sends a Monitoring Response message
with a cause value indicating the reason for the failure condition and the
flow stops at this step.
3\. The SCEF sends a Monitoring Request message to the HSS with the monitoring
event configuration details (e.g.: Monitoring Event ID). The SCEF stores the
Monitoring Event ID, the Monitoring Destination node and possibly other
parameters.
4\. The HSS verifies the monitoring event information. For option A monitoring
events are configured in HSS as part of UE subscriber data.
5\. The HSS sends the Monitoring Response to the SCEF when accepting the
Monitoring Request. For option B it includes the address(es) of the serving
node(s).
6\. The SCEF forwards the Response to the SCS/AS. If the cause value from HSS
indicates the SCS/AS is not allowed monitor this event or this UE, or there is
no valid subscription information a confirm message is sent with a cause value
indicating the reason for the failure condition and the flow stops at this
step.
> **Option A**
7\. Based on type of event configuration requested the HSS determines the
destination node for the monitoring event. For example in case of monitoring
event configuration at MME, the HSS sends a message to MME with the monitoring
event data. The UE may be registered with both MME and SGSN, which requires
sending Submit Request to both nodes. The Submit Request indicates the
monitoring event configuration and the target address for the event report,
e.g. the HSS or the SCEF.
8\. SGSN/MME on receiving Submit Request configures the monitoring event by
generating a Monitoring configuration context. The MME/SGSN confirms the
monitoring request submission. The Monitoring configuration context is stored
as part of UE context. The target address for the event report (HSS or SCEF)
is also stored in the Monitoring configuration context.
> **Option B**
7\. Based on type of event configuration requested SCEF determines the
destination node for the monitoring event based on the information received
from SCS and HSS or based on other information. For example in case of
monitoring event configuration (or activation/deactivation) at MME, SCEF sends
a message to MME with the monitoring event data. The UE may be registered with
both MME and SGSN, which requires sending Submit Request to both nodes. The
Submit Request indicates the monitoring event configuration and the target
address for the event report, i.e. the SCEF address.
8\. SGSN/MME on receiving submit request configures the monitoring event by
generating a Monitoring configuration context. The MME/SGSN confirms the
monitoring request submission. The Monitoring configuration context is stored
as part of UE context, if the monitoring event configuration is specific for a
UE. The SCEF address is also stored in the Monitoring configuration context.
The Monitoring configuration context is exchanged between SGSN/MMEs during
mobility procedure (e.g. HO/TAU/RAU), so that the target SGSN/MME can be aware
of the Monitoring event trigged by the MM procedure and perform corresponding
actions e.g. reporting Monitoring event.
9\. The serving node is configured for monitoring.
10\. When the MME/SGSN deletes the UE\'s monitoring context due to purging the
UE, the HSS knows it when receiving the Purge message. No other signalling is
performed in that situation for option A.
11\. For option B the serving node indicates a deletion of the subscribed
monitoring event to the target address for the event report, i.e. to the SCEF.
#### 6.3.1.2 Reporting of monitoring events from SGSN/MME
The following figure illustrates the procedure flow of reporting Monitoring
events to the SCS/AS.
Figure 6.3.1.2-1: Reporting monitoring events from the SGSN/MME
1\. A monitoring event is detected by SGSN/MME.
2\. The SGSN/MME sends a Monitoring event report to the SCEF, which is
directly (2.1) or via HSS (2.2). The target address for sending the report is
stored by the SGSN/MME as part of the subscribed event. Option A determines
using 2.1 or 2.2 based on the target address for the event report. Option B
uses only 2.2.
3\. The SCEF derives the Identity of the Monitoring Destination node from its
stored context. For reports where UE identities are included the SCEF may need
to map those into anonymous identities and stores the mapping for handling any
subsequent API requests that may include those anonymous identities. The SCEF
sends the Monitoring event report to the Monitoring Destination node.
#### 6.3.1.3 Charging
Charging is provided on per Monitoring event detection/report basis. The
SGSN/MME and SCEF generates CDRs taking into account successful and
unsuccessful configuration and delivery of Monitoring event report. The
generated CDRs allow also for inter operator charging.
#### 6.3.1.4 Specific Monitoring Event Handling
**Monitoring Event: Loss of connectivity**
Stage-1 requirement has specified in TS 22.368 [2] that \"Loss of
connectivity\" means it is no longer possible to establish signalling between
the MTC Device and the network. Loss of connectivity event is configured at
serving SGSN/MME via the HSS. When the mobile reachable timer expires at
serving SGSN/MME \"Loss of connectivity\" event is detected and reported
directly to SCEF via new interface.
NOTE 1: To accommodate for PSM a separate \"active timer\" needs to be
described in TS 23.060/401 to make the mobile reachable timer available for
detecting loss of connectivity in general, i.e. also for UEs using PSM.
Currently both timer functions are mapped to the reachability timer.
The monitoring event subscription is stored at SGSN/MME until the Max Number
of Reports or the Monitoring Duration are reached or until the monitoring
subscription context is deleted from SGSN/MME. Any deletion is reported to the
SCEF so that the SCEF may take actions, e.g. reporting this to the SCS/AS.
When the monitoring of \"loss of connectivity\" is requested and there is no
serving node available, the SCEF stores the request, subscribes via Sh\' to
HSS to get informed when a serving node becomes available (UE becomes
reachable) and subscribes then to the serving node(s). Alternatively, in such
a situation the SCEF rejects the request.
When subscribing to this event the SCS/AS may provide a time period value
after which \"loss of connectivity\" shall be detected. It is up to
operator\'s policy to determine what time values are acceptable. This time
period value should be considered by the serving node as it determines the
periodic RAU/TAU timers for the UE.
NOTE 2: The network should ensure that the periodic RAU/TAU timers for the UE
remain above lower bound values both for preserving the battery of the UE and
for managing the signalling load of the network.
NOTE 3: The maximum detection time of loss of connectivity is on the order of
1 minute to 1 hour.
**Monitoring Event: UE reachability**
The Monitoring Request includes whether it is reachability for SMS or
reachability for data, onetime or continuous reporting (Max Number of
Reports), Monitoring Duration and optionally parameters that affect
reachability, like Max Latency and Max Responsetime. The Max Latency indicates
the maximum delay for downlink transfers that the SCS/AS can accept, which
maps for PSM to the periodic update time. Very low values deactivate the
feature. The Max Responsetime indicates how long a UE that becomes reachable
should stay reachable so that any downlink data may be delivered reliably to
the UE. For PSM it determines the active time.
When reachability for SMS and onetime report are requested, the SCEF
subscribes via Sh\' at HSS to get notified when existing Notification or
Update Location procedures indicate to HSS that the UE becomes reachable,
which the SCEF reports to SCS/AS.
When reachability for data is requested, the SCEF subscribes via Sh\' at HSS
and the HSS configures the serving node(s) to report to the SCEF when the UE
is reachable for downlink data, e.g. for UEs using power saving mode, the
serving nodes report when UE become active. The SCEF reports to SCS/AS, which
may use this, for example, as a trigger for sending data to the UE. When
requesting this event, the service requestor may indicate parameters Max
Latency and Max Responsetime.
**Monitoring Event: Location Reporting**
The Monitoring Request is for current or last known location and indicates
whether it is a onetime request or continuous monitoring, the monitoring
duration and the wanted location accuracy. If accuracy allows for RA/TA or
cell level location info, the SCEF select this mechanism here. The Monitoring
Request for Last Known Location is always a onetime request.
The SCEF requests the information via Sh\' and the HSS queries the serving
node(s) using existing S6 procedures for obtaining current or last known
location. If continuous reporting is requested the HSS configures the serving
node(s) to report to the SCEF when the UE\'s location changes with cell or
RA/TA level accuracy.
For continuous monitoring the serving node(s) report when the UE is active in
new cell or RA/TA. The SCEF maps that cell or RA/TA to a geo-location and
reports to the requestor.
NOTE 4: Due to the potential increase in signalling load, it is recommended
that a continuous monitoring of current location on cell level is only applied
for a limited number of subscribers.
**Monitoring Event: IMSI-IMEI(SV) association**
The SCEF request the HSS to inform the SCEF when the HSS receives for the IMSI
an IMEI(SV) that is different from the IMEI(SV) stored by the HSS. The SCEF
indicates it to the SCS/AS. The HSS gets the required information already by
its normal operation. SGSNs that shall enable that monitoring
event/information need to support the Automatic Device Detection (ADD)
function/feature.
**Monitoring Event: Roaming Status**
The SCS/AS requests onetime or continuous reporting of the roaming status. The
SCEF requests that information from HSS. For onetime reporting the ID of the
currently serving PLMN (CS and or PS) is provided and an indication whether it
is the home or a roaming PLMN. For continuous reporting the HSS reports every
change of a serving PLMN, which is indicated to the SCS/AS. The HSS gets the
required information already by its normal operation.
**Monitoring Event: Reporting the number of UEs present in a geographic area**
The SCEF, when requested to generate a onetime report for the UEs that locate
in a geographic area, maps the geographic area to a list of cells and/or
RAs/TAs and identifies the MMEs/SGSNs serving them. The SCEF requests those
MMEs/SGSNs via a direct new interface to count the UEs in these cells and/or
RAs/TAs.
NOTE 5: The mapping of SCS/AS (ASP) specific geographic areas to serving
operator (MNO) network list of cells and/or RAs/TAs, and the identity of the
associated serving nodes (e.g. MMEs/SGSNs) is configured at the SCEF.
If the list contains cells and the request is for the last know location, the
MMEs/SGSNs collect all UEs for which last know location indicates those cells.
If the list contains RAs/TAs, the MMEs/SGSNs collect all UEs that are
registered in those RAs/TAs.
If the list contains cells and the request is for the current location, the
MMEs/SGSNs page in these cells to identify the UEs that are not already
connected. For the already connected UEs the MMEs/SGSNs needs to query the RAN
to receive the UE\'s current cell. The MMEs/SGSNs report the counting result
to the SCEF. The SCEF combines the reports from all involved MMEs/SGSNs and
reports the total sum to the SCS/AS.
Editor\'s note: The MME/SGSN actions when paging is not successful for a UE
are FFS.
**Monitoring Event: Communication failure**
The 3rd party application provider may need to be informed of certain
communication failure events occurring for a particular UE in the network. In
such case, the SCS/AS requests continuous reporting of such communication
failures. The SCEF subscribes to serving node(s) via HSS for getting
communication failure reports. When a RAN or NAS failure event occurs, the
serving node reports the corresponding RAN/NAS failure cause code to the SCEF.
Based on operator configuration, the SCEF may either report the received
failure cause code(s) as-is or provide an abstracted value to the SCS/AS.
### 6.3.2 Impacts on existing nodes and functionality
\- New interface needs to be supported between SGSN/MME/HSS and SCEF for
Monitoring exposure.
\- HSS needs to store monitoring events configuration data as part of UE
subscription data (only option A) and needs to respond to SCEF interrogation.
\- MME/SGSN need to detect configured monitoring event and report to SCEF.
\- For certain monitoring events the SCEF needs to apply the sequence of
signalling and processing of using multiple 3GPP interfaces. It needs to
generate CDRs also for inter PLMN operator charging. It needs to maintain
monitoring contexts that allow for determining the monitoring destination node
and any potential mapping between UE identities and anonymous identities.
\- SCEF need to map a geographic area to a list of cells and/or RAs/TAs and
interact with the responsible MMEs/SGSNs to retrieve the number of UEs in
these cells and/or RAs/TAs.
### 6.3.3 Solution evaluation
Options A and B differ in the handling of serving node changes and in the
handling of subscribing events for UEs that have no serving node allocated.
Option A stores event subscriptions in HSS and downloads any subscribed
monitoring event configurations to new serving nodes during existing
signalling between serving node and HSS. Thereby all possible cases are
covered by loading events subscriptions always from HSS to any new serving
node. Another advantage of option B is its flexibility of using HSS based or
direct reporting to SCEF, which may be chosen from depending on capabilities
supported by the different interfaces, e.g. single event reporting via serving
node - HSS interface and continuous reporting via direct new interface.
Option B proposes to transfers event subscriptions between serving nodes. When
there is a request for monitoring and no serving node is allocated to the UE
the SCEF needs to subscribe to HSS for getting notified when there is a new
serving node after there was none before. Problematic are also scenarios where
a UE changes to a new serving node without retrieving any contexts from old
serving node. It can be expected that a variety of scenarios need specific
handling and updates if option B should be used for UE specific monitoring.
All that is not needed for events that are not UE specific, e.g. when
monitoring an area. Here is also no HSS interaction expected.
In addition option B may become an optimisation for monitoring events that
include frequent re-requests of event subscriptions. In that case the SCEF may
cache HSS provided info. However this optimisation should only be used for UEs
that have a serving node allocated and without any extra efforts for scenarios
where the serving node changes or gets lost. In that case it should fall back
to option A.
Following this evaluation it is suggested to adopt option A for monitoring of
UE specific/individual events and combine it with the HSS based monitoring.
For Option A, where only infrequent event needs to be reported, HSS may inform
MME/SGSN to report back the event to HSS which in turn may report it to SCEF.
Option B is suggested to be adopted for events that don\'t relate to
specific/individual events. Option B may be considered as an optimisation for
monitoring events that require frequent re-requests of event subscription,
which can remove that load from HSS. Frequent re-requests of event
subscriptions should be avoided and rather be part of the event configuration
as such. As the option B with the SCEF configuring the events directly in the
MME/SGSN has issues with mobility, is dependent on UE registration state and
requires more signalling it is not recommended.
For some events type such as RAT_change or location_change (and others) it can
be argued that event triggers already available via PCRF. In such cases, it is
indeed possible to access such capabilities via PCRF as well as via MME/SGSN.
However, there are cases where an operator may not have activated any
location_change event triggers on PCRF for its subscribers, but may be
interested in location_change event to be exposed to 3rd parties for certain
location-based services. In such cases, requesting location_change directly
from MME/SGSN would be efficient.
In addition, it should be noted that PCC usage is optional per 3GPP specs. It
may not be deployed for all types of subscriber sessions (e.g. low ARPU M2M
devices) and in that case local policy at PCEF may be used for policy and
charging control. In such a deployment, it is not possible to issue monitoring
events for affected subscribers via PCRF framework at all.
Another consideration is frequency of events. For infrequent location_change
reporting it may be OK to report it via HSS. However for frequent
location_change reporting load on HSS may not be desirable. In such cases,
requesting location_change directly from MME/SGSN would be efficient.
## 6.4 Solution 4: Monitor UE location using GMLC
### 6.4.1 Description
The main idea of this solution is to use the GMLC to retreive location
(including possibility to request a One-time retrieval of UE Location or to
request Change in UE Location) with sub cell level accuracy from SGSN/MME and
additionally to use GMLC to translate CID (Cell Identity) / SAI (Service Area
Identity) retrieved by SCEF by other means into a geographical location. The
latter being needed for cases where SCEF is not aware of CID/ SAI geographical
coverage e.g. in roaming scenarios and shared RAN deployments.
Figure 6.4.1-1: Monitoring architecture model
#### 6.4.1.1 General
#### 6.4.1.2 Flow for Monitoring UE location using GMLC
Figure 6.4.1.1-1: Report the number of UEs present in a certain area
1\. The AS sends a Monitoring Action Request message to the SCEF with for
delivery of UE location.
2\. The SCEF authorize whether the AS is authorised to send monitoring
requests.
3\. The SCEF send Location Request to GMLC. The request may include
information on the serving CID (Cell ID) / SAI (Service Area Identity) and
serving SGSN/MME. The request may include information on requested QoP
(Quality of Position) e.g. accuracy and response time.
4\. The GMLC determines if the requested location accuracy can be fulfilled by
using CID / SAI information or if a positioning procedure is required. If no
positioning procedure is required GMLC goes directly to step 9.
5\. If use of CID / SAI info is deemed not sufficient the HSS is queried for
the serving SGSN/MME.
6\. The GMLC sends a Location Request to the serving SGSN/MME.
7\. A positioning procedure is initiated by SGSN/MME.
8\. The SGSN/MM sends a Location Response potentially including a geographic
location estimate to the GMLC.
9\. If no positioning procedure was performed or if no location estimate was
returned GMLC translates CID / SAI information into a location estimate.
10\. The GMLC sends a Location Response to the SCEF.
11\. The SCEF sends the response on UE location to the AS.
### 6.4.2 Impacts on existing nodes and functionality
The GMLC needs functionality for selecting means to derive location
information fulfilling requested QoP.
### 6.4.3 Solution Evaluation
**Benefits:**
\- Existing GMLC functionality (and Le) can be re-used supporting both the
One-time retrieval of UE Location and the Change in UE Location events.
**Drawbacks:**
\- Deferred location in LCS is a feature which allows request for location
contingent on some current or future events where the response from the LCS
Server to the LCS Client may occur sometime after the request was sent e.g.
due to change of area. Such events which rely on the Deferred Location Request
procedure can\'t be fulfilled while the UE is in E-UTRAN because this LCS
procedure isn\'t supported for E-UTRAN access.
# 7 Overall Evaluation
## 7.1 General
In line with step 3 in Interim Conclusion in clause 8.1, this clause evaluates
each of the monitoring event listed in clause 5.1.2 against solutions in
clauses 6.1, 6.2, and 6.3 to find out the most optimum set of interface(s)
used to realize the respective monitoring event.
In doing the evaluation, the following set of criteria is considered:
\- Existing functionality is re-used or enhanced wherever applicable.
\- The number of nodes involved in a monitoring event\'s configuration and
triggering should be kept to a minimum
\- Signalling generated (due to the monitoring event\'s configuration, or
triggering) towards involved nodes is kept to a minimum
\- Dynamic PCC is considered an optional feature. Even when dynamic PCC is
employed by an operator, it may not be used for all subscribers.
## 7.2 Roaming status of MTC device
### 7.2.1 One-time Roaming status of UE
There isn\'t a \'roaming status\' indicated by any of the 3GPP nodes in normal
signalling. However, the serving network\'s PLMN-ID (MCC+MNC) can
deterministically be used to derive whether UE is in HPLMN or VPLMN.
**[Via HSS]{.underline}** : MME/SGSN sends serving PLMN ID as part of existing
location update procedure towards HSS. HSS uses this information to derive
roaming status. HSS then notifies SCEF. Enhancement to Sh to request and
indicate roaming status is required.
**[Via PCRF]{.underline}** : There are two mechanisms when using PCRF:
1\. Using NETLOC feature: 3GPP-SGSN-MCC-MNC AVP on Gx carries information
about PLMN-Id (MCC+MNC) of serving network of the serving network which is
provided by PCEF/BBERF to PCRF during existing IP-CAN procedures. To get this
information, AF subscribes to the \"ACCESS_NETWORK_INFO_REPORT\" within the
Specific-Action AVP and sets USER_LOCATION in Required-Access-Info AVP AF
towards PCRF. PCRF triggers IP-CAN modification procedures towards PCER/BBERF
to obtain USER_LOCATION. When the PCRF then receives the requested access
network information from the PCEF/BBERF, the PCRF provides the corresponding
access network information to the AF within the 3GPP-User-Location-Info AVP
(if available), TWAN-Identifier AVP (if available), User-Location-Info-Time
AVP (if available), 3GPP-SGSN-MCC-MNC AVP (if location info is not available)
and/or 3GPP-MS-TimeZone AVP and the RAN-NAS-Release-Cause AVP (if available).
If 3GPP-User-Location-Info is sent, it contains CGI/ECGI/TAI/RAI etc which
contain serving network\'s PLMN-Id. If that can\'t be obtained, then serving
network\'s PLMN-Id are sent in 3GPP-SGSN-MCC-MNC AVP.
Basically, in order to get serving network\'s PLMN-ID, when AF subscribes to
this event with PCRF, IP-CAN modification procedures are triggered to allow
PCRF to inform PCEF/BBERF to retrieve this information. This causes additional
signalling even if it is just to retrieve the serving network\'s PLMN-Id (to
determine roaming status of UE) and not wanting to retrieve location
information.
2\. Using PLMN_CHANGE trigger. PCRF can provision PLMN_CHANGE trigger on Gx
today, and get updates on when the serving network changes. There are two ways
to handle this event:
a. Rx only change: Rx needs to be enhanced to support AF subscription to PLMN
change event. Reporting of PLMN_CHANGE can be done using existing Gx and Rx
procedures. However, because the PLMN_CHANGE trigger was activated only for
finding out current serving network, it needs to be disabled. So, there is
additional signalling to disable this trigger soon as the necessary
information is retrieved.
b. Rx + Gx change: Rx needs to be enhanced to support AF subscription to PLMN
change event. Gx is enhanced to qualify that event trigger PLMN_CHANGE is
being requested for one-time reporting only i.e. automatically remove event
trigger at PCEF/BBERF after PCEF/BBERF is done providing the requested
information. Reporting of PLMN_CHANGE can be done using existing Gx and Rx
procedures.
Neither option 1 nor 2a are recommended due to additional unnecessary
signalling.
Option 2b is recommended when PCC is deployed.
**[Via MME/SGSN]{.underline}** : Serving PLMN-ID is always available at
MME/SGSN which can be provided to SCEF upon request from SCEF.
### 7.2.2 Change in Roaming status of UE
There isn\'t a \'roaming status\' indicated by any of the 3GPP nodes in normal
signalling. However, the serving network\'s PLMN-ID (MCC+MNC) can
deterministically be used to derive whether UE is in HPLMN or VPLMN.
**[Via HSS]{.underline}** : MME/SGSN sends serving PLMN ID as part of existing
location update procedure towards HSS. HSS uses this information to derive
roaming status. HSS then notifies SCEF. Enhancement to Sh to request and
indicate change of roaming status is required. However, depending on the
frequency of UE mobility between PLMNs (e.g. if UE is at PLMN boundaries),
this could cause increased signalling.
**[Via PCRF]{.underline}** :
Home routed case: Rx needs to be enhanced to support AF subscription to PLMN
change event. Reporting of PLMN_CHANGE can be done using existing Gx and Rx
procedures.
LBO case: Rx needs to be enhanced to support AF subscription to PLMN change
event. hPCRF can detect change in serving network PLMN-Id when a new IP-CAN
session across different S9 entity is established for the same UE. The issue
is when previous S9 connection is torn down, as will the Rx session. The
following possible solutions can be employed to realize this use-case:
1\. SCEF (AF) stores event trigger details for given UE, even when IP-CAN
session doesn\'t exist. Event trigger details include UE identifier, trigger
destination (FQDN of SCEF) etc. Based on FFS criteria, SCEF (AF) re-
establishes Rx when UE has a valid IP-CAN session at a later point in time.
hPCRF then provides necessary information to SCEF.
2\. SPR is used to store event trigger details for given UE. Event trigger
details include UE identifier, trigger destination (FQDN of SCEF) etc Upon
termination and re-establishment of IP-CAN session, hPCRF detects the event.
It initiates a standalone Rx transaction towards trigger destination (SCEF).
3\. SCEF (AF) requests HSS to store the event trigger details for given UE,
even when IP-CAN session doesn\'t exist. SCEF subscribes to HSS to be notified
of when UE becomes reachable. Upon notification, SCEF (AF) re-establishes Rx
using UE Identifier (IMSI) via DRA to re-install the event trigger. DRA will
ensure that if an active IP-CAN session for that UE exists, then the right
PCRF will be selected.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
**[Via MME/SGSN]{.underline}** : Since a serving network PLMN-Id change
involves change in MME/SGSN itself, to realize this event, SCEF would need to
be informed of MME/SGSN change for that particular UE. There can be one of two
ways of doing this:
i) SCEF sets trigger on HSS to be notified of MME/SGSN for that UE. When
change of MME/SGSN occurs normal location update procedures w/ HSS are
executed, then HSS notifies SCEF of this change.
ii) SCEF sets trigger directly on MME/SGSN for that UE. When UE shows up on a
different MME/SGSN, and successful context retrieval from old MME/SGSN is done
by the new MME/SGSN, old MME/SGSN notifies SCEF. _Compared to solution i) this
generates additional signalling between MME/SGSN and SCEF (especially if ISR
was active - which anyways isn\'t known to HSS/SCEF_).
## 7.3 Serving Network of MTC device
Since determination of roaming status in clause 7.2.1 requires serving network
PLMN-Id info, the same recommendations as for clause 7.2 apply here.
## 7.4 Location of MTC device
### 7.4.1 One-time retrieval of UE Location
UE location can be represented within the 3GPP system via different
granularities e.g. area level (TA/RA/SA), or cell level (ECGI/CGI), node level
(eNB, HeNB) etc. Here, it is assumed that applications can ask for:
1\. \"where is user X right now-\" which translates to a one-time current
location retrieval procedure in clause 7.4.1.1.
2\. \"where was user X last seen-\" which translates to a one-time last known
location procedure in clause 7.4.1.2.
#### 7.4.1.1 Current Location of UE
A one-time \"current location\" query requires UE to be transitioned, if not
already, to CONNECTED mode depending on the accuracy (e.g. cell level) of
wanted location.
**[Via HSS]{.underline}** : Cell-level granularity for current location is
supported via existing specs cf. clause 5.2.2 of TS 29.272 [9]. HSS can
request one-time location from MME/SGSN by setting \"EPS Location Information
Request\" bits. If current location request bit is set, then MME/SGSN
activates S1- location reporting to transition UE to ECM_CONNECTED by paging
the UE, learns the UE\'s current location (ECGI/CGI granularity), and then
returns the location. If current location request bit is not set, then
MME/SGSN provides stored location. In both cases, age of the location
information is also provided by MME/SGSN cf. clause 7.3.115 of TS 29.272 [9].
MME-Location-Information ::= \
[E-UTRAN-Cell-Global-Identity]
[Tracking-Area-Identity]
[Geographical-Information]
[Geodetic-Information]
[Current-Location-Retrieved]
[Age-Of-Location-Information]
[User-CSG-Information]
*[AVP]
Requested location granularity can be specified on Sh (e.g. if only serving
MME/SGSN address is needed or ECGI level granularity is needed).
**[Via PCRF]{.underline}** : When dynamic PCC is deployed for a given user,
one-time location retrieval is supported via existing IP-CAN modification
procedures cf. TS 23.401 [5] clause 5.4.3. The procedure involves signalling
from AF to UE via all EPC + RAN nodes. Requires for MME to be configured for
retrieving current location cf. TS 23.401 [5] clause 5.4.3 step 8. In
addition, CNO_ULI feature in Rel‑12 introduced additional possibility of
invoking this location reporting procedure only when one or more RAB(s) are
established cf. TS 23.401 [5] clause 5.9.2.1, i.e. there is no reporting
during signalling only transactions.
**[Via MME/SGSN]{.underline}** :
For CONNECTED mode UEs: TA/RA-level location is always known by MME, and SA-
level by 3G SGSN. No extra signalling towards RAN or UE is needed. If
ECGI/CGI-level granularity is needed, then one-time S1 or Iu- location
reporting needs to be activated. 2G SGSN always knows cell-level granularity.
For IDLE mode UEs: RA/TA (list) is always known to MME/SGSN. If current cell
level granularity is required, then UE has to be paged first to transition it
to CONNECTED mode.
**[Via GMLC]{.underline}** :
TS 23.271 [8] clause 9.1.15 indicates how to satisfy a location request (EPC-
MT-LR) via LCS for EUTRAN. In addition to the network elements shown in clause
6.4.1 E-SMLC is also involved. When MME receives Location determination
request from GMLC via SLg, it sends a NAS request for location positioning
request (via NAS: GENERIC NAS DOWNLINK TRANSPORT message). To allow sending of
this message, ECM_IDLE mode UEs need to be transition to ECM_CONNECTED mode.
UE computes a response depending on location request, and sends it to MME
which relays it to E-SMLC via SLs. At this point,
_\"If the requested location information and the location accuracy within the
QoS can be satisfied based on parameters received from the MME, e.g. cell
identity, the E-SMLC may send a Location Response immediately. Otherwise, the
E-SMLC determines the positioning method and instigates the particular message
sequence for this method as described in clause 9.3a. If the position method
returns position measurements, the E-SMLC uses them to compute a location
estimate. If there has been a failure to obtain position measurements, the
E-SMLC may use the current cell identity to derive an approximate location
estimate. If an already computed location estimate is returned for an UE based
position method, the E-SMLC may verify consistency with the current cell. If
the location estimate so obtained does not satisfy the requested accuracy and
sufficient response time still remains, the E-SMLC may instigate a further
location attempt using the same or a different position method. If a vertical
location co-ordinate is requested but the E-SMLC can only obtain horizontal
co-ordinates, these may be returned.\"_
Due to the nature of involved signalling, this option is only recommended for
this event in case requested location accuracy/granularity can\'t be mapped to
existing 3GPP location concepts (e.g. area, cell etc.).
#### 7.4.1.2 Last known Location of UE
In general, last known location of a given UE may be considered stale.
Therefore, request for this event should be used with caution.
**[Via HSS]{.underline}** : Isn\'t always made available at HSS as part of
normal S6a/d signalling e.g. In TAU w/o MME change, such reporting is
deferred. Therefore, interaction w/ MME/SGSN is required to obtain last known
location if requested by applications. Existing procedure of any time
interrogation provides last know cell and age of that info to HSS.
**[Via PCRF]{.underline}** : When dynamic PCC is deployed for a given user,
one-time location retrieval is supported via existing IP-CAN modification
procedures cf. TS 23.401 [5] clause 5.4.3 if the UE is attached. The procedure
involves signalling from AF to UE via all EPC + RAN nodes. In addition,
CNO_ULI feature in Rel‑12 introduced additional possibility of invoking this
location reporting procedure only when one or more RAB(s) are established cf.
TS 23.401 [5] clause 5.9.2.1. In that case last known location after
signalling procedures is not reported. A request to report location over Gx
requires enhancements to decouple a request to report location from the
provisioning of a PCC Rule.
**[Via MME/SGSN]{.underline}** : Together with the age (see clause 7.4.1.1)
last known location is always available at last MME/SGSN.
**[Via GMLC]{.underline}** : The mechanism and corresponding references are
the same as in clause 7.4.1.1 for GMLC based solution. Although GMLC based
solution allows retrieval of last known location, the conditions under which
it is allowed are very restrictive cf. TS 23.271 [8] clause 9.1.15 step 9,
clause 9.1.4.3, etc. To support this event, some functional enhancements are
required in the LCS service architecture.
### 7.4.2 Change in UE Location
UE location can be represented within the 3GPP system via different
granularities eg area level (TA/RA/SA/PRA), or cell level (ECGI/CGI), node
level (eNB, HeNB) etc. Change in location trigger can take one of two forms:
  1. \"Notify me when user X moves out of a given area\". Area definition could be cell level (CGI/ECGI), LA/TA/RA level, Presence Area reporting level, or other formats e.g. shapes (e.g. polygons, circles) or civic addresses (e.g. streets, districts etc.) as referenced by OMA Presence API. It may be requested with additional criteria such as granularity etc. This is covered in clause 7.4.2.1.
  2. \"Notify me when user X moves.\" We will refer to this as continuous reporting. It may be requested with additional criteria such as maximum number of reports, reporting interval, granularity etc. This is covered in clause 7.4.2.2.
In either case, application(s) are typically not expected to be aware of 3GPP
network\'s internal state eg attach, detach, idle, connected etc. Therefore,
it is expected that such change event triggers are persistent, until the
trigger validity criteria is reached, through such state transitions for both
UE and the network.
#### 7.4.2.1 Reporting upon change of location area
**[Via HSS]{.underline}** : Per existing specifications, change location
triggers and associated logic isn\'t available at HSS. To do this will require
enhancements to HSS, and MME/SGSN, and will also result in increased
signalling to/from nodes (MME/SGSN and SCEF) and HSS.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
**[Via PCRF]{.underline}** : PRA feature introduced in Rel-12 allows for
detection of UE\'s movement in and out of a certain area called PRA. PRA could
either be:
  * defined in MME/SGSN, and reference by PCRF via a PRA-Id; OR
  * be provided by PCRF to MME/SGSN. In this case it could be a list of TA/RA/CGI/EGI/SAI/eNB-Id etc. Stage 2 specs have a restriction that such list, if sent, should be kept short. _29.274 has defined: TAI (15 at most), Macro eNodeB ID (63 at most), Home eNodeB ID (63 at most), ECGI (63 at most), RAI (15 at most), SAI (63 at most) and CGI (63 at most) which compose the PRA._
_It should be noted that for Rel-12 PRA feature to work, homogenous feature
support across PCRF, PGW, SGW, MME/SGSN MME is required._
For both home-routed and LBO case Rx needs to be enhanced to support AF
subscription to support notifications of change location. In addition, to
support persistence of trigger, enhancements in PCRF/SPR to support
configuration of the location change event in the PCRF/SPR that is not related
with an IP-CAN session is required. Both an operation to subscribe and
unsubscribed to change of location with different granularity levels over Rx
is required. The following possible solutions can be employed to realize this
use-case:
  1. SCEF (AF) stores event trigger details for given UE, even when IP-CAN session doesn\'t exist. Event trigger details include UE identifier, trigger destination (FQDN of SCEF) etc. Based on FFS criteria, SCEF (AF) re-establishes Rx when UE has a valid IP-CAN session at a later point in time. (h)PCRF then provides necessary information to SCEF.
  2. SPR is used to store event trigger details for given UE. Event trigger details include UE identifier, trigger destination (FQDN of SCEF) etc Upon termination and re-establishment of IP-CAN session, (h)PCRF detects the event. It initiates a standalone Rx transaction towards trigger destination (SCEF).
  3. SCEF (AF) requests HSS to store the event trigger details for given UE, even when IP-CAN session doesn\'t exist. SCEF subscribes to HSS to be notified of when UE becomes reachable. Upon notification, SCEF (AF) re-establishes Rx using UE Identifier (IMSI) via DRA to re-install the event trigger. DRA will ensure that if an active IP-CAN session for that UE exists, then the right PCRF will be selected.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
**[Via MME/SGSN]{.underline}** : Similar to description for PCRF approach wrt
PRA with the exception that there isn\'t a protocol limit on the # of areas
which can be defined on the serving node. Mechanisms to allow persistence of
event trigger even when UE is detached is required. Below is a proposed way to
realize this functionality:
> SCEF stores trigger context in HSS. Event trigger details include trigger
> destination (FQDN of SCEF) etc. This is done to allow downloading of trigger
> context from HSS to MME/SGSN in the event that no serving node was allocated
> at the time the trigger was requested by SCEF. Trigger context should also
> be stored in MME/SGSN (E)MM context information. The new MME/SGSN during
> normal location update procedures w/ HSS will get the trigger context, and
> will notify SCEF of when the requested event occurs.
**[Via GMLC]{.underline}** : The mechanism and corresponding references are
the similar to those as described clause 7.4.1.1 for GMLC based solution.
Although GMLC based solution allows change of area reporting, the conditions
under which it is allowed are very restrictive cf. TS 23.271 [8] clause 9.1.15
step 9, clause 9.1.4.3, etc.
In addition, support this trigger for a detached UE would require using
deferred reporting functionality as defined in TS 23.271 [8]. However, this
isn\'t presently supported for E-UTRAN access.
The support of this event, therefore, requires functional enhancements to LCS
service architecture.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
#### 7.4.2.2 Continuous Reporting of Location
**[Via HSS]{.underline}** : Per existing specifications, change location
triggers and associated logic isn\'t available at HSS. To do this will require
enhancements to HSS, and MME/SGSN, and will also result in increased
signalling to/from nodes (MME/SGSN and SCEF) and HSS.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
**[Via PCRF]{.underline}** : Various change location triggers are supported on
Gx and downstream to various EPC nodes. All change location PCC triggers
except PRA would be applicable for this event. In addition, if ECGI/CGI-level
granularity is needed, then continuous S1 or Iu- location reporting needs to
be activated on every eNB/RNC the UE moves to.
Arming some of the PCC change location triggers eg cell-change (ECGI_CHANGE)
triggers may result in excessive signalling across the network. PCC defines
other mechanisms to avoid excessive signalling for granularity larger than
cell-level e.g. TA-change (TAI_CHANGE).
MME may be configured to report certain triggers like ECGI/TAI change only
when one or more E-RAB(s) are established. This is a node-wide configuration
not a per-user configuration. So, careful coordination between MME/SGSN
configuration and PCC change location triggers is required.
For both home-routed and LBO case Rx needs to be enhanced to support AF
subscription to support notifications of change location. In addition, to
support persistence of trigger, enhancements in PCRF/SPR to support
configuration of the location change event in the PCRF/SPR that is not related
with an IP-CAN session is required. Both an operation to subscribe and
unsubscribed to change of location with different granularity levels over Rx
is required. The following possible solutions can be employed to realize this
use-case:
  1. SCEF (AF) stores event trigger details for given UE, even when IP-CAN session doesn\'t exist. Event trigger details include UE identifier, trigger destination (FQDN of SCEF) etc. Based on FFS criteria, SCEF (AF) re-establishes Rx when UE has a valid IP-CAN session at a later point in time. (h)PCRF then provides necessary information to SCEF.
  2. SPR is used to store event trigger details for given UE. Event trigger details include UE identifier, trigger destination (FQDN of SCEF) etc Upon termination and re-establishment of IP-CAN session, (h)PCRF detects the event. It initiates a standalone Rx transaction towards trigger destination (SCEF).
  3. SCEF (AF) requests HSS to store the event trigger details for given UE, even when IP-CAN session doesn\'t exist. SCEF subscribes to HSS to be notified of when UE becomes reachable. Upon notification, SCEF (AF) re-establishes Rx using UE Identifier (IMSI) via DRA to re-install the event trigger. DRA will ensure that if an active IP-CAN session for that UE exists, then the right PCRF will be selected.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
**[Via MME/SGSN]{.underline}** :
True IDLE mode mobility can\'t be tracked regardless.
For an IDLE mode UE, RA/TA (list) is always known to MME/SGSN.
For CONNECTED mode UEs: TA/RA-level location is always known by MME, and SA-
level by 3G SGSN. No extra signalling towards RAN or UE is needed. If
ECGI/CGI-level granularity is needed, then continuous S1 or Iu- location
reporting needs to be activated on every eNB/RNC the UE moves to. 2G SGSN
always knows cell-level granularity.
Mechanisms to allow persistence of event trigger even when UE is detached is
required. Below is a proposed way to realize this functionality:
> SCEF stores trigger context in HSS. Event trigger details include trigger
> destination (FQDN of SCEF) etc. This is done to allow downloading of trigger
> context from HSS to MME/SGSN in the event that no serving node was allocated
> at the time the trigger was requested by SCEF. Trigger context should also
> be stored in MME/SGSN (E)MM context information. The new MME/SGSN during
> normal location update procedures w/ HSS will get the trigger context, and
> will notify SCEF of when the requested event occurs.
**[Via GMLC]{.underline}** : The mechanism and corresponding references are
the similar to those as described clause 7.4.1.1 for GMLC based solution.
Although GMLC based solution allows change of area reporting, the conditions
under which it is allowed are very restrictive cf. TS 23.271 [8] clause 9.1.15
step 9, clause 9.1.4.3, etc.
In addition, support this trigger for a detached UE would require using
deferred reporting functionality as defined in TS 23.271 [8]. However, this
isn\'t presently supported for E-UTRAN access.
The support of this event, therefore, requires functional enhancements to LCS
service architecture.
_Due to the nature of changes needed, and resulting signalling, this option
isn\'t recommended for this event._
# 8 Conclusions
## 8.1 General Conclusions
1\. The set of capabilities required for monitoring may be accessible via
different 3GPP interfaces/nodes (e.g. HSS via Sh (with enhancements), or PCRF
via Rx (with enhancements), or MME/SGSN via a new interface).
2\. Reporting of the same event via different interfaces might be envisaged,
to satisfy different usage scenarios (e.g.: different frequency of location
reporting or different location accuracy requirements) as per the details
shown in clause 8.2.
3\. For normative work, solution in clause 6.3 (i.e. combined MME/SGSN and HSS
solution) should be used as a basis for developing generic event monitoring
flows.
> In this solution, configuration of event(s) is done by the SCEF on HSS, and
> if required, depending on the event type, on the serving node(s) via HSS.
> The reporting of event(s), depending on the event type, is done either via
> HSS or the serving node(s) to the SCEF. The monitoring via HSS path is
> intended for infrequent events reporting or when MME/SGSN based monitoring
> is not available (i.e. when a MME/SGSN does not support a requested
> monitoring feature). Please see clause 8.2 for further conclusions on
> specific monitoring events.
>
> Based on operator preferences, PCC-based solution may be used for event(s)
> with the exception that existing 3GPP specifications for PCC will be used
> as-is. Please refer to clause 8.2 for specific monitoring events which can
> be supported via using PCC-based solution.
## 8.2 Conclusions for Specific Monitoring Events
### 8.2.1 Roaming status, and Serving Network of the UE
**A. One-time Roaming status or Serving Network of UE:**
This information is considered to change only infrequently and the required
information is already available at HSS. It is recommended that the combined
MME/SGSN + HSS solution (clause 6.3) is specified for this event.
**B. Change in Roaming status or Serving Network of UE:**
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
### 8.2.2 Location of the UE
**A. One-time current location of UE:**
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
If dynamic PCC is used for a given UE, and SCEF is able to locate the PCRF
serving this UE (i.e. active IP-CAN session exist), then based on operator
preferences, existing mechanisms specified in TS 23.203 [7] may be used for
this event. It should be noted that MME must be configured appropriately (see
TS 23.401 [5]).
**B. One-time last known location of UE:**
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
If dynamic PCC is used for a given UE, and SCEF is able to locate the PCRF
serving this UE (i.e. active IP-CAN session exist), then based on operator
preferences, existing mechanisms specified in TS 23.203 [7] may be used for
this event. It should be noted that MME must be configured appropriately (see
TS 23.401 [5]).
**C. Reporting upon change of location area**
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
**D. Continuous reporting of Location**
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
### 8.2.3 Change in association of the MTC Device and UICC
For one time reporting and continuous reporting it is recommended that
combined MME/SGSN + HSS solution (clause 6.3) is specified.
### 8.2.4 Loss of connectivity
For loss of connectivity it is recommended that combined MME/SGSN + HSS
solution (clause 6.3) is specified for this event.
### 8.2.5 UE Reachability
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
### 8.2.6 Communication Failure
It is recommended that the combined MME/SGSN + HSS solution (clause 6.3) is
specified for this event.
This event is limited to reporting of RAN/NAS failure cause code values.
If dynamic PCC is used for a given UE, and SCEF is able to locate the PCRF
serving this UE (i.e. active IP-CAN session exist), then based on operator
preferences, existing mechanism specified in TS 23.203 may be used for this
event. It should be noted that RAN/NAS Release Cause is only sent by the MME
to the PDN GW if this is permitted according to MME operator\'s policy (see TS
23.401 [5], clause 5.4.4.2).
### 8.2.7 Reporting the number of UEs present in a certain area
For this release this event is limited to one time reporting of the number of
UEs present in a certain area.
For one time reporting it is recommended that combined MME/SGSN + HSS solution
(clause 6.3) is specified for this event.
This event request is sent directly to the serving node(s) by the SCEF.
Serving nodes report the event directly to SCEF.
#