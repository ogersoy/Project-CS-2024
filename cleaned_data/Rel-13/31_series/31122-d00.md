# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides the Conformance Test Specification for a
Universal IC Card (UICC) defined in TS 31.101 [2] with Universal Subscriber
Identity Module (USIM) defined in TS 31.102 [3].
# 2 Normative References
The following documents contain provisions, which through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference to a non-3GPP document, the latest > version applies.
  * For a non-specific reference to a 3GPP document, the latest version > in the same release as the implementation release of the UICC > under test applies.
[1] ETSI TS 102 221: \"UICC-Terminal Interface; Physical and Logical
Characteristics\".
[2] 3GPP TS 31.101: \"UICC-Terminal Interface; Physical and Logical
Characteristics\".
[3] 3GPP TS 31.102: \"Characteristics of the USIM application\".
[4] ISO/IEC 7816‑1: \"Identification cards ‑ Integrated circuit(s) cards with
contacts, Part 1: Physical characteristics\".
[5] ISO/IEC 7816‑2: \"Identification cards ‑ Integrated circuit cards \- Part
2: Card with contacts - Dimensions and locations of the contacts\".
[6] ISO/IEC 7816‑3: \"Identification cards ‑ Integrated circuit(s) cards with
contacts, Part 3: Electronic signals and transmission protocols\".
[7] ISO/IEC 7816‑4: \"Identification cards ‑ Integrated circuit cards \- Part
4: Organization, security and commands for interchange\".
[8] Void
[9] Void
[10] Void
[11] Void
[12] ISO/IEC 7811‑1: \"Identification cards - Recording technique - Part 1:
Embossing\"
[13] Void
[14] 3GPP TS 11.11: \"Digital cellular telecommunications system (Phase 2+);
Specification of the Subscriber Identity Module - Mobile Equipment (SIM - ME)
interface\".
[15] ETSI TS 101 220: \"Smart cards; ETSI numbering system for
telecommunication application providers\".
[16] ETSI TS 102 221 Release 99: \"UICC-Terminal Interface; Physical and
Logical Characteristics\".
[17] ETSI TS 102 221 Release 4: \"UICC-Terminal Interface; Physical and
Logical Characteristics\".
[18] ETSI TS 102 221 Release 5: \"UICC-Terminal Interface; Physical and
Logical Characteristics\".
[19] ISO/IEC 9646‑7 (1995): \"Information technology - Open Systems
Interconnection - Conformance testing methodology and framework - Part 7:
Implementation Conformance Statements\".
# 3 Definitions, symbols, abbreviations and coding
## 3.1 Definitions
For the purposes of the present document, the following definitions apply in
addition to the terms defined in TS 102.221 [1] and TS 31.102 [3].
**Implementation Conformance Statement (ICS):** A statement made by the
supplier of an implementation or system claimed to conform to a given
specification, stating which capabilities have been implemented. The ICS can
take several forms: protocol ICS, profile ICS, profile specific ICS,
information object ICS, etc.
**ICS proforma:** A document, in the form of a questionnaire, which when
completed for an implementation or system becomes an ICS.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
t~F~ fall time
t~R~ rise time
V~IH~ Input Voltage (high)
V~IL~ Input Voltage (low)
V~OH~ Output Voltage (high)
V~OL~ Output Voltage (low)
## 3.3 Abbreviations
For the purposes of the present document, the following abbreviations apply:
CRn Conformance Requirement \'n\'
IUT Implementation Under Test
ME Mobile Equipment
TS Test Specification
UICC Universal Integrated Circuit Card
USIM Universal Subscriber Identity Module
## 3.4 Coding Conventions
The following coding conventions apply to the present document:
All lengths are presented in bytes, unless otherwise stated. Each byte is
represented by bit b8 to b1, where b8 is the most significant bit (MSB) and b1
is the least significant bit (LSB). In each representation, the leftmost bit
is the MSB.
## 3.5 Applicability
## 3.5.1 Applicability of the present document
The present document applies to a UICC which supports one or more USIMs.
## 3.5.2 Applicability to the UICC
The applicability to a UICC supporting one or more USIMs is specified in table
B.1, unless otherwise specified in the specific clause.
## 3.5.3 Applicability of the individual tests
Table B.1 lists the optional, conditional or mandatory features for which the
supplier of the implementation states the support. As pre-condition the
supplier of the implementation shall state the support of possible options in
table A.1.
The \"Release XY UICC\" columns shows the status of the entries as follows:
The following notations, defined in ISO/IEC 9646‑7 [19], are used for the
status column:
M mandatory - the capability is required to be supported.
O optional - the capability may be supported or not.
N/A not applicable - in the given context, it is impossible to use the
capability.
X prohibited (excluded) - there is a requirement not to use this capability in
the given context.
O.i qualified optional - for mutually exclusive or selectable options from a
set. \"i\" is an integer which identifies an unique group of related optional
items and the logic of their selection which is defined immediately following
the table.
Ci conditional - the requirement on the capability (\"M\", \"O\", \"X\" or
\"N/A\") depends on the support of other optional or conditional items. \"i\"
is an integer identifying an unique conditional status expression which is
defined immediately following the table. For nested conditional expressions,
the syntax \"IF ... THEN (IF ... THEN ... ELSE...) ELSE ...\" shall be used to
avoid ambiguities.
##### References to items {#references-to-items .H6}
For each possible item answer (answer in the support column) there exists a
unique reference, used, for example, in the conditional expressions. It is
defined as the table identifier, followed by a solidus character \"/\",
followed by the item number in the table. If there is more than one support
column in a table, the columns shall be discriminated by letters (a, b, etc.),
respectively.
EXAMPLE: A.1/4 is the reference to the answer of item 4 in table A.1.
### 3.5.4 Applicability of conformance requirements
All conformance requirements are annotated with their applicability. This
clause defines the notation used.
The basic notation is as follows:
(DefinedRelease) ReleaseRange: Options
The components of the notation are as follows:
+----------------+-------------------------+-------------------------+ | **Component** | **Content** | **Example content** | +----------------+-------------------------+-------------------------+ | DefinedRelease | Contains a single | R99 | | | release. | | | | | Rel-6 | | | Optional (along with | | | | the surrounding | | | | parentheses). | | | | | | | | If present, it | | | | indicates the release | | | | of the core | | | | specification in which | | | | the conformance | | | | requirement was first | | | | defined. This is | | | | intended for | | | | conformance | | | | requirements which were | | | | defined in a certain | | | | release of the core | | | | specification but for | | | | which tests were not | | | | introduced into this | | | | document until a later | | | | release. | | | | | | | | If absent, this | | | | indicates that the | | | | conformance requirement | | | | was introduced in the | | | | first release contained | | | | in ReleaseRange. | | +----------------+-------------------------+-------------------------+ | ReleaseRange | Contains a single | R99 | | | release or a range of | | | | releases. An ellipsis | R99 - Rel-5 | | | (...) in the right-hand | | | | part indicates the | Rel-6 - ... | | | current release of this | | | | document. | | | | | | | | Optional; but at least | | | | one of ReleaseRange and | | | | Options must be | | | | present. | | | | | | | | If present, it | | | | indicates the range of | | | | releases for which the | | | | conformance requirement | | | | is tested. | | | | | | | | If absent, it is | | | | equivalent to \"R99 - | | | | ...\". | | +----------------+-------------------------+-------------------------+ | Options | A comma-separated list | O_LOG_CHANS | | | containing at least one | | | | of the options in table | O_LOG_CHANS, | | | A.1. | O_SHAREABLE | | | | | | | Optional (along with | | | | the preceding colon); | | | | but at least one of | | | | ReleaseRange and | | | | Options must be | | | | present. | | | | | | | | If present, this | | | | indicates that the | | | | conformance requirement | | | | is only applicable to | | | | UICCs supporting all of | | | | the specified options. | | | | | | | | If absent, this | | | | indicates that the | | | | conformance requirement | | | | applies to all UICCs. | | +----------------+-------------------------+-------------------------+
An additional shortcut notation for \"R99 - ...\" is specified: \"M\". This
indicates that the conformance requirement is mandatory for all UICCs of all
releases.
Examples of the notation are as follows:
* * *
**Example** **Meaning** (Rel-4) Rel-6 -- ...: O_LOG_CHANS Conformance
requirement introduced in Rel-4, but not tested until Rel-6, where it is only
applicable if O_LOG_CHANS is supported. (Rel-4) Rel-6 -- ...: O_LOG_CHANS,
O_SHAREABLE Conformance requirement introduced in Rel-4, but not tested until
Rel-6, where it is only applicable if O_LOG_CHANS and O_SHAREABLE are
supported. Rel-6 -- ...: O_LOG_CHANS Conformance requirement introduced in
Rel-6, where it is only applicable if O_LOG_CHANS is supported. Rel-6 -- ...:
O_LOG_CHANS, O_SHAREABLE Conformance requirement introduced in Rel-6, where it
is only applicable if O_LOG_CHANS and O_SHAREABLE are supported. R99 - Rel-5
Mandatory for all UICCs from R99 to Rel-5. Rel-6 - ... Mandatory for all UICCs
from all releases up to and including the current release of this document.
O_MONO_APP Applies to all releases, but only applicable if O_MONO_APP is
supported by the UICC. M Mandatory for all releases; equivalent to \"R99 -
...\".
* * *
## 3.6 Table of optional features
Support of several features is optional, release dependent or configuration
dependent for the UICC. However, if a UICC states conformance with a specific
3GPP release, it is mandatory for the UICC to support all mandatory functions
of that release, as stated in table A.1.
The \"Option defined in Releases\" column indicates the releases of the
relevant core specification(s) in which the option is defined.
The supplier of the implementation shall state the support of possible options
in table A.1.
A supplier may choose to use a single UICC and reconfigure it as required for
each test; or may choose to use a number of UICCs which are based on the same
platform but are configured differently. The supplier shall state the chosen
solution and in the latter case shall confirm usage of identical platforms.
Table A.1: Options
* * *
Option Status Option defined in Releases Support Mnemonic ID-1 UICC O.1 R99
O_ID1_UICC Plug-in UICC O.1 R99 O_PLUG_IN_UICC Type 1 (i.e. UICC which always
enters the negotiable mode after a warm reset) O.2 R99 O_TYPE_1 Type 2 (UICC
which always enters the specific mode after a warm reset) O.2 R99 O_TYPE_2 T=0
O.3 R99 O_T0 T=1 O.3 R99 O_T1 Mono application UICC O.4 R99 O_MONO_APP Multi-
application UICC O.4 R99 O_MULTI_APP Single verification capable UICC O.5 R99
O_SINGLE_VER Multi-verification capable UICC O.5 R99 O_MULTI_VER More than one
logical channel supported O Rel-4 O_LOG_CHANS More than two logical channels
supported O Rel-4 O_LOG_CHANS_34 Shareable files O Rel-4 O_SHAREABLE Non-
shareable files O Rel-4 O_NON_SHAREABLE GET CHALLENGE O Rel-4 O_GET_CHALLENGE
Mini-UICC O.1 Rel-6 O_MINI_UICC (F, D) = (512, 64) O Rel-6 O_F_D_512_64 Low
impedance drivers O Rel-6 O_LOW_IMPEDANCE BER-TLV structure EFs O Rel-6
O_BER_TLV_FILES
* * *
## 3.7 Applicability table
Table B.1: Applicability of tests
**Clause** | Description | Test procedure | Tested features defined in Release | R99 UICC | Rel-4 UICC | Rel-5 UICC | Rel-6 UICC | Rel-7 UICC | Support  
---|---|---|---|---|---|---|---|---|---  
6.1.1 | **ID-1 UICC** | 1 | R99 | **C001** | **C001** | **C001** | **C001** | **C001** |   
6.1.2 | **Plug-in UICC** | 1 | R99 | C002 | C002 | C002 | C002 | C002 |   
6.1.3 | **Temperature range for card operation** | 1 | R99 | M | **M** | **M** |  |  |   
|  | 2 | Rel-6 |  |  |  | **M** | **M** |   
6.1.4 | **Contacts** | N/A |  |  |  |  |  |  |   
6.1.5 | **Mini-UICC** | 1 | Rel-6 |  |  |  | **C003** | **C003** |   
6.2.1.1 | **Vcc – Voltage limits** | 1 | R99 | M | M | M | M | M |   
6.2.1.2 | **Vcc - Idle current limits** | 1 | R99 | M | M | M | M | M |   
6.2.1.3 | **Vcc - Current limits in clk-stop-mode** | 1 | R99 | M | M | M | M | M |   
6.2.2.1 | **RST - Static operation** | 1 | R99 | M | M | M | M | M |   
6.2.3.1 | **Vpp - Static operation** | 1 | R99 | M | M | M | M | M |   
6.2.4.1 | **CLK - Frequency and duty cycle** | 1 | R99 | M | M | M | M | M |   
6.2.4.2 | **Voltage and current** | 1 | R99 | M | M | M | M | M |   
6.2.5.1 | **I/O - Voltage and current** | 1 | R99 | M | M | M | C018 | C018 |   
|  | 2 | Rel-6 |  |  |  | C019 | C019 |   
|  | 3 | Rel-6 |  |  |  | C020 | C020 |   
6.3.1.1 | **Supply voltage switching - Supply voltage classes** | N/A |  |  |  |  |  |  |   
6.3.1.2 | **Supply voltage switching - Power consumption of the UICC during ATR** | 1 | R99 | M | M | M | M | M |   
6.3.1.3 | **Supply voltage switching - Application related electrical parameters** | 1 | R99 | M | M | M | M | M |   
6.3.2.1 | **ATR - Major capabilities** | 1 | R99 | M | M | M | M | M |   
6.3.2.2 | **ATR - Speed enhancement** | 1 | R99 | M | M | M | M | M |   
6.3.2.3 | **Global Interface bytes** | 1 | Rel-6 |  |  |  | M | M |   
6.3.3 | **PPS procedure** | 1 | R99 |  |  |  | M | M |   
6.3.4 | **Reset procedures** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 |  |  |  | M | M |   
|  | 3 | R99 |  |  |  | C004 | C004 |   
|  | 4 | R99 |  |  |  | C005 | C005 |   
6.3.5 | **Clock stop mode** | 1 | R99 | M | M | M | M | M |   
6.3.6 | **Bit/character duration and sampling time** | N/A |  |  |  |  |  |  |   
6.3.7 | **Error handling** | 1 | R99 | M | M | M | M | M |   
6.3.8 | **Compatibility** | N/A |  |  |  |  |  |  |   
6.4.1 | **Physical Layer** | N/A |  |  |  |  |  |  |   
6.4.2.1 | **Character Frame** | 1 | R99 | M | M | M | M | M |   
6.4.2.2 | **Transmission Protocol T=0** | 1 | R99 | C006 | C006 | C006 | C006 | C006 |   
6.4.2.3.1.1 | **T=1 - Information field size** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.1.2 | **T=1 - Character waiting integer** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.1.3 | **T=1 - Character waiting time** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.1.4 | **T=1 - Block guard time** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.1.5 | **T=1 - Waiting time extension** | N/A |  |  |  |  |  |  |   
6.4.2.3.1.6 | **T=1 - Error detection code** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.2.1.1 | **T=1 - Prologue field - Node address byte** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.2.1.2 | **T=1 - Prologue field - Protocol Control Byte** | N/A |  |  |  |  |  |  |   
6.4.2.3.2.1.3 | **T=1 - Prologue field - Length** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.2.1.4 | **T=1 - Information field** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.2.3 | **T=1 - Epilogue field** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.3 | **T=1 - Error free operation** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.4.1 | **T=1 - Error Handling - Protocol initialisation** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.4.2.1 | **T=1 - Error Handling - Sending invalid blocks to the UICC** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.2.3.5 | **T=1 - Chaining** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.3.1.1 | **Transportation of an APDU using T=0 - Case 1** | 1 | R99 | C006 | C006 | C006 | C006 | C006 |   
6.4.3.1.2 | **Transportation of an APDU using T=0 - Case 2** | 1 | R99 | C006 | C006 | C006 | C006 | C006 |   
6.4.3.1.3 | **Transportation of an APDU using T=0 - Case 3** | 1 | R99 | C006 | C006 | C006 | C006 | C006 |   
6.4.3.1.4 | **Transportation of an APDU using T=0 - Case 4** | 1 | R99 | C006 | C006 | C006 | C006 | C006 |   
6.4.3.1.5.1 | **Use of Procedure Bytes '61xx' and '6Cxx' - Case 2 Commands** | 1 | R99 | C006 | C006 | C006 | C006 | C006 |   
6.4.3.1.5.2 | **Use of Procedure Bytes '61xx' and '6Cxx' - Case 4 Commands** | N/A |  |  |  |  |  |  |   
6.4.3.2.1 | **Transportation of an APDU using T=1 - Case 1** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.3.2.2 | **Transportation of an APDU using T=1 - Case 2** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.3.2.3 | **Transportation of an APDU using T=1 - Case 3** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.3.2.4 | **Transportation of an APDU using T=1 - Case 4** | 1 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.4.4 | **Application Layer** | N/A |  |  |  |  |  |  |   
6.5.1 | **UICC Application structure** | 1 | R99 | M | M | M | M | M |   
6.5.2.1 | **Dedicated files** | N/A |  |  |  |  |  |  |   
6.5.2.2.1 | **Transparent EF** | 1 | R99 | M | M | M | M | M |   
6.5.2.2.2 | **Linear fixed EF** | 1 | R99 | M | M | M | M | M |   
6.5.2.2.3 | **Cyclic EF** | 1 | R99 | M | M | M | M | M |   
6.5.2.2.4 | **BER-TLV structure EF** | N/A |  |  |  |  |  |  |   
6.5.3 | **File referencing** | N/A |  |  |  |  |  |  |   
6.5.4.1 | **SELECT by File Identifier Referencing** | 1 | R99 | M | M | M | M | M |   
6.5.4.2 | **SELECT by Path Referencing** | 1 | R99 | M | M | M | M | M |   
6.5.4.3 | **Short File Identifier** | 1 | R99 | M | M | M | M | M |   
6.5.5.1.1 | **SELECT by DF Name** | 1 | R99 | M | M | M | M | M |   
6.5.5.1.2 | **SELECT by partial DF Name** | 1 | R99 |  |  |  | C009 | C009 |   
|  | 2 | R99 | C008 | C008 | C008 |  |  |   
|  | 3 | R99 |  |  |  | C008 | C008 |   
6.5.5.2 | **Application session activation** | 1 | R99 | M | M | M | M | M |   
6.5.5.3 | **Application session termination** | 1 | R99 | C008 | C008 | C008 | C008 | C008 |   
|  | 2 | R99 | M | M | M |  |  |   
|  | 3 | Rel-6 |  |  |  | M | M |   
|  | 4 | R99 | M | M | M | M | M |   
|  | 5 | Rel-4 |  |  |  | C010 | C010 |   
6.5.5.4 | **Application session reset** | 1 | R99 | M | M | M | M | M |   
6.5.5.5 | **GSM/USIM application interaction and restrictions** | 1 | R99 | M | M | M |  |  |   
6.5.6 | **Reservation of file IDs** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 | M | M | M |  |  |   
|  | 3 | R99 |  |  |  | M | M |   
6.5.7.1 | **No Logical Channel Support** | 1 | Rel-4 |  |  |  | C011 | C011 |   
6.5.7.2 | **Logical Channels - Basic Behaviour** | 1 | Rel-4 |  |  |  | C010 | C010 |   
|  | 2 | Rel-4 |  |  |  | C012 | C012 |   
6.5.7.3 | **Opening a Logical Channel from the Basic Channel** | 1 | Rel-4 |  |  |  | C010 | C010 |   
6.5.7.4 | **Opening a Logical Channel from a Non-Basic Channel** | 1 | Rel-4 |  |  |  | C013 | C013 |   
6.5.7.5 | **Opening a Logical Channel on Non-Shareable Files** | 1 | Rel-4 |  |  |  | C014 | C014 |   
6.5.7.6 | **Logical Channels and Shareable Files** | 1 | Rel-6 |  |  |  | C014 | C014 |   
|  | 2 | Rel-4 |  |  |  | C015 | C015 |   
6.5.7.7 | **Logical channels - Command Interdependencies** | 1 | Rel-4 |  |  |  | C015 | C015 |   
6.5.7.8 | **Logical channels - Consistency of File Updates** | 1 | Rel-4 |  |  |  | C015 | C015 |   
6.6.1 | **Supported security features** | 1 | R99 | C016 | C016 | C016 | C016 | C016 |   
|  | 2 | R99 | C017 | C017 | C017 | C017 | C017 |   
6.6.2 | **Security architecture** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 |  |  |  | M | M |   
6.6.3 | **Security environment** | 1 | R99 | C016 | C016 | C016 | C016 | C016 |   
6.6.4 | **PIN definitions** | 1 | R99 | C016 | C016 | C016 |  |  |   
|  | 2 | R99 |  |  |  | C016 | C016 |   
|  | 3 | R99 | C017 | C017 | C017 | C017 | C017 |   
6.6.5 | **PIN and key reference relationship** | 1 | R99 | C016 | C016 | C016 | C016 | C016 |   
|  | 2 | R99 | C017 | C017 | C017 | C017 | C017 |   
6.7.1 | **Mapping principles** | 1 | R99 | M | M | M | M | M |   
6.7.2.1 | **Status Conditions Returned by the UICC** | 1 | R99 | M | M | M | M | M |   
6.7.2.2 | **Status Words of the Commands** | N/A |  |  |  |  |  |  |   
6.7.3 | **Logical Channels** | N/A |  |  |  |  |  |  |   
6.8.1.1 | **SELECT** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 |  |  |  | M | M |   
6.8.1.2 | **STATUS** | 1 | R99 | M | M | M | M | M |   
6.8.1.3 | **READ BINARY** | 1 | R99 | M | M | M | M | M |   
6.8.1.4 | **UPDATE BINARY** | 1 | R99 | M | M | M | M | M |   
6.8.1.5 | **READ RECORD** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 | M | M | M | M | M |   
|  | 3 | R99 | M | M | M | M | M |   
6.8.1.6 | **UPDATE RECORD** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 | M | M | M | M | M |   
|  | 3 | R99 | M | M | M | M | M |   
6.8.1.7 | **SEARCH RECORD** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 | M | M | M | M | M |   
|  | 3 | R99 | M | M | M | M | M |   
|  | 4 | R99 | C007 | C007 | C007 | C007 | C007 |   
6.8.1.8 | **INCREASE** | 1 | R99 | M | M | M | M | M |   
6.8.1.9 | **VERIFY PIN** | 1 | R99 | M | M | M | M | M |   
|  | 2 | Rel-4 |  |  |  | C010 | C010 |   
|  | 3 | R99 |  |  |  | M | M |   
6.8.1.10 | **CHANGE PIN** | 1 | R99 | M | M | M | M | M |   
|  | 2 | Rel-4 |  |  |  | C010 | C010 |   
6.8.1.11 | **DISABLE PIN** | 1 | R99 | M | M | M | M | M |   
6.8.1.12 | **ENABLE PIN** | 1 | R99 | M | M | M | M | M |   
6.8.1.13 | **UNBLOCK PIN** | 1 | R99 | M | M | M | M | M |   
|  | 2 | R99 | M | M | M | M | M |   
|  | 3 | R99 |  |  |  | M | M |   
|  | 4 | Rel-4 |  |  |  | C010 | C010 |   
6.8.1.14 | **DEACTIVATE FILE** | 1 | R99 | M | M | M | M | M |   
6.8.1.15 | **ACTIVATE FILE** | 1 | R99 | M | M | M | M | M |   
6.8.1.16 | **AUTHENTICATE** | N/A |  |  |  |  |  |  |   
6.8.1.17 | **MANAGE CHANNEL** | N/A |  |  |  |  |  |  |   
6.8.1.18 | **GET CHALLENGE** | 1 | Rel-4 |  |  |  | C021 | C021 |   
**6.8.2.1** | **RETRIEVE DATA** | 1 | Rel-6 |  |  |  | C022 | C022 |   
|  | 2 | Rel-6 |  |  |  | C022 | C022 |   
|  | 3 | Rel-6 |  |  |  | C022 | C022 |   
**6.8.2.2** | **SET DATA** | 1 | Rel-6 |  |  |  | C022 | C022 |   
|  | 2 | Rel-6 |  |  |  | C022 | C022 |   
|  | 3 | Rel-6 |  |  |  | C022 | C022 |   
|  | 4 | Rel-6 |  |  |  | C022 | C022 |   
**6.8.2.3** | **BER-TLV structure files** | 1 | Rel-6 |  |  |  | C022 | C022 |   
|  | 2 | Rel-6 |  |  |  | C022 | C022 |   
|  | 3 | Rel-6 |  |  |  | C022 | C022 |   
**6.8.2.4** | **Logical channel interactions** | 1 | Rel-6 |  |  |  | C023 | C023 |   
|  | 2 | Rel-6 |  |  |  | C023 | C023 |   
|  | 3 | Rel-6 |  |  |  | C023 | C023 |   
6.9.1.1 | **GET RESPONSE** | 1 | R99 | M | M | M | M | M |   
6.10 | **Application independent files** | 1 | R99 | M | M | M | M | M |   
7.1 | **Contents of the Elementary Files (EF)** | 1 | R99 |  |  |  | M | M |   
|  | 2 | R99 | M | M | M |  |  |   
7.2 | **Security features** | 1 | R99 | C016 | C016 | C016 | C016 | C016 |   
7.3.1 | **AUTHENTICATE** | 1 | R99 | M | M | M | M | M |   
7.3.2.1 | **Security management** | 1 | R99 | M | M | M | M | M |   
7.3.2.2 | **Status Words of the Commands** | N/A |  |  |  |  |  |  |   
8.1.1 | **GSM/USIM application interaction and restrictions** | 1 | Rel-6 |  |  |  | M | M |   
8.2.1 | **Transmission speed** | 1 | Rel-6 |  |  |  | C006 | C006 |   
|  | 1 | Rel-6 |  |  |  | C007 | C007 |   
8.2.2 | **Voltage classes** | 1 | Rel-6 |  |  |  | M | M |   
8.2.3 | **File Control Parameters (FCP)** | 1 | Rel-6 |  |  |  | M | M |   
8.3 | **User verification and file access conditions** | 1 | Rel-6 |  |  |  | C016 | C016 |   
|  | 2 | Rel-6 |  |  |  | C017 | C017 |   
8.4.1 | **Contents of the EFs at the MF level** | 1 | Rel-6 |  |  |  | M | M |   
C001 IF O_ID1_UICC THEN M ELSE N/A C002 IF O_PLUG_IN_UICC THEN M ELSE N/A C003 IF O_MINI_UICC THEN M ELSE N/A C004 IF O_TYPE_1 THEN M ELSE N/A C005 IF O_TYPE_2 THEN M ELSE N/A C006 IF O_T0 THEN M ELSE N/A C007 IF O_T1 THEN M ELSE N/A C008 IF O_MULTI_APP THEN M ELSE N/A C009 IF O_MONO_APP THEN M ELSE N/A C010 IF **O_LOG_CHANS THEN M ELSE N/A** C011 IF (NOT **O_LOG_CHANS) THEN M ELSE N/A** **C012 IF** O_LOG_CHANS_34 **THEN M ELSE N/A** **C013 IF (O_LOG_CHANS_34 AND O_SHAREABLE) THEN M ELSE N/A** **C014 IF (O_LOG_CHANS AND O_NON_SHAREABLE) THEN M ELSE N/A** **C015 IF (O_LOG_CHANS AND O_SHAREABLE) THEN M ELSE N/A** C016 IF O_MULTI_VER THEN M ELSE N/A C017 IF O_SINGLE_VER THEN M ELSE N/A C018 IF (NOT O_F_D_512_64) THEN M ELSE N/A C019 IF O_F_D_512_64 THEN M ELSE N/A C020 IF O_LOW_IMPEDANCE THEN M ELSE N/A C021 IF O_GET_CHALLENGE THEN M ELSE N/A C022 IF O_BER_TLV_FILES THEN M ELSE N/A C023 IF (O_BER_TLV_FILES AND **O_LOG_CHANS AND O_SHAREABLE) THEN M ELSE N/A** |  |  |  |  |  |  |  |  |   
# 4 Test environment
This clause specifies several requirements which shall be met, and a number of
rules which shall be adhered to before testing can proceed.
## 4.1 Test equipment
This subclause recommends a minimum specification for each of the items of
test equipment referenced in the tests.
### 4.1.1 ME simulator
This item of equipment shall allow T = 0 and T = 1 protocol communications to
take place on both ID-1 and plug-in UICCs. It shall be able to generate and
send any command APDU and receive any of the possible responses. These
commands may be generated manually, one at a time, or automatically from a
predefined batch procedure containing one or more commands.
The ME simulator shall be able to support clock stop modes.
The ME simulator shall be able to accept an external clock signal to drive CLK
(contact C3) of the UICC.
It shall be possible to access all the UICC contacts either directly or
through test points.
### 4.1.2 Signal generation device
#### 4.1.2.1 Vcc
The voltage level for Vcc (contact C1) of the UICC shall be adjustable between
-0,5 V and 6,0 V to an accuracy of 1% of the nominal Vcc voltage (e.g. 50 mV
for class A operating conditions).
The ME simulator shall be able to source current on the Vcc contact in the
range ‑2 mA to 12 mA statically and to deliver charges of > 400 nAs without
lowering the Vcc voltage for more than 10 % of Vcc nominal. _(to be able to
detect current spikes generated by the UICC)_
#### 4.1.2.2 RST
The generated voltage level for RST (contact C2) of the UICC shall be
adjustable between -0,5 V and 6,0 V to an accuracy of 50 mV.
The rise and fall times shall be adjustable from 0 μs to 500 μs with an
accuracy of 5 μs. _(to check if the USIM works with the defined rise and fall
times.)_
The beginning of the rising edge shall be programmable from 1 clk-cycle to
50,000 clk-cycles after enabling the clk-line. _(to check if the UICC accepts
the minimum and maximum clk-cycle values)_
#### 4.1.2.3 CLK
This item of equipment shall be able to generate square wave signals for the
clock on the UICC, any of which can be a single-shot or continuous signal, in
the range 1 MHz to 5 MHz. The voltage levels for both high and low states
shall be adjustable between -0,5 V and 6,0 V to an accuracy of 0,1 V. The duty
cycle of the clock signal shall be adjustable between 40 % and 60 % to an
accuracy of 1 %. It shall also provide control over the following parameters:
The voltage levels for both high and low states shall be adjustable between 0
V and 6 V to an accuracy of 1% of the nominal Vcc voltage. The duty cycle of
the clock signal shall be adjustable between 40 % and 60 % to an accuracy of 1
% or 5 ns whichever is the worst.
It shall also provide control over the following parameters:
\- rise and fall time to an accuracy of 1 % or 5 ns whichever is the worst.
_(5 ns = 2,5 % accuracy for f~max~ = 5 MHz)._
#### 4.1.2.4 I/O
The equipment shall be able to generate I/O-Signals according to TS 102.221
[1]
The voltage levels for high and low states shall be adjustable between -0,5 V
and 6,0 V to an accuracy of 1 % of the nominal Vcc voltage. The I/O line in
transmission mode (high bit) shall be programmable between state A (active
driven output) and state Z (I/O-voltage-driver inactive, current source
I-I/O-high active).
It shall also provide control over the rise and fall time of 100 ns to 1 000
ns with an accuracy of 50 ns.
The ME simulator shall be able to source and sink currents on the I/O contact
in the range ‑20 μA to +20 μA in state high and 0 mA to ‑1 mA in state low
(receiving mode) and shall be able to switch in transmission mode (outputting
a high bit) between voltage and current driving mode.
The timing of the bitstream (jitter, guardtime, etu-value, etc.) on the
I/O-Line shall be programmable with an accuracy of ≤ 0,01 etu or 2 clk-cycles
whichever is the worst.
### 4.1.3 Precision force-inducing contacting device
This item of equipment shall be able to apply a prescribed and maintained
level of force onto one or more contacts of the UICC. The range shall be
between 0 and 0,5 N and accurate to 0,01 N.
### 4.1.4 Temperature controllable environment
This item of equipment shall be able to control the temperature of a chamber
large enough to enclose the UICC and the card reader. The range of temperature
control shall be between ‑25 °C and +85 °C to an accuracy of 0,5 °C.
### 4.1.5 Temperature measuring device
This item of equipment shall be able to measure the temperature of the UICC to
within 0,5 °C. The range of this device shall allow measurement of
temperatures between ‑25 °C and +85 °C.
### 4.1.6 Voltage measuring device
This item of equipment shall be able to measure static and transient voltages
on any one of the contacts of the UICC. The measurable voltage range shall be
between ‑2 V and +7 V to an accuracy of 1% of the nominal Vcc voltage (e.g. 30
mV for class B operating conditions) with a timebase accuracy of 25 ns.
### 4.1.7 Precision measuring device
This item of equipment shall be able to measure both linear and radius of
curvature dimensions to an accuracy of 0,01 mm.
### 4.1.8 Current measuring device
This item of equipment shall be able to supervise the current levels for any
one of the contacts of the USIM.
The simulator shall be able to detect an over - or underload with a time
resolution of ≤ 100 ns.
+----------------+-----------+-----------+------------+ | Channel | Minimum | Maximum | Resolution | +----------------+-----------+-----------+------------+ | Vcc high | -2 mA | +12,5 mA | 125 μA | +----------------+-----------+-----------+------------+ | Vcc low | -2 mA | +12,5 mA | 125 μA | +----------------+-----------+-----------+------------+ | | | | | +----------------+-----------+-----------+------------+ | Vcc Burst | 12 mA | +250 mA | 2,5 mA | +----------------+-----------+-----------+------------+ | RST/CLK | -50 μA | +50 μA | 1 μA | | | | | | | High state | | | | +----------------+-----------+-----------+------------+ | RST/CLK | -250 μA | +250 μA | 2,5 μA | | | | | | | Low state | | | | +----------------+-----------+-----------+------------+ | I/O high state | -50 μA | +50 μA | 1 μA | +----------------+-----------+-----------+------------+ | I/O low state | -1 500 μA | +1 500 μA | 15 μA | +----------------+-----------+-----------+------------+
### 4.1.9 Timing Measurements on contact I/O
To verify the timing of the I/O transmission from the UICC, the ME simulator
shall be able to measure the I/O-Bit-Timing in clk-cycles with an accuracy of
≤ 0,01 etu or 2 clk-cycles whichever is the worst.
## 4.2 IUT default conditions
Unless otherwise stated, the following is default:
\- The voltage level for Vcc (contact C1) shall be set to 3,0 V.
\- The voltage levels for CLK (contact C3) shall be set to 0 V and 3,0 V for
low and high respectively.
\- The clock frequency CLK (contact C3) shall be set to 5 MHz with duty cycle
50 %.
\- The ME simulator generated low transmission voltage level for I/O (contact
C7) shall be set to 0 V and the current sources for high transmission and
reception shall be set to -20 μA and +20 μA respectively
\- Any level 1 user verification requirement (PIN) on the UICC shall be
enabled with three VERIFY PIN attempts and ten UNBLOCK PIN attempts remaining.
\- Any level 2 user verification requirement (PIN2) on the UICC shall be
enabled with three VERIFY PIN2 attempts and ten UNBLOCK PIN2 attempts
remaining, if assigned.
\- A Universal PIN on the UICC shall be enabled, if IUT is a multi-
verification capable UICC.
## 4.3 Default data formatting
All numeric data enclosed in single quotes (\' \') in this document are
hexadecimal data.
Where \'X\' is used in place of a hexadecimal digit, X ranges from \'0\' to
\'F\'. For example, the data \'6X\' ranges from \'60\' to \'6F\' inclusive.
Where data is expressed as a group of bytes, it shall be in the following
format: \'XX XX XX... XX\', indicating first byte, second byte, third byte
etc. in that order.
A string of digits shall be formatted with a continuous string of numeric data
and enclosed with single quotes. For example, the string \'XXXXXXXX\' where X
ranges from 0 to 9 inclusive.
## 4.4 Test definition and applicability
The following statements are applicable to the test definition and
applicability clause for all test purposes contained within the present
document:
\- Unless otherwise stated, tests apply to both plug-in and ID-1 UICC cards.
\- Unless otherwise stated, tests apply to each protocol supported by the
UICC.
\- The tests are performed on a UICC as defined in TS 31.101 [2] with a USIM
application as defined in TS 31.102 [3]. The tests to check the requirement of
TS 31.101 [2] use the files as defined in TS 31.102 [3].
\- Unless otherwise stated, the tests apply to single and multi-verification
capable UICCs with USIM application(s). In the case of a multi-verification
capable UICC, there shall be only one application.
## 4.5 Initial conditions
Unless otherwise stated, all the PINs used in the test procedures shall be
initially enabled.
Figure 1 shows the files in the UICC which shall be used for the test
procedures, in the case where the EFs are not mandatory, they may be replaced
with other EFs of the same file structure.
Unless otherwise stated, all the EFs used in the test procedure shall be
activated.
* * *
                                                         MF                                                                                                 
                                                         \'3F00\'
     DF~TELECOM~                         EF~DIR~                    EF~PL~                     EF~ARR~         EF~ICCID~                                    
     \'7F10\'                            \'2F00\'                   \'2F05\'                   \'2F06\'        \'2FE2\'
                                                         EF~ARR~                    EF~ADN~                                                                 
                                                         \'6F06\'                   \'6F3A\'
     ADF~USIM~
                      DF~PHONEBOOK~                                                                                                                         
                      \'5F3A\'
                      EF~PBR~            EF~ADN~                                                                                                            
                      \'4F30\'           \'4F3A\'
                      EF~ARR~            EF~IMSI~                   EF~Keys~                   EF~KeysPS~      EF~HPLMN~      EF~UST~                       
                      \'6F06\'           \'6F07\'                   \'6F08\'                   \'6F09\'        \'6F31\'       \'6F38\'
                      EF~PUCT~           EF~START-HFN~              EF~THRESHOLD~              EF~LOCIPS~      EF~ACC~        EF~FPLMN~                     
                      \'6F41\'           \'6F5B\'                   \'6F5C\'                   \'6F73\'        \'6F78\'       \'6F7B\'
                      EF~LOCI~           EF~AD~                     EF~ECC~                    EF~FDN~         EF~ICI~        EF~CCP2~                      
                      \'6F7E\'           \'6FAD\'                   \'6FB7\'                   \'6F3B\'        \'6F80\'       \'6F4F\'
                      EF~SMS~            EF~SMSS~                   EF~ACMmax~                 EF~ACM~                                                      
                      \'6F3C\'           \'6F43\'                   \'6F37\'                   \'6F39\'
* * *
Figure 1: File identifiers and directory structures of UICC
The initial conditions for some of the EFs are given in the followings:
> \- PIN shall be set to \'00000000\'.
>
> \- PIN2 shall be set to \'11111111\'.
>
> \- Universal PIN shall be set to \'22222222\', if supported.
>
> \- EF~FPLMN~ shall contain the data string: \'55 AA 0F 00 F0 FF 00 F0 FF 00
> F0 FF\'.
>
> \- EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
> 00\'.
\- The records in EF~SMS~ shall contain the following data for the first 20
bytes:
* * *
**1^st^ record** \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0 A1 A2 FF A0 A1 A2 A3 A4 A5
A6\' **2^nd^ record** \'B0 B1 B2 A0 A1 A2 A0 A1 A2 B0 B1 B2 FF B0 B1 B2 B3 B4
B5 B6\' **3^rd^ record** \'B0 B1 B2 A0 A1 A2 B0 B1 B2 A0 A1 A2 FF C0 C1 C2 C3
C4 C5 C6\' **4^th^ record** \'A0 A1 A2 B0 B1 B2 B0 B1 B2 B0 B1 B2 FF D0 D1 D2
D3 D4 D5 D6\'
* * *
> The data for the remainder of these four records and for all other records
> shall be \'FF\'.
\- The records in EF~FDN~ shall contain the following data for the first 10
bytes:
* * *
**1st record** \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\' **2nd record** \'B0 B1 B2 A0
A1 A2 A0 A1 A2 B0\' **3rd record** \'B0 B1 B2 A0 A1 A2 B0 B1 B2 A0\' **4th
record** \'A0 A1 A2 B0 B1 B2 B0 B1 B2 B0\'
* * *
> The data for the remainder of these four records and for all other records
> (if any) shall be \'FF\'.
\- The records in EF~CCP2~ shall contain the following data:
* * *
**1^st^ record** \'10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E\' **2^nd^
record** \'20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E\' **2^nd^ last
record** \'E0 E1 E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE\' **Last record** \'F0
F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE\'
* * *
\- The records in EF~ACM~ shall contain the following data, if it is
supported:
* * *
**1^st^ record** \'00 00 01\'(last updated record) **2^nd^ record** \'00 00
02\' **3^rd^ record** \'00 00 03\' **X^th^ record** \'00 00\' followed by byte
value X (first updated record)
* * *
\- The records in EF~ICI~ shall contain the following data:
* * *
**1^st^ record** \'01\' for all bytes **2^nd^ record** \'02\' for all bytes
**3^rd^ record** \'03\' for all bytes **X^th^ record** byte value X for all
bytes
* * *
\- The records in EF~ECC~ shall contain the following data:
* * *
**1^st^ record** \'21 F2 FF 54 45 53 54 00\' **All other records** \'FF FF FF
FF FF FF FF 00\'
* * *
## 4.6 Test procedure
The following statements are applicable to the test procedure clause for all
test purposes contained within the present document:
\- Unless otherwise stated, all steps within the test procedure shall be
carried out in order.
\- Unless otherwise stated, all test procedures shall be applicable to both T
= 0 and T = 1 protocols.
\- Where steps indicate that a ME simulator shall select a particular DF or EF
using an unspecified number of SELECT commands, the ME simulator is to send
the correct sequence of SELECT commands in order to select the required file
ID from the current file ID (this may be achieved most easily by selecting
from the MF down each time).
\- Unless otherwise stated, the Le (P3) for all READ RECORD commands and Lc
(P3) for all UPDATE RECORD commands sent by the ME simulator is to be that of
the record length of the EF currently selected. In the case where an EF is not
currently selected, the length sent is to be 1 unless otherwise stated.
\- Unless otherwise stated, the offset for all READ BINARY and UPDATE BINARY
commands sent by the ME simulator is to be \'00 00\'.
\- Unless otherwise specified, when the T = 0 protocol is used, the necessary
GET RESPONSE commands are assumed to be sent, or the same command header is
assumed to be resent with P3 = L~UICC~ at the transport layer level in order
to retrieve the available response data from the UICC.
\- Unless otherwise stated, the length (Le) for all SELECT, STATUS and GET
RESPONSE commands sent by the ME simulator is to be such that all available
data is read.
\- Unless otherwise stated, the PIN and Unblock PIN presented for VERIFY PIN,
CHANGE PIN, DISABLE PIN, ENABLE PIN and UNBLOCK PIN commands sent by the ME
simulator is to be correct.
\- Unless otherwise stated, a SELECT command sent to the UICC to select
ADF~USIM~ is with the application\'s AID, indicating in the command parameter
that the application shall be activated.
\- Unless otherwise stated, a SELECT command sent to the UICC is with P2 =
\'04\', indicating that the FCP shall be returned.
\- Unless otherwise stated, all RETRIEVE DATA commands sent to the UICC shall
be with P2 indicating \"current EF\".
\- Unless otherwise stated, all SET DATA commands sent to the UICC shall be
with P2 indicating \"current EF\".
\- Unless otherwise stated, all SET DATA commands sent to the UICC shall be
sent with the maximum amount of data possible according to the data object
being transmitted.
## 4.7 Test requirement
Where steps within a test procedure involve a ME simulator sending one or more
commands to the UICC, these commands are required to be correctly executed,
with the UICC responding with status conditions of \'90 00\', unless otherwise
stated in the subclause for the test.
# 5 Void
# 6 Test Procedure (TS 102.221)
This clause details all the tests for testing the IUT against TS 102.221 [1].
This test suite allows testing of the IUT against the base specification with
respect to:
\- Physical characteristics
\- Electrical specifications of the UICC - Terminal interface
\- Initial communication establishment procedure
\- Transmission protocols
\- Application and File structure
\- Security features
\- Structure of commands and responses
\- Commands
\- Transmission Oriented Commands
\- Application independent files
## 6.1 Physical characteristics
The tests in this subclause ensure that the IUT conforms to the specification
for both format and layout and contacts.
### 6.1.1 ID-1 UICC
#### 6.1.1.1 Definition and applicability
See clause 3.5.3.
#### 6.1.1.2 Conformance requirement
* * *
CR1 Format and layout of the ID-1 UICC shall be in accordance with ISO 7816‑1
[4] and ISO 7816‑2 [5], unless otherwise specified. O_ID1_UICC CR2 Any
embossing on the card shall be in accordance with ISO 7811‑1 [12]. O_ID1_UICC
CR3 The contacts shall be located on the front (embossed face) of the card.
O_ID1_UICC
* * *
Reference: TS 102.221 [1], subclause 4.1.
#### 6.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: The testing of CR1 is outside the scope of the present document..
NOTE 2: The testing of CR2 is outside the scope of the present document.
#### 6.1.1.4 Method of test
**Initial conditions**
N/A
Test procedure 1
a) The card is examined for the following:
\- contact location.
_The card shall have been observed to exhibit the following [CR3]:_
_\- contact location on the front of the card._
### 6.1.2 Plug-in UICC
#### 6.1.2.1 Definition and applicability
See clause 3.5.3.
#### 6.1.2.2 Conformance requirement
* * *
CR1 The format and layout of the plug-in card shall be in accordance with ISO
7816‑1 [4] and ISO 7816‑2 [5], unless otherwise specified. O_PLUG_IN_UICC CR2
The dimensions of the plug-in UICC shall be in accordance with Figure 4.1 of
TS 102.221 [1]. O_PLUG_IN_UICC
* * *
Reference: TS 102.221 [1], clause 4 and more specifically subclause 4.2.
#### 6.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The testing of CR1 is outside the scope of the present document.
#### 6.1.2.4 Method of test
**Initial conditions**
N/A
Test procedure 1
a) The card is examined for the following:
  * width;
  * height;
  * feature for orientation.
_The card shall have been observed to exhibit the following [CR2]:_
_\- correct width and height;_
_\- feature for orientation._
### 6.1.3 Temperature range for card operation
#### 6.1.3.1 Definition and applicability
See clause 3.5.3.
#### 6.1.3.2 Conformance requirement
* * *
CR1 The temperature range for full operational use shall be between --25 °C
and +85 °C. Rel-6 - ... CR2 The temperature range for full operational use
shall be between --25 °C and +70 °C with occasional peaks of up to +85 °C,
where \"occasional\" means not more than 4 hours each time and not over 100
times during the life time of the card. R99 - Rel-5
* * *
Reference: TS 102.221 [1], subclause 4.4.
#### 6.1.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 6.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be placed in a temperature-controllable environment and
connected to a ME simulator.
2) A temperature measuring device shall be connected to the surface of the
UICC.
3) The UICC shall have passed the Format and Layout tests in subclauses 6.1.1
or 6.1.2.
**Test procedure 1**
a) The temperature of the UICC shall be set to +25 °C.
b) The ME simulator shall reset the UICC.
c) The ME simulator shall perform the USIM initialisation procedure, as
defined in TS 31.102 [3], subclause 5.1.1.
_The UICC shall operate successfully [CR2]._
d) The temperature of the UICC shall be reduced to --25 °C.
e) Steps b) and c) shall be repeated.
_The UICC shall operate successfully [CR2]._
f) The temperature of the UICC shall be increased to +70 °C.
g) Steps b) and c) shall be repeated.
_The UICC shall operate successfully [CR2]._
h) The temperature of the UICC shall be increased to +85 °C.
i) Steps b) and c) shall be repeated continuously for a period of 4 hours.
_The UICC shall operate successfully [CR2]._
j) The temperature of the UICC shall be reduced to +25 °C.
k) Steps h), i) and j) shall be repeated a further 99 times.
_The UICC shall operate successfully [CR2]._
_The UICC shall satisfy the test requirements of subclauses 6.1.1 or 6.1.2
[CR2]._
**Test procedure 2**
a) The temperature of the UICC shall be set to +25 °C.
b) The ME simulator shall reset the UICC.
c) The ME simulator shall perform the USIM initialisation procedure, as
defined in TS 31.102 [3], subclause 5.1.1.
_The UICC shall operate successfully [CR1]._
d) The temperature of the UICC shall be reduced to --25 °C.
e) Steps b) and c) shall be repeated.
_The UICC shall operate successfully [CR1]._
f) The temperature of the UICC shall be increased to +85 °C.
g) Steps b) and c) shall be repeated.
_The UICC shall operate successfully [CR1]._
### 6.1.4 Contacts
#### 6.1.4.1 Definition and applicability
See clause 3.5.3.
#### 6.1.4.2 Conformance requirement
* * *
CR1 If contacts C4 and C8 are provided, they shall not be connected internally
in the UICC if the UICC only contains a Telecom application. M CR2 Contact C6
shall not be bonded in the UICC for any function other than supplying Vpp. M
CR3 Contact C6 on a UICC not supporting class A operating conditions shall be
RFU. M
* * *
Reference: TS 102.221 [16], subclause 4.4.1.2; TS 102.221 [17], subclause
4.4.1.2; TS 102.221 [18], subclause 4.4.1.2; TS 102.221 [1], subclause
4.5.1.2.
#### 6.1.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 6.1.4.4 Method of test
Initial Conditions
N/A
Test Procedure
N/A
### 6.1.5 Mini-UICC
#### 6.1.5.1 Definition and applicability
See clause 3.5.3.
#### 6.1.5.2 Conformance requirement
* * *
CR1 The format and layout of the Mini-UICC shall be in accordance with ISO
7816‑1 [4] and ISO 7816‑2 [5], unless otherwise specified. Rel-6 - ...:
O_MINI_UICC CR2 The dimensions of the Mini-UICC shall be in accordance with
Figure 4.2 of TS 102.221 [1]. Rel-6 - ...: O_MINI_UICC
* * *
Reference: TS 102.221 [1], clause 4 and more specifically subclause 4.3.
#### 6.1.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
> NOTE: The testing of CR1 is outside the scope of the present document.
#### 6.1.5.4 Method of test
**Initial conditions**
N/A
**Test procedure 1**
a) The card is examined for the following:
> \- width
>
> \- height
>
> \- feature for orientation
>
> _The card shall have been observed to exhibit the following [CR2]:_
>
> _\- correct width and height;_
>
> _\- feature for orientation._
## 6.2 Electrical specifications of the UICC -- Terminal interface
The tests in this subclause ensure that the IUT conforms to the electrical
specification for each of the contacts and the protocol.
### 6.2.1 Supply voltage Vcc (contact C1)
#### 6.2.1.1 Voltage limits
##### 6.2.1.1.1 Definition and applicability
See clause 3.5.3.
##### 6.2.1.1.2 Conformance requirement
* * *
CR1 The UICC shall operate when the supply voltage on contact C1 (Vcc) is in
the ranges specified in table 1: M
* * *
Table 1: Electrical characteristics of Vcc under normal operating conditions
* * *
Operating Conditions Vmin /V Vmax /V Class A Operating Conditions 4,5 5,5
Class B Operating Conditions 2,7 3,3 Class C Operating Conditions 1,62 1,98
* * *
Reference: TS 102.221 [1], subclause 5.1.1, 5.2.1 and 5.3.1.
##### 6.2.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.2.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
NOTE: The voltage Vcc min/max depends on the voltage class the UICC provides.
a) The following steps shall be repeated for every voltage class which the
UICC provides.
b) The voltage source for contact C1 (Vcc) shall be set to Vcc min, and the
UICC interface signals shall be powered from a Vcc min source.
c) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence._
d) The ME simulator shall send a CHANGE PIN command to the UICC with new PIN
value of 8 zeros.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command._
e) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence._
f) The ME simulator shall send a CHANGE PIN command to the UICC to return the
PIN to its original value.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command._
g) The voltage source for contact C1 (Vcc) shall be set to Vcc max.
h) Steps c) to f) shall be repeated for all the operating conditions supported
by the UICC.
#### 6.2.1.2 Idle current limits
##### 6.2.1.2.1 Definition and applicability
See clause 3.5.3.
##### 6.2.1.2.2 Conformance requirement
* * *
CR1 The idle current consumption of the UICC shall not exceed I~max~ at 1 MHz,
+25 °C and Vcc~max~. M
* * *
Table 2: Current consumption in idle mode
+----------------------+----------------------+----------------------+ | Operating Conditions | Imax /μA in idle | Vcc~max~ /V | | | state clk frequency | | | | 1 MHz | maximum voltage on | | | | VCC during testing | +----------------------+----------------------+----------------------+ | Class A Operating | 200 | 5,5 | | Conditions | | | +----------------------+----------------------+----------------------+ | Class B Operating | 200 | 3,3 | | Conditions | | | +----------------------+----------------------+----------------------+ | Class C Operating | 200 | 1,98 | | Conditions | | | +----------------------+----------------------+----------------------+
Reference: TS 102.221 [1], subclauses 5.1.1. 5.2.1, and 5.3.1
##### 6.2.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.2.1.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) The frequency of the clock source shall be set to 1 MHz.
3) The temperature of the UICC shall be +25 °C.
4) The voltage on Vcc shall be set to Vcc~max.~
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The idle current consumption shall be measured after receiving the ATR over
a period of ten seconds.
_The current consumption of the UICC shall not exceed I~max~ [CR1]._
c) Steps a) and b) shall be repeated for all the operating conditions
supported by the UICC.
#### 6.2.1.3 Current limits in clk-stop-mode
##### 6.2.1.3.1 Definition and applicability
See clause 3.5.3.
##### 6.2.1.3.2 Conformance requirement
* * *
CR1 The clk stop mode current consumption of the UICC shall not exceed I~max~
if clk stop mode is delivered by the UICC. M
* * *
Table 3: Current consumption in clk stop mode
+----------------------+----------------------+----------------------+ | | Imax /μA in clk-stop | Vcc~max~ /V | | | mode | | | | | maximum voltage on | | | | VCC during testing | +----------------------+----------------------+----------------------+ | Class A Operating | 200 | 5,5 | | Conditions | | | +----------------------+----------------------+----------------------+ | Class B Operating | 100 | 3,3 | | Conditions | | | +----------------------+----------------------+----------------------+ | Class C Operating | 100 | 1,98 | | Conditions | | | +----------------------+----------------------+----------------------+
Reference: TS 102.221 [1], clause 5 and more specifically subclauses 5.1.1,
5.2.1, and 5.3.1.
##### 6.2.1.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.2.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall wait at least for 1 860 clocks.
c) The ME simulator shall stop the clock according to the clock stop mode
which was read in the ATR.
d) The current consumption shall be measured during clk stop mode over a
period of ten seconds.
_The current consumption of the UICC shall not exceed I~max~ in average during
clk stop mode [CR1]._
e) Steps a) to d) shall be repeated for all the operating conditions supported
by the UICC.
### 6.2.2 Reset RST (contact C2)
#### 6.2.2.1 Static operation
##### 6.2.2.1.1 Definition and applicability
See clause 3.5.3.
##### 6.2.2.1.2 Conformance requirement
* * *
CR1 The UICC shall operate within the limits for RST specified in table 4. M
* * *
Table 4: Electrical characteristics of RST under normal operating conditions
* * *
Operating Conditions V~OL~ min/V V~OL~ max/V I~OL~ max/μA V~OH~ min/V V~OH~
max/V I~OH~ max/μA Class A Operating Conditions -0,3 0,6 -200 Vcc - 0.7 Vcc
+0,3 +20 Class B Operating Conditions -0,3 0,2 × Vcc -200 0,8 × Vcc Vcc +0,3
+20 Class C Operating Conditions -0,3 0,2 × Vcc -200 0,8 × Vcc Vcc +0,3 +200
* * *
NOTE: t~R~ and t~F~ shall not exceed 400 µs, with C~out~ and C~in~ equal to 30
pF.
Reference: TS 102.221 [1], subclauses 5.1.2, 5.2.2 and 5.3.2.
##### 6.2.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.2.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) A current measuring device shall be connected to RST (contact C2) of the
UICC.
3) The capacitance, C~in~, of RST (contact C2) shall be measured to be 30 pF.
**Test procedure 1**
a) The following parameters shall be set for RST:
> \- V~OH~ of the RST signal shall be set to V~OH~ min;
>
> \- V~OL~ of the RST signal shall be set to V~OL~ min;
>
> \- t~R~ and t~F~ shall be set to 400 µs.
b) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR1]._
c) The following parameters shall be set for RST:
> \- V~OH~ of the RST signal shall be set to V~OH~ max;
>
> \- V~OL~ of the RST signal shall be set to V~OL~ max;
>
> \- t~R~ and t~F~ shall be set to 400 µs.
d) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR1]._
e) Steps a) to d) shall be repeated for all the operating conditions supported
by the UICC.
_The following shall be true for all tests [CR1]:_
_\- I~OLmax~ measured to be less than or equal to I~OL~ max;_
_\- I~OHmax~ measured to be less than or equal to I~OH~ max._
### 6.2.3 Programming voltage Vpp (contact C6)
#### 6.2.3.1 Static operation
##### 6.2.3.1.1 Definition and applicability
See clause 3.5.3.
##### 6.2.3.1.2 Conformance requirement
* * *
CR1 The UICC shall not require any programming voltage on Vpp. M CR2 If the
Terminal supporting class A operating conditions only, provides contact C6,
the same voltage shall be supplied on Vpp as on Vcc. M
* * *
Reference: TS 102.221 [1], subclause 5.1.3.
##### 6.2.3.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.2.3.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a. Contact C6 shall be connected to ground by the ME simulator.
b. Vcc shall be applied to contact C1.
c) Contact C2 (RST) shall be kept at low level, ground.
d) A valid clock signal shall be applied to Contact C3.
_The dc power consumption on Contact C1 shall not exceed 10 mA under any
condition [CR1, CR2]._
> NOTE: This test ensures that Vpp and Vcc are not bonded together in the
> UICC, if this would be the case Vpp would also supply the UICC with current
> for its operation.
e) Contact C6 shall not be connected to the ME simulator.
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a CHANGE PIN command to the UICC with new PIN
value of 8 zeros.
> _The UICC operates successfully without requiring to set Vpp at programming
> state in protocol level [CR1]._
h) The ME simulator shall reset the UICC.
i) The ME simulator shall send a CHANGE PIN command to the UICC to return the
PIN to its original value.
> _The UICC operates successfully without requiring to set Vpp at programming
> state in protocol level [CR1]._
j) Contact C6 shall be connected to Vpp which has the same voltage as Vcc.
k) The ME simulator shall reset the UICC.
l) The ME simulator shall send a CHANGE PIN command to the UICC with new PIN
value of 8 zeros.
> _The UICC operates successfully without requiring to set Vpp at programming
> state in protocol level [CR2]._
m) The ME simulator shall reset the UICC.
n) The ME simulator shall send a CHANGE PIN command to the UICC to return the
PIN to its original value.
> _The UICC operates successfully without requiring to set Vpp at programming
> state in protocol level [CR2]._
### 6.2.4 Clock CLK (contact C3)
#### 6.2.4.1 Frequency and duty cycle
##### 6.2.4.1.1 Definition and applicability
See clause 3.5.3.
##### 6.2.4.1.2 Conformance requirement
* * *
CR1 The UICC shall not support an internal clock. M CR2 The UICC shall support
a duty cycle between 40% and 60% of the period during stable operation. M CR3
The UICC shall operate within the limits for CLK specified in table 5. M
* * *
Table 5: Electrical characteristics of CLK under normal operating conditions
* * *
Operating Conditions V~OL~ min/V V~OL~ max/V V~OH~ min/V V~OH~ max/V t~R~ &
t~F~ max fmax /MHz Class A Operating Conditions -0,3 0,5 0,7 × Vcc Vcc +0,3 9%
with a max. of 0,5 μs 5 Class B Operating Conditions -0,3 0,2 × Vcc 0,7 × Vcc
Vcc +0,3 50 ns 5 Class C Operating Conditions -0,3 0,2 × Vcc 0,7 × Vcc Vcc
+0,3 50 ns 5 NOTE: t~R~ and t~F~ have to be measured between 10 % and 90 % of
V~OL~ max and V~OH~ min~;~ C~in~ is equal to 30 pF.
* * *
Calculation of the 10% and 90% thresholds for t~R~ and t~F~ measurements:
V~OL_threshold~ = (V~OH\ min~ - V~OLmax~)*10%+V~OL\ max~
V~OH_threshold~ = (V~OH\ min~ - V~OLmax~)*90%+V~OL\ max~
Reference: TS 102.221 [1], subclauses 5.1.4, 5.2.3 and 5.3.3.
##### 6.2.4.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 shall not be tested as the UICC supports an internal clock.
##### 6.2.4.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The frequency of the clock source shall be set to 1 MHz.
b) The duty cycle of the clock source shall be set to 40 % high.
c) V~OH~ shall be set to V~OH~ max and V~OL~ shall be set to V~OL~ min.
d) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR2, CR3]._
e) The duty cycle of the clock source shall be set to 60 % high.
f) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR2, CR3]._
g) The frequency of the clock source shall be set to f~max.~
h) The duty cycle of the clock source shall be set to 40 % high.
i) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR2, CR3]._
j) The duty cycle of the clock source shall be set to 60 % high.
k) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR2, CR3]._
l) Steps a) to j) shall be repeated with V~OH~ set to V~OH~ min and V~OL~ set
to V~OL~ max.
m) Steps a) to k) shall be repeated for all the operating conditions supported
by the UICC.
#### 6.2.4.2 Voltage and current
##### 6.2.4.2.1 Definition and applicability
See clause 3.5.3.
##### 6.2.4.2.2 Conformance requirement
* * *
CR1 The UICC shall operate within the limits for CLK specified in table 6. M
* * *
Table 6: Electrical characteristics of CLK with current limits under normal
operating conditions
* * *
Operating Conditions V~OL~ min/V V~OL~ max/V I~OL~ max/μA V~OH~ min/V V~OH~
max/V I~OH~ max/μA t~R~ & t~F~ max fmax /MHz Class A Operating Conditions -0,3
0,5 -200 0,7 × Vcc Vcc +0,3 +20 9 % with a max. of 0,5 μs 5 Class B Operating
Conditions -0,3 0,2 × Vcc -20 0,7 × Vcc Vcc +0,3 +20 50 ns 5 Class C Operating
Conditions -0,3 0,2 × Vcc -20 0,8 × Vcc Vcc +0,3 +20 50 ns 5 NOTE: t~R~ and
t~F~ have to be measured between 10 % and 90 % of V~OL~ max and V~OH~ min~;~
C~in~ is equal to 30 pF.
* * *
> Calculation of the 10% and 90% thresholds for t~R~ and t~F~ measurements:
>
> V~OL_threshold~ = (V~OH\ min~ - V~OLmax~)*10%+V~OL\ max~
>
> V~OH_threshold~ = (V~OH\ min~ - V~OLmax~)*90%+V~OL\ max~
Reference: TS 102.221 [1], subclauses 5.1.4, 5.2.3 and 5.3.3.
##### 6.2.4.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.2.4.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) A current measuring device shall be connected to CLK (contact C3) of the
UICC.
3) The capacitance of CLK (contact C3) shall be measured to be ≤ 30 pF.
**Test procedure 1**
a) The clock signal shall be set to 1 MHz.
b) The following parameters shall be set for CLK:
\- V~OH~ at V~OH~max;
\- V~OL~ at V~OL~min;
\- t~R~ and t~F~ shall be set to t~R~ max and t~F~ max.
c) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR1]._
d) The following parameters shall be set for CLK:
\- V~OH~ at V~OH~min;
\- V~OL~ at V~OL~max.
e) The ME simulator shall reset the UICC.
_The UICC shall send the correct ATR sequence [CR1]._
f) Steps a) to e) shall be repeated with f~clk~ = f~max~, t~R~ = t~R~ max and
t~F~ = t~f~ max.
g) Steps a) to f) shall be repeated for all the operating conditions supported
by the UICC.
_The following shall be true for all the operating conditions:_
_\- I~OHmax~ measured shall be less than or equal to +20 µA [CR1];_
_\- I~OLmax~ measured shall be less than or equal to --200 µA [CR1];_
_\- The UICC shall send the correct ATR sequence after a reset [CR1]._
### 6.2.5 I/O (contact C7)
#### 6.2.5.1 Voltage and current
##### 6.2.5.1.1 Definition and applicability
See clause 3.5.3.
##### 6.2.5.1.2 Conformance requirement
* * *
CR1 The UICC shall operate within the limits for I/O specified in tables 7 and
8. M CR2 When low impedance drivers are implemented on the I/O line, the I/O
electrical circuit design shall ensure that potential contention on the line
will not result in any permanent damage of the terminal or the UICC. M
* * *
Table 7: Electrical characteristics of the output of the I/O under normal
operating conditions
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Oper | V~OL~ | V~OL~ | I~OL~ | V~OH~ | V~OH~ | I~OH~ | t~R~ | fmax | | ating | min/V | max/V | m | min/V | max/V | m | max & | /MHz | | Condi | | | ax/μA | | | ax/μA | t~F~ | | | tions | | | | | | | max | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Class | -0,3 | 0,4 | - | 3,8 | Vcc | +20 | 1 μs | 5 | | A | | | 1 000 | | + | | | | | Oper | | | | | 0,3 V | | or | | | ating | | | | | | | 100 | | | Condi | | | | | | | ns | | | tions | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 1) | | | | | | | | | | | | | | | | | | | | or | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 2) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Class | -0,3 | 0,4 | - | 0,7 × | Vcc | +20 | 1 μs | 4 | | B | | | 1 000 | Vcc | + | | | | | Oper | | | | | 0,3 V | | or | | | ating | | | | | | | 100 | | | Condi | | | | | | | ns | | | tions | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 1) | | | | | | | | | | | | | | | | | | | | or | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 2) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Class | -0,3 | 0,3 | - | 0,7 × | Vcc | +20 | 1 μs | 4 | | C | | | 1 000 | Vcc | + | | | | | Oper | | | | | 0,3 V | | or | | | ating | | | | | | | 100 | | | Condi | | | | | | | ns | | | tions | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 1) | | | | | | | | | | | | | | | | | | | | or | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 2) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | NOTE | | | | | | | | | | 1: | | | | | | | | | | The | | | | | | | | | | value | | | | | | | | | | of | | | | | | | | | | 100 | | | | | | | | | | ns | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | the | | | | | | | | | | low | | | | | | | | | | impe | | | | | | | | | | dance | | | | | | | | | | b | | | | | | | | | | uffer | | | | | | | | | | is | | | | | | | | | | sel | | | | | | | | | | ected | | | | | | | | | | via a | | | | | | | | | | PPS | | | | | | | | | | proce | | | | | | | | | | dure. | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: | | | | | | | | | | The | | | | | | | | | | value | | | | | | | | | | of | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | the | | | | | | | | | | UICC | | | | | | | | | | sup | | | | | | | | | | ports | | | | | | | | | | (F, | | | | | | | | | | D) = | | | | | | | | | | (512, | | | | | | | | | | 64). | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Table 8: Electrical characteristics of the input of the I/O under normal
operating conditions
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Oper | V~IL~ | V~IL~ | I~IL~ | V~IH~ | V~IH~ | I~IH~ | t~R~ | fmax | | ating | min/V | max/V | m | min/V | max/V | mi | max & | /MHz | | Condi | | | ax/μA | | | n/max | t~F~ | | | tions | | | | | | | max | | | | | | | | | /μA | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Class | -0,3 | 0.15 | + | 0,7 × | Vcc | ±20 | 1 μs | 5 | | A | | x Vcc | 1 000 | Vcc | + | | | | | Oper | | | | | 0,3 V | | or | | | ating | | | | | | | 100 | | | Condi | | | | | | | ns | | | tions | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 1) | | | | | | | | | | | | | | | | | | | | or | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 2) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Class | -0,3 | 0,2 × | + | 0,7 × | Vcc | ±20 | 1 μs | 4 | | B | | Vcc | 1 000 | Vcc | + | | | | | Oper | | | | | 0,3 V | | or | | | ating | | | | | | | 100 | | | Condi | | | | | | | ns | | | tions | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 1) | | | | | | | | | | | | | | | | | | | | or | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 2) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Class | -0,3 | 0,2 × | + | 0,7 × | Vcc | ±20 | 1 μs | 4 | | C | | Vcc | 1 000 | Vcc | + | | | | | Oper | | | | | 0,3 V | | or | | | ating | | | | | | | 100 | | | Condi | | | | | | | ns | | | tions | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 1) | | | | | | | | | | | | | | | | | | | | or | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | (see | | | | | | | | | | note | | | | | | | | | | 2) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | NOTE | | | | | | | | | | 1: | | | | | | | | | | The | | | | | | | | | | value | | | | | | | | | | of | | | | | | | | | | 100 | | | | | | | | | | ns | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | the | | | | | | | | | | low | | | | | | | | | | impe | | | | | | | | | | dance | | | | | | | | | | b | | | | | | | | | | uffer | | | | | | | | | | is | | | | | | | | | | sel | | | | | | | | | | ected | | | | | | | | | | via a | | | | | | | | | | PPS | | | | | | | | | | proce | | | | | | | | | | dure. | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: | | | | | | | | | | The | | | | | | | | | | value | | | | | | | | | | of | | | | | | | | | | 400 | | | | | | | | | | ns | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | the | | | | | | | | | | UICC | | | | | | | | | | sup | | | | | | | | | | ports | | | | | | | | | | (F, | | | | | | | | | | D) = | | | | | | | | | | (512, | | | | | | | | | | 64) | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Reference: TS 102.221 [1], subclauses 5.1.5, 5.2.4, 5.3.4 and 6.3.2.
##### 6.2.5.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR 2 is not tested.
##### 6.2.5.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) A current measuring device shall be connected to I/O (contact C7) of the
UICC.
3) The capacitance, C~out~ and C~in~, of I/O (contact C7) shall be measured to
be 30 pF.
**Test procedure 1**
a) The ME simulator shall be set to the following maximum range allowed by the
UICC
> \- Vcc to Vcc max;
>
> \- V~OL~ to V~OL~ min and V~OH~ to V~OH~ max;
>
> \- I~IL~ to I~IL~ max and I~IH~ to I~IH~ max;
>
> \- t~R~ to t~R~ max and t~F~ to t~F~ max.
b) The ME simulator shall reset the UICC.
c) The ME simulator shall send a STATUS command to the UICC.
d) The ME simulator shall be set to the following minimum range allowed by the
UICC with V~OH~ inactive:
> \- Vcc to Vcc min;
>
> \- V~OL~ to V~OL~ max and V~OH~ to V~OH~ min;
>
> \- I~IL~ to I~IL~max and I~IH~ to I~IH~ min;
>
> \- t~R~ to t~R~ max and t~F~ to t~F~ max.
e) The ME simulator shall reset the UICC.
f) The ME simulator shall send a STATUS command to the UICC.
g) Steps a) to f) shall be repeated for all the operating conditions supported
by the UICC.
_Acceptance criteria for all the operating conditions [CR1]:_
_\- I~OL~ shall be between 0 mA and I~OL~ max;_
_\- I~OH~ shall be ≤ I~OH~ max;_
_\- V~IL~ shall be between V~IL~ min and V~IL~ max;_
_\- V~IH~ shall be between V~IH~ min and V~IH~ max;_
_\- t~R~ generated by the UICC shall be ≤ t~R~ max;_
_\- t~F~ generated by the UICC shall be ≤ t~F~ max._
**Test procedure 2**
a) The ME simulator shall be set to the following maximum range allowed by the
UICC
> \- Vcc to Vcc max;
>
> \- V~OL~ to V~OL~ min and V~OH~ to V~OH~ max;
>
> \- I~IL~ to I~IL~ max and I~IH~ to I~IH~ max;
>
> \- t~R~ to t~R~ max and t~F~ to t~F~ max.
b) The ME simulator shall reset the UICC.
c) The ME simulator shall send a PPS-Request to the UICC, selecting (F, D) =
(512, 64).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
d) The ME simulator shall send a STATUS command to the UICC.
e) The ME simulator shall be set to the following minimum range allowed by the
UICC with V~OH~ inactive:
> \- Vcc to Vcc min;
>
> \- V~OL~ to V~OL~ max and V~OH~ to V~OH~ min;
>
> \- I~IL~ to I~IL~max and I~IH~ to I~IH~ min;
>
> \- t~R~ to t~R~ max and t~F~ to t~F~ max.
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a PPS-Request to the UICC, selecting (F, D) =
(512, 64).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
h) The ME simulator shall send a STATUS command to the UICC.
i) Steps a) to h) shall be repeated for all the operating conditions supported
by the UICC.
_Acceptance criteria for all the operating conditions [CR1]:_
_\- I~OL~ shall be between 0 mA and I~OL~ max;_
_\- I~OH~ shall be ≤ I~OH~ max;_
_\- V~IL~ shall be between V~IL~ min and V~IL~ max;_
_\- V~IH~ shall be between V~IH~ min and V~IH~ max;_
_\- t~R~ generated by the UICC shall be ≤ t~R~ max;_
_\- t~F~ generated by the UICC shall be ≤ t~F~ max._
**Test procedure 3**
a) The ME simulator shall be set to the following maximum range allowed by the
UICC
> \- Vcc to Vcc max;
>
> \- V~OL~ to V~OL~ min and V~OH~ to V~OH~ max;
>
> \- I~IL~ to I~IL~ max and I~IH~ to I~IH~ max;
>
> \- t~R~ to t~R~ max and t~F~ to t~F~ max.
b) The ME simulator shall reset the UICC.
c) The ME simulator shall send a PPS-Request to the UICC, using a value of
PPS2 which selects low impedance drivers.
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
d) The ME simulator shall send a STATUS command to the UICC.
e) The ME simulator shall be set to the following minimum range allowed by the
UICC with V~OH~ inactive:
> \- Vcc to Vcc min;
>
> \- V~OL~ to V~OL~ max and V~OH~ to V~OH~ min;
>
> \- I~IL~ to I~IL~max and I~IH~ to I~IH~ min;
>
> \- t~R~ to t~R~ max and t~F~ to t~F~ max.
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a PPS-Request to the UICC, using a value of
PPS2 which selects low impedance drivers.
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
h) The ME simulator shall send a STATUS command to the UICC.
i) Steps a) to h) shall be repeated for all the operating conditions supported
by the UICC.
_Acceptance criteria for all the operating conditions [CR1]:_
_\- I~OL~ shall be between 0 mA and I~OL~ max;_
_\- I~OH~ shall be ≤ I~OH~ max;_
_\- V~IL~ shall be between V~IL~ min and V~IL~ max;_
_\- V~IH~ shall be between V~IH~ min and V~IH~ max;_
_\- t~R~ generated by the UICC shall be ≤ t~R~ max;_
_\- t~F~ generated by the UICC shall be ≤ t~F~ max._
## 6.3 Initial communication establishment procedure
### 6.3.1 Supply voltage switching
#### 6.3.1.1 Supply voltage classes
##### 6.3.1.1.1 Definition and applicability
See clause 3.5.3.
##### 6.3.1.1.2 Conformance requirement
* * *
CR1 The supply voltage class shall be indicated in the ATR. M CR2 If the UICC
supports several voltage classes, they shall be consecutive. M
* * *
Reference: TS 102.221 [1], subclause 6.2.1.
##### 6.3.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 and CR2 are tested in subclause 7.4.1.
##### 6.3.1.1.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
#### 6.3.1.2 Power consumption of the UICC during ATR
##### 6.3.1.2.1 Definition and applicability
See clause 3.5.3.
##### 6.3.1.2.2 Conformance requirement
* * *
CR1 The UICC power consumption during the ATR at the maximum external clock
CLK shall not exceed the value defined in the table 6.2a in TS 102.221 [1],
subclause 6.2.2, for each voltage class indicated in the ATR. M CR2 The UICC
power consumption during the ATR at the 4MHz CLK shall not exceed the value
defined in the table 6.2b in TS 102.221 [1], subclause 6.2.2, for each voltage
class indicated in the ATR. M CR3 The power consumption of the UICC is
restricted to the values indicated in tables 6.2a and 6.2b TS 102.221 [1]
until an application is selected. M
* * *
Reference: TS 102.221 [1], subclauses 6.2.2 and 6.2.3.
##### 6.3.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.3.1.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) PIN of the UICC shall be set to \'00000000\'.
**Test procedure 1**
NOTE: Repeat the following steps for each voltage class supported by the UICC.
a) The frequency of the clock source shall be set to 4 MHz.
b) The ME simulator shall reset the UICC.
> _The UICC shall send the ATR sequence._
c) The ME simulator shall send a CHANGE PIN command to the UICC with new PIN
value \'10101010\'.
d) The ME simulator shall send a CHANGE PIN command to the UICC to return the
PIN to its original value.
> _The current consumption of the UICC shall not exceed the maximum values
> given in table 6.2b in TS 102.221 [1], subclause 6.2.1 according to the
> voltage class during b), c) and d) [CR1]._
e) The frequency of the clock source shall be set to the maximum frequency
according to the voltage class.
f) The ME simulator shall reset the UICC.
> _The UICC shall send the ATR sequence._
g) The ME simulator shall send a CHANGE PIN command to the UICC with new PIN
value of \'10101010\'.
h) The ME simulator shall send a CHANGE PIN command to the UICC to return the
PIN to its original value.
> _The current consumption of the UICC shall not exceed the maximum values
> given in table 6.2a in TS 102.221 [1], subclause 6.2.1 according to the
> voltage class during f), g) and h) [CR2]._
#### 6.3.1.3 Application related electrical parameters
##### 6.3.1.3.1 Definition and applicability
See clause 3.5.3.
##### 6.3.1.3.2 Conformance requirement
* * *
CR1 If an application specifies its own maximum power consumption values, it
shall not exceed the maximum value defined in table 6.3 in TS 102.221 [1],
subclause 6.2.3. M CR2 If an application specifies its own maximum power
consumption values, the current consumption shall conform to the voltage class
indicated in the response for STATUS/SELECT commands, while the application is
selected. M CR3 If an application does not specify its own maximum power
consumption values, the current consumption shall conform to the values
defined in table 6.4 in TS 102.221 [1], subclause 6.2.3, while the application
is selected. M
* * *
Reference: TS 102.221 [1], subclause 6.2.3.
##### 6.3.1.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.3.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
NOTE: Following steps shall be repeated for each application in the UICC.
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) If the power consumption is present in the FCP, the following steps shall
be performed.
> _The power consumption in the FCP does not exceed maximum values defined in
> table 6.3 in TS 102.221 [1], subclause 6.2.3 [CR1]._
>
> c-1) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
>
> c-2) The ME simulator shall send a SELECT command to select EF~LOCI~.
>
> c-3) The ME simulator shall send an UPDATE BINARY command with data string
> \'11 22 33 44 55 66 77 88 99 AA BB\'.
>
> _The power consumption of the UICC shall not exceed the maximum values given
> in the response data at b) during c‑1), c‑2) and c‑3) [CR2]._
d) If the power consumption is not present in the FCP, following steps shall
be performed.
> d-1) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
>
> d-2) The ME simulator shall send a SELECT command to select EF~LOCI~.
>
> d-3) The ME simulator shall send an UPDATE BINARY command with data string
> \'11 22 33 44 55 66 77 88 99 AA BB\'.
>
> _The power consumption of the UICC shall not exceed the maximum values
> defined in table 6.4 in TS 102.221 [1], subclause 6.2.3 during d‑1), d‑2)
> and d‑3) [CR3]._
e) The ME simulator shall send an UPDATE BINARY command with data string \'A1
A2 A3 A4 A5 A6 A7 A8 A9 00 00\'.
### 6.3.2 ATR content
#### 6.3.2.1 Major capabilities
##### 6.3.2.1.1 Definition and applicability
See clause 3.5.3.
##### 6.3.2.1.2 Conformance requirement
* * *
CR1 The ATR shall be in accordance with ISO/IEC 7816‑3 [6]. M CR2 T = 15
parameters shall be present in the ATR. M CR3 The category indicator in the
historical bytes shall be \'80\'. M CR4 The first information sent by the card
in the historical byte shall be the \"card service data\" data object. M CR5
The second information sent by the card in the historical shall be the \"card
capabilities\" data object. M CR6 The information carried by the historical
bytes of the UICC shall follow clause 8 of ISO/IEC 7816‑4 [7]. M
* * *
Reference: TS 102.221 [1], subclause 6.3
##### 6.3.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The testing of CR1 is outside the scope of the present document.
##### 6.3.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> _The UICC shall send the valid ATR sequence._
>
> _The ATR shall be in accordance with ISO/IEC 7816‑3 [6]._
>
> _The following parameters shall be present:_
>
> _\- T = 15 parameter [CR2]._
>
> _The following parameters shall be present and in the following order in the
> historical bytes:_
>
> _\- The category indicator = \'80\' [CR3];_
>
> _\- \"card service data\" data object [CR4];_
>
> _\- \"card capabilities\" data object [CR5]._
>
> _The historical bytes shall follow clause 8 of ISO/IEC 7816‑4 [7][CR6]._
#### 6.3.2.2 Speed enhancement
##### 6.3.2.2.1 Definition and applicability
See clause 3.5.3.
##### 6.3.2.2.2 Conformance requirement
* * *
CR1 The UICC shall at least support (F, D) = (512, 8) and (512, 16) in
addition to (372, 1). M CR2 (F, D) = (372, 1) shall be the default value. M
* * *
Reference: TS 102.221 [1], subclause 6.3.2.
##### 6.3.2.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.3.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test Procedure 1**
a) The ME simulator shall cold reset the UICC.
b) The ME simulator shall send a PPS-Request to the UICC, selecting T = 0
protocol and (F, D) = (512, 8).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
c) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(512, 8).
> _The UICC shall send a valid FCP [CR1]._
d) The ME simulator shall cold reset the UICC.
e) The ME simulator shall send a PPS-Request to the UICC, selecting T = 0
protocol and (F, D) = (512, 16).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
f) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(512, 16).
> _The UICC shall send a valid FCP [CR1]._
g) The ME simulator shall cold reset the UICC.
h) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(372, 1).
> _The UICC shall send a valid FCP [CR2]._
i) The ME simulator shall cold reset the UICC.
j) The ME simulator shall send a PPS-Request to the UICC, selecting T = 0
protocol and (F, D) = (372, 1).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
k) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(372, 1).
> _The UICC shall send a valid FCP [CR1]._
#### 6.3.2.3 Global Interface bytes
##### 6.3.2.3.1 Definition and applicability
See clause 3.5.3.
##### 6.3.2.3.2 Conformance requirement
* * *
CR1 The content and coding of the first TAi (i > 2) after T=15 is defined in
ISO/IEC 7816-3 [6] Rel-6 - ... CR2 The content and coding of the first TBi (i
> 2) after T=15 shall be as indicated in Table 6.7 of TS 102 221 [1], as
reproduced in table 8a. Rel-6 - ...
* * *
Table 8a: Coding of the first TBi (i > 2) after T=15 of the ATR
* * *
b8 b7 b6 b5 b4 b3 b2 b1 Meaning 0 0 0 0 0 0 0 0 No additional global interface
parameters supported 1 - - 1 - - - - Low Impedance drivers and protocol
available on the I/O line available (see clause 7.2.1) NOTE: Any other value
is RFU.
* * *
Reference: TS 102 221 [1], subclause 6.3.3.
##### 6.3.2.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The testing of CR1 is outside the scope of the present document.
##### 6.3.2.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test Procedure 1**
a) The ME simulator shall cold reset the UICC.
_The following shall be true of the returned ATR:_
> \- If the first TBi (i > 2) is present after T=15, then its value shall be
> either \'00\' or \'90\' [CR2].
### 6.3.3 PPS procedure
#### 6.3.3.1 Definition and applicability
See clause 3.5.3.
#### 6.3.3.2 Conformance requirement
* * *
CR1 The UICC shall support the PPS procedure in order to use transmission
parameters other than the default values. M CR2 The UICC shall respond to a
PPS-Request from the terminal with a PPS-Response. M CR3 If the transmission
parameters are indicated in the ATR, these shall be interpreted in accordance
with ISO/IEC 7816‑3 [6]. M
* * *
Reference: TS 102.221 [1], subclause 6.4.
#### 6.3.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR3 is not tested as it is out of the scope of the present document.
#### 6.3.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test Procedure 1**
a) The ME simulator shall cold reset the UICC.
b) Steps c) to d) shall only be carried out if the ATR contains the first TBi
(i > 2) after T=15.
c) The ME simulator shall send a PPS-Request to the UICC, containing a value
of PPS2 equal to \'00\'.
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters [CR1, CR2]._
d) The ME simulator shall send a STATUS command with P2 = \'00\'.
> _The UICC shall send a status word indicating successful command execution._
e) The ME simulator shall cold reset the UICC.
f) Steps g) to h) shall only be carried out if the ATR contains the first TBi
(i > 2) after T=15 with a value of \'90\'.
g) The ME simulator shall send a PPS-Request to the UICC, containing a value
of PPS2 equal to \'90\'.
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters [CR1, CR2]._
h) The ME simulator shall send a STATUS command with P2 = \'00\'.
> _The UICC shall send a status word indicating successful command execution._
### 6.3.4 Reset procedures
#### 6.3.4.1 Definition and applicability
See clause 3.5.3.
#### 6.3.4.2 Conformance requirement
* * *
CR1 After a cold reset, the UICC shall enter the negotiable mode. M CR2 After
a cold reset, the security status shall be reset. M CR3 After a warm reset,
the UICC shall enter either the negotiable mode (Type 1 UICC) or the specific
mode (Type 2 UICC). M CR4 If the UICC enters the specific mode, it shall
present the same protocol and interface parameters (Fi, Di) as in the specific
session prior to the warm reset. (R99) Rel-6 - ...: O_TYPE_2 CR5 The UICC
shall respond with an identical ATR after every warm reset issued within the
same session regardless of what application was active. (R99) Rel-6 - ... CR6
After a warm reset, the security status shall be reset. M CR7 A type 1 UICC
shall always enter the negotiable mode after a warm reset. (R99) Rel-6 - ...:
O_TYPE_1 CR8 A type 2 UICC shall always enter the specific mode after a warm
reset. (R99) Rel-6 - ...: O_TYPE_2
* * *
Reference: TS 102.221 [1], subclause 6.5.
#### 6.3.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 6.3.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test Procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
c) The ME simulator shall cold reset the UICC.
> _The UICC shall send the valid ATR sequence. The specific mode byte TA(2)
> shall not be present within the ATR returned by the UICC [CR1]._
d) The ME simulator shall send a SELECT command to the UICC to select EF~PL.~
e) The ME simulator shall send an UPDATE BINARY command using a length of 2
bytes, and data string \'00 00\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - Security status not satisfied [CR2]._
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall warm reset the UICC.
> _The UICC shall send the valid ATR sequence [CR3]._
h) The ME simulator shall send a SELECT command to the UICC to select EF~PL~.
i) The ME simulator shall send an UPDATE BINARY command using a length of 2
bytes, and data string \'00 00\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - Security status not satisfied [CR6]._
**Test Procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall warm reset the UICC.
c) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
d) The ME simulator shall warm reset the UICC.
_The UICC shall respond with an identical ATR to that returned in response to
step b) [CR5]._
**Test Procedure 3**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall warm reset the UICC.
> _The UICC shall send the valid ATR sequence. The specific mode byte TA(2)
> shall not be present within the ATR returned by the UICC [CR7]._
c) The ME simulator shall cold reset the UICC.
_d) The ME simulator shall warm reset the UICC._
> _The UICC shall send the valid ATR sequence. The specific mode byte TA(2)
> shall not be present within the ATR returned by the UICC [CR7]._
**Test Procedure 4**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall warm reset the UICC.
> _The UICC shall send the valid ATR sequence_
>
> _The specific mode byte TA(2) shall be present within the ATR returned by
> the UICC [CR8]._
c) The ME simulator shall cold reset the UICC.
d) The ME simulator shall send a PPS-Request to the UICC, selecting T=0
protocol and (F, D) = (512, 8)
_The UICC shall send a valid PPS-Response indicating support for the requested
parameters._
e) The ME simulator shall warm reset the UICC.
> _The UICC shall send the valid ATR sequence._
>
> _The specific mode byte TA(2) shall be present within the ATR returned by
> the UICC [CR8]._
>
> _The Global Interface Character TA1 shall indicate (F, D) values of (512, 8)
> [CR4]._
### 6.3.5 Clock stop mode
#### 6.3.5.1 Definition and applicability
See clause 3.5.3.
#### 6.3.5.2 Conformance requirement
* * *
CR1 The UICC shall support the clock stop procedure. M
* * *
Reference: TS 102.221 [1], subclause 6.6.
#### 6.3.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 6.3.5.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> _The ATR shall contain a following character:_
>
> _\- TA(i) after the first occurrence of T = 15 in TD(i-1) for i >2;_
>
> _\- Both b8 and b7 shall not be equal to zero [CR1]._
b) The ME simulator shall stop the clock according to the clock stop mode
after the ATR.
c) The ME simulator shall pause for 10 seconds, then starts the clock again.
d) The ME simulator shall wait for more than 744 clock cycles after having
started the clock, and then shall send a SELECT command to the UICC to select
the EF~ICCID~.
> _The SELECT command shall be executed successfully [CR1]._
### 6.3.6 Bit/character duration and sampling time
#### 6.3.6.1 Definition and applicability
See clause 3.5.3.
#### 6.3.6.2 Conformance requirement
* * *
CR1 The bit/character duration and sampling time specified in ISO/IEC 7816‑3
[6], subclause 6.3.2 are valid for all communications. M
* * *
Reference: TS 102.221 [1], subclause 6.7.
#### 6.3.6.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The testing of CR1 is outside the scope of the present document.
#### 6.3.6.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
### 6.3.7 Error handling
#### 6.3.7.1 Definition and applicability
See clause 3.5.3.
#### 6.3.7.2 Conformance requirement
* * *
CR1 Error detection and character repetition specified in ISO/IEC 7816‑3 [6],
subclause 6.3.3 is mandatory for the UICC for all communications using T = 0.
M
* * *
Reference: TS 102.221 [1], subclause 6.8.
#### 6.3.7.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 6.3.7.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
NOTE: The following steps shall be performed for each communication speed
supported by the UICC for T = 0.
a) The ME simulator shall cold reset the UICC.
b) The ME simulator shall request character repetition (i.e. transmits an
error signal during the guard time) to the UICC for all character frames
during the ATR.
> _The UICC shall send the valid ATR with character repetition [CR1]._
c) The ME simulator shall send a correct PPS request to the UICC
(conditional).
d) The ME simulator shall send a SELECT command to the UICC to select the MF
with incorrect character parity for all character frames.
> _The UICC shall request character repetition (i.e. transmits an error signal
> during the guard time) for all character frames [CR1]._
e) The ME simulator shall receive the response from the UICC but request
character repetition for all character frames.
> _The UICC shall send the valid FCP with character repetition [CR1]._
### 6.3.8 Compatibility
#### 6.3.8.1 Definition and applicability
See clause 3.5.3.
#### 6.3.8.2 Conformance requirement
* * *
CR1 UICCs that are used in applications where the supply voltage class
detection is based on the STATUS response shall support this procedure in
addition to the supply voltage class indication in the ATR. M
* * *
Reference: TS 102.221 [1], subclause 6.9.
#### 6.3.8.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: The supply voltage class indication in the ATR and STATUS response are
tested respectively in subclause 6.3.1 and subclause 6.8.1.2 in the present
document as they are mandatory for all the UICCs except the UICCs supporting
class A operating condition only.
NOTE 2: The supply voltage class detection based on STATUS response for
compatibility purpose is out of the scope of the present document.
#### 6.3.8.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
## 6.4 Transmission Protocols
### 6.4.1 Physical Layer
#### 6.4.1.1 Definition and applicability
See clause 3.5.3.
#### 6.4.1.2 Conformance requirement
* * *
CR1 Both protocols T = 0 and T = 1 shall use the physical layer and character
frame as defined in subclause 7.2.1. M
* * *
Reference: TS 102.221 [1], subclause 7.1.
#### 6.4.1.3 Test purpose
To verify that the physical layer function conforms to the above requirements.
NOTE: CR1 is tested in the subclause 6.4.2.1
#### 6.4.1.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
### 6.4.2 Data Link Layer
#### 6.4.2.1 Character Frame
##### 6.4.2.1.1 Definition and applicability
See clause 3.5.3.
##### 6.4.2.1.2 Conformance requirement
+------+------------------------------+------------------------------+ | CR1 | Before the transmission of a | M | | | character, the I/O line | | | | shall be in state H. | | +------+------------------------------+------------------------------+ | CR2 | A character shall consist of | M | | | 10 consecutive bits: | | | | | | | | - 1 start bit in state L; | | | | | | | | - 8 bits, which comprise | | | | the data byte; | | | | | | | | - 1 even parity checking | | | | bit. | | +------+------------------------------+------------------------------+ | CR3 | The parity bit shall be set, | M | | | in a way, that there is an | | | | even number of bits set to | | | | \'1\' including the parity | | | | bit in the character frame. | | +------+------------------------------+------------------------------+ | CR4 | The receiver shall confirm | M | | | the existence of a start bit | | | | before 0.7 etu (receiver | | | | time). | | +------+------------------------------+------------------------------+ | CR5 | Then the subsequent bits | M | | | shall be received at | | | | intervals of | | | | (n + 0.5 ± 0.2) etu (n being | | | | the rank of the bit). | | +------+------------------------------+------------------------------+ | CR6 | Within a character, the time | M | | | from the leading edge of the | | | | start bit to the trailing | | | | edge of the nth bit shall be | | | | (n ± 0.2) etu. | | +------+------------------------------+------------------------------+ | CR7 | The interval between the | M | | | leading edges of the start | | | | bits of two consecutive | | | | characters shall comprise | | | | the character duration | | | | (10 ± 0.2) etu, plus a | | | | guardtime. | | +------+------------------------------+------------------------------+ | CR8 | Under error free | M | | | transmission, during the | | | | guardtime both the UICC and | | | | the ME shall be in reception | | | | mode (I/O line in state H). | | +------+------------------------------+------------------------------+ | CR9 | The data shall always be | M | | | passed over the I/O line | | | | with the most significant | | | | byte first. | | +------+------------------------------+------------------------------+ | CR10 | The order of bits within a | M | | | byte (that is, whether the | | | | least significant or most | | | | significant bit is | | | | transferred first) shall be | | | | specified in character TS | | | | returned in the answer to | | | | reset. | | +------+------------------------------+------------------------------+ | CR11 | If the low impedance driver | Rel-6 - ...: | | | on the I/O line has been | O_LOW_IMPEDANCE | | | selected, then during the | | | | transmission state the | | | | transmitter shall drive the | | | | I/O line to the desired | | | | level using the low | | | | impedance driver, with the | | | | exception of the error | | | | indication period. | | +------+------------------------------+------------------------------+ | CR12 | If the low impedance driver | Rel-6 - ...: | | | on the I/O line has been | O_LOW_IMPEDANCE | | | selected, then when the | | | | communication direction is | | | | changed, the entity that is | | | | in turn to transmit, | | | | terminal or UICC, shall | | | | drive the I/O line to the | | | | high level using the low | | | | impedance driver during the | | | | interface inactivity period. | | +------+------------------------------+------------------------------+
Reference: TS 102.221 [1], subclause 7.2.1.
##### 6.4.2.1.3 Test purpose
To verify that the Physical Layer function conforms to the above requirements.
> NOTE 1: CR11 is not tested, with the exception of the requirement to not
> drive the I/O line during the error indication period, which is tested in
> clause 6.4.2.2.
>
> NOTE 2: CR12 is not tested.
##### 6.4.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
a) The following steps b) to h) shall be repeated for the all communication
speeds and protocols supported by the UICC, and both with and without
selecting low impedance drivers if the UICC supports low impedance drivers.
b) The ME simulator shall cold reset the UICC.
> _The UICC shall send a valid ATR [CR5]._
c) The ME simulator shall send a PPS-Request to select a valid protocol, a
valid communication speed and low impedance drivers (if relevant) to the UICC.
> _The UICC shall send a valid PPS-Response [CR5]._
d) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR5]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
f) The ME simulator shall send a SELECT command to the UICC to select
EF~FPLMN~.
g) The ME simulator shall send an UPDATE BINARY to update EF~FPLMN~ with data
string \'55 AA 0F 00 F0 FF 00 F0 FF 00 F0 FF\'
> _The following conditions shall be true for all character frames_ :
>
> _\- Before the transmission of a character, the I/O line shall be in state H
> [CR1];_
>
> _\- It consists of 10 consecutive bits [CR2];_
>
> _\- There is an even number of bits set to \'1\' including the parity bit
> [CR3];_
>
> _\- The existence of the start bit shall be confirmed to be at least 0.7 etu
> [CR4];_
>
> _\- The subsequent bits shall be received at intervals of (n + 0.5 ± 0.2)
> etu (n being the rank of the bit) [CR5];_
>
> _\- The time from the leading edge of the start bit to the trailing edge of
> the Nth bit shall be (N ± 0.2) etu [CR6];_
>
> _\- The interval between the leading edges of the start bits of two
> consecutive characters shall comprise the character duration (10 ± 0.2) etu,
> plus a guardtime [CR7];_
>
> _\- The data shall always be passed over the I/O line with the most
> significant byte first [CR8];_
>
> _\- The order of bits within a byte shall be specified in character TS
> returned in the ATR [CR10]._
h) The ME simulator shall send a READ BINARY to the UICC.
_The data string returned by the UICC shall be \'55 AA 0F 00 F0 FF 00 F0 FF 00
F0 FF\'._
_The following conditions shall be true for all character frames:_
> _\- Before the transmission of a character, the I/O line shall be in state H
> [CR1];_
>
> _\- It consists of 10 consecutive bits [CR2];_
>
> _\- There is an even number of bits set to \'1\' including the parity bit
> [CR3];_
>
> _\- The existence of the start bit shall be confirmed to be at least 0.7 etu
> [CR4];_
>
> _\- The subsequent bits shall be received at intervals of (n + 0.5 ± 0.2)
> etu (n being the rank of the bit) [CR5];_
>
> _\- The time from the leading edge of the start bit to the trailing edge of
> the Nth bit shall be (N ± 0.2) etu [CR6];_
>
> _\- The interval between the leading edges of the start bits of two
> consecutive characters shall comprise the character duration (10 ± 0.2) etu,
> plus a guardtime [CR7];_
>
> _\- The data shall always be passed over the I/O line with the most
> significant byte first [CR8];_
>
> _\- The response data sent from the UICC shall be passed over the I/O line
> with the most significant byte first [CR9];_
>
> _\- The order of bits within a byte shall be specified in character TS
> returned in the ATR [CR10]._
i) The time from the leading edge of the start bit to the trailing edge of the
nth bit shall be set to be (n + 0.2) etu.
j) The ME simulator shall cold reset the UICC.
> _The UICC shall send a valid ATR [CR5]._
k) The ME simulator shall send a PPS-Request to select a valid protocol, a
valid communication speed and low impedance drivers (if relevant) to the UICC.
> _The UICC shall send a valid PPS-Response [CR5]._
l) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR5]._
m) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
n) The ME simulator shall send a SELECT command to the UICC to select
EF~FPLMN~.
o) The ME simulator shall send a READ BINARY to the UICC.
_The data string returned by the UICC shall be \'55 AA 0F 00 F0 FF 00 F0 FF 00
F0 FF\';_
_The following conditions shall be true for all character frames:_
> _\- Before the transmission of a character, the I/O line shall be in state H
> [CR1];_
>
> _\- It consists of 10 consecutive bits [CR2];_
>
> _\- There is an even number of bits set to \'1\' including the parity bit
> [CR3];_
>
> _\- The existence of the start bit shall be confirmed to be at least 0.7 etu
> [CR4];_
>
> _\- The subsequent bits shall be received at intervals of (n + 0.5 ± 0.2)
> etu (n being the rank of the bit) [CR5];_
>
> _\- The time from the leading edge of the start bit to the trailing edge of
> the Nth bit shall be (N ± 0.2) etu [CR6];_
>
> _\- The interval between the leading edges of the start bits of two
> consecutive characters shall comprise the character duration (10 ± 0.2) etu,
> plus a guardtime [CR7];_
>
> _\- The data shall always be passed over the I/O line with the most
> significant byte first [CR8];_
>
> _\- The response data sent from the UICC shall be passed over the I/O line
> with the most significant byte first [CR9];_
>
> _\- The order of bits within a byte shall be specified in character TS
> returned in the ATR [CR10]._
p) The time from the leading edge of the start bit to the trailing edge of the
nth bit shall be set to be (n - 0.2) etu.
q) The ME simulator shall cold reset the UICC.
> _The UICC shall send a valid ATR [CR2, CR5]._
r) The ME simulator shall send a PPS-Request to select a valid protocol, a
valid communication speed and low impedance drivers (if relevant) to the UICC.
> _The UICC shall send a valid PPS-Response [CR4, CR5]._
s) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' --normal ending of the command [CR4, CR5]._
t) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
u) The ME simulator shall send a SELECT command to the UICC to select
EF~FPLMN~.
v) The ME simulator shall send a READ BINARY to the UICC.
_The data string returned by the UICC shall be \'55 AA 0F 00 F0 FF 00 F0 FF 00
F0 FF\'._
_The following conditions shall be true for all character frames:_
_\- Before the transmission of a character, the I/O line shall be in state H
[CR1];_
> _\- It consists of 10 consecutive bits [CR2];_
>
> _\- There is an even number of bits set to \'1\' including the parity bit
> [CR3];_
>
> _\- The existence of the start bit shall be confirmed to be at least 0.7 etu
> [CR4];_
>
> _\- The subsequent bits shall be received at intervals of (n + 0.5 ± 0.2)
> etu (n being the rank of the bit) [CR5];_
>
> _\- The time from the leading edge of the start bit to the trailing edge of
> the Nth bit shall be (N ± 0.2) etu [CR6];_
>
> _\- The interval between the leading edges of the start bits of two
> consecutive characters shall comprise the character duration (10 ± 0.2) etu,
> plus a guardtime [CR7];_
>
> _\- The data shall always be passed over the I/O line with the most
> significant byte first [CR8];_
>
> _\- The response data sent from the UICC shall be passed over the I/O line
> with the most significant byte first [CR];_
>
> _\- The order of bits within a byte shall be specified in character TS
> returned in the ATR [CR10]._
#### 6.4.2.2 Transmission Protocol T = 0
##### 6.4.2.2.1 Definition and applicability
See clause 3.5.3.
##### 6.4.2.2.2 Conformance requirement
* * *
CR1 The UICC shall support either T=0 or T=1 or both protocols. O_T0 CR2 The
protocol shall start after either the answer to reset or a successful PPS
exchange. O_T0 CR3 The minimum interval between the leading edge of the start
bits of two consecutive characters shall be at least 12 etus. O_T0 CR4 The
value of the WWT shall not exceed 960 × WI × Fi/f. O_T0 CR5 Void. O_T0 CR6
When the UICC has received the command header, a response containing a
procedure byte or a status byte shall be sent to the terminal. O_T0 CR7 Both
the terminal and the UICC shall be able to keep track of the direction of the
data flow and who has the access to the I/O-line. O_T0 CR8 Procedure bytes
shall be used to keep up the communication between the terminal and the UICC.
O_T0 CR9 The status bytes SW1 SW2 form an end sequence indicating the status
of the UICC at the end of a command. O_T0 CR10 A normal ending of a command
shall be indicated by SW1 SW2 = \'90 00\'. O_T0 CR11 The error detection and
correction procedure shall be mandatory for T=0 protocol. O_T0 CR12 An error,
from the receivers point of view, is defined by an incorrect parity and is
indicated on the I/O line, which is set to state L after (10.5 ± 0.2) etus
after the leading edge of the start bit for the character, and the I/O line
shall be in state L for a maximum of 2 etus and a minimum of 1 etu. O_T0 CR13
The transmitter shall check the I/O line for parity error indication at (11 ±
0.2) etus starting from the leading edge of the start bit, in the character
being transmitted. O_T0 CR14 If the UICC or terminal as receiver detects a
parity error in a character just received, it shall set the I/O line to state
L at (10.5 ± 0.2) etus after the leading edge of the start bit for the
character for a maximum of 2 etus to indicate the error to the sender. O_T0
CR15 If the transmitter detects an error indication at (11 ± 0.2) etus from
the leading edge of the start bit, in the character being transmitted, the
character shall be sent again after a minimum delay of 2 etus. O_T0 CR16 If
the low impedance driver on the I/O line has been selected, then during the
transmission state the transmitter shall not drive the I/O line during the
error indication period. Rel-6 - ...: O_T0, O_LOW_IMPEDANCE
* * *
Reference: TS 102.221 [1], clause 7 and more specifically subclause 7.2.1.1,
7.2.2.1, 7.2.2.3 and 7.2.2.4.
##### 6.4.2.2.3 Test purpose
To verify that the Physical Layer function conforms to the above requirements.
NOTE : CR6 to CR10 are tested in the subclause 6.8.
##### 6.4.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~FPLMN~ shall contain the data string: \'55 AA 0F 00 F0 FF 00 F0 FF 00 F0
FF\'.
    **Test procedure 1**
a) Steps b) to g) shall be repeated for the all communication speeds supported
by the UICC.
b) The ME simulator shall cold reset the UICC.
c) The ME simulator shall send a PPS-Request to the UICC to select the T = 0
protocol and the selected communication speed.
> _The UICC shall send a valid PPS-Response indicating support for the T=0
> protocol and the selected communication speed [CR1]._
d) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
e) The ME simulator shall send a VERIFY PIN with PIN to the UICC.
f) The ME simulator shall send a SELECT command to the UICC to select
EF~FPLMN~.
g) The ME simulator shall send a READ BINARY command to the UICC.
> _The UICC shall send the data string \'55 AA 0F 00 F0 FF 00 F0 FF 00 F0 FF\'
> followed by SW1 = \'90\' and SW2 = \'00\' -- normal ending of the command
> [CR2]._
>
> _The following shall be true of the response data:_
>
> _\- The interval between the leading edge of the start bits of two
> consecutive characters shall be at least 12 etus [CR3];_
>
> _\- The value of the WWT shall not exceed 960 × WI × Fi/f [CR4];_
>
> h) The ME simulator shall cold reset the UICC.
i) The ME simulator shall request character repetition (i.e. transmits an
error signal during the guard time) to the UICC for all character frames
during the ATR.
> _The UICC shall send the valid ATR with character repetition [CR11]._
j) The ME simulator shall send a PPS-Request to the UICC to select the T = 0
protocol, the selected communication speed and low impedance drivers (if
relevant).
k) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
l) The ME simulator shall send a VERIFY PIN with PIN to the UICC.
m) The ME simulator shall send a SELECT command to the UICC to select
EF~FPLMN~.
n) The ME simulator shall send a READ BINARY command to the UICC with
incorrect character parity for all character frames.
> _The UICC shall request character repetition for all character frames,
> indicating the error to the sender by setting the I/O line to state L at
> (10,5 +- 0,2) etu after the leading edge of the start bit of each character
> with a parity error for a maximum of 2 etu and a minimum of 1 etu. [CR 11,
> CR 12, CR14]_
o) The ME simulator shall re-send a READ BINARY command to the UICC.
p) The ME simulator shall request character repetition for all character
frames from the UICC.
> _The UICC shall send the data string \'55 AA 0F 00 F0 FF 00 F0 FF 00 F0 FF\'
> followed by SW1 = \'90\' and SW2 = \'00\' -- normal ending of the command
> [CR11]._
>
> _The following shall be true of the response data:_
>
> _The UICC shall check the I/O line for a parity error indication at (11 ±
> 0,2) etu starting from the leading edge of the start bit of the character
> being transmitted and the character shall be sent again after a minimum
> delay of 2 etu. [CR13, CR15, CR16]_
#### 6.4.2.3 Transmission Protocol T = 1
##### 6.4.2.3.1 Timing and specific options for blocks sent with T = 1
This subclause defines conformance tests regarding timing, information field
sizes and error detection parameters for blocks sent with T = 1.
The tests defined in this subclause only apply where the UICC under test
supports the T = 1 protocol. If the UICC under test does not support the T = 1
protocol, then these tests do not apply.
The tests in this subclause assume that the T = 1 protocol is the first
indicated protocol for the UICC. If the UICC under test supports T = 1 but it
is not the first indicated protocol, then each test must be extended to
configure the UICC to employ the T = 1 protocol, e.g. via the PPS mechanism.
###### 6.4.2.3.1.1 Information field size
###### # 6.4.2.3.1.1.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.1.1.2 Conformance requirement
* * *
CR1 IFSC shall be the maximum length of information field of blocks that can
be received by the UICC. O_T1 CR2 The default value of the IFSC shall be 32
bytes and another value may be indicated in TA3 of the ATR. O_T1 CR3 IFSD
shall be the maximum length of information field of blocks that the terminal
can receive. O_T1 CR4 IFSD shall have a default value of 32 bytes and may be
adjusted during the card session. O_T1 CR5 The maximum value of the IFSD shall
be 254 bytes. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.1.1
###### # 6.4.2.3.1.1.3 Test purpose
To verify that an I-block from the UICC has an INF field of length ≤ IFSD.
NOTE: CR1 and CR2 shall not be tested as it depends on the capability of the
UICC.
###### # 6.4.2.3.1.1.4 Method of test
NOTE: When EF~SMS~ is not supported by the UICC, any supported linear EF with
record length more than or equal to 31 bytes may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
d) The ME simulator shall send a VERIFY command with PIN to the UICC.
e) The ME simulator shall send a READ RECORD command to read record 1 from
EF~SMS~.
> _The UICC shall return the contents of record 1 in a series of chained
> I-blocks , whose INF fields are ≤ IFSD, i.e. less than or equal to 32 bytes
> in length [CR3, CR4]._
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send an IFS REQUEST to the UICC, requesting an
adjustment of IFSD to 255 bytes.
> _The UICC shall reject the request and respond with an R-block with bits
> b1-b4 in the PCB-byte having a value of \'2\' -- other errors [CR5]._
h) The ME simulator shall reset the UICC.
i) The ME simulator shall send an IFS REQUEST to the UICC, requesting an
adjustment of IFSD to 254 bytes.
j) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
k) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
l) The ME simulator shall send a VERIFY command with PIN to the UICC.
m) The ME simulator shall send a READ RECORD command to read record 1 from
EF~SMS~.
> _The UICC returns the contents of record 1 in a single I-block or multiple
> I-blocks [CR5]._
###### 6.4.2.3.1.2 Character waiting integer
###### # 6.4.2.3.1.2.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.1.2.2 Conformance requirement
* * *
CR1 CWI is used to calculate CWT and shall be in the range from 0 to 5. The
value shall be set in bits b4 to b1 in TB3. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.1.2.
###### # 6.4.2.3.1.2.3 Test purpose
To verify that, if TB3 is present in the ATR, then the CWI, as coded in TB3,
is in the range from 0 to 5.
###### # 6.4.2.3.1.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
_The UICC shall respond with an ATR. If TB3 is present, bits b1-b4 shall be in
the range 0 to 5 [CR1]._
###### 6.4.2.3.1.3 Character waiting time
###### # 6.4.2.3.1.3.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.1.3.2 Conformance requirement
* * *
CR1 CWT is defined as the maximum delay between the leading edges of two
consecutive characters in the block. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.1.3.
###### # 6.4.2.3.1.3.3 Test purpose
To verify that the maximum delay between two consecutive characters in a block
sent by the UICC is CWT.
###### # 6.4.2.3.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
> _The ME simulator shall measure the delay between the leading edges of each
> pair of consecutive characters sent by the UICC in its I-block response to
> the SELECT command. The maximum delay between the leading edges of each pair
> of consecutive characters shall be \  _The ME simulator shall measure the delay between the leading edge of the
> last character in the I-block SELECT command received by the UICC and the
> leading edge of the first character in its I-block response to the SELECT
> command. The measured delay shall be in the range: BGT \  [CR1]._
>
> c) The ME simulator shall send a SELECT command to the UICC to select and
> terminate the USIM application at 22 etu after the UICC send the last
> character in b).
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
###### 6.4.2.3.1.5 Waiting time extension
###### # 6.4.2.3.1.5.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.1.5.2 Conformance requirement
* * *
CR1 WTX shall be used to ask for more time to process a command. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.1.6.
###### # 6.4.2.3.1.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 shall not be tested as it is not possible to force the UICC to issue
a WTX request.
###### # 6.4.2.3.1.5.4 Method of test
**Initial conditions**
N/A
**Test Procedure**
N/A
###### 6.4.2.3.1.6 Error detection code
###### # 6.4.2.3.1.6.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.1.6.2 Conformance requirement
* * *
CR1 LRC shall be used (b1 = 0). All other bits in TCi are RFU and shall be set
to 0. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.1.7.
###### # 6.4.2.3.1.6.3 Test purpose
To verify that TCi, if present, is equal to 0.
###### # 6.4.2.3.1.6.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> _The UICC shall respond with an ATR. All interface characters TCi which are
> present shall have a value of 0 [CR1]._
##### 6.4.2.3.2 Block frame structure
This subclause defines conformance tests regarding the T = 1 block structure.
###### 6.4.2.3.2.1 Prologue field
###### # 6.4.2.3.2.1.1 Node address byte
###### # 6.4.2.3.2.1.1.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.2.1.1.2 Conformance requirement
* * *
CR1 Only the default value SAD = DAD = 0 shall be supported. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.2.1.1.
###### # 6.4.2.3.2.1.1.3 Test purpose
To verify that only SAD = DAD = 0 is used.
###### # 6.4.2.3.2.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
>
> c) The ME simulator shall send a SELECT command to the UICC to select
> EF~ECC~, where the SAD and DAD are set, as default, to 0.
>
> _The UICC shall respond with an I-block where the SAD and the DAD are both
> set to 0 [CR1]._
>
> d) The ME simulator shall send a SELECT command to the UICC to select
> EF~ECC~, where the SAD = 1and DAD = 0.
>
> _The UICC shall either return an R-block with N(R) equal to the next
> expected sequence number (ignoring the erroneous I-block), or not return any
> response [CR1]._
>
> e) The ME simulator shall send a SELECT command to the UICC to select
> EF~ECC~, where the SAD = 0 and DAD = 1.
>
> _The UICC shall either return an R-block with N(R) equal to the next
> expected sequence number (ignoring the erroneous I-block), or not return any
> response [CR1]._
>
> f) The ME simulator shall send a SELECT command to the UICC to select
> EF~ECC~, where the SAD = 1 and DAD = 1.
>
> _The UICC shall either return an R-block with N(R) equal to the next
> expected sequence number (ignoring the erroneous I-block), or not return any
> response [CR1]._
###### # 6.4.2.3.2.1.2 Protocol Control Byte
###### # 6.4.2.3.2.1.2.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.2.1.2.2 Conformance requirement
+-----+------------------------------------------------------+-------+ | CR1 | All information needed to control the transmission | O_T1 | | | shall be transferred in the protocol control byte | | | | PCB. | | +-----+------------------------------------------------------+-------+ | CR2 | The coding of the PCB byte shall specify the type of | O_T1 | | | block. | | +-----+------------------------------------------------------+-------+ | CR3 | In the T = 1 protocol, the following three different | O_T1 | | | types of blocks shall be supported: | | | | | | | | - Information block, I-block which is used to | | | | transfer command and response APDUs; | | | | | | | | - Receive-ready block, R-block, which is used to | | | | transfer acknowledgements; | | | | | | | | - Supervisory block, S-block, which is used to send | | | | control information. | | +-----+------------------------------------------------------+-------+ | CR4 | The coding of the PCB byte for each block shall | O_T1 | | | conform to the tables 7.5 - 7.9 in TS 102.221 [1]. | | +-----+------------------------------------------------------+-------+
Reference: TS 102.221 [1], subclause 7.2.3.2.1.2.
###### # 6.4.2.3.2.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 to CR4 are tested in subclauses 6.4.2.3.3, 6.4.2.3.4 and 6.4.2.3.5.
###### # 6.4.2.3.2.1.2.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
###### # 6.4.2.3.2.1.3 Length
###### # 6.4.2.3.2.1.3.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.2.1.3.2 Conformance requirement
* * *
CR1 The length byte shall code the number of bytes in the information field of
the block. O_T1 CR2 The number of bytes in the information field shall vary in
the range from 0 to 254 bytes, depending on the type of block. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.2.1.3.
###### # 6.4.2.3.2.1.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### # 6.4.2.3.2.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
>
> _The UICC shall respond with an I-block containing the response to the
> SELECT command, where the I-block contain the LEN, length of the response
> data [CR1, CR2]._
###### # 6.4.2.3.2.1.4 Information field
###### # 6.4.2.3.2.1.4.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.2.1.4.2 Conformance requirement
* * *
CR1 The information field, INF, shall be optional and it depends on the type
of the block and what the field will be used for. In the case of an I-block,
INF shall be present to transfer command and response APDUs. O_T1 CR2 The
information field, INF, shall not be used for an R-block. O_T1 CR3 The
information field, INF, shall be optional and it depends on the type of the
block and what the field will be used for. In the case of an S-block, INF
shall be present (single byte) to adjust IFS with WTX. O_T1 CR4 The
information field, INF, shall be optional and it depends on the type of the
block and what the field will be used for. In the case of an S-block, INF
shall be absent to signal error on VPP, or managing chain abortion or
resynchronisation. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.2.1.4.
###### # 6.4.2.3.2.1.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR3 shall not be tested as it is not possible to force the UICC to
issue a WTX.
NOTE 2: CR4 shall not be tested as the Error on Vpp state S-block is not
supported.
###### # 6.4.2.3.2.1.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
>
> c) The ME simulator shall send a SELECT command to the UICC to select the
> EF~ECC~, where the I-block has an invalid EDC.
>
> _The UICC shall reject the command by sending an R-block response with bits
> b1-b4 in the PCB-byte having a value of \'1\' -- EDC and/or parity error.
> The INF field shall be absent [CR1, CR2]._
d) The ME simulator shall send a SELECT command to the UICC to select the
EF~ECC~.
e) The ME simulator shall reset the UICC.
> f) The ME simulator shall send an IFS REQUEST S-block to the UICC,
> requesting an adjustment of the IFSD to 254 bytes.
>
> _The UICC shall respond with an IFS RESPONSE S-block, whose INF field is
> present and has the value 254 [CR3]._
>
> g) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
h) The ME simulator shall reset the UICC.
i) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
j) The ME simulator shall send a RESYNCH request S-block to the UICC.
> _The UICC shall respond with a RESYNCH response S-block, which shall not
> contain an INF field [CR4]._
k) The ME simulator shall send a SELECT command to the UICC to select EF~ECC~.
l) The ME simulator shall reset the UICC.
m) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
n) The ME simulator shall send a SELECT command to the UICC to select EF~ECC~.
o) The ME simulator shall send an IFS REQUEST S-block to the UICC, requesting
an adjustment of the IFSD to the record length of EF~ECC~ -- 1 byte.
p) The ME simulator shall send a READ RECORD command to read record 1 from
EF~ECC~.
> q) The ME simulator shall send an ABORT request S-block to the UICC after
> the 1^st^ chained I-block response is received from the UICC.
>
> _The UICC shall respond with an ABORT response S-block, which shall not
> contain an INF field [CR4]._
>
> r) The ME simulator shall send an IFS REQUEST S-block to the UICC,
> requesting an adjustment of the IFSD to 32 bytes.
>
> s) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
###### 6.4.2.3.2.2 Void
###### 6.4.2.3.2.3 Epilogue field
###### # 6.4.2.3.2.3.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.2.3.2 Conformance requirement
* * *
CR1 The LRC as defined in ISO/IEC 7816‑3 [6] shall be used. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.2.2.
###### # 6.4.2.3.2.3.3 Test purpose
To verify that the LRC is calculated correctly.
###### # 6.4.2.3.2.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
> _The UICC shall respond with an I-block containing the response to the
> SELECT command. The epilogue field shall contain a 1 byte EDC -- of type LRC
> -- which shall be set to the correct value for the block [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select and
terminate the USIM application with invalid EDC.
> _The UICC shall reject the command by sending an R-block response of the
> format R(N), where N is the sequence number of the next expected I-block
> (ignoring the erroneous I-block) and with bits b1-b4 in the PCB-byte having
> a value of \'1\' -- EDC and/or parity error [CR1]._
##### 6.4.2.3.3 Error free operation
###### 6.4.2.3.3.1 Definition and applicability
See clause 3.5.3.
###### 6.4.2.3.3.2 Conformance requirement
* * *
CR1 To change the value of IFSD, the terminal sends an S(IFS request). The
request shall be acknowledged by the UICC with an S(IFS response) with the
same INF. The new IFSD is assumed to be valid as long as no new S(IFS request)
has been received by the UICC. O_T1 CR2 If a sender S sends I(N~s~(S), 0), the
block is acknowledged by the receiver R with an I(N~r~(S), M). O_T1 CR3 If a
sender S sends an I(N~s~(S), 1), it should be acknowledged by the receiver R
with R(N~r~(R)), where N~s~(S) ≠ N~r~(R), to indicate that the received block
was correct and that the receiver is ready to receive the next block. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.3.
###### 6.4.2.3.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### 6.4.2.3.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send an IFS REQUEST S-block to the UICC,
> requesting an adjustment of the IFSD to 254 bytes.
>
> _The UICC shall respond with an IFS RESPONSE S-block, whose INF field is
> present and has the value 254 [CR1]._
>
> c) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
>
> _The UICC shall respond to the last I-block of the command (I(N~s~(S), 0))
> with the response to the SELECT command, where the first I-block of the
> response is of the format I(N~r~(S), M) where N~r~(S) = 0 [CR2]._
>
> d) The ME simulator shall send a SELECT command to the UICC to select
> EF~ECC~.
>
> _The UICC shall respond to the last I-block of the command (I(N~s~(S), 0))
> with the response to the SELECT command, where the first I-block of the
> response is of the format I(N~r~(S), M) where N~r~(S) ≠ N~r~(S) of the
> previous I-block sent by the UICC [CR2]._
>
> e) The ME simulator shall send a SELECT command to the UICC, with an invalid
> file ID whose length shall be 255 bytes long, where each byte shall be set
> to \'FF\', split over at least 2 chained I-blocks.
>
> _The UICC shall respond to the first I-block from the ME simulator with a
> receive ready R-block of the format R(N~r~(R)) where N~s~(S) ≠ N~r~(R)
> [CR3]._
##### 6.4.2.3.4 Error Handling for T = 1
This subclause describes a number of conformance tests to test the control of
the error handling for the T = 1 protocol.
###### 6.4.2.3.4.1 Protocol initialisation
###### # 6.4.2.3.4.1.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.4.1.2 Conformance requirement
* * *
CR1 If the terminal fails to receive an error free block, in the beginning of
the protocol, a maximum of two consecutive attempts to receive the block shall
be allowed before resetting or a deactivation of the card takes place. O_T1
CR2 When the protocol has been initiated and the first block received by the
UICC is invalid, the UICC responds with an R(0). O_T1 CR3 If the terminal
fails to receive an error free block, a maximum of two consecutive attempts
shall be allowed before an S(RESYNCH request) is sent. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.4.1
###### # 6.4.2.3.4.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### # 6.4.2.3.4.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
c) The ME simulator shall send an R-block to the UICC, of the format R(0), to
request the UICC to re-send the last block.
_The UICC shall re-send the I-block, the response to the first SELECT command
[CR1]._
d) The ME simulator shall send an R-block to the UICC, of the format R(0), to
request the UICC to re-send the last block.
_The UICC shall re-send the I-block, the response to the first SELECT command
[CR1]._
e) The ME simulator shall reset the UICC.
> f) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application, where the I-block has an invalid EDC.
>
> _The UICC shall reject the command by sending an R-block response of the
> format R(0), with bits b1-b4 in the PCB-byte having a value of \'1\' -- EDC
> and/or parity error [CR2]._
>
> g) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
>
> h) The ME simulator shall send a SELECT command to the UICC to select
> EF~IMSI~.
>
> i) The ME simulator shall send an R-block to the UICC, of the format R(0),
> to request the UICC to re-send the last block.
_The UICC shall re-send the I-block, the response to the SELECT command in h)
[CR3]._
j) The ME simulator shall send an R-block to the UICC, of the format R(0), to
request the UICC to re-send the last block.
_The UICC shall re-send the I-block, the response to the SELECT command in h)
[CR3]._
k) The ME simulator shall send a S(RESYNCH, request) to the UICC.
_The UICC shall return a S(RESYNCH, response) [CR3]._
l) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
> m) The ME simulator shall send a READ BINARY command to the UICC.
_The UICC shall return the content of EF~IMSI~ [CR3]._
###### 6.4.2.3.4.2 Block dependant errors
###### # 6.4.2.3.4.2.1 Sending invalid blocks to the UICC
###### # 6.4.2.3.4.2.1.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.2.3.4.2.1.2 Conformance requirement
* * *
CR1 When an I-block has been sent and a BWT time-out occurs or an invalid
block has been received (with the terminal), an R-block is sent, which request
with its N(R) for the expected I-block with N(S) = N(R). O_T1 CR2 When an
R-block was sent and an invalid block is received or BWT time-out, the R-block
shall be resent. O_T1 CR3 When an S(...request) has been sent and either a BWT
time-out occurs or the received response is not an S(...response), the
S(...request) shall be resent. O_T1 CR4 But if an S(...response) has been sent
and either an invalid block is received or a BWT time-out, an R-block shall be
sent. O_T1 CR5 When the UICC sends an S(IFS request) and receives an invalid
block, the S(IFS request) shall be resent maximum one extra time to receive an
S(IFS response). After the second failure to receive an S(IFS response), the
UICC shall stay in reception mode. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.4.2.
###### # 6.4.2.3.4.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR3 and CR5 shall not be tested as it is not possible to meet the test
criteria.
###### # 6.4.2.3.4.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send an R-block to the UICC, of the format R(N(R))
where N(R) = N(S) of the last I-block sent by the UICC, to request the UICC to
re-send the last block.
> _The UICC shall re-send the last I-block of the response to the first SELECT
> command [CR1]._
d) The ME simulator shall send another R-block to the UICC, of the format
R(N(R)) where N(R) = N(S) of the last I-block sent by the UICC, to request the
UICC to re-send the last block.
> _The UICC shall re-send the last I-block of the response to the first SELECT
> command [CR2]._
e) The ME simulator shall reset the UICC.
f) The ME simulator shall send an IFS REQUEST S-block to the UICC, requesting
an adjustment of the IFSD to 254 bytes.
> g) The ME simulator shall re-send an IFS REQUEST S-block to the UICC,
> requesting an adjustment of the IFSD to 254 bytes.
>
> _The UICC shall re-send the IFS RESPONSE S-block, whose INF field shall have
> the value 254 [CR4]._
>
> h) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
##### 6.4.2.3.5 Chaining
###### 6.4.2.3.5.1 Definition and applicability
See clause 3.5.3.
###### 6.4.2.3.5.2 Conformance requirement
* * *
CR1 When the UICC is the receiver, the UICC shall accept a sequence of chained
I-blocks sent from the terminal. The length of each block shall be equal to
the value of IFSC except for the last block whose length may be any value in
the range 0 to IFSC. O_T1 CR2 When the UICC is the sender, all I-blocks of a
chain shall have LEN ≤ IFSD bytes per block. O_T1 CR3 When the UICC is the
receiver and receives a block with LEN > IFSC, the block shall be rejected and
acknowledged with an R-block with bits b1 to b4 in the PCB-byte having a value
of 2. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.2.3.5.1.
###### 6.4.2.3.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### 6.4.2.3.5.4 Method of test
NOTE: When EF~SMS~ is not supported by the UICC, any supported linear EF with
record length more than or equal to 31 bytes may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
Test procedure 1
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC, with an invalid
file ID whose length shall be 255 bytes, where each byte shall be set to 'FF'.
The SELECT command shall be spilt over at least 2 chained blocks.
> _For each I-block of format I(N~s~(S), 1) from the ME simulator (i.e all
> I-blocks apart from the last I-block), the UICC shall respond with a receive
> ready R-block of the format R(N~r~(R)) where N~r~(R) ≠. N~s~(S)._
>
> _For the last I-block from the ME simulator (i.e of format I(N~s~(S), 0)),
> the UICC shall respond with an R-APDU containing a status word indicating an
> application level error regarding the SELECT command [CR1]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
h) The ME simulator shall send a READ RECORD command to read record 1 from
EF~SMS~.
> _The UICC shall return the contents of record 1 in a series of chained
> I-blocks, whose INF fields are ≤ IFSD, i.e. less than or equal to 32 bytes
> in length [CR2]._
i) The ME simulator shall reset the UICC.
> j) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
>
> k) The ME simulator shall send a SELECT command to the UICC, with an invalid
> file ID whose length shall be 255 bytes long, where each byte shall be set
> to \'FF\', where the INF field in the I-block shall be set to 255 bytes in
> length.
>
> _The UICC shall reject the command by sending an R-block response of the
> formatR(N), where N is the sequence number of the next expected I-block
> (ignoring the erroneous I-block) and with bits b1 to b4 in the PCB-byte
> having a value of \'2\' -- other errors [CR3]._
### 6.4.3 Transport Layer
#### 6.4.3.1 Transportation of an APDU using T = 0
This subclause describes conformance tests relating to the mapping of C-APDUs
and R-APDUs for T = 0 protocol, the APDU exchange and the use of the GET
RESPONSE command for case 2 and case 4 commands.
##### 6.4.3.1.1 Case 1
###### 6.4.3.1.1.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.1.1.2 Conformance requirement
* * *
CR1 On receipt of the command header the UICC, under normal processing, shall
return status to the Transport Layer of the terminal. O_T0 CR2 On receipt of
the command header the UICC, under abnormal processing, shall return status to
the Transport Layer of the terminal. O_T0 CR3 UICC shall analyse the T = 0
command header to determine whether this is a case 1 command or a case 2
command requesting response data of maximum length. O_T0
* * *
Reference: TS 102.221 [1], subclause 7.3.1.1.1.
###### 6.4.3.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### 6.4.3.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a VERIFY PIN command with parameter P2
indicating PIN and with an empty data field to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'CX\' - unsuccessful PIN verification, X attempts left [CR1, CR3]._
d) The ME simulator shall send a VERIFY PIN command with an incorrect
parameter P2 and with an empty data field to the UICC.
> _The UICC shall return an error code appropriate to the command [CR2]._
##### 6.4.3.1.2 Case 2
###### 6.4.3.1.2.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.1.2.2 Conformance requirement
* * *
CR1 On receipt of the command header the UICC, under normal processing shall
return data and status to the Transport Layer of the terminal. O_T0 CR2 On
receipt of the command header the UICC, under abnormal processing shall return
status only to the Transport Layer of the terminal. O_T0
* * *
Reference: TS 102.221 [1], subclause 7.3.1.1.2.
###### 6.4.3.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### 6.4.3.1.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The UICC shall return the procedure byte \'B0\' followed by the data string
> \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00 00\', ending with the status condition SW1 =
> \'90\', SW2 = \'00\' - normal ending of the command [CR1]._
f) The ME simulator shall send a READ BINARY command with an incorrect P2
parameter and a length of 11 bytes to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR2]._
##### 6.4.3.1.3 Case 3
###### 6.4.3.1.3.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.1.3.2 Conformance requirement
+-----+------------------------------------------------------+-------+ | CR1 | On receipt of the command header, if the UICC: | O_T0 | | | | | | | a) returns a procedure byte, the Transport Layer of | | | | the terminal shall send the data portion of the | | | | conditional body of the C-APDU to the UICC under the | | | | control of procedure bytes returned by the UICC; | | | | | | | | b) returns status, the Transport Layer of the | | | | terminal shall discontinue processing the command. | | +-----+------------------------------------------------------+-------+ | CR2 | If the processing was not discontinued, the UICC | O_T0 | | | shall return status following receipt of the | | | | conditional body of the C-APDU and completion of | | | | processing the command. | | +-----+------------------------------------------------------+-------+ | CR3 | On receipt of status from the UICC, the Transport | O_T0 | | | Layer of the terminal shall discontinue processing | | | | the command. | | +-----+------------------------------------------------------+-------+
Reference: TS 102.221 [1], subclause 7.3.1.1.3.
###### 6.4.3.1.3.3 Test purpose
To verify that, under normal processing of a case 3 command, the UICC reads
the command header, reads the command data under control of procedure bytes
and returns status.
###### 6.4.3.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send an UPDATE BINARY command header using a length
of 11 bytes to the UICC.
> _The UICC shall return the procedure byte \'D6\' to the ME simulator [CR1]._
f) The ME simulator shall send the data string \'11 22 33 44 55 66 77 88 99 00
11\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
g) The ME simulator shall send an UPDATE BINARY command header with an
incorrect P2 parameter, a length of 11 bytes and, if needed, data string \'11
22 33 44 55 66 77 88 99 00 11\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR3]._
h) The ME simulator shall send an UPDATE BINARY command with the data \'A1 A2
A3 A4 A5 A6 A7 A8 A9 00 00\' to the UICC.
##### 6.4.3.1.4 Case 4
###### 6.4.3.1.4.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.1.4.2 Conformance requirement
+-----+------------------------------------------------------+-------+ | CR1 | On receipt of the command header, if the UICC: | O_T0 | | | | | | | a) returns a procedure byte, the Transport Layer of | | | | the terminal shall send the data portion of the | | | | conditional body of the C-APDU to the UICC under the | | | | control of procedure bytes returned by the UICC; | | | | | | | | b) returns status, the Transport Layer of the | | | | terminal shall discontinue processing of the | | | | command. | | +-----+------------------------------------------------------+-------+ | CR2 | If processing was not discontinued in CR1(b), | O_T0 | | | following receipt of the conditional body of the | | | | C-APDU, the UICC: | | | | | | | | a) under normal processing, shall return procedure | | | | bytes \'61xx\' to the Transport Layer of the | | | | terminal requesting the Transport Layer of the | | | | terminal to issue a GET RESPONSE command to retrieve | | | | the data from the UICC; | | | | | | | | b) under abnormal processing, shall return status | | | | only to the Transport Layer of the terminal. | | +-----+------------------------------------------------------+-------+ | CR3 | On receipt of the procedure bytes or status returned | O_T0 | | | in CR2, if the UICC: | | | | | | | | a) returned \'61xx\' procedure bytes as in CR2(a), | | | | the Transport Layer of the terminal shall send a GET | | | | RESPONSE command header to the UICC with P3 set to a | | | | value less than or equal to the value contained in | | | | the \'xx\' byte of \'61xx\' procedure bytes; | | | | | | | | b) returned status as in CR2(b) that indicates a | | | | warning (\'62xx\' or \'63xx\'), or which is | | | | application related (\'9xxx\' but not \'9000\'), the | | | | Transport Layer of the terminal shall send a GET | | | | RESPONSE command with Le = \'00\'; | | | | | | | | c) returned status as in CR2(b) other than that | | | | described in CR3(b), the Transport Layer of the | | | | terminal shall discontinue processing of the | | | | command. | | +-----+------------------------------------------------------+-------+ | CR4 | If processing was not discontinued in CR3(c), the | O_T0 | | | GET RESPONSE command shall be processed according to | | | | the rules for case 2 commands. | | +-----+------------------------------------------------------+-------+
Reference: TS 102.221 [1], subclause 7.3.1.1.4.
###### 6.4.3.1.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
###### 6.4.3.1.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command header to the UICC with P2 =
\'04\' and a length of 2 bytes to the UICC to select EF~IMSI~.
_The UICC shall return the procedure byte \'A4\' to the ME simulator [CR1]._
d) The ME simulator shall send the file ID of the EF~IMSI~ to the UICC.
> _The UICC shall return procedure bytes \'61xx\' to the ME simulator -- where
> xx is the length of the FCP of the EF~IMSI~ [CR2]._
e) The ME simulator shall send a GET RESPONSE command header to the UICC with
P3 set to length \'xx\'.
> _The UICC shall return the procedure byte \'C0\' followed by the FCP of the
> EF~IMSI~, ending with the status condition SW1 = \'90\', SW2 = \'00\' -
> normal ending of the command [CR4]._
f) The ME simulator shall send a SELECT command header to the UICC with an
incorrect P1 parameter, P2 = \'04\', a length of 2 bytes and, if needed, the
file ID of EF~LOCI~ to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR1]._
g) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
> _The UICC shall return procedure bytes \'61xx\' to the ME simulator -- where
> \'xx\' is the length of the FCP of the EF_ ~IMSI~ _[CR2]._
h) The ME simulator shall send a GET RESPONSE command to the UICC with P3 set
to \'yy\' where \'yy\' is less than \'xx\'.
> _The UICC shall return the first \'yy\' bytes of the FCP of the EF~IMSI~_
> ~.~
>
> _The status returned by the UICC shall be SW1 = \'61\', SW2 = \'zz\' \--
> where \'zz\' is the remaining length of the FCP of the EF~IMSI~ [CR3]._
i) The ME simulator shall send a GET RESPONSE command to the UICC with P3 set
to \'zz\'.
> _The UICC shall return the next \'zz\' bytes of the FCP of the EF~IMSI.~_
>
> _The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' \--
> normal ending of the command [CR3]._
##### 6.4.3.1.5 Use of Procedure Bytes \'61xx\' and \'6Cxx\'
###### 6.4.3.1.5.1 Case 2 Commands
###### # 6.4.3.1.5.1.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.3.1.5.1.2 Conformance requirement
+-----+------------------------------------------------------+-------+ | CR1 | If the UICC receives a case 2 command header and Le | O_T0 | | | = \'00\' (with Luicc \ Luicc, | | | | under normal processing it shall return procedure | | | | bytes \'6C Luicc\' instructing the Transport Layer | | | | of the Terminal to immediately re-send the command | | | | header with P3 = Luicc. | | +-----+------------------------------------------------------+-------+ | CR2 | If the UICC receives a case 2 command header and Le | O_T0 | | | = \'00\' (with Luicc \ Luicc, | | | | under abnormal processing it shall return status | | | | indicating a warning or error condition (but not SW1 | | | | SW2 = \'90 00\'). | | +-----+------------------------------------------------------+-------+ | CR3 | If the UICC receives a case 2 command header and Le | O_T0 | | | = \'00\' (with Luicc = 256 bytes) or Le = Luicc, | | | | under normal processing it shall return data of | | | | length Le (= Luicc) under the control of the INS, | | | | {width="0.24930555555555556in" | | | | height="0.2076388888888889in"}, or \'60\' procedure | | | | bytes followed by the associated status or procedure | | | | bytes \'61xx\'. | | +-----+------------------------------------------------------+-------+ | CR4 | If the UICC receives a case 2 command header and Le | O_T0 | | | = \'00\' (with Luicc = 256 bytes) or Le = Luicc, | | | | under abnormal processing it shall return status | | | | indicating a warning or error condition (but not SW1 | | | | SW2 = \'90 00\'). | | +-----+------------------------------------------------------+-------+ | CR5 | If the UICC receives a case 2 command header and Le | O_T0 | | | \ NOTE: For CR3 and CR6 the return of data from the UICC under the control of
> the {width="0.24444444444444444in" height="0.20416666666666666in"}
>
> \'60\' and \'61xx\' procedure bytes shall not be tested as it is not
> possible to force the UICC to behave in this way.
###### # 6.4.3.1.5.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a READ BINARY command header to the UICC with
the P3 parameter set to \'00\'.
_The UICC shall return the procedure bytes \'6C 0B\' to the ME simulator
[CR1]._
f) The ME simulator shall send a READ BINARY command header to the UICC with
the P3 parameter set to \'0B\'.
> _The UICC shall return the procedure byte \'B0\' followed by the data string
> \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00 00\', ending with the status condition SW1 =
> \'90\', SW2 = \'00\' - normal ending of the command [CR3]._
g) The ME simulator shall send a READ BINARY command header to the UICC with
an incorrect P2 parameter and the P3 parameter set to \'00\'.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR2]._
h) The ME simulator shall send a READ BINARY command header to the UICC with
an incorrect P2 parameter and the P3 parameter set to \'15\'.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR2]._
i) The ME simulator shall send a READ BINARY command header to the UICC with
an incorrect P2 parameter and the P3 parameter set to \'0B\'.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR4]._
j) The ME simulator shall send a READ BINARY command header to the UICC with
an incorrect P2 parameter and the P3 parameter set to \'05\'.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR6]._
###### 6.4.3.1.5.2 Case 4 Commands
###### # 6.4.3.1.5.2.1 Definition and applicability
See clause 3.5.3.
###### # 6.4.3.1.5.2.2 Conformance requirement
+-----+------------------------------------------------------+-------+ | CR1 | If the UICC receives a case 4 command, after | O_T0 | | | processing the data sent with the C‑APDU, | | | | | | | | - it shall return procedure bytes \'61xx\'; | | | | | | | | Or | | | | | | | | - if the UICC receives a case 4 command, after | | | | processing the data sent with the C‑APDU, it shall | | | | return status indicating a warning or error | | | | condition (but not SW1 SW2 = \'90 00\'). | | +-----+------------------------------------------------------+-------+
Reference: TS 102.221 [1], subclause 7.3.1.1.5.2.
###### # 6.4.3.1.5.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 and CR2 are tested in subclause 6.4.3.1.4.
###### # 6.4.3.1.5.2.4 Method of test
Initial Conditions
N/A
Test Procedure
N/A
#### 6.4.3.2 Transportation of an APDU using T = 1
This subclause describes conformance tests relating to the transportation of
an APDU using the T = 1 protocol.
The tests defined in this subclause only apply where the UICC under test
supports the T = 1 protocol. If the UICC under test does not support the T = 1
protocol, then these tests do not apply.
The tests in this subclause assume that the T = 1 protocol is the first
indicated protocol for the UICC. If the UICC under test supports T = 1 but it
is not the first indicated protocol, then each test must be extended to
configure the UICC to employ the T = 1 protocol, e.g. via the PPS mechanism.
##### 6.4.3.2.1 Case 1
###### 6.4.3.2.1.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.2.1.2 Conformance requirement
* * *
CR1 C-APDU shall be mapped to the INF of the I-Block and the received response
from the INF in the I-Block shall be mapped to R-APDU according to Figure 7.10
in TS 102.221 [1]. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.3.2.1.
###### 6.4.3.2.1.3 Test purpose
To verify that, under normal or abnormal processing of a case 1 command, the
UICC returns status only.
###### 6.4.3.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a VERIFY PIN command with parameter P2
indicating PIN and with an empty data field to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'CX\' - unsuccessful PIN verification, X attempts left [CR1]._
d) The ME simulator shall send a VERIFY PIN command with an incorrect
parameter P2 and with an empty data field to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR1]._
##### 6.4.3.2.2 Case 2
###### 6.4.3.2.2.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.2.2.2 Conformance requirement
* * *
CR1 C-APDU shall be mapped to the INF of the I-Block and the received response
from the INF in the I-Block shall be mapped to R-APDU according to Figure 7.11
in TS 102.221 [1]. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.3.2.2.
###### 6.4.3.2.2.3 Test purpose
To verify that, under normal processing of a case 2 command, the UICC returns
data and status and that, under abnormal processing of a case 2 command, the
UICC returns status only.
###### 6.4.3.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The UICC shall return the data string \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00 00\',
> ending with the status condition SW1 = \'90\', SW2 = \'00\' - normal ending
> of the command [CR1]._
f) The ME simulator shall send a READ BINARY command with an incorrect P2
parameter and a length of 11 bytes to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR1]._
##### 6.4.3.2.3 Case 3
###### 6.4.3.2.3.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.2.3.2 Conformance requirement
* * *
CR1 C-APDU shall be mapped to the INF of the I-Block and the received response
from the INF in the I-Block shall be mapped to R-APDU according to Figure 7.12
in TS 102.221 [1]. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.3.2.3.
###### 6.4.3.2.3.3 Test purpose
To verify that, under normal or abnormal processing of a case 3 command, the
UICC returns status only.
###### 6.4.3.2.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send an UPDATE BINARY command with the data string
\'11 22 33 44 55 66 77 88 99 00 11\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
f) The ME simulator shall send an UPDATE BINARY command header with an
incorrect P2 parameter and the data string \'11 22 33 44 55 66 77 88 99 00
11\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR1]._
g) The ME simulator shall send an UPDATE BINARY command with the data \'A1 A2
A3 A4 A5 A6 A7 A8 A9 00 00\' to the UICC.
##### 6.4.3.2.4 Case 4
###### 6.4.3.2.4.1 Definition and applicability
See clause 3.5.3.
###### 6.4.3.2.4.2 Conformance requirement
* * *
CR1 C-APDU shall be mapped to the INF of the I-Block and the received response
from the INF in the I-Block shall be mapped to R-APDU according to Figure 7.13
in TS 102.221 [1]. O_T1
* * *
Reference: TS 102.221 [1], subclause 7.3.2.4.
###### 6.4.3.2.4.3 Test purpose
To verify that, under normal processing of a case 4 command, the UICC returns
data and status and that, under abnormal processing of a case 4 command, the
UICC returns status only.
###### 6.4.3.2.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command with P2 = \'04\' to the UICC
to select EF~IMSI~.
> _The UICC shall return the FCP of the EF~IMSI~ together with the status
> condition SW1 = \'90\', SW2 = \'00\' - normal ending of the command [CR1]._
d) The ME simulator shall send a SELECT command with incorrect P1 parameter
and P2 = \'04\' to the UICC to select EF~LOCI~
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \-
> incorrect parameters P1-P2 [CR1]._
### 6.4.4 Application Layer
#### 6.4.4.1 Definition and applicability
See clause 3.5.3.
#### 6.4.4.2 Conformance requirement
* * *
CR1 Each step in an Application Layer exchange consists of a command-response
pair, where the Application Layer of the terminal sends a command to the UICC
via the Transport Layer of the terminal, and the UICC processes it and sends a
response to Application Layer of terminal using the Transport Layer of the
UICC and the Transport Layer of the terminal. M CR2 Four cases shall be
managed by the transmission protocols via the transport layer. M
* * *
Reference: TS 102.221 [1], subclause 7.4.
#### 6.4.4.3 Test purpose
To verify that the Physical Layer function conforms to the above requirements.
NOTE: CR1 and CR2 are tested for each UICC commands described in subclause
6.8.
#### 6.4.4.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
## 6.5 Application and File structure
The tests in this subclause ensure that the IUT is tested against the
specification of the logical structure, for a UICC, the code associated with
it, and the structure of the files used.
### 6.5.1 UICC Application structure
#### 6.5.1.1 Definition and applicability
See clause 3.5.3.
#### 6.5.1.2 Conformance requirement
* * *
CR1 The UICC shall contain EF~DIR~ under MF. M CR2 EF~DIR~ shall contain
application identifier(s) available on the UICC. M CR3 The UICC shall contain
EF~PL~ under MF. M CR4 The UICC shall contain EF~ICCID~ under MF. M CR5 If
DF~TELECOM~ is present it shall reside under the MF and shall use the reserved
FID '7F 10'. M
* * *
Reference: TS 102.221 [1], subclause 8.1.
#### 6.5.1.3 Test purpose
To verify that the Elementary Files within the UICC application structure
conform to the above requirements.
#### 6.5.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select EF~DIR~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
c) The ME simulator shall send a READ RECORD command to read record 1 of the
EF~DIR~. The length used shall be that of bytes 5 and 6 in TLV DO with tag
\'82\' of the response data in step b).
d) The ME simulator shall send a SELECT command to the UICC to select and
activate the ADF stated in EF~DIR~ of record 1.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR2]._
e) The ME simulator shall reset the UICC.
f) The ME simulator shall send a SELECT command to the UICC to select EF~PL~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR3]._
g) The ME simulator shall send a SELECT command to the UICC to select
EF~ICCID~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR4]._
h) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command, if the UICC supports DF~TELECOM~,
> otherwise the status condition returned by the UICC shall be SW1 = \'6A\',
> SW2 = \'82\' -- file ID not found [CR5]._
### 6.5.2 File types
#### 6.5.2.1 Dedicated files
##### 6.5.2.1.1 Definition and applicability
See clause 3.5.3.
##### 6.5.2.1.2 Conformance requirement
* * *
CR1 DFs shall be referenced by file identifiers. M CR2 The Application DF
(ADF) shall be a particular DF containing all the DFs and EFs of the
application. M
* * *
Reference: TS 102.221 [1], subclause 8.2.1.
##### 6.5.2.1.3 Test purpose
To verify that the Dedicated Files within the UICC file structure conform to
the above requirements.
NOTE: CR1 and CR2 shall not be tested as the SELECT function requires the file
ID in order to select the files.
##### 6.5.2.1.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
#### 6.5.2.2 Elementary files
Elementary File structures the way in which information is held on the UICC
and provides security on how this information is accessed.
##### 6.5.2.2.1 Transparent EF
###### 6.5.2.2.1.1 Definition and applicability
See clause 3.5.3.
###### 6.5.2.2.1.2 Conformance requirement
* * *
CR1 The first byte of a transparent EF has the relative address \'00 00\'. M
CR2 The total data length of the body of an EF with transparent structure
shall be indicated in the SELECT response of the EF. M
* * *
Reference: TS 102.221 [1], subclause 8.2.2.1.
###### 6.5.2.2.1.3 Test purpose
To verify that the EFs within the UICC file structure conform to the above
requirements.
###### 6.5.2.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select EF~UST~.
d) The ME simulator shall fulfil the READ access condition of the EF~UST~.
e) The ME simulator shall send a READ BINARY command to the UICC. The length
used shall be the TLV DO with tag \'80\' of the response data in step c).
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
f) The ME simulator shall send a READ BINARY command with offset \'00 01\' to
the UICC. The length used shall be the TLV DO with tag \'80\' of the response
data in step c) minus 1.
> _The length of data returned shall be Le and the status condition returned
> by the UICC shall be SW1 = \'90\', SW2 = \'00\' - normal ending of the
> command [CR1]._
g) The ME simulator shall send a READ BINARY command with offset \'00 01\' to
the UICC. The length used shall be the TLV DO with tag \'80\' of the response
data in step c).
_When T = 0 protocol is used:_
_The UICC shall return procedure bytes \'6C Le-1\'; or status indicating a
warning or error condition (but not SW1 SW2 = \'90 00\')._
> _When T = 1 protocol is used:_
>
> _The length of data returned shall be Le minus 1 and the status condition
> returned by the UICC shall be SW1 = \'62\', SW2 = \'82\' -- end of
> file/record reached before reading Le bytes [CR1, CR2]._
##### 6.5.2.2.2 Linear fixed EF
###### 6.5.2.2.2.1 Definition and applicability
See clause 3.5.3.
###### 6.5.2.2.2.2 Conformance requirement
+-----+----------------------------------------------------------+---+ | CR1 | A linear fixed EF consists of a sequence of records all | M | | | having the same (fixed) length. | | +-----+----------------------------------------------------------+---+ | CR2 | The first record shall be record number 1. | M | +-----+----------------------------------------------------------+---+ | CR3 | The length of a record shall be indicated in the SELECT | M | | | response of the EF. | | +-----+----------------------------------------------------------+---+ | CR4 | The length of a record multiplied by the number of | M | | | records shall be indicated in the SELECT response of the | | | | EF. | | +-----+----------------------------------------------------------+---+ | CR5 | The UICC shall be able to access records within a linear | M | | | fixed EF using all of the following: | | | | | | | | a) absolutely using the record number; | | | | | | | | b) when the record pointer is not set, it shall be | | | | possible to perform an action on the first or the last | | | | record by using the NEXT or PREVIOUS mode; | | | | | | | | c) when the record pointer is set it shall be possible | | | | to perform an action on this record, the next record | | | | (unless the record pointer is set to the last record) or | | | | the previous record (unless the record pointer is set to | | | | the first record); | | | | | | | | d) by identifying a record using pattern search. | | +-----+----------------------------------------------------------+---+ | CR6 | If an action following selection of a record is aborted | M | | | (e.g. due to an unsuccessful execution of a command), | | | | then the record pointer shall remain set at the record | | | | at which it was set prior to the action. | | +-----+----------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 8.2.2.2.
###### 6.5.2.2.2.3 Test purpose
To verify that the EFs within the UICC file structure conform to the above
requirements.
NOTE: CR5 and CR6 are tested in subclause 6.8.1.
###### 6.5.2.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) The records in EF~FDN~ shall contain the following data for the first 10
bytes:
* * *
**1st record** \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\' **2nd record** \'B0 B1 B2 A0
A1 A2 A0 A1 A2 B0\' **3rd record** \'B0 B1 B2 A0 A1 A2 B0 B1 B2 A0\' **4th
record** \'A0 A1 A2 B0 B1 B2 B0 B1 B2 B0\'
* * *
3) The data for the remainder of these four records and for all other records
(if any) shall be \'FF\'.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
d) The ME simulator shall send a SELECT command to the UICC to select EF~FDN~.
> _Following shall be true for the SELECT response data:_
_\- the value of TLV DO with tag \'80\' shall be equal to product of byte 6
and byte 7 in TLV DO with tag \'82\' [CR4]._
e) The ME simulator shall send a READ RECORD command to the UICC using
ABSOLUTE mode with record 1 and Le shall be the record length as indicated in
byte 6 in TLV DO with tag \'82\' of the response data in step d).
> _The data returned by the UICC shall be that of the first record [CR2]._
>
> _The length of the data returned shall be that of byte 6 in TLV DO with tag
> \'82\' of the response data in step d) [CR3]._
>
> _The status condition returned by the UICC shall be SW1=\'90\', SW2=\'00\' -
> normal ending of the command._
f) The ME simulator shall repeat sending a READ RECORD command to the UICC
using NEXT mode with Le being the record length as indicated in byte 6 in TLV
DO with tag \'82\' of the response data in step d) until it reaches the last
record whose record number is equal to the byte 7 in TLV DO with tag \'82\' of
the response data in step d).
> _The length of the data returned in response to every READ RECORD command
> shall be that of byte 6 in TLV DO with tag \'82\' of the response data in
> step d) [CR1, CR3]._
>
> _The status condition returned by the UICC in response to every READ RECORD
> command shall be SW1=\'90\', SW2=\'00\' - normal ending of the command._
>
> g) The ME simulator shall send a READ RECORD command to the UICC using NEXT
> mode with Le being the record length as indicated in byte 6 in TLV DO with
> tag \'82\' of the response data in step d).
>
> _The UICC shall return an error code appropriate to the command (e.g.
> SW1=\'6A\', SW2=\'83\' - record not found) [CR4]._
NOTE: Step g) confirms that the number of records indicated in byte 7 in the
TLV DO with tag \'82\' of the response data is correct.
##### 6.5.2.2.3 Cyclic EF
###### 6.5.2.2.3.1 Definition and applicability
See clause 3.5.3.
###### 6.5.2.2.3.2 Conformance requirement
* * *
CR1 An EF with a cyclic structure consists of a fixed number of records with
the same (fixed) length. M CR2 In this file structure there shall be a link
between the last record (n) and the first record. M CR3 When the record
pointer is set to the last record n, then the next record shall be record
number 1. M CR4 When the record pointer is set to record 1, then the previous
record shall be record number n. M CR5 The last updated record containing the
newest data shall be record number 1, and the oldest data shall be held in
record number n. M CR6 For update operations only PREVIOUS record shall be
used. M CR7 For reading operations, the methods of addressing shall be Next,
Previous, Current and Record Number. M CR8 If an action following selection of
a record is aborted (e.g. due to an unsuccessful execution of a command), then
the record pointer shall remain set at the record at which it was set prior to
the action. M
* * *
Reference: TS 102.221 [1], subclause 8.2.2.3.
###### 6.5.2.2.3.3 Test purpose
To verify that the EFs within the UICC file structure conform to the above
requirements.
NOTE: CR8 are tested in subclause 6.8.1.
###### 6.5.2.2.3.4 Method of test
NOTE: When EF~ICI~ is not supported by the UICC, any supported cyclic EF in
ADF~USIM~ may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~ICI~ shall have at least 4 records.
3) The records in EF~ICI~ shall contain the following data:
* * *
**1^st^ record** \'01\' for all bytes **2^nd^ record** \'02\' for all bytes
**3^rd^ record** \'03\' for all bytes **X^th^ record** byte value X for all
bytes
* * *
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
d) The ME simulator shall send a SELECT command to the UICC to select EF~ICI~.
e) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC. The length used shall be that of bytes 5 and 6 in TLV DO with tag \'82\'
of the response data in step d).
_The response data shall be the data in the first record [CR1]._
f) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC. The record length used shall be that of bytes 5 and 6 in TLV DO with
tag \'82\' of the response data in step d).
_The response data shall be the data in the last record [CR1, CR4]._
g) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC. The record length used shall be that of bytes 5 and 6 in TLV DO with tag
\'82\' of the response data in step d).
_The response data shall be the data in the first record [CR2, CR3, CR4,
CR7]._
h) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC. The record length used shall be that of bytes 5 and 6 in TLV DO with
tag \'82\' of the response data in step d).
_The response data shall be the data in the last record [CR4, CR7]._
i) The ME simulator shall send an UPDATE RECORD command using PREVIOUS mode to
the UICC with \'FF\' for all the bytes. The record length used shall be that
of bytes 5 and 6 in TLV DO with tag \'82\' of the response data in step d)
[CR5].
j) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC. The length used shall be that of bytes 5 and 6 in TLV DO
with tag \'82\' of the response data in step d).
_The response data shall be the new data that has been updated in step i)
[CR5]._
k) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC. The length used shall be that of bytes 5 and 6 in TLV DO with tag
\'82\' of the response data in step d).
_The response data shall be the previous data in the second last record
[CR5]._
l) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with record 1 to the UICC with \'FF\' for all the bytes. The length used shall
be that of bytes 5 and 6 in TLV DO with tag \'82\' of the response data in
step d).
> _The UICC shall return an error code appropriate to the command (e.g.
> SW1=\'69\', SW2=\'81\' -- command incompatible with file structure) [CR6]._
m) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC with \'FF\' for all the bytes. The length used shall be that of bytes
5 and 6 in TLV DO with tag \'82\' of the response data in step d).
> _The UICC shall return an error code appropriate to the command (e.g.
> SW1=\'69\', SW2=\'81\' -- command incompatible with file structure) [CR6]._
n) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC with \'FF\' for all the bytes. The length used shall be that of bytes 5
and 6 in TLV DO with tag \'82\' of the response data in step d).
> _The UICC shall return an error code appropriate to the command (e.g.
> SW1=\'69\', SW2=\'81\' -- command incompatible with file structure) [CR6]._
##### 6.5.2.2.4 BER-TLV structure EF
###### 6.5.2.2.4.1 Definition and applicability
See clause 3.5.3.
###### 6.5.2.2.4.2 Conformance requirement
* * *
CR1 A BER-TLV structure EF is seen at the interface as a set of data objects
accessible by commands for handling data objects. Rel-6 - ...: O_BER_TLV_FILES
CR2 The type of data objects in the EF is BER-TLV. Rel-6 - ...:
O_BER_TLV_FILES
* * *
Reference: TS 102.221 [1], subclause 8.2.2.4.
###### 6.5.2.2.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 and CR2 are tested in subclause 6.8.2.
###### 6.5.2.2.4.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
### 6.5.3 File referencing
#### 6.5.3.1 Definition and applicability
See clause 3.5.3.
#### 6.5.3.2 Conformance requirement
* * *
CR1 A file ID shall be assigned at the time of creation of the file concerned.
M CR2 Two files under the same parent shall never have the same ID. M CR3 The
immediate children of the current DF, the parent DF or the immediate children
of the parent DF shall not have the same FID. M CR4 No two files under the
same parent shall have the same SFI. M CR5 The DF name shall be unique within
a card. M CR6 The reserved FID '7F FF' can be used as a FID for the ADF of the
current active application on a given logical channel. (R99) Rel-6 - ...
* * *
Reference: TS 102.221 [1], subclause 8.3.
#### 6.5.3.3 Test purpose
To verify that all files within the UICC structure conform to the above
requirements.
NOTE 1: CR1 shall not be tested as the SELECT function requires the file ID in
order to select files.
NOTE 2: CR2, CR3 and CR5 shall not be tested due to the operation of the
SELECT function which should only ever select a single file for a given file
ID.
NOTE 3: CR4 shall not be tested due to the operation of commands which
supports SFI referencing, they should only ever select a single file for a
given SFI.
NOTE 4: CR6 is tested in subclause 6.5.7.
#### 6.5.3.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
### 6.5.4 Methods for selecting a file
#### 6.5.4.1 SELECT by File Identifier Referencing
##### 6.5.4.1.1 Definition and applicability
See clause 3.5.3.
##### 6.5.4.1.2 Conformance requirement
+-----+----------------------------------------------------------+---+ | CR1 | Selection of an ADF, DF or MF shall set the Current | M | | | Directory on the UICC. | | +-----+----------------------------------------------------------+---+ | CR2 | After a selection of an ADF, DF or MF, there shall be no | M | | | current EF. | | +-----+----------------------------------------------------------+---+ | CR3 | After a selection of an EF, the current EF shall be set | M | | | to this EF and the Current Directory shall remain the | | | | ADF, DF or MF which is the parent of this EF. | | +-----+----------------------------------------------------------+---+ | CR4 | Any application specific command shall only be operable | M | | | if it is specific to the Current Directory. | | +-----+----------------------------------------------------------+---+ | CR5 | It shall be possible to select the following from the | M | | | last selected file: | | | | | | | | a) any file which is an immediate child of the Current | | | | Directory; | | | | | | | | b) any DF which is an immediate child of the parent of | | | | the current DF; | | | | | | | | c) the parent of the Current Directory; | | | | | | | | d) the current DF; | | | | | | | | e) the ADF of the current active application | | | | | | | | f) the MF. | | | | | | | | NOTE: Reselection of the last selected file shall be | | | | allowed. | | +-----+----------------------------------------------------------+---+ | CR6 | It shall be possible to select any of the \'valid | M | | | selections\' in Table 8.1, subclause 8.4.1 of | | | | TS 102.221 [1] for each of the \'last selected file\' | | | | entries. | | +-----+----------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 8.4.1.
##### 6.5.4.1.3 Test purpose
To verify that the UICC conforms to the above requirements with regard to file
selection by File Identifier Referencing.
NOTE 1: CR4 shall not be tested as it is outside the scope of the present
document.
##### 6.5.4.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a STATUS command to the UICC.
> _if a TLV DO with tag \'83\' is present ,then the response data shall
> indicate that ADF~USIM~ is the currently selected directory [CR1]._
d) The ME simulator shall send a READ BINARY command using a length of 1 byte
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'86\' -- command not allowed (no EF selected) [CR2]._
e) The ME simulator shall send a SELECT command to the UICC to select EF~AD~.
> _TLV DO with tag \'83\' of the response data shall indicate that EF~AD~ is
> the currently selected EF [CR3]._
f) The ME simulator shall send a STATUS command to the UICC.
> _If a TLV DO with tag \'83\' is present, then the response data shall
> indicate that ADF~USIM~ is the currently selected directory [CR3]._
g) Step h) shall be carried out for each line in Table 8.1, subclause 8.4.1 of
TS 102.221 [1] for which a file is defined in Table 9.
h) Step i) shall be carried out for each one of the \'valid selections\' in
that line of the table.
i) Steps j) and then k) shall be carried out in turn.
j) The ME simulator shall send a SELECT command to the UICC to select the
\'last selected file\'.
k) The ME simulator shall send a SELECT command to the UICC to select the
\'valid selection\'.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR6, CR7]._
l) The following file IDs shall be used to represent the IDs in the table:
Table 9: Actual File Selection
* * *
Table Actual MF MF ADF1 ADF~USIM~ DF1 DF~TELECOM~ DF4 DF~PHONEBOOK~ EF1
EF~ICCID~ EF2 EF~ADN~ EF3 EF~AD~ EF5 EF~PBR~
* * *
NOTE 1: When EF~ADN~ is not supported by the UICC, any supported EF in
DF~TELECOM~ may be chosen.
NOTE 2: When EF~PBR~ is not supported by the UICC, any supported EF in
DF~PHONEBOOK~ may be chosen.
#### 6.5.4.2 SELECT by Path Referencing
##### 6.5.4.2.1 Definition and applicability
See clause 3.5.3.
##### 6.5.4.2.2 Conformance requirement
* * *
CR1 It shall be possible to select any of the \'valid selections\' in Table
8.2, subclause 8.4.2 of TS 102.221 [1] for each of the \'last selected file\'
entries, assuming the current ADF has been previously selected. M
* * *
Reference: TS 102.221 [1], subclause 8.4.2.
##### 6.5.4.2.3 Test purpose
To verify that the UICC conforms to the above requirements with regard to file
selection by path referencing.
##### 6.5.4.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
> a) The ME simulator shall reset the UICC.
>
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate the USIM application.
c) Step d) shall be carried out for each line in Table 8.2, subclause 8.4.2 of
TS 102.221 [1] for which a file is defined in Table 9.
d) Step e) shall be carried out for each one of the \'example selections\' in
that line of the table.
e) Steps f) and then g) shall be carried out in turn.
f) The ME simulator shall send a SELECT command to the UICC to select the
\'last selected DF\'.
g) The ME simulator shall send a SELECT by path command to the UICC to select
the \'example selections\'.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR2]._
#### 6.5.4.3 Short File Identifier
##### 6.5.4.3.1 Definition and applicability
See clause 3.5.3.
##### 6.5.4.3.2 Conformance requirement
+------+------------------------------+------------------------------+ | CR1 | It shall be possible to use | M | | | to the following commands. | | | | | | | | a) READ RECORD; | | | | | | | | b) UPDATE RECORD; | | | | | | | | c) READ BINARY; | | | | | | | | d) UPDATE BINARY; | | | | | | | | e) INCREASE; | | | | | | | | f) SEARCH RECORD. | | +------+------------------------------+------------------------------+ | CR2 | SFI shall be found in the | M | | | TLV DO with tag \'88\'. | | +------+------------------------------+------------------------------+ | CR3 | If the length of the TLV DO | M | | | with tag \'88\' is 0, it | | | | indicates that the file does | | | | not support referencing by | | | | SFI. | | +------+------------------------------+------------------------------+ | CR4 | If the TLV DO is not present | M | | | in the FCP it indicates that | | | | the 5 least significant bits | | | | of the FID are used as SFI. | | +------+------------------------------+------------------------------+ | CR5 | When the READ RECORD command | M | | | contains a valid SFI, it | | | | shall set the file as the | | | | current EF and reset the | | | | current record pointer. | | | | Subsequent records are read | | | | with the READ RECORD command | | | | without SFI. | | +------+------------------------------+------------------------------+ | CR6 | When the UPDATE RECORD | M | | | command contains a valid | | | | SFI, it shall set the file | | | | as the current EF and reset | | | | the current record pointer. | | | | Subsequent records are | | | | updated with the UPDATE | | | | RECORD command without SFI. | | +------+------------------------------+------------------------------+ | CR7 | When the INCREASE command | M | | | contains a valid SFI, it | | | | shall set the file as the | | | | current EF and reset the | | | | current record pointer. | | | | Subsequent records are | | | | increased with the INCREASE | | | | command without SFI. | | +------+------------------------------+------------------------------+ | CR8 | When the SEARCH RECORD | M | | | command contains a valid | | | | SFI, it shall set the file | | | | as the current EF and reset | | | | the current record pointer. | | | | Subsequent records are | | | | searched with the SEARCH | | | | RECORD command without SFI. | | +------+------------------------------+------------------------------+ | CR9 | When the RETRIEVE DATA | Rel-6 - ...: | | | command contains a valid | O_BER_TLV_FILES | | | SFI, it sets the file as the | | | | current EF and resets the | | | | current tag pointer. If | | | | segmentation over several | | | | APDUs is used to retrieve | | | | long structures, subsequent | | | | RETRIEVE DATA commands shall | | | | be used without SFI. | | +------+------------------------------+------------------------------+ | CR10 | When the SET DATA command | Rel-6 - ...: | | | contains a valid SFI, it | O_BER_TLV_FILES | | | sets the file as the current | | | | EF and resets the current | | | | tag pointer. If segmentation | | | | over several APDUs is used | | | | to set long structures, | | | | subsequent SET DATA commands | | | | shall be used without SFI. | | +------+------------------------------+------------------------------+
Reference: TS 102.221 [1], subclause 8.4.3.
##### 6.5.4.3.3 Test purpose
To verify that the UICC conforms to the above requirements with regard to
selection by short file identifier.
NOTE 1: CR3 shall not be tested as it requires information on the files which
do not support SFI.
NOTE 2: CR4 shall not be tested as it requires information on the file ID.
NOTE 3: CR1, CR5, CR6, CR7 and CR8 are tested in subclause 6.8.1.
NOTE 4: CR9 and CR10 are tested in subclause 6.8.2.
##### 6.5.4.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
> _TLV DO with tag \'88\' of the response data shall indicate the SFI of the
> EF~IMSI~ [CR2]._
### 6.5.5 Application characteristic
#### 6.5.5.1 Explicit Application selection
##### 6.5.5.1.1 SELECT by DF Name
###### 6.5.5.1.1.1 Definition and applicability
See clause 3.5.3.
###### 6.5.5.1.1.2 Conformance requirement
* * *
CR1 A selectable application shall be referenced by a DF name coded on 1 to 16
bytes. M CR2 Each name shall be unique within a UICC. M CR3 A DF name can be
used in the SELECT command to select a selectable application. M
* * *
Reference: TS 102.221 [1], subclause 8.5.1.1.
###### 6.5.5.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR3 is tested in the subclause 6.5.5.1.
###### 6.5.5.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select EF~DIR~.
c) The ME simulator shall send a READ RECORD command with NEXT mode to the
UICC.
> _The length of the TLV DO with tag \'4F\' in the response data shall not
> exceed 16 bytes [CR1]._
>
> _The TLV DO with tag \'4F\' in the response data shall not be same with any
> other TLV DO with tag \'4F\' of the other records [CR2]._
d) Step c) shall be repeated until it reaches the end of file.
e) Following steps f) and g) shall be repeated for each AIDs read in the step
c).
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the ADF.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command._
>
> _The FCP shall contain the following [CR3]:_
>
> _\- TLV DO with tag 82 shall be \'38\' or \'78\'(File Descriptor);_
>
> _\- TLV DO with tag 84 shall be the AID of the UICC (DF name -- AID)._
##### 6.5.5.1.2 SELECT by partial DF Name
###### 6.5.5.1.2.1 Definition and applicability
See clause 3.5.3.
###### 6.5.5.1.2.2 Conformance requirement
* * *
CR1 A selectable application shall be able to be selected by a partial DF name
using the P2 parameters first and only occurrence, next, previous or last. M
CR2 DF name shall be right truncated. M CR3 If P2 indicates the \"last\"
option, the last active application shall be selected even if it was a
previous card-session. M CR4 Selection of an application by a partial DF name
shall be optional for mono application cards. O_MONO_APP CR5 Selection of an
application by a partial DF name shall be supported for multi-application
cards. O_MULTI_APP CR6 The support of this feature shall be indicated in the
\'card service data\' and \'card capabilities\' compact-TLV objects of the ATR
historical bytes. M CR7 If the UICC does not support selection with partial DF
name, the UICC shall respond with an appropriate response (e.g. command
parameters not supported '6A86'). (R99) Rel-6 - ...: O_MONO_APP
* * *
Reference: TS 102.221 [1], subclause 8.5.1.2.
###### 6.5.5.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: Selection by Partial DF name shall not be tested as it requires the
interpretation of the next, previous and first occurrence.
###### 6.5.5.1.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to select and activate the
USIM application.
c) The ME simulator shall reset the UICC.
d) The ME simulator shall send a SELECT command with partial DF name of an
USIM application and P2 indicating \"last occurrence\" option to select and
activate the last selected application.
> _If the ATR returned in a) indicates that partial selection by DF name is
> supported(as indicated in the \"card service data\" and the \"card
> capabilities\" compact-TLV objects of the ATR historical byte)s the UICC
> shall return the response indicating the USIM application is selected [CR3,
> CR4, CR6]._
>
> _If the ATR returned in a) indicates that partial selection by DF name is
> not supported the UICC shall respond with an appropriate response (e.g.
> command parameters not supported \'6A86\') [CR7]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to select and activate the
USIM application.
c) The ME simulator shall reset the UICC.
d) The ME simulator shall send a SELECT command with partial DF name of an
USIM application and P2 indicating \"last occurrence\" option to select and
activate the last selected application.
_The UICC shall return the response indicating the USIM application is
selected [CR1, CR3]._
**Test procedure 3**
a) The ME simulator shall reset the UICC.
> _The ATR returned by the UICC shall indicate that selection by partial DF
> name is supported in the \"card service data\" and the \"card capabilities\"
> compact-TLV objects of the ATR historical bytes. [CR5, CR6]_
b) The ME simulator shall send a SELECT command to select and activate the
USIM application.
c) The ME simulator shall reset the UICC.
d) The ME simulator shall send a SELECT command with partial DF name of an
USIM application and P2 indicating \"last occurrence\" option to select and
activate the last selected application.
_The UICC shall return the response indicating the USIM application is
selected [CR1, CR3]._
#### 6.5.5.2 Application session activation
##### 6.5.5.2.1 Definition and applicability
See clause 3.5.3.
##### 6.5.5.2.2 Conformance requirement
* * *
CR1 The application session is initiated when the ME sends a SELECT command,
with the application\'s AID, indicating in the command parameters that the
application shall be activated. M CR2 There shall be only one active
selectable application session on a given logical channel. M CR3 After having
selected the application the UICC shall evaluate the security environment for
this application and set the SE according to the application's verification
requirements. Rel-4 - ...
* * *
Reference: TS 102.221 [1], subclause 8.5.2.
##### 6.5.5.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR2 shall not be tested as it is impossible to investigate the number
of applications which are activated in a logical channel.
> NOTE 2: CR3 is not tested.
##### 6.5.5.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate USIM application.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
c) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
> _The response data shall contain the following [CR1]:_
>
> _\- TLV DO with tag \'84\' shall indicate an AID of the USIM application._
#### 6.5.5.3 Application session termination
##### 6.5.5.3.1 Definition and applicability
See clause 3.5.3.
##### 6.5.5.3.2 Conformance requirement
* * *
CR1a An application session shall be terminated implicitly if a SELECT by
DF~name~ command with an AID different from the currently active application
is performed by the UICC. O_MULTI_APP CR1b An application session shall be
terminated explicitly if the application is reselected using the SELECT
command indicating in the command parameters that the application shall be
terminated. M CR1c An application session shall be terminated if the terminal
performs a reset of the UICC. M CR1d An application session shall be
terminated if the logical channel is closed. (Rel-4) Rel-6 - ...: O_LOG_CHANS
CR2 After the application has been terminated using a SELECT command
indicating in the command parameters that the application shall be terminated
(CR1b), the current DF shall be the MF and there shall be no current EF or
current application. Rel-6 - ...
* * *
Reference: TS 102.221 [1], subclause 8.5.3.
##### 6.5.5.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.5.5.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) If no other application than the USIM application exists in the UICC, steps
c), d) and e) shall not be carried out.
c) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
d) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate an application different from the selected USIM application.
e) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
> _The response data shall contain the following [CR1a]:_
>
> _\- TLV DO with tag \'84\' shall indicate an AID of the selected application
> different from the selected USIM application in step c)._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
c) The ME simulator shall send a SELECT command with AID to the UICC to select
and terminate the USIM application.
d) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
> _The response data shall not be that of the USIM application activated in
> step b) [CR1b]._
**Test procedure 3**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
c) The ME simulator shall send a SELECT command with AID to the UICC to select
and terminate the USIM application.
d) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
> _The response data shall be that of the MF [CR1b, CR2]._
e) The ME simulator shall send a READ BINARY command without SFI referencing
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'86\' - command not allowed (no EF selected) [CR1b, CR2]._
f) The ME simulator shall send a SELECT command with P1 = \'00\' and a data
field equal to \'7FFF\'.
_The UICC shall return an error appropriate to the command. (e.g. SW1 =
\'6A\', SW2 = \'82\' -- File not found). [CR1b, CR2]._
**Test procedure 4**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
c) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
> _The response data shall contain the following:_
>
> _\- TLV DO with tag \'84\' is the AID of the USIM application (DF name \-
> AID)._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a STATUS command with P2=\'00\' to the UICC.
> _The response data shall not be that of the USIM application activated in
> step b) [CR1c]._
**Test procedure 5**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC
> _The UICC shall return the channel number of the logical channel assigned by
> the UICC -- call this channel \'a\'_
c) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application on channel \'a\'.
d) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC
on channel \'a\'.
> _The response data shall contain the following:_
>
> _\- TLV DO with tag \'84\' is the AID of the USIM application (DF name \-
> AID)._
e) The ME simulator shall send a MANAGE CHANNEL (CLOSE) command to the UICC to
close channel \'a\'.
f) Repeat steps g) and h) for all non-basic logical channels.
g) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC
h) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC
on the logical channel assigned in the response to step g)
_The response data shall not be that of the USIM application activated in step
c) [CR1d]._
#### 6.5.5.4 Application session reset
##### 6.5.5.4.1 Definition and applicability
See clause 3.5.3.
##### 6.5.5.4.2 Conformance requirement
* * *
CR1 An application shall be reset if the application is reselected using the
SELECT command indicating in the command parameters that the application shall
be activated. M
* * *
Reference: TS 102.221 [1], subclause 8.5.4.
##### 6.5.5.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.5.5.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC with EF~LOCI~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a READ BINARY command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command._
f) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
> _The response data shall contain the following:_
>
> _\- TLV DO with tag \'84\' is the AID of the USIM application (DF name \-
> AID)._
g) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
_The status condition returned by the USIM shall be SW1 = \'90\', SW2 = \'00\'
[CR1]._
#### 6.5.5.5 GSM/USIM application interaction and restrictions
##### 6.5.5.5.1 Definition and applicability
See clause 3.5.3.
##### 6.5.5.5.2 Conformance requirement
* * *
CR1 Activation of a USIM session shall exclude the activation of a GSM
session. R99 - Rel-5 CR2 Once a USIM application session has been activated,
commands sent to the UICC with CLA byte set to \'A0\' shall return SW1SW2 \'6E
00\' (class not supported) to the ME. R99 - Rel-5 CR3 Activation of a GSM
session shall exclude the activation of a USIM session. R99 - Rel-5
* * *
Reference: TS 102.221 [16], subclause 8.5.5; TS 102.221 [17], subclause 8.5.5;
TS 102.221 [18], subclause 8.5.5.
##### 6.5.5.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR3 is not tested as it is out of the scope of the present document.
##### 6.5.5.5.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a STATUS command with \'A0\' as the class byte.
> _The status condition returned by the UICC shall be SW1 = \'6E\', SW2 =
> \'00\' -- class not supported [CR1, CR2]._
d) The ME simulator shall send a STATUS command with \'80\' as the class byte.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of a command [CR1]._
### 6.5.6 Reservation of file IDs
#### 6.5.6.1 Definition and applicability
See clause 3.5.3.
#### 6.5.6.2 Conformance requirement
+-----+------------------------------------------+-------------------+ | CR1 | The following Application Dedicated File | M | | | IDs shall be reserved for operational | | | | use by UICC: | | | | | | | | - \'7F FF\'. | | +-----+------------------------------------------+-------------------+ | CR2 | The following Dedicated File IDs shall | (R99) Rel-6 - ... | | | be reserved for operational use by UICC: | | | | | | | | - '7F10' (DF~TELECOM~), | | | | '7F20'(DF~GSM~), '7F21'(DF~DCS1800~), | | | | '7F22' (DF~IS-41~), '7F23'(DF~FP-CTS~), | | | | '7F24'(DF~TIA/EIA-136~), | | | | '7F25'(DF~TIA/EIA-95~) and '7F2X', where | | | | X ranges from '6' to 'F'. | | | | | | | | - '7F80' (DF~PDC~) is used for the | | | | Japanese PDC specification | | | | | | | | - '7F90' (DF~TETRA~) is used for the | | | | TETRA specification | | | | | | | | - \'7F31\' (DFiDEN) is used in the iDEN | | | | specification | | | | | | | | - reserved under '7F10'; | | | | '5F50'(DF~GRAPHICS~); | | | | '5F3A'(DF~PHONEBOOK~) | | +-----+------------------------------------------+-------------------+ | CR3 | The following Elementary File Ids shall | M | | | be reserved for operational use by UICC: | | | | | | | | - \'6F 2X\', \'6F 3X\', \'6F 4X\' in | | | | \'7F 10\' and \'7F 2X\'; | | | | | | | | - \'4F YX\', where Y ranges from \'2\' | | | | to \'F\' in all 2nd level DFs; | | | | | | | | - \'2F05\', \'2F06\' and \'2F 1X\' in | | | | the MF \'3F 00\'; | | | | | | | | - \'2F00\', \'2F01\' in the MF | | | | \'3F00\'. | | +-----+------------------------------------------+-------------------+ | CR4 | The following Dedicated File IDs shall | M | | | be reserved for administrative use by | | | | UICC: | | | | | | | | - \'7F 4X\', \'5F1X\' and \'5F2X\'. | | +-----+------------------------------------------+-------------------+ | CR5 | The following Elementary File Ids shall | M | | | be reserved for administrative use by | | | | UICC: | | | | | | | | - \'6F XX\' in the DFs \'7F 4X\'; \'4F | | | | XX\' in the DFs \'5F 1X\', \'5F2X\'; | | | | | | | | - \'6F 1X\' in the DFs \'7F 10\', \'7F | | | | 20\', \'7F 21\'; | | | | | | | | - \'4F 1X\' in all 2nd level DFs; | | | | | | | | - \'2F EX\' in the MF \'3F 00\'. | | +-----+------------------------------------------+-------------------+ | CR6 | The following Dedicated File IDs shall | R99 - Rel-5 | | | be reserved for operational use by UICC: | | | | | | | | \'5F50\', \'5F3A\', \'7F 10\', \'7F | | | | 2X\', \'7F 80\' and \'7F 90\'. | | +-----+------------------------------------------+-------------------+
Reference: TS 102.221 [1], subclause 8.6.
#### 6.5.6.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR4 and CR5 shall not be tested as the administrative functionality is
outside the scope of this test specification.
#### 6.5.6.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command using FID \'7F FF\' to the
UICC to select and activate USIM application.
> _The response data shall contain the following:_
>
> _\- TLV DO with tag \'84\' is the AID of the UICC (DF name - AID) shall be
> the same as in step b) [CR1]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) For all possible DFs and EFs on the UICC, the ME simulator shall send a
SELECT command to the UICC to select each file in sequence.
> _For all successful selections, the ID of the selected file shall be either
> that of EF~ATR~ or one of those in Figure 4.1 and Figure 4.2, subclause 4.7
> of TS 31.102 [3], or shall not be one of those listed as reserved for
> operational use in CR6 [CR6, CR3]._
**Test procedure 3**
a) The ME simulator shall reset the UICC.
b) For all possible DFs and EFs on the UICC, the ME simulator shall send a
SELECT command to the UICC to select each file in sequence.
> _For all successful selections, the ID of the selected file shall be either
> that of EF~ATR~ or one of those in Figure 4.1 and Figure 4.2, subclause 4.7
> of TS 31.102 [3], or shall not be one of those listed as reserved for
> operational use in CR2 [CR2, CR3]._
## 6.5.7 Logical channels
#### 6.5.7.1 No Logical Channel Support
6.5.7.1.1 Definition and applicability
See clause 3.5.3.
6.5.7.1.2 Conformance requirement
* * *
CR1 There may be up to 3 logical channels in addition to the basic logical
channel 0. (Rel-4) Rel-6 - ... CR2 A UICC which supports logical channels
indicates it in the ATR, together with the assignment methods and maximum
number of logical channels it supports. (Rel-4) Rel-6 - ...
* * *
Reference: TS 102 221 [1], subclause 8.7.
6.5.7.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
6.5.7.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC
_The UICC shall return a valid ATR._
_The following shall be true of the returned ATR:_
  * _The Third Software Function in the Card Capabilities Object shall not be present [CR1, CR2]_
> _Or_
  * _If the Third Software Function is present it shall indicate that the UICC does not support logical channels [CR1, CR2]_
b) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC.
_The UICC shall return an error code appropriate to the command. [CR2]_
c) The ME simulator shall send a STATUS command to the UICC on channel 1.
_The UICC shall return an error code appropriate to the command [CR2]_
d) The ME simulator shall send a STATUS command to the UICC on channel 2.
_The UICC shall return an error code appropriate to the command [CR2]_
e) The ME simulator shall send a STATUS command to the UICC on channel 3.
_The UICC shall return an error code appropriate to the command [CR2]_
#### 6.5.7.2 Logical Channels -- Basic Behaviour
6.5.7.2.1 Definition and applicability
See clause 3.5.3.
6.5.7.2.2 Conformance requirement
* * *
CR1 There may be up to 3 logical channels in addition to the basic logical
channel 0. (Rel-4) Rel-6 - ... CR2 Channel 0 is always available and open
throughout the card session. (Rel-4) Rel-6 - ... CR3 A UICC which supports
logical channels indicates it in the ATR, together with the assignment methods
and maximum number of logical channels it supports. (Rel-4) Rel-6 - ...:
O_LOG_CHANS CR4 The UICC supporting logical channels shall support at least
one channel in addition to the basic channel. (Rel-4) Rel-6 - ...: O_LOG_CHANS
CR5 The UICC supporting logical channels shall support logical channel number
assignment by the UICC. (Rel-4) Rel-6 - ...: O_LOG_CHANS CR6 There is no
interleaving of commands and their responses across logical channels; between
the receipt of the command APDU and the sending of the response APDU to that
command, only one logical channel is active. (Rel-4) Rel-6 - ...: O_LOG_CHANS
CR7 A logical channel is opened by using a MANAGE CHANNEL command, in which
the card assigns a channel number and returns it in the response. (Rel-4)
Rel-6 - ...: O_LOG_CHANS CR8 The logical channel remains open until it is
explicitly closed by a MANAGE CHANNEL command, or if the UICC is deactivated.
(Rel-4) Rel-6 - ...: O_LOG_CHANS
* * *
Reference: TS 102 221 [1], subclause 8.7.
6.5.7.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR7 shall not be tested as it is not possible to interleave commands
with current protocols.
6.5.7.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
_The UICC shall return a valid ATR sequence._
_The Third Software Function shall be present and it shall indicate that:_
  * _The UICC supports logical channels.[CR3]_
  * _The UICC supports logical channel number assignment by the card. [CR3]_
  * _The maximum number of logical channels supported is between 2 and 4. [CR3, CR1, CR4]_
b) The ME simulator shall send a MANAGE CHANNEL (CLOSE) command to the UICC to
close channel 0 (the basic channel).
_The UICC shall return an error code appropriate to the command [CR2]_
c) The ME simulator shall send a STATUS command to the UICC on the basic
channel.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command[CR2]_
d) The ME simulator shall send a STATUS command to the UICC on channel 1.
_The UICC shall return an error code appropriate to the command [CR7]_
e) The ME simulator shall send a STATUS command to the UICC on channel 2.
_The UICC shall return an error code appropriate to the command [CR7]_
f) The ME simulator shall send a STATUS command to the UICC on channel 3.
_The UICC shall return an error code appropriate to the command [CR7]_
g) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel
_The UICC shall return the number of the logical channel assigned by the UICC
[CR4, CR5, CR7]_
h) The ME simulator shall send a STATUS command to the UICC on the logical
channel assigned by the UICC in step g).
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command._
i) Steps g) and h) shall be repeated for each of the remaining non basic
logical channels supported by the UICC
j) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel
_The UICC shall return an error code appropriate to the command [CR1]_
k) The ME simulator shall send a MANAGE CHANNEL (CLOSE) command to the UICC on
the first open non-basic channel supported by the UICC.
_The status returned by the UICC shall be 90 00[CR8]_
l) The ME simulator shall send a STATUS command to the UICC on the same
logical channel used in step k).
_The UICC shall return an error code appropriate to the command._
m) Steps k) and l) should be repeated for each of the non basic logical
channels supported by the UICC.
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel.
_The UICC shall return the number of the logical channel assigned by the UICC
-- call this channel \'a\' [CR7]_
c) The ME simulator shall send a STATUS command to the UICC on channel \'a\'.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command._
d) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
channel \'a\'
_The UICC shall return the number of the logical channel assigned by the UICC
-- call this channel \'b\'. [CR5, CR7]_
e) The ME simulator shall send a STATUS command to the UICC on channel \'b\'.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command._
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a STATUS command to the UICC on channel \'a\'.
_The UICC shall return an error code appropriate to the command [CR8]._
#### 6.5.7.3 Opening a Logical Channel from the Basic Channel
6.5.7.3.1 Definition and applicability
See clause 3.5.3.
6.5.7.3.2 Conformance requirement
* * *
CR1 When the open function is performed from the basic channel, then after a
successful open, the MF shall be implicitly selected as the current DF.
(Rel-4) Rel-6 - ...: O_LOG_CHANS CR2 When the open function is performed from
the basic channel, no current EF is selected in the new logical channel.
(Rel-4) Rel-6 - ...: O_LOG_CHANS CR3 When the open function is performed from
the basic channel, then after a successful open, the ADF of the current active
application is undefined. (Rel-4) Rel-6 - ...: O_LOG_CHANS
* * *
Reference: TS 102 221 [1], subclause 8.7.
6.5.7.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
6.5.7.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~
d) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
e) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
_The value of the File Identifier in the response data shall be \'7F 10\'._
f) The ME simulator shall send a MANAGE CHANNEL (OPEN) to the UICC.
_The UICC shall return the channel number of the logical channel assigned by
the UICC -- call this channel \'a\'._
g) The ME Simulator shall send a STATUS command on channel \'a\' with P2 =
\'00\' to the UICC.
_The value of the File Identifier in the response data shall be \'3F 00\'
[CR1]_
h) The ME simulator shall send READ RECORD command using ABSOLUTE mode with
record 1 on channel \'a\'.
_The UICC shall return an error appropriate to the command. (e.g. SW1 =
\'69\', SW2 = \'86; - Command not allowed (no EF selected)). [CR2]_
i) The ME simulator shall send a SELECT command with P1 = \'00\' and a data
field equal to \'7FFF\' on channel \'a\'.
_The UICC shall return an error appropriate to the command. (e.g. SW1 =
\'6A\', SW2 = \'82\' -- File not found). [CR3]._
#### 6.5.7.4 Opening a Logical Channel from a Non-Basic Channel
6.5.7.4.1 Definition and applicability
See clause 3.5.3.
6.5.7.4.2 Conformance requirement
* * *
CR1 When the open function is performed from a logical channel which is not
the basic one, then after a successful open, the current DF of the logical
channel from which the command was issued shall be selected as the current DF.
(Rel-4) Rel-6 - ...: O_LOG_CHANS_34, O_SHAREABLE CR2 When the open function is
performed from a logical channel which is not the basic one, no current EF is
selected in the new logical channel. (Rel-4) Rel-6 - ...: O_LOG_CHANS_34,
O_SHAREABLE CR3 When the open function is performed from a logical channel
which is not the basic one, then after a successful open, the ADF of the
current active application of the logical channel from which the command was
issued shall be selected as the current active application. (Rel-4) Rel-6 -
...: O_LOG_CHANS_34, O_SHAREABLE
* * *
Reference: TS 102 221 [1], subclause 8.7.
6.5.7.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
6.5.7.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) The ME, DF~TELECOM~ and the USIM application shall be configured as
shareable.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME shall send a MANAGE CHANNEL (OPEN) command to the UICC from the
basic channel.
_The UICC shall return the assigned logical channel number -- call it \'a\'_
c) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on channel \'a\'.
d) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on channel \'a\'.
e) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
on channel \'a\'.
f) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
channel \'a\'.
_The UICC shall return the assigned logical channel number -- call it channel
\'b\'._
g) The ME simulator shall send a STATUS command to the UICC on channel \'b\'
_The returned FCP shall contain the File ID of DF~TELECOM~ [CR1]._
h) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on
channel \'b\'
_The UICC shall return an error -- no EF selected [CR2]._
i) The ME simulator shall send a SELECT command with P1 = \'00\' and a data
field equal to \'7FFF\' on channel \'b\'.
_The returned FCP shall contain the AID of the USIM [CR3]._
j) The ME simulator shall reset the UICC.
k) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on the basic channel.
l) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel.
_The UICC shall return the assigned logical channel number -- call it channel
\'a\'._
m) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICCC on
channel \'a\'.
_The UICC shall return the assigned logical channel number -- call it channel
\'b\'._
n) The ME simulator shall send a SELECT command with P1 = \'00\' and a data
field equal to \'7FFF\' on channel \'b\'.
_The UICC shall return an error appropriate to the command. [CR3]._
#### 6.5.7.5 Opening a Logical Channel on Non-Shareable Files
6.5.7.5.1 Definition and applicability
See clause 3.5.3.
6.5.7.5.2 Conformance requirement
* * *
CR1 If the MANAGE CHANNEL command is performed on a DF or ADF that is not
shareable, the card shall respond with a appropriate error message. The
response shall indicate that the command is not allowed. (Rel-4) Rel-6 - ...:
O_LOG_CHANS, O_NON_SHAREABLE CR2 If the MANAGE CHANNEL command is performed on
a DF or ADF that is not shareable no new channel is opened. (Rel-4) Rel-6 -
...: O_LOG_CHANS, O_NON_SHAREABLE
* * *
Reference: TS 102 221 [1], subclause 8.7.
6.5.7.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
6.5.7.5.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) The MF and the USIM application shall be configured as non-shareable.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel.
_The UICC shall return an error appropriate to the command. [CR1]_
c) The ME simulator shall send a STATUS command to the UICC on channel 1.
_The UICC shall return an error appropriate to the command. [CR2]_
d) The ME simulator shall send a STATUS command to the UICC on channel 2.
_The UICC shall return an error appropriate to the command. [CR2]_
e) The ME simulator shall send a STATUS command to the UICC on channel 3.
_The UICC shall return an error appropriate to the command. [CR2]_
f) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on the basic channel.
g) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel.
_The UICC shall return an error appropriate to the command. [CR1]_
h) The ME simulator shall send a STATUS command to the UICC on channel 1.
_The UICC shall return an error appropriate to the command. [CR2]_
i) The ME simulator shall send a STATUS command to the UICC on channel 2.
_The UICC shall return an error appropriate to the command. [CR2]_
j) The ME simulator shall send a STATUS command to the UICC on channel 3.
The UICC shall return an error appropriate to the command. [CR2]
#### 6.5.7.6 Logical Channels and Shareable Files
6.5.7.6.1 Definition and applicability
See clause 3.5.3.
6.5.7.6.2 Conformance requirement
* * *
CR1 In order to be accessed from several logical channels at the same time, a
given file (EF, DF, ADF) shall be indicated as \"shareable\" in its file
descriptor. (Rel-4) Rel-6 - ...: O_LOG_CHANS CR2 If a file is indicated as
shareable, then applications may perform authorized operations on the file
independently of whether or not the file is the current file of any other
application. Rel-6 - ...: O_LOG_CHANS, O_SHAREABLE CR3 If a file is indicated
as not-shareable and is the current file of one application, then another
application cannot perform any operation on the file regardless of
authorization. Access by any other application, including an attempt to select
the file, shall return the status word \'6985\' (Conditions of use not
satisfied). Rel-6 - ...: O_LOG_CHANS, O_NON_SHAREABLE
* * *
Reference: TS 102 221 [17], subclause 8.7; TS 102 221 [18], subclause 8.7; TS
102 221 [1], subclauses 8.7 and 8.8.
6.5.7.6.3 Test purpose
To verify that the UICC conforms to the above requirements.
6.5.7.6.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) For test procedure 1, EF~ARR~ (under the MF), DF~TELECOM~ and the USIM
shall be configured as non-shareable.
3) For test procedure 2, the MF, DF~TELECOM~, EF~ARR~ (under DF~TELECOM~) and
the USIM shall be configured as shareable.
**Test procedure 1 (non-shareable files)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on the basic channel.
c) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC on
the basic channel.
_The UICC should return the assigned logical channel number -- call it channel
\'a\'._
d) The ME simulator shall send a SELECT command to the UICC to select the MF
on the basic channel.
e) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
(under the MF) on the basic channel.
f) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
(under the MF) on channel \'a\'.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'85\'
-- Conditions of used not satisfied. [CR1, CR3]_
g) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on the basic channel.
h) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on channel \'a\'.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'85\'
-- Conditions of used not satisfied [CR1, CR3]_
i) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on the basic channel.
j) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on channel \'a\'.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'85\'
-- Conditions of used not satisfied.. [CR1, CR3]_
**Test procedure 2 (shareable files)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a MANAGE CHANNEL (OPEN) on the basic channel.
_The UICC should return the assigned logical channel number -- call it \'a\'
[CR1]_
c) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on the basic channel.
d) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
on the basic channel.
e) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on the
basic channel.
_The UICC shall return the contents of the first record in EF~ARR~._
f) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on channel \'a\'.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command. [CR1, CR2]_
g) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
on channel \'a\'.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command. [CR1, CR2]_
h) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on
channel \'a\'.
_The UICC shall return the contents of the first record in EF~ARR~. The data
received shall be the same as that received in step e) [CR1, CR2]._
i) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on the basic channel.
j) The ME simulator shall send a STATUS command to the UICC on the basic
channel.
_The FCP returned by the UICC shall contain the AID of the USIM._
k) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on channel \'a\'.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \' 00\' --
normal ending of the command. [CR1, CR2]_
l) The ME simulator shall send a STATUS command to the UICC on channel \'a\'.
_The FCP returned by the UICC shall contain the AID of the USIM [CR1, CR2]._
#### 6.5.7.7 Command Interdependencies
6.5.7.7.1 Definition and applicability
See clause 3.5.3.
6.5.7.7.2 Conformance requirement
* * *
CR1 Command interdependencies on one logical channel are independent of
command interdependencies on another logical channel. (Rel-4) Rel-6 - ...:
O_LOG_CHANS CR2 File access should be managed independently on each opened
logical channel. (Rel-4) Rel-6 - ...: O_LOG_CHANS CR3 In particular, a record-
based file shall have a different record pointer for each opened logical
channel. (Rel-4) Rel-6 - ...: O_LOG_CHANS, O_SHAREABLE CR4 Once a new channel
is opened, the current DF and the current file are independent per each
logical channel. (Rel-4) Rel-6 - ...: O_LOG_CHANS
* * *
Reference: TS 102 221 [1], subclauses 8.7 and 8.8.
6.5.7.7.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1 is a general conformance requirement that is tested when the other
CRs are tested.
6.5.7.7.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) DF~TELECOM~, EF~ARR~ (under DF~TELECOM~) , EF~FDN~ and the USIM shall be
configured as shareable.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on the basic channel.
c) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
on the basic channel.
d) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on the
basic channel
_The UICC shall return the contents of the first record in EF~ARR~._
e) The ME simulator shall send a MANAGE CHANNEL (OPEN) command on the basic
channel
_The UICC shall return the logical channel number assigned by the UICC \--
call this channel \'a\'._
f) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on channel \'a\'.
g) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
on channel \'a\'.
h) The ME simulator shall send a READ RECORD (CURRENT) command to the UICC on
the basic channel.
_The UICC shall return the contents of the first record in EFARR. The data
shall be the same as that received in step d).[CR2]_
i) The ME simulator shall send a SELECT command to the UICC to select EF~ADN~
on channel \'a\'.
j) The ME simulator shall send a READ RECORD (CURRENT) command to the UICC on
the basic channel.
_The UICC shall return the contents of the first record in EFARR. The data
shall be the same as that received in step d). [CR2, CR4]_
k) The ME simulator shall send a SELECT command to select the MF on channel
\'a\'.
l) The ME simulator shall send a STATUS command with P1 P2 = \'00 00\' to the
UICC on the basic channel.
_The FCP returned by the UICC shall contain the File Identifier of
DF~TELECOM.~ [CR4]_
m) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application on channel \'a\'.
n) The ME simulator shall send a STATUS command with P1 P2 = \'00 00\' to the
UICC on the basic channel.
_The FCP returned by the UICC shall contain the File Identifier of
DF~TELECOM.~ [CR4]_
o) The ME simulator shall send a SELECT command with P1 = \'00\' and the data
field equal to \'7FFF\' to the UICC on the basic channel.
_The UICC shall return an error appropriate to the command. [CR4]_
p) The ME simulator shall send a READ RECORD (CURRENT) command to the UICC on
the basic channel.
_The UICC shall return the contents of the first record in EFARR. The data
shall be the same as that received in step d)._
q) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM on the basic channel.
r) The ME simulator shall send a SELECT command to the UICC to deselect the
USIM on channel \'a\'.
s) The ME simulator shall send a STATUS command to the UICC on the basic
channel.
_The FCP returned by the UICC shall contain the AID of the USIM. [CR4]_
t) The ME simulator shall reset the UICC.
u) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~ on the basic channel.
v) The ME simulator shall send a MANAGE CHANNEL (OPEN) to the UICC on the
basic channel.
_The UICC shall return the logical channel number assigned by the UICC \--
call this channel \'a\'._
w) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~
on the basic channel.
x) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on the
basic channel.
y) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on
channel \'a\'.
_The UICC shall return an error appropriate to the command (e.g. 69 86 \--
Command not allowed (no EF selected)).[CR4]_
z) The ME simulator shall reset the UICC.
aa) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ access condition for EF~FDN~.
bb) The ME simulator shall send a MANAGE CHANNEL (OPEN) to the UICC.
_The UICC shall return the channel number of the logical channel assigned by
the UICC -- call this channel \'a\'._
cc) The ME simulator shall send a SELECT command to the UICC on the basic
channel to select and activate the USIM application.
dd) The ME simulator shall send a SELECT command to the UICC on the basic
channel to select EF~FDN~.
ee) The ME simulator shall send a SELECT command to the UICC on the channel
\'a\' to select and activate the USIM application.
ff) The ME simulator shall send a SELECT command to the UICC on channel \'a\'
to select EF~FDN~.
gg) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on
the basic channel.
_The first 10 bytes of the data string returned by the UICC shall be \'A0 A1
A2 B0 B1 B2 A0 A1 A2 A0\'._
hh) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on
channel \'a\'.
_The first 10 bytes of the data string returned by the UICC shall be \'A0 A1
A2 B0 B1 B2 A0 A1 A2 A0\'. [CR3]_
ii) The ME simulator shall send a READ RECORD (CURRENT) command to the UICC on
the basic channel.
_The first 10 bytes of the data string returned by the UICC shall be \'A0 A1
A2 B0 B1 B2 A0 A1 A2 A0\'._
jj) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on
channel \'a\'.
_The first 10 bytes of the data string returned by the UICC shall be \'B0 B1
B2 A0 A1 A2 A0 A1 A2 B0\'. [CR3]_
kk) The ME simulator shall send a READ RECORD (CURRENT) command to the UICC on
the basic channel.
_The first 10 bytes of the data string returned by the UICC shall be \'A0 A1
A2 B0 B1 B2 A0 A1 A2 A0\'. [CR3]_
#### 6.5.7.8 Consistency of File Updates
6.5.7.8.1 Definition and applicability
See clause 3.5.3.
6.5.7.8.2 Conformance requirement
* * *
CR1 Applications are responsible for keeping data consistency (in the card and
the terminal) when accessing the same file from different logical channels.
Note that special attention should be given to cyclic files, e.g. when the
file is read in one channel and updated in the other. (Rel-4) Rel-6 - ...:
O_LOG_CHANS, O_SHAREABLE
* * *
Reference: TS 102 221 [1], subclause 8.7.
6.5.7.8.3 Test purpose
To verify that the UICC conforms to the above requirements.
6.5.7.8.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~LOCI~ shall be shareable
3) EF~CCP2~ shall be shareable
**Test Procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
c) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC.
_The UICC shall return the assigned logical channel number -- call this
channel \'a\'_
d) The ME simulator shall send a SELECT command to the UICC on the basic
channel to select and activate the USIM.
e) The ME simulator shall send a SELECT command to the UICC on the basic
channel to select EF~CCP2~.
f) The ME simulator shall send a SELECT command to the UICC on channel \'a\'
to select and activate the USIM.
g) The ME simulator shall send a SELECT command to the UICC on channel \'a\'
to select EF~CCP2~.
h) The ME simulator shall send a READ RECORD (NEXT) command to the UICC on the
basic channel
_The data string returned by the UICC shall be the contents of the first
record in EF~CCP2~ i.e. \'10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E\'._
i) The ME simulator shall send a READ RECORD (NEXT) to the UICC on channel
\'a\'.
_The data string returned by the UICC shall be the contents of the first
record in EF~CCP2~ i.e. \'10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E\'._
j) The ME simulator shall send an UPDATE RECORD (CURRENT) command to the UICC
on channel \'a\' using a data string of \'C1 C1 C1 C1 C1 C1 C1 C1 C1 C1 C1 C1
C1 C1 C1 \'.
k) The ME simulator shall send a READ RECORD (CURRENT) command to the UICC on
the basic channel.
_The data string returned by the UICC shall be \'_ _C1 C1 C1 C1 C1 C1 C1 C1 C1
C1 C1 C1 C1 C1 C1\'. [CR1]_
l) The ME simulator shall send a SELECT command to the UICC to select EF~LOCI~
on the basic channel.
m) The ME simulator shall send a SELECT command to the UICC to select EF~LOCI~
on channel \'a\'.
n) The ME simulator shall send a READ BINARY command to the UICC on the basic
channel using a length of 11 bytes.
_The data string returned by the UICC shall be \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'._
o) The ME simulator shall send a READ BINARY command to the UICC on channel
\'a\' using a length of 11 bytes.
_The data string returned by the UICC shall be \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'._
p) The ME simulator shall send an UPDATE BINARY command to the UICC on channel
\'a\' using a data string of \'FF FF FF FF FF FF FF FF FF 00 00\'.
q) The ME simulator shall send a READ BINARY command to the UICC on the basic
channel using a length of 11 bytes.
The data string returned by the UICC shall be \' FF FF FF FF FF FF FF FF FF 00
00\' [CR1].
## 6.6 Security features
Two types of UICC are defined in TS 102.221 [1], single verification capable
UICC and multi-verification capable UICC. Every application shall conform to
the security features defined in TS 102.221 [1].
### 6.6.1 Supported security features
#### 6.6.1.1 Definition and applicability
See clause 3.5.3.
#### 6.6.1.2 Conformance requirement
**For a multi-verification capable UICC**
* * *
CR1 The UICC shall support more than one level 1 user verification requirement
(PIN). O_MULTI_VER CR2 The UICC shall support the use of a universal PIN.
O_MULTI_VER CR3 The UICC shall have a level 2 user verification requirement
(PIN2) on the application level, if assigned. O_MULTI_VER CR4 The UICC shall
support access rules defined in security attributes indicated in tag \'8B\'
(i.e. referenced to expanded format). O_MULTI_VER CR5 The UICC shall support
one level 1 user verification requirement (PIN) as defined in table 9.3 in TS
102.221 [1]. O_SINGLE_VER CR6 The UICC shall have a level 2 user verification
requirement (PIN2) on the application level, if assigned. O_SINGLE_VER
* * *
Reference: TS 102.221 [1], subclause 9.1.
#### 6.6.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 6.6.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The following shall be true for PS Template DO (tag \'C6\') in the response
> data:_
  * _TLV DO with tag \'83\' shall be \'11\' (Universal PIN) [CR2];_
```{=html}
``` \- _TLV DO with tag \'83\' shall be \'01\' (PIN Application 1) > [CR1];_
```{=html}
``` \- _TLV DO with tag \'83\' shall be \'81\' (Second PIN Application 1) >
[CR3], if assigned;_
> _The response data shall also contain TLV DO with tag \'8B\' [CR4]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The following shall be true for PS Template DO (tag \'C6\') in the response
> data:_
>
> _\- TLV DO with tag \'83\' shall be \'01\' (PIN) [CR5];_
>
> _\- TLV DO with tag \'83\' shall be \'81\' (PIN2) [CR6], if assigned._
c) Step b) shall be repeated for all the other USIM applications in the UICC.
### 6.6.2 Security architecture
#### 6.6.2.1 Definition and applicability
See clause 3.5.3.
#### 6.6.2.2 Conformance requirement
+-----+------------------------------------------+-------------------+ | CR1 | The security architecture shall contain | M | | | the following: | | | | | | | | a) security attributes as part of the | | | | DF/EF FCP using tag \'8B\', tag \'8C\' | | | | or tag \'AB\'; | | | | | | | | b) access mode data object (AM_DO) | | | | defining for which group/type of | | | | command(s) the security condition apply; | | | | | | | | c) security condition data object | | | | (SC_DO) indicating which security | | | | related procedures (user PIN | | | | verification) shall be satisfied before | | | | a command may be performed on a file; | | | | | | | | d) access rule shall be stored in the | | | | EF~ARR~ which may be shared between | | | | files in the UICC. | | +-----+------------------------------------------+-------------------+ | CR2 | In order to perform commands other than | M | | | SELECT and STATUS/GET RESPONSE the | | | | security condition for the file shall be | | | | met. | | +-----+------------------------------------------+-------------------+ | CR3 | The content of each AM byte (in compact | M | | | format) or AM_DO (in expanded format) | | | | shall be unique within the same access | | | | rule. | | +-----+------------------------------------------+-------------------+ | CR4 | SC_DOs OR and AND relations shall | M | | | contain at least two access conditions. | | +-----+------------------------------------------+-------------------+ | CR5 | If the UICC can not determine the access | (R99) Rel-6 - ... | | | condition for the requested access to a | | | | file, then the requested access to this | | | | file shall not be granted and the card | | | | shall return an error Status Word '6982' | | | | (Security status not satisfied). | | +-----+------------------------------------------+-------------------+ | CR6 | If the UICC implements referenced access | (R99) Rel-6 - ... | | | rules and EFarr is referenced by file ID | | | | then the following is applicable: | | | | | | | | When searching for the access rules for | | | | an EF, if the EF(ARR) file with the file | | | | ID indicated in tag \'8B\' can not be | | | | found in the current DF, the parent DF | | | | shall be searched for EF(ARR). This | | | | process shall continue until the EF(ARR) | | | | is found or until an ADF or the MF is | | | | reached. | | | | | | | | **When searching for the access rules | | | | for a DF, if the EF(ARR) file with the | | | | file ID indicated in tag \'8B\' cannot | | | | be found in the parent DF, the | | | | grandparent DF shall be searched for | | | | EF(ARR). This process shall continue | | | | until the EF(ARR) is found or until an | | | | ADF or the MF is reached.** | | | | | | | | for the MF or an ADF, the EF(ARR) file | | | | with the file ID indicated in tag \'8B\' | | | | shall be searched under the MF. | | +-----+------------------------------------------+-------------------+ | CR7 | An application with multiple Security | (R99) Rel-6 - ... | | | Environments shall specify SEID when | | | | referencing access rules. | | +-----+------------------------------------------+-------------------+
Reference: TS 102.221 [1], subclause 9.2.
#### 6.6.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR2 is tested in the subclause 6.8.1.
NOTE 2: CR6 and CR7 are not tested.
#### 6.6.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
> _The response data shall contain either TLV DO with tag \'8B\', \'8C\' or
> \'AB\' [CR1a]._
>
> _If the TLV DO with tag \'8B\' is present, the structure shall be the same
> as stated in subclause 9.2.7of TS 102.221 [1] and the AM_DO and SC_DO shall
> be stored in EF~ARR~ [CR1d]._
>
> _If the TLV DO with tag \'8C\' is present, the AM_DO and SC_DO shall be in a
> compact format according to ISO/IEC 7816‑4 [7] [CR1b, CR1c]._
>
> _If the TLV DO with tag \'AB\' is present, the AM_DO and SC_DO shall be in
> an expanded format according to ISO/IEC 7816‑4 [7] [CR1b, CR1c]._
d) The ME simulator shall send a SELECT command to select EF~ARR~ if the TLV
DO with tag \'8B\' is present in the response data returned in step b) [CR1d].
e) The ME simulator shall send a READ RECORD command to read record 1 of
EF~ARR~.
> _The response data shall contain the AM_DO and SC_DO in an expanded format
> according to ISO/IEC 7816‑4 [7][CR1b, CR1c, CR4]._
f) Step e) shall be repeated for all the records in EF~ARR~ [CR1d].
> _The content of each AM byte (in compact format) or AM_DO (in expanded
> format) shall be unique within the same access rule [CR3]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to select EF~ICCID~.
> If the TLV DO with tag \'8B\' is present in the response data returned in
> step b) the following steps shall be carried out:
c) The ME simulator shall send a SELECT command to select EF~ARR~.
d) The ME simulator shall send a VERIFY PIN command using ADM to the UICC.
e) The ME simulator shall send a READ RECORD command to determine the access
rules specified in the record number specified by tag '8B' of the response
data retured in step b).
f) The ME simulator shall send a UPDATE RECORD command to modify the record
number specified in tag '8B' of the response data returned in step b) so as to
remove the READ access condition.
g) The ME simulator shall send a SELECT command to select EF~ICCID~.
h) The ME simulator shall send a READ BINARY command to the UICC.
The response data returned by the UICC shall be SW1 = \'69\', SW2 = \'82\' --
security status not satisfied [CR5].
i) The ME simulator shall send a SELECT command to select EF~ARR~.
j) The ME simulator shall send a UPDATE RECORD command to modify the record
number specified in tag '8B' so as to return it to the value prior to step c).
### 6.6.3 Security environment
#### 6.6.3.1 Definition and applicability
See clause 3.5.3.
#### 6.6.3.2 Conformance requirement
* * *
CR1 SE01 (default SE) and SE00 (no authentication method required) are
defined. O_MULTI_VER CR2 When the SE00 is active, Universal PIN shall be used
if known and enabled, otherwise no PIN shall be used. O_MULTI_VER CR3 When the
SE00 is active, Application PIN shall be disabled. O_MULTI_VER CR4 When the
SE01 is active, Application PIN shall be used if enabled, otherwise no PIN
shall be used. O_MULTI_VER CR5 A multi-verification capable UICC shall support
the use of SE00 and SE01 in order to allow application verification
requirement to be replaced by the Universal PIN. O_MULTI_VER CR6 The PIN shall
map to the SE ID according to table 9.1 of the TS 102.221 [1]. O_MULTI_VER CR7
The UICC shall have Security Environment SE00 active when no application is
active on a given logical channel and at least one of the application PINs is
disabled except for the case(s) where the Universal PIN is enabled but the
default usage qualifier is set to \"do not use\" otherwise Security SE01 shall
be active. (R99) Rel-6 - ...: O_MULTI_VER CR8 The Security Environment on a
logical channel opened from the basic logical channel shall be as the Security
Environment on the basic logical channel after ATR. (R99) Rel-6 - ...:
O_MULTI_VER CR9 The Security Environment on a logical channel opened from a
non basic logical channel shall be as the Security Environment from the non
basic logical channel from which the open was performed. (R99) Rel-6 - ...:
O_MULTI_VER
* * *
Reference: TS 102.221 [1], subclause 9.3.1.
#### 6.6.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR7 is not tested.
NOTE 2: CR8 is not tested.
NOTE 3: CR9 is not tested.
#### 6.6.3.4 Method of test
NOTE: The following test procedures shall be applicable only to a multi-
verification capable UICC.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) SE01 shall be active.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
c) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The following shall be true of the response data:_
  * _TLV DO with tag \'90\' (PIN Status) under TLV DO with tag \'C6\' > shall indicate that the Application PINs and the Universal PIN are > enabled;_
```{=html}
``` \- _TLV DO with tag \'8B\' shall be as follows:_
* * *
EF~ARR~ FID SE ID1 Record No X SE ID2 Record No Y
* * *
> _where - SE ID1 and SE ID2 can be either 00 or 01, but SE ID1 shall not be
> the same as SE ID2._
>
> _\- Record No X and Y are the record number of the EF~ARR.~ [CR1]._
d) The ME simulator shall send a READ RECORD command to read the record number
X of EFARR [CR4].
> _If SE ID1 is 00, either one of the following shall be true of the response
> data:_
  * _The TLV_DO with tag \'83\' in the SC_DO shall be \'11\';_
```{=html}
``` \- _The SC_DO shall be \'90 00\'._
> _If SE ID1 is 01, either one of the following shall be true of the response
> data:_
>
> _\- The TLV_DO with tag \'83\' in the SC_DO shall be \'01\';_
>
> _\- The SC_DO shall be \'90 00\'._
e) Step d) shall be repeated for record number Y for SE ID2 [CR4].
f) If the TLV_DO with tag 83 is \'01\' for SE01, steps f) to v shall be
carried out.
g) The ME simulator shall send a SELECT command to the UICC to select EFICCID.
h) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR6]._
i) The ME simulator shall send a SELECT command to the UICC to select EFIMSI
under ADFUSIM.
j) The ME simulator shall send a READ BINARY command to the UICC.
_The response data returned by the UICC shall be SW1 = \'69\', SW2 = \'82\' --
security status not satisfied._
k) The ME simulator shall send a VERIFY PIN command using Universal PIN to the
UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR4]._
l) The ME simulator shall send a READ BINARY command to the UICC.
_The response data returned by the UICC shall be SW1 = \'69\', SW2 = \'82\' --
security status not satisfied._
m) The ME simulator shall send a VERIFY PIN command using PIN Application 1 to
the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR4]._
n) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR4, CR6]._
o) The ME simulator shall send a DISABLE PIN command to disable the PIN
Application 1 to the UICC.
p) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The following shall be true of the response data:_
  * _TLV DO with tag \'90\' (PIN Status) under TLV DO with tag \'C6\' > shall indicate that the PIN Application 1 is disabled, and the > Universal PIN is enabled and its Usage Qualifier is set to > \'00\'._
q) The ME simulator shall send a SELECT command to the UICC to select EFICCID.
r) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR6]._
s) The ME simulator shall send a SELECT command to the UICC to select EFIMSI
under ADFUSIM.
t) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR4, CR6]._
u) The ME simulator shall send an ENABLE PIN command to enable the PIN
Application 1 to the UICC.
v) The ME simulator shall send a DISABLE PIN command to disable and indicate
the Universal PIN as a replacement of the PIN Application 1 to the UICC [CR5].
> w) The ME simulator shall reset the UICC.
x) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The following shall be true of the response data:_
  * _TLV DO with tag \'90\' (PIN Status) under TLV DO with tag \'C6\' > shall indicate that the PIN Application 1 is disabled and the > Universal Pin is enabled [CR2, CR3]._
y) If the TLV_DO with tag 83 is \'11\' for SE00, steps z to mm) shall be
carried out.
z) The ME simulator shall send a SELECT command to the UICC to select EFICCID.
aa) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR6]._
bb) The ME simulator shall send a SELECT command to the UICC to select EFIMSI
under ADFUSIM.
cc) The ME simulator shall send a READ BINARY command to the UICC.
_The response data returned by the UICC shall be SW1 = \'69\', SW2 = \'82\' --
security status not satisfied._
dd) The ME simulator shall send a VERIFY PIN command using PIN Application 1
to the UICC.
_The response data returned by the UICC shall indicate an error._
ee) The ME simulator shall send a VERIFY PIN command using Universal PIN to
the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR2]._
ff) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR2, CR6]._
gg) The ME simulator shall send a DISABLE PIN command to disable the Universal
PIN to the UICC.
hh) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The following shall be true of the response data:_
  * _TLV DO with tag \'90\' (PIN Status) under TLV DO with tag \'C6\' > shall indicate that the PIN Application 1 and the Universal Pin > are disabled._
ii) The ME simulator shall send a SELECT command to the UICC to select
EFICCID.
jj) The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR6]._
kk) The ME simulator shall send a SELECT command to the UICC to select EFIMSI
under ADFUSIM.
ll The ME simulator shall send a READ BINARY command to the UICC.
> _The response data returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
> -- normal ending of the command [CR2, CR6]._
mm) The ME simulator shall send an ENABLE PIN command to enable the Universal
PIN to the UICC.
nn) The ME simulator shall send an ENABLE PIN command to enable the PIN
Application 1 to the UICC.
### 6.6.4 PIN definitions
#### 6.6.4.1 Definition and applicability
See clause 3.5.3.
#### 6.6.4.2 Conformance requirement
* * *
CR1 A multi-verification capable UICC shall support the usage of Universal
PIN. O_MULTI_VER CR2 The key reference value \'11\' shall only be reserved for
Universal PIN. O_MULTI_VER CR3 The Universal PIN shall be part of the access
condition for each USIM application that allows it on a multi-verification
capable UICC. O_MULTI_VER CR4 In case of a single verification capable UICC
the Universal PIN shall not be used. O_SINGLE_VER CR5 An application PIN shall
be used based on which application it is assigned. M CR6 A local PIN shall
only be valid within the ADF/DF where it is defined. M CR7 The verification
status of the Universal PIN shall be unaffected by application activation and
termination procedures. (R99) Rel-6 - ...: O_MULTI_VER CR8 A PIN's status
shall be independent of logical channels. That is to say a change to a PIN's
state on one logical channel is reflected in that PIN's state on all logical
channels. (R99) Rel-6 - ...
* * *
Reference: TS 102.221 [1], subclause 9.4.
#### 6.6.4.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR3 is tested in subclause 6.6.3.
NOTE 2: CR6 is not fully tested.
NOTE 3: CR7 is not tested.
NOTE 4: CR8 is tested in sub clauses 6.8.1.9, 6.8.1.10 and 6.8.1.13.
#### 6.6.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
```{=html}
``` 2) For test procedure 1 and test procedure 2, SE01 shall be active.
    **Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The response data shall contain PS Template DO with tag \'C6\'._
>
> _The following shall be true of the PS Template DO:_
>
> _\- One of the TLV DO with tag \'83\' shall be \'11\' indicating the key
> reference value for Universal PIN [CR1, CR2];_
>
> _\- One of the TLV DO with tag \'83\' shall be \'01\' indicating the key
> reference value for PIN Application 1 [CR5];_
  * _One of the TLV DO with tag \'83\' shall be \'81\' indicating the key reference value for second Application/local PIN [CR6]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The response data shall contain PS Template DO with tag \'C6\'._
>
> _The following shall be true of the PS Template DO:_
>
> _\- One of the TLV DO with tag \'83\' shall be \'11\' indicating the key
> reference value for Universal PIN [CR1, CR2];_
>
> _\- One of the TLV DO with tag \'83\' shall be \'01\' indicating the key
> reference value for PIN Application 1 [CR5];_
  * _One of the TLV DO with tag \'83\' shall be \'81\' indicating the key reference value for second Application/local PIN [CR6]._
c) Step b) shall be repeated for the remaining ADF~USIM~s and DFs.
**Test procedure 3**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The response data shall contain PS Template DO with tag \'C6\'._
>
> _The following shall be true of the PS Template DO:_
>
> _\- Any of the TLV DO with tag \'83\' shall not be \'11\' indicating the key
> reference value for Universal PIN [CR4];_
>
> _\- One of the TLV DO with tag \'83\' shall be \'01\' indicating the key
> reference value for PIN Application 1 [CR5];_
>
> _\- One of the TLV DO with tag \'83\' shall be \'81\' indicating the key
> reference value for second Application/local PIN [CR6]._
### 6.6.5 PIN and key reference relationship
#### 6.6.5.1 Definition and applicability
See clause 3.5.3.
#### 6.6.5.2 Conformance requirement
* * *
CR1 For access condition ALWAYS, the command shall be performed without any
restriction. M CR2 For access condition PIN, the command shall only be
possible if the relevant application PIN is verified successfully. M CR3 For
access condition Second PIN, the command shall only be possible if the
relevant application PIN2 is verified successfully. M CR4 For access condition
NEVER, the command shall not be possible over the UICC/ME interface. M CR5 The
status of a PIN shall be stored in the PS Template DO with tag \'C6\' and
shall be indicated in the FCP in a response to the SELECT or STATUS command
issued at the application/DF level. M CR6 The Universal PIN shall not be part
of the PS Template DO in the single verification capable UICC. M
* * *
Reference: TS 102.221 [1], subclause 9.5.
#### 6.6.5.3 Test purpose
To verify that the UICC conforms to the above requirements.
> NOTE: Allocation of ADM levels and the respective requirements for their
> fulfilment are the responsibility of the appropriate administrative
> authority.
#### 6.6.5.4 Method of test
NOTE: When EF~FDN~ is not supported by the UICC, any supported linear EF in
ADF~USIM~ may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) The records in EF~FDN~ shall contain the following data for the first 10
bytes:
* * *
**1st record** \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\' **2nd record** \'B0 B1 B2 A0
A1 A2 A0 A1 A2 B0\' **3rd record** \'B0 B1 B2 A0 A1 A2 B0 B1 B2 A0\' **4th
record** \'A0 A1 A2 B0 B1 B2 B0 B1 B2 B0\'
* * *
3) The data for the remainder of these four records and for all other records
(if any) shall be \'FF\'.
**For a multi-verification capable UICC**
4) SE01 shall be active.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The response data shall indicate the PS Template DO with tag \'C6\' [CR5]._
>
> _The PS Template DO with tag \'C6\' shall contain for the Universal PIN the
> TLV DO with tag \'95\' indicating the usage qualifier [CR6]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a STATUS command to the UICC.
> _The response data shall indicate the PS Template DO with tag \'C6\' [CR5]._
>
> _The PS Template DO with tag \'C6\' shall contain for the Universal PIN the
> TLV DO with tag \'95\' indicating the usage qualifier [CR6]._
d) The ME simulator shall send a SELECT command to the UICC to select EF~FDN~.
> _The response data shall not contain the PS Template DO with tag \'C6\'
> [CR5]._
e) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR2]._
f) The ME simulator shall gain PIN Application 1 security access.
g) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The data string returned shall be \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\'. The
> data for the remainder of the returned data string shall be \'FF\'._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
h) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'B0\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR3]._
i) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC to read the first record in EF~FDN~.
> _The data string returned shall be \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\'. The
> data for the remainder of the returned data string shall be \'FF\'._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
j) The ME simulator shall gain the second PIN Application 2 security access.
k) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'B1\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
l) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The data string returned shall be \'B1\' for all bytes._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
m) The ME simulator shall send a SELECT command to the UICC to select MF.
n) The ME simulator shall send a SELECT command to the UICC to select
EF~ICCID~.
o) The ME simulator shall send a READ BINARY command to the UICC to read the
byte in the EF~ICCID~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
p) The ME simulator shall send an UPDATE BINARY command to the UICC to update
the byte in EF~ICCID~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR4]._
>
> q) The ME simulator shall send a SELECT command to the UICC to select and
> activate USIM application.
r) The ME simulator shall send a DISABLE PIN command to disable and indicate
the Universal PIN as a replacement of the PIN Application 1 to the UICC.
s) The ME simulator shall send a SELECT command to the UICC to select EF~FDN~.
t) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR2]._
u) The ME simulator shall gain Universal PIN security access.
v) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC to read the first record in EF~FDN~.
> _The data string returned shall be \'B1\' for all bytes._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
w) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'B2\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR3]._
x) The ME simulator shall gain the second PIN Application 2 security access.
y) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'B3\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
>
> z) The ME simulator shall send an ENABLE PIN command to enable PIN
> Application 1 to the UICC.
aa) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
bb) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR2]._
cc) The ME simulator shall gain PIN Application 1 security access.
dd) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The data string returned shall be \'B3\' for all bytes._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
ee) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'B4\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR3]._
ff) The ME simulator shall gain the second PIN Application 2 security access.
gg) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\' to the UICC to update
record in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
> _The response data shall indicate the PS Template DO with tag \'C6\' [CR5]._
>
> _The PS Template DO with tag \'C6\' shall not contain the Universal PIN key
> reference \'11\' [CR6]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a STATUS command to the UICC.
> _The response data shall indicate the PS Template DO with tag \'C6\' [CR5]._
>
> _The PS Template DO with tag \'C6\' shall not contain the Universal PIN key
> reference \'11\' [CR6]._
d) The ME simulator shall send a SELECT command to the UICC to select EF~FDN~.
> _The response data shall not contain the PS Template DO with tag \'C6\'
> [CR5]._
e) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR2]._
f) The ME simulator shall gain PIN security access.
g) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The data string returned shall be \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\'. The
> data for the remainder of the returned data string shall be \'FF\'._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
h) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'C0\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR3]._
i) The ME simulator shall gain the PIN2 security access.
j) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'C1\' for all bytes to the UICC to update the first record
in EF~FDN~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
k) The ME simulator shall send a READ RECORD command to the UICC to read the
first record in EF~FDN~.
> _The data string returned shall be \'C1\' for all bytes._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
l) The ME simulator shall send an UPDATE RECORD command using CURRENT mode
with data string \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\' to the UICC to update
record in EF~FDN~.
m) The ME simulator shall send a SELECT command to the UICC to select MF.
n) The ME simulator shall send a SELECT command to the UICC to select
EF~ICCID~.
o) The ME simulator shall send a READ BINARY command to the UICC to read the
byte in the EF~ICCID~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
p) The ME simulator shall send an UPDATE BINARY command to the UICC to update
the byte in EF~ICCID~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR4]._
## 6.7 Structure of commands and responses
The tests in this subclause ensure that the IUT conforms to the specification
for the mapping of functions onto Application Protocol Data Units (APDUs)
which are used by the transmission protocol.
### 6.7.1 Mapping principles
#### 6.7.1.1 Definition and applicability
See clause 3.5.3.
#### 6.7.1.2 Conformance requirement
* * *
CR1 The command APDU shall have format (CLA, INS, P1, P2 {, Lc, Data}{, Le}).
M CR2 The response APDU shall have format ({data,} SW1, SW2). M CR3 The class
\'8X\' and \'0X\' shall be accepted by the UICC with USIM application. M CR4
If the card supports the logical channel mechanism, the maximum number of
available logical channels is indicated in the card capabilities data object
of historical bytes of an ATR. Rel-4 - ...: O_LOG_CHANS
* * *
Reference: TS 102.221, subclause 10.1 and 10.2.
#### 6.7.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR4 is tested in subclause 6.5.7.
#### 6.7.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
Test procedure 1
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select MF with
P2 = \'04\'.\ [Bytes sent: CLA = \'00\', INS = \'A4\', P1 = \'00\', P2 =
\'04\', Lc = \'02\', data = \'3F 00\', Le = \'00\' (Case 4)]\ [Bytes received:
data, SW1, SW2]
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1, CR2, CR3]._
c) The ME simulator shall send a SELECT command to the UICC to select MF with
P2 = \'0C\'.\ [Bytes sent: CLA = \'00\', INS = \'A4\', P1 = \'00\', P2 =
\'0C\', Lc = \'02\', data = \'3F 00\' (Case 3)]\ [Bytes received: SW1, SW2]
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1, CR2, CR3]._
d) The ME simulator shall send a STATUS command to the UICC with P2 = \'00\'.\
[Bytes sent: CLA = \'80\', INS = \'F2\', P1 = \'00\', P2 = \'00\', Le = \'00\'
(Case 2)]\ [Bytes received: data, SW1, SW2]
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1, CR2, CR3]._
e) The ME simulator shall send a STATUS command to the UICC.\ [Bytes sent: CLA
= \'80\', INS = \'F2\', P1 = \'00\', P2 = \'0C\' (Case 1)]\ [Bytes received:
SW1, SW2]
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1, CR2, CR3]._
### 6.7.2 Response APDU Structure
#### 6.7.2.1 Status Conditions Returned by the UICC
##### 6.7.2.1.1 Definition and applicability
See clause 3.5.3.
##### 6.7.2.1.2 Conformance requirement
* * *
CR1 The UICC shall respond with the appropriate SW1 and SW2 status words for
commands which are correctly executed. M CR2 The UICC shall respond with the
appropriate SW1 and SW2 status words for commands which produce warnings. M
CR3 The UICC shall respond with the appropriate SW1 and SW2 status words for
commands which produce execution errors. M CR4 The UICC shall respond with the
appropriate SW1 and SW2 status words for commands which produce checking
errors. M CR5 The UICC shall respond with the appropriate SW1 and SW2 status
words for commands which produce application errors. M
* * *
Reference: TS 102.221 [1], subclause 10.2.1.
##### 6.7.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements when issuing SW1
and SW2 status words.
NOTE 1: CR3 is not tested as it is not possible to force a UICC to produce an
execution error.
NOTE 2: CR5 is tested in subclause 6.8.1.8.
##### 6.7.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
d) The ME simulator shall send a READ BINARY command without SFI referencing
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'86\' - command not allowed (no EF selected) [CR4]._
e) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
f) The ME simulator shall send a READ BINARY command with P2 = \'0F\' to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' - wrong parameter(s) P1-P2, or SW1 = \'6A\', SW2 = \'86\' \--
> incorrect_ _parameters P1-P2 [CR4]._
g) The ME simulator shall send a SELECT command to the UICC to select EF~ECC~.
h) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
i) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' - record not found [CR4]._
j) The ME simulator shall send a READ BINARY command using a length of 1 byte
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'81\' -- command incompatible with file structure [CR4]._
k) The ME simulator shall send a SELECT command to the UICC to select EF~LOCI~
with Lc = 1.
> _The status condition returned by the UICC shall be SW1 = \'67\', SW2 =
> \'00\' - wrong length, or SW1 = \'6A\', SW2 = \'87\' -- Lc inconsistent with
> P1 - P2 [CR4]._
l) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' -- security status not satisfied [CR2]._
m) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' -- security status not satisfied [CR2]._
n) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' -- security status not satisfied [CR2]._
o) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' -- authentication method blocked [CR4]._
p) The ME simulator shall send an UNBLOCK PIN command with Unblock PIN to the
UICC.
q) The ME simulator shall send a READ RECORD command using P2 = \'01\' to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'6B\', SW2 =
> \'00\' -- wrong parameter(s) P1 - P2, or SW1 = \'6A\', SW2 = \'86\' -
> incorrect parameter P1 or P2 [CR4]._
r) The ME simulator shall send the following APDU to the UICC.\ [Bytes sent:
CLA = \'00\', INS = \'6F\', P1 = \'00\', P2 = \'00\', P3 = \'00\']
> _The status condition returned by the UICC shall be SW1 = \'6D\', SW2 =
> \'00\' - instruction code not supported or invalid [CR4]._
s) The ME simulator shall send a GET RESPONSE command to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6F\', SW2 =
> \'00\' - technical problem, no precise diagnosis [CR4]._
t) The ME simulator shall send the following APDU to the UICC.\ [Bytes sent:
CLA = \'30\', INS = \'C0\', P1 = \'00\', P2 = \'00\', P3 = \'00\']
> _The status condition returned by the UICC shall be SW1 = \'6E\', SW2 =
> \'00\' -- class not supported [CR4]._
u) The ME simulator shall send a STATUS command with CLA = \'81\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'68\', SW2 =
> \'81\' -- logical channel not supported or SW1 = \'6E\', SW2 = \'00 \' --
> class not supported [CR4]._
v) The ME simulator shall send a STATUS command with CLA = \'84\' to the
UICC.\ [Bytes sent: CLA = \'84\', INS = \'F2\', P1 = \'00\', P2 = \'00\', Le =
\'02\']
> _The status condition returned by the UICC shall be SW1 = \'68\', SW2 =
> \'82\' -- secure messaging not supported or SW1 = \'6E\', SW2 = \'00 \' --
> class not supported [CR4]._
w) The ME simulator shall reset the UICC.
x) The ME simulator shall send a SELECT command with an incorrect file ID to
the UICC.\ [Bytes sent: CLA = \'00\', INS = \'A4\', P1 = \'00\', P2 = \'04\',
Lc = \'02\', data = \'12 34\']
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'82\' -- file not found [CR4]._
y) The ME simulator shall send a SELECT command to the UICC to select
EF~ICCID~.
z) The ME simulator shall send an UPDATE BINARY command to the UICC. The data
used shall be \'00 00\'.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR4]._
Table 10: Status Words Tested in Subclause 6.7.2.1
+---------+---------+--------------------+------+--------------+ | SW1 | SW2 | Description | CR | TP | +---------+---------+--------------------+------+--------------+ | \'90\' | \'00\' | ‑ Normal ending of | CR1 | b) | | | | the command | | | +---------+---------+--------------------+------+--------------+ | \'91\' | \'XX\' | ‑ Normal ending of | USAT | N/A | | | | the command, with | | | | | | extra information | | | | | | from the proactive | | | | | | UICC containing a | | | | | | command for the | | | | | | ME. Length \'XX\' | | | | | | of the response | | | | | | data | | | +---------+---------+--------------------+------+--------------+ | **SW1** | **SW2** | **Error | | | | | | description** | | | +---------+---------+--------------------+------+--------------+ | \'93\' | \'00\' | ‑ SIM Application | USAT | N/A | | | | Toolkit is busy. | | | | | | Command cannot be | | | | | | executed at | | | | | | present, further | | | | | | normal commands | | | | | | are allowed. | | | +---------+---------+--------------------+------+--------------+ | **SW1** | **SW2** | **Description** | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'00\' | ‑ No information | CR2 | N/A | | | | given, state of | | | | | | non volatile | | | | | | memory unchanged | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'81\' | ‑ Part of returned | CR2 | N/A | | | | data may be | | | | | | corrupted | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'82\' | ‑ End of | CR2 | N/A | | | | file/record | | | | | | reached before | | | | | | reading Le bytes | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'83\' | ‑ Selected file | CR2 | N/A | | | | invalidated | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'85\' | ‑ Selected DF in | CR2 | N/A | | | | termination state | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'F1\' | ‑ More data | CR2 | 6.8.2.1 | | | | available | | | +---------+---------+--------------------+------+--------------+ | \'62\' | \'F2\' | ‑ More data | CR2 | 6.8.2.1 | | | | available and | | | | | | proactive command | | | | | | pending | | | +---------+---------+--------------------+------+--------------+ | \'63\' | \'F1\' | ‑ More data | CR2 | 6.8.2.2 | | | | expected | | | +---------+---------+--------------------+------+--------------+ | \'63\' | \'F2\' | ‑ More data | CR2 | 6.8.2.2 | | | | expected and | | | | | | proactive command | | | | | | pending | | | +---------+---------+--------------------+------+--------------+ | \'63\' | \'CX\' | ‑ Command | CR2 | l), m), n) | | | | successful but | | | | | | after using an | | | | | | internal update | | | | | | retry routine | | | | | | \'X\' times | | | | | | | | | | | | - Verification | | | | | | failed, \'X\' | | | | | | retries remaining | | | +---------+---------+--------------------+------+--------------+ | SW1 | SW2 | Description | | | +---------+---------+--------------------+------+--------------+ | \'64\' | \'00\' | ‑ No information | CR3 | N/A | | | | given, state of | | | | | | non-volatile | | | | | | memory unchanged | | | +---------+---------+--------------------+------+--------------+ | \'65\' | \'00\' | ‑ No information | CR3 | N/A | | | | given, state of | | | | | | non-volatile | | | | | | memory changed | | | +---------+---------+--------------------+------+--------------+ | \'65\' | \'81\' | ‑ Memory problem | CR3 | N/A | +---------+---------+--------------------+------+--------------+ | SW1 | SW2 | Description | | | +---------+---------+--------------------+------+--------------+ | \'67\' | \'00\' | ‑ Wrong length | CR4 | k) | +---------+---------+--------------------+------+--------------+ | \'67\' | \'XX\' | ‑ The | CR4 | N/A | | | | interpretation of | | | | | | this status word | | | | | | is command | | | | | | dependent, except | | | | | | for SW2 = \'00\' | | | +---------+---------+--------------------+------+--------------+ | \'6B\' | \'00\' | ‑ Wrong | CR4 | f), q) | | | | parameter(s) P1-P2 | | | +---------+---------+--------------------+------+--------------+ | \'6D\' | \'00\' | ‑ Instruction code | CR4 | r) | | | | not supported or | | | | | | invalid | | | +---------+---------+--------------------+------+--------------+ | \'6E\' | \'00\' | ‑ Class not | CR4 | t), u), v) | | | | supported | | | +---------+---------+--------------------+------+--------------+ | \'6F\' | \'00\' | ‑ Technical | CR4 | s) | | | | problem, no | | | | | | precise diagnosis | | | +---------+---------+--------------------+------+--------------+ | \'6F\' | \'XX\' | ‑ The | CR4 | N/A | | | | interpretation of | | | | | | this status word | | | | | | is command | | | | | | dependent, except | | | | | | for SW2 = \'00\' | | | +---------+---------+--------------------+------+--------------+ | SW1 | SW2 | Description | | | +---------+---------+--------------------+------+--------------+ | \'68\' | \'00\' | ‑ No information | CR4 | N/A | | | | given | | | +---------+---------+--------------------+------+--------------+ | \'68\' | \'81\' | ‑ Logical channel | CR4 | u) | | | | not supported | | | +---------+---------+--------------------+------+--------------+ | \'68\' | \'82\' | ‑ Secure messaging | CR4 | v) | | | | not supported | | | +---------+---------+--------------------+------+--------------+ | SW1 | SW2 | Description | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'00\' | ‑ No information | CR4 | N/A | | | | given | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'81\' | ‑ Command | CR4 | j) | | | | incompatible with | | | | | | file structure | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'82\' | ‑ Security status | CR4 | z) | | | | not satisfied | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'83\' | ‑ Authentication | CR4 | o) | | | | method blocked | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'84\' | ‑ Referenced data | CR4 | N/A | | | | invalidated | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'85\' | ‑ Conditions of | CR4 | N/A | | | | used not satisfied | | | +---------+---------+--------------------+------+--------------+ | \'69\' | \'86\' | ‑ Command not | CR4 | d) | | | | allowed (no EF | | | | | | selected) | | | +---------+---------+--------------------+------+--------------+ | SW1 | SW2 | Description | | | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'80\' | ‑ Incorrect | CR4 | N/A | | | | parameters in the | | | | | | data field | | | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'81\' | ‑ Function not | CR4 | N/A | | | | supported | | | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'82\' | ‑ File not found | CR4 | x) | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'83\' | ‑ Record not found | CR4 | i) | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'84\' | ‑ Not enough | CR4 | 6.8.2.2 | | | | memory space | | | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'86\' | ‑ Incorrect | CR4 | f), q) | | | | parameters P1-P2 | | | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'87\' | ‑ Lc inconsistent | CR4 | k) | | | | with P1-P2 | | | +---------+---------+--------------------+------+--------------+ | \'6A\' | \'88\' | ‑ Referenced data | CR4 | N/A | | | | not found | | | +---------+---------+--------------------+------+--------------+ | **SW1** | **SW2** | **Error | | | | | | description** | | | +---------+---------+--------------------+------+--------------+ | \'98\' | \'50\' | ‑ INCREASE cannot | CR5 | 6.8.1.8.4 h) | | | | be performed, max | | | | | | value reached. | | | +---------+---------+--------------------+------+--------------+ | \'98\' | \'62\' | ‑ Authentication | CR5 | N/A | | | | error, application | | | | | | specific | | | +---------+---------+--------------------+------+--------------+
#### 6.7.2.2 Status Words of the Commands
##### 6.7.2.2.1 Definition and applicability
See clause 3.5.3.
##### 6.7.2.2.2 Conformance requirement
* * *
CR1 Table 10.16 in TS 102.221 [1], subclause 10.2.2 shows for each command the
possible status conditions returned (marked by an asterisk *). The UICC shall
not generate status conditions other than those allowed for each command. M
* * *
Reference: TS 102.221 [1], subclause 10.2.2.
##### 6.7.2.2.3 Test purpose
To verify for each command that the UICC only generates the allowed status
conditions.
NOTE: The CR1 is tested in the subclause 6.7.2 and subclause 6.8.1.
##### 6.7.2.2.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
6.7.3 Logical channels
##### 6.7.3.1 Definition and applicability
See clause 3.5.3.
##### 6.7.3.2 Conformance requirement
* * *
CR1 The basic logical channel (number 0) is permanently available. Rel-4 -
...: O_LOG_CHANS CR2 The MANAGE CHANNEL command shall be used to open and
close a logical channel. Rel-4 - ...: O_LOG_CHANS CR3 The channel number is
assigned by the UICC. Rel-4 - ...: O_LOG_CHANS
* * *
Reference: TS 102 221 [1], subclause 10.3.
##### 6.8.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR1, CR2 and CR3 are tested in subclause 6.5.7.
##### 6.8.1.1.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
## 6.8 Commands
### 6.8.1 Generic Commands
#### 6.8.1.1 SELECT
##### 6.8.1.1.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.1.2 Conformance requirement
+------+------------------------------+------------------------------+ | CR1 | This function shall select a | M | | | file according to the | | | | methods described in | | | | subclause 8.4 of | | | | TS 102.221 [1]. | | +------+------------------------------+------------------------------+ | CR2 | The function shall accept as | M | | | an input: | | | | | | | | a) a file ID (FID); | | | | | | | | b) an application ID (AID); | | | | | | | | c) a path; | | | | | | | | d) empty. | | +------+------------------------------+------------------------------+ | CR3 | If the selected file is the | M | | | MF, then the function shall | | | | output the file descriptor, | | | | file identifier, UICC | | | | characteristics, life cycle | | | | status integer, security | | | | attributes and PIN status. | | +------+------------------------------+------------------------------+ | CR4 | If the selected file is the | M | | | a ADF, then the function | | | | shall output the file | | | | descriptor, DF name, life | | | | cycle status integer, | | | | security attributes and PIN | | | | status. | | +------+------------------------------+------------------------------+ | CR5 | If the selected file is an | M | | | EF, then the function shall | | | | output the file descriptor, | | | | file identifier, security | | | | attributes, life cycle | | | | status integer and file | | | | size. | | +------+------------------------------+------------------------------+ | CR6 | After a successful selection | M | | | the record pointer shall be | | | | undefined. | | +------+------------------------------+------------------------------+ | CR7 | If P2 = \'0C\' the function | M | | | shall output only SW1 and | | | | SW2. | | +------+------------------------------+------------------------------+ | CR8 | If P1 = \'00\' and if P2 = | M | | | \'0C\' (\"No data | | | | returned\") and the data | | | | field is empty then the MF | | | | shall be set as the Current | | | | Directory. | | +------+------------------------------+------------------------------+ | CR9 | It is mandatory for data | M | | | objects to be provided in | | | | the order given in the | | | | description of each | | | | response. | | +------+------------------------------+------------------------------+ | CR10 | If the selected file is a | M | | | DF, then the function shall | | | | output the file descriptor, | | | | file identifier, life cycle | | | | status integer, security | | | | attributes and PIN status. | | +------+------------------------------+------------------------------+ | CR11 | After a successful selection | Rel-6 - ...: | | | the current tag pointer is | O_BER_TLV_FILES | | | undefined. | | +------+------------------------------+------------------------------+
Reference: TS 102.221 [1], subclause 11.1.1.
##### 6.8.1.1.3 Test purpose
To verify that the SELECT function conforms to the above requirements for the
different file types available.
NOTE 1: CR1 is tested in subclause 6.5.4.
NOTE 2: CR11 is tested in subclause 6.8.2.1.
##### 6.8.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select
DF~TELECOM~.
> _The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' \--
> normal ending of the command [CR2a]._
>
> _The FCP shall contain the following tags [CR10]:_
>
> _\- Tag \'82\' (File Descriptor)_
>
> _The first byte shall be \'38\' or \'78\' (indicating a DF or ADF);_
>
> _\- Tag \'83\' (File Identifier)_
>
> _The value shall be \'7F 10\' (indicating DF~TELECOM~);_
>
> _\- Tag \'8A\' (Life Cycle Status Integer);_
>
> _\- Tag \'C6\' (PIN Status Template DO)_
>
> _It shall contain tag \'90\' (PS_DO)._
>
> _The FCP shall contain exactly one of the following tags:_
  * _Tag \'8C\' (Compact format);_
  * _Tag \'AB\' (Expanded format);_
  * _Tag \'8B\' (Referenced to Expanded Format)._
> _The TLV DOs with the above Tags shall be provided in FCP in order given in
> the Table 11.3 of subclause 11.1.1.3 of the TS 102.221 [1] [CR9]._
c) The ME simulator shall send a SELECT command to the UICC to select the MF.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command [CR2a]._
_The FCP shall contain the following tags [CR3]:_
  * _Tag \'82\' (File Descriptor)_
> _The first byte shall be \'38\' or \'78\' (indicating a DF or ADF);_
  * _Tag \'83\' (File Identifier)_
> _The value shall be \'3F 00\' (indicating MF);_
  * _Tag \'A5\' (Proprietary information)_
> _It shall contain tag \'80\' (UICC characteristics);_
  * _Tag \'8A\' (Life Cycle Status Integer);_
```{=html}
``` \- _Tag \'C6\' (PIN Status Template DO)_
> _It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
  * _Tag \'8C\' (Compact format);_
  * _Tag \'AB\' (Expanded format);_
  * _Tag \'8B\' (Referenced to Expanded Format)._
> _The TLV DOs with the above Tags shall be provided in FCP in order given in
> the Table 11.3 of subclause 11.1.1.3 of the TS 102.221 [1] [CR9]._
d) The ME simulator shall send a SELECT command to the UICC to select EF~DIR~.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command [CR2a]._
_The FCP shall contain the following tags [CR5]:_
> _\- Tag \'82\' (File Descriptor)_
>
> _The first byte shall be \'02\' or \'42\' (indicating a linear fixed EF);_
>
> _The length shall be \'05\' (i.e. containing record length etc);_
>
> _\- Tag \'83\' (File Identifier)_
>
> _The value shall be \'2F 00\' (indicating EF~DIR~);_
  * _Tag \'8A\' (Life Cycle Status Integer);_
  * _Tag \'80\' (File size)._
_The FCP shall contain exactly one of the following tags:_
  * _Tag \'8C\' (Compact format);_
  * _Tag \'AB\' (Expanded format);_
  * _Tag \'8B\' (Referenced to Expanded Format)._
> _The TLV DOs with the above Tags shall be provided in FCP in order given in
> the Table 11.4 of subclause 11.1.1.3 of the TS 102.221 [1] [CR9]._
e) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
_The UICC shall return an error code appropriate to the command (e.g. SW1 =
\'6A\', SW2 = \'83\' - Record not found) [CR6]._
f) The ME simulator shall send a SELECT command with P2 = \'0C\' to the UICC
to select the MF.
_The response from the UICC shall be only SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command [CR7]._
g) The ME simulator shall send a SELECT command to the UICC to select > the
EF~ARR~ under DF~TELECOM~ by path selection
_The response from the UICC shall be only SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command._
_The TLV DO with Tag \'83\' in the FCP shall indicate the current EF is
EF~ARR~ [CR2c]._
h) The ME simulator shall send a SELECT command to the UICC to select the
parent DF.
_The response from the UICC shall be only SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command._
_The TLV DO with Tag \'83\' in the FCP shall indicate the current DF is MF
[CR2d]._
i) The ME simulator shall send a SELECT command with AID to the UICC to select
and activate the USIM application.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command [CR2b]._
_The FCP shall contain the following tags [CR4]:_
> _\- Tag \'82\' (File Descriptor)_
>
> _The first byte shall be \'38\' or \'78\' (indicating a DF or ADF);_
>
> _\- Tag \'84\' (DF name - AID)_
>
> _The value shall be the AID of the USIM application;_
>
> _\- Tag \'8A\' (Life Cycle Status Integer);_
>
> _\- Tag \'C6\' (PIN Status Template DO)_
>
> _It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
  * _Tag \'8C\' (Compact format);_
  * _Tag \'AB\' (Expanded format);_
  * _Tag \'8B\' (Referenced to Expanded Format)._
> _The TLV DOs with the above Tags shall be provided in FCP in order given in
> the Table 11.4 of subclause 11.1.1.3 of the TS 102.221 [1] [CR9]._
j) The ME simulator shall send a SELECT command with P1 = \'00\', P2 = >
\'0C\' and with empty data field to the UICC.
> _The response from the UICC shall be only SW1 = \'90\', SW2 = \'00\' \--
> normal ending of the command [CR7, CR8]._
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command with P1 = \'00\', P2 = \'0C\'
and with empty data field to the UICC.
> _The response from the UICC shall be only SW1 = \'90\', SW2 = \'00\' \--
> normal ending of the command [CR7, CR8]._
d) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
> _The FCP returned shall contain the File ID of the MF [CR8]._
#### 6.8.1.2 STATUS
##### 6.8.1.2.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.2.2 Conformance requirement
* * *
CR1 If the parameter P2 = \'00\', then the STATUS function shall output the
FCP of the currently selected MF, DF or ADF. M CR2 If the parameter P2 =
\'01\', then the STATUS function shall output the DF~name~ TLV DO of the
currently selected ADF. M CR3 If the parameter P2 = \'0C\', then the STATUS
function shall output only SW1 and SW2. M
* * *
Reference: TS 102.221 [1], subclause 11.1.2.
##### 6.8.1.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
##### 6.8.1.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
_The FCP shall contain the following tags [CR1]:_
_\- Tag \'82\' (File Descriptor)_
_The first byte shall be \'38\' or \'78\' (indicating a DF);_
_\- Tag \'83\' (File Identifier)_
_The value shall be \'3F 00\' (indicating MF);_
_\- Tag \'A5\' (Proprietary information)_
_It shall contain tag \'80\' (UICC characteristics);_
_\- Tag \'8A\' (Life Cycle Status Integer);_
_\- Tag \'C6\' (PIN Status Template DO)_
_It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
_\- Tag \'8C\' (Compact format);_
_\- Tag \'AB\' (Expanded format);_
_\- Tag \'8B\' (Referenced to Expanded Format)._
c) The ME simulator shall send a SELECT command to select DF~TELECOM~.
d) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
_The FCP shall contain the following tags [CR1]:_
_\- Tag \'82\' (File Descriptor)_
_The first byte shall be \'38\' or \'78\' (indicating a DF);_
_\- Tag \'83\' (File Identifier)_
_The value shall be \'7F 10\' (indicating DF~TELECOM~);_
_\- Tag \'8A\' (Life Cycle Status Integer);_
_\- Tag \'C6\' (PIN Status Template DO)_
_It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
_\- Tag \'8C\' (Compact format);_
_\- Tag \'AB\' (Expanded format);_
_\- Tag \'8B\' (Referenced to Expanded Format)._
e) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
_The UICC shall return an error code appropriate to the command [CR2]._
f) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
g) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
_The FCP shall contain the following tags [CR1]:_
_\- Tag \'82\' (File Descriptor)_
_The first byte shall be \'38\' or \'78\' (indicating an ADF);_
_\- Tag \'84\' (DF name - AID)_
_The value shall be the AID of the USIM application;_
_\- Tag \'8A\' (Life Cycle Status Integer);_
_\- Tag \'C6\' (PIN Status Template DO)_
_It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
_\- Tag \'8C\' (Compact format);_
_\- Tag \'AB\' (Expanded format);_
_\- Tag \'8B\' (Referenced to Expanded Format)._
h) The ME simulator shall send a SELECT command to the UICC to select the
DF~PHONEBOOK~.
i) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
_The FCP shall contain the following tags [CR1]:_
_\- Tag \'82\' (File Descriptor)_
_The first byte shall be \'38\' or \'78\' (indicating a DF);_
_\- Tag \'83\' (File identifier)_
_The value shall be \'5F 3A\' (indicating DF~PHONEBOOK~);_
_\- Tag \'8A\' (Life Cycle Status Integer);_
_\- Tag \'C6\' (PIN Status Template DO)_
_It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
_\- Tag \'8C\' (Compact format);_
_\- Tag \'AB\' (Expanded format);_
_\- Tag \'8B\' (Referenced to Expanded Format)._
j) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
_The following shall be true of the response data [CR2]:_
_Value of tag \'84\' shall be the AID of the USIM application_
k) The ME simulator shall send a STATUS command with P2 = \'0C\' to the UICC.
_The following shall be true of the response data [CR3]:_
_\- The response data from the UICC shall be only SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command [CR3]_
l) The ME simulator shall send a SELECT command to select DF~TELECOM~.
m) The ME simulator shall send a STATUS command with P2 = \'00\' to the UICC.
_The FCP shall contain the following tags [CR1]:_
_\- Tag \'82\' (File Descriptor)_
_The first byte shall be \'38\' or \'78\' (indicating a DF);_
_\- Tag \'83\' (File Identifier)_
_The value shall be \'7F 10\' (indicating DF~TELECOM~);_
_\- Tag \'8A\' (Life Cycle Status Integer);_
_\- Tag \'C6\' (PIN Status Template DO)_
_It shall contain tag \'90\' (PS_DO)._
_The FCP shall contain exactly one of the following tags:_
_\- Tag \'8C\' (Compact format);_
_\- Tag \'AB\' (Expanded format);_
_\- Tag \'8B\' (Referenced to Expanded Format)._
n) The ME simulator shall send a STATUS command with P2 = \'01\' to the UICC.
_The following shall be true of the response data [CR2]:_
_Value of tag \'84\' shall be the AID of the USIM application._
#### 6.8.1.3 READ BINARY
##### 6.8.1.3.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.3.2 Conformance requirement
* * *
CR1 The READ BINARY function shall read a string of bytes from the current
transparent EF. M CR2 The function shall accept as an input, the relative
address (offset) and the length (in bytes) of the string. M CR3 The function
shall output the string of bytes. M CR4 The function shall only be performed
if the READ access condition for the current EF is satisfied. M CR5 The
function shall accept SFI referencing. M CR6 The function shall be aborted if
it is applied to an EF without transparent structure. M
* * *
Reference: TS 102.221 [1], subclause 11.1.3.
##### 6.8.1.3.3 Test purpose
To verify that the READ BINARY function conforms to the above requirements.
##### 6.8.1.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI~.
d) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR4]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the access condition for EF~LOCI~.
f) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1-CR4]._
>
> _The data string returned shall be \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00 00\'
> [CR1- CR4]._
g) The ME simulator shall send a READ BINARY command using a length of 1 byte
to the UICC.
> _The data string returned shall be \'A1\' [CR2]._
h) The ME simulator shall send a READ BINARY command using an offset of \'00
01\' and length 10 bytes to the UICC.
> _The data string returned shall be \'A2 A3 A4 A5 A6 A7 A8 A9 00 00\' [CR2]._
i) The ME simulator shall send a SELECT command to the UICC to select
EF~Keys~.
j) The ME simulator shall send a READ BINARY command using SFI reference to
select EF~LOCI~ and length 11 bytes to the UICC.
> _The data string returned shall be \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00 00\'
> [CR3, CR5]._
k) The ME simulator shall send a SELECT command to the UICC to select MF.
l) The ME simulator shall send a SELECT command to the UICC to select EF~DIR~.
m) The ME simulator shall send a READ BINARY command using a length of 1 byte
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'81\' - command incompatible with file structure [CR6]._
#### 6.8.1.4 UPDATE BINARY
##### 6.8.1.4.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.4.2 Conformance requirement
* * *
CR1 The UPDATE BINARY function shall update the current transparent EF with a
string of bytes. M CR2 The function shall accept as an input, the relative
address (offset), the length (in bytes) of the string, and the string of
bytes. M CR3 The function shall only be performed if the UPDATE access
condition for the current EF is satisfied. M CR4 The function shall accept SFI
referencing. M CR5 The function shall be aborted if it is applied to an EF
without transparent structure. M
* * *
Reference: TS 102.221 [1], subclause 11.1.4.
##### 6.8.1.4.3 Test purpose
To verify that the UPDATE BINARY function conforms to the above requirements.
##### 6.8.1.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
00\'.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~LOCI.~
d) The ME simulator shall send an UPDATE BINARY command using a length of 11
bytes, and data string \'FF FF FF FF FF FF FF FF FF 00 00\' to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
-- security status not satisfied [CR3]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the access condition for the EF~LOCI~.
f) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
_The data string returned shall be \' A1 A2 A3 A4 A5 A6 A7 A8 A9 00._
g) The ME simulator shall send an UPDATE BINARY command using a length of 11
bytes, and data string \'FF FF FF FF FF FF FF FF FF 00 00\' to the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
[CR3]._
h) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
_The data string returned shall be \'FF FF FF FF FF FF FF FF FF 00 00\'
[CR1]._
i) The ME simulator shall send an UPDATE BINARY command using a length of 1
byte, and data string \'E4\' to the UICC.
j) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The data string returned shall be \'E4 FF FF FF FF FF FF FF FF 00 00\'
> [CR1]._
k) The ME simulator shall send an UPDATE BINARY command using an offset of
\'00 01\', a length 1 byte, and data string \'E5\' to the UICC.
l) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The data string returned shall be \'E4 E5 FF FF FF FF FF FF FF 00 00\'
> [CR1, CR2]_
m) The ME simulator shall send a SELECT command to the UICC to select
EF~Keys~.
n) The ME simulator shall send an UPDATE BINARY command using SFI reference to
select EF~LOCI~ and a length 1 byte, and string \'D1\' to the UICC.
o) The ME simulator shall send a READ BINARY command using a length of 11
bytes to the UICC.
> _The data string returned shall be \'D1 E5 FF FF FF FF FF FF FF 00 00\'
> [CR1, CR4]._
p) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
q) The ME simulator shall send an UPDATE BINARY command using a length 1 byte
and data string \'D2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'81\' - command incompatible with file structure [CR5]._
r) The ME simulator shall send an UPDATE BINARY command using SFI reference to
select EF~LOCI~ and a length 11 byte, and string \'\'A1 A2 A3 A4 A5 A6 A7 A8
A9 00 00\' to the UICC.
#### 6.8.1.5 READ RECORD
##### 6.8.1.5.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.5.2 Conformance requirement
* * *
CR1 The READ RECORD function shall read one complete record in the current
linear fixed or cyclic EF. M CR2 The function shall accept as an input, the
mode, record number if absolute mode, and the length of the record. M CR3 The
function shall output the record specified by the mode. M CR4 The function
shall only be performed if the READ access condition for the current EF is
satisfied. M CR5 If the mode is CURRENT, the current record shall be read. M
CR6 If the mode is CURRENT, the record pointer shall not affected. M CR7 If
the mode is ABSOLUTE, the record given by the record number shall be read. M
CR8 If the mode is ABSOLUTE, the record pointer shall not be affected. M CR9
If the mode is NEXT, the record pointer shall be incremented before the
function is performed and the pointed record shall be read. M CR10 If the mode
is NEXT, and the record pointer has not been previously been set within the
selected EF, the first record shall be read and the record pointer shall be
set to this record. M CR11 If the mode is NEXT, and the record pointer
addresses the last record in a linear fixed EF, the record pointer shall not
change and no data shall be read. M CR12 If the mode is NEXT, and the record
pointer addresses the last record in a cyclic EF, the first record shall be
read and the record pointer shall be set to this record. M CR13 If the mode is
PREVIOUS, the record pointer shall be decremented before the function is
performed and the pointed record shall be read. M CR14 If the mode is
PREVIOUS, and the record pointer has not been previously been set within the
selected EF, the last record shall be read and the record pointer shall be set
to this record. M CR15 If the mode is PREVIOUS, and the record pointer
addresses the first record in a linear fixed EF, the record pointer shall not
change and no data shall be read. M CR16 If the mode is PREVIOUS, and the
record pointer addresses the first record in a cyclic EF, the last record
shall be read and the record pointer shall be set to this record. M CR17 The
record pointer shall not be changed if the function is unsuccessful. M CR18
The function shall accept the SFI as an input. M CR19 When the command
contains a valid SFI, it shall set the file as the current EF, reset the
current record pointer and subsequent records are read with the read record
command without SFI. M
* * *
Reference: TS 102.221 [1], subclause 8.4.3 and 11.1.5.
##### 6.8.1.5.3 Test purpose
To verify that the READ RECORD function conforms to the above requirements
using three test procedures.
NOTE: CR12 and CR16 can only be tested if any cyclic EFs are present.
##### 6.8.1.5.4 Method of test
NOTE 1: Test procedures have been separated into 3 parts. The first part is
for testing CURRENT and ABSOLUTE mode, the second part is for testing NEXT and
PREVIOUS mode and the third part is for testing the SFI referencing.
NOTE 2: When EF~CCP2~ is not supported by the UICC, any supported linear EF in
ADF~USIM~ supporting SFI may be chosen.
NOTE 3: When EF~ACM~ is not supported by the UICC, any supported cyclic EF in
ADF~USIM~ may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) The records in EF~CCP2~ shall contain the following data:
* * *
**1^st^ record** \'10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E\' **2^nd^
record** \'20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E\' **2^nd^ last
record** \'E0 E1 E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE\' **Last record** \'F0
F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE\'
* * *
3) The records in EF~ACM~ shall contain the following data, if it is
supported:
* * *
**1^st^ record** \'00 00 01\'(last updated record) **2^nd^ record** \'00 00
02\' **3^rd^ record** \'00 00 03\' **X^th^ record** \'00 00\' followed by byte
value X (first updated record)
* * *
**Test procedure 1 (CURRENT and ABSOLUTE mode)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
d) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR4]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
f) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR4]._
>
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR1-CR4, CR7]._
g) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
> h) The ME simulator shall send a READ RECORD command using NEXT mode to the
> UICC.
_The record data returned shall be that of the first record in the EF~CCP2~._
i) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 2 to the UICC.
> _The record data returned shall be that of the second record in the EF~CCP2~
> [CR7]._
j) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR5, CR8]._
>
> k) The ME simulator shall send a READ RECORD command using NEXT mode to the
> UICC.
>
> _The record data returned shall be that of the second record in the EF~CCP2~
> [CR6]._
l) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the last record to the UICC.
> _The record data returned shall be that of the last record in the EF~CCP2~
> [CR7]._
m) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the last record + 1 to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' -- record not found._
n) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the second record in the EF~CCP2~
> [CR17]._
o) The ME simulator shall send a SELECT command to the UICC to select EF~ACM~.
p) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~ACM~
> [CR1]._
q) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~ACM~
> [CR5]._
r) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 3 to the UICC.
> _The record data returned shall be that of the record 3 in the EF~ACM~ [CR1,
> CR7]._
s) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the last record + 1 to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' -- record not found._
t) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~ACM~
> [CR17]._
**Test procedure 2 (NEXT and PREVIOUS mode)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR10]._
f) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR10]._
g) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR11]._
_The record data returned shall be that of the second record in the EF~CCP2~
[CR9]._
h) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the second record in the EF~CCP2~
> [CR9]._
i) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
j) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
> _The record data returned shall be that of the last record in the EF~CCP2~
> [CR14]._
k) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' -- Record not found [CR11]._
l) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the last record in the EF~CCP2~
> [CR11]._
m) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR18]._
>
> _The record data returned shall be that of the second last record in the
> EF~CCP2~ [CR13]._
n) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
o) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR10]._
p) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' -- record not found [CR15]._
q) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR15]._
r) The ME simulator shall send a SELECT command to the UICC to select EF~ACM~.
s) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
> _The record data returned shall be that of the last record (record X) in the
> EF~ACM~ [CR16]._
t) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the last record (record X) in the
> EF~ACM~ [CR16]._
u) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The record data returned shall be that of the first record (record 1) in
> the EF~ACM~ [CR12]._
v) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
> _The record data returned shall be that of the last record (record X) in the
> EF~ACM~ [CR16]._
**Test procedure 3 (SFI referencing)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
d) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 and with SFI to select EF~CCP2~ to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR18]._
>
> _The record data returned shall be that of the first record in the EF~CCP2~
> [CR18]._
e) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' -- record not found [CR19]._
f) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The record data returned shall be that of the first record (record 1) in
> the EF~CCP2~ [CR19]._
#### 6.8.1.6 UPDATE RECORD
##### 6.8.1.6.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.6.2 Conformance requirement
* * *
CR1 The UPDATE RECORD function shall update one complete record in the current
linear fixed or cyclic EF. M CR2 The function shall accept as an input, the
mode, record number if absolute mode, the length of the record, and the data
used for updating the record. M CR3 The function shall only be performed if
the UPDATE access condition for the current EF is satisfied. M CR4 For cyclic
files, only PREVIOUS mode shall be allowed. M CR5 If the mode is CURRENT, the
current record shall be updated. M CR6 If the mode is CURRENT, the record
pointer shall not be affected. M CR7 If the mode is ABSOLUTE, the record given
by the record number shall be updated. M CR8 If the mode is ABSOLUTE, the
record pointer shall not be affected. M CR9 If the mode is NEXT, the record
pointer shall be incremented before the function is performed and the pointed
record shall be updated. M CR10 If the mode is NEXT, and the record pointer
has not previously been set within the selected EF, the first record shall be
updated and the record pointer shall be set to this record. M CR11 If the mode
is NEXT, and the record pointer addresses the last record, the record pointer
shall not change and no record shall be updated. M CR12 If the mode is
PREVIOUS, the record pointer shall be decremented before the function shall be
performed and the pointed record shall be updated. M CR13 If the mode is
PREVIOUS, and the record pointer has not previously been set within the
selected EF, the last record shall be updated and the record pointer set to
this record. M CR14 If the mode is PREVIOUS, the EF is a linear fixed, and the
record pointer addresses the first record, the record pointer shall not change
and no record shall be updated. M CR15 If the mode is PREVIOUS and the EF is a
cyclic file, the oldest record shall be updated, the record pointer set to
this record, and this record shall become the first record. M CR16 The record
pointer shall not be changed if the function is unsuccessful. M CR17 For modes
NEXT and PREVIOUS, P1 has no significance and shall be set to '00' by the
terminal. M CR18 The function shall accept the SFI as an input. M CR19 When
the command contains a valid SFI, it shall set the file as the current EF and
resets the current record pointer. M
* * *
Reference: TS 102.221 [1], subclause 8.4.3 and 11.1.6.
##### 6.8.1.6.3 Test purpose
To verify that the UPDATE RECORD function conforms to the above requirements
for the different modes available.
NOTE: CR4 and CR13 can only be tested if any cyclic EF is present.
##### 6.8.1.6.4 Method of test
NOTE 1: Test procedures have been separated into 3 parts. The first part is
for testing CURRENT and ABSOLUTE mode, and the second part is for testing NEXT
and PREVIOUS mode and the third part is for testing the SFI referencing.
NOTE 2: When EF~CCP2~ is not supported by the UICC, any supported linear EF in
ADF~USIM~ supporting SFI may be chosen.
NOTE 3: When EF~ACM~ is not supported by the UICC, any supported cyclic EF in
ADF~USIM~ may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1 (CURRENT and ABSOLUTE mode)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
d) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with record 1 to the UICC. The data used shall be \'C1\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - security status not satisfied [CR3]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
f) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with record 1 to the UICC. The data used shall be \'C2\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
g) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The record data returned shall be \'C2\' for all bytes [CR1-CR3, CR7]._
h) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2.~
i) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'FF\' for all bytes.
j) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The record data returned shall be \'FF\' for all bytes [CR7]._
k) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with record 2 to the UICC. The data used shall be \'C3\' for all bytes.
l) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 2 to the UICC.
> _The record data returned shall be \'C3\' for all bytes [CR7]._
m) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'C4\' for all bytes.
n) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
_The record data returned shall be \'C4\' for all bytes [CR5, CR8]._
o) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'C5\' for all bytes.
p) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 2 to the UICC.
_The record data returned shall be \'C5\' for all bytes [CR8]._
q) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with the last record to the UICC. The data used shall be \'C6\' for all bytes.
r) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the last record to the UICC.
_The record data returned shall be \'C6\' for all bytes [CR7]._
s) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with the last record + 1 to the UICC. The data used shall be \'C7\' for all
bytes.
_The status condition returned by the UICC shall be SW1 = \'6A\', SW2 = \'83\'
-- record not found._
t) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'C8\' for all bytes.
u) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 2 to the UICC.
_The record data returned shall be \'C8\' for all bytes [CR16]._
v) The ME simulator shall send a SELECT command to the UICC to select EF~ACM~.
w) The ME simulator shall send a VERIFY PIN command with the relevant PIN to
the UICC.
x) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'C9\' for all bytes.
_The UICC shall return an error code appropriate to the command [CR4]._
y) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with record 3 to the UICC. The data used shall be \'CA\' for all bytes.
_The UICC shall return an error code appropriate to the command [CR4]._
z) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'CB\' for all bytes.
> _The UICC shall return an error code appropriate to the command [CR4]._
aa) The ME simulator shall send an UPDATE RECORD command using PREVIOUS mode
to the UICC. The data used shall be \'CC\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR4]._
bb) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
_The record data returned shall be \'CC\' for all bytes [CR16]._
cc) The ME simulator shall send an UPDATE RECORD command using PREVIOUS mode
to the UICC. The data used shall be \'00 00 01\'.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR4]._
**Test procedure 2 (NEXT and PREVIOUS mode)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2.~
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'C2\' for all bytes.
f) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The record data returned shall be \'C2\' for all bytes [CR10]._
g) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'C3\' for all bytes.
h) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The record data returned shall be \'C3\' for all bytes [CR10]._
i) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'C4\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR17]._
j) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 2 to the UICC.
> _The record data returned shall be \'C4\' for all bytes [CR9, CR17]._
k) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'C5\' for all bytes.
l) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 2 to the UICC.
> _The record data returned shall be \'C5\' for all bytes [CR9]._
m) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2.~
n) The ME simulator shall send an UPDATE RECORD command using PREVIOUS mode to
the UICC. The data used shall be \'C6\' for all bytes.
o) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the last record to the UICC.
> _The record data returned shall be \'C6\' for all bytes [CR13]._
p) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'C7\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' -- record not found [CR11]._
q) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'C8\' for all bytes.
r) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the last record to the UICC.
> _The record data returned shall be \'C8\' for all bytes [CR16]._
s) The ME simulator shall send an UPDATE RECORD command using PREVIOUS mode to
the UICC. The data used shall be \'C9\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR17]._
t) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
the second last record to the UICC.
> _The record data returned shall be \'C9\' for all bytes [CR12, CR17]._
u) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2.~
v) The ME simulator shall send an UPDATE RECORD command using NEXT mode to the
UICC. The data used shall be \'CA\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
w) The ME simulator shall send an UPDATE RECORD command using PREVIOUS mode to
the UICC. The data used shall be \'CB\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'83\' - record not found [CR13]._
x) The ME simulator shall send an UPDATE RECORD command using CURRENT mode to
the UICC. The data used shall be \'CC\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR13]._
y) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
> _The record data returned shall be \'CC\' for all bytes [CR16]._
**Test procedure 3 (SFI referencing)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
d) The ME simulator shall send an UPDATE RECORD command using ABSOLUTE mode
with record 1 and with SFI to select EF~CCP2~ under ADF~USIM~ to the UICC. The
data used shall be \'C0\' for all bytes.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR18]._
e) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The UICC shall return an error code appropriate to the command (e.g. SW1 =
> \'6A\', SW2 = \'83\' -- record not found) [CR19]._
f) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
> _The record data returned shall be \'C0\' for all bytes [CR19]._
#### 6.8.1.7 SEARCH RECORD
##### 6.8.1.7.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.7.2 Conformance requirement
+------+---------------------------------------------------------+---+ | CR1 | The SEARCH RECORD function shall search through a | M | | | linear fixed EF or cyclic EF to find record(s) | | | | containing a specific pattern. | | +------+---------------------------------------------------------+---+ | CR2 | The function shall only be performed if the READ access | M | | | condition for the current EF is satisfied. | | +------+---------------------------------------------------------+---+ | CR3 | The search shall start: | M | | | | | | | a) at the first byte of the record(s); | | | | | | | | b) from a given offset in the record(s); | | | | | | | | c) from the first occurrence of a given byte in the | | | | record(s). | | +------+---------------------------------------------------------+---+ | CR4 | If one or more matches are found the record pointer | M | | | shall be set to the first record where the search | | | | pattern was found. | | +------+---------------------------------------------------------+---+ | CR5 | For a simple search, the function shall accept as | M | | | input, the record number, search mode and search | | | | pattern. | | +------+---------------------------------------------------------+---+ | CR6 | For an enhanced search, the function shall accept as | M | | | input, the record number, search mode, search pattern | | | | and offset. | | +------+---------------------------------------------------------+---+ | CR7 | The SEARCH RECORD function shall output either: | M | | | | | | | a) none, if Le is empty or no matches were found; | | | | | | | | b) at most the number of record(s) number(s) defined | | | | in Le. | | +------+---------------------------------------------------------+---+ | CR8 | For a simple search, the function shall support the | M | | | following modes: | | | | | | | | a) start forward search from record indicated in P1; | | | | | | | | b) start backward search from record indicated in P1. | | +------+---------------------------------------------------------+---+ | CR9 | For an enhanced search, the SEARCH RECORD function | M | | | shall support the following modes: | | | | | | | | a) start forward search from record indicated in P1 | | | | with search indication; | | | | | | | | b) start backward search from record indicated in P1 | | | | with search indication; | | | | | | | | c) start forward search from next record with search | | | | indication; | | | | | | | | d) start backward search from previous record with | | | | search indication. | | +------+---------------------------------------------------------+---+ | CR10 | For the modes \"forward search from next record\" and | M | | | \"backward search from previous record\", P1 has no | | | | significance within the scope of the present document | | | | and shall be set to \'00\'. | | +------+---------------------------------------------------------+---+ | CR11 | For a SEARCH RECORD function of forward search from | M | | | next record (enhanced search), if the record pointer | | | | has not been previously set within the selected linear | | | | fixed or cyclic EF, the search shall begin with the | | | | first record. | | +------+---------------------------------------------------------+---+ | CR12 | For a SEARCH RECORD function of backward search from | M | | | previous record (enhanced search), if the record | | | | pointer has not been previously set within the selected | | | | linear fixed EF, the search shall begin with the last | | | | record. | | +------+---------------------------------------------------------+---+ | CR13 | The record pointer shall not be changed by an | M | | | unsuccessful SEARCH RECORD function. | | +------+---------------------------------------------------------+---+ | CR14 | The function shall accept the SFI as an input. | M | +------+---------------------------------------------------------+---+ | CR15 | When the SEARCH RECORD command contains a valid SFI, it | M | | | shall set the file as the current EF and resets the | | | | current record pointer. | | +------+---------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 8.2.2, 8.4.3 and 11.1.7.
##### 6.8.1.7.3 Test purpose
To verify that the SEARCH RECORD function conforms to the above requirements
for the different modes available.
##### 6.8.1.7.4 Method of test
NOTE: CR7 can not be tested for T = 0 protocol as the Le byte is not
transmitted to the UICC. It is dependent on the design of the transport layer
of a ME whether to pass all the response data bytes from the UICC to its
application layer according to the Le byte. (CR7 is tested in test procedure
4)
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1 (simple search)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
d) The ME simulator shall send a SEARCH RECORD command using the record number
\'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR2]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
f) The ME simulator shall send a SEARCH RECORD command using the record number
\'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
> _The UICC shall return \'01 02 03 04\' indicating that first, second, third
> and fourth record have been found [CR3a, CR8a]._
>
> _The status condition returned by the UICC shall be SW1=\'90\', SW2=\'00\' -
> normal ending of the command [CR1, CR2, CR5]._
g) The ME simulator shall send a SEARCH RECORD command using the record number
\'02\', the \'simple backward search from record indicated in P1\' mode and
search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
> _The response data shall be \'02 01\' indicating that the first and second
> record have been found [CR3a, CR8b]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
h) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the second record in EF~SMS~
> [CR4]._
i) The ME simulator shall send a SEARCH RECORD command using the record number
\'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A2 A3 A4\' with Le = \'00\' to the UICC.
> _No data shall be returned by the UICC as this search pattern can not be
> found in any of the records [CR7a]._
>
> _The status condition returned by the UICC shall be either SW1 = \'90\', SW2
> = \'00\' - normal ending of the command or SW1 = \'62\', SW2 = \'82\' - end
> of file/record reached before reading Le bytes or unsuccessful search._
j) The ME simulator shall send a READ RECORD command using CURRENT mode to the
UICC.
> _The record data returned shall be that of the second record in EF~SMS~
> [CR13]._
k) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
l) The ME simulator shall send a SEARCH RECORD command using the record number
\'00\' (current record), the \'simple forward search from record indicated in
P1\' mode, search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
_The UICC shall return an error code appropriate to the command, as no current
record exists._
m) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
n) The ME simulator shall send a SEARCH RECORD command using the record number
\'00\' (current record), the \'simple forward search from record indicated in
P1\' mode, search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
> _The response data shall be \'01 02 03 04\' indicating that the first,
> second, third and fourth record have been found [CR3a, CR8a]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
o) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
p) The ME simulator shall send a SEARCH RECORD command using the record number
\'00\' (current record), the \'simple backward search from record indicated in
P1\' mode, search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
_The UICC shall return an error code appropriate to the command, as no current
record exists._
q) The ME simulator shall send a READ RECORD command using PREVIOUS mode to
the UICC.
r) The ME simulator shall send a SEARCH RECORD command using the record number
\'00\' (current record), the \'simple backward search from record indicated in
P1\' mode, search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC.
> _The response data shall be \'04 03 02 01\' indicating that the first,
> second, third and fourth record have been found [CR3a, CR8b]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
**Test procedure 2 (enhanced search)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'enhanced forward search from record indicated in P1\' mode,
search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC. The bit 4 of the
first byte in the search indication shall be set to \'0\' and the second byte
shall be set to \'03\' indicating that the search shall start from that
offset.
> _The data returned shall be \'02 03\' indicating that the second and third
> records have been found [CR3b, CR9b]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
f) The ME simulator shall send a SEARCH RECORD command using the record number
= \'02\', the \'enhanced backward search from record indicated in P1\' mode,
search pattern \'A0 A1 A2 B0\' with Le = \'00\' to the UICC. The bit 4 of the
first byte in the search indication shall be set to \'0\' and the second byte
shall be set to \'03\' indicating that the search shall start from that
offset.
> _The response data shall be \'02\' indicating that the second record has
> been found [CR3b, CR9b]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
g) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced forward search from next record\' mode, search pattern \'A1
A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'0\' and the second byte shall be set to \'07\'
indicating that the search shall start from that offset.
> _The response data shall be \'03\' indicating that the third record has been
> found [CR3b, CR9c]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
h) The ME simulator shall send a SEARCH RECORD command using the P1 = \'01\',
the \'enhanced forward search from next record\' mode, search pattern \'A1
A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'0\' and the second byte shall be set to \'07\'
indicating that the search shall start from that offset.
> _The UICC shall return an error code appropriate to the command [CR10]._
i) The ME simulator shall send a SEARCH RECORD command using the P1 = \'04\',
the \'enhanced backward search from previous record\' mode, search pattern
\'A1 A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the
search indication shall be set to \'0\' and the second byte shall be set to
\'07\' indicating that the search shall start from that offset.
> _The UICC shall return an error code appropriate to the command [CR10]._
j) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced backward search from previous record\' mode, search pattern
\'B1 B2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the
search indication shall be set to \'0\' and the second byte shall be set to
\'07\' indicating that the search shall start from that offset.
> _The response data shall be \'02\' indicating that the second record has
> been found [CR3b, CR9d]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
k) The ME simulator shall send a SEARCH RECORD command using the record number
= \'03\', the \'enhanced forward search from record indicated in P1\' mode,
search pattern \'B1 B2 A0\' with Le = \'00\' to the UICC. The bit 4 of the
first byte in the search indication shall be set to \'1\' and the second byte
shall be set to \'B0\' indicating that the search shall start after the first
occurrence of the value.
> _The response data shall be \'03\' indicating that the third record has been
> found [CR3c, CR9a]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
l) The ME simulator shall send a SEARCH RECORD command using the record number
= \'02\', the \'enhanced backward search from record indicated in P1\' mode,
search pattern \'B1 B2 A0\' with Le = \'00\' to the UICC. The bit 4 of the
first byte in the search indication shall be set to \'1\' and the second byte
shall be set to \'B0\' indicating that the search shall start after the first
occurrence of the value.
> _The response data shall be \'02 01\' indicating that the first and second
> record has been found [CR3c, CR9b]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
m) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced forward search from next record\' mode, search pattern \'B0
B1\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'1\' and the second byte shall be set to \'A2\'
indicating that the search shall start after the first occurrence of the
value.
> _The response data shall be \'03 04\' indicating that the third and fourth
> record have been found [CR3c, CR9c]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
n) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced backward search from previous record\' mode, search pattern
\'B0 B1\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the
search indication shall be set to \'1\' and the second byte shall be set to
\'A2\' indicating that the search shall start after the first occurrence of
the value.
> _The response data shall be \'02 01\' indicating that the first and second
> record have been found [CR3c, CR9d]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
o) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced forward search from next record\' mode, search pattern \'FF
B0\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'1\' and the second byte shall be set to \'FF\'
indicating that the search shall start after the first occurrence of the
value.
> _No data shall be returned by the UICC as this search pattern can not be
> found in any of the records [CR7a]._
>
> _The status condition returned by the UICC shall be either SW1 = \'90\', SW2
> = \'00\' - normal ending of the command or SW1 = \'62\', SW2 = \'82\' - end
> of file/record reached before reading Le bytes or unsuccessful search._
p) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
q) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced forward search from record indicated in P1\' mode, search
pattern \'A0 A1 A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte
in the search indication shall be set to \'0\' and the second byte shall be
set to \'00\' indicating that the search shall start from that offset.
_The UICC shall return an error code appropriate to the command, as no current
record exists._
r) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced forward search from next record\' mode, search pattern \'A0 A1
A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'0\' and the second byte shall be set to \'00\'
indicating that the search shall start from that offset.
> _The response data shall be \'01 02 03 04\' indicating that the first,
> second, third and fourth record have been found [CR 11]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
s) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced forward search from next record\' mode, search pattern \'A0 A1
A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'0\' and the second byte shall be set to \'00\'
indicating that the search shall start from that offset.
> _The response data shall be \'02 03 04\' indicating that the second, third
> and fourth record have been found [CR4, CR9c]_
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
t) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
u) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced backward search from record indicated in P1\' mode, search
pattern \'A0 A1 A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte
in the search indication shall be set to \'0\' and the second byte shall be
set to \'00\' indicating that the search shall start from that offset.
_The UICC shall return an error code appropriate to the command, as no current
record exists._
v) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced backward search from previous record\' mode, search pattern
\'A0 A1 A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the
search indication shall be set to \'0\' and the second byte shall be set to
\'00\' indicating that the search shall start from that offset.
> _The response data shall be \'04 03 02 01\' indicating that the first,
> second, third and fourth record have been found [CR12]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
w) The ME simulator shall send a SEARCH RECORD command using the P1 = \'00\',
the \'enhanced backward search from previous record\' mode, search pattern
\'A0 A1 A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the
search indication shall be set to \'0\' and the second byte shall be set to
\'00\' indicating that the search shall start from that offset.
> _The response data shall be \'03 02 01\' indicating that the first, second
> and third record have been found [CR4, CR9d]._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
x) The ME simulator shall send a SEARCH RECORD command using the P1 = \'01\',
the \'enhanced forward search from next record\' mode, search pattern \'A0 A1
A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the search
indication shall be set to \'0\' and the second byte shall be set to \'00\'
indicating that the search shall start from that offset.
> _The UICC shall return an error code appropriate to the command [CR 10]._
y) The ME simulator shall send a SEARCH RECORD command using the P1 = \'01\',
the \'enhanced backward search from previous record\' mode, search pattern
\'A0 A1 A2\' with Le = \'00\' to the UICC. The bit 4 of the first byte in the
search indication shall be set to \'0\' and the second byte shall be set to
\'00\' indicating that the search shall start from that offset.
_The UICC shall return an error code appropriate to the command [CR 10]._
z) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'enhanced forward search from record indicated in P1\' mode and
search pattern \'A0 A2 A3 A4\' with Le = \'00\' to the UICC. The bit 4 of the
first byte in the search indication shall be set to \'0\' and the second byte
shall be set to \'03\' indicating that the search shall start from that
offset.
> _No data shall be returned by the UICC as this search pattern can not be
> found in any of the records [CR7a]._
>
> _The status condition returned by the UICC shall be either SW1 = \'90\', SW2
> = \'00\' - normal ending of the command or SW1 = \'62\', SW2 = \'82\' - end
> of file/record reached before reading Le bytes or unsuccessful search._
>
> aa) The ME simulator shall send a READ RECORD command using CURRENT mode to
> the UICC.
>
> _The record data returned shall be that of the third record in EF~SMS~
> [CR13]._
**Test procedure 3 (SFI)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
d) The ME simulator shall send a SEARCH RECORD command using the SFI of
EF~ECC~, the record number = \'01\', the \'simple forward search from record
indicated in P1\' mode and search pattern \'21 F2 FF\' with Le = \'00\' to the
UICC.
> _The data returned shall be \'01\' indicating that the first record has been
> found._
_The status condition returned shall be SW1 = \'90\', SW2 = \'00\' - normal
ending of the command [CR14]._
e) The ME simulator shall send a SEARCH RECORD command using the SFI of
EF~ECC~, the record number = \'01\', the \'simple forward search from record
indicated in P1\' mode and search pattern \'22 F2 FF\' with Le = \'00\' to the
UICC.
_No data shall be returned by the UICC as this search pattern can not be found
in any of the records._
f) The ME simulator shall send a READ RECORD command using NEXT mode to the
UICC.
_The record data returned shall be that of the first record in EF~ECC~
[CR15]._
**Test procedure 4 (Only applicable for T=1 protocol)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select EF~SMS~.
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A1 A2 B0\' with an empty Le to the UICC.
> _The UICC shall not return any response data bytes [CR7a]._
>
> _The status condition returned by the UICC shall be SW1=\'90\', SW2=\'00\' -
> normal ending of the command._
f) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A2 A3 A4\' with Le = \'01\' to the UICC.
> _No data shall be returned by the UICC as this search pattern can not be
> found in any of the records [CR7a]._
>
> _The status condition returned by the UICC shall be either SW1 = \'90\', SW2
> = \'00\' - normal ending of the command or SW1 = \'62\', SW2 = \'82\' - end
> of file/record reached before reading Le bytes or unsuccessful search._
g) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A1 A2 B0\' with Le = \'01\' to the UICC.
> _The data returned shall be \'01\' indicating that the first record has been
> found [CR7b]._
>
> _The status condition returned by the UICC shall be SW1=\'90\', SW2=\'00\' -
> normal ending of the command._
h) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'simple forward search from record indicated in P1\' mode and
search pattern \'A0 A1 A2 B0\' with Le = \'04\' to the UICC.
> _The data returned shall be \'01 02 03 04\' indicating that the first,
> second, third and fourth record have been found [CR7b]._
>
> _The status condition returned by the UICC shall be SW1=\'90\', SW2=\'00\' -
> normal ending of the command._
i) The ME simulator shall send a SEARCH RECORD command using the record number
= \'01\', the \'enhanced forward search from record indicated in P1\' mode,
search pattern \'A0 A1 A2 B0\' with Le = \'04\' to the UICC. The bit 4 of the
first byte in the search indication shall be set to \'0\' and the second byte
shall be set to \'03\' indicating that the search shall start from that
offset.
> _The data returned shall be \' 02 03\' indicating that the second and third
> record have been found [CR7b]._
#### 6.8.1.8 INCREASE
##### 6.8.1.8.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.8.2 Conformance requirement
* * *
CR1 This function shall add the value given by the terminal to the value of
the last increased/updated record of the current cyclic EF and store the
result into the oldest record. M CR2 The record pointer shall be set to this
record and this record becomes the record number 1. M CR3 The function shall
only be used if the INCREASE access condition is fulfilled. M CR4 The function
shall accept the input as the value to be added. M CR5 The function shall
output the value of the increased record and the value which has been added. M
CR6 The UICC shall not perform the INCREASE if the result would exceed the
maximum value of the record (represented by all bytes set to \'FF\'). M CR7
This command shall only be used on files that refer to an access rule where
this INS code is indicated as part of the rule. M
* * *
Reference: TS 102.221 [1], subclause 11.1.8.
##### 6.8.1.8.3 Test purpose
To verify that the INCREASE function conforms to the above requirements.
##### 6.8.1.8.4 Method of test
NOTE 1: When EF ~ACM~ is not supported by the USIM application, any other
cyclic EF which have the INCREASE access condition assigned may be used. In
such case, the length of the value to be sent with an INCREASE command shall
be equal to the record length of that EF.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) Each record in EF~ACM~ shall contain the data \'00 00 01\'.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select EF~ACM~.
d) The ME simulator shall send an INCREASE command with value \'00 00 02\' to
the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
-- security status not satisfied [CR3]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
f) The ME simulator shall send an INCREASE command with value \'00 00 03\' to
the UICC.
_The response data shall be \'00 00 04 00 00 03\' [CR1, CR4, CR5]._
g) The ME simulator shall send an INCREASE command with value \'01 02 00\' to
the UICC.
_The response data shall be \'01 02 04 01 02 00\' [CR1]._
h) The ME simulator shall send a READ RECORD command using ABSOLUTE mode with
record 1 to the UICC.
_The data read shall be \'01 02 04\' [CR2]._
i) The ME simulator shall send an INCREASE command with value \'FF 00 00\' to
the UICC.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'50\' - INCREASE cannot be performed, maximum value reached [CR6]._
j) The ME simulator shall send an INCREASE command with value \'00 FF FD\' to
the UICC.
_The response data shall be \'02 02 01 00 FF FD\' [CR5]._
k) The ME simulator shall send a SELECT command to the UICC to select EF~ICI~.
l) The ME simulator shall send an INCREASE command with value \'01 02 00\' to
the UICC.
_The UICC shall return an error code appropriate to the command [CR7]._
#### 6.8.1.9 VERIFY PIN
##### 6.8.1.9.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.9.2 Conformance requirement
+------+---------------------------------------------------------+---+ | CR1 | This command shall initiate the comparison in the UICC | M | | | of the PIN verification data sent from the terminal | | | | with the PIN reference data stored in the card. | | +------+---------------------------------------------------------+---+ | CR2 | The function shall accept as an input, an indication of | M | | | PIN (key reference number), the PIN value, or empty. | | +------+---------------------------------------------------------+---+ | CR3 | The security status set as a result of the verification | M | | | process is valid regardless on which logical channel | | | | the verification is performed. | | +------+---------------------------------------------------------+---+ | CR4 | The verification process shall be subject to the | M | | | following conditions being fulfilled: | | | | | | | | a) PIN is not disabled; | | | | | | | | b) PIN is not blocked. | | +------+---------------------------------------------------------+---+ | CR5 | If the access condition for a function to be performed | M | | | on the last selected file is PIN, then a successful | | | | verification of PIN shall be required prior to the use | | | | of the function on this file unless the PIN is | | | | disabled. | | +------+---------------------------------------------------------+---+ | CR6 | If the PIN presented is correct, the number of | M | | | remaining PIN attempts for that PIN shall be reset to | | | | its initial value 3. | | +------+---------------------------------------------------------+---+ | CR7 | If the PIN presented is false, the number of remaining | M | | | PIN attempts for that PIN shall be decremented, | | | | regardless on which logical channel the VERIFY PIN | | | | command was issued. | | +------+---------------------------------------------------------+---+ | CR8 | The UICC shall return SW1 SW2 = '63C2' after the first | M | | | false PIN presentation. | | +------+---------------------------------------------------------+---+ | CR9 | The UICC shall return SW1 SW2 = '63C1' after the second | M | | | consecutive false PIN presentation, not necessarily in | | | | the same card session. | | +------+---------------------------------------------------------+---+ | CR10 | After 3 consecutive false PIN presentations, not | M | | | necessarily in the same card session, the respective | | | | PIN shall be blocked and the UICC shall return SW1 SW2 | | | | = '63C0'. | | +------+---------------------------------------------------------+---+ | CR11 | Any subsequent VERIFY PIN command applied to this | M | | | blocked PIN shall return SW1 SW2 = '6983'. | | +------+---------------------------------------------------------+---+ | CR12 | The access condition can never be fulfilled until the | M | | | UNBLOCK PIN function has been successfully performed on | | | | the respective PIN. | | +------+---------------------------------------------------------+---+ | CR13 | The VERIFY PIN with empty data field is used to | M | | | retrieve the PIN retry counter from the UICC. The | | | | parameter P2 indicates the PIN for which the retry | | | | counter value is to be retrieved. | | +------+---------------------------------------------------------+---+ | CR14 | The VERIFY PIN with empty data field function is | M | | | performed whether or not the relevant PIN is disabled | | | | or blocked (e.g. by 3 consecutive wrong PIN | | | | presentations). | | +------+---------------------------------------------------------+---+ | CR15 | The number of retries, if any is indicated in the | M | | | response by SW1 SW2 = '63CX', where X indicates the | | | | number of retries left. | | +------+---------------------------------------------------------+---+ | CR16 | A VERIFY PIN command with empty data field applied to a | M | | | blocked PIN shall return SW1 SW2 = '63C0' or SW1 SW2 = | | | | '6983'. | | +------+---------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 11.1.9.
##### 6.8.1.9.3 Test purpose
To verify that the VERIFY PIN function conforms to the above requirements.
NOTE 1: This function is only tested for PIN. It is assumed that if the
function operates correctly for PIN, it will also operate correctly for PIN2
or other PIN.
NOTE 2: CR3 is tested in subclause 6.5.7.
##### 6.8.1.9.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
d) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - access condition not fulfilled [CR5]._
e) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
f) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR5]._
g) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR7, CR15]._
h) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
i) The ME simulator shall send a VERIFY PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR6, CR13]._
j) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempt left [CR8]._
k) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left [CR9]._
l) The ME simulator shall reset the UICC and select USIM application.
m) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempts left [CR10]._
n) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - unsuccessful PIN verification, no attempts left [CR11]._
o) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - PIN blocked [CR4, CR11]._
p) The ME simulator shall reset the UICC and select and activate USIM
application.
q) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - PIN blocked [CR4b, CR11]._
>
> r) The ME simulator shall send a SELECT command to the UICC to select
> EF~IMSI~.
>
> s) The ME simulator shall send a READ BINARY command using a length of 2
> bytes to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -_ security status not satisfied _[CR12]._
>
> t) The ME simulator shall send an UNBLOCK PIN command to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command_
>
> u) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR1 of subclause
> 6.8.1.13.2]._
>
> v) The ME simulator shall send a DISABLE PIN command to the UICC.
>
> w) The ME simulator shall reset the UICC.
>
> x) The ME simulator shall send a SELECT command to the UICC to select and
> activate USIM application.
>
> y) The ME simulator shall send a SELECT command to the UICC to select
> EF~IMSI~.
>
> z) The ME simulator shall send a READ BINARY command using a length of 2
> bytes to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR5]._
>
> aa) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
_The UICC shall return an error code appropriate to the command [CR4a]._
> bb)The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
**Test procedure 2**
> a) The ME simulator shall reset the UICC.
>
> b) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR7, CR15]._
>
> c) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC.
>
> _The UICC shall return the number of the assigned logical channel -- call
> this channel \'a.\'_
>
> d) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC on channel \'a\'.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR7, CR15]._
**Test procedure 3**
> a) The ME simulator shall reset the UICC.
>
> b) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempt left [CR8]._
>
> c) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left [CR9]._
>
> d) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempts left [CR10]._
>
> e) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, 0 attempts left or SW1 = \'69\', SW2
> = \'83\' -- authentication/PIN method blocked [CR14, CR16]._
#### 6.8.1.10 CHANGE PIN
##### 6.8.1.10.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.10.2 Conformance requirement
+-----+------------------------------+------------------------------+ | CR1 | This command shall be used | M | | | to initiate the comparison | | | | of the verification data | | | | with the PIN, and then to | | | | conditionally replace the | | | | existing PIN with the new | | | | PIN sent to the UICC in the | | | | command. | | +-----+------------------------------+------------------------------+ | CR2 | This function shall assign a | M | | | new value to the relevant | | | | PIN subject to the following | | | | conditions being fulfilled: | | | | | | | | a) PIN is not disabled; | | | | | | | | b) PIN is not blocked. | | +-----+------------------------------+------------------------------+ | CR3 | The function shall accept as | M | | | input, an indication of PIN | | | | (key reference number), the | | | | old and new PIN. | | +-----+------------------------------+------------------------------+ | CR4 | If the old PIN presented is | M | | | correct, the number of | | | | remaining PIN attempts for | | | | that PIN shall be reset to | | | | its initial value 3 and the | | | | new value for the PIN | | | | becomes valid. | | +-----+------------------------------+------------------------------+ | CR5 | If the old PIN presented is | M | | | false, the number of | | | | remaining PIN attempts for | | | | that PIN shall be | | | | decremented and the value of | | | | the PIN shall remain | | | | unchanged. | | +-----+------------------------------+------------------------------+ | CR6 | After 3 consecutive false | M | | | PIN presentations, not | | | | necessarily in the same card | | | | session, the respective PIN | | | | shall be blocked and the | | | | access condition can never | | | | be fulfilled until the | | | | UNBLOCK PIN function has | | | | been performed successfully | | | | on the respective PIN. | | +-----+------------------------------+------------------------------+ | CR7 | Once successfully changed on | (Rel-4) Rel-6 - ...: | | | a logical channel, the new | O_LOG_CHANS | | | value is immediately | | | | available to all channels. | | +-----+------------------------------+------------------------------+
Reference: TS 102.221 [1], subclause 11.1.10.
##### 6.8.1.10.3 Test purpose
To verify that the CHANGE PIN function conforms to the above requirements.
NOTE: This function is only tested for PIN. It is assumed that if the function
operates correctly for PIN, it will also operate correctly for PIN2 or other
PIN.
##### 6.8.1.10.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) PIN of the UICC shall be set to \'00000000\'.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a CHANGE PIN command with an incorrect old PIN
and new PIN of \'33333333\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR5]._
d) The ME simulator shall send a CHANGE PIN command with a correct old PIN and
new PIN of \'33333333\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2, CR3]._
e) The ME simulator shall send a VERIFY PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR4]._
f) The ME simulator shall send a VERIFY PIN command with a new PIN of
\'33333333\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR4]._
g) The ME simulator shall send a CHANGE PIN command with an incorrect old PIN
and new PIN of \'55555555\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR5]._
h) The ME simulator shall send a CHANGE PIN command with an incorrect old PIN
and new PIN of \'55555555\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left [CR5]._
i) The ME simulator shall reset the UICC.
j) The ME simulator shall send a CHANGE PIN command with an incorrect old PIN
and new PIN of \'55555555\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempt left [CR5]._
k) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - PIN blocked [CR6]._
l) The ME simulator shall reset the UICC.
m) The ME simulator shall send a CHANGE PIN command with an old PIN of
\'33333333\' and new PIN of \'55555555\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - PIN blocked [CR2b]._
n) The ME simulator shall send an UNBLOCK PIN command with Unblock PIN and a
new PIN of \'55555555\' to the UICC.
> o) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' -unsuccessful PIN verification, 3 attempts left [CR1 of subclause
> 6.8.1.13.2]._
p) The ME simulator shall send a VERIFY PIN command with a new PIN of
\'55555555\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
q) The ME simulator shall send a DISABLE PIN command to the UICC.
r) The ME simulator shall reset the UICC.
s) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
t) The ME simulator shall send a CHANGE PIN command with an old PIN
\'55555555\' and new PIN of \'77777777\' to the UICC.
> _The UICC shall return an error code appropriate to the command [CR2a]._
u) The ME simulator shall send an ENABLE PIN command to the _UICC_ with PIN
\'55555555\'.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
v) The ME simulator shall send a CHANGE PIN command with an old PIN
\'55555555\' and new PIN of \'00000000\' to the UICC.
    **Test procedure 2**
> a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a CHANGE PIN command with an old PIN
\'00000000\' and new PIN of \'55555555\' to the UICC.
> c) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the
> _UICC_.
>
> _The UICC shall return the number of the assigned logical channel -- call
> this channel \'a\'._
>
> d) The ME simulator shall send a VERIFY PIN command with a PIN of
> \'55555555\' to the _UICC on channel \'a\'_.
>
> The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR7].
e) The ME simulator shall send a CHANGE PIN command with an old PIN
\'55555555\' and new PIN of \'00000000\' to the UICC.
#### 6.8.1.11 DISABLE PIN
##### 6.8.1.11.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.11.2 Conformance requirement
* * *
CR1 This function shall switch off the requirement to compare the PIN
verification data with the PIN reference data. M CR2 The command shall allow
an indication whether to use an alternative global key reference, if enabled,
or not when the application PIN is disabled. M CR3 If an alternative global
key reference is used as a replacement for the application PIN, the usage
qualifier in the PS_DO template data object for the alternative global key
reference is set to \"use\" = \'08\' and the verification of the alternative
global key reference shall be performed instead of the application PIN
verification to get access to the application. M CR4 The successful execution
of this function shall have the effect that files protected by PIN are now
accessible as if they were marked \"ALWAYS\", except in the case where the
alternative global key reference is to be used as a replacement for the
disabled PIN. M CR5 In the case where the alternative global key reference is
to be used as a replacement for the disabled PIN, the access condition for
files containing only a reference to the disabled PIN is the alternative
global key reference. M CR6 The function shall accept as input, PIN indication
and PIN. M CR7 The function shall accept as input, Global key reference data
number for verification replacement, PIN indication and PIN. M CR8 For files
having more than one global key reference indicated in the access rules the
access condition is \"ALWAYS\" after disabling on of the key references used
in the access rules. M CR9 The function shall not be executed by the UICC when
PIN is already disabled or blocked. M CR10 If the PIN presented is correct,
the number of remaining PIN attempts shall be reset to its initial value 3 and
PIN shall be disabled. M CR11 If the PIN presented is false, the number of
remaining PIN attempts shall be decremented and PIN remains enabled. M CR12
After 3 consecutive false PIN presentations, not necessarily in the same card
session, the PIN shall be blocked and the access condition can never be
fulfilled until the UNBLOCK PIN function has been successfully performed on
PIN. M CR13 The UICC shall perform a validation of the SE after the successful
execution of this command as the current SE may have changed and this shall
affect the access to files. Rel-4 - ...
* * *
Reference: TS 102.221 [1], subclause 11.1.11.
##### 6.8.1.11.3 Test purpose
To verify that the DISABLE PIN function conforms to the above requirements.
> NOTE 1: The test procedure for an alternative global key reference is not
> included as it is out of the scope of the present document.
>
> NOTE 2: CR13 is not tested.
##### 6.8.1.11.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
d) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - access condition not fulfilled._
e) The ME simulator shall send a DISABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR11]._
f) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - access condition not fulfilled [CR11]._
g) The ME simulator shall send a STATUS command to the UICC.
> _The following shall be true of the response data [CR11]:_
>
> _TLV DO with tag \'90\' in tag \'C6\' in tag \'62\' shall be \'80\'
> indicating that PIN is still enabled._
h) The ME simulator shall send a VERIFY PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left [CR11]._
i) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR6]._
j) The ME simulator shall send a STATUS command to the UICC.
> _The following shall be true of the response data [CR10]:_
>
> _\- TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is disabled._
k) The ME simulator shall send a VERIFY PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR10]._
l) The ME simulator shall reset the UICC.
m) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
n) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
o) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
p) The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
q) The ME simulator shall send a DISABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempt left._
r) The ME simulator shall send a DISABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left._
s) The ME simulator shall reset the UICC.
t) The ME simulator shall send a DISABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempt left [CR12]._
>
> u) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - unsuccessful PIN verification, no attempt left [CR7, CR8b]._
v) The ME simulator shall reset the UICC.
w) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - PIN blocked [CR9]._
x) The ME simulator shall send an UNBLOCK PIN command with Unblock PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
>
> y) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR1 of subclause
> 6.8.1.13.2]._
>
> z) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR6]._
>
> aa) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
>
> _The UICC shall return an error code appropriate to the command [CR9]._
>
> bb) The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
#### 6.8.1.12 ENABLE PIN
##### 6.8.1.12.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.12.2 Conformance requirement
* * *
CR1 This function shall switch on the requirement to compare the PIN
verification data with the PIN reference data. M CR2 The function shall not be
executed by the UICC when PIN is already enabled or blocked. M CR3 If the PIN
presented is correct, the number of remaining PIN attempts shall be reset to
its initial value 3 and PIN shall be enabled. M CR4 If the PIN presented is
false, the number of remaining PIN attempts shall be decremented and PIN shall
remains disabled. M CR5 After 3 consecutive false PIN presentations, not
necessarily in the same card session, PIN shall be blocked. M CR6 If the PIN
is blocked and enabled, the access condition can never be fulfilled until the
UNBLOCK PIN function has been successfully performed on PIN. M CR7 The
function shall accept as input, PIN. M CR8 The usage of the alternative global
key reference as a replacement shall be disabled upon enabling the PIN for
which the alternative global key reference has been a replacement (setting the
usage qualifier in the PS_DO template data object for the alternative global
key reference to do not use = '00'). M CR9 If the PIN is blocked and disabled,
the access condition shall remain granted. M CR10 The UICC shall perform a
validation of the SE after successful execution of this command as the current
SE may have changed and this shall affect the access to files. Rel-4 - ...
* * *
Reference: TS 102.221 [1], subclause 11.1.12.
##### 6.8.1.12.3 Test purpose
To verify that the ENABLE PIN function conforms to the above requirements.
NOTE 1: CR8 is tested in subclause 6.6.5.
> NOTE 2: CR10 is not tested.
##### 6.8.1.12.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
c) The ME simulator shall reset the UICC.
d) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
e) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
f) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
g) The ME simulator shall send an ENABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' -- unsuccessful PIN verification, 2 attempts left [CR4]._
h) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
i) The ME simulator shall send a STATUS command to the UICC.
> _The following shall be true of the response data [CR4]:_
>
> _\- TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is still disabled._
j) The ME simulator shall send an ENABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left._
k) The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2, CR7]._
l) The ME simulator shall send a STATUS command to the UICC.
> _The following shall be true of the response data [CR4]:_
>
> _\- TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is now enabled._
m) The ME simulator shall send a VERIFY PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR3]_
n) The ME simulator shall reset the UICC.
o) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
p) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
q) The ME simulator shall send a READ BINARY command using a length of 2 bytes
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - access condition not fulfilled [CR1]._
r) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
- normal ending of the command._
s) The ME simulator shall send an ENABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempt left._
t) The ME simulator shall send an ENABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left._
u) The ME simulator shall reset the UICC.
v) The ME simulator shall send an ENABLE PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempt left [CR5]._
w) The ME simulator shall send an ENABLE PIN command with incorrect PIN to the
UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'83\'
-- PIN blocked [CR5]._
x) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
y) The ME simulator shall send a SELECT command to the UICC to select
EF~IMSI~.
z) The ME simulator shall send a STATUS command to the UICC.
> _If TLV DO with tag \'90\' in the PS template DO of the response data
> indicates that PIN is enabled, then aa1) to aa3) shall be carried out._
>
> _If TLV DO with tag \'90\' in the PS template DO of the response data
> indicates that PIN is disabled, then aa4) to aa6) shall be carried out._
>
> aa1)The ME simulator shall send a READ BINARY command using a length of 2
> bytes to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
- security status not satisfied [CR6]._
> aa2)The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'83\'
- PIN blocked._
> aa3)The ME simulator shall send a UNBLOCK PIN command with Unblock PIN to
> the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
- normal ending of the command._
aa4)The ME simulator shall send a READ BINARY command using a length of 2
bytes to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR9]._
>
> aa5)The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - PIN blocked [CR2]._
>
> aa6)The ME simulator shall send a UNBLOCK PIN command with Unblock PIN to
> the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
- normal ending of the command._
> bb) The ME simulator shall reset the UICC.
>
> cc) The ME simulator shall send a STATUS command to the UICC.
_The following shall be true of the response data [CR5]:_
> _The TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is enabled._
>
> dd) The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
_The UICC shall return an error or warning code appropriate to the command
[CR2]._
#### 6.8.1.13 UNBLOCK PIN
##### 6.8.1.13.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.13.2 Conformance requirement
+------+---------------------------------------------------------+---+ | CR1 | This function shall be used to reset the PIN retry | M | | | counter to its initial value and then to conditionally | | | | set a new PIN value. | | +------+---------------------------------------------------------+---+ | CR2 | The function shall accept as input, an indication of | M | | | PIN, the Unblock PIN and the new PIN. | | +------+---------------------------------------------------------+---+ | CR3 | This function shall be performed regardless of whether | M | | | or not the relevant PIN is blocked. (e.g. by 3 | | | | consecutive wrong PIN verifications). | | +------+---------------------------------------------------------+---+ | CR4 | The unblocking process is subject to the following | M | | | condition being fulfilled: | | | | | | | | - UNBLOCK PIN is not blocked. | | +------+---------------------------------------------------------+---+ | CR5 | If the Unblock PIN presented is correct, the new PIN | M | | | value, presented together with the Unblock PIN shall be | | | | stored in the relevant EF, the number of remaining | | | | UNBLOCK PIN attempts for that Unblock PIN shall be | | | | reset to its initial value 10 and the number of | | | | remaining PIN attempts for that PIN shall be reset to | | | | its initial value 3. | | +------+---------------------------------------------------------+---+ | CR6 | After a successful unblocking attempt, the PIN shall be | M | | | enabled, and the relevant access condition level | | | | satisfied the new PIN value is available for all | | | | channels. | | +------+---------------------------------------------------------+---+ | CR7 | If the presented Unblock PIN is false, the number of | M | | | remaining UNBLOCK PIN attempts for that Unblock PIN, | | | | regardless on which logical channel the UNBLOCK PIN | | | | command was issued, shall be decremented. | | +------+---------------------------------------------------------+---+ | CR8 | The UICC shall return SW1 SW2 = '63C9', '63C8', ..., | M | | | '63C1' for up to the ninth consecutive false UNBLOCK | | | | PIN presentation, not necessarily in the same card | | | | session. | | +------+---------------------------------------------------------+---+ | CR9 | After 10 consecutive false Unblock PIN presentations, | M | | | not necessarily in the same card session, the | | | | respective Unblock PIN shall be blocked and the UICC | | | | shall return SW1 SW2 = \'63 C0\'. | | +------+---------------------------------------------------------+---+ | CR10 | A false Unblock PIN shall have no effect on the status | M | | | of the respective PIN itself. | | +------+---------------------------------------------------------+---+ | CR11 | The UNBLOCK PIN with empty data field is used to | M | | | retrieve the UNBLOCK PIN retry counter from the UICC. | | | | The parameter P2 indicates the PIN for which the retry | | | | counter value is to be retrieved. | | +------+---------------------------------------------------------+---+ | CR12 | The UNBLOCK PIN with empty data field function is | M | | | performed whether or not the relevant PIN is disabled | | | | or blocked (e.g. by 3 consecutive wrong PIN | | | | presentations). | | +------+---------------------------------------------------------+---+ | CR13 | The number of retries, if any is indicated in the | M | | | response by SW1 SW2 = '63CX', where X indicates the | | | | number of retries left. | | +------+---------------------------------------------------------+---+ | CR14 | An UNBLOCK PIN command with empty data field applied to | M | | | a blocked PIN shall return SW1 SW2 = '63C0' or SW1 SW2 | | | | = '6983'. | | +------+---------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 11.1.13.
##### 6.8.1.13.3 Test purpose
To verify that the UNBLOCK PIN function conforms to the above requirements.
NOTE 1: CR1 is tested in subclauses 6.8.1.9, 6.8.1.10, 6.8.1.11, 6.8.1.12.
NOTE 2: This function is only tested for PIN. It is assumed that if the
function operates correctly for PIN, it will also operate correctly for PIN2
or other PIN.
##### 6.8.1.13.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send an UNBLOCK PIN command with incorrect Unblock
PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C9\' - unsuccessful Unblock PIN verification, 9 attempts left [CR3, CR8]._
d) The ME simulator shall send a STATUS command to the UICC.
> _The following shall be true of the response data [CR10]:_
>
> _\- TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is enabled._
e) The ME simulator shall send a VERIFY PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left._
f) The ME simulator shall send an UNBLOCK PIN command with an empty data field
to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C9\' - unsuccessful PIN verification, 9 attempts left [CR11, CR13]._
g) The ME simulator shall send a DISABLE PIN command with PIN to the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command._
h) The ME simulator shall send an UNBLOCK PIN command with incorrect Unblock
PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C8\' - unsuccessful Unblock PIN verification, 8 attempts left [CR7]._
i) The ME simulator shall send a STATUS command to the UICC.
> _The following shall be true of the response data [CR10]:_
>
> _\- TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is disabled._
j) The ME simulator shall send an ENABLE PIN command with PIN to the UICC.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command._
k) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempts left._
>
> l) The ME simulator shall send an UNBLOCK PIN command with Unblock PIN and
> new PIN \'33333333\' to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2]._
>
> m) The ME simulator shall send a STATUS command to the UICC.
>
> _The following shall be true of the response data [CR5, CR6]:_
>
> _\- TLV DO with tag \'90\' in the PS template DO of the response data shall
> indicate that PIN is enabled_.
>
> n) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR5]._
>
> o) The ME simulator shall send a VERIFY PIN command with the new PIN to the
> UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
>
> p) The ME simulator shall send an UNBLOCK PIN command with an empty data
> field to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'CA\' - unsuccessful PIN verification, 10 attempts left [CR5, CR11, CR13]._
>
> q) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempt left._
r) The ME simulator shall send a VERIFY PIN command with incorrect PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left._
>
> s) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempt left._
>
> t) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - unsuccessful PIN verification, no attempt left._
>
> u) The ME simulator shall send an UNBLOCK PIN command with Unblock PIN and
> new PIN \'00000000\' to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR3]._
>
> v) The ME simulator shall send a VERIFY PIN command with an empty data field
> to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C3\' - unsuccessful PIN verification, 3 attempts left [CR3]._
**Test procedure 2 - *** Destructive test *****
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send 9 UNBLOCK PIN command with incorrect Unblock
PIN to the UICC.
> _The status condition returned by the UICC each time shall be SW1 = \'63\',
> SW2 = \'CX\' - unsuccessful Unblock PIN verification \'X\' retries
> remaining. After 9 times of unsuccessful Unblock PIN verification, the SW
> shall be SW1 = \'63\', SW2 = \'C1\', at least one attempt left [CR8, CR7]._
c) The ME simulator shall reset the UICC.
d) The ME simulator shall send an UNBLOCK PIN command with incorrect Unblock
PIN to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful Unblock PIN verification, no attempt left [CR9]._
e) The ME simulator shall send an UNBLOCK PIN command with Unblock PIN to the
UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'83\' - Unblock PIN blocked [CR9]._
**Test procedure 3**
> a) The ME simulator shall reset the UICC.
>
> b) The ME simulator shall send a SELECT command to the UICC to select and
> activate USIM application.
>
> c) The ME simulator shall send an UNBLOCK PIN command with incorrect Unblock
> PIN to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C9\' - unsuccessful Unblock PIN verification, 9 attempts left [CR3, CR8]._
>
> d) The ME simulator shall send an UNBLOCK PIN command with incorrect Unblock
> PIN to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C8\' - unsuccessful Unblock PIN verification, 8 attempts left [CR7]._
>
> e) The ME simulator shall send an UNBLOCK PIN command with an empty data
> field to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C8\' - unsuccessful PIN verification, 8 attempts left [CR12]._
>
> f) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C2\' - unsuccessful PIN verification, 2 attempt left._
>
> g) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C1\' - unsuccessful PIN verification, 1 attempt left._
>
> h) The ME simulator shall send a VERIFY PIN command with incorrect PIN to
> the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C0\' - unsuccessful PIN verification, no attempt left._
>
> i) The ME simulator shall send an UNBLOCK PIN command with an empty data
> field to the UICC.
>
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'CA\' - unsuccessful PIN verification, 10 attempts left [CR12, CR14]._
**Test procedure 4**
a) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC.
_The UICC shall return the assigned logical channel -- call this channel
\'a\'._
b) The ME simulator shall send a VERIFY PIN command with a PIN of \'00000000\'
to the UICC on channel \'a\'.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
-- normal ending of the command [CR6]._
c) The ME simulator shall send an UNBLOCK PIN command with an incorrect
Unblock PIN to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C9\' - unsuccessful Unblock PIN verification, 9 attempts left [CR3, CR8]._
d) The ME simulator shall send an UNBLOCK PIN command with an incorrect
Unblock PIN to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'C8\' - unsuccessful Unblock PIN verification, 8 attempts left [CR7]._
#### 6.8.1.14 DEACTIVATE FILE
##### 6.8.1.14.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.14.2 Conformance requirement
+-----+----------------------------------------------------------+---+ | CR1 | This function shall deactivate the EF. | M | +-----+----------------------------------------------------------+---+ | CR2 | The target EF shall be selected by following ways: | M | | | | | | | a) Select by file id (P1 = \'00\'); | | | | | | | | b) Select by path from MF (P1 = \'08\'); | | | | | | | | c) Select by path from current DF (P1 = \'09\'). | | +-----+----------------------------------------------------------+---+ | CR3 | After a DEACTIVATE FILE function the respective flag in | M | | | the file LCSI_DO shall be changed accordingly. | | +-----+----------------------------------------------------------+---+ | CR4 | The function shall only be performed if the DEACTIVATE | M | | | FILE access condition for the designated EF is | | | | satisfied. | | +-----+----------------------------------------------------------+---+ | CR5 | In case of successful execution of the command, the EF | M | | | on which the command was applied shall become the | | | | current EF. | | +-----+----------------------------------------------------------+---+ | CR6 | After unsuccessful execution, the current EF and current | M | | | DF shall remain the same as prior to the execution. | | +-----+----------------------------------------------------------+---+ | CR7 | A deactivated file shall no longer be available within | M | | | the application for any function except for the SELECT | | | | and ACTIVATE FILE functions. | | +-----+----------------------------------------------------------+---+ | CR8 | If P1 = P2 = \'00\' and the data field is empty, then | M | | | the command shall apply to the current EF. | | +-----+----------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 11.1.14.
##### 6.8.1.14.3 Test purpose
To verify that the DEACTIVATE FILE function conforms to the above
requirements.
##### 6.8.1.14.4 Method of test
NOTE 1: Deactivation requires the verification of ADM, and the respective
requirements for their fulfilment are the responsibility of the appropriate
administrative authority. Therefore, the following test procedure shall be
understood as an example.
NOTE 2: When EF~CCP2~ under ADF~USIM~ is not supported by the UICC, any
supported linear fixed EF in the USIM application may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
Test procedure 1
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
c) The ME simulator shall send a DEACTIVATE FILE command using \"file ID
selection\" to the UICC to deactivate EF~CCP2~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - access condition not fulfilled [CR4]._
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
e) The ME simulator shall send a READ RECORD command to the UICC to read
record 1.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'86\' -- command not allowed (no EF selected) [CR6]._
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
h) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps).
i) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
> _The following shall be true of the response data:_
>
> _\- The value of Life Cycle Status Integer of the response data shall
> indicate that the EF is activated._
j) The ME simulator shall send a DEACTIVATE FILE command using \'file ID
selection\' to the UICC to deactivate EF~CCP2~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR2a, CR3, CR4]._
k) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
l) The ME simulator shall send an UPDATE RECORD command to the UICC to update
record 1.
> _The UICC shall return an error code appropriate to the command [CR5, CR7]._
m) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is deactivated._
_The status condition returned by the UICC shall be SW1 = \'62\', SW2 = \'83\'
-- selected file invalidated._
n) The ME simulator shall send an UPDATE RECORD command to the UICC to update
record 1.
> _The UICC shall return an error code appropriate to the command [CR7]._
o) The ME simulator shall send an ACTIVATE FILE command to the UICC to select
and activate EF~CCP2~.
p) The ME simulator shall reset the UICC.
q) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
r) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
s) The ME simulator shall send a DEACTIVATE command using \'path selection
from MF\' to the UICC to deactivate EF~CCP2~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
t) The ME simulator shall send a SELECT command to the UICC to select the
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is deactivated [CR2b]._
_The status condition returned by the UICC shall be SW1 = \'62\', SW2 = \'83\'
-- selected file invalidated_.
u) The ME simulator shall send an ACTIVATE FILE command to the UICC to select
and activate EF~CCP2~.
v) The ME simulator shall reset the UICC.
w) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
x) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
y) The ME simulator shall send a DEACTIVATE FILE command using \'path
selection from current DF\' to the UICC to deactivate EF~CCP2~.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
- normal ending of the command._
z) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is deactivated [CR2b]._
_The status condition returned by the UICC shall be SW1 = \'62\', SW2 = \'83\'
-- selected file invalidated._
a) The ME simulator shall send an ACTIVATE FILE command to the UICC to select
and activate EF~CCP2~.
b) The ME simulator shall reset the UICC.
c) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
d) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
e) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
f) The ME simulator shall send a DEACTIVATE FILE command with P1 = P2 = \'00\'
and with the empty data field to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR8]._
g) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is deactivated [CR8]._
_The status condition returned by the UICC shall be SW1 = \'62\', SW2 = \'83\'
-- selected file invalidated._
h) The ME simulator shall send an ACTIVATE FILE command to the UICC to select
and activate EF~CCP2~.
#### 6.8.1.15 ACTIVATE FILE
##### 6.8.1.15.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.15.2 Conformance requirement
+-----+----------------------------------------------------------+---+ | CR1 | This function shall activate a deactivated EF. | M | +-----+----------------------------------------------------------+---+ | CR2 | The target EF shall be selected by following ways: | M | | | | | | | a) Select by file id (P1 = \'00\'); | | | | | | | | b) Select by path from MF (P1 = \'08\'); | | | | | | | | c) Select by path from current DF (P1 = \'09\'). | | +-----+----------------------------------------------------------+---+ | CR3 | After an ACTIVATE FILE function the respective flag in | M | | | the file LCSI_DO byte shall be changed accordingly. | | +-----+----------------------------------------------------------+---+ | CR4 | The function shall only be performed if the ACTIVATE | M | | | FILE access condition for the designated EF is | | | | satisfied. | | +-----+----------------------------------------------------------+---+ | CR5 | In case of successful execution of the command, the EF | M | | | on which the command was applied shall become the | | | | current EF. | | +-----+----------------------------------------------------------+---+ | CR6 | After unsuccessful execution, the current EF and current | M | | | DF shall remain the same as prior to the execution. | | +-----+----------------------------------------------------------+---+ | CR7 | If P1 = P2 = \'00\' and the data field is empty, the | M | | | command shall be applicable to the current EF. | | +-----+----------------------------------------------------------+---+
Reference: TS 102.221 [1], subclause 11.1.15.
##### 6.8.1.15.3 Test purpose
To verify that the ACTIVATE FILE function conforms to the above requirements.
##### 6.8.1.15.4 Method of test
NOTE 1: Activation requires the verification of ADM, and the respective
requirements for their fulfilment are the responsibility of the appropriate
administrative authority. Therefore, the following test procedure shall be
understood as an example.
NOTE 2: When EF~CCP2~ under ADF~USIM~ is not supported by the UICC, any
supported linear fixed EF in the USIM application may be chosen.
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
a) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
b) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
c) The ME simulator shall send a DEACTIVATE FILE command to the UICC to
deactivate EF~CCP2~.
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
h) The ME simulator shall send an ACTIVATE FILE command using \'file ID
selection\' to the UICC to select and activate EF~CCP2~.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' - access condition not fulfilled [CR4]._
i) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
j) The ME simulator shall send a READ RECORD command to the UICC to read
record 1.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'86\' -- command not allowed (no EF selected) [CR6]._
k) The ME simulator shall reset the UICC.
l) The ME simulator shall send a SELECT command to the UICC to select and
activate the USIM application.
m) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
n) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is deactivated._
_The status condition returned by the UICC shall be SW1 = \'62\', SW2 = \'83\'
-- selected file invalidated._
o) The ME simulator shall send an ACTIVATE FILE command using \'file ID
selection\' to the UICC to select and activate EF~CCP2~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2a, CR3, CR4]._
p) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
q) The ME simulator shall send a READ RECORD command to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR5]._
r) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is activated._
s) The ME simulator shall send a DEACTIVATE FILE command to the UICC to
deactivate EF~CCP2~.
t) The ME simulator shall reset the UICC.
u) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
v) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
w) The ME simulator shall send an ACTIVATE command using \'path selection from
MF\' to the UICC to select and activate EF~CCP2~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
x) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is activated._
y) The ME simulator shall send a DEACTIVATE FILE command to the UICC to
deactivate EF~CCP2~.
z) The ME simulator shall reset the UICC.
a) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
b) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
c) The ME simulator shall send an ACTIVATE FILE command using \'path selection
from current DF\' to the UICC to select and activate EF~CCP2~.
_The status condition returned by the UICC shall be SW1 = \'90\', SW2 = \'00\'
- normal ending of the command._
d) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is activated._
e) The ME simulator shall send a DEACTIVATE FILE command to the UICC to
deactivate EF~CCP2~.
f) The ME simulator shall reset the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
h) The ME simulator shall gain the security access condition(s) specified for
both DEACTIVATE and ACTIVATE on EF~CCP2~. (This procedure is dependent on the
respective requirements of appropriate administrative authority and may
require several steps.)
i) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
j) The ME simulator shall send an ACTIVATE FILE command with P1 = P2 = \'00\'
and with the empty data field to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR7]._
k) The ME simulator shall send a SELECT command to the UICC to select
EF~CCP2~.
_The value of Life Cycle Status Integer of the response data shall indicate
that the EF is activated [CR7]._
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command._
#### 6.8.1.16 AUTHENTICATE
##### 6.8.1.16.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.16.2 Conformance requirement
* * *
CR1 An appropriate application shall be selected in the UICC before issuing
this command. M
* * *
Reference: TS 102.221 [1], subclause 11.1.16.
##### 6.8.1.16.3 Test purpose
To verify that the AUTHENTICATE function conforms to the above requirements.
##### 6.8.1.16.4 Method of test
NOTE 1: Consequences are not clearly defined when the AUTHENTICATE command is
performed where no application is being selected. Therefore, the test for CR1
should be left N/A.
NOTE 2: Authentication procedure for USIM application is tested in subclause
7.3.1 of this present document.
**Initial conditions**
N/A
Test procedure
N/A
#### 6.8.1.17 MANAGE CHANNEL
##### 6.8.1.17.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.17.2 Conformance requirement
* * *
CR1 The MANAGE CHANNEL open function opens a new logical channel other than
the basic channel '0'. Rel-4 - ... CR2 The UICC shall support channel number
assignment by the UICC. Rel-4 - ... CR3 The MANAGE CHANNEL close function
explicitly closes a logical channel. Rel-4 - ... CR4 When a channel has been
successfully closed, the channel can be reassigned. Rel-4 - ... CR5 The basic
logical channel '0' is always available and cannot be closed. Rel-4 - ... CR6
The function shall accept no input data. Rel-4 - ... CR7 The function shall
output either no data or the channel number of the logical channel assigned by
the UICC. Rel-4 - ... CR8 Response data shall only be returned if the value of
the parameters P1-P2 of the command is '0000'. Rel-4 - ...
* * *
Reference: TS 102 221 [1], subclause 11.1.17.
##### 6.8.1.17.3 Test purpose
To verify that the MANAGE CHANNEL function conforms to the above requirements.
NOTE: CR1, CR2, CR3, CR4, CR5, CR6, CR7 and CR8 are tested in subclause 6.5.7.
##### 6.8.1.17.4 Method of test
**Initial conditions**
N/A
Test procedure
N/A
#### 6.8.1.18 GET CHALLENGE
The tests defined in this subclause only apply where the UICC under test
supports the GET CHALLENGE command. If the UICC under test does not support
the GET CHALLENGE command, then these tests do not apply.
##### 6.8.1.18.1 Definition and applicability
See clause 3.5.3.
##### 6.8.1.18.2 Conformance requirement
* * *
CR1 This function is used to create a random number. (Rel-4) Rel-6 - ... CR2
The generated random number is associated with the logical channel specified
in the GET CHALLENGE command CLA. (Rel-4) Rel-6 - ... CR3 The maximum length
of the random number returned by the UICC is specified by the Le parameter in
the command parameters body. (Rel-4) Rel-6 - ... CR4 The generated random
number may be used internally by the UICC in procedures specified by the
application. (Rel-4) Rel-6 - ... CR5 The validity of the random number is at
least for the next command, on the same logical channel, following the GET
CHALLENGE command if not specified differently by the application. (Rel-4)
Rel-6 - ... CR6 The random number referenced is always the latest generated on
the logical channel specified in the CLA by the command referencing the usage
of a random number. (Rel-4) Rel-6 - ... CR7 The function shall accept no input
data. (Rel-4) Rel-6 - ... CR8 The function shall output a random number.
(Rel-4) Rel-6 - ...
* * *
Reference: TS 102 221 [1], subclause 11.1.18.
##### 6.8.1.18.3 Test purpose
To verify that the GET CHALLENGE function conforms to the above requirements.
Note 1: The testing of the quality of the random number generated by this
command is outside the scope of the present document. (CR1, CR8)
Note 2: CR2, CR4, CR5 and CR6 are not tested.
##### 6.8.1.18.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
Test procedure 1
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a GET CHALLENGE command to the UICC with a
length value of 8.
> _The UICC shall return a data string containing a maximum of 8 bytes of
> response data. [CR3, CR7]_
d) Step c) shall be repeated a further 99 times.
> _For each repetition the UICC shall return a data string containing a
> maximum of 8 bytes of response data that is different to that has been
> returned previously in this test. [CR8]_
>
> _(Note: This does not test the quality of the returned Random Number merely
> that the same number is not returned twice in 100 calls of the GET CHALLENGE
> command.)_
## 6.8.2 Data Oriented Commands
#### 6.8.2.1 RETRIEVE DATA
##### 6.8.2.1.1 Definition and applicability
See clause 3.5.3.
##### 6.8.2.1.2 Conformance requirement
* * *
CR1 After a successful selection the current tag pointer is undefined. Rel-6 -
...: O_BER_TLV_FILES CR2 A data object transfer can be interleaved with any
command not modifying the current EF or the current tag pointer. Rel-6 - ...:
O_BER_TLV_FILES CR3 Any interleaved command that modifies the current EF or
the current tag pointer shall abort an uncompleted data object transfer. Rel-6
- ...: O_BER_TLV_FILES CR4 A successful APDU indicating \"First Block\" sets
the current tag pointer and shall abort an uncompleted data object transfer.
This applies for all tags defined in this clause, even if the new tag is the
same as the previous one. Rel-6 - ...: O_BER_TLV_FILES CR5 The current tag
pointer and its associated context (e.g. current offset in the data object)
shall not be changed by an APDU resulting in an error status word. Rel-6 -
...: O_BER_TLV_FILES CR6 The setting \"retransmit previous block\" is only
allowed if the previous command did not result in an error status word. Rel-6
- ...: O_BER_TLV_FILES CR7 This function shall only be performed if the READ
access condition for this EF is satisfied. Rel-6 - ...: O_BER_TLV_FILES CR8 If
the requested TLV object does not exist in the EF, the UICC shall answer with
\"referenced data not found\". Rel-6 - ...: O_BER_TLV_FILES CR9 The status
word sent by the card after a successful RETRIEVE DATA command is \'62F1\' or
\'62F2\' if more data is available. Rel-6 - ...: O_BER_TLV_FILES CR10 Once a
data object was fully retrieved, any subsequent RETRIEVE DATA command on this
data object with parameter P2 set to \'Next Block\' shall be rejected with the
status word \'6A86\'. Rel-6 - ...: O_BER_TLV_FILES CR11 If P2 is set to
\'First Block\' the function shall output a BER-TLV data object or the first
part of it if segmented over several APDUs. Rel-6 - ...: O_BER_TLV_FILES CR12
If P2 is set to \'Next Block\' and the previous RETRIEVE DATA command ended
with \"more data available\" the function shall output the next segment of the
segmented TLV object. Rel-6 - ...: O_BER_TLV_FILES CR13 If P2 is set to
\'Retransmit Previous Block\' the function shall output the data as in the
previous command. Rel-6 - ...: O_BER_TLV_FILES
* * *
Reference: TS 102.221 [1], subclauses 11.3 and 11.3.1.
##### 6.8.2.1.3 Test purpose
To verify that the RETRIEVE DATA function conforms to the above requirements.
NOTE: For CR9, only \'62F1\' is accepted as a status word, as the relevant
test procedures do not send a TERMINAL PROFILE and therefore the UICC should
never indicate that a proactive command is pending.
##### 6.8.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~MMDF~ shall contain only the following data objects:
* * *
**Tag** **Length field** **Value** \'81\' \'02\' \'01 02\' \'A2\' \'82 05 A0\'
1440 bytes: \'80 0E 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D\' repeated 90
times. \'83\' \'00\' \' \' -- i.e. empty value.
* * *
> EF~MMDF~ shall not contain the following data objects:
* * *
**Tag** \'86\'
* * *
3) EF~MML~ shall be present.
**Test procedure 1 (basic)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'81\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR7]._
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ access condition for EF~MMDF~.
e) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'81\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR7]._
>
> _The data returned shall be \'81 02 01 02\' [CR11]._
f) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'86\' -- Incorrect parameters P1 to P2 [CR10]._
g) The ME simulator shall select EF~MMDF~.
h) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The UICC shall return an error code appropriate to the command [CR1]._
i) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available [CR9]._
>
> _The response data returned by the UICC shall contain the first part of the
> data object with tag \'A2\' [CR12]._
j) The ME simulator shall send RETRIEVE DATA commands indicating \"Next
block\" to the UICC until the status condition returned by the UICC is not SW1
= \'62\', SW2 = \'F1\' - More data available.
> _For the last command, the status condition returned by the UICC shall be
> SW1 = \'90\', SW2 = \'00\' - normal ending of the command._
>
> _For all commands, the response data returned by the UICC shall contain the
> next part of the data object with tag \'A2\' [CR12]._
>
> _The last command shall contain the last part of the data object with tag
> \'A2\' [CR12]._
k) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'86\' -- Incorrect parameters P1 to P2 [CR10]._
l) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'86\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR8]._
m) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'83\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
>
> _The data returned shall be \'_ 83 _00\' [CR11]._
n) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the first part of the
> data object with tag \'A2\', with a length less than or equal to the maximum
> length of data expected by the terminal as encoded in the Le byte in the
> command._
o) The ME simulator shall send RETRIEVE DATA commands indicating \"Next
block\", and with Le the smaller of the number of bytes still to be
transferred and 50, to the UICC, until the status condition returned by the
UICC is not SW1 = \'62\', SW2 = \'F1\' - More data available.
> _For the last command, the status condition returned by the UICC shall be
> SW1 = \'90\', SW2 = \'00\' - normal ending of the command._
>
> _For all commands, the response data returned by the UICC shall contain the
> next part of the data object with tag \'A2\', with a length less than or
> equal to 50._
>
> _The last command shall contain the last part of the data object with tag
> \'A2\'._
**Test procedure 2 (interleaving and aborting)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the access condition for EF~MMDF~.
d) For each of the commands in the following table, steps e) to j) shall be
repeated.
* * *
Command Expected status condition CRs tested STATUS SW1 = \'90\', SW2 = \'00\'
- normal ending of the command CR2 VERIFY PIN with PIN SW1 = \'90\', SW2 =
\'00\' - normal ending of the command CR2 SELECT with file ID \'2F 34\' An
error code appropriate to the command CR5, CR2 READ BINARY An error code
appropriate to the command CR5, CR2 RETRIEVE DATA indicating \"First block\"
and with tag \'86\' An error code appropriate to the command CR5, CR2 SET DATA
indicating \"Next block\" and with data \'85 01 01\' An error code appropriate
to the command CR5, CR2
* * *
e) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the first part of the
> data object with tag \'A2\'._
f) The ME simulator shall send the command indicated in the table in step d)
to the UICC.
> _The UICC shall return the status condition indicated in the table in step
> d)._
g) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\'._
h) The ME simulator shall send the command indicated in the table in step d)
to the UICC.
> _The UICC shall return the status condition indicated in the table in step
> d)._
i) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\'._
j) The ME simulator shall continue sending RETRIEVE DATA commands indicating
\"Next block\" to the UICC until the status condition returned by the UICC is
not SW1 = \'62\', SW2 = \'F1\' - More data available.
> _For the last command, the status condition returned by the UICC shall be
> SW1 = \'90\', SW2 = \'00\' - normal ending of the command._
>
> _For all commands, the response data returned by the UICC shall contain the
> next part of the data object with tag \'A2\'._
>
> _The last command shall contain the last part of the data object with tag
> \'A2\'._
k) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
l) The ME simulator shall send a SELECT command to select EF~MML~.
m) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The UICC shall return an error code appropriate to the command [CR3]._
n) The ME simulator shall send a SELECT command to select EF~MMDF~.
o) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The data returned shall be the start of the TLV with tag \'A2\' [CR4]._
p) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The data returned shall be the start of the TLV with tag \'A2\'._
q) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'81\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
>
> _The data returned shall be \'81 02 01 02\' [CR4]._
r) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The data returned shall be the start of the TLV with tag \'A2\'._
s) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'81 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
t) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The UICC shall return an error code appropriate to the command [CR4]._
u) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
v) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'A2 03 01 01 00\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
w) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The UICC shall return an error code appropriate to the command [CR4]._
**Test procedure 3 (retransmitting)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the access condition for EF~MMDF~.
d) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'81\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
>
> _The data returned shall be \'81 02 01 02\'._
e) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
f) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
g) The ME simulator shall send a RETRIEVE DATA command indicating \"Retransmit
previous block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The data returned shall be the same as in step f) [CR13, CR6]._
h) The ME simulator shall continue sending RETRIEVE DATA commands indicating
\"Next block\" to the UICC until the UICC returns status condition SW1 =
\'90\', SW2 = \'00\' - normal ending of the command.
i) The ME simulator shall send a RETRIEVE DATA command indicating \"Retransmit
previous block\" to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
>
> _The data returned shall be the same as for the last RETRIEVE DATA command
> sent in step h) [CR13, CR6]._
#### 6.8.2.2 SET DATA
##### 6.8.2.2.1 Definition and applicability
See clause 3.5.3.
##### 6.8.2.2.2 Conformance requirement
* * *
CR1 For SET DATA, the UICC as receiver is in charge of the concatenation of
the data object. Rel-6 - ...: O_BER_TLV_FILES CR2 A data object transfer can
be interleaved with any command not modifying the current EF or the current
tag pointer. Rel-6 - ...: O_BER_TLV_FILES CR3 Any interleaved command that
modifies the current EF or the current tag pointer shall abort an uncompleted
data object transfer. Rel-6 - ...: O_BER_TLV_FILES CR4 A successful APDU
indicating \"First Block\" sets the current tag pointer and shall abort an
uncompleted data object transfer. This applies for all tags defined in this
clause, even if the new tag is the same as the previous one. Rel-6 - ...:
O_BER_TLV_FILES CR5 The current tag pointer and its associated context (e.g.
current offset in the data object) shall not be changed by an APDU resulting
in an error status word. Rel-6 - ...: O_BER_TLV_FILES CR6 The setting
\"retransmit previous block\" is only allowed if the previous command did not
result in an error status word. Rel-6 - ...: O_BER_TLV_FILES CR7 If P2
indicates \"First Block\", this command creates a new data object in the
current BER-TLV structure EF or replaces an already existing data object with
the same tag or deletes a data object. Rel-6 - ...: O_BER_TLV_FILES CR8
Subsequent commands with P2 indicating \"Next Block\" pass the remaining
content of the data object being replaced or created to the card. Rel-6 - ...:
O_BER_TLV_FILES CR9 If P2 indicates \"Retransmit Previous Block\", the content
sent with the previous command is updated. Rel-6 - ...: O_BER_TLV_FILES CR10
This command shall only be performed if the UPDATE access condition for this
EF is satisfied. Rel-6 - ...: O_BER_TLV_FILES CR11 When a transfer to create
or replace an object is initiated, the first APDU identified by P2 indicating
\"First Block\" shall at least contain the tag value and length of the value
field of the BER-TLV data object. Rel-6 - ...: O_BER_TLV_FILES CR12 When a SET
DATA command is successfully executed, the UICC shall return \'9000\' if it
had received all expected data. Rel-6 - ...: O_BER_TLV_FILES CR13 If the
length of a TLV object received in a SET DATA command is less than was
indicated by the length parameter of the TLV header, then the UICC shall
return \'63F1\' or \'63F2\'. Rel-6 - ...: O_BER_TLV_FILES CR14 A data object
transfer is successfully completed when the number of bytes received matches
the length indicated for the data object. Rel-6 - ...: O_BER_TLV_FILES CR15
Once a data object transfer is successfully completed, any subsequent SET DATA
command on this data object with parameter P2 set to \'Next Block\' shall be
rejected with the status word \'6A86\'. Rel-6 - ...: O_BER_TLV_FILES CR16 When
a data object transfer is aborted, the data object with this tag shall no
longer be available in EF. Rel-6 - ...: O_BER_TLV_FILES CR17 If the data sent
with this command is greater than the length of the value field of the BER-TLV
object, the card shall return status word \'6700\', the data object is not
updated and the data object transfer is not completed. Rel-6 - ...:
O_BER_TLV_FILES CR18 If, in a SET DATA command with P2 indicating \'First
Block\', the data field only contains a tag field, i.e. the length and the
value field of the BER-TLV data object are missing, the data object specified
by the tag shall be deleted if present in the current context. Rel-6 - ...:
O_BER_TLV_FILES CR19 Deleting a non-existent object shall not be considered as
an error. Rel-6 - ...: O_BER_TLV_FILES CR20 If the data field contains a tag
field and a length field with zero value, the object is not deleted but a zero
length object is created. Rel-6 - ...: O_BER_TLV_FILES
* * *
Reference: TS 102.221 [1], subclauses 11.3 and 11.3.2.
##### 6.8.2.2.3 Test purpose
To verify that the SET DATA function conforms to the above requirements.
NOTE: For CR13, only \'63F1\' is accepted as a status word, as the relevant
test procedures do not send a TERMINAL PROFILE and therefore the UICC should
never indicate that a proactive command is pending.
##### 6.8.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~MMDF~ shall contain the following data objects:
* * *
**Tag** **Value** **Reason** \'81\' \'01 02\' Existing -- to be replaced.
\'82\' 1440 bytes: \'80 0E 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D\'
repeated 90 times. Existing -- to be replaced.
* * *
> EF~MMDF~ shall not contain the following data objects:
* * *
**Tag** **Reason** \'86\'  
\'87\' Not existing -- to be created. \'88\' Not existing -- to be created.
* * *
3) EF~MML~ shall be present.
**Test procedure 1 (basic)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'81 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'82\' -- security status not satisfied [CR10]._
d) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the UPDATE access condition for EF~MMDF~.
e) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'81 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR10, CR12, CR14]._
f) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'81 02 05 06\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'86\' -- Incorrect parameters P1 to P2 [CR15]._
g) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'81\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'81 02 03 04\' (including the tag and length fields) [CR14]._
h) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'87 02 05 06\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR12, CR14]._
i) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'87\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'87 02 05 06\' (including the tag and length fields) [CR14]._
j) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR7, CR13]._
k) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. FE FF\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR8, CR13]._
l) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. 13 14\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR12, CR14]._
m) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'11 12 .. 23 24\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'86\' -- Incorrect parameters P1 to P2 [CR15]._
n) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'82\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'82 82 02 0E 01 02 .. FA FB 01 02 .. FE FF 01 02 .. 13 14\' (including
> the tag and length fields) [CR14]._
o) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'88 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR7, CR13]._
p) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. FE FF\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR8, CR13]._
q) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. 13 14\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR12, CR14]._
r) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. 13 14\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'86\' -- Incorrect parameters P1 to P2 [CR15]._
s) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'88\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'88 82 02 0E 01 02 .. FA FB 01 02 .. FE FF 01 02 .. 13 14\' (including
> the tag and length fields) [CR14]._
t) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'81 00\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
u) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'81\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'81 00\' (including the tag and length fields) [CR20]._
v) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'87\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
w) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'87\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR18]._
x) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'87\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR19]._
y) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'87\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR18]._
**Test procedure 2 (interleaving and aborting)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the UPDATE access condition for EF~MMDF~.
d) For each of the commands in the following table, steps e) to k) shall be
repeated.
* * *
Command Expected status condition CRs tested STATUS SW1 = \'90\', SW2 = \'00\'
- normal ending of the command CR2 VERIFY PIN with PIN SW1 = \'90\', SW2 =
\'00\' - normal ending of the command CR2 SELECT with file ID \'2F 34\' An
error code appropriate to the command CR5, CR2 READ BINARY An error code
appropriate to the command CR5, CR2 RETRIEVE DATA indicating \"First block\"
and with tag \'86\' An error code appropriate to the command CR5, CR2 SET DATA
indicating \"First block\" and with data \'85 01 01 02\' An error code
appropriate to the command CR5, CR2
* * *
e) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
f) The ME simulator shall send the command indicated in the table in step d)
to the UICC.
> _The UICC shall return the status condition indicated in the table in step
> d)._
g) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. FE FF\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
h) The ME simulator shall send the command indicated in the table in step d)
to the UICC.
> _The UICC shall return the status condition indicated in the table in step
> d)._
i) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. 13 14\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
j) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'82\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'82 82 02 0E 01 02 .. FA FB 01 02 .. FE FF 01 02 .. 13 14\' (including
> the tag and length fields)._
k) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
l) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
m) The ME simulator shall select EF~MML~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
n) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. FE FF\' to the UICC.
> _The UICC shall return an error code appropriate to the command._
o) The ME simulator shall select EF~MMDF~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
p) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'82\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR3, CR16]._
q) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
r) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
s) The ME simulator shall select EF~MMDF~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
t) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. FE FF\' to the UICC.
> _The UICC shall return an error code appropriate to the command._
u) The ME simulator shall select EF~MMDF~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
v) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'82\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR3, CR16]._
w) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
x) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
y) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'82\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR4, CR3, CR16]._
z) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
aa) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
bb) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'81\' to the UICC.
> _The status condition returned by the UICC shall be either SW1 = \'90\', SW2
> = \'00\' - normal ending of the command, or SW1 = \'62\', SW2 = \'F1\' -
> More data available._
cc) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'82\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR4, CR3, CR16]._
dd) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
ee) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
ff) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
gg) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'82\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'82 02 03 04\' (including the tag and length fields) [CR4, CR3]._
hh) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
ii) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
jj) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'81 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
kk) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'82\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR4, CR3, CR16]._
**Test procedure 3 (retransmitting)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the UPDATE access condition for EF~MMDF~.
d) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 82 02 0E 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
e) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. FE FF\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
f) The ME simulator shall send a SET DATA command indicating \"Retransmit
previous block\" and with data \'01 02 .. FE FF\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR6]._
g) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'01 02 .. 13 14\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
h) The ME simulator shall send a SET DATA command indicating \"Retransmit
previous block\" and with data \'01 02 .. 13 14\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR6]._
i) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'82\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'82 82 02 0E 01 02 .. FA FB 01 02 .. FE FF 01 02 .. 13 14\' (including
> the tag and length fields) [CR9]._
**Test procedure 4 (segmentation of data)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the access condition for EF~MMDF~.
d) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR11]._
e) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'03\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
f) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
g) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'82\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'82 02 03 04\' (including the tag and length fields) [CR1]._
h) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'9F 1F\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR19]._
i) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02 05 06 01 02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'67\', SW2 =
> \'00\' -_ _Wrong length [CR17]._
j) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'82\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'82 02 03 04\' (including the tag and length fields) [CR1]._
k) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'82 02\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
l) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'05 06 07 08\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'67\', SW2 =
> \'00\' -_ _Wrong length [CR17]._
m) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'82\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR16]._
#### 6.8.2.3 BER-TLV structure files
##### 6.8.2.3.1 Definition and applicability
See clause 3.5.3.
##### 6.8.2.3.2 Conformance requirement
* * *
CR1 The tag \'5C\' as defined in ISO/IEC 7816-4 [7] is reserved to get the
list of tags already allocated in a file. Rel-6 - ...: O_BER_TLV_FILES CR2 The
value part of this TLV contains the concatenation of all top level tags of the
BER-TLV objects allocated in the file. Rel-6 - ...: O_BER_TLV_FILES CR3 Tags
contained in the value part of a constructed BER-TLV object shall not be
included in the tag list. Rel-6 - ...: O_BER_TLV_FILES CR4 Tag \'5C\' shall
not be considered as an allocated tag. Rel-6 - ...: O_BER_TLV_FILES CR5 The
tag \'5C\' used in the command data is used to get the list of tags allocated
in the file. Rel-6 - ...: O_BER_TLV_FILES CR6 A data object transfer is
successfully completed when the number of bytes received matches the length
indicated for the data object. Rel-6 - ...: O_BER_TLV_FILES CR7 The UICC shall
support the following tag values for primitive TLV objects: \'80\' to \'9E\'
and \'9F 1F\' to \'9F 7F\' and \'9F 81 XX\' to \'9F FF XX\' with \'XX\' from
\'00\' to 7F\'. Rel-6 - ...: O_BER_TLV_FILES CR8 The UICC shall support the
following tag values for constructed TLV objects: \'A0\' to \'BE\' and \'BF
1F\' to \'BF 7F\' and \'BF 81 XX\' to \'BF FF XX\' with \'XX\' from \'00\' to
7F\'. Rel-6 - ...: O_BER_TLV_FILES CR9 If the tag of the object is not in the
range specified in the present document, the UICC shall answer with
\"incorrect parameters in the data field\". Rel-6 - ...: O_BER_TLV_FILES CR10
If the tag of the object is not in the range specified in the present
document, the UICC shall answer with \"incorrect parameters in the data
field\". Rel-6 - ...: O_BER_TLV_FILES CR11 For a BER-TLV structure EF, file
size is the memory used by the allocated data objects. Rel-6 - ...:
O_BER_TLV_FILES CR12 For BER-TLV structured EF the amount of available memory
shall be the maximum amount of bytes that is available in the EF for the next
TLV object to be created. This shall include the space required for the tag
and the length field. Rel-6 - ...: O_BER_TLV_FILES CR13 Space that is freed by
a SET DATA command with P2 indicating \"First Block\" shall be available for
new objects. Rel-6 - ...: O_BER_TLV_FILES CR14 If the length requested in a
SET DATA command with P2 indicating \"First Block\" is not available, the card
shall return \'6A84\'. Rel-6 - ...: O_BER_TLV_FILES
* * *
Reference: TS 102.221 [1], subclauses 11.1.1.4.1, 11.3, 11.3.1 and 11.3.2.
##### 6.8.2.3.3 Test purpose
To verify that the UICC under test uses \'5C\' correctly, uses the specified
tag ranges correctly and uses the correct FCP content.
> NOTE 2: CR13 is not tested.
##### 6.8.2.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~MMDF~ shall contain only the following data objects:
* * *
**Tag** **Length field** **Value** \'81\' \'02\' \'01 02\' \'A2\' \'82 05 A0\'
1440 bytes: \'80 0E 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D\' repeated 90
times. \'83\' \'00\' \' \' -- i.e. empty value.
* * *
**Test procedure 1 (usage of \'5C\')**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ and UPDATE access conditions for EF~MMDF~.
d) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'5C\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'5C 03\' followed by\'81\', \'A2\' and \'83\' in any order [CR1, CR2,
> CR3, CR4, CR5]._
e) The ME simulator shall send appropriate SET DATA commands in order to
achieve the updates indicated in the following table:
* * *
**Function** **Tag** **Value (for create/replace)** Replace \'81\' \'03 04\'
Delete \'A2\' N/A Create \'85\' \'01 02\'
* * *
f) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'89 82 01 00 01 02 .. FA FB\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
g) The ME simulator shall select EF~MMDF~.
h) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'5C\' to the UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'5C 03\' followed by\'81\', \'83\' and \'85\' in any order [CR1, CR2,
> CR3, CR4, CR5, CR6]._
i) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'5C 02 01 02\' to the UICC.
> _The UICC shall return an error code appropriate to the command [CR1]._
**Test procedure 2 (supported tag values)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ and UPDATE access conditions for EF~MMDF~.
d) For each tag in the table below, the ME simulator shall send a RETRIEVE
DATA command indicating \"First block\" and with the tag from the table to the
UICC.
* * *
\'80\' \'8F\' \'9E\' \'9F 1F\' \'9F 4F\' \'9F 7F\' \'9F 81 00\' \'9F C3 40\'
\'9F FF 7F\' \'A0\' \'AF\' \'BE\' \'BF 1F\' \'BF 4F\' \'BF 7F\' \'BF 81 00\'
\'BF C3 40\' \'BF FF 7F\'
* * *
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found [CR7, CR8]._
e) For each tag in the table in step d), steps f) to g) shall be repeated.
f) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data consisting of the tag indicated in the table in step d) followed
by \'02 01 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR7, CR8]._
g) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with the tag indicated in the table in step d) to the
UICC.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data consisting of the tag indicated in the table in step d) followed by
> \'02 01 04\' (including the tag and length fields)._
h) For each tag in the table below, the ME simulator shall send a RETRIEVE
DATA command indicating \"First block\" and with the tag from the table to the
UICC.
* * *
\'01\' \'40\' \'C0\' \'9F 00\' \'9F 80 00\'  
\'9F 01\' \'9F 1E\'  
\'9F 81 80 00\'  
\'BF 00\' \'BF 80 00\'  
\'BF 01\' \'BF 1E\'  
\'BF 81 80 00\'
* * *
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'80\' - Incorrect parameters in the data field [CR7, CR8, CR9]._
i) For each tag in the table in step h), the ME simulator shall send a SET
DATA command indicating \"First block\" and with data consisting of the tag
followed by \'02 03 04\' to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'80\' - Incorrect parameters in the data field [CR7, CR8, CR10]._
**Test procedure 3 (FCP)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
> _The contents of the TLV with tag \'80\' (File size) shall be equal to the
> value 1 450 (decimal) [CR11]._
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the UPDATE access condition for EF~MMDF~.
d) The ME simulator shall send appropriate SET DATA commands in order to
achieve the updates indicated in the following table:
* * *
**Function** **Tag** **Value (for create/replace)** Replace \'81\' \'03 04 05
06\' Delete \'A2\' N/A Create \'85\' \'01 02\'
* * *
e) The ME simulator shall select EF~MMDF~.
> _The contents of the TLV with tag \'80\' (File size) in the FCP shall be
> equal to the value 12 (decimal) [CR11]._
>
> Steps f) and g) shall only be carried out if the contents of the TLV with
> tag \'83\' (Amount of available memory) contained in the TLV with tag \'A5\'
> (Proprietary information) in the FCP returned in step e) has a value of at
> least 2 (decimal).
f) The ME simulator shall send appropriate SET DATA command(s) in order to
create a new (i.e. currently non-existing) data object such that the number of
bytes in the TLV (including the tag, length and value fields) is the largest
possible that does not exceed the amount of available memory. A tag of \'91\',
\'9F1F\' or \'9F8100\' shall be used according to whether a 1-, 2- or 3-byte
tag is used.
> _The UICC shall successfully execute all the SET DATA commands, such that
> the data object transfer is successfully completed [CR12]._
g) The ME simulator shall send a SET DATA command to delete the data object
created in step f).
h) The ME simulator shall select EF~MMDF~.
> Step i) shall only be carried out if the contents of the TLV with tag \'83\'
> (Amount of available memory) contained in the TLV with tag \'A5\'
> (Proprietary information) in the FCP returned in step h) has a value of less
> than 16 777 222 (decimal).\ Note: 16 777 222 is the number of bytes in the
> largest possible TLV -- that having a 3-byte tag and a length of \'FF FF
> FF\'.
i) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data containing a tag field of a tag which does not currently exist
in the file and a length field containing a length such that the number of
bytes in the TLV (including the tag, length and value fields) would exceed the
amount of available memory by the smallest amount possible. A tag of \'91\',
\'9F1F\' or \'9F8100\' shall be used according to whether a 1-, 2- or 3-byte
tag is used.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'84\' - Not enough memory space [CR14]._
#### 6.8.2.4 Logical channel interactions
##### 6.8.2.4.1 Definition and applicability
See clause 3.5.3.
##### 6.8.2.4.2 Conformance requirement
* * *
CR1 For shareable files, file access shall be managed independently for each
accessing application. In particular, a BER-TLV structure file shall have
different pointers for each accessing application. Rel-6 - ...:
O_BER_TLV_FILES, O_LOG_CHANS, O_SHAREABLE CR2 A data object transfer can be
interleaved with any command not modifying the current EF or the current tag
pointer. Rel-6 - ...: O_BER_TLV_FILES CR3 For RETRIEVE DATA, if a current tag
pointer associated with a SET DATA operation processed by another application
points to the requested TLV object, the UICC shall answer with \"conditions of
use not satisfied\". Rel-6 - ...: O_BER_TLV_FILES, O_LOG_CHANS, O_SHAREABLE
CR4 For SET DATA, if a current tag pointer associated with a SET or RETRIEVE
DATA operation processed by another application points to the requested TLV
object, the UICC shall answer with \"conditions of use not satisfied\". Rel-6
- ...: O_BER_TLV_FILES, O_LOG_CHANS, O_SHAREABLE CR5 This command allows
retrieving the list of the tags allocated (data objects successfully
completed) in the file. Rel-6 - ...: O_BER_TLV_FILES CR6 The tags of not yet
completed SET DATA operations processed by other applications shall also be
included in the list. Rel-6 - ...: O_BER_TLV_FILES, O_LOG_CHANS, O_SHAREABLE
CR7 When a data object transfer is aborted, the data object with this tag
shall no longer be available in EF. Rel-6 - ...: O_BER_TLV_FILES
* * *
Reference: TS 102.221 [1], subclauses 11.1.1.4.1, 11.3, 11.3.1 and 11.3.2.
##### 6.8.2.4.3 Test purpose
To verify that the UICC under test functions correctly when a BER-TLV
structure file is accessed on more than one channel simultaneously.
##### 6.8.2.4.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
2) EF~MMDF~ shall contain only the following data objects:
* * *
**Tag** **Length field** **Value** \'81\' \'02\' \'01 02\' \'A2\' \'82 05 A0\'
1440 bytes: \'80 0E 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D\' repeated 90
times. \'83\' \'00\' \' \' -- i.e. empty value.
* * *
3) DF~MULTIMEDIA~ and EF~MMDF~ shall be configured as shareable.
**Test procedure 1 (management of tag pointers)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ and UPDATE access conditions for EF~MMDF~.
> d) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC
> on the basic channel.
>
> _The UICC should return the assigned logical channel number -- call it
> channel \'a\'._
e) The ME simulator shall select EF~MMDF~ on channel \'a\'.
f) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the first part of the
> data object with tag \'A2\'._
g) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the first part of the
> data object with tag \'A2\' [CR1]._
h) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\' as transferred on the basic channel [CR1, CR2]._
i) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\' as transferred on the basic channel [CR1, CR2]._
j) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\' as transferred on channel \'a\' [CR1, CR2]._
k) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the first part of the
> data object with tag \'A2\' [CR1, CR2]._
l) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\' as transferred on the basic channel [CR1, CR2]._
m) The ME simulator shall select EF~MMDF~ on channel \'a\'.
n) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
>
> _The response data returned by the UICC shall contain the next part of the
> data object with tag \'A2\' as transferred on the basic channel [CR1, CR2]._
o) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 1E 01 02 03 04 05\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
p) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'85 1E 81 82 83 84 85\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
q) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'06 07 08 09 0A\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR2]._
r) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'11 12 13 14 15\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR2]._
s) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'86 87 88 89 8A\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR2]._
t) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'16 17 18 19 1A\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR2]._
u) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'85 1E 81 82 83 84 85\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
v) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'21 22 23 24 25\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected [CR2]._
w) The ME simulator shall select EF~MMDF~ on channel \'a\'.
x) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'26 27 28 29 2A\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
y) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'84\' to the UICC on the basic channel.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'81 2A 01 02 03 04 05 06 07 08 09 0A 11 12 13 14 15 16 17 18 19 1A 21
> 22 23 24 25 26 27 28 29 2A \' (including the tag and length fields) [CR1]._
z) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'6A\', SW2 =
> \'88\' - Referenced data not found._
**Test procedure 2 (concurrent access to data object)**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ and UPDATE access conditions for EF~MMDF~.
> d) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC
> on the basic channel.
>
> _The UICC should return the assigned logical channel number -- call it
> channel \'a\'._
e) The ME simulator shall select EF~MMDF~ on channel \'a\'.
f) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 0A 01 02 03 04 05\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
g) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'84\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - Conditions of use not satisfied [CR3]._
h) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'06 07 08 09 0A\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
i) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'84\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - Conditions of use not satisfied [CR3]._
j) The ME simulator shall select EF~MMDF~ on channel \'a\'.
k) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'84\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be either SW1 = \'90\', SW2
> = \'00\' - normal ending of the command, or SW1 = \'62\', SW2 = \'F1\' -
> More data available._
l) The ME simulator shall select EF~MMDF~.
m) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 0A 01 02 03 04 05\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
n) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 05 81 82 83 84 85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - Conditions of use not satisfied [CR3]._
o) The ME simulator shall send a SET DATA command indicating \"Next block\"
and with data \'06 07 08 09 0A\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
p) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 05 81 82 83 84 85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - Conditions of use not satisfied [CR3]._
q) The ME simulator shall select EF~MMDF~ on channel \'a\'.
r) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 05 81 82 83 84 85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
s) The ME simulator shall select EF~MMDF~.
t) The ME simulator shall send a RETRIEVE DATA command indicating \"First
block\" and with tag \'A2\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
u) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'A2 05 81 82 83 84 85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - Conditions of use not satisfied [CR4]._
v) The ME simulator shall send a RETRIEVE DATA command indicating \"Next
block\" to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'62\', SW2 =
> \'F1\' - More data available._
w) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'A2 05 81 82 83 84 85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - Conditions of use not satisfied [CR4]._
x) The ME simulator shall select EF~MMDF~ on channel \'a\'.
y) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'A2 05 81 82 83 84 85\' to the UICC on the basic channel.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command._
**Test procedure 3 (usage of \'5C\')**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall select EF~MMDF~.
c) The ME simulator shall send a VERIFY PIN command with PIN to the UICC to
gain the READ and UPDATE access conditions for EF~MMDF~.
> d) The ME simulator shall send a MANAGE CHANNEL (OPEN) command to the UICC
> on the basic channel.
>
> _The UICC should return the assigned logical channel number -- call it
> channel \'a\'._
e) The ME simulator shall select EF~MMDF~ on channel \'a\'.
f) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'5C\' to the UICC on the basic channel.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'5C 03\' followed by\'81\', \'A2\' and \'83\' in any order (including
> the tag and length fields of the \'5C\' TLV) [CR5]._
g) The ME simulator shall send a SET DATA command indicating \"First block\"
and with data \'84 0A 01 02 03 04 05\' to the UICC on channel \'a\'.
> _The status condition returned by the UICC shall be SW1 = \'63\', SW2 =
> \'F1\' - More data expected._
h) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'5C\' to the UICC on the basic channel.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'5C 03\' followed by\'81\', \'A2\', \'83\' and \'84\' in any order
> (including the tag and length fields of the \'5C\' TLV) [CR6]._
i) The ME simulator shall select EF~MMDF~ on channel \'a\'.
j) The ME simulator shall send appropriate RETRIEVE DATA command(s) in order
to read the data object with tag \'5C\' to the UICC on the basic channel.
> _The data object retrieved by the RETRIEVE DATA command(s) shall contain the
> data \'5C 03\' followed by\'81\', \'A2\' and \'83\' in any order (including
> the tag and length fields of the \'5C\' TLV) [CR7]._
## 6.9 Transmission Oriented Commands
### 6.9.1 T = 0 specific commands
#### 6.9.1.1 GET RESPONSE
##### 6.9.1.1.1 Definition and applicability
See clause 3.5.3.
##### 6.9.1.1.2 Conformance requirement
* * *
CR1 The GET RESPONSE command shall provide response data where it is indicated
in the procedure byte, see table 7.1 in TS 102.221 [1] or status byte, see
table 7.2 in TS 102.221 [1]. M CR2 It is required that the GET RESPONSE
command is executed immediately after the command it is related to (no other
command shall come between the command/response pair and the command GET
RESPONSE). M CR3 If the sequence is not respected, the UICC shall send the
status information \"technical problem, no diagnosis given\" as a reaction to
the GET RESPONSE. M
* * *
Reference: TS 102.221 [1], subclause 12.1.1.
##### 6.9.1.1.3 Test purpose
To verify that the coding of the GET RESPONSE command conforms to the above
requirements.
NOTE: CR1 is tested in relevant test procedures for commands which support GET
RESPONSE.
##### 6.9.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to select the MF to the UICC.
c) The ME simulator shall send a GET RESPONSE command to the UICC.
> _The UICC shall send a valid FCP._
>
> _TLV DO with tag \'83\' in tag \'62\' shall indicate that MF is the
> currently selected file [CR1]._
d) The ME simulator shall send a STATUS command to the UICC with P2 = \'0C\'.
e) The ME simulator shall send a GET RESPONSE command to the UICC.
> _The status condition returned by the UICC shall be SW1 = \'6F\', SW2 =
> \'00\' -- technical problem, no precise diagnosis[CR2, CR3]._
## 6.10 Application independent files
The subclause provides tests to ensure that the IUT contains all of the EFs
need for a 3GPP session.
### 6.10.1 Definition and applicability
See clause 3.5.3.
### 6.10.2 Conformance requirement
The following conformance requirements refer to the tables for each EF in TS
102.221 [1], clause 13.
* * *
CR1 Each existing EF shall be selectable under the MF using the identifier
given in the table for that EF. M CR2 All mandatory EFs shall exist on the
UICC. M CR3 The identifier of the EF shall be that given in the table for that
EF. M CR4 The type and structure of the EF shall be that given in the table
for that EF. M CR5 The file size shall be at least that given in the table for
that EF. M CR6 The short file identifier shall exist if it is mandatory in the
table for that EF. M CR7 The access conditions shall be those given in the
table for that EF. M
* * *
Reference: TS 102.221 [1], clause 13.
### 6.10.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The contents and coding of the data within the files are not tested, but
shall conform to the respective contents and coding of the data given for each
file in TS 102.221 [1], clause 13.
### 6.10.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a STATUS command to the UICC.
> _TLV DO with tag \'83\' in the response data shall indicate the identifier
> of the MF \'3F 00\'._
>
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF clause 13 of TS 102.221 [1].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
_The following shall be true of the response data:_
_\- TLV DO with tag \'83\' shall indicate the identifier of the file selected
[CR3];_
_\- TLV DO with tag \'82\' shall not be \'38\' and \'78\' indicating EF
[CR4];_
_\- TLV DO with tag \'82\' shall indicate the structure given in the table for
the file in clause 13 of TS 102.221 [1] [CR4];_
_\- TLV DO with tag \'80\' shall be at least the minimum file size given in
the table for the file in clause 13 of TS 102.221 [1]. if the EF is
transparent [CR5];_
_\- Byte 5 and 6 of TLV DO with tag \'82\' shall be in accordance with the
record length given in the table for the file in clause 13 of TS 102.221 [1]._
_if the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'80\' shall be an integer multiple of the record length
if the EF is linear fixed or cyclic [CR5];_
\- TLV DO with tag \'88\' shall indicate the short file identifier given in
the table for the file in clause 13 of TS 102.221 [1] [CR5, CR6];
_\- TLV DO with tag \'86\' or \'8B\' or \'8C\' or \'AB\' shall indicate the
access conditions given in the table for the file in clause 13 of TS 102.221
[1] [CR8].\ Note: if the access conditions indicate referenced security, the
referenced record in the EF~ARR~ may be read at this point if necessary._
d) Steps a) to c) shall be repeated for the remaining mandatory EFs in clause
13 of TS 102.221 [1].
> e) Steps a) to c) shall be repeated for the existing optional EFs in clause
> 13 of TS 102.221 [1].
# 7 Test Procedure (31.102)
This clause details all the tests for testing the IUT against TS 31.102 [3].
This test suite allows testing of the IUT against the base specification with
respect to:
\- Contents of the Elementary Files
\- Security Features supported by USIM
\- USIM commands.
## 7.1 Contents of the Elementary Files (EF)
The subclause provides tests to ensure that the IUT contains all of the EFs
need for a Telecom session.
### 7.1.1 Definition and applicability
See clause 3.5.3.
### 7.1.2 Conformance requirement
The following conformance requirements refer to the tables for each EF in TS
31.102 [3], clause 4.
* * *
CR1 Each existing EF shall be selectable under the respective DF using the
identifier given in the table for that EF. M CR2 All mandatory EFs shall exist
on the UICC. M CR3 The identifier of the EF shall be that given in the table
for that EF. M CR4 The type and structure of the EF shall be that given in the
table for that EF. M CR5 The file size shall be at least that given in the
table for that EF. M CR6 The short file identifier shall be those given in the
table for that EF. M CR7 The short file identifier shall exist if it is
mandatory in the table for that EF. This includes EFs with SFI indicated by
\'YY\'. (R99) Rel-6 - ... CR8 The access conditions shall be those given in
the table for that EF. M CR9 If no SFI is indicated in the table for the EF,
the EF shall not have an SFI. (R99) Rel-6 - ... CR10 The short file identifier
shall exist if it is mandatory in the table for that EF. M
* * *
Reference: TS 31.102 [3], clause 4.
### 7.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The contents and coding of the data within the files are not tested, but
shall conform to the respective contents and coding of the data given for each
file in TS 31.102 [3], clause 4.
### 7.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the
respective DF for the first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
_The following shall be true of the response data:_
_\- TLV DO with tag \'83\' shall indicate the identifier of the file selected
[CR3];_
_\- TLV DO with tag \'82\' shall not be \'38\' and \'78\' indicating EF
[CR4];_
_\- TLV DO with tag \'82\' shall indicate the structure given in the table for
the file in clause 4 of TS 31.102 [3] [CR4];_
_\- TLV DO with tag \'80\' shall be at least the minimum file size given in
the table for the file in clause 4 of TS 31.102 [3]. if the EF is transparent
[CR5];_
_\- Byte 5 and 6 of TLV DO with tag \'82\' shall be in accordance with the
record length given in the table for the file in clause 4 of TS 31.102 [3]. if
the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'80\' shall be an integer multiple of the record length
if the EF is linear fixed or cyclic [CR5];_
_\- If a value for the SFI is specified in the table for the file in clause 4
of TS 31.102 [3] and the value of the specified SFI is equal to the 5 least
significant bits (bits b5 to b1) of the file identifier for the file, then the
TLV DO with tag \'88\'shall either be absent, or shall be present with the
specified SFI value [CR6, CR7];_
_\- If a value for the SFI is specified in the table for the file in clause 4
of TS 31.102 [3] and the value of the specified SFI is not equal to the 5
least significant bits (bits b5 to b1) of the file identifier for the file,
then the TLV DO with tag \'88\'shall be present with the specified SFI value
[CR6, CR7];_
_\- If an SFI is specified in the table for the file in clause 4 of TS 31.102
[3] but no actual value is specified (i.e. \'YY\' is used), then the TLV DO
with tag \'88\'shall either be absent, or shall be present with a value of
length 1 [CR6, CR7];_
_\- If no SFI is specified in the table for the file in clause 4 of TS 31.102
[3], then the TLV DO with tag \'88\'shall be present with an empty value
[CR9]_
_\- TLV DO with tag \'86\' or \'8B\' or \'8C\' or \'AB\' shall indicate the
access conditions given in the table for the file in clause 4 of TS 31.102 [3]
[CR8].\_ Note: if the access conditions indicate referenced security, the
referenced record in the EF~ARR~ may be read at this point if necessary.
d) Steps a) to c) shall be repeated for the remaining mandatory EFs clause 4
of TS 31.102 [3].
e) Steps a) to c) shall be repeated for the existing optional EFs clause 4 of
TS 31.102 [3].
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the
respective DF for the first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
_The following shall be true of the response data:_
_\- TLV DO with tag \'83\' shall indicate the identifier of the file selected
[CR3];_
_\- TLV DO with tag \'82\' shall not be \'38\' and \'78\' indicating EF
[CR4];_
_\- TLV DO with tag \'82\' shall indicate the structure given in the table for
the file in clause 4 of TS 31.102 [3] [CR4];_
_\- TLV DO with tag \'80\' shall be at least the minimum file size given in
the table for the file in clause 4 of TS 31.102 [3]. if the EF is transparent
[CR5];_
_\- Byte 5 and 6 of TLV DO with tag \'82\' shall be in accordance with the
record length given in the table for the file in clause 4 of TS 31.102 [3]. if
the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'80\' shall be an integer multiple of the record length
if the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'88\' shall indicate the short file identifier given in
the table for the file in clause 4 of TS 31.102 [3] [CR6, CR10];_
_\- TLV DO with tag \'86\' or \'8B\' or \'8C\' or \'AB\' shall indicate the
access conditions given in the table for the file in clause 4 of TS 31.102 [3]
[CR8].\_ Note: if the access conditions indicate referenced security, the
referenced record in the EF~ARR~ may be read at this point if necessary.
d) Steps a) to c) shall be repeated for the remaining mandatory EFs clause 4
of TS 31.102 [3].
e) Steps a) to c) shall be repeated for the existing optional EFs clause 4 of
TS 31.102 [3].
## 7.2 Security features
### 7.2.1 Definition and applicability
See clause 3.5.3.
### 7.2.2 Conformance requirement
* * *
CR1 The USIM application shall use a global key reference as PIN and a local
key reference as PIN2. M CR2 Access with PIN2 shall be limited to the ADF
(USIM). M CR3 For a USIM application on a multi-verification capable UICC, the
only valid values for the usage qualifiers shall be \'00\' (verification
requirement is not used) and \'08\' (user authentication knowledge based
(PIN)) as defined in ISO/IEC 7816‑4 [7]. O_MULTI_VER CR4 Void N/A CR5 Void N/A
CR6 Void N/A CR7 Void N/A CR8 For access to DF~TELECOM~ the PIN shall be
verified. M
* * *
Reference: TS 31.102 [3], subclause 6.4.
### 7.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR1, CR2 are tested in the subclause 6.6.4.
NOTE 2: CR8 is not currently tested.
### 7.2.4 Method of test
No test procedure is currently required for a single verification capable
UICC.
Initial conditions
1) The UICC shall be connected to a ME simulator.
    **Test procedure 1**
```{=html}
``` a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
_The following shall be true of the response data:_
  * _TLV DO with tag \'C6\' (PS Template DO) shall contain for the > Universal PIN the TLV DO with tag \'95\' (Usage Qualifier) and the > value of this TLV shall be \'00\' or \'08\' [CR3];_
## 7.3 USIM commands
### 7.3.1 AUTHENTICATE
#### 7.3.1.1 Definition and applicability
See clause 3.5.3.
#### 7.3.1.2 Conformance requirement
* * *
CR1 This function shall cause the UICC to run the f1, f2, f3, f4, f5, and f1*
algorithms using a 16 bytes random number, AUTN, and the subscriber
authentication key K stored in the UICC. M CR2 If the received sequence number
SQN is in the correct range, the function shall return the response RES,
cipher key CK, and integrity key IK. M CR3 If the UICC detects the sequence
numbers are not in the valid range, the function shall return the signed
response AUTS. M CR4 The function shall not be executable unless a particular
USIM application has been selected as the Current Directory and activated and
the current directory is the USIM ADF or any subdirectory under this ADF. M
CR5 The function shall not be executable unless a successful PIN verification
procedure has been performed. M CR6 The function shall not be executable
unless the expected MAC-A is received. M CR7 If the UICC does not support
\'GSM context\' which is indicated in parameter P2, the function shall not be
executable. M
* * *
Reference: TS 31.102 [3], subclause 7.1.
#### 7.3.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 7.3.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send an AUTHENTICATE command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
- security status not satisfied [CR5]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select the MF.
h) The ME simulator shall send an AUTHENTICATE command to the UICC.
_The command shall be aborted [CR4]._
i) The ME simulator shall send a SELECT command to the UICC to select the
current ADF (\'7FFF\').
j) The ME simulator shall send an AUTHENTICATE command to the UICC with
incorrect signed data.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'62\' - authentication error, incorrect MAC [CR6]._
k) If the \'GSM context\' is not supported, the ME simulator shall send an
AUTHENTICATE command with parameter P2 indicating \'GSM context\'.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'64\' - authentication error, GSM security context not supported [CR7]._
l) The ME simulator shall send an AUTHENTICATE command to the UICC with
incorrect sequence number SQN.
> _The data field returned shall begin with the tag \'DC\', and the data shall
> be correct for the given f1* and f5 algorithms and K stored in the UICC
> [CR1, CR3]._
m) The ME simulator shall send an AUTHENTICATE command to the UICC with
correct data.
> _The data field returned shall begin with the tag \'DB\', and the data shall
> be correct for the given f2, f3 and f4 algorithms and K stored in the UICC
> [CR1, CR2]._
### 7.3.2 Status Conditions Returned by the USIM
#### 7.3.2.1 Security management
##### 7.3.2.1.1 Definition and applicability
See clause 3.5.3.
##### 7.3.2.1.2 Conformance requirement
* * *
CR1 The UICC shall respond with the correct SW1 and SW2 status words for
commands which produce authentication errors. M
* * *
Reference: TS 31.102 [3], subclause 7.3.1.
##### 7.3.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements when issuing SW1
and SW2 status words.
##### 7.3.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a VERIFY PIN command with relevant PIN to the
UICC.
d) The ME simulator shall send an AUTHENTICATE command to the UICC with
incorrect MAC.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'62\' - authentication error, incorrect MAC [CR1]._
e) If the \'GSM context\' is not supported, the ME simulator shall send an
AUTHENTICATE command with parameter P2 indicating \'GSM context\'.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'64\' - authentication error, GSM security context not supported [CR1]._
#### 7.3.2.2 Status Words of the Commands
##### 7.3.2.2.1 Definition and applicability
See clause 3.5.3.
##### 7.3.2.2.2 Conformance requirement
* * *
CR1 Table in TS 31.102 [3], subclause 7.3.2 shows for each command the
possible status conditions returned (marked by an asterisk *). The UICC shall
not generate status conditions other than those allowed for each command. M
* * *
Reference: TS 31.102 [3], subclause 7.3.2.
##### 7.3.2.2.3 Test purpose
To verify for each command that the UICC will only generate the allowed status
conditions.
NOTE: CR1 shall not be tested as it is not possible to force the UICC to
generate all of the allowed and disallowed status conditions for each command.
##### 7.3.2.2.4 Method of test
**Initial conditions**
N/A
Test procedure
N/A
## 7.4 Void
# 8 Test Procedure (31.101)
This clause details each of the tests in each of the test groups within the
Test Group TP31.101. This test suite allows testing of the IUT against the
base specification with respect to:
\- General 3GPP platform requirements
\- Physical and logical characteristics
\- User verification and file access conditions
\- Files.
## 8.1 General 3GPP platform requirements
### 8.1.1 GSM/USIM application interaction and restrictions
#### 8.1.1.1 Definition and applicability
See clause 3.5.3.
#### 8.1.1.2 Conformance requirement
* * *
CR1 Activation of a USIM session shall exclude the activation of a GSM
session. Rel-6 - ... CR2 Once a USIM application session has been activated,
commands sent to the UICC with CLA byte set to \'A0\' shall return SW1SW2 \'6E
00\' (class not supported) to the ME. Rel-6 - ... CR3 Activation of a GSM
session shall exclude the activation of a USIM session. Rel-6 - ...
* * *
Reference: TS 31.101 [2], subclause 4.1.
#### 8.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR3 is not tested as it is out of the scope of the present document.
#### 8.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a STATUS command with \'A0\' as the class byte.
> _The status condition returned by the UICC shall be SW1 = \'6E\', SW2 =
> \'00\' -- class not supported [CR1, CR2]._
d) The ME simulator shall send a STATUS command with \'80\' as the class byte.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of a command [CR1]._
## 8.2 Physical and logical characteristics
### 8.2.1 Transmission speed
#### 8.2.1.1 Definition and applicability
See clause 3.5.3.
#### 8.2.1.2 Conformance requirement
* * *
CR1 The UICC shall support (F, D) = (512, 32) in addition to those required by
TS 102.221 [1]. Rel-6 - ...
* * *
Reference: TS 31.101, subclause 5.1.
#### 8.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 8.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test Procedure 1**
a) The ME simulator shall cold reset the UICC.
b) The ME simulator shall send a PPS-Request to the UICC, selecting T = 0
protocol and (F, D) = (512, 32).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
c) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(512, 32).
> _The UICC shall send a status word indicating successful command execution
> [CR1]._
**Test Procedure 2**
a) The ME simulator shall cold reset the UICC.
b) The ME simulator shall send a PPS-Request to the UICC, selecting T = 1
protocol and (F, D) = (512, 32).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
c) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(512, 32).
> _The UICC shall send a status word indicating successful command execution
> [CR1]._
### 8.2.2 Voltage classes
#### 8.2.2.1 Definition and applicability
See clause 3.5.3.
#### 8.2.2.2 Conformance requirement
* * *
CR1 A UICC holding a USIM application shall support at least two consecutive
voltage classes as defined in TS 102.221 [1], e.g. AB or BC. Rel-6 - ... CR2
If the UICC supports more than two classes, they shall all be consecutive,
e.g. ABC. Rel-6 - ...
* * *
Reference: TS 31.101 [2], subclause 5.2.
#### 8.2.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 8.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> _The UICC shall send the ATR sequence._
>
> _The supply voltage class indicator (the lower 6 bits in TA(i) after the
> first occurrence of T = 15 in TD(i-1) for I > 2) shall be exist and one of
> the following values:_
>
> _\- \'03\', \'06\', \'07\' [CR1, CR2]._
### 8.2.3 File Control Parameters (FCP)
#### 8.2.3.1 Definition and applicability
See clause 3.5.3.
#### 8.2.3.2 Conformance requirement
* * *
CR1 The value indicated in the Minimum application clock frequency object
shall not exceed 3 MHz, corresponding to \'1E\'. Rel-6 - ...
* * *
Reference: TS 31.101 [2], subclause 5.3.
#### 8.2.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 8.2.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command with AID to the UICC to
> select and activate the USIM application.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command._
_If the returned FCP contains the Proprietary Information object (Tag \'A5\')
and the Proprietary Information object contains the Minimum application clock
frequency object (Tag \'82\') then:_
_\- The Application minimum clock frequency value shall not exceed \'1E\',
which corresponds to 3 MHz. [CR1]_
## 8.3 User verification and file access conditions
### 8.3.1 Definition and applicability
See clause 3.5.3.
### 8.3.2 Conformance requirement
* * *
CR1 Every file related to a 3GPP application shall have a reference to an
access rule stored in EF~ARR~. Rel-6 - ... CR2 A multi-verification capable
UICC holding a 3GPP application shall support the referenced format using SEID
as defined in TS 102 221 [1]. Rel-6 - ...: O_MULTI_VER CR3 A 3GPP application
residing on a multi-verification capable UICC shall support the replacement of
its application PIN with the Universal PIN, key reference \'11\', as defined
in TS 102 221 [1]. Rel-6 - ...: O_MULTI_VER CR4 Only the Universal PIN is
allowed as a replacement. Rel-6 - ...: O_MULTI_VER
* * *
Reference: TS 31.101 [2], subclause 7.
### 8.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR3 is tested in the subclause 6.6.3.
NOTE 2: CR4 is not currently tested in this document.
### 8.3.4 Method of test
Initial conditions
> 1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in the USIM application.
> _The response data shall contain the TLV DO with with tag \'8B\' indicating
> Referenced Security Attributes and shall contain the file ID and EF~ARR~
> record numbers for SEID = 0 and SEID = 1 [CR1, CR2]._
>
> d) Step c) shall be repeated for all the EFs under the selected USIM in the
> UICC.
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in the USIM application.
> _The response data shall contain the TLV DO with with tag \'8B\' indicating
> Referenced Security Attributes [CR1]._
>
> d) Step c) shall be repeated for all the EFs under the selected USIM in the
> UICC.
## 8.4 Files
### 8.4.1 Contents of the EFs at the MF level
#### 8.4.1.1 Definition and applicability
See clause 3.5.3.
#### 8.4.1.2 Conformance requirement
* * *
CR1 EF~ARR~ under MF is mandatory. Rel-6 - ... CR2 EF~DIR~ entries for 3GPP
applications shall contain the Application Identifier and the Application
Label as mandatory elements. Rel-6 - ... CR3 EF~DIR~ entries for 3GPP
applications shall not contain a path object for application selection. Rel-6
- ...
* * *
Reference: TS 31.101 [2], subclause 8.1.
#### 8.4.1.3 Test purpose
To verify that the Elementary Files within the UICC application structure
conform to the above requirements.
#### 8.4.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select EF~DIR~.
d) Step e) shall be repeated for each record in EF~DIR~.
e) The ME simulator shall send a READ RECORD command with NEXT mode to the
UICC.
> _If the EF~DIR~ entry contains a 3GPP application (i.e. contains an AID
> matching the AID of a 3GPP application as defined in TS 101 220 [15]),
> then:_
>
> _\- the Application Label shall be present [CR2];_
>
> _\- a File Reference (tag \'51\') TLV DO shall not be present [CR3]._
#