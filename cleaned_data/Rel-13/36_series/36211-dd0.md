# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the physical channels for evolved UTRA.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 36.201: \"Evolved Universal Terrestrial Radio Access (E-UTRA); LTE
physical layer; General description\".
[3] 3GPP TS 36.212: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Multiplexing and channel coding\".
[4] 3GPP TS 36.213: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical layer procedures\".
[5] 3GPP TS 36.214: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical layer; Measurements\".
[6] 3GPP TS 36.104: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Base Station (BS) radio transmission and reception\".
[7] 3GPP TS 36.101: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) radio transmission and reception\".
[8] 3GPP TS 36.321, \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Medium Access Control (MAC) protocol specification\".
[9] 3GPP TS 36.331, \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC) Protocol specification\"
[10] 3GPP TS 36.304, \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) procedures in idle mode\"
# 3 Symbols and abbreviations
## 3.1 Symbols
For the purposes of the present document, the following symbols apply:
Resource element with frequency-domain index and time-domain index
Value of resource element [for antenna port]
Matrix for supporting cyclic delay diversity
Density of random access opportunities per radio frame
Carrier frequency
PRACH resource frequency index within the considered time-domain location
PRACH frequency hopping offset, expressed as a number of resource blocks
Start symbol in slot 0 for NPDCCH
Start symbol in slot 0 for NPDSCH
Bandwidth for PSBCH transmission, expressed as a number of subcarriers
Bandwidth for PSBCH transmission, expressed as a number of resource blocks
Bandwidth for PSCCH transmission, expressed as a number of subcarriers
Bandwidth for PSCCH transmission, expressed as a number of resource blocks
Bandwidth for PSDCH transmission, expressed as a number of subcarriers
Bandwidth for PSDCH transmission, expressed as a number of resource blocks
Scheduled bandwidth for PSSCH transmission, expressed as a number of
subcarriers
Scheduled bandwidth for PSSCH transmission, expressed as a number of resource
blocks
Scheduled bandwidth for uplink transmission, expressed as a number of
subcarriers
Scheduled bandwidth for uplink transmission, expressed as a number of resource
blocks
> Scheduled number of repetitions of a NPUSCH transmission
Scheduled number of repetitions of a NPDSCH transmission
Scheduled bandwidth for uplink NPUSCH transmission, expressed as a number of
subcarriers
Number of repetitions of identical slots for NPUSCH
Number of coded bits to transmit on a physical channel [for codeword ]
Number of modulation symbols to transmit on a physical channel [for codeword ]
Number of modulation symbols to transmit per layer for a physical channel
Number of modulation symbols to transmit per antenna port for a physical
channel
A constant equal to 2048 for , 4096 for and 8192 for
Downlink cyclic prefix length for OFDM symbol in a slot
Cyclic shift value used for random access preamble generation
Number of cyclic shifts used for PUCCH formats 1/1a/1b in a resource block
with a mix of formats 1/1a/1b and 2/2a/2b
Bandwidth available for use by PUCCH formats 2/2a/2b, expressed in multiples
of
The offset used for PUSCH frequency hopping, expressed in number of resource
blocks (set by higher layers)
Physical layer cell identity
Narrowband physical layer cell identity
MBSFN area identity
Physical layer sidelink synchronization identity
Downlink bandwidth configuration, expressed in multiples of
Smallest downlink bandwidth configuration, expressed in multiples of
Largest downlink bandwidth configuration, expressed in multiples of
Uplink bandwidth configuration, expressed in multiples of
Smallest uplink bandwidth configuration, expressed in multiples of
Largest uplink bandwidth configuration, expressed in multiples of
Sidelink bandwidth configuration, expressed in multiples of
Number of scheduled subframes for NPDSCH transmission
Number of symbols for NPSS in a subframe
Number of symbols for NSSS in a subframe
Number of consecutive subcarriers in an UL resource unit for NB-IoT
Number of reference signal sequences available for the UL resource unit size
Number of scheduled UL resource units for NB-IoT
Total number of uplink narrowbands
Number of subcarriers in the frequency domain for NB-IoT
Number of consecutive absolute subframes over which the scrambling sequence
stays the same
Total number of absolute subframes a PUSCH with repetition spans , expressed
as a number of absolute subframes
Number of repetititions of a PUSCH transmission
Number of consecutive absolute subframes over which PUCCH or PUSCH stays at
the same narrowband before hopping to another narrowband, expressed as a
number of absolute subframes
Narrowband offset between one narrowband and the next narrowband a PUSCH hops
to, expressed as a number of uplink narrowbands
Total number of absolute subframes a PUCCH with repetition spans, expressed as
a number of absolute subframes
Number of repetititions of a PUCCH transmission
Number of PRACH repetitions per preamble transmission attempt
Number of subframes allowed for preamble transmission within a 1024-frame
interval
PRACH starting subframe periodicity
Number of NPRACH repetitions per preamble transmission attempt
_NPRACH resource periodicity_
_Frequency location of the first sub-carrier allocated to NPRACH_
_Number of sub-carriers allocated to NPRACH_
_Number of starting sub-carriers allocated for UE initiated random access_
NPRACH starting subframe
Fraction for starting subcarrier index for UE support for multi-tone msg3
transmission
Periodicity for NPDSCH/NPDCCH gaps
Duration for NPDSCH/NPDCCH gaps
Threshold for applying NPDDCH/NPDCCH gaps
Total number of downlink narrowbands
Total number of absolute subframes a PDSCH with repetition spans, expressed as
a number of absolute subframes
Number of repetititions of a PDSCH transmission
Number of consecutive absolute subframes over which MPDCCH or PDSCH stays at
the same narrowband before hopping to another narrowband, expressed as a
number of absolute subframes
Number of narrowbands over which MPDCCH or PDSCH frequency hops
Narrowband offset between one narrowband and the next narrowband an MPDCCH or
PDSCH hops to, expressed as a number of downlink narrowbands
Number of times a PDSCH carrying SIB1-BR is transmitted over 8 radio frames
Total number of absolute subframes a MPDCCH with repetition spans , expressed
as a number of absolute subframes
Number of repetitions of a MPDCCH transmission
Total number of absolute subframes a MPDCCH search space with maximum
repetition level spans, expressed as a number of absolute subframes
Maximum repetition level of a MPDCCH search space
Number of ECCEs in a subframe for one MPDCCH
Number of OFDM symbols in a downlink slot
Number of SC-FDMA symbols in an uplink slot
Number of consecutive slots in an UL resource unit for NB-IoT
Number of SC-FDMA symbols in a sidelink slot
Resource block size in the frequency domain, expressed as a number of
subcarriers
Number of sub-bands for PUSCH frequency-hopping with predefined hopping
pattern
Size of each sub-band for PUSCH frequency-hopping with predefined hopping
pattern, expressed as a number of resource blocks
Size of narrow-band random-access resource in number of subcarriers
Number of downlink to uplink switch points within the radio frame
Number of reference symbols per slot for PUCCH
Timing offset between uplink and downlink radio frames at the UE, expressed in
units of
Fixed timing advance offset, expressed in units of
Timing offset between sidelink and timing reference frames at the UE,
expressed in units of
Resource index for PUCCH formats 1/1a/1b
Resource index for PUCCH formats 2/2a/2b
Resource index for PUCCH formats 3
Number of PDCCHs present in a subframe
Physical resource block number
First physical resource block occupied by PRACH resource considered
First physical resource block available for PRACH
Subcarrier occupied by NPRACH resource considered
Virtual resource block number
Radio network temporary identifier
Sidelink group destination identity
System frame number
Slot number within a radio frame
_Absolute subframe number_
Index for subframes allowed for preamble transmission
Number of antenna ports used for transmission of a channel
Antenna port number
Codeword number
Index for PRACH versions with same preamble format and PRACH density
_Q~m~_ Modulation order: 2 for QPSK, 4 for 16QAM, 6 for 64QAM and 8 for 256QAM
transmissions
Time-continuous baseband signal for antenna port and OFDM symbol in a slot
Radio frame indicator index of PRACH opportunity
Half frame index of PRACH opportunity within the radio frame
Uplink subframe number for start of PRACH opportunity within the half frame
Radio frame duration
Basic time unit
Slot duration
Precoding matrix for downlink spatial multiplexing
Amplitude scaling for PRACH
Amplitude scaling for NPRACH
Amplitude scaling for PUCCH
Amplitude scaling for PUSCH
Amplitude scaling for NPUSCH
Amplitude scaling for sounding reference symbols
Subcarrier spacing
Subcarrier spacing for the random access preamble
Number of transmission layers
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
CCE Control Channel Element
CDD Cyclic Delay Diversity
CRS Cell-specific Reference Signal
CSI Channel-State Information
DCI Downlink Control Information
DM-RS Demodulation Reference Signal
ECCE Enhanced Control Channel Element
EPDCCH Enhanced Physical Downlink Control CHannel
EREG Enhanced Resource-Element Group
MPDCCH MTC Physical Downlink Control Channel
NCCE Narrowband Control Channel Element
NPBCH Narrowband Physical Broadcast CHannel
NPDCCH Narrowband Physical Downlink Control CHannel
NPDSCH Narrowband Physical Downlink Shared CHannel
NPRACH Narrowband Physical Random Access CHannel
NPUSCH Narrowband Physical Uplink Shared CHannel
NPSS Narrowband Primary Synchronization Signal
NSSS Narrowband Secondary Synchronization Signal
NRS Narrowband Reference Signal PBCH Physical Broadcast CHannel
PCFICH Physical Control Format Indicator CHannel
PDCCH Physical Downlink Control CHannel
PDSCH Physical Downlink Shared CHannel
PHICH Physical Hybrid-ARQ Indicator CHannel
PMCH Physical Multicast CHannel
PRACH Physical Random Access CHannel
PRB Physical Resource Block
PRS Positioning Reference Signal
PSBCH Physical Sidelink Broadcast CHannel
PSCCH Physical Sidelink Control CHannel
PSDCH Physical Sidelink Discovery CHannel
PSSCH Physical Sidelink Shared CHannel
PUCCH Physical Uplink Control CHannel
PUSCH Physical Uplink Shared CHannel
REG Resource-Element Group
SCG Secondary Cell Group
SRS Sounding Reference Signal
VRB Virtual Resource Block
# 4 Frame structure
Throughout this specification, unless otherwise noted, the size of various
fields in the time domain is expressed as a number of time units seconds.
Downlink, uplink and sidelink transmissions are organized into radio frames
with duration.\ Three radio frame structures are supported:
\- Type 1, applicable to FDD only,
\- Type 2, applicable to TDD only,
\- Type 3, applicable to LAA secondary cell operation only.
NOTE: LAA secondary cell operation only applies to frame structure type 3.
Transmissions in multiple cells can be aggregated where up to 31 secondary
cells can be used in addition to the primary cell. Unless otherwise noted, the
description in this specification applies to each of the up to 32 serving
cells. In case of multi-cell aggregation, different frame structures can be
used in the different serving cells.
## 4.1 Frame structure type 1
Frame structure type 1 is applicable to both full duplex and half duplex FDD
only. Each radio frame is long and consists of 20 slots of length, numbered
from 0 to 19. A subframe is defined as two consecutive slots where subframe
consists of slots and. Subframe in frame has an absolute subframe number
_where is the system frame number._
For FDD, 10 subframes are available for downlink transmission and 10 subframes
are available for uplink transmissions in each 10 ms interval. Uplink and
downlink transmissions are separated in the frequency domain. In half-duplex
FDD operation, the UE cannot transmit and receive at the same time while there
are no such restrictions in full-duplex FDD.
Figure 4.1-1: Frame structure type 1
## 4.2 Frame structure type 2
Frame structure type 2 is applicable to TDD only. Each radio frame of length
consists of two half-frames of length each. Each half-frame consists of five
subframes of length. Each subframe _is_ defined as two slots, and, of length
each. Subframe in frame has an absolute subframe number _where is the system
frame number._
The uplink-downlink configuration in a cell may vary between frames and
controls in which subframes uplink or downlink transmissions may take place in
the current frame. The uplink-downlink configuration in the current frame is
obtained according to Section 13 in [4].
The supported uplink-downlink configurations are listed in Table 4.2-2 where,
for each subframe in a radio frame, \"D\" denotes a downlink subframe reserved
for downlink transmissions, \"U\" denotes an uplink subframe reserved for
uplink transmissions and \"S\" denotes a special subframe with the three
fields DwPTS, GP and UpPTS. The length of DwPTS and UpPTS is given by Table
4.2-1 subject to the total length of DwPTS, GP and UpPTS being equal to where
X is the number of additional SC-FDMA symbols in UpPTS provided by the higher
layer parameter _srs-UpPtsAdd_ if configured otherwise X is equal to 0. The UE
is not expected to be configured with 2 additional UpPTS SC-FDMA symbols for
special subframe configurations {3, 4, 7, 8} for normal cyclic prefix in
downlink and special subframe configurations {2, 3, 5, 6} for extended cyclic
prefix in downlink and 4 additional UpPTS SC-FDMA symbols for special subframe
configurations {1 2, 3, 4, 6, 7, 8} for normal cyclic prefix in downlink and
special subframe configurations {1, 2, 3, 5, 6} for extended cyclic prefix in
downlink.
Uplink-downlink configurations with both 5 ms and 10 ms downlink-to-uplink
switch-point periodicity are supported.
\- In case of 5 ms downlink-to-uplink switch-point periodicity, the special
subframe exists in both half-frames.
\- In case of 10 ms downlink-to-uplink switch-point periodicity, the special
subframe exists in the first half-frame only.
Subframes 0 and 5 and DwPTS are always reserved for downlink transmission.
UpPTS and the subframe immediately following the special subframe are always
reserved for uplink transmission.
In case multiple cells are aggregated, the UE may assume that the guard period
of the special subframe in the cells using frame structure type 2 have an
overlap of at least .
In case multiple cells with different uplink-downlink configurations in the
current radio frame are aggregated and the UE is not capable of simultaneous
reception and transmission in the aggregated cells, the following constraints
apply:
\- if the subframe in the primary cell is a downlink subframe, the UE shall
not transmit any signal or channel on a secondary cell in the same subframe
\- if the subframe in the primary cell is an uplink subframe, the UE is not
expected to receive any downlink transmissions on a secondary cell in the same
subframe
\- if the subframe in the primary cell is a special subframe and the same
subframe in a secondary cell is a downlink subframe, the UE is not expected to
receive PDSCH/EPDCCH/PMCH/PRS transmissions in the secondary cell in the same
subframe, and the UE is not expected to receive any other signals on the
secondary cell in OFDM symbols that overlaps with the guard period or UpPTS in
the primary cell.
Figure 4.2-1: Frame structure type 2 (for 5 ms switch-point periodicity)
Table 4.2-1: Configuration of special subframe (lengths of DwPTS/GP/UpPTS)
* * *
Special subframe configuration Normal cyclic prefix in downlink Extended
cyclic prefix in downlink
* * *
                                   DwPTS                              UpPTS                                DwPTS                     UpPTS
                                                                      Normal cyclic prefix\                Extended cyclic prefix\           Normal cyclic prefix in uplink   Extended cyclic prefix in uplink
                                                                      in uplink                            in uplink
0
1
2
3
4
5
6
7
8 - - -
9 - - -
* * *
Table 4.2-2: Uplink-downlink configurations
Uplink-downlink configuration | Downlink-to-Uplink Switch-point periodicity | Subframe number |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---|---|---  
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9  
0 | 5 ms | D | S | U | U | U | D | S | U | U | U  
1 | 5 ms | D | S | U | U | D | D | S | U | U | D  
2 | 5 ms | D | S | U | D | D | D | S | U | D | D  
3 | 10 ms | D | S | U | U | U | D | D | D | D | D  
4 | 10 ms | D | S | U | U | D | D | D | D | D | D  
5 | 10 ms | D | S | U | D | D | D | D | D | D | D  
6 | 5 ms | D | S | U | U | U | D | S | U | U | D  
## 4.3 Frame structure type 3
Frame structure type 3 is applicable to LAA secondary cell operation with
normal cyclic prefix only. Each radio frame is long and consists of 20 slots
of length, numbered from 0 to 19. A subframe is defined as two consecutive
slots where subframe consists of slots and.
The 10 subframes within a radio frame are available for downlink
transmissions. Downlink transmissions occupy one or more consecutive
subframes, starting anywhere within a subframe and ending with the last
subframe either fully occupied or following one of the DwPTS durations in
Table 4.2-1.
# 5 Uplink
## 5.1 Overview
The smallest resource unit for uplink transmissions is denoted a resource
element and is defined in clause 5.2.2.
### 5.1.1 Physical channels
An uplink physical channel corresponds to a set of resource elements carrying
information originating from higher layers and is the interface defined
between 3GPP TS 36.212 [3] and the present document 3GPP TS 36.211.\ The
following uplink physical channels are defined:
\- Physical Uplink Shared Channel, PUSCH
\- Physical Uplink Control Channel, PUCCH
\- Physical Random Access Channel, PRACH
### 5.1.2 Physical signals
An uplink physical signal is used by the physical layer but does not carry
information originating from higher layers. The following uplink physical
signals are defined:
\- Reference signal
## 5.2 Slot structure and physical resources
### 5.2.1 Resource grid
The transmitted signal in each slot is described by one or several resource
grids of subcarriers and SC-FDMA symbols. The resource grid is illustrated in
Figure 5.2.1-1. The quantity depends on the uplink transmission bandwidth
configured in the cell and shall fulfil
where and are the smallest and largest uplink bandwidths, respectively,
supported by the current version of this specification. The set of allowed
values for is given by 3GPP TS 36.101 [7].
The number of SC-FDMA symbols in a slot depends on the cyclic prefix length
configured by the higher layer parameter _UL-CyclicPrefixLength_ and is given
in Table 5.2.3-1.
An antenna port is defined such that the channel over which a symbol on the
antenna port is conveyed can be inferred from the channel over which another
symbol on the same antenna port is conveyed. There is one resource grid per
antenna port. The antenna ports used for transmission of a physical channel or
signal depends on the number of antenna ports configured for the physical
channel or signal as shown in Table 5.2.1-1. The index is used throughout
clause 5 when a sequential numbering of the antenna ports is necessary.
Figure 5.2.1-1: Uplink resource grid
Table 5.2.1-1: Antenna ports used for different physical channels and signals
* * *
Physical channel or signal Index Antenna port number as a function of\  
the number of antenna ports configured\  
for the respective physical channel/signal
* * *
                                       1                                            2     4
PUSCH 0 10 20 40
                               1       \-                                           21    41
                               2       \-                                           \-    42
                               3       \-                                           \-    43
SRS 0 10 20 40
                               1       \-                                           21    41
                               2       \-                                           \-    42
                               3       \-                                           \-    43
PUCCH 0 100 200 -
                               1       \-                                           201   \-
* * *
### 5.2.2 Resource elements
Each element in the resource grid is called a resource element and is uniquely
defined by the index pair in a slot where and are the indices in the frequency
and time domains, respectively. Resource element on antenna port corresponds
to the complex value _._ \ _When there is no risk for confusion, or no
particular antenna port is specified, the index_ may be dropped _._ \
Quantities corresponding to resource elements not used for transmission of a
physical channel or a physical signal in a slot shall be set to zero.
### 5.2.3 Resource blocks
A physical resource block is defined as consecutive SC-FDMA symbols in the
time domain and consecutive subcarriers in the frequency domain, where and are
given by Table 5.2.3-1.\ A physical resource block in the uplink thus consists
of resource elements, corresponding to one slot in the time domain and 180 kHz
in the frequency domain.
Table 5.2.3-1: Resource block parameters
Configuration
* * *
Normal cyclic prefix 12 7 Extended cyclic prefix 12 6
The relation between the physical resource block number in the frequency
domain and resource elements in a slot is given by
### 5.2.4 Narrowbands
A narrowband is defined as six non-overlapping consecutive physical resource
blocks in the frequency domain. The total number of uplink narrowbands in the
uplink transmission bandwidth configured in the cell is given by
The narrowbands are numbered in order of increasing physical resource-block
number where narrowband is composed of physical resource-block indices
where
### 5.2.5 Guard period for narrowband retuning
For BL/CE UEs, a guard period is created for Tx-to-Tx frequency retuning
between two consecutive subframes.
\- If the UE retunes from a first narrowband carrying PUSCH to a second
narrowband carrying PUSCH, or if the UE retunes from a first narrowband
carrying PUCCH to a second narrowband carrying PUCCH,
\- a guard period is created by the UE not transmitting the last SC-FDMA
symbol in the first subframe and the first SC-FDMA symbol in the second
subframe.
\- If the UE retunes from a first narrowband carrying PUCCH to a second
narrowband carrying PUSCH,
\- if the PUCCH uses a shortened PUCCH format, a guard period is created by
the UE not transmitting the last SC-FDMA symbol in the first subframe and the
first SC-FDMA symbol in the second subframe,
\- otherwise a guard period is created by the UE not transmitting the first
two SC-FDMA symbols in the second subframe.
\- If the UE retunes from a first narrowband carrying PUSCH to a second
narrowband carrying PUCCH,
\- a guard period is created by the UE not transmitting the last two SC-FDMA
symbols in the first subframe.
## 5.3 Physical uplink shared channel
The baseband signal representing the physical uplink shared channel is defined
in terms of the following steps:
\- scrambling
\- modulation of scrambled bits to generate complex-valued symbols
\- mapping of the complex-valued modulation symbols onto one or several
transmission layers
\- transform precoding to generate complex-valued symbols
\- precoding of the complex-valued symbols
\- mapping of precoded complex-valued symbols to resource elements
\- generation of complex-valued time-domain SC-FDMA signal for each antenna
port
Figure 5.3-1: Overview of uplink physical channel processing
### 5.3.1 Scrambling
For each codeword , the block of bits , where is the number of bits
transmitted in codeword on the physical uplink shared channel in one subframe,
shall be scrambled with a UE-specific scrambling sequence prior to modulation,
resulting in a block of scrambled bits according to the following pseudo code
Set _i_ = 0
while
if // ACK/NACK or Rank Indication placeholder bits
else
if // ACK/NACK or Rank Indication repetition placeholder bits
else // Data or channel quality coded bits, Rank Indication coded bits or
ACK/NACK coded bits
end if
end if
_i_ = _i_ \+ 1
end while
where x and y are tags defined in 3GPP TS 36.212 [3] clause 5.2.2.6 and where
the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe where
corresponds to the RNTI associated with the PUSCH transmission as described in
clause 8 in 3GPP TS 36.213 [4].
For BL/CE UEs, the same scrambling sequence is applied per subframe to PUSCH
for a given block of subframes. The subframe number of the first subframe in
each block of consecutive subframes, denoted as , satisfies . For the block of
subframes, the scrambling sequence generator shall be initialised with
where
and is the absolute subframe number of the first uplink subframe intended for
PUSCH. The PUSCH transmission spans consecutive subframes including subframes
that are not BL/CE UL subframes where the UE postpones the PUSCH transmission.
For a BL/CE UE configured in CEModeA, . For a BL/CE UE configured with
CEModeB, for frame structure type 1 and for frame structure type 2.
Up to two codewords can be transmitted in one subframe, i.e., . In the case of
single-codeword transmission, .
### 5.3.2 Modulation
For each codeword, the block of scrambled bits shall be modulated as described
in clause 7.1, resulting in a block of complex-valued symbols . Table 5.3.2-1
specifies the modulation mappings applicable for the physical uplink shared
channel.
Table 5.3.2-1: Uplink modulation schemes
Physical channel Modulation schemes
* * *
PUSCH QPSK, 16QAM, 64QAM
### 5.3.2A Layer mapping
The complex-valued modulation symbols for each of the codewords to be
transmitted are mapped onto one or two layers. Complex-valued modulation
symbols for codeword shall be mapped onto the layers , where is the number of
layers and is the number of modulation symbols per layer.
#### 5.3.2A.1 Layer mapping for transmission on a single antenna port
For transmission on a single antenna port, a single layer is used, , and the
mapping is defined by
with .
#### 5.3.2A.2 Layer mapping for spatial multiplexing
For spatial multiplexing, the layer mapping shall be done according to Table
5.3.2A.2-1. The number of layers is less than or equal to the number of
antenna ports used for transmission of the physical uplink shared channel.\
The case of a single codeword mapped to multiple layers is only applicable
when the number of antenna ports used for PUSCH is four.
Table 5.3.2A.2-1: Codeword-to-layer mapping for spatial multiplexing
Number of layers Number of codewords Codeword-to-layer mapping
* * *
1 1  
2 1  
2 2
3 2  
4 2
### 5.3.3 Transform precoding
For each layer the block of complex-valued symbols is divided into sets, each
corresponding to one SC-FDMA symbol. Transform precoding shall be applied
according to
resulting in a block of complex-valued symbols . The variable, where
represents the bandwidth of the PUSCH in terms of resource blocks, and shall
fulfil
where is a set of non-negative integers.
### 5.3.3A Precoding
The precoder takes as input a block of vectors , from the transform precoder
and generates a block of vectors , to be mapped onto resource elements.
#### 5.3.3A.1 Precoding for transmission on a single antenna port
For transmission on a single antenna port, precoding is defined by
where , .
#### 5.3.3A.2 Precoding for spatial multiplexing
Precoding for spatial multiplexing is only used in combination with layer
mapping for spatial multiplexing as described in clause 5.3.2A.2. Spatial
multiplexing supports or antenna ports where the set of antenna ports used for
spatial multiplexing is and , respectively.
Precoding for spatial multiplexing is defined by
where , .
The precoding matrix of size is given by one of the entries in Table
5.3.3A.2-1 for and by Tables 5.3.3A.2-2 through 5.3.3A.2-5 for where the
entries in each row are ordered from left to right in increasing order of
codebook indices.
Table 5.3.3A.2-1: Codebook for transmission on antenna ports
Codebook index Number of layers
* * *
0  
1 - 2 - 3 - 4 - 5 -
Table 5.3.3A.2-2: Codebook for transmission on antenna ports with
Codebook index Number of layers
* * *
0 -- 7  
8 -- 15  
16 -- 23
Table 5.3.3A.2-3: Codebook for transmission on antenna ports with
Codebook index Number of layers
* * *
0 -- 3  
4 -- 7  
8 -- 11  
12 -- 15
Table 5.3.3A.2-4: Codebook for transmission on antenna ports with
Codebook index Number of layers
* * *
0 -- 3  
4 -- 7  
8 -- 11
Table 5.3.3A.2-5: Codebook for transmission on antenna ports with
Codebook index Number of layers
* * *
0
### 5.3.4 Mapping to physical resources
For each antenna port used for transmission of the PUSCH in a subframe the
block of complex-valued symbols shall be multiplied with the amplitude scaling
factor in order to conform to the transmit power specified in clause 5.1.1.1
in 3GPP TS 36.213 [4], and mapped in sequence starting with to physical
resource blocks on antenna port and assigned for transmission of PUSCH. The
relation between the index and the antenna port number is given by Table
5.2.1-1. The mapping to resource elements corresponding to the physical
resource blocks assigned for transmission and
\- not used for transmission of reference signals, and
\- not part of the last SC-FDMA symbol in a subframe, if the UE transmits SRS
in the same subframe in the same serving cell, and
\- not part of the last SC-FDMA symbol in a subframe configured with cell-
specific SRS for non-BL/CE UEs and BL/CE UEs in CEModeA, if the PUSCH
transmission partly or fully overlaps with the cell-specific SRS bandwidth,
and
\- not part of an SC-FDMA symbol reserved for possible SRS transmission in a
UE-specific aperiodic SRS subframe in the same serving cell, and
\- not part of an SC-FDMA symbol reserved for possible SRS transmission in a
UE-specific periodic SRS subframe in the same serving cell when the UE is
configured with multiple TAGs
shall be in increasing order of first the index , then the index, starting
with the first slot in the subframe.
For BL/CE UEs in CEModeB, resource elements in the last SC-FDMA symbol in a
subframe configured with cell-specific SRS shall be counted in the PUSCH
mapping but not used for transmission of the PUSCH.
For BL/CE UEs, if one or more SC-FDMA symbol(s) are left empty due to guard
period for narrowband retuning, the affected SC-FDMA symbol(s) shall be
counted in the PUSCH mapping but not used for transmission of the PUSCH.
If uplink frequency-hopping is disabled or the resource blocks allocated for
PUSCH transmission are not contiguous in frequency, the set of physical
resource blocks to be used for transmission is given by where is obtained from
the uplink scheduling grant as described in clause 8.1 in 3GPP TS 36.213 [4].
If uplink frequency-hopping with type 1 PUSCH hopping is enabled, the set of
physical resource blocks to be used for transmission is given by clause 8.4.1
in 3GPP TS 36.213 [4].
If uplink frequency-hopping with predefined hopping pattern is enabled, the
set of physical resource blocks to be used for transmission in slot is given
by the scheduling grant together with a predefined pattern according to
where is obtained from the scheduling grant as described in clause 8.1 in 3GPP
TS 36.213 [4]. The parameter _pusch-HoppingOffset_ ,, is provided by higher
layers. The size of each sub-band is given by,
where the number of sub-bands is given by higher layers. The function
determines whether mirroring is used or not. The parameter _Hopping-mode_
provided by higher layers determines if hopping is \"inter-subframe\" or
\"intra and inter-subframe\".
The hopping function and the function are given by
where and the pseudo-random sequence is given by clause 7.2 and CURRENT_TX_NB
indicates the transmission number for the transport block transmitted in slot
as defined in [8]. The pseudo-random sequence generator shall be initialised
with for frame structure type 1 and for frame structure type 2 at the start of
each frame.
For BL/CE UEs, the PRB resources within the narrowband for PUSCH transmission
in the first subframe are obtained from the DCI as described in clauses
5.3.3.1.10 and 5.3.3.1.11 in [3]. The PUSCH is transmitted with repetitions.
The PUSCH transmission spans consecutive subframes, including subframes that
are not BL/CE UL subframes where the UE postpones the PUSCH transmission if .
For BL/CE UE in CEModeA, PUSCH frequency hopping is enabled when the higher-
layer parameter _pusch-HoppingConfig_ is set and the frequency hopping flag in
DCI format 6-0A indicates frequency hopping, otherwise frequency hopping is
disabled. For BL/CE UE in CEModeB, PUSCH frequency hopping is enabled when the
higher-layer parameter _pusch-HoppingConfig_ is set, otherwise frequency
hopping is disabled. If frequency hopping is not enabled for PUSCH, the PUSCH
repetitions are located at the same PRB resources at the same narrowband . If
frequency hopping is enabled for PUSCH, PUSCH is transmitted in uplink
subframe within the consecutive subframes using the same PRB resources within
narrowband
where is the absolute subframe number of the first UL subframe intended for
carrying the PUSCH and and are cell-specific higher-layer parameters. For the
consecutive subframes, the UE shall not transmit PUSCH in subframe if it is
not a BL/CE UL subframe.
For BL/CE UEs, for PUSCH transmission corresponding to the random access
response grant and its retransmission, frequency hopping of the PUSCH is
enabled when higher layer parameter _rar-HoppingConfig_ is set. Further
\- if PRACH CE level 0 or 1 is used for the last PRACH attempt, is set to the
higher layer parameter _interval-UlHoppingConfigCommonModeA_ ;
\- if PRACH CE level 2 or 3 is used for the last PRACH attempt, is set to the
higher layer parameter _interval-UlHoppingConfigCommonModeB_.
For BL/CE UEs in CEModeB, for PUSCH transmission not associated with Temporary
C-RNTI, for frame structure type 1, after a transmission duration of time
units (which may include subframes that are not BL/CE UL subframes), a gap of
time units shall be inserted, according to the UE capability _ue-CE-
NeedULGaps_ , as specified in TS 36.331 [9]. BL/CE UL subframes within the gap
of time units shall be counted for the PUSCH resource mapping but not used for
transmission of the PUSCH.
For BL/CE UEs, for PUSCH transmission associated with Temporary C-RNTI for
frame structure type 1, and if PRACH CE level 2 or 3 is used for the last
PRACH attempt, after a transmission duration of time units (which may include
subframes that are not BL/CE UL subframes), a gap of time units shall be
inserted. BL/CE UL subframes within the gap of time units shall be counted for
the PUSCH resource mapping but not used for transmission of the PUSCH.
## 5.4 Physical uplink control channel
The physical uplink control channel, PUCCH, carries uplink control
information. Simultaneous transmission of PUCCH and PUSCH from the same UE is
supported if enabled by higher layers. For frame structure type 2, the PUCCH
is not transmitted in the UpPTS field.
The physical uplink control channel supports multiple formats as shown in
Table 5.4-1 with different number of bits per subframe, where represents the
bandwidth of the PUCCH format 4 as defined by clause 5.4.2B, and and are
defined in Table 5.4.2C-1.
Formats 2a and 2b are supported for normal cyclic prefix only.
Table 5.4-1: Supported PUCCH formats
PUCCH format Modulation scheme Number of bits per subframe,
* * *
1 N/A N/A 1a BPSK 1 1b QPSK 2 2 QPSK 20 2a QPSK+BPSK 21 2b QPSK+QPSK 22 3 QPSK
48 4 QPSK  
5 QPSK
All PUCCH formats use a cyclic shift, , which varies with the symbol number
and the slot number according to
where the pseudo-random sequence is defined by clause 7.2. The pseudo-random
sequence generator shall be initialized with , where is given by clause
5.5.1.5 with corresponding to the primary cell, at the beginning of each radio
frame.
The physical resources used for PUCCH depends on two parameters, and , given
by higher layers.\ The variable denotes the bandwidth in terms of resource
blocks that are available for use by PUCCH formats 2/2a/2b transmission in
each slot. The variable denotes the number of cyclic shift used for PUCCH
formats 1/1a/1b in a resource block used for a mix of formats 1/1a/1b and
2/2a/2b. The value of is an integer multiple of within the range of {0, 1,
..., 7}, where is provided by higher layers. No mixed resource block is
present if . At most one resource block in each slot supports a mix of formats
1/1a/1b and 2/2a/2b.\ Resources used for transmission of PUCCH formats
1/1a/1b, 2/2a/2b, 3, 4, and 5 are represented by the non-negative indices , ,
, and , respectively.
### 5.4.1 PUCCH formats 1, 1a and 1b
For PUCCH format 1, information is carried by the presence/absence of
transmission of PUCCH from the UE.\ In the remainder of this clause, shall be
assumed for PUCCH format 1.
For PUCCH formats 1a and 1b, one or two explicit bits are transmitted,
respectively. The block of bits shall be modulated as described in Table
5.4.1-1, resulting in a complex-valued symbol.\ The modulation schemes for the
different PUCCH formats are given by Table 5.4-1.
The complex-valued symbol shall be multiplied with a cyclically shifted length
sequence for each of the antenna ports used for PUCCH transmission according
to
where is defined by clause 5.5.1 with. The antenna-port specific cyclic shift
varies between symbols and slots as defined below.
The block of complex-valued symbols shall be scrambled by and block-wise
spread with the antenna-port specific orthogonal sequence according to
where
and
with for the two slots in a subframe given by Table 5.4.1-1a. The sequence is
given by Table 5.4.1-2 and Table 5.4.1-3 and is defined below.
Resources used for transmission of PUCCH format 1, 1a and 1b are identified by
a resource index from which the orthogonal sequence index and the cyclic shift
are determined according to
where
The resource indices within the two resource blocks in the two slots of a
subframe to which the PUCCH is mapped are given by
for and by
for , where , with for normal CP and for extended CP.
The parameter _deltaPUCCH-Shift_ is provided by higher layers.
Table 5.4.1-1: Modulation symbol for PUCCH formats 1a and 1b
PUCCH format
* * *
1a 0  
1  
1b 00  
01  
10  
11
Table 5.4.1-1a: The quantity for PUCCH formats 1a and 1b
PUCCH format
* * *
                      first slot   second slot
normal 1/1a/1b 4 4 shortened 1/1a/1b 4 3
Table 5.4.1-2: Orthogonal sequences for
Sequence index Orthogonal sequences
* * *
0 {width="1.15in" height="0.25in"} 1 {width="1.1416666666666666in"
height="0.25in"} 2 {width="1.1416666666666666in" height="0.25in"}
Table 5.4.1-3: Orthogonal sequences for
Sequence index Orthogonal sequences
* * *
0  
1  
2
### 5.4.2 PUCCH formats 2, 2a and 2b
The block of bits shall be scrambled with a UE-specific scrambling sequence,
resulting in a block of scrambled bits according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe where is
C-RNTI.
The block of scrambled bits shall be QPSK modulated as described in clause
7.1, resulting in a block of complex-valued modulation symbols .
Each complex-valued symbol shall be multiplied with a cyclically shifted
length sequence for each of the antenna ports used for PUCCH transmission
according to
where is defined by clause 5.5.1 with.
Resources used for transmission of PUCCH formats 2/2a/2b are identified by a
resource index from which the cyclic shift is determined according to
where
and
for and by
for .
For PUCCH formats 2a and 2b, supported for normal cyclic prefix only, the
bit(s) shall be modulated as described in Table 5.4.2-1 resulting in a single
modulation symbol used in the generation of the reference-signal for PUCCH
format 2a and 2b as described in clause 5.5.2.2.1.
Table 5.4.2-1: Modulation symbol for PUCCH formats 2a and 2b
PUCCH format
* * *
2a 0  
1  
2b 00  
01  
10  
11
### 5.4.2A PUCCH format 3
The block of bits shall be scrambled with a UE-specific scrambling sequence,
resulting in a block of scrambled bits according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe where is the
C-RNTI.
The block of scrambled bits shall be QPSK modulated as described in Subclause
7.1, resulting in a block of complex-valued modulation symbols where .
The complex-valued symbols shall be block-wise spread with the orthogonal
sequences and resulting in sets of values each according to
where for both slots in a subframe using normal PUCCH format 3 and , holds for
the first and second slot, respectively, in a subframe using shortened PUCCH
format 3. The orthogonal sequences and are given by Table 5.4.2A-1. Resources
used for transmission of PUCCH formats 3 are identified by a resource index
from which the quantities and are derived according to
Each set of complex-valued symbols shall be cyclically shifted according to
where is given by Subclause 5.4, is the slot number within a radio frame and
is the SC-FDMA symbol number within a slot.
The shifted sets of complex-valued symbols shall be transform precoded
according to
where is the number of antenna ports used for PUCCH transmission, resulting in
a block of complex-valued symbols .
Table 5.4.2A-1: The orthogonal sequence
Sequence index Orthogonal sequence
* * *
0  
1  
2  
3  
4 -
### 5.4.2B PUCCH format 4
The block of bits shall be scrambled with a UE-specific scrambling sequence,
resulting in a block of scrambled bits according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe where is the
C-RNTI.
The block of scrambled bits shall be QPSK modulated as described in Subclause
7.1, resulting in a block of complex-valued modulation symbols where .
The block of complex-valued symbols is divided into sets, each corresponding
to one SC-FDMA symbol. Transform precoding shall be applied according to
where , and are given by Table 5.4.2C-1 for normal PUCCH format 4 and
shortened PUCCH format 4, resulting in a block of complex-valued symbols . The
variable, where represents the bandwidth of the PUCCH format 4 in terms of
resource blocks, shall fulfil
where is a set of non-negative integers.
### 5.4.2C PUCCH format 5
The block of bits shall be scrambled with a UE-specific scrambling sequence,
resulting in a block of scrambled bits according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe where is the
C-RNTI.
The block of scrambled bits shall be QPSK modulated as described in Subclause
7.1, resulting in a block of complex-valued modulation symbols where .
The complex-valued symbols shall be divided into sets, each corresponding to
one SC-FDMA symbol. Block-wise spreading shall be applied according to
where , and are given by Table 5.4.2C-1 for normal PUCCH format 5 and
shortened PUCCH format 5, and is given by Table 5.4.2C-2 with provided by
higher layers.
The block-wise spread complex-valued symbols shall be transform precoded
according to
where , resulting in a block of complex-valued symbols .
Table 5.4.2C-1: The quantities and
PUCCH format type Normal cyclic prefix Extended cyclic prefix
* * *
                           ![](media/image539.wmf){width="0.5in" height="0.23333333333333334in"}   ![](media/image540.wmf){width="0.5166666666666667in" height="0.23333333333333334in"}   ![](media/image539.wmf){width="0.5in" height="0.23333333333333334in"}   ![](media/image540.wmf){width="0.5166666666666667in" height="0.23333333333333334in"}
Normal PUCCH format 6 6 5 5 Shortened PUCCH format 6 5 5 4
Table 5.4.2C-2: Orthogonal sequences
      Orthogonal sequences
* * *
0  
1
### 5.4.3 Mapping to physical resources
The block of complex-valued symbols shall be multiplied with the amplitude
scaling factor in order to conform to the transmit power specified in
Subclause 5.1.2.1 in 3GPP TS 36.213 [4], and mapped in sequence starting with
to resource elements. PUCCH uses one or more resource block in each of the two
slots in a subframe. Within the physical resource block(s) used for
transmission, the mapping of to resource elements on antenna port and not used
for transmission of reference signals shall be in increasing order of first ,
then and finally the slot number, starting with the first slot in the
subframe. The relation between the index and the antenna port number is given
by Table 5.2.1-1.
For non-BL/CE UEs, except for PUCCH format 4, the physical resource blocks to
be used for transmission of PUCCH in slot are given by
For BL/CE UEs, PUCCH is transmitted with repetitions. The PUCCH transmission
spans consecutive subframes, including subframes that are not BL/CE UL
subframes where the UE postpones the PUCCH transmission if . The quantity is
given
\- by the higher layer parameter _pucch-NumRepetitionCE-Format1_ for PUCCH
format 1/1a and _pucch-NumRepetitionCE-Format2_ for PUCCH format 2/2a/2b, if
configured. Otherwise
\- by the higher-layer parameter _pucch-NumRepetitionCE-Msg4-Level0-r13,
pucch-NumRepetitionCE-Msg4-Level1-r13, pucch-NumRepetitionCE-Msg4-Level2-r13_
or _pucch-NumRepetitionCE-Msg4-Level3-r13_.
The physical resource blocks to be used for transmission of PUCCH in subframe
within the consecutive subframes are given by
where is the absolute subframe number of the first uplink subframe intended
for PUCCH.
The variable depends on the PUCCH format.
\- Formats 1, 1a and 1b:
\- Formats 2, 2a and 2b:
\- Format 3:
\- Format 5 (non-BL/CE UEs only):
For non-BL/CE UEs, for PUCCH format 4, the physical resource blocks to be used
for transmission of PUCCH in slot are given by
where is obtained from [4].
Mapping of modulation symbols for the physical uplink control channel for
PUCCH formats 1 -- 3 is illustrated in Figure 5.4.3-1.
In case of simultaneous transmission of sounding reference signal and PUCCH
format 1, 1a, 1b, 3, 4 or 5 when there is one serving cell configured, the
shortened PUCCH format shall be used where the last SC-FDMA symbol in the
second slot of a subframe shall be left empty.
In case of guard period for narrowband retuning for BL/CE UEs, if an SC-FDMA
symbol is left empty due to guard period, the SC-FDMA symbol shall be counted
in the PUCCH mapping but not used for transmission of the PUCCH. The SC-FDMA
symbol affected by the guard period can be the first SC-FDMA symbol in the
first slot of a subframe and/or the last SC-FDMA symbol in the second slot of
a subframe.
Figure 5.4.3-1: Mapping to physical resource blocks for PUCCH formats 1 \-- 3
for non-BL/CE UEs.
## 5.5 Reference signals
Two types of uplink reference signals are supported:
\- Demodulation reference signal, associated with transmission of PUSCH or
PUCCH
\- Sounding reference signal, not associated with transmission of PUSCH or
PUCCH
The same set of base sequences is used for demodulation and sounding reference
signals.
### 5.5.1 Generation of the reference signal sequence
Reference signal sequence is defined by a cyclic shift of a base sequence
according to
where is the length of the reference signal sequence and. Multiple reference
signal sequences are defined from a single base sequence through different
values of .
Base sequences are divided into groups, where is the group number and is the
base sequence number within the group, such that each group contains one base
sequence () of each length , and two base sequences () of each length , . The
sequence group number and the number within the group may vary in time as
described in clauses 5.5.1.3 and 5.5.1.4, respectively. The definition of the
base sequence depends on the sequence length.
#### 5.5.1.1 Base sequences of length or larger
For, the base sequence is given by
where the root Zadoff-Chu sequence is defined by
with given by
The length of the Zadoff-Chu sequence is given by the largest prime number
such that.
#### 5.5.1.2 Base sequences of length less than
For and, base sequence is given by
where the value of is given by Table 5.5.1.2-1 and Table 5.5.1.2-2 for and ,
respectively.
Table 5.5.1.2-1: Definition of for .
* * *
0 -1 1 3 -3 3 3 1 1 3 1 -3 3 1 1 1 3 3 3 -1 1 -3 -3 1 -3 3 2 1 1 -3 -3 -3 -1
-3 -3 1 -3 1 -1 3 -1 1 1 1 1 -1 -3 -3 1 -3 3 -1 4 -1 3 1 -1 1 -1 -3 -1 1 -1 1
3 5 1 -3 3 -1 -1 1 1 -1 -1 3 -3 1 6 -1 3 -3 -3 -3 3 1 -1 3 3 -3 1 7 -3 -1 -1
-1 1 -3 3 -1 1 -3 3 1 8 1 -3 3 1 -1 -1 -1 1 1 3 -1 1 9 1 -3 -1 3 3 -1 -3 1 1 1
1 1 10 -1 3 -1 1 1 -3 -3 -1 -3 -3 3 -1 11 3 1 -1 -1 3 3 -3 1 3 1 3 3 12 1 -3 1
1 -3 1 1 1 -3 -3 -3 1 13 3 3 -3 3 -3 1 1 3 -1 -3 3 3 14 -3 1 -1 -3 -1 3 1 3 3
3 -1 1 15 3 -1 1 -3 -1 -1 1 1 3 1 -1 -3 16 1 3 1 -1 1 3 3 3 -1 -1 3 -1 17 -3 1
1 3 -3 3 -3 -3 3 1 3 -1 18 -3 3 1 1 -3 1 -3 -3 -1 -1 1 -3 19 -1 3 1 3 1 -1 -1
3 -3 -1 -3 -1 20 -1 -3 1 1 1 1 3 1 -1 1 -3 -1 21 -1 3 -1 1 -3 -3 -3 -3 -3 1 -1
-3 22 1 1 -3 -3 -3 -3 -1 3 -3 1 -3 3 23 1 1 -1 -3 -1 -3 1 -1 1 3 -1 1 24 1 1 3
1 3 3 -1 1 -1 -3 -3 1 25 1 -3 3 3 1 3 3 1 -3 -1 -1 3 26 1 3 -3 -3 3 -3 1 -1 -1
3 -1 -3 27 -3 -1 -3 -1 -3 3 1 -1 1 3 -3 -3 28 -1 3 -3 3 -1 3 3 -3 3 3 -1 -1 29
3 -3 -3 -1 -1 -3 -1 3 -3 3 1 -1
* * *
Table 5.5.1.2-2: Definition of for
* * *
0 -1 3 1 -3 3 -1 1 3 -3 3 1 3 -3 3 1 1 -1 1 3 -3 3 -3 -1 -3 1 -3 3 -3 -3 -3 1
-3 -3 3 -1 1 1 1 3 1 -1 3 -3 -3 1 3 1 1 -3 2 3 -1 3 3 1 1 -3 3 3 3 3 1 -1 3 -1
1 1 -1 -3 -1 -1 1 3 3 3 -1 -3 1 1 3 -3 1 1 -3 -1 -1 1 3 1 3 1 -1 3 1 1 -3 -1
-3 -1 4 -1 -1 -1 -3 -3 -1 1 1 3 3 -1 3 -1 1 -1 -3 1 -1 -3 -3 1 -3 -1 -1 5 -3 1
1 3 -1 1 3 1 -3 1 -3 1 1 -1 -1 3 -1 -3 3 -3 -3 -3 1 1 6 1 1 -1 -1 3 -3 -3 3 -3
1 -1 -1 1 -1 1 1 -1 -3 -1 1 -1 3 -1 -3 7 -3 3 3 -1 -1 -3 -1 3 1 3 1 3 1 1 -1 3
1 -1 1 3 -3 -1 -1 1 8 -3 1 3 -3 1 -1 -3 3 -3 3 -1 -1 -1 -1 1 -3 -3 -3 1 -3 -3
-3 1 -3 9 1 1 -3 3 3 -1 -3 -1 3 -3 3 3 3 -1 1 1 -3 1 -1 1 1 -3 1 1 10 -1 1 -3
-3 3 -1 3 -1 -1 -3 -3 -3 -1 -3 -3 1 -1 1 3 3 -1 1 -1 3 11 1 3 3 -3 -3 1 3 1 -1
-3 -3 -3 3 3 -3 3 3 -1 -3 3 -1 1 -3 1 12 1 3 3 1 1 1 -1 -1 1 -3 3 -1 1 1 -3 3
3 -1 -3 3 -3 -1 -3 -1 13 3 -1 -1 -1 -1 -3 -1 3 3 1 -1 1 3 3 3 -1 1 1 -3 1 3 -1
-3 3 14 -3 -3 3 1 3 1 -3 3 1 3 1 1 3 3 -1 -1 -3 1 -3 -1 3 1 1 3 15 -1 -1 1 -3
1 3 -3 1 -1 -3 -1 3 1 3 1 -1 -3 -3 -1 -1 -3 -3 -3 -1 16 -1 -3 3 -1 -1 -1 -1 1
1 -3 3 1 3 3 1 -1 1 -3 1 -3 1 1 -3 -1 17 1 3 -1 3 3 -1 -3 1 -1 -3 3 3 3 -1 1 1
3 -1 -3 -1 3 -1 -1 -1 18 1 1 1 1 1 -1 3 -1 -3 1 1 3 -3 1 -3 -1 1 1 -3 -3 3 1 1
-3 19 1 3 3 1 -1 -3 3 -1 3 3 3 -3 1 -1 1 -1 -3 -1 1 3 -1 3 -3 -3 20 -1 -3 3 -3
-3 -3 -1 -1 -3 -1 -3 3 1 3 -3 -1 3 -1 1 -1 3 -3 1 -1 21 -3 -3 1 1 -1 1 -1 1 -1
3 1 -3 -1 1 -1 1 -1 -1 3 3 -3 -1 1 -3 22 -3 -1 -3 3 1 -1 -3 -1 -3 -3 3 -3 3 -3
-1 1 3 1 -3 1 3 3 -1 -3 23 -1 -1 -1 -1 3 3 3 1 3 3 -3 1 3 -1 3 -1 3 3 -3 3 1
-1 3 3 24 1 -1 3 3 -1 -3 3 -3 -1 -1 3 -1 3 -1 -1 1 1 1 1 -1 -1 -3 -1 3 25 1 -1
1 -1 3 -1 3 1 1 -1 -1 -3 1 1 -3 1 3 -3 1 1 -3 -3 -1 -1 26 -3 -1 1 3 1 1 -3 -1
-1 -3 3 -3 3 1 -3 3 -3 1 -1 1 -3 1 1 1 27 -1 -3 3 3 1 1 3 -1 -3 -1 -1 -1 3 1
-3 -3 -1 3 -3 -1 -3 -1 -3 -1 28 -1 -3 -1 -1 1 -3 -1 -1 1 -1 -3 1 1 -3 1 -3 -3
3 1 1 -1 3 -1 -1 29 1 1 -1 -1 -3 -1 3 -1 3 -1 1 3 1 -1 3 1 3 -3 -3 1 -1 -1 1 3
* * *
#### 5.5.1.3 Group hopping
The sequence-group number in slot is defined by a group hopping pattern and a
sequence-shift pattern according to
There are 17 different hopping patterns and 30 different sequence-shift
patterns. Sequence-group hopping can be enabled or disabled by means of the
cell-specific parameter _Group-hopping-enabled_ provided by higher layers.
Sequence-group hopping for PUSCH can be disabled for a certain UE through the
higher-layer parameter _Disable-sequence-group-hopping_ despite being enabled
on a cell basis unless the PUSCH transmission corresponds to a Random Access
Response Grant or a retransmission of the same transport block as part of the
contention based random access procedure.
The group-hopping pattern may be different for PUSCH, PUCCH and SRS and is
given by
where the pseudo-random sequence is defined by clause 7.2. The pseudo-random
sequence generator shall be initialized with at the beginning of each radio
frame where is given by clause 5.5.1.5.
The sequence-shift pattern definition differs between PUCCH, PUSCH and SRS.
For PUCCH, the sequence-shift pattern is given by where is given by clause
5.5.1.5.
For PUSCH, the sequence-shift pattern is given by , where is configured by
higher layers, if no value for is provided by higher layers or if the PUSCH
transmission corresponds to a Random Access Response Grant or a retransmission
of the same transport block as part of the contention based random access
procedure, otherwise it is given by with given by clause 5.5.1.5.
For SRS, the sequence-shift pattern is given by where is given by clause
5.5.1.5.
#### 5.5.1.4 Sequence hopping
Sequence hopping only applies for reference-signals of length .
For reference-signals of length , the base sequence number within the base
sequence group is given by .
For reference-signals of length , the base sequence number within the base
sequence group in slot is defined by
where the pseudo-random sequence is given by clause 7.2. The parameter
_Sequence-hopping-enabled_ provided by higher layers determines if sequence
hopping is enabled or not. Sequence hopping for PUSCH can be disabled for a
certain UE through the higher-layer parameter _Disable-sequence-group-hopping_
despite being enabled on a cell basis unless the PUSCH transmission
corresponds to a Random Access Response Grant or a retransmission of the same
transport block as part of the contention based random access procedure.
For PUSCH or PUCCH format 4 transmission with â‰¥ 6 RBs, the pseudo-random
sequence generator shall be initialized with at the beginning of each radio
frame where is given by clause 5.5.1.5.
For SRS, the pseudo-random sequence generator shall be initialized with at the
beginning of each radio frame where is given by clause 5.5.1.5 and is given by
clause 5.5.1.3.
#### 5.5.1.5 Determining virtual cell identity for sequence generation
The definition of depends on the type of transmission.
Transmissions associated with PUSCH:
\- if no value for is configured by higher layers or if the PUSCH transmission
corresponds to a Random Access Response Grant or a retransmission of the same
transport block as part of the contention based random access procedure,
\- otherwise.
Transmissions associated with PUCCH:
\- if no value for is configured by higher layers,
\- otherwise.
Sounding reference signals:
\- .
### 5.5.2 Demodulation reference signal
#### 5.5.2.1 Demodulation reference signal for PUSCH
##### 5.5.2.1.1 Reference signal sequence
The PUSCH demodulation reference signal sequence associated with layer is
defined by
where
and
Subclause 5.5.1 defines the sequence . The orthogonal sequence is given by for
DCI format 0 if the higher-layer parameter _Activate-DMRS-with OCC_ is not set
or if the temporary C-RNTI was used to transmit the most recent uplink-related
DCI for the transport block associated with the corresponding PUSCH
transmission, otherwise it is given by Table 5.5.2.1.1-1 using the cyclic
shift field in most recent uplink-related DCI 3GPP TS 36.212 [3] for the
transport block associated with the corresponding PUSCH transmission.
The cyclic shift in a slot is given as with
where the value of _is given by Table 5.5.2.1.1-2 according to the_ parameter
_cyclicShift_ provided by higher layers, for non-BL/CE UEs is given by the
cyclic shift for DMRS field in most recent uplink-related DCI 3GPP TS 36.212
[3] for the transport block associated with the corresponding PUSCH
transmission where the value of is given in Table 5.5.2.1.1-1. For BL/CE UEs,
a cyclic shift field of \'000\' shall be assumed when determining from Table
5.5.2.1.1-1.
The first row of Table 5.5.2.1.1-1 shall be used to obtain and if there is no
uplink-related DCI for the same transport block associated with the
corresponding PUSCH transmission, and
\- if the initial PUSCH for the same transport block is semi-persistently
scheduled, or
\- if the initial PUSCH for the same transport block is scheduled by the
random access response grant.
The quantity is given by
where the pseudo-random sequence is defined by clause 7.2. The application of
is cell-specific. The pseudo-random sequence generator shall be initialized
with at the beginning of each radio frame. The quantity is given by if no
value for is configured by higher layers for PUSCH/PUCCH format 4/PUCCH format
5 or the PUSCH transmission corresponds to a Random Access Response Grant or a
retransmission of the same transport block as part of the contention based
random access procedure, otherwise it is given by .
The vector of reference signals shall be precoded according to
where is the number of antenna ports used for PUSCH transmission.
For PUSCH transmission using a single antenna port, , and .
For spatial multiplexing, or and the precoding matrix shall be identical to
the precoding matrix used in clause 5.3.3A.2 for precoding of the PUSCH in the
same subframe.
Table 5.5.2.1.1-1: Mapping of Cyclic Shift Field in uplink-related DCI format
to and
+-----------+-----------+-----------+----+----+-----------+---+---+---+ | Cyclic | | | | | | | | | | Shift | | | | | | | | | | Field in | | | | | | | | | | | | | | | | | | | | uplin | | | | | | | | | | k-related | | | | | | | | | | DCI | | | | | | | | | | format | | | | | | | | | | [3] | | | | | | | | | +===========+===========+===========+====+====+===========+===+===+===+ | | {wi | | | mage658.w | | | | | | mf){width | dth="0.31 | | | mf){width | | | | | | ="0.35in" | 666666666 | | | ="0.35in" | | | | | | heig | 666665in" | | | heig | | | | | | ht="0.166 | heig | | | ht="0.166 | | | | | | 666666666 | ht="0.166 | | | 666666666 | | | | | | 66666in"} | 666666666 | | | 66666in"} | | | | | | | 66666in"} | | | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 000 | 0 | 6 | 3 | 9 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 001 | 6 | 0 | 9 | 3 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 010 | 3 | 9 | 6 | 0 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 011 | 4 | 10 | 7 | 1 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 100 | 2 | 8 | 5 | 11 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 101 | 8 | 2 | 11 | 5 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 110 | 10 | 4 | 1 | 7 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+ | 111 | 9 | 3 | 0 | 6 | | | | | +-----------+-----------+-----------+----+----+-----------+---+---+---+
Table 5.5.2.1.1-2: Mapping of _cyclicShift_ to values
cyclicShift
* * *
0 0 1 2 2 3 3 4 4 6 5 8 6 9 7 10
##### 5.5.2.1.2 Mapping to physical resources
For each antenna port used for transmission of the PUSCH, the sequence shall
be multiplied with the amplitude scaling factor and mapped in sequence
starting with to the resource blocks.\ The set of physical resource blocks
used in the mapping process and the relation between the index and the antenna
port number shall be identical to the corresponding PUSCH transmission as
defined in clause 5.3.4.\ The mapping to resource elements , with for normal
cyclic prefix and for extended cyclic prefix, in the subframe shall be in
increasing order of first, then the slot number.
#### 5.5.2.2 Demodulation reference signal for PUCCH
##### 5.5.2.2.1 Reference signal sequence
The PUCCH demodulation reference signal sequence for PUCCH formats 1, 1a, 1b,
2, 2a, 2b, and 3 is defined by
where
and is the number of antenna ports used for PUCCH transmission. For PUCCH
formats 2a and 2b, equals for , where is defined in clause 5.4.2. For all
other cases,
The sequence is given by clause 5.5.1 with where the expression for the cyclic
shift is determined by the PUCCH format.
For PUCCH formats 1, 1a and 1b, is given by
where , , and are defined by clause 5.4.1. The number of reference symbols per
slot and the sequence are given by Table 5.5.2.2.1-1 and 5.5.2.2.1-2,
respectively.
For PUCCH formats 2, 2a and 2b, is defined by clause 5.4.2. The number of
reference symbols per slot and the sequence are given by Table 5.5.2.2.1-1 and
5.5.2.2.1-3, respectively.
For PUCCH format 3, is given by
where is given by Table 5.5.2.2.1-4 and and for the first and second slot in a
subframe, respectively, are obtained from clause 5.4.2A. The number of
reference symbols per slot and the sequence are given by Table 5.5.2.2.1-1 and
5.5.2.2.1-3, respectively.
Table 5.5.2.2.1-1: Number of PUCCH demodulation reference symbols per slot
PUCCH format Normal cyclic prefix Extended cyclic prefix
* * *
1, 1a, 1b 3 2 2, 3 2 1 2a, 2b 2 N/A
Table 5.5.2.2.1-2: Orthogonal sequences for PUCCH formats 1, 1a and 1b
Sequence index Normal cyclic prefix Extended cyclic prefix
* * *
0  
1  
2 N/A
Table 5.5.2.2.1-3: Orthogonal sequences for PUCCH formats 2, 2a, 2b and 3.
Normal cyclic prefix Extended cyclic prefix
* * *
Table 5.5.2.2.1-4: Relation between and for PUCCH format 3.
* * *
0 0 0 1 3 3 2 6 6 3 8 9 4 10 N/A
* * *
The PUCCH demodulation reference signal sequence for PUCCH formats 4 and 5 is
defined by
where
and
Subclause 5.5.1 defines the sequence .
The cyclic shift in a slot is given as with
where the values of and are given by Subclause 5.5.2.1.1 and
with obtained as described in clause 5.4.2C.
##### 5.5.2.2.2 Mapping to physical resources
The sequence shall be multiplied with the amplitude scaling factor and mapped
in sequence starting with to resource elements on antenna port . The mapping
shall be in increasing order of first, then and finally the slot number. The
set of values for and the relation between the index and the antenna port
number shall be identical to the values used for the corresponding PUCCH
transmission. The values of the symbol index in a slot are given by Table
5.5.2.2.2-1.
Table 5.5.2.2.2-1: Demodulation reference signal location for different PUCCH
formats.
PUCCH format Set of values for
* * *
                 Normal cyclic prefix   Extended cyclic prefix
1, 1a, 1b 2, 3, 4 2, 3 2, 3 1, 5 3 2a, 2b 1, 5 N/A 4,5 3 2
### 5.5.3 Sounding reference signal
#### 5.5.3.1 Sequence generation
The sounding reference signal sequence is defined by clause 5.5.1, where is
the sequence-group number defined in clause 5.5.1.3 and is the base sequence
number defined in clause 5.5.1.4. The cyclic shift of the sounding reference
signal is given as
,
where is configured separately for periodic and each configuration of
aperiodic sounding by the higher-layer parameters _cyclicShift_ and
_cyclicShift-ap_ , respectively, for each UE and is the number of antenna
ports used for sounding reference signal transmission. The parameter if ,
otherwise . The parameter is given by the higher layer parameter
_transmissionCombNum_ if configured, otherwise .
#### 5.5.3.2 Mapping to physical resources
The sequence shall be multiplied with the amplitude scaling factor in order to
conform to the transmit power specified in clause 5.1.3.1 in 3GPP TS 36.213
[4], and mapped in sequence starting with to resource elements on antenna port
according to
where is the number of antenna ports used for sounding reference signal
transmission and the relation between the index and the antenna port is given
by Table 5.2.1-1. The set of antenna ports used for sounding reference signal
transmission is configured independently for periodic and each configuration
of aperiodic sounding. The quantity is the frequency-domain starting position
of the sounding reference signal and for and is the length of the sounding
reference signal sequence defined as
where is given by Table 5.5.3.2-1 through Table 5.5.3.2-4 for each uplink
bandwidth . The cell-specific parameter _srs-BandwidthConfig,_ and the UE-
specific parameter _srs-Bandwidth,_ are given by higher layers. For UpPTS,
shall be reconfigured to if this reconfiguration is enabled by the cell-
specific parameter _srsMaxUpPts_ given by higher layers, otherwise if the
reconfiguration is disabled ,where is a SRS BW configuration and is the set of
SRS BW configurations from the Tables 5.5.3.2-1 to 5.5.3.2-4 for each uplink
bandwidth , is the number of format 4 PRACH in the addressed UpPTS and derived
from Table 5.7.1-4.
The frequency-domain starting position is defined by
where for normal uplink subframes is defined by
and for UpPTS by
The quantity is given by
where the relation between the index and the antenna port is given by Table
5.2.1-1, is given by the UE-specific parameter _transmissionComb or
transmissionComb-ap for periodic and each configuration of aperiodic
transmission, respectively,_ provided by higher layers for the UE, and is
frequency position index. The variable is equal to 0 for UpPTS in the first
half frame and equal to 1 for UpPTS in the second half frame of a radio frame.
The frequency hopping of the sounding reference signal is configured by the
parameter , provided by higher-layer parameter _srs-HoppingBandwidth._
Frequency hopping is not supported for aperiodic transmission. If frequency
hopping of the sounding reference signal is not enabled (i.e., ), the
frequency position index remains constant (unless re-configured) and is
defined by where the parameter is given by higher-layer parameters
_freqDomainPosition and freqDomainPosition-ap for periodic and each
configuration of aperiodic transmission, respectively_. If frequency hopping
of the sounding reference signal is enabled (i.e., ), the frequency position
indexes are defined by
where is given by Table 5.5.3.2-1 through Table 5.5.3.2-4 for each uplink
bandwidth ,
where regardless of the value on Table 5.5.3.2-1 through Table 5.5.3.2-4, and
counts the number of UE-specific SRS transmissions, where is UE-specific
periodicity of SRS transmission defined in clause 8.2 of 3GPP TS 36.213 [4],
is SRS subframe offset defined in Table 8.2-2 of 3GPP TS 36.213 [4] and is the
maximum value of for a certain configuration of SRS subframe offset.
The sounding reference signal shall be transmitted in the last symbol of the
uplink subframe.
Table 5.5.3.2-1: and , , values for the uplink bandwidth of
SRS bandwidth configuration SRS-Bandwidth SRS-Bandwidth SRS-Bandwidth SRS-
Bandwidth
* * *
0 36 1 12 3 4 3 4 1 1 32 1 16 2 8 2 4 2 2 24 1 4 6 4 1 4 1 3 20 1 4 5 4 1 4 1
4 16 1 4 4 4 1 4 1 5 12 1 4 3 4 1 4 1 6 8 1 4 2 4 1 4 1 7 4 1 4 1 4 1 4 1
Table 5.5.3.2-2: and , , values for the uplink bandwidth of
SRS bandwidth configuration SRS-Bandwidth SRS-Bandwidth SRS-Bandwidth SRS-
Bandwidth
* * *
0 48 1 24 2 12 2 4 3 1 48 1 16 3 8 2 4 2 2 40 1 20 2 4 5 4 1 3 36 1 12 3 4 3 4
1 4 32 1 16 2 8 2 4 2 5 24 1 4 6 4 1 4 1 6 20 1 4 5 4 1 4 1 7 16 1 4 4 4 1 4 1
Table 5.5.3.2-3: and , , values for the uplink bandwidth of
SRS bandwidth configuration SRS-Bandwidth SRS-Bandwidth SRS-Bandwidth SRS-
Bandwidth
* * *
0 72 1 24 3 12 2 4 3 1 64 1 32 2 16 2 4 4 2 60 1 20 3 4 5 4 1 3 48 1 24 2 12 2
4 3 4 48 1 16 3 8 2 4 2 5 40 1 20 2 4 5 4 1 6 36 1 12 3 4 3 4 1 7 32 1 16 2 8
2 4 2
Table 5.5.3.2-4: and, , values for the uplink bandwidth of
SRS bandwidth configuration SRS-Bandwidth SRS-Bandwidth SRS-Bandwidth SRS-
Bandwidth
* * *
0 96 1 48 2 24 2 4 6 1 96 1 32 3 16 2 4 4 2 80 1 40 2 20 2 4 5 3 72 1 24 3 12
2 4 3 4 64 1 32 2 16 2 4 4 5 60 1 20 3 4 5 4 1 6 48 1 24 2 12 2 4 3 7 48 1 16
3 8 2 4 2
#### 5.5.3.3 Sounding reference signal subframe configuration
The cell-specific subframe configuration period and the cell-specific subframe
offset for the transmission of sounding reference signals are listed in Tables
5.5.3.3-1 and 5.5.3.3-2, for frame structures type 1 and 2 respectively, where
the parameter _srs-SubframeConfig_ is provided by higher layers. Sounding
reference signal subframes are the subframes satisfying. For frame structure
type 2, a sounding reference signal is transmitted only in uplink subframes or
UpPTS.
Table 5.5.3.3-1: Frame structure type 1 sounding reference signal subframe
configuration
+--------------------+--------+----------------------+---------------------+ | srs-SubframeConfig | Binary | Configuration Period | Transmission offset | | | | | | | | | (subframes) | (subframes) | +====================+========+======================+=====================+ | 0 | 0000 | 1 | {0} | +--------------------+--------+----------------------+---------------------+ | 1 | 0001 | 2 | {0} | +--------------------+--------+----------------------+---------------------+ | 2 | 0010 | 2 | {1} | +--------------------+--------+----------------------+---------------------+ | 3 | 0011 | 5 | {0} | +--------------------+--------+----------------------+---------------------+ | 4 | 0100 | 5 | {1} | +--------------------+--------+----------------------+---------------------+ | 5 | 0101 | 5 | {2} | +--------------------+--------+----------------------+---------------------+ | 6 | 0110 | 5 | {3} | +--------------------+--------+----------------------+---------------------+ | 7 | 0111 | 5 | {0,1} | +--------------------+--------+----------------------+---------------------+ | 8 | 1000 | 5 | {2,3} | +--------------------+--------+----------------------+---------------------+ | 9 | 1001 | 10 | {0} | +--------------------+--------+----------------------+---------------------+ | 10 | 1010 | 10 | {1} | +--------------------+--------+----------------------+---------------------+ | 11 | 1011 | 10 | {2} | +--------------------+--------+----------------------+---------------------+ | 12 | 1100 | 10 | {3} | +--------------------+--------+----------------------+---------------------+ | 13 | 1101 | 10 | {0,1,2,3,4,6,8} | +--------------------+--------+----------------------+---------------------+ | 14 | 1110 | 10 | {0,1,2,3,4,5,6,8} | +--------------------+--------+----------------------+---------------------+ | 15 | 1111 | reserved | reserved | +--------------------+--------+----------------------+---------------------+
Table 5.5.3.3-2: Frame structure type 2 sounding reference signal subframe
configuration
+--------------------+--------+----------------------+---------------------+ | srs-SubframeConfig | Binary | Configuration Period | Transmission offset | | | | | | | | | (subframes) | (subframes) | +====================+========+======================+=====================+ | 0 | 0000 | 5 | {1} | +--------------------+--------+----------------------+---------------------+ | 1 | 0001 | 5 | {1, 2} | +--------------------+--------+----------------------+---------------------+ | 2 | 0010 | 5 | {1, 3} | +--------------------+--------+----------------------+---------------------+ | 3 | 0011 | 5 | {1, 4} | +--------------------+--------+----------------------+---------------------+ | 4 | 0100 | 5 | {1, 2, 3} | +--------------------+--------+----------------------+---------------------+ | 5 | 0101 | 5 | {1, 2, 4} | +--------------------+--------+----------------------+---------------------+ | 6 | 0110 | 5 | {1, 3, 4} | +--------------------+--------+----------------------+---------------------+ | 7 | 0111 | 5 | {1, 2, 3, 4} | +--------------------+--------+----------------------+---------------------+ | 8 | 1000 | 10 | {1, 2, 6} | +--------------------+--------+----------------------+---------------------+ | 9 | 1001 | 10 | {1, 3, 6} | +--------------------+--------+----------------------+---------------------+ | 10 | 1010 | 10 | {1, 6, 7} | +--------------------+--------+----------------------+---------------------+ | 11 | 1011 | 10 | {1, 2, 6, 8} | +--------------------+--------+----------------------+---------------------+ | 12 | 1100 | 10 | {1, 3, 6, 9} | +--------------------+--------+----------------------+---------------------+ | 13 | 1101 | 10 | {1, 4, 6, 7} | +--------------------+--------+----------------------+---------------------+ | 14 | 1110 | reserved | reserved | +--------------------+--------+----------------------+---------------------+ | 15 | 1111 | reserved | reserved | +--------------------+--------+----------------------+---------------------+
## 5.6 SC-FDMA baseband signal generation
This clause applies to all uplink physical signals and uplink physical
channels except the physical random access channel.
The time-continuous signal for antenna port in SC-FDMA symbol in an uplink
slot is defined by
for where , , and is the content of resource element on antenna port .
The SC-FDMA symbols in a slot shall be transmitted in increasing order of ,
starting with , where SC-FDMA symbol starts at time within the slot.
Table 5.6-1 lists the values of that shall be used.
Table 5.6-1: SC-FDMA parameters
Configuration Cyclic prefix length
* * *
Normal cyclic prefix  
Extended cyclic prefix
## 5.7 Physical random access channel
### 5.7.1 Time and frequency structure
The physical layer random access preamble, illustrated in Figure 5.7.1-1,
consists of a cyclic prefix of length and a sequence part of length. The
parameter values are listed in Table 5.7.1-1 and depend on the frame structure
and the random access configuration. Higher layers control the preamble
format.
Figure 5.7.1-1: Random access preamble format
Table 5.7.1-1: Random access preamble parameters
Preamble format
* * *
0  
1  
2  
3  
4 (see Note)  
NOTE: Frame structure type 2 and special subframe configurations with UpPTS
lengths and only assuming that the number of additional SC-FDMA symbols in
UpPTS X in Table 4.2-1 is 0.
The transmission of a random access preamble, if triggered by the MAC layer,
is restricted to certain time and frequency resources. These resources are
enumerated in increasing order of the subframe number within the radio frame
and the physical resource blocks in the frequency domain such that index 0
correspond to the lowest numbered physical resource block and subframe within
the radio frame. PRACH resources within the radio frame are indicated by a
PRACH configuration index, where the indexing is in the order of appearance in
Table 5.7.1-2 and Table 5.7.1-4.
For non-BL/CE UEs there is a single PRACH configuration with given by the
higher-layer parameter _prach-FrequencyOffset._
For BL/CE UEs, for each PRACH coverage enhancement level, there is a PRACH
configuration configured by higher layers with a PRACH configuration index
_(prach-ConfigurationIndex), a PRACH frequency offset_ (_prach-
FrequencyOffset_), a number of PRACH repetitions per attempt
(_numRepetitionPerPreambleAttempt_) _and optionally_ a PRACH starting subframe
periodicity (_prach-StartingSubframe_). PRACH of preamble format 0-3 is
transmitted times, whereas PRACH of preamble format 4 is transmitted one time
only.
_For BL/CE UEs and for each_ PRACH coverage enhancement level _, if frequency
hopping is enabled for a PRACH configuration by the higher-layer parameter
prach-HoppingConfig_ , _t_ he value of the parameter depends on the SFN and
the PRACH configuration index and is given by
\- In case the PRACH configuration index is such that a PRACH resource occurs
in every radio frame when calculated as below from Table 5.7.1-2 or Table
5.7.1-4,
\- otherwise
where is the system frame number corresponding to the first subframe for each
PRACH repetition, corresponds to a cell-specific higher-layer parameter
_prach-HoppingOffset_. If frequency hopping is not enabled for the PRACH
configuration then _._
For frame structure type 1 with preamble format 0-3, for each of the PRACH
configurations there is at most one random access resource per subframe.\
Table 5.7.1-2 lists the preamble formats according to Table 5.7.1-1 and the
subframes in which random access preamble transmission is allowed for a given
configuration in frame structure type 1. The start of the random access
preamble shall be aligned with the start of the corresponding uplink subframe
at the UE assuming , where is defined in clause 8.1. For PRACH configurations
0, 1, 2, 15, 16, 17, 18, 31, 32, 33, 34, 47, 48, 49, 50 and 63 the UE may for
handover purposes assume an absolute value of the relative time difference
between radio frame in the current cell and the target cell of less than .\
The first physical resource block allocated to the PRACH opportunity
considered for preamble formats 0, 1, 2 and 3 is defined as .
Table 5.7.1-2: Frame structure type 1 random access configuration for preamble
formats 0-3
+-------+-------+-------+-------+-------+-------+-------+-------+ | PRACH | Prea | S | Sub | PRACH | Prea | S | Sub | | Con | mble\ | ystem | frame | Con | mble\ | ystem | frame | | figur | F | frame | n | figur | F | frame | n | | ation | ormat | n | umber | ation | ormat | n | umber | | | | umber | | | | umber | | | Index | | | | Index | | | | +=======+=======+=======+=======+=======+=======+=======+=======+ | 0 | 0 | Even | 1 | 32 | 2 | Even | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | 0 | Even | 4 | 33 | 2 | Even | 4 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | 0 | Even | 7 | 34 | 2 | Even | 7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | 0 | Any | 1 | 35 | 2 | Any | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | 0 | Any | 4 | 36 | 2 | Any | 4 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 0 | Any | 7 | 37 | 2 | Any | 7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | 0 | Any | 1, 6 | 38 | 2 | Any | 1, 6 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | 0 | Any | 2 ,7 | 39 | 2 | Any | 2 ,7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 0 | Any | 3, 8 | 40 | 2 | Any | 3, 8 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | 0 | Any | 1, 4, | 41 | 2 | Any | 1, 4, | | | | | 7 | | | | 7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | 0 | Any | 2, 5, | 42 | 2 | Any | 2, 5, | | | | | 8 | | | | 8 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | 0 | Any | 3, 6, | 43 | 2 | Any | 3, 6, | | | | | 9 | | | | 9 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | 0 | Any | 0, 2, | 44 | 2 | Any | 0, 2, | | | | | 4, 6, | | | | 4, 6, | | | | | 8 | | | | 8 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | 0 | Any | 1, 3, | 45 | 2 | Any | 1, 3, | | | | | 5, 7, | | | | 5, 7, | | | | | 9 | | | | 9 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | 0 | Any | 0, 1, | 46 | N/A | N/A | N/A | | | | | 2, 3, | | | | | | | | | 4, 5, | | | | | | | | | 6, 7, | | | | | | | | | 8, 9 | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | 0 | Even | 9 | 47 | 2 | Even | 9 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | 1 | Even | 1 | 48 | 3 | Even | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | 1 | Even | 4 | 49 | 3 | Even | 4 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | 1 | Even | 7 | 50 | 3 | Even | 7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | 1 | Any | 1 | 51 | 3 | Any | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | 1 | Any | 4 | 52 | 3 | Any | 4 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 21 | 1 | Any | 7 | 53 | 3 | Any | 7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 22 | 1 | Any | 1, 6 | 54 | 3 | Any | 1, 6 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 23 | 1 | Any | 2 ,7 | 55 | 3 | Any | 2 ,7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 24 | 1 | Any | 3, 8 | 56 | 3 | Any | 3, 8 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 25 | 1 | Any | 1, 4, | 57 | 3 | Any | 1, 4, | | | | | 7 | | | | 7 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 26 | 1 | Any | 2, 5, | 58 | 3 | Any | 2, 5, | | | | | 8 | | | | 8 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 27 | 1 | Any | 3, 6, | 59 | 3 | Any | 3, 6, | | | | | 9 | | | | 9 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 28 | 1 | Any | 0, 2, | 60 | N/A | N/A | N/A | | | | | 4, 6, | | | | | | | | | 8 | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29 | 1 | Any | 1, 3, | 61 | N/A | N/A | N/A | | | | | 5, 7, | | | | | | | | | 9 | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 30 | N/A | N/A | N/A | 62 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 31 | 1 | Even | 9 | 63 | 3 | Even | 9 | +-------+-------+-------+-------+-------+-------+-------+-------+
For frame structure type 2 with preamble formats 0-4, for each of the PRACH
configurations there might be multiple random access resources in an UL
subframe (or UpPTS for preamble format 4) depending on the UL/DL configuration
[see table 4.2-2]. Table 5.7.1-3 lists PRACH configurations allowed for frame
structure type 2 where the configuration index corresponds to a certain
combination of preamble format, PRACH density value, and version index, .\ For
frame structure type 2 with PRACH configuration indices 0, 1, 2, 20, 21, 22,
30, 31, 32, 40, 41, 42, 48, 49, 50, or with PRACH configuration indices 51,
53, 54, 55, 56, 57 in UL/DL configuration 3, 4, 5, [ ]{.underline} the UE may
for handover purposes assume an absolute value of the relative time difference
between radio frame in the current cell and the target cell is less than .
Table 5.7.1-3: Frame structure type 2 random access configurations for
preamble formats 0-4
+-------+-------+-------+-------+-------+-------+-------+-------+ | P | Prea | De | Ve | P | Prea | De | Ve | | RACH\ | mble\ | nsity | rsion | RACH\ | mble\ | nsity | rsion | | con | F | | | con | F | | | | figur | ormat | Per | | figur | ormat | Per | | | ation | | 10 ms | | ation | | 10 ms | | | | | | | | | | | | Index | | | | Index | | | | +=======+=======+=======+=======+=======+=======+=======+=======+ | 0 | 0 | 0.5 | 0 | 32 | 2 | 0.5 | 2 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | 0 | 0.5 | 1 | 33 | 2 | 1 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | 0 | 0.5 | 2 | 34 | 2 | 1 | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | 0 | 1 | 0 | 35 | 2 | 2 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | 0 | 1 | 1 | 36 | 2 | 3 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 0 | 1 | 2 | 37 | 2 | 4 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | 0 | 2 | 0 | 38 | 2 | 5 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | 0 | 2 | 1 | 39 | 2 | 6 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 0 | 2 | 2 | 40 | 3 | 0.5 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | 0 | 3 | 0 | 41 | 3 | 0.5 | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | 0 | 3 | 1 | 42 | 3 | 0.5 | 2 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | 0 | 3 | 2 | 43 | 3 | 1 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | 0 | 4 | 0 | 44 | 3 | 1 | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | 0 | 4 | 1 | 45 | 3 | 2 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | 0 | 4 | 2 | 46 | 3 | 3 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | 0 | 5 | 0 | 47 | 3 | 4 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | 0 | 5 | 1 | 48 | 4 | 0.5 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | 0 | 5 | 2 | 49 | 4 | 0.5 | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | 0 | 6 | 0 | 50 | 4 | 0.5 | 2 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | 0 | 6 | 1 | 51 | 4 | 1 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | 1 | 0.5 | 0 | 52 | 4 | 1 | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 21 | 1 | 0.5 | 1 | 53 | 4 | 2 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 22 | 1 | 0.5 | 2 | 54 | 4 | 3 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 23 | 1 | 1 | 0 | 55 | 4 | 4 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 24 | 1 | 1 | 1 | 56 | 4 | 5 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 25 | 1 | 2 | 0 | 57 | 4 | 6 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 26 | 1 | 3 | 0 | 58 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 27 | 1 | 4 | 0 | 59 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 28 | 1 | 5 | 0 | 60 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29 | 1 | 6 | 0 | 61 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 30 | 2 | 0.5 | 0 | 62 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 31 | 2 | 0.5 | 1 | 63 | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+
Table 5.7.1-4 lists the mapping to physical resources for the different random
access opportunities needed for a certain PRACH density value, . Each
quadruple of the format indicates the location of a specific random access
resource, where is a frequency resource index within the considered time
instance, indicates whether the resource is reoccurring in all radio frames,
in even radio frames, or in odd radio frames, respectively, indicates whether
the random access resource is located in first half frame or in second half
frame, respectively, and where is the uplink subframe number where the
preamble starts, counting from 0 at the first uplink subframe between 2
consecutive downlink-to-uplink switch points, with the exception of preamble
format 4 where is denoted as (*). The start of the random access preamble
formats 0-3 shall be aligned with the start of the corresponding uplink
subframe at the UE assuming and the random access preamble format 4 shall
start before the end of the UpPTS at the UE, where the UpPTS is referenced to
the UE\'s uplink frame timing assuming.
The random access opportunities for each PRACH configuration shall be
allocated in time first and then in frequency if and only if time multiplexing
is not sufficient to hold all opportunities of a PRACH configuration needed
for a certain density value without overlap in time. For preamble format 0-3,
the frequency multiplexing shall be done according to
where is the number of uplink resource blocks, is the first physical resource
block allocated to the PRACH opportunity considered and where is the first
physical resource block available for PRACH.
For preamble format 4, the frequency multiplexing shall be done according to
whereis the system frame number and whereis the number of DL to UL switch
points within the radio frame.
_For BL/CE UEs, only a subset of the subframes allowed for preamble
transmission are allowed as starting subframes for the_ repetitions. The
allowed starting subframes for a PRACH configuration are determined as
follows:
\- Enumerate the subframes that are allowed for preamble transmission for the
PRACH configuration as where and correspond to the two subframes allowed for
preamble transmission with the smallest and the largest absolute subframe
number , respectively.
\- If a PRACH starting subframe periodicity is not provided by higher layers,
the periodicity of the allowed starting subframes in terms of subframes
allowed for preamble transmission is . The allowed starting subframes defined
over are given by where
\- If a PRACH starting subframe periodicity is provided by higher layers, it
indicates the periodicity of the allowed starting subframes in terms of
subframes allowed for preamble transmission. The allowed starting subframes
defined over are given by where
\- No starting subframe defined over such that is allowed.
Each random access preamble occupies a bandwidth corresponding to 6
consecutive resource blocks for both frame structures.
Table 5.7.1-4: Frame structure type 2 random access preamble mapping in time
and frequency
+-------+-------+-------+-------+-------+-------+-------+-------+ | PRACH | UL/DL | | | | | | | | | con | | | | | | | | con | figur | | | | | | | | figur | ation | | | | | | | | ation | (See | | | | | | | | Index | Table | | | | | | | | | 4 | | | | | | | | (See | .2-2) | | | | | | | | Table | | | | | | | | | 5.7 | | | | | | | | | .1-3) | | | | | | | | +=======+=======+=======+=======+=======+=======+=======+=======+ | | 0 | 1 | 2 | 3 | 4 | 5 | 6 | +-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | (0,1 | (0,1 | (0,1 | (0,1 | (0,1 | (0,1 | (0,1 | | | ,0,2) | ,0,1) | ,0,0) | ,0,2) | ,0,1) | ,0,0) | ,0,2) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | (0,2 | (0,2 | (0,2 | (0,2 | (0,2 | (0,2 | (0,2 | | | ,0,2) | ,0,1) | ,0,0) | ,0,2) | ,0,1) | ,0,0) | ,0,2) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | (0,1 | (0,1 | (0,1 | (0,1 | (0,1 | N/A | (0,1 | | | ,1,2) | ,1,1) | ,1,0) | ,0,1) | ,0,0) | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | ,0,2) | ,0,1) | ,0,0) | ,0,2) | ,0,1) | ,0,0) | ,0,2) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | N/A | (0,0 | | | ,1,2) | ,1,1) | ,1,0) | ,0,1) | ,0,0) | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | (0,0 | (0,0 | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,1) | ,0,0) | | ,0,0) | | | ,0,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | ,0,2) | ,0,1) | ,0,0) | ,0,1) | ,0,0) | ,0,0) | ,0,2) | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (1,0 | (0,0 | | | ,1,2) | ,1,1) | ,1,0) | ,0,2) | ,0,1) | ,0,0) | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | (0,0 | (0,0 | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,1) | ,0,0) | | ,0,0) | | | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | | (0,0 | | | (0,0 | | | ,1,1) | ,1,0) | | ,0,2) | | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (0,0 | | | (0,0 | | | (0,0 | | | ,1,0) | | | ,0,1) | | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | ,0,1) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (1,0 | (0,0 | | | ,0,2) | ,0,1) | ,1,0) | ,0,1) | ,0,1) | ,0,0) | ,0,2) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (0,0 | (1,0 | (2,0 | (0,0 | | | ,1,2) | ,1,1) | ,0,0) | ,0,2) | ,0,1) | ,0,0) | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | (0,0 | (0,0 | (0,0 | N/A | (0,0 | N/A | (0,0 | | | ,0,0) | ,0,1) | ,0,0) | | ,0,0) | | ,0,0) | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | | (0,0 | | (0,0 | | | ,1,0) | ,1,0) | ,1,0) | | ,0,1) | | ,0,2) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | | (1,0 | | (0,0 | | | ,1,1) | ,1,1) | ,1,0) | | ,0,0) | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | N/A | (0,0 | N/A | N/A | N/A | N/A | (0,0 | | | | ,0,0) | | | | | ,0,1) | | | | | | | | | | | | | (0,0 | | | | | (0,0 | | | | ,0,1) | | | | | ,1,0) | | | | | | | | | | | | | (0,0 | | | | | (0,0 | | | | ,1,0) | | | | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | ,0,1) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (1,0 | (0,0 | | | ,0,2) | ,0,1) | ,1,0) | ,0,1) | ,0,1) | ,0,0) | ,0,2) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (0,0 | (1,0 | (2,0 | (0,0 | | | ,1,1) | ,1,0) | ,0,0) | ,0,2) | ,0,0) | ,0,0) | ,1,0) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (1,0 | (1,0 | (3,0 | (0,0 | | | ,1,2) | ,1,1) | ,1,0) | ,0,2) | ,0,1) | ,0,0) | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (0,0 | | | (0,0 | | | (0,0 | | | ,0,2) | | | ,0,1) | | | ,0,1) | | | | | | | | | | | | (0,0 | | | (0,0 | | | (0,0 | | | ,1,0) | | | ,0,2) | | | ,0,2) | | | | | | | | | | | | (0,0 | | | (1,0 | | | (0,0 | | | ,1,2) | | | ,0,1) | | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (0,0 | | | (0,0 | | | (0,0 | | | ,0,1) | | | ,0,1) | | | ,0,2) | | | | | | | | | | | | (0,0 | | | (0,0 | | | (0,0 | | | ,1,0) | | | ,0,2) | | | ,1,0) | | | | | | | | | | | | (0,0 | | | (1,0 | | | (0,0 | | | ,1,1) | | | ,0,0) | | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (1,0 | (0,0 | | | ,0,1) | ,0,1) | ,1,0) | ,0,1) | ,0,1) | ,0,0) | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (0,0 | (1,0 | (2,0 | (0,0 | | | ,0,2) | ,1,0) | ,0,0) | ,0,2) | ,0,0) | ,0,0) | ,0,2) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (1,0 | (1,0 | (3,0 | (0,0 | | | ,1,1) | ,1,1) | ,1,0) | ,0,1) | ,0,1) | ,0,0) | ,1,0) | | | | | | | | | | | | (0,0 | (1,0 | (2,0 | (1,0 | (2,0 | (4,0 | (0,0 | | | ,1,2) | ,0,1) | ,0,0) | ,0,2) | ,0,1) | ,0,0) | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | N/A | N/A | | | ,0,1) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | | | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | | | ,0,2) | ,0,1) | ,1,0) | ,0,1) | ,0,1) | | | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (0,0 | (1,0 | | | | | ,1,0) | ,1,0) | ,0,0) | ,0,2) | ,0,0) | | | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (1,0 | (1,0 | | | | | ,1,1) | ,1,1) | ,1,0) | ,0,0) | ,0,1) | | | | | | | | | | | | | | (0,0 | (1,0 | (2,0 | (1,0 | (2,0 | | | | | ,1,2) | ,1,1) | ,1,0) | ,0,2) | ,0,0) | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | (0,0 | (0,0 | N/A | (0,0 | N/A | N/A | N/A | | | ,0,0) | ,0,0) | | ,0,0) | | | | | | | | | | | | | | | (0,0 | (0,0 | | (0,0 | | | | | | ,0,1) | ,0,1) | | ,0,1) | | | | | | | | | | | | | | | (0,0 | (0,0 | | (0,0 | | | | | | ,0,2) | ,1,0) | | ,0,2) | | | | | | | | | | | | | | | (0,0 | (0,0 | | (1,0 | | | | | | ,1,0) | ,1,1) | | ,0,0) | | | | | | | | | | | | | | | (0,0 | (1,0 | | (1,0 | | | | | | ,1,2) | ,0,0) | | ,0,1) | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | | | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | ,0,0) | | | | | | | | | | | | (0,0 | (0,0 | (0,0 | (0,0 | (0,0 | (1,0 | (0,0 | | | ,0,1) | ,0,1) | ,1,0) | ,0,1) | ,0,1) | ,0,0) | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (0,0 | (1,0 | (2,0 | (0,0 | | | ,0,2) | ,1,0) | ,0,0) | ,0,2) | ,0,0) | ,0,0) | ,0,2) | | | | | | | | | | | | (0,0 | (0,0 | (1,0 | (1,0 | (1,0 | (3,0 | (0,0 | | | ,1,0) | ,1,1) | ,1,0) | ,0,0) | ,0,1) | ,0,0) | ,1,0) | | | | | | | | | | | | (0,0 | (1,0 | (2,0 | (1,0 | (2,0 | (4,0 | (0,0 | | | ,1,1) | ,0,1) | ,0,0) | ,0,1) | ,0,0) | ,0,0) | ,1,1) | | | | | | | | | | | | (0,0 | (1,0 | (2,0 | (1,0 | (2,0 | (5,0 | (1,0 | | | ,1,2) | ,1,1) | ,1,0) | ,0,2) | ,0,1) | ,0,0) | ,0,2) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | N/A | (0,0 | N/A | N/A | N/A | N/A | (0,0 | | | | ,0,0) | | | | | ,0,0) | | | | | | | | | | | | | (0,0 | | | | | (0,0 | | | | ,0,1) | | | | | ,0,1) | | | | | | | | | | | | | (0,0 | | | | | (0,0 | | | | ,1,0) | | | | | ,0,2) | | | | | | | | | | | | | (0,0 | | | | | (0,0 | | | | ,1,1) | | | | | ,1,0) | | | | | | | | | | | | | (1,0 | | | | | (0,0 | | | | ,0,0) | | | | | ,1,1) | | | | | | | | | | | | | (1,0 | | | | | (1,0 | | | | ,1,0) | | | | | ,1,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 / | (0,1 | (0,1 | N/A | (0,1 | (0,1 | N/A | (0,1 | | 30 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 21 / | (0,2 | (0,2 | N/A | (0,2 | (0,2 | N/A | (0,2 | | 31 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 22 / | (0,1 | (0,1 | N/A | N/A | N/A | N/A | (0,1 | | 32 | ,1,1) | ,1,0) | | | | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 23 / | (0,0 | (0,0 | N/A | (0,0 | (0,0 | N/A | (0,0 | | 33 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 24 / | (0,0 | (0,0 | N/A | N/A | N/A | N/A | (0,0 | | 34 | ,1,1) | ,1,0) | | | | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 25 / | (0,0 | (0,0 | N/A | (0,0 | (0,0 | N/A | (0,0 | | 35 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | | (1,0 | (1,0 | | (0,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 26 / | (0,0 | (0,0 | N/A | (0,0 | (0,0 | N/A | (0,0 | | 36 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | | (1,0 | (1,0 | | (0,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | | | | | | | | | | | | (1,0 | (1,0 | | (2,0 | (2,0 | | (1,0 | | | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 27 / | (0,0 | (0,0 | N/A | (0,0 | (0,0 | N/A | (0,0 | | 37 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | | (1,0 | (1,0 | | (0,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | | | | | | | | | | | | (1,0 | (1,0 | | (2,0 | (2,0 | | (1,0 | | | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (1,0 | (1,0 | | (3,0 | (3,0 | | (1,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 28 / | (0,0 | (0,0 | N/A | (0,0 | (0,0 | N/A | (0,0 | | 38 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | | (1,0 | (1,0 | | (0,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | | | | | | | | | | | | (1,0 | (1,0 | | (2,0 | (2,0 | | (1,0 | | | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (1,0 | (1,0 | | (3,0 | (3,0 | | (1,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | | | | | | | | | | | | (2,0 | (2,0 | | (4,0 | (4,0 | | (2,0 | | | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29 | (0,0 | (0,0 | N/A | (0,0 | (0,0 | N/A | (0,0 | | /39 | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (0,0 | (0,0 | | (1,0 | (1,0 | | (0,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | | | | | | | | | | | | (1,0 | (1,0 | | (2,0 | (2,0 | | (1,0 | | | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (1,0 | (1,0 | | (3,0 | (3,0 | | (1,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | | | | | | | | | | | | (2,0 | (2,0 | | (4,0 | (4,0 | | (2,0 | | | ,0,1) | ,0,0) | | ,0,1) | ,0,0) | | ,0,1) | | | | | | | | | | | | (2,0 | (2,0 | | (5,0 | (5,0 | | (2,0 | | | ,1,1) | ,1,0) | | ,0,1) | ,0,0) | | ,1,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 40 | (0,1 | N/A | N/A | (0,1 | N/A | N/A | (0,1 | | | ,0,0) | | | ,0,0) | | | ,0,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 41 | (0,2 | N/A | N/A | (0,2 | N/A | N/A | (0,2 | | | ,0,0) | | | ,0,0) | | | ,0,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 42 | (0,1 | N/A | N/A | N/A | N/A | N/A | N/A | | | ,1,0) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 43 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 44 | (0,0 | N/A | N/A | N/A | N/A | N/A | N/A | | | ,1,0) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 45 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (0,0 | | | (1,0 | | | (1,0 | | | ,1,0) | | | ,0,0) | | | ,0,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 46 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (0,0 | | | (1,0 | | | (1,0 | | | ,1,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (1,0 | | | (2,0 | | | (2,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 47 | (0,0 | N/A | N/A | (0,0 | N/A | N/A | (0,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (0,0 | | | (1,0 | | | (1,0 | | | ,1,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (1,0 | | | (2,0 | | | (2,0 | | | ,0,0) | | | ,0,0) | | | ,0,0) | | | | | | | | | | | | (1,0 | | | (3,0 | | | (3,0 | | | ,1,0) | | | ,0,0) | | | ,0,0) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 48 | (0,1, | (0,1, | (0,1, | (0,1, | (0,1, | (0,1, | (0,1, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 49 | (0,2, | (0,2, | (0,2, | (0,2, | (0,2, | (0,2, | (0,2, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 50 | (0,1, | (0,1, | (0,1, | N/A | N/A | N/A | (0,1, | | | 1,*) | 1,*) | 1,*) | | | | 1,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 51 | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 52 | (0,0, | (0,0, | (0,0, | N/A | N/A | N/A | (0,0, | | | 1,*) | 1,*) | 1,*) | | | | 1,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 53 | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (0,0, | (0,0, | (0,0, | (1,0, | (1,0, | (1,0, | (0,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 54 | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (0,0, | (0,0, | (0,0, | (1,0, | (1,0, | (1,0, | (0,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (2,0, | (2,0, | (2,0, | (1,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 55 | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (0,0, | (0,0, | (0,0, | (1,0, | (1,0, | (1,0, | (0,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (2,0, | (2,0, | (2,0, | (1,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (3,0, | (3,0, | (3,0, | (1,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 56 | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (0,0, | (0,0, | (0,0, | (1,0, | (1,0, | (1,0, | (0,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (2,0, | (2,0, | (2,0, | (1,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (3,0, | (3,0, | (3,0, | (1,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | | | | | | | | | | | | (2,0, | (2,0, | (2,0, | (4,0, | (4,0, | (4,0, | (2,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 57 | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | (0,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (0,0, | (0,0, | (0,0, | (1,0, | (1,0, | (1,0, | (0,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (2,0, | (2,0, | (2,0, | (1,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (1,0, | (1,0, | (1,0, | (3,0, | (3,0, | (3,0, | (1,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | | | | | | | | | | | | (2,0, | (2,0, | (2,0, | (4,0, | (4,0, | (4,0, | (2,0, | | | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | 0,*) | | | | | | | | | | | | (2,0, | (2,0, | (2,0, | (5,0, | (5,0, | (5,0, | (2,0, | | | 1,*) | 1,*) | 1,*) | 0,*) | 0,*) | 0,*) | 1,*) | +-------+-------+-------+-------+-------+-------+-------+-------+ | 58 | N/A | N/A | N/A | N/A | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 59 | N/A | N/A | N/A | N/A | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 60 | N/A | N/A | N/A | N/A | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 61 | N/A | N/A | N/A | N/A | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 62 | N/A | N/A | N/A | N/A | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | 63 | N/A | N/A | N/A | N/A | N/A | N/A | N/A | +-------+-------+-------+-------+-------+-------+-------+-------+ | NOTE: | | | | | | | | | * | | | | | | | | | UpPTS | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+
### 5.7.2 Preamble sequence generation
The random access preambles are generated from Zadoff-Chu sequences with zero
correlation zone, generated from one or several root Zadoff-Chu sequences. The
network configures the set of preamble sequences the UE is allowed to use.
There are 64 preambles available in each cell. The set of 64 preamble
sequences in a cell is found by including first, in the order of increasing
cyclic shift, all the available cyclic shifts of a root Zadoff-Chu sequence
with the logical index RACH_ROOT_SEQUENCE, where RACH_ROOT_SEQUENCE is
broadcasted as part of the System Information. Additional preamble sequences,
in case 64 preambles cannot be generated from a single root Zadoff-Chu
sequence, are obtained from the root sequences with the consecutive logical
indexes until all the 64 sequences are found.\ The logical root sequence order
is cyclic: the logical index 0 is consecutive to 837. The relation between a
logical root sequence index and physical root sequence index is given by
Tables 5.7.2-4 and 5.7.2-5 for preamble formats 0 -- 3 and 4, respectively.
The root Zadoff-Chu sequence is defined by
where the length of the Zadoff-Chu sequence is given by Table 5.7.2-1. From
the root Zadoff-Chu sequence, random access preambles with zero correlation
zones of length are defined by cyclic shifts according to
where the cyclic shift is given by
and is given by Tables 5.7.2-2 and 5.7.2-3 for preamble formats 0-3 and 4,
respectively, where the parameter _zeroCorrelationZoneConfig_ is provided by
higher layers. The parameter _High-speed-flag_ provided by higher layers
determines if unrestricted set or restricted set shall be used.
The variable is the cyclic shift corresponding to a Doppler shift of magnitude
and is given by
where is the smallest non-negative integer that fulfils . The parameters for
restricted sets of cyclic shifts depend on . For, the parameters are given by
For, the parameters are given by
For all other values of , there are no cyclic shifts in the restricted set.
Table 5.7.2-1: Random access preamble sequence length
Preamble format
* * *
0 -- 3 839 4 139
Table 5.7.2-2: for preamble generation (preamble formats 0-3)
_zeroCorrelationZoneConfig_ value
* * *
                                Unrestricted set   Restricted set
0 0 15 1 13 18 2 15 22 3 18 26 4 22 32 5 26 38 6 32 46 7 38 55 8 46 68 9 59 82
10 76 100 11 93 128 12 119 158 13 167 202 14 279 237 15 419 -
Table 5.7.2-3: for preamble generation (preamble format 4)
_zeroCorrelationZoneConfig_ value
* * *
0 2 1 4 2 6 3 8 4 10 5 12 6 15 7 N/A 8 N/A 9 N/A 10 N/A 11 N/A 12 N/A 13 N/A
14 N/A 15 N/A
Table 5.7.2-4: Root Zadoff-Chu sequence order for preamble formats 0 -- 3
+------------------------------+--------------------------------------+ | Logical root sequence number | Physical root sequence number | | | | | | (in increasing order of the | | | corresponding logical sequence | | | number) | +==============================+======================================+ | 0--23 | 129, 710, 140, 699, 120, 719, 210, | | | 629, 168, 671, 84, 755, 105, 734, | | | 93, 746, 70, 769, 60, 779 | | | | | | 2, 837, 1, 838 | +------------------------------+--------------------------------------+ | 24--29 | 56, 783, 112, 727, 148, 691 | +------------------------------+--------------------------------------+ | 30--35 | 80, 759, 42, 797, 40, 799 | +------------------------------+--------------------------------------+ | 36--41 | 35, 804, 73, 766, 146, 693 | +------------------------------+--------------------------------------+ | 42--51 | 31, 808, 28, 811, 30, 809, 27, 812, | | | 29, 810 | +------------------------------+--------------------------------------+ | 52--63 | 24, 815, 48, 791, 68, 771, 74, 765, | | | 178, 661, 136, 703 | +------------------------------+--------------------------------------+ | 64--75 | 86, 753, 78, 761, 43, 796, 39, 800, | | | 20, 819, 21, 818 | +------------------------------+--------------------------------------+ | 76--89 | 95, 744, 202, 637, 190, 649, 181, | | | 658, 137, 702, 125, 714, 151, 688 | +------------------------------+--------------------------------------+ | 90--115 | 217, 622, 128, 711, 142, 697, 122, | | | 717, 203, 636, 118, 721, 110, 729, | | | 89, 750, 103, 736, 61, 778, 55, 784, | | | 15, 824, 14, 825 | +------------------------------+--------------------------------------+ | 116--135 | 12, 827, 23, 816, 34, 805, 37, 802, | | | 46, 793, 207, 632, 179, 660, 145, | | | 694, 130, 709, 223, 616 | +------------------------------+--------------------------------------+ | 136--167 | 228, 611, 227, 612, 132, 707, 133, | | | 706, 143, 696, 135, 704, 161, 678, | | | 201, 638, 173, 666, 106, 733, 83, | | | 756, 91, 748, 66, 773, 53, 786, 10, | | | 829, 9, 830 | +------------------------------+--------------------------------------+ | 168--203 | 7, 832, 8, 831, 16, 823, 47, 792, | | | 64, 775, 57, 782, 104, 735, 101, | | | 738, 108, 731, 208, 631, 184, 655, | | | 197, 642, 191, 648, 121, 718, 141, | | | 698, 149, 690, 216, 623, 218, 621 | +------------------------------+--------------------------------------+ | 204--263 | 152, 687, 144, 695, 134, 705, 138, | | | 701, 199, 640, 162, 677, 176, 663, | | | 119, 720, 158, 681, 164, 675, 174, | | | 665, 171, 668, 170, 669, 87, 752, | | | 169, 670, 88, 751, 107, 732, 81, | | | 758, 82, 757, 100, 739, 98, 741, 71, | | | 768, 59, 780, 65, 774, 50, 789, 49, | | | 790, 26, 813, 17, 822, 13, 826, 6, | | | 833 | +------------------------------+--------------------------------------+ | 264--327 | 5, 834, 33, 806, 51, 788, 75, 764, | | | 99, 740, 96, 743, 97, 742, 166, 673, | | | 172, 667, 175, 664, 187, 652, 163, | | | 676, 185, 654, 200, 639, 114, 725, | | | 189, 650, 115, 724, 194, 645, 195, | | | 644, 192, 647, 182, 657, 157, 682, | | | 156, 683, 211, 628, 154, 685, 123, | | | 716, 139, 700, 212, 627, 153, 686, | | | 213, 626, 215, 624, 150, 689 | +------------------------------+--------------------------------------+ | 328--383 | 225, 614, 224, 615, 221, 618, 220, | | | 619, 127, 712, 147, 692, 124, 715, | | | 193, 646, 205, 634, 206, 633, 116, | | | 723, 160, 679, 186, 653, 167, 672, | | | 79, 760, 85, 754, 77, 762, 92, 747, | | | 58, 781, 62, 777, 69, 770, 54, 785, | | | 36, 803, 32, 807, 25, 814, 18, 821, | | | 11, 828, 4, 835 | +------------------------------+--------------------------------------+ | 384--455 | 3, 836, 19, 820, 22, 817, 41, 798, | | | 38, 801, 44, 795, 52, 787, 45, 794, | | | 63, 776, 67, 772, 72 | | | | | | 767, 76, 763, 94, 745, 102, 737, 90, | | | 749, 109, 730, 165, 674, 111, 728, | | | 209, 630, 204, 635, 117, 722, 188, | | | 651, 159, 680, 198, 641, 113, 726, | | | 183, 656, 180, 659, 177, 662, 196, | | | 643, 155, 684, 214, 625, 126, 713, | | | 131, 708, 219, 620, 222, 617, 226, | | | 613 | +------------------------------+--------------------------------------+ | 456--513 | 230, 609, 232, 607, 262, 577, 252, | | | 587, 418, 421, 416, 423, 413, 426, | | | 411, 428, 376, 463, 395, 444, 283, | | | 556, 285, 554, 379, 460, 390, 449, | | | 363, 476, 384, 455, 388, 451, 386, | | | 453, 361, 478, 387, 452, 360, 479, | | | 310, 529, 354, 485, 328, 511, 315, | | | 524, 337, 502, 349, 490, 335, 504, | | | 324, 515 | +------------------------------+--------------------------------------+ | 514--561 | 323, 516, 320, 519, 334, 505, 359, | | | 480, 295, 544, 385, 454, 292, 547, | | | 291, 548, 381, 458, 399, 440, 380, | | | 459, 397, 442, 369, 470, 377, 462, | | | 410, 429, 407, 432, 281, 558, 414, | | | 425, 247, 592, 277, 562, 271, 568, | | | 272, 567, 264, 575, 259, 580 | +------------------------------+--------------------------------------+ | 562--629 | 237, 602, 239, 600, 244, 595, 243, | | | 596, 275, 564, 278, 561, 250, 589, | | | 246, 593, 417, 422, 248, 591, 394, | | | 445, 393, 446, 370, 469, 365, 474, | | | 300, 539, 299, 540, 364, 475, 362, | | | 477, 298, 541, 312, 527, 313, 526, | | | 314, 525, 353, 486, 352, 487, 343, | | | 496, 327, 512, 350, 489, 326, 513, | | | 319, 520, 332, 507, 333, 506, 348, | | | 491, 347, 492, 322, 517 | +------------------------------+--------------------------------------+ | 630--659 | 330, 509, 338, 501, 341, 498, 340, | | | 499, 342, 497, 301, 538, 366, 473, | | | 401, 438, 371, 468, 408, 431, 375, | | | 464, 249, 590, 269, 570, 238, 601, | | | 234, 605 | +------------------------------+--------------------------------------+ | 660--707 | 257, 582, 273, 566, 255, 584, 254, | | | 585, 245, 594, 251, 588, 412, 427, | | | 372, 467, 282, 557, 403, 436, 396, | | | 443, 392, 447, 391, 448, 382, 457, | | | 389, 450, 294, 545, 297, 542, 311, | | | 528, 344, 495, 345, 494, 318, 521, | | | 331, 508, 325, 514, 321, 518 | +------------------------------+--------------------------------------+ | 708--729 | 346, 493, 339, 500, 351, 488, 306, | | | 533, 289, 550, 400, 439, 378, 461, | | | 374, 465, 415, 424, 270, 569, 241, | | | 598 | +------------------------------+--------------------------------------+ | 730--751 | 231, 608, 260, 579, 268, 571, 276, | | | 563, 409, 430, 398, 441, 290, 549, | | | 304, 535, 308, 531, 358, 481, 316, | | | 523 | +------------------------------+--------------------------------------+ | 752--765 | 293, 546, 288, 551, 284, 555, 368, | | | 471, 253, 586, 256, 583, 263, 576 | +------------------------------+--------------------------------------+ | 766--777 | 242, 597, 274, 565, 402, 437, 383, | | | 456, 357, 482, 329, 510 | +------------------------------+--------------------------------------+ | 778--789 | 317, 522, 307, 532, 286, 553, 287, | | | 552, 266, 573, 261, 578 | +------------------------------+--------------------------------------+ | 790--795 | 236, 603, 303, 536, 356, 483 | +------------------------------+--------------------------------------+ | 796--803 | 355, 484, 405, 434, 404, 435, 406, | | | 433 | +------------------------------+--------------------------------------+ | 804--809 | 235, 604, 267, 572, 302, 537 | +------------------------------+--------------------------------------+ | 810--815 | 309, 530, 265, 574, 233, 606 | +------------------------------+--------------------------------------+ | 816--819 | 367, 472, 296, 543 | +------------------------------+--------------------------------------+ | 820--837 | 336, 503, 305, 534, 373, 466, 280, | | | 559, 279, 560, 419, 420, 240, 599, | | | 258, 581, 229, 610 | +------------------------------+--------------------------------------+
Table 5.7.2-5: Root Zadoff-Chu sequence order for preamble format 4
Logical root sequence number | Physical root sequence number (in increasing order of the corresponding logical sequence number) |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---  
0 â€“ 19 | 1 | 138 | 2 | 137 | 3 | 136 | 4 | 135 | 5 | 134 | 6 | 133 | 7 | 132 | 8 | 131 | 9 | 130 | 10 | 129  
20 â€“ 39 | 11 | 128 | 12 | 127 | 13 | 126 | 14 | 125 | 15 | 124 | 16 | 123 | 17 | 122 | 18 | 121 | 19 | 120 | 20 | 119  
40 â€“ 59 | 21 | 118 | 22 | 117 | 23 | 116 | 24 | 115 | 25 | 114 | 26 | 113 | 27 | 112 | 28 | 111 | 29 | 110 | 30 | 109  
60 â€“ 79 | 31 | 108 | 32 | 107 | 33 | 106 | 34 | 105 | 35 | 104 | 36 | 103 | 37 | 102 | 38 | 101 | 39 | 100 | 40 | 99  
80 â€“ 99 | 41 | 98 | 42 | 97 | 43 | 96 | 44 | 95 | 45 | 94 | 46 | 93 | 47 | 92 | 48 | 91 | 49 | 90 | 50 | 89  
100 â€“ 119 | 51 | 88 | 52 | 87 | 53 | 86 | 54 | 85 | 55 | 84 | 56 | 83 | 57 | 82 | 58 | 81 | 59 | 80 | 60 | 79  
120 â€“ 137 | 61 | 78 | 62 | 77 | 63 | 76 | 64 | 75 | 65 | 74 | 66 | 73 | 67 | 72 | 68 | 71 | 69 | 70 | - | -  
138 â€“ 837 | N/A |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
### 5.7.3 Baseband signal generation
The time-continuous random access signal is defined by
where, is an amplitude scaling factor in order to conform to the transmit
power specified in clause 6.1 in 3GPP TS 36.213 [4], and . The location in the
frequency domain is controlled by the parameter is derived from clause 5.7.1.
The factor accounts for the difference in subcarrier spacing between the
random access preamble and uplink data transmission. The variable, the
subcarrier spacing for the random access preamble, and the variable, a fixed
offset determining the frequency-domain location of the random access preamble
within the physical resource blocks, are both given by Table 5.7.3-1.
Table 5.7.3-1: Random access baseband parameters
Preamble format
* * *
0 -- 3 1250 Hz 7 4 7500 Hz 2
## 5.8 Modulation and upconversion
Modulation and upconversion to the carrier frequency of the complex-valued SC-
FDMA baseband signal for each antenna port or the complex-valued PRACH
baseband signal is shown in Figure 5.8-1. The filtering required prior to
transmission is defined by the requirements in 3GPP TS 36.101 [7].
Figure 5.8-1: Uplink modulation
# 6 Downlink
## 6.1 Overview
The smallest time-frequency unit for downlink transmission is denoted a
resource element and is defined in clause 6.2.2.
A subset of the downlink subframes in a radio frame on a carrier supporting
PDSCH transmission can be configured as MBSFN subframes by higher layers. Each
MBSFN subframe is divided into a non-MBSFN region and an MBSFN region.
\- The non-MBSFN region spans the first one or two OFDM symbols in an MBSFN
subframe where the length of the non-MBSFN region is given according to
Subclause 6.7.
\- The MBSFN region in an MBSFN subframe is defined as the OFDM symbols not
used for the non-MBSFN region.
For frame structure type 3, MBSFN configuration shall not be applied to
downlink subframes in which at least one OFDM symbol is not occupied or
discovery signal is transmitted.
Unless otherwise specified, transmission in each downlink subframe shall use
the same cyclic prefix length as used for downlink subframe #0.
### 6.1.1 Physical channels
A downlink physical channel corresponds to a set of resource elements carrying
information originating from higher layers and is the interface defined
between 3GPP TS 36.212 [3] and the present document 3GPP TS 36.211.\ The
following downlink physical channels are defined:
\- Physical Downlink Shared Channel, PDSCH
\- Physical Broadcast Channel, PBCH
\- Physical Multicast Channel, PMCH
\- Physical Control Format Indicator Channel, PCFICH
\- Physical Downlink Control Channel, PDCCH
\- Physical Hybrid ARQ Indicator Channel, PHICH
\- Enhanced Physical Downlink Control Channel, EPDCCH
\- MTC Physical Downlink Control Channel, MPDCCH
### 6.1.2 Physical signals
A downlink physical signal corresponds to a set of resource elements used by
the physical layer but does not carry information originating from higher
layers. The following downlink physical signals are defined:
\- Reference signal
\- Synchronization signal
\- Discovery signal
## 6.2 Slot structure and physical resource elements
### 6.2.1 Resource grid
The transmitted signal in each slot is described by one or several resource
grids of subcarriers and OFDM symbols. _The resource grid structure is
illustrated in Figure 6.2.2-1._ The quantity depends on the downlink
transmission bandwidth configured in the cell and shall fulfil
where and are the smallest and largest downlink bandwidths, respectively,
supported by the current version of this specification.
The set of allowed values for is given by 3GPP TS 36.104 [6]. The number of
OFDM symbols in a slot depends on the cyclic prefix length and subcarrier
spacing configured and is given in Table 6.2.3-1.
An antenna port is defined such that the channel over which a symbol on the
antenna port is conveyed can be inferred from the channel over which another
symbol on the same antenna port is conveyed. For MBSFN reference signals,
positioning reference signals, UE-specific reference signals associated with
PDSCH and demodulation reference signals associated with EPDCCH, there are
limits given below within which the channel can be inferred from one symbol to
another symbol on the same antenna port. There is one resource grid per
antenna port. _The set of antenna ports supported depends on the reference
signal configuration in the cell:_
_-_ Cell-specific reference signals support a configuration of one, two, or
four antenna ports and are transmitted on antenna ports ,, and , respectively.
\- MBSFN reference signals are transmitted on antenna port. The channel over
which a symbol on antenna portis conveyed can be inferred from the channel
over which another symbol on the same antenna port is conveyed only if the two
symbols correspond to subframes of the same MBSFN area.
\- UE-specific reference signals associated with PDSCH intended for non-BL/CE
UE are transmitted on antenna port(s) , , , or one or several of . The channel
over which a symbol on one of these antenna ports is conveyed can be inferred
from the channel over which another symbol on the same antenna port is
conveyed only if the two symbols are within the same subframe and in the same
PRG when PRB bundling is used or in the same PRB pair when PRB bundling is not
used.
\- - UE-specific reference signals associated with PDSCH intended for BL/CE UE
are transmitted on one or several of antenna port(s) . The channel over which
a symbol on one of these antenna ports is conveyed can be inferred from the
channel over which another symbol on the same antenna port is conveyed only if
the two symbols are in the same set of consecutive subframes and have the same
PRB index.
\- Demodulation reference signals associated with EPDCCH are transmitted on
one or several of . The channel over which a symbol on one of these antenna
ports is conveyed can be inferred from the channel over which another symbol
on the same antenna port is conveyed only if the two symbols are in the same
PRB pair.
\- - Demodulation reference signals associated with MPDCCH are transmitted on
one or several of . The channel over which a symbol on one of these antenna
ports is conveyed can be inferred from the channel over which another symbol
on the same antenna port is conveyed only if the two symbols are in the same
set of consecutive subframes and have the same PRB index.
\- Positioning reference signals are transmitted on antenna port. The channel
over which a symbol on antenna port is conveyed can be inferred from the
channel over which another symbol on the same antenna port is conveyed only
within one positioning reference signal occasion consisting of consecutive
downlink subframes, where is configured by higher layers.
\- CSI reference signals support a configuration of one, two, four, eight,
twelve, or sixteen antenna ports and are transmitted on antenna ports , , , ,
and , respectively.
Two antenna ports are said to be quasi co-located if the large-scale
properties of the channel over which a symbol on one antenna port is conveyed
can be inferred from the channel over which a symbol on the other antenna port
is conveyed. The large-scale properties include one or more of delay spread,
Doppler spread, Doppler shift, average gain, and average delay.
### 6.2.2 Resource elements
Each element in the resource grid for antenna port is called a resource
element and is uniquely identified by the index pair in a slot where and _are
the indices in the frequency and time domains, respectively._ Resource element
on antenna port corresponds to the complex value _.\ When there is no risk for
confusion, or no particular antenna port is specified, the index_ may be
dropped.
Figure 6.2.2-1: Downlink resource grid
### 6.2.3 Resource blocks
Resource blocks are used to describe the mapping of certain physical channels
to resource elements. Physical and virtual resource blocks are defined.
A physical resource block is defined as consecutive OFDM symbols in the time
domain and consecutive subcarriers in the frequency domain, where and are
given by Table 6.2.3-1. A physical resource block thus consists of resource
elements, corresponding to one slot in the time domain and 180 kHz in the
frequency domain.
Physical resource blocks are numbered from 0 to in the frequency domain. The
relation between the physical resource block number in the frequency domain
and resource elements in a slot is given by
Table 6.2.3-1: Physical resource blocks parameters
Configuration
* * *
Normal cyclic prefix 12 7 Extended cyclic prefix 6 24 3
A physical resource-block pair is defined as the two physical resource blocks
in one subframe having the same physical resource-block number .
A virtual resource block is of the same size as a physical resource block. Two
types of virtual resource blocks are defined:
\- Virtual resource blocks of localized type
\- Virtual resource blocks of distributed type
For each type of virtual resource blocks, a pair of virtual resource blocks
over two slots in a subframe is assigned together by a single virtual resource
block number, .
#### 6.2.3.1 Virtual resource blocks of localized type
Virtual resource blocks of localized type are mapped directly to physical
resource blocks such that virtual resource block corresponds to physical
resource block. Virtual resource blocks are numbered from 0 to, where .
#### 6.2.3.2 Virtual resource blocks of distributed type
Virtual resource blocks of distributed type are mapped to physical resource
blocks as described below.
Table 6.2.3.2-1: RB gap values
System BW () Gap ()
* * *
                 1^st^ Gap ()   2^nd^ Gap ()
6-10 N/A 11 4 N/A 12-19 8 N/A 20-26 12 N/A 27-44 18 N/A 45-49 27 N/A 50-63 27
9 64-79 32 16 80-110 48 16
The parameter is given by Table 6.2.3.2-1. For , only one gap value is defined
and . For , two gap values **and** are defined. Whether **or is signaled as
part of** the downlink scheduling assignment as described in 3GPP TS 36.212
[3].
Virtual resource blocks of distributed type are numbered from 0 to, where for
and for .
Consecutive VRB numbers compose a unit of VRB number interleaving, where for
and for . Interleaving of VRB numbers of each interleaving unit is performed
with 4 columns and rows, where , and is RBG size as described in 3GPP TS
36.213 [4]. VRB numbers are written row by row in the rectangular matrix, and
read out column by column. nulls are inserted in the last rows of the 2^nd^
and 4^th^ column, where . Nulls are ignored when reading out. The VRB numbers
mapping to PRB numbers including interleaving is derived as follows:
For even slot number ;
,
where ,
and ,
where and is obtained from the downlink scheduling assignment as described in
3GPP TS 36.213 [4].
For odd slot number ;
Then, for all ;
.
Virtual resource blocks of distributed type are not applicable to BL/CE UEs.
### 6.2.4 Resource-element groups
Resource-element groups are used for defining the mapping of control channels
to resource elements.
A resource-element group is represented by the index pair of the resource
element with the lowest index in the group with all resource elements in the
group having the same value of . The set of resource elements in a resource-
element group depends on the number of cell-specific reference signals
configured as described below with , .
\- In the first OFDM symbol of the first slot in a subframe the two resource-
element groups in physical resource block consist of resource elements with
and , respectively.
\- In the second OFDM symbol of the first slot in a subframe in case of one or
two cell-specific reference signals configured, the three resource-element
groups in physical resource block consist of resource elements with , and ,
respectively.
\- In the second OFDM symbol of the first slot in a subframe in case of four
cell-specific reference signals configured, the two resource-element groups in
physical resource block consist of resource elements with and , respectively.
\- In the third OFDM symbol of the first slot in a subframe, the three
resource-element groups in physical resource block consist of resource
elements with , and , respectively.
\- In the fourth OFDM symbol of the first slot in a subframe in case of normal
cyclic prefix, the three resource-element groups in physical resource block
consist of resource elements with , and , respectively.
\- In the fourth OFDM symbol of the first slot in a subframe in case of
extended cyclic prefix, the two resource-element groups in physical resource
block consist of resource elements with and , respectively.
Mapping of a symbol-quadruplet onto a resource-element group represented by
resource-element is defined such that elements are mapped to resource elements
of the resource-element group not used for cell-specific reference signals in
increasing order of and . In case a single cell-specific reference signal is
configured, cell-specific reference signals shall be assumed to be present on
antenna ports 0 and 1 for the purpose of mapping a symbol-quadruplet to a
resource-element group, otherwise the number of cell-specific reference
signals shall be assumed equal to the actual number of antenna ports used for
cell-specific reference signals. The UE shall not make any assumptions about
resource elements assumed to be reserved for reference signals but not used
for transmission of a reference signal.
For frame structure type 3, if the higher layer parameter
_subframeStartPosition_ indicates \'s07\' and the downlink transmission starts
in the second slot of a subframe, the above definition applies to the second
slot of that subframe instead of the first slot.
### 6.2.4A Enhanced Resource-Element Groups (EREGs)
EREGs are used for defining the mapping of enhanced control channels to
resource elements.
There are 16 EREGs, numbered from 0 to 15, per physical resource block pair.
Number all resource elements, except resource elements carrying DM-RS for
antenna ports for normal cyclic prefix or for extended cyclic prefix, in a
physical resource-block pair cyclically from 0 to 15 in an increasing order of
first frequency, then time. All resource elements with number in that physical
resource-block pair constitutes EREG number .
For frame structure type 3, if the higher layer parameter
_subframeStartPosition_ indicates \'s07\' and the downlink transmission starts
in the second slot of a subframe, the above definition applies to the second
slot of that subframe instead of the first slot.
### 6.2.5 Guard period for half-duplex FDD operation
For type A half-duplex FDD operation, a guard period is created by the UE by
\- not receiving the last part of a downlink subframe immediately preceding an
uplink subframe from the same UE.
For type B half-duplex FDD operation, guard periods, each referred to as a
half-duplex guard subframe, are created by the UE by
\- not receiving a downlink subframe immediately preceding an uplink subframe
from the same UE, and
\- not receiving a downlink subframe immediately following an uplink subframe
from the same UE.
### 6.2.6 Guard Period for TDD Operation
For frame structure type 2, the GP field in Figure 4.2-1 serves as a guard
period.
### 6.2.7 Narrowbands
A narrowband is defined as six non-overlapping consecutive physical resource
blocks in the frequency domain. The total number of downlink narrowbands in
the downlink transmission bandwidth configured in the cell is given by
The narrowbands are numbered in order of increasing physical resource-block
number where narrowband is composed of physical resource-block indices
where
### 6.2.8 Guard period for narrowband retuning
For BL/CE UEs, a guard period is created by the UE not receiving at most the
first two OFDM symbols in the second narrowband when
\- the UE retunes from a first downlink narrowband to a second downlink
narrowband with a different center frequency, or
\- the UE retunes from a first uplink narrowband to a second downlink
narrowband with a different center frequency for frame structure type 2.
## 6.3 General structure for downlink physical channels
This clause describes a general structure, applicable to more than one
physical channel.
The baseband signal representing a downlink physical channel is defined in
terms of the following steps:
\- scrambling of coded bits in each of the codewords to be transmitted on a
physical channel
\- modulation of scrambled bits to generate complex-valued modulation symbols
\- mapping of the complex-valued modulation symbols onto one or several
transmission layers
\- precoding of the complex-valued modulation symbols on each layer for
transmission on the antenna ports
\- mapping of complex-valued modulation symbols for each antenna port to
resource elements
\- generation of complex-valued time-domain OFDM signal for each antenna port
Figure 6.3-1: Overview of physical channel processing
### 6.3.1 Scrambling
For each codeword , the block of bits , where is the number of bits in
codeword transmitted on the physical channel in one subframe, shall be
scrambled prior to modulation, resulting in a block of scrambled bits
according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised at the start of each subframe, where the
initialisation value of depends on the transport channel type according to
where corresponds to the RNTI associated with the PDSCH transmission as
described in clause 7.1 3GPP TS 36.213 [4].
For BL/CE UEs, the same scrambling sequence is applied per subframe to PDSCH
for a given block of subframes. The subframe number of the first subframe in
each block of consecutive subframes, denoted as , satisfies . For the block of
subframes, the scrambling sequence generator shall be initialised with
where
and is the absolute subframe number of the first downlink subframe intended
for PDSCH. The PDSCH transmission spans consecutive subframes including
subframes that are not BL/CE DL subframes where the PDSCH transmission is
postponed.
For BL/CE UEs,
\- if the PDSCH is carrying SIB1-BR
-
\- else if the PDSCH is carrying SI message (except for SIB1-BR) or if the
PDSCH transmission is associated with P-RNTI:
\- for frame structure type 1 and for frame structure type 2
\- otherwise
\- for UEs assuming CEModeA (according to the definition in section 12 of [4])
or configured with CEModeA
\- for frame structure type 1 and for frame structure type 2 for UEs assuming
CEModeB (according to the definition in section 12 of [4]) or configured with
CEModeB
Up to two codewords can be transmitted in one subframe, i.e., . In the case of
single codeword transmission, is equal to zero.
### 6.3.2 Modulation
For each codeword , the block of scrambled bits shall be modulated as
described in clause 7.1 using one of the modulation schemes in Table 6.3.2-1,
resulting in a block of complex-valued modulation symbols .
Table 6.3.2-1: Modulation schemes
Physical channel Modulation schemes
* * *
PDSCH QPSK, 16QAM, 64QAM, 256QAM PMCH QPSK, 16QAM, 64QAM, 256QAM
### 6.3.3 Layer mapping
The complex-valued modulation symbols for each of the codewords to be
transmitted are mapped onto one or several layers. Complex-valued modulation
symbols for codeword shall be mapped onto the layers , where is the number of
layers and is the number of modulation symbols per layer.
#### 6.3.3.1 Layer mapping for transmission on a single antenna port
For transmission on a single antenna port, a single layer is used, , and the
mapping is defined by
with .
#### 6.3.3.2 Layer mapping for spatial multiplexing
For spatial multiplexing, the layer mapping shall be done according to Table
6.3.3.2-1. The number of layers is less than or equal to the number of antenna
ports used for transmission of the physical channel. The case of a single
codeword mapped to multiple layers is only applicable when the number of cell-
specific reference signals is four or when the number of UE-specific reference
signals is two or larger.
Table 6.3.3.2-1: Codeword-to-layer mapping for spatial multiplexing
Number of layers Number of codewords Codeword-to-layer mapping
* * *
1 1  
2 1  
2 2
3 1  
3 2
4 1  
4 2
5 2
6 2
7 2
8 2
#### 6.3.3.3 Layer mapping for transmit diversity
For transmit diversity, the layer mapping shall be done according to Table
6.3.3.3-1. There is only one codeword and the number of layers is equal to the
number of antenna ports used for transmission of the physical channel.
Table 6.3.3.3-1: Codeword-to-layer mapping for transmit diversity
Number of layers Number of codewords Codeword-to-layer mapping
* * *
2 1  
4 1 If two null symbols shall be appended to
### 6.3.4 Precoding
The precoder takes as input a block of vectors, from the layer mapping and
generates a block of vectors, to be mapped onto resources on each of the
antenna ports, where represents the signal for antenna port.
#### 6.3.4.1 Precoding for transmission on a single antenna port
For transmission on a single antenna port, precoding is defined by
where is the number of the single antenna port used for transmission of the
physical channel and , .
#### 6.3.4.2 Precoding for spatial multiplexing using antenna ports with cell-
specific reference signals
Precoding for spatial multiplexing using antenna ports with cell-specific
reference signals is only used in combination with layer mapping for spatial
multiplexing as described in clause 6.3.3.2. Spatial multiplexing supports two
or four antenna ports and the set of antenna ports used is or, respectively.
##### 6.3.4.2.1 Precoding without CDD
Without Cyclic Delay Diversity (CDD), precoding for spatial multiplexing is
defined by
where the precoding matrix is of size and , .
For spatial multiplexing, the values of shall be selected among the precoder
elements in the codebook configured in the eNodeB and the UE. The eNodeB can
further confine the precoder selection in the UE to a subset of the elements
in the codebook using codebook subset restrictions. The configured codebook
shall be selected from Table 6.3.4.2.3-1 or 6.3.4.2.3-2.
##### 6.3.4.2.2 Precoding for large delay CDD
For large-delay CDD, precoding for spatial multiplexing is defined by
where the precoding matrixis of size and , . The diagonal size-matrix
supporting cyclic delay diversity and the size- matrix are both given by Table
6.3.4.2.2-1 for different numbers of layers .
The values of the precoding matrix shall be selected among the precoder
elements in the codebook configured in the eNodeB and the UE. The eNodeB can
further confine the precoder selection in the UE to a subset of the elements
in the codebook using codebook subset restriction. The configured codebook
shall be selected from Table 6.3.4.2.3-1 or 6.3.4.2.3-2.
For 2 antenna ports, the precoder is selected according to where denotes the
precoding matrix corresponding to precoder index 0 in Table 6.3.4.2.3-1.
For 4 antenna ports, the UE may assume that the eNodeB cyclically assigns
different precoders to different vectors on the physical downlink shared
channel as follows. A different precoder is used every vectors, where denotes
the number of transmission layers in the case of spatial multiplexing. In
particular, the precoder is selected according to , where is the precoder
index given by and denote precoder matrices corresponding to precoder indices
12,13,14 and 15, respectively, in Table 6.3.4.2.3-2.
Table 6.3.4.2.2-1: Large-delay cyclic delay diversity
Number of layers
* * *
2  
3  
4
##### 6.3.4.2.3 Codebook for precoding and CSI reporting
For transmission on two antenna ports, , and for the purpose of CSI reporting
based on two antenna ports or , the precoding matrix shall be selected from
Table 6.3.4.2.3-1 or a subset thereof. For the closed-loop spatial
multiplexing transmission mode defined in 3GPP TS 36.213 [4], the codebook
index 0 is not used when the number of layers is .
Table 6.3.4.2.3-1: Codebook for transmission on antenna ports and for CSI
reporting based on antenna ports or
Codebook index Number of layers
* * *
                   1                  2
0  
1  
2  
3 -
For transmission on four antenna ports, , the precoding matrix shall be
selected from Table 6.3.4.2.3-2 or a subset thereof. For the purpose of CSI
reporting based on four antenna ports or , the precoding matrix shall be
selected from Table 6.3.4.2.3-2 or a subset thereof except for
_alternativeCodeBookEnabledFor4TX -r12 =TRUE_ in which case the precoding
matrix shall be selected from Tables 7.2.4-0A, 7.2.4-0B, 7.2.4-0C, 7.2.4-0D in
[4] or a subset thereof. The quantity denotes the matrix defined by the
columns given by the set from the expression where is the identity matrix and
the vector is given by Table 6.3.4.2.3-2.
Table 6.3.4.2.3-2: Codebook for transmission on antenna ports and for CSI
reporting based on antenna ports or
Codebook index Number of layers
* * *
                      1                  2   3   4
0  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15
For the purpose of CSI reporting for eight CSI reference signals the codebooks
are given in clause 7.2.4 of 3GPP TS 36.213 [4].
#### 6.3.4.3 Precoding for transmit diversity
Precoding for transmit diversity is only used in combination with layer
mapping for transmit diversity as described in clause 6.3.3.3. The precoding
operation for transmit diversity is defined for two and four antenna ports.
For transmission on two antenna ports, , the output , of the precoding
operation is defined by
for with .
For transmission on four antenna ports,, the output , of the precoding
operation is defined by
for with .
#### 6.3.4.4 Precoding for spatial multiplexing using antenna ports with UE-
specific reference signals
Precoding for spatial multiplexing using antenna ports with UE-specific
reference signals is only used in combination with layer mapping for spatial
multiplexing as described in clause 6.3.3.2. Spatial multiplexing using
antenna ports with UE-specific reference signals supports up to eight antenna
ports.
If the higher-layer parameter _dmrs-tableAlt_ is set to 1 and the set of
antenna ports is used for two layers transmission, the precoding operation for
transmission on the two antenna ports is defined by
where , . Otherwise, the set of antenna ports used is and the precoding
operation for transmission on antenna ports is defined by
where , .
### 6.3.5 Mapping to resource elements
For each of the antenna ports used for transmission of the physical channel,
the block of complex-valued symbols shall conform to the downlink power
allocation specified in clause 5.2 in 3GPP TS 36.213 [4] and be mapped in
sequence starting with to resource elements which meet all of the following
criteria in the current subframe:
\- they are in the physical resource blocks corresponding to the virtual
resource blocks assigned for transmission, and
\- they are not used for transmission of the core part of PBCH,
synchronization signals, and
\- they are assumed by the UE not to be used for cell-specific reference
signals, where the positions of the cell-specific reference signals are given
by clause 6.10.1.2 with the number of antenna ports for and the frequency
shift of cell-specific reference signals derived as described in clause
6.10.1.2 4, and
The mapping to resource elements on antenna port not reserved for other
purposes shall be in increasing order of first the index over the assigned
physical resource blocks and then the index, starting with the first slot in a
subframe.
## 6.4 Physical downlink shared channel
The physical downlink shared channel shall be processed and mapped to resource
elements as described in clause 6.3 with the following additions and
exceptions:
\- In resource blocks in which UE-specific reference signals are not
transmitted, the PDSCH shall be transmitted on the same set of antenna ports
as the PBCH, which is one of , , or .
\- In resource blocks in which UE-specific reference signals are transmitted,
the PDSCH shall be transmitted on antenna port(s) ,,,, , or , where is the
number of layers used for transmission of the PDSCH.
\- If PDSCH is transmitted in MBSFN subframes as defined in 3GPP TS 36.213
[4], the PDSCH shall be transmitted on one or several of antenna port(s) ,
where is the number of layers used for transmission of the PDSCH.
\- PDSCH is not mapped to resource elements used for UE-specific reference
signals associated with PDSCH
\- In mapping to resource elements, the positions of the cell-specific
reference signals are given by clause 6.10.1.2 with the number of antenna
ports and the frequency shift of the cell-specific reference signals derived
as described in clause 6.10.1.2, unless other values for these parameters are
provided by clause 7.1.9 in 3GPP TS 36.213 [4], in which case these values are
used in the resource blocks indicated by the relevant DCI.
\- If the DCI associated with the PDSCH uses the C-RNTI or semi-persistent
C-RNTI, the PDSCH is not mapped to resource elements assumed by the UE to be
used for transmission of:
\- zero-power CSI reference signals, where the positions of the CSI reference
signals are given by clause 6.10.5.2. The configuration for zero power CSI
reference signals is
\- obtained as described in clause 6.10.5.2, unless other values for these
parameters are provided by clause 7.1.9 in 3GPP TS 36.213 [4], in which case
these values are used in the resource blocks indicated by the relevant DCI,
and
\- obtained by higher-layer configuration of up to five reserved CSI-RS
resources as part of the discovery signal configuration following the
procedure for zero-power CSI-RS in clause 6.10.5.2.
\- non-zero-power CSI reference signals for CSI reporting, where the positions
of the non-zero-power CSI reference signals for CSI reporting are given by
clause 6.10.5.2. The configuration for non-zero power CSI reference signals is
obtained as described in clause 6.10.5.2.
\- PDSCH is not mapped to any physical resource-block pair(s) carrying an
EPDCCH associated with the PDSCH.
\- PDSCH on antenna port 7, 8, 9, 10, 11, 12, 13 or 14 is not mapped to any
physical resource-block pair(s) carrying PBCH or synchronization signals.
\- Frame structure type 1, PDSCH on antenna port 5 is not mapped to any
physical resource-block pair(s) carrying PBCH or synchronization signals.
\- Frame structure type 2, PDSCH on antenna port 5 is not mapped to any
physical resource-block pair(s) carrying PBCH.
\- For frame structure type 1 and 2, the index in the first slot in a subframe
fulfils where is given by clause 7.1.6.4 of 3GPP TS 36.213 [4].
\- For frame structure type 3,
\- [if the higher layer parameter _subframeStartPosition_ indicates \'s07\'
and the downlink]{.underline} transmission starts in the second slot of a
subframe
\- the index in the second slot in a subframe fulfils where is given by clause
7.1.6.4 of 3GPP TS 36.213 [4],
\- otherwise
\- the index in the first slot in a subframe fulfils where is given by clause
7.6.1.4 of 3GPP TS 36.213 [4],
\- In mapping to resource elements, if the DCI associated with the PDSCH uses
the C-RNTI or semi-persistent C-RNTI and transmit diversity according to
clause 6.3.4.3 is used, resource elements in an OFDM symbol assumed by the UE
to contain CSI-RS shall be used in the mapping if and only if all of the
following criteria are fulfilled:
\- there is an even number of resource elements for the OFDM symbol in each
resource block assigned for transmission, and
\- the complex-valued symbols and , where is an even number, can be mapped to
resource elements and in the same OFDM symbol with .
### 6.4.1 Physical downlink shared channel for BL/CE UEs
For BL/CE UEs, the following additions and exceptions hold in addition to
those in clause 6.4:
\- Resource elements occupied by CSI reference signals shall be counted in the
PDSCH mapping but not used for transmission of the PDSCH.
\- Resource elements belonging to synchronization signals, the core part of
PBCH, PBCH repetitions, or resource elements reserved for reference signals in
the mapping operation of PBCH but not used for transmission of reference
signals, shall be counted in the PDSCH mapping but not used for transmission
of the PDSCH.
\- For BL/CE UEs in CEModeB configured in transmission mode 9, in MBSFN
subframe(s), resource elements that correspond to the positions of cell-
specific reference signals as in subframe #0 shall not be counted in the PDSCH
mapping and not used for transmission of the PDSCH.
For BL/CE UEs, if the PDSCH is not carrying SIB1-BR the PRB resources within
the narrowband for PDSCH transmission in the first subframe are obtained from
the DCI as described in clauses 5.3.3.1.12, 5.3.3.1.13, and 5.5.1.3.14 in [3],
or provided by higher layers. The PDSCH is transmitted with repetitions,
spanning consecutive subframes, including subframes that are not BL/CE DL
subframes where the the PDSCH transmission is postponed.
\- If frequency hopping is not enabled for PDSCH, the PDSCH repetitions are
located at the same PRB resources in the same narrowband , and
\- if frequency hopping is enabled for PDSCH, the PDSCH shall be transmitted
in subframe within the consecutive downlink subframes using the same PRB
resources within each narrowband
where is the absolute subframe number of the first downlink subframe intended
for PDSCH and , and are cell-specific higher-layer parameters. For PDSCH
carrying SI other than SIB1-BR and for PDSCH associated with P-RNTI, if
_interval-DlHoppingConfigCommonModeB_ is signalled in SIB1-BR, then the
frequency hopping granularity is set to _interval-DlHoppingConfigCommonModeB_
; otherwise, is set to _interval-DlHoppingConfigCommonModeA_ signalled in
SIB1-BR.
For BL/CE UE in CEModeA, frequency hopping of PDSCH associated with C-RNTI or
SPS-RNTI is enabled when higher layer parameter _mpdcch-pdsch-HoppingConfig_
is set and the frequency hopping flag in DCI format 6-1A indicates frequency
hopping, otherwise, frequency hopping of is not enabled. For BL/CE UE in
CEModeB, frequency hopping of PDSCH associated with C-RNTI or SPS-RNTI is
enabled when higher layer parameter _mpdcch-pdsch-HoppingConfig_ is set,
otherwise, frequency hopping of is not enabled.
The UE shall not expect PDSCH in subframe if it is not a BL/CE DL subframe.
For BL/CE UEs, if the PDSCH carries SIB1-BR, the PDSCH transmission is
repeated periodically in every period of 8 radio frames, where a period starts
with a radio frame with _where is the system frame number_. The PDSCH is
transmitted times in each period of 8 frames, Let be the set of narrowbands,
excluding narrowbands overlapping with the 72 center subcarriers for , and
ordered in increasing order of narrowband index. The PDSCH transmission cycles
through the set of narrowbands in increasing order of , starting with for the
first subframe, according to
where is the number of narrowbands in the set .
The set of frames and subframes used for SIB1-BR transmission in each period
are given by Tables 6.4.1-1 and 6.4.1-2.
Table 6.4.1-1: The set of frames and subframes for SIB1-BR for .
          Frame structure type 1   Frame structure type 2
* * *
4 0 0 4 1 5 1 1 4 1 5
Table 6.4.1-2: The set of frames and subframes for SIB1-BR for .
           Frame structure type 1   Frame structure type 2
* * *
4 0 0 4 1 5 1 1 4 1 0 8 0 0, 1 4 0, 1 5 1 0, 1 9 0, 1 0 16 0 0, 1 4, 9 0, 1 0,
5 1 0, 1 0, 9 0, 1 0, 5
BL/CE UEs may assume the same precoding matrix being used for a PRB across a
block of consecutive subframes when UE-specific reference signals are
transmitted together with the PDSCH, where the subframe number of the first
subframe in each block of consecutive subframes, denoted as , satisfies .
For PDSCH transmission associated with SI-RNTI or P-RNTI to BL/CE UEs,
frequency hopping of the PDSCH is enabled when higher layer parameter _si-
HoppingConfigCommon_ is set.
For PDSCH transmission associated with RA-RNTI or temporary C-RNTI to BL/CE
UEs, frequency hopping of the PDSCH is enabled when higher layer parameter
_rar-HoppingConfig_ is set. Further
\- if PRACH CE level 0 or 1 is used for the last PRACH attempt, is set to the
higher layer parameter _interval-DlHoppingConfigCommonModeA_ ;
\- if PRACH CE level 2 or 3 is used for the last PRACH attempt, is set to the
higher layer parameter _interval-DlHoppingConfigCommonModeB_.
## 6.5 Physical multicast channel
The physical multicast channel shall be processed and mapped to resource
elements as described in clause 6.3 with the following exceptions:
\- No transmit diversity scheme is specified.
\- Layer mapping and precoding shall be done assuming a single antenna port
and the transmission shall use antenna port 4.
\- The PMCH can only be transmitted in the MBSFN region of an MBSFN subframe.
The index in the first slot in the MBSFN subframe fulfils where is equal to
the value given by the higher layer parameter _non-MBSFNregionLength_ [9].
\- The PMCH shall use extended cyclic prefix.
\- The PMCH is not mapped to resource elements used for transmission of MBSFN
reference signals.
## 6.6 Physical broadcast channel
The PBCH is not transmitted for frame structure type 3.
### 6.6.1 Scrambling
The block of bits, where , the number of bits transmitted on the physical
broadcast channel, equals 1920 for normal cyclic prefix and 1728 for extended
cyclic prefix, shall be scrambled with a cell-specific sequence prior to
modulation, resulting in a block of scrambled bits according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
shall be initialised with in each radio frame fulfilling .
### 6.6.2 Modulation
The block of scrambled bits shall be modulated as described in clause 7.1,
resulting in a block of complex-valued modulation symbols. Table 6.6.2-1
specifies the modulation mappings applicable for the physical broadcast
channel.
Table 6.6.2-1: PBCH modulation schemes.
Physical channel Modulation schemes
* * *
PBCH QPSK
### 6.6.3 Layer mapping and precoding
The block of modulation symbols shall be mapped to layers according to one of
clauses 6.3.3.1 or 6.3.3.3 with and precoded according to one of clauses
6.3.4.1 or 6.3.4.3, resulting in a block of vectors , , where represents the
signal for antenna port and where and the number of antenna ports for cell-
specific reference signals .
### 6.6.4 Mapping to resource elements
The block of complex-valued symbols for each antenna port is transmitted
during 4 consecutive radio frames starting in each radio frame fulfilling and
shall be mapped in sequence starting with to resource elements constituting
the core set of PBCH resource elements. The mapping to resource elements not
reserved for transmission of reference signals shall be in increasing order of
first the index, then the index in slot 1 in subframe 0 and finally the radio
frame number. The resource-element indices are given by
where resource elements reserved for reference signals shall be excluded. The
mapping operation shall assume cell-specific reference signals for antenna
ports 0-3 being present irrespective of the actual configuration. The UE shall
assume that the resource elements assumed to be reserved for reference signals
in the mapping operation above but not used for transmission of reference
signal are not available for PDSCH or MPDCCH transmission. The UE shall not
make any other assumptions about these resource elements.
If a cell is configured with repetition of the physical broadcast channel
\- symbols mapped to core resource element in slot 1 in subframe 0 within a
radio frame according to the mapping operation above, and
\- cell-specific reference signals in OFDM symbols in slot 1 in subframe 0
within a radio frame with according to the mapping operation above
shall additionally be mapped to resource elements in slot number within radio
frame unless resource element is used by CSI reference signals.
For frame structure type 1, , , and are given by Table 6.6.4-1.
For frame structure type 2,
\- if , and are given by Table 6.6.4-2 and ;
\- if , and are given by Table 6.6.4-2 and , except that repetitions with and
are not applied.
For both frame structure type 1 and frame structure type 2, repetition of the
physical broadcast channel is not applicable if .
Resource elements already reserved or used for transmission of cell-specific
reference signals in absence of repetition shall not be used for additional
mapping of cell-specific reference signals.
Table 6.6.4-1: Frame offset, slot and symbol number triplets for repetition of
PBCH for frame structure type 1.
      Frame offset, slot and symbol number triplets
* * *
      Normal cyclic prefix                            Extended cyclic prefix
0 (1,18,3), (1,19,0), (1,19,4), (0,0,4) (1,18,3), (1,19,0), (1,19,5) 1
(1,18,4), (1,19,1). (1,19,5), (0,1,4) (1,18,4), (1,19,1). (0,0,3) 2 (1,18,5),
(1,19,2), (1,19,6), (0,1,5) (1,18,5), (1,19,2), (0,1,4) 3 (1,18,6), (1,19,3),
(0,0,3), (0,1,6) (1,19,3), (1,19,4), (0,1,5)
Table 6.6.4-2: Slot and symbol number pairs for repetition of PBCH for frame
structure type 2.
      Slot and symbol number pairs
* * *
      Normal cyclic prefix                   Extended cyclic prefix
0 (0,3), (1,4), (10,3), (11,0), (11,4) (0,3), (10,3), (11,0) 1 (0,4), (1,5),
(10,4), (11,1), (11,5) (0,4), (10,4), (11,1) 2 (0,5), (10,5), (11.2) (0,5),
(10,5), (11.2) 3 (0,6), (10,6), (11.3) (1,4), (11,3), (11.4)
## 6.7 Physical control format indicator channel
The physical control format indicator channel carries information about the
number of OFDM symbols used for transmission of PDCCHs in a subframe. The set
of OFDM symbols possible to use for PDCCH in a subframe is given by Table
6.7-1.
Table 6.7-1: Number of OFDM symbols used for PDCCH
Subframe Number of OFDM symbols for PDCCH when Number of OFDM symbols for
PDCCH when
* * *
Subframe 1 and 6 for frame structure type 2 or a subframe for frame structure
type 3 with the same duration as the DwPTS duration of a special subframe
configuration 1, 2 2 MBSFN subframes on a carrier supporting PDSCH, configured
with 1 or 2 cell-specific antenna ports 1, 2 2 MBSFN subframes on a carrier
supporting PDSCH, configured with 4 cell-specific antenna ports 2 2 Subframes
on a carrier not supporting PDSCH 0 0 Non-MBSFN subframes (except subframe 6
for frame structure type 2) configured with positioning reference signals 1,
2, 3 2, 3 All other cases 1, 2, 3 2, 3, 4
The UE may assume the PCFICH is transmitted when the number of OFDM symbols
for PDCCH is greater than zero unless stated otherwise in [4, clause 12].
### 6.7.1 Scrambling
The block of bits transmitted in one subframe shall be scrambled with a cell-
specific sequence prior to modulation, resulting in a block of scrambled
bitsaccording to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe.
### 6.7.2 Modulation
The block of scrambled bits shall be modulated as described in clause 7.1,
resulting in a block of complex-valued modulation symbols. Table 6.7.2-1
specifies the modulation mappings applicable for the physical control format
indicator channel.
Table 6.7.2-1: PCFICH modulation schemes
Physical channel Modulation schemes
* * *
PCFICH QPSK
### 6.7.3 Layer mapping and precoding
The block of modulation symbols shall be mapped to layers according to one of
clauses 6.3.3.1 or 6.3.3.3 with and precoded according to one of clauses
6.3.4.1 or 6.3.4.3, resulting in a block of vectors , , where represents the
signal for antenna port and where and the number of antenna ports for cell-
specific reference signals . The PCFICH shall be transmitted on the same set
of antenna ports as the PBCH.
### 6.7.4 Mapping to resource elements
The mapping to resource elements is defined in terms of quadruplets of
complex-valued symbols. Let denote symbol quadruplet for antenna port. For
each of the antenna ports, symbol quadruplets shall be mapped in increasing
order of to the four resource-element groups in the first OFDM symbol in a
downlink subframe or DwPTS with the representative resource-element as defined
in clause 6.2.4 given by
where the additions are modulo ,
and is the physical-layer cell identity as given by clause 6.11.
## 6.8 Physical downlink control channel
### 6.8.1 PDCCH formats
The physical downlink control channel carries scheduling assignments and other
control information. A physical control channel is transmitted on an
aggregation of one or several consecutive control channel elements (CCEs),
where a control channel element corresponds to 9 resource element groups. The
number of resource-element groups not assigned to PCFICH or PHICH is . The
CCEs available in the system are numbered from 0 to, where . The PDCCH
supports multiple formats as listed in Table 6.8.1-1. A PDCCH consisting of
consecutive CCEs may only start on a CCE fulfilling, where is the CCE number.
Multiple PDCCHs can be transmitted in a subframe.
Table 6.8.1-1: Supported PDCCH formats
PDCCH format Number of CCEs Number of resource-element groups Number of PDCCH
bits
* * *
0 1 9 72 1 2 18 144 2 4 36 288 3 8 72 576
### 6.8.2 PDCCH multiplexing and scrambling
The block of bits on each of the control channels to be transmitted in a
subframe, where is the number of bits in one subframe to be transmitted on
physical downlink control channel number , shall be multiplexed, resulting in
a block of bits , where is the number of PDCCHs transmitted in the subframe.
The block of bits shall be scrambled with a cell-specific sequence prior to
modulation, resulting in a block of scrambled bits according to
where the scrambling sequence is given by clause 7.2. The scrambling sequence
generator shall be initialised with at the start of each subframe.
CCE number corresponds to bits . If necessary, \ elements shall be
inserted in the block of bits prior to scrambling to ensure that the PDCCHs
starts at the CCE positions as described in 3GPP TS 36.213 [4] and to ensure
that the length of the scrambled block of bits matches the amount of resource-
element groups not assigned to PCFICH or PHICH.
### 6.8.3 Modulation
The block of scrambled bits shall be modulated as described in clause 7.1,
resulting in a block of complex-valued modulation symbols. Table 6.8.3-1
specifies the modulation mappings applicable for the physical downlink control
channel.
Table 6.8.3-1: PDCCH modulation schemes
Physical channel Modulation schemes
* * *
PDCCH QPSK
### 6.8.4 Layer mapping and precoding
The block of modulation symbols shall be mapped to layers according to one of
clauses 6.3.3.1 or 6.3.3.3 with and precoded according to one of clauses
6.3.4.1 or 6.3.4.3, resulting in a block of vectors , to be mapped onto
resources on the antenna ports used for transmission, where represents the
signal for antenna port . The PDCCH shall be transmitted on the same set of
antenna ports as the PBCH.
### 6.8.5 Mapping to resource elements
The mapping to resource elements is defined by operations on quadruplets of
complex-valued symbols. Let denote symbol quadruplet for antenna port.
The block of quadruplets , where , shall be permuted resulting in . The
permutation shall be according to the sub-block interleaver in clause
5.1.4.2.1 of 3GPP TS 36.212 [3] with the following exceptions:
\- the input and output to the interleaver is defined by symbol quadruplets
instead of bits
\- interleaving is performed on symbol quadruplets instead of bits by
substituting the terms \"bit\", \"bits\" and \"bit sequence\" in clause
5.1.4.2.1 of 3GPP TS 36.212 [3] by \"symbol quadruplet\", \"symbol
quadruplets\" and \"symbol-quadruplet sequence\", respectively
\ elements at the output of the interleaver in 3GPP TS 36.212 [3] shall
be removed when forming . Note that the removal of \ elements does not
affect any \ elements inserted in clause 6.8.2.
The block of quadruplets shall be cyclically shifted, resulting in where.
Mapping of the block of quadruplets is defined in terms of resource-element
groups, specified in clause 6.2.4, according to steps 1--10 below:
1) Initialize (resource-element group number)
2) Initialize
3) Initialize
4) If the resource element represents a resource-element group and the
resource-element group is not assigned to PCFICH or PHICH then perform step 5
and 6, else go to step 7
5) Map symbol-quadruplet to the resource-element group represented by for each
antenna port
6) Increase by 1
7) Increase by 1
8) Repeat from step 4 if , where corresponds to the number of OFDM symbols
used for PDCCH transmission as indicated by the sequence transmitted on the
PCFICH
9) Increase by 1
10) Repeat from step 3 if
## 6.8A Enhanced physical downlink control channel
For frame structure type 3, for a subframe with the same duration as the DwPTS
duration of a special subframe configuration, the enhanced physical downlink
control channel is defined the same as that for the corresponding special
subframe configuration.
### 6.8A.1 EPDCCH formats
The enhanced physical downlink control channel (EPDCCH) carries scheduling
assignments. An enhanced physical downlink control channel is transmitted
using an aggregation of one or several consecutive enhanced control channel
elements (ECCEs) where each ECCE consists of multiple enhanced resource
element groups (EREGs), defined in clause 6.2.4A. The number of ECCEs used for
one EPDCCH depends on the EPDCCH format as given by Table 6.8A.1-2 and the
number of EREGs per ECCE is given by Table 6.8A.1-1. Both localized and
distributed transmission is supported.
An EPDCCH can use either localized or distributed transmission, differing in
the mapping of ECCEs to EREGs and PRB pairs.
A UE shall monitor multiple EPDCCHs as defined in 3GPP TS 36.213 [4]. One or
two sets of physical resource-block pairs which a UE shall monitor for EPDCCH
transmissions can be configured. All EPDCCH candidates in EPDCCH set use
either only localized or only distributed transmission as configured by higher
layers. Within EPDCCH set in subframe , the ECCEs available for transmission
of EPDCCHs are numbered from 0 to and ECCE number corresponds to
\- EREGs numbered in PRB index for localized mapping, and
\- EREGs numbered in PRB indices for distributed mapping,
where , is the number of EREGs per ECCE, and is the number of ECCEs per
resource-block pair. The physical resource-block pairs constituting EPDCCH set
are in this paragraph assumed to be numbered in ascending order from 0 to .
Table 6.8A.1-1: Number of EREGs per ECCE,
Normal cyclic prefix Extended cyclic prefix
* * *
Normal subframe Special subframe, configuration 3, 4, 8 Special subframe,
configuration 1, 2, 6, 7, 9 Normal subframe Special subframe, configuration 1,
2, 3, 5, 6 4 8
Table 6.8A.1-2: Supported EPDCCH formats
EPDCCH format Number of ECCEs for one EPDCCH,
* * *
                  Case A                            Case B                                              
                  Localized transmission            Distributed transmission   Localized transmission   Distributed transmission
0 2 2 1 1 1 4 4 2 2 2 8 8 4 4 3 16 16 8 8 4 - 32 - 16
Case A in Table 6.8A.1-2 is used when the conditions corresponding to case 1
in clause 9.1.4 of 3GPP TS 36.213 [4] are satisfied, otherwise case B is used.
The quantity for a particular UE and referenced in 3GPP TS 36.213 [4] is
defined as the number of downlink resource elements available for EPDCCH
transmission in a physical resource-block pair configured for possible EPDCCH
transmission of EPDCCH set and fulfilling all of the following criteria:
\- they are part of any one of the 16 EREGs in the physical resource-block
pair, and
\- they are assumed by the UE not to be used for cell-specific reference
signals, where the positions of the cell-specific reference signals are given
by clause 6.10.1.2 with the number of antenna ports for and the frequency
shift of cell-specific reference signals derived as described in clause
6.10.1.2 unless other values for these parameters are provided by clause
9.1.4.3 in 3GPP TS 36.213 [4], and-
\- they are assumed by the UE not to be used for transmission of CSI reference
signals, where the positions of the CSI reference signals are given by clause
6.10.5.2 with the configuration for zero power CSI reference signals obtained
as described in clause 6.10.5.2 unless other values are provided by clause
9.1.4.3 in 3GPP TS 36.213 [4], and with the configuration for non-zero power
CSI reference signals obtained as described in clause 6.10.5.2, and
\- for frame structure type 1 and 2, the index in the first slot in a subframe
fulfils where is given by clause 9.1.4.1 of 3GPP TS 36.213 [4], and
\- for frame structure type 3,
\- if the higher layer parameter _subframeStartPosition_ indicates \'s07\' and
if the downlink transmission starts in the second slot of a subframe
\- the index in the second slot in the subframe fulfils where is given by
clause 9.1.4.1 of 3GPP TS 36.213 [4],
\- otherwise
\- the index in the first slot in the subframe fulfils where is given by
clause 9.1.4.1 of 3GPP TS 36.213 [4].
### 6.8A.2 Scrambling
The block of bits to be transmitted on an EPDCCH in a subframe shall be
scrambled, resulting in a block of scrambled bits according to
where the UE-specific scrambling sequence is given by clause 7.2. The
scrambling sequence generator shall be initialized with where is the EPDCCH
set number.
### 6.8A.3 Modulation
The block of scrambled bits shall be modulated as described in clause 7.1,
resulting in a block of complex-valued modulation symbols . Table 6.8A.3-1
specifies the modulation mappings applicable for the enhanced physical
downlink control channel.
Table 6.8A.3-1: EPDCCH modulation schemes
Physical channel Modulation schemes
* * *
EPDCCH QPSK
### 6.8A.4 Layer mapping and precoding
The block of complex-valued modulation symbols shall be mapped to a single
layer and precoded according to 6.3.4.1 as for , .
### 6.8A.5 Mapping to resource elements
The block of complex-valued symbols shall be mapped in sequence starting with
to resource elements on the associated antenna port which meet all of the
following criteria:
\- they are part of the EREGs assigned for the EPDCCH transmission, and
\- they are assumed by the UE not to be used for cell-specific reference
signals, where the positions of the cell-specific reference signals are given
by clause 6.10.1.2 with the number of antenna ports for and the frequency
shift of cell-specific reference signals derived as described in clause
6.10.1.2 unless other values for these parameters are provided by clause
9.1.4.3 in 3GPP TS 36.213 [4], and
\- they are assumed by the UE not to be used for transmission of:
\- zero-power CSI reference signals, where the positions of the CSI reference
signals are given by clause 6.10.5.2. The configuration for zero power CSI
reference signals is
\- obtained as described in clause 6.10.5.2 unless other values are provided
by clause 9.1.4.3 in 3GPP TS 36.213 [4], and
\- obtained by higher-layer configuration of up to five reserved CSI-RS
resources as part of the discovery signal configuration following the
procedure for zero-power CSI-RS in clause 6.10.5.2.
\- non-zero-power CSI reference signals for CSI reporting with the
configuration for non-zero power CSI reference signals for CSI reporting
obtained as described in clause 6.10.5.2, and
\- for frame structure type 1 and 2, the index in the first slot in a subframe
fulfils where is given by clause 9.1.4.1 of 3GPP TS 36.213 [4], and
\- for frame structure type 3,
\- if the higher layer parameter _subframeStartPosition_ indicates \'s07\' and
if the downlink transmission starts in the second slot of a subframe
\- the index in the second slot in the subframe fulfils where is given by
clause 9.1.4.1 of 3GPP TS 36.213 [4],
\- otherwise
\- the index in the first slot in the subframe fulfils where is given by
clause 9.1.4.1 of 3GPP TS 36.213 [4].
The mapping to resource elements on antenna port meeting the criteria above
shall be in increasing order of first the index and then the index, starting
with the first slot and ending with the second slot in a subframe.
For localized transmission, the single antenna port to use is given by Table
6.8A.5-1 with
where is the lowest ECCE index used by this EPDCCH transmission in the EPDCCH
set, equals the C-RNTI, and is the number of ECCEs used for this EPDCCH.
Table 6.8A.5-1: Antenna port to use for localized EPDCCH transmission
+---+------------------------+------------------------------+--------------+ | | Normal cyclic prefix | Extended cyclic prefix | | +===+========================+==============================+==============+ | | Normal subframes, | Special subframes,\ | Any subframe | | | | configurations 1, 2, 6, 7, 9 | | | | Special subframes,\ | | | | | configurations 3, 4, 8 | | | +---+------------------------+------------------------------+--------------+ | 0 | 107 | 107 | 107 | +---+------------------------+------------------------------+--------------+ | 1 | 108 | 109 | 108 | +---+------------------------+------------------------------+--------------+ | 2 | 109 | - | - | +---+------------------------+------------------------------+--------------+ | 3 | 110 | - | - | +---+------------------------+------------------------------+--------------+
For distributed transmission, each resource element in an EREG is associated
with one out of two antenna ports in an alternating manner, starting with
antenna port 107, where for normal cyclic prefix and for extended cyclic
prefix.
## 6.8B MTC physical downlink control channel
### 6.8B.1 MPDCCH formats
The MPDCCH formats are defined as in Clause 6.8A.1 with the following
exceptions:
\- The term EPDCCH is replaced by MPDCCH.
\- The MTC physical downlink control channel carries downlink control
information and is transmitted across consecutive BL/CE DL subframes. Within
each of the BL/CE DL subframes an MPDCCH is transmitted using an aggregation
of one or several consecutive enhanced control channel elements (ECCEs) where
each ECCE consists of multiple enhanced resource element groups (EREGs),
defined in clause 6.2.4A.
\- For frame structure type 2,
\- If repetition is not configured for the MPDCCH, the number of EREGs per
ECCE is given by Table 6.8A.1-1. If repetition is configured for the MPDCCH,
the number of EREGs per ECCE is given by Table 6.8B.1-1.
\- For those special subframes where the MPDCCH is not supported, these
special subframes are considered BL/CE DL subframes for both MPDCCH and PDSCH
transmission, only if they are indicated as BL/CE DL subframe by higher layer
signalling.
\- For an MPDCCH associated with 2 or 4 PRBs, if repetition is not configured
for the MPDCCH, the supported MPDCCH formats are given by Table 6.8A.1-2.
Otherwise, the supported MPDCCH formats are given by Table 6.8B.1-2. However,
for MPDCCH format 5, the equation defining the relation between ECCE index and
EREG index does not apply and the number of ECCEs refers to the MPDCCH mapping
to the REs of the 2+4 PRB set as defined in section 6.8B.5.
Table 6.8B.1-1: Number of EREGs per ECCE, , for frame structure type 2.
Normal cyclic prefix Extended cyclic prefix
* * *
Normal subframe Special subframe, configuration 3, 4, 8 Normal subframe
Special subframe, configuration 1, 2, 3, 5, 6 4 8
Table 6.8B.1-2: Supported MPDCCH formats
MPDCCH format Number of ECCEs in a subframe for one MPDCCH,
* * *
                  =4                                              =8                                                  
                  Localized transmission                          Distributed transmission   Localized transmission   Distributed transmission
0 2 2 1 1 1 4 4 2 2 2 8 8 4 4 3 16 16 8 8 4 - - - - 5 24 24 12 12
### 6.8B.2 Scrambling
Scrambling shall be perfomed according to Clause 6.8A.2 with EPDCCH replaced
by MPDCCH except that the same scrambling sequence is applied per subframe to
MPDCCH for a given block of subframes and is the MPDCCH set number. For an
MPDCCH associated with a 2+4 PRB set as defined in [4], is used to generate
the scrambling sequence for mapping to REs in 6 PRBs as well as 2 PRBs and 4
PRBs.
The subframe number of the first subframe in each block of consecutive
subframes, denoted as , satisfies . For the block of subframes, the scrambling
sequence generator shall be initialised with
where
and is the absolute subframe number of the first downlink subframe intended
for the MPDCCH. The MPDCCH transmission spans consecutive subframes, including
subframes that are not BL/CE DL subframes where the MPDCCH transmission is
postponed.
For BL/CE UEs,
\- if the MPDCCH transmission is associated with P-RNTI:
\- for frame structure type 1 and for frame structure type 2
\- otherwise
\- for UEs assuming CEModeA (according to the definition in section 12 of [4])
or configured with CEModeA:
\- for frame structure type 1 and for frame structure type 2 for UEs assuming
CEModeB (according to the definition in section 12 of [4]) or configured with
CEModeB.
### 6.8B.3 Modulation
Modulation shall be performed according to 6.8A.3 with EPDCCH replaced by
MPDCCH.
### 6.8B.4 Layer mapping and precoding
Layer mapping and precoding shall be done according to Clause 6.8A.4 with
EPDCCH replaced by MPDCCH.
### 6.8B.5 Mapping to resource elements
Mapping to resource elements shall be done according to Clause 6.8A.5with the
following exceptions:
\- The term EPDCCH shall be replaced by MPDCCH.
\- The mapping shall be repeated across each of the BL/CE DL subframes.
\- is the number of ECCEs used for this MPDCCH in the first of the subframes.
\- For an MPDCCH associated with a 2+4 PRB set as defined in [4], the mapping
to resource elements on antenna port shall be in increasing order of first the
index and then the index over the 6 PRBs for MPDCCH format 5 and over the 2 or
4 PRBs for the other MPDCCH formats.
\- For localized transmission and MPDCCH format 5, the single antenna port to
use is given by Table 6.8A.5-1 with
> where equals the C-RNTI.
\- Resource elements occupied by CSI reference signals shall be counted in the
MPDCCH mapping but not used for transmission of the MPDCCH.
\- The UE may assume there is no MPDCCH transmission which uses overlapping
sets of subframes as PDSCH transmissions to that UE, where the MPDCCH is
located at a different narrowband than the PDSCH.
\- For BL/CE UEs in CEModeB, in MBSFN subframe(s), resource elements that
correspond to the positions of cell-specific reference signals as in subframe
#0 shall not be counted in the MPDCCH mapping and not used for transmission of
the MPDCCH.
\- Resource elements belonging to synchronization signals, the core part of
PBCH, PBCH repetitions , or resource elements reserved for reference signals
in the mapping operation of PBCH but not used for transmission of reference
signals, shall be counted in the MPDCCH mapping but not used for transmission
of the MPDCCH.
\- In the subframes where an MPDCCH or its associated PDSCH is transmitted in
response to a physical random access transmission initiated by a PDCCH order,
the UE shall receive the MPDCCH or its associated PDSCH, and assume no other
UE-specific reception is needed.
\- For MPDCCH transmission associated with C-RNTI or TPC-PUCCH-RNTI or TPC-
PUSCH-RNTI or SPS C-RNTI that are not configured to use the Type2-MPDCCH
common search space, frequency hopping of the MPDCCH is enabled when higher
layer parameter _mpdcch-pdsch-HoppingConfig_ is set.
\- For MPDCCH transmission associated with Type2-MPDCCH common search space,
frequency hopping of the MPDCCH is enabled when higher layer parameter _rar-
HoppingConfig_ is set. Further
\- if PRACH CE level 0 or 1 is used for the last PRACH attempt, is set to the
higher layer parameter _interval-DlHoppingConfigCommonModeA_ ;
\- if PRACH CE level 2 or 3 is used for the last PRACH attempt, is set to the
higher layer parameter _interval-DlHoppingConfigCommonModeB_.
\- The narrowband for MPDCCH transmission in the first subframe of MPDCCH
search space is provided by higher layers. Starting subframe configuration of
a search space where UE monitors an MPDCCH is also provided by higher layers.
The MPDCCH search space uses subframes, spanning consecutive subframes,
including subframes that are not BL/CE DL subframes where the MPDCCH
transmission is postponed.
\- If frequency hopping is not enabled for MPDCCH, the repetitions of an
MPDCCH candidate are located at the same PRB resources in the same narrowband
, and
\- if frequency hopping is enabled for MPDCCH, an MPDCCH candidate shall be
transmitted in absolute subframe using the same PRB resources within each
narrowband
where is the absolute subframe number of the first downlink subframe of MPDCCH
search space, and , and are cell-specific higher-layer parameters. The UE
shall not expect MPDCCH transmission in absolute subframe if it is not a BL/CE
DL subframe.
\- The UE may assume the same precoding matrix being used for a PRB across a
block of consecutive subframes for MPDCCH, where the subframe number of the
first subframe in each block of consecutive subframes, denoted as , satisfies
.
The UE may assume that an MPDCCH associated with the P-RNTI is transmitted on
the set of narrowbands where is defined in section 6.4.1. For a UE monitoring
an MPDCCH associated with the P-RNTI, the first MPDCCH narrowband is given by
where , is the Paging Narrowband (PN) obtained according to [10], and is the
higher-layer parameter _paging-narrowBands_.
\- If the higher-layer parameter _si-HoppingConfigCommon_ disables frequency
hopping for an MPDCCH associated with P-RNTI, each MPDCCH candidate shall be
located in the same PRB in narrowband where .
\- If the higher-layer parameter _si-HoppingConfigCommon_ enables frequency
hopping for an MPDCCH with P-RNTI, an MPDCCH candidate shall be located in
narrowband in absolute subframe using the same PRB resources within each
narrowband where
where is the absolute subframe number of the first downlink subframe of MPDCCH
search space according to locations of paging opportunity subframes, and , and
are cell-specific higher-layer parameters. For MPDCCH associated with P-RNTI,
if _interval-DlHoppingConfigCommonModeB_ is signalled in SIB1-BR, then the
frequency hopping granularity is set to _interval-DlHoppingConfigCommonModeB_
; otherwise, is set to _interval-DlHoppingConfigCommonModeA_ signalled in
SIB1-BR.
The UE shall not expect MPDCCH transmission in absolute subframe if it is not
a BL/CE DL subframe.
## 6.9 Physical hybrid ARQ indicator channel
The PHICH carries the hybrid-ARQ ACK/NACK. Multiple PHICHs mapped to the same
set of resource elements constitute a PHICH group, where PHICHs within the
same PHICH group are separated through different orthogonal sequences. A PHICH
resource is identified by the index pair , where is the PHICH group number and
is the orthogonal sequence index within the group.
For frame structure type 1 and type 3, the number of PHICH groups is constant
in all subframes and given by
where is provided by higher layers. The index ranges from to .
For frame structure type 2, the number of PHICH groups may vary between
subframes and is given by where is given by the expression above and is given
by Table 6.9-1 with the uplink-downlink configuration provided by the higher-
layer parameter _subframeAssignment_. The index in a subframe with non-zero
PHICH resources ranges from to .
Table 6.9-1: The factor for frame structure type 2
* * *
Uplink-downlink\ Subframe number  
configuration
* * *
                     0                 1   2   3   4   5   6   7   8   9
0 2 1 0 0 0 2 1 0 0 0
1 0 1 0 0 1 0 1 0 0 1
2 0 0 0 1 0 0 0 0 1 0
3 1 0 0 0 0 0 0 0 1 1
4 0 0 0 0 0 0 0 0 1 1
5 0 0 0 0 0 0 0 0 1 0
6 1 1 0 0 0 1 1 0 0 1
* * *
### 6.9.1 Modulation
The block of bits transmitted on one PHICH in one subframe shall be modulated
as described in clause 7.1, resulting in a block of complex-valued modulation
symbols, where . Table 6.9.1-1 specifies the modulation mappings applicable
for the physical hybrid ARQ indicator channel.
Table 6.9.1-1: PHICH modulation schemes.
Physical channel Modulation schemes
* * *
PHICH BPSK
The block of modulation symbols shall be symbol-wise multiplied with an
orthogonal sequence and scrambled, resulting in a sequence of modulation
symbols according to
where
and is a cell-specific scrambling sequence generated according to clause 7.2.
The scrambling sequence generator shall be initialised with at the start of
each subframe.
The sequence is given by Table 6.9.1-2 where the sequence index corresponds to
the PHICH number within the PHICH group.
Table 6.9.1-2: Orthogonal sequences for PHICH
Sequence index Orthogonal sequence
* * *
                   Normal cyclic prefix   Extended cyclic prefix
0  
1  
2  
3  
4 - 5 - 6 - 7 -
### 6.9.2 Resource group alignment, layer mapping and precoding
The block of symbols should be first aligned with resource element group size,
resulting in a block of symbols , where for normal cyclic prefix; and for
extended cyclic prefix.
For normal cyclic prefix, , for .
For extended cyclic prefix,
for .
The block of symbols shall be mapped to layers and precoded, resulting in a
block of vectors , , where represents the signal for antenna port , and the
number of cell-specific reference signals . The layer mapping and precoding
operation depends on the cyclic prefix length and the number of antenna ports
used for transmission of the PHICH. The PHICH shall be transmitted on the same
set of antenna ports as the PBCH.
For transmission on a single antenna port, , layer mapping and precoding are
defined by clauses 6.3.3.1 and 6.3.4.1, respectively, with .
For transmission on two antenna ports, , layer mapping and precoding are
defined by clauses 6.3.3.3 and 6.3.4.3, respectively, with .
For transmission on four antenna ports, , layer mapping is defined by clause
6.3.3.3 with and precoding by
if for normal cyclic prefix, or for extended cyclic prefix, where is the PHICH
group number and , and by
otherwise for .
### 6.9.3 Mapping to resource elements
The sequence for each of the PHICH groups is defined by
where the sum is over all PHICHs in the PHICH group and represents the symbol
sequence from the :th PHICH in the PHICH group.
PHICH groups are mapped to PHICH mapping units.
For normal cyclic prefix, the mapping of PHICH group to PHICH mapping unit is
defined by
where
,
and where is given by Table 6.9-1.
For extended cyclic prefix, the mapping of PHICH group and to PHICH mapping
unit is defined by
where
and where is given by Table 6.9-1.
Let , denote symbol quadruplet for antenna port. Mapping to resource elements
is defined in terms of symbol quadruplets according to steps 1--10 below:
1) For each value of
2) Let denote the number of resource element groups not assigned to PCFICH in
OFDM symbol
3) Number the resource-element groups not assigned to PCFICH in OFDM symbol
from 0 to, starting from the resource-element group with the lowest frequency-
domain index.
4) Initialize (PHICH mapping unit number)
5) For each value of
6) Symbol-quadruplet from PHICH mapping unit is mapped to the resource-element
group represented by as defined in clause 6.2.4 where the indices and are
given by steps 7 and 8 below:
7) The time-domain index is given by
8) Set the frequency-domain index to the resource-element group assigned the
number in step 3 above, where is given by
in case of extended PHICH duration in MBSFN subframes, or extended PHICH
duration in subframes 1 and 6 for frame structure type 2, or extended PHICH
duration in subframe with the same duration as the DwPTS duration of a special
subframe configuration in frame structure type 3 and by
otherwise.
9) Increase by 1.
10) Repeat from step 5 until all PHICH mapping units have been assigned.
The PHICH duration is configurable by higher layers according to Table
6.9.3-1.
Table 6.9.3-1: PHICH duration in MBSFN and non-MBSFN subframes
+---------------+---------------+---------------+---------------+---+ | PHICH | Non-MBSFN | MBSFN | | | | duration | subframes | subframes | | | | | | | | | | | | on a carrier | | | | | | supporting | | | | | | PDSCH | | | +===============+===============+===============+===============+===+ | | Subframes 1 | Subframe with | All other | | | | and 6 | the same | cases | | | | | duration as | | | | | in case of | the DwPTS | | | | | frame | duration of a | | | | | structure | specifial | | | | | type 2 | subframe | | | | | | configuration | | | | | | in case of | | | | | | frame | | | | | | structure | | | | | | type 3 | | | +---------------+---------------+---------------+---------------+---+ | Normal | 1 | 1 | 1 | 1 | +---------------+---------------+---------------+---------------+---+ | Extended | 2 | 2 | 3 | 2 | +---------------+---------------+---------------+---------------+---+
## 6.10 Reference signals
Six types of downlink reference signals are defined:
\- Cell-specific Reference Signal (CRS)
\- MBSFN reference signal
\- UE-specific Reference Signal (DM-RS) associated with PDSCH
\- DeModulation Reference Signal (DM-RS) associated with EPDCCH or MPDCCH
\- Positioning Reference Signal (PRS)
\- CSI Reference Signal (CSI-RS)
There is one reference signal transmitted per downlink antenna port.
### 6.10.1 Cell-specific Reference Signal (CRS)
The UE may assume cell-specific reference signals are, unless otherwise stated
in [4, clause 12], transmitted in
\- all downlink subframes for frame structure type 1,
\- all downlink subframes and DwPTS for frame structure type 2,
\- non-empty subframes for frame structure type 3
in a cell supporting PDSCH transmission.
Cell-specific reference signals are transmitted on one or several of antenna
ports 0 to 3.
Cell-specific reference signals are defined for only.
#### 6.10.1.1 Sequence generation
The reference-signal sequence is defined by
where is the slot number within a radio frame and is the OFDM symbol number
within the slot. The pseudo-random sequence is defined in clause 7.2. The
pseudo-random sequence generator shall be initialised with at the start of
each OFDM symbol where
#### 6.10.1.2 Mapping to resource elements
The reference signal sequence shall be mapped to complex-valued modulation
symbols used as reference symbols for antenna port in slot according to
where
The variables and define the position in the frequency domain for the
different reference signals where is given by
The cell-specific frequency shift is given by .
Resource elements used for transmission of cell-specific reference signals on
any of the antenna ports in a slot shall not be used for any transmission on
any other antenna port in the same slot and set to zero.
In an MBSFN subframe, cell-specific reference signals shall only be
transmitted in the non-MBSFN region of the MBSFN subframe.
Figures 6.10.1.2-1 and 6.10.1.2-2 illustrate the resource elements used for
reference signal transmission according to the above definition. The notation
is used to denote a resource element used for reference signal transmission on
antenna port.
Figure 6.10.1.2-1. Mapping of downlink reference signals (normal cyclic
prefix)
Figure 6.10.1.2-2. Mapping of downlink reference signals (extended cyclic
prefix)
### 6.10.2 MBSFN reference signals
MBSFN reference signals shall be transmitted in the MBSFN region of MBSFN
subframes only when the PMCH is transmitted. MBSFN reference signals are
transmitted on antenna port 4.
MBSFN reference signals are defined for extended cyclic prefix only.
#### 6.10.2.1 Sequence generation
The MBSFN reference-signal sequence is defined by
where is the slot number within a radio frame and is the OFDM symbol number
within the slot. The pseudo-random sequence is defined in clause 7.2. The
pseudo-random sequence generator shall be initialised with at the start of
each OFDM symbol.
#### 6.10.2.2 Mapping to resource elements
The reference-signal sequence in OFDM symbol shall be mapped to complex-valued
modulation symbols with according to
where
Figure 6.10.2.2-1 illustrates the resource elements used for MBSFN reference
signal transmission in case of . In case of for a MBSFN-dedicated cell, the
MBSFN reference signal shall be mapped to resource elements according to
Figure 6.10.2.2-3. The notation is used to denote a resource element used for
reference signal transmission on antenna port.
Figure 6.10.2.2-1: Mapping of MBSFN reference signals (extended cyclic prefix,
)
Figure 6.10.2.2-3: Mapping of MBSFN reference signals (extended cyclic prefix,
)
### 6.10.3 UE-specific reference signals associated with PDSCH
UE-specific reference signals associated with PDSCH
\- are transmitted on antenna port(s) , , , ,, or , where is the number of
layers used for transmission of the PDSCH;
\- are present and are a valid reference for PDSCH demodulation only if the
PDSCH transmission is associated with the corresponding antenna port according
to clause 7.1 of 3GPP TS 36.213 [4];
\- are transmitted only on the physical resource blocks upon which the
corresponding PDSCH is mapped.
A UE-specific reference signal associated with PDSCH is not transmitted in
resource elements in which one of the physical channels or physical signals
other than the UE-specific reference signals defined in 6.1 are transmitted
using resource elements with the same index pair regardless of their antenna
port .
For frame structure type 3, for PDSCH in a subframe with the same duration as
the DwPTS duration of a special subframe configuration, the UE-specific
reference signals are defined the same as that for the corresponding special
subframe configuration.
#### 6.10.3.1 Sequence generation
For antenna port 5, the UE-specific reference-signal sequence is defined by
where denotes the assigned bandwidth in resource blocks of the corresponding
PDSCH transmission. The pseudo-random sequence is defined in clause 7.2. The
pseudo-random sequence generator shall be initialised with at the start of
each subframe where is as described in clause 7.1 3GPP TS 36.213 [4].
For any of the antenna ports , the reference-signal sequence is defined by
.
The pseudo-random sequence is defined in clause 7.2. The pseudo-random
sequence generator shall be initialised with
at the start of each subframe.
For BL/CE UEs, the same scrambling sequence is applied per subframe to the UE-
specific reference-signal sequence for a given block of subframes. The
subframe number of the first subframe in each block of consecutive subframes,
denoted as , satisfies . For the block of subframes, the scrambling sequence
generator shall be initialised with
where
and is the absolute subframe number of the first downlink subframe intended
for PDSCH. The PDSCH transmissions span consecutive subframes, including
subframes that are not BL/CE DL subframes where the PDSCH transmission is
postponed. For a BL/CE UE configured in CEModeA, . For a BL/CE UE configured
with CEModeB, for frame structure type 1 and for frame structure type 2.
The quantities , , are given by
\- if no value for is provided by higher layers or if DCI format 1A, 2B or 2C
is used for the DCI associated with the PDSCH transmission
\- otherwise
The value of is zero unless specified otherwise. For a PDSCH transmission on
ports 7 or 8, is given by the DCI format 2B, 2C, 2D or 6-1A in 3GPP TS 36.212
[3] associated with the PDSCH transmission.\ In the case of DCI format 2B, is
indicated by the scrambling identity field according to Table 6.10.3.1-1. In
the case of DCI format 2C or 2D, is given by Table 5.3.3.1.5C-1 or Table
5.3.3.1.5C-2 in 3GPP TS 36.212 [3]. For a PDSCH transmission on ports 11 or
13, is given by the DCI format 2C or 2D in 3GPP TS 36.212 [3] associated with
the PDSCH transmission where is given by Table 5.3.3.1.5C-2 in 3GPP TS 36.212
[3].
Table 6.10.3.1-1: Mapping of scrambling identity field in DCI format 2B to
values for antenna ports 7 and 8
+------------------------------+--------------------------+ | Scrambling identity field in | | | | | | DCI format 2B | | | | | | (3GPP TS 36.212 [3]) | | +==============================+==========================+ | 0 | 0 | +------------------------------+--------------------------+ | 1 | 1 | +------------------------------+--------------------------+
#### 6.10.3.2 Mapping to resource elements
For antenna port 5, in a physical resource block with frequency-domain index
assigned for the corresponding PDSCH transmission, the reference signal
sequence shall be mapped to complex-valued modulation symbols with in a
subframe according to:
Normal cyclic prefix:
Extended cyclic prefix:
where is the counter of UE-specific reference signal resource elements within
a respective OFDM symbol of the PDSCH transmission.
The cell-specific frequency shift is given by .
The mapping shall be in increasing order of the frequency-domain index of the
physical resource blocks assigned for the corresponding PDSCH transmission.
The quantity denotes the assigned bandwidth in resource blocks of the
corresponding PDSCH transmission.
Figure 6.10.3.2-1 illustrates the resource elements used for UE-specific
reference signals for normal cyclic prefix for antenna port 5.
Figure 6.10.3.2-2 illustrates the resource elements used for UE-specific
reference signals for extended cyclic prefix for antenna port 5.
The notation is used to denote a resource element used for reference signal
transmission on antenna port.
Figure 6.10.3.2-1: Mapping of UE-specific reference signals, antenna port 5
(normal cyclic prefix)
Figure 6.10.3.2-2: Mapping of UE-specific reference signals, antenna port 5
(extended cyclic prefix)
For antenna ports , ,,, or , in a physical resource block with frequency-
domain index assigned for the corresponding PDSCH transmission, a part of the
reference signal sequence shall be mapped to complex-valued modulation symbols
in a subframe according to
Normal cyclic prefix:
where
The sequence is given by Table 6.10.3.2-1.
Table 6.10.3.2-1: The sequence for normal cyclic prefix
Antenna port
* * *
7 8 9 10 11 12 13 14
Extended cyclic prefix:
where
The sequence is given by Table 6.10.3.2-2.
Table 6.10.3.2-2: The sequence for extended cyclic prefix
Antenna port
* * *
7 8
For extended cyclic prefix, UE-specific reference signals are not supported on
antenna ports 9 to 14.
Resource elements used for transmission of UE-specific reference signals to
one UE on any of the antenna ports in the set , where or shall
\- not be used for transmission of PDSCH on any antenna port in the same slot,
and
\- not be used for UE-specific reference signals to the same UE on any antenna
port other than those in in the same slot.
Figure 6.10.3.2-3 illustrates the resource elements used for UE-specific
reference signals for normal cyclic prefix for antenna ports 7, 8, 9 and 10\.
Figure 6.10.3.2-4 illustrates the resource elements used for UE-specific
reference signals for extended cyclic prefix for antenna ports 7, 8.
Figure 6.10.3.2-3: Mapping of UE-specific reference signals, antenna ports 7,
8, 9 and 10 (normal cyclic prefix)
Figure 6.10.3.2-4: Mapping of UE-specific reference signals, antenna ports 7
and 8 (extended cyclic prefix)
### 6.10.3A Demodulation reference signals associated with EPDCCH or MPDCCH
The demodulation reference signal associated with EPDCCH/MPDCCH
\- is transmitted on the same antenna port as the associated EPDCCH/MPDCCH
physical resource;
\- is present and is a valid reference for EPDCCH/MPDCCH demodulation only if
the EPDCCH/MPDCCH transmission is associated with the corresponding antenna
port;
\- is transmitted only on the physical resource blocks upon which the
corresponding EPDCCH/MPDCCH is mapped.
A demodulation reference signal associated with EPDCCH/MPDCCH is not
transmitted in resource elements in which one of the physical channels or
physical signals other than the demodulation reference signals defined in 6.1
are transmitted using resource elements with the same index pair regardless of
their antenna port .
#### 6.10.3A.1 Sequence generation
For any of the antenna ports , the reference-signal sequence is defined by
.
For non-BL/CE UEs, the pseudo-random sequence is defined in clause 7.2. The
pseudo-random sequence generator shall be initialised with
at the start of each subframe where and is configured by higher layers. The
EPDCCH set to which the EPDCCH associated with the demodulation reference
signal belong is denoted .
For BL/CE UEs, the same scrambling sequence is applied per subframe to the
demodulation reference signal associated with MPDCCH for a given block of
subframes. The subframe number of the first subframe in each block of
consecutive subframes, denoted as , satisfies . For the block of subframes,
the scrambling sequence generator shall be initialised with
where
and is the absolute subframe number of the first downlink subframe intended
for MPDCCH. The MPDCCH transmissions span consecutive subframes, including
subframes that are not BL/CE DL subframes where the MPDCCH transmission is
postponed.
For BL/CE UEs,
\- if the MPDCCH transmission is associated with P-RNTI:
\- {width="0.5333333333333333in" height="0.20833333333333334in"} for frame
structure type 1 and {width="0.5833333333333334in"
height="0.20833333333333334in"} for frame structure type 2
\- otherwise
\- {width="0.5083333333333333in" height="0.20833333333333334in"}for UEs
assuming CEModeA (according to the definition in section 12 of [4]) or
configured with CEModeA.
\- {width="0.5333333333333333in" height="0.20833333333333334in"} for frame
structure type 1 and {width="0.5833333333333334in"
height="0.20833333333333334in"} for frame structure type 2 for UEs assuming
CEModeB (according to the definition in section 12 of [4]) or configured with
CEModeB.
The quantities and are configured by higher layers. The MPDCCH set to which
the MPDCCH associated with the demodulation reference signal belong is denoted
. For an MPDCCH associated with a 2+4 PRB set as defined in [4], is used to
generate the scrambling sequence for the 6 PRBs as well as for the 2 PRBs and
4 PRBs.
#### 6.10.3A.2 Mapping to resource elements
For the antenna port in a physical resource block assigned for the associated
EPDCCH/MPDCCH, a part of the reference signal sequence shall be mapped to
complex-valued modulation symbols in a subframe according to
Normal cyclic prefix:
where
The sequence is given by Table 6.10.3A.2-1.
Table 6.10.3A.2-1: The sequence for normal cyclic prefix
Antenna port
* * *
107 108 109 110
Extended cyclic prefix:
where
The sequence is given by Table 6.10.3A.2-2.
Table 6.10.3A.2-2: The sequence for extended cyclic prefix
Antenna port
* * *
107 108
For extended cyclic prefix, demodulation reference signals are not supported
on antenna ports 109 to 110.
Resource elements used for transmission of demodulation reference signals to
one UE on any of the antenna ports in the set , where or shall
\- not be used for transmission of EPDCCH/MPDCCH on any antenna port in the
same slot, and
\- not be used for demodulation reference signals to the same UE on any
antenna port other than those in in the same slot.
Replacing antenna port numbers 7 -- 10 by 107 -- 110 in Figure 6.10.3.2-3
provides an illustration of the resource elements used for demodulation
reference signals associated with EPDCCH/MPDCCH for normal cyclic prefix.
Replacing antenna port numbers 7 -- 8 by 107 -- 108 in Figure 6.10.3.2-4
provides an illustration of the resource elements used for demodulation
reference signals associated with EPDCCH/MPDCCH for extended cyclic prefix.
For frame structure type 3, for EPDCCH in a subframe with the same duration as
the DwPTS duration of a special subframe configuration, the mapping of the
demodulation reference signals to the resource elements is the same as that
for the corresponding special subframe configuration.
### 6.10.4 Positioning reference signals
Positioning reference signals shall only be transmitted in resource blocks in
downlink subframes configured for positioning reference signal transmission.
If both normal and MBSFN subframes are configured as positioning subframes
within a cell, the OFDM symbols in a MBSFN subframe configured for positioning
reference signal transmission shall use the same cyclic prefix as used for
subframe #0. If only MBSFN subframes are configured as positioning subframes
within a cell, the OFDM symbols configured for positioning reference signals
in the MBSFN region of these subframes shall use extended cyclic prefix
length. In a subframe configured for positioning reference signal
transmission, the starting positions of the OFDM symbols configured for
positioning reference signal transmission shall be identical to those in a
subframe in which all OFDM symbols have the same cyclic prefix length as the
OFDM symbols configured for positioning reference signal transmission.
Positioning reference signals are transmitted on antenna port 6.
The positioning reference signals shall not be mapped to resource elements
allocated to the core part of the PBCH, PSS or SSS regardless of their antenna
port .
Positioning reference signals are defined for only.
#### 6.10.4.1 Sequence generation
The reference-signal sequence is defined by
where is the slot number within a radio frame, is the OFDM symbol number
within the slot. The pseudo-random sequence is defined in clause 7.2. The
pseudo-random sequence generator shall be initialised with at the start of
each OFDM symbol where
#### 6.10.4.2 Mapping to resource elements
The reference signal sequence shall be mapped to complex-valued modulation
symbols used as reference signal for antenna port in slot according to
where
Normal cyclic prefix:
Extended cyclic prefix:
The bandwidth for positioning reference signals is configured by higher layers
and the cell-specific frequency shift is given by
{width="1.0833333333333333in" height="0.24166666666666667in"}.
Figure 6.10.4.2-1: Mapping of positioning reference signals (normal cyclic
prefix)
Figure 6.10.4.2-2: Mapping of positioning reference signals (extended cyclic
prefix)
#### 6.10.4.3 Positioning reference signal subframe configuration
The cell specific subframe configuration period and the cell specific subframe
offset for the transmission of positioning reference signals are listed in
Table 6.10.4.3-1. The PRS configuration index is configured by higher layers.
Positioning reference signals are transmitted only in configured DL subframes.
Positioning reference signals shall not be transmitted in DwPTS. Positioning
reference signals shall be transmitted in consecutive downlink subframes,
where is configured by higher layers.
The positioning reference signal instances, for the first subframe of the
downlink subframes, shall satisfy .
Table 6.10.4.3-1: Positioning reference signal subframe configuration
+----------------------+----------------------+----------------------+ | PRS configuration | PRS periodicity | PRS subframe offset | | Index | | | | | | (subframes) | (subframes) | +======================+======================+======================+ | 0 -- 159 | 160 | | +----------------------+----------------------+----------------------+ | 160 -- 479 | 320 | | +----------------------+----------------------+----------------------+ | 480 -- 1119 | 640 | | +----------------------+----------------------+----------------------+ | 1120 -- 2399 | 1280 | | +----------------------+----------------------+----------------------+ | 2400-4095 | Reserved | | +----------------------+----------------------+----------------------+
### 6.10.5 CSI reference signals
CSI reference signals are transmitted on one, two, four, eight, twelve, or
sixteen antenna ports using , , , , and , respectively.
For CSI reference signals using more than eight antenna ports, CSI-RS
configurations in the same subframe, numbered from 0 to , where value 0
corresponds to the configured _resourceConfig-r11_ or _resourceConfig-r10_ and
value _k_ (_k >_0) corresponds to the configured _k-_ th entry of _nzp-
resourceConfigList-r13_ , are aggregated to obtain antenna ports in total.
Each CSI-RS configuration in such an aggregation corresponds to antenna ports
and one of the configurations in the range 0-19 in Table 6.10.5.2-1 for normal
cyclic prefix, and one of the configurations in the range 0-15 in Table
6.10.5.2-2 for extended cyclic prefix. The supported configurations of
aggregated CSI-RS configurations are shown in Table 6.10.5-1.
CSI reference signals are defined for only.
Table 6.10.5-1: Aggregation of CSI-RS configurations.
* * *
Total number of\ Number of antenna ports per CSI-RS configuration\ Number of
CSI-RS configurations\ antenna ports\
* * *
12 4 3
16 8 2
* * *
#### 6.10.5.1 Sequence generation
The reference-signal sequence is defined by
where is the slot number within a radio frame and is the OFDM symbol number
within the slot. The pseudo-random sequence is defined in clause 7.2. The
pseudo-random sequence generator shall be initialised with at the start of
each OFDM symbol where
The quantity equals unless configured by higher layers.
#### 6.10.5.2 Mapping to resource elements
In subframes configured for CSI reference signal transmission, the reference
signal sequence shall be mapped to complex-valued modulation symbols used as
reference symbols on antenna port . The mapping depends on the higher-layer
parameter _CDMType_.
For the case of _CDMType_ not equal to CDM4:
where
For the case of _CDMType_ equal to _CDM4_ :
where
and where is given by Table 6.10.5.2-0.
Table 6.10.5.2-0: The sequence for _CDM4_.
{width="1.9166666666666667in" height="0.275in"}
* * *
{width="0.5833333333333334in" height="0.26666666666666666in"}
{width="0.5833333333333334in" height="0.26666666666666666in"}  
15 15,17 16 16,18 17 19,21 18 20,22
The quantity and the necessary conditions on are given by Tables 6.10.5.2-1
and 6.10.5.2-2 for normal and extended cyclic prefix, respectively.
The relation between the antenna port number and the quantity depends on the
number of CSI-RS antenna ports:
\- for CSI reference signals using up to eight antenna ports,
\- for CSI reference signals using more than eight antenna ports when the
higher-layer parameter _CDMType_ equals _CDM2_
where is the CSI-RS resource number.
\- for CSI reference signals using more than eight antenna ports the higher-
layer parameter _CDMType_ equals _CDM4_ , antenna port number where for CSI-RS
resource number .
Multiple CSI reference signal configurations can be used in a given cell. A UE
can be configured with multiple sets of CSI reference signals,
\- one or more configurations for CSI reporting for which the UE shall assume
non-zero transmission power for the CSI-RS, and
\- zero or more configurations for which the UE shall assume zero transmission
power, and
\- zero or more configurations valid across the system downlink bandwidth as
part of the discovery signals for which the UE shall assume non-zero
transmission power for the CSI-RS.
The CSI-RS configurations for which the UE shall assume non-zero transmission
power are provided by higher layers.
The CSI-RS configurations for which the UE shall assume zero transmission
power in a subframe are given by a bitmap derived according to clause 7.2.7 in
3GPP TS 36.213 [4]. For each bit set to one in the 16-bit bitmap, the UE shall
assume zero transmission power for the resource elements corresponding to the
four CSI reference signal column in Tables 6.10.5.2-1 and 6.10.5.2-2 for
normal and extended cyclic prefix, respectively, except for resource elements
that overlap with those for which the UE shall assume non-zero transmission
power CSI-RS as configured by higher layers. The most significant bit
corresponds to the lowest CSI reference signal configuration index and
subsequent bits in the bitmap correspond to configurations with indices in
increasing order.
CSI reference signals can only occur in
\- downlink slots where fulfils the condition in Tables 6.10.5.2-1 and
6.10.5.2-2 for normal and extended cyclic prefix, respectively, and
\- where the subframe number fulfils the conditions in clause 6.10.5.3.
The UE shall assume that CSI reference signals are not transmitted
\- in the DwPTS for special subframe configuration 0, 5 and 9 for normal
cyclic prefix and special subframe configuration 0, 4 and 7 for extended
cyclic prefix, in case of frame structure type 2,
\- in subframes where PDSCH/EPDCCH transmission starts in the second slot of a
subframe for frame structure type 3,
\- in subframes where PDSCH/EPDCCH transmission ends prior to the end of a
subframe for frame structure type 3,
\- in an empty subframe where there is no PDSCH or discovery signal
transmission for frame structure type 3,
\- in subframes where transmission of a CSI-RS would collide with
_SystemInformationBlockType1_ messages,
\- in the primary cell in subframes configured for transmission of paging
messages in the primary cell for any UE with the cell-specific paging
configuration.
For special subframe configuration {1, 2, 6, or 7}, a UE does not expect to be
configured with one of CSI-RS configurations {1, 2, 3, 4, 6, 7, 8, 9, 12, 13,
14, 15, 16, 17} in DwPTS for normal CP.
The UE shall assume that none of the CSI reference signals corresponding to a
CSI reference signal configuration are transmitted in subframes where
transmission of any of those CSI reference signals would collide with
transmission of synchronization signals or the core part of PBCH.
Resource elements used for transmission of CSI reference signals on any of the
antenna ports in the set , where , , , , , , , , or shall not be used for
transmission of PDSCH on any antenna port in the same slot if higher layer
parameter _CDMType_ is not configured, or is configured to _CDM2_.
Resource elements used for transmission of CSI reference signals on any of the
antenna ports in the set , where , or for CSI reference signals on 12 ports or
, , or for CSI reference signals on 16 ports shall not be used for
transmission of PDSCH on any antenna port in the same slot if higher layer
parameter _CDMType_ is configured to _CDM4_.
The mapping for CSI reference signal configuration 0 is illustrated in Figures
6.10.5.2-1 and 6.10.5.2-2.
Table 6.10.5.2-1: Mapping from CSI reference signal configuration to for
normal cyclic prefix
* * *
CSI-RS\ Number of CSI reference signals configured  
config.
* * *
            1 or 2                                       4                                                                                        8
            Normal subframe                              Special subframe                                                                         Normal subframe                                                                          Special subframe                                                                         Normal subframe                                                                          Special subframe
            ![](media/image1708.wmf)                     ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1710.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1711.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1710.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1711.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1711.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}
0 (9,5) 0 (9,5) 0 (9,5) 0 (9,5) 0 (9,5) 0 (9,5) 0
1 (11,2) 1 (11,5) 0 (11,2) 1 (11,5) 0 (11,2) 1 (11,5) 0
2 (9,2) 1 (9,2) 1 (9,2) 1 (9,2) 1 (9,2) 1 (9,2) 1
3 (7,2) 1 (7,5) 0 (7,2) 1 (7,5) 0 (7,2) 1 (7,5) 0
4 (9,5) 1 (9,5) 1 (9,5) 1
5 (8,5) 0 (8,5) 0 (8,5) 0 (8,5) 0
6 (10,2) 1 (10,5) 0 (10,2) 1 (10,5) 0
7 (8,2) 1 (8,2) 1 (8,2) 1 (8,2) 1
8 (6,2) 1 (6,5) 0 (6,2) 1 (6,5) 0
9 (8,5) 1 (8,5) 1
10 (3,5) 0 (3,5) 0
11 (2,5) 0 (2,5) 0
12 (5,2) 1 (5,5) 0
13 (4,2) 1 (4,5) 0
14 (3,2) 1 (3,2) 1
15 (2,2) 1 (2,2) 1
16 (1,2) 1 (1,5) 0
17 (0,2) 1 (0,5) 0
18 (3,5) 1
19 (2,5) 1
20 (11,1) 1 (11,1) 1 (11,1) 1
21 (9,1) 1 (9,1) 1 (9,1) 1
22 (7,1) 1 (7,1) 1 (7,1) 1
23 (10,1) 1 (10,1) 1
24 (8,1) 1 (8,1) 1
25 (6,1) 1 (6,1) 1
26 (5,1) 1
27 (4,1) 1
28 (3,1) 1
29 (2,1) 1
30 (1,1) 1
31 (0,1) 1
* * *
Note: . Configurations 0 -- 19 for normal subframes are available for frame
structure types 1, 2 and 3. Configurations 20 -- 31 and configurations for
special subframes are available for frame structure type 2 only.
Table 6.10.5.2-2: Mapping from CSI reference signal configuration to for
extended cyclic prefix.
* * *
CSI-RS\ Number of CSI reference signals configured  
config.
* * *
            1 or 2                                                                                   4                                                                                        8
            Normal subframe                                                                          Special subframe                                                                         Normal subframe                                                                          Special subframe                                                                         Normal Subframe                                                                          Special subframe
            ![](media/image1710.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1710.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1711.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1710.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1711.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}   ![](media/image1711.wmf){width="0.36666666666666664in" height="0.20833333333333334in"}   ![](media/image1709.wmf){width="0.16666666666666666in" height="0.20833333333333334in"}
0 (11,4) 0 (11,4) 0 (11,4) 0 (11,4) 0 (11,4) 0 (11,4) 0
1 (9,4) 0 (9,4) 0 (9,4) 0 (9,4) 0 (9,4) 0 (9,4) 0
2 (10,4) 1 (10,4) 1 (10,4) 1
3 (9,4) 1 (9,4) 1 (9,4) 1
4 (5,4) 0 (5,4) 0 (5,4) 0 (5,4) 0
5 (3,4) 0 (3,4) 0 (3,4) 0 (3,4) 0
6 (4,4) 1 (4,4) 1
7 (3,4) 1 (3,4) 1
8 (8,4) 0 (8,4) 0
9 (6,4) 0 (6,4) 0
10 (2,4) 0 (2,4) 0
11 (0,4) 0 (0,4) 0
12 (7,4) 1
13 (6,4) 1
14 (1,4) 1
15 (0,4) 1
16 (11,1) 1 (11,1) 1 (11,1) 1 (11,1) 1 (11,1) 1 (11,1) 1
17 (10,1) 1 (10,1) 1 (10,1) 1 (10,1) 1 (10,1) 1 (10,1) 1
18 (9,1) 1 (9,1) 1 (9,1) 1 (9,1) 1 (9,1) 1 (9,1) 1
19 (5,1) 1 (5,1) 1 (5,1) 1 (5,1) 1
20 (4,1) 1 (4,1) 1 (4,1) 1 (4,1) 1
21 (3,1) 1 (3,1) 1 (3,1) 1 (3,1) 1
22 (8,1) 1 (8,1) 1
23 (7,1) 1 (7,1) 1
24 (6,1) 1 (6,1) 1
25 (2,1) 1 (2,1) 1
26 (1,1) 1 (1,1) 1
27 (0,1) 1 (0,1) 1
* * *
Note: . Configurations 0 -- 15 for normal subframes are available for both
frame structure type 1 and type 2. Configurations 16 -- 27 and configurations
for special subframes are available for frame structure type 2 only.
Figure 6.10.5.2-1: Mapping of CSI reference signals (CSI configuration 0,
normal cyclic prefix)
Figure 6.10.5.2-2: Mapping of CSI reference signals (CSI configuration 0,
extended cyclic prefix)
#### 6.10.5.3 CSI reference signal subframe configuration
The subframe configuration period and the subframe offset for the occurence of
CSI reference signals are listed in Table 6.10.5.3-1. The parameter can be
configured separately for CSI reference signals for which the UE shall assume
non-zero and zero transmission power. Subframes containing CSI reference
signals shall satisfy .
Table 6.10.5.3-1: CSI reference signal subframe configuration
+----------------------+----------------------+----------------------+ | C | CSI-RS periodicity | CSI-RS subframe | | SI-RS-SubframeConfig | | | | (subframes) | | | | | (subframes) | +======================+======================+======================+ | 0 -- 4 | 5 | | +----------------------+----------------------+----------------------+ | 5 -- 14 | 10 | | +----------------------+----------------------+----------------------+ | 15 -- 34 | 20 | | +----------------------+----------------------+----------------------+ | 35 -- 74 | 40 | | +----------------------+----------------------+----------------------+ | 75 -- 154 | 80 | | +----------------------+----------------------+----------------------+
## 6.11 Synchronization signals
There are 504 unique physical-layer cell identities. The physical-layer cell
identities are grouped into 168 unique physical-layer cell-identity groups,
each group containing three unique identities. The grouping is such that each
physical-layer cell identity is part of one and only one physical-layer cell-
identity group. A physical-layer cell identity is thus uniquely defined by a
numberin the range of 0 to 167, representing the physical-layer cell-identity
group, and a number in the range of 0 to 2, representing the physical-layer
identity within the physical-layer cell-identity group.
### 6.11.1 Primary synchronization signal (PSS)
#### 6.11.1.1 Sequence generation
The sequence used for the primary synchronization signal is generated from a
frequency-domain Zadoff-Chu sequence according to
where the Zadoff-Chu root sequence index is given by Table 6.11.1.1-1.
Table 6.11.1.1-1: Root indices for the primary synchronization signal
Root index
* * *
0 25 1 29 2 34
#### 6.11.1.2 Mapping to resource elements
The mapping of the sequence to resource elements depends on the frame
structure. The UE shall not assume that the primary synchronization signal is
transmitted on the same antenna port as any of the downlink reference signals.
The UE shall not assume that any transmission instance of the primary
synchronization signal is transmitted on the same antenna port, or ports, used
for any other transmission instance of the primary synchronization signal.
The sequence shall be mapped to the resource elements according to
For frame structure type 1, the primary synchronization signal shall be mapped
to the last OFDM symbol in slots 0 and 10.
For frame structure type 2, the primary synchronization signal shall be mapped
to the third OFDM symbol in subframes 1 and 6. Resource elements in the OFDM
symbols used for transmission of the primary synchronization signal where
are reserved and not used for transmission of the primary synchronization
signal.
For frame structure type 3, the primary synchronization signal shall be mapped
according to frame structure type 1 with the following exceptions:
\- the primary synchronization signal shall be transmitted only if the
corresponding subframe is non-empty and at least 12 OFDM symbols are
transmitted,
\- a primary synchronization signal being part of a discovery signal shall be
transmitted in the last OFDM symbol of the first slot of a discovery signal
occasion.
### 6.11.2 Secondary synchronization signal (SSS)
#### 6.11.2.1 Sequence generation
The sequence used for the second synchronization signal is an interleaved
concatenation of two length-31 binary sequences. The concatenated sequence is
scrambled with a scrambling sequence given by the primary synchronization
signal.
The combination of two length-31 sequences defining the secondary
synchronization signal differs between subframes according to
where . The indices and are derived from the physical-layer cell-identity
group according to
where the output of the above expression is listed in Table 6.11.2.1-1.
The two sequences and are defined as two different cyclic shifts of the
m-sequence according to
where, , is defined by
with initial conditions.
The two scrambling sequences and depend on the primary synchronization signal
and are defined by two different cyclic shifts of the m-sequence according to
where is the physical-layer identity within the physical-layer cell identity
group and , , is defined by
with initial conditions .
The scrambling sequences and are defined by a cyclic shift of the m-sequence
according to
where and are obtained from Table 6.11.2.1-1 and , , is defined by
with initial conditions .
Table 6.11.2.1-1: Mapping between physical-layer cell-identity group and the
indices and
* * *
0 0 1 34 4 6 68 9 12 102 15 19 136 22 27 1 1 2 35 5 7 69 10 13 103 16 20 137
23 28 2 2 3 36 6 8 70 11 14 104 17 21 138 24 29 3 3 4 37 7 9 71 12 15 105 18
22 139 25 30 4 4 5 38 8 10 72 13 16 106 19 23 140 0 6 5 5 6 39 9 11 73 14 17
107 20 24 141 1 7 6 6 7 40 10 12 74 15 18 108 21 25 142 2 8 7 7 8 41 11 13 75
16 19 109 22 26 143 3 9 8 8 9 42 12 14 76 17 20 110 23 27 144 4 10 9 9 10 43
13 15 77 18 21 111 24 28 145 5 11 10 10 11 44 14 16 78 19 22 112 25 29 146 6
12 11 11 12 45 15 17 79 20 23 113 26 30 147 7 13 12 12 13 46 16 18 80 21 24
114 0 5 148 8 14 13 13 14 47 17 19 81 22 25 115 1 6 149 9 15 14 14 15 48 18 20
82 23 26 116 2 7 150 10 16 15 15 16 49 19 21 83 24 27 117 3 8 151 11 17 16 16
17 50 20 22 84 25 28 118 4 9 152 12 18 17 17 18 51 21 23 85 26 29 119 5 10 153
13 19 18 18 19 52 22 24 86 27 30 120 6 11 154 14 20 19 19 20 53 23 25 87 0 4
121 7 12 155 15 21 20 20 21 54 24 26 88 1 5 122 8 13 156 16 22 21 21 22 55 25
27 89 2 6 123 9 14 157 17 23 22 22 23 56 26 28 90 3 7 124 10 15 158 18 24 23
23 24 57 27 29 91 4 8 125 11 16 159 19 25 24 24 25 58 28 30 92 5 9 126 12 17
160 20 26 25 25 26 59 0 3 93 6 10 127 13 18 161 21 27 26 26 27 60 1 4 94 7 11
128 14 19 162 22 28 27 27 28 61 2 5 95 8 12 129 15 20 163 23 29 28 28 29 62 3
6 96 9 13 130 16 21 164 24 30 29 29 30 63 4 7 97 10 14 131 17 22 165 0 7 30 0
2 64 5 8 98 11 15 132 18 23 166 1 8 31 1 3 65 6 9 99 12 16 133 19 24 167 2 9
32 2 4 66 7 10 100 13 17 134 20 25 - - - 33 3 5 67 8 11 101 14 18 135 21 26 -
- -
#### 6.11.2.2 Mapping to resource elements
The mapping of the sequence to resource elements depends on the frame
structure. In a subframe for frame structure type 1 and 3 and in a half-frame
for frame structure type 2, the same antenna port as for the primary
synchronization signal shall be used for the secondary synchronization signal.
The sequence shall be mapped to resource elements according to
Resource elements where
are reserved and not used for transmission of the secondary synchronization
signal.
## 6.11A Discovery signal
A discovery signal occasion for a cell consists of a period with a duration of
\- one to five consecutive subframes for frame structure type 1
\- two to five consecutive subframes for frame structure type 2
\- 12 OFDM symbols within one non-empty subframe for frame structure type 3
where the UE in the downlink subframes may assume presence of a discovery
signal consisting of
\- cell-specific reference signals on antenna port 0 in all downlink subframes
and in DwPTS of all special subframes in the period for frame structure type 1
and 2
\- cell specific reference signals on antenna port 0 when higher layer
parameters indicate only one configured antenna port for cell specific
reference signals for a serving cell using frame structure type 3
\- cell specific reference signals on antenna port 0 and antenna port 1 when
higher layer parameters indicate at least two configured antenna ports for
cell specific reference signals for a serving cell using frame structure type
3
\- cell specific reference signals on antenna port 0 and antenna port 1 when
higher layer configured parameter _presenceAntennaPort1_ is signalled to be 1,
for a neighbour cell when using frame structure type 3
\- primary synchronization signal in the first subframe of the period for
frame structure types 1 and 3 or the second subframe of the period for frame
structure type 2,
\- secondary synchronization signal in the first subframe of the period, and
\- non-zero-power CSI reference signals in zero or more subframes in the
period. The configuration of non-zero-power CSI reference signals part of the
discovery signal is obtained as described in clause 6.10.5.2
For frame structures 1 and 2 the UE may assume a discovery signal occasion
once every _dmtc-Periodicity_.
For frame structure type 3, the UE may assume a discovery signal occasion may
occur in any subframe within the discovery signals measurement timing
configuration in clause 5.5.2.10 of [9].
For frame structure type 3, simultaneous transmission of a discovery signal
and PDSCH/PDCCH/EPDCCH may occur in subframes 0 and 5 only.
For frame structure type 3, the UE may assume that a discovery signal occasion
occurs in the first subframe containing a primary synchronization signal,
secondary synchronization signal and cell-specific reference signals within
the discovery measurement timing configuration in clause 5.5.2.10 of [9].
## 6.12 OFDM baseband signal generation
The time-continuous signal on antenna port in OFDM symbol in a downlink slot
is defined by
for where and. The variable equals 2048 for subcarrier spacing and 4096 for
subcarrier spacing.
The OFDM symbols in a slot shall be transmitted in increasing order of ,
starting with , where OFDM symbol starts at time within the slot. In case the
first OFDM symbol(s) in a slot use normal cyclic prefix and the remaining OFDM
symbols use extended cyclic prefix, the starting position the OFDM symbols
with extended cyclic prefix shall be identical to those in a slot where all
OFDM symbols use extended cyclic prefix. Thus there will be a part of the time
slot between the two cyclic prefix regions where the transmitted signal is not
specified.
Table 6.12-1 lists the value of that shall be used. Note that different OFDM
symbols within a slot in some cases have different cyclic prefix lengths.
In case NB-IoT is supported, the OFDM baseband signal generation is defined in
subclause 10.2.8.
Table 6.12-1: OFDM parameters
+----------------------+----------------------+----------------------+ | Configuration | Cyclic prefix length | | | | | | +======================+======================+======================+ | Normal cyclic prefix | | (media/image860.wmf) | | | | | | | | | +----------------------+----------------------+----------------------+ | Extended cyclic | | (media/image862.wmf) | +----------------------+----------------------+----------------------+ | | | +----------------------+----------------------+----------------------+
## 6.13 Modulation and upconversion
Modulation and upconversion to the carrier frequency of the complex-valued
OFDM baseband signal for each antenna port is shown in Figure 6.13-1. The
filtering required prior to transmission is defined by the requirements in
3GPP TS 36.104 [6].
Figure 6.13-1: Downlink modulation
# 7 Generic functions
## 7.1 Modulation mapper
The modulation mapper takes binary digits, 0 or 1, as input and produces
complex-valued modulation symbols, _x=I+jQ_ , as output.
### 7.1.1 BPSK
In case of BPSK modulation, a single bit, , is mapped to a complex-valued
modulation symbol _x_ =_I_ +j _Q_ according to Table 7.1.1-1.
Table 7.1.1-1: BPSK modulation mapping
_I_ _Q_
* * *
0 1
### 7.1.2 QPSK
In case of QPSK modulation, pairs of bits, , are mapped to complex-valued
modulation symbols _x_ =_I_ +j _Q_ according to Table 7.1.2-1.
Table 7.1.2-1: QPSK modulation mapping
_I_ _Q_
* * *
00 01 10 11
### 7.1.3 16QAM
In case of 16QAM modulation, quadruplets of bits, , are mapped to complex-
valued modulation symbols _x_ =_I_ +j _Q_ according to Table 7.1.3-1.
Table 7.1.3-1: 16QAM modulation mapping
_I_ _Q_
* * *
0000 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011 1100 1101 1110
1111
### 7.1.4 64QAM
In case of 64QAM modulation, hextuplets of bits, , are mapped to complex-
valued modulation symbols _x_ =_I_ +j _Q_ according to Table 7.1.4-1.
Table 7.1.4-1: 64QAM modulation mapping
_I_ _Q_ _I_ _Q_
* * *
000000 100000 000001 100001 000010 100010 000011 100011 000100 100100 000101
100101 000110 100110 000111 100111 001000 101000 001001 101001 001010 101010
001011 101011 001100 101100 001101 101101 001110 101110 001111 101111 010000
110000 010001 110001 010010 110010 010011 110011 010100 110100 010101 110101
010110 110110 010111 110111 011000 111000 011001 111001 011010 111010 011011
111011 011100 111100 011101 111101 011110 111110 011111 111111
### 7.1.5 256QAM
In case of 256QAM modulation, octuplets of bits, , are mapped to complex-
valued modulation symbols according to Table 7.1.5-1.
Table 7.1.5-1: 256QAM modulation mapping
_I_ _Q_ _I_ _Q_ _I_ _Q_ _I_ _Q_
* * *
00000000 5 5 01000000 5 -5 10000000 -5 5 11000000 -5 -5 00000001 5 7 01000001
5 -7 10000001 -5 7 11000001 -5 -7 00000010 7 5 01000010 7 -5 10000010 -7 5
11000010 -7 -5 00000011 7 7 01000011 7 -7 10000011 -7 7 11000011 -7 -7
00000100 5 3 01000100 5 -3 10000100 -5 3 11000100 -5 -3 00000101 5 1 01000101
5 -1 10000101 -5 1 11000101 -5 -1 00000110 7 3 01000110 7 -3 10000110 -7 3
11000110 -7 -3 00000111 7 1 01000111 7 -1 10000111 -7 1 11000111 -7 -1
00001000 3 5 01001000 3 -5 10001000 -3 5 11001000 -3 -5 00001001 3 7 01001001
3 -7 10001001 -3 7 11001001 -3 -7 00001010 1 5 01001010 1 -5 10001010 -1 5
11001010 -1 -5 00001011 1 7 01001011 1 -7 10001011 -1 7 11001011 -1 -7
00001100 3 3 01001100 3 -3 10001100 -3 3 11001100 -3 -3 00001101 3 1 01001101
3 -1 10001101 -3 1 11001101 -3 -1 00001110 1 3 01001110 1 -3 10001110 -1 3
11001110 -1 -3 00001111 1 1 01001111 1 -1 10001111 -1 1 11001111 -1 -1
00010000 5 11 01010000 5 -11 10010000 -5 11 11010000 -5 -11 00010001 5 9
01010001 5 -9 10010001 -5 9 11010001 -5 -9 00010010 7 11 01010010 7 -11
10010010 -7 11 11010010 -7 -11 00010011 7 9 01010011 7 -9 10010011 -7 9
11010011 -7 -9 00010100 5 13 01010100 5 -13 10010100 -5 13 11010100 -5 -13
00010101 5 15 01010101 5 -15 10010101 -5 15 11010101 -5 -15 00010110 7 13
01010110 7 -13 10010110 -7 13 11010110 -7 -13 00010111 7 15 01010111 7 -15
10010111 -7 15 11010111 -7 -15 00011000 3 11 01011000 3 -11 10011000 -3 11
11011000 -3 -11 00011001 3 9 01011001 3 -9 10011001 -3 9 11011001 -3 -9
00011010 1 11 01011010 1 -11 10011010 -1 11 11011010 -1 -11 00011011 1 9
01011011 1 -9 10011011 -1 9 11011011 -1 -9 00011100 3 13 01011100 3 -13
10011100 -3 13 11011100 -3 -13 00011101 3 15 01011101 3 -15 10011101 -3 15
11011101 -3 -15 00011110 1 13 01011110 1 -13 10011110 -1 13 11011110 -1 -13
00011111 1 15 01011111 1 -15 10011111 -1 15 11011111 -1 -15 00100000 11 5
01100000 11 -5 10100000 -11 5 11100000 -11 -5 00100001 11 7 01100001 11 -7
10100001 -11 7 11100001 -11 -7 00100010 9 5 01100010 9 -5 10100010 -9 5
11100010 -9 -5 00100011 9 7 01100011 9 -7 10100011 -9 7 11100011 -9 -7
00100100 11 3 01100100 11 -3 10100100 -11 3 11100100 -11 -3 00100101 11 1
01100101 11 -1 10100101 -11 1 11100101 -11 -1 00100110 9 3 01100110 9 -3
10100110 -9 3 11100110 -9 -3 00100111 9 1 01100111 9 -1 10100111 -9 1 11100111
-9 -1 00101000 13 5 01101000 13 -5 10101000 -13 5 11101000 -13 -5 00101001 13
7 01101001 13 -7 10101001 -13 7 11101001 -13 -7 00101010 15 5 01101010 15 -5
10101010 -15 5 11101010 -15 -5 00101011 15 7 01101011 15 -7 10101011 -15 7
11101011 -15 -7 00101100 13 3 01101100 13 -3 10101100 -13 3 11101100 -13 -3
00101101 13 1 01101101 13 -1 10101101 -13 1 11101101 -13 -1 00101110 15 3
01101110 15 -3 10101110 -15 3 11101110 -15 -3 00101111 15 1 01101111 15 -1
10101111 -15 1 11101111 -15 -1 00110000 11 11 01110000 11 -11 10110000 -11 11
11110000 -11 -11 00110001 11 9 01110001 11 -9 10110001 -11 9 11110001 -11 -9
00110010 9 11 01110010 9 -11 10110010 -9 11 11110010 -9 -11 00110011 9 9
01110011 9 -9 10110011 -9 9 11110011 -9 -9 00110100 11 13 01110100 11 -13
10110100 -11 13 11110100 -11 -13 00110101 11 15 01110101 11 -15 10110101 -11
15 11110101 -11 -15 00110110 9 13 01110110 9 -13 10110110 -9 13 11110110 -9
-13 00110111 9 15 01110111 9 -15 10110111 -9 15 11110111 -9 -15 00111000 13 11
01111000 13 -11 10111000 -13 11 11111000 -13 -11 00111001 13 9 01111001 13 -9
10111001 -13 9 11111001 -13 -9 00111010 15 11 01111010 15 -11 10111010 -15 11
11111010 -15 -11 00111011 15 9 01111011 15 -9 10111011 -15 9 11111011 -15 -9
00111100 13 13 01111100 13 -13 10111100 -13 13 11111100 -13 -13 00111101 13 15
01111101 13 -15 10111101 -13 15 11111101 -13 -15 00111110 15 13 01111110 15
-13 10111110 -15 13 11111110 -15 -13 00111111 15 15 01111111 15 -15 10111111
-15 15 11111111 -15 -15
## 7.2 Pseudo-random sequence generation
Pseudo-random sequences are defined by a length-31 Gold sequence. The output
sequence of length, where, is defined by
where and the first m-sequence shall be initialized with. The initialization
of the second m-sequence is denoted by with the value depending on the
application of the sequence.
# 8 Timing
## 8.1 Uplink-downlink frame timing
Transmission of the uplink radio frame number from the UE shall start seconds
before the start of the corresponding downlink radio frame at the UE, where if
the UE is configured with a SCG and otherwise. For frame structure type 1 and
for frame structure type 2 unless stated otherwise in [4]. Note that not all
slots in a radio frame may be transmitted. One example hereof is TDD, where
only a subset of the slots in a radio frame is transmitted.
Figure 8.1-1: Uplink-downlink timing relation
# 9 Sidelink
## 9.1 Overview
A sidelink is used for ProSe direct communication and ProSe direct discovery
between UEs.
### 9.1.1 Physical channels
A sidelink physical channel corresponds to a set of resource elements carrying
information originating from higher layers and is the interface defined
between 3GPP TS 36.212 [3] and the present document 3GPP TS 36.211. The
following sidelink physical channels are defined:
\- Physical Sidelink Shared Channel, PSSCH
\- Physical Sidelink Control Channel, PSCCH
\- Physical Sidelink Discovery Channel, PSDCH
\- Physical Sidelink Broadcast Channel, PSBCH
Generation of the baseband signal representing the different physical sidelink
channels is illustrated in Figrue 5.3-1.
### 9.1.2 Physical signals
A sidelink physical signal is used by the physical layer but does not carry
information originating from higher layers. The following sidelink physical
signals are defined:
\- Demodulation reference signal
\- Synchronization signal
### 9.1.3 Handling of simultaneous sidelink and uplink/downlink transmissions
For a given frequency, on an uplink subframe included in _discTxGapConfig_
[9], a UE shall not transmit an uplink transmission that is not a PRACH
transmission and that is partly or completely overlapping in time with a PSDCH
transmission or a SLSS transmission for PSDCH by the same UE. Else, for a
given carrier frequency, a UE shall not transmit a sidelink signal or channel
overlapping partly or completely in time with an uplink transmission from the
same UE.
For a given carrier frequency, no PSDCH, PSCCH, or PSSCH transmission shall
occur from a UE in a sidelink subframe configured for synchronization purposes
by the higher-layer parameters
\- _syncOffsetIndicator1_ or _syncOffsetIndicator2_ in [9] if the UE has no
serving cell fulfilling the S criterion according to [10, clause 5.2.3.2], or
_\- syncOffsetIndicator_ in _commSyncConfig_ or _discSyncConfig_ which
includes _txParameters_ in [9] if the UE has a serving cell fulfilling the S
criterion according to [10, clause 5.2.3.2]. The UE may assume the same
configuration in _commSyncConfig_ and _discSyncConfig_.
For a given carrier frequency, with the exception of PSSCH transmissions with
transmission mode 1 and same sidelink cyclic prefix as PUSCH, no sidelink
transmissions shall occur in sidelink subframe from a UE if uplink SRS is
transmitted from the same UE in uplink subframe .
In case of a UE capable of transmission on multiple carriers, sidelink
transmission may only occur on a single carrier frequency at a given time.
A UE with limited transmission capabilities, on an uplink subframe included in
_discTxGapConfig_ [9], shall first prioritize a PSDCH transmission or a SLSS
transmission for PSDCH over an uplink transmission that is not a PRACH
transmission. Else, a UE with limited transmission capabilities shall at a
given time first prioritize uplink transmissions, followed by sidelink
transmissions.
A UE with limited transmission capabilities shall at a given time prioritize
sidelink communication transmissions (PSSS, SSSS, PSBCH, PSSCH, PSCCH) over
sidelink discovery transmissions (PSDCH).
A UE with limited reception capabilities, on a downlink subframe included in
_discRxGapConfig_ [9], shall first prioritize reception of PSDCH or reception
of SLSS for PSDCH over downlink reception. Else, a UE with limited reception
capabilities shall at a given time first prioritize downlink reception over
sidelink reception.
A UE with limited reception capabilities shall at a given time first
prioritize sidelink communication reception, sidelink discovery reception on
carriers configured by the eNodeB, and last sidelink discovery reception on
carriers not configured by the eNodeB.
## 9.2 Slot structure and physical resources
Sidelink transmissions are organized into radio frames with a duration of ,
each consisting of 20 slots of duration . A sidelink subframe consists of two
consecutive slots, starting with an even-numbered slot.
### 9.2.1 Resource grid
A transmitted physical channel or signal in a slot is described by a resource
grid of subcarriers and SC-FDMA symbols. The sidelink bandwidth if the S
criterion according to [10, clause 5.2.3.2] is fulfilled for a serving cell
having the same uplink carrier frequency as the sidelink, otherwise a
preconfigured value is used [9].
The sidelink cyclic prefix is configured independently for type 1 discovery,
type 2B discovery, sidelink transmission mode 1, sidelink transmission mode 2,
control signalling, and PSBCH and synchronization signals. Configuration is
per resource pool for discovery, sidelink transmission mode 2, and control
signalling. The PSBCH and synchronization signals always use the same cyclic
prefix.
The resource grid is illustrated in Figure 5.2.1-1.
An antenna port is defined such that the channel over which a symbol on the
antenna port is conveyed can be inferred from the channel over which another
symbol on the same antenna port is conveyed. There is one resource grid per
antenna port. The antenna ports used for transmission of a physical channel or
signal are shown in Table 9.2.1-1.
Table 9.2.1-1: Antenna ports used for different physical channels and signals
Physical channel or signal Antenna port number
* * *
PSSCH 1000 PSCCH 1000 PSDCH 1000 PSBCH 1010 Synchronization signals 1020
### 9.2.2 Resource elements
Each element in the resource grid is called a resource element and is uniquely
defined by the index pair in a slot where and are the indices in the frequency
and time domains, respectively. Resource element on antenna port corresponds
to the complex value _._ _When there is no risk for confusion, or no
particular antenna port is specified, the index_ may be dropped _._
Quantities corresponding to resource elements not used for transmission of a
physical channel or a physical signal in a slot shall be set to zero.
### 9.2.3 Resource blocks
A physical resource block is defined as consecutive SC-FDMA symbols in the
time domain and consecutive subcarriers in the frequency domain, where and are
given by Table 9.2.3-1. A physical resource block in the sidelink thus
consists of resource elements, corresponding to one slot in the time domain
and 180 kHz in the frequency domain.
Table 9.2.3-1: Resource block parameters
Configuration
* * *
Normal cyclic prefix 12 7 Extended cyclic prefix 12 6
The relation between the physical resource block number in the frequency
domain and resource elements in a slot is given by
### 9.2.4 Resource pool
The subframe pools and resource block pools are defined in [4].
For PSSCH, the number of the current slot in the subframe pool , where is the
number of the current slot within the current sidelink subframe with equal to
the subscript of , defined in clauses 14.1.4 and 14.2.3 of [4] for sidelink
transmission modes 1 and 2, respectively
### 9.2.5 Guard period
The last SC-FDMA symbol in a sidelink subframe serves as a guard period and
shall not be used for sidelink transmission.
## 9.3 Physical Sidelink Shared Channel
### 9.3.1 Scrambling
The block of bits , where is the number of bits transmitted on the physical
sidelink shared channel in one subframe shall be scrambled according to clause
5.3.1.
The scrambling sequence generator shall be initialised with at the start of
every PSSCH subframe where is destination identity obtained from the sidelink
control channel.
### 9.3.2 Modulation
Modulation shall be done according to clause 5.3.2. Table 9.3.2-1 specifies
the modulation mappings applicable for the physical sidelink shared channel.
Table 9.3.2-1: PSSCH modulation schemes
Physical channel Modulation schemes
* * *
PSSCH QPSK, 16QAM
### 9.3.3 Layer mapping
Layer mapping shall be done according to clause 5.3.2A assuming a single
antenna port, .
### 9.3.4 Transform precoding
Transform precoding shall be done according to clause 5.3.3 with and replaced
by and , respectively.
### 9.3.5 Precoding
Precoding shall be done according to clause 5.3.3A assuming a single antenna
port, .
### 9.3.6 Mapping to physical resources
The block of complex-valued symbols shall be multiplied with the amplitude
scaling factor in order to conform to the transmit power specified in [4], and
mapped in sequence starting with to physical resource blocks on antenna port
and assigned for transmission of PSSCH. The mapping to resource elements
corresponding to the physical resource blocks assigned for transmission and
not used for transmission of reference signals shall be in increasing order of
first the index , then the index, starting with the first slot in the
subframe. Resource elements in the last SC-FDMA symbol within a subframe shall
be counted in the mapping process but not transmitted.
If sidelink frequency hopping is disabled the set of physical resource blocks
to be used for transmission is given by where is obtained from [4, clause
14.1.1.2.1].
If sidelink frequency hopping with type 1 hopping is enabled, the set of
physical resource blocks to be used for transmission is given by [4].
If sidelink frequency hopping with predefined hopping pattern is enabled, the
set of physical resource blocks to be used for transmission is given by the
sidelink control information together with a predefined pattern in clause
5.3.4 with the following exceptions:
\- only inter-subframe hopping shall be used
\- the number of subbands is given by higher layers as described in [4, clause
14.1.1.2]
\- the quantity is given by higher layers as described in [4, clause 14.1.1.2]
\- the quantity where is given by clause 9.2.4
\- the quantity
\- the pseudo-random sequence generator is initialized at the start of each
slot fulfilling with the initialization value given by _hoppingParameter-r12_
in [9]
\- the quantity shall be replaced by , given by [4, clause 14.1.1.2.1]
\- for sidelink transmission mode 1
\-
\- for sidelink transmission mode 2
\- where is given by [4, clause 14.1.3]
\- the quantity shall be replaced by , given by [4, clause 14.1.1.4]
\- the physical resource block to use for transmission with given by [4,
clause 14.1.3]
## 9.4 Physical Sidelink Control Channel
### 9.4.1 Scrambling
The block of bits , where is the number of bits transmitted on the physical
sidelink control channel in one subframe shall be scrambled according to
clause 5.3.1.
The scrambling sequence generator shall be initialised with at the start of
every PSCCH subframe.
### 9.4.2 Modulation
Modulation shall be done according to clause 5.3.2. Table 9.4.2-1 specifies
the modulation mappings applicable for the physical sidelink control channel.
Table 9.4.2-1: PSCCH modulation schemes
Physical channel Modulation schemes
* * *
PSCCH QPSK
### 9.4.3 Layer mapping
Layer mapping shall be done according to clause 5.3.2A assuming a single
antenna port, .
### 9.4.4 Transform precoding
Transform precoding shall be done according to clause 5.3.3 with and replaced
by and , respectively.
### 9.4.5 Precoding
Precoding shall be done according to clause 5.3.3A assuming a single antenna
port, .
### 9.4.6 Mapping to physical resources
The block of complex-valued symbols shall be multiplied with the amplitude
scaling factor in order to conform to the transmit power specified in [4], and
mapped in sequence starting with to physical resource blocks on antenna port
and assigned for transmission of PSCCH. The mapping to resource elements
corresponding to the physical resource blocks assigned for transmission and
not used for transmission of reference signals shall be in increasing order of
first the index , then the index, starting with the first slot in the
subframe. Resource elements in the last SC-FDMA symbol within a subframe shall
be counted in the mapping process but not transmitted.
## 9.5 Physical Sidelink Discovery Channel
### 9.5.1 Scrambling
The block of bits , where is the number of bits transmitted on the physical
sidelink discovery channel in one subframe shall be scrambled according to
clause 5.3.1.
The scrambling sequence generator shall be initialised with at the start of
each PSDCH subframe.
### 9.5.2 Modulation
Modulation shall be done according to clause 5.3.2. Table 9.5.2-1 specifies
the modulation mappings applicable for the physical sidelink discovery
channel.
Table 9.5.2-1: Sidelink modulation schemes
Physical channel Modulation schemes
* * *
PSDCH QPSK
### 9.5.3 Layer mapping
Layer mapping shall be done according to clause 5.3.2A assuming a single
antenna port, .
### 9.5.4 Transform precoding
Transform precoding shall be done according to clause 5.3.3 with and replaced
by and , respectively.
### 9.5.5 Precoding
Precoding shall be done according to clause 5.3.3A assuming a single antenna
port, .
### 9.5.6 Mapping to physical resources
The block of complex-valued symbols shall be multiplied with the amplitude
scaling factor in order to conform to the transmit power specified in [4], and
mapped in sequence starting with to physical resource blocks on antenna port
and assigned for transmission of PSDCH. The mapping to resource elements
corresponding to the physical resource blocks assigned for transmission and
not used for transmission of reference signals shall be in increasing order of
first the index , then the index, starting with the first slot in the
subframe. Resource elements in the last SC-FDMA symbol within a subframe shall
be counted in the mapping process but not transmitted.
The set of physical resource blocks that shall be used are given by [4, clause
14.3.1].
## 9.6 Physical Sidelink Broadcast Channel
### 9.6.1 Scrambling
The block of bits , where is the number of bits transmitted on the physical
sidelink broadcast channel in one subframe, shall be scrambled according to
clause 5.3.1. The scrambling sequence generator shall be initialised at the
start of every PSBCH subframe with .
### 9.6.2 Modulation
Modulation shall be done according to clause 5.3.2. Table 9.6.2-1 specifies
the modulation mappings applicable for the physical sidelink broadcast
channel.
Table 9.6.2-1: PSBCH modulation schemes
Physical channel Modulation schemes
* * *
PSBCH QPSK
### 9.6.3 Layer mapping
Layer mapping shal be done according to clause 5.3.2A assuming a single
antenna port, .
### 9.6.4 Transform precoding
Transform precoding shall be done according to clause 5.3.3 with and replaced
by and , respectively.
### 9.6.5 Precoding
Precoding shall be done according to clause 5.3.3A assuming a single antenna
port, .
### 9.6.6 Mapping to physical resources
The block of complex-valued symbols shall be multiplied with the amplitude
scaling factor in order to conform to the transmit power specified in [4], and
mapped in sequence starting with to physical resource blocks on antenna port .
The PSBCH shall use the same set of resource blocks as the synchronization
signal. The mapping to resource elements corresponding to the physical
resource blocks used for the PSBCH and not used for transmission of reference
signals or synchronization signals shall be in increasing order of first the
index , then the index , starting with the first slot in the subframe. The
resource-element index given by
Resource elements in the last SC-FDMA symbol within a subframe should be
counted in the mapping process but not transmitted.
## 9.7 Sidelink Synchronization Signals
A physical-layer sidelink synchronization identity is represented by , divided
into two sets id_net and id_oon consisting of identities and , respectively.
### 9.7.1 Primary sidelink synchronization signal
The primary sidelink synchronization signal is transmitted in two adjacent SC-
FDMA symbols in the same subframe.
#### 9.7.1.1 Sequence generation
Each of the two sequences used for the primary sidelink synchronization signal
in the two SC-FDMA symbols is given by clause 6.11.1.1 with root index if and
otherwise.
#### 9.7.1.2 Mapping to resource elements
The sequence shall be multiplied with the amplitude scaling factor and mapped
to resource elements on antenna port 1020 in the first slot in the subframe
according to
### 9.7.2 Secondary sidelink synchronization signal
The secondary sidelink synchronization signal is transmitted in two adjacent
SC-FDMA symbols in the same subframe.
#### 9.7.2.1 Sequence generation
Each of the two sequences used for the secondary sidelink synchronization
signal is given by clause 6.11.2.1 assuming subframe 0 with and .
#### 9.7.2.2 Mapping to resource elements
The sequence shall be multiplied with the amplitude scaling factor in order to
conform to the transmit power specified in clause 14.4 in 3GPP TS 36.213 [4]
and mapped to resource elements on antenna port 1020 in the second slot in the
subframe according to
## 9.8 Demodulation reference signals
Demodulation reference signals associated with PSSCH, PSCCH, PSDCH, and PSBCH
transmission shall be transmitted according to PUSCH in clause 5.5.2.1 with
the following exceptions:
\- The parameters in Tables 9.8-1 and 9.8-2 shall be used.
\- The term PUSCH shall be replaced by PSSCH, PSCCH, PSDCH or PSBCH, depending
on the physical channel to which the reference signal is associated.
\- Antenna ports are given by Table 9.2-1.
\- The set of physical resource blocks used in the mapping process shall be
identical to the corresponding PSSCH/PSCCH/PSDCH/PSBCH transmission.
\- The index in the mapping process in clause 5.5.2.1.2 shall be identical to
that for the corresponding PSSCH/PSCCH/PSDCH/PSBCH transmission.
\- The pseudo-random sequence generator in clause 5.5.1.3 shall be initialized
at the start of each slot fulfilling
Table 9.8-1: Reference signal parameters for PSSCH and PSCCH.
Parameter in clause 5.5.2.1 PSSCH PSCCH
* * *
Group hopping enabled disabled \- \- 0 Sequence hopping disabled disabled
Cyclic shift 0 Orthogonal sequence Reference signal length Number of layers 1
1 Number of antenna ports 1 1
Table 9.8-2: Reference signal parameters for PSDCH and PSBCH.
Parameter in clause 5.5.2.1 PSDCH PSBCH
* * *
Group hopping disabled disabled 0 Sequence hopping disabled disabled Cyclic
shift 0 Orthogonal sequence Reference signal length Number of layers 1 1
Number of antenna ports 1 1
## 9.9 SC-FDMA baseband signal generation
The time-continuous signal for antenna port in SC-FDMA symbol in a sidelink
slot is defined by clause 5.6 with replaced by .
The cyclic prefix length for each sidelink channel or signal may differ from
that configured for uplink transmissions.
## 9.10 Timing
Transmission of a sidelink radio frame number from the UE shall start seconds
before the start of the corresponding timing reference frame at the UE. The UE
is not required to receive sidelink or downlink transmissions earlier than
after the end of a sidelink transmission.
For PSDCH transmission and sidelink synchronization signal transmission for
PSDCH:
if the UE has a serving cell fulfilling the S criterion according to [10,
clause 5.2.3.2]
\- the timing of reference radio frame equals that of downlink radio frame of
the cell c as given in Section 14.3.1 of [4] and
\- is given by clause 8.1,
otherwise
\- the timing of reference radio frame is implicitly obtained from [4] and
\- .
For all other sidelink transmissions:
if the UE has a serving cell fulfilling the S criterion according to [10,
clause 5.2.3.2]
\- the timing of reference radio frame equals that of downlink radio frame in
the cell with the same uplink carrier frequency as the sidelink and
\- is given by clause 8.1,
otherwise
\- the timing of reference radio frame is implicitly obtained from [4] and
\- .
Figure 9.9-1: Sidelink timing relation.
The quantity differs between channels and signals according to
# 10 Narrowband IoT
## 10.1 Uplink
### 10.1.1 Overview
#### 10.1.1.1 Physical channels
The following narrowband physical channels are defined:
\- Narrowband Physical Uplink Shared Channel, NPUSCH
\- Narrowband Physical Random Access Channel, NPRACH
#### 10.1.1.2 Physical signals
The following uplink narrowband physical signals are defined:
\- Narrowband demodulation reference signal
### 10.1.2 Slot structure and physical resources
#### 10.1.2.1 Resource grid
A transmitted physical channel or signal in a slot is described by one or
several resource grids of subcarriers and SC-FDMA symbols. The resource grid
is illustrated in Figure 10.1.2.1-1. The slot number within a radio frame is
denoted where for and for .
Figure 10.1.2.1-1: Uplink resource grid for NB-IoT
The uplink bandwidth in terms of subcarriers , and the slot duration are given
in Table 10.1.2.1-1.
Table 10.1.2.1-1: NB-IoT parameters.
Subcarrier spacing
* * *
A single antenna port is used for all uplink transmissions.
#### 10.1.2.2 Resource elements
Each element in the resource grid is called a resource element and is uniquely
defined by the index pair in a slot where and are the indices in the frequency
and time domains, respectively. Resource element corresponds to the complex
value _._ Quantities corresponding to resource elements not used for
transmission of a physical channel or a physical signal in a slot shall be set
to zero.
#### 10.1.2.3 Resource unit
Resource units are used to describe the mapping of the NPUSCH to resource
elements. A resource unit is defined as consecutive SC-FDMA symbols in the
time domain and consecutive subcarriers in the frequency domain, where and are
given by Table 10.1.2.3-1.
Table 10.1.2.3-1: Supported combinations of , , and .
NPUSCH format {width="0.19166666666666668in" height="0.19166666666666668in"}
* * *
1 3.75 kHz 1 16 7 15 kHz 1 16  
3 8  
6 4  
12 2  
2 3.75 kHz 1 4  
15 kHz 1 4
### 10.1.3 Narrowband physical uplink shared channel
The narrowband physical uplink shared channel supports two formats:
\- NPUSCH format 1, used to carry the UL-SCH
\- NPUSCH format 2, used to carry uplink control information
#### 10.1.3.1 Scrambling
Scrambling shall be done according to clause 5.3.1. The scrambling sequence
generator shall be initialised with where is the first slot of the
transmission of the codeword. In case of NPUSCH repetitions, the scrambling
sequence shall be reinitialised according to the above formula after every
transmissions of the codeword with and set to the first slot and the frame,
respectively, used for the transmission of the repetition. The quantity is
given by clause 10.1.3.6.
#### 10.1.3.2 Modulation
Modulation shall be done according to clause 5.3.2. Table 10.1.3.2-1 specifies
the modulation mappings applicable for the narrowband physical uplink shared
channel.
Table 10.1.3.2-1: NPUSCH modulation schemes
NPUSCH format **Modulation scheme**
* * *
1 1 BPSK, QPSK >1 QPSK 2 1 BPSK
#### 10.1.3.3 Layer mapping
Layer mapping shall be done according to clause 5.3.2A with .
#### 10.1.3.4 Transform precoding
Transform precoding shall be done according to clause 5.3.3 with and replaced
by .
#### 10.1.3.5 Precoding
Precoding shall be done according to clause 5.3.3A assuming a single antenna
port.
#### 10.1.3.6 Mapping to physical resources
NPUSCH can be mapped to one or more than one resource units, , as given by
clause 16.5.1.2 of 3GPP TS 36.213 [4], each of which shall be transmitted
times.
The block of complex-valued symbols shall be multiplied with the amplitude
scaling factor in order to conform to the transmit power specified in [4], and
mapped in sequence starting with to subcarriers assigned for transmission of
NPUSCH. The mapping to resource elements corresponding to the subcarriers
assigned for transmission and not used for transmission of reference signals,
shall be in increasing order of first the index , then the index, starting
with the first slot in the assigned resource unit.
After mapping to slots, the slots shall be repeated additional times, before
continuing the mapping of to the following slot, where
If a mapping to slots or a repetition of the mapping contains a resource
element which overlaps with any configured NPRACH resource according to
_NPRACH-ConfigSIB-NB_ ,
\- for the NPUSCH transmission in overlapped slots is postponed until the next
slots not overlapping with any configured NPRACH resource.
\- for the NPUSCH transmission in overlapped slots is postponed until the next
slots starting with the first slot satisfying and not overlapping with any
configured NPRACH resource.
NPRACH gaps as defined in section 10.1.6.1 are not part of the NPRACH
resource. The mapping of is then repeated until slots have been transmitted.
After transmissions and/or postponements due to NPRACH of time units, a gap of
time units shall be inserted where the NPUSCH transmission is postponed. The
portion of a postponement due to NPRACH which coincides with a gap is counted
as part of the gap.
When higher layer parameter _npusch-AllSymbols_ is set to false, resource
elements in SC-FDMA symbols overlapping with a symbol configured with SRS
according to _srs-SubframeConfig_ shall be counted in the NPUSCH mapping but
not used for transmission of the NPUSCH. When higher layer parameter _npusch-
AllSymbols_ is set to true, all symbols are transmitted.
### 10.1.4 Demodulation reference signal
#### 10.1.4.1 Reference signal sequence
##### 10.1.4.1.1 Reference signal sequence for
The reference signal sequence for **is defined by**
where **the binary sequence** is defined by clause 7.2 **and** shall be
initialised with at the start of the NPUSCH transmission. The quantity is
given by Table 10.1.4.1.1-1 where **for NPUSCH format 2, and for NPUSCH format
1if group hopping is not enabled, and by clause** 10.1.4.1.3 if group hopping
is enabled for NPUSCH format 1**.**
Table 10.1.4.1.1-1: Definition of
* * *
0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 2
1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 3 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1
-1 1 4 1 1 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 5 1 -1 1 -1 -1 1 -1 1 1 -1 1 -1
-1 1 -1 1 6 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1 7 1 -1 -1 1 -1 1 1 -1 1 -1
-1 1 -1 1 1 -1 8 1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1 9 1 -1 1 -1 1 -1 1 -1
-1 1 -1 1 -1 1 -1 1 10 1 1 -1 -1 1 1 -1 -1 -1 -1 1 1 -1 -1 1 1 11 1 -1 -1 1 1
-1 -1 1 -1 1 1 -1 -1 1 1 -1 12 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1 1 1 1 1 13 1 -1
1 -1 -1 1 -1 1 -1 1 -1 1 1 -1 1 -1 14 1 1 -1 -1 -1 -1 1 1 -1 -1 1 1 1 1 -1 -1
15 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1
The reference signal sequence for NPUSCH format 1 is given by:
The reference signal sequence for NPUSCH format 2 is given by
where is **defined in** Table 5.5.2.2.1-2 with the sequence index chosen
according to with .
##### 10.1.4.1.2 Reference signal sequence for
The reference signal sequences for **is defined by** a cyclic shift of a base
sequence according to
,
where **is given by Table 10.1.4.1.2-1 for** **, Table 10.1.4.1.2-2 for**
**and Table 5.5.1.2-1 for** **.**
**If group hopping is not enabled, the base sequence index** **is given by
higher layer parameters _threeTone-BaseSequence_ , _sixTone-BaseSequence_ ,
and _twelveTone-BaseSequence_ for** **,** **, and** **, respectively. If not
signalled by higher layers, the base sequence is given by**
**If group hopping is enabled, the base sequence index** **is given by
clause** 10.1.4.1.3.
**The cyclic shift** for **and** is derived from higher layer parameters
**_threeTone-CyclicShift_ and _sixTone-CyclicShift_ , respectively,** as
defined in **Table 10.1.4.1.2-3. For** **,** .
Table 10.1.4.1.2-1: Definition of for
* * *
0 1 -3 -3 1 1 -3 -1 2 1 -3 3 3 1 -1 -1 4 1 -1 1 5 1 -1 3 6 1 1 -3 7 1 1 -1 8 1
1 3 9 1 3 -1 10 1 3 1 11 1 3 3
Table 10.1.4.1.2-2: Definition of for
* * *
0 1 1 1 1 3 -3 1 1 1 3 1 -3 3 2 1 -1 -1 -1 1 -3 3 1 -1 3 -3 -1 -1 4 1 3 1 -1
-1 3 5 1 -3 -3 1 3 1 6 -1 -1 1 -3 -3 -1 7 -1 -1 -1 3 -3 -1 8 3 -1 1 -3 -3 3 9
3 -1 3 -3 -1 1 10 3 -3 3 -1 3 3 11 -3 1 3 1 -3 -1 12 -3 1 -3 3 -3 -1 13 -3 3
-3 1 1 -3
Table 10.1.4.1.2-3: Definition of
* * *
_threeTone-CyclicShift_ _sixTone-CyclicShift_ 0 0 1 1 2 2 3
##### 10.1.4.1.3 Group hopping
For the reference signal for NPUSCH format 1, sequence-group hopping can be
enabled where the sequence-group number in slot is defined by a group hopping
pattern and a sequence-shift pattern according to
where the number of reference signal sequences available for each resource
unit size, is given by Table 10.1.4.1.3-1.
Table 10.1.4.1.3-1: Definition of
* * *
1 16 3 12 6 14 12 30
Sequence-group hopping can be enabled or disabled by means of the cell-
specific parameter _groupHoppingEnabled_ provided by higher layers. Sequence-
group hopping for NPUSCH can be disabled for a certain UE through the higher-
layer parameter _groupHoppingDisabled_ despite being enabled on a cell basis
unless the NPUSCH transmission corresponds to a Random Access Response Grant
or a retransmission of the same transport block as part of the contention
based random access procedure.
The group-hopping pattern is given by
where for **and** is the slot number of the first slot of the resource unit
for **.** The pseudo-random sequence is defined by clause 7.2. The pseudo-
random sequence generator shall be initialized with at the beginning of the
resource unit for **and in every** even slot for .
The sequence-shift pattern is given by
where is given by higher-layer parameter _groupAssignmentNPUSCH_. If no value
is signalled ,.
#### 10.1.4.2 Mapping to physical resources
The sequence shall be multiplied with the amplitude scaling factor and mapped
in sequence starting with to the sub-carriers.\ The set of sub-carriers used
in the mapping process shall be identical to the corresponding NPUSCH
transmission as defined in clause 10.1.3.6.\ The mapping to resource elements
shall be in increasing order of first, then , and finally the slot number. The
values of the symbol index in a slot are given in Table 10.1.4.2-1.
Table 10.1.4.2-1: Demodulation reference signal location for NPUSCH.
NPUSCH format Values for
* * *
                  ![](media/image2034.wmf)              ![](media/image2035.wmf)
1 4 3 2 0,1,2 2,3,4
### 10.1.5 SC-FDMA baseband signal generation
For **,** the time-continuous signal in SC-FDMA symbol in a slot is defined by
clause 5.6 with the quantity replaced by .
For **, t** he time-continuous signal for sub-carrier index in SC-FDMA symbol
in an uplink slot is defined by
For where parameters for and are given in Table 10.1.5-1, is the modulation
value of symbol and the phase rotation is defined by
where is a symbol counter that is reset at the start of a transmission and
incremented for each symbol during the transmission.
Table 10.1.5-1: SC-FDMA parameters for
+----------------------+----------------------+----------------------+ | Parameter | | (media/image854.wmf) | +======================+======================+======================+ | | | | +----------------------+----------------------+----------------------+ | Cyclic prefix length | 256 | ![] | | | | | | | | ![] | | | | (media/image861.wmf) | +----------------------+----------------------+----------------------+ | **Set of values | -24,-23,...,23 | -6,-5,...,5 | | for** | | | | | | | +----------------------+----------------------+----------------------+
The SC-FDMA symbols in a slot shall be transmitted in increasing order of ,
starting with , where SC-FDMA symbol starts at time within the slot. For , the
remaining in are not transmitted and used for guard period.
Only normal CP is supported for Narrowband IoT uplink in this release of the
specification.
### 10.1.6 Narrowband physical random access channel
#### 10.1.6.1 Time and frequency structure
The physical layer random access preamble is based on single-subcarrier
frequency-hopping symbol groups. A symbol group is illustrated in Figure
10.1.6.1-1, consisting of a cyclic prefix of length and a sequence of 5
identical symbols with total length. The parameter values are listed in Table
10.1.6.1-1.
Figure 10.1.6.1-1: Random access symbol group
Table 10.6.1.1-1: Random access preamble parameters
Preamble format
* * *
0 1
The preamble consisting of 4 symbol groups transmitted without gaps shall be
transmitted times.
The transmission of a random access preamble, if triggered by the MAC layer,
is restricted to certain time and frequency resources.
A NPRACH configuration provided by higher layers contains the following:
\- NPRACH resource periodicity _(nprach-Periodicity),_
\- _frequency location of the first subcarrier allocated to NPRACH_ _(nprach-
SubcarrierOffset),_
\- _number of subcarriers allocated to NPRACH_ _(nprach-NumSubcarriers),_
_\- number of starting sub-carriers allocated to UE initiated random access_
_(nprach-NumCBRA-StartSubcarriers)_ ,
\- number of NPRACH repetitions per attempt
(_numRepetitionsPerPreambleAttempt_),
\- NPRACH starting time (_nprach-StartTime_),
\- Fraction for calculating starting subcarrier index for the range of NPRACH
subcarriers reserved for indication of UE support for multi-tone msg3
transmission (_nprach-SubcarrierMSG3-RangeStart_).
NPRACH transmission can start only time units after the start of a radio frame
fulfilling . After transmissions of time units, a gap of time units shall be
inserted.
NPRACH configurations where are invalid.
The NPRACH starting subcarriers _allocated to UE initiated random access_ are
split in two sets of subcarriers, and , where the second set, if present,
indicate UE support for multi-tone msg3 transmission.
The frequency location of the NPRACH transmission is constrained within sub-
carriers. Frequency hopping shall be used within the 12 subcarriers, where the
frequency location of the _i^th^_ symbol group is given by where and
where with being the subcarrier selected by the MAC layer from , and the
pseudo random sequence is given by clause 7.2. The pseudo random sequence
generator shall be initialised with .
#### 10.1.6.2 Baseband signal generation
The time-continuous random access signal for symbol group is defined by
Where , is an amplitude scaling factor in order to conform to the transmit
power specified in clause 16.3.1 in 3GPP TS 36.213 [4], , accounts for the
difference in subcarrier spacing between the random access preamble and uplink
data transmission, and the location in the frequency domain controlled by the
parameter is derived from clause 10.1.6.1. The variable is given by Table
10.1.6.2-1.
Table 10.1.6.2-1: Random access baseband parameters
Preamble format
* * *
0, 1 3.75 kHz
### 10.1.7 Modulation and upconversion
Modulation and upconversion to the carrier frequency of the complex-valued
baseband signal or the complex-valued NPRACH baseband signal is shown in
Figure 5.8-1. The filtering required prior to transmission is defined by the
requirements in 3GPP TS 36.101 [7].
## 10.2 Downlink
### 10.2.1 Overview
#### 10.2.1.1 Physical channels
A downlink narrowband physical channel corresponds to a set of resource
elements carrying information originating from higher layers and is the
interface defined between 3GPP TS 36.212 [3] and the present document 3GPP TS
36.211.
The following downlink physical channels are defined:
\- Narrowband Physical Downlink Shared Channel, NPDSCH
\- Narrowband Physical Broadcast Channel, NPBCH
\- Narrowband Physical Downlink Control Channel, NPDCCH
#### 10.2.1.2 Physical signals
A downlink narrowband physical signal corresponds to a set of resource
elements used by the physical layer but does not carry information originating
from higher layers. The following downlink physical signals are defined:
\- Narrowband reference signal, NRS
\- Narrowband synchronization signal
### 10.2.2 Slot structure and physical resource elements
#### 10.2.2.1 Resource grid
The transmitted signal on one antenna port in each slot is described by a
resource grid of size one resource block as defined in clause 6.2.3.
_Only_ is supported.
#### 10.2.2.2 Resource elements
Resource elements are defined according to clause 6.2.2.
#### 10.2.2.3 Guard period for half-duplex FDD operation
Only type-B half-duplex FDD operation is supported.
### 10.2.3 Narrowband physical downlink shared channel
#### 10.2.3.1 Scrambling
Scrambling shall be done according to clause 6.3.1. If the NPDSCH is carrying
the BCCH, the scrambling sequence generator shall be initialised with .
Otherwise, the scrambling sequence generator shall be initialised with whereis
the first slot of the transmission of the codeword.
In case of NPDSCH repetitions and the NPDSCH carrying the BCCH, the scrambling
sequence generator shall be reinitialized according to the expression above
for each repetition.
In case of NPDSCH repetitions and the NPDSCH is not carrying the BCCH, the
scrambling sequence generator shall be reinitialized according to the
expression above after every transmission of the codeword withand set to the
first slot and the frame, respectively, used for the transmission of the
repetition.
#### 10.2.3.2 Modulation
Modulation shall be done according to clause 6.3.2 using one of the modulation
schemes in Table 10.2.3-1
Table 10.2.3-1: Modulation schemes
Physical channel Modulation schemes
* * *
NPDSCH QPSK
#### 10.2.3.3 Layer mapping and precoding
Layer mapping and precoding shall be done according to clause 6.6.3 using the
same set of antenna ports as the NPBCH.
#### 10.2.3.4 Mapping to resource elements
NPDSCH can be mapped to one or more than one subframes, , as given by clause
16.4.1.3 of 3GPP TS 36.213 [4], each of which shall be transmitted times.
For each of the antenna ports used for transmission of the physical channel,
the block of complex-valued symbols shall be mapped to resource elements which
meet all of the following criteria in the current subframe:
\- the subframe is not used for transmission of NPBCH, NPSS, or NSSS, and
\- they are assumed by the UE not to be used for NRS, and
\- they are not overlapping with resource elements used for CRS as defined in
clause 6 (if any), and
\- the index in the first slot in a subframe fulfils where is given by clause
16.4.1.4 of 3GPP TS 36.213 [4].
The mapping of in sequence starting with to resource elements on antenna port
meeting the criteria above shall be in increasing order of first the index and
then the index, starting with the first slot and ending with the second slot
in a subframe. For NPDSCH not carrying BCCH, after mapping to a subframe, the
subframe shall be repeated for additional subframes, before continuing the
mapping of to the following subframe. The mapping of is then repeated until
subframes have been transmitted. For NPDSCH carrying BCCH, the is mapped to
subframes in sequence and then repeated until subframes have been transmitted.
The NPDSCH transmission can be configured by higher layers with transmission
gaps where the NPSDCH transmission is postponed. There are no gaps in the
NPDSCH transmission if where is given by the higher layer parameter _dl-
GapThreshold_ and is given by [4]. The gap starting frame and subframe is
given by where the gap periodicity,, is given by the higher layer parameter
_dl-GapPeriodicity_. The gap duration in number of subframes is given by ,
where is given by the higher layer parameter _dl-GapDurationCoeff_. For NPDSCH
carrying the BCCH there are no gaps in the transmission.
The UE shall not expect NPDSCH in subframe if it is not a NB-IoT downlink
subframe, except for transmissions of NPDSCH carrying
_SystemInformationBlockType1-NB_ in subframe 4. In case of NPDSCH
transmissions, in subframes that are not NB-IoT downlink subframes, the NPDSCH
transmission is postponed until the next NB-IoT downlink subframe.
### 10.2.4 Narrowband physical broadcast channel
#### 10.2.4.1 Scrambling
Scrambling shall be done according to clause 6.6.1 with denoting the number of
bits to be transmitted on the NPBCH. equals 1600 for normal cyclic prefix. The
scrambling sequence shall be initialised with in radio frames fulfilling.
#### 10.2.4.2 Modulation
Modulation shall be done according to clause 6.6.2 using the modulation scheme
in Table 10.2.4.2-1
Table 10.2.4.2-1: Modulation schemes for NPBCH
Physical channel Modulation schemes
* * *
NPBCH QPSK
#### 10.2.4.3 Layer mapping and precoding
Layer mapping and precoding shall be done according to clause 6.6.3 with . The
UE shall assume antenna ports and are used for the transmission of the
narrowband physical broadcast channel.
#### 10.2.4.4 Mapping to resource elements
The block of complex-valued symbols for each antenna port is transmitted in
subframe 0 during 64 consecutive radio frames starting in each radio frame
fulfilling . for normal cyclic prefix. Define as the block of complex-valued
symbols to be transmitted in subframe 0 of radio frame , as , with for normal
cyclic prefix, and
where the scrambling sequence , is given by clause 7.2, and shall be
initialized at the start of each radio frame with . The block of complex-
valued symbols shall be mapped in sequence starting with to resource elements
. The mapping to resource elements not reserved for transmission of reference
signals shall be in increasing order of first the index, then the index . The
first three OFDM symbols in a subframe shall not be used in the mapping
process.
For the purpose of the mapping, the UE shall assume cell-specific reference
signals for antenna ports 0-3 and narrowband reference signals for antenna
ports 2000 and 2001 being present irrespective of the actual configuration.
The frequency shift of the cell-specific reference signals shall be calculated
by replacing with in the calculation of in clause 6.10.1.2.
### 10.2.5 Narrowband physical downlink control channel
#### 10.2.5.1 NPDCCH formats
The narrowband physical downlink control channel carries control information.
A narrowband physical control channel is transmitted on an aggregation of one
or two consecutive narrowband control channel elements (NCCEs), where a
narrowband control channel element corresponds to _6 consecutive subcarriers
in a subframe where NCCE 0 occupies subcarriers 0 through 5 and NCCE 1
occupies subcarriers 6 through 11_. The NPDCCH supports multiple formats as
listed in Table 10.2.5.1-1. For NPDCCH format 1, both NCCEs belong to the same
subframe.
One or two NPDCCHs can be transmitted in a subframe.
Table 10.2.5.1-1: Supported NPDCCH formats
NPDCCH format Number of NCCEs
* * *
0 1 1 2
#### 10.2.5.2 Scrambling
Scrambling shall be done according to clause 6.8.2. The scrambling sequence
shall be initialised at the start of subframe _k_ ~0~ according to [4] section
16.6 and after every 4^th^ NPDCCH subframe with **where** **is the first slot
of the NPDCCH subframe in which scrambling is** (re-)**initialized**.
#### 10.2.5.3 Modulation
Modulation shall be done according to clause 6.8.3 using the modulation scheme
in Table 10.2.5.3-1
Table 10.2.5.3-1: Modulation schemes
Physical channel Modulation schemes
* * *
NPDCCH QPSK
#### 10.2.5.4 Layer mapping and precoding
Layer mapping and precoding shall be done according to clause 6.6.3 using the
same set of antenna ports as the NPBCH.
#### 10.2.5.5 Mapping to resource elements
The block of complex-valued symbols shall be mapped in sequence starting with
to resource elements on the associated antenna port which meet all of the
following criteria:
\- they are part of the NCCE(s) assigned for the NPDCCH transmission, and
\- they are not used for transmission of NPBCH, NPSS, or NSSS , and
\- they are assumed by the UE not to be used for NRS, and
\- they are not overlapping with resource elements used for CRS as defined in
clause 6 (if any), and
\- the index in the first slot in a subframe fulfils where is given by clause
16.6.1 of 3GPP TS 36.213 [4].
The mapping to resource elements on antenna port meeting the criteria above
shall be in increasing order of first the index and then the index, starting
with the first slot and ending with the second slot in a subframe.
The NPDCCH transmission can be configured by higher layers with transmissions
gaps where the NPDCCH transmission is postponed. The configuration is the same
as described for NPDSCH in clause 10.2.3.4.
The UE shall not expect NPDCCH in subframe if it is not a NB-IoT downlink
subframe. In case of NPDCCH transmissions, in subframes that are not NB-IoT
downlink subframes, the NPDCCH transmission is postponed until the next NB-IoT
downlink subframe.
### 10.2.6 Narrowband reference signal (NRS)
Before a UE obtains _operationModeInfo_ , the UE may assume narrowband
reference signals are transmitted in subframes #0 and #4 and in subframes #9
not containing NSSS.
On an NB-IoT carrier for which a UE receives higher-layer parameter
_operationModeInfo_ indicating _guardband_ or _standalone,_
Before the UE obtains _SystemInformationBlockType1-NB_ , the UE may assume
narrowband reference signals are transmitted in subframes #0, #1, #3, #4 and
in subframes #9 not containing NSSS.
After the UE obtains _SystemInformationBlockType1-NB_ , the UE may assume
narrowband reference signals are transmitted in subframes #0, #1, #3, #4,
subframes #9 not containing NSSS, and in NB-IoT downlink subframes and shall
not expect narrowband reference signals in other downlink subframes.
On an NB-IoT carrier for which a UE receives higher-layer parameter
_operationModeInfo_ indicating _inband-SamePCI_ or _inband-DifferentPCI,_
Before the UE obtains _SystemInformationBlockType1-NB_ , the UE may assume
narrowband reference signals are transmitted in subframes #0, #4 and in
subframes #9 not containing NSSS.
After the UE obtains _SystemInformationBlockType1-NB_ , the UE may assume
narrowband reference signals are transmitted in subframes #0, #4, subframes #9
not containing NSSS, and in NB-IoT downlink subframes and shall not expect
narrowband reference signals in other downlink subframes.
On an NB-IoT carrier for which _DL-CarrierConfigDedicated-NB_ is present and
no _inbandCarrierInfo_ is present:
\- The UE may assume NRSs are transmitted in subframes #0, #1, #3, #4, #9, and
in NB-IoT downlink subframes and shall not expect NRSs in other downlink
subframes.
On an NB-IoT carrier for which _DL-CarrierConfigDedicated-NB_ is present and
_inbandCarrierInfo_ is present:
\- The UE may assume NRSs are transmitted in subframes #0, #4, #9, and in NB-
IoT downlink subframes and shall not expect NRSs in other downlink subframes.
#### 10.2.6.1 Sequence generation
The narrowband reference sequence shall be initialised according to clause
6.10.1.1 where is replaced with .
#### 10.2.6.2 Mapping to resource elements
Narrowband reference signals are transmitted on one or two antenna ports .
If the higher layer indicates UE may assume that is equal to , UE may assume
\- the number of antenna ports for the cell-specific reference signals as
defined in clause 6.10.1 is the same as for the narrowband reference signals,
\- the antenna ports for cell-specific reference signals{0, 1} are equivalent
to antenna ports for narrowband reference signals {2000, 2001}, respectively,
and
\- the cell-specific reference signals are available in all subframes where
the narrowband reference signals are available.
If the higher layer does not indicate UE may assume that is equal to , UE may
assume
\- the number of antenna port for the cell-specific reference signals as
defined in clause 6.10.1 is obtained from the higher layer parameter _eutra-
NumCRS-Ports_ ,
\- the cell-specific reference signals are available in all subframes where
the narrowband reference signals are available, and
the cell-specific frequency shift for cell-specific reference signals as
defined in clause 6.10.1.2 is given by .
The reference signal sequence shall be mapped to complex-valued modulation
symbols used as reference symbols for antenna port in slot according to
where
The variables and define the position in the frequency domain for the
different reference signals where is given by
The cell-specific frequency shift is given by .
Resource elements used for transmission of narrowband reference signals on any
of the antenna ports in a slot shall not be used for any transmission on any
other antenna port in the same slot and set to zero.
Narrowband reference signals shall not be transmitted in subframes containing
NPSS or NSSS.
Figure 10.2.6.2-1 illustrates the resource elements used for reference signal
transmission according to the above definition. The notation is used to denote
a resource element used for reference signal transmission on antenna port.
Figure 10.2.6.2-1. Mapping of downlink narrowband reference signals (normal
cyclic prefix)
### 10.2.7 Synchronization signals
There are 504 unique physical-layer cell identities indicated by the
narrowband secondary synchronization signal.
#### 10.2.7.1 Narrowband primary synchronization signal (NPSS)
##### 10.2.7.1.1 Sequence generation
The sequence used for the narrowband primary synchronization signal is
generated from a frequency-domain Zadoff-Chu sequence according to
where the Zadoff-Chu root sequence index and for different symbol indices is
given by Table 10.2.7.1.1-1.
Table 10.2.7.1.1-1: Definition of .
Cyclic prefix length
* * *
Normal 1 1 1 1 -1 -1 1 1 1 -1 1
##### 10.2.7.1.2 Mapping to resource elements
The same antenna port shall be used for all symbols of the narrowband primary
synchronization signal within a subframe.
UE shall not assume that the narrowband primary synchronization signal is
transmitted on the same antenna port as any of the downlink reference signals.
The UE shall not assume that the transmissions of the narrowband primary
synchronization signal in a given subframe use the same antenna port, or
ports, as the narrowband primary synchronization signal in any other subframe.
The sequences shall be mapped to resource elements in increasing order of
first the index and then the index in subframe 5 in every radio frame. For
resource elements overlapping with resource elements where cell-specific
reference signals according to clause 6.10 are transmitted, the corresponding
sequence element is not used for the NPSS but counted in the mapping process.
#### 10.2.7.2 Narrowband secondary synchronization signal (NSSS)
##### 10.2.7.2.1 Sequence generation
The sequence used for the narrowband secondary synchronization signal is
generated from a frequency-domain Zadoff-Chu sequence according to
where
The binary sequence is given by Table 10.2.7.2.1-1. The cyclic shift in frame
number is given by
.
Table 10.2.7.2.1-1: Definition of .
* * *
0 [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1] 1 [1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1
1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 -1 1 1
-1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 -1 1
1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 -1
1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1] 2 [1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1
1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1
-1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1
-1 1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1
1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1] 3 [1 -1 -1 1 -1 1 1 -1 -1 1 1
-1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 1 -1
-1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 1
-1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1
-1 1 1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1]
##### 10.2.7.2.2 Mapping to resource elements
The same antenna port shall be used for all symbols of the narrowband
secondary synchronization signal within a subframe.
UE shall not assume that the narrowband secondary synchronization signal is
transmitted on the same antenna port as any of the downlink reference signals.
The UE shall not assume that the transmissions of the narrowband secondary
synchronization signal in a given subframe use the same antenna port, or
ports, as the narrowband secondary synchronization signal in any other
subframe.
The sequence shall be mapped to resource elements in sequence starting with in
increasing order of first the index over the 12 assigned subcarriers and then
the index over the assigned last symbols of subframe 9 in radio frames
fulfilling , where is given by Table 10.2.7.2.2-1.
Table 10.2.7.2.2-1: NSSS number of symbols
Cyclic prefix length
* * *
Normal 11
For resource elements overlapping with resource elements where cell-specific
reference signals according to clause 6.10 are transmitted, the corresponding
sequence element is not used for the NSSS but counted in the mapping process.
### 10.2.8 OFDM baseband signal generation
For an NB-IoT carrier for which the higher layer parameter _operationModeInfo_
does not indicate \'_inband-SamePCI\'_ , for an NB-IoT carrier for which the
higher layer parameter _CarrierConfigDedicated-NB_ is present and no
_inbandCarrierInfo_ is present, or for an NB-IoT carrier for which the higher
layer parameters _CarrierConfigDedicated-NB_ and _inbandCarrierInfo_ are
present and the higher layers do not indicate is the same as , then the time-
continuous signal on antenna port in OFDM symbol in a downlink slot is defined
by
for where , , and is the content of resource element on antenna port .
Otherwise, the time-continuous signal on antenna port in OFDM symbol , where
is the OFDM symbol index from the start of the last even-numbered subframe, is
defined by
for where and, if resource element is used for Narrowband IoT, and 0
otherwise, and is the frequency location of the center of the Narrowband IoT
PRB minus the frequency location of the center of the LTE signal.
Only normal CP is supported for Narrowband IoT downlink in this release of the
specification.
### 10.2.9 Modulation and upconversion
Modulation and upconversion to the carrier frequency of the complex-valued
OFDM baseband signal for each antenna port is shown in Figure 6.13-1. The
filtering required prior to transmission is defined by the requirements in
3GPP TS 36.104 [6].
#