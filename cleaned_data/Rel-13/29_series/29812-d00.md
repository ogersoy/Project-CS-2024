# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document contains a detailed description of the SCC AS restoration
procedure to be used in the eSRVCC network specially. The purpose of the SCC
AS restoration procedure, as described in the present document, is to ensure
that the originating or terminating session is continued or resumed as soon as
possible when some the SCC AS in the SCC AS pool is out of service. The
document defines the SCC AS failure scenarios, possible solutions and solution
analysis. For the related procedure and functionality of S-CSCF, SCC AS, ATCF
and HSS in the IMS and eSRVCC environment, it is based on the requirement in
3GPP related specifications
As the introduction of eSRVCC, the SCC AS shall exchange eSRVCC related
parameters with ATCF and HSS during initial registration and re-registration
procedures as described in 3GPP TS 24.237 [2], which is different from all
other ASs.
i) ATCF reports its ATCF-Management-URI and ATCF-Path-URI towards the SCC AS,
and the SCC AS stores it for later routing of MESSAGE.
ii) SCC AS shall send MESSAGE to ATCF with its own ATU-STI based on ATCF-
Management-URI received, in order to ensure the routing of eSRVCC procedure
triggered by ATCF later.
iii) SCC AS shall also update the received ATCF-Path-URI of ATCF towards HSS,
HSS forwards it to MME, and stores it for subscriber downloading to SCC AS
later.
The present document analysis SCC AS failure implications in eSRVCC network,
it studies possible solutions and determines whether any should be
standardize.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 24.237: \"IP Multimedia Subsystem (IMS) Service Continuity\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] apply.
# 4 SCC-AS restoration use cases
# 4.1 Introduction
The SCC-AS has two important functionalities, T-ADS and SRVCC handling. As
current 3GPP specification, if SCC-AS fails, the S-CSCF shall either continue
or terminate the session based on the default handling defined in the matched
filter criteria for the originating or terminating session request. Both
behaviours for the S-CSCF will bring bad user experience for the subscribers.
If the choice is terminating the session, the call cannot be setup. If the
choice is continuing the session, if SRVCC happens, the call will be dropped.
Hence, the SCC-AS restoration is important solution for improve user
experience.
For the SCC-AS restoration, When there is a service request coming to the SCC-
AS, the SCC-AS may be in failure status or has restored. If the SCC-AS has
restored from the failure, the SCC-AS could obtain the subscriber service data
from the HSS. _For example, the restored SCC_ -_AS receives a service request
for a subscriber from the S-CSCF, but the SCC_ -_AS doesn't have the service
data of this subscriber, then the SCC_ -_AS could request the_ transparent
data via Sh interface from the HSS in order to provide the service to the
subscriber. So, the discussion on the restoration of the SCC-AS is focused on
the scenario that the SCC-AS is in the failure status.
When there is a service request coming to the SCC-AS in failure, the following
clauses describes the outcome in several different cases.
## 4.2 SCC-AS restoration Description
### 4.2.1 Third Party Registration Request
During the registration of the subscriber, the third party registration
request will be triggered, and the S-CSCF will check whether the Filter
Criteria of the subscriber matches the register request from the UE. If the
SCC-AS matches the Filter Criteria of the subscriber service profile for the
event of REGISTER request, the S-CSCF will initiate the third-party REGISTER
request to the SCC-AS.
If the SCC-AS is down or failed, the SCC-AS could not respond the third party
registration request, or the SCC-AS would return a failure response to the
S-CSCF. According to the current 3GPP specification, the S-CSCF may abort
sending the third-party REGISTER request, or initiate network-initiated
deregistration procedure based on the information in the Filter Criteria.
Although there may be more than one SCC-ASs providing the same service, the
subscriber cannot register to any other available SCC-AS, and the related
service cannot be provided to the subscriber.
### 4.2.2 Originating and Terminating Service Request
When the S-CSCF receives a session originating or terminating service request
from the UE, the S-CSCF will check whether the Filter Criteria of the
subscriber matches the service request. If the SCC-AS matches the Filter
Criteria of the subscriber service profile for the event of service request,
then the S-CSCF will forward the service request to the SCC-AS.
If the SCC-AS is down or failed, the SCC-AS could not respond the service
request, or the SCC-AS would return a failure response to the S-CSCF.
According to the current 3GPP specification, if the S-CSCF fails to receive a
SIP response or receives a 408 (Request Timeout) response or a 5xx (Failure
Response) response from the SCC-AS, the S-CSCF shall either continue or
terminate the session based on the default handling defined in the matched
filter criteria.
If the filter criteria are terminating the session, although there may be more
than one SCC-AS providing the same service, the subscriber cannot register to
another available SCC-AS, and the related service cannot be provided to the
subscriber.
If the filter criteria are continuing the session, for the originating session
request, if SRVCC happens, the session will be broken because the originating
SCC-AS is not inserted into the session and SRVCC cannot be handled in the IMS
core network. For the terminating session request, the terminating T-ADS
cannot be executed and the call perhaps cannot be successful setup, and if the
SRVCC happens during the call, the session will be dropped because the
terminating SCC-AS is not inserted into the session and SRVCC cannot be
handled in the IMS core network.
# 5 Alternative solutions
## 5.1 Solution1
### 5.1.1 Introduction
During the 3^rd^ party registration, the SCC-AS should store extra SRVCC
related information in the HSS as Repository Data.
When a service request is received when assigned SCC-AS is down, the S-CSCF
should forward the service request to a working SCC-AS and this SCC-AS should
upload corresponding SRVCC related information previously stored in the HSS
and it should notify the ATCF with its own ATU-STI for SRVCC.
### 5.1.2 Procedure
The SCC-AS is required to store new added SRVCC related information, i.e,
ATCF-Path-URI and ATCF management URI, in HSS as Repository Data upon
successful 3^rd^ party registration. Then during service request procedure,
S-CSCF should try to contact another working SCC-AS when the previous SCC-AS
fails.
When the session service request is received by a new SCC-AS without
subscriber data, the new SCC-AS shall retrieve the relevant subscription data
including SRVCC related information from HSS (if it is stored as Repository
Data), then process the service request as normal. If SRVCC related
information was stored as Repository Data, the SCC-AS shall send MESSAGE with
its own ATU-STI to the corresponding ATCF in order to execute followed PS to
CS SRVCC procedure.
#### 5.1.2.1 Procedure for Enhanced Third Party Registration
Enhanced third party registration procedure is described in figure 5.1.2.1-1.
###
Figure 5.1.2.1-1 Enhanced Third Party Registration Procedure
_1-20. Registration procedure as normal._
  1. _For the first time the SCC AS receives a third party registration of a served user, the SCC-AS stores the ATCF-Path-URI and ATCF--mgmt-URI parameters contained in the SIP REGISTER request as new Repository Data in the HSS. The SCC AS may as well store this data locally, and then for the subsequent third party registration of that served user, if the ATCF-path-URI or the ATCF-mgmt-URI contained in the SIP REGISTER request is different from previously stored one, the SCC AS updates the locally stored ATCF-path-URI or the ATCF-mgmt-URI as well as that stored in the HSS as Repository Data with the new received value. The SCC AS already updates STN-SR in the HSS using PUR/PUA command, then the SCC AS may send the new Repository Data along with STN-SR in a single PUR (only if Update-Eff-Enhance feature is supported)._
  2. _HSS updates data and responds back._
23-24. HSS sends the received STN-SR and C-MSISDN to update MME as normal.
#### 5.1.2.2 Procedure for Enhanced Service Request
Enhanced service request procedure is described in figure 5.1.2.2-1.
Figure 5.1.2.2-1 Enhanced Service Request Procedure
  1. _The S-CSCF receives session service request message and routes the message towards the registered SCC-AS._
```{=html}
``` 1\. _The S-CSCF detects the failure of SCC-AS._
  1. _S-CSCF re-selects a new SCC-AS e.g. by a DNS procedure or by a configuration in the matched Filter Criteria to provide services to the user._
  2. _The S-CSCF sends the message to the selected SCC-AS._
  3. _After receiving the service request message, if no subscriber data is found, the new SCC-AS shall start implicit registration procedure as normal. After retrieving the subscriber data from the HSS, the new SCC-AS shall upload as well the SRVCC related information if it was stored as Repository Data what is a new requirement to SCC-AS._
  4. _If ATCF-Path-URI and ATCF management URI are stored as Repository Data in the HSS, the SCC-AS shall send a MESSAGE with its own ATU-STI towards the ATCF, identified by that ATCF management URI. The trigger of sending Message is a new requirement to SCC-AS, but the Message sending procedure is normal and part of existing eSRVCC procedure._
  5. _SCC-AS continues the session as normal._
### 5.1.3 Analysis
This solution allows the service request could be continued successfully.
Only SCC-AS is needed to be enhanced to support new functionalities. Summary
of impacts:
  * During registration procedure, the SCC-AS shall store both ATCF-Path-URI and ATCF management URI as new Repository Data to the HSS via Sh.
  * The new SCC-AS is required to retrieve new SRVCC related information if it was stored in the HSS. If so, the SCC-AS sends MESSAGE towards the corresponding ATCF to update ATU-STI stored in this ATCF.
This solution has the following advantages:
\- Interfaces are not impacted and only the SCC AS procedures need to be
modified.
\- If new data is required to be included in the future, impacts are limited
to the SCC AS.
\- Impacts are limited to one single node.
This solution has the following disadvantages:
\- A new message interchange is required between the SCC-AS and the HSS for
every initial registration. This increases the demand on HSS processing needs,
what may be critical during network recovery situations, where a high amount
of initial registrations is received. When data is stored in 3GPP UDR, in 3GPP
UDC architecture, the traffic increase affects as well to Ud interface.
> However, this may be enhanced if Update-Eff-Enhance feature is supported by
> both the SCC-AS and the HSS, since an initial registration requires to
> update STN-SR in the HSS if modified.
# 6 Conclusions and recommendations
The procedure described in clause 5.1 has been selected as the preferred way
to handle the scenario for SCC-AS restoration.
#