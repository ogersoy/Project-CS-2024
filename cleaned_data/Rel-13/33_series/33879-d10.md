# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document contains a study of the security aspects of the Mission-
Critical Push-To-Talk (MCPTT) service and its interaction with the network.
This includes an analysis of the threats to the service, the security
requirements to mitigate those threats and an evaluation of possible technical
solutions designed to meet the security requirements of the service.
The Stage 1 requirements for the service are defined in TS 22.179 [2]. An
evaluation of Stage 2 architectural solutions for MCPTT is performed in TR
23.779 [3] and TS 23.179 [10]. This study will include consideration of
relevant 3GPP specifications, particularly for ProSe (TS 33.303 [4], TS 23.303
[5]) and GCSE (TS 23.468 [6]).
The focus of the present document is to support public-safety use cases of
MCPTT. Commercial scenarios are not specifically considered and some features
may not be applicable to them.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.179: \"Mission Critical Push To Talk (MCPTT) over LTE\".
[3] 3GPP TR 23.779: \"Study on architectural enhancements to support Mission
Critical Push To Talk over LTE (MCPTT) services\".
[4] 3GPP TS 33.303: \"Proximity-based Services (ProSe); Security aspects\".
[5] 3GPP TS 23.303: \"Proximity-based services (ProSe); Stage 2\".
[6] 3GPP TS 23.468: \"Group Communication System Enablers for LTE (GCSE_LTE);
Stage 2\".
[7] IETF RFC 3711: \"The Secure Real-time Transport Protocol (SRTP)\".
[8] 3GPP TS 33.210: \'\'3G security; Network Domain Security (NDS); IP network
layer security\'\'.
[9] 3GPP TS 33.203: \'\'3G security; Access security for IP-based
services\'\'.
[10] 3GPP TS 23.179: \"Functional architecture and information flows to
support mission critical communication services\".
[11] 3GPP TS 29.468: \"Group Communication System Enablers for LTE (GCSE_LTE);
MB2 reference point\".
[12] 3GPP TS 33.328: \'\'IP Multimedia Subsystem (IMS) media plane
security\'\'.
[13] IETF RFC 6509: \'\'MIKEY-SAKKE: Sakai-Kasahara Key Encryption in
Multimedia Internet KEYing (MIKEY)\'\'.
[14] IETF RFC 3550: \'\'RTP: A Transport Protocol for Real-Time
Applications\'\'.
[15] IETF RFC 7636: \"Proof Key for Code Exchange by OAuth Public Clients\".
[16] OpenID Foundation \"OpenID Connect Basic Client Implementer\'s Guide 1.0
- draft 37\", http://openid.net/specs/openid-connect-basic-1_0.html.
[17] OpenID Foundation \"OpenID Connect Core 1.0 incorporating errata set 1\",
http://openid.net/specs/openid-connect-core-1_0.html
[18] void.
[20] void.
[21] 3GPP TS 33.401: \'\'3GPP System Architecture Evolution (SAE); Security
architecture\'\'.
[22] 3GPP TR 33.888: \"Study on security issues to support Group Communication
System Enablers (GCSE) for LTE\".
[23] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[24] 3GPP TS 23.002: \"Network Architecture\".
> [25] 3GPP TS 33.310: \"Network Domain Security (NDS); Authentication
> Framework (AF)\".
[26] IETF RFC 6507: \'\' Elliptic Curve-Based Certificateless Signatures for
Identity-Based Encryption (ECCSI)\'\'.
[27] IETF RFC 6508: \'\' Sakai-Kasahara Key Encryption (SAKKE)\'\'.
[28] IEFT RFC 7714: \"AES-GCM Authenticated Encryption in Secure RTP (SRTP) \"
[29] 3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to
network application functions using Hypertext Transfer Protocol over Transport
Layer Security (HTTPS)\"
[30] IETF RFC 5751: \"Secure/Multipurpose Internet Main Extensions (S/MIME)
Version 3.2 Message Specification\".
[31] IETF RFC 4483: \"A Mechanism for Content Indirection in Session
Initiation Protocol (SIP) Messages\".
[32] IETF RFC 4825: \"The Extensible Markup Language (XML) Configuration
Access Protocol (XCAP)\".
[33] IETF RFC 5652: \"Cryptographic Message Syntax (CMS)\".
[34] W3C: \"XML Encryption Syntax and Processing Version 1.1\",
https://www.w3.org/TR/xmlenc-core1/.
[35] W3C: \"XML Signature Syntax and Processing (Second Edition)\",
http://www.w3.org/TR/xmldsig-core/.
[36] IETF RFC 3830: \" MIKEY: Multimedia Internet KEYing\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
Terms and definitions given in 3GPP TS 22.179 [2] also apply in this document.
**Ambient Listening** : The ability to remotely activate the microphone on a
user\'s terminal (as long as the radio is turned on) without that person\'s
knowledge and to hear what is happening or being said in the immediate
vicinity of the microphone.
NOTE: The monitoring is carried out using the standard dispatcher equipment in
the control room.
**Discreet Listening** : A service enabling an authorised user like a
dispatcher to covertly (secretly) monitor the calls in progress
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] , TS 23.179 [10], and the following apply.\ An abbreviation defined
in the present document takes precedence over the definition of the same
abbreviation, if any, in 3GPP TR 21.905 [1].
CSC Common Services Core
DMO Direct Mode Operation
GMK Group Master Key
GMK-ID Group Master Key Identifier
GMS Group Management Server
GUK-ID Group User Key Identifier
IdM Identity Management
IDRi IDentiy Role initiator
KMS Key Management Server
MBCP Media Burst Control Protocol
MCPTT Mission Critical Push to Talk
MIKEY Multimedia Internet KEYing
MKI Master Key Identifier
OIDC OpenID Connect
PCK Private Call Key
PCK-ID Private Call Key Identifier
PSK Pre-Shared Key
RTCP Real-Time Transport Control Protocol
S/MIME Secure / Multipurpose Internet Mail Extensions
SDES Session Description Protocol Security
SRTCP Secure Real-Time Transport Control Protocol
SRTP Secure Real-Time Transport Protocol
ROC Roll-Over-Counter
SSRC Synchronization Source
TBCP Talk Burst Control Protocol
UID User Identity
# 4 Overview of Mission Critical Push-to-Talk (MCPTT)
## 4.1 Introduction
The Push To Talk service provides a method by which two or more users may
engage in communication. MCPTT Service builds on the existing 3GPP transport
communication mechanisms provided by the EPS architecture to establish,
maintain, and terminate the actual communication path(s) among the users.
MCPTT can make use of capabilities included in Group Communications System
Enablers for LTE (GCSE_LTE) and Proximity Services (ProSe), with additional
requirements specific to the MCPTT Service. The MCPTT Service can be used for
public safety applications and also for general commercial applications.
## 4.2 Architecture
### 4.2.1 General
The full MCPTT architecture is described in TS 23.179 [10]. This clause
summarises the various elements of the MCPTT architecture. The functional
model for the support of MCPTT is defined as a series of planes to allow for
the breakdown of the architectural description. The following planes are
identified:
\- Application plane.
\- Signalling control plane.
Furthermore, the MCPTT service is described in two modes of operation; on-
network and off-network.
### 4.2.2 MCPTT application plane
Figure 4.2.2-1 shows the MCPTT application plane for on-network operation.
Figure 4.2.2-1: The MCPTT application plane
The MCPTT-1 reference point, which exists between the MCPTT client and the
MCPTT server for MCPTT application signalling for establishing a session in
support of MCPTT, uses the SIP-1 and SIP-2 reference points for transport and
routing of signalling. Reference point MCPTT-1 also may provide the MCPTT
server with location information with respect to multicast service
availability for the MCPTT Client. MCPTT-1 includes the reference point GC1
between the GCS AS, here assumed by the MCPTT server, and the MCPTT client as
defined in 3GPP TS 29.468 [11].
MCPTT-2 provides for the MCPTT server to obtain information about a specific
user. The MCPTT-2 reference point utilises the Sh reference point as defined
in 3GPP TS 23.002 [24].
The MCPTT-3 reference point, which exists between the MCPTT server and the
MCPTT server for MCPTT application signalling for establishing MCPTT sessions,
uses the SIP-2 reference point for transport and routing of signalling. If
each MCPTT server is served by a different SIP core then the MCPTT-3 reference
point also uses the SIP-3 reference point for transport and routing of
signalling. Floor control signalling and media are also transferred using the
MCPTT-3 reference point.
MCPTT-4 provides floor control signalling between the floor control server in
the MCPTT server and the floor participant over a unicast bearer. The MCPTT-4
reference point uses the SGi reference point in 3GPP TS 23.002 [24].The
MCPTT-5 reference point is used by the media distribution function of the
MCPTT server to obtain unicast bearers with appropriate QoS from the EPS. It
utilises the Rx interface of the EPS.
MCPTT-6 is used to request the allocation and activation of multicast
transport resources for MCPTT application usage. It uses the MB2-C interface
as defined in 3GPP TS 29.468 [11].
The MCPTT-7 reference point is used to exchange unicast media between the
media distribution function of the MCPTT server and the media mixer of the
MCPTT client. The MCPTT-7 reference point uses the SGi reference point defined
in 3GPP TS 23.002 [24].
The MCPTT-8 reference point is used by the media distribution function of the
MCPTT server to send multicast media to the media mixer of the MCPTT client.
It is sent via the MB2-u interface defined in 3GPP TS 23.468 [6].
The MCPTT-9 reference point provides floor control signalling between the
floor control server and the floor participant over a multicast bearer. The
MCPTT-9 reference point uses the MB2-U interface defined in 3GPP TS 23.468
[6].
CSC-1 provides for the mutual authentication between the user equipment and
the common services core on behalf of applications within the application
plane.
The CSC-2 reference point, which exists between the group management client
and the group management server for MCPTT application signalling for MCPTT
data management of the MCPTT service, uses the HTTP-1 and HTTP-3 reference
points for transport and routing of non-subscription/notification related
signalling. The CSC-2 reference point uses SIP-1 and SIP-2 reference points
for transport and routing of subscription/notification related signalling.
CSC-3 provides for the MCPTT server to obtain information about groups and
uses HTTP-2 and HTTP-3 reference points for transport and routing of non-
subscription/notification related signalling. The CSC-3 reference point uses
SIP-2 reference point for transport and routing of subscription/notification
related signalling.
CSC-4 provides the configuration information required for MCPTT services
between the configuration management client and the configuration management
server.
\- configuration of the MCPTT UE by the MCPTT service; and
\- configuration of the MCPTT application MCPTT service related information
that is not part of group management (e.g. policy information) by the MCPTT
UE.
The CSC-4 reference point uses the HTTP-1 and HTTP-3 reference points for
transport and routing of non-subscription/notification related signalling. The
CSC-4 reference point uses SIP-1 and SIP-2 reference points for transport and
routing of subscription/notification related signalling.
The CSC-5 reference point provides for the MCPTT server to obtain non-group
MCPTT service related information (e.g. policy information). The CSC-5
reference point uses HTTP-2 reference point for transport and routing of non-
subscription/notification related signalling. The CSC-5 reference point uses
SIP-2 reference point for transport and routing of subscription/notification
related signalling.
The CSC-6 reference point provides a means for the MCPTT server and the
identity management server to share user identity information.
The CSC-7 reference point, which exists between group management servers,
allows group management servers to handle group management related signalling
in multiple MCPTT systems environment. The CSC-7 reference point uses the
HTTP-2, HTTP-3 and HTTP-4 reference points for transport and routing of non-
subscription/notification related signalling. The CSC-7 reference point uses
SIP-2 and SIP-3 reference points for transport and routing of
subscription/notification related signalling.
### 4.2.3 MCPTT signalling plane
Figure 4.2.3-1 shows the MCPTT signalling plane for on-network operation.
Figure 4.2.3-1: The MCPTT signalling control plane
The SIP-1 reference point, which exists between the signalling user agent and
the SIP core for establishing a session in support of MCPTT, uses the 3GPP Gm
reference point as defined in 3GPP TS 23.002 [24]. The SIP-1 reference point
fulfils the requirements of the GC1 reference point specified in 3GPP TS
23.468 [6].
The SIP-2 reference point, which exists between the SIP core and the SIP AS
for establishing a session in support of MCPTT, uses the 3GPP ISC interface
and Ma reference point as defined in 3GPP TS 23.002 [24].
The SIP-3 reference point, which exists between one SIP core and another SIP
core for establishing a session in support of MCPTT, uses the 3GPP Mm and ICi
reference points as defined in 3GPP TS 23.002 [24].
The HTTP-1 reference point, which exists between the MCPTT UE HTTP client and
the HTTP proxy for MCPTT data management of the MCPTT service, uses the 3GPP
Ut reference point as defined in 3GPP TS 23.002 [24] (with necessary
enhancements to support MCPTT requirements).
The HTTP-2 reference point exists between the HTTP client in the MCPTT server
in a trusted domain and the HTTP proxy for MCPTT data management of the MCPTT
service.
The HTTP-3 reference point exists between the HTTP proxy and the HTTP server
for MCPTT data management of the MCPTT service.
The HTTP-4 reference point exists between the HTTP proxy and another HTTP
proxy in a different network for MCPTT data management of the MCPTT service.
The AAA-1 reference point is used by the SIP core to retrieve signalling plane
data from the SIP database. The AAA-1 reference point utilises the Cx
reference point as defined in 3GPP TS 23.002 [24].
### 4.2.4 Off-network functional model
The off-network functional model for the MCPTT system solution is illustrated
in figure 4.2.4-1.
Figure 4.2.4-1: Off-network functional model
## 4.3 MCPTT identity definition and usage
Definitions, roles, and usage of the MCPTT application layer identities and
the MCPTT signalling layer identities are specified in TS 23.179 [10].
# 5 List of assets
This clause lists assets within the MCPTT system. Identification of these
assets helps to define the extent of the MCPTT study, and establish common
terminology for the study.
The following are assets with the MCPTT system:
\- MCPTT User ID. This is used to identify the MCPTT User within the MCPTT
system. As discussed in clause 4.7 of TS 22.179 [2], this may be a true
identifier or an alias.
\- MCPTT Group ID. This is used to identify the MCPTT Group within the MCPTT
system. As discussed in clause 4.7 of TS 22.179, this may be a true identifier
or an alias.
\- List of MCPTT User IDs within a specific MCPTT Group (Group Membership).
\- MCPTT User location as described in TS 22.179, clause 5.12, 6.12 and 7.9.
\- User Key material. This includes all key material specific to a user. For
example, this may include key material used to authenticate a user to the
MCPTT system, or to protect private calls made by the user.
\- Group Key material. This includes all key material used to protect group
communications.
\- MCPTT signalling, including session setup.
\- MCPTT Floor control.
\- MCPTT User Traffic
\- MCPTT User access to MCPTT services (e.g. Private calls, Group calls,
etc.).
\- MCPTT User access to 3GPP services (e.g. ProSe to support Off-Network MCPTT
Service, c.f. TS 22.179, clause 5.16).
\- Administration of MCPTT system, including security functions (c.f. TS
22.179, clause 5.18).
\- Remote Administration of the MCPTT Application. For example, administration
which allows disabling a MCPTT UE, Ambient Listening, remotely initiated
calls, or changing the Selected MCPTT Group (c.f. TS 22.179, clause 6.4).
\- Intra-network communications of MCPTT system functions.
# 6 Security analysis of MCPTT
## 6.1 General security requirements
The service requirements for MCPTT can be found in TS 22.179 [2].
## 6.2 Key Issue # 1: Configuration & service access
### 6.2.1 Issue details
In order to use the MCPTT Application, the MCPTT Service needs to configure
the MCPTT UEs to use the MCPTT Service. Furthermore, in order to allow an
MCPTT User access to user-specific services, the MCPTT Service needs to
configure the MCPTT UE with user-profile information.
MCPTT UE configuration may include application configuration, cryptographic
algorithms, available services (e.g. ProSe), global policies, etc. The MCPTT
User-profile may include authorisation to use specific services, MCPTT Groups,
group affiliations, the default selected group. The configuration process(es)
may be used to enable or to disable access to MCPTT services.
Both these access/configuration processes need to be appropriately secured,
both in terms of authenticating the MCPTT Service, UE and user and in terms of
ensuring the transfer of data is protected.
### 6.2.2 Security threats
There are several threats to the downloading of configuration data to the UE.
\- An attacker pretending to be an authorised network server may maliciously
configure the MCPTT UE with false configuration data, thus causing improper
operation of the MCPTT application.
\- An attacker pretending to be an authorised network server may maliciously
delete MCPTT UE configuration or user-profile data, rendering the MCPTT
Application inoperable.
\- Similarly an attacker pretending to be an MCPTT UE or MCPTT user may
download configuration or profile information intended for another UE or user.
Such an attack may allow an escalation of the attacker\'s privileges.
\- An attacker may manipulate or modify the data being transmitted between the
MCPTT Service and the MCPTT UE, thus adversely affecting the configuration or
user-profile data.
\- An attacker may eavesdrop on transmitted configuration data or user-profile
data and further distribute it to unauthorized parties for improper use.
\- An attacker may replay intercepted configuration data or user-profile data
thus affecting an expected configuration state at the MCPTT UE and/or MCPTT
network server.
### 6.2.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
\- The MCPTT UE and the network entity providing the MCPTT configuration data,
shall mutually authenticate each other prior to MCPTT UE configuration to use
the MCPTT service.
\- The MCPTT User and the MCPTT Service shall mutually authenticate each other
prior to providing the MCPTT UE with the MCPTT User profile and access to
user-specific services.
\- The transmission of configuration data and user profile data between an
authorized MCPTT server in the network and the MCPTT UE shall be
confidentiality protected, integrity protected and protected from replays.
## 6.3 Key Issue # 2: Group Key Management
### 6.3.1 Issue details
An essential part of MCPTT is to be able to communicate within a MCPTT Group.
To securely talk within an MCPTT Group a group security context will need to
be established by the MCPTT Service. During establishment and distribution of
a group security context, it is essential that the group key material is
appropriately protected.
Based upon TS 22.179 [2], there are a variety of ways to create a new group:
  * Group creation via MCPTT Administrator -- normal association of a user to a group to allow communication. The group could be a normal group, or a broadcast group, and could support off-network operation.
  * Group creation via \"Group-Regroup\" -- dynamically combining groups. Groups may be at different security levels. Groups may be combined by entities other than Administrators (e.g. Dispatchers).
  * Group creation via \"User-Regroup\" -- temporary groups dynamically created by authorised users.
To support these group creation mechanisms, the group key distribution
process(es) needs to be able to support the secure distribution of key
material from a variety of authorised sources, and the ability to re-establish
the security association (rekey) at any time.
### 6.3.2 Security threats
The following threats apply during group key distribution:
\- Interception of group key material. This would enable an attacker to
compromise the communications of the group.
\- Undetected modification of group key material. This would enable an
attacker to deny service to group members or potentially compromise the
communications of the group.
\- Impersonation of a distributor of group key material. This would enable an
attacker to rekey a group and thus compromise communications, or enable the
unauthorised creation/combining of groups.
\- Unauthorised receipt of group key material, e.g. for a group for which the
MCPTT User is not a member.
\- Unauthorised modification of group key material, e.g. through overwriting
of group key material via an authorised creation of a new group.
\- Failure to update a group security context. Should it not be possible to
update a group security context, the group\'s communications may be vulnerable
in the event a group key is compromised.
\- Failure to revoke a group security context. If it is not possible to revoke
a group security context, MCPTT UEs may continue to use compromised key
material without knowledge of compromise.
### 6.3.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
\- Group key material shall be integrity and confidentiality protected for a
specific MCPTT User during distribution from the MCPTT service to MCPTT UEs.
\- Group key material shall be authenticated as coming from a valid,
authorised source. The authorised source may be an MCPTT Administrator or may
be another authorised entity (e.g. an authorised MCPTT User or Dispatcher).
\- It shall be possible for authorised entities to dynamically create and
distribute a new group security context at any time. This may be as part of a
group creation process, be due to a periodic update to maintain key freshness,
or due to compromise of group key material.
\- The creation of a new group security context (e.g. via User-Regroup
operation) shall not change or compromise an existing group security context.
\- It shall be possible for an authorised, authenticated entity to revoke and
update a group security context from use.
## 6.4 Key Issue # 3: On-Network Operation: denial of service
### 6.4.1 Issue details
An adversary attempts to prevent a valid MCPTT user or group from obtaining
service.
### 6.4.2 Security threats
a) Malicious Deregistration of user. The adversary sends registration or
deregistration commands which purport to have originated from the target user,
or manipulates some control interface of the MCPTT server.
b) Network flooding. Adversaries create large volumes of traffic to reduce
available capacity and impede communications between users.
c) Misuse of secure disable protocols. Adversary uses a disable protocol to
put user device out of service.
### 6.4.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) All users of the MCPTT service shall be authenticated to prevent an
adversary impersonating a user for the purpose of denial of service.
b) The MCPTT service should take measures to detect and mitigate DoS attacks
to minimise the impact on the network and on MCPTT users.
## 6.5 Key Issue # 4: Ambient Listening
### 6.5.1 Key issue details
Ambient Listening is a feature that allows an authorized MCPTT User, typically
a dispatcher, to cause an MCPTT UE to initiate a call which results in no
indication on the MCPTT UE that it is transmitting. Ambient Listening can be
initiated by an authorized MCPTT User who wants to be listened to by another
remote authorized MCPTT User or can be initiated by a remote authorized MCPTT
User who wants to listen to another MCPTT User.
The facility has several possible uses including protecting communities and
radio users, however it is recognised that it may impact on the personal
privacy of handset users and members of the public and therefore needs to be
properly controlled and used.
Situations where Ambient Listening may be activated include:
a) For monitoring a confrontational situation to ensure user safety, locating
a handset user with whom contact has been lost or to locate a lost or stolen
radio terminal.
b) During hostage negotiation to allow a coordinator to monitor a situation
remotely or as an alternative to a field telephone in siege situations.
c) As an investigation tool for evidence gathering in cases of suspected gross
misconduct of staff or evidence gathering in criminal cases. In both these
later cases, security.
### 6.5.2 Security threats
Misuse of the Ambient Listening feature causes an impact on the privacy of the
MCPTT User or it causes the unauthorised disclosure of sensitive information.
### 6.5.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
\- Specific roles in the organisation and shall be identified to authorise and
activate Ambient Listening and privileges shall be assigned to these roles to
activate and register the use of ambient listening.
\- The activation of the Ambient Listening functionality shall be
automatically registered by the system and will be stored as an 'event\' by
the system.
\- Any decision to activate Ambient Listening, or review of such a decision,
may also be recorded in a suitable incident log unless to do so would
interfere with the purpose for which the functionality is being used i.e. in
situation (c) above. If this is the case the authorisation needs to be
recorded elsewhere as appropriate.
\- A radio user should be told as soon as possible that they are, or have
been, subject to Ambient Listening and the reason why the functionality was
activated. The fact they have been informed, by whom and when, should be
recorded in a suitable log.
## 6.6 Key Issue # 5: Data communication security between MCPTT network
entities
### 6.6.1 Issue details
MCPTT network entities will be required to communicate with each other. It is
important that this may be performed securely.
### 6.6.2 Security threats
There are several threats to the communication between 3GPP MCPTT network
entities including forged or replayed messages and eavesdropping on the
contents of the messages.
### 6.6.3 Potential security requirements
The following requirement serves as a guideline for future normative work:
A security mechanism shall exist that allows transmission of data between 3GPP
MCPTT network entities to be authenticated, confidentiality protected,
integrity protected and protected from replays.
NOTE: UE-to-UE and UE-to-network relays are not considered to be \'network
entities\'.
## 6.7 Key Issue # 6: On-Network Operation: impersonation
### 6.7.1 Issue details
An imposter may attempt to impersonate a valid MCPTT user for the purposes of
fraud, misinformation or eavesdropping.
### 6.7.2 Security threats
a) Impersonation of individual user. Adversary masquerades as a valid system
user, accessing from a UE within the 3GPP network for purposes of fraud,
misdirection etc.
b) Impersonation of group. A group communication is impersonated to misinform
or misdirect group members. The modes of attack may be different depending on
the bearer service in use.
c) Impersonation of MCPTT server. The user is persuaded to connect to a false
MCPTT server in order to deny service, manipulate the user etc.
d) Man in the middle attack. An attacker inserts himself between the user and
the MCPTT server to intercept information, generate false calls or deny
service to calls, or to modify the security of the service, e.g. force the
user to negotiate a lower security level.
e) Misuse of client terminal. A client terminal is stolen (which may still be
logged on to the service), or illegally loaned, and used to receive or
generate communications whilst purporting to be the valid user. Credentials
could be obtained from a stolen terminal and used to impersonate the valid
user, even after the terminal has been recovered.
### 6.7.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT user shall be authenticated by the MCPTT application.
b) A mechanism shall exist that allows the MCPTT application to be
authenticated by the MCPTT user.
c) The MCPTT UE and MCPTT service should enforce the result of the
authentication for the duration of communications (e.g. by integrity
protection or implicit authentication by encryption with a key that is derived
from the authentication and is unknown to the adversary).
d) The security solution should minimise the impact of a compromised MCPTT UE
on other MCPTT UEs.
## 6.8 Key Issue # 7: On-Network Operation: manipulation
### 6.8.1 Issue details
An adversary may attempt to manipulate information relating to an MCPTT user
or group.
### 6.8.2 Security threats
a) Falsification of call records. An adversary manages to modify call record
information for purposes of fraud, or to falsify an audit trail.
b) Alteration of configuration. An adversary changes programming information
in the client application, or changes configuration e.g. to change or deny
access permissions in client application or MCPTT server.
c) Hijacking of calls. An adversary takes over a call in progress and replaces
call information from one party with his own, clears the call etc.
### 6.8.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT Service shall provide a means to ensure integrity of all MCPTT
user signalling at the application layer.
b) The MCPTT Service shall protect the administrative and security management
parameters from manipulation by individuals who are not explicitly authorized
by the Mission Critical Organization.
## 6.9 Key Issue # 8: On-network operation: traffic analysis
### 6.9.1 Issue details
MCPTT users require their identities to be confidential, and some specialist
users will be particularly sensitive to any form of traffic analysis which
could result in details of their operations or operational roles being
deduced. Additionally recovery of identities and signalling patterns may
reveal information concerning organisational structure, or ongoing operational
activities. Identified users may also become targets for impersonation, or for
denial of service attacks such as jamming.
### 6.9.2 Security threats
a) Matching of user identity with subscriber terminal identity. The user can
be identified by the subscription in use, enabling tracking by non-security
cleared personnel or a skilled adversary intercepting identities sent in clear
at registration or finding a vulnerable point in the network.
b) Identifying highly secure users within user pool. Certain specialist users
have much higher demands for security and are very sensitive to identity and
location, and should not stand out within the greater volume of public safety
users.
c) Identification of group addresses. Group addresses relate to operational
roles, and identification of these allows analysis of user movements and
operational behaviour.
d) Identifying user affiliation to groups. Identification of user affiliation
to groups can provide information on the operational roles of a user at a
particular point of time, and the numbers of affiliations to a group at any
one time provides further information to an adversary.
e) Identification of called or calling numbers. Identification of called or
calling parties of calls made to or from any user both can provide information
about that user\'s current role, and also can expose the identities and roles
of the that other party.
f) Identification of users by consistent use of higher priorities. Some users
may need to consistently use higher priority, for example due to role or
seniority, and may become visible due to this.
### 6.9.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT service shall provide a means to support confidentiality of MCPTT
user identities from all entities outside the MCPTT service.
b) The MCPTT service shall provide a means to support confidentiality of MCPTT
signalling from all entities outside the MCPTT service.
## 6.10 Key Issue # 9: On-network operation: interception of user traffic
### 6.10.1 Issue details
Traffic and signalling sent to and from UEs is at risk of interception,
compromising information appertaining to ongoing operations. Location
information may be especially sensitive.
### 6.10.2 Security threats
a) Eavesdropping at air interface. Signalling or traffic information is
recovered by an adversary using a radio receiver. Adversary could be any
member of the public.
b) Eavesdropping in mobile network. Signalling or traffic information is
recovered by an adversary intercepting a link or at a network element in the
mobile network. This could be achieved by non-security cleared personnel, or
by adversary finding vulnerable points in network, e.g. unprotected ground
based network link. It is expected that in most cases mobile networks will not
have undergone a formal government security evaluation.
c) Eavesdropping on connected networks (e.g. non 3GPP networks). Signalling or
traffic information is intercepted whilst routed to or from a user connected
over a non 3GPP network, e.g. WiFi network or line connected user.
d) Man in the middle on connected networks. Signalling or traffic information
is intercepted and altered whilst routed over a non 3GPP network. This could
be achieved by an attacker placing himself between the users or between the
user and the MCPTT server. As a consequence the attacker can for example alter
location information and thus jeopardizing ongoing PS operations
### 6.10.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT Service shall provide a means to support end to end
confidentiality and integrity protection for all media traffic transmitted
between MCPTT UEs.
b) The MCPTT Service shall provide a means to support the confidentiality and
integrity protection of location information transmitted from the MCPTT UE to
the MCPTT application server.
## 6.11 Key Issue # 10: Key Stream Re-use
### 6.11.1 Key issue details
In a MCPTT group communication multiple group UEs may communicate using a
shared group key. In such a scenario, it is essential that two users do not
generate and use the same key stream, derived from the shared group key. If
this were to happen then compromise of user traffic is possible.
For example, in the particular case where SRTP is used to protect traffic
generated by a UE, with all UEs deriving their key stream from a shared group
key, the key stream for each user needs to be unique. Based on the RFC 3711
[7], key stream uniqueness is achieved by each user picking a random SSRC
(synchronisation source identifier) and actively detecting any collisions.
Were SRTP to be used as implied within the RFC as part of an MCPTT solution,
key stream re-use would be highly likely, if not certain. For example, it
could be assumed that the MCPTT system should support more than 10000 MCPTT
users in a MCPTT group, with each user able to produce 8 communication streams
at any one time and be able to start new communication stream at any time. In
this conservative scenario, as the SSRC is 32 bits long, the probability that
two UEs in this group would have two simultaneous streams with the same SSRCs
is 0.53. This is an unacceptably high probability of compromise. Furthermore,
depending on the length of time a stream lasts, the probability of collision
will increase with each new stream created.
As an additional complication, should two UEs decide to use the same SSRC, it
may be extremely difficult to resolve this collision on the fly.
### 6.11.2 Security threats
Accidentally, or due to a malicious action, the MCPTT system uses a key stream
that has already been used previously to protect traffic. As a result of this
key stream reuse, it is possible that both traffic streams could be
compromised.
### 6.11.3 Potential security requirements
The following requirement serves as a guideline for future normative work:
The MCPTT system shall ensure that key streams are not reused.
## 6.12 Key Issue # 11: Late Entry to Group Communication
### 6.12.1 Issue details
To allow the MCPTT service to meet the Stage 1 requirements, it needs to be
possible for the authorised MCPTT users to be able to perform late entry for
an MCPTT Group while communication is on-going. This implies that an
authorised MCPTT UE is able to obtain all information required to derive the
key stream currently in use to protect the group communication.
For example, in the case of SRTP, this may include the association between an
MCPTT Group and a particular SRTP session, the cryptographic algorithms in use
to protect the session, the SRTP Master Key in use to protect the session (and
any information required to derive the SRTP Master Key), the SRTP Roll-Over-
Counter (ROC) and the SRTP salt (if used).
### 6.12.2 Security threats
The threat in this case is that a MCPTT user is unable to perform late entry
to a group communication as it is unable to establish the information required
to build the group security context and decrypt the traffic.
### 6.12.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
An authorised MCPTT User shall be able to obtain the information necessary to
derive the group security context for the MCPTT Group while an MCPTT Group
communication is on-going. As a result, the MCPTT User shall be able to listen
to the group communication within 350ms. This requirement applies for both on-
network and off-network MCPTT operation.
## 6.13 Key Issue # 12: Private Call Confidentiality
### 6.13.1 Issue details
Private calls are used to establish a secure communication path between a pair
of authorised MCPTT users. A Private Call may or may not use floor control and
may be setup while the MCPTT user is operating either on or off-network.
Additionally, Private Calls may be used to support Ambient Listening and
Discreet Listening functionality, where a MCPTT UE transmits local audio to a
control room.
To support private calls, the MCPTT system requires a mechanism for
establishing end-to-end secure between any pair of MCPTT users.
### 6.13.2 Security threats
The following threats apply to private calls:
\- The content of a private call is accessible to unauthorised MCPTT users. As
a consequence of this threat, confidential conversations may be compromised,
and user\'s confidence in Private Call functionality may be undermined,
pushing them towards less secure communication mechanisms for private
conversations.
\- A private call is replayed or modified within the MCPTT system.
\- A private call is established by one MCPTT user appearing to be another
MCPTT user. As a consequence of this threat, confidential information may be
compromised to an unauthorised user. This threat is particularly serious where
Private calls are used to support Discreet Listening or Ambient Listening
functionality.
\- A pair of users are unable to establish a shared security context and hence
are unable to establish a Private Call.
### 6.13.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
\- It shall be possible to establish a unique Private Call security context
between any pair of authorised MCPTT users within the MCPTT system. The
security context shall not be available to other MCPTT users, except, where
necessary, authorised MCPTT monitoring functions (e.g. LI, Discreet
Listening). If the security context is made available to monitoring functions,
appropriate controls and logging shall exist. This requirement applies when
MCPTT UEs are operating both on-network and off-network.
\- The Private Call security context shall provide a means to provide
confidentiality and integrity protection of user traffic, and authenticate the
MCPTT users involved in the Private Call.
## 6.14 Key Issue # 13: Off-network operation: denial of service
### 6.14.1 Issue details
Whilst in DMO, an adversary may attempt to prevent a valid MCPTT user or group
from establishing communications with other DMO users.
### 6.14.2 Security threats
a) Channel flooding. Adversaries create large volumes of traffic to reduce
available capacity and impede communications between DMO users.
### 6.14.3 Potential security requirements
a) The MCPTT service should take measures to detect and mitigate DoS attacks
to minimise the impact to relays and to off-network MCPTT users.
## 6.15 Key Issue # 14: Off-Network Operation: interception of user traffic
### 6.15.1 Issue details
DMO signalling or traffic between UEs is at risk of interception, thereby
compromising information appertaining to user identities and ongoing
operations. Location information may be especially sensitive.
### 6.15.2 Security threats
a) Eavesdropping at air interface. Signalling and traffic information,
including location information, is recovered by an adversary using a radio
receiver. Adversary could be any member of the public.
### 6.15.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT Service shall provide a means to support end-to-end security for
all media traffic transmitted between MCPTT UEs, including where relays are
used.
b) The MCPTT Service shall provide a means to support the confidentiality and
integrity protection of location information transmitted from the MCPTT UE to
the MCPTT application server, including where relays are used.
## 6.16 Key Issue # 15: Off-network operation: impersonation
### 6.16.1 Issue details
An imposter may attempt to impersonate a valid MCPTT user for the purposes of
fraud, misinformation or eavesdropping.
### 6.16.2 Security threats
a) Impersonation of individual user. Adversary masquerades as a valid MCPTT
DMO user, advertising himself to other DMO users for purposes of fraud,
misdirection, etc.
b) Impersonation of network equipment. Adversary uses unauthorized equipment
that produces over the air signalling which mimics on-network signalling and
draws MCPTT UEs away from DMO.
c) Impersonation of relay equipment. Adversary impersonates a valid on-network
or off-network relay equipment for the purpose of intercepting or misdirecting
user communications.
d) Man in the middle attack. An attacker inserts himself between two off-
network MCPTT UEs to intercept DMO transmissions and obtaining information,
generating false calls, denying service, or modifying the security of the DMO
service, e.g. force the user to negotiate a lower security level.
e) Misuse of client terminal. A client terminal is stolen (which may still be
logged on to the service), or illegally loaned, and used to receive or
generate DMO communications whilst purporting to be the valid user.
Credentials could be obtained from a stolen terminal and used to impersonate
the valid user, even after the terminal has been recovered.
### 6.16.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) MCPTT off-network UEs shall be explicitly or implicitly authenticated to
each other.
b) MCPTT off-network UEs and MCPTT relays shall be explicitly or implicitly
authenticated to each other.
c) The security solution should minimise the impact of a compromised MCPTT UE
on other MCPTT UEs.
## 6.17 Key Issue # 16: Off-network operation: manipulation
### 6.17.1 Issue details
Whilst in DMO, an adversary may attempt to manipulate information relating to
an MCPTT user, group or conversation.
### 6.17.2 Security threats
a) Alteration of configuration. An adversary changes programming information
in the DMO client application, or changes configuration e.g. to change or deny
access permissions in the DMO client application.
b) Hijacking of calls. An adversary causes the early termination of a call or
deletes users from the call.
### 6.17.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT Service shall provide a means to ensure integrity of all MCPTT
user signalling at the application layer.
## 6.18 Key Issue # 17: Off-network operation: traffic analysis
### 6.18.1 Issue details
MCPTT DMO users require their identities to be confidential from any
unauthorized listeners, and are sensitive to any form of traffic analysis
which could result in details of their operations or operational roles being
deduced. Additionally recovery of identities and signalling patterns may
reveal information concerning organisational structure, or ongoing operational
activities. Identified users may also become targets for impersonation, or for
denial of service attacks such as jamming.
### 6.18.2 Security threats
a) Matching of user identity with subscriber terminal identity. The DMO user
can be identified by the subscription in use, enabling tracking by non-
security cleared personnel or a skilled adversary intercepting identities sent
in transmissions.
b) Identifying highly secure users within user pool. Certain specialist DMO
users have much higher demands for security and are very sensitive to identity
and location, and currently rely on obscurity within the greater volume of
public safety users.
c) Identification of group addresses. DMO group addresses relate to
operational roles, and identification of these allows analysis of user
movements and operational behaviour.
d) Identifying users through discovery. Identification of an MCPTT DMO user
during discovery can provide information of that user to unauthorized
listeners.
### 6.18.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
a) The MCPTT service shall provide a means to support confidentiality of MCPTT
user identities from all entities outside the MCPTT service.
b) The MCPTT service shall provide a means to support confidentiality of MCPTT
signalling from all entities outside the MCPTT service.
NOTE: If there is a need to provide charging information back to the network
once the MCPTT UE returns to an on-network mode of operation, carrier charging
information is made available to these off-network security requirements (i.e.
secure storage of the charging information, and confidentiality protection of
the charging information).
## 6.19 Key Issue #18: Privacy of MCPTT identities
### 6.19.1 Issue details
To allow the MCPTT service to meet the Stage 1 requirements and align with the
Stage 2, it is expected that each plane operates in an independent manner,
especially when MCPTT application and the IMS core are administered by
different parties (Operator (carrier) and PS Agency). As a consequence of
this, each plane should manage on its own behalf:
a) Use of identities. Each plane is therefore responsible for the privacy of
that plane\'s own identities; and
b) Security for that plane. This does not preclude a plane requesting security
services from another plane, but that is a decision made within the plane, as
to whether to use offered security services or mechanisms within the plane
itself.
### 6.19.2 Security threats
The identity usually identifies a UE or User or a client, if that plane\'s own
identities are leaked and exposed to other planes, there will be some security
problems like privacy information exposure, tracing and so on.
### 6.19.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
\- The MCPTT identities of each plane shall be used within the corresponding
plane and concealed to other planes.
\- When required by the MCPTT Service provider, MCPTT application services
layer identities (such as the Mission Critical user identity, MCPTT-ID and
MCPTT Group ID) and other application services sensitive information (as
further described in reference [10] clause 8.1), shall be contained within the
application plane and shall provide a means to support confidentiality and
integrity of the application plane from the SIP signaling plane.
\- When protection of identities and other sensitive MCPTT application
information is NOT required by the MCPTT Service provider, the MCPTT
application services layer identities (such as the Mission Critical user
identity, MCPTT-ID and MCPTT Group ID) and other application services
sensitive information (as further described in reference [10] clause 8.1),
shall remain contained within the application plane but do not require
confidentiality protection.
# 7 Proposed Solutions
## 7.1 Solution #1: Signalling protection and authentication procedure for
MCPTT services
7.1.1 General
This solution address the Key Issue#3, Key Issue#6, Key Issue#7, Key Issue#8,
Key Issue#9 (location information transmission) and Key Issue#10 mentioned in
the present document.
The security mechanisms detailed in the TS 33.203 [9] for the Gm interface is
used for MCPTT UE authentication over SIP-1 interface. The MCPTT user
authentication is performed over MCPTT-1 interface.
7.1.2 Signaling protection
The IMS security mechanisms as specified in TS 33.203 [9] for Gm interface are
used to provide confidentiality and integrity of signaling between the UE and
the P-CSCF.
For inter-domain interface protection (e.g., ISC interface between the MCPTT
server and the SIP core network) the security mechanism as specified in TS
33.210 (NDS/IP) [8] is used.
7.1.3 Authentication procedure
Figure 7.1.3-1: MCPTT Service authentication
At switch-on, the MCPTT UE performs LTE authentication as specified in TS
33.401 [21].
**\- Step A:** Based on the configuration provided with the MCPTT client in
the UE, the UE may perform token based authentication for MCPTT user
Authentication. The UE obtains a token securely from the Identity Management
server. Token is used for MCPTT Authentication in step C. This step may be
performed after step B.
**\- Step B:** IMS authentication between the MCPTT UE and the SIP core is
performed as specified in 3GPP TS 33.203 [9]. IMS AKA authentication mechanism
as specified in TS 33.203 [9] is performed irrespective of whether SIP core
architecture is compliant with 3GPP TS 23.228 [23] or not. Implementation
options and requirements on the ISIM/USIM application to support SIP core
access security are specified in TS 33.203 [9] (Clause 8).
**\- Step C:** Authentication of the MCPTT user over MCPTT-1 interface is
performed after IMS authentication.
If the MCPTT server is administered by the operator, then the Public Safety
user Data Function (PS-UDF) or the HSS stores the security credentials for
MCPTT user authentication and also generates security information for mutual
authentication. If the MCPTT server is administered by the PS agency, then the
PS-UDF stores the security credentials for MCPTT user authentication and also
generates security information for mutual authentication.
For MCPTT user authentication using the MCPTT-1 interface, any one of the
following procedure may be performed.
\- SIP Digest authentication;
\- Token based authentication.
## 7.2 Solution #2: MCPTT User authentication and registration based on OpenID
Connect
### 7.2.0 Introduction
In order to provide a complete user authentication and UE authorization
solution for MCPTT that satisfies the requirements in TS 22.179 [2] and the
architecture in TS 23.179 [10], the following security features are needed.
1\. Network access and network security with the EPS Core.
2\. MCPTT UE authentication and registration with SIP Core.
3\. Identity verification of the MCPTT user with the MCPTT domain via a set of
MCPTT User Credentials.
4\. MCPTT User authentication and registration with the MCPTT Server.
This solution provides for MCPTT User identity verification, MCPTT User
Authentication and Registration with the MCPTT Server, as well as SIP Core
registration for MCPTT UE.
OpenID Connect [17] tokens are used for both authenticating and registering
the user with the MCPTT Server. MCPTT UE Authentication and SIP Core
registration is based on an existing IMS Authentication schemes detailed in TS
33.203 [9].
Figure 7.2-1 shows the high level flow for Token-based MCPTT user
authentication and UE registration with SIP Core.
NOTE: As defined in TS 23.179 [10], the SIP Core may be resident in the
network domain or MCPTT domain. Also, it is important to note that User
authentication (Step 3 in this instance) may occur at any point in this flow
between Step 0 and Step 4.
Figure 7.2-1: MCPTT UE Registration and Token based User Authentication Flow
The following describes the steps performed in Figure 7.2-1 for MCPTT UE
registration and token-based MCPTT User Authentication and registration with
the MCPTT Server.
> Step 0: The UE attaches to the network, establishes normal connectivity, and
> sets up network security as defined in TS 33.401 [21].
>
> Step 1: The MCPTT UE establishes a secure session with the SIP Core. The SIP
> User Agent authenticates to the SIP core and registers its IMPU. For IMS
> authentication, TS 33.203 [9] applies.
NOTE: At this time, only a secure connection exists between the MCPTT UE and
the SIP Core, no MCPTT communications (emergency or otherwise) are available.
> Step 2: The SIP core sends a SIP 3rd Party Registration to the MCPTT
> application Server, notifying it of the MCPTT UE SIP registration. The
> registered IMPU is sent in this step along with the SIP Core address. This
> allows MCPTT server to allow minimal or default services for this SIP
> session at this time.
>
> Step 3: The user provides its MCPTT User Identity and associated credentials
> to the IdM server via the IdM client\'s user agent (over https). If the user
> is successfully authenticated (and optionally authorized) by the IdM server,
> the MCPTT client receives in return an access token specific to the MCPTT
> user and MCPTT service and a KMS access token specific to the MCPTT user and
> the MCPTT key management service.
>
> Step 3.5: The KMS access token obtained in Step 3 is provided to the MCPTT
> KMS on the TLS protected HTTP-1 interface. The MCPTT KMS validates the
> access token, and if the MCPTT user is authorized for MCPTT key management
> services, then the MCPTT KMS provides keys specific to the user.
NOTE: Steps 3 and 3.5 together may occur at any point in this flow between
Step 0 and Step 4.
> Step 4: The access token obtained in Step 3 is provided to the MCPTT server
> in a SIP Publish message. The MCPTT application validates the access token.
> If the MCPTT user is authorized for MCPTT services, then the MCPTT server
> binds the user associated with the access token with the SIP session URI and
> IMPU.
The MCPTT server responds by providing the MCPTT user its service
authorization profile.
### 7.2.1 OpenID Connect (OIDC)
#### 7.2.1.0 General
The OpenID Connect [17] based authorization server provides client
applications with two key tokens:
a) ID Token -- asserts the user\'s identity in a signed and verifiable way.
Similar to an identity card, enables MCPTT Client to identify the
authenticated user. This is JSON Web Token (JWT) based and is self-contained
with information useful to the receiving OIDC Client.
b) Access token -- A bearer token that represents that a resource owner has
authorized an MCPTT client for access to a protected MCPTT resources on behalf
of the end user. The token is sent by the MCPTT client to the MCPTT server.
The MCPTT server utilizes this token to determine the set of protected
resources it will enable for the MCPTT client.
Authorization servers supporting OpenID Connect protocol and providing user
authentication as a service are referred to as OpenID Identity Providers
(IDP). Applications that outsource its user authentication function to an IDP
is referred to as Relying Parties (RPs).
The Identity Management Server in the MCPTT network is the OpenID Identity
Provider, and the MCPTT server which depends on the access token to verify the
user is the Relying Party**.**
#### 7.2.1.1 OpenID Connect Authorization Code flow using Proof Key for Code
Exchange
OAuth 2.0 Authorization code flow [16] with additional security enhancements
proposed by [15] is used as the OpenID Connect flow in the proposed solution.
The MCPTT Client native application in the UE is a \"public client\" incapable
of maintaining the confidentiality of their credentials. When a public client
utilizes the Authorization Code Grant to authenticate with the OIDC server,
they are susceptible to the authorization code interception attack.
Once the user (i.e. the resource owner) authenticates, the OIDC server
provides MCPTT Client with an authorization code through a browser redirect
HTTP message. The client then sends the authorization code to the OIDC Server
and gets an access token in return. The Redirection URI typically uses a
custom URI to communicate with the native application.
The interface between the browser and the native app is based on callbacks
(handlers). This path is unprotected and could be attacked by a malicious
application (native application) in the UE. A malicious app can register
itself as handler for the custom URI scheme and intercept the authorization
code. To prevent these kinds of malicious apps from exchanging the \"falsely
obtained\" code for an access token, code-challenge and code-verifier strings
are used by the IdM Server to verify the MCPTT Client.
a) The Client creates a code_verifier string and a code_challenge string
derived from the code-verifier string.
b) The client includes the code_challenge string when it requests an access
token in the \"Authorization Request\" message.
c) Subsequently, when it sends a message to exchange the authorization code
for an access token, it includes the code_verifier string to the IdM Server,
in addition to the authorization code. The code_verifier string is
cryptographically associated with the code_challenge. Therefore the IdM Server
can generate code_challenge on its own from the received code-verifier string,
and compare it with the code_challenge provided by the client in the
\"Authorization Request\". If the values match, it proves that the client is
legal. An access token is granted to the client.
### 7.2.2 Detailed flow for MCPTT User Authentication and Registration using
OpenID Connect
Figure 7.2.2-1 shows the detailed flow for MCPTT User Authentication and
Registration.
Figure 7.2.2-1 OpenID Connect MCPTT User Authentication and Registration
> Step 0: The UE attaches to the network, establishes normal connectivity, and
> sets up network security as defined in TS 33.401 [21]. Local P-CSCF in the
> Home IMS network is discovered at this point.
>
> Step 1: The UE IMS Client authenticates with the Home IMS network. For IMS
> authentication, TS 33.203 [9] applies.
>
> Step 2: The SIP core sends a SIP 3rd Party Registration to the MCPTT
> application Server, notifying it of the MCPTT UE SIP registration. The 3rd
> party REGISTER message includes the registered IMPU and S-CSCF\'s SIP-URI or
> IP Address.
>
> Step 3a: The IdM client in the UE issues a HTTPS Authentication request to
> the OIDC based IdM Server in the MCPTT network. The client includes the
> code_challenge value in this request.
>
> Step 3b: The user provides the MCPTT User Identity and associated
> credentials to the IdM server. The user is successfully authenticated (and
> optionally authorized) by the IdM Server.
>
> Step 3c: The IdM Server may optionally request user consent for granting the
> MCPTT client access to MCPTT services in the MCPTT Server.
>
> Step 3d: The IdM Server generates an authorization code that is associated
> with the code_challenge provided by the client. It sends a browser redirect
> HTTP message with the Authorization Response containing the authorization
> code.
>
> Step 3e: The UE IdM Client performs a HTTP POST request to exchange the
> authorization code for an access token. In the request, the client includes
> the code-verifier string. This string is cryptographically associated with
> the code_challenge value provided in the Authorization Request in Step 3a.
>
> Step 3f: The IdM Server verifies the IdM Client based on the received code-
> verifier string and issues a 200 OK with an access token and ID token
> (specific to the MCPTT user and MCPTT service) included in it.
NOTE: The server verifies by calculating the code challenge from the received
code_verifier and comparing it with the code_challenge value provided by the
client in Step 3a.
> Step 3g: The access token and ID token are provided to the MCPTT client.
>
> Step 3h: The MCPTT client may forward the access token to the MCPTT server
> over the SIP-1/SIP-2 interface. The MCPTT server may then authorize the
> MCPTT user and then may bind the MCPTT user to the SIP session.
>
> Step 4: The MCPTT client establishes TLS on the HTTP-1 interface and
> forwards the access token to the MCPTT application server. The MCPTT
> application server authorizes the MCPTT user and binds the user to the
> HTTP-1 session. Once the user is authorized, the MCPTT application server
> provides the user\'s profile and permissions to the MCPTT client over the
> HTTP-1 interface.
## 7.3 Solution #3: Addition of KMS function and interfaces
### 7.3.1 General
For a number of different security processes, the MCPTT user will require
identity-specific key material to be provisioned from a MCPTT Key Management
Server (KMS). This solution adds the MCPTT KMS functional entity and three
reference points for the provision of key material.
NOTE: For clarity, an MCPTT KMS provides different functionality to a MIKEY-
TICKET KMS defined in TS 33.328 [12].
### 7.3.2 Functional model for the MCPTT KMS
#### 7.3.2.0 Introduction
Within the MCPTT architecture, a new functional entity, the MCPTT Key
Management Server (KMS), is required for the provision of key material
associated with a specific identity. The MCPTT KMS sits within the Common
Services Core (CSC). The MCPTT KMS has an interface with the key management
client. The key management client is responsible for requests for identity-
specific key material. This functional entity is located in the UE and in the
MCPTT Server.
The reference points for the MCPTT KMS are shown in Figure 7.3.2-1 alongside
the other reference points for the Common Service Core.
Figure 7.3.2-1: Reference Points for MCPTT Key Management Server
Figure 7.3.2-1 shows the CSC-8, CSC-9 and CSC-10 reference points for the
MCPTT Key Management Server within the MCPTT system.
#### 7.3.2.1 Reference point CSC-8 (between key management client and key
management server)
The CSC-8 reference point, between the key management client and the MCPTT
KMS, provides identity-specific key material to the MCPTT UE. CSC-8 uses the
HTTP-1 and HTTP-3 reference point.
#### 7.3.2.2 Reference point CSC-9 (between the key management server and the
MCPTT Server)
The CSC-9 reference point, which exists between the key management server and
the MCPTT Server, is used, where necessary, to provide the MCPTT Server with
identity-specific key material to allow the MCPTT Server to be involved in
end-to-end secure communications. CSC-9 uses the HTTP-2 and HTTP-3 reference
point for the transport of key material.
#### 7.3.2.3 Reference point CSC-10 (between the key management server and a
group management server)
The CSC-10 reference point, which exists between the key management server and
a group management server, is used to provide the group management server with
identity-specific key material to allow the group management server to
distribute key material to support group communications. CSC-10 uses the
HTTP-2, HTTP-3 and HTTP-4 signalling reference points for the transport of key
material.
### 7.3.3 Security Procedures
The procedure for the provision of identity-specific key material is described
in Figure 7.3.3-1. The procedure is the same whether the key management client
in the MCPTT UE, MCPTT Server or group management server is making the
request.
Figure 7.3.3-1: Provisioning of user key material
The procedure in Figure 7.3.3-1 is now described step-by-step.
0\. The key management client establishes a connection to the MCPTT Key
Management Server. As with other elements in the Common Services Core, the
connection routed via, and secured by, the HTTP Proxy. The message flow below
is made within this secure connection.
NOTE: Additionally, the connection between the KMS and the HTTP Proxy may be
secured using Network Domain Security as described in TS 33.210 [8].
1\. The key management client makes a request for user key material from the
MCPTT KMS. The request contains details of the identity requested for key
provisioning, and the time at which the key material is required.
2\. The KMS provides a response containing key material. The response includes
the type of key material, the period of use for the material and any domain-
specific parameters required for its use.
As a result of this procedure, the key management client has securely obtained
key material for use within the MCPTT system.
### 7.3.4 Key material provisioned to support Solution #4 and #5
Solution #4 and #5 require the provisioning of the same key material from the
KMS. The key material required to be provisioned to each user to support these
two solutions is listed below:
\- Domain specific key material, also known as a KMS Certificate, which
includes:
\- The KMS Public Authentication Key (KPAK in RFC 6507 [26]).
\- The KMS Public Confidentiality Key (Z_T in RFC 6508 [27]).
\- The UID conversion (as described below).
\- Choice of cryptographic domain parameters (such as those listed in RFC 6509
[13]).
\- The time period for which this information is valid.
\- A user signing key for each UID for the upcoming time period (SSK and PVT
in RFC 6507 [26]).
\- A user decryption key for each UID for the upcoming time period (RSK in RFC
6508 [27]).
\- The time period, T, for which the user key material is valid (e.g. month).
The UID conversion mechanism defines how UIDs are generated. Using this format
a MCPTT client can take a user identifier (e.g. an MCPTT ID), and the current
time, (e.g. the year and month) and convert these to a UID. For example,
UID = Hash (MCPTT ID, Month, Year)
As a consequence, there is a one-to-one correspondence between MCPTT IDs and
UIDs during each time period, T.
After provisioning, the key material may be stored in the user\'s profile.
## 7.4 Solution #4: Distribution of a group security context
### 7.4.1 General
To create the group\'s security association, a Group Master Key (GMK) is
distributed to MCPTT UEs by a Group Management Server (GMS). The GMK is
distributed encrypted specifically to a user and signed using an identity
representing the Group Management Server. Prior to group key distribution,
each MCPTT UE within the group is provisioned by the KMS with time-limited key
material associated with the MCPTT User. The Group Management Server is also
provisioned by the Key Management Server (KMS) with an identity which is
authorised to create groups.
The GMK is distributed with a 32-bit Group User Key Identifier (GUK-ID) within
a Group Key Transport payload. This payload is a MIKEY-SAKKE I_MESSAGE, as
defined in RFC 6509 [13], which ensures the confidentiality, integrity and
authenticity of the payload.
The GMK is encrypted to the user identity (UID) associated to the MCPTT UE.
The UID used to encrypt the data will be derived from the user\'s URI (e.g.
user.001\@mcptt.example.org) and a time-related parameter (e.g. the current
year and month). The user\'s URI is added to the recipient field (IDRr) of the
message.
The Group Key Transport payload is signed using (the KMS-provisioned key
associated to) the identity of the GMS. This identity is derived from the
GMS\'s URI (e.g. gp.manager@.mcptt.example.org) and a time-related parameter
(e.g. the current year and month). The GMS\'s URI is added to the initiator
field (IDRi) of the message.
The security processes are summarized in Figure 7.4.1-1.
Figure 7.4.1-1: Generation of a group key transport message
At the MCPTT UE, the GMS\'s URI is extracted from the initiator field (IDRi)
of the message. Along with the time, this is used to check the signature on
the Group Key Transport message. If valid, the UE extracts and decrypts the
encapsulated GMK using the (KMS-provisioned) user\'s UID key. The MCPTT UE
also extracts GUK-ID and xors the GUK-ID and User Salt together to extract the
GMK-ID. If the GMK consists of zero bytes, the GMK and GMK-ID are treated as
revoked and are not be used. The extraction procedure is described in Figure
7.4.1-2.
Figure 7.4.1-2: Processing of a group key transport message
The Group Key Transport payload includes the encrypted GMK and the Group User
Key Identifier (GUK-ID). The GMK is unique within the MCPTT system. On
creating the GMK, the Group Manger generates a 32-bit GMK Identifier (GMK-ID).
The 4 most significant bits of the GMK-ID is the \'purpose tag\' which defines
the purpose of the GMK. The rest of the GMK-ID is 28-bit randomly-generated
value.
For each user, the GMS creates a 28-bit User Salt by hashing the user\'s URI.
The User Salt is xor\'d with the least-significant bits of the GMK-ID to
create the 32-bit GUK-ID. The process for generating the GUK-ID is summarized
in Figure 7.4.1-3.
Figure 7.4.1-3: Generating the GUK-ID
The GUK-ID is placed in the CSB ID field within the header of the I_MESSAGE.
### 7.4.2 Security procedures for GMK provisioning
This procedure distributes a Group Key Transport payload from the GMS to MCPTT
UEs within the group. The payload is transported as part of the 'Notification
of group metadata\' message defined in clause 10.5 of TS 23.179 [10].
Figure 7.4.2-1 shows the security procedures for creating a security
association for a group.
Figure 7.4.2-1: Security configuration for groups
A description of the procedures depicted in Figure 7.4.2-1 follows. For
clarity, step 1 below corresponds to step 3 in clause 10.5 of TS 23.179 [10]:
0) Prior to beginning this procedure the MCPPT UE has been provisioned with
identity-specific key material by a KMS. The GMS is also securely provisioned
with identity-specific key material for an identity that is authorised to
create groups.
1) The GMS sends a Group Key Transport payload to MCPTT UEs within the group
within a 'Notification of group metadata\' message. The message contains a
Group Key Transport payload and encapsulates a GMK for the group. The payload
is encrypted to the user identity associated to the MCPTT UE and is signed by
the GMS. The message also provides the GUK-ID.
2) On receipt of a Group Key Transport payload, the MCPTT UE checks the
signature on the payload, verify that the GMS is authorised to create groups,
extract the GMK, GUK-ID and GMK-ID and check that the GMK-ID is not a
duplicate for an existing GMK. Should any of these checks fail, an error is
returned to the GMS. Upon successful receipt and processing, the MCPTT UE
stores the GMK, GMK-ID and GUK-ID. The MCPTT UE then confirms receipt of the
group key transport message. This confirmation contains no security
information.
Where a separate security context is required for media protection and floor
control signalling, the procedure may be performed twice, once for obtaining a
GMK for the protection of media and once for obtaining a different GMK for the
protection of floor control signalling. Alternatively, GMS may distribute the
two different GMKs in one procedure.
To revoke a security context, the group management server repeats the above
steps with a GMK consisting of zero bytes.
### 7.4.3 Group keying for media protection and floor control
A group security context may be used for the protection of media within the
group (e.g. via SRTP), the protection of floor control signalling (e.g. via
SRTCP), or for the protection of both. This allows media protection and floor
control signalling to be cryptographically separated meaning that:
\- The floor arbitrator need not access the content of communications.
\- It is possible to exclude 'receive-only\' group members from floor control
signalling.
The \'purpose tag\' within the GMK-ID is used to indicate the use of the GMK.
\- 0: the key is used for all group communications (SRTP and SRTCP).
\- 1: the key is used to protect SRTP group communications only.
\- 2: the key is used to protect SRTCP group communications only.
\- 3: the key is used to protect Private Call communications only.
\- 4-15: not defined.
In this way, the MCPTT UE is able to identify the purpose of the GMK.
### 7.4.4 Group creation procedure
Group creation procedure is described in clause 10.6.3 of TS 23.179 [10]. To
create the security context for the group, the GMS follows the procedures in
clause 7.4.1, creating a new GMK and GMK-ID for the temporary group.
An encapsulated GMK and GUK-ID is sent to affiliated users by the GMS within a
notification message (step 4 within clause 10.6.3 of TS 23.179). The procedure
is equivalent to that described in clause 7.4.2.
### 7.4.5 Dynamic Group Keying
#### 7.4.5.1 General
In the GMK distribution procedures described in this section, the GMS is
provisioned with the same information as any MCPTT UE by the KMS; the only
distinguishing feature is that the GMS\'s identity is authorised to create
groups.
NOTE: This authorisation could be conveyed within the identity itself. For
example, via a specific string within the URI such as 'group\'. For example,
the identity user.001.group@mcptt.example.org may be authorised to create a
group, whereas user.001@mcptt.example.org may not.
Additionally, the only information the GMS requires to create the group are
the URIs of the group members. These two features combined allow groups to be
created and keyed at any time, by any authorised entity, both on and off-
network.
Such flexibility is required to support a number of group procedures within TS
23.179 [10].
#### 7.4.5.2 Group regrouping procedures (within a single MCPTT system)
Group Regroup procedures are described in clause 10.6.2.1 of TS 23.179 [10].
To create the security context for the temporary group, the GMS follows the
procedures in clause 7.4.1, creating a new GMK and GMK-ID for the temporary
group.
An encapsulated GMK and GUK-ID is sent to affiliated users by the GMS within a
notification message (step 5 within clause 10.6.2.1 of TS 23.179). The
procedure is equivalent to that described in clause 7.4.2.
#### 7.4.5.3 Group regrouping procedures (involving multiple MCPTT systems)
Group Regroup procedures involving multiple MCPTT systems are described in
clause 10.6.2.2 of TS 23.179 [10]. Figure 7.4.5.3-1
Figure 7.4.5.3-1: Group Regroup security procedures (multiple MCPTT systems)
0) Prior to beginning the procedure, the KMS of the primary MCPTT system has
exchanged domain parameters with the KMS within the partner MCPTT system.
1) To create the security context for the temporary group, the primary GMS
creates a new GMK and GMK-ID for the temporary group. The primary GMS notifies
the affiliated users within its own MCPTT system (Step 8 of clause 10.6.2.2 in
TS 23.179). Within this message, the primary GMS includes a Group Key
Transport payload including a GMK and GUK-ID following the procedures in
clause 7.4.1. The GMK is encrypted to the identity of the MCPTT user and is
signed using the identity of the primary GMS.
2) The MCPTT UEs acknowledge the notification.
3) The primary GMS then notifies the partner GMS of the group regroup
operation (Step 9 of clause 10.6.2.2 in TS 23.179). Within this message, the
primary GMS includes a Group Key Transport payload following the procedures in
clause 7.4.1, treating the partner GMS as another user within the group.
Accordingly, the payload encrypts the new GMK to the identity of the partner
GMS and is signed using the identity of the primary GMS. The GUK-ID is derived
using the User Salt generated from the partner GMS\'s URI.
4) The partner GMS extracts the GMK and GMK-ID from the notification. The
partner GMS then notifies the affiliated users within the partner MCPTT system
(Step 11 of clause 10.6.2.2 in TS 23.179). The partner GMS re-encrypts the GMK
to the identity of the affiliated users in the partner system, generates new
GUK-IDs for each user and signs using its identity (the identity of the
partner GMS).
5) The partner MCPTT UEs acknowledge the notification.
6) The partner GMS acknowledges the notification to the primary GMS.
Where a separate security context is required for media protection and floor
control signalling, the procedure may be performed twice, once for obtaining a
GMK for the protection of media and once for obtaining a different GMK for the
protection of floor control signalling. Alternatively, GMS may distribute the
two different GMKs in one procedure.
### 7.4.6 Derivation of SRTP/SRTCP master keys
As a result of this mechanism, the group members share a GMK and GUK-ID. The
GMK is used as the MIKEY Traffic Generating Key (TGK), the GUK-ID is used as
the MIKEY CSB ID.
Figure 7.4.6-1: Key Derivation for media stream protection
As a result the keystream used to protect MCPTT Group communications will be
unique.
\- Across MCPTT Groups the GMK differ.
\- Where GUK-IDs differ the SRTP Master Key and Master Salt will differ.
\- Where GUK-IDs are the same (either for a single user or due to GUK-ID
collision) a differing SRTP/SRTCP Synchronization source identifier (SSRC)
will ensure, with high probability, separate keystreams. The SSRC is a
SRTP/SRTCP source identifier that changes with each session or if the UE\'s
source IP address changes.
\- Where the GMK is used to protect both SRTP and SRTCP, RFC 3711 [7] ensures
that separate keystreams are generated for both protocols.
NOTE: The probability of separate streams from separate users sharing the same
keystream is extremely remote (2^-60^), as the random GUK-ID and SSRC need to
collide. In a group of 1000 the probability of any two users sharing the same
GUK-ID is approximately 0.002. For an individual user generating 100 streams
within a group, the probability that the user generates a SSRC collision is
approximately 2^-20^.
To identify the security context from the media stream a SRTP/SRTCP Master Key
Identifier (MKI) is required. The MKI should be a 64-bit value formed by
concatenating the GMK-ID with the GUK-ID.
Where the transmitting user is known through other means, the MKI may be
solely the 32-bit GMK-ID. In this case the terminating user extracts the GUK-
ID by calculating the User Salt and xor\'ing this value with the GMK-ID.
## 7.5 Solution #5: Private call security
### 7.5.1 General
This solution allows two MCPTT UEs to create an end-to-end security context to
protect an MCPTT private call. To create the security context, the initiating
MCPTT UE generates a Private Call Key (PCK) and securely transfers this key,
along with a key identifier (PCK-ID), to the terminating MCPTT UE.
The PCK is distributed encrypted specifically to the terminating user and
signed by the initiating user. Prior to call commencement, both MCPTT UEs are
provisioned by the KMS with time-limited key material associated with the
MCPTT User. The PCK is distributed with a 32-bit Key Identifier (PCK-ID)
within a MIKEY payload within the SDP content of the Private Call Request.
This payload is a MIKEY-SAKKE I_MESSAGE, as defined in RFC 6509 [13], which
ensures the confidentiality, integrity and authenticity of the payload.
The pCK is encrypted to the user identity (UID) associated to the MCPTT UE.
The UID used to encrypt the data will be derived from the terminating user\'s
URI (e.g. user.002\@mcptt.example.org) and a time-related parameter (e.g. the
current year and month). The terminating user\'s URI is added to the recipient
field (IDRr) of the message.
The payload includes the encrypted PCK and the key identifier (PCK-ID). The
PCK is unique within the MCPTT system. On creating the PCK, the initiator
generates a 32-bit PCK Identifier (PCK-ID). The 4 most significant bits of the
PCK-ID indicate the purpose of the PCK is to protect Private call
communications, the other 28-bits are randomly generated.
The payload is signed using (the KMS-provisioned key associated to) the
identity of the initiating user. This identity is derived from the initiating
user\'s URI (e.g. user.001@mcptt.example.org) and a time-related parameter
(e.g. the current year and month). The initiating user\'s URI is added to the
initiator field (IDRi) of the message.
The security processes are summarized in Figure 7.5.1-1.
Figure 7.5.1-1: Security information within a Private Call Request
Via this mechanism, PCK distribution is confidentiality protected,
authenticated and integrity protected.
At the terminating MCPTT UE, the initiating user\'s URI is extracted from the
initiator field (IDRi) of the message. This is converted to a UID and used to
check the signature on the MIKEY-SAKKE I_MESSAGE. If valid, the UE extracts
and decrypts the encapsulated PCK using the (KMS-provisioned) user\'s UID key.
The MCPTT UE also extracts the PCK-ID. This process is shown in Figure
7.5.1-2.
Figure 7.5.1-2: Processing the security content of a private call request
With the PCK successfully shared between the two MCPTT UEs, the UEs are able
to use SRTP/SRTCP to create an end-to-end secure session.
NOTE: This solution is for the end-to-end protection of PCKs and does not
protect the identities transmitted. These may be protected by other means.
### 7.5.2 Security procedures (on-network)
The security procedures provide a mechanism for establishing a security
context as part of the Private Call Request sent from the initiating UE to the
terminating UE. TS 23.179 [10] contains four procedures for the commencing a
MCPTT private call; manual or automatic commencement for a single or multiple
MCPTT systems. As the security procedures are the same in each of these cases,
the procedures below apply to each of the four procedures in TS 23.179.
The security processes for securing an on-network private call are summarized
in Figure 7.5.2-1. The intent of these procedures is to transfer a PCK and
PCK-ID to the terminating UE.
Figure 7.5.2-1: Private Call security procedures for on-network PCK
distribution
The procedure in Figure 7.5.2-1 is now described step-by-step.
0\. Prior to beginning this procedure it is assumed that the MCPTT UEs have an
authenticated MCPTT user and that the MCPTT UEs have been provisioned with key
material associated with the MCPTT user.
1\. The initiating MCPTT UE generates the PCK and sends a MCPTT private call
request to the terminating MCPTT UE. This message is created in Step 3 of
clause 10.10.2.1.1, clause 10.10.2.1.2, clause 10.10.2.2.1 and clause
10.10.2.2.2 within TS 23.179 [10]. The message is transferred via one or more
MCPTT Servers, for example steps 3, 5, 8 of clause 10.10.2.2.2 within TS
23.179. Within this message is a SDP offer within which the initiating MCPTT
UE includes a MIKEY-SAKKE I_MESSAGEs as defined in RFC 6509 [13]. The
I_MESSAGE encapsulates the PCK for the terminating MCPTT user, encrypting the
key to the UID of the terminating user (derived from the user\'s URI). The
I_MESSAGE also contains an identifier for the PCK (PCK-ID). The I_MESSAGE is
signed using (the key associated with) the initiating user\'s UID.
NOTE 1: This message may be pre-generated to increase the efficiency of the
communication.
NOTE 2: Optionally, the MCPTT UE may attach an additional SAKKE component
which encrypts the PCK to the initiating user (in addition to the terminating
user).
2\. Further session signalling occurs as defined in TS 23.179 [10].
With the PCK and PCK-ID shared between the initiating and terminating users,
the media communicated between the UEs may be protected using the PCK.
### 7.5.3 Off-network security procedures
The security processes for securing an off-network private call are summarized
in Figure 7.5.3-1. As part of this process, the PCK and PCK-ID are securely
transferred to the terminating UE.
Figure 7.5.3-1: Private Call security procedures for off-network PCK
distribution
The procedure in Figure 7.5.3-1 is now described step-by-step.
0\. Prior to beginning this procedure the MCPTT UEs may have performed a
discovery procedure
1\. The initiating MCPTT UE generates the PCK and sends a Call Setup Request
to the terminating MCPTT UE (Step 4 of clause 10.10.3.1 within TS 23.179
[10]). Within this message, the initiating MCPTT UE includes a MIKEY-SAKKE
I_MESSAGEs as defined in RFC 6509 [13]. The I_MESSAGE encapsulates the PCK for
the terminating MCPTT user, encrypting the key to the UID of the terminating
user (derived from the user\'s URI). The I_MESSAGE also contains an identifier
for the PCK (PCK-ID). The I_MESSAGE is signed using (the key associated with)
the initiating user\'s UID.
NOTE 1: This message may be pre-generated to increase the efficiency of the
communication.
NOTE 2: Optionally, the MCPTT UE may attached an additional SAKKE component
which encrypts the PCK to the initiating user (in addition to the terminating
user).
2\. A Call Setup Response is returned to the initiating UE as defined in TS
23.179 [10].
With the PCK and PCK-ID shared between the initiating and terminating users,
the media communicated between the UEs may be protected using the PCK.
### 7.5.4 Media stream protection
As a result of this mechanism, the group members share a PCK and PCK-ID. The
PCK is used as the MIKEY Traffic Generating Key (TGK), the PCK-ID is used as
the MIKEY CSB ID. These are used to generate the SRTP Master Key and SRTP
Master Salt as specified in RFC 3830 [36].
Figure 7.5.4-1: Key Derivation for media stream protection
To identify the security context from the media stream a SRTP Master Key
Identifier (MKI) is required. The MKI is the PCK-ID.
## 7.6 Solution #6: End-to-end protection for private call in on-network
### 7.6.1 General
This solution address the Key Issue#12 (on-network) mentioned in the present
document.
Based on the deployment scenario either SDES or KMS key management mechanism
and based on the functionality supported (like discreet listening) either e2e
or e2ae mode to be selected for private call protection.
\- For the deployment options, where the MCPTT server and the SIP core are
administered by the same party (Operator or PS agency), then either SDES (with
e2e or e2ae protection) or KMS key management solution (e2e protection) as
specified in TS 33.328 is used for private call confidentiality.
\- For the deployment options, where the MCPTT server and the SIP core are
administered by different parties (Operator and PS Agency) and if MCPTT
service provider domain desire to provide their own key management service,
then KMS key management solution with e2e mode as specified in TS 33.328 [12]
is used.
\- For the deployment options, where the MCPTT server and the SIP core are
administered by different parties (Operator and PS Agency) and if MCPTT
service provider domain trust the SIP Core, then either SDES (with e2e or e2ae
protection) or KMS key management solution (e2e protection) as specified in TS
33.328 [12] is used for private call confidentiality.
The MCPTT UE may learn of a preference for e2e-security for a particular
session using a particular key management protocol by explicit user action via
the user interface or by the security policy implemented on the MCPTT UE.
The media plane security for RTP based media is based on SRTP. The media plane
security for MSRP, used in session-based messaging, is based on TLS. TLS is
also used to protect BFCP.
### 7.6.2 End-to-end protection using SDES
Figure 7.6.2-1 shows the e2e secure Private call set-up procedures for one RTP
media stream using SDES based e2e security, as specified in TS 33.328 [12].
Figure 7.6.2-1 is based on the private call setup procedure specified in the
TS 23.179 [10]. The procedures shown in the figure 7.6.2-1 apply to MCPTT
users located in the same MCPTT system. The same concepts apply to MCPTT users
in multiple MCPTT systems.
Figure 7.6.2-1: Private call setup flow for e2e protection case using SDES
The MCPTT client 1 and the MCPTT client 2 rely on MCPTT user authentication to
authenticate each other. The SDP crypto attribute requires the services of a
data security protocol to secure the SDP message [cf. TS 33.328]. For the use
of SDES in MCPTT service, the SIP signalling security mechanisms defined for
MCPTT service is used.
> 1\. It is assumed that MCPTT users on MCPTT client 1 and MCPTT client 2 are
> already registered for receiving MCPTT service.
>
> 2\. User at MCPTT client 1 would like to initiate an MCPTT private call for
> the chosen MCPTT user.
>
> 3\. MCPTT client 1 sends an MCPTT private call request towards the MCPTT
> server (via SIP core) for establishing a private call with the MCPTT client
> 2. MCPTT client 1 sends an SDP Offer for an SRTP stream containing one or
> more SDES crypto attributes contains at least one master key K1, and other
> security context parameters chosen by MCPTT client 1 as specified in TS
> 33.328 [12] to the MCPTT server.
>
> 4\. MCPTT server checks whether the MCPTT user at MCPTT client 1 is
> authorized to initiate the private call, and that MCPTT user at MCPTT client
> 2 is authorized to receive the private call.
>
> 5\. MCPTT server may provide a progress indication to MCPTT client 1 to
> indicate progress in the call setup process. Step 5 may occur at any time
> following step 4, and prior to step 9.
>
> 6\. If authorized, MCPTT server forwards the SDP Offer to the MCPTT client
> 2.
>
> 7\. The receiving MCPTT client 2 notifies the user about the incoming
> private call.
>
> 8\. The receiving MCPTT client 2 accepts the private call automatically, and
> an acknowledgement is sent to the MCPTT server (via SIP core). MCPTT client
> 2 selects one of the received SDES crypto attributes, and then replies with
> an SDP Answer for an SRTP media stream, including one SDES crypto attribute
> with at least one master key K2, and other security context parameters
> chosen by MCPTT client 2 as specified in TS 33.328 [12] to the MCPTT server.
>
> 9\. Upon receiving the acknowledgement from MCPTT client 2 accepting the
> private call request, the MCPTT server informs the MCPTT client 1 about
> successful call establishment. The MCPTT server forwards the SDP Answer
> towards the MCPTT client 1.
>
> 10\. MCPTT client 1 and MCPTT client 2 have successfully established media
> plane for communication and either user can transmit media. The protected
> RTP media stream is sent between MCPTT client 1 and MCPTT client 2. MCPTT
> client 1 integrity protects / encrypts the media stream sent towards MCPTT
> client 2 using key K1 (and possibly further master keys) from the crypto
> attribute selected by MCPTT client 2 and checks integrity / decrypts the
> media stream arriving from MCPTT client 2 using key K2 (and possibly further
> master keys).
### 7.6.3 End-to-access edge using SDES
For the e2ae mode, SDES is run between an MCPTT Client and a SIP edge proxy
(i.e. a P-CSCF (IMS-ALG) in case of IMS and an inbound/outbound proxy in case
of SIP core), as specified in TS 33.328 [12].
### 7.6.4 End-to-end protection using KMS
Access to the KMS is granted based on user authentication and authorization
[cf., TS 33.328]. User authentication may be based on MCPTT user
authentication.
Figure 7.6.4-1 shows the Private call set-up procedures for one RTP media
stream using SDES based e2e security, as specified in TS 33.328 [12]. Figure
7.6.4-1 is based on the private call setup procedure specified in the TS
23.179 [10]. The procedures shown in the figure 7.6.4-1 apply to MCPTT users
located in the same MCPTT system. The same concepts apply to MCPTT users in
multiple MCPTT systems.
Figure 7.6.4-1: Private call setup flow for e2e protection case using KMS
> 1\. It is assumed that MCPTT users on MCPTT client 1 and MCPTT client 2 are
> already registered for receiving MCPTT service.
>
> 2\. User at MCPTT client 1 would like to initiate an MCPTT private call for
> the chosen MCPTT user. Then depending on KMS and local policy, the MCPTT
> client 1 will either interact with the KMS to obtain keys and a MIKEY-TICKET
> Ticket usable for MCPTT client 2, or it will create the ticket by itself as
> specified in TS 33.328 [12].
>
> 3\. MCPTT client 1 sends an MCPTT private call request towards the MCPTT
> server (via SIP core) for establishing a private call with the MCPTT client
> 2. MCPTT client 1 sends an SDP offer for an RTP or MSRP session containing a
> MIKEY-TICKET offer for MCPTT client 2 to the MCPTT Server.
>
> 4\. MCPTT server checks whether the MCPTT user at MCPTT client 1 is
> authorized to initiate the private call, and that MCPTT user at MCPTT client
> 2 is authorized to receive the private call.
>
> 5\. MCPTT server may provide a progress indication to MCPTT client 1 to
> indicate progress in the call setup process. Step 5 may occur at any time
> following step 4, and prior to step 9.
>
> 6\. If authorized, MCPTT server forwards the SDP Offer to the MCPTT client
> 2.
>
> 7\. The receiving MCPTT client 2 notifies the user about the incoming
> private call. MCPTT client 2 checks if it is authorized to resolve the
> ticket and if that is the case MCPTT client 2 interacts with the KMS to
> resolve the ticket and receive keys, as specified in TS 33.328 [12].
>
> 8\. The receiving MCPTT client 2 accepts the private call automatically, and
> an acknowledgement is sent to the MCPTT server (via SIP core). MCPTT client
> 2 including a MIKEY-TICKET response as specified in TS 33.328 [12] to the
> MCPTT client 1 through the MCPTT server.
>
> 9\. Upon receiving the acknowledgement from MCPTT client 2 accepting the
> private call request, the MCPTT server informs the MCPTT client 1 about
> successful call establishment. The MCPTT server forwards the SDP Answer
> towards the MCPTT client 1.
>
> 10\. MCPTT client 1 and MCPTT client 2 have successfully established media
> plane for communication and either user can transmit media. MCPTT client 1
> derives the media session keys and initiates the media plane security. For
> an RTP session this means sending and receiving SRT(C)P streams and for an
> MSRP session this means setting up a TLS-PSK tunnel to protect the MSRP
> messages.
### 7.6.5 Feasibility analysis of SDES and KMS mechanism
#### 7.6.5.1 SDES and KMS mechanisms
As specified in TS 33.328, the SDES and KMS are defined for IMS media plane
security, which guarantees protection of IMS media against eavesdropping and
undetected modification in an end-to-end (e2e) fashion between two terminal
devices.
In order to establish end-to-end security associations for media plane, either
of these two mechanisms use the SIP signalling to transmit necessary security
parameters through the SIP infrastructure:
\- The SDES is for e2ae and for e2e media protection and it relies on the
security of the SIP infrastructure and in particular on SIP signalling
security, i.e. IPsec.
\- The KMS is for e2e protection and aims for high security, independent of
the signalling and transport network. It is based on use of a Key Management
Service (KMS) and a ticket concept. The security is anchored in the KMS
including the functionality used for user authentication and key generation
towards the KMS.
#### 7.6.5.2 MCPTT media plane security
In MCPTT scenario, it requires that the application media plane has its own
security which is independent of network security, so the exchanged security
parameters for establishing MCPTT media security cannot be protected from MNO.
When it assumes that users or application service provider trust the IMS
network, this obviously makes sense. But if users or application service
provider does not trust the IMS network of MNO and want media data to be
hidden from MNO, in case the SIP core is administrated by a rogue MNO, as the
IPsec for SIP signalling is manipulated by MNO, it can easily obtain the
exchanged security parameters for an end-to-end media plane security.
#### 7.6.5.3 Feasibility of SDES and KMS
\- For SDES, as the security parameters for the media plane security is
exchanged through SIP signalling and it relies on the security of the SIP
infrastructure, so if SIP core is administrated by MNO, the media server may
not trust the IPsec protection that is provided to the security parameters by
the underlying MNO administering the SIP core. Thus, SDES cannot be used in
MCPTT scenario.
\- For KMS, the security is based on the use of a Key Management Server (KMS)
and a ticket concept other than IPsec. The exchanged security parameters (i.e.
ticket) cannot be used to derive media security directly, instead, only the
ticket used as token is transferred and the receiver can use the ticket to get
media plane keys from KMS. As a result, MNO cannot obtain the media plane keys
from the SIP signalling between users.
Another security need to be considered is that whether the link between user
and KMS is secure enough. TS33.328 suggests to use GBA security. If the KMS is
administrated by Public Safety agency and if the ISIM/USIM is implemented for
dedicated MCPTT usage by PS agency and also the PS UDF stores the
corresponding security parameters (i.e. K), GBA can be used because the GBA SA
can be assumed to terminated in PS security domain. Otherwise, GBA (i.e. MNO-
based) is not used. Besides GBA, some other security mechanisms may ensure the
security between user and KMS, but it makes sure that they can prevent MNO
from obtaining the media plane keys.
#### 7.6.5.3 Conclusion
\- If the MCPTT operator is different from the MNO and the SIP core is
administrated by MNO, when the MCPTT media needs to be protected against the
MNO, SDES security mechanism cannot be used in MCPTT.
\- If the security mechanism between user and KMS can prevent MNO from
obtaining the media plane keys, KMS security mechanism can be used.
## 7.7 Solution #7: Media stream protection
### 7.7.1 General
The following mechanism is used to protect MCPTT communications which use the
Real-Time Transport Protocol (RTP), cf. RFC 3550 [14]. The integrity and
confidentiality protection for MCPTT communications using RTP are achieved by
using the Secure Real-Time Transport Protocol (SRTP), RFC 3711 [7].
The key management mechanism for SRTP is described elsewhere. As a result of
this mechanism, those communicating will have shared the following:
1) A SRTP Master Key.
2) A SRTP Master Salt.
3) A SRTP Master Key Identifier (MKI) referencing the above two values.
The mechanism described in RFC 3711 [7] is used to encrypt the RTP payload. A
diagram of the key derivation mechanism (as described in RFC 3711) is shown in
Figure 7.7.1-1.
Figure 7.7.1-1: Security mechanism for media stream protection
### 7.7.2 Security procedures for media stream protection
Media stream protection does not require any signalling mechanism to convey
information. The information is provided within each SRTP Packet.
Figure 7.7.2-1: Security procedure for media stream protection
Figure 7.7.2-1 shows the security mechanism:
0) Prior to beginning this procedure the MCPPT UEs involved in the
communication has established a security context (SRTP Master Key, SRTP Master
Salt, MKI).
1) Transmitting UEs send SRTP packets using the format described in RFC 3711\.
The packet includes a Master Key Identifier (MKI) field which contains the
information required to locate the SRTP Master Key and Master Salt. On receipt
of a SRTP packet, a terminating UE uses the contents of the MKI to look up the
appropriate SRTP Master Key and salt and generate the appropriate SRTP session
key and salt if it satisfies the key derivation rate criteria as specified in
RFC3711.
NOTE 1: Assuming members of the group have been keyed/pre-provisioned at some
point in the past, this security mechanism is entirely stateless.
NOTE 2: The receiver does not need to generate an appropriate SRTP session key
and salt every time when it receives a SRTP packet. The key derivation rate
defined in RFC3711 [7] determines the session key generation frequency. Refer
to RFC3711 for more information.
A diagram of the SRTP packet format is within Figure 7.7.2-2.
Figure 7.7.2-2: SRTP packet format showing security parameters
The length of the MKI field is defined by the key distribution procedure used
to create the original security context.
## 7.8 Solution #8: Protection of floor control signalling (SRTCP)
### 7.8.1 General
Floor control signalling is sent from the MCPTT UE to a Floor Arbitrator. The
Floor Arbitrator will be part of the MCPTT server when MCPTT group
communications are online. When MCPTT group communications are offline, the
Floor Arbitrator will be an MCPTT client.
For online communications, the connection between the MCPTT UE and the Floor
Arbitrator (MCPTT Server) may already be protected alongside other MCPTT
signalling (using a mechanism defined elsewhere). For offline communications,
the connection may not be protected by other means. This solution defines a
mechanism to protect floor control signalling where it is required.
NOTE: Protection of floor control may or may not use the same security context
as the protection of media plane.
### 7.8.3 Floor control protection (SRTCP)
Where floor control signalling is transmitted using RTCP, cf. RFC 3550 [14],
the following mechanism may be used to protect the signalling. The integrity
and confidentiality protection for one-to-many communications using RTP may be
achieved by using SRTCP, RFC 3711 [7].
The key management mechanism for SRTCP uses the same mechanism as SRTP. As a
result of this mechanism, the group members share a Master Key, a Master Salt
and an MKI for the protection of SRTCP. The Master Key and Master Salt for
SRTCP may differ to the SRTP Master Key and SRTP Master Salt used for SRTP
(requiring two key management messages to be sent).
The mechanism described in RFC 3711 [7] is used to encrypt the RTCP payload. A
diagram of the key derivation mechanism (as described in RFC 3711) is shown in
Figure 7.8.1-1.
Figure 7.8.3-1: Security mechanism for floor control protection
### 7.8.4 Security procedures for floor control protection
Floor control protection does not require any signalling mechanism to convey
information. The information is provided within each SRTCP Packet.
Figure 7.8.4-1: Security procedure for media stream protection
Figure 7.8.3-1 shows the security mechanism.
0) Prior to beginning this procedure the MCPPT UEs involved in the
communication have established a security context for SRTCP (Master Key,
Master Salt, MKI).
1) Transmitting UEs send SRTCP packets using the format described in RFC 3711.
The packet includes a Master Key Identifier (MKI) field which contains the
information required to locate the Master Key and Master Salt. On receipt of a
SRTCP packet, a terminating UE uses the contents of the MKI to look up the
appropriate Master Key and salt and generate the appropriate SRTCP session key
and salt if it satisfies the key derivation rate criteria as specified in
RFC3711.
NOTE 1: Assuming members of the group have been keyed/pre-provisioned at some
point in the past, this security mechanism is entirely stateless.
NOTE 2: The receiver does not need to generate an appropriate SRTP session key
and salt every time when it receives a SRTP packet. The key derivation rate
defined in RFC3711 [7] determines the session key generation frequency. Refer
to RFC3711 for more information.
A diagram of the SRTCP packet format is within Figure 7.8.3-2.
Figure 7.8.4-2: SRTCP packet format showing security parameters
The length of the MKI will be determined by the key distribution mechanism.
## 7.9 Solution #9: GCSE based security for MCPTT service
### 7.9.1 Introduction
In TS 23.179 [10], the MCPTT service data need to be carried in EPS layer and
GCSE based mechanism is one alternative method. The data is transferred via
EPS bearer between MCPTT Server and MCPTT UE in Unicast Delivery mode and may
be delivered from MCPTT server to MCPTT UE via MBMS bearer in MBMS Delivery
mode.
NOTE: MBMS security cannot be used in conjunction with media security.
### 7.9.2 Potential GCSE based security solutions for MCPTT
#### 7.9.2.0 Introduction
Based on the legacy security solutions in TR 33.888 [22], it can get some
potential security solutions for MCPTT.
#### 7.9.2.1 Security for unicast delivery mode
For unicast delivery mode, the Group Communication data can be delivered as
the normal user plane data. End-to-end security protection is used in
application layer between MCPTT AS and MCPTT UE. In EPS layer, hop-by-hop
security protection is used, i.e. network domain security mechanism in network
domain (e.g. NDS/IP) and LTE access security mechanism (as specified in TS
33.401 [21]) in air interface.
#### 7.9.2.2 Security for multicast delivery mode
In MBMS Delivery mode, if MBMS security is applied for MCPTT, as the MCPTT AS
may be responsible for the group management and BM-SC does not have group
management functionality, it makes BM-SC impossible to distribute MBMS keys
(e.g. MSK) to UEs. Some enhancements need to be done to get an appropriate
MBMS security solution for MCPTT Service. The following gives 2 possible
options:
> **_Option A_**
  * _use non-3GPP standard GCSE group management and service key (MSK) > distribution by GCS AS;_
  * _use the part of MBMS security relating to traffic key (MTK) > distribution and media protection by BM-SC in 3GPP system_
> **_Option B_**
  * _use non-3GPP standard GCSE group management by GCS AS;_
  * _use MBMS security relating to service key (MSK) and traffic key > (MTK) distribution and media protection by BM-SC in 3GPP system_
## 7.10 Solution #10: Inter/Intra domain protection for MCPTT service
For all interfaces between network elements between the trusted domains or
within the trusted domain, NDS/IP as specified in TS 33.210 [8] is used to
secure signalling messages. TS 33.310 [25] is applied regarding the use of
certificates with the security mechanisms of TS 33.210 [8]. SEG may be used in
each trusted domain to terminate the IPsec tunnel.
For the case of an interface between two network elements in the same trusted
domain, TS 33.210 [8] does not mandate the protection of the interface by
means of IPsec. It is up to the domain administrator\'s policy to protect
interfaces within the same trusted domain.
NOTE: In general, MCPTT domain should trust SIP core, as SIP core is the
signaling plane for the MCPTT service.
## 7.11 Solution #11: HTTP-1 interface protection
### 7.11.1 General
The HTTP-1 reference point is specified between the MCPTT UE HTTP client and
the HTTP application server for MCPTT data management of the MCPTT service.
### 7.11.2 Authentication for Common Service Core (CSC) access
Based on the configuration provided with the MCPTT client in the UE, mutual
authentication based on certificates may be performed between the HTTP Client
in the MCPTT UE and the HTTP Proxy. Mutual authentication based on certificate
is performed according to the profiles given in TS 33.310 [25], clauses 6.1.3a
and 6.1.4a. The structure of the PKI used for the certificate is out of scope
of the present document. The exact process for establishing the TLS
connections is dependent on the MCPTT client in the UE and is outside the
scope of this specification. Guidance on certificate based mutual
authentication is provided in TS 33.222 [29], Annex B.
Based on the configuration provided with the MCPTT client in the UE, mutual
authentication based on pre-shared key may be performed between the HTTP
Client in the MCPTT UE and the HTTP Proxy.
### 7.11.3 HTTP-1 interface security
HTTP-1 interface is protected using Transport Layer Security (TLS). The
profile for TLS implementation and usage as specified in TS 33.310 [25], Annex
E is used.
If SCTP is supported, then DTLS is used for protection. The security profile
for DTLS as defined in TS 33.310 [25], Annex E is used.
If the PSK TLS based authentication mechanism is supported, the HTTP client in
the MCPTT UE and the HTTP Proxy supports the TLS version, PSK ciphersuites and
TLS Extensions as specified in the TLS profile given in TS 33.310 [25], Annex
E. The usage of Pre-Shared Key ciphersuites for TLS is specified in the TLS
profile as given in TS 33.310 [25], Annex E is used.
NOTE: TS 23.179 [10] specifies that HTTP-1 reference point uses the Ut
reference point as defined in 3GPP TS 23.002 [24]. Security for Ut reference
point allows also other authentication options as specified above.
## 7.12 Solution #12: Using S/MIME to protect MCPTT Application plane
messaging in SIP messages
### 7.12.1 General
When required by the MCPTT service provider, application plane identities
(e.g. MCPTT group ID, MCPTT user identity) and similarly sensitive associated
user and group attributes (e.g. MCPTT user name, MCPTT user organization) are
hidden from the SIP signalling control plane.
The MCPTT-1 messages are transported as SIP messages between the MCPTT Server
and the MCPTT UE over SIP-1 and SIP-2. When the SIP Core is administrated in a
non-PS (Public Safety) security domain (e.g. MNO), the MCPTT server may not
trust the SIP Core. The SIP Core terminates the IPsec tunnel, and therefore it
could decrypt IP packets and obtain sensitive application plane information
encapsulated in the SIP message.
SIP messages carry MIME bodies. S/MIME specification [30] provides a mechanism
to secure MIME data by adding cryptographic signature and encryption services
based on the Cryptographic Message Syntax [33].
### 7.12.2 Cryptographic Message Syntax (CMS)
The Cryptographic message syntax (CMS) is used to digitally sign, digest,
authenticate and encrypt the embedded MIME content.
There are several CMS content types. Of these, S/MIME uses the SignedData,
EnvelopedData, Data and CompressedData content types.
Figure 7.12.2-1 CMS Content types
\- SignedData: used to apply a digital signature to a message:
\- The Sender computes the message digest on the content with the digest
algorithm. The message digest is then digitally signed using the sender\'s
private key. The content, digital signature and the associated certificate
carrying sender\'s public key are stored in the SignedData object.
\- The receiver computes the message digest from the received content and
verifies the signature with the signer\'s public key. The sender\'s public key
is fetched from the certificate carried in the SignedData object.
\- EnvelopedData: used to apply data confidentiality to a message. It consists
of the encrypted content and the encrypted content-encryption key (CEK).
\- The sender encrypts the content with a randomly generated content-
encryption key. The CEK is encrypted with either the recipient\'s public key
OR a pair-wise symmetric key generated by using the recipient\'s public key
and the sender\'s private key OR a previously distributed symmetric key-
encryption key.The encrypted CEK along with the encrypted content is packed
into a EnvelopedData structure and sent to the recipient.
\- The recipient decrypts the encrypted CEK and then decrypts the encrypted
content with the recovered CEK.
\- Data content type used to identity the \"inner\" MIME message content. Used
to identity the signed or encrypted message content inside the SignedData or
EnvelopedData content types.
\- CompressedData content type is used to apply data compression to a message.
The syntax allows multiple encapsulations i.e. one encapsulation can be nested
inside another. For example, a SignedData content type can be used to
digitally sign the encrypted content present in the EnvelopedData object to
yield a ContentInfo object of type SignedData. Likewise the message can be
first signed in a SignedData object and then encrypted in an EnvelopedData
object resulting in a ContentInfo object of type EnvelopedData.
### 7.12.3 S/MIME
S/MIME is a protocol for adding cryptographic signature and encryption
services to MIME data. It uses CMS message format to generate a ContentInfo
object containing cryptographically signed and encrypted MIME data.
There are two ways to carry S/MIME content in the SIP message:
a) Using media type \"application/pkcs7-smime\"
b) Using media type \"multipart/signed\" and \"application/pkcs7-signature\"
S/MIME introduces a new media type called **\"application/pkcs7-mime\".** This
is used to carry CMS content types including EnvelopedData and SignedData. The
application/pkcs7-mime media type defines the optional \"smime-type\"
parameter. This parameter carries details about the security applied (signed
or enveloped) along with information about the contained content.
The CMS ContentInfo object is inserted into an \"application/pkcs7-mime\" MIME
entity.
A sample message with encrypted message would be as follows:
Content-Type: application/pkcs7-mime; smime-type=enveloped-data;
name=smime.p7m
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename=smime.p7m
rfvbnj756tbBghyHhHUujhJhjH77n8HHGT9HG4VQpfyF467GhIGfHfYT67n8HHGghyHhHUujhJh4V
QpfyF467GhIGfHfYGTrfvbnjT6jH7756tbB9Hf8HHGTrfvhJhjH776tbB9HG4VQbnj7567GhIGfHfYT
6ghyHhHUujpfyF0GhIGfHfQbnj756YT64V
S/MIME can also be used with another pre-defined media type for signed
messages -- **\"multipart/signed\"**. This media type has two parts. The first
part contains the MIME entity that is signed; the second part contains the
\"signature\" CMS SignedData object in which the content is absent. Media type
application/pkcs7-signature is used to carry a single CMS object of type
SignedData.
SIP recommends using \"application/pkcs7-mime\" media type to carry
confidentiality and integrity protected MIME content.
Following is an example of an encrypted-only S/MIME SDP body within a SIP
message (the text boxed in asterisks is encrypted):
INVITE sip:bob\@biloxi.com SIP/2.0
Via: SIP/2.0/UDP pc33.atlanta.com;branch=z9hG4bKnashds8
To: Bob \
From: Alice \;tag=1928301774
Call-ID: a84b4c76e66710
CSeq: 314159 INVITE
Max-Forwards: 70
Contact: \
Content-Type: application/pkcs7-mime; smime-type=enveloped-data;
name=smime.p7m
Content-Disposition: attachment; filename=smime.p7m
handling=require
*******************************************************
* Content-Type: application/sdp *
* *
* v=0 *
* o=alice 53655765 2353687637 IN IP4 pc33.atlanta.com *
* s=- *
* t=0 0 *
* c=IN IP4 pc33.atlanta.com *
* m=audio 3456 RTP/AVP 0 1 3 99 *
* a=rtpmap:0 PCMU/8000 *
*******************************************************
### 7.12.4 Confidentiality and integrity protection of MCPTT application
information using asymmetric keys
In this mechanism S/MIME is used with asymmetric cryptography to provide
confidentiality and integrity protection of MCPTT application information in
the SIP message.
The MCPTT client and the server establish their respective public and private
keys. Both obtain their signed-certificates from a trusted Certificate
Authority (KMS, for example) and exchange it with each other through a
mechanism that is beyond the scope of the present document.
The figure below depicts an S/MIME-protected SIP message with the MCPTT
application information encrypted and signed using CMS.
Figure 7.12.4-1: Encrypted and digitally signed MCPTT application content
The following is a sequence of steps taken by the MCPTT client to protect the
MCPTT application plane data in SIP:
  1. The MCPTT client randomly generates a content-encryption key (CEK) and uses it to encrypt the MCPTT application plane content.
  2. The CEK is encrypted with the MCPTT server\'s public key.
  3. The encrypted content along with the encrypted CEK is packed to form an EnvelopedData CMS object.
  4. The message digest is computed on the EnvelopedData CMS object.
  5. The digest is digitally signed by the MCPTT client using its private key.
  6. The signature, MCPTT client\'s certificate chain and EnvelopedData CMS object are collected to form a SignedData CMS object.
  7. The SignedData is wrapped in a CMS ContentInfo object and inserted into the SIP message as application/pkcs7-mime media type.
Figure 7.12.4-2: MCPTT Client using S/MIME to protect MCPTT application plane
content
The MCPTT server does the following when it receives a SIP message with the
embedded S/MIME content:
  1. It computes the message digest on the encapsulated EnvelopedData object present in the SignedData object.
  2. The message digest and the MCPTT client\'s public key are used to verify the signature. The client\'s public key is obtained from the certificate obtained from the SignedData.
  3. Once the signature is verified, the server opens the EnvelopedData object to obtain the encrypted CEK. The encrypted CEK is decrypted with its private key.
  4. The recovered content-encryption key is used to decrypt the encrypted MCPTT Application information.
Figure 7.12.4-3: MCPTT Server retrieving MCPTT application plane content
### 7.12.5 Confidentiality protection of MCPTT application information
S/MIME can be used to carry encrypted MCPTT application information in the SIP
message. The CMS EnvelopedData object is used encrypt and store the encrypted
MCPTT application content.
In the figure 7.12.5-1, two possible options of encryption are shown.
a) In one option, recipient\'s public key is used to encrypt the content-
encryption key (CEK) for that recipient. The recipient uses its private key to
decrypt the CEK.
b) In the second option, a previously distributed shared symmetric key
encryption key (KEK) is used to encrypt and decrypt the CEK.
In both the options, CEK is used to encrypt the original content.
## 7.13 Solution #13: KMS managed Content Encryption Key (CEK) for S/MIME
### 7.13.0 Introduction
This solution is based on solution #12 in Clause 7.12, \'Using S/MIME to
protect MCPTT Application plane messaging in SIP messages\'.
The MCPTT Service provider may require that MCPTT related identities and other
sensitive information transferred between the MCPTT client and MCPTT service
on the SIP-1 and SIP-2 interfaces be protected at the application layer from
any viewing, including protection from viewing at the SIP signaling layer.
When protection is required, SIP MIME packets encrypted with a symmetric
Content Encryption Key (CEK) may be used to satisfy these requirements.
Key management of the CEK may be administered by the MCPTT KMS. Before the KMS
can provide a CEK, the MCPTT user is authorized firstly for MCPTT key
management services by presenting a KMS access token to the KMS. The MCPTT
user obtains a KMS access token during user authentication. The KMS performs
authorization of the access token by verifying the token was properly signed
by the Identity Management (IdM) server.
Once the MCPTT user is authorized for key management services and if
protection of the SIP-1 and SIP-2 interfaces is required by the MCPTT service
provider, the KMS then distributes the CEK to both the MCPTT client and MCPTT
application server (i.e. the SIP session endpoints). The CEK is used to
encrypt and decrypt the SIP MIME packets [30]. A unique CEK identifier (Key
ID) is sent in the SIP message to identify the CEK at the receiving SIP
endpoint.
Editor\'s Note: Identification of the unique CEK is FFS. Use of a Key ID alone
may not be sufficient.
### 7.13.1 Authorizing the distribution of the Content Encryption Key (CEK)
To ensure that the MCPTT user is authorized to receive MCPTT key management
services, the MCPTT user provides a KMS access token to the KMS. The KMS
access token asserts the identity of the user to the KMS and is used by the
KMS to authorize the MCPTT user for key management services. The MCPTT user
obtains the KMS access token from the Identity Management Server (IdM) during
MCPTT user authentication. Once the MCPTT is authorized for key management
services, the KMS can distribute a CEK.
If multiple MCPTT users are logged into the MCPTT service simultaneously
through a single SIP session, each MCPTT client receives a different CEK and
Key ID (based on their identity). This way each MCPTT client is uniquely
protected.
### 7.13.2 Creation and distribution of the Content Encryption Key (CEK)
Once the MCPTT user is authorized for key management services, the KMS will
provide a CEK to the MCPTT client via the HTTP-1 interface. The HTTP-1
interface is protected with TLS and creates a secure path for providing both
the KMS access token to the KMS and the CEK to the MCPTT client.
The CEK is a 256-bit symmetric key which has a unique Key ID assigned by the
KMS. Both the CEK and Key ID are distributed to the SIP endpoints via the
HTTP-1 interface.
Figure 7.13.2-1 shows the functional message sequence for key management
authorization and distribution of a KMS managed CEK.
Figure 7.13.2-1: Message sequence for the authorization and distribution of a
KMS managed CEK
The following describes the steps performed in Figure 7.13.2-1:
Step 0: The UE attaches to the network, establishes normal connectivity, and
sets up network security as defined in TS 33.401 [21].
Step 1: The MCPTT UE establishes a secure session with the SIP Core. The SIP
User Agent authenticates to the SIP core and registers its IMPU. For IMS
authentication, TS 33.203 [9] applies.
NOTE 1: At this time, only a secure connection exists between the MCPTT UE and
the SIP Core, no MCPTT communications (emergency or otherwise) are available.
Step 2: The SIP core sends a SIP 3rd Party Registration to the MCPTT
application Server, notifying it of the MCPTT UE SIP registration. The
registered IMPU is sent in this step along with the SIP Core address. This
allows MCPTT server to allow minimal or default services for this SIP session
at this time.
Step 3a: The user provides its MCPTT User Identity and associated credentials
to the IdM server via the IdM client\'s user agent (over https). If the user
is successfully authenticated (and optionally authorized) by the IdM server,
the MCPTT client receives in return an access token specific to the MCPTT user
and MCPTT service and a KMS access token specific to the MCPTT user and the
KMS.
Step 3b: The KMS access token obtained in Step 3a is provided to the KMS on
the HTTP-1 interface protected with TLS. The KMS validates the KMS access
token. If the MCPTT user is authorized for key management services, then the
KMS provides the CEK (and unique Key ID). The KMS pushes the CEK (and Key ID)
to the MCPTT server.
NOTE 2: Steps 3a and 3b may occur at any point in this flow between Step 0 and
Step 4.
Step 4: The access token obtained in Step 3a may be provided to the MCPTT
server in a SIP Publish message. The MCPTT application validates the access
token. If the MCPTT user is authorized for MCPTT services, then the MCPTT
server binds the user associated with the access token with the SIP session
URI and IMPU. The MCPTT server responds by providing the MCPTT user its
service authorization profile.
Figure 7.13.2-2 shows the functional diagram for the distribution of a KMS
managed CEK. The dotted lines show the key management paths while the rest of
the diagram shows how the CEK is used and recovered by the MCPTT server.
Figure 7.13.2-2: Functional diagram for establishing a KMS managed CEK
### 7.13.3 Key management of the Content Encryption Key (CEK)
The CEK remains in use until the SIP session is torn down, the MCPTT user logs
off, or some other indication. If during the active SIP session an update of
the CEK is required (as determined by the KMS), the KMS may push a new CEK to
both the MCPTT client and the MCPTT application server.
If the MCPTT client or MCPTT application server require an update of a CEK,
The MCPTT client or the MCPTT server may request the KMS to provide a CEK. The
KMS will determine if an update of the current CEK or a new CEK is required
and distributed.
Figure 7.13.3-1 S/MIME encrypted MCPTT application content
The following is a sequence of steps taken by the MCPTT client to encrypt the
MCPTT application plane data using a symmetric key:
  1. The MCPTT client randomly generates a content-encryption key (CEK) and uses it to encrypt the MCPTT application plane content.
  2. The CEK is encrypted with the shared symmetric Key Encryption Key (KEK).
  3. The encrypted content along with the encrypted CEK is packed to form an EnvelopedData CMS object.
  4. The Enveloped data is wrapped in a CMS ContentInfo object and inserted into the SIP message as application/pkcs7-mime media type.
Figure 7.13.3-2: MCPTT client encrypting MCPTT Application content with a
symmetric key
The MCPTT server does the following when it receives a SIP message with the
embedded S/MIME content:
  1. The server opens the EnvelopedData object to obtain the encrypted CEK. The encrypted CEK is decrypted with the shared symmetric key encryption key (KEK).
  2. The recovered content-encryption key is used to decrypt the encrypted MCPTT Application information.
Figure 7.13.3-3: MCPTT Server retrieving the MCPTT application content
## 7.14 Solution #14: Identity based cryptography managed Content Encryption
Key (CEK) for S/MIME
### 7.14.0 Introduction
This solution is based on solution #12 in clause 7.12, \'Using S/MIME to
protect MCPTT Application plane messaging in SIP messages\'.
The MCPTT Service provider may require that MCPTT related identities and other
sensitive information transferred between the MCPTT client and MCPTT service
on the SIP-1 and SIP-2 interfaces be protected at the application layer from
any viewing, including protection from viewing at the SIP signaling layer.
When protection is required, SIP MIME packets encrypted with a symmetric
Content Encryption Key (CEK) may be used to satisfy this requirement.
Identity Based Cryptography (IBC) may be used to establish the CEK. Before IBC
can be used to establish and share the CEK, the MCPTT user is authorized
firstly for MCPTT key management services and receive the IBC public and
private identity key material. Authorization with the KMS is accomplished by
the MCPTT user presenting a KMS access token to the KMS. The MCPTT user
obtains this user specific KMS access token during user authentication. The
KMS performs authorization of the access token by verifying the token was
properly signed by the Identity Management (IdM) server.
Once the MCPTT user is authorized for key management services, the KMS
distributes the user\'s IBC key material to the MCPTT client.
If protection of the SIP-1 and SIP-2 interfaces is required by the MCPTT
service provider, then IBC is used to create the CEK, confidentiality protect
the CEK, integrity protect the CEK, and forward the CEK to the MCPTT
application server. The MCPTT application server receives the SIP message with
the protected CEK and retrieves it from the message. The CEK is then used for
S/MIME protection of the SIP payload in subsequent SIP messages [30].
### 7.14.1 Authorizing the distribution of the Content Encryption Key (CEK)
To ensure that the MCPTT user is authorized to receive MCPTT key management
services, the MCPTT user provides a KMS access token to the KMS. The KMS
access token asserts the identity of the user to the KMS and is used by the
KMS to authorize the MCPTT user for key management services. The MCPTT user
obtains the KMS access token from the Identity Management Server (IdM) during
MCPTT user authentication. Once the MCPTT is authorized for key management
services, the KMS can distribute the user\'s IBC public and private identity
key material.
If multiple MCPTT users are logged into the MCPTT service simultaneously
through a single SIP session.
Each MCPTT user receives a unique set of IBC public and private identity key
material (based on their identity). This way each MCPTT client can be uniquely
protected.
### 7.14.2 Creation and distribution of the Content Encryption Key (CEK)
Once the MCPTT user is authorized for key management services, the KMS will
distribute the user\'s IBC public and private identity key material to the
MCPTT client via the HTTP-1 interface. The HTTP-1 interface is protected with
TLS and creates a secure path for providing both the KMS access token to the
KMS and the user\'s IBC key material to the MCPTT client.
The CEK is a 256-bit symmetric key which is randomly generated by IBC. The CEK
may be regenerated and distributed as needed by the MCPTT client (for
instance; when a new SIP session is established).
### 7.14.3 Key management of the Content Encryption Key (CEK)
The CEK remains in use until; a new CEK is required, the SIP session is torn
down, the MCPTT user logs off, or some other indication. If during the active
SIP session an update of the CEK is required, the MCPTT client may establish a
new CEK and provide it to the MCPTT application server.
### 7.14.4 Transfer of the Content Encryption Key (CEK)
The following steps describe how the MCPTT client obtains the user specific
IBC public and private key material, and how the MCPTT client securely
transfers the CEK to the MCPTT application server:
1\. The MCPTT client provides the KMS token for authorization with KMS and
obtains the user specific IBC private/public key material.
2\. The MCPTT client randomly generates the CEK.
3\. Using the CEK, the MCPTT client encrypts personal identifiable information
(MCPTT ID, Group ID, MCPTT client\'s public identity key, etc.).
4\. The MCPTT client encrypts the CEK using the MCPTT server\'s IBC public
identity key.
5\. The MCPTT client signs the message with MCPTT client\'s IBC private
signing identity key.
6\. The MCPTT client constructs the MIME payload.
7\. The MCPTT client sends the SIP message, addressed to the PSI of the MCPTT
application server.
The following steps describe how the MCPTT server retrieves the CEK from the
IBS protected SIP message:
1\. The MCPTT server receives the SIP message.
2\. The MCPTT server decrypts the CEK using the MCPTT server\'s IBC private
identity key.
3\. Using the CEK, the MCPTT server decrypts the personal identifiable
information (MCPTT ID, Group ID, MCPTT client\'s IBS public identity key,
etc.), and obtains the client\'s IBS public identity key.
4\. The MCPTT server validates the signature using the MCPTT client\'s IBS
public identity key.
It is important to note that in this solution when a CEK is protected and
transferred in the payload of a SIP message, decryption of the CEK (step 2)
happens **before** message authentication (step 4).
Figure 7.14.4-1 shows the functional diagram for the MCPTT client and MCPTT
application server.
Figure 7.14.4-1: MCPTT client and MCPTT server functional diagrams for
establishing an IBC managed CEK
## 7.15 Solution #15: Using content indirection and XCAP to hide MCPTT
sensitive application information in SIP messages
### 7.15.1 General
This solution address the Key Issue#3, Key Issue#6, Key Issue#7, Key Issue#8,
Key Issue#9 (location information transmission) This solution address the Key
Issue#3, Key Issue#6, Key Issue#7, Key Issue#8, Key Issue#9 (location
information transmission) Key Issue#12 and Key Issue#18 mentioned in the
present document.
NOTE 0: Several protection mechanisms are discussed, Open questions regarding
this solution: whether they address the protection of all the sensitive
information; what is the complexity of multiple methods; how content
indirection is protected against impersonation and replays; if there is a
scalability issue with all group members fetching the calling party identifier
simultaneously at group call set-up.
When required by the MCPTT service provider, application plane identities
(e.g. MCPTT group identity (MCPTT group ID), MCPTT user identity (MCPTT ID))
need to be hidden from the SIP signaling control plane.
NOTE 1: Sensitive user and group attributes (e.g. MCPTT user name, MCPTT user
organization name) are not included in SIP signaling. These are only present
in XML documents delivered using HTTP-1 and HTTP-2 and secured using TLS.
As stated in 3GPP TS 23.179[10]: the MCPTT-1 reference point, which exists
between the MCPTT client and the MCPTT server, is used for MCPTT application
signalling for establishing a session in support of MCPTT. The MCPTT-1
reference point uses the SIP-1 and SIP-2 reference points for transport and
routing of SIP signalling. The MCPTT-1 reference point may use the HTTP-1 and
HTTP-2 reference points.
When the SIP Core is administrated in a non-PS (Public Safety) security domain
(e.g. MNO), the MCPTT server may not trust the SIP Core. The SIP Core
terminates the IPsec tunnel, and therefore it can obtain sensitive application
plane information encapsulated in the SIP message sent over SIP-1 and SIP-2.
NOTE 2: HTTP-1 can be secured using TLS in order to ensure that sensitive
application plane information encapsulated in the HTTP messages between the
MCPTT UE and the HTTP proxy cannot be seen by the PLMN operator or other third
parties.
SIP messages carry MIME bodies which can contain application level
information. The SIP messages can be divided into separate categories:
**Call/session related application messages:** these are messages that are
involved in call or session establishment, modification or disconnect. These
messages include SIP Methods: INVITE, UPDATE, PRACK, REFER, INFO, BYE, MESSAGE
and some of their responses. The bodies of some of these messages may contain
SDP that may need to be examined by some of the SIP core entities. Often some
of the contents of the bodies of these messages pass end to end and they may
have hard delay constraints for delivery of the application level information
since call setup times for MCPTT are low.
The INVITE and REFER requests are initial requests which need to identify the
originating MCPTT ID, destination MCPTT ID or MCPTT group ID which may need to
be protected. The SIP MESSAGE request is also used to indicate alerts (e.g.
Emergency Alerts) and in this case also need to identify the originating MCPTT
ID, destination MCPTT ID or MCPTT group ID which may need to be protected.
In the case when the MCPTT Group ID needs to be included for a Group call, the
MCPTT UE and MCPTT Server needs to include an HTTP XCAP URI reference to an
individual MCPTT Group URI within the list of MCPTT groups in the MCPTT User
Profile that the MCPTT User is allowed to affiliate to.
In the case when the MCPTT UE needs to include the destination MCPTT ID for a
Private Call, the MCPTT UE needs to include an HTTP XCAP URI reference to an
individual MCPTT ID within the list of MCPTT IDs in the MCPTT User Profile
that the originating MCPTT User is allowed to make private calls to.
In the case when the MCPTT Server needs to include the destination MCPTT ID
for a Private Call, the MCPTT Server needs to include an HTTP XCAP URI
reference to the individual MCPTT ID within the list of MCPTT IDs in the MCPTT
User Profile that the originating MCPTT User is allowed to make private calls
to.
In the case when the MCPTT Server needs to include the originating MCPTT ID
for a Private Call, the MCPTT Server needs to include an HTTP XCAP URI
reference to an individual MCPTT ID within the list of MCPTT IDs in the MCPTT
User Profile that the destination MCPTT User is allowed to receive private
calls from.
NOTE 3: The MCPTT Server determines the originating MCPTT ID from the mapping
created between the IMS Public User Identity and the MCPTT ID during MCPTT
authentication.
The INVITE and SIP MESSAGE request used to indicate alerts (e.g. Emergency
Alerts) also can indicate various alert statuses or cancellation of the alert
status in the MIME body and this information is potentially sensitive and may
need to be protected. This information can be protected by having the values
for these alert indications provisioned to the MCPTT UE in the UE
Configuration and to the MCPTT Server in the Service Configuration so that the
meaning of these values is not understood outside of the MCPTT application.
For interoperability between partner and primary systems and interoperability
agreement is needed to agree a common set of values for indications. The MCPTT
server needs to translate values to those contained in the interoperability
agreement when interoperating with a partner MCPTT server over MCPTT-3.
**Non call/session related application messages:** these are between the MCPTT
UE (MCPTT Client/Configuration Management Client/Group Management Server) and
MCPTT Server/Configuration Management Server/Group Management Server. These
messages include SIP Methods: SUBSCRIBE, NOTIFY, PUBLISH, and MESSAGE. The
bodies of these requests do not need to be examined by the SIP core entities
and they don\'t have hard delay constraints for delivery of the application
level information since they are not related to call setup. The bodies of
these messages may contain MCPTT IDs, MCPTT Group IDs, MCPTT user names, MCPTT
user organization names,
For requests from Server to UE such as SIP NOTIFY the MIME content that
contains sensitive application information can be stored at the server and the
content indirection mechanism in IETF RFC 4483 [31] can be used to provide a
URI to the stored MIME content and the MCPTT UE uses HTTPS to securely
retrieve this MIME content using HTTP-1 and HTTP-2.
NOTE 4: The content indirection mechanism in IETF RFC 4483 [31] may also need
to be used for requests such as SIP NOTIFY even when hiding of sensitive
application information is not required because the MIME content can become
too large to be transmitted in a SIP message body (e.g. MIME body for the
Conference Event Package for large groups).
SIP PUBLISH is used by the MCPTT UE to provide certain settings (i.e. the
answer mode) and the list of MCPTT group IDs that the MCPTT User wishes to
affiliate to. The answer mode setting is not sensitive but the MCPTT Group IDs
are sensitive. In the case when the MCPTT Group IDs being affiliated to are
sensitive the MCPTT UE needs to either include an HTTP XCAP URI reference to a
particular pre-defined list of MCPTT Group IDs configured in the MCPTT User
Profile (i.e. a list of MCPTT groups that is related to a particular profile
of the MCPTT User) and/or an HTTP XCAP URI reference to an individual MCPTT
Group URI within the list of MCPTT groups in the MCPTT User Profile that the
MCPTT User is allowed to affiliate to.
SIP MESSAGE is used to:
\- request for a MBMS listening status update;
\- request for location reporting;
\- request for location report configuration; and
\- request for location report request.
The MIME bodies for the above requests do not contain MCPTT identities however
the location information can be considered sensitive even though the location
of the MCPTT UE is always available to the PLMN operator using the PLMN
location mechanisms. The location object sent in the SIP MESSAGE from the
MCPTT client to the MCPTT server needs signing and encrypting.
### 7.15.2 Content indirection
IETF RFC 4483 [31] defines a mechanism for content indirection in Session
Initiation Protocol (SIP) messages using an extension to the URL MIME
External-Body Access-Type to support content indirection. These extensions
allow any MIME part in a SIP message to be referred to indirectly via a URI
(such as an HTTP or HTTPS URI) allowing the recipient of the SIP message to
retrieve the actual content of the MIME part using the included URI (i.e.
retrieve the content from the server using HTPP or HTTPS.
With IETF RFC 4483 [31] instead of including MIME content directly into the
body of the SIP message a message/external-body MIME type is used that
contains a URL that points to a document containing the actual content. The
content is then fetched using HTTP or HTTPS by the recipient. By using HTTPs
the content can be securely delivered to the recipient since it is encrypted
using TLS.
A hash parameter can also be included to ensure that the actual content is the
intended content so that no intermediary can tamper with the URL (provide
integrity protection).
### 7.15.3 XCAP URIs
IETF RFC 4825 [32] defines the Extensible Markup Language (XML) Configuration
Access Protocol (XCAP). XCAP allows a client to read, write, and modify
application configuration data stored in XML format on a server. XCAP maps XML
document sub-trees and element attributes to HTTP URIs, so that these
components can be directly accessed using HTTP. Thus a particular XML
component can be read or modified without the client having to download or
upload the complete XML document. The format of the XCAP HTTP URI can identify
a specific element within an XML document and even a specific attribute:
EXAMPLE:
The contact list document XML (//UserProfile/user-role-ID/contact-list)
\
\
\
\
\
\
\
\
\
\
\
\
To identify sip:joe@example.org (4^th^ entry in the list) then the node
selector is:
xcap.example.com/UserProfile/user-role-ID/contact-list/\~\~/resource-
lists/list/entry[4]/\@uri
and the corresponding HTTPS URI is:
https://xcap.example.com/UserProfile/user-role-ID/contact-list/\~\~/resource-
lists/list/ entry%5b4%5d/\@uri
NOTE: %5b4%5d is equivalent to [4] that has been escaped (%5b = [ and %5d=]).
### 7.15.4 Contact list organisation
Figure 7.15.4-1 User Profile and Contact Lists
Figure 7.15.4-1 represents proposed document architecture for the UserProfile
with separate common contact lists that can be referenced using XCAP URIs to
identify the contacts that a MPCTT User can make a private call to or receive
a private call from.
If XCAP URIs to the contact entries are included in the User Profile then the
MCPTT UE when making a call can indicate the called MCPTT ID by including the
XCAP URI to the Contact as the URL for the called user in the
message/external-body MIME type in the body of the SIP Message. Similarly the
MCPTT server can include an XCAP URI to a contact in the SIP Message on the
terminating side to identify the calling party to the called MCPTT UE.
For MCPTT group calls the MCPTT group ID can similarly be identified using an
XCAP URI to lists of Group IDs.
Example message/external-body MIME body
EXAMPLE:
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=boundaryMCPTT
\--boundaryMCPTT
Content-Type: message/external-body;
access-type=\"URL\";
expiration=\"Mon, 24 June 2016 09:01:32 GMT\";
URL=\"https://xcap.example.com/UserProfile/user-role-ID/contact-
list/\~\~/resource-lists/list/entry%5b4%5d/\@uri\"
size=62
hash=10AB568E91245681AC1B
Content-Type: application/recipient-list+xml
Content-Disposition: recipient-list
\--boundaryMCPTT--
## 7.16 Solution #16: Protecting the location object
### 7.16.1 General
When protection of the location object is required, encrypting the location
object with a symmetric Content Encryption Key (CEK) may be used to satisfy
these requirements.
Key management of the CEK may be administered by the MCPTT KMS. Before the KMS
can provide a CEK, the MCPTT user needs to first be authorized for MCPTT key
management services by presenting a KMS access token to the KMS. The MCPTT UE
obtains a KMS access token during user authentication. The KMS performs
authorization of the access token by verifying the token was properly signed
by the Identity Management (IdM) server.
Once the MCPTT user is authorized for key management services and if
protection of the SIP-1 and SIP-2 interfaces is required by the MCPTT service
provider, the KMS then distributes the CEK to both the MCPTT client and MCPTT
server. The CEK is used to encrypt and decrypt the location object. A unique
CEK identifier (Key ID) is sent in the SIP MESSAGE MIME body as part of the
\ element to identify the CEK at the MCPTT Server.
Authorisation, creation and distribution of the Key is performed per subclause
7.13.1 and subclause 7.13.2.
The CEK remains in use until the MCPTT user logs off, or the KMSprovides a new
CEK to the MCPTT client. The KMS may push a new CEK to both the MCPTT client
and the MCPTT server.
If the MCPTT client or MCPTT server require an update of a CEK, The MCPTT
client or the MCPTT server may request the KMS to provide a CEK. The KMS will
determine if an update of the current CEK or a new CEK is required and
distributed.
### 7.16.2 Cryptographic Message Syntax (CMS)
The Cryptographic message syntax (CMS) defined in IETF RFC 5652 [33] is used
to digitally sign, digest, authenticate and encrypt the MCPTT location object.
The Data, SignedData and EnvelopedData content types are used for securing the
MCPTT location object.
Figure 7.16.2-1 CMS Content types
\- Data content type is used to identity the signed or encrypted message
content inside the SignedData or EnvelopedData content types.
\- SignedData is used to apply a digital signature to a message:
1\. The Sender computes the message digest on the content with the digest
algorithm. The message digest is then digitally signed using the sender\'s
private key. The content, digital signature and the associated certificate
carrying sender\'s public key are stored in the \ element within
the \ element.
2\. The receiver computes the message digest from the received content and
verifies the signature with the signer\'s public key. The sender\'s public key
is fetched from the certificate carried in the \ element.
\- EnvelopedData: used to apply data confidentiality to a message. It consists
of the encrypted content and the encrypted content-encryption key (CEK).
1\. The sender encrypts the content with a randomly generated content-
encryption key. The CEK is encrypted with the shared symmetric Key Encryption
Key (KEK).The encrypted CEK along with the encrypted content is packed into a
\ element and sent to the recipient.
2\. The recipient decrypts the encrypted CEK and then decrypts the encrypted
content with the recovered CEK.
### 7.16.3 MCPTT client signing and encrypting the location object
The following is a sequence of steps taken by the MCPTT client to protect the
MCPTT location object:
1\. The MCPTT client randomly generates a content-encryption key (CEK) and
uses it to encrypt the MCPTT location object;
2\. The CEK is encrypted with the MCPTT server\'s public key;
3\. The encrypted location object along with the encrypted CEK is packed to
form an EnvelopedData CMS object;
4\. The message digest is computed on the EnvelopedData CMS object;
5\. The digest is digitally signed by the MCPTT client using its private key;
6\. The signature, MCPTT client\'s certificate chain and EnvelopedData CMS
object are collected to form a SignedData CMS object;
7 The SignedData is wrapped in a \ element within the
\ element.
Figure 7.16.3-1: MCPTT client encrypting and signing MCPTT location object
with a symmetric key
### 7.16.4 MCPTT server retrieving the location object
The MCPTT server does the following when it receives a SIP message with a
protected MCPTT location object:
1\. It computes the message digest on the encapsulated EnvelopedData object
present in the SignedData object;
2\. The message digest and the MCPTT client\'s public key are used to verify
the signature. The client\'s public key is obtained from the certificate
obtained from the SignedData;
3\. Once the signature is verified, the server opens the EnvelopedData object
to obtain the encrypted CEK. The encrypted CEK is decrypted with its private
key
4\. The recovered content-encryption key is used to decrypt the encrypted
MCPTT location object.
Figure 7.16.4-1: MCPTT Server retrieving the MCPTT location object
## 7.17 Solution #17: Protection of sensitive application data based on xmlsec
### 7.17.1 General
Certain values and identifiers transferred in the signalling plane between the
server in the MCPTT domain and MCPTT client may be treated as sensitive by
public safety users. To protect these values from all other entities outside
of the MCPTT Domain, this clause defines an optional mechanism to provide
confidentiality protection on these values using XML encryption. Additionally,
as some public safety users may require integrity protection on transmitted
content, this clause defines an optional mechanism to provide integrity
protection using XML signatures.
NOTE 1: The protection mechanism specified in this section is for public-
safety use only.
NOTE 2: The introduction of XML security mechanisms increases the size of the
XML document. Consideration should be given to the impact of this size
increase.
NOTE 3: Virtual proxy techniques may need to be extended to control use of
MCPTT encryption in VPLMN roaming scenarios.
### 7.17.2 Protected content
Confidentiality protection may only be applied to the following identifiers
and values:
\- MCPTT ID
\- MCPTT Group ID
\- User location information
\- Alerts
\- Access token
Integrity protection may be applied to the entire XML document.
### 7.17.3 Key agreement
The protection mechanisms defined rely on a shared XML Protection Key (XPK) to
be able to encrypt and sign XML.
For connections between the MCPTT Client and the MCPTT Domain the XPK is a
shared key between the server in the MCPTT domain and the MCPTT UE. The XPK-ID
is the identifier for this key.
For connections between servers inside and across MCPTT Domains the XPK is a
pre-provisioned shared key. The XPK-ID is the identifier for this key.
The integrity key and confidentiality key for application data protection are
derived from the XPK as defined in clause 7.17.5. The XPK-ID may be listed in
the XML to aid decryption.
### 7.17.3 Confidentiality protection using XML encryption (xmlenc)
This clause defines an optional mechanism to allow specific XML content to be
encrypted between the MCPTT Server and MCPTT UE. XML content is encrypted as
defined by XML Encryption Syntax, Version 1.1 [34].
NOTE: Only encryption of XML simple content is supported. Encryption of XML
tags, attributes and elements is not supported.
To encrypt content within a specific XML element, the content is replaced with
the \ element. The \ element contains a
\ element, containing a \ element containing the
encrypted content. Encryption is performed as defined in [34] using the CSK as
the cipher key.
The \ element may:
\- Use the \'Type\' attribute specifying that content is encrypted
(\'http://www.w3.org/2001/04/xmlenc#Content\'). The \ element
may.
\- Contain \\ element containing the base64 encoded XPK-ID.
\- Contain \ element listing the encryption algorithm used
for encrypting the XML content. The AES-128-GCM algorithmis supported, as
identified by the algorithm identifier:
\'http://www.w3.org/2009/xmlenc11#aes128-gcm\'.
Where these elements do not occur, the information they contain is known to
both the server in the MCPTT domain and the MCPTT UE through other means.
The following is an example of unprotected XML content:
EXAMPLE:
\
sensitive.data\@example.org
\
When XML encryption is applied, the following is an example of the encrypted
content:
EXAMPLE:
\
\
\
\
\base64XpkId\
\
\
\A23B45C56\
\
\
\
### 7.17.4 Integrity protection using XML signature (xmlsig)
Where integrity protection is required, an XML HMAC signature may be applied
using the XPK to key the HMAC. The XML Signature syntax is defined by W3C in
[35]. This specifies how signatures are created and applied to XML. The XML
contains a \ element which signs the elements requiring integrity
protection. Within this element a \ element contains the HMAC
signature of the content.
The \ element may contain:
\- \ element listing an appropriate algorithm.
\- \ element listing an appropriate algorithm. HMAC-SHA256 is
supported for signatures.
\- \ element containing a URI identifying the content to be signed
and the method for hashing the content. SHA-256 is supported for hashing
content.
\- \\ element containing the base64 encoded XPK-ID.
Where these elements do not occur, the information they contain is known to
both the server in the MCPTT domain and the MCPTT UE through other means.
The following provides an example of an XML signature added to a generic XML
document.
EXAMPLE:
> \
>
> \
>
> ...
>
> \
>
> \
>
> \
>
> \ xml-c14n-20010315\"/>
>
> \ sha256\">
>
> \128\
>
> \
>
> \
>
> \
>
> \nnnn\
>
> \
>
> \
>
> \DEADBEEF\
>
> \
>
> \base64XpkId\
>
> \
>
> \
>
> \
### 7.17.5 Calculation of keys for application data protection
The two 128 bit keys used to protect either signalling plane confidentiality
or signalling plane integrity are derived from the 128 bit XPK, using the KDF
that is specified in Annex B of TS 33.220 [34]
The following parametersare used to form the input S to the KDF that is
specified in Annex B of TS 33.220 [34]. The key used by the KDF is the XPK:
> \- FC = 0x??, depending on the key usage (signalling plane confidentiality
> or signalling plane integrity)
>
> \- P0 = MCPTT ID
>
> \- L0 = length of above, expressed in number of bytes (i.e. 0x00 0x17).
>
> \- P1 = XPK-ID
>
> \- L1 = length of above, expressed in number of bytes (i.e. 0x00 0x17).
The MCPTT ID and XPK-ID follow the encoding also specified in Annex B of TS
33.220 [34].
The 128 least significant bits of the 256 bits of the KDF output are used as
the signalling protection key.
# 8 Evaluation of solutions
## 8.1 Signaling protection and IMS authentication
### 8.1.0 Introduction
Signalling protection applies to both the signalling layer and application
layer.
At the signalling layer, solution #1 in clause 7.1 reuses existing IMS
security mechanisms for MCPTT UE authentication and also to protect signaling
messages. Hence, no evaluation needs to be performed, as this solution have no
system impacts.
At the application layer, solution #12 to #17 require evaluation.
### 8.1.0a Potential requirements relating to application layer security
The security analysis conducted in clause 6 established a number of
requirements which impact application layer security. The relevant
requirements are listed below:
\- The MCPTT Service shall provide a means to ensure integrity of all MCPTT
user signalling at the application layer.
\- The MCPTT Service shall protect the administrative and security management
parameters from manipulation by individuals who are not explicitly authorized
by the Mission Critical Organization.
\- The MCPTT service shall provide a means to support confidentiality of MCPTT
user identities from all entities outside the MCPTT service.
\- The MCPTT service shall provide a means to support confidentiality of MCPTT
signalling from all entities outside the MCPTT service.
\- The MCPTT Service shall provide a means to support the confidentiality and
integrity protection of location information transmitted from the MCPTT UE to
the MCPTT application server.
\- The MCPTT identities of each plane shall be used within the corresponding
plane and concealed to other planes.
\- When required by the MCPTT Service provider, MCPTT application services
layer identities (such as the Mission Critical user identity, MCPTT-ID and
MCPTT Group ID) and other application services sensitive information (as
further described in 3GPP TS 23.179 [2], clause 8.1), shall be contained
within the application plane and shall provide a means to support
confidentiality and integrity of the application plane from the SIP signaling
plane.
### 8.1.1 S/MIME CEK Key management
There are two solutions that provide adequate and secure key management of the
Content Encryption Key used to protect SIP MIME contents on the SIP-1 and
SIP-2 interfaces. One is Solution #14 \"Identity Based Cryptography Managed
Content Encryption Key for S/MIME\" and the second is Solution #13 \"KMS
Managed Content Encryption Key for S/MIME\".
Solution #14 leverages the proposed media protection method of Identity Based
Cryptography where only the endpoints (the MCPTT client and the MCPTT
application server) have knowledge of the content encryption key and there is
no reliance on the KMS for key generation and distribution. This solution does
however require special message processing by the server during the initial
transfer of the CEK to the server where decryption of the CEK needs to be
performed before message authentication is validated.
Solution #13 provides straight forward key distribution from the KMS to the
MCPTT client and from the KMS to the MCPTT application server. The KMS
controls the creation and key management of the CEK which may defend against
spoofing attempts to distribute a false CEK. The KMS already controls the
creation and management of other keys (group keys for media protection, for
instance). This solution does not require special processing of key management
messages as in Solution #14 (i.e. decryption before message authentication),
however additional key management operations may be needed (UPDATE, PUSH,
PULL) to maintain concurrency and synchronization of the CEK with the client
and server endpoints.
While Solution #14 does maintain secrecy of the CEK between SIP endpoints,
solution #13 is a more straight-forward key management design and does not
require special processing of any SIP messages. The KMS is designed for key
distribution and already provides for group media key distribution. Therefore
it is recommended that solution #13 be chosen for S/MIME CEK key management.
### 8.1.2 Evaluation of sensitive application signalling
Solution #12, #13, #15, #16 and #17 are the proposed methods for protecting
sensitive application signalling sent in XML between the MCPTT UE and MCPTT
Server. To summarise the proposals:
\- Solution #12 defines how to use S/MIME to protect sensitive application
signalling.
\- Solution #13 defines how perform key management to support solution #12 as
discussed in clause 8.1.2.
\- Solution #15 defines how to use content indirection to protect sensitive
identities.
\- Solution #16 defines how to use Content Message Syntax (CMS) to protect
locations in support of solution #15.
\- Solution #17 defines how to use xmlsec to protect sensitive application
signalling.
Solution #12 provides a standard method for protecting the entire XML body.
However, it is not straightforward to apply S/MIME to protect individual XML
fields.
Solution #15 does not require complex key management, but may require MCPTT
UEs to perform HTTP requests as part of signalling flows. Solution #16 is also
required for protecting locations.
Solution #17 provides a flexible method for application signalling protection,
allowing the entire XML body to be protected or individual XML element
content. Content indirection is also supported by xmlsec should this be
required. As a result, all requirements in clause 8.1.1 can be met.
All solutions need to ensure that SIP core operators are able to meet
regulatory obligations. To this end, protection of application layer
signalling has been restricted to public safety use only and to individual
element content.
As solution #17 is able to meet all requirements to protect sensitive
application signalling, and is able to protect individual XML element content,
this solution is agreed to be the method for protecting sensitive application
signalling within MCPTT.
## 8.2 MCPTT User authentication and authorisation
### 8.2.1 Introduction
As required by the MCPTT service, authentication and authorisation of the user
must occur before the user is granted access to MCPTT services.
Figure 7.2-1 provides an overview of the steps needed to establish UE
connectivity, authenticate the user, and authorise the user for MCPTT
services. They are;
Step 0: Establish connectivity between an MCPTT UE and the network.
Step 1 and 2: Register and authenticate the MCPTT UE with the IMS/SIP core,
Step 3: Authenticate the MCPTT user.
Steps 3.5 and 4: Use the result of the user authentication step to authorise
the user with the MCPTT services.
The User Authentication procedure in Step 3 of Figure 7.2-1 is further
detailed into 3 sub steps that comprise the MCPTT user authentication
framework:
3(a) -- Establish a secure tunnel between the MCPTT UE and Identity Management
(IdM) server (SA Establishment).
3(b) -- Perform the User Authentication Process (User proves their identity).
3(c) -- Deliver the unique credential to the MCPTT client.
Following step 3(c), the MCPTT client uses the credential(s) obtained from
step 3(c) to perform MCPTT service authorization as per procedure 4 in Figure
7.2-1.
NOTE: MCPTT service authorization in step 4 of Figure 7.2-1 is outside the
scope of the User Authentication framework.
### 8.2.2 MCPTT requirements relating to user authentication and authorisation
The security analysis conducted in clause 6 derived a number of requirements
directly related to user authentication and authorisation. Relevant
requirements are listed here:
\- [33.179 MCPTT-A.1-002] The MCPTT User and the MCPTT Service shall mutually
authenticate each other prior to providing the MCPTT UE with the MCPTT User
profile and access to user-specific services.
\- [33.179 MCPTT-A.3-001] All users of the MCPTT service shall be
authenticated to prevent an adversary impersonating a user for the purpose of
denial of service.
\- [33.179 MCPTT-A.3-003] The MCPTT user shall be authenticated by the MCPTT
application.
The solution for user authentication and authorisation described in the
present document shall satisfy the following requirements:
Interoperability between different networks and different manufacturers\'
clients and servers
\- Satisfy requirements for MCPTT roaming and migration
Flexibility in deployment models (see TS 23.179 [2])
\- Support all deployment models listed in TS 23.179 [2]
Support for interchangeable MCPTT user authentication solutions
\- Allow implementations to use different means to authenticate the user, e.g.
Web SSO, SIP digest, GBA, biometric identifiers, username+password.
Scalability (number of users)
\- Provide efficient support for small MCPTT systems with few users, to large
MCPTT systems with hundreds of thousands of users.
Extensibility
\- Be extensible to provide authorisation for further mission critical
services including group aware services, additional interfaces etc.
### 8.2.3 Evaluation of user authentication and authorisation solutions
Proposed solutions for user authentication and authorisation are specificed in
Solution #1 and Solution #2.
The combination of Solution #1 (clause 7.1.3 only) and Solution #2 together
form a complete architecture for user authentication and authorisation for
MCPTT.
Solution #1 (clause 7.1.3) provides an overview of the major steps for user
authentication, IMS/SIP registration/authentication, and user authorisation.
Solution #2 expands on the general user authentication and authorisation
concept outlined in Solution #1 clause 7.1.3, and proposes the following;
\- For user authentication, OpenID Connect 1.0 is used as the identity
management protocol between the MCPTT UE IdM client and the MCPTT IdM server.
\- For IMS/SIP authentication and registration, TS 33.203 [9] is applied.
\- For user authorisation, the access token obtained during user
authentication is presented to the MCPTT network entities (MCPTT server, KMS,
GMS and CMS) to gain access to MCPTT services.
There are no other solutions proposed for user authentication and user
authorisation.
## 8.3 Group call key distribution solutions
### 8.3.1 General
Group call functionality is described in from clause 10.4 to clause 10.8 of TS
23.179 [10]. It involves both on-network and off-network functionality to
setup calls between groups of MCPTT UEs.
Within this document there is one solution, Solution #4, for performing key
distribution to support group calls.
### 8.3.2 Potential requirements relating to group call security
The security analysis conducted in clause 6 established a number of
requirements which impact group calls. The relevant requirements are listed
below and serve as a guideline for future normative work:
KI#2: Group key material shall be integrity and confidentiality protected for
a specific MCPTT User during distribution from the MCPTT service to MCPTT UEs.
KI#2: Group key material shall be authenticated as coming from a valid,
authorised source. The authorised source may be an MCPTT Administrator or may
be another authorised entity (e.g. an authorised MCPTT User or Dispatcher).
KI#2: It shall be possible for authorised entities to dynamically create and
distribute a new group security context at any time. This may be as part of a
group creation process, be due to a periodic update to maintain key freshness,
or due to compromise of group key material.
KI#2: The creation of a new group security context (e.g. via User-Regroup
operation) shall not change or compromise an existing group security context.
KI#2: It shall be possible for an authorised, authenticated entity to revoke
and update a group security context from use.
KI#9: The MCPTT Service shall provide a means to support end-to-end security
for all media traffic transmitted between MCPTT UEs.
KI#10: The MCPTT system shall ensure that key streams are not reused.
KI#11: An authorised MCPTT User shall be able to obtain the information
necessary to derive the group security context for the MCPTT Group while an
MCPTT Group communication is on-going. As a result, the MCPTT User shall be
able to listen to the group communication within 350ms. This requirement
applies for both on-network and off-network MCPTT operation.
KI#14: The MCPTT Service shall provide a means to support end-to-end security
for all media traffic transmitted between MCPTT UEs, including where relays
are used.
### 8.3.3 Evaluation of solution #4 against requirements
Table 8.3.3-1 compares the Solution #4 against the requirements relevant to
group calls. This demonstrates that the solution meets the requirements.
Table 8.3.3-1: Table evaluating group call key distribution solutions against
requirements
* * *
Requirement Sol #4 Group key material integrity and confidentiality protected
Yes Group key material authenticated Yes, to group management server identity
Supports dynamic provisioning Yes Group security contexts are independent Yes,
so long as separate GMK-IDs are used. Revoke and update possible Yes (On-
network) End-to-end security supported Yes, inclusion of MCPTT server within
group is optional, so true end-to-end security is possible. Key streams are
not reused. Yes, by ensuring every transmitting user uses separate key
derivation (with high probability). Late entry Yes, does not require
signalling prior to decrypting media (Off-network) End-to-end security
supported Yes, does not require connection to network during communication.
* * *
### 8.3.4 System impact evaluation
Solution #4 is unlikely to require modification to the SIP Core. The SIP Core
need only ensure that notification messages are successfully transmitted to
MCPTT clients.
The MCPTT Server will require modification to decrypt floor control traffic
and media plane traffic (if necessary). The solution would also require
modification in the MCPTT client application. Additionally, a KMS would need
to be introduced into the MCPTT architecture within the CSC.
Hence, system impacts are limited to MCPTT elements.
### 8.3.5 Summary of evaluation
Solution #4 is the only available solution which meets the security
requirements for group calls. Additionally, system impacts are limited to
MCPTT elements.
Hence inclusion of Solution #4 in the MCPTT TS is necessary to meet the
security requirements for group calls within MCPTT.
## 8.4 Private call key distribution solutions
### 8.4.1 General
Private call functionality is described in clause 10.9 of TS 23.179 [10]. It
involves both on-network and off-network functionality to setup calls between
MCPTT UEs.
Within this TR there are three solutions for performing key distribution of
private calls:
\- Solution #5 (IBE-based), described in clause 7.5.
\- Solution #6-1 (SDES), described in clause 7.6.2.
\- Solution #6-2 (KMS), described in clause 7.6.3.
Additionally, Solution #5 and Solution #6 (KMS) will require a KMS to be
introduced into the MCPTT architecture (e.g. Solution #3). To complete the
security solution, all these solutions will rely upon a mechanism for
protecting media (such as Solution #7) and floor control (such as Solution
#8).
### 8.4.2 Potential requirements relating to private call security
The security analysis conducted in clause 6 established a number of
requirements which impact private calls. The relevant requirements are
repeated below and serve as a guideline for future normative work:
KI#13: It shall be possible to establish a unique Private Call security
context between any pair of authorised MCPTT users within the MCPTT system.
The security context shall not be available to other MCPTT users, except,
where necessary, authorised MCPTT monitoring functions (e.g. LI, Discreet
Listening). If the security context is made available to monitoring functions,
appropriate controls and logging shall exist. This requirement applies when
MCPTT UEs are operating both on-network and off-network.
KI#13: The Private Call security context shall provide a means to provide
confidentiality and integrity protection of user traffic, and authenticate the
MCPTT users involved in the Private Call.
KI#10: The MCPTT system shall ensure that key streams are not reused.
KI#7: The MCPTT Service shall protect the administrative and security
management parameters from manipulation by individuals who are not explicitly
authorized by the Mission Critical Organization.
KI#9: (On-network) The MCPTT Service shall provide a means to support end-to-
end security for all media traffic transmitted between MCPTT UEs.
KI#14: (Off-network) The MCPTT Service shall provide a means to support end-
to-end security for all media traffic transmitted between MCPTT UEs, including
where relays are used.
KI#15: MCPTT off-network UEs shall be explicitly or implicitly authenticated
to each other.
Additionally, lower layers are not able to provide solutions to meet these
requirements. For example, ProSe security cannot provide end-to-end security
or user authentication when the MCPTT UE is operating off-network.
### 8.4.3 Evaluation of key distribution solutions against requirements
Table 8.4.3-1 compares the three options for key distribution against the
requirements relevant to private calls.
Table 8.4.3-1: Table evaluating private call key distribution solutions
against requirements
+----------------+----------------+----------------+----------------+ | Requirement | Sol #6-1 | Sol #6-2 | Sol #5 (IBE | | | (SDES) | (KMS) | based) | +----------------+----------------+----------------+----------------+ | Security | Yes | Yes | Yes | | context | | | | | established | | | | | between any | | | | | pair of users | | | | +----------------+----------------+----------------+----------------+ | Security | Yes | Yes | Yes | | context not | | | | | available to | | | | | other MCPTT | | | | | users | | | | +----------------+----------------+----------------+----------------+ | Possible for | Yes | Yes | Yes | | security | | | | | context to be | | | | | sharable with | | | | | authorised | | | | | MCPTT | | | | | monitoring | | | | | functions. | | | | +----------------+----------------+----------------+----------------+ | Key streams | Yes^1^ | Yes^1^ | Yes^1^ | | are not | | | | | reused. | | | | +----------------+----------------+----------------+----------------+ | Security | Manipulation | Yes | Yes | | management | of security | | | | parameters are | management | | | | protected from | parameters | | | | manipulation | (private call | | | | | keys) is | | | | | possible in | | | | | MCPTT server | | | +----------------+----------------+----------------+----------------+ | Available | Yes | Yes | Yes | | on-network | | | | +----------------+----------------+----------------+----------------+ | (On-network) | Yes | Yes | Yes | | The Private | | | | | Call security | | | | | context | | | | | provides | | | | | c | | | | | onfidentiality | | | | | of user | | | | | traffic | | | | +----------------+----------------+----------------+----------------+ | (On-network) | Yes^2^ | Yes^2^ | Yes^2^ | | The Private | | | | | Call security | | | | | context | | | | | provides | | | | | integrity of | | | | | user traffic | | | | +----------------+----------------+----------------+----------------+ | (On-network) | Implicit | Based on | Yes | | The Private | authentication | current | | | Call security | only (though | standards only | | | context | authenticated | authentication | | | provides | use of MCPTT | of MCPTT UE is | | | authentication | Server). | possible. | | | of MCPTT User | | | | +----------------+----------------+----------------+----------------+ | Available | Yes | No | Yes | | off-network | | | | +----------------+----------------+----------------+----------------+ | (Off-network) | Requires a | N/A | Yes | | The Private | UE-to-UE | | | | Call security | signalling | | | | context | channel with | | | | provides | c | | | | c | onfidentiality | | | | onfidentiality | protection. | | | | of user | | | | | traffic | | | | +----------------+----------------+----------------+----------------+ | (Off-network) | Requires a | N/A | Yes^2^ | | The Private | UE-to-UE | | | | Call security | signalling | | | | context | channel with | | | | provides | integrity | | | | integrity of | protection. | | | | user traffic | | | | +----------------+----------------+----------------+----------------+ | (Off-network) | Requires an | N/A | Yes | | The Private | authenticated | | | | Call security | UE-to-UE | | | | context | signalling | | | | provides | channel. | | | | authentication | | | | | of MCPTT User | | | | +----------------+----------------+----------------+----------------+ | NOTE 1: | | | | | Security | | | | | context | | | | | limited to | | | | | single call | | | | | hence will not | | | | | be reused. | | | | | | | | | | NOTE 2: Only | | | | | if media | | | | | stream | | | | | protection | | | | | provides | | | | | integrity | | | | | protection. | | | | | For example, | | | | | SRTP can | | | | | provide | | | | | integrity | | | | | protection | | | | | through the | | | | | use of the | | | | | AEAD\ | | | | | _AES_128_GCM | | | | | algorithm. | | | | +----------------+----------------+----------------+----------------+
Solution #6-1 (SDES) meets the majority of on-network requirements. It is
reliant on the MCPTT Server to provide implicit authentication and to ensure
modification of private call keys is not allowed, which may not be acceptable
to some user groups. To be used off-network the solution requires a secure
signalling channel between UEs, which has not been defined.
Solution #6-2 (KMS) meets all on-network requirements for private calls,
except that it is currently defined to authenticate based on MCPTT UE, rather
than MCPTT user. The solution is not able to be used off-network as it
requires an active connection to the KMS.
Solution #5 (IBE-based) meets all on-network and off-network security
requirements.
All solutions require that the media stream protection solution provides
confidentiality and integrity protection.
### 8.4.4 System impact evaluation
The solutions should have minimal impact on the MCPTT Server. The MCPTT Server
need only ensure that SDP attributes are successfully passed between the
clients.
None of the solutions should require modification to the SIP Core. The SIP
Core need only ensure that SDP attributes are successfully passed between the
clients.
All three solutions would require modification in the MCPTT client
application.
Solution #6-2 (KMS) and Solution #5 (IBE) require a KMS to be introduced into
the MCPTT architecture. Solution #6-1 (SDES) requires no additional elements.
### 8.4.5 Summary of evaluation
Solution #5 (IBE-based) solution meets all the security requirements for
private calls within an MCPTT system. It is the only available solution which
is able to meet the requirement within Key Issue #14 to provide end-to-end
security while the MCPTT UE is operating off-network.
Additionally, lower layers are not able to provide solutions to secure off-
network calls. For example, ProSe does not provide end-to-end security and UE-
to-UE authentication when the UEs are communicating using a UE-to-UE relay.
Hence inclusion of Solution #5 is necessary to meet the security requirements
for private calls within MCPTT.
## 8.5 Media and floor control protection
### 8.5.1 General
Media protection is required to provide confidentiality and integrity of MCPTT
user traffic. TS 24.379 states that media is transmitted using RTP. The
present document contains a single solution for protecting RTP within Solution
7. This describes that SRTP is used, making use of the Master Key Identifier
(MKI) field where required. Additionally, Solution 6 references TS 33.328
which also indicates use of SRTP.
Floor control protection is required to provide confidentiality and integrity
of MCPTT floor control signalling. TS 24.379 states that media is transmitted
using MBCP or TBCP, both of which make use of RTCP. The present document
contains a single solution for protecting RTCP within Solution 7. This
describes that SRTCP is used, making use of the Master Key Identifier (MKI)
field where required. Additionally, Solution 6 references TS 33.328 [12] which
also indicates use of SRTCP to protect the RTCP protocol.
### 8.5.2 Potential sequirements relating to media and floor control
The security analysis conducted in clause 6 established a number of
requirements which impact the protection of media and floor control. The
relevant requirements are listed below and serve as a guideline for future
normative work:
KI#7: The MCPTT Service shall provide a means to ensure integrity of all MCPTT
user signalling at the application layer.
KI#8: The MCPTT service shall provide a means to support confidentiality of
MCPTT signalling from all entities outside the MCPTT service.
KI#9: The MCPTT Service shall provide a means to support end-to-end security
for all media traffic transmitted between MCPTT UEs.
KI#10: The MCPTT system shall ensure that key streams are not reused.
KI#11: An authorised MCPTT User shall be able to obtain the information
necessary to derive the group security context for the MCPTT Group while an
MCPTT Group communication is on-going. As a result, the MCPTT User shall be
able to listen to the group communication within 350ms. This requirement
applies for both on-network and off-network MCPTT operation.
KI#12: The Private Call security context shall provide a means to provide
confidentiality and integrity protection of user traffic, and authenticate the
MCPTT users involved in the Private Call.
KI#16: The MCPTT Service shall provide a means to ensure integrity of all
MCPTT user signalling at the application layer.
KI#17: The MCPTT service shall provide a means to support confidentiality of
MCPTT signalling from all entities outside the MCPTT service.
Additionally, lower layers are not able to meet these requirements. The
requirements require that protection is at the application layer.
In conjunction with an effective key management solution, all solutions can
meet these requirements where integrity protection is provided by SRTP.
### 8.5.3 Comparison of solutions
It is noted that both Solution #7, Solution #8 and the SRTP/SRTCP profiles
within TS 33.328 [12] are all very similar proposals. A comparison of
differences is below:
\- MKI: Solution #7 and Solution #8 require that the MKI field is mandatory to
support. TS 33.328 implies that MKI is optional to support.
\- Security Context: Solution #7 and Solution #8 allow the option for SRTP and
SRTCP to have different key hierarchies and security contexts. TS 33.328 does
not consider this possibility.
\- SRTP/SRTCP Profile: TS 33.328 defines algorithm profiles, which are not
discussed by Solution #7 or Solution #8.
As a result, other than the choice of algorithm, Solution #7 and Solution #8
can be used in a way that is compatible with the previously defined media and
floor protection mechanisms in TS 33.328. As a consequence, Solution #7 and
Solution #8 are compatible with all the proposed key distribution mechanisms
for MCPTT.
### 8.5.4 Choice of algorithm
TS 33.328 [12] contains a number of mandatory to support algorithms:
UNENCRYPTED_SRTP, UNENCRYPTED_SRTCP, UNAUTHENTICATED_SRTP, AES_CM_128,
AES_CM_128_HMAC_SHA1_80. Of these, only AES_CM_128_HMAC_SHA1_80 provides
integrity and confidentiality protection. However, as this choice uses SHA1
for authentication, it is not an ideal choice for use within MCPTT.
The IETF are standardising the AEAD_AES_128_GCM algorithm for SRTP and SRTCP
[28]. This algorithm provides 128-bits of confidentiality and integrity
protection and hence meets the requirements for securing media and floor
control.
### 8.5.5 Summary of evaluation
Solution #7 and Solution #8 in conjunction with the AEAD_AES_128_GCM algorithm
meets all the requirements for securing media and floor control traffic for
MCPTT.
These two proposals are compatible with all the proposed key management
solutions (Solution #4, #5, #6-1, #6-2) as well as the existing media
protection mechanisms described in TS 33.328 [12].
A new SRTP/SRTCP profile will need to be defined which makes the
AEAD_AES_128_GCM algorithm mandatory to support.
# 9 Conclusion
## 9.1 Signaling protection and IMS authentication
### 9.1.0 Introduction
For IMS authentication (step B) and signaling protection, solution 1 in clause
7.1 is adopted as the basis for the normative work, which is in line with the
conclusions in TS 23.179 [10].
### 9.1.1 S/MIME CEK key management
If S/MIME is chosen, then for S/MIME CEK key management based on the
evaluation in clause 8.1.1, solution #13 is chosen as the key management
method for the S/MIME Content Encryption Key used to protect the SIP MIME
contents.
### 9.1.2 Sensitive application signalling protection
Based on the analysis in clause 8.1, xmlsec as defined in solution #17, is
chosen to provide protection for sensitive application plane signalling.
## 9.2 MCPTT User authentication and registration
Based on the evaluation in clause 8.2, the proposed combination of Solution #1
(clause 7.1.3) and Solution #2 is adopted as the user authentication and
authorisation solution for MCPTT.
## 9.3 Group call key distribution solutions
Based on the evaluation in clause 8.3, solution #4 is adopted as a group call
key distribution mechanism for MCPTT. As solution #4 requires solution #3 to
operate, Solution #3 is also adopted as an addition to the MCPTT architecture.
## 9.4 Private call key distribution solutions
Based on the evaluation in clause 8.4, solution #5 is adopted as a private
call key distribution mechanism for MCPTT. As solution #5 requires solution #3
to operate, solution #3 is also adopted as an addition to the MCPTT
architecture.
## 9.5 Media and floor control protection
Based on the evaluation in clause 8.5, solution #7 and solution #8 are adopted
to protect media and floor control for MCPTT, with the AEAD_AES_128_GCM
algorithm mandatory to support.
###### ### Annex A: Authentication call-flows
# A.1 MCPTT service authentication call-flow example-1
As example the call flow for MCPTT service authentication is shown in Figure
A.1 (related to Solution#1 clause 7.1). This example illustrates an IMS AKA
authentication for MCPTT UE authentication between the MCPTT UE and the IMS CN
(over SIP-1 interface) and followed by SIP Digest authentication for MCPTT
user authentication between the MCPTT Client application and the MCPTT Server
(over MCPTT-1 interface).
Figure A.1-1: Illustrated flow for MCPTT Service authentication
Step 1 to 12 illustrates MCPTT UE authentication procedure using IMS AKA. IMS
AKA procedure is performed as mentioned in TS 33.203 [9].
Step 14 to 15 is third part registration procedure as specified in TS 23.228
[23], performed between the IMS Core and the MCPTT Server after successful IMS
authentication procedure.
Step 16 to 31 illustrates MCPTT user authentication procedure, performed using
Non-registration Messages between the UE and the MCPTT Server. SIP digest
mechanism as specified in TS 33.203 [9] (clause N.2.1.2) is used and S-CSCF
functions specified in TS 33.203 are performed by the MCPTT server. If the
authentication is successful, the MCPTT server flags/marks that the MCPTT user
ID is authenticated. For further messages after successful authentication, the
MCPTT server checks whether the user identity is authenticated or not, before
processing the message.
## A.2 MCPTT service authentication call-flow example-2
As example the call flow for MCPTT service authentication is shown in Figure
A.2 (related to Solution#1 (clause 7.1)). This example illustrates an IMS AKA
authentication for MCPTT UE authentication between the MCPTT UE and the IMS CN
(over SIP-1 interface) and token based authentication for MCPTT user
authentication between the MCPTT Client application and the MCPTT Server (over
MCPTT-1 interface).
Figure A.2-1: Illustrated flow for MCPTT Service authentication
> Step1. The user powers-on the UE, the UE performs LTE attach (& LTE
> authentication) and obtains the IP connectivity.
>
> Step2. The user enables the MCPTT client. The MCPTT client accesses a URI to
> the Identity Management function to initiate an HTTPS connection to the
> Identity Management function. The TLS connection provides one-way
> authentication of the server based on the server certificate. The HTTP-1
> interface is used between the MCPTT Client and the Identity Management
> server.
>
> Step3. The MCPTT client begins the user authorization procedure by sending
> an Authentication Request (IMPU, MCPTT user identity, user credentials)
> message to the Identity Management function. The IMPU is taken from the ISIM
> in the UE. The MCPTT user identity may be obtained from the user input or
> via other methods. The user provides the MCPTT user authentication
> credentials (e.g. biometrics, password, etc.) for verification with the
> Identity Management function.
>
> The Identity Management function authenticates user using the MCPTT user
> identity and MCPTT user authentication credentials. If the authentication is
> successful, the Identity Management function generates Token based on the
> IMPU and the MCPTT user identity. The token is encoded with the associated
> authorization information, including the MCPTT user identity and IMPU
> assigned to the user and the authorization token scope.
>
> The Identity Management function responds with an Authentication Response
> (Token) message.
NOTE: In the present 3GPP release the token format and verification procedure
is left out of scope.
> Step4. The UE initiates IMS registration procedure and use IMS AKA for
> signalling plane authentication. IMS AKA run is performed as mentioned in TS
> 33.203 [9]. In addition, the UE includes the MCPTT user identity and Token
> for MCPTT user authentication.
>
> Step5. The S-CSCF acknowledges with an OK message and the message is
> forwarded to the client.
>
> Step6. If the IMS AKA is successful, the S-CSCF performs the 3^rd^ party
> registration with the MCPTT server. The S-CSCF sends a Register (IMPU, MCPTT
> user identity, Token) message to the server. The server verifies the token.
> If the token is valid, the MCPTT server trust the MCPTT user identified by
> the MCPTT user ID is a valid user and checks if the IMPU and MCPTT user
> identity derived from the token coincide with the IMPU and MCPTT user
> identity in the Register message from the S-CSCF. If the check is
> successful, the server stores the relationship between the IMPU and the
> MCPTT user identity.
>
> The server acknowledges with an OK message.
#