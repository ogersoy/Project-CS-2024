# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document contains a study on security issues following the
potential modifications of the IMS architecture and stage 2 procedures as
required by the support of eWebRTCi (Enhancements to WEBRTC interoperability).
In particular, the present document focuses on:
  * Support for end to end WebRTC security, subject to regulatory constraints, that avoids conversion between WebRTC and IMS security protocols , including the feasibility of end to end security aspects
  * Third-party WebRTC access in the case where the 3^rd^ party allocates IMS identities from a block where the associated subscription corresponds to a class of users supported by the WebRTC environment (e.g., enterprise associates) rather than a single end user
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 41.001: \"GSM Release specifications\".
[3] 3GPP TR 21 912 (V3.1.0): \"Example 2, using fixed text\".
[4] https://tools.ietf.org/html/rfc5766: Traversal Using Relays around NAT
(TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)
[5] http://tools.ietf.org/html/rfc5389: Session Traversal Utilities for NAT
(STUN)
[6] http://tools.ietf.org/html/rfc7376: Problems with Session Traversal
Utilities for NAT (STUN) Long-Term Authentication for Traversal Using Relays
around NAT (TURN)
[7] https://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-01: OAuth
2.0 Proof-of-Possesson (PoP) Security Architecture
[8] https://tools.ietf.org/html/draft-ietf-oauth-pop-key-distribution-01:
OAuth 2.0 Proof-of-Possession: Authorization Server to Client Key Distribution
[9] https://tools.ietf.org/html/draft-ietf-tram-turn-third-party-authz-13:
Session Traversal Utilities for NAT (STUN) Extension for Third Party
Authorization
[10] 3GPP TS 33.328: "IP Multimedia (IMS) media plane security".
> [11] 3GPP TS 23.228: "IP Multimedia Subsystem (IMS)"
>
> [12] 3GPP TS 33.203: "Access security for IP-based services"
[13] 3GPP TS 23.334: "IP Multimedia Subsystem (IMS) Application Level Gateway
(IMS-ALG) - IMS Access Gateway (IMS-AGW) interface: Procedures descriptions"
**[14] 3GPP TS 33.871: "** Study on security for Web Real Time Communications
(WebRTC) IP Multimedia Subsystem (IMS) client access to IMS" **(Release 12)**
**[15]** 3GPP TR **23.706: "TR on Architectural enhancements to support webRTC
interworking"**
> **[16]** 3GPP TR 33.871: "Study on security for Web Real Time Communications
> (WebRTC) IP Multimedia Subsystem (IMS) client access to IMS"
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply.\ A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**example:** text used to clarify abstract rules by applying them literally.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
# 4 Overview
The present document builds on normative work specified in TS 33.203 Annex X
[12] and succeeds the study carried out in TR 33.871 [16]. The SA2
architecture defined in TR 23.706 [15] is used in the present document.
# 5 Assumptions and potential security requirements
## 5.1 Potential security requirements
The WIC shall be authenticated and authorized by TURN server, in the case of
ICE/TURN solution is used for NAT/Firewall traversal.
# 6 Solutions
## 6.1 Solutions to support for end to end WebRTC security that avoids
conversion between WebRTC and IMS security protocols
According to SA1, end to end (e2e) security for WebRTC can be fulfilled either
by hop-by-hop encryption or e2e encryption.
When hop-by-hop encryption is used, then the security solution specified in TS
33.328 [10] applies. **Strict e2e** does not fulfil LI requirements. Thus, the
only possible security solution for cases where LI requirements do apply is
hop-by-hop encryption.
**Consequently, strict e2e encryption can only be used when LI requirements do
not apply. It is still unclear in SA3 which aspects of e2e security solutions
for such cases are in the scope of 3GPP. The estimated amount of work on this
issue will not allow SA3 to be able to complete e2e security where LI
requirements do not apply for WebRTC in Release 13.**
**For any IMS based WebRTC services which have LI requirements based on LI
national regulations, hop-by-hop encryption allows an operator to meet those
LI obligations. For any IMS based WebRTC services which do not have LI
requirements based on national LI regulations, then e2e encryption may also be
deployed.**
Editor\'s Note: SA3 was not able to determine the following points on e2e
encryption in the Release 13 timeframe: what aspects of specifying e2e
encryption are in scope of 3GPP; what is the appropriate level of detail to
specify the potential in scope aspects; and specifying the in scope aspects if
any.
## 6.2 Solutions to support registration of WebRTC IMS Client using IMPU
assigned from wildcarded IMPU
To fulfil the requirement of supporting scenarios where a class of IMS
subscribers is managed by a 3^rd^ party, SA2 defined an enhancement to the
existing solution defined in TS 23.228 [11] Annex U.2.1.4 where the WWSF holds
a pool of IMS identities. In the enhancement, the IMS operator provides the
WWSF with an unbounded number of IMPU/IMPI pairs to be allocated to WIC users.
The enhancement resembles the existing solution from a security point of view.
In both cases a 3^rd^ party assigns IMS identities to users after agreement
with the operator, either in a specific range (unbounded), respectively from a
specific pool. The 3^rd^ party is the actual subscriber and the users might be
authenticated by the 3^rd^ party (e.g. web authentication) if needed.
The current security solution 3.1 described in TS 33.203 [12] Annex X.4.2 uses
TNA (as defined in TS 33. 203 Annex U) to authenticate WICs to the IMS. Since
the SA2 enhancement for offering an unbounded number of users to a 3^rd^ party
resembles the existing solution security wise, solution 3.1 can also be used
in the extended case. Thus, no new security solution is required in Rel-13.
## 6.3 Candidate solutions for TURN credential provisioning and authentication
### 6.3.1 General
TURN RFC 5766 [4] specifies that TURN servers and clients MUST implement
"Long-Term Credential Mechanism" as specified in clause 10.2 of RFC 5389 [5].
In this mechanism, the client and server share a pre-provisioned username and
password that remains in the system till the user is using the system.The TURN
server uses these credentials to authenticate the client by performing digest
challenge/response.
In IMS_WebRTC, the browser plays the role of a TURN client. The WIC (i.e. the
Javascript code) controls the execution of the browser via the W3C defined
RTCPeerConnection API. Through this API, the WIC provides TURN credentials to
the browser. These credentials should therefore be made available to the WIC.
There are two known gaps that need to be addressed before TURN can be used in
IMS_WebRTC:
1\. At present, the provisioning of TURN long-term credentials in the WIC is
un-defined.
2\. Moreover, as indicated in RFC 7376 [6], ensuring secrecy of these
credentials in a web-based application such as the WIC is typically
impossible. Once these credentials are exposed to a Javascript script, it
could lead to various security issues such as leak of the credentials, privacy
leakage etc.
A solution is needed to dynamically configure the TURN credentials in the WIC
while ensuring that security gaps identified by RFC 7376 [6] are addressed.
### 6.3.2 TURN credential provisioning and authentication using OAuth Access
tokens
#### 6.3.2.1 General
The reference paper draft-ietf-tram-turn-third-party-authz-13 [9] proposes a
new mechanism for TURN client authentication authorization mechanism different
from the current long-term credential solution. In this solution, the TURN
client uses OAuth to obtain an ephemeral self-contained token and the
associated secret session key from the authorization server. The token is
presented to the TURN server instead of username/password credentials. The
server validates the authenticity of the token and provides required services.
In addition, the secret key is used by the client to prove Proof-of-Possesion
to the server and to integrity protect the connection between TURN client and
TURN server.
The following are the salient features of the proposed mechanism in the IETF
draft [9]:
1\. It is based on OAuth 2.0 Proof-of-Possession (PoP) Security Architecture
[7] and OAuth 2.0 Proof-of-Possesion: AS to Client Key Distrubution [8]
2\. Authorization server (WAF) and TURN server share a long-term secret K.
From this, two additional keys are derived:
a) AS-RS key: used to encrypt the token
b) AUTH key: used to ensure message integrity of the TURN messages
3\. It introduces two new TURN attributes:
a) ACCESS-TOKEN: used by the TURN client to forward the access token to the
TURN server
b) THIRD-PARTY-AUTHORIZATION: used by the TURN server to inform the client
that it supports 3^rd^ party authorization. It contains the TURN server name.
4\. Self-contained token is used to contain all the information necessary to
authenticate the validity of the token. It is made up of two parts: Encrypted
data and HMAC code.
Encrypted data consists of a block of data encrypted with the AS-RS key. The
data block contains the following parameters:
a) Session key generated by the authorization server (mac_key)
b) Lifetime of the access token (lifetime)
c) Timestamp
d) Key length in octects (key_length)
HMAC code (mac) which is computed with the AUTH key over the Encrypted data
and the TURN server name.
5\. Client is unaware of the contents of the token. It just forwards it to the
TURN server in the "Allocate" request.
In brief the mechanism works as follows:
a) TURN Client begins by sending "Allocate" request without any credentials.
b) TURN server rejects the request and challenges the client to authenticate
itself by sending "Allocate" error response with error code set to "401
Unauthorized"
c) Client initiates the OAuth process by sending Access Token request to the
authorization server -- this will contain "aud" parameter containing the TURN
server name and "alg" specifiying the algorithm to use.
d) Once the client is authorized, the authorization server responds with an
access token, the session key (i.e. mac_key) and the key id (in key_id)
e) The client now retries the "Allocate" request, this time including i) the
access token in the ACCESS-TOKEN attribute, ii) key_id in the USERNAME
attribute and iii) MESSAGE-INTEGRITY attribute containing the HMAC value
computed over the the contents of TURN message with the session key (mac_key)
used as the input key
f) The server receives the request and performs few key steps to authenticate
the client:
\- Performs message integrity check on the access token using the AUTH key,
\- Using AS-RS key it decrypts the the encrypted_block and obtains the session
key (mac_key),
\- Using mac_key it performs the message integrity check over the request and
matches it with the contents of the MESSAGE-INTEGRITY attribute.
g) If all the checks pass, the server allocates a "relayed transport address"
for the client and responds with the "Allocate" success response containing
this address and the "server reflexive address" that indicates the address on
the public side of the NAT.
The following section provides an example realization of in IMS_WebRTC based
on OAuth Access token based authentication of TURN clients.
#### 6.3.2.2 OAuth Implicit Grant based TURN Authentication in WebRTC
Figure 6.3.2.2-1 illustrates aTURN authentication flow in IMS_WebRTC based on
OAuth Implicit grant.
Following is the mapping of various roles in IMS_WebRTC:
a) The Browser, executing ICE Agent on behalf of the WIC, is the TURN client.
b) The WIC is the OAuth client (of implicit type)
c) The WAF is the authorization server that issues the access token to the
WIC.
d) The TURN server is the resource server that receives the access token from
the TURN client.
The WAF and the TURN server share a long-term secret K. From this, two
additional keys are derived to encrypt the token and ensure message integrity
of the message.
The WIC performs the HTTPS request to WWSF/WAF to obtain an access token. The
WAF responds with a self-contained token, a TURN session key and the key
identifier. The WIC configures these parameters in the TURN client (browser)
through the W3C API RTCPeerConnection. This completes the set of activities
that falls in the 3GPP scope.
Following paragraph is for information only and outside the scope of 3GPP:
Internally the ICE Agent in the browser initiates TURN message flow as per RFC
5766 [4] and STUN Extension for Third Party Authorization [9] ]. The
configured values of the access token and the key identifier are sent to the
server in the TURN Allocate request. TURN server uses the key identifier to
select the appropriate keys for token integrity validation and decryption.
TURN server performs message integrity check of the message and extracts the
TURN session key from this self-contained token. Subsequent TURN messages are
integrity protected by using this TURN session key, the TURN server
authencates the WIC by verifying the message integrity value carried in the
MESSAGE-INTEGRITY attribute.
Figure 6.3.2.2-1: TURN authentication based on OAuth access token
The details of the signalling flows are as follows:
**0\. WIC registers with the WAF**
**Before a WIC can request access to the protected resource in TURN server, it
must first register with the WAF associated with the TURN server. The field
client_type is set as public. A redirect URI is also registered with the
server. This is the client's redirection point used by the WAF to redirect the
browser (user-agent) once the subscriber is authenticated successfully.**
**In response, the WAF will assign a unique client ID to the registered
client.**
**Step 0 is completed independently in advance of the following steps.**
NOTE 1:.The mechanism used by the WIC to register with the WAF is
implementation-specific and is outside the scope of 3GPP.
**1\. User clicks on a button to make a WebRTC call**
**The user accesses a URI to the WWSF to initiate an HTTPS connection to the
WWSF. The browser downloads and initializes WIC from the WWSF. WIC learns its
client ID at this point.**
**At some point in time the user clicks on a button to make a WebRTC call.**
> **NOTE 2 : The WIC registers with the IMS through any of the registration
> scenarios specified in Annex X of TS 33.203 before user can place a call.**
**2\. Request Access token**
WIC starts the OAuth process. It **issues HTTP GET to request access token
from the OAuth server. It includes all the required parameters like registered
client_id, TURN server name in the aud parameter etc.**
**3\. User authentication and authorization**
WAF authenticates the user and obtains user authorization from user to setup a
WebRTC call.
**4\. WIC gets the access token**
WAF generates an access token and a session key. Access token is structured
according to the format in [9]. It contains a unique session key encrypted
with the corresponding AS-RS key for the TURN server, and HMAC value of the
encrypted portion of the token. The access token, session key and key
identifier (kid) is returned back to the WIC through browser re-direct.
**5\. Configure RTCPeerConnection object in the browser**
The WIC creates a WebRTC connection with RTCPeerConnection.
The RTCPeerConnection is the WebRTC component (API) that handles efficient
streaming of data between two peers. Following TURN related information is
configured via this API - TURN Server URI, key id (as username), session key
(as credential) and access token.
**6\. WebRTC uses TURN to obtain "relayed transport address" on the TURN
server**
NOTE 3: This step is executed by WebRTC API inside the browser and is outside
the scope of 3GPP.
The WebRTC API executing inside the browser uses TURN protocol as specified in
RFC 5766 [4] and STUN Extension for Third Party Authorization [9] to allocate
and obtain "relayed transport address" from the TURN server. The client uses
access token and session key to authenticate itself with the server.
All communication between the WIC and TURN server is now integrity protected
with the session key.
NOTE 4: It is recommended that this solution be only used in IMS registrations
scenarios 2 and 3 which use a similar access token based mechanism to
authenticate the WIC.
NOTE 5: IMS Registration scenario 3 provides a mechanism by which an anonymous
user skips authenticating with the WWSF but is able to access IMS services
like any other authenticated user. Similar mechanism is supported by this
solution when "client credentials" based flow is used for TURN authentication.
In such a mechanism, the WWSF skips authenticating the WIC but provides an
access token for it to authenticate with the WAF.
#### 6.3.2.3 OAuth Client Credentials grant based TURN Authentication in
WebRTC
Figure 6.3.2.3-1 illustrates aTURN authentication flow in IMS_WebRTC based on
OAuth Client Credentials grant.
Following is the mapping of various roles in IMS_WebRTC when "Client
Credentials" grant is used:
a) The Browser, executing ICE Agent on behalf of the WIC, is the TURN client.
b) The WWSF is the OAuth client (of confidential type)
c) The WAF is the authorization server that issues the access token to WWSF.
d) The TURN server is the resource server that receives the access token from
the TURN client.
Figure 6.3.2.3-1: TURN authentication based on OAuth Client Credentials grant
The details of the signalling flows are as follows:
**0\. WWSF registers with the WAF**
**Before WWSF can request access to the protected resource in TURN server, it
must first register with the WAF associated with the TURN server. The field
client_type is set as confidential.**
**In response, the WAF will assign a unique client ID and client password to
the WWSF.**
**Step 0 is completed independently in advance of the following steps.**
NOTE 1: The mechanism used by the WWSF to register with the WAF is at the
discretion of the implementation and is outside the scope of 3GPP.
**1\. User clicks on a button to make a WebRTC call**
**The user accesses a URI to the WWSF to initiate an HTTPS connection to the
WWSF. The browser downloads and initializes WIC from the WWSF.**
**At some point in time the user clicks on a button to make a WebRTC call.**
NOTE 2: The WIC registers with the IMS through any of the registration
scenarios specified in Annex X of TS 33.203 before the user places a call.
**2\. User authentication and authorization**
WWSF authenticates the user and obtains authorization from the user to setup a
WebRTC call.
NOTE 3: WWSF should skip this step if it has authenticated and obtained user's
authorization during IMS registration, and IMS registration is still
considered active.
**3\. Request Access token**
WWSF starts the OAuth process. It **issues HTTP GET to request access token
from the OAuth server. It includes all the required parameters like registered
client_id, client password, TURN server name in the aud parameter etc. The
field grant_type is set to client_credentials.**
**4\. WIC gets the access token**
WAF authenticates the client (WWSF) and generates an access token and a
session key. Access token is structured according to the format in [9]. It
contains a unique session key encrypted with the corresponding AS-RS key for
the TURN server, and HMAC value of the encrypted portion of the token.
The access token, session key and key identifier (kid) is returned back to the
WWSF. The WWSF in turn provides these values to the WIC.
**5\. Configure RTCPeerConnection object in the browser**
The WIC creates a WebRTC connection with RTCPeerConnection.
The RTCPeerConnection interface is the WebRTC component (API) that handles
efficient streaming of data between two peers. Following TURN related
information is configured via this API - TURN Server URI, key id (as
username), session key (as credential) and access token.
**6\. WebRTC uses TURN to obtain "relayed transport address" on the TURN
server**
NOTE 4: This step is executed by WebRTC API inside the browser and is outside
the scope of 3GPP.
The WebRTC API executing inside the browser uses TURN protocol as specified in
RFC 5766 [4] and STUN Extension for Third Party Authorization [9] to allocate
and obtain "relayed transport address" from the TURN server. The TURN client
uses access token and session key to authenticate itself with the server.
All communication between the WIC and TURN server is now integrity protected
with the session key.
### 6.3.3 TURN authentication via eP-CSCF provided credentials
This solution actually reuses the username/password authorization method of
the long-term credential, but its credential is dynamically provisioned by eP-
CSCF via the signalling messages, which it doesn't impact on the current TURN
protocol.
When WIC registers to IMS, its request the IMS networks to provision a
credential for TURN access authentication by using a 3GPP extension heard
field or a special tag, eP-CSCF generates a TURN credential including user id
and password, and sends this credential to WIC with the successful
registration response message, the credential is carried in a 3GPP extension
heard field. Since the signaling messages between WIC and eP-CSCF are required
to be protected by the secure protocols, e.g. secure Websocket, the TURN
credential can be securely transferred to WIC. The TURN credential may be
changed for every registration or remains the same for a period of time until
it expires. Before the re-registration, WIC can also use the other messages
such as SIP OPTION with a 3GPP extension heard field or a special tag to
request eP-CSCF for changing the credential, if the credential needs to be
updated, .e.g. the password expires.
The credential can be delivered to TURN solution by the following two
approaches:
**Approach 1** : as description in figure 6.3.3-1 the TURN server and eP-CSCF
establish a symmetric key by using out of band method, eP-CSCF uses this
symmetric key with user id and timestamp to generate a password for this user
id when WIC request for provisioning TURN credential and the timestamp will
also be sent to WIC with the TURN credential, the timestamp is used for TURN
server and WIC to set the credential expired time .When WIC performs the
allocate request to TURN server, the user id and timestamp will be carried in
USERNAME attribute with the specific format and be sent to the TURN
server.TURN server will split the USERNAME attribute into user id value and
timestamp value when it receives the allocate request . TURN server uses the
same method as eP-CSCF to generate the password, and uses the same calculation
method as the current TURN protocol to authorize and authenticate the WIC.
Figure 6.3.3-1: Credential provisioned by eP-CSCF (approach 1)
**Approach 2** : as description in figure 6.3.3-1,the credential is directly
sent to TURN server by a new defined interface between TURN server and eP-
CSCF, compare to current TURN protocol, there is no any change for the TURN
exchange messages between WIC and TURN server.
Editor\'s note: Which protocol is used to transfer the TURN credential from
eP-CSCF to TURN server is ffs.
Figure 6.3.3-2: Credential provisioned by eP-CSCF (approach 2)
### 6.3.4 Assessment of candidate solutions
The following table provides an analysis of the three solutions for potential
impacts to the IMS WebRTC architecture, W2 signaling procedure and TURN
protocol.
+----------------+----------------+----------------+----------------+ | | TURN | Approach 1 of | Approach 2 of | | | Authentication | TURN | TURN | | | using OAuth | authentication | authentication | | | access token. | via eP-CSCF | via eP-CSCF | | | | provided | provided | | | | credentials | credentials | +----------------+----------------+----------------+----------------+ | Impact on | No impact when | No impact | Requires | | Network | used in | | additional | | Architecture | registration | | interface | | | scenarios 2 | | between | | | and 3. | | eP-CSCF and | | | | | TURN server | | | In deployments | | for | | | that don't | | transferring | | | have a WAF | | TURN | | | (scenario 1, | | credential | | | for example) | | information. | | | using this | | | | | solution would | | | | | mean having a | | | | | WAF or a | | | | | WAF-like | | | | | component in | | | | | the network to | | | | | authenticate | | | | | and provide | | | | | access token | | | | | to the WIC. | | | +----------------+----------------+----------------+----------------+ | Impact on IMS | No impact | Changes are | Changes are | | signalling | | needed in IMS | needed in IMS | | procedure | | Registration | Registration | | (registration, | | signalling | signalling | | call setup | | procedure to | procedure to | | etc) | | support a new | support a new | | | | header to | header to | | | | request and | request and | | | | return TURN | return TURN | | | | credential to | credential to | | | | the WIC | the WIC | +----------------+----------------+----------------+----------------+ | Impact on IMS | Changes are | Changes are | Changes are | | WebRTC | required in: | required in | required: | | functional | | | | | entities (WIC, | a) WIC -- to | a) WIC -- | a) WIC -- | | WWSF, WAF, | get a unique | support IMS | support IMS | | eP-CSCF) | access token | registration | registration | | | during call | signalling | signalling | | | setup and use | enhancements | enhancements | | | this token for | | | | | TURN | b) eP-CSCF | b) eP-CSCF | | | authentication | | | | | in compliance | - support IMS | - support IMS | | | with the draft | registration | registration | | | RFC | signalling | signalling | | | | enhancements, | enhancements, | | | b) WAF -- | | generate TURN | | | this needs to | - generate | password for | | | be compliant | TURN password | TURN server to | | | with the draft | and transfer | verify | | | RFC | to WIC | use | | | | | rname/password | +----------------+----------------+----------------+----------------+ | Impact on | Requires TURN | TURN password | Changes | | existing TURN | protocol to | has a lifetime | required in | | protocol | support | value. This | the TURN | | | extensions | may be | server to | | | defined by the | embedded as | obtain | | | draft RFC. | part of the | password from | | | | username | eP-CSCF. No | | | Corresponding | attribute. | change in TURN | | | changes are | This will | protocol | | | required in | require | messages. | | | TURN client | corresponding | | | | (browser) and | changes in | | | | TURN server. | TURN client | | | | | and server | | | | | software. | | | | | | | | | | There is no | | | | | impact to the | | | | | TURN protocol | | | | | messages | | +----------------+----------------+----------------+----------------+
Table 6.3.4-1 Comparison of the three TURN authentication solutions
The following table analyzes each of the options against the security concerns
raised by RFC 7376 [6]
+----------------+----------------+----------------+----------------+ | Concerns with | Based on OAuth | eP-CSCF based | eP-CSCF based | | RFC 5389 based | access token | dynamic | dynamic | | TURN | | provisioning - | provisioning | | authentication | | Approach 1 | -- Approach 2 | +----------------+----------------+----------------+----------------+ | 1. Lack of | Access tokens | Timestamp is | Timestamp is | | key freshness | have an expiry | one of the | one of the | | | time. | parameter used | parameter used | | | | to compute the | to compute the | | | | password. This | password. This | | | | ensures | ensures | | | | freshness of | freshness of | | | | the password. | the password. | +----------------+----------------+----------------+----------------+ | 2. Need to | Credentials | Credentials | Credentials | | store | are not stored | are not stored | are not stored | | long-term | in the TURN | in the TURN | in the TURN | | credentials of | server. | server. They | server. They | | all the users | | are computed | are computed | | when TURN | | dynamically at | dynamically at | | server is in a | | every | every | | DMZ | | authentication | authentication | | | | instance. | instance. | +----------------+----------------+----------------+----------------+ | 3. Privacy | Real usernames | Real usernames | Real usernames | | leakage when | are not used. | are not used. | are not used. | | real usernames | Key id (kid), | Usernames are | Usernames are | | are used (by | which is | generated by | generated by | | snooping | generated by | eP-CSCF. | eP-CSCF. | | adversary) | the WAF, is | | | | | used as the | | | | | username | | | | | | | | | | . | | | +----------------+----------------+----------------+----------------+ | 4. Reliance | WIC indicates | Rely on TURN | Rely on TURN | | on SHA1 | to the WAF | protocol | protocol | | | which | enhancement to | enhancement to | | | algorithm to | support other | support other | | | use for MAC. | algorithms. | algorithms. | | | This is one of | Risk can be | Risk can be | | | the parameters | controlled by | controlled by | | | passed when | using a short | using a short | | | request is | lifetime for | lifetime for | | | made by the | TURN | TURN | | | WIC for an | credential | credential | | | access token. | | | +----------------+----------------+----------------+----------------+ | 5. Privacy | This is not | This is not | This is not | | leakage due to | possible since | possible since | possible since | | a MITM posing | real usernames | real usernames | real usernames | | as a TURN | are not used. | are note used. | are note used. | | server | | Usernames are | Usernames are | | | Using | generated | generated | | | | randomly by | randomly by | | | | eP-CSCF. | eP-CSCF. | +----------------+----------------+----------------+----------------+ | 6. Risk of | This is | Password has a | Password has a | | exposing the | protected by | lifetime | lifetime | | stored | the 2-step | associated | associated | | credentials in | authentication | with it. This | with it. This | | the Javascript | process: | forces the WIC | forces the WIC | | code | | to reregister | to reregister | | | 1. Access | and get a new | and get a new | | | tokens come | password. This | password. This | | | with a | guarantees | guarantees | | | lifetime. So | freshness of | freshness of | | | they expire | the password. | the password. | | | after a while. | | | | | | | | | | 2. Plus this | | | | | solution | | | | | requires the | | | | | client to | | | | | prove | | | | | proof | | | | | -of-possession | | | | | by | | | | | demonstrating | | | | | that it has a | | | | | secret key | | | | | corresponding | | | | | to the access | | | | | token it | | | | | possesses. | | | +----------------+----------------+----------------+----------------+
Table 6.3.4-2 Analysis of the solutions against concerns raised by RFC 7376
### 6.3.5 Conclusion
For the eP-CSCF based solution, "Approach 2" requires an additional interface
between the eP-CSCF and the TURN server. This requires network architecture
change and is not preferred. Approach 1 is the chosen option for eP-CSCF based
provisioning of TURN credentials
Each solution offers advantages that are not present in other solutions. While
token based solution makes more sense in scenarios 2 and 3 which already have
the WAF generating access tokens, the eP-CSCF based solutions offer the
advantage that they can be used in all the three registration scenarios.
IMS WebRTC offers flexibility in how the network is deployed. It is important
that similar flexibility be provided for TURN authentication so that different
deployment scenarios can be leveraged for efficient TURN authentication of
WIC. The chosen mechanism would totally depend on the deployment scenario and
operator policy.
It is therefore recommended to include as informative text in TS 33.203 both
options -- a) Token based TURN authentication and b) eP-CSCF based dynamic
provisioning of TURN credentials, as the authentication mechanism for TURN.
## 6.4 Firewall traversal for WebRTC media
A restrictive firewall may be present in-between the WIC and IMS network that
is configured to block UDP packets. Since WebRTC voice and video packets are
transported over UDP, they will be dropped as they traverse across the
restrictive firewall that lies between the WIC and the eIMS-AGW. Therefore a
restrictive firewall traversal solution is needed for WebRTC media.
Section 6.3.1 of TR 33.871 [14] describes the use of ICE/STUN/TURN based
method specified in Annex W.3 of TS 33.203. In this method, TURN server is
employed to relay WebRTC media between the WIC and the eIMS-AGW.
The WIC and IMS-AGW/IMS-ALG may alternatively employ the ICE for TCP based
mechanism specified in 3GPP TS 23.334 [13]. In this method, ICE for TCP is
used to setup a TCP connection between the WIC and the IMS-AGW, and IMS-AGW is
used to relay traffic between the two communicating WICs.
# 7 Assessment of solutions
Editor's Note: If needed, this clause will contain assessments of the various
solutions.
# 8 Conclusions and recommendations
Editor's Note: This clause will capture agreed conclusions and
recommendations.
#