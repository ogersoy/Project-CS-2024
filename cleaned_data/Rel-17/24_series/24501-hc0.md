# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the non-access stratum (NAS) procedures in the
5G system (5GS) used by the protocols for:
\- mobility management between the user equipment (UE) and the access and
mobility management function (AMF) for both 3GPP access and non-3GPP access;
and
\- session management between the user equipment (UE) and the session
management function (SMF) for both 3GPP access and non-3GPP access.
The 5GS mobility management (5GMM) protocol defined in the present document
provides procedures for the control of mobility when the user equipment (UE)
is using the NG radio access network (NG-RAN) and/or non-3GPP access network.
The 5GMM protocol also provides control of security for the NAS protocols.
The 5GS session management (5GSM) protocol defined in the present document
provides procedures for the handling of 5GS PDU sessions. Together with the
bearer control provided by the access stratum, this protocol is used for the
control of user-plane resources.
For both NAS protocols the present document specifies procedures for the
support of inter-system mobility between the NG-RAN and the evolved universal
terrestrial radio access (E-UTRAN), between the NG-RAN and the non-3GPP access
network connected to the EPC, and between the non-3GPP access network
connected to the 5G core network (5GCN) and the E-UTRAN.
For both NAS protocols the present document specifies procedures for the
support of mobility between the NG-RAN and the non-3GPP access network
connected to the 5GCN.
In addition, the present document specifies the procedures in the 5GS for UE
policy delivery service between the UE and the policy control function (PCF)
for both 3GPP access and non-3GPP access.
The present document is applicable to the UE, the access and mobility
management function (AMF), the session management function (SMF), and the PCF
in the 5GS.
The clauses and subclauses in the present document are common for both 3GPP
access and non-3GPP access unless it is explicitly stated that they apply to
3GPP access only or non-3GPP access only.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document in the same
Release as the present document.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[1A] 3GPP TS 22.011: \"Service accessibility\".
[2] 3GPP TS 22.101: \"Service aspects; Service principles\".
[3] 3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\".
[4] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[4A] 3GPP TS 23.040: \"Technical realization of Short Message Service (SMS)\".
[4B] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
[5] 3GPP TS 23.122: \"Non-Access-Stratum functions related to Mobile Station
(MS) in idle mode\".
[6] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[6A] 3GPP TS 23.216: \"Single Radio Voice Call Continuity (SRVCC); Stage 2\".
[6AB] 3GPP TS 23.256: \"Support of Uncrewed Aerial Systems (UAS) connectivity,
identification and tracking; Stage 2\".
[6B] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".
[6C] 3GPP TS 23.287: \"Architecture enhancements for 5G System (5GS) to
support Vehicle-to-Everything (V2X) services\".
[6D] 3GPP TS 23.316: \"Wireless and wireline convergence access support for
the 5G System (5GS)\".
[6E] 3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System
(5GS)\".
[7] 3GPP TS 23.401: \"GPRS enhancements for E-UTRAN access\".
[8] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[9] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[10] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G
System; Stage 2\".
[10A] 3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".
[11] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
[12] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols; Stage 3\".
[13] 3GPP TS 24.011: \"Point-to-Point Short Message Service (SMS) support on
mobile radio interface\".
[13A] 3GPP TS 24.080: \"Mobile radio interface layer 3 Supplementary services
specification; Formats and coding\".
[13B] 3GPP TS 24.193: \"Access Traffic Steering, Switching and Splitting;
Stage 3\".
[13C] 3GPP TS 24.173: \"IMS Multimedia telephony communication service and
supplementary services; Stage 3\".
[13D] 3GPP TS 24.174: \"Support of multi-device and multi-identity in the IP
Multimedia Subsystem (IMS); Stage 3\".
[14] 3GPP TS 24.229: \"IP multimedia call control protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".
[14AA] 3GPP TS 24.237: \"IP Multimedia (IM) Core Network (CN) subsystem IP
Multimedia Subsystem (IMS) service continuity; Stage 3\".
[14A] 3GPP TS 24.250: \"Protocol for Reliable Data Service; Stage 3\".
[15] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[16] 3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via
non-3GPP access networks; Stage 3\"
[17] 3GPP TS 24.368: \"Non-Access Stratum (NAS) configuration Management
Object (MO)\".
[18] 3GPP TS 24.502: \"Access to the 3GPP 5G System (5GS) via non-3GPP access
networks; Stage 3\".
[19] 3GPP TS 24.526: \"UE policies for 5G System (5GS); Stage 3\".
[19BA] 3GPP TS 24.539: \"5G System (5GS); Network to TSN translator (TT)
protocol aspects; Stage 3\".
[19A] 3GPP TS 24.535: \"Device-Side Time-Sensitive Networking (TSN) Translator
(DS-TT) to Network-Side TSN Translator (NW-TT) protocol aspects; Stage 3\".
[19B] 3GPP TS 24.587: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); Protocol aspects; Stage 3\"
[19C] 3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); User Equipment (UE) policies; Stage 3\"
[19D] Void.
[19E] 3GPP TS 24.554: \"Proximity-service (ProSe) in 5G System (5GS) protocol
aspects; Stage 3\".
[19F] 3GPP TS 24.555: \"Proximity-services (ProSe) in 5G System (5GS); User
Equipment (UE) policies; Stage 3\".
[20] 3GPP TS 24.623: \"Extensive Markup Language (XML) Configuration Access
Protocol (XCAP) over the Ut interface for Manipulating Supplementary
Services\".
[20AA] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[20A] 3GPP TS 29.502: \"5G System; Session Management Services; Stage 3\".
[20AB] 3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage
3\".
[20B] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[21] 3GPP TS 29.525: \"5G System; UE Policy Control Service; Stage 3\".
[21A] 3GPP TS 29.526: \"5G System; Network Slice-Specific Authentication and
Authorization (NSSAA) services; Stage 3\".
[21B] 3GPP TS 29.256: \"5G System; Uncrewed Aerial Systems Network Function
(UAS-NF); Aerial Management Services; Stage 3.
[22] 3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity
Module (USIM) application\".
[22A] 3GPP TS 31.111: \"USIM Application Toolkit (USAT)\".
[22B] 3GPP TS 31.115: \"Secured packet structure for (Universal) Subscriber
Identity Module (U)SIM Toolkit applications\".
[23] 3GPP TS 33.102: \"3G security; Security architecture\".
[23A] 3GPP TS 33.401: \"3GPP System Architecture Evolution; Security
architecture\".
[24] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
[24A] 3GPP TS 33.535: \"Authentication and Key Management for Applications
(AKMA) based on 3GPP credentials in the 5G System (5GS)\".
[24B] 3GPP TS 33.256: \"Security aspects of Uncrewed Aerial Systems (UAS)\".
[25] 3GPP TS 36.323: \"NR; Packet Data Convergence Protocol (PDCP)
specification\".
[25A] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC) protocol specification\".
[25B] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA)
and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall
description\".
[25C] 3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) procedures in idle mode\".
[25D] 3GPP TS 36.306: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) radio access capabilities\".
[25E] 3GPP TS 36.321: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Medium Access Control (MAC) protocol specification\".
[26] 3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\".
[27] 3GPP TS 38.300: \"NR; NR and NG-RAN Overall Description; Stage 2\".
[28] 3GPP TS 38.304: \"New Generation Radio Access Network; User Equipment
(UE) procedures in Idle mode\".
[29] 3GPP TS 38.323: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Packet Data Convergence Protocol (PDCP) specification\".
[30] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol
Specification\".
[31] 3GPP TS 38.413: \"NG Radio Access Network (NG-RAN); NG Application
Protocol (NGAP)\".
[31A] IEEE Std 802.3â„¢-2022: \"Ethernet\".
[31AA] 3GPP TS 38.509: \"Special conformance testing functions for User
Equipment (UE)\".
[32] IETF RFC 768: \"User Datagram Protocol\".
[33] IETF RFC 793: \"Transmission Control Protocol.\"
[33A] IETF RFC 3095: \"RObust Header Compression (ROHC): Framework and four
profiles: RTP, UDP, ESP and uncompressed\".
[33B] Void.
[33C] Void.
[33D] IETF RFC 8415: \"Dynamic Host Configuration Protocol for IPv6
(DHCPv6)\".
[34] IETF RFC 3748: \"Extensible Authentication Protocol (EAP)\".
[34A] IETF RFC 3843: \"RObust Header Compression (ROHC): A Compression Profile
for IP\".
[35] Void.
[35A] IETF RFC 4122: \"A Universally Unique IDentifier (UUID) URN Namespace\".
[36] IETF RFC 4191: \"Default Router Preferences and More-Specific Routes\".
[37] IETF RFC 7542: \"The Network Access Identifier\".
[38] IETF RFC 4303: \"IP Encapsulating Security Payload (ESP)\".
[38A] IETF RFC 4815: \"RObust Header Compression (ROHC): Corrections and
Clarifications to RFC 3095\".
[38B] IETF RFC 4861: \"Neighbor Discovery for IP version 6 (IPv6)\".
[39] IETF RFC 4862: \"IPv6 Stateless Address Autoconfiguration\".
[39A] IETF RFC 5225: \"RObust Header Compression (ROHC) Version 2: Profiles
for RTP, UDP, IP, ESP and UDP Lite\".
[39B] IETF RFC 5795: \"The RObust Header Compression (ROHC) Framework\".
[40] IETF RFC 5448: \"Improved Extensible Authentication Protocol Method for
3rd Generation Authentication and Key Agreement (EAP-AKA\')\".
[40A] IETF RFC 6603: \"Prefix Exclude Option for DHCPv6-based Prefix
Delegation\".
[40B] IETF RFC 6846: \"RObust Header Compression (ROHC): A Profile for TCP/IP
(ROHC-TCP)\".
[41] IETF RFC 7296: \"Internet Key Exchange Protocol Version 2 (IKEv2)\".
[42] ITU-T Recommendation E.212: \"The international identification plan for
public networks and subscriptions\", 2016-09-23.
[43] IEEE Std 802-2014: \"IEEE Standard for Local and Metropolitan Area
Networks: Overview and Architecture\" (30 June 2014).
[43A] IEEE Std 802.1AS-2020: \"IEEE Standard for Local and metropolitan area
networks--Timing and Synchronization for Time-Sensitive Applications\".
[43B] IEEE Std 1588â„¢-2019: \"IEEE Standard for a Precision Clock
Synchronization Protocol for Networked Measurement and Control Systems\".
[43C] Void.
[43D] Void.
[43E] Void.
[44] Void.
[45] Void.
[46] Void.
[47] Void.
[48] IEEE \"Guidelines for Use of Extended Unique Identifier (EUI),
Organizationally Unique Identifier (OUI), and Company ID (CID)\".
[49] BBF TR-069: \"CPE WAN Management Protocol\".
[50] BBF TR-369: \"User Services Platform (USP)\".
[51] 3GPP TS 37.340: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
NR; Multi-connectivity; Stage 2\".
[52] IETF RFC 8106:\"IPv6 Router Advertisement Options for DNS
Configuration\".
[53] 3GPP TS 23.247: \"Architectural enhancements for 5G multicast-broadcast
services; Stage 2\".
[54] 3GPP TS 23.380: \"IMS Restoration Procedures\".
[55] IETF RFC 3948: \"UDP Encapsulation of IPsec ESP Packets\".
[56] 3GPP TS 33.503: \"Security Aspects of Proximity based Services (ProSe) in
the 5G System (5GS)\".
[57] 3GPP TS 33.246: \"Security of Multimedia Broadcast/Multicast Service
(MBMS)\".
[58] 3GPP TS 38.321: \"NR; Medium Access Control (MAC); Protocol
specification\".
[59] IETF RFC 4291:\" IP Version 6 Addressing Architecture\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**5GMM-IDLE mode:** In this specification, if the term is used standalone, a
UE in 5GMM-IDLE mode means the UE can be either in 5GMM-IDLE mode over 3GPP
access or in 5GMM-IDLE mode over non-3GPP access.
**5GMM-CONNECTED mode:** In this specification, if the term is used
standalone, a UE in 5GMM-CONNECTED mode means the UE can be either in 5GMM-
CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode over non-3GPP
access.
**5GMM-IDLE mode over 3GPP access:** A UE is in 5GMM-IDLE mode over 3GPP
access when no N1 NAS signalling connection between the UE and network over
3GPP access exists. The term 5GMM-IDLE mode over 3GPP access used in the
present document corresponds to the term CM-IDLE state for 3GPP access used in
3GPP TS 23.501 [8].
**5GMM-CONNECTED mode over 3GPP access:** A UE is in 5GMM-CONNECTED mode over
3GPP access when an N1 NAS signalling connection between the UE and network
over 3GPP access exists. The term 5GMM-CONNECTED mode over 3GPP access used in
the present document corresponds to the term CM-CONNECTED state for 3GPP
access used in 3GPP TS 23.501 [8].
**5GMM-IDLE mode over non-3GPP access:** A UE is in 5GMM-IDLE mode over
non-3GPP access when no N1 NAS signalling connection between the UE and
network over non-3GPP access exists. The term 5GMM-IDLE mode over non-3GPP
access used in the present document corresponds to the term CM-IDLE state for
non-3GPP access used in 3GPP TS 23.501 [8].
**5GMM-CONNECTED mode over non-3GPP access:** A UE is in 5GMM-CONNECTED mode
over non-3GPP access when an N1 NAS signalling connection between the UE and
network over non-3GPP access exists. The term 5GMM-CONNECTED mode over
non-3GPP access used in the present document corresponds to the term CM-
CONNECTED state for non-3GPP access used in 3GPP TS 23.501 [8].
**5GS services:** Services provided by PS domain. Within the context of this
specification, 5GS services is used as a synonym for EPS services.
**5G-EA:** 5GS encryption algorithms. The term 5G-EA, 5G-EA0, 128-5G-EA1,
128-5G-EA2, 128-5G-EA3, 5G-EA4, 5G-EA5, 5G-EA6 and 5G-EA7 used in the present
document corresponds to the term NEA, NEA0, 128-NEA1, 128-NEA2, 128-NEA3,
NEA4, NEA5, NEA6 and NEA7 defined in 3GPP TS 33.501 [24].
**5G-IA:** 5GS integrity algorithms. The term 5G-IA, 5G-IA0, 128-5G-IA1,
128-5G-IA2, 128-5G-IA3, 5G-IA4, 5G-IA5, 5G-IA6 and 5G-IA7 used in the present
document corresponds to the term NIA, NIA0, 128-NIA1, 128-NIA2, 128-NIA3,
NIA4, NIA5, NIA6 and NIA7 defined in 3GPP TS 33.501 [24].
**Access stratum connection:** A peer to peer access stratum connection:
\- between the UE and the NG-RAN for 3GPP access;
\- between the UE and the N3IWF for untrusted non-3GPP access;
\- between the UE and the TNGF for trusted non-3GPP access used by the UE;
\- within the TWIF acting on behalf of the N5CW device for trusted non-3GPP
access used by the N5CW device;
\- between the 5G-RG and the W-AGF for wireline access used by the 5G-RG;
\- within the W-AGF acting on behalf of the FN-RG for wireline access used by
the FN-RG; or
\- within the W-AGF acting on behalf of the N5GC device for wireline access
used by the N5GC device.
The access stratum connection for 3GPP access corresponds to an RRC connection
via the Uu reference point. The creation of the access stratum connection for
untrusted non-3GPP access corresponds to the completion of the IKE_SA_INIT
exchange (see IETF RFC 7296 [41]) via the NWu reference point. The creation of
the access stratum connection for trusted non-3GPP access used by the UE
corresponds to the UE reception of an EAP-request/5G-start via NWt reference
point (see 3GPP TS 23.502 [9]). The creation of the access stratum connection
for trusted non-3GPP access used by the N5CW device corresponds to the TWIF\'s
start of acting on behalf of the N5CW device. The creation of the access
stratum connection for wireline access used by the 5G-RG corresponds to the
5G-RG reception of an EAP-request/5G-packet over the W-CP EAP connection via
the Y4 reference point (see 3GPP TS 23.316 [6D]). The creation of the access
stratum connection for wireline access used by the FN-RG corresponds to the
W-AGF\'s start of acting on behalf of the FN-RG. The creation of the access
stratum connection for wireline access used by the N5GC device corresponds to
the W-AGF\'s start of acting on behalf of the N5GC device.
**Access to SNPN services via a PLMN/To access SNPN services via a PLMN:** A
UE is accessing SNPN services via a PLMN when the UE is connecting to the 5GCN
of the SNPN using the 3GPP access of the PLMN.
**Aggregate maximum bit rate:** The maximum bit rate that limits the aggregate
bit rate of a set of non-GBR bearers of a UE. Definition derived from 3GPP TS
23.501 [8].
**Always-on PDU session:** A PDU session for which user-plane resources have
to be established during every transition from 5GMM-IDLE mode to 5GMM-
CONNECTED mode. A UE requests a PDU session to be established as an always-on
PDU session based on indication from upper layers and the network decides
whether a PDU session is established as an always-on PDU session.
NOTE 1: How the upper layers in the UE are configured to provide an indication
is outside the scope of the present document.
**Applicable UE radio capability ID for the current UE radio configuration in
the selected network:** The UE has an applicable UE radio capability ID for
the current UE radio configuration in the selected network if:
a) the UE supports RACS; and
b) the UE has:
1) a stored network-assigned UE radio capability ID which is associated with
the PLMN ID or SNPN identity of the serving network and which maps to the set
of radio capabilities currently enabled at the UE; or
2) a manufacturer-assigned UE radio capability ID which maps to the set of
radio capabilities currently enabled at the UE.
**CAG cell:** A cell in which only members of the CAG can get normal service.
Depending on local regulation, the CAG cell can provide emergency services
also to subscribers who are not members of the CAG.
**CAG-ID:** A CAG-ID is a unique identifier within the scope of one PLMN
defined in 3GPP TS 23.003 [4] which identifies a Closed Access Group (CAG) in
the PLMN associated with a cell or group of cells to which access is
restricted to members of the CAG.
**CAG restrictions:** Restrictions applied to a UE in accessing a PLMN\'s 5GCN
via:
a) a non-CAG cell if the entry for the PLMN in the UE\'s \"CAG information
list\" includes an \"indication that the UE is only allowed to access 5GS via
CAG cells\"; or
b) a CAG cell if none of the CAG-ID(s) supported by the CAG cell is included
in the \"allowed CAG list\" for the PLMN in the UE\'s \"CAG information
list\".
The CAG restrictions are not applied in a PLMN when a UE accesses the PLMN due
to emergency services.
**Cleartext IEs:** Information elements that can be sent without
confidentiality protection in initial NAS messages as specified in subclause
4.4.6.
**Configuration of SNPN subscription parameters in PLMN via the user plane:
Configuration of a UE in a PLMN with one or more entries of the \"list of
subscriber data" via the user plane.**
**Control plane CIoT 5GS optimization:** **Signalling optimizations to enable
efficient transport of user data (** IP, Ethernet, Unstructured or SMS**) over
control plane via the AMF including optional header compression of IP data
and** Ethernet data.
**Current TAI: A TAI of a selected PLMN broadcast in the cell on which the UE
is camping. If the cell is a satellite NG-RAN cell broadcasting multiple TACs
of the selected PLMN, the UE NAS layer selects the current TAI from these
multiple TACs of the selected PLMN as specified in subclause 4.23.5.**
NOTE 2: For the purpose of this definition, the selected PLMN can either be
the registered PLMN or a PLMN selected according to PLMN selection rules as
specified in 3GPP TS 23.122 [5].
**DNN determined by the AMF:** If no DNN requested by the UE is provided, a
DNN determined by the AMF based subscription information or local policy.
Otherwise DNN determined by the AMF is the DNN requested by the UE.
**DNN requested by the UE:** A DNN explicitly requested by the UE and included
in a NAS request message.
**DNN selected by the network:** If DNN replacement applies, a DNN selected
and indicated to the AMF by PCF. Otherwise DNN selected by the network is the
DNN determined by the AMF.
**Default S-NSSAI** : An S-NSSAI in the subscribed S-NSSAIs marked as default.
**Globally-unique SNPN identity:** An SNPN identity with an NID whose
assignment mode is not set to 1 (see 3GPP TS 23.003 [4]).
**HPLMN S-NSSAI** : An S-NSSAI applicable in the HPLMN without any further
mapping by the network. If the UE has an EHPLMN list which is not empty, and
the HPLMN code derived from the IMSI is included in the EHPLMN list, then the
HPLMN S-NSSAIs are applicable without any further mapping in the HPLMN derived
from the IMSI. If the HPLMN code derived from the IMSI is not included in the
EHPLMN list, then the HPLMN S-NSSAIs are applicable without any further
mapping in the highest priority EHPLMN.
The UE considers as HPLMN S-NSSAIs at least the following S-NSSAIs:
a) any S-NSSAI included in the configured NSSAI or allowed NSSAI for a PLMN or
SNPN if it is provided by
1) the HPLMN, if the EHPLMN list is not present or is empty;
2) the EHPLMN whose PLMN code is derived from the IMSI;
3) the highest priority EHPLMN, if an EHPLMN list is available and not empty
and the HPLMN code derived from the IMSI is not included in the EHPLMN list;
or
4) the subscribed SNPN;
b) any S-NSSAI provided as mapped S-NSSAI for the configured NSSAI or allowed
NSSAI for a PLMN or SNPN;
c) any S-NSSAI associated with a PDU session if there is no mapped S-NSSAI
associated with the PDU session and the UE is
1) in the HPLMN, if the EHPLMN list is not present or is empty;
2) the EHPLMN whose PLMN code is derived from the IMSI;
3) the highest priority EHPLMN, if any is available and the HPLMN code derived
from the IMSI is not included in the EHPLMN list; or
4) in the subscribed SNPN; and
d) any mapped S-NSSAI associated with a PDU session.
NOTE 3: The above list is not intended to be complete. E.g., also in case of
PLMN the S-NSSAIs included in URSP rules or in the signalling messages for
network slice-specific authentication and authorization are HPLMN S-NSSAIs.
**User plane CIoT 5GS optimization:** **Signalling optimizations to enable
efficient transport of user data (** IP, Ethernet or Unstructured**) over the
user plane**.
**UE supporting CIoT 5GS optimizations:** A UE that supports control plane
CIoT 5GS optimization or user plane CIoT 5GS optimization and one or more
other CIoT 5GS optimizations when the UE is in N1 mode.
**Registered for 5GS services with control plane CIoT 5GS optimization:** **A
UE supporting CIoT 5GS optimizations is registered for 5GS services, and**
control plane CIoT 5GS optimization along with one or more other CIoT 5GS
optimizations have been accepted by the network.
**Registered for 5GS services with user plane CIoT 5GS optimization:** **A UE
supporting CIoT 5GS optimizations is registered for 5GS services, and** user
plane CIoT 5GS optimization along with one or more other CIoT 5GS
optimizations have been accepted by the network.
**Registered for 5GS services with CIoT 5GS optimization:** **A UE is
registered for 5GS services with control plane CIoT 5GS optimization or
registered for 5GS services with user plane CIoT 5GS optimization.**
**DNN based congestion control:** Type of congestion control at session
management level that is applied to reject session management requests from
UEs or release PDU sessions when the associated DNN is congested. DNN based
congestion control can be activated at the SMF over session management level
and also activated at the AMF over mobility management level.
**Emergency PDU session:** A PDU session established with the request type
\"initial emergency request\" or \"existing emergency PDU session\".
**General NAS level congestion control:** Type of congestion control at
mobility management level that is applied at a general overload or congestion
situation in the network, e.g. lack of processing resources.
**Initial NAS message:** A NAS message is considered as an initial NAS
message, if this NAS message can trigger the establishment of an N1 NAS
signalling connection. For instance, the REGISTRATION REQUEST message is an
initial NAS message.
**Initial registration for emergency services:** A registration performed with
5GS registration type \"emergency registration\" in the REGISTRATION REQUEST
message.
**Initial registration for onboarding services in SNPN:** A registration
performed with 5GS registration type \"SNPN onboarding registration\" in the
REGISTRATION REQUEST message.
**Initial registration for disaster roaming services:** A registration
performed with 5GS registration type \"disaster roaming initial registration\"
in the REGISTRATION REQUEST message.
**Last visited registered TAI:** A TAI which is contained in the registration
area that the UE registered to the network and which identifies the tracking
area last visited by the UE. If the cell is a satellite NG-RAN cell
broadcasting multiple TAIs, a TAI which is contained in the registration area
that the UE registered to the network and last selected by the UE as the
current TAI.
**Mapped 5G-GUTI:** **A 5G-GUTI which is mapped from a 4G-GUTI previously
allocated by an MME.** Mapping rules are defined in 3GPP TS 23.003 [4]**.**
**Mapped S-NSSAI:** An S-NSSAI in the subscribed S-NSSAIs for the HPLMN or the
subscribed SNPN, to which an S-NSSAI of the registered PLMN (in case of a
roaming scenario) or the registered non-subscribed SNPN is mapped.
**Mobility registration for disaster roaming services:** A registration
performed with 5GS registration type \"disaster roaming mobility registration
updating\" in the REGISTRATION REQUEST message.
**MUSIM UE: A UE with multiple valid USIMs, capable of initiating and
maintaining simultaneous separate registration states over 3GPP access with
PLMN(s) using identities and credentials associated with those USIMs and
supporting one or more of the N1 NAS signalling connection release, the paging
indication for voice services, the reject paging request, the paging
restriction and the paging timing collision control (see 3GPP TS 23.501
[8]).**
**N1 mode:** A mode of a UE allowing access to the 5G core network via the 5G
access network.
**Native 5G-GUTI:** A 5G-GUTI previously allocated by an AMF.
**Non 5G capable over WLAN (N5CW) device:** A device that is not capable to
operate as a UE supporting NAS signalling with the 5GCN over a WLAN access
network. However, this device may be capable to operate as a UE supporting NAS
signalling with 5GCN using the N1 reference point as specified in this
specification over 3GPP access. An N5CW device may be allowed to access the
5GCN via trusted WLAN access network (TWAN) that supports a trusted WLAN
interworking function (TWIF) as specified in 3GPP TS 24.502 [18].
**Non-CAG Cell:** An NR cell which does not broadcast any Closed Access Group
identity or an E-UTRA cell connected to 5GCN.
**Non-globally-unique SNPN identity:** An SNPN identity with an NID whose
assignment mode is set to 1 (see 3GPP TS 23.003 [4]).
**In NB-N1 mode:** Indicates this paragraph applies only to a system which
operates in NB-N1 mode. For a multi-access system this case applies if the
current serving radio access network provides access to network services via
E-UTRA connected to 5GCN by NB-IoT (see 3GPP TS 36.300 [25B], 3GPP TS 36.331
[25A], 3GPP TS 36.306 [25D]).
**In WB-N1 mode:** Indicates this paragraph applies only to a system which
operates in WB-N1 mode. For a multi-access system this case applies if the
system operates in N1 mode with E-UTRA connected to 5GCN, but not in NB-N1
mode.
**In WB-N1/CE mode:** Indicates this paragraph applies only when a UE, which
is a CE mode B capable UE (see 3GPP TS 36.306 [25D]), is operating in CE mode
A or B in WB-N1 mode.
**Initial small data rate control parameters:** Parameters that, if received
by the UE during the establishment of a PDU session, are used as initial
parameters to limit the allowed data for the PDU session according to small
data rate control after establishment of a PDU session as described in
subclause 6.2.13. At expiry of the associated validity period, the initial
small data rate control parameters are no longer valid and the small data rate
control parameters apply.
**Initial small data rate control parameters for exception data:** Parameters
corresponding to initial small data rate control parameters for small data
rate control of exception data.
**N1 NAS signalling connection:** A peer to peer N1 mode connection between UE
and AMF. An N1 NAS signalling connection is either the concatenation of an RRC
connection via the Uu reference point and an NG connection via the N2
reference point for 3GPP access, or the concatenation of an IPsec tunnel via
the NWu reference point and an NG connection via the N2 reference point for
non-3GPP access.
**N5CW device supporting 3GPP access:** An N5CW device which supports acting
as a UE in 3GPP access (i.e. which supports NAS over 3GPP access).
**N6 PDU session:** A PDU session established between the UE and the User
Plane Function (UPF) for transmitting the UE\'s IP data, Ethernet data or
Unstructured data related to a specific application.
**NEF PDU session:** A PDU session established between the UE and the Network
Exposure Function (NEF) for transmitting the UE\'s Unstructured data related
to a specific application.
**Network slicing information:** information stored at the UE consisting of
one or more of the following:
a) default configured NSSAI for PLMN or SNPN;
b) configured NSSAI for a PLMN or an SNPN;
b1) NSSRG information for the configured NSSAI for a PLMN or an SNPN;
c) mapped S-NSSAI(s) for the configured NSSAI for a PLMN or an SNPN;
d) pending NSSAI for a PLMN or an SNPN;
e) mapped S-NSSAI(s) for the pending NSSAI for a PLMN or an SNPN;
f) rejected NSSAI for the current PLMN or SNPN;
g) mapped S-NSSAI(s) for the rejected NSSAI for the current PLMN or an SNPN;
h) rejected NSSAI for the failed or revoked NSSAA;
i) for each access type:
1) allowed NSSAI for a PLMN or an SNPN;
2) mapped S-NSSAI(s) for the allowed NSSAI for a PLMN;
3) rejected NSSAI for the current registration area;
4) mapped S-NSSAI(s) for the rejected NSSAI for the current registration area;
5) rejected NSSAI for the maximum number of UEs reached; and
6) mapped S-NSSAI(s) for the rejected NSSAI for the maximum number of UEs
reached; and
j) for 3GPP access type:
1) NSAG information for the configured NSSAI for a PLMN or an SNPN.
**Non-cleartext IEs:** Information elements that are not cleartext IEs.
**Non-emergency PDU session:** Any PDU session which is not an emergency PDU
session.
**Onboarding SUCI:** SUCI derived from onboarding SUPI.
**Onboarding SUPI:** SUPI with the SUPI format \"network specific identifier\"
containing a network specific identifier or with the SUPI format \"IMSI\"
containing an IMSI, derived by a UE in SNPN access mode, from default UE
credentials for primary authentication and used to identify the UE during
initial registration for onboarding services in SNPN and while registered for
onboarding services in SNPN.
**PDU address:** An IP address assigned to the UE by the packet data network.
**PDU session for LADN:** A PDU session with a DNN associated with a LADN.
**PDU session with suspended user-plane resources:** A PDU session for which
user-plane resources were established or re-established, and for which data
radio bearers were suspended when transition to 5GMM-CONNECTED mode with RRC
inactive indication.
**Persistent PDU session:** either a non-emergency PDU session contains a GBR
QoS flow with QoS equivalent to QoS of teleservice 11 and where there is a
radio bearer associated with that PDU session over 3GPP access, or an
emergency PDU session where there is a radio bearer associated with that PDU
session over 3GPP access.
NOTE 4: An example of a persistent PDU session is a non-emergency PDU session
with 5QI = 1 where there is a radio bearer associated with that context.
**Procedure transaction identity:** An identity which is dynamically allocated
by the UE for the UE-requested 5GSM procedures or allocated by the UE or the
PCF for the UE policy delivery procedures. The procedure transaction identity
is released when the procedure is completed but it should not be released
immediately.
**RAT frequency selection priority index:** A parameter provided by the AMF to
the NG-RAN via the N2 reference point. The AMF selects an RFSP index for a
particular UE based on the subscribed RFSP index, the locally configured
operator\'s policies, the allowed NSSAI and the UE context information,
including the UE\'s usage setting, if received during the registration
procedure. Definition derived from 3GPP TS 23.501 [8].
**Registered for disaster roaming services:** **A UE is considered as
\"registered for disaster roaming services\"** when it has successfully
completed initial registration or mobility registration for disaster roaming
services.
**Registered for emergency services:** **A UE is considered as \"registered
for emergency services\"** when it has successfully completed initial
registration for emergency services.
**Registered for onboarding services in SNPN:** **A UE is considered as
\"registered for onboarding services in SNPN\"** when it has successfully
completed initial registration for onboarding services in SNPN. While
registered for onboarding services in SNPN, services other than the onboarding
services are not available.
**Registered PLMN** : The PLMN on which the UE performed the last successful
registration. The identity of the registered PLMN (MCC and MNC) is provided to
the UE within the GUAMI field of the 5G-GUTI.
**Rejected NSSAI:** Rejected NSSAI for the current PLMN or SNPN, rejected
NSSAI for the current registration area, rejected NSSAI for the failed or
revoked NSSAA or rejected NSSAI for the maximum number of UEs reached.
NOTE 5: Rejected NSSAI for the current PLMN or SNPN, rejected NSSAI for the
current registration area or rejected NSSAI for the maximum number of UEs
reached contains a set of S-NSSAI(s) associated with a PLMN identity or SNPN
identity for the current PLMN or SNPN and in roaming scenarios also contains a
set of mapped S-NSSAI(s) if available. Rejected NSSAI for the failed or
revoked NSSAA only contains a set of S-NSSAI(s) associated with a PLMN
identity or SNPN identity for the HPLMN or RSNPN.
**Rejected NSSAI for the current PLMN or SNPN:** A set of S-NSSAI(s) which was
included in the requested NSSAI by the UE and is sent by the AMF with the
rejection cause \"S-NSSAI not available in the current PLMN or SNPN\".
**Rejected NSSAI for the current registration area:** A set of S-NSSAI(s)
which was included in the requested NSSAI by the UE and is sent by the AMF
with the rejection cause \"S-NSSAI not available in the current registration
area\".
**Rejected NSSAI for the failed or revoked NSSAA** : A set of S-NSSAI(s) which
is sent by the AMF with the rejection cause \"S-NSSAI not available due to the
failed or revoked network slice-specific authentication and authorization\".
**Rejected NSSAI for the maximum number of UEs reached** : A set of S-NSSAI(s)
which was included in the requested NSSAI by the UE and is sent by the AMF
with the rejection cause \"S-NSSAI not available due to maximum number of UEs
reached\".
**Local release:** Release of a PDU session without peer-to-peer signalling
between the network and the UE.
NOTE 6: Local release can include communication among network entities.
**Removal of eCall only mode restriction:** All the limitations as described
in 3GPP TS 22.101 [2] for the eCall only mode do not apply any more.
**SNPN access operation mode** : SNPN access mode or access to SNPN over
non-3GPP access.
NOTE 7: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
**S-NSSAI based congestion control:** Type of congestion control at session
management level that is applied to reject session management requests from
UEs or release PDU sessions when the associated S-NSSAI and optionally the
associated DNN are congested. S-NSSAI based congestion control can be
activated at the SMF over session management level and also activated at the
AMF over mobility management level.
**Satellite NG-RAN RAT type:** In case of satellite NG-RAN access, RAT types
are used to distinguish different types of satellite NG-RAN access, as defined
in 3GPP TS 38.413 [31]. In this version of the specification, the defined
satellite NG-RAN RAT types are \"NR(LEO)\", \"NR(MEO)\" and \"NR(GEO)\".
**Selected core network type information:** A type of core network (EPC or
5GCN) selected by the UE NAS layer in case of an E-UTRA cell connected to both
EPC and 5GCN.
**UE supporting UAS services: A UE which supports an aerial vehicle, such as a
drone, with an onboard or built-in USIM and is able to perform UE NAS
functionalities specified in this specification. Upper layers of the UE
supporting UAS services are responsible for UAS related procedures, such as
UUAA and C2 authorization, for which the NAS layer of the UE supporting UAS
services performs the necessary NAS procedures.**
**UE configured for high priority access in selected PLMN:** A UE configured
with one or more access identities equal to 1, 2, or 11-15 applicable in the
selected PLMN as specified in subclause 4.5.2. Definition derived from 3GPP TS
22.261 [3].
**UE operating in single-registration mode in a network supporting N26
interface: A** UE, supporting both N1 mode and S1 mode. During the last
attach, tracking area update (see 3GPP TS 24.301 [15]) or registration
procedures, the UE has received either a 5GS network feature support IE with
IWK N26 bit set to \"interworking without N26 interface not supported\" or an
EPS network feature support IE with IWK N26 bit set to \"interworking without
N26 interface not supported\".
**UE using 5GS services with control plane CIoT 5GS optimization: A** UE that
is registered for 5GS services with the control plane CIOT 5GS optimization
accepted by the network.
**User-plane resources:** Resources established between the UE and the UPF.
The user-plane resources consist of one of the following:
\- user plane radio bearers via the Uu reference point, a tunnel via the N3
reference point and a tunnel via the N9 reference point (if any) for 3GPP
access;
\- IPsec tunnels via the NWu reference point, a tunnel via the N3 reference
point and a tunnel via the N9 reference point (if any) for untrusted non-3GPP
access;
\- IPsec tunnels via the NWt reference point, a tunnel via the N3 reference
point and a tunnel via the N9 reference point (if any) for trusted non-3GPP
access used by the UE;
\- a layer-2 connection via the Yt reference point, a layer-2 or layer-3
connection via the Yw reference point, a tunnel via the N3 reference point and
a tunnel via the N9 reference point (if any) for trusted non-3GPP access used
by the N5CW device;
\- W-UP resources via Y4 reference point, a tunnel via the N3 reference point
and a tunnel via the N9 reference point (if any) for wireline access used by
the 5G-RG; and
\- L-W-UP resources via Y5 reference point, a tunnel via the N3 reference
point and a tunnel via the N9 reference point (if any) for wireline access
used by the FN-RG.
**W-AGF acting on behalf of the N5GC device:** A W-AGF that enables an N5GC
device behind a 5G-CRG or an FN-CRG to connect to the 5G Core.
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 22.261 [3] apply:
**Non-public network**
**Disaster Roaming**
**satellite NG-RAN**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.003 [4] apply:
**5G-GUTI**
**5G-S-TMSI**
**5G-TMSI**
**Global Line Identifier (GLI)**
**Global Cable Identifier (GCI)**
**GUAMI**
**IMEI**
**IMEISV**
**IMSI**
**PEI**
**SUPI**
**SUCI**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.122 [5] apply:
**CAG selection**
**Country**
**EHPLMN**
**HPLMN**
**Onboarding services in SNPN**
**Registered SNPN**
**Selected PLMN**
**Selected SNPN**
**Shared network**
**SNPN identity**
**Steering of Roaming (SOR)**
**Steering of roaming connected mode control information (SOR-CMCI)**
**Steering of Roaming information**
**Subscribed SNPN**
**Suitable cell**
**VPLMN**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.167 [6] apply:
**eCall over IMS**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.216 [6A] apply:
**SRVCC**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.401 [7] apply:
**eCall only mode**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.501 [8] apply:
**5G access network**
**5G core network**
**5G QoS flow**
**5G QoS identifier**
**5G-RG**
**5G-BRG**
**5G-CRG**
**5G System**
**Allowed area**
**Allowed NSSAI**
**AMF region**
**AMF set**
**Closed access group**
**Configured NSSAI**
**Credentials Holder (CH)**
**Default Credentials Server (DCS)**
**Group ID for Network Selection (GIN)**
**IAB-node**
**Local area data network**
**Network identifier (NID)**
**Network slice**
**NG-RAN**
**Non-allowed area**
**Onboarding Standalone Non-Public Network**
**PDU connectivity service**
**PDU session**
**PDU session type**
**Pending NSSAI**
**Requested NSSAI**
**Routing Indicator**
**Service data flow**
**Service Gap Control**
**Serving PLMN rate control**
**Small data rate control status**
**SNPN access mode**
**SNPN enabled UE**
**Stand-alone Non-Public Network**
**Time Sensitive Communication**
**Time Sensitive Communication and Time Synchronization Function**
**UE-DS-TT residence time**
**UE-Slice-MBR**
**UE presence in LADN service area**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.503 [10] apply:
**UE local configuration**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.008 [12] apply:
**GMM**
**MM**
**A/Gb mode**
**Iu mode**
**GPRS**
**Non-GPRS**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.301 [15] apply:
**CIoT EPS optimization**
**Control plane CIoT EPS optimization**
**EENLV**
**EMM**
**EMM-DEREGISTERED**
**EMM-DEREGISTERED-INITIATED**
**EMM-IDLE mode**
**EMM-NULL**
**EMM-REGISTERED**
**EMM-REGISTERED-INITIATED**
**EMM-SERVICE-REQUEST-INITIATED**
**EMM-TRACKING-AREA-UPDATING-INITIATED**
**EPS**
**EPS security context**
**EPS services**
**Lower layer failure**
**Megabit**
**Message header**
**NAS signalling connection recovery**
**Native GUTI**
**NB-S1 mode**
**Non-EPS services**
**S1 mode**
**User plane CIoT EPS optimization**
**WB-S1 mode**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 33.501 [24] apply:
**5G security context**
**5G NAS security context**
**ABBA**
**Current 5G NAS security context**
**Default UE credentials for primary authentication**
**Default UE credentials for secondary authentication**
**Full native 5G NAS security context**
**K\'** ~AME~
**K** ~AMF~
**K** ~ASME~
**Mapped 5G NAS security context**
**Mapped security context**
**Native 5G NAS security context**
**NCC**
**Non-current 5G NAS security context**
**Partial native 5G NAS security context**
**RES***
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 38.413 [31] apply:
**NG connection**
**User Location Information**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.587 [19B] apply:
**E-UTRA-PC5**
**NR-PC5**
**V2X**
For the purposes of the present document, the following terms and its
definitions given in 3GPP TS 23.256 [6AB] apply:
**3GPP UAV ID**
**CAA (Civil Aviation Administration)-Level UAV Identity**
**Command and Control (C2) Communication**
**UAV controller (UAV-C)**
**UAS Services**
**UAS Service Supplier (USS)**
**Uncrewed Aerial System (UAS)**
**USS communication**
**UUAA**
**UUAA-MM**
**UUAA-SM**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.554 [19E] apply:
**5G ProSe**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.548 [10A] apply:
**Edge Application Server**
**Edge DNS Client**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.526 [19] apply:
**Non-subscribed SNPN signalled URSP**
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
4G-GUTI 4G-Globally Unique Temporary Identifier
5GCN 5G Core Network
5G-GUTI 5G-Globally Unique Temporary Identifier
5GMM 5GS Mobility Management
5G-RG 5G Residential Gateway
5G-BRG 5G Broadband Residential Gateway
5G-CRG 5G Cable Residential Gateway
5GS 5G System
5GSM 5GS Session Management
5G-S-TMSI 5G S-Temporary Mobile Subscription Identifier
5G-TMSI 5G Temporary Mobile Subscription Identifier
5QI 5G QoS Identifier
ACS Auto-Configuration Server
AKA Authentication and Key Agreement
AKMA Authentication and Key Management for Applications
A-KID AKMA Key Identifier
A-TID _AKMA Temporary Identifier_
AMBR Aggregate Maximum Bit Rate
AMF Access and Mobility Management Function
APN Access Point Name
AS Access stratum
ATSSS Access Traffic Steering, Switching and Splitting
AUSF Authentication Server Function
CAG Closed access group
CGI Cell Global Identity
CHAP Challenge Handshake Authentication Protocol
CP-PRUK Control Plane ProSe Remote User Key
DDX Downlink Data Expected
DL Downlink
DN Data Network
DNN Data Network Name
DNS Domain Name System
eDRX Extended DRX cycle
DS-TT Device-Side TSN Translator
EUI Extended Unique Identifier
E-UTRAN Evolved Universal Terrestrial Radio Access Network
EAC Early Admission Control
EAP-AKA\' Improved Extensible Authentication Protocol method for 3rd
generation Authentication and Key Agreement
EAS Edge Application Server
EASDF Edge Application Server Discovery Function
ECIES Elliptic Curve Integrated Encryption Scheme
ECS Edge Configuration Server
ECSP Edge Computing Service Provider
EDC Edge DNS Client
EEC Edge Enabler Client
EPD Extended Protocol Discriminator
EMM EPS Mobility Management
EPC Evolved Packet Core Network
EPS Evolved Packet System
EPS-UPIP User-plane integrity protection in EPS
ESM EPS Session Management
FN-RG Fixed Network RG
FN-BRG Fixed Network Broadband RG
FN-CRG Fixed Network Cable RG
Gbps Gigabits per second
GEO Geostationary Orbit
GFBR Guaranteed Flow Bit Rate
GUAMI Globally Unique AMF Identifier
IAB Integrated access and backhaul
IMEI International Mobile station Equipment Identity
IMEISV International Mobile station Equipment Identity and Software Version
number
IMSI International Mobile Subscriber Identity
IP-CAN IP-Connectivity Access Network
KSI Key Set Identifier
LADN Local Area Data Network
LCS LoCation Services
LEO Low Earth Orbit
LMF Location Management Function
LPP LTE Positioning Protocol
MAC Message Authentication Code
MA PDU Multi-Access PDU
MBS Multicast/Broadcast Services
Mbps Megabits per second
MCS Mission Critical Service
MEO Medium Earth Orbit
MFBR Maximum Flow Bit Rate
MICO Mobile Initiated Connection Only
MINT Minimization of Service Interruption
MPS Multimedia Priority Service
MSK MBS Service Key
MTK MBS Traffic Key
MUSIM Multi-USIM
N3IWF Non-3GPP Inter-Working Function
N5CW Non-5G-Capable over WLAN
N5GC Non-5G Capable
NAI Network Access Identifier
NITZ Network Identity and Time Zone
ngKSI Key Set Identifier for Next Generation Radio Access Network
NPN Non-public network
NR New Radio
NSAC Network Slice Admission Control
NSACF Network Slice Admission Control Function
NSAG Network slice AS group
NSSAA Network slice-specific authentication and authorization
NSSAAF Network Slice-Specific and SNPN authentication and authorization
Function
NSSAI Network Slice Selection Assistance Information
NSSRG Network Slice Simultaneous Registration Group
**NSWO Non-Seamless WLAN Offload**
ON-SNPN Onboarding Standalone Non-Public Network
OS Operating System
OS Id OS Identity
PAP Password Authentication Protocol
PCO Protocol Configuration Option
PEI Permanent Equipment Identifier
PEIPS Paging Early Indication with Paging Subgrouping
PNI-NPN Public Network Integrated Non-Public Network
ProSe Proximity based Services
ProSeP 5G ProSe policy
PTI Procedure Transaction Identity
PVS Provisioning Server
QFI QoS Flow Identifier
QoS Quality of Service
QRI QoS Rule Identifier
RACS Radio Capability Signalling Optimisation
(R)AN (Radio) Access Network
RFSP RAT Frequency Selection Priority
RG Residential Gateway
RPLMN Registered PLMN
RQA Reflective QoS Attribute
RQI Reflective QoS Indication
RSC Relay Service Code
RSN Redundancy Sequence Number
RSNPN Registered SNPN
S-NSSAI Single NSSAI
SA Security Association
SDF Service Data Flow
SDT Small Data Transmission
SMF Session Management Function
SGC Service Gap Control
SNN Serving Network Name
SNPN Stand-alone Non-Public Network
SOR Steering of Roaming
SOR-CMCI Steering of Roaming Connected Mode Control Information
SUCI Subscription Concealed Identifier
SUPI Subscription Permanent Identifier
TA Tracking Area
TAC Tracking Area Code
TAI Tracking Area Identity
Tbps Terabits per second
TMGI Temporary Mobile Group Identity
TNGF Trusted Non-3GPP Gateway Function
TSC Time Sensitive Communication
TSCTSF Time Sensitive Communication and Time Synchronization Function
TWIF Trusted WLAN Interworking Function
TSN Time-Sensitive Networking
UAS Uncrewed Aerial System
UAV Uncrewed Aerial Vehicle
UAV-C Uncrewed Aerial Vehicle-Controller
UDM Unified Data Management
UL Uplink
UPDS UE policy delivery service
UPF User Plane Function
UP-PRUK User Plane ProSe Remote User Key
UPSC UE Policy Section Code
UPSI UE Policy Section Identifier
URN Uniform Resource Name
URSP UE Route Selection Policy
USS UAS Service Supplier
UUAA USS UAV Authorization/Authentication
V2X Vehicle-to-Everything
V2XP V2X policy
W-AGF Wireline Access Gateway Function
WLAN Wireless Local Area Network
WUS Wake-up signal
# 4 General
## 4.1 Overview
The non-access stratum (NAS) described in the present document forms the
highest stratum of the control plane between UE and AMF (reference point
\"N1\" see 3GPP TS 23.501 [8]) for both 3GPP and non-3GPP access.
Main functions of the protocols that are part of the NAS are:
\- support of mobility of the user equipment (UE) including also common
procedures such as authentication, identification, generic UE configuration
update and security mode control procedures;
\- support of session management procedures to establish and maintain data
connectivity between the UE and the data network; and
\- NAS transport procedure to provide a transport of SMS, LPP, LCS, UE policy
container, SOR transparent container and UE parameters update information
payload.
Principles for the handing of 5GS security contexts and for the activation of
ciphering and integrity protection, when a NAS signalling connection is
established, are provided in subclause 4.4.
For the support of the above functions, the following procedures are supplied
within this specification:
\- elementary procedures for 5GS mobility management in clause 5; and
\- elementary procedures for 5GS session management in clause 6.
Signalling procedures for the control of NAS security are described as part of
the 5GMM common procedures in subclause 5.4.
Complete NAS transactions consist of specific sequences of elementary
procedures. Examples of such specific sequences can be found in 3GPP TS 23.502
[9].
The NAS for 5GS follows the protocol architecture model for layer 3 as
described in 3GPP TS 24.007 [11].
## 4.2 Coordination between the protocols for 5GS mobility management and 5GS
session management
A 5GS session management (5GSM) message is piggybacked in specific 5GS
mobility management (5GMM) transport messages. To this purpose, the 5GSM
messages can be transmitted in an information element in the 5GMM transport
messages. In this case, the UE, the AMF and the SMF execute the 5GMM procedure
and the 5GSM procedure in parallel. The success of the 5GMM procedure is not
dependent on the success of the piggybacked 5GSM procedure.
The UE can only initiate the 5GSM procedure when there is a 5GMM context
established at the UE.
During 5GMM procedures, the UE and the AMF shall suspend the transmission of
5GSM messages, except when:
a) the 5GMM procedure is piggybacking 5GSM messages; or
b) the UE is in 5GMM-CONNECTED mode and a service request procedure for re-
establishing user-plane resources of PDU session(s) is initiated without
including PDU session status IE or Allowed PDU session status IE. In this
case, the UE and the AMF need not suspend the transmission of 5GSM messages
related to other PDU session(s) than the one(s) for which the user- plane
resources re-establishment is requested.
If the UE determines to locally release the N1 NAS signalling connection upon
receiving an SOR transparent container during a registration procedure as
specified in 3GPP TS 23.122 [5] Annex C.2, the UE shall suspend the
transmission of 5GSM messages after sending the REGISTRATION COMPLETE message
and until the N1 NAS signalling connection is released to obtain service on a
higher priority PLMN, with the exception of the case when the UE has an
emergency PDU session.
A 5GMM message piggybacking a 5GSM message for a PDU session shall be
delivered via the access associated with the PDU session, if any, with the
following exceptions:
a) the AMF shall send, via 3GPP access, a DL NAS TRANSPORT message
piggybacking a downlink 5GSM message of a network-requested 5GSM procedure for
a PDU session associated with non-3GPP access if the conditions specified in
subclause 5.5.1.3.4 or subclause 5.6.1.4 are met;
b) the UE shall send an UL NAS TRANSPORT message piggybacking a response
message to the 5GSM message described in a) via either:
1) 3GPP access; or
2) non-3GPP access if the UE is in 5GMM-CONNECTED mode over non-3GPP access;
and
NOTE: The interaction between the 5GMM sublayer and the 5GSM sublayer to
enable the UE to send the UL NAS TRANSPORT message containing the response
message via 3GPP access is required. This is achieved via UE implementation.
c) the UE shall send, via the target access, an UL NAS TRANSPORT message
piggybacking a 5GSM message associated with a request type set to \"existing
PDU session\" or \"existing emergency PDU session\" for handover of an
existing PDU session between 3GPP access and non-3GPP access.
A 5GMM message piggybacking a 5GSM message as a response message to a request
message associated with an MA PDU session, shall be delivered via the same
access that the initial message was received.
## 4.3 UE domain selection
### 4.3.1 UE\'s usage setting
The UE\'s usage setting defined in 3GPP TS 24.301 [15] applies to voice
capable UEs in 5GS and indicates whether the UE has preference for voice
services over data services or vice-versa, where:
a) voice services include IMS voice; and
b) data services include any kind of user data transfer without a voice media
component.
The UE\'s usage setting can be set to:
a) \"voice centric\"; or
b) \"data centric\".
If the UE is capable of S1 mode, there is a single UE\'s usage setting at the
UE which applies to both 5GS and EPS.
### 4.3.2 Domain selection for UE originating sessions / calls
The behaviour of the UE for domain selection is determined by:
a) the UE usage setting;
b) the availability of IMS voice; and
c) whether the UE operates in single-registration mode or dual-registration
mode (see 3GPP TS 23.501 [8]).
In the present document the condition \"the UE supports IMS voice over 3GPP
access\" evaluates to \"true\" if at least one of the following is fulfilled:
1) the UE supports IMS voice over NR connected to 5GCN;
2) the UE supports IMS voice over E-UTRA connected to 5GCN; or
3) the UE supports IMS voice in EPS.
In the present document the condition \"the UE does not support IMS voice over
3GPP access\" evaluates to \"true\" if the condition \"the UE supports IMS
voice over 3GPP access\" evaluates to \"false\".
In the present document the condition \"the UE supports IMS voice over
non-3GPP access\" evaluates to \"true\" if the UE supports IMS voice over
non-3GPP access connected to 5GCN.
In the present document the condition \"the UE does not support IMS voice over
non-3GPP access\" evaluates to \"true\" if the condition \"the UE supports IMS
voice over non-3GPP access\" evaluates to \"false\".
In the present document, \"IMS voice not available\" is determined per access
type independently, i.e. 3GPP access or non-3GPP access.
In the present document, \"IMS voice not available\" refers to one of the
following conditions:
a) the UE does not support IMS voice;
b) the UE supports IMS voice, but the network indicates in the REGISTRATION
ACCEPT message that IMS voice over PS sessions are not supported; or
c) the UE supports IMS voice, the network indicates in the REGISTRATION ACCEPT
message that IMS voice over PS sessions are supported, but the upper layers:
1) provide no indication that the UE is available for voice call in the IMS
within a manufacturer determined period of time; or
2) indicate that the UE is not available for voice calls in the IMS.
NOTE 1: If conditions a and b evaluate to false, the upper layers need time to
attempt IMS registration. In the event an indication from the upper layers
that the UE is available for voice calls in the IMS takes longer than the
manufacturer determined period of time (e.g. due to delay when attempting IMS
registration or due to delay in obtaining a QoS flow for SIP signalling), the
NAS layer assumes the UE is not available for voice calls in the IMS.
Other conditions may exist but these are implementation specific.
In the present document, \"IMS voice available\" applies when \"IMS voice not
available\" does not apply.
When IMS voice is not available over 3GPP access, if the UE\'s usage setting
is \"voice centric\", the UE operates in single-registration mode, and the UE:
a) does not have a persistent PDU session, and:
1) if the UE is only registered over 3GPP access, or if the UE is registered
over both 3GPP access and non-3GPP access and IMS voice is not available over
non-3GPP access, the UE shall disable the N1 mode capability for 3GPP access
and proceed as specified in subclause 4.9.2 with modifications described
below;. or
2) if the UE is registered over both 3GPP access and non-3GPP access and IMS
voice is available over non-3GPP access, the UE may disable the N1 mode
capability for 3GPP access and proceed as specified in subclause 4.9.2 with
modifications described below; or
b) has a persistent PDU session, then the UE waits until the radio bearer
associated with the persistent PDU session has been released. When the radio
bearer associated with the persistent PDU session has been released, then:
1) if the UE is only registered over 3GPP access, or if the UE is registered
over both 3GPP access and non-3GPP access and IMS voice is not available over
non-3GPP access,the UE shall disable the N1 mode capability for 3GPP access
and proceed as specified in subclause 4.9.2 with modifications described
below; or
2) If the UE is registered over both 3GPP access and non-3GPP access and IMS
voice is available over non-3GPP access, the UE may disable the N1 mode
capability for 3GPP access and proceed as specified in subclause 4.9.2 with
modifications described below.
The following modifications are applied to the procedure in subclause 4.9.2
for disabling the N1 mode capability for 3GPP access, if the UE\'s usage
setting is \"voice centric\" and the UE operates in single-registration mode:
a) in item a) of subclause 4.9.2, the UE shall attempt to select an E-UTRA
cell connected to EPC. If such a cell is found, the UE shall then perform
voice domain selection procedures as defined in 3GPP TS 24.301 [15]; and
b) in item b) of subclause 4.9.2, if an E-UTRA cell connected to EPC cannot be
found, the UE shall attempt to select another supported radio access
technology which supports voice services.
When IMS voice is not available over non-3GPP access, if the UE\'s usage
setting is \"voice centric\" and the UE operates in single-registration mode,
then:
a) if the UE is only registered over non-3GPP access, the UE shall disable the
N1 mode capability for non-3GPP access (see subclause 4.9.3); or
b) if the UE is registered over both 3GPP access and non-3GPP access and IMS
voice is not available also over 3GPP access, the UE may disable the N1 mode
capability for non-3GPP access (see subclause 4.9.3).
NOTE 2: The UE can register over 3GPP access in another mode, e.g., S1 mode,
for voice service, and in this case the UE can keep the N1 mode capability for
non-3GPP access enabled.
### 4.3.3 Change of UE\'s usage setting
If the UE operates in single-registration mode, whenever the UE\'s usage
setting changes, the UE shall execute procedures according to table 4.3.3.1:
Table 4.3.3.1: Change of UE\'s usage setting for a UE in single-registration
mode
+----------------------------------+----------------------------------+ | UE\'s usage setting change | Procedure to execute | +----------------------------------+----------------------------------+ | From \"data centric\" to \"voice | Disable the N1 mode capability | | centric\" and \"IMS voice not | for 3GPP access (see | | available\" over 3GPP access | subclause 4.9.2), if the UE is | | only | only registered over 3GPP access | | | (NOTE) | +----------------------------------+----------------------------------+ | From \"data centric\" to \"voice | Disable the N1 mode capability | | centric\", and \"IMS voice not | for 3GPP access (see | | available\" over both 3GPP | subclause 4.9.2) and non-3GPP | | access and non-3GPP access | access (see subclause 4.9.3), if | | | the UE is registered over both | | | 3GPP access and non-3GPP access | | | | | | Disable the N1 mode capability | | | for 3GPP access (see subclause | | | 4.9.2), if the UE is only | | | registered over 3GPP access. | | | | | | Disable the N1 mode capability | | | for non-3GPP access (see | | | subclause 4.9.3), if the UE is | | | only registered over non-3GPP | | | access. | | | | | | (NOTE) | +----------------------------------+----------------------------------+ | From \"voice centric\" to \"data | Re-enable the N1 mode capability | | centric\" and the N1 mode | for 3GPP access (see | | capability for 3GPP access is | subclause 4.9.2) | | disabled at the UE due to \"IMS | | | voice not available\" | | +----------------------------------+----------------------------------+ | From \"data centric\" to \"voice | Disable the N1 mode capability | | centric\" and \"IMS voice not | for non-3GPP access (see | | available\" over non-3GPP access | subclause 4.9.3), if the UE is | | only | only registered over non-3GPP | | | access | +----------------------------------+----------------------------------+ | From \"voice centric\" to \"data | Re-enable the N1 mode capability | | centric\", and the N1 mode | for non-3GPP access (see | | capability for non-3GPP access | subclause 4.9.3) | | is disabled at the UE due to | | | \"IMS voice not available\" | | +----------------------------------+----------------------------------+ | NOTE: If the UE is registered | | | over 3GPP access and has a | | | persistent PDU session, then the | | | UE waits until the radio bearer | | | associated with the persistent | | | PDU session has been released. | | +----------------------------------+----------------------------------+
### 4.3.4 Change or determination of IMS voice availability
If the UE operates in single-registration mode, whenever the IMS voice
availability is determined or changes, the UE shall execute procedures
according to table 4.3.4.1:
Table 4.3.4.1: Change of IMS voice availability for a UE in single-
registration mode
+----------------------------------+----------------------------------+ | Change of IMS voice available | Procedure to execute | | condition | | +----------------------------------+----------------------------------+ | \"IMS voice not available\" over | Disable the N1 mode capability | | 3GPP access only and the UE\'s | for 3GPP access, if the UE is | | usage setting is \"voice | only registered over 3GPP access | | centric\" | (see subclause 4.9.2). (NOTE 2) | +----------------------------------+----------------------------------+ | \"IMS voice not available\" over | Disable the N1 mode capability | | non-3GPP access only and the | for non-3GPP access (see | | UE\'s usage setting is \"voice | subclause 4.9.3), if the UE is | | centric\" | only registered over non-3GPP | | | access. (NOTE 2) | +----------------------------------+----------------------------------+ | \"IMS voice not available\" over | Disable the N1 mode capability | | both 3GPP access and non-3GPP | for 3GPP access (see | | access, and the UE\'s usage | subclause 4.9.2) and non-3GPP | | setting is \"voice centric\" | access (see subclause 4.9.3), if | | | the UE is registered over both | | | 3GPP access and non-3GPP access. | | | | | | Disable the N1 mode capability | | | for 3GPP access (see | | | subclause 4.9.2), if the UE is | | | only registered over 3GPP access | | | | | | Disable the N1 mode capability | | | for non-3GPP access (see | | | subclause 4.9.3), if the UE is | | | only registered over non-3GPP | | | access. | | | | | | (NOTE 1, NOTE 2) | +----------------------------------+----------------------------------+ | NOTE 1: If the UE is registered | | | over 3GPP access and has a | | | persistent PDU session, then the | | | UE waits until the radio bearer | | | associated with the persistent | | | PDU session has been released. | | | | | | NOTE 2: If the UE determines | | | \"IMS voice not available\" upon | | | receipt of a 5GS session | | | management reject message | | | including a back-off timer | | | value, and the re-attempt | | | indicator indicates that the UE | | | is not allowed to re-attempt the | | | procedure in S1 mode then, upon | | | inter-system change from N1 mode | | | to S1 mode, the UE proceeds as | | | specified in | | | 3GPP TS 24.301 [15], | | | subclause 4.3.2.4, Change or | | | determination of IMS | | | registration status. | | +----------------------------------+----------------------------------+
## 4.4 NAS security
### 4.4.1 General
This clause describes the principles for the handling of 5G NAS security
contexts in the UE and in the AMF, the procedures used for the security
protection of NAS messages between the UE and the AMF, and the procedures used
for the protection of NAS IEs between the UE and the UDM. Security protection
involves integrity protection and ciphering of the 5GMM messages. 5GSM
messages are security protected indirectly by being piggybacked by the
security protected 5GMM messages (i.e. UL NAS TRANSPORT message and the DL NAS
TRANSPORT message).
The signalling procedures for the control of NAS security are part of the 5GMM
protocol and are described in detail in clause 5.
NOTE: The use of ciphering in a network is an operator option. In this
subclause, for the ease of description, it is assumed that ciphering is used,
unless explicitly indicated otherwise. Operation of a network without
ciphering is achieved by configuring the AMF so that it always selects the
\"null ciphering algorithm\", 5G-EA0.
### 4.4.2 Handling of 5G NAS security contexts
#### 4.4.2.1 General
The security parameters for authentication, integrity protection and ciphering
are tied together in a 5G NAS security context and identified by a key set
identifier (ngKSI). The relationship between the security parameters is
defined in 3GPP TS 33.501 [24].
Before security can be activated, the AMF and the UE need to establish a 5G
NAS security context. Usually, the 5G NAS security context is created as the
result of a primary authentication and key agreement procedure between the AMF
and the UE. A new 5G NAS security context may also be created during an N1
mode to N1 mode handover. Alternatively, during inter-system change from S1
mode to N1 mode, the AMF not supporting interworking without N26 and the UE
operating in single-registration mode may derive a mapped 5G NAS security
context from an EPS security context that has been established while the UE
was in S1 mode.
The 5G NAS security context is taken into use by the UE and the AMF, when the
AMF initiates a security mode control procedure, during an N1 mode to N1 mode
handover, or during the inter-system change procedure from S1 mode to N1 mode.
The 5G NAS security context which has been taken into use by the network most
recently is called current 5G NAS security context. This current 5G NAS
security context can be of type native or mapped, i.e. originating from a
native 5G NAS security context or mapped 5G NAS security context.
The key set identifier ngKSI is assigned by the AMF either during the primary
authentication and key agreement procedure or, for the mapped 5G NAS security
context, during the inter-system change. The ngKSI consists of a value and a
type of security context parameter indicating whether a 5G NAS security
context is a native 5G NAS security context or a mapped 5G NAS security
context. When the 5G NAS security context is a native 5G NAS security context,
the ngKSI has the value of KSI~AMF~, and when the current 5G NAS security
context is of type mapped, the ngKSI has the value of KSI~ASME~.
The 5G NAS security context which is indicated by an ngKSI can be taken into
use to establish the secure exchange of NAS messages when a new N1 NAS
signalling connection is established without executing a new primary
authentication and key agreement procedure (see subclause 5.4.1) or when the
AMF initiates a security mode control procedure. For this purpose, the initial
NAS messages (i.e. REGISTRATION REQUEST, DEREGISTRATION REQUEST, SERVICE
REQUEST and CONTROL PLANE SERVICE REQUEST) and the SECURITY MODE COMMAND
message contain an ngKSI in the ngKSI IE indicating the current 5G NAS
security context used to integrity protect the NAS message.
In the present document, when the UE is required to delete an ngKSI, the UE
shall set the ngKSI to the value \"no key is available\" and consider also the
associated keys K~AMF~ or K\'~AMF~, 5G NAS ciphering key and 5G NAS integrity
key invalid (i.e. the 5G NAS security context associated with the ngKSI as no
longer valid). In the initial registration procedure, when the key K~AUSF,~ is
invalid, the UE shall delete the ngKSI.
NOTE: In some specifications the term ciphering key sequence number might be
used instead of the term key set identifier (KSI).
As described in subclause 4.8 in order to interwork with E-UTRAN connected to
EPC, the UE supporting both S1 mode and N1 mode can operate in either single-
registration mode or dual-registration mode. A UE operating in dual-
registration mode shall independently maintain and use both EPS security
context (see 3GPP TS 24.301 [15]) and 5G NAS security context. When the UE
operating in dual-registration mode performs an EPS attach procedure, it shall
take into use an EPS security context and follow the handling of this security
context as specified in 3GPP TS 24.301 [15]. However, when the UE operating in
dual-registration mode performs an initial registration procedure, it shall
take into use a 5G NAS security context and follow the handling of this
security context as described in the present specification.
The UE and the AMF need to be able to maintain two 5G NAS security contexts
simultaneously, i.e. a current 5G NAS security context and a non-current 5G
NAS security context, since:
a) after a 5G re-authentication, the UE and the AMF can have both a current 5G
NAS security context and a non-current 5G NAS security context which has not
yet been taken into use (i.e. a partial native 5G NAS security context); and
b) after an inter-system change from S1 mode to N1 mode, the UE and the AMF
can have both a mapped 5G NAS security context, which is the current 5G NAS
security context, and a non-current native 5G NAS security context that was
created during a previous access in N1 mode.
The number of 5G NAS security contexts that need to be maintained
simultaneously by the UE and the AMF is limited by the following requirements:
a) after a successful 5G (re-)authentication, which creates a new partial
native 5G NAS security context, the AMF and the UE shall delete the non-
current 5G NAS security context, if any;
b) when a partial native 5G NAS security context is taken into use through a
security mode control procedure, the AMF shall delete the previously current
5G NAS security context. If the UE does not support multiple records of NAS
security context storage for multiple registration (see 3GPP TS 31.102 [22]),
the UE shall delete the previously current 5G NAS security context. If the UE
supports multiple records of NAS security context storage for multiple
registration, the UE shall:
1) replace the previously current 5G NAS security context stored in the first
5G security context of that access (see 3GPP TS 31.102 [22]) with the new 5G
security context (taken into use through a security mode control procedure),
when the UE activates the new 5G security context for the same PLMN and
access; or
2) store the previously current 5G NAS security context in the second 5G
security context of that access (see 3GPP TS 31.102 [22]) and store the new 5G
security context (taken into use through a security mode control procedure) in
the first 5G security context, when the UE activates the new 5G security
context for a different PLMN over that access but the previously current 5G
NAS security context is associated with the 5G-GUTI of the other access;
c) when the AMF and the UE create a 5G NAS security context using \"null
integrity protection algorithm\" and \"null ciphering algorithm\" during an
initial registration procedure for emergency services, or a registration
procedure for mobility and periodic registration update for a UE that has an
emergency PDU session (see subclause 5.4.2.2), the AMF and the UE shall delete
the previous current 5G NAS security context;
d) when a new mapped 5G NAS security context or 5G NAS security context
created using \"null integrity protection algorithm\" and \"null ciphering
algorithm\" is taken into use during the inter-system change from S1 mode to
N1 mode, the AMF and the UE shall not delete the previously current native 5G
NAS security context, if any. Instead, the previously current native 5G NAS
security context shall become a non-current native 5G NAS security context,
and the AMF and the UE shall delete any partial native 5G NAS security
context;
If no previously current native 5G NAS security context exists, the AMF and
the UE shall not delete the partial native 5G NAS security context, if any;
e) when the AMF and the UE derive a new mapped 5G NAS security context during
inter-system change from S1 mode to N1 mode, the AMF and the UE shall delete
any existing current mapped 5G NAS security context;
f) when a non-current full native 5G NAS security context is taken into use by
a security mode control procedure, then the AMF and the UE shall delete the
previously current mapped 5G NAS security context;
g) when the UE or the AMF moves from 5GMM-REGISTERED to 5GMM-DEREGISTERED
state, if the current 5G NAS security context is a mapped 5G NAS security
context and a non-current full native 5G NAS security context exists, then the
non-current 5G NAS security context shall become the current 5G NAS security
context. Furthermore, the UE and the AMF shall delete any mapped 5G NAS
security context or partial native 5G NAS security context.
h) when the UE operating in single-registration mode in a network supporting
N26 interface performs an inter-system change from N1 mode to S1 mode:
1) if the UE has a mapped 5G NAS security context and the inter-system change
is performed in:
i) 5GMM-IDLE mode, the UE shall delete the mapped 5G NAS security context
after the successful completion of the tracking area update procedure or
attach procedure (see 3GPP TS 24.301 [15]); or
ii) 5GMM-CONNECTED mode, the UE shall delete the mapped 5G NAS security
context after the completion of the inter-system change.
After deletion of the mapped 5G NAS security context, if the UE has a non-
current full native 5G NAS security context, then the non-current full native
5G NAS security context shall become the current full native 5G NAS security
context; and
i) when the UE operating in single-registration mode in a network supporting
N26 interface performs an inter-system change from S1 mode to N1 mode in 5GMM-
IDLE mode, if the UE has a non-current full native 5G NAS security context,
then the UE shall make the non-current full native 5G NAS security context as
the current native 5G NAS security context. The UE shall delete the mapped 5G
NAS security context, if any.
If the UE is capable of registration over both 3GPP access and non-3GPP
access, the UE in the state 5GMM-DEREGISTERED over both 3GPP access and
non-3GPP access shall mark the 5G NAS security contexts of the 3GPP access and
the non-3GPP access on the USIM or in the non-volatile memory as invalid when
the UE initiates an initial registration procedure over either 3GPP access or
non-3GPP access as described in subclause 5.5.1.2 or when the UE leaves state
5GMM-DEREGISTERED for any other state except 5GMM-NULL over either 3GPP access
or non-3GPP access. Otherwise, the UE shall mark the 5G NAS security context
on the USIM or in the non-volatile memory as invalid when the UE initiates an
initial registration procedure as described in subclause 5.5.1.2 or when the
UE leaves state 5GMM-DEREGISTERED for any other state except 5GMM-NULL.
If the UE is capable of registration over both 3GPP access and non-3GPP
access, the UE shall store the current native 5G NAS security contexts of the
3GPP access and the non-3GPP access as specified in annex C and mark them as
valid only when the UE enters state 5GMM-DEREGISTERED from any other state
except 5GMM-NULL over both the 3GPP access and non-3GPP access or only when
the UE aborts the initial registration procedure without having left 5GMM-
DEREGISTERED over both the 3GPP access and non-3GPP access. Otherwise, the UE
shall store the current native 5G NAS security context as specified in annex C
and mark it as valid only when the UE enters state 5GMM-DEREGISTERED from any
other state except 5GMM-NULL or when the UE aborts the initial registration
procedure without having left 5GMM-DEREGISTERED.
#### 4.4.2.2 Establishment of a mapped 5G NAS security context during inter-
system change from S1 mode to N1 mode in 5GMM-CONNECTED mode
In order for the UE operating in single-registration mode in a network
supporting N26 interface to derive a mapped 5G NAS security context for an
inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the AMF
shall construct a mapped 5G NAS security context from the EPS security context
received from the source MME as indicated in 3GPP TS 33.501 [24]. The AMF
shall select the 5G NAS security algorithms and derive the 5G NAS keys (i.e.
K~NASenc~ and K~NASint~). The AMF shall define an ngKSI for the newly derived
K\'~AMF~ key such that the value field is taken from the eKSI of the K~ASME~
key and the type field is set to indicate a mapped security context and
associate this ngKSI with the newly created mapped 5G NAS security context.
The AMF shall then include the message authentication code, selected NAS
algorithms, NCC and generated ngKSI in the S1 mode to N1 mode NAS transparent
container IE (see subclause 9.11.2.9).
When the UE operating in single-registration mode in a network supporting N26
interface receives the command to perform inter-system change to N1 mode in
5GMM-CONNECTED mode, the UE shall derive a mapped K\'~AMF,~ as indicated in
3GPP TS 33.501 [24], using the K~ASME~ from the EPS security context.
Furthermore, the UE shall also derive the 5G NAS keys from the mapped K\'~AMF~
using the selected NAS algorithm identifiers included in the S1 mode to N1
mode NAS transparent container IE and associate this mapped 5G NAS security
context with the ngKSI value received. The UE shall then verify the received
NAS MAC. In case the received NAS MAC is not verified successfully (see
subclause 4.4.3.3) the UE shall discard the content of the received S1 mode to
N1 mode NAS transparent container IE and inform the lower layers that the
received S1 mode to N1 mode NAS transparent container is invalid.
When the UE operating in single-registration mode in a network supporting N26
interface has a PDN connection for emergency bearer services and has no
current EPS security context, the AMF shall set 5G-IA0 and 5G-EA0 as the
selected 5G NAS security algorithms in the S1 mode to N1 mode NAS transparent
container IE. The AMF shall create a locally generated K\'~AMF~. The AMF shall
set the ngKSI value of the associated security context to \"000\" and the type
of security context flag to \"mapped security context\" in the S1 mode to N1
mode NAS transparent container IE.
When the UE operating in single-registration mode in a network supporting N26
interface receives the command to perform inter-system change to N1 mode in
5GMM-CONNECTED mode (see 3GPP TS 38.331 [30]) and has a PDN connection for
emergency bearer services, if 5G-IA0 and 5G-EA0 as the selected 5G NAS
security algorithms are included in the S1 mode to N1 mode NAS transparent
container IE, the UE shall create a locally generated K\'~AMF~. Furthermore,
the UE shall set the ngKSI value of the associated security context to the KSI
value received.
After the new mapped 5G NAS security context is taken into use for the 3GPP
access following a successful inter system change from S1 mode to N1 mode in
5GMM-CONNECTED mode and the UE is registered with the same PLMN over the 3GPP
access and non-3GPP access:
a) if a native 5G NAS security context is used on the non-3GPP access and:
1) the UE is in 5GMM-IDLE mode over non-3GPP access, then the AMF and the UE
shall activate and take into use the new mapped 5G NAS security context on the
3GPP access for the non-3GPP access as described in 3GPP TS 33.501 [24] after
the AMF sends or the UE receives the REGISTRATION ACCEPT message respectively.
The UE and AMF shall keep the native 5G NAS security context which was used on
the non-3GPP access and make it a non-current native 5G NAS security context.
The non-current native 5G NAS security context may be re-activated later using
the security mode control procedure; or
2) the UE is in 5GMM-CONNECTED mode over non-3GPP access, in order to activate
the native 5G NAS security context over the 3GPP access that is active on the
non-3GPP access the AMF shall send the SECURITY MODE COMMAND message over the
3GPP access as described in 3GPP TS 33.501 [24]. The SECURITY MODE COMMAND
message shall include the same ngKSI to identify the native 5G NAS security
context that is used on the non-3GPP access; or
b) if a mapped 5G NAS security context is used on the non-3GPP access and:
1) the UE is in 5GMM-IDLE mode over non-3GPP access, the AMF and the UE shall
activate and take into use the new mapped 5G NAS security context active on
the 3GPP access for the non-3GPP access as described in 3GPP TS 33.501 [24]
after the AMF sends or the UE receives the REGISTRATION ACCEPT message
respectively; or
2) the UE is in 5GMM-CONNECTED mode over non-3GPP access, in order to activate
the same mapped 5G NAS security context over one access that is used on the
other access the AMF shall send the SECURITY MODE COMMAND message over one-
access as described in 3GPP TS 33.501 [24]. The SECURITY MODE COMMAND message
shall include the same ngKSI to identify the mapped 5G NAS security context
that is used over the other access.
If the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode is
not completed successfully, the AMF and the UE operating in single-
registration mode in a network supporting N26 interface shall delete the new
mapped 5G NAS security context.
#### 4.4.2.3 Establishment of a 5G NAS security context during N1 mode to N1
mode handover
During an N1 mode to N1 mode handover, the target AMF may derive a new 5G NAS
security context for which the target AMF creates a new 5G NAS security
context as indicated in 3GPP TS 33.501 [24].
When a new 5G NAS security context is derived using the same K~AMF~, the
target AMF includes the 8 least significant bits of the downlink NAS COUNT in
the Intra N1 mode NAS transparent container IE, and indicates that a new
K~AMF~ shall not be derived (see subclause 9.11.2.6). The AMF shall increment
the downlink NAS COUNT by one after creating the Intra N1 mode NAS transparent
container IE.
When a new 5G NAS security context is created from a new K~AMF~, the target
AMF includes the 8 least significant bits of the downlink NAS COUNT in the
Intra N1 mode NAS transparent container IE and indicates that a new K~AMF~
shall be derived (see subclause 9.11.2.6). The AMF shall then set both the
uplink and downlink NAS COUNT counters of this 5G NAS security context to
zero. The AMF shall increment the downlink NAS COUNT by one after creating the
Intra N1 mode NAS transparent container IE.
The target AMF also includes the ngKSI with the same value as the ngKSI
currently being used with the UE, the message authentication code, and the
selected NAS algorithms in the Intra N1 mode NAS transparent container IE.
When the UE receives a command to perform handover to NG-RAN including an
Intra N1 mode NAS transparent container IE (see subclause 9.11.2.6), the UE
derives a new 5G NAS security context as described in 3GPP TS 33.501 [24].
When the Intra N1 mode NAS transparent container IE indicates that a new
K~AMF~ needs to be derived, the UE shall set both the downlink NAS COUNT and
uplink NAS COUNT to zero after creating the new 5G NAS security context.
If the received Intra N1 mode NAS transparent container IE does not have a
valid NAS COUNT (see subclause 4.4.3.2) or the received NAS MAC is not
verified successfully (see subclause 4.4.3.3) the UE shall discard the content
of the received Intra N1 mode NAS transparent container IE, continue to use
the current 5G NAS security context, and inform the lower layers that the
received Intra N1 mode NAS transparent container is invalid.
NOTE 1: During N1 mode to N1 mode handover, the Intra N1 mode NAS transparent
container IE (see subclause 9.11.2.6) is equivalent to sending a SECURITY MODE
COMMAND message to the UE in order to derive and use a new 5G NAS security
context, optionally created with a new K~AMF~. The UE maintains the Selected
EPS NAS security algorithms until the UE receives a new Selected EPS NAS
security algorithms.
After the new 5G NAS security context is taken into use for 3GPP access
following a successful N1 mode to N1 mode handover and the UE is registered
with the same PLMN over the 3GPP access and non-3GPP access:
a) the UE is in 5GMM-IDLE mode over non-3GPP access, the AMF and the UE shall
activate and take into use the new 5G NAS security context over the non-3GPP
access as described in 3GPP TS 33.501 [24] after the AMF sends or the UE
receives the REGISTRATION ACCEPT message respectively. If the new 5G NAS
security context is created from a new K~AMF~, the AMF and the UE shall set
the downlink NAS COUNT and uplink NAS COUNT to zero also for the non-3GPP
access, otherwise the downlink NAS COUNT and uplink NAS COUNT for the non-3GPP
access are not changed; or
b) the UE is in 5GMM-CONNECTED mode over non-3GPP access, in order to activate
the new 5G NAS security context over the non-3GPP access that has been
activated for the 3GPP access the AMF shall send the SECURITY MODE COMMAND
message over the non-3GPP access as described in 3GPP TS 33.501 [24]. The
SECURITY MODE COMMAND message shall include the same ngKSI to identify the new
5G NAS security context that was activated over the 3GPP access and shall
include the horizontal derivation parameter indicating \"K~AMF~ derivation is
not required\". Otherwise, if the new 5G NAS security context is created from
a new K~AMF~, the AMF and the UE shall set the downlink NAS COUNT and uplink
NAS COUNT to zero for the non-3GPP access.
NOTE 2: Explicit indication \"K~AMF~ derivation is not required\" for the
non-3GPP access is to align security contexts within the UE without a
subsequent derivation of a new K~AMF~ in the non-3GPP access.
#### 4.4.2.4 Establishment of an EPS security context during inter-system
change from N1 mode to S1 mode in 5GMM-CONNECTED mode
In order for the UE operating in single-registration mode in a network
supporting N26 interface to derive a mapped EPS security context for an inter-
system change from N1 mode to S1 mode in 5GMM-CONNECTED mode, the AMF shall
prepare a mapped EPS security context for the target MME as indicated in 3GPP
TS 33.501 [24].
The AMF shall derive a K\'~ASME~ using the K~AMF~ key and the downlink NAS
COUNT of the current 5G NAS security context, include the corresponding NAS
sequence number in the N1 mode to S1 mode NAS transparent container IE (see
subclause 9.11.2.7) and then increments its stored downlink NAS COUNT value by
one.
NOTE: The creation of the N1 mode to S1 mode NAS transparent container and the
increment of the stored downlink NAS COUNT value by one are performed in prior
to transferring the mapped EPS security context to the MME.
The AMF shall select the NAS algorithms identifiers to be used in the target
MME after the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED
mode, for encryption and integrity protection. The uplink and downlink NAS
COUNT associated with the newly derived K\'~ASME~ key are set to the uplink
and downlink NAS COUNT value of the current 5G NAS security context,
respectively. The eKSI for the newly derived K\'~ASME~ key shall be defined
such as the value field is taken from the ngKSI and the type field is set to
indicate a mapped security context.
When the UE operating in single-registration mode in a network supporting N26
interface receives a command to perform inter-system change from N1 mode to S1
mode in 5GMM-CONNECTED mode, the UE shall derive the mapped EPS security
context, i.e. derive K\'~ASME~ from K~AMF~ using a downlink NAS COUNT based on
the NAS sequence number received in the N1 mode to S1 mode NAS transparent
container IE (see subclause 9.11.2.7) as described in 3GPP TS 33.501 [24]. The
UE shall set the uplink and downlink NAS COUNT values associated with the
newly derived K\'~ASME~ key to the uplink and downlink NAS COUNT values of the
current 5G NAS security context respectively. The eKSI for the newly derived
K\'~ASME~ key is defined such that the value field is taken from the ngKSI and
the type field is set to indicate a mapped security context. The UE shall also
derive the NAS keys as specified in 3GPP TS 33.401 [23A] using the EPS NAS
security algorithms identifiers that are stored in the UE\'s 5G NAS security
context.
If the received N1 mode to S1 mode NAS transparent container IE does not have
a valid NAS COUNT (see subclause 4.4.3.2) the UE shall discard the content of
the received N1 mode to S1 mode NAS transparent container IE and inform the
lower layers that the received N1 mode to S1 mode NAS transparent container is
invalid.
If the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode is
not completed successfully, the AMF and the UE shall delete the new mapped EPS
security context.
#### 4.4.2.5 Establishment of secure exchange of NAS messages
Secure exchange of NAS messages via a NAS signalling connection is usually
established by the AMF during the registration procedure by initiating a
security mode control procedure. After successful completion of the security
mode control procedure, all NAS messages exchanged between the UE and the AMF
are sent integrity protected using the current 5G security algorithms, and
except for the messages specified in subclause 4.4.5, all NAS messages
exchanged between the UE and the AMF are sent ciphered using the current 5G
security algorithms.
During inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode,
secure exchange of NAS messages is established between the AMF and the UE by:
a) the transmission of NAS security related parameters encapsulated in the AS
signalling from the AMF to the UE triggering the inter-system change in 5GMM-
CONNECTED mode (see 3GPP TS 33.501 [24]). The UE uses these parameters to
generate the mapped 5G NAS security context (see subclause 8.6.2 of 3GPP TS
33.501 [24]); and
b) after the inter-system change in 5GMM-CONNECTED mode, the transmission of a
REGISTRATION REQUEST message from the UE to the AMF. The UE shall send this
message integrity protected using the mapped 5G NAS security context and
further protect this message as specified in subclause 4.4.6 and subclause
5.5.1.3.2. After the AMF receives the REGISTRATION REQUEST message:
1) if the AMF decides to take the native 5G NAS security context into use, the
security mode control procedure is performed. From this time onward, all NAS
messages exchanged between the UE and the AMF are sent integrity protected
using the native 5G NAS security context, and except for the messages
specified in subclause 4.4.5, all NAS messages exchanged between the UE and
the AMF are sent ciphered using the native 5G NAS security context; or
2) if the AMF decides to take the mapped 5G NAS security context into use,
from this time onward, all NAS messages exchanged between the UE and the AMF
are sent integrity protected using the mapped 5G NAS security context, and
except for the messages specified in subclause 4.4.5, all NAS messages
exchanged between the UE and the AMF are sent ciphered using the mapped 5G NAS
security context.
During inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, if the
UE is operating in single-registration mode and:
a) if the UE has a valid native 5G NAS security context, the UE shall transmit
a REGISTRATION REQUEST message integrity protected with the native 5G NAS
security context. The UE shall include the ngKSI indicating the native 5G NAS
security context value in the REGISTRATION REQUEST message.
After receiving the REGISTRATION REQUEST message including the ngKSI
indicating a native 5G NAS security context value, the AMF shall check whether
the ngKSI included in the REGISTRATION REQUEST message belongs to a 5G NAS
security context available in the AMF, and shall verify the MAC of the
REGISTRATION REQUEST message. If the verification is successful, the AMF
deletes the EPS security context received from the source MME if any, and the
AMF re-establishes the secure exchange of NAS messages by either:
1) replying with a REGISTRATION ACCEPT message that is integrity protected and
ciphered using the native 5G NAS security context. From this time onward, all
NAS messages exchanged between the UE and the AMF are sent integrity protected
and except for the messages specified in subclause 4.4.5, all NAS messages
exchanged between the UE and the AMF are sent ciphered; or
2) initiating a security mode control procedure. This can be used by the AMF
to take a non-current 5G NAS security context into use or to modify the
current 5G NAS security context by selecting new NAS security algorithms.
b) if the UE has no valid native 5G NAS security context, the UE shall send
the REGISTRATION REQUEST message without integrity protection and encryption.
After receiving the REGISTRATION REQUEST message without integrity protection
and encryption:
1) if N26 interface is supported:
i) if an EPS security context received from the source MME does not include
the NAS security algorithms set to EIA0 and EEA0, the AMF shall either create
a fresh mapped 5G NAS security context (see subclause 8.6.2 of 3GPP TS 33.501
[24]) or trigger a primary authentication and key agreement procedure to
create a fresh native 5G NAS security context; or
ii) if an EPS security context received from the source MME includes the NAS
security algorithms set to EIA0 and EEA0, the AMF shall trigger a primary
authentication and key agreement procedure to create a fresh native 5G NAS
security context; or
2) if N26 interface is not supported, the AMF shall trigger a primary
authentication and key agreement procedure.
The newly created 5G NAS security context is taken into use by initiating a
security mode control procedure and this context becomes the current 5G NAS
security context in both the UE and the AMF. This re-establishes the secure
exchange of NAS messages.
During an N1 mode to N1 mode handover, secure exchange of NAS messages is
established between the AMF and the UE by:
\- the transmission of NAS security related parameters encapsulated in the AS
signalling from the target AMF to the UE triggering the N1 mode to N1 mode
handover (see 3GPP TS 33.501 [24]). The UE uses these parameters to create a
new 5G NAS security context.
The secure exchange of NAS messages shall be continued after N1 mode to N1
mode handover. It is terminated after inter-system change from N1 mode to S1
mode in 5GMM-CONNECTED mode or when the NAS signalling connection is released.
When a UE in 5GMM-IDLE mode establishes a new NAS signalling connection and
has a valid current 5G NAS security context, the UE shall transmit the initial
NAS message integrity protected with the current 5G NAS security context and
further protect this message as specified in subclause 4.4.6. The UE shall
include the ngKSI indicating the current 5G NAS security context value in the
initial NAS message. The AMF shall check whether the ngKSI included in the
initial NAS message belongs to a 5G NAS security context available in the AMF,
and shall verify the MAC of the NAS message. If the verification is
successful, the AMF may re-establish the secure exchange of NAS messages:
a) by replying with a NAS message that is integrity protected and ciphered
using the current 5G NAS security context. From this time onward, all NAS
messages exchanged between the UE and the AMF are sent integrity protected and
except for the messages specified in subclause 4.4.5, all NAS messages
exchanged between the UE and the AMF are sent ciphered; or
b) by initiating a security mode control procedure. This can be used by the
AMF to take a non-current 5G NAS security context into use or to modify the
current 5G NAS security context by selecting new NAS security algorithms.
When a UE attempts multiple registrations in the same or different serving
network, both the AMF and the UE shall follow the behavior specified in
subclause 6.3.2 of 3GPP TS 33.501 [24]. The UE may support multiple records of
NAS security context storage for multiple registration (see 3GPP TS 31.102
[22]). If the UE supports multiple records of NAS security context storage for
multiple registration, the UE can select the appropriate one among the stored
5G security contexts to protect the initial NAS message (see 3GPP TS 33.501
[24]).
NOTE: For the case when the UE has two records of NAS security context stored
and is attempting registration to the PLMN associated with the 5G-GUTI (or an
equivalent PLMN) for that access, the UE uses the first NAS security context
of that access to protect the initial NAS message. For the case when the UE
has two records of NAS security context stored and is attempting registration
to the PLMN associated with the second record (or an equivalent PLMN) of that
access, the UE uses the second NAS security context of that access to protect
the initial NAS message. For other cases when the UE has two records of NAS
security context stored and is attempting registration to a PLMN which is not
associated with any NAS security context record, the UE uses either record of
the NAS security context of that access to protect the initial NAS message.
#### 4.4.2.6 Change of security keys
When the AMF initiates a re-authentication to create a new 5G NAS security
context, the messages exchanged during the authentication procedure are
integrity protected and ciphered using the current 5G NAS security context, if
any.
Both UE and AMF shall continue to use the current 5G NAS security context,
until the AMF initiates a security mode control procedure. The SECURITY MODE
COMMAND message sent by the AMF includes the ngKSI of the new 5G NAS security
context to be used. The AMF shall send the SECURITY MODE COMMAND message
integrity protected with the new 5G NAS security context, but unciphered. When
the UE responds with a SECURITY MODE COMPLETE message, it shall send the
message integrity protected and ciphered with the new 5G NAS security context.
The AMF can also modify the current 5G NAS security context or take the non-
current native 5G NAS security context, if any, into use, by sending a
SECURITY MODE COMMAND message including the ngKSI of the 5G NAS security
context to be modified and including a new set of selected NAS security
algorithms. In this case the AMF shall send the SECURITY MODE COMMAND message
integrity protected with the modified 5G NAS security context, but unciphered.
When the UE replies with a SECURITY MODE COMPLETE message, it shall send the
message integrity protected and ciphered with the modified 5G NAS security
context.
### 4.4.3 Handling of NAS COUNT and NAS sequence number
#### 4.4.3.1 General
Each 5G NAS security context shall be associated with two separate counters
NAS COUNT per access type in the same PLMN: one related to uplink NAS messages
and one related to downlink NAS messages. If the 5G NAS security context is
used for access via both 3GPP and non-3GPP access in the same PLMN, there are
two NAS COUNT counter pairs associated with the 5G NAS security context. The
NAS COUNT counters use 24-bit internal representation and are independently
maintained by UE and AMF. The NAS COUNT shall be constructed as a NAS sequence
number (8 least significant bits) concatenated with a NAS overflow counter (16
most significant bits).
When NAS COUNT is input to NAS ciphering or NAS integrity algorithms it shall
be considered to be a 32-bit entity which shall be constructed by padding the
24-bit internal representation with 8 zeros in the most significant bits.
The value of the uplink NAS COUNT that is stored or read out of the USIM or
non-volatile memory as described in annex C, is the value that shall be used
in the next NAS message.
The value of the downlink NAS COUNT that is stored or read out of the USIM or
non-volatile memory as described in annex C, is the largest downlink NAS COUNT
used in a successfully integrity checked NAS message.
The value of the uplink NAS COUNT stored in the AMF is the largest uplink NAS
COUNT used in a successfully integrity checked NAS message.
The value of the downlink NAS COUNT stored in the AMF is the value that shall
be used in the next NAS message.
The NAS sequence number part of the NAS COUNT shall be exchanged between the
UE and the AMF as part of the NAS signalling. After each new or retransmitted
outbound SECURITY PROTECTED 5GS NAS MESSAGE message, the sender shall increase
the NAS COUNT number by one, except for the initial NAS messages if the lower
layers indicated the failure to establish the RRC connection (see 3GPP TS
38.331 [30]). Specifically, on the sender side, the NAS sequence number shall
be increased by one, and if the result is zero (due to wrap around), the
stored NAS overflow counter shall also be incremented by one (see subclause
4.4.3.5). If, through implementation-dependent means, the receiver determines
that the NAS message is a replay of an earlier NAS message, then the receiver
handles the received NAS message as described in subclause 4.4.3.2. Otherwise,
in order to determine the estimated NAS COUNT value to be used for integrity
verification of a received NAS message:
\- The sequence number part of the estimated NAS COUNT value shall be equal to
the sequence number in the received NAS message; and
\- If the receiver can guarantee that this NAS message was not previously
accepted, then the receiver may select the estimated NAS overflow counter so
that the estimated NAS COUNT value is lower than the stored NAS COUNT value;
otherwise, the receiver selects the estimated NAS overflow counter so that the
estimated NAS COUNT value is higher than the stored NAS COUNT value.
During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode,
when a mapped 5G NAS security context is derived and taken into use, the AMF
shall set both the uplink and downlink NAS COUNT counters of this 5G NAS
security context to zero. The UE shall set both the uplink and downlink NAS
COUNT counters of this 5G NAS security context to zero.
During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode,
the AMF shall increment the downlink NAS COUNT by one after it has created an
S1 mode to N1 mode NAS transparent container (see subclause 9.11.2.9).
During the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode,
the AMF shall increment the downlink NAS COUNT by one after it has created an
N1 mode to S1 mode NAS transparent container (see subclause 9.11.2.7).
During N1 mode to N1 mode handover:
a) if the new 5G NAS security context is created with the same K~AMF~, the AMF
shall signal the 8 least significant bits of the current downlink NAS COUNT
value in an Intra N1 mode NAS transparent container (see subclause 9.11.2.6).
The AMF shall then increment the downlink NAS COUNT by one; or
b) if the new 5G NAS security context is created with a new K~AMF~, the AMF
shall signal the 8 least significant bits of the current downlink NAS COUNT
value in an Intra N1 mode NAS transparent container (see subclause 9.11.2.6)
and shall then set both the uplink and downlink NAS COUNT counters of this 5G
NAS security context to zero. The AMF shall then increment the downlink NAS
COUNT by one. The UE shall also set both the uplink and downlink NAS COUNT
counters to zero.
NOTE: During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED
mode, the S1 mode to N1 mode NAS transparent container (see subclause
9.11.2.9) is treated as an implicit SECURITY MODE COMMAND message for the UE
and the AMF, and therefore the AMF regards the sending of the S1 mode to N1
mode NAS transparent container as the sending of an initial SECURITY MODE
COMMAND message in order to derive and take into use a mapped 5G NAS security
context for the purpose of the NAS COUNT handling.
#### 4.4.3.2 Replay protection
Replay protection shall be supported for received NAS messages both in the AMF
and the UE. However, since the realization of replay protection does not
affect the interoperability between nodes, no specific mechanism is required
for implementation.
Replay protection assures that one and the same NAS message is not accepted
twice by the receiver. Specifically, for a given 5G NAS security context, a
given NAS COUNT value shall be accepted at most one time and only if message
integrity verifies correctly.
Replay protection is not applicable when 5G-IA0 is used.
#### 4.4.3.3 Integrity protection and verification
The sender shall use its locally stored NAS COUNT as input to the integrity
protection algorithm.
The receiver shall use the NAS sequence number included in the received
message and an estimate for the NAS overflow counter as defined in subclause
4.4.3.1 to form the NAS COUNT input to the integrity verification algorithm.
The algorithm to calculate the integrity protection information is specified
in 3GPP TS 33.501 [24], and in case of the:
a) SECURITY PROTECTED 5GS NAS MESSAGE message, the integrity protection shall
include octet 7 to n, i.e. the Sequence number IE and the NAS message IE.
b) Intra N1 mode NAS transparent container IE and S1 mode to N1 mode NAS
transparent container IE, the integrity protection shall include all octets of
the value part of the IE starting from octet 7.
NOTE: To ensure backward compatibility, the UE uses all octets starting from
octet 7 in the received NAS transparent container for the purpose of integrity
check of the NAS transparent container irrespective of the release/version it
supports. After a successful integrity check, the UE can ignore the octets
which are not specified in the release/version which the UE supports.
In addition to the data that is to be integrity protected, the BEARER ID,
DIRECTION bit, NAS COUNT and 5G NAS integrity key are input to the integrity
protection algorithm. These parameters are described in 3GPP TS 33.501 [24].
After successful integrity protection validation, the receiver shall update
its corresponding locally stored NAS COUNT with the value of the estimated NAS
COUNT for this NAS message.
Integrity verification is not applicable when 5G-IA0 is used.
#### 4.4.3.4 Ciphering and deciphering
The sender shall use its locally stored NAS COUNT as input to the ciphering
algorithm.
The receiver shall use the NAS sequence number included in the received
message and an estimate for the NAS overflow counter as defined in subclause
4.4.3.1 to form the NAS COUNT input to the deciphering algorithm.
The input parameters to the NAS ciphering algorithm are the BEARER ID,
DIRECTION bit, NAS COUNT, NAS encryption key and the length of the key stream
to be generated by the encryption algorithm.
When applying initial NAS message protection to the REGISTRATION REQUEST or
SERVICE REQUEST message as described in subclause 4.4.6, the length of the key
stream is set to the length of the entire plain NAS message that is included
in the NAS message container IE, i.e. the value part of the NAS message
container IE, that is to be ciphered.
When applying initial NAS message protection to the CONTROL PLANE SERVICE
REQUEST message as described in subclause 4.4.6, the length of the key stream
is set to the length of:
a) the value part of the CIoT small data container IE that is to be ciphered;
or
b) the value part of the NAS message container IE that is to be ciphered.
#### 4.4.3.5 NAS COUNT wrap around
If, when increasing the NAS COUNT as specified above, the AMF detects that
either its downlink NAS COUNT or the UE\'s uplink NAS COUNT is \"close\" to
wrap around, (close to 2^24^), the AMF shall take the following actions:
\- If there is no non-current native 5G NAS security context with sufficiently
low NAS COUNT values, the AMF shall initiate a new primary authentication and
key agreement procedure with the UE, leading to a new established 5G NAS
security context and the NAS COUNT being reset to 0 in both the UE and the AMF
when the new 5G NAS security context is activated;
\- Otherwise, the AMF can activate a non-current native 5G NAS security
context with sufficiently low NAS COUNT values or initiate a new primary
authentication and key agreement procedure as specified above.
If for some reason a new K~AMF~ has not been established using primary
authentication and key agreement procedure before the NAS COUNT wraps around,
the node (AMF or UE) in need of sending a NAS message shall instead release
the NAS signalling connection. Prior to sending the next uplink NAS message,
the UE shall delete the ngKSI indicating the current 5G NAS security context.
When the 5G-IA0 is used as the NAS integrity algorithm, the UE and the AMF
shall allow NAS COUNT wrap around. If NAS COUNT wrap around occurs, the
following requirements apply:
a) the UE and the AMF shall continue to use the current 5G NAS security
context;
b) the AMF shall not initiate the primary authentication and key agreement
procedure;
c) the AMF shall not release the NAS signalling connection; and
d) the UE shall not perform a local release of the NAS signalling connection.
### 4.4.4 Integrity protection of NAS signalling messages
#### 4.4.4.1 General
For the UE, integrity protected signalling is mandatory for the 5GMM NAS
messages once a valid 5G NAS security context exists and has been taken into
use. For the network, integrity protected signalling is mandatory for the 5GMM
NAS messages once a secure exchange of 5GS NAS messages has been established
for the NAS signalling connection. Integrity protection of all NAS signalling
messages is the responsibility of the NAS. It is the network which activates
integrity protection.
The use of \"null integrity protection algorithm\" 5G-IA0 (see subclause
9.11.3.34) in the current 5G NAS security context is only allowed:
a) for an unauthenticated UE for which establishment of emergency services is
allowed;
b) for an W-AGF acting on behalf of an FN-RG; and
c) for a W-AGF acting on behalf of an N5GC device.
For setting the security header type in outbound NAS messages, the UE and the
AMF shall apply the same rules irrespective of whether the \"null integrity
protection algorithm\" or any other integrity protection algorithm is
indicated in the 5G NAS security context.
If the \"null integrity protection algorithm\"5G-IA0 has been selected as an
integrity protection algorithm, the receiver shall regard the NAS messages
with the security header indicating integrity protection as integrity
protected.
Details of the integrity protection and verification of NAS signalling
messages are specified in 3GPP TS 33.501 [24].
When a NAS message needs to be sent both ciphered and integrity protected, the
NAS message is first ciphered and then the ciphered NAS message and the NAS
sequence number are integrity protected by calculating the MAC.
NOTE: NAS messages that are ciphered with the \"null ciphering algorithm\"
5G-EA0 are regarded as ciphered (see subclause 4.4.5).
When a NAS message needs to be sent only integrity protected and unciphered,
the unciphered NAS message and the NAS sequence number are integrity protected
by calculating the MAC.
When a 5GSM message is piggybacked in a 5GMM message, there is only one
Sequence number IE and one Message authentication code IE for the 5GMM message
piggybacking the 5GSM message.
#### 4.4.4.2 Integrity checking of NAS signalling messages in the UE
Except the messages listed below, no NAS signalling messages shall be
processed by the receiving 5GMM entity in the UE or forwarded to the 5GSM
entity, unless the network has established secure exchange of 5GS NAS messages
for the NAS signalling connection:
a) IDENTITY REQUEST (if requested identification parameter is SUCI);
b) AUTHENTICATION REQUEST;
c) AUTHENTICATION RESULT;
d) AUTHENTICATION REJECT;
e) REGISTRATION REJECT (if the 5GMM cause is not #76 or #78);
f) DEREGISTRATION ACCEPT (for non switch off); and
g) SERVICE REJECT (if the 5GMM cause is not #76 or #78).
NOTE: These messages are accepted by the UE without integrity protection, as
in certain situations they are sent by the network before security can be
activated.
Integrity protection is never applied directly to 5GSM messages, but to the
5GMM message in which the 5GSM message is included.
Once the secure exchange of NAS messages has been established, the receiving
5GMM entity in the UE shall not process any NAS signalling messages unless
they have been successfully integrity checked by the NAS. If NAS signalling
messages, having not successfully passed the integrity check, are received,
then the NAS in the UE shall discard that message. The processing of the
SECURITY MODE COMMAND message that has not successfully passed the integrity
check is specified in subclause 5.4.2.5. If any NAS signalling message is
received as not integrity protected even though the secure exchange of NAS
messages has been established by the network, then the NAS shall discard this
message.
#### 4.4.4.3 Integrity checking of NAS signalling messages in the AMF
Except the messages listed below, no NAS signalling messages shall be
processed by the receiving 5GMM entity in the AMF or forwarded to the 5GSM
entity, unless the secure exchange of NAS messages has been established for
the NAS signalling connection:
a) REGISTRATION REQUEST;
b) IDENTITY RESPONSE (if requested identification parameter is SUCI);
c) AUTHENTICATION RESPONSE;
d) AUTHENTICATION FAILURE;
e) SECURITY MODE REJECT;
f) DEREGISTRATION REQUEST; and
g) DEREGISTRATION ACCEPT;
NOTE 1: The REGISTRATION REQUEST message is sent by the UE without integrity
protection, if the registration procedure is initiated due to an inter-system
change in 5GMM-IDLE mode and no current 5G NAS security context is available
in the UE. The other messages are accepted by the AMF without integrity
protection, as in certain situations they are sent by the UE before security
can be activated.
NOTE 2: The DEREGISTRATION REQUEST message can be sent by the UE without
integrity protection, e.g. if the UE is registered for emergency services and
there is no valid 5G NAS security context available, or if due to user
interaction a registration procedure is cancelled before the secure exchange
of NAS messages has been established. For these cases the network can attempt
to use additional criteria (e.g. whether the UE is subsequently still
performing periodic registration update or still responding to paging) before
marking the UE as 5GMM-DEREGISTERED.
Integrity protection is never applied directly to 5GSM messages, but to the
5GMM message in which the 5GSM message is included.
Once a current 5G NAS security context exists, until the secure exchange of
NAS messages has been established for the NAS signalling connection, the
receiving 5GMM entity in the AMF shall process the following NAS signalling
messages, even if the MAC included in the message fails the integrity check or
cannot be verified, as the 5G NAS security context is not available in the
network:
a) REGISTRATION REQUEST;
b) IDENTITY RESPONSE (if requested identification parameter is SUCI);
c) AUTHENTICATION RESPONSE;
d) AUTHENTICATION FAILURE;
e) SECURITY MODE REJECT;
f) DEREGISTRATION REQUEST;
g) DEREGISTRATION ACCEPT;
h) SERVICE REQUEST; and
i) CONTROL PLANE SERVICE REQUEST;
NOTE 3: These messages are processed by the AMF even when the MAC that fails
the integrity check or cannot be verified, as in certain situations they can
be sent by the UE protected with a 5G NAS security context that is no longer
available in the network.
If a REGISTRATION REQUEST message for initial registration fails the integrity
check and it is not a registration request for emergency services, the AMF
shall authenticate the subscriber before processing the registration request
any further. Additionally, the AMF shall initiate a security mode control
procedure, and include the Additional 5G security information IE with the
RINMR bit set to \"Retransmission of the initial NAS message requested\" in
the SECURITY MODE COMMAND message as specified in subclause 5.4.2.2. For the
case when the registration procedure is for emergency services see subclause
5.5.1.2.3 and subclause 5.4.1.3.5.
If a REGISTRATION REQUEST message for mobility and periodic registration
update fails the integrity check and the UE provided EPS NAS message container
IE which was successfully verified by the source MME, the AMF may create a
mapped 5G NAS security context and initiate a security mode control procedure
to take the new mapped 5G NAS security context into use; otherwise if the UE
has only a non-emergency PDU session established, the AMF shall initiate a
primary authentication and key agreement procedure to create a new native 5G
NAS security context. Additionally, the AMF shall initiate a security mode
control procedure, and include the Additional 5G security information IE with
the RINMR bit set to \"Retransmission of the initial NAS message requested\"
in the SECURITY MODE COMMAND message as specified in subclause 5.4.2.2. For
the case when the UE has an emergency PDU session see subclause 5.5.1.3.3 and
subclause 5.4.1.3.5.
If a DEREGISTRATION REQUEST message fails the integrity check, the AMF shall
proceed as follows:
\- If it is not a deregistration request due to switch off, and the AMF can
initiate an authentication procedure, the AMF should authenticate the
subscriber before processing the deregistration request any further.
\- If it is a deregistration request due to switch off, or the AMF does not
initiate an authentication procedure for any other reason, the AMF may ignore
the deregistration request and remain in state 5GMM-REGISTERED.
NOTE 4: The network can attempt to use additional criteria (e.g. whether the
UE is subsequently still performing periodic registration update or still
responding to paging) before marking the UE as 5GMM-DEREGISTERED.
If a SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message fails the
integrity check and the UE has only non-emergency PDU sessions established,
the AMF shall send the SERVICE REJECT message with 5GMM cause #9 \"UE identity
cannot be derived by the network\" and keep the 5GMM-context and 5G NAS
security context unchanged. For the case when the UE has an emergency PDU
session and integrity check fails, the AMF may skip the authentication
procedure even if no 5G NAS security context is available and proceed directly
to the execution of the security mode control procedure as specified in
subclause 5.4.2. Additionally, the AMF shall include the Additional 5G
security information IE with the RINMR bit set to \"Retransmission of the
initial NAS message requested\" in the SECURITY MODE COMMAND message as
specified in subclause 5.4.2.2. After successful completion of the service
request procedure, the network shall perform a local release of all non-
emergency PDU sessions. The emergency PDU sessions shall not be released.
Once the secure exchange of NAS messages has been established for the NAS
signalling connection, the receiving 5GMM entity in the AMF shall not process
any NAS signalling messages unless they have been successfully integrity
checked by the NAS. If any NAS signalling message, having not successfully
passed the integrity check, is received, then the NAS in the AMF shall discard
that message. If any NAS signalling message is received, as not integrity
protected even though the secure exchange of NAS messages has been
established, then the NAS shall discard this message.
### 4.4.5 Ciphering of NAS signalling messages
The use of ciphering in a network is an operator option subject to AMF
configuration. When operation of the network without ciphering is configured,
the AMF shall indicate the use of \"null ciphering algorithm\" 5G-EA0 (see
subclause 9.11.3.34) in the current 5G NAS security context for all UEs. For
setting the security header type in outbound NAS messages, the UE and the AMF
shall apply the same rules irrespective of whether the \"null ciphering
algorithm\" or any other ciphering algorithm is indicated in the 5G NAS
security context.
When the UE establishes a new N1 NAS signalling connection, it shall apply
security protection to the initial NAS message as described in subclause
4.4.6.
The UE shall start the ciphering and deciphering of NAS messages when the
secure exchange of NAS messages has been established for an N1 NAS signalling
connection. From this time onward, unless explicitly defined, the UE shall
send all NAS messages ciphered until the N1 NAS signalling connection is
released, or the UE performs inter-system change to S1 mode.
The AMF shall start ciphering and deciphering of NAS messages as described in
subclause 4.4.2.5. From this time onward, except for the SECURITY MODE COMMAND
message, the AMF shall send all NAS messages ciphered until the N1 NAS
signalling connection is released, or the UE performs inter-system change to
S1 mode.
Ciphering is never applied directly to 5GSM messages, but to the 5GMM message
in which the 5GSM message is included.
Once the encryption of NAS messages has been started between the AMF and the
UE, the receiver shall discard the unciphered NAS messages which shall have
been ciphered according to the rules described in this specification.
If the \"null ciphering algorithm\" 5G-EA0 has been selected as a ciphering
algorithm, the NAS messages with the security header indicating ciphering are
regarded as ciphered.
Details of ciphering and deciphering of NAS signalling messages are specified
in 3GPP TS 33.501 [24].
### 4.4.6 Protection of initial NAS signalling messages
The 5GS supports protection of initial NAS messages as specified in 3GPP TS
33.501 [24]. The protection of initial NAS messages applies to the
REGISTRATION REQUEST, SERVICE REQUEST and CONTROL PLANE SERVICE REQUEST
message, and is achieved as follows:
a) If the UE does not have a valid 5G NAS security context, the UE sends a
REGISTRATION REQUEST message including cleartext IEs only. After activating a
5G NAS security context resulting from a security mode control procedure:
1) if the UE needs to send non-cleartext IEs, the UE shall include the entire
REGISTRATION REQUEST message (i.e. containing both cleartext IEs and non-
cleartext IEs) in the NAS message container IE and shall include the NAS
message container IE in the SECURITY MODE COMPLETE message; or
2) if the UE does not need to send non-cleartext IEs, the UE shall include the
entire REGISTRATION REQUEST message (i.e. containing cleartext IEs only) in
the NAS message container IE and shall include the NAS message container IE in
the SECURITY MODE COMPLETE message.
b) If the UE has a valid 5G NAS security context and:
1) the UE needs to send non-cleartext IEs in a REGISTRATION REQUEST or SERVICE
REQUEST message, the UE includes the entire REGISTRATION REQUEST or SERVICE
REQUEST message (i.e. containing both cleartext IEs and non-cleartext IEs) in
the NAS message container IE and shall cipher the value part of the NAS
message container IE. The UE shall then send a REGISTRATION REQUEST or SERVICE
REQUEST message containing the cleartext IEs and the NAS message container IE;
2) the UE needs to send non-cleartext IEs in a CONTROL PLANE SERVICE REQUEST
message:
i) if CIoT small data container IE is the only non-cleartext IE to be sent,
the UE shall cipher the value part of the CIoT small data container IE. The UE
shall then send a CONTROL PLANE SERVICE REQUEST message containing the
cleartext IEs and the CIoT small data container IE;
ii) otherwise, the UE includes non-cleartext IEs in the NAS message container
IE and shall cipher the value part of the NAS message container IE. The UE
shall then send a CONTROL PLANE SERVICE REQUEST message containing the
cleartext IEs and the NAS message container IE;
3) the UE does not need to send non-cleartext IEs in a REGISTRATION REQUEST or
SERVICE REQUEST message, the UE sends the REGISTRATION REQUEST or SERVICE
REQUEST message without including the NAS message container IE; or
4) the UE does not need to send non-cleartext IEs in a CONTROL PLANE SERVICE
REQUEST message, the UE sends the CONTROL PLANE SERVICE REQUEST message
without including the NAS message container IE and the CIoT small data
container IE.
When the initial NAS message is a REGISTRATION REQUEST message, the cleartext
IEs are:
\- Extended protocol discriminator;
\- Security header type;
\- Spare half octet;
\- Registration request message identity;
\- 5GS registration type;
\- ngKSI;
\- 5GS mobile identity;
\- UE security capability;
\- Additional GUTI;
\- UE status;
\- EPS NAS message container;
\- NID; and
\- PLMN with disaster condition.
When the initial NAS message is a SERVICE REQUEST message, the cleartext IEs
are:
\- Extended protocol discriminator;
\- Security header type;
\- Spare half octet;
\- ngKSI;
\- Service request message identity;
\- Service type; and
\- 5G-S-TMSI.
When the initial NAS message is a CONTROL PLANE SERVICE REQUEST message, the
cleartext IEs are:
\- Extended protocol discriminator;
\- Security header type;
\- Spare half octet;
\- ngKSI;
\- Control plane service request message identity; and
\- Control plane service type.
When the UE sends a REGISTRATION REQUEST or SERVICE REQUEST or CONTROL PLANE
SERVICE REQUEST message that includes a NAS message container IE, the UE shall
set the security header type of the initial NAS message to \"integrity
protected\".
When the AMF receives an integrity protected initial NAS message which
includes a NAS message container IE, the AMF shall decipher the value part of
the NAS message container IE. If the received initial NAS message is a
REGISTRATION REQUEST message or a SERVICE REQUEST message, the AMF shall
consider the NAS message that is obtained from the NAS message container IE as
the initial NAS message that triggered the procedure.
When the AMF receives a CONTROL PLANE SERVICE REQUEST message which includes a
CIoT small data container IE, the AMF shall decipher the value part of the
CIoT small data container IE and handle the message as specified in subclause
5.6.1.4.2.
When the initial NAS message is a DEREGISTRATION REQUEST message, the UE
always sends the NAS message unciphered.
If the UE:
a) has 5G-EA0 as a selected 5G NAS security algorithm; and
b) selects a PLMN other than Registered PLMN and EPLMN over one access;
the UE shall send an initial NAS message including cleartext IEs only via the
access type associated with the newly selected PLMN as described in this
subclause for the case when the UE does not have a valid 5G NAS security
context.
If the UE:
a) has 5G-EA0 as a selected 5G NAS security algorithm; and
b) selects a PLMN other than Registered PLMN and EPLMN over one access, and
the Registered PLMN or EPLMN is not registering or registered over other
access;
the UE shall delete the 5G NAS security context.
NOTE: UE deletes the 5G NAS security context only if the UE is not in the
connected mode.
### 4.4.7 Protection of NAS IEs
The network can provide the SOR transparent container IE during the
registration procedure to the UE in the REGISTRATION ACCEPT message. The SOR
transparent container IE is integrity protected by the HPLMN or subscribed
SNPN as specified in 3GPP TS 33.501 [24].
The UE can provide the SOR transparent container IE during the registration
procedure to the network in the REGISTRATION COMPLETE message. The SoR-
MAC-I~UE~ in the SOR transparent container IE is generated by the UE as
specified in 3GPP TS 33.501 [24].
The network can provide the Payload container IE during the Network-initiated
NAS transport procedure to the UE in DL NAS TRANSPORT message. If the Payload
container type IE is set to \"SOR transparent container\" or \"UE parameters
update transparent container\", the Payload container IE is integrity
protected by the HPLMN or subscribed SNPN as specified in 3GPP TS 33.501 [24].
If the Payload container type IE is set to \"Multiple payloads\" and the
payload container type field of the payload container entry is set to \"SOR
transparent container\" or \"UE parameters update transparent container\", the
payload container entry contents field of the payload container entry is
integrity protected correspondingly.
The UE can provide the Payload container IE during the UE-initiated NAS
transport procedure to the network in UL NAS TRANSPORT message. If the Payload
container type IE is set to \"SOR transparent container\" or \"UE parameters
update transparent container\", the SoR-MAC-I~UE~ or UPU-MAC-I~UE~ in the
Payload container IE is generated by the UE as specified in 3GPP TS 33.501
[24]. If the Payload container type IE is set to \"Multiple payloads\" and the
payload container type field of the payload container entry is set to \"SOR
transparent container\" or \"UE parameters update transparent container\", the
SoR-MAC-I~UE~ or UPU-MAC-I~UE~ in the payload container entry contents field
of the payload container entry is generated by the UE correspondingly.
## 4.5 Unified access control
### 4.5.1 General
When the UE needs to access the 5GS, the UE not operating as an IAB-node (see
3GPP TS 23.501 [8]) and not acting as a 5G ProSe layer-2 UE-to-network relay
UE (see 3GPP TS 23.304 [6E]) whose access attempt is triggered by a 5G ProSe
layer-2 remote UE, first performs access control checks to determine if the
access is allowed. Access control checks shall be performed for the access
attempts defined by the following list of events:
NOTE 1: Although the UE operating as an IAB-node skips the access control
checks, the UE operating as an IAB-node determines an access category and one
or more access identities for each access attempt in order to derive an RRC
establishment cause. In this case the NAS provides the RRC establishment cause
but does not provide the access category and the one or more access identities
to the lower layers.
a) the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication over
3GPP access and an event that requires a transition to 5GMM-CONNECTED mode
occurs; and
b) the UE is in 5GMM-CONNECTED mode over 3GPP access or 5GMM-CONNECTED mode
with RRC inactive indication and one of the following events occurs:
1) 5GMM receives an MO-IMS-registration-related-signalling-started indication,
an MO-MMTEL-voice-call-started indication, an MO-MMTEL-video-call-started
indication or an MO-SMSoIP-attempt-started indication from upper layers;
2) 5GMM receives a request from upper layers to send a mobile originated SMS
over NAS unless the request triggered a service request procedure to
transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend
indication to 5GMM-CONNECTED mode;
3) 5GMM receives a request from upper layers to send an UL NAS TRANSPORT
message for the purpose of PDU session establishment unless the request
triggered a service request procedure to transition the UE from 5GMM-IDLE mode
or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode;
4) 5GMM receives a request from upper layers to send an UL NAS TRANSPORT
message for the purpose of PDU session modification unless the request
triggered a service request procedure to transition the UE from 5GMM-IDLE mode
or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode;
5) 5GMM receives a request to re-establish the user-plane resources for an
existing PDU session;
6) 5GMM is notified that an uplink user data packet is to be sent for a PDU
session with suspended user-plane resources;
7) 5GMM receives a request from upper layers to send a mobile originated
location request unless the request triggered a service request procedure to
transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend
indication to 5GMM-CONNECTED mode; and
8) 5GMM receives a request from upper layers to send a mobile originated
signalling transaction towards the PCF by sending an UL NAS TRANSPORT message
including a UE policy container (see 3GPP TS 24.587 [19B] and 3GPP TS 24.554
[19E]) unless the request triggered a service request procedure to transition
the UE from 5GMM-IDLE mode to 5GMM-CONNECTED mode.
NOTE 2: 5GMM specific procedures initiated by NAS in 5GMM-CONNECTED mode or
5GMM-CONNECTED mode with RRC inactive indication are not subject to access
control, e.g. a registration procedure after PS handover will not be prevented
by access control (see subclause 5.5).
NOTE 3: LPP messages or location event report messages transported in the UL
NAS TRANSPORT message sent in response to a mobile terminating or network
induced location request, and the corresponding access attempts are handled as
MT access.
NOTE 4: Initiating a mobile originated signalling transaction towards the UDM
by sending an UL NAS TRANSPORT message including an SOR transparent container
is not supported. Therefore, access control for these cases has not been
specified.
When the NAS detects one of the above events, the NAS needs to perform the
mapping of the kind of request to one or more access identities and one access
category and lower layers will perform access barring checks for that request
based on the determined access identities and access category.
NOTE 5: The NAS is aware of the above events through indications provided by
upper layers or through determining the need to start 5GMM procedures through
normal NAS behaviour, or both.
To determine the access identities and the access category for a request, the
NAS checks the reason for access, types of service requested and profile of
the UE including UE configurations, against a set of access identities and
access categories defined in 3GPP TS 22.261 [3], namely:
a) a set of standardized access identities;
b) a set of standardized access categories; and
c) a set of operator-defined access categories, if available.
For the purpose of determining the applicable access identities from the set
of standardized access identities defined in 3GPP TS 22.261 [3], the NAS shall
follow the requirements set out in:
a) subclause 4.5.2 and the rules and actions defined in table 4.5.2.1, if the
UE is not operating in SNPN access mode; or
b) subclause 4.5.2A and the rules and actions defined in table 4.5.2A.1, if
the UE is operating in SNPN access mode.
In order to enable access barring checks for access attempts identified by
lower layers in 5GMM-CONNECTED mode with RRC inactive indication, the UE
provides the applicable access identities to lower layers.
NOTE 6: When and how the NAS provides the applicable access identities to
lower layers is UE implementation specific.
NOTE 7: Although the UE operating as an IAB-node skips the access control
checks, the UE provides the applicable access identities to lower layers for
access attempts identified by lower layers in 5GMM-CONNECTED mode with RRC
inactive indication.
For the purpose of determining the applicable access category from the set of
standardized access categories and operator-defined access categories defined
in 3GPP TS 22.261 [3], the NAS shall follow the requirements set out in:
a) subclause 4.5.2 and the rules and actions defined in table 4.5.2.2, if the
UE is not operating in SNPN access mode; or
b) subclause 4.5.2A and the rules and actions defined in table 4.5.2A.2, if
the UE is operating in SNPN access mode.
### 4.5.2 Determination of the access identities and access category
associated with a request for access for UEs not operating in SNPN access mode
When the UE needs to initiate an access attempt in one of the events listed in
subclause 4.5.1, the UE shall determine one or more access identities from the
set of standardized access identities, and one access category from the set of
standardized access categories and operator-defined access categories, to be
associated with that access attempt.
The set of the access identities applicable for the request is determined by
the UE in the following way:
a) for each of the access identities 1, 2, 3, 11, 12, 13, 14 and 15 in table
4.5.2.1, the UE shall check whether the access identity is applicable in the
selected PLMN, if a new PLMN is selected, or otherwise if it is applicable in
the RPLMN or equivalent PLMN; and
b) if none of the above access identities is applicable, then access identity
0 is applicable.
Table 4.5.2.1: Access identities
+----------------------------------+----------------------------------+ | Access Identity number | UE configuration | +==================================+==================================+ | 0 | UE is not configured with any | | | parameters from this table | +----------------------------------+----------------------------------+ | 1 (NOTE 1) | UE is configured for multimedia | | | priority service (MPS). | +----------------------------------+----------------------------------+ | 2 (NOTE 2) | UE is configured for mission | | | critical service (MCS). | +----------------------------------+----------------------------------+ | 3 (NOTE 4) | UE for which a disaster | | | condition applies | +----------------------------------+----------------------------------+ | 4-10 | Reserved for future use | +----------------------------------+----------------------------------+ | 11 (NOTE 3) | Access Class 11 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 12 (NOTE 3) | Access Class 12 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 13 (NOTE 3) | Access Class 13 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 14 (NOTE 3) | Access Class 14 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 15 (NOTE 3) | Access Class 15 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | NOTE 1: Access identity 1 is | | | valid when:\ | | | - the USIM file EF~UAC_AIC~ | | | indicates the UE is configured | | | for access identity 1 and the | | | selected PLMN, if a new PLMN is | | | selected, or RPLMN is the HPLMN | | | (if the EHPLMN list is not | | | present or is empty) or EHPLMN | | | (if the EHPLMN list is present), | | | or a visited PLMN of the home | | | country (see the definition of | | | home country in | | | 3GPP TS 24.301 [15]);\ | | | - the UE receives the 5GS | | | network feature support IE with | | | the MPS indicator bit set to | | | \"Access identity 1 valid\" from | | | the RPLMN as described in | | | subclause 5.5.1.2.4 and | | | subclause 5.5.1.3.4; or\ | | | - the UE receives the Priority | | | indicator IE with the MPS | | | indicator bit set to \"Access | | | identity 1 valid\" from the | | | RPLMN as described in | | | subclause 5.4.4.3. | | | | | | NOTE 2: Access identity 2 is | | | used by UEs configured for MCS | | | and is valid when:\ | | | - the USIM file EF~UAC_AIC~ | | | indicates the UE is configured | | | for access identity 2 and the | | | selected PLMN, if a new PLMN is | | | selected, or RPLMN is the HPLMN | | | (if the EHPLMN list is not | | | present or is empty) or EHPLMN | | | (if the EHPLMN list is present), | | | or a visited PLMN of the home | | | country (see | | | 3GPP TS 23.122 [5]); or\ | | | - the UE receives the 5GS | | | network feature support IE with | | | the MCS indicator bit set to | | | \"Access identity 2 valid\" from | | | the RPLMN as described in | | | subclause 5.5.1.2.4 and | | | subclause 5.5.1.3.4. | | | | | | NOTE 3: Access identities 11 and | | | 15 are valid in HPLMN (if the | | | EHPLMN list is not present or is | | | empty) or EHPLMN (if the EHPLMN | | | list is present). Access | | | Identities 12, 13 and 14 are | | | valid in HPLMN and visited PLMNs | | | of home country only (see the | | | definition of home country in | | | 3GPP TS 24.301 [15]). | | | | | | NOTE 4: Access Identity 3 is | | | valid when the UE is registering | | | or registered for disaster | | | roaming services (see | | | 3GPP TS 23.122 [5]). | | +----------------------------------+----------------------------------+
The UE uses the MPS indicator bit of the 5GS network feature support IE or the
Priority indicator IE to determine if access identity 1 is valid. Processing
of the MPS indicator bit of the 5GS network feature support IE in the
REGISTRATION ACCEPT message is described in subclause 5.5.1.2.4 and subclause
5.5.1.3.4. Processing of the MPS indicator bit of the Priority indicator IE in
the CONFIGURATION UPDATE COMMAND message is described in subclause 5.4.4.3.
The UE shall not consider access identity 1 to be valid when the UE is not in
the country of its HPLMN or in an EHPLMN (if the EHPLMN list is present) prior
to receiving the MPS indicator bit of the 5GS network feature support IE in
the REGISTRATION ACCEPT message or of the Priority indicator IE in the
CONFIGURATION UPDATE COMMAND message being set to \"Access identity 1 valid\".
When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list
is present), the contents of the USIM file EF~UAC_AIC~ as specified in 3GPP TS
31.102 [22] and the rules specified in table 4.5.2.1 are used to determine the
applicability of access identity 1\. When the UE is in the country of its
HPLMN or in an EHPLMN (if the EHPLMN list is present), and the USIM file
EF~UAC_AIC~ does not indicate the UE is configured for access identity 1, the
UE uses the MPS indicator bit of the 5GS network feature support IE in the
REGISTRATION ACCEPT message or of the Priority indicator IE in the
CONFIGURATION UPDATE COMMAND message to determine if access identity 1 is
valid. When the UE is in the country of its HPLMN or in an EHPLMN (if the
EHPLMN list is present), and the USIM file EF~UAC_AIC~ indicates the UE is
configured for access identity 1, the MPS indicator bit of the 5GS network
feature support IE and the Priority indicator IE are not applicable. When the
UE is not in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is
present), the contents of the USIM file EF~UAC_AIC~ are not applicable.
The UE uses the MCS indicator bit of the 5GS network feature support IE to
determine if access identity 2 is valid. Processing of the MCS indicator bit
of the 5GS network feature support IE in the REGISTRATION ACCEPT message is
described in subclause 5.5.1.2.4 and subclause 5.5.1.3.4. The UE shall not
consider access identity 2 to be valid when the UE is not in the country of
its HPLMN or in an EHPLMN (if the EHPLMN list is present) prior to receiving
the MCS indicator bit of the 5GS network feature support IE in the
REGISTRATION ACCEPT message being set to \"Access identity 2 valid\".
When the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list
is present), the contents of the USIM file EF~UAC_AIC~ as specified in 3GPP TS
31.102 [22] and the rules specified in table 4.5.2.1 are used to determine the
applicability of access identity 2\. When the UE is in the country of its
HPLMN or in an EHPLMN (if the EHPLMN list is present), and the USIM file
EF~UAC_AIC~ does not indicate the UE is configured for access identity 2, the
UE uses the MCS indicator bit of the 5GS network feature support IE in the
REGISTRATION ACCEPT message to determine if access identity 2 is valid. When
the UE is in the country of its HPLMN or in an EHPLMN (if the EHPLMN list is
present), and the USIM file EF~UAC_AIC~ indicates the UE is configured for
access identity 2, the MCS indicator bit of the 5GS network feature support IE
is not applicable. When the UE is not in the country of its HPLMN or in an
EHPLMN (if the EHPLMN list is present), the contents of the USIM file
EF~UAC_AIC~ are not applicable.
The UE checks the conditions specified in subclause 4.4.3.1.1 of 3GPP TS
23.122 [5] to determine if access identity 3 is valid, and the applicability
of access identity 3.
When the UE is in its HPLMN (if the EHPLMN list is not present or is empty) or
in an EHPLMN (if the EHPLMN list is present), the contents of the USIM file
EF~ACC~ as specified in 3GPP TS 31.102 [22] and the rules specified in table
4.5.2.1 are used to determine the applicability of access classes 11 and 15.
When the UE is not in its HPLMN (if the EHPLMN list is not present or is
empty) or in an EHPLMN (if the EHPLMN list is present), access classes 11 and
15 are not applicable.
When the UE is in the country of its HPLMN, the contents of the USIM file
EF~ACC~ as specified in 3GPP TS 31.102 [22] and the rules specified in table
4.5.2.1 are used to determine the applicability of access classes 12 - 14.
When the UE is not in the country of its HPLMN, access classes 12-14 are not
applicable.
In order to determine the access category applicable for the access attempt,
the NAS shall check the rules in table 4.5.2.2, and use the access category
for which there is a match for barring check. If the access attempt matches
more than one rule, the access category of the lowest rule number shall be
selected. If the access attempt matches more than one operator-defined access
category definition, the UE shall select the access category from the
operator-defined access category definition with the lowest precedence value
(see subclause 4.5.3).
NOTE: The case when an access attempt matches more than one rule includes the
case when multiple events trigger an access attempt at the same time.
Table 4.5.2.2: Mapping table for access categories
+----------------+----------------+----------------+----------------+ | Rule # | Type of access | Requirements | Access | | | attempt | to be met | Category | +----------------+----------------+----------------+----------------+ | 1 | Response to | Access attempt | 0 (= MT_acc) | | | paging or | is for MT | | | | NOTIFICATION | access, or | | | | over non-3GPP | handover of | | | | access; | ongoing MMTEL | | | | | voice call, | | | | 5GMM | MMTEL video | | | | connection | call or SMSoIP | | | | management | from non-3GPP | | | | procedure | access; or\ | | | | initiated for | Access attempt | | | | the purpose of | is made upon | | | | transporting | receipt of | | | | an LPP message | \"call-pu | | | | without an | ll-initiated\" | | | | ongoing | (3GPP TS 2 | | | | 5GC-MO-LR | 4.174 [13D]) | | | | procedure; | | | | | | | | | | Access attempt | | | | | to handover of | | | | | ongoing MMTEL | | | | | voice call, | | | | | MMTEL video | | | | | call or SMSoIP | | | | | from non-3GPP | | | | | access; or | | | | | | | | | | Access attempt | | | | | upon receipt | | | | | of | | | | | \"call-pu | | | | | ll-initiated\" | | | | | indication | | | | | from the upper | | | | | layers (see | | | | | 3GPP TS 2 | | | | | 4.174 [13D]) | | | +----------------+----------------+----------------+----------------+ | 2 | Emergency | UE is | 2 (= | | | | attempting | emergency) | | | | access for an | | | | | emergency | | | | | session | | | | | (NOTE 1, | | | | | NOTE 2) | | +----------------+----------------+----------------+----------------+ | 3 | Access attempt | UE stores | 32-63\ | | | for | op | (= based on | | | op | erator-defined | operator | | | erator-defined | access | c | | | access | category | lassification) | | | category | definitions | | | | | valid in the | | | | | current PLMN | | | | | as specified | | | | | in | | | | | su | | | | | bclause 4.5.3, | | | | | and access | | | | | attempt is | | | | | matching | | | | | criteria of an | | | | | op | | | | | erator-defined | | | | | access | | | | | category | | | | | definition | | +----------------+----------------+----------------+----------------+ | 3.1 | Access attempt | UE is in NB-N1 | 10 (= MO | | | for MO | mode and | exception | | | exception data | allowed to use | data) | | | | exception data | | | | | reporting (see | | | | | the | | | | | E | | | | | xceptionDataRe | | | | | portingAllowed | | | | | leaf of the | | | | | NAS | | | | | configuration | | | | | MO in | | | | | 3GPP TS | | | | | 24.368 [17] | | | | | or the USIM | | | | | file | | | | | EF~NASCONFIG~ | | | | | in | | | | | 3GPP TS 3 | | | | | 1.102 [22]), | | | | | and access | | | | | attempt is for | | | | | MO data or for | | | | | MO signalling | | | | | initiated upon | | | | | receiving a | | | | | request from | | | | | upper layers | | | | | to transmit | | | | | user data | | | | | related to an | | | | | exceptional | | | | | event. | | +----------------+----------------+----------------+----------------+ | 4 | Access attempt | (a) UE is | 1 (= delay | | | for delay | configured for | tolerant) | | | tolerant | NAS signalling | | | | service | low priority | | | | | or UE | | | | | supporting S1 | | | | | mode is | | | | | configured for | | | | | EAB (see the | | | | | \"ExtendedA | | | | | ccessBarring\" | | | | | leaf of NAS | | | | | configuration | | | | | MO in | | | | | 3GPP TS | | | | | 24.368 [17] | | | | | or | | | | | 3GPP TS | | | | | 31.102 [22]) | | | | | where \"EAB | | | | | override\" | | | | | does not | | | | | apply, and | | | | | | | | | | (b): the UE | | | | | received one | | | | | of the | | | | | categories a, | | | | | b or c as part | | | | | of the | | | | | parameters for | | | | | unified access | | | | | control in the | | | | | broadcast | | | | | system | | | | | information, | | | | | and the UE is | | | | | a member of | | | | | the | | | | | broadcasted | | | | | category in | | | | | the selected | | | | | PLMN or | | | | | RP | | | | | LMN/equivalent | | | | | PLMN | | | | | | | | | | (NOTE 3, | | | | | NOTE 5, | | | | | NOTE 6, | | | | | NOTE 7, | | | | | NOTE 8) | | +----------------+----------------+----------------+----------------+ | 5 | MO MMTel voice | Access attempt | 4 (= MO MMTel | | | call | is for MO | voice) | | | | MMTel voice | | | | | call | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | MO MMTel voice | | | | | call (NOTE 2) | | +----------------+----------------+----------------+----------------+ | 6 | MO MMTel video | Access attempt | 5 (= MO MMTel | | | call | is for MO | video) | | | | MMTel video | | | | | call | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | MO MMTel video | | | | | call (NOTE 2) | | +----------------+----------------+----------------+----------------+ | 7 | MO SMS over | Access attempt | 6 (= MO SMS | | | NAS or MO | is for MO SMS | and SMSoIP) | | | SMSoIP | over NAS | | | | | (NOTE 4) or MO | | | | | SMS over | | | | | SMSoIP | | | | | transfer | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | MO SMS or | | | | | SMSoIP | | | | | transfer | | | | | (NOTE 2) | | +----------------+----------------+----------------+----------------+ | 7.1 | MO IMS | Access attempt | 9 (= MO IMS | | | registration | is for MO IMS | registration | | | related | registration | related | | | signalling | related | signalling) | | | | signalling | | | | | (e.g. IMS | | | | | initial | | | | | registration, | | | | | re | | | | | -registration, | | | | | subscription | | | | | refresh) | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | procedure for | | | | | MO IMS | | | | | registration | | | | | related | | | | | signalling | | | | | (NOTE 2a) | | +----------------+----------------+----------------+----------------+ | 8 | UE NAS | Access attempt | 3 (= MO_sig) | | | initiated 5GMM | is for MO | | | | specific | signalling | | | | procedures | | | +----------------+----------------+----------------+----------------+ | 8.1 | Mobile | Access attempt | 3 (= MO_sig) | | | originated | is for mobile | | | | location | originated | | | | request | location | | | | | request | | | | | (NOTE 9) | | +----------------+----------------+----------------+----------------+ | 8.2 | Mobile | Access attempt | 3 (= MO_sig) | | | originated | is for mobile | | | | signalling | originated | | | | transaction | signalling | | | | towards the | transaction | | | | PCF | towards the | | | | | PCF (NOTE 10) | | +----------------+----------------+----------------+----------------+ | 9 | UE NAS | Access attempt | 7 (= MO_data) | | | initiated 5GMM | is for MO data | | | | connection | | | | | management | | | | | procedure or | | | | | 5GMM NAS | | | | | transport | | | | | procedure | | | +----------------+----------------+----------------+----------------+ | 10 | An uplink user | No further | 7 (= MO_data) | | | data packet is | requirement is | | | | to be sent for | to be met | | | | a PDU session | | | | | with suspended | | | | | user-plane | | | | | resources | | | +----------------+----------------+----------------+----------------+ | NOTE 1: This | | | | | includes 5GMM | | | | | specific | | | | | procedures | | | | | while the | | | | | service is | | | | | ongoing and | | | | | 5GMM | | | | | connection | | | | | management | | | | | procedures | | | | | required to | | | | | establish a | | | | | PDU session | | | | | with request | | | | | type = | | | | | \"initial | | | | | emergency | | | | | request\" or | | | | | \"existing | | | | | emergency PDU | | | | | session\", or | | | | | to | | | | | re-establish | | | | | user-plane | | | | | resources for | | | | | such a PDU | | | | | session. This | | | | | further | | | | | includes the | | | | | service | | | | | request | | | | | procedure | | | | | initiated with | | | | | a SERVICE | | | | | REQUEST | | | | | message with | | | | | the Service | | | | | type IE set to | | | | | \"emergency | | | | | services | | | | | fallback\". | | | | | | | | | | NOTE 2: Access | | | | | for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | service as | | | | | defined in | | | | | su | | | | | bclause 4.5.5, | | | | | or for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | establishment | | | | | following | | | | | fallback | | | | | indication | | | | | from lower | | | | | layers during | | | | | an ongoing | | | | | service as | | | | | defined in | | | | | su | | | | | bclause 4.5.5, | | | | | is mapped to | | | | | the access | | | | | category of | | | | | the ongoing | | | | | service in | | | | | order to | | | | | derive an RRC | | | | | establishment | | | | | cause, but | | | | | barring checks | | | | | will be | | | | | skipped for | | | | | this access | | | | | attempt. | | | | | | | | | | NOTE 2a: | | | | | Access for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | procedure for | | | | | MO IMS | | | | | registration | | | | | related | | | | | signalling as | | | | | defined in | | | | | su | | | | | bclause 4.5.5, | | | | | or for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | establishment | | | | | following | | | | | fallback | | | | | indication | | | | | from lower | | | | | layers during | | | | | an ongoing | | | | | procedure for | | | | | MO IMS | | | | | registration | | | | | related | | | | | signalling as | | | | | defined in | | | | | su | | | | | bclause 4.5.5, | | | | | is mapped to | | | | | the access | | | | | category of | | | | | the MO IMS | | | | | registration | | | | | related | | | | | signalling in | | | | | order to | | | | | derive an RRC | | | | | establishment | | | | | cause, but | | | | | barring checks | | | | | will be | | | | | skipped for | | | | | this access | | | | | attempt. | | | | | | | | | | NOTE 3: If the | | | | | UE selects a | | | | | new PLMN, then | | | | | the selected | | | | | PLMN is used | | | | | to check the | | | | | membership; | | | | | otherwise the | | | | | UE uses the | | | | | RPLMNor a PLMN | | | | | equivalent to | | | | | the RPLMN. | | | | | | | | | | NOTE 4: This | | | | | includes the | | | | | 5GMM | | | | | connection | | | | | management | | | | | procedures | | | | | triggered by | | | | | the | | | | | UE-initiated | | | | | NAS transport | | | | | procedure for | | | | | transporting | | | | | the MO SMS. | | | | | | | | | | NOTE 5: The UE | | | | | configured for | | | | | NAS signalling | | | | | low priority | | | | | is not | | | | | supported in | | | | | this release | | | | | of | | | | | specification. | | | | | If a UE | | | | | supporting | | | | | both S1 mode | | | | | and N1 mode is | | | | | configured for | | | | | NAS signalling | | | | | low priority | | | | | in S1 mode as | | | | | specified in | | | | | 3GPP TS | | | | | 24.368 [17] | | | | | or | | | | | 3GPP TS | | | | | 31.102 [22], | | | | | the UE shall | | | | | ignore the | | | | | configuration | | | | | for NAS | | | | | signalling low | | | | | priority when | | | | | in N1 mode. | | | | | | | | | | NOTE 6: If the | | | | | access | | | | | category | | | | | applicable for | | | | | the access | | | | | attempt is 1, | | | | | then the UE | | | | | shall | | | | | additionally | | | | | determine a | | | | | second access | | | | | category from | | | | | the range 3 to | | | | | 7. If more | | | | | than one | | | | | access | | | | | category | | | | | matches, the | | | | | access | | | | | category of | | | | | the lowest | | | | | rule number | | | | | shall be | | | | | chosen. The UE | | | | | shall use the | | | | | second access | | | | | category only | | | | | to derive an | | | | | RRC | | | | | establishment | | | | | cause for the | | | | | access | | | | | attempt. | | | | | | | | | | NOTE 7: \"EAB | | | | | override\" | | | | | does not | | | | | apply, if the | | | | | UE is not | | | | | configured to | | | | | allow | | | | | overriding EAB | | | | | (see the | | | | | \"Overr | | | | | ide_ExtendedA | | | | | ccessBarring\" | | | | | leaf of NAS | | | | | configuration | | | | | MO in | | | | | 3GPP TS | | | | | 24.368 [17] | | | | | or | | | | | 3GPP TS 3 | | | | | 1.102 [22]), | | | | | or if NAS has | | | | | not received | | | | | an indication | | | | | from the upper | | | | | layers to | | | | | override EAB | | | | | and the UE | | | | | does not have | | | | | a PDU session | | | | | that was | | | | | established | | | | | with EAB | | | | | override. | | | | | | | | | | NOTE 8: For | | | | | the definition | | | | | of categories | | | | | a, b and c | | | | | associated | | | | | with access | | | | | category 1, | | | | | see | | | | | 3GPP TS | | | | | 22.261 [3]. | | | | | The categories | | | | | associated | | | | | with access | | | | | category 1 are | | | | | distinct from | | | | | the categories | | | | | a, b and c | | | | | associated | | | | | with EAB (see | | | | | 3GPP TS 2 | | | | | 2.011 [1A]). | | | | | | | | | | NOTE 9: This | | | | | includes:\ | | | | | a) the | | | | | UE-initiated | | | | | NAS transport | | | | | procedure for | | | | | transporting a | | | | | mobile | | | | | originated | | | | | location\ | | | | | request;\ | | | | | b) the 5GMM | | | | | connection | | | | | management | | | | | procedure | | | | | triggered by | | | | | a) above; and\ | | | | | c) NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | 5GC-MO-LR | | | | | procedure. | | | | | | | | | | NOTE 10: This | | | | | includes:\ | | | | | a) the | | | | | UE-initiated | | | | | NAS transport | | | | | procedure for | | | | | transporting a | | | | | mobile | | | | | originated | | | | | signalling\ | | | | | transaction | | | | | towards the | | | | | PCF;\ | | | | | b) the 5GMM | | | | | connection | | | | | management | | | | | procedure | | | | | triggered by | | | | | a) above; and\ | | | | | c) NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | UE-requested | | | | | policy | | | | | provisioning | | | | | procedure for | | | | | V2XP, ProSeP | | | | | or both (see | | | | | 3GPP TS | | | | | 24.587 [19B] | | | | | and see | | | | | 3GPP TS 24 | | | | | .554 [19E]). | | | | +----------------+----------------+----------------+----------------+
### 4.5.2A Determination of the access identities and access category
associated with a request for access for UEs operating in SNPN access mode
When the UE needs to initiate an access attempt in one of the events listed in
subclause 4.5.1, the UE shall determine one or more access identities from the
set of standardized access identities, and one access category from the set of
standardized access categories and operator-defined access categories, to be
associated with that access attempt.
The set of the access identities applicable for the request is determined by
the UE in the following way:
a) for each of the access identities 1, 2, 11, 12, 13, 14 and 15 in table
4.5.2A.1, the UE shall check whether the access identity is applicable in the
selected SNPN, if a new SNPN is selected, or otherwise if it is applicable in
the RSNPN; and
b) if none of the above access identities is applicable, then access identity
0 is applicable.
Table 4.5.2A.1: Access identities
+----------------------------------+----------------------------------+ | Access Identity number | UE configuration | +==================================+==================================+ | 0 | UE is not configured with any | | | parameters from this table | +----------------------------------+----------------------------------+ | 1 (NOTE 1) | UE is configured for multimedia | | | priority service (MPS). | +----------------------------------+----------------------------------+ | 2 (NOTE 2) | UE is configured for mission | | | critical service (MCS). | +----------------------------------+----------------------------------+ | 3-10 | Reserved for future use | +----------------------------------+----------------------------------+ | 11 (NOTE 3) | Access Class 11 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 12 (NOTE 3) | Access Class 12 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 13 (NOTE 3) | Access Class 13 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 14 (NOTE 3) | Access Class 14 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | 15 (NOTE 3) | Access Class 15 is configured in | | | the UE. | +----------------------------------+----------------------------------+ | NOTE 1: Access identity 1 is | | | valid when:\ | | | - the unified access control | | | configuration in the \"list of | | | subscriber data\" stored in the | | | ME (see 3GPP TS 23.122 [5]), | | | if an entry of \"list of | | | subscriber data\" is selected, | | | or in the USIM (see | | | 3GPP TS 31.102 [22]), if the | | | PLMN subscription is selected, | | | indicates the UE is configured | | | for access identity 1 in the | | | selected SNPN, if a new SNPN is | | | selected, or RSNPN;\ | | | - the UE receives the 5GS | | | network feature support IE with | | | the MPS indicator bit set to | | | \"Access identity 1 valid\" from | | | the RSNPN as described in | | | subclause 5.5.1.2.4 and | | | subclause 5.5.1.3.4; or\ | | | - the UE receives the Priority | | | indicator IE with the MPS | | | indicator bit set to \"Access | | | identity 1 valid\" from the | | | RPLMN as described in | | | subclause 5.4.4.3. | | | | | | NOTE 2: Access identity 2 is | | | used by UEs configured for MCS | | | and is valid when:\ | | | - the unified access control | | | configuration in the \"list of | | | subscriber data\" stored in the | | | ME (see 3GPP TS 23.122 [5]), | | | if an entry of \"list of | | | subscriber data\" is selected, | | | or in the USIM (see | | | 3GPP TS 31.102 [22]), if the | | | PLMN subscription is selected, | | | indicates the UE is configured | | | for access identity 2 in the | | | selected SNPN, if a new SNPN is | | | selected, or RSNPN; or\ | | | - the UE receives the 5GS | | | network feature support IE with | | | the MCS indicator bit set to | | | \"Access identity 2 valid\" from | | | the RSNPN as described in | | | subclause 5.5.1.2.4 and | | | subclause 5.5.1.3.4. | | | | | | NOTE 3: Access identities 11 to | | | 15 are valid if indicated as | | | configured for the UE in the | | | unified access control | | | configuration in the \"list of | | | subscriber data\" stored in the | | | ME (see 3GPP TS 23.122 [5]), | | | if an entry of \"list of | | | subscriber data\" is selected, | | | or in the USIM (see | | | 3GPP TS 31.102 [22]), if the | | | PLMN subscription is selected, | | | in the selected SNPN, if a new | | | SNPN is selected, or RSNPN. | | +----------------------------------+----------------------------------+
The contents of the unified access control configuration in the \"list of
subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of
\"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102
[22]), if the PLMN subscription is selected, and the rules specified in table
4.5.2A.1 are used to determine the applicability of access identity 1 in the
SNPN. When the contents of the unified access control configuration in the
\"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an
entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS
31.102 [22]), if the PLMN subscription is selected, do not indicate the UE is
configured for access identity 1 for the SNPN, the UE uses the MPS indicator
bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message
and the MPS indicator bit of the Priority indicator IE in the CONFIGURATION
UPDATE COMMAND message to determine if access identity 1 is valid.
The contents of the unified access control configuration in the \"list of
subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of
\"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102
[22]), if the PLMN subscription is selected, and the rules specified in table
4.5.2A.1 are used to determine the applicability of access identity 2 in the
SNPN. When the contents of the unified access control configuration in the
\"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an
entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS
31.102 [22]), if the PLMN subscription is selected, do not indicate the UE is
configured for access identity 2 for the SNPN, the UE uses the MCS indicator
bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message
to determine if access identity 2 is valid.
The contents of the unified access control configuration in the \"list of
subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of
\"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102
[22]), if the PLMN subscription is selected, and the rules specified in table
4.5.2A.1 are used to determine the applicability of access classes 11 to 15 in
the SNPN.
In order to determine the access category applicable for the access attempt,
the NAS shall check the rules in table 4.5.2A.2, and use the access category
for which there is a match for barring check. If the access attempt matches
more than one rule, the access category of the lowest rule number shall be
selected. If the access attempt matches more than one operator-defined access
category definition, the UE shall select the access category from the
operator-defined access category definition with the lowest precedence value
(see subclause 4.5.3).
NOTE: The case when an access attempt matches more than one rule includes the
case when multiple events trigger an access attempt at the same time.
Table 4.5.2A.2: Mapping table for access categories
+----------------+----------------+----------------+----------------+ | Rule # | Type of access | Requirements | Access | | | attempt | to be met | Category | +----------------+----------------+----------------+----------------+ | 1 | Response to | Access attempt | 0 (= MT_acc) | | | paging or | is for MT | | | | NOTIFICATION | access, | | | | over non-3GPP | handover of | | | | access | ongoing MMTEL | | | | (NOTE 11); | voice call, | | | | | MMTEL video | | | | 5GMM | call or SMSoIP | | | | connection | from non-3GPP | | | | management | access; or | | | | procedure | | | | | initiated for | Access attempt | | | | the purpose of | is made upon | | | | transporting | receipt of | | | | an LPP message | \"call-pu | | | | without an | ll-initiated\" | | | | ongoing | indication | | | | 5GC-MO-LR | (3GPP TS 2 | | | | procedure; | 4.174 [13D]) | | | | | | | | | Access attempt | | | | | to handover of | | | | | MMTEL voice | | | | | call, MMTEL | | | | | video call or | | | | | SMSoIP from | | | | | non-3GPP | | | | | access; | | | | | | | | | | Access attempt | | | | | upon receipt | | | | | of | | | | | \"call-pu | | | | | ll-initiated\" | | | | | indication | | | | | from the upper | | | | | layers (see | | | | | 3GPP TS 2 | | | | | 4.174 [13D]) | | | +----------------+----------------+----------------+----------------+ | 2 | Emergency | UE is | 2 (= | | | | attempting | emergency) | | | | access for an | | | | | emergency | | | | | session | | | | | (NOTE 1, | | | | | NOTE 2) | | +----------------+----------------+----------------+----------------+ | 3 | Access attempt | UE stores | 32-63\ | | | for | op | (= based on | | | op | erator-defined | operator | | | erator-defined | access | c | | | access | category | lassification) | | | category | definitions | | | | | valid in the | | | | | SNPN as | | | | | specified in | | | | | su | | | | | bclause 4.5.3, | | | | | and access | | | | | attempt is | | | | | matching | | | | | criteria of an | | | | | op | | | | | erator-defined | | | | | access | | | | | category | | | | | definition | | +----------------+----------------+----------------+----------------+ | 4 | Access attempt | (a) UE is | 1 (= delay | | | for delay | configured for | tolerant) | | | tolerant | NAS signalling | | | | service | low priority, | | | | | and | | | | | | | | | | (b) the UE | | | | | received one | | | | | of the | | | | | categories a, | | | | | b or c as part | | | | | of the | | | | | parameters for | | | | | unified access | | | | | control in the | | | | | broadcast | | | | | system | | | | | information, | | | | | and the UE is | | | | | a member of | | | | | the | | | | | broadcasted | | | | | category in | | | | | the selected | | | | | SNPN or RSNPN | | | | | | | | | | (NOTE 3, | | | | | NOTE 5, | | | | | NOTE 6, | | | | | NOTE 7, | | | | | NOTE 8) | | +----------------+----------------+----------------+----------------+ | 5 | MO MMTel voice | Access attempt | 4 (= MO MMTel | | | call | is for MO | voice) | | | | MMTel voice | | | | | call | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | MO MMTel voice | | | | | call (NOTE 2) | | +----------------+----------------+----------------+----------------+ | 6 | MO MMTel video | Access attempt | 5 (= MO MMTel | | | call | is for MO | video) | | | | MMTel video | | | | | call | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | MO MMTel video | | | | | call (NOTE 2) | | +----------------+----------------+----------------+----------------+ | 7 | MO SMS over | Access attempt | 6 (= MO SMS | | | NAS or MO | is for MO SMS | and SMSoIP) | | | SMSoIP | over NAS | | | | | (NOTE 4) or MO | | | | | SMS over | | | | | SMSoIP | | | | | transfer | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | MO SMS or | | | | | SMSoIP | | | | | transfer | | | | | (NOTE 2) | | +----------------+----------------+----------------+----------------+ | 7.1 | MO IMS | Access attempt | 9 (= MO IMS | | | registration | is for MO IMS | registration | | | related | registration | related | | | signalling | related | signalling) | | | | signalling | | | | | (e.g. IMS | | | | | initial | | | | | registration, | | | | | re | | | | | -registration, | | | | | subscription | | | | | refresh) | | | | | | | | | | or for NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during ongoing | | | | | procedure for | | | | | MO IMS | | | | | registration | | | | | related | | | | | signalling | | | | | (NOTE 2a) | | +----------------+----------------+----------------+----------------+ | 8 | UE NAS | Access attempt | 3 (= MO_sig) | | | initiated 5GMM | is for MO | | | | specific | signalling | | | | procedures | | | +----------------+----------------+----------------+----------------+ | 8.1 | Mobile | Access attempt | 3 (= MO_sig) | | | originated | is for mobile | | | | location | originated | | | | request | location | | | | | request | | | | | (NOTE 9) | | +----------------+----------------+----------------+----------------+ | 8.2 | Mobile | Access attempt | 3 (= MO_sig) | | | originated | is for mobile | | | | signalling | originated | | | | transaction | signalling | | | | towards the | transaction | | | | PCF | towards the | | | | | PCF (NOTE 10) | | +----------------+----------------+----------------+----------------+ | 9 | UE NAS | Access attempt | 7 (= MO_data) | | | initiated 5GMM | is for MO data | | | | connection | | | | | management | | | | | procedure or | | | | | 5GMM NAS | | | | | transport | | | | | procedure | | | +----------------+----------------+----------------+----------------+ | 10 | An uplink user | No further | 7 (= MO_data) | | | data packet is | requirement is | | | | to be sent for | to be met | | | | a PDU session | | | | | with suspended | | | | | user-plane | | | | | resources | | | +----------------+----------------+----------------+----------------+ | NOTE 1: Void | | | | | | | | | | NOTE 2: Access | | | | | for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | service as | | | | | defined in | | | | | su | | | | | bclause 4.5.5, | | | | | or for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | establishment | | | | | following | | | | | fallback | | | | | indication | | | | | from lower | | | | | layers during | | | | | an ongoing | | | | | service as | | | | | defined in | | | | | su | | | | | bclause 4.5.5, | | | | | is mapped to | | | | | the access | | | | | category of | | | | | the ongoing | | | | | service in | | | | | order to | | | | | derive an RRC | | | | | establishment | | | | | cause, but | | | | | barring checks | | | | | will be | | | | | skipped for | | | | | this access | | | | | attempt. | | | | | | | | | | NOTE 2a: | | | | | Access for the | | | | | purpose of NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing MO IMS | | | | | registration | | | | | related | | | | | signalling as | | | | | defined in | | | | | subclause | | | | | 4.5.5, or for | | | | | the purpose of | | | | | NAS signalling | | | | | connection | | | | | establishment | | | | | following | | | | | fallback | | | | | indication | | | | | from lower | | | | | layers during | | | | | an ongoing MO | | | | | IMS | | | | | registration | | | | | related | | | | | signalling as | | | | | defined in | | | | | subclause | | | | | 4.5.5, is | | | | | mapped to the | | | | | access | | | | | category of | | | | | the MO IMS | | | | | registration | | | | | related | | | | | signalling in | | | | | order to | | | | | derive an RRC | | | | | establishment | | | | | cause, but | | | | | barring checks | | | | | will be | | | | | skipped for | | | | | this access | | | | | attempt. | | | | | | | | | | NOTE 3: If the | | | | | UE selects a | | | | | new SNPN, then | | | | | the selected | | | | | SNPN is used | | | | | to check the | | | | | membership; | | | | | otherwise the | | | | | UE uses the | | | | | RSNPN. | | | | | | | | | | NOTE 4: This | | | | | includes the | | | | | 5GMM | | | | | connection | | | | | management | | | | | procedures | | | | | triggered by | | | | | the | | | | | UE-initiated | | | | | NAS transport | | | | | procedure for | | | | | transporting | | | | | the MO SMS. | | | | | | | | | | NOTE 5: The UE | | | | | configured for | | | | | NAS signalling | | | | | low priority | | | | | is not | | | | | supported in | | | | | this release | | | | | of | | | | | specification. | | | | | | | | | | NOTE 6: If the | | | | | access | | | | | category | | | | | applicable for | | | | | the access | | | | | attempt is 1, | | | | | then the UE | | | | | shall | | | | | additionally | | | | | determine a | | | | | second access | | | | | category from | | | | | the range 3 to | | | | | 7. If more | | | | | than one | | | | | access | | | | | category | | | | | matches, the | | | | | access | | | | | category of | | | | | the lowest | | | | | rule number | | | | | shall be | | | | | chosen. The UE | | | | | shall use the | | | | | second access | | | | | category only | | | | | to derive an | | | | | RRC | | | | | establishment | | | | | cause for the | | | | | access | | | | | attempt. | | | | | | | | | | NOTE 7: Void. | | | | | | | | | | NOTE 8: For | | | | | the definition | | | | | of categories | | | | | a, b and c | | | | | associated | | | | | with access | | | | | category 1, | | | | | see | | | | | 3GPP TS | | | | | 22.261 [3]. | | | | | The categories | | | | | associated | | | | | with access | | | | | category 1 are | | | | | distinct from | | | | | the categories | | | | | a, b and c | | | | | associated | | | | | with EAB (see | | | | | 3GPP TS 2 | | | | | 2.011 [1A]). | | | | | | | | | | NOTE 9: This | | | | | includes:\ | | | | | a) the | | | | | UE-initiated | | | | | NAS transport | | | | | procedure for | | | | | transporting a | | | | | mobile | | | | | originated | | | | | location\ | | | | | request;\ | | | | | b) the 5GMM | | | | | connection | | | | | management | | | | | procedure | | | | | triggered by | | | | | a) above; and\ | | | | | c) NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | 5GC-MO-LR | | | | | procedure. | | | | | | | | | | NOTE 10: This | | | | | includes:\ | | | | | a) the | | | | | UE-initiated | | | | | NAS transport | | | | | procedure for | | | | | transporting a | | | | | mobile | | | | | originated | | | | | signalling\ | | | | | transaction | | | | | towards the | | | | | PCF;\ | | | | | b) the 5GMM | | | | | connection | | | | | management | | | | | procedure | | | | | triggered by | | | | | a) above; and\ | | | | | c) NAS | | | | | signalling | | | | | connection | | | | | recovery | | | | | during an | | | | | ongoing | | | | | UE-requested | | | | | policy | | | | | provisioning | | | | | procedure for | | | | | V2XP or both | | | | | (see | | | | | 3GPP TS 24 | | | | | .587 [19B]). | | | | | | | | | | NOTE 11: The | | | | | term | | | | | \"non-3GPP | | | | | access\" | | | | | refers to the | | | | | case when the | | | | | UE is | | | | | accessing SNPN | | | | | services via a | | | | | PLMN. | | | | +----------------+----------------+----------------+----------------+
### 4.5.3 Operator-defined access categories
Operator-defined access category definitions can be signalled to the UE using
NAS signalling. Each operator-defined access category definition consists of
the following parameters:
a) a precedence value which indicates in which order the UE shall evaluate the
operator-defined category definition for a match;
b) an operator-defined access category number, i.e. access category number in
the 32-63 range that uniquely identifies the access category in the PLMN or
SNPN in which the access categories are being sent to the UE;
c) criteria consisting of one or more access category criteria type and
associated access category criteria type values. The access category criteria
type can be set to one of the following:
1) DNN;
2) Void;
3) OS Id + OS App Id of application triggering the access attempt; or
4) S-NSSAI; and
NOTE 1: An access category criteria type can be associated with more than one
access category criteria values.
d) optionally, a standardized access category. This standardized access
category is used in combination with the access identities of the UE to
determine the RRC establishment cause as specified in subclause 4.5.6.
If the access attempt is to establish a new PDU session i.e. it is triggered
by:
\- a request from upper layers to send an UL NAS TRANSPORT message for the
purpose of PDU session establishment unless the request triggered a service
request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode
with suspend indication to 5GMM-CONNECTED mode; or
\- a service request procedure to transition the UE from 5GMM-IDLE mode or
5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode triggered by a
request from upper layers to send an UL NAS TRANSPORT message for the purpose
of PDU session establishment,
then:
\- the access attempt matches access category criteria type DNN if the DNN
requested by the UE during the PDU session establishment procedure matches any
of the access criteria type values associated with the access criteria type
DNN; and
\- the access attempt matches access category criteria type S-NSSAI if the
S-NSSAI requested by the UE during the PDU session establishment procedure
matches any of the access criteria type values associated with the access
criteria type S-NSSAI.
If the access attempt is for an existing PDU session i.e. it is triggered by:
\- a request from upper layers to send an UL NAS TRANSPORT message for the
purpose of PDU session modification unless the request triggered a service
request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode
with suspend indication to 5GMM-CONNECTED mode;
\- a service request procedure to transition the UE from 5GMM-IDLE mode or
5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode triggered by a
request from upper layers to send an UL NAS TRANSPORT message for the purpose
of PDU session modification;
\- a service request procedure to transition the UE from 5GMM-IDLE mode or
5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode triggered by a
request from upper layers to send an UL NAS TRANSPORT message for the purpose
of PDU session release;
\- a service request procedure requesting user-plane resources for a PDU
session; or
\- an uplink user data packet is to be sent for a PDU session with suspended
user-plane resources,
then:
\- the access attempt matches access category criteria type DNN if the DNN
provided by the network in the PDU SESSION ESTABLISHMENT ACCEPT message
matches any of the access criteria type values associated with the access
criteria type DNN; and
\- the access attempt matches access category criteria type S-NSSAI if the
S-NSSAI associated with the PDU session matches any of the access criteria
type values associated with the access criteria type S-NSSAI.
An access attempt matches the criteria of an operator-defined access category
definition, if the access attempt matches all access category criteria types
included in the criteria with any of the associated access criteria type
values.
Each operator-defined access category definition has a different precedence
value.
Several operator-defined access category definitions can have the same
operator-defined access category number.
If:
\- an access category in bullet d) is not provided;
\- an access category in bullet d) is provided and is not a standardized
access category; or
\- an access category in bullet d) is provided, is a standardized access
category and is not recognized by the UE;
the UE shall use instead access category 7 (MO_data) in combination with the
access identities of the UE to determine the RRC establishment cause as
specified in subclause 4.5.6.
The operator-defined access category definitions are valid in the PLMN which
provided them and in a PLMN equivalent to the PLMN which provided them, or in
the SNPN which provided them, as specified in annex C.
If the UE stores operator-defined access category definitions valid in the
selected PLMN or the RPLMN, or valid in the selected SNPN or RSNPN, then
access control in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication
will only be performed for the event a) defined in subclause 4.5.1. If the
transition from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication over
3GPP access to 5GMM-CONNECTED mode is due to a UE NAS initiated 5GMM specific
procedure, then this access attempt shall be mapped to one of the standardized
access categories in the range \ ii) CONTROL PLANE SERVICE REQUEST message, the UE did not set the Control
> plane service type IE to \"emergency services fallback\", the UE has not
> included the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST
> message, or the UE has included the Uplink data status IE in the CONTROL
> PLANE SERVICE REQUEST message but the SERVICE ACCEPT message indicates that
> no user-plane resources of any PDU sessions are to be re-established;
3) the UE has not included the Allowed PDU session status IE or has included
the Allowed PDU session status IE indicating there is no PDU session(s) for
which the UE allowed the user-plane resource to be re-established over 3GPP
access in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST
message, or the UE has included the Allowed PDU session status IE in the
SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message but the
SERVICE ACCEPT message does not indicate that any user-plane resources of any
PDU sessions are to be re-established;
4) the service request procedure has been initiated in 5GMM-IDLE mode;
5) the user-plane resources for PDU sessions have not been set up;
6) the UE need not request resources for V2X communication over PC5 reference
point (see 3GPP TS 23.287 [6C]); and
7) the UE need not request resources for 5G ProSe direct discovery over PC5 or
5G ProSe direct communication over PC5 (see 3GPP TS 23.304 [6E]);
NOTE 2: The lower layers indicate when the user-plane resources for PDU
sessions are successfully established or released.
g) may start the timer T3540 if the UE receives any of the 5GMM cause values
#3 or #6 or if it receives an AUTHENTICATION REJECT message;
h) shall start the timer T3540 upon completion of the configuration update
procedure or the registration procedure if the UE does not have an emergency
PDU session and:
1) the UE received a CONFIGURATION UPDATE COMMAND message or a REGISTRATION
ACCEPT message while camping on a CAG cell and the entry for the current PLMN
in the received \"CAG information list\" does not include any of the CAG-ID(s)
supported by the current CAG cell;
2) the UE received a CONFIGURATION UPDATE COMMAND message or a REGISTRATION
ACCEPT message while camping on a non-CAG cell and the entry for the current
PLMN in the received \"CAG information list\" includes an \"indication that
the UE is only allowed to access 5GS via CAG cells\"; or
3) the UE received a CONFIGURATION UPDATE COMMAND message while camping on a
CAG cell and the entry for the current PLMN in not included in the received
\"CAG information list\"; or
i) shall start the timer T3540 for a UE in 3GPP access if:
1) the UE receives a SERVICE ACCEPT message; and
2) the UE:
\- has set Request type to \"NAS signalling connection release\" in the UE
request type IE in the SERVICE REQUEST message or CONTROL PLANE SERVICE
REQUEST message; or
\- has set Request type to \"Rejection of paging\" in the UE request type IE
in the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message and
the UE receives a CONFIGURATION UPDATE COMMAND message;
j) shall start the timer T3540 if the UE receives the 5GMM cause value #22
along with a T3346 value, and the value indicates that the timer T3346 is
neither zero nor deactivated and the NAS procedure has been initiated in 5GMM-
IDLE mode; or
k) shall start the timer T3540 if the UE receives a DEREGISTRATION ACCEPT
message.
Upon expiry of T3540,
\- in cases a), b), f), g), h), i), j) and k) the UE shall locally release the
established N1 NAS signalling connection;
\- in cases c) and d) the UE shall locally release the established N1 NAS
signalling connection and the UE shall initiate the registration procedure as
described in subclause 5.5.1.3 or 5.6.1.5; or
\- in case e), the UE shall locally release the established N1 NAS signalling
connection and perform a new registration procedure as specified in subclause
5.5.1.3.2.
In case a),
\- upon receiving a request from the upper layers to perform emergency
services fallback only for a UE in 3GPP access or establishing an emergency
PDU session, the UE shall stop timer T3540 and shall locally release the N1
NAS signalling connection, before proceeding as specified in subclause 5.5.1.
In case b) and f),
\- upon an indication from the lower layers that the user-plane resources for
PDU sessions are set up, the UE shall stop timer T3540 and may send uplink
signalling via the existing N1 NAS signalling connection or user data via user
plane. If the uplink signalling is associated with emergency services fallback
only for a UE in 3GPP access or establishing an emergency PDU session, the UE
shall stop timer T3540 and send the uplink signalling via the existing N1 NAS
signalling connection;
In case b), f) and i),
\- upon receipt of a DEREGISTRATION REQUEST message, the UE shall stop timer
T3540 and respond to the network-initiated de-registration request via the
existing N1 NAS signalling connection as specified in subclause 5.5.2.3;
\- upon receipt of a message of a network-initiated 5GMM common procedure, the
UE shall stop timer T3540 and respond to the network-initiated 5GMM common
procedure via the existing N1 NAS signalling connection as specified in
subclause 5.4;
\- if there is no user-plane resources established for PDU sessions, upon
receiving a request from the upper layers to perform emergency services
fallback only for a UE in 3GPP access or establishing an emergency PDU
session, the UE shall stop timer T3540 and shall locally release the N1 NAS
signalling connection, before proceeding as specified in subclause 5.6.1;
\- if there is no user-plane resources established for PDU sessions, upon
receiving a request from the upper layers to perform services other than
emergency services fallback only for a UE in 3GPP access or establishing an
emergency PDU session, the UE shall wait for the local release of the
established N1 NAS signalling connection upon expiry of timer T3540 or wait
for timer T3540 being stopped, before initiating NAS signalling;
\- upon receipt of a DL NAS TRANSPORT message, the UE shall stop timer T3540
and may send uplink signalling via the existing N1 NAS signalling connection;
or
\- upon initiation of registration procedure for mobility and periodic
registration update as specified in subclause 5.5.1.2.7 for cases h), i), j),
subclause 5.5.1.3.7 for cases j), k) or subclause 5.5.1.3.2 for case a), the
UE shall stop timer T3540.
In case c) and d),
\- upon an indication from the lower layers that the access stratum connection
has been released, the UE shall stop timer T3540 and perform a new
registration procedure as specified in subclause 5.5.1.3.5 or 5.6.1.5.
\- upon receiving a request from the upper layers to perform emergency
services fallback only for a UE in 3GPP access or establishing an emergency
PDU session, the UE shall stop timer T3540 and shall locally release the N1
NAS signalling connection, before proceeding as specified in subclause 5.5.1.
In case e),
\- upon an indication from the lower layers that the access stratum connection
has been released, the UE shall stop timer T3540 and perform a new
registration procedure as specified in subclause 5.5.1.3.2.
\- upon an indication from the lower layers that the user-plane resources for
PDU sessions are set up, the UE shall stop timer T3540 and may send user data
via user plane.
NOTE 3: In this case, the new registration procedure is performed when the UE
moves to the 5GMM-IDLE mode.
\- upon receiving a request from the upper layers to perform emergency
services fallback only for a UE in 3GPP access or establishing an emergency
PDU session, the UE shall stop timer T3540 and shall locally release the N1
NAS signalling connection, before proceeding as specified in subclause 5.5.1.
If the UE had set the Follow-on request indicator to \"Follow-on request
pending\" in the REGISTRATION REQUEST message due to pending uplink signalling
but cannot send the pending signalling due to new service area restrictions
received or due to network not supporting the feature as indicated in the
REGISTRATION ACCEPT message (for example UE set the \"Follow-on request
pending\" to send SMS over NAS but AMF notified \"SMS over NAS not allowed\")
and if there is no further pending data or signalling and user plane resources
have not been set up, the UE may locally release the established N1 NAS
signalling connection upon completion of the registration procedure.
NOTE 4: the UE is allowed to inform the lower layers that there is no 5GMM or
5GSM messages need to be sent over non-3GPP access if the UE receives a
REGISTRATION REJECT message over non-3GPP access or a SERVICE REJECT message
over non-3GPP access.
If the timer T3540 is not running when the UE enters state 5GMM-
DEREGISTERED.PLMN-SEARCH or 5GMM-REGISTERED.PLMN-SEARCH, the UE may locally
release the N1 NAS signalling connection.
#### 5.3.1.4 5GMM-CONNECTED mode with RRC inactive indication
This subclause is only applicable for UE\'s 5GMM mode over 3GPP access. The
5GMM-CONNECTED mode with RRC inactive indication is not supported when the UE
is in NB-N1 mode.
The UE is in 5GMM-CONNECTED mode with RRC inactive indication when the UE is
in:
a) 5GMM-CONNECTED mode over 3GPP access at the NAS layer; and
b) RRC_INACTIVE state at the AS layer (see 3GPP TS 38.300 [27]).
Unless stated otherwise, the UE behaviour in 5GMM-CONNECTED mode with RRC
inactive indication follows the UE behaviour in 5GMM-CONNECTED over 3GPP
access, except that:
a) the UE shall apply the mobility restrictions; and
b) the UE shall perform the PLMN selection procedures
as in 5GMM-IDLE mode over 3GPP access.
The UE shall transition from 5GMM-CONNECTED mode over 3GPP access to 5GMM-
CONNECTED mode with RRC inactive indication upon receiving an indication from
the lower layers that the RRC connection has been suspended.
NOTE 1: Any pending procedure or uplink data packet when receiving an
indication from the lower layers that the RRC connection has been suspended,
triggers a request to the lower layers to transition to RRC_CONNECTED state.
This is also the case when the pending procedure or uplink data packet
triggered a previous request to the lower layers to transition to
RRC_CONNECTED state.
Upon:
a) a trigger of a procedure which requires sending of a NAS message different
from a REGISTRATION REQUEST message with the NG-RAN-RCU bit of the 5GS update
type IE set to \"UE radio capability update needed\";
b) an uplink user data packet to be sent for a PDU session with suspended
user-plane resources;
c) a trigger to request resources for 5G ProSe direct discovery over PC5 or 5G
ProSe direct communication over PC5; or
d) a trigger to request resources for V2X communication over PC5 (see 3GPP TS
23.287 [6C]);
the UE in 5GMM-CONNECTED mode with RRC inactive indication over 3GPP access
shall request the lower layers to transition to RRC_CONNECTED state (see 3GPP
TS 38.300 [27]).
NOTE 2: If the UE supports Small Data Transmission (SDT) (see 3GPP TS 38.300
[27]), the following applies:
a) if the UE due to pending uplink NAS messages or user data packets is
requesting the lower layers to transition to RRC_CONNECTED state, but has not
received a response from the lower layers, the UE can send the pending NAS
messages or user data packets to the lower layers, and can receive multiple
downlink NAS messages or multiple downlink user data packets from the lower
layers while the UE remains in 5GMM-CONNECTED mode with RRC inactive
indication over 3GPP access (i.e., without transitioning to 5GMM-CONNECTED
mode). When the NAS layer triggers the transmission of pending uplink NAS
messages or user data packets, and if the SDT is ongoing, the NAS layer will
receive the response from the lower layers only after the SDT session has
completed or failed;
b) the NAS layer is not aware of the classification of NAS messages or the
user data packets as belonging to the SDT session at the lower layers; and
c) the setting of access category and the RRC establishment cause indicated to
the lower layers when sending the pending uplink user data packets while the
UE remains in 5GMM-CONNECTED mode with RRC inactive indication, is left to
implementation.
Upon a trigger to send a REGISTRATION REQUEST message with the NG-RAN-RCU bit
of the 5GS update type IE set to \"UE radio capability update needed\", the UE
in 5GMM-CONNECTED mode with RRC inactive indication shall move to 5GMM-IDLE
mode over 3GPP access and proceed with the registration procedure for mobility
and periodic registration as specified in subclause 5.5.1.3.2.
The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication
to 5GMM-CONNECTED mode over 3GPP access upon receiving an indication from the
lower layers that the UE has transitioned to RRC_CONNECTED state (see 3GPP TS
38.300 [27]).
NOTE 3: The AMF can be aware of the transition between 5GMM-CONNECTED mode and
5GMM-CONNECTED mode with RRC inactive indication for a UE (see 3GPP TS 23.502
[9]).
The UE shall trigger a transition from 5GMM-CONNECTED mode with RRC inactive
indication to 5GMM-IDLE mode upon selection of a PLMN that is not an
equivalent PLMN to the registered PLMN. The UE shall not trigger a transition
from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode upon
entering a new PLMN which is in the list of equivalent PLMNs.
The UE shall trigger a transition from 5GMM-CONNECTED mode with RRC inactive
indication to 5GMM-IDLE mode upon receiving REFRESH command from the UICC as
specified in subclause 5.4.5.3.3.
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an
indication from the lower layers that the RRC connection has been suspended,
the UE shall stay in 5GMM-CONNECTED mode with RRC inactive indication. The UE
shall re-initiate any pending procedure that had triggered the request to the
lower layers to transition to RRC_CONNECTED state, if still needed.
When the UE in 5GMM-CONNECTED mode with RRC inactive indication receives a
fallback indication from lower layers, and the UE has no pending NAS procedure
and no pending uplink user data for PDU session(s) with user-plane resources
already established, the UE shall:
a) enter 5GMM-IDLE mode; and
b) initiate the registration procedure for mobility and periodic registration
update as specified for case o) in subclause 5.5.1.3.2.
If the UE requests the lower layers to transition to RRC_CONNECTED state at
initiation of a registration procedure, a service request procedure or a de-
registration procedure, upon fallback indication from lower layers, the UE
shall:
\- enter 5GMM-IDLE mode;
\- proceed with the pending procedure; and
\- if the pending procedure is a service request or registration request
procedure and the SERVICE REQUEST message, the CONTROL PLANE SERVICE REQUEST
message or the REGISTRATION REQUEST message does not include UE request type
IE with Request type value set to \"NAS signalling connection release\", the
UE shall include the Uplink data status IE in the SERVICE REQUEST message, the
CONTROL PLANE SERVICE REQUEST message or in the REGISTRATION REQUEST message,
indicating the PDU session(s) without active user-plane resources for which
the UE has pending user data to be sent, if any, and the PDU session(s) for
which user-plane resources were active prior to receiving the fallback
indication, if any (see subclauses 5.5.1.3 and 5.6.1 for further details).
If the UE requests the lower layers to transition to RRC_CONNECTED state for
other reason than initiation of a registration procedure, or for other reason
than a service request procedure, or for other reason than a de-registration
procedure, upon fallback indication from lower layers, the UE shall:
1) enter 5GMM-IDLE mode;
2) initiate the service request procedure and include the Uplink data status
IE in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message
indicating the PDU session(s) for which user-plane resources were active prior
to receiving the fallback indication, if any (see subclause 5.6.1 for further
details). If the procedure that triggered the request to the lower layers to
transition to RRC_CONNECTED state is the UE-initiated NAS transport procedure
and the UE had SMS, location services message, or CIoT user data to send, the
UE shall also include the SMS, location services message, or CIoT user data in
the CONTROL PLANE SERVICE REQUEST message as described in subclause 5.6.1.2.2;
and
3) upon successful service request procedure completion, proceed with any
pending procedure.
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives a
fallback indication from lower layers, and the UE has pending uplink user data
for PDU session(s) with user-plane resources already established but no
pending NAS procedure, the UE shall:
1) enter 5GMM-IDLE mode; and
2) initiate the service request procedure and include the Uplink data status
IE in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message
indicating the PDU session(s) for which user-plane resources were active prior
to receiving the fallback indication (see subclause 5.6.1 for further
details).
In the above cases when the UE receives a fallback indication from lower
layers, if the UE is in non-allowed area or not in allowed area, the UE shall
behave as specified in subclause 5.3.5.
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an
indication from the lower layers that the resumption of the RRC connection has
failed, and:
a) if the lower layers indicate that access barring is applicable for all
access categories except categories 0 and 2, or access barring is applicable
for all access categories except category 0, the UE shall:
1) stay in 5GMM-CONNECTED mode with RRC inactive indication;
b) else, the UE shall:
1) enter 5GMM-IDLE mode; and
2) initiate the registration procedure for mobility and periodic registration
update used for mobility (i.e. the 5GS registration type IE set to \"mobility
registration updating\" in the REGISTRATION REQUEST message) for N1 NAS
signalling connection recovery as specified for case f) in subclause
5.5.1.3.2.
NOTE 4: An indication from the lower layer that the RRC connection has been
released with cause \"RRC resume failure\" can be considered as an indication
that the resumption of the RRC connection has failed.
The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication
to 5GMM-IDLE mode over 3GPP access upon receiving from the lower layers:
a) indication of transition from RRC_INACTIVE state to RRC_IDLE state; or
b) indication of cell selection to E-UTRAN or another RAT that the UE
supports.
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an
indication from the lower layers about the cell (re-)selection to different
RAT that the UE supports, the UE shall initiate the registration procedure for
mobility or periodic registration update used for mobility (i.e. the 5GS
registration type IE set to \"mobility registration updating\" in the
REGISTRATION REQUEST message) as specified in subclause 5.5.1.3.2.
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an
indication from the lower layers of a transition from RRC_INACTIVE state to
RRC_IDLE state and 5GMM-REGISTERED.LIMITED-SERVICE is entered, the UE shall
subsequently upon entering state 5GMM-REGISTERED.NORMAL-SERVICE and if there
is no uplink user data or signalling pending, initiate the registration
procedure for mobility and periodic registration update used for mobility
(i.e. the 5GS registration type IE set to \"mobility registration updating\"
in the REGISTRATION REQUEST message) for N1 NAS signalling connection recovery
as specified in subclause 5.5.1.3.2.
If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an
indication from the lower layers about RAN paging and the MUSIM UE decides not
to initiate the service request procedure with service type set to \"mobile
terminated services\" or control plane service type set to \"mobile
terminating request\" to respond to the RAN paging, the UE may initiate the
service request procedure and set request type to \"NAS signalling connection
release\" in the UE request type IE and service type to \"signalling\" in the
SERVICE REQUEST message or set request type to \"NAS signalling connection
release\" in the UE request type IE and control plane service type set to
\"mobile originating request\" in the CONTROL PLANE SERVICE REQUEST message to
reject the RAN paging as specified in subclause 5.6.1.2 for case o of
subclause 5.6.1.1. The UE may include its paging restriction preferences in
the Paging restriction IE in the SERVICE REQUEST message or CONTROL PLANE
SERVICE REQUEST message as specified in subclause 5.6.1.2 for case o of
subclause 5.6.1.1.
NOTE 5: The interworking between the NAS layer and the AS layer triggered by
RAN paging is up to UE implementation.
NOTE 6: As an implementation option, the MUSIM UE is allowed to not respond to
RAN paging based on the information available in the paging message, e.g.
voice service indication.
Upon receiving AMF paging indication from the lower layers, the UE shall
transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE
mode over 3GPP access and handle the AMF paging same as the paging request
received in the 5GMM-IDLE mode over 3GPP access as specified in subclause
5.6.1.
#### 5.3.1.5 Suspend and resume of the N1 NAS signalling connection
Suspend of the N1 NAS signalling connection can be initiated by the network in
5GMM-CONNECTED mode when user plane CIoT 5GS optimization is used. Resume of
the suspended N1 NAS signalling connection is initiated by the UE.
In the UE, when user plane CIoT 5GS optimization is used:
\- Upon idle suspend indication from the lower layers, the UE shall enter
5GMM-IDLE mode with suspend indication, shall not consider the N1 NAS
signalling connection released and shall not consider the secure exchange of
NAS messages terminated (see subclause 4.4.2.5 and 4.4.5).
\- Upon trigger of a procedure using an initial NAS message when in 5GMM-IDLE
mode with suspend indication, the UE shall:
i) if the initial NAS message is a REGISTRATION REQUEST message with the NG-
RAN-RCU bit of the 5GS update type IE set to \"UE radio capability update
needed\", enter 5GMM-IDLE mode without suspend indication and proceed with the
registration procedure; or
ii) otherwise, request the lower layer to resume the RRC connection.
NOTE 1: In NB-N1 mode, in the request to the lower layer the data volume
information of the initial NAS message is provided to the lower layers.
Interactions between the NAS and the lower layers in order to obtain the data
volume information of the initial NAS message (see 3GPP TS 36.321 [25E], 3GPP
TS 36.331 [25A]) is left to implementations.
\- Upon indication from the lower layers that the RRC connection has been
resumed when in 5GMM-IDLE mode with suspend indication, the UE shall enter
5GMM-CONNECTED mode. If the pending NAS message is:
i) a SERVICE REQUEST message, the service type IE is not set to \"emergency
services fallback\", and the UE did not include the NAS message container IE
in the SERVICE REQUEST message; or
ii) a CONTROL PLANE SERVICE REQUEST message, and the UE did not include the
CIoT small data container IE or the NAS message container IE in the CONTROL
PLANE SERVICE REQUEST message,
the message shall not be sent. Otherwise the UE shall cipher the message as
specified in subclause 4.4.5 and send the pending initial NAS message upon
entering 5GMM-CONNECTED mode;
NOTE 2: If a NAS message is discarded and not sent to the network, the uplink
NAS COUNT value corresponding to that message is reused for the next uplink
NAS message to be sent.
\- Upon fallback indication from the lower layers at RRC connection resume
when in 5GMM-IDLE mode with suspend indication, the UE shall enter 5GMM-IDLE
mode without suspend indication, send any pending initial NAS message and
proceed as if RRC connection establishment had been requested;
\- Upon indication from the lower layers that the RRC connection resume has
failed and indication from the lower layers that the RRC connection is
suspended, the UE shall enter 5GMM-IDLE mode with suspend indication and
restart the ongoing NAS procedure if required; and
\- Upon indication from the lower layers that the RRC connection resume has
failed and indication from the lower layers that the RRC connection is not
idle suspended, the UE shall enter 5GMM-IDLE mode without suspend indication
and restart the ongoing NAS procedure if required.
In the network, when user plane CIoT 5GS optimization is used:
\- Upon idle suspend indication from the lower layers, the network shall enter
5GMM-IDLE mode with suspend indication, shall not consider the N1 NAS
signalling connection released and shall not consider the secure exchange of
NAS messages terminated; and
\- Upon indication from the lower layers that it has received the NGAP UE
context resume request message as specified in 3GPP TS 38.413 [31] when in
5GMM-IDLE mode with suspend indication, the network shall enter 5GMM-CONNECTED
mode.
### 5.3.2 Permanent identifiers
A globally unique permanent identity, the 5G subscription permanent identifier
(SUPI), is allocated to each subscriber for 5GS-based services. The IMSI, the
network specific identifier, the GCI and the GLI are valid SUPI types. When
the SUPI contains a network specific identifier, a GCI or a GLI, it shall take
the form of a network access identifier (NAI). When the UE performs initial
registration for onboarding services in SNPN or is registered for onboarding
services in SNPN, the SUPI contains the onboarding SUPI derived from the
default UE credentials for primary authentication. The UE derives the
onboarding SUPI before or during the initial registration for onboarding
services in SNPN and uses the derived onboarding SUPI in the initial
registration for onboarding services in SNPN and while registered for
onboarding services in SNPN.
The structure of the SUPI and its derivatives are specified in 3GPP TS 23.003
[4].
The UE provides the SUPI to the network in concealed form. The SUCI is a
privacy preserving identifier containing the concealed SUPI. When the SUPI
contains a network specific identifier, a GCI or a GLI, the SUCI shall take
the form of a NAI as specified in 3GPP TS 23.003 [4].
A UE supporting N1 mode includes a SUCI:
a) in the REGISTRATION REQUEST message when the UE is attempting initial
registration procedure and a valid 5G-GUTI is not available;
b) in the IDENTITY RESPONSE message, if the SUCI is requested by the network
during the identification procedure; and
c) in the DEREGISTRATION REQUEST message when the UE initiates a de-
registration procedure and a valid 5G-GUTI is not available.
If the UE uses the \"null-scheme\" as specified in 3GPP TS 33.501 [24] to
generate a SUCI, the SUCI contains the unconcealed SUPI.
When:
\- not operating in SNPN access operation mode; or
\- operating in SNPN access operation mode but not performing initial
registration for onboarding services and not registered for onboarding
services;
the UE shall use the \"null-scheme\" if:
a) the home network has not provisioned the public key needed to generate a
SUCI;
b) the home network has configured \"null-scheme\" to be used for the UE;
c) the UE needs to perform a registration procedure for emergency services
after the failure of authentication procedure or after reception of a
REGISTRATION REJECT message with the 5GMM cause #3 \"Illegal UE\", or to
initiate a de-registration procedure before the registration procedure for
emergency services was completed successfully, and the UE does not have a
valid 5G-GUTI for the selected PLMN; or
d) the UE receives an identity request for SUCI during a registration
procedure for emergency services or during a de-registration procedure that
was initiated before the registration procedure for emergency services was
completed successfully.
When operating in SNPN access operation mode and:
\- performing initial registration for onboarding services; or
\- registered for onboarding services;
the UE shall use the \"null-scheme\" if:
a) the public key needed to generate a SUCI is not configured as part of the
default UE credentials for primary authentication; or
b) \"null-scheme\" usage is configured as part of the default UE credentials
for primary authentication.
If:
a) the UE uses the \"null-scheme\" as specified in 3GPP TS 33.501 [24] to
generate a SUCI;
b) the UE operates in SNPN access operation mode and:
1) an indication to use anonymous SUCI which is associated with the selected
entry of the \"list of subscriber data\", is configured in the ME, if the UE
is not registering or registered for onboarding services in SNPN; or
2) an indication to use anonymous SUCI which is associated with the default UE
credentials for primary authentication, is configured in the ME, if the UE is
registering or registered for onboarding services in SNPN;
NOTE 1: The ME can be configured with an indication to use anonymous SUCI
associated with an entry of \"list of subscriber data\" when the EAP method
associated with the credentials of the entry supports SUPI privacy at the EAP
layer, or can be configured with an indication to use anonymous SUCI
associated with the default UE credentials for primary authentication when the
EAP method associated with the default UE credentials for primary
authentication supports SUPI privacy at the EAP layer, or both.
c) the UE does not need to perform a registration procedure for emergency
services, or to initiate a de-registration procedure before the registration
procedure for emergency services was completed successfully; and
d) the UE does not receive an identity request for SUCI during a registration
procedure for emergency services or during a de-registration procedure that
was initiated before the registration procedure for emergency services was
completed successfully;
then the UE shall use anonymous SUCI as specified in 3GPP TS 23.003 [4].
A W-AGF acting on behalf of an FN-RG shall use the \"null-scheme\" as
specified in 3GPP TS 33.501 [24] to generate a SUCI.
A W-AGF acting on behalf of an N5GC device shall use the \"null-scheme\" as
specified in 3GPP TS 33.501 [24] to generate a SUCI.
If a UE is a MUSIM UE, the UE shall use a separate permanent equipment
identifier (PEI) for each USIM, if any, and each entry of \"list of subscriber
data\", if any, the UE operates for accessing 5GS-based services; otherwise, a
UE contains and uses a permanent equipment identifier (PEI) for accessing 5GS-
based services. When the UE is registered with a network by using a PEI, the
UE shall not use that PEI to register with another network until the UE is de-
registered from the network.
In this release of the specification, the IMEI, the IMEISV, the MAC address
together with the MAC address usage restriction indication and the EUI-64 are
the only PEI formats supported by 5GS. The structure of the PEI and its
formats are specified in 3GPP TS 23.003 [4].
Each UE supporting at least one 3GPP access technology (i.e. satellite NG-RAN,
NG-RAN, satellite E-UTRAN, E-UTRAN, UTRAN or GERAN) contains a PEI in the IMEI
format and shall be able to provide an IMEI and an IMEISV upon request from
the network.
Each UE not supporting any 3GPP access technologies and supporting NAS over
untrusted or trusted non-3GPP access shall have a PEI in the form of the
Extended Unique Identifier EUI-64 [48] of the access technology the UE uses to
connect to the 5GC.
A UE supporting N1 mode includes a PEI:
a) when neither SUPI nor valid 5G-GUTI is available to use for emergency
services in the REGISTRATION REQUEST message with 5GS registration type IE set
to \"emergency registration\";
b) when the network requests the PEI by using the identification procedure, in
the IDENTITY RESPONSE message; and
c) when the network requests the IMEISV by using the security mode control
procedure, in the SECURITY MODE COMPLETE message.
Each 5G-RG supporting only wireline access and each FN-RG shall have a
permanent MAC address configured by the manufacturer. For 5G-CRG, the
permanent MAC address configured by the manufacturer shall be a cable modem
MAC address.
When the 5G-RG contains neither an IMEI nor an IMEISV, the 5G-RG shall use as
a PEI the 5G-RG\'s permanent MAC address configured by the manufacturer and
the MAC address usage restriction indication set to \"no restrictions\".
The W-AGF acting on behalf of the FN-RG shall use as a PEI the MAC address
provided by the FN-RG and if the MAC address provided by the FN-RG is not
unique or does not correspond to the FN-RG\'s permanent MAC address according
to W-AGF\'s configuration, the MAC address usage restriction indication set to
\"MAC address is not usable as an equipment identifier\" otherwise the MAC
address usage restriction indication set to \"no restrictions\".
The 5G-RG containing neither an IMEI nor an IMEISV shall include the PEI
containing the MAC address together with the MAC address usage restriction
indication:
a) when neither SUPI nor valid 5G-GUTI is available to use for emergency
services in the REGISTRATION REQUEST message with 5GS registration type IE set
to \"emergency registration\";
b) when the network requests the PEI by using the identification procedure, in
the IDENTIFICATION RESPONSE message; and
c) when the network requests the IMEISV by using the security mode control
procedure, in the SECURITY MODE COMPLETE message.
NOTE 2: In case c) above, the MAC address is provided even though AMF requests
the IMEISV.
The W-AGF acting on behalf of the FN-RG shall include the PEI containing the
MAC address together with the MAC address usage restriction indication:
a) when the network requests the PEI by using the identification procedure, in
the IDENTIFICATION RESPONSE message; and
b) when the network requests the IMEISV by using the security mode control
procedure, in the SECURITY MODE COMPLETE message.
NOTE 3: In case b) above, the MAC address is provided even though AMF requests
the IMEISV.
The W-AGF acting on behalf of the N5GC device shall use as a PEI the MAC
address provided by the N5GC device and the MAC address usage restriction
indication set to \"no restrictions\". Based on operator policy, the W-AGF
acting on behalf of the N5GC device may encode the MAC address of the N5GC
device using the EUI-64 format as specified in [48] and use as a PEI the
derived EUI-64.
NOTE 4: The MAC address of an N5GC device is universally/globally unique.
The AMF can request the PEI at any time by using the identification procedure.
### 5.3.3 Temporary identities
A temporary user identity for 5GS-based services, the 5G globally unique
temporary identity (5G-GUTI), is used for identification within the signalling
procedures. In case of PLMN the 5G-GUTI is globally unique and in case of SNPN
the 5G-GUTI is unique within an SNPN. When the UE is registered to the same
PLMN or SNPN over 3GPP and non-3GPP access, the UE and the AMF maintain one
5G-GUTI that is common to both 3GPP and non-3GPP access. When the UE is
required to delete the 5G-GUTI according to a NAS procedure, the UE shall
delete the 5G-GUTI only if it is not registered to the same PLMN or SNPN
through other access. When the UE is registered to different PLMNs or SNPNs
over 3GPP access and non-3GPP access, the UE maintains two 5G-GUTIs, a 5G-GUTI
for the registration with a PLMN or SNPN over the 3GPP access and another
5G-GUTI for the registration with another PLMN or SNPN over the non-3GPP
access. In the paging and service request procedures, a shortened form of the
5G-GUTI, the 5G S-temporary mobile subscriber identity (5G-S-TMSI), is used to
enable more efficient radio signalling. The purpose of the 5G-GUTI and 5G-S-
TMSI is to provide identity confidentiality, i.e., to protect a user from
being identified and located by an intruder. The structure of the 5G-GUTI and
its derivatives are specified in 3GPP TS 23.003 [4]. The 5G-GUTI has two main
components (see 3GPP TS 23.501 [8]):
a) the GUAMI; and
b) the 5G-TMSI that provides an unambiguous identity of the UE within the
AMF(s) identified by the GUAMI.
NOTE: The UE registered with an SNPN over non-3GPP access refers to the UE
accessing SNPN services via a PLMN.
The 5G-S-TMSI has three main components:
a) the AMF set ID that uniquely identifies the AMF set within the AMF region;
b) the AMF pointer that identifies one or more AMFs within the AMF set; and
c) the 5G-TMSI.
A UE supporting N1 mode includes a valid 5G-GUTI, if any is available, in the
REGISTRATION REQUEST and DEREGISTRATION REQUEST messages. In the SERVICE
REQUEST message, the UE includes a valid 5G-S-TMSI as user identity. The AMF
shall assign a new 5G-GUTI for a particular UE:
a) during a successful initial registration procedure;
b) during a successful registration procedure for mobility registration
update;
c) after a successful service request procedure invoked as a response to a
paging request from the network and before the:
1) release of the N1 NAS signalling connection; or
2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS
optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend
indication;
as specified in subclause 5.4.4.1; and
d) after the AMF receives an indication from the lower layers that it has
received the NGAP UE context resume request message as specified in 3GPP TS
38.413 [31] for a UE in 5GMM-IDLE mode with suspend indication and this
resumption is a response to a paging request from the network, and before the:
1) release of the N1 NAS signalling connection; or
2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS
optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend
indication;
as specified in subclause 5.4.4.1.
The AMF should assign a new 5G-GUTI for a particular UE during a successful
registration procedure for periodic registration update. The AMF may assign a
new 5G-GUTI at any time for a particular UE by performing the generic UE
configuration update procedure.
If a new 5G-GUTI is assigned by the AMF, the UE and the AMF handle the 5G-GUTI
as follows:
a) Upon receipt of a 5GMM message containing a new 5G-GUTI, the UE considers
the new 5G-GUTI as valid and the old 5G-GUTI as invalid, stops timer T3519 if
running, and deletes any stored SUCI. The new 5G-GUTI is stored in a non-
volatile memory in the USIM if the corresponding file is present in the USIM,
else in the non-volatile memory in the ME, as described in annex C.
b) The AMF considers the old 5G-GUTI as invalid as soon as an acknowledgement
for a registration or generic UE configuration update procedure is received.
### 5.3.4 Registration areas
Within the 5GS, the registration area is managed independently per access
type, i.e., 3GPP access or non-3GPP access. The AMF assigns a registration
area to the UE during the registration procedure. A registration area is
defined as a set of tracking areas and each of these tracking areas consists
of one or more cells that cover a geographical area. Within the 5GS, the
concept of \"registration to multiple tracking areas\" applies:
a) A tracking area is identified by a TAI which is broadcast in the cells of
the tracking area. The TAI is constructed from a TAC and a PLMN identity. In
case of a shared network:
1) one or more TACs; and
2) any of the following:
i) multiple PLMN identities;
ii) multiple SNPN identities; or
iii) one or more PLMN identities and one or more SNPN identities;
are broadcast.
b) In order to reduce the tracking area update signalling within the 5GS, the
AMF can assign several tracking areas to the UE. These tracking areas
construct a list of tracking areas which is identified by a TAI list. When
generating the TAI list, the AMF shall include only TAIs that are applicable
on the access where the TAI list is sent. The AMF shall be able to allocate a
TAI list over different NG-RAN access technologies. The AMF shall not allocate
a TAI list containing both tracking areas in NB-N1 mode and tracking areas not
in NB-N1 mode.
c) The UE considers itself registered to a list of tracking areas and does not
need to trigger the registration procedure for mobility and periodic
registration update used for mobility (i.e. the 5GS registration type IE set
to \"mobility registration updating\" in the REGISTRATION REQUEST message) as
long as the UE stays in one of the tracking areas of the list of tracking
areas received from the AMF.
d) The UE will consider the TAI list as valid, until it receives a new TAI
list in the next registration procedure for mobility and periodic registration
update or generic UE configuration update procedure, or the UE is commanded by
the network to delete the TAI list by a reject message or it is deregistered
from the 5GS. If the registration request is accepted or the TAI list is
reallocated by the AMF, the AMF shall provide at least one entry in the TAI
list. If the new and the old TAI list are identical, the AMF does not need to
provide the new TAI list to the UE during mobility registration update or
periodic registration update.
e) The TAI list can be reallocated by the AMF.
f)- When the UE is deregistered from the 5GS, the TAI list in the UE is
invalid.
g) The UE includes the last visited registered TAI, if available, to the AMF.
The last visited registered TAI is stored in a non-volatile memory in the USIM
if the corresponding file is present in the USIM, else in the non-volatile
memory in the ME, as described in annex C.
### 5.3.5 Service area restrictions
#### 5.3.5.1 General
Service area restrictions are applicable only to 3GPP access and to wireline
access.
Subclause 5.3.5.2 applies when the UE accesses 5GCN over 3GPP access.
Subclause 5.3.5.3 applies when the 5G-RG or the W-AGF acting on behalf of an
FN-CRG (or on behalf of the N5GC device) access 5GCN over wireline access.
NOTE: Service area restrictions are not applicable for the W-AGF acting on
behalf of the FN-BRG.
#### 5.3.5.2 3GPP access service area restrictions
The service area restrictions consist of tracking areas forming either an
allowed area, or a non-allowed area. The tracking areas belong to either the
registered PLMN or its equivalent PLMNs in the registration area. The allowed
area can contain up to 16 tracking areas or include all tracking areas in the
registered PLMN and its equivalent PLMN(s) in the registration area. The non-
allowed area can contain up to 16 tracking areas. The network conveys the
service area restrictions to the UE by including either an allowed area, or a
non-allowed area, but not both, in the Service area list IE of a REGISTRATION
ACCEPT message or a CONFIGURATION UPDATE COMMAND message.
If the network does not convey the service area restrictions to the UE in the
Service area list IE of a REGISTRATION ACCEPT message, the UE shall treat all
tracking areas in the registered PLMN and its equivalent PLMN(s) in the
registration area as allowed area and delete the stored list of \"allowed
tracking areas\" or the stored list of \"non-allowed tracking areas\".
When the UE receives a Service area list IE with an allowed area indication
during a registration procedure or a generic UE configuration update
procedure:
a) if the \"Type of list\" included in the Service area list IE does not
indicate \"all TAIs belonging to the PLMNs in the registration area are
allowed area\", the UE shall delete the old list of \"allowed tracking areas\"
and store the tracking areas in the allowed area as the list of \"allowed
tracking areas\". If the UE has a stored list of \"non-allowed tracking
areas\", the UE shall delete that list; or
b) if the \"Type of list\" included in the Service area list IE indicates
\"all TAIs belonging to the PLMNs in the registration area are allowed area\",
the UE shall treat all tracking areas in the registered PLMN and its
equivalent PLMN(s) as allowed area and delete the stored list of \"allowed
tracking areas\" or the stored list of \"non-allowed tracking areas\".
When the UE receives a Service area list IE with a non-allowed area indication
during a registration procedure or a generic UE configuration update
procedure, the UE shall delete the old list of \"non-allowed tracking areas\"
and store the tracking areas in the non-allowed area as the list of \"non-
allowed tracking areas\". If the UE has a stored list of \"allowed tracking
areas\", the UE shall delete that list.
If the UE is successfully registered to a PLMN and has a stored list of
\"allowed tracking areas\":
a) while the current TAI is in the list of \"allowed tracking areas\", the UE
shall stay in, or enter, the state 5GMM-REGISTERED.NORMAL-SERVICE and is
allowed to initiate any 5GMM and 5GSM procedures; and
b) while the UE is camped on a cell which is in the registered PLMN or a PLMN
from the list of equivalent PLMNs and the current TAI is not in the list of
\"allowed tracking areas\", the UE shall enter the state 5GMM-REGISTERED.NON-
ALLOWED-SERVICE, and:
1) if the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication
over 3GPP access, the UE:
i) shall not include the Uplink data status IE in the registration procedure
for mobility and periodic registration update except for emergency services or
for high priority access;
ii) shall not perform the registration procedure for mobility and periodic
registration update with Follow-on request indicator set to \"Follow-on
request pending\", except for:
\- emergency services;
\- high priority access;
\- indicating a change of 3GPP PS data off UE status;
\- sending an SOR transparent container;
\- sending a UE policy container; or
\- sending a UE parameters update transparent container;
iii) shall not initiate a service request procedure or request the lower
layers to resume a suspended connection, except for:
\- emergency services;
\- emergency services fallback;
\- high priority access;
\- responding to paging;
\- responding to notification received over non-3GPP access;
\- indicating a change of 3GPP PS data off UE status;
\- sending an SOR transparent container;
\- sending a UE policy container; or
\- sending a UE parameters update transparent container; and
2) if the UE is in 5GMM-CONNECTED mode or 5GMM-CONNECTED mode with RRC
inactive indication over 3GPP access, the UE:
i) shall not perform the registration procedure for mobility and periodic
registration update with Uplink data status IE except for emergency services
or for high priority access;
ii) shall not initiate a service request procedure except for:
\- emergency services;
\- emergency services fallback;
\- high priority access;
\- responding to paging or responding to notification received over non-3GPP
access;
iii) shall not initiate a 5GSM procedure except for:
\- emergency services;
\- high priority access; or
\- indicating a change of 3GPP PS data off UE status; and
iv) shall not perform the NAS transport procedure except for the sending:
\- SMS;
\- an LPP message;
\- a location services message;
\- an SOR transparent container;
\- a UE policy container;
\- a UE parameters update transparent container; or
\- a CIoT user data container.
NOTE 1: The contents of CIoT user data container can be data that is not for
exception reports, or data that is for exception reports if allowed for the UE
(see subclause 6.2.13).
If the UE is successfully registered to a PLMN and has a stored list of \"non-
allowed tracking areas\":
a) while the UE is camped on a cell which is in the registered PLMN or a PLMN
from the list of equivalent PLMNs and the current TAI is not in the list of
\"non-allowed tracking areas\", the UE shall stay in, or enter, the state
5GMM-REGISTERED.NORMAL-SERVICE and is allowed to initiate any 5GMM and 5GSM
procedures; and
b) while the current TAI is in the list of \"non-allowed tracking areas\", the
UE shall enter the state 5GMM-REGISTERED.NON-ALLOWED-SERVICE, and:
1) if the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication
over 3GPP access, the UE:
i) shall not include the Uplink data status IE in the registration procedure
for mobility and periodic registration update except for emergency services or
for high priority access;
ii) shall not perform the registration procedure for mobility and periodic
registration update with Follow-on request indicator set to \"Follow-on
request pending\", except for:
\- emergency services;
\- high priority access;
\- indicating a change of 3GPP PS data off UE status;
\- sending an SOR transparent container;
\- sending a UE policy container; or
\- sending a UE parameters update transparent container; and
iii) shall not initiate a service request procedure or request the lower
layers to resume a suspended connection, except for:
\- emergency services;
\- emergency services fallback;
\- high priority access;
\- responding to paging;
\- responding to notification received over non-3GPP access;
\- indicating a change of 3GPP PS data off UE status;
\- sending an SOR transparent container;
\- sending a UE policy container; or
\- sending a UE parameters update transparent container; and
2) if the UE is in 5GMM-CONNECTED mode or 5GMM-CONNECTED mode with RRC
inactive indication over 3GPP access, the UE:
i) shall not perform the registration procedure for mobility and registration
update with the Uplink data status IE except for emergency services or for
high priority access;
ii) shall not initiate a service request procedure or request the lower layers
to resume a suspended connection, except for:
\- emergency services;
\- emergency services fallback;
\- high priority access; or
\- responding to paging or responding to notification received over non-3GPP
access;
iii) shall not initiate a 5GSM procedure except for:
\- emergency services;
\- high priority access; or
\- indicating a change of 3GPP PS data off UE status; and
iv) shall not perform the NAS transport procedure except for the sending:
\- SMS;
\- an LPP message;
\- a location services message;
\- an SOR transparent container;
\- a UE policy container;
\- a UE parameters update transparent container; or
\- a CIoT user data container.
NOTE 2: The contents of CIoT user data container can be data that is not for
exception reports, or data that is for exception reports if allowed for the UE
(see subclause 6.2.13).
The list of \"allowed tracking areas\", as well as the list of \"non-allowed
tracking areas\" shall be erased when:
a) the UE is switched off; and
b) the UICC containing the USIM is removed or an entry of the \"list of
subscriber data\" with the SNPN identity of the SNPN is updated.
When a tracking area is added to the list of \"5GS forbidden tracking areas
for roaming\" or to the list of \"5GS forbidden tracking areas for regional
provision of service\" as specified in the subclauses 5.5.1.2.5 or 5.5.1.3.5,
the tracking area shall be removed from the list of \"allowed tracking areas\"
if the tracking area is already present in the list of \"allowed tracking
areas\" and from the list of \"non-allowed tracking areas\" if the tracking
area is already present in the list of \"non-allowed tracking areas\".
#### 5.3.5.3 Wireline access service area restrictions
If:
a) a SERVICE REJECT message with the 5GMM cause #28 \"Restricted service
area\";
b) a DL NAS TRANSPORT message with the Payload container type IE set to \"N1
SM information\" and the 5GMM cause #28 \"Restricted service area\"; or
c) a REGISTRATION ACCEPT message includes the PDU session reactivation result
error cause IE with the 5GMM cause #28 \"Restricted service area\";
is received over wireline access then the 5G-RG or the W-AGF acting on behalf
of the FN-CRG (or on behalf of the N5GC device) shall start enforcing the
wireline access service area restrictions and shall enter the state 5GMM-
REGISTERED.NON-ALLOWED-SERVICE.
While in the state 5GMM-REGISTERED.NON-ALLOWED-SERVICE, the 5G-RG or the W-AGF
acting on behalf of the FN-CRG (or on behalf of the N5GC device) shall:
a) if in 5GMM-IDLE mode over wireline access:
1) shall not perform the registration procedure for mobility and periodic
registration update with Uplink data status IE except for emergency services
or for high priority access; and
2) shall not initiate a service request procedure except for:
\- emergency services,
\- emergency services fallback; or
\- high priority access; and
b) if in 5GMM-CONNECTED mode over wireline access:
1) shall not perform the registration procedure for mobility and periodic
registration update with Uplink data status IE except for:
\- emergency services;
\- emergency services fallback; or
\- high priority access;
2) shall not initiate a service request procedure except for emergency
services, or high priority access; and
3) shall not initiate a 5GSM procedure except for emergency services or high
priority access;
over the wireline access.
When the 5G-RG is switched off, the UICC containing the USIM is removed or the
5G-RG starts using another wireline access network, the 5G-RG shall stop
enforcing the wireline access service area restrictions, if enforced.
When the W-AGF acting on behalf of the FN-CRG determines that the FN-CRG is
switched off, the W-AGF acting on behalf of the FN-CRG stops enforcing the
wireline access service area restrictions, if enforced.
When the W-AGF acting on behalf of the N5GC device determines that the FN-CRG
serving the N5GC device is switched off, the W-AGF acting on behalf of the
N5GC device stops enforcing the wireline access service area restrictions, if
enforced.
### 5.3.6 Mobile initiated connection only mode
The UE can request the use of mobile initiated connection only (MICO) mode
during the registration procedure (see 3GPP TS 23.501 [8] and 3GPP TS 23.502
[9]). The UE shall not request use of MICO mode over non-3GPP access.
Furthermore, the UE in 3GPP access shall not request the use of MICO mode
during:
a) a registration procedure for initial registration for emergency services
(see subclause 5.5.1.2);
b) a registration procedure for initial registration for initiating an
emergency PDU session (see subclause 5.5.1.2);
c) a registration procedure for mobility and periodic registration update (see
subclause 5.5.1.3) for initiating an emergency PDU session if the UE is in the
state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE; or
d) a registration procedure for mobility and periodic registration update (see
subclause 5.5.1.3) when the UE has an emergency PDU session established.
If the UE requests the use of MICO mode, the network can accept the use of
MICO mode by providing a MICO indication when accepting the registration
procedure. The UE may use MICO mode only if the network has provided the MICO
indication IE during the last registration procedure. The UE may also request
an active time value together with the MICO mode indication during the
registration procedure. If the UE requests an active time by including an
active time value, the UE may also include the Requested T3512 value IE to
request a particular T3512 value to be allocated.
If the network accepts the use of MICO mode and does not include an active
time value in T3324 IE to the UE, the AMF may include an \"all PLMN
registration area allocated\" indication in the MICO indication IE to the UE.
If the UE indicated the support for strictly periodic registration timer in
the MICO indication IE to the network, the network may include a \"strictly
periodic registration timer supported\" indication in the MICO indication IE
to the UE.
If the UE requested the use of active time by including an active time value
and the network accepts the use of MICO mode and the use of active time, the
AMF shall include an active time value in the T3324 IE to the UE. If the AMF
indicates active time value to the UE, AMF should not indicate \"all PLMN
registration area allocated\" indication in the MICO indication IE to the UE.
Upon entering 5GMM-IDLE mode, AMF shall start the active timer with the active
time value indicated to the UE and shall consider the UE is reachable for
paging as long as the timer is running. If the UE enters 5GMM-CONNECTED mode
over 3GPP access when the active timer is running, the AMF shall stop the
active timer.
NOTE 1: The active time value assigned by AMF can be different from the active
time value requested by the UE. AMF assigns the active time value based on
several factors, e.g. local configuration, expected UE behaviour, UE requested
active time value, UE subscription information, network policies etc.
If the UE requested an active time and a requested T3512 value and the network
accepts the use of MICO mode, the AMF shall take the UE requested T3512 value
into consideration when assigning a value of timer T3512 to the UE.
If the network accepts the use of MICO mode, the UE may deactivate the AS
layer and activate MICO mode by entering the state 5GMM-REGISTERED.NO-CELL-
AVAILABLE if:
a) the UE is in 5GMM-IDLE mode over3GPP access;
b) the UE is in the 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-
ALLOWED-SERVICE (as described in subclause 5.3.5.2) state for 3GPP access; and
c) no T3324 value is received from the network.
If the network accepts the use of MICO mode and indicates an active time value
to the UE in a successful registration procedure, the UE shall start the timer
T3324 with the value received from the network after entering 5GMM-IDLE mode
over 3GPP access. At the expiry of the timer T3324, the UE may activate MICO
mode by entering the state 5GMM-REGISTERED.NO-CELL-AVAILABLE if the UE is in
the 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-ALLOWED-SERVICE (as
described in subclause 5.3.5.2) state for 3GPP access. If the UE enters 5GMM-
CONNECTED mode over 3GPP access when the timer T3324 is running, the UE shall
stop the timer T3324.
When MICO mode is activated, all NAS timers are stopped and associated
procedures aborted except for timers T3512, T3346, T3447, T3396, T3584, T3585,
any back-off timers, T3247, and the timer T controlling the periodic search
for HPLMN or EHPLMN or higher prioritized PLMNs (see 3GPP TS 23.122 [5]).
NOTE 2: When MICO mode is activated and if the UE is also registered over the
non-3GPP access, the AMF will not send a NOTIFICATION message with access type
indicating 3GPP access over the non-3GPP access for PDU sessions associated
with 3GPP access.
The UE may deactivate MICO mode and activate the AS layer at any time. Upon
deactivating MICO mode, the UE may initiate 5GMM procedures (e.g. for the
transfer of mobile originated signalling or user data).
When an emergency PDU session is successfully established after the MICO mode
was enabled, the UE and the AMF shall locally disable MICO mode. The UE and
the AMF shall not enable MICO mode until the AMF accepts the use of MICO mode
in the next registration procedure. To enable an emergency call back, the UE
should wait for a UE implementation-specific duration of time before
requesting the use of MICO mode after the completion of the emergency
services.
If the AMF accepts the use of MICO mode and does not indicate \"strictly
periodic registration timer supported\" in the MICO indication IE to the UE,
the AMF starts the implicit de-registration timer for 3GPP access when
entering 5GMM-IDLE mode for 3GPP access. If AMF accepts the use of MICO mode
and indicates \"strictly periodic registration timer supported\" in the MICO
indication IE to the UE, AMF shall start the strictly periodic monitoring
timer with T3512 value indicated in the T3512 value IE after the registration
procedure is completed. The AMF shall neither stop nor reset the strictly
periodic monitoring timer when the NAS signalling connection is established or
released for the UE. If the strictly periodic monitoring timer expires when
NAS signalling connection is established for the UE, AMF shall restart the
strictly periodic monitoring timer with the T3512 value, otherwise AMF shall
start the implicit de-registration timer.
When an emergency PDU session is successfully established and the MICO mode is
disabled, the UE shall stop timer T3512 if running and the AMF shall stop
strictly periodic monitoring timer if running. The UE and the AMF shall behave
as if no \"strictly periodic registration timer supported\" indication was
given to the UE in the last registration attempt.
Upon successful completion of an attach procedure or tracking area updating
procedure after inter-system change from N1 mode to S1 mode (see 3GPP TS
24.301 [15]), the UE operating in single-registration mode shall locally
disable MICO mode. After inter-system change from S1 mode to N1 mode, the UE
operating in single-registration mode may re-negotiate MICO mode with the
network during the registration procedure for mobility and periodic
registration update.
### 5.3.7 Handling of the periodic registration update timer and mobile
reachable timer
The periodic registration update procedure is used over 3GPP access to
periodically notify the availability of the UE to the network. The procedure
is controlled in the UE by the periodic registration update timer, T3512.
If the UE is registered over the 3GPP access, the AMF maintains an implicit
de-registration timer to control when the UE is considered implicitly de-
registered over the 3GPP access. If the UE is registered over the non-3GPP
access, the AMF also maintains a non-3GPP implicit de-registration timer to
control when the UE is considered implicitly de-registered over the non-3GPP
access. The UE registered over the non-3GPP access maintains a non-3GPP de-
registration timer to control when the UE is considered implicitly de-
registered for the non-3GPP access.
The AMF shall start a non-3GPP implicit de-registration timer for the UE
registered over non-3GPP access when the N1 NAS signalling connection over
non-3GPP access is released.
The UE registered over non-3GPP access shall reset and start a non-3GPP de-
registration timer when the N1 NAS signalling connection over non-3GPP access
is released. The non-3GPP de-registration timer is stopped when the UE enters
5GMM-CONNECTED mode over non-3GPP access or the 5GMM-DEREGISTERED state over
non-3GPP access.
The non-3GPP implicit de-registration timer shall be longer than the non-3GPP
de-registration timer.
The value of timer T3512 is sent by the network to the UE in the REGISTRATION
ACCEPT message. The UE shall apply this value in all tracking areas of the
list of tracking areas assigned to the UE until a new value is received. The
periodic registration update timer only applies to the UE registered to the
5GS services over 3GPP access.
If timer T3512 received by the UE in a REGISTRATION ACCEPT message contains an
indication that the timer is deactivated or the timer value is zero, then
timer T3512 is deactivated and the UE shall not perform the periodic
registration update procedure.
NOTE 1: The UE does not perform the periodic registration update procedure for
non-3GPP access.
If during the registration procedure, the AMF does not indicate \"strictly
periodic registration timer supported\" in the MICO indication IE to the UE,
timer T3512 is reset and started with its initial value, when the UE changes
from 5GMM-CONNECTED over 3GPP access to 5GMM-IDLE mode over 3GPP access. Timer
T3512 is stopped when the UE enters 5GMM-CONNECTED mode over 3GPP access or
the 5GMM-DEREGISTERED state over 3GPP access.
If during the registration procedure, the AMF indicates \"strictly periodic
registration timer supported\" in the MICO indication IE to the UE, timer
T3512 is started with its initial value after the completion of the
registration procedure. The UE shall neither stop nor reset the timer T3512
when the UE enters 5GMM-CONNECTED or when changing from 5GMM-CONNECTED mode to
5GMM-IDLE mode. If the timer T3512 expires,
a) the UE in 5GMM-CONNECTED mode over 3GPP access shall reset and start the
timer T3512 with its initial value; or
b) the UE in 5GMM-IDLE mode over 3GPP access shall perform the periodic
registration procedure.
If the UE is registered for emergency services, and timer T3512 expires, the
UE shall not initiate a periodic registration update procedure, but shall
locally de-register from the network. When the UE is camping on a suitable
cell, it may re-register to regain normal service.
When a UE is not registered for emergency services, and timer T3512 expires
when the UE is in 5GMM-IDLE mode, the periodic registration update procedure
shall be started.
If the UE is not registered for emergency services, and is in a state other
than 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-ALLOWED-SERVICE
over 3GPP access when timer T3512 expires, the periodic registration update
procedure is delayed until the UE returns to 5GMM-REGISTERED.NORMAL-SERVICE or
5GMM-REGISTERED.NON-ALLOWED-SERVICE over 3GPP access.
NOTE 2: When the UE returns to 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-
REGISTERED.NON-ALLOWED-SERVICE and it needs to initiate other 5GMM procedure
than the periodic registration update procedure then, based on UE
implementation, the 5GMM procedure can take precedence.
The network supervises the periodic registration update procedure of the UE by
means of the mobile reachable timer.
If the UE is not registered for emergency services, the mobile reachable timer
shall be longer than the value of timer T3512. In this case, by default, the
mobile reachable timer is 4 minutes greater than the value of timer T3512.
The network behaviour upon expiry of the mobile reachable timer is network
dependent, but typically the network stops sending paging messages to the UE
on the first expiry, and may take other appropriate actions.
If the UE is registered for emergency services, the AMF shall set the mobile
reachable timer with a value equal to timer T3512. When the mobile reachable
timer expires, the AMF shall locally de-register the UE.
The mobile reachable timer shall be reset and started with the value as
indicated above, when the AMF releases the NAS signalling connection for the
UE. The mobile reachable timer shall be stopped when a NAS signalling
connection is established for the UE.
Upon expiry of the mobile reachable timer the network shall start the implicit
de-registration timer over 3GPP access. The value of the implicit de-
registration timer over 3GPP access is network dependent. If MICO mode is
activated, the network shall start the implicit de-registration timer over
3GPP access when the UE enters 5GMM-IDLE mode at the AMF over 3GPP access. The
default value of the implicit de-registration timer over 3GPP access is 4
minutes greater than the value of timer T3512.
If the implicit de-registration timer expires before the UE contacts the
network, the network shall implicitly de-register the UE. The implicit de-
registration timer shall be stopped when a NAS signalling connection is
established for the UE.
If the non-3GPP implicit de-registration timer expires before the UE contacts
the network over the non-3GPP access, the network shall implicitly de-register
the UE and enter the state 5GMM-DEREGISTERED over non-3GPP access for the UE.
The non-3GPP implicit de-registration timer shall be stopped when a NAS
signalling connection over non-3GPP access is established for the UE.
If the non-3GPP de-registration timer expires before the UE contacts the
network over the non-3GPP access, the UE shall enter the state 5GMM-
DEREGISTERED over non-3GPP access. The non-3GPP de-registration timer shall be
stopped when a NAS signalling connection over non-3GPP access is established
for the UE.
If the AMF provides T3346 value IE in the DEREGISTRATION REQUEST message with
Access type set to \"Non-3GPP access\" in Deregistration type IE, REGISTRATION
REJECT message during a registration procedure for mobility and periodic
registration update or SERVICE REJECT message and the value of timer T3346 is
greater than the value of timer T3512, the AMF sets the mobile reachable timer
and the implicit de-registration timer such that the sum of the timer values
is greater than the value of timer T3346.
If the AMF provides T3346 value IE in the DEREGISTRATION REQUEST message with
Access type set to \"3GPP access\" in Deregistration type IE, REGISTRATION
REJECT message during a registration procedure for mobility and periodic
registration update or SERVICE REJECT message and the value of timer T3346 is
greater than the value of the non-3GPP de-registration timer, the AMF sets the
non-3GPP implicit de-registration timer value to be 8 minutes greater than the
value of timer T3346.
If the UE receives T3346 value IE in the DEREGISTRATION REQUEST message with
Access type set to \"3GPP access\" in Deregistration type IE, REGISTRATION
REJECT message during a registration procedure for mobility and periodic
registration update or SERVICE REJECT message and the value of timer T3346 is
greater than the value of the non-3GPP de-registration timer, the UE sets the
non-3GPP de-registration timer value to be 4 minutes greater than the value of
timer T3346.
### 5.3.8 Handling of timer T3502
The value of timer T3502 can be sent by the network to the UE in the
REGISTRATION ACCEPT message. The UE shall apply this value in all tracking
areas of the registration area assigned to the UE, until a new value is
received.
The value of timer T3502 can be sent by the network to the UE in the
REGISTRATION REJECT message during the initial registration. If a REGISTRATION
REJECT message including timer T3502 value was received integrity protected,
the UE shall apply this value until a new value is received with integrity
protection or a new PLMN is selected. Otherwise, the default value of this
timer is used.
The default value of this timer is also used by the UE in the following cases:
a) REGISTRATION ACCEPT message is received without a value specified;
b) the UE does not have a stored value for this timer;
c) a new PLMN which is not in the list of equivalent PLMNs has been entered,
the initial registration procedure fails, the registration attempt counter is
equal to 5 and no REGISTRATION REJECT message was received from the new PLMN;
d) the network indicates that the timer is \"deactivated\"; or
e) a new PLMN which is not in the list of equivalent PLMNs has been entered,
the mobility and periodic update registration procedure fails and the
registration attempt counter is equal to 5.
### 5.3.9 Handling of NAS level mobility management congestion control
The AMF may detect 5GMM signalling congestion and perform general NAS level
congestion control. Under the 5GMM signalling congestion conditions the AMF
may reject 5GMM signalling requests from UEs as specified in 3GPP TS 23.501
[8]. The AMF should not reject the following:
a) requests for emergency services;
b) requests for emergency services fallback;
c) requests from UEs configured for high priority access in selected PLMN;
d) DEREGISTRATION REQUEST message;
e) requests for mobile terminated services, triggered by paging or a
notification procedure; and
f) requests for initial registration or mobility and periodic registration
update, when emergency is indicated by lower layers.
When general NAS level congestion control is active, the AMF may include a
value for the mobility management back-off timer T3346 in the reject messages.
The UE starts the timer T3346 with the value received in the 5GMM reject
messages. To avoid that large numbers of UEs simultaneously initiate deferred
requests, the AMF should select the value for the timer T3346 for the rejected
UEs so that timeouts are not synchronised.
If the UE is registered in the same PLMN over the 3GPP access and non-3GPP
access, and the UE receives the timer T3346 from the AMF, the timer T3346
shall apply to both 3GPP access and non-3GPP access.
If the UE receives the paging message or NOTIFICATION message when timer T3346
is running and the UE is registered to the same PLMN over 3GPP access and
non-3GPP access, the UE shall stop the timer T3346 for both accesses and
respond to the paging message or NOTIFICATION message as specified in
subclause 5.6.2 and subclause 5.6.3.
NOTE 1: As an implementation option, MUSIM UE is allowed to not respond to
paging based on the information available in the paging message, e.g. voice
service indication.
If the timer T3346 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE remains the same, then the
timer T3346 is kept running until it expires or it is stopped.
If the UE is switched off when the timer T3346 is running, the UE shall behave
as follows when the UE is switched on and the USIM in the UE remains the same:
let t1 be the time remaining for T3346 timeout at switch off and let t be the
time elapsed between switch off and switch on. If t1 is greater than t, then
the timer shall be restarted with the value t1 -- t. If t1 is equal to or less
than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If the UE enters a new PLMN while timer T3346 is running, and the new PLMN is
not equivalent to the PLMN where the UE started timer T3346, the UE shall stop
timer T3346 when initiating 5GMM procedures in the new PLMN.
After a change in registration area, if the timer T3346 is running and 5GS
update status is 5U1 UPDATED then the UE shall set the 5GS update status to
5U2 NOT UPDATED and enter state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-
UPDATE.
If timer T3346 is running or is deactivated, and the UE is a UE configured for
high priority access in selected PLMN, or the UE needs to initiate signalling
for emergency services or emergency services fallback, then the UE is allowed
to initiate 5GMM procedures.
NOTE 2: UE can, based on implementation, restrict lower layers of non-3GPP
access from establishing access stratum connection on a registered PLMN when
timer T3346 is running for the same PLMN.
### 5.3.10 Handling of DNN based congestion control
The AMF may detect and start performing DNN based congestion control when one
or more DNN congestion criteria as specified in 3GPP TS 23.501 [8] are met. If
the UE does not provide a DNN for a non-emergency PDU session, then the AMF
uses the selected DNN or the DNN associated with the PDU session corresponding
to the 5GSM procedure.
When DNN based congestion control is activated at the AMF, the AMF performs
the congestion control as specified in subclause 5.4.5 and the UE performs the
congestion control as specified in subclause 5.4.5 and subclause 6.2.7.
### 5.3.11 Handling of S-NSSAI based congestion control
The AMF may detect and start performing S-NSSAI based congestion control when
one or more S-NSSAI congestion criteria as specified in 3GPP TS 23.501 [8] are
met. If the UE does not provide a DNN for a non-emergency PDU session, then
the AMF uses the selected DNN or the DNN associated with the PDU session
corresponding to the 5GSM procedure. If the UE does not provide an S-NSSAI for
a non-emergency PDU session, then the AMF uses the selected S-NSSAI or the
S-NSSAI associated with the PDU session corresponding to the 5GSM procedure.
When S-NSSAI based congestion control is activated at the AMF, the AMF
performs the congestion control as specified in subclause 5.4.5 and the UE
performs the congestion control as specified in subclause 5.4.5 and subclause
6.2.8.
### 5.3.12 Handling of local emergency numbers
The additional requirements in subclause 5.3.12A apply to a UE supporting
registration or attach procedures via 3GPP access and registration procedures
via non-3GPP access.
In case of PLMN, the network may send a local emergency numbers list or an
extended local emergency numbers list or both, in the REGISTRATION ACCEPT
message, by including the Emergency number list IE and the Extended emergency
number list IE, respectively. The Local emergency numbers list can be updated
as described in 3GPP TS 24.301 [15], subclause 5.3.7.
In case of SNPN, the network may send an extended local emergency numbers
list, in the REGISTRATION ACCEPT message, by including the Extended emergency
number list IE. The network shall set the Extended Emergency Number List
Validity (EENLV) field within the Extended emergency number list IE to
\"Extended Local Emergency Numbers List is valid only in the PLMN from which
this IE is received\". The UE shall consider the emergency number(s) received
in the Extended emergency number list IE valid only in the SNPN from which
this IE is received regardless of the received value of the EENLV field within
the Extended emergency number list IE.
The UE shall store the local emergency numbers list and the extended local
emergency numbers list, as provided by the network. The local emergency
numbers list stored in the UE shall be replaced on each receipt of the
Emergency number list IE. The extended local emergency numbers list stored in
the UE shall be replaced on each receipt of the Extended emergency number list
IE. The received local emergency numbers list or the received extended local
emergency numbers list or both shall be provided to the upper layers.
If a REGISTRATION ACCEPT message is received via non-3GPP access from a PLMN
in a country different from the current country of the UE, the UE shall keep
the stored local emergency numbers list and the extended local emergency
numbers list, if available.
The emergency number(s) received in the Emergency number list IE are valid
only in PLMNs in the same country as the PLMN from which this IE is received.
If no Emergency number list IE is contained in the REGISTRATION ACCEPT
message, then the stored local emergency numbers list in the UE shall be kept,
except if the UE has successfully registered to a PLMN in a country different
from that of the PLMN that sent the list.
The emergency number(s) received in the Extended emergency number list IE are
valid only in:
\- PLMNs in the same country as the PLMN from which this IE is received, if
the Extended Emergency Number List Validity (EENLV) field within the Extended
emergency number list IE indicates \"Extended Local Emergency Numbers List is
valid in the country of the PLMN from which this IE is received\"; and
\- the PLMN from which this IE is received, if the EENLV field within the
Extended emergency number list IE indicates \"Extended Local Emergency Numbers
List is valid only in the PLMN from which this IE is received\"; and
\- the SNPN from which this IE is received, regardless of the value of the
EENLV field within the Extended emergency number list IE.
If no Extended Local Emergency Numbers List is contained in the REGISTRATION
ACCEPT message, and the registered PLMN or the registered SNPN has not
changed, then the stored Extended Local Emergency Numbers List in the UE shall
be kept. If no Extended Local Emergency Numbers List is contained in the
REGISTRATION ACCEPT message, but the registered PLMN or the registered SNPN
has changed, then:
\- if the last received indication in the EENLV field within the Extended
emergency number list IE indicates \"Extended Local Emergency Numbers List is
valid only in the PLMN from which this IE is received\", the stored Extended
Local Emergency Numbers List in the UE shall be deleted; and
\- if the last received indication in the EENLV field within the Extended
emergency number list IE indicates \"Extended Local Emergency Numbers List is
valid in the country of the PLMN from which this IE is received\" the list
shall be kept except if the UE has successfully registered to a PLMN in a
country different from that of the PLMN that sent the stored list.
NOTE: To prevent the misrouting of emergency calls, all operators within a
country need to follow the regulation or agree on the setting of the Extended
emergency number list IE in accordance to national agreement -- either to
indicate validity within a country or to indicate validity only within the
PLMN.
The local emergency numbers list and the extended local emergency numbers list
shall be deleted at switch off or removal of the USIM. The UE shall be able to
store up to ten entries in the local emergency numbers list and up to twenty
entries in the Extended local emergency numbers list, received from the
network.
For the use of the local emergency numbers list and the extended local
emergency numbers list by the UE see 3GPP TS 24.301 [15], subclause 5.3.7.
### 5.3.12A Handling of local emergency numbers received via 3GPP access and
non-3GPP access
#### 5.3.12A.1 General
The requirements in subclause 5.3.12 with the clarifications and additional
conditions in subclause 5.3.12A apply to a UE supporting:
\- attach procedures (see 3GPP TS 24.301 [15]) or registration procedures via
3GPP access; and
\- registration procedures via non-3GPP access.
The UE shall ignore the presence or absence of local emergency numbers list,
extended local emergency numbers list or both, in a REGISTRATION ACCEPT
message received via non-3GPP access, unless conditions in subclause 5.3.12A.2
are met.
For the purposes of subclause 5.3.12A, the UE is considered neither registered
nor attached over 3GPP access if:
1) the UE supports 3GPP access to EPC, the UE does not support 3GPP access to
5GC, and:
a) the EMM sublayer is in the EMM-NULL state, EMM-DEREGISTERED state or EMM-
DEREGISTERED-INITIATED state; or
2) the UE supports 3GPP access to 5GC, the UE does not support 3GPP access to
EPC, and:
a) the 5GMM sublayer is in the 5GMM-NULL state, 5GMM-DEREGISTERED state or
5GMM-DEREGISTERED-INITIATED state; or
3) supports both 3GPP access to EPC and 3GPP access to 5GC, and:
a) the EMM sublayer is in the EMM-NULL state, EMM-DEREGISTERED state or EMM-
DEREGISTERED-INITIATED state; and
a) the 5GMM sublayer is in the 5GMM-NULL state, 5GMM-DEREGISTERED state or
5GMM-DEREGISTERED-INITIATED state.
#### 5.3.12A.2 Receiving a REGISTRATION ACCEPT message via non-3GPP access
If the UE can determine the current country and after switch on or after
removal of the USIM, has not been registered or has not been attached via 3GPP
access in the current country, then the UE shall store the local emergency
numbers list or the extended local emergency numbers list or both, as provided
by the network with an MCC matching the current country via non-3GPP access.
NOTE: The UE determines, as the current country, the country in which it is
located in accordance with 3GPP TS 24.502 [18].
The UE shall replace a previously stored local emergency numbers list or a
previously stored extended local emergency numbers list or both with a local
emergency numbers list or an extended local emergency numbers list or both
received in a REGISTRATION ACCEPT message via non-3GPP access, if the
previously stored local emergency numbers list was also received via non-3GPP
access or the previously stored extended local emergency numbers list was also
received via non-3GPP access.
The UE shall replace a previously stored extended local emergency numbers list
with an extended local emergency numbers list received in a REGISTRATION
ACCEPT message via non-3GPP access, if:
\- the UE is neither registered nor attached over 3GPP access;
\- the REGISTRATION ACCEPT message is received from a PLMN different from
which the stored list was received; and
\- the stored indication in the EENLV field within the Extended emergency
number list IE indicates \"Extended Local Emergency Numbers List is valid only
in the PLMN from which this IE is received\".
If no extended local emergency numbers list is contained in a REGISTRATION
ACCEPT message received via non-3GPP access and the UE is neither registered
nor attached over 3GPP access, the stored extended local emergency numbers
list in the UE shall be discarded if:
\- the UE can determine the current country and the UE has successfully
registered to a PLMN in the country and that country is different from that of
the PLMN that sent the stored list; or
\- the REGISTRATION ACCEPT message is received from a PLMN different from
which the stored list was received, and the stored indication in the EENLV
field within the Extended emergency number list IE indicates \"Extended Local
Emergency Numbers List is valid only in the PLMN from which this IE is
received\".
### 5.3.13 Lists of 5GS forbidden tracking areas
If the UE is not operating in SNPN access operation mode, the UE shall store a
list of \"5GS forbidden tracking areas for roaming\", as well as a list of
\"5GS forbidden tracking areas for regional provision of service\". Otherwise
the UE shall store a list of \"5GS forbidden tracking areas for roaming\":
\- per SNPN; and
\- if the UE supports access to an SNPN using credentials from a credentials
holder, per entry of the \"list of subscriber data\" or PLMN subscription;
and store a list of \"5GS forbidden tracking areas for regional provision of
service\":
\- per SNPN; and
\- if the UE supports access to an SNPN using credentials from a credentials
holder, per entry of the \"list of subscriber data\" or PLMN subscription.
Within the 5GS, these lists are managed independently per access type, i.e.,
3GPP access or wireline access. These lists shall be erased when:
a) the UE is switched off, the UICC containing the USIM is removed, an entry
of the \"list of subscriber data\" with the subscribed SNPN identity
identifying the current SNPN is updated or, if the UE supports access to an
SNPN using credentials from a credentials holder, the entry of the \"list of
subscriber data\" associated with the lists is updated; and
b) periodically (with a period in the range 12 to 24 hours).
Over 3GPP access, when the lists are erased, the UE performs cell selection
according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C]. A tracking area
shall be removed from the list of \"5GS forbidden tracking areas for
roaming\", as well as the list of \"5GS forbidden tracking areas for regional
provision of service\", if the UE receives the tracking area in the TAI list
or the Service area list of \"allowed tracking areas\" in REGISTRATION ACCEPT
message or a CONFIGURATION UPDATE COMMAND message. The UE shall not remove the
tracking area from \"5GS forbidden tracking areas for roaming\" or \"5GS
forbidden tracking areas for regional provision of service\" if the UE is
registered for emergency services.
In N1 mode over 3GPP access, the UE shall update the suitable list whenever a
REGISTRATION REJECT, SERVICE REJECT or DEREGISTRATION REQUEST message is
received with the 5GMM cause #12 \"tracking area not allowed\", #13 \"roaming
not allowed in this tracking area\", or #15 \"no suitable cells in tracking
area\", or a REGISTRATION ACCEPT or SERVICE ACCEPT message is received with
the forbidden TAI(s).
Over wireline access, the 5G-RG, the W-AGF acting on behalf of an FN-RG or the
W-AGF acting on behalf of an N5GC device shall update the suitable list
whenever a REGISTRATION REJECT, SERVICE REJECT or DEREGISTRATION REQUEST
message is received with the 5GMM cause #12 \"tracking area not allowed\" or
#13 \"roaming not allowed in this tracking area\".
NOTE: In this release of the specification, for untrusted non-3GPP access and
trusted non-3GPP access, neither the list of \"5GS forbidden tracking areas
for roaming\" nor the list of \"5GS forbidden tracking areas for regional
provision of service\" is maintained by the UE since the UE is not able to
determine the corresponding TAI.
Each list shall accommodate 40 or more TAIs. When the list is full and a new
entry has to be inserted, the oldest entry shall be deleted.
### 5.3.13A Forbidden PLMN lists
In N1 mode, two lists of forbidden PLMN are managed independently per access
type, i.e., 3GPP access or non-3GPP access:
\- the list of \"forbidden PLMNs\" as defined in 3GPP TS 23.122 [5] is
applicable for 3GPP access in N1 mode. The same list is used by 5GMM for 3GPP
access, EMM, GMM and MM (see 3GPP TS 24.301 [15] and 3GPP TS 24.008 [12]),
regardless whether the UE is operating in single-registration mode or dual-
registration mode.
\- the list of \"forbidden PLMNs for non-3GPP access to 5GCN\" as defined in
3GPP TS 24.502 [18] is applicable for 5GMM for non-3GPP access.
The list of \"forbidden PLMNs for GPRS service\" as defined in 3GPP TS 23.122
[5] and 3GPP TS 24.008 [12] is applicable for 3GPP access in N1 mode. The same
list is used by 5GMM for 3GPP access, EMM and GMM (see 3GPP TS 24.301 [15] and
3GPP TS 24.008 [12]), regardless whether the UE is operating in single-
registration mode or dual-registration mode.
### 5.3.14 List of equivalent PLMNs
The UE shall store a list of equivalent PLMNs. These PLMNs shall be regarded
by the UE as equivalent to each other for PLMN selection and cell
selection/re-selection. The same list is used by 5GMM, EMM, GMM and MM (see
3GPP TS 24.301 [15] and 3GPP TS 24.008 [12]) except for the case when the UE
operates in dual-registration mode (see subclause 4.8.3).
The UE shall update or delete this list at the end of each registration
procedure. The stored list consists of a list of equivalent PLMNs as
downloaded by the network plus the PLMN code of the registered PLMN that
downloaded the list. When the UE is switched off, the UE shall keep the stored
list so that it can be used for PLMN selection after switch on. The UE shall
delete the stored list if the USIM is removed or when the UE registered for
emergency services enters the state 5GMM-DEREGISTERED. The maximum number of
possible entries in the stored list is 16.
### 5.3.15 Transmission failure abnormal case in the UE
The abnormal case 5GMM uplink message transmission failure indication by lower
layers can be identified for 5GMM procedures:
When it is specified in the relevant procedure that it is up to the UE
implementation to re-run the ongoing procedure that triggered that procedure,
the procedure can typically be re-initiated using a retransmission mechanism
of the uplink message (i.e. the one that has previously failed to be
transmitted) with new sequence number and message authentication code
information thus avoiding to re-start the whole procedure.
NOTE: The transmission failure can happen due to TAI change. The lower layer
might take some time to read the system information and determine if the
current TAI is changed. Therefore, the information of TAI change can be sent
to the NAS layer a little after receiving the transmission failure indication
from the lower layer. How to handle the retransmission procedure caused by the
possible delayed TAI change information is up to UE implementation.
### 5.3.16 Extended DRX cycle for UEs in 5GMM-IDLE and 5GMM-CONNECTED mode
with RRC inactive indication
Extended DRX (eDRX) cycle is supported for a UE in N1 mode. When eDRX is
requested by the UE and accepted by the network:
\- if the UE is not in NB-N1 mode, eDRX is used when the UE is in 5GMM-IDLE
mode or in 5GMM-CONNECTED mode with RRC inactive indication; or
\- if the UE is in NB-N1 mode, eDRX is used when the UE is in 5GMM-IDLE mode.
The UE may request the use of eDRX cycle during a registration procedure by
including the Requested extended DRX parameters IE (see 3GPP TS 23.501 [8] and
3GPP TS 23.502 [9]). The UE shall not request the use of eDRX during a
registration procedure for emergency services. The UE may use the extended
idle mode DRX cycle length stored in the USIM (see 3GPP TS 31.102 [22]) when
requesting the use of eDRX.
The UE and the network may negotiate eDRX parameters during a registration
procedure when the UE has an emergency PDU session.
The network accepts the request to use the eDRX by providing the Negotiated
extended DRX parameters IE when accepting the registration procedure. The UE
shall use eDRX only if it received the Negotiated extended DRX parameters IE
during the last registration procedure and the UE does not have an emergency
PDU session.
NOTE: If the UE wants to keep using eDRX, the UE includes the Extended DRX
parameters IE in each registration procedure.
If the UE received the Negotiated extended DRX parameters IE during the last
registration procedure, upon successful completion of the PDU session release
procedure of the emergency PDU session, the UE shall resume eDRX.
If the network has provided the Negotiated extended DRX parameters IE during
the last registration procedure, upon successful completion of the PDU session
release procedure of the emergency PDU session, the network shall resume eDRX.
If the UE or the network locally releases an emergency PDU session, the UE or
the network shall not use eDRX until the UE receives eDRX parameters during a
registration procedure with PDU session context synchronization or upon
successful completion of a service request procedure with PDU session context
synchronization.
If the UE did not receive the Negotiated extended DRX parameters IE, or if the
UE has an emergency PDU session, the UE shall use the stored UE specific DRX
parameter, if available.
If the network did not accept the request to use eDRX, or if the UE has an
emergency PDU session, the network shall use the stored UE specific DRX
parameter, if available.
If the network provided the Negotiated extended DRX parameters IE and also
assigned a new 5G-GUTI for the UE as described in subclause 5.5.1.3.4 during
the last registration procedure, the network shall use the stored UE specific
DRX parameter, if available, with the old 5G-GUTI and use the eDRX provided by
the network with the new 5G-GUTI until the old 5G-GUTI can be considered as
invalid by the network (see subclauses 5.4.4.4 and 5.5.1.3.4).
### 5.3.17 Service Gap Control
Service gap control (SGC) only applies to 3GPP access.
The network may control the frequency with which UEs can transition from 5GMM-
IDLE mode to 5GMM-CONNECTED mode via the SGC as specified in 3GPP TS 23.501
[8] and 3GPP TS 23.502 [9]. If the network supports SGC and the service gap
time value i.e. T3447 value is available in the 5GMM context of the UE, the
AMF shall consider SGC as active for the UE.
The UE and the network negotiate usage of SGC during the registration
procedure for initial registration and registration procedure for mobility and
periodic registration update:
\- the UE supporting SGC indicates its support in the REGISTRATION REQUEST
message. If the UE supports SGC and the SGC is active for the UE, the AMF
includes T3447 value IE in the REGISTRATION ACCEPT message (see subclause
5.5.1.2 and subclause 5.5.1.3). The UE stores the T3447 value; and
\- for UEs that do not support SGC when the network rejects mobility
management signalling requests because SGC is active in the network, the
mechanism for **general NAS level mobility management congestion control** as
specified in subclause 5.3.9 applies.
The network can provide a new T3447 value to the UE to be used next time it is
started or stop timer T3447 in the UE if running with the Generic UE
configuration update procedure as specified in subclause 5.4.4.
The UE shall start timer T3447 when the N1 NAS signalling connection is
released and if:
\- the UE supports SGC, and the T3447 value is available in the UE and does
not indicate zero; and
\- the N1 NAS signalling connection released was not established for:
\- paging;
\- registration procedure for initial registration with Follow-on request
indicator set to \"No follow-on request pending\";
\- registration procedure for mobility and periodic registration update with
Follow-on request indicator set to \"No follow-on request pending\" and
without Uplink data status IE included;
\- requests for emergency services; or
\- requests for exception data reporting.
If the SGC is active in the network, after the UE transitions from 5GMM-
CONNECTED mode to 5GMM-IDLE mode except when the UE was in 5GMM-CONNECTED mode
due to:
\- paging;
\- registration procedure for initial registration with Follow-on request
indicator set to \"No follow-on request pending\";
\- registration procedure for mobility and periodic registration update with
Follow-on request indicator set to \"No follow-on request pending\" and
without Uplink data status IE included,
\- requests for emergency services; or
\- requests for exception data reporting,
the network shall start timer T3447 if not already running:
\- with the T3447 value available in the 5GMM context minus 4 minutes, if the
UE supports SGC and the T3447 value has been sent to the UE with a non-zero
value; or
\- with the T3447 value available in the 5GMM context if the UE does not
support SGC.
When timer T3447 is running, the network allows:
\- requests for emergency service;
\- requests for emergency services fallback;
\- requests for high priority access;
\- requests for exception data reporting;
\- registration procedure for initial registration with Follow-on request
indicator set to \"No follow-on request pending\";
\- registration procedure for mobility and periodic registration update
without Uplink data status IE included and with Follow-on request indicator
set to \"No follow-on request pending\"; or
\- service request procedure or registration procedure for mobility and
periodic registration update triggered by paging and subsequent MO signalling
or MO data, if any, until the UE enters 5GMM-IDLE mode.
The UE or the network with a running T3447 timer keeps the timer running when
the UE transits from 5GMM-IDLE mode to 5GMM-CONNECTED mode.
NOTE: If the UE transitions from 5GMM-IDLE mode to 5GMM-CONNECTED mode due to
registration procedure for initial registration with Follow-on request
indicator set to \"No follow-on request pending\" or mobility and periodic
registration update request without Uplink data status IE and with Follow-on
request indicator set to \"No follow-on request pending\", the UE initiates no
further MO signalling except for mobility and periodic registration update
requests without Uplink data status and with Follow-on request indicator set
to \"No follow-on request pending\" until the UE receives mobile terminated
signalling (e.g. DL NAS TRANSPORT message for MT SMS) or MT data over user
plane, or after the UE has moved to 5GMM-IDLE state and the service gap timer
is not running.
If timer T3447 is running when the UE changes PLMN or enters state 5GMM-
DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the
same, then timer T3447 is kept running until it expires.
If the AMF determines that the UE operating in single-registration mode has
performed an inter-system change from N1 mode to S1 mode and the timer T3447
is running in the AMF, the AMF stops the T3447.
Upon inter-system change from S1 mode to N1 mode, if the UE supports service
gap control, T3447 is running in the UE, and the T3447 value IE is included in
the REGISTRATION ACCEPT message received from the AMF (see subclause 5.5.1.2
and subclause 5.5.1.3), the UE shall keep T3447 running. Additionally, the UE
shall store and replace the currently stored service gap time value with the
received T3447 value. Upon expiry of the running T3447 timer, the UE shall use
the new value when starting T3447 again.
If the UE is switched off when the timer T3447 is running, the UE shall behave
as follows when the UE is switched on and the USIM in the UE remains the same:
\- let t1 be the time remaining for timer T3447 timeout at switch off and let
t be the time elapsed between switch off and switch on. If t1 is greater than
t, then the timer shall be restarted with the value t1 -- t. If t1 is equal to
or less than t, then the timer need not be restarted. If the UE is not capable
of determining t, then the UE shall restart the timer with the value t1.
### 5.3.18 Restriction on use of enhanced coverage
In order to deal with use of extensive resources from the network, the
operator may prevent specific subscribers from using enhanced coverage (see
3GPP TS 23.501 [8]). When in NB-N1 mode, the UE shall indicate support for
restriction on use of enhanced coverage. When in WB-N1 mode, the UE supporting
either CE mode A or CE mode B shall indicate support for restriction on use of
enhanced coverage. The UE supporting restriction on use of enhanced coverage
indicates its support for restriction on use of enhanced coverage in the
REGISTRATION REQUEST message. If the UE supports restriction on use of
enhanced coverage, the AMF indicates in the REGISTRATION ACCEPT message (see
subclause 5.5.1.2 and subclause 5.5.1.3) that:
a) when in WB-N1 mode, whether CE mode B is restricted for the UE, or both CE
mode A and CE mode B are restricted for the UE, or both CE mode A and CE mode
B are not restricted for the UE; or
b) when in NB-N1 mode, whether the use of enhanced coverage is restricted or
not for the UE.
If:
a) the use of enhanced coverage is restricted;
b) the use of CE mode B is restricted; or
c) the use of CE mode A and CE mode B is restricted,
the UE shall not use enhanced coverage in the registered PLMN and in any PLMN
which is in the list of equivalent PLMNs.
If the UE supports CE mode B and the network determines that
a) the use of enhanced coverage is not restricted for the UE; or
b) CE mode B is not restricted for the UE,
the applicable NAS timer values shall be calculated by the network as
described in subclause 4.19 and subclause 4.20.
For a UE that supports restriction on use of enhanced coverage or CE mode B,
if:
a) the AMF determines to enforce a change in restriction on the use of
enhanced coverage or a change in the restriction on the use of CE mode B as
described in 3GPP TS 23.501 [8]; and
b) the UE is in 5GMM-CONNECTED mode and there is no ongoing registration
procedure,
the AMF shall initiate the generic UE configuration update procedure to
indicate registration requested and release of the N1 NAS signalling
connection not requested as described in subclause 5.4.4. After the successful
completion of the registration procedure for mobility registration update
including change of the restriction on the use of enhanced coverage, for any
SMF with which the UE has an established PDU session, the AMF updates the SMF
with the indication on the use of extended NAS timer setting as described in
3GPP TS 23.501 [8] and 3GPP TS 23.502 [9].
### 5.3.19 Handling of congestion control for transport of user data via the
control plane
The network may activate congestion control for transport of user data via the
control plane, as specified in 3GPP TS 23.501 [8].
If the UE has indicated support for the control plane CIoT 5GS optimizations
and the network decides to activate the congestion control for transport of
user data via the control plane, the network may include a value for the
control plane data back-off timer T3448 in REGISTRATION ACCEPT, SERVICE ACCEPT
or SERVICE REJECT message, and shall store an control plane data back-off time
on a per UE basis. The UE starts the timer T3448 with the value informed in
the message. To avoid that large numbers of UEs simultaneously initiate
deferred requests, the network should select the value for the timer T3448 for
the informed UEs so that timeouts are not synchronised.
The network sends REGISTRATION ACCEPT message or SERVICE ACCEPT message
without T3448 value IE to stop the timer T3448 running in the UE as specified
in subclause 5.5.1.3.4 and subclause 5.6.1.4.
Based on the stored control plane data back-off time for the UE, the network
may reject the transfer of user data via the control plane initiated by the
UE.
While the timer T3448 is running, the UE in 5GMM-IDLE mode does not initiate
the transport of user data via the control plane procedure, except if the UE
is allowed to use exception data reporting (see the
ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP TS
24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102 [22]) and the
user data is related to an exceptional event.
The UE is allowed:
a) to respond to paging with CONTROL PLANE SERVICE REQUEST message without
uplink data; or
b) to send a CONTROL PLANE SERVICE REQUEST message for emergency services or
for emergency services fallback;
even if the timer T3448 is running.
Upon entering the state 5GMM-DEREGISTERED or a new PLMN which is not
equivalent to the PLMN where the UE started the timer T3448, or upon being
switched off while the timer T3448 is running, the UE stops the timer T3448.
### 5.3.19a Specific requirements for UE configured to use timer T3245
#### 5.3.19a.1 UE not operating in SNPN access operation mode
The following requirements apply for a UE that is configured to use timer
T3245 (see 3GPP TS 24.368 [17] or 3GPP TS 31.102 [22]).
When the UE adds a PLMN identity to the \"forbidden PLMN list\" or sets the
USIM as invalid for 5GS services for 3GPP access or non-3GPP access, and timer
T3245 (see 3GPP TS 24.008 [12]) is not running, the UE shall start timer T3245
as specified in 3GPP TS 24.008 [12], subclause 4.1.1.6.
Upon expiry of the timer T3245, the UE shall erase the \"forbidden PLMN list\"
and \"forbidden PLMNs for GPRS service\" list and set the USIM to valid for
5GS services for 3GPP access and non-3GPP access. When the lists are erased,
the UE performs cell selection according to 3GPP TS 38.304 [28] or 3GPP TS
36.304 [25C].
If the UE is switched off when the timer T3245 is running, the UE shall behave
as follows when the UE is switched on and the USIM in the UE remains the same:
\- let t1 be the time remaining for T3245 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the UE will follow the behaviour as defined in the paragraph
above upon expiry of the timer T3245. If the UE is not capable of determining
t, then the UE shall restart the timer with the value t1.
#### 5.3.19a.2 UE operating in SNPN access operation mode
The following requirements apply for a UE that is configured to use timer
T3245 (see 3GPP TS 24.368 [17]).
When the UE adds an SNPN to the \"permanently forbidden SNPNs\" list or
\"temporarily forbidden SNPNs\" list which are, if the MS supports access to
an SNPN using credentials from a credentials holder, associated with the
selected entry of the \"list of subscriber data\" or the selected PLMN
subscription, or sets the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription as invalid for 3GPP access or non-3GPP access,
and timer T3245 (see 3GPP TS 24.008 [12]) is not running, the UE shall start
timer T3245 with a random value, uniformly drawn from the range between 12h
and 24h.
Upon expiry of the timer T3245, the UE shall erase the \"permanently forbidden
SNPNs\" list(s) and \"temporarily forbidden SNPNs\" list(s) and set the
selected entry of the \"list of subscriber data\" or the selected PLMN
subscription to valid for 3GPP access and non-3GPP access. When the lists are
erased, the UE performs cell selection according to 3GPP TS 38.304 [28].
If the UE is switched off when the timer T3245 is running, the UE shall behave
as follows when the UE is switched on and the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription remain the same:
\- let t1 be the time remaining for T3245 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the UE will follow the behaviour as defined in the paragraph
above upon expiry of the timer T3245. If the UE is not capable of determining
t, then the UE shall restart the timer with the value t1.
### 5.3.20 Specific requirements for UE when receiving non-integrity protected
reject messages
#### 5.3.20.1 General
This subclause specifies the requirements for a UE that is not configured to
use timer T3245 (see 3GPP TS 24.368 [17] or 3GPP TS 31.102 [22]) and receives
a REGISTRATION REJECT or SERVICE REJECT message without integrity protection
with specific 5GMM causes.
NOTE: Additional UE requirements for this case, requirements for other 5GMM
causes, and requirements for the case when the UE receives an integrity
protected reject message are specified in subclauses 5.5.1 and 5.6.1.
#### 5.3.20.2 Requirements for UE in a PLMN
The UE shall maintain:
\- a list of PLMN-specific attempt counters (see 3GPP TS 24.301 [15]). The
maximum number of possible entries in the list is implementation dependent.
This list is applicable to access attempts via 3GPP access only;
\- a list of PLMN-specific attempt counters for non-3GPP access, if the UE
supports non-3GPP access. The maximum number of possible entries in the list
is implementation dependent. This list is applicable to access attempts via
non-3GPP access only;
\- a list of PLMN-specific N1 mode attempt counters for 3GPP access. The
maximum number of possible entries in the list is implementation dependent.
This list is applicable to access attempts via 3GPP access only;
\- a list of PLMN-specific N1 mode attempt counters for non-3GPP access, if
the UE supports non-3GPP access. The maximum number of possible entries in the
list is implementation dependent. This list is applicable to access attempts
via non-3GPP access only;
\- one counter for \"SIM/USIM considered invalid for GPRS services\" events
(see 3GPP TS 24. 008 [12]); and
\- one counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events, if the UE supports non-3GPP access.
A UE supporting non-EPS services shall maintain one counter for \"SIM/USIM
considered invalid for non-GPRS services\" events (see 3GPP TS 24.008 [12]).
The UE shall store the above lists of attempt counters and the event counters
in its non-volatile memory. The UE shall erase the lists and reset the event
counters to zero when the UICC containing the USIM is removed. The counter
values shall not be affected by the activation or deactivation of MICO mode or
power saving mode (see 3GPP TS 24.301 [15]).
The UE implementation-specific maximum value for any of the above counters
shall not be greater than 10.
NOTE 1: Different counters can use different UE implementation-specific
maximum values.
If the UE receives a REGISTRATION REJECT or SERVICE REJECT message without
integrity protection with 5GMM cause value #3, #6, #7, #11, #12, #13, #15,
#27, #31, #62, #72 or #73 before the network has established secure exchange
of NAS messages for the N1 NAS signalling connection, the UE shall stop timer
T3510 or T3517 if running, and start timer T3247 (see 3GPP TS 24.008 [12])
with a random value uniformly drawn from the range between 30 minutes and 60
minutes, if the timer is not running, and take the following actions:
1) if the 5GMM cause value received is #3, #6 or #7, and:
a) if the 5GMM cause value is received over 3GPP access, the UE shall:
i) if the UE is already registered over another access:
\- store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\", memorize the current TAI was stored in the list of \"5GS forbidden
tracking areas for roaming\" for non-integrity protected NAS reject message
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
\- search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28] or 3GPP TS 36.304 [25C]; or
ii) otherwise, if the counter for \"SIM/USIM considered invalid for GPRS
services\" events has a value less than a UE implementation-specific maximum
value,
\- set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last visited
registered TAI, TAI list and ngKSI for 3GPP access;
\- if the 5GMM cause value received is #3 or #6, delete the list of equivalent
PLMNs if any;
\- increment the counter for \"SIM/USIM considered invalid for GPRS services\"
events;
\- if the 5GMM cause value received is #3 or #6, and if the counter for
\"SIM/USIM considered invalid for non-GPRS services\" events has a value less
than a UE implementation-specific maximum value, increment the counter;
\- if a registration procedure was performed, reset the registration attempt
counter and if a service request procedure was performed, reset the service
request attempt counter;
\- if the UE is operating in single-registration mode, handle the EMM
parameters EMM state, EPS update status, EPS attach attempt counter, tracking
area updating attempt counter or service request attempt counter, 4G-GUTI, TAI
list, eKSI as specified in 3GPP TS 24.301 [15] for the case when the EPS
attach, tracking area updating procedure or service request procedure is
rejected with the EMM cause of the same value in a NAS message without
integrity protection;
\- store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\", memorize the current TAI was stored in the list of \"5GS forbidden
tracking areas for roaming\" for non-integrity protected NAS reject message
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
\- search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28] or 3GPP TS 36.304 [25C]; and as a UE implementation option, the UE
may perform registration attempt over the non-3GPP access, if non-3GPP access
is available, and the USIM is not considered invalid for 5GS services over
non-3GPP access; and
iii) otherwise proceed as specified in subclauses 5.5.1 and 5.6.1;
b) if the 5GMM cause value is received over non-3GPP access, the UE shall:
i) if the UE is already registered over another access:
\- enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
\- may perform registration attempt over the non-3GPP access if another access
point for non-3GPP access is available; or
ii) otherwise, if the counter for \"USIM considered invalid for 5GS services
over non-3GPP access\" events has a value less than a UE implementation-
specific maximum value,
\- set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete the 5G-GUTI, last visited
registered TAI, TAI list and ngKSI for non-3GPP access;
\- enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE;
\- increment the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events; and as a UE implementation option, the UE may either
perform registration attempt over the non-3GPP access if another access point
for non-3GPP access is available, or if 3GPP access is available, and the
SIM/USIM is not considered invalid for 5GS services over 3GPP access, perform
registration attempt over the 3GPP access; and
NOTE 2: How to select another access point for non-3GPP access is
implementation specific.
iii) otherwise proceed as specified in subclauses 5.5.1 and 5.6.1;
2) if the 5GMM cause value received is #12, #13 or #15, the UE shall proceed
as specified in subclauses 5.5.1 and 5.6.1. Additionally, the UE may:
a) if the 5GMM cause value is received over 3GPP access, non-3GPP access is
available, the UE is not registered over non-3GPP access yet, and the USIM is
not considered invalid for 5GS services over non-3GPP access, perform
registration attempt over the non-3GPP access; or
b) if the 5GMM cause value is received over non-3GPP access, 3GPP access is
available, the UE is not registered over 3GPP access yet, and the USIM is not
considered invalid for 5GS services over 3GPP access, perform registration
attempt over the 3GPP access;
3) if the 5GMM cause value received is #11 or #73 and the UE is in its HPLMN
or EHPLMN:
a) if the 5GMM cause value is received over 3GPP access, the UE shall:
\- set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete, the 5G-GUTI, last visited
registered TAI, TAI list, ngKSI for 3GPP access and the list of equivalent
PLMNs. Additionally, if a registration procedure was performed, the UE shall
reset the registration attempt counter and if a service request procedure was
performed, reset the service request attempt counter;
\- if the 5GMM cause value received is #11 and the UE is operating in single-
registration mode, handle the EMM parameters EMM state, EPS update status, EPS
attach attempt counter, tracking area updating attempt counter or service
request attempt counter, 4G-GUTI, TAI list, eKSI as specified in 3GPP TS
24.301 [15] for the case when the EPS attach, tracking area updating procedure
or service request procedure is rejected with the EMM cause of the same value
in a NAS message without integrity protection;
\- if the 5GMM cause value received is #73 and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI,
TAI list and eKSI. Additionally, the UE shall reset the attach attempt counter
or tracking area updating attempt counter, and enter the state EMM-
DEREGISTERED;
\- store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\", memorize the current TAI was stored in the list of \"5GS forbidden
tracking areas for roaming\" for non-integrity protected NAS reject message
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
\- search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28] or 3GPP TS 36.304 [25C]; and as a UE implementation option, the UE
may perform registration attempt over the non-3GPP access, if non-3GPP access
is available, the UE is not registered over non-3GPP access yet, and the USIM
is not considered invalid for 5GS services over non-3GPP access;
b) if the 5GMM cause value is received over non-3GPP access, the UE shall:
\- set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete the 5G-GUTI, last visited
registered TAI, TAI list and ngKSI for non-3GPP access. Additionally, if a
registration procedure was performed, the UE shall reset the registration
attempt counter and if a service request procedure was performed, reset the
service request attempt counter; and
\- enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE. As a UE implementation
option, the UE may perform registration attempt over the non-3GPP access if
another access point for non-3GPP access is available, or if 3GPP access is
available, the UE is not registered over 3GPP access yet, and the USIM is not
considered invalid for 5GS services over 3GPP access, perform registration
attempt over the 3GPP access;
4) if the 5GMM cause value received is #11 or #73 and the UE is not in its
HPLMN or EHPLMN, in addition to the UE requirements specified in subclause
5.5.1 and 5.6.1:
\- if the message was received via 3GPP access and if the PLMN-specific
attempt counter for the PLMN sending the reject message has a value less than
a UE implementation-specific maximum value, the UE shall increment the PLMN-
specific attempt counter for the PLMN; or
\- if the message was received via non-3GPP access and if the PLMN-specific
attempt counter for non-3GPP access for the PLMN sending the reject message
has a value less than a UE implementation-specific maximum value, the UE shall
increment the PLMN-specific attempt counter for non-3GPP access for the PLMN;
5) if the 5GMM cause value received is #27, the UE shall proceed as specified
in subclauses 5.5.1 and 5.6.1. Additionally, if the PLMN-specific N1 mode
attempt counter for the respective access type and for the PLMN sending the
reject message has a value less than a UE implementation-specific maximum
value, the UE shall increment this counter for the PLMN;
6) if the 5GMM cause value received is #72, the UE shall proceed as specified
in subclauses 5.5.1 and 5.6.1. Additionally, if the PLMN-specific N1 mode
attempt counter for non-3GPP access for the PLMN sending the reject message
has a value less than a UE implementation-specific maximum value, the UE shall
increment this counter for the PLMN;
7) if the 5GMM cause value received is #31 for a UE that has indicated support
for CIoT optimizations, the UE may discard the message or alternatively the UE
should:
\- set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2);
\- store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\", memorize the current TAI was stored in the list of \"5GS forbidden
tracking areas for roaming\" for non-integrity protected NAS reject message;
and
\- search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28] or 3GPP TS 36.304 [25C]; and
8) if the 5GMM cause value received is #62, the UE may discard the message or
alternatively the UE should:
\- set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2);
\- store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\", memorize the current TAI was stored in the list of \"5GS forbidden
tracking areas for roaming\" for non-integrity protected NAS reject message;
and
\- search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28] or 3GPP TS 36.304 [25C].
Upon expiry of timer T3247, the UE shall:
\- remove all tracking areas from the list of \"5GS forbidden tracking areas
for regional provision of service\" and the list of \"5GS forbidden tracking
areas for roaming\", which were stored in these lists for non-integrity
protected NAS reject message;
\- set the USIM to valid for 5GS services for 3GPP access, if:
\- the counter for \"SIM/USIM considered invalid for GPRS services\" events
has a value less than a UE implementation-specific maximum value;
\- set the USIM to valid for 5GS services for non-3GPP access, if:
\- the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events has a value less than a UE implementation-specific maximum
value;
\- set the USIM to valid for non-EPS services, if:
\- the counter for \"SIM/USIM considered invalid for non-GPRS services\"
events has a value less than a UE implementation-specific maximum value;
\- for each PLMN-specific attempt counter that has a value greater than zero
and less than a UE implementation-specific maximum value, remove the
respective PLMN from the extension of the \"forbidden PLMNs\" list;
\- for each PLMN-specific attempt counter for non-3GPP access that has a value
greater than zero and less than a UE implementation-specific maximum value,
remove the respective PLMN from the list of \"forbidden PLMNs for non-3GPP
access to 5GCN\";
\- re-enable the N1 mode capability for 3GPP access and, for each PLMN-
specific N1 mode attempt counter for 3GPP access that has a value greater than
zero and less than a UE implementation-specific maximum value, remove the
respective PLMN from the list of PLMNs where N1 mode is not allowed for 3GPP
access (see 3GPP TS 23.122 [5]);
\- re-enable the N1 mode capability for non-3GPP access and, for each PLMN-
specific N1 mode attempt counter for non-3GPP access that has a value greater
than zero and less than a UE implementation-specific maximum value, remove the
respective PLMN from the list of PLMNs where N1 mode is not allowed for
non-3GPP access;
\- if the UE is supporting A/Gb mode or Iu mode, perform the actions as
specified in 3GPP TS 24.008 [12] for the case when timer T3247 expires;
\- if the UE is supporting S1 mode, perform the actions as specified in 3GPP
TS 24.301 [15] for the case when timer T3247 expires; and
\- initiate a registration procedure, if still needed, dependent on 5GMM state
and 5GS update status, or perform PLMN selection according to 3GPP TS 23.122
[5].
When the UE is switched off, the UE shall, for each PLMN-specific attempt
counter that has a value greater than zero and less than the UE
implementation-specific maximum value, remove the respective PLMN from the
list of \"forbidden PLMNs\". When the USIM is removed, the UE should perform
this action.
When the UE is switched off, the UE shall, for each PLMN-specific attempt
counter for non-3GPP access that has a value greater than zero and less than
the UE implementation-specific maximum value, remove the respective PLMN from
the list of \"forbidden PLMNs for non-3GPP access to 5GCN\". When the USIM is
removed, the UE should perform this action.
NOTE 3: If the respective PLMN was stored in the extension of the \"forbidden
PLMNs\" list, then according to 3GPP TS 23.122 [5] the UE will delete the
contents of this extension when the UE is switched off or the USIM is removed.
#### 5.3.20.3 Requirements for UE in an SNPN
If the UE is operating in SNPN access operation mode, the UE shall maintain,
for each of the entries in the \"list of subscriber data\":
\- one SNPN-specific attempt counter for 3GPP access. The counter is
applicable to access attempts via 3GPP access only;
\- one SNPN-specific attempt counter for non-3GPP access, if the UE supports
accessing SNPN services via a PLMN. The counter is applicable in case of
accessing SNPN services via a PLMN only;
\- one counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events; and
\- one counter for \"the entry for the current SNPN considered invalid for
non-3GPP access\" events, if the UE supports accessing SNPN services via a
PLMN. The counter is applicable in case of accessing SNPN services via a PLMN
only.
NOTE 1: The term \"non-3GPP access\" used in the counter for \"SNPN-specific
attempt counter for non-3GPP access\" events and the counter for \"the entry
for the current SNPN considered invalid for non-3GPP access\" events, is used
to express access to SNPN services via a PLMN.
The UE shall store the above counters in its non-volatile memory. The UE shall
erase the attempt counters and reset the event counters to zero when the
selected entry of the \"list of subscriber data\" is updated or USIM is
removed for the selected PLMN subscription. The counter values shall not be
affected by the activation or deactivation of MICO mode or power saving mode
(see 3GPP TS 24.301 [15]).
The UE implementation-specific maximum value for any of the above counters
shall not be greater than 10.
NOTE 2: Different counters can use different UE implementation-specific
maximum values.
If the UE receives a REGISTRATION REJECT or SERVICE REJECT message without
integrity protection with 5GMM cause value #3, #6, #7, #12, #13, #15, #27,
#72, #74, or #75 before the network has established secure exchange of NAS
messages for the N1 NAS signalling connection, the UE shall stop timer T3510
or T3517, if running, and start timer T3247 (see 3GPP TS 24.008 [12]) with a
random value uniformly drawn from the range between:
a) 15 minutes and 30 minutes for 5GMM cause value #74; or
b) 30 minutes and 60 minutes for other 5GMM cause values;
if the timer is not running, and take the following actions:
a) if the 5GMM cause value received is #3, #6, or #7 and the UE is neither
registered for onboarding services in SNPN nor performing initial registration
for onboarding services in SNPN:
1) if the 5GMM cause value is received over 3GPP access:
i) if the UE is already registered over another access, the UE shall:
A) store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\" for the current SNPN and, if the UE supports access to an SNPN using
credentials from a credentials holder, the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription, memorize the current TAI
was stored in the list of \"5GS forbidden tracking areas for roaming\" for the
current SNPN and, if the UE supports access to an SNPN using credentials from
a credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription, for non-integrity protected NAS reject message
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
B) search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28]; or
ii) otherwise if the counter for \"the entry for the current SNPN considered
invalid for 3GPP access\" events has a value less than a UE implementation-
specific maximum value, the UE shall:
A) set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last visited
registered TAI, TAI list, and ngKSI for 3GPP access;
B) increment the counter for \"the entry for the current SNPN considered
invalid for 3GPP access\" events;
C) reset the registration attempt counter in case of a REGISTRATION REJECT
message or reset the service request attempt counter in case of a SERVICE
REJECT message;
D) store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\" for the current SNPN and, if the UE supports access to an SNPN using
credentials from a credentials holder, the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription, memorize the current TAI
was stored in the list of \"5GS forbidden tracking areas for roaming\" for the
current SNPN and, if the UE supports access to an SNPN using credentials from
a credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription, for non-integrity protected NAS reject
message, and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
E) search for a suitable cell in another tracking area according to 3GPP TS
38.304 [28]. As a UE implementation option, if accessing SNPN services via a
PLMN is available and the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription is not considered invalid for non-3GPP access,
then the UE may attempt to access SNPN services via a PLMN; or
iii) otherwise, the UE shall proceed as specified in subclauses 5.5.1 and
5.6.1;
2) if the 5GMM cause value is received over non-3GPP access:
NOTE 3: A 5GMM cause value \"received over non-3GPP access\" in this subclause
refers to a 5GMM cause value received via a PLMN when the UE attempts to
access SNPN services via a PLMN.
i) if the UE is already registered over another access, the UE shall enter the
state 5GMM-DEREGISTERED.LIMITED-SERVICE; or
ii) otherwise if the counter for \"the entry for the current SNPN considered
invalid for non-3GPP access\" events has a value less than a UE
implementation-specific maximum value, the UE shall:
A) set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete the 5G-GUTI, last visited
registered TAI, TAI list, and ngKSI for non-3GPP access;
B) enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and
C) increment the counter for \"the entry for the current SNPN considered
invalid for non-3GPP access\" events. As a UE implementation option, if 3GPP
access is available and the selected entry of the \"list of subscriber data\"
or the selected PLMN subscription is not considered invalid for 3GPP access,
then the UE may make a registration attempt over 3GPP access; or
iii) otherwise, the UE shall proceed as specified in subclauses 5.5.1 and
5.6.1;
b) if the 5GMM cause value received is #12, #13, or #15, the UE shall proceed
as specified in subclauses 5.5.1 and 5.6.1. Additionally:
1) if the 5GMM cause value is received over 3GPP access, accessing SNPN
services via a PLMN is available, the UE has not accessed SNPN services via a
PLMN yet, and the selected entry of the \"list of subscriber data\" or the
selected PLMN subscription is not considered invalid for non-3GPP access, the
UE may attempt to access SNPN services via a PLMN; or
2) if the 5GMM cause value is received over non-3GPP access, 3GPP access is
available, the UE is not registered to the current SNPN over 3GPP access yet,
and the selected entry of the \"list of subscriber data\" or the selected PLMN
subscription is not considered invalid for 3GPP access, the UE may make a
registration attempt over 3GPP access;
NOTE 4: The network does not send 5GMM cause value #13 to the UE operating in
SNPN access operation mode in this release of specification.
c) if the 5GMM cause value received is #27, the UE shall proceed as specified
in subclauses 5.5.1 and 5.6.1. Additionally, if the SNPN-specific attempt
counter for the respective access type and for the current SNPN has a value
less than a UE implementation-specific maximum value, the UE shall increment
this counter for the SNPN;
c1) if the 5GMM cause value received is #72, the UE shall proceed as specified
in subclauses 5.5.1 and 5.6.1. Additionally, if the SNPN-specific attempt
counter for non-3GPP access for the current SNPN has a value less than a UE
implementation-specific maximum value, the UE shall increment this counter for
the SNPN; and
d) if:
1) the 5GMM cause value received is #74 or #75; or
2) the 5GMM cause value received is #3, #6, or #7 and the UE is registered for
onboarding services in SNPN or performing initial registration for onboarding
services in SNPN;
in addition to the UE requirements specified in subclauses 5.5.1 and 5.6.1:
1) if the message was received via 3GPP access and if the SNPN-specific
attempt counter for 3GPP access for the SNPN sending the reject message has a
value less than a UE implementation-specific maximum value, the UE shall
increment the SNPN-specific attempt counter for 3GPP access for the SNPN; or
2) if the message was received via non-3GPP access and if the SNPN-specific
attempt counter for non-3GPP access for the SNPN sending the reject message
has a value less than a UE implementation-specific maximum value, the UE shall
increment the SNPN-specific attempt counter for non-3GPP access for the SNPN.
NOTE 5: The message \"received via non-3GPP access\" in this subclause refers
to a message received via a PLMN when the UE attempts to access SNPN services
via a PLMN.
Upon expiry of timer T3247, the UE shall:
\- remove, for each SNPN, all tracking areas from the list of \"5GS forbidden
tracking areas for regional provision of service\" and the list of \"5GS
forbidden tracking areas for roaming\" for the SNPN and, if the UE supports
access to an SNPN using credentials from a credentials holder, the selected
entry of the \"list of subscriber data\" or the selected PLMN subscription,
which were stored in these lists for non-integrity protected NAS reject
message;
\- set each entry of the \"list of subscriber data\" or the PLMN subscription
to valid for 3GPP access, if the corresponding counter for \"the entry for the
current SNPN considered invalid for 3GPP access\" events has a value less than
a UE implementation-specific maximum value;
\- set each entry of the \"list of subscriber data\" or the PLMN subscription
to valid for non-3GPP access, if the corresponding counter for \"the entry for
the current SNPN considered invalid for non-3GPP access\" events has a value
less than a UE implementation-specific maximum value;
\- remove each SNPN identity from the \"permanently forbidden SNPNs\" list for
3GPP access or \"temporarily forbidden SNPNs\" list for 3GPP access which are,
if the MS supports access to an SNPN using credentials from a credentials
holder, associated with the selected entry of the \"list of subscriber data\"
or the selected PLMN subscription, if the corresponding SNPN-specific attempt
counter for 3GPP access has a value greater than zero and less than a UE
implementation-specific maximum value and the SNPN identity is included in any
of the \"permanently forbidden SNPNs\" list for 3GPP access or \"temporarily
forbidden SNPNs\" list for 3GPP access;
\- remove each SNPN identity from the \"permanently forbidden SNPNs\" list for
non-3GPP access or \"temporarily forbidden SNPNs\" list for non-3GPP access
which are, if the MS supports access to an SNPN using credentials from a
credentials holder, associated with the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription, if the corresponding
SNPN-specific attempt counter for non-3GPP access has a value greater than
zero and less than a UE implementation-specific maximum value and the SNPN
identity is included in any of the \"permanently forbidden SNPNs\" list for
non-3GPP access or \"temporarily forbidden SNPNs\" list for non-3GPP access;
\- re-enable the N1 mode capability for 3GPP access and, for each SNPN-
specific attempt counter for 3GPP access that has a value greater than zero
and less than a UE implementation-specific maximum value, remove the
respective SNPN from the list of SNPNs for which the N1 mode capability was
disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1
mode not allowed\" (see 3GPP TS 23.122 [5]);
\- re-enable the N1 mode capability for non-3GPP access and, for each SNPN-
specific attempt counter for non-3GPP access that has a value greater than
zero and less than a UE implementation-specific maximum value, remove the
respective SNPN from the list of SNPNs for which N1 mode capability was
disabled for non-3GPP access due to receipt of a reject from the network with
5GMM cause #27 \"N1 mode not allowed\" or 5GMM cause #72 \"non-3GPP access to
5GCN not allowed\"; and
\- initiate a registration procedure, if still needed, dependent on 5GMM state
and 5GS update status, or perform SNPN selection according to 3GPP TS 23.122
[5].
When the UE is switched off or a UICC containing the USIM is removed:
\- for each SNPN-specific attempt counter for 3GPP access having a value
greater than zero and less than the UE implementation-specific maximum value,
the UE shall remove the respective SNPN identity from the \"permanently
forbidden SNPNs\" list(s) for 3GPP access or \"temporarily forbidden SNPNs\"
list(s) for 3GPP access, if available; and
\- for each SNPN-specific attempt counter for non-3GPP access having a value
greater than zero and less than the UE implementation-specific maximum value,
the UE shall remove the respective SNPN identity from the \"permanently
forbidden SNPNs\" list(s) for non-3GPP access or \"temporarily forbidden
SNPNs\" list(s) for non-3GPP access, if available.
When an entry of the \"list of subscriber data\" is updated:
\- if the UE does not support access to an SNPN using credentials from a
credentials holder and the SNPN-specific attempt counter for 3GPP access for
the SNPN corresponding to the entry has a value greater than zero and less
than the UE implementation-specific maximum value, the UE shall remove the
SNPN identity corresponding to the entry from the \"permanently forbidden
SNPNs\" list for 3GPP access or \"temporarily forbidden SNPNs\" list for 3GPP
access, if available;
\- if the UE does not support access to an SNPN using credentials from a
credentials holder and the SNPN-specific attempt counter for non-3GPP access
for the SNPN corresponding to the entry has a value greater than zero and less
than the UE implementation-specific maximum value, the UE shall remove the
SNPN identity corresponding to the entry from the \"permanently forbidden
SNPNs\" list for non-3GPP access or \"temporarily forbidden SNPNs\" list for
non-3GPP access, if available;
\- if the UE supports access to an SNPN using credentials from a credentials
holder and the SNPN-specific attempt counter for 3GPP access for an SNPN in
the \"permanently forbidden SNPNs\" list for 3GPP access or \"temporarily
forbidden SNPNs\" list for 3GPP access, associated with the entry, has a value
greater than zero and less than the UE implementation-specific maximum value,
the UE shall remove the SNPN identity corresponding to the SNPN from the
\"permanently forbidden SNPNs\" list for 3GPP access or \"temporarily
forbidden SNPNs\" list for 3GPP access, associated with the entry; and
\- if the UE supports access to an SNPN using credentials from a credentials
holder and the SNPN-specific attempt counter for non-3GPP access for an SNPN
in the \"permanently forbidden SNPNs\" list for non-3GPP access or
\"temporarily forbidden SNPNs\" list for non-3GPP access associated with the
entry, has a value greater than zero and less than the UE implementation-
specific maximum value, the UE shall remove the SNPN identity corresponding to
the SNPN from the \"permanently forbidden SNPNs\" list for non-3GPP access or
\"temporarily forbidden SNPNs\" list for non-3GPP access, associated with the
entry.
### 5.3.21 CIoT 5GS optimizations
CIoT 5GS optimizations provide improved support of small data and SMS
transfer. A UE supporting CIoT 5GS optimizations can indicate the 5GS CIoT
network behaviour the UE can support and prefers to use during the
registration procedure (see 3GPP TS 23.502 [9]). The UE may indicate the
support for control plane CIoT 5GS optimization, user plane CIoT 5GS
optimization, N3 data transfer and header compression (see subclause
9.11.3.1). Furthermore, the UE may, separately from the indication of support,
indicate preference for control plane CIoT 5GS optimization or user plane CIoT
5GS optimization (see subclause 9.11.3.9A). The indication of preference is
also considered as the request to use. A UE supporting CIoT EPS optimizations
can also indicate the EPS CIoT network behaviour the UE can support during the
registration procedure. Furthermore, the UE may, separately from the
indication of support, indicate preference for control plane CIoT EPS
optimization or user plane CIoT EPS optimization.
NOTE 1: CIoT 5GS optimizations are not supported by NR connected to 5GCN.
NOTE 2: If the UE does not support user plane CIoT 5GS optimization, it does
not indicate preference for user plane CIoT 5GS optimization.
The UE can be in NB-N1 mode or WB-N1 mode when requesting the use of CIoT 5GS
optimizations during the registration procedure. A UE in NB-N1 mode always
indicates support for control plane CIoT 5GS optimization.
In NB-N1 mode, the UE, when requesting the use of CIoT 5GS optimizations, does
not:
\- request an initial registration for emergency services;
\- request a PDU session establishment for emergency PDU session; or
\- indicate UE\'s usage setting during the registration procedure.
The network does not indicate to the UE support of emergency services when the
UE is in NB-N1 mode (see subclause 5.5.1.2.4 and 5.5.1.3.4).
The control plane CIoT 5GS optimization enables support of efficient transport
of user data (IP, Ethernet and Unstructured) or SMS messages over control
plane via the AMF without triggering user-plane resources establishment. The
support of control plane CIoT 5GS optimization is mandatory for the network in
NB-N1 mode and optional in WB-N1 mode. Optional header compression of IP data
and Ethernet data can be applied to PDU sessions with IP PDU session type and
Ethernet PDU session type that are configured to support header compression.
For IP header compression, Robust Header Compression (ROHC) protocol specified
in IETF RFC 5795 [39B] is used. For Ethernet header compression, Ethernet
Header Compression (EHC) protocol specified in 3GPP TS 38.323 [29] is used.
For a UE that supports Location Services (LCS) notification mechanisms in N1
mode, the control plane CIoT 5GS optimization also enables the transport of
location services messages from 5GMM-IDLE mode using the CONTROL PLANE SERVICE
REQUEST message when location services are requested (see subclause 6.7.1 in
3GPP TS 23.273 [6B]).
The user plane CIoT 5GS optimization enables support for change from 5GMM-IDLE
mode over 3GPP access to 5GMM-CONNECTED mode over 3GPP access without the need
for using the service request procedure (see subclause 5.3.1.5).
If the UE supports user plane CIoT 5GS optimization, it shall also support N3
data transfer.
If the UE indicates support of one or more CIoT 5GS optimizations and the
network supports one or more CIoT 5GS optimizations and decides to accept the
registration request, the network indicates the supported CIoT 5GS
optimizations to the UE per registration area when accepting the UE request.
Network indication of support is interpreted by the UE as the acceptance to
use the respective feature. After completion of the registration procedure,
the UE and the network can then use the accepted CIoT 5GS optimizations for
the transfer of user data (IP, Ethernet, Unstructured and SMS).
A UE in NB-N1 mode or WB-N1 mode can request the use of SMS over NAS by
setting the SMS requested bit of the 5GS update type IE in the REGISTRATION
REQUEST message as specified in subclauses 5.5.1.2.2 and 5.5.1.3.2.
The AMF indicates whether it allows the use of SMS over NAS for a UE in NB-N1
mode or WB-N1 mode by setting the SMS allowed bit of the 5GS registration
result IE in the REGISTRATION ACCEPT message as specified in subclauses
5.5.1.2.4 and 5.5.1.3.4.
If the UE and the network support both the control plane CIoT 5GS optimization
and N3 data transfer, then when receiving the UE\'s request for a PDU session
establishment, the AMF decides whether the PDU session should be NEF PDU
session or N6 PDU session as specified in 3GPP TS 23.501 [8] and then:
a) if NEF PDU session is to be established for unstructured data type, the AMF
includes control plane only indication for the requested PDU session to the
SMF;
b) if N6 PDU session is to be established and the DNN or S-NSSAI of the newly
requested N6 PDU session supports interworking with EPS as specified in TS
23.502 [9]:
1) if there are existing N6 PDU sessions supporting interworking with EPS for
this UE that were established with the control plane only indication, the AMF
includes the control plane only indication for the newly requested N6 PDU
session to the SMF; or
2) if there are existing N6 PDU sessions supporting interworking with EPS for
this UE that were established without the control plane only indication, the
AMF does not include the control plane only indication for the newly requested
N6 PDU session to the SMF;
3) if there is no existing N6 PDU session supporting interworking with EPS for
this UE, the AMF determines whether to include the control plane only
indication for the newly requested N6 PDU session to the SMF based on local
policies, the UE\'s preferred CIoT network behaviour and the supported CIoT
network behaviour; and
c) if N6 PDU session is to be established and the DNN or S-NSSAI of the N6 PDU
session does not support interworking with EPS as specified in TS 23.502 [9],
the AMF determines whether to include the control plane only indication for
the newly requested N6 PDU session to the SMF based on local policies, the
UE\'s preferred CIoT network behaviour and the supported CIoT network
behaviour.
In NB-N1 mode, if the UE or the network does not support N3 data transfer,
then when receiving the UE\'s request for a PDU session establishment, the AMF
decides whether the PDU session should be NEF PDU session or N6 PDU session as
specified in 3GPP TS 23.501 [8] and then includes the control plane only
indication for the requested PDU session to the SMF.
If the network supports user plane CIoT 5GS optimization, it shall also
support N3 data transfer.
Broadcast system information may provide information about support of CIoT 5GS
optimizations (see 3GPP TS 36.331 [25A]). At reception of new broadcast system
information, the lower layers deliver it to the 5GMM layer in the UE. The
information provided by lower layers is per PLMN and used by the UE to
determine whether certain CIoT 5GS optimizations are supported in the cell.
The UE shall not attempt to use CIoT 5GS optimizations which are indicated as
not supported.
In NB-N1 mode, at any given time, there cannot be user-plane resources
established for a number of PDU sessions that exceeds the UE\' s maximum
number of supported user-plane resources. The UE in NB-N1 mode shall not:
a) request the establishment of user-plane resources for a number of PDU
sessions that exceeds the UE\' s maximum number of supported user-plane
resources; or
b) initiate the establishment of a new PDU session, or request the transfer of
a PDU session from the non-3GPP access to the 3GPP access, if:
1) the UE has indicated preference for user plane CIoT 5GS optimization;
2) the network accepted the use of user plane CIoT 5GS optimization; and
3) the UE currently has user-plane resources established fora number of PDU
sessions that is equal to the UE\' s maximum number of supported user-plane
resources.
The AMF enforces a limit on the number of PDU sessions with active user-plane
resources for a UE in NB-N1 mode based on the UE\'s maximum number of
supported user-plane resources as follows:
a) there can be a maximum of one PDU session with active user-plane resources
when the Multiple user-plane resources support bit is set to \"Multiple user-
plane resources not supported\", or
b) there can be a maximum of two PDU sessions with active user-plane resources
when the Multiple user-plane resources support bit is set to \"Multiple user-
plane resources supported\".
A PDU session for a UE in NB-N1 mode shall only have one QoS rule and that is
the default QoS rule. Reflective QoS is not supported in NB-N1 mode.
Reflective QoS is not applicable for a PDU session with control plane only
indication.
In NB-N1 mode, when the UE requests the lower layer to establish a RRC
connection and the UE requests the use of user plane CIoT 5GS optimization,
the UE shall pass an indication of the requested CIoT 5GS optimizations to the
lower layers. If the UE requests the use of N3 data transfer without user
plane CIoT 5GS optimization, then the UE shall also pass an indication of user
plane CIoT 5GS optimization to lower layers.
In WB-N1 mode, when the UE requests the lower layer to establish a RRC
connection and the UE requests the use of control plane CIoT 5GS optimization
or user plane CIoT 5GS optimization, the UE shall pass an indication of the
requested CIoT 5GS optimizations to the lower layers.
### 5.3.22 Interaction between MICO mode with active time and extended idle
mode DRX cycle
The UE can request the use of both MICO mode with active time and eDRX during
a registration procedure but it is up to the network to decide to enable none,
one of them or both (see 3GPP TS 23.501 [8]).
If the network accepts the use of both MICO mode with active time (see
subclause 5.3.6) and eDRX (see subclause 5.3.16), the extended DRX parameters
provided to the UE should allow for multiple paging occasions before the
active timer expires.
### 5.3.23 Forbidden wireline access area
The AMF shall send a REGISTRATION REJECT, SERVICE REJECT or DEREGISTRATION
REQUEST message over a wireline access network with the 5GMM cause #77
\"wireline access area not allowed\", if conditions specified in 3GPP TS
23.316 [6D] for AMF\'s enforcement of forbidden area are fulfilled.
If a REGISTRATION REJECT, SERVICE REJECT or DEREGISTRATION REQUEST message is
received over a wireline access network with the 5GMM cause #77 \"wireline
access area not allowed\":
a) the 5G-RG shall not access 5GCN over the wireline access network until the
5G-RG is switched off, the UICC containing the USIM is removed, or the 5G-RG
starts using another wireline access network;
b) the W-AGF acting on behalf of the FN-CRG shall not access 5GCN until the
W-AGF acting on behalf of the FN-CRG determines that the FN-CRG is switched
off; and
c) the W-AGF acting on behalf of the N5GC device shall not access 5GCN until
the W-AGF acting on behalf of the FN-CRG determines that the FN-CRG serving
the N5GC device is switched off.
### 5.3.24 WUS assistance
A UE supporting reception of WUS assistance information indicates its
capability for reception of WUS assistance information during registration
procedure (see 3GPP TS 23.501 [8]). The UE supporting WUS assistance
information may include its UE paging probability information in the Requested
WUS assistance information IE in the REGISTRATION REQUEST message (see 3GPP TS
23.501 [8]). The UE shall not include its UE paging probability information
during a registration procedure when the UE has an active emergency PDU
session.
The UE and the network may negotiate the UE paging probability information
during a registration procedure when the UE does not have an emergency PDU
session. The UE paging probability information is an assistance information
used to determine the WUS group for paging UE (see 3GPP TS 23.501 [8], 3GPP TS
36.300 [25B]).
NOTE: The determination of UE paging probability information is up to UE
implementation.
If a UE supporting WUS assistance information did not receive the Negotiated
WUS assistance information IE during the last registration procedure due to an
active emergency PDU session over 3GPP access, the UE shall initiate a
registration procedure for mobility and periodic registration update to
request WUS assistance information after the emergency PDU session is released
over 3GPP access.
If the UE does not have an emergency PDU session and the network accepts the
use of the WUS assistance information for the UE, the network determines the
negotiated UE paging probability information for the UE based on the requested
UE paging probability information, if any, local configuration or previous
statistical information for the UE, and then indicates the negotiated UE
paging probability information in the Negotiated WUS assistance information IE
to the UE in the REGISTRATION ACCEPT message. The network shall store the
negotiated UE paging probability information in the 5GMM context of the UE for
paging.
The UE shall use WUS assistance information only if the UE received the
Negotiated WUS assistance information IE during the last registration
procedure. If the UE did not receive the Negotiated WUS assistance information
IE during the last registration procedure, the UE shall not use WUS
assistance.
If the network did not accept the request to use WUS assistance information,
the network shall delete the stored negotiated UE paging probability
information for the UE, if available.
When an emergency PDU session is successfully established after the UE
received the Negotiated WUS assistance information IE during the last
registration procedure, the UE and the AMF shall not use WUS assistance
information until:
\- the successful completion of the PDU session release procedure of the
emergency PDU session;
\- the UE receives WUS assistance information during a registration procedure
with PDU session status IE or upon successful completion of a service request
procedure, if the UE or the network locally releases the emergency PDU
session; or
\- the successful completion of the handover of the emergency PDU session to
non-3GPP access.
### 5.3.25 Paging Early Indication with Paging Subgrouping Assistance
A UE may indicate its capability to support NR paging subgrouping during
registration procedure when the UE:
\- initiates a registration procedure with 5GS registration type IE not set to
\"emergency registration\"; and
\- does not have an active emergency PDU session.
If a UE supporting NR paging subgrouping did not indicate its capability to
support NR paging subgrouping during the last registration procedure due to an
active emergency PDU session over 3GPP access, the UE shall initiate a
registration procedure for mobility and periodic registration update procedure
to indicate its capability to support NR paging subgrouping after the
emergency PDU session is released over 3GPP access.
If the UE indicates support of NR paging subgrouping the UE may include its
paging probability information in the Requested PEIPS assistance information
IE in the REGISTRATION REQUEST message. If the UE indicates support of NR
paging subgrouping and the network supports and accepts the use of the PEIPS
assistance information for the UE, the network provides to the UE the
Negotiated PEIPS assistance information, including the Paging subgroup ID, in
the REGISTRATION ACCEPT message or the CONFIGURATION UPDATE COMMAND message.
The Paging subgroup ID is used to determine the NR paging subgroup for paging
the UE. The network shall store the Paging subgroup ID in the 5GMM context of
the UE.
The UE shall use PEIPS assistance information only if the UE received the
Negotiated PEIPS assistance information IE during the last registration
procedure. If the UE did not receive the Negotiated PEIPS assistance
information IE during the last registration procedure, the UE shall delete any
existing PEIPS assistance information received from the network.
If the network did not accept the request to use PEIPS assistance information
during the registration procedure, the network shall delete the stored PEIPS
assistance information for the UE, if available.
If the UE supports the use of the PEIPS assistance information and the network
supports and accepts the use of the PEIPS assistance information, the network
may provide the PEIPS assistance information to the UE by including the
Updated PEIPS assistance information IE in the CONFIGURATION UPDATE COMMAND
message.
When an emergency PDU session is successfully established over 3GPP access
after the UE received the Negotiated PEIPS assistance information IE during
the last registration procedure, the UE and the AMF shall not use PEIPS
assistance information until:
\- the successful completion of the PDU session release procedure of the
emergency PDU;
\- the UE receives PEIPS assistance information during a registration
procedure with PDU session status IE or upon successful completion of a
service request procedure, if the UE or the network locally releases the
emergency PDU session;
\- the successful completion of handover of emergency PDU session to non-3GPP
access; or
\- the successful transfer of the emergency PDU session in 5GS to the EPS or
ePDG connected to EPC.
## 5.4 5GMM common procedures
### 5.4.1 Primary authentication and key agreement procedure
#### 5.4.1.1 General
The purpose of the primary authentication and key agreement procedure is to
enable mutual authentication between the UE and the network and to provide
keying material that can be used between the UE and network in subsequent
security procedures, as specified in 3GPP TS 33.501 [24].
Two methods are defined:
a) EAP based primary authentication and key agreement procedure.
b) 5G AKA based primary authentication and key agreement procedure.
The UE and the AMF shall support the EAP based primary authentication and key
agreement procedure and the 5G AKA based primary authentication and key
agreement procedure.
#### 5.4.1.2 EAP based primary authentication and key agreement procedure
##### 5.4.1.2.1 General
The purpose of the EAP based primary authentication and key agreement
procedure is to provide mutual authentication between the UE and the network
and to agree on the keys K~AUSF~, K~SEAF~ and K~AMF~ (see 3GPP TS 33.501
[24]).
Extensible authentication protocol (EAP) as specified in IETF RFC 3748 [34]
enables authentication using various EAP methods.
EAP defines four types of EAP messages:
a) an EAP-request message;
b) an EAP-response message;
c) an EAP-success message; and
d) an EAP-failure message.
Several rounds of exchanges of an EAP-request message and a related EAP-
response message can be required to achieve the authentication (see example in
figure 5.4.1.2.1.1).
The EAP based primary authentication and key agreement procedure is always
initiated and controlled by the network.
The EAP-request message, the ngKSI and the ABBA are transported from the
network to the UE using the AUTHENTICATION REQUEST message of the EAP message
reliable transport procedure.
The EAP-response message is transported from the UE to the network using the
AUTHENTICATION RESPONSE message of the EAP message reliable transport
procedure.
If the authentication of the UE completes successfully, the serving AMF
intends to initiate a security mode control procedure after the EAP based
primary authentication and key agreement procedure and the security mode
control procedure intends to bring into use the partial native 5G NAS security
context created by the EAP based primary authentication and key agreement
procedure, then the EAP-success message and the ngKSI are transported from the
network to the UE using the SECURITY MODE COMMAND message of the security mode
control procedure (see subclause 5.4.2).
If the authentication of the UE completes successfully and the serving AMF
does not intend to initiate a security mode control procedure bringing into
use the partial native 5G NAS security context created by the EAP based
primary authentication and key agreement procedure, then the EAP-success
message, and the ngKSI are transported from the network to the UE using the
AUTHENTICATION RESULT message of the EAP result message transport procedure.
NOTE 1: The serving AMF will not initiate a security mode control procedure
after the EAP based primary authentication and key agreement procedure e.g. in
case of AMF relocation during registration procedure.
If the authentication of the UE completes unsuccessfully, the EAP-failure
message is transported from the network to the UE using the AUTHENTICATION
RESULT message or the AUTHENTICATION REJECT message of the EAP result message
transport procedure or in a response of the initial 5GMM procedure as part of
which the EAP based primary authentication and key agreement procedure is
performed.
The AMF shall set the authenticator retransmission timer specified in IETF RFC
3748 [34] subclause 4.3 to infinite value.
NOTE 2: The EAP message reliable transport procedure provides a reliable
transport of EAP messages and therefore retransmissions at the EAP layer do
not occur.
The AUSF and the AMF support exchange of EAP messages using N12.
The UE shall detect and handle any duplication of EAP message as specified in
IETF RFC 3748 [34].
Figure 5.4.1.2.1.1: EAP based primary authentication and key agreement
procedure
##### 5.4.1.2.2 EAP-AKA\' related procedures
##### 5.4.1.2.2.1 General {#general-32 .H6}
The UE shall support acting as EAP-AKA\' peer as specified in IETF RFC 5448
[40]. The AUSF may support acting as EAP-AKA\' server as specified in IETF RFC
5448 [40]. The AAA server of the Credentials Holder (CH) or the Default
Credentials Server (DCS) may support acting as EAP-AKA\' server as specified
in IETF RFC 5448 [40].
The EAP-AKA\' enables mutual authentication of the UE and the network.
The UE can reject the EAP-request/AKA\'-challenge message sent by the network.
The UE shall proceed with an EAP-request/AKA\'-challenge message only if a
USIM is present.
During a successful EAP based primary authentication and key agreement
procedure, the CK and IK are computed by the USIM. CK and IK are then used by
the ME as key material to generate an EMSK or MSK.
##### 5.4.1.2.2.2 Initiation {#initiation .H6}
In order to initiate the EAP based primary authentication and key agreement
procedure using EAP-AKA\', the AUSF or the AAA server of the CH or the DCS
shall send an EAP-request/AKA\'-challenge message as specified in IETF RFC
5448 [40]. The AUSF or the AAA server of the CH or the DCS shall set the
AT_KDF_INPUT attribute of the EAP-request/AKA\'-challenge message to the SNN.
The SNN is in format described in subclause 9.12.1. The AUSF or the AAA server
of the CH or the DCS may include AT_RESULT_IND attribute in the EAP-
request/AKA\'-challenge message.
The network shall select an ngKSI value. If an ngKSI is contained in an
initial NAS message during a 5GMM procedure, the network shall select a
different ngKSI value. The network shall send the selected ngKSI value to the
UE along with each EAP message. The network shall send the ABBA value as
described in subclause 9.11.3.10 to the UE along with the EAP request message
and EAP-success message.
Upon receiving an EAP-request/AKA\'-challenge message, the UE shall check
whether the UE has a USIM, shall check the key derivation function indicated
in AT_KDF attributes as specified in IETF RFC 5448 [40], and if the value of
the Key derivation function field within the received AT_KDF attribute, is of
value 1, shall check:
a) whether the network name field of the AT_KDF_INPUT attribute is the SNN
constructed according to subclause 9.12.1; and
b) whether the network name field of the AT_KDF_INPUT attribute matches the
PLMN identity or the SNPN identity of the selected SNPN saved in the UE.
When not operating in SNPN access operation mode, the PLMN identity the UE
uses for the above network name check is as follows:
a) when the UE moves from 5GMM-IDLE mode to 5GMM-CONNECTED mode, until the
first handover, the UE shall use the PLMN identity of the selected PLMN; and
b) after handover or inter-system change to N1 mode in 5GMM-CONNECTED mode:
1) if the target cell is not a shared network cell, the UE shall use the PLMN
identity received as part of the broadcast system information;
2) if the target cell is a shared network cell and the UE has a valid 5G-GUTI,
the UE shall use the PLMN identity that is part of the 5G-GUTI; and
3) if the target cell is a shared network cell and the UE has a valid 4G-GUTI,
but not a valid 5G-GUTI, the UE shall use the PLMN identity that is part of
the 4G-GUTI.
When operating in SNPN access operation mode, the SNPN identity the UE uses
for the above network name check is the SNPN identity of the selected SNPN.
##### 5.4.1.2.2.3 UE successfully authenticates network {#ue-successfully-
authenticates-network .H6}
If a USIM is present and the SNN check is successful, the UE shall handle the
EAP-request/AKA\'-challenge message as specified in IETF RFC 5448 [40]. The
USIM shall derive CK and IK and compute the authentication response (RES)
using the 5G authentication challenge data received from the ME, and pass RES
to the ME. The ME shall derive CK\' and IK\' from CK and IK, and if the UE
operates in SNPN access operation mode and the credentials in the USIM contain
an indication to use MSK for derivation of K~AUSF~ after success of primary
authentication and key agreement procedure then derive MSK from CK\' and IK\'
otherwise derive EMSK from CK\' and IK\'.
NOTE 1: When the UE is registering or registered for onboarding services in
SNPN, credentials in the USIM do not contain an indication to use MSK for
derivation of K~AUSF~ after success of primary authentication and key
agreement procedure.
Furthermore, if the UE operates in SNPN access operation mode and the
credentials in the USIM
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure then the ME may generate a
new K~AUSF~ from the MSK otherwise the ME may generate a new K~AUSF~ from the
EMSK.
If the ME generates a new K~AUSF~, the ME shall generate a new K~SEAF~ from
the new K~AUSF~, and the K~AMF~ from the ABBA received together with the EAP-
request/AKA\'-challenge message, and the new K~SEAF~ as described in 3GPP TS
33.501 [24], and create a partial native 5G NAS security context identified by
the ngKSI value received together with the EAP-request/AKA\'-challenge message
in subclause 5.4.1.2.4.2 in the volatile memory of the ME. If the K~AMF~ and
the partial native 5G NAS security context are created, the ME shall store the
K~AMF~ in the created partial native 5G NAS security context, and shall send
an EAP-response/AKA\'-challenge message as specified in IETF RFC 5448 [40].
NOTE 2: Generation of the new K~AUSF~ and the new K~SEAF~ does not result into
deletion of the valid K~AUSF~ and the valid K~SEAF~, if any.
The ME shall not use the new K~AUSF~ in the verification of SOR transparent
container and UE parameters update transparent container, if any are received,
until receipt of an EAP-success message.
If the EAP-request/AKA\'-challenge message contains AT_RESULT_IND attribute,
the UE may include AT_RESULT_IND attribute in the EAP-response/AKA\'-challenge
message as specified in IETF RFC 5448 [40].
##### 5.4.1.2.2.4 Errors when handling EAP-request/AKA\'-challenge message
{#errors-when-handling-eap-requestaka-challenge-message .H6}
If a USIM is present, the SNN check fails or the UE does not accept AUTN
during handling of the EAP-request/AKA\'-challenge message as specified in
IETF RFC 5448 [40], the UE shall send an EAP-response/AKA\'-authentication-
reject message as specified in IETF RFC 5448 [40].
If a USIM is present, the SNN check is successful but the UE detects that the
sequence number in AUTN is not correct during handling of the EAP-
request/AKA\'-challenge message as specified in IETF RFC 5448 [40], the UE
shall send an EAP-response/AKA\'-synchronization-failure message as specified
in IETF RFC 5448 [40].
If a USIM is present, the SNN check is successful, the sequence number in AUTN
is correct and the UE detects another error during handling of the EAP-
request/AKA\'-challenge message as specified in IETF RFC 5448 [40], the UE
shall send an EAP-response/AKA\'-client-error message as specified in IETF RFC
5448 [40].
If a USIM is not present, the UE shall send an EAP-response/AKA\'-client-error
message as specified in IETF RFC 5448 [40].
For any of the above, the UE shall start timer T3520 when the AUTHENTICATION
RESPONSE message containing the EAP-response message is sent. Furthermore, the
UE shall stop any of the timers T3510, T3517 or T3521 (if they were running).
Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE
containing an EAP-request/AKA\'-challenge from the network, the UE shall stop
timer T3520, if running, and then process the EAP-request/AKA\'-challenge
information as normal.
##### 5.4.1.2.2.5 Network successfully authenticates UE {#network-
successfully-authenticates-ue .H6}
Upon reception of the EAP-response/AKA\'-challenge message, if procedures for
handling an EAP-response/AKA\'-challenge message as specified in IETF RFC 5448
[40] are successful and:
a) the AUSF acts as the EAP-AKA\' server, the AUSF shall generate EMSK, the
K~AUSF~ from the EMSK, and the K~SEAF~ from the K~AUSF~ as described in 3GPP
TS 33.501 [24]; or
b) the AAA server of the CH or the DCS acts as the EAP-AKA\' server, the AAA
server of the CH or the DCS shall generate MSK as described in 3GPP TS 33.501
[24];
and:
a) if the AUSF or the AAA server of the CH or the DCS included the
AT_RESULT_IND attribute in the EAP-request/AKA\'-challenge message and the
AT_RESULT_IND attribute is included in the corresponding EAP-
response/AKA\'-challenge message, the AUSF or the AAA server of the CH or the
DCS shall send an EAP-request/AKA\'-notification message as specified in IETF
RFC 5448 [40]; or
b) if the AUSF or the AAA server of the CH or the DCS:
1) included the AT_RESULT_IND attribute in the EAP-request/AKA\'-challenge
message and the AT_RESULT_IND attribute is not included in the EAP-
response/AKA\'-challenge message; or
2) did not include the AT_RESULT_IND attribute in the EAP-
request/AKA\'-challenge message;
then the AUSF or the AAA server of the CH or the DCS shall send an EAP-success
message as specified in IETF RFC 5448 [40] and shall consider the procedure
complete.
NOTE 1: When the AAA server of the CH or the DCS acts as the EAP-AKA\' server,
the AAA server of the CH or the DCS provides (via the NSSAAF) the MSK and the
SUPI to the AUSF. Upon reception of the MSK, the AUSF generates the K~AUSF~
from the MSK, and the K~SEAF~ from the K~AUSF~ as described in 3GPP TS 33.501
[24].
NOTE 2: The AUSF provides the K~SEAF~ and optionally the SUPI (unless the SEAF
provided the AUSF with the SUPI before) to the SEAF as described in 3GPP TS
33.501 [24]. Upon reception of the K~SEAF~ and optionally the SUPI, the SEAF
generates the K~AMF~ based on the ABBA, the K~SEAF~ and the SUPI as described
in 3GPP TS 33.501 [24] and provides ngKSI and the K~AMF~ to the AMF. Upon
reception of the ngKSI and the K~AMF~, the AMF creates a partial native 5G NAS
security context identified by the ngKSI and stores the K~AMF~ in the created
partial native 5G NAS security context.
##### 5.4.1.2.2.6 UE handling EAP-AKA\' notification message {#ue-handling-
eap-aka-notification-message .H6}
Upon receiving an EAP-request/AKA\'-notification message, the UE shall send an
EAP-response/AKA\'-notification message as specified in IETF RFC 5448 [40].
##### 5.4.1.2.2.6A EAP based Identification initiation by the network {#a-eap-
based-identification-initiation-by-the-network .H6}
If the AUSF or the AAA server of the CH or the DCS decides to initiate the EAP
based identification procedure, the AUSF or the AAA server of the CH or the
DCS shall send an EAP-Request/Identity or EAP-Request/AKA\'-Identity message
as specified in IETF RFC 5448 [40].
The AMF shall encapsulate the EAP-Request/Identity or EAP-
Request/AKA\'-Identity message in the AUTHENTICATION REQUEST message and send
it to the UE.
##### 5.4.1.2.2.6B EAP based Identification response by the UE {#b-eap-based-
identification-response-by-the-ue .H6}
Upon receipt of the AUTHENTICATION REQUEST message with EAP-Request/Identity
message the UE shall send an AUTHENTICATION RESPONSE message with EAP-
Response/Identity to the network. In the EAP-Response/Identity message, the UE
shall provide the requested identity according to 3GPP TS 33.501 [24] annex
F.2, in the UE identity in the EAP-Response/Identity message as specified in
IETF RFC 5448 [40].
Upon receipt of the AUTHENTICATION REQUEST message with EAP-
Request/AKA\'-Identity message the UE shall send an AUTHENTICATION RESPONSE
message with EAP-Response/AKA\'-Identity to the network. Based on the
attribute received in the EAP-Request/AKA\'-Identity, the UE shall provide the
requested identity according to 3GPP TS 33.501 [24] annex F.2, in the EAP-
Response/AKA\'-Identity message, as specified in IETF RFC 5448 [40].
If the EAP-Request/AKA\'-Identity carries the AT_PERMANENT_REQ, the UE shall
respond with EAP-Response/AKA\'-Client-Error with the error code \"unable to
process packet\".
##### 5.4.1.2.2.7 Network sending EAP-success message {#network-sending-eap-
success-message .H6}
Upon reception of the EAP-response/AKA\'-notification message, if earlier
procedures for handling an EAP-request/AKA\'-challenge message as specified in
IETF RFC 5448 [40] were successful, the AUSF or the AAA server of the CH or
the DCS shall send an EAP-success message as specified in IETF RFC 5448 [40]
and shall consider the procedure complete.
NOTE: The AUSF provides the K~SEAF~ to the SEAF. Upon reception of the
K~SEAF~, the SEAF generates the K~AMF~ based on the ABBA and the K~SEAF~ as
described in 3GPP TS 33.501 [24], and provides ngKSI and the K~AMF~ to the
AMF. Upon reception of the ngKSI and the K~AMF~, the AMF creates a partial
native 5G NAS security context identified by the ngKSI, and stores the K~AMF~
in the created partial native 5G NAS security context.
##### 5.4.1.2.2.8 UE handling EAP-success message {#ue-handling-eap-success-
message .H6}
Upon receiving an EAP-success message, the ME shall:
a) delete the valid K~AUSF~ and the valid K~SEAF~, if any;
b) if the ME has not generated a new K~AUSF~ and a new K~SEAF~ and has not
created a partial native 5G NAS security context as described in subclause
5.4.1.2.2.3:
1) if the UE operates in SNPN access operation mode and the credentials in the
USIM contain an indication to use MSK for derivation of K~AUSF~ after success
of primary authentication and key agreement procedure then generate a new
K~AUSF~ from the MSK otherwise generate a new K~AUSF~ from the EMSK;
NOTE: When the UE is registering or registered for onboarding services in
SNPN, credentials in the USIM do not contain an indication to use MSK for
derivation of K~AUSF~ after success of primary authentication and key
agreement procedure.
2) generate a new K~SEAF~ from the new K~AUSF~, and the K~AMF~ from the ABBA
that was received with the EAP-success message, and the new K~SEAF~ as
described in 3GPP TS 33.501 [24];
3) create a partial native 5G NAS security context identified by the ngKSI
value in the volatile memory of the ME; and
4) store the K~AMF~ in the created partial native 5G NAS security context; and
c) consider the new K~AUSF~ to be the valid K~AUSF~, and the new K~SEAF~ to be
the valid K~SEAF~, reset the SOR counter and the UE parameter update counter
to zero, and store the valid K~AUSF,~ the valid K~SEAF~, the SOR counter and
the UE parameter update counter as specified in annex C, and use the valid
K~AUSF~ in the verification of SOR transparent container and UE parameters
update transparent container, if any are received.
The UE shall consider the procedure complete.
##### 5.4.1.2.2.9 Network not successfully authenticates UE {#network-not-
successfully-authenticates-ue .H6}
Upon reception of the EAP-response/AKA\'-challenge message, if procedures for
handling an EAP-response/AKA\'-challenge message as specified in IETF RFC 5448
[40] are not successful, the AUSF or the AAA server of the CH or the DCS shall
send an EAP-request/AKA\'-notification message that implies failure as
specified in IETF RFC 5448 [40].
##### 5.4.1.2.2.10 Network sending EAP-failure message {#network-sending-eap-
failure-message .H6}
Upon reception of the EAP-response/AKA\'-notification message, if earlier
procedures for handling an EAP-request/AKA\'-challenge message as specified in
IETF RFC 5448 [40] were not successful, the AUSF or the AAA server of the CH
or the DCS shall send an EAP-failure message as specified in IETF RFC 5448
[40] and shall consider the procedure complete.
If the authentication response (RES) returned by the UE in the AT_RES
attribute of the EAP-response/AKA\'-challenge message is not valid, the
network handling depends upon the type of identity used by the UE in the
initial NAS message, that is:
\- if the 5G-GUTI was used; or
\- if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message
in the AUTHENTICATION RESULT message of the EAP result message transport
procedure, initiate an identification procedure to retrieve SUCI from the UE
and restart the EAP based primary authentication and key agreement procedure
with the received SUCI.
If the SUCI was used for identification in the initial NAS message or in a
restarted EAP based primary authentication and key agreement procedure, or the
network decides not to initiate the identification procedure to retrieve SUCI
from the UE after an unsuccessful EAP based primary authentication and key
agreement procedure, the network should transport the EAP-failure message in
an AUTHENTICATION REJECT message of the EAP result message transport
procedure.
Depending on local requirements or operator preference for emergency services,
if the UE initiates a registration procedure with 5GS registration type IE set
to \"emergency registration\" and the AMF is configured to allow emergency
registration without user identity, the AMF needs not follow the procedures
specified for transporting the EAP-failure message in the AUTHENTICATION
REJECT message of the EAP result message transport procedure in the present
subclause. The AMF may include the EAP-failure message in a response of the
current 5GMM specific procedure or in the AUTHENTICATION RESULT of the EAP
result message transport procedure.
##### 5.4.1.2.2.11 UE handling EAP-failure message {#ue-handling-eap-failure-
message .H6}
Upon receiving an EAP-failure message, the UE shall delete the partial native
5G NAS security context and shall delete the new K~AUSF~ and the new K~SEAF~,
if any were created as described in subclause 5.4.1.2.2.3.
The UE shall consider the procedure complete.
If the EAP-failure message is received in an AUTHENTICATION REJECT message:
1) if the AUTHENTICATION REJECT message has been successfully integrity
checked by the NAS:
\- the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the
stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI;
In case of PLMN, the USIM shall be considered invalid until switching off the
UE or the UICC containing the USIM is removed.
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE does not support access to an SNPN using credentials from a credentials
holder, the entry of the \"list of subscriber data\" with the SNPN identity of
the current SNPN shall be considered invalid until the UE is switched off or
the entry is updated. Additionally, the UE shall consider the USIM as invalid
for the current SNPN until switching off or the UICC containing the USIM is
removed.
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE supports access to an SNPN using credentials from a credentials holder,
the UE shall consider the selected entry of the \"list of subscriber data\" as
invalid until the UE is switched off or the entry is updated. Additionally,
the UE shall consider the USIM as invalid for the entry until switching off or
the UICC containing the USIM is removed.
If the UE is registered for onboarding services in SNPN or is performing
initial registration for onboarding services in SNPN, the UE shall store the
SNPN identity in the \"permanently forbidden SNPNs\" list for onboarding
services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN
selection or an SNPN selection for onboarding services according to 3GPP TS
23.122 [5];
\- if the UE is neither registered for onboarding services in SNPN nor
performing initial registration for onboarding services in SNPN, the UE shall
set:
i) the counter for \"SIM/USIM considered invalid for GPRS services\" events,
the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events, and the counter for \"SIM/USIM considered invalid for non-
GPRS services\" events if maintained by the UE, in case of PLMN; or
ii) the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events in case of SNPN;
to UE implementation-specific maximum value.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall set the SNPN-
specific attempt counter for the current SNPN to the UE implementation-
specific maximum value; and
\- if the UE is operating in single-registration mode, the UE shall handle EMM
parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the authentication
procedure is not accepted by the network. The USIM shall be considered as
invalid also for non-EPS services until switching off or the UICC containing
the USIM is removed; and
2) if the AUTHENTICATION REJECT message is received without integrity
protection, the UE shall start timer T3247 with a random value uniformly drawn
from the range between 30 minutes and 60 minutes, if the timer is not running
(see subclause 5.3.20).
Additionally, if the UE is neither registered for onboarding services in SNPN
nor performing initial registration for onboarding services in SNPN, the UE
shall:
a) if the AUTHENTICATION REJECT message is received over 3GPP access, and the
counter for \"SIM/USIM considered invalid for GPRS services\" events in case
of PLMN or the counter for \"the entry for the current SNPN considered invalid
for 3GPP access\" events in case of SNPN has a value less than a UE
implementation-specific maximum value, proceed as specified in subclause
5.3.20, list item 1)-a) of subclause 5.3.20.2 (if the UE is not operating in
SNPN access operation mode) or list item a)-1) of subclause 5.3.20.3 (if the
UE is operating in SNPN access operation mode) for the case that the 5GMM
cause value received is #3;
b) if the AUTHENTICATION REJECT message is received over non-3GPP access, and
the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events in case of PLMN or the counter for \"the entry for the current
SNPN considered invalid for non-3GPP access\" events in case of SNPN has a
value less than a UE implementation-specific maximum value, proceed as
specified in subclause 5.3.20, list item 1)-b) of subclause 5.3.20.2 (if the
UE is not operating in SNPN access operation mode) or list item a)-2) of
subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for
the case that the 5GMM cause value received is #3;
c) otherwise:
i) if the AUTHENTICATION REJECT message is received over 3GPP access:
\- The UE shall set the update status for 3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI.
\- In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
via 3GPP access and invalid for non-EPS service until switching off the UE or
the UICC containing the USIM is removed.
In case of SNPN, if the UE does not support access to an SNPN using
credentials from a credentials holder, the UE shall consider the entry of the
\"list of subscriber data\" with the SNPN identity of the current SNPN as
invalid for 3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN
via 3GPP access until switching off or the UICC containing the USIM is
removed.
In case of SNPN, if the UE supports access to an SNPN using credentials from a
credentials holder, the UE shall consider the selected entry of the \"list of
subscriber data\" as invalid for 3GPP access until the UE is switched off or
the entry is updated. Additionally, the UE shall consider the USIM as invalid
for the entry via 3GPP access until switching off or the UICC containing the
USIM is removed.
\- The UE shall set:
\- the counter for \"SIM/USIM considered invalid for GPRS services\" events
and the counter for \"SIM/USIM considered invalid for non-GPRS services\"
events if maintained by the UE, in case of PLMN; or
\- the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events in case of SNPN;
to UE implementation-specific maximum value.
\- If the UE is operating in single-registration mode, the UE shall handle
4G-GUTI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case
when the authentication procedure is not accepted by the network. The USIM
shall be considered as invalid also for non-EPS services until switching off
or the UICC containing the USIM is removed; and
ii) if the AUTHENTICATION REJECT message is received over non-3GPP access:
\- the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI;
\- in case of PLMN, the UE shall consider the USIM as invalid for 5GS services
via non-3GPP access until switching off the UE or the UICC containing the USIM
is removed.
In case of SNPN, the UE shall consider the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN as invalid for non-3GPP
access until the UE is switched off or the entry is updated. Additionally, the
UE shall consider the USIM as invalid for the current SNPN and for non-3GPP
access until switching off or the UICC containing the USIM is removed; and
\- the UE shall set:
\- the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events to UE implementation-specific maximum value in case of PLMN;
or
\- the counter for \"the entry for the current SNPN considered invalid for
non-3GPP access\" events to UE implementation-specific maximum value in case
of SNPN.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall:
a) if the SNPN-specific attempt counter for the SNPN sending the
AUTHENTICATION REJECT message has a value less than a UE implementation-
specific maximum value, increment the SNPN-specific attempt counter for the
SNPN; or
b) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED,
delete the stored 5G-GUTI, TAI list, last visited registered TAI, and ngKSI,
store the SNPN identity in the \"permanently forbidden SNPNs\" list for
onboarding services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an
SNPN selection or an SNPN selection for onboarding services according to 3GPP
TS 23.122 [5].
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort
any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or
T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any
stored SUCI.
##### 5.4.1.2.2.12 Abnormal cases in the UE {#abnormal-cases-in-the-ue .H6}
The following abnormal cases can be identified:
a) EAP-request/AKA\'-challenge message with the key derivation function
indicated in AT_KDF attributes set to a value other than 1.
The UE shall act as specified in IETF RFC 5448 [40] subclause 3.2 for the case
when the AUTN had been incorrect.
##### 5.4.1.2.3 EAP-TLS related procedures
##### 5.4.1.2.3.1 General {#general-33 .H6}
The UE may support acting as EAP-TLS peer as specified in 3GPP TS 33.501 [24].
The AUSF may support acting as EAP-TLS server as specified in 3GPP TS 33.501
[24]. The AAA server of the CH or the DCS may support acting as EAP server of
such EAP method as specified in 3GPP TS 23.501 [8].
The EAP-TLS enables mutual authentication of the UE and the network.
When initiating an EAP based primary authentication and key agreement
procedure using EAP-TLS, the network shall select an ngKSI value. If an ngKSI
is contained in an initial NAS message during a 5GMM procedure, the network
shall select a different ngKSI value. The network shall send the selected
ngKSI value to the UE along with each EAP message. The network shall send the
ABBA value as described in subclause 9.11.3.10 to the UE along with the EAP-
request message and EAP-success message.
When the EAP based primary authentication and key agreement procedure uses
EAP-TLS:
a) if the UE operates in SNPN access operation mode and:
1) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
2) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN;
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure then the ME shall generate
MSK as described in 3GPP TS 33.501 [24] otherwise the ME shall generate EMSK
as described in 3GPP TS 33.501 [24];
b) if the AUSF acts as the EAP-TLS server, the AUSF shall generate EMSK as
described in 3GPP TS 33.501 [24]; and
c) if the AAA server of the CH or the DCS acts as the EAP-TLS server, the AAA
server of the CH or the DCS shall generate MSK as described in 3GPP TS 33.501
[24].
When handling of an EAP-request message results into generation of MSK or
EMSK, if the UE operates in SNPN access operation mode and:
a) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
b) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN;
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure , then the ME may generate
a new K~AUSF~ from the MSK otherwise the ME may generate a new K~AUSF~ from
the EMSK.
If the ME generates a new K~AUSF~, the ME shall generate a new K~SEAF~ from
the new K~AUSF~, and the K~AMF~ from the ABBA received together with the EAP-
request message, and the new K~SEAF~ as described in 3GPP TS 33.501 [24], and
create a partial native 5G NAS security context identified by the ngKSI value
received together with the EAP-request message in subclause 5.4.1.2.4.2, in
the volatile memory of the ME. If the K~AMF~ and the partial native 5G NAS
security context are created, the ME shall store the K~AMF~ in the created
partial native 5G NAS security context.
NOTE 1: Generation of the new K~AUSF~ and the new K~SEAF~ does not result into
deletion of the valid K~AUSF~ and the valid K~SEAF~, if any.
The ME shall not use the new K~AUSF~ in the verification of SOR transparent
container and UE parameters update transparent container, if any are received,
until receipt of an EAP-success message.
When the AUSF acts as the EAP-TLS server and handling of an EAP response
message results into generation of EMSK, the AUSF shall generate the K~AUSF~
from the EMSK, and the K~SEAF~ from the K~AUSF~ as described in 3GPP TS 33.501
[24].
NOTE 2: When the AAA server of the CH or the DCS acts as the EAP-TLS server,
the AAA server of the CH or the DCS provides (via the NSSAAF) the MSK and the
SUPI to the AUSF. Upon reception of the MSK, the AUSF generates the K~AUSF~
from the MSK, and the K~SEAF~ from the K~AUSF~ as described in 3GPP TS 33.501
[24].
NOTE 3: The AUSF provides the K~SEAF~ and optionally the SUPI (unless the SEAF
provided the AUSF with the SUPI before) to the SEAF as described in 3GPP TS
33.501 [24]. Upon reception of the K~SEAF~ and optionally the SUPI, the SEAF
generates the K~AMF~ based on the ABBA, the K~SEAF~ and the SUPI as described
in 3GPP TS 33.501 [24], and provides ngKSI and the K~AMF~ to the AMF. Upon
reception of the ngKSI and the K~AMF~, the AMF creates a partial native 5G NAS
security context identified by the ngKSI, and stores the K~AMF~ in the created
partial native 5G NAS security context.
If the UE does not accept the server certificate of the network, the UE shall
start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-
response message is sent. Furthermore, the UE shall stop any of the
retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon
receiving an AUTHENTICATION REQUEST message with the EAP message IE containing
an EAP-request message from the network, the UE shall stop timer T3520, if
running, and then process the EAP-request message as normally.
If the network does not accept the client certificate of the UE, the network
handling depends upon the type of identity used by the UE in the initial NAS
message, that is:
\- if the 5G-GUTI was used; or
\- if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message
in the AUTHENTICATION RESULT message of the EAP result message transport
procedure, initiate an identification procedure to retrieve SUCI from the UE
and restart the EAP based primary authentication and key agreement procedure
with the received SUCI.
If the SUCI was used for identification in the initial NAS message or in a
restarted EAP based primary authentication and key agreement procedure, or the
network decides not to initiate the identification procedure to retrieve SUCI
from the UE after an unsuccessful the EAP based primary authentication and key
agreement procedure, the network should transport the EAP-failure message in
an AUTHENTICATION REJECT message of the EAP result message transport
procedure.
Depending on local requirements or operator preference for emergency services,
if the UE initiates a registration procedure with 5GS registration type IE set
to \"emergency registration\" and the AMF is configured to allow emergency
registration without user identity, the AMF needs not follow the procedures
specified for transporting the EAP-failure message in the AUTHENTICATION
REJECT message of the EAP result message transport procedure in the present
subclause. The AMF may include the EAP-failure message in a response of the
current 5GMM specific procedure or in the AUTHENTICATION RESULT of the EAP
result message transport procedure.
If the EAP-failure message is received in an AUTHENTICATION REJECT message:
a) if the AUTHENTICATION REJECT message has been successfully integrity
checked by the NAS:
1) the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the
stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the USIM shall be considered invalid until switching off the
UE or the UICC containing the USIM is removed.
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE does not support access to an SNPN using credentials from a credentials
holder, the entry of the \"list of subscriber data\" with the SNPN identity of
the current SNPN shall be considered invalid until the UE is switched off or
the entry is updated;
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE supports access to an SNPN using credentials from a credentials holder,
the UE shall consider the selected entry of the \"list of subscriber data\" as
invalid until the UE is switched off or the entry is updated.
If the UE is registered for onboarding services in SNPN or is performing
initial registration for onboarding services in SNPN, the UE shall store the
SNPN identity in the \"permanently forbidden SNPNs\" list for onboarding
services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN
selection or an SNPN selection for onboarding services according to 3GPP TS
23.122 [5];
2) if the UE is neither registered for onboarding services in SNPN nor
performing initial registration for onboarding services in SNPN, the UE shall
set:
i) the counter for \"SIM/USIM considered invalid for GPRS services\" events,
the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events, and the counter for \"SIM/USIM considered invalid for non-
GPRS services\" events if maintained by the UE, in case of PLMN; or
ii) the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events in case of SNPN;
NOTE 4: The term \"non-3GPP access\" used in the counter for \"the entry for
the current SNPN considered invalid for non-3GPP access\" events, is used to
express access to SNPN services via a PLMN.
to UE implementation-specific maximum value.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall set the SNPN-
specific attempt counter for the current SNPN to the UE implementation-
specific maximum value; and
3) if the UE is operating in single-registration mode, the UE shall handle EMM
parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the authentication
procedure is not accepted by the network. The USIM shall be considered as
invalid also for non-EPS services until switching off or the UICC containing
the USIM is removed; and
b) if the AUTHENTICATION REJECT message is received without integrity
protection, the UE shall start timer T3247 with a random value uniformly drawn
from the range between 30 minutes and 60 minutes, if the timer is not running
(see subclause 5.3.20).
Additionally, if the UE is neither registered for onboarding services in SNPN
nor performing initial registration for onboarding services in SNPN, the UE
shall:
1) if the AUTHENTICATION REJECT message is received over 3GPP access, and the
counter for \"SIM/USIM considered invalid for GPRS services\" events in case
of PLMN or the counter for \"the entry for the current SNPN considered invalid
for 3GPP access\" events in case of SNPN has a value less than a UE
implementation-specific maximum value, proceed as specified in subclause
5.3.20, list item 1)-a) of subclause 5.3.20.2 (if the UE is not SNPN enabled
or is not operating in SNPN access operation mode) or list item a) 1) of
subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for
the case that the 5GMM cause value received is #3;
2) if the AUTHENTICATION REJECT message is received over non-3GPP access, and
the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events in case of PLMN or the counter for \"the entry for the current
SNPN considered invalid for non-3GPP access\" events in case of SNPN has a
value less than a UE implementation-specific maximum value, proceed as
specified in subclause 5.3.20, list item 1)-b) of subclause 5.3.20.2 (if the
UE is not operating in SNPN access operation mode) or list item a)-2) of
subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for
the case that the 5GMM cause value received is #3; or
3) otherwise:
i) if the AUTHENTICATION REJECT message is received over 3GPP access:
A) the UE shall set the update status for 3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
via 3GPP access and invalid for non-EPS service until switching off the UE or
the UICC containing the USIM is removed.
In case of SNPN, if the UE does not support access to an SNPN using
credentials from a credentials holder, the UE shall consider the entry of the
\"list of subscriber data\" with the SNPN identity of the current SNPN as
invalid for 3GPP access until the UE is switched off or the entry is updated;
In case of SNPN, if the UE supports access to an SNPN using credentials from a
credentials holder, the UE shall consider the selected entry of the \"list of
subscriber data\" as invalid for 3GPP access until the UE is switched off or
the entry is updated;
B) the UE shall set:
\- the counter for \"SIM/USIM considered invalid for GPRS services\" events
and the counter for \"SIM/USIM considered invalid for non-GPRS services\"
events if maintained by the UE, in case of PLMN; or
\- the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events in case of SNPN;
to UE implementation-specific maximum value; and
C) If the UE is operating in single-registration mode, the UE shall handle
4G-GUTI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case
when the authentication procedure is not accepted by the network. The USIM
shall be considered as invalid also for non-EPS services until switching off
or the UICC containing the USIM is removed; and
ii) if the AUTHENTICATION REJECT message is received over non-3GPP access:
A) the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI. In case of PLMN, the USIM shall be
considered invalid for 5GS services via non-3GPP access until switching off
the UE or the UICC containing the USIM is removed. In case of SNPN, the UE
shall consider the entry of the \"list of subscriber data\" with the SNPN
identity of the current SNPN shall be considered invalid for non-3GPP access
until the UE is switched off or the entry is updated; and
B) the UE shall set the counter for \"USIM considered invalid for 5GS services
over non-3GPP access\" events in case of PLMN or the counter for \"the entry
for the current SNPN considered invalid for non-3GPP access\" events in case
of SNPN to UE implementation-specific maximum value.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall:
1) if the SNPN-specific attempt counter for the SNPN sending the
AUTHENTICATION REJECT message has a value less than a UE implementation-
specific maximum value, increment the SNPN-specific attempt counter for the
SNPN; or
2) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED,
delete the stored 5G-GUTI, TAI list, last visited registered TAI, and ngKSI,
store the SNPN identity in the \"permanently forbidden SNPNs\" list for
onboarding services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an
SNPN selection or an SNPN selection for onboarding services according to 3GPP
TS 23.122 [5].
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort
any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or
T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any
stored SUCI.
Upon receiving an EAP-success message, the ME shall:
a) delete the valid K~AUSF~ and the valid K~SEAF~, if any;
b) if the ME has not generated a new K~AUSF~ and a new K~SEAF~ and has not
created a partial native 5G NAS security context when handling the EAP-request
message which resulted into generation of EMSK or MSK as described above:
1) if the UE operates in SNPN access operation mode and:
i) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
ii) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN;
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure then generate a new K~AUSF~
from the MSK otherwise generate a new K~AUSF~ from the EMSK;
2) generate a new K~SEAF~ from the new K~AUSF~, and the K~AMF~ from the ABBA
that was received with the EAP-success message, and the new K~SEAF~ as
described in 3GPP TS 33.501 [24];
3) create a partial native 5G NAS security context identified by the ngKSI
value in the volatile memory of the ME; and
4) store the K~AMF~ in the created partial native 5G NAS security context; and
c) consider the new K~AUSF~ to be the valid K~AUSF~, and the new K~SEAF~ to be
the valid K~SEAF~, reset the SOR counter and the UE parameter update counter
to zero, store the valid K~AUSF,~ the valid K~SEAF~, the SOR counter and the
UE parameter update counter as specified in annex C, and use the valid K~AUSF~
in the verification of SOR transparent container and UE parameters update
transparent container, if any are received.
The UE shall consider the procedure complete.
Upon receiving an EAP-failure message, the UE shall delete the partial native
5G NAS security context and shall delete the new K~AUSF~ and the new K~SEAF~,
if any were created when handling the EAP-request message which resulted into
generation of EMSK or MSK as described above.
The UE shall consider the procedure complete.
##### 5.4.1.2.3A Procedures related to EAP methods other than EAP-AKA\' and
EAP-TLS
##### 5.4.1.2.3A.1 General {#a.1-general-1 .H6}
This subclause applies when an EAP method:
a) supporting mutual authentication;
b) supporting EMSK or MSK generation; and
c) other than EAP-AKA\' and EAP-TLS;
is used for primary authentication and key agreement in an SNPN.
The UE may support acting as EAP peer of such EAP method as specified in 3GPP
TS 33.501 [24]. The AUSF may support acting as EAP server of such EAP method
as specified in 3GPP TS 33.501 [24]. The AAA server of the CH or the DCS may
support acting as EAP server of such EAP method as specified in 3GPP TS 23.501
[8].
When initiating an EAP based primary authentication and key agreement
procedure using such EAP method, the network shall select an ngKSI value. If
an ngKSI is contained in an initial NAS message during a 5GMM procedure, the
network shall select a different ngKSI value. The network shall send the
selected ngKSI value to the UE along with each EAP message. The network shall
send the ABBA value as described in subclause 9.11.3.10 to the UE along with
the EAP-request message and EAP-success message.
When the EAP based primary authentication and key agreement procedure uses
such EAP method:
a) if:
1) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
2) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN;
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure then the ME shall generate
MSK as described in 3GPP TS 33.501 [24] otherwise the ME shall generate EMSK
as described in 3GPP TS 33.501 [24];
b) if the AUSF acts as the EAP server, the AUSF shall generate EMSK as
described in 3GPP TS 33.501 [24]; and
c) if the AAA server of the CH or the DCS acts as the EAP server, the AAA
server of the CH or the DCS shall generate MSK as described in 3GPP TS 33.501
[24].
When handling of an EAP-request message results into generation of MSK or
EMSK, if:
a) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
b) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN;
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure then the ME may generate a
new K~AUSF~ from the MSK otherwise the ME may generate a new K~AUSF~ from the
EMSK.
If the ME generates a new K~AUSF~, the ME shall generate a new K~SEAF~ from
the new K~AUSF~, and the K~AMF~ from the ABBA received together with the EAP-
request message, and the new K~SEAF~ as described in 3GPP TS 33.501 [24], and
create a partial native 5G NAS security context identified by the ngKSI value
received together with the EAP-request message in subclause 5.4.1.2.4.2, in
the volatile memory of the ME. If the K~AMF~ and the partial native 5G NAS
security context are created, the ME shall store the K~AMF~ in the created
partial native 5G NAS security context.
NOTE 1: Generation of the new K~AUSF~ and the new K~SEAF~ does not result into
deletion of the valid K~AUSF~ and the valid K~SEAF~, if any.
The ME shall not use the new K~AUSF~ in the verification of SOR transparent
container and UE parameters update transparent container, if any are received,
until receipt of an EAP-success message.
When the AUSF acts as the EAP server and handling of an EAP response message
results into generation of EMSK, the AUSF shall generate the K~AUSF~ from the
EMSK, and the K~SEAF~ from the K~AUSF~ as described in 3GPP TS 33.501 [24].
NOTE 2: When the AAA server of the CH or the DCS acts as the EAP server and
handling of an EAP response message results into generation of MSK, the AAA
server of the CH or the DCS provides (via the NSSAAF) the MSK and the SUPI to
the AUSF. Upon reception of the MSK, the AUSF generates the K~AUSF~ from the
MSK, and the K~SEAF~ from the K~AUSF~ as described in 3GPP TS 33.501 [24].
NOTE 3: The AUSF provides the K~SEAF~ and optionally the SUPI (unless the SEAF
provided the AUSF with the SUPI before) to the SEAF as described in 3GPP TS
33.501 [24]. Upon reception of the K~SEAF~ and optionally the SUPI, the SEAF
generates the K~AMF~ based on the ABBA, the K~SEAF~ and the SUPI as described
in 3GPP TS 33.501 [24], and provides ngKSI and the K~AMF~ to the AMF. Upon
reception of the ngKSI and the K~AMF~, the AMF creates a partial native 5G NAS
security context identified by the ngKSI, and stores the K~AMF~ in the created
partial native 5G NAS security context.
If the UE fails to authenticate the network, the UE shall start timer T3520
when the AUTHENTICATION RESPONSE message containing the EAP-response message
is sent. Furthermore, the UE shall stop any of the retransmission timers that
are running (e.g. T3510, T3517 or T3521). Upon receiving an AUTHENTICATION
REQUEST message with the EAP message IE containing an EAP-request message from
the network, the UE shall stop timer T3520, if running, and then process the
EAP-request message as normally.
If the network fails to authenticate the UE, the network handling depends upon
the type of identity used by the UE in the initial NAS message, that is:
\- if the 5G-GUTI was used; or
\- if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message
in the AUTHENTICATION RESULT message of the EAP result message transport
procedure, initiate an identification procedure to retrieve SUCI from the UE
and restart the EAP based primary authentication and key agreement procedure
with the received SUCI.
If the SUCI was used for identification in the initial NAS message or in a
restarted EAP based primary authentication and key agreement procedure, or the
network decides not to initiate the identification procedure to retrieve SUCI
from the UE after an unsuccessful the EAP based primary authentication and key
agreement procedure, the network should transport the EAP-failure message in
an AUTHENTICATION REJECT message of the EAP result message transport
procedure.
If the EAP-failure message is received in an AUTHENTICATION REJECT message:
a) if the AUTHENTICATION REJECT message has been successfully integrity
checked by the NAS:
1) the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the
stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE does not support access to an SNPN using credentials from a credentials
holder, the entry of the \"list of subscriber data\" with the SNPN identity of
the current SNPN shall be considered invalid until the UE is switched off or
the entry is updated;
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE supports access to an SNPN using credentials from a credentials holder,
the UE shall consider the selected entry of the \"list of subscriber data\" as
invalid until the UE is switched off or the entry is updated.
In case of SNPN, if the UE is registered for onboarding services in SNPN or is
performing initial registration for onboarding services in SNPN, the UE shall
store the SNPN identity in the \"permanently forbidden SNPNs\" list for
onboarding services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an
SNPN selection or an SNPN selection for onboarding services according to 3GPP
TS 23.122 [5]; and
2) if the UE is neither registered for onboarding services in SNPN nor
performing initial registration for onboarding services in SNPN, the UE shall
set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events in case of SNPN to UE
implementation-specific maximum value.
NOTE 4: The term \"non-3GPP access\" used in the counter for \"the entry for
the current SNPN considered invalid for non-3GPP access\" events, is used to
express access to SNPN services via a PLMN.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall set the SNPN-
specific attempt counter for the current SNPN to the UE implementation-
specific maximum value; and
b) if the AUTHENTICATION REJECT message is received without integrity
protection, the UE shall start timer T3247 with a random value uniformly drawn
from the range between 30 minutes and 60 minutes, if the timer is not running
(see subclause 5.3.20).
Additionally, if the UE is neither registered for onboarding services in SNPN
nor performing initial registration for onboarding services in SNPN, the UE
shall:
1) if the AUTHENTICATION REJECT message is received over 3GPP access, and the
counter for \"the entry for the current SNPN considered invalid for 3GPP
access\" events has a value less than a UE implementation-specific maximum
value, proceed as specified in list item a) 1) of subclause 5.3.20.3 for the
case that the 5GMM cause value received is #3;
2) if the AUTHENTICATION REJECT message is received over non-3GPP access, and
the counter for \"the entry for the current SNPN considered invalid for
non-3GPP access\" events has a value less than a UE implementation-specific
maximum value, proceed as specified in list item a)-2) of subclause 5.3.20.3
for the case that the 5GMM cause value received is #3; or
3) otherwise:
i) if the AUTHENTICATION REJECT message is received over 3GPP access:
\- the UE shall set the update status for 3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI;
In case of SNPN, if the UE does not support access to an SNPN using
credentials from a credentials holder, the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN shall be considered invalid
for 3GPP access until the UE is switched off or the entry is updated;
In case of SNPN, if the UE supports access to an SNPN using credentials from a
credentials holder, the UE shall consider the selected entry of the \"list of
subscriber data\" as invalid until the UE is switched off or the entry is
updated; and
\- the UE shall set the counter for \"the entry for the current SNPN
considered invalid for 3GPP access\" events to UE implementation-specific
maximum value; and
ii) if the AUTHENTICATION REJECT message is received over non-3GPP access:
\- the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI. The entry of the \"list of subscriber data\"
with the SNPN identity of the current SNPN shall be considered invalid for
non-3GPP access until the UE is switched off or the entry is updated; and
\- the UE shall set the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events to UE implementation-specific
maximum value.
NOTE 5: The AUTHENTICATION REJECT message \"received over non-3GPP access\" in
this subclause refers to an AUTHENTICATION REJECT message received via a PLMN
when the UE attempts to access SNPN services via a PLMN.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall:
1) if the SNPN-specific attempt counter for the SNPN sending the
AUTHENTICATION REJECT message has a value less than a UE implementation-
specific maximum value, increment the SNPN-specific attempt counter for the
SNPN; or
2) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED,
delete the stored 5G-GUTI, TAI list, last visited registered TAI, and ngKSI,
store the SNPN identity in the \"permanently forbidden SNPNs\" list for
onboarding services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an
SNPN selection or an SNPN selection for onboarding services according to 3GPP
TS 23.122 [5].
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort
any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or
T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any
stored SUCI.
Upon receiving an EAP-success message, the ME shall:
a) delete the valid K~AUSF~ and the valid K~SEAF~, if any;
b) if the ME has not generated a new K~AUSF~ and a new K~SEAF~ and has not
created a partial native 5G NAS security context when handling the EAP-request
message which resulted into generation of EMSK as described above:
1) if:
i) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
ii) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN;
contain an indication to use MSK for derivation of K~AUSF~ after success of
primary authentication and key agreement procedure then generate a new K~AUSF~
from the MSK otherwise generate a new K~AUSF~ from the EMSK;
2) generate a new K~SEAF~ from the new K~AUSF~, and the K~AMF~ from the ABBA
that was received with the EAP-success message, and the K~SEAF~ as described
in 3GPP TS 33.501 [24];
3) create a partial native 5G NAS security context identified by the ngKSI
value in the volatile memory of the ME; and
4) store the K~AMF~ in the created partial native 5G NAS security context; and
c) consider the new K~AUSF~ to be the valid K~AUSF~, and the new K~SEAF~ to be
the valid K~SEAF~, reset the SOR counter and the UE parameter update counter
to zero, store the valid K~AUSF,~ the valid K~SEAF~, the SOR counter and the
UE parameter update counter as specified in annex C, and use the valid K~AUSF~
in the verification of SOR transparent container and UE parameters update
transparent container, if any are received.
The UE shall consider the procedure complete.
Upon receiving an EAP-failure message, the UE shall delete the partial native
5G NAS security context and shall delete the new K~AUSF~ and the new K~SEAF~,
if any were created when handling the EAP-request message which resulted into
generation of EMSK or MSK as described above.
The UE shall consider the procedure complete.
##### 5.4.1.2.3A.2 EAP-TTLS with two phases of authentication {#a.2-eap-ttls-
with-two-phases-of-authentication .H6}
The UE may support acting as EAP peer of EAP-TTLS with two phases of
authentication as specified in 3GPP TS 33.501 [24] and acting as peer of a
legacy authentication protocol as specified in 3GPP TS 33.501 [24]. The AUSF
may support acting as EAP server of EAP-TTLS with two phases of authentication
as specified in 3GPP TS 33.501 [24]. The AAA server of CH may support acting a
server of a legacy authentication protocol as specified in 3GPP TS 33.501
[24].
When EAP-TTLS with two phases of authentication as specified in 3GPP TS 33.501
[24] is used for primary authentication and key agreement in an SNPN:
a) requirements in subclause 5.4.1.2.3A.1 shall apply in addition to
requirements specified in 3GPP TS 33.501 [24] annex U.
b) indication to use MSK for derivation of K~AUSF~ after success of primary
authentication and key agreement procedure is not included in:
1) the default UE credentials for primary authentication, if the UE is
registering or registered for onboarding services in SNPN; or
2) credentials in the selected entry of the \"list of subscriber data\", if
the UE is not registering or registered for onboarding services in SNPN.
c) the SUPI of the UE is in the form of a SUPI with the SUPI format \"network
specific identifier\" containing a network-specific identifier.
NOTE: Support of EAP-TTLS with two phases of authentication is based on the
informative requirements as specified in 3GPP TS 33.501 [24].
##### 5.4.1.2.3B Procedures related to EAP methods used for primary
authentication of an N5GC device
##### 5.4.1.2.3B.1 General {#b.1-general .H6}
This subclause applies when an EAP method:
a) supporting mutual authentication; and
b) other than EAP-AKA\',
is used for primary authentication of an N5GC device, when an W-AGF supports
acting on behalf of the N5GC device, the AMF supports serving the W-AGF acting
on behalf of the N5GC device and the AUSF supports authentication of the N5GC
device. EAP-TLS is an example of such EAP method.
NOTE 1: Neither the N5GC device nor the AUSF derive any 5G related keys during
or after the primary authentication.
The AUSF supporting authentication of the N5GC device shall support acting as
EAP server of at least one such EAP method as specified in annex O of 3GPP TS
33.501 [24].
The N5GC device shall support acting as EAP peer of at least one such EAP
method as specified in annex O of 3GPP TS 33.501 [24], which is also supported
by the AUSF.
The W-AGF acting on behalf of the N5GC device provides to the N5GC device an
EAP-request message, an EAP-success message or an EAP-failure message received
from the network according to subclause 5.4.1.2.1 and sends to the network
according to subclause 5.4.1.2.1 an EAP-response provided by the N5GC device.
The N5GC device can inform the W-AGF acting on behalf of the N5GC device that
the N5GC device fails to authenticate the network. Details of communication
between the N5GC device and the W-AGF acting on behalf of the N5GC device are
out of scope of this specification.
When initiating an EAP based primary authentication and key agreement
procedure using such EAP method, the network shall select an ngKSI value. The
network shall send the selected ngKSI value to the W-AGF acting on behalf of
the N5GC device along with each EAP message. The network shall send the ABBA
value as described in subclause 9.11.3.10 to the W-AGF acting on behalf of the
N5GC device along with the EAP-request message and EAP-success message. The
W-AGF acting on behalf of the N5GC device shall not forward the ngKSI value or
the ABBA value to the N5GC device.
NOTE 2: The network provides the ngKSI value and the ABBA value since the
ngKSI IE and the ABBA IE are mandatory IEs in AUTHENTICATION REQUEST message.
The W-AGF acting on behalf of the N5GC device does not use the ngKSI value or
the ABBA value provided by the network.
If the N5GC device fails to authenticate the network, the W-AGF acting on
behalf of the N5GC device shall start timer T3520 when the AUTHENTICATION
RESPONSE message containing the EAP-response message is sent. Furthermore, the
W-AGF acting on behalf of the N5GC device shall stop any of the retransmission
timers that are running (e.g. T3510, T3517 or T3521). Upon receiving an
AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-
request message from the network, the W-AGF acting on behalf of the N5GC
device shall stop timer T3520, if running, and then provides the EAP-request
message to the N5GC device as normally.
If the network fails to authenticate the N5GC device, the network handling
depends upon the type of identity used by the W-AGF acting on behalf of the
N5GC device in the initial NAS message, that is:
a) if the 5G-GUTI was used; or
b) if the SUCI was used.
If the 5G-GUTI was used, the network should transport the EAP-failure message
in the AUTHENTICATION RESULT message of the EAP result message transport
procedure, initiate an identification procedure to retrieve SUCI from the
W-AGF acting on behalf of the N5GC device and restart the EAP based primary
authentication and key agreement procedure with the received SUCI.
If the SUCI was used for identification in the initial NAS message or in a
restarted EAP based primary authentication and key agreement procedure, or the
network decides not to initiate the identification procedure to retrieve SUCI
from the W-AGF acting on behalf of the N5GC device after an unsuccessful EAP
based primary authentication and key agreement procedure, the network should
transport the EAP-failure message in an AUTHENTICATION REJECT message of the
EAP result message transport procedure.
If the EAP-failure message is received in an AUTHENTICATION REJECT message,
the W-AGF acting on behalf of the N5GC device shall start timer T3247 with a
random value uniformly drawn from the range between 30 minutes and 60 minutes,
if the timer is not running (see subclause 5.3.20). Additionally, the W-AGF
acting on behalf of the N5GC device shall:
a) if the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events has a value less than a W-AGF implementation-specific maximum
value, proceed as specified in list item 1)-b) of subclause 5.3.20.2 for the
case that the 5GMM cause value received is #3; or
b) otherwise, set the update status to 5U3 ROAMING NOT ALLOWED, delete the
stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI. The USIM
shall be considered invalid for 5GS services via non-3GPP access until
switching off or the UICC containing the USIM is removed.
If the AUTHENTICATION REJECT message is received by the W-AGF acting on behalf
of the N5GC device, the W-AGF acting on behalf of the N5GC device shall abort
any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or
T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any
stored SUCI.
Upon receiving an EAP-success message, the W-AGF acting on behalf of the N5GC
device shall consider the procedure complete.
Upon receiving an EAP-failure message, the W-AGF acting on behalf of the N5GC
device shall consider the procedure complete.
##### 5.4.1.2.4 EAP message reliable transport procedure
##### 5.4.1.2.4.1 General {#general-34 .H6}
The purpose of the EAP message reliable transport procedure is to provide a
reliable transport of an EAP-request message, the ngKSI and the ABBA from the
network to the UE and of an EAP-response message from the UE to the network.
The EAP message reliable transport procedure is initiated by an AUTHENTICATION
REQUEST message with the EAP message IE.
##### 5.4.1.2.4.2 EAP message reliable transport procedure initiation by the
network {#eap-message-reliable-transport-procedure-initiation-by-the-network
.H6}
In order to initiate the EAP message reliable transport procedure, the AMF
shall create an AUTHENTICATION REQUEST message.
The AMF shall set the EAP message IE of the AUTHENTICATION REQUEST message to
the EAP-request message to be sent to the UE. The AMF shall set the ngKSI IE
of the AUTHENTICATION REQUEST message to the ngKSI value selected in subclause
5.4.1.2.2.2, subclause 5.4.1.2.3.1 or subclause 5.4.1.2.3A.1. In this release
of specification, the AMF shall set the ABBA IE of the AUTHENTICATION REQUEST
message with the length of ABBA IE to 2 and the ABBA contents to be 2 octets
in length with value 0000H as described in subclause 9.11.3.10.
The AMF shall send the AUTHENTICATION REQUEST message to the UE, and the AMF
shall start timer T3560 (see example in figure 5.4.1.2.4.2.1).
Figure 5.4.1.2.4.2.1: EAP message reliable transport procedure
Upon receipt of an AUTHENTICATION REQUEST message with the EAP message IE, the
UE handles the EAP message received in the EAP message IE and the ABBA of the
AUTHENTICATION REQUEST message.
###### 5.4.1.2.4.3 EAP message reliable transport procedure accepted by the UE
{#eap-message-reliable-transport-procedure-accepted-by-the-ue .list-paragraph}
The UE shall create an AUTHENTICATION RESPONSE message.
If the received EAP message is an EAP-request message, the UE shall set the
EAP message IE of the AUTHENTICATION RESPONSE message to the EAP-response
message responding to the received EAP-request message.
The UE shall send the AUTHENTICATION RESPONSE message to the AMF.
Upon receipt of an AUTHENTICATION RESPONSE message, the AMF shall stop timer
T3560. If the EAP message IE is included in the AUTHENTICATION RESPONSE
message, the AMF handles the EAP message received in the EAP message IE of the
AUTHENTICATION RESPONSE message.
##### 5.4.1.2.4.4 Abnormal cases on the network side {#abnormal-cases-on-the-
network-side .H6}
The following abnormal cases can be identified:
a) Expiry of timer T3560.
The AMF shall, on the first expiry of the timer T3560, retransmit the
AUTHENTICATION REQUEST message and shall reset and start timer T3560. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3560, the AMF shall abort the EAP based primary authentication and key
agreement procedure and any ongoing 5GMM specific procedure, and release the
N1 NAS signalling connection.
b) Lower layers indication of non-delivered NAS PDU due to handover.
If the AUTHENTICATION REQUEST message could not be delivered due to an intra
AMF handover and the target TA is included in the TAI list, then upon
successful completion of the intra AMF handover the AMF shall retransmit the
AUTHENTICATION REQUEST message. If a failure of handover procedure is reported
by the lower layer and the N1 NAS signalling connection exists, the AMF shall
retransmit the AUTHENTICATION REQUEST message.
##### 5.4.1.2.4.5 Abnormal cases in the UE {#abnormal-cases-in-the-ue-1 .H6}
The following abnormal cases can be identified:
a) Authentication failure (5GMM cause #71 \"ngKSI already in use\").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #71
\"ngKSI already in use\", to the network and start the timer T3520 (see
example in figure 5.4.1.3.7.1). Furthermore, the UE shall stop any of the
retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon the
first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause
#71 \"ngKSI already in use\", the network performs necessary actions to select
a new ngKSI and send the same EAP-request message to the UE.
NOTE 1: Upon receipt of an AUTHENTICATION FAILURE message from the UE with
5GMM cause #71 \"ngKSI already in use\", the network can also re-initiate the
EAP based primary authentication and key agreement procedure (see subclause
5.4.1.2.2.2).
Upon receiving a new AUTHENTICATION REQUEST message with the EAP message IE
containing an EAP-request message from the network, the UE shall stop timer
T3520, if running, process the EAP-request message as normal.
If the network is validated successfully (an AUTHENTICATION REQUEST message
that contains a valid ngKSI and EAP-request message is received), the UE shall
send the AUTHENTICATION RESPONSE message to the network and shall start any
retransmission timers (e.g. T3510, T3517 or T3521) if they were running and
stopped when the UE received the first failed AUTHENTICATION REQUEST message.
b) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION
FAILURE message indication from lower layers (if the EAP based primary
authentication and key agreement procedure is triggered by a registration
procedure).
The UE shall stop the timer T3520, if running, and re-initiate the
registration procedure.
c) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION
FAILURE message indication with change in the current TAI (if the EAP based
primary authentication and key agreement procedure is triggered by a service
request procedure).
The UE shall stop the timer T3520, if running.
If the current TAI is not in the TAI list, the EAP based primary
authentication and key agreement procedure shall be aborted and a registration
procedure for mobility and periodic registration update shall be initiated.
If the current TAI is still part of the TAI list, it is up to the UE
implementation how to re-run the ongoing procedure that triggered the EAP
based primary authentication and key agreement procedure.
d) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION
FAILURE message indication without change in the current TAI (if the
authentication procedure is triggered by a service request procedure).
The UE shall stop the timer T3520, if running. It is up to the UE
implementation how to re-run the ongoing procedure that triggered the EAP
based primary authentication and key agreement procedure.
e) Network failing the authentication check.
If the UE deems that the network has failed the authentication check, then it
shall request RRC to locally release the RRC connection and treat the active
cell as barred (see 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C]). The UE shall
start any retransmission timers (e.g. T3510, T3517 or T3521), if they were
running and stopped when the UE received the first AUTHENTICATION REQUEST
message containing an ngKSI that was already in use.
f) Change in the current TAI.
If that the current TAI is not in the TAI list before the AUTHENTICATION
RESPONSE message is sent, the UE may discard sending the AUTHENTICATION
RESPONSE message to the network and continue with the initiation of the
registration procedure for mobility and periodic registration as described in
subclause 5.5.1.3.2.
For item e, if no emergency service is started or is ongoing:
The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-
IDLE mode, e.g. upon detection of a lower layer failure, release of the N1 NAS
signalling connection, or as the result of an inter-system change in 5GMM-
CONNECTED mode from N1 mode to S1 mode.
The UE shall deem that the network has failed the authentication check or
assume that the authentication is not genuine and proceed as described in item
e above if any of the following occurs:
\- the timer T3520 expires;
\- the UE detects any combination of the EAP-based authentication failures:
transmission of AUTHENTICATION FAILURE message with 5GMM cause #71 \"ngKSI
already in use\", transmission of AUTHENTICATION RESPONSE message with an EAP-
response message after detecting an error as described in subclause
5.4.1.2.2.4, with an EAP-response message after not accepting of the server
certificate as described in subclause 5.4.1.2.3.1 or with an EAP-response
message after failing to authenticate the network as described in subclause
5.4.1.2.3A.1, during three consecutive authentication challenges. The EAP-
request/AKA\'-challenge challenges shall be considered as consecutive only, if
the EAP-request/AKA\'-challenge challenges causing the second and third EAP-
based authentication failure are received by the UE, while the timer T3520
started after the previous EAP-based authentication failure is running. Not
accepting of the server certificate shall be considered as consecutive only,
if the EAP-request messages causing the second and third not accepting of the
server certificate are received by the UE, while the timer T3520 started after
the previous EAP request message causing the previous not accepting of the
server certificate is running.
NOTE 2: Reception of an EAP-failure message is not considered when determining
the three consecutive authentication challenges or three consecutive not
accepting of the server certificate.
For item e if there is an emergency service started or is ongoin:
The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-
IDLE mode, e.g. upon detection of a lower layer failure, release of the N1 NAS
signalling connection, or as the result of an inter-system change in 5GMM-
CONNECTED mode from N1 mode to S1 mode.
If a UE has an emergency PDU session established or is establishing an
emergency PDU session, and sends an AUTHENTICATION FAILURE message to the AMF
with the 5GMM cause appropriate for this cases (i.e. #71) or an AUTHENTICATION
RESPONSE message containing an EAP-response message as described in subclause
5.4.1.2.2.4, containing an EAP-response message after not accepting of the
server certificate as described in subclause 5.4.1.2.3.1 or containing an EAP-
response message after failing to authenticate the network as described in
subclause 5.4.1.2.3A.1, and receives the SECURITY MODE COMMAND message before
the timeout of timer T3520, the UE shall deem that the network has passed the
authentication check successfully, stop timer T3520, respectively, and execute
the security mode control procedure.
If a UE has an emergency PDU session established or is establishing an
emergency PDU session when timer T3520 expires, the UE shall not deem that the
network has failed the authentication check and not behave as described in
item e. Instead the UE shall continue using the current security context, if
any, release all non-emergency PDU sessions, if any, by initiating UE-
requested PDU session release procedure. If there is an ongoing PDU session
establishment procedure, the UE shall release all non-emergency PDU sessions
upon completion of the PDU session establishment procedure.
The UE shall start any retransmission timers (e.g. T3510, T3517 or T3521) if:
\- they were running and stopped when the UE received the AUTHENTICATION
REQUEST message and detected an authentication failure; and
\- the procedures associated with these timers have not yet been completed.
The UE shall consider itself to be registered for emergency services.
##### 5.4.1.2.5 EAP result message transport procedure
##### 5.4.1.2.5.1 General {#general-35 .H6}
The purpose of the EAP result message transport procedure is to provide an
EAP-success message or an EAP-failure message, and ngKSI from the network to
the UE, when the EAP message cannot be piggybacked by another NAS message.
The EAP result message transport procedure is initiated:
\- by an AUTHENTICATION RESULT message with the EAP message IE carrying the
EAP-success message or the EAP-failure message; or
\- by an AUTHENTICATION REJECT message with the EAP message IE carrying the
EAP-failure message.
##### 5.4.1.2.5.2 EAP result message transport procedure initiation by the
network {#eap-result-message-transport-procedure-initiation-by-the-network
.H6}
In order to initiate the EAP result message transport procedure, the AMF shall
create an AUTHENTICATION RESULT message or an AUTHENTICATION REJECT message.
The AMF shall set the EAP message IE of the AUTHENTICATION RESULT message to
an EAP-success message or an EAP-failure message to be sent to the UE. The AMF
shall set the EAP message IE of the AUTHENTICATION REJECT message to an EAP-
failure message to be sent to the UE. The AMF shall set the ngKSI IE of the
AUTHENTICATION RESULT message or the AUTHENTICATION REJECT message to the
ngKSI value selected in subclause 5.4.1.2.2.2, subclause 5.4.1.2.3.1 or
subclause 5.4.1.2.3A.1.
The AMF shall send the AUTHENTICATION RESULT message or the AUTHENTICATION
REJECT message to the UE (see example in figure 5.4.1.2.5.2.1).
Figure 5.4.1.2.5.2.1: EAP result message transport procedure
Upon receipt of an AUTHENTICATION RESULT message or an AUTHENTICATION REJECT
message with the EAP message IE, the UE handles the EAP message received in
the EAP message IE and the ABBA if received of the AUTHENTICATION RESULT
message or in the AUTHENTICATION REJECT message.
#### 5.4.1.3 5G AKA based primary authentication and key agreement procedure
##### 5.4.1.3.1 General
The purpose of the 5G AKA based primary authentication and key agreement
procedure is to provide mutual authentication between the UE and the network
and to agree on the keys K~AUSF~, K~SEAF~ and K~AMF~ (see 3GPP TS 33.501
[24]). The cases when the 5G AKA based primary authentication and key
agreement procedure is used are defined in 3GPP TS 33.501 [24].
The network initiates the 5G AKA based primary authentication and key
agreement procedure by sending an AUTHENTICATION REQUEST message to the UE
without the EAP message IE. The network shall include the ngKSI and the ABBA
in AUTHENTICATION REQUEST message.
The 5G AKA based primary authentication and key agreement procedure is always
initiated and controlled by the network. However, the UE can reject the 5G
authentication challenge sent by the network.
The UE shall proceed with a 5G authentication challenge only if a USIM is
present.
A partial native 5G NAS security context is established in the UE and the
network when a 5G authentication is successfully performed. During a
successful 5G AKA based primary authentication and key agreement procedure,
the CK and IK are computed by the USIM. CK and IK are then used by the ME as
key material to compute new keys K~AUSF~, K~SEAF~ and K~AMF~. K~AMF~ is stored
in the 5G NAS security contexts (see 3GPP TS 33.501 [24]) of both the network
and in the volatile memory of the ME while registered to the network, and is
the root for the 5GS integrity protection and ciphering key hierarchy.
NOTE 1: Generation of the new K~AUSF~ and the new K~SEAF~ does not result into
deletion of the valid K~AUSF~ and the valid K~SEAF~, if any.
The 5G AKA based primary authentication and key agreement procedure is
initiated by an AUTHENTICATION REQUEST message without the EAP message IE.
Upon successful completion of the 5G AKA based primary authentication, the AMF
shall initiate a security mode control procedure (see subclause 5.4.2) to take
the new partial native 5G NAS security context into use.
NOTE 2: The AMF shall immediately initiate a security mode control procedure
(see subclause 5.4.2) after 5G AKA primary authentication is successful to
avoid K~AUSF~ key mismatch between the UE and the network.
##### 5.4.1.3.2 Authentication initiation by the network
The network may initiate a 5G AKA based primary authentication and key
agreement procedure for a UE in 5GMM-CONNECTED mode at any time. For
restrictions applicable after handover or inter-system change to N1 mode in
5GMM-CONNECTED mode, see subclause 5.5.1.3.3.
The network initiates the 5G AKA based primary authentication and key
agreement procedure by sending an AUTHENTICATION REQUEST message to the UE and
starting the timer T3560 (see example in figure 5.4.1.3.2.1). The
AUTHENTICATION REQUEST message shall contain the parameters necessary to
calculate the authentication response (see 3GPP TS 33.501 [24]). This message
shall include the ngKSI that will be used by the UE and AMF to identify the
K~AMF~ and the partial native security context that is created if the
authentication is successful. This message shall also include the ABBA
parameter. In this release of specification, the network shall set the length
of ABBA IE to 2 and the ABBA contents to be 2 octets in length with value
0000H as described in subclause 9.11.3.10.
If an ngKSI is contained in an initial NAS message during a 5GMM procedure,
the network shall include a different ngKSI value in the AUTHENTICATION
REQUEST message when it initiates a 5G AKA based primary authentication and
key agreement procedure.
Figure 5.4.1.3.2.1: 5G AKA based primary authentication and key agreement
procedure
##### 5.4.1.3.3 Authentication response by the UE
The UE shall respond to an AUTHENTICATION REQUEST message. With the exception
of the cases described in subclause 5.4.1.3.6 and 5.4.1.3.7 case l, the UE
shall process the 5G authentication challenge data and respond with an
AUTHENTICATION RESPONSE message to the network.
Upon a successful 5G authentication challenge, the UE shall determine the PLMN
identity to be used for the calculation of the new K~AMF~ from the 5G
authentication challenge data according to the following rules:
a) When the UE moves from 5GMM-IDLE mode to 5GMM-CONNECTED mode, until the
first handover, the UE shall use the PLMN identity of the selected PLMN; and
b) After handover or inter-system change to N1 mode in 5GMM-CONNECTED mode,
1) if the target cell is not a shared network cell, the UE shall use the PLMN
identity received as part of the broadcast system information;
2) if the target cell is a shared network cell and the UE has a valid 5G-GUTI,
the UE shall use the PLMN identity that is part of the 5G-GUTI; and
3) if the target cell is a shared network cell and the UE has a valid 4G-GUTI,
but not a valid 5G-GUTI, the UE shall use the PLMN identity that is part of
the 4G-GUTI.
Upon a successful 5G authentication challenge, the new K~AMF~ calculated from
the 5G authentication challenge data shall be stored in a new 5G NAS security
context in the volatile memory of the ME.
The USIM will compute the authentication response (RES) using the 5G
authentication challenge data received from the ME, and pass RES to the ME.
From the RES, RES* is then generated according to Annex A of 3GPP TS 33.501
[24].
In order to avoid a synchronisation failure, when the UE receives an
AUTHENTICATION REQUEST message, the UE shall store the received RAND together
with the RES*, in the volatile memory of the ME. When the UE receives a
subsequent AUTHENTICATION REQUEST message, if the stored RAND value is equal
to the new received value in the AUTHENTICATION REQUEST message, then the ME
shall not pass the RAND to the USIM, but shall send the AUTHENTICATION
RESPONSE message with the stored RES*. If there is no valid stored RAND in the
ME or the stored RAND is different from the new received value in the
AUTHENTICATION REQUEST message, the ME shall pass the RAND to the USIM, shall
override any previously stored RAND and RES* with the new ones and start, or
reset and restart timer T3516.
The RAND and RES* values stored in the ME shall be deleted and timer T3516, if
running, shall be stopped:
a) upon receipt of a
1) SECURITY MODE COMMAND message,
2) SERVICE REJECT message,
3) REGISTRATION REJECT message,
4) REGISTRATION ACCEPT message,
5) AUTHENTICATION REJECT message, or
6) SERVICE ACCEPT message;
b) upon expiry of timer T3516;
c) if the UE enters the 5GMM state 5GMM-DEREGISTERED or 5GMM-NULL; or
d) if the UE enters 5GMM-IDLE mode.
##### 5.4.1.3.4 Authentication completion by the network
Upon receipt of an AUTHENTICATION RESPONSE message, the network stops the
timer T3560 and checks the correctness of RES* (see 3GPP TS 33.501 [24]).
If the 5G AKA based primary authentication and key agreement procedure has
been completed successfully and the related ngKSI is stored in the 5G NAS
security context of the network, the network shall include a different ngKSI
value in the AUTHENTICATION REQUEST message when it initiates a new 5G AKA
based primary authentication and key agreement procedure.
Upon receipt of an AUTHENTICATION FAILURE message, the network stops the timer
T3560. In the case where the 5GMM cause #21 \"synch failure\" is received, the
core network may renegotiate with the UDM/AUSF and provide the UE with new
authentication parameters.
##### 5.4.1.3.5 Authentication not accepted by the network
If the authentication response (RES) returned by the UE is not valid, the
network response depends upon the type of identity used by the UE in the
initial NAS message, that is:
\- if the 5G-GUTI was used; or
\- if the SUCI was used.
If the 5G-GUTI was used, the network should initiate an identification
procedure to retrieve SUCI from the UE and restart the 5G AKA based primary
authentication and key agreement procedure with the received SUCI.
If the SUCI was used for identification in the initial NAS message or in a
restarted 5G AKA based primary authentication and key agreement procedure, or
the network decides not to initiate the identification procedure to retrieve
SUCI from the UE after an unsuccessful 5G AKA based primary authentication and
key agreement procedure, the network should send an AUTHENTICATION REJECT
message to the UE.
Upon receipt of an AUTHENTICATION REJECT message,
1) if the AUTHENTICATION REJECT message has been successfully integrity
checked by the NAS:
the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the
stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.
In case of PLMN, the USIM shall be considered invalid until switching off the
UE or the UICC containing the USIM is removed.
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE does not support access to an SNPN using credentials from a credentials
holder, the entry of the \"list of subscriber data\" with the SNPN identity of
the current SNPN shall be considered invalid until the UE is switched off or
the entry is updated. Additionally, the UE shall consider the USIM as invalid
for the current SNPN until switching off or the UICC containing the USIM is
removed.
In case of SNPN, if the UE is neither registered for onboarding services in
SNPN nor performing initial registration for onboarding services in SNPN and
the UE supports access to an SNPN using credentials from a credentials holder,
the UE shall consider the selected entry of the \"list of subscriber data\" as
invalid for 3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the entry until
switching off or the UICC containing the USIM is removed.
In case of SNPN, if the UE is registered for onboarding services in SNPN or is
performing initial registration for onboarding services in SNPN, the UE shall
store the SNPN identity in the \"permanently forbidden SNPNs\" list for
onboarding services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an
SNPN selection or an SNPN selection for onboarding services according to 3GPP
TS 23.122 [5]; and
\- if the UE is neither registered for onboarding services in SNPN nor
performing initial registration for onboarding services in SNPN, the UE shall
set:
i) the counter for \"SIM/USIM considered invalid for GPRS services\" events,
the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events, and the counter for \"SIM/USIM considered invalid for non-
GPRS services\" events if maintained by the UE, in case of PLMN; or
ii) the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events in case of SNPN;
to UE implementation-specific maximum value.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall set the SNPN-
specific attempt counter for the current SNPN to the UE implementation-
specific maximum value; and
\- if the UE is operating in single-registration mode, the UE shall handle EMM
parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the authentication
procedure is not accepted by the network. The USIM shall be considered as
invalid also for non-EPS services until switching off or the UICC containing
the USIM is removed; and
2) if the AUTHENTICATION REJECT message is received without integrity
protection and if timer T3516 or T3520 is running, the UE shall start timer
T3247 with a random value uniformly drawn from the range between 30 minutes
and 60 minutes, if the timer is not running (see subclause 5.3.20).
Additionally, if the UE is neither registered for onboarding services in SNPN
nor performing initial registration for onboarding services in SNPN, the UE
shall:
a) if the AUTHENTICATION REJECT message is received over 3GPP access, and the
counter for \"SIM/USIM considered invalid for GPRS services\" events in case
of PLMN or the counter for \"the entry for the current SNPN considered invalid
for 3GPP access\" events in case of SNPN has a value less than a UE
implementation-specific maximum value, proceed as specified in subclause
5.3.20, list item 1)-a) of subclause 5.3.20.2 (if the UE is not operating in
SNPN access operation mode) or list item a)-1) of subclause 5.3.20.3 (if the
UE is operating in SNPN access operation mode) for the case that the 5GMM
cause value received is #3;
b) if the AUTHENTICATION REJECT message is received over non-3GPP access, and
the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events in case of PLMN or the counter for \"the entry for the current
SNPN considered invalid for non-3GPP access\" events in case of SNPN has a
value less than a UE implementation-specific maximum value, proceed as
specified in subclause 5.3.20, list item 1)-b) of subclause 5.3.20.2 (if the
UE is not operating in SNPN access operation mode) or list item a)-2) of
subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for
the case that the 5GMM cause value received is #3.
c) otherwise:
i) if the AUTHENTICATION REJECT message is received over 3GPP access:
\- The UE shall set the update status for 3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI.
\- In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
via 3GPP access and non-EPS service until switching off the UE or the UICC
containing the USIM is removed.
In case of SNPN, the UE shall consider the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN shall be considered invalid
for 3GPP access until the UE is switched off or the entry is updated.
Additionally, the UE shall consider the USIM as invalid for the current SNPN
via 3GPP access until switching off or the UICC containing the USIM is
removed.
\- The UE shall set:
\- the counter for \"SIM/USIM considered invalid for GPRS services\" events
and the counter for \"SIM/USIM considered invalid for non-GPRS services\"
events if maintained by the UE, in case of PLMN; or
\- the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events in case of SNPN;
to UE implementation-specific maximum value.
\- If the UE is operating in single-registration mode, the UE shall handle
4G-GUTI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case
when the authentication procedure is not accepted by the network. The USIM
shall be considered as invalid also for non-EPS services until switching off
or the UICC containing the USIM is removed; and
ii) if the AUTHENTICATION REJECT message is received over non-3GPP access:
\- the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT
ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last
visited registered TAI and ngKSI;
\- in case of PLMN, the UE shall consider the USIM as invalid for 5GS services
via non-3GPP access until switching off the UE or the UICC containing the USIM
is removed.
In case of SNPN, the UE shall consider the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN as invalid for non-3GPP
access until the UE is switched off or the entry is updated. Additionally, the
UE shall consider the USIM as invalid for the current SNPN and for non-3GPP
access until switching off or the UICC containing the USIM is removed; and
\- the UE shall set:
\- the counter for \"USIM considered invalid for 5GS services over non-3GPP
access\" events to UE implementation-specific maximum value in case of PLMN;
or
\- the counter for \"the entry for the current SNPN considered invalid for
non-3GPP access\" events to UE implementation-specific maximum value in case
of SNPN.
If the UE is registered for onboarding services in SNPN or performing initial
registration for onboarding services in SNPN, the UE shall:
1) if the SNPN-specific attempt counter for the SNPN sending the
AUTHENTICATION REJECT message has a value less than a UE implementation-
specific maximum value, increment the SNPN-specific attempt counter for the
SNPN; or
2) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED,
delete the stored 5G-GUTI, TAI list, last visited registered TAI, and ngKSI,
store the SNPN identity in the \"permanently forbidden SNPNs\" list for
onboarding services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an
SNPN selection or an SNPN selection for onboarding services according to 3GPP
TS 23.122 [5].
If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort
any 5GMM signalling procedure, stop any of the timers T3510, T3516, T3517,
T3519, T3520 or T3521 (if they were running), enter state 5GMM-DEREGISTERED
and delete any stored SUCI.
Depending on local requirements or operator preference for emergency services,
if the UE initiates a registration procedure with 5GS registration type IE set
to \"emergency registration\" and the AMF is configured to allow emergency
registration without user identity, the AMF needs not follow the procedures
specified for the authentication failure in the present subclause. The AMF may
continue a current 5GMM specific procedure.
##### 5.4.1.3.6 Authentication not accepted by the UE
In the 5G authentication challenge, the UE shall check the 5G authentication
challenge data (RAND, AUTN and ngKSI) received in the AUTHENTICATION REQUEST
message to verify authenticity of the 5G core network.
The ME shall check that ngKSI received in the AUTHENTICATION REQUEST message
is not already in use. The ME shall forward the RAND and AUTN to the USIM to
check.
The UE may reject the core network due to an incorrect AUTN or ngKSI
parameter. If the UE has to reject the 5G authentication challenge, the UE
shall return AUTHENTICATION FAILURE message to the network with a cause value
indicating the reason for the failure (see 3GPP TS 33.501 [24]).
Incorrect 5G authentication challenge data contains four possible causes for
authentication failure:
a) MAC code failure:
If the UE finds the MAC code (supplied by the core network in the AUTN
parameter) to be invalid, the UE shall send an AUTHENTICATION FAILURE message
to the network, with the 5GMM cause #20 \"MAC failure\". The UE shall then
follow the procedure described in subclause 5.4.1.3.7, item c.
b) Non-5G authentication unacceptable:
If the UE finds that the \"separation bit\" in the AMF field of AUTN supplied
by the core network is set to 0, the UE shall send an AUTHENTICATION FAILURE
message to the network, with the 5GMM cause #26 \"non-5G authentication
unacceptable\" (see subclause 6.1.3 in 3GPP TS 33.501 [24]). The UE shall then
follow the procedure described in subclause 5.4.1.3.7, item d.
c) ngKSI already in use:
If the UE detects that ngKSI received in the AUTHENTICATION REQUEST message is
already in use in the UE shall send an AUTHENTICATION FAILURE message to the
network, with the 5GMM cause #71 \"ngKSI already in use\". The UE shall then
follow the procedure described in subclause 5.4.1.3.7, item e.
d) SQN failure:
If the UE finds the sequence number SQN (supplied by the core network in the
AUTN parameter) to be out of range, the UE shall send an AUTHENTICATION
FAILURE message to the network, with the 5GMM cause #21 \"synch failure\" and
a re-synchronization token AUTS provided by the USIM (see 3GPP TS 33.102
[23]). The UE shall then follow the procedure described in subclause
5.4.1.3.7, item f.
If the UE returns an AUTHENTICATION FAILURE message to the network, the UE
shall delete any previously stored RAND and RES* and shall stop timer T3516,
if running.
If the UE has an emergency PDU session established or is establishing such a
PDU session, additional UE requirements are specified in subclause 5.4.1.3.7,
under \"for items c, d, e and f\".
##### 5.4.1.3.7 Abnormal cases
a) Lower layer failure.
Upon detection of lower layer failure before the AUTHENTICATION RESPONSE
message is received, the network shall abort the procedure.
b) Expiry of timer T3560.
The network shall, on the first expiry of the timer T3560, retransmit the
AUTHENTICATION REQUEST message and shall reset and start timer T3560. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3560, the network shall abort the 5G AKA based primary authentication and key
agreement procedure and any ongoing 5GMM specific procedure and release the N1
NAS signalling connection.
c) Authentication failure (5GMM cause #20 \"MAC failure\").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #20 \"MAC
failure\" according to subclause 5.4.1.3.6, to the network and start timer
T3520 (see example in figure 5.4.1.3.7.1). Furthermore, the UE shall stop any
of the retransmission timers that are running (e.g. T3510, T3517 or T3521).
Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with
5GMM cause #20 \"MAC failure\", the network may initiate the identification
procedure described in subclause 5.4.3. This is to allow the network to obtain
the SUCI from the UE. The network may then check that the 5G-GUTI originally
used in the 5G authentication challenge corresponded to the correct SUPI. Upon
receipt of the IDENTITY REQUEST message from the network, the UE shall proceed
as specified in subclause 5.4.3.3.
NOTE 1: Upon receipt of an AUTHENTICATION FAILURE message from the UE with
5GMM cause #20 \"MAC failure\", the network may also terminate the 5G AKA
based primary authentication and key agreement procedure (see subclause
5.4.1.3.5).
If the mapping of 5G-GUTI to SUPI in the network was incorrect, the network
should respond by sending a new AUTHENTICATION REQUEST message to the UE. Upon
receiving the new AUTHENTICATION REQUEST message from the network, the UE
shall stop the timer T3520, if running, and then process the 5G challenge
information as normal. If the mapping of 5G-GUTI to SUPI in the network was
correct, the network should terminate the 5G AKA based primary authentication
and key agreement procedure by sending an AUTHENTICATION REJECT message (see
subclause 5.4.1.3.5).
If the network is validated successfully (an AUTHENTICATION REQUEST message
that contains a valid SQN and MAC is received), the UE shall send the
AUTHENTICATION RESPONSE message to the network and shall start any
retransmission timers (e.g. T3510, T3517 or T3521) if they were running and
stopped when the UE received the first failed AUTHENTICATION REQUEST message.
If the UE receives the second AUTHENTICATION REQUEST message, and the MAC
value cannot be resolved, the UE shall follow the procedure specified in this
subclause, item c, starting again from the beginning, or if the message
contains a UMTS authentication challenge, the UE shall follow the procedure
specified in item d. If the SQN is invalid, the UE shall proceed as specified
in item f.
Figure 5.4.1.3.7.1: Authentication failure during 5G AKA based primary
authentication and key agreement procedure
d) Authentication failure (5GMM cause #26 \"non-5G authentication
unacceptable\").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #26
\"non-5G authentication unacceptable\", to the network and start the timer
T3520 (see example in figure 5.4.1.3.7.1). Furthermore, the UE shall stop any
of the retransmission timers that are running (e.g. T3510, T3517 or T3521).
Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with
5GMM cause #26 \"non-5G authentication unacceptable\", the network may
initiate the identification procedure described in subclause 5.4.3. This is to
allow the network to obtain the SUCI from the UE. The network may then check
that the 5G-GUTI originally used in the 5G authentication challenge
corresponded to the correct SUPI. Upon receipt of the IDENTITY REQUEST message
from the network, the UE shall proceed as specified in subclause 5.4.3.3.
NOTE 2: Upon receipt of an AUTHENTICATION FAILURE message from the UE with
5GMM cause #26 \"non-5G authentication unacceptable\", the network may also
terminate the 5G AKA based primary authentication and key agreement procedure
(see subclause 5.4.1.3.5).
If the mapping of 5G-GUTI to SUPI in the network was incorrect, the network
should respond by sending a new AUTHENTICATION REQUEST message to the UE. Upon
receiving the new AUTHENTICATION REQUEST message from the network, the UE
shall stop the timer T3520, if running, and then process the 5G challenge
information as normal. If the mapping of 5G-GUTI to SUPI in the network was
correct, the network should terminate the 5G AKA based primary authentication
and key agreement authentication procedure by sending an AUTHENTICATION REJECT
message (see subclause 5.4.1.3.5).
If the network is validated successfully (an AUTHENTICATION REQUEST message
that contains a valid 5G authentication challenge is received), the UE shall
send the AUTHENTICATION RESPONSE message to the network and shall start any
retransmission timers (e.g. T3510, T3517 or T3521) if they were running and
stopped when the UE received the first failed AUTHENTICATION REQUEST message.
e) Authentication failure (5GMM cause #71 \"ngKSI already in use\").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #71
\"ngKSI already in use\", to the network and start the timer T3520 (see
example in figure 5.4.1.3.7.1). Furthermore, the UE shall stop any of the
retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon the
first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause
#71 \"ngKSI already in use\", the network performs necessary actions to select
a new ngKSI and send the same 5G authentication challenge to the UE.
NOTE 3: Upon receipt of an AUTHENTICATION FAILURE message from the UE with
5GMM cause #71 \"ngKSI already in use\", the network may also re-initiate the
5G AKA based primary authentication and key agreement procedure (see subclause
5.4.1.3.2).
Upon receiving the new AUTHENTICATION REQUEST message from the network, the UE
shall stop the timer T3520, if running, and then process the 5G challenge
information as normal.
If the network is validated successfully (an AUTHENTICATION REQUEST message
that contains a valid ngKSI, SQN and MAC is received), the UE shall send the
AUTHENTICATION RESPONSE message to the network and shall start any
retransmission timers (e.g. T3510, T3517 or T3521) if they were running and
stopped when the UE received the first failed AUTHENTICATION REQUEST message.
f) Authentication failure (5GMM cause #21 \"synch failure\").
The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #21
\"synch failure\", to the network and start the timer T3520 (see example in
figure 5.4.1.3.7.1). Furthermore, the UE shall stop any of the retransmission
timers that are running (e.g. T3510, T3517 or T3521). Upon the first receipt
of an AUTHENTICATION FAILURE message from the UE with the 5GMM cause #21
\"synch failure\", the network shall use the returned AUTS parameter from the
authentication failure parameter IE in the AUTHENTICATION FAILURE message, to
re-synchronise. The re-synchronisation procedure requires the AMF to delete
all unused authentication vectors for that SUPI and obtain new vectors from
the UDM/AUSF. When re-synchronisation is complete, the network shall initiate
the 5G AKA based primary authentication and key agreement procedure. Upon
receipt of the AUTHENTICATION REQUEST message, the UE shall stop the timer
T3520, if running.
NOTE 4: Upon receipt of two consecutive AUTHENTICATION FAILURE messages from
the UE with 5GMM cause #21 \"synch failure\", the network may terminate the 5G
AKA based primary authentication and key agreement procedure by sending an
AUTHENTICATION REJECT message.
If the network is validated successfully (a new AUTHENTICATION REQUEST message
is received which contains a valid SQN and MAC) while T3520 is running, the UE
shall send the AUTHENTICATION RESPONSE message to the network and shall start
any retransmission timers (e.g. T3510, T3517 or T3521), if they were running
and stopped when the UE received the first failed AUTHENTICATION REQUEST
message.
Upon receipt of an AUTHENTICATION REJECT message, the UE shall perform the
actions as specified in subclause 5.4.1.3.5.
g) Network failing the authentication check.
If the UE deems that the network has failed the authentication check, then it
shall request RRC to locally release the RRC connection and treat the active
cell as barred (see 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C]). The UE shall
start any retransmission timers (e.g. T3510, T3517 or T3521), if they were
running and stopped when the UE received the first AUTHENTICATION REQUEST
message containing an incorrect authentication challenge data causing
authentication failure.
h) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION
FAILURE message indication from lower layers (if the 5G AKA based primary
authentication and key agreement procedure is triggered by a registration
procedure).
The UE shall stop the timer T3520, if running, and re-initiate the
registration procedure.
i) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION
FAILURE message indication with change in the current TAI (if the 5G AKA based
primary authentication and key agreement procedure is triggered by a service
request procedure).
The UE shall stop the timer T3520, if running.
If the current TAI is not in the TAI list, the 5G AKA based primary
authentication and key agreement procedure shall be aborted and a registration
procedure for mobility and periodic registration update shall be initiated.
If the current TAI is still part of the TAI list, it is up to the UE
implementation how to re-run the ongoing procedure that triggered the 5G AKA
based primary authentication and key agreement procedure.
j) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION
FAILURE message indication without change in the current TAI (if the
authentication procedure is triggered by a service request procedure).
The UE shall stop the timer T3520, if running. It is up to the UE
implementation how to re-run the ongoing procedure that triggered the 5G AKA
based primary authentication and key agreement procedure.
k) Lower layers indication of non-delivered NAS PDU due to handover.
If the AUTHENTICATION REQUEST message could not be delivered due to an intra
AMF handover and the target TA is included in the TAI list, then upon
successful completion of the intra AMF handover the AMF shall retransmit the
AUTHENTICATION REQUEST message. If a failure of handover procedure is reported
by the lower layer and the N1 NAS signalling connection exists, the AMF shall
retransmit the AUTHENTICATION REQUEST message.
l) Change in the current TAI.
If the current TAI is not in the TAI list before the AUTHENTICATION RESPONSE
message is sent, the UE may discard sending the AUTHENTICATION RESPONSE
message to the network and continue with the initiation of the registration
procedure for mobility and periodic registration as described in subclause
5.5.1.3.2.
m) AUTHENTICATION REJECT message is received without integrity protection and
neither timer T3516 nor T3520 is running.
If an AUTHENTICATION REJECT message is received without integrity protection
and if neither timer T3516 nor T3520 is running, then the UE shall discard the
AUTHENTICATION REJECT message. Additionally, the UE may request RRC to locally
release the RRC connection and treat the active cell as barred (see 3GPP TS
38.304 [28] or 3GPP TS 36.304 [25C]).
For items c, d, e, and f if no emergency service is started or is ongoing:
The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-
IDLE mode, e.g. upon detection of a lower layer failure, release of the N1 NAS
signalling connection, or as the result of an inter-system change in 5GMM-
CONNECTED mode from N1 mode to S1 mode.
The UE shall deem that the network has failed the authentication check or
assume that the authentication is not genuine and proceed as described in item
g above if any of the following occurs:
\- the timer T3520 expires;
\- the UE detects any combination of the 5G authentication failures: 5GMM
causes #20 \"MAC failure\", #21 \"synch failure\", #26 \"non-5G authentication
unacceptable\" or #71 \"ngKSI already in use\", during three consecutive
authentication challenges. The 5G authentication challenges shall be
considered as consecutive only, if the 5G authentication challenges causing
the second and third 5G authentication failure are received by the UE, while
the timer T3520 started after the previous 5G authentication failure is
running.
For items c, d, e, and f if there is an emergency service started or is
ongoing:
The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-
IDLE mode, e.g. upon detection of a lower layer failure, release of the N1 NAS
signalling connection, or as the result of an inter-system change in 5GMM-
CONNECTED mode from N1 mode to S1 mode.
If there is an ongoing service request procedure for emergency services
fallback the UE shall abort the service request procedure, stop timer T3517
and locally release any resources allocated for the service request procedure
and enters state 5GMM-REGISTERED. The UE shall attempt to select an E-UTRA
cell connected to EPC or 5GCN according to the domain priority and selection
rules specified in 3GPP TS 23.167 [6]. If the UE finds a suitable E-UTRA cell,
it then proceeds with the appropriate EMM or 5GMM procedures. If the UE
operating in single-registration mode has changed to S1 mode, it shall disable
the N1 mode capability for 3GPP access.
Depending on local requirements or operator preference for emergency services,
if the UE has an emergency PDU session established or is establishing an
emergency PDU session, the AMF need not follow the procedures specified for
the authentication failure specified in the present subclause. The AMF may
respond to the AUTHENTICATION FAILURE message by initiating the security mode
control procedure selecting the \"null integrity protection algorithm\"
5G-IA0, \"null ciphering algorithm\" 5G-EA0 or may abort the 5G AKA based
primary authentication and key agreement procedure and continue using the
current security context, if any. The AMF shall indicate to the SMF to perform
the release of all non-emergency PDU sessions, if any. If there is an ongoing
PDU session establishment procedure, the AMF shall indicate to the SMF to
perform the release of all non-emergency PDU sessions upon completion of the
PDU session establishment procedure. The network shall behave as if the UE is
registered for emergency services.
If a UE has an emergency PDU session established or is establishing an
emergency PDU session and sends an AUTHENTICATION FAILURE message to the AMF
with the 5GMM cause appropriate for these cases (#20, #21, #26, or #71
respectively) and receives the SECURITY MODE COMMAND message before the
timeout of timer T3520, the UE shall deem that the network has passed the
authentication check successfully, stop timer T3520, respectively, and execute
the security mode control procedure.
If a UE has an emergency PDU session established or is establishing an
emergency PDU session when timer T3520 expires, the UE shall not deem that the
network has failed the authentication check and not behave as described in
item g. Instead the UE shall continue using the current security context, if
any, release all non-emergency PDU sessions, if any, by initiating UE-
requested PDU session release procedure. If there is an ongoing PDU session
establishment procedure, the UE shall release all non-emergency PDU sessions
upon completion of the PDU session establishment procedure.
The UE shall start any retransmission timers (e.g. T3510, T3517 or T3521) if:
\- they were running and stopped when the UE received the AUTHENTICATION
REQUEST message and detected an authentication failure; and
\- the procedures associated with these timers have not yet been completed.
The UE shall behave as if the UE is registered for emergency services.
### 5.4.2 Security mode control procedure
#### 5.4.2.1 General
The purpose of the NAS security mode control procedure is to take a 5G NAS
security context into use, and initialise and start NAS signalling security
between the UE and the AMF with the corresponding 5G NAS keys and 5G NAS
security algorithms.
Furthermore, the network may also initiate the security mode control procedure
in the following cases:
a)- in order to change the 5G NAS security algorithms for a current 5G NAS
security context already in use;
b) in order to change the value of uplink NAS COUNT used in the latest
SECURITY MODE COMPLETE message as described in 3GPP TS 33.501 [24], subclause
6.9.4.4; and
c) in order to provide the Selected EPS NAS security algorithms to the UE.
For restrictions concerning the concurrent running of a security mode control
procedure with other security related procedures in the AS or inside the core
network see 3GPP TS 33.501 [24], subclause 6.9.5.
If the security mode control procedure is initiated after successful 5G AKA
based primary authentication and key agreement procedure and the security mode
control procedure intends to bring into use the partial native 5G NAS security
context created by the 5G AKA based primary authentication and key agreement
procedure and the UE accept received security mode command (see subclause
5.4.2.3), the ME shall:
a) delete the valid K~AUSF~ and the valid K~SEAF~, if any; and
b) consider the new K~AUSF~ to be the valid K~AUSF~, and the new K~SEAF~ to be
the valid K~SEAF~, reset the SOR counter and the UE parameter update counter
to zero, and store the valid K~AUSF,~ the valid K~SEAF~ , the SOR counter and
the UE parameter update counter as specified in annex C and use the valid
K~AUSF~ in the verification of SOR transparent container and UE parameters
update transparent container, if any are received.
NOTE: The AMF does not perform a security mode control procedure when the 5G
AKA based primary authentication procedure successfully authenticates a 5G
ProSe layer-3 remote UE accessing the network via a 5G ProSe layer-3 UE-to-
network relay UE served by the AMF.
#### 5.4.2.2 NAS security mode control initiation by the network
The AMF initiates the NAS security mode control procedure by sending a
SECURITY MODE COMMAND message to the UE and starting timer T3560 (see example
in figure 5.4.2.2).
The AMF shall reset the downlink NAS COUNT counter and use it to integrity
protect the initial SECURITY MODE COMMAND message if the security mode control
procedure is initiated:
a) to take into use the security context created after a successful execution
of the 5G AKA based primary authentication and key agreement procedure or the
EAP based primary authentication and key agreement procedure; or
b) upon receipt of REGISTRATION REQUEST message, if the AMF needs to create a
mapped 5G NAS security context (i.e. the type of security context flag is set
to \"mapped security context\" in the ngKSI IE included in the SECURITY MODE
COMMAND message).
The AMF shall send the SECURITY MODE COMMAND message unciphered, but shall
integrity protect the message with the 5G NAS integrity key based on K~AMF~ or
mapped K\'~AMF~ indicated by the ngKSI included in the message. The AMF shall
set the security header type of the message to \"integrity protected with new
5G NAS security context\".
The AMF shall create a locally generated K~AMF~ and send the SECURITY MODE
COMMAND message including an ngKSI value in the ngKSI IE set to \"000\" and
5G-IA0 and 5G-EA0 as the selected NAS security algorithms only when the
security mode control procedure is initiated:
a) during an initial registration procedure for emergency services if no valid
5G NAS security context is available;
b) during a registration procedure for mobility and periodic registration
update for a UE that has an emergency PDU session if no valid 5G NAS security
context is available;
c) during a service request procedure for a UE that has an emergency PDU
session if no valid 5G NAS security context is available; or
d) after a failed primary authentication and key agreement procedure for a UE
that has an emergency PDU session or is establishing an emergency PDU session,
if continued usage of a valid 5G NAS security context is not possible.
When the AMF sends the SECURITY MODE COMMAND message including an ngKSI value
in the ngKSI IE set to \"000\" and 5G-IA0 and 5G-EA0 as the selected NAS
security algorithms, if:
a) the AMF supports N26 interface;
b) the UE set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability
IE of the REGISTRATION REQUEST message; and
c) the security mode control procedure is initiated during an initial
registration procedure for emergency services, during a registration procedure
for mobility and periodic registration update for a UE that has an emergency
PDU session, or during a service request procedure for a UE that has an
emergency PDU session,
the SECURITY MODE COMMAND message shall also include the Selected EPS NAS
security algorithms IE. The selected EPS NAS security algorithms shall be set
to EIA0 and EEA0.
The UE shall process a SECURITY MODE COMMAND message including an ngKSI value
in the ngKSI IE set to \"000\" and 5G-IA0 and 5G-EA0 as the selected NAS
security algorithms and, if accepted, create a locally generated K~AMF~ when
the security mode control procedure is initiated:
a) during an initial registration procedure for emergency services;
b) during a registration procedure for mobility and periodic registration
update for a UE that has an emergency PDU session;
c) during a service request procedure for a UE that has an emergency PDU
session; or
d) after a primary authentication and key agreement procedure for a UE that
has an emergency PDU session or is establishing an emergency PDU session.
NOTE 1: The process for creation of the locally generated K~AMF~ by the AMF
and the UE is implementation dependent. The K~AMF~ is specified in 3GPP TS
33.501 [24].
Upon receipt of a REGISTRATION REQUEST message, if the AMF does not have the
valid current 5G NAS security context indicated by the UE, the AMF shall
either:
a) indicate the use of the new mapped 5G NAS security context to the UE by
setting the type of security context flag in the ngKSI IE to \"mapped security
context\" and the KSI value related to the security context of the source
system; or
b) set the ngKSI value to \"000\" in the ngKSI IE if the AMF sets 5G-IA0 and
5G-EA0 as the selected NAS security algorithms for a UE that has an emergency
PDU session.
Upon receipt of a REGISTRATION REQUEST message, if the AMF has the valid
current 5G NAS security context indicated by the UE, the AMF supports N26
interface and the UE set the S1 mode bit to \"S1 mode supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message and the UE is not registered
for disaster roaming services, the AMF shall check whether the selected EPS
NAS security algorithms was successfully provided to the UE. If not, the AMF
shall initiate the NAS security mode control procedure by sending a SECURITY
MODE COMMAND message with the Selected EPS NAS security algorithms IE to the
UE.
While having a current mapped 5G NAS security context with the UE, if the AMF
needs to take the native 5G NAS security context into use, the AMF shall
include the ngKSI that indicates the native 5G NAS security context in the
SECURITY MODE COMMAND message.
The AMF shall include the replayed security capabilities of the UE (including
the security capabilities with regard to NAS, RRC and UP (user plane)
ciphering as well as NAS and RRC integrity, and other possible target network
security capabilities, i.e. E-UTRAN if the UE included them in the message to
network), the selected 5GS ciphering and integrity algorithms and the ngKSI.
If a UE is already registered over one access to a PLMN and the AMF decides to
skip primary authentication and key agreement procedure when the UE attempts
to register over the other access to the same PLMN, the AMF shall take into
use the UE\'s current 5G NAS security context over the other access that the
UE is registering. In this case, SECURITY MODE COMMAND message is not sent to
the UE.
If the UE is registered to the same AMF and the same PLMN over both 3GPP
access and non-3GPP access, and the UE is in 5GMM-CONNECTED mode over both the
3GPP and non-3GPP accesses, then at any time the primary authentication and
key agreement procedure has successfully completed over:
a) the 3GPP access, the AMF includes the ngKSI in the SECURITY MODE COMMAND
message over the 3GPP access. When the AMF sends the SECURITY MODE COMMAND
message to UE over the non-3GPP access to take into use the new 5G NAS
security context, the AMF shall include the same ngKSI in the SECURITY MODE
COMMAND message to identify the new 5G NAS security context; or
b) the non-3GPP access, the AMF includes the ngKSI in the SECURITY MODE
COMMAND message over the non-3GPP access. When the AMF sends the SECURITY MODE
COMMAND message to UE over the 3GPP access to take into use the new 5G NAS
security context, the AMF shall include the same ngKSI in the SECURITY MODE
COMMAND message to identify the new 5G NAS security context.
The AMF may initiate a SECURITY MODE COMMAND in order to change the 5G
security algorithms for a current 5G NAS security context already in use. The
AMF re-derives the 5G NAS keys from K~AMF~ with the new 5G algorithm
identities as input and provides the new 5GS algorithm identities within the
SECURITY MODE COMMAND message. The AMF shall set the security header type of
the message to \"integrity protected with new 5G NAS security context\".
If, during an ongoing registration procedure, the AMF is initiating a SECURITY
MODE COMMAND (i.e. after receiving the REGISTRATION REQUEST message, but
before sending a response to that message) and:
a) the REGISTRATION REQUEST message does not successfully pass the integrity
check at the AMF; or
b) the AMF can not decipher the value part of the NAS message container IE in
the REGISTRATION REQUEST message;
the AMF shall include the Additional 5G security information IE with the RINMR
bit set to \"Retransmission of the initial NAS message requested\" in the
SECURITY MODE COMMAND message requesting the UE to send the entire
REGISTRATION REQUEST message in the SECURITY MODE COMPLETE message as
described in 3GPP TS 33.501 [24].
NOTE 2: The AMF uses the UE security capability which was provided by the UE.
If, during an ongoing service request procedure for a UE with an emergency PDU
session, the AMF is initiating a SECURITY MODE COMMAND (i.e. after receiving
the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message, but
before sending a response to that message) and the SERVICE REQUEST message or
the CONTROL PLANE SERVICE REQUEST message does not successfully pass the
integrity check at the AMF, the AMF shall include the Additional 5G security
information IE with the RINMR bit set to \"Retransmission of the initial NAS
message requested\" in the SECURITY MODE COMMAND message requesting the UE to
send the entire:
a) SERVICE REQUEST message; or
b) CONTROL PLANE SERVICE REQUEST message excluding non-cleartext IEs, except
the Uplink data status IE if needed (see subclause 5.4.2.3);
in the SECURITY MODE COMPLETE message as described in 3GPP TS 33.501 [24].
Additionally, the AMF may request the UE to include its IMEISV in the SECURITY
MODE COMPLETE message.
If the AMF supports N26 interface and the UE set the S1 mode bit to \"S1 mode
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message and
the AMF needs to provide the selected EPS NAS security algorithms to the UE,
the AMF shall select ciphering and integrity algorithms to be used in the EPS
and indicate them to the UE via the Selected EPS NAS security algorithms IE in
the SECURITY MODE COMMAND message.
NOTE 3: The AS and NAS security capabilities are the same, i.e. if the UE
supports one algorithm for NAS, the same algorithm is also supported for AS.
If the AMF performs horizontal key derivation e.g. during the mobility and
periodic registration update or when the UE is already registered in the PLMN
with another access type as described in 3GPP TS 33.501 [24], the AMF shall
include horizontal derivation parameter in the SECURITY MODE COMMAND message.
If the security mode control procedure is initiated after successful EAP based
primary authentication and key agreement procedure and the security mode
control procedure intends to bring into use the partial native 5G NAS security
context created by the EAP based primary authentication and key agreement
procedure, the AMF shall set the EAP message IE of the SECURITY MODE COMMAND
message to an EAP-success message to be sent to the UE.
Figure 5.4.2.2: Security mode control procedure
#### 5.4.2.3 NAS security mode command accepted by the UE
Upon receipt of the SECURITY MODE COMMAND message, the UE shall check whether
the security mode command can be accepted or not. This is done by performing
the integrity check of the message, and by checking that the received Replayed
UE security capabilities IE has not been altered compared to the latest values
that the UE sent to the network.
When the SECURITY MODE COMMAND message includes an EAP-success message the UE
handles the EAP-success message and the ABBA as described in subclause
5.4.1.2.2.8, 5.4.1.2.3.1, 5.4.1.2.3A.1 and 5.4.1.2.3B.1.
If:
a) the UE is registered for emergency services, performing initial
registration for emergency services, establishing an emergency PDU session or
has an emergency PDU session established;
b) the W-AGF acts on behalf of the FN-RG; or
c) the W-AGF acts on behalf of the N5GC device,
and the SECURITY MODE COMMAND message is received with ngKSI value \"000\" and
5G-IA0 and 5G-EA0 as selected 5G NAS security algorithms, the UE shall locally
derive and take in use 5G NAS security context. The UE shall delete existing
current 5G NAS security context.
The UE shall accept a SECURITY MODE COMMAND message indicating the \"null
integrity protection algorithm\" 5G-IA0 as the selected 5G NAS integrity
algorithm only if the message is received when
a) the UE is registered for emergency services, performing initial
registration for emergency services, establishing an emergency PDU session or
has an emergency PDU session established; or
b) the W-AGF acts on behalf of the FN-RG; or
c) the W-AGF acts on behalf of the N5GC device.
If the type of security context flag included in the SECURITY MODE COMMAND
message is set to \"native security context\" and if the ngKSI matches a valid
non-current native 5G NAS security context held in the UE while the UE has a
mapped 5G NAS security context as the current 5G NAS security context, the UE
shall take the non-current native 5G NAS security context into use which then
becomes the current native 5G NAS security context and delete the mapped 5G
NAS security context.
The UE shall ignore the Replayed S1 UE security capabilities IE if this IE is
included in the SECURITY MODE COMMAND message.
If the SECURITY MODE COMMAND message can be accepted, the UE shall take the 5G
NAS security context indicated in the message into use. The UE shall in
addition reset the uplink NAS COUNT counter if:
a) the SECURITY MODE COMMAND message is received in order to take a 5G NAS
security context into use created after a successful execution of the 5G AKA
based primary authentication and key agreement procedure or the EAP based
primary authentication and key agreement procedure; or
b) the SECURITY MODE COMMAND message received includes the type of security
context flag set to \"mapped security context\" in the NAS key set identifier
IE the ngKSI does not match the current 5G NAS security context, if it is a
mapped 5G NAS security context.
If the SECURITY MODE COMMAND message can be accepted and a new 5G NAS security
context is taken into use and SECURITY MODE COMMAND message does not indicate
the \"null integrity protection algorithm\" 5G-IA0 as the selected NAS
integrity algorithm, the UE shall:
\- if the SECURITY MODE COMMAND message has been successfully integrity
checked using an estimated downlink NAS COUNT equal to 0, then the UE shall
set the downlink NAS COUNT of this new 5G NAS security context to 0;
\- otherwise the UE shall set the downlink NAS COUNT of this new 5G NAS
security context to the downlink NAS COUNT that has been used for the
successful integrity checking of the SECURITY MODE COMMAND message.
If the SECURITY MODE COMMAND message includes the horizontal derivation
parameter indicating \"K~AMF~ derivation is required\", the UE shall derive a
new K\'~AMF~, as specified in 3GPP TS 33.501 [24] for K~AMF~ to K\'~AMF~
derivation in mobility, and set both uplink and downlink NAS COUNTs to zero.
When the new 5G NAS security context is taken into use for current access and
the UE is registered with the same PLMN over the 3GPP access and the non-3GPP
access:
a) the UE is in 5GMM-IDLE mode over the non-current access, the AMF and the UE
shall activate the new 5G NAS security context over the non-current access as
described in 3GPP TS 33.501 [24]. The AMF and the UE shall set the downlink
NAS COUNT and uplink NAS COUNT to zero for the non-current access; or
b) the UE is in 5GMM-CONNECTED mode over the non-current access, the AMF shall
send the SECURITY MODE COMMAND message over the non-current access to activate
the new 5G NAS security context that was activated over the current access as
described in 3GPP TS 33.501 [24]. The AMF shall include the same ngKSI in the
SECURITY MODE COMMAND message to identify the new 5G NAS security context.
If the SECURITY MODE COMMAND message includes the horizontal derivation
parameter indicating \"K~AMF~ derivation is not required\" or the Additional
5G security information IE is not included in the message, the UE is
registered with the same PLMN over the 3GPP access and non-3GPP access, then
after the completion of a security mode control procedure over the current
access:
a) the UE is in 5GMM-IDLE mode over the non-current access, the AMF and the UE
shall activate the new 5G NAS security context for the non-current access. If
a primary authentication and key agreement procedure was completed before the
security mode control procedure, the AMF and the UE shall set the downlink NAS
COUNT and uplink NAS COUNT to zero for the non-current access, otherwise the
downlink NAS COUNT and uplink NAS COUNT for the non-3GPP access are not
changed; or
b) the UE is in 5GMM-CONNECTED mode over the non-current access, the AMF shall
send the SECURITY MODE COMMAND message over the non-current access to activate
the new 5G NAS security context that was activated over the current access as
described in 3GPP TS 33.501 [24]. The AMF shall include the same ngKSI in the
SECURITY MODE COMMAND message to identify the new 5G NAS security context.
If the SECURITY MODE COMMAND message can be accepted, the UE shall send a
SECURITY MODE COMPLETE message integrity protected with the selected 5GS
integrity algorithm and the 5G NAS integrity key based on the K~AMF~ or mapped
K\'~AMF~ if the type of security context flag is set to \"mapped security
context\" indicated by the ngKSI. When the SECURITY MODE COMMAND message
includes the type of security context flag set to \"mapped security context\"
in the NAS key set identifier IE, then the UE shall check whether the SECURITY
MODE COMMAND message indicates the ngKSI of the current 5GS security context,
if it is a mapped 5G NAS security context, in order not to re-generate the
K\'~AMF~.
Furthermore, if the SECURITY MODE COMMAND message can be accepted, the UE
shall cipher the SECURITY MODE COMPLETE message with the selected 5GS
ciphering algorithm and the 5GS NAS ciphering key based on the K~AMF~ or
mapped K\'~AMF~ indicated by the ngKSI. The UE shall set the security header
type of the message to \"integrity protected and ciphered with new 5G NAS
security context\".
From this time onward the UE shall cipher and integrity protect all NAS
signalling messages with the selected 5GS integrity and ciphering algorithms.
If the AMF indicated in the SECURITY MODE COMMAND message that the IMEISV is
requested and:
a) if the UE:
1) supports at least one 3GPP access technology, the UE shall include its
IMEISV in the IMEISV IE of the SECURITY MODE COMPLETE message; or
2) does not support any 3GPP access technology (i.e. satellite NG-RAN, NG-RAN,
satellite E-UTRAN, E-UTRAN, UTRAN or GERAN) and supports NAS over untrusted or
trusted non-3GPP access, the UE shall include its EUI-64 in the non-IMEISV PEI
IE of the SECURITY MODE COMPLETE message; or
b) if the 5G-RG contains neither an IMEISV nor an IMEI or when the W-AGF acts
on behalf of the FN-RG (or on behalf of the N5GC device), the 5G-RG or the
W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) shall
include the MAC address and the MAC address usage restriction indication
determined as specified in subclause 5.3.2 in the non-IMEISV PEI IE in the
SECURITY MODE COMPLETE message.
If during an ongoing registration procedure or service request procedure, the
UE receives a SECURITY MODE COMMAND message which includes the Additional 5G
security information IE with the RINMR bit set to \"Retransmission of the
initial NAS message requested\", the UE shall include the entire unciphered
REGISTRATION REQUEST message or SERVICE REQUEST message or CONTROL PLANE
SERVICE REQUEST message, which the UE had previously included in the NAS
message container IE of the initial NAS message (i.e. REGISTRATION REQUEST
message or SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message,
respectively), in the NAS message container IE of the SECURITY MODE COMPLETE
message. The retransmitted CONTROL PLANE SERVICE REQUEST message:
a) shall not include any non-cleartext IE, except the Uplink data status IE;
and
b) may include the Uplink data status IE.
If, prior to receiving the SECURITY MODE COMMAND message, the UE without a
valid 5G NAS security context had sent a REGISTRATION REQUEST message the UE
shall include the entire REGISTRATION REQUEST message in the NAS message
container IE of the SECURITY MODE COMPLETE message as described in subclause
4.4.6.
If the UE operating in the single-registration mode receives the Selected EPS
NAS security algorithms IE, the UE shall use the IE according to 3GPP TS
33.501 [24].
For a UE operating in single-registration mode in a network supporting N26
interface after an inter-system change from S1 mode to N1 mode in 5GMM-
CONNECTED mode, the UE shall set the value of the Selected EPS NAS security
algorithms IE in the 5G NAS security context to the NAS security algorithms
that were received from the source MME when the UE was in S1 mode.
#### 5.4.2.4 NAS security mode control completion by the network
The AMF shall, upon receipt of the SECURITY MODE COMPLETE message, stop timer
T3560. From this time onward the AMF shall integrity protect and encipher all
signalling messages with the selected 5GS integrity and ciphering algorithms.
If the SECURITY MODE COMPLETE message contains a NAS message container IE with
a REGISTRATION REQUEST message, the AMF shall complete the ongoing
registration procedure by considering the REGISTRATION REQUEST message
contained in the NAS message container IE as the message that triggered the
procedure.
If the SECURITY MODE COMPLETE message contains a NAS message container IE with
a REGISTRATION REQUEST message, the 5GMM capability IE included in the
REGISTRATION REQUEST message indicates \"S1 mode supported\" and the AMF
supports N26 interface, the AMF shall initiate another NAS security mode
control procedure in order to provide the selected EPS NAS security algorithms
to the UE as described in subclause 5.4.2.2. This second NAS security mode
control procedure should be initiated as part of 5GMM common procedures of the
ongoing registration procedure.
If the SECURITY MODE COMPLETE message contains a NAS message container IE with
a SERVICE REQUEST message, the AMF shall complete the ongoing service request
procedure by considering the SERVICE REQUEST message contained in the NAS
message container IE as the message that triggered the procedure.
If the SECURITY MODE COMPLETE message contains a NAS message container IE with
a CONTROL PLANE SERVICE REQUEST message, the AMF shall complete the ongoing
service request procedure by considering the CONTROL PLANE SERVICE REQUEST
message contained in the NAS message container IE as the message that
triggered the procedure.
#### 5.4.2.5 NAS security mode command not accepted by the UE
If the security mode command cannot be accepted, the UE shall send a SECURITY
MODE REJECT message. The SECURITY MODE REJECT message contains a 5GMM cause
that typically indicates one of the following cause values:
#23 UE security capabilities mismatch.
#24 security mode rejected, unspecified.
If the UE detects that the received Replayed UE security capabilities IE has
been altered compared to the latest values that the UE sent to the network,
the UE shall set the cause value to #23 \"UE security capabilities mismatch\".
Upon receipt of the SECURITY MODE REJECT message, the AMF shall stop timer
T3560. The AMF shall also abort the ongoing procedure that triggered the
initiation of the NAS security mode control procedure.
Both the UE and the AMF shall apply the 5G NAS security context in use before
the initiation of the security mode control procedure, if any, to protect the
SECURITY MODE REJECT message and any other subsequent messages according to
the rules in subclause 4.4.4 and 4.4.5.
#### 5.4.2.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Transmission failure of SECURITY MODE COMPLETE message or SECURITY MODE
REJECT message indication from lower layers (if the security mode control
procedure is triggered by a registration procedure).
The UE shall abort the security mode control procedure and re-initiate the
registration procedure.
b) Transmission failure of SECURITY MODE COMPLETE message or SECURITY MODE
REJECT message indication with change in the current TAI (if the security mode
control procedure is triggered by a service request procedure).
If the current TAI is not in the TAI list, the security mode control procedure
shall be aborted and a registration procedure shall be initiated.
If the current TAI is still part of the TAI list, the security mode control
procedure shall be aborted and it is up to the UE implementation how to re-run
the ongoing procedure that triggered the security mode control procedure.
c) Transmission failure of SECURITY MODE COMPLETE message or SECURITY MODE
REJECT message indication without change in the current TAI (if the security
mode control procedure is triggered by a service request procedure).
The security mode control procedure shall be aborted and it is up to the UE
implementation how to re-run the ongoing procedure that triggered the security
mode control procedure.
#### 5.4.2.7 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Lower layer failure before the SECURITY MODE COMPLETE or SECURITY MODE
REJECT message is received.
The network shall abort the security mode control procedure.
b) Expiry of timer T3560.
The network shall, on the first expiry of the timer T3560, retransmit the
SECURITY MODE COMMAND message and shall reset and start timer T3560. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3560, the procedure shall be aborted.
c) Collision between security mode control procedure and registration, service
request or de-registration procedure not indicating switch off.
The network shall abort the security mode control procedure and proceed with
the UE initiated procedure.
d) Collision between security mode control procedure and other 5GMM procedures
than in item c.
The network shall progress both procedures.
e) Lower layers indication of non-delivered NAS PDU due to handover:
If the SECURITY MODE COMMAND message could not be delivered due to an intra
AMF handover and the target TA is included in the TAI list, then upon
successful completion of the intra AMF handover the AMF shall retransmit the
SECURITY MODE COMMAND message. If a failure of the handover procedure is
reported by the lower layer and the N1 signalling connection exists, the AMF
shall retransmit the SECURITY MODE COMMAND message.
### 5.4.3 Identification procedure
#### 5.4.3.1 General
The purpose of this procedure is to request a particular UE to provide
specific identification parameters, e.g. the SUCI, the IMEI, the IMEISV, the
EUI-64 or the MAC address. The SUCI is a privacy preserving identifier
containing the concealed SUPI and the IMEI, the IMEISV, the EUI-64 and the MAC
address are formats of PEI.
#### 5.4.3.2 Identification initiation by the network
The AMF initiates the identification procedure by sending an IDENTITY REQUEST
message to the UE and starting timer T3570 (see example in figure 5.4.3.2.1).
The IDENTITY REQUEST message specifies the requested identification parameters
in the Identity type information element.
Figure 5.4.3.2.1: Identification procedure
#### 5.4.3.3 Identification response by the UE
A UE shall be ready to respond to an IDENTITY REQUEST message at any time
whilst in 5GMM-CONNECTED mode.
Upon receipt of the IDENTITY REQUEST message:
a) if the Identity type IE in the IDENTITY REQUEST message is not set to
\"SUCI\", the UE shall send an IDENTITY RESPONSE message to the network. The
IDENTITY RESPONSE message shall contain the identification parameters as
requested by the network; and
b) if the Identity type IE in the IDENTITY REQUEST message is set to \"SUCI\",
the UE shall:
1) if timer T3519 is not running, generate a fresh SUCI as specified in 3GPP
TS 33.501 [24], send an IDENTITY RESPONSE message with the SUCI, start timer
T3519 and store the value of the SUCI sent in the IDENTITY RESPONSE message;
and
2) if timer T3519 is running, send an IDENTITY RESPONSE message with the
stored SUCI.
#### 5.4.3.4 Identification completion by the network
Upon receipt of the IDENTITY RESPONSE the network shall stop the timer T3570.
#### 5.4.3.5 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Transmission failure of the IDENTITY RESPONSE message (if the
identification procedure is triggered by a registration procedure).
The UE shall re-initiate the registration procedure.
b) Requested identity is not available
If the UE cannot encode the requested identity in the IDENTITY RESPONSE
message, e.g. because no valid USIM is available, then it shall encode the
identity type as \"No identity\".
#### 5.4.3.6 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Lower layer failure.
Upon detection of a lower layer failure before the IDENTITY RESPONSE is
received, the network shall abort any ongoing 5GMM procedure.
b) Expiry of timer T3570.
The network shall, on the first expiry of the timer T3570, retransmit the
IDENTITY REQUEST message and reset and restart the timer T3570. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3570, the network shall abort the identification procedure and any ongoing
5GMM procedure.
c) Collision of an identification procedure with a registration procedure for
initial registration.
If the network receives a REGISTRATION REQUEST message indicating either
\"initial registration\" or \"emergency registration\" in the 5GS registration
type IE before the ongoing identification procedure has been completed and no
registration procedure is pending on the network (i.e. no REGISTRATION
ACCEPT/REJECT message has still to be sent as an answer to a REGISTRATION
REQUEST message), the network shall proceed with the registration procedure
for initial registration.
d) Collision of an identification procedure with a registration procedure for
initial registration when the identification procedure has been caused by a
registration procedure for initial registration.
If the network receives a REGISTRATION REQUEST message indicating either
\"initial registration\" or \"emergency registration\" in the 5GS registration
type IE before the ongoing identification procedure has been completed and a
registration procedure for initial registration is pending (i.e. a
REGISTRATION ACCEPT/REJECT message has to be sent as an answer to an earlier
REGISTRATION REQUEST message), then:
\- If one or more of the information elements in the REGISTRATION REQUEST
message differ from the ones received within the previous REGISTRATION REQUEST
message, the network shall proceed with the new registration procedure for
initial registration; or
\- If the information elements do not differ, then the network shall not treat
any further this new REGISTRATION REQUEST message.
e) Collision of an identification procedure with a registration procedure for
mobility and periodic registration update.
If the network receives a REGISTRATION REQUEST message indicating either
\"mobility registration updating\" or \"periodic registration updating\" in
the 5GS registration type IE before the ongoing identification procedure has
been completed, the network shall progress both procedures.
f) Collision of an identification procedure with a UE initiated de-
registration procedure.
If the network receives a DEREGISTRATION REQUEST message with \"switch off\"
indication in the De-registration type IE before the ongoing identification
procedure has been completed, the network shall abort the identification
procedure and shall progress the UE-initiated de-registration procedure;
Else the network shall complete the identification procedure and shall respond
to the UE-initiated de-registration procedure as described in subclause
5.5.2.2.
### 5.4.4 Generic UE configuration update procedure
#### 5.4.4.1 General
The purpose of this procedure is to:
a) allow the AMF to update the UE configuration for access and mobility
management-related parameters decided and provided by the AMF by providing new
parameter information within the command;
b) request the UE to perform a registration procedure for mobility and
periodic registration update towards the network to update access and mobility
management-related parameters decided and provided by the AMF (see subclause
5.5.1.3);
c) deliver the UAV authorization information to the UE, as described in 3GPP
TS 23.256 [6AB]; or
d) update the PEIPS assistance information in the UE (see subclause 5.3.25).
This procedure is initiated by the network and can only be used when the UE
has an established 5GMM context, and the UE is in 5GMM-CONNECTED mode. When
the UE is in 5GMM-IDLE mode, the AMF may use the paging or notification
procedure to initiate the generic UE configuration update procedure. The AMF
can request a confirmation response in order to ensure that the parameter has
been updated by the UE.
This procedure shall be initiated by the network to assign a new 5G-GUTI to
the UE after:
a) a successful service request procedure invoked as a response to a paging
request from the network and before the:
1) release of the N1 NAS signalling connection; or
2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS
optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend
indication; or
b) the AMF receives an indication from the lower layers that it has received
the NGAP UE context resume request message as specified in 3GPP TS 38.413 [31]
for a UE in 5GMM-IDLE mode with suspend indication and this resumption is a
response to a paging request from the network, and before the:
1) release of the N1 NAS signalling connection; or
2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS
optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend
indication.
If the service request procedure was triggered due to 5GSM downlink signalling
pending, the procedure for assigning a new 5G-GUTI can be initiated by the
network after the transport of the 5GSM downlink signalling.
The following parameters are supported by the generic UE configuration update
procedure without the need to request the UE to perform the registration
procedure for mobility and periodic registration update:
a) 5G-GUTI;
b) TAI list;
c) Service area list;
d) Network identity and time zone information (Full name for network, short
name for network, local time zone, universal time and local time zone, network
daylight saving time);
e) LADN information;
f) Rejected NSSAI;
NOTE: A cause value associated with a rejected S-NSSAI can be included in the
Rejected NSSAI IE or in the Extended rejected NSSAI IE and a back-off timer
value associated with rejected S-NSSAI(s) can be included in the Extended
rejected NSSAI IE.
g) void;
h) Operator-defined access category definitions;
i) SMS indication;
j) \"CAG information list\";
k) UE radio capability ID;
l) 5GS registration result;
m) Truncated 5G-S-TMSI configuration;
n) T3447 value;
o) \"list of PLMN(s) to be used in disaster condition\";
p) disaster roaming wait range;
q) disaster return wait range; and
r) PEIPS assistance information;
s) Priority indicator; and
> t) NSAG information.
The following parameters can be sent to the UE with or without a request to
perform the registration procedure for mobility and periodic registration
update:
a) Allowed NSSAI;
b) Configured NSSAI;
c) Network slicing subscription change indication; or
d) NSSRG information.
The following parameters are sent to the UE with a request to perform the
registration procedure for mobility and periodic registration update:
a) MICO indication;
b) UE radio capability ID deletion indication; and
c) Additional configuration indication.
The following parameters can be included in the Service-level-AA container IE
to be sent to the UE without a request to perform the registration procedure
for mobility and periodic registration update:
a) Service-level device ID;
b) Service-level-AA payload type;
c) Service-level-AA payload;
d) Service-level-AA response; or
e) Service-level-AA service status indication.
The following parameters are sent over 3GPP access only:
a) LADN information;
b) MICO indication;
c) TAI list;
d) Service area list;
e) \"CAG information list\";
f) UE radio capability ID;
g) UE radio capability ID deletion indication;
h) Truncated 5G-S-TMSI configuration;
i) Additional configuration indication;
j) T3447 value;
k) Service-level-AA container; and
l) NSAG information.
The following parameters are managed and sent per access type i.e.,
independently over 3GPP access or non-3GPP access:
a) Allowed NSSAI;
b) Rejected NSSAI (when the NSSAI is rejected for the current registration
area or is rejected for the maximum number of UEs reached); and
c) If the UE is not registered to the same PLMN or SNPN over 3GPP and non-3GPP
access:
\- 5G-GUTI;
\- Network identity and time zone information;
\- Rejected NSSAI (when the NSSAI is rejected for the current PLMN or SNPN or
rejected for the failed or revoked NSSAA);
\- Configured NSSAI;
\- NSSRG information;- SMS indication;
\- 5GS registration result; and
\- PEIPS assistance information.
If the UE is registered to the same PLMN or SNPN over 3GPP and non-3GPP
access, the following parameters are managed commonly and sent over 3GPP
access or non-3GPP access:
a) 5G-GUTI;
b) Network identity and time zone information;
c) Rejected NSSAI (when the NSSAI is rejected for the current PLMN or SNPN or
rejected for the failed or revoked NSSAA);
d) Configured NSSAI;
e) SMS indication; and
f) 5GS registration result;
g) \"list of PLMN(s) to be used in disaster condition\";
h) disaster roaming wait range;
i) disaster return wait range;
j) PEIPS assistance information; and
k) NSSRG information;
Figure 5.4.4.1.1: Generic UE configuration update procedure
#### 5.4.4.2 Generic UE configuration update procedure initiated by the
network
The AMF shall initiate the generic UE configuration update procedure by
sending the CONFIGURATION UPDATE COMMAND message to the UE.
The AMF shall in the CONFIGURATION UPDATE COMMAND message either:
a) include one or more of the following parameters: 5G-GUTI, TAI list, allowed
NSSAI that may include the mapped S-NSSAI(s), LADN information, service area
list, MICO indication, NITZ information, configured NSSAI that may include the
mapped S-NSSAI(s), NSSRG information, rejected S-NSSAI(s) in the Rejected
NSSAI IE or in the Extended rejected NSSAI IE, network slicing subscription
change indication, operator-defined access category definitions, SMS
indication, service gap time value, \"CAG information list\", UE radio
capability ID, 5GS registration result, UE radio capability ID deletion
indication, truncated 5G-S-TMSI configuration, T3447 value, \"list of PLMN(s)
to be used in disaster condition\", disaster roaming wait range, disaster
return wait range, PEIPS assistance information, the priority indicator or the
NSAG information;
b) include the Configuration update indication IE with the Registration
requested bit set to \"registration requested\"; or
c) include a combination of both a) and b).
If the UE is registering or registered for onboarding services in SNPN, the
serving SNPN shall not provide the configured NSSAI, the allowed NSSAI or the
rejected NSSAI to the UE.
If the UE supports extended rejected NSSAI, the rejected S-NSSAI(s) shall be
included in the Extended rejected NSSAI IE. Otherwise the rejected S-NSSAI(s)
shall be included in the Rejected NSSAI IE.
If an acknowledgement from the UE is requested, the AMF shall indicate
\"acknowledgement requested\" in the Acknowledgement bit of the Configuration
update indication IE in the CONFIGURATION UPDATE COMMAND message and shall
start timer T3555. Acknowledgement shall be requested for all parameters
except when only NITZ is included.
To initiate parameter re-negotiation between the UE and network, the AMF shall
indicate \"registration requested\" in the Registration requested bit of the
Configuration update indication IE in the CONFIGURATION UPDATE COMMAND
message.
NOTE 1: Generic UE configuration update procedure can be initiated by the AMF
for updating the emergency number list, the extended emergency number list or
both by indicating \"registration requested\" in the Registration requested
bit of the Configuration update indication IE in the CONFIGURATION UPDATE
COMMAND message to the UE.
If a new allowed NSSAI information or AMF re-configuration of supported
S-NSSAIs requires an AMF relocation, the AMF shall indicate \"registration
requested\" in the Registration requested bit of the Configuration update
indication IE and include the Allowed NSSAI IE in the CONFIGURATION UPDATE
COMMAND message.
If the AMF includes a new allowed NSSAI in the CONFIGURATION UPDATE COMMAND
message and the subscription information includes the NSSRG information, then
the S-NSSAIs of the allowed NSSAI shall be associated with at least one common
NSSRG value. If the network has pending NSSAI, the S-NSSAIs in the pending
NSSAI and allowed NSSAI shall be associated with at least one common NSSRG
value.
If the AMF includes a new configured NSSAI in the CONFIGURATION UPDATE COMMAND
message and the new configured NSSAI requires an AMF relocation as specified
in 3GPP TS 23.501 [8], the AMF shall indicate \"registration requested\" in
the Registration requested bit of the Configuration update indication IE in
the message.
If the AMF includes a new configured NSSAI in the CONFIGURATION UPDATE COMMAND
message, the subscription information includes the NSSRG information, and the
UE has set the NSSRG bit in the 5GMM capability IE of the REGISTRATION REQUEST
message to:
a) \"NSSRG supported\", then the AMF shall include the NSSRG information in
the CONFIGURATION UPDATE COMMAND message; or
b) \"NSSRG not supported\", then the configured NSSAI shall include one or
more S-NSSAIs each of which is associated with all the NSSRG value(s) of the
default S-NSSAI(s), or the configured NSSAI shall include, based on the
indication received from the UDM as specified in 3GPP TS 23.501 [8], all
subscribed S-NSSAIs even if these S-NSSAIs do not share any common NSSRG
value.
If the AMF needs to update the NSSRG information and the UE has set the NSSRG
bit to \"NSSRG supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message, then the AMF shall include the new NSSRG information in the
CONFIGURATION UPDATE COMMAND message.
If the AMF includes a new NSSRG information in the CONFIGURATION UPDATE
COMMAND message and the AMF determines that the UE needs to provide a new
requested NSSAI due to no NSSRG value common to all the S-NSSAI(s) of the
allowed NSSAI based on the new NSSRG information, then the CONFIGURATION
UPDATE COMMAND message shall indicate \"registration requested\" in the
Registration requested bit of the Configuration update indication IE.
If the CONFIGURATION UPDATE COMMAND message is initiated only due to changes
to the allowed NSSAI and these changes require the UE to initiate a
registration procedure, but the AMF is unable to determine an allowed NSSAI
for the UE as specified in 3GPP TS 23.501 [8], then the CONFIGURATION UPDATE
COMMAND message shall indicate \"registration requested\" in the Registration
requested bit of the Configuration update indication IE, and shall not contain
any other parameters.
If:
\- the AMF needs to enforce a change in the restriction on the use of enhanced
coverage or use of CE mode B as described in subclause 5.3.18; or
\- the AMF decides to inform a UE in 5GMM-CONNECTED mode and registered for
disaster roaming services, that a disaster condition is no longer applicable;
NOTE 1A: The case of the AMF triggering a generic UE configuration update
procedure to inform a UE registered for disaster roaming services that a
disaster condition is no longer applicable, is only applicable for a UE
already in 5GMM-CONNECTED mode.
the AMF shall indicate \"registration requested\" in the Registration
requested bit of the Configuration update indication IE and \"release of N1
NAS signalling connection not required\" in the Signalling connection maintain
request bit of the Additional configuration indication IE in the CONFIGURATION
UPDATE COMMAND message.
If a network slice-specific authentication and authorization procedure for an
S-NSSAI is completed as a:
a) success, the AMF shall include this S-NSSAI in the allowed NSSAI over the
same access of the requested S-NSSAI; or
b) failure, the AMF shall include this S-NSSAI in the rejected NSSAI for the
failed or revoked NSSAA with the rejection cause \"S-NSSAI not available due
to the failed or revoked network slice-specific authentication and
authorization\" over either 3GPP access or non-3GPP access.
If authorization is revoked for an S-NSSAI that is in the current allowed
NSSAI for an access type, the AMF shall:
a) provide a new allowed NSSAI to the UE, excluding the S-NSSAI for which
authorization is revoked; and
b) provide a new rejected NSSAI for the failed or revoked NSSAA, including the
S-NSSAI in the rejected NSSAI for which the authorization is revoked, with the
rejection cause \"S-NSSAI not available due to the failed or revoked network
slice-specific authentication and authorization\".
The allowed NSSAI and the rejected NSSAI shall be included in the
CONFIGURATION UPDATE COMMAND message to reflect the result of the procedures
subject to network slice-specific authentication and authorization.
NOTE 2: If there are multiple S-NSSAIs subject to network slice-specific
authentication and authorization, it is implementation specific if the AMF
informs the UE about the outcome of the procedures in one or more
CONFIGURATION UPDATE COMMAND messages.
If the AMF includes the Network slicing indication IE in the CONFIGURATION
UPDATE COMMAND message with the Network slicing subscription change indication
set to \"Network slicing subscription changed\", and changes to the allowed
NSSAI require the UE to initiate a registration procedure, but the AMF is
unable to determine an allowed NSSAI for the UE as specified in 3GPP TS 23.501
[8], then the CONFIGURATION UPDATE COMMAND message shall additionally indicate
\"registration requested\" in the Registration requested bit of the
Configuration update indication IE and shall not include an allowed NSSAI.
If EAC mode is activated for an S-NSSAI, the AMF shall perform NSAC for the
S-NSSAI subject to NSAC before such S-NSSAI is included in the allowed NSSAI
in the CONFIGURATION UPDATE COMMAND message. If EAC mode is deactivated for an
S-NSSAI, the AMF shall perform NSAC for the S-NSSAI subject to NSAC after such
S-NSSAI is included in the allowed NSSAI in the CONFIGURATION UPDATE COMMAND
message.
If the UE supports extended rejected NSSAI and the AMF determines that maximum
number of UEs reached for one or more S-NSSAI(s) in the allowed NSSAI as
specified in subclause 4.6.2.5**, the AMF shall include the rejected NSSAI**
containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available due to maximum number of UEs reached\" in the Extended rejected
NSSAI IE **in the** CONFIGURATION UPDATE COMMAND message. In addition, the AMF
may include a back-off timer value for each S-NSSAI with the rejection cause
\"S-NSSAI not available due to maximum number of UEs reached\" included in the
Extended rejected NSSAI IE of the CONFIGURATION UPDATE COMMAND message. To
avoid that large numbers of UEs simultaneously initiate deferred requests, the
network should select the value for the backoff timer for each S-NSSAI for the
informed UEs so that timeouts are not synchronised.
If the UE does not indicate support for extended rejected NSSAI and the
maximum number of UEs has been reached, the AMF should include the rejected
NSSAI containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available in the current registration area\" in the Rejected NSSAI IE and
should not include these S-NSSAIs in the allowed NSSAI in the CONFIGURATION
UPDATE COMMAND message. In addition, the AMF may based on the network policies
start a local implementation specific timer for the UE per rejected S-NSSAI
and upon expiration of the local implementation specific timer, the AMF may
remove the rejected S-NSSAI from the rejected NSSAI and update to the UE by
initiating the generic UE configuration update procedure.
NOTE 3: Based on network policies, the AMF can include the S-NSSAI(s) for
which the maximum number of UEs has been reached in the rejected NSSAI with
rejection causes other than \"S-NSSAI not available in the current
registration area\" .
If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message, the AMF may include the NSAG information
IE in the CONFIGURATION UPDATE COMMAND message. Up to 4 NSAG entries are
allowed to be associated with a TAI list in the NSAG information IE.
NOTE 3a: How the AMF selects NSAG entries to be included in the NSAG
information IE is implementation specific, e.g. take the NSAG priority and the
current registration area into accountNOTE 3b: If the NSAG for the PLMN and
its equivalent PLMN(s) have different associations with S-NSSAIs, then the AMF
includes a TAI list for the NSAG entry in the NSAG information IE.
If the AMF needs to update the LADN information, the AMF shall include the
LADN information in the LADN information IE of the CONFIGURATION UPDATE
COMMAND message.
If the AMF needs to update the \"CAG information list\", the AMF shall include
the CAG information list IE or the Extended CAG information list IE in the
CONFIGURATION UPDATE COMMAND message.
NOTE 4: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the UE does not support extended CAG information list, the CAG information
list shall not be included in the Extended CAG information list IE.
If the AMF needs to update the \"CAG information list\", the UE has an
emergency PDU session, and the AMF can determine that the UE is in
a) a CAG cell and none of the CAG-ID(s) supported by the CAG cell is included
in the \"allowed CAG list\" for the current PLMN in the updated \"CAG
information list\"; or
b) a non-CAG cell and the entry for the current PLMN in the updated \"CAG
information list\" includes an \"indication that the UE is only allowed to
access 5GS via CAG cells\";
the AMF may indicate to the SMF to perform a local release of:
a) all non-emergency single access PDU sessions associated with 3GPP access;
b) all MA PDU sessions without a PDN connection established as a user-plane
resource and without user plane resources established on non-3GPP access; and
c) the 3GPP access user plane resources of all those MA PDU sessions with user
plane resources established on both accesses.
The AMF shall not indicate to the SMF to release the emergency PDU session. If
the AMF indicated to the SMF to perform a local release of:
a) all single access non-emergency PDU sessions associated with 3GPP access;
b) all MA PDU sessions without a PDN connection established as a user-plane
resource and without user plane resources established on non-3GPP access; and
c) the 3GPP access user plane resources of all those MA PDU sessions with user
plane resources established on both accesses;
the network shall behave as if the UE is registered for emergency services
over 3GPP access and shall set the 5GS registration result IE value to
\"Registered for emergency services\" in the CONFIGURATION UPDATE COMMAND
message.
If the AMF is initiating the generic UE configuration update procedure to
indicate to a UE which is registered for disaster roaming services, and which
has an ongoing emergency PDU session, that the UE is registered for emergency
services as described in subclause 4.24, the AMF shall set the 5GS
registration result IE value to \"Registered for emergency services\" in the
CONFIGURATION UPDATE COMMAND message.
If the AMF:
\- updated the \"CAG information list\" to remove one or more CAG-ID(s) in the
Allowed CAG list for the serving PLMN or an equivalent PLMN; or
\- updated the \"CAG information list\" to set the \"indication that the UE is
only allowed to access 5GS via CAG cells\" for the serving PLMN or an
equivalent PLMN which was not set before,
then upon completion of the configuration update procedure and if the UE does
not have an emergency PDU session, the AMF shall initiate the release of the
N1 NAS signalling connection according to subclause 5.3.1.3.
If the AMF needs to update the truncated 5G-S-TMSI configuration for a UE in
NB-N1 mode using control plane CIoT 5GS optimization, the AMF shall include
the Truncated 5G-S-TMSI configuration IE in the CONFIGURATION UPDATE COMMAND
message.
If the AMF includes a UE radio capability ID deletion indication IE in the
CONFIGURATION UPDATE COMMAND message, the AMF shall indicate \"registration
requested\" in the Registration requested bit of the Configuration update
indication IE.
If the AMF needs to redirect the UE to EPC as described in subclause 4.8.4A.2,
the AMF shall indicate \"registration requested\" in the Registration
requested bit of the Configuration update indication IE and \"release of N1
NAS signalling connection not required\" in the Signalling connection maintain
request bit of the Additional configuration indication IE in the CONFIGURATION
UPDATE COMMAND message.
If the UE is not in NB-N1 mode and the UE supports RACS, the AMF may include
either a UE radio capability ID IE or a UE radio capability ID deletion
indication IE in the CONFIGURATION UPDATE COMMAND message.
During an established 5GMM context, the network may send none, one, or more
CONFIGURATION UPDATE COMMAND messages to the UE. If more than one
CONFIGURATION UPDATE COMMAND message is sent, the messages need not have the
same content.
Upon receipt of the result of the UUAA-MM procedure from the UAS-NF, the AMF
shall include:
a) the service-level-AA response with the SLAR field set to:
1) \"Service level authentication and authorization was successful\" if the
AMF detects the UUAA-MM procedure has succeeded; or
2) \"Service level authentication and authorization was not successful or
service level authorization is revoked\" if the AMF detects the UUAA-MM
procedure has failed;
b) if the CAA-Level UAV ID is provided by the UAS-NF, the service-level device
ID with the value set to the CAA-Level UAV ID; and;
c) if ta payload is received from the UAS-NF:
1) the service-level-AA payload with the value set to the payload; and
2) if a payload type associated with the payload is received, the service-
level-AA payload type with the values set to the payload type
in the Service-level-AA container IE of the CONFIGURATION UPDATE COMMAND
message.
NOTE 5: UAS security information can be included in the UUAA payload by the
USS as specified in 3GPP TS 33.256 [24B].
NOTE 6: If the AMF receives the HTTP code set to \"4xx\" or \"5xx\" as
specified in 3GPP TS 29.500 [20AA] or the AMF detects that the UUAA-MM failure
as specified in 3GPP TS 29.256 [21B], then the AMF considers the UUAA-MM
procedure has failed.
If the AMF needs to deliver to the UE the UUAA revocation notification
received from the UAS-NF, the AMF shall include the service-level-AA response
with SLAR set to \"Service level authentication and authorization was not
successful or service level authorization is revoked\" in the Service-level-AA
container IE of the CONFIGURATION UPDATE COMMAND message.
If the UE supports UAS services and UAS services become enabled for the UE
(e.g. because of the aerial subscription becomes a part of the UE subscription
data retrieved from the UDM), the AMF may include the service-level-AA service
status indication with UAS field set to \"UAS services enabled\" in the
Service-level-AA container IE of the CONFIGURATION UPDATE COMMAND message.
If the UE supports MINT, the AMF may include the List of PLMNs to be used in
disaster condition IE in the CONFIGURATION UPDATE COMMAND message.
If the UE supports MINT, the AMF may include the Disaster roaming wait range
IE in the CONFIGURATION UPDATE COMMAND message.
If the UE supports MINT, the AMF may include the Disaster return wait range IE
in the CONFIGURATION UPDATE COMMAND message.
NOTE 7: The AMF can determine the content of the \"list of PLMN(s) to be used
in disaster condition\", the value of the disaster roaming wait range and the
value of the disaster return wait range based on the network local
configuration.
If the UE supports and the network supports and accepts the use of the PEIPS
assistance information, and the AMF needs to update the PEIPS assistance
information, the AMF may include the PEIPS assistance information in the
Updated PEIPS assistance information IE of the CONFIGURATION UPDATE COMMAND
message.
If the AMF needs to inform the UE that the use of access identity 1 is valid
or is no longer valid then:
1) if the UE supports MPS indicator update via the UE configuration update
procedure, the AMF:
a) informs the UE by setting the MPS indicator bit of the Priority indicator
IE to \"Access identity 1 valid\" or \"Access identity 1 not valid\"
respectively, in the CONFIGURATION UPDATE COMMAND message. Based on operator
policy, the AMF sets the MPS indicator bit in the CONFIGURATION UPDATE COMMAND
message based on the MPS priority information in the user\'s subscription
context obtained from the UDM; or
b) indicates \"registration requested\" in the Registration requested bit of
the Configuration update indication IE in the CONFIGURATION UPDATE COMMAND
message;
2) otherwise, the AMF shall indicate \"registration requested\" in the
Registration requested bit of the Configuration update indication IE in the
CONFIGURATION UPDATE COMMAND message.
.
#### 5.4.4.3 Generic UE configuration update accepted by the UE
Upon receiving the CONFIGURATION UPDATE COMMAND message, the UE shall stop
timer T3346 if running and use the contents to update appropriate information
stored within the UE.
If \"acknowledgement requested\" is indicated in the Acknowledgement bit of
the Configuration update indication IE in the CONFIGURATION UPDATE COMMAND
message, the UE shall send a CONFIGURATION UPDATE COMPLETE message.
If the UE receives a new 5G-GUTI in the CONFIGURATION UPDATE COMMAND message,
the UE shall consider the new 5G-GUTI as valid, the old 5G-GUTI as invalid,
stop timer T3519 if running, and delete any stored SUCI; otherwise, the UE
shall consider the old 5G-GUTI as valid. The UE shall provide the 5G-GUTI to
the lower layer of 3GPP access if the CONFIGURATION UPDATE COMMAND message is
sent over the non-3GPP access, and the UE is in 5GMM-REGISTERED in both 3GPP
access and non-3GPP access in the same PLMN.
If the UE receives a new TAI list in the CONFIGURATION UPDATE COMMAND message,
the UE shall consider the new TAI list as valid and the old TAI list as
invalid; otherwise, the UE shall consider the old TAI list as valid. If the
registration area contains TAIs belonging to different PLMNs, which are
equivalent PLMNs, and
a) the UE already has stored allowed NSSAI for the current registration area,
the UE shall store the allowed NSSAI for the current registration area in each
of the allowed NSSAIs which are associated with each of the PLMNs in the
registration area; and
b) the UE already has stored rejected NSSAI for the current registration area,
the UE shall store the rejected NSSAI for the current registration area in
each of the rejected NSSAIs which are associated with each of the PLMNs in the
registration area.
If the UE receives a new truncated 5G-S-TMSI configuration in the
CONFIGURATION UPDATE COMMAND message, the UE shall consider the new truncated
5G-S-TMSI configuration as valid and the old truncated 5G-S-TMSI configuration
as invalid; otherwise, the UE shall consider the old truncated 5G-S-TMSI
configuration as valid.
If the UE receives a new service area list in the CONFIGURATION UPDATE COMMAND
message, the UE shall consider the new service area list as valid and the old
service area list as invalid; otherwise, the UE shall consider the old service
area list, if any, as valid.
If the UE receives new NITZ information in the CONFIGURATION UPDATE COMMAND
message, the UE considers the new NITZ information as valid and the old NITZ
information as invalid; otherwise, the UE shall consider the old NITZ
information as valid.
If the UE receives a LADN information IE in the CONFIGURATION UPDATE COMMAND
message, the UE shall consider the old LADN information as invalid and the new
LADN information as valid, if any; otherwise, the UE shall consider the old
LADN information as valid.
If the UE receives a new allowed NSSAI for the associated access type in the
CONFIGURATION UPDATE COMMAND message, the UE shall consider the new allowed
NSSAI as valid for the associated access type, store the allowed NSSAI for the
associated access type as specified in subclause 4.6.2.2 and consider the old
allowed NSSAI for the associated access type as invalid; otherwise, the UE
shall consider the old allowed NSSAI as valid for the associated access type.
If the UE receives a new configured NSSAI in the CONFIGURATION UPDATE COMMAND
message, the UE shall consider the new configured NSSAI for the registered
PLMN or SNPN as valid and the old configured NSSAI for the registered PLMN or
SNPN as invalid; otherwise, the UE shall consider the old configured NSSAI for
the registered PLMN or SNPN as valid The UE shall store the new configured
NSSAI as specified in subclause 4.6.2.2. In addition, if the CONFIGURATION
UPDATE COMMAND message contains an NSSRG information IE, the UE shall store
the contents of the NSSRG information IE as specified in subclause 4.6.2.2.
If the UE receives the Network slicing indication IE in the CONFIGURATION
UPDATE COMMAND message with the Network slicing subscription change indication
set to \"Network slicing subscription changed\", the UE shall delete the
network slicing information for each and every PLMN except for the current
PLMN as specified in subclause 4.6.2.2.
If the UE receives Operator-defined access category definitions IE in the
CONFIGURATION UPDATE COMMAND message and the Operator-defined access category
definitions IE contains one or more operator-defined access category
definitions, the UE shall delete any operator-defined access category
definitions stored for the RPLMN and shall store the received operator-defined
access category definitions for the RPLMN. If the UE receives the Operator-
defined access category definitions IE in the CONFIGURATION UPDATE COMMAND
message and the Operator-defined access category definitions IE contains no
operator-defined access category definitions, the UE shall delete any
operator-defined access category definitions stored for the RPLMN. If the
CONFIGURATION UPDATE COMMAND message does not contain the Operator-defined
access category definitions IE, the UE shall not delete the operator-defined
access category definitions stored for the RPLMN.
If the UE receives the SMS indication IE in the CONFIGURATION UPDATE COMMAND
message with the SMS availability indication set to:
a) \"SMS over NAS not available\", the UE shall consider that SMS over NAS
transport is not allowed by the network; and
b) \"SMS over NAS available\", the UE may request the use of SMS over NAS
transport by performing a registration procedure for mobility and periodic
registration update as specified in subclause 5.5.1.3, after the completion of
the generic UE configuration update procedure.
If the UE receives the CAG information list IE in the CONFIGURATION UPDATE
COMMAND message, the UE shall:
a) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE when received in the HPLMN or EHPLMN;
NOTE 1: When the UE receives the CAG information list IE in the HPLMN derived
from the IMSI, the EHPLMN list is present and is not empty and the HPLMN is
not present in the EHPLMN list, the UE behaves as if it receives the CAG
information list IE in a VPLMN.
b) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE when the UE receives the CAG information list IE in a serving PLMN other
than the HPLMN or EHPLMN; or
NOTE 2: When the UE receives the CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN, entries of a PLMN other than the serving
VPLMN, if any, in the received CAG information list IE are ignored.
c) remove the serving VPLMN\'s entry of the \"CAG information list\" stored in
the UE when the UE receives the CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN and the CAG information list IE does not
contain the serving VPLMN\'s entry.
The UE shall store the \"CAG information list\" received in the CAG
information list IE as specified in annex C.
If the received \"CAG information list\" includes an entry containing the
identity of the current PLMN and the UE had set the CAG bit to \"CAG
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message, the
UE shall operate as follows.
a) If the UE receives the CONFIGURATION UPDATE COMMAND message via a CAG cell,
the entry for the current PLMN in the received \"CAG information list\" does
not include any of the CAG-ID(s) supported by the current CAG cell, and:
1) the entry for the current PLMN in the received \"CAG information list\"
does not include an \"indication that the UE is only allowed to access 5GS via
CAG cells\", then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE
and shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP
TS 36.304 [25C] with the updated \"CAG information list\"; or
2) the entry for the current PLMN in the received \"CAG information list\"
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and:
i) if the entry for the current PLMN in the received \"CAG information list\"
includes one or more CAG-IDs, the UE shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to
3GPP TS 38.304 [28] with the updated \"CAG information list\"; or
ii) if the entry for the current PLMN in the received \"CAG information list\"
does not include any CAG-ID and:
A) the UE does not have an emergency PDU session, then the UE shall enter the
state 5GMM-REGISTERED.PLMN-SEARCH and shall apply the PLMN selection process
defined in 3GPP TS 23.122 [5] with the updated \"CAG information list\"; or
B) the UE has an emergency PDU session, then the UE shall perform a local
release of all PDU sessions associated with 3GPP access except for the
emergency PDU session and enter the state 5GMM-REGISTERED.LIMITED-SERVICE; or
b) If the UE receives the CONFIGURATION UPDATE COMMAND message via a non-CAG
cell and the entry for the current PLMN in the received \"CAG information
list\" includes an \"indication that the UE is only allowed to access 5GS via
CAG cells\" and:
1) if the \"allowed CAG list\" for the current PLMN in the received \"CAG
information list\" includes one or more CAG-IDs, the UE shall enter the state
5GMM-REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according
to 3GPP TS 38.304 [28] with the updated \"CAG information list\"; or
2) if the entry for the current PLMN in the received \"CAG information list\"
does not include any CAG-ID and:
i) the UE does not have an emergency PDU session, then the UE shall enter the
state 5GMM-REGISTERED.PLMN-SEARCH and shall apply the PLMN selection process
defined in 3GPP TS 23.122 [5] with the updated \"CAG information list\"; or
ii) the UE has an emergency PDU session, then the UE shall perform a local
release of all PDU sessions associated with 3GPP access except for the
emergency PDU session and enter the state 5GMM-REGISTERED.LIMITED-SERVICE.
If the received \"CAG information list\" does not include an entry containing
the identity of the current PLMN and the UE receives the CONFIGURATION UPDATE
COMMAND message via a CAG cell, the UE shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to
3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C] with the updated \"CAG information
list\".
If the CONFIGURATION UPDATE COMMAND message indicates \"registration
requested\" in the Registration requested bit of the Configuration update
indication IE and:
a) contains no other parameters or contains at least one of the following
parameters: a new allowed NSSAI, a new configured NSSAI, a new NSSRG
information or the Network slicing subscription change indication, and:
1) an emergency PDU session exists, the UE shall, after the completion of the
generic UE configuration update procedure and the release of the emergency PDU
session, release the existing N1 NAS signalling connection. If any Tsor-cm
timer(s) were running and have stopped, the UE shall attempt to obtain service
on a higher priority PLMN (see 3GPP TS 23.122 [5]). Otherwise the UE start a
registration procedure for mobility and periodic registration update as
specified in subclause 5.5.1.3; or
2) no emergency PDU Session exists, the UE shall, after the completion of the
generic UE configuration update procedure and the release of the existing N1
NAS signalling connection. If any Tsor-cm timer(s) were running and have
stopped, the UE shall attempt to obtain service on a higher priority PLMN (see
3GPP TS 23.122 [5]). Otherwise the UE start a registration procedure for
mobility and periodic registration update as specified in subclause 5.5.1.3;
b) a MICO indication is included without a new allowed NSSAI, a new configured
NSSAI, a new NSSRG information or the Network slicing subscription change
indication, the UE shall, after the completion of the generic UE configuration
update procedure, start a registration procedure for mobility and registration
update as specified in subclause 5.5.1.3 to re-negotiate MICO mode with the
network;
c) an Additional configuration indication IE is included, and:
1) \"release of N1 NAS signalling connection not required\" is indicated in
the Signalling connection maintain request bit of the Additional configuration
indication IE; and
2) a new allowed NSSAI, a new configured NSSAI, a new NSSRG information or the
Network slicing subscription change indication is not included in the
CONFIGURATION UPDATE COMMAND message,
the UE shall, after the completion of the generic UE configuration update
procedure, start a registration procedure for mobility and registration update
as specified in subclause 5.5.1.3; or
d) a UE radio capability ID deletion indication IE set to "Network-assigned UE
radio capability IDs deletion requested" is included, and:
1) the UE is not in NB-N1 mode;
2) a new allowed NSSAI, a new configured NSSAI, a new NSSRG information or a
Network slicing subscription change indication is not included; and
3) the UE has set the RACS bit to \"RACS supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message,
the UE shall, after the completion of the generic UE configuration update
procedure, start a registration procedure for mobility and registration update
as specified in subclause 5.5.1.3.
The UE receiving the rejected NSSAI in the CONFIGURATION UPDATE COMMAND
message takes the following actions based on the rejection cause in the
rejected S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt to use
this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE, the
UICC containing the USIM is removed, the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
registration area as specified in subclause 4.6.2.2 and shall not attempt to
use this S-NSSAI(s) in the current registration area until switching off the
UE, the UE moving out of the current registration area, the UICC containing
the USIM is removed, the entry of the \"list of subscriber data\" with the
SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are
removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the failed
or revoked NSSAA as specified in subclause 4.6.2.2 and shall not attempt to
use this S-NSSAI in the current PLMN or SNPN over any access until switching
off the UE, the UICC containing the USIM is removed, the entry of the \"list
of subscriber data\" with the SNPN identity of the current SNPN is updated, or
the rejected S-NSSAI(s) are removed or deleted as described in subclause 4.6.1
and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
Unless the back-off timer value received along with the S-NSSAI is zero, the
UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
NOTE 3: If the back-off timer value received along with the S-NSSAI in the
rejected NSSAI for the maximum number of UEs reached is zero as specified in
subclause 10.5.7.4a of TS 24.008, the UE does not consider the S-NSSAI as the
rejected S-NSSAI.
If there is one or more S-NSSAIs in the rejected NSSAI with the rejection
cause \"S-NSSAI not available due to maximum number of UEs reached\", then for
each S-NSSAI, the UE shall behave as follows:
a) stop the timer T3526 associated with the S-NSSAI, if running;
b) start the timer T3526 with:
1) the back-off timer value received along with the S-NSSAI, if back-off timer
value is received along with the S-NSSAI that is neither zero nor deactivated;
or
2) an implementation specific back-off timer value, if no back-off timer value
is received along with the S-NSSAI; and
c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs
reached when the timer T3526 associated with the S-NSSAI expires.
If the UE receives the NSAG information IE in the CONFIGURATION UPDATE COMMAND
message, the UE shall store the NSAG information as specified in subclause
4.6.2.2.
If the UE receives a T3447 value IE in the CONFIGURATION UPDATE COMMAND
message and has indicated \"service gap control supported\" in the
REGISTRATION REQUEST, then the UE shall replace the stored T3447 value with
the received value in the T3447 value IE, and if neither zero nor deactivated
use the received T3447 value with the timer T3447 next time it is started. If
the received T3447 value is zero or deactivated, then the UE shall stop the
timer T3447 if running.
If the UE is not in NB-N1 mode, the UE has set the RACS bit to \"RACS
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message and
the CONFIGURATION UPDATE COMMAND message includes:
a) a UE radio capability ID deletion indication IE set to \"Network-assigned
UE radio capability IDs deletion requested\", the UE shall delete any network-
assigned UE radio capability IDs associated with the RPLMN or RSNPN and, if
the UE supports access to an SNPN using credentials from a credentials holder,
the selected entry of the \"list of subscriber data\" or the selected PLMN
subscription stored at the UE; or
b) a UE radio capability ID IE, the UE shall store the UE radio capability ID
as specified in annex C.
If the UE is not currently registered for emergency services and the 5GS
registration result IE value in the CONFIGURATION UPDATE COMMAND message is
set to \"Registered for emergency services\", the UE shall consider itself
registered for emergency services and shall locally release all non-emergency
PDU sessions, if any.
If the UE receives the service-level-AA container IE of the CONFIGURATION
UPDATE COMMAND message, the UE passes it to the upper layer.
If the CONFIGURATION UPDATE COMMAND message includes the service-level-AA
response in the Service-level-AA container IE with the SLAR field set to
\"Service level authentication and authorization was not successful or service
level authorization is revoked\", the UE shall forward the service-level-AA
response to the upper layers, so the UUAA authorization data is deleted as
specified in 3GPP TS 33.256 [24B].
If the UE receives the List of PLMNs to be used in disaster condition IE in
the CONFIGURATION UPDATE COMMAND message and the UE supports MINT, the UE
shall delete the \"list of PLMN(s) to be used in disaster condition\" stored
in the ME together with the PLMN ID of the RPLMN, if any, and may store the
\"list of PLMN(s) to be used in disaster condition\" included in the List of
PLMNs to be used in disaster condition IE in the ME together with the PLMN ID
of the RPLMN.
If the UE receives the Disaster roaming wait range IE in the CONFIGURATION
UPDATE COMMAND message and the UE supports MINT, the UE shall delete the
disaster roaming wait range stored in the ME, if any, and store the disaster
roaming wait range included in the Disaster roaming wait range IE in the ME.
If the UE receives the Disaster return wait range IE in the CONFIGURATION
UPDATE COMMAND message and the UE supports MINT, the UE shall delete the
disaster roaming wait range stored in the ME, if any, and store the disaster
roaming wait range included in the Disaster roaming wait range IE in the ME.
If the UE receives the Updated PEIPS assistance information IE in the
CONFIGURATION UPDATE COMMAND message and the UE supports NR paging
subgrouping, the UE shall use the PEIPS assistance information included in the
Updated PEIPS assistance information IE.
If the UE receives a CONFIGURATION UPDATE COMMAND message with the MPS
indicator bit set to \"Access identity 1 valid\", the UE shall act as a UE
with access identity 1 configured for MPS as described in subclause 4.5.2, in
all NG-RAN of the registered PLMN and its equivalent PLMNs or in the case of
SNPN, as described in subclause 4.5.2A, in all NG-RAN of the registered SNPN.
The MPS indicator bit in the Priority indicator IE provided in the
CONFIGURATION UPDATE COMMAND message is valid until the UE receives a
REGISTRATION ACCEPT message with the MPS indicator bit set to \"Access
identity 1 not valid\" or the UE receives a CONFIGURATION UPDATE COMMAND
message with the MPS indicator bit of the Priority indicator IE set to
\"Access identity 1 not valid\" or until the UE selects a non-equivalent PLMN
(or in the case of SNPN, selects another SNPN). Access identity 1 is only
applicable while the UE is in N1 mode.
If the UE supporting UAS services is not currently registered for UAS services
and the CONFIGURATION UPDATE COMMAND message includes the service-level-AA
service status indication in the Service-level-AA container IE with the UAS
field set to \"UAS services enabled\", then the UE passes the service-level-AA
service status indication to the upper layers.
#### 5.4.4.4 Generic UE configuration update completion by the network
Upon receipt of the CONFIGURATION UPDATE COMPLETE message, the AMF shall stop
the timer T3555.
If a new 5G-GUTI was included in the CONFIGURATION UPDATE COMMAND message, the
AMF shall consider the new 5G-GUTI as valid and the old 5G-GUTI as invalid.
If a new TAI list was included in the CONFIGURATION UPDATE COMMAND message,
the AMF shall consider the new TAI list as valid and the old TAI list as
invalid.
If a new truncated 5G-S-TMSI configuration was included in the CONFIGURATION
UPDATE COMMAND message, the AMF shall consider the new truncated 5G-S-TMSI
configuration as valid and the old truncated 5G-S-TMSI configuration as
invalid.
If a new service area list was included in the CONFIGURATION UPDATE COMMAND
message, the AMF shall consider the new service area list as valid and the old
service area list as invalid.
If new allowed NSSAI information was included in the CONFIGURATION UPDATE
COMMAND message, the AMF shall consider the new allowed NSSAI information as
valid and the old allowed NSSAI information as invalid. If new configured
NSSAI information was included in the CONFIGURATION UPDATE COMMAND message,
the AMF shall consider the new configured NSSAI information as valid and the
old configured information as invalid. If there are active PDU sessions
associated with S-NSSAI(s) not included in the new allowed NSSAI, the AMF
shall notify the SMF(s) associated with these PDU sessions to initiate the
network-requested PDU session release procedure according to subclause 6.3.3
in the present specification and subclause 5.15.5.2.2 in 3GPP TS 23.501 [8].
If \"registration requested\" was indicated in the Registration requested bit
of the Configuration update indication IE in the CONFIGURATION UPDATE COMMAND
message and:
a) the CONFIGURATION UPDATE COMMAND message contained:
1) an allowed NSSAI, a configured NSSAI or both;
2) the Network slicing indication IE with the Network slicing subscription
change indication set to \"Network slicing subscription changed\"; or
3) no other parameters; and
b) no emergency PDU session has been established for the UE;
then the AMF shall initiate the release of the N1 NAS signalling connection.
If a LADN information IE was included in the CONFIGURATION UPDATE COMMAND
message, the AMF shall consider the old LADN information as invalid and the
new LADN information as valid, if any. In this case, if the tracking area
identity list in the new LADN information does not include the current TA, the
AMF shall indicate UE presence in LADN service area to the SMF (see 3GPP TS
23.501 [8] and 3GPP TS 23.502 [9]).
If a T3447 value was included in the CONFIGURATION UPDATE COMMAND message, the
AMF shall consider the T3447 value as valid and if neither zero nor
deactivated use the T3447 value with the timer T3447 next time it is started.
If the T3447 value included in the CONFIGURATION UPDATE COMMAND message
contained an indication that the timer is deactivated or timer value zero,
then the AMF shall stop the timer T3447 if running.
If a CAG information IE was included in the CONFIGURATION UPDATE COMMAND
message, the AMF shall consider the new \"CAG information list\" as valid and
the old \"CAG information list\" as invalid.
If a UE radio capability ID IE was included in the CONFIGURATION UPDATE
COMMAND message, the AMF shall consider the new UE radio capability ID as
valid and the old UE radio capability ID as invalid.
If an Updated PEIPS assistance information IE was included in the
CONFIGURATION UPDATE COMMAND message, the AMF shall consider the new PEIPS
assistance information as valid and the old PEIPS assistance information, if
any, as invalid.
#### 5.4.4.5 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Transmission failure of the CONFIGURATION UPDATE COMPLETE message with TAI
change from lower layers
If the current TAI is not in the TAI list, the generic UE configuration update
procedure shall be aborted and a registration procedure for mobility and
periodic registration update shall be initiated.
If the current TAI is still part of the TAI list, it is up to the UE
implementation how to re-run the ongoing procedure that triggered the generic
UE configuration update procedure.
b) Transmission failure of CONFIGURATION UPDATE COMPLETE message indication
without TAI change from lower layers
It is up to the UE implementation how to re-run the ongoing procedure that
triggered the generic UE configuration update procedure.
c) Generic UE configuration update and de-registration procedure collision
If the UE receives CONFIGURATION UPDATE COMMAND message after sending a
DEREGISTRATION REQUEST message and the access type included in the
DEREGISTRATION REQEUST message is same as the access in which the
CONFIGURATION UPDATE COMMAND message is received, then the UE shall ignore the
CONFIGURATION UPDATE COMMAND message and proceed with the de-registration
procedure. Otherwise, the UE shall proceed with both the procedures.
d) Void
e) Generic UE configuration update and service request procedure collision
If the SERVICE REQUEST message does not include UE request type IE with
Request type value set to \"NAS signalling connection release\" and the UE
receives a CONFIGURATION UPDATE COMMAND message before the ongoing service
request procedure has been completed, the UE shall proceed with both the
procedures.
If the SERVICE REQUEST message includes UE request type IE with Request type
value set to \"NAS signalling connection release\" and the UE receives a
CONFIGURATION UPDATE COMMAND message before the ongoing service request
procedure has been completed, the UE shall ignore the CONFIGURATION UPDATE
COMMAND message and proceed with the service request procedure.
f) \"CAG information list\" is received and the UE is operating in SNPN access
operation mode
If the UE receives the CAG information list IE in the CONFIGURATION UPDATE
COMMAND message and the UE is operating in SNPN access operation mode, the UE
shall ignore the content of CAG information list IE.
#### 5.4.4.6 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Expiry of timer T3555.
The network shall, on the first expiry of the timer T3555, retransmit the
CONFIGURATION UPDATE COMMAND message and shall reset and start timer T3555.
This retransmission is repeated four times, i.e. on the fifth expiry of timer
T3555, the procedure shall be aborted. In addition, if the CONFIGURATION
UPDATE COMMAND message includes the 5G-GUTI IE, the network shall behave as
described in case b)-1) below.
b) Lower layer failure.
If a lower layer failure is detected before the CONFIGURATION UPDATE COMPLETE
message is received and:
1) if the CONFIGURATION UPDATE COMMAND message includes the 5G-GUTI IE, the
old and the new 5G-GUTI shall be considered as valid until the old 5G-GUTI can
be considered as invalid by the AMF. If a new TAI list was provided in the
CONFIGURATION UPDATE COMMAND message, the old and new TAI list shall also be
considered as valid until the old TAI list can be considered as invalid by the
AMF.
Additionally, if the Updated PEIPS assistance information IE in the
CONFIGURATION UPDATE COMMAND message includes a new Paging subgroup ID and the
UE is previously assigned a different Paging subgroup ID then, the AMF shall
consider both, the old and new Paging subgroup IDs as valid until the old
Paging subgroup ID can be considered as invalid by the AMF.
During this period the AMF:
i) may first use the old 5G-S-TMSI from the old 5G-GUTI and the old Paging
subgroup ID, if any, for paging within the area defined by the old TAI list
for an implementation dependent number of paging attempts for network
originated transactions. If a new TAI list was provided in the CONFIGURATION
UPDATE COMMAND message, the new TAI list should also be used for paging. Upon
response from the UE, the AMF may re-initiate the CONFIGURATION UPDATE
COMMAND. If the Updated PEIPS assistance information IE in the CONFIGURATION
UPDATE COMMAND message includes a new Paging subgroup ID, then the AMF may re-
initiate the CONFIGURATION UPDATE COMMAND. If the response is received from a
tracking area within the old and new TAI list, the network shall re-initiate
the CONFIGURATION UPDATE COMMAND message. If no response is received to the
paging attempts, the network may use the new 5G-S-TMSI from the new 5G-GUTI
and the new Paging subgroup ID, if any, for paging for an implementation
dependent number of paging attempts. In this case, if a new TAI list was
provided with new 5G-GUTI in the CONFIGURATION UPDATE COMMAND message, the new
TAI list shall be used instead of the old TAI list. Upon response from the UE
the AMF shall consider the new 5G-GUTI and the new PEIPS assistance
information as valid and the old 5G-GUTI and the old PEIPS assistance
information as invalid.
ii) shall consider the new 5G-GUTI as valid if it is used by the UE and,
additionally, the new TAI list as valid if it was provided with this 5G-GUTI
in the CONFIGURATION UPDATE COMMAND message; and
iii) may use the identification procedure followed by a new generic UE
configuration update procedure if the UE uses the old 5G-GUTI; or
2) if the CONFIGURATION UPDATE COMMAND message does not include the 5G-GUTI IE
and:
i) the CONFIGURATION UPDATE COMMAND message does not contain the Allowed NSSAI
IE, the Rejected NSSAI IE, the Extended rejected NSSAI IE, or the Updated
PEIPS assistance information IE, the network shall abort the procedure; or
ii) the CONFIGURATION UPDATE COMMAND message contains the Allowed NSSAI IE,
the Rejected NSSAI IE, the Extended rejected NSSAI IE, or the Updated PEIPS
assistance information IE, the network shall either abort the procedure or
retransmit the CONFIGURATION UPDATE COMMAND message on expiry of the timer
T3555. The retransmission shall not be repeated more than four times. If the
retransmission is repeated for four times, the network shall abort the
procedure.
c) Generic UE configuration update and UE initiated de-registration procedure
collision.
If the network receives a DEREGISTRATION REQUEST message before the ongoing
generic UE configuration update procedure has been completed, the network
shall abort the generic UE configuration update procedure and shall progress
the de-registration procedure.
d) Generic UE configuration update and registration procedure for mobility and
periodic registration update collision
If the network receives a REGISTRATION REQUEST message before the ongoing
generic UE configuration update procedure has been completed, the network
shall abort the generic UE configuration update procedure and shall progress
the registration procedure for mobility and periodic registration update
procedure.
e) Generic UE configuration update and service request procedure collision
If the network receives a SERVICE REQUEST message before the ongoing generic
UE configuration update procedure has been completed and the SERVICE REQUEST
message does not include UE request type IE with Request type value set to
\"NAS signalling connection release\", both the procedures shall be
progressed.
If the network receives a SERVICE REQUEST message before the ongoing generic
UE configuration update procedure has been completed and the SERVICE REQUEST
message includes UE request type IE with Request type value set to \"NAS
signalling connection release\", the network shall abort the generic UE
configuration update procedure and shall progress the service request
procedure.
### 5.4.5 NAS transport procedure(s)
#### 5.4.5.1 General
The purpose of the NAS transport procedures is to provide a transport of
payload between the UE and the AMF. The type of the payload is identified by
the Payload container type IE and includes one of the following:
a) a single 5GSM message;
b) SMS;
c) an LPP message (see 3GPP TS 37.355 [26]);
d) an SOR transparent container;
e) a UE policy container;
f) a UE parameters update transparent container;
g) a location services message (see 3GPP TS 24.080 [13A]);
h) a CIoT user data container;
i) a Service-level-AA container; or
j) Multiple payloads.
For payload type a) to e), g) and h), along with the payload, the NAS
transport procedure may transport the associated information (e.g. PDU session
information for 5GSM message payload).
For payload type j), the Payload container IE consists a list of payload
container entries, where each of payload container entry contains the payload
and optional associated information (e.g. PDU session information for 5GSM
message payload).
NOTE: Payload type can be set to \"Multiple payloads\" if there are more than
one payloads to be transported using the NAS transport procedures.
#### 5.4.5.2 UE-initiated NAS transport procedure
##### 5.4.5.2.1 General
The purpose of the UE-initiated NAS transport procedure is to provide a
transport of:
a) a single 5GSM message as defined in subclause 8.3;
b) SMS (see 3GPP TS 24.011 [13]);
c) an LPP message;
d) an SOR transparent container;
e) a UE policy container; or
f) a UE parameters update transparent container;
g) a location services message;
h) a CIoT user data container;
i) a Service-level-AA container; or
j) multiple of the above types.
and:
\- for a) to e), g) and h), optional associated payload routing information
from the UE to the AMF in a 5GMM message; and
\- for j), the Payload container IE consists a list of payload container
entries, where each of the payload container entry contains the payload and
optional associated payload routing information (e.g. PDU session information
for 5GSM message payload).
##### 5.4.5.2.2 UE-initiated NAS transport procedure initiation
In the connected mode, the UE initiates the NAS transport procedure by sending
the UL NAS TRANSPORT message to the AMF, as shown in figure 5.4.5.2.2.1.
In case a) in subclause 5.4.5.2.1, the UE shall:
\- include the PDU session information (PDU session ID, old PDU session ID,
S-NSSAI, mapped S-NSSAI (if available in roaming scenarios), DNN, request
type), if available;
\- set the Payload container type IE to \"N1 SM information\"; and
\- set the Payload container IE to the 5GSM message.
The UE shall set the PDU session ID IE to the PDU session ID. If an old PDU
session ID is to be included, the UE shall set the Old PDU session ID IE to
the old PDU session ID.
If an S-NSSAI is to be included, the UE shall set the S-NSSAI IE to the
S-NSSAI selected for the PDU session from the allowed NSSAI for the current
PLMN or SNPN, associated with the mapped S-NSSAI (if available in roaming
scenarios).
If a DNN is to be included, the UE shall set the DNN IE to the DNN. 5GSM
procedures specified in clause 6 describe conditions for inclusion of the
S-NSSAI, mapped S-NSSAI (if available in roaming scenarios), and the DNN.
If a request type is to be included, the UE shall set the Request type IE to
the request type. The request type is not provided along 5GSM messages other
than the PDU SESSION ESTABLISHMENT REQUEST message and the PDU SESSION
MODIFICATION REQUEST message.
If an MA PDU session information is to be included, the UE shall set the MA
PDU session information IE to the MA PDU session information. The MA PDU
session information is not provided along 5GSM messages other than the PDU
SESSION ESTABLISHMENT REQUEST message and the PDU SESSION MODIFICATION REQUEST
message as specified in 3GPP TS 24.193 [13B].
In case b) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"SMS\"; and
\- set the Payload container IE to the SMS payload.
Based on the UE preferences regarding access selection for mobile originated
(MO) transmission of SMS over NAS as described in 3GPP TS 23.501 [8]:
\- when SMS over NAS is preferred to be sent over 3GPP access: the UE attempts
to deliver MO SMS over NAS via the 3GPP access if the UE is registered over
both 3GPP access and non-3GPP access. If the delivery of SMS over NAS via the
3GPP access is not available, the UE attempts to deliver MO SMS over NAS via
the non-3GPP access; and
\- when SMS over NAS is preferred to be sent over non-3GPP access: the UE
attempts to deliver MO SMS over NAS via the non-3GPP access if the UE is
registered over both 3GPP access and non-3GPP access. If the delivery of SMS
over NAS via the non-3GPP access is not available, the UE attempts to deliver
MO SMS over NAS via the 3GPP access.
In case c) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"LTE Positioning Protocol (LPP)
message container\";
\- set the Payload container IE to the LPP message payload; and
\- set the Additional information IE to the routing information provided by
the upper layer location services application.
In case d) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"SOR transparent container\"; and
\- set the Payload container IE to the UE acknowledgement due to successful
reception of steering of roaming information, and set the ME support of SOR-
CMCI indicator to \"SOR-CMCI supported by the ME\" in the Payload container IE
carrying the acknowledgement (see 3GPP TS 23.122 [5]).
In case e) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"UE policy container\"; and
\- set the contents of the Payload container IE as specified in Annex D.
In case f) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"UE parameters update transparent
container\"; and
\- set the contents of the Payload container IE to the UE acknowledgement due
to successful reception of UE parameters update data (see 3GPP TS 23.502 [9]).
In case g) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"Location services message
container\";
\- set the Payload container IE to the Location services message payload; and
\- set the Additional information IE to the routing information, if provided
by the upper layer location services application.
In case h) in subclause 5.4.5.2.1, the UE shall:
\- include the PDU session ID, and Release assistance indication (if
available);
\- set the Payload container type IE to \"CIoT user data container\"; and
\- set the Payload container IE to the user data container.
In case i) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"Service-level-AA container\"; and
\- set the Payload container IE to the Service-level-AA container.
In case j) in subclause 5.4.5.2.1, the UE shall:
\- set the Payload container type IE to \"Multiple payloads\"; and
\- set each payload container entry of the Payload container IE (see subclause
9.11.3.39), as follows:
i) set the payload container type field of the payload container entry to a
payload container type value set in the Payload container type IE as specified
in cases a) to i) above;
ii) set the payload container entry contents field of the payload container
entry to the payload container contents set in the Payload container IE as
specified in cases a) to i) above, and
iii) set the optional IE fields, if any, to the optional associated payload
routing information as specified in cases a) to i) above.
Figure 5.4.5.2.2.1: UE-initiated NAS transport procedure
##### 5.4.5.2.3 UE-initiated NAS transport of messages accepted by the network
Upon reception of a UL NAS TRANSPORT message, if the Payload container type IE
is set to:
a) \"N1 SM information\", the AMF looks up a PDU session routing context for:
1) the UE and the PDU session ID IE in case the Old PDU session ID IE is not
included, and:
NOTE 1: If the Old PDU session ID IE is not included in the UL NAS TRANSPORT
message and the AMF has received a reallocation requested indication from the
SMF, the AMF needs to ignore the reallocation requested indication.
i) if the AMF has a PDU session routing context for the PDU session ID and the
UE, and the Request type IE is either not included or is included but set to
other value than \"initial request\", \"existing PDU session\", \"initial
emergency request\", \"existing emergency PDU session\" or \"MA PDU request\",
the AMF shall send the 5GSM message, and the PDU session ID IE towards the SMF
identified by the SMF ID of the PDU session routing context;
ii) if the AMF has a PDU session routing context for the PDU session ID and
the UE, the PDU session routing context indicates that the PDU session is not
an emergency PDU session, the Request type IE is included and is set to
\"existing PDU session\" or \"MA PDU request\", and the S-NSSAI associated
with the PDU session identified by the PDU session ID is allowed for the
target access type, the AMF shall send the 5GSM message, the PDU session ID,
the S-NSSAI, the mapped S-NSSAI (in roaming scenarios), the DNN (if received)
and the request type towards the SMF identified by the SMF ID of the PDU
session routing context;
iii) if the AMF does not have a PDU session routing context for the PDU
session ID and the UE, and the Request type IE is included and is set to
\"initial request\" or \"MA PDU request\":
A) the AMF shall select an SMF with following handlings in case the UE is not
registered for onboarding services in SNPN:
If the S-NSSAI IE is not included and the allowed NSSAI contains:
\- one S-NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the
S-NSSAI;
\- two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains only one default S-NSSAI that is included in the allowed NSSAI, the
AMF shall use the S-NSSAI in the allowed NSSAI that matches the default
S-NSSAI as the S-NSSAI; or
\- two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains zero, two or more default S-NSSAI(s) included in the allowed NSSAI,
the AMF shall use an S-NSSAI in the allowed NSSAI selected based on operator
policy as the S-NSSAI.
If the DNN IE is included, the AMF shall use the UE requested DNN as the DNN
determined by the AMF; and
If the DNN IE is not included, and the user\'s subscription context obtained
from UDM:
\- contains the default DNN for the S-NSSAI, the AMF shall use the default DNN
as the DNN determined by the AMF; and
\- does not contain the default DNN for the S-NSSAI, the AMF shall use a
locally configured DNN as the DNN determined by the AMF;
A1) the AMF shall select an SMF with following handlings in case the UE is
registered for onboarding services in SNPN:
\- if the AMF onboarding configuration data does not contain a configured SMF
used for onboarding services in SNPN and contains the S-NSSAI used for
onboarding services in SNPN, the AMF shall use the S-NSSAI used for onboarding
services in SNPN as the S-NSSAI;
\- if the AMF onboarding configuration data does not contain a configured SMF
used for onboarding services in SNPN and contains the DNN used for onboarding
services in SNPN, the AMF shall use the DNN used for onboarding services in
SNPN as the DNN;
\- if the AMF onboarding configuration data does not contain the S-NSSAI used
for onboarding services in SNPN, does not contain the DNN used for onboarding
services in SNPN, and contains a configured SMF used for onboarding services
in SNPN, the AMF shall select the configured SMF used for onboarding services
in SNPN;
\- if the AMF onboarding configuration data contains the S-NSSAI used for
onboarding services in SNPN, the DNN used for onboarding services in SNPN, or
both, and contains a configured SMF used for onboarding services in SNPN, the
AMF shall use the S-NSSAI used for onboarding services in SNPN, if any, as the
S-NSSAI, and use the DNN used for onboarding services in SNPN, if any, as the
DNN or shall select the configured SMF used for onboarding services in SNPN,
according to local policy; and
\- if the AMF onboarding configuration data contains none of the S-NSSAI used
for onboarding services in SNPN, the DNN used for onboarding services in SNPN
and a configured SMF used for onboarding services in SNPN, the AMF handling is
implementation specific; and
NOTE 2: The AMF can e.g. use a locally configured DNN used for onboarding
services in SNPN as the DNN determined by the AMF.
NOTE 3: SMF selection is outside the scope of the present document.
NOTE 4: As part of SMF selection, the PCF can provide the AMF with a DNN
selected by the network different from the DNN determined by the AMF.
B) if the SMF selection is successful:
\- if the DNN selected by the network is a LADN DNN, the AMF shall determine
the UE presence in LADN service area;
\- the AMF shall store a PDU session routing context for the PDU session ID
and the UE, shall set the SMF ID in the stored PDU session routing context to
the SMF ID corresponding to the DNN in the user\'s subscription context
obtained from the UDM; and
\- the AMF shall send the 5GSM message, the PDU session ID, the S-NSSAI, the
mapped S-NSSAI (in roaming scenarios), the DNN determined by the AMF, DNN
selected by the network (if different from DNN determined by the AMF), the
request type, the MA PDU session information, UE presence in LADN service area
(if DNN received corresponds to an LADN DNN, and the onboarding indication (if
the UE is registered for onboarding services in SNPN) towards the SMF
identified by the SMF ID of the PDU session routing context;
NOTE 5: The MA PDU session information is not sent towards the SMF if the DNN
received corresponds to an LADN DNN.
iv) if the AMF does not have a PDU session routing context for the PDU session
ID and the UE, the Request type IE is included and is set to \"existing PDU
session\" or \"MA PDU request\", and the AMF retrieves an SMF ID associated
with:
A) the PDU session ID matching the PDU session ID received from the UE, if
any; or
B) the DNN matching the DNN received from the UE, otherwise;
such that the SMF ID includes a PLMN identity corresponding to the UE\'s HPLMN
or the current PLMN, then:
A) the AMF shall store a PDU session routing context for the PDU session ID
and the UE, shall set the SMF ID in the stored PDU session routing context to
the retrieved SMF ID; and
B) the AMF shall send the 5GSM message, the PDU session ID, the S-NSSAI, the
mapped S-NSSAI (in roaming scenarios), the DNN (if received) and the request
type towards the SMF identified by the SMF ID of the PDU session routing
context;
v) if the AMF does not have a PDU session routing context for the PDU session
ID and the UE, the Request type IE is included and is set to \"initial
emergency request\", and the AMF does not have a PDU session routing context
for another PDU session ID of the UE indicating that the PDU session is an
emergency PDU session:
A) the AMF shall select an SMF. The AMF shall use the emergency DNN from the
AMF emergency configuration data as the DNN, if configured. The AMF shall
derive the SMF from the emergency DNN or use the statically configured SMF
from the AMF emergency configuration data, if configured; and
B) if the SMF selection is successful:
\- the AMF shall store a PDU session routing context for the PDU session ID
and the UE, shall set the SMF ID in the stored PDU session routing context to
the SMF ID of the selected SMF, and shall store an indication that the PDU
session is an emergency PDU session in the stored PDU session routing context;
and
\- the AMF shall send the 5GSM message, the PDU session ID, the S-NSSAI (if
configured in the AMF emergency configuration data), the DNN (if configured in
the AMF emergency configuration data), and the request type towards the SMF
identified by the SMF ID of the PDU session routing context; and
vi) if the AMF does not have a PDU session routing context for the PDU session
ID and the UE, the Request type IE is included and is set to \"initial
emergency request\", and the AMF has a PDU session routing context indicating
that the PDU session is an emergency PDU session for another PDU session ID of
the UE:
A) the AMF shall store a PDU session routing context for the PDU session ID
and the UE and shall set the SMF ID in the stored PDU session routing context
to the SMF ID of the PDU session routing context for the other PDU session ID
of the UE; and
B) the AMF shall send the 5GSM message, the PDU session ID, the S-NSSAI (if
configured in the AMF emergency configuration data), the DNN (if configured in
the AMF emergency configuration data) and the request type towards the SMF
identified by the SMF ID of the PDU session routing context; or
vii) if the AMF has a PDU session routing context for the PDU session ID and
the UE, the PDU session routing context indicates that the PDU session is an
emergency PDU session, and the Request type IE is included and is set to
\"existing emergency PDU session\", the AMF shall send the 5GSM message, the
PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration
data), the DNN (if configured in the AMF emergency configuration data), and
the request type towards the SMF identified by the SMF ID of the PDU session
routing context; and
viii) if the AMF does not have a PDU session routing context for the PDU
session ID and the UE, the Request type IE is included and is set to
\"existing emergency PDU session\", and the AMF retrieves an SMF ID associated
with emergency services such that the SMF ID includes a PLMN identity
corresponding to the current PLMN, then:
A) the AMF shall store a PDU session routing context for the PDU session ID
and the UE, shall set the SMF ID in the stored PDU session routing context to
the retrieved SMF ID; and
B) the AMF shall send the 5GSM message, the PDU session ID, the S-NSSAI (if
configured in the AMF emergency configuration data), the DNN (if configured in
the AMF emergency configuration data), and the request type towards the SMF
identified by the SMF ID of the PDU session routing context; or
2) the UE and the Old PDU session ID IE in case the Old PDU session ID IE is
included, and:
i) the AMF has a PDU session routing context for the old PDU session ID and
the UE and does not have a PDU session routing context for the PDU session ID
and the UE, the Request type IE is included and is set to \"initial request\",
and the AMF received a reallocation requested indication from the SMF
indicating that the SMF is to be reused, the AMF shall store a PDU session
routing context for the PDU session ID and the UE, set the SMF ID in the
stored PDU session routing context to the SMF ID of the PDU session routing
context for the old PDU session ID and the UE. If the DNN is a LADN DNN, the
AMF shall determine the UE presence in LADN service area. The AMF shall send
the 5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI (if
received), the mapped S-NSSAI (in roaming scenarios), the DNN, the request
type and UE presence in LADN service area (if DNN received corresponds to an
LADN DNN) towards the SMF identified by the SMF ID of the PDU session routing
context;
ii) the AMF has a PDU session routing context for the old PDU session ID and
the UE and does not have a PDU session routing context for the PDU session ID
and the UE, the Request type IE is included and is set to \"initial request\",
and the AMF received a reallocation requested indication from the SMF
indicating that the SMF is to be reallocated:
A) the AMF shall select an SMF with the following handling;
If the S-NSSAI IE is not included and the allowed NSSAI contains:
\- one S-NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the
S-NSSAI;
\- two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains only one default S-NSSAI that is included in the allowed NSSAI, the
AMF shall use the S-NSSAI in the allowed NSSAI that matches the default
S-NSSAI; or
\- two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains zero, two or more default S-NSSAI(s) included in the allowed NSSAI,
the AMF shall use an S-NSSAI in the allowed NSSAI selected based on operator
policy as the S-NSSAI.
If the DNN is a LADN DNN, the AMF shall determine the UE presence in LADN
service area.
B) if the SMF selection is successful:
\- the AMF shall store a PDU session routing context for the PDU session ID
and the UE and set the SMF ID of the PDU session routing context to the SMF ID
of the selected SMF; and
\- the AMF shall send the 5GSM message, the PDU session ID, the old PDU
session ID, the S-NSSAI, the mapped S-NSSAI (in roaming scenarios), the DNN,
the request type, the MA PDU session information and UE presence in LADN
service area (if DNN received corresponds to an LADN DNN) towards the SMF
identified by the SMF ID of the PDU session routing context for the PDU
session ID and the UE;
NOTE 6: The MA PDU session information is not sent towards the SMF if the DNN
received corresponds to an LADN DNN.
b) \"SMS\", the AMF shall send the content of the Payload container IE to the
SMSF associated with the UE;
c) \"LTE Positioning Protocol (LPP) message container\", the AMF shall send
the Payload container type and the content of the Payload container IE to the
LMF associated with the routing information included in the Additional
information IE of the UL NAS TRANSPORT message;
d) \"SOR transparent container\", the AMF shall send the content of the
Payload container IE to the UDM (see 3GPP TS 29.503 [20AB]);
e) \"UE policy container\", the AMF shall send the content of the Payload
container IE to the PCF.
f) \"UE parameters update transparent container\", the AMF shall send the
content of the Payload container IE to the UDM.
g) \"Location services message container\":
1) if the Additional information IE is not included in the UL NAS TRANSPORT
message, the AMF shall provide the Payload container type and the content of
the Payload container IE to the location services application; and
2) if the Additional information IE is included in the UL NAS TRANSPORT
message, the AMF shall send the Payload container type and the content of the
Payload container IE to an LMF associated with routing information included in
the Additional information IE of the UL NAS TRANSPORT message.
h) \"CIoT user data container\", the AMF shall look up a PDU session routing
context for the UE and the PDU session ID, and
1) send the content of the Payload container IE towards the SMF identified by
the SMF ID of the PDU session routing context; and
2) initiate the release of the N1 NAS signalling connection:
i) if the Release assistance indication IE is included in the UL NAS TRANSPORT
message and the DDX field of the Release assistance indication IE indicates
\"No further uplink and no further downlink data transmission subsequent to
the uplink data transmission is expected\" and if there is no downlink
signalling or downlink data for the UE; or
ii) upon subsequent delivery of the next received downlink data transmission
to the UE if the Release assistance indication IE is included in the UL NAS
TRANSPORT message and the DDX field of the Release assistance indication IE
indicates \"Only a single downlink data transmission and no further uplink
data transmission subsequent to the uplink data transmission is expected\" and
if there is no additional downlink signalling or downlink data for the UE.
i) \"Service-level-AA container\" and the Service-level-AA container is
included in the Payload container IE of the UL NAS TRANSPORT message, and the
Service-level device ID included in the Service-level-AA container is set to a
CAA-level UAV ID, the AMF shall send the content of the Payload container IE
to the UAS-NF corresponding to the CAA-level UAV ID. If the Service-level
device ID is not included in the Service-level-AA container and a CAA-level
UAV ID is included in the 5GMM context of the UE, then the AMF shall send the
content of the Payload container IE to the UAS-NF corresponding to the CAA-
level UAV ID included in the 5GMM context of the UE.
j) \"Multiple payloads\", the AMF shall first decode the content of the
Payload container IE (see subclause 9.11.3.39) to obtain the number of payload
container entries and for each payload container entry, the AMF shall:
i) decode the payload container type field;
ii) decode the optional IE fields and the payload container contents field in
the payload container entry; and
iii) handle the content of each payload container entry the same as the
content of the Payload container IE and the associated optional IEs as
specified in bullets a) to i) above according to the payload container type
field.
##### 5.4.5.2.4 UE-initiated NAS transport of messages not accepted by the
network
Upon reception of an UL NAS TRANSPORT message, if the Payload container type
IE is set to \"N1 SM information\" and the UE is not configured for high
priority access in selected PLMN, and:
a) if the Request type IE is set to \"initial request\", \"existing PDU
session\" or \"MA PDU request\";
1) DNN based congestion control is activated for the DNN included in the UL
NAS TRANSPORT message, or DNN based congestion control is activated for the
selected DNN in case of no DNN included in the UL NAS TRANSPORT message, e.g.
configured by operation and maintenance, the AMF shall send back to the UE the
5GSM message which was not forwarded, a back-off timer value and 5GMM cause
#22 \"congestion\" as specified in subclause 5.4.5.3.1 case f);
2) S-NSSAI and DNN based congestion control is activated for the S-NSSAI and
DNN included in the UL NAS TRANSPORT message, or S-NSSAI and DNN based
congestion control is activated for the S-NSSAI included in the UL NAS
TRANSPORT message and the selected DNN in case of no DNN included in the UL
NAS TRANSPORT message, or S-NSSAI and DNN based congestion control is
activated for the selected S-NSSAI in case of no S-NSSAI included in the UL
NAS TRANSPORT message and the DNN included in the UL NAS TRANSPORT message, or
S-NSSAI and DNN based congestion control is activated for the selected S-NSSAI
and the selected DNN in case of no S-NSSAI and no DNN included in the UL NAS
TRANSPORT message, e.g. configured by operation and maintenance, the AMF shall
send back to the UE the 5GSM message which was not forwarded, a back-off timer
value and 5GMM cause #67 \"insufficient resources for specific slice and DNN\"
as specified in subclause 5.4.5.3.1 case f);
3) S-NSSAI only based congestion control is activated for the S-NSSAI included
in the UL NAS TRANSPORT message, or S-NSSAI based congestion control is
activated for the selected S-NSSAI in case of no S-NSSAI included in the UL
NAS TRANSPORT message, e.g. configured by operation and maintenance, the AMF
shall send back to the UE the 5GSM message which was not forwarded, a back-off
timer value and 5GMM cause #69 \"insufficient resources for specific slice\"
as specified in subclause 5.4.5.3.1 case f);
b) void;
c) if the Request type IE is set to \"modification request\" and the PDU
session is not an emergency PDU session;
1) DNN based congestion control is activated for the stored DNN, e.g.
configured by operation and maintenance, the AMF shall send back to the UE the
5GSM message which was not forwarded, a back-off timer value and 5GMM cause
#22 \"congestion\" as specified in subclause 5.4.5.3.1 case f);
2) S-NSSAI and DNN based congestion control is activated for the stored
S-NSSAI and DNN, e.g. configured by operation and maintenance, the AMF shall
send back to the UE the 5GSM message which was not forwarded, a back-off timer
value and 5GMM cause #67 \"insufficient resources for specific slice and DNN\"
as specified in subclause 5.4.5.3.1 case f);
3) S-NSSAI only based congestion control is activated for the stored S-NSSAI,
e.g. configured by operation and maintenance, the AMF shall send back to the
UE the 5GSM message which was not forwarded, a back-off timer value and 5GMM
cause #69 \"insufficient resources for specific slice\" as specified in
subclause 5.4.5.3.1 case f); or
d) the timer T3447 is running and the UE does not support service gap control:
1) the Request type IE:
i) is set to \"initial request\";
ii) is set to \"existing PDU session\"; or
iii) is set to \"modification request\" and the PDU session being modified is
a non-emergency PDU session;
2) the current NAS signalling connection was not triggered by paging; and
3) mobile terminated signalling has not been sent or no user-plane resources
have been established for any PDU session after the establishment of the
current NAS signalling connection,
the AMF shall send back to the UE the message which was not forwarded, send
the 5GMM cause #22 \"Congestion\", and may include a back-off timer set to the
remaining time of the timer T3447 as specified in subclause 5.4.5.3.1 case f).
Upon reception of a UL NAS TRANSPORT message, if the Payload container type IE
is set to \"N1 SM information\", the Request type IE is set to \"initial
request\", \"existing PDU session\" or \"MA PDU request\", and the AMF
determines that the PLMN\'s maximum number of PDU sessions has already been
reached for the UE, the AMF shall send back to the UE the 5GSM message which
was not forwarded and 5GMM cause #65 \"maximum number of PDU sessions
reached\" as specified in subclause 5.4.5.3.1 case h).
Upon reception of a UL NAS TRANSPORT message, if the Payload container type IE
is set to \"N1 SM information\", the Request type IE is set to \"initial
request\", and
a) the UE is in NB-N1 mode;
b) the UE has indicated preference for user plane CIoT 5GS optimization;
c) the network accepted the use of user plane CIoT 5GS optimization; and
d) the AMF determines that there are user-plane resources established for a
number of PDU sessions that is equal to the UE\' s maximum number of supported
user-plane resources (see 3GPP TS 23.501 [8]),
the AMF shall either:
a) send back to the UE the message which was not forwarded as specified in in
subclause 5.4.5.3.1 case h1); or
b) proceed with the PDU session establishment and include the Control Plane
CIoT 5GS Optimisation indication or Control Plane Only indicator to the SMF.
Upon reception of an UL NAS TRANSPORT message, if the Payload container type
IE is set to \"CIoT user data container\", the UE is not configured for high
priority access in selected PLMN, and:
a) the timer T3447 is running and the UE does not support service gap control;
b) the current NAS signalling connection was not triggered by paging; and
c) mobile terminated signalling has not been sent or no user-plane resources
have been established for any PDU session after the establishment of the
current NAS signalling connection;
the AMF shall send back to the UE the CIoT user data which was not forwarded,
send the 5GMM cause #22 \"Congestion\", and include a back-off timer set to
the remaining time of the timer T3447 as specified in subclause 5.4.5.3.1 case
l2).
Upon reception of a UL NAS TRANSPORT message, if the Payload container type IE
is set to \"N1 SM information\", the Request type IE is set to \"existing PDU
session\", and
a) the UE is in NB-N1 mode;
b) the UE has indicated preference for user plane CIoT 5GS optimization;
c) the network accepted the use of user plane CIoT 5GS optimization; and
d) the AMF determines that there are user-plane resources established for a
number of PDU sessions that equals to the UE\'s maximum number of supported
user-plane resources (see 3GPP TS 23.501 [8]),
the AMF shall send back to the UE the message which was not forwarded as
specified in in subclause 5.4.5.3.1 case h1).
Upon reception of an UL NAS TRANSPORT message, if the Payload container type
IE is set to \"N1 SM information\", the Request type IE is set to \"initial
request\" or \"modification request\", the associated S-NSSAI that the AMF
determined through the S-NSSAI IE or the PDU session ID IE is an S-NSSAI for
which the AMF is performing NSSAA, and the AMF determines to not forward the
5GSM message to the SMF based on local policy, the AMF shall send back to the
UE the 5GSM message which was not forwarded as specified in subclause
5.4.5.3.1 case h2).
Upon reception of an UL NAS TRANSPORT message, if the Payload container type
IE is set to \"SMS\" or \"LTE Positioning Protocol (LPP) message container\",
the UE is not configured for high priority access in selected PLMN, and:
a) the timer T3447 is running and the UE does not support service gap control;
b) the current NAS signalling connection was not triggered by paging; and
c) mobile terminated signalling has not been sent or no user-plane resources
have been established for any PDU session after the establishment of the
current NAS signalling connection;
the AMF shall abort the procedure.
NOTE 1: In this state the NAS signalling connection can be released by the
network.
Upon reception of an UL NAS TRANSPORT message, if the Payload container type
IE is set to \"N1 SM information\", the Request type IE is set to \"initial
request\", and:
a) the determined DNN, S-NSSAI or both DNN and S-NSSAI are identified for UAS
services; and
b) the UE is marked in the UE\'s 5GMM context that it is not allowed to
request UAS services;
the AMF shall send back to the UE the 5GSM message which was not forwarded as
specified in subclause 5.4.5.3.1 case h4).
NOTE 2: The UE marked in the UE\'s 5GMM context as not allowed to request UAS
services happens in the case that the UUAA-MM procedure needs to be performed
during the registration procedure according to operator policy.
##### 5.4.5.2.5 Abnormal cases on the network side
The following abnormal cases in AMF are identified:
a) If the Payload container type IE is set to \"N1 SM information\" and:
1) if the Old PDU session ID IE is not included in the UL NAS TRANSPORT
message, the AMF does not have a PDU session routing context for the PDU
session ID and the UE, the Request type IE is set to \"initial request\" or
\"MA PDU request\", and the SMF selection fails, then the AMF shall send back
to the UE the 5GSM message which was not forwarded as specified in subclause
5.4.5.3.1 case e) or case f);
2) if the Old PDU session ID IE is included in the UL NAS TRANSPORT message,
the AMF has a PDU session routing context for the old PDU session ID and the
UE and does not have a PDU session routing context for the PDU session ID and
the UE, the Request type IE is set to \"initial request\", the AMF received a
reallocation requested indication from the SMF indicating that the SMF is to
be reallocated, and the SMF selection fails, then the AMF shall send back to
the UE the 5GSM message which was not forwarded as specified in subclause
5.4.5.3.1 case e) or case f);
3) if the AMF does not have a PDU session routing context for the PDU session
ID and the UE, the Request type IE is set to \"existing PDU session\" or \"MA
PDU request\", and the user\'s subscription context obtained from the UDM does
not contain an SMF ID for the PDU session ID matching the PDU session ID
received from the UE or for the DNN matching the DNN received from the UE such
that the SMF ID includes a PLMN identity corresponding to the UE\'s HPLMN or
the current PLMN or the PLMN ID part of the current SNPN, then the AMF may
send back to the UE the 5GSM message which was not forwarded as specified in
subclause 5.4.5.3.1 case e) or case f).
4) if the Old PDU session ID IE is included in the UL NAS TRANSPORT message,
and the AMF has a PDU session routing context for the old PDU session ID and
the UE and does not have a PDU session routing context for the PDU session ID
and the UE, the Request type IE is set to \"initial request\" and the AMF has
not received a reallocation requested indication, the AMF should select an SMF
with following handlings:
i) if the S-NSSAI IE is not included and the allowed NSSAI contains:
A) one S-NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the
S-NSSAI;
B) two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains only one default S-NSSAI that is included in the allowed NSSAI, the
AMF shall use the S-NSSAI in the allowed NSSAI as the S-NSSAI; or
C) two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains zero, two or more default S-NSSAI(s) included in the allowed NSSAI,
the AMF shall use an S-NSSAI in the allowed NSSAI selected based on operator
policy as the S-NSSAI;
ii) if the DNN IE is not included, and the user\'s subscription context
obtained from UDM:
A) contains the default DNN for the S-NSSAI, the AMF shall use the default DNN
as the DNN; and
B) does not contain the default DNN for the S-NSSAI, the AMF shall use a
locally configured DNN as the DNN;
iii) if the DNN selected by the network is a LADN DNN, the AMF shall determine
the UE presence in LADN service area;
iv) if the SMF selection is successful, the AMF should store a PDU session
routing context for the PDU session ID and the UE, set the SMF ID in the
stored PDU session routing context to the selected SMF ID, and forward the
5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI, the
mapped S-NSSAI (in roaming scenarios), the DNN determined by the AMF, DNN
selected by the network (if different from DNN determined by the AMF), the
request type and UE presence in LADN service area (if DNN selected by the
network corresponds to an LADN DNN) towards the SMF ID of the PDU session
routing context; and
v) if the SMF selection fails, then the AMF shall send back to the UE the 5GSM
message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or
case f);
5) if the AMF has a PDU session routing context for the PDU session ID and the
UE, the PDU session routing context indicates that the PDU session is an
emergency PDU session, the Request type IE is set to \"initial emergency
request\", the AMF should forward the 5GSM message, the PDU session ID, the
S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if
configured in the AMF emergency configuration data) and the request type
towards the SMF ID of the PDU session routing context;
6) if the Request type IE is set to \"initial emergency request\" and the
S-NSSAI or the DNN is received, the AMF ignores the received S-NSSAI or the
DNN and uses the emergency DNN from the AMF emergency configuration data, if
any;
7) if the AMF does not have a PDU session routing context for the PDU session
ID and the UE, and the Request type IE of the UL NAS TRANSPORT message is
either not provided or is provided but set to other value than \"initial
request\", \"existing PDU session\", \"initial emergency request\", \"existing
emergency PDU session\" and \"MA PDU request\", then the AMF may send back to
the UE the 5GSM message which was not forwarded as specified in subclause
5.4.5.3.1 case e) or case f);
8) if the AMF unsuccessfully attempted to forward the 5GSM message, the PDU
session ID, the S-NSSAI, the mapped S-NSSAI (in roaming scenarios), the DNN
and the request type (if received) towards a SMF ID, then the AMF may send
back to the UE the 5GSM message which was not forwarded as specified in
subclause 5.4.5.3.1 case e) or case f).
9) if the Old PDU session ID IE is included in the UL NAS TRANSPORT message,
the AMF does not have a PDU session routing context for the old PDU session ID
and the UE, the AMF does not have a PDU session routing context for the PDU
session ID and the UE, the Request type IE is set to \"initial request\", the
AMF should select an SMF with following handlings:
i) if the S-NSSAI IE is not included and the allowed NSSAI contains:
A) one S-NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the
S-NSSAI;
B) two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains only one default S-NSSAI that is included in the allowed NSSAI, the
AMF shall use the default S-NSSAI in the allowed NSSAI as the S-NSSAI; or
C) two or more S-NSSAIs and the user\'s subscription context obtained from UDM
contains zero, two or more default S-NSSAI(s) included in the allowed NSSAI,
the AMF shall use an S-NSSAI in the allowed NSSAI selected based on operator
policy as the S-NSSAI.
ii) if the DNN IE is not included, and the user\'s subscription context
obtained from UDM:
A) contains the default DNN for the S-NSSAI, the AMF shall use the default DNN
as the DNN; and
B) does not contain the default DNN for the S-NSSAI, the AMF shall use a
locally configured DNN as the DNN;
iii) if the DNN selected by the network is a LADN DNN, the AMF shall determine
the UE presence in LADN service area;
iv) if the SMF selection is successful, the AMF should store a PDU session
routing context for the PDU session ID and the UE, set the SMF ID in the
stored PDU session routing context to the selected SMF ID, and forward the
5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI, the
mapped S-NSSAI (in roaming scenarios), the DNN determined by the AMF, DNN
selected by the network (if different from DNN determined by the AMF), the
request type and UE presence in LADN service area (if DNN selected by the
network corresponds to an LADN DNN) towards the SMF ID of the PDU session
routing context; and
v) if the SMF selection fails, then the AMF shall send back to the UE the 5GSM
message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or
case f);
10) if the AMF has a PDU session routing context for the PDU session ID and
the UE, the PDU session routing context indicates that the PDU session is not
an emergency PDU session, and the Request type IE is included and is set to
\"existing emergency PDU session\", the AMF may send back to the UE the 5GSM
message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or
case f);
11) if the AMF has a PDU session routing context for the PDU session ID and
the UE, the PDU session routing context indicates that the PDU session is an
emergency PDU session, and the Request type IE is included and is set to
\"existing PDU session\", the AMF may forward the 5GSM message, the PDU
session ID, the S-NSSAI (if configured in the AMF emergency configuration
data), the DNN (if configured in the AMF emergency configuration data), and
the request type towards the SMF identified by the SMF ID of the PDU session
routing context;
12) if the AMF has a PDU session routing context for the PDU session ID and
the UE, the Request type IE is set to \"initial request\", then the AMF shall
perform a local release of the PDU session identified by the PDU session ID
and shall request the SMF to perform a local release of the PDU session, and
proceed as specified in subclause 5.4.5.2.3;
13) if the Request type IE is set to \"initial request\" or \"modification
request\", and the S-NSSAI IE contains an S-NSSAI that is not allowed by the
network, then the AMF shall send back to the UE the 5GSM message which was not
forwarded as specified in subclause 5.4.5.3.1 case e), case f) or h4);
14) if the Request type IE is set to \"existing PDU session\", the AMF has a
PDU session routing context for the PDU session ID and the UE, the PDU session
routing context indicates that the PDU session is not an emergency PDU
session, and the S-NSSAI associated with the PDU session identified by the PDU
session ID is not allowed for the target access type, the AMF shall send back
to the UE the 5GSM message which was not forwarded as specified in subclause
5.4.5.3.1 case e), case f) or h4);
15) if the Request type IE is set to \"initial request\", \"existing PDU
session\", \"modification request\" or \"MA PDU request\", the UE is not
configured for high priority access in selected PLMN, and the UE is in non-
allowed area or is not in allowed area, the AMF shall send back to the UE the
5GSM message which was not forwarded, and 5GMM cause #28 \"Restricted service
area\" as specified in subclause 5.4.5.3.1 case i);
15a) if the Request type IE is set to \"initial request\" or \"initial
emergency request\" and the AMF determines that the UE has registered to a
PLMN via a satellite NG-RAN cell that is not allowed to operate at the present
UE location, then the AMF may send back to the UE the 5GSM message which was
not forwarded as specified in subclause 5.4.5.3.1 case i1); and
16) if the Request type IE is set to \"initial request\" or \"MA PDU
request\", the AMF is pending the receipt of a REGISTRATION REQUEST message
indicating \"mobility registration updating\" in the 5GS registration type IE,
and an emergency PDU session exists for the UE (see subclause 5.4.4.3), the
AMF shall send back to the UE the 5GSM message which was not forwarded as
specified in subclause 5.4.5.3.1 case e) or case f);
17) if the timer T3447 is running and the UE supports service gap control and:
i) the Request type IE:
A) is set to \"initial request\";
B) is set to \"existing PDU session\"; or
C is set to \"modification request\" and the PDU session being modified is a
non-emergency PDU session;
ii) the UE is not configured for high priority access in selected PLMN;
iii) the current NAS signalling connection was not triggered by paging; and
iv) mobile terminated signalling has not been sent or no user-plane resources
have been established for any PDU session after the establishment of the
current NAS signalling connection,
then the AMF shall send back to the UE the 5GSM message which was not
forwarded as specified in subclause 5.4.5.3.1 case e) or case f);
18) if the AMF has a PDU session routing context for the PDU session ID and
the UE, the Request type IE is not included, the UE is not configured for high
priority access in selected PLMN, and the PDU session is not an emergency PDU
session, then the AMF shall forward the 5GSM message, and the PDU session ID
IE towards the SMF identified by the SMF ID of the PDU session routing context
with:
i) an exemptionInd attribute indicating \"message was exempted from the DNN
based congestion activated in the AMF\" as specified in 3GPP TS 29.502 [20A],
if DNN based congestion control is activated for the selected DNN;
ii) an exemptionInd attribute indicating \"message was exempted from the
S-NSSAI and DNN based congestion activated in the AMF\" as specified in 3GPP
TS 29.502 [20A], if S-NSSAI and DNN based congestion control is activated for
the selected S-NSSAI and the selected DNN; or
iii) an exemptionInd attribute indicating \"message was exempted from the
S-NSSAI only based congestion activated in the AMF\" as specified in 3GPP TS
29.502 [20A], if S-NSSAI only based congestion control is activated for the
selected S-NSSAI;
19) if the Request type IE is set to \"MA PDU request\" and the S-NSSAI IE
contains an S-NSSAI that is not allowed by the network on neither access, then
the AMF shall send to the UE the 5GSM message which was not forwarded as
specified in subclause 5.4.5.3.1 case e) or case f);
20) if the Request type IE is set to \"initial request\" and the UE is
registered for emergency services over the current access, then the AMF may
send back to the UE the 5GSM message which was not forwarded as specified in
subclause 5.4.5.3.1 case e) or case f); and
21) if the Request type IE is set to \"existing PDU session\", the UE is
attempting to transfer a PDU session from 3GPP access to non-3GPP access, and
the PDU session is associated with control plane only indication then the AMF
shall send back to the UE the 5GSM message which was not forwarded as
specified in subclause 5.4.5.3.1 case e).
22) if the Request type IE is set to \"MA PDU request\" and the UE requested
DNN corresponds to an LADN DNN, the AMF shall send back to the UE the 5GSM
message which was not forwarded and 5GMM cause #90 \"payload was not
forwarded\" as specified in subclause 5.4.5.3.1 case hx).
23) if the Request type IE is set to \"initial request\", the UE requested DNN
corresponds to an LADN DNN, and the MA PDU session information IE is included,
the AMF shall not forward the MA PDU session information towards the SMF.
24) if the Request type IE is set to \"modification request\", the DNN
associated with the PDU session corresponds to an LADN DNN, and MA PDU session
information IE is included, the AMF shall not forward the MA PDU session
information towards the SMF.
b) If the Payload container type IE is set to \"SMS\" and the AMF does not
have an SMSF address associated with the UE or the AMF cannot forward the
content of the Payload container IE to the SMSF associated with the SMSF
address available in the AMF, the AMF shall abort the procedure.
c) If the Payload container type IE is set to \"LTE Positioning Protocol (LPP)
message container\" and if the Additional information IE is not included in
the UL NAS TRANSPORT message or the AMF cannot forward the content of the
Payload container IE to the LMF associated with the routing information
included in the Additional information IE, the AMF shall abort the procedure.
d) If the Payload container type IE is set to \"UE policy container\" and the
AMF does not have a PCF address associated with the UE or the AMF cannot
forward the content of the Payload container IE to the PCF associated with the
PCF address available in the AMF, the AMF shall abort the procedure.
e) If the Payload container type IE is set to \"Location services message
container\" and if the Additional information IE is included in the UL NAS
TRANSPORT message and the AMF cannot forward the content of the Payload
container IE to an LMF associated with the routing information included in the
Additional information IE, the AMF shall abort the procedure.
f) If the Payload container type IE is set to \"SMS\" or \"LTE Positioning
Protocol (LPP) message container\":
1) the timer T3447 is running and the UE supports service gap control;
2) the UE is not configured for high priority access in selected PLMN;
3) the current NAS signalling connection was not triggered by paging; and
4) mobile terminated signalling has not been sent or no user-plane resources
have been established for any PDU session after the establishment of the
current NAS signalling connection,
the AMF shall abort the procedure.
NOTE: In this state the N1 NAS signalling connection can be released by the
network.
g) If the Payload container type IE is set to \"CIoT user data container\"
and:
1) if the AMF does not have a PDU session routing context for the PDU session
ID and the UE; or
2) if the AMF unsuccessfully attempted to forward the user data container and
the PDU session ID,
then the AMF may send back to the UE the CIoT user data container which was
not forwarded as specified in subclause 5.4.5.3.1 case l1).
h) If the Payload container type IE is set to \"CIoT user data container\":
1) if the timer T3447 is running and the UE supports service gap control;
2) the UE is not configured for high priority access in selected PLMN;
3) the current N1 NAS signalling connection was not triggered by paging; and
4) mobile terminated signalling has not been sent or no user-plane resources
have been established for any PDU session after the establishment of the
current NAS signalling connection,
then the AMF shall send back to the UE the CIoT user data container which was
not forwarded as specified in subclause 5.4.5.3.1 case l1).
##### 5.4.5.2.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) The lower layers indicate that the access attempt is barred.
The UE shall not start the UE-initiated NAS transport procedure. The UE stays
in the current serving cell and applies the normal cell reselection process.
If the access category for the access attempt is 6 due to a request from upper
layers to send a mobile originated SMS over NAS and the UE is registered to
the network via both 3GPP access and non-3GPP access, the UE may transmit the
UL NAS TRANSPORT message via non-3GPP access, if available.
Otherwise, the UE-initiated NAS transport procedure is started, if still
needed, when the lower layers indicate that the barring is alleviated for the
access category with which the access attempt was associated.
aa) The lower layers indicate that:
1) access barring is applicable for all access categories except categories 0
and 2 and the access category with which the access attempt was associated is
other than 0 and 2; or
2) access barring is applicable for all access categories except category 0
and the access category with which the access attempt was associated is other
than 0.
The UE shall proceed as specified for case a. For additional UE requirements
see subclause 4.5.5.
b) If the Payload container type IE is set to \"N1 SM information\", the
Request type IE is set to \"initial request\" or \"MA PDU request\" and
registration procedure for mobility and periodic registration update is
pending due to receipt by the UE of new network slicing information via the
generic UE configuration update procedure with re-registration request; and an
emergency PDU session exists then:
1) The UE shall not send the UL NAS TRANSPORT message; and
2) The UL NAS TRANSPORT message can be sent, if still necessary, after a
successful procedure for mobility and periodic registration update.
c) Transmission failure of the UL NAS TRANSPORT message with change in the
current TAI.
If the current TAI is not in the TAI list, the UE-initiated NAS transport
procedure shall be aborted and a registration procedure for mobility and
periodic registration update shall be initiated. The UL NAS TRANSPORT message
can be sent, if still necessary, after a successful procedure for mobility and
periodic registration update.
If the current TAI is still part of the TAI list, it is up to the UE
implementation how to re-run the ongoing procedure that triggered the UE-
initiated NAS transport procedure.
d) Transmission failure of the UL NAS TRANSPORT message indication without
change in the current TAI.
It is up to the UE implementation how to re-run the ongoing procedure that
triggered the UE-initiated NAS transport procedure.
e) Void.
f) Timer T3447 is running.
The UE shall not send the UL NAS TRANSPORT message unless:
1) the Payload container type IE is set to \"N1 SM information\" and:
i) the Request type IE is set to:
A) \"initial emergency request\";
B) \"existing emergency PDU session\"; or
C) \"modification request\" and the PDU session being modified is an emergency
PDU session (see error cases described in subclause 6.4.1.3 and subclause
6.3.2.3); or
ii) the Request type IE is not included and the PDU session modification
procedure is used to indicate a change of 3GPP PS data off UE status for a PDU
session;
2) the UE is a UE configured for high priority access in selected PLMN;
3) a paging request triggered the establishment of the current NAS signalling
connection; or
4) the UE in 5GMM-CONNECTED mode receives mobile terminated signalling or
downlink data over the user-plane.
The UL NAS TRANSPORT message can be sent, if still necessary, when timer T3447
expires or timer T3447 is stopped.
g) The lower layers indicate that the RRC connection has been suspended.
The UE shall abort the UE-initiated NAS transport procedure.
h) Timer T3346 is running.
The UE shall not send the UL NAS TRANSPORT message unless:
1) the Payload container type IE is set to \"N1 SM information\" and:
i) the Request type IE is set to:
A) \"initial emergency request\";
B) \"existing emergency PDU session\"; or
C) \"modification request\" and the PDU session being modified is an emergency
PDU session; or
ii) the Request type IE is not included and the PDU session modification
procedure is used to indicate a change of 3GPP PS data off UE status for a PDU
session; or
2) the UE is a UE configured for high priority access in selected PLMN.
The UL NAS TRANSPORT message can be sent, if still necessary, when timer T3346
expires.
i) NAS MAC calculation indication from lower layers.
If lower layers indicate to calculate an NAS MAC, the UE shall calculate an
NAS MAC as specified in 3GPP TS 33.501 [24] and then provide the calculated
NAS MAC and 5 least significant bits of the uplink NAS COUNT used to calculate
the NAS MAC to lower layers (see 3GPP TS 36.331 [25A]). The UE shall increase
the uplink NAS COUNT by one after the calculation of the NAS MAC.
#### 5.4.5.3 Network-initiated NAS transport procedure
##### 5.4.5.3.1 General
The purpose of the network-initiated NAS transport procedure is to provide a
transport of:
a) a single 5GSM message;
b) SMS;
c) an LPP message;
d) an SOR transparent container;
e) a single uplink 5GSM message which was not forwarded due to routing
failure;
f) a single uplink 5GSM message which was not forwarded due to congestion
control;
g) a UE policy container;
h) a single uplink 5GSM message which was not forwarded, because the PLMN\'s
maximum number of PDU sessions has been reached;
h1) a single uplink 5GSM message which was not forwarded, because the maximum
number of PDU sessions with active user-plane resources has been reached;
h2) a single uplink 5GSM message which was not forwarded, because of ongoing
network slice-specific authentication and authorization procedure for the
S-NSSAI that is requested;
h3) a single uplink 5GSM message which was not forwarded, because the UE
requested to establish an MA PDU session for LADN DNN;
h4) a single uplink 5GSM message which was not forwarded, because **the
maximum number of UEs** for a network slice has been reached;
h5) a single uplink 5GSM message which was not forwarded because the UE is
marked in the UE\'s 5GMM context that it is not allowed to request UAS
services;
i) a single uplink 5GSM message which was not forwarded due to service area
restrictions;
i1) a single uplink 5GSM message which was not forwarded because the UE is
registered to a PLMN via a satellite NG-RAN cell that is not allowed to
operate at the present UE location;
j) a UE parameters update transparent container;
k) a location services message;
l) a CIoT user data container;
l1) a single uplink CIoT user data container or control plane user data which
was not forwarded due to routing failure;
l2) a single uplink CIoT user data container which was not forwarded due to
congestion control;
m) a service-level-AA container;
m1) an event notification for upper layers; or
n) multiple of the above types.
from the AMF to the UE in a 5GMM message.
##### 5.4.5.3.2 Network-initiated NAS transport procedure initiation
In 5GMM-CONNECTED mode, the AMF initiates the NAS transport procedure by
sending the DL NAS TRANSPORT message, as shown in figure 5.4.5.3.2.1.
In case a) in subclause 5.4.5.3.1, i.e. upon reception from an SMF of a 5GSM
message without an N1 SM delivery skip allowed indication for a UE or a 5GSM
message with an N1 SM delivery skip allowed indication for a UE in the 5GMM-
CONNECTED mode, the AMF shall:
a) include the PDU session information (PDU session ID) in the PDU session ID
IE;
b) set the Payload container type IE to \"N1 SM information\"; and
c) set the Payload container IE to the 5GSM message.
In case b) in subclause 5.4.5.3.1, i.e. upon reception from an SMSF of an SMS
payload, the AMF shall:
a) set the Payload container type IE to \"SMS\";
b) set the Payload container IE to the SMS payload; and
c) select the access type to deliver the DL NAS TRANSPORT message as follows
in case the access type selection is required:
1) if the UE to receive the DL NAS TRANSPORT message is registered to the
network via both 3GPP access and non-3GPP access, the 5GMM context of the UE
indicates that SMS over NAS is allowed, the UE is in MICO mode, and the UE is
in 5GMM-IDLE mode for 3GPP access and in 5GMM-CONNECTED mode for non-3GPP
access, then the AMF selects non-3GPP access. Otherwise, the AMF selects
either 3GPP access or non-3GPP access.
If the delivery of the DL NAS TRANSPORT message over 3GPP access has failed,
the AMF may re-send the DL NAS TRANSPORT message over the non-3GPP access.
If the delivery of the DL NAS TRANSPORT message over non-3GPP access has
failed, the AMF may re-send the DL NAS TRANSPORT message over the 3GPP access;
and
2) otherwise, the AMF selects 3GPP access.
NOTE 1: The AMF selects an access type between 3GPP access and non-3GPP access
based on operator policy.
In case c) in subclause 5.4.5.3.1 i.e. upon reception from an LMF of an LPP
message payload, the AMF shall:
a) set the Payload container type IE to \"LTE Positioning Protocol (LPP)
message container\";
b) set the Payload container IE to the LPP message payload received from the
LMF;
c) set the Additional information IE to an LCS correlation identifier received
from the LMF from which the LPP message was received.
NOTE 2: The LCS Correlation Identifier is assigned originally by the AMF
except for LPP message transfer associated with event reporting for periodic
or triggered location as described in subclause 6.3.1 of 3GPP TS 23.273 [6B],
where the LMF assigns the correlation identifier. AMF and LMF assigned
correlation identifiers can be distinguished by an implementation specific
convention (e.g. use of a different number of octets) to enable an AMF to
distinguish one from the other when received in the Additional Information IE
in an UL NAS Transport message.
In case d) in subclause 5.4.5.3.1 i.e. upon reception of a steering of roaming
information (see 3GPP TS 23.122 [5]) from the UDM to be forwarded to the UE,
the AMF shall:
a) set the Payload container type IE to \"SOR transparent container\"; and
b) set the Payload container IE to the steering of roaming information
received from the UDM (see 3GPP TS 29.503 [20AB]).
In case e) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded due to routing failure, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
d) set the 5GMM cause IE to the 5GMM cause #90 \"payload was not forwarded\"
or 5GMM cause #91 \"DNN not supported or not subscribed in the slice\".
The AMF sets the 5GMM cause IE to the 5GMM cause #91 \"DNN not supported or
not subscribed in the slice\", if the 5GSM message could not be forwarded
since SMF selection fails because:
1) the DNN is not supported in the slice identified by the S-NSSAI used by the
AMF; or
2) neither the DNN provided by the UE nor the wildcard DNN are in the
subscribed DNN list of the UE for the S-NSSAI used by the AMF.
Otherwise, the AMF sets the 5GMM cause IE to the 5GMM cause #90 \"payload was
not forwarded\"; and
e) optionally include the Back-off timer value IE if the 5GMM cause IE is set
to 5GMM cause #91 \"DNN not supported or not subscribed in the slice\" due to
the DNN is not supported in the slice.
In case f) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded due to congestion control, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
d) set the 5GMM cause IE to the 5GMM cause #22 \"Congestion\", the 5GMM cause
#67 \"insufficient resources for specific slice and DNN\" or the 5GMM cause
#69 \"insufficient resources for specific slice\"; and
e) include the Back-off timer value IE.
In case g) in subclause 5.4.5.3.1, i.e. upon reception of a UE policy
container from the PCF to be forwarded to the UE, the AMF shall:
a) set the Payload container type IE to \"UE policy container\"; and
b) set the Payload container IE to the UE policy container received from the
PCF.
In case h) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded, because the PLMN\'s maximum number of PDU
sessions has been reached, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #65 \"maximum number of PDU
sessions reached\".
In case h1) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded, because the maximum number of PDU sessions
with active user-plane resources has been reached, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #92 \"insufficient user-plane
resources for the PDU session\".
In case h2) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded because the UE requested to establish a PDU
session associated with an S-NSSAI or to modify a PDU session associated with
an S-NSSAI for which:
a) the AMF is performing network slice-specific authentication and
authorization and determined to reject the request based on local policy; or
b) the network slice-specific authentication and authorization has failed or
the authorization has been revoked;
the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #90 \"payload was not forwarded\".
In case h3) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded because the UE requested to establish an MA
PDU session for LADN DNN, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #90 \"payload was not forwarded\".
In case h4) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded, because the maximum number of UEs for a
network slice has been reached, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
d) set the 5GMM cause IE to the 5GMM cause #69 \"insufficient resources for
specific slice\"; and
e) include the Back-off timer value IE.
For case h5) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded because the UE is marked in the UE\'s 5GMM
context that it is not allowed to request UAS services, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #79 \"UAS services not allowed\".
In case i) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded due to service area restrictions, the AMF
shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #28 \"Restricted service area\".
In case i1) in subclause 5.4.5.3.1, i.e. upon sending a single uplink 5GSM
message which was not forwarded because the UE is registered to a PLMN via a
satellite NG-RAN cell that is not allowed to operate at the present UE
location, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"N1 SM information\";
c) set the Payload container IE to the 5GSM message which was not forwarded;
and
d) set the 5GMM cause IE to the 5GMM cause #78 \"PLMN not allowed to operate
at the present UE location\".
In case j) in subclause 5.4.5.3.1 i.e. upon reception of UE parameters update
data (see 3GPP TS 23.502 [9]) from the UDM to be forwarded to the UE, the AMF
shall:
a) set the Payload container type IE to \"UE parameters update transparent
container\"; and
b) set the contents of the Payload container IE to the UE parameters update
data (see 3GPP TS 23.502 [9]) received from the UDM.
For case k) in subclause 5.4.5.3.1 upon reception from a location services
application of a Location services message payload, the AMF shall:
a) set the Payload container type IE to \"Location services message
container\"; and
b) set the Payload container IE to the Location services message payload.
For case k) in subclause 5.4.5.3.1 upon reception from an LMF of a Location
services message payload, the AMF shall:
a) set the Payload container type IE to \"Location services message
container\";
b) set the Payload container IE to the Location services message payload; and
c) set the Additional information IE to routing information associated with
the LMF from which the Location services message payload was received.
NOTE 3: Case k) in subclause 5.4.5.3.1 supports transport of a Location
services message container between a UE and an AMF and between a UE and an
LMF. For transport between a UE and an LMF, the Additional information IE is
included and provides routing information for the LMF. For transport between a
UE and an AMF, the Additional information IE is not included.
In case l) in subclause 5.4.5.3.1, i.e. upon reception from an SMF of a user
data container payload, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \"CIoT user data container\"; and
c) set the Payload container IE to the user data container.
For case l1) in subclause 5.4.5.3.1, i.e. upon sending a single uplink CIoT
user data container or control plane user data which was not forwarded due to
routing failure, the AMF shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \" CIoT user data container\";
c) set the Payload container IE to the CIoT user data container or control
plane user data which was not forwarded; and
d) set the 5GMM cause IE to the 5GMM cause #90 \"payload was not forwarded\".
NOTE 4: For case l1) in subclause 5.4.5.3.1, this is also applied for a single
uplink CIoT user data container or control plane user data in the CONTROL
PLANE SERVICE REQUEST message which was not forwarded due to routing failure.
For case l2) in subclause 5.4.5.3.1, i.e. upon sending a single uplink CIoT
user data container which was not forwarded due to congestion control, the AMF
shall:
a) include the PDU session ID in the PDU session ID IE;
b) set the Payload container type IE to \" CIoT user data container\";
c) set the Payload container IE to the CIoT user data container which was not
forwarded;
d) set the 5GMM cause IE to the 5GMM cause #22 \"Congestion\", the 5GMM cause
#67 \"insufficient resources for specific slice and DNN\" or the 5GMM cause
#69 \"insufficient resources for specific slice\", and include the Back-off
timer value IE.
In case m) in subclause 5.4.5.3.1, during UUAA-MM procedure, if the AMF
receives a payload from the UAS-NF, the AMF shall:
a) include the service-level-AA payload with the value set to the payload; and
b) if a payload type associated with the payload is received, include the
service-level-AA payload type with the value set to the payload type
in the Service-level-AA container IE.
In case m1) in subclause 5.4.5.3.1, i.e. if the AMF needs to send an event
notification indicator for upper layers to the UE which set the
\"EventNotification\" bit of the 5GMM capability IE in the last REGISTRATION
REQUEST message to \"Event notification supported\", the AMF shall:
a) set the Payload container type IE to \"Event notification\"; and
b) set the Payload container IE to the event notification indicator.
In case n) in subclause 5.4.5.3.1, the AMF shall:
a) set the Payload container type IE to \"Multiple payloads\";
b) set each payload container entry of the Payload container IE (see subclause
9.11.3.39) as follows:
i) set the payload container type field of the payload container entry to a
payload container type value set in the Payload container type IE as specified
for cases a) to m) above;
ii) set the payload container entry contents field of the payload container
entry to the payload container contents set in the Payload container IE as
specified for cases a) to m) above;
iii) set the optional IE fields, if any, to the optional associated
information as specified for cases a) to m) above.
Figure 5.4.5.3.2.1: Network-initiated NAS transport procedure
##### 5.4.5.3.3 Network-initiated NAS transport of messages
Upon reception of a DL NAS TRANSPORT message, the UE shall stop the timer
T3346 if running.
Upon reception of a DL NAS TRANSPORT message, if the Payload container type IE
is set to:
a) \"N1 SM information\" and the 5GMM cause IE is not included in the DL NAS
TRANSPORT message, the 5GSM message in the Payload container IE and the PDU
session ID are handled in the 5GSM procedures specified in clause 6;
b) \"SMS\", the UE shall forward the content of the Payload container IE to
the SMS stack entity;
c) \"LTE Positioning Protocol (LPP) message container\", the UE shall forward
the payload container type, the content of the Payload container IE and the
routing information included in the Additional information IE to the upper
layer location services application;
d) \"SOR transparent container\" and if the Payload container IE:
1) successfully passes the integrity check (see 3GPP TS 33.501 [24]), the ME
shall store the received SOR counter as specified in annex C and proceed as
follows:
i) If the Payload container IE indicates a list of preferred PLMN/access
technology combinations is provided and the list type indicates \"PLMN ID and
access technology list\", then the ME shall replace the highest priority
entries in the \"Operator Controlled PLMN Selector with Access Technology\"
list stored in the ME;
ii) If the list type indicates \"secured packet\", then the ME shall behave as
if a SMS is received with protocol identifier set to SIM data download, data
coding scheme set to class 2 message and SMS payload as secured packet
contents of SOR transparent container IE. The SMS payload is forwarded to UICC
as specified in 3GPP TS 23.040 [4A];
iii) If the Payload container IE includes SOR-SNPN-SI, the ME shall replace
SOR-SNPN-SI of the selected entry of the \"list of subscriber data\" or
associated with the selected PLMN subscription, as specified in 3GPP TS 23.122
[5] with the received SOR-SNPN-SI; and
iv) If the SOR-CMCI is present, in plain text, and the Store SOR-CMCI in ME
indicator is set to \"Store SOR-CMCI in ME\" then the UE shall store or delete
the SOR-CMCI in the non-volatile memory of the ME as described in annex C.1;
If the ACK bit of the SOR header for SOR data type in the SOR transparent
container is set to \"acknowledgement requested\" and the list type indicates:
A) \"PLMN ID and access technology list\"; or
B) \"secured packet\" and the ME receives status bytes from the UICC
indicating that the UICC has received the secured packet successfully;
then the ME shall send an acknowledgement in the Payload container IE of an UL
NAS TRANSPORT message with Payload type IE set to \"SOR transparent
container\" as specified in subclause 5.4.5.2.2. In the Payload container IE
carrying the acknowledgement, the UE shall set the ME support of SOR-CMCI
indicator to \"SOR-CMCI supported by the ME\". Additionally, if the UE
supports access to an SNPN using credentials from a credentials holder and the
UE is not operating in SNPN access operation mode, the UE may set the ME
support of SOR-SNPN-SI indicator to \"SOR-SNPN-SI supported by the ME\".
The UE shall proceed with the behaviour as specified in 3GPP TS 23.122 [5]
annex C; or
2) does not successfully pass the integrity check (see 3GPP TS 33.501 [24])
then the UE shall discard the content of the payload container IE and proceed
with the behaviour as specified in 3GPP TS 23.122 [5] annex C.
e) Void;
f) Void;
g) \"N1 SM information\" and:
1) the 5GMM cause IE is set to the 5GMM cause #22 \"Congestion\", the UE
passes to the 5GSM sublayer an indication that the 5GSM message was not
forwarded due to DNN based congestion control along with the 5GSM message from
the Payload container IE of the DL NAS TRANSPORT message, and the time value
from the Back-off timer value IE;
2) the 5GMM cause IE is set to the 5GMM cause #28 \"Restricted service area\",
the UE passes to the 5GSM sublayer an indication that the 5GSM message was not
forwarded due to service area restrictions along with the 5GSM message from
the Payload container IE of the DL NAS TRANSPORT message, enters the state
5GMM-REGISTERED.NON-ALLOWED-SERVICE and, if the DL NAS TRANSPORT message is
received over 3GPP access, performs the registration procedure for mobility
and periodic registration update without waiting for the release of the N1 NAS
signalling connection (see subclauses 5.3.5 and 5.5.1.3);
3) the 5GMM cause IE is set to the 5GMM cause #65 \"maximum number of PDU
sessions reached\", the UE passes to the 5GSM sublayer an indication that the
5GSM message was not forwarded because the PLMN\'s maximum number of PDU
sessions has been reached, along with the 5GSM message from the Payload
container IE of the DL NAS TRANSPORT message;
4) the 5GMM cause IE is set to the 5GMM cause #67 \"insufficient resources for
specific slice and DNN\", the UE passes to the 5GSM sublayer an indication
that the 5GSM message was not forwarded due to S-NSSAI and DNN based
congestion control along with the 5GSM message from the Payload container IE
of the DL NAS TRANSPORT message, and the time value from the Back-off timer
value IE;
5) the 5GMM cause IE is set to the 5GMM cause #69 \"insufficient resources for
specific slice\", the UE passes to the 5GSM sublayer an indication that the
5GSM message was not forwarded due to S-NSSAI only based congestion control
along with the 5GSM message from the Payload container IE of the DL NAS
TRANSPORT message, and the time value from the Back-off timer value IE;
5a) the 5GMM cause IE is set to the 5GMM cause #78 \"PLMN not allowed to
operate at the present UE location\", the UE passes to the 5GSM sublayer an
indication that the 5GSM message was not forwarded because the UE is
registered to a PLMN via a satellite NG-RAN cell that is not allowed to
operate at the present UE location along with the 5GSM message from the
Payload container IE of the DL NAS TRANSPORT message;
6) the 5GMM cause IE is set to the 5GMM cause #90 \"payload was not
forwarded\", the UE passes to the 5GSM sublayer an indication that the 5GSM
message was not forwarded due to routing failure along with the 5GSM message
from the Payload container IE of the DL NAS TRANSPORT message;
7) the 5GMM cause IE is set to the 5GMM cause #91 \"DNN not supported or not
subscribed in the slice\", the UE passes to the 5GSM sublayer an indication
that the 5GSM message was not forwarded because the DNN is not supported or
not subscribed in a slice along with the 5GSM message from the Payload
container IE of the DL NAS TRANSPORT message, and the time value from the
Back-off timer value IE, if any;
8) the 5GMM cause IE is set to the 5GMM cause #92 \"insufficient user-plane
resources for the PDU session\", the UE passes to the 5GSM sublayer an
indication that the 5GSM message was not forwarded due to insufficient user-
plane resources along with the 5GSM message from the Payload container IE of
the DL NAS TRANSPORT message.
9) the 5GMM cause IE is set to the 5GMM cause #79 \"UAS services not
allowed\", the UE passes to the 5GSM sublayer an indication that the 5GSM
message was not forwarded because the UE is marked in the UE\'s 5GMM context
that it is not allowed to request UAS services along with the 5GSM message
from the Payload container IE of the DL NAS TRANSPORT message.
h) \"UE policy container\", the UE policy container in the Payload container
IE is handled in the UE policy delivery procedures specified in Annex D;
i) \"UE parameters update transparent container\" and if the Payload container
IE
1) successfully passes the integrity check (see 3GPP TS 33.501 [24]), the ME
shall store the received UE parameter update counter as specified in annex C
and proceed as follows:
i) if the UE parameters update list includes a UE parameters update data set
with UE parameters update data set type indicating \"Routing indicator update
data\",
A) the ME shall behave as if an SMS is received with protocol identifier set
to SIM data download, data coding scheme set to class 2 message and SMS
payload as secured packet contents of UE parameters update transparent
container IE. The SMS payload is forwarded to UICC as specified in 3GPP TS
23.040 [4A]; and
B) if the ACK bit of the UE parameters update header in the UE parameters
update transparent container is set to \"acknowledgment requested\" and if the
ME receives status bytes from the UICC indicating that the UICC has received
the secured packet successfully, the ME shall send an acknowledgement in the
Payload container IE of an UL NAS TRANSPORT message with Payload type IE set
to \"UE parameters update transparent container\" as specified in subclause
5.4.5.2.2; and
C) if the ME receives a REFRESH command from the UICC as specified in 3GPP TS
31.111 [22A] and if the REG bit of the UE parameters update header in the UE
parameters update transparent container IE is set to \"re-registration
requested\", and:
C1) the UE is registered over 3GPP access, then the UE shall wait until the
emergency services over 3GPP access, if any, are completed, enter 5GMM-IDLE
mode over 3GPP access or 5GMM-CONNECTED mode with RRC inactive indication,
perform a de-registration procedure, and then delete its 5G-GUTI if the UE is
registered to different PLMN or SNPN on non-3GPP access or the UE is not
registered over non-3GPP access, or wait until the de-registration procedure
over non-3GPP access specified in case C2) or C3) is completed before deleting
its 5G-GUTI if the UE is registered to same PLMN or SNPN on non-3GPP access,
and then initiate a registration procedure for initial registration as
specified in subclause 5.5.1.2;
C2) the UE is registered over non-3GPP access and does not have emergency
services ongoing over non-3GPP access, then the UE shall locally release the
N1 NAS signalling connection and enter 5GMM-IDLE mode over non-3GPP access,
perform a de-registration procedure, and then delete its 5G-GUTI if the UE is
registered to different PLMN or SNPN on 3GPP access or the UE is not
registered over 3GPP access, or wait until the de-registration procedure over
3GPP access specified in case C1) is completed before deleting its 5G-GUTI if
the UE is registered to same PLMN or SNPN on 3GPP access, and then initiate a
registration procedure for initial registration as specified in subclause
5.5.1.2; and
C3) the UE is registered over non-3GPP access and has an emergency services
ongoing over non-3GPP access, then the UE shall wait until the emergency
services are completed before locally releasing the N1 NAS signalling
connection and enter 5GMM-IDLE mode over non-3GPP access, perform a de-
registration procedure, and then delete its 5G-GUTI if the UE is registered to
different PLMN or SNPN on 3GPP access or if the UE is not registered over 3GPP
access, or wait until the de-registration procedure over 3GPP access specified
in case C1) is completed before deleting its 5G-GUTI if the UE is registered
to same PLMN or SNPN on 3GPP access, and then initiate a registration
procedure for initial registration as specified in subclause 5.5.1.2.
ii) if the UE parameters update list includes a UE parameters update data set
with UE parameters update data set type indicating \"Default configured NSSAI
update data\",
A) if the ACK bit of the UE parameters update header in the UE parameters
update transparent container is set to \"acknowledgment requested\" and if the
UE parameters update list does not include a UE parameters update data set
with UE parameters update data set type indicating \"Routing indicator update
data\", the ME shall send an acknowledgement in the Payload container IE of an
UL NAS TRANSPORT message with Payload type IE set to \"UE parameters update
transparent container\" as specified in subclause 5.4.5.2.2
B) the ME shall replace the stored default configured NSSAI with the default
configured NSSAI included in the default configured NSSAI update data. In case
of SNPN, the ME shall replace the stored default configured NSSAI associated
with the selected entry of the \"list of subscriber data\" or the PLMN
subscription with the default configured NSSAI included in the default
configured NSSAI update data; and
C) if the REG bit of the UE parameters update header in the UE parameters
update transparent container is set to \"re-registration requested\" and the
UE parameters update list does not include a UE parameters update data set
with UE parameters update data set type indicating \"Routing indicator update
data\", the UE shall wait until it enters 5GMM-IDLE mode and then the UE shall
initiate a registration procedure for mobility registration update as
specified in subclause 5.5.1.3.
if the UE parameters update list does not include a UE parameters update data
set with UE parameters update data set type indicating \"Routing indicator
update data\", the UE used the old default configured NSSAI to create the
requested NSSAI in a REGISTRATION REQUEST message, the UE does not have a
configured NSSAI for the current PLMN or SNPN and the UE has an allowed NSSAI
for the current PLMN or SNPN which contains one or more S-NSSAIs that are not
included in the new default configured NSSAI, the UE shall wait until it
enters 5GMM-IDLE mode and then the UE shall initiate a registration procedure
for mobility and periodic registration update as specified in subclause
5.5.1.3; and
iii) if the UE parameters update list includes a UE parameters update data set
with UE parameters update data set type indicating \"Disaster roaming
information update data\",
A) if the ACK bit of the UE parameters update header in the UE parameters
update transparent container is set to \"acknowledgment requested\" and if the
UE parameters update list does not include a UE parameters update data set
with UE parameters update data set type indicating \"Routing indicator update
data\" or a UE parameters update data set with UE parameters update data set
type indicating \"Default configured NSSAI update data\", the ME shall send an
acknowledgement in the Payload container IE of an UL NAS TRANSPORT message
with Payload type IE set to \"UE parameters update transparent container\" as
specified in subclause 5.4.5.2.2;
B) the UE shall delete the indication of whether disaster roaming is enabled
in the UE stored in the ME, if any, and store the indication of whether
disaster roaming is enabled in the UE included in the disaster roaming
information update data in the ME;
C) the UE shall delete the indication of \'applicability of \"lists of PLMN(s)
to be used in disaster condition\" provided by a VPLMN\' stored in the ME, if
any, and store the indication of \'applicability of \"lists of PLMN(s) to be
used in disaster condition\" provided by a VPLMN\' included in the disaster
roaming information update data in the ME; and
D) if the REG bit of the UE parameters update header in the UE parameters
update transparent container is set to \"re-registration requested\" and the
UE parameters update list does not include a UE parameters update data set
with UE parameters update data set type indicating \"Routing indicator update
data\", the UE shall wait until it enters 5GMM-IDLE mode and then the UE shall
initiate a registration procedure for mobility registration update as
specified in subclause 5.5.1.3.
iv) if the UE parameters update list includes a UE parameters update data set
with UE parameters update data set type indicating \"ME routing indicator
update data\":
A) if the ACK bit of the UE parameters update header in the UE parameters
update transparent container is set to \"acknowledgment requested\" and the UE
parameters update list does not include a UE parameters update data set with
UE parameters update data set type indicating \"Default configured NSSAI
update data\", the ME shall send an acknowledgement in the Payload container
IE of an UL NAS TRANSPORT message with Payload type IE set to \"UE parameters
update transparent container\" as specified in subclause 5.4.5.2.2;
B) the UE shall set or replace the routing indicator of the selected entry of
the \"list of subscriber data\" with the routing indicator included in the ME
routing indicator update data; and
C) if the REG bit of the UE parameters update header in the UE parameters
update transparent container IE is set to \"re-registration requested\", and:
C1) the UE is registered over 3GPP access and is not registered over non-3GPP
access, then the UE shall wait until the emergency services over 3GPP access,
if any, are completed, enter 5GMM-IDLE mode over 3GPP access or 5GMM-CONNECTED
mode with RRC inactive indication, perform a de-registration procedure, delete
its 5G-GUTI, and then initiate a registration procedure for initial
registration as specified in subclause 5.5.1.2;
C2) the UE is registered over non-3GPP access and is not registered over 3GPP
access, then the UE shall locally release the N1 NAS signalling connection and
enter 5GMM-IDLE mode over non-3GPP access, perform a de-registration
procedure, delete its 5G-GUTI, and then initiate a registration procedure for
initial registration as specified in subclause 5.5.1.2; or
C3) the UE is registered over 3GPP access and non-3GPP access to same SNPN,
then the UE shall wait until the emergency services over 3GPP access, if any,
are completed, enter 5GMM-IDLE mode over 3GPP access or 5GMM-CONNECTED mode
with RRC inactive indication over 3GPP access, perform a de-registration
procedure over 3GPP access, locally release the N1 NAS signalling connection
and enter 5GMM-IDLE mode over non-3GPP access, perform a de-registration
procedure over non-3GPP access, delete its 5G-GUTI and then initiate a
registration procedure for initial registration as specified in subclause
5.5.1.2.
NOTE: The term \"non-3GPP access\" in an SNPN refers to the case where the UE
is accessing SNPN services via a PLMN.
2) does not successfully pass the integrity check (see 3GPP TS 33.501 [24])
then the UE shall discard the content of the payload container IE;
j) \"Location services message container\" and the 5GMM cause IE is not
included in the DL NAS TRANSPORT message, the UE shall forward the payload
container type, the content of the Payload container IE and the routing
information in the Additional information IE if included to the upper layer
location services application;
k) \"CIoT user data container\", the UE shall forward the content of the
Payload container IE and the PDU session ID to the 5GSM sublayer;
l) \"CIoT user data container\" and:
1) the 5GMM cause IE is set to the 5GMM cause #22 \"Congestion\", the UE
passes to the 5GSM sublayer an indication that the CIoT user data was not
forwarded due to DNN based congestion control along with the CIoT user data
from the Payload container IE of the DL NAS TRANSPORT message, and the time
value from the Back-off timer value IE;
2) the 5GMM cause IE is set to the 5GMM cause #67 \"insufficient resources for
specific slice and DNN\", the UE passes to the 5GSM sublayer an indication
that the CIoT user data was not forwarded due to S-NSSAI and DNN based
congestion control along with the CIoT user data from the Payload container IE
of the DL NAS TRANSPORT message, and the time value from the Back-off timer
value IE;
3) the 5GMM cause IE is set to the 5GMM cause #69 \"insufficient resources for
specific slice\", the UE passes to the 5GSM sublayer an indication that the
CIoT user data was not forwarded due to S-NSSAI only based congestion control
along with the CIoT user data from the Payload container IE of the DL NAS
TRANSPORT message, and the time value from the Back-off timer value IE;
4) the 5GMM cause IE is set to the 5GMM cause #90 \"payload was not
forwarded\", the UE passes to the 5GSM sublayer an indication that the user
data container was not forwarded due to routing failure along with the user
data container from the Payload container IE and the PDU session ID from the
PDU session ID IE of the DL NAS TRANSPORT message.
m) \"service-level-AA container\", the UE shall forward the content of the
Payload container IE to the upper layers;
m1) \"Event notification\", the UE shall forward the received event
notification indicator(s) to the upper layers (see 3GPP TS 23.216 [6A] and
3GPP TS 24.237 [14AA] for the \"SRVCC handover cancelled, IMS session re-
establishment required\" indicator); or
n) \"Multiple payloads\", the UE shall first decode the content of the Payload
container IE (see subclause 9.11.3.39) to obtain the number of payload
container entries and for each payload container entry, the UE shall:
1) decode the payload container type field;
2) decode the optional IE fields and the payload container contents field in
the payload container entry; and
3) handle the content of each payload container entry the same as the content
of the Payload container IE and the associated optional IEs as specified in
bullets a) to m) above according to the payload container type field.
### 5.4.6 5GMM status procedure
#### 5.4.6.1 General
The purpose of the 5GMM status procedure is to report at any time in the 5GMM
STATUS message certain error conditions detected upon receipt of 5GMM protocol
data in the AMF or in the UE. The 5GMM STATUS message can be sent by both the
AMF and the UE (see example in figure 5.4.6.1).
Figure 5.4.6.1: 5GMM status procedure
#### 5.4.6.2 5GMM status received in the UE
On receipt of a 5GMM STATUS message, no state transition and no specific
action shall be taken as seen from the radio interface, i.e. local actions are
possible. The local actions to be taken by UE on receipt of a 5GMM STATUS
message are implementation dependent.
#### 5.4.6.3 5GMM status received in the network
On receipt of a 5GMM STATUS message in the AMF, no state transition and no
specific action shall be taken as seen from the radio interface, i.e. local
actions are possible. The local actions to be taken by the AMF on receipt of a
5GMM STATUS message are implementation dependent.
### 5.4.7 Network slice-specific authentication and authorization procedure
#### 5.4.7.1 General
The purpose of the network slice-specific authentication and authorization
procedure is to enable the authentication, authorization and accounting server
(AAA-S) via the Network Slice Specific and SNPN Authentication and
Authorization Function (NSSAAF) to (re-)authenticate or (re-)authorize the
upper layers of the UE.
The network slice-specific authentication and authorization procedure can be
invoked for a UE supporting network slice-specific authentication and
authorization procedure and for a HPLMN S-NSSAI or an SNPN S-NSSAI (see
subclauses 5.15.10 and 5.30.2.9 in 3GPP TS 23.501 [8] and subclause 4.2.9.2 of
3GPP TS 23.502 [9]).
The network (re-)authenticates the UE using the EAP as specified in IETF RFC
3748 [34].
EAP has defined four types of EAP messages:
a) an EAP-request message;
b) an EAP-response message;
c) an EAP-success message; and
d) an EAP-failure message.
The EAP-request message is transported from the network to the UE using the
NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message of the network slice-
specific EAP message reliable transport procedure.
The EAP-response message to the EAP-request message is transported from the UE
to the network using the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE
message of the network slice-specific EAP message reliable transport
procedure.
If the (re-)authentication of the UE completes successfully or unsuccessfully,
the EAP-success message or the EAP-failure message, respectively, is
transported from the network to the UE using the NETWORK SLICE-SPECIFIC
AUTHENTICATION RESULT message of the network slice-specific result message
transport procedure.
There can be several rounds of exchange of an EAP-request message and a
related EAP-response message for the AAA-S via the NSSAAF to complete the
(re-)authentication and (re-)authorization of the request for an S-NSSAI (see
example in figure 5.4.7.1.1).
The AMF shall set the authenticator retransmission timer specified in
subclause 4.3 of IETF RFC 3748 [34] to infinite value.
NOTE: The network slice-specific authentication and authorization procedure
provides a reliable transport of EAP messages and therefore retransmissions at
the EAP layer of the AMF do not occur.
Figure 5.4.7.1.1: Network slice-specific authentication and authorization
procedure
#### 5.4.7.2 Network slice-specific EAP message reliable transport procedure
##### 5.4.7.2.1 Network slice-specific EAP message reliable transport
procedure initiation
In order to initiate the network slice-specific EAP message reliable transport
procedure, the AMF shall create a NETWORK SLICE-SPECIFIC AUTHENTICATION
COMMAND message.
The AMF shall set the EAP message IE of the NETWORK SLICE-SPECIFIC
AUTHENTICATION COMMAND message to the EAP-request message which is generated
by the AMF or provided by the AAA-S via the NSSAAF.
The AMF shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION
COMMAND message to the HPLMN S-NSSAI or the SNPN S-NSSAI to which the EAP-
request message is related.
The AMF shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message
and start timer T3575 per S-NSSAI (see example in figure 5.4.7.1.1).
Upon receipt of a NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message, the
UE shall stop timer T3346 if running. The UE shall pass:
a) the EAP-request message received in the EAP message IE; and
b) the HPLMN S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE;
to the upper layers. Apart from this action, the network slice-specific
authentication and authorization procedure is transparent to the 5GMM layer of
the UE.
##### 5.4.7.2.2 Network slice-specific EAP message reliable transport
procedure accepted by the UE
When the upper layers provide an EAP-response message associated with the
HPLMN S-NSSAI or the SNPN S-NSSAI, the UE shall create a NETWORK SLICE-
SPECIFIC AUTHENTICATION COMPLETE message.
The UE shall set the EAP message IE of the NETWORK SLICE-SPECIFIC
AUTHENTICATION COMPLETE message to the EAP-response message.
The UE shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION
COMPLETE message to the HPLMN S-NSSAI or the SNPN S-NSSAI associated with the
EAP-response message.
The UE shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message.
Apart from this action, the network slice-specific authentication and
authorization procedure is transparent to the 5GMM layer of the UE.
Upon receipt of a NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message, the
AMF shall stop timer T3575 and:
a) pass the EAP-response message received in the EAP message IE of the NETWORK
SLICE-SPECIFIC AUTHENTICATION COMPLETE message associated with the HPLMN
S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE to the upper layers; or
b) provide the EAP-response message received in the EAP message IE of the
NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message associated with the
HPLMN S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE to the AAA-S via the
NSSAAF.
##### 5.4.7.2.3 Abnormal cases on the network side
The following abnormal cases can be identified:
a) T3575 expiry
The AMF shall, on the first expiry of the timer T3575, retransmit the NETWORK
SLICE-SPECIFIC AUTHENTICATION COMMAND message and shall reset and start timer
T3575. This retransmission is repeated four times, i.e. on the fifth expiry of
timer T3575, the AMF shall abort the network slice-specific authentication and
authorization procedure for the S-NSSAI. The AMF shall consider that the
network slice-specific authentication and authorization procedure for the
S-NSSAI is completed as a failure.
b) Lower layers indication of non-delivered NAS PDU due to handover
If the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message could not be
delivered due to an intra AMF handover and the target TAI is included in the
TAI list, then upon successful completion of the intra AMF handover the AMF
shall retransmit the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message. If
a failure of handover procedure is reported by the lower layer and the N1 NAS
signalling connection exists, the AMF shall retransmit the NETWORK SLICE-
SPECIFIC AUTHENTICATION COMMAND message.
c) Network slice-specific authentication and authorization procedure and de-
registration procedure collision
If the network receives a DEREGISTRATION REQUEST message before the ongoing
network slice-specific authentication and authorization procedure has been
completed and the access type included in the DEREGISTRATION REQUEST message
is the same as the one for which the network slice-specific authentication and
authorization procedure is ongoing, the network shall abort the network slice-
specific authentication and authorization procedure and shall progress the UE-
initiated de-registration procedure. The AMF may initiate the network slice-
specific authentication and authorization procedure for the S-NSSAI which is
completed as a failure, if available. If the access type included in the
DEREGISTRATION REQUEST message is different from the one for which the network
slice-specific authentication and authorization procedure is ongoing, the
network shall proceed with both procedures.
##### 5.4.7.2.4 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Transmission failure of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE
message with change in the current TAI
If the current TAI is not in the TAI list, the network slice-specific
authentication and authorization procedure shall be aborted and:
\- if the UE is in 5GMM-REGISTERED state, a registration procedure for
mobility and periodic registration update indicating \"mobility registration
updating\" in the 5GS registration type IE of the REGISTRATION REQUEST message
shall be initiated; and
\- otherwise a registration procedure for initial registration shall be
initiated.
b) Transmission failure of NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE
message indication without change in the current TAI
It is up to the UE implementation how to re-run the ongoing procedure that
triggered the network slice-specific authentication and authorization
procedure.
c) Network slice-specific authentication and authorization procedure and de-
registration procedure collision
If the UE receives NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message after
sending a DEREGISTRATION REQUEST message and the access type included in the
DEREGISTRATION REQUEST message is the same as the access in which the NETWORK
SLICE-SPECIFIC AUTHENTICATION COMMAND message is received, then the UE shall
ignore the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message and proceed
with the de-registration procedure. Otherwise, the UE shall proceed with both
procedures.
#### 5.4.7.3 Network slice-specific EAP result message transport procedure
##### 5.4.7.3.1 Network slice-specific EAP result message transport procedure
initiation
In order to initiate the network slice-specific EAP result message transport
procedure, the AMF shall create a NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT
message.
The AMF shall set the EAP message IE of the NETWORK SLICE-SPECIFIC
AUTHENTICATION RESULT message to the EAP-success or EAP-failure message
provided by the AAA-S via the NSSAAF.
The AMF shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION
RESULT message to the HPLMN S-NSSAI or the SNPN S-NSSAI to which the EAP-
success or EAP-failure message is related.
The AMF shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message.
The AMF shall retain the authentication result for the UE and the HPLMN
S-NSSAI or the SNPN S-NSSAI while the UE is registered to the PLMN (see
subclause 5.15.10 in 3GPP TS 23.501 [8]).
Upon receipt of a NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message, the UE
shall pass:
a) the EAP-success or EAP-failure message received in the EAP message IE; and
b) the HPLMN S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE;
to the upper layers. Apart from this action, the network slice-specific
authentication and authorization procedure is transparent to the 5GMM layer of
the UE.
## 5.5 5GMM specific procedures
### 5.5.1 Registration procedure
#### 5.5.1.1 General
The registration procedure is always initiated by the UE and used for initial
registration as specified in subclause 5.5.1.2.2 or mobility and periodic
registration update as specified in subclause 5.5.1.3.2.
When the UE needs to initiate registration over both 3GPP access and non-3GPP
access in the same PLMN (e.g. the 3GPP access and the selected N3IWF are
located in the same PLMN), the UE:
a) in 5GMM-REGISTERED-INITIATED over 3GPP access shall not initiate
registration over non-3GPP access; or
b) in 5GMM-REGISTERED-INITIATED over non-3GPP access shall not initiate
registration over 3GPP access.
NOTE 1: To which access (i.e. 3GPP access or non-3GPP access) the UE initiates
registration first is up to UE implementation.
When the UE is registered with a PLMN over a non-3GPP access, the AMF and the
UE maintain:
a) registration state and state machine over non-3GPP access;
b) 5G NAS security context;
c) 5G-GUTI;
d) registration area for non-3GPP access, which is associated with a single
TAI; and
e) non-3GPP de-registration timer in the UE and non-3GPP implicit de-
registration timer in the AMF.
A registration attempt counter is used to limit the number of subsequently
rejected registration attempts. The registration attempt counter shall be
incremented as specified in subclause 5.5.1.2.7 or subclause 5.5.1.3.7.
Depending on the value of the registration attempt counter, specific actions
shall be performed. The registration attempt counter shall be reset when:
\- the UE is powered on;
\- a USIM is inserted;
\- a registration procedure is successfully completed;
\- an EPS attach or combined EPS attach procedure is successfully completed in
S1 mode and the UE is operating in single-registration mode. In this case, the
UE shall reset the registration attempt counter for 3GPP access;
NOTE 2: The registration attempt counter for non-3GPP access is not impacted
by the EPS attach and the combined EPS attach procedure.
\- a registration procedure is rejected with cause #11, #12, #13, #15, #27,
#31, #62, #72, #73, #74, #75, #76, #77 or #78;
\- a registration procedure is rejected with cause #3, #6 or #7, the
REGISTRATION REJECT message is received without integrity protection and the
counter for \"SIM/USIM considered invalid for GPRS services\" events has a
value less than a UE implementation-specific maximum value.
\- a network initiated deregistration procedure is completed with cause #11,
#12, #13, #15, #27; #62, #72, #74, #75, #76, #77 or #78; or
\- a new PLMN or SNPN is selected.
Additionally, the registration attempt counter shall be reset when the UE is
in substate 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION or 5GMM-
REGISTERED.ATTEMPTING-REGISTRATION-UPDATE, and:
\- the current TAI is changed;
\- timer T3502 expires; or
\- timer T3346 is started.
When the registration attempt counter is reset, the UE shall stop timer T3519
if running, and delete any stored SUCI.
The lower layers indicate to NAS whether the network supports emergency
services for the UE in limited service state (see 3GPP TS 38.331 [30]). This
information is taken into account when deciding whether to initiate an initial
registration for emergency services.
#### 5.5.1.2 Registration procedure for initial registration
##### 5.5.1.2.1 General
This procedure can be used by a UE for initial registration for 5GS services.
When the UE initiates the registration procedure for initial registration, the
UE shall indicate \"initial registration\" in the 5GS registration type IE.
When the UE initiates the registration procedure for emergency services, the
UE shall indicate \"emergency registration\" in the 5GS registration type IE.
When the UE initiates the initial registration for onboarding services in
SNPN, the UE shall indicate \"SNPN onboarding registration\" in the 5GS
registration type IE. When the UE initiates the initial registration procedure
for disaster roaming services, the UE shall indicate \"disaster roaming
initial registration\" in the 5GS registration type IE.
If the MUSIM UE initiates the registration procedure for initial registration
and indicates \"emergency registration\" in the 5GS registration type IE in
the REGISTRATION REQUEST message, the network shall not indicate the support
of:
\- the N1 NAS signalling connection release;
\- the paging indication for voice services;
\- the reject paging request; or
\- the paging restriction;
in the REGISTRATION ACCEPT message.
##### 5.5.1.2.2 Initial registration initiation
The UE in state 5GMM-DEREGISTERED shall initiate the registration procedure
for initial registration by sending a REGISTRATION REQUEST message to the AMF,
a) when the UE performs initial registration for 5GS services;
b) when the UE performs initial registration for emergency services;
c) when the UE performs initial registration for SMS over NAS;
d) when the UE moves from GERAN to NG-RAN coverage or the UE moves from a
UTRAN to NG-RAN coverage and the following applies:
1) the UE initiated a GPRS attach or routing area updating procedure while in
A/Gb mode or Iu mode; or
2) the UE has performed 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP TS
23.216 [6A],
and since then the UE did not perform a successful EPS attach or tracking area
updating procedure in S1 mode or registration procedure in N1 mode;
e) when the UE performs initial registration for onboarding services in SNPN;
and
f) when the UE performs initial registration for disaster roaming services;
with the following clarifications to initial registration for emergency
services:
a) the UE shall not initiate an initial registration for emergency services
over the current access, if the UE is already registered for emergency
services over the non-current access, unless the initial registration has to
be initiated to perform handover of an existing emergency PDU session from the
non-current access to the current access; and
NOTE 1: Transfer of an existing emergency PDU session between 3GPP access and
non-3GPP access is needed e.g. if the UE determines that the current access is
no longer available.
b) the UE can only initiate an initial registration for emergency services
over non-3GPP access if it cannot register for emergency services over 3GPP
access.
The UE initiates the registration procedure for initial registration by
sending a REGISTRATION REQUEST message to the AMF, starting timer T3510. If
timer T3502 is currently running, the UE shall stop timer T3502. If timer
T3511 is currently running, the UE shall stop timer T3511.
During initial registration the UE handles the 5GS mobile identity IE in the
following order:
a) if:
1) the UE:
i) was previously registered in S1 mode before entering state EMM-
DEREGISTERED; and
ii) has received an \"interworking without N26 interface not supported\"
indication from the network; and
2) EPS security context and a valid native 4G-GUTI are available;
then the UE shall create a 5G-GUTI mapped from the valid native 4G-GUTI as
specified in 3GPP TS 23.003 [4] and indicate the mapped 5G-GUTI in the 5GS
mobile identity IE. The UE shall include the UE status IE with the EMM
registration status set to \"UE is not in EMM-REGISTERED state\" and shall
include an ATTACH REQUEST message as specified in 3GPP TS 24.301 [15] in the
EPS NAS message container IE.
Additionally, if the UE holds a valid 5Gâ€‘GUTI, the UE shall include the
5G-GUTI in the Additional GUTI IE in the REGISTRATION REQUEST message in the
following order:
1) a valid 5G-GUTI that was previously assigned by the same PLMN with which
the UE is performing the registration, if available;
2) a valid 5G-GUTI that was previously assigned by an equivalent PLMN, if
available; and
3) a valid 5G-GUTI that was previously assigned by any other PLMN, if
available;
b) if:
1) the UE is registering with a PLMN and the UE holds a valid 5G-GUTI that was
previously assigned, over 3GPP access or non-3GPP access, by the same PLMN
with which the UE is performing the registration, the UE shall indicate the
5G-GUTI in the 5GS mobile identity IE; or
2) the UE is registering with a SNPN, the UE holds a valid 5G-GUTI that was
previously assigned, over 3GPP access or non-3GPP access, by the same SNPN
with which the UE is performing the registration, and the UE is not initiating
the initial registration for onboarding services in SNPN, the UE shall
indicate the 5G-GUTI in the 5GS mobile identity IE;
c) if the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP
access or non-3GPP access, by an equivalent PLMN, the UE shall indicate the
5G-GUTI in the 5GS mobile identity IE;
d) if:
1) the UE is registering with a PLMN and the UE holds a valid 5G-GUTI that was
previously assigned, over 3GPP access or non-3GPP access, by any other PLMN,
the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; or
2) the UE is registering with an SNPN, the UE holds a valid 5G-GUTI that was
previously assigned, over 3GPP access or non-3GPP access, by any other SNPN,
and the UE is not initiating the initial registration for onboarding services
in SNPN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE and
shall additionally include the NID of the other SNPN in the NID IE;
e) if a SUCI other than an onboarding SUCI is available, and the UE is not
initiating the initial registration for onboarding services in SNPN, the UE
shall include the SUCI other than an onboarding SUCI in the 5GS mobile
identity IE;
f) if the UE does not hold a valid 5G-GUTI or SUCI other than an onboarding
SUCI, and is initiating the initial registration for emergency services, the
PEI shall be included in the 5GS mobile identity IE; and
g) if the UE is initiating the initial registration for onboarding services in
SNPN, an onboarding SUCI shall be included in the 5GS mobile identity IE.
NOTE 2: The AMF in ON-SNPN uses the onboarding SUCI as specified in 3GPP TS
23.501 [8].
If the SUCI is included in the 5GS mobile identity IE and the timer T3519 is
not running, the UE shall start timer T3519 and store the value of the SUCI
sent in the REGISTRATION REQUEST message. The UE shall include the stored SUCI
in the REGISTRATION REQUEST message while timer T3519 is running.
If the UE is operating in the dual-registration mode and it is in EMM state
EMM-REGISTERED, the UE shall include the UE status IE with the EMM
registration status set to \"UE is in EMM-REGISTERED state\".
NOTE 3: Inclusion of the UE status IE with this setting corresponds to the
indication that the UE is \"moving from EPC\" as specified in 3GPP TS 23.502
[9].
NOTE 4: The value of the 5GMM registration status included by the UE in the UE
status IE is not used by the AMF.
If the last visited registered TAI is available, the UE shall include the last
visited registered TAI in the REGISTRATION REQUEST message.
If the UE requests the use of SMS over NAS, the UE shall include the 5GS
update type IE in the REGISTRATION REQUEST message with the SMS requested bit
set to \"SMS over NAS supported\". When the 5GS update type IE is included in
the REGISTRATION REQUEST for reasons other than requesting the use of SMS over
NAS, and the UE does not need to register for SMS over NAS, the UE shall set
the SMS requested bit of the 5GS update type IE to \"SMS over NAS not
supported\" in the REGISTRATION REQUEST message.
If the UE supports MICO mode and requests the use of MICO mode, then the UE
shall include the MICO indication IE in the REGISTRATION REQUEST message. If
the UE requests to use an active time value, it shall include the active time
value in the T3324 IE in the REGISTRATION REQUEST message. If the UE includes
the T3324 IE, it may also request a particular T3512 value by including the
Requested T3512 IE in the REGISTRATION REQUEST message. Additionally, if the
UE supports strictly periodic registration timer, the UE shall set the
Strictly Periodic Registration Timer Indication bit of the MICO indication IE
in the REGISTRATION REQUEST message to \"strictly periodic registration timer
supported\".
If the UE needs to use the UE specific DRX parameters, the UE shall include
the Requested DRX parameters IE in the REGISTRATION REQUEST message.
If the UE is in NB-N1 mode and if the UE needs to use the UE specific DRX
parameters for NB-N1 mode, the UE shall include the Requested NB-N1 mode DRX
parameters IE in the REGISTRATION REQUEST message.
If the UE supports eDRX and requests the use of eDRX, the UE shall include the
Requested extended DRX parameters IE in the REGISTRATION REQUEST message.
If the UE needs to request LADN information for specific LADN DNN(s) or
indicates a request for LADN information as specified in 3GPP TS 23.501 [8],
the UE shall include the LADN indication IE in the REGISTRATION REQUEST
message and:
\- request specific LADN DNNs by including a LADN DNN value in the LADN
indication IE for each LADN DNN for which the UE requests LADN information; or
\- to indicate a request for LADN information by not including any LADN DNN
value in the LADN indication IE.
The UE shall include the requested NSSAI containing the S-NSSAI(s)
corresponding to the slice(s) to which the UE intends to register with and
shall include the mapped S-NSSAI(s) for the requested NSSAI, if available, in
the REGISTRATION REQUEST message. If the UE has allowed NSSAI or configured
NSSAI or both for the current PLMN or SNPN, the requested NSSAI shall be
either:
a) the configured NSSAI for the current PLMN or SNPN, or a subset thereof as
described below;
b) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as
described below; or
c) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as
described below, plus one or more S-NSSAIs from the configured NSSAI for which
no corresponding S-NSSAI is present in the allowed NSSAI and those are neither
in the rejected NSSAI nor in the pending NSSAI.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and has a default configured
NSSAI, the UE shall:
a) include the S-NSSAI(s) in the Requested NSSAI IE of the REGISTRATION
REQUEST message using the default configured NSSAI; and
b) include the Network slicing indication IE with the Default configured NSSAI
indication bit set to \"Requested NSSAI created from default configured
NSSAI\" in the REGISTRATION REQUEST message.
If the UE has no allowed NSSAI for the current PLMN or SNPN, no configured
NSSAI for the current PLMN or SNPN, and no default configured NSSAI, the UE
shall not include a requested NSSAI in the REGISTRATION REQUEST message.
If all the S-NSSAI(s) corresponding to the slice(s) to which the UE intends to
register are included in the pending NSSAI, the UE shall not include a
requested NSSAI in the REGISTRATION REQUEST message.
The subset of configured NSSAI provided in the requested NSSAI consists of one
or more S-NSSAIs in the configured NSSAI applicable to the current PLMN or
SNPN, if the S-NSSAI is neither in the rejected NSSAI nor associated to the
S-NSSAI(s) in the rejected NSSAI. In addition, if the NSSRG information is
available, the subset of configured NSSAI provided in the requested NSSAI
shall be associated with at least one common NSSRG value. If the UE is in
5GMM-REGISTERED state over the other access and has already an allowed NSSAI
for the other access in the same PLMN or in different PLMNs, all the
S-NSSAI(s) in the requested NSSAI for the current access shall share at least
an NSSRG value common to all the S-NSSAI(s) of the allowed NSSAI for the other
access. If the UE is simultaneously performing the registration procedure on
the other access in different PLMNs, the UE shall include S-NSSAIs that share
at least a common NSSRG value across all access types. The S-NSSAIs in the
pending NSSAI and requested NSSAI shall be associated with at least one common
NSSRG value.
NOTE 5: If the UE has stored mapped S-NSSAI(s) for the rejected NSSAI, and one
or more S-NSSAIs in the stored mapped S-NSSAI(s) for the configured NSSAI are
not included in the stored mapped S-NSSAI(s) for the rejected NSSAI, then a
S-NSSAI in the configured NSSAI associated to one or more of these mapped
S-NSSAI(s) for the configured NSSAI are available to be included in the
requested NSSAI together with their mapped S-NSSAI.
NOTE 6: If one or more mapped S-NSSAIs in the stored mapped S-NSSAI(s) for the
configured NSSAI are not included in the stored rejected NSSAI for the failed
or revoked NSSAA, a S-NSSAI in the configured NSSAI associated to one or more
of these mapped S-NSSAI(s) for the configured NSSAI are available to be
included in the registration request together with their mapped S-NSSAI.
NOTE 7: There is no need to consider the case that the UE is simultaneously
performing the registration procedure on the other access in the same PLMN,
due to that the UE is not allowed to initiate the registration procedure over
one access when the registration over the other access to the same PLMN is
going on.
The subset of allowed NSSAI provided in the requested NSSAI consists of one or
more S-NSSAIs in the allowed NSSAI for the current PLMN.
NOTE 8: How the UE selects the subset of configured NSSAI or allowed NSSAI to
be provided in the requested NSSAI is implementation specific. The UE can take
preferences indicated by the upper layers (e.g. policies like URSP,
applications) and UE local configuration into account.
NOTE 9: The number of S-NSSAI(s) included in the requested NSSAI cannot exceed
eight.
If the UE initiates an initial registration for onboarding services in SNPN,
the UE shall not include the Requested NSSAI IE in the REGISTRATION REQUEST
message.
If the UE supports NSAG, the UE shall set the NSAG bit to \"NSAG supported\"
in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE initiates an initial registration for emergency services or needs to
prolong the established NAS signalling connection after the completion of the
initial registration procedure (e.g. due to uplink signalling pending), the UE
shall set the Follow-on request indicator to \"Follow-on request pending\".
NOTE 10: The UE does not have to set the Follow-on request indicator to 1,
even if the UE has to request resources for V2X communication over PC5
reference point, 5G ProSe direct discovery over PC5 or 5G ProSe direct
communication over PC5.
If the UE supports S1 mode and the 5GS registration type IE in the
REGISTRATION REQUEST message is not set to \"disaster roaming initial
registration\", the UE shall:
\- set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of
the REGISTRATION REQUEST message;
\- include the S1 UE network capability IE in the REGISTRATION REQUEST
message; additionally, if the UE supports EPS-UPIP, the UE shall set the EPS-
UPIP bit to \"EPS-UPIP supported\" in the S1 UE network capability IE in the
REGISTRATION REQUEST message; and
\- if the UE supports sending an ATTACH REQUEST message containing a PDN
CONNECTIVITY REQUEST message with request type set to \"handover\" to transfer
a PDU session from N1 mode to S1 mode, set the HO attach bit to \"attach
request message containing PDN connectivity request with request type set to
handover to transfer PDU session from N1 mode to S1 mode supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the LTE positioning protocol (LPP) in N1 mode as specified
in 3GPP TS 37.355 [26], the UE shall set the LPP bit to \"LPP in N1 mode
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the Location Services (LCS) notification mechanisms in N1
mode as specified in 3GPP TS 23.273 [6B], the UE shall set the 5G-LCS bit to
\"LCS notification mechanisms supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
If the UE is in NB-N1 mode, then the UE shall set the Control plane CIoT 5GS
optimization bit to \"Control plane CIoT 5GS optimization supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message. If the UE is capable
of NB-S1 mode, then the UE shall set the Control plane CIoT EPS optimization
bit to \"Control plane CIoT EPS optimization supported\" in the S1 UE network
capability IE of the REGISTRATION REQUEST message.
If the UE supports N3 data transfer and multiple user-plane resources in NB-N1
mode (see 3GPP TS 36.306 [25D], 3GPP TS 36.331 [25A]), then the UE shall set
the Multiple user-plane resources support bit to \"Multiple user-plane
resources supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message.
If the UE supports 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP TS
23.216 [6A], the UE shall:
\- set the 5G-SRVCC from NG-RAN to UTRAN capability bit to \"5G-SRVCC from NG-
RAN to UTRAN supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message; and
\- include the Mobile station classmark 2 IE and the Supported codecs IE in
the REGISTRATION REQUEST message.
If the UE supports service gap control, then the UE shall set the SGC bit to
\"service gap control supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
If the UE supports the restriction on use of enhanced coverage, the UE shall
set the RestrictEC bit to \"Restriction on use of enhanced coverage
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports network slice-specific authentication and authorization,
the UE shall set the NSSAA bit to \"network slice-specific authentication and
authorization supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message.
If the UE supports CAG feature, the UE shall set the CAG bit to \"CAG
Supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports extended CAG information list, the UE shall set the Ex-CAG
bit to \"Extended CAG information list supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message.
If the UE supports sending of REGISTRATION COMPLETE message for acknowledging
the reception of Negotiated PEIPS assistance information IE in the
REGISTRATION ACCEPT message, the UE shall set the RCMP bit to \"Sending of
REGISTRATION COMPLETE message for negotiated PEIPS assistance information
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
When the UE is not in NB-N1 mode, if the UE supports RACS, the UE shall:
a) set the RACS bit to \"RACS supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message;
b) if the UE has an applicable network-assigned UE radio capability ID for the
current UE radio configuration in the selected PLMN or SNPN, include the
applicable network-assigned UE radio capability ID in the UE radio capability
ID IE of the REGISTRATION REQUEST message; and
c) if the UE:
1) does not have an applicable network-assigned UE radio capability ID for the
current UE radio configuration in the selected PLMN or SNPN; and
2) has an applicable manufacturer-assigned UE radio capability ID for the
current UE radio configuration,
include the applicable manufacturer-assigned UE radio capability ID in the UE
radio capability ID IE of the REGISTRATION REQUEST message.
If the UE has one or more stored UE policy sections:
\- identified by a UPSI with the PLMN ID part indicating the HPLMN or the
selected PLMN; or
\- identified by a UPSI with the PLMN ID part indicating the PLMN ID part of
the SNPN identity of the selected SNPN and associated with the NID of the
selected SNPN;
then the UE shall set the Payload container type IE to \"UE policy container\"
and include the UE STATE INDICATION message (see annex D) in the Payload
container IE of the REGISTRATION REQUEST message.
NOTE 11: In this version of the protocol, the UE can only include the Payload
container IE in the REGISTRATION REQUEST message to carry a payload of type
\"UE policy container\".
If the UE does not have a valid 5G NAS security context, the UE shall send the
REGISTRATION REQUEST message without including the NAS message container IE.
The UE shall include the entire REGISTRATION REQUEST message (i.e. containing
cleartext IEs and non-cleartext IEs, if any) in the NAS message container IE
that is sent as part of the SECURITY MODE COMPLETE message as described in
subclauses 4.4.6 and 5.4.2.3.
If the UE has a valid 5G NAS security context and the UE needs to send non-
cleartext IEs, the UE shall send a REGISTRATION REQUEST message including the
NAS message container IE as described in subclause 4.4.6. If the UE does not
need to send non-cleartext IEs, the UE shall send a REGISTRATION REQUEST
message without including the NAS message container IE.
If the UE supports ciphered broadcast assistance data and needs to obtain new
ciphering keys, the UE shall include the Additional information requested IE
with the CipherKey bit set to \"ciphering keys for ciphered broadcast
assistance data requested\" in the REGISTRATION REQUEST message.
The UE shall set the WUSA bit to \"WUS assistance information reception
supported\" in the 5GMM capability IE if the UE supports WUS assistance
information. The UE may include its UE paging probability information in the
Requested WUS assistance information IE if the UE has set the WUSA bit to
\"WUS assistance information reception supported\" in the 5GMM capability IE
and the UE is not performing the initial registration for emergency services.
The UE shall set the NR-PSSI bit to \"NR paging subgrouping supported\" in the
5GMM capability IE if the UE supports PEIPS assistance information and the 5GS
registration type IE in the REGISTRATION REQUEST message is not set to
\"emergency registration\". The UE may include its UE paging probability
information in the Requested PEIPS assistance information IE if the UE has set
the NR-PSSI bit to \"NR paging subgrouping supported\" in the 5GMM capability
IE.
If the REGISTRATION REQUEST message includes a NAS message container IE, the
AMF shall process the REGISTRATION REQUEST message that is obtained from the
NAS message container IE as described in subclause 4.4.6.
If the UE supports V2X as specified in 3GPP TS 24.587 [19B], the UE shall set
the V2X bit to \"V2X supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message. If the UE supports V2X communication over E-UTRA-PC5 as
specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCEPC5 bit to \"V2X
communication over E-UTRA-PC5 supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message. If the UE supports V2X communication over NR-PC5
as specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCNPC5 bit to
\"V2X communication over NR-PC5 supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
The UE shall set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the NSSRG, then the UE shall set the NSSRG bit to \"NSSRG
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the W-AGF acting on behalf of an N5GC device initiates an initial
registration as specified in 3GPP TS 23.316 [6D], the W-AGF acting on behalf
of the N5GC device shall include the N5GC indication IE with the N5GC device
indication bit set to \"N5GC device registration is requested\" in the
REGISTRATION REQUEST message.
If the UE supports UAS services, the UE shall set the UAS bit to \"UAS
services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message.
When the UE supporting UAS services initiates an initial registration for UAS
services, the UE shall include the service-level device ID in the Service-
level-AA container IE of the REGISTRATION REQUEST message and set the value to
the CAA-level UAV ID. The UE shall include the service-level-AA server address
in the Service-level-AA container IE of the REGISTRATION REQUEST message and
set the value to the USS address, if it is provided by the upper layers.
If the UE supports 5G ProSe direct discovery as specified in 3GPP TS 24.554
[19E], the UE shall set the 5G ProSe-dd bit to \"5G ProSe direct discovery
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If
the UE supports 5G ProSe direct communication as specified in 3GPP TS 24.554
[19E], the UE shall set the 5G ProSe-dc bit to \"5G ProSe direct communication
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If
the UE supports acting as 5G ProSe layer-2 UE-to-network relay UE as specified
in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2relay bit to \"Acting
as a 5G ProSe layer-2 UE-to-network relay UE supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message. If the UE supports acting
as 5G ProSe layer-3 UE-to-network relay UE as specified in 3GPP TS 24.554
[19E], the UE shall set the 5G ProSe-l3relay bit to \"Acting as a 5G ProSe
layer-3 UE-to-network relay UE supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2
UE-to-network remote UE as specified in 3GPP TS 24.554 [19E], the UE shall set
the 5G ProSe-l2rmt bit to \"Acting as a 5G ProSe layer-2 UE-to-network remote
UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports acting as 5G ProSe layer-3 UE-to-network remote UE as
specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3rmt bit to
\"Acting as a 5G ProSe layer-3 UE-to-network remote UE supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message.
If the MUSIM UE supports the N1 NAS signalling connection release, then the UE
shall set the N1 NAS signalling connection release bit to \"N1 NAS signalling
connection release supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message otherwise the UE shall not set the N1 NAS signalling
connection release bit to \"N1 NAS signalling connection release supported\"
in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the MUSIM UE supports the paging indication for voice services, then the UE
shall set the paging indication for voice services bit to \"paging indication
for voice services supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message otherwise the UE shall not set the paging indication for voice
services bit to \"paging indication for voice services supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message.
If the MUSIM UE supports the reject paging request, then the UE shall set the
reject paging request bit to \"reject paging request supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message otherwise the UE shall not
set the reject paging request bit to \"reject paging request supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message.
If the MUSIM UE sets:
\- the reject paging request bit to \"reject paging request supported\";
\- the N1 NAS signalling connection release bit to \"N1 NAS signalling
connection release supported\"; or
\- both of them;
and supports the paging restriction, then the UE shall set the paging
restriction bit to \"paging restriction supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message otherwise the UE shall not set the paging
restriction bit to \"paging restriction supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message.
If the UE supports MINT, the UE shall set the MINT bit to \"MINT supported\"
in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE initiates the registration procedure for disaster roaming services,
the UE has determined the MS determined PLMN with disaster condition as
specified in 3GPP TS 23.122 [5] and:
a) the MS determined PLMN with disaster condition is the HPLMN and:
1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and
does not contain a valid 5G-GUTI that was previously assigned by the HPLMN; or
2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message
and the 5GS mobile identity IE contains neither the SUCI nor a valid 5G-GUTI
that was previously assigned by the HPLMN; or
b) the MS determined PLMN with disaster condition is not the HPLMN and:
1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and
does not contain a valid 5G-GUTI that was previously assigned by the MS
determined PLMN with disaster condition; or
2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message
and the 5GS mobile identity IE does not contain a valid 5G-GUTI that was
previously assigned by the MS determined PLMN with disaster condition;
the UE shall include in the REGISTRATION REQUEST message the MS determined
PLMN with disaster condition IE indicating the MS determined PLMN with
disaster condition.
NOTE 12: If the UE initiates the registration procedure for disaster roaming
services, and the MS determined PLMN with disaster condition cannot be
determined when an NG-RAN cell of the PLMN broadcasts the disaster related
indication as specified in 3GPP TS 23.122 [5], the UE does not include in the
REGISTRATION REQUEST message the MS determined PLMN with disaster condition IE
but includes the Additional GUTI IE or the 5GS mobile identity IE or both as
specified in subclauses 5.5.1.2.2.
If the UE supports event notification, the UE shall set the EventNotification
bit to \"Event notification supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
If the UE supports access to an SNPN using credentials from a credentials
holder and the UE is in its HPLMN or EHPLMN or a subscribed SNPN, the UE shall
set the SSNPNSI bit to \"SOR-SNPN-SI supported\" in the 5GMM capability IE of
the REGISTRATION REQUEST message.
If the UE supports MPS indicator update via the UE configuration update
procedure, the UE shall set the MPSIU bit to \"MPS indicator update
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
Figure 5.5.1.2.2.1: Registration procedure for initial registration
##### 5.5.1.2.3 5GMM common procedure initiation
The network may initiate 5GMM common procedures, e.g. the identification,
authentication and security procedures during the registration procedure,
depending on the information received in the REGISTRATION REQUEST message.
If two NAS security mode control procedures are needed to signal an entire
unciphered REGISTRATION REQUEST message followed by signalling of selected EPS
NAS security algorithms, both NAS security mode control procedures should be
initiated as part of 5GMM common procedures of the ongoing registration
procedure (see clause 5.4.2.4).
During a registration procedure with 5GS registration type IE set to
\"emergency registration\", if the AMF is configured to support emergency
registration for unauthenticated SUCIs, the AMF may choose to skip the
authentication procedure even if no 5G NAS security context is available and
proceed directly to the execution of the security mode control procedure.
##### 5.5.1.2.4 Initial registration accepted by the network
During a registration procedure with 5GS registration type IE set to
\"emergency registration\", the AMF shall not check for mobility and access
restrictions, regional restrictions or subscription restrictions, or CAG
restrictions when processing the REGISTRATION REQUEST message.
If the initial registration request is accepted by the network, the AMF shall
send a REGISTRATION ACCEPT message to the UE.
For each of the information elements: 5GMM capability, S1 UE network
capability, and UE security capability, the AMF shall store all octets
received from the UE in the REGISTRATION REQUEST message, up to the maximum
length defined for the respective information element.
NOTE 1: This information is forwarded to the new AMF during inter-AMF handover
or to the new MME during inter-system handover to S1 mode.
The AMF shall assign and include a TAI list as a registration area the UE is
registered to in the REGISTRATION ACCEPT message. The AMF shall not assign a
TAI list containing both tracking areas in NB-N1 mode and tracking areas not
in NB-N1 mode. The UE, upon receiving a REGISTRATION ACCEPT message, shall
delete its old TAI list and store the received TAI list. If the REGISTRATION
REQUEST message was received over non-3GPP access, the AMF shall include a
single TAI in the TAI list.
NOTE 2: For non-3GPP access, the operator can allocate a TAI per N3IWF, TNGF,
TWIF or W-AGF. Each N3IWF, TNGF, TWIF or W-AGF is locally configured with a
TAI. Each N3IWF, TNGF, TWIF or W-AGF can be configured with its own TAI value,
or with the same TAI value as other N3IWFs, TNGFs, TWIFs or W-AGFs.
NOTE 3: When assigning the TAI list, the AMF can take into account the
eNodeB\'s capability of support of CIoT 5GS optimization.
The AMF may include service area restrictions in the Service area list IE in
the REGISTRATION ACCEPT message. The UE, upon receiving a REGISTRATION ACCEPT
message with the service area restrictions shall act as described in subclause
5.3.5.
The AMF may also include a list of equivalent PLMNs in the REGISTRATION ACCEPT
message. Each entry in the list contains a PLMN code (MCC+MNC). The UE shall
store the list as provided by the network, and if the initial registration
procedure is not for emergency services, the UE shall remove from the list any
PLMN code that is already in the forbidden PLMN list as specified in subclause
5.3.13A. In addition, the UE shall add to the stored list the PLMN code of the
registered PLMN that sent the list. The UE shall replace the stored list on
each receipt of the REGISTRATION ACCEPT message. If the REGISTRATION ACCEPT
message does not contain a list, then the UE shall delete the stored list.
If the initial registration procedure is not for emergency services, the UE is
not registered for disaster roaming services, and if the PLMN identity of the
registered PLMN is a member of the forbidden PLMN list as specified in
subclause 5.3.13A, any such PLMN identity shall be deleted from the
corresponding list(s).
If the Service area list IE is not included in the REGISTRATION ACCEPT
message, any tracking area in the registered PLMN and its equivalent PLMN(s)
in the registration area is considered as an allowed tracking area as
described in subclause 5.3.5.
If the REGISTRATION REQUEST message contains the LADN indication IE, based on
the LADN indication IE, UE subscription information, UE location and local
configuration about LADN and:
\- if the LADN indication IE includes requested LADN DNNs, the UE subscribed
DNN list includes the requested LADN DNNs or the wildcard DNN, and the LADN
service area of the requested LADN DNN has an intersection with the current
registration area, the AMF shall determine the requested LADN DNNs included in
the LADN indication IE as LADN DNNs for the UE;
\- if no requested LADN DNNs included in the LADN indication IE and the
wildcard DNN is included in the UE subscribed DNN list, the AMF shall
determine the LADN DNN(s) configured in the AMF whose LADN service area has an
intersection with the current registration area as LADN DNNs for the UE; or
\- if no requested LADN DNNs included in the LADN indication IE and the
wildcard DNN is not included in the UE subscribed DNN list, or if the UE
subscribed DNN list does not include any of the DNNs in the LADN indication
IE, the AMF shall determine the LADN DNN(s) included in the UE subscribed DNN
list whose LADN service area has an intersection with the current registration
area as LADN DNNs for the UE.
If the LADN indication IE is not included in the REGISTRATION REQUEST message,
the AMF shall determine the LADN DNN(s) included in the UE subscribed DNN list
whose service area has an intersection with the current registration area as
LADN DNNs for the UE, except for the wildcard DNN included in the UE
subscribed DNN list.
If the UE supports WUS assistance information and the AMF supports and accepts
the use of WUS assistance information for the UE, then the AMF shall determine
the negotiated UE paging probability information for the UE, store it in the
5GMM context of the UE, and if the UE is not performing the initial
registration for emergency services, the AMF shall include it in the
Negotiated WUS assistance information IE in the REGISTRATION ACCEPT message.
The AMF may consider the UE paging probability information received in the
Requested WUS assistance information IE when determining the negotiated UE
paging probability information for the UE.
NOTE 4: Besides the UE paging probability information requested by the UE, the
AMF can take local configuration or previous statistical information for the
UE into account when determining the negotiated UE paging probability
information for the UE.
If the UE sets the NR-PSSI bit to \"NR paging subgrouping supported\" in the
5GMM capability IE in the REGISTRATION REQUEST message and the AMF supports
and accepts the use of PEIPS assistance information for the UE, then the AMF
shall determine the Paging subgroup ID for the UE, store it in the 5GMM
context of the UE, and shall include it in the Negotiated PEIPS assistance
information IE in the REGISTRATION ACCEPT message or in the Updated PEIPS
assistance information IE in the CONFIGURATION UPDATE COMMAND message as part
of the registration procedure. The AMF may consider the UE paging probability
information received in the Requested PEIPS assistance information IE when
determining the Paging subgroup ID for the UE.
NOTE 5: Besides the UE paging probability information when provided by the UE,
the AMF can also take local configuration, whether the UE is likely to receive
IMS voice over PS session calls, UE mobility pattern or previous statistical
information for the UE or information provided by the NG-RAN into account when
determining the Paging subgroup ID for the UE.
The AMF shall include the LADN information which consists of the determined
LADN DNNs for the UE and LADN service area(s) available in the current
registration area in the LADN information IE of the REGISTRATION ACCEPT
message.
The UE, upon receiving the REGISTRATION ACCEPT message with the LADN
information, shall store the received LADN information. If there exists one or
more LADN DNNs which are included in the LADN indication IE of the
REGISTRATION REQUEST message and are not included in the LADN information IE
of the REGISTRATION ACCEPT message, the UE considers such LADN DNNs as not
available in the current registration area.
The 5G-GUTI reallocation shall be part of the initial registration procedure.
During the initial registration procedure, if the AMF has not allocated a new
5G-GUTI by the generic UE configuration update procedure, the AMF shall
include in the REGISTRATION ACCEPT message the new assigned 5G-GUTI together
with the assigned TAI list.
If the UE has set the CAG bit to \"CAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message and the AMF needs to update the \"CAG
information list\" stored in the UE, the AMF shall include the CAG information
list IE or the Extended CAG information list IE in the REGISTRATION ACCEPT
message.
NOTE 6: The \"CAG information list\" can be provided by the AMF and include no
entry if no \"CAG information list\" exists in the subscription.
NOTE 7: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the UE does not support extended CAG information list, the CAG information
list shall not be included in the Extended CAG information list IE.
If a 5G-GUTI or the SOR transparent container IE is included in the
REGISTRATION ACCEPT message, the AMF shall start timer T3550 and enter state
5GMM-COMMON-PROCEDURE-INITIATED as described in subclause 5.1.3.2.3.3.
If the Operator-defined access category definitions IE, the Extended emergency
number list IE, the CAG information list IE or the Extended CAG information
list IE are included in the REGISTRATION ACCEPT message, the AMF shall start
timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in
subclause 5.1.3.2.3.3.
If the UE has set the RCMAP bit to \"Sending of REGISTRATION COMPLETE message
for negotiated PEIPS assistance information supported\" in the 5GMM capability
IE of the REGISTRATION REQUEST message and if the Negotiated PEIPS assistance
information IE is included in the REGISTRATION ACCEPT message, the AMF shall
start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described
in subclause 5.1.3.2.3.3.
If the UE is not in NB-N1 mode and the UE has set the RACS bit to \"RACS
supported\" in the 5GMM Capability IE of the REGISTRATION REQUEST message, the
AMF may include either a UE radio capability ID IE or a UE radio capability ID
deletion indication IE in the REGISTRATION ACCEPT message. If the UE radio
capability ID IE or the UE radio capability ID deletion indication IE is
included in the REGISTRATION ACCEPT message, the AMF shall start timer T3550
and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause
5.1.3.2.3.3.
The AMF shall include the MICO indication IE in the REGISTRATION ACCEPT
message only if the MICO indication IE was included in the REGISTRATION
REQUEST message, the AMF supports and accepts the use of MICO mode. If the AMF
supports and accepts the use of MICO mode, the AMF may indicate \"all PLMN
registration area allocated\" in the MICO indication IE in the REGISTRATION
ACCEPT message. If \"all PLMN registration area allocated\" is indicated in
the MICO indication IE, the AMF shall not assign and include the TAI list in
the REGISTRATION ACCEPT message. If the REGISTRATION ACCEPT message included
an MICO indication IE indicating \"all PLMN registration area allocated\", the
UE shall treat all TAIs in the current PLMN as a registration area and delete
its old TAI list. If \"strictly periodic registration timer supported\" is
indicated in the MICO indication IE in the REGISTRATION REQUEST message, the
AMF may indicate \"strictly periodic registration timer supported\" in the
MICO indication IE in the REGISTRATION ACCEPT message.
The AMF shall include an active time value in the T3324 IE in the REGISTRATION
ACCEPT message if the UE requested an active time value in the REGISTRATION
REQUEST message and the AMF accepts the use of MICO mode and the use of active
time.
If the AMF supports and accepts the use of MICO, and the UE included the
Requested T3512 value IE in the REGISTRATION REQUEST message, then the AMF
shall take into account the T3512 value requested when providing the T3512
value IE in the REGISTRATION ACCEPT message.
NOTE 8: The T3512 value assigned to the UE by AMF can be different from the
T3512 value requested by the UE. AMF can take several factors into account
when assigning the T3512 value, e.g. local configuration, expected UE
behaviour, UE requested T3512 value, UE subscription data, network policies.
The AMF shall include the T3512 value IE in the REGISTRATION ACCEPT message
only if the REGISTRATION REQUEST message was sent over the 3GPP access.
The AMF shall include the non-3GPP de-registration timer value IE in the
REGISTRATION ACCEPT message only if the REGISTRATION REQUEST message was sent
over the non-3GPP access.
If the UE requests \"control plane CIoT 5GS optimization\" in the 5GS update
type IE, indicates support of control plane CIoT 5GS optimization in the 5GMM
capability IE and the AMF decides to accept the requested CIoT 5GS
optimization and the registration request, the AMF shall indicate \"control
plane CIoT 5GS optimization supported\" in the 5GS network feature support IE
of the REGISTRATION ACCEPT message.
The AMF may include the T3447 value IE set to the service gap time value in
the REGISTRATION ACCEPT message if:
\- the UE has indicated support for service gap control in the REGISTRATION
REQUEST message; and
\- a service gap time value is available in the 5GMM context.
If there is a running T3447 timer in the AMF and the Follow-on request
indicator is set to \"Follow-on request pending\" in the REGISTRATION REQUEST
message, the AMF shall ignore the flag and proceed as if the flag was not
received except for the following cases:
a) the UE is configured for high priority access in the selected PLMN; or
b) the 5GS registration type IE in the REGISTRATION REQUEST message is set to
\"emergency registration\".
If the UE has indicated support for the control plane CIoT 5GS optimizations,
and the AMF decides to activate the congestion control for transport of user
data via the control plane, then the AMF shall include the T3448 value IE in
the REGISTRATION ACCEPT message.
If:
\- the UE in NB-N1 mode is using control plane CIoT 5GS optimization; and
\- the network is configured to provide the truncated 5G-S-TMSI configuration
for control plane CIoT 5GS optimizations;
the AMF shall include the Truncated 5G-S-TMSI configuration IE in the
REGISTRATION ACCEPT message and set the \"Truncated AMF Set ID value\" and the
\"Truncated AMF Pointer value\" in the Truncated 5G-S-TMSI configuration IE
based on network policies. The AMF shall start timer T3550 and enter state
5GMM-COMMON-PROCEDURE-INITIATED as described in subclause 5.1.3.2.3.3.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message, and
if:
> \- the UE has a valid aerial UE subscription information;
>
> \- the UUAA procedure is to be performed during the registration procedure
> according to operator policy;
>
> \- there is no valid successful UUAA result for the UE in the UE 5GMM
> context; and
>
> \- the REGISTRATION REQUEST message was not received over non-3GPP access,
then the AMF shall initiate the UUAA-MM procedure with the UAS-NF as specified
in TS 23.256 [6AB] and shall include a service-level-AA pending indication in
the Service-level-AA container IE of the REGISTRATION ACCEPT message. The AMF
shall store in the UE 5GMM context that a UUAA procedure is pending. The AMF
shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as
described in subclause 5.1.3.2.3.3. If the REGISTRATION REQUEST message was
received over non-3GPP access, the AMF shall not initiate UUAA-MM procedure.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message, and
if:
> \- the UE has a valid aerial UE subscription information;
>
> \- the UUAA procedure is to be performed during the registration procedure
> according to operator policy; and
>
> \- there is a valid successful UUAA result for the UE in the UE 5GMM
> context,
then the AMF shall include a service-level-AA response in the Service-level-AA
container IE of the REGISTRATION ACCEPT message and set the SLAR field in the
service-level-AA response to \"Service level authentication and authorization
was successful\".
If the AMF determines that the UUAA-MM procedure needs to be performed for a
UE, the AMF has not received the service-level device ID set to the CAA-level
UAV ID in the Service-level-AA container IE of the REGISTRATION REQUEST
message from the UE and the AMF decides to accept the UE to be registered for
other services than UAS services based on the user\'s subscription data and
the operator policy, the AMF shall accept the initial registration request and
shall mark in the UE\'s 5GMM context that the UE is not allowed to request UAS
services.
If the UE supports MINT, the AMF may include the List of PLMNs to be used in
disaster condition IE in the REGISTRATION ACCEPT message.
If the UE supports MINT, the AMF may include the Disaster roaming wait range
IE in the REGISTRATION ACCEPT message.
If the UE supports MINT, the AMF may include the Disaster return wait range IE
in the REGISTRATION ACCEPT message.
NOTE 9: The AMF can determine the contents of the \"list of PLMN(s) to be used
in disaster condition\", the value of the disaster roaming wait range and the
value of the disaster return wait range based on the network local
configuration.
If the AMF received the list of TAIs from the satellite NG-RAN as described in
3GPP TS 23.501 [8], and determines that, by UE subscription and operator\'s
preferences, any but not all TAIs in the received list of TAIs is forbidden
for roaming or for regional provision of service, the AMF shall include the
TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE; or
c) both;
in the REGISTRATION ACCEPT message.
NOTE 10: Void.
Upon receipt of the REGISTRATION ACCEPT message, the UE shall reset the
registration attempt counter, enter state 5GMM-REGISTERED and set the 5GS
update status to 5U1 UPDATED.
If the UE receives the REGISTRATION ACCEPT message from a PLMN, then the UE
shall reset the PLMN-specific attempt counter for that PLMN for the specific
access type for which the message was received. The UE shall also reset the
PLMN-specific N1 mode attempt counter for that PLMN for the specific access
type for which the message was received. If the message was received via 3GPP
access, the UE shall reset the counter for \"SIM/USIM considered invalid for
GPRS services\" events and the counter for \"SIM/USIM considered invalid for
non-GPRS services\" events, if any. If the message was received via non-3GPP
access, the UE shall reset the counter for \"USIM considered invalid for 5GS
services over non-3GPP\" events.
If the UE receives the REGISTRATION ACCEPT message from an SNPN, then the UE
shall reset the SNPN-specific attempt counter for the current SNPN for the
specific access type for which the message was received. If the message was
received via 3GPP access, the UE shall reset the counter for \"the entry for
the current SNPN considered invalid for 3GPP access\" events. If the message
was received via non-3GPP access, the UE shall reset the counter for \"the
entry for the current SNPN considered invalid for non-3GPP access\" events.
If the REGISTRATION ACCEPT message included a T3512 value IE, the UE shall use
the value in the T3512 value IE as periodic registration update timer (T3512).
If the REGISTRATION ACCEPT message include a T3324 value IE, the UE shall use
the value in the T3324 value IE as active timer (T3324).
If the REGISTRATION ACCEPT message included a non-3GPP de-registration timer
value IE, the UE shall use the value in non-3GPP de-registration timer value
IE as non-3GPP de-registration timer.
If the REGISTRATION ACCEPT message contains the Network slicing indication IE
with the Network slicing subscription change indication set to \"Network
slicing subscription changed\", or contains a Configured NSSAI IE with a new
configured NSSAI for the current PLMN or SNPN and optionally the mapped
S-NSSAI(s) for the configured NSSAI for the current PLMN or SNPN, or contains
an NSSRG information IE with a new NSSRG information, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge the successful update
of the network slicing information. If the UE has set the RCMAN bit to
\"Sending of REGISTRATION COMPLETE message for NSAG information supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message and if REGISTRATION
ACCEPT message contains the NSAG information IE, the UE shall return
REGISTRATION COMPLETE message to the AMF to acknowledge the reception of the
NSAG information IE.
If the REGISTRATION ACCEPT message contains the CAG information list IE or the
Extended CAG information list IE and the UE had set the CAG bit to \"CAG
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message, the
UE shall:
a) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
NOTE 11: When the UE receives the CAG information list IE or the Extended CAG
information list IE in the HPLMN derived from the IMSI, the EHPLMN list is
present and is not empty and the HPLMN is not present in the EHPLMN list, the
UE behaves as if it receives the CAG information list IE or the Extended CAG
information list IE in a VPLMN.
b) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 12: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
c) remove the serving VPLMN\'s entry of the \"CAG information list\" stored in
the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
The UE shall store the \"CAG information list\" received in the CAG
information list IE or the Extended CAG information list IE as specified in
annex C.
If the received \"CAG information list\" includes an entry containing the
identity of the registered PLMN, the UE shall operate as follows:
a) if the UE receives the REGISTRATION ACCEPT message via a CAG cell, the
entry for the registered PLMN in the received \"CAG information list\" does
not include any of the CAG-ID(s) supported by the current CAG cell, and:
1) the entry for the registered PLMN in the received \"CAG information list\"
does not include an \"indication that the UE is only allowed to access 5GS via
CAG cells\", then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE
and shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP
TS 36.304 [25C] with the updated \"CAG information list\"; or
2) the entry for the registered PLMN in the received \"CAG information list\"
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and:
i) if the entry for the registered PLMN in the received \"CAG information
list\" includes one or more CAG-IDs, the UE shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to
3GPP TS 38.304 [28] with the updated \"CAG information list\"; or
ii) if the entry for the registered PLMN in the received \"CAG information
list\" does not include any CAG-ID, the UE has not set the 5GS registration
type IE in the REGISTRATION REQUEST message to \"emergency registration\", and
the initial registration was not initiated to perform handover of an existing
emergency PDU session from the non-current access to the current access, then
the UE shall enter the state 5GMM-REGISTERED.PLMN-SEARCH and shall apply the
PLMN selection process defined in 3GPP TS 23.122 [5] with the updated \"CAG
information list\"; or
b) if the UE receives the REGISTRATION ACCEPT message via a non-CAG cell and
the entry for the registered PLMN in the received \"CAG information list\"
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and:
1) if the \"allowed CAG list\" for the registered PLMN in the received \"CAG
information list\" includes one or more CAG-IDs, the UE shall enter the state
5GMM-REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according
to 3GPP TS 38.304 [28] with the updated \"CAG information list\"; or
2) if the entry for the registered PLMN in the received \"CAG information
list\" does not include any CAG-ID, the UE has not set the 5GS registration
type IE in the REGISTRATION REQUEST message to \"emergency registration\", and
the initial registration was not initiated to perform handover of an existing
emergency PDU session from the non-current access to the current access, then
the UE shall enter the state 5GMM-REGISTERED.PLMN-SEARCH and shall apply the
PLMN selection process defined in 3GPP TS 23.122 [5] with the updated \"CAG
information list\".
If the received \"CAG information list\" does not include an entry containing
the identity of the registered PLMN and the UE receives the REGISTRATION
ACCEPT message via a CAG cell, the UE shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to
3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C] with the updated \"CAG information
list\".
If the REGISTRATION ACCEPT message contains the Operator-defined access
category definitions IE, the Extended emergency number list IE ,the CAG
information list IE or the Extended CAG information list IE, the UE shall
return a REGISTRATION COMPLETE message to the AMF to acknowledge reception of
the operator-defined access category definitions, the extended local emergency
numbers list or the \"CAG information list\".
If the UE has set the RCMAP bit to \"Sending of REGISTRATION COMPLETE message
for negotiated PEIPS parameters supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message and if REGISTRATION ACCEPT message contains the
Negotiated PEIPS assistance information IE, the UE shall return REGISTRATION
COMPLETE message to the AMF to acknowledge the reception of the Negotiated
PEIPS assistance information IE.
If the REGISTRATION ACCEPT message contains the UE radio capability ID IE or
the UE radio capability ID deletion indication IE, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge reception of the UE
radio capability ID IE or the UE radio capability ID deletion indication IE.
Upon receiving a REGISTRATION COMPLETE message, the AMF shall stop timer T3550
and change to state 5GMM-REGISTERED. The 5G-GUTI, if sent in the REGISTRATION
ACCEPT message, shall be considered as valid, the PEIPS assistance
information, if sent in the REGISTRATION ACCEPT message, shall be considered
as valid, and the UE radio capability ID, if sent in the REGISTRATION ACCEPT,
shall be considered as valid.
If the 5GS update type IE was included in the REGISTRATION REQUEST message
with the SMS requested bit set to \"SMS over NAS supported\", and SMSF
selection is successful, then the AMF shall send the REGISTRATION ACCEPT
message after the SMSF has confirmed that the activation of the SMS service
was successful. When sending the REGISTRATION ACCEPT message, the AMF shall:
a) set the SMS allowed bit of the 5GS registration result IE to \"SMS over NAS
allowed\" in the REGISTRATION ACCEPT message, if the UE has set the SMS
requested bit of the 5GS update type IE to \"SMS over NAS supported\" in the
REGISTRATION REQUEST message and the network allows the use of SMS over NAS
for the UE; and
b) store the SMSF address and the value of the SMS allowed bit of the 5GS
registration result IE in the UE 5GMM context and consider the UE available
for SMS over NAS.
If:
a) the SMSF selection in the AMF is not successful;
b) the SMS activation via the SMSF is not successful;
c) the AMF does not allow the use of SMS over NAS;
d) the SMS requested bit of the 5GS update type IE was set to \"SMS over NAS
not supported\" in the REGISTRATION REQUEST message; or
e) the 5GS update type IE was not included in the REGISTRATION REQUEST
message;
then the AMF shall set the SMS allowed bit of the 5GS registration result IE
to \"SMS over NAS not allowed\" in the REGISTRATION ACCEPT message.
When the UE receives the REGISTRATION ACCEPT message, if the UE is also
registered over another access to the same PLMN, the UE considers the value
indicated by the SMS allowed bit of the 5GS registration result IE as
applicable for both accesses over which the UE is registered.
The AMF shall include the 5GS registration result IE in the REGISTRATION
ACCEPT message. If the 5GS registration result IE value indicates:
a) \"3GPP access\", the UE:
\- shall consider itself as being registered to 3GPP access only; and
\- if in 5GMM-REGISTERED state over non-3GPP access and on the same PLMN as
3GPP access, shall enter state 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION over
non-3GPP access and set the 5GS update status to 5U2 NOT UPDATED over non-3GPP
access;
b) \"Non-3GPP access\", the UE:
\- shall consider itself as being registered to non-3GPP access only; and
\- if in the 5GMM-REGISTERED state over 3GPP access and is on the same PLMN as
non-3GPP access, shall enter the state 5GMM-DEREGISTERED.ATTEMPTING-
REGISTRATION over 3GPP access and set the 5GS update status to 5U2 NOT UPDATED
over 3GPP access; or
c) \"3GPP access and Non-3GPP access\", the UE shall consider itself as being
registered to both 3GPP access and non-3GPP access.
In roaming scenarios, the AMF shall provide mapped S-NSSAI(s) for the
configured NSSAI, the allowed NSSAI, the rejected NSSAI (if Extended rejected
NSSAI IE is used), the pending NSSAI or NSSRG information when included in the
REGISTRATION ACCEPT message.
The AMF shall include the allowed NSSAI for the current PLMN or SNPN and, in
roaming scenarios, shall include the mapped S-NSSAI(s) for the allowed NSSAI
contained in the requested NSSAI from the UE, in the REGISTRATION ACCEPT
message if the UE included the requested NSSAI in the REGISTRATION REQUEST
message and the AMF allows one or more S-NSSAIs in the requested NSSAI.
The AMF may also include rejected NSSAI in the REGISTRATION ACCEPT message if
the initial registration request is not for onboarding services in SNPN. If
the UE has set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message, the rejected NSSAI
shall be included in the Extended rejected NSSAI IE in the REGISTRATION ACCEPT
message; otherwise the rejected NSSAI shall be included in the Rejected NSSAI
IE in the REGISTRATION ACCEPT message. If the initial registration request is
for onboarding services in SNPN, the AMF shall not include rejected NSSAI in
the REGISTRATION ACCEPT message.
If the UE has set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message, the rejected NSSAI
contains S-NSSAI(s) which was included in the requested NSSAI but rejected by
the network associated with rejection cause(s); otherwise the rejected NSSAI
contains S-NSSAI(s) which was included in the requested NSSAI but rejected by
the network associated with rejection cause(s) with the following
restrictions:
a) rejected NSSAI for the current PLMN or SNPN shall not include an S-NSSAI
for the current PLMN or SNPN which is associated to multiple mapped S-NSSAIs
and some of these but not all mapped S-NSSAIs are not allowed; and
b) rejected NSSAI for the current registration area shall not include an
S-NSSAI for the current PLMN or SNPN which is associated to multiple mapped
S-NSSAIs and some of these but not all mapped S-NSSAIs are not allowed.
NOTE 13: The UE that does not support extended rejected NSSAI can avoid
requesting an S-NSSAI associated with a mapped S-NSSAI, which was included in
the previous requested NSSAI but neither in the allowed NSSAI nor in the
rejected NSSAI in the consequent registration procedures.
If the UE indicated the support for network slice-specific authentication and
authorization, and if the Requested NSSAI IE includes one or more S-NSSAIs
subject to network slice-specific authentication and authorization, the AMF
shall in the REGISTRATION ACCEPT message include:
a) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s), if
any:
1) which are not subject to network slice-specific authentication and
authorization and are allowed by the AMF; or
2) for which the network slice-specific authentication and authorization has
been successfully performed;
b) optionally, the rejected NSSAI;
c) pending NSSAI containing one or more S-NSSAIs for which network slice-
specific authentication and authorization (except for re-NSSAA) will be
performed or is ongoing, and one or more S-NSSAIs from the pending NSSAI which
the AMF provided to the UE during the previous registration procedure for
which network slice-specific authentication and authorization will be
performed or is ongoing, if any; and
d) the \"NSSAA to be performed\" indicator in the 5GS registration result IE
set to indicate that the network slice-specific authentication and
authorization procedure will be performed by the network, if the allowed NSSAI
is not included in the REGISTRATION ACCEPT message.
If the initial registration request is not for onboarding services in SNPN,
the UE indicated the support for network slice-specific authentication and
authorization, and:
a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message or none of the S-NSSAIs in the requested NSSAI in the REGISTRATION
REQUEST message are allowed;
b) all default S-NSSAIs are subject to network slice-specific authentication
and authorization; and
c) the network slice-specific authentication and authorization procedure has
not been successfully performed for any of the default S-NSSAIs,
the AMF shall in the REGISTRATION ACCEPT message include:
a) the \"NSSAA to be performed\" indicator in the 5GS registration result IE
to indicate that the network slice-specific authentication and authorization
procedure will be performed by the network;
b) pending NSSAI containing one or more default S-NSSAIs for which network
slice-specific authentication and authorization will be performed or is
ongoing and one or more S-NSSAIs from the pending NSSAI which the AMF provided
to the UE during the previous registration procedure for which network slice-
specific authentication and authorization will be performed or is ongoing (if
any); and
c) optionally, the rejected NSSAI.
If the initial registration request is not for onboarding services in SNPN,
the UE indicated the support for network slice-specific authentication and
authorization, and:
a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message or none of the S-NSSAIs in the requested NSSAI in the REGISTRATION
REQUEST message are allowed; and
b) one or more default S-NSSAIs are not subject to network slice-specific
authentication and authorization or the network slice-specific authentication
and authorization procedure has been successfully performed for one or more
default S-NSSAIs;
the AMF shall in the REGISTRATION ACCEPT message include:
a) pending NSSAI containing one or more default S-NSSAIs for which network
slice-specific authentication and authorization will be performed or is
ongoing (if any) and one or more S-NSSAIs from the pending NSSAI which the AMF
provided to the UE during the previous registration procedure for which
network slice-specific authentication and authorization will be performed or
is ongoing (if any);
b) allowed NSSAI containing S-NSSAI(s) for the current PLMN each of which
corresponds to a default S-NSSAI which are not subject to network slice-
specific authentication and authorization or for which the network slice-
specific authentication and authorization has been successfully performed;
c) allowed NSSAI containing one or more default S-NSSAIs, as the mapped
S-NSSAI(s) for the allowed NSSAI in roaming scenarios, which are not subject
to network slice-specific authentication and authorization or for which the
network slice-specific authentication and authorization has been successfully
performed; and
d) optionally, the rejected NSSAI.
If the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message or none of the S-NSSAIs in the requested NSSAI in the REGISTRATION
REQUEST message are allowed, the allowed NSSAI shall not contain default
S-NSSAI(s) that are subject to NSAC. If the subscription information includes
the NSSRG information, the S-NSSAIs of the allowed NSSAI shall be associated
with at least one common NSSRG value.
When the REGISTRATION ACCEPT message includes a pending NSSAI, the pending
NSSAI shall contain all S-NSSAIs for which network slice-specific
authentication and authorization (except for re-NSSAA) will be performed or is
ongoing from the requested NSSAI of the REGISTRATION REQUEST message that was
received over the 3GPP access, non-3GPP access, or both the 3GPP access and
non-3GPP access.
If the UE supports extended rejected NSSAI and the AMF determines that maximum
number of UEs reached for one or more S-NSSAI(s) in the requested NSSAI as
specified in subclause 4.6.2.5**, the AMF shall include the rejected NSSAI**
containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available due to maximum number of UEs reached\" in the Extended rejected
NSSAI IE **in the** REGISTRATION ACCEPT message. In addition, the AMF may
include a back-off timer value for each S-NSSAI with the rejection cause
\"S-NSSAI not available due to maximum number of UEs reached\" included in the
Extended rejected NSSAI IE of the REGISTRATION ACCEPT message. To avoid that
large numbers of UEs simultaneously initiate deferred requests, the network
should select the value for the backoff timer for each S-NSSAI for the
informed UEs so that timeouts are not synchronised.
If the UE does not indicate support for extended rejected NSSAI and **the
maximum number of UEs has been reached, the AMF should include the rejected
NSSAI** containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available in the current registration area\" in the Rejected NSSAI IE and
**should not include these S-NSSAIs in the allowed NSSAI in the** REGISTRATION
ACCEPT message.
NOTE 14: Based on network policies, the AMF can include the S-NSSAI(s) for
which the maximum number of UEs has been reached in the rejected NSSAI with
rejection causes other than \"S-NSSAI not available in the current
registration area\".
The AMF may include a new configured NSSAI for the current PLMN or SNPN in the
REGISTRATION ACCEPT message if:
a) the REGISTRATION REQUEST message did not include the requested NSSAI and
the initial registration request is not for onboarding services in SNPN;
b) the REGISTRATION REQUEST message included the requested NSSAI containing an
S-NSSAI that is not valid in the serving PLMN or SNPN;
c) the REGISTRATION REQUEST message included the requested NSSAI containing
S-NSSAI(s) with incorrect mapped S-NSSAI(s);
d) the REGISTRATION REQUEST message included the Network slicing indication IE
with the Default configured NSSAI indication bit set to \"Requested NSSAI
created from default configured NSSAI\";
e) the S-NSSAIs of the requested NSSAI in the REGISTRATION REQUEST message are
not associated with any common NSSRG value, except for the case that the AMF,
based on the indication received from the UDM as specified in 3GPP TS 23.501
[8], has provided all subscribed S-NSSAIs in the configured NSSAI to a UE who
does not support NSSRG; or
NOTE 15: If the S-NSSAIs of the requested NSSAI in the REGISTRATION REQUEST
message are not associated with any common NSSRG value, it is possible that at
least one of the S-NSSAIs is not included in any of new allowed NSSAI, new
(extended) rejected NSSAI (if applicable), and new pending NSSAI (if
applicable).
f) the S-NSSAIs of the requested NSSAI in the REGISTRATION REQUEST message
over the current access and the allowed NSSAI over the other access are not
associated with any common NSSRG value.
If a new configured NSSAI for the current PLMN or SNPN is included in the
REGISTRATION ACCEPT message and the UE is roaming, the AMF shall also include
the mapped S-NSSAI(s) for the configured NSSAI for the current PLMN or SNPN in
the REGISTRATION ACCEPT message. In this case the AMF shall start timer T3550
and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause
5.1.3.2.3.3.
If a new configured NSSAI for the current PLMN is included in the REGISTRATION
ACCEPT message, the subscription information includes the NSSRG information,
and the NSSRG bit in the 5GMM capability IE of the REGISTRATION REQUEST
message is set to:
a) \"NSSRG supported\", then the AMF shall include the NSSRG information in
the REGISTRATION ACCEPT message; or
b) \"NSSRG not supported\", then the configured NSSAI shall include one or
more S-NSSAIs each of which is associated with all the NSSRG value(s) of the
default S-NSSAI(s), or the configured NSSAI shall include, based on the
indication received from the UDM as specified in 3GPP TS 23.501 [8], all
subscribed S-NSSAIs even if these S-NSSAIs do not share any common NSSRG
value.
If the AMF needs to update the NSSRG information and the UE has set the NSSRG
bit to \"NSSRG supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message, then the AMF shall include the new NSSRG information in the
REGISTRATION ACCEPT message. In addition, the AMF shall start timer T3550 and
enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause
5.1.3.2.3.3.
If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message over 3GPP access, the AMF may include the
NSAG information IE in the REGISTRATION ACCEPT message. Up to 4 NSAG entries
are allowed to be associated with a TAI list in the NSAG information IE.
NOTE 15a: How the AMF selects NSAG entries to be included in the NSAG
information IE is implementation specific, e.g. take the NSAG priority and the
current registration area into account.
NOTE 15b: If the NSAG for the PLMN and its equivalent PLMN(s) have different
associations with S-NSSAIs, then the AMF includes a TAI list for the NSAG
entry in the NSAG information IE.
If the UE receives the NSAG information IE in the REGISTRATION ACCEPT message,
the UE shall store the NSAG information as specified in subclause 4.6.2.2.
If the UE requests ciphering keys for ciphered broadcast assistance data in
the REGISTRATION REQUEST message and the AMF has valid ciphering key data
applicable to the UE\'s subscription and current tracking area, then the AMF
shall include the ciphering key data in the Ciphering key data IE of the
REGISTRATION ACCEPT message.
The AMF shall include the Network slicing indication IE with the Network
slicing subscription change indication set to \"Network slicing subscription
changed\" in the REGISTRATION ACCEPT message if the UDM has indicated that the
subscription data for network slicing has changed. In this case the AMF shall
start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described
in subclause 5.1.3.2.3.3.
The UE that has indicated the support for network slice-specific
authentication and authorization receiving the pending NSSAI in the
REGISTRATION ACCEPT message shall store the S-NSSAI(s) in the pending NSSAI as
specified in subclause 4.6.2.2. If the registration area contains TAIs
belonging to different PLMNs, which are equivalent PLMNs, the UE shall store
the received pending NSSAI for each of the equivalent PLMNs as specified in
subclause 4.6.2.2. If the pending NSSAI is not included in the REGISTRATION
ACCEPT message and the \"NSSAA to be performed\" indicator is not set to
\"Network slice-specific authentication and authorization is to be performed\"
in the 5GS registration result IE of the REGISTRATION ACCEPT message, then the
UE shall delete the pending NSSAI for the current PLMN or SNPN and its
equivalent PLMN(s), if existing, as specified in subclause 4.6.2.2.
The UE receiving the rejected NSSAI in the REGISTRATION ACCEPT message takes
the following actions based on the rejection cause in the rejected S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt to use
this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE, the
UICC containing the USIM is removed, the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
registration area as specified in subclause 4.6.2.2 and shall not attempt to
use this S-NSSAI(s) in the current registration area until switching off the
UE, the UE moving out of the current registration area, the UICC containing
the USIM is removed, the entry of the \"list of subscriber data\" with the
SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are
removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI in the current PLMN or SNPN over any access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed or deleted as described in
subclause 4.6.1 and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
Unless the back-off timer value received along with the S-NSSAI is zero, the
UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
NOTE 16: If the back-off timer value received along with the S-NSSAI in the
rejected NSSAI for the maximum number of UEs reached is zero as specified in
subclause 10.5.7.4a of TS 24.008, the UE does not consider the S-NSSAI as the
rejected S-NSSAI.
If there is one or more S-NSSAIs in the rejected NSSAI with the rejection
cause \"S-NSSAI not available due to maximum number of UEs reached\", then for
each S-NSSAI, the UE shall behave as follows:
a) stop the timer T3526 associated with the S-NSSAI, if running;
b) start the timer T3526 with:
1) the back-off timer value received along with the S-NSSAI, if a back-off
timer value is received along with the S-NSSAI that is neither zero nor
deactivated; or
2) an implementation specific back-off timer value, if no back-off timer value
is received along with the S-NSSAI; and
c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs
reached when the timer T3526 associated with the S-NSSAI expires.
If the UE sets the NSSAA bit in the 5GMM capability IE to \"Network slice-
specific authentication and authorization not supported\", and:
a) if the Requested NSSAI IE only includes the S-NSSAI(s) subject to network
slice-specific authentication and authorization and one or more default
S-NSSAIs (containing one or more S-NSSAIs each of which may be associated with
a new S-NSSAI) which are not subject to network slice-specific authentication
and authorization are available, the AMF shall in the REGISTRATION ACCEPT
message include:
1) the allowed NSSAI containing S-NSSAI(s) for the current PLMN or SNPN each
of which corresponds to a default S-NSSAI which are not subject to network
slice-specific authentication and authorization;
2) the allowed NSSAI containing the default S-NSSAIs, as the mapped S-NSSAI(s)
for the allowed NSSAI in roaming scenarios, which are not subject to network
slice-specific authentication and authorization; and
3) the rejected NSSAI containing the S-NSSAI(s) subject to network slice
specific authentication and authorization with the rejection cause indicating
\"S-NSSAI not available in the current PLMN or SNPN\", except if the UE has
not set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message and the S-NSSAI(s) is
associated to multiple mapped S-NSSAIs and some of these but not all mapped
S-NSSAIs are subject to NSSAA; or
b) if the Requested NSSAI IE includes one or more S-NSSAIs subject to network
slice-specific authentication and authorization, the AMF shall in the
REGISTRATION ACCEPT message include:
1) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s) which
are not subject to network slice-specific authentication and authorization;
and
2) the rejected NSSAI containing:
i) the S-NSSAI(s) subject to network slice specific authentication and
authorization with the rejection cause indicating \"S-NSSAI not available in
the current PLMN or SNPN\", except if the UE has not set the ER-NSSAI bit to
\"Extended rejected NSSAI supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message and the S-NSSAI is associated to multiple mapped
S-NSSAIs and some of these but not all mapped S-NSSAIs are subject to NSSAA;
and
ii) the S-NSSAI(s) which was included in the requested NSSAI but rejected by
the network associated with the rejection cause indicating \"S-NSSAI not
available in the current PLMN or SNPN\" or the rejection cause indicating
\"S-NSSAI not available in the current registration area\", if any.
If the UE does not indicate support for network slice-specific authentication
and authorization, the initial registration request is not for onboarding
services in SNPN, and if:
a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message; or
b) none of the S-NSSAIs in the requested NSSAI in the REGISTRATION REQUEST
message are allowed;
and one or more default S-NSSAIs (containing one or more S-NSSAIs each of
which may be associated with a new S-NSSAI) which are not subject to network
slice-specific authentication and authorization are available, the AMF shall:
a) put the allowed S-NSSAI(s) for the current PLMN or SNPN each of which
corresponds to a default S-NSSAI and not subject to network slice-specific
authentication and authorization in the allowed NSSAI of the REGISTRATION
ACCEPT message;
b) put the default S-NSSAIs and not subject to network slice-specific
authentication and authorization, as the mapped S-NSSAI(s) for the allowed
NSSAI in roaming scenarios, in the allowed NSSAI of the REGISTRATION ACCEPT
message; and
c) determine a registration area such that all S-NSSAIs of the allowed NSSAI
are available in the registration area.
If the REGISTRATION ACCEPT message contains the Network slicing indication IE
with the Network slicing subscription change indication set to \"Network
slicing subscription changed\", the UE shall delete the network slicing
information for each and every PLMN except for the current PLMN as specified
in subclause 4.6.2.2.
If the REGISTRATION ACCEPT message contains the allowed NSSAI, then the UE
shall store the included allowed NSSAI together with the PLMN identity of the
registered PLMN or the SNPN identity of the registered SNPN and the
registration area as specified in subclause 4.6.2.2. If the registration area
contains TAIs belonging to different PLMNs, which are equivalent PLMNs, the UE
shall store the received allowed NSSAI in each of allowed NSSAIs which are
associated with each of the PLMNs.
If the REGISTRATION ACCEPT message contains a configured NSSAI IE with a new
configured NSSAI for the current PLMN or SNPN and optionally the mapped
S-NSSAI(s) for the configured NSSAI for the current PLMN or SNPN, the UE shall
store the contents of the configured NSSAI IE as specified in subclause
4.6.2.2. In addition, if the REGISTRATION ACCEPT message contains an NSSRG
information IE, the UE shall store the contents of the NSSRG information IE as
specified in subclause 4.6.2.2.
If the REGISTRATION ACCEPT message:
a) includes the 5GS registration result IE with the \"NSSAA to be performed\"
indicator set to \"Network slice-specific authentication and authorization is
to be performed\";
b) includes a pending NSSAI; and
c) does not include an allowed NSSAI,
the UE shall delete the stored allowed NSSAI, if any, as specified in
subclause 4.6.2.2, and the UE:
a) shall not initiate a 5GSM procedure except for emergency services ; and
b) shall not initiate a service request procedure except for cases f), i), m)
and o) in subclause 5.6.1.1;
c) shall not initiate an NAS transport procedure except for sending SMS, an
LPP message, a location service message, an SOR transparent container, a UE
policy container, a UE parameters update transparent container or a CIoT user
data container;
until the UE receives an allowed NSSAI.
If the UE included S1 mode supported indication in the REGISTRATION REQUEST
message, the AMF supporting interworking with EPS shall set the IWK N26 bit to
either:
a) \"interworking without N26 interface not supported\" if the AMF supports
N26 interface; or
b) \"interworking without N26 interface supported\" if the AMF does not
support N26 interface
in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
The UE supporting S1 mode shall operate in the mode for interworking with EPS
as follows:
a) if the IWK N26 bit in the 5GS network feature support IE is set to
\"interworking without N26 interface not supported\", the UE shall operate in
single-registration mode;
b) if the IWK N26 bit in the 5GS network feature support IE is set to
\"interworking without N26 interface supported\" and the UE supports dual-
registration mode, the UE may operate in dual-registration mode; or
NOTE 17: The registration mode used by the UE is implementation dependent.
c) if the IWK N26 bit in the 5GS network feature support IE is set to
\"interworking without N26 interface supported\" and the UE only supports
single-registration mode, the UE shall operate in single-registration mode.
The UE shall treat the received interworking without N26 interface indicator
for interworking with EPS as valid in the entire PLMN and its equivalent
PLMN(s).
The network informs the UE about the support of specific features, such as IMS
voice over PS session, location services (5G-LCS), emergency services,
emergency services fallback and ATSSS, in the 5GS network feature support
information element. In a UE with IMS voice over PS session capability, the
IMS voice over PS session indicator, the Emergency services support indicator,
and the Emergency services fallback indicator shall be provided to the upper
layers. The upper layers take the IMS voice over PS session indicator into
account when selecting the access domain for voice sessions or calls. In a UE
with LCS capability, location services indicator (5G-LCS) shall be provided to
the upper layers. When initiating an emergency call, the upper layers also
take the IMS voice over PS session indicator, the Emergency services support
indicator, and the Emergency services fallback indicator into account for the
access domain selection. In a UE with the capability for ATSSS, the network
support for ATSSS shall be provided to the upper layers. If the UE receives
the 5GS network feature support IE with the ATSSS support indicator set to
\"ATSSS not supported\", the UE shall perform a local release of the MA PDU
session, if any.
The AMF shall set the EMF bit in the 5GS network feature support IE to:
a) \"Emergency services fallback supported in NR connected to 5GCN and E-UTRA
connected to 5GCN\" if the network supports the emergency services fallback
procedure when the UE is in an NR cell connected to 5GCN or an E-UTRA cell
connected to 5GCN;
b) \"Emergency services fallback supported in NR connected to 5GCN only\" if
the network supports the emergency services fallback procedure when the UE is
in an NR cell connected to 5GCN and does not support the emergency services
fallback procedure when the UE is in an E-UTRA cell connected to 5GCN;
c) \"Emergency services fallback supported in E-UTRA connected to 5GCN only\"
if the network supports the emergency services fallback procedure when the UE
is in an E-UTRA cell connected to 5GCN and does not support the emergency
services fallback procedure when the UE is in an NR cell connected to 5GCN; or
d) \"Emergency services fallback not supported\" if network does not support
the emergency services fallback procedure when the UE is in any cell connected
to 5GCN.
NOTE 18: If the emergency services are supported in neither the EPS nor the
5GS homogeneously, based on operator policy, the AMF will set the EMF bit in
the 5GS network feature support IE to \"Emergency services fallback not
supported\".
NOTE 19: Even though the AMF\'s support of emergency services fallback is
indicated per RAT, the UE\'s support of emergency services fallback is not per
RAT, i.e. the UE\'s support of emergency services fallback is the same for
both NR connected to 5GCN and E-UTRA connected to 5GCN.
If the UE is not operating in SNPN access operation mode:
a) the network informs the UE that the use of access identity 1 is valid in
the RPLMN or equivalent PLMN by setting the MPS indicator bit of the 5GS
network feature support IE to \"Access identity 1 valid\", in the REGISTRATION
ACCEPT message. Based on operator policy, the AMF sets the MPS indicator bit
in the REGISTRATION ACCEPT message based on the MPS priority information in
the user\'s subscription context obtained from the UDM;
b) upon receiving a REGISTRATION ACCEPT message with the MPS indicator bit set
to \"Access identity 1 valid\", the UE shall act as a UE with access identity
1 configured for MPS as described in subclause 4.5.2, in all NG-RAN of the
registered PLMN and its equivalent PLMNs. The MPS indicator bit in the 5GS
network feature support IE provided in the REGISTRATION ACCEPT message is
valid until the UE receives a REGISTRATION ACCEPT message with the MPS
indicator bit set to \"Access identity 1 not valid\" or until the UE selects a
non-equivalent PLMN. Access identity 1 is only applicable while the UE is in
N1 mode.
c) the network informs the UE that the use of access identity 2 is valid in
the RPLMN or equivalent PLMN by setting the MCS indicator bit of the 5GS
network feature support IE to \"Access identity 2 valid\", in the REGISTRATION
ACCEPT message. Based on operator policy, the AMF sets the MCS indicator bit
in the REGISTRATION ACCEPT message based on the MCS priority information in
the user\'s subscription context obtained from the UDM; and
d) upon receiving a REGISTRATION ACCEPT message with the MCS indicator bit set
to \"Access identity 2 valid\", the UE shall act as a UE with access identity
2 configured for MCS as described in subclause 4.5.2, in all NG-RAN of the
registered PLMN and its equivalent PLMNs. The MCS indicator bit in the 5GS
network feature support IE provided in the REGISTRATION ACCEPT message is
valid until the UE receives a REGISTRATION ACCEPT message with the MCS
indicator bit set to \"Access identity 2 not valid\" or until the UE selects a
non-equivalent PLMN. Access identity 2 is only applicable while the UE is in
N1 mode.
If the UE is operating in SNPN access operation mode:
a) the network informs the UE that the use of access identity 1 is valid in
the RSNPN by setting the MPS indicator bit of the 5GS network feature support
IE to \"Access identity 1 valid\", in the REGISTRATION ACCEPT message. Based
on operator policy, the AMF sets the MPS indicator bit in the REGISTRATION
ACCEPT message based on the MPS priority information in the user\'s
subscription context obtained from the UDM;
b) upon receiving a REGISTRATION ACCEPT message with the MPS indicator bit set
to \"Access identity 1 valid\", the UE shall act as a UE with access identity
1 configured for MPS as described in subclause 4.5.2A, in all NG-RAN of the
registered SNPN. The MPS indicator bit in the 5GS network feature support IE
provided in the REGISTRATION ACCEPT message is valid until the UE receives a
REGISTRATION ACCEPT message with the MPS indicator bit set to \"Access
identity 1 not valid\" or until the UE selects another SNPN. Access identity 1
is only applicable while the UE is in N1 mode.
c) the network informs the UE that the use of access identity 2 is valid in
the RSNPN by setting the MCS indicator bit of the 5GS network feature support
IE to \"Access identity 2 valid\", in the REGISTRATION ACCEPT message. Based
on operator policy, the AMF sets the MCS indicator bit in the REGISTRATION
ACCEPT message based on the MCS priority information in the user\'s
subscription context obtained from the UDM; and
d) upon receiving a REGISTRATION ACCEPT message with the MCS indicator bit set
to \"Access identity 2 valid\", the UE shall act as a UE with access identity
2 configured for MCS as described in subclause 4.5.2A, in all NG-RAN of the
registered SNPN. The MCS indicator bit in the 5GS network feature support IE
provided in the REGISTRATION ACCEPT message is valid until the UE receives a
REGISTRATION ACCEPT message with the MCS indicator bit set to \"Access
identity 2 not valid\" or until the UE selects another SNPN. Access identity 2
is only applicable while the UE is in N1 mode.
If the UE indicates support for restriction on use of enhanced coverage in the
REGISTRATION REQUEST message and:
a) in WB-N1 mode, the AMF decides to restrict the use of CE mode B for the UE,
then the AMF shall set the RestrictEC bit to \"CE mode B is restricted\";
b) in WB-N1 mode, the AMF decides to restrict the use of both CE mode A and CE
mode B for the UE, then the AMF shall set the RestrictEC bit to \" Both CE
mode A and CE mode B are restricted\"; or
c) in NB-N1 mode, the AMF decides to restrict the use of enhanced coverage for
the UE, then the AMF shall set the RestrictEC bit to \"Use of enhanced
coverage is restricted\",
in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
If the UE indicates support of the N1 NAS signalling connection release in the
REGISTRATION REQUEST message and the network decides to accept the N1 NAS
signalling connection release, then the AMF shall set the N1 NAS signalling
connection release bit to \"N1 NAS signalling connection release supported\"
in the 5GS network feature support IE of the REGISTRATION ACCEPT message.
If the UE indicates support of the paging indication for voice services in the
REGISTRATION REQUEST message and the network decides to accept the paging
indication for voice services, then the AMF shall set the paging indication
for voice services bit to \"paging indication for voice services supported\"
in the 5GS network feature support IE of the REGISTRATION ACCEPT message. Upon
receipt of REGISTRATION ACCEPT message with the paging indication for voice
services bit set to \"paging indication for voice services supported\", the UE
NAS layer informs the lower layers that paging indication for voice services
is supported. Otherwise, the UE NAS layer informs the lower layers that paging
indication for voice services is not supported.
If the UE indicates support of the reject paging request in the REGISTRATION
REQUEST message and the network decides to accept the reject paging request,
then the AMF shall set the reject paging request bit to \"reject paging
request supported\" in the 5GS network feature support IE of the REGISTRATION
ACCEPT message.
If the UE indicates support of the paging restriction in the REGISTRATION
REQUEST message, and the AMF sets:
\- the reject paging request bit to \"reject paging request supported\";
\- the N1 NAS signalling connection release bit to \"N1 NAS signalling
connection release supported\"; or
\- both of them;
in the 5GS network feature support IE of the REGISTRATION ACCEPT message, and
the network decides to accept the paging restriction, then the AMF shall set
the paging restriction bit to \"paging restriction supported\" in the 5GS
network feature support IE of the REGISTRATION ACCEPT message.
If the UE has set the Follow-on request indicator to \"Follow-on request
pending\" in the REGISTRATION REQUEST message, or the network has downlink
signalling pending, the AMF shall not immediately release the NAS signalling
connection after the completion of the registration procedure.
If the UE is authorized to use V2X communication over PC5 reference point
based on:
a) at least one of the following bits in the 5GMM capability IE of the
REGISTRATION REQUEST message set by the UE, or already stored in the 5GMM
context in the AMF during the previous registration procedure as follows:
1) the V2XCEPC5 bit to \"V2X communication over E-UTRA-PC5 supported\"; or
2) the V2XCNPC5 bit to \"V2X communication over NR-PC5 supported\"; and
b) the user\'s subscription context obtained from the UDM as defined in 3GPP
TS 23.287 [6C];
the AMF should not immediately release the NAS signalling connection after the
completion of the registration procedure.
If the UE is authorized to use 5G ProSe services based on:
a) at least one of the following bits in the 5GMM capability IE of the
REGISTRATION REQUEST message set by the UE, or already stored in the 5GMM
context in the AMF during the previous registration procedure as follows:
1) the 5G ProSe direct discovery bit to \"5G ProSe direct discovery
supported\"; or
2) the 5G ProSe direct communication bit to \"5G ProSe direct communication
supported\"; and
b) the user\'s subscription context obtained from the UDM as defined in 3GPP
TS 23.304 [6E];
the AMF should not immediately release the NAS signalling connection after the
completion of the registration procedure.
If the Requested DRX parameters IE was included in the REGISTRATION REQUEST
message, the AMF shall include the Negotiated DRX parameters IE in the
REGISTRATION ACCEPT message. The AMF may set the Negotiated DRX parameters IE
based on the received Requested DRX parameters IE and operator policy if
available.
If the Requested NB-N1 mode DRX parameters IE was included in the REGISTRATION
REQUEST message, the AMF shall include the Negotiated NB-N1 mode DRX
parameters IE in the REGISTRATION ACCEPT message. The AMF may set the
Negotiated NB-N1 mode DRX parameters IE based on the received Requested NB-N1
mode DRX parameters IE and operator policy if available.
The AMF shall include the Negotiated extended DRX parameters IE in the
REGISTRATION ACCEPT message only if the Requested extended DRX parameters IE
was included in the REGISTRATION REQUEST message, and the AMF supports and
accepts the use of eDRX. The AMF may set the Negotiated extended DRX
parameters IE based on the received Requested extended DRX parameters IE,
operator policy, information from NG-RAN and the user\'s subscription context
obtained from the UDM if available.
If:
a) the UE\'s USIM is configured with indication that the UE is to receive the
SOR transparent container IE, the SOR transparent container IE included in the
REGISTRATION ACCEPT message does not successfully pass the integrity check
(see 3GPP TS 33.501 [24]); and
b) if the UE attempts obtaining service on another PLMNs as specified in 3GPP
TS 23.122 [5] annex C;
then the UE shall locally release the established N1 NAS signalling connection
after sending a REGISTRATION COMPLETE message.
If:
a) the UE\'s USIM is configured with indication that the UE is to receive the
SOR transparent container IE, the SOR transparent container IE is not included
in the REGISTRATION ACCEPT message; and
b) the UE attempts obtaining service on another PLMNs as specified in 3GPP TS
23.122 [5] annex C;
then the UE shall locally release the established N1 NAS signalling
connection.
If:
a) the UE operates in SNPN access operation mode;
b) the ME is configured to indicate that the UE shall expect to receive the
steering of roaming information during initial registration procedure for the
selected entry of the \"list of subscriber data\" or the selected PLMN
subscription;
c) the SOR transparent container IE included in the REGISTRATION ACCEPT
message does not successfully pass the integrity check (see 3GPP TS 33.501
[24]); and
d) the UE attempts obtaining service on another SNPN as specified in 3GPP TS
23.122 [5] annex C;
then the UE shall locally release the established N1 NAS signalling connection
after sending a REGISTRATION COMPLETE message.
If:
a) the UE operates in SNPN access operation mode;
b) the ME is configured to indicate that the UE shall expect to receive the
steering of roaming information during initial registration procedure for the
selected entry of the \"list of subscriber data\" or the selected PLMN
subscription;
c) the SOR transparent container IE is not included in the REGISTRATION ACCEPT
message; and
d) the UE attempts obtaining service on another SNPN as specified in 3GPP TS
23.122 [5] annex C;
then the UE shall locally release the established N1 NAS signalling
connection.
If the REGISTRATION ACCEPT message includes the SOR transparent container IE
and the SOR transparent container IE successfully passes the integrity check
(see 3GPP TS 33.501 [24]), the ME shall store the received SOR counter as
specified in annex C and proceed as follows:
a) the UE shall proceed with the behaviour as specified in 3GPP TS 23.122 [5]
annex C; and
b) if the registration procedure is performed over 3GPP access and the UE
attempts obtaining service on another PLMNs or SNPNs as specified in 3GPP TS
23.122 [5] annex C, then the UE may locally release the established N1 NAS
signalling connection after sending a REGISTRATION COMPLETE message. Otherwise
the UE shall send a REGISTRATION COMPLETE message and not release the current
N1 NAS signalling connection locally. If an acknowledgement is requested in
the SOR transparent container IE of the REGISTRATION ACCEPT message, the UE
acknowledgement is included in the SOR transparent container IE of the
REGISTRATION COMPLETE message. In the SOR transparent container IE carrying
the acknowledgement, the UE shall set the ME support of SOR-CMCI indicator to
\"SOR-CMCI supported by the ME\". Additionally, if the UE supports access to
an SNPN using credentials from a credentials holder and the UE is not
operating in SNPN access operation mode, the UE may set the ME support of SOR-
SNPN-SI indicator to \"SOR-SNPN-SI supported by the ME\".
If the SOR transparent container IE successfully passes the integrity check
(see 3GPP TS 33.501 [24]) and:
a) the list type indicates:
1) \"PLMN ID and access technology list\", and the SOR transparent container
IE indicates a list of preferred PLMN/access technology combinations is
provided, then the ME shall replace the highest priority entries in the
\"Operator Controlled PLMN Selector with Access Technology\" list stored in
the ME and shall proceed with the behaviour as specified in 3GPP TS 23.122 [5]
annex C; or
2) \"secured packet\", then the ME shall behave as if a SMS is received with
protocol identifier set to SIM data download, data coding scheme set to class
2 message and SMS payload as secured packet contents of SOR transparent
container IE. The SMS payload is forwarded to UICC as specified in 3GPP TS
23.040 [4A] and the ME shall proceed with the behaviour as specified in 3GPP
TS 23.122 [5] annex C; or
b) the list type indicates \"PLMN ID and access technology list\" and the SOR
transparent container IE indicates \"HPLMN indication that \'no change of the
\"Operator Controlled PLMN Selector with Access Technology\" list stored in
the UE is needed and thus no list of preferred PLMN/access technology
combinations is provided\'\", the UE operates in SNPN access operation mode
and the SOR transparent container IE includes SOR-SNPN-SI, the ME shall
replace SOR-SNPN-SI of the selected entry of the \"list of subscriber data\"
or associated with the selected PLMN subscription, as specified in 3GPP TS
23.122 [5] with the received SOR-SNPN-SI.
If the SOR-CMCI is present and the Store SOR-CMCI in ME indicator is set to
\"Store SOR-CMCI in ME\" then the UE shall store or delete the SOR-CMCI in the
non-volatile memory of the ME as described in annex C.1.
The UE shall proceed with the behaviour as specified in 3GPP TS 23.122 [5]
annex C.
If the SOR transparent container IE does not pass the integrity check
successfully, then the UE shall discard the content of the SOR transparent
container IE.
If required by operator policy, the AMF shall include the NSSAI inclusion mode
IE in the REGISTRATION ACCEPT message (see table 4.6.2.3.1 of subclause
4.6.2.3). Upon receipt of the REGISTRATION ACCEPT message:
a) if the message includes the NSSAI inclusion mode IE, the UE shall operate
in the NSSAI inclusion mode indicated in the NSSAI inclusion mode IE over the
current access within the current PLMN or SNPN and its equivalent PLMN(s), if
any, in the current registration area; or
b) otherwise:
1) if the UE has NSSAI inclusion mode for the current PLMN or SNPN and access
type stored in the UE, the UE shall operate in the stored NSSAI inclusion
mode;
2) if the UE does not have NSSAI inclusion mode for the current PLMN or SNPN
and the access type stored in the UE and if the UE is performing the
registration procedure over:
i) 3GPP access, the UE shall operate in NSSAI inclusion mode D in the current
PLMN or SNPN and the current access type;
ii) untrusted non-3GPP access, the UE shall operate in NSSAI inclusion mode B
in the current PLMN and the current access type; or
iii) trusted non-3GPP access, the UE shall operate in NSSAI inclusion mode D
in the current PLMN and the current access type; or
3) if the 5G-RG does not have NSSAI inclusion mode for the current PLMN and
wireline access stored in the 5G-RG, and the 5G-RG is performing the
registration procedure over wireline access, the 5G-RG shall operate in NSSAI
inclusion mode B in the current PLMN and the current access type.
The AMF may include operator-defined access category definitions in the
REGISTRATION ACCEPT message.
If the UE receives Operator-defined access category definitions IE in the
REGISTRATION ACCEPT message and the Operator-defined access category
definitions IE contains one or more operator-defined access category
definitions, the UE shall delete any operator-defined access category
definitions stored for the RPLMN and shall store the received operator-defined
access category definitions for the RPLMN. If the UE receives the Operator-
defined access category definitions IE in the REGISTRATION ACCEPT message and
the Operator-defined access category definitions IE contains no operator-
defined access category definitions, the UE shall delete any operator-defined
access category definitions stored for the RPLMN. If the REGISTRATION ACCEPT
message does not contain the Operator-defined access category definitions IE,
the UE shall not delete the operator-defined access category definitions
stored for the RPLMN.
If the UE has indicated support for service gap control in the REGISTRATION
REQUEST message and:
\- the REGISTRATION ACCEPT message contains the T3447 value IE, then the UE
shall store the new T3447 value, erase any previous stored T3447 value if
exists and use the new T3447 value with the timer T3447 next time it is
started; or
\- the REGISTRATION ACCEPT message does not contain the T3447 value IE, then
the UE shall erase any previous stored T3447 value if exists and stop the
timer T3447 if running.
If the T3448 value IE is present in the received REGISTRATION ACCEPT message
and the value indicates that this timer is neither zero nor deactivated, the
UE shall:
a) stop timer T3448 if it is running; and
b) start timer T3448 with the value provided in the T3448 value IE.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the
T3448 value IE is present in the REGISTRATION ACCEPT message and the value
indicates that this timer is either zero or deactivated, the UE shall ignore
the T3448 value IE and proceed as if the T3448 value IE was not present.
If the REGISTRATION ACCEPT message contains the Truncated 5G-S-TMSI
configuration IE, then the UE shall store the included truncated 5G-S-TMSI
configuration and return a REGISTRATION COMPLETE message to the AMF to
acknowledge reception of the truncated 5G-S-TMSI configuration.
NOTE 20: The UE provides the truncated 5G-S-TMSI configuration to the lower
layers.
If the UE is not in NB-N1 mode, the UE has set the RACS bit to \"RACS
supported\" in the 5GMM Capability IE of the REGISTRATION REQUEST message and
the REGISTRATION ACCEPT message includes:
a) a UE radio capability ID deletion indication IE set to \"Network-assigned
UE radio capability IDs deletion requested\", the UE shall delete any network-
assigned UE radio capability IDs associated with the RPLMN or RSNPN and, if
the UE supports access to an SNPN using credentials from a credentials holder,
the selected entry of the \"list of subscriber data\" or the selected PLMN
subscription stored at the UE, then the UE shall, after the completion of the
ongoing registration procedure, initiate a registration procedure for mobility
and periodic registration update as specified in subclause 5.5.1.3.2 over the
existing N1 NAS signalling connection; or
b) a UE radio capability ID IE, the UE shall store the UE radio capability ID
as specified in annex C.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message and
the REGISTRATION ACCEPT message contains the service-level-AA pending
indication in the Service-level-AA container IE, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge reception of the
service-level-AA pending indication, and the UE shall not attempt to perform
another registration procedure for UAS services until the UUAA-MM procedure is
completed, or to establish a PDU session for USS communication or a PDU
session for C2 communication until the UUAA-MM procedure is completed
successfully.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message and
the REGISTRATION ACCEPT message does not contain the service-level-AA pending
indication in the Service-level-AA container IE, the UE shall consider the
UUAA-MM procedure is not triggered.
If the REGISTRATION REQUEST message includes the 5GS registration type IE set
to \"SNPN onboarding registration\" or the network determines that the UE\'s
subscription only allows for configuration of SNPN subscription parameters in
PLMN via the user plane, the AMF may start an implementation specific timer
for onboarding services when the network considers that the UE is in 5GMM-
REGISTERED (i.e. the network receives the REGISTRATION COMPLETE message from
UE).
NOTE 21: If the AMF considers that the UE is in 5GMM-IDLE, when the
implementation specific timer for onboarding services expires and the network
considers that the UE is still in state 5GMM-REGISTERED, the AMF can locally
de-register the UE; or if the UE is in 5GMM-CONNECTED, the AMF can initiate
the network-initiated de-registration procedure (see subclause 5.5.2.3).
NOTE 22: The value of the implementation specific timer for onboarding
services needs to be large enough to allow a UE to complete the configuration
of one or more entries of the \"list of subscriber data\" taking into
consideration that configuration of SNPN subscription parameters in PLMN via
the user plane or onboarding services in SNPN involves third party entities
outside of the operator\'s network.
If the UE receives the List of PLMNs to be used in disaster condition IE in
the REGISTRATION ACCEPT message and the UE supports MINT, the UE shall delete
the \"list of PLMN(s) to be used in disaster condition\" stored in the ME
together with the PLMN ID of the RPLMN, if any, and may store the \"list of
PLMN(s) to be used in disaster condition\" included in the List of PLMNs to be
used in disaster condition IE in the ME together with the PLMN ID of the
RPLMN.
If the UE receives the Disaster roaming wait range IE in the REGISTRATION
ACCEPT message and the UE supports MINT, the UE shall delete the disaster
roaming wait range stored in the ME, if any, and store the disaster roaming
wait range included in the Disaster roaming wait range IE in the ME.
If the UE receives the Disaster return wait range IE in the REGISTRATION
ACCEPT message and the UE supports MINT, the UE shall delete the disaster
return wait range stored in the ME, if any, and store the disaster return wait
range included in the Disaster return wait range IE in the ME.
If the 5GS registration type IE in the REGISTRATION REQUEST message is set to
\"disaster roaming initial registration\" and:
a) the MS determined PLMN with disaster condition IE is included in the
REGISTRATION REQUEST message, the AMF shall determine the PLMN with disaster
condition in the MS determined PLMN with disaster condition IE;
b) the MS determined PLMN with disaster condition IE is not included in the
REGISTRATION REQUEST message and the Additional GUTI IE is included in the
REGISTRATION REQUEST message and contains 5G-GUTI of a PLMN of the country of
the PLMN providing disaster roaming services, the AMF shall determine the PLMN
with disaster condition in the PLMN identity of the 5G-GUTI;
c) the MS determined PLMN with disaster condition IE and the Additional GUTI
IE are not included in the REGISTRATION REQUEST message and:
1) the 5GS mobile identity IE contains 5G-GUTI of a PLMN of the country of the
PLMN providing disaster roaming services, the AMF shall determine the PLMN
with disaster condition in the PLMN identity of the 5G-GUTI; or
2) the 5GS mobile identity IE contains SUCI of a PLMN of the country of the
PLMN providing disaster roaming services, the AMF shall determine the PLMN
with disaster condition in the PLMN identity of the SUCI; or
d) the MS determined PLMN with disaster condition IE is not included in the
REGISTRATION REQUEST message, NG-RAN of the PLMN providing disaster roaming
broadcasts disaster roaming indication and:
\- the Additional GUTI IE is included in the REGISTRATION REQUEST message and
contains 5G-GUTI of a PLMN of a country other than the country of the PLMN
providing disaster roaming services; or
\- the Additional GUTI IE is not included and the 5GS mobile identity IE
contains 5G-GUTI or SUCI of a PLMN of a country other than the country of the
PLMN providing disaster roaming services;
the AMF shall determine the PLMN with disaster condition based on the disaster
roaming agreement arrangement between mobile network operators.
NOTE 23: The disaster roaming agreement arrangement between mobile network
operators is out scope of 3GPP.
If the AMF determines that a disaster condition applies to the PLMN with
disaster condition, and the UE is allowed to be registered for disaster
roaming services, the AMF shall set the Disaster roaming registration result
value bit in the 5GS registration result IE to \"no additional information\"
in the REGISTRATION ACCEPT message. If the AMF determines that the UE can be
registered to the PLMN for normal service, the AMF shall set the Disaster
roaming registration result value bit in the 5GS registration result IE to
\"request for registration for disaster roaming services accepted as
registration not for disaster roaming services \" in the REGISTRATION ACCEPT
message.
If the UE indicates \"disaster roaming initial registration\" in the 5GS
registration type IE in the REGISTRATION REQUEST message and the 5GS
registration result IE value in the REGISTRATION ACCEPT message is set to:
\- \"request for registration for disaster roaming service accepted as
registration not for disaster roaming services\", the UE shall consider itself
registered for normal service. If the PLMN identity of the registered PLMN is
a member of the forbidden PLMN list as specified in subclause 5.3.13A, any
such PLMN identity shall be deleted from the corresponding list(s); or
\- \"no additional information\", the UE shall consider itself registered for
disaster roaming services.
If the UE receives the forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the REGISTRATION ACCEPT message and if the
TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking
areas for roaming\", the UE shall store the TAI(s) included in the IE, if not
already stored, into the list of \"5GS forbidden tracking areas for roaming\".
If the UE receives the forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the REGISTRATION
ACCEPT message and if the TAI(s) included in the IE is not part of the list of
\"5GS forbidden tracking areas for regional provision of service\", the UE
shall store the TAI(s) included in the IE, if not already stored, into the
list of \"5GS forbidden tracking areas for regional provision of service\".
##### 5.5.1.2.5 Initial registration not accepted by the network
If the initial registration request cannot be accepted by the network, the AMF
shall send a REGISTRATION REJECT message to the UE including an appropriate
5GMM cause value.
If the initial registration request is rejected due to general NAS level
mobility management congestion control, the network shall set the 5GMM cause
value to #22 \"congestion\" and assign a value for back-off timer T3346.
In NB-N1 mode, if the registration request is rejected due to operator
determined barring (see 3GPP TS 29.503 [20AB]), the network shall set the 5GMM
cause value to #22 \"congestion\" and assign a value for back-off timer T3346.
If the REGISTRATION REJECT message with 5GMM cause #76 or #78 was received
without integrity protection, then the UE shall discard the message. If the
REGISTRATION REJECT message with 5GMM cause #62 was received without integrity
protected, the behaviour of the UE is specified in subclause 5.3.20.2.
Based on operator policy, if the initial registration request is rejected due
to core network redirection for CIoT optimizations, the network shall set the
5GMM cause value to #31 \"Redirection to EPC required\".
NOTE 1: The network can take into account the UE\'s S1 mode capability, the
EPS CIoT network behaviour supported by the UE or the EPS CIoT network
behaviour supported by the EPC to determine the rejection with the 5GMM cause
value #31 \"Redirection to EPC required\".
If the initial registration request is rejected because:
a) all the S-NSSAI(s) included in the requested NSSAI are rejected; and
b) the UE set the NSSAA bit in the 5GMM capability IE to:
1) \"Network slice-specific authentication and authorization supported\" and:
i) there are no default S-NSSAIs;
ii) all default S-NSSAIs are not allowed; or
iii) network slice-specific authentication and authorization has failed or
been revoked for all default S-NSSAIs and based on network local policy, the
network decides not to initiate the network slice-specific re-authentication
and re-authorization procedures for any subscribed S-NSSAI marked as default
requested by the UE; or
2) \"Network slice-specific authentication and authorization not supported\";
and
i) there are no default S-NSSAIs; or
ii) all default S-NSSAIs are either not allowed or are subject to network
slice-specific authentication and authorization;
the network shall set the 5GMM cause value to #62 \"No network slices
available\" and shall include the rejected S-NSSAI(s) in the rejected NSSAI of
the REGISTRATION REJECT message. Otherwise, the network may include the
rejected S-NSSAI(s) in the rejected NSSAI of the REGISTRATION REJECT message.
If the UE has set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message, the rejected
S-NSSAI(s) shall be included in the Extended rejected NSSAI IE of the
REGISTRATION REJECT message. Otherwise the rejected S-NSSAI(s) shall be
included in the Rejected NSSAI IE of the REGISTRATION REJECT message.
If the UE supports extended rejected NSSAI and the AMF determines that maximum
number of UEs reached for one or more S-NSSAIs in the requested NSSAI as
specified in subclause 4.6.2.5**, the AMF shall include the rejected NSSAI**
containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available due to maximum number of UEs reached\" in the Extended rejected
NSSAI IE **in the** REGISTRATION REJECT message. In addition, the AMF may
include a back-off timer value for each S-NSSAI with the rejection cause
\"S-NSSAI not available due to maximum number of UEs reached\" in the Extended
rejected NSSAI IE of the REGISTRATION REJECT message.
If the AMF receives the initial registration request along with the
authenticated indication over N2 reference point on non-3GPP access and does
not receive the indication that authentication by the home network is not
required over N12 reference point, the network shall set the 5GMM cause value
to #72 \"Non-3GPP access to 5GCN not allowed\".
If the initial registration request from a UE supporting CAG is rejected due
to CAG restrictions, the network shall set the 5GMM cause value to #76 \"Not
authorized for this CAG or authorized for CAG cells only\" and should include
the \"CAG information list\" in the CAG information list IE or the Extended
CAG information list IE in the REGISTRATION REJECT message.
NOTE 2: The network cannot be certain that \"CAG information list\" stored in
the UE is updated as result of sending of the REGISTRATION REJECT message with
the CAG information list IE or the Extended CAG information list IE, as the
REGISTRATION REJECT message is not necessarily delivered to the UE (e.g. due
to abnormal radio conditions).
NOTE 3: The \"CAG information list\" can be provided by the AMF and include no
entry if no \"CAG information list\" exists in the subscription.
NOTE 4: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the UE does not support extended CAG information list, the CAG information
list shall not be included in the Extended CAG information list IE.
If the initial registration request from a UE not supporting CAG is rejected
due to CAG restrictions, the network shall operate as described in bullet j)
of subclause 5.5.1.2.8.
If the UE\'s initial registration request is via a satellite NG-RAN cell and
the network using the User Location Information provided by the NG-RAN, see
3GPP TS 38.413 [31], is able to determine that the UE is in a location where
the network is not allowed to operate, the network shall set the 5GMM cause
value in the REGISTRATION REJECT message to #78 \"PLMN not allowed to operate
at the present UE location\".
NOTE 5: When the UE is accessing network for emergency services, it is up to
operator and regulatory policies whether the network needs to determine if the
UE is in a location where network is not allowed to operate.
If the AMF receives the initial registration request including the service-
level device ID set to the CAA-level UAV ID in the Service-level-AA container
IE and the AMF determines that the UE is not allowed to use UAS services via
5GS based on the user\'s subscription data and the operator policy, the AMF
shall return a REGISTRATION REJECT message with 5GMM cause #79 (UAS services
not allowed).
If the UE initiates the registration procedure for disaster roaming services
and the AMF determines that it does not support providing disaster roaming
services for the determined PLMN with disaster condition to the UE, then the
AMF shall send a REGISTRATION REJECT message with 5GMM cause #80 (Disaster
roaming for the determined PLMN with disaster condition not allowed).
If the AMF received multiple TAIs from the satellite NG-RAN as described in
3GPP TS 23.501 [8], and determines that, by UE subscription and operator\'s
preferences, all of the received TAIs are forbidden for roaming or for
regional provision of service, the AMF shall include the TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE; or
c) both;
in the REGISTRATION REJECT message.
Regardless of the 5GMM cause value received in the REGISTRATION REJECT message
via satellite NG-RAN,
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the REGISTRATION REJECT message and if the
TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking
areas for roaming\", the UE shall store the TAI(s) included in the IE, if not
already stored, into the list of \"5GS forbidden tracking areas for roaming\";
and
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the REGISTRATION
REJECT message and if the TAI(s) included in the IE is not part of the list of
\"5GS forbidden tracking areas for regional provision of service\", the UE
shall store the TAI(s) included in the IE, if not already stored, into the
list of \"5GS forbidden tracking areas for regional provision of service\".
Furthermore, the UE shall take the following actions depending on the 5GMM
cause value received in the REGISTRATION REJECT message.
#3 (Illegal UE); or
#6 (Illegal ME).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not performing initial registration for
onboarding services in SNPN and the UE does not support access to an SNPN
using credentials from a credentials holder, the UE shall consider the entry
of the \"list of subscriber data\" with the SNPN identity of the current SNPN
as invalid until the UE is switched off, the entry is updated or the timer
T3245 expires as described in clause 5.3.19a.2. In case of SNPN, if the UE is
not performing initial registration for onboarding services in SNPN and the UE
supports access to an SNPN using credentials from a credentials holder, the UE
shall consider the selected entry of the \"list of subscriber data\" as
invalid for 3GPP access until the UE is switched off, the entry is updated or
the timer T3245 expires as described in clause 5.3.19a.2. Additionally, if EAP
based primary authentication and key agreement procedure using EAP-AKA\' or 5G
AKA based primary authentication and key agreement procedure was performed in
the current SNPN, the UE shall consider the USIM as invalid for the current
SNPN until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not performing initial registration for onboarding services in
SNPN and the UE shall delete the list of equivalent PLMNs (if any) and enter
the state 5GMM-DEREGISTERED.NO-SUPI. If the message has been successfully
integrity checked by the NAS, then the UE shall:
1) set the counter for \"SIM/USIM considered invalid for GPRS services\"
events and the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events in case of PLMN if the UE maintains these counters;
or
2) set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events in case of SNPN if the UE
maintains these counters;
to a UE implementation-specific maximum value.
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the EPS attach request
procedure is rejected with the EMM cause with the same value. The USIM shall
be considered as invalid also for non-EPS services until switching off, the
UICC containing the USIM is removed or the timer T3245 expires as described in
clause 5.3.7a in 3GPP TS 24.301 [15]. If the message has been successfully
integrity checked by the NAS and the UE maintains a counter for \"SIM/USIM
considered invalid for non-GPRS services\", then the UE shall set this counter
to a UE implementation-specific maximum value.
If the UE is performing initial registration for onboarding services in SNPN,
the UE shall reset the registration attempt counter, store the SNPN identity
in the \"permanently forbidden SNPNs\" list for onboarding services, enter
state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN
selection for onboarding services according to 3GPP TS 23.122 [5]. If the
message has been successfully integrity checked by the NAS, the UE shall set
the SNPN-specific attempt counter for the current SNPN to the UE
implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access, the UE shall
in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not performing initial registration for
onboarding services in SNPN and the UE does not support access to an SNPN
using credentials from a credentials holder, the UE shall consider the entry
of the \"list of subscriber data\" with the SNPN identity of the current SNPN
as invalid for 5GS services until the UE is switched off, the entry is updated
or the timer T3245 expires as described in clause 5.3.19a.2. In case of SNPN,
if the UE is not performing initial registration for onboarding services in
SNPN and the UE supports access to an SNPN using credentials from a
credentials holder, the UE shall consider the selected entry of the \"list of
subscriber data\" as invalid for 3GPP access until the UE is switched off, the
entry is updated or the timer T3245 expires as described in clause 5.3.19a.2.
Additionally, if EAP based primary authentication and key agreement procedure
using EAP-AKA\' or 5G AKA based primary authentication and key agreement
procedure was performed in the current SNPN, the UE shall consider the USIM as
invalid for the current SNPN until switching off, the UICC containing the USIM
is removed or the timer T3245 expires as described in clause 5.3.19a.2.
If the UE is not performing initial registration for onboarding services in
SNPN, the UE shall enter the state 5GMM-DEREGISTERED.NO-SUPI. If the message
has been successfully integrity checked by the NAS, then the UE shall:
1) set the counter for \"SIM/USIM considered invalid for GPRS services\"
events and the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events in case of PLMN if the UE maintains these counters;
or
2) set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events in case of SNPN if the UE
maintains these counters;
to a UE implementation-specific maximum value.
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the EPS attach request
procedure is rejected with the EMM cause with the same value.
If the UE is performing initial registration for onboarding services in SNPN,
the UE shall reset the registration attempt counter, store the SNPN identity
in the \"permanently forbidden SNPNs\" list for onboarding services, enter
state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN
selection for onboarding services according to 3GPP TS 23.122 [5]. If the
message has been successfully integrity checked by the NAS, the UE shall set
the SNPN-specific attempt counter for the current SNPN to the UE
implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access, the UE shall
in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#11 (PLMN not allowed).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs and reset the registration attempt counter and store the PLMN
identity in the forbidden PLMN list as specified in subclause 5.3.13A and if
the UE is configured to use timer T3245 then the UE shall start timer T3245
and proceed as described in clause 5.3.19a.1. For 3GPP access the UE shall
enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection
according to 3GPP TS 23.122 [5], and for non-3GPP access the UE shall enter
state 5GMM-DEREGISTERED.LIMITED-SERVICE and perform network selection as
defined in 3GPP TS 24.502 [18]. If the message has been successfully integrity
checked by the NAS and the UE maintains the PLMN-specific attempt counter and
the PLMN-specific attempt counter for non-3GPP access for that PLMN, the UE
shall set the PLMN-specific attempt counter and the PLMN-specific attempt
counter for non-3GPP access for that PLMN to the UE implementation-specific
maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition handle the EMM parameters EMM
state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI
and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case
when the EPS attach request procedure is rejected with the EMM cause with the
same value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.
If the REGISTRATION REJECT message is not integrity protected, the UE shall
memorize the current TAI was stored in the list of \"5GS forbidden tracking
areas for regional provision of service\" for non-integrity protected NAS
reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\" for the current SNPN and, if the UE supports access to
an SNPN using credentials from a credentials holder, the selected entry of the
\"list of subscriber data\" or the selected PLMN subscription, and enter the
state 5GMM-DEREGISTERED.LIMITED-SERVICE. If the REGISTRATION REJECT is not
integrity protected, the UE shall memorize the current TAI was stored in the
list of \"5GS forbidden tracking areas for regional provision of service\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, for non-integrity protected NAS
reject message.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS
attach request procedure is rejected with the EMM cause with the same value.
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall delete
the list of equivalent PLMNs (if available) and reset the registration attempt
counter.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE or optionally 5GMM-
DEREGISTERED.PLMN-SEARCH. If the REGISTRATION REJECT message is not integrity
protected, the UE shall memorize the current TAI was stored in the list of
\"5GS forbidden tracking areas for roaming\" for non-integrity protected NAS
reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for roaming\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, and enter the state 5GMM-
DEREGISTERED.LIMITED-SERVICE or optionally 5GMM-DEREGISTERED.PLMN-SEARCH. If
the REGISTRATION REJECT message is not integrity protected, the UE shall
memorize the current TAI was stored in the list of \"5GS forbidden tracking
areas for roaming\" for the current SNPN and, if the UE supports access to an
SNPN using credentials from a credentials holder, the selected entry of the
\"list of subscriber data\" or the selected PLMN subscription, for non-
integrity protected NAS reject message.
For 3GPP access, if the UE is registered in S1 mode and operating in dual-
registration mode, the PLMN that the UE chooses to register in is specified in
subclause 4.8.3. Otherwise the UE shall perform a PLMN selection or SNPN
selection according to 3GPP TS 23.122 [5].
For non-3GPP access, the UE shall perform network selection as defined in 3GPP
TS 24.502 [18].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS
attach request procedure is rejected with the EMM cause with the same value.
#15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE. If the REGISTRATION
REJECT message is not integrity protected, the UE shall memorize the current
TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for
non-integrity protected NAS reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for roaming\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, and enter the state 5GMM-
DEREGISTERED.LIMITED-SERVICE. If the REGISTRATION REJECT message is not
integrity protected, the UE shall memorize the current TAI was stored in the
list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and,
if the UE supports access to an SNPN using credentials from a credentials
holder, the selected entry of the \"list of subscriber data\" or the selected
PLMN subscription, for non-integrity protected NAS reject message.
The UE shall search for a suitable cell in another tracking area according to
3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS
attach request procedure is rejected with the EMM cause with the same value.
If received over non-3GPP access the cause shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.5.1.2.7.
#22 (Congestion).
If the T3346 value IE is present in the REGISTRATION REJECT message and the
value indicates that this timer is neither zero nor deactivated, the UE shall
proceed as described below; otherwise it shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.5.1.2.7.
The UE shall abort the initial registration procedure, set the 5GS update
status to 5U2 NOT UPDATED, reset the registration attempt counter and enter
state 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION.
The UE shall stop timer T3346 if it is running.
If the REGISTRATION REJECT message is integrity protected, the UE shall start
timer T3346 with the value provided in the T3346 value IE.
If the REGISTRATION REJECT message is not integrity protected, the UE shall
start timer T3346 with a random value from the default range specified in 3GPP
TS 24.008 [12].
The UE stays in the current serving cell and applies the normal cell
reselection process. The initial registration procedure is started if still
needed when timer T3346 expires or is stopped.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, and attach attempt counter as specified in 3GPP TS 24.301 [15]
for the case when the EPS attach request procedure is rejected with the EMM
cause with the same value.
If the UE is registering for onboarding services in SNPN, the UE may enter the
state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN
selection for onboarding services according to 3GPP TS 23.122 [5].
#27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter and shall enter the state 5GMM-
DEREGISTERED.LIMITED-SERVICE. If the message has been successfully integrity
checked by the NAS, the UE shall set:
1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-
specific N1 mode attempt counter for non-3GPP access for that PLMN in case of
PLMN; or
2) the SNPN-specific attempt counter for 3GPP access for the current SNPN in
case of SNPN and the SNPN-specific attempt counter for non-3GPP access for the
current SNPN;
to the UE implementation-specific maximum value.
The UE shall disable the N1 mode capability for the specific access type for
which the message was received (see subclause 4.9).
If the message has been successfully integrity checked by the NAS, the UE
shall disable the N1 mode capability also for the other access type (see
subclause 4.9).
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI,
TAI list and eKSI. Additionally, the UE shall reset the attach attempt counter
and enter the state EMM-DEREGISTERED.
#31 (Redirection to EPC required).
5GMM cause #31 received by a UE that has not indicated support for CIoT
optimizations or not indicated support for S1 mode or received by a UE over
non-3GPP access is considered as an abnormal case and the behaviour of the UE
is specified in subclause 5.5.1.2.7.
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter.
The UE shall enable the E-UTRA capability if it was disabled, disable the N1
mode capability for 3GPP access (see subclause 4.9.2) and enter the 5GMM-
DEREGISTERED.NO-CELL-AVAILABLE.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, TAI list, eKSI and attach attempt counter as specified
in 3GPP TS 24.301 [15] for the case when the EPS attach procedure is rejected
with the EMM cause with the same value.
#36 (IAB-node operation not authorized).
This cause value is only applicable when received over 3GPP access by a UE
operating as an IAB-node. This cause value received from a 5G access network
other than 3GPP access or received by a UE not operating as an IAB-node is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
If:
1) the UE is not operating in SNPN access operation mode,
i) the UE shall delete the list of equivalent PLMNs and reset the registration
attempt counter and store the PLMN identity in the forbidden PLMN list as
specified in subclause 5.3.13A and if the UE is configured to use timer T3245
then the UE shall start timer T3245 and proceed as described in clause
5.3.19a.1. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform
a PLMN selection according to 3GPP TS 23.122 [5]. If the message has been
successfully integrity checked by the NAS and the UE maintains the PLMN-
specific attempt counter for 3GPP access for that PLMN, the UE shall set the
PLMN-specific attempt counter for 3GPP access for that PLMN to the UE
implementation-specific maximum value; and
ii) If the UE is operating in single-registration mode, the UE shall in
addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last
visited registered TAI, TAI list, eKSI and attach attempt counter as specified
in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is
rejected with the EMM cause with the same value; or
2) the UE is operating in SNPN access operation mode,
i) the UE shall reset the registration attempt counter and store the SNPN
identity in the \"temporarily forbidden SNPNs\" list for 3GPP access and, if
the UE supports access to an SNPN using credentials from a credentials holder,
the selected entry of the \"list of subscriber data\" or the selected PLMN
subscription. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and
perform an SNPN selection according to 3GPP TS 23.122 [5]. If the message has
been successfully integrity checked by the NAS, the UE shall set the SNPN
attempt counter for 3GPP access for the current SNPN to the UE implementation-
specific maximum value.
#62 (No network slices available).
The UE shall abort the initial registration procedure, set the 5GS update
status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED. ATTEMPTING-
REGISTRATION or 5GMM-DEREGISTERED.PLMN-SEARCH. Additionally, the UE shall
reset the registration attempt counter.
The UE receiving the rejected NSSAI in the REGISTRATION REJECT message takes
the following actions based on the rejection cause in the rejected S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
current PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE,
the UICC containing the USIM is removed, an entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
current registration area as described in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI(s) in the current registration area until
switching off the UE, the UE moving out of the current registration area, the
UICC containing the USIM is removed, the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI in the current PLMN or SNPN over any access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed or deleted as described in
subclause 4.6.1 and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
Unless the back-off timer value received along with the S-NSSAI is zero, the
UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
NOTE 6: If the back-off timer value received along with the S-NSSAI in the
rejected NSSAI for the maximum number of UEs reached is zero as specified in
subclause 10.5.7.4a of TS 24.008, the UE does not consider the S-NSSAI as the
rejected S-NSSAI.
If there is one or more S-NSSAIs in the rejected NSSAI with the rejection
cause \"S-NSSAI not available due to maximum number of UEs reached\", then for
each S-NSSAI, the UE shall behave as follows:
a) stop the timer T3526 associated with the S-NSSAI, if running;
b) start the timer T3526 with:
1) the back-off timer value received along with the S-NSSAI, if a back-off
timer value is received along with the S-NSSAI that is neither zero nor
deactivated; or
2) an implementation specific back-off timer value, if no back-off timer value
is received along with the S-NSSAI; and
c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs
reached when the timer T3526 associated with the S-NSSAI expires.
If the UE has an allowed NSSAI or configured NSSAI that contains S-NSSAI(s)
which are not included in the rejected NSSAI the UE may stay in the current
serving cell, apply the normal cell reselection process and start an initial
registration with a requested NSSAI that includes any S-NSSAI from the allowed
NSSAI or the configured NSSAI that is not in the rejected NSSAI. Otherwise the
UE may perform a PLMN selection or SNPN selection according to 3GPP TS 23.122
[5] and additionally, the UE may disable the N1 mode capability for the
current PLMN or SNPN if the UE does not have an allowed NSSAI and each S-NSSAI
in configured NSSAI, if available, was rejected with cause \"S-NSSAI not
available in the current PLMN or SNPN\" or \"S-NSSAI not available due to the
failed or revoked network slice-specific authentication and authorization\" as
described in subclause 4.9.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and~,~
1) if at least one S-NSSAI in the default configured NSSAI is not rejected,
the UE may stay in the current serving cell, apply the normal cell reselection
process, and start an initial registration with a requested NSSAI with that
default configured NSSAI; or
2) if all the S-NSSAI(s) in the default configured NSSAI are rejected and at
least one S-NSSAI is rejected due to \"S-NSSAI not available in the current
registration area\",
i) if the REGISTRATION REJECT message is integrity protected and the UE is not
operating in SNPN access operation mode, the UE shall store the current TAI in
the list of \"5GS forbidden tracking areas for roaming\" and enter the state
5GMM-DEREGISTERED.LIMITED-SERVICE; or
ii) if the REGISTRATION REJECT message is integrity protected and the UE is
operating in SNPN access operation mode, the UE shall store the current TAI in
the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN
and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.
Otherwise, the UE may perform a PLMN selection or SNPN selection according to
3GPP TS 23.122 [5] and additionally, the UE may disable the N1 mode capability
for the current PLMN or SNPN if each S-NSSAI in the default configured NSSAI
was rejected with cause \"S-NSSAI not available in the current PLMN or SNPN\"
or \"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\" as described in subclause 4.9.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and has rejected NSSAI for the
reached maximum number of UEs, and the UE wants to obtain services in the
current serving cell without performing a PLMN selection or SNPN selection,
the UE may stay in the current serving cell and attempt to use the rejected
S-NSSAI(s) for the maximum number of UEs reached in the current serving cell
after the rejected S-NSSAI(s) are removed as described in subclause 4.6.2.2.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
#72 (Non-3GPP access to 5GCN not allowed).
When received over non-3GPP access the UE shall set the 5GS update status to
5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2)
and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter and enter
the state 5GMM-DEREGISTERED. If the message has been successfully integrity
checked by the NAS, the UE shall set:
1) the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN
in case of PLMN: or
2) the SNPN-specific attempt counter for non-3GPP access for that SNPN in case
of SNPN;
to the UE implementation-specific maximum value.
NOTE 7: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause
4.9.3).
As an implementation option, the UE may enter the state 5GMM-
DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection according to
3GPP TS 23.122 [5].
If received over 3GPP access the cause shall be considered as an abnormal case
and the behaviour of the UE for this case is specified in subclause 5.5.1.2.7.
#73 (Serving network not authorized).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs, reset the registration attempt counter, store the PLMN
identity in the forbidden PLMN list as specified in subclause 5.3.13A. For
3GPP access the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH in order to
perform a PLMN selection according to 3GPP TS 23.122 [5], and for non-3GPP
access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE and perform
network selection as defined in 3GPP TS 24.502 [18]. If the message has been
successfully integrity checked by the NAS, the UE shall set the PLMN-specific
attempt counter and the PLMN-specific attempt counter for non-3GPP access for
that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI,
TAI list and eKSI. Additionally, the UE shall reset the attach attempt counter
and enter the state EMM-DEREGISTERED.
#74 (Temporarily not authorized for this SNPN).
5GMM cause #74 is only applicable when received from a cell belonging to an
SNPN. 5GMM cause #74 received from a cell not belonging to an SNPN is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and store the SNPN identity in the \"temporarily
forbidden SNPNs\" list for the specific access type for which the message was
received and, if the UE supports access to an SNPN using credentials from a
credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription. If the registration request is not for
onboarding services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-
SEARCH and perform an SNPN selection according to 3GPP TS 23.122 [5]. If the
registration request is for onboarding services in SNPN, the UE shall enter
state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN
selection for onboarding services according to 3GPP TS 23.122 [5]. If the
message has been successfully integrity checked by the NAS, the UE shall set
the SNPN-specific attempt counter for 3GPP access and the SNPN-specific
attempt counter for non-3GPP access for the current SNPN to the UE
implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
NOTE 8: When 5GMM cause #74 is received over 3GPP access, the term \"other
access\" in \"the UE also supports the registration procedure over the other
access to the same SNPN\" is used to express access to SNPN services via a
PLMN.
NOTE 9: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
#75 (Permanently not authorized for this SNPN).
5GMM cause #75 is only applicable when received from a cell belonging to an
SNPN with a globally-unique SNPN identity. 5GMM cause #75 received from a cell
not belonging to an SNPN or a cell belonging to an SNPN with a non-globally-
unique SNPN identity is considered as an abnormal case and the behaviour of
the UE is specified in subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and store the SNPN identity in the \"permanently
forbidden SNPNs\" list for the specific access type for which the message was
received and, if the UE supports access to an SNPN using credentials from a
credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription. If the registration request is not for
onboarding services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-
SEARCH and perform an SNPN selection according to 3GPP TS 23.122 [5]. If the
registration request is for onboarding services in SNPN, the UE shall enter
state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN
selection for onboarding services according to 3GPP TS 23.122 [5]. If the
message has been successfully integrity checked by the NAS, the UE shall set
the SNPN-specific attempt counter for 3GPP access and the SNPN-specific
attempt counter for non-3GPP access for the current SNPN to the UE
implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
NOTE 10: When 5GMM cause #75 is received over 3GPP access, the term \"other
access\" in \"the UE also supports the registration procedure over the other
access to the same SNPN\" is used to express access to SNPN services via a
PLMN.
NOTE 11: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
#76 (Not authorized for this CAG or authorized for CAG cells only).
This cause value received via non-3GPP access or from a cell belonging to an
SNPN is considered as an abnormal case and the behaviour of the UE is
specified in subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED, store the
5GS update status according to clause 5.1.3.2.2, and reset the registration
attempt counter.
If 5GMM cause #76 is received from:
1) a CAG cell, and if the UE receives a \"CAG information list\" in the CAG
information list IE or the Extended CAG information list IE included in the
REGISTRATION REJECT message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 12: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, then the UE shall delete the CAG-ID(s) of the cell from the
\"allowed CAG list\" for the current PLMN. In the case the \"allowed CAG
list\" for the current PLMN only contains a range of CAG-IDs, how the UE
deletes the CAG-ID(s) of the cell from the \"allowed CAG list\" for the
current PLMN is up to UE implementation. In addition:
i) if the entry in the \"CAG information list\" for the current PLMN does not
include an \"indication that the UE is only allowed to access 5GS via CAG
cells\" or if the entry in the \"CAG information list\" for the current PLMN
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and the updated \"allowed CAG list\" for the current PLMN includes one
or more CAG-IDs, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-
SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28]
or 3GPP TS 36.304 [25C] with the updated \"CAG information list\";
ii) if the entry in the \"CAG information list\" for the current PLMN includes
an \"indication that the UE is only allowed to access 5GS via CAG cells\" and
the updated \"allowed CAG list\" for the current PLMN does not include any
CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH and
shall apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\"; or
iii) if the \"CAG information list\" does not include an entry for the current
PLMN, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP TS
36.304 [25C] with the updated \"CAG information list\".
2) a non-CAG cell, and if the UE receives a \"CAG information list\" in the
CAG information list IE or the Extended CAG information list IE included in
the REGISTRATION REJECT message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 13: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall store an \"indication that the UE is only allowed to
access 5GS via CAG cells\" in the entry of the \"CAG information list\" for
the current PLMN, if any. If the \"CAG information list\" stored in the UE
does not include the current PLMN\'s entry, the UE shall add an entry for the
current PLMN to the \"CAG information list\" and store an \"indication that
the UE is only allowed to access 5GS via CAG cells\" in the entry of the \"CAG
information list\" for the current PLMN. If the UE does not have a stored
\"CAG information list\", the UE shall create a new \"CAG information list\"
and add an entry with an \"indication that the UE is only allowed to access
5GS via CAG cells\" for the current PLMN.
In addition:
i) if the \"allowed CAG list\" for the current PLMN includes one or more CAG-
IDs, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] with the
updated CAG information; or
ii) if the \"allowed CAG list\" for the current PLMN does not include any CAG-
ID, then the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH and shall
apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\".
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
#77 (Wireline access area not allowed).
5GMM cause #77 is only applicable when received from a wireline access network
by the 5G-RG or the W-AGF acting on behalf of the FN-CRG. 5GMM cause #77
received from a 5G access network other than a wireline access network and
5GMM cause #77 received by the W-AGF acting on behalf of the FN-BRG are
considered as abnormal cases and the behaviour of the UE is specified in
subclause 5.5.1.2.7.
When received over wireline access network, the 5G-RG and the W-AGF acting on
behalf of the FN-CRG shall set the 5GS update status to 5U3 ROAMING NOT
ALLOWED (and shall store it according to subclause 5.1.3.2.2), shall delete
5G-GUTI, last visited registered TAI, TAI list and ngKSI, shall reset the
registration attempt counter, shall enter the state 5GMM-DEREGISTERED and
shall act as specified in subclause 5.3.23.
NOTE 14: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
#78 (PLMN not allowed to operate at the present UE location).
This cause value received from a non-satellite NG-RAN cell is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter. The UE shall store the PLMN identity and, if
it is known, the current geographical location in the list of \"PLMNs not
allowed to operate at the present UE location\" and shall start a
corresponding timer instance (see subclause 4.23.2). The UE shall enter state
5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP
TS 23.122 [5].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, TAI list, eKSI and attach attempt counter as specified
in 3GPP TS 24.301 [15] for the case when the EPS attach procedure is rejected
with the EMM cause with the same value.
#79 (UAS services not allowed).
The UE shall abort the initial registration procedure, set the 5GS update
status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED. ATTEMPTING-
REGISTRATION or 5GMM-DEREGISTERED.PLMN-SEARCH. Additionally, the UE shall
reset the registration attempt counter. If the UE re-attempt the registration
procedure to the current PLMN, the UE shall not include the service-level
device ID set to the CAA-level UAV ID in the Service-level-AA container IE of
REGISTRATION REQUEST message unless the UE receives a CONFIGURATION UPDATE
COMMAND message including the service-level-AA service status indication in
the Service-level-AA container IE with the UAS field set to \"UAS services
enabled\".
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
#80 (Disaster roaming for the determined PLMN with disaster condition not
allowed).
The UE shall abort the initial registration procedure, set the 5GS update
status to 5U2 NOT UPDATED, enter state 5GMM-DEREGISTERED.ATTEMPTING-
REGISTRATION and shall delete any 5G-GUTI, last visited registered TAI, TAI
list and ngKSI. Additionally, the UE shall reset the registration attempt
counter. The UE shall not attempt to register for disaster roaming services on
this PLMN for the determined PLMN with disaster condition for a period in the
range of 12 to 24 hours. The UE shall not attempt to register for disaster
roaming services on this PLMN for a period in the range of 3 to 10 minutes.
The UE shall perform PLMN selection as described in 3GPP TS 23.122 [6].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
Other values are considered as abnormal cases. The behaviour of the UE in
those cases is specified in subclause 5.5.1.2.7.
##### 5.5.1.2.6 Initial registration for emergency services not accepted by
the network
Upon receiving the REGISTRATION REJECT message including 5GMM cause #5 \"PEI
not accepted\", the UE shall enter the state 5GMM-DEREGISTERED.NO-SUPI. If the
REGISTRATION REJECT message is received,
\- over 3GPP access; or
\- over non-3GPP access and is integrity protected;
and the UE also supports the registration procedure over the other access, the
UE shall in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
Upon receiving the REGISTRATION REJECT message including 5GMM cause value
which is not #5 \"PEI not accepted\", the UE shall perform the actions as
described in subclause 5.5.1.2.5 with the following addition: the UE shall
inform the upper layers of the failure of the procedure.
NOTE 1: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
If the initial registration request for emergency services fails due to
abnormal cases, the UE shall perform the actions as described in subclause
5.5.1.2.7 and inform the upper layers of the failure to access the network or
the failure of the procedure.
NOTE 2: This can result in the upper layers requesting other implementation
specific mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can
result in the emergency call being attempted to another IP-CAN.
In a shared network, upon receiving the REGISTRATION REJECT message, the UE
shall perform the actions as described in subclause 5.5.1.2.5, and shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 3: The upper layers can request implementation specific mechanisms, e.g.
procedures specified in 3GPP TS 24.229 [14] that can result in the emergency
call being attempted to another IP-CAN.
b) attempt to perform a PLMN selection in the shared network and, if an
initial registration for emergency services was not already attempted with the
selected PLMN and the REGISTRATION REQUEST message, for which the REGISTRATION
REJECT message was received, is:
\- not for sending a PDU SESSION ESTABLISHMENT REQUEST message with request
type set to \"existing emergency PDU session\", initiate an initial
registration for emergency services with the selected PLMN; or
\- for sending a PDU SESSION ESTABLISHMENT REQUEST message with request type
set to \"existing emergency PDU session\", and:
i) the selected PLMN is an equivalent PLMN, initiate an initial registration
for emergency services with the selected PLMN; and
ii) the selected PLMN is not an equivalent PLMN, perform a PLMN selection and
initiate an initial registration for emergency services with the selected PLMN
if an initial registration for emergency services was not already attempted
with the selected PLMN.
In a shared network, if the initial registration request for emergency
services fails due to abnormal cases, the UE shall perform the actions as
described in subclause 5.5.1.2.7 and shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 4: The upper layers can request implementation specific mechanisms, e.g.
procedures specified in 3GPP TS 24.229 [14] that can result in the emergency
call being attempted to another IP-CAN.
b) attempt to perform a PLMN selection in the shared network and, if an
initial registration for emergency services was not already attempted with the
selected PLMN and the REGISTRATION REQUEST message is:
\- not for sending a PDU SESSION ESTABLISHMENT REQUEST message with request
type set to \"existing emergency PDU session\", initiate an initial
registration for emergency services with the selected PLMN; or
\- for sending a PDU SESSION ESTABLISHMENT REQUEST message with request type
set to \"existing emergency PDU session\", and:
i) the selected PLMN is an equivalent PLMN, initiate an initial registration
for emergency services with the selected PLMN; and
ii) the selected PLMN is not an equivalent PLMN, perform a PLMN selection and
initiate an initial registration for emergency services with the selected PLMN
if an initial registration for emergency services was not already attempted
with the selected PLMN.
##### 5.5.1.2.6A Initial registration for initiating an emergency PDU session
not accepted by the network
If the network cannot accept an initial registration request with 5GS
registration type IE set to \"initial registration\" and for sending a PDU
SESSION ESTABLISHMENT REQUEST message with request type set to \"initial
emergency request\", the UE shall perform the procedures as described in
subclause 5.5.1.2.5. Then if the UE is in the same selected PLMN where the
last initial registration request was attempted, the UE shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 1: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
b) attempt initial registration for emergency services.
If the network cannot accept an initial registration request with 5GS
registration type IE set to \"initial registration\", for establishing an
emergency PDU session and the PDU session needs to be established due to
handover of an existing PDN connection for emergency bearer services, the UE
shall perform the procedures as described in subclause 5.5.1.2.5. Then if the
UE is in the same selected PLMN or equivalent PLMN where the last initial
registration request was attempted, the UE shall attempt initial registration
for emergency services.
If the initial registration request, with 5GS registration type IE set to
\"initial registration\" and for initiating an emergency PDU session, fails
due to abnormal case b) in subclause 5.5.1.2.7, the UE shall perform the
actions as described in subclause 5.5.1.2.7 and inform the upper layers of the
failure to access the network.
NOTE 2: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
If the initial registration request, with 5GS registration type IE set to
\"initial registration\" and for initiating an emergency PDU session, fails
due to abnormal cases c), d) or e) in subclause 5.5.1.2.7, the UE shall
perform the actions as described in subclause 5.5.1.2.7. Then if the UE is in:
a) the same selected PLMN where the last initial registration request was
attempted and the PDU session does not need to be established due to handover
of an existing PDN connection for emergency bearer services, the UE shall:
\- inform the upper layers of the failure of the procedure; or
NOTE 3: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
\- attempt initial registration for emergency services; or
b) the same selected PLMN or equivalent PLMN where the last initial
registration request was attempted and the PDU session needs to be established
due to handover of an existing PDN connection for emergency bearer services,
attempt initial registration for emergency services.
##### 5.5.1.2.7 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Timer T3346 is running.
The UE shall not start the registration procedure for initial registration
unless:
1) the UE is a UE configured for high priority access in selected PLMN;
2) the UE needs to perform the registration procedure for initial registration
for emergency services;
3) the UE receives a DEREGISTRATION REQUEST message with the \"re-registration
required\" indication;
4) the UE in NB-N1 mode is requested by the upper layer to transmit user data
related to an exceptional event and:
\- the UE is allowed to use exception data reporting (see the
ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP TS
24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102 [22]); and
\- timer T3346 was not started when N1 NAS signalling connection was
established with RRC establishment cause set to \"mo-ExceptionData\"; or
5) the UE needs to perform the registration procedure with 5GS registration
type IE set to \"initial registration\" for initiating of an emergency PDU
session, upon request of the upper layers to establish the emergency PDU
session.
The UE stays in the current serving cell and applies the normal cell
reselection process.
NOTE 1: It is considered an abnormal case if the UE needs to initiate a
registration procedure for initial registration while timer T3346 is running
independent on whether timer T3346 was started due to an abnormal case or a
non-successful case.
b) The lower layers indicate that the access attempt is barred.
The UE shall not start the initial registration procedure. The UE stays in the
current serving cell and applies the normal cell reselection process. Receipt
of the access barred indication shall not trigger the selection of a different
core network type (EPC or 5GCN).
The initial registration procedure is started, if still needed, when the lower
layers indicate that the barring is alleviated for the access category with
which the access attempt was associated.
ba) The lower layers indicate that:
1) access barring is applicable for all access categories except categories 0
and 2 and the access category with which the access attempt was associated is
other than 0 and 2; or
2) access barring is applicable for all access categories except category 0
and the access category with which the access attempt was associated is other
than 0.
If the REGISTRATION REQUEST message has not been sent, the UE shall proceed as
specified for case b. If the REGISTRATION REQUEST message has been sent, the
UE shall proceed as specified for case e and, additionally, the registration
procedure for initial registration is started, if still needed, when the lower
layers indicate that the barring is alleviated for the access category with
which the access attempt was associated.
c) T3510 timeout.
The UE shall abort the registration procedure for initial registration and the
NAS signalling connection, if any, shall be released locally if the initial
registration request is neither for emergency services nor for initiating a
PDU session for emergency services with request type set to \"existing
emergency PDU session\". The UE shall proceed as described below.
d) REGISTRATION REJECT message, other 5GMM cause values than those treated in
subclause 5.5.1.2.5, and cases of 5GMM cause values #11, #15, #22, #31, #72,
#73, #74, #75, #76, #77 and #78, if considered as abnormal cases according to
subclause 5.5.1.2.5.
If the registration request is neither an initial registration request for
emergency services nor an initial registration request for initiating a PDU
session for emergency services with request type set to \"existing emergency
PDU session\", upon reception of the 5GMM causes #95, #96, #97, #99 and #111
the UE should set the registration attempt counter to 5.
The UE shall proceed as described below.
e) Lower layer failure or release of the NAS signalling connection received
from lower layers before the REGISTRATION ACCEPT or REGISTRATION REJECT
message is received.
The UE shall abort the registration procedure for initial registration and
proceed as described below.
f) UE initiated de-registration required.
The registration procedure for initial registration shall be aborted, and the
UE initiated de-registration procedure shall be performed.
g) De-registration procedure collision.
If the UE receives a DEREGISTRATION REQUEST message from the network in state
5GMM-REGISTERED-INITIATED the de-registration procedure shall be aborted and
the initial registration procedure shall be progressed.
NOTE 2: The above collision case is valid if the DEREGISTRATION REQUEST
message indicates the access type over which the initial registration
procedure is attempted otherwise both the procedures are progressed.
h) Change in the current TAI.
If the current TAI is changed before the registration procedure for initial
registration is completed, the registration procedure for initial registration
shall be aborted and re-initiated immediately.
If the REGISTRATION COMPLETE message needs to be sent and a tracking area
border is crossed when the REGISTRATION ACCEPT message has been received but
before a REGISTRATION COMPLETE message is sent and:
1) if the current TAI is in the TAI list, the UE sends the REGISTRATION
COMPLETE message to the network; and
2) otherwise, the registration procedure for initial registration shall be
aborted and the registration procedure for mobility registration update shall
be initiated.
If a 5G-GUTI was allocated during the registration procedure, this 5G-GUTI
shall be used in the registration procedure.
i) Transmission failure of REGISTRATION COMPLETE message indication with
change in the current TAI.
1) If the current TAI is still part of the TAI list, the UE resends the
REGISTRATION COMPLETE message to the network; and
2) otherwise, the registration procedure for initial registration shall be
aborted and the registration procedure for mobility registration update shall
be initiated.
j) Transmission failure of REGISTRATION COMPLETE message indication without
change in the current TAI from lower layers.
It is up to the UE implementation how to re-run the ongoing procedure.
k) Transmission failure of REGISTRATION REQUEST message indication from the
lower layers.
The registration procedure for initial registration shall be aborted and re-
initiated immediately.
l) Timer T3447 is running.
The UE shall not start the registration procedure for initial registration
with Follow-on request indicator set to \"Follow-on request pending\" unless:
1) the UE is a UE configured for high priority access in selected PLMN; or
2) the UE needs to perform the registration procedure for initial registration
for emergency services.
The UE stays in the current serving cell and applies the normal cell
reselection process. The registration procedure for initial registration is
started, if still necessary, when timer T3447 expires or timer T3447 is
stopped.
For the cases c, d and e, the UE shall proceed as follows:
Timer T3510 shall be stopped if still running.
If the registration procedure is neither an initial registration for emergency
services nor for establishing an emergency PDU session with registration type
not set to \"emergency registration\", the registration attempt counter shall
be incremented, unless it was already set to 5.
If the registration attempt counter is less than 5:
\- if the initial registration request is not for emergency services, timer
T3511 is started and the state is changed to 5GMM-DEREGISTERED.ATTEMPTING-
REGISTRATION. When timer T3511 expires the registration procedure for initial
registration shall be restarted, if still required.
If the registration attempt counter is equal to 5
\- the UE shall delete 5G-GUTI, TAI list, last visited registered TAI, list of
equivalent PLMNs (if any), and ngKSI, start timer T3502 and shall set the 5GS
update status to 5U2 NOT UPDATED. The state is changed to 5GMM-
DEREGISTERED.ATTEMPTING-REGISTRATION or optionally to 5GMM-DEREGISTERED.PLMN-
SEARCH in order to perform a PLMN selection, SNPN selection according to 3GPP
TS 23.122 [5].
\- if the procedure is performed via 3GPP access and the UE is operating in
single-registration mode:
\- the UE shall in addition handle the EMM parameters EPS update status, EMM
state, 4G-GUTI, TAI list, last visited registered TAI, list of equivalent
PLMNs and eKSI as specified in 3GPP TS 24.301 [15] for the abnormal cases when
an EPS attach procedure fails and the attach attempt counter is equal to 5;
and
\- the UE shall attempt to select E-UTRAN radio access technology and proceed
with appropriate EMM specific procedures. Additionally, The UE may disable the
N1 mode capability as specified in subclause 4.9.
##### 5.5.1.2.8 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Lower layer failure
If a lower layer failure occurs before the REGISTRATION COMPLETE message has
been received from the UE and timer T3550 is running, the AMF shall locally
abort the registration procedure for initial registration, enter state 5GMM-
REGISTERED and shall not resend the REGISTRATION ACCEPT message. If a new
5G-GUTI was assigned to the UE in the registration procedure for initial
registration, the AMF shall consider both the old and the new 5G-GUTI as valid
until the old 5G-GUTI can be considered as invalid by the AMF or the 5GMM
context which has been marked as deregistered in the AMF is released. If the
old 5G-GUTI was allocated by an AMF other than the current AMF, the current
AMF does not need to retain the old 5G-GUTI. During this period the network
may use the identification procedure followed by a generic UE configuration
update procedure if the old 5G-GUTI is used by the UE in a subsequent message.
b) Protocol error
If the REGISTRATION REQUEST message is received with a protocol error, the AMF
shall return a REGISTRATION REJECT message with one of the following 5GMM
cause values:
#96 invalid mandatory information;
#99 information element non-existent or not implemented;
#100 conditional IE error; or
#111 protocol error, unspecified.
c) T3550 time-out
On the first expiry of the timer, the AMF shall retransmit the REGISTRATION
ACCEPT message and shall reset and restart timer T3550.
This retransmission is repeated four times, i.e. on the fifth expiry of timer
T3550, the registration procedure for initial registration shall be aborted
and the AMF enters state 5GMM-REGISTERED. If a new 5G-GUTI was allocated in
the REGISTRATION ACCEPT message, the AMF shall consider both the old and the
new 5G-GUTIs as valid until the old 5G-GUTI can be considered as invalid by
the AMF or the 5GMM context which has been marked as de-registered in the AMF
is released. If the old 5G-GUTI was allocated by an AMF other than the current
AMF, the current AMF does not need to retain the old 5G-GUTI. During this
period, if the old 5G-GUTI is used by the UE in a subsequent message, the AMF
acts as specified for case a) above.
d) REGISTRATION REQUEST message received after the REGISTRATION ACCEPT message
has been sent and before the REGISTRATION COMPLETE message is received, if the
REGISTRATION COMPLETE message is expected.
1) If one or more of the information elements in the REGISTRATION REQUEST
message differ from the ones received within the previous REGISTRATION REQUEST
message, the previously initiated the registration procedure for initial
registration shall be aborted if the REGISTRATION COMPLETE message has not
been received and the new registration procedure for initial registration
shall be progressed; or
2) if the information elements do not differ, then the REGISTRATION ACCEPT
message shall be resent and the timer T3550 shall be restarted. In that case,
the retransmission counter related to T3550 is not incremented.
e) More than one REGISTRATION REQUEST message with 5GS registration type IE
set to \"initial registration\" received and no REGISTRATION ACCEPT message or
REGISTRATION REJECT message has been sent.
1) If one or more of the information elements in the REGISTRATION REQUEST
message with 5GS registration type IE set to \"initial registration\" differs
from the ones received within the previous REGISTRATION REQUEST message with
5GS registration type IE set to \"initial registration\", the previously
initiated the registration procedure for initial registration shall be aborted
and the new the registration procedure for initial registration shall be
executed;
2) if the information elements do not differ, then the network shall continue
with the previous the registration procedure for initial registration and
shall ignore the second REGISTRATION REQUEST message.
f) REGISTRATION REQUEST message with 5GS registration type IE set to \"initial
registration\" received in state 5GMM-REGISTERED.
If a REGISTRATION REQUEST message with 5GS registration type IE set to
\"initial registration\" is received in state 5GMM-REGISTERED the network may
initiate the 5GMM common procedures; if it turned out that the REGISTRATION
REQUEST message was sent by a genuine UE that has already been registered, the
5GMM context, if any, are deleted and the new REGISTRATION REQUEST is
progressed.
NOTE 1: The network can determine that the UE is genuine by executing the
authentication procedure as described in subclause 5.4.1.
g) REGISTRATION REQUEST message with 5GS registration type IE set to
\"mobility registration updating\" or \"periodic registration updating\"
received before REGISTRATION COMPLETE message, if the REGISTRATION COMPLETE
message is expected.
Timer T3550 shall be stopped. The allocated 5G-GUTI in the registration
procedure for initial registration shall be considered as valid and the
registration procedure for mobility and periodic update shall be progressed as
described in subclause 5.5.1.3.
h) DEREGISTRATION REQUEST message received before REGISTRATION COMPLETE
message, if the REGISTRATION COMPLETE message is expected.
The AMF shall abort the registration procedure for initial registration and
shall progress the de-registration procedure as described in subclause
5.5.2.2.
i) UE security capabilities invalid or unacceptable
If the REGISTRATION REQUEST message is received with invalid or unacceptable
UE security capabilities (e.g. no 5GS encryption algorithms (all bits zero),
no 5GS integrity algorithms (all bits zero), mandatory 5GS encryption
algorithms not supported or mandatory 5GS integrity algorithms not supported,
etc.), the AMF shall return a REGISTRATION REJECT message.
NOTE 2: 5GMM cause value to be used in REGISTRATION REJECT message is up to
the network implementation.
j) Based on operator policy, if the initial registration request from a UE not
supporting CAG is rejected due to CAG restrictions, the network shall reject
the initial registration with a 5GMM cause value other than the 5GMM cause #76
(Not authorized for this CAG or authorized for CAG cells only).
NOTE 3: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not
allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving
network not authorized) can be used depending on the subscription of the UE
and whether the UE roams or not.
#### 5.5.1.3 Registration procedure for mobility and periodic registration
update
##### 5.5.1.3.1 General
This procedure is used by a UE for both mobility and periodic registration
update of 5GS services. This procedure, when used for periodic registration
update of 5GS services, is performed only in 3GPP access.
This procedure used for periodic registration update of 5GS services is
controlled in the UE by timer T3512. When timer T3512 expires, the
registration procedure for mobility and periodic registration area updating is
started. Start and reset of timer T3512 is described in subclause 10.2.
If the MUSIM UE is registered for emergency services and initiates a
registration procedure for mobility and periodic registration update, the
network shall not indicate the support of:
\- the NAS signalling connection release;
\- the paging indication for voice services;
\- the reject paging request; or
\- the paging restriction;
in the REGISTRATION ACCEPT message.
##### 5.5.1.3.2 Mobility and periodic registration update initiation
The UE in state 5GMM-REGISTERED shall initiate the registration procedure for
mobility and periodic registration update by sending a REGISTRATION REQUEST
message to the AMF,
a) when the UE detects that the current TAI is not in the list of tracking
areas that the UE previously registered in the AMF;
b) when the periodic registration updating timer T3512 expires in 5GMM-IDLE
mode;
c) when the UE receives a CONFIGURATION UPDATE COMMAND message indicating
\"registration requested\" in the Registration requested bit of the
Configuration update indication IE as specified in subclauses 5.4.4.3;
d) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE either
receives a paging or the UE receives a NOTIFICATION message with access type
indicating 3GPP access over the non-3GPP access for PDU sessions associated
with 3GPP access;
NOTE 1: As an implementation option, MUSIM UE is allowed to not respond to
paging based on the information available in the paging message, e.g. voice
service indication.
e) upon inter-system change from S1 mode to N1 mode and if the UE previously
had initiated an attach procedure or a tracking area updating procedure when
in S1 mode;
f) when the UE receives an indication of \"RRC Connection failure\" from the
lower layers and does not have signalling pending (i.e. when the lower layer
requests NAS signalling connection recovery) except for the case specified in
subclause 5.3.1.4;
g) when the UE changes the 5GMM capability or the S1 UE network capability or
both;
h) when the UE\'s usage setting changes;
i) when the UE needs to change the slice(s) it is currently registered to;
j) when the UE changes the UE specific DRX parameters;
k) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE
receives a request from the upper layers to establish an emergency PDU session
or perform emergency services fallback;
l) when the UE needs to register for SMS over NAS, indicate a change in the
requirements to use SMS over NAS, or de-register from SMS over NAS;
m) when the UE needs to indicate PDU session status to the network after
performing a local release of PDU session(s) as specified in subclauses
6.4.1.5 and 6.4.3.5;
n) when the UE in 5GMM-IDLE mode changes the radio capability for NG-RAN or
E-UTRAN;
o) when the UE receives a fallback indication from the lower layers and does
not have signalling pending (i.e. when the lower layer requests NAS signalling
connection recovery, see subclauses 5.3.1.4 and 5.3.1.2);
p) void;
q) when the UE needs to request new LADN information;
r) when the UE needs to request the use of MICO mode or needs to stop the use
of MICO mode or to request the use of new T3324 value or new T3512 value;
s) when the UE in 5GMM-CONNECTED mode with RRC inactive indication enters a
cell in the current registration area belonging to an equivalent PLMN of the
registered PLMN and not belonging to the registered PLMN;
t) when the UE receives over 3GPP access a SERVICE REJECT message or a DL NAS
TRANSPORT message, with the 5GMM cause value set to #28 \"Restricted service
area\";
u) when the UE needs to request the use of eDRX, when a change in the eDRX
usage conditions at the UE requires different extended DRX parameters, or
needs to stop the use of eDRX;
NOTE 2: A change in the eDRX usage conditions at the UE can include e.g. a
change in the UE configuration, a change in requirements from upper layers or
the battery running low at the UE.
v) when the UE supporting 5G-SRVCC from NG-RAN to UTRAN changes the mobile
station classmark 2 or the supported codecs;
w) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE decides
to request new network slices after being rejected due to no allowed network
slices requested, or request S-NSSAI(s) which have been removed from the
rejected NSSAI for the maximum number of UEs reached;
x) when the UE is not in NB-N1 mode and the applicable UE radio capability ID
for the current UE radio configuration changes due to a revocation of the
network-assigned UE radio capability IDs by the serving PLMN or SNPN;
y) when the UE receives a REGISTRATION REJECT message with 5GMM cause values
#3, #6 or #7 without integrity protection over another access;
z) when the UE needs to request new ciphering keys for ciphered broadcast
assistance data;
za) when due to manual CAG selection the UE has selected a CAG-ID which is not
included in the \"allowed CAG list\" for the selected PLMN or a CAG-ID in a
PLMN for which the entry in the \"CAG information list\" does not exist or
when the UE has selected, without selecting a CAG-ID, a PLMN for which the
entry in the \"CAG information list\" includes an \"indication that the UE is
only allowed to access 5GS via CAG cells\";
zb) when the UE needs to start, stop or change the conditions for using the
WUS assistance information or PEIPS assistance information;
zc) when the UE changes the UE specific DRX parameters in NB-N1 mode;
zd) when the UE in 5GMM-CONNECTED mode with RRC inactive indication enters a
new cell with different RAT in current TAI list or not in current TAI list;
ze) when the UE enters state 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-
REGISTERED.NON-ALLOWED-SERVICE (as described in subclause 5.3.5.2) over 3GPP
access after the UE has sent a NOTIFICATION RESPONSE message over non-3GPP
access in response to reception of a NOTIFICATION message over non-3GPP access
as specified in subclause 5.6.3.1;
zf) when the UE supporting UAS services is not registered for UAS services and
needs to register to the 5GS for UAS services;
zg) when the UE supporting MINT needs to perform the registration procedure
for mobility and periodic registration update to register to the PLMN offering
disaster roaming services;
zh) when the MUSIM UE supporting **the paging timing collision control** needs
to request a new 5G-GUTI assignment and the UE is not registered for emergency
services;
NOTE 3: Based on implementation, the MUSIM UE can request a new 5G-GUTI
assignment (e.g. when the lower layers request to modify the timing of the
paging occasions).
zi) when the network supports the paging restriction and the MUSIM UE in state
5GMM-REGISTERED.NON-ALLOWED-SERVICE needs to requests the network to remove
the paging restriction;
zj) when the UE changes the 5GS Preferred CIoT network behaviour or the EPS
Preferred CIoT network behaviour;
zk) when the UE that has entered 5GMM-REGISTERED.NO-CELL-AVAILABLE and it has
one or more S-NSSAI(s) in pending NSSAI, finds a suitable cell according to
3GPP TS 38.304 [28]; or
zl) when the UE is registered for disaster roaming services and receives a
request from the upper layers to establish an emergency PDU session or perform
emergency services fallback.
If case b) is the only reason for initiating the registration procedure for
mobility and periodic registration update, the UE shall indicate \"periodic
registration updating\" in the 5GS registration type IE; otherwise, if the UE
initiates the registration procedure for mobility and periodic registration
update due to case Zg), the UE shall indicate \"disaster roaming mobility
registration updating\" in the 5GS registration type IE; otherwise the UE
shall indicate \"mobility registration updating\".
If case zl) is the reason for initiating the registration procedure for
mobility and periodic registration update and if the UE supports S1 mode, the
UE shall:
\- set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of
the REGISTRATION REQUEST message; and
\- include the S1 UE network capability IE in the REGISTRATION REQUEST
message;
If the UE which is not registered for disaster roaming services indicates
\"mobility registration updating\" in the 5GS registration type IE and the UE
supports S1 mode, the UE shall:
\- set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of
the REGISTRATION REQUEST message;
\- include the S1 UE network capability IE in the REGISTRATION REQUEST
message; and
\- if the UE supports sending an ATTACH REQUEST message containing a PDN
CONNECTIVITY REQUEST message with request type set to \"handover\" to transfer
a PDU session from N1 mode to S1 mode, set the HO attach bit to \"attach
request message containing PDN connectivity request with request type set to
handover to transfer PDU session from N1 mode to S1 mode supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the LTE positioning protocol (LPP) in N1 mode as specified
in 3GPP TS 37.355 [26], the UE shall set the LPP bit to \"LPP in N1 mode
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the Location Services (LCS) notification mechanisms in N1
mode as specified in 3GPP TS 23.273 [6B], the UE shall set the 5G-LCS bit to
\" LCS notification mechanisms supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
For all cases except case b), when the UE is not in NB-N1 mode and the UE
supports RACS, the UE shall set the RACS bit to \"RACS supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message.
If the UE supports 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP TS
23.216 [6A], the UE shall set:
\- the 5G-SRVCC from NG-RAN to UTRAN capability bit to \"5G-SRVCC from NG-RAN
to UTRAN supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message for all cases except case b; and
\- include the Mobile station classmark 2 IE and the Supported codecs IE in
the REGISTRATION REQUEST message for all cases except case b.
If the UE supports the restriction on use of enhanced coverage, the UE shall
set the RestrictEC bit to \"Restriction on use of enhanced coverage
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports network slice-specific authentication and authorization,
the UE shall set the NSSAA bit to \"network slice-specific authentication and
authorization supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message for all cases except case b.
If the UE supports CAG feature, the UE shall set the CAG bit to \"CAG
Supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports extended CAG information list, the UE shall set the Ex-CAG
bit to \"Extended CAG information list supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message.
If the UE supports sending of REGISTRATION COMPLETE message for acknowledging
the reception of Negotiated PEIPS assistance inforation IE, the UE shall set
the RCMAP bit to \"Sending of REGISTRATION COMPLETE message for negotiated
PEIPS assistance information supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
If the UE operating in the single-registration mode performs inter-system
change from S1 mode to N1 mode and has one or more stored UE policy sections
identified by a UPSI with the PLMN ID part indicating the HPLMN or the
selected PLMN, the UE shall set the Payload container type IE to \"UE policy
container\" and include the UE STATE INDICATION message (see annex D) in the
Payload container IE of the REGISTRATION REQUEST message.
NOTE 4: In this version of the protocol, the UE can only include the Payload
container IE in the REGISTRATION REQUEST message to carry a payload of type
\"UE policy container\".
The UE in state 5GMM-REGISTERED shall initiate the registration procedure for
mobility and periodic update by sending a REGISTRATION REQUEST message to the
AMF when the UE needs to request the use of SMS over NAS transport or the
current requirements to use SMS over NAS transport change in the UE. The UE
shall set the SMS requested bit of the 5GS update type IE in the REGISTRATION
REQUEST message as specified in subclause 5.5.1.2.2.
When initiating a registration procedure for mobility and periodic
registration update and the UE needs to send the 5GS update type IE for a
reason different than indicating a change in requirement to use SMS over NAS,
the UE shall set the SMS requested bit of the 5GS update type IE in the
REGISTRATION REQUEST message to the same value as indicated by the UE in the
last REGISTRATION REQUEST message.
If the UE no longer requires the use of SMS over NAS, then the UE shall
include the 5GS update type IE in the REGISTRATION REQUEST message with the
SMS requested bit set to \"SMS over NAS not supported\".
After sending the REGISTRATION REQUEST message to the AMF the UE shall start
timer T3510. If timer T3502 is currently running, the UE shall stop timer
T3502. If timer T3511 is currently running, the UE shall stop timer T3511.
If the last visited registered TAI is available, the UE shall include the last
visited registered TAI in the REGISTRATION REQUEST message.
The UE shall handle the 5GS mobile identity IE in the REGISTRATION REQUEST
message as follows:
a) if the UE is operating in the single-registration mode, performs inter-
system change from S1 mode to N1 mode, and the UE holds a valid native
4G-GUTI, the UE shall create a 5G-GUTI mapped from the valid native 4G-GUTI as
specified in 3GPP TS 23.003 [4] and indicate the mapped 5G-GUTI in the 5GS
mobile identity IE. Additionally, if the UE holds a valid 5Gâ€‘GUTI, the UE
shall include the 5G-GUTI in the Additional GUTI IE in the REGISTRATION
REQUEST message in the following order:
1) a valid 5G-GUTI that was previously assigned by the same PLMN with which
the UE is performing the registration, if available;
2) a valid 5G-GUTI that was previously assigned by an equivalent PLMN, if
available; and
3) a valid 5G-GUTI that was previously assigned by any other PLMN, if
available; and
NOTE 5: The 5G-GUTI included in the Additional GUTI IE is a native 5G-GUTI.
b) for all other cases, if the UE holds a valid 5G-GUTI, the UE shall indicate
the 5G-GUTI in the 5GS mobile identity IE. If the UE is registering with an
SNPN and the valid 5G-GUTI was previously assigned by another SNPN, the UE
shall additionally include the NID of the other SNPN in the NID IE.
If the UE does not operate in SNPN access operation mode, holds two valid
native 5G-GUTIs assigned by PLMNs and:
1) one of the valid native 5G-GUTI was assigned by the PLMN with which the UE
is performing the registration, then the UE shall indicate the valid native
5G-GUTI assigned by the PLMN with which the UE is performing the registration.
In addition, the UE shall include the other valid native 5G-GUTI in the
Additional GUTI IE; or
2) none of the valid native 5G-GUTI was assigned by the PLMN with which the UE
is performing the registration, then the UE shall indicate the valid native
5G-GUTI assigned over the same access via which the UE is performing the
registration.
If the UE supports MICO mode and requests the use of MICO mode, then the UE
shall include the MICO indication IE in the REGISTRATION REQUEST message. If
the UE requests to use an active time value, it shall include the active time
value in the T3324 IE in the REGISTRATION REQUEST message. If the UE includes
the T3324 IE, it may also request a particular T3512 value by including the
Requested T3512 IE in the REGISTRATION REQUEST message. Additionally, if the
UE supports strictly periodic registration timer, the UE shall set the
Strictly Periodic Registration Timer Indication bit of the MICO indication IE
in the REGISTRATION REQUEST message to \"strictly periodic registration timer
supported\". If the UE needs to stop the use of MICO mode, then the UE shall
not include the MICO indication IE in the REGISTRATION REQUEST message.
If the UE needs to use or change the UE specific DRX parameters, the UE shall
include the Requested DRX parameters IE in the REGISTRATION REQUEST message.
If the UE is in NB-N1 mode and if the UE needs to use or change the UE
specific DRX parameters for NB-N1 mode, the UE shall include the Requested
NB-N1 mode DRX parameters IE in the REGISTRATION REQUEST message.
If the UE supports eDRX and requests the use of eDRX, the UE shall include the
Requested extended DRX parameters IE in the REGISTRATION REQUEST message.
If the UE needs to request LADN information for specific LADN DNN(s) or
indicates a request for LADN information as specified in 3GPP TS 23.501 [8],
the UE shall include the LADN indication IE in the REGISTRATION REQUEST
message and:
\- request specific LADN DNNs by including a LADN DNN value in the LADN
indication IE for each LADN DNN for which the UE requests LADN information; or
\- to indicate a request for LADN information by not including any LADN DNN
value in the LADN indication IE.
If the UE is initiating the registration procedure for mobility and periodic
registration update, the UE may include the Uplink data status IE to indicate
which PDU session(s) that is:
\- not associated with control plane only indication;
\- associated with the access type the REGISTRATION REQUEST message is sent
over; and
\- have pending user data to be sent over user plane.
If the UE has one or more active always-on PDU sessions associated with the
access type over which the REGISTRATION REQUEST message is sent and the user-
plane resources for these PDU sessions are not established, and for cases
triggering the REGISTRATION REQUEST message except b), the UE shall include
the Uplink data status IE and indicate that the UE has pending user data to be
sent for those PDU sessions. If the UE is located outside the LADN service
area, the UE shall not include the PDU session for LADN in the Uplink data
status IE. If the UE is in a non-allowed area or is not in an allowed area as
specified in subclause 5.3.5, the UE shall not include the Uplink data status
IE except for emergency services or for high priority access. If the MUSIM UE
requests the network to release the NAS signalling connection, the UE shall
not include the Uplink data status IE in the REGISTRATION REQUEST message.
If the UE has one or more active PDU sessions which are not accepted by the
network as always-on PDU sessions and no uplink user data pending to be sent
for those PDU sessions, the UE shall not include those PDU sessions in the
Uplink data status IE in the REGISTRATION REQUEST message.
When the registration procedure for mobility and periodic registration update
is initiated in 5GMM-IDLE mode, the UE may include a PDU session status IE in
the REGISTRATION REQUEST message, indicating:
\- which single access PDU sessions associated with the access type the
REGISTRATION REQUEST message is sent over are active in the UE; and
\- which MA PDU sessions are active and having user plane resources
established in the UE on the access the REGISTRATION REQUEST message is sent
over.
If the UE received a paging message with the access type indicating non-3GPP
access, the UE shall include the Allowed PDU session status IE in the
REGISTRATION REQUEST message. If the UE has established the PDU session(s)
over the non-3GPP access for which the associated S-NSSAI(s) are included in
the allowed NSSAI for 3GPP access, the UE shall indicate the PDU session(s)
for which the UE allows to re-establish the user-plane resources over 3GPP
access in the Allowed PDU session status IE. Otherwise, the UE shall not
indicate any PDU session(s) in the Allowed PDU session status IE.
When the Allowed PDU session status IE is included in the REGISTRATION REQUEST
message, the UE shall indicate that a PDU session is not allowed to be
transferred to the 3GPP access if the 3GPP PS data off UE status is
\"activated\" for the corresponding PDU session and the UE is not using the
PDU session to send uplink IP packets for any of the 3GPP PS data off exempt
services (see subclause 6.2.10).
If the UE operating in the single-registration mode performs inter-system
change from S1 mode to N1 mode, the UE:
a) shall include the UE status IE with the EMM registration status set to \"UE
is in EMM-REGISTERED state\" in the REGISTRATION REQUEST message;
NOTE 6: Inclusion of the UE status IE with this setting corresponds to the
indication that the UE is \"moving from EPC\" as specified in 3GPP TS 23.502
[9], subclause 4.11.1.3.3 and 4.11.2.3.
NOTE 7: The value of the 5GMM registration status included by the UE in the UE
status IE is not used by the AMF.
b) may include the PDU session status IE in the REGISTRATION REQUEST message
indicating the status of the PDU session(s) mapped during the inter-system
change from S1 mode to N1 mode from the PDN connection(s) for which the EPS
indicated that interworking to 5GS is supported, if any (see subclause
6.1.4.1);
c) shall include a TRACKING AREA UPDATE REQUEST message as specified in 3GPP
TS 24.301 [15] in the EPS NAS message container IE in the REGISTRATION REQUEST
message if the registration procedure is initiated in 5GMM-IDLE mode and the
UE has received an \"interworking without N26 interface not supported\"
indication from the network;
c1) may include a TRACKING AREA UPDATE REQUEST message as specified in 3GPP TS
24.301 [15] in the EPS NAS message container IE in the REGISTRATION REQUEST
message if the registration procedure is initiated in 5GMM-IDLE mode and the
UE has received an \"interworking without N26 interface supported\" indication
from the network; and
d) shall include an EPS bearer context status IE in the REGISTRATION REQUEST
message indicating which EPS bearer contexts are active in the UE, if the UE
has locally deactivated EPS bearer context(s) for which interworking to 5GS is
supported while the UE was in S1 mode without notifying the network.
For a REGISTRATION REQUEST message with a 5GS registration type IE indicating
\"mobility registration updating\", if the UE:
a) is in NB-N1 mode and:
1) the UE needs to change the slice(s) it is currently registered to within
the same registration area; or
2) the UE has entered a new registration area; or
b) the UE is not in NB-N1 mode and is not registered for onboarding services
in SNPN;
the UE shall include the Requested NSSAI IE containing the S-NSSAI(s)
corresponding to the network slices to which the UE intends to register and
associated mapped S-NSSAI(s), if available, in the REGISTRATION REQUEST
message as described in this subclause. When the UE is entering a visited PLMN
and intends to register to the slices for which the UE has only HPLMN
S-NSSAI(s) available, the UE shall include these HPLMN S-NSSAI(s) in the
Requested mapped NSSAI IE.
NOTE 8: The REGISTRATION REQUEST message can include both the Requested NSSAI
IE and the Requested mapped NSSAI IE as described below.
If the UE is registered for onboarding services in SNPN, the UE shall not
include the Requested NSSAI IE in the REGISTRATION REQUEST message.
If the UE has allowed NSSAI or configured NSSAI or both for the current PLMN,
the Requested NSSAI IE shall include either:
a) the configured NSSAI for the current PLMN or SNPN, or a subset thereof as
described below;
b) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as
described below; or
c) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as
described below, plus one or more S-NSSAIs from the configured NSSAI for which
no corresponding S-NSSAI is present in the allowed NSSAI and those are neither
in the rejected NSSAI nor in the pending NSSAI.
and in addition the Requested NSSAI IE shall include S-NSSAI(s) applicable in
the current PLMN or SNPN, and if available the associated mapped S-NSSAI(s)
for:
a) each PDN connection that is established in S1 mode when the UE is operating
in the single-registration mode and the UE is performing an inter-system
change from S1 mode to N1 mode; or
b) each active PDU session.
If the UE does not have S-NSSAI(s) applicable in the current PLMN or SNPN,
then the Requested mapped NSSAI IE shall include HPLMN S-NSSAI(s) (e.g. mapped
S-NSSAI(s), if available) for:
a) each PDN connection established in S1 mode when the UE is operating in the
single-registration mode and the UE is performing an inter-system change from
S1 mode to N1 mode to a visited PLMN; or
b) each active PDU session when the UE is performing mobility from N1 mode to
N1 mode to a visited PLMN.
NOTE 9: The Requested NSSAI IE is used instead of Requested mapped NSSAI IE in
REGISTRATION REQUEST message when the UE enters HPLMN.
For a REGISTRATION REQUEST message with a 5GS registration type IE indicating
\"mobility registration updating\", if the UE is in NB-N1 mode and the
procedure is initiated for all cases except case a), c), e), i), s), t), w),
and x), the REGISTRATION REQUEST message shall not include the Requested NSSAI
IE.
If the UE has:
\- no allowed NSSAI for the current PLMN or SNPN;
\- no configured NSSAI for the current PLMN or SNPN;
\- neither active PDU session(s) nor PDN connection(s) to transfer associated
with an S-NSSAI applicable in the current PLMN or SNPN; and
\- neither active PDU session(s) nor PDN connection(s) to transfer associated
with mapped S-NSSAI(s);
and has a default configured NSSAI, then the UE shall:
a) include the S-NSSAI(s) in the Requested NSSAI IE of the REGISTRATION
REQUEST message using the default configured NSSAI; and
b) include the Network slicing indication IE with the Default configured NSSAI
indication bit set to \"Requested NSSAI created from default configured
NSSAI\" in the REGISTRATION REQUEST message.
If the UE has:
\- no allowed NSSAI for the current PLMN or SNPN;
\- no configured NSSAI for the current PLMN or SNPN;
\- neither active PDU session(s) nor PDN connection(s) to transfer associated
with an S-NSSAI applicable in the current PLMN or SNPN
\- neither active PDU session(s) nor PDN connection(s) to transfer associated
with mapped S-NSSAI(s); and
\- no default configured NSSAI,
the UE shall include neither Requested NSSAI IE nor Requested mapped NSSAI IE
in the REGISTRATION REQUEST message.
If all the S-NSSAI(s) corresponding to the slice(s) to which the UE intends to
register are included in the pending NSSAI, the UE shall not include a
requested NSSAI in the REGISTRATION REQUEST message.
When the UE storing a pending NSSAI intends to register to additional
S-NSSAI(s) over the same access type, the UE shall send the requested NSSAI
containing the additional S-NSSAI(s) that the UE intends to register to in the
REGISTRATION REQUEST message. The requested NSSAI shall not include any
S-NSSAI from the pending NSSAI.
The subset of configured NSSAI provided in the requested NSSAI consists of one
or more S-NSSAIs in the configured NSSAI applicable to this PLMN or SNPN, if
the S-NSSAI is neither in the rejected NSSAI nor associated to the S-NSSAI(s)
in the rejected NSSAI. In addition, if the NSSRG information is available, the
subset of configured NSSAI provided in the requested NSSAI shall be associated
with at least one common NSSRG value. If the UE is in 5GMM-REGISTERED state
over the other access and has already an allowed NSSAI for the other access in
the same PLMN or in different PLMNs, all the S-NSSAI(s) in the requested NSSAI
for the current access shall share at least an NSSRG value common to all the
S-NSSAI(s) of the allowed NSSAI for the other access. If the UE is
simultaneously performing the registration procedure on the other access in
different PLMNs, the UE shall include S-NSSAIs that share at least a common
NSSRG value across all access types. The S-NSSAIs in the pending NSSAI and
requested NSSAI shall be associated with at least one common NSSRG value.
NOTE 10: If the UE has stored mapped S-NSSAI(s) for the rejected NSSAI, and
one or more S-NSSAIs in the stored mapped S-NSSAI(s) for the configured NSSAI
are not included in the stored mapped S-NSSAI(s) for the rejected NSSAI, then
a S-NSSAI in the configured NSSAI associated to one or more of these mapped
S-NSSAI(s) for the configured NSSAI are available to be included in the
requested NSSAI together with their mapped S-NSSAI.
NOTE 11: If one or more mapped S-NSSAIs in the stored mapped S-NSSAI(s) for
the configured NSSAI are not included in the stored rejected NSSAI for the
failed or revoked NSSAA, a S-NSSAI in the configured NSSAI associated to one
or more of these mapped S-NSSAI(s) for the configured NSSAI are available to
be included in the registration request together with their mapped S-NSSAI.
NOTE 12: There is no need to consider the case that the UE is simultaneously
performing the registration procedure on the other access in the same PLMN,
due to that the UE is not allowed to initiate the registration procedure over
one access when the registration over the other access to the same PLMN is
going on.
The subset of allowed NSSAI provided in the requested NSSAI consists of one or
more S-NSSAIs in the allowed NSSAI for this PLMN.
NOTE 13: How the UE selects the subset of configured NSSAI or allowed NSSAI to
be provided in the requested NSSAI is implementation specific. The UE can take
preferences indicated by the upper layers (e.g. policies like URSP,
applications) and UE local configuration into account.
NOTE 14: The number of S-NSSAI(s) included in the requested NSSAI cannot
exceed eight.
If the UE supports NSAG, the UE shall set the NSAG bit to \"NSAG supported\"
in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE
supports sending of REGISTRATION COMPLETE message for acknowledging the
reception of NSAG information IE in the REGISTRATION ACCEPT message, the UE
shall set the RCMAN bit to \"Sending of REGISTRATION COMPLETE message for NSAG
information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message.
The UE shall set the Follow-on request indicator to \"Follow-on request
pending\", if the UE:
a) initiates the mobility and periodic registration updating procedure upon
request of the upper layers to establish an emergency PDU session;
b) initiates the mobility and periodic registration updating procedure upon
receiving a request from the upper layers to perform emergency services
fallback; or
c) needs to prolong the established NAS signalling connection after the
completion of the registration procedure for mobility and periodic
registration update (e.g. due to uplink signalling pending but no user data
pending).
NOTE 15: The UE does not have to set the Follow-on request indicator to 1 even
if the UE has to request resources for V2X communication over PC5 reference
point, 5G ProSe direct discovery over PC5 or 5G ProSe direct communication
over PC5.
For case n), the UE shall include the 5GS update type IE in the REGISTRATION
REQUEST message with the NG-RAN-RCU bit set to \" UE radio capability update
needed\". Additionally, if the UE is not in NB-N1 mode, the UE supports RACS
and the UE has an applicable UE radio capability ID for the new UE radio
configuration in the serving PLMN or SNPN, the UE shall include the applicable
UE radio capability ID in the UE radio capability ID of the REGISTRATION
REQUEST message.
If the UE is in the 5GMM-CONNECTED mode and the UE changes the radio
capability for NG-RAN or Eâ€‘UTRAN, the UE may locally release the established
N1 NAS signalling connection and enter the 5GMM-IDLE mode. Then, the UE shall
initiate the registration procedure for mobility and periodic updating
including the 5GS update type IE in the REGISTRATION REQUEST message with the
NG-RAN-RCU bit set to \" UE radio capability update needed\".
For case o), the UE shall include the Uplink data status IE in the
REGISTRATION REQUEST message indicating the PDU session(s) without active
user-plane resources for which the UE has pending user data to be sent, if
any, and the PDU session(s) for which user-plane resources were active prior
to receiving the fallback indication, if any. If the UE is in a non-allowed
area or if the UE is not in allowed area, the UE shall not include the Uplink
data status IE in REGISTRATION REQUEST message, except if the PDU session for
which user-plane resources were active prior to receiving the fallback
indication is an emergency PDU session, or if the UE is configured for high
priority access in the selected PLMN as specified in subclause 5.3.5.
For case f), the UE shall include the Uplink data status IE in the
REGISTRATION REQUEST message indicating the PDU session(s) for which user-
plane resources were active prior to receiving \"RRC Connection failure\"
indication from the lower layers, if any. If the UE is in non-allowed area or
not in allowed area, the UE shall not include the Uplink data status IE in
REGISTRATION REQUEST message, except that the PDU session(s) for which user-
plane resources were active prior to receiving the \"RRC Connection
failure\"indication is emergency PDU session(s), or that the UE is configured
for high priority access in selected PLMN, as specified in subclause 5.3.5.
If the UE supports service gap control, then the UE shall set the SGC bit to
\"service gap control supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
For case a), x) or if the UE operating in the single-registration mode
performs inter-system change from S1 mode to N1 mode, the UE shall:
a) if the UE has an applicable network-assigned UE radio capability ID for the
current UE radio configuration in the selected PLMN or SNPN, include the
applicable network-assigned UE radio capability ID in the UE radio capability
ID IE of the REGISTRATION REQUEST message; and
b) if the UE:
1) does not have an applicable network-assigned UE radio capability ID for the
current UE radio configuration in the selected PLMN or SNPN; and
2) has an applicable manufacturer-assigned UE radio capability ID for the
current UE radio configuration,
include the applicable manufacturer-assigned UE radio capability ID in the UE
radio capability ID IE of the REGISTRATION REQUEST message.
For all cases except cases b and z, if the UE supports ciphered broadcast
assistance data and the UE needs to obtain new ciphering keys, the UE shall
include the Additional information requested IE with the CipherKey bit set to
\"ciphering keys for ciphered broadcast assistance data requested\" in the
REGISTRATION REQUEST message.
For case z, the UE shall include the Additional information requested IE with
the CipherKey bit set to \"ciphering keys for ciphered broadcast assistance
data requested\" in the REGISTRATION REQUEST message.
For case a, if the UE supports ciphered broadcast assistance data and the UE
detects that one or more ciphering keys stored at the UE is not applicable in
the current TAI, the UE should include the Additional information requested IE
with the CipherKey bit set to \"ciphering keys for ciphered broadcast
assistance data requested\" in the REGISTRATION REQUEST message.
For case b, if the UE supports ciphered broadcast assistance data and the
remaining validity time for one or more ciphering keys stored at the UE is
less than timer T3512, the UE should include the Additional information
requested IE with the CipherKey bit set to \"ciphering keys for ciphered
broadcast assistance data requested\" in the REGISTRATION REQUEST message.
The UE shall set the WUSA bit to \"WUS assistance information reception
supported\" in the 5GMM capability IE if the UE supports WUS assistance
information. The UE may include its UE paging probability information in the
Requested WUS assistance information IE if the UE has set the WUSA bit to
\"WUS assistance information reception supported\" in the 5GMM capability IE
and does not have an active emergency PDU session.
The UE shall set the NR-PSSI bit to \"NR paging subgrouping supported\" in the
5GMM capability IE if the UE supports PEIPS assistance information, is not
registered for emergency services and does not have an active emergency PDU
session. The UE may include its UE paging probability information in the
Requested PEIPS assistance information IE if the UE has set the NR-PSSI bit to
\"NR paging subgrouping supported\" in the 5GMM capability IE.
If the network supports the N1 NAS signalling connection release, and the
MUSIM UE requests the network to release the NAS signalling connection, the UE
shall set Request type to \"NAS signalling connection release\" in the UE
request type IE, set the Follow-on request indicator to \"No follow-on request
pending\" and, if the network supports the paging restriction, may set the
paging restriction preference in the Paging restriction IE in the REGISTRATION
REQUEST message. In addition, the UE shall not include the Uplink data status
IE or the Allowed PDU session status IE in the REGISTRATION REQUEST message
even if the UE has one or more active always-on PDU sessions associated with
the 3GPP access.
NOTE 16: If the network has already indicated support for N1 NAS signalling
connection release in the current stored registration area and the UE doesn\'t
have an emergency PDU session established, the MUSIM UE is allowed to request
the network to release the NAS signalling connection during mobility
registration update procedure that is due to mobility outside the registration
area even before detecting whether the network supports the N1 NAS signalling
connection release in the current TAI.
NOTE 17: If the network has already indicated support for paging restriction
in the current stored registration area and the UE doesn\'t have an emergency
PDU session established, the MUSIM UE is allowed to include paging restriction
together with the request to the network to release the NAS signalling
connection during mobility registration update procedure that is due to
mobility outside the registration area even before detecting whether the
network supports the paging restriction in the current TAI.
For case zi), the UE shall not include the Paging restriction IE in the
REGISTRATION REQUEST message. If the UE is in 5GMM-IDLE mode and the network
supports the N1 NAS signalling connection release, the UE may include the UE
request type IE and set Request type to \"NAS signalling connection release\"
to remove the paging restriction and request the release of the NAS signalling
connection at the same time. In addition, the UE shall not include the Uplink
data status IE in the REGISTRATION REQUEST message.
If the UE does not have a valid 5G NAS security context and the UE is sending
the REGISTRATION REQUEST message after an inter-system change from S1 mode to
N1 mode in 5GMM-IDLE mode, the UE shall send the REGISTRATION REQUEST message
without including the NAS message container IE. The UE shall include the
entire REGISTRATION REQUEST message (i.e. containing cleartext IEs and non-
cleartext IEs, if any) in the NAS message container IE that is sent as part of
the SECURITY MODE COMPLETE message as described in subclauses 4.4.6 and
5.4.2.3.
If the UE indicates \"mobility registration updating\" in the 5GS registration
type IE and supports V2X as specified in 3GPP TS 24.587 [19B], the UE shall
set the V2X bit to \"V2X supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message. If the UE indicates \"mobility registration
updating\" in the 5GS registration type IE and supports V2X communication over
E-UTRA-PC5 as specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCEPC5
bit to \"V2X communication over E-UTRA-PC5 supported\" in the 5GMM capability
IE of the REGISTRATION REQUEST message. If the UE indicates \"mobility
registration updating\" in the 5GS registration type IE and supports V2X
communication over NR-PC5 as specified in 3GPP TS 24.587 [19B], the UE shall
set the V2XCNPC5 bit to \"V2X communication over NR-PC5 supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message.
The UE shall send the REGISTRATION REQUEST message including the NAS message
container IE as described in subclause 4.4.6:
a) when the UE is sending the message from 5GMM-IDLE mode, the UE has a valid
5G NAS security context, and needs to send non-cleartext IEs; or
b) when the UE is sending the message after an inter-system change from S1
mode to N1 mode in 5GMM-IDLE mode and the UE has a valid 5G NAS security
context and needs to send non-cleartext IEs.
The UE with a valid 5G NAS security context shall send the REGISTRATION
REQUEST message without including the NAS message container IE when the UE
does not need to send non-cleartext IEs and the UE is sending the message:
a) from 5GMM-IDLE mode; or
b) after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode.
If the UE is sending the REGISTRATION REQUEST message after an inter-system
change from S1 mode to N1 mode in 5GMM-CONNECTED mode and the UE needs to send
non-cleartext IEs, the UE shall cipher the NAS message container IE using the
mapped 5G NAS security context and send the REGISTRATION REQUEST message
including the NAS message container IE as described in subclause 4.4.6. If the
UE does not need to send non-cleartext IEs, the UE shall send the REGISTRATION
REQUEST message without including the NAS message container IE.
If the REGISTRATION REQUEST message includes a NAS message container IE, the
AMF shall process the REGISTRATION REQUEST message that is obtained from the
NAS message container IE as described in subclause 4.4.6.
If the UE is in NB-N1 mode, then the UE shall set the Control plane CIoT 5GS
optimization bit to \"Control plane CIoT 5GS optimization supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message. If the UE is capable
of NB-S1 mode, then the UE shall set the Control plane CIoT EPS optimization
bit to \"Control plane CIoT EPS optimization supported\" in the S1 UE network
capability IE of the REGISTRATION REQUEST message.
If the registration procedure for mobility and periodic registration update is
initiated and there is request from the upper layers to perform \"emergency
services fallback\" pending, the UE shall send a REGISTRATION REQUEST message
without an Uplink data status IE.
If the UE supports N3 data transfer and multiple user-plane resources in NB-N1
mode (see 3GPP TS 36.306 [25D], 3GPP TS 36.331 [25A]), then the UE shall set
the Multiple user-plane resources support bit to \"Multiple user-plane
resources supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message.
The UE shall set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports the NSSRG, then the UE shall set the NSSRG bit to \"NSSRG
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
For case zf), the UE shall include the service-level device ID in the Service-
level-AA container IE of the REGISTRATION REQUEST message and set the value to
the CAA-level UAV ID. The UE shall include the service-level-AA server address
in the Service-level-AA container IE of the REGISTRATION REQUEST message and
set the value to the USS address, if it is provided by the upper layers.
If the UE supports 5G ProSe direct discovery as specified in 3GPP TS 24.554
[19E], the UE shall set the 5G ProSe-dd bit to \"5G ProSe direct discovery
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If
the UE supports 5G ProSe direct communication as specified in 3GPP TS 24.554
[19E], the UE shall set the 5G ProSe-dc bit to \"5G ProSe discovery
communication supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message. If the UE supports acting as 5G ProSe layer-2 UE-to-network
relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G
ProSe-l2relay bit to \"Acting as a 5G ProSe layer-2 UE-to-network relay UE
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If
the UE supports acting as 5G ProSe layer-3 UE-to-network relay UE as specified
in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3relay bit to \"Acting
as a 5G ProSe layer-3 UE-to-network relay UE supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message. If the UE supports acting
as 5G ProSe layer-2 UE-to-network remote UE as specified in 3GPP TS 24.554
[19E], the UE shall set the 5G ProSe-l2rmt bit to \"Acting as a 5G ProSe
layer-2 UE-to-network remote UE supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-3
UE-to-network remote UE as specified in 3GPP TS 24.554 [19E], the UE shall set
the 5G ProSe-l3rmt bit to \"Acting as a 5G ProSe layer-3 UE-to-network remote
UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
For all cases except case b, if the MUSIM UE supports the N1 NAS signalling
connection release, then the UE shall set the N1 NAS signalling connection
release bit to \"N1 NAS signalling connection release supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message otherwise the UE shall not
set the N1 NAS signalling connection release bit to \"N1 NAS signalling
connection release supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message.
For all cases except case b, if the MUSIM UE supports the paging indication
for voice services, then the UE shall set the paging indication for voice
services bit to \"paging indication for voice services supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message otherwise the UE shall not
set the paging indication for voice services bit to \"paging indication for
voice services supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message.
For all cases except case b, if the MUSIM UE supports the reject paging
request, then the UE shall set the reject paging request bit to \"reject
paging request supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message otherwise the UE shall not set the reject paging request bit
to \"reject paging request supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
For all cases except case b, if the MUSIM UE sets:
\- the reject paging request bit to \"reject paging request supported\";
\- the N1 NAS signalling connection release bit to \"N1 NAS signalling
connection release supported\"; or
\- both of them;
and supports the paging restriction, then the UE shall set the paging
restriction bit to \"paging restriction supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message otherwise the UE shall not set the paging
restriction bit to \"paging restriction supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message.
If the UE supports MINT, the UE shall set the MINT bit to \"MINT supported\"
in the 5GMM capability IE of the REGISTRATION REQUEST message.
If the UE supports UAS services, the UE shall set the UAS bit to \"UAS
services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST
message.
For case zg), if the UE has determined the MS determined PLMN with disaster
condition as specified in 3GPP TS 23.122 [5], and:
a) the MS determined PLMN with disaster condition is the HPLMN and:
1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and
does not contain a valid 5G-GUTI that was previously assigned by the HPLMN; or
2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message
and the 5GS mobile identity IE contains neither the SUCI nor a valid 5G-GUTI
that was previously assigned by the HPLMN; or
b) the MS determined PLMN with disaster condition is not the HPLMN and:
1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and
does not contain a valid 5G-GUTI that was previously assigned by the MS
determsined PLMN with disaster condition; or
2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message
and the 5GS mobile identity IE does not contain a valid 5G-GUTI that was
previously assigned by the MS determined PLMN with disaster condition;
the UE shall include in the REGISTRATION REQUEST message the MS determined
PLMN with disaster condition IE indicating the MS determined PLMN with
disaster condition.
NOTE 18: If the UE initiates the registration procedure for disaster roaming
services, and the MS determined PLMN with disaster condition cannot be
determined when an NG-RAN cell of the PLMN broadcasts the disaster related
indication as specified in 3GPP TS 23.122 [5], the UE does not include in the
REGISTRATION REQUEST message the MS determined PLMN with disaster condition IE
but includes the Additional GUTI IE or the 5GS mobile identity IE or both as
specified in subclauses 5.5.1.2.2.
For case zh) the UE shall indicate \"mobility registration updating\" in the
5GS registration type IE of the REGISTRATION REQUEST message.
If the UE supports event notification, the UE shall set the EventNotification
bit to \"Event notification supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message.
If the UE supports access to an SNPN using credentials from a credentials
holder and the UE is in its HPLMN or EHPLMN or a subscribed SNPN, the UE shall
set the SSNPNSI bit to \"SOR-SNPN-SI supported\" in the 5GMM capability IE of
the REGISTRATION REQUEST message.
If the UE supports MPS indicator update via the UE configuration update
procedure, the UE shall set the MPSIU bit to \"MPS indicator update
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.
Figure 5.5.1.3.2.1: Registration procedure for mobility and periodic
registration update
##### 5.5.1.3.3 5GMM common procedure initiation
The AMF may initiate 5GMM common procedures, e.g. the identification,
authentication and security procedures during the registration procedure,
depending on the information received in the REGISTRATION REQUEST message.
The AMF may be configured to skip the authentication procedure even if no 5GS
security context is available and proceed directly to the execution of the
security mode control procedure as specified in subclause 5.4.2, during the
registration procedure for mobility and periodic registration update for a UE
that has only an emergency PDU session.
The AMF shall not initiate a 5GMM authentication procedure before completion
of the registration procedure for mobility and periodic registration update,
if the following conditions apply:
a) the UE initiated the registration procedure for mobility and periodic
registration update after handover or inter-system change to N1 mode in 5GMM-
CONNECTED mode;
b) the target cell is a shared network cell; and
c.1) the UE has provided its 5G-GUTI in the 5GS mobile identity IE or the
Additional GUTI IE in the REGISTRATION REQUEST message, and the PLMN identity
included in the 5G-GUTI is different from the selected PLMN identity of the
target cell; or
c.2) the UE has included the 5G-GUTI mapped from the 4G-GUTI in the 5GS mobile
identity IE and not included an Additional GUTI IE in the REGISTRATION REQUEST
message, and the PLMN identity included in the 5G-GUTI is different from the
selected PLMN identity of the target cell.
##### 5.5.1.3.4 Mobility and periodic registration update accepted by the
network
If the registration update request has been accepted by the network, the AMF
shall send a REGISTRATION ACCEPT message to the UE.
If timer T3513 is running in the AMF, the AMF shall stop timer T3513 if a
paging request was sent with the access type indicating non-3GPP and the
REGISTRATION REQUEST message includes the Allowed PDU session status IE.
If timer T3565 is running in the AMF, the AMF shall stop timer T3565 when a
REGISTRATION REQUEST message is received.
For each of the information elements: 5GMM capability, S1 UE network
capability, and UE security capability, the AMF shall store all octets
received from the UE in the REGISTRATION REQUEST message, up to the maximum
length defined for the respective information element.
NOTE 1: This information is forwarded to the new AMF during inter-AMF handover
or to the new MME during inter-system handover to S1 mode.
The 5G-GUTI reallocation shall be part of the registration procedure for
mobility registration update. The 5G-GUTI reallocation should be part of the
registration procedure for periodic registration update. During the
registration procedure for mobility registration update, if the AMF has not
allocated a new 5G-GUTI by the generic UE configuration update procedure, the
AMF shall include in the REGISTRATION ACCEPT message the new assigned 5G-GUTI.
If the UE has set the CAG bit to \"CAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message and the AMF needs to update the \"CAG
information list\" stored in the UE, the AMF shall include the CAG information
list IE or the Extended CAG information list IE in the REGISTRATION ACCEPT
message.
NOTE 2: The \"CAG information list\" can be provided by the AMF and include no
entry if no \"CAG information list\" exists in the subscription.
NOTE 2A: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the UE does not support extended CAG information list, the CAG information
list shall not be included in the Extended CAG information list IE.
If a 5G-GUTI or the SOR transparent container IE is included in the
REGISTRATION ACCEPT message, the AMF shall start timer T3550 and enter state
5GMM-COMMON-PROCEDURE-INITIATED as described in subclause 5.1.3.2.3.3.
If the Operator-defined access category definitions IE or the Extended
emergency number list IE ,the CAG information list IE or the Extended CAG
information list IE are included in the REGISTRATION ACCEPT message, the AMF
shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as
described in subclause 5.1.3.2.3.3.
If the UE has set the RCMP bit to \"Sending of REGISTRATION COMPLETE message
for negotiated PEIPS parameters supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message and if the PEIPS assistance information IE is
included in the REGISTRATION ACCEPT message, the AMF shall start timer T3550
and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause
5.1.3.2.3.3.
If the UE is not in NB-N1 mode and the UE has set the RACS bit to \"RACS
supported\" in the 5GMM Capability IE of the REGISTRATION REQUEST message, the
AMF may include either a UE radio capability ID IE or a UE radio capability ID
deletion indication IE in the REGISTRATION ACCEPT message. If the UE radio
capability ID IE or the UE radio capability ID deletion indication IE is
included in the REGISTRATION ACCEPT message, the AMF shall start timer T3550
and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause
5.1.3.2.3.3.
The AMF may include a new TAI list for the UE in the REGISTRATION ACCEPT
message. The new TAI list shall not contain both tracking areas in NB-N1 mode
and tracking areas not in NB-N1 mode. The UE, upon receiving a REGISTRATION
ACCEPT message, shall delete its old TAI list and store the received TAI list.
If there is no TAI list received, the UE shall consider the old TAI list as
valid. If the registration area contains TAIs belonging to different PLMNs,
which are equivalent PLMNs, and
a) the UE already has stored allowed NSSAI for the current registration area,
the UE shall store the allowed NSSAI for the current registration area in each
of the allowed NSSAIs which are associated with each of the PLMNs in the
registration area; and
b) the UE already has stored rejected NSSAI for the current registration area,
the UE shall store the rejected NSSAI for the current registration area in
each of the rejected NSSAIs which are associated with each of the PLMNs in the
registration area.
NOTE 3: When assigning the TAI list, the AMF can take into account the
eNodeB\'s capability of support of CIoT 5GS optimization.
The AMF may also include a list of equivalent PLMNs in the REGISTRATION ACCEPT
message. Each entry in the list contains a PLMN code (MCC+MNC). The UE shall
store the list as provided by the network, and if there is no emergency PDU
session established, the UE shall remove from the list any PLMN code that is
already in the forbidden PLMN list as specified in subclause 5.3.13A. If the
UE is not registered for emergency services and there is an emergency PDU
session established, the UE shall remove from the list of equivalent PLMNs any
PLMN code present in the forbidden PLMN list as specified in subclause
5.3.13A, when the emergency PDU session is released. In addition, the UE shall
add to the stored list the PLMN code of the registered PLMN that sent the
list. The UE shall replace the stored list on each receipt of the REGISTRATION
ACCEPT message. If the REGISTRATION ACCEPT message does not contain a list,
then the UE shall delete the stored list.
If the UE is not registered for emergency services, and if the PLMN identity
of the registered PLMN is a member of the forbidden PLMN list as specified in
subclause 5.3.13A, any such PLMN identity shall be deleted from the
corresponding list(s).
The AMF may include new service area restrictions in the Service area list IE
in the REGISTRATION ACCEPT message. The UE, upon receiving a REGISTRATION
ACCEPT message with new service area restrictions shall act as described in
subclause 5.3.5.
If the Service area list IE is not included in the REGISTRATION ACCEPT
message, any tracking area in the registered PLMN and its equivalent PLMN(s)
in the registration area is considered as an allowed tracking area as
described in subclause 5.3.5.
The AMF shall include the MICO indication IE in the REGISTRATION ACCEPT
message only if the MICO indication IE was included in the REGISTRATION
REQUEST message, the AMF supports and accepts the use of MICO mode. If the AMF
supports and accepts the use of MICO mode, the AMF may indicate \"all PLMN
registration area allocated\" in the MICO indication IE in the REGISTRATION
ACCEPT message. If \"all PLMN registration area allocated\" is indicated in
the MICO indication IE, the AMF shall not assign and include the TAI list in
the REGISTRATION ACCEPT message. If the REGISTRATION ACCEPT message includes
an MICO indication IE indicating \"all PLMN registration area allocated\", the
UE shall treat all TAIs in the current PLMN as a registration area and delete
its old TAI list. If \"strictly periodic registration timer supported\" is
indicated in the MICO indication IE in the REGISTRATION REQUEST message, the
AMF may indicate \"strictly periodic registration timer supported\" in the
MICO indication IE and may include the T3512 value IE in the REGISTRATION
ACCEPT message. If the timer value received in T3512 IE is different from the
already stored value of the timer T3512 and the timer T3512 is running, the UE
shall restart T3512 with the new value received in the T3512 value IE.
The AMF shall include an active time value in the T3324 IE in the REGISTRATION
ACCEPT message if the UE requested an active time value in the REGISTRATION
REQUEST message and the AMF accepts the use of MICO mode and the use of active
time.
If the UE does not include MICO indication IE in the REGISTRATION REQUEST
message, then the AMF shall disable MICO mode if it was already enabled.
If the AMF supports and accepts the use of MICO, and the UE included the
Requested T3512 value IE in the REGISTRATION REQUEST message, then the AMF
shall take into account the T3512 value requested when providing the T3512
value IE in the REGISTRATION ACCEPT message.
NOTE 4: The T3512 value assigned to the UE by AMF can be different from the
T3512 value requested by the UE. AMF can take several factors into account
when assigning the T3512 value, e.g. local configuration, expected UE
behaviour, UE requested T3512 value, UE subscription data, network policies.
The AMF may include the T3512 value IE in the REGISTRATION ACCEPT message only
if the REGISTRATION REQUEST message was sent over the 3GPP access.
The AMF may include the non-3GPP de-registration timer value IE in the
REGISTRATION ACCEPT message only if the REGISTRATION REQUEST message was sent
for the non-3GPP access.
If the UE indicates support of the N1 NAS signalling connection release in the
REGISTRATION REQUEST message and the network decides to accept the N1 NAS
signalling connection release, then the AMF shall set the N1 NAS signalling
connection release bit to \"N1 NAS signalling connection release supported\"
in the 5GS network feature support IE of the REGISTRATION ACCEPT message.
If the UE indicates support of the paging indication for voice services in the
REGISTRATION REQUEST message and the network decides to accept the paging
indication for voice services, then the AMF shall set the paging indication
for voice services bit to \"paging indication for voice services supported\"
in the 5GS network feature support IE of the REGISTRATION ACCEPT message. If
the UE receives the REGISTRATION ACCEPT message with the paging indication for
voice services bit set to \"paging indication for voice services supported\",
the UE NAS layer informs the lower layers that paging indication for voice
services is supported. Otherwise, the UE NAS layer informs the lower layers
that paging indication for voice services is not supported.
If the UE indicates support of the reject paging request in the REGISTRATION
REQUEST message and the network decides to accept the reject paging request,
then the AMF shall set the reject paging request bit to \"reject paging
request supported\" in the 5GS network feature support IE of the REGISTRATION
ACCEPT message.
If the UE indicates support of the paging restriction in the REGISTRATION
REQUEST message, and the AMF sets:
\- the reject paging request bit to \"reject paging request supported\";
\- the N1 NAS signalling connection release bit to \"N1 NAS signalling
connection release supported\"; or
\- both of them;
in the 5GS network feature support IE of the REGISTRATION ACCEPT message, and
the network decides to accept the paging restriction, then the AMF shall set
the paging restriction bit to \"paging restriction supported\" in the 5GS
network feature support IE of the REGISTRATION ACCEPT message.
If the MUSIM UE does not include the Paging restriction IE in the REGISTRATION
REQUEST message, the AMF shall delete any stored paging restriction for the UE
and stop restricting paging.
If the MUSIM UE requests the release of the NAS signalling connection, by
setting Request type to \"NAS signalling connection release\" in the UE
request type IE included in the REGISTRATION REQUEST message, and the AMF
supports the N1 NAS signalling connection release, the AMF shall initiate the
release of the NAS signalling connection after the completion of the
registration procedure for mobility and periodic registration update. If the
UE requests restriction of paging by including the Paging restriction IE and
the AMF supports the paging restriction, the AMF:
\- if accepts the paging restriction, shall include the 5GS additional request
result IE in the REGISTRATION ACCEPT message and set the Paging restriction
decision to \"paging restriction is accepted\". The AMF shall store the paging
restriction of the UE and enforce these restrictions in the paging procedure
as described in clause 5.6.2; or
\- if rejects the paging restriction, shall include the 5GS additional request
result IE in the REGISTRATION ACCEPT message and set the Paging restriction
decision to \"paging restriction is rejected\", and shall discard the received
paging restriction. The AMF shall delete any stored paging restriction for the
UE and stop restricting paging.
If the UE requests \"control plane CIoT 5GS optimization\" in the 5GS update
type IE, indicates support of control plane CIoT 5GS optimization in the 5GMM
capability IE and the AMF decides to accept the requested CIoT 5GS
optimization and the registration request, the AMF shall indicate \"control
plane CIoT 5GS optimization supported\" in the 5GS network feature support IE
of the REGISTRATION ACCEPT message.
If the UE has indicated support for the control plane CIoT 5GS optimizations,
and the AMF decides to activate the congestion control for transport of user
data via the control plane, then the AMF shall include the T3448 value IE in
the REGISTRATION ACCEPT message.
If the AMF decides to deactivate the congestion control for transport of user
data via the control plane, then the AMF shall delete the stored control plane
data back-off time for the UE and the AMF shall not include timer T3448 value
IE in the REGISTRATION ACCEPT message.
If:
\- the UE in NB-N1 mode is using control plane CIoT 5GS optimization; and
\- the network is configured to provide the truncated 5G-S-TMSI configuration
for control plane CIoT 5GS optimizations;
the AMF shall include the Truncated 5G-S-TMSI configuration IE in the
REGISTRATION ACCEPT message and set the \"Truncated AMF Set ID value\" and the
\"Truncated AMF Pointer value\" in the Truncated 5G-S-TMSI configuration IE
based on network policies. The AMF shall start timer T3550 and enter state
5GMM-COMMON-PROCEDURE-INITIATED as described in subclause 5.1.3.2.3.3.
For inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, if the UE
has included a ngKSI indicating a current 5G NAS security context in the
REGISTRATION REQUEST message by which the REGISTRATION REQUEST message is
integrity protected, the AMF shall take one of the following actions:
a) if the AMF retrieves the current 5G NAS security context as indicated by
the ngKSI and 5G-GUTI sent by the UE, the AMF shall integrity check the
REGISTRATION REQUEST message using the current 5G NAS security context and
integrity protect the REGISTRATION ACCEPT message using the current 5G NAS
security context;
b) if the AMF cannot retrieve the current 5G NAS security context as indicated
by the ngKSI and 5G-GUTI sent by the UE, the AMF shall treat the REGISTRATION
REQUEST message fails the integrity check and take actions as specified in
subclause 4.4.4.3; or
c) if the UE has not included an Additional GUTI IE, the AMF may treat the
REGISTRATION REQUEST message as in the previous item, i.e. as if it cannot
retrieve the current 5G NAS security context.
NOTE 5: The handling described above at failure to retrieve the current 5G NAS
security context or if no Additional GUTI IE was provided does not preclude
the option for the AMF to perform a primary authentication and key agreement
procedure and create a new native 5G NAS security context.
For inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the
AMF shall integrity check REGISTRATION REQUEST message using the current
K\'~AMF~ as derived when triggering the handover to N1 mode (see subclause
4.4.2.2). The AMF shall verify the received UE security capabilities in the
REGISTRATION REQUEST message. The AMF shall then take one of the following
actions:
a) if the REGISTRATION REQUEST does not contain a valid KSI~AMF~ in the Non-
current native NAS key set identifier IE, the AMF shall remove the non-current
native 5G NAS security context, if any, for any 5G-GUTI for this UE. The AMF
shall then integrity protect and cipher the REGISTRATION ACCEPT message using
the security context based on K\'~AMF~ and take the mapped 5G NAS security
context into use; or
b) if the REGISTRATION REQUEST contains a valid KSI~AMF~ in the Non-current
native NAS key set identifier IE and:
1) the AMF decides to take the native 5G NAS security context into use, the
AMF shall initiate a security mode control procedure to take the corresponding
native 5G NAS security context into use and then integrity protect and cipher
the REGISTRATION ACCEPT message using the corresponding native 5G NAS security
context; and
2) otherwise, the AMF shall then integrity protect and cipher the REGISTRATION
ACCEPT message using the security context based on K\'~AMF~ and take the
mapped 5G NAS security context into use.
NOTE 6: In above bullet b), it is recommended for the AMF to initiate a
security mode control procedure to take the corresponding native 5G NAS
security context into use.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message, and
if:
> \- the UE has a valid aerial UE subscription information; and
>
> \- the UUAA procedure is to be performed during the registration procedure
> according to operator policy; and
>
> \- there is no valid successful UUAA result for the UE in the UE 5GMM
> context,
then the AMF shall initiate the UUAA-MM procedure with the UAS-NF as specified
in TS 23.256 [6AB] and shall include a service-level-AA pending indication in
the Service-level-AA container IE of the REGISTRATION ACCEPT message. The AMF
shall store in the UE 5GMM context that a UUAA procedure is pending. The AMF
shall start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as
described in subclause 5.1.3.2.3.3.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message, and
if:
> \- the UE has a valid aerial UE subscription information;
>
> \- the UUAA procedure is to be performed during the registration procedure
> according to operator policy; and
>
> \- there is a valid successful UUAA result for the UE in the UE 5GMM
> context,
then the AMF shall include a service-level-AA response in the Service-level-AA
container IE of the REGISTRATION ACCEPT message and set the SLAR field in the
service-level-AA response to \"Service level authentication and authorization
was successful\".
If the AMF determines that the UUAA-MM procedure needs to be performed for a
UE, the AMF has not received the service -level device ID set to the CAA-level
UAV ID in the Service-level-AA container IE of the REGISTRATION REQUEST
message from the UE and the AMF decides to accept the UE to be registered for
other services than UAS services based on the user\'s subscription data and
the operator policy, the AMF shall accept the registration update request and
shall mark in the UE\'s 5GMM context that the UE is not allowed to request UAS
services.
If the UE supports MINT, the AMF may include the List of PLMNs to be used in
disaster condition IE in the REGISTRATION ACCEPT message.
If the UE supports MINT, the AMF may include the Disaster roaming wait range
IE in the REGISTRATION ACCEPT message.
If the UE supports MINT, the AMF may include the Disaster return wait range IE
in the REGISTRATION ACCEPT message.
NOTE 7: The AMF can determine the content of the \"list of PLMN(s) to be used
in disaster condition\", the value of the disaster roaming wait range and the
value of the disaster return wait range based on the network local
configuration.
If the AMF received the list of TAIs from the satellite NG-RAN as described in
3GPP TS 23.501 [8], and determines that, by UE subscription and operator\'s
preferences, any but not all TAIs in the received list of TAIs is forbidden
for roaming or for regional provision of service, the AMF shall include the
TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE; or
c) both;
in the REGISTRATION ACCEPT message.
NOTE 8: Void.
Upon receipt of the REGISTRATION ACCEPT message, the UE shall reset the
registration attempt counter and service request attempt counter, enter state
5GMM-REGISTERED and set the 5GS update status to 5U1 UPDATED.
If the UE receives the REGISTRATION ACCEPT message from a PLMN, then the UE
shall reset the PLMN-specific attempt counter for that PLMN for the specific
access type for which the message was received. The UE shall also reset the
PLMN-specific N1 mode attempt counter for that PLMN for the specific access
type for which the message was received. If the message was received via 3GPP
access, the UE shall reset the counter for \"SIM/USIM considered invalid for
GPRS services\" events and the counter for \"SIM/USIM considered invalid for
non-GPRS services\", if any. If the message was received via non-3GPP access,
the UE shall reset the counter for \"USIM considered invalid for 5GS services
over non-3GPP\" events.
If the UE receives the REGISTRATION ACCEPT message from an SNPN, then the UE
shall reset the SNPN-specific attempt counter for the current SNPN for the
specific access type for which the message was received. If the message was
received via 3GPP access, the UE shall reset the counter for \"the entry for
the current SNPN considered invalid for 3GPP access\" events. If the message
was received via non-3GPP access, the UE shall reset the counter for \"the
entry for the current SNPN considered invalid for non-3GPP access\" events.
If the REGISTRATION ACCEPT message included a T3512 value IE, the UE shall use
the value in T3512 value IE as periodic registration update timer (T3512). If
the T3512 value IE is not included, the UE shall use the value currently
stored, e.g. from a prior REGISTRATION ACCEPT message.
If the REGISTRATION ACCEPT message include a T3324 value IE, the UE shall use
the value in the T3324 value IE as active time timer (T3324). If the
REGISTRATION ACCEPT message does not include a T3324 value IE, UE shall not
start the timer T3324 until a new value is received from the network.
If the REGISTRATION ACCEPT message included a non-3GPP de-registration timer
value IE, the UE shall use the value in non-3GPP de-registration timer value
IE as non-3GPP de-registration timer. If non-3GPP de-registration timer value
IE is not included, the UE shall use the value currently stored, e.g. from a
prior REGISTRATION ACCEPT message. If non-3GPP de-registration timer value IE
is not included and there is no stored non-3GPP de-registration timer value in
the UE, the UE shall use the default value of the non-3GPP de-registration
timer.
If the REGISTRATION ACCEPT message contains a 5G-GUTI, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge the received 5G-GUTI,
stop timer T3519 if running, and delete any stored SUCI. The UE shall provide
the 5G-GUTI to the lower layer of 3GPP access if the REGISTRATION ACCEPT
message is sent over the non-3GPP access, and the UE is in 5GMM-REGISTERED in
both 3GPP access and non-3GPP access in the same PLMN.
If the REGISTRATION ACCEPT message contains the Network slicing indication IE
with the Network slicing subscription change indication set to \"Network
slicing subscription changed\", or contains a Configured NSSAI IE with a new
configured NSSAI for the current PLMN or SNPN and optionally the mapped
S-NSSAI(s) for the configured NSSAI for the current PLMN or SNPN, or contains
an NSSRG information IE with a new NSSRG information, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge the successful update
of the network slicing information. If the UE has set the RCMAN bit to
\"Sending of REGISTRATION COMPLETE message for NSAG information supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message and if REGISTRATION
ACCEPT message contains the NSAG information IE, the UE shall return
REGISTRATION COMPLETE message to the AMF to acknowledge the reception of the
NSAG information IE.
If the REGISTRATION ACCEPT message contains the CAG information list IE or the
Extended CAG information list IE and the UE had set the CAG bit to \"CAG
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message, the
UE shall:
a) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
b) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 9: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
c) remove the serving VPLMN\'s entry of the \"CAG information list\" stored in
the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
The UE shall store the \"CAG information list\" received in the CAG
information list IE or the Extended CAG information list IE as specified in
annex C.
If the received \"CAG information list\" includes an entry containing the
identity of the registered PLMN, the UE shall operate as follows.
a) if the UE receives the REGISTRATION ACCEPT message via a CAG cell, the
entry for the registered PLMN in the received \"CAG information list\" does
not include any of the CAG-ID(s) supported by the current CAG cell, and:
1) the entry for the registered PLMN in the received \"CAG information list\"
does not include an \"indication that the UE is only allowed to access 5GS via
CAG cells\", then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE
and shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP
TS 36.304 [25C] with the updated \"CAG information list\"; or
2) the entry for the registered PLMN in the received \"CAG information list\"
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and:
i) if the entry for the registered PLMN in the received \"CAG information
list\" includes one or more CAG-IDs, the UE shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to
3GPP TS 38.304 [28] with the updated \"CAG information list\"; or
ii) if the entry for the registered PLMN in the received \"CAG information
list\" does not include any CAG-ID and:
A) the UE does not have an emergency PDU session, then the UE shall enter the
state 5GMM-REGISTERED.PLMN-SEARCH and shall apply the PLMN selection process
defined in 3GPP TS 23.122 [5] with the updated \"CAG information list\"; or
B) the UE has an emergency PDU session, then the UE shall perform a local
release of all PDU sessions associated with 3GPP access except for the
emergency PDU session and enter the state 5GMM-REGISTERED.LIMITED-SERVICE; or
b) if the UE receives the REGISTRATION ACCEPT message via a non-CAG cell and
the entry for the registered PLMN in the received \"CAG information list\"
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and:
1) if the \"allowed CAG list\" for the registered PLMN in the received \"CAG
information list\" includes one or more CAG-IDs, the UE shall enter the state
5GMM-REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according
to 3GPP TS 38.304 [28] with the updated \"CAG information list\"; or
2) if the entry for the registered PLMN in the received \"CAG information
list\" does not include any CAG-ID and:
i) the UE does not have an emergency PDU session, then the UE shall enter the
state 5GMM-REGISTERED.PLMN-SEARCH and shall apply the PLMN selection process
defined in 3GPP TS 23.122 [5] with the updated \"CAG information list\"; or
ii) the UE has an emergency PDU session, then the UE shall perform a local
release of all PDU sessions associated with 3GPP access except for the
emergency PDU session and enter the state 5GMM-REGISTERED.LIMITED-SERVICE.
If the received \"CAG information list\" does not include an entry containing
the identity of the registered PLMN and the UE receives the REGISTRATION
ACCEPT message via a CAG cell, the UE shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to
3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C] with the updated \"CAG information
list\".
If the REGISTRATION ACCEPT message contains the Operator-defined access
category definitions IE, the Extended emergency number list IE, the CAG
information list IE or the Extended CAG information list IE, the UE shall
return a REGISTRATION COMPLETE message to the AMF to acknowledge reception of
the operator-defined access category definitions or the extended local
emergency numbers list or the CAG information list.
If the UE has set the RCMAP bit to \" Sending of REGISTRATION COMPLETE message
for negotiated PEIPS assistance information supported \" in the 5GMM
capability IE of the REGISTRATION REQUEST message and if REGISTRATION ACCEPT
message contains the Negotiated PEIPS assistance parameters IE, the UE shall
return a REGISTRATION COMPLETE message to the AMF to acknowledge reception of
the Negotiated PEIPS assistance parameters IE.
If the REGISTRATION ACCEPT message contains the UE radio capability ID IE or
the UE radio capability ID deletion indication IE, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge reception of the UE
radio capability ID IE or the UE radio capability ID deletion indication IE.
If the T3448 value IE is present in the received REGISTRATION ACCEPT message
and the value indicates that this timer is neither zero nor deactivated, the
UE shall:
a) stop timer T3448 if it is running; and
b) start timer T3448 with the value provided in the T3448 value IE.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the
T3448 value IE is present in the REGISTRATION ACCEPT message and the value
indicates that this timer is either zero or deactivated, the UE shall ignore
the T3448 value IE and proceed as if the T3448 value IE was not present.
If the UE in 5GMM-IDLE mode initiated the registration procedure for mobility
and periodic registration update and the REGISTRATION ACCEPT message does not
include the T3448 value IE and if timer T3448 is running, then the UE shall
stop timer T3448.
Upon receiving a REGISTRATION COMPLETE message, the AMF shall stop timer T3550
and change to state 5GMM-REGISTERED. The 5G-GUTI, if sent in the REGISTRATION
ACCEPT message, shall be considered as valid, the PEIPS assistance
information, if sent in the REGISTRATION ACCEPT message, shall be considered
as valid, and the UE radio capability ID, if sent in the REGISTRATION ACCEPT
message, shall be considered as valid.
If the 5GS update type IE was included in the REGISTRATION REQUEST message
with the SMS requested bit set to \"SMS over NAS supported\" and:
a) the SMSF address is stored in the UE 5GMM context and:
1) the UE is considered available for SMS over NAS; or
2) the UE is considered not available for SMS over NAS and the SMSF has
confirmed that the activation of the SMS service is successful; or
b) the SMSF address is not stored in the UE 5GMM context, the SMSF selection
is successful and the SMSF has confirmed that the activation of the SMS
service is successful;
then the AMF shall set the SMS allowed bit of the 5GS registration result IE
in the REGISTRATION ACCEPT message as specified in subclause 5.5.1.2.4. If the
UE 5GMM context does not contain an SMSF address or the UE is not considered
available for SMS over NAS, then the AMF shall:
a) store the SMSF address in the UE 5GMM context if not stored already; and
b) store the value of the SMS allowed bit of the 5GS registration result IE in
the UE 5GMM context and consider the UE available for SMS over NAS.
If SMSF selection in the AMF or SMS activation via the SMSF is not successful,
or the AMF does not allow the use of SMS over NAS, then the AMF shall set the
SMS allowed bit of the 5GS registration result IE to \"SMS over NAS not
allowed\" in the REGISTRATION ACCEPT message.
If the 5GS update type IE was included in the REGISTRATION REQUEST message
with the SMS requested bit set to \"SMS over NAS not supported\" or the 5GS
update type IE was not included in the REGISTRATION REQUEST message, then the
AMF shall:
a) mark the 5GMM context to indicate that the UE is not available for SMS over
NAS; and
NOTE 10: The AMF can notify the SMSF that the UE is deregistered from SMS over
NAS based on local configuration.
b) set the SMS allowed bit of the 5GS registration result IE to \"SMS over NAS
not allowed\" in the REGISTRATION ACCEPT message.
When the UE receives the REGISTRATION ACCEPT message, if the UE is also
registered over another access to the same PLMN, the UE considers the value
indicated by the SMS allowed bit of the 5GS registration result IE as
applicable for both accesses over which the UE is registered.
If the 5GS update type IE was included in the REGISTRATION REQUEST message
with the NG-RAN-RCU bit set to \"UE radio capability update needed\", the AMF
shall delete the stored UE radio capability information or the UE radio
capability ID, if any.
The AMF shall include the 5GS registration result IE in the REGISTRATION
ACCEPT message. If the 5GS registration result IE value indicates:
a) \"3GPP access\", the UE:
\- shall consider itself as being registered to 3GPP access only; and
\- if in 5GMM-REGISTERED state over non-3GPP access and on the same PLMN as
3GPP access, shall enter state 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION over
non-3GPP access and set the 5GS update status to 5U2 NOT UPDATED over non-3GPP
access;
b) \"Non-3GPP access\", the UE:
\- shall consider itself as being registered to non-3GPP access only; and
\- if in the 5GMM-REGISTERED state over 3GPP access and is on the same PLMN as
non-3GPP access, shall enter the state 5GMM-DEREGISTERED.ATTEMPTING-
REGISTRATION over 3GPP access and set the 5GS update status to 5U2 NOT UPDATED
over 3GPP access; or
c) \"3GPP access and Non-3GPP access\", the UE shall consider itself as being
registered to both 3GPP access and non-3GPP access.
If the UE is not currently registered for emergency services and the 5GS
registration result IE value in the REGISTRATION ACCEPT message is set to
\"Registered for emergency services\", the UE shall consider itself registered
for emergency services and shall locally release all non-emergency PDU
sessions, if any.
In roaming scenarios, the AMF shall provide mapped S-NSSAI(s) for the
configured NSSAI, the allowed NSSAI, the rejected NSSAI (if Extended rejected
NSSAI IE is used), the pending NSSAI or NSSRG information when included in the
REGISTRATION ACCEPT message.
The AMF shall include the allowed NSSAI for the current PLMN or SNPN and, in
roaming scenarios, shall include the mapped S-NSSAI(s) for the allowed NSSAI
contained in the requested NSSAI (i.e. Requested NSSAI IE or Requested mapped
NSSAI IE) from the UE, in the REGISTRATION ACCEPT message if the UE included
the requested NSSAI in the REGISTRATION REQUEST message and the AMF allows one
or more S-NSSAIs for the current PLMN or SNPN in the Requested NSSAI IE or one
or more mapped S-NSSAIs in the Requested NSSAI IE or Requested mapped NSSAI
IE. The S-NSSAI associated with each of the active PDN connections for which
interworking to 5GS is supported, shall be included in the allowed NSSAI if
the UE included the UE status IE with the EMM registration status set to \"UE
is in EMM-REGISTERED state\" in the REGISTRATION REQUEST message and the AMF
supports N26 interface.
The AMF may also include rejected NSSAI in the REGISTRATION ACCEPT message if
the UE is not registered for onboarding services in SNPN. If the UE has set
the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message, the rejected NSSAI shall be
included in the Extended rejected NSSAI IE in the REGISTRATION ACCEPT message;
otherwise the rejected NSSAI shall be included in the Rejected NSSAI IE in the
REGISTRATION ACCEPT message. If the UE is registered for onboarding services
in SNPN, the AMF shall not include rejected NSSAI in the REGISTRATION ACCEPT
message.
If the UE has set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message, the rejected NSSAI
contains S-NSSAI(s) which was included in the requested NSSAI but rejected by
the network associated with rejection cause(s); otherwise the rejected NSSAI
contains S-NSSAI(s) which was included in the requested NSSAI but rejected by
the network associated with rejection cause(s) with the following
restrictions:
a) rejected NSSAI for the current PLMN or SNPN shall not include an S-NSSAI
for the current PLMN or SNPN which is associated to multiple mapped S-NSSAIs
and some of these but not all mapped S-NSSAIs are not allowed; and
b) rejected NSSAI for the current registration area shall not include an
S-NSSAI for the current PLMN or SNPN which is associated to multiple mapped
S-NSSAIs and some of these but not all mapped S-NSSAIs are not allowed.
NOTE 11: The UE that does not support extended rejected NSSAI can avoid
requesting an S-NSSAI associated with a mapped S-NSSAI, which was included in
the previous requested NSSAI but neither in the allowed NSSAI nor in the
rejected NSSAI in the consequent registration procedures.
If the UE indicated the support for network slice-specific authentication and
authorization, and if the requested NSSAI (i.e. the Requested NSSAI IE or the
Requested mapped NSSAI IE) includes one or more S-NSSAIs subject to network
slice-specific authentication and authorization, the AMF shall in the
REGISTRATION ACCEPT message include:
a) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s), if
any:
i) which are not subject to network slice-specific authentication and
authorization and are allowed by the AMF; or
ii) for which the network slice-specific authentication and authorization has
been successfully performed;
b) optionally, the rejected NSSAI;
c) pending NSSAI containing one or more S-NSSAIs for which network slice-
specific authentication and authorization (except for re-NSSAA) will be
performed or is ongoing, and one or more S-NSSAIs from the pending NSSAI which
the AMF provided to the UE during the previous registration procedure for
which network slice-specific authentication and authorization will be
performed or is ongoing, if any; and
d) the \"NSSAA to be performed\" indicator in the 5GS registration result IE
set to indicate that the network slice-specific authentication and
authorization procedure will be performed by the network, if the allowed NSSAI
is not included in the REGISTRATION ACCEPT message.
If the UE is not registered for onboarding services in SNPN, the UE indicated
the support for network slice-specific authentication and authorization, and:
a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message or none of the S-NSSAIs in the requested NSSAI in the REGISTRATION
REQUEST message are allowed;
b) all default S-NSSAIs are subject to network slice-specific authentication
and authorization; and
c) the network slice-specific authentication and authorization procedure has
not been successfully performed for any of the default S-NSSAIs,
the AMF shall in the REGISTRATION ACCEPT message include:
a) the \"NSSAA to be performed\" indicator in the 5GS registration result IE
to indicate that the network slice-specific authentication and authorization
procedure will be performed by the network; and
b) pending NSSAI containing one or more default S-NSSAIs for which network
slice-specific authentication and authorization will be performed or is
ongoing and one or more S-NSSAIs from the pending NSSAI which the AMF provided
to the UE during the previous registration procedure for which network slice-
specific authentication and authorization will be performed or is ongoing (if
any); and
c) optionally, the rejected NSSAI.
If the UE is not registered for onboarding services in SNPN, the UE indicated
the support for network slice-specific authentication and authorization, and:
a) the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message or none of the S-NSSAIs in the requested NSSAI in the REGISTRATION
REQUEST message are allowed; and
b) one or more default S-NSSAIs are not subject to network slice-specific
authentication and authorization or the network slice-specific authentication
and authorization procedure has been successfully performed for one or more
default S-NSSAIs;
the AMF shall in the REGISTRATION ACCEPT message include:
a) pending NSSAI containing one or more default S-NSSAIs for which network
slice-specific authentication and authorization will be performed or is
ongoing (if any) and one or more S-NSSAIs from the pending NSSAI which the AMF
provided to the UE during the previous registration procedure for which
network slice-specific authentication and authorization will be performed or
is ongoing (if any);
b) allowed NSSAI containing S-NSSAI(s) for the current PLMN or SNPN each of
which corresponds to a default S-NSSAI which are not subject to network slice-
specific authentication and authorization or for which the network slice-
specific authentication and authorization has been successfully performed;
c) allowed NSSAI containing one or more default S-NSSAIs, as the mapped
S-NSSAI(s) for the allowed NSSAI in roaming scenarios, which are not subject
to network slice-specific authentication and authorization or for which the
network slice-specific authentication and authorization has been successfully
performed; and
d) optionally, the rejected NSSAI.
If the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message or none of the S-NSSAIs in the requested NSSAI in the REGISTRATION
REQUEST message are allowed, the allowed NSSAI shall not contain default
S-NSSAI(s) that are subject to NSAC. If the subscription information includes
the NSSRG information, the S-NSSAIs of the allowed NSSAI shall be associated
with at least one common NSSRG value.
When the REGISTRATION ACCEPT includes a pending NSSAI, the pending NSSAI shall
contain all S-NSSAIs for which network slice-specific authentication and
authorization (except for re-NSSAA) will be performed or is ongoing from the
requested NSSAI of the REGISTRATION REQUEST message that was received over the
3GPP access, non-3GPP access, or both the 3GPP access and non-3GPP access.
If the UE supports extended rejected NSSAI and the AMF determines that maximum
number of UEs reached for all S-NSSAIs in the requested NSSAI as specified in
subclause 4.6.2.5**, the AMF shall include the rejected NSSAI** containing one
or more S-NSSAIs with the rejection cause \"S-NSSAI not available due to
maximum number of UEs reached\" in the Extended rejected NSSAI IE **in the**
REGISTRATION ACCEPT message. In addition, the AMF may include a back-off timer
value for each S-NSSAI with the rejection cause \"S-NSSAI not available due to
maximum number of UEs reached\" included in the Extended rejected NSSAI IE of
the REGISTRATION ACCEPT message. To avoid that large numbers of UEs
simultaneously initiate deferred requests, the network should select the value
for the backoff timer for each S-NSSAI for the informed UEs so that timeouts
are not synchronised.
If the UE does not indicate support for extended rejected NSSAI and **the
maximum number of UEs has been reached, the AMF should include the rejected
NSSAI** containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available in the current registration area\" in the Rejected NSSAI IE and
**should not include these S-NSSAIs in the allowed NSSAI in the** REGISTRATION
ACCEPT message.
NOTE 12: Based on network policies, the AMF can include the S-NSSAI(s) for
which the maximum number of UEs has been reached in the rejected NSSAI with
rejection causes other than \"S-NSSAI not available in the current
registration area\".
The AMF may include a new configured NSSAI for the current PLMN or SNPN in the
REGISTRATION ACCEPT message if:
a) the REGISTRATION REQUEST message did not include a requested NSSAI and the
UE is not registered for onboarding services in SNPN;
b) the REGISTRATION REQUEST message included a requested NSSAI containing an
S-NSSAI that is not valid in the serving PLMN or SNPN;
c) the REGISTRATION REQUEST message included a requested NSSAI containing an
S-NSSAI with incorrect mapped S-NSSAI(s);
d) the REGISTRATION REQUEST message included the Network slicing indication IE
with the Default configured NSSAI indication bit set to \"Requested NSSAI
created from default configured NSSAI\";
e) the REGISTRATION REQUEST message included the requested mapped NSSAI;
f) the S-NSSAIs of the requested NSSAI in the REGISTRATION REQUEST message are
not associated with any common NSSRG value, except for the case that the AMF,
based on the indication received from the UDM as specified in 3GPP TS 23.501
[8], has provided all subscribed S-NSSAIs in the configured NSSAI to a UE who
does not support NSSRG; or
NOTE 13: If the S-NSSAIs of the requested NSSAI in the REGISTRATION REQUEST
message are not associated with any common NSSRG value, it is possible that at
least one of the S-NSSAIs is not included in any of new allowed NSSAI, new
(extended) rejected NSSAI (if applicable), and new pending NSSAI (if
applicable).
g) the S-NSSAIs of the requested NSSAI in the REGISTRATION REQUEST message
over the current access and the allowed NSSAI over the other access are not
associated with any common NSSRG value.
If a new configured NSSAI for the current PLMN or SNPN is included and the UE
is roaming, the AMF shall also include the mapped S-NSSAI(s) for the
configured NSSAI for the current PLMN or SNPN in the REGISTRATION ACCEPT
message. In this case the AMF shall start timer T3550 and enter state 5GMM-
COMMON-PROCEDURE-INITIATED as described in subclause 5.1.3.2.3.3.
If a new configured NSSAI for the current PLMN or SNPN is included, the
subscription information includes the NSSRG information, and the NSSRG bit in
the 5GMM capability IE of the REGISTRATION REQUEST message is set to:
a) \"NSSRG supported\", then the AMF shall include the NSSRG information in
the REGISTRATION ACCEPT message; or
b) \"NSSRG not supported\", then the configured NSSAI shall include S-NSSAIs
each of which is associated with all the NSSRG value(s) of the default
S-NSSAI(s), or the configured NSSAI shall include, based on the indication
received from the UDM as specified in 3GPP TS 23.501 [8], all subscribed
S-NSSAIs even if these S-NSSAIs do not share any common NSSRG value.
If the AMF needs to update the NSSRG information and the UE has set the NSSRG
bit to \"NSSRG supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message, then the AMF shall include the new NSSRG information in the
REGISTRATION ACCEPT message. In addition, the AMF shall start timer T3550 and
enter state 5GMM-COMMON-PROCEDURE-INITIATED as described in subclause
5.1.3.2.3.3.
The AMF shall include the Network slicing indication IE with the Network
slicing subscription change indication set to \"Network slicing subscription
changed\" in the REGISTRATION ACCEPT message if the UDM has indicated that the
subscription data for network slicing has changed. In this case the AMF shall
start timer T3550 and enter state 5GMM-COMMON-PROCEDURE-INITIATED as described
in subclause 5.1.3.2.3.3.
If the S-NSSAI(s) associated with the existing PDU session(s) of the UE is not
included in the requested NSSAI (i.e. Requested NSSAI IE or Requested mapped
NSSAI IE) of the REGISTRATION REQUEST message, the AMF shall perform a local
release of the PDU session(s) associated with the S-NSSAI(s) except for a PDU
session associated with DNN and S-NSSAI in the AMF onboarding configuration
data and shall request the SMF to perform a local release of those PDU
session(s).
The UE that has indicated the support for network slice-specific
authentication and authorization receiving the pending NSSAI in the
REGISTRATION ACCEPT message shall store the S-NSSAI(s) in the pending NSSAI as
specified in subclause 4.6.2.2. If the registration area contains TAIs
belonging to different PLMNs, which are equivalent PLMNs, the UE shall store
the received pending NSSAI for each of the equivalent PLMNs as specified in
subclause 4.6.2.2. If the pending NSSAI is not included in the REGISTRATION
ACCEPT message and the \"NSSAA to be performed\" indicator is not set to
\"Network slice-specific authentication and authorization is to be performed\"
in the 5GS registration result IE of the REGISTRATION ACCEPT message, then the
UE shall delete the pending NSSAI for the current PLMN or SNPN and its
equivalent PLMN(s), if existing, as specified in subclause 4.6.2.2.
The UE receiving the rejected NSSAI in the REGISTRATION ACCEPT message takes
the following actions based on the rejection cause in the rejected S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt to use
this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE, the
UICC containing the USIM is removed, the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
registration area as specified in subclause 4.6.2.2 and shall not attempt to
use this S-NSSAI(s) in the current registration area until switching off the
UE, the UE moving out of the current registration area, the UICC containing
the USIM is removed, the entry of the \"list of subscriber data\" with the
SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are
removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI in the current PLMN or SNPN over any access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed or deleted as described in
subclause 4.6.1 and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
Unless the back-off timer value received along with the S-NSSAI is zero, the
UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
NOTE 14: If the back-off timer value received along with the S-NSSAI in the
rejected NSSAI for the maximum number of UEs reached is zero as specified in
subclause 10.5.7.4a of TS 24.008, the UE does not consider the S-NSSAI as the
rejected S-NSSAI.
If there is one or more S-NSSAIs in the rejected NSSAI with the rejection
cause \"S-NSSAI not available due to maximum number of UEs reached\", then for
each S-NSSAI, the UE shall behave as follows:
a) stop the timer T3526 associated with the S-NSSAI, if running;
b) start the timer T3526 with:
1) the back-off timer value received along with the S-NSSAI, if a back-off
timer value is received along with the S-NSSAI that is neither zero nor
deactivated; or
2) an implementation specific back-off timer value, if no back-off timer value
is received along with the S-NSSAI; and
c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs
reached when the timer T3526 associated with the S-NSSAI expires.
If the UE sets the NSSAA bit in the 5GMM capability IE to \"Network slice-
specific authentication and authorization not supported\", and:
a) if the Requested NSSAI IE only includes the S-NSSAI(s) subject to network
slice-specific authentication and authorization and one or more default
S-NSSAIs (containing one or more S-NSSAIs each of which may be associated with
a new S-NSSAI) which are not subject to network slice-specific authentication
and authorization are available, the AMF shall in the REGISTRATION ACCEPT
message include:
1) the allowed NSSAI containing S-NSSAI(s) for the current PLMN or SNPN each
of which corresponds to a default S-NSSAI which are not subject to network
slice-specific authentication and authorization;
2) the allowed NSSAI containing the default S-NSSAIs, as the mapped S-NSSAI(s)
for the allowed NSSAI in roaming scenarios, which are not subject to network
slice-specific authentication and authorization; and
3) the rejected NSSAI containing the S-NSSAI(s) subject to network slice
specific authentication and authorization with the rejection cause indicating
\"S-NSSAI not available in the current PLMN or SNPN\", except if the UE has
not set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in the 5GMM
capability IE of the REGISTRATION REQUEST message and the S-NSSAI(s) is
associated to multiple mapped S-NSSAIs and some of these but not all mapped
S-NSSAIs are subject to NSSAA; or
b) if the Requested NSSAI IE includes one or more S-NSSAIs subject to network
slice-specific authentication and authorization, the AMF shall in the
REGISTRATION ACCEPT message include:
1) the allowed NSSAI containing the S-NSSAI(s) or the mapped S-NSSAI(s) which
are not subject to network slice-specific authentication and authorization;
and
2) the rejected NSSAI containing:
i) the S-NSSAI(s) subject to network slice specific authentication and
authorization with the rejection cause indicating \"S-NSSAI not available in
the current PLMN or SNPN\", except if the UE has not set the ER-NSSAI bit to
\"Extended rejected NSSAI supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message and the S-NSSAI(s) is associated to multiple
mapped S-NSSAIs and some of these but not all mapped S-NSSAIs are subject to
NSSAA; and
ii) the S-NSSAI(s) which was included in the requested NSSAI but rejected by
the network associated with the rejection cause indicating \"S-NSSAI not
available in the current PLMN or SNPN\" or the rejection cause indicating
\"S-NSSAI not available in the current registration area\", if any.
For a REGISTRATION REQUEST message with a 5GS registration type IE indicating
\"mobility registration updating\", if the UE does not indicate support for
network slice-specific authentication and authorization, the UE is not
registered for onboarding services in SNPN, and:
a) the UE is not in NB-N1 mode; and
b) if:
1) the UE did not include the requested NSSAI in the REGISTRATION REQUEST
message; or
2) none of the S-NSSAIs in the requested NSSAI in the REGISTRATION REQUEST
message are allowed;
and one or more default S-NSSAIs which are not subject to network slice-
specific authentication and authorization are available, the AMF shall:
a) put the allowed S-NSSAI(s) for the current PLMN or SNPN each of which
corresponds to a default S-NSSAI and not subject to network slice-specific
authentication and authorization in the allowed NSSAI of the REGISTRATION
ACCEPT message;
b) put the default S-NSSAIs and not subject to network slice-specific
authentication and authorization, as the mapped S-NSSAI(s) for the allowed
NSSAI in roaming scenarios, in the allowed NSSAI of the REGISTRATION ACCEPT
message; and
c) determine a registration area such that all S-NSSAIs of the allowed NSSAI
are available in the registration area.
During a registration procedure for mobility and periodic registration update
for which the 5GS registration type IE indicates:
a) \"periodic registration updating\"; or
b) \"mobility registration updating\" and the UE is in NB-N1 mode;
and the UE is not registered for onboarding services in SNPN, the AMF:
a) may provide a new allowed NSSAI to the UE;
b) shall provide a pending NSSAI to the UE if the UE has indicated the support
for network slice-specific authentication and authorization and there are
S-NSSAIs for which network slice-specific authentication and authorization
(except for re-NSSAA) will be performed or is ongoing for the current PLMN or
SNPN; or
c) may provide both a new allowed NSSAI and a pending NSSAI to the UE;
in the REGISTRATION ACCEPT message. Additionally, if a pending NSSAI is
provided without an allowed NSSAI and no S-NSSAI is currently allowed for the
UE, the REGISTRATION ACCEPT message shall include the 5GS registration result
IE with the \"NSSAA to be performed\" indicator set to \"Network slice-
specific authentication and authorization is to be performed\".
If the REGISTRATION ACCEPT message contains the Network slicing indication IE
with the Network slicing subscription change indication set to \"Network
slicing subscription changed\", the UE shall delete the network slicing
information for each and every PLMN except for the current PLMN as specified
in subclause 4.6.2.2.
If the REGISTRATION ACCEPT message contains the allowed NSSAI, then the UE
shall store the included allowed NSSAI together with the PLMN identity of the
registered PLMN or the SNPN identity of the registered SNPN and the
registration area as specified in subclause 4.6.2.2. If the registration area
contains TAIs belonging to different PLMNs, which are equivalent PLMNs, the UE
shall store the received allowed NSSAI in each of allowed NSSAIs which are
associated with each of the PLMNs.
For each of the PDU session(s) active in the UE:
\- if the allowed NSSAI contains an HPLMN S-NSSAI (e.g. mapped S-NSSAI, in
roaming scenarios) matching to the HPLMN S-NSSAI of the PDU session, the UE
shall locally update the S-NSSAI associated with the PDU session to the
corresponding S-NSSAI received in the allowed NSSAI; and
\- if the allowed NSSAI does not contain an HPLMN S-NSSAI (e.g. mapped
S-NSSAI, in roaming scenarios) matching to the HPLMN S-NSSAI of the PDU
session, the UE may perform a local release of the PDU session except for an
emergency PDU session, if any, and except for a PDU session established when
the UE is registered for onboarding services in SNPN, if any.
NOTE 15: According to 3GPP TS 23.501 [8], also the AMF will determine which
PDU sessions can no longer be supported based on the new allowed NSSAI, and it
will cause a release on the UE side either by indicating in the PDU session
status IE which PDU sessions are inactive on the network side or by triggering
the SMF to initiate a release via 5GSM signalling.
If the REGISTRATION ACCEPT message contains a configured NSSAI IE with a new
configured NSSAI for the current PLMN or SNPN and optionally the mapped
S-NSSAI(s) for the configured NSSAI for the current PLMN or SNPN, the UE shall
store the contents of the configured NSSAI IE as specified in subclause
4.6.2.2. In addition, if the REGISTRATION ACCEPT message contains an NSSRG
information IE, the UE shall store the contents of the NSSRG information IE as
specified in subclause 4.6.2.2.
If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message over 3GPP access, the AMF may include the
NSAG information IE in the REGISTRATION ACCEPT message. Up to 4 NSAG entries
are allowed to be associated with a TAI list in the NSAG information IE. If
the UE has set the RCMAN bit to \"Sending of REGISTRATION COMPLETE message for
NSAG information supported\" in the 5GMM capability IE of the REGISTRATION
REQUEST message and if the NSAG information IE is included in the REGISTRATION
ACCEPT message, the AMF shall start timer T3550 and enter state 5GMM-COMMON-
PROCEDURE-INITIATED as described in subclause 5.1.3.2.3.3.
NOTE 15a: How the AMF selects NSAG entries to be included in the NSAG
information IE is implementation specific, e.g. take the NSAG priority and the
current registration area into account.
NOTE 15b: If the NSAG for the PLMN and its equivalent PLMN(s) have different
associations with S-NSSAIs, then the AMF includes a TAI list for the NSAG
entry in the NSAG information IE.
If the UE receives the NSAG information IE in the REGISTRATION ACCEPT message,
the UE shall store the NSAG information as specified in subclause 4.6.2.2.
If the REGISTRATION ACCEPT message:
a) includes the 5GS registration result IE with the \"NSSAA to be performed\"
indicator set to \"Network slice-specific authentication and authorization is
to be performed\";
b) includes a pending NSSAI; and
c) does not include an allowed NSSAI;
the UE:
a) shall not perform the registration procedure for mobility and registration
update with the Uplink data status IE except for emergency services;
b) shall not initiate a service request procedure except for emergency
services, for responding to paging or notification over non-3GPP access, for
cases f), i), m) and o) in subclause 5.6.1.1;
c) shall not initiate a 5GSM procedure except for emergency services,
indicating a change of 3GPP PS data off UE status, or to request the release
of a PDU session; and
d) shall not initiate the NAS transport procedure except for sending a CIoT
user data container, SMS, an LPP message, a location services message, an SOR
transparent container, a UE policy container or a UE parameters update
transparent container;
until the UE receives an allowed NSSAI.
During a registration procedure for mobility and periodic registration update
for which the 5GS registration type IE indicates:
a) \"mobility registration updating\" and the UE is in NB-N1 mode; or
b) \"periodic registration updating\";
if the REGISTRATION ACCEPT message includes the 5GS registration result IE
with the \"NSSAA to be performed\" indicator not set to \"Network slice-
specific authentication and authorization is to be performed\" and the message
does not contain an allowed NSSAI and no new allowed NSSAI, the UE shall
consider the previously received allowed NSSAI as valid.
During a registration procedure for mobility and periodic registration update
for which the 5GS registration type IE indicates:
a) \"mobility registration updating\"; or
b) \"periodic registration updating\";
if the REGISTRATION ACCEPT message includes the 5GS registration result IE
with the \"NSSAA to be performed\" indicator set to \"Network slice-specific
authentication and authorization is to be performed\" and the message contains
a pending NSSAI, the UE shall delete any stored allowed NSSAI as specified in
subclause 4.6.2.2.
If the Uplink data status IE is included in the REGISTRATION REQUEST message:
a) if the AMF determines that the UE is in non-allowed area or is not in
allowed area, and the PDU session(s) indicated by the Uplink data status IE is
non-emergency PDU session(s) or the UE is not configured for high priority
access in selected PLMN, the AMF shall include the PDU session reactivation
result IE in the REGISTRATION ACCEPT message indicating that user-plane
resources for the corresponding PDU session(s) cannot be re-established, and
shall include the PDU session reactivation result error cause IE with the 5GMM
cause set to #28 \"Restricted service area\";
b) otherwise, the AMF shall:
1) indicate the SMF to re-establish the user-plane resources for the
corresponding PDU session;
2) include PDU session reactivation result IE in the REGISTRATION ACCEPT
message to indicate the user-plane resources re-establishment result of the
PDU sessions for which the UE requested to re-establish the user-plane
resources; and
3) determine the UE presence in LADN service area and forward the UE presence
in LADN service area towards the SMF, if the corresponding PDU session is a
PDU session for LADN.
If the Uplink data status IE is not included in the REGISTRATION REQUEST
message and the REGISTRATION REQUEST message is sent for the trigger d) in
subclause 5.5.1.3.2, the AMF may indicate the SMF to re-establish the user-
plane resources for the PDU sessions.
If a PDU session status IE is included in the REGISTRATION REQUEST message:
a) for single access PDU sessions, the AMF shall:
1) perform a local release of all those PDU sessions which are not in 5GSM
state PDU SESSION INACTIVE on the AMF side associated with the access type the
REGISTRATION REQUEST message is sent over, but are indicated by the UE as
being in 5GSM state PDU SESSION INACTIVE. If any of those PDU sessions is
associated with one or more multicast MBS sessions, the SMF shall consider the
UE as removed from the associated multicast MBS sessions; and
2) include a PDU session status IE in the REGISTRATION ACCEPT message to
indicate which PDU sessions associated with the access type the REGISTRATION
ACCEPT message is sent over are not in 5GSM state PDU SESSION INACTIVE in the
AMF; and
b) for MA PDU sessions:
1) for all those PDU sessions which are not in 5GSM state PDU SESSION INACTIVE
and have user plane resources established on the access the REGISTRATION
REQUEST message is sent over on the AMF side, but are indicated by the UE as
no user plane resources established:
i) for PDU sessions having user plane resources established only on the access
the REGISTRATION REQUEST message is sent over, the AMF shall perform a local
release of all those PDU sessions. If the MA PDU session is associated with
one or more multicast MBS sessions, the SMF shall consider the UE as removed
from the associated multicast MBS sessions; and
ii) for PDU sessions having user plane resources established on both accesses,
the AMF shall perform a local release on the user plane resources associated
with the access type the REGISTRATION REQUEST message is sent over. If the
REGISTRATION REQUEST message is sent over 3GPP access and the MA PDU session
is associated with one or more multicast MBS sessions, the SMF shall consider
the UE as removed from the associated multicast MBS sessions; and
2) the AMF shall include a PDU session status IE in the REGISTRATION ACCEPT
message to indicate which MA PDU sessions having user plane resources
established on the AMF side on the access the REGISTRATION ACCEPT message is
sent over.
If the Allowed PDU session status IE is included in the REGISTRATION REQUEST
message, the AMF shall:
a) for a 5GSM message from each SMF that has indicated pending downlink
signalling only, forward the received 5GSM message via 3GPP access to the UE
after the REGISTRATION ACCEPT message is sent;
b) for each SMF that has indicated pending downlink data only:
1) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access cannot be
performed if the corresponding PDU session ID(s) are not indicated in the
Allowed PDU session status IE; and
2) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access can be performed
if the corresponding PDU session ID(s) are indicated in the Allowed PDU
session status IE.
c) for each SMF that have indicated pending downlink signalling and data:
1) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access cannot be
performed if the corresponding PDU session ID(s) are not indicated in the
Allowed PDU session status IE;
2) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access can be performed
if the corresponding PDU session ID(s) are indicated in the Allowed PDU
session status IE; and
3) discard the received 5GSM message for PDU session(s) associated with
non-3GPP access; and
d) include the PDU session reactivation result IE in the REGISTRATION ACCEPT
message to indicate the successfully re-established user-plane resources for
the corresponding PDU sessions, if any.
If the PDU session reactivation result IE is included in the REGISTRATION
ACCEPT message indicating that the user-plane resources have been successfully
reactivated for a PDU session that was requested by the UE in the Allowed PDU
session status IE, the UE considers the corresponding PDU session to be
associated with the 3GPP access. If the user-plane resources of a PDU session
have been successfully reactivated over the 3GPP access, the AMF and SMF
update the associated access type of the corresponding PDU session.
If the PDU session reactivation result IE is included in the REGISTRATION
ACCEPT message indicating that the user-plane resources cannot be established
for a PDU session that was requested by the UE in the Allowed PDU session
status IE, the UE considers the corresponding PDU session to be associated
with the non-3GPP access.
If an EPS bearer context status IE is included in the REGISTRATION REQUEST
message, the AMF handles the received EPS bearer context status IE as
specified in 3GPP TS 23.502 [9].
If the EPS bearer context status information is generated for the UE during
the inter-system change from S1 mode to N1 mode as specified in 3GPP TS 23.502
[9] and the AMF supports N26 interface, the AMF shall include an EPS bearer
context status IE in the REGISTRATION ACCEPT message to indicate the UE which
mapped EPS bearer contexts are active in the network.
If the user-plane resources cannot be established for a PDU session, the AMF
shall include the PDU session reactivation result IE in the REGISTRATION
ACCEPT message indicating that user-plane resources for the corresponding PDU
session cannot be re-established, and:
a) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the UE is located out of the LADN service area (see 3GPP TS
29.502 [20A]), the AMF shall include the PDU session reactivation result error
cause IE with the 5GMM cause set to #43 \"LADN not available\";
b) if the user-plane resources cannot be established because the SMF indicated
to the AMF that only prioritized services are allowed (see 3GPP TS 29.502
[20A]), the AMF shall include the PDU session reactivation result error cause
IE with the 5GMM cause set to #28 \"restricted service area\";
c) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the resource is not available in the UPF (see 3GPP TS 29.502
[20A]), the AMF shall include the PDU session reactivation result error cause
IE with the 5GMM cause set to #92 \"insufficient user-plane resources for the
PDU session\";
d) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the S-NSSAI associated with the PDU session is unavailable due
to NSAC (see 3GPP TS 29.502 [20A]), the AMF shall include the PDU session
reactivation result error cause IE with the 5GMM cause set to #69
\"insufficient resources for specific slice\"; or
e) otherwise, the AMF may include the PDU session reactivation result error
cause IE to indicate the cause of failure to re-establish the user-plane
resources.
NOTE 16: It is up to UE implementation when to re-send a request for user-
plane re-establishment for the associated PDU session after receiving a PDU
session reactivation result error cause IE with a 5GMM cause set to #92
\"insufficient user-plane resources for the PDU session\".
NOTE 17: The UE can locally start a back-off timer after receiving a PDU
session reactivation result error cause IE with a 5GMM cause set to #69
\"insufficient resources for specific slice\". The value of the back-off timer
is up to UE implementation. Upon expiry of the back-off timer, the UE can re-
send a request for user-plane re-establishment for the associated PDU session.
If the AMF needs to initiate PDU session status synchronization the AMF shall
include a PDU session status IE in the REGISTRATION ACCEPT message to indicate
the UE:
\- which single access PDU sessions associated with the access the
REGISTRATION ACCEPT message is sent over are not in 5GSM state PDU SESSION
INACTIVE in the AMF; and
\- which MA PDU sessions are not in 5GSM state PDU SESSION INACTIVE and having
user plane resources established in the AMF on the access the REGISTRATION
ACCEPT message is sent over.
The AMF may include the LADN information IE in the REGISTRATION ACCEPT message
as described in subclause 5.5.1.2.4. The UE, upon receiving the REGISTRATION
ACCEPT message with the LADN information IE, shall delete its old LADN
information (if any) and store the received new LADN information.
If the AMF does not include the LADN information IE in the REGISTRATION ACCEPT
message during registration procedure for mobility and registration update,
the UE shall delete its old LADN information.
If the PDU session status IE is included in the REGISTRATION ACCEPT message:
a) for single access PDU sessions, the UE shall perform a local release of all
those PDU sessions associated with the access type the REGISTRATION ACCEPT
message is sent over which are not in 5GSM state PDU SESSION INACTIVE or PDU
SESSION ACTIVE PENDING on the UE side, but are indicated by the AMF as being
in 5GSM state PDU SESSION INACTIVE. If a locally released PDU session is
associated with one or more multicast MBS sessions, the UE shall locally leave
the associated multicast MBS sessions; and
b) for MA PDU sessions, for all those PDU sessions which are not in 5GSM state
PDU SESSION INACTIVE or PDU SESSION ACTIVE PENDING and have user plane
resources established in the UE on the access the REGISTRATION ACCEPT message
is sent over, but are indicated by the AMF as no user plane resources
established:
1) for MA PDU sessions having user plane resources established only on the
access the REGISTRATION ACCEPT message is sent over, the UE shall perform a
local release of those MA PDU sessions. If a locally released MA PDU session
is associated with one or more multicast MBS sessions, the UE shall locally
leave the associated multicast MBS sessions; and
2) for MA PDU sessions having user plane resources established on both
accesses, the UE shall perform a local release on the user plane resources on
the access the REGISTRATION ACCEPT message is sent over. If the user plane
resources over 3GPP access are released and the MA PDU session is associated
with one or more multicast MBS sessions, the UE shall locally leave the
associated multicast MBS sessions.
If:
a) the UE included a PDU session status IE in the REGISTRATION REQUEST
message;
b) the UE is operating in the single-registration mode;
c) the UE is performing inter-system change from S1 mode to N1 mode in 5GMM-
IDLE mode; and
d) the UE has received the IWK N26 bit set to \"interworking without N26
interface supported\";
the UE shall ignore the PDU session status IE if received in the REGISTRATION
ACCEPT message.
If the EPS bearer context status IE is included in the REGISTRATION ACCEPT
message, the UE shall locally delete all those QoS flow descriptions and all
associated QoS rules, if any, which are associated with inactive EPS bearer
contexts as indicated by the AMF in the EPS bearer context status IE.
If the UE included S1 mode supported indication in the REGISTRATION REQUEST
message, the AMF supporting inter-system change with EPS shall set the IWK N26
bit to either:
a) \"interworking without N26 interface not supported\" if the AMF supports
N26 interface; or
b) \"interworking without N26 interface supported\" if the AMF does not
support N26 interface
in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
The UE supporting S1 mode shall operate in the mode for inter-system
interworking with EPS as follows:
a) if the IWK N26 bit in the 5GS network feature support IE is set to
\"interworking without N26 interface not supported\", the UE shall operate in
single-registration mode;
b) if the IWK N26 bit in the 5GS network feature support IE is set to
\"interworking without N26 interface supported\" and the UE supports dual-
registration mode, the UE may operate in dual-registration mode; or
NOTE 18: The registration mode used by the UE is implementation dependent.
c) if the IWK N26 bit in the 5GS network feature support IE is set to
\"interworking without N26 interface supported\" and the UE only supports
single-registration mode, the UE shall operate in single-registration mode.
The UE shall treat the received interworking without N26 interface indicator
for inter-system change with EPS as valid in the entire PLMN and its
equivalent PLMN(s).
The network informs the UE about the support of specific features, such as IMS
voice over PS session, location services (5G-LCS), emergency services,
emergency services fallback and ATSSS, in the 5GS network feature support
information element. In a UE with IMS voice over PS session capability, the
IMS voice over PS session indicator, Emergency services support indicator and
Emergency services fallback indicator shall be provided to the upper layers.
The upper layers take the IMS voice over PS session indicator into account
when selecting the access domain for voice sessions or calls. When initiating
an emergency call, the upper layers take the IMS voice over PS session
indicator, Emergency services support indicator and Emergency services
fallback indicator into account for the access domain selection. When the UE
determines via the IMS voice over PS session indicator that the network does
not support IMS voice over PS sessions in N1 mode, then the UE shall not
perform a local release of any persistent PDU session if the AMF does not
indicate that the PDU session is in 5GSM state PDU SESSION INACTIVE via the
PDU session status IE. When the UE determines via the Emergency services
support indicator that the network does not support emergency services in N1
mode, then the UE shall not perform a local release of any emergency PDU
session if user-plane resources associated with that emergency PDU session are
established if the AMF does not indicate that the PDU session is in 5GSM state
PDU SESSION INACTIVE via the PDU session status IE. In a UE with LCS
capability, location services indicators (5G-LCS) shall be provided to the
upper layers. In a UE with the capability for ATSSS, the network support for
ATSSS shall be provided to the upper layers. If the UE receives the 5GS
network feature support IE with the ATSSS support indicator set to \"ATSSS not
supported\", the UE shall perform a local release of the MA PDU session, if
any. If a locally released MA PDU session is associated with one or more
multicast MBS sessions, the UE shall locally leave the associated multicast
MBS sessions.
The AMF shall set the EMF bit in the 5GS network feature support IE to:
a) \"Emergency services fallback supported in NR connected to 5GCN and E-UTRA
connected to 5GCN\" if the network supports the emergency services fallback
procedure when the UE is in an NR cell connected to 5GCN or an E-UTRA cell
connected to 5GCN;
b) \"Emergency services fallback supported in NR connected to 5GCN only\" if
the network supports the emergency services fallback procedure when the UE is
in an NR cell connected to 5GCN and does not support the emergency services
fallback procedure when the UE is in an E-UTRA cell connected to 5GCN;
c) \"Emergency services fallback supported in E-UTRA connected to 5GCN only\"
if the network supports the emergency services fallback procedure when the UE
is in an E-UTRA cell connected to 5GCN and does not support the emergency
services fallback procedure when the UE is in an NR cell connected to 5GCN; or
d) \"Emergency services fallback not supported\" if network does not support
the emergency services fallback procedure when the UE is in any cell connected
to 5GCN.
NOTE 19: If the emergency services are supported in neither the EPS nor the
5GS homogeneously, based on operator policy, the AMF will set the EMF bit in
the 5GS network feature support IE to \"Emergency services fallback not
supported\".
NOTE 20: Even though the AMF\'s support of emergency services fallback is
indicated per RAT, the UE\'s support of emergency services fallback is not per
RAT, i.e. the UE\'s support of emergency services fallback is the same for
both NR connected to 5GCN and E-UTRA connected to 5GCN.
If the UE is not operating in SNPN access operation mode:
a) the network informs the UE that the use of access identity 1 is valid in
the RPLMN or equivalent PLMN by setting the MPS indicator bit of the 5GS
network feature support IE to \"Access identity 1 valid\", in the REGISTRATION
ACCEPT message. Based on operator policy, the AMF sets the MPS indicator bit
in the REGISTRATION ACCEPT message based on the MPS priority information in
the user\'s subscription context obtained from the UDM;
b) upon receiving a REGISTRATION ACCEPT message with the MPS indicator bit set
to \"Access identity 1 valid\", the UE shall act as a UE with access identity
1 configured for MPS as described in subclause 4.5.2, in all NG-RAN of the
registered PLMN and its equivalent PLMNs. The MPS indicator bit in the 5GS
network feature support IE provided in the REGISTRATION ACCEPT message is
valid until the UE receives a REGISTRATION ACCEPT message with the MPS
indicator bit set to \"Access identity 1 not valid\" or until the UE selects a
non-equivalent PLMN. Access identity 1 is only applicable while the UE is in
N1 mode;
c) during ongoing active PDU sessions that were set up relying on the MPS
indicator bit being set to \"Access identity 1 valid\", if the network
indicates in a registration update that the MPS indicator bit is reset to
\"Access identity 1 not valid\", then the UE shall no longer act as a UE with
access identity 1 configured for MPS as described in subclause 4.5.2 unless
the USIM contains a valid configuration for access identity 1 in RPLMN or
equivalent PLMN. In the UE, the ongoing active PDU sessions are not affected
by the change of the MPS indicator bit;
d) the network informs the UE that the use of access identity 2 is valid in
the RPLMN or equivalent PLMN by setting the MCS indicator bit of the 5GS
network feature support IE to \"Access identity 2 valid\", in the REGISTRATION
ACCEPT message. Based on operator policy, the AMF sets the MCS indicator bit
in the REGISTRATION ACCEPT message based on the MCS priority information in
the user\'s subscription context obtained from the UDM;
e) upon receiving a REGISTRATION ACCEPT message with the MCS indicator bit set
to \"Access identity 2 valid\", the UE shall act as a UE with access identity
2 configured for MCS as described in subclause 4.5.2, in all NG-RAN of the
registered PLMN and its equivalent PLMNs. The MCS indicator bit in the 5GS
network feature support IE provided in the REGISTRATION ACCEPT message is
valid until the UE receives a REGISTRATION ACCEPT message with the MCS
indicator bit set to \"Access identity 2 not valid\" or until the UE selects a
non-equivalent PLMN. Access identity 2 is only applicable while the UE is in
N1 mode; and
f) during ongoing active PDU sessions that were set up relying on the MCS
indicator bit being set to \"Access identity 2 valid\", if the network
indicates in a registration update that the MCS indicator bit is reset to
\"Access identity 2 not valid\", then the UE shall no longer act as a UE with
access identity 2 configured for MCS as described in subclause 4.5.2 unless
the USIM contains a valid configuration for access identity 2 in RPLMN or
equivalent PLMN. In the UE, the ongoing active PDU sessions are not affected
by the change of the MCS indicator bit.
If the UE indicates support for restriction on use of enhanced coverage in the
REGISTRATION REQUEST message and:
a) in WB-N1 mode, the AMF decides to restrict the use of CE mode B for the UE,
then the AMF shall set the RestrictEC bit to \"CE mode B is restricted\";
b) in WB-N1 mode, the AMF decides to restrict the use of both CE mode A and CE
mode B for the UE, then the AMF shall set the RestrictEC bit to \" Both CE
mode A and CE mode B are restricted\"; or
c) in NB-N1 mode, the AMF decides to restrict the use of enhanced coverage for
the UE, then the AMF shall set the RestrictEC bit to \"Use of enhanced
coverage is restricted\",
in the 5GS network feature support IE in the REGISTRATION ACCEPT message.
If the UE is operating in SNPN access operation mode:
a) the network informs the UE that the use of access identity 1 is valid in
the RSNPN by setting the MPS indicator bit of the 5GS network feature support
IE to \"Access identity 1 valid\", in the REGISTRATION ACCEPT message. Based
on operator policy, the AMF sets the MPS indicator bit in the REGISTRATION
ACCEPT message based on the MPS priority information in the user\'s
subscription context obtained from the UDM;
b) upon receiving a REGISTRATION ACCEPT message with the MPS indicator bit set
to \"Access identity 1 valid\", the UE shall act as a UE with access identity
1 configured for MPS as described in subclause 4.5.2A, in all NG-RAN of the
registered SNPN. The MPS indicator bit in the 5GS network feature support IE
provided in the REGISTRATION ACCEPT message is valid until the UE receives a
REGISTRATION ACCEPT message with the MPS indicator bit set to \"Access
identity 1 not valid\" or until the UE selects another SNPN. Access identity 1
is only applicable while the UE is in N1 mode;
c) during ongoing active PDU sessions that were set up relying on the MPS
indicator bit being set to \"Access identity 1 valid\", if the network
indicates in a registration update that the MPS indicator bit is reset to
\"Access identity 1 not valid\", then the UE shall no longer act as a UE with
access identity 1 configured for MPS as described in subclause 4.5.2A unless
the unified access control configuration in the \"list of subscriber data\"
stored in the ME (see 3GPP TS 23.122 [5]) indicates the UE is configured for
access identity 1 in the RSNPN. In the UE, the ongoing active PDU sessions are
not affected by the change of the MPS indicator bit;
d) the network informs the UE that the use of access identity 2 is valid in
the RSNPN by setting the MCS indicator bit of the 5GS network feature support
IE to \"Access identity 2 valid\", in the REGISTRATION ACCEPT message. Based
on operator policy, the AMF sets the MCS indicator bit in the REGISTRATION
ACCEPT message based on the MCS priority information in the user\'s
subscription context obtained from the UDM;
e) upon receiving a REGISTRATION ACCEPT message with the MCS indicator bit set
to \"Access identity 2 valid\", the UE shall act as a UE with access identity
2 configured for MCS as described in subclause 4.5.2A, in all NG-RAN of the
registered SNPN. The MCS indicator bit in the 5GS network feature support IE
provided in the REGISTRATION ACCEPT message is valid until the UE receives a
REGISTRATION ACCEPT message with the MCS indicator bit set to \"Access
identity 2 not valid\" or until the UE selects another SNPN. Access identity 2
is only applicable while the UE is in N1 mode; and
f) during ongoing active PDU sessions that were set up relying on the MCS
indicator bit being set to \"Access identity 2 valid\", if the network
indicates in a registration update that the MCS indicator bit is reset to
\"Access identity 2 not valid\", then the UE shall no longer act as a UE with
access identity 2 configured for MCS as described in subclause 4.5.2A unless
the unified access control configuration in the \"list of subscriber data\"
stored in the ME (see 3GPP TS 23.122 [5]) indicates the UE is configured for
access identity 2 in the RSNPN. In the UE, the ongoing active PDU sessions are
not affected by the change of the MCS indicator bit.
If the UE has set the Follow-on request indicator to \"Follow-on request
pending\" in the REGISTRATION REQUEST message, or the network has downlink
signalling pending, the AMF shall not immediately release the NAS signalling
connection after the completion of the registration procedure.
If the UE is authorized to use V2X communication over PC5 reference point
based on:
a) at least one of the following bits in the 5GMM capability IE of the
REGISTRATION REQUEST message set by the UE, or already stored in the 5GMM
context in the AMF during the previous registration procedure as follows:
1) the V2XCEPC5 bit to \"V2X communication over E-UTRA-PC5 supported\"; or
2) the V2XCNPC5 bit to \"V2X communication over NR-PC5 supported\"; and
b) the user\'s subscription context obtained from the UDM as defined in 3GPP
TS 23.287 [6C];
the AMF should not immediately release the NAS signalling connection after the
completion of the registration procedure.
If the UE is authorized to use 5G ProSe services based on:
a) at least one of the following bits in the 5GMM capability IE of the
REGISTRATION REQUEST message set by the UE, or already stored in the 5GMM
context in the AMF during the previous registration procedure as follows:
1) the 5G ProSe direct discovery bit to \"5G ProSe direct discovery
supported\"; or
2) the 5G ProSe direct communication bit to \"5G ProSe direct communication
supported\"; and
b) the user\'s subscription context obtained from the UDM as defined in 3GPP
TS 23.304 [6E];
the AMF should not immediately release the NAS signalling connection after the
completion of the registration procedure.
If the Requested DRX parameters IE was included in the REGISTRATION REQUEST
message, the AMF shall include the Negotiated DRX parameters IE in the
REGISTRATION ACCEPT message. The AMF may set the Negotiated DRX parameters IE
based on the received Requested DRX parameters IE and operator policy if
available.
If the Requested NB-N1 mode DRX parameters IE was included in the REGISTRATION
REQUEST message, the AMF shall include the Negotiated NB-N1 mode DRX
parameters IE in the REGISTRATION ACCEPT message. The AMF may set the
Negotiated NB-N1 mode DRX parameters IE based on the received Requested NB-N1
mode DRX parameters IE and operator policy if available.
The AMF shall include the Negotiated extended DRX parameters IE in the
REGISTRATION ACCEPT message only if the Requested extended DRX parameters IE
was included in the REGISTRATION REQUEST message, and the AMF supports and
accepts the use of eDRX. The AMF may set the Negotiated extended DRX
parameters IE based on the received Requested extended DRX parameters IE,
operator policy, information from NG-RAN and the user\'s subscription context
obtained from the UDM if available.
If the UE included in the REGISTRATION REQUEST message the UE status IE with
the EMM registration status set to \"UE is in EMM-REGISTERED state\" and the
AMF does not support N26 interface, the AMF shall operate as described in
subclause 5.5.1.2.4.
If the UE has indicated support for service gap control in the REGISTRATION
REQUEST message, a service gap time value is available in the 5GMM context,
the AMF may include the T3447 value IE set to the service gap time value in
the REGISTRATION ACCEPT message.
If the UE requests ciphering keys for ciphered broadcast assistance data in
the REGISTRATION REQUEST message and the AMF has valid ciphering key data
applicable to the UE\'s subscription and current tracking area, then the AMF
shall include the ciphering key data in the Ciphering key data IE of the
REGISTRATION ACCEPT message.
If the UE supports WUS assistance information and the AMF supports and accepts
the use of WUS assistance information for the UE, then the AMF shall determine
the negotiated UE paging probability information for the UE, store it in the
5GMM context of the UE, and if the UE does not have an active emergency PDU
session, the AMF shall include it in the Negotiated WUS assistance information
IE in the REGISTRATION ACCEPT message. The AMF may consider the UE paging
probability information received in the Requested WUS assistance information
IE when determining the negotiated UE paging probability information for the
UE.
NOTE 21: Besides the UE paging probability information requested by the UE,
the AMF can take local configuration or previous statistical information for
the UE into account when determining the negotiated UE paging probability
information for the UE.
If the UE sets the NR-PSSI bit to \"NR paging subgrouping supported\" in the
5GMM capability IE in the REGISTRATION REQUEST message and the AMF supports
and accepts the use of PEIPS assistance information for the UE, then the AMF
shall determine the Paging subgroup ID for the UE, store it in the 5GMM
context of the UE, and include it in the Negotiated PEIPS assistance
information IE in the REGISTRATION ACCEPT message or in the Updated PEIPS
assistance information IE in the CONFIGURATION UPDATE COMMAND message as part
of the registration procedure. The AMF may consider the UE paging probability
information received in the Requested PEIPS assistance information IE when
determining the Paging subgroup ID for the UE.
NOTE 22: Besides the UE paging probability information when provided by the
UE, the AMF can also take local configuration, whether the UE is likely to
receive IMS voice over PS session calls, UE mobility pattern or previous
statistical information for the UE or information provided by the NG-RAN into
account when determining the Paging subgroup ID for the UE.
If due to regional subscription restrictions or access restrictions the UE is
not allowed to access the TA or due to CAG restrictions the UE is not allowed
to access the cell, but the UE has an emergency PDU session established, the
AMF may accept the REGISTRATION REQUEST message and indicate to the SMF to
perform a local release of all non-emergency PDU sessions (associated with
3GPP access if it is due to CAG restrictions) and informs the UE via the PDU
session status IE in the REGISTRATION ACCEPT message. The AMF shall not
indicate to the SMF to release the emergency PDU session. If the AMF indicated
to the SMF to perform a local release of all non-emergency PDU sessions
(associated with 3GPP access if it is due to CAG restrictions), the network
shall behave as if the UE is registered for emergency services and shall set
the 5GS registration result IE value to \"Registered for emergency services\"
in the REGISTRATION ACCEPT message.
If the REGISTRATION ACCEPT message includes the PDU session reactivation
result error cause IE with the 5GMM cause set to #28 \"Restricted service
area\", the UE shall enter the state 5GMM-REGISTERED.NON-ALLOWED-SERVICE and
behave as specified in subclause 5.3.5.
If the REGISTRATION ACCEPT message includes the SOR transparent container IE
and:
a) the SOR transparent container IE does not successfully pass the integrity
check (see 3GPP TS 33.501 [24]); and
b) if the UE attempts obtaining service on another PLMNs or SNPNs as specified
in 3GPP TS 23.122 [5] annex C;
then the UE shall release locally the established NAS signalling connection
after sending a REGISTRATION COMPLETE message.
If the REGISTRATION ACCEPT message includes the SOR transparent container IE
and the SOR transparent container IE successfully passes the integrity check
(see 3GPP TS 33.501 [24]), the ME shall store the received SOR counter as
specified in annex C and proceed as follows:
a) the UE shall proceed with the behaviour as specified in 3GPP TS 23.122 [5]
annex C; and
b) if the registration procedure is performed over 3GPP access and the UE
attempts obtaining service on another PLMNs or SNPNs as specified in 3GPP TS
23.122 [5] annex C then the UE may release locally the established NAS
signalling connection after sending a REGISTRATION COMPLETE message. Otherwise
the UE shall send a REGISTRATION COMPLETE message and not release the current
N1 NAS signalling connection locally. If an acknowledgement is requested in
the SOR transparent container IE of the REGISTRATION ACCEPT message, the UE
acknowledgement is included in the SOR transparent container IE of the
REGISTRATION COMPLETE message. In the SOR transparent container IE carrying
the acknowledgement, the UE shall set the ME support of SOR-CMCI indicator to
\"SOR-CMCI supported by the ME\". Additionally, if the UE supports access to
an SNPN using credentials from a credentials holder and the UE is not
operating in SNPN access operation mode, the UE may set the ME support of SOR-
SNPN-SI indicator to \"SOR-SNPN-SI supported by the ME\".
If the SOR transparent container IE successfully passes the integrity check
(see 3GPP TS 33.501 [24]) , and:
a) the SOR transparent container IE indicates a list of preferred PLMN/access
technology combinations is provided and the list type indicates \"PLMN ID and
access technology list\", then the ME shall replace the highest priority
entries in the \"Operator Controlled PLMN Selector with Access Technology\"
list stored in the ME and shall proceed with the behaviour as specified in
3GPP TS 23.122 [5] annex C.
If the SOR-CMCI is present and the Store SOR-CMCI in ME indicator is set to
\"Store SOR-CMCI in ME\" then the UE shall store or delete the SOR-CMCI in the
non-volatile memory of the ME as described in annex C.1;
b) the list type indicates \"secured packet\", then the ME shall behave as if
a SMS is received with protocol identifier set to SIM data download, data
coding scheme set to class 2 message and SMS payload as secured packet
contents of SOR transparent container IE. The SMS payload is forwarded to UICC
as specified in 3GPP TS 23.040 [4A]; or
c) the SOR transparent container IE indicates \"HPLMN indication that \'no
change of the \"Operator Controlled PLMN Selector with Access Technology\"
list stored in the UE is needed and thus no list of preferred PLMN/access
technology combinations is provided\'\", the UE operates in SNPN access
operation mode and the SOR transparent container IE includes SOR-SNPN-SI, the
ME shall replace SOR-SNPN-SI of the selected entry of the \"list of subscriber
data\" or associated with the selected PLMN subscription, as specified in 3GPP
TS 23.122 [5] with the received SOR-SNPN-SI.
If the SOR-CMCI is present and the Store SOR-CMCI in ME indicator is set to
\"Store SOR-CMCI in ME\" then the UE shall store or delete the SOR-CMCI in the
non-volatile memory of the ME as described in annex C.1;
and the UE shall proceed with the behaviour as specified in 3GPP TS 23.122 [5]
annex C.
If the SOR transparent container IE does not pass the integrity check
successfully, then the UE shall discard the content of the SOR transparent
container IE.
If required by operator policy, the AMF shall include the NSSAI inclusion mode
IE in the REGISTRATION ACCEPT message (see table 4.6.2.3.1 of subclause
4.6.2.3). Upon receipt of the REGISTRATION ACCEPT message:
a) if the message includes the NSSAI inclusion mode IE, the UE shall operate
in the NSSAI inclusion mode indicated in the NSSAI inclusion mode IE over the
current access within the current PLMN or SNPN and its equivalent PLMN(s), if
any, in the current registration area; or
b) otherwise:
1) if the UE has NSSAI inclusion mode for the current PLMN or SNPN and access
type stored in the UE, the UE shall operate in the stored NSSAI inclusion
mode;
2) if the UE does not have NSSAI inclusion mode for the current PLMN or SNPN
and the access type stored in the UE and if the UE is performing the
registration procedure over:
i) 3GPP access, the UE shall operate in NSSAI inclusion mode D in the current
PLMN or SNPN and the current access type;
ii) untrusted non-3GPP access, the UE shall operate in NSSAI inclusion mode C
in the current PLMN and the current access type; or
iii) trusted non-3GPP access, the UE shall operate in NSSAI inclusion mode D
in the current PLMN and the current access type; or
3) if the 5G-RG does not have NSSAI inclusion mode for the current PLMN and
wireline access stored in the 5G-RG, and the 5G-RG is performing the
registration procedure over wireline access, the 5G-RG shall operate in NSSAI
inclusion mode B in the current PLMN and the current access type.
The AMF may include operator-defined access category definitions in the
REGISTRATION ACCEPT message.
If there is a running T3447 timer in the AMF and the Uplink data status IE is
included or the Follow-on request indicator is set to \"Follow-on request
pending\" in the REGISTRATION REQUEST message, the AMF shall ignore the Uplink
data status IE or that the Follow-on request indicator is set to \"Follow-on
request pending\" and proceed as if the Uplink data status IE was not received
or the Follow-on request indicator was not set to \"Follow-on request
pending\" except for the following case:
\- the PDU session(s) indicated by the Uplink data status IE is emergency PDU
session(s);
\- the UE is configured for high priority access in selected PLMN;
\- the REGISTRATION REQUEST message is as a paging response; or
\- the UE is establishing an emergency PDU session or performing emergency
services fallback.
If the UE receives Operator-defined access category definitions IE in the
REGISTRATION ACCEPT message and the Operator-defined access category
definitions IE contains one or more operator-defined access category
definitions, the UE shall delete any operator-defined access category
definitions stored for the RPLMN and shall store the received operator-defined
access category definitions for the RPLMN. If the UE receives the Operator-
defined access category definitions IE in the REGISTRATION ACCEPT message and
the Operator-defined access category definitions IE contains no operator-
defined access category definitions, the UE shall delete any operator-defined
access category definitions stored for the RPLMN. If the REGISTRATION ACCEPT
message does not contain the Operator-defined access category definitions IE,
the UE shall not delete the operator-defined access category definitions
stored for the RPLMN.
If the UE has indicated support for service gap control in the REGISTRATION
REQUEST message and:
\- the REGISTRATION ACCEPT message contains the T3447 value IE, then the UE
shall store the new T3447 value, erase any previous stored T3447 value if
exists and use the new T3447 value with the timer T3447 next time it is
started; or
\- the REGISTRATION ACCEPT message does not contain the T3447 value IE, then
the UE shall erase any previous stored T3447 value if exists and stop the
timer T3447 if running.
If the REGISTRATION ACCEPT message contains the Truncated 5G-S-TMSI
configuration IE, then the UE shall store the included truncated 5G-S-TMSI
configuration and return a REGISTRATION COMPLETE message to the AMF to
acknowledge reception of the truncated 5G-S-TMSI configuration.
NOTE 23: The UE provides the truncated 5G-S-TMSI configuration to the lower
layers.
If the UE is not in NB-N1 mode, the UE has set the RACS bit to \"RACS
supported\" in the 5GMM Capability IE of the REGISTRATION REQUEST message, and
the REGISTRATION ACCEPT message includes:
a) a UE radio capability ID deletion indication IE set to \"Network-assigned
UE radio capability IDs deletion requested\", the UE shall delete any network-
assigned UE radio capability IDs associated with the RPLMN or RSNPN and, if
the UE supports access to an SNPN using credentials from a credentials holder,
the selected entry of the \"list of subscriber data\" or the selected PLMN
subscription stored at the UE, then the UE shall initiate a registration
procedure for mobility and periodic registration update as specified in
subclause 5.5.1.3.2 over the existing N1 NAS signalling connection; or
b) a UE radio capability ID IE, the UE shall store the UE radio capability ID
as specified in annex C.
If the registration procedure for mobility and periodic registration update
was initiated and there is a request from the upper layers to perform
\"emergency services fallback\" pending, the UE shall restart the service
request procedure after the successful completion of the mobility and periodic
registration update.
When AMF re-allocation occurs in the registration procedure for mobility and
periodic registration update, if the new AMF receives in the 5GMM context of
the UE the indication that the UE is registered for onboarding services in
SNPN, the new AMF may start an implementation specific timer for onboarding
services when the registration procedure for mobility and periodic
registration update is successfully completed.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message and
the REGISTRATION ACCEPT message contains the service-level-AA pending
indication in the Service-level-AA container IE, the UE shall return a
REGISTRATION COMPLETE message to the AMF to acknowledge reception of the
service-level-AA pending indication, and the UE shall not attempt to perform
another registration procedure for UAS services until the UUAA-MM procedure is
completed, or to establish a PDU session for USS communication or a PDU
session for C2 communication until the UUAA-MM procedure is completed
successfully.
If the UE has included the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the REGISTRATION REQUEST message and
the REGISTRATION ACCEPT message does not contain the service-level-AA pending
indication in the Service-level-AA container IE, the UE shall consider the
UUAA-MM procedure is not triggered.
If the UE is registered for onboarding services in SNPN or the network
determines that the UE\'s subscription only allows for configuration of SNPN
subscription parameters in PLMN via the user plane, the AMF may start an
implementation specific timer for onboarding services, if not running already,
when the network considers that the UE is in 5GMM-REGISTERED (i.e. the network
receives the REGISTRATION COMPLETE message from UE).
NOTE 24: If the AMF considers that the UE is in 5GMM-IDLE, when the
implementation specific timer for onboarding services expires and the network
considers that the UE is still in state 5GMM-REGISTERED, the AMF can locally
de-register the UE; or if the UE is in 5GMM-CONNECTED, the AMF can initiate
the network-initiated de-registration procedure (see subclause 5.5.2.3).
NOTE 25: The value of the implementation specific timer for onboarding
services needs to be large enough to allow a UE to complete the configuration
of one or more entries of the \"list of subscriber data\" taking into
consideration that configuration of SNPN subscription parameters in PLMN via
the user plane or onboarding services in SNPN involves third party entities
outside of the operator\'s network.
If the UE receives the List of PLMNs to be used in disaster condition IE in
the REGISTRATION ACCEPT message and the UE supports MINT, the UE shall delete
the \"list of PLMN(s) to be used in disaster condition\" stored in the ME
together with the PLMN ID of the RPLMN, if any, and may store the \"list of
PLMN(s) to be used in disaster condition\" included in the List of PLMNs to be
used in disaster condition IE in the ME together with the PLMN ID of the
RPLMN.
If the UE receives the Disaster roaming wait range IE in the REGISTRATION
ACCEPT message and the UE supports MINT, the UE shall delete the disaster
roaming wait range stored in the ME, if any, and store the disaster roaming
wait range included in the Disaster roaming wait range IE in the ME.
If the UE receives the Disaster return wait range IE in the REGISTRATION
ACCEPT message and the UE supports MINT, the UE shall delete the disaster
return wait range stored in the ME, if any, and store the disaster return wait
range stored included in the Disaster return wait range IE in the ME.
If the 5GS registration type IE is set to \"disaster roaming mobility
registration updating\" and:
a) the MS determined PLMN with disaster condition IE is included in the
REGISTRATION REQUEST message, the AMF shall determine the PLMN with disaster
condition in the MS determined PLMN with disaster condition IE;
b) the MS determined PLMN with disaster condition IE is not included in the
REGISTRATION REQUEST message and the Additional GUTI IE is included in the
REGISTRATION REQUEST message and contains 5G-GUTI of a PLMN of the country of
the PLMN providing disaster roaming services, the AMF shall determine the PLMN
with disaster condition in the PLMN identity of the 5G-GUTI;
c) the MS determined PLMN with disaster condition IE and the Additional GUTI
IE are not included in the REGISTRATION REQUEST message and:
1) the 5GS mobile identity IE contains 5G-GUTI of a PLMN of the country of the
PLMN providing disaster roaming services, the AMF shall determine the PLMN
with disaster condition in the PLMN identity of the 5G-GUTI; or
2) the 5GS mobile identity IE contains SUCI of a PLMN of the country of the
PLMN providing disaster roaming services, the AMF shall determine the PLMN
with disaster condition in the PLMN identity of the SUCI; or
d) the MS determined PLMN with disaster condition IE is not included in the
REGISTRATION REQUEST message, NG-RAN of the PLMN providing disaster roaming
services broadcasts disaster roaming indication and:
\- the Additional GUTI IE is included in the REGISTRATION REQUEST message and
contains 5G-GUTI of a PLMN of a country other than the country of the PLMN
providing disaster roaming services; or
\- the Additional GUTI IE is not included and the 5GS mobile identity IE
contains 5G-GUTI or SUCI of a PLMN of a country other than the country of the
PLMN providing disaster roaming services;
the AMF shall determine the PLMN with disaster condition based on the disaster
roaming agreement arrangement between mobile network operators.
NOTE 26: The disaster roaming agreement arrangement between mobile network
operators is out scope of 3GPP.
If the AMF determines that a disaster condition applies to the PLMN with
disaster condition, and the UE is allowed to be registered for disaster
roaming services, the AMF shall set the Disaster roaming registration result
value bit in the 5GS registration result IE to \"no additional information\"
in the REGISTRATION ACCEPT message. If the AMF determines that the UE can be
registered to the PLMN for normal service, the AMF shall set the Disaster
roaming registration result value bit in the 5GS registration result IE to
\"request for registration for disaster roaming services accepted as
registration not for disaster roaming service \" in the REGISTRATION ACCEPT
message.
If the UE indicates \"disaster roaming mobility registration updating\" in the
5GS registration type IE in the REGISTRATION REQUEST message and the 5GS
registration result IE value in the REGISTRATION ACCEPT message is set to:
\- \"request for registration for disaster roaming services accepted as
registration not for disaster roaming service\", the UE shall consider itself
registered for normal service. If the PLMN identity of the registered PLMN is
a member of the forbidden PLMN list as specified in subclause 5.3.13A, any
such PLMN identity shall be deleted from the corresponding list(s); or
\- \"no additional information\", the UE shall consider itself registered for
disaster roaming services.
If the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the REGISTRATION ACCEPT message and the
TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking
areas for roaming\", the UE shall store the TAI(s) included in the IE into the
list of \"5GS forbidden tracking areas for roaming\" and remove the TAI(s)
from the stored TAI list if present.
If the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the REGISTRATION
ACCEPT message and the TAI(s) included in the IE is not part of the list of
\"5GS forbidden tracking areas for regional provision of service\", the UE
shall store the TAI(s) included in the IE into the list of \"5GS forbidden
tracking areas for regional provision of service\" and remove the TAI(s) from
the stored TAI list if present.
##### 5.5.1.3.5 Mobility and periodic registration update not accepted by the
network
If the mobility and periodic registration update request cannot be accepted by
the network, the AMF shall send a REGISTRATION REJECT message to the UE
including an appropriate 5GMM cause value.
If the mobility and periodic registration update request is rejected due to
general NAS level mobility management congestion control, the network shall
set the 5GMM cause value to #22 \"congestion\" and assign a value for back-off
timer T3346.
In NB-N1 mode, if the mobility and periodic registration update request is
rejected due to operator determined barring (see 3GPP TS 29.503 [20AB]), the
network shall set the 5GMM cause value to #22 \"congestion\" and assign a
value for back-off timer T3346.
When the UE performs inter-system change from S1 mode to N1 mode, if the AMF
is informed that verification of the integrity protection of the TRACKING AREA
UPDATE REQUEST message included by the UE in the EPS NAS message container IE
of the REGISTRATION REQUEST message has failed in the MME, then:
a) If the AMF can retrieve the current 5G NAS security context as indicated by
the ngKSI and 5G-GUTI sent by the UE, the AMF shall proceed as specified in
subclause 5.5.1.3.4;
b) if the AMF cannot retrieve the current 5G NAS security context as indicated
by the ngKSI and 5G-GUTI sent by the UE, or the ngKSI or 5G-GUTI was not sent
by the UE, the AMF may initiate the identification procedure by sending the
IDENTITY REQUEST message with the \"Type of identity\" of the 5GS identity
type IE set to \"SUCI\" before taking actions as specified in subclause
4.4.4.3; or
c) If the AMF needs to reject the mobility and periodic registration update
procedure, the AMF shall send REGISTRATION REJECT message including 5GMM cause
#9 \"UE identity cannot be derived by the network\".
If the REGISTRATION REJECT message with 5GMM cause #76 or #78 was received
without integrity protection, then the UE shall discard the message. If the
REGISTRATION REJECT message with 5GMM cause #62 was received without integrity
protected, the behaviour of the UE is specified in subclause 5.3.20.2.
Based on operator policy, if the mobility and periodic registration update
request is rejected due to core network redirection for CIoT optimizations,
the network shall set the 5GMM cause value to #31 \"Redirection to EPC
required\".
NOTE 1: The network can take into account the UE\'s S1 mode capability, the
EPS CIoT network behaviour supported by the UE or the EPS CIoT network
behaviour supported by the EPC to determine the rejection with the 5GMM cause
value #31 \"Redirection to EPC required\".
If the mobility and periodic registration update request is rejected because:
a) all the S-NSSAI(s) included in the requested NSSAI (i.e. Requested NSSAI IE
or Requested mapped NSSAI IE) are rejected;
b) the UE set the NSSAA bit in the 5GMM capability IE to:
1) \"Network slice-specific authentication and authorization supported\" and;
i) there are no default S-NSSAIs;
ii) all default S-NSSAIs are not allowed; or
iii) network slice-specific authentication and authorization has failed or
been revoked for all subscribed S-NSSAIs marked as default and based on
network local policy, the network decides not to initiate the network slice-
specific re-authentication and re-authorization procedures for any subscribed
S-NSSAI marked as default requested by the UE; or
2) \"Network slice-specific authentication and authorization not supported\"
and;
i) there are no subscribed S-NSSAIs which are marked as default; or
ii) all subscribed S-NSSAIs marked as default are either not allowed or are
subject to network slice-specific authentication and authorization; and
c) no emergency PDU session has been established for the UE;
the network shall set the 5GMM cause value to #62 \"No network slices
available\". If the UE had included requested NSSAI in the REGISTRATION
REQUEST message, then the network shall include the rejected S-NSSAI(s) in the
rejected NSSAI of the REGISTRATION REJECT message. Otherwise, the network may
include the rejected S-NSSAI(s) in the rejected NSSAI of the REGISTRATION
REJECT message.
If the UE has set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in
the 5GMM capability IE of the REGISTRATION REQUEST message, the rejected
S-NSSAI(s) shall be included in the Extended rejected NSSAI IE of the
REGISTRATION REJECT message. Otherwise the rejected S-NSSAI(s) shall be
included in the Rejected NSSAI IE of the REGISTRATION REJECT message.
If the UE supports extended rejected NSSAI and the AMF determines that maximum
number of UEs reached for one or more S-NSSAI(s) in the requested NSSAI as
specified in subclause 4.6.2.5**, the AMF shall include the rejected NSSAI**
containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not
available due to maximum number of UEs reached\" in the Extended rejected
NSSAI IE **in the** REGISTRATION REJECT message. In addition, the AMF may
include a back-off timer value for each S-NSSAI with the rejection cause
\"S-NSSAI not available due to maximum number of UEs reached\" in the Extended
rejected NSSAI IE of the REGISTRATION REJECT message.
If the mobility and periodic registration update request from a UE supporting
CAG is rejected due to CAG restrictions, the network shall set the 5GMM cause
value to #76 \"Not authorized for this CAG or authorized for CAG cells only\"
and should include the \"CAG information list\" in the CAG information list IE
or the Extended CAG information list IE in the REGISTRATION REJECT message.
NOTE 2: The network cannot be certain that \"CAG information list\" stored in
the UE is updated as result of sending of the REGISTRATION REJECT message with
the CAG information list IE or the Extended CAG information list IE, as the
REGISTRATION REJECT message is not necessarily delivered to the UE (e.g due to
abnormal radio conditions).
NOTE 3: The \"CAG information list\" can be provided by the AMF and include no
entry if no \"CAG information list\" exists in the subscription.
NOTE 3A: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the UE does not support extended CAG information list, the CAG information
list shall not be included in the Extended CAG information list IE.
If the mobility and periodic registration update request from a UE not
supporting CAG is rejected due to CAG restrictions, the network shall operate
as described in bullet i) of subclause 5.5.1.3.8.
If the UE\'s mobility and periodic registration update request is via a
satellite NG-RAN cell and the network determines that the UE is in a location
where the network is not allowed to operate, see 3GPP TS 23.502 [9], the
network shall set the 5GMM cause value in the REGISTRATION REJECT message to
#78 \"PLMN not allowed at the present UE location\".
NOTE 4: When the UE accessing network for emergency services, it is up to
operator and regulatory policies whether the network needs to determine if the
UE is in a location where network is not allowed to operate.
If the AMF receives the mobility and periodic registration update request
including the service-level device ID set to the CAA-level UAV ID in the
Service-level-AA container IE and the AMF determines that the UE is not
allowed to use UAS services via 5GS based on the user\'s subscription data and
the operator policy, the AMF shall return a REGISTRATION REJECT message with
5GMM cause #79 (UAS services not allowed).
If the mobility and periodic registration update request from a UE supporting
MINT is rejected due to a disaster condition no longer being applicable in the
current location of the UE, the network shall set the 5GMM cause value to #11
\"PLMN not allowed\" or #13 \"Roaming not allowed in this tracking area\" and
may include a disaster return wait range in the Disaster return wait range IE
in the REGISTRATION REJECT message.
If the UE initiates the registration procedure for disaster roaming services
and the AMF determines that it does not support providing disaster roaming
services for the determined PLMN with disaster condition to the UE, then the
AMF shall send a REGISTRATION REJECT message with 5GMM cause #80 (Disaster
roaming for the determined PLMN with disaster condition not allowed).
If the AMF received multiple TAIs from the satellite NG-RAN as described in
3GPP TS 23.501 [8], and determines that, by UE subscription and operator\'s
preferences, all of the received TAIs are forbidden for roaming or for
regional provision of service, the AMF shall include the TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE;
c) both;
in the REGISTRATION REJECT message.
Regardless of the 5GMM cause value received in the REGISTRATION REJECT message
via satellite access,
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the REGISTRATION REJECT message and if the
TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking
areas for roaming\", the UE shall store the TAI(s) included in the IE, if not
already stored, into the list of \"5GS forbidden tracking areas for roaming\";
and
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the REGISTRATION
REJECT message and if the TAI(s) included in the IE is not part of the list of
\"5GS forbidden tracking areas for regional provision of service\", the UE
shall store the TAI(s) included in the IE, if not already stored, into the
list of \"5GS forbidden tracking areas for regional provision of service\".
Furthermore, the UE shall take the following actions depending on the 5GMM
cause value received in the REGISTRATION REJECT message.
#3 (Illegal UE); or
#6 (Illegal ME).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1.
In case of SNPN, if the UE is not registered for onboarding services in SNPN
and the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall consider the entry of the \"list of
subscriber data\" with the SNPN identity of the current SNPN as invalid until
the UE is switched off, the entry is updated or the timer T3245 expires as
described in clause 5.3.19a.2. In case of SNPN, if the UE supports access to
an SNPN using credentials from a credentials holder, the UE shall consider the
selected entry of the \"list of subscriber data\" as invalid for 3GPP access
until the UE is switched off, the entry is updated or the timer T3245 expires
as described in clause 5.3.19a.2. Additionally, if EAP based primary
authentication and key agreement procedure using EAP-AKA\' or 5G AKA based
primary authentication and key agreement procedure was performed in the
current SNPN, the UE shall consider the USIM as invalid for the current SNPN
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not registered for onboarding services in SNPN, the UE shall
delete the list of equivalent PLMNs (if any) and shall move to 5GMM-
DEREGISTERED.NO-SUPI state. If the message has been successfully integrity
checked by the NAS, then the UE shall:
1) set the counter for \"SIM/USIM considered invalid for GPRS services\"
events and the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events to UE implementation-specific maximum value in case
of PLMN if the UE maintains these counters;
2) set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events to UE implementation-specific
maximum value in case of SNPN if the UE maintains these counters; and
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
to UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the normal tracking area
updating procedure is rejected with the EMM cause with the same value. The
USIM shall be considered as invalid also for non-EPS services until switching
off or the UICC containing the USIM is removed or the timer T3245 expires as
described in clause 5.3.7a in 3GPP TS 24.301 [15]. If the UE is in EMM-
REGISTERED state, the UE shall move to EMM-DEREGISTERED state. If the message
has been successfully integrity checked by the NAS and the UE maintains a
counter for \"SIM/USIM considered invalid for non-GPRS services\", then the UE
shall set this counter to UE implementation-specific maximum value.
If the UE is registered for onboarding services in SNPN, the UE shall reset
the registration attempt counter, store the SNPN identity in the \"permanently
forbidden SNPNs\" list for onboarding services, enter state 5GMM-
DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5]. If the message has
been successfully integrity checked by the NAS, the UE shall set the SNPN-
specific attempt counter for the current SNPN to the UE implementation-
specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access, the UE shall
in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not registered for onboarding services in SNPN
and the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall consider the entry of the \"list of
subscriber data\" with the SNPN identity of the current SNPN as invalid for
5GS services until the UE is switched off, the entry is updated or the timer
T3245 expires as described in clause 5.3.19a.2. In case of SNPN, if the UE is
not registered for onboarding services in SNPN and the UE supports access to
an SNPN using credentials from a credentials holder, the UE shall consider the
selected entry of the \"list of subscriber data\" as invalid for 3GPP access
until the UE is switched off, the entry is updated or the timer T3245 expires
as described in clause 5.3.19a.2. Additionally, if EAP based primary
authentication and key agreement procedure using EAP-AKA\' or 5G AKA based
primary authentication and key agreement procedure was performed in the
current SNPN, the UE shall consider the USIM as invalid for the current SNPN
until switching off or the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not registered for onboarding services in SNPN, the UE shall move
to 5GMM-DEREGISTERED.NO-SUPI state. If the message has been successfully
integrity checked by the NAS, then the UE shall:
1) set the counter for \"SIM/USIM considered invalid for GPRS services\"
events and the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events to UE implementation-specific maximum value in case
of PLMN if the UE maintains these counters;
2) set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events to UE implementation-specific
maximum value in case of SNPN if the UE maintains these counters; and
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the normal tracking area
updating procedure is rejected with the EMM cause with the same value.
If the UE is registered for onboarding services in SNPN, the UE shall reset
the registration attempt counter, store the SNPN identity in the \"permanently
forbidden SNPNs\" list for onboarding services, enter state 5GMM-
DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5]. If the message has
been successfully integrity checked by the NAS, the UE shall set the SNPN-
specific attempt counter for the current SNPN to the UE implementation-
specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access, the UE shall
in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#9 (UE identity cannot be derived by the network).
The UE shall set the 5GS update status to 5U2 NOT UPDATED (and shall store it
according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited
registered TAI, TAI list and ngKSI. The UE shall enter the state 5GMM-
DEREGISTERED.
If the UE has initiated the registration procedure in order to enable
performing the service request procedure for emergency services fallback, the
UE shall attempt to select an E-UTRA cell connected to EPC or 5GCN according
to the domain priority and selection rules specified in 3GPP TS 23.167 [6]. If
the UE finds a suitable E-UTRA cell, it then proceeds with the appropriate EMM
or 5GMM procedures. If the UE operating in single-registration mode has
changed to S1 mode, it shall disable the N1 mode capability for 3GPP access.
If the rejected request was neither for initiating an emergency PDU session
nor for emergency services fallback, the UE shall subsequently, automatically
initiate the initial registration procedure.
NOTE 5: User interaction is necessary in some cases when the UE cannot re-
establish the PDU session(s) automatically.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the normal tracking area
updating procedure is rejected with the EMM cause with the same value.
#10 (implicitly de-registered).
The UE shall enter the state 5GMM-DEREGISTERED.NORMAL-SERVICE. The UE shall
delete any mapped 5G NAS security context or partial native 5G NAS security
context.
If the UE has initiated the registration procedure in order to enable
performing the service request procedure for emergency services fallback, the
UE shall attempt to select an E-UTRA cell connected to EPC or 5GCN according
to the domain priority and selection rules specified in 3GPP TS 23.167 [6]. If
the UE finds a suitable E-UTRA cell, it then proceeds with the appropriate EMM
or 5GMM procedures. If the UE operating in single-registration mode has
changed to S1 mode, it shall disable the N1 mode capability for 3GPP access.
If the rejected request was neither for initiating an emergency PDU session
nor for emergency services fallback, the UE shall perform a new registration
procedure for initial registration.
NOTE 6: User interaction is necessary in some cases when the UE cannot re-
establish the PDU session(s) automatically.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM state as specified in 3GPP TS
24.301 [15] for the case when the normal tracking area updating procedure is
rejected with the EMM cause with the same value.
#11 (PLMN not allowed).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall store the PLMN
identity in the forbidden PLMN list as specified in subclause 5.3.13A and if
the UE is configured to use timer T3245 then the UE shall start timer T3245
and proceed as described in clause 5.3.19a.1, delete the list of equivalent
PLMNs, reset the registration attempt counter. For 3GPP access, the UE shall
enter the state 5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection
according to 3GPP TS 23.122 [5]. For non-3GPP access the UE shall enter state
5GMM-DEREGISTERED.LIMITED-SERVICE and perform network selection as defined in
3GPP TS 24.502 [18]. If the message has been successfully integrity checked by
the NAS and the UE maintains the PLMN-specific attempt counter and the PLMN-
specific attempt counter for non-3GPP access for that PLMN, the UE shall set
the PLMN-specific attempt counter and the PLMN-specific attempt counter for
non-3GPP access for that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition handle the EMM parameters EMM
state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI
and tracking area updating attempt counter as specified in 3GPP TS 24.301 [15]
for the case when the normal tracking area updating procedure is rejected with
the EMM cause with the same value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
If the UE receives the Disaster return wait range IE in the REGISTRATION
REJECT message and the UE supports MINT, the UE shall delete the disaster
return wait range stored in the ME, if any, and store the disaster return wait
range included in the Disaster return wait range IE in the ME.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.
If the REGISTRATION REJECT message is not integrity protected, the UE shall
memorize the current TAI was stored in the list of \"5GS forbidden tracking
areas for regional provision of service\" for non-integrity protected NAS
reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\" for the current SNPN and, if the UE supports access to
an SNPN using credentials from a credentials holder, the selected entry of the
\"list of subscriber data\" or the selected PLMN subscription, and enter the
state 5GMM-DEREGISTERED.LIMITED-SERVICE. If the REGISTRATION REJECT message is
not integrity protected, the UE shall memorize the current TAI was stored in
the list of \"5GS forbidden tracking areas for regional provision of service\"
for the current SNPN and, if the UE supports access to an SNPN using
credentials from a credentials holder, the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription, for non-integrity
protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and
tracking area updating attempt counter as specified in 3GPP TS 24.301 [15] for
the case when the normal tracking area updating procedure is rejected with the
EMM cause with the same value.
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete the list of
equivalent PLMNs (if available). The UE shall reset the registration attempt
counter. For 3GPP acess the UE shall change to state 5GMM-REGISTERED.PLMN-
SEARCH, and for non-3GPP access the UE shall change to state 5GMM-
REGISTERED.LIMITED-SERVICE.
If the UE is registered in S1 mode and operating in dual-registration mode,
the PLMN that the UE chooses to register in is specified in subclause 4.8.3.
Otherwise if:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
and shall remove the current TAI from the stored TAI list if present. If the
REGISTRATION REJECT message is not integrity protected, the UE shall memorize
the current TAI was stored in the list of \"5GS forbidden tracking areas for
roaming\" for non-integrity protected NAS reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for roaming\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription. If the REGISTRATION REJECT message
is not integrity protected, the UE shall memorize the current TAI was stored
in the list of \"5GS forbidden tracking areas for roaming\" for the current
SNPN and, if the UE supports access to an SNPN using credentials from a
credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription, for non-integrity protected NAS reject
message.
For 3GPP access the UE shall perform a PLMN selection or SNPN selection
according to 3GPP TS 23.122 [5], and for non-3GPP access the UE shall perform
network selection as defined in 3GPP TS 24.502 [18].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status and tracking area updating attempt counter as specified in 3GPP
TS 24.301 [15] for the case when the normal tracking area updating procedure
is rejected with the EMM cause with the same value.
If the UE receives the Disaster return wait range IE in the REGISTRATION
REJECT message and the UE supports MINT, the UE shall delete the disaster
return wait range stored in the ME, if any, and store the disaster return wait
range included in the Disaster return wait range IE in the ME.
#15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2). The UE shall reset the
registration attempt counter and shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE.
If the UE has initiated the registration procedure in order to enable
performing the service request procedure for emergency services fallback, the
UE shall attempt to select an E-UTRA cell connected to EPC or 5GC according to
the emergency services support indicator (see 3GPP TS 36.331 [25A]). If the UE
finds a suitable E-UTRA cell, it then proceeds with the appropriate EMM or
5GMM procedures. If the UE operating in single-registration mode has changed
to S1 mode, it shall disable the N1 mode capability for 3GPP access.
Otherwise, the UE shall search for a suitable cell in another tracking area
according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C].
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
and shall remove the current TAI from the stored TAI list, if present. If the
REGISTRATION REJECT message is not integrity protected, the UE shall memorize
the current TAI was stored in the list of \"5GS forbidden tracking areas for
roaming\" for non-integrity protected NAS reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for roaming\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, and shall remove the current TAI
from the stored TAI list, if present. If the REGISTRATION REJECT message is
not integrity protected, the UE shall memorize the current TAI was stored in
the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN
and, if the UE supports access to an SNPN using credentials from a credentials
holder, the selected entry of the \"list of subscriber data\" or the selected
PLMN subscription, for non-integrity protected NAS reject message.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status and tracking area updating attempt counter as specified in 3GPP
TS 24.301 [15] for the case when the normal tracking area updating procedure
is rejected with the EMM cause with the same value.
If received over non-3GPP access the cause shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.5.1.3.7.
#22 (Congestion).
If the T3346 value IE is present in the REGISTRATION REJECT message and the
value indicates that this timer is neither zero nor deactivated, the UE shall
proceed as described below, otherwise it shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.5.1.3.7.
The UE shall abort the registration procedure for mobility and periodic
registration update. If the rejected request was not for initiating an
emergency PDU session, the UE shall set the 5GS update status to 5U2 NOT
UPDATED, reset the registration attempt counter and change to state 5GMM-
REGISTERED.ATTEMPTING-REGISTRATION-UPDATE.
The UE shall stop timer T3346 if it is running.
If the REGISTRATION REJECT message is integrity protected, the UE shall start
timer T3346 with the value provided in the T3346 value IE.
If the REGISTRATION REJECT message is not integrity protected, the UE shall
start timer T3346 with a random value from the default range specified in 3GPP
TS 24.008 [12].
The UE stays in the current serving cell and applies the normal cell
reselection process. The registration procedure for mobility and periodic
registration update is started, if still necessary, when timer T3346 expires
or is stopped.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status and tracking area updating attempt counter as specified in 3GPP
TS 24.301 [15] for the case when the normal tracking area updating procedure
is rejected with the EMM cause with the same value.
If the registration procedure for mobility and periodic registration update
was initiated for an MO MMTEL voice call (i.e. access category 4), or an MO
MMTEL video call (i.e. access category 5), or an MO IMS registration related
signalling (i.e. access category 9) or for NAS signalling connection recovery
during an ongoing MO MMTEL voice call (i.e. access category 4), or during an
ongoing MO MMTEL video call (i.e. access category 5) or during an ongoing MO
IMS registration related signalling (i.e. access category 9), then a
notification that the request was not accepted due to network congestion shall
be provided to upper layers.
NOTE 7: Upper layers specified in 3GPP TS 24.173 [13C] and 3GPP TS 24.229 [14]
handle the notification that the request was not accepted due to network
congestion.
If the UE is registered for onboarding services in SNPN, the UE may enter the
state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN
selection for onboarding services according to 3GPP TS 23.122 [5].
#27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2). Additionally, the UE shall reset
the registration attempt counter and shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE. If the message has been successfully integrity
checked by the NAS, the UE shall set:
1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-
specific N1 mode attempt counter for non-3GPP access for that PLMN in case of
PLMN; or
2) the SNPN-specific attempt counter for 3GPP access for the current SNPN and
the SNPN-specific attempt counter for non-3GPP access for the current SNPN in
case of SNPN;
to the UE implementation-specific maximum value.
The UE shall disable the N1 mode capability for the specific access type for
which the message was received (see subclause 4.9).
If the message has been successfully integrity checked by the NAS, the UE
shall disable the N1 mode capability also for the other access type (see
subclause 4.9).
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED. Additionally, the UE shall reset the tracking area
updating attempt counter and enter the state EMM-REGISTERED.
#31 (Redirection to EPC required).
5GMM cause #31 received by a UE that has not indicated support for CIoT
optimizations or not indicated support for S1 mode or received by a UE over
non-3GPP access is considered an abnormal case and the behaviour of the UE is
specified in subclause 5.5.1.3.7.
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2). The UE shall reset the
registration attempt counter and enter the state 5GMM- REGISTERED.LIMITED-
SERVICE.
The UE shall enable the E-UTRA capability if it was disabled and disable the
N1 mode capability for 3GPP access (see subclause 4.9.2).
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, and tracking area updating attempt counter as specified in 3GPP
TS 24.301 [15] for the case when the normal tracking area updating procedure
is rejected with the EMM cause with the same value.
#36 (IAB-node operation not authorized).
This cause value is only applicable when received over 3GPP access by a UE
operating as an IAB-node. This cause value received from a 5G access network
other than 3GPP access or received by a UE not operating as an IAB-node is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
If:
1) the UE is not operating in SNPN access operation mode,
i) the UE shall delete the list of equivalent PLMNs and reset the registration
attempt counter and store the PLMN identity in the forbidden PLMN list as
specified in subclause 5.3.13A and if the UE is configured to use timer T3245
then the UE shall start timer T3245 and proceed as described in clause
5.3.19a.1. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform
a PLMN selection according to 3GPP TS 23.122 [5]. If the message has been
successfully integrity checked by the NAS and the UE maintains the PLMN-
specific attempt counter for 3GPP access for that PLMN, the UE shall set the
PLMN-specific attempt counter for 3GPP access for that PLMN to the UE
implementation-specific maximum value; and
ii) If the UE is operating in single-registration mode, the UE shall in
addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last
visited registered TAI, TAI list, eKSI and attach attempt counter as specified
in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is
rejected with the EMM cause with the same value; or
2) the UE is operating in SNPN access operation mode,
i) the UE shall reset the registration attempt counter and store the SNPN
identity in the "temporarily forbidden SNPNs" list for 3GPP access and, if the
UE supports access to an SNPN using credentials from a credentials holder, the
selected entry of the "list of subscriber data" or the selected PLMN
subscription. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and
perform an SNPN selection according to 3GPP TS 23.122 [5]. If the message has
been successfully integrity checked by the NAS, the UE shall set the SNPN
attempt counter for 3GPP access for the current SNPN to the UE implementation-
specific maximum value.
#62 (No network slices available).
The UE shall abort the registration procedure for mobility and periodic
registration update procedure, set the 5GS update status to 5U2 NOT UPDATED
and enter state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE. Additionally,
the UE shall reset the registration attempt counter.
The UE receiving the rejected NSSAI in the REGISTRATION REJECT message takes
the following actions based on the rejection cause in the rejected S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt to use
this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE, the
UICC containing the USIM is removed, an entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the current
registration area as specified in subclause 4.6.2.2 and shall not attempt to
use this S-NSSAI(s) in the current registration area until switching off the
UE, the UE moving out of the current registration area, the UICC containing
the USIM is removed, an entry of the \"list of subscriber data\" with the SNPN
identity of the current SNPN is updated, or the rejected S-NSSAI(s) are
removed as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI in the current PLMN or SNPN over any access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed or deleted as described in
subclause 4.6.1 and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
Unless the back-off timer value received along with the S-NSSAI is zero, the
UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
NOTE 8: If the back-off timer value received along with the S-NSSAI in the
rejected NSSAI for the maximum number of UEs reached is zero as specified in
subclause 10.5.7.4a of TS 24.008, the UE does not consider the S-NSSAI as the
rejected S-NSSAI.
If there is one or more S-NSSAIs in the rejected NSSAI with the rejection
cause \"S-NSSAI not available due to maximum number of UEs reached\", then for
each S-NSSAI, the UE shall behave as follows:
a) stop the timer T3526 associated with the S-NSSAI, if running;
b) start the timer T3526 with:
1) the back-off timer value received along with the S-NSSAI, if a back-off
timer value is received along with the S-NSSAI that is neither zero nor
deactivated; or
2) an implementation specific back-off timer value, if no back-off timer value
is received along with the S-NSSAI; and
c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs
reached when the timer T3526 associated with the S-NSSAI expires.
If the UE has an allowed NSSAI or configured NSSAI that contains S-NSSAIs
which are not included in the rejected NSSAI, the UE may stay in the current
serving cell, apply the normal cell reselection process and start a
registration procedure for mobility and periodic registration update with a
requested NSSAI that includes any S-NSSAI from the allowed S-NSSAI or the
configured NSSAI that is not in the rejected NSSAI. Otherwise the UE may
perform a PLMN selection or SNPN selection according to 3GPP TS 23.122 [5] and
additionally, the UE may disable the N1 mode capability for the current PLMN
or SNPN if the UE does not have an allowed NSSAI and each S-NSSAI in the
configured NSSAI, if available, was rejected with cause \"S-NSSAI not
available in the current PLMN or SNPN\" or \"S-NSSAI not available due to the
failed or revoked network slice-specific authentication and authorization\" as
described in subclause 4.9.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and,
1) if at least one S-NSSAI in the default configured NSSAI is not rejected,
the UE may stay in the current serving cell, apply the normal cell reselection
process, and start a registration procedure for mobility and periodic
registration update with a requested NSSAI with that default configured NSSAI;
or
2) if all the S-NSSAI(s) in the default configured NSSAI are rejected and at
least one S-NSSAI is rejected due to \"S-NSSAI not available in the current
registration area\",
i) if the REGISTRATION REJECT message is integrity protected and the UE is not
operating in SNPN access operation mode, the UE shall store the current TAI in
the list of \"5GS forbidden tracking areas for roaming\" and enter the state
5GMM-REGISTERED.LIMITED-SERVICE; or
ii) If the REGISTRATION REJECT message is integrity protected and the UE is
operating in SNPN access operation mode, the UE shall store the current TAI in
the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN
and enter the state 5GMM-REGISTERED.LIMITED-SERVICE.
Otherwise, the UE may perform a PLMN selection or SNPN selection according to
3GPP TS 23.122 [5] and additionally, the UE may disable the N1 mode capability
for the current PLMN or SNPN if each S-NSSAI in the default configured NSSAI
was rejected with cause \"S-NSSAI not available in the current PLMN or SNPN\"
or \"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\" as described in subclause 4.9.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and has rejected NSSAI for the
reached maximum number of UEs, and the UE wants to obtain services in the
current serving cell without performing a PLMN selection or SNPN selection,
the UE may stay in the current serving cell and attempt to use the rejected
S-NSSAI(s) for the maximum number of UEs reached in the current serving cell
after rejected S-NSSAI(s) are removed as described in subclause 4.6.2.2.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the tracking area updating attempt counter and enter the
state EMM-REGISTERED.
#72 (Non-3GPP access to 5GCN not allowed).
When received over non-3GPP access the UE shall set the 5GS update status to
5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2)
and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
Additionally, the UE shall reset the registration attempt counter and enter
the state 5GMM-DEREGISTERED. If the message has been successfully integrity
checked by the NAS, the UE shall set:
1) the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN
in case of PLMN; or
2) the SNPN-specific attempt counter for non-3GPP access for that SNPN in case
of SNPN;
to the UE implementation-specific maximum value.
NOTE 9: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause
4.9.3).
As an implementation option, the UE may enter the state 5GMM-
DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection according to
3GPP TS 23.122 [5].
If received over 3GPP access the cause shall be considered as an abnormal case
and the behaviour of the UE for this case is specified in subclause 5.5.1.3.7.
#73 (Serving network not authorized).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs, reset the registration attempt counter, store the PLMN
identity in the forbidden PLMN list as specified in subclause 5.3.13A. For
3GPP access the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH in order to
perform a PLMN selection according to 3GPP TS 23.122 [5], and for non-3GPP
access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE and perform
network selection as defined in 3GPP TS 24.502 [18]. If the message has been
successfully integrity checked by the NAS, the UE shall set the PLMN-specific
attempt counter and the PLMN-specific attempt counter for non-3GPP access for
that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI,
TAI list and eKSI. Additionally, the UE shall reset the tracking area updating
attempt counter and enter the state EMM-DEREGISTERED.
#74 (Temporarily not authorized for this SNPN).
5GMM cause #74 is only applicable when received from a cell belonging to an
SNPN. 5GMM cause #74 received from a cell not belonging to an SNPN is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and store the SNPN identity in the \"temporarily
forbidden SNPNs\" list for the specific access type for which the message was
received and, if the UE supports access to an SNPN using credentials from a
credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription. If the UE is not registered for onboarding
services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and
perform an SNPN selection according to 3GPP TS 23.122 [5]. If the UE is
registered for onboarding services in SNPN, the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5]. If the message has
been successfully integrity checked by the NAS, the UE shall set the SNPN-
specific attempt counter for 3GPP access and the SNPN-specific attempt counter
for non-3GPP access for the current SNPN to the UE implementation-specific
maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
NOTE 10: When 5GMM cause #74 is received over 3GPP access, the term \"other
access\" in \"the UE also supports the registration procedure over the other
access to the same SNPN\" is used to express access to SNPN services via a
PLMN.
NOTE 11: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
#75 (Permanently not authorized for this SNPN).
5GMM cause #75 is only applicable when received from a cell belonging to an
SNPN with a globally-unique SNPN identity. 5GMM cause #75 received from a cell
not belonging to an SNPN or a cell belonging to an SNPN with a non-globally-
unique SNPN identity is considered as an abnormal case and the behaviour of
the UE is specified in subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and store the SNPN identity in the \"permanently
forbidden SNPNs\" list for the specific access type for which the message was
received and, if the UE supports access to an SNPN using credentials from a
credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription. If the UE is not registered for onboarding
services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and
perform an SNPN selection according to 3GPP TS 23.122 [5]. If the UE is
registered for onboarding services in SNPN, the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5]. If the message has
been successfully integrity checked by the NAS, the UE shall set the SNPN-
specific attempt counter for 3GPP access and the SNPN-specific attempt counter
for non-3GPP access for the current SNPN to the UE implementation-specific
maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
NOTE 12: When 5GMM cause #75 is received over 3GPP access, the term \"other
access\" in \"the UE also supports the registration procedure over the other
access to the same SNPN\" is used to express access to SNPN services via a
PLMN.
NOTE 13: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
#76 (Not authorized for this CAG or authorized for CAG cells only).
This cause value received via non-3GPP access or from a cell belonging to an
SNPN is considered as an abnormal case and the behaviour of the UE is
specified in subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3.ROAMING NOT ALLOWED, store the
5GS update status according to clause 5.1.3.2.2, and reset the registration
attempt counter.
If 5GMM cause #76 is received from:
1) a CAG cell, and if the UE receives a \"CAG information list\" in the CAG
information list IE or the Extended CAG information list IE included in the
REGISTRATION REJECT message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 14: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall delete the CAG-ID(s) of the cell from the \"allowed
CAG list\" for the current PLMN. In the case the \"allowed CAG list\" for the
current PLMN only contains a range of CAG-IDs, how the UE deletes the CAG-
ID(s) of the cell from the \"allowed CAG list\" for the current PLMN is up to
UE implementation. In addition:
i) if the entry in the \"CAG information list\" for the current PLMN does not
include an \"indication that the UE is only allowed to access 5GS via CAG
cells\" or if the entry in the \"CAG information list\" for the current PLMN
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and the updated \"allowed CAG list\" for the current PLMN includes one
or more CAG-IDs, then the UE shall enter the state 5GMM-REGISTERED.LIMITED-
SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28]
or 3GPP TS 36.304 [25C] with the updated \"CAG information list\";
ii) if the entry in the \"CAG information list\" for the current PLMN includes
an \"indication that the UE is only allowed to access 5GS via CAG cells\" and
the updated \"allowed CAG list\" for the current PLMN does not include any
CAG-ID, then the UE shall enter the state 5GMM-REGISTERED.PLMN-SEARCH and
shall apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\"; or
iii) if the \"CAG information list\" does not include an entry for the current
PLMN, then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP TS
36.304 [25C] with the updated \"CAG information list\".
2) a non-CAG cell, and if the UE receives a \"CAG information list\" in the
CAG information list IE or the Extended CAG information list IE included in
the REGISTRATION REJECT message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 15: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall store an \"indication that the UE is only allowed to
access 5GS via CAG cells\" in the entry of the \"CAG information list\" for
the current PLMN, if any. If the \"CAG information list\" stored in the UE
does not include the current PLMN\'s entry, the UE shall add an entry for the
current PLMN to the \"CAG information list\" and store an \"indication that
the UE is only allowed to access 5GS via CAG cells\" in the entry of the \"CAG
information list\" for the current PLMN. If the UE does not have a stored
\"CAG information list\", the UE shall create a new \"CAG information list\"
and add an entry with an \"indication that the UE is only allowed to access
5GS via CAG cells\" for the current PLMN.
In addition:
i) if the \"allowed CAG list\" for the current PLMN includes one or more CAG-
IDs, then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] with the
updated CAG information; or
ii) if the \"allowed CAG list\" for the current PLMN does not include any CAG-
ID, then the UE shall enter the state 5GMM-REGISTERED.PLMN-SEARCH and shall
apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\".
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED, reset the tracking area updating attempt counter and
enter the state EMM-REGISTERED.
#77 (Wireline access area not allowed).
5GMM cause #77 is only applicable when received from a wireline access network
by the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the
N5GC device). 5GMM cause #77 received from a 5G access network other than a
wireline access network and 5GMM cause #77 received by the W-AGF acting on
behalf of the FN-BRG are considered as abnormal cases and the behaviour of the
UE is specified in subclause 5.5.1.3.7.
When received over wireline access network, the 5G-RG and the W-AGF acting on
behalf of the FN-CRG (or on behalf of the N5GC device) shall set the 5GS
update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to
subclause 5.1.3.2.2), shall delete 5G-GUTI, last visited registered TAI, TAI
list and ngKSI, shall reset the registration attempt counter, shall enter the
state 5GMM-DEREGISTERED and shall act as specified in subclause 5.3.23.
NOTE 16: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
#78 (PLMN not allowed to operate at the present UE location).
This cause value received from a non-satellite NG-RAN cell is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.1.3.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter. The UE shall store the PLMN identity and, if
it is known, the current geographical location in the list of \"PLMNs not
allowed to operate at the present UE location\" and shall start a
corresponding timer instance (see subclause 4.23.2). The UE shall enter state
5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP
TS 23.122 [5].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, and tracking area updating attempt counter as specified in 3GPP
TS 24.301 [15] for the case when the normal tracking area updating procedure
is rejected with the EMM cause with the same value.
#79 (UAS services not allowed).
The UE shall abort the registration procedure for mobility and periodic
registration update procedure, set the 5GS update status to 5U2 NOT UPDATED
and enter state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE. Additionally,
the UE shall reset the registration attempt counter. The UE may re-attempt the
registration procedure to the current PLMN for services other than UAS
services and shall not include the service-level device ID set to the CAA-
level UAV ID in the Service-level-AA container IE of REGISTRATION REQUEST
message unless the UE receives a CONFIGURATION UPDATE COMMAND message
including the service-level-AA service status indication in the Service-level-
AA container IE with the UAS field set to \"UAS services enabled\".
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the tracking area updating attempt counter and enter the
state EMM-REGISTERED.
#80 (Disaster roaming for the determined PLMN with disaster condition not
allowed).
The UE shall abort the registration procedure for mobility and periodic
registration update procedure, set the 5GS update status to 5U2 NOT UPDATED
and enter state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE. Additionally,
the UE shall reset the registration attempt counter. The UE shall not attempt
to register for disaster roaming services on this PLMN for the determined PLMN
with disaster condition for a period in the range of 12 to 24 hours. The UE
shall not attempt to register for disaster roaming services on this PLMN for a
period in the range of 3 to 10 minutes. The UE shall perform PLMN selection as
described in 3GPP TS 23.122 [6].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the tracking area updating attempt counter and enter the
state EMM-REGISTERED.
Other values are considered as abnormal cases. The behaviour of the UE in
those cases is specified in subclause 5.5.1.3.7.
##### 5.5.1.3.6 Mobility and periodic registration update for initiating an
emergency PDU session not accepted by the network
If the mobility and periodic registration update request for initiating an
emergency PDU session cannot be accepted by the network, the UE shall perform
the procedures as described in subclause 5.5.1.3.5. Then if the UE is in the
same selected PLMN where the last mobility and periodic registration update
request was attempted, the UE shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 1: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
b) perform de-registration locally, if not de-registered already, and attempt
initial registration for emergency services.
If the mobility and periodic registration update request for initiating an
emergency PDU session fails due to abnormal case b) in subclause 5.5.1.3.7,
the UE shall perform the actions as described in subclause 5.5.1.3.7 and
inform the upper layers of the failure to access the network.
NOTE 2: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
If the mobility and periodic registration update request for initiating an
emergency PDU session fails due to abnormal cases c) or d) in subclause
5.5.1.3.7, the UE shall perform the procedures as described in subclause
5.5.1.3.7. Then if the UE is in the same selected PLMN where the last mobility
and periodic registration update request was attempted, the UE shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 3: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
b) perform de-registration locally, if not de-registered already, and attempt
initial registration for emergency services.
##### 5.5.1.3.6A Mobility and periodic registration update for an emergency
services fallback not accepted by the network
If the mobility and periodic registration update request for initiating an
emergency services fallback:
\- fails due to an abnormal case described in subclause 5.5.1.3.7, the UE
shall perform the procedures as described in subclause 5.5.1.3.7; or
\- cannot be accepted by the network as described in subclause 5.5.1.3.5, the
UE shall perform the procedures as described in subclause 5.5.1.3.5.
If the mobility and periodic registration update request for initiating an
emergency services fallback fails due to abnormal case b) in subclause
5.5.1.3.7, the UE shall inform the upper layers of the failure to access the
network.
NOTE 1: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
If the mobility and periodic registration update request for initiating an
emergency services fallback fails due to abnormal cases c) or d) or cannot be
accepted and the UE does not attempt to select an E-UTRA cell connected to EPC
or 5GCN as described in subclause 5.5.1.3.5 and the UE is camped on NR or
E-UTRA cell connected to 5GCN in the same PLMN where the last mobility and
periodic registration update request was attempted, the UE shall inform the
upper layers of the failure of the procedure.
NOTE 2: This can result in the upper layers requesting implementation specific
mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the
emergency call being attempted to another IP-CAN.
##### 5.5.1.3.7 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Timer T3346 is running.
The UE shall not start the registration procedure for mobility and periodic
registration update unless:
1) the UE is in 5GMM-CONNECTED mode;
2) the UE received a paging;
3) the UE receives a NOTIFICATION message over non-3GPP access when the UE is
in 5GMM-CONNECTED mode over non-3GPP access and in 5GMM-IDLE mode over 3GPP
access;
4) the UE is a UE configured for high priority access in selected PLMN;
5) the UE has an emergency PDU session established or is establishing an
emergency PDU session;
6) the UE receives a request from the upper layers to perform emergency
services fallback;
> 7) the UE receives the CONFIGURATION UPDATE COMMAND message as specified in
> subclause 5.4.4.3;
>
> 8) the UE in NB-N1 mode is requested by the upper layer to transmit user
> data related to an exceptional event and:
>
> \- the UE is allowed to use exception data reporting (see the
> ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP TS
> 24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102 [22]); and
>
> \- timer T3346 was not started when N1 NAS signalling connection was
> established with RRC establishment cause set to \"mo-ExceptionData\"; or
9) the MUSIM UE needs to request a new 5G-GUTI assignment as specified in
subclause 5.5.1.3.2.
> The UE stays in the current serving cell and applies the normal cell
> reselection process.
NOTE 1: It is considered an abnormal case if the UE needs to initiate a
registration procedure for mobility and periodic registration update while
timer T3346 is running independent on whether timer T3346 was started due to
an abnormal case or a non-successful case.
If the registration procedure for mobility and periodic registration update
was initiated for an MO MMTEL voice call (i.e. access category 4), for an MO
MMTEL video call (i.e. access category 5), for an MO IMS registration related
signalling (i.e. access category 9) or for NAS signalling connection recovery
during an ongoing MO MMTEL voice call (i.e. access category 4), or during an
MO MMTEL video call (i.e. access category 5) or during an ongoing MO IMS
registration related signalling (i.e. access category 9), then a notification
that the procedure was not initiated due to network congestion shall be
provided to upper layers.
b) The lower layers indicate that the access attempt is barred.
The UE shall not start the registration procedure for mobility and periodic
registration update. The UE stays in the current serving cell and applies the
normal cell reselection process. Receipt of the access barred indication shall
not trigger the selection of a different core network type (EPC or 5GCN).
The registration procedure for mobility and periodic registration update is
started, if still needed, when the lower layers indicate that the barring is
alleviated for the access category with which the access attempt was
associated.
ba) The lower layers indicate that:
1) access barring is applicable for all access categories except categories 0
and 2 and the access category with which the access attempt was associated is
other than 0 and 2; or
2) access barring is applicable for all access categories except category 0
and the access category with which the access attempt was associated is other
than 0.
If the REGISTRATION REQUEST message has not been sent, the UE shall proceed as
specified for case b. If the REGISTRATION REQUEST message has been sent, the
UE shall proceed as specified for case e and, additionally, the registration
procedure for mobility and periodic registration update is started, if still
needed, when the lower layers indicate that the barring is alleviated for the
access category with which the access attempt was associated. For additional
UE requirements for both cases see subclause 4.5.5.
c) T3510 timeout.
The UE shall abort the registration update procedure and the N1 NAS signalling
connection, if any, shall be released locally.
If the UE has initiated the registration procedure in order to enable
performing the service request procedure for emergency services fallback,the
UE shall inform the upper layers of the failure of the emergency services
fallback (see 3GP P TS 24.229 [14]). Otherwise, the UE shall proceed as
described below.
d) REGISTRATION REJECT message, other 5GMM cause values than those treated in
subclause 5.5.1.3.5, and cases of 5GMM cause values #11, #15, #22, #31, #72,
#73, #74, #75, #76, #77 and #78, if considered as abnormal cases according to
subclause 5.5.1.3.5.
Upon reception of the 5GMM causes #95, #96, #97, #99 and #111 the UE should
set the registration attempt counter to 5.
The UE shall proceed as described below.
e) Lower layer failure, release of the NAS signalling connection received from
lower layers or the lower layers indicate that the RRC connection has been
suspended without a cell change before the REGISTRATION ACCEPT or REGISTRATION
REJECT message is received.
The UE shall abort the registration procedure and proceed as described below.
f) Change in the current TAI.
If the current TAI is changed before the registration procedure for mobility
and periodic registration update is completed, the registration procedure for
mobility and periodic registration update shall be aborted and re-initiated
immediately. The UE shall set the 5GS update status to 5U2 NOT UPDATED.
g) Registration procedure for mobility and periodic registration update and
de-registration procedure collision.
If the UE receives a DEREGISTRATION REQUEST message without 5GMM cause value
#11, #12, #13 or #15 before the registration procedure for mobility and
periodic registration update has been completed, the registration procedure
for mobility and periodic registration update shall be aborted and the de-
registration procedure shall be progressed.
If the UE receives a DEREGISTRATION REQUEST message with 5GMM cause value #11,
#12, #13 or #15 before the registration procedure for mobility and periodic
registration update has been completed, the registration procedure for
mobility and periodic registration update shall be progressed and the de-
registration procedure shall be aborted.
NOTE 2: The registration procedure for mobility and periodic registration
update shall be aborted only if the DEREGISTRATION REQUEST message indicates
in the access type that the access in which the registration procedure for
mobility and periodic registration update was attempted shall be de-
registered. Otherwise both the procedures shall be progressed.
h) Void
i) Transmission failure of REGISTRATION REQUEST message indication from the
lower layers or the lower layers indicate that the RRC connection has been
suspended with a cell change.
The registration procedure for mobility and periodic registration update shall
be aborted and re-initiated immediately. The UE shall set the 5GS update
status to 5U2 NOT UPDATED.
j) Transmission failure of REGISTRATION COMPLETE message indication with
change in the current TAI.
If the current TAI is not in the TAI list, the registration procedure for
mobility and periodic registration update shall be aborted and re-initiated
immediately. The UE shall set the 5GS update status to 5U2 NOT UPDATED.
If the current TAI is still part of the TAI list, it is up to the UE
implementation how to re-run the ongoing procedure.
k) Transmission failure of REGISTRATION COMPLETE message indication without
change in the current TAI.
It is up to the UE implementation how to re-run the ongoing procedure.
l) UE-initiated de-registration required.
De-registration due to removal of USIM or entry update in the \"list of
subscriber data\" or due to switch off:
The registration procedure for mobility and periodic registration update shall
be aborted, and the UE initiated de-registration procedure shall be performed.
De-registration not due to removal of USIM or entry update in the \"list of
subscriber data\" and not due to switch off:
the UE initiated de-registration procedure shall be initiated after successful
completion of the registration procedure for mobility and periodic
registration update.
m) Timer T3447 is running
The UE shall not start any mobility and periodic registration update procedure
with Uplink data status IE or Follow-on request indicator set to \"Follow-on
request pending\" unless:
\- the UE received a paging;
\- the UE is a UE configured for high priority access in selected PLMN;
> \- the UE has an emergency PDU session established or is establishing an
> emergency PDU session;
>
> \- the UE receives a request from the upper layers to perform emergency
> services fallback; or
\- the MUSIM UE needs to request a new 5G-GUTI assignment as specified in
subclause 5.5.1.3.2.
> The UE stays in the current serving cell and applies the normal cell
> reselection process. The mobility and periodic registration update procedure
> is started, if still necessary, when timer T3447 expires or timer T3447 is
> stopped.
n) Timer T3448 is running
The UE in 5GMM-IDLE mode shall not start any mobility and periodic
registration update procedure with Follow-on request indicator set to
\"Follow-on request pending\" unless:
1) the UE is a UE configured for high priority access in selected PLMN;
2) the UE which is only using 5GS services with control plane CIoT 5GS
optimization received a paging request; or
3) the UE in NB-N1 mode is requested by the upper layer to transmit user data
related to an exceptional event and the UE is allowed to use exception data
reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration
MO in 3GPP TS 24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102
[22]).
The UE stays in the current serving cell and applies the normal cell
reselection process. The mobility and periodic registration update procedure
is started, if still necessary, when timer T3448 expires.
For the cases c, d and e the UE shall proceed as follows:
Timer T3510 shall be stopped if still running.
If the registration procedure is not for initiating an emergency PDU session,
the registration attempt counter shall be incremented, unless it was already
set to 5.
If the registration attempt counter is less than 5:
\- if the TAI of the current serving cell is not included in the TAI list or
the 5GS update status is different to 5U1 UPDATED or if the registration
procedure was triggered due to cases c, g, n, v in subclause 5.5.1.3.2, the UE
shall start timer T3511, shall set the 5GS update status to 5U2 NOT UPDATED
and change to state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE. When timer
T3511 expires, the registration update procedure is triggered again.
\- if the TAI of the current serving cell is included in the TAI list, the 5GS
update status is equal to 5U1 UPDATED, and the UE is not performing the
registration procedure after an inter-system change from S1 mode to N1 mode,
the UE shall keep the 5GS update status to 5U1 UPDATED and enter state 5GMM-
REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-ALLOWED-SERVICE (as described
in subclause 5.3.5.2). The UE shall start timer T3511. If in addition the
REGISTRATION REQUEST message did not include the MICO indication IE or the
Extended DRX IE, and:
\- the REGISTRATION REQUEST message indicated \"periodic registration
updating\";
\- the registration procedure was initiated to recover the NAS signalling
connection due to \"RRC Connection failure\" from the lower layers; or
\- the registration procedure was initiated by the UE in 5GMM-CONNECTED mode
with RRC inactive indication entering a cell in the current registration area
belonging to an equivalent PLMN of the registered PLMN and not belonging to
the registered PLMN,
and none of the other reasons for initiating the registration updating
procedure listed in subclause 5.5.1.3.2 was applicable, the timer T3511 may be
stopped when the UE enters 5GMM-CONNECTED mode.
\- if the TAI of the current serving cell is included in the TAI list, the 5GS
update status is equal to 5U1 UPDATED and the UE is performing the
registration procedure after an inter-system change from S1 mode to N1 mode,
the UE shall change the 5GS update status to 5U2 NOT UPDATED and enter state
5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE. The UE shall start timer
T3511.
\- If the procedure is performed via 3GPP access and the UE is operating in
single-registration mode, the UE shall in addition handle the EPS update
status as specified in 3GPP TS 24.301 [15] for the abnormal cases when a
normal or periodic tracking area updating procedure fails and the tracking
area attempt counter is less than 5 and the EPS update status is different
from EU1 UPDATED.
If the registration attempt counter is equal to 5
\- the UE shall start timer T3502, shall set the 5GS update status to 5U2 NOT
UPDATED.
\- the UE shall delete the list of equivalent PLMNs (if any) and shall change
to state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE or optionally to 5GMM-
REGISTERED.PLMN-SEARCH in order to perform a PLMN selection, SNPN selection or
SNPN selection for onboarding services according to 3GPP TS 23.122 [5].
\- if the procedure is performed via 3GPP access and the UE is operating in
single-registration mode:
\- the UE shall in addition handle the EPS update status as specified in 3GPP
TS 24.301 [15] for the abnormal cases when a normal or periodic tracking area
updating procedure fails and the tracking area attempt counter is equal to 5;
and
\- if the UE does not change to state 5GMM-REGISTERED.PLMN-SEARCH, the UE
shall attempt to select E-UTRAN radio access technology. The UE may disable
the N1 mode capability as specified in subclause 4.9.
##### 5.5.1.3.8 Abnormal cases on the network side
The following abnormal cases can be identified:
a) If a lower layer failure occurs before the message REGISTRATION COMPLETE
has been received from the UE and timer T3550 is running, the AMF shall abort
the procedure, enter 5GMM-IDLE mode.
If a new 5G-GUTI was assigned to the UE in the REGISTRATION ACCEPT message,
the AMF shall consider both, the old and new 5G-GUTIs as valid until the old
5G-GUTI can be considered as invalid by the AMF. If a new TAI list was
provided in the REGISTRATION ACCEPT message, both the old and new TAI lists
shall also be considered valid until the old TAI list can be considered
invalid by the AMF. If the old 5G-GUTI was allocated by an AMF other than the
current AMF, the current AMF does not need to retain the old 5G-GUTI.
Additionally, if the REGISTRATION ACCEPT message includes:
1) Negotiated PEIPS assistance information IE containing a new Paging subgroup
ID and the UE is previously assigned a different Paging subgroup ID then, the
AMF shall consider both, the old and new Paging subgroup IDs as valid until
the old Paging subgroup ID can be considered as invalid by the AMF; or
2) Negotiated PEIPS assistance information IE containing no Paging subgroup ID
or no Negotiated PEIPS assistance information IE, then the AMF shall delete
any old Paging subgroup ID stored in the 5GMM context of the UE.
During this period:
1) if the new 5G-GUTI is used by the UE in a subsequent message, then:
i) the AMF shall consider the old 5G-GUTI as invalid and, additionally, the
old TAI list as invalid if a new TAI list was provided with the new 5G-GUTI in
the REGISTRATION ACCEPT message; and
ii) if the AMF assigns a new Paging subgroup ID to the UE in the REGISTRATION
ACCEPT message, then, the AMF shall consider the new Paging subgroup ID as
valid and the old Paging subgroup ID, if any, as invalid.
2) if the old 5G-GUTI is used by the UE in a subsequent message, the AMF may
use the identification procedure followed by a generic UE configuration update
procedure. If the AMF in the REGISTRATION ACCEPT message:
i) assigns a new Paging subgroup ID to the UE, then, the AMF shall include the
PEIPS assistance information; or
ii) does not assign a Paging subgroup ID to the UE then, the AMF shall not
include the PEIPS assistance information;
and initiate the generic UE configuration update procedure; and
3) if the UE needs to be paged:
i) if in the REGISTRATION ACCEPT message:
\- a new Paging subgroup ID is assigned to the UE that previously has no
Paging subgroup ID assigned then, the AMF shall use the new Paging subgroup ID
for paging the UE;
\- a new Paging subgroup ID is assigned to the UE that is same as the old
Paging subgroup ID then, the AMF shall use the same Paging subgroup ID for
paging the UE; and
\- a new Paging subgroup ID is assigned to the UE that is different than the
old Paging subgroup ID then, the AMF may first use the old Paging subgroup ID
followed by the new Paging subgroup ID for paging the UE.
ii) the AMF selects the 5G-GUTI and TAI list as follows:
\- the AMF may first use the old 5G-S-TMSI from the old 5G-GUTI for paging
within the area defined by the old TAI list for an implementation dependent
number of paging attempts using the selected Paging subgroup ID. If a new TAI
list was provided in the REGISTRATION ACCEPT message, the new TAI list should
also be used for paging. Upon response from the UE, the AMF may initiate the
generic UE configuration update procedure. If the response is received from a
tracking area within the old and new TAI list, the network shall initiate the
generic UE configuration update procedure. If in the REGISTRATION ACCEPT
message a new Paging subgroup ID was assigned to the UE that is different than
the old Paging subgroup ID then the network shall initiate the generic UE
configuration update procedure; and
\- if no response is received to the paging attempts using the old 5G-S-TMSI
from the old 5G-GUTI and the old Paging subgroup ID, the AMF may use the new
5G-S-TMSI from the new 5G-GUTI and the new Paging subgroup ID, if any, for
paging, for an implementation dependent number of paging attempts. In this
case, if a new TAI list was provided with the new 5G-GUTI in the REGISTRATION
ACCEPT message, the new TAI list shall be used instead of the old TAI list.
b) Protocol error.
If the REGISTRATION REQUEST message has been received with a protocol error,
the AMF shall return a REGISTRATION REJECT message with one of the following
5GMM cause values:
#96 invalid mandatory information;
#99 information element non-existent or not implemented;
#100 conditional IE error; or
#111 protocol error, unspecified.
c) T3550 time out.
On the first expiry of the timer, the AMF shall retransmit the REGISTRATION
ACCEPT message and shall reset and restart timer T3550. The retransmission is
performed four times, i.e. on the fifth expiry of timer T3550, the
registration procedure for mobility and periodic update procedure is aborted.
If a new 5G-GUTI was assigned to the UE in the REGISTRATION ACCEPT message,
both, the old and new 5G-GUTI shall be considered as valid until the old
5G-GUTI can be considered as invalid by the AMF. If a new TAI list was
provided in the REGISTRATION ACCEPT message, both the old and new TAI lists
shall also be considered valid until the old TAI list can be considered
invalid by the AMF. If the old 5G-GUTI was allocated by an AMF other than the
current AMF, the current AMF does not need to retain the old 5G-GUTI. During
this period the AMF acts as described for case a) above.
d) REGISTRATION REQUEST with 5GS registration type IE set to \"mobility
registration updating\" or \"periodic registration updating\" received after
the REGISTRATION ACCEPT message has been sent and before the REGISTRATION
COMPLETE message is received, if the REGISTRATION COMPLETE message is
expected.
1) If one or more of the information elements in the REGISTRATION REQUEST
message differ from the ones received within the previous REGISTRATION REQUEST
message, the previously initiated registration procedure for mobility and
periodic registration update shall be aborted if the REGISTRATION COMPLETE
message has not been received and the new registration procedure for mobility
and periodic registration update shall be progressed; or
2) if the information elements do not differ, then the REGISTRATION ACCEPT
message shall be resent and timer T3550 shall be restarted. In that case, the
retransmission counter related to timer T3550 is not incremented.
e) More than one REGISTRATION REQUEST message with 5GS registration type IE
set to \"mobility registration updating\" or \"periodic registration
updating\" received and neither REGISTRATION ACCEPT message nor REGISTRATION
REJECT message has been sent.
1) If one or more of the information elements in the REGISTRATION REQUEST
message differs from the ones received within the previous REGISTRATION
REQUEST message, the previously initiated registration procedure for mobility
and periodic registration update shall be aborted and the new registration
procedure for mobility and periodic registration update shall be progressed;
or
2) if the information elements do not differ, then the network shall continue
with the previous registration procedure for mobility and periodic
registration update and shall not treat any further this REGISTRATION REQUEST
message.
f) Lower layers indication of non-delivered NAS PDU due to handover.
If the REGISTRATION ACCEPT message or REGISTRATION REJECT message could not be
delivered due to an intra AMF handover and the target TA is included in the
TAI list, then upon successful completion of the intra AMF handover the AMF
shall retransmit the REGISTRATION ACCEPT message or REGISTRATION REJECT
message. If a failure of the handover procedure is reported by the lower layer
and the N1 NAS signalling connection exists, the AMF shall retransmit the
REGISTRATION ACCEPT message or REGISTRATION REJECT message.
g) DEREGISTRATION REQUEST message received before REGISTRATION COMPLETE
message is received, if the REGISTRATION COMPLETE message is expected.
If the De-registration type IE is set to \"switch off\":
The AMF shall abort the signalling for the registration procedure for mobility
and periodic update towards the UE and shall progress the de-registration
procedure as described in subclause 5.5.2.2.
NOTE 1: Internally in the AMF, before processing the de-registration request,
the AMF can perform the necessary signalling procedures for the registration
procedure for mobility and periodic update before progressing the de-
registration procedure.
If the De-registration type IE is set to other type than \"switch off\":
The AMF shall proceed with registration procedure for mobility and periodic
update and shall progress the de-registration procedure after successful
completion of the registration procedure for mobility and periodic update.
h) If the REGISTRATION REQUEST message with 5GS registration type IE
indicating \"periodic registration updating\" is received by the new AMF which
does not have the 5GMM context data related to the subscription, the new AMF
may send the REGISTRATION REJECT message with 5GMM cause #10 \"implicitly de-
registered\".
i) Based on operator policy, if the mobility and periodic registration update
request from a UE not supporting CAG is rejected due to CAG restrictions, the
network shall reject the mobility and periodic registration update request
with a 5GMM cause value other than the 5GMM cause #76 (Not authorized for this
CAG or authorized for CAG cells only).
NOTE 2: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not
allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving
network not authorized) can be used depending on the subscription of the UE
and whether the UE roams or not.
### 5.5.2 De-registration procedure
#### 5.5.2.1 General
The de-registration procedure is used:
a) by the UE to de-register for 5GS services over 3GPP access when the UE is
registered over 3GPP access;
b) by the UE to de-register for 5GS services over non-3GPP access when the UE
is registered over non-3GPP access;
c) by the UE to de-register for 5GS services over 3GPP access, non-3GPP access
or both when the UE is registered in the same PLMN over both accesses;
d) by the network to inform the UE that it is deregistered for 5GS services
over 3GPP access when the UE is registered over 3GPP access;
e) by the network to inform the UE that it is deregistered for 5GS services
over non-3GPP access when the UE is registered over non-3GPP access;
f) by the network to inform the UE that it is deregistered for 5GS services
over 3GPP access, non-3GPP access or both when the UE is registered in the
same PLMN over both accesses;
g) by the network to inform the UE to re-register to the network; and
h) by the network to inform the UE supporting UAS service that it is
deregistered for UAS services in 5GS.
The de-registration procedure with appropriate de-registration type shall be
invoked by the UE:
a) if the UE is switched off;
b) as part of the eCall inactivity procedure defined in subclause 5.5.3; and
c) as part of USIM removal.
The de-registration procedure with appropriate de-registration type shall be
invoked by the network:
a) if the network informs whether the UE should re-register to the network.
The de-registration procedure with appropriate access type shall be invoked by
the UE:
a) if the UE needs to de-register for 5GS services over 3GPP access when the
UE is registered over 3GPP access;
b) if the UE needs to de-register for 5GS services over non-3GPP access when
the UE is registered over non-3GPP access;
c) the UE needs to de-register for 5GS services over 3GPP access, non-3GPP
access or both when the UE is registered in the same PLMN over both accesses;
or
d) to de-register for 5GS services over 3GPP access, if the UE is registered
for disaster roaming services over 3GPP access and has successfully registered
over non-3GPP access on another PLMN.
The de-registration procedure with appropriate access type shall be invoked by
the network:
a) if the network needs to inform the UE that it is deregistered over 3GPP
access when the UE is registered over 3GPP access;
b) if the network needs to inform the UE that it is deregistered over non-3GPP
access when the UE is registered over non-3GPP access; or
c) if the network needs to inform the UE that it is deregistered over 3GPP
access, non-3GPP access or both when the UE is registered in the same PLMN
over both accesses.
If the de-registration procedure is triggered due to USIM removal, the UE
shall indicate \"switch off\" in the de-registration type IE.
If the de-registration procedure is requested by the network for a UE that has
an emergency PDU session, the AMF shall not send a DEREGISTRATION REQUEST
message to the UE and indicate to the SMF to release all non-emergency PDU
sessions as specified in 3GPP TS 23.502 [9].
If the de-registration procedure for 5GS services is performed, a local
release of the PDU sessions over the indicated access(es), if any, for this
particular UE is performed. If a PDU session that will be released is
associated with one or more multicast MBS sessions, the UE is considered as
removed from the associated multicast MBS sessions.
The UE is allowed to initiate the de-registration procedure even if the timer
T3346 is running.
NOTE 1: When the UE has no PDU sessions over non-3GPP access, or the UE moves
all the PDU sessions over a non-3GPP access to a 3GPP access, the UE and the
AMF need not initiate de-registration over the non-3GPP access.
The AMF shall provide the UE with a non-3GPP de-registration timer.
When the AMF enters the state 5GMM-DEREGISTERED for 3GPP access, the AMF shall
delete the stored UE radio capability information or the UE radio capability
ID, if any.
When upper layers indicate that emergency services are no longer required, the
UE if still registered for emergency services, may perform UE-initiated de-
registration procedure followed by a re-registration to regain normal
services, if the UE is in or moves to a suitable cell.
If the UE is registered for onboarding services in SNPN, after completing the
configuration of one or more entries of the \"list of subscriber data\", the
UE should perform UE-initiated de-registration procedure. To prevent the UE
registered for onboarding services in SNPN from staying on the ON-SNPN or to
prevent a UE whose subscription only allows for configuration of SNPN
subscription parameters in PLMN via the user plane, from staying registered
indefinitely, when an implementation specific timer expires:
\- if the AMF considers that the UE is in 5GMM-IDLE, the AMF shall locally de-
registers the UE; or
\- if the UE is in 5GMM-CONNECTED, the AMF shall initiate the network-
initiated de-registration procedure (see subclause 5.5.2.3).
NOTE 2: The value of the implementation specific timer for onboarding services
needs to be large enough to allow a UE to complete the configuration of one or
more entries of the \"list of subscriber data\" taking into consideration that
configuration of SNPN subscription parameters in PLMN via the user plane or
onboarding services in SNPN involves third party entities outside of the
operator\'s network.
NOTE 3: How to determine the completion of the configuration of one or more
entries of the \"list of subscriber data\" is UE implementation specific.
If the de-registration procedure is not due to switch off and upper layers
request establishing an emergency PDU session before the de-registration
procedure has been completed, the UE shall abort the deregistration procedure,
perform local de-registration and initiate a registration procedure.
If the UE in 5GMM-CONNECTED mode determines to obtain service on a higher
priority PLMN due to SOR, then based on the conditions as specified in 3GPP TS
23.122 [5] annex C, where applicable, the UE shall perform UE-initiated de-
registration procedure.
If the UE is **registered for disaster roaming services,** and the UE receives
an indication of whether disaster roaming is enabled in the UE set to
\"Disaster roaming is disabled in the UE\" in a UE parameters update
transparent container, the UE shall perform UE-initiated de-registration
procedure.
#### 5.5.2.2 UE-initiated de-registration procedure
##### 5.5.2.2.1 UE-initiated de-registration procedure initiation
The de-registration procedure is initiated by the UE by sending a
DEREGISTRATION REQUEST message (see example in figure 5.5.2.2.1). The De-
registration type IE included in the message indicates whether the de-
registration procedure is due to a \"switch off\" or not. The access type
included in the message indicates whether the de-registration procedure is:
a) for 5GS services over 3GPP access when the UE is registered over 3GPP
access;
b) for 5GS services over non-3GPP access when the UE is registered over
non-3GPP access; or
c) for 3GPP access, non-3GPP access or both when the UE is registered in the
same PLMN over both accesses.
If the UE has a valid 5G-GUTI, the UE shall populate the 5GS mobile identity
IE with the valid 5G-GUTI. If the UE does not have a valid 5G-GUTI, the UE
shall populate the 5GS mobile identity IE with its SUCI as follows:
a) if timer T3519 is not running, generate a fresh SUCI as specified in 3GPP
TS 33.501 [24], send a DEREGISTRATION REQUEST message with the SUCI, start
timer T3519 and store the value of the SUCI sent in the DEREGISTRATION REQUEST
message; and
b) if timer T3519 is running, send a DEREGISTRATION REQUEST message with the
stored SUCI.
If the UE does not have a valid 5G-GUTI and it does not have a valid SUCI,
then the UE shall populate the5GS mobile identity IE with its PEI.
If the de-registration request is not due to switch off and the UE is in the
state 5GMM-REGISTERED or 5GMM-REGISTERED-INITIATED, timer T3521 shall be
started in the UE after the DEREGISTRATION REQUEST message has been sent. The
UE shall enter the state 5GMM-DEREGISTERED-INITIATED.
If the UE is to be switched off, the UE shall try for a period of 5 seconds to
send the DEREGISTRATION REQUEST message. During this period, the UE may be
switched off as soon as the DEREGISTRATION REQUEST message has been sent.
Figure 5.5.2.2.1.1: UE-initiated de-registration procedure
##### 5.5.2.2.2 UE-initiated de-registration procedure completion
When the DEREGISTRATION REQUEST message is received by the AMF, the AMF shall
send a DEREGISTRATION ACCEPT message to the UE, if the De-registration type IE
does not indicate \"switch off\". Otherwise, the procedure is completed when
the AMF receives the DEREGISTRATION REQUEST message.
The UE, when receiving the DEREGISTRATION ACCEPT message, shall stop timer
T3521, stop timer T3519 if running, and delete any stored SUCI.
##### 5.5.2.2.3 UE-initiated de-registration procedure completion for 5GS
services over 3GPP access
If the access type in the DEREGISTRATION REQUEST message indicates that the
de-registration procedure is for 3GPP access, the AMF shall trigger the SMF to
perform a local release of the PDU session(s) established over 3GPP access, if
any, for this UE. The UE shall perform a local release of the PDU session(s)
established over 3GPP access, if any. If a PDU session is associated with one
or more multicast MBS sessions, the UE shall locally leave the associated
multicast MBS sessions and the SMF shall consider the UE as removed from the
associated multicast MBS sessions. If there is an MA PDU session with user
plane resources established on both 3GPP access and non-3GPP access in the
same PLMN or in different PLMNs, the AMF shall trigger SMF to perform release
of user plane resources on 3GPP access, and the UE shall consider the user
plane resources on 3GPP access as released. If there is an MA PDU session with
user plane resources established on 3GPP access only, the AMF shall trigger
the SMF to perform a local release of the MA PDU session, and the UE shall
perform a local release of the MA PDU session. If the MA PDU session is
associated with one or more MBS multicast sessions, the UE shall locally leave
the associated MBS multicast sessions. The UE is marked as inactive in the AMF
for 5GS services for 3GPP access. The AMF shall enter the state 5GMM-
DEREGISTERED for 3GPP access.
If the UE supports N1 mode only and the de-registration request is not due to
switch off, then:
a) if the de-registration procedure was performed due to disabling of 5GS
services, then the UE shall enter the 5GMM-NULL state for 3GPP access;
b) otherwise, the UE shall enter the 5GMM-DEREGISTERED state for 3GPP access.
NOTE: Case b) is applicable when the UE is also registered over non-3GPP
access.
If the access type indicates that the de-registration procedure is for 3GPP
access or for 3GPP access and non-3GPP access, and the UE is operating in
single-registration mode, it shall additionally proceed as specified in 3GPP
TS 24.301 [15], subclause 5.5.2.2.2, for the case when the UE receives an EMM
message DETACH ACCEPT. Furthermore, if the UE supports A/Gb or Iu mode, it
shall disable the N1 mode capability for 3GPP access.
##### 5.5.2.2.4 UE-initiated de-registration procedure completion for 5GS
services over non-3GPP access
If the access type in the DEREGISTRATION REQUEST indicates that the de-
registration procedure is for non-3GPP access, the AMF shall trigger SMF to
perform a local release of the PDU session(s) established over non-3GPP
access, if any, for this UE. The UE shall perform a local release of the PDU
session(s) established over non-3GPP access, if any. If there is an MA PDU
session with user plane resources established on both 3GPP access and non-3GPP
access in the same PLMN or in different PLMNs, the AMF shall trigger SMF to
perform release of user plane resources on non-3GPP access, and the UE shall
consider the user plane resources on non-3GPP access as released. If there is
an MA PDU session with a PDN connection as a user-plane resource and user
plane resources established on non-3GPP access, the AMF shall trigger SMF to
perform release of user plane resources on non-3GPP access, and the UE shall
consider the user plane resources on non-3GPP access as released. If the UE
has an MA PDU session with user plane resources established on non-3GPP access
only, the AMF shall trigger the SMF to perform a local release of the MA PDU
session, and the UE shall perform a local release of the MA PDU session. The
UE is marked as inactive in the AMF for 5GS services for non-3GPP access. The
AMF shall enter the state 5GMM-DEREGISTERED over non-3GPP access.
If the de-registration request is not due to switch off, the UE shall:
a) if the de-registration procedure was performed due to disabling of 5GS
services, enter the 5GMM-NULL state for non-3GPP access;
b) otherwise, enter the 5GMM-DEREGISTERED state for non-3GPP access.
NOTE: Case b) is applicable when the UE is also registered over 3GPP access.
##### 5.5.2.2.5 UE-initiated de-registration procedure completion for 5GS
services over both 3GPP access and non-3GPP access
If the access type in the DEREGISTRATION REQUEST indicates that the de-
registration procedure is for both 3GPP access and non-3GPP access when the UE
is registered in the same PLMN over both accesses, the descriptions for UE-
initiated de-registration procedure completion for 5GS services over 3GPP
access and over non-3GPP access, as specified in subclauses 5.5.2.2.3 and
5.5.2.2.4, shall be followed.
##### 5.5.2.2.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Lower layer failure or release of the N1 NAS signalling connection before
reception of DEREGISTRATION ACCEPT message.
The de-registration procedure shall be aborted and the UE proceeds as follows:
1) if the de-registration procedure was performed due to disabling of 5GS
services, the UE shall enter the 5GMM-NULL state; or
2) if the de-registration type \"normal de-registration\" was requested for
reasons other than disabling of 5GS services, the UE shall enter the 5GMM-
DEREGISTERED state.
b) The lower layers indicate that the access attempt is barred.
The UE shall not start the de-registration signalling procedure. The UE stays
in the current serving cell and applies the normal cell reselection process.
Receipt of the access barred indication shall not trigger the selection of a
different core network type (EPC or 5GCN).
The UE may perform a local de-registration either immediately or after an
implementation-dependent time.
The de-registration signalling procedure is started, if still needed, when the
lower layers indicate that the barring is alleviated for the access category
with which the access attempt was associated.
ba) The lower layers indicate that:
1) access barring is applicable for all access categories except categories 0
and 2 and the access category with which the access attempt was associated is
other than 0 and 2; or
2) access barring is applicable for all access categories except category 0
and the access category with which the access attempt was associated is other
than 0.
If the DEREGISTRATION REQUEST message has not been sent, the UE shall proceed
as specified for case b. If the DEREGISTRATION REQUEST message has been sent,
the UE shall proceed as specified for case a.
c) T3521 timeout.
If the de-registration procedure was performed based on conditions specified
in 3GPP TS 23.122 [5] annex C, on the expiry of timer T3521 the de-
registration procedure shall be aborted and the UE shall locally release the
established N1 NAS signalling connection and enter the 5GMM-DEREGISTERED
state.
Otherwise, on the first four expiries of the timer, the UE shall retransmit
the DEREGISTRATION REQUEST message and shall reset and restart timer T3521. On
the fifth expiry of timer T3521, the de-registration procedure shall be
aborted and the UE proceeds as follows:
1) if the de-registration procedure was performed due to disabling of 5GS
services, the UE shall enter the 5GMM-NULL state; or
2) if the de-registration type \"normal de-registration\" was requested for
reasons other than disabling of 5GS services, the UE shall enter the 5GMM-
DEREGISTERED state.
d) De-registration procedure collision.
De-registration containing de-registration type \"switch off\":
\- If the UE receives a DEREGISTRATION REQUEST message before the UE-initiated
de-registration procedure has been completed, this message shall be ignored
and the UE-initiated de-registration procedure shall continue.
Otherwise:
\- If the UE receives a DEREGISTRATION REQUEST message before the UE-initiated
de-registration procedure has been completed, it shall treat the message as
specified in subclause 5.5.2.3.2 with the following modification:
\- If the DEREGISTRATION REQUEST message received by the UE contains de-
registration type \"re-registration required\", and the UE-initiated de-
registration procedure is with de-registration type \"normal de-
registration\", the UE need not initiate the registration procedure for
initial registration.
e) De-registration and 5GMM common procedure collision.
De-registration containing de-registration type \"switch off\":
\- If the UE receives a message used in a 5GMM common procedure before the de-
registration procedure has been completed, this message shall be ignored and
the de-registration procedure shall continue.
Otherwise:
\- If the UE receives a message used in a 5GMM common procedure before the de-
registration procedure has been completed, both the 5GMM common procedure and
the de-registration procedure shall continue; or
\- If the UE receives a DL NAS TRANSPORT message containing payload container
type \"Service-level-AA container\" before the de-registration procedure has
been completed, this message shall be ignored and the de-registration
procedure shall continue.
f) Change in the current TAI.
If that the current TAI is not in the stored TAI list before the UE-initiated
de-registration procedure is completed, the UE proceeds as follows:
1) if the de-registration procedure was initiated for reasons other than
removal of the USIM, the UE is to be switched off or due to the last Tsor-cm
timer expiry or stopped (see 3GPP TS 23.122 [5]), the de-registration
procedure shall be aborted and re-initiated after successfully performing a
registration procedure for mobility or periodic update used for mobility (i.e.
the 5GS registration type IE set to \"mobility registration updating\" in the
REGISTRATION REQUEST message); or
2) if the de-registration procedure was initiated due to removal of the USIM
or the UE is to be switched off or due to the last Tsor-cm timer expiry or
stopped (see 3GPP TS 23.122 [5]), the UE shall abort the de-registration
procedure, perform a local de-registration and enter the state 5GMM-
DEREGISTERED.
g) Transmission failure of DEREGISTRATION REQUEST message indication with
change in the current TAI.
If the current TAI is not in the TAI list, the UE proceeds as follows:
1) if the de-registration procedure was initiated for reasons other than
removal of the USIM ,the UE is to be switched off or due to the last Tsor-cm
timer expiry or stopped (see 3GPP TS 23.122 [5]), the de-registration
procedure shall be aborted and re-initiated after successfully performing a
registration procedure for mobility or periodic update; or
2) if the de-registration procedure was initiated due to removal of the USIM
or the UE is to be switched off or due to the last Tsor-cm timer expiry or
stopped (see 3GPP TS 23.122 [5]), the UE shall abort the de-registration
procedure, perform a local de-registration and enter the state 5GMM-
DEREGISTERED.
If the current TAI is still part of the TAI list, the UE shall restart the de-
registration procedure.
h) Transmission failure of DEREGISTRATION REQUEST message indication without
change in the current TAI.
The UE shall restart the de-registration procedure.
i) The lower layers indicate that the RRC connection has been suspended.
De-registration containing de-registration type \"switch off\":
\- The UE may perform a local de-registration either immediately or after an
implementation-dependent time.
Otherwise:
\- The UE shall wait for an implementation-dependent time and shall restart
the de-registration procedure, if still needed, upon expiry of the
implementation-dependent time.
For the cases a, f, g and i:
\- Timer T3521 shall be stopped if still running.
##### 5.5.2.2.7 Abnormal cases in the network side
The following abnormal cases can be identified:
a) De-registration request received in a cell belonging to an SNPN with a non-
globally-unique SNPN identity for which the UE has no valid subscription
If the UE initiates a de-registration procedure in a cell belonging to an SNPN
with a non-globally-unique SNPN identity for which the UE has no valid
subscription, and the de-registration procedure is not due to \"switch off\",
the network shall initiate the de-registration procedure. The AMF shall send a
DEREGISTRATION REQUEST message including the 5GMM cause #74 \"Temporarily not
authorized for this SNPN\".
b) De-registration request received in a cell belonging to an SNPN with a
globally-unique SNPN identity for which the UE has no valid subscription
If the UE initiates a de-registration procedure in a cell belonging to an SNPN
with a globally-unique SNPN identity for which the UE has no valid
subscription, and the de-registration procedure is not due to \"switch off\",
the network shall initiate the de-registration procedure. The AMF shall send a
DEREGISTRATION REQUEST message including the 5GMM cause #75 \"Permanently not
authorized for this SNPN\".
c) De-registration request received in a CAG cell and none of the CAG ID
broadcasted by the CAG cell is included in the UE\'s \"allowed CAG list\" for
the current PLMN
If the UE initiates a de-registration procedure in a CAG cell and none of the
CAG ID broadcasted by the CAG cell is included in the UE\'s \"allowed CAG
list\" for the current PLMN and the de-registration procedure is not due to
\"switch off\", the AMF shall initiate the de-registration procedure. The AMF
shall send a DEREGISTRATION REQUEST message including the 5GMM cause #76 \"Not
authorized for this CAG or authorized for CAG cells only\" if the UE supports
CAG. Otherwise, the network shall operate as described in bullet g) of
subclause 5.5.2.3.5.
d) De-registration request received in a non-CAG cell from a UE whose \"CAG
information list\" includes an entry associated with the current PLMN, where
the entry contains an \"indication that the UE is only allowed to access 5GS
via CAG cells\"
If the UE initiates a de-registration procedure in a non-CAG cell from a UE
whose \"CAG information list\" includes an entry associated with the current
PLMN, where the entry contains an \"indication that the UE is only allowed to
access 5GS via CAG cells\" and the de-registration procedure is not due to
\"switch off\", the AMF shall initiate the de-registration procedure. The AMF
shall send a DEREGISTRATION REQUEST message including the 5GMM cause #76 \"Not
authorized for this CAG or authorized for CAG cells only\" if the UE supports
CAG. Otherwise, the network shall operate as described in bullet g) of
subclause 5.5.2.3.5.
e) De-registration and registration procedure for initial registration
collision
If the network receives a REGISTRATION REQUEST message indicating either
\"initial registration\" or \"emergency registration\" in the 5GS registration
type IE from the UE before the UE-initiated de-registration procedure, which
is not due to switch off, has been completed, the network shall abort the de-
registration procedure and the registration procedure shall be progressed.
#### 5.5.2.3 Network-initiated de-registration procedure
##### 5.5.2.3.1 Network-initiated de-registration procedure initiation
The network initiates the de-registration procedure by sending a
DEREGISTRATION REQUEST message to the UE (see example in figure 5.5.2.3.1.1).
NOTE 1: If the AMF performs a local de-registration, it will inform the UE
with a 5GMM messages (e.g. SERVICE REJECT message or REGISTRATION REJECT
message) with 5GMM cause #10 \"implicitly de-registered\" only when the UE
initiates a 5GMM procedure.
The network may include a 5GMM cause IE to specify the reason for the
DEREGISTRATION REQUEST message. The network shall start timer T3522. The
network shall indicate whether re-registration is needed or not in the De-
registration type IE. The network shall also indicate via the access type
whether the de-registration procedure is:
a) for 3GPP access only;
b) for non-3GPP access only; or
c) for 3GPP access, non-3GPP access or both when the UE is registered in the
same PLMN for both accesses.
If the network de-registration is triggered due to network slice-specific
authentication and authorization failure or revocation as specified in
subclause 4.6.2.4, then the network shall set the 5GMM cause value to #62 \"No
network slices available\" in the DEREGISTRATION REQUEST message. In addition,
if the UE supports extended rejected NSSAI, the AMF shall include the Extended
rejected NSSAI IE in the DEREGISTRATION REQUEST message; otherwise the AMF
shall include the Rejected NSSAI IE in the DEREGISTRATION REQUEST message.
If the UE supports extended rejected NSSAI and the network de-registration is
triggered due to mobility management based network slice admission control as
specified in subclause 4.6.2.5, then the network shall set the 5GMM cause
value to #62 \"No network slices available\" in the DEREGISTRATION REQUEST
message. In addition, the network may include a back-off timer value for each
S-NSSAI with the rejection cause \"S-NSSAI not available due to maximum number
of UEs reached\" in the Extended rejected NSSAI IE of the DEREGISTRATION
REQUEST message.
If the network de-registration is triggered for a UE supporting CAG due to CAG
restrictions, the network shall set the 5GMM cause value to #76 \"Not
authorized for this CAG or authorized for CAG cells only\" and should include
the \"CAG information list\" in the CAG information list IE or the Extended
CAG information list IE in the DEREGISTRATION REQUEST message.
NOTE 2: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the network de-registration is triggered for a UE not supporting CAG due to
CAG restrictions, the network shall operate as described in bullet g) of
subclause 5.5.2.3.5.
If the network de-registration is triggered because the network determines
that the UE is in a location where the network is not allowed to operate, see
3GPP TS 23.502 [9], the network shall set the 5GMM cause value in the
DEREGISTRATION REQUEST message to #78 \"PLMN not allowed to operate at the
present UE location\".
If the network de-registration is triggered due to:
a) an unsuccessful outcome of an ongoing UUAA-MM procedure;
b) an UUAA revocation notification received from the UAS-NF for a UE
supporting UAS service requesting UAS services; or
c) the UE not allowed to use UAS services via 5GS due to a change of the
aerial UE subscription information,
then the network shall set the 5GMM cause value in the DEREGISTRATION REQUEST
message to #79 \"UAS services not allowed\".
NOTE 3: If the UE supporting UAS service has requested other services than UAS
services, or if there are other ongoing network slice-specific authentication
and authorization on pending NSSAIs, it is then an operator policy or
configuration decision whether to keep the UE supporting UAS service
registered to the network, but that UE supporting UAS services is not allowed
to access UAS services via 5GS as specified in 3GPP TS 23.256 [6AB].
If the network de-registration is triggered for a UE supporting MINT due to a
disaster condition no longer being applicable in the current location of the
UE, the network shall set the 5GMM cause value to #11 \"PLMN not allowed\" and
may include a disaster return wait range in the Disaster return wait range IE
in the DEREGISTRATION REQUEST message.
If the network de-registration is triggered because the AMF determines that,
by UE subscription and operator\'s preferences, all of the TAIs received from
the satellite NG-RAN are forbidden for roaming or for regional provision of
service, the AMF shall include the TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE; or
c) both;
in the DEREGISTRATION REQUEST message.
If the network de-registration is triggered because the AMF determines that
the UE operating as an IAB-node by subscription is not authorized for IAB-node
operation, the AMF shall set the 5GMM cause value to #36 \"IAB-node operation
not authorized\" in the DEREGISTRATION REQUEST message.
The AMF shall trigger the SMF to release locally the PDU session(s) over the
indicated access(es), if any, for the UE and enter state 5GMM-DEREGISTERED-
INITIATED. If a PDU session is associated with one or more multicast MBS
sessions, the SMF shall consider the UE as removed from the associated
multicast MBS sessions.
Figure 5.5.2.3.1.1: Network-initiated de-registration procedure
##### 5.5.2.3.2 Network-initiated de-registration procedure completion by the
UE
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message indicates \"re-registration required\" and the de-registration
request is for 3GPP access, the UE shall perform a local release of the PDU
sessions over 3GPP access, if any. If a PDU session is associated with one or
more multicast MBS sessions, the UE shall locally leave the associated
multicast MBS sessions. If there is an MA PDU session with user plane
resources established on both 3GPP access and non-3GPP access in the same PLMN
or in different PLMNs, the UE shall perform a local release of the user plane
resources on 3GPP access. If there is an MA PDU session with user plane
resources established on 3GPP access only, the UE shall perform a local
release of the MA PDU session. If the MA PDU session is associated with one or
more multicast MBS sessions, the UE shall locally leave the associated
multicast MBS sessions. The UE shall stop the timer(s) T3346, T3396, T3584,
T3585 and 5GSM back-off timer(s) not related to congestion control (see
subclause 6.2.12), if running. If the UE is operating in single-registration
mode, the UE shall also stop the ESM back-off timer(s) not related to
congestion control (see subclause 6.3.6 in 3GPP TS 24.301 [15]), if running.
The UE shall send a DEREGISTRATION ACCEPT message to the network and enter the
state 5GMM-DEREGISTERED for 3GPP access. Furthermore, the UE shall, after the
completion of the de-registration procedure, and the release of the existing
NAS signalling connection, if any Tsor-cm timer(s) were running and have
stopped, the UE shall attempt to obtain service on a higher priority PLMN (see
3GPP TS 23.122 [5]) on 3GPP access, otherwise initiate an initial
registration. The UE should also re-establish any previously established PDU
sessions over 3GPP access. For any previously established MA PDU sessions with
user plane resources established on both accesses the UE should also re-
establish the user plane resources over 3GPP access, and for any previously
established MA PDU sessions with user plane resources established only on the
3GPP access the UE should re-establish the MA PDU session over 3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message indicates \"re-registration required\" and the de-registration
request is for non-3GPP access, the UE shall perform a local release of the
PDU sessions over non-3GPP access, if any. If there is an MA PDU session with
user plane resources established on both 3GPP access and non-3GPP access in
the same PLMN or in different PLMNs, the UE shall perform a local release of
the user plane resources on non-3GPP access. If there is an MA PDU session
with a PDN connection as a user-plane resource and user plane resources
established on non-3GPP access, the UE shall perform a local release of the
user plane resources on non-3GPP access. If there is an MA PDU session with
user plane resources established on non-3GPP access only, the UE shall perform
a local release of the MA PDU session. The UE shall stop the timer(s) T3346,
T3396, T3584 and T3585, if it is running. The UE shall send a DEREGISTRATION
ACCEPT message to the network and enter the state 5GMM-DEREGISTERED for
non-3GPP access. Furthermore, the UE shall, after the completion of the de-
registration procedure, and the release of the existing NAS signalling
connection, initiate an initial registration over non-3GPP. The UE should also
re-establish any previously established PDU sessions over non-3GPP access. For
any previously established MA PDU sessions with user plane resources
established on both accesses the UE should also re-establish the user plane
resources over non-3GPP access, and for any previously established MA PDU
sessions with user plane resources established only on the non-3GPP access the
UE should re-establish the MA PDU session over non-3GPP access, and for any
previously established MA PDU sessions with a PDN connection as a user-plane
resource and user plane resources established on non-3GPP access the UE should
re-establish the user plane resources over non-3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message indicates \"re-registration required\" and the de-registration
request is for both 3GPP access and non-3GPP access when the UE is registered
in the same PLMN for both accesses, the UE shall perform a local release of
the MA PDU sessions and PDU sessions over both 3GPP access and non-3GPP
access, if any. If an MA PDU session or a PDU sessions is associated with one
or more multicast MBS sessions, the UE shall locally leave the associated
multicast MBS sessions. The UE shall stop the timer(s) T3346, T3396, T3584 and
T3585, if it is running. The UE shall send a DEREGISTRATION ACCEPT message to
the network and enter the state 5GMM-DEREGISTERED for both 3GPP access and
non-3GPP access. Furthermore, the UE shall, after the completion of the de-
registration procedure, and the release of the existing NAS signalling
connection, if any Tsor-cm timer(s) were running and have stopped, the UE
shall attempt to obtain service on a higher priority PLMN (see 3GPP TS 23.122
[5]) on 3GPP access, otherwise initiate an initial registration over both 3GPP
access and non-3GPP access. The UE should also re-establish any previously
established PDU sessions over both 3GPP access and non-3GPP access. For any
previously established MA PDU sessions the UE should also re-establish the MA
PDU session and the user plane resources which were established previously.
NOTE 1: When the de-registration type indicates \"re-registration required\",
user interaction is necessary in some cases when the UE cannot re-establish
the PDU session (s), if any, automatically.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message indicates \"re-registration not required\" and the de-
registration request is for 3GPP access, the UE shall perform a local release
of the PDU sessions over 3GPP access, if any. If a PDU session is associated
with one or more multicast MBS sessions, the UE shall locally leave the
associated multicast MBS sessions. If there is an MA PDU session with user
plane resources established on both 3GPP access and non-3GPP access in the
same PLMN or in different PLMNs, the UE shall perform a local release of the
user plane resources on 3GPP access. If there is an MA PDU session with user
plane resources established on 3GPP access only, the UE shall perform a local
release of the MA PDU session. If the MA PDU session is associated with one or
more multicast MBS sessions, the UE shall locally leave the associated
multicast MBS sessions. The UE shall send a DEREGISTRATION ACCEPT message to
the network and enter the state 5GMM-DEREGISTERED for 3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message indicates \"re-registration not required\" and the de-
registration request is for non-3GPP access, the UE shall perform a local
release of the PDU sessions over non-3GPP access, if any. If there is an MA
PDU session with user plane resources established on both 3GPP access and
non-3GPP access in the same PLMN or in different PLMNs, the UE shall perform a
local release of the user plane resources on non-3GPP access. If there is an
MA PDU session with a PDN connection as a user-plane resource and user plane
resources established on non-3GPP access, the UE shall perform a local release
of the user plane resources on non-3GPP access. If there is an MA PDU session
with user plane resources established on non-3GPP access only, the UE shall
perform a local release of the MA PDU session. The UE shall send a
DEREGISTRATION ACCEPT message to the network and enter the state 5GMM-
DEREGISTERED for non-3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message indicates \"re-registration not required\" and the de-
registration request is for both 3GPP access and non-3GPP access when the UE
is registered in the same PLMN for both accesses, the UE shall perform a local
release of the MA PDU sessions and PDU sessions over both 3GPP access and
non-3GPP access, if any. If an MA PDU session or a PDU session is associated
with one or more multicast MBS sessions, the UE shall locally leave the
associated multicast MBS sessions. The UE shall send a DEREGISTRATION ACCEPT
message to the network and enter the state 5GMM-DEREGISTERED for both 3GPP
access and non-3GPP access.
Upon receiving the DEREGISTRATION REQUEST message, if the DEREGISTRATION
REQUEST message includes the rejected NSSAI, the UE takes the following
actions based on the rejection cause in the rejected S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
current PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN until switching off the UE,
the UICC containing the USIM is removed, or the rejected S-NSSAI(s) are
removed as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
current registration area as described in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI(s) in the current registration area until
switching off the UE, the UE moving out of the current registration area, the
UICC containing the USIM is removed, an entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI in the current PLMN or SNPN over any access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed or deleted as described in
subclause 4.6.1 and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
If there is one or more S-NSSAIs in the rejected NSSAI with the rejection
cause \"S-NSSAI not available due to maximum number of UEs reached\", then for
each S-NSSAI, the UE shall behave as follows:
a) stop the timer T3526 associated with the S-NSSAI, if running;
b) start the timer T3526 with:
1) the back-off timer value received along with the S-NSSAI, if a back-off
timer value is received along with the S-NSSAI that is neither zero nor
deactivated; or
2) an implementation specific back-off timer value, if no back-off timer value
is received along with the S-NSSAI; and
c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs
reached when the timer T3526 associated with the S-NSSAI expires.
Upon sending a DEREGISTRATION ACCEPT message, the UE shall delete the rejected
NSSAI as specified in subclause 4.6.2.2.
Regardless of the 5GMM cause value received in the DEREGISTRATION REQUEST
message via satellite NG-RAN,
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the DEREGISTRATION REQUEST message and if
the TAI(s) included in the IE is not part of the list of \"5GS forbidden
tracking areas for roaming\", the UE shall store the TAI(s) included in the
IE, if not already stored, into the list of \"5GS forbidden tracking areas for
roaming\"; and
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the DEREGISTRATION
REQUEST message and if the TAI(s) included in the IE is not part of the list
of \"5GS forbidden tracking areas for regional provision of service\", the UE
shall store the TAI(s) included in the IE, if not already stored, into the
list of \"5GS forbidden tracking areas for regional provision of service\".
If the de-registration type indicates \"re-registration required\", then the
UE shall ignore the 5GMM cause IE if received.
If the de-registration type indicates \"re-registration not required\", the UE
shall take the actions depending on the received 5GMM cause value:
#3 (Illegal UE);
#6 (Illegal ME)
The message was received via 3GPP access and the UE shall set the 5GS update
status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause
5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list
and ngKSI.
\- In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not registered for onboarding services in SNPN
and the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall consider the entry of the \"list of
subscriber data\" with the SNPN identity of the current SNPN as invalid until
the UE is switched off, the entry is updated or the timer T3245 expires as
described in clause 5.3.19a.2. In case of SNPN, if the UE supports access to
an SNPN using credentials from a credentials holder, the UE shall consider the
selected entry of the \"list of subscriber data\" as invalid for 3GPP access
until the UE is switched off, the entry is updated or the timer T3245 expires
as described in clause 5.3.19a.2. Additionally, if EAP based primary
authentication and key agreement procedure using EAP-AKA\' or 5G AKA based
primary authentication and key agreement procedure was performed in the
current SNPN, the UE shall consider the USIM as invalid for the current SNPN
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not registered for onboarding services in SNPN, the UE shall
delete the list of equivalent PLMNs (if any) and shall enter the state 5GMM-
DEREGISTERED.NO-SUPI.
If the UE is not registered for onboarding services in SNPN, the UE shall
delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the UE is operating in single-registration mode, the UE shall handle the
EMM parameters EMM state, EPS update status, 4G-GUTI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when a DETACH REQUEST is
received with the EMM cause with the same value and with detach type set to
\"re-attach not required\". The USIM shall be considered as invalid also for
non-EPS services until switching off or the UICC containing the USIM is
removed or the timer T3245 expires as described in clause 5.3.7a in 3GPP TS
24.301 [15].
If the UE is registered for onboarding services in SNPN, the UE shall reset
the registration attempt counter, store the SNPN identity in the \"permanently
forbidden SNPNs\" list for onboarding services, enter state 5GMM-
DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5].
If the UE also supports the registration procedure over the other access, the
UE shall in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not registered for onboarding services in SNPN
and the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall consider the entry of the \"list of
subscriber data\" with the SNPN identity of the current SNPN as invalid for
5GS services until the UE is switched off, or the entry is updated or the
timer T3245 expires as described in clause 5.3.19a.2. In case of SNPN, if the
UE is not registered for onboarding services in SNPN and the UE supports
access to an SNPN using credentials from a credentials holder, the UE shall
consider the selected entry of the \"list of subscriber data\" as invalid for
3GPP access until the UE is switched off, the entry is updated or the timer
T3245 expires as described in clause 5.3.19a.2. Additionally, if EAP based
primary authentication and key agreement procedure using EAP-AKA\' or 5G AKA
based primary authentication and key agreement procedure was performed in the
current SNPN, the UE shall consider the USIM as invalid for the current SNPN
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not registered for onboarding services in SNPN, the UE shall
enter the state 5GMM-DEREGISTERED.NO-SUPI.
If the UE is not registered for onboarding services in SNPN, the UE shall
delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when a DETACH REQUEST is
received with the EMM cause with the same value and with detach type set to
\"re-attach not required\".
If the UE is registered for onboarding services in SNPN, the UE shall reset
the registration attempt counter, store the SNPN identity in the \"permanently
forbidden SNPNs\" list for onboarding services, enter state 5GMM-
DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5].
If the UE also supports the registration procedure over the other access, the
UE shall in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#11 (PLMN not allowed).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.2.3.4.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs, shall reset the registration attempt counter. For 3GPP
access the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH, and for
non-3GPP access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE.
The UE shall store the PLMN identity in the forbidden PLMN list as specified
in subclause 5.3.13A and if the UE is configured to use timer T3245 then the
UE shall start timer T3245 and proceed as described in clause 5.3.19a.1.
For 3GPP access the UE shall perform a PLMN selection according to 3GPP TS
23.122 [5], and for non-3GPP access the UE shall perform network selection as
defined in 3GPP TS 24.502 [18].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when a DETACH
REQUEST is received with the EMM cause with the same value and with detach
type set to \"re-attach not required\".
If the UE also supports the registration procedure over the other access to
the same PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state
for this access, as described for this 5GMM cause value.
If the UE receives the Disaster return wait range IE in the DEREGISTRATION
REQUEST message and the UE supports MINT, the UE shall delete the disaster
return wait range stored in the ME, if any, and store the disaster return wait
range included in the Disaster return wait range IE in the ME.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and shall enter the state 5GMM-
DEREGISTERED.LIMITED-SERVICE.
If the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\". Otherwise, the UE shall store the current TAI in the
list of \"5GS forbidden tracking areas for regional provision of service\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters, EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when a DETACH
REQUEST is received with the EMM cause with the same value and with detach
type set to \"re-attach not required\".
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs (if available), reset the registration attempt counter. For
3GPP access the UE shall change to state 5GMM-DEREGISTERED.PLMN-SEARCH, and
for non-3GPP access the UE shall change to state 5GMM-DEREGISTERED.LIMITED-
SERVICE.
If the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\".
Otherwise, the UE shall store the current TAI in the list of \"5GS forbidden
tracking areas for roaming\" for the current SNPN and, if the UE supports
access to an SNPN using credentials from a credentials holder, the selected
entry of the \"list of subscriber data\" or the selected PLMN subscription.
For 3GPP access the UE shall perform a PLMN selection or SNPN selection
according to 3GPP TS 23.122 [5], and for non-3GPP access the UE shall perform
network selection as defined in 3GPP TS 24.502 [18].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when a DETACH
REQUEST is received with the EMM cause with the same value and with detach
type set to \"re-attach not required\".
#15 (No suitable cells in tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and shall enter the state 5GMM-
DEREGISTERED.LIMITED-SERVICE.
If the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\".
Otherwise the UE shall store the current TAI in the list of \"5GS forbidden
tracking areas for roaming\" for the current SNPN and, if the UE supports
access to an SNPN using credentials from a credentials holder, the selected
entry of the \"list of subscriber data\" or the selected PLMN subscription.
The UE shall search for a suitable cell in another tracking area according to
3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when a DETACH
REQUEST is received with the EMM cause with the same value and with detach
type set to \"re-attach not required\".
If received over non-3GPP access and de-registration request is for non-3GPP
access only, the cause shall be considered as an abnormal case and the
behaviour of the UE for this case is specified in subclause 5.5.2.3.4.
#22 (Congestion).
If the T3346 value IE is present in the DEREGISTRATION REQUEST message and the
value indicates that this timer is neither zero nor deactivated, the UE shall
proceed as described below, otherwise it shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.5.2.3.4.
The UE shall stop timer T3346 if it is running, set the 5GS update status to
5U2 NOT UPDATED, reset the registration attempt counter and enter the state
5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION.
The UE shall start timer T3346 with the value provided in the T3346 value IE.
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall set the EPS update status to EU2 NOT
UPDATED, reset the attach attempt counter and shall enter the state EMM-
DEREGISTERED.
#27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter and shall enter the state 5GMM-
DEREGISTERED.LIMITED-SERVICE.
The UE shall disable the N1 mode capability for both 3GPP access and non-3GPP
access (see subclause 4.9).
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI,
TAI list and eKSI. Additionally, the UE shall reset the attach attempt counter
and enter the state EMM-DEREGISTERED.
#36 (IAB-node operation not authorized).
This cause value is only applicable when received over 3GPP access by a UE
operating as an IAB-node. This cause value received from a 5G access network
other than 3GPP access or received by a UE not operating as an IAB-node is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.5.2.3.4.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
If:
1) the UE is not operating in SNPN access operation mode,
i) the UE shall delete the list of equivalent PLMNs and reset the registration
attempt counter and store the PLMN identity in the forbidden PLMN list as
specified in subclause 5.3.13A and if the UE is configured to use timer T3245
then the UE shall start timer T3245 and proceed as described in clause
5.3.19a.1. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform
a PLMN selection according to 3GPP TS 23.122 [5]; and
ii) If the UE is operating in single-registration mode, the UE shall in
addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last
visited registered TAI, TAI list, eKSI and attach attempt counter as specified
in 3GPP TS 24.301 [15] for the case when DETACH REQUEST is received with the
EMM cause with the same value and with detach type set to \"re-attach not
required\"; or
2) the UE is operating in SNPN access operation mode,
i) the UE shall reset the registration attempt counter and store the SNPN
identity in the \"temporarily forbidden SNPNs\" list for 3GPP access. The UE
shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection
according to 3GPP TS 23.122 [5].
#62 (No network slices available).
The UE shall set the 5GS update status to 5U2 NOT UPDATED and enter state
5GMM-DEREGISTERED.NORMAL-SERVICE or 5GMM-DEREGISTERED.PLMN-SEARCH.
Additionally, the UE shall reset the registration attempt counter.
The UE receiving the rejected NSSAI in the DEREGISTRATION REQUEST message
takes the following actions based on the rejection cause in the rejected
S-NSSAI(s):
\"S-NSSAI not available in the current PLMN or SNPN\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
current PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI(s) in the current PLMN or SNPN until switching off the UE,
the UICC containing the USIM is removed, an entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available in the current registration area\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
current registration area as described in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI(s) in the current registration area until
switching off the UE, the UE moving out of the current registration area, the
UICC containing the USIM is removed, the entry of the \"list of subscriber
data\" with the SNPN identity of the current SNPN is updated, or the rejected
S-NSSAI(s) are removed or deleted as described in subclause 4.6.2.2.
\"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\"
The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the
failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not
attempt to use this S-NSSAI in the current PLMN or SNPN over any access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed or deleted as described in
subclause 4.6.1 and 4.6.2.2.
\"S-NSSAI not available due to maximum number of UEs reached\"
The UE shall add the rejected S-NSSAI(s) in the rejected NSSAI for the maximum
number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt
to use this S-NSSAI in the current PLMN or SNPN over the current access until
switching off the UE, the UICC containing the USIM is removed, the entry of
the \"list of subscriber data\" with the SNPN identity of the current SNPN is
updated, or the rejected S-NSSAI(s) are removed as described in subclause
4.6.2.2.
If the UE has an allowed NSSAI or configured NSSAI that contains S-NSSAI(s)
which are not included in the rejected NSSAI, the UE may stay in the current
serving cell, apply the normal cell reselection process and start an initial
registration with a requested NSSAI that includes any S-NSSAI from the allowed
NSSAI or the configured NSSAI that is not in the rejected NSSAI. Otherwise the
UE may perform a PLMN selection or SNPN selection according to 3GPP TS 23.122
[5] and additionally, the UE may disable the N1 mode capability for the
current PLMN or SNPN if the UE does not have an allowed NSSAI and each S-NSSAI
in configured NSSAI, if available, was rejected with cause \"S-NSSAI not
available in the current PLMN or SNPN\" or \"S-NSSAI not available due to the
failed or revoked network slice-specific authentication and authorization\" or
\"S-NSSAI not available due to maximum number of UEs reached\" as described in
subclause 4.9.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and,
1) if at least one S-NSSAI in the default configured NSSAI is not rejected,
the UE may stay in the current serving cell, apply the normal cell reselection
process, and start an initial registration with a requested NSSAI with that
default configured NSSAI; or
2) if all the S-NSSAI(s) in the default configured NSSAI are rejected and at
least one S-NSSAI is rejected due to \"S-NSSAI not available in the current
registration area\",
i) if the UE is not operating in SNPN access operation mode, the UE shall
store the current TAI in the list of \"5GS forbidden tracking areas for
roaming\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; or
ii) if the UE is operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
for the current SNPN and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.
Otherwise, the UE may perform a PLMN selection or SNPN selection according to
3GPP TS 23.122 [5] and additionally, the UE may disable the N1 mode capability
for the current PLMN or SNPN if each S-NSSAI in the default configured NSSAI
was rejected with cause \"S-NSSAI not available in the current PLMN or SNPN\"
or \"S-NSSAI not available due to the failed or revoked network slice-specific
authentication and authorization\" as described in subclause 4.9.
If the UE has neither allowed NSSAI for the current PLMN or SNPN nor
configured NSSAI for the current PLMN or SNPN and has rejected NSSAI for the
reached maximum number of UEs, and the UE wants to obtain services in the
current serving cell without performing a PLMN selection or SNPN selection,
the UE may stay in the current serving cell and attempt to use the rejected
S-NSSAI(s) for the maximum number of UEs reached in the current serving cell
after the rejected S-NSSAI(s) are removed as described in subclause 4.6.2.2.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
#72 (Non-3GPP access to 5GCN not allowed).
If received over non-3GPP access when the UE is registered over non-3GPP
access, or received over 3GPP access and de-registration request is for
non-3GPP access when the UE is registered in the same PLMN for both accesses,
the UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI for non-3GPP access. Additionally,
the UE shall reset the registration attempt counter and enter the state 5GMM-
DEREGISTERED for non-3GPP access.
NOTE 2: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause
4.9.3).
As an implementation option, if the UE is not currently registered over 3GPP
access, the UE may enter the state 5GMM-DEREGISTERED.PLMN-SEARCH in order to
perform a PLMN selection according to 3GPP TS 23.122 [5].
If received over 3GPP access and de-registration request is for 3GPP access
only, the cause shall be considered as an abnormal case and the behaviour of
the UE for this case is specified in subclause 5.5.2.3.4.
#74 (Temporarily not authorized for this SNPN).
5GMM cause #74 is only applicable when received from a cell belonging to an
SNPN. 5GMM cause #74 received from a cell not belonging to an SNPN is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.5.2.3.4.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and shall store the SNPN identity in the
\"temporarily forbidden SNPNs\" list for the specific access type for which
the message was received and, if the UE supports access to an SNPN using
credentials from a credentials holder, the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription. If the UE is not
registered for onboarding services in SNPN, the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP TS
23.122 [5]. If the UE is registered for onboarding services in SNPN, the UE
shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection
or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].
#75 (Permanently not authorized for this SNPN).
5GMM cause #75 is only applicable when received from a cell belonging to an
SNPN with a globally-unique SNPN identity. 5GMM cause #75 received from a cell
not belonging to an SNPN or a cell belonging to an SNPN with a non-globally-
unique SNPN identity is considered as an abnormal case and the behaviour of
the UE is specified in subclause 5.5.2.3.4.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall reset the
registration attempt counter and store the SNPN identity in the \"permanently
forbidden SNPNs\" list for the specific access type for which the message was
received and, if the UE supports access to an SNPN using credentials from a
credentials holder, the selected entry of the \"list of subscriber data\" or
the selected PLMN subscription. If the UE is not registered for onboarding
services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and
perform an SNPN selection according to 3GPP TS 23.122 [5]. If the UE is
registered for onboarding services in SNPN, the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN selection
for onboarding services according to 3GPP TS 23.122 [5].
#76 (Not authorized for this CAG or authorized for CAG cells only).
This cause value received via non-3GPP access or from a cell belonging to an
SNPN is considered as an abnormal case and the behaviour of the UE is
specified in subclause 5.5.2.3.4.
The UE shall set the 5GS update status to 5U3.ROAMING NOT ALLOWED, store the
5GS update status according to clause 5.1.3.2.2, and reset the registration
attempt counter.
If 5GMM cause #76 is received from:
1) a CAG cell, and if the UE receives a \"CAG information list\" in the CAG
information list IE or the Extended CAG information list IE included in the
DEREGISTRATION REQUEST message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 3: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall delete the CAG-ID(s) of the cell from the \"allowed
CAG list\" for the current PLMN. In the case the \"allowed CAG list\" for the
current PLMN only contains a range of CAG-IDs, how the UE deletes the CAG-
ID(s) of the cell from the \"allowed CAG list\" for the current PLMN is up to
UE implementation. In addition:
i) if the entry in the \"CAG information list\" for the current PLMN does not
include an \"indication that the UE is only allowed to access 5GS via CAG
cells\" or if the entry in the \"CAG information list\" for the current PLMN
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and the updated \"allowed CAG list\" for the current PLMN includes one
or more CAG-IDs, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-
SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28]
or 3GPP TS 36.304 [25C] with the updated \"CAG information list\"; or
ii) if the entry in the \"CAG information list\" for the current PLMN includes
an \"indication that the UE is only allowed to access 5GS via CAG cells\" and
the updated \"allowed CAG list\" for the current PLMN does not include any
CAG-ID, then the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH and
shall apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\".
2) a non-CAG cell, and if the UE receives a \"CAG information list\" in the
CAG information list IE or the Extended CAG information list IE included in
the DEREGISTRATION REQUEST message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received CAG
information list IE or the Extended CAG information list IE when received in
the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 4: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall store an \"indication that the UE is only allowed to
access 5GS via CAG cells\" in the entry of the \"CAG information list\" for
the current PLMN, if any. If the \"CAG information list\" stored in the UE
does not include the current PLMN\'s entry, the UE shall add an entry for the
current PLMN to the \"CAG information list\" and store an \"indication that
the UE is only allowed to access 5GS via CAG cells\" in the entry of the \"CAG
information list\" for the current PLMN. If the UE does not have a stored
\"CAG information list\", the UE shall create a new \"CAG information list\"
and add an entry with an \"indication that the UE is only allowed to access
5GS via CAG cells\" for the current PLMN.
In addition:
i) if the \"allowed CAG list\" for the current PLMN includes one or more CAG-
IDs, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] with the
updated CAG information; or
ii) if the \"allowed CAG list\" for the current PLMN does not include any CAG-
ID, then the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH and shall
apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\".
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
#77 (Wireline access area not allowed).
5GMM cause #77 is only applicable when received from a wireline access network
by the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the
N5GC device). 5GMM cause #77 received from a 5G access network other than a
wireline access network and 5GMM cause #77 received by the W-AGF acting on
behalf of the FN-BRG are considered as abnormal cases and the behaviour of the
UE is specified in subclause 5.5.2.3.4.
When received over wireline access network, the 5G-RG and the W-AGF acting on
behalf of the FN-CRG (or on behalf of the N5GC device) shall set the 5GS
update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to
subclause 5.1.3.2.2), shall delete 5G-GUTI, last visited registered TAI, TAI
list and ngKSI, shall reset the registration attempt counter, shall enter the
state 5GMM-DEREGISTERED and shall act as specified in subclause 5.3.23.
NOTE 5: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
#78 (PLMN not allowed to operate at the present UE location).
This cause value received from a non-satellite NG-RAN cell is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.5.2.3.4.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter. The UE shall store the PLMN identity and, if
it is known, the current geographical location in the list of \"PLMNs not
allowed to operate at the present UE location\" and shall start a
corresponding timer instance (see subclause 4.23.2). The UE shall enter state
5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP
TS 23.122 [5].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach
attempt counter as specified in 3GPP TS 24.301 [15] for the case when a DETACH
REQUEST is received with the EMM cause with the same value and with detach
type set to \"re-attach not required\".
#79 (UAS services not allowed).
\- A UE which is not a UE supporting UAS services receiving this cause value
shall considered it as an abnormal case and the behaviour of the UE is
specified in subclause 5.5.2.3.4.
A UE supporting UAS service shall set the 5GS update status to 5U2 NOT UPDATED
and enter state 5GMM-DEREGISTERED.NORMAL-SERVICE or 5GMM-DEREGISTERED.PLMN-
SEARCH. Additionally, the UE shall reset the registration attempt counter. If
the UE re-attempt the registration procedure to the current PLMN, the UE shall
not include the service-level device ID set to the CAA-level UAV ID in the
Service-level-AA container IE of REGISTRATION REQUEST message.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU2
NOT UPDATED, reset the attach attempt counter and enter the state EMM-
DEREGISTERED.
#93 (Onboarding services terminated).
If the UE is not registered for onboarding services in SNPN, this cause value
received from a cell belonging to an SNPN is considered as an abnormal case
and the behaviour of the UE is specified in subclause 5.5.2.3.4.
If the UE is not operating in SNPN access operation mode, the UE shall enter
the state 5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according
to 3GPP TS 23.122 [5].
If the UE is operating in SNPN access operation mode, the UE shall enter the
state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to
3GPP TS 23.122 [5].
NOTE 6: In case the configuration of one or more entries of the \"list of
subscriber data\" was not completed at the time of network-initiated de-
registration procedure, the UE can retry registration after the de-
registration procedure is completed.
##### 5.5.2.3.3 Network-initiated de-registration procedure completion by the
network
The network shall stop timer T3522 upon receipt of the DEREGISTRATION ACCEPT
message. The network shall enter state 5GMM-DEREGISTERED for 3GPP access if
the de-registration request is for 3GPP access. The network shall enter state
5GMM-DEREGISTERED for non-3GPP access if the de-registration request is for
non-3GPP access. The network shall enter state 5GMM-DEREGISTERED for both 3GPP
access and non-3GPP access if the de-registration request is for both 3GPP
access and non-3GPP access.
##### 5.5.2.3.4 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Transmission failure of DEREGISTRATION ACCEPT message indication from lower
layers.
The de-registration procedure shall be progressed and the UE shall send the
DEREGISTRATION ACCEPT message.
b) DEREGISTRATION REQUEST, other 5GMM cause values than those treated in
subclause 5.5.2.3.2, cases of 5GMM cause value#11, #15, #22, #72, #74, #75,
#76, #77, #78, #79 and #93 that are considered as abnormal cases according to
subclause 5.5.2.3.2 or no 5GMM cause IE is included, and the De-registration
type IE indicates \"re-registration not required\".
The UE shall delete 5G-GUTI, TAI list, last visited registered TAI, list of
equivalent PLMNs (if any), ngKSI, shall set the 5GS update status to 5U2 NOT
UPDATED and shall start timer T3502.
A UE not supporting S1 mode may enter the state 5GMM-DEREGISTERED.PLMN-SEARCH
in order to perform a PLMN selection or SNPN selection according to 3GPP TS
23.122 [5]; otherwise the UE shall enter the state 5GMM-
DEREGISTERED.ATTEMPTING-REGISTRATION.
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall:
\- enter the state 5GMM-DEREGISTERED and attempt to select E-UTRAN radio
access technology and proceed with the appropriate EMM specific procedures. In
this case, the UE may disable the N1 mode capability (see subclause 4.9); or
\- enter the state 5GMM-DEREGISTERED.PLMN-SEARCH in order to perform a PLMN
selection according to 3GPP TS 23.122 [5].
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall set the EPS update status to EU2 NOT
UPDATED, enter the state EMM-DEREGISTERED and shall delete the EMM parameters
4G-GUTI, last visited registered TAI, TAI list and eKSI.
##### 5.5.2.3.5 Abnormal cases in the network side
The following abnormal cases can be identified:
a) T3522 time-out
On the first expiry of the timer, the network shall retransmit the
DEREGISTRATION REQUEST message and shall start timer T3522. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3522, the de-registration procedure shall be aborted. The network shall
change to the state 5GMM-DEREGISTERED for the access type which the de-
registration procedure is intended for.
b) Lower layer failure
The de-registration procedure is aborted. The network shall change to the
state 5GMM-DEREGISTERED for the access type which the de-registration
procedure is intended for.
c) De-registration procedure collision
If the network receives a DEREGISTRATION REQUEST message with \"switch off\"
indication, before the network-initiated de-registration procedure has been
completed, both procedures shall be considered completed.
If the network receives a DEREGISTRATION REQUEST message without \"switch
off\" indication, before the network-initiated de-registration procedure has
been completed, the network shall send a DEREGISTRATION ACCEPT message to the
UE.
d) De-registration and registration procedure for initial registration
collision
If the network receives a REGISTRATION REQUEST message indicating either
\"initial registration\" or \"emergency registration\" in the 5GS registration
type IE before the network-initiated de-registration procedure has been
completed, the network shall abort the de-registration procedure and the
registration procedure shall be progressed after the PDU sessions associated
with the access type the REGISTRATION REQUEST message is sent over have been
deleted.
NOTE 1: The above collision case is valid if the DEREGISTRATION REQUEST
message indicates the access type over which the initial registration
procedure is attempted otherwise both the procedures are progressed.
e) De-registration and registration procedure for mobility and periodic
registration update collision
If the network sent a DEREGISTRATION REQUEST message without 5GMM cause value
#11, #12, #13 or #15 and the network receives a REGISTRATION REQUEST message
indicating either \"mobility registration updating\" or \"periodic
registration updating\" in the 5GS registration type IE before the network-
initiated de-registration procedure has been completed, the de-registration
procedure shall be progressed, i.e. the REGISTRATION REQUEST message shall be
ignored.
If the network sent a DEREGISTRATION REQUEST message with 5GMM cause value
#11, #12, #13 or #15 and the network receives a REGISTRATION REQUEST message
indicating either \"mobility registration updating\" or \"periodic
registration updating\" in the 5GS registration type IE before the network-
initiated de-registration procedure has been completed, the de-registration
procedure shall be aborted and the registration procedure shall be progressed.
NOTE 2: The above collision case is valid if the DEREGISTRATION REQUEST
message indicates the access type over which the mobility and periodic
registration procedure is attempted otherwise both the procedures are
progressed.
f) De-registration and service request procedure collision
If the network receives a SERVICE REQUEST message or a CONTROL PLANE SERVICE
REQUEST message before the network-initiated de-registration procedure has
been completed (e.g. the DEREGISTRATION REQUEST message is pending to be sent
to the UE), the network shall progress the de-registration procedure.
NOTE 3: The above collision case is valid if the DEREGISTRATION REQUEST
message indicates the access type over which the service request procedure is
attempted otherwise both the procedures are progressed.
g) De-registration requested for a UE not supporting CAG due to CAG
restrictions
Based on operator policy, if the network-initiated de-registration procedure
is triggered for a UE not supporting CAG due to CAG restrictions, the network
shall send the DEREGISTRATION REQUEST message including a 5GMM cause value
other than the 5GMM cause #76 (Not authorized for this CAG or authorized for
CAG cells only).
NOTE 4: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not
allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving
network not authorized) can be used depending on the subscription of the UE
and whether the UE roams or not.
### 5.5.3 eCall inactivity procedure
The eCall inactivity procedure is performed only in 3GPP access and applicable
only to a UE configured for eCall only mode as specified in 3GPP TS 31.102
[22]. The procedure shall be started when:
a) the UE is in any 5GMM-REGISTERED substate except substates 5GMM-
REGISTERED.PLMN-SEARCH or 5GMM-REGISTERED.NO-CELL-AVAILABLE;
b) the UE is in 5GMM-IDLE mode; and
c) one of the following conditions applies:
1) timer T3444 expires or is found to have already expired and timer T3445 is
not running;
2) timer T3445 expires or is found to have already expired and timer T3444 is
not running; or
3) timers T3444 and T3445 expire or are found to have already expired.
The UE shall then perform the following actions:
a) stop other running timers (e.g. T3511, T3512);
b) if the UE is currently registered to the network for 5GS services, perform
a de-registration procedure;
c) delete any 5G-GUTI, TAI list, last visited registered TAI, list of
equivalent PLMNs, and ngKSI; and
d) enter 5GMM-DEREGISTERED.eCALL-INACTIVE state.
### 5.5.4 Authentication and key agreement procedure for 5G ProSe UE-to-
network relay
#### 5.5.4.1 General
The purpose of the authentication and key agreement procedure for 5G ProSe UE-
to-network relay is to perform the authentication for 5G ProSe remote UE
initiated by the 5G ProSe UE-to-network relay and to agree on the K~AUSF_P~
and K~NR_ProSe~ when the security for 5G ProSe communication via 5G ProSe UE-
to-network relay is performed over control plane as specified in 3GPP TS
33.503 [56].
The procedure as shown in figure 5.5.4.1.1 is initiated by the UE when the UE
receives the ProSe direct link establishment request including the SUCI or the
CP-PRUK ID of the 5G ProSe remote UE from the 5G ProSe remote UE, for
establishing secure PC5 unicast link as specified in 3GPP TS 24.554 [19E].
If the network decides to process the relay key request message, the EAP based
authentication and key agreement procedure is initiated and controlled by the
network. The exchanges of EAP messages between the 5G ProSe remote UE and the
network are relayed by the UE.
Figure 5.5.4.1.1: Authentication and key agreement procedure for 5G ProSe UE-
to-network relay
#### 5.5.4.2 ProSe relay transaction identity (PRTI)
Upon receiving a ProSe direct link establishment request from a 5G ProSe
remote UE for establishing a secure PC5 unicast link as specified in 3GPP TS
24.554 [19E], the UE shall allocate an available PRTI value for the
authentication and key agreement procedure for 5G ProSe UE-to-network relay
and associate this PRTI value with the 5G ProSe remote UE.
The UE shall release the PRTI value allocated to the authentication and key
agreement procedure for 5G ProSe UE-to-network relay when the authentication
and key agreement procedure for 5G ProSe UE-to-network relay completes or is
aborted.
#### 5.5.4.3 UE-initiated authentication and key agreement procedure
initiation
Upon receiving a ProSe direct link establishment request from the 5G ProSe
remote UE including the SUCI or the CP-PRUK ID of the 5G ProSe remote UE, for
establishing a secure PC5 unicast link as specified in 3GPP TS 24.554 [19E]
when the security for 5G ProSe communication via 5G ProSe UE-to-network relay
is performed over control plane as specified in 3GPP TS 33.503 [56], the UE
shall:
a) allocate a PRTI value as specified in clause 5.5.4.2;
b) create a RELAY KEY REQUEST message;
c) set the PRTI IE of the RELAY KEY REQUEST message to the allocated PRTI
value;
d) set the relay key request parameters IE of the RELAY KEY REQUEST message
with SUCI or the CP-PRUK ID, relay service code, and nonce_1 received from the
of the 5G ProSe remote UE;
e) send the RELAY KEY REQUEST message; and
f) start the timer T3527 upon sending the RELAY KEY REQUEST message.
#### 5.5.4.4 UE-initiated authentication and key agreement procedure accepted
by the network
Upon receiving the RELAY KEY REQUEST message, the AMF processes the message
and interacts with the AUSF of the 5G ProSe remote UE as specified in 3GPP TS
33.503 [56]. If EAP-AKA\' authentication for the 5G ProSe remote UE is
initiated by the network, the AMF shall:
a) create a RELAY AUTHENTICATION REQUEST message;
b) set the PRTI IE of the RELAY AUTHENTICATION REQUEST message to the PRTI
value of the received RELAY KEY REQUEST message;
c) set the EAP message IE of the RELAY AUTHENTICATION REQUEST message to EAP
request message received from the AUSF; and
d) send the RELAY AUTHENTICATION REQUEST message to the UE.
Upon receiving the RELAY AUTHENTICATION REQUEST message, the UE stops the
timer T3527 and forwards the EAP message to the 5G ProSe remote UE as
specified in 3GPP TS 24.554 [19E].
Upon receiving the EAP response message from the 5G ProSe remote UE as
specified in 3GPP TS 24.554 [19E], the UE shall:
a) create a RELAY AUTHENTICATION RESPONSE message;
b) set the PRTI IE of the RELAY AUTHENTICATION RESPONSE message to the PRTI
value of the received RELAY AUTHENTICATION REQUEST message;
c) set the EAP message IE of the RELAY AUTHENTICATION RESPONSE message to EAP
response message received from the 5G ProSe remote UE; and
d) start a timer T3527 upon sending the RELAY AUTHENTICATION RESPONSE message
to the AMF.
After receiving the RELAY AUTHENTICATION RESPONSE message, the AMF may send a
new RELAY AUTHENTICATION REQUEST message carrying EAP request message
according to further handling of EAP-AKA\' authentication from the AUSF as
specified in 3GPP TS 33.503 [56]. The UE repeats the handling of the RELAY
AUTHENTICATION REQUEST message as described above.
Upon receiving the message from the AUSF that the authentication is
successful, the AMF shall:
a) create a RELAY KEY ACCEPT message;
b) set the PRTI IE of the RELAY KEY ACCEPT message to the PRTI value of the
RELAY KEY REQUEST message;
c) include the EAP message IE of the RELAY KEY ACCEPT message set to EAP-
success message received from the AUSF, if any;
d) include the relay key response parameters IE of the RELAY KEY ACCEPT
message set to K~NR_ProSe~ and nonce_2 received from AUSF; and
e) include the CP-PRUK ID in the relay key response parameters IE of the RELAY
KEY ACCEPT message.
Upon receiving the RELAY KEY ACCEPT message, the UE shall forward the EAP-
success message, if any, and nonce_2 to the 5G ProSe remote UE as specified in
3GPP TS 24.554 [19E], and consider the authentication is completed
successfully. The UE shall store the CP-PRUK ID to be used in the remote UE
report procedure as specified in clause 6.6.2.2.
#### 5.5.4.5 UE-initiated authentication and key agreement procedure not
accepted by the network
If the UE-initiated authentication and key agreement procedure is not accepted
by the network, the AMF shall:
a) create a RELAY KEY REJECT message;
b) set the PRTI IE of the RELAY KEY REJECT message to the PRTI value of the
received RELAY KEY REQUEST message if the network decides to reject the RELAY
KEY REQUEST message; or
NOTE: The network decides to reject the RELAY KEY REQUEST message when e.g.
the CP-PRUK is not found in the network.
set the PRTI IE of the RELAY KEY REJECT message to the PRTI value of the
received RELAY AUTHENTICATION RESPONSE message and include the EAP message IE
set with EAP-failure message if the AMF receives an EAP-failure message from
the AUSF; and
c) send the RELAY KEY REJECT message to the UE.
Upon receiving the RELAY KEY REJECT message, the UE shall consider the
authentication has failed and perform the PC5 signalling protocol procedure as
specified in subclause 7.2.2.5 of 3GPP 24.554 [19E].
#### 5.5.4.6 Abnormal cases in the UE
The following abnormal cases in the UE can be identified:
a) Transmission failure of RELAY KEY REQUEST message or RELAY KEY
AUTHENTICATION RESPONSE message indication from lower layers.
The UE shall abort the authentication and key agreement procedure for 5G ProSe
UE-to-network relay and perform the PC5 signalling protocol procedure as
specified in subclause 7.2.2.5 of 3GPP 24.554 [19E].
b) Expiry of timer T3527.
The UE shall, on the first expiry of the timer T3527, retransmit the RELAY KEY
REQUEST message or the RELAY KEY AUTHENTICATION RESPONSE message and shall
reset and start timer T3527. This retransmission is repeated four times, i.e.
on the fifth expiry of timer T3527, the procedure shall be aborted.
c) Collision between the authentication and key agreement procedure for 5G
ProSe UE-to-network relay and de-registration procedure.
The UE shall abort the authentication and key agreement procedure for 5G ProSe
UE-to-network relay, proceed with the network initiated de-registration
procedure, and perform the PC5 signalling protocol procedure as specified in
subclause 7.2.2.5 of 3GPP 24.554 [19E].
#### 5.5.4.7 Abnormal cases on the network side
The following abnormal cases on the network side can be identified:
a) Lower layer failure before the RELAY KEY AUTHENTICATION RESPONSE message is
received.
The network shall abort the authentication and key agreement procedure for 5G
ProSe UE-to-network relay.
b) Collision between the authentication and key agreement procedure for 5G
ProSe UE-to-network relay and de-registration procedure.
The network shall abort the authentication and key agreement procedure for 5G
ProSe UE-to-network relay and proceed with the UE-initiated de-registration
procedure.
c) Collision between the authentication and key agreement procedure for 5G
ProSe UE-to-network relay and other 5GMM procedures other than in item b.
The network shall progress both procedures.
## 5.6 5GMM connection management procedures
### 5.6.1 Service request procedure
#### 5.6.1.1 General
The purpose of the service request procedure is to change the 5GMM mode from
5GMM-IDLE to 5GMM-CONNECTED mode. If the UE is not using 5GS services with
control plane CIoT 5GS optimization, this procedure is used to request the
establishment of user-plane resources for PDU sessions which are established
without user-plane resources. In latter case, the 5GMM mode can be the 5GMM-
IDLE mode or the 5GMM-CONNECTED mode if the UE requires to establish user-
plane resources for PDU sessions. If the UE is using 5GS services with control
plane CIoT 5GS optimization, this procedure can be used for UE initiated
transfer of user data via the control plane from 5GMM-IDLE mode.
NOTE 1: The lower layer indicates when the user-plane resources for PDU
sessions are successfully established or released.
This procedure is used when:
\- the network has downlink signalling pending over 3GPP access and the UE is
in 5GMM-IDLE mode over 3GPP access;
\- the network has downlink signalling pending over non-3GPP access, the UE is
in 5GMM-IDLE mode over non-3GPP access and in 5GMM-IDLE or 5GMM-CONNECTED mode
over 3GPP access;
\- the UE has uplink signalling pending over 3GPP access and the UE is in
5GMM-IDLE mode over 3GPP access;
\- the network has downlink user data pending over 3GPP access and the UE is
in 5GMM-IDLE mode over 3GPP access;
\- the network has downlink user data pending over non-3GPP access, the UE is
in 5GMM-IDLE mode over non-3GPP access and in 5GMM-IDLE or 5GMM-CONNECTED mode
over 3GPP access;
\- the UE has user data pending over 3GPP access and the UE is in 5GMM-IDLE or
5GMM-CONNECTED mode over 3GPP access;
\- the UE has user data pending over non-3GPP access and the UE is in 5GMM-
CONNECTED mode over non-3GPP access;
\- the UE in 5GMM-IDLE mode over non-3GPP access, receives an indication from
the lower layers of non-3GPP access, that the access stratum connection is
established between the UE and the network, if T3346 is not running;
\- the UE in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access receives a
request from the upper layers to perform emergency services fallback and
performs emergency services fallback as specified in subclause 4.13.4.2 of
3GPP TS 23.502 [9];
\- the UE has to request resources for V2X communication over PC5;
\- the UE has to request resources for 5G ProSe direct discovery over PC5 or
5G ProSe direct communication over PC5;
\- the MUSIM UE in 5GMM-IDLE mode requests the network to remove the paging
restriction; or
\- the MUSIM UE requests the release of the NAS signalling connection or
rejects the paging request from the network.
This procedure shall not be used for:
a) initiating user data transfer; or
b) PDU session management related signalling other than for performing UE-
requested PDU session release procedure related to a PDU session for LADN or
for performing the UE-requested PDU session modification procedure to indicate
a change of 3GPP PS data off UE status;
when the UE is located outside the LADN service area.
In NB-N1 mode, this procedure shall not be used to request the establishment
of user-plane resources:
a) for a number of PDU sessions that exceeds the UE\' s maximum number of
supported user-plane resources if there is currently:
1) no user-plane resources established for the UE;
2) user-plane resources established for:
i) one PDU session and the Multiple user-plane resources support bit was set
to \"Multiple user-plane resources not supported\" in the 5GMM capability IE;
or
ii) two PDU sessions and the Multiple user-plane resources support bit was set
to \"Multiple user-plane resources supported\" in the 5GMM capability IE; or
b) for additional PDU sessions, if the number of PDU sessions for which user-
plane resources are currently established is equal to the UE\'s maximum number
of supported user-plane resources.
The service request procedure is initiated by the UE, however, it can be
triggered by the network by means of:
\- the paging procedure (see subclause 5.6.2) for the transfer of downlink
signalling or user data pending over 3GPP access to a UE in 5GMM-IDLE mode
over 3GPP access;
\- the paging procedure (see subclause 5.6.2) for the transfer of downlink
signalling or user data pending over non-3GPP access to a UE in 5GMM-IDLE mode
over 3GPP access and in 5GMM-IDLE mode over non-3GPP access;
\- the notification procedure (see subclause 5.6.3) for the transfer of
downlink signalling or user data pending over non-3GPP access to a UE in 5GMM-
CONNECTED mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP access; or
\- the notification procedure (see subclause 5.6.3) for the transfer of
downlink signalling or user data pending over 3GPP access to a UE in 5GMM-IDLE
mode over 3GPP access and in 5GMM-CONNECTED mode over non-3GPP access.
NOTE 2: In case the UE is in 5GMM-IDLE mode over 3GPP access and in 5GMM-
CONNECTED mode over non-3GPP access and downlink signalling or user data
pending over 3GPP access needs to be transferred, the AMF can trigger either
the notification procedure or the paging procedure based on implementation.
The UE shall invoke the service request procedure when:
a) the UE, in 5GMM-IDLE mode over 3GPP access, receives a paging request from
the network;
NOTE 3: As an implementation option, the MUSIM UE is allowed to not invoke
service request to respond to paging based on the information available in the
paging message, e.g. voice service indication.
b) the UE, in 5GMM-CONNECTED mode over 3GPP access, receives a notification
from the network with access type indicating non-3GPP access;
c) the UE, in 5GMM-IDLE mode over 3GPP access, has uplink signalling pending
(except in case i);
d) the UE, in 5GMM-IDLE mode over 3GPP access, has uplink user data pending
(except in case j);
e) the UE, in 5GMM-CONNECTED mode or in 5GMM-CONNECTED mode with RRC inactive
indication, has user data pending due to no user-plane resources established
for PDU session(s) used for user data transport;
f) the UE in 5GMM-IDLE mode over non-3GPP access, with T3346 not active or
upon expiry of T3346, receives or has already received an indication from the
lower layers of non-3GPP access, that the access stratum connection is
established between the UE and the network;
g) the UE, in 5GMM-IDLE mode over 3GPP access, receives a notification from
the network with access type indicating 3GPP access when the UE is in 5GMM-
CONNECTED mode over non-3GPP access;
h) the UE, in 5GMM-IDLE, 5GMM-CONNECTED mode over 3GPP access, or 5GMM-
CONNECTED mode with RRC inactive indication, receives a request from the upper
layers to perform emergency services fallback and performs emergency services
fallback as specified in subclause 4.13.4.2 of 3GPP TS 23.502 [9];
i) the UE, in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode
with RRC inactive indication, receives a fallback indication from the lower
layers (see subclauses 5.3.1.2 and 5.3.1.4) and the UE has a pending NAS
procedure other than a registration, service request, or de-registration
procedure;
j) the UE, in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode
with RRC inactive indication, receives a fallback indication from the lower
layers (see subclauses 5.3.1.2 and 5.3.1.4) and the UE has pending uplink user
data for PDU session(s) with user-plane resources already established but no
pending NAS procedure;
k) the UE, in 5GMM-CONNECTED mode and has a NAS signalling connection only, is
using 5GS services with control plane CIoT 5GS optimization and has pending
user data to be sent via user-plane resources;
l) the UE in 5GMM-IDLE mode over 3GPP access has to request resources for V2X
communication over PC5 (see 3GPP TS 23.287 [6C]);
m) the network supports the paging restriction, and the MUSIM UE in 5GMM-IDLE
mode is requesting the network to remove the paging restriction;
n) the UE in 5GMM-IDLE mode over 3GPP access
\- has to request resources for 5G ProSe direct discovery over PC5 or 5G ProSe
direct communication over PC5 (see 3GPP TS 23.304 [6E]); or
\- acts as a 5G ProSe layer-2 UE-to-network relay UE and receives a trigger
from lower layers to establish the NAS signalling connection (see 3GPP TS
23.304 [6E]);
o) the network supports the N1 NAS signalling connection release, the MUSIM
UE,
\- is in 5GMM-CONNECTED mode, requests the network to release the NAS
signalling connection and, if the network supports the paging restriction,
optionally includes paging restriction;
\- is in 5GMM-CONNECTED mode with RRC inactive indication, requests the
network to release the NAS signalling connection and, if the network supports
the paging restriction, optionally includes paging restriction; or
\- is in 5GMM-CONNECTED mode with RRC inactive indication, rejects the RAN
paging, requests the network to release the NAS signalling connection and, if
the network supports the paging restriction, optionally includes paging
restriction; or
p) the network supports the reject paging request, the MUSIM UE in 5GMM-IDLE
mode when responding to paging rejects the paging request from the network,
requests the network to release the NAS signalling connection and, if the
network supports the paging restriction, optionally includes paging
restriction.
If one of the above criteria to invoke the service request procedure is
fulfilled, then the service request procedure shall only be initiated by the
UE when the following conditions are fulfilled:
\- its 5GS update status is 5U1 UPDATED, and the TAI of the current serving
cell is included in the TAI list; and
\- no 5GMM specific procedure is ongoing.
The UE shall not invoke the service request procedure when the UE is in the
state 5GMM-SERVICE-REQUEST-INITIATED.
The MUSIM UE shall not initiate service request procedure for requesting the
network to release the N1 NAS signalling connection if the UE is registered
for emergency services or if the UE has an emergency PDU session established.
To enable the emergency call back, the UE shall not initiate service request
procedure for requesting the network to release the NAS signalling connection
for a UE implementation-specific duration of time after the completion of the
emergency services.
Figure 5.6.1.1.1: Service Request procedure (Part 1)
Figure 5.6.1.1.2: Service Request procedure (Part 2)
A service request attempt counter is used to limit the number of service
request attempts and no response from the network. The service request attempt
counter shall be incremented as specified in subclause 5.6.1.7.
The service request attempt counter shall be reset when:
\- a registration procedure for mobility and periodic registration update is
successfully completed;
\- a service request procedure is successfully completed;
\- a service request procedure is rejected as specified in subclause 5.6.1.5
or subclause 5.3.20; or
\- the UE moves to 5GMM-DEREGISTERED state.
#### 5.6.1.2 Service request procedure initiation
##### 5.6.1.2.1 UE is not using 5GS services with control plane CIoT 5GS
optimization
The UE initiates the service request procedure by sending a SERVICE REQUEST
message to the AMF. The UE shall start timer T3517 and enter the state 5GMM-
SERVICE-REQUEST-INITIATED.
If the UE is sending the SERVICE REQUEST message from 5GMM-IDLE mode and the
UE needs to send non-cleartext IEs, the UE shall send the SERVICE REQUEST
message including the NAS message container IE as described in subclause
4.4.6.
For cases a), b), and g) in subclause 5.6.1.1, the service type IE in the
SERVICE REQUEST message shall be set to \"mobile terminated services\".
For cases c), d), e), f), i), j), l) m) and n) in subclause 5.6.1.1, if the UE
is a UE configured for high priority access in selected PLMN, the service type
IE in the SERVICE REQUEST message shall be set to \"high priority access\".
For case a) in subclause 5.6.1.1:
a) if the paging request includes an indication for non-3GPP access type, the
Allowed PDU session status IE shall be included in the SERVICE REQUEST
message. If the UE has established the PDU session(s) over the non-3GPP access
for which the associated S-NSSAI(s) are included in the allowed NSSAI for 3GPP
access, the UE shall indicate the PDU session(s) for which the UE allows the
user-plane resources to be re-established over 3GPP access in the Allowed PDU
session status IE. Otherwise, the UE shall not indicate any PDU session(s) in
the Allowed PDU session status IE; and
b) if the UE has uplink user data pending to be sent over 3GPP access, the
Uplink data status IE shall be included in the SERVICE REQUEST message to
indicate the PDU session(s) for which the UE has pending user data to be sent.
Otherwise, the Uplink data status IE shall not be included in the SERVICE
REQUEST message.
For case b) in subclause 5.6.1.1:
a) the Allowed PDU session status IE shall be included in the SERVICE REQUEST
message. If the UE has the PDU session(s) over the non-3GPP access for which
the associated S-NSSAI(s) are included in the allowed NSSAI for 3GPP access,
the UE shall indicate the PDU session(s) for which the UE allows the user-
plane resources to be re-established over 3GPP access in the Allowed PDU
session status IE. Otherwise, the UE shall not indicate any PDU session(s) in
the Allowed PDU session status IE; and
b) if the UE has uplink user data pending to be sent over 3GPP access, the
Uplink data status IE shall be included in the SERVICE REQUEST message to
indicate the PDU session(s) for which the UE has pending user data to be sent.
Otherwise, the Uplink data status IE shall not be included in the SERVICE
REQUEST message.
When the Allowed PDU session status IE is included in the SERVICE REQUEST
message, the UE shall indicate that a PDU session is not allowed to be
transferred to the 3GPP access if the 3GPP PS data off UE status is
\"activated\" for the corresponding PDU session and the UE is not using the
PDU session to send uplink IP packets for any of the 3GPP PS data off exempt
services (see subclause 6.2.10).
For case c) in subclause 5.6.1.1, the Uplink data status IE shall not be
included in the SERVICE REQUEST message except if the UE has one or more
active always-on PDU sessions associated with the access type over which the
SERVICE REQUEST message is sent. If the UE is not a UE configured for high
priority access in selected PLMN and:
a) if the SERVICE REQUEST message is triggered by a request for emergency
services from the upper layer, the UE shall set the service type IE in the
SERVICE REQUEST message to \"emergency services\"; or
b) otherwise, the UE shall set the service type IE to \"signalling\".
When the UE is in a non-allowed area or is not in an allowed area as specified
in subclause 5.3.5 and:
a) if the uplink signalling pending is to indicate a change of 3GPP PS data
off UE status for a PDU session, the UE shall set the service type IE in the
SERVICE REQUEST message to \"elevated signalling\", and shall not include the
Uplink data status IE in the SERVICE REQUEST message even if the UE has one or
more active always-on PDU sessions associated with the access type over which
the SERVICE REQUEST message is sent; or
b) otherwise, the UE shall not initiate service request procedure except for
emergency services, high priority access or responding to paging or
notification.
For cases d) and e) in subclause 5.6.1.1, the Uplink data status IE shall be
included in the SERVICE REQUEST message to indicate the PDU session(s) the UE
has pending user data to be sent. If the UE is not a UE configured for high
priority access in selected PLMN:
a) if there exists an emergency PDU session which is indicated in the Uplink
data status IE the service type IE in the SERVICE REQUEST message shall be set
to \"emergency services\"; or
b) otherwise, the service type IE in the SERVICE REQUEST message shall be set
to \"data\".
NOTE 1: For a UE in NB-N1 mode, the Uplink data status IE cannot be used to
request the establishment of user-plane resources such that there will be
user-plane resources established for a number of PDU sessions that exceeds the
UE\'s maximum number of supported user-plane resources.
For case f) in subclause 5.6.1.1:
a) if the UE has uplink user data pending to be sent, the Uplink data status
IE shall be included in the SERVICE REQUEST message to indicate the PDU
session(s) the UE has pending user data to be sent. If the UE is not a UE
configured for high priority access in selected PLMN, the service type IE in
the SERVICE REQUEST message shall be set to \"data\";
b) otherwise, if the UE is not a UE configured for high priority access in
selected PLMN, the service type IE in the SERVICE REQUEST message shall be set
to \"signalling\".
For case g) in subclause 5.6.1.1, if the UE has uplink user data pending to be
sent, the Uplink data status IE shall be included in the SERVICE REQUEST
message to indicate the PDU session(s) the UE has pending user data to be
sent.
For case h) in subclause 5.6.1.1, the UE shall send a SERVICE REQUEST message
with service type set to \"emergency services fallback\" and without an Uplink
data status IE.
For case i) in subclause 5.6.1.1, if the UE is not configured for high
priority access in selected PLMN, the UE shall set the Service type IE in the
SERVICE REQUEST message as follows:
a) if the pending message is an UL NAS TRANSPORT message with the Request type
IE set to \"initial emergency request\" or \"existing emergency PDU session\",
the UE shall set the Service type IE in the SERVICE REQUEST message to
\"emergency services\"; or
b) otherwise, the UE shall set the Service type IE in the SERVICE REQUEST
message to \"signalling\".
For case j) in subclause 5.6.1.1:
a) the UE shall include the Uplink data status IE in the SERVICE REQUEST
message indicating the PDU session(s) for which user-plane resources were
active prior to receiving the fallback indication, if any; and
b) if the UE is not a UE configured for high priority access in selected PLMN,
the UE shall set the Service type IE in the SERVICE REQUEST message as
follows:
1) if there is an emergency PDU session which is indicated in the Uplink data
status IE, the UE shall set the Service type IE in the SERVICE REQUEST message
to \"emergency services\"; or
2) if there is no emergency PDU session which is indicated in the Uplink data
status IE, the UE shall set the Service type IE in the SERVICE REQUEST message
to \"data\".
For case l) and n) in subclause 5.6.1.1, if the UE is not a UE configured for
high priority access in selected PLMN:
a) if there exists an emergency PDU session which is indicated in the Uplink
data status IE the service type IE in the SERVICE REQUEST message shall be set
to \"emergency services\"; or
b) otherwise, the service type IE in the SERVICE REQUEST message shall be set
to \"signalling\".
For case m) in subclause 5.6.1.1, the UE shall not include the Paging
restriction IE in the SERVICE REQUEST message and set Service type to
\"signalling\". The UE may include the UE request type IE and set Request type
to \"NAS signalling connection release\" to remove the paging restriction and
request the release of the NAS signalling connection at the same time. If the
UE requests the release of the NAS signalling connection, the UE shall not
include the Uplink data status IE in the SERVICE REQUEST message.
For cases o and p in subclause 5.6.1.1, the UE shall not include the Uplink
data status IE and the Allowed PDU session status IE in the SERVICE REQUEST
message. Further,
\- for case o in subclause 5.6.1.1, the UE shall set Request type to \"NAS
signalling connection release\" in the UE request type IE and Service type to
\"signalling\";
\- for case p in subclause 5.6.1.1, the UE shall set Request type to
\"Rejection of paging\" in the UE request type IE and Service type to \"mobile
terminated services\"; and
may include its paging restriction preference in the Paging restriction IE in
the SERVICE REQUEST message.
The UE shall include a valid 5G-S-TMSI in the 5G-S-TMSI IE of the SERVICE
REQUEST message.
For all cases except cases o) and p) in subclause 5.6.1.1, if the UE has one
or more active always-on PDU sessions associated with the access type over
which the SERVICE REQUEST message is sent and the user-plane resources for
these PDU sessions are not established, the UE shall include the Uplink data
status IE in the SERVICE REQUEST message and indicate that the UE has pending
user data to be sent for those PDU sessions.
If the UE has one or more active PDU sessions which are not accepted by the
network as always-on PDU sessions and no uplink user data pending to be sent
for those PDU sessions, the UE shall not include those PDU sessions in the
Uplink data status IE in the SERVICE REQUEST message.
The Uplink data status IE may be included in the SERVICE REQUEST message to
indicate which PDU session(s) associated with the access type the SERVICE
REQUEST message is sent over have pending user data to be sent.
The PDU session status information element may be included in the SERVICE
REQUEST message to indicate:
\- the single access PDU session(s) not in 5GSM state PDU SESSION INACTIVE in
the UE associated with the access type the SERVICE REQUEST message is sent
over; and
\- the MA PDU session(s) not in 5GSM state PDU SESSION INACTIVE and having
user plane resources established in the UE on the access the SERVICE REQUEST
message is sent over.
If the SERVICE REQUEST message includes a NAS message container IE, the AMF
shall process the SERVICE REQUEST message that is obtained from the NAS
message container IE as described in subclause 4.4.6.
If the UE has an emergency PDU session over the non-current access, it shall
not initiate the SERVICE REQUEST message with the service type IE set to
\"emergency services\" over the current access, unless the SERVICE REQUEST
message has to be initiated to perform handover of an existing emergency PDU
session from the non-current access to the current access.
NOTE 2: Transfer of an existing emergency PDU session between 3GPP access and
non-3GPP access is needed e.g. if the UE determines that the current access is
no longer available.
##### 5.6.1.2.2 UE is using 5GS services with control plane CIoT 5GS
optimization
The UE shall send a CONTROL PLANE SERVICE REQUEST message, start T3517 and
enter the state 5GMM-SERVICE-REQUEST-INITIATED.
For case a), and case b) in subclause 5.6.1.1, the Control plane service type
of the CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile
terminating request\". If:
a) the UE only has uplink CIoT user data or SMS to be sent, the UE shall:
1) if the data size is not more than 254 octets and there is no other optional
IE to be included in the message:
i) for sending CIoT user data, set the Data type field to \"control plane user
data\", include the PDU session ID, data, and Downlink data expected (DDX) (if
available), in the CIoT small data container IE; and
ii) for sending SMS, set the Data type field to \"SMS\", include SMS in the
CIoT small data container IE; and
2) otherwise if the data size is more than 254 octets or there are other
optional IEs to be included in the message:
i) for sending CIoT user data, set the Payload container type IE to \"CIoT
user data container\", include the PDU session ID in the PDU session ID IE and
include data in the Payload container IE as described in subclause 5.4.5.2.2;
and
ii) for sending SMS, set the Payload container type IE to \"SMS\" and include
data in the Payload container IE as described in subclause 5.4.5.2.2; and
b) the paging request or the notification includes an indication for non-3GPP
access type, the UE _has at least one PDU session_ that is not associated with
control plane only indication, the Allowed PDU session status IE shall be
included in the CONTROL PLANE SERVICE REQUEST message.
NOTE 1: The term DDX used in the present document corresponds to the term NAS
RAI used in 3GPP TS 23.502 [9].
For case c), and case d) if the UE has pending CIoT user data that is to be
sent via the control plane in subclause 5.6.1.1, the UE shall set the Control
plane service type of the CONTROL PLANE SERVICE REQUEST message to \"mobile
originating request\". If the UE has only uplink CIoT user data, SMS or
location services message to be sent, the UE shall:
a) if the data size is not more than 254 octets, there is no other optional IE
to be included in the CONTROL PLANE SERVICE REQUEST message, and the data
being sent is:
1) CIoT user data, set the Data type field to \"control plane user data\",
include the PDU session ID, data, and Downlink data expected (DDX) (if
available), in the CIoT small data container IE;
2) location services message, set the Data type field to \"Location services
message container\" and Downlink data expected (DDX), if available, in the
CIoT small data container IE, and:
i) if routing information is provided by upper layers:
A) set the length of additional information field in the CIoT small data
container IE to the length of routing information provided by upper layer
location services application (see subclause 9.11.3.67), and set the
additional information field in the CIoT small data container IE to the
routing information provided by upper layer location services application (see
subclause 9.11.3.67); or
B) otherwise set the length of additional information field in the CIoT small
data container IE to zero. In this case the Additional information field of
the CIoT small data container IE shall not be included; and
ii) set the Data contents field of the CIoT small data container IE to the
location services message payload; or
3) SMS, set the Data type field to \"SMS\", include SMS in the CIoT small data
container IE; or
b) otherwise if the data size is more than 254 octets or there are other
optional IEs to be included in the CONTROL PLANE SERVICE REQUEST message, and
the data being sent is:
1) CIoT user data, set the Payload container type IE to \"CIoT user data
container\", include the PDU session ID in the PDU session ID IE and include
data in the Payload container IE as described in subclause 5.4.5.2.2;
2) location services message, set the Payload container type IE to \"Location
services message container\", include data in the Payload container IE as
described in subclause 5.4.5.2.2. If the upper layer location services
application provides the routing information set the Additional information IE
to the routing information as described in subclause 5.4.5.2.2; or
3) SMS, set the Payload container type IE to \"SMS\" and include data in the
Payload container IE as described in subclause 5.4.5.2.2.
For case a), and case b) in subclause 5.6.1.1, if the UE has pending user data
that is to be sent via the user plane, the UE shall set the Control plane
service type of the CONTROL PLANE SERVICE REQUEST message to \"mobile
terminating request\". The UE shall include the Uplink data status IE in the
CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) have
pending user data to be sent via user-plane resources.
For case c) in subclause 5.6.1.1, if the UE is in WB-N1 mode and the CONTROL
PLANE SERVICE REQUEST message is triggered by a request for emergency services
from the upper layer, the UE shall set the Control plane service type of the
CONTROL PLANE SERVICE REQUEST message to \"emergency services\".
For cases d) and k), if the UE has pending user data that is to be sent via
the user plane in subclause 5.6.1.1:
a) and if there exists an emergency PDU session which is indicated in the
Uplink data status IE, the UE shall set the Control plane service type of the
CONTROL PLANE SERVICE REQUEST message to \"emergency services\"; or
b) otherwise, the UE shall set the Control plane service type to \"mobile
originating request\".
The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE
REQUEST message to indicate which PDU session(s) have pending user data to be
sent via user-plane resources.
NOTE 2: For a UE in NB-N1 mode, the Uplink data status IE cannot be used to
request the establishment of user-plane resources such that there will be
user-plane resources established for a number of PDU sessions that exceeds the
UE\'s maximum number of supported user-plane resources.
For case h) in subclause 5.6.1.1, if the UE is in WB-N1 mode and the UE does
not have any PDU session that is associated with control plane only
indication, the UE shall send a CONTROL PLANE SERVICE REQUEST message with the
Control plane service type set to \"emergency services fallback\" and without
an Uplink data status IE.
For case i) in subclause 5.6.1.1, the Control plane service type of the
CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile originating
request\". If the pending message is an UL NAS TRANSPORT message with the
Payload container type IE set to:
a) \"SMS\", \"Location services message container\", or \"CIoT user data
container\", the UE shall send the CONTROL PLANE SERVICE REQUEST and include
the SMS, location services message, or CIoT user data as described in this
subclause; or
b) otherwise, the UE shall send the CONTROL PLANE SERVICE REQUEST:
1) without including the CIoT small data container IE and without including
the NAS message container IE if the UE has no other optional IE to be sent; or
2) with the NAS message container IE if the UE has an optional IE to be sent
as described in this subclause.
For case j) in subclause 5.6.1.1, the Control plane service type of the
CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile originating
request\". The UE shall include the Uplink data status IE in the CONTROL PLANE
SERVICE REQUEST message indicating the PDU session(s) for which user-plane
resources were active prior to receiving the fallback indication, if any.
For cases o) and p) in subclause 5.6.1.1, the UE shall not include the Uplink
data status IE and the Allowed PDU session status IE in the CONTROL PLANE
SERVICE REQUEST message. Further,
\- for case o) in subclause 5.6.1.1, the UE shall set Request type to \"NAS
signalling connection release\" in the UE request type IE and Control plane
service type to \"mobile originating request\";
\- for case p) in subclause 5.6.1.1, the UE shall set Request type to
\"Rejection of paging\" in the UE request type IE and Control plane service
type to \"mobile terminating request\"; and
may include its paging restriction preferences in the Paging restriction IE in
the CONTROL PLANE SERVICE REQUEST message.
For case m) in clause 5.6.1.1, the Control plane service type of the CONTROL
PLANE SERVICE REQUEST message shall indicate \"mobile originating request\".
The UE shall not include the Paging restriction IE in the CONTROL PLANE
SERVICE REQUEST message. The UE may include the UE request type IE and set
Request type to \"NAS signalling connection release\" to remove the paging
restriction and request the release of the NAS signalling connection at the
same time. If the UE requests the release of the NAS signalling connection,
the UE shall not include the Uplink data status IE in the SERVICE REQUEST
message.
The UE may include the PDU session status IE in the CONTROL PLANE SERVICE
REQUEST message to indicate which PDU session(s) associated with the access
type the CONTROL PLANE SERVICE REQUEST message is sent over are active in the
UE.
#### 5.6.1.3 Common procedure initiation
Upon receipt of the SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message,
the AMF may initiate the common procedures e.g. the 5G AKA based primary
authentication and key agreement procedure or the EAP based primary
authentication and key agreement procedure.
#### 5.6.1.4 Service request procedure accepted by the network
##### 5.6.1.4.1 UE is not using 5GS services with control plane CIoT 5GS
optimization
For cases other than h) in subclause 5.6.1.1, the UE shall treat the reception
of the SERVICE ACCEPT message as successful completion of the procedure. The
UE shall reset the service request attempt counter, stop timer T3517 and enter
the state 5GMM-REGISTERED.
For case h) in subclause 5.6.1.1,
a) the UE shall treat the indication from the lower layers when the UE has
changed to S1 mode or E-UTRA connected to 5GCN (see 3GPP TS 23.502 [9]) as
successful completion of the procedure and stop timer T3517;
b) if a UE operating in single-registration mode has changed to S1 mode, it
shall disable the N1 mode capability for 3GPP access (see subclause 4.9.2);
and
c) the AMF shall not check for CAG restrictions.
If the PDU session status information element is included in the SERVICE
REQUEST message, then:
a) for single access PDU sessions, the AMF shall:
1) perform a local release of all those PDU sessions which are not in 5GSM
state PDU SESSION INACTIVE on the AMF side associated with the access type the
SERVICE REQUEST message is sent over, but are indicated by the UE as being in
5GSM state PDU SESSION INACTIVE; and
2) request the SMF to perform a local release of all those PDU sessions. If
any of those PDU sessions is associated with one or more multicast MBS
sessions, the SMF shall consider the UE as removed from the associated
multicast MBS sessions; and
b) for MA PDU sessions, the AMF shall:
1) for MA PDU sessions having user plane resources established in the AMF only
on the access the SERVICE REQUEST message is sent over, but are indicated by
the UE as no user plane resources established:
i) for all those MA PDU sessions without a PDN connection established as a
user-plane resource, perform a local release of all those MA PDU sessions and
request the SMF to perform a local release of all those MA PDU sessions. If
the MA PDU session is associated with one or more multicast MBS sessions, the
SMF shall consider the UE as removed from the associated multicast MBS
sessions; and
ii) for all those MA PDU sessions with a PDN connection established as a user-
plane resource, perform a local release of user plane resources of all those
PDU sessions on the access the SERVICE REQUEST message is sent over and
request the SMF to perform a local release of user plane resources of all
those PDU sessions on the access type the SERVICE REQUEST message is sent
over; and
2) for MA PDU sessions having user plane resources established on both
accesses in the AMF, but are indicated by the UE as no user plane resources
established:
i) perform a local release of user plane resources of all those PDU sessions
on the access the SERVICE REQUEST message is sent over; and
ii) request the SMF to perform a local release of user plane resources of all
those PDU sessions on the access type the SERVICE REQUEST message is sent
over. If the SERVICE REQUEST message is sent over 3GPP access and the MA PDU
session is associated with one or more multicast MBS sessions, the SMF shall
consider the UE as removed from the associated multicast MBS sessions.
If the AMF needs to initiate PDU session status synchronization or a PDU
session status IE was included in the SERVICE REQUEST message, the AMF shall
include a PDU session status IE in the SERVICE ACCEPT message to indicate:
\- which single access PDU sessions associated with the access type the
SERVICE ACCEPT message is sent over are not in 5GSM state PDU SESSION INACTIVE
in the AMF; and
\- which MA PDU sessions are not in 5GSM state PDU SESSION INACTIVE and having
user plane resources established in the AMF on the access the SERVICE ACCEPT
message is sent over.
If the PDU session status information element is included in the SERVICE
ACCEPT message, then:
a) for single access PDU sessions, the UE shall perform a local release of all
those PDU sessions which are not in 5GSM state PDU SESSION INACTIVE or PDU
SESSION ACTIVE PENDING on the UE side associated with the access type the
SERVICE ACCEPT message is sent over, but are indicated by the AMF as in 5GSM
state PDU SESSION INACTIVE. If a locally released PDU session is associated
with one or more multicast MBS sessions, the UE shall locally leave the
associated multicast MBS sessions; and
b) for MA PDU sessions, for all those PDU sessions which are not in 5GSM state
PDU SESSION INACTIVE or PDU SESSION ACTIVE PENDING and have user plane
resources established on the UE side associated with the access the SERVICE
ACCEPT message is sent over, but are indicated by the AMF as no user plane
resources established:
1) for MA PDU sessions having user plane resources established only on the
access type the SERVICE ACCEPT message is sent over, the UE shall perform a
local release of those MA PDU sessions. If a locally released MA PDU session
is associated with one or more multicast MBS sessions, the UE shall locally
leave the associated multicast MBS sessions; and
2) for MA PDU sessions having user plane resources established on both
accesses, the UE shall perform a local release on the user plane resources on
the access type the SERVICE ACCEPT message is sent over. If the user plane
resources over 3GPP access are released and the MA PDU session is associated
with one or more multicast MBS sessions, the UE shall locally leave the
associated multicast MBS sessions.
If the Uplink data status IE is included in the SERVICE REQUEST message and
the UE is:
a) not in NB-N1 mode; or
b) in NB-N1 mode and the UE does not indicate a request to have user-plane
resources established for a number of PDU sessions that exceeds the UE\'s
maximum number of supported user-plane resources;
the AMF shall:
a) indicate the SMF to re-establish the user-plane resources for the
corresponding PDU sessions;
b) include the PDU session reactivation result IE in the SERVICE ACCEPT
message to indicate the user-plane resources re-establishment result of the
PDU sessions for which the UE requested to re-establish the user-plane
resources; and
c) determine the UE presence in LADN service area and forward the UE presence
in LADN service area towards the SMF, if the corresponding PDU session is a
PDU session for LADN.
If the Allowed PDU session status IE is included in the SERVICE REQUEST
message, the AMF shall:
a) for a 5GSM message from each SMF that has indicated pending downlink
signalling only, forward the received 5GSM message via 3GPP access to the UE
after the SERVICE ACCEPT message is sent;
b) for each SMF that has indicated pending downlink data only:
1) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access cannot be
performed if the corresponding PDU session ID(s) are not indicated in the
Allowed PDU session status IE; and
2) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access can be performed
if:
i) for a UE not in NB-N1 mode, the corresponding PDU session ID(s) are
indicated in the Allowed PDU session status IE; or
ii) for a UE in NB-N1 mode, the corresponding PDU session ID(s) are indicated
in the Allowed PDU session status IE, and the resulting number of PDU sessions
with established user-plane resources does not exceed the UE\'s maximum number
of supported user-plane resources;
c) for each SMF that have indicated pending downlink signalling and data:
1) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access cannot be
performed if the corresponding PDU session ID(s) are not indicated in the
Allowed PDU session status IE;
2) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access can be performed
if:
i) for a UE not in NB-N1 mode, the corresponding PDU session ID(s) are
indicated in the Allowed PDU session status IE; or
ii) for a UE in NB-N1 mode, the corresponding PDU session ID(s) are indicated
in the Allowed PDU session status IE, and the resulting number of PDU sessions
with established user-plane resources does not exceed the UE\'s maximum number
of supported user-plane resources; and
3) discard the received 5GSM message for PDU session(s) associated with
non-3GPP access; and
d) include the PDU session reactivation result IE in the SERVICE ACCEPT
message to indicate the successfully re-established user-plane resources for
the corresponding PDU sessions, if any.
If due to regional subscription restrictions or access restrictions the UE is
not allowed to access the TA or due to CAG restrictions the UE is not allowed
to access the cell, but the UE has an emergency PDU session established, the
AMF may accept the SERVICE REQUEST message and indicate to the SMF to perform
a local release of all non-emergency PDU sessions (associated with 3GPP access
if it is due to CAG restrictions) and informs the UE via the PDU session
status IE in the SERVICE ACCEPT message. The AMF shall not indicate to the SMF
to release the emergency PDU session. If the AMF indicated to the SMF to
perform a local release of all non-emergency PDU sessions (associated with
3GPP access if it is due to CAG restrictions), the network shall behave as if
the UE is registered for emergency services.
If the PDU session reactivation result IE is included in the SERVICE ACCEPT
message indicating that the user-plane resources have been successfully
reactivated for a PDU session that was requested by the UE in the Allowed PDU
session status IE, the UE considers the corresponding PDU session to be
associated with the 3GPP access. If the user-plane resources of a PDU session
have been successfully reactivated over the 3GPP access, the AMF and SMF
update the associated access type of the corresponding PDU session.
If the user-plane resources cannot be established for a PDU session, the AMF
shall include the PDU session reactivation result IE in the SERVICE ACCEPT
message indicating that user-plane resources for the corresponding PDU session
cannot be re-established, and:
a) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the UE is located out of the LADN service area (see 3GPP TS
29.502 [20A]), the AMF shall include the PDU session reactivation result error
cause IE with the 5GMM cause set to #43 \"LADN not available\";
b) if the user-plane resources cannot be established because the SMF indicated
to the AMF that only prioritized services are allowed (see 3GPP TS 29.502
[20A]), the AMF shall include the PDU session reactivation result error cause
IE with the 5GMM cause set to #28 \"restricted service area\";
c) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the resource is not available in the UPF (see 3GPP TS 29.502
[20A]), the AMF shall include the PDU session reactivation result error cause
IE with the 5GMM cause set to #92 \"insufficient user-plane resources for the
PDU session\";
e) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the S-NSSAI associated with the PDU session is unavailable due
to NSAC (see 3GPP TS 29.502 [20A]), the AMF shall include the PDU session
reactivation result error cause IE with the 5GMM cause set to #69
\"insufficient resources for specific slice\"; or
d) otherwise, the AMF may include the PDU session reactivation result error
cause IE to indicate the cause of failure to re-establish the user-plane
resources.
NOTE 1: It is up to UE implementation when to re-send a request for user-plane
re-establishment for the associated PDU session after receiving a PDU session
reactivation result error cause IE with a 5GMM cause set to #92 \"insufficient
user-plane resources for the PDU session\".
NOTE 2: The UE can locally start a back-off timer after receiving a PDU
session reactivation result error cause IE with a 5GMM cause set to #69
\"insufficient resources for specific slice\". The value of the back-off timer
is up to UE implementation. Upon expiry of the back-off timer, the UE can re-
send a request for user-plane re-establishment for the associated PDU session.
If the PDU session reactivation result IE is included in the SERVICE ACCEPT
message indicating that the user-plane resources cannot be established for a
PDU session that was requested by the UE in the Allowed PDU session status IE,
the UE considers the corresponding PDU session to be associated with the
non-3GPP access.
If the MUSIM UE does not include the Paging restriction IE in the SERVICE
REQUEST message, the AMF shall delete any stored paging restriction for the UE
and stop restricting paging.
For case m in subclause 5.6.1.1 when the MUSIM UE sets the Request type to
\"NAS signalling connection release\" in the SERVICE REQUEST message, the AMF
shall initiate the release of the N1 NAS signalling connection after the
completion of the service request procedure.
For cases o and p in subclause 5.6.1.1 when the MUSIM UE sets the Request type
to \"NAS signalling connection release\" or to \"Rejection of paging\" in the
UE request type IE in the SERVICE REQUEST message and if the UE requests
restriction of paging by including the Paging restriction IE, the AMF:
\- if accepts the paging restriction, shall include the 5GS additional request
result IE in the SERVICE ACCEPT message and set the Paging restriction
decision to \"paging restriction is accepted\". The AMF shall store the paging
restriction of the UE and enforce these restrictions in the paging procedure
as described in clause 5.6.2; or
\- if rejects the paging restriction, shall include the 5GS additional request
result IE in the SERVICE ACCEPT message and set the Paging restriction
decision to \"paging restriction is rejected\", and shall discard the received
paging restriction. The AMF shall delete any stored paging restriction for the
UE and stop restricting paging; and
the AMF shall initiate the release of the N1 NAS signalling connection as
follows:
\- for case o in subclause 5.6.1.1, after the completion of the service
request procedure;
\- for case p in subclause 5.6.1.1, after the completion of the generic UE
configuration update procedure that is triggered after the completion of the
service request procedure.
If the SERVICE REQUEST message is for emergency services fallback, the AMF
triggers the emergency services fallback procedure as specified in subclause
4.13.4.2 of 3GPP TS 23.502 [9].
If the UE having an emergency PDU session sent the SERVICE REQUEST message
via:
a) a CAG cell and none of the CAG-IDs of the CAG cell are included in the
\"Allowed CAG list\" for the current PLMN in the UE\'s subscription; or
b) a non-CAG cell in a PLMN for which the UE\'s subscription contains an
\"indication that the UE is only allowed to access 5GS via CAG cells\";
the network shall accept the SERVICE REQUEST message and release all non-
emergency PDU sessions locally. The emergency PDU session shall not be
released.
If the AMF received the list of TAIs from the satellite NG-RAN as described in
3GPP TS 23.501 [8], and determines that, by UE subscription and operator\'s
preferences, any but not all TAIs in the received list of TAIs is forbidden
for roaming or for regional provision of service, the AMF shall include the
TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE; or
c) both;
in the SERVICE ACCEPT message.
NOTE 9: Void.
If the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the SERVICE ACCEPT message and the TAI(s)
included in the IE is not part of the list of \"5GS forbidden tracking areas
for roaming\", the UE shall store the TAI(s) included in the IE into the list
of \"5GS forbidden tracking areas for roaming\" and remove the TAI(s) from the
stored TAI list if present.
If the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the SERVICE ACCEPT
message and the TAI(s) included in the IE is not part of the list of \"5GS
forbidden tracking areas for regional provision of service\", the UE shall
store the TAI(s) included in the IE into the list of \"5GS forbidden tracking
areas for regional provision of service\" and remove the TAI(s) from the
stored TAI list if present.
##### 5.6.1.4.2 UE is using 5GS services with control plane CIoT 5GS
optimization
For case a in subclause 5.6.1.1, upon receipt of the CONTROL PLANE SERVICE
REQUEST message with Control plane service type indicating \"mobile
terminating request\", after completion of the 5GMM common procedures (if
initiated) according to subclause 5.6.1.3, the AMF shall send a SERVICE ACCEPT
message.
For cases c, d and m in subclause 5.6.1.1, upon receipt of the CONTROL PLANE
SERVICE REQUEST message with Control plane service type indicating \"mobile
originating request\", after completion of the 5GMM common procedures (if
initiated) according to subclause 5.6.1.3, the AMF shall send a SERVICE ACCEPT
message, except for case d when the DDX field of the Release assistance
indication IE or the DDX field of the CIoT small data container IE indicates
\"No further uplink and no further downlink data transmission subsequent to
the uplink data transmission is expected\".
For case a, c and d:
a) if the CIoT small data container IE is included in the message, the AMF
shall decipher the value part of the CIoT small data container IE and:
1) if the Data type field indicates \"control plane user data\", extract the
PDU session ID and data content from the CIoT small data container IE, look up
a PDU session routing context for the UE and the PDU session ID, and forward
the content of the CIoT small data container IE to the SMF associated with the
UE;
2) if the Data type field indicates \"SMS\", forward the content of the CIoT
small data container IE to the SMSF associated with the UE; or
3) if the Data type field indicates \"Location services message container\",
and if
i) length of additional information field in the CIoT small data container IE
is zero, forward the value of Data type field and the content of the CIoT
small data container IE to the to the location services application; or
ii) otherwise forward the value of Data type field and the content of the CIoT
small data container IE to the LMF associated with the routing information
that is included in the additional information field of the CIoT small data
container IE; or
NOTE 1: If the AMF determines there is no pending data or signalling for the
UE, the AMF provides an indication of control plane CIoT 5GS Optimisation to
the LMF as specified in 3GPP TS 29.518 [20B].
b) otherwise, the AMF shall decipher the value part of NAS message container
IE and:
1) if the Payload container IE is included in the CONTROL PLANE SERVICE
REQUEST message and if the Payload container type IE is set to \"CIoT user
data container\", the AMF shall look up a PDU session routing context for the
UE and the PDU session ID, and forward the content of the Payload container IE
to the SMF associated with the UE;
2) if the Payload container IE is included in the CONTROL PLANE SERVICE
REQUEST message and if the Payload container type IE is set to \"SMS\", the
AMF shall forward the content of the Payload container IE to the SMSF
associated with the UE;
3) if the PDU session status IE is included in the CONTROL PLANE SERVICE
REQUEST message or the AMF needs to perform a PDU session status
synchronization, the AMF shall include a PDU session status IE in the SERVICE
ACCEPT message to indicate which PDU sessions associated with the access type
the SERVICE ACCEPT message is sent over are active in the AMF;
4) if the Uplink data status IE is included in the CONTROL PLANE SERVICE
REQUEST message and the UE is:
i) not in NB-N1 mode; or
ii) in NB-N1 mode and the UE does not indicate a request to have user-plane
resources established for a number of PDU sessions that exceeds the UE\'s
maximum number of supported user-plane resources;
the AMF shall:
i) indicate the SMF to re-establish the user-plane resources for the
corresponding PDU sessions; and
ii) include the PDU session reactivation result IE in the SERVICE ACCEPT
message to indicate the user-plane resources re-establishment result of the
PDU sessions for which the UE requested to re-establish the user-plane
resources;
5) if the Uplink data status IE is included in the CONTROL PLANE SERVICE
REQUEST, the UE is in NB-N1 mode, and the UE indicates a request to have user-
plane resources established for a number of PDU sessions that exceeds the
UE\'s maximum number of supported user-plane resources, the AMF shall not
indicate to the SMF to re-establish the user-plane resources for the
corresponding PDU sessions; or
6) otherwise, if the Payload container IE is included in the message and if
the Payload container type IE is set to \"Location services message
container\", the AMF shall forward the Payload container type and the content
of the Payload container IE to the LMF associated with the routing information
included in the Additional information IE of the CONTROL PLANE SERVICE REQUEST
message.
NOTE 2: If the AMF determines there is no pending data or signalling for the
UE, the AMF provides an indication of control plane CIoT 5GS Optimisation to
the LMF as specified in 3GPP TS 29.518 [20B].
For case k) in subclause 5.6.1.1, if the Uplink data status IE is included in
the CONTROL PLANE SERVICE REQUEST message and the UE is:
a) not in NB-N1 mode; or
b) in NB-N1 mode and the UE does not indicate a request to have user-plane
resources established for a number of PDU sessions that exceeds the UE\'s
maximum number of supported user-plane resources,
the AMF shall:
a) indicate the SMF to re-establish the user-plane resources for the
corresponding PDU sessions; and
b) include the PDU session reactivation result IE in the SERVICE ACCEPT
message to indicate the user-plane resources re-establishment result of the
PDU sessions for which the UE requested to re-establish the user-plane
resources.
If the Allowed PDU session status IE is included in the CONTROL PLANE SERVICE
REQUEST message, the AMF shall:
a) for a 5GSM message from each SMF that has indicated pending downlink
signalling only, forward the received 5GSM message via 3GPP access to the UE
after the SERVICE ACCEPT message is sent;
b) for each SMF that has indicated pending downlink data only:
1) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access cannot be
performed if the corresponding PDU session ID(s) are not indicated in the
Allowed PDU session status IE; and
2) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access can be performed
if:
i) for a UE not in NB-N1 mode, the corresponding PDU session ID(s) are
indicated in the Allowed PDU session status IE; or
ii) for a UE in NB-N1 mode, the corresponding PDU session ID(s) are indicated
in the Allowed PDU session status IE and the resulting number of PDU sessions
with established user-plane resources does not exceed the UE\'s maximum number
of supported user-plane resources;
c) for each SMF that have indicated pending downlink signalling and data:
1) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access cannot be
performed if the corresponding PDU session ID(s) are not indicated in the
Allowed PDU session status IE;
2) notify the SMF that reactivation of the user-plane resources for the
corresponding PDU session(s) associated with non-3GPP access can be performed
if:
i) for a UE not in NB-N1 mode, the corresponding PDU session ID(s) are
indicated in the Allowed PDU session status IE; or
ii) for a UE in NB-N1 mode, the corresponding PDU session ID(s) are indicated
in the Allowed PDU session status IE and the resulting number of PDU sessions
with established user-plane resources does not exceed the UE\'s maximum number
of supported user-plane resources; and
3) discard the received 5GSM message for PDU session(s) associated with
non-3GPP access; and
d) include the PDU session reactivation result IE in the SERVICE ACCEPT
message to indicate the successfully re-established user-plane resources for
the corresponding PDU sessions, if any.
If the DDX field in the CIoT small data container IE or the DDX field of the
Release assistance indication IE indicates:
1) \"No further uplink and no further downlink data transmission subsequent to
the uplink data transmission is expected\" and if there is no downlink
signalling or downlink data for the UE; or
2) \"Only a single downlink data transmission and no further uplink data
transmission subsequent to the uplink data transmission is expected\" and upon
subsequent delivery of the next received downlink data transmission to the UE
and if there is no additional downlink signalling or downlink data for the UE,
the AMF initiates the release of the N1 NAS signalling connection (see 3GPP TS
23.502 [9]).
If the MUSIM UE does not include the Paging restriction IE in the CONTROL
PLANE SERVICE REQUEST message, the AMF shall delete any stored paging
restriction for the UE and stop restricting paging.
For case m in subclause 5.6.1.1 when the MUSIM UE sets the Request type to
\"NAS signalling connection release\" in the CONTROL PLANE SERVICE REQUEST
message, the AMF shall initiate the release of the N1 NAS signalling
connection after the completion of the service request procedure.
For cases o and p in subclause 5.6.1.1 when the MUSIM UE sets the Request type
to \"NAS signalling connection release\" or to \"Rejection of paging\" in the
UE request type IE in the CONTROL PLANE SERVICE REQUEST message and if the UE
requests restriction of paging by including the Paging restriction IE, the
AMF:
\- if accepts the paging restriction, shall include the 5GS additional request
result IE in the SERVICE ACCEPT message and set the Paging restriction
decision to \"paging restriction is accepted\". The AMF shall store the paging
restriction of the UE and enforce these restrictions in the paging procedure
as described in clause 5.6.2; or
\- if rejects the paging restriction, shall include the 5GS additional request
result IE in the SERVICE ACCEPT message and set the Paging restriction
decision to \"paging restriction is rejected\", and shall discard the received
paging restriction. The AMF shall delete any stored paging restriction for the
UE and stop restricting paging; and
the AMF shall send the SERVICE ACCEPT message and initiate the release of the
N1 NAS signalling connection as follows:
\- for case o in subclause 5.6.1.1, after the completion of the service
request procedure;
\- for case p in subclause 5.6.1.1, after the completion of the generic UE
configuration update procedure that is triggered after the completion of the
service request procedure.
Upon successful completion of the procedure, the UE shall reset the service
request attempt counter, stop the timer T3517 and enter the state 5GMM-
REGISTERED.
If the PDU session status information element is included in the CONTROL PLANE
SERVICE REQUEST message, then the AMF:
a) shall perform a local release of all those PDU sessions which are not in
5GSM state PDU SESSION INACTIVE on the AMF side associated with the access
type the CONTROL PLANE SERVICE REQUEST message is sent over, but are indicated
by the UE as being inactive, and
b) request the SMF to perform a local release of all those PDU sessions. If
any of those PDU sessions is associated with one or more multicast MBS
sessions, the SMF shall consider the UE as removed from the associated
multicast MBS sessions.
If the PDU session status information element is included in the SERVICE
ACCEPT message, then the UE shall perform a local release of all those PDU
sessions which are not in 5GSM state PDU SESSION INACTIVE or PDU SESSION
ACTIVE PENDING on the UE side associated with the 3GPP access but are
indicated by the AMF as being inactive. If a locally released PDU session is
associated with one or more multicast MBS sessions, the UE shall locally leave
the associated multicast MBS sessions.
If the user-plane resources cannot be established for a PDU session, the AMF
shall include the PDU session reactivation result IE in the SERVICE ACCEPT
message indicating that user-plane resources for the corresponding PDU session
cannot be re-established, and:
a) if the user-plane resources cannot be established because the SMF indicated
to the AMF that the UE is located out of the LADN service area (see 3GPP TS
29.502 [20A]), the AMF shall include the PDU session reactivation result error
cause IE with the 5GMM cause set to #43 \"LADN not available\";
b) if the user-plane resources cannot be established because the SMF indicated
to the AMF that only prioritized services are allowed (see 3GPP TS 29.502
[20A]), the AMF shall include the PDU session reactivation result error cause
IE with the 5GMM cause set to #28 \"restricted service area\"; or
c) if the user-plane resources cannot be established because:
1) the SMF indicated to the AMF that the resource is not available in the UPF
(see 3GPP TS 29.502 [20A]); or
2) the UE is in NB-N1 mode and the result will lead to user-plane resources
established for more than two PDU sessions (see 3GPP TS 23.502 [9])
the AMF shall include the PDU session reactivation result error cause IE with
the 5GMM cause set to #92\"insufficient user-plane resources for the PDU
session\":
NOTE 3: For a UE that is not in NB-N1 mode, it is up to UE implementation when
to re-send a request for user-plane re-establishment for the associated PDU
session after receiving a PDU session reactivation result error cause IE with
a 5GMM cause set to #92 \"insufficient user-plane resources for the PDU
session\".
If the PDU session reactivation result IE is included in the SERVICE ACCEPT
message indicating that the user-plane resources cannot be established for a
PDU session that was requested by the UE in the Allowed PDU session status IE,
the UE considers the corresponding PDU session to be associated with the
non-3GPP access.
For case d) in subclause 5.6.1.1, the UE shall also treat the indication from
the lower layers that the RRC connection has been released as successful
completion of the procedure. The UE shall reset the service request attempt
counter, stop the timer T3517 and enter the state 5GMM-REGISTERED.
Upon receipt of the CONTROL PLANE SERVICE REQUEST message with uplink data:
\- if the DDX field of the Release assistance indication IE or the DDX field
of the CIoT small data container IE is set to \"No further uplink and no
further downlink data transmission subsequent to the uplink data transmission
is expected\" in the message;
\- if the AMF decides to forward the uplink data piggybacked in the CONTROL
PLANE SERVICE REQUEST message; and
\- if the AMF decides to activate the congestion control for transport of user
data via the control plane,
then the AMF shall send SERVICE ACCEPT message with the T3448 value IE
included.
If the AMF decides to deactivate the congestion control for transport of user
data via the control plane, then the AMF shall delete the stored control plane
data back-off time for the UE and the AMF shall not include timer T3448 value
IE in the SERVICE ACCEPT message.
If the T3448 value IE is present in the received SERVICE ACCEPT message and
the value indicates that this timer is neither zero nor deactivated, the UE
shall:
a) stop timer T3448 if it is running;
b) consider the transport of user data via the control plane as successful;
and
c) start timer T3448 with the value provided in the T3448 value IE.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the
T3448 value IE is present in the SERVICE ACCEPT message and the value
indicates that this timer is either zero or deactivated, the UE shall ignore
the T3448 value IE and proceed as if the T3448 value IE was not present.
If the UE in 5GMM-IDLE mode initiated the service request procedure by sending
a CONTROL PLANE SERVICE REQUEST message and the SERVICE ACCEPT message does
not include the T3448 value IE and if timer T3448 is running, then the UE
shall stop timer T3448.
For case h) in subclause 5.6.1.1,
a) the UE shall treat the indication from the lower layers when the UE has
changed to S1 mode as successful completion of the procedure and stop timer
T3517;
b) if a UE operating in single-registration mode has changed to S1 mode, it
shall disable the N1 mode capability for 3GPP access (see subclause 4.9.2);
and
c) the AMF shall not check for CAG restrictions.
If the CONTROL PLANE SERVICE REQUEST message is for emergency services
fallback, the AMF triggers the emergency services fallback procedure as
specified in subclause 4.13.4.2 of 3GPP TS 23.502 [9].
#### 5.6.1.5 Service request procedure not accepted by the network
If the service request cannot be accepted, the network shall return a SERVICE
REJECT message to the UE including an appropriate 5GMM cause value.
If the SERVICE REJECT message with 5GMM cause #76 or #78 was received without
integrity protection, then the UE shall discard the message.
If the AMF needs to initiate PDU session status synchronisation or a PDU
session status IE was included in the SERVICE REQUEST message, the AMF shall
include a PDU session status IE in the SERVICE REJECT message to indicate
which PDU sessions associated with the access type the SERVICE REJECT message
is sent over are active in the AMF. If the PDU session status IE is included
in the SERVICE REJECT message and if the message is integrity protected, then:
a) for single access PDU sessions, the UE shall perform a local release of all
those PDU sessions which are not in 5GSM state PDU SESSION INACTIVE or PDU
SESSION ACTIVE PENDING on the UE side associated with the access type the
SERVICE REJECT message is sent over, but are indicated by the AMF as being in
5GSM state PDU SESSION INACTIVE. If a locally released PDU session is
associated with one or more MBS sessions, the UE shall locally leave the
associated MBS multicast sessions; and
b) for MA PDU sessions, for all those PDU sessions which are not in 5GSM state
PDU SESSION INACTIVE or PDU SESSION ACTIVE PENDING and have user plane
resources established on the UE side associated with the access the SERVICE
REJECT message is sent over, but are indicated by the AMF as no user plane
resources established:
1) for MA PDU sessions having user plane resources established only on the
access type the SERVICE REJECT message is sent over, the UE shall perform a
local release of those MA PDU sessions. If a locally released MA PDU session
is associated with one or more MBS multicast sessions, the UE shall locally
leave the associated MBS multicast sessions; and
2) for MA PDU sessions having user plane resources established on both
accesses, the UE shall perform a local release on the user plane resources on
the access type the SERVICE REJECT message is sent over. If the user plane
resources over 3GPP access are released and the MA PDU session is associated
with one or more MBS multicast sessions, the UE shall locally leave the
associated MBS multicast sessions.
If the service request for mobile originated services is rejected due to
general NAS level mobility management congestion control, the network shall
set the 5GMM cause value to #22 \"congestion\" and assign a value for back-off
timer T3346.
In NB-N1 mode, if the service request for mobile originated services is
rejected due to operator determined barring (see 3GPP TS 29.503 [20AB]), the
network shall set the 5GMM cause value to #22 \"congestion\" and assign a
value for back-off timer T3346.
If the service request from a UE supporting CAG is rejected due to CAG
restrictions, the network shall set the 5GMM cause value to #76 \"Not
authorized for this CAG or authorized for CAG cells only\" and should include
the \"CAG information list\" in the CAG information list IE or the Extended
CAG information list IE in the SERVICE REJECT message.
NOTE 1: The network cannot be certain that \"CAG information list\" stored in
the UE is updated as result of sending of the SERVICE REJECT message with the
CAG information list IE or the Extended CAG information list IE, as the
SERVICE REJECT message is not necessarily delivered to the UE (e.g., due to
abnormal radio conditions).
NOTE 2: The \"CAG information list\" can be provided by the AMF and include no
entry if no \"CAG information list\" exists in the subscription.
NOTE 2A: If the UE supports extended CAG information list, the CAG information
list can be included either in the CAG information list IE or Extended CAG
information list IE.
If the UE does not support extended CAG information list, the CAG information
list shall not be included in the Extended CAG information list IE.
If the service request from a UE not supporting CAG is rejected due to CAG
restrictions, the network shall operate as described in bullet h) of subclause
5.6.1.8.
Upon receipt of the CONTROL PLANE SERVICE REQUEST message with uplink data:
\- if the AMF decides to not forward the uplink data piggybacked in the
CONTROL PLANE SERVICE REQUEST message; and
\- if the AMF decides to activate the congestion control for transport of user
data via the control plane,
then the AMF shall send a SERVICE REJECT message and set the 5GMM cause value
to #22 \"congestion\" and assign a value for control plane data back-off timer
T3448.
If the AMF determines that the UE is in a non-allowed area or is not in an
allowed area as specified in subclause 5.3.5, then:
a) if the service type IE in the SERVICE REQUEST message is set to
\"signalling\" or \"data\", the AMF shall send a SERVICE REJECT message with
the 5GMM cause value set to #28 \"Restricted service area\";
b) otherwise, if the service type IE in the SERVICE REQUEST message is set to
\"mobile terminated services\", \"emergency services\", \"emergency services
fallback\", \"high priority access\" or \"elevated signalling\", the AMF shall
continue the process as specified in subclause 5.6.1.4 unless for other
reasons the service request cannot be accepted.
If the service request for mobile originated services is rejected due to
service gap control as specified in subclause 5.3.17, i.e. the T3447 timer is
running in AMF, the network shall set the 5GMM cause value to #22
\"Congestion\" and may include T3346 value IE in the SERVICE REJECT message
set to the remaining time of the running T3447 timer.
Based on operator policy, if the service request procedure is rejected due to
core network redirection for CIoT optimizations, the network shall set the
5GMM cause value to #31 \"Redirection to EPC required\".
NOTE 3: The network can take into account the UE\'s S1 mode capability, the
EPS CIoT network behaviour supported by the UE or the EPS CIoT network
behaviour supported by the EPC to determine the rejection with the 5GMM cause
value #31 \"Redirection to EPC required\".
If the service request is via a satellite NG-RAN cell, and the network
determines that the UE is in a location where the network is not allowed to
operate, see 3GPP TS 23.502 [9], the network shall set the 5GMM cause value in
the SERVICE REJECT message to #78 \"PLMN not allowed to operate at the present
UE location\".
If the service request from a UE supporting MINT is rejected due to a disaster
condition no longer being applicable in the current location of the UE, the
network shall set the 5GMM cause value to #11 \"PLMN not allowed\" or #13
\"Roaming not allowed in this tracking area\" and may include a disaster
return wait range in the Disaster return wait range IE in the SERVICE REJECT
message.
On receipt of the SERVICE REJECT message, if the UE is in state 5GMM-SERVICE-
REQUEST-INITIATED, the UE shall reset the service request attempt counter and
stop timer T3517 if running.
If the AMF received multiple TAIs from the satellite NG-RAN as described in
3GPP TS 23.501 [8], and determines that, by UE subscription and operator\'s
preferences, all of the received TAIs are forbidden for roaming or for
regional provision of service, the AMF shall include the TAI(s) in:
a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
roaming\" IE; or
b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE; or
c) both;
in the SERVICE REJECT message.
Regardless of the 5GMM cause value received in the SERVICE REJECT message via
satellite NG-RAN,
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE in the SERVICE REJECT message and if the
TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking
areas for roaming\", the UE shall store the TAI(s) included in the IE, if not
already stored, into the list of \"5GS forbidden tracking areas for roaming\";
and
\- if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for regional provision of service\" IE in the SERVICE REJECT
message and if the TAI(s) included in the IE is not part of the list of \"5GS
forbidden tracking areas for regional provision of service\", the UE shall
store the TAI(s) included in the IE, if not already stored, into the list of
\"5GS forbidden tracking areas for regional provision of service\".
Furthermore, the UE shall take the following actions depending on the 5GMM
cause value received in the SERVICE REJECT message.
#3 (Illegal UE);
#6 (Illegal ME);
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not registered for onboarding services in SNPN
and the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall consider the entry of the \"list of
subscriber data\" with the SNPN identity of the current SNPN as invalid until
the UE is switched off, the entry is updated or the timer T3245 expires as
described in clause 5.3.19a.2. In case of SNPN, if the UE is not registered
for onboarding services in SNPN and the UE supports access to an SNPN using
credentials from a credentials holder, the UE shall consider the selected
entry of the \"list of subscriber data\" as invalid for 3GPP access until the
UE is switched off, the entry is updated or the timer T3245 expires as
described in clause 5.3.19a.2. Additionally, if EAP based primary
authentication and key agreement procedure using EAP-AKA\' or 5G AKA based
primary authentication and key agreement procedure was performed in the
current SNPN, the UE shall consider the USIM as invalid for the current SNPN
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not registered for onboarding services in SNPN, the UE shall
delete the list of equivalent PLMNs (if any) and shall enter the state 5GMM-
DEREGISTERED.NO-SUPI. If the message has been successfully integrity checked
by the NAS, then the UE shall:
1) set the counter for \"SIM/USIM considered invalid for GPRS services\"
events and the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events to UE implementation-specific maximum value in case
of PLMN if the UE maintains these counters;
2) set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events to UE implementation-specific
maximum value in case of SNPN if the UE maintains these counters; and
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall handle the EMM parameters EMM state,
EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the service request
procedure is rejected with the EMM cause with the same value. The USIM shall
be considered as invalid also for non-EPS services until switching off, the
UICC containing the USIM is removed or the timer T3245 expires as described in
clause 5.3.7a in 3GPP TS 24.301 [15]. If the message has been successfully
integrity checked by the NAS and the UE maintains a counter for \"SIM/USIM
considered invalid for non-GPRS services\", then the UE shall set this counter
to UE implementation-specific maximum value.
If the UE is registered for onboarding services in SNPN, the UE shall store
the SNPN identity in the \"permanently forbidden SNPNs\" list for onboarding
services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN
selection or an SNPN selection for onboarding services according to 3GPP TS
23.122 [5]. If the message has been successfully integrity checked by the NAS,
the UE shall set the SNPN-specific attempt counter to the UE implementation-
specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access, the UE shall
in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
#7 (5GS services not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
In case of PLMN, the UE shall consider the USIM as invalid for 5GS services
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.1;
In case of SNPN, if the UE is not registered for onboarding services in SNPN
and the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall consider the entry of the \"list of
subscriber data\" with the SNPN identity of the current SNPN as invalid for
5GS services until the UE is switched off, the entry is updated or the timer
T3245 expires as described in clause 5.3.19a.2. In case of SNPN, if the UE is
not registered for onboarding services in SNPN and the UE supports access to
an SNPN using credentials from a credentials holder, the UE shall consider the
selected entry of the \"list of subscriber data\" as invalid for 3GPP access
until the UE is switched off, the entry is updated or the timer T3245 expires
as described in clause 5.3.19a.2. Additionally, if EAP based primary
authentication and key agreement procedure using EAP-AKA\' or 5G AKA based
primary authentication and key agreement procedure was performed in the
current SNPN, the UE shall consider the USIM as invalid for the current SNPN
until switching off, the UICC containing the USIM is removed or the timer
T3245 expires as described in clause 5.3.19a.2.
If the UE is not registered for onboarding services in SNPN, the UE shall
enter the state 5GMM-DEREGISTERED.NO-SUPI. If the message has been
successfully integrity checked by the NAS, then the UE shall:
1) set the counter for \"SIM/USIM considered invalid for GPRS services\"
events and the counter for \"USIM considered invalid for 5GS services over
non-3GPP access\" events to UE implementation-specific maximum value in case
of PLMN if the UE maintains these counters; or
2) set the counter for \"the entry for the current SNPN considered invalid for
3GPP access\" events and the counter for \"the entry for the current SNPN
considered invalid for non-3GPP access\" events to UE implementation-specific
maximum value in case of SNPN if the UE maintains these counters; and
3) delete the 5GMM parameters stored in non-volatile memory of the ME as
specified in annex C.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the service request
procedure is rejected with the EMM cause with the same value.
If the UE is registered for onboarding services in SNPN, the UE shall store
the SNPN identity in the \"permanently forbidden SNPNs\" list for onboarding
services, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN
selection or an SNPN selection for onboarding services according to 3GPP TS
23.122 [5]. If the message has been successfully integrity checked by the NAS,
the UE shall set the SNPN-specific attempt counter to the UE implementation-
specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access, the UE shall
in addition handle 5GMM parameters and 5GMM state for this access, as
described for this 5GMM cause value.
NOTE 4: The possibility to configure a UE so that the radio transceiver for a
specific radio access technology is not active, although it is implemented in
the UE, is outside the scope of the present document.
#9 (UE identity cannot be derived by the network).
The UE shall set the 5GS update status to 5U2 NOT UPDATED (and shall store it
according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited
registered TAI, TAI list and ngKSI. The UE shall enter the state 5GMM-
DEREGISTERED.
If the service request was initiated for emergency services fallback, the UE
shall attempt to select an E-UTRA cell connected to EPC or 5GCN according to
the domain priority and selection rules specified in 3GPP TS 23.167 [6]. If
the UE finds a suitable E-UTRA cell, it then proceeds with the appropriate EMM
or 5GMM procedures. If the UE operating in single-registration mode has
changed to S1 mode, it shall disable the N1 mode capability for 3GPP access.
If the service request was initiated for any reason other than emergency
services fallback or initiating an emergency PDU session, the UE shall perform
a new initial registration procedure.
NOTE 5: User interaction is necessary in some cases when the UE cannot re-
establish the PDU session(s) automatically.
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall handle the EMM parameters EMM state,
EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the service request
procedure is rejected with the EMM cause with the same value.
#10 (Implicitly de-registered).
The UE shall enter the state 5GMM-DEREGISTERED.NORMAL-SERVICE. The UE shall
delete any mapped 5G NAS security context or partial native 5G NAS security
context.
If the service request was initiated for emergency services fallback, the UE
shall attempt to select an E-UTRA cell connected to EPC or 5GCN according to
the domain priority and selection rules specified in 3GPP TS 23.167 [6]. If
the UE finds a suitable E-UTRA cell, it then proceeds with the appropriate EMM
or 5GMM procedures. If the UE operating in single-registration mode has
changed to S1 mode, it shall disable the N1 mode capability for 3GPP access.
If the rejected request was neither for initiating an emergency PDU session
nor for emergency services fallback, the UE shall perform a new initial
registration procedure.
NOTE 6: User interaction is necessary in some cases when the UE cannot re-
establish the PDU session(s) automatically.
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall handle the EMM state as specified in
3GPP TS 24.301 [15] for the case when the service request procedure is
rejected with the EMM cause with the same value.
#11 (PLMN not allowed).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs and store the PLMN identity in the forbidden PLMN list as
specified in subclause 5.3.13A and if the UE is configured to use timer T3245
then the UE shall start timer T3245 and proceed as described in clause
5.3.19a.1. For 3GPP access, the UE shall enter the state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP TS
23.122 [5], and for non-3GPP access the UE shall enter state 5GMM-
DEREGISTERED.LIMITED-SERVICE and perform network selection as defined in 3GPP
TS 24.502 [18]. If the message has been successfully integrity checked by the
NAS and the UE mantains the PLMN-specific attempt counter and the PLMN-
specific attempt counter for non-3GPP access for that PLMN, the UE shall set
the PLMN-specific attempt counter and the PLMN-specific attempt counter for
non-3GPP access for that PLMN to the UE implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition handle the EMM parameters EMM
state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and
eKSI as specified in 3GPP TS 24.301 [15] for the case when the service request
procedure is rejected with the EMM cause with the same value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
If the UE receives the Disaster return wait range IE in the SERVICE REJECT
message and the UE supports MINT, the UE shall delete the disaster return wait
range stored in the ME, if any, and store the disaster return wait range
included in the Disaster return wait range IE in the ME.
#12 (Tracking area not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.
If the SERVICE REJECT message is not integrity protected, the UE shall
memorize the current TAI was stored in the list of \"5GS forbidden tracking
areas for regional provision of service\" for non-integrity protected NAS
reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for regional
provision of service\" for the current SNPN and, if the UE supports access to
an SNPN using credentials from a credentials holder, the selected entry of the
\"list of subscriber data\" or the selected PLMN subscription, and enter the
state 5GMM-DEREGISTERED.LIMITED-SERVICE. If the SERVICE REJECT message is not
integrity protected, the UE shall memorize the current TAI was stored in the
list of \"5GS forbidden tracking areas for regional provision of service\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, for non-integrity protected NAS
reject message.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the service request
procedure is rejected with the EMM cause with the same value.
#13 (Roaming not allowed in this tracking area).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2). For 3GPP access the UE shall enter
the state 5GMM-REGISTERED.PLMN-SEARCH, and for non-3GPP access the UE shall
enter the state 5GMM-REGISTERED.LIMITED-SERVICE.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
and remove the current TAI from the stored TAI list if present. If the SERVICE
REJECT message is not integrity protected, the UE shall memorize the current
TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for
non-integrity protected NAS reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for roaming\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, and remove the current TAI from the
stored TAI list if present. If the SERVICE REJECT message is not integrity
protected, the UE shall memorize the current TAI was stored in the list of
\"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the
UE supports access to an SNPN using credentials from a credentials holder, the
selected entry of the \"list of subscriber data\" or the selected PLMN
subscription, for non-integrity protected NAS reject message.
For 3GPP access the UE shall perform a PLMN selection or SNPN selection
according to 3GPP TS 23.122 [5], and for non-3GPP access the UE shall perform
network selection as defined in 3GPP TS 24.502 [18].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state and EPS
update status as specified in 3GPP TS 24.301 [15] for the case when the
service request procedure is rejected with the EMM cause with the same value.
If the UE receives the Disaster return wait range IE in the SERVICE REJECT
message and the UE supports MINT, the UE shall delete the disaster return wait
range stored in the ME, if any, and store the disaster return wait range
included in the Disaster return wait range IE in the ME.
#15 (No suitable cells in tracking area).
The UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE.
If:
1) the UE is not operating in SNPN access operation mode, the UE shall store
the current TAI in the list of \"5GS forbidden tracking areas for roaming\"
and remove the current TAI from the stored TAI list if present. If the SERVICE
REJECT message is not integrity protected, the UE shall memorize the current
TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for
non-integrity protected NAS reject message; or
2) the UE is operating in SNPN access operation mode, the UE shall store the
current TAI in the list of \"5GS forbidden tracking areas for roaming\" for
the current SNPN and, if the UE supports access to an SNPN using credentials
from a credentials holder, the selected entry of the \"list of subscriber
data\" or the selected PLMN subscription, and remove the current TAI from the
stored TAI list if present. If the SERVICE REJECT message is not integrity
protected, the UE shall memorize the current TAI was stored in the list of
\"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the
UE supports access to an SNPN using credentials from a credentials holder, the
selected entry of the \"list of subscriber data\" or the selected PLMN
subscription, for non-integrity protected NAS reject message.
If the UE initiated service request for emergency services fallback, the UE
shall attempt to select an E-UTRA cell connected to EPC or 5GC according to
the emergency services support indicator (see 3GPP TS 36.331 [25A]). If the UE
finds a suitable E-UTRA cell, it then proceeds with the appropriate EMM or
5GMM procedures. If the UE operating in single-registration mode has changed
to S1 mode, it shall disable the N1 mode capability for 3GPP access.
If the service request was not initiated for emergency services fallback, the
UE shall search for a suitable cell in another tracking area according to 3GPP
TS 38.304 [28] or 3GPP TS 36.304 [25C].
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall handle the EMM parameters EMM state and
EPS update status as specified in 3GPP TS 24.301 [15] for the case when the
service request procedure is rejected with the EMM cause with the same value.
If received over non-3GPP access the cause shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.6.1.7.
#22 (Congestion).
If the T3346 value IE is present in the SERVICE REJECT message and the value
indicates that this timer is neither zero nor deactivated, the UE shall
proceed as described below, otherwise it shall be considered as an abnormal
case and the behaviour of the UE for this case is specified in subclause
5.6.1.7.
If the rejected request was not for initiating an emergency PDU session, the
UE shall abort the service request procedure and enter state 5GMM-REGISTERED
and stop timer T3517 if still running.
The UE shall stop timer T3346 if it is running.
If the SERVICE REJECT message is integrity protected, the UE shall start timer
T3346 with the value provided in the T3346 value IE.
If the SERVICE REJECT message is not integrity protected, the UE shall start
timer T3346 with a random value from the default range specified in 3GPP TS
24.008 [12].
For all other cases the UE stays in the current serving cell and applies
normal cell reselection process. The service request procedure is started, if
still necessary, when timer T3346 expires or is stopped.
If the message was received via 3GPP access and the UE is operating in the
single-registration mode, the UE shall handle the EMM parameters EMM state and
EPS update status as specified in 3GPP TS 24.301 [15] for the case when the
service request procedure is rejected with the EMM cause with the same value.
If the service request procedure was initiated for an MO MMTEL voice call
(i.e. access category 4), or for an MO MMTEL video call (i.e. access category
5) or for an MO IMS registration related signalling (i.e. access category 9),
a notification that the service request was not accepted due to congestion
shall be provided to the upper layers.
If the UE is using 5GS services with control plane CIoT 5GS optimization and
if the T3448 value IE is present in the SERVICE REJECT message and the value
indicates that this timer is neither zero nor deactivated, the UE shall:
a) stop timer T3448 if it is running;
b) consider the transport of user data via the control plane as unsuccessful;
and
c) start timer T3448:
1) with the value provided in the T3448 value IE if the SERVICE REJECT message
is integrity protected; or
2) with a random value from the default range specified in 3GPP TS 24.301 [15]
table 10.2.1 if the SERVICE REJECT message is not integrity protected.
If the UE is using 5GS services with control plane CIoT 5GS optimization, the
T3448 value IE is present in the SERVICE REJECT message and the value
indicates that this timer is either zero or deactivated, the UE shall ignore
the T3448 value IE and:
a) stop timer T3448 if it is running; and
b) consider the transport of user data via the control plane as unsuccessful.
If the UE is using 5GS services with control plane CIoT 5GS optimization and
if the T3448 value IE is not present in the SERVICE REJECT message, it shall
be considered as an abnormal case and the behaviour of UE for this case is
specified in subclause 5.6.1.7.
#27 (N1 mode not allowed).
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall enter the state 5GMM-
REGISTERED.LIMITED-SERVICE. If the message has been successfully integrity
checked by the NAS, the UE shall set:
1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-
specific N1 mode attempt counter for non-3GPP access for that PLMN in case of
PLMN; or
2) the SNPN-specific attempt counter for 3GPP access for the current SNPN and
the SNPN-specific attempt counter for non-3GPP access for the current SNPN in
case of SNPN
to the UE implementation-specific maximum value.
The UE shall disable the N1 mode capability for the specific access type for
which the message was received (see subclause 4.9).
If the message has been successfully integrity checked by the NAS, the UE
shall disable the N1 mode capability also for the other access type (see
subclause 4.9).
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED and enter the state EMM-REGISTERED.
#28 (Restricted service area).
The UE shall enter the state 5GMM-REGISTERED.NON-ALLOWED-SERVICE, wait for the
release of the N1 NAS signalling connection and perform the registration
procedure for mobility and periodic registration update if the service type IE
in the SERVICE REQUEST message was not set to \"elevated signalling\" and the
SERVICE REJECT message is received over 3GPP access (see subclause 5.3.5 and
5.5.1.3).
If the service type IE in the SERVICE REQUEST message was set to \"elevated
signalling\", the UE shall not re-initiate service request procedure until the
UE enters an allowed area or leaves a non-allowed area, except for emergency
services, high priority access or responding to paging or notification.
#31 (Redirection to EPC required).
5GMM cause #31 received by a UE that has not indicated support for CIoT
optimizations or received by a UE over non-3GPP access is considered an
abnormal case and the behaviour of the UE is specified in subclause 5.6.1.7.
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2). The UE shall reset the service
request attempt counter and enter the state 5GMM-REGISTERED.LIMITED-SERVICE.
The UE shall enable the E-UTRA capability if it was disabled and disable the
N1 mode capability for 3GPP access (see subclause 4.9.2).
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters, EMM state, and EPS
update status as specified in 3GPP TS 24.301 [15] for the case when the
service request procedure is rejected with the EMM cause with the same value.
#36 (IAB-node operation not authorized).
This cause value is only applicable when received over 3GPP access by a UE
operating as an IAB-node. This cause value received from a 5G access network
other than 3GPP access or received by a UE not operating as an IAB-node is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI.
If:
1) the UE is not operating in SNPN access operation mode,
i) the UE shall delete the list of equivalent PLMNs and store the PLMN
identity in the forbidden PLMN list as specified in subclause 5.3.13A and if
the UE is configured to use timer T3245 then the UE shall start timer T3245
and proceed as described in clause 5.3.19a.1. The UE shall enter the state
5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP
TS 23.122 [5]. If the message has been successfully integrity checked by the
NAS and the UE maintains the PLMN-specific attempt counter for 3GPP access for
that PLMN, the UE shall set the PLMN-specific attempt counter for 3GPP access
for that PLMN to the UE implementation-specific maximum value; and
ii) If the UE is operating in single-registration mode, the UE shall in
addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last
visited registered TAI, TAI list and eKSI as specified in 3GPP TS 24.301 [15]
for the case when the service request procedure is rejected with the EMM cause
with the same value; or
2) the UE is operating in SNPN access operation mode,
i) the UE shall store the SNPN identity in the \"temporarily forbidden SNPNs\"
list for 3GPP access and, if the UE supports access to an SNPN using
credentials from a credentials holder, the selected entry of the \"list of
subscriber data\" or the selected PLMN subscription. The UE shall enter state
5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP
TS 23.122 [5]. If the message has been successfully integrity checked by the
NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access for
the current SNPN to the UE implementation-specific maximum value.
#72 (Non-3GPP access to 5GCN not allowed).
If the UE initiated the service request procedure over non-3GPP access, the UE
shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last visited
registered TAI, TAI list and ngKSI for non-3GPP access. Additionally, the UE
shall enter the state 5GMM-DEREGISTERED for non-3GPP access. If the message
has been successfully integrity checked by the NAS, the UE shall set:
1) the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN
in case of PLMN; or
2) the SNPN-specific attempt counter for non-3GPP access for that SNPN in case
of SNPN;
to the UE implementation-specific maximum value.
NOTE 7: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
The UE shall disable the N1 mode capability for non-3GPP access (see subclause
4.9.3).
As an implementation option, if the UE is not currently registered over 3GPP
access, the UE may enter the state 5GMM-DEREGISTERED.PLMN-SEARCH in order to
perform a PLMN selection according to 3GPP TS 23.122 [5].
If received over 3GPP access the cause shall be considered as an abnormal case
and the behaviour of the UE for this case is specified in subclause 5.6.1.7.
#73 (Serving network not authorized).
This cause value received from a cell belonging to an SNPN is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall delete the list of
equivalent PLMNs, store the PLMN identity in the forbidden PLMN list as
specified in subclause 5.3.13A. For 3GPP access the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection according to
3GPP TS 23.122 [5], and for non-3GPP access the UE shall enter state 5GMM-
DEREGISTERED.LIMITED-SERVICE in order to perform network selection as defined
in 3GPP TS 24.502 [18]. If the message has been successfully integrity checked
by the NAS, the UE shall set the PLMN-specific attempt counter and the PLMN-
specific attempt counter for non-3GPP access for that PLMN to the UE
implementation-specific maximum value.
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED, enter the state EMM-DEREGISTERED and shall delete any
4G-GUTI, last visited registered TAI, TAI list and eKSI.
#74 (Temporarily not authorized for this SNPN).
5GMM cause #74 is only applicable when received from a cell belonging to an
SNPN. 5GMM cause #74 received from a cell not belonging to an SNPN is
considered as an abnormal case and the behaviour of the UE is specified in
subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall store the SNPN
identity in the \"temporarily forbidden SNPNs\" list for the specific access
type for which the message was received and, if the UE supports access to an
SNPN using credentials from a credentials holder, the selected entry of the
\"list of subscriber data\" or the selected PLMN subscription. If the UE is
not registered for onboarding services in SNPN, the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP TS
23.122 [5]. If the UE is registered for onboarding services in SNPN, the UE
shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection
or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].
If the message has been successfully integrity checked by the NAS, the UE
shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-
specific attempt counter for non-3GPP access for the current SNPN to the UE
implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
NOTE 8: When 5GMM cause #74 is received over 3GPP access, the term \"other
access\" in \"the UE also supports the registration procedure over the other
access to the same SNPN\" is used to express access to SNPN services via a
PLMN.
NOTE 9: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
#75 (Permanently not authorized for this SNPN).
5GMM cause #75 is only applicable when received from a cell belonging to an
SNPN with a globally-unique SNPN identity. 5GMM cause #75 received from a cell
not belonging to an SNPN or a cell belonging to an SNPN with a non-globally-
unique SNPN identity is considered as an abnormal case and the behaviour of
the UE is specified in subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. The UE shall store the SNPN
identity in the \"permanently forbidden SNPNs\" list for the specific access
type for which the message was received and, if the UE supports access to an
SNPN using credentials from a credentials holder, the selected entry of the
\"list of subscriber data\" or the selected PLMN subscription. If the UE is
not registered for onboarding services in SNPN, the UE shall enter state 5GMM-
DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP TS
23.122 [5]. If the UE is registered for onboarding services in SNPN, the UE
shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection
or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].
If the message has been successfully integrity checked by the NAS, the UE
shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-
specific attempt counter for non-3GPP access for the current SNPN to the UE
implementation-specific maximum value.
If the message has been successfully integrity checked by the NAS and the UE
also supports the registration procedure over the other access to the same
SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this
access, as described for this 5GMM cause value.
NOTE 10: When 5GMM cause #75 is received over 3GPP access, the term \"other
access\" in \"the UE also supports the registration procedure over the other
access to the same SNPN\" is used to express access to SNPN services via a
PLMN.
NOTE 11: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
#76 (Not authorized for this CAG or authorized for CAG cells only).
This cause value received via non-3GPP access or from a cell belonging to an
SNPN is considered as an abnormal case and the behaviour of the UE is
specified in subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3.ROAMING NOT ALLOWED, store the
5GS update status according to clause 5.1.3.2.2.
If 5GMM cause #76 is received from:
1) a CAG cell, and if the UE receives a \"CAG information list\" in the CAG
information list IE or the Extended CAG information list IE included in the
SERVICE REJECT message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received
\"CAG information list\" when received in the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 12: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall delete the CAG-ID from the \"allowed CAG list\" for
the current PLMN. In the case the \"allowed CAG list\" for the current PLMN
only contains a range of CAG-IDs, how the UE deletes the CAG-ID(s) of the cell
from the \"allowed CAG list\" for the current PLMN is up to UE implementation.
In addition:
i) if the entry in the \"CAG information list\" for the current PLMN does not
include an \"indication that the UE is only allowed to access 5GS via CAG
cells\" or if the entry in the \"CAG information list\" for the current PLMN
includes an \"indication that the UE is only allowed to access 5GS via CAG
cells\" and the updated \"allowed CAG list\" for the current PLMN includes one
or more CAG-IDs, then the UE shall enter the state 5GMM-REGISTERED.LIMITED-
SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28]
or 3GPP TS 36.304 [25C] with the updated \"CAG information list\";
ii) if the entry in the \"CAG information list\" for the current PLMN includes
an \"indication that the UE is only allowed to access 5GS via CAG cells\" and
the updated \"allowed CAG list\" for the current PLMN does not include any
CAG-ID, then the UE shall enter the state 5GMM-REGISTERED.PLMN-SEARCH and
shall apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\"; or
iii) if the \"CAG information list\" does not include an entry for the current
PLMN, then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP TS
36.304 [25C] with the updated \"CAG information list\".
2) a non-CAG cell, and if the UE receives a \"CAG information list\" in the
CAG information list IE or the Extended CAG information list IE included in
the SERVICE REJECT message, the UE shall:
i) replace the \"CAG information list\" stored in the UE with the received
\"CAG information list\" when received in the HPLMN or EHPLMN;
ii) replace the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE with the serving VPLMN\'s entry of the received CAG information list
IE or the Extended CAG information list IE when the UE receives the CAG
information list IE or the Extended CAG information list IE in a serving PLMN
other than the HPLMN or EHPLMN; or
NOTE 13: When the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries
of a PLMN other than the serving VPLMN, if any, in the received CAG
information list IE or the Extended CAG information list IE are ignored.
iii) remove the serving VPLMN\'s entry of the \"CAG information list\" stored
in the UE when the UE receives the CAG information list IE or the Extended CAG
information list IE in a serving PLMN other than the HPLMN or EHPLMN and the
CAG information list IE or the Extended CAG information list IE does not
contain the serving VPLMN\'s entry.
Otherwise, the UE shall store an \"indication that the UE is only allowed to
access 5GS via CAG cells\" in the entry of the \"CAG information list\" for
the current PLMN, if any. If the \"CAG information list\" stored in the UE
does not include the current PLMN\'s entry, the UE shall add an entry for the
current PLMN to the \"CAG information list\" and store an \"indication that
the UE is only allowed to access 5GS via CAG cells\" in the entry of the \"CAG
information list\" for the current PLMN. If the UE does not have a stored
\"CAG information list\", the UE shall create a new \"CAG information list\"
and add an entry with an \"indication that the UE is only allowed to access
5GS via CAG cells\" for the current PLMN.
In addition:
i) if the \"allowed CAG list\" for the current PLMN includes one or more CAG-
IDs, then the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE and
shall search for a suitable cell according to 3GPP TS 38.304 [28] with the
updated CAG information; or
ii) if the \"allowed CAG list\" for the current PLMN does not include any CAG-
ID, then the UE shall enter the state 5GMM-REGISTERED.PLMN-SEARCH and shall
apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the
updated \"CAG information list\".
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall in addition set the EPS update status to EU3
ROAMING NOT ALLOWED, reset the service request attempt counter and enter the
state EMM-REGISTERED.
#77 (Wireline access area not allowed).
5GMM cause #77 is only applicable when received from a wireline access network
by the 5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the
N5GC device). 5GMM cause #77 received from a 5G access network other than a
wireline access network and 5GMM cause #77 received by the W-AGF acting on
behalf of the FN-BRG are considered as abnormal cases and the behaviour of the
UE is specified in subclause 5.6.1.7.
When received over wireline access network, the 5G-RG and the W-AGF acting on
behalf of the FN-CRG (or on behalf of the N5GC device) shall set the 5GS
update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to
subclause 5.1.3.2.2), shall delete 5G-GUTI, last visited registered TAI, TAI
list and ngKSI, shall enter the state 5GMM-DEREGISTERED and shall act as
specified in subclause 5.3.23.
NOTE 14: The 5GMM sublayer states, the 5GMM parameters and the registration
status are managed per access type independently, i.e. 3GPP access or non-3GPP
access (see subclauses 4.7.2 and 5.1.3).
#78 (PLMN not allowed to operate at the present UE location).
This cause value received from a non-satellite NG-RAN cell is considered as an
abnormal case and the behaviour of the UE is specified in subclause 5.6.1.7.
The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall
store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last
visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset
the registration attempt counter. The UE shall store the PLMN identity and, if
it is known, the current geographical location in the list of \"PLMNs not
allowed to operate at the present UE location\" and shall start a
corresponding timer instance (see subclause 4.23.2). The UE shall enter state
5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP
TS 23.122 [5].
If the message was received via 3GPP access and the UE is operating in single-
registration mode, the UE shall handle the EMM parameters EMM state, EPS
update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as
specified in 3GPP TS 24.301 [15] for the case when the service request
procedure is rejected with the EMM cause with the same value.
#### 5.6.1.6 Service request procedure for initiating an emergency PDU session
not accepted by the network
If the service request for initiating an emergency PDU session cannot be
accepted by the network, the UE shall perform the procedures as described in
subclause 5.6.1.5. Then if the UE is in the same selected PLMN where the last
service request was attempted, the UE shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 1: This can result in the upper layers requesting another emergency call
attempt using domain selection as specified in 3GPP TS 23.167 [6].
b) de-register locally, if not de-registered already, attempt initial
registration for emergency services.
If the service request for initiating an emergency PDU session fails due to
abnormal cases a) in subclause 5.6.1.7, the UE shall perform the procedures as
described in subclause 5.6.1.7. Then if the UE is in the same selected PLMN
where the last SERVICE REQUEST message was attempted, the UE shall:
a) inform the upper layers of the failure of the procedure; or
NOTE 2: This can result in the upper layers requesting another emergency call
attempt using domain selection as specified in 3GPP TS 23.167 [6] and 3GPP TS
24.229 [14].
b) de-register locally, if not de-registered already, attempt initial
registration for emergency services.
#### 5.6.1.6A Service request procedure for an emergency services fallback not
accepted by the network
If the service request for initiating an emergency services fallback cannot be
accepted by the network, the UE shall perform the procedures as described in
subclause 5.6.1.5 and if the UE does not attempt to select an E-UTRA cell
connected to EPC or 5GCN as described in subclause 5.6.1.5 and is camped on NR
or E-UTRA cell connected to 5GCN in the same PLMN where the last service
request was attempted, the UE shall inform the upper layers of the failure of
the procedure.
NOTE 1: This can result in the upper layers requesting another emergency call
attempt using domain selection as specified in 3GPP TS 23.167 [6].
If the service request for initiating an emergency services fallback fails due
to abnormal cases a) in subclause 5.6.1.7, the UE shall inform the upper
layers of the failure of the emergency services fallback.
NOTE 2: This can result in the upper layers requesting another emergency call
attempt using domain selection as specified in 3GPP TS 23.167 [6].
If the service request procedure for initiating an emergency services fallback
fails due to abnormal cases other than a) in subclause 5.6.1.7, the UE may
abort the service request procedure, if not aborted already and attempt to
select an E-UTRA cell connected to EPC or 5GCN according to the domain
priority and selection rules specified in 3GPP TS 23.167 [6]. If the UE finds
a suitable E-UTRA cell, it then proceeds with the appropriate EMM or 5GMM
procedures. If the UE operating in single-registration mode has changed to S1
mode, it shall disable the N1 mode capability for 3GPP access.
#### 5.6.1.7 Abnormal cases in the UE
The following abnormal cases can be identified:
a) T3517 expired.
The UE shall enter the state 5GMM-REGISTERED.
If the UE triggered the service request procedure in 5GMM-IDLE mode sending a:
1) SERVICE REQUEST message and the service type of the SERVICE REQUEST message
was not set to \"emergency services fallback\"; or
2) CONTROL PLANE SERVICE REQUEST message and the control plane service type of
the CONTROL PLANE SERVICE REQUEST message was not set to \"emergency services
fallback\";
then the 5GMM sublayer shall increment the service request attempt counter,
abort the procedure and release locally any resources allocated for the
service request procedure. The service request attempt counter shall not be
incremented, if:
1) the service request procedure is initiated to establish an emergency PDU
session;
2) the UE has an emergency PDU session established;
3) the UE is a UE configured for high priority access in selected PLMN;
4) the service request procedure is initiated in response to paging or
notification from the network; or
5) the UE in NB-N1 mode is requested by the upper layer to transmit user data
related to an exceptional event and the UE is allowed to use exception data
reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration
MO in 3GPP TS 24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102
[22]).
If the service request attempt counter is greater than or equal to 5, the UE
shall start timer T3525. Additionally, if the service request procedure was
initiated for an MO MMTEL voice call or for an MO MMTEL video call or for an
MO IMS registration related signalling, a notification that the service
request was not initiated due to the UE having started timer T3525 shall be
provided to the upper layers.
NOTE 1: This can result in the upper layers requesting implementation specific
mechanisms, e.g. the MMTEL voice call being attempted to another IP-CAN, or
establishment of a CS voice call (if supported and not already attempted in
the CS domain).
The UE shall not attempt service request until expiry of timer T3525 unless:
1) the service request procedure is initiated in response to paging or
notification from the network;
2) the UE is a UE configured for high priority access in selected PLMN;
3) the service request procedure is initiated to establish an emergency PDU
session;
4) the UE has an emergency PDU session established;
5) the service request procedure is initiated for emergency services fallback;
6) the UE is registered in a new PLMN; or
NOTE 2: According to Table 10.2.1, when \"UE camped on a new PLMN other than
the PLMN on which timer started\", timer T3525 is stopped, hence this check
may be skipped.
7) the UE in NB-N1 mode is requested by the upper layer to transmit user data
related to an exceptional event and the UE is allowed to use exception data
reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration
MO in 3GPP TS 24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102
[22]).
NOTE 3: The NAS signalling connection can also be released if the UE deems
that the network has failed the authentication check as specified in subclause
5.4.1.3.7.
If the UE triggered the service request procedure in 5GMM-CONNECTED mode
sending a:
1) SERVICE REQUEST message and the service type of the SERVICE REQUEST message
was not set to \"emergency services fallback\"; or
2) CONTROL PLANE SERVICE REQUEST message and the control plane service type of
the CONTROL PLANE SERVICE REQUEST message was not set to \"emergency services
fallback\",
the 5GMM sublayer shall abort the procedure, and stay in 5GMM-CONNECTED mode.
If the service type of the SERVICE REQUEST message was set to \"emergency
services fallback\" or the control plane service type of the CONTROL PLANE
SERVICE REQUEST message was set to \"emergency services fallback\" and:
1) the service request procedure was triggered in 5GMM-IDLE mode, the 5GMM
sublayer shall abort the procedure, release locally any resources allocated
for the service request procedure; or
2) the service request procedure was triggered in 5GMM-CONNECTED mode, the
5GMM sublayer shall abort the procedure, stay in 5GMM-CONNECTED mode.
b) The lower layers indicate that the access attempt is barred.
The UE shall not start the service request procedure. The UE stays in the
current serving cell and applies the normal cell reselection process. Receipt
of the access barred indication shall not trigger the selection of a different
core network type (EPC or 5GCN).
The service request procedure is started, if still needed, when the lower
layers indicate that the barring is alleviated for the access category with
which the access attempt was associated.
ba) The lower layers indicate that:
1) access barring is applicable for all access categories except categories 0
and 2 and the access category with which the access attempt was associated is
other than 0 and 2; or
2) access barring is applicable for all access categories except category 0
and the access category with which the access attempt was associated is other
than 0.
If the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST has not been
sent, the UE shall proceed as specified for case b.
If the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST has been sent:
1) the UE shall abort the service request procedure and stop timer T3517. The
UE stays in the current serving cell and applies the normal cell reselection
process; and
2) the service request procedure is started, if still needed, when the lower
layers indicate that the barring is alleviated for the access category with
which the access attempt was associated.
For additional UE requirements for both cases see subclause 4.5.5.
c) Timer T3346 is running.
The UE shall not start the service request procedure unless:
1) the UE receives a paging;
2) the UE receives a NOTIFICATION message over non-3GPP access when the UE is
in 5GMM-CONNECTED mode over non-3GPP access and in 5GMM-IDLE mode over 3GPP
access;
3) the UE receives a NOTIFICATION message over 3GPP access when the UE is in
5GMM-CONNECTED mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP
access;
4) the UE is a UE configured for high priority access in selected PLMN;
5) the UE has an emergency PDU session established or is establishing an
emergency PDU session;
6) the service request procedure is initiated for emergency services fallback;
7) the service request procedure is initiated for elevated signalling;
8) the UE in NB-N1 mode is requested by the upper layer to transmit user data
related to an exceptional event and:
\- the UE is allowed to use exception data reporting (see the
ExceptionDataReportingAllowed leaf of the NAS configuration MO in 3GPP TS
24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102 [22]); and
\- timer T3346 was not started when N1 NAS signalling connection was
established with RRC establishment cause set to \"mo-ExceptionData\"; or
9) the MUSIM UE is in 5GMM-CONNECTED mode and requests the network to release
the NAS signalling connection (see case o in subclause 5.6.1.1).
If the UE is in 5GMM-IDLE mode, the UE stays in the current serving cell and
applies normal cell reselection process. The service request procedure is
started, if still necessary, when timer T3346 expires or is stopped.
If the service request procedure was triggered for an MO MMTEL voice call
(i.e. access category 4), or for an MO MMTEL video call (i.e. access category
5) or for an MO IMS registration related signalling (i.e. access category 9),
a notification that the service request procedure was not initiated due to
congestion shall be provided to the upper layers.
If the UE receives a paging with access type set to \"Non-3GPP access\" and
the non-3GPP access is available and UE is in 5GMM-REGISTERED.NORMAL SERVICE
over non-3GPP access, the UE shall stop timer T3346 and send the SERVICE
REQUEST message over non-3GPP access.
d) Registration procedure for mobility and periodic registration update is
triggered.
The UE shall abort the service request procedure, stop timer T3517, if running
and perform the registration procedure for mobility and periodic registration
update. The Follow-on request indicator in the REGISTRATION REQUEST message
shall be handled as specified in clause 5.5.1.3.2.
e) Switch off.
If the UE is in state 5GMM-SERVICE-REQUEST-INITIATED at switch off, the de-
registration procedure shall be performed.
f) De-registration procedure collision.
If the UE receives a DEREGISTRATION REQUEST message from the network in state
5GMM-SERVICE-REQUEST-INITIATED, the UE shall progress the DEREGISTRATION
REQUEST message and the service request procedure shall be aborted.
NOTE 4: The above collision case is valid if the DEREGISTRATION REQUEST
message indicates the access type over which the service request procedure is
attempted otherwise both the procedures are progressed.
g) Transmission failure of SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST
message indication with change in the current TAI.
If the current TAI is not in the TAI list, UE shall abort the service request
procedure to perform the registration procedure for mobility and periodic
registration update as specified in subclause 5.5.1.3.2.
If the current TAI is part of the TAI list, the UE shall restart the service
request procedure unless the service request procedure is initiated for case
o) or p) in subclause 5.6.1.1. For case o) and p) in subclause 5.6.1.1 the UE
shall abort the service request procedure, enters state 5GMM-REGISTERED,
locally release the N1 NAS signalling connection, stop timer T3517 and locally
release any resources allocated for the service request procedure.
h) Transmission failure of SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST
message indication without change in the current TAI.
The UE shall restart the service request procedure unless the service request
procedure is initiated for case o) or p) in subclause 5.6.1.1. For case o) and
p) in subclause 5.6.1.1 the UE shall abort the service request procedure,
enters state 5GMM-REGISTERED, locally release the N1 NAS signalling
connection, stop timer T3517 and locally release any resources allocated for
the service request procedure.
i) SERVICE REJECT message received with other 5GMM cause values than those
treated in subclause 5.6.1.5, and cases of 5GMM cause values #11, #15, #22,
#31, #72, #73, #74, #75, #76, #77 and #78 that are considered as abnormal
cases according to subclause 5.6.1.5.
The UE shall enter state 5GMM-REGISTERED.
The UE shall abort the service request procedure, stop timer T3517 and locally
release any resources allocated for the service request procedure.
j) The UE in 5GMM-CONNECTED mode with RRC inactive indication over the 3GPP
access, and in 5GMM-CONNECTED mode over non-3GPP access, receives a
NOTIFICATION message over the non-3GPP access with access type indicating 3GPP
access.
The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication
to 5GMM-IDLE mode over 3GPP access and initiate the service request procedure
over the 3GPP access.
k) Timer T3447 is running
The UE shall not start any service request procedure unless:
1) the UE in 5GMM-IDLE receives a paging request;
2) the UE is a UE configured for high priority access;
3) the UE has a PDU session for emergency services established or is
establishing a PDU session for emergency services;
4) the service request procedure is initiated for emergency services fallback;
> 5) the UE in 5GMM-CONNECTED mode receives mobile terminated signalling or
> downlink data over the user-plane;
6) the service request procedure is initiated for elevated signalling; or
7) the MUSIM UE requests the network to release the NAS signalling connection
(see case o in subclause 5.6.1.1).
> The UE stays in the current serving cell and applies the normal cell
> reselection process. The service request procedure is started, if still
> necessary, when timer T3447 expires or timer T3447 is stopped.
l) Lower layer failure, release of the N1 signalling connection received from
lower layers or the lower layers indicate that the RRC connection has been
suspended before the service request procedure is completed or SERVICE REJECT
message is received.
The UE shall abort the service request procedure, stop timer T3517, locally
release any resources allocated for the service request procedure and enters
state 5GMM-REGISTERED. For case m) in subclause 5.6.1.1 the UE may retry the
service request procedure a certain number of times (maximum re-attempts 5).
m) Timer T3448 is running
The UE in 5GMM-IDLE mode shall not initiate the service request procedure for
transport of user data via the control plane unless:
1) the UE is a UE configured for high priority access in selected PLMN;
2) the UE which is only using 5GS services with control plane CIoT 5GS
optimization received a paging request;
3) the UE in NB-N1 mode is requested by the upper layer to transmit user data
related to an exceptional event and the UE is allowed to use exception data
reporting (see the ExceptionDataReportingAllowed leaf of the NAS configuration
MO in 3GPP TS 24.368 [17] or the USIM file EF~NASCONFIG~ in 3GPP TS 31.102
[22]); or
4) the UE is initiating the service request procedure to request emergency
services or emergency services fallback.
The UE stays in the current serving cell and applies the normal cell
reselection process. The service request procedure is started, if still
necessary, when timer T3448 expires.
#### 5.6.1.8 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Lower layer failure.
If a lower layer failure occurs before a SERVICE REJECT message has been sent
to the UE or the service request procedure has been completed by the AMF, the
AMF enters/stays in 5GMM-IDLE.
b) Protocol error.
If the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message is
received with a protocol error, the AMF shall return a SERVICE REJECT message
with one of the following 5GMM cause values:
#96 invalid mandatory information;
#99 information element non-existent or not implemented;
#100 conditional IE error; or
#111 protocol error, unspecified.
The AMF stays in the current 5GMM mode.
c) More than one SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST
message received before the procedure has been completed (i.e., before SERVICE
REJECT message has been sent or service request procedure has been completed).
\- If one or more of the information elements in the SERVICE REQUEST message
or CONTROL PLANE SERVICE REQUEST message differs from the ones received within
the previous SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message,
the previously initiated service request procedure shall be aborted, and the
new service request procedure shall be progressed;
\- If the information elements do not differ, then the AMF shall continue with
the previous service request procedure and shall not treat any further this
SERVICE REQUEST message or this CONTROL PLANE SERVICE REQUEST message.
d) REGISTRATION REQUEST message received with \"initial registration\" or
\"emergency registration\" in the 5GS registration type IE before a SERVICE
REJECT message has been sent or the service request procedure has been
completed.
If a REGISTRATION REQUEST message with \"initial registration\" or \"emergency
registration\" in the 5GS registration type IE is received and the service
request procedure has not been completed or a SERVICE REJECT message has not
been sent, the AMF may initiate the 5GMM common procedures, e.g. the primary
authentication and key agreement procedure. The AMF may e.g. after a
successful primary authentication and key agreement procedure execution, abort
the service request procedure, delete the 5GMM context, indicate towards the
SMF that the 5GMM context has been deleted and progress the new REGISTRATION
REQUEST message.
e) REGISTRATION REQUEST message received with \"mobility registration
updating\" or \"periodic registration updating\" in the 5GS registration type
IE received before the service request procedure has been completed or a
SERVICE REJECT message has been sent.
If a REGISTRATION REQUEST message with \"mobility registration updating\" or
\"periodic registration updating\" in the 5GS registration type IE is received
and the service request procedure has not been completed or a SERVICE REJECT
message has not been sent, the AMF may initiate the 5GMM common procedures,
e.g. the primary authentication and key agreement procedure. The AMF may e.g.
after a successful primary authentication and key agreement procedure
execution, abort the service request procedure and progress the new
REGISTRATION REQUEST message.
f) If a CONTROL PLANE SERVICE REQUEST message with Control plane service type
indicating \"mobile originating request\" is received after the AMF initiated
a paging procedure, the AMF shall treat this CONTROL PLANE SERVICE REQUEST as
a paging response and handle the message according to subclauses 5.6.1.4 and
5.6.1.5.
g) CONTROL PLANE SERVICE REQUEST message received with the Data type field
indicates \"control plane user data\" in the CIoT small data container IE or
received with Payload container type IE set to \"CIoT user data container\"
and:
1) the AMF does not have a PDU session routing context for the PDU session ID
and the UE; or
2) the AMF unsuccessfully attempted to forward the user data container and the
PDU session ID,
then the AMF may send back to the UE the CIoT user data container or control
plane user data which was not forwarded as specified in subclause 5.4.5.3.1
case l1) or case l2).
h) Based on operator policy, if the service request from a UE not supporting
CAG is rejected due to CAG restrictions, the network shall reject the service
request with a 5GMM cause value other than the 5GMM cause #76 (Not authorized
for this CAG or authorized for CAG cells only).
NOTE: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not
allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving
network not authorized) can be used depending on the subscription of the UE
and whether the UE roams or not.
### 5.6.2 Paging procedure
#### 5.6.2.1 General
The paging procedure is performed only in 3GPP access and used by the network
to request the establishment of a NAS signalling connection to the UE. The
paging procedure is also used by the network to request the UE to re-establish
the user-plane resources of PDU sessions for downlink user data transport.
Another purpose of the paging procedure is to request the UE to re-establish
the user-plane resources of PDU session(s) associated with non-3GPP access
over 3GPP access.
Additionally, the network can use the paging procedure to initiate the mobile
terminating SMS.
For the UE using eDRX, the network initiates the paging procedure when NAS
signalling messages or user data is pending to be sent to the UE within the
paging time window and requests the lower layers to include the eDRX cycle
length and paging time window length in the paging message. If NAS signalling
messages or user data is pending to be sent to the UE outside the paging time
window and the eDRX value that the network provides to the UE in the
Negotiated extended DRX parameters IE during the last registration procedure
indicates:
a) the eDRX cycle length duration of the E-UTRA cell connected to 5GCN, is
higher than 5.12 seconds; or
b) the eDRX cycle length duration of the NR cell connected to 5GCN, is higher
than 10.24 seconds,
the network initiates the paging procedure at T time ahead of the beginning of
the next paging time window.
NOTE: T time is a short time period based on implementation. The operator can
take possible imperfections in the synchronization between the 5GCN and the UE
into account when choosing T time.
If the network detects that the pending user data to be sent to the UE is
related to the voice service as specified in 3GPP TS 23.502 [9] and the
network decides to initiate the paging procedure based on the stored paging
restriction information, if any, the AMF should request the lower layer to
include the Voice Service Indication in the paging message when the UE and the
network support the paging **indication for voice services**.
#### 5.6.2.2 Paging for 5GS services
##### 5.6.2.2.1 General
The network shall initiate the paging procedure for 5GS services when NAS
signalling messages or user data is pending to be sent to the UE in 5GMM-IDLE
mode over 3GPP access (see example in figure 5.6.2.2.1.1) and there is no
paging restriction applied in the network for that paging.
Figure 5.6.2.2.1.1: Paging procedure
To initiate the procedure the 5GMM entity in the AMF requests the lower layer
to start paging and shall start timer T3513.
If downlink signalling or user data is pending to be sent over non-3GPP
access, the 5GMM entity in the AMF shall indicate to the lower layer that the
paging is associated to non-3GPP access.
The network shall not page the UE to re-establish user-plane resources of PDU
session(s) associated with non-3GPP access over 3GPP access if all the PDU
sessions of the UE that are established over the 3GPP access are associated
with control plane only indication.
If the network has downlink user data pending for a UE, the AMF has stored
paging restriction of the UE and the Paging restriction type in the stored
paging restriction is set to:
a) \"All paging is restricted\", the network should not page the UE;
b) \"All paging is restricted except for voice service\", the network should
page the UE only when:
1) the pending downlink user data for the UE is considered as voice service
related by the network;
c) \"All paging is restricted except for specified PDU session(s)\", the
network should page the UE only when:
1) for PDU session(s) that paging is not restricted based on the stored paging
restriction, the network has downlink user data pending; or
d) \"All paging is restricted except for voice service and specified PDU
session(s)\", the network should page the UE only when:
1) the pending downlink user data for the UE is considered as voice service
related by the network; or
2) for PDU session(s) that paging is not restricted based on the stored paging
restriction, the network has downlink user data pending.
If the network has downlink signalling pending for a UE and the AMF has stored
paging restriction of the UE and the Paging restriction type in the stored
paging restriction is set to:
a) \"All paging is restricted\", the network should not page the UE;
b) \"All paging is restricted except for voice service\", the network should
page the UE only when:
1) the pending downlink signalling for the UE is 5GMM signalling or 5GSM
signalling of the PDU session of voice service;
c) \"All paging is restricted except for specified PDU session(s)\", the
network should page the UE only when:
1) the pending downlink signalling for the UE is 5GMM signalling; or
2) for PDU session(s) that paging is not restricted based on the stored paging
restriction, the network has downlink 5GSM signalling pending; or
d) \"All paging is restricted except for voice service and specified PDU
session(s)\", the network should page the UE only when:
1) the pending downlink signalling for the UE is 5GMM signalling or 5GSM
signalling of the PDU session of voice service; or
2) for PDU session(s) that paging is not restricted based on the stored paging
restriction, the network has downlink 5GSM signalling pending.
NOTE 1: If the network pages the UE due to downlink signalling pending, the
network initiates the release of the N1 NAS signalling connection after
network-requested procedure is completed.
The 5GMM entity in the AMF may provide the lower layer with the \"allowed CAG
list\" and an \"indication that the UE is only allowed to access 5GS via CAG
cells\" for the current PLMN, if available, and with the \"allowed CAG list\"
and an \"indication that the UE is only allowed to access 5GS via CAG cells\"
per equivalent PLMN, if available. If there is an active emergency PDU
session, the 5GMM entity in the AMF shall not provide the lower layer with the
\"allowed CAG list\" and an \"indication that the UE is only allowed to access
5GS via CAG cells\" for the current PLMN, even if available, or with the
\"allowed CAG list\" and an \"indication that the UE is only allowed to access
5GS via CAG cells\" per equivalent PLMN, even if available.
Upon reception of a paging indication, the UE shall stop the timer T3346, if
running, and:
a) if control plane CIoT 5GS optimization is not used by the UE, the UE shall:
1) initiate a service request procedure over 3GPP access to respond to the
paging as specified in subclauses 5.6.1.2.1 if the UE is in 5GMM-
REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-ALLOWED-SERVICE (as described
in subclause 5.3.5.2) state and the UE is in the 5GMM-IDLE mode without
suspend indication;
2) initiate a service request procedure over non-3GPP access to respond to the
paging as specified in subclauses 5.6.1;
3) initiate a registration procedure for mobility and periodic registration
update over 3GPP access to respond to the paging as specified in subclauses
5.5.1.3.2; or
4) proceed as specified in subclause 5.3.1.5 if the UE is in the 5GMM-IDLE
mode with suspend indication; or
b) if control plane CIoT 5GS optimization is used by the UE, the UE shall:
1) initiate a service request procedure as specified in subclause 5.6.1.2.2 if
the UE is in the 5GMM-IDLE mode without suspend indication;
2) initiate a registration procedure for mobility and periodic registration
update over 3GPP access as specified in subclauses 5.5.1.3.2; or
3) proceed as specified in subclause 5.3.1.5 if the UE is in the 5GMM-IDLE
mode with suspend indication.
NOTE 2: If the UE is in the 5GMM-IDLE mode without suspend indication and has
an uplink user data to be sent to the network using control plane CIoT 5GS
optimization when receiving the paging indication, the UE can piggyback the
uplink user data during the service request procedure initiated to respond to
the paging, as specified in subclause 5.6.1.2.2.
The MUSIM UE based on implementation may use the paging cause indicated by
lower layers (see 3GPP TS 38.331 [30]), if any, to accept the paging, reject
the paging or ignore the paging indication.
Upon reception of a paging indication, if the network supports the rejection
of paging request and if a MUSIM UE decides not to accept the paging, the UE
may initiate a service request procedure to reject the paging as specified in
clause 5.6.1.1.
NOTE 3: As an implementation option, MUSIM UE is allowed to not respond to
paging based on the information available in the paging message, e.g. voice
service indication.
If TMGI is used as paging identity and the TMGI matches with multicast MBS
session which the has UE joined, the UE shall respond to the paging.
Otherwise, the UE shall not respond to the paging.
The network shall stop timer T3513 for the paging procedure when an integrity-
protected response is received from the UE and successfully integrity checked
by the network or when the 5GMM entity in the AMF receives an indication from
the lower layer that it has received the NGAP UE context resume request
message as specified in 3GPP TS 38.413 [31]. If the response received is not
integrity protected, or the integrity check is unsuccessful, timer T3513 for
the paging procedure shall be kept running unless:
a) the UE is registered for emergency services;
b) the UE has an emergency PDU session; or
c) the response received is a REGISTRATION REQUEST message for mobility and
periodic registration update and the security mode control procedure or
authentication procedure performed during mobility and periodic registration
update has completed successfully.
Upon expiry of timer T3513, the network may reinitiate paging.
If the network, while waiting for a response to the paging sent without paging
priority, receives downlink signalling or downlink data associated with
priority user-plane resources for PDU sessions, the network shall stop timer
T3513, and then initiate the paging procedure with paging priority.
##### 5.6.2.2.2 Abnormal cases on the network side
The following abnormal case can be identified:
a) Void.
##### 5.6.2.2.3 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Paging message received with access type set to non-3GPP access while the
UE is in 5GMM-CONNECTED mode over non-3GPP access.
The UE shall not respond to paging message.
b) Paging message received with access type set to 3GPP access when UE-
initiated 5GMM specific procedure or service request procedure is ongoing.
The UE shall proceed with 5GMM specific procedure or service request
procedure. If for these procedures lower layers indicate that the access
attempt is barred, then the UE shall handle the pending paging message as
specified in subclause 5.6.2.2.1. Otherwise, the UE shall ignore the paging
once lower layers confirm the establishment of the signalling connection.
### 5.6.3 Notification procedure
#### 5.6.3.1 General
The notification procedure is used by the network:
a) to request the UE, by sending the NOTIFICATION message over 3GPP access, to
re-establish the user-plane resources of PDU session(s) associated with
non-3GPP access over 3GPP access or to deliver 5GSM downlink signalling
messages associated with non-3GPP access over 3GPP access when the UE is in
5GMM-IDLE mode over non-3GPP access and in 5GMM-CONNECTED mode over 3GPP
access; or
b) to request the UE, by sending the NOTIFICATION message over non-3GPP
access, to re-establish user-plane resources of the PDU session(s) or to
deliver downlink signalling associated with 3GPP access over 3GPP access when
the UE is in 5GMM-CONNECTED mode over non-3GPP access and:
1) in 5GMM-IDLE mode over 3GPP access when the UE is not in MICO mode; or
2) in 5GMM-IDLE mode with suspend indication over 3GPP access when the UE is
not in MICO mode.
The network shall not use the NOTIFICATION message to re-establish user-plane
resources of PDU session(s) associated with non-3GPP access over 3GPP access
if all the PDU sessions of the UE that are established over the 3GPP access
are associated with control plane only indication. .
The network shall not use the NOTIFICATION message over non-3GPP access, if:
a) the MUSIM UE supports the paging indication for voice services;
b) the network has indicated \"paging indication for voice services
supported\" to the UE; and
c) the AMF detects that the downlink data is related to voice service (see
3GPP TS 23.501 [8]).
#### 5.6.3.2 Notification procedure initiation
The network shall initiate the notification procedure by sending the
NOTIFICATION message to the UE and start timer T3565 (see example in figure
5.6.3.2.1).
For case a) in subclause 5.6.3.1, the NOTIFICATION message is sent from the
network to the UE via 3GPP access with access type indicating non-3GPP access.
For case b) in subclause 5.6.3.1, the NOTIFICATION message is sent from the
network to the UE via non-3GPP access with access type indicating 3GPP access
when the UE is not in MICO mode.
Figure 5.6.3.2.1: Notification procedure
Upon reception of a NOTIFICATION message, the UE shall stop the timer T3346,
if running.
For case a) in subclause 5.6.3.1, upon reception of NOTIFICATION message, the
UE shall initiate a service request procedure over 3GPP access as specified in
subclauses 5.6.1.
NOTE: For a UE in NB-NI mode, if there is DL user data pending for a PDU
session associated with non-3GPP access then the AMF notifies the SMF that
reactivation of user plane resources cannot be performed if the number of PDU
sessions that currently has user-plane resources established equals to the
UE\'s maximum number of supported user-plane resources.
For case b) in subclause 5.6.3.1, upon reception of NOTIFICATION message:
a) if control plane CIoT 5GS optimization is not used by the UE, the UE shall:
1) initiate a service request procedure over 3GPP access as specified in
subclause 5.6.1.2.1, if the UE is in 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-
REGISTERED.NON-ALLOWED-SERVICE (as described in subclause 5.3.5.2) state over
3GPP access or 5GMM-REGISTERED.NON-ALLOWED-SERVICE state (see subclause
5.3.5.2), and the UE is in the 5GMM-IDLE mode without suspend indication;
2) initiate a registration procedure for mobility and periodic registration
update over 3GPP access as specified in subclause 5.5.1.3.2, if the UE is in
5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE state over 3GPP access; or
3) proceed as specified in subclause 5.3.1.5 if the UE is in the 5GMM-IDLE
mode with suspend indication;
b) if control plane CIoT 5GS optimization is used by the UE, the UE shall:
1) initiate a service request procedure over 3GPP access as specified in
subclause 5.6.1.2.2, if the UE is in 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-
REGISTERED.NON-ALLOWED-SERVICE (as described in subclause 5.3.5.2) state and
the UE is in the 5GMM-IDLE mode without suspend indication;
2) initiate a registration procedure for mobility and periodic registration
update over 3GPP access as specified in subclause 5.5.1.3.2, if the UE is in
5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE state; or
3) proceed as specified in subclause 5.3.1.5 if the UE is in the 5GMM-IDLE
mode with suspend indication; or
c) if:
1) the UE is in 5GMM-REGISTERED.NO-CELL-AVAILABLE state, 5GMM-REGISTERED.PLMN-
SEARCH state, 5GMM-REGISTERED.LIMITED-SERVICE state or 5GMM-REGISTERED.UPDATE-
NEEDED state over 3GPP access; or
2) the MUSIM UE is not able to respond the NOTIFICATION message as specified
in case a) and b) above, e.g., due to UE implementation constraints;
the UE shall respond with NOTIFICATION RESPONSE message over non-3GPP access
indicating inability of the UE to initiate a service request procedure or a
registration procedure over 3GPP access and may include the PDU session status
information element to indicate:
1) the single access PDU session(s) not in 5GSM state PDU SESSION INACTIVE in
the UE associated with the 3GPP access type; and
2) the MA PDU session(s) not in 5GSM state PDU SESSION INACTIVE in the UE and
having user plane resources established associated with the 3GPP access type.
Upon reception of NOTIFICATION message:
For case b) in subclause 5.6.3.1, if the UE is in 5GMM-REGISTERED.NO-CELL-
AVAILABLE state or 5GMM-REGISTERED.PLMN-SEARCH state and a local release was
performed in the UE for the single access PDU sessions associated with the
3GPP access or for user plane resources on the 3GPP access of MA PDU sessions;
then the UE shall respond with NOTIFICATION RESPONSE message over non-3GPP
access indicating with the PDU session status information element that:
\- the local release of its single access PDU sessions associated with the
3GPP access was performed; and
\- the local release of its 3GPP access user plane resources of MA PDU
sessions was performed.
#### 5.6.3.3 Notification procedure completion
Upon reception of SERVICE REQUEST message, CONTROL PLANE SERVICE REQUEST
message or REGISTRATION REQUEST message, the AMF shall stop timer T3565 and
proceed service request procedure as specified in subclauses 5.6.3.1 or
registration procedure for mobility and periodic registration update as
specified in subclauses 5.5.1.3. If no user-plane resources of PDU session(s)
need to be re-established, the AMF should notify the SMF that the UE was
reachable but did not accept to re-establish the user-plane resources of PDU
session(s).
When the 5GMM entity in the AMF receives an indication from the lower layer
that it has received the NGAP UE context resume request message as specified
in 3GPP TS 38.413 [31], the AMF shall stop timer T3565.
Upon reception of NOTIFICATION RESPONSE message over non-3GPP access, the AMF
shall stop timer T3565 and should notify the SMF that the UE is unreachable.
If the NOTIFICATION RESPONSE message includes the PDU session status
information element, then:
a) for single access PDU sessions, the AMF shall:
1) perform a local release of all those PDU sessions which are not in 5GSM
state PDU SESSION INACTIVE on the AMF side associated with 3GPP access, but
are indicated by the UE in the PDU session status information element in the
NOTIFICATION RESPONSE message as being in 5GSM state PDU SESSION INACTIVE; and
2) shall request the SMF to perform a local release of all those PDU sessions
associated with 3GPP access. If any of those PDU sessions is associated with
one or more multicast MBS sessions, the SMF shall consider the UE as removed
from the associated multicast MBS sessions; and
b) For MA PDU sessions, the AMF shall:
1) for MA PDU sessions having user plane resources established only on the
3GPP access in the AMF side, but are indicated by the UE in the PDU session
status information element in the NOTIFICATION RESPONSE message as no user
plane resources established on the 3GPP access:
i) perform a local release of all those MA PDU sessions; and
ii) request the SMF to perform a local release of all those MA PDU sessions.
If the MA PDU session is associated with one or more multicast MBS sessions,
the SMF shall consider the UE as removed from the associated multicast MBS
sessions; and
2) for MA PDU sessions having user plane resources established on both
accesses in the AMF side, but are indicated by the UE in the PDU session
status information element in the NOTIFICATION RESPONSE message as no user
plane resources established on the 3GPP access:
i) perform a local release of 3GPP access user plane resources of all those MA
PDU sessions; and
ii) request the SMF to perform a local release of 3GPP access user plane
resources of all those MA PDU sessions. If the MA PDU session is associated
with one or more multicast MBS sessions, the SMF shall consider the UE as
removed from the associated multicast MBS sessions.
#### 5.6.3.4 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Expiry of timer T3565.
The network shall, on the first expiry of the timer T3565, retransmit the
NOTIFICATION message and shall reset and start timer T3565. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3565, the procedure shall be aborted. In addition, upon the fifth expiry of
timer T3565:
For case a) in subclause 5.6.3.1, the AMF should notify the SMF that the UE is
unreachable. The AMF may enter 5GMM-IDLE mode over 3GPP access.
For case b) in subclause 5.6.3.1, the AMF may either:
1) perform the paging procedure over the 3GPP access; or
2) notify the SMF that the UE is unreachable.
NOTE: Whether the AMF performs the paging procedure or notifies the SMF is up
to operator\'s policies.
b) De-registration procedure collision
If the network receives a DEREGISTRATION REQUEST message before it receives a
SERVICE REQUEST message or REGISTRATION REQUEST message, the AMF shall stop
timer T3565 and proceed de-registration procedure as specified in subclause
5.5.2.
#### 5.6.3.5 Abnormal cases on the UE side
The following abnormal cases can be identified:
a) NOTIFICATION message received via non-3GPP access with access type
indicating 3GPP access when UE-initiated 5GMM specific procedure or service
request procedure over 3GPP access is ongoing.
The UE shall proceed with 5GMM specific procedure or service request
procedure. If for these procedures lower layers indicate that the access
attempt is barred, then the UE shall handle the pending NOTIFICATION message
as specified in subclause 5.6.3.2. Otherwise, the UE shall ignore the
NOTIFICATION message once lower layers confirms the establishment of the
signalling connection.
# 6 Elementary procedures for 5GS session management
## 6.1 Overview
### 6.1.1 General
This clause describes the procedures used for 5GS session management (5GSM)
performed over an N1 NAS signalling connection.
The main function of the 5GSM sublayer is to support the PDU session handling
in the UE and in the SMF (transferred via the AMF).
The 5GSM comprises procedures for:
\- the authentication and authorization, establishment, modification and
release of PDU sessions; and
\- request for performing handover of an existing PDU session between 3GPP
access and non-3GPP access, or to transfer an existing PDN connection in the
EPS to the 5GS.
Each PDU session represents a PDU session established between the UE and an
SMF. PDU sessions can remain established even if the radio and network
resources constituting the corresponding PDU session between the UE and the
SMF are temporarily released.
5GSM procedures can be performed only if a 5GMM context has been established
between the UE and the AMF, and the secure exchange of NAS messages has been
initiated by the AMF by use of the 5GMM procedures described in clause 5. Once
the UE is successfully registered to a PLMN, a PDU session can be established.
If no 5GMM context has been established, the 5GMM sublayer has to initiate the
establishment of a 5GMM context by use of the 5GMM procedures as described in
clause 5.
The UE can request the network to modify or release PDU sessions. The network
can fulfil such a request from the UE by modifying a PDU session or releasing
a PDU session using network-requested procedures (see subclause 6.3).
### 6.1.2 Types of 5GSM procedures
Three types of 5GSM procedures can be distinguished:
a) Procedures related to PDU sessions:
These procedures are initiated by the network and are used for authentication
and authorization or manipulation of PDU sessions:
1) PDU authentication and authorization;
2) network-requested PDU session modification;
3) network-requested PDU session release; and
4) service-level authentication and authorization.
This procedure is initiated by the UE and to request for establishment of PDU
sessions or to perform handover of an existing PDU session between 3GPP access
and non-3GPP access, or to transfer an existing PDN connection in the EPS to
the 5GS:
UE-requested PDU session establishment.
b) Transaction related procedures:
These procedures are initiated by the UE to request for handling of PDU
sessions, i.e. to modify a PDU session, or to release a PDU session:
1) UE-requested PDU session modification; and
2) UE-requested PDU session release.
This procedure is initiated by the 5G ProSe UE-to-network relay UE and is used
for the manipulation of PDU sessions:
\- remote UE report.
A successful transaction related procedure initiated by the UE triggers the
network to execute one of the following procedures related to PDU session;
network-requested PDU session modification procedure or network-requested PDU
session release procedure. The UE treats the start of the procedure related to
the PDU session as completion of the transaction related procedure.
c) Common procedure:
The following 5GSM procedure can be related to a PDU session or to a procedure
transaction:
5GSM status procedure.
### 6.1.3 5GSM sublayer states
#### 6.1.3.1 General
In the following subclauses, the possible states of a PDU session in the UE
and the network side are described.
#### 6.1.3.2 5GSM sublayer states in the UE
##### 6.1.3.2.1 Overview
In the following subclauses, the possible 5GSM sublayer states of the UE are
described and shown in figure 6.1.3.2.1.1.
NOTE 1: Not all possible transitions are shown in this figure.
NOTE 2: Some transitions shown in this figure are not applicable to the MA PDU
session.
Figure 6.1.3.2.1.1: The 5GSM sublayer states for PDU session handling in the
UE (overview)
##### 6.1.3.2.2 PDU SESSION INACTIVE
No PDU session exists.
##### 6.1.3.2.3 PDU SESSION ACTIVE PENDING
The UE has initiated a PDU session establishment procedure towards the network
and is waiting for a response from the network.
##### 6.1.3.2.4 PDU SESSION ACTIVE
The PDU session is active in the UE.
##### 6.1.3.2.5 PDU SESSION INACTIVE PENDING
The UE has initiated a PDU session release procedure towards the network and
is waiting for a response from the network.
##### 6.1.3.2.6 PDU SESSION MODIFICATION PENDING
The UE has initiated a PDU session modification procedure towards the network
and is waiting for a response from the network.
##### 6.1.3.2.7 PROCEDURE TRANSACTION INACTIVE
No procedure transaction exists.
##### 6.1.3.2.8 PROCEDURE TRANSACTION PENDING
The UE has initiated a procedure transaction towards the network.
Figure 6.1.3.2.8.1: The procedure transaction states in the UE (overview)
#### 6.1.3.3 5GSM sublayer states in the network side
##### 6.1.3.3.1 Overview
In the following subclauses, the possible 5GSM sublayer states of the network
are described and shown in Figure 6.1.3.3.1.1.
NOTE 1: Not all possible transitions are shown in this figure.
NOTE 2: Some transitions shown in this figure are not applicable to the MA PDU
session.
Figure 6.1.3.3.1.1: The 5GSM sublayer states for PDU session handling in the
network (overview)
##### 6.1.3.3.2 PDU SESSION INACTIVE
No PDU session exists.
##### 6.1.3.3.3 PDU SESSION ACTIVE
The PDU session is active in the network.
##### 6.1.3.3.4 PDU SESSION INACTIVE PENDING
The network has initiated a PDU session release procedure towards the UE and
is waiting for a response from the UE.
##### 6.1.3.3.5 PDU SESSION MODIFICATION PENDING
The network has initiated a PDU session modification procedure towards the UE
and is waiting for a response from the UE.
##### 6.1.3.3.6 PROCEDURE TRANSACTION INACTIVE
No procedure transaction exists.
##### 6.1.3.3.7 PROCEDURE TRANSACTION PENDING
The network has initiated a procedure transaction towards the UE.
Figure 6.1.3.3.7.1: The procedure transaction states in the network (overview)
### 6.1.4 Coordination between 5GSM and ESM
#### 6.1.4.1 Coordination between 5GSM and ESM with N26 interface
Interworking with EPS is supported for a PDU session, if the PDU session
includes the mapped EPS bearer context(s) or has association(s) between QoS
flow and mapped EPS bearer after inter-system change from S1 mode to N1 mode.
The SMF shall not include any mapped EPS bearer contexts associated with a PDU
session for LADN and with a PDU session which is a multi-homed IPv6 PDU
session. See coding of the Mapped EPS bearer contexts IE in subclause
9.11.4.8. In an MA PDU session, the UE shall have one set of the mapped EPS
bearer contexts. The network can provide the set of the mapped EPS bearer
contexts of the MA PDU session via either access of the MA PDU session. In an
MA PDU session, the UE shall support modification or deletion via an access of
a mapped EPS bearer context of the MA PDU session created via the same or the
other access.
Upon inter-system change from N1 mode to S1 mode, the UE shall create the
default EPS bearer context and the dedicated EPS bearer context(s) based on
the parameters of the mapped EPS bearer contexts or the associations between
QoS flow and mapped EPS bearer in the PDU session, if available. The EPS
bearer identity assigned for the QoS flow of the default QoS rule becomes the
EPS bearer identity of the default bearer in the corresponding PDN connection.
If there is no EPS bearer identity assigned to the QoS flow of the default QoS
rule of a PDU session associated with 3GPP access, or if there is no
corresponding mapped EPS bearer contexts associated with the EPS bearer
identity assigned to the QoS flow of the default QoS rule of a PDU session
associated with 3GPP access:
a) the PDU session is not an MA PDU session established over both 3GPP access
and non-3GPP access, the UE shall perform a local release of the PDU session;
or
b) the PDU session is an MA PDU session established over both 3GPP access and
non-3GPP access, the UE shall perform a local release of the PDU session over
3GPP access and consider that the MA PDU session is established over non-3GPP
access only.
If there is no EPS bearer identity assigned to the QoS flow(s) of a PDU
session associated with 3GPP access which is not associated with the default
QoS rule, or if there is no corresponding mapped EPS bearer contexts
associated with the EPS bearer identity assigned to the QoS flow of the non-
default QoS rule of a PDU session associated with 3GPP access, unless the PDU
session is an MA PDU session established over 3GPP access and over non-3GPP
access, the UE shall locally delete the QoS rules and the QoS flow
description(s). The UE uses the parameters from each PDU session for which
interworking with EPS is supported to create corresponding default EPS bearer
context and optionally dedicated EPS bearer context(s) as follows:
a) the PDU session type of the PDU session shall be mapped to the PDN type of
the default EPS bearer context as follows:
1) the PDN type shall be set to \"non-IP\" if the PDU session type is
\"Unstructured\";
2) the PDN type shall be set to \"IPv4\" if the PDU session type is \"IPv4\";
3) the PDN type shall be set to \"IPv6\" if the PDU session type is \"IPv6\";
4) the PDN type shall be set to \"IPv4v6\" if the PDU session type is
\"IPv4v6\";
5) the PDN type shall be set to \"non-IP\" if the PDU session type is
\"Ethernet\", and the UE, the network or both of them do not support Ethernet
PDN type in S1 mode; and
6) the PDN type shall be set to \"Ethernet\" if the PDU session type is
\"Ethernet\" and the UE and the network support Ethernet PDN type in S1 mode;
b) the PDU address of the PDU session shall be mapped to the PDN address of
the default EPS bearer context as follows:
1) the PDN address of the default EPS bearer context is set to the PDU address
of the PDU session, if the PDU session type is \"IPv4\", \"IPv6\" or
\"IPv4v6\"; and
2) the PDN address of the default EPS bearer context is set to zero, if the
PDU session type is \"Ethernet\" or \"Unstructured\";
c) the DNN of the PDU session shall be mapped to the APN of the default EPS
bearer context, unless the PDU session is an emergency PDU session;
d) the APN-AMBR and extended APN-AMBR received in the parameters of the
default EPS bearer context of the mapped EPS bearer contexts shall be mapped
to the APN-AMBR and extended APN-AMBR of the default EPS bearer context;
e) for each PDU session in state PDU SESSION ACTIVE, PDU SESSION MODIFICATION
PENDING or PDU SESSION INACTIVE PENDING:
1) if the UE is performing an inter-system change from N1 mode to WB-S1 mode,
the UE shall set the state of the mapped EPS bearer context(s) to BEARER
CONTEXT ACTIVE; or
2) if the UE is performing an inter-system change from N1 mode to NB-S1 mode,
for the mapped EPS bearer context corresponding to the default EPS bearer, the
UE shall set the state of the mapped EPS bearer context to BEARER CONTEXT
ACTIVE. Additionally, if the UE is performing an inter-system change from
WB-N1 mode to NB-S1 mode, for the mapped EPS bearer context corresponding to a
dedicated EPS bearer, if any, the UE shall set the state of the mapped EPS
bearer context to BEARER CONTEXT INACTIVE; and
f) for any other PDU session the UE shall set the state of the mapped EPS
bearer context(s) to BEARER CONTEXT INACTIVE.
Additionally, for each mapped EPS bearer context or the association between
QoS flow and mapped EPS bearer in the PDU session:
a) the EPS bearer identity shall be set to the EPS bearer identity received in
the mapped EPS bearer context, or the EPS bearer identity associated with the
QoS flow;
b) the EPS QoS parameters shall be set to the mapped EPS QoS parameters of the
EPS bearer received in the mapped EPS bearer context, or the EPS QoS
parameters associated with the QoS flow;
c) the extended EPS QoS parameters shall be set to the mapped extended EPS QoS
parameters of the EPS bearer received in the mapped EPS bearer context, or the
extended EPS QoS parameters associated with the QoS flow; and
d) the traffic flow template shall be set to the mapped traffic flow template
of the EPS bearer received in the mapped EPS bearer context, or the stored
traffic flow template associated with the QoS flow, if available.
After inter-system change from N1 mode to S1 mode, the UE shall associate the
PDU session identity, the S-NSSAI, and the session-AMBR with the default EPS
bearer context, and for each EPS bearer context mapped from one or more QoS
flows, associate the QoS rule(s) for the QoS flow(s) and the QoS flow
description(s) for the QoS flow(s) with the EPS bearer context.
If the PDU session is associated with the control plane only indication and
supports interworking with EPS, after inter-system change from N1 mode to S1
mode, the UE shall associate the EPS bearer context(s) of the PDN connection
corresponding to the PDU session with the control plane only indication.
If the PDU session is associated with a PDU session pair ID, after inter-
system change from N1 mode to S1 mode, the UE shall associate the default EPS
bearer context of the PDN connection corresponding to the PDU session with the
PDU session pair ID. If the PDU session is associated with an RSN, after
inter-system change from N1 mode to S1 mode, the UE shall associate the
default EPS bearer context of the PDN connection corresponding to the PDU
session with the RSN.
After inter-system change from N1 mode to S1 mode, the UE and the SMF shall
maintain the PDU session type of the PDU session until the PDN connection
corresponding to the PDU session is released if the UE supports non-IP PDN
type and the PDU session type is \"Ethernet\" or \"Unstructured\".
After inter-system change from N1 mode to S1 mode, the UE and the SMF shall
maintain the following 5GSM attributions and capabilities associated with the
PDU session until the PDN connection corresponding to the PDU session is
released:
a) the always-on PDU session indication;
b) the maximum number of supported packet filters;
c) the support of reflective QoS;
d) the maximum data rate per UE for user-plane integrity protection supported
by the UE for uplink and the maximum data rate per UE for user-plane integrity
protection supported by the UE for downlink;
e) the support of multi-homed IPv6 PDU session; and
f) if the PDU session is an MA PDU session established over 3GPP access, the
PDN connection of the default EPS bearer corresponding to the MA PDU session
shall be considered as a user-plane resource of the MA PDU session.
After inter-system change from N1 mode to S1 mode, the UE operating in single-
registration mode in a network supporting N26 interface shall deem that the
following features are supported by the network on the PDN connection
corresponding to the PDU session:
a) PS data off; and
b) Local address in TFT.
If there is a QoS flow used for IMS signalling, after inter-system change from
N1 mode to S1 mode, the EPS bearer associated with the QoS flow for IMS
signalling becomes the EPS bearer for IMS signalling.
When the UE is provided with a new session-AMBR in the Protocol configuration
options IE or Extended protocol configuration options IE in the MODIFY EPS
BEARER CONTEXT REQUEST message, the UE shall discard the corresponding
association(s) and associate the new value(s) with the EPS bearer context.
The network may provide the UE with one or more QoS rules by including either
one QoS rules parameter, or one QoS rules with the length of two octets
parameter, but not both, in the Protocol configuration options IE or Extended
protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST
message. The network may provide the UE with one or more QoS flow descriptions
corresponding to the EPS bearer context being modified, by including either
one QoS flow descriptions parameter, or one QoS flow descriptions with the
length of two octets parameter, but not both, in the Protocol configuration
options IE or Extended protocol configuration options IE in the MODIFY EPS
BEARER CONTEXT REQUEST message.
When the UE is provided with one or more QoS flow descriptions or the EPS
bearer identity of an existing QoS flow description is modified in the
Protocol configuration options IE or Extended protocol configuration options
IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall check the
EPS bearer identity included in the QoS flow description; and:
a) if the EPS bearer identity corresponds to the EPS bearer context being
modified or the EPS bearer identity is not included, the UE shall store the
QoS flow description and all the associated QoS rules, if any, for the EPS
bearer context being modified for use during inter-system change from S1 mode
to N1 mode; and
b) otherwise the UE shall locally delete the QoS flow description and all the
associated QoS rules, if any, and include a Protocol configuration options IE
or Extended protocol configuration options IE with a 5GSM cause parameter set
to 5GSM cause #84 \"syntactical error in the QoS operation\" in the MODIFY EPS
BEARER CONTEXT ACCEPT message.
When the UE is provided with one or more QoS rules, or one or more QoS flow
descriptions in the Protocol configuration options IE or Extended protocol
configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the
UE shall process the QoS rules sequentially starting with the first QoS rule
and shall process the QoS flow descriptions sequentially starting with the
first QoS flow description. The UE shall check the QoS rules and QoS flow
descriptions for different types of errors as follows:
NOTE 1: If an error is detected in a QoS rule or a QoS flow description which
requires sending a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause value, then the QoS rules
parameter, the QoS rules with the length of two octets parameter, the QoS flow
descriptions parameter and the QoS flow descriptions with the length of two
octets parameter included in the Protocol configuration options IE or Extended
protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST
message are discarded, if any.
NOTE 2: If the EPS bearer context modification procedure is rejected, then the
QoS rules parameter, the QoS rules with the length of two octets parameter,
the QoS flow descriptions parameter and the QoS flow descriptions with the
length of two octets parameter included in the Protocol configuration options
IE or Extended protocol configuration options IE in the MODIFY EPS BEARER
CONTEXT REQUEST message are discarded, if any.
a) Semantic errors in QoS operations:
1) When the rule operation is \"Modify existing QoS rule and add packet
filters\", \"Modify existing QoS rule and replace all packet filters\",
\"Modify existing QoS rule and delete packet filters\" or \"Modify existing
QoS rule without modifying packet filters\" on the default QoS rule and the
DQR bit is set to \"the QoS rule is not the default QoS rule\".
2) When the rule operation is \"Modify existing QoS rule and add packet
filters\", \"Modify existing QoS rule and replace all packet filters\",
\"Modify existing QoS rule and delete packet filters\" or \"Modify existing
QoS rule without modifying packet filters\" on a QoS rule which is not the
default QoS rule and the DQR bit is set to \"the QoS rule is the default QoS
rule\".
3) When the rule operation is \"Create new QoS rule\" and the DQR bit is set
to \"the QoS rule is the default QoS rule\" when there\'s already a default
QoS rule with different QoS rule identifier.
4) When the rule operation is \"Delete existing QoS rule\" on the default QoS
rule.
5) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\", \"Modify existing QoS rule and replace all
packet filters\", \"Modify existing QoS rule and delete packet filters\", or
\"Modify existing QoS rule without modifying packet filters\" and two or more
QoS rules associated with this PDU session would have identical precedence
values.
6) When the rule operation is \"Modify existing QoS rule and delete packet
filters\", the QoS rule is a QoS rule of a PDU session of IPv4, IPv6, IPv4v6
or Ethernet PDU session type, and the packet filter list in the resultant QoS
rule is empty.
7) When the rule operation is \"Create new QoS rule\", and there is already an
existing QoS rule with the same QoS rule identifier and the existing QoS rule
is associated with a QoS flow description stored for the EPS bearer context
being modified or the existing QoS rule is not associated with any QoS flow
description.
8) When the rule operation is \"Modify existing QoS rule and add packet
filters\", \"Modify existing QoS rule and replace all packet filters\",
\"Modify existing QoS rule and delete packet filters\", or \"Modify existing
QoS rule without modifying packet filters\" and there is no existing QoS rule
with the same QoS rule identifier associated with a QoS flow description
stored for the EPS bearer context being modified.
9) When the rule operation is \"Delete existing QoS rule\" and there is no
existing QoS rule with the same QoS rule identifier associated with a QoS flow
description stored for the EPS bearer context being modified.
10) When the flow description operation is \"Create new QoS flow description\"
and there is already an existing QoS flow description with the same QoS flow
identifier stored for the EPS bearer context being modified.
11) When the flow description operation is \"Modify existing QoS flow
description\" and there is no existing QoS flow description with the same QoS
flow identifier stored for the EPS bearer context being modified.
12) When the flow description operation is \"Delete existing QoS flow
description\" and there is no existing QoS flow description with the same QoS
flow identifier stored for the EPS bearer context being modified.
13) When the UE determines that:
i) the default EPS bearer context is associated with one or more QoS flows but
the default EPS bearer context is not associated with the default QoS rule.
ii) a dedicated EPS bearer context is associated with one or more QoS flows
but the dedicated EPS bearer context is associated with the default QoS rule.
14) When the rule operation is \"Create new QoS rule\" and there is already an
existing QoS rule with the same QoS rule identifier associated with a QoS flow
description stored for an EPS bearer context different from the EPS bearer
context being modified and belonging to the same PDN connection as the EPS
bearer context being modified.
15) When the flow description operation is \"Create new QoS flow
description\", and there is already an existing QoS flow description with the
same QoS flow identifier stored for an EPS bearer context different from the
EPS bearer context being modified and belonging to the same PDN connection as
the EPS bearer context being modified.
16) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\", \"Modify existing QoS rule and replace all
packet filters\", \"Modify existing QoS rule and delete packet filters\", or
\"Modify existing QoS rule without modifying packet filters\" and the
resultant QoS rule is associated with a QoS flow description stored for an EPS
bearer context different from the EPS bearer context being modified.
17) When the rule operation is \"Create new QoS rule\", the DQR bit is set to
\"the QoS rule is not the default QoS rule\", the QoS rule is provided for a
PDN connection of PDN type \"non-IP\" and there is locally available
information associated with the PDN connection that is set to
\"Unstructured\".
18) When the flow description operation is \"Create new QoS flow description\"
or \"Modify existing QoS flow description\", the QFI associated with the QoS
flow description is not the same as the QFI of the default QoS rule, the QoS
flow description is provided for a PDN connection of PDN type \"non-IP\" and
there is locally available information associated with the PDN connection that
is set to \"Unstructured\".
In case 5, if the old QoS rule (i.e. the QoS rule that existed before the
MODIFY EPS BEARER CONTEXT REQUEST message was received) is not the default QoS
rule and the old QoS rule is associated with a QoS flow description stored for
the EPS bearer context being modified, the UE shall not diagnose an error,
shall further process the new request and, if it was processed successfully,
shall delete the old QoS rule which has identical precedence value. Otherwise,
the UE shall include a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause parameter set to 5GSM cause #83
\"semantic error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT
ACCEPT message.
In case 6, if the QoS rule is not the default QoS rule, the UE shall delete
the QoS rule. If the QoS rule is the default QoS rule, the UE shall include a
Protocol configuration options IE or Extended protocol configuration options
IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the
QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message.
In case 7, if the existing QoS rule is not the default QoS rule and the DQR
bit of the new QoS rule is set to \"the QoS rule is not the default QoS
rule\", the UE shall not diagnose an error, further process the create request
and, if it was processed successfully, delete the old QoS rule (i.e. the QoS
rule that existed before the MODIFY EPS BEARER CONTEXT REQUEST message was
received). If the existing QoS rule is the default QoS rule or the DQR bit of
the new QoS rule is set to \"the QoS rule is the default QoS rule\", the UE
shall include a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause parameter set to 5GSM cause #83
\"semantic error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT
ACCEPT message.
In case 9, the UE shall not diagnose an error, further process the delete
request and, if it was processed successfully, consider the respective QoS
rule as successfully deleted.
In case 10, the UE shall not diagnose an error, further process the create
request and, if it was processed successfully, delete the old QoS flow
description (i.e. the QoS flow description that existed before the MODIFY EPS
BEARER CONTEXT REQUEST message was received).
In case 12, the UE shall not diagnose an error, further process the delete
request and, if it was processed successfully, consider the respective QoS
flow description as successfully deleted.
Otherwise, the UE shall include a Protocol configuration options IE or
Extended protocol configuration options IE with a 5GSM cause parameter set to
5GSM cause #83 \"semantic error in the QoS operation\" in the MODIFY EPS
BEARER CONTEXT ACCEPT message.
b) Syntactical errors in QoS operations:
1) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\", \"Modify existing QoS rule and replace all
packet filters\" or \"Modify existing QoS rule and delete packet filters\",
the packet filter list in the QoS rule is empty, and the QoS rule is provided
for a PDN connection of PDN type IPv4, IPv6, IPv4v6 or Ethernet, or for a PDN
connection of PDN type \"non-IP\" and there is locally available information
associated with the PDN connection that is set to \"Ethernet\".
2) When the rule operation is \"Delete existing QoS rule\" or \"Modify
existing QoS rule without modifying packet filters\" with a non-empty packet
filter list in the QoS rule.
3) When the rule operation is \"Modify existing QoS rule and delete packet
filters\" and the packet filter to be deleted does not exist in the original
QoS rule.
4) Void.
5) When there are other types of syntactical errors in the coding of the QoS
rules parameter, the QoS rules with the length of two octets parameter, the
QoS flow descriptions parameter or the QoS flow descriptions with the length
of two octets parameter, such as a mismatch between the number of packet
filters subfield, and the number of packet filters in the packet filter list
when the rule operation is \"delete existing QoS rule\" or \"create new QoS
rule\", or the number of packet filters subfield is larger than the maximum
possible number of packet filters in the packet filter list (i.e., there is no
QoS rule precedence subfield included in the QoS rule IE), the QoS Rule
Identifier is set to \"no QoS rule identifier assigned\", or the QoS flow
identifier is set to \"no QoS flow identifier assigned\".
6) When, the
A) rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and
add packet filters\", \"Modify existing QoS rule and replace all packet
filters\", \"Modify existing QoS rule and delete packet filters\" or \"Modify
existing QoS rule without modifying packet filters\", the UE determines, by
using the QoS rule's QFI as the 5QI, that there is a resulting QoS rule for a
GBR QoS flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1), and there is
no QoS flow description with a QFI corresponding to the QFI of the resulting
QoS rule.
B) flow description operation is \"Delete existing QoS flow description\", and
the UE determines, by using the QoS rule's QFI as the 5QI, that there is a
resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8]
table 5.7.4-1) with a QFI corresponding to the QFI of the QoS flow description
that is deleted (i.e. there is no associated QoS flow description with the
same QFI).
7) When the flow description operation is \"Create new QoS flow description\"
or \"Modify existing QoS flow description\", and the UE determines that there
is a QoS flow description of a GBR QoS flow (as described in 3GPP TS 23.501
[8] table 5.7.4-1) which lacks at least one of the mandatory parameters (i.e.,
GFBR uplink, GFBR downlink, MFBR uplink and MFBR downlink). If the QoS flow
description does not include a 5QI, the UE determines this by using the QFI as
the 5QI.
In case 3 the UE shall not diagnose an error, further process the deletion
request and, if no error according to items c and d was detected, consider the
respective packet filter as successfully deleted.
Otherwise the UE shall include a Protocol configuration options IE or Extended
protocol configuration options IE with a 5GSM cause parameter set to 5GSM
cause #84 \"syntactical error in the QoS operation\" in the MODIFY EPS BEARER
CONTEXT ACCEPT message.
NOTE 3: It is not considered an error if the UE determines that after
processing all QoS operations on QoS rules and QoS flow descriptions there is
a QoS flow description that is not associated with any QoS rule and the UE is
not in NB-N1 mode.
c) Semantic errors in packet filters:
1) When a packet filter consists of conflicting packet filter components which
would render the packet filter ineffective, i.e. no IP packet will ever fit
this packet filter. How the UE determines a semantic error in a packet filter
is outside the scope of the present document.
The UE shall include a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause parameter set to 5GSM cause #44
\"semantic errors in packet filter(s)\" in the MODIFY EPS BEARER CONTEXT
ACCEPT message.
d) Syntactical errors in packet filters:
1) When the rule operation is \"Modify existing QoS rule and add packet
filters\" or \"Modify existing QoS rule and replace all packet filters\", and
two or more packet filters in the resultant QoS rule would have identical
packet filter identifiers.
2) When the rule operation is \"Create new QoS rule\", and two or more packet
filters in the resultant QoS rule would have identical packet filter
identifiers.
3) When there are other types of syntactical errors in the coding of packet
filters, such as the use of a reserved value for a packet filter component
identifier.
4) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\" or \"Modify existing QoS rule and replace all
packet filters\" with a non-empty packet filter list in the QoS rule, and the
DQR bit is set to \"the QoS rule is the default QoS rule\", the QoS rule is
provided for a PDN connection of PDN type \"non-IP\" and there is locally
available information associated with the PDN connection that is set to
\"Unstructured\".
In case 1, if two or more packet filters with identical packet filter
identifiers are contained in the MODIFY EPS BEARER CONTEXT REQUEST message,
the UE shall include a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause parameter set to 5GSM cause #45
\"syntactical error in packet filter(s)\" in the MODIFY EPS BEARER CONTEXT
ACCEPT message. Otherwise, the UE shall not diagnose an error, further process
the MODIFY EPS BEARER CONTEXT REQUEST message and, if it was processed
successfully, delete the old packet filters which have the identical packet
filter identifiers.
Otherwise the UE shall include a Protocol configuration options IE or Extended
protocol configuration options IE with a 5GSM cause parameter set to 5GSM
cause #45 \"syntactical error in packet filter(s)\" in the MODIFY EPS BEARER
CONTEXT ACCEPT message.
If the UE detects different errors in the QoS rules and QoS flow descriptions
as described in this subclause which requires sending a 5GSM cause parameter
in the MODIFY EPS BEARER CONTEXT ACCEPT message, the UE shall include a single
5GSM cause parameter in the MODIFY EPS BEARER CONTEXT ACCEPT message.
NOTE 4: The 5GSM cause to use cannot be different from #44 \"semantic error in
packet filter(s)\", #45 \"syntactical errors in packet filter(s)\", #83
\"semantic error in the QoS operation\" or #84 \"syntactical error in the QoS
operation\". The selection of a 5GSM cause is up to UE implementation.
Upon successful completion of an EPS attach procedure or tracking area
updating procedure after inter-system change from N1 mode to S1 mode (see 3GPP
TS 24.301 [15]), unless the PDU session is an MA PDU session established over
3GPP access and over non-3GPP access,
a) the UE shall delete any UE derived QoS rules of each PDU session which has
been transferred to EPS;
b) the UE and the SMF shall perform a local release of the PDU session(s)
associated with 3GPP access which have not been transferred to EPS; and
c) the UE and the SMF shall perform a local release of QoS flow(s) which have
not been transferred to EPS, of the PDU session(s) which have been transferred
to EPS. The UE and the SMF shall also perform a local release of any QoS flow
description not associated with any QoS rule and not associated with any
mapped EPS bearer context. If there is a QoS flow description not associated
with any QoS rule, but associated with a mapped EPS bearer context, and after
the inter-system change from N1 mode to S1 mode the respective EPS bearer
context is active, then the UE shall associate the QoS flow description with
the EPS bearer context.
For PDU session(s) associated with non-3GPP access in 5GS, if present, the UE
may:
a) keep some or all of these PDU sessions still associated with non-3GPP
access in 5GS, if supported;
b) release some or all of these PDU sessions explicitly by initiating the UE
requested PDU session release procedure(s); or
c) attempt to transfer some or all of these PDU sessions from N1 mode to S1
mode by initiating the UE requested PDN connectivity procedure(s) with the PDN
CONNECTIVITY REQUEST message created as follows:
1) if the PDU session is an emergency PDU session, the request type shall be
set to \"handover of emergency bearer services\". Otherwise the request type
shall be set to \"handover\";
2) the PDU session type of the PDU session shall be mapped to the PDN type of
the default EPS bearer context as follows:
i) the PDN type shall be set to \"non-IP\" if the PDU session type is
\"Unstructured\";
ii) the PDN type shall be set to \"IPv4\" if the PDU session type is \"IPv4\";
iii) the PDN type shall be set to \"IPv6\" if the PDU session type is
\"IPv6\";
iv) the PDN type shall be set to \"IPv4v6\" if the PDU session type is
\"IPv4v6\";
v) the PDN type shall be set to \"non-IP\" if the PDU session type is
\"Ethernet\" and the UE, the network or both of them do not support Ethernet
PDN type in S1 mode; and
vi) the PDN type shall be set to \"Ethernet\" if the PDU session type is
\"Ethernet\" and the UE and the network support Ethernet PDN type in S1 mode;
3) the DNN of the PDU session shall be mapped to the APN of the default EPS
bearer context, unless the PDN connection is an emergency PDN connection; and
4) the PDU session ID parameter in the Protocol configuration options IE or
the Extended protocol configuration options IE shall be set to the PDU session
identity of the PDU session.
If a PDU session associated with non-3GPP access is transferred to EPS, the UE
shall associate the PDU session identity with the default EPS bearer context
and shall delete any UE derived QoS rules of such PDU session.
Interworking to 5GS is supported for a PDN connection, if the corresponding
default EPS bearer context includes a PDU session identity, an S-NSSAI, if the
PDN connection is a non-emergency PDN connection, session AMBR and one or more
QoS flow descriptions received in the Protocol configuration options IE or
Extended protocol configuration options IE (see 3GPP TS 24.301 [15]), or the
default EPS bearer context has association with the PDU session identity, the
S-NSSAI, if the PDU session is a non-emergency PDU session, the session-AMBR
and one or more QoS flow descriptions after inter-system change from N1 mode
to S1 mode.
For a PDN connection established in S1 mode, to enable the UE to attempt to
transfer the PDN connection from S1 mode to N1 mode in case of inter-system
change, the UE shall allocate a PDU session identity, indicate the allocated
PDU session identity in the PDU session ID parameter in the Protocol
configuration options IE of the PDN CONNECTIVITY REQUEST message and associate
the allocated PDU session identity with the default EPS bearer context of the
PDN connection. If an N5CW device supports 3GPP access and establishes a new
PDN connection in S1 mode, the N5CW device shall refrain from allocating \"PDU
session identity value 15\".
For a PDN connection established in S1 mode, the SMF assigning the QoS rules
shall consider that the UE supports 16 packet filters for the corresponding
PDU session until the UE indicates a higher number (as specified in subclause
6.4.2.2).
The network may provide the UE with one or more QoS rules by including either
one QoS rules parameter, or one QoS rules with the length of two octets
parameter, but not both, in the Protocol configuration options IE or Extended
protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT
REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message. The network
may provide the UE with one or more QoS flow descriptions corresponding to the
EPS bearer context being activated, by including either one QoS flow
descriptions parameter, or one QoS flow descriptions with the length of two
octets parameter, but not both, in the Protocol configuration options IE or
Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER
CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message.
When the UE is provided with one or more QoS flow descriptions in the Protocol
configuration options IE or Extended protocol configuration options IE of the
ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER
CONTEXT REQUEST message, the UE shall check the EPS bearer identity included
in the QoS flow description; and:
a) if the EPS bearer identity corresponds to the EPS bearer context being
activated or the EPS bearer identity is not included, the UE shall store the
QoS flow description and all the associated QoS rules, if any, for the EPS
bearer context being activated for use during inter-system change from S1 mode
to N1 mode; and
b) otherwise the UE shall locally delete the QoS flow description and all the
associated QoS rules, if any, and include a Protocol configuration options IE
or Extended protocol configuration options IE with a 5GSM cause parameter set
to 5GSM cause #84 \"syntactical error in the QoS operation\" in the ACTIVATE
DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT
ACCEPT message.
When the UE is provided with one or more QoS rules, or one or more QoS flow
descriptions in the Protocol configuration options IE or Extended protocol
configuration options IE of the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or
ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the UE shall process
the QoS rules sequentially starting with the first QoS rule and shall process
the QoS flow descriptions sequentially starting with the first QoS flow
description. The UE shall check QoS rules and QoS flow descriptions for
different types of errors as follows:
NOTE 5: If an error is detected in a QoS rule or a QoS flow description which
requires sending a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause value, then the QoS rules
parameter, the QoS rules with the length of two octets parameter, the QoS flow
descriptions parameter and the QoS flow descriptions with the length of two
octets parameter included in the Protocol configuration options IE or Extended
protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT
REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message are
discarded, if any.
NOTE 6: If the default EPS bearer context activation procedure or the
dedicated EPS bearer context activation procedure is rejected, then the QoS
rules parameter, the QoS rules with the length of two octets parameter, the
QoS flow descriptions parameter and the QoS flow descriptions with the length
of two octets parameter included in the Protocol configuration options IE or
Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER
CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message are
discarded, if any.
a) Semantic errors in QoS operations:
1) When the rule operation is \"Create new QoS rule\" and the DQR bit is set
to \"the QoS rule is the default QoS rule\" when there\'s already a default
QoS rule.
2) When the rule operation is received in an ACTIVATE DEFAULT EPS BEARER
CONTEXT REQUEST message, the rule operation is \"Create new QoS rule\", and
there is no rule with the DQR bit set to \"the QoS rule is the default QoS
rule\".
3) When the rule operation is \"Create new QoS rule\" and two or more QoS
rules associated with this PDU session would have identical precedence values.
4) When the rule operation is an operation other than \"Create new QoS rule\".
5) When the flow description operation is an operation other than \"Create new
QoS flow description\".
6) When the UE determines that:
i) the default EPS bearer context is associated with one or more QoS flows but
the default EPS bearer context is not associated with the default QoS rules.
ii) a dedicated EPS bearer context is associated with one or more QoS flows
but the dedicated EPS bearer context is associated with the default QoS rule.
7) When the flow description operation is received in an ACTIVATE DEDICATED
EPS BEARER CONTEXT REQUEST message, the flow description operation is \"Create
new QoS flow description\" and there is already an existing QoS flow
description with the same QoS flow identifier stored for an EPS bearer context
different from the EPS bearer context being activated and belonging to the
same PDN connection as the EPS bearer context being activated.
8) When the rule operation is received in an ACTIVATE DEDICATED EPS BEARER
CONTEXT REQUEST message, the rule operation is \"Create new QoS rule\" and
there is already an existing QoS rule with the same QoS rule identifier stored
for an EPS bearer context different from the EPS bearer context being
activated and belonging to the same PDN connection as the EPS bearer context
being activated.
9) When the rule operation is received in an ACTIVATE DEDICATED EPS BEARER
CONTEXT REQUEST message, the rule operation is \"Create new QoS rule\" and the
resultant QoS rule is associated with a QoS flow description stored for an EPS
bearer context different from the EPS bearer context being activated and
belonging to the same PDN connection as the EPS bearer context being
activated.
In case 4, if the rule operation is for a non-default QoS rule, the UE shall
delete the QoS rule. If the QoS rule is the default QoS rule, the UE shall
include a Protocol configuration options IE or Extended protocol configuration
options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error
in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or
ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
Otherwise for all the cases above, the UE shall include a Protocol
configuration options IE or Extended protocol configuration options IE with a
5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS
operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE
DEDICATED EPS BEARER CONTEXT ACCEPT message.
b) Syntactical errors in QoS operations:
1) When the rule operation is \"Create new QoS rule\", the packet filter list
in the QoS rule is empty, and the QoS rule is provided for a PDN connection of
PDN type IPv4, IPv6, IPv4v6 or Ethernet, or for a PDN connection of PDN type
\"non-IP\" and there is locally available information associated with the PDN
connection that is set to \"Ethernet\".
2) Void.
3) When there are other types of syntactical errors in the coding of the QoS
rules parameter, the QoS rules with the length of two octets parameter, the
QoS flow descriptions parameter or the QoS flow descriptions with the length
of two octets parameter, such as a mismatch between the number of packet
filters subfield, and the number of packet filters in the packet filter list
when the rule operation is \"delete existing QoS rule\" or \"create new QoS
rule\", or the number of packet filters subfield is larger than the maximum
possible number of packet filters in the packet filter list (i.e., there is no
QoS rule precedence subfield included in the QoS rule IE), the QoS Rule
Identifier is set to \"no QoS rule identifier assigned\", or the QoS flow
identifier is set to \"no QoS flow identifier assigned.
4) When, the
A) rule operation is \"Create new QoS rule\", the UE determines, by using the
QoS rule's QFI as the 5QI, that there is a resulting QoS rule for a GBR QoS
flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1), and there is no QoS
flow description with a QFI corresponding to the QFI of the resulting QoS
rule.
5) When the flow description operation is \"Create new QoS flow description\",
and the UE determines that there is a QoS flow description of a GBR QoS flow
(as described in 3GPP TS 23.501 [8] table 5.7.4-1) which lacks at least one of
the mandatory parameters (i.e., GFBR uplink, GFBR downlink, MFBR uplink and
MFBR downlink). If the QoS flow description does not include a 5QI, the UE
determines this by using the QFI as the 5QI.
In case 1, case 3 or case 4, if the QoS rule is not the default QoS rule, the
UE shall delete the QoS rule. If the QoS rule is the default QoS rule, the UE
shall include a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause parameter set to 5GSM cause #84
\"syntactical error in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER
CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
In case 5, the UE shall include a Protocol configuration options IE or
Extended protocol configuration options IE with a 5GSM cause parameter set to
5GSM cause #84 \"syntactical error in the QoS operation\" in the ACTIVATE
DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT
ACCEPT message.
NOTE 7: It is not considered an error if the UE determines that after
processing all QoS operations on QoS rules and QoS flow descriptions there is
a QoS flow description that is not associated with any QoS rule and the UE is
not in NB-N1 mode.
c) Semantic errors in packet filters:
1) When a packet filter consists of conflicting packet filter components which
would render the packet filter ineffective, i.e. no IP packet will ever fit
this packet filter. How the UE determines a semantic error in a packet filter
is outside the scope of the present document.
The UE shall include a Protocol configuration options IE or Extended protocol
configuration options IE with a 5GSM cause parameter set to 5GSM cause #44
\"semantic errors in packet filter(s)\" in the ACTIVATE DEFAULT EPS BEARER
CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.
d) Syntactical errors in packet filters:
1) When the rule operation is \"Create new QoS rule\" and two or more packet
filters in the resultant QoS rule would have identical packet filter
identifiers.
2) When there are other types of syntactical errors in the coding of packet
filters, such as the use of a reserved value for a packet filter component
identifier.
The UE shall delete the QoS rule and include a Protocol configuration options
IE or Extended protocol configuration options IE with a 5GSM cause parameter
set to 5GSM cause #45 \"syntactical error in packet filter(s)\" in the
ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER
CONTEXT ACCEPT message.
If the UE detects different errors in the QoS rules and QoS flow descriptions
as described in this subclause which requires sending a 5GSM cause parameter
in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS
BEARER CONTEXT ACCEPT message, the UE shall include a single 5GSM cause
parameter in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE
DEDICATED EPS BEARER CONTEXT ACCEPT message.
NOTE 8: The 5GSM cause to use cannot be different from #44 \"semantic error in
packet filter(s)\", #45 \"syntactical errors in packet filter(s)\", #83
\"semantic error in the QoS operation\" or #84 \"syntactical error in the QoS
operation\". The selection of a 5GSM cause is up to UE implementation.
Upon inter-system change from S1 mode to N1 mode, the UE uses the parameters
from the default EPS bearer context of each PDN connection for which
interworking to 5GS is supported to create a corresponding PDU session
associated with 3GPP access as follows, unless the PDN connection is a user-
plane resource of an MA PDU session:
a) the PDN type of the default EPS bearer context shall be mapped to the PDU
session type of the PDU session as follows:
1) if the PDN type is \"non-IP\":
\- the PDU session type is set to the locally available information associated
with the PDN connection (either \"Ethernet\" or \"Unstructured\"), if
available; or
\- otherwise, the PDU session type is set to \"Unstructured\";
2) if the PDN type is \"IPv4\" the PDU session type is set to \"IPv4\";
3) if the PDN type is \"IPv6\", the PDU session type is set to \"IPv6\";
4) if the PDN type is \"IPv4v6\", the PDU session type is set to \"IPv4v6\";
and
5) if the PDN type is \"Ethernet\", the PDU session type is \"Ethernet\";
b) the PDN address of the default EPS bearer context shall be mapped to PDU
address of the PDU session, if the PDN type is \"IPv4\", \"IPv6\" or
\"IPv4v6\";
c) the APN of the default EPS bearer context shall be mapped to the DNN of the
PDU session, unless the PDN connection is an emergency PDN connection;
d) for each default EPS bearer context in state BEARER CONTEXT ACTIVE the UE
shall set the state of the mapped PDU session to PDU SESSION ACTIVE; and
e) for any other default EPS bearer context the UE shall set the state of the
mapped PDU session to PDU SESSION INACTIVE.
Additionally, the UE shall set:
a) the PDU session identity of the PDU session to the PDU session identity
included by the UE in the Protocol configuration options IE or Extended
protocol configuration options IE in the PDN CONNECTIVITY REQUEST message, or
the PDU session identity associated with the default EPS bearer context;
b) the S-NSSAI of the PDU session to the S-NSSAI included by the network in
the Protocol configuration options IE or Extended protocol configuration
options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, or the S-NSSAI
associated with the default EPS bearer context, if the PDN connection is a
non-emergency PDN connection;
c) the session-AMBR of the PDU session to the session-AMBR included by the
network in the Protocol configuration options IE or Extended protocol
configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message or
the MODIFY EPS BEARER CONTEXT REQUEST message, or the session-AMBR associated
with the default EPS bearer context;
d) the SSC mode of the PDU session to \"SSC mode 1\"; and
e) the always-on PDU session indication to the always-on PDU session
indication maintained in the UE, if any.
Upon inter-system change from S1 mode to N1 mode, for each PDN connection
which is a user-plane resource of MA PDU session and for which interworking to
5GS is supported, the UE shall consider that the MA PDU session is established
over 3GPP access and, unless the MA PDU session is established over non-3GPP
access too, the UE shall set the session-AMBR of the PDU session to the
session-AMBR included by the network in the Protocol configuration options IE
or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS
BEARER REQUEST message or the MODIFY EPS BEARER CONTEXT REQUEST message, or
the session-AMBR associated with the default EPS bearer context of the PDN
connection.
Additionally, for each EPS bearer context of the PDN connection, the UE shall
create QoS flow(s) each of which is associated with the QoS flow description
received in the Protocol configuration options IE or Extended protocol
configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message,
ACTIVATE DEDICATED EPS BEARER REQUEST message, and/or MODIFY EPS BEARER
REQUEST message (see 3GPP TS 24.301 [15]), or the QoS flow description
associated with EPS bearer context, unless:
a) the PDU session is an MA PDU session which:
1) is established over non-3GPP access; and
2) has a PDN connection as a user-plane resource; and
b) the QoS flow already exists over the non-3GPP access.
Additionally, for each EPS bearer context of the PDN connection, the UE shall
create QoS rules(s), if any, each of which is associated with the QoS rule
received in the Protocol configuration options IE or Extended protocol
configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message,
ACTIVATE DEDICATED EPS BEARER REQUEST message, or MODIFY EPS BEARER CONTEXT
REQUEST message (see 3GPP TS 24.301 [15]), or the QoS rules associated with
EPS bearer context, unless:
a) the PDU session is an MA PDU session which:
1) is established over non-3GPP access; and
2) has a PDN connection as a user-plane resource; and
b) the QoS rule already exists over the non-3GPP access.
NOTE 9: For a QoS rule which does not exist over non-3GPP access, the UE does
not create the QoS rule if the QoS rule is the default QoS rule, or the
precedence value of the QoS rule equals to the precedence value of a QoS rule
exists over the non-3GPP access.
Additionally, for each PDU session which was created at inter-system change
from S1 mode to N1 mode from a corresponding PDN connection of the
\"Ethernet\" PDN type, the UE shall consider that Ethernet PDN type in S1 mode
is supported by the network and the SMF shall consider that Ethernet PDN type
in S1 mode is supported by the UE.
The UE and the network shall locally release the PDN connection(s) and EPS
bearer context(s) associated with the 3GPP access which have not been
transferred to 5GS.
After inter-system change from S1 mode to N1 mode, for each QoS flow mapped
from an EPS bearer context the UE shall associate the EPS bearer identity, the
EPS QoS parameters, the extended EPS QoS parameters, and the traffic flow
template, if available, of the EPS bearer context with the QoS flow.
After inter-system change from S1 mode to N1 mode, for each QoS flow of an MA
PDU session which:
a) is established over non-3GPP access; and
b) has a PDN connection as a user-plane resource;
such that the QoS flow was received in the Protocol configuration options IE
or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS
BEARER REQUEST message, ACTIVATE DEDICATED EPS BEARER REQUEST message, MODIFY
EPS BEARER CONTEXT REQUEST message, (see 3GPP TS 24.301 [15]), or associated
with EPS bearer context, the UE shall associate the EPS bearer identity, the
EPS QoS parameters, the extended EPS QoS parameters, and the traffic flow
template, if available, of the EPS bearer context with the QoS flow.
If the EPS bearer context(s) of the PDN connection are associated with the
control plane only indication, and the PDN connection supports interworking to
5GS, after inter-system change from S1 mode to N1 mode, the UE shall associate
the PDU session corresponding to the PDN connection with the control plane
only indication.
If the default EPS bearer context of the PDN connection is associated with the
PDU session pair ID, and the PDN connection supports interworking to 5GS,
after inter-system change from S1 mode to N1 mode, the UE shall associate the
PDU session corresponding to the PDN connection with the PDU session pair ID.
If the default EPS bearer context of the PDN connection is associated with the
RSN, and the PDN connection supports interworking to 5GS, after inter-system
change from S1 mode to N1 mode, the UE shall associate the PDU session
corresponding to the PDN connection with the RSN.
If there is an EPS bearer used for IMS signalling, after inter-system change
from S1 mode to N1 mode, the QoS flow of the default QoS rule in the
corresponding PDU session is used for IMS signalling.
For a PDN connection established when in S1 mode, upon the first inter-system
change from S1 mode to N1 mode, the SMF shall determine the PDU session
indication as specified in subclause 6.3.2.2.
When the UE is provided with one or more mapped EPS bearer contexts in the
Mapped EPS bearer contexts IE of the PDU SESSION MODIFICATION COMMAND message,
the UE shall process the mapped EPS bearer contexts sequentially starting with
the first mapped EPS bearer context.
When the UE is provided with a new EPS bearer identity, a new EPS QoS
parameters, a new extended EPS QoS parameters, a new APN-AMBR or a new
extended APN-AMBR in the Mapped EPS bearer context IE of the PDU SESSION
MODIFICATION COMMAND message for a QoS flow, the UE shall discard the
corresponding association(s) and associate the new value(s) with the QoS flow.
When the UE is provided with a new traffic flow template in the Mapped EPS
bearer contexts IE of the PDU SESSION MODIFICATION COMMAND message for a QoS
flow, the UE shall check the traffic flow template for different types of TFT
IE errors as specified in subclause 6.3.2.3.
When a QoS flow is deleted, the associated EPS bearer context information that
are mapped from the deleted QoS flow shall be deleted from the UE and the
network if there is no other existing QoS flow associated with this EPS bearer
context. When the EPS bearer identity of a QoS flow is deleted, the associated
EPS bearer context information that are mapped from the deleted EPS bearer
identity shall be deleted from the UE and the network if there is no other
existing QoS flow associated with this EPS bearer context. When an EPS bearer
is released, all the associated QoS flow descriptions and QoS rules that are
mapped from the released EPS bearer shall be deleted from the UE and the
network.
NOTE 10: If T3584 is running or deactivated for the S-NSSAI and optionally the
DNN combination, the UE is allowed to initate ESM procedures in EPS with or
without APN corresponding to that DNN, and if the APN is congested in EPS, the
MME can send a back-off timer for the APN to the UE as specified in 3GPP TS
24.301 [15].
Upon inter-system change from N1 mode to S1 mode, if the UE has any PDU
sessions associated with one or more multicast MBS multicast sessions, the UE
shall locally leave the associated multicast MBS sessions and the network
shall consider the UE as removed from the associated multicast MBS sessions.
For the case of handover of an existing PDU session from 3GPP access to
non-3GPP access,
\- upon receipt of the PDU SESSION ESTABLISHMENT ACCEPT message, the UE
locally deletes the EPS bearer identities for the PDU session, if any (see
subclause 6.4.1.3); and
\- after successful handover, the network shall locally delete the EPS bearer
identities for the PDU session, if any.
#### 6.1.4.2 Coordination between 5GSM and ESM without N26 interface
When the network does not support N26 interface, the SMF does not provide the
UE with the mapped EPS bearer context for a PDU session.
NOTE 1: Since the SMF does not provide the UE with the mapped EPS bearer
context for a PDU session, the UE does not know whether interworking with EPS
is supported for a PDU session before attempting to transfer the PDU session
from N1 mode to S1 mode.
NOTE 2: It is up to UE implementation to decide which PDU session(s) to be
attempted to transfer from N1 mode to S1 mode, e.g. based on UE policy or UE
local configuration.
Upon inter-system change from N1 mode to S1 mode in EMM-IDLE mode, the UE
shall not transfer a PDU session for LADN to EPS.
Upon inter-system change from N1 mode to S1 mode in EMM-IDLE mode, the UE
shall not transfer a multi-homed IPv6 PDU session to EPS.
Upon inter-system change from N1 mode to S1 mode in EMM-IDLE mode, the UE
shall use the parameters from each PDU session which the UE intends to
transfer to EPS to create the contents of a PDN CONNECTIVITY REQUEST message
as follows:
a) if the PDU session is an emergency PDU session, the request type shall be
set to \"handover of emergency bearer services\". Otherwise the request type
shall be set to \"handover\";
b) the PDU session type of the PDU session shall be mapped to the PDN type of
the default EPS bearer context as follows:
1) the PDN type shall be set to \"non-IP\" if the PDU session type is
\"Unstructured\";
2) the PDN type shall be set to \"IPv4\" if the PDU session type is \"IPv4\";
3) the PDN type shall be set to \"IPv6\" if the PDU session type is \"IPv6\";
4) the PDN type shall be set to \"IPv4v6\" if the PDU session type is
\"IPv4v6\";
5) the PDN type shall be set to \"non-IP\" if the PDU session type is
\"Ethernet\" and the UE, the network or both of them do not support Ethernet
PDN type in S1 mode; and
6) the PDN type shall be set to \"Ethernet\" if the PDU session type is
\"Ethernet\" and the UE and the network support Ethernet PDN type in S1 mode;
c) the DNN of the PDU session shall be mapped to the APN of the default EPS
bearer context, unless the PDU session is an emergency PDU session;
d) the PDU session ID parameter in the Protocol configuration options IE or
Extended protocol configuration options IE shall be set to the PDU session
identity of the PDU session; and
e) if the PDU session is an MA PDU session established over 3GPP access, the
ATSSS request parameter shall be included in the Protocol configuration
options IE or Extended protocol configuration options IE.
After inter-system change from N1 mode to S1 mode, the UE shall associate the
PDU session identity with the default EPS bearer context. If the PDU session
being transferred is a non-emergency PDU session, the UE shall in addition
associate the S-NSSAI and the PLMN ID of the current PLMN with the default EPS
bearer context.
Upon successful completion of an EPS attach procedure after inter-system
change from N1 mode to S1 mode (see 3GPP TS 24.301 [15]), the UE shall delete
any UE derived QoS rules except when the PDU session is an MA PDU session
established over 3GPP access and non-3GPP access.
The UE shall perform a local release of the PDU session(s) and QoS flow(s)
associated with the 3GPP access which have not been transferred to EPS. The UE
shall also perform a local release of any QoS flow description not associated
with any QoS rule.
For PDU session(s) associated with non-3GPP access in 5GS, if present, the UE
may:
a) keep some or all of these PDU sessions still associated with non-3GPP
access in 5GS, if supported;
b) release some or all of these PDU sessions explicitly by initiating the UE
requested PDU session release procedure(s); or
c) attempt to transfer some or all of these PDU sessions from N1 mode to S1
mode by initiating the UE requested PDN connectivity procedure(s) with the PDN
CONNECTIVITY REQUEST message created as above.
When the network does not support N26 interface, the MME does not provide the
UE with the mapped PDU session for a PDN connection but provides the UE with
an S-NSSAI if the PDN connection is not for emergency bearer services. When
establishing a new PDN connection in S1 mode, to enable the UE to attempt to
transfer the PDN connection from S1 mode to N1 mode in case of inter-system
change, the UE shall allocate a PDU session identity, indicate the allocated
PDU session identity in the PDU session ID parameter in the Protocol
configuration options IE of the PDN CONNECTIVITY REQUEST message and associate
the allocated PDU session identity with the default EPS bearer context of the
PDN connection. If an N5CW device supports 3GPP access and establishes a new
PDN connection in S1 mode, the N5CW device shall refrain from allocating \"PDU
session identity value 15\". The network provides the UE with an S-NSSAI and
the related PLMN ID in the Protocol configuration options IE or Extended
protocol configuration options IE of the ACTIVATE DEFAULT EPS BEARER REQUEST
message, the UE shall delete the stored S-NSSAI and the related PLMN ID, if
any, and shall store the S-NSSAI and the related PLMN ID provided in the
ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST message.
NOTE 3: Since the MME does not provide the UE with the mapped PDU session for
a PDN connection, the UE does not know whether interworking to 5GS is
supported for a PDN connection for which the UE assigned a PDU Session
identity before attempting to transfer the PDN connection from S1 mode to N1
mode.
NOTE 4: It is up to UE implementation to decide which PDN connection(s) to be
attempted to transfer from S1 mode to N1 mode, e.g. based on UE policy or UE
local configuration.
NOTE 5: If the PDN connection has been transferred from a PDN connection
established via non-3GPP access to EPC, it is possible that the network
provided the S-NSSAI already during the establishment via non-3GPP access (see
3GPP TS 24.302 [16]).
Upon inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, the UE
uses the parameters from the default EPS bearer context of each PDN connection
which the UE intends to transfer to 5GS and for which the UE has allocated a
PDU session identity to create a PDU SESSION ESTABLISHMENT REQUEST message as
follows:
a) if the PDN connection is for emergency bearer services, the request type
shall be set to \"existing emergency PDU session\". Otherwise the request type
shall be set to:
1) \"MA PDU request\", if the PDN connection to be transferred is a user-plane
resource of an MA PDU session; or
2) \"existing PDU session\";
b) the PDN type of the default EPS bearer context shall be mapped to the PDU
session type of the PDU session as follows:
1) if the PDN type is \"non-IP\":
\- the PDU session type is set to the locally available information associated
with the PDN connection (either \"Ethernet\" or \"Unstructured\"), if
available; or
\- otherwise, the PDU session type is set to \"Unstructured\";
2) if the PDN type is \"IPv4\" the PDU session type is set to \"IPv4\";
3) if the PDN type is \"IPv6\", the PDU session type is set to \"IPv6\";
4) if the PDN type is \"IPv4v6\", the PDU session type is set to \"IPv4v6\";
and
5) if the PDN type is \"Ethernet\", the PDU session type is set to
\"Ethernet\"; and
c) the APN of the default EPS bearer context shall be mapped to the DNN of the
PDU session, unless the PDN connection is an emergency PDN connection;
d) the PDU session ID shall be set to the PDU session identity included by the
UE in the Protocol configuration options IE or Extended protocol configuration
options IE in the PDN CONNECTIVITY REQUEST message, or to the PDU session ID
associated with the default EPS bearer context; and
e) if the PDU session is not an emergency PDU session, the S-NSSAI of the PDU
session shall be set to the S-NSSAI included by the network in the Protocol
configuration options IE or Extended protocol configuration options IE in the
ACTIVATE DEFAULT EPS BEARER REQUEST message, if provided by the network, or
the S-NSSAI associated with the default EPS bearer context, if available.
NOTE 6: If T3584 is running or deactivated for the S-NSSAI and optionally the
DNN combination, the UE is allowed to initiate ESM procedures in EPS with or
without APN corresponding to that DNN, and if the APN is congested in EPS, the
MME can send a back-off timer for the APN to the UE as specified in 3GPP TS
24.301 [15].
The UE shall locally release the PDN connection(s) and EPS bearer(s)
associated with the 3GPP access which have not been transferred to 5GS.
Upon inter-system change from N1 mode to S1 mode, if the UE has any PDU
sessions associated with one or more multicast MBS sessions, the UE shall
locally leave the associated multicast MBS sessions and the network shall
consider the UE as removed from the associated multicast MBS sessions.
### 6.1.4a Coordination between 5GSM and SM
Coordination between 5GSM and SM states is not required.
After the 5G-SRVCC handover from NG-RAN to UTRAN (see 3GPP TS 23.216 [6A]),
all the PDU sessions of the UE are locally released at the UE and the network.
If the UE has any PDU sessions associated with one or more multicast MBS
sessions, the UE shall locally leave the associated multicast MBS sessions and
the network shall consider the UE as removed from the associated multicast MBS
sessions.
### 6.1.5 Coordination for interworking with ePDG connected to EPC
When the UE establishes a new PDN connection via an ePDG connected to EPC, to
enable the transfer of the PDN connection to N1 mode in case of inter-system
change, the UE allocates a PDU session identity and indicates its value in the
PDU session ID field in the N1_MODE_CAPABILITY Notify payload of the IKE_AUTH
request message (see 3GPP TS 24.302 [16]). The network provides the UE with an
S-NSSAI in the N1_MODE_INFORMATION Notify payload of the IKE_AUTH response
message (see 3GPP TS 24.302 [16]).
Upon inter-system change to N1 mode, for PDN connection(s) established via an
ePDG connected to EPC, if present, the UE may:
a) keep some or all of these PDN connections still via ePDG connected to EPC,
if supported;
b) release some or all of these PDN connections explicitly by initiating the
UE initiated tunnel disconnection procedure(s) as specified in 3GPP TS 24.302
[16]; or
c) attempt to transfer some or all of these PDN connections to N1 mode using
the parameters of the PDN connection for which the UE has allocated a PDU
session identity by initiating the PDU session establishment procedure(s) with
the PDU SESSION ESTABLISHMENT REQUEST message created. In that case, for each
and every PDN connection to be transferred:
1) if the PDN connection is for emergency bearer services, the request type
shall be set to \"existing emergency PDU session\". Otherwise the request type
shall be set to \"existing PDU session\";
2) if the previously allocated home address information for a PDN connection
consists of an IPv4 address only for an ePDG connected to EPC according to
3GPP TS 24.302 [16], the PDU session type shall be set to \"IPv4\";
3) if the previously allocated home address information for a PDN connection
consists of an IPv6 prefix only for an ePDG connected to EPC according to 3GPP
TS 24.302 [16], the PDU session type shall be set to \"IPv6\";
4) if the previously allocated home address information for a PDN connection
consists of both an IPv4 address and an IPv6 prefix for an ePDG connected to
EPC according to 3GPP TS 24.302 [16], the PDU session type shall be set to
\"IPv4v6\";
5) the APN of the PDN connection shall be mapped to the DNN of the PDU
session;
6) the PDU session ID shall be set to the PDU session identity in the
N1_MODE_CAPABILITY Notify payload of the IKE_AUTH request message establishing
IPsec tunnel of the PDN connection; and
7) if the PDN connection is not for emergency bearer services, the S-NSSAI of
the PDU session shall be set to the S-NSSAI associated with the PDN connection
as specified in 3GPP TS 24.302 [16]. The UE shall not request to perform
handover of an existing PDN connection to N1 mode if the associated S-NSSAI is
not included in the allowed NSSAI for the target access.
If an existing PDU session is transferred from 3GPP access to an ePDG
connected to EPC connection and that existing PDU session is associated with
one or more multicast MBS sessions, the UE shall locally leave the associated
multicast MBS sessions and the SMF shall consider the UE as removed from the
associated multicast MBS sessions.
## 6.2 General on elementary 5GSM procedures
### 6.2.1 Principles of PTI handling for 5GSM procedures
When the UE or the network initiates a transaction related procedure (i.e. a
procedure consisting of more than one message and the messages are related),
it shall include a valid PTI value in the message header of the request
message or of the command message.
If a response message is sent as result of a received request message or a
received command message, the sending entity shall include in the response
message the PTI value received within the request message or within the
command message (see examples in figure 6.2.1.1, figure 6.2.1.2, and figure
6.2.1.3).
If a command message is sent as result of a received request message, the
sending entity shall include in the command message the PTI value received
with the request message (see examples in figure 6.2.1.3).
If a command message is not sent as result of a received request message, the
sending entity shall include in the command message the PTI value set to \"no
procedure transaction identity assigned\" (see examples in figure 6.2.1.4).
Figure 6.2.1.1: UE-requested transaction related procedure accepted by the
network
Figure 6.2.1.2: UE-requested transaction related procedure rejected by the
network
Figure 6.2.1.3: UE-requested transaction related procedure triggering a
network-requested transaction related procedure
Figure 6.2.1.4: network-requested transaction related procedure not triggered
by a UE-requested transaction related procedure
### 6.2.2 PDU session types
The following PDU Session types are supported:
a) IPv4;
b) IPv6;
c) IPv4v6;
d) Ethernet (EtherType as defined in IEEE Std 802.3 [31A]); and
e) Unstructured.
IP address allocation for IPv4, IPv6 and IPv4v6 PDU session types is described
in subclause 6.2.4.
Neither a MAC nor an IP address is allocated by the 5GCN to the UE for
Ethernet PDU session type.
### 6.2.3 PDU session management
The SMF is responsible for the session management functions to provide the PDU
connectivity service to the UE via the 5GSM signalling between UE and SMF. The
session management procedures includes:
a) the UE-requested PDU session establishment procedure;
b) the PDU session authentication and authorization procedure;
c) the UE-requested PDU session modification procedure;
d) the network-requested PDU session modification procedure;
e) the UE-requested PDU session release procedure; and
f) the network-requested PDU session release procedure.
A UE may establish multiple PDU sessions, to the same data network or to
different data networks, via 3GPP and via and Non-3GPP access networks at the
same time.
The session management messages between UE and SMF are transferred via AMF as
specified in subclause 8.3.
### 6.2.4 IP address allocation
#### 6.2.4.1 General
This clause specifies IP address allocation for the PDU session.
In this release of specification, PDU session can be initiated with one IP
version, i.e. IPv4 PDU session type or IPv6 PDU session type, or with both IP
versions, i.e. IPv4v6 PDU session type.
IP address allocation to the UE shall be performed by SMF based on one or both
the selected IP versions and operator policies. If IPv4 PDU session type is
selected, an IPv4 address is allocated to the UE. If IPv6 PDU session type is
selected, an IPv6 prefix except when the SMF acts according to subclause
6.2.4.3, and an interface identifier for the IPv6 link local address are
allocated to the UE. If IPv4v6 PDU session type is selected, an IPv4 address,
an IPv6 prefix except when the SMF acts according to subclause 6.2.4.3 or
6.2.4.4, and an interface identifier for the IPv6 link local address are
allocated to the UE. If IPv6 or IPv4v6 PDU session type is selected in a PDU
session established by the W-AGF acting on behalf of the FN-RG and the PDU
SESSION ESTABLISHMENT REQUEST message contains the Suggested interface
identifier IE, the SMF shall allocate to the UE the interface identifier for
the IPv6 link local address indicated in the Suggested interface identifier
IE.
For IPv4 PDU session type and for IPv4v6 PDU session type, the UE:
a) shall obtain an IPv4 address via:
1) NAS signalling as specified in subclause 6.2.4.2; or
2) DHCPv4; and
b) may obtain IPv4 configuration parameters (e.g. DNS server address) via
DHCPv4 or may receive IPv4 configuration parameters (e.g. DNS server address)
as specified in subclause 6.4.1 and subclause 6.3.2.
For IPv6 PDU session type and for IPv4v6 PDU session type, the UE:
a) shall build an IPv6 link local address based on the allocated interface
identifier for the IPv6 link local address;
b) shall obtain /64 IPv6 prefix via IPv6 stateless address autoconfiguration
as specified in 3GPP TS 23.501 [8] and IETF RFC 4862 [39], except when the
5G-RG or the W-AGF act according to subclause 6.2.4.3; and
c) may obtain IPv6 configuration parameters via stateless DHCPv6 as specified
in IETF RFC 8415 [33D], except when the 5G-RG or the W-AGF act according to
subclause 6.2.4.3, may receive IPv6 configuration parameters (e.g. DNS server
address) as specified in subclause 6.4.1 and subclause 6.3.2, or may receive
DNS server IPv6 addresses in a Router Advertisement Message as specified in
IETF RFC 4861 [38B] with recursive DNS server option as specified in IETF RFC
8106 [52].
#### 6.2.4.2 IP address allocation via NAS signalling
The UE shall set the PDU session type IE in the PDU SESSION ESTABLISHMENT
REQUEST message, based on its IP stack capabilities if the UE requests IP
connectivity as follows:
a) A UE:
1) which is IPv6 and IPv4 capable, shall set the PDU session type IE to IPv4,
IPv6 or IPv4v6 according to UE configuration or received policy.
2) which is only IPv6 capable, shall set the PDU session type IE to IPv6.
3) which is only IPv4 capable, shall set the PDU session type IE to IPv4.
b) When the IP version capability of the UE is unknown in the UE (as in the
case when the MT and TE are separated and the capability of the TE is not
known in the MT), the UE shall set the PDU session type IE to IPv4v6.
If the UE wants to use DHCPv4 for IPv4 address assignment, it shall indicate
that to the network within the Extended protocol configuration options IE in
the PDU SESSION ESTABLISHMENT REQUEST.
On receipt of the PDU SESSION ESTABLISHMENT REQUEST message sent by the UE,
the network when allocating an IP address shall take into account the PDU
session type IE, the operator\'s policies of the network, and the user\'s
subscription data and:
a) if the network sets the Selected PDU session type IE to IPv4, the network
shall include an IPv4 address in the PDU address IE;
b) if the network sets the Selected PDU session type IE to IPv6, the network
shall include an interface identifier for the IPv6 link local address in the
PDU address IE; and
c) if the network sets the Selected PDU session type IE to IPv4v6, the network
shall include an IPv4 address and an interface identifier for the IPv6 link
local address in the PDU address IE.
#### 6.2.4.3 Additional RG related requirements for IP address allocation
If IPv6 PDU session type or IPv4v6 PDU session type is selected, an IPv6
address, one or more IPv6 prefixes or both are allocated to the 5G-RG or the
W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device).
If the 5G-RG or the W-AGF acting on behalf of the FN-RG (or on behalf of the
N5GC device) receives a Router Advertisement Message as specified in IETF RFC
4861 [38B] with the \"Managed address configuration\" flag set to zero, the
5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC
device):
a) shall obtain /64 IPv6 prefix via IPv6 stateless address autoconfiguration
as specified in 3GPP TS 23.501 [8] and IETF RFC 4862 [39];
b) may obtain IPv6 configuration parameters via stateless DHCPv6 as specified
in IETF RFC 8415 [33D]; and
c) may request additional IPv6 prefixes using DHCPv6. If the 5G-RG and the
W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC device) request
IPv6 prefixes using DHCPv6, the 5G-RG and the W-AGF acting on behalf of the
FN-RG (or on behalf of the N5GC device) shall act as a \"Requesting Router\"
as described in IETF RFC 3633 [33C], shall obtain IPv6 prefixes using the
DHCPv6 Identity association for prefix delegation option as specified in IETF
RFC 8415 [33D], may include DHCPv6 Rapid commit option as specified in IETF
RFC 8415 [33D] in a DHCP message, and may include DHCPv6 OPTION_ORO option
with the OPTION_PD_EXCLUDE option code as specified in IETF RFC 6603 [40A] in
the DHCP message.
NOTE 1: The 5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of
the N5GC device) can include several DHCP options in a DHCP message.
If the 5G-RG or the W-AGF acting on behalf of the FN-RG receives a Router
Advertisement Message as specified in IETF RFC 4861 [38B] with the \"Managed
address configuration\" flag set to one, the 5G-RG and the W-AGF acting on
behalf of the FN-RG:
a) shall obtain an IPv6 address via DHCPv6 and the DHCPv6 Identity association
for non-temporary addresses option as specified in IETF RFC 8415 [33D];
b) may obtain IPv6 configuration parameters via DHCPv6 as specified in IETF
RFC 8415 [33D]; and
c) may request IPv6 prefixes using DHCPv6. If the 5G-RG and the W-AGF acting
on behalf of the FN-RG requests IPv6 prefixes using DHCPv6, the 5G-RG and the
W-AGF acting on behalf of the FN-RG shall act as a \"Requesting Router\" as
described in IETF RFC 8415 [33D], shall obtain IPv6 prefixes using the DHCPv6
Identity association for prefix delegation option as specified in IETF RFC
8415 [33D], may include DHCPv6 Rapid commit option as specified in IETF RFC
8415 [33D] in a DHCP message, and may include DHCPv6 OPTION_ORO option with
the OPTION_PD_EXCLUDE option code as specified in IETF RFC 6603 [40A] in the
DHCP message.
NOTE 2: The 5G-RG and the W-AGF acting on behalf of the FN-RG (or on behalf of
the N5GC device) can include several DHCP options in a DHCP message.
The 5G-RG may obtain ACS information via DHCP as specified in clause 3.1 of
BBF TR-069 [49] or in BBF TR-369 [50] R-DIS.1 and R-DIS.2.
#### 6.2.4.4 Additional requirements of the UE acting as 5G ProSe layer-3 UE-
to-network relay UE for IP address allocation
If a UE acting as 5G ProSe layer-3 UE-to-network relay needs to indicate
\"IPv6 Router\" or \"DHCPv4 Server & IPv6 Router\" in the IP address
configuration IE as specified in 3GPP 24.554 [19E], the UE shall support
acting as a \"Requesting Router\" as described in IETF RFC 8415 [33D] to
request additional IPv6 prefixes (i.e. prefixes in addition to the /64 default
prefix which was allocated via stateless IPv6 address autoconfiguration as
specified in subclause 6.2.4.1) from the SMF as specified in subclause 5.5.2
of 3GPP TS 23.304 [6E].
When the UE acting as 5G ProSe layer-3 UE-to-network relay UE requests
additional prefixes using DHCPv6, the UE:
a) shall include the OPTION_ORO option with the OPTION_PD_EXCLUDE option code
as specified in IETF RFC 6603 [40A] in the DHCP message; and
b) may include the Rapid Commit Option as specified in IETF RFC 8415 [33D] in
the DHCP message.
### 6.2.5 Quality of service
#### 6.2.5.1 General
##### 6.2.5.1.1 QoS rules
###### 6.2.5.1.1.1 General {#general-58 .list-paragraph}
In a PDU session of IPv4, IPv6, IPv4v6 and Ethernet PDU session type, the NAS
protocol enables different forwarding treatments of UL user data packets in
one or more QoS flows based on signalled QoS rules, derived QoS rules or any
combination of them.
In a PDU session of Unstructured PDU session type, all UL user data packets
are associated with the same QoS flow.
###### 6.2.5.1.1.2 Signalled QoS rules {#signalled-qos-rules .list-paragraph}
The NAS protocol enables the network to provide the UE with signalled QoS
rules associated with a PDU session.
The network can provide the UE with one or more signalled QoS rules associated
with a PDU session at the PDU session establishment or at the PDU session
modification.
Each signalled QoS rule contains:
a) an indication of whether the QoS rule is the default QoS rule;
b) a QoS rule identifier (QRI);
c) a QoS flow identifier (QFI);
d) optionally, a set of packet filters; and
e) a precedence value.
NOTE 1: The default QoS rule indication (DQR) of a signalled QoS rule cannot
be changed.
For case d) above:
1) If the QoS rule is the default QoS rule of a PDU session of IPv4, IPv6,
IPv4v6 or Ethernet PDU session type, the set of packet filters contains zero
or more packet filters for DL direction, and may additionaly contain one of
the following:
A) a match-all packet filter for UL direction;
B) a match-all packet filter for UL and DL directions;
C) zero or more packet filters for UL direction (other than the match-all
packet filter for UL direction);
D) zero or more packet filters for UL and DL directions (other than the match-
all packet filter for UL and DL directions); or
E) one or more packet filters for UL direction (other than the match-all
packet filter for UL direction) and one or more packet filters for UL and DL
directions (other than the match-all packet filter for UL and DL directions).
The set of packet filters for the default QoS rule shall not be empty. If the
default QoS rule contains a match-all packet filter, then the highest
precedence value shall be used for the default QoS rule.
2) If the QoS rule is a QoS rule of a PDU session of IPv4, IPv6, IPv4v6 or
Ethernet PDU session type and is not the default QoS rule, the set of packet
filters contains zero or more packet filters for the DL direction, and may
additionally contain one of the following:
A) zero or more packet filters for UL direction (other than the match-all
packet filter for UL direction); and
B) zero or more packet filters for both UL and DL directions (other than the
match-all packet filter for UL and DL directions).
The set of packet filters for a QoS rule which is not the default QoS rule
shall not be empty.
3) For PDU session of unstructured PDU session type, there is only one QoS
rule associated with it and the set of packet filters of that QoS rule is
empty.
If the UE requests a new QoS rule, it shall assign a precedence value for the
signalled QoS rule which is not in the range from 70 to 99 (decimal).
NOTE 2: In this release of the specification, there is no support for a match-
all packet filter for DL direction.
NOTE 3: In order to support QoS differentiation in case of access to PLMN
services via an SNPN, the UE, within the SNPN, can construct packet filters
based on the destination IP address to reach the N3IWF in the PLMN and the
security parameters index (SPI) for the IPsec SA.
NOTE 4: In order to support QoS differentiation in case of access to SNPN
services via a PLMN, the UE, within the PLMN, can construct packet filters
based on the destination IP address to reach the N3IWF in the SNPN and the
security parameters index (SPI) for the IPsec SA.
NOTE 5: The above described condition of assigning a precedence value for the
signalled QoS rule is applied to the UE when the UE requests a QoS rule for
network to bind service data flows described by the QoS rule to a dedicated
QoS flow by setting the segregation bit to 1.
In NB-N1 mode, there is only one QoS rule associated with a PDU session and
that is the default QoS rule. As described in 3GPP TS 23.501 [8], when the SMF
determines that the UE has:
a) moved from a tracking area in WB-N1 mode into a tracking area in NB-N1
mode;
b) moved from a tracking area in WB-S1 mode into a tracking area in NB-N1
mode; or
c) moved from a tracking area in NR connected to 5GCN into a tracking area in
NB-N1 mode;
the SMF shall, for each PDU session that is kept active, initiate the PDU
session modification procedure (see subclause 6.3.3.2) to delete every QoS
rule that is not the default QoS rule, if any.
Within a PDU session:
a) each signalled QoS rule has a unique QRI;
b) there is at least one signalled QoS rule;
c) one signalled QoS rule is the default QoS rule; and
d) there can be zero, one or more signalled QoS rules associated with a given
QFI.
###### 6.2.5.1.1.3 Derived QoS rules {#derived-qos-rules .list-paragraph}
Derived QoS rules are applicable only for PDU session of IPv4, IPv6, IPv4v6 or
Ethernet PDU session type.
The reflective QoS in the UE creates derived QoS rules associated with a PDU
session based on DL user data packets received via the PDU session.
Each derived QoS rule contains:
a) a QoS flow identifier (QFI);
b) a packet filter for UL direction; and
c) a precedence value of 80 (decimal).
NOTE: On the network side, the corresponding QoS rule can be associated with a
different precedence value in the range from 70 to 99 (decimal).
Within a PDU session:
a) there can be zero, one or more derived QoS rules associated with a given
QFI; and
b) there can be up to one derived QoS rule associated with a given packet
filter for UL direction.
In the UE, a timer T3583 runs for each derived QoS rule.
Reflective QoS is not supported in NB-N1 mode. Reflective QoS is not
applicable for a PDU session with control plane only indication.
###### 6.2.5.1.1.4 QoS flow descriptions {#qos-flow-descriptions .list-
paragraph}
The network can also provide the UE with one or more QoS flow descriptions
associated with a PDU session at the PDU session establishment or at the PDU
session modification.
Each QoS flow description contains:
a) a QoS flow identifier (QFI);
b) if the flow is a GBR QoS flow:
1) Guaranteed flow bit rate (GFBR) for UL;
2) Guaranteed flow bit rate (GFBR) for DL;
3) Maximum flow bit rate (MFBR) for UL;
4) Maximum flow bit rate (MFBR) for DL; and
5) optionally averaging window, applicable for both UL and DL;
c) 5QI, if the QFI is not the same as the 5QI of the QoS flow identified by
the QFI; and
d) optionally, an EPS bearer identity (EBI) if the QoS flow can be mapped to
an EPS bearer as specified in subclause 4.11.1 of 3GPP TS 23.502 [9].
If the averaging window is not included in a QoS flow description for a GBR
QoS flow with a 5QI indicated in 3GPP TS 23.501 [8] table 5.7.4-1, the
averaging window associated with the 5QI in 3GPP TS 23.501 [8] table 5.7.4-1
applies for the averaging window.
If the averaging window is not included in a QoS flow description for a GBR
QoS flow with a 5QI not indicated in 3GPP TS 23.501 [8] table 5.7.4-1, the
standardized value of two seconds is used as the averaging window.
##### 6.2.5.1.2 Session-AMBR
The NAS protocol enables the network to provide the UE with the session-AMBR
associated with a PDU session.
The standardized value of two seconds is used as the averaging window for the
UE\'s enforcement of the UL rate limitation indicated by the session-AMBR.
##### 6.2.5.1.2A Void
##### 6.2.5.1.3 UL user data packet matching
For PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, upon
receiving an UL user data packet from the upper layers for transmission via a
PDU session, the UE shall attempt to associate the UL user data packet with:
a) the QFI of a signalled QoS rule associated with the PDU session which has a
set of packet filters containing a packet filter for UL direction matching the
UL user data packet or containing a packet filter for both UL and DL
directions matching the UL user data packet; or
b) the QFI of a derived QoS rule associated with the PDU session which has the
packet filter for UL direction matching the UL user data packet;
by evaluating the QoS rules in increasing order of their precedence values
until the UL user data packet is associated with a QFI or all QoS rules are
evaluated.
For PDU session of unstructured PDU session type, upon receiving an UL user
data packet from the upper layers for transmission via a PDU session, the UE
shall associate the UL user data packet with the QFI of the default QoS rule
associated with the PDU session.
If the UL user data packet is associated with a QFI, the UE shall pass the QFI
along the UL user data packet to the lower layers for transmission.
NOTE: Marking of the UL user data packet with the QFI is performed by the
lower layers.
If all QoS rules are evaluated and the UL user data packet is not associated
with a QFI, the UE shall discard the UL user data packet.
##### 6.2.5.1.4 Reflective QoS
###### 6.2.5.1.4.1 General {#general-59 .list-paragraph}
The UE may support reflective QoS.
If the UE supports the reflective QoS, the UE shall support the procedures in
the following subclauses.
The reflective QoS is applicable in a PDU session of IPv4, IPv6, IPv4v6 and
Ethernet PDU session type. The reflective QoS is not applicable in a PDU
session of Unstructured PDU session type. Reflective QoS is not applicable for
a PDU session with control plane only indication.
The UE may request to revoke the usage of reflective QoS for an existing PDU
session for which the UE had previously indicated support for reflective QoS.
###### 6.2.5.1.4.2 Derivation of packet filter for UL direction from DL user
data packet {#derivation-of-packet-filter-for-ul-direction-from-dl-user-data-
packet .list-paragraph}
If the UE needs to derive a packet filter for UL direction from the DL user
data packet (see subclause 6.2.5.1.4.3 and 6.2.5.1.4.4), the UE shall proceed
as follows:
a) if the received DL user data packet belongs to a PDU session of IPv4 or
IPv4v6 PDU session type and is an IPv4 packet and:
1) the protocol field of the received DL user data packet indicates TCP as
specified in IETF RFC 793 [33];
2) the protocol field of the received DL user data packet indicates UDP as
specified in IETF RFC 768 [32]; or
3) the protocol field of the received DL user data packet indicates ESP as
specified in IETF RFC 4303 [38] and an uplink IPSec SA corresponding to a
downlink IPSec SA indicated in the security parameters index field of the
received DL user data packet exists;
then the packet filter for UL direction contains the following packet filter
components:
1) an IPv4 remote address component set to the value of the source address
field of the received DL user data packet;
2) an IPv4 local address component set to the value of the destination address
field of the received DL user data packet;
3) a protocol identifier/next header type component set to the value of the
protocol field of the received DL user data packet;
4) if the protocol field of the received DL user data packet indicates TCP as
specified in IETF RFC 793 [33] or UDP as specified in IETF RFC 768 [32]:
i) a single local port type component set to the value of the destination port
field of the received DL user data packet; and
ii) a single remote port type component set to the value of the source port
field of the received DL user data packet;
5) if the protocol field of the received DL user data packet indicates ESP as
specified in IETF RFC 4303 [38], an uplink IPSec SA corresponding to a
downlink IPSec SA of the SPI in the DL user data packet exists and the SPI of
the uplink IPSec SA is known to the NAS layer:
i) a security parameter index type component set to the security parameters
index of the uplink IPSec SA corresponding to the downlink IPSec SA indicated
in the security parameters index field of the received DL user data packet;
and
6) if the protocol field of the received DL user data packet indicates UDP and
the received DL user data packet contains a UDP-encapsulated ESP header as
specified in IETF RFC 3948 [55], an uplink IPSec SA corresponding to a
downlink IPSec SA of the SPI in the DL user data packet exists and the SPI of
the uplink IPSec SA is known to the NAS layer:
i) a security parameter index type component set to the security parameters
index of the uplink IPSec SA corresponding to the downlink IPSec SA indicated
in the security parameters index field of the ESP header field of the UDP-
encapsulated ESP header as specified in IETF RFC 3948 [55] of the received DL
user data packet;
otherwise it is not possible to derive a packet filter for UL direction from
the DL user data packet;
b) if the received DL user data packet belongs to a PDU session of IPv6 or
IPv4v6 PDU session type and is an IPv6 packet and:
1) the last next header field of the received DL user data packet indicates
TCP as specified in IETF RFC 793 [33];
2) the last next header field of the received DL user data packet indicates
UDP as specified in IETF RFC 768 [32]; or
3) the last next header field of the received DL user data packet indicates
ESP as specified in IETF RFC 4303 [38] and an uplink IPSec SA corresponding to
a downlink IPSec SA indicated in the security parameters index field of the
received DL user data packet exists;
then the packet filter for UL direction contains the following packet filter
components:
1) an IPv6 remote address/prefix length component set to the value of the
source address field of the received DL user data packet;
2) an IPv6 local address/prefix length component set to the value of the
destination address field of the received DL user data packet;
3) a protocol identifier/next header type component set to the value of the
last next header field of the received DL user data packet;
4) if the last next header field of the received DL user data packet indicates
TCP as specified in IETF RFC 793 [33] or UDP as specified in IETF RFC 768
[32]:
i) a single local port type component set to the value of the destination port
field of the received DL user data packet; and
ii) a single remote port type component set to the value of the source port
field of the received DL user data packet;
5) if the last next header field of the received DL user data packet indicates
ESP as specified in IETF RFC 4303 [38], an uplink IPSec SA corresponding to a
downlink IPSec SA of the SPI in the DL user data packet exists and the SPI of
the uplink IPSec SA is known to the NAS layer:
i) a security parameter index type component set to the security parameters
index of the uplink IPSec SA corresponding to the downlink IPSec SA indicated
in the security parameters index field of the received DL user data packet;
and
6) if the protocol field of the received DL user data packet indicates UDP,
and the received DL user data packet contains a UDP-encapsulated ESP header as
specified in IETF RFC 3948 [55], an uplink IPSec SA corresponding to a
downlink IPSec SA of the SPI in the DL user data packet exists and the SPI of
the uplink IPSec SA is known to the NAS layer:
i) a security parameter index type component set to the security parameters
index of the uplink IPSec SA corresponding to the downlink IPSec SA indicated
in the security parameters index field of the ESP header field of the UDP-
encapsulated ESP header as specified in IETF RFC 3948 [55] of the received DL
user data packet;
otherwise it is not possible to derive a packet filter for UL direction from
the DL user data packet;
c) if the received DL user data packet belongs to a PDU session of Ethernet
PDU session type, the packet filter for UL direction contains the following
packet filter components:
1) a destination MAC address component set to the source MAC address of the
received DL user data packet;
2) a source MAC address component set to the destination MAC address of the
received DL user data packet;
3) if one or more 802.1Q C-TAG is included in the received DL user data
packet, an 802.1Q C-TAG VID component set to the outermost 802.1Q C-TAG VID of
the received DL user data packet and an 802.1Q C-TAG PCP/DEI component set to
the outermost 802.1Q C-TAG PCP/DEI of the received DL user data packet;
4) if one or more 802.1Q S-TAG is included in the received DL user data
packet, an 802.1Q S-TAG VID component set to the outermost 802.1Q S-TAG VID of
the received DL user data packet and an 802.1Q S-TAG PCP/DEI component set to
the outermost 802.1Q S-TAG PCP/DEI of the received DL user data packet;
5) If the Ethertype field of the received DL user data packet is set to a
value of 1536 or above, an Ethertype component set to the Ethertype of the
received DL user data packet;
6) if the Ethertype field of the Ethernet frame header indicates that the data
carried in the Ethernet frame is IPv4 data, the UE shall also add to the
packet filter for UL direction the IP-specific components based on the
contents of the IP header of the received DL user data packet as described in
bullet a) above; and
7) if the Ethertype field of the Ethernet frame header indicates that the data
carried in the Ethernet frame is IPv6 data, the UE shall also add to the
packet filter for UL direction the IP-specific components based on the
contents of the IP header of the received DL user data packet as described in
bullet b) above; and
d) if the received DL user data packet belongs to a PDU session of PDU session
type other than Ethernet, IPv4, IPv6 and IPv4v6, it is not possible to derive
a packet filter for UL direction from the DL user data packet.
###### 6.2.5.1.4.3 Creating a derived QoS rule by reflective QoS in the UE
{#creating-a-derived-qos-rule-by-reflective-qos-in-the-ue .list-paragraph}
If the UE receives a DL user data packet marked with a QFI and an RQI, the DL
user data packet belongs to a PDU session of IPv4, IPv6, IPv4v6 or Ethernet
PDU session type, and the UE does not have a derived QoS rule with the same
packet filter for UL direction as the packet filter for UL direction derived
from the DL user data packet as specified in subclause 6.2.5.1.4.2, then the
UE shall create a new derived QoS rule as follows:
a) the QFI of the derived QoS rule is set to the received QFI;
b) the precedence value of the derived QoS rule is set to 80 (decimal); and
c) the packet filter for UL direction of the derived QoS rule is set to the
derived packet filter for UL direction;
and the UE shall start the timer T3583 associated with the derived QoS rule
with the RQ timer value last received during the UE-requested PDU session
establishment procedure of the PDU session (see subclause 6.4.1) or the
network-requested PDU session modification procedure of the PDU session (see
subclause 6.4.2). If the RQ timer value was received neither in the UE-
requested PDU session establishment procedure of the PDU session nor in any
network-requested PDU session modification procedure of the PDU session, the
default standardized RQ timer value is used.
###### 6.2.5.1.4.4 Updating a derived QoS rule by reflective QoS in the UE
{#updating-a-derived-qos-rule-by-reflective-qos-in-the-ue .list-paragraph}
If the UE receives a DL user data packet associated with a QFI and an RQI, the
DL user data packet belongs to a PDU session of IPv4, IPv6, IPv4v6 or Ethernet
PDU session type, and the UE has a derived QoS rule with the same packet
filter for UL direction as the packet filter for UL direction derived from the
DL user data packet as specified in subclause 6.2.5.1.4.2:
a) the UE shall re-start the timer T3583 associated with the derived QoS rule
with the RQ timer value last received during the UE-requested PDU session
establishment procedure of the PDU session (see subclause 6.4.1) or the
network-requested PDU session modification procedure of the PDU session (see
subclause 6.4.2). If the RQ timer value was received neither in the UE-
requested PDU session establishment procedure of the PDU session nor in any
network-requested PDU session modification procedure of the PDU session, the
default standardized RQ timer value is used; and
b) if the QFI value associated with the DL user data packet is different from
the QFI value stored for the derived QoS rule, the UE shall replace the QFI
value stored for the derived QoS rule with the new QFI value for the derived
QoS rule.
###### 6.2.5.1.4.5 Deleting a derived QoS rule in the UE {#deleting-a-derived-
qos-rule-in-the-ue .list-paragraph}
Upon expiry of timer T3583 associated with a derived QoS rule, the UE shall
remove the derived QoS rule.
Upon release of the PDU session, the UE shall remove the derived QoS rule(s)
associated with the PDU session.
If the network accepts the request from the UE to revoke the usage of
reflective QoS and sets the value of the RQ timer to \"deactivated\" or zero,
the UE shall remove the derived QoS rule(s) associated with the PDU session.
Upon inter-system mobility from WB-N1 mode to NB-N1 mode or from NR connected
to 5GCN to NB-N1 mode, the UE shall remove the derived QoS rule(s) associated
with the PDU session that is kept active.
When a derived QoS rule is deleted, the timer T3583 associated with the
derived QoS rule shall be stopped.
###### 6.2.5.1.4.6 Ignoring RQI in the UE {#ignoring-rqi-in-the-ue .list-
paragraph}
If the UE receives a DL user data packet marked with a QFI and an RQI and it
is not possible to derive a packet filter for UL direction from the DL user
data packet as specified in subclause 6.2.5.1.4.2, the UE shall ignore the RQI
and shall handle the received DL user data packet.
#### 6.2.5.2 QoS in MA PDU session
In an MA PDU session, unless it :
a) is established over non-3GPP access; and
b) has a PDN connection as a user-plane resource;
the UE shall have one set of QoS rules, one set of QoS flow descriptions and
one session-AMBR. The network can provide the set of QoS rules, the set of QoS
flow descriptions and the session-AMBR of the MA PDU session via either access
of the MA PDU session. In an MA PDU session, the UE shall support:-
\- modification or deletion via an access of a QoS rule or a QoS flow
description; and
\- modification via an access of the session-AMBR;
of the MA PDU session created via the same or the other access.
In an MA PDU session:
a) established over non-3GPP access; and
b) with a PDN connection as a user-plane resource;
the UE shall have two sets of QoS rules, two sets of QoS flow descriptions and
two session-AMBR values - one is maintained via non-3GPP access and the other
is associated with EPS bearer contexts of the PDN connection and maintained
via extended protocol configuration options IE parameters received via the PDN
connection.
### 6.2.6 Local area data network (LADN)
The UE can receive the local area data network (LADN) information consisting
of LADN DNNs and LADN service area information (a set of tracking areas that
belong to the current registration area) during the registration procedure or
the generic UE configuration update procedure (see subclause 5.5.1 and
subclause 5.4.4).
If the UE is not operating in SNPN access operation mode, the UE considers the
received LADN information to be valid only in the TAIs of the registered PLMN
that are in the LADN service area information, and in the TAIs of the
equivalent PLMNs if the LADN service area information includes TAIs for the
equivalent PLMNs. When the AMF provides the UE with LADN service area
information containing TAIs for the equivalent PLMNs, the AMF shall include
these TAIs of the equivalent PLMNs in the UE\'s registration area.
If the UE is operating in SNPN access operation mode, the UE considers the
received LADN information to be valid only in the TAIs of the registered SNPN
that are in the LADN service area information.
The LADN DNN(s) received by the UE is also considered as LADN DNN(s) in the
equivalent PLMNs.
The UE shall consider itself to be located inside the LADN service area based
on the LADN service area information. If the UE does not have a LADN service
area information for the LADN DNN, the UE shall consider itself to be located
outside the LADN service area.
When the UE is located in the LADN service area and the UE is in substate
5GMM-REGISTERED.NORMAL-SERVICE, the UE may initiate:
\- the UE-requested PDU session establishment procedure with a LADN DNN to
establish a PDU session for LADN;
\- the UE-requested PDU session modification procedure to modify the PDU
session for LADN; and
\- the service request procedure to re-establish the user-plane resources for
the PDU session for LADN.
NOTE 1: If both the Service area list IE and the LADN information IE were
received by the UE, the Service area list IE is evaluated first.
When the UE is located outside the LADN service area, the UE is allowed:
\- to initiate the UE-requested PDU session release procedure to release a PDU
session for LADN; or
\- to initiate the UE-requested PDU session modification procedure to indicate
a change of 3GPP PS data off UE status.
If the UE has moved out of the LADN service area, the SMF shall:
a) release the PDU session for LADN; or
b) release the user-plane resources for the PDU session for LADN and maintain
the PDU session for LADN;
according to operator\'s policy.
In case b):
\- if the UE has returned to the LADN service area, and the network has
downlink user data pending, the network re-establishes the user-plane
resources for the PDU session for LADN; and.
\- if the UE has not returned to the LADN service area after a period of time
according to operator\'s policy, the SMF may release the PDU session for LADN.
When the UE moves to 5GMM-DEREGISTERED state, the UE shall delete the stored
LADN information, if any.
NOTE 2: In this release, LADNs apply only to 3GPP access.
Upon inter-system change from N1 mode to S1 mode in EMM-IDLE mode, the UE
shall not transfer a PDU session for LADN to EPS.
### 6.2.7 Handling of DNN based congestion control
The network may detect and start performing DNN based congestion control when
one or more DNN congestion criteria as specified in 3GPP TS 23.501 [8] are
met. If the UE does not provide a DNN for a non-emergency PDU session, then
the network uses the selected DNN.
In the UE, 5GS session management timers T3396 for DNN based congestion
control are started and stopped on a per DNN basis except for an LADN DNN in
case of PLMN. For an LADN DNN, 5GS session management timers T3396 for DNN
based congestion control is applied to the registered PLMN and its equivalent
PLMNs. In case of SNPN, if the UE does not support access to an SNPN using
credentials from a credentials holder, in the UE, 5GS session management
timers T3396 for DNN based congestion control are started and stopped on a per
DNN and SNPN basis. If the UE supports access to an SNPN using credentials
from a credentials holder, in the UE 5GS session management timers T3396 for
DNN based congestion control are started and stopped on a per DNN, SNPN and
selected entry of the \"list of subscriber data\" or selected PLMN
subscription basis. Upon receipt of a 5GMM message or 5GSM message from the
network for which the UE needs to stop the running timers T3396 associated
with an LADN DNN as specified in subclause 6.3.2.3, 6.3.3.3, 6.4.1.4.2 and
6.4.2.4.2, only the running timer T3396 which is associated with the PLMN and
equivalent PLMNs where the timer was started is stopped.
The DNN associated with T3396 is the DNN provided by the UE during the PDU
session establishment. If no DNN is provided by the UE along the PDU SESSION
ESTABLISHMENT REQUEST, then T3396 is associated with no DNN. For this purpose,
the UE shall memorize the DNN provided to the network during the PDU session
establishment. The timer T3396 associated with no DNN will never be started
due to any 5GSM procedure related to an emergency PDU session. If the timer
T3396 associated with no DNN is running, it does not affect the ability of the
UE to request an emergency PDU session.
If T3396 is running or is deactivated, then the UE is not allowed to initiate
the:
a) PDU session establishment procedure;
b) PDU session modification procedure; or
c) NAS transport procedure for sending CIoT user data;
for the respective DNN or without a DNN unless the UE is a UE configured for
high priority access in selected PLMN or to report a change of 3GPP PS data
off UE status.
### 6.2.8 Handling of S-NSSAI based congestion control
The network may detect and start performing S-NSSAI based congestion control
when one or more S-NSSAI congestion criteria as specified in 3GPP TS 23.501
[8] are met. If the UE does not provide a DNN for a non-emergency PDU session,
then the network uses the selected DNN. If the UE does not provide an S-NSSAI
for a non-emergency PDU session, then the network uses the selected S-NSSAI.
In case of PLMN, in the UE, 5GS session management timers T3584 for the
S-NSSAI based congestion control are started and stopped on a per S-NSSAI, DNN
and PLMN basis. If the 5GSM congestion re-attempt indicator IE with the ABO
bit set to \"The back-off timer is applied in all PLMNs\" is included in the
5GSM message with the 5GSM cause value #67 \"insufficient resources for
specific slice and DNN\", then the UE applies the timer T3584 for all the
PLMNs. Otherwise, the UE applies the timer T3584 for the registered PLMN. If
the timer T3584 applies for all the PLMNs, the timer T3584 starts when the UE
is registered in a VPLMN and the S-NSSAI is provided by the UE during the PDU
session establishment, the timer T3584 is associated with the [mapped S-NSSAI,
DNN] combination of the PDU session.
In case of PLMN, in the UE, 5GS session management timers T3585 for the
S-NSSAI based congestion control are started and stopped on a per S-NSSAI and
PLMN basis. If the 5GSM congestion re-attempt indicator IE with the ABO bit
set to \"The back-off timer is applied in all PLMNs\" is included in the 5GSM
message with the 5GSM cause value #69 \"insufficient resources for specific
slice\", then the UE applies the timer T3585 for all the PLMNs. Otherwise, the
UE applies the timer T3585 for the registered PLMN. If the timer T3585 applies
for all the PLMNs, the timer T3585 starts when the UE is registered in a VPLMN
and the S-NSSAI is provided by the UE during the PDU session establishment,
the timer T3585 is associated with the mapped S-NSSAI of the PDU session.
Additionally, if the 5GSM congestion re-attempt indicator IE with the CATBO
bit set to \"The back-off timer is applied in the current access type\" is
included in the 5GSM message with the 5GSM cause value #69 \"insufficient
resources for specific slice\", then the UE applies the timer T3585 for the
current access type. Otherwise, the UE applies the timer T3585 for both 3GPP
access type and non-3GPP access type.
In case of SNPN, if the UE does not support access to an SNPN using
credentials from a credentials holder, in the UE 5GS session management timers
T3584 for the S-NSSAI based congestion control are started and stopped on a
per S-NSSAI, DNN and SNPN basis. If the UE supports access to an SNPN using
credentials from a credentials holder, in the UE 5GS session management timers
T3584 for the S-NSSAI based congestion control are started and stopped on a
per S-NSSAI, DNN, SNPN and selected entry of the \"list of subscriber data\"
or selected PLMN subscription basis.
In case of SNPN, if the UE does not support access to an SNPN using
credentials from a credentials holder, in the UE 5GS session management timers
T3585 for the S-NSSAI based congestion control are started and stopped on a
per S-NSSAI and SNPN basis. If the UE supports access to an SNPN using
credentials from a credentials holder, in the UE 5GS session management timers
T3585 for the S-NSSAI based congestion control are started and stopped on a
per S-NSSAI, SNPN and selected entry of the \"list of subscriber data\" or
selected PLMN subscription basis.
The 5GSM congestion re-attempt indicator IE shall not be applicable in an
SNPN.
If the timer T3584 or timer T3585 was provided during the PDU session
establishment procedure, the S-NSSAI associated with T3584 or T3585,
respectively is the S-NSSAI, including no S-NSSAI, provided by the UE during
the PDU session establishment.
If the timer T3584 is provided during the PDU session modification or PDU
session release procedure, the UE behaves as follows: The DNN associated with
T3584 is the DNN provided by the UE during the PDU session establishment. If
no S-NSSAI but DNN is provided by the UE along the PDU SESSION ESTABLISHMENT
REQUEST message, then T3584 is associated with no S-NSSAI and the DNN provided
to the network during the PDU session establishment. If the PDN connection was
established when in the S1 mode, then T3584 is associated with no S-NSSAI. If
no DNN but S-NSSAI is provided by the UE along the PDU SESSION ESTABLISHMENT
REQUEST message, then T3584 is associated with no DNN and the S-NSSAI of the
PDU session. If no DNN and no S-NSSAI is provided by the UE along the PDU
SESSION ESTABLISHMENT REQUEST message, then T3584 is associated with no DNN
and no S-NSSAI. For this purpose, the UE shall memorize the DNN and the
S-NSSAI provided to the network during the PDU session establishment. The
timer T3584 associated with no DNN and an S-NSSAI will never be started due to
any 5GSM procedure related to an emergency PDU session. If the timer T3584
associated with no DNN and an S-NSSAI is running, it does not affect the
ability of the UE to request an emergency PDU session.
If the timer T3585 was provided during the PDU session modification or PDU
session release procedure, the UE behaves as follows: if an S-NSSAI was
provided by the UE during the PDU session establishment, then T3585 is
associated with the S-NSSAI of the PDU session. If no S-NSSAI is provided by
the UE along the PDU SESSION ESTABLISHMENT REQUEST message, then T3585 is
associated with no S-NSSAI. If the PDN connection was established when in the
S1 mode, then T3585 is associated with no S-NSSAI.
If T3584 is running or is deactivated, then the UE is not allowed to initiate
the:
a) PDU session establishment procedure;
b) PDU session modification procedure; or
c) NAS transport procedure for sending CIoT user data;
for the respective [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination unless the
UE is a UE configured for high priority access in selected PLMN or to report a
change of 3GPP PS data off UE status.
If the timer T3584 is running or is deactivated for all the PLMNs and is
associated with an S-NSSAI other than no S-NSSAI, then
a) the UE registered in the HPLMN is not allowed to initiate the:
1) PDU session establishment procedure;
2) PDU session modification procedure; or
3) NAS transport procedure for sending CIoT user data;
when the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination provided by the UE
during the PDU session establishment is the same as the [S-NSSAI, no DNN] or
[S-NSSAI, DNN] combination associated with the timer T3584 unless the UE is a
UE configured for high priority access in selected PLMN or to report a change
of 3GPP PS data off UE status; and
b) the UE registered in a VPLMN is not allowed to initiate the:
1) PDU session establishment procedure;
2) PDU session modification procedure; or
3) NAS transport procedure for sending CIoT user data;
when the [mapped S-NSSAI, no DNN] or [mapped S-NSSAI, DNN] combination
provided by the UE during the PDU session establishment is the same as the
[S-NSSAI, no DNN] or [S-NSSAI, DNN] combination associated with the timer
T3584 unless the UE is a UE configured for high priority access in selected
PLMN or to report a change of 3GPP PS data off UE status.
If the timer T3584 is running or is deactivated for all the PLMNs and is
associated with [no S-NSSAI, no DNN] or [no S-NSSAI, DNN] combination, then
the UE is not allowed to initiate the:
a) PDU session establishment procedure;
b) PDU session modification procedure; or
c) NAS transport procedure for sending CIoT user data;
for [no S-NSSAI, no DNN] or [no S-NSSAI, DNN] combination in any PLMN unless
the UE is a UE configured for high priority access in selected PLMN or to
report a change of 3GPP PS data off UE status.
If T3585 is running or is deactivated, then the UE is neither allowed to
initiate the PDU session establishment procedure nor the PDU session
modification procedure for the respective S-NSSAI unless the UE is a UE
configured for high priority access in selected PLMN or to report a change of
3GPP PS data off UE status.
If the timer T3585 is running or is deactivated for all the PLMNs and is
associated with an S-NSSAI other than no S-NSSAI, then
a) the UE registered in the HPLMN is not allowed to initiate the:
1) PDU session establishment procedure;
2) PDU session modification procedure; or
3) NAS transport procedure for sending CIoT user data;
when the S-NSSAI provided by the UE during the PDU session establishment is
the same as the S-NSSAI associated with timer T3585 unless the UE is a UE
configured for high priority access in selected PLMNs or to report a change of
3GPP PS data off UE status; and
b) the UE registered in a VPLMN is not allowed to initiate the:
1) PDU session establishment procedure;
2) PDU session modification procedure; or
3) NAS transport procedure for sending CIoT user data;
when the mapped S-NSSAI provided by the UE during the PDU session
establishment is the same as the S-NSSAI associated the timer T3585 unless the
UE is a UE configured for high priority access in selected PLMN or to report a
change of 3GPP PS data off UE status.
If the timer T3585 is running or is deactivated for all the PLMNs and is
associated with no S-NSSAI, then the UE is not allowed to initiate the:
a) PDU session establishment procedure;
b) PDU session modification procedure;
c) NAS transport procedure for sending CIoT user data;
for no S-NSSAI in any PLMN unless the UE is a UE configured for high priority
access in selected PLMN or to report a change of 3GPP PS data off UE status.
### 6.2.9 Interaction with upper layers
#### 6.2.9.1 General
A 5GSM entity may interact with upper layers. Subclause 6.2.9.2 describes how
the 5GSM entity interacts with upper layers with respect to the URSP.
Subclause 6.2.9.3 describes how the 5GSM entity interacts with upper layers
with respect to the ProSeP.
#### 6.2.9.2 URSP
The URSP requires interaction between upper layers and the 5GSM entities in
the UE (see 3GPP TS 24.526 [19] for further details). Each of the 5GSM
entities in the UE shall indicate attributes (e.g. PDU session identity, SSC
mode, S-NSSAI, DNN, PDU session type, access type, PDU address) of a newly
established PDU session to the upper layers. If a PDU session is released, the
5GSM entity handling the PDU session shall inform the PDU session identity of
the released PDU session to the upper layers. The upper layers may request a
5GSM entity:
a) to establish a PDU session indicating one or more PDU session attributes;
b) to release an existing PDU session; or
c) to establish a PDU session indicating one or more PDU session attributes,
and to release an existing PDU session.
#### 6.2.9.3 ProSeP
The ProSeP requires interaction between upper layers and the 5GSM entities in
the UE acting as a 5G ProSe layer-3 UE-to-network relay UE (see 3GPP TS 24.554
[19E] for further details). The upper layers may request the 5GSM entity:
a) to establish a PDU session indicating one or more PDU session attributes;
or
b) to release the existing PDU session; or
c) to establish a PDU session indicating one or more PDU session attributes,
and to release the existing PDU session.
Each of the 5GSM entities in the UE acting as a 5G ProSe layer-3 UE-to-network
relay UE shall indicate attributes (e.g. PDU session identity, SSC mode,
S-NSSAI, DNN, PDU session type, access type, PDU address) of the newly
established PDU session to the upper layers. If the PDU session is released,
the 5GSM entity handling the PDU session shall inform the PDU session identity
of the released PDU session to the upper layers.
### 6.2.10 Handling of 3GPP PS data off
In case of PLMN, a UE, which supports 3GPP PS data off (see 3GPP TS 23.501
[8]), can be configured with up to two lists of 3GPP PS data off exempt
services as specified in 3GPP TS 24.368 [17] or in the EF~3GPPPSDATAOFF~ USIM
file as specified in 3GPP TS 31.102 [22]:
a) a list of 3GPP PS data off exempt services to be used in the HPLMN or
EHPLMN; and
b) a list of 3GPP PS data off exempt services to be used in the VPLMN.
If only the list of 3GPP PS data off exempt services to be used in the HPLMN
or EHPLMN is configured at the UE, this list shall be also used in the VPLMN.
In case of SNPN, a UE, which supports 3GPP PS data off (see 3GPP TS 23.501
[8]), can be configured with:
a) up to two lists of 3GPP PS data off exempt services as specified in 3GPP TS
24.368 [17] for each subscribed SNPN whose entry exists in the \"list of
subscriber data\":
1) a list of 3GPP PS data off exempt services to be used in the subscribed
SNPN; and
2) a list of 3GPP PS data off exempt services to be used in the non-subscribed
SNPN; and
b) one list of 3GPP PS data off exempt services as specified in 3GPP TS 24.368
[17] for PLMN subscription:
1) a list of 3GPP PS data off exempt services to be used in the non-subscribed
SNPN.
If only the list of 3GPP PS data off exempt services to be used in the
subscribed SNPN is configured for the selected entry of \"list of subscriber
data\", this list shall be also used in the non-subscribed SNPN.
If the UE supports 3GPP PS data off, the UE shall provide the 3GPP PS data off
UE status in the Extended protocol configuration options IE during UE-
requested PDU session establishment procedure except for the transfer of a PDU
session from non-3GPP access to 3GPP access and except for the establishment
of user plane resources on the other access for the MA PDU session(see
subclause 6.4.1), and during UE-requested PDU session modification procedure
(see subclause 6.4.2), regardless of associated access type of the PDU
session. If the UE requests a PDU session establishment procedure in order to
transfer a PDU session from non-3GPP access to 3GPP access, or in order to
establish user plane resources on the other access for the MA PDU session over
3GPP access or non-3GPP access, and:
a) if the 3GPP PS data off UE status has changed since the last providing to
the network, the UE shall provide the 3GPP PS data off UE status in the
Extended protocol configuration options IE; or
b) if the 3GPP PS data off UE status has not changed since the last providing
to the network, the UE need not provide the 3GPP PS data off UE status.
The network shall support of 3GPP PS data off.
The UE shall indicate change of the 3GPP PS data off UE status for the PDU
session by using the UE-requested PDU session modification procedure as
specified in subclause 6.4.2.
When the 3GPP PS data off UE status is \"activated\":
a) the UE does not send uplink IP packets via 3GPP access except:
1) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the HPLMN or EHPLMN as specified in 3GPP TS 24.368 [17]
when the UE is in its HPLMN or EHPLMN;
2) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the subscribed SNPN, configured for the selected entry
of \"list of subscriber data\", as specified in 3GPP TS 24.368 [17] when the
UE is in the subscribed SNPN;
3) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the HPLMN or EHPLMN when the UE is in the VPLMN, if
only the list of 3GPP PS data off exempt services to be used in the HPLMN or
EHPLMN is configured to the UE as specified in 3GPP TS 24.368 [17];
4) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the subscribed SNPN, configured for the selected entry
of \"list of subscriber data\", when the UE is in a non-subscribed SNPN and
only the list of 3GPP PS data off exempt services to be used in the subscribed
SNPN is configured for the selected entry of \"list of subscriber data\" as
specified in 3GPP TS 24.368 [17];
5) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the VPLMN when the UE is in the VPLMN, if the list of
3GPP PS data off exempt services to be used in the VPLMN is configured to the
UE as specified in 3GPP TS 24.368 [17];
6) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the non-subscribed SNPN, configured for the selected
entry of \"list of subscriber data\", when the UE is in a non-subscribed SNPN
and the list of 3GPP PS data off exempt services to be used in the non-
subscribed SNPN is configured for the selected entry of \"list of subscriber
data\" as specified in 3GPP TS 24.368 [17];
7) for those services indicated in the list of 3GPP PS data off exempt
services to be used in the non-subscribed SNPN, configured for the selected
PLMN subscription, when the UE is in the non-subscribed SNPN and the list of
3GPP PS data off exempt services to be used in the non-subscribed SNPN is
configured for the selected PLMN subscription as specified in 3GPP TS 24.368
[17];
8) for those services indicated in the EF~3GPPPSDATAOFF~ USIM file as
specified in 3GPP TS 31.102 [22];
9) any uplink traffic due to procedures specified in 3GPP TS 24.229 [14]; and
10) any uplink traffic due to procedures specified in 3GPP TS 24.623 [20];
b) the UE does not send uplink Ethernet user data packets via 3GPP access; and
c) the UE does not send uplink Unstructured user data packets via 3GPP access.
Otherwise the UE sends uplink user data packets without restriction.
NOTE: If the UE supports 3GPP PS data off, uplink IP packets are filtered as
specified in 3GPP TS 24.229 [14] in U.3.1.5.
3GPP PS data off does not restrict sending of uplink user data packets via
non-3GPP access of a single access PDU session or an MA PDU session.
### 6.2.11 Multi-homed IPv6 PDU session
The UE supporting IPv6 may support multi-homed IPv6 PDU session.
If the UE supports the multi-homed IPv6 PDU session:
a) the UE shall support acting as a type C host as specified in IETF RFC 4191
[36]; and
b) the UE indicates support of the multi-homed IPv6 PDU session:
1) during the UE-requested PDU session establishment of a PDU session of
\"IPv6\" or \"IPv4v6\" PDU session type; and
2) during the UE-requested PDU session modification performed after an inter-
system change from S1 mode to N1 mode, for a PDU session associated with a PDN
connection established when in S1 mode, if the UE is a UE operating in single-
registration mode in a network supporting N26 interface, the PDU session is of
\"IPv6\" or \"IPv4v6\" PDU session type, and the UE has not previously
successfully performed the UE-requested PDU session modification to provide
this indication.
### 6.2.12 Handling of network rejection not due to congestion control
The network may include a back-off timer value in a 5GS session management
reject message to regulate the time interval at which the UE may retry the
same procedure for 5GSM cause values other than #26 \"insufficient
resources\", #28 \"unknown PDU session type\", #39 \"reactivation requested\",
#46 \"out of LADN service area\", #50 \"PDU session type IPv4 only allowed\",
#51 \"PDU session type IPv6 only allowed\", #54 \"PDU session does not
exist\", #57 \"PDU session type IPv4v6 only allowed\", #58 \"PDU session type
Unstructured only allowed\", #61 \"PDU session type Ethernet only allowed\",
#67 \"insufficient resources for specific slice and DNN\", #68 \"not supported
SSC mode\" and #69 \"insufficient resources for specific slice\". For 5GSM
cause values other than #26 \"insufficient resources\", #28 \"unknown PDU
session type\", #39 \"reactivation requested\", #46 \"out of LADN service
area\", #54 \"PDU session does not exist\", #67 \"insufficient resources for
specific slice and DNN\", #68 \"not supported SSC mode\", and #69
\"insufficient resources for specific slice\", and #86 \"UAS services not
allowed\", the network may also include the re-attempt indicator to indicate
whether the UE is allowed to re-attempt the corresponding session management
procedure for the same DNN in S1 mode after inter-system change.
NOTE 1: In a PLMN, if the network includes this back-off timer value for 5GSM
cause values other than #27 \"missing or unknown DNN\", then the UE is blocked
from sending another 5GSM request for the same procedure for the same [PLMN,
DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no
DNN, no S-NSSAI] combination for the specified duration. If the network
includes this back-off timer value for 5GSM cause value #27 \"missing or
unknown DNN\", then the UE is blocked from sending another 5GSM request for
the same procedure for the same [PLMN, DNN], or [PLMN, no DNN] combination for
the specified duration. In an SNPN, if the network includes this back-off
timer value for 5GSM cause values other than #27 \"missing or unknown DNN\",
then the UE is blocked from sending another 5GSM request for the same
procedure for the same [SNPN, DNN, S-NSSAI], [SNPN, DNN, no S-NSSAI], [SNPN,
no DNN, S-NSSAI], or [SNPN, no DNN, no S-NSSAI] combination for the specified
duration if the UE does not support access to an SNPN using credentials from a
credentials holder, and the UE is blocked from sending another 5GSM request
for the same procedure for the same [SNPN, selected entry of the \"list of
subscriber data\" or selected PLMN subcription, DNN, S-NSSAI], [SNPN, selected
entry of the \"list of subscriber data\" or selected PLMN subcription, DNN, no
S-NSSAI], [SNPN, selected entry of the \"list of subscriber data\" or selected
PLMN subcription, no DNN, S-NSSAI], or [SNPN, selected entry of the \"list of
subscriber data\" or selected PLMN subcription, no DNN, no S-NSSAI]
combination for the specified duration if the UE supports access to an SNPN
using credentials from a credentials holder . If the network includes this
back-off timer value for 5GSM cause value #27 \"missing or unknown DNN\", then
the UE is blocked from sending another 5GSM request for the same procedure for
the same [SNPN, DNN], or [SNPN, no DNN] combination for the specified duration
if the UE does not support access to an SNPN using credentials from a
credentials holder, and the UE is blocked from sending another 5GSM request
for the same procedure for the same [SNPN, selected entry of the \"list of
subscriber data\" or selected PLMN subcription, DNN], or [SNPN, selected entry
of the \"list of subscriber data\" or selected PLMN subcription, no DNN]
combination for the specified duration if the UE supports access to an SNPN
using credentials from a credentials holder. Therefore, the operator needs to
exercise caution in determining the use of this timer value.
NOTE 2: If the re-attempt indicator is not provided by the network, a UE
registered in its HPLMN or in an EHPLMN can use the configured
SM_RetryAtRATChange value specified in the NAS configuration MO or in the USIM
NAS~CONFIG~ file to derive the re-attempt indicator as specified in subclauses
6.4.1.4.3 and 6.4.2.4.3.
If re-attempt in S1 mode is allowed for 5GSM cause values other than #27
\"missing or unknown DNN\", the UE shall consider the back-off timer to be
applicable only to the 5GS session management in N1 mode for the rejected 5GS
session management procedure and the given [PLMN, DNN, S-NSSAI], [PLMN, DNN,
no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no S-NSSAI]
combination. If re-attempt in S1 mode is allowed for 5GSM cause value #27
\"missing or unknown DNN\", the UE shall consider the back-off timer to be
applicable only to the 5GS session management in N1 mode for the rejected 5GS
session management procedure and the given [PLMN, DNN], or [PLMN, no DNN]
combination.If re-attempt in S1 mode is not allowed, the UE shall consider the
back-off timer to be applicable to both NAS protocols, i.e. applicable to the
5GS session management in N1 mode for the rejected 5GS session management
procedure and to the EPS session management in S1 mode for the corresponding
session management procedure and the given [PLMN, DNN] or [PLMN, no DNN]
combination.
NOTE 3: In the present subclause the terms DNN and APN are referring to the
same parameter.
In a PLMN, if the back-off timer was provided during the PDU session
establishment procedure, the UE behaves as follows: for 5GSM cause values
other than #27 \"missing or unknown DNN\", when the UE is registered in a
HPLMN, the DNN and the S-NSSAI of the [PLMN, DNN, S-NSSAI] combination
associated with the back-off timer is the DNN and the S-NSSAI provided by the
UE when the PDU session is established. When the UE is registered in a VPLMN,
the DNN and the S-NSSAI of the [PLMN, DNN, S-NSSAI] combination associated
with the back-off timer is the DNN and the mapped S-NSSAI provided by the UE
when the PDU session is established. For 5GSM cause value #27 \"missing or
unknown DNN\", the DNN of the [PLMN, DNN] combination associated with the
back-off timer is the DNN provided by the UE when the PDU session is
established. If no DNN or no S-NSSAI was provided to the network during the
PDU session establishment, then the back-off timer is associated with the
[PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], or [PLMN, no DNN, no
S-NSSAI] combination, dependent on which parameters were provided for 5GSM
cause values other than #27 \"missing or unknown DNN\". If no DNN was provided
to the network during the PDU session establishment, then the back-off timer
is associated with the [PLMN, no DNN] combination for 5GSM cause value #27
\"missing or unknown DNN\". For this purpose, the UE shall memorize the DNN
and the S-NSSAI provided to the network during the PDU session establishment.
In a PLMN, if the back-off timer was provided during the PDU session
modification procedure, the UE behaves as follows: the DNN associated with the
back-off timer is the DNN, including no DNN, provided by the UE when the PDU
session is established. If an S-NSSAI was provided by the UE during the PDU
session establishment, when the UE is registered in a HPLMN, then the S-NSSAI
associated with the back-off timer is the S-NSSAI of the PDU session. If an
S-NSSAI was provided by the UE during the PDU session establishment, when the
UE is registered in a VPLMN, then the S-NSSAI associated with the back-off
timer is the mapped S-NSSAI of the PDU session. If no S-NSSAI was provided by
the UE during the PDU session establishment, then the back-off timer is
associated with no S-NSSAI. For this purpose, the UE shall memorize the DNN
and the S-NSSAI provided to the network during the PDU session establishment.
In a PLMN, the back-off timer associated with the [PLMN, no DNN, no S-NSSAI],
or [PLMN, no DNN] combination will never be started due to any 5GSM procedure
related to an emergency PDU session. If the back-off timer associated with the
[PLMN, no DNN, no S-NSSAI], or [PLMN, no DNN] combination is running, it does
not affect the ability of the UE to request an emergency PDU session.
In an SNPN, the back-off timer associated with the [SNPN, no DNN, no S-NSSAI],
or [SNPN, no DNN] combination if the UE does not support access to an SNPN
using credentials from a credentials holder, or the back-off timer associated
with the [SNPN, selected entry of the \"list of subscriber data\" or selected
PLMN subscription, no DNN, no S-NSSAI], or [SNPN, selected entry of the \"list
of subscriber data\" or selected PLMN subscription, no DNN] combination if the
UE supports access to an SNPN using credentials from a credentials holder,
will never be started due to any 5GSM procedure related to an emergency PDU
session. If the back-off timer associated with the [SNPN, no DNN, no S-NSSAI],
or [SNPN, no DNN] combination if the UE does not support access to an SNPN
using credentials from a credentials holder, or the back-off timer associated
with the [SNPN, selected entry of the \"list of subscriber data\" or selected
PLMN subscription, no DNN, no S-NSSAI], or [SNPN, selected entry of the \"list
of subscriber data\" or selected PLMN subscription, no DNN] combination if the
UE supports access to an SNPN using credentials from a credentials holder is
running, it does not affect the ability of the UE to request an emergency PDU
session.
In a PLMN, the network may additionally indicate in the re-attempt indicator
that a command to back-off is applicable not only for the PLMN in which the UE
received the 5GS session management reject message, but for each PLMN included
in the equivalent PLMN list at the time when the 5GS session management reject
message was received.
In a PLMN, if the back-off timer is running or is deactivated for a given
[PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, S-NSSAI], [PLMN,
no DNN, no S-NSSAI] , [PLMN, DNN], or [PLMN, no DNN] combination, and the UE
is a UE configured for high priority access in selected PLMN, then the UE is
allowed to initiate 5GSM procedures for the [PLMN, DNN, S-NSSAI], [PLMN, DNN,
no S-NSSAI], [PLMN, no DNN, S-NSSAI], [PLMN, no DNN, no S-NSSAI] , [PLMN,
DNN], or [PLMN, no DNN] combination.
In an SNPN, if the back-off timer is running or is deactivated for a given
[SNPN, DNN, S-NSSAI], [SNPN, DNN, no S-NSSAI], [SNPN, no DNN, S-NSSAI], [SNPN,
no DNN, no S-NSSAI] , [SNPN, DNN], or [SNPN, no DNN] combination if the UE
does not support access to an SNPN using credentials from a credentials
holder, or the back-off timer is running or is deactivated for a given [SNPN,
selected entry of the \"list of subscriber data\" or selected PLMN
subcription, DNN, S-NSSAI], [SNPN, selected entry of the \"list of subscriber
data\" or selected PLMN subcription, DNN, no S-NSSAI], [SNPN, selected entry
of the \"list of subscriber data\" or selected PLMN subcription, no DNN,
S-NSSAI], [SNPN, selected entry of the \"list of subscriber data\" or selected
PLMN subcription, no DNN, no S-NSSAI] , [SNPN, selected entry of the \"list of
subscriber data\" or selected PLMN subcription, DNN], or [SNPN, selected entry
of the \"list of subscriber data\" or selected PLMN subcription, no DNN]
combination if the UE supports access to an SNPN using credentials from a
credentials holder, and the UE is a UE configured for high priority access in
selected SNPN, then the UE is allowed to initiate 5GSM procedures for the
[SNPN, DNN, S-NSSAI], [SNPN, DNN, no S-NSSAI], [SNPN, no DNN, S-NSSAI], [SNPN,
no DNN, no S-NSSAI] , [SNPN, DNN], or [SNPN, no DNN] combination if the UE
does not support access to an SNPN using credentials from a credentials
holder, or the UE is allowed to initiate 5GSM procedures for the [SNPN,
selected entry of the \"list of subscriber data\" or selected PLMN
subcription, DNN, S-NSSAI], [SNPN, selected entry of the \"list of subscriber
data\" or selected PLMN subcription, DNN, no S-NSSAI], [SNPN, selected entry
of the \"list of subscriber data\" or selected PLMN subcription, no DNN,
S-NSSAI], [SNPN, selected entry of the \"list of subscriber data\" or selected
PLMN subcription, no DNN, no S-NSSAI] , [SNPN, selected entry of the \"list of
subscriber data\" or selected PLMN subcription, DNN], or [SNPN, selected entry
of the \"list of subscriber data\" or selected PLMN subcription, no DNN]
combination if the UE supports access to an SNPN using credentials from a
credentials holder.
Neither the re-attempt indicator IE nor re-attempt indicator derivation shall
be applicable in an SNPN.
### 6.2.13 Handling of Small data rate control
Small data rate control is applicable only to NB-N1 mode and WB-N1 mode.
Small data rate control controls the maximum number of uplink user data
messages including uplink exception data reporting sent by the UE in a time
interval for the PDU session in accordance with 3GPP TS 23.501 [8]. The UE
shall limit the rate at which it generates uplink user data messages to comply
with the small data rate control policy. The NAS shall provide the indicated
rates to upper layers for enforcement. The indicated rates in a NAS procedure
applies to the PDU session the NAS procedure corresponds to, and the indicated
rates are valid until a new value is indicated or the PDU session is released.
If the UE indicates support for CIoT 5GS optimizations, the network may
provide the small data rate control parameters to the UE and may provide the
small data rate control parameters for exception data to the UE if and only if
the small data rate control parameters is provided to the UE. Small data rate
control parameters and small data rate control parameters for exception data
can also be provided to the UE in S1 mode as specified in 3GPP TS 24.301 [15].
If an allowed indication of additional exception reports is provided with the
small data rate control parameters and:
\- the additional small data rate control parameters for exception data is
provided and the limit for additional rate for exception data reporting is not
reached; or
\- the additional small data rate control parameters for exception data is not
provided,
the UE is allowed to send uplink exception reports even if the limit for the
small data rate control has been reached.
During a PDU session release procedure, if the small data rate control was
applied to the PDU session that is being released, the network may store the
small data rate control status for the released PDU session as specified in
3GPP TS 23.501 [8].
If:
a) the UE indicates support for CIoT 5GS optimizations; and
b) the small data rate control status was stored for the PDU session and is
still valid,
the network may provide the remaining small data rate control status as
initial small data rate control parameters to the UE and initial small data
rate control parameters for exception data to the UE during a subsequent PDU
session establishment procedure.
If received during the establishment of a PDU session, the UE shall apply the
initial small data rate control parameters and the initial small data rate
control parameters for exception data for the duration of the validity period.
When the validity period expires the small data rate control parameters and
the small data rate control parameters for exception data shall be applied
(see 3GPP TS 23.501 [8]).
NOTE 1: The HPLMN can discard or delay user data that exceeds the limit
provided for small data rate control.
Upon inter-system change from N1 mode to S1 mode, the UE shall store the
current small data rate control status for PDU sessions to be transferred from
N1 mode to S1 mode as specified in 3GPP TS 23.501 [8].
NOTE 2: How long the UE stores the current small data rate control status is
implementation specific.
Upon inter-system change from S1 mode to N1 mode, the UE shall use the stored
small data rate control status, if any, to comply with the small data rate
control policy for PDU sessions transferred from S1 mode to N1 mode as
specified in 3GPP TS 23.501 [8], if the validity period of the stored small
data rate control status has not expired.
### 6.2.14 Handling of Serving PLMN rate control
Serving PLMN rate control is applicable only for PDU sessions established for
control plane CIoT 5GS optimization.
Serving PLMN rate control protect its AMF from the load generated by user data
over control plane.
The SMF can inform the UE of any local serving PLMN rate control during the
PDU session establishment procedure (see subclause 6.4.1) or the PDU session
modification procedure (see subclause 6.4.2). If serving PLMN rate control is
enabled, the SMF shall start the serving PLMN rate control for the PDU session
when the first control plane user data is received over the PDU session.The UE
shall limit the rate at which it generates uplink control plane user data to
comply with the serving PLMN policy provided by the network. The indicated
rate in a NAS procedure applies to the PDU session the NAS procedure
corresponds to, and the indicated rate is valid until the PDU session is
released.
Any Serving PLMN rate control information provided by the network to the UE is
only applicable for the PLMN which provided this information. This serving
PLMN rate control information shall be discarded when the UE successfully
registers to another PLMN.
NOTE: The serving PLMN can discard or delay control plane user data that
exceed the limit provided for Serving PLMN rate control.
### 6.2.15 Handling of Reliable Data Service
If the UE supports Reliable Data Service (see 3GPP TS 23.501 [8] and 3GPP TS
24.250 [14A]), the UE may request data transfer using Reliable Data Service
for a PDU session in the Extended protocol configuration options IE during UE-
requested PDU session establishment procedure (see subclause 6.4.1).
The Reliable Data Service may only be used with PDU sessions for which the
\"Control Plane CIoT 5GS Optimisation\" indicator is set or with PDU sessions
using the control plane CIoT 5GS optimization when the AMF does not move such
PDU sessions to the user plane.
The network shall inform the UE about the acceptance of UE\'s request for
Reliable Data Service usage during the PDU session establishment procedure
(see subclause 6.4.1) in the Extended protocol configuration options IE.
If the network accepts the use of Reliable Data Service to transfer data for
the specified PDU session, the UE shall use this PDU session exclusively for
data transfer using Reliable Data Service; otherwise the UE shall not use this
PDU session for data transfer using Reliable Data Service.
### 6.2.16 Handling of header compression for control plane CIoT optimizations
The UE and the SMF may use:
\- IP header compression for PDU sessions of \"IPv4\", \"IPv6\" or \"IPv4v6\"
PDU session type; and
\- Ethernet header compression for PDU sessions of \"Ethernet\" PDU session
type.
Both the UE and the AMF indicate whether header compression for control plane
CIoT 5GS optimization is supported during registration procedures (see
subclause 5.5.1). If both the UE and the network support header compression,
the header compression configuration for each PDU session is negotiated during
the PDU session establishment procedure and PDU session modification procedure
as specified in subclauses 6.3.2, 6.4.1 and 6.4.2.
For IP header compression, ROHC protocol specified in IETF RFC 5795 [39B] is
used. The IP header compression configuration used for IP header compression
is (re-)negotiated between the UE and the SMF using the IP header compression
configuration IE as specified in subclauses 6.3.2.2, 6.4.1.2, 6.4.1.3 and
6.4.2.2, respectively.
For Ethernet header compression, Ethernet Header Compression (EHC) protocol
specified in 3GPP TS 38.323 [29] is used. The Ethernet header compression
configuration used for Ethernet header compression is (re-)negotiated between
the UE and the SMF using the Ethernet header compression configuration IE as
specified in subclauses 6.3.2.2, 6.4.1.2, 6.4.1.3 and 6.4.2.2, respectively.
### 6.2.17 Handling of edge computing enhancements
EAS discovery, EAS rediscovery and ECS address provisioning provide enhanced
edge computing support in 5GS (see 3GPP TS 23.548 [10A]).
If the network supports the session breakout connectivity model or distributed
anchor connectivity model to enable edge computing enhancements and the UE
generated DNS message is to be handled by an edge application server discovery
function (EASDF) for EAS discovery as specified in 3GPP TS 23.548 [10A], the
SMF selects the EASDF and it provides its IP address to the UE as the DNS
server to be used for the PDU session in the Extended protocol configuration
options IE during the UE-requested PDU session establishment procedure as
described in subclause 6.4.1.3.
NOTE 1: EASDF selection is outside the scope of the present document.
If the network supports the session breakout connectivity model to enable edge
computing enhancements and the UE generated DNS message is to be handled by a
local DNS server for EAS discovery as specified in 3GPP TS 23.548 [10A], the
SMF selects the local DNS server, obtains its IP address and can provide the
IP address of the local DNS server to the UE as the DNS server to be used for
the PDU session in the Extended protocol configuration options IE during the
UE-requested PDU session establishment procedure or the network-requested PDU
session modification procedure as described in subclauses 6.4.1.3 and 6.3.2.2,
respectively.
NOTE 2: Local DNS server selection and the acquisition of its IP address is
outside the scope of the present document.
If the UE supports EAS rediscovery and the SMF decides to trigger the EAS
rediscovery as specified in 3GPP TS 23.548 [10A], the SMF initiates a network-
requested PDU session modification procedure to provide the EAS rediscovery
information to the UE as described in subclauses 6.3.2.2. Upon receipt of the
EAS rediscovery information, the UE provides the received information to the
upper layers.
NOTE 3: The upper layers of the UE uses the EAS rediscovery information to
trigger the EAS discovery procedure to get the new EAS information as
specified in 3GPP TS 23.548 [10A].
If the UE supports ECS address provisioning over NAS as specified in 3GPP TS
23.548 [10A], the UE indicates its support of ECS configuration information
provisioning over NAS in the Extended protocol configuration options IE either
during the UE-requested PDU session establishment procedure as described in
subclause 6.4.1.2 or while in S1 mode as described in 3GPP TS 24.301 [15],
respectively.
If the UE indicated support of ECS configuration information address
provisioning over NAS, the SMF can provide the ECS configuration information
in the Extended protocol configuration options IE during the network-requested
PDU session modification procedure, UE-requested PDU session establishment
procedure or the UE-requested PDU session modification procedure as described
in subclauses 6.3.2.2, 6.4.1.3 and 6.4.2.3, respectively.
NOTE 4: The SMF can obtain the ECS configuration information based on the
local configuration, the UE\'s location, and/or UE\'s subscription
information.
If the UE supports the edge DNS client (EDC) as specified in 3GPP TS 23.548
[10A], the UE indicates its support of EDC in the Extended protocol
configuration options IE during the UE-requested PDU session establishment
procedure as described in subclause 6.4.1.2 or the UE-requested PDU session
modification procedure as described in subclause 6.4.2.2.
If the UE indicates support of EDC, the SMF can indicate in the Extended
protocol configuration options IE during the UE-requested PDU session
establishment procedure as described in subclause 6.4.1.3 or the network-
requested PDU session modification procedure as described in subclause
6.3.2.2, that the network allows the use of EDC for the applications which are
mapped onto the PDU session and explicitly requested the use of EDC, or that
the network requires the use of EDC for all applications mapped onto the PDU
session.
### 6.2.18 Support of redundant PDU sessions
The 5GSM sublayer may support establishment of redundant PDU sessions (see
clause 5.33.2 of 3GPP TS 23.501 [8]).
In order to establish a set of two redundant PDU sessions, a UE can include a
PDU session pair ID, an RSN, or both in a PDU SESSION ESTABLISHMENT REQUEST
message for each of the two redundant PDU sessions (see subclause 6.4.1.2).
The UE can set the PDU session pair ID, the RSN, or both according to URSP or
UE local configuration (see 3GPP TS 24.526 [19]).
An SMF receiving a PDU session pair ID, an RSN, or both via a PDU SESSION
ESTABLISHMENT REQUEST message operates as specified in clause 5.33.2 of 3GPP
TS 23.501 [8]. In addition, an SMF can handle two PDU sessions as redundant
even if the UE provides neither a PDU session pair ID nor an RSN in a PDU
SESSION ESTABLISHMENT REQUEST message for each of the PDU sessions (see clause
5.33.2 of 3GPP TS 23.501 [8]).
## 6.3 Network-requested 5GSM procedures
### 6.3.1 PDU session authentication and authorization procedure
#### 6.3.1.1 General
The purpose of the PDU session authentication and authorization procedure is
to enable the DN:
a) to authenticate the upper layers of the UE, when establishing the PDU
session;
b) to authorize the upper layers of the UE, when establishing the PDU session;
c) both of the above; or
d) to re-authenticate the upper layers of the UE after establishment of the
PDU session.
The PDU session authentication and authorization procedure can be performed
only during or after the UE-requested PDU session procedure establishing a
non-emergency PDU session. The PDU session authentication and authorization
procedure shall not be performed during or after the UE-requested PDU session
establishment procedure establishing an emergency PDU session.
The upper layers store the association between a DNN and corresponding
credentials, if any, for the PDU session authentication and authorization.
If the UE is registered for onboarding services in SNPN the SMF may initiate
the PDU session authentication and authorization procedure based on local
policy with a DCS as specified in 3GPP TS 33.501 [24] clause I.9.2.4.1 or a
DNâ€‘AAA server as specified in 3GPP TS 33.501 [24] clause I.9.2.4.2.
If the UE is registered for onboarding services in SNPN and the network
initiates the PDU session authentication and authorization procedure, the UE
shall use the default UE credentials for secondary authentication for the PDU
session authentication and authorization procedure.
The network authenticates the UE using the Extensible Authentication Protocol
(EAP) as specified in IETF RFC 3748 [34].
EAP has defined four types of EAP messages:
a) an EAP-request message;
b) an EAP-response message;
c) an EAP-success message; and
d) an EAP-failure message.
The EAP-request message is transported from the network to the UE using the
PDU SESSION AUTHENTICATION COMMAND message of the PDU EAP message reliable
transport procedure.
The EAP-response message to the EAP-request message is transported from the UE
to the network using the PDU SESSION AUTHENTICATION COMPLETE message of the
PDU EAP message reliable transport procedure.
If the PDU session authentication and authorization procedure is performed
during the UE-requested PDU session establishment procedure:
a) and the DN authentication of the UE completes successfully, the EAP-success
message is transported from the network to the UE as part of the UE-requested
PDU session establishment procedure in the PDU SESSION ESTABLISHMENT ACCEPT
message.
b) and the DN authentication of the UE completes unsuccessfully, the EAP-
failure message is transported from the network to the UE as part of the UE-
requested PDU session establishment procedure in the PDU SESSION ESTABLISHMENT
REJECT message.
If the PDU session authentication and authorization procedure is performed
after the UE-requested PDU session establishment procedure:
a) and the DN authentication of the UE completes successfully, the EAP-success
message is transported from the network to the UE using the PDU SESSION
AUTHENTICATION RESULT message of the PDU EAP result message transport
procedure.
b) and the DN authentication of the UE completes unsuccessfully, the EAP-
failure message is transported from the network to the UE using the PDU
SESSION RELEASE COMMAND message of the network-requested PDU session release
procedure.
There can be several rounds of exchange of an EAP-request message and a
related EAP-response message for the DN to complete the authentication and
authorization of the request for a PDU session (see example in figure
6.3.1.1).
The SMF shall set the authenticator retransmission timer specified in IETF RFC
3748 [34] subclause 4.3 to infinite value.
NOTE: The PDU session authentication and authorization procedure provides a
reliable transport of EAP messages and therefore retransmissions at the EAP
layer of the SMF do not occur.
Figure 6.3.1.1: PDU session authentication and authorization procedure
#### 6.3.1.2 PDU EAP message reliable transport procedure
##### 6.3.1.2.1 PDU EAP message reliable transport procedure initiation
In order to initiate the PDU EAP message reliable transport procedure, the SMF
shall create a PDU SESSION AUTHENTICATION COMMAND message.
The SMF shall set the PTI IE of the PDU SESSION AUTHENTICATION COMMAND message
to \"No procedure transaction identity assigned\".
The SMF shall set the EAP message IE of the PDU SESSION AUTHENTICATION COMMAND
message to the EAP-request message provided by the DN or generated locally.
The SMF shall send the PDU SESSION AUTHENTICATION COMMAND message, and the SMF
shall start timer T3590 (see example in figure 6.3.1.1).
Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message, if the UE
provided a DNN during the PDU session establishment, the UE shall stop timer
T3396, if it is running for the DNN provided by the UE. If the UE did not
provide a DNN during the PDU session establishment, the UE shall stop the
timer T3396 associated with no DNN if it is running.
Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message, if the UE
provided an S-NSSAI and a DNN during the PDU session establishment, the UE
shall stop timer T3584, if it is running for the [S-NSSAI of the PDU session,
DNN] combination. If the UE provided a DNN but did not provide an S-NSSAI
during the PDU session establishment, the UE shall stop timer T3584, if it is
running for the same [no S-NSSAI, DNN] combination provided by the UE. If the
UE provided an S-NSSAI but did not provide a DNN during the PDU session
establishment, the UE shall stop timer T3584, if it is running for the same
[S-NSSAI, no DNN] combination provided by the UE. If the UE provided neither a
DNN nor an S-NSSAI during the PDU session establishment, the UE shall stop
timer T3584, if it is running for the same [no S-NSSAI, no DNN] combination
provided by the UE. The timer T3584 to be stopped includes the timer T3584
applied for all the PLMNs, if running, and the timer T3584 applied for the
registered PLMN, if running.
Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message, if the UE
provided an S-NSSAI during the PDU session establishment, the UE shall stop
timer T3585, if it is running for the S-NSSAI of the PDU session. If the UE
did not provide an S-NSSAI during the PDU session establishment, the UE shall
stop the timer T3585 associated with no S-NSSAI if it is running. The timer
T3585 to be stopped includes the timer T3585 applied for all the PLMNs, if
running, and the timer T3585 applied for the registered PLMN, if running.
NOTE 1: Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message for a
PDU session, if the UE provided a DNN (or no DNN) and an S-NSSAI (or no
S-NSSAI) when the PDU session is established, timer T3396 associated with the
DNN (or no DNN, if no DNN was provided by the UE) is running, and timer T3584
associated with the DNN (or no DNN, if no DNN was provided by the UE) and the
S-NSSAI (or no S-NSSAI, if no S-NSSAI was provided by the UE) is running, then
the UE stops both the timer T3396 and the timer T3584.
NOTE 2: Upon receipt of the PDU SESSION AUTHENTICATION COMMAND message for a
PDU session, if the UE provided a DNN (or no DNN) and an S-NSSAI (or no
S-NSSAI) when the PDU session is established, timer T3585 associated with the
S-NSSAI (or no S-NSSAI, if no S-NSSAI was provided by the UE) is running, and
timer T3584 associated with the DNN (or no DNN, if no DNN was provided by the
UE) and the S-NSSAI (or no S-NSSAI, if no S-NSSAI was provided by the UE) is
running, then the UE stops both the timer T3585 and the timer T3584.
Upon receipt of a PDU SESSION AUTHENTICATION COMMAND message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE
passes to the upper layers the EAP message received in the EAP message IE of
the PDU SESSION AUTHENTICATION COMMAND message. Apart from this action and the
stopping of timers T3396, T3584 and T3485 (if running), the authentication and
authorization procedure initiated by the DN is transparent to the 5GSM layer
of the UE.
##### 6.3.1.2.2 PDU EAP message reliable transport procedure accepted by the
UE
> The UE shall create a PDU SESSION AUTHENTICATION COMPLETE message when the
> upper layers provide an EAP-response message responding to the received EAP-
> request message.
The UE shall set the EAP message IE of the PDU SESSION AUTHENTICATION COMPLETE
message to the EAP-response message.
The UE shall transport the PDU SESSION AUTHENTICATION COMPLETE message and the
PDU session ID, using the NAS transport procedure as specified in subclause
5.4.5. Apart from this action, the authentication and authorization procedure
initiated by the DN is transparent to the 5GSM layer of the UE.
Upon receipt of a PDU SESSION AUTHENTICATION COMPLETE message, the SMF shall
stop timer T3590 and provides the EAP message received in the EAP message IE
of the PDU SESSION AUTHENTICATION COMPLETE message to the DN or handles it
locally.
##### 6.3.1.2.3 Abnormal cases on the network side
The following abnormal cases can be identified:
a) T3590 expired.
The SMF shall, on the first expiry of the timer T3590, retransmit the PDU
SESSION AUTHENTICATION COMMAND message and shall reset and start timer T3590.
This retransmission is repeated four times, i.e. on the fifth expiry of timer
T3590, the SMF shall abort the procedure.
b) Collision of UE-requested PDU session release procedure and a PDU session
authentication and authorization procedure.
When the SMF receives a PDU SESSION RELEASE REQUEST message during the PDU
session authentication and authorization procedure, and the PDU session
indicated in the PDU SESSION RELEASE REQUEST message is the PDU session that
the SMF had requested to authenticate, the SMF shall abort the PDU session
authentication and authorization procedure and proceed with the UE-requested
PDU session release procedure.
##### 6.3.1.2.4 Abnormal cases in the UE
The following abnormal cases can be identified:
a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION AUTHENTICATION COMMAND message
belongs to any PDU session in state PDU SESSION INACTIVE in the UE, the UE
shall send a 5GSM STATUS message with the 5GSM cause IE set to #43 \"Invalid
PDU session identity\".
b) Collision of UE-requested PDU session release procedure and a PDU session
authentication and authorization procedure.
When the UE receives a PDU SESSION AUTHENTICATION COMMAND message during the
UE-requested PDU session release procedure, and the PDU session indicated in
PDU SESSION AUTHENTICATION COMMAND message is the PDU session that the UE had
requested to release, the UE shall ignore the PDU SESSION AUTHENTICATION
COMMAND message and proceed with the UE-requested PDU session release
procedure.
#### 6.3.1.3 PDU EAP result message transport procedure
##### 6.3.1.3.1 PDU EAP result message transport procedure initiation
PDU EAP result message transport procedure is initiated by the SMF if the PDU
session authentication and authorization procedure is performed after the PDU
session is established and the DN authentication of the UE completes
successfully.
In order to initiate the PDU EAP result message transport procedure, the SMF
shall create a PDU SESSION AUTHENTICATION RESULT message.
The SMF shall set the PTI IE of the PDU SESSION AUTHENTICATION RESULT message
to \"No procedure transaction identity assigned\".
The SMF shall set the EAP message IE of the PDU SESSION AUTHENTICATION RESULT
message to the EAP-success message provided by the DN.
The SMF shall send the PDU SESSION AUTHENTICATION RESULT message.
Upon receipt of a PDU SESSION AUTHENTICATION RESULT message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE
passes to the upper layers the EAP message received in the EAP message IE of
the PDU SESSION AUTHENTICATION RESULT message. Apart from this action, the
authentication and authorization procedure initiated by the DN is transparent
to the 5GSM layer of the UE.
##### 6.3.1.3.2 Abnormal cases in the UE
The following abnormal cases can be identified:
a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION AUTHENTICATION RESULT message belongs
to any PDU session in state PDU SESSION INACTIVE in the UE, the UE shall send
a 5GSM STATUS message with the 5GSM cause IE set to #43 \"Invalid PDU session
identity\".
b) Collision of UE-requested PDU session release procedure and a PDU EAP
result message transport procedure.
When the UE receives a PDU SESSION AUTHENTICATION RESULT message during the
UE-requested PDU session release procedure, and the PDU session indicated in
PDU SESSION AUTHENTICATION RESULT message is the PDU session that the UE had
requested to release, the UE shall ignore the PDU SESSION AUTHENTICATION
RESULT message and proceed with the UE-requested PDU session release
procedure.
### 6.3.1A Service-level authentication and authorization procedure
#### 6.3.1A.1 General
The purpose of the service-level authentication and authorization (service-
level-AA) procedure is to enable the DN using NEF services for authentication:
a) to authenticate the upper layers of the UE, when establishing the PDU
session;
b) to authorize the upper layers of the UE, when establishing the PDU session;
c) both of the above; or
d) to re-authenticate the upper layers of the UE after establishment of the
PDU session.
The service-level authentication and authorization procedure is used for UUAA
as specified in TS 23.256 [6AB].
NOTE 1: The authentication protocol for UUAA is out of scope of 3GPP in this
release of specification.
The service-level authentication and authorization procedure can be performed
only during or after the UE-requested PDU session procedure establishing a
non-emergency PDU session. The service-level authentication and authorization
procedure shall not be performed during or after the UE-requested PDU session
establishment procedure establishing an emergency PDU session.
If the service-level authentication and authorization procedure is performed
during the UE-requested PDU session establishment procedure:
a) and the service-level-AA procedure of the UE completes successfully, the
service-level-AA response is transported from the network to the UE as a part
of the UE-requested PDU session establishment procedure in the PDU SESSION
ESTABLISHMENT ACCEPT message; or
b) and the service-level-AA procedure of the UE completes unsuccessfully, the
service-level-AA response is transported from the network to the UE as a part
of the UE-requested PDU session establishment procedure in the PDU SESSION
ESTABLISHMENT REJECT message.
NOTE 2: If the SMF receives the HTTP code set to \"4xx\" or \"5xx\" as
specified in 3GPP TS 29.500 [20AA] or the SMF detects a UUAA-SM failure as
specified in 3GPP TS 29.256 [21B], then the SMF considers that the UUAA-SM
procedure has completed unsuccessfully.
If the service-level authentication and authorization procedure is performed
for the established PDU session with re-authentication purpose:
a) and the service-level-AA procedure of the UE completes successfully, the
service-level-AA response is transported from the network to the UE as a part
of the network-requested PDU session modification procedure in the PDU SESSION
MODIFICATION COMMAND message; or
b) and the service-level-AA procedure of the UE completes unsuccessfully, the
service-level-AA response is transported from the network to the UE as a part
of the network-requested PDU session release procedure in the PDU SESSION
RELEASE COMMAND message.
There can be several rounds of exchange of a service-level-AA payload for the
service to complete the service-level authentication and authorization of the
request for a PDU session (see example in figure 6.3.1A.1-1).
If the UE receives the service-level-AA response in the PDU SESSION
ESTABLISHMENT ACCEPT message or the PDU SESSION ESTABLISHMENT REJECT message,
the UE passes it to the upper layer.
Figure 6.3.1A.1-1: Service-level authentication and authorization procedure
#### 6.3.1A.2 Service-level authentication and authorization procedure
initiation
In order to initiate the service-level authentication and authorization
procedure, the SMF shall create a SERVICE-LEVEL AUTHENTICATION COMMAND
message.
The SMF shall set the PTI IE of the SERVICE-LEVEL AUTHENTICATION COMMAND
message to \"No procedure transaction identity assigned\".
The SMF shall set the service-level-AA payload in the Service-level-AA
container IE of the SERVICE-LEVEL AUTHENTICATION COMMAND message to the
payload provided by the DN via the NEF. If a payload type associated with the
payload is provided by the DN via the NEF, the SMF shall set the service-
level-AA payload type with the value set to the payload type.
NOTE: In case of UUAA, the service-level-AA payload is provided by the DN via
the UAS-NF.
The SMF shall send the SERVICE-LEVEL AUTHENTICATION COMMAND message, and the
SMF shall start timer T3594 (see example in figure 6.3.1A.1-1).
Upon receipt of a SERVICE-LEVEL AUTHENTICATION COMMAND message and a PDU
session ID, using the NAS transport procedure as specified in subclause 5.4.5,
the UE passes to the upper layers the service-level-AA payload received in the
Service-level-AA container IE of the SERVICE-LEVEL AUTHENTICATION COMMAND
message. Apart from this action, the service-level authentication and
authorization procedure initiated by the DN is transparent to the 5GSM layer
of the UE.
#### 6.3.1A.3 Service-level authentication and authorization procedure
accepted by the UE
When the upper layers provide a service-level-AA payload, the UE shall create
a SERVICE-LEVEL AUTHENTICATION COMPLETE message and set the service-level-AA
payload of the Service-level-AA container IE to the service-level-AA payload
received from the upper layers, and if the service-level-AA payload type is
received in the SERVICE-LEVEL AUTHENTICATION COMMAND message from the SMF, set
the service-level-AA payload type of the Service-level-AA container IE to the
service-level-AA payload type received from the SMF.
The UE shall transport the SERVICE-LEVEL AUTHENTICATION COMPLETE message and
the PDU session ID, using the NAS transport procedure as specified in
subclause 5.4.5. Apart from this action, the service-level authentication and
authorization procedure initiated by the DN is transparent to the 5GSM layer
of the UE.
Upon receipt of a SERVICE-LEVEL AUTHENTICATION COMPLETE message, the SMF shall
stop timer T3594 and provides the service-level-AA payload received in the
Service-level-AA container IE of the SERVICE-LEVEL AUTHENTICATION COMPLETE
message to the DN.
#### 6.3.1A.4 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Expiry of timer T3594.
On the first expiry of the timer T3594, the SMF shall resend the SERVICE-LEVEL
AUTHENTICATION COMMAND message and shall reset and restart timer T3594. This
retransmission is repeated four times, i.e., on the fifth expiry of timer
T3594, the SMF shall abort the procedure and send PDU SESSION ESTABLISHMENT
REJECT message with the 5GSM cause #29 \"user authentication or authorization
failed\" as specified in subclause 6.4.1.4.1.
#### 6.3.1A.5 Abnormal cases in the UE
The following abnormal case can be identified:
a) Collision of UE-requested PDU session release procedure and a service-level
authentication and authorization procedure.
When the UE receives a SERVICE-LEVEL AUTHENTICATION COMMAND message during the
UE-requested PDU session release procedure, and the PDU session indicated in
SERVICE-LEVEL AUTHENTICATION COMMAND message is the PDU session that the UE
has requested to release, the UE shall ignore the SERVICE-LEVEL AUTHENTICATION
COMMAND message and proceed with the UE-requested PDU session release
procedure.
### 6.3.2 Network-requested PDU session modification procedure
#### 6.3.2.1 General
The purpose of the network-requested PDU session modification procedure is to
enable the network to modify a PDU session, re-negotiate header compression
configuration associated to a PDU session, convey a port management
information container, to trigger EAS rediscovery, provide updated DNS server
address(es) due to the newly selected local DNS server or the newly selected
EASDF, provide updated ECS configuration information, remove joined UE from
one or more multicast MBS sessions associated with a PDU session, update ATSSS
parameters (e.g. ATSSS rules), update the MBS service area or the security
information of multicast MBS session that the UE has joined or to inform about
the result of service-level AA procedure or C2 authorization for UAS services.
#### 6.3.2.2 Network-requested PDU session modification procedure initiation
In order to initiate the network-requested PDU session modification procedure,
the SMF shall create a PDU SESSION MODIFICATION COMMAND message.
If the authorized QoS rules of the PDU session is modified or is marked as to
be synchronised with the UE, the SMF shall set the Authorized QoS rules IE of
the PDU SESSION MODIFICATION COMMAND message to the authorized QoS rules of
the PDU session. The SMF shall ensure that the number of the packet filters
used in the authorized QoS rules of the PDU Session does not exceed the
maximum number of packet filters supported by the UE for the PDU session. The
SMF may bind service data flows for which the UE has requested traffic
segregation to a dedicated QoS flow for the PDU session, if possible.
Otherwise the SMF may bind the service data flows to an existing QoS flow. The
SMF shall use only one dedicated QoS flow for traffic segregation. If the UE
has requested traffic segregation for multiple service data flows with
different QoS handling, the SMF shall bind all these service data flows to a
single QoS flow. If the SMF allows traffic segregation for service data flows
in a QoS rule, then the SMF shall create a new authorized QoS rule for these
service data flows and shall delete packet filters corresponding to these
service data flows from the other authorized QoS rules.
If the authorized QoS flow descriptions of the PDU session is modified or is
marked as to be synchronised with the UE, the SMF shall set the Authorized QoS
flow descriptions IE of the PDU SESSION MODIFICATION COMMAND message to the
authorized QoS flow descriptions of the PDU session.
If SMF creates a new authorized QoS rule for a new QoS flow, then SMF shall
include the authorized QoS flow description for that QoS flow in the
Authorized QoS flow descriptions IE of the PDU SESSION MODIFICATION COMMAND
message, if:
a) the newly created authorized QoS rules is for a new GBR QoS flow;
b) the QFI of the new QoS flow is not the same as the 5QI of the QoS flow
identified by the QFI;
c) the new QoS flow can be mapped to an EPS bearer as specified in subclause
4.11.1 of 3GPP TS 23.502 [9]; or
d) the new QoS flow is established for the PDU session used for relaying, as
specified in subclause 5.6.2.1 of 3GPP TS 23.304 [6E].
NOTE 0: In cases other than above listed cases, it is up to the SMF
implementation to include the authorized QoS flow description of the new QoS
flow for the new authorized QoS rule in the Authorized QoS flow descriptions
IE of the PDU SESSION MODIFICATION COMMAND message.
If the session-AMBR of the PDU session is modified, the SMF shall set the
selected Session-AMBR IE of the PDU SESSION MODIFICATION COMMAND message to
the session-AMBR of the PDU session.
If interworking with EPS is supported for the PDU session and if the mapped
EPS bearer contexts of the PDU session is modified, the SMF shall set the
Mapped EPS bearer contexts IE of the PDU SESSION MODIFICATION COMMAND message
to the mapped EPS bearer contexts of the PDU session. If the association
between a QoS flow and the mapped EPS bearer context is changed, the SMF shall
set the EPS bearer identity parameter in Authorized QoS flow descriptions IE
of the PDU SESSION MODIFICATION COMMAND message to the new EPS bearer identity
associated with the QoS flow.
If the network-requested PDU session modification procedure is triggered by a
UE-requested PDU session modification procedure and the PDU SESSION
MODIFICATION REQUEST message includes a 5GSM capability IE, the SMF shall:
a) if the RQoS bit is set to:
1) \"Reflective QoS supported\", consider that the UE supports reflective QoS
for this PDU session; or
2) \"Reflective QoS not supported\", consider that the UE does not support
reflective QoS for this PDU session; and;
b) if the MH6-PDU bit is set to:
1) \"Multi-homed IPv6 PDU session supported\", consider that this PDU session
is supported to use multiple IPv6 prefixes; or
2) \"Multi-homed IPv6 PDU session not supported\", consider that this PDU
session is not supported to use multiple IPv6 prefixes.
If the SMF considers that reflective QoS is supported for QoS flows belonging
to this PDU session, the SMF may include the RQ timer IE set to an RQ timer
value in the PDU SESSION MODIFICATION COMMAND message.
If a port management information container needs to be delivered (see 3GPP TS
23.501 [8] and 3GPP TS 23.502 [9]) and the UE has set the TPMIC bit to
\"Transport of port management information container supported\" in the 5GSM
capability IE, the SMF shall include a Port management information container
IE in the PDU SESSION MODIFICATION COMMAND message.
For a PDN connection established when in S1 mode, upon the first inter-system
change from S1 mode to N1 mode, if the network-requested PDU session
modification procedure is triggered by a UE-requested PDU session modification
procedure, the PDU session type is \"IPv4\", \"IPv6\", \"IPv4v6\" or
\"Ethernet\" and the PDU SESSION MODIFICATION REQUEST message includes a
Maximum number of supported packet filters IE, the SMF shall consider this
number as the maximum number of packet filters that can be supported by the UE
for this PDU session. Otherwise the SMF considers that the UE supports 16
packet filters for this PDU session.
For a PDN connection established when in S1 mode, upon the first inter-system
change from S1 mode to N1 mode, if the network-requested PDU session
modification procedure is triggered by a UE-requested PDU session modification
procedure, the SMF shall consider that the maximum data rate per UE for user-
plane integrity protection supported by the UE for uplink and the maximum data
rate per UE for user-plane integrity protection supported by the UE for
downlink are valid for the lifetime of the PDU session.
For a PDN connection established when in S1 mode, upon the first inter-system
change from S1 mode to N1 mode, if the network-requested PDU session
modification procedure is triggered by a UE-requested PDU session modification
procedure and the SMF determines, based on local policies or configurations in
the SMF and the Always-on PDU session requested IE in the PDU SESSION
MODIFICATION REQUEST message (if available), that either:
a) the requested PDU session needs to be an always-on PDU session, the SMF
shall include the Always-on PDU session indication IE in the PDU SESSION
MODIFICATION COMMAND message and shall set the value to \"Always-on PDU
session required\"; or
b) the requested PDU session shall not be an always-on PDU session and:
1) if the UE included the Always-on PDU session requested IE, the SMF shall
include the Always-on PDU session indication IE in the PDU SESSION
MODIFICATION COMMAND message and shall set the value to \"Always-on PDU
session not allowed\"; or
2) if the UE did not include the Always-on PDU session requested IE, the SMF
shall not include the Always-on PDU session indication IE in the PDU SESSION
MODIFICATION COMMAND message.
For a PDN connection established when in S1 mode, upon the first inter-system
change from S1 mode to N1 mode, if the network-requested PDU session
modification procedure is triggered by a UE-requested PDU session modification
procedure, the UE supports EDC and the network allows the use of EDC, then the
SMF shall include the Extended protocol configuration options IE in the PDU
SESSION MODIFICATION COMMAND message with the EDC usage allowed indicator.
For a PDN connection established when in S1 mode, upon the first inter-system
change from S1 mode to N1 mode, if the network-requested PDU session
modification procedure is triggered by a UE-requested PDU session modification
procedure, the UE supports EDC and the network requires the use of EDC, then
the SMF shall include the Extended protocol configuration options IE in the
PDU SESSION MODIFICATION COMMAND message with the EDC usage required
indicator.
If a QoS flow for URLLC is created in a PDU session and the SMF has not
provided the Always-on PDU session indication IE with the value set to
\"Always-on PDU session required\" in the UE-requested PDU session
establishment procedure or a network-requested PDU session modification
procedure for the PDU session, the SMF shall include the Always-on PDU session
indication IE in the PDU SESSION MODIFICATION COMMAND message and shall set
the value to \"Always-on PDU session required\".
If the value of the RQ timer is set to \"deactivated\" or has a value of zero,
the UE considers that RQoS is not applied for this PDU session and remove the
derived QoS rule(s) associated with the PDU session, if any.
If the network-requested PDU session modification procedure is triggered by a
UE-requested PDU session modification procedure, the SMF shall set the PTI IE
of the PDU SESSION MODIFICATION COMMAND message to the PTI of the PDU SESSION
MODIFICATION REQUEST message received as part of the UE-requested PDU session
modification procedure.
If the network-requested PDU session modification procedure is triggered by a
UE-requested PDU session modification procedure and the UE has included the
Requested MBS container IE in the PDU SESSION MODIFICATION REQUEST message
with the MBS operation set to \"Join multicast MBS session\", the SMF:
a) shall include the TMGI for the multicast MBS session IDs that the UE is
allowed to join, if any, in the Received MBS container IE, shall set the MBS
decision to \"MBS join is accepted\" for each of those Received MBS
information, may include the MBS start time to indicate the time when the
multicast MBS session starts, and shall include the MBS security container in
each of those Received MBS information if security protection is applied for
that multicast MBS session and the control plane security procedure is used as
specified in annex W.4.1.2 in 3GPP TS 33.501 [24], and shall use separate QoS
flows dedicated for multicast by including the Authorized QoS flow
descriptions IE if no separate QoS flows dedicated for multicast exist or if
the SMF wants to establish new QoS flows dedicated for multicast;
NOTE 1: The network determines whether security protection applies or not for
the multicast MBS session as specified in 3GPP TS 33.501 [24].
b) shall include the TMGI for multicast MBS session IDs that the UE is
rejected to join, if any, in the Received MBS container IE, shall set the MBS
decision to \"MBS join is rejected\" for each of those Received MBS
information, shall set the Rejection cause for each of those Received MBS
information with the reason of rejection and, if the Rejection cause is set to
\"multicast MBS session has not started or will not start soon\", may include
an MBS back-off timer value; and
c) may include in the Received MBS container IE the MBS service area for each
multicast MBS session and include in it the MBS TAI list, the NR CGI list or
both, that identify the service area(s) for the local MBS service;
NOTE 2: For an multicast MBS session that has multiple MBS service areas, the
MBS service areas are indicated to the UE using MBS service announcement as
described in 3GPP TS 23.247 [53], which is out of scope of this specification.
in the PDU SESSION MODIFICATION COMMAND message. If the UE has set the Type of
multicast MBS session ID to \"Source specific IP multicast address\" in the
Requested MBS container IE for certain multicast MBS session(s) in the PDU
SESSION MODIFICATION REQUEST message, the SMF shall include the Source IP
address information and Destination IP address information in the Received MBS
information together with the TMGI for each of those multicast MBS sessions.
NOTE 3: Including the Source IP address information and Destination IP address
information in the Received MBS information in that case is to allow the UE to
perform the mapping between the requested multicast MBS session ID and the
provided TMGI.
NOTE 4: In SNPN, TMGI is used together with NID to identify an MBS Session.
If:
a) the SMF wants to remove joined UE from one or more multicast MBS sessions;
or
b) the network-requested PDU session modification procedure is triggered by a
UE-requested PDU session modification procedure and the UE has included the
Requested MBS container IE in the PDU SESSION MODIFICATION REQUEST message
with the MBS operation set to \"Leave multicast MBS session\",
the SMF shall include the multicast MBS session IDs that the UE is removed
from, if any, in the Received MBS container IE in the PDU SESSION MODIFICATION
COMMAND message and shall set the MBS decision to \"Remove UE from multicast
MBS session\" for each of those Received MBS information. The SMF may include
the updated MBS service area in each of the Received MBS information, if any.
The SMF may delete the QoS flows associated for the multicast by including the
Authorized QoS flow descriptions IE in the PDU SESSION MODIFICATION COMMAND
message. If the UE is removed from multicast MBS session due to the multicast
MBS session release, the SMF shall set the Rejection cause to \"MBS session is
released\". The SMF shall include the Rejection cause for each of the Received
MBS information, if any, and set its value with the reason of removing the UE
from the corresponding multicast MBS session.
NOTE 5: based on operator\'s policy, e.g. after a locally configured time
period, the SMF is allowed to trigger the removal of joined UE from a
multicast MBS session when the UE moves outside all the MBS service area(s) of
that multicast MBS session.
If the SMF wants to update the MBS security information of an multicast MBS
session that the UE has joined, the SMF shall include the corresponding
multicast MBS session ID and the MBS security container in the Received MBS
container IE in the PDU SESSION MODIFICATION COMMAND message, and shall set
the MBS Decision to \"MBS security information update\" in the Received MBS
information.
If the SMF wants to update the MBS service area of an multicast MBS session
that the UE has joined, the SMF shall include the corresponding multicast MBS
session ID and the updated MBS service area in the Received MBS container IE
in the PDU SESSION MODIFICATION COMMAND message, and shall set the MBS
decision to \"MBS service area update\" in the Received MBS information.
NOTE 6: The MBS service area of an multicast MBS session is also allowed to be
updated to the UE using the MBS service announcement as described in 3GPP TS
23.247 [53], which is out of scope of this specification.
If the network needs to update ATSSS parameters (see subclause 5.2.4 of 3GPP
TS 24.193 [13B]), the SMF shall include the ATSSS container IE with the
updates of ATSSS parameters in the PDU SESSION MODIFICATION COMMAND message.
If the network-requested PDU session modification procedure is not triggered
by a UE-requested PDU session modification procedure, the SMF shall set the
PTI IE of the PDU SESSION MODIFICATION COMMAND message to \"No procedure
transaction identity assigned\".
If the selected SSC mode of the PDU session is \"SSC mode 3\" and the SMF
requests the relocation of SSC mode 3 PDU session anchor with multiple PDU
sessions as specified in 3GPP TS 23.502 [9], the SMF shall include 5GSM cause
#39 \"reactivation requested\" , in the PDU SESSION MODIFICATION COMMAND
message, and may include the PDU session address lifetime in a PDU session
address lifetime parameter in the Extended protocol configuration options IE
of the PDU SESSION MODIFICATION COMMAND message.
The SMF shall send the PDU SESSION MODIFICATION COMMAND message, and the SMF
shall start timer T3591 (see example in figure 6.3.2.2.1).
NOTE 7: If the SMF requests the relocation of SSC mode 3 PDU session anchor
with multiple PDU sessions as specified in 3GPP TS 23.502 [9], the
reallocation requested indication indicating whether the SMF is to be
reallocated or the SMF is to be reused is provided to the AMF.
If the control plane CIoT 5GS optimization is enabled for a PDU session and
the IP header compression configuration IE was included in the PDU SESSION
ESTABLISHMENT REQUEST message or the PDU SESSION MODIFICATION REQUEST message,
and the SMF supports control plane CIoT 5GS optimization and IP header
compression for control plane CIoT 5GS optimization, the SMF may include the
IP header compression configuration IE in the PDU SESSION MODIFICATION COMMAND
message to re-negotiate IP header compression configuration associated to the
PDU session.
If the control plane CIoT 5GS optimization is enabled for a PDU session and
the Ethernet header compression configuration IE was included in the PDU
SESSION ESTABLISHMENT REQUEST message or the PDU SESSION MODIFICATION REQUEST
message, and the SMF supports control plane CIoT 5GS optimization and Ethernet
header compression for control plane CIoT 5GS optimization, the SMF may
include the Ethernet header compression configuration IE in the PDU SESSION
MODIFICATION COMMAND message to re-configure Ethernet header compression
configuration associated with the PDU session.
If the network-requested PDU session modification procedure is associated with
C2 authorization procedure, the SMF shall send the PDU SESSION MODIFICATION
COMMAND message by including the Service-level-AA container IE containing:
a) the service-level-AA response with the value of C2AR field set to the \"C2
authorization was successful\";
b) if apayload is provided from the UAS-NF, the service-level-AA payload with
the value set to the payload; and
c) if a payload type associated with the payload is provided from the UAS-NF,
the service-level-AA payload type with the value set to the payload type; and
d) if the CAA-level UAV ID is provided from the UAS-NF, the service-level
device ID set to the CAA-level UAV ID.
NOTE 8: The C2 authorization payload in the service-level-AA payload can
include one or both of the C2 session security information and C2 pairing
information.
If the service-level-AA procedure is triggered for the established PDU session
for UAS services with re-authentication purpose, and the SMF is provided by
the UAS-NF with the successful UUAA-SM result, the SMF shall transmit a PDU
SESSION MODIFICATION COMMAND message to the UE, where the PDU SESSION
MODIFICATION COMMAND message shall include the Service-level-AA container IE
containing:
a) the service-level-AA response with the value of SLAR field set to \"Service
level authentication and authorization was successful\";
b) if received the CAA-level UAV ID from the UAS-NF, the service-level device
ID with the value set to the CAA-level UAV ID;
c) if received a payload from the UAS-NF, the service-level-AA payload with
the value set to the UUAA payload; and
d) if received a payload type associated with the payload, the service-level-
AA payload type with the value set to the payload type.
If the SMF needs to provide new ECS configuration information to the UE and
the UE has indicated support for ECS configuration information provisioning in
the PDU SESSION ESTABLISHMENT REQUEST message or while in S1 mode, then the
SMF may include the Extended protocol configuration options IE in the PDU
SESSION MODIFICATION COMMAND message with:
\- at least one of ECS IPv4 Address(es), ECS IPv6 Address(es), ECS FQDN(s);
\- at least one associated ECSP identifier;and
\- optionally, spatial validity conditions associated with the ECS address;
NOTE 9: The IP address(es) and/or FQDN(s) are associated with the ECSP
identifier and replace previously provided ECS configuration information
associated with the same ECSP identifier, if any.
If the SMF needs to provide DNS server address(es) to the UE and the UE has
provided the DNS server IPv4 address request, the DNS server IPv6 address
request or both of them, in the PDU SESSION ESTABLISHMENT REQUEST message or a
PDU SESSION MODIFICATION REQUEST message, then the SMF shall include the
Extended protocol configuration options IE in the PDU SESSION MODIFICATION
COMMAND message with one or more DNS server IPv4 address(es), one or more DNS
server IPv6 address(es) or both of them.
If the SMF needs to trigger EAS rediscovery and the UE has indicated support
of the EAS rediscovery in the PDU SESSION ESTABLISHMENT REQUEST message or the
PDU SESSION MODIFICATION REQUEST message, then the SMF shall include the
Extended protocol configuration options IE in the PDU SESSION MODIFICATION
COMMAND message:
a) with the EAS rediscovery indication without indicated impact; or
b) with the following:
1) one or more EAS rediscovery indication(s) with impacted EAS IPv4 address
range, if the UE supports EAS rediscovery indication(s) with impacted EAS IPv4
address range;
2) one or more EAS rediscovery indication(s) with impacted EAS IPv6 address
range, if the UE supports EAS rediscovery indication(s) with impacted EAS IPv6
address range;
3) one or more EAS rediscovery indication(s) with impacted EAS FQDN, if the UE
supports EAS rediscovery indication(s) with impacted EAS FQDN; or
4) any combination of the above.
When UE has requested P-CSCF IPv6 address or P-CSCF IPv4 address and the SMF
has provided P-CSCF address(es) during the PDU session establishment
procedure, if the network-requested PDU session modification procedure is
triggered for P-CSCF restoration, the SMF shall include the P-CSCF IP
address(es) in the Extended protocol configuration options IE in the PDU
SESSION MODIFICATION COMMAND message as specified in subclause 5.8.2.2 of 3GPP
TS 23.380 [54].
Figure 6.3.2.2.1: Network-requested PDU session modification procedure
#### 6.3.2.3 Network-requested PDU session modification procedure accepted by
the UE
Upon receipt of the PDU SESSION MODIFICATION COMMAND message, if the UE
provided a DNN during the PDU session establishment, the UE shall stop timer
T3396, if it is running for the DNN provided by the UE. If the UE did not
provide a DNN during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop the timer T3396 associated with no
DNN if it is running. If the PDU SESSION MODIFICATION COMMAND message was
received for an emergency PDU session, the UE shall not stop the timer T3396
associated with no DNN if it is running.
Upon receipt of the PDU SESSION MODIFICATION COMMAND message, if the UE
provided an S-NSSAI and a DNN during the PDU session establishment, the UE
shall stop timer T3584, if it is running for the [S-NSSAI of the PDU session,
DNN] combination provided by the UE. If the UE provided a DNN and did not
provide an S-NSSAI during the PDU session establishment, the UE shall stop
timer T3584, if it is running for the same [no S-NSSAI, DNN] combination
provided by the UE. If the UE provided an S-NSSAI and did not provide a DNN
during the PDU session establishment, the UE shall stop timer T3584, if it is
running for the same [S-NSSAI, no DNN] combination provided by the UE. If the
UE provided neither a DNN nor an S-NSSAI during the PDU session establishment,
the UE shall stop timer T3584, if it is running for the same [no S-NSSAI, no
DNN] combination provided by the UE. The timer T3584 to be stopped includes
the timer T3584 applied for all the PLMNs, if running, and the timer T3584
applied for the registered PLMN, if running.
Upon receipt of the PDU SESSION MODIFICATION COMMAND message, if the UE
provided an S-NSSAI during the PDU session establishment, the UE shall stop
timer T3585, if it is running for the S-NSSAI of the PDU session. If the UE
did not provide an S-NSSAI during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", the UE shall stop the timer T3585
associated with no S-NSSAI if it is running. The timer T3585 to be stopped
includes the timer T3585 applied for all the PLMNs, if running, and the timer
T3585 applied for the registered PLMN, if running. If the PDU SESSION
MODIFICATION COMMAND message was received for an emergency PDU session, the UE
shall not stop the timer T3585 associated with no S-NSSAI if it is running.
NOTE 1: Upon receipt of the PDU SESSION MODIFICATION COMMAND message for a PDU
session, if the UE provided a DNN (or no DNN) and an S-NSSAI (or no S-NSSAI)
when the PDU session is established, timer T3396 associated with the DNN (or
no DNN, if no DNN was provided by the UE) is running, and timer T3584
associated with the DNN (or no DNN, if no DNN was provided by the UE) and the
S-NSSAI of the PDU session (or no S-NSSAI, if no S-NSSAI was provided by the
UE) is running, then the UE stops both the timer T3396 and the timer T3584.
NOTE 2: Upon receipt of the PDU SESSION MODIFICATION COMMAND message for a PDU
session, if the UE provided a DNN (or no DNN) and an S-NSSAI (or no S-NSSAI)
when the PDU session is established, timer T3585 associated with the S-NSSAI
of the PDU session (or no S-NSSAI, if no S-NSSAI was provided by the UE) is
running, and timer T3584 associated with the DNN (or no DNN, if no DNN was
provided by the UE) and the S-NSSAI of the PDU session (or no S-NSSAI, if no
S-NSSAI was provided by the UE) is running, then the UE stops both the timer
T3585 and the timer T3584.
If the PDU SESSION MODIFICATION COMMAND message includes the Authorized QoS
rules IE, the UE shall process the QoS rules sequentially starting with the
first QoS rule.
If the PDU SESSION MODIFICATION COMMAND message includes the Mapped EPS bearer
contexts IE, the UE shall process the mapped EPS bearer contexts sequentially
starting with the first mapped EPS bearer context.
If the PDU SESSION MODIFICATION COMMAND message includes the Authorized QoS
flow descriptions IE, the UE shall process the QoS flow descriptions
sequentially starting with the first QoS flow description.
The UE shall replace the stored authorized QoS rules, authorized QoS flow
descriptions and session-AMBR of the PDU session with the received value(s),
if any, in the PDU SESSION MODIFICATION COMMAND message.
If the PDU SESSION MODIFICATION COMMAND message includes a Mapped EPS bearer
contexts IE, the UE shall check each mapped EPS bearer context for different
types of errors as follows:
NOTE 3: An error detected in a mapped EPS bearer context does not cause the UE
to discard the Authorized QoS rules IE and Authorized QoS flow descriptions IE
included in the PDU SESSION MODICATION COMMAND message, if any.
a) Semantic error in the mapped EPS bearer operation:
1) operation code = \"Create new EPS bearer\" and there is already an existing
mapped EPS bearer context with the same EPS bearer identity associated with
any PDU session.
2) operation code = \"Delete existing EPS bearer\" and there is no existing
mapped EPS bearer context with the same EPS bearer identity associated with
the PDU session that is being modified.
3) operation code = \"Modify existing EPS bearer\" and there is no existing
mapped EPS bearer context with the same EPS bearer identity associated with
the PDU session that is being modified.
4) operation code = \"Create new EPS bearer\" or \"Modify existing EPS
bearer\" and the resulting mapped EPS bearer context has invalid mandatory
parameters or missing mandatory parameters (e.g., mapped EPS QoS parameters or
traffic flow template for a dedicated EPS bearer context).
In case 1, if the existing mapped EPS bearer context is associated with the
PDU session that is being modified, the UE shall not diagnose an error,
further process the create request and, if it was process successfully, delete
the old EPS bearer context.
In case 2, the UE shall not diagnose an error, further process the delete
request and, if it was processed successfully, consider the mapped EPS bearer
context as successfully deleted.
Otherwise, after sending the PDU SESSION MODIFICATION COMPLETE for the ongoing
PDU session modification procedure, the UE shall initiate a PDU session
modification procedure by sending a PDU SESSION MODIFICATION REQUEST message
to delete the mapped EPS bearer context with 5GSM cause #85 \"Invalid mapped
EPS bearer identity\".
b) if the mapped EPS bearer context includes a traffic flow template, the UE
shall check the traffic flow template for different types of TFT IE errors as
follows:
1) Semantic errors in TFT operations:
i) TFT operation = \"Create new TFT\" when there is already an existing TFT
for the EPS bearer context.
ii) When the TFT operation is an operation other than \"Create a new TFT\" and
there is no TFT for the EPS bearer context.
iii) TFT operation = \"Delete packet filters from existing TFT\" when it would
render the TFT empty.
iv) TFT operation = \"Delete existing TFT\" for a dedicated EPS bearer
context.
In case iv, after sending the PDU SESSION MODIFICATION COMPLETE for the
ongoing PDU session modification procedure, the UE shall initiate a PDU
session modification procedure by sending a PDU SESSION MODIFICATION REQUEST
message to delete the mapped EPS bearer context with 5GSM cause #41 \"semantic
error in the TFT operation\".
In the other cases the UE shall not diagnose an error and perform the
following actions to resolve the inconsistency:
In case i, the UE shall further process the new activation request to create a
new TFT and, if it was processed successfully, delete the old TFT.
In case ii, the UE shall:
\- process the new request and if the TFT operation is \"Delete existing TFT\"
or \"Delete packet filters from existing TFT\", and if no error according to
items 2, 3, and 4 was detected, consider the TFT as successfully deleted;
\- process the new request as an activation request, if the TFT operation is
\"Add packet filters in existing TFT\" or \"Replace packet filters in existing
TFT\".
In case iii, if the packet filters belong to a dedicated EPS bearer context,
the UE shall process the new deletion request and, if no error according to
items 2, 3, and 4 was detected, after sending the PDU SESSION MODIFICATION
COMPLETE for the ongoing PDU session modification procedure, the UE shall
initiate a PDU session modification procedure by sending a PDU SESSION
MODIFICATION REQUEST message to delete the mapped EPS bearer context with 5GSM
cause #41 \"semantic error in the TFT operation\".
In case iii, if the packet filters belong to the default EPS bearer context,
the UE shall process the new deletion request and if no error according to
items 2, 3, and 4 was detected then delete the existing TFT, this corresponds
to using match-all packet filter for the default EPS bearer context.
2) Syntactical errors in TFT operations:
i) When the TFT operation = \"Create new TFT\", \"Add packet filters in
existing TFT\", \"Replace packet filters in existing TFT\" or \"Delete packet
filters from existing TFT\" and the packet filter list in the TFT IE is empty.
ii) TFT operation = \"Delete existing TFT\" or \"No TFT operation\" with a
non-empty packet filter list in the TFT IE.
iii) TFT operation = \"Replace packet filters in existing TFT\" when the
packet filter to be replaced does not exist in the original TFT.
iv) TFT operation = \"Delete packet filters from existing TFT\" when the
packet filter to be deleted does not exist in the original TFT.
v) Void.
vi) When there are other types of syntactical errors in the coding of the TFT
IE, such as a mismatch between the number of packet filters subfield, and the
number of packet filters in the packet filter list when the TFT operation is
\"delete existing TFT\" or \"create new TFT\", or the number of packet filters
subfield is larger than the maximum possible number of packet filters in the
packet filter list.
In case iii, the UE shall not diagnose an error, further process the replace
request and, if no error according to items 3 and 4 was detected, include the
packet filters received to the existing TFT.
In case iv, the UE shall not diagnose an error, further process the deletion
request and, if no error according to items 3 and 4 was detected, consider the
respective packet filter as successfully deleted.
Otherwise, after sending the PDU SESSION MODIFICATION COMPLETE for the ongoing
PDU session modification procedure, the UE shall initiate a PDU session
modification procedure by sending a PDU SESSION MODIFICATION REQUEST message
to delete the mapped EPS bearer context with 5GSM cause #42 \"syntactical
error in the TFT operation\".
3) Semantic errors in packet filters:
i) When a packet filter consists of conflicting packet filter components which
would render the packet filter ineffective, i.e. no IP packet will ever fit
this packet filter. How the UE determines a semantic error in a packet filter
is outside the scope of the present document.
ii) When the resulting TFT, which is assigned to a dedicated EPS bearer
context, does not contain any packet filter applicable for the uplink
direction among the packet filters created on request from the network.
After sending the PDU SESSION MODIFICATION COMPLETE for the ongoing PDU
session modification procedure, the UE shall initiate a PDU session
modification procedure by sending a PDU SESSION MODIFICATION REQUEST message
to delete the mapped EPS bearer context with 5GSM cause #44 \"semantic errors
in packet filter(s)\".
4) Syntactical errors in packet filters:
i) When the TFT operation = \"Create new TFT\", \"Add packet filters to
existing TFT\", or \"Replace packet filters in existing TFT\" and two or more
packet filters in the resultant TFT would have identical packet filter
identifiers.
ii) When the TFT operation = \"Create new TFT\", \"Add packet filters to
existing TFT\" or \"Replace packet filters in existing TFT\", and two or more
packet filters among all TFTs associated with this PDN connection would have
identical packet filter precedence values.
iii) When there are other types of syntactical errors in the coding of packet
filters, such as the use of a reserved value for a packet filter component
identifier.
In case i, if two or more packet filters with identical packet filter
identifiers are contained in the new request, after sending the PDU SESSION
MODIFICATION COMPLETE for the ongoing PDU session modification procedure, the
UE shall initiate a PDU session modification procedure by sending a PDU
SESSION MODIFICATION REQUEST message to delete the mapped EPS bearer context
with 5GSM cause #45 \"syntactical error in packet filter(s)\". Otherwise, the
UE shall not diagnose an error, further process the new request and, if it was
processed successfully, delete the old packet filters which have the identical
packet filter identifiers.
In case ii, if the old packet filters do not belong to the default EPS bearer
context, the UE shall not diagnose an error, shall further process the new
request and, if it was processed successfully, shall delete the old packet
filters which have identical filter precedence values.
In case ii, if one or more old packet filters belong to the default EPS bearer
context, after sending the PDU SESSION MODIFICATION COMPLETE for the ongoing
PDU session modification procedure, the UE shall initiate a PDU session
modification procedure by sending a PDU SESSION MODIFICATION REQUEST message
to delete the mapped EPS bearer context with 5GSM cause #45 \"syntactical
errors in packet filter(s)\".
Otherwise, after sending the PDU SESSION MODIFICATION COMPLETE for the ongoing
PDU session modification procedure, the UE shall initiate a PDU session
modification procedure by sending a PDU SESSION MODIFICATION REQUEST message
to delete the mapped EPS bearer context with 5GSM cause #45 \"syntactical
error in packet filter(s)\".
And if a new EPS bearer identity parameter in Authorized QoS flow descriptions
IE is received for a QoS flow which can be transferred to EPS, the UE shall
update the association between the QoS flow and the mapped EPS bearer context,
based on the new EPS bearer identity and the mapped EPS bearer contexts. If
the \"Delete existing EPS bearer\" operation code in the Mapped EPS bearer
contexts IE was received, the UE shall discard the association between the QoS
flow and the corresponding mapped EPS bearer context.
If:
a) the UE detects different errors in the mapped EPS bearer contexts as
described above which requires sending a PDU SESSION MODIFICATION REQUEST
message to delete the erroneous mapped EPS bearer contexts; and
b) optionally, if the UE detects errors in QoS rules that require to delete at
least one QoS rule as described in subclause 6.3.2.4 which requires sending a
PDU SESSION MODIFICATION REQUEST message to delete the erroneous QoS rules;
the UE, after sending the PDU SESSION MODIFICATION COMPLETE message for the
ongoing PDU session modification procedure, may send a single PDU SESSION
MODIFICATION REQUEST message to delete the erroneous mapped EPS bearer
contexts, and optionally to delete the erroneous QoS rules. The UE shall
include a 5GSM cause IE in the PDU SESSION MODIFICATION REQUEST message.
NOTE 4: The 5GSM cause to use cannot be different from #41 \"semantic error in
the TFT operation\", #42 \"syntactical error in the TFT operation\", #44
\"semantic error in packet filter(s)\", #45 \"syntactical errors in packet
filter(s)\", #83 \"semantic error in the QoS operation\", #84 \"syntactical
error in the QoS operation\", or #85 \"Invalid mapped EPS bearer identity\".
The selection of a 5GSM cause is up to UE implementation.
Upon receipt of a PDU SESSION MODIFICATION COMMAND message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, if the
UE accepts the PDU SESSION MODIFICATION COMMAND message, the UE considers the
PDU session as modified and the UE shall create a PDU SESSION MODIFICATION
COMPLETE message.
If the PDU SESSION MODIFICATION COMMAND message contains the PTI value
allocated in the UE-requested PDU session modification procedure, the UE shall
stop the timer T3581. The UE should ensure that the PTI value assigned to this
procedure is not released immediately.
NOTE 5: The way to achieve this is implementation dependent. For example, the
UE can ensure that the PTI value assigned to this procedure is not released
during the time equal to or greater than the default value of timer T3591.
While the PTI value is not released, the UE regards any received PDU SESSION
MODIFICATION COMMAND message with the same PTI value as a network
retransmission (see subclause 7.3.1).
If the selected SSC mode of the PDU session is \"SSC mode 3\" and the PDU
SESSION MODIFICATION COMMAND message includes 5GSM cause #39 \"reactivation
requested\", the UE can provide to the upper layers the PDU session address
lifetime if received in the PDU session address lifetime parameter of the
Extended protocol configuration options IE of the PDU SESSION MODIFICATION
COMMAND message. After the completion of the network-requested PDU session
modification procedure:
a) if the PDU session is an MA PDU session:
1) established over both 3GPP access and non-3GPP access, and:
\- the UE is registered over both 3GPP access and non-3GPP access in the same
PLMN:
\- the UE should re-initiate a UE-requested PDU session establishment
procedure as specified in subclause 6.4.1 over the access the PDU SESSION
MODIFICATION COMMAND message is received; or
\- the UE is registered over both 3GPP access and non-3GPP access in different
PLMNs:
\- the UE should re-initiate UE-requested PDU session establishment procedures
as specified in subclause 6.4.1 over both accesses. The UE should re-initiate
the UE-requested PDU session establishment procedure over the access the PDU
SESSION MODIFICATION COMMAND message is received first; or
2) established over only single access:
\- the UE should re-initiate a UE-requested PDU session establishment
procedure as specified in subclause 6.4.1 over the access the user plane
resources were established; or
b) if the PDU session is a single access PDU session:
\- the UE should re-initiate a UE-requested PDU session establishment
procedure as specified in subclause 6.4.1 over the access the PDU session was
associated with; and
for the re-initiated UE-requested PDU session establishment procedure(s) the
UE should set a new PDU session ID different from the PDU session ID
associated with the present PDU session and should set:
a) the PDU session type to the PDU session type associated with the present
PDU session;
b) the SSC mode to the SSC mode associated with the present PDU session;
c) the DNN to the DNN associated with the present PDU session; and
d) the S-NSSAI to the S-NSSAI associated with (if available in roaming
scenarios) a mapped S-NSSAI if provided in the UE-requested PDU session
establishment procedure of the present PDU session.
If the UE has indicated support for CIoT 5GS optimizations and receives a
small data rate control parameters container in the Extended protocol
configuration options IE in the PDU SESSION MODIFICATION COMMAND message, the
UE shall store the small data rate control parameters value and use the stored
small data rate control parameters value as the maximum allowed limit of
uplink user data for the PDU session in accordance with 3GPP TS 23.501 [8]. If
the UE has a previously stored small data rate control parameter value for the
PDU session, the UE shall replace the stored small data rate control
parameters value for the PDU session with the received small data rate control
parameters value in the Extended protocol configuration options IE in the PDU
SESSION MODIFICATION COMMAND message.
If the UE has indicated support for CIoT 5GS optimizations and receives an
additional small data rate control parameters for exception data container in
the Extended protocol configuration options IE in the PDU SESSION MODIFICATION
COMMAND message, the UE shall store the additional small data rate control
parameters for exception data value and use the stored additional small data
rate control parameters for exception data value as the maximum allowed limit
of uplink exception data for the PDU session in accordance with 3GPP TS 23.501
[8]. If the UE has a previously stored additional small data rate control
parameters for exception data value for the PDU session, the UE shall replace
the stored additional small data rate control parameters for exception data
value for the PDU session with the received additional small data rate control
parameters for exception data value in the Extended protocol configuration
options IE in the PDU SESSION MODIFICATION COMMAND message.
The UE shall include the PDU session ID of the old PDU session which is about
to get released in the old PDU session ID IE of the UL NAS TRANSPORT message
that transports the PDU SESSION ESTABLISHMENT REQUEST message.
NOTE 6: The UE is expected to maintain the PDU session for which the PDU
SESSION MODIFICATION COMMAND message including 5GSM cause #39 \"reactivation
requested\" is received during the time indicated by the PDU session address
lifetime value or until receiving an indication from upper layers (e.g. that
the old PDU session is no more needed).
If the selected PDU session type of the PDU session is \"Unstructured\", the
UE supports inter-system change from N1 mode to S1 mode, the UE does not
support establishment of a PDN connection for the PDN type set to \"non-IP\"
in S1 mode, and the parameters list field of one or more authorized QoS flow
descriptions received in the Authorized QoS flow descriptions IE of the PDU
SESSION MODIFICATION COMMAND message contains an EPS bearer identity (EBI),
then the UE shall locally remove the EPS bearer identity (EBI) from the
parameters list field of such one or more authorized QoS flow descriptions.
After sending the PDU SESSION MODIFICATION COMPLETE message for the ongoing
PDU session modification procedure, the UE shall initiate a PDU session
modification procedure by sending a PDU SESSION MODIFICATION REQUEST message
to delete the mapped EPS bearer context with 5GSM cause #85 \"Invalid mapped
EPS bearer identity\".
If the selected PDU session type of the PDU session is \"Ethernet\", the UE
supports inter-system change from N1 mode to S1 mode, the UE does not support
establishment of a PDN connection for the PDN type set to \"non-IP\" in S1
mode, the UE, the network or both of them do not support Ethernet PDN type in
S1 mode, and the parameters list field of one or more authorized QoS flow
descriptions received in the Authorized QoS flow descriptions IE of the PDU
SESSION MODIFICATION COMMAND message contains an EPS bearer identity (EBI),
the UE shall locally remove the EPS bearer identity (EBI) from the parameters
list field of such one or more authorized QoS flow descriptions. After sending
the PDU SESSION MODIFICATION COMPLETE message for the ongoing PDU session
modification procedure, the UE shall initiate a PDU session modification
procedure by sending a PDU SESSION MODIFICATION REQUEST message to delete the
mapped EPS bearer context with 5GSM cause #85 \"Invalid mapped EPS bearer
identity\".
For a UE which is registered for disaster roaming services and for a PDU
session which is not a PDU session for emergency services:
a) if the parameters list field of one or more authorized QoS flow
descriptions received in the Authorized QoS flow descriptions IE of the PDU
SESSION MODIFICATION COMMAND message contains an EPS bearer identity (EBI),
then the UE shall locally remove the EPS bearer identity (EBI) from the
parameters list field of such one or more authorized QoS flow descriptions;
and
b) the UE shall locally delete the contents of the Mapped EPS bearer contexts
IE if it is received in the PDU SESSION MODIFICATION COMMAND message.
If the Always-on PDU session indication IE is included in the PDU SESSION
MODIFICATION COMMAND message and:
a) the value of the IE is set to \"Always-on PDU session required\", the UE
shall consider the established PDU session as an always-on PDU session; or
b) the value of the IE is set to \"Always-on PDU session not allowed\", the UE
shall not consider the established PDU session as an always-on PDU session.
If the UE does not receive the Always-on PDU session indication IE in the PDU
SESSION MODIFICATION COMMAND message:
a) if the network-requested PDU session modification procedure is triggered by
a UE-requested PDU session modification procedure upon an inter-system change
from S1 mode to N1 mode for a PDN connection established when in S1 mode, the
UE shall not consider the modified PDU session as an always-on PDU session; or
b) otherwise:
1) if the UE has received the Always-on PDU session indication IE with the
value set to \"Always-on PDU session required\" for this PDU session, the UE
shall consider the PDU session as an always-on PDU session; or
2) otherwise the UE shall not consider the PDU session as an always-on PDU
session.
If the PDU SESSION MODIFICATION COMMAND message contains a Port management
information container IE, the UE shall forward the contents of the Port
management information container IE to the DS-TT (see 3GPP TS 23.501 [8] and
3GPP TS 23.502 [9]).
If the UE receives a Serving PLMN rate control IE in the PDU SESSION
MODIFICATION COMMAND message, the UE shall store the Serving PLMN rate control
IE value, replacing any existing value, and use the stored serving PLMN rate
control value as the maximum allowed limit of uplink control plane user data
for the corresponding PDU session in accordance with 3GPP TS 23.501 [8].
If the PDU SESSION MODIFICATION COMMAND message includes the Received MBS
container IE, for each of the Received MBS informations:
a) if MBS decision is set to \"MBS join is accepted\", the UE shall consider
that it has successfully joined the multicast MBS session. The UE shall store
the received TMGI and shall use it for any further operation on that multicast
MBS session. The UE shall store the received MBS service area associated with
the received TMGI, if any, and provide the received TMGI to lower layers. The
UE may provide the MBS start time if it is included in the Received MBS
information to upper layers;
b) if MBS decision is set to \"MBS join is rejected\", the UE shall consider
the requested join as rejected. The UE shall store the received MBS service
area associated with the received TMGI, if any. If the received Rejection
cause is set to \"User is outside of local MBS service area\", the UE shall
not request to join the same multicast MBS session if neither current TAI nor
CGI of the current cell is part of the received MBS service area. If the
received Rejection cause is set to \"multicast MBS session has not started or
will not start soon\" and an MBS back-off timer value is included with value
that indicates neither zero nor deactivated, the UE shall start a back-off
timer T3587 with the value provided in the MBS back-off timer value for the
received TMGI, and shall not attempt to join the multicast MBS session with
the same TMGI, the Source IP address information of the TMGI, or the
Destination IP address information of the TMGI until the expiry of T3587. If
the MBS back-off timer value indicates that this timer is deactivated, the UE
shall not attempt to join the multicast MBS session with the same TMGI until
the UE is switched off, the USIM is removed, or the entry in the \"list of
subscriber data\" for the current SNPN is updated. If the MBS back-off timer
value indicates zero, the UE may attempt to join the multicast MBS session
with the same TMGI;
c) if the MBS decision is set to \"Remove UE from multicast MBS session\", the
UE shall consider that it has successfully left the multicast MBS session, and
if the received Rejection cause is set to \"multicast MBS session is
released\", the UE shall consider the multicast MBS session as released. Then
the UE shall indicate to lower layers to delete the stored TMGI;
d) if the MBS decision is set to \"MBS service area update\", the UE shall
store the received MBS service area associated with the received TMGI and
replace the current MBS service area with the received one. or
e) if the MBS decision is set to \"MBS security information update\", the UE
shall replace the current MBS security information with the MBS security
information received in the MBS security container associated with the
received TMGI.
If the UE has indicated support for ECS configuration information provisioning
in the SESSION ESTABLISHMENT REQUEST message or while in S1 mode, then upon
receiving
\- one or more ECS IPv4 address(es), ECS IPv6 address(es), ECS FQDN(s);
\- one or more associated ECSP identifier(s);and
\- optionally spatial validity conditions associated with the ECS address
in the Extended protocol configuration options IE of the PDU SESSION
MODIFICATION COMMAND message, then the UE shall pass them to the upper layers.
If the UE supports receiving DNS server addresses in protocol configuration
options and receives one or more DNS server IPv4 address(es), one or more DNS
server IPv6 address(es) or both of them, in the Extended protocol
configuration options IE of the PDU SESSION MODIFICATION COMMAND message, then
the UE shall pass the received DNS server IPv4 address(es), if any, and the
received DNS server IPv6 address(es), if any, to upper layers.
NOTE 7: The received DNS server address(es) replace previously provided DNS
server address(es), if any.
If the UE supports the EAS rediscovery and receives:
a) the EAS rediscovery indication without indicated impact; or
b) the following:
1) one or more EAS rediscovery indication(s) with impacted EAS IPv4 address
range, if supported by the UE;
2) one or more EAS rediscovery indication(s) with impacted EAS IPv6 address
range, if supported by the UE;
3) one or more EAS rediscovery indication(s) with impacted EAS FQDN, if
supported by the UE; or
4) any combination of the above;
in the Extended protocol configuration options IE of the PDU SESSION
MODIFICATION COMMAND message, then the UE shall pass the EAS rediscovery
indication and the received impacted EAS IPv4 address range(s), if supported
and included, the received EAS IPv6 address range(s), if supported and
included, and the received EAS FQDN(s), if supported and included, to upper
layers.
NOTE 8: The upper layers handle the EAS rediscovery indication and the
impacted EAS IPv4 address range(s), if any, the impacted EAS IPv6 address
range(s), if any, and the received EAS FQDN(s), if any, according to 3GPP TS
23.548 [10A].
Upon receipt of PDU SESSION MODIFICATION COMMAND message, if the network-
requested PDU session modification procedure is triggered by a UE-requested
PDU session modification procedure, the Service-level-AA container IE is
included, then the UE shall forward the service-level-AA contents of the
Service-level-AA container IE to the upper layers.
If the UE supports EDC and receives the EDC usage allowed indicator in the
Extended protocol configuration options IE of the PDU SESSION MODIFICATION
COMMAND message, the UE shall indicate to upper layers that network allows the
use of EDC.
If the UE supports EDC and receives the EDC usage required indicator in the
Extended protocol configuration options IE of the PDU SESSION MODIFICATION
COMMAND message, the UE shall indicate to upper layers that network requires
the use of EDC.
NOTE 9: Handling of indication that network allows the use of EDC or that
network requires the use of EDC is specified in 3GPP TS 23.548 [182].
The UE shall transport the PDU SESSION MODIFICATION COMPLETE message and the
PDU session ID, using the NAS transport procedure as specified in subclause
5.4.5.
After sending the PDU SESSION MODIFICATION COMPLETE message, if the \"Create
new EPS bearer\" operation code in the Mapped EPS bearer contexts IE was
received in the PDU SESSION MODIFICATION COMMAND message and there is neither
a corresponding Authorized QoS flow descriptions IE in the PDU SESSION
MODIFICATION COMMAND message nor an existing QoS flow description
corresponding to the EPS bearer identity included in the mapped EPS bearer
context, the UE shall send a PDU SESSION MODIFICATION REQUEST message
including a Mapped EPS bearer contexts IE to delete the mapped EPS bearer
context.
After sending the PDU SESSION MODIFICATION COMPLETE message, if for the PDU
session being modified, there are mapped EPS bearer context(s) but none of
them is associated with the default QoS rule, the UE shall locally delete the
mapped EPS bearer context(s) and shall locally delete the stored EPS bearer
identity (EBI) in all the QoS flow descriptions of the PDU session, if any.
If a port management information container needs to be delivered (see 3GPP TS
23.501 [8] and 3GPP TS 23.502 [9]), the UE shall include a Port management
information container IE in the PDU SESSION MODIFICATION COMPLETE message.
Upon receipt of a PDU SESSION MODIFICATION COMPLETE message, the SMF shall
stop timer T3591 and shall consider the PDU session as modified. If the
selected SSC mode of the PDU session is \"SSC mode 3\" and the PDU SESSION
MODIFICATION COMMAND message included 5GSM cause #39 \"reactivation
requested\", the SMF shall start timer T3593. If the PDU Session Address
Lifetime value is sent to the UE in the PDU SESSION MODIFICATION COMMAND
message then timer T3593 shall be started with the same value, otherwise it
shall use a default value. If the PDU SESSION MODIFICATION COMPLETE message
contains a Port management information container IE, the SMF shall handle the
contents of the Port management information container IE as specified in 3GPP
TS 23.501 [8] and 3GPP TS 23.502 [9].
#### 6.3.2.4 Network-requested PDU session modification procedure not accepted
by the UE
Upon receipt of a PDU SESSION MODIFICATION COMMAND message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, if the
UE rejects the PDU SESSION MODIFICATION COMMAND message, the UE shall create a
PDU SESSION MODIFICATION COMMAND REJECT message.
If the PDU SESSION MODIFICATION COMMAND message contains the PTI value
allocated in the UE-requested PDU session modification procedure, the UE shall
stop the timer T3581. The UE should ensure that the PTI value assigned to this
procedure is not released immediately.
NOTE 1: The way to achieve this is implementation dependent. For example, the
UE can ensure that the PTI value assigned to this procedure is not released
during the time equal to or greater than the default value of timer T3591.
While the PTI value is not released, the UE regards any received PDU SESSION
MODIFICATION COMMAND message with the same PTI value as a network
retransmission (see subclause 7.3.1).
The UE shall set the 5GSM cause IE of the PDU SESSION MODIFICATION COMMAND
REJECT message to indicate the reason for rejecting the PDU session
modification.
The 5GSM cause IE typically indicates one of the following 5GSM cause values:
#26 insufficient resources;
#44 semantic error in packet filter(s);
#45 syntactical error in packet filter(s);
#83 semantic error in the QoS operation; or
#84 syntactical error in the QoS operation.
If the selected SSC mode of the PDU session is \"SSC mode 3\" and the PDU
SESSION MODIFICATION COMMAND messages includes 5GSM cause #39 \"reactivation
requested\", while the UE does not have sufficient resources for initiating
the PDU session establishment procedure as specified in subclause 6.4.1 then
the UE shall set cause IE to #26 \"insufficient resources\".
If the PDU SESSION MODIFICATION COMMAND message includes a request to add a
new authorized QoS rule, or a request to modify the authorized QoS rules, or
both, and the UE decides to reject the request due to e.g. the supported
number of authorized QoS rules or number of packet filters associated with a
PDU session having reached the maximum number, then the UE shall set the 5GSM
cause IE to #26 \"insufficient resources\".
NOTE 2: The maximum number of supported authorized QoS rules or packet filters
associated with a PDU session is implementation specific.
If the PDU SESSION MODIFICATION COMMAND message includes a request to add a
new authorized QoS flow description, or a request to modify the authorized QoS
flow descriptions, or both and the UE decides to reject the request due to
e.g. the supported number of authorized QoS flow descriptions, then the UE
shall set the 5GSM cause IE to #26 \"insufficient resources\".
NOTE 3: The maximum number of supported authorized QoS flow descriptions
associated with a PDU session is implementation specific.
If the PDU SESSION MODIFICATION COMMAND message includes the Authorized QoS
rules IE, the UE shall process the QoS rules sequentially starting with the
first QoS rule. The UE shall check the QoS rule and the QoS flow description
provided in the PDU SESSION MODIFICATION COMMAND message for different types
of errors as follows:
NOTE 4: If an error is detected in a QoS rule or a QoS flow description which
requires rejecting the PDU SESSION MODIFICATION COMMAND message, then the
Authorized QoS rules IE, the Authorized QoS flow descriptions IE, the Mapped
EPS bearer contexts IE and any other IE (RQ timer value IE, Always-on PDU
session indication IE, etc) included in the PDU SESSION MODIFICATION COMMAND
message are discarded, if any.
a) Semantic errors in QoS operations:
1) When the rule operation is \"Modify existing QoS rule and add packet
filters\", \"Modify existing QoS rule and replace all packet filters\",
\"Modify existing QoS rule and delete packet filters\" or \"Modify existing
QoS rule without modifying packet filters\" on the default QoS rule and the
DQR bit is set to \"the QoS rule is not the default QoS rule\".
2) When the rule operation is \"Modify existing QoS rule and add packet
filters\", \"Modify existing QoS rule and replace all packet filters\",
\"Modify existing QoS rule and delete packet filters\" or \"Modify existing
QoS rule without modifying packet filters\" on a QoS rule which is not the
default QoS rule and the DQR bit is set to \"the QoS rule is the default QoS
rule\".
3) When the rule operation is \"Create new QoS rule\" and the DQR bit is set
to \"the QoS rule is the default QoS rule\" when there\'s already a default
QoS rule with different QoS rule identifier.
4) When the rule operation is \"Delete existing QoS rule\" on the default QoS
rule.
5) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\", \"Modify existing QoS rule and replace all
packet filters\", \"Modify existing QoS rule and delete packet filters \", or
\"Modify existing QoS rule without modifying packet filters\" and two or more
QoS rules associated with this PDU session would have identical precedence
values, and the UE is not in NB-N1 mode.
6) When the rule operation is \"Modify existing QoS rule and delete packet
filters\", the QoS rule is a QoS rule of a PDU session of IPv4, IPv6, IPv4v6
or Ethernet PDU session type, and the packet filter list in the resultant QoS
rule is empty.
7) When the rule operation is \"Create new QoS rule\", there is already an
existing QoS rule with the same QoS rule identifier and the UE is not in NB-N1
mode.
8) When the rule operation is \"Modify existing QoS rule and add packet
filters\", \"Modify existing QoS rule and replace all packet filters\",
\"Modify existing QoS rule and delete packet filters\" or \"Modify existing
QoS rule without modifying packet filters\", the associated QoS rule does not
exist and the UE is not in NB-N1 mode.
9) When the rule operation is different than \"Delete existing QoS rule\", the
DQR bit of the QoS rule is set to \"the QoS rule is not the default QoS rule\"
and the UE is in NB-N1 mode.
10) When the rule operation is \"Create new QoS rule\", the DQR bit is set to
\"the QoS rule is not the default QoS rule\", and the PDU session type of the
PDU session is \"Unstructured\".
11) When the rule operation is \"Delete existing QoS rule\" and there is no
existing QoS rule with the same QoS rule identifier.
12) When the flow description operation is \"Create new QoS flow
description\", there is already an existing QoS flow description with the same
QoS flow identifier and the UE is not in NB-N1 mode.
13) When the flow description operation is \"Modify existing QoS flow
description\", the associated QoS flow description does not exist and the UE
is not in NB-N1 mode.
14) When the flow description operation is \"Delete existing QoS flow
description\" and there is no existing QoS flow description with the same QoS
flow identifier.
15) When the flow description operation is different than \"Delete existing
QoS flow description\", the QFI is not the same as the QFI of the default QoS
rule and the UE is in NB-N1 mode.
16) When the flow description operation is \"Create new QoS flow description\"
or \"Modify existing QoS flow description\", the QFI associated with the QoS
flow description is not the same as the QFI of the default QoS rule, and the
PDU session type of the PDU session is \"Unstructured\".
17) When the rule operation is \"Modify existing QoS rule and add packet
filters\", the \"packet filter list\" field contains a match-all packet
filter, the resultant QoS rule is the default QoS rule and there is already an
existing match-all packet filter associated with the default QoS rule.
18) When the rule operation is \"Create new QoS rule\" and the DQR bit is set
to \"the QoS rule is not the default QoS rule\", or the rule operation is
\"Modify existing QoS rule and add packet filters\" on a QoS rule which is not
the default QoS rule or \"Modify existing QoS rule and replace all packet
filters\" on a QoS rule which is not the default QoS rule, and one match-all
packet filter is to be associated with the resultant QoS rule.
In case 4, the UE shall initiate a PDU session release procedure by sending a
PDU SESSION RELEASE REQUEST message with 5GSM cause #83 \"semantic error in
the QoS operation\".
In case 5, if the old QoS rule (i.e. the QoS rule that existed before the PDU
SESSION MODIFICATION COMMAND message was received) is not the default QoS
rule, the UE shall not diagnose an error, shall further process the new
request and, if it was processed successfully, shall delete the old QoS rule
which has identical precedence value. Furthermore, after sending the PDU
SESSION MODIFICATION COMPLETE for the ongoing PDU session modification
procedure, the UE shall send a PDU SESSION MODIFICATION REQUEST message with
5GSM cause #83 \"semantic error in the QoS operation\" to delete the QoS rule.
In case 5, if the old QoS rule (i.e. the QoS rule that existed before the PDU
SESSION MODIFICATION COMMAND message was received) is the default QoS rule,
the UE shall initiate a PDU session release procedure by sending a PDU SESSION
RELEASE REQUEST message with 5GSM cause #83 \"semantic error in the QoS
operation\".
In case 6, if the QoS rule is not the default QoS rule, after sending the PDU
SESSION MODIFICATION COMPLETE for the ongoing PDU session modification
procedure, the UE shall send a PDU SESSION MODIFICATION REQUEST message with
5GSM cause #83 \"semantic error in the QoS operation\" to delete the QoS rule.
In case 6, if the QoS rule is the default QoS rule, the UE shall initiate a
PDU session release procedure by sending a PDU SESSION RELEASE REQUEST message
with 5GSM cause #83 \"semantic error in the QoS operation\".
In case 7, if the existing QoS rule is not the default QoS rule and the DQR
bit of the new QoS rule is set to \"the QoS rule is not the default QoS
rule\", the UE shall not diagnose an error, further process the create request
and, if it was processed successfully, delete the old QoS rule. If the
existing QoS rule is the default QoS rule or the DQR bit of the new QoS rule
is set to \"the QoS rule is the default QoS rule\", the UE shall reject the
PDU SESSION MODIFICATION COMMAND message with 5GSM cause #83 \"semantic error
in the QoS operation\".
In case 9 or case 10, after sending the PDU SESSION MODIFICATION COMPLETE for
the ongoing PDU session modification procedure, the UE shall send a PDU
SESSION MODIFICATION REQUEST message with 5GSM cause #83 \"semantic error in
the QoS operation\" to delete the QoS rule.
In case 11, the UE shall not diagnose an error, further process the delete
request and, if it was processed successfully, consider the respective QoS
rule as successfully deleted.
In case 12, the UE shall not diagnose an error, further process the create
request and, if it was processed successfully, delete the old QoS flow
description.
In case 14, the UE shall not diagnose an error, further process the delete
request and, if it was processed successfully, consider the respective QoS
flow description as successfully deleted.
In case 15 or case 16, after sending the PDU SESSION MODIFICATION COMPLETE for
the ongoing PDU session modification procedure, the UE shall send a PDU
SESSION MODIFICATION REQUEST message with 5GSM cause #83 \"semantic error in
the QoS operation\" to delete the QoS flow description.
Otherwise, the UE shall reject the PDU SESSION MODIFICATION COMMAND message
with 5GSM cause #83 \"semantic error in the QoS operation\".
b) Syntactical errors in QoS operations:
1) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\", \"Modify existing QoS rule and replace all
packet filters\" or \"Modify existing QoS rule and delete packet filters\",
the _PDU session type of the PDU session is_ IPv4, IPv6, IPv4v6 or Ethernet
PDU session type _,_ and the packet filter list in the QoS rule is empty.
2) When the rule operation is \"Delete existing QoS rule\" or \"Modify
existing QoS rule without modifying packet filters\" with a non-empty packet
filter list in the QoS rule.
3) When the rule operation is \"Modify existing QoS rule and delete packet
filters\" and the packet filter to be deleted does not exist in the original
QoS rule.
4) Void.
5) When there are other types of syntactical errors in the coding of the
Authorized QoS rules IE or the Authorized QoS flow descriptions IE, such as: a
mismatch between the number of packet filters subfield and the number of
packet filters in the packet filter list when the rule operation is \"delete
existing QoS rule\" or \"create new QoS rule\", or the number of packet
filters subfield is larger than the maximum possible number of packet filters
in the packet filter list (i.e., there is no QoS rule precedence subfield
included in the QoS rule IE), the QoS Rule Identifier is set to \"no QoS rule
identifier assigned\", or the QoS flow identifier is set to \"no QoS flow
identifier assigned\".
6) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\" or \"Modify existing QoS rule and replace all
packet filters\", the DQR bit is set to \"the QoS rule is the default QoS
rule\", the PDU session type of the PDU session is \"Unstructured\", and the
packet filter list in the QoS rule is not empty.
7) When, the
A) rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and
add packet filters\", \"Modify existing QoS rule and replace all packet
filters\", \"Modify existing QoS rule and delete packet filters\" or \"Modify
existing QoS rule without modifying packet filters\", there is no QoS flow
description with a QFI corresponding to the QFI of the resulting QoS rule and
the UE determines, by using the QoS rule's QFI as the 5QI, that there is a
resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8]
table 5.7.4-1).
B) flow description operation is \"Delete existing QoS flow description\", and
the UE determines, by using the QoS rule's QFI as the 5QI, that there is a
resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8]
table 5.7.4-1) with a QFI corresponding to the QFI of the QoS flow description
that is deleted (i.e. there is no associated QoS flow description with the
same QFI).
8) When the flow description operation is \"Create new QoS flow description\"
or \"Modify existing QoS flow description\", and the UE determines that there
is a QoS flow description of a GBR QoS flow (as described in 3GPP TS 23.501
[8] table 5.7.4-1) which lacks at least one of the mandatory parameters (i.e.,
GFBR uplink, GFBR downlink, MFBR uplink and MFBR downlink). If the QoS flow
description does not include a 5QI, the UE determines this by using the QFI as
the 5QI,
In case 3 the UE shall not diagnose an error, further process the deletion
request and, if no error according to items c and d was detected, consider the
respective packet filter as successfully deleted.
In case 6, after completion of the PDU session modification procedure, the UE
shall send a PDU SESSION MODIFICATION REQUEST message with 5GSM cause #84
\"syntactical error in the QoS operations\" to delete all the packet filters
for the default QoS rule.
In case 7, if the Authorized QoS rules IE contains at least one other valid
QoS rule, the UE shall not diagnose an error and shall further process the
request, if no error according to items c and d was detected. After completion
of the PDU session modification procedure, the UE shall delete the QoS rule
for which no corresponding QoS flow description is available and initiate UE-
requested PDU session modification procedure with 5GSM cause #84 \"syntactical
error in the QoS operation\" to delete the QoS rule for which it has deleted.
In case 8, if the default QoS rule is associated with the QoS flow description
which lacks at least one of the mandatory parameters, the UE shall initiate a
PDU session release procedure by sending a PDU SESSION RELEASE REQUEST message
with 5GSM cause #84 \"syntactical error in the QoS operation\". Otherwise, if
the Authorized QoS rules IE contains at least one other valid QoS rule or the
QoS flow description IE contains at least one other valid QoS flow
description, the UE shall not diagnose an error and shall further process the
request, if no error according to items c and d was detected. After completion
of the PDU session modification procedure, the UE shall delete the QoS flow
description which lacks at least one of the mandatory parameters and the
associated QoS rule(s), if any, and initiate UE-requested PDU session
modification procedure with 5GSM cause #84 \"syntactical error in the QoS
operation\" to delete the QoS flow description and the associated QoS rule(s),
if any, which it has deleted.
Otherwise the UE shall reject the PDU SESSION MODIFICATION COMMAND message
with 5GSM cause #84 \"syntactical error in the QoS operation\".
NOTE 5: It is not considered an error if the UE determines that after
processing all QoS operations on QoS rules and QoS flow descriptions there is
a QoS flow description that is not associated with any QoS rule and the UE is
not in NB-N1 mode.
c) Semantic errors in packet filters:
1) When a packet filter consists of conflicting packet filter components which
would render the packet filter ineffective, i.e. no IP packet will ever fit
this packet filter. How the UE determines a semantic error in a packet filter
is outside the scope of the present document.
The UE shall reject the PDU SESSION MODIFICATION COMMAND message with 5GSM
cause #44 \"semantic error in packet filter(s)\".
d) Syntactical errors in packet filters:
1) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS
rule and add packet filters\" or \"Modify existing QoS rule and replace all
packet filters\", and two or more packet filters in the resultant QoS rule
would have identical packet filter identifiers.
2) When there are other types of syntactical errors in the coding of packet
filters, such as the use of a reserved value for a packet filter component
identifier.
In case 1, if two or more packet filters with identical packet filter
identifiers are contained in the PDU SESSION MODIFICATION COMMAND message, the
UE shall reject the PDU SESSION MODIFICATION COMMAND with 5GSM cause #45
\"syntactical errors in packet filter(s)\". Otherwise, the UE shall not
diagnose an error, further process the PDU SESSION MODIFICATION COMMAND
message and, if it was processed successfully, replace the old packet filter
with the new packet filter which have the identical packet filter identifiers.
Otherwise the UE shall reject the PDU SESSION MODIFICATION COMMAND message
with 5GSM cause #45 \"syntactical errors in packet filter(s)\".
If:
a) the UE detects errors in QoS rules that require to delete at least one QoS
rule as described above which requires sending a PDU SESSION MODIFICATION
REQUEST message to delete the erroneous mapped EPS bearer contexts; and
b) optionally, if the UE detects different errors in the mapped EPS bearer
contexts as described in subclause 6.3.2.3 which requires sending a PDU
SESSION MODIFICATION REQUEST message to delete the erroneous QoS rules;
the UE, after sending the PDU SESSION MODIFICATION COMPLETE message for the
ongoing PDU session modification procedure, may send a single PDU SESSION
MODIFICATION REQUEST message to delete the erroneous QoS rules, and optionally
to delete the erroneous mapped EPS bearer contexts. The UE shall include a
5GSM cause IE in the PDU SESSION MODIFICATION REQUEST message.
NOTE 6: The 5GSM cause to use cannot be different from #41 \"semantic error in
the TFT operation\", #42 \"syntactical error in the TFT operation\", #44
\"semantic error in packet filter(s)\", #45 \"syntactical errors in packet
filter(s)\", #83 \"semantic error in the QoS operation\", #84 \"syntactical
error in the QoS operation\", or #85 \"Invalid mapped EPS bearer identity\".
The selection of a 5GSM cause is up to UE implementation.
The UE shall transport the PDU SESSION MODIFICATION COMMAND REJECT message and
the PDU session ID, using the NAS transport procedure as specified in
subclause 5.4.5.
Upon receipt of a PDU SESSION MODIFICATION COMMAND REJECT message with 5GSM
cause value in state PDU SESSION MODIFICATION PENDING, the SMF shall stop
timer T3591, enter the state PDU SESSION ACTIVE and abort the PDU session
modification procedure.
#### 6.3.2.5 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Expiry of timer T3591.
On the first expiry of the timer T3591, the SMF shall resend the PDU SESSION
MODIFICATION COMMAND message and shall reset and restart timer T3591. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3591, the SMF shall abort the procedure and enter the state PDU SESSION
ACTIVE.
The SMF may continue to use the previous configuration of the PDU session or
initiate the network-requested PDU session release procedure. If the SMF
decides to continue to use the previous configuration of the PDU session and
i) the Authorized QoS rules IE is included in the PDU SESSION MODIFICATION
COMMAND message, the SMF may mark the corresponding authorized QoS rule(s) of
the PDU session as to be synchronised with the UE; and
ii) the Authorized QoS flow descriptions IE is included in the PDU SESSION
MODIFICATION COMMAND message, the SMF may mark the corresponding authorized
QoS flow description(s) of the PDU session as to be synchronised with the UE.
b) Void.
c) Collision of UE-requested PDU session release procedure and network-
requested PDU session modification procedure.
If the SMF receives a PDU SESSION RELEASE REQUEST message during the network-
requested PDU session modification procedure, and the PDU session indicated in
the PDU SESSION RELEASE REQUEST message is the PDU session that the SMF had
requested to modify, the SMF shall abort the PDU session modification
procedure and proceed with the UE-requested PDU session release procedure.
d) Collision of UE-requested PDU session modification procedure and network-
requested PDU session modification procedure.
If the network receives a PDU SESSION MODIFICATION REQUEST message during the
network-requested PDU session modification procedure, and the PDU session
indicated in the PDU SESSION MODIFICATION REQUEST message is the PDU session
that the network had requested to modify, the network shall ignore the PDU
SESSION MODIFICATION REQUEST message received in the state PDU SESSION
MODIFICATION PENDING. The network shall proceed with the network-requested PDU
session modification procedure as if no PDU SESSION MODIFICATION REQUEST
message was received from the UE.
e) 5G access network cannot forward the message.
If the SMF determines based on content of the n2SmInfo attribute specified in
3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU
SESSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G
access network, then the SMF shall abort the procedure and enter the state PDU
SESSION ACTIVE.
f) 5G access network cannot forward the message due to handover.
If the SMF determines based on content of the n2SmInfo attribute specified in
3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU
SESSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G
access network due to handover, then the SMF shall abort the procedure and
enter the state PDU SESSION ACTIVE.
The SMF may re-initiate, up to a pre-configured number of times, the network-
requested PDU session modification procedure when the SMF detects that the
handover is completed successfully or has failed or at the expiry of the
configured guard timer as specified in 3GPP TS 23.502 [9].
g) Collision of re-establishment of the user-plane resources and network-
requested PDU session modification procedure for the same PDU session.
If the SMF receives an indication from the AMF to re-establish the user-plane
resources during the network-requested PDU session modification procedure for
the same PDU session, the network shall abort the network-requested PDU
session modification procedure and proceed with re-establishment of the user-
plane resources for the PDU session as specified in 3GPP TS 29.502 [20A]
subclause 5.2.2.3.2.2.
NOTE: After the completion of re-establishment of the user-plane resources for
the PDU session, the SMF can re-initiate the network-requested PDU session
modification procedure for the PDU session.
h) Collision of UE-requested PDU session establishment procedure and network-
requested PDU session modification procedure.
If the network receives a PDU SESSION ESTABLISHMENT REQUEST message with
request type set to \"existing PDU session\" or \"existing emergency PDU
session\" during the network-requested PDU session modification procedure, and
the PDU session ID indicated in the PDU SESSION ESTABLISHMENT REQUEST message
is the PDU session that the network had requested to modify, the network shall
abort the network-requested PDU session modification procedure and proceed
with the UE-requested PDU session establishment procedure.
#### 6.3.2.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION MODIFICATION COMMAND message belongs
to any PDU session in state PDU SESSION INACTIVE in the UE, the UE shall set
the 5GSM cause IE to #43 \"Invalid PDU session identity\" in the 5GSM STATUS
message, and set the PDU session ID to the received PDU session ID in the UL
NAS TRANSPORT message as specified in subclause 5.4.5.
b) Collision of network-requested PDU session modification procedure and UE-
requested PDU session modification procedure.
If the UE receives a PDU SESSION MODIFICATION COMMAND message during the UE-
requested PDU session modification procedure, the PTI IE of the PDU SESSION
MODIFICATION COMMAND message is set to \"No procedure transaction identity
assigned\", and the PDU session indicated in the PDU SESSION MODIFICATION
COMMAND message is the PDU session that the UE had requested to modify, the UE
shall abort internally the UE-requested PDU session modification procedure,
enter the state PDU SESSION ACTIVE and proceed with the network-requested PDU
session modification procedure.
### 6.3.3 Network-requested PDU session release procedure
#### 6.3.3.1 General
The purpose of the network-requested PDU session release procedure is to
enable the network to release a PDU session or the user-plane resources on a
single access of an MA PDU session.
#### 6.3.3.2 Network-requested PDU session release procedure initiation
In order to initiate the network-requested PDU session release procedure, the
SMF shall create a PDU SESSION RELEASE COMMAND message.
The SMF shall set the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message
to indicate the reason for releasing the PDU session.
The 5GSM cause IE typically indicates one of the following 5GSM cause values:
#8 operator determined barring;
#26 insufficient resources;
#29 user authentication or authorization failed;
#36 regular deactivation;
#38 network failure;
#39 reactivation requested;
#46 out of LADN service area;
#67 insufficient resources for specific slice and DNN;
#69 insufficient resources for specific slice.
If the selected SSC mode of the PDU session is \"SSC mode 2\" and the SMF
requests the relocation of SSC mode 2 PDU session anchor with different PDU
sessions as specified in 3GPP TS 23.502 [9], the SMF shall include 5GSM cause
#39 \"reactivation requested\".
If the network-requested PDU session release procedure is triggered by a UE-
requested PDU session release procedure, the SMF shall set the PTI IE of the
PDU SESSION RELEASE COMMAND message to the PTI of the PDU SESSION RELEASE
REQUEST message received as part of the UE-requested PDU session release
procedure and shall not include the Access type IE in the PDU SESSION RELEASE
COMMAND.
If the network-requested PDU session release procedure is not triggered by a
UE-requested PDU session release procedure, the SMF shall set the PTI IE of
the PDU SESSION RELEASE COMMAND message to \"No procedure transaction identity
assigned\".
If the PDU session ID included in PDU SESSION RELEASE COMMAND message is
associated with one or more multicast MBS sessions and either the Access type
IE is not included or the Access type IE indicates \"3GPP access\", the SMF
shall consider the UE as removed from the associated multicast MBS sessions.
Based on the local policy and user\'s subscription data, if the SMF decides to
release the PDU session after determining:
a) the UE has moved between a tracking area in NB-N1 mode and a tracking area
in WB-N1 mode;
b) the UE has moved between a tracking area in NB-S1 mode and a tracking area
in WB-N1 mode;
c) the UE has moved between a tracking area in WB-S1 mode and a tracking area
in NB-N1 mode; or
d) a PDU session is not only for control plane CIoT 5GS optimization any more,
the SMF shall:
a) include the 5GSM cause value #39 \"reactivation requested\" in the 5GSM
cause IE of the PDU SESSION RELEASE COMMAND message; or
b) include a 5GSM cause value other than #39 \"reactivation requested\" in the
5GSM cause IE of the PDU SESSION RELEASE COMMAND message.
NOTE: The included 5GSM cause value is up to the network implementation.
If the SMF receives UE presence in LADN service area from the AMF indicating
that the UE is out of the LADN service area and the SMF decides to release the
PDU session, the SMF shall include the 5GSM cause value #46 \"out of LADN
service area\" in the 5GSM cause IE of the PDU SESSION RELEASE COMMAND
message. Upon receipt of the 5GSM cause value #46 \"out of LADN service area\"
in the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message, the UE shall
release the PDU session.
The SMF may include a Back-off timer value IE in the PDU SESSION RELEASE
COMMAND message when the 5GSM cause value #26 \"insufficient resources\" is
included in the PDU SESSION RELEASE COMMAND message. If the 5GSM cause value
is #26 \"insufficient resources\" and the PDU SESSION RELEASE COMMAND message
is sent to a UE configured for high priority access in selected PLMN or the
request type was set to \"initial emergency request\" or \"existing emergency
PDU session\" for the establishment of the PDU session, the network shall not
include a Back-off timer value IE.
The SMF may include a Back-off timer value IE in the PDU SESSION RELEASE
COMMAND message when the 5GSM cause value #67 \"insufficient resources for
specific slice and DNN\" is included in the PDU SESSION RELEASE COMMAND
message. If the 5GSM cause value is #67 \"insufficient resources for specific
slice and DNN\" and the PDU SESSION RELEASE COMMAND message is sent to a UE
configured for high priority access in selected PLMN or the request type was
set to \"initial emergency request\" or \"existing emergency PDU session\" for
the establishment of the PDU session, the network shall not include a Back-off
timer value IE.
The SMF may include a Back-off timer value IE in the PDU SESSION RELEASE
COMMAND message when the 5GSM cause #69 \"insufficient resources for specific
slice\" is included in the PDU SESSION RELEASE COMMAND message. If the 5GSM
cause value is #69 \"insufficient resources for specific slice\" and the PDU
SESSION RELEASE COMMAND message is sent to a UE configured for high priority
access in selected PLMN or the request type was set to \"initial emergency
request\" or \"existing emergency PDU session\" for the establishment of the
PDU session, the network shall not include a Back-off timer value IE.
The SMF should include a Back-off timer value IE in the PDU SESSION RELEASE
COMMAND message when the 5GSM cause value #29 \"user authentication or
authorization failed\" is included in the PDU SESSION RELEASE COMMAND message.
If the service-level-AA procedure is triggered for the established PDU session
for UAS services with re-authentication purpose, and the SMF is informed by
the UAS-NF that UUAA-SM is unsuccessful or if the SMF receives UUAA revocation
notification message from the UAS-NF as described in 3GPP TS 23.256 [6AB], the
SMF shall transmit the PDU SESSION RELEASE COMMAND message to the UE,
including:
a) the service-level-AA response in the Service-level-AA container IE, with
the SLAR field set to the value of \"Service level authentication and
authorization was not successful or service level authorization is revoked\";
and
b) the 5GSM cause value #29 \"user authentication or authorization failed\" in
the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message.
If the PDU session was established for C2 communication and the SMF is
informed by UAS-NF that C2 authorization is revoked, the SMF shall include:
a) the service-level-AA response with the value of the C2AR field set to the
\"C2 authorization was not successful or C2 authorization is revoked\" in the
service-level-AA container IE of the PDU SESSION RELEASE COMMAND message, and
b) the 5GSM cause value #29 \"user authentication or authorization failed\" in
the 5GSM cause IE of the PDU SESSION RELEASE COMMAND message.
The SMF shall send:
a) the PDU SESSION RELEASE COMMAND message; and
b) the N1 SM delivery skip allowed indication:
1) if the SMF allows the AMF to skip sending the N1 SM container to the UE and
the 5GSM cause IE is not set to #39 \"reactivation requested\"; or
2) if the SMF allows the AMF to skip sending the N1 SM container to the UE and
the Access type IE is not included
towards the AMF, and the SMF shall start timer T3592 (see example in figure
6.3.3.2.1).
Figure 6.3.3.2.1: Network-requested PDU session release procedure
#### 6.3.3.3 Network-requested PDU session release procedure accepted by the
UE
For a single access PDU session, upon receipt of a PDU SESSION RELEASE COMMAND
message and a PDU session ID, using the NAS transport procedure as specified
in subclause 5.4.5, the UE considers the PDU session as released and the UE
shall create a PDU SESSION RELEASE COMPLETE message.
For an MA PDU session, upon receipt of the PDU SESSION RELEASE COMMAND, the UE
shall behave as follows:
a) if the PDU SESSION RELEASE COMMAND includes the Access type IE and the MA
PDU session has user-plane resources established on both 3GPP access and
non-3GPP access, the UE shall consider the user-plane resources on the access
indicated in the Access type IE as released and shall create a PDU SESSION
RELEASE COMPLETE message. If the Access type IE indicates \"3GPP access\" and
there is one or more multicast MBS sessions associated with the MA PDU
session, the UE shall locally leave these associated multicast MBS sessions;
b) if the PDU SESSION RELEASE COMMAND includes the Access type IE and the MA
PDU session has user-plane resources established on only the access indicated
in the Access type IE, the UE shall consider the MA PDU session as released
and shall create a PDU SESSION RELEASE COMPLETE message; and
c) if the PDU SESSION RELEASE COMMAND does not include the Access type IE, the
UE shall consider the MA PDU session as released and shall create a PDU
SESSION RELEASE COMPLETE message.
If there is one or more multicast MBS sessions associated with the PDU session
the UE considers as released, the UE shall locally leave these associated
multicast MBS sessions.
If the PDU SESSION RELEASE COMMAND message contains the PTI value allocated in
the UE-requested PDU session release procedure, the UE shall stop the timer
T3582. The UE should ensure that the PTI value assigned to this procedure is
not released immediately.
NOTE 1: The way to achieve this is implementation dependent. For example, the
UE can ensure that the PTI value assigned to this procedure is not released
during the time equal to or greater than the default value of timer T3592.
While the PTI value is not released, the UE regards any received PDU SESSION
RELEASE COMMAND message with the same PTI value as a network retransmission
(see subclause 7.3.1).
If the PDU SESSION RELEASE COMMAND message includes 5GSM cause #39
\"reactivation requested\", then after completion of the network-requested PDU
session release procedure, the UE should re-initiate the UE-requested PDU
session establishment procedure as specified in subclause 6.4.1 for:
a) the PDU session type associated with the released PDU session;
b) the SSC mode associated with the released PDU session;
c) the DNN associated with the released PDU session; and
d) the S-NSSAI associated with (if available in roaming scenarios) a mapped
S-NSSAI if provided in the UE-requested PDU session establishment procedure of
the released PDU session.
NOTE 2: User interaction is necessary in some cases when the UE cannot re-
initiate the UE-requested PDU session establishment procedure automatically.
If the PDU SESSION RELEASE COMMAND message is received without the Back-off
timer value IE or includes 5GSM cause #39 \"reactivation requested\", and the
UE provided an S-NSSAI during the PDU session establishment, the UE shall stop
timer T3585 if it is running for the S-NSSAI of the PDU session. If the UE did
not provide an S-NSSAI during the PDU session establishment and the request
type was different from \"initial emergency request\" and different from
\"existing emergency PDU session\", the UE shall stop the timer T3585
associated with no S-NSSAI if it is running. If the PDU SESSION RELEASE
COMMAND message was received for an emergency PDU session, the UE shall not
stop the timer T3585 associated with no S-NSSAI if it is running. The timer
T3585 to be stopped includes the timer T3585 applied for all the PLMNs, if
running, and the timer T3585 applied for the registered PLMN, if running.
If the PDU SESSION RELEASE COMMAND message is received without the Back-off
timer value IE or includes 5GSM cause #39 \"reactivation requested\", and the
UE provided a DNN during the PDU session establishment, the UE shall stop
timer T3396 if it is running for the DNN provided by the UE. If the UE did not
provide a DNN during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop the timer T3396 associated with no
DNN if it is running. If the PDU SESSION RELEASE COMMAND message was received
for an emergency PDU session, the UE shall not stop the timer T3396 associated
with no DNN if it is running.
If the PDU SESSION RELEASE COMMAND message is received without the Back-off
timer value IE or includes 5GSM cause #39 \"reactivation requested\", and the
UE provided an S-NSSAI and a DNN during the PDU session establishment, the UE
shall stop timer T3584 if it is running for the [S-NSSAI of the PDU session,
DNN] combination provided by the UE. If the UE did not provide an S-NSSAI
during the PDU session establishment, the UE shall stop the timer T3584
associated with [no S-NSSAI, DNN] if it is running. If the UE did not provide
a DNN during the PDU session establishment and the request type was different
from \"initial emergency request\" and different from \"existing emergency PDU
session\", the UE shall stop the timer T3584 associated with [S-NSSAI of the
PDU session, no DNN] combination, if it is running. If the PDU SESSION RELEASE
COMMAND message was received for an emergency PDU session, the UE shall not
stop the timer T3584 associated with [S-NSSAI of the PDU session, no DNN] if
it is running. If the UE provided neither a DNN nor an S-NSSAI during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop the timer T3584 associated with [no S-NSSAI, no DNN] if it is
running. If the PDU SESSION RELEASE COMMAND message was received for an
emergency PDU session, the UE shall not stop the timer T3584 associated with
[no S-NSSAI, no DNN] if it is running. The timer T3584 to be stopped includes
the timer T3584 applied for all the PLMNs, if running, and the timer T3584
applied for the registered PLMN, if running.
NOTE 3: If the PDU SESSION RELEASE COMMAND message is received without the
Back-off timer value IE or includes 5GSM cause #39 \"reactivation requested\"
for a PDU session, the UE provided a DNN (or no DNN) and an S-NSSAI (or no
S-NSSAI) when the PDU session is established, timer T3396 associated with the
DNN (or no DNN, if no DNN was provided by the UE) is running, and timer T3584
associated with the DNN (or no DNN, if no DNN was provided by the UE) and the
S-NSSAI of the PDU session (or no S-NSSAI, if no S-NSSAI was provided by the
UE) is running, then the UE stops both the timer T3396 and the timer T3584.
NOTE 4: If the PDU SESSION RELEASE COMMAND message is received without the
Back-off timer value IE or includes 5GSM cause #39 \"reactivation requested\"
for a PDU session, the UE provided a DNN (or no DNN) and an S-NSSAI of the PDU
session (or no S-NSSAI) when the PDU session is established, timer T3585
associated with the S-NSSAI of the PDU session (or no S-NSSAI, if no S-NSSAI
was provided by the UE) is running, and timer T3584 associated with the DNN
(or no DNN, if no DNN was provided by the UE) and the S-NSSAI of the PDU
session (or no S-NSSAI, if no S-NSSAI was provided by the UE) is running, then
the UE stops both the timer T3585 and the timer T3584.
If the PDU SESSION RELEASE COMMAND message includes 5GSM cause #26
\"insufficient resources\" and the Back-off timer value IE, the UE shall
ignore the 5GSM congestion re-attempt indicator IE provided by the network, if
any, and the UE shall take different actions depending on the timer value
received for timer T3396 in the Back-off timer value:
a) If the timer value indicates neither zero nor deactivated and a DNN was
provided during the PDU session establishment, the UE shall stop timer T3396
associated with the corresponding DNN, if it is running. If the timer value
indicates neither zero nor deactivated and no DNN was provided during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3396 associated with no DNN if it is running. The UE
shall then start timer T3396 with the value provided in the Back-off timer
value IE and:
1) shall not send a PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for the same DNN that was sent by the UE, until timer T3396 expires
or timer T3396 is stopped; and
2) shall not send a PDU SESSION ESTABLISHMENT REQUEST message without an DNN
and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or a PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without an DNN provided
by the UE, if no DNN was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", until timer T3396 expires or timer
T3396 is stopped.
The UE shall not stop timer T3396 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated and a DNN was
provided during the PDU session establishment, the UE shall stop timer T3396
associated with the corresponding DNN, if it is running. If the timer value
indicates that this timer is deactivated and no DNN was provided during the
PDU session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3396 associated with no DNN if it is running. The UE:
1) shall not send a PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for the same DNN until the UE is switched off, the USIM is removed,
the entry in the \"list of subscriber data\" for the current SNPN is updated,
or the UE receives a PDU SESSION MODIFICATION COMMAND message for the same DNN
from the network, or a PDU SESSION AUTHENTICATION COMMAND message for the same
DNN, or a PDU SESSION RELEASE COMMAND message without the Back-off timer value
IE or including 5GSM cause #39 \"reactivation requested\" for the same DNN
from the network; and
2) shall not send a PDU SESSION ESTABLISHMENT REQUEST message without a DNN
and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or a PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without a DNN provided by
the UE, if no DNN was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", until the UE is switched off, the
USIM is removed, the entry in the \"list of subscriber data\" for the current
SNPN is updated, or the UE receives a PDU SESSION MODIFICATION COMMAND message
for a non-emergency PDU session established without an DNN provided by the UE,
or a PDU SESSION AUTHENTICATION COMMAND message for a non-emergency PDU
session established without a DNN provided by the UE, or a PDU SESSION RELEASE
COMMAND message without the Back-off timer value IE or including 5GSM cause
#39 \"reactivation requested\" for a non-emergency PDU session established
without a DNN provided by the UE.
The timer T3396 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero, the UE:
1) shall stop timer T3396 associated with the corresponding DNN, if running,
and may send a PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message for the same DNN; and
2) if no DNN was provided during the PDU session establishment and the request
type was different from \"initial emergency request\" and different from
\"existing emergency PDU session\", the UE shall stop timer T3396 associated
with no DNN, if running, and may send a PDU SESSION ESTABLISHMENT REQUEST
message without a DNN, or a PDU SESSION MODIFICATION REQUEST message without
an DNN provided by the UE.
If the PDU SESSION RELEASE COMMAND message includes 5GSM cause #26
\"insufficient resources\" and the Back-off timer value IE is not included,
then the UE may send a PDU SESSION ESTABLISHMENT REQUEST message or PDU
SESSION MODIFICATION REQUEST message for the same DNN or without a DNN.
When the timer T3396 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3396 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" for the SNPN to which timer T3396
is associated (if any) is not updated, then timer T3396 is kept running until
it expires or it is stopped.
If the UE is switched off when the timer T3396 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" for the SNPN to which timer T3396 is associated (if any) is not updated
when the UE is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3396 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If the 5GSM cause value is #39 \"reactivation requested\", the UE shall ignore
the Back-off timer value IE and 5GSM congestion re-attempt indicator IE
provided by the network, if any.
If the 5GSM cause value is #67 \"insufficient resources for specific slice and
DNN\" and the Back-off timer value IE is included, the UE shall take different
actions depending on the timer value received for timer T3584 in the Back-off
timer value:
a) If the timer value indicates neither zero nor deactivated, and both an
S-NSSAI and a DNN were provided by the UE during the PDU session establishment
the UE shall stop timer T3584 associated with the [S-NSSAI of the PDU session,
DNN] combination, if it is running. If the timer value indicates neither zero
nor deactivated, an S-NSSAI and no DNN was provided during the PDU session
establishment and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\", the UE shall
stop timer T3584 associated with [S-NSSAI of the PDU session, no DNN]
combination, if it is running. If the timer value indicates neither zero nor
deactivated, no S-NSSAI and a DNN was provided during the PDU session
establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI,
DNN] combination, if it is running. If the timer value indicates neither zero
nor deactivated and neither S-NSSAI nor DNN was provided during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3584 associated with the [no S-NSSAI, no DNN]
combination, if it is running. The timer T3584 to be stopped includes the
timer T3584 applied for all the PLMNs, if running, and the timer T3584 applied
for the registered PLMN, if running. The UE shall then start timer T3584 with
the value provided in the Back-off timer value IE.
1) The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message
with request type different from \"initial emergency request\" and different
from \"existing emergency PDU session\", or PDU SESSION MODIFICATION REQUEST
message with the exception of those identified in subclause 6.4.2.1, for the
[S-NSSAI of the PDU session, DNN] combination, until timer T3584 expires or
timer T3584 is stopped;
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with the exception of those identified in subclause 6.4.2.1,
for the [S-NSSAI of the PDU session, no DNN] combination, if no DNN was
provided during the PDU session establishment, until timer T3584 expires or
timer T3584 is stopped;
3) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or
another PDU SESSION MODIFICATION REQUEST message with the exception of those
identified in subclause 6.4.2.1, for the same [no S-NSSAI, DNN] combination,
if no S-NSSAI was provided during the PDU session establishment, until timer
T3584 expires or timer T3584 is stopped; and
4) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with the exception of those identified in subclause 6.4.2.1,
for the same [no S-NSSAI, no DNN] combination, if neither S-NSSAI nor DNN was
provided during the PDU session establishment, until timer T3584 expires or
timer T3584 is stopped.
The UE shall not stop timer T3584 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated:
1) if both S-NSSAI and DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of
the PDU session, DNN] combination (including the timer T3584 applied for all
the PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE shall not send another PDU SESSION
ESTABLISHMENT REQUEST message with request type different from \"initial
emergency request\" and different from \"existing emergency PDU session\", or
PDU SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the [S-NSSAI of the PDU session, DNN] combination that
was sent by the UE, until the UE is switched off, the USIM is removed, the
entry in the \"list of subscriber data\" for the current SNPN is updated, or
the UE receives a PDU SESSION MODIFICATION COMMAND message for the [S-NSSAI of
the PDU session, DNN] combination from the network, or a PDU SESSION
AUTHENTICATION COMMAND message for the [S-NSSAI of the PDU session, DNN]
combination from the network, or a PDU SESSION RELEASE COMMAND message without
the Back-off timer value IE or including 5GSM cause #39 \"reactivation
requested\" for the [S-NSSAI of the PDU session, DNN] combination from the
network;
2) if an S-NSSAI was provided but a DNN was not provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[S-NSSAI of the PDU session, no DNN] combination (including the timer T3584
applied for all the PLMNs, if running, and the timer T3584 applied for the
registered PLMN, if running), if it is running. The UE shall not send a PDU
SESSION ESTABLISHMENT REQUEST message with request type different from
\"initial emergency request\" and different from \"existing emergency PDU
session\", or a PDU SESSION MODIFICATION REQUEST message with exception of
those identified in subclause 6.4.2.1, for the [S-NSSAI of the PDU session, no
DNN] combination, if no DNN was provided during the PDU session establishment,
until the UE is switched off, the USIM is removed, the entry in the \"list of
subscriber data\" for the current SNPN is updated, or the UE receives an PDU
SESSION MODIFICATION COMMAND message for a non-emergency PDU session
established for the [S-NSSAI of the PDU session, no DNN] combination from the
network, or a PDU SESSION AUTHENTICATION COMMAND message for a non-emergency
PDU session established the [S-NSSAI of the PDU session, DNN] combination from
the network, or a PDU SESSION RELEASE COMMAND message without the Back-off
timer value IE or including 5GSM cause #39 \"reactivation requested\" for a
non-emergency PDU session established for the [S-NSSAI of the PDU session, no
DNN] combination from the network;
3) if an S-NSSAI was not provided but a DNN was provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[no S-NSSAI, DNN] combination (including the timer T3584 applied for all the
PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE shall not send a PDU SESSION ESTABLISHMENT
REQUEST message, or a PDU SESSION MODIFICATION REQUEST message with exception
of those identified in subclause 6.4.2.1, for the [no S-NSSAI, DNN], if no
S-NSSAI was provided during the PDU session establishment, until the UE is
switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated, or the UE receives an PDU SESSION
MODIFICATION COMMAND message for the [no S-NSSAI, DNN] combination from the
network, or a PDU SESSION AUTHENTICATION COMMAND message for the [no S-NSSAI,
DNN] combination from the network, or a PDU SESSION RELEASE COMMAND message
without the Back-off timer value IE or including 5GSM cause #39 \"reactivation
requested\" for the same [no S-NSSAI, DNN] combination from the network; and
4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI,
no DNN] combination (including the timer T3584 applied for all the PLMNs, if
running, and the timer T3584 applied for the registered PLMN, if running), if
it is running. The UE shall not send a PDU SESSION ESTABLISHMENT REQUEST
message with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or a PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for the [no S-NSSAI, no DNN] combination, if neither S-NSSAI nor DNN
was provided during the PDU session establishment, until the UE is switched
off, the USIM is removed, the entry in the \"list of subscriber data\" for the
current SNPN is updated, or the UE receives an PDU SESSION MODIFICATION
COMMAND message for a non-emergency PDU session established for the [no
S-NSSAI, no DNN] combination from the network, or a PDU SESSION AUTHENTICATION
COMMAND message for a non-emergency PDU session established for the [no
S-NSSAI, no DNN] combination from the network or a PDU SESSION RELEASE COMMAND
message without the Back-off timer value IE or including 5GSM cause #39
\"reactivation requested\" for a non-emergency PDU session established for the
[no S-NSSAI, no DNN] combination from the network.
The timer T3584 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero:
1) if both S-NSSAI and DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of
the PDU session, DNN] combination (including the timer T3584 applied for all
the PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if running, and may send another PDU SESSION ESTABLISHMENT REQUEST
message or PDU SESSION MODIFICATION REQUEST message for the [S-NSSAI of the
PDU session, DNN] combination;
2) if an S-NSSAI was provided but a DNN was not provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[S-NSSAI of the PDU session, no DNN] combination (including the timer T3584
applied for all the PLMNs, if running, and the timer T3584 applied for the
registered PLMN, if running), if it is running. The UE may send another PDU
SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST
message for the [S-NSSAI of the PDU session, no DNN] combination if the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\";
3) if an S-NSSAI was not provided but a DNN was provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[no S-NSSAI, DNN] combination (including the timer T3584 applied for all the
PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE may send another PDU SESSION ESTABLISHMENT
REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [no
S-NSSAI, DNN] combination; and
4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI,
no DNN] combination (including the timer T3584 applied for all the PLMNs, if
running, and the timer T3584 applied for the registered PLMN, if running), if
it is running. The UE may send another PDU SESSION ESTABLISHMENT REQUEST
message, or PDU SESSION MODIFICATION REQUEST message for the [no S-NSSAI, no
DNN] combination if the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\".
If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The
back-off timer is applied in all PLMNs\" is included in the PDU SESSION
RELEASE COMMAND message with the 5GSM cause value #67 \"insufficient resources
for specific slice and DNN\", then the UE shall apply the timer T3584 for all
the PLMNs. Otherwise, the UE shall apply the timer T3584 for the registered
PLMN.
If the 5GSM cause value is #67 \"insufficient resources for specific slice and
DNN\" and the Back-off timer value IE is not included, then the UE may send
another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION
REQUEST message for the same [S-NSSAI, DNN] combination.
When the timer T3584 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3584 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" for the SNPN to which timer T3584
is associated (if any) is not updated, then timer T3584 is kept running until
it expires or it is stopped.
If the UE is switched off when the timer T3584 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" for the SNPN to which timer T3584 is associated (if any) is not updated
when the UE is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3584 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If the 5GSM cause value is #69 \"insufficient resources for specific slice\"
and the Back-off timer value IE is included, the UE shall take different
actions depending on the timer value received for timer T3585 in the Back-off
timer value:
a) If the timer value indicates neither zero nor deactivated and an S-NSSAI
was provided during the PDU session establishment, the UE shall stop timer
T3585 associated with the S-NSSAI of the PDU session, if it is running. If the
timer value indicates neither zero nor deactivated and no S-NSSAI was provided
during the PDU session establishment and the request type was different from
\"initial emergency request\" and different from \"existing emergency PDU
session\", the UE shall stop timer T3585 associated with no S-NSSAI if it is
running. The timer T3585 to be stopped includes the timer T3585 applied for
all the PLMNs, if running, and the timer T3585 applied for the registered
PLMN, if running. The UE shall then start timer T3585 with the value provided
in the Back-off timer value IE and:
1) if an S-NSSAI was provided by the UE during the PDU session establishment,
the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or
PDU SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the S-NSSAI of the PDU session, until timer T3585
expires or timer T3585 is stopped; and
2) if the request type was different from \"initial emergency request\" and
from \"existing emergency PDU session\", and an S-NSSAI was not provided by
the UE during the PDU session establishment, the UE shall not send another PDU
SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with request type
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", or another PDU SESSION MODIFICATION REQUEST message
with exception of those identified in subclause 6.4.2.1, for a non-emergency
PDU session established without an S-NSSAI provided by the UE, until timer
T3585 expires or timer T3585 is stopped.
The UE shall not stop timer T3585 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated and an S-NSSAI
was provided during the PDU session establishment, the UE shall stop timer
T3585 associated with the S-NSSAI of the PDU session, if it is running. If the
timer value indicates that this timer is deactivated and no S-NSSAI was
provided during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop timer T3585 associated with no
S-NSSAI if it is running. The timer T3585 to be stopped includes the timer
T3585 applied for all the PLMNs, if running, and the timer T3585 applied for
the registered PLMN, if running. In addition:
1) if an S-NSSAI was provided by the UE during the PDU session establishment,
the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST, or PDU
SESSION MODIFICATION REQUEST with exception of those identified in subclause
6.4.2.1, for the S-NSSAI of the PDU session until the UE is switched off, the
USIM is removed, the entry in the \"list of subscriber data\" for the current
SNPN is updated, or a PDU SESSION MODIFICATION COMMAND message for the S-NSSAI
of the PDU session from the network, or a PDU SESSION AUTHENTICATION COMMAND
message for the S-NSSAI of the PDU session from the network, or a PDU SESSION
RELEASE COMMAND message without the Back-off timer value IE or including 5GSM
cause #39 \"reactivation requested\" for the S-NSSAI of the PDU session from
the network; and
2) if the request type was different from \"initial emergency request\" and
from \"existing emergency PDU session\", and an S-NSSAI was not provided by
the UE during the PDU session establishment, the UE shall not send another PDU
SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with request type
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", or another PDU SESSION MODIFICATION REQUEST message
with exception of those identified in subclause 6.4.2.1, for a non-emergency
PDU session established without an S-NSSAI provided by the UE, , until the UE
is switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated, or a PDU SESSION MODIFICATION COMMAND
message for a non-emergency PDU session established without an S-NSSAI
provided by the UE, or a PDU SESSION AUTHENTICATION COMMAND message for a non-
emergency PDU session established without an S-NSSAI provided by the UE, or a
PDU SESSION RELEASE COMMAND message without the Back-off timer value IE or
including 5GSM cause #39 \"reactivation requested\" for a non-emergency PDU
session established without an S-NSSAI provided by the UE.
The timer T3585 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero:
1) if an S-NSSAI was provided by the UE during the PDU session establishment,
the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session
(including the timer T3585 applied for all the PLMNs, if running, and the
timer T3585 applied for the registered PLMN, if running), if running, and may
send another PDU SESSION ESTABLISHMENT REQUEST, or PDU SESSION MODIFICATION
REQUEST message for the S-NSSAI of the PDU session; and
2) if no S-NSSAI was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", the UE shall stop timer T3585
associated with no S-NSSAI (including the timer T3585 applied for all the
PLMNs, if running, and the timer T3585 applied for the registered PLMN, if
running), if running, and may send another PDU SESSION ESTABLISHMENT REQUEST
message without an S-NSSAI, or another PDU SESSION MODIFICATION REQUEST
message without an S-NSSAI provided by the UE.
If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The
back-off timer is applied in all PLMNs\" is included in the PDU SESSION
RELEASE COMMAND message with the 5GSM cause value #69 \"insufficient resources
for specific slice\", then the UE shall apply the timer T3585 for all the
PLMNs. Otherwise, the UE shall apply the timer T3585 for the registered PLMN.
If the 5GSM cause value is #69 \"insufficient resources for specific slice\"
and the Back-off timer value IE is not included, then the UE may send another
PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST
message for the same S-NSSAI or without an S-NSSAI.
When the timer T3585 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3585 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" for the SNPN to which timer T3585
is associated (if any) is not updated, then timer T3585 is kept running until
it expires or it is stopped.
If the UE is switched off when the timer T3585 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" for the SNPN to which timer T3585 is associated (if any) is not updated
when the UE is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3585 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
NOTE 5: As described in this subclause, upon PLMN change or inter-system
change, the UE does not stop the timer T3584 or T3585. This means the timer
T3584 or T3585 can still be running or be deactivated for the given 5GSM
procedure, the PLMN, the S-NSSAI and optionally the DNN combination when the
UE returns to the PLMN or when it performs inter-system change back from S1
mode to N1 mode. Thus the UE can still be prevented from sending another PDU
SESSION ESTABLISHMENT REQUEST or PDU SESSION MODIFICATION REQUEST message in
the PLMN for the same S-NSSAI and optionally the same DNN.
Upon PLMN change, if T3584 is running or is deactivated for an S-NSSAI, a DNN,
and old PLMN, but T3584 is not running and is not deactivated for the S-NSSAI,
the DNN, and new PLMN, then the UE is allowed to send a PDU SESSION
ESTABLISHMENT REQUEST message for the same S-NSSAI and the same DNN in the new
PLMN.
Upon PLMN change, if T3585 is running or is deactivated for an S-NSSAI and old
PLMN, but T3585 is not running and is not deactivated for the S-NSSAI and new
PLMN, then the UE is allowed to send a PDU SESSION ESTABLISHMENT REQUEST
message for the same S-NSSAI in the new PLMN.
If the PDU SESSION RELEASE COMMAND message includes 5GSM cause #29 \"user
authentication or authorization failed \"and the Back-off timer value IE, the
UE shall behave as follows:
a) if the timer value indicates neither zero nor deactivated and:
1) if the UE provided a DNN and S-NSSAI to the network during the PDU session
establishment, the UE shall start the back-off timer with the value provided
in the Back-off timer value IE for the PDU session establishment procedure and
[PLMN, DNN, (mapped) HPLMN S-NSSAI] combination. The UE shall not send another
PDU SESSION ESTABLISHMENT REQUEST message for the same DNN and (mapped) HPLMN
S-NSSAI in the current PLMN, until the back-off timer expires, the UE is
switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder;
2) if the UE provided a DNN to the network during the PDU session
establishment, the UE shall start the back-off timer with the value provided
in the Back-off timer value IE for the PDU session establishment procedure and
[PLMN, DNN] combination. The UE shall not send another PDU SESSION
ESTABLISHMENT REQUEST message for the same DNN in the current PLMN, until the
back-off timer expires, the UE is switched off, the USIM is removed, or the
entry in the \"list of subscriber data\" for the current SNPN is updated if
the UE does not support access to an SNPN using credentials from a credentials
holder, or the selected entry of the \"list of subscriber data\" is updated if
the UE supports access to an SNPN using credentials from a credentials holder;
3) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to
the network during the PDU session establishment, it shall start the back-off
timer accordingly for the PDU session establishment procedure and the [PLMN,
DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no
S-NSSAI] combination. Dependent on the combination, the UE shall not send
another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no
S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI]
combination in the current PLMN, until the back-off timer expires, the UE is
switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder; or
4) if the UE did not provide a DNN to the network during the PDU session
establishment, it shall start the back-off timer accordingly for the PDU
session establishment procedure and the [PLMN, no DNN] combination. The UE
shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same
[PLMN, no DNN] in the current PLMN, until the back-off timer expires, the UE
is switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder;
b) if the timer value indicates that this timer is deactivated and:
1) if the UE provided a DNN and S-NSSAI to the network during the PDU session
establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST
message for the same DNN and (mapped) HPLMN S-NSSAI in the current PLMN, until
the UE is switched off, the USIM is removed, or the entry in the \"list of
subscriber data\" for the current SNPN is updated if the UE does not support
access to an SNPN using credentials from a credentials holder, or the selected
entry of the \"list of subscriber data\" is updated if the UE supports access
to an SNPN using credentials from a credentials holder;
2) if the UE provided a DNN to the network during the PDU session
establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST
message for the same DNN in the current PLMN, until the UE is switched off,
the USIM is removed, or the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder;
3) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to
the network during the PDU session establishment, the UE shall not send
another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no
S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI]
combination in the current PLMN, until the UE is switched off, the USIM is
removed, or the entry in the \"list of subscriber data\" for the current SNPN
is updated if the UE does not support access to an SNPN using credentials from
a credentials holder, or the selected entry of the \"list of subscriber data\"
is updated if the UE supports access to an SNPN using credentials from a
credentials holder; or
4) if the UE did not provide a DNN to the network during the PDU session
establishment, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST
message for the same [PLMN, no DNN] in the current PLMN, until the UE is
switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder; and
c) if the timer value indicates zero, the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message for the same combination of [PLMN, DNN, (mapped)
HPLMN S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN
S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the current PLMN.
The UE shall not stop any back-off timer:
a) upon a PLMN change;
b) upon an inter-system change; or
c) upon registration over another access type.
If the PDU SESSION RELEASE COMMAND message includes:
a) 5GSM cause #29 \"user authentication or authorization failed\"; and
b) the service-level-AA response in the Service-level-AA container IE with the
SLAR field set to the value of \"Service level authentication and
authorization was not successful or service level authorization is revoked\",
the UE shall forward the service-level-AA response to the upper layers, so the
UUAA authorization data is deleted as specified in 3GPP TS 33.256 [24B].
The UE shall transport the PDU SESSION RELEASE COMPLETE message and the PDU
session ID, using the NAS transport procedure as specified in subclause 5.4.5.
Upon receipt of a PDU SESSION RELEASE COMPLETE message, the SMF shall stop
timer T3592 and shall consider the PDU session as released.
#### 6.3.3.4 N1 SM delivery skipped
If the PDU SESSION RELEASE COMMAND message was sent along the N1 SM delivery
skip allowed indication towards AMF, then upon receipt of an indication that
N1 SM delivery was skipped, the SMF shall stop timer T3592 and shall consider
the PDU session as released.
#### 6.3.3.5 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Expiry of timer T3592.
The SMF shall, on the first expiry of the timer T3592, retransmit the PDU
SESSION RELEASE COMMAND message and shall reset and start timer T3592. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3592, the SMF shall abort the procedure.
b) Collision of network-requested PDU session release procedure and UE-
requested PDU session modification procedure.
When the SMF receives a PDU SESSION MODIFICATION REQUEST message during the
network-requested PDU session release procedure, and the PDU session indicated
in PDU SESSION MODIFICATION REQUEST message is the PDU session that the SMF
had requested to release, the SMF shall ignore the PDU SESSION MODIFICATION
REQUEST message and proceed with the PDU session release procedure.
c) Collision of network-requested PDU session release procedure and UE-
requested PDU session release procedure.
If the SMF receives a PDU SESSION RELEASE REQUEST message after sending a PDU
SESSION RELEASE COMMAND message to the UE, and the PDU session ID in the PDU
SESSION RELEASE REQUEST message is the same as the PDU session ID in the PDU
SESSION RELEASE COMMAND message, the SMF shall ignore the PDU SESSION RELEASE
REQUEST message and proceed with the network-requested PDU session release
procedure.
d) Collision of re-establishment of the user-plane resources and network-
requested PDU session release procedure for the same PDU session.
If the SMF receives an indication from the AMF to re-establish the user-plane
resources during the network-requested PDU session release procedure for the
same PDU session, the SMF shall not re-establish the user-plane resources for
the PDU session as specified in 3GPP TS 29.502 [20A] subclause 5.2.2.3.2.2 and
proceed with the network-requested PDU session release procedure.
#### 6.3.3.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) PDU session inactive for the received PDU session ID.
If the PDU session ID in the PDU SESSION RELEASE COMMAND message belongs to
any PDU session in state PDU SESSION INACTIVE in the UE, the UE shall include
the 5GSM cause #43 \"Invalid PDU session identity\" in the 5GSM STATUS
message, and set the PDU session ID to the received PDU session ID in the UL
NAS TRANSPORT message as specified in subclause 5.4.5.
b) User-plane resources of the MA PDU session on the access indicated in the
Access type IE not established.
If the PDU session is an MA PDU session and has user-plane resources
established on a single access different from the access indicated in the
Access type IE, the UE shall not diagnose an error, further process the
release command and consider the user-plane resources of the MA PDU session on
the access indicated in the Access type IE as successfully released.
## 6.4 UE-requested 5GSM procedures
### 6.4.1 UE-requested PDU session establishment procedure
#### 6.4.1.1 General
The purpose of the UE-requested PDU session establishment procedure is to
establish a new PDU session with a DN, to perform handover of an existing PDU
session between 3GPP access and non-3GPP access, to transfer an existing PDN
connection in the EPS to the 5GS, to transfer an existing PDN connection in an
untrusted non-3GPP access connected to the EPC to the 5GS, or to establish an
MA PDU session to support ATSSS (see 3GPP TS 24.193 [13B]), or to relay the
service associated with the RSC for 5G ProSe layer-3 UE-to-network relay (see
3GPP TS 24.554 [19E]). If accepted by the network, the PDU session enables
exchange of PDUs between the UE and the DN.
The UE shall not request a PDU session establishment:
a) for an LADN when the UE is located outside the LADN service area;
b) to transfer a PDU session from non-3GPP access to 3GPP access when the 3GPP
PS data off UE status is \"activated\" and the UE is not using the PDU session
to send uplink IP packets for any of the 3GPP PS data off exempt services (see
subclause 6.2.10);
c) when the UE is in NB-N1 mode, the UE has indicated preference for user
plane CIoT 5GS optimization, the network has accepted the use of user plane
CIoT 5GS optimization for the UE, and the number of PDU sessions that
currently has user-plane resources established equals to the UE\'s maximum
number of supported user-plane resources;
d) to transfer a PDU session from 3GPP access to non-3GPP access when the UE
has indicated preference for control plane CIoT 5GS optimization, the network
has accepted the use of control plane CIoT 5GS optimization for the UE, and
the Control plane only indication IE was received in the PDU SESSION
ESTABLISHMENT ACCEPT message; or
e) to transfer a PDU session from the non-3GPP access to the 3GPP access when
the UE is in NB-N1 mode, the UE has indicated preference for user plane CIoT
5GS optimization, the network has accepted the use of user plane CIoT 5GS
optimization for the UE, and the number of PDU sessions that currently has
user-plane resources established equals to the UE\'s maximum number of
supported user-plane resources.
#### 6.4.1.2 UE-requested PDU session establishment procedure initiation
In order to initiate the UE-requested PDU session establishment procedure, the
UE shall create a PDU SESSION ESTABLISHMENT REQUEST message.
NOTE 0: When IMS voice is available over either 3GPP access or non-3GPP
access, the \"voice centric\" UE in 5GMM-REGISTERED state will receive a
request from upper layers to establish the PDU session for IMS signalling, if
the conditions for performing an initial registration with IMS indicated in
3GPP TS 24.229 [14] subclause U.3.1.2 are satisfied.
If the UE requests to establish a new PDU session, the UE shall allocate a PDU
session ID which is not currently being used by another PDU session over
either 3GPP access or non-3GPP access. If the N5CW device supports 3GPP access
and requests to establish a new PDU session via 3GPP access, the N5CW device
shall refrain from allocating \"PDU session identity value 15\". If the TWIF
acting on behalf of the N5CW device requests to establish a new PDU session,
the TWIF acting on behalf of the N5CW device shall allocate the \"PDU session
identity value 15\".
The UE shall allocate a PTI value currently not used and shall set the PTI IE
of the PDU SESSION ESTABLISHMENT REQUEST message to the allocated PTI value.
If the UE is registered for emergency services over the current access, the UE
shall not request establishing a non-emergency PDU session over the current
access. If the UE is registered for emergency services over the current access
it shall not request establishing an emergency PDU session over the non-
current access except if the request is for transferring the emergency PDU
session to the non-current access. Before transferring an emergency PDU
session from non-3GPP access to 3GPP access, or before transferring a PDN
connection for emergency bearer services from untrusted non-3GPP access
connected to EPC to 3GPP access, the UE shall check whether emergency services
are supported in the NG-RAN cell (either an NR cell or an E-UTRA cell) on
which the UE is camping.
NOTE 1: Transfer of an existing emergency PDU session or PDN connection for
emergency bearer services between 3GPP access and non-3GPP access is needed
e.g. if the UE determines that the current access is no longer available.
If the UE requests to establish a new emergency PDU session, the UE shall
include the PDU session type IE in the PDU SESSION ESTABLISHMENT REQUEST
message and shall set the IE to the IP version capability as specified in
subclause 6.2.4.2.
If the UE requests to establish a new non-emergency PDU session with a DN, the
UE shall include the PDU session type IE in the PDU SESSION ESTABLISHMENT
REQUEST message and shall set the IE to one of the following values: the IP
version capability as specified in subclause 6.2.4.2, \"Ethernet\" or
\"Unstructured\" based on the URSP rules or based on UE local configuration
(see 3GPP TS 24.526 [19]).
NOTE 2: When the UE initiates the UE-requested PDU session establishment
procedure to transfer an existing non-IP PDN connection in the EPS to the 5GS,
the UE can use locally available information associated with the PDN
connection to select the PDU session type between \"Ethernet\" and
\"Unstructured\".
If the UE requests to establish a new non-emergency PDU session with a DN and
the UE requests an SSC mode, the UE shall set the SSC mode IE of the PDU
SESSION ESTABLISHMENT REQUEST message to the SSC mode. If the UE requests to
establish a PDU session of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type,
the UE shall either omit the SSC mode IE or set the SSC mode IE to \"SSC mode
1\", \"SSC mode 2\", or \"SSC mode 3\". If the UE requests to establish a PDU
session of \"Ethernet\" or \"Unstructured\" PDU session type, the UE shall
either omit the SSC mode IE or set the SSC mode IE to \"SSC mode 1\" or \"SSC
mode 2\". If the UE requests transfer of an existing PDN connection in the EPS
to the 5GS or the UE requests transfer of an existing PDN connection in an
untrusted non-3GPP access connected to the EPC to the 5GS, the UE shall set
the SSC mode IE to \"SSC mode 1\".
If the UE requests to establish a new emergency PDU session, the UE shall set
the SSC mode IE of the PDU SESSION ESTABLISHMENT REQUEST message to \"SSC mode
1\".
A UE supporting PDU connectivity service shall support SSC mode 1 and may
support SSC mode 2 and SSC mode 3 as specified in 3GPP TS 23.501 [8].
If the UE requests to establish a new non-emergency PDU session with a DN, the
UE may include the SM PDU DN request container IE with a DN-specific identity
of the UE complying with network access identifier (NAI) format as specified
in IETF RFC 7542 [37].
NOTE 3: The UE can avoid including both the SM PDU DN request container IE and
the extended protocol configuration options IE with PAP/CHAP protocol
identifiers in the PDU SESSION ESTABLISHMENT REQUEST message. The way to
achieve this is implementation dependent.
If the UE requests to:
a) establish a new PDU session;
b) perform handover of an existing PDU session from non-3GPP access to 3GPP
access;
c) transfer an existing PDN connection in the EPS to the 5GS according to
subclause 4.8.2.3.1;
d) transfer an existing PDN connection in untrusted non-3GPP access connected
to the EPC to the 5GS; or
e) establish user plane resources over 3GPP access of an MA PDU session
established over non-3GPP access only;
and the UE at the same time intends to join one or more multicast MBS sessions
that is associated to the PDU session, the UE should include the Requested MBS
container IE in the PDU SESSION ESTABLISHMENT REQUEST message. In that case,
the UE shall set the MBS operation to \"Join multicast MBS session\" and
include the multicast MBS session information(s) and shall set the Type of
multicast MBS session ID for each of the multicast MBS session information to
either \"Temporary Mobile Group Identity (TMGI)\" or \"Source specific IP
multicast address\" depending on the type of the multicast MBS session ID
available in the UE. Then the remaining values of each of the multicast MBS
session information shall be set as following:
a) if the Type of multicast MBS session ID is set to \"Temporary Mobile Group
Identity (TMGI)\", the UE shall set the multicast MBS session ID to the TMGI;
or
b) if the Type of multicast MBS session ID is set to \"Source specific IP
multicast address for IPv4\" or \" Source specific IP multicast address for
IPv6\", the UE shall set the Source IP address information and the Destination
IP address information to the corresponding values.
The UE should not request to join a multicast MBS session for local MBS
service if neither current TAI nor CGI of the current cell is part of the MBS
service area(s) of the multicast MBS session, if the UE has valid information
of the MBS service area(s) of the multicast MBS session.
NOTE 4: The UE obtains the details of the multicast MBS session ID(s) i.e.
TMGI, Source IP address information and Destination IP address information as
a pre-configuration in the UE or during the MBS service announcement, which is
out of scope of this specification.
The UE should set the RQoS bit to \"Reflective QoS supported\" in the 5GSM
capability IE of the PDU SESSION ESTABLISHMENT REQUEST message if the UE
supports reflective QoS and:
a) the UE requests to establish a new PDU session of \"IPv4\", \"IPv6\",
\"IPv4v6\" or \"Ethernet\" PDU session type;
b) the UE requests to transfer an existing PDN connection in the EPS of
\"IPv4\", \"IPv6\", \"IPv4v6\" or \"Ethernet\" PDN type or of \"Non-IP\" PDN
type mapping to \"Ethernet\" PDU session type, to the 5GS; or
c) the UE requests to transfer an existing PDN connection in an untrusted
non-3GPP access connected to the EPC of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDN
type to the 5GS.
NOTE 5: The determination to not request the usage of reflective QoS by the UE
for a PDU session is implementation dependent.
The UE shall indicate the maximum number of packet filters that can be
supported for the PDU session in the Maximum number of supported packet
filters IE of the PDU SESSION ESTABLISHMENT REQUEST message if:
a) the UE requests to establish a new PDU session of \"IPv4\", \"IPv6\",
\"IPv4v6\", or \"Ethernet\" PDU session type, and the UE can support more than
16 packet filters for this PDU session;
b) the UE requests to transfer an existing PDN connection in the EPS of
\"IPv4\", \"IPv6\", \"IPv4v6\", or \"Ethernet\" PDN type or of \"Non-IP\" PDN
type mapping to \"Ethernet\" PDU session type, to the 5GS and the UE can
support more than 16 packet filters for this PDU session; or
c) the UE requests to transfer an existing PDN connection in an untrusted
non-3GPP access connected to the EPC of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDN
type to the 5GS and the UE can support more than 16 packet filters for this
PDU session.
The UE shall include the Integrity protection maximum data rate IE in the PDU
SESSION ESTABLISHMENT REQUEST message to indicate the maximum data rate per UE
for user-plane integrity protection supported by the UE for uplink and the
maximum data rate per UE for user-plane integrity protection supported by the
UE for downlink.
The UE shall set the MH6-PDU bit to \"Multi-homed IPv6 PDU session supported\"
in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message if
the UE supports multi-homed IPv6 PDU session and:
a) the UE requests to establish a new PDU session of \"IPv6\" or \"IPv4v6\"
PDU session type; or.
b) the UE requests to transfer an existing PDN connection of \"IPv6\" or
\"IPv4v6\" PDN type in the EPS or in an untrusted non-3GPP access connected to
the EPC to the 5GS.
The UE shall set the EPT-S1 bit to \"Ethernet PDN type in S1 mode supported\"
in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message if
the UE supports Ethernet PDN type in S1 mode and requests \"Ethernet\" PDU
session type.
If the UE requests to establish a new PDU session as an always-on PDU session
(e.g. because the PDU session is for time synchronization or TSC), the UE
shall include the Always-on PDU session requested IE and set the value of the
IE to \"Always-on PDU session requested\" in the PDU SESSION ESTABLISHMENT
REQUEST message.
NOTE 6: Determining whether a PDU session is for time synchronization or TSC
is UE implementation dependent.
If the UE has an emergency PDU session, the UE shall not perform the UE-
requested PDU session establishment procedure to establish another emergency
PDU session. The UE may perform the UE-requested PDU session establishment
procedure to transfer an existing emergency PDU session or an existing PDN
connection for emergency services.
If:
a) the UE requests to perform handover of an existing PDU session between 3GPP
access and non-3GPP access;
b) the UE requests to perform transfer an existing PDN connection in the EPS
to the 5GS; or
c) the UE requests to perform transfer an existing PDN connection in an
untrusted non-3GPP access connected to the EPC to the 5GS;
the UE shall:
a) set the PDU session ID in the PDU SESSION ESTABLISHMENT REQUEST message and
in the UL NAS TRANSPORT message to the stored PDU session ID corresponding to
the PDN connection; and
b) set the S-NSSAI in the UL NAS TRANSPORT message to the stored S-NSSAI
associated with the PDU session ID of a non-emergency PDU session. The UE
shall not request to perform handover of an existing non-emergency PDU session
between 3GPP access and non-3GPP access if the S-NSSAI is not included in the
allowed NSSAI for the target access.
If the N5CW device supports 3GPP access and requests to perform handover of an
existing PDU session from non-3GPP access to 3GPP access, the N5CW device
shall set the PDU session ID in the PDU SESSION ESTABLISHMENT REQUEST message
and in the UL NAS TRANSPORT message to \"PDU session identity value 15\".
If the UE is registered to a network which supports ATSSS and the UE requests
to establish a new PDU session the UE may allow the network to upgrade the
requested PDU session to an MA PDU session. In order to allow the network to
upgrade the requested PDU session to an MA PDU session, the UE shall set \"MA
PDU session network upgrade is allowed\" in the MA PDU session information IE
and shall set the request type to \"initial request\" in the UL NAS TRANSPORT
message. If the UE is registered to a network which does not support ATSSS,
the UE shall not perform the procedure to allow the network to upgrade the
requested PDU session to an MA PDU session.
If the UE is registered to a network which supports ATSSS, the UE may request
to establish an MA PDU session. If the UE requests to establish an MA PDU
session, the UE shall set the request type to \"MA PDU request\" in the UL NAS
TRANSPORT message. If the UE is registered to a network which does not support
ATSSS, the UE shall not request to establish an MA PDU session.
When the UE is registered over both 3GPP access and non-3GPP access in the
same PLMN and the UE requests to establish a new MA PDU session, the UE may
provide an S-NSSAI in the UL NAS TRANSPORT message only if the S-NSSAI is
included in the allowed NSSAIs of both accesses.
NOTE 7: If the UE requested DNN corresponds to an LADN DNN, the AMF does not
forward the MA PDU session information IE to the SMF but sends the message
back to the UE to inform of the unhandled request (see subclause 5.4.5.2.5).
If the UE is registered to a network which supports ATSSS and the UE has
already an MA PDU session established over one access, the UE may perform the
UE-requested PDU session establishment procedure to establish user-plane
resources over the other access for the MA PDU session as specified in
subclause 4.22 of 3GPP TS 23.502 [9] and the S-NSSAI associated with the MA
PDU session is included in the allowed NSSAI of the other access. If the UE
establishes user-plane resources over the other access for the MA PDU session,
the UE shall:
a) set the request type to \"MA PDU request\" in the UL NAS TRANSPORT message;
b) set the PDU session ID to the stored PDU session ID corresponding to the
established MA PDU session in the PDU SESSION ESTABLISHMENT REQUEST message
and in the UL NAS TRANSPORT message; and
c) set the S-NSSAI in the UL NAS TRANSPORT message to the stored S-NSSAI
associated with the PDU session ID.
If the UE requests to establish a new MA PDU session or if the UE requests to
establish a new PDU session and the UE allows the network to upgrade the
requested PDU session to an MA PDU session:
a) if the UE supports ATSSS Low-Layer functionality with any steering mode as
specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the
ATSSS-ST bits to \"ATSSS Low-Layer functionality with any steering mode
supported\" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST
message;
b) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL
functionality with only active-standby steering mode as specified in subclause
5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP
functionality with any steering mode and ATSSS-LL functionality with only
active-standby steering mode supported\" in the 5GSM capability IE of the PDU
SESSION ESTABLISHMENT REQUEST message;
c) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL
functionality with any steering mode as specified in subclause 5.32.6 of 3GPP
TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP functionality
with any steering mode and ATSSS-LL functionality with any steering mode
supported\" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST
message; and
d) if a performance measurement function in the UE can perform access
performance measurements using the QoS flow of the non-default QoS rule as
specified in subclause 5.32.5 of 3GPP TS 23.501 [8], the UE shall set the
APMQF bit to \"Access performance measurements per QoS flow supported\" in the
5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST message.
Upon receipt of a PDU SESSION ESTABLISHMENT REQUEST message for MA PDU session
establishment, the SMF shall check if the 5GSM capability IE in the PDU
SESSION ESTABLISHMENT REQUEST message, includes:
a) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode and
ATSSS-LL functionality with only active-standby steering mode supported\" and:
i) if the DNN configuration allows for the MPTCP functionality with any
steering mode and ATSSS-LL functionality with any steering mode, the SMF shall
ensure that the established PDU session has the capability of MPTCP with any
steering mode and ATSSS-LL with any steering mode in the downlink and MPTCP
with any steering mode and ATSSS-LL with only active-standby steering mode in
the uplink; or
ii) if the DNN configuration allows for the MPTCP functionality with any
steering mode and ATSSS-LL functionality with only active-standby steering
mode, the SMF shall ensure that the established PDU session has the capability
of MPTCP with any steering mode and ATSSS-LL with only active-standby steering
mode in the downlink and the uplink;
b) the ATSSS-ST bits set to \"ATSSS Low-Layer functionality with any steering
mode allowed for ATSSS-LL supported\" and if the DNN configuration allows for
the ATSSS-LL functionality with any steering mode, the SMF shall ensure that
the established PDU session has the capability of ATSSS-LL with any steering
mode in the downlink and the uplink; or
c) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode and
ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\"
and if the DNN configuration allows for the MPTCP functionality with any
steering mode and ATSSS-LL functionality with any steering mode, the SMF shall
ensure that the established PDU session has the capability of MPTCP with any
steering mode and ATSSS-LL with any steering mode in the downlink and the
uplink.
If the UE requests to establish a new MA PDU session and the UE supports to
establish a PDN connection as the user plane resource of an MA PDU session,
the UE shall include the ATSSS request parameter in the Extended protocol
configuration options IE of the PDU SESSION ESTABLISHMENT REQUEST message.
If the UE is registered to a network which does not support ATSSS and the UE
has already an MA PDU session established over one access, the UE shall not
attempt to establish user-plane resources for the MA PDU session over the
network which does not support ATSSS as specified in subclause 4.22 of 3GPP TS
23.502 [9].
If the UE supports 3GPP PS data off, except for the transfer of a PDU session
from non-3GPP access to 3GPP access and except for the establishment of user
plane resources on the other access for the MA PDU session, the UE shall
include the Extended protocol configuration options IE in the PDU SESSION
ESTABLISHMENT REQUEST message and include the 3GPP PS data off UE status. The
UE behaves as described in subclause 6.2.10.
If the UE supports Reliable Data Service, the UE shall include the Extended
protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST
message and include the Reliable Data Service request indicator. The UE
behaves as described in subclause 6.2.15.
If the UE supports DNS over (D)TLS (see 3GPP TS 33.501 [24]), the UE shall
include the Extended protocol configuration options IE in the PDU SESSION
ESTABLISHMENT REQUEST message and include DNS server security information
indicator and optionally, if the UE wishes to indicate which security protocol
type(s) are supported by the UE, it may include the DNS server security
protocol support.
NOTE 8: Support of DNS over (D)TLS is based on the informative requirements as
specified in 3GPP TS 33.501 [24].
If:
a) the PDU session type value of the PDU session type IE is set to \"IPv4\",
\"IPv6\" or \"IPv4v6\";
b) the UE indicates \"Control plane CIoT 5GS optimization supported\" and \"IP
header compression for control plane CIoT 5GS optimization supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message; and
c) the network indicates \"Control plane CIoT 5GS optimization supported\" and
\"IP header compression for control plane CIoT 5GS optimization supported\" in
the 5GS network support feature IE of the REGISTRATION ACCEPT message;
the UE shall include the IP header compression configuration IE in the PDU
SESSION ESTABLISHMENT REQUEST message.
If:
a) the PDU session type value of the PDU session type IE is set to
\"Ethernet\";
b) the UE indicates \"Control plane CIoT 5GS optimization supported\" and
\"Ethernet header compression for control plane CIoT 5GS optimization
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and
c) the network indicates \"Control plane CIoT 5GS optimization supported\" and
\"Ethernet header compression for control plane CIoT 5GS optimization
supported\" in the 5GS network support feature IE of the REGISTRATION ACCEPT
message;
the UE shall include the Ethernet header compression configuration IE in the
PDU SESSION ESTABLISHMENT REQUEST message.
If the UE supports transfer of port management information containers, the UE
shall:
a) set the TPMIC bit to \"Transfer of port management information containers
supported\" in the 5GSM capability IE of the PDU SESSION ESTABLISHMENT REQUEST
message;
b) if the UE requests to establish a PDU session of \"Ethernet\" PDU session
type , include the DS-TT Ethernet port MAC address IE in the PDU SESSION
ESTABLISHMENT REQUEST message and set its contents to the MAC address of the
DS-TT Ethernet port used for the PDU session;
c) if the UE-DS-TT residence time is available at the UE, include the UE-DS-TT
residence time IE and set its contents to the UE-DS-TT residence time; and
d) if a Port management information container is provided by the DS-TT,
include the Port management information container IE in the PDU SESSION
ESTABLISHMENT REQUEST message.
NOTE 9: Only SSC mode 1 is supported for a PDU session which is for time
synchronization or TSC.
If the UE supporting S1 mode supports receiving QoS rules with the length of
two octets or QoS flow descriptions with the length of two octets via the
Extended protocol configuration options IE, the UE shall include the QoS rules
with the length of two octets support indicator or the QoS flow descriptions
with the length of two octets support indicator, respectively, in the Extended
protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST
message.
If:
\- the UE is operating in single-registration mode;
\- the UE supports local IP address in traffic flow aggregate description and
TFT filter in S1 mode; and
\- the PDU session Type requested is different from \"Unstructured\".
the UE shall indicate the support of local address in TFT in S1 mode in the
Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT
REQUEST message.
If the W-AGF acting on behalf of the FN-RG requests to establish a PDU session
of \"IPv6\" or \"IPv4v6\" PDU session type, the W-AGF acting on behalf of the
FN-RG may include in the PDU SESSION ESTABLISHMENT REQUEST message the
Suggested interface identifier IE with the PDU session type value field set to
\"IPv6\" and containing the interface identifier for the IPv6 link local
address associated with the PDU session suggested to be allocated to the FN-
RG.
If the UE supports provisioning of ECS configuration information to the EEC in
the UE, then the UE shall include the Extended protocol configuration options
IE in the PDU SESSION ESTABLISHMENT REQUEST message and shall include the ECS
configuration information provisioning support indicator.
If the UE supports receiving DNS server addresses in protocol configuration
options, the UE shall include the Extended protocol configuration options IE
in the PDU SESSION ESTABLISHMENT REQUEST message and in the Extended protocol
configuration options IE:
a) if the UE requests to establish a PDU session of \"IPv4\" or \"IPv4v6\" PDU
session type, the UE shall include the DNS server IPv4 address request; and
b) if the UE requests to establish a PDU session of \"IPv6\" or \"IPv4v6\" PDU
session type, the UE shall include the DNS server IPv6 address request.
If the UE supporting UAS services requests to establish a PDU session for C2
communication, the UE shall include the Service-level-AA container IE in the
PDU SESSION ESTABLISHMENT REQUEST message. In the Service-level-AA container
IE, the UE shall include:
a) the service-level device ID with the value set to the CAA-level UAV ID of
the UE; and
b) if available, the service-level-AA payload with the value set to the C2
authorization payload and the service-level-AA payload type with the value set
to \"C2 authorization payload\".
NOTE 10: The C2 authorization payload in the service-level-AA payload can
include the pairing information for C2 communication and the UAV flight
authorization information.
If the UE supports the EAS rediscovery, the UE shall include the Extended
protocol configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST
message and shall include the EAS rediscovery support indication in the
Extended protocol configuration options IE.
If the UE needs to include a PDU session pair ID based on the matching URSP
rule or UE local configuration, the UE shall include the PDU session pair ID
IE in the PDU SESSION ESTABLISHMENT REQUEST message. If the UE needs to
include an RSN based on the matching URSP rule or UE local configuration, the
UE shall include the RSN IE in the PDU SESSION ESTABLISHMENT REQUEST message.
If **the UE is not registered for onboarding services in SNPN and needs PVS
information** , the UE shall include the Extended protocol configuration
options IE in the PDU SESSION ESTABLISHMENT REQUEST message and include the
PVS information request in the Extended protocol configuration options IE.
If the UE supports the EDC, the UE shall include the Extended protocol
configuration options IE in the PDU SESSION ESTABLISHMENT REQUEST message and
shall include the EDC support indicator in the Extended protocol configuration
options IE.
If the UE supports a \"destination MAC address range type\" packet filter
component and a \"source MAC address range type\" packet filter component, the
UE shall include the Extended protocol configuration options IE in the PDU
SESSION ESTABLISHMENT REQUEST message and shall include the MS support of MAC
address range in 5GS indicator in the Extended protocol configuration options
IE.
The UE shall transport:
a) the PDU SESSION ESTABLISHMENT REQUEST message;
b) the PDU session ID of the PDU session being established, being handed over,
being transferred, or been established as an MA PDU session;
c) if the request type is set to:
1) \"initial request\" or \"MA PDU request\" and the UE determined to
establish a new PDU session or an MA PDU session based on either a URSP rule
including one or more S-NSSAIs in the URSP (see subclause 6.2.9) or UE local
configuration, according to subclause 4.2.2 of 3GPP TS 24.526 [19]:
i) if the UE is in the HPLMN or the subscribed SNPN, an S-NSSAI in the allowed
NSSAI which corresponds to one of the S-NSSAI(s) in the matching URSP rule, if
any, or else to the S-NSSAI(s) in the UE local configuration or in the default
URSP rule, if any, according to the conditions given in subclause 4.2.2 of
3GPP TS 24.526 [19];
ii) if the UE is in a non-subscribed SNPN, the UE determined according to the
conditions given in subclause 4.2.2 of 3GPP TS 24.526 [19] to establish a new
PDU session or an MA PDU session based on a URSP rule including one or more
S-NSSAIs, and the URSP rule is a part of a non-subscribed SNPN signalled URSP
(see 3GPP TS 24.526 [19]):
A) an S-NSSAI in the allowed NSSAI, which is one of the S-NSSAI(s) in the URSP
rule; and
B) a mapped S-NSSAI associated with the S-NSSAI in A); or
iii) otherwise:
A) one of the mapped S-NSSAI(s) which is equal to one of the S-NSSAI(s) in the
matching URSP rule, if any, or else to the S-NSSAI(s) in the UE local
configuration or in the default URSP rule, if any, according to the conditions
given in subclause 4.2.2 of 3GPP TS 24.526 [19]; and
B) the S-NSSAI in the allowed NSSAI associated with the mapped S-NSSAI in A);
or
NOTE 11: When the UE is roaming, an AMF compliant with earlier versions of the
specification can omit providing to the UE a mapped S-NSSAI for one or more
S-NSSAIs in the allowed NSSAI and the UE then locally sets the mapped S-NSSAI
as described in clause 4.6.2.1.
1a) \"initial request\" and the UE determined to establish a new PDU session
based on the PDU session parameters for 5G ProSe layer-3 UE-to-network relay
UE including an S-NSSAI in the UE policies for 5G ProSe UE-to-network relay UE
as defined in 3GPP TS 24.555 [19F]:
i) in case of a non-roaming scenario, an S-NSSAI in the allowed NSSAI which
corresponds to the S-NSSAI in the selected PDU session parameters for 5G ProSe
layer-3 UE-to-network relay UE, if any; or
ii) in case of a roaming scenario:
A) one of the mapped S-NSSAI(s) which corresponds to the S-NSSAI in the
selected PDU session parameters for 5G ProSe layer-3 UE-to-network relay UE,
if any; and
B) the S-NSSAI in the allowed NSSAI associated with the S-NSSAI in A); or
2) \"existing PDU session\", an S-NSSAI, which is an S-NSSAI associated with
the PDU session and (in roaming scenarios) a mapped S-NSSAI, with exception
when S-NSSAI is not provided by the network in subclause 6.1.4.2;
d) if the request type is set to:
1) \"initial request\" or \"MA PDU request\" and the UE determined to
establish a new PDU session or an MA PDU session based on either a URSP rule
including one or more DNNs in the URSP (see subclause 6.2.9) or UE local
configuration, according to subclause 4.2.2 of 3GPP TS 24.526 [19], a DNN
which corresponds to one of the DNN(s) in the matching URSP rule, if any, or
else to the DNN(s) in the UE local configuration or in the default URSP rule,
if any, according to the conditions given in subclause 4.2.2 of 3GPP TS 24.526
[19];
1a) \"initial request\" and the UE determined to establish a new PDU session
based on the PDU session parameters for 5G ProSe layer-3 UE-to-network relay
UE including a DNN in the UE policies for 5G ProSe UE-to-network relay UE as
defined in 3GPP TS 24.555 [19F], a DNN which corresponds to the DNN in the
selected PDU session parameters for 5G ProSe layer-3 UE-to-network relay UE,
if any; or
2) \"existing PDU session\", a DNN which is a DNN associated with the PDU
session;
e) the request type which is set to:
1) \"initial request\", if the UE is not registered for emergency services and
the UE requests to establish a new non-emergency PDU session;
2) \"existing PDU session\", if the UE is not registered for emergency
services and the UE requests:
i) handover of an existing non-emergency PDU session between 3GPP access and
non-3GPP access;
ii) transfer of an existing PDN connection for non-emergency bearer services
in the EPS to the 5GS; or
iii) transfer of an existing PDN connection for non-emergency bearer services
in an untrusted non-3GPP access connected to the EPC to the 5GS;
3) \"initial emergency request\", if the UE requests to establish a new
emergency PDU session;
4) \"existing emergency PDU session\", if the UE requests:
i) handover of an existing emergency PDU session between 3GPP access and
non-3GPP access;
ii) transfer of an existing PDN connection for emergency bearer services in
the EPS to the 5GS; or
iii) transfer of an existing PDN connection for emergency bearer services in
an untrusted non-3GPP access connected to the EPC to the 5GS; or
5) \"MA PDU request\", if:
i) the UE requests to establish an MA PDU session;
ii) the UE requests to establish user plane resources over other access of an
MA PDU session established over one access only; or
iii) the UE performs inter-system change from S1 mode to N1 mode according to
subclause 4.8.2.3.1 and requests transfer of a PDN connection which is a user
plane resource of an MA PDU session; and
f) the old PDU session ID which is the PDU session ID of the existing PDU
session, if the UE initiates the UE-requested PDU session establishment
procedure upon receiving the PDU SESSION MODIFICATION COMMAND messages with
the 5GSM cause IE set to #39 \"reactivation requested\";
using the NAS transport procedure as specified in subclause 5.4.5, and the UE
shall start timer T3580 (see example in figure 6.4.1.2.1).
For bullet c) 1), if the matching URSP rule does not have an associated
S-NSSAI, or if the UE does not have any matching URSP rule and there is no
S-NSSAI in the UE local configuration or in the default URSP rule, the UE
shall not provide any S-NSSAI in a PDU session establishment procedure.
For bullet c) 1a), if the selected PDU session parameters for 5G ProSe layer-3
UE-to-network relay UE do not have an associated S-NSSAI, the UE shall not
provide any S-NSSAI in a PDU session establishment procedure.
For bullet d) 1), if the matching URSP rule does not have an associated DNN,
or if the UE does not have any matching URSP rule and there is no DNN in the
UE local configuration or in the default URSP rule and:
a) if the UE requests a connectivity to the default DNN for the S-NSSAI and
the requested connectivity requires PAP/CHAP, the UE should provide a DNN in a
PDU session establishment procedure; or
b) otherwise, the UE shall not provide any DNN in a PDU session establishment
procedure.
For bullet d) 1a), if the selected the PDU session parameters for 5G ProSe
layer-3 UE-to-network relay UE do not have an associated DNN, the UE shall not
provide any DNN in a PDU session establishment procedure.
If the request type is set to \"initial emergency request\" or \"existing
emergency PDU session\" or the UE is registered for onboarding services in
SNPN, neither DNN nor S-NSSAI is transported by the UE using the NAS transport
procedure as specified in subclause 5.4.5.
Figure 6.4.1.2.1: UE-requested PDU session establishment procedure
Upon receipt of a PDU SESSION ESTABLISHMENT REQUEST message, a PDU session ID,
optionally an S-NSSAI associated with (in roaming scenarios) a mapped S-NSSAI,
optionally a DNN determined by the AMF, optionally a DNN selected by the
network (if different from the DNN determined by the AMF), the request type,
and optionally an old PDU session ID, the SMF checks whether connectivity with
the requested DN can be established. If the requested DNN is not included, the
SMF shall use the default DNN.
If the PDU session being established is a non-emergency PDU session, the
request type is not set to \"existing PDU session\" and the PDU session
authentication and authorization by the external DN is required due to local
policy, the SMF shall check whether the PDU SESSION ESTABLISHMENT REQUEST
message includes the SM PDU DN request container IE or the Service-level-AA
container IE.
If the PDU session being established is a non-emergency PDU session, the
request type is not set to \"existing PDU session\", the SM PDU DN request
container IE is included in the PDU SESSION ESTABLISHMENT REQUEST message, the
PDU session authentication and authorization by the external DN is required
due to local policy and user\'s subscription data, and:
a) the information for the PDU session authentication and authorization by the
external DN in the SM PDU DN request container IE is compliant with the local
policy and user\'s subscription data, the SMF shall proceed with the EAP
Authentication procedure specified in 3GPP TS 33.501 [24] and refrain from
accepting or rejecting the PDU SESSION ESTABLISHMENT REQUEST message until the
EAP Authentication procedure finalizes; or
b) the information for the PDU session authentication and authorization by the
external DN in the SM PDU DN request container IE is not compliant with the
local policy and user\'s subscription data, the SMF shall consider it as an
abnormal case and proceed as specified in subclause 6.4.1.7.
If the PDU session being established is a non-emergency PDU session, the
request type is not set to \"existing PDU session\", the SM PDU DN request
container IE is not included in the PDU SESSION ESTABLISHMENT REQUEST message
and the PDU session authentication and authorization by the external DN is
required due to local policy and user\'s subscription data, the SMF shall
proceed with the EAP Authentication procedure specified in 3GPP TS 33.501 [24]
and refrain from accepting or rejecting the PDU SESSION ESTABLISHMENT REQUEST
message until the EAP Authentication procedure finalizes.
If the SMF receives the old PDU session ID from the AMF and a PDU session
exists for the old PDU session ID, the SMF shall consider that the request for
the relocation of SSC mode 3 PDU session anchor with multiple PDU sessions as
specified in 3GPP TS 23.502 [9] is accepted by the UE.
If the SMF receives the onboarding indication from the AMF, the SMF shall
consider that the PDU session is established for onboarding services in SNPN.
If the UE has set the TPMIC bit to \"Transfer of port management information
containers supported\" in the 5GSM capability IE of the PDU SESSION
ESTABLISHMENT REQUEST message and has included a DS-TT Ethernet port MAC
address IE (if the PDU session type is \"Ethernet\"), the Port management
information container IE, and, optionally, the UE-DS-TT residence time IE in
the PDU SESSION ESTABLISHMENT REQUEST message, the SMF shall operate as
specified in 3GPP TS 23.502 [9] subclause 4.3.2.2.1.
If requested by the upper layers, the UE supporting UAS services shall
initiate a request to establish a PDU session for UAS services, where the UE:
a) shall include the service-level device ID with the value set to the CAA-
level UAV ID;
b) if provided by the upper layers, shall include the service-level-AA server
address, with the value set to the USS address; and
c) if provided by the upper layers, shall include:
i) the service-level-AA payload type, with the value set to \"UUAA payload\";
and
ii) the service-level-AA payload, with the value set to UUAA payload,
in the Service-level-AA container IE of the PDU SESSION ESTABLISHMENT REQUEST
message.
If the PDU session being established is a non-emergency PDU session, the
request type is not set to \"existing PDU session\", the Service-level-AA
container IE is included in the PDU SESSION ESTABLISHMENT REQUEST message, and
> a) the service-level authentication and authorization by the external DN is
> required due to local policy;
>
> b) there is a valid user\'s subscription information for the requested DNN
> or for the requested DNN and S-NSSAI; and
>
> c) the information for the service-level authentication and authorization by
> the external DN in the Service-level-AA container IE includes CAA-level UAV
> ID,
then the SMF shall proceed with the UUAA-SM procedure as specified in 3GPP TS
23.256 [6AB] and refrain from accepting or rejecting the PDU SESSION
ESTABLISHMENT REQUEST message until the service-level authentication and
authorization procedure is completed.
The UE supporting UAS services shall not request a PDU session establishment
procedure to the same DNN (or no DNN, if no DNN was indicated by the UE) and
the same S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) for
which the UE has requested a service level authentication and authorization
procedure which is ongoing.
If the PDU SESSION ESTABLISHMENT REQUEST message includes the PDU session pair
ID IE, the RSN IE, or both, the SMF shall operate as specified in clause
5.33.2 of 3GPP TS 23.501 [8].
#### 6.4.1.3 UE-requested PDU session establishment procedure accepted by the
network
If the connectivity with the requested DN is accepted by the network, the SMF
shall create a PDU SESSION ESTABLISHMENT ACCEPT message.
If the UE requests establishing an emergency PDU session, the network shall
not check for service area restrictions or subscription restrictions when
processing the PDU SESSION ESTABLISHMENT REQUEST message.
The SMF shall set the Authorized QoS rules IE of the PDU SESSION ESTABLISHMENT
ACCEPT message to the authorized QoS rules of the PDU session and may include
the authorized QoS flow descriptions IE of the PDU SESSION ESTABLISHMENT
ACCEPT message set to the authorized QoS flow descriptions of the PDU session.
NOTE 1: This is applicable also if the PDU session establishment procedure was
initiated to perform handover of an existing PDU session between 3GPP access
and non-3GPP access, and even if the authorized QoS rules and authorized QoS
flow descriptions for source and target access of the handover are the same.
The SMF shall ensure that the number of the packet filters used in the
authorized QoS rules of the PDU Session does not exceed the maximum number of
packet filters supported by the UE for the PDU session. If the received
request type is \"initial emergency request\", the SMF shall set the
Authorized QoS flow descriptions IE according to the initial QoS parameters
used for establishing emergency services configured in the SMF emergency
configuration data.
SMF shall set the Authorized QoS flow descriptions IE to the authorized QoS
flow descriptions of the PDU session, if:
a) the Authorized QoS rules IE contains at least one GBR QoS flow;
b) the QFI is not the same as the 5QI of the QoS flow identified by the QFI;
c) the QoS flow can be mapped to an EPS bearer as specified in subclause
4.11.1 of 3GPP TS 23.502 [9]; or
d) the QoS flow is established for the PDU session used for relaying, as
specified in subclause 5.6.2.1 of 3GPP TS 23.304 [6E].
NOTE 2: In cases other than above listed cases, it is up to the SMF
implementation to include the authorized QoS flow description for the QoS flow
in the Authorized QoS flow descriptions IE of the PDU SESSION ESTABLISHMENT
ACCEPT message.
If interworking with EPS is supported for the PDU session, the SMF shall set
in the PDU SESSION ESTABLISHMENT ACCEPT message:
a) the Mapped EPS bearer contexts IE to the EPS bearer contexts mapped from
one or more QoS flows of the PDU session; and
b) the EPS bearer identity parameter in the Authorized QoS flow descriptions
IE to the EPS bearer identity corresponding to the QoS flow, for each QoS flow
which can be transferred to EPS.
If the \"Create new EPS bearer\" operation code in the Mapped EPS bearer
contexts IE was received, and there is no corresponding Authorized QoS flow
descriptions IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the UE shall
send a PDU SESSION MODIFICATION REQUEST message including a Mapped EPS bearer
contexts IE to delete the mapped EPS bearer context. If the EPS bearer
identity parameter in the Authorized QoS flow descriptions IE was received,
the operation code is \"Create new QoS flow description\" and there is no
corresponding Mapped EPS bearer contexts IE in the PDU SESSION ESTABLISHMENT
ACCEPT message, the UE shall not diagnose an error, and shall keep storing the
association between the QoS flow and the corresponding EPS bearer identity.
Furthermore, the SMF shall store the association between the QoS flow and the
mapped EPS bearer context, for each QoS flow which can be transferred to EPS.
The SMF shall set the selected SSC mode IE of the PDU SESSION ESTABLISHMENT
ACCEPT message to:
a) the received SSC mode in the SSC mode IE included in the PDU SESSION
ESTABLISHMENT REQUEST message based on one or more of the PDU session type,
the subscription and the SMF configuration;
b) either the default SSC mode for the data network listed in the subscription
or the SSC mode associated with the SMF configuration, if the SSC mode IE is
not included in the PDU SESSION ESTABLISHMENT REQUEST message.
NOTE 3: For bullet b), to avoid issues for UEs not supporting all SSC modes,
the network operator can, in the subscription data and local configuration,
include at least SSC mode 1 in the allowed SSC modes, and set the default SSC
mode to \"SSC mode 1\" as per 3GPP TS 23.501 [8].
If the PDU session is an emergency PDU session, the SMF shall set the Selected
SSC mode IE of the PDU SESSION ESTABLISHMENT ACCEPT message to \"SSC mode 1\".
If the PDU session is a non-emergency PDU session of \"Ethernet\" or
\"Unstructured\" PDU session type, the SMF shall set the Selected SSC mode IE
to \"SSC mode 1\" or \"SSC mode 2\". If the PDU session is a non-emergency PDU
session of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type, the SMF shall
set the selected SSC mode IE to \"SSC mode 1\", \"SSC mode 2\", or \"SSC mode
3\".
If the PDU session is a non-emergency PDU session and the UE is not registered
for onboarding services in SNPN, the SMF shall set the S-NSSAI IE of the PDU
SESSION ESTABLISHMENT ACCEPT message to:
a) the S-NSSAI of the PDU session; and
b) the mapped S-NSSAI (in roaming scenarios).
The SMF shall set the Selected PDU session type IE of the PDU SESSION
ESTABLISHMENT ACCEPT message to the selected PDU session type, i.e. the PDU
session type of the PDU session.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"IPv4v6\", the SMF shall select \"IPv4\", \"IPv6\" or \"IPv4v6\" as
the Selected PDU session type. If the subscription, the SMF configuration, or
both, are limited to IPv4 only or IPv6 only for the DNN selected by the
network, the SMF shall include the 5GSM cause value #50 \"PDU session type
IPv4 only allowed\", or #51 \"PDU session type IPv6 only allowed\",
respectively, in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT ACCEPT
message.
If the selected PDU session type is \"IPv4\", the SMF shall include the PDU
address IE in the PDU SESSION ESTABLISHMENT ACCEPT message and shall set the
PDU address IE to an IPv4 address is allocated to the UE in the PDU session.
If the selected PDU session type is \"IPv6\", the SMF shall include the PDU
address IE in the PDU SESSION ESTABLISHMENT ACCEPT message and shall set the
PDU address IE to an interface identifier for the IPv6 link local address
allocated to the UE in the PDU session.
If the selected PDU session type is \"IPv4v6\", the SMF shall include the PDU
address IE in the PDU SESSION ESTABLISHMENT ACCEPT message and shall set the
PDU address IE to an IPv4 address and an interface identifier for the IPv6
link local address, allocated to the UE in the PDU session.
If the selected PDU session type of a PDU session established by the W-AGF
acting on behalf of the FN-RG is \"IPv4v6\" or \"IPv6\", the SMF shall also
indicate the SMF\'s IPv6 link local address in the PDU address IE of the PDU
SESSION ESTABLISHMENT ACCEPT message.
If the PDU session is a non-emergency PDU session and the UE is not registered
for onboarding services in SNPN, the SMF shall set the DNN IE of the PDU
SESSION ESTABLISHMENT ACCEPT message to the DNN determined by the AMF of the
PDU session.
The SMF shall set the Session-AMBR IE of the PDU SESSION ESTABLISHMENT ACCEPT
message to the Session-AMBR of the PDU session.
If the selected PDU session type is \"IPv4\", \"IPv6\", \"IPv4v6\" or
\"Ethernet\" and if the PDU SESSION ESTABLISHMENT REQUEST message includes a
5GSM capability IE with the RQoS bit set to \"Reflective QoS supported\", the
SMF shall consider that reflective QoS is supported for QoS flows belonging to
this PDU session and may include the RQ timer IE set to an RQ timer value in
the PDU SESSION ESTABLISHMENT ACCEPT message.
If the selected PDU session type is \"IPv4\", \"IPv6\", \"IPv4v6\" or
\"Ethernet\" and if the PDU SESSION ESTABLISHMENT REQUEST message includes a
Maximum number of supported packet filters IE, the SMF shall consider this
number as the maximum number of packet filters that can be supported by the UE
for this PDU session. Otherwise the SMF considers that the UE supports 16
packet filters for this PDU session.
The SMF shall consider that the maximum data rate per UE for user-plane
integrity protection supported by the UE for uplink and the maximum data rate
per UE for user-plane integrity protection supported by the UE for downlink
are valid for the lifetime of the PDU session.
If the value of the RQ timer is set to \"deactivated\" or has a value of zero,
the UE considers that RQoS is not applied for this PDU session.
NOTE 4: If the 5G core network determines that reflective QoS is to be used
for a QoS flow, the SMF sends reflective QoS indication (RQI) to UPF to
activate reflective QoS. If the QoS flow is established over 3GPP access, the
SMF also includes reflective QoS Attribute (RQA) in QoS profile of the QoS
flow during QoS flow establishment.
If the selected PDU session type is \"IPv6\" or \"IPv4v6\" and if the PDU
SESSION ESTABLISHMENT REQUEST message includes a 5GSM capability IE with the
MH6-PDU bit set to \"Multi-homed IPv6 PDU session supported\", the SMF shall
consider that this PDU session is supported to use multiple IPv6 prefixes.
If the selected PDU session type is \"Ethernet\", the PDU SESSION
ESTABLISHMENT REQUEST message includes a 5GSM capability IE with the EPT-S1
bit set to \"Ethernet PDN type in S1 mode supported\" and the network supports
Ethernet PDN type in S1 mode, the SMF shall set the EPT-S1 bit of the 5GSM
network feature support IE of the PDU SESSION ESTABLISHMENT ACCEPT message to
\"Ethernet PDN type in S1 mode supported\".
If the DN authentication of the UE was performed and completed successfully,
the SMF shall set the EAP message IE of the PDU SESSION ESTABLISHMENT ACCEPT
message to an EAP-success message as specified in IETF RFC 3748 [34], provided
by the DN.
Based on local policies or configurations in the SMF and the Always-on PDU
session requested IE in the PDU SESSION ESTABLISHMENT REQUEST message (if
available), if the SMF determines that either:
a) the requested PDU session needs to be established as an always-on PDU
session (e.g. because the PDU session is for time synchronization or TSC, for
URLLC, or for both), the SMF shall include the Always-on PDU session
indication IE in the PDU SESSION ESTABLISHMENT ACCEPT message and shall set
the value to \"Always-on PDU session required\"; or
b) the requested PDU session shall not be established as an always-on PDU
session and:
i) if the UE included the Always-on PDU session requested IE, the SMF shall
include the Always-on PDU session indication IE in the PDU SESSION
ESTABLISHMENT ACCEPT message and shall set the value to \"Always-on PDU
session not allowed\"; or
ii) if the UE did not include the Always-on PDU session requested IE, the SMF
shall not include the Always-on PDU session indication IE in the PDU SESSION
ESTABLISHMENT ACCEPT message.
If the PDU session is an MA PDU session, the SMF shall include the ATSSS
container IE in the PDU SESSION ESTABLISHMENT ACCEPT message. The SMF shall
set the content of the ATSSS container IE as specified in 3GPP TS 24.193
[13B]. If the UE requests to establish user plane resources over the second
access of an MA PDU session which has already been established over the first
access and the parameters associated with ATSSS previously provided to the UE
are not to be updated, the \"ATSSS container contents\" shall not be included
in the ATSSS container IE in the PDU SESSION ESTABLISHMENT ACCEPT message.
If the PDU session is a single access PDU session containing the MA PDU
session information IE with the value set to \"MA PDU session network upgrade
is allowed\" and:
a) if the SMF decides to establish a single access PDU session, the SMF shall
not include the ATSSS container IE in the PDU SESSION ESTABLISHMENT ACCEPT
message; or
b) if the SMF decides to establish an MA PDU session, the SMF shall include
the ATSSS container IE in the PDU SESSION ESTABLISHMENT ACCEPT message, which
indicates to the UE that the requested single access PDU session was
established as an MA PDU Session.
If the network decides that the PDU session is only for control plane CIoT 5GS
optimization, the SMF shall include the control plane only indication in the
PDU SESSION ESTABLISHMENT ACCEPT message.
If:
a) the UE provided the IP header compression configuration IE in the PDU
SESSION ESTABLISHMENT REQUEST message; and
b) the SMF supports IP header compression for control plane CIoT 5GS
optimization;
the SMF shall include the IP header compression configuration IE in the PDU
SESSION ESTABLISHMENT ACCEPT message.
If:
a) the UE provided the Ethernet header compression configuration IE in the PDU
SESSION ESTABLISHMENT REQUEST message; and
b) the SMF supports Ethernet header compression for control plane CIoT 5GS
optimization;
the SMF shall include the Ethernet header compression configuration IE in the
PDU SESSION ESTABLISHMENT ACCEPT message.
If the PDU SESSION ESTABLISHMENT REQUEST included the Requested MBS container
IE with the MBS operation set to \"Join multicast MBS session\", the SMF:
a) shall include the TMGI for the multicast MBS session IDs that the UE is
allowed to join, if any, in the Received MBS container IE, shall set the MBS
decision to \"MBS join is accepted\" for each of those Received MBS
information, may include the MBS start time to indicate the time when the
multicast MBS session starts and shall include the MBS security container in
each of those Received MBS information if security protection is applied for
that multicast MBS session and the control plane security procedure is used as
specified in annex W.4.1.2 in 3GPP TS 33.501 [24], and shall use separate QoS
flows dedicated for multicast by including the Authorized QoS flow
descriptions IE if no separate QoS flows dedicated for multicast exist or if
the SMF wants to establish new QoS flows dedicated for multicast;
NOTE 5: The network determines whether security protection applies or not for
the multicast MBS session as specified in 3GPP TS 33.501 [24].
b) shall include the TMGI for multicast MBS session IDs that the UE is not
allowed to join, if any, in the Received MBS container IE, shall set the MBS
decision to \"MBS join is rejected\" for each of those Received MBS
information, shall set the Rejection cause for each of those Received MBS
information with the reason of rejection, and if the Rejection cause is set to
\"multicast MBS session has not started or will not start soon\", may include
an MBS back-off timer value; and
c) may include in the Received MBS container IE the MBS service area for each
multicast MBS session and include in it the MBS TAI list, the NR CGI list or
both, that identify the service area(s) for the local MBS service
> NOTE 6: For an multicast MBS session that has multiple MBS service areas,
> the MBS service areas are indicated to the UE using MBS service announcement
> as described in 3GPP TS 23.247 [53], which is out of scope of this
> specification.
in the PDU SESSION ESTABLISHMENT ACCEPT message. If the UE has set the Type of
multicast MBS session ID to \"Source specific IP multicast address\" in the
Requested MBS container IE for certain multicast MBS session(s) in the PDU
SESSION MODIFICATION REQUEST message, the SMF shall include the Source IP
address information and Destination IP address information in the Received MBS
information together with the TMGI for each of those multicast MBS sessions.
NOTE 7: Including the Source IP address information and Destination IP address
information in the Received MBS information in that case is to allow the UE to
perform the mapping between the requested multicast MBS session ID and the
provided TMGI.
NOTE 8: In SNPN, TMGI is used together with NID to identify an MBS Session.
If the request type is \"existing PDU session\", the SMF shall not perform
network slice admission control for the PDU session, except for the following
cases:
a) when EPS counting is not required for the S-NSSAI of the PDU session for
network slice admission control and the PDU session is established due to
transfer the PDN connection from S1 mode to N1 mode in case of inter-system
change; or
b) handover of an existing PDU session between 3GPP access and non-3GPP access
is performed.
The SMF shall send the PDU SESSION ESTABLISHMENT ACCEPT message.
Upon receipt of a PDU SESSION ESTABLISHMENT ACCEPT message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE
shall stop timer T3580, shall release the allocated PTI value and shall
consider that the PDU session was established.
If the PDU session establishment procedure was initiated to perform handover
of an existing PDU session between 3GPP access and non-3GPP access, then upon
receipt of the PDU SESSION ESTABLISHMENT ACCEPT message the UE shall locally
delete any authorized QoS rules, authorized QoS flow descriptions, the
session-AMBR and the parameters provided in the Protocol configuration options
IE when in S1 mode or the Extended protocol configuration options IE stored
for the PDU session before processing the new received authorized QoS rules,
authorized QoS flow descriptions, the session-AMBR and the parameters provided
in the Extended protocol configuration options IE, if any.
NOTE 9: For the case of handover from 3GPP access to non-3GPP access, deletion
of the QoS flow descriptions implies deletion of the associated EPS bearer
identities, if any, and according to subclause 6.1.4.1 also deletion of the
associated EPS bearer contexts. Regarding the reverse direction, for PDU
sessions via non-3GPP access the network does not allocate associated EPS
bearer identities (see 3GPP TS 23.502 [9], subclause 4.11.1.4.1).
If the PDU session establishment procedure was initiated to perform handover
of an existing PDU session from 3GPP access to non-3GPP access and that
existing PDU session is associated with one or more multicast MBS sessions,
the UE shall locally leave the associated multicast MBS sessions and the SMF
shall consider the UE as removed from the associated multicast MBS sessions.
For an MA PDU session already established on a single access, except for all
those MA PDU sessions with a PDN connection established as a user-plane
resource, upon receipt of PDU SESSION ESTABLISHMENT ACCEPT message over the
other access:
a) the UE shall delete the stored authorized QoS rules and the stored session-
AMBR;
b) if the authorized QoS flow descriptions IE is included in the PDU SESSION
ESTABLISHMENT ACCEPT message, the UE shall delete the stored authorized QoS
flow descriptions; and
c) if the mapped EPS bearer contexts IE is included in the PDU SESSION
ESTABLISHMENT ACCEPT message, the UE shall delete the stored mapped EPS bearer
contexts.
The UE shall store the authorized QoS rules, and the session-AMBR received in
the PDU SESSION ESTABLISHMENT ACCEPT message for the PDU session. The UE shall
also store the authorized QoS flow descriptions if it is included in the
Authorized QoS flow descriptions IE of the PDU SESSION ESTABLISHMENT ACCEPT
message for the PDU session.
If the number of the authorized QoS rules, the number of the packet filters,
or the number of the authorized QoS flow descriptions associated with the PDU
session have reached the maximum number supported by the UE upon receipt of a
PDU SESSION ESTABLISHMENT ACCEPT message, then the UE may initiate the PDU
session release procedure by sending a PDU SESSION RELEASE REQUEST message
with 5GSM cause #26 \"insufficient resources\".
For a PDU session that is being established with the request type set to
\"initial request\", \"initial emergency request\" or \"MA PDU request\", or a
PDU session that is being transferred from EPS to 5GS and established with the
request type set to \"existing PDU session\" or \"existing emergency PDU
session\" or a PDU session that is being handed over between non-3GPP access
and 3GPP access and established with the request type set to \"existing PDU
session\" or \"existing emergency PDU session \", the UE shall verify the
authorized QoS rules and the authorized QoS flow descriptions provided in the
PDU SESSION ESTABLISHMENT ACCEPT message for different types of errors as
follows:
a) Semantic errors in QoS operations:
1) When the rule operation is \"Create new QoS rule\", and the DQR bit is set
to \"the QoS rule is the default QoS rule\" when there\'s already a default
QoS rule.
2) When the rule operation is \"Create new QoS rule\", and there is no rule
with the DQR bit set to \"the QoS rule is the default QoS rule\".
3) When the rule operation is \"Create new QoS rule\" and two or more QoS
rules associated with this PDU session would have identical precedence values.
4) When the rule operation is an operation other than \"Create new QoS rule\".
5) When the rule operation is \"Create new QoS rule\", the DQR bit is set to
\"the QoS rule is not the default QoS rule\", and the UE is in NB-N1 mode.
6) When the rule operation is \"Create new QoS rule\" and two or more QoS
rules associated with this PDU session would have identical QoS rule
identifier values.
7) When the rule operation is \"Create new QoS rule\", the DQR bit is set to
\"the QoS rule is not the default QoS rule\", and the PDU session type of the
PDU session is \"Unstructured\".
8) When the flow description operation is an operation other than \"Create new
QoS flow description\".
9) When the flow description operation is \"Create new QoS flow description\",
the QFI associated with the QoS flow description is not the same as the QFI of
the default QoS rule and the UE is NB-N1 mode.
10) When the flow description operation is \"Create new QoS flow
description\", the QFI associated with the QoS flow description is not the
same as the QFI of the default QoS rule, and the PDU session type of the PDU
session is \"Unstructured\".
In case 4, case 5, or case 7 if the rule operation is for a non-default QoS
rule, the UE shall send a PDU SESSION MODIFICATION REQUEST message to delete
the QoS rule with 5GSM cause #83 \"semantic error in the QoS operation\".
In case 8, case 9, or case 10, the UE shall send a PDU SESSION MODIFICATION
REQUEST message to delete the QoS flow description with 5GSM cause #83
\"semantic error in the QoS operation\".
Otherwise for all the cases above, the UE shall initiate a PDU session release
procedure by sending a PDU SESSION RELEASE REQUEST message with 5GSM cause #83
\"semantic error in the QoS operation\".
b) Syntactical errors in QoS operations:
1) When the rule operation is \"Create new QoS rule\", the QoS rule is a QoS
rule of a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, and
the packet filter list in the QoS rule is empty.
2) When the rule operation is \"Create new QoS rule\", the DQR bit is set to
\"the QoS rule is the default QoS rule\", the PDU session type of the PDU
session is \"Unstructured\", and the packet filter list in the QoS rule is not
empty.
3) When there are other types of syntactical errors in the coding of the
Authorized QoS rules IE or the Authorized QoS flow descriptions IE, such as: a
mismatch between the number of packet filters subfield and the number of
packet filters in the packet filter list when the rule operation is \"delete
existing QoS rule\" or \"create new QoS rule\", or the number of packet
filters subfield is larger than the maximum possible number of packet filters
in the packet filter list (i.e., there is no QoS rule precedence subfield
included in the QoS rule IE), the QoS Rule Identifier is set to \"no QoS rule
identifier assigned\", or the QoS flow identifier is set to \"no QoS flow
identifier assigned\".
4) When, the rule operation is \"Create new QoS rule\", there is no QoS flow
description with a QFI corresponding to the QFI of the resulting QoS rule and
the UE determines, by using the QoS rule's QFI as the 5QI, that there is a
resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8]
table 5.7.4-1).
5) When the flow description operation is \"Create new QoS flow description\",
and the UE determines that there is a QoS flow description of a GBR QoS flow
(as described in 3GPP TS 23.501 [8] table 5.7.4-1) which lacks at least one of
the mandatory parameters (i.e., GFBR uplink, GFBR downlink, MFBR uplink and
MFBR downlink). If the QoS flow description does not include a 5QI, the UE
determines this by using the QFI as the 5QI.
In case 1, case 3 or case 4, if the QoS rule is not the default QoS rule, the
UE shall send a PDU SESSION MODIFICATION REQUEST message including a requested
QoS rule IE to delete the QoS rule with 5GSM cause #84 \"syntactical error in
the QoS operation\". Otherwise, if the QoS rule is the default QoS rule, the
UE shall initiate a PDU session release procedure by sending a PDU SESSION
RELEASE REQUEST message with 5GSM cause #84 \"syntactical error in the QoS
operation\".
In case 2, if the QoS rule is the default QoS rule, the UE shall send a PDU
SESSION MODIFICATION REQUEST message including a requested QoS rule IE to
delete all the packet filters of the default QoS rule. The UE shall include
the 5GSM cause #84 \"syntactical error in the QoS operation\".
In case 5, if the default QoS rule is associated with the QoS flow description
which lacks at least one of the mandatory parameters, the UE shall initiate a
PDU session release procedure by sending a PDU SESSION RELEASE REQUEST message
with 5GSM cause #84 \"syntactical error in the QoS operation\". Otherwise, the
UE shall send a PDU SESSION MODIFICATION REQUEST message to delete the QoS
flow description which lacks at least one of the mandatory parameters and the
associated QoS rule(s), if any, with 5GSM cause #84 \"syntactical error in the
QoS operation\".
NOTE 10: It is not considered an error if the UE determines that after
processing all QoS operations on QoS rules and QoS flow descriptions there is
a QoS flow description that is not associated with any QoS rule and the UE is
not in NB-N1 mode.
c) Semantic errors in packet filters:
1) When a packet filter consists of conflicting packet filter components which
would render the packet filter ineffective, i.e. no IP packet will ever fit
this packet filter. How the UE determines a semantic error in a packet filter
is outside the scope of the present document.
If the QoS rule is the default QoS rule, the UE shall initiate a PDU session
release procedure by sending a PDU SESSION RELEASE REQUEST message with 5GSM
cause #44 \"semantic error in packet filter(s)\". Otherwise, the UE shall send
a PDU SESSION MODIFICATION REQUEST message to delete the QoS rule with 5GSM
cause #44 \"semantic error in packet filter(s)\".
d) Syntactical errors in packet filters:
1) When the rule operation is \"Create new QoS rule\" and two or more packet
filters in the resultant QoS rule would have identical packet filter
identifiers.
2) When there are other types of syntactical errors in the coding of packet
filters, such as the use of a reserved value for a packet filter component
identifier.
If the QoS rule is the default QoS rule, the UE shall initiate a PDU session
release procedure by sending a PDU SESSION RELEASE REQUEST message with 5GSM
cause #45 \"syntactical errors in packet filter(s)\". Otherwise, the UE shall
send a PDU SESSION MODIFICATION REQUEST message to delete the QoS rule with
5GSM cause #45 \"syntactical errors in packet filter(s)\".
If the Always-on PDU session indication IE is included in the PDU SESSION
ESTABLISHMENT ACCEPT message and:
a) the value of the IE is set to \"Always-on PDU session required\", the UE
shall consider the established PDU session as an always-on PDU session; or
b) the value of the IE is set to \"Always-on PDU session not allowed\", the UE
shall not consider the established PDU session as an always-on PDU session.
The UE shall not consider the established PDU session as an always-on PDU
session if the UE does not receive the Always-on PDU session indication IE in
the PDU SESSION ESTABLISHMENT ACCEPT message.
The UE shall store the mapped EPS bearer contexts, if received in the PDU
SESSION ESTABLISHMENT ACCEPT message. Furthermore, the UE shall also store the
association between the QoS flow and the mapped EPS bearer context, for each
QoS flow which can be transferred to EPS, based on the received EPS bearer
identity parameter in Authorized QoS flow descriptions IE and the mapped EPS
bearer contexts. The UE shall check each mapped EPS bearer context for
different types of errors as follows:
NOTE 11: An error detected in a mapped EPS bearer context does not cause the
UE to discard the Authorized QoS rules IE and Authorized QoS flow descriptions
IE included in the PDU SESSION ESTABLISHMENT ACCEPT, if any.
a) Semantic error in the mapped EPS bearer operation:
1) When the operation code is an operation code other than \"Create new EPS
bearer\".
2) When the operation code is \"Create new EPS bearer\" and there is already
an existing mapped EPS bearer context with the same EPS bearer identity
associated with any PDU session.
3) When the operation code is \"Create new EPS bearer\" and the resulting
mapped EPS bearer context has invalid mandatory parameters or missing
mandatory parameters (e.g., mapped EPS QoS parameters or traffic flow template
for a dedicated EPS bearer context).
In case 2, if the existing mapped EPS bearer context is associated with the
PDU session that is being established, the UE shall not diagnose an error,
further process the create request and, if it was process successfully, delete
the old EPS bearer context.
Otherwise, the UE shall initiate a PDU session modification procedure by
sending a PDU SESSION MODIFICATION REQUEST message to delete the mapped EPS
bearer context with 5GSM cause #85 \"Invalid mapped EPS bearer identity\".
b) if the mapped EPS bearer context includes a traffic flow template, the UE
shall check the traffic flow template for different types of TFT IE errors as
follows:
1) Semantic errors in TFT operations:
i) When the TFT operation is an operation other than \"Create new TFT\"
The UE shall initiate a PDU session modification procedure by sending a PDU
SESSION MODIFICATION REQUEST message to delete the mapped EPS bearer context
with 5GSM cause #41 \"semantic error in the TFT operation\".
2) Syntactical errors in TFT operations:
i) When the TFT operation = \"Create new TFT\" and the packet filter list in
the TFT IE is empty.
ii) When there are other types of syntactical errors in the coding of the TFT
IE, such as a mismatch between the number of packet filters subfield, and the
number of packet filters in the packet filter list when the TFT operation is
\"delete existing TFT\" or \"create new TFT\", or the number of packet filters
subfield is larger than the maximum possible number of packet filters in the
packet filter list.
The UE shall initiate a PDU session modification procedure by sending a PDU
SESSION MODIFICATION REQUEST message with to delete the mapped EPS bearer
context 5GSM cause #42 \"syntactical error in the TFT operation\".
3) Semantic errors in packet filters:
i) When a packet filter consists of conflicting packet filter components which
would render the packet filter ineffective, i.e. no IP packet will ever fit
this packet filter. How the UE determines a semantic error in a packet filter
is outside the scope of the present document.
ii) When the resulting TFT does not contain any packet filter which applicable
for the uplink direction.
The UE shall initiate a PDU session modification procedure by sending a PDU
SESSION MODIFICATION REQUEST message to delete the mapped EPS bearer context
with 5GSM cause #44 \"semantic errors in packet filter(s)\".
4) Syntactical errors in packet filters:
i) When the TFT operation = \"Create new TFT\" and two or more packet filters
in the resultant TFT would have identical packet filter identifiers.
ii) When the TFT operation = \"Create new TFT\" and two or more packet filters
in all TFTs associated with this PDN connection would have identical packet
filter precedence values.
iii) When there are other types of syntactical errors in the coding of packet
filters, such as the use of a reserved value for a packet filter component
identifier.
In case ii, if the old packet filters do not belong to the default EPS bearer
context, the UE shall not diagnose an error and shall delete the old packet
filters which have identical filter precedence values.
In case ii, if one or more old packet filters belong to the default EPS bearer
context, the UE shall initiate a PDU session modification procedure by sending
a PDU SESSION MODIFICATION REQUEST message to delete the mapped EPS bearer
context with 5GSM cause #45 \"syntactical errors in packet filter(s)\".
In cases i and iii the UE shall initiate a PDU session modification procedure
by sending a PDU SESSION MODIFICATION REQUEST message to delete the mapped EPS
bearer context with 5GSM cause #45 \"syntactical error in packet filter(s)\".
If the UE detects different errors in the mapped EPS bearer contexts, QoS
rules or QoS flow descriptions, the UE may send a single PDU SESSION
MODIFICATION REQUEST message to delete the erroneous mapped EPS bearer
contexts, QoS rules or QoS flow descriptions. In that case, the UE shall
include a single 5GSM cause in the PDU SESSION MODIFICATION REQUEST message.
NOTE 12: The 5GSM cause to use cannot be different from: #41 \"semantic error
in the TFT operation\", #42 \"syntactical error in the TFT operation\", #44
\"semantic error in packet filter(s)\", #45 \"syntactical errors in packet
filter(s)\", #83 \"semantic error in the QoS operation\", #84 \"syntactical
error in the QoS operation\", and #85 \"Invalid mapped EPS bearer identity\".
The selection of a 5GSM cause is up to the UE implementation.
If there are mapped EPS bearer context(s) associated with a PDU session, but
none of them is associated with the default QoS rule, the UE shall locally
delete the mapped EPS bearer context(s) and shall locally delete the stored
EPS bearer identity (EBI) in all the QoS flow descriptions of the PDU session,
if any.
The UE shall only use the Control plane CIoT 5GS optimization for this PDU
session if the Control plane only indication is included in the PDU SESSION
ESTABLISHMENT ACCEPT message.
If the UE requests the PDU session type \"IPv4v6\" and:
a) the UE receives the selected PDU session type set to \"IPv4\" and does not
receive the 5GSM cause value #50 \"PDU session type IPv4 only allowed\"; or
b) the UE receives the selected PDU session type set to \"IPv6\" and does not
receive the 5GSM cause value #51 \"PDU session type IPv6 only allowed\";
the UE may subsequently request another PDU session for the other IP version
using the UE-requested PDU session establishment procedure to the same DNN (or
no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated
with (in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was
indicated by the UE) with a single address PDN type (IPv4 or IPv6) other than
the one already activated.
If the UE requests the PDU session type \"IPv4v6\", receives the selected PDU
session type set to \"IPv4\" and the 5GSM cause value #50 \"PDU session type
IPv4 only allowed\", the UE shall not subsequently request another PDU session
using the UE-requested PDU session establishment procedure to the same DNN (or
no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated
with (in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was
indicated by the UE) to obtain a PDU session type different from the one
allowed by the network until any of the following conditions is fulfilled:
a) the UE is registered to a new PLMN;
b) the UE is switched off; or
c) the USIM is removed or the entry in the \"list of subscriber data\" for the
current SNPN is updated.
If the UE requests the PDU session type \"IPv4v6\", receives the selected PDU
session type set to \"IPv6\" and the 5GSM cause value #51 \"PDU session type
IPv6 only allowed\", the UE shall not subsequently request another PDU session
using the UE-requested PDU session establishment procedure to the same DNN (or
no DNN, if no DNN was indicated by the UE) and the same S-NSSAI associated
with (in roaming scenarios) a mapped S-NSSAI (or no S-NSSAI, if no S-NSSAI was
indicated by the UE) to obtain a PDU session type different from the one
allowed by the network until any of the following conditions is fulfilled:
a) the UE is registered to a new PLMN;
b) the UE is switched off; or
c) the USIM is removed or the entry in the \"list of subscriber data\" for the
current SNPN is updated.
NOTE 13: For the 5GSM cause values #50 \"PDU session type IPv4 only allowed\",
and #51 \"PDU session type IPv6 only allowed\", re-attempt in S1 mode for the
same DNN (or no DNN, if no DNN was indicated by the UE) is only allowed using
the PDU session type(s) indicated by the network.
If the selected PDU session type of the PDU session is \"Unstructured\" or
\"Ethernet\", the UE supports inter-system change from N1 mode to S1 mode, the
UE does not support establishment of a PDN connection for the PDN type set to
\"non-IP\" in S1 mode, and the parameters list field of one or more authorized
QoS flow descriptions received in the Authorized QoS flow descriptions IE of
the PDU SESSION ESTABLISHMENT ACCEPT message contains an EPS bearer identity
(EBI), then the UE shall locally remove the EPS bearer identity (EBI) from the
parameters list field of such one or more authorized QoS flow descriptions.
Additionally the UE shall also initiate a PDU session modification procedure
by sending a PDU SESSION MODIFICATION REQUEST message to delete the mapped EPS
bearer context with 5GSM cause #85 \"Invalid mapped EPS bearer identity\".
If the selected PDU session type of the PDU session is \"Ethernet\", the UE
supports inter-system change from N1 mode to S1 mode, the UE does not support
establishment of a PDN connection for the PDN type set to \"non-IP\" in S1
mode, the UE, the network or both of them do not support Ethernet PDN type in
S1 mode, and the parameters list field of one or more authorized QoS flow
descriptions received in the Authorized QoS flow descriptions IE of the PDU
SESSION ESTABLISHMENT ACCEPT message contains an EPS bearer identity (EBI),
then the UE shall locally remove the EPS bearer identity (EBI) from the
parameters list field of such one or more authorized QoS flow descriptions.
Additionally, the UE shall also initiate a PDU session modification procedure
by sending a PDU SESSION MODIFICATION REQUEST message to delete the mapped EPS
bearer context with 5GSM cause #85 \"Invalid mapped EPS bearer identity\".
For a UE which is registered for disaster roaming services and for a PDU
session which is not a PDU session for emergency services:
a) if the parameters list field of one or more authorized QoS flow
descriptions received in the Authorized QoS flow descriptions IE of the PDU
SESSION ESTABLISHMENT ACCEPT message contains an EPS bearer identity (EBI),
then the UE shall locally remove the EPS bearer identity (EBI) from the
parameters list field of such one or more authorized QoS flow descriptions;
and
b) the UE shall locally delete the contents of the Mapped EPS bearer contexts
IE if it is received in the PDU SESSION ESTABLISHMENT ACCEPT message.
If the UE receives an IPv4 Link MTU parameter, an Ethernet Frame Payload MTU
parameter, an Unstructured Link MTU parameter, or a Non-IP Link MTU parameter
in the Extended protocol configuration options IE of the PDU SESSION
ESTABLISHMENT ACCEPT message, the UE shall pass to the upper layer the
received IPv4 link MTU size, the received Ethernet frame payload MTU size, the
unstructured link MTU size, or the non-IP link MTU size.
NOTE 14: The IPv4 link MTU size corresponds to the maximum length of user data
packet that can be sent either via the control plane or via N3 interface for a
PDU session of the \"IPv4\" PDU session type.
NOTE 15: The Ethernet frame payload MTU size corresponds to the maximum length
of a payload of an Ethernet frame that can be sent either via the control
plane or via N3 interface for a PDU session of the \"Ethernet\" PDU session
type.
NOTE 16: The unstructured link MTU size correspond to the maximum length of
user data packet that can be sent either via the control plane or via N3
interface for a PDU session of the \"Unstructured\" PDU session type.
NOTE 17: A PDU session of \"Ethernet\" or \"Unstructured\" PDU session type
can be transferred to a PDN connection of \"non-IP\" PDN type, thus the UE can
request the non-IP link MTU parameter in the PDU session establishment
procedure. The non-IP link MTU size corresponds to the maximum length of user
data that can be sent either in the user data container in the ESM DATA
TRANSPORT message or via S1-U interface as specified in 3GPP TS 24.301 [15].
If the 5G-RG receives an ACS information parameter in the Extended protocol
configuration options IE of the PDU SESSION ESTABLISHMENT ACCEPT message, the
5G-RG shall pass the ACS URL in the received ACS information parameter to the
upper layer.
If the UE has indicated support for CIoT 5GS optimizations and receives a
small data rate control parameters container in the Extended protocol
configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message, the
UE shall store the small data rate control parameters value and use the stored
small data rate control parameters value as the maximum allowed limit of
uplink user data for the PDU session in accordance with 3GPP TS 23.501 [8].
If the UE has indicated support for CIoT 5GS optimizations and receives an
additional small data rate control parameters for exception data container in
the Extended protocol configuration options IE in the PDU SESSION
ESTABLISHMENT ACCEPT message, the UE shall store the additional small data
rate control parameters for exception data value and use the stored additional
small data rate control parameters for exception data value as the maximum
allowed limit of uplink exception data for the PDU session in accordance with
3GPP TS 23.501 [8].
If the UE has indicated support for CIoT 5GS optimizations and receives an
initial small data rate control parameters container or an initial additional
small data rate control parameters for exception data container in the
Extended protocol configuration options IE in the PDU SESSION ESTABLISHMENT
ACCEPT message, the UE shall use these parameters for the newly established
PDU Session. When the validity period of the initial parameters expire, the
parameters received in a small data rate control parameters container or an
additional small data rate control parameters for exception data container
shall be used.
If the UE receives a Serving PLMN rate control IE in the PDU SESSION
ESTABLISHMENT ACCEPT message, the UE shall store the Serving PLMN rate control
IE value and use the stored serving PLMN rate control value as the maximum
allowed limit of uplink control plane user data for the corresponding PDU
session in accordance with 3GPP TS 23.501 [8].
If the UE receives an APN rate control parameters container or an additional
APN rate control for exception data parameters container in the Extended
protocol configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT
message, the UE shall store these parameters and use them to limit the rate at
which it generates uplink user data messages for the PDN connection
corresponding to the PDU session if the PDU session is transferred to EPS upon
inter-system change from N1 mode to S1 mode in accordance with 3GPP TS 24.301
[15]. The received APN rate control parameters and additional APN rate control
for exception data parameters shall replace any previously stored APN rate
control parameters and additional APN rate control for exception data
parameters, respectively, for this PDN connection.
If the UE receives an initial APN rate control parameters container or an
initial additional APN rate control for exception data parameters container in
the Extended protocol configuration options IE in the PDU SESSION
ESTABLISHMENT ACCEPT message, the UE shall store these parameters in the APN
rate control status and use them to limit the rate at which it generates
exception data messages for the PDN connection corresponding to the PDU
session if the PDU session is transferred to EPS upon inter-system change from
N1 mode to S1 mode in accordance with 3GPP TS 24.301 [15]. The received APN
rate control status shall replace any previously stored APN rate control
status for this PDN connection.
NOTE 18: In the PDU SESSION ESTABLISHMENT ACCEPT message, the SMF provides
either APN rate control parameters container, or initial APN rate control
parameters container, in the Extended protocol configuration options IE, but
not both.
NOTE 19: In the PDU SESSION ESTABLISHMENT ACCEPT message, the SMF provides
either additional APN rate control for exception data parameters container, or
initial additional APN rate control for exception data parameters container,
in the Extended protocol configuration options IE, but not both.
If the network accepts the use of Reliable Data Service to transfer data for
the PDU session, the network shall include the Extended protocol configuration
options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and include the
Reliable Data Service accepted indicator. The UE behaves as described in
subclause 6.2.15.
If the UE indicates support of DNS over (D)TLS by providing DNS server
security information indicator to the network and optionally, if the UE wishes
to indicate which security protocol type(s) are supported by the UE, providing
the DNS server security protocol support and the network wants to enforce the
use of DNS over (D)TLS, the network may include the Extended protocol
configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and
include the DNS server security information with length of two octets. Upon
receiving the DNS server security information, the UE shall pass it to the
upper layer. The UE shall use this information to send the DNS over (D)TLS
(See 3GPP TS 33.501 [24]).
NOTE 20: Support of DNS over (D)TLS is based on the informative requirements
as specified in 3GPP TS 33.501 [24] and it is implemented based on the
operator requirement.
If the PDU SESSION ESTABLISHMENT REQUEST message includes the Service-level-AA
container IE with the service-level device ID set to the CAA-level UAV ID, and
the SMF is provided by the UAS-NF the successful UUAA-SM result and the CAA-
level UAV ID, the SMF shall store the successful result together with the
authorized CAA-level UAV ID and transmit the PDU SESSION ESTABLISHMENT ACCEPT
message to the UE, where the PDU SESSION ESTABLISHMENT ACCEPT message shall
include the Service-level-AA container IE containing:
a) the service-level-AA response, with the SLAR field set to \"Service level
authentication and authorization was successful\";
b) the service-level device ID with the value set to the CAA-level UAV ID;
c) if a payload is received from the UAS-NF, the service-level-AA payload with
the value set to the payload; and
d) if a payload type associated with the payload is received from the UAS-NF,
the service-level-AA payload type with the values set to the associated
payload type.
NOTE 21: UAS security information can be included in the UUAA payload by the
USS as specified in 3GPP TS 33.256 [24B].
If the network accepts the request of the PDU session establishment for C2
communication, the network shall send the PDU SESSION ESTABLISHMENT ACCEPT
message including the Service-level-AA container IE containing:
a) the service-level-AA response with the value of C2AR field set to the \"C2
authorization was successful\";
b) if a payload is provided from the UAS-NF, the service-level-AA payload with
the value set to the payload; and
c) if a payload type associated with the payload is provided from the UAS-NF,
the service-level-AA payload type with the value set to the payload type; and
d) if the CAA-level UAV ID is provided from the UAS-NF, the service-level
device ID with the value set to the CAA-level UAV ID.
NOTE 22:The C2 authorization payload in the service-level-AA payload can
include the C2 session security information.
Upon receipt of the PDU SESSION ESTABLISHMENT ACCEPT message of the PDU
session for C2 communication, if the Service-level-AA container IE is
included, the UE shall forward the service-level-AA contents of the Service-
level-AA container IE to the upper layers.
The SMF may be configured with one or more PVS IP addresses or PVS names or
both associated with the DNN and S-NSSAI used for onboarding services in SNPN,
for configuration of SNPN subscription parameters in PLMN via the user plane,
or for configuration of a UE via the user plane with credentials for NSSAA or
PDU session authentication and authorization procedure. If the PDU session was
established for onboarding services in SNPN, or the PVS information request is
included in the Extended protocol configuration options IE of the PDU SESSION
ESTABLISHMENT REQUEST message establishing a PDU session providing
connectivity for configuration of SNPN subscription parameters in PLMN via the
user plane, the network may include the Extended protocol configuration
options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and include the PVS
IP address(es) or the PVS name(s) or both associated with the DNN and S-NSSAI
of the established PDU session, if available. If the PVS information request
is included in the Extended protocol configuration options IE of the PDU
SESSION ESTABLISHMENT REQUEST message establishing the PDU session providing
connectivity for configuration of a UE via the user plane with credentials for
PDU session authentication and authorization procedure, based on the
subscribed DNN(s) and S-NSSAI(s) of the UE and the DNN and S-NSSAI of the
established PDU session, the network should include the Extended protocol
configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and
include the PVS IP address(es) or the PVS name(s) or both, which are
associated with the established PDU session and per subscribed DNN(s) and
S-NSSAI(s) of the UE, if available. If the PVS information request is included
in the Extended protocol configuration options IE of the PDU SESSION
ESTABLISHMENT REQUEST message establishing the PDU session providing
connectivity for configuration of a UE via the user plane with credentials for
NSSAA, based on the subscribed S-NSSAI(s) of the UE and the S-NSSAI of the
established PDU session, the network should include the Extended protocol
configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message and
include the PVS IP address(es) or the PVS name(s) or both, which are
associated with the established PDU session and per subscribed S-NSSAI(s) of
the UE, if available.
NOTE 23: If the PVS information request is included in the Extended protocol
configuration options IE of the PDU SESSION ESTABLISHMENT REQUEST message
establishing a PDU session providing connectivity for configuration of SNPN
subscription parameters in SNPN via the user plane by a UE which is not
registered for onboarding services in SNPN, the SMF can include the PVS IP
address(es) or the PVS name(s) or both, associated with the DNN and S-NSSAI of
the established PDU session, if available, in the Extended protocol
configuration options IE of the PDU SESSION ESTABLISHMENT ACCEPT message.
The UE upon receiving one or more PVS IP address(es), if any, one or more the
PVS name(s), if any, or both shall pass them to the upper layers.
NOTE 24: If several PVS IP addresses, several PVS name(s), or one or more PVS
IP addresses and one or more PVS name(s) are received, how the UE uses this
information is up to UE implementation.
If the UE indicates support for ECS configuration information provisioning by
providing the ECS configuration information provisioning support indicator in
the Extended protocol configuration options IE of the PDU SESSION
ESTABLISHMENT REQUEST message, then the SMF may include the Extended protocol
configuration options IE in the PDU SESSION ESTABLISHMENT ACCEPT message with
\- at least one of ECS IPv4 Address(es), ECS IPv6 Address(es), and ECS
FQDN(s);
\- at least one associated ECSP identifier; and
\- optionally, spatial validity conditions associated with the ECS address.
The UE upon receiving one or more ECS IPv4 address(es), if any, ECS IPv6
address(es), if any, or ECS FQDN(s), if any, with the associated spatial
validity condition, if any, and an ECSP identifier shall pass them to the
upper layers.
NOTE 25: The IP address(es) and/or FQDN(s) are associated with the ECSP
identifier and replace previously provided ECS configuration information
associated with the same ECSP identifier, if any.
If the SMF needs to provide DNS server address(es) to the UE and the UE has
provided the DNS server IPv4 address request, the DNS server IPv6 address
request or both of them, in the PDU SESSION ESTABLISHMENT REQUEST message,
then the SMF shall include the Extended protocol configuration options IE in
the PDU SESSION ESTABLISHMENT ACCEPT message with one or more DNS server IPv4
address(es), one or more DNS server IPv6 address(es) or both of them. If the
UE supports receiving DNS server addresses in protocol configuration options
and receives one or more DNS server IPv4 address(es), one or more DNS server
IPv6 address(es) or both of them, in the Extended protocol configuration
options IE of the PDU SESSION ESTABLISHMENT ACCEPT message, then the UE shall
pass the received DNS server IPv4 address(es), if any, and the received DNS
server IPv6 address(es), if any, to upper layers.
NOTE 26: The received DNS server address(es) replace previously provided DNS
server address(es), if any.
If the PDU SESSION ESTABLISHMENT ACCEPT message includes the Received MBS
container IE, for each of the Received MBS information:
a) if MBS decision is set to \"MBS join is accepted\", the UE shall consider
that it has successfully joined the multicast MBS session. The UE shall store
the received TMGI and shall use it for any further operation on that multicast
MBS session. The UE shall store the received MBS service area associated with
the received TMGI, if any, and provide the received TMGI to lower layers. The
UE may provide the MBS start time if it is included in the Received MBS
information to upper layers; or
b) if MBS decision is set to \"MBS join is rejected\", the UE shall consider
the requested join as rejected. The UE shall store the received MBS service
area associated with the received TMGI, if any. If the received Rejection
cause is set to \"User is outside of local MBS service area\", the UE shall
not request to join the same multicast MBS session if neither current TAI nor
CGI of the current cell is part of the received MBS service area. If the
received Rejection cause is set to \"multicast MBS session has not started or
will not start soon\" and an MBS back-off timer value is included with value
that indicates neither zero nor deactivated, the UE shall start a back-off
timer T3587 with the value provided in the MBS back-off timer value for the
received TMGI, and shall not attempt to join the multicast MBS session with
the same TMGI until the expiry of T3587. If the MBS back-off timer value
indicates that this timer is deactivated, the UE shall not attempt to join the
multicast MBS session with the same TMGI, the Source IP address information of
the TMGI, or the Destination IP address information of the TMGI until the UE
is switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated. If the MBS back-off timer value
indicates zero, the UE may attempt to join the multicast MBS session with the
same TMGI.
If the PDU session is established for IMS signalling and the UE has requested
P-CSCF IPv6 address or P-CSCF IPv4 address, the SMF shall include P-CSCF IP
address(es) in the Extended protocol configuration options IE in the PDU
SESSION ESTABLISHMENT ACCEPT message.
NOTE 27: The P-CSCF selection functionality is specified in subclause
5.16.3.11 of 3GPP TS 23.501 [8].
Upon receipt of the PDU SESSION ESTABLISHMENT ACCEPT message, if the UE
included the PDU session pair ID in the PDU SESSION ESTABLISHMENT REQUEST
message, the UE shall associate the PDU session with the PDU session pair ID.
If the UE included the RSN in the PDU SESSION ESTABLISHMENT REQUEST message,
the UE shall associate the PDU session with the RSN.
If the UE supports EDC and the network allows the use of EDC, the SMF shall
include the Extended protocol configuration options IE in the PDU SESSION
ESTABLISHMENT ACCEPT message with the EDC usage allowed indicator. If the UE
supports EDC and receives the EDC usage allowed indicator in the Extended
protocol configuration options IE of the PDU SESSION ESTABLISHMENT ACCEPT
message, the UE shall indicate to upper layers that network allows the use of
EDC.
If the UE supports EDC and the network requires the use of EDC, the SMF shall
include the Extended protocol configuration options IE in the PDU SESSION
ESTABLISHMENT ACCEPT message with the EDC usage required indicator. If the UE
supports EDC and receives the EDC usage required indicator in the Extended
protocol configuration options IE of the PDU SESSION ESTABLISHMENT ACCEPT
message, the UE shall indicate to upper layers that network requires the use
of EDC.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a MS support of MAC
address range in 5GS indicator in the Extended protocol configuration options
IE, the SMF:
a) shall consider that the UE supports a \"destination MAC address range
type\" packet filter component and a \"source MAC address range type\" packet
filter component; and
b) if the SMF supports a \"destination MAC address range type\" packet filter
component and a \"source MAC address range type\" packet filter component and
enables the UE to request QoS rules with a \"destination MAC address range
type\" packet filter component and a \"source MAC address range type\" packet
filter component, shall include the Extended protocol configuration options IE
in the PDU SESSION ESTABLISHMENT ACCEPT message and shall include the Network
support of MAC address range in 5GS indicator in the Extended protocol
configuration options IE.
If the PDU SESSION ESTABLISHMENT ACCEPT message includes a Network support of
MAC address range in 5GS indicator in the Extended protocol configuration
options IE, the UE shall consider that the network supports a \"destination
MAC address range type\" packet filter component and a \"source MAC address
range type\" packet filter component.
NOTE 28: Handling of indication that network allows the use of EDC or that
network requires the use of EDC is specified in 3GPP TS 23.548 [182].
#### 6.4.1.4 UE-requested PDU session establishment procedure not accepted by
the network
##### 6.4.1.4.1 General
If the connectivity with the requested DN is rejected by the network, the SMF
shall create a PDU SESSION ESTABLISHMENT REJECT message.
The SMF shall set the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT
message to indicate the reason for rejecting the PDU session establishment.
The 5GSM cause IE typically indicates one of the following SM cause values:
#8 operator determined barring;
#26 insufficient resources;
#27 missing or unknown DNN;
#28 unknown PDU session type;
#29 user authentication or authorization failed;
#31 request rejected, unspecified;
#32 service option not supported;
#33 requested service option not subscribed;
#35 PTI already in use;
#38 network failure;
#39 reactivation requested;
#46 out of LADN service area;
#50 PDU session type IPv4 only allowed;
#51 PDU session type IPv6 only allowed;
#54 PDU session does not exist;
#57: PDU session type IPv4v6 only allowed;
#58: PDU session type Unstructured only allowed;
#61: PDU session type Ethernet only allowed;
#67 insufficient resources for specific slice and DNN;
#68 not supported SSC mode;
#69 insufficient resources for specific slice;
#70 missing or unknown DNN in a slice;
#82 maximum data rate per UE for user-plane integrity protection is too low;
#86 UAS services not allowed; or
#95 -- 111 protocol errors.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"IPv6\", and the subscription, the SMF configuration, or both, are
limited to IPv4 only for the requested DNN, the SMF shall include the 5GSM
cause value #50 \"PDU session type IPv4 only allowed\" in the 5GSM cause IE of
the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"IPv6\", and the subscription, the SMF configuration, or both,
support none of \"IPv4\" and \"IPv6\" PDU session types for the requested DNN,
the SMF shall include the 5GSM cause value #28 \"unknown PDU session type\" in
the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"IPv4\", and the subscription, the SMF configuration, or both, are
limited to IPv6 only for the requested DNN, the SMF shall include the 5GSM
cause value #51 \"PDU session type IPv6 only allowed\" in the 5GSM cause IE of
the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"IPv4\", and the subscription, the SMF configuration, or both,
support none of \"IPv4\" and \"IPv6\" PDU session types for the requested DNN,
the SMF shall include the 5GSM cause value #28 \"unknown PDU session type\" in
the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"IPv4v6\", and the subscription, the SMF configuration, or both,
support none of \"IPv4v6\", \"IPv4\" and \"IPv6\" PDU session types for the
requested DNN, the SMF shall include the 5GSM cause value #28 \"unknown PDU
session type\" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT
message.
If the PDU SESSION ESTABLISHMENT REQUEST message includes a PDU session type
IE set to \"Unstructured\" or \"Ethernet\", and the subscription, the SMF
configuration, or both, do not support the PDU session type for the requested
DNN, the SMF shall include the 5GSM cause value #28 \"unknown PDU session
type\" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message is to establish an MA PDU
session and includes a PDU session type IE set to \"Unstructured\", and the
SMF configuration does not support the PDU session type, the SMF shall include
the 5GSM cause value #28 \"unknown PDU session type\" in the 5GSM cause IE of
the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message contains the SSC mode IE
indicating an SSC mode not supported by the subscription, the SMF
configuration, or both of them, and the SMF decides to rejects the PDU session
establishment, the SMF shall include the 5GSM cause value #68 \"not supported
SSC mode\" in the 5GSM cause IE and the SSC modes allowed by SMF in the
Allowed SSC mode IE of the PDU SESSION ESTABLISHMENT REJECT message.
If the PDU SESSION ESTABLISHMENT REQUEST message is to establish an MA PDU
session and MA PDU session is not allowed due to operator policy and
subscription, and the SMF decides to reject the PDU session establishment, the
SMF shall include the 5GSM cause value #33 \"requested service option not
subscribed\" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT
message.
If the PDU SESSION ESTABLISHMENT REQUEST message is identified to be for C2
communication and:
a) does not include the Service-level-AA container IE with the service-level
device ID set to the CAA-level UAV ID;
b) does not include the Service-level-AA container IE with the service-level-
AA payload and the Service-level-AA payload type; or-
c) the SMF is informed by the UAS-NF that the UAS service is not allowed,
the SMF shall reject the PDU SESSION ESTABLISHMENT REQUEST message by
transmitting a PDU SESSION ESTABLISHMENT REJECT message with 5GSM cause IE set
to 5GSM cause value #86 \"UAS services not allowed\".
In 3GPP access, if the operator\'s configuration requires user-plane integrity
protection for the PDU session and, the maximum data rate per UE for user-
plane integrity protection supported by the UE for uplink or the maximum data
rate per UE for user-plane integrity protection supported by the UE for
downlink, or both, are lower than required by the operator\'s configuration,
the SMF shall include the 5GSM cause value #82 \"maximum data rate per UE for
user-plane integrity protection is too low\" in the 5GSM cause IE of the PDU
SESSION ESTABLISHMENT REJECT message.
If the UE requests a PDU session establishment for an LADN when the UE is
located outside of the LADN service area, the SMF shall include the 5GSM cause
value #46 \"out of LADN service area\" in the 5GSM cause IE of the PDU SESSION
ESTABLISHMENT REJECT message.
If the DN authentication of the UE was performed with the PDU session
authentication and authorization procedure and completed unsuccessfully, the
SMF shall include the 5GSM cause value #29 \"user authentication or
authorization failed\" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT
REJECT message and shall set the EAP message IE of the PDU SESSION
ESTABLISHMENT REJECT message to an EAP-failure message as specified in IETF
RFC 3748 [34], provided by the DN.
If the DN authentication of the UE was performed with the service-level
authentication and authorization procedure and completed unsuccessfully, the
SMF shall include the 5GSM cause value #29 \"user authentication or
authorization failed\" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT
REJECT message and shall include the service-level-AA response provided by DN
in the Service-level-AA container IE of the PDU SESSION ESTABLISHMENT REJECT
message.
Based on the local policy and user\'s subscription data, if a PDU session is
being established with the request type set to \"existing PDU session\" and
the SMF determines the UE has:
a) moved between a tracking area in NB-N1 mode and a tracking area in WB-N1
mode;
b) moved between a tracking area in NB-S1 mode and a tracking area in WB-N1
mode; or
c) moved between a tracking area in WB-S1 mode and a tracking area in NB-N1
mode,
the SMF may reject the PDU SESSION ESTABLISHMENT REQUEST message and:
a) include the 5GSM cause value #39 \"reactivation requested\" in the 5GSM
cause IE of the PDU SESSION ESTABLISHMENT REJECT message; or
b) include a 5GSM cause value other than #39 \"reactivation requested\" in the
5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
NOTE 1: The included 5GSM cause value is up to the network implementation.
If the PDU session cannot be established due to resource unavailability in the
UPF, the SMF shall include the 5GSM cause value #26 \"insufficient resources\"
in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT REJECT message.
Based on the user\'s subscription data and the operator policy, if the SMF
determines that the UUAA-SM procedure needs to be performed for a UE but the
SMF does not receives the service-level device ID set to the CAA-level UAV ID
in the Service-level-AA container IE of the PDU SESSION ESTABLISHMENT REQUEST
message from the UE, the SMF shall include the 5GSM cause value #86 \"UAS
services not allowed\" in the 5GSM cause IE of the PDU SESSION ESTABLISHMENT
REJECT message.
The network may include a Back-off timer value IE in the PDU SESSION
ESTABLISHMENT REJECT message.
If the 5GSM cause value is #26 \"insufficient resources\", #67 \"insufficient
resources for specific slice and DNN\", or #69 \"insufficient resources for
specific slice\" and the PDU SESSION ESTABLISHMENT REQUEST message was
received from a UE configured for high priority access in selected PLMN or the
request type provided during the PDU session establishment is set to \"initial
emergency request\" or \"existing emergency PDU session\", the network shall
not include a Back-off timer value IE.
If the 5GSM cause value is #29 \"user authentication or authorization failed
\", the network should include a Back-off timer value IE.
If the Back-off timer value IE is included and the 5GSM cause value is
different from #26 \"insufficient resources\", #28 \"unknown PDU session
type\", #46 \"out of LADN service area\", \"#50 \"PDU session type IPv4 only
allowed\", #51 \"PDU session type IPv6 only allowed\", #54 \"PDU session does
not exist\", #57 \"PDU session type IPv4v6 only allowed\", #58 \"PDU session
type Unstructured only allowed\", #61 \"PDU session type Ethernet only
allowed\", #67 \"insufficient resources for specific slice and DNN\", #68
\"not supported SSC mode\", and #69 \"insufficient resources for specific
slice\", the network may include the Re-attempt indicator IE to indicate
whether the UE is allowed to attempt a PDN connectivity procedure in the PLMN
for the same DNN in S1 mode, and whether another attempt in S1 mode or in N1
mode is allowed in an equivalent PLMN.
If the 5GSM cause value is #50 \"PDU session type IPv4 only allowed\", #51
\"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only
allowed\", #58 \"PDU session type Unstructured only allowed\", or #61 \"PDU
session type Ethernet only allowed\", the network may include the Re-attempt
indicator IE without Back-off timer value IE to indicate whether the UE is
allowed to attempt a PDU session establishment procedure in an equivalent PLMN
in N1 mode using the same PDU session type for the same DNN (or no DNN, if no
DNN was indicated by the UE) and the same S-NSSAI (or no S-NSSAI, if no
S-NSSAI was indicated by the UE).
The SMF shall send the PDU SESSION ESTABLISHMENT REJECT message.
Upon receipt of a PDU SESSION ESTABLISHMENT REJECT message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE
shall stop timer T3580 shall release the allocated PTI value and shall
consider that the PDU session was not established.
If the PDU SESSION ESTABLISHMENT REQUEST message was sent with request type
set to \"initial emergency request\" or \"existing emergency PDU session\" and
the UE receives a PDU SESSION ESTABLISHMENT REJECT message, then the UE may:
a) inform the upper layers of the failure of the procedure; or
NOTE 2: This can result in the upper layers requesting another emergency call
attempt using domain selection as specified in 3GPP TS 23.167 [6].
b) de-register locally, if not de-registered already, attempt initial
registration for emergency services.
If the PDU SESSION ESTABLISHMENT REJECT message includes 5GSM cause #39
\"reactivation requested\" and the PDU session is being transferred from EPS
to 5GS and established with the request type set to \"existing PDU session\",
the UE should re-initiate the UE-requested PDU session establishment procedure
as specified in subclause 6.4.1 for:
a) the PDU session type associated with the transferred PDU session;
b) the SSC mode associated with the transferred PDU session;
c) the DNN associated with the transferred PDU session; and
d) the S-NSSAI associated with (if available in roaming scenarios) a mapped
S-NSSAI if provided in the UE-requested PDU session establishment procedure of
the transferred PDU session.
If the PDU SESSION ESTABLISHMENT REJECT message includes 5GSM cause #86 \"UAS
services not allowed\" and the UE has not included the service-level device ID
in the Service-level-AA container IE of the PDU SESSION ESTABLISHMENT REQUEST
message and set the value to the CAA-level UAV ID:
a) the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for
UAS services without including the CAA-level UAV ID in the service-level
device ID of the Service-level-AA container IE; and
b) upon receipt of the request from the upper layers to establish a PDU
session for UAS services, the UE shall initiate the UE-requested PDU session
establishment procedure by including the service-level device ID in the
Service-level-AA container IE of the PDU SESSION ESTABLISHMENT REQUEST message
and set the value to the CAA-level UAV ID as specified in subclause 6.4.1.2.
##### 6.4.1.4.2 Handling of network rejection due to congestion control
If:
\- the 5GSM cause value #26 \"insufficient resources\" and the Back-off timer
value IE are included in the PDU SESSION ESTABLISHMENT REJECT message; or
\- an indication that the 5GSM message was not forwarded due to DNN based
congestion control is received along a Back-off timer value and a PDU SESSION
ESTABLISHMENT REQUEST message with the PDU session ID IE set to the PDU
session ID of the PDU session;
the UE shall ignore the 5GSM congestion re-attempt indicator or the Re-attempt
indicator IE provided by the network, if any, and the UE shall take different
actions depending on the timer value received for timer T3396 in the Back-off
timer value IE or depending on the Back-off timer value received from the 5GMM
sublayer (if the UE is a UE configured for high priority access in selected
PLMN, exceptions are specified in subclause 6.2.7):
a) If the timer value indicates neither zero nor deactivated and a DNN was
provided during the PDU session establishment, the UE shall stop timer T3396
associated with the corresponding DNN, if it is running. If the timer value
indicates neither zero nor deactivated and no DNN was provided during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3396 associated with no DNN if it is running. The UE
shall then start timer T3396 with the value provided in the Back-off timer
value IE or with the Back-off timer value received from the 5GMM sublayer and:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU
SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the same DNN that was sent by the UE, until timer T3396
expires or timer T3396 is stopped; and
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without a
DNN and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or another PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without a DNN provided by
the UE, if no DNN was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", until timer T3396 expires or timer
T3396 is stopped.
The UE shall not stop timer T3396 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated and a DNN was
provided during the PDU session establishment, the UE shall stop timer T3396
associated with the corresponding DNN, if it is running. If the timer value
indicates that this timer is deactivated and no DNN was provided during the
PDU session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3396 associated with no DNN if it is running. The UE:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU
SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the same DNN until the UE is switched off, the USIM is
removed, the entry in the \"list of subscriber data\" for the current SNPN is
updated if the UE does not support access to an SNPN using credentials from a
credentials holder, or the selected entry of the \"list of subscriber data\"
is updated if the UE supports access to an SNPN using credentials from a
credentials holder, or the UE receives a PDU SESSION MODIFICATION COMMAND
message for the same DNN from the network, or a PDU SESSION AUTHENTICATION
COMMAND message for the same DNN from the network, or a PDU SESSION RELEASE
COMMAND message without the Back-off timer value IE for the same DNN from the
network; and
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without a
DNN and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or another PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without a DNN provided by
the UE, if no DNN was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", until the UE is switched off, the
USIM is removed, the entry in the \"list of subscriber data\" for the current
SNPN is updated if the UE does not support access to an SNPN using credentials
from a credentials holder, or the selected entry of the \"list of subscriber
data\" is updated if the UE supports access to an SNPN using credentials from
a credentials holder, or the UE receives a PDU SESSION MODIFICATION COMMAND
message for a non-emergency PDU session established without a DNN provided by
the UE, or a PDU SESSION AUTHENTICATION COMMAND message for a non-emergency
PDU session established without a DNN provided by the UE, or a PDU SESSION
RELEASE COMMAND message without the Back-off timer value IE for a non-
emergency PDU session established without a DNN provided by the UE.
The timer T3396 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero, the UE:
1) shall stop timer T3396 associated with the corresponding DNN, if running,
and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message for the same DNN; and
2) if no DNN was provided during the PDU session establishment and the request
type was different from \"initial emergency request\" and different from
\"existing emergency PDU session\", the UE shall stop timer T3396 associated
with no DNN, if running, and may send another PDU SESSION ESTABLISHMENT
REQUEST message without a DNN, or another PDU SESSION MODIFICATION REQUEST
message without a DNN provided by the UE.
If the Back-off timer value IE is not included or no Back-off timer value is
received from the 5GMM sublayer, then the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for
the same DNN or without a DNN.
When the timer T3396 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3396 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" to which timer T3396 is
associated (if any) is not updated, then timer T3396 is kept running until it
expires or it is stopped.
If the UE is switched off when the timer T3396 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" to which timer T3396 is associated (if any) is not updated when the UE
is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3396 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If:
\- the 5GSM cause value #67 \"insufficient resources for specific slice and
DNN\" and the Back-off timer value IE are included in the PDU SESSION
ESTABLISHMENT REJECT message; or
\- an indication that the 5GSM message was not forwarded due to S-NSSAI and
DNN based congestion control is received along a Back-off timer value and a
PDU SESSION ESTABLISHMENT REQUEST message with the PDU session ID IE set to
the PDU session ID of the PDU session;
the UE shall ignore the Re-attempt indicator IE provided by the network, if
any, and take different actions depending on the timer value received for
timer T3584 in the Back-off timer value IE or depending on the Back-off timer
value received from the 5GMM sublayer (if the UE is a UE configured for high
priority access in selected PLMN, exceptions are specified in subclause
6.2.8):
a) If the timer value indicates neither zero nor deactivated, the UE shall
stop timer T3584 associated with the same [S-NSSAI, DNN] combination as that
the UE provided during the PDU session establishment, if it is running. If the
timer value indicates neither zero nor deactivated and no DNN was provided
during the PDU session establishment and the request type was different from
\"initial emergency request\" and different from \"existing emergency PDU
session\", the UE shall stop timer T3584 associated with [S-NSSAI, no DNN]
combination as that the UE provided during the PDU session establishment, if
it is running. If the timer value indicates neither zero nor deactivated and
no S-NSSAI was provided during the PDU session establishment, the UE shall
stop timer T3584 associated with [no S-NSSAI, DNN] combination as that the UE
provided during the PDU session establishment, if it is running. If the timer
value indicates neither zero nor deactivated and neither S-NSSAI nor DNN was
provided during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop timer T3584 associated with [no
S-NSSAI, no DNN] combination as that the UE provided during the PDU session
establishment, if it is running. The timer T3584 to be stopped includes the
timer T3584 applied for all the PLMNs, if running, and the timer T3584 applied
for the registered PLMN, if running. The UE shall then start timer T3584 with
the value provided in the Back-off timer value IE or with the Back-off timer
value received from the 5GMM sublayer and:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU
SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the same [S-NSSAI, DNN] combination that was sent by
the UE, until timer T3584 expires or timer T3584 is stopped;
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST with exception of those identified in subclause 6.4.2.1, message for
the same [S-NSSAI, no DNN] combination that was sent by the UE, if no DNN was
provided during the PDU session establishment, until timer T3584 expires or
timer T3584 is stopped;
3) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or
another PDU SESSION MODIFICATION REQUEST message with exception of those
identified in subclause 6.4.2.1, for the same [no S-NSSAI, DNN] combination
that was sent by the UE, if no S-NSSAI was provided during the PDU session
establishment, until timer T3584 expires or timer T3584 is stopped; and
4) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with exception of those identified in subclause 6.4.2.1, for
the same [no S-NSSAI, no DNN] combination that was sent by the UE, if neither
S-NSSAI nor DNN was provided during the PDU session establishment, until timer
T3584 expires or timer T3584 is stopped.
The UE shall not stop timer T3584 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated, the UE:
1) shall stop timer T3584 associated with the same [S-NSSAI, DNN] combination
as that the UE provided during the PDU session establishment (including the
timer T3584 applied for all the PLMNs, if running, and the timer T3584 applied
for the registered PLMN, if running), if it is running. The UE shall not send
another PDU SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION
REQUEST message with exception of those identified in subclause 6.4.2.1, for
the same [S-NSSAI, DNN] combination that was sent by the UE, until the UE is
switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder, or the UE receives a PDU SESSION
MODIFICATION COMMAND message for the same [S-NSSAI, DNN] combination from the
network, or a PDU SESSION AUTHENTICATION COMMAND message for the same
[S-NSSAI, DNN] combination from the network, or a PDU SESSION RELEASE COMMAND
message without the Back-off timer value IE for the same [S-NSSAI, DNN]
combination from the network;
2) shall stop timer T3584 associated with the same [S-NSSAI, no DNN]
combination as that the UE provided during the PDU session establishment
(including the timer T3584 applied for all the PLMNs, if running, and the
timer T3584 applied for the registered PLMN, if running), if it is running.
The UE shall not send a PDU SESSION ESTABLISHMENT REQUEST message with request
type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or a PDU SESSION MODIFICATION REQUEST
message with exception of those identified in subclause 6.4.2.1, for the same
[S-NSSAI, no DNN] combination that was sent by the UE, if no DNN was provided
during the PDU session establishment, until the UE is switched off, the USIM
is removed, the entry in the \"list of subscriber data\" for the current SNPN
is updated if the UE does not support access to an SNPN using credentials from
a credentials holder, or the selected entry of the \"list of subscriber data\"
if the UE supports access to an SNPN using credentials from a credentials
holder, or the UE receives an PDU SESSION MODIFICATION COMMAND message for a
non-emergency PDU session established for the same [S-NSSAI, no DNN]
combination from the network, or a PDU SESSION AUTHENTICATION COMMAND message
for a non-emergency PDU session established for the same [S-NSSAI, DNN]
combination from the network, or a PDU SESSION RELEASE COMMAND message without
the Back-off timer value IE for a non-emergency PDU session established for
the same [S-NSSAI, no DNN] combination from the network;
3) shall stop timer T3584 associated with the same [no S-NSSAI, DNN]
combination as that the UE provided during the PDU session establishment
(including the timer T3584 applied for all the PLMNs, if running, and the
timer T3584 applied for the registered PLMN, if running), if it is running.
The UE shall not send a PDU SESSION ESTABLISHMENT REQUEST message, or a PDU
SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the same [no S-NSSAI, DNN] combination that was sent by
the UE, if no S-NSSAI was provided during the PDU session establishment, until
the UE is switched off, the USIM is removed, the entry in the \"list of
subscriber data\" for the current SNPN is updated, or the UE receives a PDU
SESSION MODIFICATION COMMAND message for the same [no S-NSSAI, DNN]
combination from the network, or a PDU SESSION AUTHENTICATION COMMAND message
for a non-emergency PDU session established for the same [no S-NSSAI, no DNN]
combination from the network, or a PDU SESSION RELEASE COMMAND message without
the Back-off timer value IE for the same [no S-NSSAI, DNN] combination from
the network; and
4) shall stop timer T3584 associated with the same [no S-NSSAI, no DNN]
combination as that the UE provided during the PDU session establishment
(including the timer T3584 applied for all the PLMNs, if running, and the
timer T3584 applied for the registered PLMN, if running), if it is running.
The UE shall not send a PDU SESSION ESTABLISHMENT REQUEST message with request
type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or a PDU SESSION MODIFICATION REQUEST
message with exception of those identified in subclause 6.4.2.1, for the same
[no S-NSSAI, no DNN] combination that was sent by the UE, if neither S-NSSAI
nor DNN was provided during the PDU session establishment, until the UE is
switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder, or the UE receives an PDU SESSION
MODIFICATION COMMAND message for a non-emergency PDU session established for
the same [no S-NSSAI, no DNN] combination from the network or a PDU SESSION
RELEASE COMMAND message without the Back-off timer value IE for a non-
emergency PDU session established for the same [no S-NSSAI, no DNN]
combination from the network.
The timer T3584 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero, the UE:
1) shall stop timer T3584 associated with the same [S-NSSAI, DNN] combination
as that the UE provided during the PDU session establishment (including the
timer T3584 applied for all the PLMNs, if running, and the timer T3584 applied
for the registered PLMN, if running), if it is running. The UE may send
another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION
REQUEST message for the same [S-NSSAI, DNN] combination;
2) shall stop timer T3584 associated with the same [S-NSSAI, no DNN]
combination as that the UE provided during the PDU session establishment
(including the timer T3584 applied for all the PLMNs, if running, and the
timer T3584 applied for the registered PLMN, if running), if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU
SESSION MODIFICATION REQUEST message for the same [S-NSSAI, no DNN]
combination if no DNN was provided during the PDU session establishment and
the request type was different from \"initial emergency request\" and
different from \"existing emergency PDU session\";
3) shall stop timer T3584 associated with the same [no S-NSSAI, DNN]
combination as that the UE provided during the PDU session establishment
(including the timer T3584 applied for all the PLMNs, if running, and the
timer T3584 applied for the registered PLMN, if running), if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU
SESSION MODIFICATION REQUEST message for the same [no S-NSSAI, DNN]
combination if no NSSAI was provided during the PDU session establishment; and
4) shall stop timer T3584 associated with the same [no S-NSSAI, no DNN]
combination as that the UE provided during the PDU session establishment
(including the timer T3584 applied for all the PLMNs, if running, and the
timer T3584 applied for the registered PLMN, if running), if it is running.
The UE may send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU
SESSION MODIFICATION REQUEST message for the same [no S-NSSAI, no DNN]
combination if neither S-NSSAI nor DNN was provided during the PDU session
establishment and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\".
If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The
back-off timer is applied in all PLMNs\" is included in the PDU SESSION
ESTABLISHMENT REJECT message with the 5GSM cause value #67 \"insufficient
resources for specific slice and DNN\", then the UE shall apply the timer
T3584 for all the PLMNs. Otherwise, the UE shall apply the timer T3584 for the
registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is
received from the 5GMM sublayer, then the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for
the same [S-NSSAI, DNN] combination, or for the same [S-NSSAI, no DNN]
combination, or for the same [no S-NSSAI, DNN] combination, or for the same
[no S-NSSAI, no DNN] combination.
When the timer T3584 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3584 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" to which timer T3584 is
associated (if any) is not updated, then timer T3584 is kept running until it
expires or it is stopped.
If the UE is switched off when the timer T3584 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" to which timer T3584 is associated (if any) is not updated when the UE
is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3584 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If:
\- the 5GSM cause value #69 \"insufficient resources for specific slice\" and
the Back-off timer value IE are included in the PDU SESSION ESTABLISHMENT
REJECT message; or
\- an indication that the 5GSM message was not forwarded due to S-NSSAI only
based congestion control is received along a Back-off timer value and a PDU
SESSION ESTABLISHMENT REQUEST message with the PDU session ID IE set to the
PDU session ID of the PDU session;
the UE shall ignore the Re-attempt indicator IE provided by the network, if
any, and take different actions depending on the timer value received for
timer T3585 in the Back-off timer value IE or depending on the Back-off timer
value received from the 5GMM sublayer (if the UE is a UE configured for high
priority access in selected PLMN, exceptions are specified in subclause
6.2.8):
a) If the timer value indicates neither zero nor deactivated and an S-NSSAI
was provided during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop timer T3585 associated with the
corresponding S-NSSAI, if it is running. If the timer value indicates neither
zero nor deactivated and no S-NSSAI was provided during the PDU session
establishment and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\", the UE shall
stop timer T3585 associated with no S-NSSAI if it is running. The timer T3585
to be stopped includes the timer T3585 applied for all the PLMNs, if running,
and the timer T3585 applied for the registered PLMN, if running. The UE shall
then start timer T3585 with the value provided in the Back-off timer value IE
or with the Back-off timer value received from the 5GMM sublayer and:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with exception of those identified in subclause 6.4.2.1, for a
non-emergency PDU session for the same S-NSSAI that was sent by the UE, until
timer T3585 expires or timer T3585 is stopped; and
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an
S-NSSAI and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or another PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without an S-NSSAI
provided by the UE, if no S-NSSAI was provided during the PDU session
establishment and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\", until timer
T3585 expires or timer T3585 is stopped.
The UE shall not stop timer T3585 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated and an S-NSSAI
was provided during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop timer T3585 associated with the
corresponding S-NSSAI, if it is running. If the timer value indicates that
this timer is deactivated and no S-NSSAI was provided during the PDU session
establishment and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\", the UE shall
stop timer T3585 associated with no S-NSSAI if it is running. The timer T3585
to be stopped includes the timer T3585 applied for all the PLMNs, if running,
and the timer T3585 applied for the registered PLMN, if running. The UE:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST with exception of those identified in subclause 6.4.2.1, for a non-
emergency PDU session for the same S-NSSAI until the UE is switched off, the
USIM is removed, the entry in the \"list of subscriber data\" for the current
SNPN is updated if the UE does not support access to an SNPN using credentials
from a credentials holder, or the selected entry of the \"list of subscriber
data\" is updated if the UE supports access to an SNPN using credentials from
a credentials holder, or the UE receives a PDU SESSION MODIFICATION COMMAND
message for a non-emergency PDU session for the same S-NSSAI from the network,
or a PDU SESSION AUTHENTICATION COMMAND message for a non-emergency PDU
session for the same S-NSSAI from the network, or a PDU SESSION RELEASE
COMMAND message without the Back-off timer value IE for the same S-NSSAI from
the network; and
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without an
S-NSSAI and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or another PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without an S-NSSAI
provided by the UE, if no S-NSSAI was provided during the PDU session
establishment and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\", until the UE
is switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder, or the UE receives a PDU SESSION
MODIFICATION COMMAND message for a non-emergency PDU session established
without an S-NSSAI provided by the UE, or a PDU SESSION AUTHENTICATION COMMAND
message for a non-emergency PDU session established without an S-NSSAI
provided by the UE, or a PDU SESSION RELEASE COMMAND message without the Back-
off timer value IE for a non-emergency PDU session established without an
S-NSSAI provided by the UE.
The timer T3585 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero, the UE:
1) shall stop timer T3585 associated with the corresponding S-NSSAI (including
the timer T3585 applied for all the PLMNs, if running, and the timer T3585
applied for the registered PLMN, if running), if running, and may send another
PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST
message for the same S-NSSAI; and
2) if no S-NSSAI was provided during the PDU session establishment and the
request type was different from \"initial emergency request \" and different
from \"existing emergency PDU session\", the UE shall stop timer T3585
associated with no S-NSSAI, if running, and may send another PDU SESSION
ESTABLISHMENT REQUEST message without an S-NSSAI (including the timer T3585
applied for all the PLMNs, if running, and the timer T3585 applied for the
registered PLMN, if running), or another PDU SESSION MODIFICATION REQUEST
message without an S-NSSAI provided by the UE.
If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The
back-off timer is applied in all PLMNs\" is included in the PDU SESSION
ESTABLISHMENT REJECT message with the 5GSM cause value #69 \"insufficient
resources for specific slice\", then the UE shall apply the timer T3585 for
all the PLMNs. Otherwise, the UE shall apply the timer T3585 for the
registered PLMN. Additionally, if the 5GSM congestion re-attempt indicator IE
with the CATBO bit set to \"The back-off timer is applied in the current
access type\" is included in the PDU SESSION ESTABLISHMENT REJECT message with
the 5GSM cause value #69 \"insufficient resources for specific slice\", then
the UE shall apply the timer T3585 for the current access type. Otherwise, the
UE shall apply the timer T3585 for both 3GPP access type and non-3GPP access
type.
If the Back-off timer value IE is not included or no Back-off timer value is
received from the 5GMM sublayer, then the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for
the same S-NSSAI or without an S-NSSAI.
When the timer T3585 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3585 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" to which timer T3585 is
associated (if any) is not updated, then timer T3585 is kept running until it
expires or it is stopped.
If the UE is switched off when the timer T3585 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" to which timer T3585 is associated (if any) is not updated when the UE
is switched on, the UE shall behave as follows:
let t1 be the time remaining for T3585 timeout at switch off and let t be the
time elapsed between switch off and switch on. If t1 is greater than t, then
the timer shall be restarted with the value t1 -- t. If t1 is equal to or less
than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
NOTE: As described in this subclause, upon PLMN change or inter-system change,
the UE does not stop the timer T3584 or T3585. This means the timer T3584 or
T3585 can still be running or be deactivated for the given 5GSM procedure, the
PLMN, the S-NSSAI and optionally the DNN combination when the UE returns to
the PLMN or when it performs inter-system change back from S1 mode to N1 mode.
Thus the UE can still be prevented from sending another PDU SESSION
ESTABLISHMENT REQUEST or PDU SESSION MODIFICATION REQUEST message in the PLMN
for the same S-NSSAI and optionally the same DNN.
Upon PLMN change, if T3584 is running or is deactivated for an S-NSSAI, a DNN,
and old PLMN, but T3584 is not running and is not deactivated for the S-NSSAI,
the DNN, and new PLMN, then the UE is allowed to send a PDU SESSION
ESTABLISHMENT REQUEST message for the same S-NSSAI and the same DNN in the new
PLMN.
Upon PLMN change, if T3585 is running or is deactivated for an S-NSSAI and old
PLMN, but T3585 is not running and is not deactivated for the S-NSSAI and new
PLMN, then the UE is allowed to send a PDU SESSION ESTABLISHMENT REQUEST
message for the same S-NSSAI in the new PLMN.
##### 6.4.1.4.3 Handling of network rejection not due to congestion control
If the 5GSM cause value is different from #26 \"insufficient resources\", #28
\"unknown PDU session type\", #39 \"reactivation requested\", #46 \"out of
LADN service area\", #50 \"PDU session type IPv4 only allowed\", #51 \"PDU
session type IPv6 only allowed\", #54 \"PDU session does not exist\", #57
\"PDU session type IPv4v6 only allowed\", #58 \"PDU session type Unstructured
only allowed\", #61 \"PDU session type Ethernet only allowed\", #67
\"insufficient resources for specific slice and DNN\", #68 \"not supported SSC
mode\", and #69 \"insufficient resources for specific slice\", #86 \"UAS
services not allowed\", and #33 \"requested service option not subscribed\"
upon sending PDU SESSION ESTABLISHMENT REQUEST to establish an MA PDU session,
and the Back-off timer value IE is included, the UE shall behave as follows:
(if the UE is a UE configured for high priority access in selected PLMN,
exceptions are specified in subclause 6.2.12):
a) if the timer value indicates neither zero nor deactivated and:
1) if the UE provided a DNN and S-NSSAI to the network during the PDU session
establishment and the 5GSM cause value is different from #27 \"missing or
unknown DNN\", the UE shall start the back-off timer with the value provided
in the Back-off timer value IE for the PDU session establishment procedure and
[PLMN, DNN, (mapped) HPLMN S-NSSAI] combination. The UE shall not send another
PDU SESSION ESTABLISHMENT REQUEST message for the same DNN and (mapped) HPLMN
S-NSSAI in the current PLMN, until the back-off timer expires, the UE is
switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder;
2) if the UE provided a DNN to the network during the PDU session
establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", the
UE shall start the back-off timer with the value provided in the Back-off
timer value IE for the PDU session establishment procedure and [PLMN, DNN]
combination. The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST
message for the same DNN in the current PLMN, until the back-off timer
expires, the UE is switched off, the USIM is removed, or the entry in the
\"list of subscriber data\" for the current SNPN is updated if the UE does not
support access to an SNPN using credentials from a credentials holder, or the
selected entry of the \"list of subscriber data\" is updated if the UE
supports access to an SNPN using credentials from a credentials holder;
3) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to
the network during the PDU session establishment and the 5GSM cause value is
different from #27 \"missing or unknown DNN\", it shall start the back-off
timer accordingly for the PDU session establishment procedure and the [PLMN,
DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no
S-NSSAI] combination. Dependent on the combination, the UE shall not send
another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no
S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI]
combination in the current PLMN, until the back-off timer expires, the UE is
switched off, the USIM is removed, or the entry in the \"list of subscriber
data\" for the current SNPN is updated if the UE does not support access to an
SNPN using credentials from a credentials holder, or the selected entry of the
\"list of subscriber data\" is updated if the UE supports access to an SNPN
using credentials from a credentials holder; or
4) if the UE did not provide a DNN to the network during the PDU session
establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", it
shall start the back-off timer accordingly for the PDU session establishment
procedure and the [PLMN, no DNN] combination. The UE shall not send another
PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, no DNN] in the
current PLMN, until the back-off timer expires, the UE is switched off, the
USIM is removed, or the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder;
b) if the timer value indicates that this timer is deactivated and:
1) if the UE provided a DNN and S-NSSAI to the network during the PDU session
establishment and the 5GSM cause value is different from #27 \"missing or
unknown DNN\", the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST
message for the same DNN and (mapped) HPLMN S-NSSAI in the current PLMN, until
the UE is switched off, the USIM is removed, or the entry in the \"list of
subscriber data\" for the current SNPN is updated if the UE does not support
access to an SNPN using credentials from a credentials holder, or the selected
entry of the \"list of subscriber data\" is updated if the UE supports access
to an SNPN using credentials from a credentials holder;
2) if the UE provided a DNN to the network during the PDU session
establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", the
UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the
same DNN in the current PLMN, until the UE is switched off, the USIM is
removed, or the entry in the \"list of subscriber data\" for the current SNPN
is updated if the UE does not support access to an SNPN using credentials from
a credentials holder, or the selected entry of the \"list of subscriber data\"
is updated if the UE supports access to an SNPN using credentials from a
credentials holder;
3) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to
the network during the PDU session establishment and the 5GSM cause value is
different from #27 \"missing or unknown DNN\", the UE shall not send another
PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no
S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI]
combination in the current PLMN, until the UE is switched off, the USIM is
removed, or the entry in the \"list of subscriber data\" for the current SNPN
is updated if the UE does not support access to an SNPN using credentials from
a credentials holder, or the selected entry of the \"list of subscriber data\"
is updated if the UE supports access to an SNPN using credentials from a
credentials holder; or
4) if the UE did not provide a DNN to the network during the PDU session
establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", the
UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the
same [PLMN, no DNN] in the current PLMN, until the UE is switched off, the
USIM is removed, or the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder; and
c) if the timer value indicates zero and the 5GSM cause value is different
from #27 \"missing or unknown DNN\", the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message for the same combination of [PLMN, DNN, (mapped)
HPLMN S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN
S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the current PLMN. If the timer
value indicates zero and the 5GSM cause value is #27 \"missing or unknown
DNN\", the UE may send another PDU SESSION ESTABLISHMENT REQUEST message for
the same combination of [PLMN, DNN], or [PLMN, no DNN] in the current PLMN.
If the Back-off timer value IE is not included, then the UE shall ignore the
Re-attempt indicator IE provided by the network in the PDU SESSION
ESTABLISHMENT REJECT message, if any.
a) Additionally, if the 5GSM cause value is #8 \"operator determined
barring\", #32 \"service option not supported\", #33 \"requested service
option not subscribed\" upon sending PDU SESSION ESTABLISHMENT REQUEST not to
establish an MA PDU session, or #70 \"missing or unknown DNN in a slice\",
then:
1) the UE not operating in SNPN access operation mode shall proceed as
follows:
i) if the UE is registered in the HPLMN or in a PLMN that is within the EHPLMN
list, the UE shall behave as described above in the present subclause using
the configured SM Retry Timer value as specified in 3GPP TS 24.368 [17] or in
USIM file NAS~CONFIG~ as specified in 3GPP TS 31.102 [22], if available, as
back-off timer value; and
NOTE 1: The way to choose one of the configured SM Retry Timer values for
back-off timer value is up to UE implementation if the UE is configured with:\
\- an SM Retry Timer value in ME as specified in 3GPP TS 24.368 [17]; and\ \-
an SM Retry Timer value in USIM file NAS~CONFIG~ as specified in 3GPP TS
31.102 [22].
ii) otherwise, if the UE is not registered in its HPLMN or in a PLMN that is
within the EHPLMN list, or if the SM Retry Timer value is not configured, the
UE shall behave as described above in the present subclause, using the default
value of 12 minutes for the back-off timer; or
2) the UE operating in SNPN access operation mode shall proceed as follows:
i) if:
A) the SM Retry Timer value for the current SNPN as specified in 3GPP TS
24.368 [17] is available; or
B) the UE used the USIM for registration to the current SNPN and the SM Retry
Timer value in USIM file NAS~CONFIG~ as specified in 3GPP TS 31.102 [22] is
available;
then the UE shall behave as described above in the present subclause using the
configured SM Retry Timer value as back-off timer value; or
NOTE 2: The way to choose one of the configured SM Retry Timer values for
back-off timer value is up to UE implementation if both conditions in bullets
A) and B) above are satisfied.
ii) otherwise, the UE shall behave as described above in the present
subclause, using the default value of 12 minutes for the back-off timer.
b) For 5GSM cause value #27 \"missing or unknown DNN\", then:
1) the UE not operating in SNPN access operation mode shall proceed as
follows:
i) if the UE is registered in the HPLMN or in a PLMN that is within the EHPLMN
list, the UE shall start the back-off timer with the configured SM Retry Timer
value as specified in 3GPP TS 24.368 [17] or in USIM file NAS~CONFIG~ as
specified in 3GPP TS 31.102 [22], if available, as back-off timer value for
the PDU session establishment procedure and the [PLMN, DNN] or [PLMN, no DNN]
combination. The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST
message for the same DNN in the current PLMN, until the back-off timer
expires, the UE is switched off or the USIM is removed; and
NOTE 3: The way to choose one of the configured SM Retry Timer values for
back-off timer value is up to UE implementation if the UE is configured with:\
\- an SM Retry Timer value in ME as specified in 3GPP TS 24.368 [17]; and\ \-
an SM Retry Timer value in USIM file NAS~CONFIG~ as specified in 3GPP TS
31.102 [22].
ii) otherwise, if the UE is not registered in its HPLMN or in a PLMN that is
within the EHPLMN list, or if the SM Retry Timer value is not configured, the
UE shall start the back-off timer with the default value of 12 minutes as
back-off timer value for the PDU session establishment procedure and the
[PLMN, DNN] or [PLMN, no DNN] combination. The UE shall not send another PDU
SESSION ESTABLISHMENT REQUEST message for the same DNN in the current PLMN,
until the back-off timer expires, the UE is switched off or the USIM is
removed; or
2) the UE operating in SNPN access operation mode shall proceed as follows:
i) if:
A) the SM Retry Timer value for the current SNPN as specified in 3GPP TS
24.368 [17] is available; or
B) the UE used the USIM for registration to the current SNPN and the SM Retry
Timer value in USIM file NAS~CONFIG~ as specified in 3GPP TS 31.102 [22] is
available;
then:
\- if the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall start the back-off timer with the configured
SM Retry Timer value as back-off timer value for the PDU session establishment
procedure and the [SNPN, DNN] or [SNPN, no DNN] combination. The UE shall not
send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the
current SNPN, until the back-off timer expires, the UE is switched off, or the
entry in the \"list of subscriber data\" for the current SNPN is updated; and
\- if the UE supports access to an SNPN using credentials from a credentials
holder, the UE shall start the back-off timer with the configured SM Retry
Timer value as back-off timer value for the PDU session establishment
procedure and the [SNPN, selected entry of the \"list of subscriber data\" or
selected PLMN subscription, DNN] or [SNPN, selected entry of the \"list of
subscriber data\" or selected PLMN subscription, no DNN] combination. The UE
shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same
DNN in the current SNPN using the selected entry in the \"list of subscriber
data\" or selected PLMN subscription, until the back-off timer expires, the UE
is switched off, the UICC containing the USIM is removed or the selected entry
of the \"list of subscriber data\" is updated; or
NOTE 4: The way to choose one of the configured SM Retry Timer values for
back-off timer value is up to UE implementation if both conditions in bullets
A) and B) above are satisfied.
ii) otherwise:
\- if the UE does not support access to an SNPN using credentials from a
credentials holder, the UE shall start the back-off timer with the default
value of 12 minutes as back-off timer value for the PDU session establishment
procedure and the [SNPN, DNN] or [SNPN, no DNN] combination. The UE shall not
send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the
current SNPN, until the back-off timer expires, the UE is switched off, or the
entry in the \"list of subscriber data\" for the current SNPN is updated; and
\- if the UE supports access to an SNPN using credentials from a credentials
holder, the UE shall start the back-off timer with the default value of 12 min
as back-off timer value for the PDU session establishment procedure and the
[SNPN, selected entry of the \"list of subscriber data\" or selected PLMN
subscription, DNN] or [SNPN, selected entry in the \"list of subscriber data\"
or selected PLMN subscription, no DNN] combination. The UE shall not send
another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the
current SNPN using the selected entry of the \"list of subscriber data\",
until the back-off timer expires, the UE is switched off, the UICC containing
the USIM is removed or the selected entry of the \"list of subscriber data\"
is updated; and
c) For 5GSM cause values different from #8 \"operator determined barring\",
#27 \"missing or unknown DNN\", #32 \"service option not supported\", #33
\"requested service option not subscribed\" and #70 \"missing or unknown DNN
in a slice\", the UE behaviour regarding the start of a back-off timer is
unspecified.
The UE shall not stop any back-off timer:
a) upon a PLMN change;
b) upon an inter-system change; or
c) upon registration over another access type.
If the network indicates that a back-off timer for the PDU session
establishment procedure is deactivated, then it remains deactivated;
a) upon a PLMN change;
b) upon an inter-system change; or
c) upon registration over another access type.
NOTE 5: This means the back-off timer can still be running or be deactivated
for the given 5GSM procedure when the UE returns to the PLMN or when it
performs inter-system change back from S1 mode to N1 mode. Thus, the UE can
still be prevented from sending another PDU SESSION ESTABLISHMENT REQUEST
message for the combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI], [PLMN,
DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI], [PLMN, no DNN, no
S-NSSAI] , [PLMN, DNN], or [PLMN, no DNN] in the PLMN.
If the back-off timer is started upon receipt of a PDU SESSION ESTABLISHMENT
REJECT (i.e. the timer value was provided by the network, a configured value
is available or the default value is used as explained above) or the back-off
timer is deactivated, the UE behaves as follows:
a) after a PLMN change:
1) the UE may send a PDU SESSION ESTABLISHMENT REQUEST message for the
combination of [new PLMN, DNN, (mapped) HPLMN S-NSSAI], [new PLMN, DNN, no
S-NSSAI], [new PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [new PLMN, no DNN, no
S-NSSAI] in the new PLMN, if the back-off timer is not running and is not
deactivated for the PDU session establishment procedure and the combination of
[new PLMN, DNN, (mapped) HPLMN S-NSSAI], [new PLMN, DNN, no S-NSSAI], [new
PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [new PLMN, no DNN, no S-NSSAI];
2) as an implementation option, for the 5GSM cause value #8 \"operator
determined barring\", #32 \"service option not supported\", #33 \"requested
service option not subscribed\" and #70 \"missing or unknown DNN in a slice\",
if the network does not include a Re-attempt indicator IE, the UE may decide
not to automatically send another PDU SESSION ESTABLISHMENT REQUEST message
for the same combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI], [PLMN, DNN,
no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [PLMN, no DNN, no
S-NSSAI] using the same PDU session type if the UE is registered to a new PLMN
which is in the list of equivalent PLMNs; and
3) as an implementation option, for the 5GSM cause value #27 \"missing or
unknown DNN\", if the network does not include a Re-attempt indicator IE, the
UE may decide not to automatically send another PDU SESSION ESTABLISHMENT
REQUEST message for the same combination of [PLMN, DNN] or [PLMN, no DNN]
using the same PDU session type if the UE is registered to a new PLMN which is
in the list of equivalent PLMNs;
b) if the network does not include the Re-attempt indicator IE to indicate
whether re-attempt in S1 mode is allowed, or the UE ignores the Re-attempt
indicator IE, e.g. because the Back-off timer value IE is not included, then:
1) if the UE is registered in its HPLMN or in a PLMN that is within the EHPLMN
list and the back-off timer is running for the combination of [PLMN, DNN,
(mapped) HPLMN S-NSSAI] or [PLMN, DNN, no S-NSSAI], the UE shall apply the
configured SM_RetryAtRATChange value as specified in 3GPP TS 24.368 [17] or in
USIM file NAS~CONFIG~ as specified in 3GPP TS 31.102 [22], if available, to
determine whether the UE may attempt a PDN connectivity procedure for the same
[PLMN, DNN] combination in S1 mode. If the back-off timer is running for the
combination of [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no
S-NSSAI], the same applies for the PDN connectivity procedure for the [PLMN,
no DNN] combination in S1 mode accordingly; and
NOTE 6: The way to choose one of the configured SM_RetryAtRATChange values for
back-off timer value is up to UE implementation if the UE is configured with:\
\- an SM_RetryAtRATChange value in ME as specified in 3GPP TS 24.368 [17];
and\ \- an SM_RetryAtRATChange value in USIM file NAS~CONFIG~ as specified in
3GPP TS 31.102 [22].
2) if the UE is not registered in its HPLMN or in a PLMN that is within the
EHPLMN list, or if the NAS configuration MO as specified in 3GPP TS 24.368
[17] is not available and the value for inter-system change is not configured
in the USIM file NAS~CONFIG~, then the UE behaviour regarding a PDN
connectivity procedure for the same [PLMN, DNN] or [PLMN, no DNN] combination
in S1 mode is unspecified; and
c) if the network includes the Re-attempt indicator IE indicating that re-
attempt in an equivalent PLMN is not allowed, then depending on the timer
value received in the Back-off timer value IE, for each combination of a PLMN
from the equivalent PLMN list and the respective [DNN, (mapped) HPLMN
S-NSSAI], [DNN, no S-NSSAI], [no DNN, (mapped) HPLMN S-NSSAI], or [no DNN, no
S-NSSAI] combination, the UE shall start a back-off timer for the PDU session
establishment procedure with the value provided by the network, or deactivate
the respective back-off timer as follows:
1) if the Re-attempt indicator IE additionally indicates that re-attempt in S1
mode is allowed, the UE shall start or deactivate the back-off timer for N1
mode only; and
2) otherwise, the UE shall start or deactivate the back-off timer for S1 and
N1 mode.
If the back-off timer for a [PLMN, DNN] or [PLMN, no DNN] combination, was
started or deactivated in S1 mode upon receipt of PDN CONNECTIVITY REJECT
message (see 3GPP TS 24.301 [15]) and the network indicated that re-attempt in
N1 mode is allowed, then this back-off timer does not prevent the UE from
sending a PDU SESSION ESTABLISHMENT REQUEST message in this PLMN for the same
DNN, or without DNN, after inter-system change to N1 mode. If the network
indicated that re-attempt in N1 mode is not allowed, the UE shall not send any
PDU SESSION ESTABLISHMENT REQUEST message in this PLMN for the same DNN in
combination with any S-NSSAI or without S-NSSAI, or in this PLMN without DNN
in combination with any S-NSSAI or without S-NSSAI, after inter-system change
to N1 mode until the timer expires, the UE is switched off or the USIM is
removed.
NOTE 7: The back-off timer is used to describe a logical model of the required
UE behaviour. This model does not imply any specific implementation, e.g. as a
timer or timestamp.
NOTE 8: Reference to back-off timer in this section can either refer to use of
timer T3396 or to use of a different packet system specific timer within the
UE. Whether the UE uses T3396 as a back-off timer or it uses different packet
system specific timers as back-off timers is left up to UE implementation.
When the back-off timer is running or the timer is deactivated, the UE is
allowed to initiate a PDU session establishment procedure if the procedure is
for emergency services.
If the 5GSM cause value is #28 \"unknown PDU session type\" and the PDU
SESSION ESTABLISHMENT REQUEST message contained a PDU session type IE
indicating a PDU session type, the UE shall ignore the Back-off timer value IE
and Re-attempt indicator IE provided by the network, if any. The UE may send
another PDU SESSION ESTABLISHMENT REQUEST message to establish a new PDU
session with the PDU session type IE indicating another PDU session type, e.g.
using another value which can be used for the rejected component in the same
route selection descriptor as specified in 3GPP TS 24.526 [19]. The behaviour
of the UE for 5GSM cause value #28 also applies if the PDU session is a MA PDU
Session.
If the 5GSM cause value is #39 \"reactivation requested\", the UE shall ignore
the Back-off timer value IE and Re-attempt indicator IE provided by the
network, if any.
NOTE 9: Further UE behaviour upon receipt of 5GSM cause value #39 is up to the
UE implementation.
If the 5GSM cause value is #46 \"out of LADN service area\", the UE shall
ignore the Back-off timer value IE and Re-attempt indicator IE provided by the
network, if any. If the UE is not located inside the LADN service area, the UE
shall not send another PDU SESSION ESTABLISHMENT REQUEST message or another
PDU SESSION MODIFICATION REQUEST message for the LADN DNN provided by the UE
during the PDU session establishment procedure until the LADN information for
the specific LADN DNN is updated as described in subclause 5.4.4 and subclause
5.5.1. If the UE is not located inside the LADN service area, the UE shall not
indicate the PDU session(s) for the LADN DNN provided by the UE during the PDU
session establishment procedure in the Uplink data status IE included in the
SERVICE REQUEST message until the LADN information for the specific LADN DNN
is updated as described in subclause 5.4.4 and subclause 5.5.1.
NOTE 10: Based on UE implementation, the UE locating inside the LADN service
area can send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message for the LADN DNN which was rejected with the 5GSM
cause value #46 \"out of LADN service area\".
If the 5GSM cause value is #50 \"PDU session type IPv4 only allowed\", #51
\"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only
allowed\", #58 \"PDU session type Unstructured only allowed\", or #61 \"PDU
session type Ethernet only allowed\", the UE shall ignore the Back-off timer
value IE provided by the network, if any. The UE shall evaluate the URSP rules
if available as specified in 3GPP TS 24.526 [19]. The UE shall not
subsequently send another PDU SESSION ESTABLISHMENT REQUEST message for the
same DNN (or no DNN, if no DNN was indicated by the UE) and the same (mapped)
HPLMN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) to obtain
a PDU session type different from the one allowed by the network until any of
the following conditions is fulfilled:
a) the UE is registered to a new PLMN which was not in the list of equivalent
PLMNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was
received;
b) the UE is registered to a new PLMN which was in the list of equivalent
PLMNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was
received, and either the network did not include a Re-attempt indicator IE in
the PDU SESSION ESTABLISHMENT REJECT message or the Re-attempt indicator IE
included in the message indicated that re-attempt in an equivalent PLMN is
allowed;
c) void;
d) the UE is switched off; or
e) the USIM is removed, the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder.
For the 5GSM cause values #50 \"PDU session type IPv4 only allowed\", #51
\"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only
allowed\", #58 \"PDU session type Unstructured only allowed\", and #61 \"PDU
session type Ethernet only allowed\", the UE shall ignore the value of the
RATC bit in the Re-attempt indicator IE provided by the network, if any.
NOTE 11: For the 5GSM cause values #50 \"PDU session type IPv4 only allowed\",
#51 \"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only
allowed\", #58 \"PDU session type Unstructured only allowed\", and #61 \"PDU
session type Ethernet only allowed\", re-attempt in S1 mode for the same DNN
(or no DNN, if no DNN was indicated by the UE) is only allowed using the PDU
session type(s) indicated by the network.
If the 5GSM cause value is #54 \"PDU session does not exist\", the UE shall
ignore the Back-off timer value IE and Re-attempt indicator IE provided by the
network, if any. If the PDU session establishment procedure is to perform
handover of an existing PDU session between 3GPP access and non-3GPP access,
the UE shall release locally the existing PDU session with the PDU session ID
included in the PDU SESSION ESTABLISHMENT REJECT message. The UE may initiate
another UE-requested PDU session establishment procedure with the request type
set to \"initial request\" in the subsequent PDU SESSION ESTABLISHMENT REQUEST
message to establish a PDU session with the same DNN (or no DNN, if no DNN was
indicated by the UE) and the same (mapped) HPLMN S-NSSAI (or no S-NSSAI, if no
S-NSSAI was indicated by the UE).
NOTE 12: User interaction is necessary in some cases when the UE cannot re-
establish the PDU session(s) automatically.
If the 5GSM cause value is #68 \"not supported SSC mode\", the UE shall ignore
the Back-off timer value IE and Re-attempt indicator IE provided by the
network, if any. The UE shall evaluate the URSP rules if available as
specified in 3GPP TS 24.526 [19]. The UE shall not subsequently send another
PDU SESSION ESTABLISHMENT REQUEST message for the same DNN (or no DNN, if no
DNN was indicated by the UE) and the same (mapped) HPLMN S-NSSAI (or no
S-NSSAI, if no S-NSSAI was indicated by the UE) using the same SSC mode or an
SSC mode which was not included in the Allowed SSC mode IE until any of the
following conditions is fulfilled:
a) the UE is registered to a new PLMN which was not in the list of equivalent
PLMNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was
received;
b) the SSC mode which is used to access to the DNN (or no DNN, if no DNN was
indicated by the UE) and the (mapped) HPLMN S-NSSAI (or no S-NSSAI, if no
S-NSSAI was indicated by the UE) is changed by the UE which subsequently
requests a new SSC mode in the Allowed SSC mode IE or no SSC mode;
c) the UE is switched off; or
d) the USIM is removed, the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder.
If the UE receives the 5GSM cause value is #33 \"requested service option not
subscribed\" upon sending PDU SESSION ESTABLISHMENT REQUEST to establish an MA
PDU session, the UE shall ignore the Back-off timer value IE and Re-attempt
indicator IE provided by the network, if any. The UE shall evaluate URSP
rules, if available, as specified in 3GPP TS 24.526 [19] and the UE may send
PDU SESSION ESTABLISHMENT REQUEST after evaluating those URSP rules.
If the 5GSM cause value is #86 \"UAS services not allowed\", the UE shall
ignore the Back-off timer value IE and Re-attempt indicator IE provided by the
network, if any, and shall behave as specified in subcluase 6.4.1.4.1.
Upon receipt of an indication from 5GMM sublayer that the 5GSM message was not
forwarded because the DNN is not supported or not subscribed in a slice along
with a PDU SESSION ESTABLISHMENT REQUEST message with the PDU session ID IE
set to the PDU session ID of the PDU session, the UE shall stop timer T3580,
shall abort the procedure and shall behave as follows:
a) if the timer value indicates neither zero nor deactivated, the UE shall
start the back-off timer with the value received from the 5GMM sublayer for
the PDU session establishment procedure and the [PLMN, DNN, S-NSSAI]
combination or the [PLMN, DNN, no S-NSSAI] combination, if no S-NSSAI was
provided during the PDU session establishment. The UE shall not send another
PDU SESSION ESTABLISHMENT REQUEST message in the PLMN for the same DNN and the
same S-NSSAI that were sent by the UE, or for the same DNN and no S-NSSAI if
S-NSSAI that was not sent by the UE, until:
1) the back-off timer expires;
2) the UE is switched off;
3) the USIM is removed the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder; or
4) the DNN is included in the LADN information and the network provides the
LADN information during the registration procedure or the generic UE
configuration update procedure;
b) if the timer value is not received from the 5GMM sublayer or the timer
value indicates that this timer is deactivated, the UE shall not send another
PDU SESSION ESTABLISHMENT REQUEST message in the PLMN for the same DNN and the
same S-NSSAI that were sent by the UE, or for the same DNN and no S-NSSAI if
S-NSSAI that was not sent by the UE, until:
1) the UE is switched off;
2) the USIM is removed, the entry in the \"list of subscriber data\" for the
current SNPN is updated if the UE does not support access to an SNPN using
credentials from a credentials holder, or the selected entry of the \"list of
subscriber data\" is updated if the UE supports access to an SNPN using
credentials from a credentials holder; or
3) the DNN is included in the LADN information and the network provides the
LADN information during the registration procedure or the generic UE
configuration update procedure; and
c) if the timer value indicates zero, the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message for the same combination of [PLMN, DNN,
S-NSSAI], [PLMN, DNN, no S-NSSAI] in the current PLMN.
#### 6.4.1.5 Handling the maximum number of established PDU sessions
The maximum number of PDU sessions which a UE can establish in a PLMN or SNPN
is limited by whichever is the lowest of: the maximum number of PDU session
IDs allowed by the protocol (as specified in 3GPP TS 24.007 [11] subclause
11.2.3.1b), the PLMN\'s or SNPN\'s maximum number of PDU sessions and the
UE\'s implementation-specific maximum number of PDU sessions.
If during a UE-requested PDU session establishment procedure the 5GSM sublayer
in the UE receives an indication that the 5GSM message was not forwarded
because:
a) the PLMN\'s maximum number of PDU sessions has been reached, then the UE
determines the PLMN\'s maximum number of PDU sessions as the number of active
PDU sessions it has; or
b) the SNPN\'s maximum number of PDU sessions has been reached, then the UE
determines the SNPN\'s maximum number of PDU sessions as the number of active
PDU sessions it has and associates the determined maximum number of PDU
sessions with:
1) the entry in the \"list of subscriber data\" for the current SNPN if the UE
does not support access to an SNPN using credentials from a credentials
holder; or
2) the selected entry of the \"list of subscriber data\" or the selected PLMN
subscription if the UE supports access to an SNPN using credentials from a
credentials holder.
NOTE 1: In some situations, when attempting to establish multiple PDU
sessions, the number of active PDU sessions that the UE has when 5GMM cause
#65 is received is not equal to the maximum number of PDU sessions reached in
the network.
NOTE 2: When the network supports emergency services, it is not expected that
5GMM cause #65 is returned by the network when the UE requests an emergency
PDU session.
NOTE 3: There is only one maximum number of PDU sessions for a PLMN regardless
of which access the PDU session exists in.
NOTE 4: An MA PDU session which (only) has a PDN connection established as a
user-plane resource is counted as an active PDU session when determining the
PLMN\'s maximum number of PDU sessions.
The PLMN\'s maximum number of PDU sessions applies to the PLMN in which the
5GMM cause #65 \"maximum number of PDU sessions reached\" is received. When
the UE is switched off or when the USIM is removed, the UE shall clear all
previous determinations representing PLMN\'s maximum number of PDU sessions.
The SNPN\'s maximum number of PDU sessions applies to the SNPN in which the
5GMM cause #65 \"maximum number of PDU sessions reached\" is received. When
the UE is switched off, the UE shall clear all previous determinations
representing SNPN\'s maximum number of PDU sessions. In addition:
a) if the UE does not support access to an SNPN using credentials from a
credentials holder and the entry in the \"list of subscriber data\" for the
current SNPN is updated, then the UE shall clear all previous determinations
representing SNPN\'s maximum number of PDU sessions associated with the entry
in the \"list of subscriber data\" for the current SNPN; and
b) if the UE supports access to an SNPN using credentials from a credentials
holder and:
1) the selected entry of the \"list of subscriber data\" is updated, then UE
shall clear all previous determinations representing SNPN\'s maximum number of
PDU sessions associated with the selected entry in the \"list of subscriber
data\"; or
2) the USIM associated with the selected PLMN subscription is removed, then UE
shall clear all previous determinations representing SNPN\'s maximum number of
PDU sessions associated with the selected PLMN subscription.
Upon successful registration with a new PLMN or SNPN, the UE may clear
previous determinations representing any PLMN\'s or SNPN\'s maximum number(s)
of PDU sessions.
If the maximum number of established PDU sessions is reached at the UE and the
upper layers of the UE request connectivity to a DNN the UE shall not send a
PDU SESSION ESTABLISHMENT REQUEST message unless an established PDU session is
released. If the UE needs to release an established PDU session, choosing
which PDU session to release is implementation specific, however the UE shall
not release the emergency PDU session.
If the UE needs to release a PDU session in order to request an emergency PDU
session, it shall either perform a local release of a PDU session or release a
PDU session via explicit signalling. If the UE performs a local release, the
UE shall:
a) if the PDU session is an MA PDU session:
1) perform a registration procedure for mobility and periodic registration
update to indicate PDU session status to the network over each access that
user plane resources have been established; and
2) perform a normal and periodic tracking area updating to indicate EPS bearer
context status to the network as specified in clause 5.5.3.2.2 of 3GPP TS
24.301 [15] when a PDN connection has been established as a user plance
resource; or
b) if the PDU session is a single access PDU session, perform a registration
procedure for mobility and periodic registration update to indicate PDU
session status to the network over the access the PDU session is associated
with.
#### 6.4.1.5A Handling the maximum number of allowed active user-plane
resources for PDU sessions of UEs in NB-N1 mode
For a UE in NB-N1 mode, the UE\'s maximum number of supported user-plane
resources is two (as defined in 3GPP TS 36.300 [25B]) when the UE sets the
Multiple user-plane resources support bit to \"Multiple user-plane resources
supported\" during the registration procedure for initial registration or for
mobility and periodic registration update, and one otherwise.
For a UE operating in NB-N1 mode, if:
a) the UE\'s maximum number of supported user-plane resources is one, then
only one PDU session can have active user-plane resources even though that UE
might have established more than one PDU session; or
b) the UE\'s maximum number of supported user-plane resources is two, then
only two PDU sessions can have active user-plane resources even though that UE
might have established more than two PDU sessions.
When the maximum number of active user-plane resources is reached and upper
layers request for more user-plane resources for PDU sessions other than the
PDU sessions with those active user-plane resources, the UE can choose to
release one or more of the PDU sessions with active user-plane resources to
cater for the upper layer request. The choice of which PDU sessions to be
released is implementation specific. However if there is a PDU session with an
active user-plane that is used for exception data reporting (see subclause
6.2.13), that PDU session shall not be released.
If the maximum number of active user-plane resources is reached and the upper
layers of the UE request user-plane resources for exception data reporting
(see subclause 6.2.13), the UE shall release a PDU session that has user-plane
resources to cater for the request for exception data reporting. The choice of
which PDU session to be released is implementation specific.
If the UE decides to release one or more active user-plane resources to cater
for upper layer request, the UE shall release the PDU session via explicit
5GSM signalling.
#### 6.4.1.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Expiry of timer T3580
The UE shall, on the first expiry of the timer T3580:
\- if the PDU SESSION ESTABLISHMENT REQUEST message was sent with request type
set to \"initial emergency request\" or \"existing emergency PDU session\",
then the UE may:
a) inform the upper layers of the failure of the procedure; or
NOTE 1: This can result in the upper layers requesting another emergency call
attempt using domain selection as specified in 3GPP TS 23.167 [6].
b) de-register locally, if not de-registered already, attempt initial
registration for emergency services.
If the UE sent the PDU SESSION ESTABLISHMENT REQUEST message in order to
perform a handover of an existing emergency PDU session between 3GPP access
and non-3GPP access, the UE shall consider that the emergency PDU session is
associated with the source access type.
\- otherwise, retransmit the PDU SESSION ESTABLISHMENT REQUEST message and the
PDU session information which was transported together with the initial
transmission of the PDU SESSION ESTABLISHMENT REQUEST message and shall reset
and start timer T3580, if still needed. This retransmission can be repeated up
to four times, i.e. on the fifth expiry of timer T3580, the UE shall abort the
procedure, release the allocated PTI and enter the state PROCEDURE TRANSACTION
INACTIVE. If the UE sent the PDU SESSION ESTABLISHMENT REQUEST message in
order to perform a handover of an existing non-emergency PDU session between
3GPP access and non-3GPP access, the UE shall consider that the PDU session is
associated with the source access type.
b) Upon receiving an indication that the 5GSM message was not forwarded due to
routing failure along with a PDU SESSION ESTABLISHMENT REQUEST message with
the PDU session ID IE set to the same value as the PDU session ID that was
sent by the UE, the UE shall stop timer T3580 and shall abort the procedure.
If the UE sent the PDU SESSION ESTABLISHMENT REQUEST message in order to
perform a handover of an existing PDU session between 3GPP access and non-3GPP
access, the UE shall consider that the PDU session is associated with the
source access type.
b1) Upon receiving an indication that the 5GSM message was not forwarded due
to service area restrictions along with a PDU SESSION ESTABLISHMENT REQUEST
message with the PDU session ID IE set to the same value as the PDU session ID
that was sent by the UE, the UE shall stop timer T3580 and shall abort the
procedure. If the UE sent the PDU SESSION ESTABLISHMENT REQUEST message in
order to perform a handover of an existing PDU session between 3GPP access and
non-3GPP access, the UE shall consider that the PDU session is associated with
the source access type.
b2) Upon receiving an indication that the 5GSM message was not forwarded
because the UE is registered to a PLMN via a satellite NG-RAN cell that is not
allowed to operate at the present UE location along with a PDU SESSION
ESTABLISHMENT REQUEST message with the PDU session ID IE set to the same value
as the PDU session ID that was sent by the UE, the UE shall stop timer T3580
and shall abort the procedure. The UE shall not trigger the PDU session
establishment procedure until the UE is deregistered from the PLMN.
b3) Upon receiving an indication that the 5GSM message was not forwarded
because the UE is marked in the UE\'s 5GMM context that it is not allowed to
request UAS services along with a PDU SESSION ESTABLISHMENT REQUEST message
with the PDU session ID IE set to the same value as the PDU session ID that
was sent by the UE, the UE shall stop timer T3580 and shall abort the
procedure. The UE shall not trigger the PDU session establishment procedure
until the UE is deregistered from the PLMN.
b4) Upon receiving an indication that the 5GSM message was not forwarded
because the PLMN\'s maximum number of PDU sessions has been reached along with
a PDU SESSION ESTABLISHMENT REQUEST message with the PDU session ID IE set to
the same value as the PDU session ID that was sent by the UE, the UE shall
stop timer T3580 and shall abort the procedure.
c) Collision of UE-requested PDU session establishment procedure and network-
requested PDU session release procedure.
If the UE receives a PDU SESSION RELEASE COMMAND message after sending a PDU
SESSION ESTABLISHMENT REQUEST message to the network, and the PDU session ID
in the PDU SESSION RELEASE COMMAND message is the same as the PDU session ID
in the PDU SESSION ESTABLISHMENT REQUEST message:
i) if the UE-requested PDU session establishment procedure was to request the
establishment of user plane resources on the second access for an MA PDU
session established on a first access and the Access type IE is not included
in PDU SESSION RELEASE COMMAND or the Access type IE included in PDU SESSION
RELEASE COMMAND indicates the first access, the UE shall proceed with the
network-requested PDU session release procedure, abort the UE-requested PDU
session establishment procedure, stop timer T3580, release the allocated PTI
and enter the state PROCEDURE TRANSACTION INACTIVE;
ii) if the PDU SESSION ESTABLISHMENT REQUEST message was sent with request
type set to \"existing PDU session\" or \"existing emergency PDU session\" in
order to perform a handover of an existing PDU session between 3GPP access and
non-3GPP access, the UE shall abort the PDU session establishment procedure
and proceed with the network-requested PDU session release procedure; or
iii) otherwise, the UE shall ignore the PDU SESSION RELEASE COMMAND message
and proceed with the UE-requested PDU session establishment procedure.
d) Inter-system change from N1 mode to S1 mode triggered during UE-requested
PDU session establishment procedure.
If the UE-requested PDU session establishment procedure is triggered for
handover of an existing PDU session from non-3GPP access to 3GPP access, and
the inter-system change from N1 mode to S1 mode is triggered by the NG-RAN and
the UE did not receive response to PDU session establishment request, then the
UE shall abort the procedure, stop timer T3580, and notify the upper layer of
the handover failure.
NOTE 2: This can result in the upper layer requesting re-initiation of
handover from non-3GPP access to 3GPP access after the inter-system change is
completed, if still required.
e) For an MA PDU session established on a single access, upon receipt of a PDU
SESSION ESTABLISHMENT ACCEPT message over the other access, if any value of
the selected PDU session type, selected SSC mode, 5GSM cause, PDU address,
S-NSSAI, DNN IEs in the PDU SESSION ESTABLISHMENT ACCEPT message is different
from the corresponding stored value, the UE shall perform a local release of
the MA PDU session, and perform the registration procedure for mobility and
periodic registration update with a REGISTRATION REQUEST message including the
PDU session status IE over both accesses.
f) For an MA PDU session has a PDN connection as a user-plane resource, upon
receipt of a PDU SESSION ESTABLISHMENT ACCEPT message over non-3GPP access, if
any value of the selected PDU session type, selected SSC mode, 5GSM cause, PDU
address, S-NSSAI, DNN IEs in the PDU SESSION ESTABLISHMENT ACCEPT message is
different from the corresponding stored mapped value, the UE shall perform a
local release of the MA PDU session, perform the registration procedure for
mobility and periodic registration update with a REGISTRATION REQUEST message
including the PDU session status IE over non-3GPP access, and perform the
tracking area updating procedure as specified in clause 5.5.3.2.2 of 3GPP TS
24.301 [15] with a TRACKING AREA UPDATE REQUEST message including EPS bearer
context status IE.
g) Collision of UE-requested PDU session establishment procedure initiated to
perform handover of an existing PDU session from non-3GPP access to 3GPP
access and a notification from the network with access type indicating
non-3GPP access.
If the UE receives a notification from the network with access type indicating
non-3GPP access after sending a PDU SESSION ESTABLISHMENT REQUEST message to
perform handover of an existing PDU session from non-3GPP access to 3GPP
access, the UE shall abort the PDU session establishment procedure, stop timer
T3580, proceed with the service request procedure to perform handover of
existing PDU session(s) from non-3GPP access to 3GPP access.
h) Collision of UE-requested PDU session establishment procedure and N1 NAS
signalling connection release
The UE may immediately retransmit the PDU SESSION ESTABLISHMENT REQUEST
message and stop, reset and restart timer T3580, if the following conditions
apply:
1) The original UE-requested PDU session establishment procedure was initiated
over an existing N1 NAS signalling connection;
2) the previous transmission of the PDU SESSION ESTABLISHMENT REQUEST message
was not initiated due to timer T3580 expiry; and
3) no 5GSM message related to the PDU session (e.g. PDU SESSION AUTHENTICATION
COMMAND message) was received after the PDU SESSION ESTABLISHMENT REQUEST
message was transmitted.
i) Collision of UE-requested PDU session establishment procedure and network-
requested PDU session modification procedure
If the UE receives a PDU SESSION MODIFICATION COMMAND message after sending a
PDU SESSION ESTABLISHMENT REQUEST message to the network, and the PDU session
ID in the PDU SESSION MODIFICATION COMMAND message is the same as the PDU
session ID in the PDU SESSION ESTABLISHMENT REQUEST message:
i) if the UE-requested PDU session establishment procedure was to request the
establishment of user plane resources on the second access for an MA PDU
session established on a first access, the UE shall proceed with both the UE-
requested PDU session establishment procedure and the network-requested PDU
session modification procedure; or
ii) if the PDU SESSION ESTABLISHMENT REQUEST message was sent with request
type set to \"existing PDU session\" or \"existing emergency PDU session\" in
order to perform a handover of an existing PDU session between 3GPP access and
non-3GPP access, the UE shall proceed with the UE-requested PDU session
establishment procedure and abort the network-requested PDU session
modification procedure.
#### 6.4.1.7 Abnormal cases on the network side
The following abnormal cases can be identified:
a) If the received request type is \"initial emergency request\" and there is
an existing emergency PDU session for the UE, regardless whether the PDU
session ID in the PDU SESSION ESTABLISHMENT REQUEST message is identical to
the PDU session ID of the existing PDU session, the SMF shall locally release
the existing emergency PDU session and proceed the new PDU SESSION
ESTABLISHMENT REQUEST message
b) The information for the PDU session authentication and authorization by the
external DN in PDU DN request container is not compliant with local policy and
user\'s subscription data
If the PDU session being established is a non-emergency PDU session, the
request type is not set to \"existing PDU session\", the PDU session
authentication and authorization by the external DN is required due to local
policy and user\'s subscription data and the information for the PDU session
authentication and authorization by the external DN in the SM PDU DN request
container IE is not compliant with the local policy and user\'s subscription
data, the SMF shall reject the PDU session establishment request including the
5GSM cause #29 \"user authentication or authorization failed\", in the PDU
SESSION ESTABLISHMENT REJECT message.
c) UE-requested PDU session establishment with request type set to \"initial
request\" for an existing PDU session:
If the SMF receives a PDU SESSION ESTABLISHMENT REQUEST message with a PDU
session ID identical to the PDU session ID of an existing PDU session and with
request type set to \"initial request\", the SMF shall locally release the
existing PDU session and proceed with the PDU session establishment procedure.
d) UE-requested PDU session establishment with request type \"existing PDU
session\" or \"existing emergency PDU session\" for a PDU session that does
not exist:
If the SMF receives a PDU SESSION ESTABLISHMENT REQUEST message with request
type set to \"existing PDU session\" or \"existing emergency PDU session\",
and the SMF does not have any information about that PDU session, then the SMF
shall reject the PDU session establishment procedure with the 5GSM cause set
to #54 \"PDU session does not exist\" in the PDU SESSION ESTABLISHMENT REJECT
message.
e) 5G access network cannot forward the message:
If the SMF determines based on content of the n2SmInfo attribute specified in
3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU
SESSION ESTABLISHMENT ACCEPT was not forwarded to the UE by the 5G access
network, then the SMF shall reject the PDU session establishment procedure
with the 5GSM cause set to #26 \"insufficient resources\" in the PDU SESSION
ESTABLISHMENT REJECT message.
### 6.4.2 UE-requested PDU session modification procedure
#### 6.4.2.1 General
The purpose of the UE-requested PDU session modification procedure is:
a) to enable the UE to request modification of a PDU session;
b) to indicate a change of 3GPP PS data off UE status for a PDU session;
c) to revoke the previously indicated support for reflective QoS;
d) to request specific QoS handling and segregation of service data flows;
e) to indicate to the network the relevant 5GSM parameters and capabilities
(e.g. the UE\'s 5GSM capabilities, whether the UE supports more than 16 packet
filters, the maximum data rate per UE for user-plane integrity protection
supported by the UE for uplink, the maximum data rate per UE for user-plane
integrity protection supported by the UE for downlink and whether the UE
requests the PDU session to be an always-on PDU session in the 5GS) for a PDN
connection established when in S1 mode, after an inter-system change from S1
mode to N1 mode, if the UE is a UE operating in single-registration mode in a
network supporting N26 interface and the UE has not previously successfully
performed the UE-requested PDU session modification to indicate to the network
the relevant 5GSM parameters and capabilities;
f) to delete one or more mapped EPS bearer contexts;
g) to convey a port management information container;
h) to re-negotiate header compression configuration associated to a PDU
session using control plane CIoT 5GS optimization; or
i) to enable the UE to request to join or leave one or more multicast MBS
sessions associated with a PDU session.
NOTE 1: The case c), d), e), f) and g) do not apply to PDU sessions associated
with the control plane only indication.
NOTE 2: For case e), the procedure is attempted after the first inter-system
change from S1 mode to N1 mode.
When the UE-requested PDU session modification procedure is used to indicate a
change of 3GPP PS data off UE status for a PDU session (see subclause 6.2.10),
the UE shall initiate the UE-requested PDU session modification procedure even
if the UE is outside the LADN service area or the timer T3396, T3584, T3585 or
the back-off timer is running or is deactivated.
If the UE needs to revoke the previously indicated support for reflective QoS
for a PDU session and timer T3396, T3584, T3585 or the back-off timer is
running or is deactivated, the UE shall not initiate the UE-requested PDU
session modification procedure and shall instead initiate the UE-requested PDU
session release procedure.
If the UE needs to initiate the UE-requested PDU session modification
procedure to indicate to the network the relevant 5GSM parameters and
capabilities (e.g. the UE\'s 5GSM capabilities, whether the UE supports more
than 16 packet filters, the maximum data rate per UE for user-plane integrity
protection supported by the UE for uplink, the maximum data rate per UE for
user-plane integrity protection supported by the UE for downlink and whether
the UE requests the PDU session to be an always-on PDU session in the 5GS) for
a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, the UE is a UE operating in single-registration mode
in the network supporting N26 interface, the UE has not previously
successfully performed the UE-requested PDU session modification to indicate
to the network the relevant 5GSM parameters and capabilities, and:
a) timer T3396, T3584, T3585 or the back-off timer is running, the UE shall
initiate the UE-requested PDU session modification procedure after expiry of
timer T3396, T3584 or T3585 or after expiry of the back-off timer; or
b) the UE is in _substate 5GMM-REGISTERED.NON-ALLOWED-SERVICE and has not
performed the_ the UE-requested PDU session modification procedure (see
subclause 5.3.5)_,_ the UE shall initiate the UE-requested PDU session
modification procedure after entering _substate 5GMM-REGISTERED.NORMAL-
SERVICE_.
#### 6.4.2.2 UE-requested PDU session modification procedure initiation
In order to initiate the UE-requested PDU session modification procedure, the
UE shall create a PDU SESSION MODIFICATION REQUEST message.
The UE shall allocate a PTI value currently not used and shall set the PTI IE
of the PDU SESSION MODIFICATION REQUEST message to the allocated PTI value.
The UE shall not perform the UE-requested PDU session modification procedure
for an emergency PDU session, except for a procedure initiated according to
subclause 6.4.2.1, item e) only, and for the error cases described in
subclause 6.4.1.3 and subclause 6.3.2.3.
The UE shall not perform the UE-requested PDU session modification procedure
for a PDU session for LADN when the UE is located outside the LADN service
area except for indicating a change of 3GPP PS data off UE status.
If the UE requests a specific QoS handling and the PDU session is not
associated with the control plane only indication, the UE shall include the
Requested QoS rules IE indicating requested QoS rules or the Requested QoS
flow descriptions IE indicating requested QoS flow descriptions or both for
the specific QoS handling. The Requested QoS rules IE includes the packet
filters which describe the service data flows requested by the UE. The
specific QoS parameters requested by the UE are specified in the Requested QoS
flow descriptions IE. If the UE requests the network to bind specific service
data flows to a dedicated QoS flow, the UE shall create a new QoS rule by
setting the rule operation code to \"Create new QoS rule\" and shall set the
segregation bit to \"Segregation requested\" for the corresponding QoS rule in
the Requested QoS rules IE. The UE shall set the QRI values to \"no QoS rule
identifier assigned\" in the Requested QoS rules IE, if the QoS rules are
newly created; otherwise, the UE shall set the QRI values to those of the
existing QoS rules for which the specific QoS handling applies. The UE shall
set the QFI values to \"no QoS flow identifier assigned\" in the Requested QoS
flow descriptions IE, if the QoS flow descriptions are newly created;
otherwise, the UE shall set the QFI values to the QFIs of the existing QoS
flow descriptions for which the specific QoS handling applies. The UE shall
not request to create more than one QoS flow in a UE-requested PDU session
modification procedure. If the SMF receives a PDU SESSION MODIFICATION REQUEST
message with a Requested QoS rules IE containing more than one QoS rule with
the rule operation code set to \"Create new QoS rule\", the SMF shall assign
the same QFI to all the QoS rules which are created.
If the UE requests to join or leave one or more multicast MBS sessions
associated with a PDU session, the UE shall include the Requested MBS
container IE in the PDU SESSION MODIFICATION REQUEST message and shall set the
MBS operation to \"Join multicast MBS session\" for the join case or to
\"Leave multicast MBS session\" for the leave case. The UE shall include the
multicast MBS session information(s) and shall set the Type of multicast MBS
session ID for each of the multicast MBS session information to either
\"Temporary Mobile Group Identity (TMGI)\" or \"Source specific IP multicast
address\" depending on the type of the multicast MBS session ID available in
the UE. Then the remaining values of each of the multicast MBS session
informations shall be set as following:
a) if the Type of multicast MBS session ID is set to \"Temporary Mobile Group
Identity (TMGI)\", the UE shall set the multicast MBS session ID to the TMGI;
or
b) if the Type of multicast MBS session ID is set to \"Source specific IP
multicast address for IPv4\" or \" Source specific IP multicast address for
IPv6\", the UE shall set the Source IP address information and the Destination
IP address information to the corresponding values.
The UE should not request to join a multicast MBS session for local MBS
service if neither current TAI nor CGI of the current cell is part of the MBS
service area(s) of the multicast MBS session, if the UE has valid information
of the MBS service area(s) of the multicast MBS session.
NOTE 1: The UE obtains the details of the multicast MBS session ID(s) i.e.
TMGI, Source IP address information and Destination IP address information as
a pre-configuration in the UE or during the MBS service announcement which is
out of scope of this specification.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, if the UE is a UE operating in single-registration
mode in a network supporting N26 interface, the PDU session is of \"IPv4\",
\"IPv6\", \"IPv4v6\", or \"Ethernet\" PDU session type, the PDU session is not
associated with the control plane only indication:
a) the UE is performing the PDU session modification procedure to indicate the
support of reflective QoS and the UE has not previously successfully performed
the UE-requested PDU session modification to provide this indication, the UE
shall set the RQoS bit to \"Reflective QoS supported\" in the 5GSM capability
IE of the PDU SESSION MODIFICATION REQUEST message; or
b) the UE is performing the PDU session modification procedure to indicate
that reflective QoS is not supported and the UE has not previously
successfully performed the UE-requested PDU session modification to provide
this indication, the UE shall set the RQoS bit to \"Reflective QoS not
supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST
message.
If the UE is performing the PDU session modification procedure to revoke the
previously indicated support of reflective QoS and the PDU session is not
associated with the control plane only indication, the UE shall set the RQoS
bit to \"Reflective QoS not supported\" in the 5GSM capability IE of the PDU
SESSION MODIFICATION REQUEST message. The UE shall not indicate support for
reflective QoS for this PDU Session for the remaining lifetime of the PDU
Session.
NOTE 2: The determination to revoke the usage of reflective QoS by the UE for
a PDU session is implementation dependent.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, if the UE is a UE operating in single-registration
mode in a network supporting N26 interface, the PDU session is of \"IPv6\" or
\"IPv4v6\" PDU session type, the PDU session is not associated with the
control plane only indication:
a) the UE is performing the PDU session modification procedure to indicate the
support of Multi-homed IPv6 PDU session and the UE has not previously
successfully performed the UE-requested PDU session modification to provide
this indication, the UE shall set the MH6-PDU bit to \"Multi-homed IPv6 PDU
session supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION
REQUEST message; or
b) the UE is performing the PDU session modification procedure to indicate
that Multi-homed IPv6 PDU session is not supported and the UE has not
previously successfully performed the UE-requested PDU session modification to
provide this indication, the UE shall set the MH6-PDU bit to \"Multi-homed
IPv6 PDU session not supported\" in the 5GSM capability IE of the PDU SESSION
MODIFICATION REQUEST message.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, if the UE is a UE operating in single-registration
mode in a network supporting N26 interface, the PDU session is of \"IPv4\",
\"IPv6\", \"IPv4v6\", or \"Ethernet\" PDU session type, the PDU session is not
associated with the control plane only indication, the UE supports more than
16 packet filters for this PDU session, and the UE has not previously
successfully performed the UE-requested PDU session modification to provide
this indication, the UE shall indicate the maximum number of packet filters
supported for the PDU session in the Maximum number of supported packet
filters IE of the PDU SESSION MODIFICATION REQUEST message.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, if the UE is a UE operating in single-registration
mode in a network supporting N26 interface, the PDU session is not associated
with the control plane only indication, and the UE has not previously
successfully performed the UE-requested PDU session modification to include
the Integrity protection maximum data rate IE in the PDU SESSION MODIFICATION
REQUEST message, the UE shall include the Integrity protection maximum data
rate IE in the PDU SESSION MODIFICATION REQUEST message.
If the UE is performing the PDU session modification procedure
a) to request the deletion of a non-default QoS rule due to errors in QoS
operations or packet filters;
b) to request the deletion of a QoS flow description due to errors in QoS
operations; or
c) to request the deletion of a mapped EPS bearer context due to errors in
mapped EPS bearer operation, TFT operation or packet filters,
the UE shall include the 5GSM cause IE in the PDU SESSION MODIFICATION REQUEST
message as described in subclauses 6.3.2.3, 6.3.2.4 and 6.4.1.3.
When the UE-requested PDU session modification procedure is used to indicate a
change of 3GPP PS data off UE status for a PDU session, the UE shall include
the Extended protocol configuration options IE in the PDU SESSION MODIFICATION
REQUEST message and setting the 3GPP PS data off UE status.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, if the UE is a UE operating in single-registration
mode in a network supporting N26 interface, the PDU session is not associated
with the control plane only indication, the UE requests the PDU session to be
an always-on PDU session in the 5GS and the UE has not previously successfully
performed the UE-requested PDU session modification to request this, the UE
shall include the Always-on PDU session requested IE and set the value of the
IE to \"Always-on PDU session requested\" in the PDU SESSION MODIFICATION
REQUEST message.
If a port management information container needs to be delivered (see 3GPP TS
23.501 [8] and 3GPP TS 23.502 [9]), the UE shall include a Port management
information container IE in the PDU SESSION MODIFICATION REQUEST message.
To request re-negotiation of IP header compression configuration, the UE shall
include the IP header compression configuration IE in the PDU SESSION
MODIFICATION REQUEST message if the network indicated \"Control plane CIoT 5GS
optimization supported\" and \"IP header compression for control plane CIoT
5GS optimization supported\" in the 5GS network support feature support IE.
To request re-negotiation of Ethernet header compression configuration, the UE
shall include the Ethernet header compression configuration IE in the PDU
SESSION MODIFICATION REQUEST message if the network indicated \"Control plane
CIoT 5GS optimization supported\" and \"Ethernet header compression for
control plane CIoT 5GS optimization supported\" in the 5GS network support
feature support IE.
After an inter-system change from S1 mode to N1 mode, if:
a) the UE is operating in single-registration mode in the network supporting
N26 interface;
b) the PDU session type value of the PDU session type IE is set to \"IPv4\",
\"IPv6\" or \"IPv4v6\";
c) the UE indicates \"Control plane CIoT 5GS optimization supported\" and \"IP
header compression for control plane CIoT 5GS optimization supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message; and
d) the network indicates \"Control plane CIoT 5GS optimization supported\" and
\"IP header compression for control plane CIoT 5GS optimization supported\" in
the 5GS network support feature IE of the REGISTRATION ACCEPT message;
the UE shall initiate the PDU session modification procedure to negotiate the
IP header compression configuration and include the IP header compression
configuration IE in the PDU SESSION MODIFICATION REQUEST message.
The UE shall include the Service-level-AA container IE in the PDU SESSION
MODIFICATION REQUEST message, when requesting to modify an established PDU
session for C2 communication. In the Service-level-AA container IE, the UE
shall include:
a) the service-level device ID with the value set to the CAA-level UAV ID of
the UE; and
b) if available, the service-level-AA payload with the value set to the C2
authorization payload and the service-level-AA payload type with the value set
to \"C2 authorization payload\".
NOTE 3: The C2 authorization payload in the service-level-AA payload can
include the pairing information for C2 communication and the UAV flight
authorization information.
After an inter-system change from S1 mode to N1 mode, if:
a) the UE is operating in single-registration mode in a network that supports
N26 interface;
b) the PDU session type value of the PDU session type IE is set to
\"Ethernet\";
c) the UE indicates \"Control plane CIoT 5GS optimization supported\" and
\"Ethernet header compression for control plane CIoT 5GS optimization
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and
d) the network indicates \"Control plane CIoT 5GS optimization supported\" and
\"Ethernet header compression for control plane CIoT 5GS optimization
supported\" in the 5GS network support feature IE of the REGISTRATION ACCEPT
message;
the UE shall initiate the PDU session modification procedure to negotiate the
Ethernet header compression configuration and include the Ethernet header
compression configuration IE in the PDU SESSION MODIFICATION REQUEST message.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, and if the UE is a UE operating in single-
registration mode in a network supporting N26 interface, and the UE supports
receiving DNS server addresses in protocol configuration options and the UE
has not previously successfully performed the UE-requested PDU session
modification to indicate this support, the UE shall include the Extended
protocol configuration options IE in the PDU SESSION MODIFICATION REQUEST
message and:
a) if the PDU session is of \"IPv4\" or \"IPv4v6\" PDU session type, the UE
shall include the DNS server IPv4 address request; and
b) if the PDU session is of \"IPv6\" or \"IPv4v6\" PDU session type, the UE
shall include the DNS server IPv6 address request.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, and if the UE is a UE operating in single-
registration mode in a network supporting N26 interface, and the UE supports
the EAS rediscovery and the UE has not previously successfully performed the
UE-requested PDU session modification to indicate this support, the UE shall
include the Extended protocol configuration options IE in the PDU SESSION
MODIFICATION REQUEST message and shall include the EAS rediscovery support
indication in the Extended protocol configuration options IE.
For a PDN connection established when in S1 mode, after an inter-system change
from S1 mode to N1 mode, and if the UE is a UE operating in single-
registration mode in a network supporting N26 interface, and the UE supports
the EDC and the UE has not previously successfully performed the UE-requested
PDU session modification to indicate this support, then the UE shall include
the Extended protocol configuration options IE in the PDU SESSION MODIFICATION
REQUEST message and shall include the EDC support indicator in the Extended
protocol configuration options IE.
The UE shall transport:
a) the PDU SESSION MODIFICATION REQUEST message;
b) the PDU session ID; and
c) if the UE-requested PDU session modification:
1) is not initiated to indicate a change of 3GPP PS data off UE status
associated to a PDU session, then the request type set to \"modification
request\"; and
2) is initiated to indicate a change of 3GPP PS data off UE status associated
to a PDU session, then without transporting the request type;
using the NAS transport procedure as specified in subclause 5.4.5, and the UE
shall start timer T3581 (see example in figure 6.4.2.2.1).
For a PDN connection established when in S1 mode and not associated with the
control plane only indication, after inter-system change from S1 mode to N1
mode, if the UE is registered in a network supporting the ATSSS,
a) the UE may request to modify a PDU session to an MA PDU session; or
b) the UE may allow the network to upgrade the PDU session to an MA PDU
session. In order for the UE to allow the network to upgrade the PDU session
to an MA PDU session, the UE shall set \"MA PDU session network upgrade is
allowed\" in the MA PDU session information IE and set the request type to
\"modification request\" in the UL NAS TRANSPORT message.
NOTE 4: If the DNN corresponds to an LADN DNN, the AMF does not forward the MA
PDU session information IE to the SMF but sends the message back to the UE to
inform of the unhandled request (see subclause 5.4.5.2.5).
In case the UE executes case a) or b):
1) if the UE supports ATSSS Low-Layer functionality with any steering mode as
specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the
ATSSS-ST bits to \"ATSSS Low-Layer functionality with any steering mode
supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST
message;
2) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL
functionality with only Active-Standby steering mode as specified in subclause
5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP
functionality with any steering mode and ATSSS-LL functionality with only
Active-Standby steering mode supported\" in the 5GSM capability IE of the PDU
SESSION MODIFICATION REQUEST message;
3) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL
functionality with any steering mode as specified in subclause 5.32.6 of 3GPP
TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP functionality
with any steering mode and ATSSS-LL functionality with any steering mode
supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST
message; and
4) if a performance measurement function in the UE can perform access
performance measurements using the QoS flow of the non-default QoS rule as
specified in subclause 5.32.5 of 3GPP TS 23.501 [8], the UE shall set the
APMQF bit to \"Access performance measurements per QoS flow supported\" in the
5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.
Upon receipt of a PDU SESSION MODIFICATION REQUEST message for MA PDU session
modification, the SMF shall check if the 5GSM capability IE in the PDU SESSION
MODIFICATION REQUEST message, includes:
a) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode and
ATSSS-LL functionality with only active-standby steering mode supported\" and:
i) if the DNN configuration allows for the MPTCP functionality with any
steering mode and ATSSS-LL functionality with any steering mode, the SMF shall
ensure that the modified PDU session has the capability of MPTCP with any
steering mode and ATSSS-LL with any steering mode in the downlink and MPTCP
with any steering mode and ATSSS-LL with only active-standby steering mode in
the uplink; or
ii) if the DNN configuration allows for the MPTCP functionality with any
steering mode and ATSSS-LL functionality with only active-standby steering
mode, the SMF shall ensure that the modified PDU session has the capability of
MPTCP with any steering mode and ATSSS-LL with only active-standby steering
mode in the downlink and the uplink;
b) the ATSSS-ST bits set to \"ATSSS Low-Layer functionality with any steering
mode allowed for ATSSS-LL supported\" and if the DNN configuration allows for
the ATSSS-LL functionality with any steering mode, the SMF shall ensure that
the modified PDU session has the capability of ATSSS-LL with any steering mode
in the downlink and the uplink; or
c) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode and
ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\"
and if the DNN configuration allows for the MPTCP functionality with any
steering mode and ATSSS-LL functionality with any steering mode, the SMF shall
ensure that the modified PDU session has the capability of MPTCP with any
steering mode and ATSSS-LL with any steering mode in the downlink and the
uplink.
Figure 6.4.2.2.1: UE-requested PDU session modification procedure
#### 6.4.2.3 UE-requested PDU session modification procedure accepted by the
network
Upon receipt of a PDU SESSION MODIFICATION REQUEST message, if the SMF accepts
the request to modify the PDU session, the SMF shall perform the network-
requested PDU session modification procedure as specified in subclause 6.3.2.
If the PDU SESSION MODIFICATION REQUEST message contains a Port management
information container IE, the SMF shall handle the contents of the Port
management information container IE as specified in 3GPP TS 23.501 [8] and
3GPP TS 23.502 [9].
#### 6.4.2.4 UE-requested PDU session modification procedure not accepted by
the network
##### 6.4.2.4.1 General
Upon receipt of a PDU SESSION MODIFICATION REQUEST message, if the SMF does
not accepts the request to modify the PDU session, the SMF shall create a PDU
SESSION MODIFICATION REJECT message.
The SMF shall set the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT
message to indicate the reason for rejecting the PDU session modification.
The 5GSM cause IE typically indicates one of the following SM cause values:
#26 insufficient resources;
#29 user authentication or authorization failed;
#31 request rejected, unspecified;
#32 service option not supported;
#33 requested service option not subscribed;
#35 PTI already in use;
#37 5GS QoS not accepted;
#43 Invalid PDU session identity;
#44 Semantic errors in packet filter(s);
#45 Syntactical error in packet filter(s);
#46 out of LADN service area;
#59 unsupported 5QI value;
#67 insufficient resources for specific slice and DNN;
#69 insufficient resources for specific slice;
#83 Semantic error in the QoS operation;
#84 Syntactical error in the QoS operation; or
#95 -- 111 protocol errors.
If the UE requests a PDU session modification for an LADN when the UE is
located outside of the LADN service area, the SMF shall include the 5GSM cause
value #46 \"out of LADN service area\" in the 5GSM cause IE of the PDU SESSION
MODIFICATION REJECT message.
If the Extended protocol configuration options IE of the PDU SESSION
MODIFICATION REQUEST message indicates 3GPP PS data off UE status and the SMF
detects the change of the 3GPP PS data off UE status, the SMF shall not
include the 5GSM cause value #26 \"insufficient resources\", the 5GSM cause
value #67 \"insufficient resources for specific slice and DNN\", the 5GSM
cause value #69 \"insufficient resources for specific slice\" and the 5GSM
cause value #46 \"out of LADN service area\" in the 5GSM cause IE of the PDU
SESSION MODIFICATION REJECT message.
If the UE initiates UE-requested PDU session modification procedure to modify
the PDU session transferred from EPS to an MA PDU session with the Request
type IE set to \"MA PDU request\" in the UL NAS TRANSPORT message as specified
in 3GPP TS 24.193 [13B] and the SMF determines, based on operator policy and
subscription information, that the PDU SESSION MODIFICATION REQUEST message is
to be rejected, the SMF shall include the 5GSM cause value #33 \"requested
service option not subscribed\" in the 5GSM cause IE of the PDU SESSION
MODIFICATION REJECT message.
NOTE: If the SMF determines, based on operator policy and subscription
information, that the PDU SESSION MODIFICATION REQUEST message is to be
accepted as single access PDU session, the ATSSS container IE cannot be
included in the PDU SESSION MODIFICATION COMMAND message.
The network may include a Back-off timer value IE in the PDU SESSION
MODIFICATION REJECT message.
If the 5GSM cause value is #26\"insufficient resources\", #67 \"insufficient
resources for specific slice and DNN\", or #69 \"insufficient resources for
specific slice\" and the PDU SESSION MODIFICATION REQUEST message was received
from a UE configured for high priority access in selected PLMN or the request
type provided during the PDU session establishment is set to \"initial
emergency request\" or \"existing emergency PDU session\", the network shall
not include a Back-off timer value IE.
The SMF shall send the PDU SESSION MODIFICATION REJECT message.
Upon receipt of a PDU SESSION MODIFICATION REJECT message and a PDU session
ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE
shall stop timer T3581, release the allocated PTI value, and enter the state
PROCEDURE TRANSACTION INACTIVE.
##### 6.4.2.4.2 Handling of network rejection due to congestion control
If:
\- the 5GSM cause value #26 \"insufficient resources\" and the Back-off timer
value IE are included in the PDU SESSION MODIFICATION REJECT message; or
\- an indication that the 5GSM message was not forwarded due to DNN based
congestion control is received along a Back-off timer value and a PDU SESSION
MODIFICATION REQUEST message with the PDU session ID IE set to the PDU session
ID of the PDU session;
the UE shall ignore the Re-attempt indicator IE or the 5GSM congestion re-
attempt indicator IE provided by the network, if any, and the UE shall take
different actions depending on the timer value received for timer T3396 in the
Back-off timer value IE or depending on the Back-off timer value received from
the 5GMM sublayer (if the UE is a UE configured for high priority access in
selected PLMN, exceptions are specified in subclause 6.2.7):
a) If the timer value indicates neither zero nor deactivated and a DNN was
provided during the PDU session establishment, the UE shall stop timer T3396
associated with the corresponding DNN, if it is running. If the timer value
indicates neither zero nor deactivated and no DNN was provided during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3396 associated with no DNN if it is running. The UE
shall then start timer T3396 with the value provided in the Back-off timer
value IE or with the Back-off timer value received from the 5GMM sublayer and:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or PDU
SESSION MODIFICATION REQUEST message with exception of those identified in
subclause 6.4.2.1, for the same DNN that was sent by the UE, until timer T3396
expires or timer T3396 is stopped; and
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without a
DNN and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or another PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without a DNN provided by
the UE, if no DNN was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", until timer T3396 expires or timer
T3396 is stopped.
The UE shall not stop timer T3396 upon a PLMN change or inter-system change.
b) if the timer value indicates that this timer is deactivated and a DNN was
provided during the PDU session establishment, the UE shall stop timer T3396
associated with the corresponding DNN, if it is running. If the timer value
indicates that this timer is deactivated and no DNN was provided during the
PDU session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3396 associated with no DNN if it is running. The UE:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU
SESSION MODIFICATION REQUEST with exception of those identified in subclause
6.4.2.1, for the same DNN until the UE is switched off, the USIM is removed,
the entry in the \"list of subscriber data\" for the current SNPN is updated,
or the UE receives a PDU SESSION MODIFICATION COMMAND message for the same DNN
from the network, or a PDU SESSION AUTHENTICATION COMMAND message for the same
DNN from the network, or a PDU SESSION RELEASE COMMAND message without the
Back-off timer value IE for the same DNN from the network; and
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message without a
DNN and with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or another PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for a non-emergency PDU session established without a DNN provided by
the UE, if no DNN was provided during the PDU session establishment and the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\", until the UE is switched off, the
USIM is removed, the entry in the \"list of subscriber data\" for the current
SNPN is updated, or the UE receives a PDU SESSION MODIFICATION COMMAND message
for a non-emergency PDU session established without a DNN provided by the UE,
a PDU SESSION AUTHENTICATION COMMAND message for a non-emergency PDU session
established without a DNN provided by the UE, or a PDU SESSION RELEASE COMMAND
message without the Back-off timer value IE for a non-emergency PDU session
established without a DNN provided by the UE.
The timer T3396 remains deactivated upon a PLMN change or inter-system change.
c) if the timer value indicates zero, the UE:
1) shall stop timer T3396 associated with the corresponding DNN, if running,
and may send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message for the same DNN; and
2) if no DNN was provided during the PDU session establishment and the request
type was different from \"initial emergency request\" and different from
\"existing emergency PDU session\", the UE shall stop timer T3396 associated
with no DNN, if running, and may send another PDU SESSION ESTABLISHMENT
REQUEST message without a DNN, or another PDU SESSION MODIFICATION REQUEST
message without a DNN provided by the UE.
If the Back-off timer value IE is not included or no Back-off timer value is
received from the 5GMM sublayer, then the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for
the same DNN or without a DNN.
If the timer T3396 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" for the SNPN to which timer T3396
is associated (if any) is not updated, then timer T3396 is kept running until
it expires or it is stopped
When the timer T3396 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the UE is switched off when the timer T3396 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" for the SNPN to which timer T3396 is associated (if any) is not updated
when the UE is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3396 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If the UE is a UE operating in single-registration mode in a network
supporting N26 interface and the PDU SESSION MODIFICATION REQUEST message was
sent for a PDN connection established when in S1 mode after an inter-system
change from S1 mode to N1 mode and timer T3396 associated with the
corresponding DNN (or no DNN) is running, then the UE shall re-initiate the
UE-requested PDU session modification procedure after expiry of timer T3396.
If:
\- the 5GSM cause value #67 \"insufficient resources for specific slice and
DNN\" and the Back-off timer value IE are included in the PDU SESSION
MODIFICATION REJECT message; or
\- an indication that the 5GSM message was not forwarded due to S-NSSAI and
DNN based congestion control is received along a Back-off timer value and a
PDU SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the
PDU session ID of the PDU session;
the UE shall ignore the Re-attempt indicator IE provided by the network, if
any, and take different actions depending on the timer value received for
timer T3584 in the Back-off timer value IE or depending on the Back-off timer
value received from the 5GMM sublayer (if the UE is a UE configured for high
priority access in selected PLMN, exceptions are specified in subclause
6.2.8):
a) If the timer value indicates neither zero nor deactivated, and both an
S-NSSAI and a DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of
the PDU session, DNN] combination, if it is running. If the timer value
indicates neither zero nor deactivated, an S-NSSAI and no DNN was provided
during the PDU session establishment and the request type was different from
\"initial emergency request\" and different from \"existing emergency PDU
session\", the UE shall stop timer T3584 associated with [S-NSSAI of the PDU
session, no DNN] combination, if it is running. If the timer value indicates
neither zero nor deactivated, no S-NSSAI and a DNN was provided during the PDU
session establishment, the UE shall stop timer T3584 associated with the [no
S-NSSAI, DNN] combination, if it is running. If the timer value indicates
neither zero nor deactivated and neither S-NSSAI nor DNN was provided during
the PDU session establishment and the request type was different from
\"initial emergency request\" and different from \"existing emergency PDU
session\", the UE shall stop timer T3584 associated with the [no S-NSSAI, no
DNN] combination, if it is running. The timer T3584 to be stopped includes the
timer T3584 applied for all the PLMNs, if running, and the timer T3584 applied
for the registered PLMN, if running. The UE shall then start timer T3584 with
the value provided in the Back-off timer value IE or with the Back-off timer
value received from the 5GMM sublayer and:
1) shall not send another PDU SESSION ESTABLISHMENT REQUEST message or PDU
SESSION MODIFICATION REQUEST message with the exception of those identified in
subclause 6.4.2.1, for the [S-NSSAI, DNN] combination, until timer T3584
expires or timer T3584 is stopped;
2) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with the exception of those identified in subclause 6.4.2.1,
for the [S-NSSAI of the PDU session, no DNN] combination, if no DNN was
provided during the PDU session establishment, until timer T3584 expires or
timer T3584 is stopped;
3) shall not send another PDU SESSION ESTABLISHMENT REQUEST message, or
another PDU SESSION MODIFICATION REQUEST message with the exception of those
identified in subclause 6.4.2.1, for the [no S-NSSAI, DNN] combination, if no
S-NSSAI was provided during the PDU session establishment, until timer T3584
expires or timer T3584 is stopped; and
4) shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with the exception of those identified in subclause 6.4.2.1,
for the [no S-NSSAI, no DNN] combination, if neither S-NSSAI nor DNN was
provided during the PDU session establishment, until timer T3584 expires or
timer T3584 is stopped.
The UE shall not stop timer T3584 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated:
1) if both S-NSSAI and DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of
the PDU session, DNN] combination (including the timer T3584 applied for all
the PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE shall not send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message with
exception of those identified in subclause 6.4.2.1, for the [S-NSSAI of the
PDU session, DNN] combination that was sent by the UE, until the UE is
switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated, or the UE receives a PDU SESSION
MODIFICATION COMMAND message for the [S-NSSAI of the PDU session, DNN]
combination from the network, or a PDU SESSION AUTHENTICATION COMMAND message
for the [S-NSSAI of the PDU session, DNN] combination from the network, or a
PDU SESSION RELEASE COMMAND message without the Back-off timer value IE for
the [S-NSSAI of the PDU session, DNN] combination from the network;
2) if an S-NSSAI was provided but a DNN was not provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[S-NSSAI of the PDU session, no DNN] combination (including the timer T3584
applied for all the PLMNs, if running, and the timer T3584 applied for the
registered PLMN, if running), if it is running. The UE shall not send a PDU
SESSION ESTABLISHMENT REQUEST message with request type different from
\"initial emergency request\" and different from \"existing emergency PDU
session\", or a PDU SESSION MODIFICATION REQUEST message with exception of
those identified in subclause 6.4.2.1, for the [S-NSSAI of the PDU session, no
DNN] combination, if no DNN was provided during the PDU session establishment,
until the UE is switched off, the USIM is removed, the entry in the \"list of
subscriber data\" for the current SNPN is updated, or the UE receives a PDU
SESSION MODIFICATION COMMAND message for a non-emergency PDU session
established for the [S-NSSAI of the PDU session, no DNN] combination from the
network, or a PDU SESSION AUTHENTICATION COMMAND message for a non-emergency
PDU session established for the [S-NSSAI of the PDU session, no DNN]
combination from the network, or a PDU SESSION RELEASE COMMAND message without
the Back-off timer value IE for a non-emergency PDU session established for
the [S-NSSAI of the PDU session, no DNN] combination from the network;
3) if an S-NSSAI was not provided but a DNN was provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[no S-NSSAI, DNN] combination (including the timer T3584 applied for all the
PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE shall not send a PDU SESSION ESTABLISHMENT
REQUEST message, or a PDU SESSION MODIFICATION REQUEST message with exception
of those identified in subclause 6.4.2.1, for the [no S-NSSAI, DNN]
combination, if no S-NSSAI was provided during the PDU session establishment,
until the UE is switched off, the USIM is removed, the entry in the \"list of
subscriber data\" for the current SNPN is updated, or the UE receives a PDU
SESSION MODIFICATION COMMAND message for the [no S-NSSAI, DNN] combination
from the network, or a PDU SESSION AUTHENTICATION COMMAND message for the [no
S-NSSAI, DNN] combination from the network, or a PDU SESSION RELEASE COMMAND
message without the Back-off timer value IE for the [no S-NSSAI, DNN]
combination from the network; and
4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI,
no DNN] combination (including the timer T3584 applied for all the PLMNs, if
running, and the timer T3584 applied for the registered PLMN, if running), if
it is running. The UE shall not send a PDU SESSION ESTABLISHMENT REQUEST
message with request type different from \"initial emergency request\" and
different from \"existing emergency PDU session\", or a PDU SESSION
MODIFICATION REQUEST message with exception of those identified in subclause
6.4.2.1, for the [no S-NSSAI, no DNN] combination, if neither S-NSSAI nor DNN
was provided during the PDU session establishment, until the UE is switched
off, the USIM is removed, the entry in the \"list of subscriber data\" for the
current SNPN is updated, or the UE receives a PDU SESSION MODIFICATION COMMAND
message for a non-emergency PDU session established for the [no S-NSSAI, no
DNN] combination from the network, or a PDU SESSION AUTHENTICATION COMMAND
message for a non-emergency PDU session established for the [no S-NSSAI, no
DNN] combination from the network, or a PDU SESSION RELEASE COMMAND message
without the Back-off timer value IE for a non-emergency PDU session
established for the [no S-NSSAI, no DNN] combination from the network.
The timer T3584 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero:
1) if both S-NSSAI and DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [S-NSSAI of
the PDU session, DNN] combination (including the timer T3584 applied for all
the PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE may send another PDU SESSION ESTABLISHMENT
REQUEST message or PDU SESSION MODIFICATION REQUEST message for the [S-NSSAI
of the PDU session, DNN] combination;
2) if an S-NSSAI was provided but a DNN was not provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[S-NSSAI of the PDU session, no DNN] combination (including the timer T3584
applied for all the PLMNs, if running, and the timer T3584 applied for the
registered PLMN, if running), if it is running. The UE may send another PDU
SESSION ESTABLISHMENT REQUEST message, or PDU SESSION MODIFICATION REQUEST
message for the [S-NSSAI of the PDU session, no DNN] combination if the
request type was different from \"initial emergency request\" and different
from \"existing emergency PDU session\";
3) if an S-NSSAI was not provided but a DNN was provided by the UE during the
PDU session establishment, the UE shall stop timer T3584 associated with the
[no S-NSSAI, DNN] combination (including the timer T3584 applied for all the
PLMNs, if running, and the timer T3584 applied for the registered PLMN, if
running), if it is running. The UE may send another PDU SESSION ESTABLISHMENT
REQUEST message, or PDU SESSION MODIFICATION REQUEST message for the [no
S-NSSAI, DNN] combination; and
4) if neither S-NSSAI nor DNN were provided by the UE during the PDU session
establishment, the UE shall stop timer T3584 associated with the [no S-NSSAI,
no DNN] combination (including the timer T3584 applied for all the PLMNs, if
running, and the timer T3584 applied for the registered PLMN, if running), if
it is running. The UE may send another PDU SESSION ESTABLISHMENT REQUEST
message, or PDU SESSION MODIFICATION REQUEST message for the [no S-NSSAI, no
DNN] combination and the request type was different from \"initial emergency
request\" and different from \"existing emergency PDU session\".
If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The
back-off timer is applied in all PLMNs \" is included in the PDU SESSION
MODIFICATION REJECT message with the 5GSM cause value #67 \"insufficient
resources for specific slice and DNN\", then the UE shall apply the timer
T3584 for all the PLMNs. Otherwise, the UE shall apply the timer T3584 for the
registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is
received from the 5GMM sublayer, then the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for
the same [S-NSSAI, DNN] combination, or for the same [S-NSSAI, no DNN]
combination, or for the same [no S-NSSAI, DNN] combination, or for the same
[no S-NSSAI, no DNN] combination.
When the timer T3584 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3584 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" for the SNPN to which timer T3584
is associated (if any) is not updated, then timer T3584 is kept running until
it expires or it is stopped.
If the UE is switched off when the timer T3584 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" for the SNPN to which timer T3584 is associated (if any) is not updated
when the UE is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3584 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If the UE is a UE operating in single-registration mode in a network
supporting N26 interface and the PDU SESSION MODIFICATION REQUEST message was
sent for a PDN connection established when in S1 mode after an inter-system
change from S1 mode to N1 mode and timer T3584 associated with the
corresponding [no S-NSSAI, DNN] combination or [no S-NSSAI, no DNN]
combination is running, then the UE shall re-initiate the UE-requested PDU
session modification procedure after expiry of timer T3584.
If:
\- the 5GSM cause value #69 \"insufficient resources for specific slice\" and
the Back-off timer value IE are included in the PDU SESSION MODIFICATION
REJECT message; or
\- an indication that the 5GSM message was not forwarded due to S-NSSAI only
based congestion control is received along a Back-off timer value and a PDU
SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the PDU
session ID of the PDU session;
the UE shall ignore the bit \"RATC\" and the bit \"EPLMNC\" in the Re-attempt
indicator IE provided by the network, if any, and take different actions
depending on the timer value received for timer T3585 in the Back-off timer
value IE or depending on the Back-off timer value received from the 5GMM
sublayer (if the UE is a UE configured for high priority access in selected
PLMN, exceptions are specified in subclause 6.2.8):
a) If the timer value indicates neither zero nor deactivated and an S-NSSAI
was provided during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop timer T3585 associated with the
S-NSSAI of the PDU session, if it is running. If the timer value indicates
neither zero nor deactivated and no S-NSSAI was provided during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3585 associated with no S-NSSAI if it is running. The
timer T3585 to be stopped includes the timer T3585 applied for all the PLMNs,
if running, and the timer T3585 applied for the registered PLMN, if running.
The UE shall then start timer T3585 with the value provided in the Back-off
timer value IE or with the Back-off timer value received from the 5GMM
sublayer and:
1) if an S-NSSAI was provided by the UE during the PDU session establishment,
the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST message with exception of those identified in subclause 6.4.2.1, for a
non-emergency PDU session for the S-NSSAI of the PDU session, until timer
T3585 expires or timer T3585 is stopped; and
2) if the request type was different from \"initial emergency request\" and
from \"existing emergency PDU session\", and an S-NSSAI was not provided by
the UE during the PDU session establishment, the UE shall not send another PDU
SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with request type
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", or another PDU SESSION MODIFICATION REQUEST message
with exception of those identified in subclause 6.4.2.1, for a non-emergency
PDU session established without an S-NSSAI provided by the UE, , until timer
T3585 expires or timer T3585 is stopped.
The UE shall not stop timer T3585 upon a PLMN change or inter-system change;
b) if the timer value indicates that this timer is deactivated and an S-NSSAI
was provided during the PDU session establishment and the request type was
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", the UE shall stop timer T3585 associated with the
S-NSSAI of the PDU session, if it is running. If the timer value indicates
that this timer is deactivated and no S-NSSAI was provided during the PDU
session establishment and the request type was different from \"initial
emergency request\" and different from \"existing emergency PDU session\", the
UE shall stop timer T3585 associated with no S-NSSAI if it is running. The
timer T3585 to be stopped includes the timer T3585 applied for all the PLMNs,
if running, and the timer T3585 applied for the registered PLMN, if running.
In addition:
1) if an S-NSSAI was provided by the UE during the PDU session establishment,
the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message with
request type different from \"initial emergency request\" and different from
\"existing emergency PDU session\", or another PDU SESSION MODIFICATION
REQUEST with exception of those identified in subclause 6.4.2.1, for a non-
emergency PDU session for the S-NSSAI of the PDU session until the UE is
switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated, or the UE receives a PDU SESSION
MODIFICATION COMMAND message for a non-emergency PDU session for the S-NSSAI
of the PDU session from the network, or a PDU SESSION AUTHENTICATION COMMAND
message for a non-emergency PDU session for the S-NSSAI of the PDU session
from the network, or a PDU SESSION RELEASE COMMAND message without the Back-
off timer value IE for the S-NSSAI of the PDU session from the network; and
2) if the request type was different from \"initial emergency request\" and
from \"existing emergency PDU session\", and an S-NSSAI was not provided by
the UE during the PDU session establishment, the UE shall not send another PDU
SESSION ESTABLISHMENT REQUEST message without an S-NSSAI and with request type
different from \"initial emergency request\" and different from \"existing
emergency PDU session\", or another PDU SESSION MODIFICATION REQUEST message
with exception of those identified in subclause 6.4.2.1, for a non-emergency
PDU session established without an S-NSSAI provided by the UE, until the UE is
switched off, the USIM is removed, the entry in the \"list of subscriber
data\" for the current SNPN is updated, or the UE receives a PDU SESSION
MODIFICATION COMMAND message for a non-emergency PDU session established
without an S-NSSAI provided by the UE, or a PDU SESSION AUTHENTICATION COMMAND
message for a non-emergency PDU session established without an S-NSSAI
provided by the UE, or a PDU SESSION RELEASE COMMAND message without the Back-
off timer value IE for a non-emergency PDU session established without an
S-NSSAI provided by the UE.
The timer T3585 remains deactivated upon a PLMN change or inter-system change;
and
c) if the timer value indicates zero:
1) if an S-NSSAI was provided by the UE during the PDU session establishment,
the UE shall stop timer T3585 associated with the S-NSSAI of the PDU session
(including the timer T3585 applied for all the PLMNs, if running, and the
timer T3585 applied for the registered PLMN, if running), if running, and may
send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message for the S-NSSAI of the PDU session; and
2) if no S-NSSAI was provided during the PDU session establishment and the
request type was different from \"initial emergency request \" and different
from \"existing emergency PDU session\", the UE shall stop timer T3585
associated with no S-NSSAI (including the timer T3585 applied for all the
PLMNs, if running, and the timer T3585 applied for the registered PLMN, if
running), if running, and may send another PDU SESSION ESTABLISHMENT REQUEST
message without an S-NSSAI, or another PDU SESSION MODIFICATION REQUEST
message without an S-NSSAI provided by the UE.
If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The
back-off timer is applied in all PLMNs\" is included in the PDU SESSION
MODIFICATION REJECT message with the 5GSM cause value #69 \"insufficient
resources for specific slice\", then the UE shall apply the timer T3585 for
all the PLMNs. Otherwise, the UE shall apply the timer T3585 for the
registered PLMN.
If the Back-off timer value IE is not included or no Back-off timer value is
received from the 5GMM sublayer, then the UE may send another PDU SESSION
ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for
the same S-NSSAI or without an S-NSSAI.
When the timer T3585 is running or the timer is deactivated, the UE is allowed
to initiate a PDU session establishment procedure for emergency services.
If the timer T3585 is running when the UE enters state 5GMM-DEREGISTERED, the
UE remains switched on, and the USIM in the UE (if any) remains the same and
the entry in the \"list of subscriber data\" for the SNPN to which timer T3585
is associated (if any) is not updated, then timer T3585 is kept running until
it expires or it is stopped.
If the UE is switched off when the timer T3585 is running, and if the USIM in
the UE (if any) remains the same and the entry in the \"list of subscriber
data\" for the SNPN to which timer T3585 is associated (if any) is not updated
when the UE is switched on, the UE shall behave as follows:
\- let t1 be the time remaining for T3585 timeout at switch off and let t be
the time elapsed between switch off and switch on. If t1 is greater than t,
then the timer shall be restarted with the value t1 -- t. If t1 is equal to or
less than t, then the timer need not be restarted. If the UE is not capable of
determining t, then the UE shall restart the timer with the value t1.
If the UE is a UE operating in single-registration mode in a network
supporting N26 interface and the PDU SESSION MODIFICATION REQUEST message was
sent for a PDN connection established when in S1 mode after an inter-system
change from S1 mode to N1 mode and timer T3585 associated with no S-NSSAI is
running, then the UE shall re-initiate the UE-requested PDU session
modification procedure after expiry of timer T3585.
NOTE 3: As described in this subclause, upon PLMN change or inter-system
change, the UE does not stop the timer T3584 or T3585. This means the timer
T3584 or T3585 can still be running or be deactivated for the given 5GSM
procedure, the PLMN, the S-NSSAI and optionally the DNN combination when the
UE returns to the PLMN or when it performs inter-system change back from S1
mode to N1 mode. Thus the UE can still be prevented from sending another PDU
SESSION ESTABLISHMENT REQUEST or PDU SESSION MODIFICATION REQUEST message in
the PLMN for the same S-NSSAI and optionally the same DNN.
Upon PLMN change, if T3584 is running or is deactivated for an S-NSSAI, a DNN,
and old PLMN, but T3584 is not running and is not deactivated for the S-NSSAI,
the DNN, and new PLMN, then the UE is allowed to send a PDU SESSION
ESTABLISHMENT REQUEST message for the same S-NSSAI and the same DNN in the new
PLMN.
Upon PLMN change, if T3585 is running or is deactivated for an S-NSSAI and old
PLMN, but T3585 is not running and is not deactivated for the S-NSSAI and new
PLMN, then the UE is allowed to send a PDU SESSION ESTABLISHMENT REQUEST
message for the same S-NSSAI in the new PLMN.
##### 6.4.2.4.3 Handling of network rejection not due to congestion control
If the 5GSM cause value is different from #26 \"insufficient resources\", #37
\"5GS QoS not accepted\", #44 \"Semantic errors in packet filter(s)\", #45
\"Syntactical error in packet filter(s)\", #46 \"out of LADN service area\",
#59 \"unsupported 5QI value\", #67 \"insufficient resources for specific slice
and DNN\", #69 \"insufficient resources for specific slice\", #83 \"Semantic
error in the QoS operation\", and #84 \"Syntactical error in the QoS
operation\", and the Back-off timer value IE is included, the UE shall behave
as follows: (if the UE is a UE configured for high priority access in selected
PLMN, exceptions are specified in subclause 6.2.12):
a) if the timer value indicates neither zero nor deactivated and:
1) if the UE provided DNN and S-NSSAI to the network during the PDU session
establishment, the UE shall start the back-off timer with the value provided
in the Back-off timer value IE for the PDU session modification procedure and
[PLMN, DNN, (mapped) HPLMN S-NSSAI of the PDU session] combination. The UE
shall not send another PDU SESSION MODIFICATION REQUEST message with exception
of those identified in subclause 6.4.2.1, for the same DNN and the (mapped)
HPLMN S-NSSAI of the PDU session in the current PLMN, until the back-off timer
expires, the UE is switched off, the USIM is removed, or the entry in the
\"list of subscriber data\" for the current SNPN is updated; or
2) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to
the network during the PDU session establishment, it shall start the back-off
timer accordingly for the PDU session modification procedure and the [PLMN,
DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI of the PDU session] or
[PLMN, no DNN, no S-NSSAI] combination. Dependent on the combination, the UE
shall not send another PDU SESSION MODIFICATION REQUEST message with exception
of those identified in subclause 6.4.2.1, for the same [PLMN, DNN, no
S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI of the PDU session] or [PLMN,
no DNN, no S-NSSAI] combination in the current PLMN, until the back-off timer
expires, the UE is switched off, the USIM is removed, or the entry in the
\"list of subscriber data\" for the current SNPN is updated;
b) if the timer value indicates that this timer is deactivated and:
1) if the UE provided DNN and S-NSSAI to the network during the PDU session
establishment, the UE shall not send another PDU SESSION MODIFICATION REQUEST
message with exception of those identified in subclause 6.4.2.1, for the same
DNN and the (mapped) HPLMN S-NSSAI of the PDU session in the current PLMN,
until the UE is switched off, the USIM is removed, or the entry in the \"list
of subscriber data\" for the current SNPN is updated; or
2) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to
the network during the PDU session establishment, the UE shall not send
another PDU SESSION MODIFICATION REQUEST message with exception of those
identified in subclause 6.4.2.1, for the same [PLMN, DNN, no S-NSSAI], [PLMN,
no DNN, (mapped) HPLMN S-NSSAI of the PDU session] or [PLMN, no DNN, no
S-NSSAI] combination in the current PLMN, until the UE is switched off, the
USIM is removed, or the entry in the \"list of subscriber data\" for the
current SNPN is updated; and
c) if the timer value indicates zero, the UE may send another PDU SESSION
MODIFICATION REQUEST message for the same combination of [PLMN, DNN, (mapped)
HPLMN S-NSSAI of the PDU session], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN,
(mapped) HPLMN S-NSSAI of the PDU session], or [PLMN, no DNN, no S-NSSAI] in
the current PLMN.
If the Back-off timer value IE is not included, then the UE shall ignore the
Re-attempt indicator IE provided by the network in the PDU SESSION
MODIFICATION REJECT message, if any.
a) Additionally, if the 5GSM cause value is #32 \"service option not
supported\", or #33 \"requested service option not subscribed\", then:
1) the UE not operating in SNPN access operation mode shall proceed as
follows:
i) if the UE is registered in the HPLMN or in a PLMN that is within the EHPLMN
list, the UE shall behave as described above in the present subclause using
the configured SM Retry Timer value as specified in 3GPP TS 24.368 [17] or in
USIM file NAS~CONFIG~ as specified in 3GPP TS 31.102 [22], if available, as
back-off timer value; and
NOTE 1: The way to choose one of the configured SM Retry Timer values for
back-off timer value is up to UE implementation if the UE is configured with:\
\- an SM Retry Timer value in the ME as specified in 3GPP TS 24.368 [17]; and\
\- an SM Retry Timer value in USIM file NAS~CONFIG~ as specified in 3GPP TS
31.102 [22].
ii) otherwise, if the UE is not registered in its HPLMN or in a PLMN that is
within the EHPLMN list, or if the SM Retry Timer value is not configured, the
UE shall behave as described above in the present subclause, using the default
value of 12 minutes for the back-off timer; or
2) the UE operating in SNPN access operation mode shall proceed as follows:
i) if:
A) the SM Retry Timer value for the current SNPN as specified in 3GPP TS
24.368 [17] is available; or
B) the SM Retry Timer value in USIM file NAS~CONFIG~ as specified in 3GPP TS
31.102 [22] is available and the UE used the USIM for registration to the
current SNPN;
then the UE shall behave as described above in the present subclause using the
configured SM Retry Timer value as back-off timer value; or
NOTE 2: The way to choose one of the configured SM Retry Timer values for
back-off timer value is up to UE implementation if both conditions in bullets
A) and B) above are satisfied.
ii) otherwise, the UE shall behave as described above in the present
subclause, using the default value of 12 minutes for the back-off timer.
b) For 5GSM cause values different from #32 \"service option not supported\",
or #33 \"requested service option not subscribed\", the UE behaviour regarding
the start of a back-off timer is unspecified.
The UE shall not stop any back-off timer:
a) upon a PLMN change;
b) upon an inter-system change; or
c) upon registration over another access type.
If the network indicates that a back-off timer for the PDU session
modification procedure is deactivated, then it remains deactivated:
a) upon a PLMN change;
b) upon an inter-system change; or
c) upon registration over another access type.
NOTE 3: This means the back-off timer can still be running or be deactivated
for the given 5GSM procedure when the UE returns to the PLMN or when it
performs inter-system change back from S1 mode to N1 mode. Thus the UE can
still be prevented from sending another PDU SESSION MODIFICATION REQUEST
message for the combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI of the PDU
session], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI of
the PDU session], or [PLMN, no DNN, no S-NSSAI] in the PLMN.
If the back-off timer is started upon receipt of a PDU SESSION MODIFICATION
REJECT (i.e. the timer value was provided by the network, a configured value
is available or the default value is used as explained above) or the back-off
timer is deactivated, the UE behaves as follows:
a) after a PLMN change the UE may send a PDU SESSION MODIFICATION REQUEST
message for the combination of [new PLMN, DNN, (mapped) HPLMN S-NSSAI of the
PDU session], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, (mapped) HPLMN
S-NSSAI of the PDU session], or [new PLMN, no DNN, no S-NSSAI] in the new
PLMN, if the back-off timer is not running and is not deactivated for the PDU
session modification procedure and the combination of [new PLMN, DNN, (mapped)
HPLMN S-NSSAI of the PDU session], [new PLMN, DNN, no S-NSSAI], [new PLMN, no
DNN, (mapped) HPLMN S-NSSAI of the PDU session], or [new PLMN, no DNN, no
S-NSSAI];
Furthermore, as an implementation option, for the 5GSM cause value #32
\"service option not supported\" or #33 \"requested service option not
subscribed\", if the network does not include a Re-attempt indicator IE, the
UE may decide not to automatically send another PDU SESSION MODIFICATION
REQUEST message for the same combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI
of the PDU session], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN
S-NSSAI of the PDU session], or [PLMN, no DNN, no S-NSSAI], if the UE is
registered to a new PLMN which is in the list of equivalent PLMNs.
b) if the network does not include the Re-attempt indicator IE to indicate
whether re-attempt in S1 mode is allowed, or the UE ignores the Re-attempt
indicator IE, e.g. because the Back-off timer value IE is not included, then:
1) if the UE is registered in its HPLMN or in a PLMN that is within the EHPLMN
list and the back-off timer is running for the combination of [PLMN, DNN,
(mapped) HPLMN S-NSSAI of the PDU session] or [PLMN DNN, no S-NSSAI], the UE
shall apply the configured SM_RetryAtRATChange value as specified in 3GPP TS
24.368 [17] or in USIM file NAS~CONFIG~ as specified in 3GPP TS 31.102 [22],
if available, to determine whether the UE may attempt an EPS bearer resource
allocation procedure or an EPS bearer resource modification procedure for the
same [PLMN, DNN] combination in S1 mode; and
NOTE 4: The way to choose one of the configured SM_RetryAtRATChange values for
back-off timer value is up to UE implementation if the UE is configured with:\
\- an SM_RetryAtRATChange value in ME as specified in 3GPP TS 24.368 [17];
and\ \- an SM_RetryAtRATChange value in USIM file NAS~CONFIG~ as specified in
3GPP TS 31.102 [22].
2) if the UE is not registered in its HPLMN or in a PLMN that is within the
EHPLMN list, or if the NAS configuration MO as specified in 3GPP TS 24.368
[17] is not available and the value for inter-system change is not configured
in the USIM file NAS~CONFIG~, then the UE behaviour regarding an EPS bearer
resource allocation procedure or an EPS bearer resource modification procedure
for the same [PLMN, DNN] combination in S1 mode is unspecified; and
c) if the network includes the Re-attempt indicator IE indicating that re-
attempt in an equivalent PLMN is not allowed, then depending on the timer
value received in the Back-off timer value IE, for each combination of a PLMN
from the equivalent PLMN list and the respective [DNN, (mapped) HPLMN S-NSSAI
of the PDU session], [DNN, no S-NSSAI], [no DNN, (mapped) HPLMN S-NSSAI of the
PDU session], or [no DNN, no S-NSSAI] combination, the UE shall start a back-
off timer for the PDU session modification procedure with the value provided
by the network, or deactivate the respective back-off timer as follows:
1) if the Re-attempt indicator IE additionally indicates that re-attempt in S1
mode is allowed, the UE shall start or deactivate the back-off timer for N1
mode only; and
2) otherwise, the UE shall start or deactivate the back-off timer for S1 and
N1 mode.
If the back-off timer for a [PLMN, DNN] or [PLMN, no DNN] combination was
started or deactivated in S1 mode upon receipt of BEARER RESOURCE ALLOCATION
REJECT message or BEARER RESOURCE MODIFICATION REJECT message (see 3GPP TS
24.301 [15]) and the network indicated that re-attempt in N1 mode is allowed,
then this back-off timer does not prevent the UE from sending a PDU SESSION
MODIFICATION REQUEST message in this PLMN for the same DNN after inter-system
change to N1 mode. If the network indicated that re-attempt in N1 mode is not
allowed, the UE shall not send any PDU SESSION MODIFICATION REQUEST message
with exception of those identified in subclause 6.4.2.1, in this PLMN for the
same DNN in combination with any S-NSSAI or without S-NSSAI, after inter-
system change to N1 mode until the timer expires, the UE is switched off or
the USIM is removed.
NOTE 5: The back-off timer is used to describe a logical model of the required
UE behaviour. This model does not imply any specific implementation, e.g. as a
timer or timestamp.
NOTE 6: Reference to back-off timer in this section can either refer to use of
timer T3396 or to use of a different packet system specific timer within the
UE. Whether the UE uses T3396 as a back-off timer or it uses different packet
system specific timers as back-off timers is left up to UE implementation.
If the 5GSM cause value is #46 \"out of LADN service area\", the UE shall
ignore the Back-off timer value IE and Re-attempt indicator IE provided by the
network, if any. If the UE is not located inside the LADN service area, the UE
shall not send another PDU SESSION MODIFICATION REQUEST message or another PDU
SESSION ESTABLISHMENT REQUEST message for the LADN DNN provided by the UE
during the PDU session establishment procedure until the LADN information for
the specific LADN DNN is updated as described in subclause 5.4.4 and subclause
5.5.1. If the UE is not located inside the LADN service area, the UE shall not
indicate the PDU session(s) for the LADN DNN provided by the UE during the PDU
session establishment procedure in the Uplink data status IE included in the
SERVICE REQUEST message until the LADN information for the specific LADN DNN
is provided by network as described in subclause 5.4.4 and subclause 5.5.1.
NOTE 7: Based on UE implementation, the UE locating inside the LADN service
area can send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION
MODIFICATION REQUEST message for the LADN DNN which was rejected with the 5GSM
cause value #46 \"out of LADN service area\".
If the 5GSM cause value is #37 \"5GS QoS not accepted\", #44 \"Semantic errors
in packet filter(s)\", #45 \"Syntactical error in packet filter(s)\", #59
\"unsupported 5QI value\", #83 \"Semantic error in the QoS operation\" or #84
\"Syntactical error in the QoS operation\", the UE shall ignore the Back-off
timer value IE and Re-attempt indicator IE provided by the network, if any.
The UE should pass the corresponding error cause to the upper layers.
NOTE 8: How to solve the issues of not accepted 5GS QoS and unsupported 5QI
value in the upper layers is UE implementation specific.
#### 6.4.2.5 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Expiry of timer T3581.
The UE shall, on the first expiry of the timer T3581, retransmit the PDU
SESSION MODIFICATION REQUEST message and the PDU session information which was
transported together with the initial transmission of the PDU SESSION
MODIFICATION REQUEST message and shall reset and start timer T3581. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3581, the UE shall abort the procedure and shall release the allocated PTI.
b) Invalid PDU session identity.
Upon receipt of the PDU SESSION MODIFICATION REJECT message including 5GSM
cause #43 \"invalid PDU session identity\", the UE shall perform a local
release of the existing PDU session and shall stop the timer T3581.
c) Collision of network-requested PDU session release procedure and UE-
requested PDU session modification procedure.
If the UE receives a PDU SESSION RELEASE COMMAND message during the UE-
requested PDU session modification procedure, and the PDU session indicated in
the PDU SESSION RELEASE COMMAND message is the PDU session that the UE had
requested to modify, the UE shall abort the PDU session modification procedure
and proceed with the network-requested PDU session release procedure.
d) Handling DL user data packets marked with RQI when UE has already revoked
the usage of reflective QoS
If the UE receives a DL user data packet marked with a RQI and the DL user
data packet belongs to a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU
session type for which the UE has already revoked the usage of reflective QoS,
then the UE shall ignore the RQI and shall handle the received DL user data
packet.
e) Collision of network-requested PDU session modification procedure and UE-
requested PDU session modification procedure.
The handling of the same abnormal case as described in subclause 6.3.2.6
applies.
f) Upon receiving an indication that the 5GSM message was not forwarded due to
service area restrictions along with a PDU SESSION MODIFICATION REQUEST
message with the PDU session ID IE set to the same value as the PDU session ID
that was sent by the UE, the UE shall abort the procedure and shall stop the
timer T3581.
g) Upon receiving an indication that the 5GSM message was not forwarded due to
routing failure along with a PDU SESSION MODIFICATION REQUEST message with the
PDU session ID IE set to the same value as the PDU session ID that was sent by
the UE, the UE shall stop timer T3581 and shall abort the procedure.
ga) Upon receiving an indication that the 5GSM message was not forwarded
because the UE accessing via a satellite NG-RAN cell is informed that the PLMN
is not allowed to operate at the present UE location along with a PDU SESSION
MODIFICATION REQUEST message with the PDU session ID IE set to the same value
as the PDU session ID that was sent by the UE, the UE shall stop timer T3581
and shall abort the procedure.
h) Collision of UE-requested PDU session modification procedure and N1 NAS
signalling connection release
The UE may immediately retransmit the PDU SESSION MODIFICATION REQUEST message
and stop, reset and restart timer T3581, if the following conditions apply:
1) The original UE-requested PDU session modification procedure was initiated
over an existing N1 NAS signalling connection; and
2) the previous transmission of the PDU SESSION MODIFICATION REQUEST message
was not initiated due to timer T3581 expiry.
#### 6.4.2.6 Abnormal cases on the network side
The following abnormal cases can be identified:
a) If the PDU session is an emergency PDU session and the 5GSM cause IE is not
included in the PDU SESSION MODIFICATION REQUEST message which is not
triggered according to subclause 6.4.2.1, item e), or is set to a 5GSM cause
other than the 5GSM causes #41, #42, #44, #45, #83, #84, and #85, the SMF
shall reject the PDU SESSION MODIFICATION REQUEST message with 5GSM cause #31
\"request rejected, unspecified\".
b) PDU session inactive for the received PDU session identity.
If the PDU session ID in the PDU SESSION MODIFICATION REQUEST message belongs
to any PDU session in state PDU SESSION INACTIVE in the SMF, the SMF shall set
the 5GSM cause IE to #43 \"Invalid PDU session identity\" in the PDU SESSION
MODIFICATION REJECT message.
c) Collision of network-requested PDU session modification procedure and UE-
requested PDU session modification procedure.
The handling of the same abnormal case as described in subclause 6.3.2.5
applies.
d) AMF provides a \"message was exempted from the DNN based congestion
activated in the AMF\" but the UE-requested PDU session modification procedure
is not exempt from DNN based congestion control.
If the SMF receives an exemptionInd attribute indicating \"message was
exempted from the DNN based congestion activated in the AMF\" as specified in
3GPP TS 29.502 [20A], and the Extended protocol configuration options IE of
the PDU SESSION MODIFICATION REQUEST message does not indicate 3GPP PS data
off UE status, then the SMF shall set the 5GSM cause #26 \"insufficient
resources\" in the PDU SESSION MODIFICATION REJECT message.
e) AMF provides a \"message was exempted from the S-NSSAI and DNN based
congestion activated in the AMF\" but the UE-requested PDU session
modification procedure is not exempt from S-NSSAI only based congestion
control.
If the SMF receives an exemptionInd attribute indicating \"message was
exempted from the S-NSSAI and DNN based congestion activated in the AMF\" as
specified in 3GPP TS 29.502 [20A], and the Extended protocol configuration
options IE of the PDU SESSION MODIFICATION REQUEST message does not indicate
3GPP PS data off UE status, then the SMF shall set the 5GSM cause #67
\"insufficient resources for specific slice and DNN\" in the PDU SESSION
MODIFICATION REJECT message.
f) AMF provides a \"message was exempted from the S-NSSAI only based
congestion activated in the AMF\" but the UE-requested PDU session
modification procedure is not exempt from S-NSSAI only based congestion
control.
If the SMF receives an exemptionInd attribute indicating \"message was
exempted from the S-NSSAI only based congestion activated in the AMF\" as
specified in 3GPP TS 29.502 [20A], and the Extended protocol configuration
options IE of the PDU SESSION MODIFICATION REQUEST message does not indicate
3GPP PS data off UE status, then the SMF shall set the 5GSM cause #69
\"insufficient resources for specific slice\" in the PDU SESSION MODIFICATION
REJECT message.
g) 5G access network cannot forward the message.
If the SMF determines based on content of the n2SmInfo attribute specified in
3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU
SESSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G
access network due to a cause other than handover procedure in progress, then
the SMF shall reject the UE-requested PDU session modification procedure with
an appropriate 5GSM cause value in the PDU SESSION MODIFICATION REJECT
message.
NOTE: The use of an appropriate 5GSM cause value is implementation specific.
### 6.4.3 UE-requested PDU session release procedure
#### 6.4.3.1 General
The purpose of the UE-requested PDU session release procedure is to enable by
the UE to request a release of a PDU session.
The UE is allowed to initiate the PDU session release procedure even if the
timer T3396 is running.
The UE is allowed to initiate the PDU session release procedure even if the
timer T3584 is running.
The UE is allowed to initiate the PDU session release procedure even if the
timer T3585 is running.
The UE is allowed to initiate the PDU session release procedure even if the UE
is outside the LADN service area.
#### 6.4.3.2 UE-requested PDU session release procedure initiation
In order to initiate the UE-requested PDU session release procedure, the UE
shall create a PDU SESSION RELEASE REQUEST message.
The UE may set the 5GSM cause IE of the PDU SESSION RELEASE REQUEST message to
indicate the reason for releasing the PDU session.
The 5GSM cause IE typically indicates one of the following 5GSM cause values:
#26 insufficient resources;
#36 regular deactivation;
#44 Semantic errors in packet filter(s);
#45 Syntactical error in packet filter(s);
#83 Semantic error in the QoS operation;
#84 Syntactical error in the QoS operation;
#96 Invalid mandatory information.
The UE shall allocate a PTI value currently not used and shall set the PTI IE
of the PDU SESSION RELEASE REQUEST message to the allocated PTI value.
The UE shall transport the PDU SESSION RELEASE REQUEST message and the PDU
session ID, using the NAS transport procedure as specified in subclause 5.4.5,
and the UE shall start timer T3582 (see example in figure 6.4.3.2.1).
If the UE is releasing the PDU session due to:
a) errors in QoS operations or packet filters; or
b) the number of the authorized QoS rules, the number of the packet filters,
or the number of the authorized QoS flow descriptions associated with the PDU
session have reached the maximum number supported by the UE,
the UE shall include the 5GSM cause IE in the PDU SESSION RELEASE REQUEST
message as described in subclauses 6.3.2.4 and 6.4.1.3.
Figure 6.4.3.2.1: UE-requested PDU session release procedure
#### 6.4.3.3 UE-requested PDU session release procedure accepted by the
network
Upon receipt of a PDU SESSION RELEASE REQUEST message and a PDU session ID, if
the SMF accepts the request to release the PDU session, and shall perform the
network-requested PDU session release procedure as specified in subclause
6.3.3.
#### 6.4.3.4 UE-requested PDU session release procedure not accepted by the
network
Upon receipt of a PDU SESSION RELEASE REQUEST message, if the SMF does not
accept the request to release the PDU session, the SMF shall create a PDU
SESSION RELEASE REJECT message.
The SMF shall set the 5GSM cause IE of the PDU SESSION RELEASE REJECT message
to indicate the reason for rejecting the PDU session release.
The 5GSM cause IE typically indicates one of the following SM cause values:
#35 PTI already in use; or
#43 Invalid PDU session identity; or
#95 -- 111: protocol errors.
The SMF shall send the PDU SESSION RELEASE REJECT message.
Upon receipt of a PDU SESSION RELEASE REJECT message and a PDU session ID,
using the NAS transport procedure as specified in subclause 5.4.5, the UE
shall stop timer T3582, release the allocated PTI value and locally release
the PDU session. If there is one or more multicast MBS sessions associated
with the PDU session, the UE shall locally leave the associated multicast MBS
sessions.
#### 6.4.3.5 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Expiry of timer T3582.
The UE shall, on the first expiry of the timer T3582, retransmit the PDU
SESSION RELEASE REQUEST message and the PDU session information which was
transported together with the initial transmission of the PDU SESSION RELEASE
REQUEST message and shall reset and start timer T3582. This retransmission is
repeated four times, i.e. on the fifth expiry of timer T3582, the UE shall
abort the procedure, release the allocated PTI, perform a local release of the
PDU session, and perform the registration procedure for mobility and periodic
registration update by sending a REGISTRATION REQUEST message including the
PDU session status IE over each access that user plane resources have been
established if the PDU session is an MA PDU session, or over the access the
PDU session is associated with if the PDU session is a single access PDU
session. If there is one or more multicast MBS sessions associated with the
PDU session, the UE shall locally leave the associated multicast MBS sessions.
b) Collision of UE-requested PDU session release procedure and network-
requested PDU session modification procedure.
When the UE receives a PDU SESSION MODIFICATION COMMAND message during the UE-
requested PDU session release procedure, and the PDU session indicated in PDU
SESSION MODIFICATION COMMAND message is the PDU session that the UE had
requested to release, the UE shall ignore the PDU SESSION MODIFICATION COMMAND
message and proceed with the PDU session release procedure.
c) Collision of UE-requested PDU session release procedure and network-
requested PDU session release procedure.
When the UE receives a PDU SESSION RELEASE COMMAND message with the PTI IE set
to \"No procedure transaction identity assigned\" during the UE-requested PDU
session release procedure, the PDU session indicated in the PDU SESSION
RELEASE COMMAND message is the same as the PDU session that the UE requests to
release:
\- if the Access type IE is included in the PDU SESSION RELEASE COMMAND
message and the PDU session is an MA PDU session and having user-plane
resources established on the access different from the access indicated in the
Access type IE in the PDU SESSION RELEASE COMMAND message, the UE shall
proceed both the UE-requested PDU session release procedure and network-
requested PDU session release procedure; or
\- otherwise, the UE shall abort the UE-requested PDU session release
procedure and shall stop the timer T3582 and proceed with the network-
requested PDU session release procedure.
d) Receipt of an indication that the 5GSM message was not forwarded due to
routing failure
Upon receiving an indication that the 5GSM message was not forwarded due to
routing failure along with a PDU SESSION RELEASE REQUEST message with the PDU
session ID IE set to the same value as the PDU session ID that was sent by the
UE, the UE shall stop timer T3582, abort the procedure, release the allocated
PTI, perform a local release of the PDU session, and perform the registration
procedure for mobility and periodic registration update by sending a
REGISTRATION REQUEST message including the PDU session status IE over each
access that user plane resources have been established if the PDU session is
an MA PDU session, or over the access the PDU session is associated with if
the PDU session is a single access PDU session. If there is one or more
multicast MBS sessions associated with the released PDU session, the UE shall
locally leave the associated multicast MBS sessions.
e) PDU session release signalling restricted due to service area restriction
The UE may delay the release of the PDU session until the UE is not restricted
by service area restrictions, or it may release the allocated PTI, perform a
local release of the PDU session, and include the PDU session status IE over
each access that user plane resources have been established if the PDU session
is an MA PDU session, or over the access the PDU session is associated with if
the PDU session is a single access PDU when performing the next registration
procedure. If the UE performs the local release of the PDU session and there
is one or more MBS multicast sessions associated with the released PDU
session, the UE shall locally leave the associated MBS multicast sessions.
f) Collision of UE-requested PDU session release procedure and N1 NAS
signalling connection release
The UE may immediately retransmit the PDU SESSION RELEASE REQUEST message and
stop, reset and restart timer T3582, if the following conditions apply:
1) The original UE-requested PDU session release procedure was initiated over
an existing N1 NAS signalling connection; and
2) the previous transmission of the PDU SESSION RELEASE REQUEST message was
not initiated due to timer T3582 expiry.
g) Receipt of an indication that the 5GSM message was not forwarded due to the
PLMN is not allowed to operate at the present UE location
Upon receiving an indication that the 5GSM message was not forwarded because
the UE accessing via a satellite NG-RAN cell is informed that the PLMN is not
allowed to operate at the present UE location along with a PDU SESSION RELEASE
REQUEST message with the PDU session ID IE set to the same value as the PDU
session ID that was sent by the UE, the UE shall stop timer T3582, abort the
procedure and locally release the PDU session.
#### 6.4.3.6 Abnormal cases on the network side
The following abnormal cases can be identified:
a) PDU session inactive for the received PDU session identity.
If the PDU session ID in the PDU SESSION RELEASE REQUEST message belongs to
any PDU session in state PDU SESSION INACTIVE in the SMF, the SMF shall send
the PDU SESSION RELEASE REJECT message to the UE with the 5GSM cause #43
\"Invalid PDU session identity\".
## 6.5 5GSM status procedure
### 6.5.1 General
The purpose of the sending of the 5GSM STATUS message is to report at any time
certain error conditions detected upon receipt of 5GSM protocol data. The 5GSM
STATUS message can be sent by both the network and the UE (see example in
figure 6.5.1.1).
Figure 6.5.1.1: 5GSM status procedure
### 6.5.2 5GSM status received in the UE
If the 5GSM entity of the UE receives a 5GSM STATUS message the UE shall take
different actions depending on the received 5GSM cause value:
#47 PTI mismatch.
The UE shall abort any ongoing 5GSM procedure related to the received PTI
value and stop any related timer.
#81 invalid PTI value.
The UE shall abort any ongoing 5GSM procedure related to the received PTI
value and stop any related timer.
#97 Message type non-existent or not implemented.
The UE shall abort any ongoing 5GSM procedure related to the PTI or PDU
session ID and stop any related timer.
On receipt of a 5GSM STATUS message with any other 5GSM cause value no state
transition and no specific action shall be taken as seen from the radio
interface, i.e. local actions are possible.
### 6.5.3 5GSM status received in the SMF
If the SMF receives a 5GSM STATUS message the SMF shall take different actions
depending on the received 5GSM cause value:
#43 invalid PDU session identity.
The SMF shall abort any ongoing 5GSM procedure related to the PTI or PDU
session ID, stop any related timer and locally release the PDU session
indicated in the 5GSM STATUS message.
#47 PTI mismatch.
The SMF shall abort any ongoing 5GSM procedure related to the received PTI
value and stop any related timer.
If the PTI indicated in the 5GSM STATUS message is related to a PDU SESSION
ESTABLISHMENT ACCEPT message, the SMF shall perform a local release of the PDU
session indicated in the PDU SESSION ESTABLISHMENT ACCEPT message.
#81 invalid PTI value.
The SMF shall abort any ongoing 5GSM procedure related to the received PTI
value and stop any related timer.
#96 invalid mandatory information.
The SMF shall abort any ongoing 5GSM procedure related to the PTI or PDU
session ID and stop any related timer.
#97 message type non-existent or not implemented.
The SMF shall abort any ongoing 5GSM procedure related to the PTI or PDU
session ID and stop any related timer.
The local actions to be taken by the SMF on receipt of a 5GSM STATUS message
with any other 5GSM cause value are implementation dependent.
## 6.6 Miscellaneous procedures
### 6.6.1 Exchange of extended protocol configuration options
The UE and the SMF can exchange protocol configuration options via 5GSM
procedures.
The protocol configuration options shall be exchanged via the Extended
protocol configuration options IE.
### 6.6.2 Remote UE report procedure
#### 6.6.2.1 General
The purpose of the 5G ProSe remote UE report procedure is for a UE acting as a
5G ProSe layer-3 UE-to-network UE relay to notify the network that a 5G ProSe
remote UE is connected to the 5G ProSe layer-3 UE-to-network relay UE or
disconnected from the 5G ProSe layer-3 UE-to-network relay UE as specified in
3GPP TS 23.304 [6E].
The UE does not initiate the remote UE report procedure if the timer T3396 is
running.
The UE does not initiate the remote UE report procedure if the timer T3584 is
running.
The UE does not initiate the remote UE report procedure if the timer T3585 is
running.
#### 6.6.2.2 Remote UE report procedure initiation
In order to initiate the 5G ProSe remote UE report procedure, the UE shall
create a REMOTE UE REPORT message.
The UE shall include information of newly connected or disconnected 5G ProSe
remote UEs to the network in the REMOTE UE REPORT message by setting the
values of the Remote UE context connected IE or the Remote UE context
disconnected IE to the 5G ProSe remote UE identities that are being connected
or disconnected, respectively.
The UE shall set the Remote UE ID with:
a) the UP-PRUK ID of the 5G ProSe remote UE, if the security for 5G ProSe
communication via 5G ProSe UE-to-network relay is performed over user plane as
specified in 3GPP TS 33.503 [56]; or
b) the CP-PRUK ID of the 5G ProSe remote UE, if the security for 5G ProSe
communication via 5G ProSe UE-to-network relay is performed over control plane
as specified in 3GPP TS 33.503 [56].
If the UE sets the Remote UE ID with the PRUK ID of the 5G ProSe remote UE and
the UP-PRUK ID is in 64-bit string format, the UE shall include the HPLMN ID
of the 5G ProSe remote UE.
If the UE allocated an IPv4 address to a 5G ProSe remote UE and enabled UDP
usage to the 5G ProSe remote UE, the UE shall include in the REMOTE UE REPORT
message the UDP port range assigned to the 5G ProSe remote UE in the NAT
function of 5G ProSe layer-3 UE-to-network relay. If the UE allocated an IPv4
address to a 5G ProSe remote UE and enabled TCP usage to the 5G ProSe remote
UE, the UE shall include in the REMOTE UE REPORT message the TCP port range
assigned to the 5G ProSe remote UE in the NAT function of 5G ProSe layer-3 UE-
to-network relay.
The UE shall set the PDU session ID IE to the value of the PDU session
associated with the 5G ProSe remote UE connected to the 5G ProSe layer-3 UE-
to-network relay UE or disconnected from the 5G ProSe layer-3 UE-to-network
relay UE.
The UE shall allocate a PTI value currently not used and shall set the PTI IE
of the REMOTE UE REPORT message to the allocated PTI value.
The UE shall transport the REMOTE UE REPORT message and the PDU session ID,
using the NAS transport procedure as specified in subclause 5.4.5, and the UE
shall start timer T3586 (see example in figure 6.6.2.2.1).
Figure 6.6.2.2.1: Remote UE report procedure
#### 6.6.2.3 Remote UE report procedure accepted by the network
Upon receipt of the REMOTE UE REPORT message, the SMF shall send a REMOTE UE
REPORT RESPONSE message to the UE. The SMF shall include the PTI from the
REMOTE UE REPORT message.
The SMF shall set the EAP message IE to an EAP-success message or an EAP-
failure message to be sent to the 5G ProSe layer-3 remote UE if the EAP-
success message or the EAP-failure message is received from the DN.
Upon receipt of the REMOTE UE REPORT RESPONSE message, the UE shall stop timer
T3586 and enter the state PROCEDURE TRANSACTION INACTIVE.
#### 6.6.2.4 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Expiry of timer T3586:
On the first expiry of the timer T3586, the UE shall resend the REMOTE UE
REPORT message and shall reset and restart timer T3586. This retransmission is
repeated two times, i.e. on the third expiry of timer T3586, the UE shall
abort the procedure and release any resources for this procedure.
NOTE: After the abortion of the remote UE report procedure, the remote UE
report procedure for the remote UE(s) can be restarted and how to restart the
procedure is left to UE implementation.
b) Collision of network-requested PDU session release procedure and remote UE
report procedure:
If the UE receives a PDU SESSION RELEASE COMMAND message during the remote UE
report procedure, and the PDU session indicated in the PDU SESSION RELEASE
COMMAND message is the PDU session ID that the UE had indicated in the REMOTE
UE REPORT message, the UE shall abort the remote UE report procedure and
proceed with the network-requested PDU session release procedure.
#### 6.6.2.5 Abnormal cases on the network side
The following abnormal cases have been identified:
a) Collision of network-requested PDU session release procedure and remote UE
report procedure:
If the SMF receives a REMOTE UE REPORT message during a network-requested PDU
session release procedure, and the PDU session indicated in the PDU SESSION
RELEASE COMMAND message is the PDU session ID that is in the REMOTE UE REPORT
message, the SMF shall abort the remote UE report procedure and proceed with
the network-requested PDU session release procedure.
b) PDU session inactive for the received PDU session identity:
If the PDU session ID in the REMOTE UE REPORT message belongs to any PDU
session in state PDU SESSION INACTIVE in the SMF, the SMF shall send the 5GSM
STATUS message to the UE with the 5GSM cause #43 \"Invalid PDU session
identity\".
# 7 Handling of unknown, unforeseen, and erroneous protocol data
## 7.1 General
The procedures specified in the present document apply to those messages which
pass the checks described in this subclause.
This subclause also specifies procedures for the handling of unknown,
unforeseen, and erroneous protocol data by the receiving entity. These
procedures are called \"error handling procedures\", but in addition to
providing recovery mechanisms for error situations they define a compatibility
mechanism for future extensions of the protocols.
Subclauses 7.1 to 7.8 shall be applied in order of precedence.
Detailed error handling procedures in the network are implementation dependent
and may vary from PLMN to PLMN. However, when extensions of this protocol are
developed, networks are assumed to have the error handling which is indicated
in this subclause as mandatory (\"shall\") and that is indicated as strongly
recommended (\"should\").
Also, the error handling of the network is only considered as mandatory or
strongly recommended when certain thresholds for errors are not reached during
a dedicated connection.
For definition of semantical and syntactical errors see 3GPP TS 24.007 [11],
subclause 11.4.2.
## 7.2 Message too short or too long
### 7.2.1 Message too short
When a message is received that is too short to contain a complete message
type information element, that message shall be ignored, cf. 3GPP TS 24.007
[11].
### 7.2.2 Message too long
The maximum size of a NAS message for NR connected to 5GCN is specified in
3GPP TS 38.323 [29].
The maximum size of a NAS message for E-UTRA connected to 5GCN is specified
3GPP TS 36.323 [25].
The maximum size of a NAS message for non-3GPP access connected to 5GCN is
specified in 3GPP TS 24.502 [18]
## 7.3 Unknown or unforeseen procedure transaction identity or PDU Session
identity
### 7.3.1 Procedure transaction identity
The following network procedures shall apply for handling an unknown,
erroneous, or unforeseen PTI received in a 5GSM message:
a) In case the network receives a PDU SESSION MODIFICATION COMPLETE, a PDU
SESSION RELEASE COMPLETE message or a PDU SESSION MODIFICATION COMMAND REJECT
message in which the PTI value is an assigned or unassigned value that does
not match any PTI in use, the network shall respond with a 5GSM STATUS message
including 5GSM cause #47 \"PTI mismatch\".
b) In case the network receives a PDU SESSION AUTHENTICATION COMPLETE message
in which the PTI value is an assigned value, the network shall respond with a
5GSM STATUS message including 5GSM cause #81 \"invalid PTI value\".
c) In case the network receives a PDU SESSION ESTABLISHMENT REQUEST message, a
PDU SESSION MODIFICATION REQUEST message or a PDU SESSION RELEASE REQUEST
message in which the PTI value is an unassigned value, the network shall
respond with a 5GSM STATUS message including 5GSM cause #81 \"invalid PTI
value\".
d) In case the network receives a 5GSM message in which the PTI value is a
reserved value, the network shall ignore the message.
The following UE procedures shall apply for handling an unknown, erroneous, or
unforeseen PTI received in a 5GSM message:
a) In case the UE receives a PDU SESSION MODIFICATION COMMAND message or a PDU
SESSION MODIFICATION REJECT message in which the PTI value is an assigned
value that does not match any PTI in use:
1) if the UE detects that this PDU SESSION MODIFICATION COMMAND message is a
network retransmission of an already accepted request (see subclause 6.3.2.3),
the UE shall respond with a PDU SESSION MODIFICATION COMPLETE message;
2) if the UE detects that this PDU SESSION MODIFICATION COMMAND message is a
network retransmission of an already rejected request (see subclause 6.3.2.4),
the UE shall respond with a PDU SESSION MODIFICATION COMAND REJECT message; or
3) otherwise, the UE shall respond with a 5GSM STATUS message including 5GSM
cause #47 \"PTI mismatch\".
b) In case the UE receives a PDU SESSION RELEASE COMMAND message or a PDU
SESSION RELEASE REJECT message in which the PTI value is an assigned value
that does not match any PTI in use:
1) if the UE detects that this PDU SESSION RELEASE COMMAND message is a
network retransmission of an already accepted request (see subclause 6.3.3.3),
the UE shall respond with a PDU SESSION RELEASE COMPLETE message; or
2) otherwise, the UE shall respond with a 5GSM STATUS message including 5GSM
cause #47 \"PTI mismatch\".
c) In case the UE receives a PDU SESSION ESTABLISHMENT ACCEPT message or a PDU
SESSION ESTABLISHMENT REJECT message in which the PTI value is an assigned
value that does not match any PTI in use:
1) the UE shall respond with a 5GSM STATUS message including 5GSM cause #47
\"PTI mismatch\".
d) In case the UE receives a PDU SESSION AUTHENTICATION COMMAND message or a
PDU SESSION AUTHENTICATION RESULT message in which the PTI value is an
assigned value, the UE shall respond with a 5GSM STATUS message including 5GSM
cause #81 \"invalid PTI value\".
e) In case the UE receives a PDU SESSION ESTABLISHMENT ACCEPT message, a PDU
SESSION ESTABLISHMENT REJECT message, a PDU SESSION MODIFICATION REJECT
message or a PDU SESSION RELEASE REJECT message in which the PTI value is an
unassigned value, the UE shall ignore the message.
f) In case the UE receives a 5GSM message in which the PTI value is a reserved
value, the UE shall ignore the message.
### 7.3.2 PDU Session identity
The following network procedures shall apply for handling an unknown,
erroneous, or unforeseen PDU session identity received in the header of a 5GSM
message (specified as the header of a standard L3 message, see 3GPP TS 24.007
[11]):
a) If the network receives a PDU SESSION MODIFICATION REQUEST message which
includes an unassigned or reserved PDU session identity value, the network
shall respond with a PDU SESSION MODIFICATION REJECT message including 5GSM
cause #43 \"invalid PDU session identity\".
b) If the network receives PDU SESSION RELEASE REQUEST message which includes
an unassigned or reserved PDU session identity value, the network shall
respond with a PDU SESSION RELEASE REJECT message including 5GSM cause #43
\"invalid PDU session identity\".
c) Upon receipt of an UL NAS TRANSPORT message, the network takes the
following actions:
1) If the Request type IE is set to \"initial request\" or \"initial emergency
request\" and the message includes a reserved PDU session identity value, the
network shall respond with a DL NAS TRANSPORT message with 5GMM cause #90
\"payload was not forwarded\";
2) otherwise, if the message includes an unassigned or reserved PDU session
identity value, the network shall respond with a DL NAS TRANSPORT message with
5GMM cause #90 \"payload was not forwarded\".
d) If the network receives a 5GSM message other than those listed in items a)
through c) above in which the message includes a reserved PDU session identity
value or an assigned value that does not match an existing PDU session, the
network shall ignore the message.
The following UE procedures shall apply for handling an unknown, erroneous, or
unforeseen PDU session identity received in the header of a 5GSM message:
a) If the UE receives a 5GSM message which includes an unassigned or reserved
PDU session identity value, the UE shall ignore the message.
b) If the UE receives a 5GSM message which includes a PDU session identity
belonging to any PDU session in state PDU SESSION INACTIVE in the UE, the UE
shall respond with a 5GSM STATUS message including 5GSM cause #43 \"invalid
PDU session identity\".
## 7.4 Unknown or unforeseen message type
If UE receives a 5GMM message or 5GSM message with message type not defined
for the extended protocol discriminator (EPD) or not implemented by the
receiver, it shall return a status message (5GMM STATUS or 5GSM STATUS
depending on the EPD) with cause #97 \"message type non-existent or not
implemented\".
If the network receives a 5GMM or 5GSM message with message type not defined
for the EPD or not implemented by the receiver in a protocol state where
reception of an unsolicited message with the given EPD from the UE is not
foreseen in the protocol, the network actions are implementation dependent.
Otherwise, if the network receives a message with message type not defined for
the EPD or not implemented by the receiver, it shall ignore the message except
that it should return a status message (5GMM STATUS or 5GSM STATUS depending
on the EPD) with cause #97 \"message type non-existent or not implemented\".
NOTE: A message type not defined for the EPD in the given direction is
regarded by the receiver as a message type not defined for the EPD, see 3GPP
TS 24.007 [11].
If the UE receives a message not compatible with the protocol state, the UE
shall return a status message (5GMM STATUS or 5GSM STATUS depending on the
EPD) with cause #98 \"message type not compatible with protocol state\".
If the network receives a message not compatible with the protocol state, the
network actions are implementation dependent.
## 7.5 Non-semantical mandatory information element errors
### 7.5.1 Common procedures
When on receipt of a message,
a) an \"imperative message part\" error; or
b) a \"missing mandatory IE\" error
is diagnosed or when a message containing:
a) a syntactically incorrect mandatory IE;
b) an IE unknown in the message, but encoded as \"comprehension required\"
(see 3GPP TS 24.007 [11]); or
c) an out of sequence IE encoded as \"comprehension required\" (see 3GPP TS
24.007 [11]) is received,
the UE shall proceed as follows:
If the message is not one of the messages listed in the UE procedures in
subclause 7.5.3, item a), b) or c), the UE shall return a status message (5GMM
STATUS or 5GSM STATUS depending on the EPD) with cause #96 \"invalid mandatory
information\";
the network shall proceed as follows:
If the message is not one of the messages listed in the network procedures in
subclause 7.5.3, item a), b) or c), the network shall either:
1) try to treat the message (the exact further actions are implementation
dependent); or
2) ignore the message except that it should return a status message (5GMM
STATUS or 5GSM STATUS depending on the EPD) with cause #96 \"invalid mandatory
information\".
### 7.5.2 5GS mobility management
No exceptional cases are described for 5GS mobility management messages.
No semantical or syntactical diagnosis other than presence and length shall be
performed on the EPS NAS message container information element in the
REGISTRATION REQUEST message.
### 7.5.3 5GS session management
The following UE procedures shall apply for handling an error encountered with
a mandatory information element in a 5GSM message:
a) If the message is a PDU SESSION ESTABLISHMENT ACCEPT, the UE shall initiate
PDU session release procedure by sending a PDU SESSION RELEASE REQUEST message
with 5GSM cause #96 \"invalid mandatory information\".
b) Void.
c) If the message is a PDU SESSION RELEASE COMMAND, a PDU SESSION RELEASE
COMPLETE message with 5GSM cause #96 \"invalid mandatory information\" shall
be returned.
The following network procedures shall apply for handling an error encountered
with a mandatory information element in a 5GSM message:
a) If the message is a PDU SESSION ESTABLISHMENT REQUEST, a PDU SESSION
ESTABLISHMENT REJECT message with 5GSM cause #96 \"invalid mandatory
information\" shall be returned.
b) If the message is a PDU SESSION MODIFICATION REQUEST, a PDU SESSION
MODIFICATION REJECT message with 5GSM cause #96 \"invalid mandatory
information\" shall be returned.
c) If the message is a PDU SESSION RELEASE REQUEST, a PDU SESSION RELEASE
REJECT message with 5GSM cause #96 \"invalid mandatory information\" shall be
returned.
## 7.6 Unknown and unforeseen IEs in the non-imperative message part
### 7.6.1 IEIs unknown in the message
The UE shall ignore all IEs unknown in a message which are not encoded as
\"comprehension required\" (see 3GPP TS 24.007 [11]).
The network shall take the same approach.
### 7.6.2 Out of sequence IEs
The UE shall ignore all out of sequence IEs in a message which are not encoded
as \"comprehension required\" (see 3GPP TS 24.007 [11]).
The network should take the same approach.
### 7.6.3 Repeated IEs
If an information element with format T, TV, TLV, or TLV-E is repeated in a
message in which repetition of the information element is not specified in
clause 8 and clause 9 of the present document, the UE shall handle only the
contents of the information element appearing first and shall ignore all
subsequent repetitions of the information element. When repetition of
information elements is specified, the UE shall handle only the contents of
specified repeated information elements. If the limit on repetition of
information elements is exceeded, the UE shall handle the contents of
information elements appearing first up to the limit of repetitions and shall
ignore all subsequent repetitions of the information element.
The network should follow the same procedures.
## 7.7 Non-imperative message part errors
This category includes:
a) syntactically incorrect optional IEs; and
b) conditional IE errors.
### 7.7.1 Syntactically incorrect optional IEs
The UE shall treat all optional IEs that are syntactically incorrect in a
message as not present in the message.
The network shall take the same approach.
### 7.7.2 Conditional IE errors
When upon receipt of a 5GMM or 5GSM message the UE diagnoses a \"missing
conditional IE\" error or an \"unexpected conditional IE\" error, or when it
receives a 5GMM or 5GSM message containing at least one syntactically
incorrect conditional IE, the UE shall ignore the message and shall return a
status message (5GMM STATUS or 5GSM STATUS depending on the EPD) with cause
#100 \"conditional IE error\".
When the network receives a message and diagnoses a \"missing conditional IE\"
error or an \"unexpected conditional IE\" error or when it receives a message
containing at least one syntactically incorrect conditional IE, the network
shall either:
a) try to treat the message (the exact further actions are implementation
dependent); or
b) ignore the message except that it should return a status message (5GMM
STATUS or 5GSM STATUS depending on the EPD) with cause #100 \"conditional IE
error\".
## 7.8 Messages with semantically incorrect contents
When a message with semantically incorrect contents is received, the UE shall
perform the foreseen reactions of the procedural part of the present document
(i.e. of clauses 5, 6). If, however no such reactions are specified, the UE
shall ignore the message except that it shall return a status message (5GMM
STATUS or 5GSM STATUS depending on the EPD) with cause #95 \"semantically
incorrect message\".
The network should follow the same procedure except that a status message is
not normally transmitted.
# 8 Message functional definitions and contents
## 8.1 Overview
## 8.2 5GS mobility management messages
### 8.2.1 Authentication request
#### 8.2.1.1 Message definition
The AUTHENTICATION REQUEST message is sent by the AMF to the UE to initiate
authentication of the UE identity. See table 8.2.1.1.1.
Message type: AUTHENTICATION REQUEST
Significance: dual
Direction: network to UE
Table 8.2.1.1.1: AUTHENTICATION REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Aut | Message | M | V | 1 | | | hentication | type | | | | | | request | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | ngKSI | NAS key set | M | V | 1/2 | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | ABBA | ABBA | M | LV | 3-n | | | | | | | | | | | 9.11.3.10 | | | | +-----+-------------+-------------+----------+--------+--------+ | 21 | Aut | Aut | O | TV | 17 | | | hentication | hentication | | | | | | parameter | parameter | | | | | | RAND (5G | RAND | | | | | | aut | | | | | | | hentication | 9.11.3.16 | | | | | | challenge) | | | | | +-----+-------------+-------------+----------+--------+--------+ | 20 | Aut | Aut | O | TLV | 18 | | | hentication | hentication | | | | | | parameter | parameter | | | | | | AUTN (5G | AUTN | | | | | | aut | | | | | | | hentication | 9.11.3.15 | | | | | | challenge) | | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.1.2 Authentication parameter RAND
Authentication parameter RAND IE is included if the AUTHENTICATION REQUEST
message is used in a 5G AKA authentication procedure.
#### 8.2.1.3 Authentication parameter AUTN
Authentication parameter AUTN IE is included if the AUTHENTICATION REQUEST
message is used in a 5G AKA authentication procedure.
#### 8.2.1.4 Void
#### 8.2.1.5 EAP message
EAP message IE is included if the AUTHENTICATION REQUEST message is used in an
EAP based primary authentication and key agreement procedure.
### 8.2.2 Authentication response
#### 8.2.2.1 Message definition
The AUTHENTICATION RESPONSE message is sent by the UE to the AMF to deliver a
calculated authentication response to the network. See table 8.2.2.1.1.
Message type: AUTHENTICATION RESPONSE
Significance: dual
Direction: UE to network
Table 8.2.2.1.1: AUTHENTICATION RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Aut | Message | M | V | 1 | | | hentication | type | | | | | | response | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | 2D | Aut | Aut | O | TLV | 18 | | | hentication | hentication | | | | | | response | response | | | | | | parameter | parameter | | | | | | | | | | | | | | 9.11.3.17 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.2.2 Authentication response parameter
This IE is included if the message is sent in a 5G AKA based primary
authentication and key agreement procedure.
#### 8.2.2.3 EAP message
EAP message IE is included if the EAP message received in a related
AUTHENTICATION REQUEST message was an EAP-request.
### 8.2.3 Authentication result
#### 8.2.3.1 Message definition
The AUTHENTICATION RESULT message is sent by the AMF to the UE to provide
result of EAP authentication of the UE identity. See table 8.2.3.1.1.
Message type: AUTHENTICATION RESULT
Significance: dual
Direction: network to UE
Table 8.2.3.1.1: AUTHENTICATION RESULT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Aut | Message | M | V | 1 | | | hentication | type | | | | | | result | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | ngKSI | NAS key set | M | V | 1/2 | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EAP message | EAP message | M | LV-E | 6-1502 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 38 | ABBA | ABBA | O | TLV | 4-n | | | | | | | | | | | 9.11.3.10 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.3.2 ABBA
This IE shall be included if the message contains an EAP message IE with an
EAP-success message.
### 8.2.4 Authentication failure
#### 8.2.4.1 Message definition
The AUTHENTICATION FAILURE message is sent by the UE to the AMF to indicate
that authentication of the network has failed. See table 8.2.4.1.1.
Message type: AUTHENTICATION FAILURE
Significance: dual
Direction: UE to network
Table 8.2.4.1.1: AUTHENTICATION FAILURE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Aut | Message | M | V | 1 | | | hentication | type | | | | | | failure | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GMM cause | 5GMM cause | M | V | 1 | | | | | | | | | | | 9.11.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 30 | Aut | Aut | O | TLV | 16 | | | hentication | hentication | | | | | | failure | failure | | | | | | parameter | parameter | | | | | | | | | | | | | | 9.11.3.14 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.4.2 Authentication failure parameter
This IE shall be included in a 5G AKA based primary authentication and key
agreement procedure if and only if the 5GMM cause was #21 \"synch failure\".
It shall include the response to the authentication challenge from the USIM,
which is made up of the AUTS parameter (see 3GPP TS 33.501 [24]).
### 8.2.5 Authentication reject
#### 8.2.5.1 Message definition
The AUTHENTICATION REJECT message is sent by the AMF to the UE to indicate
that the authentication procedure has failed and that the UE shall abort all
activities. See table 8.2.5.1.1.
Message type: AUTHENTICATION REJECT
Significance: dual
Direction: network to UE
Table 8.2.5.1.1: AUTHENTICATION REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Aut | Message | M | V | 1 | | | hentication | type | | | | | | reject | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.5.2 EAP message
EAP message IE is included if the AUTHENTICATION REJECT message is used to
convey EAP-failure message.
### 8.2.6 Registration request
#### 8.2.6.1 Message definition
The REGISTRATION REQUEST message is sent by the UE to the AMF. See table
8.2.6.1.1.
Message type: REGISTRATION REQUEST
Significance: dual
Direction: UE to network
Table 8.2.6.1.1: REGISTRATION REQUEST message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | Protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | Re | Message | M | V | 1 | | | gistration | type | | | | | | request | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GS | 5GS | M | V | 1/2 | | | re | re | | | | | | gistration | gistration | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.7 | | | | +-----+------------+------------+----------+--------+---------+ | | ngKSI | NAS key | M | V | 1/2 | | | | set | | | | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+------------+------------+----------+--------+---------+ | | 5GS mobile | 5GS mobile | M | LV-E | 6-n | | | identity | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+------------+------------+----------+--------+---------+ | C- | N | NAS key | O | TV | 1 | | | on-current | set | | | | | | native NAS | identifier | | | | | | key set | | | | | | | identifier | 9.11.3.32 | | | | +-----+------------+------------+----------+--------+---------+ | 10 | 5GMM | 5GMM | O | TLV | 3-15 | | | capability | capability | | | | | | | | | | | | | | 9.11.3.1 | | | | +-----+------------+------------+----------+--------+---------+ | 2E | UE | UE | O | TLV | 4-10 | | | security | security | | | | | | capability | capability | | | | | | | | | | | | | | 9.11.3.54 | | | | +-----+------------+------------+----------+--------+---------+ | 2F | Requested | NSSAI | O | TLV | 4-74 | | | NSSAI | | | | | | | | 9.11.3.37 | | | | +-----+------------+------------+----------+--------+---------+ | 52 | Last | 5GS | O | TV | 7 | | | visited | tracking | | | | | | registered | area | | | | | | TAI | identity | | | | | | | | | | | | | | 9.11.3.8 | | | | +-----+------------+------------+----------+--------+---------+ | 17 | S1 UE | S1 UE | O | TLV | 4-15 | | | network | network | | | | | | capability | capability | | | | | | | | | | | | | | 9.11.3.48 | | | | +-----+------------+------------+----------+--------+---------+ | 40 | Uplink | Uplink | O | TLV | 4-34 | | | data | data | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.57 | | | | +-----+------------+------------+----------+--------+---------+ | 50 | PDU | PDU | O | TLV | 4-34 | | | session | session | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+------------+------------+----------+--------+---------+ | B- | MICO | MICO | O | TV | 1 | | | indication | indication | | | | | | | | | | | | | | 9.11.3.31 | | | | +-----+------------+------------+----------+--------+---------+ | 2B | UE status | UE status | O | TLV | 3 | | | | | | | | | | | 9.11.3.56 | | | | +-----+------------+------------+----------+--------+---------+ | 77 | Additional | 5GS mobile | O | TLV-E | 14 | | | GUTI | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+------------+------------+----------+--------+---------+ | 25 | Allowed | Allowed | O | TLV | 4-34 | | | PDU | PDU | | | | | | session | session | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.13 | | | | +-----+------------+------------+----------+--------+---------+ | 18 | UE\'s | UE\'s | O | TLV | 3 | | | usage | usage | | | | | | setting | setting | | | | | | | | | | | | | | 9.11.3.55 | | | | +-----+------------+------------+----------+--------+---------+ | 51 | Requested | 5GS DRX | O | TLV | 3 | | | DRX | parameters | | | | | | parameters | | | | | | | | 9.11.3.2A | | | | +-----+------------+------------+----------+--------+---------+ | 70 | EPS NAS | EPS NAS | O | TLV-E | 4-n | | | message | message | | | | | | container | container | | | | | | | | | | | | | | 9.11.3.24 | | | | +-----+------------+------------+----------+--------+---------+ | 74 | LADN | LADN | O | TLV-E | 3-811 | | | indication | indication | | | | | | | | | | | | | | 9.11.3.29 | | | | +-----+------------+------------+----------+--------+---------+ | 8- | Payload | Payload | O | TV | 1 | | | container | container | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.40 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Payload | Payload | O | TLV-E | 4-65538 | | | container | container | | | | | | | | | | | | | | 9.11.3.39 | | | | +-----+------------+------------+----------+--------+---------+ | 9- | Network | Network | O | TV | 1 | | | slicing | slicing | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.36 | | | | +-----+------------+------------+----------+--------+---------+ | 53 | 5GS update | 5GS update | O | TLV | 3 | | | type | type | | | | | | | | | | | | | | 9.11.3.9A | | | | +-----+------------+------------+----------+--------+---------+ | 41 | Mobile | Mobile | O | TLV | 5 | | | station | station | | | | | | classmark | classmark | | | | | | 2 | 2 | | | | | | | | | | | | | | 9.11.3.31C | | | | +-----+------------+------------+----------+--------+---------+ | 42 | Supported | Supported | O | TLV | 5-n | | | codecs | codec list | | | | | | | | | | | | | | 9.11.3.51A | | | | +-----+------------+------------+----------+--------+---------+ | 71 | NAS | NAS | O | TLV-E | 4-n | | | message | message | | | | | | container | container | | | | | | | | | | | | | | 9.11.3.33 | | | | +-----+------------+------------+----------+--------+---------+ | 60 | EPS bearer | EPS bearer | O | TLV | 4 | | | context | context | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.23A | | | | +-----+------------+------------+----------+--------+---------+ | 6E | Requested | Extended | O | TLV | 3-4 | | | extended | DRX | | | | | | DRX | parameters | | | | | | parameters | | | | | | | | 9.11.3.26A | | | | +-----+------------+------------+----------+--------+---------+ | 6A | T3324 | GPRS timer | O | TLV | 3 | | | value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 67 | UE radio | UE radio | O | TLV | 3-n | | | capability | capability | | | | | | ID | ID | | | | | | | | | | | | | | 9.11.3.68 | | | | +-----+------------+------------+----------+--------+---------+ | 35 | Requested | Mapped | O | TLV | 3-42 | | | mapped | NSSAI | | | | | | NSSAI | | | | | | | | 9.11.3.31B | | | | +-----+------------+------------+----------+--------+---------+ | 48 | Additional | Additional | O | TLV | 3 | | | i | i | | | | | | nformation | nformation | | | | | | requested | requested | | | | | | | | | | | | | | 9.11.3.12A | | | | +-----+------------+------------+----------+--------+---------+ | 1A | Requested | WUS | O | TLV | 3-n | | | WUS | assistance | | | | | | assistance | i | | | | | | i | nformation | | | | | | nformation | | | | | | | | 9.11.3.71 | | | | +-----+------------+------------+----------+--------+---------+ | A- | N5GC | N5GC | O | TV | 1 | | | indication | indication | | | | | | | | | | | | | | 9.11.3.72 | | | | +-----+------------+------------+----------+--------+---------+ | 30 | Requested | NB-N1 mode | O | TLV | 3 | | | NB-N1 mode | DRX | | | | | | DRX | parameters | | | | | | parameters | | | | | | | | 9.11.3.73 | | | | +-----+------------+------------+----------+--------+---------+ | 29 | UE request | UE request | O | TLV | 3 | | | type | type | | | | | | | | | | | | | | 9.11.3.76 | | | | +-----+------------+------------+----------+--------+---------+ | 28 | Paging | Paging | O | TLV | 3-35 | | | r | r | | | | | | estriction | estriction | | | | | | | | | | | | | | 9.11.3.77 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+ | 32 | NID | NID | O | TLV | 8 | | | | | | | | | | | 9.11.3.79 | | | | +-----+------------+------------+----------+--------+---------+ | 16 | MS | PLMN | O | TLV | 5 | | | determined | identity | | | | | | PLMN with | | | | | | | disaster | 9.11.3.85 | | | | | | condition | | | | | +-----+------------+------------+----------+--------+---------+ | 2A | Requested | PEIPS | O | TLV | 3-n | | | PEIPS | assistance | | | | | | assistance | i | | | | | | i | nformation | | | | | | nformation | | | | | | | | 9.11.3.80 | | | | +-----+------------+------------+----------+--------+---------+ | 3B | Requested | GPRS timer | O | TLV | 3 | | | T3512 | 3 | | | | | | value | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.2.6.2 Non-current native NAS key set identifier
The UE shall include this IE if the UE has a valid non-current native 5G NAS
security context when the UE performs an inter-system change from S1 mode to
N1 mode in 5GMM-CONNECTED mode and the UE uses a mapped 5G NAS security
context to protect the REGISTRATION REQUEST message.
#### 8.2.6.3 5GMM capability
The UE shall include this IE, unless the UE performs a periodic registration
updating procedure.
#### 8.2.6.4 UE security capability
The UE shall include this IE, unless the UE performs a periodic registration
updating procedure.
#### 8.2.6.5 Requested NSSAI
This IE shall be included by the UE when performing the registration procedure
if the 5GS registration type IE indicates:
a) \"initial registration\", according to the conditions specified in
subclause 5.5.1.2.2; or
b) \"mobility registration updating\", according to the conditions specified
in subclause 5.5.1.3.2.
#### 8.2.6.6 Last visited registered TAI
This IE shall be included if the UE holds a valid last visited registered TAI.
#### 8.2.6.7 S1 UE network capability
A UE supporting S1 mode shall include this IE, unless the UE performs a
periodic registration updating procedure.
#### 8.2.6.8 Uplink data status
This IE shall be included if the UE has uplink user data pending to be sent,
unless the UE performs a periodic registration updating procedure.
#### 8.2.6.9 PDU session status
This IE shall be included when the UE needs to indicate the PDU sessions that
are associated with the access type that the message is sent over, that are
active within the UE.
#### 8.2.6.10 MICO indication
The UE may include this IE to request the use of MICO mode.
#### 8.2.6.11 UE status
This IE shall be included if the UE in single-registration mode performs the
registration procedure due to inter-system change from S1 mode to N1 mode or
if the UE in dual-registration mode and EMM state EMM-REGISTERED performs
initial registration.
#### 8.2.6.12 Additional GUTI
This IE shall be included:
a) if the UE performs the registration procedure due to inter-system change
from S1 mode to N1 mode, the UE operates in single-registration mode and the
UE has a valid 5G-GUTI; or
b) the UE holds two valid native 5G-GUTIs and one of the valid native 5G-GUTI
was assigned by the PLMN with which the UE is performing the registration.
#### 8.2.6.13 Allowed PDU session status
This IE shall be included if the REGISTRATION REQUEST message is sent as a
response to paging with the access type indicating non-3GPP access and the UE
wants to indicate the user-plane resources of PDU session(s) associated with
non-3GPP access allowed to be re-established over 3GPP access.
#### 8.2.6.14 UE\'s usage setting
This IE shall be included if the UE supports IMS voice.
#### 8.2.6.15 Requested DRX parameters
If the UE wants to use or change the UE specific DRX parameters, the UE shall
include the Requested DRX parameters IE in the REGISTRATION REQUEST message.
#### 8.2.6.16 EPS NAS message container
The UE operating in the single-registration mode shall include this
information element as specified in subclause 5.5.1.3.2 if the UE performs
mobility from S1 mode to N1 mode in 5GMM-IDLE mode. The content of this
message container is the complete integrity protected TRACKING AREA UPATE
REQUEST message, using EPS security context.
The UE performing initial registration shall include this information element
if
a) the UE:
1) was previously registered in S1 mode before entering state EMM-
DEREGISTERED; and
2) has received an \"interworking without N26 interface not supported\"
indication from the network; and
b) EPS security context and a valid 4G-GUTI are available.
The content of this message container is the complete integrity protected
ATTACH REQUEST message, using EPS security context.
#### 8.2.6.17 LADN indication
The UE shall include this information element when the UE needs to request
LADN information for specific LADN DNN(s) or to indicate a request for LADN
information.
#### 8.2.6.17A Payload container type
This IE shall be included if the UE includes the Payload container IE.
NOTE: In this version of the protocol, the Payload container type IE in the
REGISTRATION REQUEST message is set to \"UE policy container\" as described in
subclauses 5.5.1.2.2 and 5.5.1.3.2.
#### 8.2.6.18 Payload container
Within a PLMN, this IE shall be included if the UE has one or more stored UE
policy sections identified by a UPSI with the PLMN ID part indicating the
HPLMN or the selected PLMN for the registration procedure for mobility and
periodic registration update due to inter-system change from S1 mode to N1
mode of a UE operating in the single-registration mode or for the registration
procedure for initial registration.
Within an SNPN, this IE shall be included if the UE has one or more stored UE
policy sections for the selected SNPN for the registration procedure for
initial registration.
#### 8.2.6.19 Network slicing indication
This IE shall be included when a requested NSSAI is included in the
REGISTRATION REQUEST message and the requested NSSAI is created from the
default configured NSSAI.
#### 8.2.6.20 5GS update type
This IE shall be included when the UE is performing the registration procedure
to indicate any of the following:
a) the UE requests the use of SMS over NAS or there is a change in the UE\'s
requirements to use SMS over NAS;
b) a change in the UE\'s radio capability for NG-RAN; or
c) the UE requests CIoT 5GS optimizations.
#### 8.2.6.21 NAS message container
This IE shall be included if the UE is sending a REGISTRATION REQUEST message
as an initial NAS message, the UE has a valid 5G NAS security context and the
UE needs to send non-cleartext IEs.
#### 8.2.6.22 Requested extended DRX parameters
The UE shall include this IE if the UE needs to use extended DRX or change the
extended DRX parameters.
#### 8.2.6.23 EPS bearer context status
The UE shall include this IE if the UE operating in the single-registration
mode performs inter-system change from S1 mode to N1 mode and the UE has
locally deactivated EPS bearer context(s) for which interworking to 5GS is
supported while the UE was in S1 mode without notifying the network.
#### 8.2.6.24 T3324 value
The UE may include this IE during the registration update procedure if it
requests to use MICO mode and use the active time timer.
#### 8.2.6.25 Mobile station classmark 2
This IE shall be included if the UE supports 5G-SRVCC from NG-RAN to UTRAN
(see 3GPP TS 23.216 [6A]).
#### 8.2.6.26 Supported codecs
This IE shall be included if the UE supports 5G-SRVCC from NG-RAN to UTRAN.
#### 8.2.6.27 UE radio capability ID
This IE shall be included if the UE is not in NB-N1 mode, the UE supports RACS
and the UE needs to signal a UE radio capability ID to the network.
#### 8.2.6.28 Requested mapped NSSAI
This IE shall be included by the UE when the UE has a PDN connection or a PDU
session to transfer to visited PLMN associated only with an S-NSSAI that is
applicable in the HPLMN as specified in clause 5.5.1.3.2.
#### 8.2.6.29 Additional information requested
The UE shall include this IE if the UE supports ciphered broadcast assistance
data and the UE needs to obtain new ciphering keys for ciphered broadcast
assistance data.
#### 8.2.6.30 Requested WUS assistance information
The UE may include this IE if:
\- the UE supports WUS assistance information;
\- the UE is not performing initial registration for emergency services; and
\- the UE does not have an active emergency PDU session.
#### 8.2.6.31 Void
#### 8.2.6.32 N5GC indication
This IE shall be included in the REGISTRATION REQUEST message when the W-AGF
is acting on behalf of an N5GC device.
#### 8.2.6.33 Requested NB-N1 mode DRX parameters
The UE shall include this IE if the UE wants to use or change the UE specific
DRX parameters for NB-N1 mode.
#### 8.2.6.34 UE request type
The UE shall include this IE if the MUSIM UE requests the release of the NAS
signalling connection.
#### 8.2.6.35 Paging restriction
The UE shall include this IE if the Request type is set to \"NAS signalling
connection release\" in the UE request type IE and the UE requests the network
to restrict paging.
#### 8.2.6.35 Service-level-AA container
The UE shall include this IE if the UE supporting UAS services requests a
registration for UAS services.
#### 8.2.6.36 NID
The UE shall include this IE if the 5G-GUTI in the 5GS mobile identity IE was
assigned by an SNPN other than the SNPN with which the UE is registering.
#### 8.2.6.37 MS determined PLMN with disaster condition
The UE shall include this IE when the UE needs to indicate the MS determined
PLMN with disaster condition determined as specified in 3GPP TS 23.122 [5].
#### 8.2.6.38 Requested PEIPS assistance information
The UE may include this IE if the UE supports NR paging subgrouping, the UE is
not performing initial registration for emergency services, is not registered
for emergency services and does not have an active emergency PDU session.
#### 8.2.6.39 Requested T3512 value
The UE may include this IE during the registration procedure if it requests to
use MICO mode and T3324 IE is included, to request a particular T3512 timer
value.
### 8.2.7 Registration accept
#### 8.2.7.1 Message definition
The REGISTRATION ACCEPT message is sent by the AMF to the UE. See table
8.2.7.1.1.
Message type: REGISTRATION ACCEPT
Significance: dual
Direction: network to UE
Table 8.2.7.1.1: REGISTRATION ACCEPT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | Re | Message | M | V | 1 | | | gistration | type | | | | | | accept | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GS | 5GS | M | LV | 2 | | | re | re | | | | | | gistration | gistration | | | | | | result | result | | | | | | | | | | | | | | 9.11.3.6 | | | | +-----+------------+------------+----------+--------+---------+ | 77 | 5G-GUTI | 5GS mobile | O | TLV-E | 14 | | | | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+------------+------------+----------+--------+---------+ | 4A | Equivalent | PLMN list | O | TLV | 5-47 | | | PLMNs | | | | | | | | 9.11.3.45 | | | | +-----+------------+------------+----------+--------+---------+ | 54 | TAI list | 5GS | O | TLV | 9-114 | | | | tracking | | | | | | | area | | | | | | | identity | | | | | | | list | | | | | | | | | | | | | | 9.11.3.9 | | | | +-----+------------+------------+----------+--------+---------+ | 15 | Allowed | NSSAI | O | TLV | 4-74 | | | NSSAI | | | | | | | | 9.11.3.37 | | | | +-----+------------+------------+----------+--------+---------+ | 11 | Rejected | Rejected | O | TLV | 4-42 | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.46 | | | | +-----+------------+------------+----------+--------+---------+ | 31 | Configured | NSSAI | O | TLV | 4-146 | | | NSSAI | | | | | | | | 9.11.3.37 | | | | +-----+------------+------------+----------+--------+---------+ | 21 | 5GS | 5GS | O | TLV | 3-5 | | | network | network | | | | | | feature | feature | | | | | | support | support | | | | | | | | | | | | | | 9.11.3.5 | | | | +-----+------------+------------+----------+--------+---------+ | 50 | PDU | PDU | O | TLV | 4-34 | | | session | session | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+------------+------------+----------+--------+---------+ | 26 | PDU | PDU | O | TLV | 4-34 | | | session | session | | | | | | re | re | | | | | | activation | activation | | | | | | result | result | | | | | | | | | | | | | | 9.11.3.42 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | PDU | PDU | O | TLV-E | 5-515 | | | session | session | | | | | | re | re | | | | | | activation | activation | | | | | | result | result | | | | | | error | error | | | | | | cause | cause | | | | | | | | | | | | | | 9.11.3.43 | | | | +-----+------------+------------+----------+--------+---------+ | 79 | LADN | LADN | O | TLV-E | 12-1715 | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.3.30 | | | | +-----+------------+------------+----------+--------+---------+ | B- | MICO | MICO | O | TV | 1 | | | indication | indication | | | | | | | | | | | | | | 9.11.3.31 | | | | +-----+------------+------------+----------+--------+---------+ | 9- | Network | Network | O | TV | 1 | | | slicing | slicing | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.36 | | | | +-----+------------+------------+----------+--------+---------+ | 27 | Service | Service | O | TLV | 6-114 | | | area list | area list | | | | | | | | | | | | | | 9.11.3.49 | | | | +-----+------------+------------+----------+--------+---------+ | 5E | T3512 | GPRS timer | O | TLV | 3 | | | value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 5D | Non-3GPP | GPRS timer | O | TLV | 3 | | | de-re | 2 | | | | | | gistration | | | | | | | timer | 9.11.2.4 | | | | | | value | | | | | +-----+------------+------------+----------+--------+---------+ | 16 | T3502 | GPRS timer | O | TLV | 3 | | | value | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+------------+------------+----------+--------+---------+ | 34 | Emergency | Emergency | O | TLV | 5-50 | | | number | number | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.23 | | | | +-----+------------+------------+----------+--------+---------+ | 7A | Extended | Extended | O | TLV-E | 7-65538 | | | emergency | emergency | | | | | | number | number | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.26 | | | | +-----+------------+------------+----------+--------+---------+ | 73 | SOR | SOR | O | TLV-E | 20-n | | | t | t | | | | | | ransparent | ransparent | | | | | | container | container | | | | | | | | | | | | | | 9.11.3.51 | | | | +-----+------------+------------+----------+--------+---------+ | 78 | EAP | EAP | O | TLV-E | 7-1503 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | A- | NSSAI | NSSAI | O | TV | 1 | | | inclusion | inclusion | | | | | | mode | mode | | | | | | | | | | | | | | 9.11.3.37A | | | | +-----+------------+------------+----------+--------+---------+ | 76 | Operat | Operat | O | TLV-E | 3-8323 | | | or-defined | or-defined | | | | | | access | access | | | | | | category | category | | | | | | d | d | | | | | | efinitions | efinitions | | | | | | | | | | | | | | 9.11.3.38 | | | | +-----+------------+------------+----------+--------+---------+ | 51 | Negotiated | 5GS DRX | O | TLV | 3 | | | DRX | parameters | | | | | | parameters | | | | | | | | 9.11.3.2A | | | | +-----+------------+------------+----------+--------+---------+ | D- | Non-3GPP | Non-3GPP | O | TV | 1 | | | NW | NW | | | | | | policies | provided | | | | | | | policies | | | | | | | | | | | | | | 9.11.3.36A | | | | +-----+------------+------------+----------+--------+---------+ | 60 | EPS bearer | EPS bearer | O | TLV | 4 | | | context | context | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.23A | | | | +-----+------------+------------+----------+--------+---------+ | 6E | Negotiated | Extended | O | TLV | 3-4 | | | extended | DRX | | | | | | DRX | parameters | | | | | | parameters | | | | | | | | 9.11.3.26A | | | | +-----+------------+------------+----------+--------+---------+ | 6C | T3447 | GPRS timer | O | TLV | 3 | | | value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 6B | T3448 | GPRS timer | O | TLV | 3 | | | value | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+------------+------------+----------+--------+---------+ | 6A | T3324 | GPRS timer | O | TLV | 3 | | | value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 67 | UE radio | UE radio | O | TLV | 3-n | | | capability | capability | | | | | | ID | ID | | | | | | | | | | | | | | 9.11.3.68 | | | | +-----+------------+------------+----------+--------+---------+ | E- | UE radio | UE radio | O | TV | 1 | | | capability | capability | | | | | | ID | ID | | | | | | deletion | deletion | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.69 | | | | +-----+------------+------------+----------+--------+---------+ | 39 | Pending | NSSAI | O | TLV | 4-146 | | | NSSAI | | | | | | | | 9.11.3.37 | | | | +-----+------------+------------+----------+--------+---------+ | 74 | Ciphering | Ciphering | O | TLV-E | 34-n | | | key data | key data | | | | | | | | | | | | | | 9.11.3.18C | | | | +-----+------------+------------+----------+--------+---------+ | 75 | CAG | CAG | O | TLV-E | 3-n | | | i | i | | | | | | nformation | nformation | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.18A | | | | +-----+------------+------------+----------+--------+---------+ | 1B | Truncated | Truncated | O | TLV | 3 | | | 5G-S-TMSI | 5G-S-TMSI | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.3.70 | | | | +-----+------------+------------+----------+--------+---------+ | 1C | Negotiated | WUS | O | TLV | 3-n | | | WUS | assistance | | | | | | assistance | i | | | | | | i | nformation | | | | | | nformation | | | | | | | | 9.11.3.71 | | | | +-----+------------+------------+----------+--------+---------+ | 29 | Negotiated | NB-N1 mode | O | TLV | 3 | | | NB-N1 mode | DRX | | | | | | DRX | parameters | | | | | | parameters | | | | | | | | 9.11.3.73 | | | | +-----+------------+------------+----------+--------+---------+ | 68 | Extended | Extended | O | TLV | 5-90 | | | rejected | rejected | | | | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.75 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+ | 33 | Negotiated | PEIPS | O | TLV | 3-n | | | PEIPS | assistance | | | | | | assistance | i | | | | | | i | nformation | | | | | | nformation | | | | | | | | 9.11.3.80 | | | | +-----+------------+------------+----------+--------+---------+ | 35 | 5GS | 5GS | O | TLV | 3 | | | additional | additional | | | | | | request | request | | | | | | result | result | | | | | | | | | | | | | | 9.11.3.81 | | | | +-----+------------+------------+----------+--------+---------+ | 70 | NSSRG | NSSRG | O | TLV-E | 7-4099 | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.3.82 | | | | +-----+------------+------------+----------+--------+---------+ | 14 | Disaster | Re | O | TLV | 4 | | | roaming | gistration | | | | | | wait range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+------------+------------+----------+--------+---------+ | 2C | Disaster | Re | O | TLV | 4 | | | return | gistration | | | | | | wait range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+------------+------------+----------+--------+---------+ | 13 | List of | List of | O | TLV | 2-n | | | PLMNs to | PLMNs to | | | | | | be used in | be used in | | | | | | disaster | disaster | | | | | | condition | condition | | | | | | | | | | | | | | 9.11.3.83 | | | | +-----+------------+------------+----------+--------+---------+ | 1D | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list | area | | | | | | of \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas for | 9.11.3.9 | | | | | | roaming\" | | | | | +-----+------------+------------+----------+--------+---------+ | 1E | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list | area | | | | | | of \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas | 9.11.3.9 | | | | | | fo | | | | | | | r regional | | | | | | | provision | | | | | | | of | | | | | | | service\" | | | | | +-----+------------+------------+----------+--------+---------+ | 71 | Extended | Extended | O | TLV-E | 3-n | | | CAG | CAG | | | | | | i | i | | | | | | nformation | nformation | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.86 | | | | +-----+------------+------------+----------+--------+---------+ | 7C | NSAG | NSAG | O | TLV-E | 9-3143 | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.3.87 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.2.7.2 5G-GUTI
This IE may be included to assign a 5G-GUTI to a UE.
#### 8.2.7.3 Equivalent PLMNs
This IE may be included in order to assign a new equivalent PLMNs list to a
UE.
#### 8.2.7.4 TAI list
This IE may be included to assign a TAI list to a UE.
#### 8.2.7.5 Allowed NSSAI
This IE shall be included:
a) if:
1) one or more S-NSSAIs in the requested NSSAI of the REGISTRATION REQUEST
message are allowed by the AMF for a network not supporting NSSAA;
2) one or more S-NSSAIs in the requested NSSAI of the REGISTRATION REQUEST
message are not subject to network slice-specific authentication and
authorization and are allowed by the AMF; or
3) the network slice-specific authentication and authorization has been
successfully performed for one or more S-NSSAIs in the requested NSSAI of the
REGISTRATION REQUEST message; or
b) if the initial registration request is not for onboarding services in SNPN
or the UE is not registered for onboarding services in SNPN, the requested
NSSAI was not included in the REGISTRATION REQUEST message or none of the
requested NSSAI are allowed; and
1) the network not supporting NSSAA has one or more default S-NSSAIs; or
2) the network has one or more default S-NSSAIs which are not subject to
network slice-specific authentication and authorization.
#### 8.2.7.6 Rejected NSSAI
The network may include this IE to inform the UE of one or more S-NSSAIs that
were included in the requested NSSAI in the REGISTRATION REQUEST message but
were rejected by the network.
#### 8.2.7.7 Configured NSSAI
The network may include this IE if the network needs to provide the UE with a
new configured NSSAI for the current PLMN or SNPN and the UE is neither
registering nor registered for onboarding services in SNPN.
#### 8.2.7.8 5GS network feature support
The network may include this IE to inform the UE of the support of certain
features. If this IE is not included then the UE shall interpret this as a
receipt of an information element with all bits of the value part coded as
zero.
#### 8.2.7.9 PDU session status
This IE shall be included when the network needs to indicate the PDU sessions
that are associated with the access type the message is sent over, that are
active in the network.
#### 8.2.7.10 PDU session reactivation result
This IE shall be included:
\- if the Uplink data status IE is included in the REGISTRATION REQUEST
message;
\- if the Allowed PDU session status IE is included in the REGISTRATION
REQUEST message and there is at least one PDU session indicated in the Allowed
PDU session status IE for which the user-plane resources can be re-established
over 3GPP access.
#### 8.2.7.11 PDU session reactivation result error cause
This IE may be included, if the PDU session reactivation result IE is included
and there exist one or more PDU sessions for which the user-plane resources
cannot be re-established, to indicate the cause of failure to re-establish the
user-plane resources.
#### 8.2.7.12 LADN information
The network shall include this IE if there are valid LADN service area(s) for
the subscribed DNN(s) of the UE in the current registration area.
#### 8.2.7.13 MICO indication
The network shall include the MICO indication IE if:
a)- the UE included the MICO indication IE in the REGISTRATION REQUEST
message; and
b) the network supports and accepts the use of MICO mode.
#### 8.2.7.14 Network slicing indication
This IE shall be included if the user\'s network slicing subscription has
changed in the UDM of a PLMN or an SNPN.
#### 8.2.7.15 Service area list
This IE may be included to assign new service area restrictions to the UE.
#### 8.2.7.16 T3512 value
The AMF shall include this IE during a registration procedure over 3GPP access
when the 5GS registration type IE does not indicate \"periodic registration
updating\". The AMF may include this IE during the mobility and periodic
registration update procedure over 3GPP access when the 5GS registration type
IE indicates \"periodic registration updating\".
#### 8.2.7.17 Non-3GPP de-registration timer value
This IE may be included if the network needs to indicate to the UE registered
over non-3GPP access the value of a non-3GPP de-registration timer value.
#### 8.2.7.18 T3502 value
This IE may be included to indicate a value for timer T3502.
#### 8.2.7.19 Emergency number list
This IE may be sent by the network. If this IE is sent, the contents of this
IE indicates a list of emergency numbers valid within the same country as in
the PLMN from which this IE is received.
#### 8.2.7.20 Extended emergency number list
This IE may be sent by the network. If this IE is sent, the contents of this
IE indicates a list of emergency numbers (with URN information) valid within
the same country as in the PLMN from which this IE is received or valid only
in the PLMN or SNPN from which this IE is received.
#### 8.2.7.21 SOR transparent container
This IE may be sent by the network.
#### 8.2.7.22 EAP message
EAP message IE is included if the REGISTRATION ACCEPT message is sent as part
of registration for emergency services and is used to convey EAP-failure
message.
#### 8.2.7.23 NSSAI inclusion mode
This IE shall be included if required by operatory policy.
#### 8.2.7.24 Operator-defined access category definitions
This IE may be included to assign new operator-defined access category
definitions to the UE or delete the operator-defined access category
definitions at the UE side.
#### 8.2.7.25 Negotiated DRX parameters
The network shall include this IE if the Requested DRX parameters IE was
included in the REGISTRATION REQUEST message.
#### 8.2.7.26 Non-3GPP NW policies
The AMF shall not include this IE during a registration procedure over
non-3GPP access.
This IE is included if the network needs to indicate whether emergency numbers
provided via non-3GPP access can be used to initiate UE detected emergency
calls (see 3GPP TS 24.302 [16]). If this IE is not included then the UE shall
interpret this as a receipt of an information element with all bits of the
value part coded as zero.
NOTE: In this version of the specification, this IE is applicable in case the
UE is connected to a PLMN using an ePDG as specified in 3GPP TS 24.302 [16].
#### 8.2.7.27 Negotiated extended DRX parameters
The network shall include the Negotiated extended DRX parameters IE if:
\- the UE included the Requested extended DRX parameters IE in the
REGISTRATION REQUEST message; and
\- the network supports eDRX and accepts the use of eDRX.
#### 8.2.7.28 T3447 value
The network may include T3447 value IE if:
\- the UE has indicated support for service gap control in the REGISTRATION
REQUEST message; and
\- the 5GMM context contains a service gap time value.
#### 8.2.7.29 T3448 value
The network may include this IE if the congestion control for transport of
user data via the control plane is active and the UE supports the control
plane CIoT 5GS optimizations.
#### 8.2.7.30 T3324 value
The AMF shall include this IE if the UE has requested active time value in the
REGISTRATION REQEUST message and the AMF decides to accept the use of MICO
mode and the use of the active time.
#### 8.2.7.31 EPS bearer context status
This IE shall be included when the network generated an EPS bearer context
status information for the UE during the inter-system change from S1 mode to
N1 mode and the network supports N26 interface.
#### 8.2.7.32 UE radio capability ID
This IE may be included if the UE is not in NB-N1 mode, both the UE and the
network support RACS and the network needs to assign a network-assigned UE
radio capability ID to the UE.
#### 8.2.7.33 UE radio capability ID deletion indication
This IE may be included if the UE is not in NB-N1 mode, both the UE and the
network support RACS and the network needs to trigger the UE to delete all
network-assigned UE radio capability IDs stored at the UE for the serving PLMN
or SNPN.
#### 8.2.7.34 Pending NSSAI
The network may include this IE to inform the UE of one or more S-NSSAIs that
are pending as the network slice-specific authentication and authorization
procedure is not completed.
#### 8.2.7.35 Ciphering key data
This IE is included if the network needs to send ciphering key data to the UE
for ciphered broadcast assistance data.
#### 8.2.7.36 CAG information list
This IE may be included to assign a new \"CAG information list\" to the UE or
delete the \"CAG information list\" at the UE side.
#### 8.2.7.37 Truncated 5G-S-TMSI configuration
The network shall include this IE if:
\- the UE is in NB-N1 mode;
\- the UE requests \"control plane CIoT 5GS optimization\" in the 5GS update
type IE of REGISTRATION REQUEST message;
\- the AMF decides to accept the requested CIoT 5GS optimization; and
\- the network is configured to provide the truncated 5G-S-TMSI configuration
for control plane CIoT 5GS optimizations.
#### 8.2.7.38 Negotiated NB-N1 mode DRX parameters
The network shall include the Negotiated NB-N1 mode DRX parameters IE if the
requested NB-N1 mode DRX parameters IE was included in the REGISTRATION
REQUEST message.
#### 8.2.7.39 Negotiated WUS assistance information
The network shall include the Negotiated WUS assistance information IE if:
\- the UE supports WUS assistance information;
\- the AMF supports and accepts the use of WUS assistance information;
\- the UE is not performing the initial registration for emergency services;
and
\- the UE does not have an active emergency PDU session.
#### 8.2.7.40 Extended rejected NSSAI
If the UE supports Extended rejected NSSAI, the network may include this IE to
inform the UE of one or more S-NSSAIs that were included in the requested
NSSAI in the REGISTRATION REQUEST message but were rejected by the network.
#### 8.2.7.41 Service-level-AA container
The network shall include this IE if the UUAA procedure is triggered for the
UE supporting UAS services. The network may include this IE if there is a
valid successful UUAA result for the UE in the UE 5GMM context upon a
registration for UAS services is requested from the UE.
#### 8.2.7.42 Negotiated PEIPS assistance information
The network shall include the Negotiated PEIPS assistance information IE if:
\- the UE supports NR paging subgrouping;
\- the AMF supports and accepts the use of PEIPS assistance information for
the UE; and
\- the UE is not performing initial registration for emergency services and
does not have an active emergency PDU session.
#### 8.2.7.43 5GS additional request result
The network may include this IE to inform the UE about the result of
additional request.
#### 8.2.7.44 NSSRG information
This IE may be included to provide NSSRG information associated with the
configured NSSAI.
#### 8.2.7.45 Disaster roaming wait range
This IE may be included to assign a new disaster roaming wait range to the UE.
#### 8.2.7.46 Disaster return wait range
This IE may be included to assign a new disaster return wait range to the UE.
#### 8.2.7.47 List of PLMNs to be used in disaster condition
This IE may be included by an allowed PLMN to assign a new \"list of PLMN(s)
to be used in disaster condition\" associated with the serving PLMN to the UE.
#### 8.2.7.48 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for roaming\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for roaming\". This IE is included only if
the message is sent via satellite NG-RAN access.
#### 8.2.7.49 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for regional provision of service\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for regional provision of service\". This IE
is included only if the message is sent via satellite NG-RAN access.
#### 8.2.7.50 Extended CAG information list
If the UE supports Extended CAG information list, the network may include this
IE to assign a new \"CAG information list\" to the UE or delete the \"CAG
information list\" at the UE side.
#### 8.2.7.51 NSAG information
If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message over 3GPP access, the network may include
this IE to provide NSAG information to the UE. Otherwise, the network shall
not include this IE (see the \'comprehension required\' scheme in subclause
11.2.5 of 3GPP TS 24.007 [11]).
### 8.2.8 Registration complete
#### 8.2.8.1 Message definition
The REGISTRATION COMPLETE message is sent by the UE to the AMF. See table
8.2.8.1.1.
Message type: REGISTRATION COMPLETE
Significance: dual
Direction: UE to network
Table 8.2.8.1.1: REGISTRATION COMPLETE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | R | Message | M | V | 1 | | | egistration | type | | | | | | complete | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | 73 | SOR | SOR | O | TLV-E | 20 | | | transparent | transparent | | | | | | container | container | | | | | | | | | | | | | | 9.11.3.51 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.8.2 SOR transparent container
This IE may be sent by the UE. If this IE is sent, the contents of this IE
indicates the UE acknowledgement of successful reception of the SOR
transparent container IE in the REGISTRATION ACCEPT message. This IE shall
indicate the ME support of SOR-CMCI.
### 8.2.9 Registration reject
#### 8.2.9.1 Message definition
The REGISTRATION REJECT message is sent by the AMF to the UE. See table
8.2.9.1.1.
Message type: REGISTRATION REJECT
Significance: dual
Direction: network to UE
Table 8.2.9.1.1: REGISTRATION REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | R | Message | M | V | 1 | | | egistration | type | | | | | | reject | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GMM cause | 5GMM cause | M | V | 1 | | | | | | | | | | | 9.11.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 5F | T3346 value | GPRS timer | O | TLV | 3 | | | | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 16 | T3502 value | GPRS timer | O | TLV | 3 | | | | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 69 | Rejected | Rejected | O | TLV | 4-42 | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.46 | | | | +-----+-------------+-------------+----------+--------+--------+ | 75 | CAG | CAG | O | TLV-E | 3-n | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.18A | | | | +-----+-------------+-------------+----------+--------+--------+ | 68 | Extended | Extended | O | TLV | 5-90 | | | rejected | rejected | | | | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.75 | | | | +-----+-------------+-------------+----------+--------+--------+ | 2C | Disaster | R | O | TLV | 4 | | | return wait | egistration | | | | | | range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+-------------+-------------+----------+--------+--------+ | 71 | Extended | Extended | O | TLV-E | 3-n | | | CAG | CAG | | | | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.86 | | | | +-----+-------------+-------------+----------+--------+--------+ | 3A | Lower bound | GPRS timer | O | TLV | 3 | | | timer value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 1D | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas for | 9.11.3.9 | | | | | | roaming\" | | | | | +-----+-------------+-------------+----------+--------+--------+ | 1E | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas | 9.11.3.9 | | | | | | f | | | | | | | or regional | | | | | | | provision | | | | | | | of | | | | | | | service\" | | | | | +-----+-------------+-------------+----------+--------+--------+
NOTE: It is possible for AMFs compliant with version 17.7.0 or 17.8.0 of this
specification to send the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE with IEI of value \"3B\" for this message or
the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE with IEI of value \"3C\" for this message.
#### 8.2.9.2 T3346 value
The AMF may include this IE when the general NAS level mobility management
congestion control is active
#### 8.2.9.3 T3502 value
This IE may be included to indicate a value for timer T3502 during the initial
registration.
#### 8.2.9.4 EAP message
EAP message IE is included if the REGISTRATION REJECT message is used to
convey EAP-failure message.
#### 8.2.9.5 Rejected NSSAI
The network may include this IE to inform the UE of one or more S-NSSAIs that
were included in the requested NSSAI in the REGISTRATION REQUEST message but
were rejected by the network.
#### 8.2.9.6 CAG information list
This IE may be included to assign a new \"CAG information list\" to the UE or
delete the \"CAG information list\" at the UE side.
#### 8.2.9.7 Extended rejected NSSAI
If the UE supports Extended rejected NSSAI, the network may include this IE to
inform the UE of one or more S-NSSAIs that were included in the requested
NSSAI in the REGISTRATION REQUEST message but were rejected by the network.
#### 8.2.9.8 Disaster return wait range
This IE may be included to assign a new disaster return wait range to the UE.
#### 8.2.9.9 Extended CAG information list
If the UE supports Extended CAG information list, the network may include this
IE to assign a new \"CAG information list\" to the UE or delete the \"CAG
information list\" at the UE side.
#### 8.2.9.10 Lower bound timer value
The AMF may include this IE when the 5GMM cause is set to #78 \"PLMN not
allowed to operate at the present UE location\", to provide a minimum time
value for an entry added to the list of \"PLMNs not allowed to operate at the
present UE location\".
#### 8.2.9.11 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for roaming\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for roaming\". This IE is included only if
the message is sent via satellite NG-RAN access.
#### 8.2.9.12 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for regional provision of service\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for regional provision of service\". This IE
is included only if the message is sent via satellite NG-RAN access.
### 8.2.10 UL NAS transport
#### 8.2.10.1 Message definition
The UL NAS TRANSPORT message transports message payload and associated
information to the AMF. See table 8.2.10.1.1.
Message type: UL NAS TRANSPORT
Significance: dual
Direction: UE to network
Table 8.2.10.1.1: UL NAS TRANSPORT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | UL NAS | Message | M | V | 1 | | | TRANSPORT | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+------------+------------+----------+--------+---------+ | | Payload | Payload | M | V | 1/2 | | | container | container | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.40 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | Payload | Payload | M | LV-E | 3-65537 | | | container | container | | | | | | | | | | | | | | 9.11.3.39 | | | | +-----+------------+------------+----------+--------+---------+ | 12 | PDU | PDU | C | TV | 2 | | | session ID | session | | | | | | | identity 2 | | | | | | | | | | | | | | 9.11.3.41 | | | | +-----+------------+------------+----------+--------+---------+ | 59 | Old PDU | PDU | O | TV | 2 | | | session ID | session | | | | | | | identity 2 | | | | | | | | | | | | | | 9.11.3.41 | | | | +-----+------------+------------+----------+--------+---------+ | 8- | Request | Request | O | TV | 1 | | | type | type | | | | | | | | | | | | | | 9.11.3.47 | | | | +-----+------------+------------+----------+--------+---------+ | 22 | S-NSSAI | S-NSSAI | O | TLV | 3-10 | | | | | | | | | | | 9.11.2.8 | | | | +-----+------------+------------+----------+--------+---------+ | 25 | DNN | DNN | O | TLV | 3-102 | | | | | | | | | | | 9.11.2.1B | | | | +-----+------------+------------+----------+--------+---------+ | 24 | Additional | Additional | O | TLV | 3-n | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.2.1 | | | | +-----+------------+------------+----------+--------+---------+ | A- | MA PDU | MA PDU | O | TV | 1 | | | session | session | | | | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.3.31A | | | | +-----+------------+------------+----------+--------+---------+ | F- | Release | Release | O | TV | 1 | | | assistance | assistance | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.46A | | | | +-----+------------+------------+----------+--------+---------+
#### 8.2.10.2 PDU session ID
The UE shall include this IE when the Payload container type IE is set to \"N1
SM information\" or \"CIoT user data.
#### 8.2.10.3 Old PDU session ID
The UE shall include this IE if the UL NAS TRANSPORT message transports a PDU
SESSION ESTABLISHMENT REQUEST message upon receiving the PDU SESSION
MODIFICATION COMMAND message with the 5GSM cause IE set to #39 \"reactivation
requested\" and the Payload container type IE is set to \"N1 SM information\".
#### 8.2.10.4 Request type
The UE shall include this IE when the PDU session ID IE is included and the
Payload container IE contains the PDU SESSION ESTABLISHMENT REQUEST message or
the PDU SESSION MODIFICATION REQUEST which is not initiated to indicate a
change of 3GPP PS data off UE status associated to a PDU session.
#### 8.2.10.5 S-NSSAI
The UE may include this IE when the Request type IE is set to \"initial
request\", \"existing PDU session\" or \"MA PDU request\", the Payload
container type IE is set to \"N1 SM information\" and the UE is not registered
for onboarding services in SNPN.
#### 8.2.10.6 DNN
The UE may include this IE when the Request type IE is set to \"initial
request\", \"existing PDU session\" or \"MA PDU request\", the Payload
container type IE is set to \"N1 SM information\" and the UE is not registered
for onboarding services in SNPN.
#### 8.2.10.7 Additional information
The UE may include this IE when the Payload container type IE is set to \"LTE
Positioning Protocol (LPP) message container\" or \"Location services (LCS)
message container\".
#### 8.2.10.8 MA PDU session information
The UE may include this IE if the Request type IE is included and is not set
to \"initial emergency request \" or \"existing emergency PDU session\" in the
UL NAS TRANSPORT message.
#### 8.2.10.9 Release assistance indication
The UE may include this IE to inform the network whether:
\- no further uplink and no further downlink data transmission is expected; or
\- only a single downlink data transmission (e.g. acknowledgement or response
to uplink data) and no further uplink data transmission subsequent to the
uplink data transmission is expected.
### 8.2.11 DL NAS transport
#### 8.2.11.1 Message definition
The DL NAS TRANSPORT message transports message payload and associated
information to the UE. See table 8.2.11.1.1.
Message type: DL NAS TRANSPORT
Significance: dual
Direction: network to UE
Table 8.2.11.1.1: DL NAS TRANSPORT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | DL NAS | Message | M | V | 1 | | | TRANSPORT | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+------------+------------+----------+--------+---------+ | | Payload | Payload | M | V | 1/2 | | | container | container | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.40 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | Payload | Payload | M | LV-E | 3-65537 | | | container | container | | | | | | | | | | | | | | 9.11.3.39 | | | | +-----+------------+------------+----------+--------+---------+ | 12 | PDU | PDU | C | TV | 2 | | | session ID | session | | | | | | | identity 2 | | | | | | | | | | | | | | 9.11.3.41 | | | | +-----+------------+------------+----------+--------+---------+ | 24 | Additional | Additional | O | TLV | 3-n | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.2.1 | | | | +-----+------------+------------+----------+--------+---------+ | 58 | 5GMM cause | 5GMM cause | O | TV | 2 | | | | | | | | | | | 9.11.3.2 | | | | +-----+------------+------------+----------+--------+---------+ | 37 | Back-off | GPRS timer | O | TLV | 3 | | | timer | 3 | | | | | | value | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 3A | Lower | GPRS timer | O | TLV | 3 | | | bound | 3 | | | | | | timer | | | | | | | value | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.2.11.2 PDU session ID
The AMF shall include this IE when the Payload container type IE is set to
\"N1 SM information\" or \"CIoT user data container\".
#### 8.2.11.3 Additional information
The AMF may include this IE when the Payload container type IE is set to \"LTE
Positioning Protocol (LPP) message container\" or \"Location services (LCS)
message container\".
#### 8.2.11.4 5GMM cause
The AMF shall include this IE when the Payload container IE contains an uplink
payload which was not forwarded and the Payload container type IE is not set
to \"Multiple payloads\".
#### 8.2.11.5 Back-off timer value
The AMF shall include this IE when the Payload container IE contains an uplink
5GSM message which was not forwarded due to DNN based congestion control,
S-NSSAI and DNN based congestion control, S-NSSAI only based congestion
control or the DNN is not supported or not subscribed in a slice, and the
Payload container type IE is not set to \"Multiple payloads\".
#### 8.2.11.6 Lower bound timer value
The AMF may include this IE when the 5GMM cause is set to #78 \"PLMN not
allowed to operate at the present UE location\", to provide a minimum time
value for an entry added to the list of \"PLMNs not allowed to operate at the
present UE location\".
### 8.2.12 De-registration request (UE originating de-registration)
#### 8.2.12.1 Message definition
The DEREGISTRATION REQUEST message is sent by the UE to the AMF. See table
8.2.12.1.1.
Message type: DEREGISTRATION REQUEST
Significance: dual
Direction: UE to network
Table 8.2.12.1.1: DEREGISTRATION REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | De-r | Message | M | V | 1 | | | egistration | type | | | | | | request | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | De-r | De-r | M | V | 1/2 | | | egistration | egistration | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.20 | | | | +-----+-------------+-------------+----------+--------+--------+ | | ngKSI | NAS key set | M | V | 1/2 | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GS mobile | 5GS mobile | M | LV-E | 6-n | | | identity | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.13 De-registration accept (UE originating de-registration)
#### 8.2.13.1 Message definition
The DEREGISTRATION ACCEPT message is sent by the AMF to the UE. See table
8.2.13.1.1.
Message type: DEREGISTRATION ACCEPT
Significance: dual
Direction: network to UE
Table 8.2.13.1.1: DEREGISTRATION ACCEPT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | De-r | Message | M | V | 1 | | | egistration | type | | | | | | accept | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.14 De-registration request (UE terminated de-registration)
#### 8.2.14.1 Message definition
The DEREGISTRATION REQUEST message is sent by the AMF to the UE. See table
8.2.14.1.1.
Message type: DEREGISTRATION REQUEST
Significance: dual
Direction: network to UE
Table 8.2.14.1.1: DEREGISTRATION REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | De-r | Message | M | V | 1 | | | egistration | type | | | | | | request | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | De-r | De-r | M | V | 1/2 | | | egistration | egistration | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.20 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 58 | 5GMM cause | 5GMM cause | O | TV | 2 | | | | | | | | | | | 9.11.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 5F | T3346 value | GPRS timer | O | TLV | 3 | | | | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 6D | Rejected | Rejected | O | TLV | 4-42 | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.46 | | | | +-----+-------------+-------------+----------+--------+--------+ | 75 | CAG | CAG | O | TLV-E | 3-n | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.18A | | | | +-----+-------------+-------------+----------+--------+--------+ | 68 | Extended | Extended | O | TLV | 5-90 | | | rejected | rejected | | | | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.75 | | | | +-----+-------------+-------------+----------+--------+--------+ | 2C | Disaster | R | O | TLV | 4 | | | return wait | egistration | | | | | | range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+-------------+-------------+----------+--------+--------+ | 71 | Extended | Extended | O | TLV-E | 3-n | | | CAG | CAG | | | | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.86 | | | | +-----+-------------+-------------+----------+--------+--------+ | 3A | Lower bound | GPRS timer | O | TLV | 3 | | | timer value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 1D | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas for | 9.11.3.9 | | | | | | roaming\" | | | | | +-----+-------------+-------------+----------+--------+--------+ | 1E | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas | 9.11.3.9 | | | | | | f | | | | | | | or regional | | | | | | | provision | | | | | | | of | | | | | | | service\" | | | | | +-----+-------------+-------------+----------+--------+--------+
NOTE: It is possible for AMFs compliant with version 17.7.0 or 17.8.0 of this
specification to send the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE with IEI of value \"3B\" for this message or
the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE with IEI of value \"3C\" for this message.
#### 8.2.14.2 5GMM cause
This information element is included if a 5GMM cause is provided.
#### 8.2.14.3 T3346 value
The AMF may include this IE when the general NAS level mobility management
congestion control is active.
#### 8.2.14.4 Rejected NSSAI
The AMF may include this IE to inform the UE of one or more S-NSSAIs that were
rejected by the network due to network slice-specific authentication and
authorization failure or revocation as specified in subclause 4.6.2.4.
#### 8.2.14.5 CAG information list
This IE may be included to assign a new \"CAG information list\" to the UE or
delete the \"CAG information list\" at the UE side.
#### 8.2.14.6 Extended rejected NSSAI
If the UE supports Extended rejected NSSAI, the AMF may include this IE to
inform the UE of one or more S-NSSAIs that were rejected by the network due to
network slice-specific authentication and authorization failure or revocation
as specified in subclause 4.6.2.4.
#### 8.2.14.7 Disaster return wait range
This IE may be included to assign a new disaster return wait range to the UE.
#### 8.2.14.7A Extended CAG information list
If the UE supports Extended CAG information list, the network may include this
IE to assign a new \"CAG information list\" to the UE or delete the \"CAG
information list\" at the UE side.
#### 8.2.14.8 Lower bound timer value
The AMF may include this IE when the 5GMM cause is set to #78 \"PLMN not
allowed to operate at the present UE location\", to provide a minimum time
value for an entry added to the list of \"PLMNs not allowed to operate at the
present UE location\".
#### 8.2.14.9 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for roaming\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for roaming\". This IE is included only if
the message is sent via satellite NG-RAN access.
#### 8.2.14.10 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for regional provision of service\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for regional provision of service\". This IE
is included only if the message is sent via satellite NG-RAN access.
### 8.2.15 De-registration accept (UE terminated de-registration)
#### 8.2.15.1 Message definition
The DEREGISTRATION ACCEPT message is sent by the UE to the AMF. See table
8.2.15.1.1.
Message type: DEREGISTRATION ACCEPT
Significance: dual
Direction: UE to network
Table 8.2.15.1.1.1: DEREGISTRATION ACCEPT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | De-r | Message | M | V | 1 | | | egistration | type | | | | | | accept | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.16 Service request
#### 8.2.16.1 Message definition
The SERVICE REQUEST message is sent by the UE to the AMF in order to request
the establishment of an N1 NAS signalling connection and/or to request the
establishment of user-plane resources for PDU sessions which are established
without user-plane resources. See table 8.2.16.1.1.
Message type: SERVICE REQUEST
Significance: dual
Direction: UE to network
Table 8.2.16.1.1: SERVICE REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Service | Message | M | V | 1 | | | request | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | ngKSI | NAS key set | M | V | 1/2 | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Service | Service | M | V | 1/2 | | | type | type | | | | | | | | | | | | | | 9.11.3.50 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5G-S-TMSI | 5GS mobile | M | LV-E | 9 | | | | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 40 | Uplink data | Uplink data | O | TLV | 4-34 | | | status | status | | | | | | | | | | | | | | 9.11.3.57 | | | | +-----+-------------+-------------+----------+--------+--------+ | 50 | PDU session | PDU session | O | TLV | 4-34 | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+-------------+-------------+----------+--------+--------+ | 25 | Allowed PDU | Allowed PDU | O | TLV | 4-34 | | | session | session | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.13 | | | | +-----+-------------+-------------+----------+--------+--------+ | 71 | NAS message | NAS message | O | TLV-E | 4-n | | | container | container | | | | | | | | | | | | | | 9.11.3.33 | | | | +-----+-------------+-------------+----------+--------+--------+ | 29 | UE request | UE request | O | TLV | 3 | | | type | type | | | | | | | | | | | | | | 9.11.3.76 | | | | +-----+-------------+-------------+----------+--------+--------+ | 28 | Paging | Paging | O | TLV | 3-35 | | | restriction | restriction | | | | | | | | | | | | | | 9.11.3.77 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.16.2 Uplink data status
This IE shall be included if the UE has uplink user data pending to be sent.
#### 8.2.16.3 PDU session status
This IE shall be included when the UE needs to indicate the PDU sessions that
are associated with the access type that the message is sent over, that are
active within the UE.
#### 8.2.16.4 Allowed PDU session status
This IE shall be included if the SERVICE REQUEST message is sent as a response
to paging or notification via 3GPP access for PDU session(s) associated with
non-3GPP access and the UE needs to indicate the user-plane resources of PDU
session(s) associated with non-3GPP access allowed to be re-established over
3GPP access or if there is no PDU session(s) for which the UE allows the user-
plane resources to be re-established over 3GPP access.
#### 8.2.16.5 NAS message container
This IE shall be included if the UE is sending a SERVICE REQUEST message as an
initial NAS message and the UE needs to send non-cleartext IEs.
#### 8.2.16.6 UE request type
The UE shall include this IE if the MUSIM UE requests the release of the NAS
signalling connection or rejects the paging request from the network.
#### 8.2.16.7 Paging restriction
The UE shall include this IE if the Request type is set to \"NAS signalling
connection release\" or to \"Rejection of paging\" in the UE request type IE
and the UE requests the network to restrict paging.
### 8.2.17 Service accept
#### 8.2.17.1 Message definition
The SERVICE ACCEPT message is sent by the AMF to the UE in order to accept the
service request procedure. See table 8.2.17.1.1.
Message type: SERVICE ACCEPT
Significance: dual
Direction: network to UE
Table 8.2.17.1.1: SERVICE ACCEPT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Service | Message | M | V | 1 | | | accept | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | 50 | PDU session | PDU session | O | TLV | 4-34 | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+-------------+-------------+----------+--------+--------+ | 26 | PDU session | PDU session | O | TLV | 4-34 | | | r | r | | | | | | eactivation | eactivation | | | | | | result | result | | | | | | | | | | | | | | 9.11.3.42 | | | | +-----+-------------+-------------+----------+--------+--------+ | 72 | PDU session | PDU session | O | TLV-E | 5-515 | | | r | r | | | | | | eactivation | eactivation | | | | | | result | result | | | | | | error cause | error cause | | | | | | | | | | | | | | 9.11.3.43 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 6B | T3448 value | GPRS timer | O | TLV | 3 | | | | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 34 | 5GS | 5GS | O | TLV | 3 | | | additional | additional | | | | | | request | request | | | | | | result | result | | | | | | | | | | | | | | 9.11.3.81 | | | | +-----+-------------+-------------+----------+--------+--------+ | 1D | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas for | 9.11.3.9 | | | | | | roaming\" | | | | | +-----+-------------+-------------+----------+--------+--------+ | 1E | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas | 9.11.3.9 | | | | | | f | | | | | | | or regional | | | | | | | provision | | | | | | | of | | | | | | | service\" | | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.17.2 PDU session status
This IE shall be included when the network needs to indicate the PDU sessions
that are associated with the access type that the message is sent over that
are active within the network.
#### 8.2.17.3 PDU session reactivation result
This IE shall be included:
\- if the Uplink data status IE is included in the SERVICE REQUEST message;
\- if the Allowed PDU session status IE is included in the SERVICE REQUEST
message and there is at least one PDU session indicated in the Allowed PDU
session status IE for which user-plane resources can be re-established over
3GPP access.
#### 8.2.17.4 PDU session reactivation result error cause
This IE may be included if the PDU session reactivation result IE is included
and there exist one or more PDU sessions for which the user-plane resources
cannot be re-established, to indicate the cause of failure to re-establish the
user-plane resources.
#### 8.2.17.5 EAP message
EAP message IE is included if the SERVICE ACCEPT message is sent to a UE
registered for emergency services and is used to convey EAP-failure message.
#### 8.2.17.6 T3448 value
The network may include this IE if the congestion control for transport of
user data via the control plane is active and the UE supports the control
plane CIoT 5GS optimizations.
#### 8.2.17.7 5GS additional request result
The network may include this IE to inform the UE about the result of
additional request.
#### 8.2.17.8 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for roaming\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for roaming\". This IE is included only if
the message is sent via satellite NG-RAN access.
#### 8.2.17.9 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for regional provision of service\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for regional provision of service\". This IE
is included only if the message is sent via satellite NG-RAN access.
### 8.2.18 Service reject
#### 8.2.18.1 Message definition
The SERVICE REJECT message is sent by the AMF to the UE in order to reject the
service request procedure. See table 8.2.18.1.1.
Message type: SERVICE REJECT
Significance: dual
Direction: network to UE
Table 8.2.18.1.1: SERVICE REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Service | Message | M | V | 1 | | | reject | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GMM cause | 5GMM cause | M | V | 1 | | | | | | | | | | | 9.11.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 50 | PDU session | PDU session | O | TLV | 4-34 | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+-------------+-------------+----------+--------+--------+ | 5F | T3346 value | GPRS timer | O | TLV | 3 | | | | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 6B | T3448 value | GPRS timer | O | TLV | 3 | | | | 2 | | | | | | | | | | | | | | 9.11.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 75 | CAG | CAG | O | TLV-E | 3-n | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.18A | | | | +-----+-------------+-------------+----------+--------+--------+ | 2C | Disaster | R | O | TLV | 4 | | | return wait | egistration | | | | | | range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+-------------+-------------+----------+--------+--------+ | 71 | Extended | Extended | O | TLV-E | 3-n | | | CAG | CAG | | | | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.86 | | | | +-----+-------------+-------------+----------+--------+--------+ | 3A | Lower bound | GPRS timer | O | TLV | 3 | | | timer value | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 1D | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas for | 9.11.3.9 | | | | | | roaming\" | | | | | +-----+-------------+-------------+----------+--------+--------+ | 1E | Forbidden | 5GS | O | TLV | 9-114 | | | TAI(s) for | tracking | | | | | | the list of | area | | | | | | \"5GS | identity | | | | | | forbidden | list | | | | | | tracking | | | | | | | areas | 9.11.3.9 | | | | | | f | | | | | | | or regional | | | | | | | provision | | | | | | | of | | | | | | | service\" | | | | | +-----+-------------+-------------+----------+--------+--------+
NOTE: It is possible for AMFs compliant with version 17.7.0 or 17.8.0 of this
specification to send the Forbidden TAI(s) for the list of \"5GS forbidden
tracking areas for roaming\" IE with IEI of value \"3B\" for this message or
the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for
regional provision of service\" IE with IEI of value \"3C\" for this message.
#### 8.2.18.2 PDU session status
This IE shall be included when the network needs to indicate the PDU sessions
that are associated with the access type that the message is sent over, that
are active within the network.
#### 8.2.18.3 T3346 value
The AMF may include this IE when the general NAS level mobility management
congestion control is active.
#### 8.2.18.4 EAP message
EAP message IE is included if the SERVICE REJECT message is used to convey
EAP-failure message.
#### 8.2.18.5 T3448 value
The network may include this IE if the congestion control for transport of
user data via the control plane is active and the UE supports the control
plane CIoT 5GS optimizations.
#### 8.2.18.6 CAG information list
This IE may be included to assign a new \"CAG information list\" to the UE or
delete the \"CAG information list\" at the UE side.
#### 8.2.18.7 Disaster return wait range
This IE may be included to assign a new disaster return wait range to the UE.
#### 8.2.18.8 Extended CAG information list
If the UE supports Extended CAG information list, the network may include this
IE to assign a new \"CAG information list\" to the UE or delete the \"CAG
information list\" at the UE side.
#### 8.2.18.9 Lower bound timer value
The AMF may include this IE when the 5GMM cause is set to #78 \"PLMN not
allowed to operate at the present UE location\", to provide a minimum time
value for an entry added to the list of \"PLMNs not allowed to operate at the
present UE location\".
#### 8.2.18.10 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for roaming\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for roaming\". This IE is included only if
the message is sent via satellite NG-RAN access.
#### 8.2.18.11 Forbidden TAI(s) for the list of \"5GS forbidden tracking areas
for regional provision of service\"
This IE is included to indicate the forbidden TAI(s) to be stored in the list
of \"5GS forbidden tracking areas for regional provision of service\". This IE
is included only if the message is sent via satellite NG-RAN access.
### 8.2.19 Configuration update command
#### 8.2.19.1 Message definition
The CONFIGURATION UPDATE COMMAND message is sent by the AMF to the UE. See
table 8.2.19.1.1.
Message type: CONFIGURATION UPDATE COMMAND
Significance: dual
Direction: network to UE
Table 8.2.19.1.1: CONFIGURATION UPDATE COMMAND message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Co | Message | M | V | 1 | | | nfiguration | type | | | | | | update | | | | | | | command | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | D- | Co | Co | O | TV | 1 | | | nfiguration | nfiguration | | | | | | update | update | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.18 | | | | +-----+-------------+-------------+----------+--------+--------+ | 77 | 5G-GUTI | 5GS mobile | O | TLV-E | 14 | | | | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 54 | TAI list | 5GS | O | TLV | 9-114 | | | | tracking | | | | | | | area | | | | | | | identity | | | | | | | list | | | | | | | | | | | | | | 9.11.3.9 | | | | +-----+-------------+-------------+----------+--------+--------+ | 15 | Allowed | NSSAI | O | TLV | 4-74 | | | NSSAI | | | | | | | | 9.11.3.37 | | | | +-----+-------------+-------------+----------+--------+--------+ | 27 | Service | Service | O | TLV | 6-114 | | | area list | area list | | | | | | | | | | | | | | 9.11.3.49 | | | | +-----+-------------+-------------+----------+--------+--------+ | 43 | Full name | Network | O | TLV | 3-n | | | for network | name | | | | | | | | | | | | | | 9.11.3.35 | | | | +-----+-------------+-------------+----------+--------+--------+ | 45 | Short name | Network | O | TLV | 3-n | | | for network | name | | | | | | | | | | | | | | 9.11.3.35 | | | | +-----+-------------+-------------+----------+--------+--------+ | 46 | Local time | Time zone | O | TV | 2 | | | zone | | | | | | | | 9.11.3.52 | | | | +-----+-------------+-------------+----------+--------+--------+ | 47 | Universal | Time zone | O | TV | 8 | | | time and | and time | | | | | | local time | | | | | | | zone | 9.11.3.53 | | | | +-----+-------------+-------------+----------+--------+--------+ | 49 | Network | Daylight | O | TLV | 3 | | | daylight | saving time | | | | | | saving time | | | | | | | | 9.11.3.19 | | | | +-----+-------------+-------------+----------+--------+--------+ | 79 | LADN | LADN | O | TLV-E | 3-1715 | | | information | information | | | | | | | | | | | | | | 9.11.3.30 | | | | +-----+-------------+-------------+----------+--------+--------+ | B- | MICO | MICO | O | TV | 1 | | | indication | indication | | | | | | | | | | | | | | 9.11.3.31 | | | | +-----+-------------+-------------+----------+--------+--------+ | 9- | Network | Network | O | TV | 1 | | | slicing | slicing | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.36 | | | | +-----+-------------+-------------+----------+--------+--------+ | 31 | Configured | NSSAI | O | TLV | 4-146 | | | NSSAI | | | | | | | | 9.11.3.37 | | | | +-----+-------------+-------------+----------+--------+--------+ | 11 | Rejected | Rejected | O | TLV | 4-42 | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.46 | | | | +-----+-------------+-------------+----------+--------+--------+ | 76 | Opera | Opera | O | TLV-E | 3-8323 | | | tor-defined | tor-defined | | | | | | access | access | | | | | | category | category | | | | | | definitions | definitions | | | | | | | | | | | | | | 9.11.3.38 | | | | +-----+-------------+-------------+----------+--------+--------+ | F- | SMS | SMS | O | TV | 1 | | | indication | indication | | | | | | | | | | | | | | 9.11.3.50A | | | | +-----+-------------+-------------+----------+--------+--------+ | 6C | T3447 value | GPRS timer | O | TLV | 3 | | | | 3 | | | | | | | | | | | | | | 9.11.2.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 75 | CAG | CAG | O | TLV-E | 3-n | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.18A | | | | +-----+-------------+-------------+----------+--------+--------+ | 67 | UE radio | UE radio | O | TLV | 3-n | | | capability | capability | | | | | | ID | ID | | | | | | | | | | | | | | 9.11.3.68 | | | | +-----+-------------+-------------+----------+--------+--------+ | A- | UE radio | UE radio | O | TV | 1 | | | capability | capability | | | | | | ID deletion | ID deletion | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.69 | | | | +-----+-------------+-------------+----------+--------+--------+ | 44 | 5GS | 5GS | O | TLV | 3 | | | r | r | | | | | | egistration | egistration | | | | | | result | result | | | | | | | | | | | | | | 9.11.3.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | 1B | Truncated | Truncated | O | TLV | 3 | | | 5G-S-TMSI | 5G-S-TMSI | | | | | | co | co | | | | | | nfiguration | nfiguration | | | | | | | | | | | | | | 9.11.3.70 | | | | +-----+-------------+-------------+----------+--------+--------+ | C- | Additional | Additional | O | TV | 1 | | | co | co | | | | | | nfiguration | nfiguration | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.74 | | | | +-----+-------------+-------------+----------+--------+--------+ | 68 | Extended | Extended | O | TLV | 5-90 | | | rejected | rejected | | | | | | NSSAI | NSSAI | | | | | | | | | | | | | | 9.11.3.75 | | | | +-----+-------------+-------------+----------+--------+--------+ | 72 | Servi | Servi | O | TLV-E | 6-n | | | ce-level-AA | ce-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+-------------+-------------+----------+--------+--------+ | 70 | NSSRG | NSSRG | O | TLV-E | 7-4099 | | | information | information | | | | | | | | | | | | | | 9.11.3.82 | | | | +-----+-------------+-------------+----------+--------+--------+ | 14 | Disaster | R | O | TLV | 4 | | | roaming | egistration | | | | | | wait range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+-------------+-------------+----------+--------+--------+ | 2C | Disaster | R | O | TLV | 4 | | | return wait | egistration | | | | | | range | wait range | | | | | | | | | | | | | | 9.11.3.84 | | | | +-----+-------------+-------------+----------+--------+--------+ | 13 | List of | List of | O | TLV | 2-n | | | PLMNs to be | PLMNs to be | | | | | | used in | used in | | | | | | disaster | disaster | | | | | | condition | condition | | | | | | | | | | | | | | 9.11.3.83 | | | | +-----+-------------+-------------+----------+--------+--------+ | 71 | Extended | Extended | O | TLV-E | 3-n | | | CAG | CAG | | | | | | information | information | | | | | | list | list | | | | | | | | | | | | | | 9.11.3.86 | | | | +-----+-------------+-------------+----------+--------+--------+ | 1F | Updated | PEIPS | O | TLV | 3-n | | | PEIPS | assistance | | | | | | assistance | information | | | | | | information | | | | | | | | 9.11.3.80 | | | | +-----+-------------+-------------+----------+--------+--------+ | 73 | NSAG | NSAG | O | TLV-E | 9-3143 | | | information | information | | | | | | | | | | | | | | 9.11.3.87 | | | | +-----+-------------+-------------+----------+--------+--------+ | E- | Priority | Priority | O | TV | 1 | | | indicator | indicator | | | | | | | | | | | | | | 9.11.3.91 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.19.2 Configuration update indication
The AMF shall include this IE if the AMF needs to request an acknowledgement
or a registration procedure from the UE.
#### 8.2.19.3 5G-GUTI
This IE may be included to assign a new 5G GUTI to the UE.
#### 8.2.19.4 TAI list
This IE may be included to assign a new TAI list to the UE.
#### 8.2.19.5 Allowed NSSAI
This IE may be included to assign a new allowed NSSAI to the UE not registered
for onboarding services in SNPN.
#### 8.2.19.6 Service area list
This IE may be included to assign a new service area list to the UE.
#### 8.2.19.7 Full name for network
This IE may be included to assign a new full name for network to the UE.
#### 8.2.19.8 Short name for network
This IE may be included to assign a new short name for network to the UE.
#### 8.2.19.9 Local time zone
This IE may be included to assign a new local time zone to the UE.
#### 8.2.19.10 Universal time and local time zone
This IE may be included to assign new universal time and local time zone to
the UE.
#### 8.2.19.11 Network daylight saving time
This IE may be included to assign new network daylight saving time to the UE.
#### 8.2.19.12 LADN information
This IE may be included to assign new LADN information to the UE or delete the
LADN information at the UE side.
#### 8.2.19.13 MICO indication
This IE may be included to request the UE to re-negotiate MICO mode.
#### 8.2.19.14 Network slicing indication
This IE shall be included if the user\'s network slicing subscription has
changed in the UDM of a PLMN or an SNPN.
#### 8.2.19.15 Configured NSSAI
The AMF shall include this IE when the AMF needs to provide the UE with a new
configured NSSAI for the current PLMN or SNPN and the UE is neither
registering nor registered for onboarding services in SNPN.
#### 8.2.19.16 Rejected NSSAI
The network may include this IE to inform the UE of one or more S-NSSAIs that
were previously sent to the UE in the allowed NSSAI or the pending NSSAI, but
are now considered rejected by the network.
#### 8.2.19.17 Operator-defined access category definitions
This IE may be included to assign new operator-defined access category
definitions to the UE or delete the operator-defined access category
definitions at the UE side.
#### 8.2.19.18 SMS indication
This IE may be included to indicate that the ability for the UE to use SMS
over NAS has changed.
#### 8.2.19.19 T3447 value
This IE may be included to assign a new T3447 value to the UE.
#### 8.2.19.20 CAG information list
This IE may be included to assign new \"CAG information list\" to the UE or
delete the \"CAG information list\" at the UE side.
#### 8.2.19.21 UE radio capability ID
This IE may be included if the UE is not in NB-N1 mode, both the UE and the
network support RACS and the network needs to assign a network-assigned UE
radio capability ID to the UE.
#### 8.2.19.22 UE radio capability ID deletion indication
This IE may be included if the UE is not in NB-N1 mode, both the UE and the
network support RACS and the network needs to trigger the UE to delete all
network-assigned UE radio capability IDs stored at the UE for the serving PLMN
or serving SNPN.
#### 8.2.19.23 5GS registration result
This IE shall be included if the network wants to indicate to the UE that the
UE is registered for emergency services.
#### 8.2.19.24 Truncated 5G-S-TMSI configuration
This IE may be included to provide a new truncated 5G-S-TMSI configuration to
the UE in NB-N1 mode if the network is configured to provide the truncated
5G-S-TMSI configuration for control plane CIoT 5GS optimizations.
#### 8.2.19.25 Additional configuration indication
The network may include this IE when requesting the UE to register without the
release of the N1 NAS signalling connection.
#### 8.2.19.26 Extended rejected NSSAI
If the UE supports Extended rejected NSSAI, the network may include this IE to
inform the UE of one or more S-NSSAIs that were previously sent to the UE in
the allowed NSSAI or the pending NSSAI, but are now considered rejected by the
network.
#### 8.2.19.27 Service-level-AA container
The network shall include this IE when the AMF receives the Service-level-AA
payload or the UUAA-MM result from the UAS-NF during the UUAA-MM procedure or
the UUAA revocation procedure. The network shall also include this IE if the
AMF receives from the UAS-AF, the CAA-Level UAV ID as part of the UUAA-MM
procedure.
#### 8.2.19.28 NSSRG information
This IE may be included to provide NSSRG information associated with the
configured NSSAI.
#### 8.2.19.29 Disaster roaming wait range
This IE may be included to assign a new disaster roaming wait range to the UE.
#### 8.2.19.30 Disaster return wait range
This IE may be included to assign a new disaster return wait range to the UE.
#### 8.2.19.31 List of PLMNs to be used in disaster condition
This IE may be included by an allowed PLMN to assign a new \"list of PLMN(s)
to be used in disaster condition\" associated with the serving PLMN to the UE.
#### 8.2.19.32 Extended CAG information list
If the UE supports Extended CAG information list, the network may include this
IE to assign a new \"CAG information list\" to the UE or delete the \"CAG
information list\" at the UE side.
#### 8.2.19.33 Updated PEIPS assistance information
The AMF may include this IE if the UE supports NR paging subgrouping, the AMF
supports and accepts the use of PEIPIS assistance information for the UE, the
UE is not registered for emergency services, the UE does not have an active
emergency PDU session, and the network needs to update PEIPS assistance
information for the UE.
#### 8.2.19.34 NSAG information
If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE
of the REGISTRATION REQUEST message and the CONFIGURATION UPDATE COMMAND
message is sent over 3GPP access, the network may include this IE to provide
NSAG information to the UE.
#### 8.2.19.35 Priority indicator
The network shall include this IE when it needs to inform the UE that the use
of access identity 1 is valid or is no longer valid.
### 8.2.20 Configuration update complete
#### 8.2.20.1 Message definition
The CONFIGURATION UPDATE COMPLETE message is sent by the UE to the AMF. See
table 8.2.20.1.1.
Message type: CONFIGURATION UPDATE COMPLETE
Significance: dual
Direction: UE to network
Table 8.2.20.1.1: CONFIGURATION UPDATE COMPLETE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Co | Message | M | V | 1 | | | nfiguration | type | | | | | | update | | | | | | | complete | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.20.2 Void
### 8.2.21 Identity request
#### 8.2.21.1 Message definition
The IDENTITY REQUEST message is sent by the AMF to the UE to request the UE to
provide specified identity. See table 8.2.21.1.1
Message type: IDENTITY REQUEST
Significance: dual
Direction: AMF to UE
Table 8.2.21.1.1: IDENTITY REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Identity | Message | M | V | 1 | | | request | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Identity | 5GS | M | V | 1/2 | | | type | identity | | | | | | | type | | | | | | | | | | | | | | 9.11.3.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.22 Identity response
#### 8.2.22.1 Message definition
The IDENTITY RESPONSE message is sent by the UE to the AMF to provide the
requested identity. See table 8.2.22.1.
Message type: IDENTITY RESPONSE
Significance: dual
Direction: UE to AMF
Table 8.2.22.1.1: IDENTITY RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Identity | Message | M | V | 1 | | | response | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Mobile | 5GS mobile | M | LV-E | 3-n | | | identity | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.23 Notification
#### 8.2.23.1 Message definition
The NOTIFICATION message is sent by the AMF to the UE to notify the UE to
initiate a service request procedure. See table 8.2.23.1.1.
Message type: NOTIFICATION
Significance: dual
Direction: network to UE
Table 8.2.23.1.1: NOTIFICATION message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | N | Message | M | V | 1 | | | otification | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Access type | Access type | M | V | 1/2 | | | | | | | | | | | 9.11.2.1A | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.24 Notification response
#### 8.2.24.1 Message definition
The NOTIFICATION RESPONSE message is sent by the UE to the AMF to notify the
failure to initiate the service request procedure as a response of
notification. See table 8.2.24.1.1.
Message type: NOTIFICATION RESPONSE
Significance: dual
Direction: UE to network
Table 8.2.2341.1: NOTIFICATION RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | N | Message | M | V | 1 | | | otification | type | | | | | | response | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | 50 | PDU session | PDU session | O | TLV | 4-34 | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.24.2 PDU session status
This information element shall be included when the UE needs to indicate over
non-3GPP access the type of the PDU sessions that are associated with the 3GPP
access type that are active within the UE.
### 8.2.25 Security mode command
#### 8.2.25.1 Message definition
The SECURITY MODE COMMAND message is sent by the AMF to the UE to establish
NAS signalling security. See table 8.2.25.1.1.
Message type: SECURITY MODE COMMAND
Significance: dual
Direction: network to UE
Table 8.2.25.1.1: SECURITY MODE COMMAND message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Message | M | V | 1 | | | mode | type | | | | | | command | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | Selected | NAS | M | V | 1 | | | NAS | security | | | | | | security | algorithms | | | | | | algorithms | | | | | | | | 9.11.3.34 | | | | +-----+-------------+-------------+----------+--------+--------+ | | ngKSI | NAS key set | M | V | 1/2 | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Replayed UE | UE security | M | LV | 3-9 | | | security | capability | | | | | | c | | | | | | | apabilities | 9.11.3.54 | | | | +-----+-------------+-------------+----------+--------+--------+ | E- | IMEISV | IMEISV | O | TV | 1 | | | request | request | | | | | | | | | | | | | | 9.11.3.28 | | | | +-----+-------------+-------------+----------+--------+--------+ | 57 | Selected | EPS NAS | O | TV | 2 | | | EPS NAS | security | | | | | | security | algorithms | | | | | | algorithms | | | | | | | | 9.11.3.25 | | | | +-----+-------------+-------------+----------+--------+--------+ | 36 | Additional | Additional | O | TLV | 3 | | | 5G security | 5G security | | | | | | information | information | | | | | | | | | | | | | | 9.11.3.12 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | TLV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 38 | ABBA | ABBA | O | TLV | 4-n | | | | | | | | | | | 9.11.3.10 | | | | +-----+-------------+-------------+----------+--------+--------+ | 19 | Replayed S1 | S1 UE | O | TLV | 4-7 | | | UE security | security | | | | | | c | capability | | | | | | apabilities | | | | | | | | 9.11.3.48A | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.25.2 IMEISV request
The AMF may include this information element to request the UE to send its
IMEISV with the corresponding SECURITY MODE COMPLETE message.
#### 8.2.25.3 Void
#### 8.2.25.4 Selected EPS NAS security algorithms
This IE shall be included if the AMF supports N26 interface, the UE set the S1
mode bit to \"S1 mode supported\" in the 5GMM capability IE of the
REGISTRATION REQUEST message, and the AMF needs to provide the selected EPS
NAS security algorithms to the UE.
#### 8.2.25.5 Additional 5G security information
The network shall include this IE if:
a) the network needs to provide the UE with horizontal derivation parameter;
or
b) the initial NAS message (i.e. REGISTRATION REQUEST or SERVICE REQUEST) does
not successfully pass the integrity check at the AMF (see subclause 5.4.2.2).
#### 8.2.25.6 EAP message
This IE is included when the EAP Success message is sent as part of the EAP
based primary authentication and key agreement procedure, as specified in
subclause 5.4.1.2.
#### 8.2.25.7 ABBA
This IE shall be included if the message contains an EAP message IE with an
EAP-success message.
#### 8.2.25.8 Replayed S1 UE security capabilities
This IE shall be included if the Selected EPS NAS security algorithms
information element is included.
### 8.2.26 Security mode complete
#### 8.2.26.1 Message definition
The SECURITY MODE COMPLETE message is sent by the UE to the AMF in response to
a SECURITY MODE COMMAND message. See table 8.2.26.1.1.
Message type: SECURITY MODE COMPLETE
Significance: dual
Direction: UE to network
Table 8.2.26.1.1: SECURITY MODE COMPLETE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Message | M | V | 1 | | | mode | type | | | | | | complete | | | | | | | message | 9.6 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | 77 | IMEISV | 5GS mobile | O | TLV-E | 12 | | | | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 71 | NAS message | NAS message | O | TLV-E | 4-n | | | container | container | | | | | | | | | | | | | | 9.11.3.33 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | non-IMEISV | 5GS mobile | O | TLV-E | 7-n | | | PEI | identity | | | | | | | | | | | | | | 9.11.3.4 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.26.2 IMEISV
The UE shall include this information element, if the IMEISV was requested
within the corresponding SECURITY MODE COMMAND message.
#### 8.2.26.3 NAS message container
The UE shall include this information element:
a) if during an ongoing registration procedure or service request procedure,
the AMF included the Additional 5G security information with the RINMR bit set
to \"Retransmission of the initial NAS message requested\" in the SECURITY
MODE COMMAND message as described in 3GPP TS 33.501 [24]; or
b) if during an ongoing registration procedure, the UE does not have a valid
5G NAS security context.
#### 8.2.26.4 non-IMEISV PEI
The 5G-RG or the W-AGF acting on behalf of the FN-RG (or on behalf of the N5GC
device) shall include this information element, if the IMEISV was requested
within the corresponding SECURITY MODE COMMAND message, the IMEISV is not
available but MAC address is available.
The UE shall include this information element, if the IMEISV was requested
within the corresponding SECURITY MODE COMMAND message, the IMEISV is not
available but EUI-64 is available.
### 8.2.27 Security mode reject
#### 8.6.27.1 Message definition
The SECURITY MODE REJECT message is sent by the UE to the AMF to indicate that
the corresponding security mode command has been rejected. See table
8.2.27.1.1.
Message type: SECURITY MODE REJECT
Significance: dual
Direction: UE to network
Table 8.2.27.1.1: SECURITY MODE REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Message | M | V | 1 | | | mode reject | type | | | | | | message | | | | | | | identity | 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GMM cause | 5GMM cause | M | V | 1 | | | | | | | | | | | 9.11.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.28 Security protected 5GS NAS message
#### 8.2.28.1 Message definition
This message is sent by the UE or the network to transfer a plain 5GS NAS
message as specified in subclause 8.2 together with the sequence number and
the message authentication code protecting the message. See table 8.2.28.1.1.
Message type: SECURITY PROTECTED 5GS NAS MESSAGE
Significance: dual
Direction: both
Table 8.2.28.1.1: SECURITY PROTECTED 5GS NAS MESSAGE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Message | Message | M | V | 4 | | | aut | aut | | | | | | hentication | hentication | | | | | | code | code | | | | | | | | | | | | | | 9.8 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 9.10 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Plain 5GS | Plain 5GS | M | V | 3-n | | | NAS message | NAS message | | | | | | | | | | | | | | 9.9 | | | | +-----+-------------+-------------+----------+--------+--------+
NOTE: The minimum length of Plain 5GS NAS message IE can be 2 octets if it
includes a Test Mode Control message specified in 3GPP TS 38.509 [31AA].
### 8.2.29 5GMM status
#### 8.2.29.1 Message definition
The 5GMM STATUS message is sent by the UE or by the AMF at any time to report
certain error conditions. See table 8.2.28.1.1.
Message type: 5GMM STATUS
Significance: local
Direction: both
Table 8.2.29.1.1: 5GMM STATUS message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GMM STATUS | Message | M | V | 1 | | | message | type | | | | | | identity | | | | | | | | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GMM cause | 5GMM cause | M | V | 1 | | | | | | | | | | | 9.11.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.30 Control Plane Service request
#### 8.2.30.1 Message definition
The CONTROL PLANE SERVICE REQUEST message is sent by the UE to the AMF when
the UE is using 5GS services with control plane CIoT 5GS optimization. See
table 8.2.30.1.1.
Message type: CONTROL PLANE SERVICE REQUEST
Significance: dual
Direction: UE to network
Table 8.2.30.1.1: CONTROL PLANE SERVICE REQUEST message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +-----+------------+------------+----------+--------+---------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+------------+------------+----------+--------+---------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+------------+------------+----------+--------+---------+ | | Control | Message | M | V | 1 | | | plane | type | | | | | | service | | | | | | | request | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | Control | Control | M | V | 1/2 | | | plane | plane | | | | | | service | service | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.18D | | | | +-----+------------+------------+----------+--------+---------+ | | ngKSI | NAS key | M | V | 1/2 | | | | set | | | | | | | identifier | | | | | | | | | | | | | | 9.11.3.32 | | | | +-----+------------+------------+----------+--------+---------+ | 6F | CIoT small | CIoT small | O | TLV | 4-257 | | | data | data | | | | | | container | container | | | | | | | | | | | | | | 9.11.3.18B | | | | +-----+------------+------------+----------+--------+---------+ | 8- | Payload | Payload | O | TV | 1 | | | container | container | | | | | | type | type | | | | | | | | | | | | | | 9.11.3.40 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Payload | Payload | O | TLV-E | 4-65538 | | | container | container | | | | | | | | | | | | | | 9.11.3.39 | | | | +-----+------------+------------+----------+--------+---------+ | 12 | PDU | PDU | C | TV | 2 | | | session ID | session | | | | | | | identity 2 | | | | | | | | | | | | | | 9.11.3.41 | | | | +-----+------------+------------+----------+--------+---------+ | 50 | PDU | PDU | O | TLV | 4-34 | | | session | session | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.44 | | | | +-----+------------+------------+----------+--------+---------+ | F- | Release | Release | O | TV | 1 | | | assistance | assistance | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.3.46A | | | | +-----+------------+------------+----------+--------+---------+ | 40 | Uplink | Uplink | O | TLV | 4-34 | | | data | data | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.57 | | | | +-----+------------+------------+----------+--------+---------+ | 71 | NAS | NAS | O | TLV-E | 4-n | | | message | message | | | | | | container | container | | | | | | | | | | | | | | 9.11.3.33 | | | | +-----+------------+------------+----------+--------+---------+ | 24 | Additional | Additional | O | TLV | 3-n | | | i | i | | | | | | nformation | nformation | | | | | | | | | | | | | | 9.11.2.1 | | | | +-----+------------+------------+----------+--------+---------+ | 25 | Allowed | Allowed | O | TLV | 4-34 | | | PDU | PDU | | | | | | session | session | | | | | | status | status | | | | | | | | | | | | | | 9.11.3.13 | | | | +-----+------------+------------+----------+--------+---------+ | 29 | UE request | UE request | O | TLV | 3 | | | type | type | | | | | | | | | | | | | | 9.11.3.76 | | | | +-----+------------+------------+----------+--------+---------+ | 28 | Paging | Paging | O | TLV | 3-35 | | | r | r | | | | | | estriction | estriction | | | | | | | | | | | | | | 9.11.3.77 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.2.30.2 CIoT small data container
This IE shall be included if the UE needs to send uplink small user data, SMS
or location services message or uplink SMS that is not more than 254 bytes,
and there is no other optional IE to be sent.
NOTE: When the UE determines to use the CIoT small data container IE to send
uplink data in this message, there is no other optional IEs in this message.
#### 8.2.30.3 Payload container type
This IE shall be included if the UE includes the Payload container IE.
#### 8.2.30.4 Payload container
This IE shall be included if the UE needs to send uplink CIoT user data, SMS
or location services message.
#### 8.2.30.5 PDU session ID
The UE shall include this IE when the Payload container type IE is set to
\"CIoT user data container\".
#### 8.2.30.6 PDU session status
This IE shall be included when the UE needs to indicate the PDU sessions that
are associated with the access type that the message is sent over, that are
active within the UE.
#### 8.2.30.7 Release assistance indication
The UE may include this IE to inform the network whether:
\- no further uplink and no further downlink data transmission is expected; or
\- only a single downlink data transmission (e.g. acknowledgement or response
to uplink data) and no further uplink data transmission subsequent to the
uplink data transmission is expected.
#### 8.2.30.8 Uplink data status
This IE shall be included if the UE has uplink user data pending to be sent
over the user plane.
#### 8.2.30.9 NAS message container
This IE shall be included if the UE is sending a CONTROL PLANE SERVICE REQUEST
message as an initial NAS message and the UE needs to send non-cleartext IEs.
#### 8.2.30.10 Additional information
The UE may include this IE when the Payload container type IE is set to
\"Location services message container\".
#### 8.2.30.11 Allowed PDU session status
This IE shall be included if the CONTROL PLANE SERVICE REQUEST message is sent
as a response to paging or notification via 3GPP access for PDU session(s)
associated with non-3GPP access and the UE needs to indicate the user-plane
resources of PDU session(s) associated with non-3GPP access allowed to be re-
established over 3GPP access or if there is no PDU session(s) for which the UE
allows the user-plane resources to be re-established over 3GPP access.
#### 8.2.30.12 UE request type
The UE shall include this IE if the MUSIM UE requests the release of the NAS
signalling connection or rejects the paging request from the network.
#### 8.2.30.13 Paging restriction
The UE shall include this IE if the Request type is set to \"NAS signalling
connection release\" or to \"Rejection of paging\" in the UE request type IE
and the UE requests the network to restrict paging.
### 8.2.31 Network slice-specific authentication command
#### 8.2.31.1 Message definition
The NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message is sent by the AMF
to the UE for authentication of the upper layers of the UE. See table
8.2.31.1.1.
Message type: NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND
Significance: dual
Direction: network to UE
Table 8.2.31.1.1: NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message
content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | NETWORK | Message | M | V | 1 | | | SLI | type | | | | | | CE-SPECIFIC | | | | | | | AUT | 9.7 | | | | | | HENTICATION | | | | | | | COMMAND | | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | S-NSSAI | S-NSSAI | M | LV | 2-5 | | | | | | | | | | | 9.11.2.8 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EAP message | EAP message | M | LV-E | 6-1502 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.32 Network slice-specific authentication complete
#### 8.2.32.1 Message definition
The NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message is sent by the UE
to the AMF in response to the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND
message and indicates acceptance of the NETWORK SLICE-SPECIFIC AUTHENTICATION
COMMAND message. See table 8.2.32.1.1.
Message type: NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE
Significance: dual
Direction: UE to network
Table 8.2.32.1.1: NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message
content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | NETWORK | Message | M | V | 1 | | | SLI | type | | | | | | CE-SPECIFIC | | | | | | | AUT | 9.7 | | | | | | HENTICATION | | | | | | | COMPLETE | | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | S-NSSAI | S-NSSAI | M | LV | 2-5 | | | | | | | | | | | 9.11.2.8 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EAP message | EAP message | M | LV-E | 6-1502 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.33 Network slice-specific authentication result
#### 8.2.33.1 Message definition
The NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message is sent by the AMF to
the UE for indicating the result of the network slice-specific authentication
and authorization procedure. See table 8.2.33.1.1.
Message type: NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT
Significance: dual
Direction: network to UE
Table 8.2.33.1.1: NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | NETWORK | Message | M | V | 1 | | | SLI | type | | | | | | CE-SPECIFIC | | | | | | | AUT | 9.7 | | | | | | HENTICATION | | | | | | | RESULT | | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | S-NSSAI | S-NSSAI | M | LV | 2-5 | | | | | | | | | | | 9.11.2.8 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EAP message | EAP message | M | LV-E | 6-1502 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.34 Relay key request
#### 8.2.34.1 Message definition
The RELAY KEY REQUEST message is sent by the UE to the AMF for initiation of
PC5 keys establishment with the 5G ProSe remote UE as specified in 3GPP TS
33.503 [56]. See table 8.2.34.1.
Message type: RELAY KEY REQUEST
Significance: dual
Direction: UE to network
Table 8.2.34.1: RELAY KEY REQUEST message content
+-----+-----------+-----------+----------+--------+----------+ | IEI | In | Type/ | Presence | Format | Length | | | formation | Reference | | | | | | Element | | | | | +=====+===========+===========+==========+========+==========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | disc | disc | | | | | | riminator | riminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Spare | Spare | M | V | 1/2 | | | half | half | | | | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Relay key | Message | M | V | 1 | | | request | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-----------+-----------+----------+--------+----------+ | | PRTI | ProSe | M | V | 1 | | | | relay | | | | | | | tr | | | | | | | ansaction | | | | | | | identity | | | | | | | | | | | | | | 9.11.3.88 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Relay key | Relay key | M | LV | 22-65537 | | | request | request | | | | | | p | p | | | | | | arameters | arameters | | | | | | | | | | | | | | 9.11.3.89 | | | | +-----+-----------+-----------+----------+--------+----------+
### 8.2.35 Relay key accept
#### 8.2.35.1 Message definition
The RELAY KEY ACCEPT message is sent by the AMF to the UE as specified in 3GPP
TS 33.503 [56]. See table 8.2.35.1.
Message type: RELAY KEY ACCEPT
Significance: dual
Direction: network to UE
Table 8.2.35.1: RELAY KEY ACCEPT message content
+-----+-----------+-----------+----------+--------+----------+ | IEI | In | Type/ | Presence | Format | Length | | | formation | Reference | | | | | | Element | | | | | +=====+===========+===========+==========+========+==========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | disc | disc | | | | | | riminator | riminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Security | Security | M | V | 1/2 | | | header | header | | | | | | type | type | | | | | | | | | | | | | | 9.3 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Spare | Spare | M | V | 1/2 | | | half | half | | | | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Relay key | Message | M | V | 1 | | | accept | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-----------+-----------+----------+--------+----------+ | | PRTI | ProSe | M | V | 1 | | | | relay | | | | | | | tr | | | | | | | ansaction | | | | | | | identity | | | | | | | | | | | | | | 9.11.3.88 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Relay key | Relay key | M | LV-E | 51-65537 | | | response | response | | | | | | p | p | | | | | | arameters | arameters | | | | | | | | | | | | | | 9.11.3.90 | | | | +-----+-----------+-----------+----------+--------+----------+ | 78 | EAP | EAP | O | TLV-E | 7-1503 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+-----------+-----------+----------+--------+----------+
### 8.2.36 Relay key reject
#### 8.2.36.1 Message definition
The RELAY KEY REJECT message is sent by the AMF to the UE to indicate the
rejection of the relay key request. See table 8.2.36.1.
Message type: RELAY KEY REJECT
Significance: dual
Direction: network to UE
Table 8.2.36.1: RELAY KEY REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Relay key | Message | M | V | 1 | | | reject | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PRTI | ProSe relay | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.11.3.88 | | | | +-----+-------------+-------------+----------+--------+--------+ | 78 | EAP message | EAP message | O | LV-E | 6-1502 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.2.36.2 EAP message
EAP message IE is included if the RELAY KEY REJECT message is used to convey
EAP-failure message.
### 8.2.37 Relay authentication request
#### 8.2.37.1 Message definition
The RELAY AUTHENTICATION REQUEST message is sent by the network to the UE to
initiate authentication of the 5G ProSe remote UE as specified in 3GPP TS
33.503 [56]. See table 8.2.37.1.
Message type: RELAY AUTHENTICATION REQUEST
Significance: dual
Direction: Network to UE
Table 8.2.37.1: RELAY AUTHENTICATION REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Relay | Message | M | V | 1 | | | aut | type | | | | | | hentication | | | | | | | request | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | PRTI | ProSe relay | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.11.3.88 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EAP message | EAP message | M | LV-E | 7-1503 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.2.38 Relay authentication response
#### 8.2.38.1 Message definition
The RELAY AUTHENTICATION RESPONSE message is sent by the UE to the network to
forward the authentication response from the 5G ProSe remote UE as specified
in 3GPP TS 33.503 [56]. See table 8.2.38.1.
Message type: RELAY AUTHENTICATION RESPONSE
Significance: dual
Direction: UE to network
Table 8.2.38.1: RELAY AUTHENTICATION RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Security | Security | M | V | 1/2 | | | header type | header type | | | | | | | | | | | | | | 9.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 9.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Relay | Message | M | V | 1 | | | aut | type | | | | | | hentication | | | | | | | response | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | PRTI | ProSe relay | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.11.3.88 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EAP message | EAP message | M | LV-E | 6-1502 | | | | | | | | | | | 9.11.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
## 8.3 5GS session management messages
### 8.3.1 PDU session establishment request
#### 8.3.1.1 Message definition
The PDU SESSION ESTABLISHMENT REQUEST message is sent by the UE to the SMF to
initiate establishment of a PDU session. See table 8.3.1.1.1.
Message type: PDU SESSION ESTABLISHMENT REQUEST
Significance: dual
Direction: UE to network
Table 8.3.1.1.1: PDU SESSION ESTABLISHMENT REQUEST message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | EST | | | | | | | ABLISHMENT | 9.7 | | | | | | REQUEST | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | Integrity | Integrity | M | V | 2 | | | protection | protection | | | | | | maximum | maximum | | | | | | data rate | data rate | | | | | | | | | | | | | | 9.11.4.7 | | | | +-----+------------+------------+----------+--------+---------+ | 9- | PDU | PDU | O | TV | 1 | | | session | session | | | | | | type | type | | | | | | | | | | | | | | 9.11.4.11 | | | | +-----+------------+------------+----------+--------+---------+ | A- | SSC mode | SSC mode | O | TV | 1 | | | | | | | | | | | 9.11.4.16 | | | | +-----+------------+------------+----------+--------+---------+ | 28 | 5GSM | 5GSM | O | TLV | 3-15 | | | capability | capability | | | | | | | | | | | | | | 9.11.4.1 | | | | +-----+------------+------------+----------+--------+---------+ | 55 | Maximum | Maximum | O | TV | 3 | | | number of | number of | | | | | | supported | supported | | | | | | packet | packet | | | | | | filters | filters | | | | | | | | | | | | | | 9.11.4.9 | | | | +-----+------------+------------+----------+--------+---------+ | B- | Always-on | Always-on | O | TV | 1 | | | PDU | PDU | | | | | | session | session | | | | | | requested | requested | | | | | | | | | | | | | | 9.11.4.4 | | | | +-----+------------+------------+----------+--------+---------+ | 39 | SM PDU DN | SM PDU DN | O | TLV | 3-255 | | | request | request | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.15 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 66 | IP header | IP header | O | TLV | 5-257 | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.24 | | | | +-----+------------+------------+----------+--------+---------+ | 6E | DS-TT | DS-TT | O | TLV | 8 | | | Ethernet | Ethernet | | | | | | port MAC | port MAC | | | | | | address | address | | | | | | | | | | | | | | 9.11.4.25 | | | | +-----+------------+------------+----------+--------+---------+ | 6F | UE-DS-TT | UE-DS-TT | O | TLV | 10 | | | residence | residence | | | | | | time | time | | | | | | | | | | | | | | 9.11.4.26 | | | | +-----+------------+------------+----------+--------+---------+ | 74 | Port | Port | O | TLV-E | 8-65538 | | | management | management | | | | | | i | i | | | | | | nformation | nformation | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.27 | | | | +-----+------------+------------+----------+--------+---------+ | 1F | Ethernet | Ethernet | O | TLV | 3 | | | header | header | | | | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.28 | | | | +-----+------------+------------+----------+--------+---------+ | 29 | Suggested | PDU | O | TLV | 11 | | | interface | address | | | | | | identifier | | | | | | | | 9.11.4.10 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+ | 70 | Requested | Requested | O | TLV-E | 8-65538 | | | MBS | MBS | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.30 | | | | +-----+------------+------------+----------+--------+---------+ | 34 | PDU | PDU | O | TLV | 3 | | | session | session | | | | | | pair ID | pair ID | | | | | | | | | | | | | | 9.11.4.32 | | | | +-----+------------+------------+----------+--------+---------+ | 35 | RSN | RSN | O | TLV | 3 | | | | | | | | | | | 9.11.4.33 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.1.2 PDU session type
This IE shall be included in the message when the UE requests to establish a
new PDU session.
#### 8.3.1.3 SSC mode
This IE is included in the message when the UE requests to establish a new PDU
session with a DN and requests an SSC mode.
#### 8.3.1.4 Maximum number of supported packet filters
This IE shall be included in the message when the selected PDU session type is
\"IPv4\", \"IPv6\", \"IPv4v6\" or \"Ethernet\" and the UE can support more
than 16 packet filters for this PDU session.
#### 8.3.1.5 5GSM capability
This IE is included in the message when the UE requests to establish a new PDU
session or to transfer an existing PDN connection and any of the 5GSM
capabilities supported by the UE is relevant for the PDU session.
#### 8.3.1.6 Void
#### 8.3.1.7 Always-on PDU session requested
The UE shall include this IE if the UE requests to establish a PDU session as
an always-on PDU session.
#### 8.3.1.8 SM PDU DN request container
This IE is included in the message when the UE requests to establish a new PDU
session with a DN and needs to provide information for the PDU session
authentication and authorization by the external DN.
#### 8.3.1.9 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
#### 8.3.1.10 IP header compression configuration
The UE shall include the IP header compression configuration IE if:
\- the PDU session type value of the PDU session type IE is set to \"IPv4\",
\"IPv6\" or \"IPv4v6\";
\- the UE indicates \"Control Plane CIoT 5GS optimization supported\" and \"IP
header compression for control plane CIoT 5GS optimization supported\" in the
5GMM capability IE of the REGISTRATION REQUEST message; and
\- the network indicates \"Control plane CIoT 5GS optimization supported\" and
\"IP header compression for control plane CIoT 5GS optimization supported\" in
the 5GS network support feature IE of the REGISTRATION ACCEPT message.
#### 8.3.1.11 DS-TT Ethernet port MAC address
This IE shall be included in the message if the UE supports transfer of port
management information containers and the UE requests to establish a new PDU
session of \"Ethernet\" PDU session type.
#### 8.3.1.12 UE-DS-TT residence time
This IE shall be included in the message if:
a) the UE supports transfer of port management information containers; and
b) the UE-DS-TT residence time is available at the UE.
#### 8.3.1.13 Port management information container
This IE shall be included in the message if the UE supports transfer of port
management information containers.
#### 8.3.1.14 Ethernet header compression configuration
The UE shall include the Ethernet header compression configuration IE if:
\- the PDU session type value of the PDU session type IE is set to
\"Ethernet\";
\- the UE indicated \"Control Plane CIoT 5GS optimization supported\" and
\"Ethernet header compression for control plane CIoT 5GS optimization
supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and
\- the network indicated \"Control plane CIoT 5GS optimization supported\" and
\"Ethernet header compression for control plane CIoT 5GS optimization
supported\" in the 5GS network support feature IE of the REGISTRATION ACCEPT
message.
#### 8.3.1.15 Suggested interface identifier
This IE may be included by the W-AGF acting on behalf of the FN-RG.
#### 8.3.1.16 Service-level-AA container
This IE shall be included in the message when the UE needs to establish a PDU
session for the UAS services.
#### 8.3.1.17 Requested MBS container
This IE is included in the message when the UE requests to join one or more
multicast MBS sessions that are associated with the PDU session.
#### 8.3.1.18 PDU session pair ID
This IE shall be included in the message when the UE needs to include a PDU
session pair ID.
#### 8.3.1.19 RSN
This IE shall be included in the message when the UE needs to include an RSN.
### 8.3.2 PDU session establishment accept
#### 8.3.2.1 Message definition
The PDU SESSION ESTABLISHMENT ACCEPT message is sent by the SMF to the UE in
response to PDU SESSION ESTABLISHMENT REQUEST message and indicates successful
establishment of a PDU session. See table 8.3.2.1.1.
Message type: PDU SESSION ESTABLISHMENT ACCEPT
Significance: dual
Direction: network to UE
Table 8.3.2.1.1: PDU SESSION ESTABLISHMENT ACCEPT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | EST | | | | | | | ABLISHMENT | 9.7 | | | | | | ACCEPT | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | Selected | PDU | M | V | 1/2 | | | PDU | session | | | | | | session | type | | | | | | type | | | | | | | | 9.11.4.11 | | | | +-----+------------+------------+----------+--------+---------+ | | Selected | SSC mode | M | V | 1/2 | | | SSC mode | | | | | | | | 9.11.4.16 | | | | +-----+------------+------------+----------+--------+---------+ | | Authorized | QoS rules | M | LV-E | 6-65538 | | | QoS rules | | | | | | | | 9.11.4.13 | | | | +-----+------------+------------+----------+--------+---------+ | | Session | Se | M | LV | 7 | | | AMBR | ssion-AMBR | | | | | | | | | | | | | | 9.11.4.14 | | | | +-----+------------+------------+----------+--------+---------+ | 59 | 5GSM cause | 5GSM cause | O | TV | 2 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 29 | PDU | PDU | O | TLV | 7-31 | | | address | address | | | | | | | | | | | | | | 9.11.4.10 | | | | +-----+------------+------------+----------+--------+---------+ | 56 | RQ timer | GPRS timer | O | TV | 2 | | | value | | | | | | | | 9.11.2.3 | | | | +-----+------------+------------+----------+--------+---------+ | 22 | S-NSSAI | S-NSSAI | O | TLV | 3-10 | | | | | | | | | | | 9.11.2.8 | | | | +-----+------------+------------+----------+--------+---------+ | 8- | Always-on | Always-on | O | TV | 1 | | | PDU | PDU | | | | | | session | session | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.4.3 | | | | +-----+------------+------------+----------+--------+---------+ | 75 | Mapped EPS | Mapped EPS | O | TLV-E | 7-65538 | | | bearer | bearer | | | | | | contexts | contexts | | | | | | | | | | | | | | 9.11.4.8 | | | | +-----+------------+------------+----------+--------+---------+ | 78 | EAP | EAP | O | TLV-E | 7-1503 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | 79 | Authorized | QoS flow | O | TLV-E | 6-65538 | | | QoS flow | de | | | | | | de | scriptions | | | | | | scriptions | | | | | | | | 9.11.4.12 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 25 | DNN | DNN | O | TLV | 3-102 | | | | | | | | | | | 9.11.2.1B | | | | +-----+------------+------------+----------+--------+---------+ | 17 | 5GSM | 5GSM | O | TLV | 3-15 | | | network | network | | | | | | feature | feature | | | | | | support | support | | | | | | | | | | | | | | 9.11.4.18 | | | | +-----+------------+------------+----------+--------+---------+ | 18 | Serving | Serving | O | TLV | 4 | | | PLMN rate | PLMN rate | | | | | | control | control | | | | | | | | | | | | | | 9.11.4.20 | | | | +-----+------------+------------+----------+--------+---------+ | 77 | ATSSS | ATSSS | O | TLV-E | 3-65538 | | | container | container | | | | | | | | | | | | | | 9.11.4.22 | | | | +-----+------------+------------+----------+--------+---------+ | C- | Control | Control | O | TV | 1 | | | plane only | plane only | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.4.23 | | | | +-----+------------+------------+----------+--------+---------+ | 66 | IP header | IP header | O | TLV | 5-257 | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.24 | | | | +-----+------------+------------+----------+--------+---------+ | 1F | Ethernet | Ethernet | O | TLV | 3 | | | header | header | | | | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.28 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+ | 71 | Received | Received | O | TLV-E | 9-65538 | | | MBS | MBS | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.31 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.2.2 5GSM cause
This IE is included when the selected PDU session type is different from the
PDU session type requested by the UE.
#### 8.3.2.3 PDU address
This IE is included when the selected PDU session type is \"IPv4\", \"IPv6\"
or \"IPv4v6\".
#### 8.3.2.4 RQ timer value
This IE is included when the network needs to provide the RQ timer value.
#### 8.3.2.5 S-NSSAI
This IE shall be included in the message when the SMF received from the AMF an
S-NSSAI together with the PDU SESSION ESTABLISHMENT REQUEST message, the PDU
session is a non-emergency PDU session and the UE is not registered for
onboarding services in SNPN.
#### 8.3.2.6 Always-on PDU session indication
The network shall include this IE if the network decides to inform the UE
whether the PDU session is established as an always-on PDU session.
#### 8.3.2.7 Mapped EPS bearer contexts
This IE is included when interworking with EPS is supported for the PDU
session.
#### 8.3.2.8 EAP message
This IE is included when the external DN successfully performed authentication
and authorization of the UE using EAP.
#### 8.3.2.9 Authorized QoS flow descriptions
This IE is included when the network needs to provide authorized QoS flow
descriptions.
#### 8.3.2.10 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
#### 8.3.2.11 DNN
The IE shall be included in the message when the PDU session is a non-
emergency PDU session and the UE is not registered for onboarding services in
SNPN.
#### 8.3.2.12 5GSM network feature support
This IE is included when the network needs to indicate support of 5GSM network
features.
#### 8.3.2.13 Void
#### 8.3.2.14 Serving PLMN rate control
This IE shall be included when the network needs to indicate the maximum
uplink control plane user data the UE is allowed to send per 6 minute
interval.
#### 8.3.2.15 ATSSS container
The IE shall be included in the message when the PDU session is an MA PDU
session.
#### 8.3.2.16 Control plane only indication
The network shall include the control plane only indication IE if the network
determines that the associated PDU session is only for control plane CIoT 5GS
optimization.
#### 8.3.2.17 IP header compression configuration
The SMF may include the IP header compression configuration IE if:
\- the network accepts an IP PDU session type;
\- control plane CIoT 5GS optimization is selected; and
\- the UE provided the IP header compression configuration IE in the PDU
SESSION ESTABLISHMENT REQUEST message.
#### 8.3.2.18 Ethernet header compression configuration
The SMF may include the Ethernet header compression configuration IE if:
\- the network accepts an Ethernet PDU session type;
\- control plane CIoT 5GS optimization is selected; and
\- the UE provided the Ethernet header compression configuration IE in the PDU
SESSION ESTABLISHMENT REQUEST message.
#### 8.3.2.19 Service-level-AA container
The SMF shall include the Service-level-AA container IE if the service-level
authentication and authorization procedure is completed successfully by the
external DN.
#### 8.3.2.20 Received MBS container
The network shall include this IE if the UE has requested to join one or more
multicast MBS sessions.
### 8.3.3 PDU session establishment reject
#### 8.3.3.1 Message definition
The PDU SESSION ESTABLISHMENT REJECT message is sent by the SMF to the UE in
response to PDU SESSION ESTABLISHMENT REQUEST message and indicates
unsuccessful establishment of a PDU session. See table 8.3.3.1.1.
Message type: PDU SESSION ESTABLISHMENT REJECT
Significance: dual
Direction: network to UE
Table 8.3.3.1.1: PDU SESSION ESTABLISHMENT REJECT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | EST | | | | | | | ABLISHMENT | 9.7 | | | | | | REJECT | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GSM cause | 5GSM cause | M | V | 1 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 37 | Back-off | GPRS timer | O | TLV | 3 | | | timer | 3 | | | | | | value | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | F- | Allowed | Allowed | O | TV | 1 | | | SSC mode | SSC mode | | | | | | | | | | | | | | 9.11.4.5 | | | | +-----+------------+------------+----------+--------+---------+ | 78 | EAP | EAP | O | TLV-E | 7-1503 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | 61 | 5GSM | 5GSM | O | TLV | 3 | | | congestion | congestion | | | | | | re-attempt | re-attempt | | | | | | indicator | indicator | | | | | | | | | | | | | | 9.11.4.21 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 1D | Re-attempt | Re-attempt | O | TLV | 3 | | | indicator | indicator | | | | | | | | | | | | | | 9.11.4.17 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.3.2 Back-off timer value
The network may include this IE if the 5GSM cause is not #28 \"unknown PDU
session type\", #39 \"reactivation requested\", #46 \"out of LADN service
area\", #50 \"PDU session type IPv4 only allowed\", #51 \"PDU session type
IPv6 only allowed\", #54 \"PDU session does not exist\", #57 \"PDU session
type IPv4v6 only allowed\", #58 \"PDU session type Unstructured only
allowed\", #61 \"PDU session type Ethernet only allowed\", or #68 \"not
supported SSC mode\", to request a minimum time interval before procedure
retry is allowed.
#### 8.3.3.3 Allowed SSC mode
This IE is included when the network rejects the PDU SESSION ESTABLISHMENT
REQUEST with cause #68 \"not supported SSC mode.
#### 8.3.3.4 EAP message
This IE is included when the external DN unsuccessfully performed
authentication and authorization of the UE using EAP.
#### 8.3.3.4A 5GSM congestion re-attempt indicator
The network may include this IE only if it includes the Back-off timer value
IE and the 5GSM cause value is either #67 \"insufficient resources for
specific slice and DNN\" or #69 \"insufficient resources for specific slice\".
#### 8.3.3.5 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
#### 8.3.3.6 Re-attempt indicator
The network may include this IE if the network includes the Back-off timer
value IE and the 5GSM cause value is not #26 \"insufficient resources\", #28
\"unknown PDU session type\", #39 \"reactivation requested\", #46 \"out of
LADN service area\", #54 \"PDU session does not exist\", #67 \"insufficient
resources for specific slice and DNN\", #68 \"not supported SSC mode\", or #69
\"insufficient resources for specific slice\".
#### 8.3.3.7 Service-level-AA container
The network shall include this IE if the service-level authentication and
authorization procedure has completed unsuccessfully and the 5GSM cause is #29
\"user authentication or authorization failed\". The network shall include the
service-level-AA response if provided by the DN in the service-level-AA
container.
### 8.3.4 PDU session authentication command
#### 8.3.4.1 Message definition
The PDU SESSION AUTHENTICATION COMMAND message is sent by the SMF to the UE
for authentication of the UE establishing the PDU session or of the UE
participating in the PDU session. See table 8.3.4.1.1.
Message type: PDU SESSION AUTHENTICATION COMMAND
Significance: dual
Direction: network to UE
Table 8.3.4.1.1: PDU SESSION AUTHENTICATION COMMAND message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | AUTH | | | | | | | ENTICATION | 9.7 | | | | | | COMMAND | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | EAP | EAP | M | LV-E | 6-1502 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.4.2 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
NOTE: How the Extended protocol configuration options IE is used by the
network and the UE during the PDU session authentication and authorization
procedure is not specified in this release of the specification.
#### 8.3.4.3 Void
### 8.3.5 PDU session authentication complete
#### 8.3.5.1 Message definition
The PDU SESSION AUTHENTICATION COMPLETE message is sent by the UE to the SMF
in response to the PDU SESSION AUTHENTICATION COMMAND message and indicates
acceptance of the PDU SESSION AUTHENTICATION COMMAND message. See table
8.3.5.1.1.
Message type: PDU SESSION AUTHENTICATION COMPLETE
Significance: dual
Direction: UE to network
Table 8.3.5.1.1: PDU SESSION AUTHENTICATION COMPLETE message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | AUTH | | | | | | | ENTICATION | 9.7 | | | | | | COMPLETE | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | EAP | EAP | M | LV-E | 6-1502 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.5.2 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
NOTE: How the Extended protocol configuration options IE is used by the
network and the UE during the PDU session authentication and authorization
procedure is not specified in this release of the specification.
#### 8.3.5.3 Void
### 8.3.6 PDU session authentication result
#### 8.3.6.1 Message definition
The PDU SESSION AUTHENTICATION RESULT message is sent by the SMF to the UE for
indication of successful result of authentication of the UE participating in
the PDU session. See table 8.3.6.1.1.
Message type: PDU SESSION AUTHENTICATION RESULT
Significance: dual
Direction: network to UE
Table 8.3.6.1.1: PDU SESSION AUTHENTICATION RESULT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | AUTH | | | | | | | ENTICATION | 9.7 | | | | | | RESULT | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | 78 | EAP | EAP | O | TLV-E | 7-1503 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.6.2 EAP message
This IE shall be included when the external DN performs authentication and
authorization of the UE using EAP and it completes successfully.
#### 8.3.6.3 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
NOTE: How the Extended protocol configuration options IE is used by the
network and the UE during the PDU session authentication and authorization
procedure is not specified in this release of the specification.
### 8.3.7 PDU session modification request
#### 8.3.7.1 Message definition
The PDU SESSION MODIFICATION REQUEST message is sent by the UE to the SMF to
request a modification of a PDU session. See table 8.3.7.1.1.
Message type: PDU SESSION MODIFICATION REQUEST
Significance: dual
Direction: UE to network
Table 8.3.7.1.1: PDU SESSION MODIFICATION REQUEST message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | MO | | | | | | | DIFICATION | 9.7 | | | | | | REQUEST | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | 28 | 5GSM | 5GSM | O | TLV | 3-15 | | | capability | capability | | | | | | | | | | | | | | 9.11.4.1 | | | | +-----+------------+------------+----------+--------+---------+ | 59 | 5GSM cause | 5GSM cause | O | TV | 2 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 55 | Maximum | Maximum | O | TV | 3 | | | number of | number of | | | | | | supported | supported | | | | | | packet | packet | | | | | | filters | filters | | | | | | | | | | | | | | 9.11.4.9 | | | | +-----+------------+------------+----------+--------+---------+ | B- | Always-on | Always-on | O | TV | 1 | | | PDU | PDU | | | | | | session | session | | | | | | requested | requested | | | | | | | | | | | | | | 9.11.4.4 | | | | +-----+------------+------------+----------+--------+---------+ | 13 | Integrity | Integrity | O | TV | 3 | | | protection | protection | | | | | | maximum | maximum | | | | | | data rate | data rate | | | | | | | | | | | | | | 9.11.4.7 | | | | +-----+------------+------------+----------+--------+---------+ | 7A | Requested | QoS rules | O | TLV-E | 7-65538 | | | QoS rules | | | | | | | | 9.11.4.13 | | | | +-----+------------+------------+----------+--------+---------+ | 79 | Requested | QoS flow | O | TLV-E | 6-65538 | | | QoS flow | de | | | | | | de | scriptions | | | | | | scriptions | | | | | | | | 9.11.4.12 | | | | +-----+------------+------------+----------+--------+---------+ | 75 | Mapped EPS | Mapped EPS | O | TLV-E | 7-65538 | | | bearer | bearer | | | | | | contexts | contexts | | | | | | | | | | | | | | 9.11.4.8 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 74 | Port | Port | O | TLV-E | 4-65538 | | | management | management | | | | | | i | i | | | | | | nformation | nformation | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.27 | | | | +-----+------------+------------+----------+--------+---------+ | 66 | IP header | Header | O | TLV | 5-257 | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.24 | | | | +-----+------------+------------+----------+--------+---------+ | 1F | Ethernet | Ethernet | O | TLV | 3 | | | header | header | | | | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.28 | | | | +-----+------------+------------+----------+--------+---------+ | 70 | Requested | Requested | O | TLV-E | 8-65538 | | | MBS | MBS | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.30 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+
NOTE: It is possible for UEs compliant with version 15.2.1 or earlier versions
of this specification to send the Mapped EPS bearer contexts IE with IEI of
value \"7F\" for this message.
#### 8.3.7.2 5GSM capability
This IE is included in the message:
1) for a PDN connection established when in S1 mode, after an inter-system
change from S1 mode to N1 mode, if the UE is a UE operating in single-
registration mode in a network supporting N26 interface, the UE has not
previously successfully performed the UE-requested PDU session modification to
provide this capability, and:
a) if the PDU session is of \"IPv4\", \"IPv6\", \"IPv4v6\" or \"Ethernet\" PDU
session type, and the UE supports reflective QoS; or
b) if the PDU session is of \"IPv6\" or \"IPv4v6\" PDU session type, and the
UE supports multi-homed IPv6 PDU session; or
2) if the UE needs to revoke the previously indicated support of reflective
QoS.
#### 8.3.7.3 5GSM cause
This IE is included in the message to indicate the reason for the deletion of
one or more non-default QoS rules, QoS flow descriptions or mapped EPS bearer
contexts.
#### 8.3.7.4 Maximum number of supported packet filters
This IE shall be included in the message for a PDN connection established when
in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is
a UE operating in single-registration mode in a network supporting N26
interface, the UE has not previously successfully performed the UE-requested
PDU session modification to provide this capability, the PDU session type is
\"IPv4\", \"IPv6\", \"IPv4v6\" or \"Ethernet\", and the UE can support more
than 16 packet filters for this PDU session.
#### 8.3.7.5 Always-on PDU session requested
This IE shall be included in the message for a PDN connection established when
in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is
a UE operating in single-registration mode in a network supporting N26
interface, the UE has not previously successfully performed the UE-requested
PDU session modification to provide this capability, and the UE requests the
PDU session to be an always-on PDU session in the 5GS.
#### 8.3.7.6 Integrity protection maximum data rate
This IE shall be included in the message for a PDN connection established when
in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is
a UE operating in single-registration mode in a network supporting N26
interface, and the UE has not previously successfully performed the UE-
requested PDU session modification to provide this capability.
#### 8.3.7.7 Requested QoS rules
This IE is included in the message when the UE requests a specific QoS
handling.
#### 8.3.7.8 Requested QoS flow descriptions
This IE is included in the message when the UE requests a specific QoS flow
descriptions.
#### 8.3.7.9 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
#### 8.3.7.10 Mapped EPS bearer contexts
This IE is included when the UE requests to delete one or more mapped EPS
bearer contexts.
#### 8.3.7.11 Port management information container
This IE shall be included when the UE needs to convey a port management
information container.
#### 8.3.7.12 IP header compression configuration
This IE is included in the message:
a) if the UE wishes to re-negotiate IP header compression configuration
associated to a PDU session and both the UE and the network supports Control
plane CIoT 5GS optimization and IP header compression; or
b) to negotiate IP header compression configuration associated to a PDU
session after an inter-system change from S1 mode to N1 mode when both the UE
and the network support control plane CIoT 5GS optimization and IP header
compression, and the UE is operating in single-registration mode in the
network supporting N26 interface.
#### 8.3.7.13 Ethernet header compression configuration
This IE is included in the message:
a) if the UE wishes to re-negotiate Ethernet header compression configuration
associated to a PDU session and both the UE and the network support Control
plane CIoT 5GS optimization and Ethernet header compression; or
b) to negotiate Ethernet header compression configuration associated to a PDU
session after an inter-system change from S1 mode to N1 mode.
#### 8.3.7.14 Requested MBS container
This IE is included in the message when the UE requests to join or leave one
or more multicast MBS sessions that are associated with the PDU session.
#### 8.3.7.15 Service-level-AA container
This IE shall be included in the message when the UE needs to modify an
established PDU session for C2 communication.
### 8.3.8 PDU session modification reject
#### 8.3.8.1 Message definition
The PDU SESSION MODIFICATION REJECT message is sent by the SMF to the UE to
indicate rejection of the PDU SESSION MODIFICATION REQUEST. See table
8.3.8.1.1.
Message type: PDU SESSION MODIFICATION REJECT
Significance: dual
Direction: network to UE
Table 8.3.8.1.1: PDU SESSION MODIFICATION REJECT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | MO | | | | | | | DIFICATION | 9.7 | | | | | | REJECT | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GSM cause | 5GSM cause | M | V | 1 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 37 | Back-off | GPRS timer | O | TLV | 3 | | | timer | 3 | | | | | | value | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 61 | 5GSM | 5GSM | O | TLV | 3 | | | congestion | congestion | | | | | | re-attempt | re-attempt | | | | | | indicator | indicator | | | | | | | | | | | | | | 9.11.4.21 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 1D | Re-attempt | Re-attempt | O | TLV | 3 | | | indicator | indicator | | | | | | | | | | | | | | 9.11.4.17 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.8.2 Back-off timer value
The network may include this IE if the 5GSM cause is not #26 \"insufficient
resources\", #37 \"5GS QoS not accepted\", #44 \"Semantic errors in packet
filter(s)\", #45 \"Syntactical error in packet filter(s)\", #46 \"out of LADN
service area\", #59 \"unsupported 5QI value\", #67 \"insufficient resources
for specific slice and DNN\", #69 \"insufficient resources for specific
slice\", #83 \"Semantic error in the QoS operation\", or #84 \"Syntactical
error in the QoS operation\" to request a minimum time interval before
procedure retry is allowed.
#### 8.3.8.2A 5GSM congestion re-attempt indicator
The network may include this IE only if it includes the Back-off timer value
IE and the 5GSM cause value is either #67 \"insufficient resources for
specific slice and DNN\" or #69 \"insufficient resources for specific slice\".
#### 8.3.8.3 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
#### 8.3.8.4 Re-attempt indicator
The network may include this IE only if it includes the Back-off timer value
IE and the 5GSM cause value is not #26 \"insufficient resources\", #37 \"5GS
QoS not accepted\", #44 \"Semantic errors in packet filter(s)\", #45
\"Syntactical error in packet filter(s)\", #46 \"out of LADN service area\",
#59 \"unsupported 5QI value\", #67 \"insufficient resources for specific slice
and DNN\", #69 \"insufficient resources for specific slice\", #83 \"Semantic
error in the QoS operation\", or #84 \"Syntactical error in the QoS
operation\".
### 8.3.9 PDU session modification command
#### 8.3.9.1 Message definition
The PDU SESSION MODIFICATION COMMAND message is sent by the SMF to the UE to
indicate a modification of a PDU session. See table 8.3.9.1.1
Message type: PDU SESSION MODIFICATION COMMAND
Significance: dual
Direction: network to UE
Table 8.3.9.1.1: PDU SESSION MODIFICATION COMMAND message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | MO | | | | | | | DIFICATION | 9.7 | | | | | | COMMAND | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | 59 | 5GSM cause | 5GSM cause | O | TV | 2 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 2A | Session | Se | O | TLV | 8 | | | AMBR | ssion-AMBR | | | | | | | | | | | | | | 9.11.4.14 | | | | +-----+------------+------------+----------+--------+---------+ | 56 | RQ timer | GPRS timer | O | TV | 2 | | | value | | | | | | | | 9.11.2.3 | | | | +-----+------------+------------+----------+--------+---------+ | 8- | Always-on | Always-on | O | TV | 1 | | | PDU | PDU | | | | | | session | session | | | | | | indication | indication | | | | | | | | | | | | | | 9.11.4.3 | | | | +-----+------------+------------+----------+--------+---------+ | 7A | Authorized | QoS rules | O | TLV-E | 7-65538 | | | QoS rules | | | | | | | | 9.11.4.13 | | | | +-----+------------+------------+----------+--------+---------+ | 75 | Mapped EPS | Mapped EPS | O | TLV-E | 7-65538 | | | bearer | bearer | | | | | | contexts | contexts | | | | | | | | | | | | | | 9.11.4.8 | | | | +-----+------------+------------+----------+--------+---------+ | 79 | Authorized | QoS flow | O | TLV-E | 6-65538 | | | QoS flow | de | | | | | | de | scriptions | | | | | | scriptions | | | | | | | | 9.11.4.12 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 77 | ATSSS | ATSSS | O | TLV-E | 3-65538 | | | container | container | | | | | | | | | | | | | | 9.11.4.22 | | | | +-----+------------+------------+----------+--------+---------+ | 66 | IP header | IP header | O | TLV | 5-257 | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.24 | | | | +-----+------------+------------+----------+--------+---------+ | 74 | Port | Port | O | TLV-E | 4-65538 | | | management | management | | | | | | i | i | | | | | | nformation | nformation | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.27 | | | | +-----+------------+------------+----------+--------+---------+ | 1E | Serving | Serving | O | TLV | 4 | | | PLMN rate | PLMN rate | | | | | | control | control | | | | | | | | | | | | | | 9.11.4.20 | | | | +-----+------------+------------+----------+--------+---------+ | 1F | Ethernet | Ethernet | O | TLV | 3 | | | header | header | | | | | | c | c | | | | | | ompression | ompression | | | | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 9.11.4.28 | | | | +-----+------------+------------+----------+--------+---------+ | 71 | Received | Received | O | TLV-E | 9-65538 | | | MBS | MBS | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.31 | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+
NOTE: It is possible for networks compliant with version 15.2.1 or earlier
versions of this specification to send the Mapped EPS bearer contexts IE with
IEI of value \"7F\" for this message.
#### 8.3.9.2 5GSM cause
This IE is included when the network performs the PDU session anchor
relocation for SSC mode 3.
#### 8.3.9.3 Session-AMBR
This IE is included when the session-AMBR of the PDU session is modified.
#### 8.3.9.4 RQ timer value
This IE is included when the network needs to provide the RQ timer value.
#### 8.3.9.5 Always-on PDU session indication
The network shall include this IE if the network decides to inform the UE
whether the PDU session is an always-on PDU session.
#### 8.3.9.6 Authorized QoS rules
This IE is included when the authorized QoS rules of the PDU session are
modified.
#### 8.3.9.7 Mapped EPS bearer contexts
This IE is included when interworking with EPS is supported for the PDU
session and the mapped EPS bearer contexts is modified.
#### 8.3.9.8 Authorized QoS flow descriptions
This IE is included when the authorized QoS flow descriptions of the PDU
session are modified.
#### 8.3.9.9 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
#### 8.3.9.10 Void
#### 8.3.9.11 ATSSS container
The IE is included in the message when the network needs to indicate that the
ATSSS parameters of the MA PDU session are modified.
#### 8.3.9.12 IP header compression configuration
This IE is included in the message if the network wishes to re-negotiate IP
header compression configuration associated to a PDU session and both the UE
and the network support Control plane CIoT 5GS optimization and IP header
compression.
#### 8.3.9.13 Port management information container
This IE shall be included when the network needs to convey a port management
information container.
#### 8.3.9.14 Serving PLMN rate control
This IE shall be included when the network needs to indicate the maximum
uplink control plane user data the UE is allowed to send per 6 minute
interval.
#### 8.3.9.15 Ethernet header compression configuration
This IE is included in the message if the network wishes to re-negotiate
Ethernet header compression configuration associated to a PDU session and both
the UE and the network support Control plane CIoT 5GS optimization and
Ethernet header compression.
#### 8.3.9.16 Received MBS container
The network shall include this IE if:
\- the UE has requested to join or leave one or more multicast MBS sessions;
\- the network wants to remove joined UE from one or more multicast MBS
sessions; or
\- the network wants to update the MBS service area of multicast MBS session
that the UE has joined; or
\- the network wants to update the MBS security information of multicast MBS
session that the UE has joined.
#### 8.3.9.17 Service-level-AA container
The SMF shall include the service-level-AA container IE if the service-level
authentication and authorization procedure for re-authentication purpose is
completed successfully by the external DN.
### 8.3.10 PDU session modification complete
#### 8.3.10.1 Message definition
The PDU SESSION MODIFICATION COMPLETE message is sent by the UE to the SMF in
response to the PDU SESSION MODIFICATION COMMAND message and indicates an
acceptance of the PDU SESSION MODIFICATION COMMAND message. See table
8.3.10.1.1.
Message type: PDU SESSION MODIFICATION COMPLETE
Significance: dual
Direction: UE to network
Table 8.3.10.1.1: PDU SESSION MODIFICATION COMPLETE message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | MO | | | | | | | DIFICATION | 9.7 | | | | | | COMPLETE | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 74 | Port | Port | O | TLV-E | 4-65538 | | | management | management | | | | | | i | i | | | | | | nformation | nformation | | | | | | container | container | | | | | | | | | | | | | | 9.11.4.27 | | | | +-----+------------+------------+----------+--------+---------+
NOTE: It is possible for UEs compliant with version 15.3.0 of this
specification to include the 5GSM cause IE with IEI 59 in the PDU SESSION
MODIFICATION COMPLETE message, and therefore the IEI 59 cannot be used for
other optional IEs other than the 5GSM cause IE for future extensions of the
PDU SESSION MODIFICATION COMPLETE message.
#### 8.3.10.2 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
#### 8.3.10.3 Port management information container
This IE shall be included when the UE needs to convey a port management
information container.
### 8.3.11 PDU session modification command reject
#### 8.3.11.1 Message definition
The PDU SESSION MODIFICATION COMMAND REJECT message is sent by the UE to the
SMF to indicate rejection of the PDU SESSION MODIFICATION COMMAND message. See
table 8.3.11.1.1.
Message type: PDU SESSION MODIFICATION COMMAND REJECT
Significance: dual
Direction: UE to network
Table 8.3.11.1.1: PDU SESSION MODIFICATION COMMAND REJECT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | MO | | | | | | | DIFICATION | 9.7 | | | | | | COMMAND | | | | | | | REJECT | | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GSM cause | 5GSM cause | M | V | 1 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.11.2 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
### 8.3.12 PDU session release request
#### 8.3.12.1 Message definition
The PDU SESSION RELEASE REQUEST message is sent by the UE to the SMF to
request a release of a PDU session. See table 8.3.12.1.1.
Message type: PDU SESSION RELEASE REQUEST
Significance: dual
Direction: UE to network
Table 8.3.12.1.1: PDU SESSION RELEASE REQUEST message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | RELEASE | | | | | | | REQUEST | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | 59 | 5GSM cause | 5GSM cause | O | TV | 2 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.12.2 5GSM cause
This IE is included in the message to indicate the reason for releasing the
PDU session.
#### 8.3.12.3 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
### 8.3.13 PDU session release reject
#### 8.3.13.1 Message definition
The PDU SESSION RELEASE REJECT message is sent by the SMF to the UE to
indicate rejection of request a release of a PDU session. See table
8.3.13.1.1.
Message type: PDU SESSION RELEASE REJECT
Significance: dual
Direction: network to UE
Table 8.3.13.1.1: PDU SESSION RELEASE REJECT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | RELEASE | | | | | | | REJECT | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GSM cause | 5GSM cause | M | V | 1 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.13.2 Extended protocol configuration options
This IE is included in the message when the network needs to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
### 8.3.14 PDU session release command
#### 8.3.14.1 Message definition
The PDU SESSION RELEASE COMMAND message is sent by the SMF to the UE to
indicate a release of a PDU session. See table 8.3.14.1.1.
Message type: PDU SESSION RELEASE COMMAND
Significance: dual
Direction: network to UE
Table 8.3.14.1.1: PDU SESSION RELEASE COMMAND message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | RELEASE | | | | | | | COMMAND | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | 5GSM cause | 5GSM cause | M | V | 1 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 37 | Back-off | GPRS timer | O | TLV | 3 | | | timer | 3 | | | | | | value | | | | | | | | 9.11.2.5 | | | | +-----+------------+------------+----------+--------+---------+ | 78 | EAP | EAP | O | TLV-E | 7-1503 | | | message | message | | | | | | | | | | | | | | 9.11.2.2 | | | | +-----+------------+------------+----------+--------+---------+ | 61 | 5GSM | 5GSM | O | TLV | 3 | | | congestion | congestion | | | | | | re-attempt | re-attempt | | | | | | indicator | indicator | | | | | | | | | | | | | | 9.11.4.21 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | D- | Access | Access | O | TV | 1 | | | type | type | | | | | | | | | | | | | | 9.11.2.1A | | | | +-----+------------+------------+----------+--------+---------+ | 72 | Servic | Servic | O | TLV-E | 6-n | | | e-level-AA | e-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.14.2 Back-off timer value
The network may include this IE to request a minimum time interval before
procedure retry is allowed.
#### 8.3.14.3 EAP message
This IE is included when the external DN performs re-authentication and re-
authorization of the UE using EAP and it completes unsuccessfully.
#### 8.3.14.4 Extended protocol configuration options
This IE is included in the message when the network wants to transmit
(protocol) data (e.g. configuration parameters, error codes or
messages/events) to the UE.
#### 8.3.14.5 5GSM congestion re-attempt indicator
The network may include this IE only if it includes the Back-off timer value
IE and the 5GSM cause value is either #67 \"insufficient resources for
specific slice and DNN\" or #69 \"insufficient resources for specific slice\".
#### 8.3.14.6 Access type
This IE is included in the message when the network releases user-plane
reources of an MA PDU session specifically over either 3GPP access or non-3GPP
access.
#### 8.3.14.7 Service-level-AA container
The SMF shall include the service-level-AA container IE if the service-level
authentication and authorization procedure for re-authentication purpose is
completed unsuccessfully by the external DN.
### 8.3.15 PDU session release complete
#### 8.3.15.1 Message definition
The PDU SESSION RELEASE COMPLETE message is sent by the UE to the SMF in
response to the PDU SESSION RELEASE COMMAND message and indicates an
acceptance of a release of the PDU session. See table 8.3.15.1.1.
Message type: PDU SESSION RELEASE COMPLETE
Significance: dual
Direction: UE to network
Table 8.3.15.1.1: PDU SESSION RELEASE COMPLETE message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +=====+============+============+==========+========+=========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | dis | dis | | | | | | criminator | criminator | | | | | | | | | | | | | | 9.2 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | PDU | M | V | 1 | | | session ID | session | | | | | | | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+------------+------------+----------+--------+---------+ | | PTI | Procedure | M | V | 1 | | | | t | | | | | | | ransaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+------------+------------+----------+--------+---------+ | | PDU | Message | M | V | 1 | | | SESSION | type | | | | | | RELEASE | | | | | | | COMPLETE | 9.7 | | | | | | message | | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | 59 | 5GSM cause | 5GSM cause | O | TV | 2 | | | | | | | | | | | 9.11.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 7B | Extended | Extended | O | TLV-E | 4-65538 | | | protocol | protocol | | | | | | con | con | | | | | | figuration | figuration | | | | | | options | options | | | | | | | | | | | | | | 9.11.4.6 | | | | +-----+------------+------------+----------+--------+---------+
#### 8.3.15.2 5GSM cause
This IE is included in the message when the UE needs to indicate to the
network that an error encountered with a mandatory information element in the
PDU SESSION RELEASE COMMAND message.
#### 8.3.15.3 Extended protocol configuration options
This IE is included in the message when the UE needs to transmit (protocol)
data (e.g. configuration parameters, error codes or messages/events) to the
network.
### 8.3.16 5GSM status
#### 8.3.16.1 Message definition
The 5GSM STATUS message is sent by the SMF or the UE to pass information on
the status of the indicated PDU session and report certain error conditions.
See table 8.3.16.1.1.
Message type: 5GSM STATUS
Significance: dual
Direction: both
Table 8.3.16.1.1: 5GSM STATUS message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PDU session | PDU session | M | V | 1 | | | ID | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GSM STATUS | Message | M | V | 1 | | | message | type | | | | | | identity | | | | | | | | 9.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | | 5GSM cause | 5GSM cause | M | V | 1 | | | | | | | | | | | 9.11.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.3.17 Service-level authentication command
#### 8.3.17.1 Message definition
The SERVICE-LEVEL AUTHENTICATION COMMAND message is sent by the SMF to the UE
for service-level authentication and authorization procedure. See table
8.3.17.1.1.
Message type: SERVICE-LEVEL AUTHENTICATION COMMAND
Significance: dual
Direction: network to UE
Table 8.3.17.1.1: SERVICE-LEVEL AUTHENTICATION COMMAND message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PDU session | PDU session | M | V | 1 | | | ID | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | SE | Message | M | V | 1 | | | RVICE-LEVEL | type | | | | | | AUT | | | | | | | HENTICATION | 9.7 | | | | | | COMMAND | | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | Servi | Servi | M | LV-E | 5-n | | | ce-level-AA | ce-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.3.18 Service-level authentication complete
#### 8.3.18.1 Message definition
The SERVICE-LEVEL AUTHENTICATION COMPLETE message is sent by the UE to the SMF
in response to the SERVICE-LEVEL AUTHENTICATION COMMAND message and indicates
acceptance of the SERVICE-LEVEL AUTHENTICATION COMMAND message. See table
8.3.18.1.1.
Message type: SERVICE-LEVEL AUTHENTICATION COMPLETE
Significance: dual
Direction: UE to network
Table 8.3.18.1.1: SERVICE-LEVEL AUTHENTICATION COMPLETE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PDU session | PDU session | M | V | 1 | | | ID | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | SE | Message | M | V | 1 | | | RVICE-LEVEL | type | | | | | | AUT | | | | | | | HENTICATION | 9.7 | | | | | | COMPLETE | | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | Servi | Servi | M | LV-E | 5-n | | | ce-level-AA | ce-level-AA | | | | | | container | container | | | | | | | | | | | | | | 9.11.2.10 | | | | +-----+-------------+-------------+----------+--------+--------+
### 8.3.19 Remote UE report
#### 8.3.19.1 Message definition
The REMOTE UE REPORT message is sent by the UE to the network to report
connection or disconnection of 5G ProSe remote UE(s). See table 8.3.19.1.
Message type: REMOTE UE REPORT
Significance: dual
Direction: UE to network
Table 8.3.19.1: REMOTE UE REPORT message content
+-----+-----------+-----------+----------+--------+----------+ | IEI | In | Type/ | Presence | Format | Length | | | formation | Reference | | | | | | Element | | | | | +-----+-----------+-----------+----------+--------+----------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | disc | disc | | | | | | riminator | riminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-----------+-----------+----------+--------+----------+ | | PDU | PDU | M | V | 1 | | | session | session | | | | | | ID | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+-----------+-----------+----------+--------+----------+ | | PTI | Procedure | M | V | 1 | | | | tr | | | | | | | ansaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+-----------+-----------+----------+--------+----------+ | | Remote UE | Message | M | V | 1 | | | report | type | | | | | | message | | | | | | | identity | 9.7 | | | | +-----+-----------+-----------+----------+--------+----------+ | 76 | Remote UE | Remote UE | O | TLV-E | 16-65538 | | | context | context | | | | | | connected | list | | | | | | | | | | | | | | 9.11.4.29 | | | | +-----+-----------+-----------+----------+--------+----------+ | 70 | Remote UE | Remote UE | O | TLV-E | 16-65538 | | | context | context | | | | | | dis | list | | | | | | connected | | | | | | | | 9.11.4.29 | | | | +-----+-----------+-----------+----------+--------+----------+
#### 8.3.19.2 Remote UE context connected
This IE is included in the message by the UE acting as a 5G ProSe layer-3 UE-
to-network UE relay to provide the network with newly connected 5G ProSe
remote UE information as specified in 3GPP TS 23.304 [6E].
#### 8.3.19.3 Remote UE context disconnected
This IE is included in the message by the UE acting as a 5G ProSe layer-3 UE-
to-network UE relay to provide the network with disconnected 5G ProSe remote
UE information as specified in 3GPP TS 23.304 [6E].
### 8.3.20 Remote UE report response
#### 8.3.20.1 Message definition
The REMOTE UE REPORT RESPONSE message is sent by the network to the UE to
acknowledge receipt of a remote UE report message. See table 8.3.20.1.
Message type: REMOTE UE REPORT RESPONSE
Significance: dual
Direction: network to UE
Table 8.3.20.1: REMOTE UE REPORT RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | Extended | Extended | M | V | 1 | | | protocol | protocol | | | | | | di | di | | | | | | scriminator | scriminator | | | | | | | | | | | | | | 9.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PDU session | PDU session | M | V | 1 | | | ID | identity | | | | | | | | | | | | | | 9.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Remote UE | Message | M | V | 1 | | | report | type | | | | | | response | | | | | | | message | 9.7 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+
#### 8.3.20.2 Void
#### 8.3.20.3 Void
#### 8.3.20.4 Void
# 9 General message format and information elements coding
## 9.1 Overview
### 9.1.1 NAS message format
Within the protocols defined in the present document, every 5GS NAS message is
a standard L3 message as defined in 3GPP TS 24.007 [11]. This means that the
message consists of the following parts:
1) if the message is a plain 5GS NAS message:
a) extended protocol discriminator;
b) security header type associated with a half spare octet or PDU session
identity;
c) procedure transaction identity;
d) message type;
e) other information elements, as required.
2) if the message is a security protected 5GS NAS message:
a) extended protocol discriminator;
b) security header type associated with a half spare octet;
c) message authentication code;
d) sequence number;
e) plain 5GS NAS message, as defined in item 1
The organization of a plain 5GS NAS message is illustrated in the example
shown in figure 9.1.1.1.
+---------------------+------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+------------+---+---+---+---+---+---+---+ | Extended protocol | octet 1 | | | | | | | | | discriminator | | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+ | Security header | octet 2 | | | | | | | | | type associated | | | | | | | | | | with a spare half | | | | | | | | | | octet; or | | | | | | | | | | | | | | | | | | | | PDU session | | | | | | | | | | identity | | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+ | Procedure | octet 2a* | | | | | | | | | transaction | | | | | | | | | | identity | | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+ | Message type | octet 3 | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+ | | octet 4 | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+ | Other information | | | | | | | | | | elements as | | | | | | | | | | required | | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+ | | octet n | | | | | | | | +---------------------+------------+---+---+---+---+---+---+---+
Figure 9.1.1.1: General message organization example for a plain 5GS NAS
message
The PDU session identity and the procedure transaction identity are only used
in messages with extended protocol discriminator 5GS session management. Octet
2a with the procedure transaction identity shall only be included in these
messages.
The organization of a security protected 5GS NAS message is illustrated in the
example shown in figure 9.1.1.2.
* * *
8 7 6 5 4 3 2 1  
Extended protocol discriminator octet 1  
Security header type associated with a spare half octet octet 2  
octet 3  
Message authentication code
                                                            octet 6
Sequence number octet 7  
octet 8  
Plain 5GS NAS message  
octet n
* * *
Figure 9.1.1.2: General message organization example for a security protected
5GS NAS message
Unless specified otherwise in the message descriptions of clause 8 and annex
D, a particular information element shall not be present more than once in a
given message.
### 9.1.2 Field format and mapping
When a field is contained within a single octet, the lowest numbered bit of
the field represents the least significant bit.
When a field extends over more than one octet, the order of bit values
progressively decreases as the octet number increases. In that part of the
field contained in a given octet, the lowest numbered bit represents the least
significant bit. The most significant bit of the field is represented by the
highest numbered bit of the lowest numbered octet of the field. The least
significant bit of the field is represented by the lowest numbered bit of the
highest numbered octet of the field.
For example, a bit number can be identified as a couple (o, b) where o is the
octet number and b is the relative bit number within the octet. Figure 9.1.2.1
illustrates a field that spans from bit (1, 3) to bit (2, 7). The most
significant bit of the field is mapped on bit (1, 3) and the least significant
bit is mapped on bit (2, 7).
* * *
8 7 6 5 4 3 2 1  
2^4^ 2^3^ 2^2^ 1^st^ octet of field 2^1^ 2^0^ 2^nd^ octet of field
* * *
Figure 9.1.2.1: Field mapping convention
## 9.2 Extended protocol discriminator
Bits 1 to 8 of the first octet of every 5GS NAS message contain the Extended
protocol discriminator (EPD) IE. The EPD and its use are defined in 3GPP TS
24.007 [11]. The extended protocol discriminator in the header (see 3GPP TS
24.007 [11]) of a security protected 5GS NAS message is encoded as \"5GS
mobility management messages\".
## 9.3 Security header type
Bits 1 to 4 of the second octet of every 5GMM message contain the Security
header type IE. This IE includes control information related to the security
protection of a 5GMM message. The total size of the Security header type IE is
4 bits.
The Security header type IE can take the values shown in table 9.3.1.
Table 9.3.1: Security header type
+----------------------------+---+---+---+----------------------------+ | Security header type | | | | | | (octet 1) | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | 2 | 1 | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | Plain 5GS NAS message, not | | | | | | security protected | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | Security protected 5GS NAS | | | | | | message: | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | Integrity protected | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | Integrity protected and | | | | | | ciphered | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | Integrity protected with | | | | | | new 5G NAS security | | | | | | context (NOTE 1) | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 0 | Integrity protected and | | | | | | ciphered with new 5G NAS | | | | | | security context (NOTE 2) | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other values are | | | | | | reserved. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NOTE 1: This codepoint may | | | | | | be used only for a | | | | | | SECURITY MODE COMMAND | | | | | | message. | | | | | | | | | | | | NOTE 2: This codepoint may | | | | | | be used only for a | | | | | | SECURITY MODE COMPLETE | | | | | | message. | | | | | +----------------------------+---+---+---+----------------------------+
A 5GMM message received with the security header type encoded as 0000 shall be
treated as not security protected, plain 5GS NAS message. A protocol entity
sending a not security protected 5GMM message shall send the message as plain
5GS NAS message and encode the security header type as 0000.
## 9.4 PDU session identity
Bits 1 to 8 of the second octet of every 5GSM message contain the PDU session
identity IE. The PDU session identity and its use to identify a message flow
are defined in 3GPP TS 24.007 [11].
## 9.5 Spare half octet
This element is used in the description of 5GMM and 5GSM messages when an odd
number of half octet type 1 information elements are used. This element is
filled with spare bits set to zero and is placed in bits 5 to 8 of the octet
unless otherwise specified.
## 9.6 Procedure transaction identity
Bits 1 to 8 of the third octet of every 5GSM message contain the procedure
transaction identity. Bits 1 to 8 of the first octet of every UE policy
delivery message contain the procedure transaction identity. The procedure
transaction identity and its use are defined in 3GPP TS 24.007 [11].
## 9.7 Message type
The Message type IE and its use are defined in 3GPP TS 24.007 [11]. Tables
9.7.1 and 9.7.2 define the value part of the message type IE used in the 5GS
mobility management protocol and 5GS session management protocol.
Table 9.7.1: Message types for 5GS mobility management
Bits
* * *
8 7 6 5 4 3 2 1
0 1 - - - - - - 5GS mobility management messages
0 1 0 0 0 0 0 1 Registration request 0 1 0 0 0 0 1 0 Registration accept 0 1 0
0 0 0 1 1 Registration complete 0 1 0 0 0 1 0 0 Registration reject 0 1 0 0 0
1 0 1 Deregistration request (UE originating) 0 1 0 0 0 1 1 0 Deregistration
accept (UE originating) 0 1 0 0 0 1 1 1 Deregistration request (UE terminated)
0 1 0 0 1 0 0 0 Deregistration accept (UE terminated)
0 1 0 0 1 1 0 0 Service request 0 1 0 0 1 1 0 1 Service reject 0 1 0 0 1 1 1 0
Service accept 0 1 0 0 1 1 1 1 Control plane service request
0 1 0 1 0 0 0 0 Network slice-specific authentication command 0 1 0 1 0 0 0 1
Network slice-specific authentication complete 0 1 0 1 0 0 1 0 Network slice-
specific authentication result 0 1 0 1 0 1 0 0 Configuration update command 0
1 0 1 0 1 0 1 Configuration update complete 0 1 0 1 0 1 1 0 Authentication
request 0 1 0 1 0 1 1 1 Authentication response 0 1 0 1 1 0 0 0 Authentication
reject 0 1 0 1 1 0 0 1 Authentication failure 0 1 0 1 1 0 1 0 Authentication
result 0 1 0 1 1 0 1 1 Identity request 0 1 0 1 1 1 0 0 Identity response 0 1
0 1 1 1 0 1 Security mode command 0 1 0 1 1 1 1 0 Security mode complete 0 1 0
1 1 1 1 1 Security mode reject
0 1 1 0 0 1 0 0 5GMM status 0 1 1 0 0 1 0 1 Notification 0 1 1 0 0 1 1 0
Notification response 0 1 1 0 0 1 1 1 UL NAS transport 0 1 1 0 1 0 0 0 DL NAS
transport
0 1 1 0 1 0 0 1 Relay key request 0 1 1 0 1 0 1 0 Relay key accept 0 1 1 0 1 0
1 1 Relay key reject 0 1 1 0 1 1 0 0 Relay authentication request 0 1 1 0 1 1
0 1 Relay authentication response
Table 9.7.2: Message types for 5GS session management
Bits
* * *
8 7 6 5 4 3 2 1
1 1 - - - - - - 5GS session management messages
1 1 0 0 0 0 0 1 PDU session establishment request 1 1 0 0 0 0 1 0 PDU session
establishment accept 1 1 0 0 0 0 1 1 PDU session establishment reject
1 1 0 0 0 1 0 1 PDU session authentication command 1 1 0 0 0 1 1 0 PDU session
authentication complete 1 1 0 0 0 1 1 1 PDU session authentication result
1 1 0 0 1 0 0 1 PDU session modification request 1 1 0 0 1 0 1 0 PDU session
modification reject 1 1 0 0 1 0 1 1 PDU session modification command 1 1 0 0 1
1 0 0 PDU session modification complete 1 1 0 0 1 1 0 1 PDU session
modification command reject
1 1 0 1 0 0 0 1 PDU session release request 1 1 0 1 0 0 1 0 PDU session
release reject 1 1 0 1 0 0 1 1 PDU session release command 1 1 0 1 0 1 0 0 PDU
session release complete
1 1 0 1 0 1 1 0 5GSM status
1 1 0 1 1 0 0 0 Service-level authentication command 1 1 0 1 1 0 0 1 Service-
level authentication complete
1 1 0 1 1 0 1 0 Remote UE report 1 1 0 1 1 0 1 1 Remote UE report response
## 9.8 Message authentication code
The message authentication code (MAC) information element contains the
integrity protection information for the message. The MAC IE shall be included
in the SECURITY PROTECTED 5GS NAS MESSAGE message if a valid 5G NAS security
context exists and security functions are started.
The message authentication code (MAC) is also included in the Intra N1 mode
NAS transparent container IE and in the S1 mode to N1 mode NAS transparent
container IE.
The usage of MAC is specified in subclause 4.4.3.3.
## 9.9 Plain 5GS NAS message
This IE includes a complete plain 5GS NAS message as specified in subclauses
8.2 and 8.3. The SECURITY PROTECTED 5GS NAS MESSAGE (see subclause 8.2.28)
includes a complete plain 5GS NAS message as specified in subclauses 8.2. The
SECURITY PROTECTED 5GS NAS MESSAGE message (see subclause 8.2.28) is not plain
5GS NAS messages and shall not be included in this IE.
## 9.10 Sequence number
This IE includes the NAS message sequence number (SN) which consists of the
eight least significant bits of the NAS COUNT for a SECURITY PROTECTED 5GS NAS
MESSAGE message.
The NAS message sequence number (SN) with the eight least significant bits of
the NAS COUNT is also included in the Intra N1 mode NAS transparent container
IE and in the N1 mode to S1 mode NAS transparent container IE.
The usage of SN is specified in subclause 4.4.3.
## 9.11 Other information elements
### 9.11.1 General
The different formats (V, LV, T, TV, TLV, LV-E, TLV-E) and the five categories
of information elements (type 1, 2, 3, 4 and 6) are defined in 3GPP TS 24.007
[11].
The first octet of an information element in the non-imperative part contains
the IEI of the information element. If this octet does not correspond to an
IEI known in the message, the receiver shall determine whether this IE is of
type 1 or 2 (i.e. it is an information element of one octet length) or an IE
of type 4 (i.e. that the next octet is the length indicator indicating the
length of the remaining of the information element) (see 3GPP TS 24.007 [11]).
This allows the receiver to jump over unknown information elements and to
analyse any following information elements of a particular message.
The definitions of information elements which are:
a) common for the 5GMM and 5GSM protocols;
b) used by access stratum protocols; or
c) sent to upper layers
are described in subclause 9.11.2.
The information elements of the 5GMM or 5GSM protocols can be defined by
reference to an appropriate specification which provides the definition of the
information element, e.g., \"see subclause 10.5.6.3A in 3GPP TS 24.008 [12]\".
### 9.11.2 Common information elements
#### 9.11.2.1 Additional information
The purpose of the Additional information information element is to provide
additional information to upper layers in relation to the NAS transport
mechanism.
The Additional information information element is coded as shown in figure
9.11.2.1.1 and table 9.11.2.1.1.
The Additional information is a type 4 information element with a minimum
length of 3 octets.
* * *
8 7 6 5 4 3 2 1  
Additional information IEI octet 1  
Additional information length octet 2  
Additional information value octets 3-n
* * *
Figure 9.11.2.1.1: Additional information information element
Table 9.11.2.1.1 : Additional information information element
* * *
Additional information value (octet 3 to octet n) The coding of the additional
information value is dependent on the LCS application.
* * *
#### 9.11.2.1A Access type
The purpose of the access type information element is to indicate the access
type over which the signalling or user data is pending to be sent to the UE.
The access type is a type 1 information element.
The access type information element is coded as shown in figure 9.11.2.1A.1
and table 9.11.2.1A.1.
+-------------+-------+-------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------+-------+-------------+---------+---+---+---+---+---+ | Access type | 0 | Access type | octet 1 | | | | | | | | | | | | | | | | | IEI | spare | | | | | | | | +-------------+-------+-------------+---------+---+---+---+---+---+
Figure 9.11.2.1A.1: Access type information element
Table 9.11.2.1A.1: Access type information element
* * *
Access type value (octet 1, bit 1 to bit 2)
Bits  
2 1  
0 1 3GPP access 1 0 Non-3GPP access
All other values are reserved.
* * *
#### 9.11.2.1B DNN
The purpose of the DNN information element is to identify the data network.
The DNN information element is coded as shown in figure 9.11.2.1B.1.
The DNN is a type 4 information element with a minimum length of 3 octets and
a maximum length of 102 octets.
+------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +========================+=========+===+===+===+===+===+===+===+ | DNN IEI | octet 1 | | | | | | | | +------------------------+---------+---+---+---+---+---+---+---+ | Length of DNN contents | octet 2 | | | | | | | | +------------------------+---------+---+---+---+---+---+---+---+ | DNN value | octet 3 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +------------------------+---------+---+---+---+---+---+---+---+
Figure 9.11.2.1B.1: DNN information element
A DNN value field contains an APN as defined in 3GPP TS 23.003 [4].
#### 9.11.2.2 EAP message
The purpose of the EAP message information element is to transport an EAP
message as specified in IETF RFC 3748 [34].
The EAP message information element is coded as shown in figure 9.11.2.2.1 and
table 9.11.2.2.1.
The EAP message is a type 6 information element with minimum length of 7
octets and maximum length of 1503 octets.
+--------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------+---------+---+---+---+---+---+---+---+ | EAP message IEI | octet 1 | | | | | | | | +--------------------------------+---------+---+---+---+---+---+---+---+ | Length of EAP message contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +--------------------------------+---------+---+---+---+---+---+---+---+ | EAP message | octet 4 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +--------------------------------+---------+---+---+---+---+---+---+---+
Figure 9.11.2.2.1: EAP message information element
Table 9.11.2.2.1: EAP message information element
* * *
EAP message (octet 4 to n) An EAP message as specified in IETF RFC 3748 [34].
* * *
#### 9.11.2.3 GPRS timer
See subclause 10.5.7.3 in 3GPP TS 24.008 [12].
#### 9.11.2.4 GPRS timer 2
See subclause 10.5.7.4 in 3GPP TS 24.008 [12].
#### 9.11.2.5 GPRS timer 3
See subclause 10.5.7.4a in 3GPP TS 24.008 [12].
#### 9.11.2.6 Intra N1 mode NAS transparent container
The purpose of the Intra N1 mode NAS transparent container information element
is to provide the UE with parameters that enable the UE to handle the 5G NAS
security context after N1 mode to N1 mode handover.
The Intra N1 mode NAS transparent container information element is coded as
shown in figure 9.11.2.6.1 and table 9.11.2.6.1.
The Intra N1 mode NAS transparent container is a type 4 information element
with a length of 9 octets.
The value part of the Intra N1 mode NAS transparent container information
element is included in specific information elements within some RRC messages
sent to the UE.
NOTE: For these cases the coding of the information element identifier and
length information of RRC is defined in 3GPP TS 38.331 [30].
+---------+---------+---------+------+-----+---------+---------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+---------+------+-----+---------+---------+---+---+ | Intra | octet 1 | | | | | | | | | N1 mode | | | | | | | | | | NAS | | | | | | | | | | tran | | | | | | | | | | sparent | | | | | | | | | | co | | | | | | | | | | ntainer | | | | | | | | | | IEI | | | | | | | | | +---------+---------+---------+------+-----+---------+---------+---+---+ | Length | octet 2 | | | | | | | | | of | | | | | | | | | | Intra | | | | | | | | | | N1 mode | | | | | | | | | | NAS | | | | | | | | | | tran | | | | | | | | | | sparent | | | | | | | | | | co | | | | | | | | | | ntainer | | | | | | | | | | c | | | | | | | | | | ontents | | | | | | | | | +---------+---------+---------+------+-----+---------+---------+---+---+ | Message | octet 3 | | | | | | | | | authent | | | | | | | | | | ication | octet 6 | | | | | | | | | code | | | | | | | | | +---------+---------+---------+------+-----+---------+---------+---+---+ | Type of | Type of | octet 7 | | | | | | | | ci | in | | | | | | | | | phering | tegrity | | | | | | | | | al | pro | | | | | | | | | gorithm | tection | | | | | | | | | | al | | | | | | | | | | gorithm | | | | | | | | +---------+---------+---------+------+-----+---------+---------+---+---+ | 0 | 0\ | 0 | KACF | TSC | Key set | octet 8 | | | | | Spare | | | | ide | | | | | | | | | | ntifier | | | | | | | | | | in 5G | | | | +---------+---------+---------+------+-----+---------+---------+---+---+ | S | octet 9 | | | | | | | | | equence | | | | | | | | | | number | | | | | | | | | +---------+---------+---------+------+-----+---------+---------+---+---+
Figure 9.11.2.6.1: Intra N1 mode NAS transparent container information element
Table 9.11.2.6.1: Intra N1 mode NAS transparent container information element
* * *
Message authentication code (octet 3 to 6)
This field is coded as the Message authentication code information element
(see subclause 9.8).
Type of integrity protection algorithm (octet 7, bit 1 to 4) and\  
type of ciphering algorithm (octet 7, bit 5 to 8)
These fields are coded as the type of integrity protection algorithm and type
of ciphering algorithm in the NAS security algorithms information element (see
subclause 9.11.3.34).
K_AMF_change_flag (KACF) (octet 8, bit 5)
Bit
5
0 a new K~AMF~ has not been calculated by the network
1 a new K~AMF~ has been calculated by the network
Key set identifier in 5G (octet 8, bit 1 to 3) and\  
Type of security context flag (TSC) (octet 8, bit 4)
These fields are coded as the NAS key set identifier and type of security
context flag in the NAS key set identifier information element (see subclause
9.11.3.32).
Sequence number (octet 9)
This field is coded as the Sequence number information element (see subclause
9.10)
* * *
#### 9.11.2.7 N1 mode to S1 mode NAS transparent container
The purpose of the N1 mode to S1 mode NAS transparent container information
element is to provide the UE with information that enables the UE to create a
mapped EPS security context.
The N1 mode to S1 mode NAS transparent container information element is coded
as shown in figure 9.11.2.7.1 and table 9.11.2.7.1.
The N1 mode to S1 mode NAS transparent container is a type 3 information
element with a length of 2 octets.
The value part of the N1 mode to S1 mode NAS transparent container information
element is included in specific information elements within some RRC messages
sent to the UE; see 3GPP TS 38.331 [30]. For these cases the coding of the
information element identifier and length information is defined in 3GPP TS
38.331 [30].
* * *
8 7 6 5 4 3 2 1  
N1 mode to S1 mode NAS transparent container IEI octet 1  
Sequence number octet 2
* * *
Figure 9.11.2.7.1: N1 mode to S1 mode NAS transparent container information
element
Table 9.11.2.7.1: N1 mode to S1 mode NAS transparent container information
element
* * *
Sequence number (octet 2) This field is coded as the Sequence number
information element (see subclause 9.10).
* * *
#### 9.11.2.8 S-NSSAI
The purpose of the S-NSSAI information element is to identify a network slice.
The S-NSSAI information element is coded as shown in figure 9.11.2.8.1 and
table 9.11.2.8.1.
The S-NSSAI is a type 4 information element with a minimum length of 3 octets
and a maximum length of 10 octets.
+----------------------------+------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +============================+============+===+===+===+===+===+===+===+ | S-NSSAI IEI | octet 1 | | | | | | | | +----------------------------+------------+---+---+---+---+---+---+---+ | Length of S-NSSAI contents | octet 2 | | | | | | | | +----------------------------+------------+---+---+---+---+---+---+---+ | SST | octet 3 | | | | | | | | +----------------------------+------------+---+---+---+---+---+---+---+ | SD | octet 4* | | | | | | | | | | | | | | | | | | | | octet 6* | | | | | | | | +----------------------------+------------+---+---+---+---+---+---+---+ | Mapped HPLMN SST | octet 7* | | | | | | | | +----------------------------+------------+---+---+---+---+---+---+---+ | Mapped HPLMN SD | octet 8* | | | | | | | | | | | | | | | | | | | | octet 10* | | | | | | | | +----------------------------+------------+---+---+---+---+---+---+---+
Figure 9.11.2.8.1: S-NSSAI information element
Table 9.11.2.8.1: S-NSSAI information element
+---------------------+---+---+---+---+---+---+---+---------------------+ | Length of S-NSSAI | | | | | | | | | | contents (octet 2) | | | | | | | | | +=====================+===+===+===+===+===+===+===+=====================+ | | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | This field | | | | | | | | | | indicates the | | | | | | | | | | length of the | | | | | | | | | | included S-NSSAI | | | | | | | | | | contents, and it | | | | | | | | | | can have the | | | | | | | | | | following values. | | | | | | | | | | Depending on the | | | | | | | | | | value of the length | | | | | | | | | | field the following | | | | | | | | | | S-NSSAI contents | | | | | | | | | | are included: | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | Bits | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+---+---+---+---+---+---+---+---------------------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | SST | +---------------------+---+---+---+---+---+---+---+---------------------+ | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | SST and mapped | | | | | | | | | | HPLMN SST | +---------------------+---+---+---+---+---+---+---+---------------------+ | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | SST and SD | +---------------------+---+---+---+---+---+---+---+---------------------+ | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | SST, SD and mapped | | | | | | | | | | HPLMN SST | +---------------------+---+---+---+---+---+---+---+---------------------+ | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | SST, SD, mapped | | | | | | | | | | HPLMN SST and | | | | | | | | | | mapped HPLMN SD | +---------------------+---+---+---+---+---+---+---+---------------------+ | All other values | | | | | | | | | | are reserved. | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | Slice/service type | | | | | | | | | | (SST) (octet 3) | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | This field contains | | | | | | | | | | the 8 bit SST | | | | | | | | | | value. The coding | | | | | | | | | | of the SST value | | | | | | | | | | part is defined in | | | | | | | | | | 3G | | | | | | | | | | PP TS 23.003 [4]. | | | | | | | | | | If this IE is | | | | | | | | | | included during the | | | | | | | | | | network | | | | | | | | | | slice-specific | | | | | | | | | | authentication and | | | | | | | | | | authorization | | | | | | | | | | procedure, this | | | | | | | | | | field contains the | | | | | | | | | | 8 bit SST value of | | | | | | | | | | an S-NSSAI in the | | | | | | | | | | S-NSSAI(s) of the | | | | | | | | | | HPLMN or the RSNPN. | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | Slice | | | | | | | | | | differentiator (SD) | | | | | | | | | | (octet 4 to octet | | | | | | | | | | 6) | | | | | | | | | | | | | | | | | | | | This field contains | | | | | | | | | | the 24 bit SD | | | | | | | | | | value. The coding | | | | | | | | | | of the SD value | | | | | | | | | | part is defined in | | | | | | | | | | 3G | | | | | | | | | | PP TS 23.003 [4]. | | | | | | | | | | If this IE is | | | | | | | | | | included during the | | | | | | | | | | network | | | | | | | | | | slice-specific | | | | | | | | | | authentication and | | | | | | | | | | authorization | | | | | | | | | | procedure, this | | | | | | | | | | field contains the | | | | | | | | | | 24 bit SD value of | | | | | | | | | | an S-NSSAI in the | | | | | | | | | | S-NSSAI(s) of the | | | | | | | | | | HPLMN or the RSNPN. | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | If the SST encoded | | | | | | | | | | in octet 3 is not | | | | | | | | | | associated with a | | | | | | | | | | valid SD value, and | | | | | | | | | | the sender needs to | | | | | | | | | | include a mapped | | | | | | | | | | HPLMN SST (octet 7) | | | | | | | | | | and a mapped HPLMN | | | | | | | | | | SD (octets 8 to | | | | | | | | | | 10), then the | | | | | | | | | | sender shall set | | | | | | | | | | the SD value | | | | | | | | | | (octets 4 to 6) to | | | | | | | | | | \"no SD value | | | | | | | | | | associated with the | | | | | | | | | | SST\". | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | mapped HPLMN | | | | | | | | | | Slice/service type | | | | | | | | | | (SST) (octet 7) | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | This field contains | | | | | | | | | | the 8 bit SST value | | | | | | | | | | of an S-NSSAI in | | | | | | | | | | the S-NSSAI(s) of | | | | | | | | | | the HPLMN to which | | | | | | | | | | the SST value is | | | | | | | | | | mapped. The coding | | | | | | | | | | of the SST value | | | | | | | | | | part is defined in | | | | | | | | | | 3G | | | | | | | | | | PP TS 23.003 [4]. | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | mapped HPLMN Slice | | | | | | | | | | differentiator (SD) | | | | | | | | | | (octet 8 to octet | | | | | | | | | | 10) | | | | | | | | | | | | | | | | | | | | This field contains | | | | | | | | | | the 24 bit SD value | | | | | | | | | | of an S-NSSAI in | | | | | | | | | | the S-NSSAI(s) of | | | | | | | | | | the HPLMN to which | | | | | | | | | | the SD value is | | | | | | | | | | mapped. The coding | | | | | | | | | | of the SD value | | | | | | | | | | part is defined in | | | | | | | | | | 3G | | | | | | | | | | PP TS 23.003 [4]. | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+ | NOTE 1: Octet 3 | | | | | | | | | | shall always be | | | | | | | | | | included. | | | | | | | | | | | | | | | | | | | | NOTE 2: If the | | | | | | | | | | octet 4 is | | | | | | | | | | included, then | | | | | | | | | | octet 5 and octet 6 | | | | | | | | | | shall be included. | | | | | | | | | | | | | | | | | | | | NOTE 3: If the | | | | | | | | | | octet 7 is | | | | | | | | | | included, then | | | | | | | | | | octets 8, 9, and 10 | | | | | | | | | | may be included. | | | | | | | | | | | | | | | | | | | | NOTE 4: If the | | | | | | | | | | octet 8 is | | | | | | | | | | included, then | | | | | | | | | | octet 9 and octet | | | | | | | | | | 10 shall be | | | | | | | | | | included. | | | | | | | | | | | | | | | | | | | | NOTE 5: If only | | | | | | | | | | HPLMN S-NSSAI or | | | | | | | | | | RSNPN S-NSSAI is | | | | | | | | | | included, then | | | | | | | | | | octets 7 to 10 | | | | | | | | | | shall not be | | | | | | | | | | included. | | | | | | | | | +---------------------+---+---+---+---+---+---+---+---------------------+
#### 9.11.2.9 S1 mode to N1 mode NAS transparent container
The purpose of the S1 mode to N1 mode NAS transparent container information
element is to provide the UE with parameters that enable the UE to create a
mapped 5G NAS security context and take this context into use after inter-
system change to N1 mode in 5GMM-CONNECTED mode.
The S1 mode to N1 mode NAS transparent container information element is coded
as shown in figure 9.11.2.9.1 and table 9.11.2.9.1.
The S1 mode to N1 mode NAS transparent container is a type 4 information
element with a length of 10 octets.
The value part of the S1 mode to N1 mode NAS transparent container information
element is included in specific information elements within some RRC messages
sent to the UE.
NOTE: For these cases the coding of the information element identifier and
length information of RRC is defined in 3GPP TS 38.331 [30].
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | S1 | octet | | | | | | | | | mode | 1 | | | | | | | | | to N1 | | | | | | | | | | mode | | | | | | | | | | NAS | | | | | | | | | | t | | | | | | | | | | ransp | | | | | | | | | | arent | | | | | | | | | | cont | | | | | | | | | | ainer | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of S1 | | | | | | | | | | mode | | | | | | | | | | to N1 | | | | | | | | | | mode | | | | | | | | | | NAS | | | | | | | | | | t | | | | | | | | | | ransp | | | | | | | | | | arent | | | | | | | | | | cont | | | | | | | | | | ainer | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Me | octet | | | | | | | | | ssage | 3 | | | | | | | | | auth | | | | | | | | | | entic | octet | | | | | | | | | ation | 6 | | | | | | | | | code | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Type | Type | octet | | | | | | | | of | of | 7 | | | | | | | | ciph | inte | | | | | | | | | ering | grity | | | | | | | | | algo | prote | | | | | | | | | rithm | ction | | | | | | | | | | algo | | | | | | | | | | rithm | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | NCC | TSC | Key | octet | | | | | | | | | set | 8 | | | | | | Spare | | | ident | | | | | | | | | | ifier | | | | | | | | | | in 5G | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 9 | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | | | | | | | | | | octet | | | | | | | | | | 10 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.2.9.1: S1 mode to N1 mode NAS transparent container information
element
Table 9.11.2.9.1: S1 mode to N1 mode NAS transparent container information
element
* * *
Message authentication code (octet 3 to 6)
This field is coded as the Message authentication code information element
(see subclause 9.8).
Type of integrity protection algorithm (octet 7, bit 1 to 4) and\ type of
ciphering algorithm (octet 7, bit 5 to 8)
These fields are coded as the type of integrity protection algorithm and type
of ciphering algorithm in the NAS security algorithms information element (see
subclause 9.11.3.34).
NCC (octet 8, bits 5 to 7)
This field contains the 3 bit Next hop chaining counter (see 3GPP TS 33.501
[24])
Key set identifier in 5G (octet 8, bit 1 to 3) and\ type of security context
flag (TSC) (octet 8, bit 4)
These fields are coded as the NAS key set identifier and type of security
context flag in the NAS key set identifier information element (see subclause
9.11.3.32).
Octets 9 and 10 are spare and shall be coded as zero.
NOTE: In earlier versions of this protocol, octets 9 and 10 can have any
value. In this version of the protocol, octets 9 and 10 can always be ignored
by the UE.
* * *
#### 9.11.2.10 Service-level-AA container
The purpose of the Service-level-AA container information element is to
transfer upper layer information for authentication and authorization between
the UE and the network.
The Service-level-AA container information element is coded as shown in figure
9.11.2.10.1, figure 9.11.2.10.2, figure 9.11.2.10.3, figure 9.11.2.10.4 and
table 9.11.2.10.1.
The Service-level-AA container information element is a type 6 information
element with a minimum length of 6 octets and a maximum length of 65538
octets.
8 7 6 5 4 3 2 1
* * *
Service-level-AA container IEI octet 1  
Length of Service-level-AA container contents octet 2  
octet 3  
octet 4  
Service-level-AA container contents  
octet n
Figure 9.11.2.10.1: Service-level-AA container information element
+------------------------------+---------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==============================+===============+===+===+===+===+===+===+===+ | Service-level-AA parameter 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet x1 | | | | | | | | +------------------------------+---------------+---+---+---+---+---+---+---+ | Service-level-AA parameter 2 | octet x1+1* | | | | | | | | | | | | | | | | | | | | octet x2* | | | | | | | | +------------------------------+---------------+---+---+---+---+---+---+---+ | ...... | ... | | | | | | | | +------------------------------+---------------+---+---+---+---+---+---+---+ | Service-level-AA parameter n | octet xi +1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +------------------------------+---------------+---+---+---+---+---+---+---+
Figure 9.11.2.10.2: Service-level-AA container contents
+--------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +======================================+=============+===+===+===+===+===+===+===+ | Type of service-level-AA parameter | octet xi +1 | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of service-level-AA parameter | octet xi +2 | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Value of service-level-AA parameter | octet xi +3 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.2.10.3: Service-level-AA parameter (when the type of service-
level-AA parameter field contains an IEI of a type 4 information element as
specified in 3GPP TS 24.007 [11])
+--------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +======================================+=============+===+===+===+===+===+===+===+ | Type of service-level-AA parameter | octet xi +1 | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of service-level-AA parameter | octet xi +2 | | | | | | | | | | | | | | | | | | | | octet xi +3 | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Value of service-level-AA parameter | octet xi +4 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.2.10.4: Service-level-AA parameter (when the type of service-
level-AA parameter field contains an IEI of a type 6 information element as
specified in 3GPP TS 24.007 [11])
+-------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +===============================+=============+===+===+===+===+===+===+===+ | Service-level-AA payload type | octet xi +1 | | | | | | | | | | | | | | | | | | | | octet xi +3 | | | | | | | | +-------------------------------+-------------+---+---+---+---+---+---+---+ | Service-level-AA payload | octet xi +4 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +-------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.2.10.5: Service-level-AA parameter (when Service-level-AA payload
type and its associated Service-level-AA payload are included in the Service-
level-AA container contents)
8 7 6 5 4 3 2 1
* * *
Type of service-level-AA parameter Value of service-level-AA parameter octet
xi+1
Figure 9.11.2.10.6: Service-level-AA parameter (when the type of service-
level-AA parameter field contains an IEI of a type 1 information element as
specified in 3GPP TS 24.007 [11])
Table 9.11.2.10.1: Service-level-AA container information element
+----------------------+----------------------+----------------------+ | Service-level-AA | | | | container contents | | | | (octet 4 to octet | | | | n); max value of | | | | 65535 octets | | | +======================+======================+======================+ | | | | +----------------------+----------------------+----------------------+ | The error handlings | | | | for service-level-AA | | | | parameters specified | | | | in subclauses 7.6.1, | | | | 7.6.3 and 7.7.1 | | | | shall apply to the | | | | service-level-AA | | | | parameters included | | | | in the | | | | service-level-AA | | | | container contents. | | | +----------------------+----------------------+----------------------+ | Service-level-AA | | | | parameters | | | | | | | | Type of | | | | service-level-AA | | | | parameter (octet xi | | | | +1) | | | | | | | | This field contains | | | | the IEI of the | | | | service-level-AA | | | | parameter. | | | +----------------------+----------------------+----------------------+ | | | | +----------------------+----------------------+----------------------+ | Length of | | | | service-level-AA | | | | parameter | | | | | | | | This field indicates | | | | binary coded length | | | | of the value of the | | | | service-level-AA | | | | parameter. | | | +----------------------+----------------------+----------------------+ | Value of | | | | service-level-AA | | | | parameter | | | | | | | | This field contains | | | | the value of the | | | | service-level-AA | | | | parameter with the | | | | value part of the | | | | referred information | | | | element based on | | | | following | | | | service-level-AA | | | | parameter reference. | | | | | | | | The receiving entity | | | | shall ignore | | | | service-level-AA | | | | parameter with type | | | | of service-level-AA | | | | parameter field | | | | containing an | | | | unknown IEI. | | | +----------------------+----------------------+----------------------+ | IEI (hexadecimal) | Service-level-AA | Service-level-AA | | | parameter name | parameter reference | +----------------------+----------------------+----------------------+ | 10 | Service-level device | Service-level device | | | ID | ID (see | | | | subclause 9.11.2.11) | +----------------------+----------------------+----------------------+ | 20 | Service-level-AA | Service-level-AA | | | server address | server address (see | | | | subclause 9.11.2.12) | +----------------------+----------------------+----------------------+ | 30 | Service-level-AA | Service-level-AA | | | response | response (see | | | | subclause 9.11.2.14) | +----------------------+----------------------+----------------------+ | 40 | Service-level-AA | Service-level-AA | | | payload type | payload type (see | | | | subclause 9.11.2.15) | | | | (NOTE) | +----------------------+----------------------+----------------------+ | 70 | Service-level-AA | Service-level-AA | | | payload | payload (see | | | | subclause 9.11.2.13) | +----------------------+----------------------+----------------------+ | A- | Service-level-AA | Service-level-AA | | | pending indication | pending indication | | | | (see subclause | | | | 9.11.2.17) | +----------------------+----------------------+----------------------+ | 50 | Service-level-AA | Service-level-AA | | | service status | service status | | | indication | indication (see | | | | subclause 9.11.2.18) | +----------------------+----------------------+----------------------+ | NOTE: A | | | | service-level-AA | | | | payload type is | | | | always followed by | | | | the associated | | | | service-level-AA | | | | payload as shown in | | | | figure 9.11.2.10.5. | | | +----------------------+----------------------+----------------------+
#### 9.11.2.11 Service-level device ID
The purpose of the Service-level device ID information element is to carry the
necessary identity for authentication and authorization by the external DN.
The Service-level device ID information element is coded as shown in figure
9.11.2.11.1 and table 9.11.2.11.1.
The Service-level device ID information element is a type 4 information
element with minimum length of 3 octets and maximum length of 257 octets.
8 7 6 5 4 3 2 1
* * *
Service-level device ID IEI octet 1  
Service-level device ID length octet 2  
Service-level device ID octets 3-y
Figure 9.11.2.11.1: Service-level device ID information element
Table 9.11.2.11.1: Service-level device ID information element
+----------------------------------------------------+ | Service-level device ID (octet 3 to octet y) | | | | A service-level device ID encoded as UTF-8 string. | +----------------------------------------------------+
#### 9.11.2.12 Service-level-AA server address
The purpose of the Service-level-AA server address information element is to
carry the address of the service level authentication and authorization
server.
The Service-level-AA server address information element is coded as shown in
figure 9.11.2.12.1 and table 9.11.2.12.1.
The Service-level-AA server address information element is a type 4
information element with minimum length of 4 octets and maximum length of 258
octets.
8 7 6 5 4 3 2 1
* * *
Service-level-AA server address IEI octet 1  
Service-level-AA server address length octet 2  
Service-level-AA server address type octet 3  
Service-level-AA server address octets 4-z
Figure 9.11.2.12.1: Service-level-AA server address information element
Table 9.11.2.12.1: Service-level-AA server address information element
Service-level-AA server address type (octet 3): Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | IPv4  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | IPv6  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | IPv4v6  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | FQDN  
All other values are spare. If received they shall be ignored. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the service-level-AA server address type indicates IPv4, then the service-level-AA server address field contains an IPv4 address in octet 4 to octet 7. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the service-level-AA server address type indicates IPv6, then the service-level-AA server address field contains an IPv6 address in octet 4 to octet 19. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the service-level-AA server address type indicates IPv4v6, then the service-level-AA server address field contains two IP addresses. The first IP address is an IPv4 address in octet 4 to octet 7. The second IP address is an IPv6 address in octet 8 to octet 23. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the service-level-AA server address type indicates FQDN, octet 4 to octet z is encoded as defined in subclause 19.4.2.1in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
#### 9.11.2.13 Service-level-AA payload
The purpose of the Service-level-AA payload information element is to carry
the upper layer payload for authentication and authorization between the UE
and the service-level-AA server.
The Service-level-AA payload information element is coded as shown in figure
9.11.2.13.1 and table 9.11.2.13.1.
The Service-level-AA payload information element is a type 6 information
element with minimum length of 4 octets and maximum length of 65538 octets.
+---------------------------------+------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=================================+============+===+===+===+===+===+===+===+ | Service-level-AA payload IEI | octet 1 | | | | | | | | +---------------------------------+------------+---+---+---+---+---+---+---+ | Service-level-AA payload length | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +---------------------------------+------------+---+---+---+---+---+---+---+ | Service-level-AA payload | octets 4-s | | | | | | | | +---------------------------------+------------+---+---+---+---+---+---+---+
Figure 9.11.2.13.1: Service-level-AA payload information element
Table 9.11.2.13.1: Service-level-AA payload information element
+----------------------------------------------------------------------+ | Service-level-AA payload (octet 4 to octet s) | | | | A payload for authentication and authorization transparently | | transported and which is provided from/to the upper layers. | +----------------------------------------------------------------------+
#### 9.11.2.14 Service-level-AA response
The purpose of the Service-level-AA response information element is to provide
information regarding the service level authentication and authorization
request, e.g. to indicate that the authentication and authorization request to
the service level authentication server was successful, or to notify that
service level authorization is revoked.
The Service-level-AA response information element is coded as shown in figure
9.11.2.14.1 and table 9.11.2.14.1.
The Service-level-AA response information element is a type 4 information
element with length of 3 octets.
+----------------------------------+---------+------+------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==================================+=========+======+======+=========+===+===+===+===+ | Service-level-AA response IEI | octet 1 | | | | | | | | +----------------------------------+---------+------+------+---------+---+---+---+---+ | Service-level-AA response length | octet 2 | | | | | | | | +----------------------------------+---------+------+------+---------+---+---+---+---+ | 0 | 0 | C2AR | SLAR | octet 3 | | | | | | | | | | | | | | | | Spare | Spare | | | | | | | | +----------------------------------+---------+------+------+---------+---+---+---+---+
Figure 9.11.2.14.1: Service-level-AA response information element
Table 9.11.2.14.1: Service-level-AA response information element
Service-level-AA result field (SLAR) (octet 3, bits 1 and 2)
* * *
Bits  
**1** **2**  
0 0 No information 0 1 Service level authentication and authorization was
successful. 1 0 Service level authentication and authorization was not
successful or service level authorization is revoked. 1 1 Reserved
C2 authorization result field (C2AR) (octet 3, bits 3 and 4)  
Bits  
**3** **4**  
0 0 No information 0 1 C2 authorization was successful. 1 0 C2 authorization
was not successful or C2 authorization is revoked. 1 1 Reserved
Bits 5 to 8 of octet 3 are spare and shall be coded as zero.
#### 9.11.2.15 Service-level-AA payload type
The purpose of the Service-level-AA payload type information element is to
indicates type of payload included in the Service-level-AA payload information
element.
The Service-level-AA payload type information element is coded as shown in
figure 9.11.2.15.1 and table 9.11.2.15.1.
The Service-level-AA payload type information element is a type 4 information
element with length of 3 octets.
8 7 6 5 4 3 2 1
* * *
Service-level-AA payload type IEI octet 1  
Service-level-AA payload type length octet 2  
Service-level-AA payload type octet 3
Figure 9.11.2.15.1: Service-level-AA payload type information element
Table 9.11.2.15.1: Service-level-AA payload type information element
Service-level-AA payload type (octet 3): Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | UUAA payload (see NOTE 1)  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | C2 authorization payload (see NOTE 2)  
All other values are spare, and the receiving entity shall ignore the service-level-AA payload type value set to a spare value. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
NOTE 1: If the service-level-AA payload type indicates UUAA payload, the field for the service-level-AA payload of the Service-level AA payload information element is an application layer payload for UUAA procedure between the UE supporting UAS services and the USS. NOTE 2: If the service-level-AA payload type indicates C2 authorization payload, the field for the service-level-AA payload of the Service-level-AA payload information element is an application layer payload for C2 authorization procedure between the UE supporting UAS services and the USS. |  |  |  |  |  |  |  |  |   
#### 9.11.2.16 Void
#### 9.11.2.17 Service-level-AA pending indication
The purpose of the Service-level-AA pending indication information element is
to provide an indication that the service level authentication and
authorization procedure is to be performed.
The Service-level-AA pending indication information element is coded as shown
in figure 9.11.2.17.1 and table 9.11.2.17.1.
The Service-level-AA pending indication information element is a type 1
information element.
+-----------------------------------------+-------+-------+-------+-------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=========================================+=======+=======+=======+=======+=========+===+===+===+ | Service-level-AA pending indication IEI | 0 | 0 | 0 | SLAPI | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +-----------------------------------------+-------+-------+-------+-------+---------+---+---+---+
Figure 9.11.2.17.1: Service-level-AA pending indication
Table 9.11.2.17.1: Service-level-AA pending indication
Service-level-AA pending indication (SLAPI) (octet 1, bit 1)
* * *
Bit  
1  
0 reserved 1 Service-level-AA procedure is to be performed
#### 9.11.2.18 Service-level-AA service status indication
The purpose of the Service-level-AA service status indication information
element is to provide an indication of the service availability to the UE.
The Service-level-AA service status indication information element is coded as
shown in figure 9.11.2.18.1 and table 9.11.2.18.1.
The Service-level-AA service status indication information element is a type 4
information element with a length of 3 octets.
8 | 7 | 6 | 5 | 4 | 3 |  | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
Service-level-AA service status indication IEI | octet 1 |  |  |  |  |  |  |  |   
Length of Service-level-AA service status indication | octet 2 |  |  |  |  |  |  |  |   
0 Spare | 0 Spare | 0 Spare | 0 Spare | 0 Spare | 0 Spare | 0 Spare | 0 Spare | UAS | octet 3  
Figure 9.11.2.18.1: Service-level-AA-service-status indication information
element
Table 9.11.2.18.1: Service-level-AA-service-status indication information
element
UAS (octet 3, bit 1)
* * *
Bit  
1  
0 UAS services not enabled 1 UAS services enabled
Bits 2 to 8 of octet 3 are spare and shall be encoded as zero.
### 9.11.3 5GS mobility management (5GMM) information elements
#### 9.11.3.1 5GMM capability
The purpose of the 5GMM capability information element is to provide the
network with information concerning aspects of the UE related to the 5GCN or
interworking with the EPS. The contents might affect the manner in which the
network handles the operation of the UE.
The 5GMM capability information element is coded as shown in figure 9.11.3.1.1
and table 9.11.3.1.1.
The 5GMM capability is a type 4 information element with a minimum length of 3
octets and a maximum length of 15 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=======+=======+=======+=======+=======+=======+=======+=======+=======+ | 5GMM | octet | | | | | | | | | capab | 1 | | | | | | | | | ility | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | 5GMM | | | | | | | | | | capab | | | | | | | | | | ility | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | SGC | 5G-IP | N3 | 5G-CP | Restr | LPP | HO | S1 | octet | | | HC-CP | data | CIoT | ictEC | | a | mode | 3 | | | CIoT | | | | | ttach | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | RACS | NSSAA | 5 | V2X | V2X | V2X | 5G-UP | 5G | octet | | | | G-LCS | CNPC5 | CEPC5 | | CIoT | SRVCC | 4* | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5G | 5G | 5G | ER- | 5G-E | multi | WUSA | CAG | octet | | Pro | Pro | Pro | NSSAI | HC-CP | pleUP | | | 5* | | Se-l2 | Se-dc | Se-dd | | CIoT | | | | | | relay | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PR | RPR | PIV | NCR | NR | 5G | 5G | 5G | octet | | | | | | -PSSI | P | P | Pro | 6* | | | | | | | roSe- | roSe- | Se-l3 | | | | | | | | l3rmt | l2rmt | relay | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | MPSIU | UAS | NSAG | E | SS | Ev | MINT | NSSRG | octet | | | | | x-CAG | NPNSI | entNo | | | 7* | | | | | | | tific | | | | | | | | | | ation | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | RCMAN | RCMAP | octet | | | | | | | | | | 8* | | spare | spare | spare | spare | spare | spare | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 9* | | | | | | | | | | -15* | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.1.1: 5GMM capability information element
Table 9.11.3.1.1: 5GMM capability information element
+----------------------------+---+---+---+----------------------------+ | EPC NAS supported (S1 | | | | | | mode) (octet 3, bit 1) | | | | | +============================+===+===+===+============================+ | 0 | | | | S1 mode not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | S1 mode supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | ATTACH REQUEST message | | | | | | containing PDN | | | | | | CONNECTIVITY REQUEST | | | | | | message for handover | | | | | | support (HO attach) (octet | | | | | | 3, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | ATTACH REQUEST message | | | | | | containing PDN | | | | | | CONNECTIVITY REQUEST | | | | | | message with request type | | | | | | set to \"handover\" or | | | | | | \"handover of emergency | | | | | | bearer services\" to | | | | | | transfer PDU session from | | | | | | N1 mode to S1 mode not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | ATTACH REQUEST message | | | | | | containing PDN | | | | | | CONNECTIVITY REQUEST | | | | | | message with request type | | | | | | set to \"handover\" or | | | | | | \"handover of emergency | | | | | | bearer services\" to | | | | | | transfer PDU session from | | | | | | N1 mode to S1 mode | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | LTE Positioning Protocol | | | | | | (LPP) capability (octet 3, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | LPP in N1 mode not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | LPP in N1 mode supported | | | | | | (see | | | | | | 3GPP TS 37.355 [26]) | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Restriction on use of | | | | | | enhanced coverage support | | | | | | (RestrictEC) (octet 3, bit | | | | | | 4) | | | | | | | | | | | | This bit indicates the | | | | | | capability to support | | | | | | restriction on use of | | | | | | enhanced coverage. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Restriction on use of | | | | | | enhanced coverage not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Restriction on use of | | | | | | enhanced coverage | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | Control plane CIoT 5GS | | | | | | optimization (5G-CP CIoT) | | | | | | (octet 3, bit 5) | | | | | | | | | | | | This bit indicates the | | | | | | capability for control | | | | | | plane CIoT 5GS | | | | | | optimization. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Control plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Control plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | N3 data transfer (N3 data) | | | | | | (octet 3, bit 6) | | | | | | | | | | | | This bit indicates the | | | | | | capability for N3 data | | | | | | transfer. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | N3 data transfer supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | N3 data transfer not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | IP header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization (5G-IPHC-CP | | | | | | CIoT) (octet 3, bit 7) | | | | | | | | | | | | This bit indicates the | | | | | | capability for IP header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | IP header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | IP header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Service gap control (SGC) | | | | | | (octet 3, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | service gap control not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | service gap control | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5G-SRVCC from NG-RAN to | | | | | | UTRAN (5GSRVCC) capability | | | | | | (octet 4, bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5G-SRVCC from NG-RAN to | | | | | | UTRAN not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5G-SRVCC from NG-RAN to | | | | | | UTRAN supported (see | | | | | | 3GPP TS 23.216 [6A]) | +----------------------------+---+---+---+----------------------------+ | User plane CIoT 5GS | | | | | | optimization (5G-UP CIoT) | | | | | | (octet 4, bit 2) | | | | | | | | | | | | This bit indicates the | | | | | | capability for user plane | | | | | | CIoT 5GS optimization. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | User plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | User plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | V2X capability (V2X) | | | | | | (octet 4, bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for V2X, as | | | | | | specified in | | | | | | 3GPP TS 24.587 [19B]. | | | | | | | | | | | | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 3 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | V2X not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | V2X supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | V2X communication over | | | | | | E-UTRA-PC5 capability | | | | | | (V2XCEPC5) (octet 4, bit | | | | | | 4) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for V2X | | | | | | communication over | | | | | | E-UTRA-PC5, as specified | | | | | | in 3GPP TS 24.587 [19B]. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | V2X communication over | | | | | | E-UTRA-PC5 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | V2X communication over | | | | | | E-UTRA-PC5 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | V2X communicatio | | | | | | n over NR-PC5 capability ( | | | | | | V2XCNPC5) (octet 4, bit 5) | | | | | | | | | | | | | | | | | | --------- | | | | | | -------------------------- | | | | | | -------------------------- | | | | | | -------------------------- | | | | | | ----------------------- -- | | | | | | -- -- ------------------- | | | | | | -------------------------- | | | | | | This bit indicat | | | | | | es the capability for V2X | | | | | | communication over NR-PC5, | | | | | | as specified in 3GPP TS 2 | | | | | | 4.587 [19B]. | | | | | | Bit | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | 5 | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | 0 | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | V2X communication | | | | | | over NR-PC5 not supported | | | | | | 1 | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | V2X communica | | | | | | tion over NR-PC5 supported | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | +----------------------------+---+---+---+----------------------------+ | Location Services (5G-LCS) | | | | | | notification mechanisms | | | | | | capability (octet 4, bit | | | | | | 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | LCS notification | | | | | | mechanisms not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | LCS notification | | | | | | mechanisms supported (see | | | | | | 3GPP TS 23.273 [6B]) | +----------------------------+---+---+---+----------------------------+ | Network slice-specific | | | | | | authentication and | | | | | | authorization (NSSAA) | | | | | | (octet 4, bit 7) | | | | | | | | | | | | This bit indicates the | | | | | | capability to support | | | | | | network slice-specific | | | | | | authentication and | | | | | | authorization. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Network slice-specific | | | | | | authentication and | | | | | | authorization not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Network slice-specific | | | | | | authentication and | | | | | | authorization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Radio capability | | | | | | signalling optimisation | | | | | | (RACS) capability (octet | | | | | | 4, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | RACS not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | RACS supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Closed Access Group (CAG) | | | | | | capability (octet 5, bit | | | | | | 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 CAG not supported | | | | | | | | | | | | 1 CAG supported | | | | | | | | | | | | WUS assistance (WUSA) | | | | | | information reception | | | | | | capability (octet 5, bit | | | | | | 2) | | | | | | | | | | | | 0 WUS assistance | | | | | | information reception not | | | | | | supported | | | | | | | | | | | | 1 WUS assistance | | | | | | information reception | | | | | | supported | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Multiple user-plane | | | | | | resources support | | | | | | (multipleUP) (octet 5, bit | | | | | | 3) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support | | | | | | multiple user-plane | | | | | | resources in NB-N1 mode. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | | | Multiple user-pla | | | | | | ne resources not supported | | | | | | --- -- | | | | | | -- -- ------------------- | | | | | | -------------------------- | | | | | | | | | | | | 1 Multiple user | | | | | | -plane resources supported | | | | | +----------------------------+---+---+---+----------------------------+ | Ethernet header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization (5G-EHC-CP | | | | | | CIoT) (octet 5, bit 4) | | | | | | | | | | | | 0 Ethernet header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization not supported | | | | | | | | | | | | 1 Ethernet header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization supported | | | | | +----------------------------+---+---+---+----------------------------+ | Extended rejected NSSAI | | | | | | support (ER-NSSAI) (octet | | | | | | 5, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support | | | | | | extended rejected NSSAI. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 Extended re | | | | | | jected NSSAI not supported | | | | | | | | | | | | --- -- -- -- ------------- | | | | | | -------------------------- | | | | | | 1 Extende | | | | | | d rejected NSSAI supported | | | | | +----------------------------+---+---+---+----------------------------+ | 5G ProSe direct discovery | | | | | | (5G ProSe-dd) (octet 5, | | | | | | bit 6) | | | | | | | | | | | | This bit indicates the | | | | | | capability for 5G ProSe | | | | | | direct discovery. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5G ProSe direct discovery | | | | | | not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5G ProSe direct discovery | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 5G ProSe direct | | | | | | communication (5G | | | | | | ProSe-dc) (octet 5, bit 7) | | | | | | | | | | | | This bit indicates the | | | | | | capability for 5G ProSe | | | | | | direct communication. | | | | | | | | | | | | +----------------------+ | | | | | | | 0 5G | | | | | | | | ProSe direct communi | | | | | | | | cation not supported | | | | | | | | --- -- -- -- ----- | | | | | | | | -------------------- | | | | | | | | -------------------- | | | | | | | | 1 | | | | | | | | 5G ProSe direct com | | | | | | | | munication supported | | | | | | | +----------------------+ | | | | | | | | | | | | 5G ProSe layer-2 | | | | | | UE-to-network-relay (5G | | | | | | ProSe-l2relay) (octet 5, | | | | | | bit 8) | | | | | | | | | | | | This bit indicates the | | | | | | capability to act as a 5G | | | | | | ProSe layer-2 | | | | | | UE-to-network relay UE | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Acting as a 5G ProSe | | | | | | layer-2 UE-to-network | | | | | | relay UE not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Acting as a 5G ProSe | | | | | | layer-2 UE-to-network | | | | | | relay UE supported | +----------------------------+---+---+---+----------------------------+ | 5G ProSe layer-3 | | | | | | UE-to-network-relay (5G | | | | | | ProSe-l3relay) (octet 6, | | | | | | bit 1) | | | | | | | | | | | | This bit indicates the | | | | | | capability to act as a 5G | | | | | | ProSe layer-3 | | | | | | UE-to-network relay UE | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Acting as a 5G ProSe | | | | | | layer-3 UE-to-network | | | | | | relay UE not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Acting as a 5G ProSe | | | | | | layer-3 UE-to-network | | | | | | relay UE supported | +----------------------------+---+---+---+----------------------------+ | 5G ProSe layer-2 | | | | | | UE-to-network-remote (5G | | | | | | ProSe-l2rmt) (octet 6, bit | | | | | | 2) | | | | | | | | | | | | This bit indicates the | | | | | | capability to act as a 5G | | | | | | ProSe layer-2 | | | | | | UE-to-network remote UE | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Acting as a 5G ProSe | | | | | | layer-2 UE-to-network | | | | | | remote UE not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Acting as a 5G ProSe | | | | | | layer-2 UE-to-network | | | | | | remote UE supported | +----------------------------+---+---+---+----------------------------+ | 5G ProSe layer-3 | | | | | | UE-to-network-remote (5G | | | | | | ProSe-l3rmt) (octet 6, bit | | | | | | 3) | | | | | | | | | | | | This bit indicates the | | | | | | capability to act as a 5G | | | | | | ProSe layer-3 | | | | | | UE-to-network remote UE | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Acting as a 5G ProSe | | | | | | layer-3 UE-to-network | | | | | | remote UE not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Acting as a 5G ProSe | | | | | | layer-3 UE-to-network | | | | | | remote UE supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NR paging subgroup support | | | | | | indication (NR-PSSI) | | | | | | (octet 6, bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support NR | | | | | | paging subgrouping | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | NR paging subgrouping not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | NR paging subgrouping | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | N1 NAS signalling | | | | | | connection release (NCR) | | | | | | (octet 6, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | N1 NAS signalling | | | | | | connection release is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 5 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | N1 NAS signalling | | | | | | connection release not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | N1 NAS signalling | | | | | | connection release | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Paging indication for | | | | | | voice services (PIV) | | | | | | (octet 6, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | paging indication for | | | | | | voice services is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 6 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | paging indication for | | | | | | voice services not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | paging indication for | | | | | | voice services supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Reject paging request | | | | | | (RPR) (octet 6, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | reject paging request is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 7 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | reject paging request not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | reject paging request | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Paging restriction (PR) | | | | | | (octet 6, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | paging restriction is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 8 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | paging restriction not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | paging restriction | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NSSRG (octet 7, bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support the | | | | | | NSSRG. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | NSSRG not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | NSSRG supported | +----------------------------+---+---+---+----------------------------+ | Minimization of service | | | | | | interruption (MINT) (octet | | | | | | 7, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support | | | | | | Minimization of service | | | | | | interruption (MINT) | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 2 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | MINT not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | MINT supported | +----------------------------+---+---+---+----------------------------+ | Event notification | | | | | | (EventNotification) (octet | | | | | | 7, bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support | | | | | | event notification for | | | | | | upper layers | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 2 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Event notification not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Event notification | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | SOR-SNPN-SI | | | | | | (SSNPNSI) (octet 7, bit 4) | | | | | | ------ | | | | | | -------------------------- | | | | | | -------------------------- | | | | | | This | | | | | | bit indicates the capabil | | | | | | ity to support SOR-SNPN-SI | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 2 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | SOR-SNPN-SI not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | SOR-SNPN-SI supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Extended CAG information | | | | | | list support (Ex-CAG) | | | | | | (octet 7, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support | | | | | | extended CAG information | | | | | | list. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 3 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Extended CAG information | | | | | | list not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Extended CAG information | | | | | | list supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NSAG (octet 7, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support | | | | | | NSAG. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | NSAG not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | NSAG supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | UAS (octet 7, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support UAS | | | | | | services. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | UAS services not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | UAS services supported | +----------------------------+---+---+---+----------------------------+ | MPS indicator update | | | | | | (MPSIU) (octet 7, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability to support MPS | | | | | | indicator update via the | | | | | | UE configuration update | | | | | | procedure. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 8 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | MPS indicator update not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | MPS indicator update | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Registration complete | | | | | | message for acknowledging | | | | | | negotiated PEIPS | | | | | | assistance information | | | | | | (RCMAP) (octet 8, bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for sending | | | | | | REGISTRATION COMPLETE | | | | | | message when Negotiated | | | | | | PEIPS assistance | | | | | | information IE is included | | | | | | in the REGISTRATION ACCEPT | | | | | | message. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 1 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Sending of REGISTRATION | | | | | | COMPLETE message for | | | | | | negotiated PEIPS | | | | | | assistance information not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Sending of REGISTRATION | | | | | | COMPLETE message for | | | | | | negotiated PEIPS | | | | | | assistance information | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Registration complete | | | | | | message for acknowledging | | | | | | NSAG information (RCMAN) | | | | | | (octet 8, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for sending | | | | | | REGISTRATION COMPLETE | | | | | | message when NSAG | | | | | | information IE is included | | | | | | in the REGISTRATION ACCEPT | | | | | | message. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 2 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Sending of REGISTRATION | | | | | | COMPLETE message for NSAG | | | | | | information not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Sending of REGISTRATION | | | | | | COMPLETE message for NSAG | | | | | | information supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Bits in 3 to 8 in octet 8 | | | | | | and bits in octets 9 to 15 | | | | | | are spare and shall be | | | | | | coded as zero, if the | | | | | | respective octet is | | | | | | included in the | | | | | | information element. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.2 5GMM cause
The purpose of the 5GMM cause information element is to indicate the reason
why a 5GMM request from the UE is rejected by the network.
The 5GMM cause information element is coded as shown in figure 9.11.3.2.1 and
table 9.11.3.2.1.
The 5GMM cause is a type 3 information element with 2 octets length.
* * *
8 7 6 5 4 3 2 1  
5GMM cause IEI octet 1  
Cause value octet 2
* * *
Figure 9.11.3.2.1: 5GMM cause information element
Table 9.11.3.2.1: 5GMM cause information element
Cause value (octet 2)
* * *
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 1 1 Illegal UE 0 0 0 0 0 1 0 1 PEI not accepted 0 0 0 0 0 1 1 0
Illegal ME 0 0 0 0 0 1 1 1 5GS services not allowed 0 0 0 0 1 0 0 1 UE
identity cannot be derived by the network 0 0 0 0 1 0 1 0 Implicitly de-
registered 0 0 0 0 1 0 1 1 PLMN not allowed 0 0 0 0 1 1 0 0 Tracking area not
allowed 0 0 0 0 1 1 0 1 Roaming not allowed in this tracking area 0 0 0 0 1 1
1 1 No suitable cells in tracking area 0 0 0 1 0 1 0 0 MAC failure 0 0 0 1 0 1
0 1 Synch failure 0 0 0 1 0 1 1 0 Congestion 0 0 0 1 0 1 1 1 UE security
capabilities mismatch 0 0 0 1 1 0 0 0 Security mode rejected, unspecified 0 0
0 1 1 0 1 0 Non-5G authentication unacceptable 0 0 0 1 1 0 1 1 N1 mode not
allowed 0 0 0 1 1 1 0 0 Restricted service area 0 0 0 1 1 1 1 1 Redirection to
EPC required 0 0 1 0 0 1 0 0 IAB-node operation not authorized 0 0 1 0 1 0 1 1
LADN not available 0 0 1 1 1 1 1 0 No network slices available 0 1 0 0 0 0 0 1
Maximum number of PDU sessions reached 0 1 0 0 0 0 1 1 Insufficient resources
for specific slice and DNN 0 1 0 0 0 1 0 1 Insufficient resources for specific
slice 0 1 0 0 0 1 1 1 ngKSI already in use 0 1 0 0 1 0 0 0 Non-3GPP access to
5GCN not allowed 0 1 0 0 1 0 0 1 Serving network not authorized 0 1 0 0 1 0 1
0 Temporarily not authorized for this SNPN 0 1 0 0 1 0 1 1 Permanently not
authorized for this SNPN 0 1 0 0 1 1 0 0 Not authorized for this CAG or
authorized for CAG cells only 0 1 0 0 1 1 0 1 Wireline access area not allowed
0 1 0 0 1 1 1 0 PLMN not allowed to operate at the present UE location 0 1 0 0
1 1 1 1 UAS services not allowed 0 1 0 1 1 0 1 0 Payload was not forwarded 0 1
0 1 0 0 0 0 Disaster roaming for the determined PLMN with disaster condition
not allowed 0 1 0 1 1 0 1 1 DNN not supported or not subscribed in the slice 0
1 0 1 1 1 0 0 Insufficient user-plane resources for the PDU session 0 1 0 1 1
1 0 1 Onboarding services terminated 0 1 0 1 1 1 1 1 Semantically incorrect
message 0 1 1 0 0 0 0 0 Invalid mandatory information 0 1 1 0 0 0 0 1 Message
type non-existent or not implemented 0 1 1 0 0 0 1 0 Message type not
compatible with the protocol state 0 1 1 0 0 0 1 1 Information element non-
existent or not implemented 0 1 1 0 0 1 0 0 Conditional IE error 0 1 1 0 0 1 0
1 Message not compatible with the protocol state 0 1 1 0 1 1 1 1 Protocol
error, unspecified
Any other value received by the mobile station shall be treated as 0110 1111,
\"protocol error, unspecified\". Any other value received by the network shall
be treated as 0110 1111, \"protocol error, unspecified\".
#### 9.11.3.2A 5GS DRX parameters
The purpose of the 5GS DRX parameters information element is to indicate that
the UE wants to use DRX and for the network to indicate the DRX cycle value to
be used at paging.
The 5GS DRX parameters is a type 4 information element with a length of 3
octets.
The 5GS DRX parameters information element is coded as shown in figure
9.11.3.2A.1 and table 9.11.3.2A.1.
The value part of a DRX parameter information element is coded as shown in
table 9.11.3.2A.1.
* * *
8 7 6 5 4 3 2 1  
5GS DRX parameters IEI octet 1  
Length of 5GS DRX parameters contents octet 2  
0 0 0 0 DRX value  
spare octet 3
* * *
Figure 9.11.3.2A.1: 5GS DRX parameters information element
Table 9.11.3.2A.1: 5GS DRX parameters information element
+----------------------------+---+---+---+----------------------------+ | DRX value (bits 4 to 1 of | | | | | | octet 3) | | | | | | | | | | | | This field represents the | | | | | | DRX cycle parameter \'T\' | | | | | | as defined in | | | | | | 3GPP TS 38.304 [28] or | | | | | | 3GPP TS 36.304 [25C]. | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | 2 | 1 | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | DRX value not specified | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | DRX cycle parameter T = 32 | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | DRX cycle parameter T = 64 | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | DRX cycle parameter T = | | | | | | 128 | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 0 | DRX cycle parameter T = | | | | | | 256 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other values shall be | | | | | | interpreted as \"DRX value | | | | | | not specified\" by this | | | | | | version of the protocol. | | | | | | | | | | | | Bits 5 to 8 of octet 3 are | | | | | | spare and shall be coded | | | | | | as zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.3 5GS identity type
The purpose of the 5GS identity type information element is to specify which
identity is requested.
The 5GS identity type is a type 1 information element.
The 5GS identity type information element is coded as shown in figure
9.11.3.3.1 and table 9.11.3.3.1.
+-------------------+-------+----------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------+-------+----------+---------+---+---+---+---+---+ | 5GS identity type | 0 | Type of | octet 1 | | | | | | | | | | | | | | | | | IEI | spare | identity | | | | | | | +-------------------+-------+----------+---------+---+---+---+---+---+
Figure 9.11.3.3.1: 5GS identity type information element
Table 9.11.3.3.1: 5GS identity type information element
* * *
Type of identity (octet 1)  
Bits  
3 2 1  
0 0 1 SUCI 0 1 0 5G-GUTI 0 1 1 IMEI 1 0 0 5G-S-TMSI 1 0 1 IMEISV 1 1 0 MAC
address 1 1 1 EUI-64
All other values are unused and shall be interpreted as \"SUCI\", if received
by the UE.
* * *
#### 9.11.3.4 5GS mobile identity
The purpose of the 5GS mobile identity information element is to provide
either the SUCI, the 5G-GUTI, the IMEI, the IMEISV, the 5G-S-TMSI, the MAC
address or the EUI-64.
The 5GS mobile identity information element is coded as shown in figures
9.11.3.4.1, 9.11.3.4.2, 9.11.3.4.3, 9.11.3.4.4, 9.11.3.4.5, 9.11.3.4.6,
9.11.3.4.8 and 9.11.3.4.7, and table 9.11.3.4.1.
The 5GS mobile identity is a type 6 information element with a minimum length
of 4.
+---------+---------+---------+---+-------+---------+---------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5GS | octet 1 | | | | | | | | | mobile | | | | | | | | | | i | | | | | | | | | | dentity | | | | | | | | | | IEI | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | Length | octet 2 | | | | | | | | | of 5GS | | | | | | | | | | mobile | octet 3 | | | | | | | | | i | | | | | | | | | | dentity | | | | | | | | | | c | | | | | | | | | | ontents | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 1 | 1 | 1 | 1 | 0 | Type of | octet 4 | | | | | | | | | i | | | | | | | | | spare | dentity | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | MCC | MCC | octet 5 | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | MNC | MCC | octet 6 | | | | | | | | digit 3 | digit 3 | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | MNC | MNC | octet 7 | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | AMF | octet 8 | | | | | | | | | Region | | | | | | | | | | ID | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | AMF Set | octet 9 | | | | | | | | | ID | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | AMF Set | AMF | octet | | | | | | | | ID | Pointer | 10 | | | | | | | | (con | | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet | | | | | | | | | | 11 | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet | | | | | | | | | (con | 12 | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet | | | | | | | | | (con | 13 | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet | | | | | | | | | (con | 14 | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+
Figure 9.11.3.4.1: 5GS mobile identity information element for type of
identity \"5G-GUTI\"
+------------+------------+------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------+------------+------------+---------+---+---+---+---+---+ | 5GS mobile | octet 1 | | | | | | | | | identity | | | | | | | | | | IEI | | | | | | | | | +------------+------------+------------+---------+---+---+---+---+---+ | Length of | octet 2 | | | | | | | | | 5GS mobile | | | | | | | | | | identity | octet 3 | | | | | | | | | contents | | | | | | | | | +------------+------------+------------+---------+---+---+---+---+---+ | Identity | odd/ | Type of | octet 4 | | | | | | | digit 1 | | identity | | | | | | | | | even | | | | | | | | | | | | | | | | | | | | indic | | | | | | | | +------------+------------+------------+---------+---+---+---+---+---+ | Identity | Identity | octet 5* | | | | | | | | digit p+1 | digit p | | | | | | | | +------------+------------+------------+---------+---+---+---+---+---+
Figure 9.11.3.4.2: 5GS mobile identity information element for type of
identity \"IMEI\" or \"IMEISV\"
+---------+---------+---------+---------+---------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+---------+---------+---------+---------+---+---+---+ | 5GS | octet 1 | | | | | | | | | mobile | | | | | | | | | | i | | | | | | | | | | dentity | | | | | | | | | | IEI | | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | Length | octet 2 | | | | | | | | | of 5GS | | | | | | | | | | mobile | octet 3 | | | | | | | | | i | | | | | | | | | | dentity | | | | | | | | | | c | | | | | | | | | | ontents | | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | 0 | SUPI | 0 | Type of | octet 4 | | | | | | | format | | i | | | | | | | spare | | spare | dentity | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | MCC | MCC | octet 5 | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | MNC | MCC | octet 6 | | | | | | | | digit 3 | digit 3 | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | MNC | MNC | octet 7 | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | Routing | Routing | octet 8 | | | | | | | | in | in | | | | | | | | | dicator | dicator | | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | Routing | Routing | octet 9 | | | | | | | | in | in | | | | | | | | | dicator | dicator | | | | | | | | | digit 4 | digit 3 | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | 0 | 0 | 0 | 0 | Pro | octet | | | | | | | | | tection | 10 | | | | | Spare | Spare | Spare | Spare | scheme | | | | | | | | | | Id | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | Home | octet | | | | | | | | | network | 11 | | | | | | | | | public | | | | | | | | | | key | | | | | | | | | | ide | | | | | | | | | | ntifier | | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+ | Scheme | octet | | | | | | | | | output | 12 - x | | | | | | | | +---------+---------+---------+---------+---------+---------+---+---+---+
Figure 9.11.3.4.3: 5GS mobile identity information element for type of
identity \"SUCI\" and SUPI format \"IMSI\"
* * *
8 7 6 5 4 3 2 1  
MSIN digit 2 MSIN digit 1 octet 12  
...  
MSIN digit n+1 MSIN digit n octet x
* * *
Figure 9.11.3.4.3a: Scheme output for type of identity \"SUCI\", SUPI format
\"IMSI\" and Protection scheme Id \"Null scheme\"
+----------+----------+-------+----------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------+----------+-------+----------+---------+---+---+---+---+ | 5GS | octet 1 | | | | | | | | | mobile | | | | | | | | | | identity | | | | | | | | | | IEI | | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | Length | octet 2 | | | | | | | | | of 5GS | | | | | | | | | | mobile | octet 3 | | | | | | | | | identity | | | | | | | | | | contents | | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | 0 | SUPI | 0 | Type of | octet 4 | | | | | | | format | | identity | | | | | | | Spare | | Spare | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | SUCI NAI | octet 5 | | | | | | | | | | - y | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+
Figure 9.11.3.4.4: 5GS mobile identity information element for type of
identity \"SUCI\" and SUPI format \"Network specific identifier\", \"GCI\" or
\"GLI\"
+---------+---------+---------+---+-------+---------+---------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5GS | octet 1 | | | | | | | | | mobile | | | | | | | | | | i | | | | | | | | | | dentity | | | | | | | | | | IEI | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | Length | octet 2 | | | | | | | | | of 5GS | | | | | | | | | | mobile | octet 3 | | | | | | | | | i | | | | | | | | | | dentity | | | | | | | | | | c | | | | | | | | | | ontents | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 1 | 1 | 1 | 1 | 0 | Type of | octet 4 | | | | | | | | | i | | | | | | | | | spare | dentity | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | AMF Set | octet 5 | | | | | | | | | ID | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | AMF Set | AMF | octet 6 | | | | | | | | ID | Pointer | | | | | | | | | (con | | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet 7 | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet 8 | | | | | | | | | (con | | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet 9 | | | | | | | | | (con | | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+ | 5G-TMSI | octet | | | | | | | | | (con | 10 | | | | | | | | | tinued) | | | | | | | | | +---------+---------+---------+---+-------+---------+---------+---+---+
Figure 9.11.3.4.5: 5GS mobile identity information element for type of
identity \"5G-S-TMSI\"
+------------+---------+---+---+---+------------+---------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------+---------+---+---+---+------------+---------+---+---+ | 5GS mobile | octet 1 | | | | | | | | | identity | | | | | | | | | | IEI | | | | | | | | | +------------+---------+---+---+---+------------+---------+---+---+ | Length of | octet 2 | | | | | | | | | 5GS mobile | | | | | | | | | | identity | octet 3 | | | | | | | | | contents | | | | | | | | | +------------+---------+---+---+---+------------+---------+---+---+ | 0 | 0 | 0 | 0 | 0 | Type of | octet 4 | | | | | | | | | identity | | | | +------------+---------+---+---+---+------------+---------+---+---+ | spare | | | | | | | | | +------------+---------+---+---+---+------------+---------+---+---+
Figure 9.11.3.4.6: 5GS mobile identity information element for type of
identity \"No identity\"
+--------+--------+-------+-------+-------+--------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | 5GS | octet | | | | | | | | | mobile | 1 | | | | | | | | | id | | | | | | | | | | entity | | | | | | | | | | IEI | | | | | | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | Length | octet | | | | | | | | | of 5GS | 2 | | | | | | | | | mobile | | | | | | | | | | id | octet | | | | | | | | | entity | 3 | | | | | | | | | co | | | | | | | | | | ntents | | | | | | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | 0 | 0 | 0 | 0 | MAURI | Type | octet | | | | | | | | | of | 4 | | | | spare | spare | spare | spare | | id | | | | | | | | | | entity | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | MAC | octet | | | | | | | | | a | 5 | | | | | | | | | ddress | | | | | | | | | | | octet | | | | | | | | | | 10 | | | | | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+
Figure 9.11.3.4.7: 5GS mobile identity information element for type of
identity \"MAC address\"
+--------+--------+-------+-------+-------+--------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | 5GS | octet | | | | | | | | | mobile | 1 | | | | | | | | | id | | | | | | | | | | entity | | | | | | | | | | IEI | | | | | | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | Length | octet | | | | | | | | | of 5GS | 2 | | | | | | | | | mobile | | | | | | | | | | id | octet | | | | | | | | | entity | 3 | | | | | | | | | co | | | | | | | | | | ntents | | | | | | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | 0 | 0 | 0 | 0 | 0 | Type | octet | | | | | | | | | of | 4 | | | | spare | spare | spare | spare | spare | id | | | | | | | | | | entity | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+ | EUI-64 | octet | | | | | | | | | | 5 | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | 12 | | | | | | | | +--------+--------+-------+-------+-------+--------+--------+---+---+
Figure 9.11.3.4.8: 5GS mobile identity information element for type of
identity \"EUI-64\"
Table 9.11.3.4.1: 5GS mobile identity information element
Type of identity (octet 4) Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
3 | 2 | 1 |  |  |  |  |  |  |   
0 | 0 | 0 | No identity (see NOTE 1) |  |  |  |  |  |   
0 | 0 | 1 | SUCI |  |  |  |  |  |   
0 | 1 | 0 | 5G-GUTI |  |  |  |  |  |   
0 | 1 | 1 | IMEI |  |  |  |  |  |   
1 | 0 | 0 | 5G-S-TMSI |  |  |  |  |  |   
1 | 0 | 1 | IMEISV |  |  |  |  |  |   
1 | 1 | 0 | MAC address |  |  |  |  |  |   
1 | 1 | 1 | EUI-64 |  |  |  |  |  |   
All other values are reserved. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Odd/even indication (octet 4) Bit |  |  |  |  |  |  |  |  |   
4 |  |  |  |  |  |  |  |  |   
0 |  |  | even number of identity digits |  |  |  |  |  |   
1 |  |  | odd number of identity digits |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the 5G-GUTI, then bits 5 to 8 of octet 4 are coded as "1111", octet 5 through 7 contain the MCC and MNC values as specified below, octet 8 through 10 contain the AMF Region ID, the AMF Set ID and the AMF Pointer values and octet 11 through 14 contain the 5G-TMSI as defined in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
MCC, Mobile country code (octet 5, octet 6 bits 1 to 4) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. |  |  |  |  |  |  |  |  |   
MNC, Mobile network code (octet 6 bits 5 to 8, octet 7) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, bits 5 to 8 of octet 6 shall be coded as "1111". The MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 10.5.154 of 3GPP TS 24.008 [12]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
AMF Region ID (octet 8) This field contains the binary encoding of the AMF Region ID. Bit 8 of octet 7 is the most significant bit and bit 1 of octet 7 is the least significant bit. AMF Set ID (octet 9, octet 10 bits 7 to 8) This field contains the binary encoding of the AMF Set ID. Bit 8 of octet 9 is the most significant bit and bit 7 of octet 10 is the least significant bit. AMF Pointer (octet 10 bits 1 to 6) This field contains the binary encoding of the AMF Pointer. Bit 6 of octet 9 is the most significant bit and bit 1 of octet 9 is the least significant bit. 5G-TMSI (octet 11 to 14) Bit 8 of octet 11 is the most significant bit and bit 1 of octet 14 is the least significant bit. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Identity digit (octet 4 bits 5 to 8, octet 5 etc.) |  |  |  |  |  |  |  |  |   
For the IMEI, Identity digit field is coded using BCD coding. If the number of identity digits is even then bits 5 to 8 of the last octet shall be filled with an end mark coded as "1111". The format of the IMEI is described in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the IMEISV, Identity digit field is coded using BCD coding. Bits 5 to 8 of the last octet shall be filled with an end mark coded as "1111". The format of the IMEISV is described in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the SUCI, bit 8 of octet 4 is spare and shall be coded as zero. Bits 5-7 of octet 4 contain the SUPI format and are coded as shown below. |  |  |  |  |  |  |  |  |   
SUPI format (octet 4, bits 5-7) Bits |  |  |  |  |  |  |  |  |   
7 | 6 | 5 |  |  |  |  |  |  |   
0 | 0 | 0 |  | IMSI |  |  |  |  |   
0 | 0 | 1 |  | Network specific identifier |  |  |  |  |   
0 | 1 | 0 |  | GCI |  |  |  |  |   
0 | 1 | 1 |  | GLI |  |  |  |  |   
All other values are interpreted as IMSI by this version of the protocol. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the SUCI with SUPI format "IMSI", octets 5 through 7 contain the MCC and MNC values as specified below. For subsequent fields, bit 8 of octet 8 is the most significant bit and bit 1 of the last octet the least significant bit. The required fields for the SUCI are as defined in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
MCC, Mobile country code (octet 5, octet 6 bits 1 to 4) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. |  |  |  |  |  |  |  |  |   
MNC, Mobile network code (octet 6 bits 5 to 8, octet 7) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, bits 5 to 8 of octet 6 shall be coded as "1111". The MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 10.5.154 of 3GPP TS 24.008 [12]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Routing indicator (octets 8-9) Routing Indicator shall consist of 1 to 4 digits. The coding of this field is the responsibility of home network operator but BCD coding shall be used. If a network operator decides to assign less than 4 digits to Routing Indicator, the remaining digits shall be coded as "1111" to fill the 4 digits coding of Routing Indicator (see NOTE 2). If no Routing Indicator is configured in the USIM or the ME, the UE shall code bits 1 to 4 of octet 8 of the Routing Indicator as "0000" and the remaining digits as "1111". |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Protection scheme identifier (octet 10 bits 1 to 4) |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
4 | 3 | 2 | 1 |  |  |  |  |  |   
0 | 0 | 0 | 0 | Null scheme |  |  |  |  |   
0 | 0 | 0 | 1 | ECIES scheme profile A |  |  |  |  |   
0 | 0 | 1 | 0 | ECIES scheme profile B |  |  |  |  |   
0 | 0 | 1 | 1 |  |  |  |  |  |   
to | Reserved |  |  |  |  |  |  |  |   
1 | 0 | 1 | 1 |  |  |  |  |  |   
1 | 1 | 0 | 0 |  |  |  |  |  |   
to | Operator-specific protection scheme |  |  |  |  |  |  |  |   
1 | 1 | 1 | 1 |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Bits 5-8 of octet 10 are spare and shall be coded as zero. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Home network public key identifier (octet 11) |  |  |  |  |  |  |  |  |   
The Home network public key identifier (PKI) field is coded as defined in 3GPP TS 23.003 [4]. Home network public key identifier shall be coded as "00000000" when Protection scheme identifier is set to "0000" (i.e. Null scheme). |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |  | Home network PKI value 0  
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  |   
to |  | Home network PKI value (1-254) |  |  |  |  |  |  |   
1 | 1 | 1 | 1 | 1 | 1 | 1 | 0 |  |   
1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 |  | Reserved  
|  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Scheme output (octets 12 to x) The Scheme output field consists of a string of characters with a variable length or hexadecimal digits as specified in 3GPP TS 23.003 [4]. If Protection scheme identifier is set to "0000" (i.e. Null scheme), then the Scheme output consists of the MSIN and is coded using BCD coding with each digit of the MSIN coded over 4 bits. If the MSIN includes an odd number of digits, bits 5 to 8 of octet x shall be coded as "1111". If Protection scheme identifier is not "0000" (i.e. ECIES scheme profile A, ECIES scheme profile B or Operator-specific protection scheme), then Scheme output is coded as hexadecimal digits. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the SUCI with SUPI format set to "Network specific identifier", the SUCI NAI field contains an NAI constructed as specified in subclause 28.7.3 of 3GPP TS 23.003 [4] and encoded as UTF-8 string. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the SUCI with SUPI format set to "GCI", the SUCI NAI field contains an NAI constructed as specified in subclause 28.15.5 of 3GPP TS 23.003 [4] and encoded as UTF-8 string. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the SUCI with SUPI format set to "GLI", the SUCI NAI field contains an NAI constructed as specified in subclause 28.16.5 of 3GPP TS 23.003 [4] and encoded as UTF-8 string. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For the 5G-S-TMSI, bits 5 to 8 of octet 4 are coded as "1111". The coding of the 5G-S-TMSI is left open for each administration. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
AMF Set ID (octet 5, octet 6 bits 7 to 8) This field contains the binary encoding of the AMF Set ID. Bit 8 of octet 5 is the most significant bit and bit 7 of octet 6 is the least significant bit. AMF Pointer (octet 6 bits 1 to 6) This field contains the binary encoding of the AMF Pointer. Bit 6 of octet 6 is the most significant bit and bit 1 of octet 6 is the least significant bit. 5G-TMSI (octet 7 to 10) Bit 8 of octet 7 is the most significant bit and bit 1 of octet 10 is the least significant bit. |  |  |  |  |  |  |  |  |   
For Type of identity "No identity", the length of mobile identity contents parameter shall be set to 1 and the bits 4-8 of octet 4 are spare and shall be coded as zero. |  |  |  |  |  |  |  |  |   
MAC address usage restriction indication (MAURI) (octet 4 bit 4) |  |  |  |  |  |  |  |  |   
Bit |  |  |  |  |  |  |  |  |   
4 |  |  |  |  |  |  |  |  |   
0 |  |  |  | No restrictions |  |  |  |  |   
1 |  |  |  | MAC address is not usable as an equipment identifier |  |  |  |  |   
MAC address (octets 5 to 10) This field contains the MAC address as defined in subclause 8 of IEEE Std 802 [43]. Bit 8 of octet 5 is the most significant bit and bit 1 of octet 10 is the least significant bit. |  |  |  |  |  |  |  |  |   
EUI-64 (octets 5 to 12) This field contains an EUI-64 as defined in [48]. Bit 8 of octet 5 is the most significant bit and bit 1 of octet 12 is the least significant bit. |  |  |  |  |  |  |  |  |   
NOTE 1: This can be used when the requested identity is not available at the UE during the identification procedure. NOTE 2: For a 3-digit Routing Indicator, e.g "567", bits 1 to 4 of octet 8 are coded as "0101", bits 5 to 8 of octet 8 are coded as "0110", bits 1 to 4 of octet 9 are coded as "0111", bits 5 to 8 of octet 9 are coded as "1111". |  |  |  |  |  |  |  |  |   
#### 9.11.3.5 5GS network feature support
The purpose of the 5GS network feature support information element is to
indicate whether certain features are supported by the network.
The 5GS network feature support information element is coded as shown in
figure 9.11.3.5.1 and table 9.11.3.5.1.
The 5GS network feature support is a type 4 information element with a minimum
length of 3 octets and a maximum length of 5 octets.
If the network does not include octet 4 as defined in figure 9.11.3.5.1 in the
present version of the protocol, then the UE shall interpret this as a receipt
of an information element with all bits of octet 4 coded as zero.
8 7 6 5 4 3 2 1
* * *
5GS network feature support IEI octet 1  
Length of 5GS network feature support contents octet 2  
MPSI IWK N26 EMF EMC IMS- VoPS-N3GPP IMS- VoPS-3GPP octet 3  
5G-UP CIoT 5G-IPHC-CP CIoT N3 data 5G-CP CIoT RestrictEC MCSI EMCN3 octet 4*  
0 Spare PR RPR PIV NCR 5G-EHC-CP CIoT ATS-IND 5G-LCS octet 5*
Figure 9.11.3.5.1: 5GS network feature support information element
Table 9.11.3.5.1: 5GS network feature support information element
+----------------------------+---+---+---+----------------------------+ | IMS voice over PS session | | | | | | over 3GPP access indicator | | | | | | (IMS-VoPS-3GPP) (octet 3, | | | | | | bit 1) | | | | | +============================+===+===+===+============================+ | This bit indicates the | | | | | | support of IMS voice over | | | | | | PS session over 3GPP | | | | | | access (see NOTE 1). | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 1 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | IMS voice over PS session | | | | | | not supported over 3GPP | | | | | | access | +----------------------------+---+---+---+----------------------------+ | 1 | | | | IMS voice over PS session | | | | | | supported over 3GPP access | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | IMS voice over PS session | | | | | | over non-3GPP access | | | | | | indicator (IMS-VoPS-N3GPP) | | | | | | (octet 3, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | support of IMS voice over | | | | | | PS session over non-3GPP | | | | | | access. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 2 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | IMS voice over PS session | | | | | | not supported over | | | | | | non-3GPP access | +----------------------------+---+---+---+----------------------------+ | 1 | | | | IMS voice over PS session | | | | | | supported over non-3GPP | | | | | | access | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Emergency service support | | | | | | indicator for 3GPP access | | | | | | (EMC) (octet 3, bit 3 and | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | These bits indicate the | | | | | | support of emergency | | | | | | services in 5GS for 3GPP | | | | | | access (see NOTE 1). | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | | | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | | | Emergency services not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | | | Emergency services | | | | | | supported in NR connected | | | | | | to 5GCN only | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | | | Emergency services | | | | | | supported in E-UTRA | | | | | | connected to 5GCN only | +----------------------------+---+---+---+----------------------------+ | 1 | 1 | | | Emergency services | | | | | | supported in NR connected | | | | | | to 5GCN and E-UTRA | | | | | | connected to 5GCN | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Emergency services | | | | | | fallback indicator for | | | | | | 3GPP access (EMF) (octet | | | | | | 3, bit 5 and bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | These bits indicate the | | | | | | support of emergency | | | | | | services fallback for 3GPP | | | | | | access (see NOTE 1). | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 6 | 5 | | | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | | | Emergency services | | | | | | fallback not supported | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | | | Emergency services | | | | | | fallback supported in NR | | | | | | connected to 5GCN only | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | | | Emergency services | | | | | | fallback supported in | | | | | | E-UTRA connected to 5GCN | | | | | | only | +----------------------------+---+---+---+----------------------------+ | 1 | 1 | | | Emergency services | | | | | | fallback supported in NR | | | | | | connected to 5GCN and | | | | | | E-UTRA connected to 5GCN | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Interworking without N26 | | | | | | interface indicator (IWK | | | | | | N26) (octet 3, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | interworking without N26 | | | | | | interface is supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 7 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Interworking without N26 | | | | | | interface not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Interworking without N26 | | | | | | interface supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | MPS indicator (MPSI) | | | | | | (octet 3, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | validity of MPS. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 8 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Access identity 1 not | | | | | | valid | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Access identity 1 valid | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Emergency service support | | | | | | for non-3GPP access | | | | | | indicator (EMCN3) (octet | | | | | | 4, bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | support of emergency | | | | | | services in 5GS for | | | | | | non-3GPP access. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit (see NOTE 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 1 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Emergency services not | | | | | | supported over non-3GPP | | | | | | access | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Emergency services | | | | | | supported over non-3GPP | | | | | | access | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | MCS indicator (MCSI) | | | | | | (octet 4, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | validity of MCS. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 2 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Access identity 2 not | | | | | | valid | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Access identity 2 valid | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Restriction on enhanced | | | | | | coverage (RestrictEC) | | | | | | (octet 4, bit 3 and bit 4) | | | | | | | | | | | | These bits indicate | | | | | | enhanced coverage | | | | | | restricted information. | | | | | +----------------------------+---+---+---+----------------------------+ | In WB-N1 mode these bits | | | | | | are set as follows: | | | | | | | | | | | | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | | | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | | | Both CE mode A and CE mode | | | | | | B are not restricted | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | | | Both CE mode A and CE mode | | | | | | B are restricted | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | | | CE mode B is restricted | +----------------------------+---+---+---+----------------------------+ | 1 | 1 | | | Reserved | +----------------------------+---+---+---+----------------------------+ | In NB-N1 mode these bits | | | | | | are set as follows | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | | | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | | | Use of enhanced coverage | | | | | | is not restricted | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | | | Use of enhanced coverage | | | | | | is restricted | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | | | Reserved | +----------------------------+---+---+---+----------------------------+ | 1 | 1 | | | Reserved | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Control plane CIoT 5GS | | | | | | optimization (5G-CP CIoT) | | | | | | (octet 4, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for control | | | | | | plane CIoT 5GS | | | | | | optimization. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **5** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Control plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Control plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | N3 data transfer (N3 data) | | | | | | (octet 4, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for N3 data | | | | | | transfer. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **6** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | N3 data transfer supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | N3 data transfer not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | IP header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization (5G-IPHC-CP | | | | | | CIoT) (octet 4, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for IP header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | 7 | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | IP header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | IP header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | User plane CIoT 5GS | | | | | | optimization (5G-UP CIoT) | | | | | | (octet 4, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for user plane | | | | | | CIoT 5GS optimization. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **8** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | User plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | User plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Location Services | | | | | | indicator in 5GC (5G-LCS) | | | | | | (octet 5, bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **1** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Location services via 5GC | | | | | | not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Location services via 5GC | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | ATSSS support indicator | | | | | | (ATS-IND) (octet 5, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | network support for ATSSS. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **2** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | ATSSS not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | ATSSS supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ethernet header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization (5G-EHC-CP | | | | | | CIoT) (octet 5, bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | capability for Ethernet | | | | | | header compression for | | | | | | control plane CIoT 5GS | | | | | | optimization | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **3** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ethernet header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ethernet header | | | | | | compression for control | | | | | | plane CIoT 5GS | | | | | | optimization supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | N1 NAS signalling | | | | | | connection release (NCR) | | | | | | (octet 5, bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | N1 NAS signalling | | | | | | connection release is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **4** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | N1-NAS signalling | | | | | | connection release not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | N1-NAS signalling | | | | | | connection release | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Paging indication for | | | | | | voice services (PIV) | | | | | | (octet 5, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | paging indication for | | | | | | voice services is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **5** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | paging indication for | | | | | | voice services not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | paging indication for | | | | | | voice services supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Reject paging request | | | | | | (RPR) (octet 5, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | reject paging request is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **6** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | reject paging request not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | reject paging request | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Paging restriction (PR) | | | | | | (octet 5, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates whether | | | | | | paging restriction is | | | | | | supported. | | | | | +----------------------------+---+---+---+----------------------------+ | Bit | | | | | +----------------------------+---+---+---+----------------------------+ | **7** | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | paging restriction not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | paging restriction | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Bit 8 in octet 5 is spare | | | | | | and shall be coded as | | | | | | zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NOTE 1: For a registration | | | | | | procedure over non-3GPP | | | | | | access, bit 1 of octet 3 | | | | | | and bits 3 to 6 of octet 3 | | | | | | are ignored. | | | | | | | | | | | | NOTE 2: For a registration | | | | | | procedure over 3GPP | | | | | | access, bit 2 of octet 3 | | | | | | and bit 1 of octet 4 are | | | | | | ignored. | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.6 5GS registration result
The purpose of the 5GS registration result information element is to specify
the result of a registration procedure.
The 5GS registration result information element is coded as shown in figure
9.11.3.6.1 and table 9.11.3.6.1.
The 5GS registration result is a type 4 information element with a length of 3
octets.
+--------+--------+--------+--------+--------+--------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | 5GS | octet | | | | | | | | | regist | 1 | | | | | | | | | ration | | | | | | | | | | result | | | | | | | | | | IEI | | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | Length | octet | | | | | | | | | of 5GS | 2 | | | | | | | | | regist | | | | | | | | | | ration | | | | | | | | | | result | | | | | | | | | | _con | | | | | | | | | | tents_ | | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | 0 | Di | Eme | NSSAA | SMS | 5GS | octet | | | | | saster | rgency | Per | a | regist | 3 | | | | Spare | r | regi | formed | llowed | ration | | | | | | oaming | stered | | | result | | | | | | regist | | | | value | | | | | | ration | | | | | | | | | | result | | | | | | | | | | value | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+
Figure 9.11.3.6.1: 5GS registration result information element
Table 9.11.3.6.1: 5GS registration result information element
* * *
5GS registration result value (octet 3, bits 1 to 3) (NOTE)  
Bits  
3 2 1  
0 0 1 3GPP access 0 1 0 Non-3GPP access 0 1 1 3GPP access and non-3GPP access
1 1 1 reserved
All other values are unused and shall be treated as \"3GPP access\", if
received by the UE.
SMS over NAS transport allowed (SMS allowed) (octet 3, bit 4) (NOTE)  
Bit  
4  
0 SMS over NAS not allowed 1 SMS over NAS allowed
Network slice-specific authentication and authorization is to be performed
(NSSAA to be performed) (octet 3, bit 5) (NOTE)  
Bit  
5  
0 Network slice-specific authentication and authorization is not to be
performed 1 Network slice-specific authentication and authorization is to be
performed
Emergency registered (octet 3, bit 6)  
Bit  
6  
0 Not registered for emergency services 1 Registered for emergency services
Disaster roaming registration result value (octet 3, bit 7)  
Bit  
7  
0 No additional information 1 Request for registration for disaster roaming
services accepted as registration not for disaster roaming services
Bit 8 of octet 3 is spare and shall be coded as zero.  
NOTE: All bits other than bit 6 in octet 3 shall be ignored by the UE when the
5GS registration result IE is received in the CONFIGURATION UPDATE COMMAND
message
* * *
#### 9.11.3.7 5GS registration type
The purpose of the 5GS registration type information element is to indicate
the type of the requested registration.
The 5GS registration type information element is coded as shown in figure
9.11.3.7.1 and table 9.11.3.7.1.
The 5GS registration type is a type 1 information element with a length of 1
octet.
* * *
8 7 6 5 4 3 2 1  
5GS registration type IEI FOR 5GS registration type value octet 1
* * *
Figure 9.11.3.7.1: 5GS registration type information element
Table 9.11.3.7.1: 5GS registration type information element
* * *
5GS registration type value (octet 1, bits 1 to 3)  
Bits  
3 2 1  
0 0 1 initial registration 0 1 0 mobility registration updating 0 1 1 periodic
registration updating 1 0 0 emergency registration 1 0 1 SNPN onboarding
registration 1 1 0 disaster roaming mobility registration updating 1 1 1
disaster roaming initial registration
All other values are unused and shall be interpreted as \"initial
registration\", if received by the network.
Follow-on request bit (FOR) (octet 1, bit 4)  
Bit  
4  
0 No follow-on request pending 1 Follow-on request pending
* * *
#### 9.11.3.8 5GS tracking area identity
The purpose of the 5GS tracking area identity information element is to
provide an unambiguous identification of tracking areas within the area
covered by the 5GS.
The 5GS tracking area identity information element is coded as shown in figure
9.11.3.8.1 and table 9.11.3.8.1.
The 5GS tracking area identity is a type 3 information element with a length
of 7 octets.
* * *
8 7 6 5 4 3 2 1  
5GS tracking area identity IEI octet 1  
MCC digit 2 MCC digit 1 octet 2  
MNC digit 3 MCC digit 3 octet 3  
MNC digit 2 MNC digit 1 octet 4  
TAC octet 5  
TAC (continued) octet 6  
TAC (continued) octet 7
* * *
Figure 9.11.3.8.1: 5GS tracking area identity information element
Table 9.11.3.8.1: 5GS tracking area identity information element
+----------------------------------------------------------------------+ | MCC, Mobile country code (octets 2 and 3) | | | | The MCC field is coded as in ITU-T Rec. E212 [39], annex A. | | | | If the TAI is deleted the MCC and MNC shall take the value from the | | deleted TAI. | | | | In abnormal cases, the MCC stored in the UE can contain elements not | | in the set {0, 1 ... 9}. In such cases the UE should transmit the | | stored values using full hexadecimal encoding. When receiving such | | an MCC, the network shall treat the TAI as deleted. | | | | MNC, Mobile network code (octet 3 bits 5 to 8, octet 4) | | | | The coding of this field is the responsibility of each | | administration, but BCD coding shall be used. The MNC shall consist | | of 2 or 3 digits. For PCS 1900 for NA, Federal regulation mandates | | that a 3-digit MNC shall be used. However, a network operator may | | decide to use only two digits in the MNC in the TAI over the radio | | interface. In this case, bits 5 to 8 of octet 3 shall be coded as | | \"1111\". Mobile equipment shall accept a TAI coded in such a way. | | | | In abnormal cases, the MNC stored in the UE can have: | | | | - digit 1 or 2 not in the set {0, 1 ... 9}, or | | | | - digit 3 not in the set {0, 1 ... 9, F} hex. | | | | In such cases the UE shall transmit the stored values using full | | hexadecimal encoding. When receiving such an MNC, the network shall | | treat the TAI as deleted. | | | | The same handling shall apply for the network, if a 3-digit MNC is | | sent by the UE to a network using only a 2-digit MNC. | | | | TAC, Tracking area code (octets 5 to 7) | | | | In the TAC field bit 8 of octet 5 is the most significant bit and | | bit 1 of octet 7 the least significant bit. | | | | The coding of the tracking area code is the responsibility of each | | administration except that two values are used to mark the TAC, and | | hence the TAI, as deleted. Coding using full hexadecimal | | representation may be used. The tracking area code consists of 3 | | octets. | | | | If a TAI has to be deleted, then all bits of the tracking area code | | shall be set to one with the exception of the least significant bit | | which shall be set to zero. If a USIM is inserted in a mobile | | equipment with the tracking area code containing all zeros, then the | | mobile equipment shall recognise this TAC as part of a deleted TAI. | +----------------------------------------------------------------------+
#### 9.11.3.9 5GS tracking area identity list
The purpose of the 5GS _tracking area identity list_ information element is to
transfer a list of tracking areas from the network to the UE.
The coding of the information element allows combining different types of
lists. The lists of type \"00\" and \"01\" allow a more compact encoding, when
the different TAIs are sharing the PLMN identity.
The 5GS _tracking area identity list_ information element is coded as shown in
figure 9.11.3.8.1, figure 9.11.3.8.2, figure 9.11.3.9.3, figure 9.11.3.9.4 and
table 9.11.3.9.1.
The 5GS _tracking area identity list_ is a type 4 information element, with a
minimum length of 9 octets and a maximum length of 114 octets. The list can
contain a maximum of 16 different tracking area identities.
+----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | 5GS tracking area identity list IEI | octet 1 | | | | | | | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of 5GS tracking area identity list contents | octet 2 | | | | | | | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Partial tracking area identity list 1 | octet 3 | | | | | | | | | | | | | | | | | | | | octet i | | | | | | | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Partial tracking area identity list 2 | octet i+1* | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Partial tracking area identity list p | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +----------------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.9.1: 5GS tracking area identity list information element
+-------------------+--------------+--------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | 0 | Type of list | Number of elements | octet 1 | | | | | | | | | | | | | | | | | Spare | | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MCC digit 2 | MCC digit 1 | octet 2 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 3 | MCC digit 3 | octet 3 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 2 | MNC digit 1 | octet 4 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 | octet 5 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 (continued) | octet 6 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 (continued) | octet 7 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | ... | ... | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | ... | ... | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC k | octet 3k+2* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC k (continued) | octet 3k+3* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC k (continued) | octet 3k+4* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+
Figure 9.11.3.9.2: Partial tracking area identity list -- type of list =
\"00\"
+-------------------+--------------+--------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | 0 | Type of list | Number of elements | octet 1 | | | | | | | | | | | | | | | | | Spare | | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MCC digit 2 | MCC digit 1 | octet 2 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 3 | MCC digit 3 | octet 3 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 2 | MNC digit 1 | octet 4 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 | octet 5 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 (continued) | octet 6 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 (continued) | octet 7 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+
Figure 9.11.3.9.3: Partial tracking area identity list -- type of list =
\"01\"
+-------------------+--------------+--------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | 0 | Type of list | Number of elements | octet 1 | | | | | | | | | | | | | | | | | Spare | | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MCC digit 2 | MCC digit 1 | octet 2 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 3 | MCC digit 3 | octet 3 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 2 | MNC digit 1 | octet 4 | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 | octet 5 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 (continued) | octet 6 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 1 (continued) | octet 7 | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MCC digit 2 | MCC digit 1 | octet 8* | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 3 | MCC digit 3 | octet 9* | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 2 | MNC digit 1 | octet 10* | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 2 | octet 11* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 2 (continued) | octet 12* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC 2 (continued) | octet 13* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | ... | | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | ... | | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MCC digit 2 | MCC digit 1 | octet 6k-4* | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 3 | MCC digit 3 | octet 6k-3* | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | MNC digit 2 | MNC digit 1 | octet 6k-2* | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC k | octet 6k-1* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC k (continued) | octet 6k* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+ | TAC k (continued) | octet 6k+1* | | | | | | | | +-------------------+--------------+--------------------+---------+---+---+---+---+---+
Figure 9.11.3.9.4: Partial tracking area identity list -- type of list =
\"10\"
Table 9.11.3.9.1: Tracking area identity list information element
* * *
Value part of the Tracking area identity list information element (octets 3 to
n)
The value part of the Tracking area identity list information element consists
of one or several partial tracking area identity lists. The length of each
partial tracking area identity list can be determined from the \'type of
list\' field and the \'number of elements\' field in the first octet of the
partial tracking area identity list.  
The UE shall store the complete list received. If more than 16 TAIs are
included in this information element, the UE shall store the first 16 TAIs and
ignore the remaining octets of the information element.
Partial tracking area identity list:
Type of list (octet 1)  
Bits  
7 6  
0 0 list of TACs belonging to one PLMN or SNPN, with non-consecutive TAC
values  
0 1 list of TACs belonging to one PLMN or SNPN, with consecutive TAC values  
1 0 list of TAIs belonging to different PLMNs (see NOTE)
All other values are reserved.
Number of elements (octet 1)  
Bits  
5 4 3 2 1  
0 0 0 0 0 1 element 0 0 0 0 1 2 elements 0 0 0 1 0 3 elements ...  
0 1 1 0 1 14 elements 0 1 1 1 0 15 elements 0 1 1 1 1 16 elements
All other values are unused and shall be interpreted as 16, if received by the
UE.
Bit 8 of octet 1 is spare and shall be coded as zero.
For type of list = \"00\" and number of elements = k:
octet 2 to 4 contain the MCC+MNC, and  
for j = 1, ..., k:  
octets 3j+2 to 3j+4 contain the TAC of the j-th TAI belonging to the partial
list,
For type of list = \"01\" and number of elements = k:
octet 2 to 4 contain the MCC+MNC, and  
octets 5 to 7 contain the TAC of the first TAI belonging to the partial list.  
The TAC values of the other k-1 TAIs are TAC+1, TAC+2, ..., TAC+k-1.
For type of list = \"10\" and number of elements = k:
for j = 1, ..., k.  
octets 6j-4 to 6j-2 contain the MCC+MNC, and  
octets 6j-1 to 6j+1 contain the TAC of the j-th TAI belonging to the partial
list.
MCC, Mobile country code
The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A.
MNC, Mobile network code
The coding of this field is the responsibility of each administration but BCD
coding shall be used. The MNC shall consist of 2 or 3 digits. If a network
operator decides to use only two digits in the MNC, MNC digit 3 shall be coded
as \"1111\".
TAC, Tracking area code
In the TAC field bit 8 of the first octet is the most significant bit and bit
1 of third octet the least significant bit.  
The coding of the tracking area code is the responsibility of each
administration. Coding using full hexadecimal representation may be used. The
tracking area code consists of 3 octets.
NOTE: If the \"list of TAIs belonging to different PLMNs\" is used, the PLMNs
included in the list need to be present in the list of \"equivalent PLMNs\".
This type of list is not applicable in an SNPN.
* * *
#### 9.11.3.9A 5GS update type
The purpose of the 5GS update type IE is to allow the UE to provide additional
information to the network when performing a registration procedure.
The 5GS update type information element is coded as shown in figure
9.11.3.9A.1 and table 9.11.3.9A.1.
The 5GS update type is a type 4 information element with a length of 3
octects.
+--------+--------+--------+--------+--------+--------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | 5GS | octet | | | | | | | | | update | 1 | | | | | | | | | type | | | | | | | | | | IEI | | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | Length | octet | | | | | | | | | of 5GS | 2 | | | | | | | | | update | | | | | | | | | | type | | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | 0 | 0 | EPS- | 5GS-PN | NG-R | SMS | octet | | | | | | PN | B-CIoT | AN-RCU | req | 3 | | | | Spare | Spare | B-CIoT | | | uested | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+
Figure 9.11.3.9A.1: 5GS update type information element
Table 9.11.3.9A.1: 5GS update type information element
+-------------------------------+---+-------------------------------+ | SMS over NAS transport | | | | requested (SMS requested) | | | | (octet 3, bit 1) | | | +-------------------------------+---+-------------------------------+ | Bit | | | +-------------------------------+---+-------------------------------+ | 1 | | | +-------------------------------+---+-------------------------------+ | 0 | | SMS over NAS not supported | +-------------------------------+---+-------------------------------+ | 1 | | SMS over NAS supported | +-------------------------------+---+-------------------------------+ | | | | +-------------------------------+---+-------------------------------+ | NG-RAN Radio Capability | | | | Update (NG-RAN-RCU) (octet 3, | | | | bit 2) | | | +-------------------------------+---+-------------------------------+ | Bit | | | +-------------------------------+---+-------------------------------+ | 2 | | | +-------------------------------+---+-------------------------------+ | 0 | | UE radio capability update | | | | not needed | +-------------------------------+---+-------------------------------+ | 1 | | UE radio capability update | | | | needed | +-------------------------------+---+-------------------------------+ | For a list of RATs for which | | | | a radio capability update can | | | | be triggered by means of this | | | | indication see | | | | subclause 5.5.1.3.2, case n). | | | +-------------------------------+---+-------------------------------+ | 5GS Preferred CIoT network | | | | behaviour (5GS PNB-CIoT) | | | | (octet 3, bits 3 and 4) | | | +-------------------------------+---+-------------------------------+ | | | | +-------------------------------+---+-------------------------------+ | Bits | | | +-------------------------------+---+-------------------------------+ | 4 | 3 | | +-------------------------------+---+-------------------------------+ | 0 | 0 | no additional information | +-------------------------------+---+-------------------------------+ | 0 | 1 | control plane CIoT 5GS | | | | optimization | +-------------------------------+---+-------------------------------+ | 1 | 0 | user plane CIoT 5GS | | | | optimization | +-------------------------------+---+-------------------------------+ | 1 | 1 | reserved | +-------------------------------+---+-------------------------------+ | | | | +-------------------------------+---+-------------------------------+ | EPS Preferred CIoT network | | | | behaviour (EPS-PNB-CIoT) | | | | (octet 3, bits 5 and 6) | | | +-------------------------------+---+-------------------------------+ | | | | +-------------------------------+---+-------------------------------+ | Bits | | | | | | | | --- --- -- | | | | 6 5 | | | | --- --- -- | | | +-------------------------------+---+-------------------------------+ | --- --- -------- | | | | ----------------------------- | | | | 0 | | | | 0 no additional information | | | | 0 1 contro | | | | l plane CIoT EPS optimization | | | | 1 0 use | | | | r plane CIoT EPS optimization | | | | 1 1 reserved | | | | --- --- -------- | | | | ----------------------------- | | | +-------------------------------+---+-------------------------------+ | | | | +-------------------------------+---+-------------------------------+ | | | | +-------------------------------+---+-------------------------------+ | Bits 7 to 8 of octet 3 are | | | | spare and shall be coded as | | | | zero. | | | +-------------------------------+---+-------------------------------+
#### 9.11.3.10 ABBA
The purpose of the ABBA information element is to enable the bidding down
protection of security features.
The ABBA information element is coded as shown in figure 9.11.3.10.1 and table
9.11.3.10.1.
The ABBA is a type 4 information element with a minimum length of 4 octets.
+-------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=========================+=========+===+===+===+===+===+===+===+ | ABBA IEI | octet 1 | | | | | | | | +-------------------------+---------+---+---+---+---+---+---+---+ | Length of ABBA contents | octet 2 | | | | | | | | +-------------------------+---------+---+---+---+---+---+---+---+ | ABBA contents | octet 3 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +-------------------------+---------+---+---+---+---+---+---+---+
Figure 9.11.3.10.1: ABBA information element
Table 9.11.3.10.1: ABBA information element
+----------------------------------------------------------------------+ | ABBA contents (octet 3-n): | | | | indicate set of security features defined for 5GS as described in | | 3GPP TS 33.501 [24]. | +----------------------------------------------------------------------+ | NOTE 1: If the UE receives the ABBA IE with a length that is set to | | a value of 2 and with a value of 0000H, the UE shall use the length | | and the contents of the ABBA IE as received from the network. | | | | NOTE 2: If the UE receives the ABBA IE with a length that is set to | | a value larger than 2 or with a value that is different from 0000H, | | the UE shall use the length and the contents of the ABBA IE as | | received from the network. | +----------------------------------------------------------------------+
#### 9.11.3.11 Void
#### 9.11.3.12 Additional 5G security information
The purpose of the Additional 5G security information information element is
to provide the UE with additional security parameters (e.g. horizontal
derivation parameter) or to request the UE to retransmit an initial NAS
message during a security mode control procedure as defined in 3GPP TS 33.501
[24]. The UE uses these parameters for completion of security mode control
procedure.
The Additional 5G security information information element is coded as shown
in figure 9.11.3.12.1 and table 9.11.3.12.1.
The Additional 5G security information is a type 4 information element with a
length of 3 octets.
+-------+-------+-------+-------+-------+-------+-------+-----+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+ | Addit | octet | | | | | | | | | ional | 1 | | | | | | | | | 5G | | | | | | | | | | sec | | | | | | | | | | urity | | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | Addit | | | | | | | | | | ional | | | | | | | | | | 5G | | | | | | | | | | sec | | | | | | | | | | urity | | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | RINMR | HDP | octet | | | | | | | | | | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+
Figure 9.11.3.12.1: Additional 5G security information information element
Table 9.11.3.12.1: Additional 5G security information information element
* * *
Horizontal derivation parameter (HDP) (octet 3, bit 1)  
0 K~AMF~ derivation is not required 1 K~AMF~ derivation is required
Retransmission of initial NAS message request (octet 3, bit 2)  
0 Retransmission of the initial NAS message not requested 1 Retransmission of
the initial NAS message requested
Bits 3 to 8 of octet 3 are spare and shall be coded as zero.
* * *
#### 9.11.3.12A Additional information requested
The purpose of the Additional information requested information element is to
enable the UE to request ciphering keys for deciphering of ciphered broadcast
assistance data.
The Additional information requested information element is coded as shown in
figure 9.11.3.12A.1 and table 9.11.3.12A.1.
The Additional information requested is a type 4 information element with a
length of 3 octets.
* * *
8 7 6 5 4 3 2 1  
Additional information requested IEI octet 1  
Length of additional information requested contents octet 2  
0 0 0 0 0 0 0 CipherKey octet 3 Spare
* * *
Figure 9.11.3.12A.1: Additional information requested information element
Table 9.11.3.12A.1: Additional information requested information element
* * *
Ciphering keys for ciphered broadcast assistance data (CipherKey) (octet 3,
bit 1)  
Bit  
1  
0 ciphering keys for ciphered broadcast assistance data not requested 1
ciphering keys for ciphered broadcast assistance data requested
Bits 8 to 2 of octet 3 are spare and shall be coded as zero.
* * *
#### 9.11.3.13 Allowed PDU session status
The purpose of the Allowed PDU session status information element is to
indicate to the network user-plane resources of PDU sessions associated with
non-3GPP access that are allowed to be re-established over 3GPP access or if
there is no PDU session(s) for which the UE allows the user-plane resources to
be re-established over 3GPP access.
NOTE: Allowed PDU session status IE is not applicable for MA PDU session(s) in
this release of specification.
The Allowed PDU session status information element is coded as shown in figure
9.11.3.13.1 and table 9.11.3.13.1.
The Allowed PDU session status is a type 4 information element with minimum
length of 4 octets and maximum length of 34 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Al | octet | | | | | | | | | lowed | 1 | | | | | | | | | PDU | | | | | | | | | | se | | | | | | | | | | ssion | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | Al | | | | | | | | | | lowed | | | | | | | | | | PDU | | | | | | | | | | se | | | | | | | | | | ssion | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 3 | | (7) | (6) | (5) | (4) | (3) | (2) | (1) | (0) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 4 | | \ | \ | \ | \ | \ | \ | (9) | (8) | | | (15) | (14) | (13) | (12) | (11) | (10) | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | octet | | | | | | | | | | 5* | | | | | | | | | | -34* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.13.1: Allowed PDU session status information element
Table 9.11.3.13.1: Allowed PDU session status information element
+----------------------------------------------------------------------+ | PSI(x) shall be coded as follows: | | | | PSI(0): | | | | Bit 1octet 3 is spare and shall be coded as zero. | | | | PSI(1) -- PSI(15): | | | | 0 indicates that the user-plane resources of corresponding PDU | | session is not allowed to be re-established over 3GPP access. | | | | 1 indicates that the user-plane resources of corresponding PDU | | session can be re-established over 3GPP access. | | | | If there is no PDU session for which the user-plane resources can be | | re-established over 3GPP access, all bits in PSI(1) -- PSI(15) shall | | be coded as zero. | | | | All bits in octet 5 to 34 are spare and shall be coded as zero, if | | the respective octet is included in the information element. | +----------------------------------------------------------------------+
#### 9.11.3.14 Authentication failure parameter
See subclause 10.5.3.2.2 in 3GPP TS 24.008 [12].
#### 9.11.3.15 Authentication parameter AUTN
See subclause 10.5.3.1.1 in 3GPP TS 24.008 [12].
#### 9.11.3.16 Authentication parameter RAND
See subclause 10.5.3.1 in 3GPP TS 24.008 [12].
#### 9.11.3.17 Authentication response parameter
See subclause 9.9.3.4 in 3GPP TS 24.301 [15].
#### 9.11.3.18 Configuration update indication
The purpose of the Configuration update indication information element is to
indicate the additional information associated with the generic UE
configuration update procedure.
The Configuration update indication information element is coded as shown in
figure 9.11.3.18.1 and table 9.11.3.18.1.
The Configuration update indication is a type 1 information element.
+-------------------------------------+-------+-------+-----+-----+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=====================================+=======+=======+=====+=====+=========+===+===+===+ | Configuration update indication IEI | 0 | 0 | RED | ACK | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | | | | | | | +-------------------------------------+-------+-------+-----+-----+---------+---+---+---+
Figure 9.11.3.18.1: Configuration update indication
Table 9.11.3.18.1: Configuration update indication
Acknowledgement (ACK) (octet 1, bit 1)
* * *
Bit  
1  
0 acknowledgement not requested 1 acknowledgement requested
Registration requested (RED) (octet 1, bit 2)  
Bit  
2  
0 registration not requested 1 registration requested
Bits 3 and 4 are spare and shall be coded as zero,
#### 9.11.3.18A CAG information list
The purpose of the CAG information list information element is to provide
\"CAG information list\" or to delete the \"CAG information list\" at the UE.
The CAG information list information element is coded as shown in figures
9.11.3.18A.1 and 9.11.3.18A.2 and table 9.11.3.18A.1.
The CAG information _list_ is a type 6 information element, with a minimum
length of 3 octets.
+-----------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | CAG information list IEI | octet 1 | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of CAG information list contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Entry 1 | octet 4* | | | | | | | | | | | | | | | | | | | | octet a* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Entry 2 | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | octet g* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Entry n | octet g+1* | | | | | | | | | | | | | | | | | | | | octet h* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.18A.1: CAG information list information element
+-------+-------+-------+-------+-------+-------+-------+------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | L | octet | | | | | | | | | ength | q | | | | | | | | | of | | | | | | | | | | entry | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MCC | MCC | octet | | | | | | | | digit | digit | q+1 | | | | | | | | 2 | 1 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MNC | MCC | octet | | | | | | | | digit | digit | q+2 | | | | | | | | 3 | 3 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MNC | MNC | octet | | | | | | | | digit | digit | q+3 | | | | | | | | 2 | 1 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | CAG | octet | | | | | | | | | | q+4 | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | only | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | q+5* | | | | | | | | | 1 | | | | | | | | | | | octet | | | | | | | | | | q+8* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | q+9* | | | | | | | | | 2 | | | | | | | | | | | octet | | | | | | | | | | q | | | | | | | | | | +12* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | ... | octet | | | | | | | | | | q | | | | | | | | | | +13* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | q | | | | | | | | | | +4m* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | q+4 | | | | | | | | | m | m+1* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | q+4 | | | | | | | | | | m+4* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+
Figure 9.11.3.18A.2: Entry n
Table 9.11.3.18A.1: CAG information list information element
+----------------------------------+----------------------------------+ | MCC, Mobile country code (octet | | | q+1 and bits 1 to 4 octet q+2) | | | | | | The MCC field is coded as in | | | IT | | | U-T Recommendation E.212 [42], | | | annex A. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | MNC, Mobile network code (bits 5 | | | to 8 of octet q+2 and octet q+3) | | | | | | The coding of this field is the | | | responsibility of each | | | administration, but BCD coding | | | shall be used. The MNC shall | | | consist of 2 or 3 digits. If a | | | network operator decides to use | | | only two digits in the MNC, bits | | | 5 to 8 of octet q+2 shall be | | | coded as \"1111\". | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | The MCC and MNC digits are coded | | | as octets 6 to 8 of the | | | Temporary mobile group identity | | | IE in figure 10.5.154 of | | | 3GPP TS 24.008 [12]. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Indication that the UE is only | | | allowed to access 5GS via CAG | | | cells (CAGonly) (bit 1 of octet | | | q+4) | | +----------------------------------+----------------------------------+ | Bit | | +----------------------------------+----------------------------------+ | 1 | | +----------------------------------+----------------------------------+ | 0 | \"Indication that the UE is only | | | allowed to access 5GS via CAG | | | cells\" is not set (i.e., the UE | | | is allowed to access 5GS via | | | non-CAG cells) | +----------------------------------+----------------------------------+ | 1 | \"Indication that the UE is only | | | allowed to access 5GS via CAG | | | cells\" is set (i.e., the UE is | | | not allowed to access 5GS via | | | non-CAG cells) | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | CAG-ID m (octet q+4m+1 to octet | | | q+4m+4) | | | | | | This field contains the 32 bit | | | CAG-ID. The coding of the CAG-ID | | | is defined as the CAG-Identifier | | | in 3GPP TS 23.003 [4]. | | | | | | NOTE 1: The Length of CAG | | | information list contents shall | | | be 0 if no subscription data for | | | CAG information list exists. | | | | | | NOTE 2: The Length of entry | | | contents shall be 4 if there is | | | no allowed CAG-ID for the PLMN. | | | | | | NOTE 3: Bit 2 in octet q+4 may | | | be set to 1 in the USIM (see | | | 3GPP TS 31.102 [22]). | | | | | | NOTE 4: For a given PLMN ID, | | | there shall be up to one Entry | | | containing the MCC value and the | | | MNC value of the PLMN ID. | | +----------------------------------+----------------------------------+
#### 9.11.3.18B CIoT small data container
This information element is used to encapsulate the CIoT user data, SMS, or
location services message with a size that is not more than 254 octets between
the UE and the AMF when the UE is using control plane CIoT 5GS optimization.
The CIoT small data container information element is coded as shown in figure
9.11.3.18B.1, figure 9.11.3.18B.2, figure 9.11.3.18B.3, figure 9.11.3.18B.4
and table 9.11.3.18B.1.
The CIoT small data container is a type 4 information element with a minimum
length of 4 octets and a maximum length of 257 octets.
* * *
8 7 6 5 4 3 2 1  
CIoT small data container IEI octet 1  
Length of CIoT small data container contents octet 2  
octet 3  
CIoT small data container contents  
octet 257
* * *
Figure 9.11.3.18B.1: CIoT small data container information element
+---------------+-----------+----------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------+-----------+----------------------+---------+---+---+---+---+---+ | Data type | DDX | PDU session identity | octet 3 | | | | | | +---------------+-----------+----------------------+---------+---+---+---+---+---+ | Data contents | octet 4 | | | | | | | | | | | | | | | | | | | | octet 257 | | | | | | | | +---------------+-----------+----------------------+---------+---+---+---+---+---+
Figure 9.11.3.18B.2: CIoT small data container contents for Data type
\"Control plane user data\"
+----------------------------------+-----------+-------+-------+-------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------+-----------+-------+-------+-------+---------+---+---+---+ | Data type | DDX | 0 | 0 | 0 | octet 3 | | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | +----------------------------------+-----------+-------+-------+-------+---------+---+---+---+ | Length of additional information | octet 4 | | | | | | | | +----------------------------------+-----------+-------+-------+-------+---------+---+---+---+ | Additional information | octet 5* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +----------------------------------+-----------+-------+-------+-------+---------+---+---+---+ | Data contents | octet m+1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +----------------------------------+-----------+-------+-------+-------+---------+---+---+---+
Figure 9.11.3.18B.3: CIoT small data container contents for Data type
\"Location services message container\"
+---------------+---------+-------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------+---------+-------+---------+---+---+---+---+---+ | Data type | | Spare | octet 3 | | | | | | +---------------+---------+-------+---------+---+---+---+---+---+ | Data contents | octet 4 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +---------------+---------+-------+---------+---+---+---+---+---+
Figure 9.11.3.18B.4: CIoT small data container contents for Data type \"SMS\"
Table 9.11.3.18B.1: CIoT small data container information element
+-------------------+---+-------------------+---+-------------------+ | CIoT small data | | | | | | container | | | | | | contents (octet 3 | | | | | | to octet 257) | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | These octets | | | | | | include user data | | | | | | to be delivered | | | | | | between UE and | | | | | | AMF. | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | Data type (octet | | | | | | 3, bits 6 to 8) | | | | | | | | | | | | Bits | | | | | +-------------------+---+-------------------+---+-------------------+ | 8 | 7 | 6 | | | +-------------------+---+-------------------+---+-------------------+ | 0 | 0 | 0 | | Control plane | | | | | | user data | +-------------------+---+-------------------+---+-------------------+ | 0 | 0 | 1 | | SMS | +-------------------+---+-------------------+---+-------------------+ | 0 | 1 | 0 | | Location services | | | | | | message container | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | All other values | | | | | | are spare. If | | | | | | received they | | | | | | shall be ignored. | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | When the Data | | | | | | type is \"Control | | | | | | plane user data | | | | | | \", the PDU | | | | | | session identity | | | | | | and Downlink data | | | | | | expected (DDX) | | | | | | fields are | | | | | | encoded as | | | | | | follows: | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | PDU session | | | | | | identity (octet | | | | | | 3, bits 1 to 4) | | | | | | | | | | | | Bit | | | | | +-------------------+---+-------------------+---+-------------------+ | 3 | 2 | 1 | | | +-------------------+---+-------------------+---+-------------------+ | 0 | 0 | 0 | | No PDU session | | | | | | identity assigned | +-------------------+---+-------------------+---+-------------------+ | 0 | 0 | 1 | | PDU session | | | | | | identity value 1 | +-------------------+---+-------------------+---+-------------------+ | 0 | 1 | 0 | | PDU session | | | | | | identity value 2 | +-------------------+---+-------------------+---+-------------------+ | 0 | 1 | 1 | | PDU session | | | | | | identity value 3 | +-------------------+---+-------------------+---+-------------------+ | 1 | 0 | 0 | | PDU session | | | | | | identity value 4 | +-------------------+---+-------------------+---+-------------------+ | 1 | 0 | 1 | | PDU session | | | | | | identity value 5 | +-------------------+---+-------------------+---+-------------------+ | 1 | 1 | 0 | | PDU session | | | | | | identity value 6 | +-------------------+---+-------------------+---+-------------------+ | 1 | 1 | 1 | | PDU session | | | | | | identity value 7 | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | Downlink data | | | | | | expected (DDX) | | | | | | (octet 3, bits 5 | | | | | | to 6) | | | | | +-------------------+---+-------------------+---+-------------------+ | Bits | | | | | +-------------------+---+-------------------+---+-------------------+ | 5 | 4 | | | | +-------------------+---+-------------------+---+-------------------+ | 0 | 0 | No information | | | | | | available | | | +-------------------+---+-------------------+---+-------------------+ | 0 | 1 | No further uplink | | | | | | and no further | | | | | | downlink data | | | | | | transmission | | | | | | subsequent to the | | | | | | uplink data | | | | | | transmission is | | | | | | expected | | | +-------------------+---+-------------------+---+-------------------+ | 1 | 0 | Only a single | | | | | | downlink data | | | | | | transmission and | | | | | | no further uplink | | | | | | data transmission | | | | | | subsequent to the | | | | | | uplink data | | | | | | transmission is | | | | | | expected | | | +-------------------+---+-------------------+---+-------------------+ | 1 | 1 | Reserved | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | NOTE: The DDX | | | | | | field is only | | | | | | used in the UE to | | | | | | network | | | | | | direction. | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | Data contents | | | | | | (octet 4 to octet | | | | | | 257) | | | | | | | | | | | | This field | | | | | | contains the | | | | | | control plane | | | | | | user data. | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | When the Data | | | | | | type is \"SMS\", | | | | | | Bits 1 to 5 of | | | | | | octet 3 are spare | | | | | | and shall be | | | | | | coded as zero. | | | | | +-------------------+---+-------------------+---+-------------------+ | Data contents | | | | | | (octet 4 to octet | | | | | | 257) | | | | | | | | | | | | This field | | | | | | contains an SMS | | | | | | message. | | | | | | | | | | | | When the Data | | | | | | type is | | | | | | \"Location | | | | | | services message | | | | | | container\": | | | | | | | | | | | | Downlink data | | | | | | expected (DDX) | | | | | | (octet 3, bits 5 | | | | | | to 4) | | | | | | | | | | | | This field is | | | | | | encoded as | | | | | | described above | | | | | | for the case when | | | | | | the Data type is | | | | | | \"Control plane | | | | | | user data\". | | | | | | | | | | | | Bits 3 to 1 of | | | | | | octet 3 are spare | | | | | | and shall be | | | | | | encoded as zero. | | | | | | | | | | | | Length of | | | | | | Additional | | | | | | information | | | | | | (octet 4) (see | | | | | | NOTE) | | | | | | | | | | | | Indicates the | | | | | | length, in | | | | | | octets, of the | | | | | | Additional | | | | | | information | | | | | | field. | | | | | | | | | | | | Additional | | | | | | information | | | | | | (octets 5 to m) | | | | | | | | | | | | Contains | | | | | | additional | | | | | | information if | | | | | | provided by the | | | | | | upper layer | | | | | | location services | | | | | | application. | | | | | | | | | | | | Data contents | | | | | | (octets m+1 to n) | | | | | | | | | | | | Contains the | | | | | | location services | | | | | | message payload. | | | | | +-------------------+---+-------------------+---+-------------------+ | | | | | | +-------------------+---+-------------------+---+-------------------+ | NOTE: The Length | | | | | | of Additional | | | | | | information shall | | | | | | be set to zero if | | | | | | the upper layer | | | | | | location service | | | | | | application does | | | | | | not provide | | | | | | routing | | | | | | information. | | | | | +-------------------+---+-------------------+---+-------------------+
#### 9.11.3.18C Ciphering key data
The purpose of the _Ciphering key data_ information element is to transfer a
list of ciphering data sets from the network to the UE for deciphering of
ciphered assistance data.
The _Ciphering key data_ information element is coded as shown in figure
9.11.3.18C.1, figure 9.11.3.18C.2 and table 9.11.3.18C.1.
The _Ciphering key data_ is a type 6 information element, with a minimum
length of 34 octets and a maximum length of 2675 octets. The list can contain
a maximum of 16 ciphering data sets.
+---------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------------------------+-------------+---+---+---+---+---+---+---+ | Ciphering key data IEI | octet 1 | | | | | | | | +---------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of ciphering key data contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +---------------------------------------+-------------+---+---+---+---+---+---+---+ | Ciphering data set 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet i | | | | | | | | +---------------------------------------+-------------+---+---+---+---+---+---+---+ | Ciphering data set 2 | octet i+1* | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +---------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +---------------------------------------+-------------+---+---+---+---+---+---+---+ | Ciphering data set p | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +---------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.18C.1: Ciphering key data information element
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Ciph | octet | | | | | | | | | ering | 1 | | | | | | | | | set | | | | | | | | | | ID | octet | | | | | | | | | | 2 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Ciph | octet | | | | | | | | | ering | 3 | | | | | | | | | key | | | | | | | | | | | octet | | | | | | | | | | 18 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | c0 | octet | | | | | | | | | l | 19 | | | | | | | | | ength | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | c0 | octet | | | | | | | | | | 20 | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | k | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | E | octet | | | | | | | | | -UTRA | k+1 | | | | | | | | | p | | | | | | | | | | osSIB | | | | | | | | | | l | | | | | | | | | | ength | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | Pos | Pos | Pos | Pos | Pos | Pos | Pos | octet | | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | k+2 | | pe1-1 | pe1-2 | pe1-3 | pe1-4 | pe1-5 | pe1-6 | pe1-7 | pe1-8 | | | | | | | | | | | octet | | | | | | | | | | k+3 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | Pos | Pos | Pos | Pos | Pos | Pos | Pos | | | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | | | pe2-1 | pe2-2 | pe2-3 | pe2-4 | pe2-5 | pe2-6 | pe2-7 | pe2-8 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | PosS | PosS | PosS | PosS | PosS | PosS | PosS | | | SIBTy | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | | | pe2-9 | e2-10 | e2-11 | e2-12 | e2-13 | e2-14 | e2-15 | e2-16 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PosS | PosS | PosS | PosS | PosS | PosS | PosS | PosS | | | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | | | e2-17 | e2-18 | e2-19 | e2-20 | e2-21 | e2-22 | e2-23 | e2-24 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PosS | Pos | Pos | Pos | 0 | 0 | 0 | 0 | octet | | IBTyp | SIBTy | SIBTy | SIBTy | | | | | p | | e2-25 | pe3-1 | pe4-1 | pe5-1 | Spare | Spare | Spare | Spare | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | NR | octet | | | | | | | | | p | p+1 | | | | | | | | | osSIB | | | | | | | | | | l | | | | | | | | | | ength | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | Pos | Pos | Pos | Pos | Pos | Pos | Pos | octet | | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | p+2 | | pe1-1 | pe1-2 | pe1-3 | pe1-4 | pe1-5 | pe1-6 | pe1-7 | pe1-8 | | | | | | | | | | | octet | | | | | | | | | | p+3 | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | q | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | Pos | Pos | Pos | Pos | Pos | Pos | Pos | | | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | | | pe2-1 | pe2-2 | pe2-3 | pe2-4 | pe2-5 | pe2-6 | pe2-7 | pe2-8 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | PosS | PosS | PosS | PosS | PosS | PosS | PosS | | | SIBTy | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | | | pe2-9 | e2-10 | e2-11 | e2-12 | e2-13 | e2-14 | e2-15 | e2-16 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PosS | PosS | PosS | PosS | PosS | PosS | PosS | Pos | | | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | IBTyp | SIBTy | | | e2-17 | e2-18 | e2-19 | e2-20 | e2-21 | e2-22 | e2-23 | pe3-1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Pos | Pos | Pos | Pos | Pos | 0 | 0 | 0 | | | SIBTy | SIBTy | SIBTy | SIBTy | SIBTy | | | | | | pe4-1 | pe5-1 | pe6-1 | pe6-2 | pe6-3 | Spare | Spare | Spare | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Val | octet | | | | | | | | | idity | q+1 | | | | | | | | | start | | | | | | | | | | time | octe | | | | | | | | | | q+5 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Val | octet | | | | | | | | | idity | q+6 | | | | | | | | | dur | | | | | | | | | | ation | octet | | | | | | | | | | q+7 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | TAIs | octet | | | | | | | | | list | q+8 | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | r | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.18C.2: Ciphering data set
Table 9.11.3.18C.1: Ciphering key data information element
+----------------------------+---+---+---+----------------------------+ | Value part of the | | | | | | Ciphering key data | | | | | | information element | | | | | | (octets 4 to n) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | The value part of the | | | | | | Ciphering key data | | | | | | information element | | | | | | consists of one or several | | | | | | ciphering data sets. | | | | | +----------------------------+---+---+---+----------------------------+ | The UE shall store the | | | | | | complete list received. If | | | | | | more than 16 ciphering | | | | | | data sets are included in | | | | | | this information element, | | | | | | the UE shall store the | | | | | | first 16 ciphering data | | | | | | sets and ignore the | | | | | | remaining octets of the | | | | | | information element. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set: | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering set ID (octets 1 | | | | | | to 2) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | This field contains the | | | | | | binary encoding of the ID | | | | | | identifying the ciphering | | | | | | set. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering key (octets 3 to | | | | | | octet 18) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | This field contains the | | | | | | 128 bit ciphering key. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | c0 length (octet 19, bits | | | | | | 5 to 1) | | | | | | | | | | | | This field contains the | | | | | | binary encoding of the | | | | | | length, in octets, of the | | | | | | c0 counter. The maximum | | | | | | value for the length of | | | | | | the c0 counter is 16 | | | | | | octets. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Bits 8 to 6 of octect 19 | | | | | | are spare and shall be | | | | | | coded as zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | c0 (octets 20 to k) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | This field contains the | | | | | | binary encoding of the c0 | | | | | | counter. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | E-UTRA posSIB length | | | | | | (octet k+1, bits 4 to 1) | | | | | | | | | | | | This field contains the | | | | | | length in octets of the E | | | | | | -UTRA Positioning SIB | | | | | | types. A length of zero | | | | | | means E -UTRA Positioning | | | | | | SIB types are not included | | | | | | (see NOTE). | | | | | | | | | | | | E-UTRA Positioning SIB | | | | | | types for which the | | | | | | ciphering data set is | | | | | | applicable (octets k+2 to | | | | | | p). Unassigned bits shall | | | | | | be ignored by a UE. | | | | | | Non-included bits shall be | | | | | | assumed to be zero by a | | | | | | UE. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-1 (octet k+2, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-2 (octet k+2, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-2 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-2 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-3 (octet k+2, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-3 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-3 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-4 (octet k+2, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-4 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-4 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-5 (octet k+2, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-5 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-5 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-6 (octet k+2, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-6 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-6 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-7 (octet k+2, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-7 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-7 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-8 (octet k+2, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-8 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-8 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-1 (octet k+3, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-2 (octet k+3, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-2 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-2 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-3 (octet k+3, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-3 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-3 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-4 (octet k+3, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-4 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-4 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-5 (octet k+3, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-5 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-5 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-6 (octet k+3, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-6 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-6 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-7 (octet k+3, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-7 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-7 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-8 (octet k+3, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-8 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-8 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-9 (octet k+4, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-9 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-9 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-10 (octet k+4, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-10 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-10 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-11 (octet k+4, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-11 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-11 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-12 (octet k+4, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-12 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-12 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-13 (octet k+4, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-13 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-13 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-14 (octet k+4, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-14 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-14 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-15 (octet k+4, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-15 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-15 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-16 (octet k+4, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-16 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-16 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-17 (octet k+5, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-17 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-17 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-18 (octet k+5, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-18 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-18 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-19 (octet k+5, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-19 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-19 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-20 (octet k+5, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-20 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-20 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-21 (octet k+5, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-21 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-21 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-22 (octet k+5, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-22 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-22 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-23 (octet k+5, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-23 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-23 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-24 (octet k+5, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-24 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-24 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-25 (octet k+6, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-25 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-25 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 3-1 (octet k+6, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 3-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 3-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 4-1 (octet k+6, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 4-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 4-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 5-1 (octet k+6, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 5-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 5-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Any unassigned bits shall | | | | | | be coded as zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NR posSIB length (octet | | | | | | p+1, bits 4 to 1) | | | | | | | | | | | | This field contains the | | | | | | length in octets of the NR | | | | | | Positioning SIB types. A | | | | | | length of zero means NR | | | | | | Positioning SIB types are | | | | | | not included (see NOTE). | | | | | | | | | | | | NR Positioning SIB types | | | | | | for which the ciphering | | | | | | data set is applicable | | | | | | (octets p+2 to q). | | | | | | Unassigned bits shall be | | | | | | ignored. Non-included bits | | | | | | shall be assumed to be | | | | | | zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-1 (octet p+2, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-2 (octet p+2, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-2 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-2 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-3 (octet p+2, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-3 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-3 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-4 (octet p+2, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-4 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-4 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-5 (octet p+2, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-5 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-5 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-6 (octet p+2, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-6 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-6 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-7 (octet p+2, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-7 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-7 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 1-8 (octet p+2, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 1-8 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 1-8 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-1 (octet p+3, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-2 (octet p+3, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-2 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-2 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-3 (octet p+3, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-3 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-3 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-4 (octet p+3, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-4 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-4 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-5 (octet p+3, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-5 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-5 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-6 (octet p+3, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-6 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-6 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-7 (octet p+3, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-7 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-7 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-8 (octet p+3, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-8 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-8 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-9 (octet p+4, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-9 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-9 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-10 (octet p+4, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-10 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-10 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-11 (octet p+4, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-11 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-11 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-12 (octet p+4, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-12 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-12 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-13 (octet p+4, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-13 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-13 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-14 (octet p+4, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-14 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-14 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-15 (octet p+4, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-15 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-15 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-16 (octet p+4, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-16 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-16 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-17 (octet p+5, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-17 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-17 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-18 (octet p+5, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-18 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-18 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-19 (octet p+5, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-19 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-19 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-20 (octet p+5, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-20 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-20 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-21 (octet p+5, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-21 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-21 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-22 (octet p+5, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-22 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-22 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 2-23 (octet p+5, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 2-23 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 2-23 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 3-1 (octet p+5, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 3-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 3-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 4-1 (octet p+6, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 4-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 4-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 5-1 (octet p+6, | | | | | | bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 5-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 5-1 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 6-1 (octet p+6, | | | | | | bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 6-1 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 6-1 | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 6-2 (octet p+6, | | | | | | bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 6-2 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 6-3 | +----------------------------+---+---+---+----------------------------+ | Ciphering data set | | | | | | applicable for positioning | | | | | | SIB type 6-3 (octet p+6, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ciphering data set not | | | | | | applicable to positioning | | | | | | SIB type 6-3 | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ciphering data set | | | | | | applicable to positioning | | | | | | SIB type 6-3 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Any unassigned bits shall | | | | | | be coded as zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Validity start time | | | | | | (octets q+1 to q+5) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | This field contains the | | | | | | UTC time when the | | | | | | ciphering data set becomes | | | | | | valid, encoded as octets 2 | | | | | | to 6 of the Time zone and | | | | | | time IE specified in | | | | | | 3GPP TS 24.008 [12]. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Validity duration (octets | | | | | | q+6 to q+7) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | This field contains the | | | | | | duration for which the | | | | | | ciphering data set is | | | | | | valid after the validity | | | | | | start time, in units of | | | | | | minutes. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | TAIs list (octets q+8 to | | | | | | r) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | This field contains the | | | | | | list of tracking areas for | | | | | | which the ciphering data | | | | | | set is applicable, encoded | | | | | | as octets 2 to n of the | | | | | | Tracking area identity | | | | | | list IE as specified in | | | | | | subclause 9.11.3.9. If the | | | | | | TAIs list is empty (as | | | | | | indicated by a zero | | | | | | length), the ciphering | | | | | | data set is applicable to | | | | | | the entire serving PLMN. | | | | | | | | | | | | NOTE: The ciphering data | | | | | | set is always applicable | | | | | | to at least one of the E | | | | | | -UTRA Positioning SIB | | | | | | types or the NR | | | | | | Positioning SIB types. | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.18D Control plane service type
The purpose of the Control plane service type information element is to
specify the purpose of the CONTROL PLANE SERVICE REQUEST message.
The Control plane service type information element is coded as shown in figure
9.11.3.18D.1 and table 9.11.3.18D.1.
The Control plane service type is a type 1 information element.
+----------------------------+-------+----------------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +============================+=======+============================+=========+===+===+===+===+===+ | Control plane service type | 0 | Control plane service type | octet 1 | | | | | | | | | | | | | | | | | IEI | Spare | value | | | | | | | +----------------------------+-------+----------------------------+---------+---+---+---+---+---+
Figure 9.9.3.18D.1: Control plane service type information element
Table 9.9.3.18D.1: Control plane service type information element
Control plane service type value (octet 1, bit 1 to 3)
* * *
Bits  
3 2 1  
0 0 0 mobile originating request 0 0 1 mobile terminating request 0 1 0
emergency services 0 1 1 emergency services fallback 1 0 0  
to unused; shall be interpreted as \" mobile originating request\", if
received by the network. 1 1 1
#### 9.11.3.19 Daylight saving time
See subclause 10.5.3.12 in 3GPP TS 24.008 [12].
#### 9.11.3.20 De-registration type
The purpose of the D _e-registration type_ information element is to indicate
the type of de-registration.
The D _e-registration type_ information element is coded as shown in figure
9.11.3.20.1 and table 9.11.3.20.1.
The D _e-registration type_ is a type 1 information element.
+----------------------+--------+--------------------------+-------------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------+--------+--------------------------+-------------+---------+---+---+---+---+ | De-registration type | Switch | Re-registration required | Access type | octet 1 | | | | | | | | | | | | | | | | IEI | off | | | | | | | | +----------------------+--------+--------------------------+-------------+---------+---+---+---+---+
Figure 9.11.3.20.1: Deregistration type information element
Table 9.11.3.20.1: _Deregistration_ type information element
* * *
Switch off (octet 1, bit 4)  
In the UE to network direction:  
Bit  
4  
0 Normal de-registration 1 Switch off
In the network to UE direction bit 4 is spare. The network shall set this bit
to zero.
Re-registration required (octet 1, bit 3)
In the network to UE direction:  
Bit  
3  
0 re-registration not required 1 re-registration required
In the UE to network direction bit 3 is spare. The UE shall set this bit to
zero.
Access type (octet 1,bit 2, bit 1)  
Bit  
2 1  
0 1 3GPP access 1 0 Non-3GPP access 1 1 3GPP access and non-3GPP access
All other values are reserved.
* * *
#### 9.11.3.21 Void
#### 9.11.3.22 Void
#### 9.11.3.23 Emergency number list
See subclause 10.5.3.13 in 3GPP TS 24.008 [12].
#### 9.11.3.23A EPS bearer context status
See subclause 9.9.2.1 in 3GPP TS 24.301 [15].
#### 9.11.3.24 EPS NAS message container
The purpose of the EPS NAS message container information element is to
transport an EPS NAS message as specified in 3GPP TS 24.301 [15].
The EPS NAS message container information element is coded as shown in figure
9.11.3.24.1 and table 9.11.3.24.1.
The EPS NAS message container is a type 6 information element.
+----------------------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------+---------+---+---+---+---+---+---+---+ | EPS NAS message container IEI | octet 1 | | | | | | | | +----------------------------------------------+---------+---+---+---+---+---+---+---+ | Length of EPS NAS message container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------------+---------+---+---+---+---+---+---+---+ | EPS NAS message container | octet 4 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +----------------------------------------------+---------+---+---+---+---+---+---+---+
Figure 9.11.3.24.1: EPS NAS message container information element
Table 9.11.3.24.1: EPS NAS message container information element
* * *
EPS NAS message container (octet 4 to n) An EPS NAS message as specified in
3GPP TS 24.301 [15].
* * *
#### 9.11.3.25 EPS NAS security algorithms
See subclause 9.9.3.23 in 3GPP TS 24.301 [15].
#### 9.11.3.26 Extended emergency number list
See subclause 9.9.3.37A in 3GPP TS 24.301 [15].
#### 9.11.3.26A Extended DRX parameters
See subclause 10.5.5.32 in 3GPP TS 24.008 [12].
#### 9.11.3.27 Void
#### 9.11.3.28 IMEISV request
See subclause 10.5.5.10 in 3GPP TS 24.008 [12].
#### 9.11.3.29 LADN indication
The purpose of the LADN indication information element is to request the
network for LADN information for specific LADN DNN(s) or to indicate a request
for LADN information.
The LADN indication information element is coded as shown in figure
9.11.3.29.1 and table 9.11.3.29.1.
The LADN indication is a type 6 information element with a minimum length of 3
octets and a maximum length of 811 octets.
The LADN indication information element can contain a minimum of 0 and a
maximum of 8 different LADN DNN values.
+------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN indication IEI | octet 1 | | | | | | | | +------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of LADN indication contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN DNN value 1 | octet 4* | | | | | | | | | | | | | | | | | | | | octet a* | | | | | | | | +------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN DNN value 2 | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | octet g* | | | | | | | | +------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN DNN value n | octet g+1* | | | | | | | | | | | | | | | | | | | | octet h* | | | | | | | | +------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.29.1: LADN indication information element
Table 9.11.3.29.1: LADN indication information element
+----------------------------------------------------------------------+ | Value part of the LADN indication information element (octet 4 to | | h): | | | | The value part of the LADN indication information element consists | | of zero or more LADN DNN values. If the LADN indication information | | element conveys more than 8 LADN DNN values in this information | | element, the network shall consider the first 8 LADN DNN values and | | ignore the remaining octets of the information element. | | | | LADN DNN value: | | | | LADN DNN value is coded as the length and value part of DNN | | information element as specified in subclause 9.11.2.1B starting | | with the second octet. | +----------------------------------------------------------------------+
#### 9.11.3.30 LADN information
The purpose of the LADN information information element is to provide the UE
with the LADN service area for each available LADN in the current registration
area or to delete the LADN information at the UE.
The LADN information information element is coded as shown in figure
9.11.3.30.1, figure 9.11.3.30.2 and table 9.11.3.30.1.
The LADN information is a type 6 information element with a minimum length of
3 octets and a maximum length of 1715 octets.
The LADN information information element can contain a minimum of 0 and a
maximum of 8 different LADNs each including a DNN and a 5GS tracking area
identity list.
+-------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN information IEI | octet 1 | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of LADN information contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN 2 | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | octet g* | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | LADN n | octet g+1* | | | | | | | | | | | | | | | | | | | | octet h* | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.30.1: LADN information information element
+---------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=================================+===========+===+===+===+===+===+===+===+ | Length of DNN value | octet 4 | | | | | | | | +---------------------------------+-----------+---+---+---+---+---+---+---+ | DNN value | octet 5 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +---------------------------------+-----------+---+---+---+---+---+---+---+ | 5GS tracking area identity list | octet m+1 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +---------------------------------+-----------+---+---+---+---+---+---+---+
Figure 9.11.3.30.2: LADN
Table 9.11.3.30.1: LADN information information element
+----------------------------------------------------------------------+ | Value part of the LADN information information element (octet 4 to | | octet h) | | | | The value part of the LADN information information element consists | | of one or several LADNs. Each LADN (e.g. octet 4 to octet a) | | consists one DNN value and one 5GS tracking area identity list. The | | length of each LADN is determined by the length of DNN value field | | and the length of 5GS tracking area identity list field. | | | | The UE shall store the complete list as received. If more than 8 | | LADNs are included in this information element, the UE shall store | | the first 8 LADNs and ignore the remaining octets of the information | | element. | | | | DNN value (octet 5 to octet m): | | | | DNN value field is coded as DNN value part of DNN information | | element as specified in subclause 9.11.2.1B starting with the third | | octet. | +----------------------------------------------------------------------+ | 5GS tracking area identity list (octet m+1 to octet a): | +----------------------------------------------------------------------+ | 5GS tracking area identity list field is coded as the length and the | | value part of the 5GS Tracking area identity list information | | element as specified in subclause 9.11.3.9 starting with the second | | octet. | +----------------------------------------------------------------------+
#### 9.11.3.31 MICO indication
The purpose of the MICO indication information element is to indicate the use
of MICO mode or the re-negotiation of MICO mode.
The MICO indication information element is coded as shown in figure
9.11.3.31.1 and table 9.11.3.31.1.
The MICO indication is a type 1 information element.
+---------------------+-------+-------+-------+------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=====================+=======+=======+=======+======+=========+===+===+===+ | MICO indication IEI | 0 | 0 | SPRTI | RAAI | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | | | | | | | +---------------------+-------+-------+-------+------+---------+---+---+---+
Figure 9.11.3.31.1: MICO indication
Table 9.11.3.31.1: MICO indication
+----------------------------------+----------------------------------+ | Registration Area Allocation | | | Indication (RAAI) (octet 1, bit | | | 1) | | +==================================+==================================+ | | | +----------------------------------+----------------------------------+ | In the network to UE direction: | | +----------------------------------+----------------------------------+ | Bit | | +----------------------------------+----------------------------------+ | 1 | | +----------------------------------+----------------------------------+ | 0 | all PLMN registration area not | | | allocated | +----------------------------------+----------------------------------+ | 1 | all PLMN registration area | | | allocated | +----------------------------------+----------------------------------+ | In the UE to network direction | | | bit 1 is spare. The UE shall set | | | this bit to zero. | | +----------------------------------+----------------------------------+ | Strictly Periodic Registration | | | Timer Indication (SPRTI) (octet | | | 1, bit 2) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | In the network to UE and the UE | | | to network direction: | | +----------------------------------+----------------------------------+ | Bit | | +----------------------------------+----------------------------------+ | 2 | | +----------------------------------+----------------------------------+ | 0 | strictly periodic registration | | | timer not supported | +----------------------------------+----------------------------------+ | 1 | strictly periodic registration | | | timer supported | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Bits 3 and 4 are spare and shall | | | be coded as zero. | | | | | | NOTE: In the network to UE | | | direction in the CONFIGURATION | | | UPDATE COMMAND message, bits 1 | | | and 2 shall be coded as zero. | | +----------------------------------+----------------------------------+
#### 9.11.3.31A MA PDU session information
The purpose of the MA PDU session information information element is to convey
the MA-related information for the PDU session.
The MA PDU session information information element is coded as shown in figure
9.11.3.31A.1 and table 9.11.3.31A.1.
The MA PDU session information is a type 1 information element.
* * *
8 7 6 5 4 3 2 1  
MA PDU session information IEI MA PDU session information value octet 1
* * *
Figure 9.11.3.31A.1: MA PDU session information information element
Table 9.11.3.31A.1: MA PDU session information information element
MA PDU session information value (octet 1, bit 1 to bit 4)
* * *
Bits  
4 3 2 1  
0 0 0 0 No additional information 0 0 0 1 MA PDU session network upgrade is
allowed All other values are spare. If received they shall be ignored.
#### 9.11.3.31B Mapped NSSAI
The purpose of the Mapped NSSAI information element is to transfer S-NSSAI(s)
applicable in the HPLMN to the visited PLMN.
The Mapped NSSAI information element is coded as shown in figure 9.11.3.31B.1,
figure 9.11.3.31B.2 and table 9.11.3.31B.1.
The Mapped NSSAI is a type 4 information element with a minimum length of 4
octets and a maximum length of 42 octets.
NOTE 1: The total number of S-NSSAI values in a requested mapped NSSAI cannot
exceed eight.
* * *
8 7 6 5 4 3 2 1
* * *
Mapped NSSAI IEI octet 1
Length of Mapped NSSAI contents octet 2
Mapped S-NSSAI content 1 octet 3\  
\  
octet m
Mapped S-NSSAI content 2 octet m+1*\  
\  
octet n*
... octet n+1*\  
\  
octet u*
Mapped S-NSSAI content n octet u+1*\  
\  
octet v*
* * *
Figure 9.11.3.31B.1: Mapped NSSAI information element
+----------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==================================+===========+===+===+===+===+===+===+===+ | Length of Mapped S-NSSAI content | octet 3 | | | | | | | | +----------------------------------+-----------+---+---+---+---+---+---+---+ | Mapped HPLMN SST | octet 4 | | | | | | | | +----------------------------------+-----------+---+---+---+---+---+---+---+ | Mapped HPLMN SD | octet 5* | | | | | | | | | | | | | | | | | | | | octet 7* | | | | | | | | +----------------------------------+-----------+---+---+---+---+---+---+---+
Figure 9.11.3.31B.2: Mapped S-NSSAI content
Table 9.11.3.31B.1: Mapped NSSAI information element
+----------------------------------------------------------------------+ | Value part of the Mapped NSSAI information element (octet 3 to v) | | | | The value part of the Mapped NSSAI information element consists of | | one or more mapped S-NSSAI contents. | | | | Mapped S-NSSAI content: | | | | Length of S-NSSAI contents (octet 3) | | | | Mapped HPLMN Slice/service type (SST) (octet 4) | | | | This field contains the 8 bit SST value of an S-NSSAI in the | | S-NSSAI(s) of the HPLMN to which the SST value is mapped. The coding | | of the SST value part is defined in 3GPP TS 23.003 [4]. | | | | NOTE 1: Octet 4 (i.e. mapped HPLMN SST) shall always be included. | | | | Mapped HPLMN Slice differentiator (SD) (octet 5 to octet 7) | | | | This field contains a 24-bit SD value of an S-NSSAI in the | | S-NSSAI(s) of the HPLMN to which the SD value is mapped. The coding | | of the SD value part is defined in 3GPP TS 23.003 [4]. | | | | NOTE 2: If the octet 5 is included, then octet 6 and octet 7 shall | | be included. | +----------------------------------------------------------------------+
#### 9.11.3.31C Mobile station classmark 2
See subclause 10.5.1.6 in 3GPP TS 24.008 [12].
#### 9.11.3.32 NAS key set identifier
The NAS key set identifier is allocated by the network.
The NAS key set identifier information element is coded as shown in figure
9.11.3.32.1 and table 9.11.3.32.1.
The NAS key set identifier is a type 1 information element.
* * *
8 7 6 5 4 3 2 1  
NAS key set identifier IEI TSC NAS key set identifier octet 1
* * *
Figure 9.11.3.32.1: NAS key set identifier information element
Table 9.11.3.32.1: NAS key set identifier information element
* * *
Type of security context flag (TSC) (octet 1)
Bit  
4  
0 native security context (for KSI~AMF~) 1 mapped security context (for
KSI~ASME~)
TSC does not apply for NAS key set identifier value \"111\".
NAS key set identifier (octet 1)
Bits  
3 2 1  
0 0 0  
through possible values for the NAS key set identifier  
1 1 0
1 1 1 no key is available (UE to network); reserved (network to UE)
* * *
#### 9.11.3.33 NAS message container
The purpose of the NAS message container IE is to encapsulate a plain 5GS NAS
REGISTRATION REQUEST or SERVICE REQUEST message, or to encapsulate non-
cleartext IEs of a CONTROL PLANE SERVICE REQUEST message.
The NAS message container information element is coded as shown in figure
9.11.3.33.1 and table 9.11.3.33.1.
The NAS message container is a type 6 information element.
* * *
8 7 6 5 4 3 2 1  
NAS message container IEI octet 1  
Length of NAS message container contents octet 2  
octet 3  
octet 4  
NAS message container contents  
octet n
* * *
Figure 9.11.3.33.1: NAS message container information element
Table 9.11.3.33.1: NAS message container information element
* * *
NAS message container contents (octet 4 to octet n); Max value of 65535 octets
This IE can contain a REGISTRATION REQUEST message as defined in subclause
5.5.1, or a SERVICE REQUEST message as defined in subclause 5.6.1, or non-
cleartext IEs of a CONTROL PLANE SERVICE REQUEST message as defined in
subclause 5.6.1.
* * *
#### 9.11.3.34 NAS security algorithms
The purpose of the NAS security algorithms information element is to indicate
the 5G algorithms to be used for ciphering and integrity protection.
The NAS security algorithms information element is coded as shown in figure
9.11.3.34.1 and table 9.11.3.34.1.
The NAS security algorithms is a type 3 information element with a length of 2
octets.
* * *
8 7 6 5 4 3 2 1  
NAS security algorithms IEI octet 1  
Type of ciphering algorithm Type of integrity protection algorithm octet 2
* * *
Figure 9.11.3.34.1: NAS security algorithms information element
Table 9.11.3.34.1: NAS security algorithms information element
* * *
Type of integrity protection algorithm (octet 2, bit 1 to 3)  
Bits  
4 3 2 1  
0 0 0 0 5G integrity algorithm 5G-IA0 (null integrity protection algorithm) 0
0 0 1 5G integrity algorithm 128-5G-IA1 0 0 1 0 5G integrity algorithm
128-5G-IA2 0 0 1 1 5G integrity algorithm 128-5G-IA3 0 1 0 0 5G integrity
algorithm 5G-IA4 0 1 0 1 5G integrity algorithm 5G-IA5 0 1 1 0 5G integrity
algorithm 5G-IA6 0 1 1 1 5G integrity algorithm 5G-IA7
All other values are reserved.
Type of ciphering algorithm (octet 2, bit 5 to 7)  
Bits  
8 7 6 5  
0 0 0 0 5G encryption algorithm 5G-EA0 (null ciphering algorithm) 0 0 0 1 5G
encryption algorithm 128-5G-EA1 0 0 1 0 5G encryption algorithm 128-5G-EA2 0 0
1 1 5G encryption algorithm 128-5G-EA3 0 1 0 0 5G encryption algorithm 5G-EA4
0 1 0 1 5G encryption algorithm 5G-EA5 0 1 1 0 5G encryption algorithm 5G-EA6
0 1 1 1 5G encryption algorithm 5G-EA7
All other values are reserved.
* * *
#### 9.11.3.35 Network name
See subclause 10.5.3.5a in 3GPP TS 24.008 [12].
#### 9.11.3.36 Network slicing indication
The purpose of the Network slicing indication information element is to
indicate additional information associated with network slicing in the generic
UE configuration update procedure and the registration procedure, other than
the user\'s configured NSSAI, allowed NSSAI, pending NSSAI and rejected NSSAI
information.
The Network slicing indication information element is coded as shown in figure
9.11.3.36.1 and table 9.11.3.36.1.
The Network slicing indication is a type 1 information element.
+--------------------------------+-------+-------+------+-------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +================================+=======+=======+======+=======+=========+===+===+===+ | Network slicing indication IEI | 0 | 0 | DCNI | NSSCI | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | | | | | | | +--------------------------------+-------+-------+------+-------+---------+---+---+---+
Figure 9.11.3.36.1: Network slicing indication
Table 9.11.3.36.1: Network slicing indication
+----------------------------------+----------------------------------+ | Network slicing subscription | | | change indication (NSSCI) (octet | | | 1, bit 1) | | +==================================+==================================+ | Bit | | +----------------------------------+----------------------------------+ | 1 | | +----------------------------------+----------------------------------+ | 0 | Network slicing subscription not | | | changed | +----------------------------------+----------------------------------+ | 1 | Network slicing subscription | | | changed | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Default configured NSSAI | | | indication (DCNI) (octet 1, bit | | | 2) | | +----------------------------------+----------------------------------+ | Bit | | +----------------------------------+----------------------------------+ | 2 | | +----------------------------------+----------------------------------+ | 0 | Requested NSSAI not created from | | | default configured NSSAI | +----------------------------------+----------------------------------+ | 1 | Requested NSSAI created from | | | default configured NSSAI | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | In the UE to network direction | | | bit 1 is spare. The UE shall set | | | this bit to zero. | | | | | | In the network to UE direction | | | bit 2 is spare. The network | | | shall set this bit to zero. | | | | | | Bits 3 and 4 are spare and shall | | | be coded as zero. | | +----------------------------------+----------------------------------+
#### 9.11.3.36A Non-3GPP NW provided policies
See subclause 10.5.5.37 in 3GPP TS 24.008 [12].
#### 9.11.3.37 NSSAI
The purpose of the NSSAI information element is to identify a collection of
S-NSSAIs
The NSSAI information element is coded as shown in figure 9.11.3.37.1 and
table 9.11.3.37.1.
The NSSAI is a type 4 information element with a minimum length of 4 octets
and a maximum length of 146 octets.
NOTE: More than one S-NSSAIs in an NSSAI can have the same SST values, and
optionally same SD values, which are associated with different mapped HPLMN
SST values and optionally mapped HPLMN SD values.
* * *
8 7 6 5 4 3 2 1
* * *
NSSAI IEI octet 1
Length of NSSAI contents octet 2
S-NSSAI value 1 octet 3\  
\  
octet m
S-NSSAI value 2 octet m+1*\  
\  
octet n*
... octet n+1*\  
\  
octet u*
S-NSSAI value n octet u+1*\  
\  
octet v*
* * *
Figure 9.11.3.37.1: NSSAI information element
Table 9.11.3.37.1: NSSAI information element
+----------------------------------------------------------------------+ | Value part of the NSSAI information element (octet 3 to v) | | | | The value part of the NSSAI information element consists of one or | | more S-NSSAI values. Each S-NSSAI value consists of one S-NSSAI and | | optionally one mapped S-NSSAI. | | | | The recipient of this information element shall store the complete | | list received (NOTE 1, NOTE 2, NOTE 3). If the NSSAI information | | element conveys an allowed NSSAI and more than 8 S-NSSAI values are | | included in this information element, the UE shall store the first 8 | | S-NSSAI values and ignore the remaining octets of the information | | element. | | | | If the NSSAI information element conveys a configured NSSAI or | | pending NSSAI and more than 16 S-NSSAI values are included in this | | information element, the UE shall store the first 16 S-NSSAI values | | and ignore the remaining octets of the information element. | | | | S-NSSAI value: | | | | S-NSSAI value is coded as the length and value part of S-NSSAI | | information element as specified in subclause 9.11.2.8 starting with | | the second octet. | +======================================================================+ | NOTE 1: The total number of S-NSSAI values in a requested NSSAI | | shall not exceed eight. | | | | NOTE 2: The number of S-NSSAI values in an allowed NSSAI shall not | | exceed eight. | | | | NOTE 3: The number of S-NSSAI values in a configured NSSAI or | | pending NSSAI shall not exceed sixteen. | +----------------------------------------------------------------------+
#### 9.11.3.37A NSSAI inclusion mode
The purpose of the NSSAI inclusion mode information element is to indicate the
NSSAI inclusion mode in which the UE shall operate.
The NSSAI inclusion mode is a type 1 information element.
The NSSAI inclusion mode information element is coded as shown in figure
9.11.3.37A.1 and table 9.11.3.37A.1.
+----------------------+-------+-------+----------------------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------+-------+-------+----------------------+---------+---+---+---+---+ | NSSAI inclusion mode | 0 | 0 | NSSAI inclusion mode | octet 1 | | | | | | | | | | | | | | | | IEI | spare | spare | | | | | | | +----------------------+-------+-------+----------------------+---------+---+---+---+---+
Figure 9.11.3.37A.1: NSSAI inclusion mode information element
Table 9.11.3.37A.1: NSSAI inclusion mode information element
* * *
NSSAI inclusion mode (octet 1, bit 1 to bit 2)
Bits  
2 1  
0 0 NSSAI inclusion mode A 0 1 NSSAI inclusion mode B 1 0 NSSAI inclusion mode
C 1 1 NSSAI inclusion mode D
* * *
#### 9.11.3.38 Operator-defined access category definitions
The purpose of the Operator-defined access category definitions information
element is to provide the UE with the operator-defined access category
definitions or to delete the operator-defined access category definitions at
the UE.
The Operator-defined access category definitions information element is coded
as shown in figure 9.11.3.38.1, figure 9.11.3.38.2 and table 9.11.3.38.1.
The Operator-defined access category definitions is a type 6 information
element with a minimum length of 3 octets, and maximum length of 8323 octets.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Operator-defined | octet 1 | | | | | | | | | access category | | | | | | | | | | definitions IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of | octet 2 | | | | | | | | | operator-defined | | | | | | | | | | access category | octet 3 | | | | | | | | | definitions | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Operator-defined | octet 4* | | | | | | | | | access category | | | | | | | | | | definition 1 | octet a* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Operator-defined | octet a+1* | | | | | | | | | access category | | | | | | | | | | definition 2 | octet b* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | octet g* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Operator-defined | octet g+1* | | | | | | | | | access category | | | | | | | | | | definition n | octet h* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.38.1: Operator-defined access category definitions information
element
+----------+----------+-------+----------+----------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==========+==========+=======+==========+==========+===+===+===+===+ | Length | octet 4 | | | | | | | | | of | | | | | | | | | | operator | | | | | | | | | | -defined | | | | | | | | | | access | | | | | | | | | | category | | | | | | | | | | de | | | | | | | | | | finition | | | | | | | | | | contents | | | | | | | | | +----------+----------+-------+----------+----------+---+---+---+---+ | Pr | octet 5 | | | | | | | | | ecedence | | | | | | | | | | value | | | | | | | | | +----------+----------+-------+----------+----------+---+---+---+---+ | PSAC | 0 | 0 | Operator | octet 6 | | | | | | | | | -defined | | | | | | | | Spare | Spare | access | | | | | | | | | | category | | | | | | | | | | number | | | | | | +----------+----------+-------+----------+----------+---+---+---+---+ | Length | octet 7 | | | | | | | | | of | | | | | | | | | | criteria | | | | | | | | | +----------+----------+-------+----------+----------+---+---+---+---+ | Criteria | octet 8 | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | a-1 | | | | | | | | +----------+----------+-------+----------+----------+---+---+---+---+ | 0 | 0 | 0 | Stan | octet | | | | | | | | | dardized | a* | | | | | | Spare | Spare | Spare | access | | | | | | | | | | category | | | | | | +----------+----------+-------+----------+----------+---+---+---+---+
Figure 9.11.3.38.2: Operator-defined access category definition
Table 9.11.3.38.1: Operator-defined access category definitions information
element
Value part of the Operator-defined access category definitions information element (octet 4 to h) The value part of the Operator-defined access category definitions information element consists of zero or no more than 32 operator-defined access category definition fields. Each operator-defined access category definition field is coded as described in figure 9.11.3.38.2. The length of each operator-defined access category definition field is determined by the length of operator-defined access category definition contents field. |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
Operator-defined access category definition (octet 4 to octet a): |  |  |  |  |  |  |  |  |   
Length of operator-defined access category definition contents (octet 4) Length of operator-defined access category definition contents indicates binary coded length of the operator-defined access category definition value field (octet 5 to octet a). Precedence value (octet 5) |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |  | Precedence value 0  
to |  |  |  |  |  |  |  |  |   
1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 |  | Precedence value 255  
|  |  |  |  |  |  |  |  |   
Operator-defined access category number (bits 5 to 1 of octet 6) |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
5 | 4 | 3 | 2 | 1 |  |  |  |  |   
0 | 0 | 0 | 0 | 0 |  | Access category number 32 |  |  |   
to |  |  |  |  |  |  |  |  |   
1 | 1 | 1 | 1 | 1 |  | Access category number 63 |  |  |   
|  |  |  |  |  |  |  |  |   
Presence of standardized access category (PSAC) (bit 8 of octet 6) |  |  |  |  |  |  |  |  |   
PSAC field indicates whether the standardized access category field is present or absent. |  |  |  |  |  |  |  |  |   
Bit |  |  |  |  |  |  |  |  |   
8 |  |  |  |  |  |  |  |  |   
0 | Standardized access category field is not included |  |  |  |  |  |  |  |   
1 | Standardized access category field is included |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Length of criteria (octet 7) |  |  |  |  |  |  |  |  |   
Length of criteria field indicates binary coded length of the criteria field. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Criteria (octets 8 to octet a-1) |  |  |  |  |  |  |  |  |   
The criteria field contains one or more criteria components fields. Each criteria component field shall be encoded as a sequence of a one octet criteria type field and zero or more octets criteria value field. The criteria type field shall be transmitted first. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Criteria type |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |  | DNN type  
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | OS id + OS App Id type  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | S-NSSAI type  
All other values are reserved. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For "DNN type", the criteria value field shall be encoded as a sequence of one octet DNN length-value pair count field and one or more DNN length-value pair fields. The DNN length-value pair count field indicates the number of included DNN length-value pair fields. Each DNN length-value pair field is coded as a sequence of one octet DNN value length field and a DNN value field. The DNN value length field indicates the length in octets of the DNN value field. The DNN value field contains an APN as specified in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For "OS Id + OS App Id type", the criteria value field shall be encoded as a sequence of one octet app id value count field and one or more app id value fields. The app id value count field indicates the number of included app id value fields. Each app id value field is coded as a sequence of a sixteen octet OS id value field, one octet OS app id value length field and an OS app id value field. The OS app id value length field indicates the length in octets of the OS app id value field. The OS id value field contains a Universally Unique IDentifier (UUID) as specified in IETF RFC 4122 [35A]. The OS app id value field contains an OS specific application identifier. Coding of the OS app id value field is outside the scope of the present document. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
For "S-NSSAI type", the criteria value field shall be encoded as a sequence of one octet S-NSSAI length-value pair count field and one or more S-NSSAI length-value value fields. The S-NSSAI length-value pair count field indicates the number of included S-NSSAI length-value pair fields. Each S-NSSAI length-value pair field is coded as a sequence of one octet S-NSSAI value length field and an S-NSSAI value field. The S-NSSAI value length field indicates the length in octets of the S-NSSAI value field. The S-NSSAI value field contains one octet SST field optionally followed by three octets SD field. The SST field contains a SST. The SD field contains an SD. SST and SD are specified in 3GPP TS 23.003 [4]. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Standardized access category (bits 5 to 1 of octet a) |  |  |  |  |  |  |  |  |   
Standardized access category field indicates the access category number of the standardized access category that is used in combination with the access identities to determine the establishment cause. |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
5 | 4 | 3 | 2 | 1 |  |  |  |  |   
0 | 0 | 0 | 0 | 0 |  | Access category number 0 |  |  |   
to |  |  |  |  |  |  |  |  |   
0 | 0 | 1 | 1 | 1 |  | Access category number 7 |  |  |   
0 | 1 | 0 | 0 | 1 |  | Access category number 9 |  |  |   
0 | 1 | 0 | 1 | 0 |  | Access category number 10 |  |  |   
All other values are reserved. |  |  |  |  |  |  |  |  |   
#### 9.11.3.39 Payload container
The purpose of the Payload container information element is to transport one
or multiple payloads. If multiple payloads are transported, the associated
information of each payload are also transported together with the payload.
The Payload container information element is coded as shown in figure
9.11.3.39.1, figure 9.11.3.39.1A, figure 9.11.3.39.1B, figure 9.11.3.39.2,
figure 9.11.3.39.3, figure 9.11.3.39.4 and table 9.11.3.39.1.
The Payload container information element is a type 6 information element with
a minimum length of 4 octets and a maximum length of 65538 octets.
8 7 6 5 4 3 2 1
* * *
Payload container IEI octet 1  
Length of payload container contents octet 2  
octet 3  
octet 4  
Payload container contents  
octet n
Figure 9.11.3.39.1: Payload container information element
+-----------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=========================================+=============+===+===+===+===+===+===+===+ | Number of event notification indicators | octet 4 | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Event notification indicator 1 | octet 5 | | | | | | | | | | | | | | | | | | | | octet j | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Event notification indicator 2 | octet j+1* | | | | | | | | | | | | | | | | | | | | octet k* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet k+1* | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+ | Event notification indicator n | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +-----------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.39.1A: Payload container contents with Payload container type
\"Event notification\"
+------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==========================================+=============+===+===+===+===+===+===+===+ | Type of event notification indicator n | octet l+1 | | | | | | | | +------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of event notification indicator n | octet l+2 | | | | | | | | +------------------------------------------+-------------+---+---+---+---+---+---+---+ | Value of event notification indicator n | octet l+3* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.39.1B: Even notification indicator n
+---------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +===========================+=============+===+===+===+===+===+===+===+ | Number of entries | octet 4 | | | | | | | | +---------------------------+-------------+---+---+---+---+---+---+---+ | Payload container entry 1 | octet 5 | | | | | | | | | | | | | | | | | | | | octet x2 | | | | | | | | +---------------------------+-------------+---+---+---+---+---+---+---+ | Payload container entry 2 | octet x2+1 | | | | | | | | | | | | | | | | | | | | octet x3 | | | | | | | | +---------------------------+-------------+---+---+---+---+---+---+---+ | ...... | ... | | | | | | | | +---------------------------+-------------+---+---+---+---+---+---+---+ | Payload container entry i | octet xi +1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +---------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.39.2: Payload container contents with Payload container type
\"Multiple payloads\"
+-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +===================================+========================+=============+===+===+===+===+===+===+ | Length of Payload container entry | octet xi +1 | | | | | | | | | | | | | | | | | | | | octet xi +2 | | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | Number of optional IEs | Payload container type | octet xi +3 | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | Optional IE 1 | octet xi +4 | | | | | | | | | | | | | | | | | | | | octet y2 | | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | Optional IE 2 | octet y2+1 | | | | | | | | | | | | | | | | | | | | octet y3 | | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | ... | | | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | Optional IE j | octet yj+1 | | | | | | | | | | | | | | | | | | | | octet z | | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+ | Payload container entry contents | octet z+1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +-----------------------------------+------------------------+-------------+---+---+---+---+---+---+
Figure 9.11.3.39.3: Payload container entry
+-----------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=======================+=============+===+===+===+===+===+===+===+ | Type of optional IE | octet xi +4 | | | | | | | | +-----------------------+-------------+---+---+---+---+---+---+---+ | Length of optional IE | octet xi +5 | | | | | | | | +-----------------------+-------------+---+---+---+---+---+---+---+ | Value of optional IE | octet xi +6 | | | | | | | | | | | | | | | | | | | | octet y2 | | | | | | | | +-----------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.39.4: Optional IE
Table 9.11.3.39.1: Payload container information element
Payload container contents (octet 4 to octet n); max value of 65535 octets |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
If the payload container type is set to "N1 SM information" and is included in the UL NAS TRANSPORT or DL NAS TRANSPORT message, the payload container contents contain a 5GSM message as defined in subclause 8.3. If the payload container type is set to "SOR transparent container" and is included in the DL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the SOR transparent container IE (see subclause 9.11.3.51) for SOR data type is set to value "0" except that the first three octets are not included. If the payload container type is set to "SOR transparent container" and is included in the UL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the SOR transparent container IE (see subclause 9.11.3.51) for SOR data type is set to value "1" except that the first three octets are not included. If the payload container type is set to "UE policy container" and is included in the DL NAS TRANSPORT, UL NAS TRANSPORT or REGISTRATION REQUEST message, the payload container contents are coded as defined in subclause Annex D. If the payload container type is set to "UE parameters update transparent container" and is included in the DL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the UE parameters update transparent container IE (see subclause 9.11.3.53A) for UE parameters update data type is set to value "0" except that the first three octets are not included. If the payload container type is set to "UE parameters update transparent container" and is included in the UL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of the UE parameters update transparent container IE (see subclause 9.11.3.53A) for UE parameters update data type is set to value "1" except that the first three octets are not included. If the payload container type is set to "SMS" and is included in the UL NAS TRANSPORT or DL NAS TRANSPORT message, the payload container contents contain an SMS message (i.e. CP-DATA, CP-ACK or CP-ERROR) as defined in subclause 7.2 in 3GPP TS 24.011 [13]. If the payload container type is set to "CIoT user data container" and is included in the UL NAS TRANSPORT, DL NAS TRANSPORT or CONTROL PLANE SERVICE REQUEST message, the payload container contents are coded the same way as the contents of the user data container IE (see subclause 9.9.4.24 in 3GPP TS 24.301 [15]) except that the first three octets are not included. If the payload container type is set to "SMS" and is included in the CONTROL PLANE SERVICE REQUEST message, the payload container contents are coded the same way as the contents of the NAS message container IE (see subclause 9.9.3.22 in 3GPP TS 24.301 [15]) except that the first two octets are not included. If the payload container type is set to "Location services message container" and is included in the UL NAS TRANSPORT, DL NAS TRANSPORT or CONTROL PLANE SERVICE REQUEST message, the payload container contents include location services message payload. If the payload container type is set to "LTE Positioning Protocol (LPP) message container" and is included in the UL NAS TRANSPORT or DL NAS TRANSPORT message, the payload container contents include LPP message payload. If the payload container type is set to "Service-level-AA container" and is included in the UL NAS TRANSPORT or DL NAS TRANSPORT message, the payload container contents are coded the same way as the contents of service-level-AA container (see subclause 9.11.2.10). If the payload container type is set to "Event notification", the payload container contents include one or more event notification indicators. |  |  |  |  |  |  |  |  |   
Type of event notification indicator n (octet l+1) Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |  | "SRVCC handover cancelled, IMS session re-establishment required" indicator  
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  |   
to |  | Unused, shall be ignored if received by the UE |  |  |  |  |  |  |   
1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 |  |   
|  |  |  |  |  |  |  |  |   
If the type of an event notification indicator is set to "SRVCC handover cancelled, IMS session re-establishment required" indicator, the value of the event notification indicator shall not be included. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the payload container type is set to "Multiple payloads", the number of entries field represents the total number of payload container entries, and the payload container entry contents field is coded as a list of payload container entry according to figure 9.11.3.39.2, with each payload container entry is coded according to figure 9.11.3.39.3 and figure 9.11.3.39.4. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The coding of Payload container contents is dependent on the particular application. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Payload container entry For each payload container entry, the payload container type field represents the payload container type value as described in subclause 9.11.3.40, the coding of payload container contents field is dependent on the particular application, and the number of optional IEs field represents the total number of optional IEs associated with the payload container entry contents field in the payload container entry. The error handlings for optional IEs specified in subclauses 7.6.1, 7.6.3 and 7.7.1 shall apply to the optional IEs included in the payload container entry. |  |  |  |  |  |  |  |  |   
Optional IEs Type of optional IE (octet xi +4) This field contains the IEI of the optional IE. Length of optional IE (octet xi+5) This field indicates binary coded length of the value of the optional IE entry. Value of optional IE (octet xi+6 to octet y2) This field contains the value of the optional IE entry with the value part of the referred information element based on following optional IE reference. If the Request type is included, the value part of the Request type shall be encoded in the bits 1 to 4 and bits 5 to 8 shall be coded as zero. If the Release assistance indication is included, the value part of the Release assistance indication shall be encoded in the bits 1 to 4 and bits 5 to 8 shall be coded as zero. If the MA PDU session information is included, the value part of the MA PDU session information shall be encoded in the bits 1 to 4 and bits 5 to 8 shall be coded as zero. |  |  |  |  |  |  |  |  |   
IEI | Optional IE name | Optional IE reference |  |  |  |  |  |  |   
12 | PDU session ID | PDU session identity 2 (see subclause 9.11.3.41) |  |  |  |  |  |  |   
24 | Additional information | Additional information (see subclause 9.11.2.1) |  |  |  |  |  |  |   
58 | 5GMM cause | 5GMM cause (see subclause 9.11.3.2) |  |  |  |  |  |  |   
37 | Back-off timer value | GPRS timer 3 (see subclause 9.11.2.5) |  |  |  |  |  |  |   
59 | Old PDU session ID | PDU session identity 2 (see subclause 9.11.3.41) |  |  |  |  |  |  |   
80 | Request type | Request type (see subclause 9.11.3.47) |  |  |  |  |  |  |   
22 | S-NSSAI | S-NSSAI (see subclause 9.11.2.8) |  |  |  |  |  |  |   
25 | DNN | DNN (see subclause 9.11.2.1B) |  |  |  |  |  |  |   
F0 | Release assistance indication | Release assistance indication (see subclause 9.11.3.46A) |  |  |  |  |  |  |   
A0 | MA PDU session information | MA PDU session information (see subclause 9.11.3.31A) |  |  |  |  |  |  |   
#### 9.11.3.40 Payload container type
The purpose of the Payload container type information element indicates type
of payload included in the payload container information element.
The Payload container type information element is coded as shown in figure
9.11.3.40.1 and table 9.11.3.40.1.
The Payload container type information element is a type 1 information
element.
+------------------------+------------------------------+---------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +========================+==============================+=========+===+===+===+===+===+===+ | Payload container type | Payload container type value | octet 1 | | | | | | | | | | | | | | | | | | IEI | | | | | | | | | +------------------------+------------------------------+---------+---+---+---+---+---+---+
Figure 9.11.3.40.1: Payload container type information element
Table 9.11.3.40.1: Payload container type information element
Payload container type value (octet 1)
* * *
Bits  
4 3 2 1  
0 0 0 1 N1 SM information 0 0 1 0 SMS 0 0 1 1 LTE Positioning Protocol (LPP)
message container 0 1 0 0 SOR transparent container 0 1 0 1 UE policy
container 0 1 1 0 UE parameters update transparent container 0 1 1 1 Location
services message container (see 3GPP TS 23.273 [6B]) 1 0 0 0 CIoT user data
container 1 0 0 1 Service-level-AA container 1 0 1 0 Event notification 1 1 1
1 Multiple payloads
All other values are reserved.
NOTE: The value \"Multiple payloads\" is only used when the Payload container
contents in figure 9.11.3.39.1 contains multiple payloads as shown in figure
9.11.3.39.2.
#### 9.11.3.41 PDU session identity 2
The purpose of the PDU session identity 2 information element is to indicate
the identity of a PDU session in a 5GMM message.
The PDU session identity 2 information element is coded as shown in figure
9.11.3.41.1 and table 9.11.3.41.1.
The PDU session identity 2 is a type 3 information element with a length of 2
octets .
8 7 6 5 4 3 2 1
* * *
PDU session identity 2 IEI octet 1  
PDU session identity 2 value octet 2
Figure 9.11.3.41.1: PDU session identity 2 information element
Table 9.11.3.41.1: PDU session identity 2 information element
+----------------------------------------------------------------------+ | PDU session identity 2 value (octet 2) | | | | The coding of the DU session identity 2 value is identical to the | | coding of the PDU session identity value as defined in | | 3GPP TS 24.007 [11] . | +----------------------------------------------------------------------+
#### 9.11.3.42 PDU session reactivation result
The purpose of the PDU session reactivation result information element is to
indicate the result of establishments of user-plane resources of PDU sessions.
The PDU session reactivation result information element is coded as shown in
figure 9.11.3.42.1 and table 9.11.3.42.1.
The PDU session reactivation result is a type 4 information element with
minimum length of 4 octets and maximum length of 34 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PDU | octet | | | | | | | | | se | 1 | | | | | | | | | ssion | | | | | | | | | | re | | | | | | | | | | activ | | | | | | | | | | ation | | | | | | | | | | r | | | | | | | | | | esult | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | PDU | | | | | | | | | | se | | | | | | | | | | ssion | | | | | | | | | | re | | | | | | | | | | activ | | | | | | | | | | ation | | | | | | | | | | r | | | | | | | | | | esult | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 3 | | (7) | (6) | (5) | (4) | (3) | (2) | (1) | (0) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 4 | | \ | \ | \ | \ | \ | \ | (9) | (8) | | | (15) | (14) | (13) | (12) | (11) | (10) | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | octet | | | | | | | | | ----- | 5* | | | | | | | | | -- -- | -34* | | | | | | | | | - --- | | | | | | | | | | --- | | | | | | | | | | --- - | | | | | | | | | | -- -- | | | | | | | | | | - --- | | | | | | | | | | 0 | | | | | | | | | | | | | | | | | | | | 0 0 | | | | | | | | | | 0 | | | | | | | | | | 0 | | | | | | | | | | 0 | | | | | | | | | | 0 0 | | | | | | | | | | Sp | | | | | | | | | | are | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | ----- | | | | | | | | | | -- -- | | | | | | | | | | - --- | | | | | | | | | | --- | | | | | | | | | | --- - | | | | | | | | | | -- -- | | | | | | | | | | - --- | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.42.1: PDU session reactivation result information element
Table 9.11.3.42.1: PDU session reactivation result information element
+----------------------------------------------------------------------+ | PSI(x) shall be coded as follows: | | | | PSI(0): | | | | Bit 0 of octet 3 is spare and shall be coded as zero. | | | | PSI(1) -- PSI(15): | | | | 0 indicates establishment of user-plane resources of the PDU session | | was not requested in the Uplink data status IE or establishment of | | user-plane resources of the PDU session was not allowed in the | | Allowed PDU session status IE or establishment of user-plane | | resource of the PDU session is successful. | | | | 1 indicates either establishment of user-plane resources of the PDU | | session was requested in the Uplink data status IE but establishment | | of user-plane resource of the PDU session is not successful or | | indicates establishment of user-plane resources of the PDU session | | was allowed in the Allowed PDU session status IE but establishment | | of user-plane resource of the PDU session is either not performed or | | not successful. | | | | All bits in octet 5 to 34 are spare and shall be coded as zero, if | | the respective octet is included in the information element. | +----------------------------------------------------------------------+
#### 9.11.3.43 PDU session reactivation result error cause
The purpose of the PDU session reactivation result error cause information
element is to indicate error causes for PDU session ID(s) where there was a
failure to establish the user-plane resources.
The PDU session reactivation result error cause information element is coded
as shown in figure 9.11.3.43.1 and table 9.11.3.43.1.
The PDU session reactivation result error cause is a type 6 information
element with a minimum length of 5 octets and a maximum length of 515 octets.
* * *
8 7 6 5 4 3 2 1  
PDU session reactivation result error cause IEI octet 1  
Length of PDU session reactivation result error cause octet 2  
octet 3  
PDU session ID octet 4  
cause value octet 5
....
PDU session ID octet 514*  
cause value octet 515*
* * *
Figure 9.11.3.43.1: PDU session reactivation result error cause information
element
Table 9.11.3.43.1: PDU session reactivation result error cause information
element
+----------------------------------------------------------------------+ | PDU session ID is coded same as PDU session ID IE (see | | subclause 9.4). | | | | The cause value is coded same as second octet of 5GMM cause | | information element (see subclause 9.11.3.2). | +----------------------------------------------------------------------+
#### 9.11.3.44 PDU session status
The purpose of the PDU session status information element is to indicate the
state of each PDU session that can be identified by a PDU session identity.
The PDU session status information element is coded as shown in figure
9.11.3.44.1 and table 9.11.3.44.1.
The PDU session status information element is a type 4 information element
with minimum length of 4 octets and a maximum length of 34 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PDU | octet | | | | | | | | | se | 1 | | | | | | | | | ssion | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | PDU | | | | | | | | | | se | | | | | | | | | | ssion | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 3 | | (7) | (6) | (5) | (4) | (3) | (2) | (1) | (0) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 4 | | \ | \ | \ | \ | \ | \ | (9) | (8) | | | (15) | (14) | (13) | (12) | (11) | (10) | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 5*- | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | spare | 34* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.44.1: PDU session status information element
Table 9.11.3.44.1: PDU session status information element
+----------------------------------------------------------------------+ | PSI(x) shall be coded as follows: | | | | PSI(0): | | | | Bit 1 of octet 3 is spare and shall be coded as zero. | | | | PSI(1) -- PSI(15): | | | | 0 indicates that the 5GSM state of the corresponding PDU session is | | PDU SESSION INACTIVE. | | | | 1 indicates that the 5GSM state of the corresponding PDU session is | | not PDU SESSION INACTIVE | | | | All bits in octet 5 to 34 are spare and shall be coded as zero, if | | the respective octet is included in the information element. | +----------------------------------------------------------------------+
#### 9.11.3.45 PLMN list
See subclause 10.5.1.13 in 3GPP TS 24.008 [12].
#### 9.11.3.46 Rejected NSSAI
The purpose of the Rejected NSSAI information element is to identify a
collection of rejected S-NSSAIs.
The Rejected NSSAI information element is coded as shown in figure
9.11.3.46.1, figure 9.11.3.46.2 and table 9.11.3.46.1.
The Rejected NSSAI is a type 4 information element with a minimum length of 4
octets and a maximum length of 42 octets.
* * *
8 7 6 5 4 3 2 1
* * *
Rejected NSSAI IEI octet 1
Length of Rejected NSSAI contents octet 2
Rejected S-NSSAI 1 octet 3\  
\  
octet m
Rejected S-NSSAI 2 octet m+1*\  
\  
octet n*
... octet n+1*\  
\  
octet u*
Rejected S-NSSAI n octet u+1*\  
\  
octet v*
* * *
Figure 9.11.3.46.1: Rejected NSSAI information element
+----------------------------+-------------+---------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +============================+=============+=========+===+===+===+===+===+===+ | Length of rejected S-NSSAI | Cause value | octet 3 | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+ | SST | octet 4 | | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+ | SD | octet 5* | | | | | | | | | | | | | | | | | | | | octet 7* | | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+
Figure 9.11.3.46.2: Rejected S-NSSAI
Table 9.11.3.46.1: Rejected NSSAI information element
+------------------------+---+---+---+---+------------------------+ | Value part of the | | | | | | | Rejected NSSAI | | | | | | | information element | | | | | | | (octet 3 to v) | | | | | | +------------------------+---+---+---+---+------------------------+ | | | | | | | +------------------------+---+---+---+---+------------------------+ | The value part of the | | | | | | | Rejected NSSAI | | | | | | | information element | | | | | | | consists of one or | | | | | | | more rejected | | | | | | | S-NSSAIs. Each | | | | | | | rejected S-NSSAI | | | | | | | consists of one | | | | | | | S-NSSAI and an | | | | | | | associated cause | | | | | | | value. The length of | | | | | | | each rejected S-NSSAI | | | | | | | can be determined by | | | | | | | the \'length of | | | | | | | rejected S-NSSAI\' | | | | | | | field in the first | | | | | | | octet of the rejected | | | | | | | S-NSSAI. | | | | | | +------------------------+---+---+---+---+------------------------+ | The UE shall store the | | | | | | | complete list received | | | | | | | (NOTE 0). If more than | | | | | | | 8 rejected S-NSSAIs | | | | | | | are included in this | | | | | | | information element, | | | | | | | the UE shall store the | | | | | | | first 8 rejected | | | | | | | S-NSSAIs and ignore | | | | | | | the remaining octets | | | | | | | of the information | | | | | | | element. | | | | | | +------------------------+---+---+---+---+------------------------+ | | | | | | | +------------------------+---+---+---+---+------------------------+ | Rejected S-NSSAI: | | | | | | +------------------------+---+---+---+---+------------------------+ | | | | | | | +------------------------+---+---+---+---+------------------------+ | Cause value (octet 3) | | | | | | +------------------------+---+---+---+---+------------------------+ | Bits | | | | | | +------------------------+---+---+---+---+------------------------+ | 4 | 3 | 2 | 1 | | | +------------------------+---+---+---+---+------------------------+ | 0 | 0 | 0 | 0 | | S-NSSAI not available | | | | | | | in the current PLMN or | | | | | | | SNPN | +------------------------+---+---+---+---+------------------------+ | 0 | 0 | 0 | 1 | | S-NSSAI not available | | | | | | | in the current | | | | | | | registration area | +------------------------+---+---+---+---+------------------------+ | 0 | 0 | 1 | 0 | | S-NSSAI not available | | | | | | | due to the failed or | | | | | | | revoked network | | | | | | | slice-specific | | | | | | | authentication and | | | | | | | authorization | +------------------------+---+---+---+---+------------------------+ | All other values are | | | | | | | reserved. | | | | | | +------------------------+---+---+---+---+------------------------+ | | | | | | | +------------------------+---+---+---+---+------------------------+ | Slice/service type | | | | | | | (SST) (octet 4) | | | | | | +------------------------+---+---+---+---+------------------------+ | This field contains | | | | | | | the 8 bit SST value. | | | | | | | The coding of the SST | | | | | | | value part is defined | | | | | | | in | | | | | | | 3GPP TS 23.003 [4]. | | | | | | | (NOTE 2) | | | | | | +------------------------+---+---+---+---+------------------------+ | | | | | | | +------------------------+---+---+---+---+------------------------+ | Slice differentiator | | | | | | | (SD) (octet 5 to octet | | | | | | | 7) | | | | | | +------------------------+---+---+---+---+------------------------+ | This field contains | | | | | | | the 24 bit SD value. | | | | | | | The coding of the SD | | | | | | | value part is defined | | | | | | | in | | | | | | | 3GPP TS 23.003 [4]. | | | | | | | (NOTE 3) | | | | | | +------------------------+---+---+---+---+------------------------+ | NOTE 0: The number of | | | | | | | rejected S-NSSAI(s) | | | | | | | shall not exceed | | | | | | | eight. | | | | | | | | | | | | | | NOTE 1: If octet 5 is | | | | | | | included, then octet 6 | | | | | | | and octet 7 shall be | | | | | | | included. | | | | | | | | | | | | | | NOTE 2: If the Cause | | | | | | | value is \"S-NSSAI not | | | | | | | available due to the | | | | | | | failed or revoked | | | | | | | network slice-specific | | | | | | | authentication and | | | | | | | authorization\", this | | | | | | | field shall contain | | | | | | | the 8 bit SST value of | | | | | | | an S-NSSAI in the | | | | | | | S-NSSAI(s) of the | | | | | | | HPLMN. | | | | | | | | | | | | | | NOTE 3: If the Cause | | | | | | | value is \"S-NSSAI not | | | | | | | available due to the | | | | | | | failed or revoked | | | | | | | network slice-specific | | | | | | | authentication and | | | | | | | authorization\", this | | | | | | | field shall contain | | | | | | | the 24 bit SD value of | | | | | | | an S-NSSAI in the | | | | | | | S-NSSAI(s) of the | | | | | | | HPLMN. | | | | | | +------------------------+---+---+---+---+------------------------+
#### 9.11.3.46A Release assistance indication
See subclause 9.9.4.25 in 3GPP TS 24.301 [15].
#### 9.11.3.47 Request type
The purpose of the Request type information element is to indicate the type of
the 5GSM message.
The Request type information element is coded as shown in figure 9.11.3.47.1
and table 9.11.3.47.1.
The Request type is a type 1 information element.
+------------------+-------+--------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------+-------+--------------------+---------+---+---+---+---+---+ | Request type IEI | 0 | Request type value | octet 1 | | | | | | | | | | | | | | | | | | spare | | | | | | | | +------------------+-------+--------------------+---------+---+---+---+---+---+
Figure 9.11.3.47.1: Request type information element
Table 9.11.3.47.1: Request type information element
Request type value (octet 1, bit 1 to bit 4)
* * *
Bits  
3 2 1  
0 0 1 initial request 0 1 0 existing PDU session 0 1 1 initial emergency
request 1 0 0 existing emergency PDU session 1 0 1 modification request 1 1 0
MA PDU request (NOTE) 1 1 1 reserved All other values are unused and shall be
interpreted as \"initial request\", if received by the network.  
NOTE: This value shall be interpreted as \"initial request\", if received by a
network not supporting MA PDU sessions.
#### 9.11.3.48 S1 UE network capability
See subclause 9.9.3.34 in 3GPP TS 24.301 [15].
#### 9.11.3.48A S1 UE security capability
See subclause 9.9.3.36 in 3GPP TS 24.301 [15].
#### 9.11.3.49 Service area list
The purpose of the _Service area list_ information element is to transfer a
list of allowed tracking areas for an allowed area or a list of non-allowed
tracking areas for a non-allowed area from the network to the UE.
The coding of the information element allows combining different types of
lists. The lists of type \"00\" and \"01\" allow a more compact encoding, when
the different TAIs are sharing the PLMN identity. The lists of type \"11\"
indicate all TAIs of the PLMNs in the registration area are allowed area.
The _Service area list_ information element is coded as shown in figure
9.11.3.49.1, figure 9.11.3.49.2, figure 9.11.3.49.3, figure 9.11.3.49.4,
figure 9.11.3.49.5 and table 9.11.3.49.1.
The _Service area list_ is a type 4 information element with a minimum length
of 6 octets and a maximum length of 114 octets. The list can contain a maximum
of 16 different tracking area identities.
+--------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Service area list IEI | octet 1 | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of service area list contents | octet 2 | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Partial service area list 1 | octet 3 | | | | | | | | | | | | | | | | | | | | octet i | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Partial service area list 2 | octet i+1* | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+ | Partial service area list p | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +--------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.49.1: Service area list information element
* * *
8 7 6 5 4 3 2 1  
Allowed type Type of list Number of elements octet 1  
MCC digit 2 MCC digit 1 octet 2  
MNC digit 3 MCC digit 3 octet 3  
MNC digit 2 MNC digit 1 octet 4  
TAC 1 octet 5  
TAC 1 (continued) octet 6  
TAC 1 (continued) octet 7  
... ...  
TAC k octet 3k+2*  
TAC k (continued) octet 3k+3*  
TAC k (continued) octet 3k+4*
* * *
Figure 9.11.3.49.2: Partial service area list -- type of list = \"00\"
* * *
8 7 6 5 4 3 2 1  
Allowed type Type of list Number of elements octet 1  
MCC digit 2 MCC digit 1 octet 2  
MNC digit 3 MCC digit 3 octet 3  
MNC digit 2 MNC digit 1 octet 4  
TAC 1 octet 5  
TAC 1 (continued) octet 6  
TAC 1 (continued) octet 7
* * *
Figure 9.11.3.49.3: Partial service area list -- type of list = \"01\"
* * *
8 7 6 5 4 3 2 1  
Allowed type Type of list Number of elements octet 1  
MCC digit 2 MCC digit 1 octet 2  
MNC digit 3 MCC digit 3 octet 3  
MNC digit 2 MNC digit 1 octet 4  
TAC 1 octet 5  
TAC 1 (continued) octet 6  
TAC 1 (continued) octet 7  
MCC digit 2 MCC digit 1 octet 8*  
MNC digit 3 MCC digit 3 octet 9*  
MNC digit 2 MNC digit 1 octet 10*  
TAC 2 octet 11*  
TAC 2 (continued) octet 12*  
TAC 2 (continued) octet 13*  
...  
MCC digit 2 MCC digit 1 octet 6k-4*  
MNC digit 3 MCC digit 3 octet 6k-3*  
MNC digit 2 MNC digit 1 octet 6k-2*  
TAC k octet 6k*-1  
TAC k (continued) octet 6k*  
TAC k (continued) octet 6k+1*
* * *
Figure 9.11.3.49.4: Partial service area list -- type of list = \"10\"
* * *
8 7 6 5 4 3 2 1  
Allowed type Type of list Number of elements octet 1  
MCC digit 2 MCC digit 1 octet 2  
MNC digit 3 MCC digit 3 octet 3  
MNC digit 2 MNC digit 1 octet 4
* * *
Figure 9.11.3.49.5: Partial service area list -- type of list = \"11\"
Table 9.11.3.49.1: Service area list information element
+-----------------+---+-----------------+---+---+-------------+ | Value part of | | | | | | | the Service | | | | | | | area list | | | | | | | information | | | | | | | element (octets | | | | | | | 3 to n) | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | The value part | | | | | | | of the Service | | | | | | | area list | | | | | | | information | | | | | | | element | | | | | | | consists of one | | | | | | | or several | | | | | | | partial service | | | | | | | area lists. The | | | | | | | length of each | | | | | | | partial service | | | | | | | area list can | | | | | | | be determined | | | | | | | from the \'type | | | | | | | of list\' field | | | | | | | and the | | | | | | | \'number of | | | | | | | elements\' | | | | | | | field in the | | | | | | | first octet of | | | | | | | the partial | | | | | | | service area | | | | | | | list. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | The \"Allowed | | | | | | | type\" fields | | | | | | | in all the | | | | | | | partial service | | | | | | | area lists | | | | | | | shall have the | | | | | | | same value. For | | | | | | | allowed type | | | | | | | \"0\", TAIs | | | | | | | contained in | | | | | | | all partial | | | | | | | service area | | | | | | | lists are in | | | | | | | the allowed | | | | | | | area. For | | | | | | | allowed type | | | | | | | \"1\", TAIs | | | | | | | contained in | | | | | | | all partial | | | | | | | service area | | | | | | | lists are in | | | | | | | the non-allowed | | | | | | | area. | | | | | | | | | | | | | | The UE shall | | | | | | | store the | | | | | | | complete list | | | | | | | received. If | | | | | | | more than 16 | | | | | | | TAIs are | | | | | | | included in | | | | | | | this | | | | | | | information | | | | | | | element, the UE | | | | | | | shall store the | | | | | | | first 16 TAIs | | | | | | | and ignore the | | | | | | | remaining | | | | | | | octets of the | | | | | | | information | | | | | | | element. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Partial service | | | | | | | area list: | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Allowed type | | | | | | | (octet 1) | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Bit | | | | | | +-----------------+---+-----------------+---+---+-------------+ | 8 | | | | | | +-----------------+---+-----------------+---+---+-------------+ | 0 | | TAIs in the | | | | | | | list are in the | | | | | | | allowed area | | | | +-----------------+---+-----------------+---+---+-------------+ | 1 | | TAIs in the | | | | | | | list are in the | | | | | | | non-allowed | | | | | | | area | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Type of list | | | | | | | (octet 1) | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Bits | | | | | | +-----------------+---+-----------------+---+---+-------------+ | 7 | 6 | | | | | +-----------------+---+-----------------+---+---+-------------+ | 0 | 0 | list of TACs | | | | | | | belonging to | | | | | | | one PLMN, with | | | | | | | non-consecutive | | | | | | | TAC values | | | | +-----------------+---+-----------------+---+---+-------------+ | 0 | 1 | list of TACs | | | | | | | belonging to | | | | | | | one PLMN, with | | | | | | | consecutive TAC | | | | | | | values | | | | +-----------------+---+-----------------+---+---+-------------+ | 1 | 0 | list of TAIs | | | | | | | belonging to | | | | | | | different PLMNs | | | | | | | (see NOTE) | | | | +-----------------+---+-----------------+---+---+-------------+ | 1 | 1 | All TAIs | | | | | | | belonging to | | | | | | | the PLMNs in | | | | | | | the | | | | | | | registration | | | | | | | area are in the | | | | | | | allowed area | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Number of | | | | | | | elements (octet | | | | | | | 1) | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Bits | | | | | | +-----------------+---+-----------------+---+---+-------------+ | 5 | 4 | 3 | 2 | 1 | | +-----------------+---+-----------------+---+---+-------------+ | 0 | 0 | 0 | 0 | 0 | 1 element | +-----------------+---+-----------------+---+---+-------------+ | 0 | 0 | 0 | 0 | 1 | 2 elements | +-----------------+---+-----------------+---+---+-------------+ | 0 | 0 | 0 | 1 | 0 | 3 elements | +-----------------+---+-----------------+---+---+-------------+ | to | | | | | | +-----------------+---+-----------------+---+---+-------------+ | 0 | 1 | 1 | 0 | 1 | 14 elements | +-----------------+---+-----------------+---+---+-------------+ | 0 | 1 | 1 | 1 | 0 | 15 elements | +-----------------+---+-----------------+---+---+-------------+ | 0 | 1 | 1 | 1 | 1 | 16 elements | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | All other | | | | | | | values are | | | | | | | unused and | | | | | | | shall be | | | | | | | interpreted as | | | | | | | 16, if received | | | | | | | by the UE. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | For type of | | | | | | | list = \"00\" | | | | | | | and number of | | | | | | | elements = k: | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | octets 2 to 4 | | | | | | | contain the | | | | | | | MCC+MNC, and | | | | | | +-----------------+---+-----------------+---+---+-------------+ | for j = 1, ..., | | | | | | | k: | | | | | | +-----------------+---+-----------------+---+---+-------------+ | octets 3j+2 to | | | | | | | 3j+4 contain | | | | | | | the TAC of the | | | | | | | j-th TAI | | | | | | | belonging to | | | | | | | the partial | | | | | | | list, | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | For type of | | | | | | | list = \"01\" | | | | | | | and number of | | | | | | | elements = k: | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | octets 2 to 4 | | | | | | | contain the | | | | | | | MCC+MNC, and | | | | | | +-----------------+---+-----------------+---+---+-------------+ | octets 5 to 7 | | | | | | | contain the TAC | | | | | | | of the first | | | | | | | TAI belonging | | | | | | | to the partial | | | | | | | list. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | The TAC values | | | | | | | of the other | | | | | | | k-1 TAIs are | | | | | | | TAC+1, TAC+2, | | | | | | | ..., TAC+k-1. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | For type of | | | | | | | list = \"10\" | | | | | | | and number of | | | | | | | elements = k: | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | for j = 1, ..., | | | | | | | k. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | octets 6j-4 to | | | | | | | 6j-2 contain | | | | | | | the MCC+MNC, | | | | | | | and | | | | | | +-----------------+---+-----------------+---+---+-------------+ | octets 6j-1 to | | | | | | | 6j+1 contain | | | | | | | the TAC of the | | | | | | | j-th TAI | | | | | | | belonging to | | | | | | | the partial | | | | | | | list. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | For type of | | | | | | | list = \"11\": | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | Allowed type | | | | | | | shall be coded | | | | | | | as \"0\" and | | | | | | | number of | | | | | | | elements shall | | | | | | | be ignored, and | | | | | | | octets 2 to 4 | | | | | | | containing the | | | | | | | MCC+MNC can be | | | | | | | ignored. | | | | | | | | | | | | | | If allowed type | | | | | | | is coded as | | | | | | | \"1\", it shall | | | | | | | be interpreted | | | | | | | as \"0\". | | | | | | +-----------------+---+-----------------+---+---+-------------+ | MCC, Mobile | | | | | | | country code | | | | | | | | | | | | | | The MCC field | | | | | | | is coded as in | | | | | | | ITU- | | | | | | | T Recommendatio | | | | | | | n E.212 [42], | | | | | | | annex A. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | MNC, Mobile | | | | | | | network code | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | The coding of | | | | | | | this field is | | | | | | | the | | | | | | | responsibility | | | | | | | of each | | | | | | | administration | | | | | | | but BCD coding | | | | | | | shall be used. | | | | | | | The MNC shall | | | | | | | consist of 2 or | | | | | | | 3 digits. If a | | | | | | | network | | | | | | | operator | | | | | | | decides to use | | | | | | | only two digits | | | | | | | in the MNC, MNC | | | | | | | digit 3 shall | | | | | | | be coded as | | | | | | | \"1111\". | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | TAC, Tracking | | | | | | | area code | | | | | | +-----------------+---+-----------------+---+---+-------------+ | | | | | | | +-----------------+---+-----------------+---+---+-------------+ | In the TAC | | | | | | | field bit 8 of | | | | | | | the first octet | | | | | | | is the most | | | | | | | significant bit | | | | | | | and bit 1 of | | | | | | | the third octet | | | | | | | the least | | | | | | | significant | | | | | | | bit. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | The coding of | | | | | | | the tracking | | | | | | | area code is | | | | | | | the | | | | | | | responsibility | | | | | | | of each | | | | | | | administration. | | | | | | | Coding using | | | | | | | full | | | | | | | hexadecimal | | | | | | | representation | | | | | | | may be used. | | | | | | | The tracking | | | | | | | area code | | | | | | | consists of 3 | | | | | | | octets. | | | | | | +-----------------+---+-----------------+---+---+-------------+ | NOTE: If the | | | | | | | \"list of TAIs | | | | | | | belonging to | | | | | | | different | | | | | | | PLMNs\" is | | | | | | | used, the PLMNs | | | | | | | included in the | | | | | | | list need to be | | | | | | | present in the | | | | | | | list of | | | | | | | equivalent | | | | | | | PLMNs. This | | | | | | | type is not | | | | | | | applicable in | | | | | | | an SNPN. | | | | | | +-----------------+---+-----------------+---+---+-------------+
#### 9.11.3.50 Service type
The purpose of the service type information element is to specify the purpose
of the service request procedure.
The service type is a type 1 information element.
The service type information element is coded as shown in figure 9.11.3.50.1
and table 9.11.3.50.1.
+--------------+--------------------+---------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------+--------------------+---------+---+---+---+---+---+---+ | Service type | Service type value | octet 1 | | | | | | | | | | | | | | | | | | IEI | | | | | | | | | +--------------+--------------------+---------+---+---+---+---+---+---+
Figure 9.11.3.50.1: Service type information element
Table 9.11.3.50.1: Service type information element
* * *
Service type value (octet 1)
Service type value  
Bits  
4 3 2 1  
0 0 0 0 signalling 0 0 0 1 data 0 0 1 0 mobile terminated services 0 0 1 1
emergency services 0 1 0 0 emergency services fallback 0 1 0 1 high priority
access 0 1 1 0 elevated signalling 0 1 1 1 unused; shall be interpreted as
\"signalling\", if received by the network 1 0 0 0 unused; shall be
interpreted as \"signalling\", if received by the network 1 0 0 1 unused;
shall be interpreted as \"data\", if received by the network 1 0 1 0 unused;
shall be interpreted as \"data\", if received by the network 1 0 1 1 unused;
shall be interpreted as \"data\", if received by the network
All other values are reserved.
* * *
#### 9.11.3.50A SMS indication
The purpose of the SMS indication information element is to indicate that the
ability for the UE to use SMS over NAS has changed.
The SMS indication information element is coded as shown in figure
9.11.3.50A.1 and table 9.11.3.50A.1.
The SMS indication is a type 1 information element.
+--------------------+-------+-------+-------+-----+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +====================+=======+=======+=======+=====+=========+===+===+===+ | SMS indication IEI | 0 | 0 | 0 | SAI | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +--------------------+-------+-------+-------+-----+---------+---+---+---+
Figure 9.11.3.50A.1: SMS indication
Table 9.11.3.50A.1: SMS indication
SMS availability indication (SAI) (octet 1)
* * *
Bit  
1  
0 SMS over NAS not available 1 SMS over NAS available
Bits 2, 3 and 4 are spare and shall be coded as zero,
#### 9.11.3.51 SOR transparent container
The purpose of the SOR transparent container information element in the
REGISTRATION ACCEPT message is to provide the list of preferred PLMN/access
technology combinations (or HPLMN indication that \'no change of the
\"Operator Controlled PLMN Selector with Access Technology\" list stored in
the UE is needed and thus no list of preferred PLMN/access technology
combinations is provided\'), or a secured packet (see 3GPP TS 23.122 [5] annex
C) and optional indication of an acknowledgement request, SOR-CMCI, request
the storage of the received SOR-CMCI in the ME, and SOR-SNPN-SI (or subscribed
SNPN or HPLMN indication that \'no change of the SOR-SNPN-SI stored in the UE
is needed and thus no SOR-SNPN-SI is provided\'). The purpose of the SOR
transparent container information element in the REGISTRATION COMPLETE message
is to indicate the UE acknowledgement of successful reception of the SOR
transparent container IE in the REGISTRATION ACCEPT message as well as to
indicate the ME support of SOR-CMCI and the ME support of SOR-SNPN-SI.
NOTE: When used in NAS transport procedure, the contents of the SOR
transparent container information element in the Payload container IE of the
DL NAS TRANSPORT message are used to provide the list of preferred PLMN/access
technology combinations and optional indication of an acknowledgement request,
SOR-CMCI, request the storage of the received SOR-CMCI in the ME, and SOR-
SNPN-SI. The contents of the SOR transparent container information element in
the Payload container IE of the UL NAS TRANSPORT message are used to indicate
the UE acknowledgement of successful reception of the SOR transparent
container IE in the DL NAS TRANSPORT message as well as to indicate the ME
support of SOR-CMCI and the ME support of SOR-SNPN-SI.
The SOR transparent container information element is coded as shown in figure
9.11.3.51.1, figure 9.11.3.51.2, figure 9.11.3.51.3, figure 9.11.3.51.4,
figure 9.11.3.51.5, figure 9.11.3.51.6, figure 9.11.3.51.7, figure
9.11.3.51.8, figure 9.11.3.51.9, figure 9.11.3.51.10, figure 9.11.3.51.11,
figure 9.11.3.51.12, figure 9.11.3.51.13, table 9.11.3.51.1, table
9.11.3.51.2, table 9.11.3.51.3, table 9.11.3.51.4, table 9.11.3.51.5 and table
9.11.3.51.6.
The SOR transparent container is a type 6 information element with a minimum
length of 20 octets.
+----------------------------------------------+------------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+ | SOR transparent container IEI | octet 1 | | | | | | | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+ | Length of SOR transparent container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+ | SOR header | octet 4 | | | | | | | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+ | SOR-MAC-I~AUSF~ | octet 5-20 | | | | | | | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+ | Counter~SOR~ | octet 21-22 | | | | | | | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+ | Secured packet | octet 23* - n* | | | | | | | | +----------------------------------------------+------------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.1: SOR transparent container information element for list
type with value \"0\" and SOR data type with value \"0\"
+----------------------------------------------+----------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+ | SOR transparent container IEI | octet 1 | | | | | | | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+ | Length of SOR transparent container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+ | SOR header | octet 4 | | | | | | | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+ | SOR-MAC-I~AUSF~ | octet 5-20 | | | | | | | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+ | Counter~SOR~ | octet 21-22 | | | | | | | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+ | PLMN ID and access technology list | octet 23*-m* | | | | | | | | +----------------------------------------------+----------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.2: SOR transparent container information element for list
type with value \"1\", SOR data type with value \"0\", and additional
parameters with value \"0\"
+-------+-------+-------+-------+-------+------+-------+----+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | SOR | octet | | | | | | | | | t | 1 | | | | | | | | | ransp | | | | | | | | | | arent | | | | | | | | | | cont | | | | | | | | | | ainer | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | SOR | octet | | | | | | | | | t | 3 | | | | | | | | | ransp | | | | | | | | | | arent | | | | | | | | | | cont | | | | | | | | | | ainer | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | SOR | octet | | | | | | | | | h | 4 | | | | | | | | | eader | | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | SOR-M | octet | | | | | | | | | AC-I~ | 5 | | | | | | | | | AUSF~ | | | | | | | | | | | octet | | | | | | | | | | 20 | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | Co | octet | | | | | | | | | unter | 21 | | | | | | | | | ~SOR~ | | | | | | | | | | | octet | | | | | | | | | | 22 | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | L | octet | | | | | | | | | ength | 23* | | | | | | | | | of | | | | | | | | | | PLMN | | | | | | | | | | ID | | | | | | | | | | and | | | | | | | | | | a | | | | | | | | | | ccess | | | | | | | | | | techn | | | | | | | | | | ology | | | | | | | | | | list | | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | PLMN | octet | | | | | | | | | ID | 24* | | | | | | | | | and | | | | | | | | | | a | octet | | | | | | | | | ccess | m* | | | | | | | | | techn | | | | | | | | | | ology | | | | | | | | | | list | | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | 0 | 0 | 0 | 0 | 0 | SSSI | SSCMI | SI | octet | | | | | | | | | | o | | Spare | Spare | Spare | Spare | Spare | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | SOR | octet | | | | | | | | | -CMCI | (o | | | | | | | | | | +1)* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | p* | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+ | S | octet | | | | | | | | | OR-SN | (p | | | | | | | | | PN-SI | +1)* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | u* | | | | | | | | +-------+-------+-------+-------+-------+------+-------+----+-------+
Figure 9.11.3.51.2A: SOR transparent container information element for list
type with value \"1\", SOR data type with value \"0\", additional parameters
with value \"1\"
* * *
PLMN ID 1 octet 23*- 25* access technology identifier 1 octet 26*- 27* ...  
PLMN ID n octet (18+5*n)*-(20+5*n)* access technology identifier n octet
(21+5*n)*-(22+5*n)*
* * *
Figure 9.11.3.51.3: PLMN ID and access technology list (m=22+5*n)
+----------------------------------------------+--------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------+--------------+---+---+---+---+---+---+---+ | SOR transparent container IEI | octet 1 | | | | | | | | +----------------------------------------------+--------------+---+---+---+---+---+---+---+ | Length of SOR transparent container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------------+--------------+---+---+---+---+---+---+---+ | SOR header | octet 4 | | | | | | | | +----------------------------------------------+--------------+---+---+---+---+---+---+---+ | SOR-MAC-I~UE~ | octet 5 - 20 | | | | | | | | +----------------------------------------------+--------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.4: SOR transparent container information element for SOR data
type with value \"1\"
+-------+-------+-------+----+-----+-----------+-----------------+---------------+---------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+----+-----+-----------+-----------------+---------------+---------+ | 0 | 0 | 0 | AP | ACK | List type | List indication | SOR data type | octet 4 | | | | | | | | | | | | Spare | Spare | Spare | | | | | | | +-------+-------+-------+----+-----+-----------+-----------------+---------------+---------+
Figure 9.11.3.51.5: SOR header for SOR data type with value \"0\"
+-------+-------+-------+-------+-------+----------+------+---------------+---------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+----------+------+---------------+---------+ | 0 | 0 | 0 | 0 | 0 | MSSNPNSI | MSSI | SOR data type | octet 4 | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | | | | | +-------+-------+-------+-------+-------+----------+------+---------------+---------+
Figure 9.11.3.51.6: SOR header for SOR data type with value \"1\"
Table 9.11.3.51.1: SOR transparent container information element
+----------------------------------+----------------------------------+ | SOR-MAC-I~AUSF~ (see NOTE 1)~,~ | | | SOR-MAC-I~UE~ (see NOTE 2) and | | | Counter~SOR~ (see NOTE 1) are | | | coded as specified in | | | 3GPP TS 33.501 [24]. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SOR data type (octet 4, bit 1) | | +----------------------------------+----------------------------------+ | 0 | The SOR transparent container | | | carries steering of roaming | | | information. | +----------------------------------+----------------------------------+ | 1 | The SOR transparent container | | | carries acknowledgement of | | | successful reception of the | | | steering of roaming information. | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | List indication (octet 4, bit 2) | | | (see NOTE 1 and NOTE 5) | | +----------------------------------+----------------------------------+ | 0 | HPLMN indication that \'no | | | change of the \"Operator | | | Controlled PLMN Selector with | | | Access Technology\" list stored | | | in the UE is needed and thus no | | | list of preferred PLMN/access | | | technology combinations is | | | provided\' | +----------------------------------+----------------------------------+ | 1 | list of preferred PLMN/access | | | technology combinations is | | | provided | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | List type (octet 4, bit 3) (see | | | NOTE 1) | | +----------------------------------+----------------------------------+ | 0 | The list type is a secured | | | packet. | +----------------------------------+----------------------------------+ | 1 | The list type is a \"PLMN ID and | | | access technology list\". | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Acknowledgement (ACK) value | | | (octet 4, bit 4) (see NOTE 1) | | +----------------------------------+----------------------------------+ | 0 | acknowledgement not requested | +----------------------------------+----------------------------------+ | 1 | acknowledgement requested | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Additional parameters (AP) value | | | (octet 4, bit 5) | | +----------------------------------+----------------------------------+ | Bit | | +----------------------------------+----------------------------------+ | **5** | | +----------------------------------+----------------------------------+ | 0 | Additional parameters not | | | included | +----------------------------------+----------------------------------+ | 1 | Additional parameters included | | | (see NOTE 3) | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | If the SOR data type is set to | | | value \"0\", the list type bit | | | is set to value \"1\", and the | | | additional parameters bit is set | | | to value \"1\" then:\ | | | - the octet o is present. | | | | | | - if the list indication bit is | | | set to \"0\" then the PLMN ID | | | and access technology list field | | | and the length of PLMN ID and | | | access technology list field are | | | absent. | | | | | | - if the list indication bit is | | | set to \"1\" then the PLMN ID | | | and access technology list field | | | and the length of PLMN ID and | | | access technology list field are | | | present. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | The secure packet is coded as | | | specified in | | | 3GPP TS 31.115 [22B]. (see | | | NOTE 1) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | The PLMN ID and access | | | technology list consists of PLMN | | | ID and access technology | | | identifier and are coded as | | | specified in | | | 3GPP TS 31.102 [22] | | | subclause 4.2.5. The PLMN ID and | | | access technology identifier are | | | provided in decreasing order of | | | priority, i.e. PLMN ID 1 | | | indicates highest priority and | | | PLMN ID n indicates lowest | | | priority. The PLMN ID and access | | | technology list contains at | | | minimum zero and at maximum 16 | | | (decimal) PLMN IDs and access | | | technology identifiers. (see | | | NOTE 1) | | +----------------------------------+----------------------------------+ | ME support of SOR-CMCI indicator | | | (MSSI) value (octet 4, bit 2) | | | (see NOTE 2, NOTE 4) | | +----------------------------------+----------------------------------+ | 0 | SOR-CMCI not supported by the ME | +----------------------------------+----------------------------------+ | 1 | SOR-CMCI supported by the ME | +----------------------------------+----------------------------------+ | ME support of SOR-SNPN-SI | | | indicator (MSSNPNSI) value | | | (octet 4, bit 3) (see NOTE 2, | | | NOTE 6) | | +----------------------------------+----------------------------------+ | 0 | SOR-SNPN-SI not supported by the | | | ME | +----------------------------------+----------------------------------+ | 1 | SOR-SNPN-SI supported by the ME | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SOR-CMCI indicator (SI) value | | | (octet o, bit 1) | | | | | | Bit | | +----------------------------------+----------------------------------+ | **1** | | +----------------------------------+----------------------------------+ | 0 | SOR-CMCI absent | +----------------------------------+----------------------------------+ | 1 | SOR-CMCI present | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | If the SOR-CMCI indicator bit is | | | set to \"SOR-CMCI present\", the | | | SOR-CMCI field is present. If | | | the SI bit is set to \"SOR-CMCI | | | absent\", the SOR-CMCI field is | | | absent. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Store SOR-CMCI in ME indicator | | | (SSCMI) value (octet o, bit 2) | | | | | | Bit | | +----------------------------------+----------------------------------+ | **2** | | +----------------------------------+----------------------------------+ | 0 | Do not store SOR-CMCI in ME | +----------------------------------+----------------------------------+ | 1 | Store SOR-CMCI in ME | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SOR-CMCI (octet o+1 to octet p) | | | | | | The SOR-CMCI field is coded | | | according to figure 9.11.3.51.7 | | | and table 9.11.3.51.2. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SOR-SNPN-SI indicator (SSSI) | | | value (octet o, bit 3) | | | | | | Bit | | +----------------------------------+----------------------------------+ | **3** | | +----------------------------------+----------------------------------+ | 0 | subscribed SNPN or HPLMN | | | indication that \'no change of | | | the SOR-SNPN-SI stored in the UE | | | is needed and thus no | | | SOR-SNPN-SI is provided\' | +----------------------------------+----------------------------------+ | 1 | SOR-SNPN-SI present | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | If the SSSI bit is set to | | | \"SOR-SNPN-SI present\", the | | | SOR-SNPN-SI field is present. If | | | the SSSI bit is set to | | | \"subscribed SNPN or HPLMN | | | indication that \'no change of | | | the SOR-SNPN-SI stored in the UE | | | is needed and thus no | | | SOR-SNPN-SI is provided\'\", the | | | SOR-SNPN-SI is absent. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | NOTE 1: This bit or field | | | applies for SOR header with SOR | | | data type with value \"0\". | | | | | | NOTE 2: This bit or field | | | applies for SOR header with SOR | | | data type with value \"1\". | | | | | | NOTE 3: Additional parameters | | | can be set to value \"1\" only | | | when the ME supports SOR-CMCI or | | | SOR-SNPN-SI, and the list type | | | bit is set to value \"1\". | | | | | | NOTE 4: The \"SOR-CMCI supported | | | by the ME\" is not set by a UE | | | compliant to an earlier release | | | of the specification. | | | | | | NOTE 5: This bit or field | | | applies for SOR header with list | | | type with value \"1\". | | | | | | NOTE 6: The \"SOR-SNPN-SI | | | supported by the ME\" may only | | | be set by a UE which supports | | | access to an SNPN using | | | credentials from a credentials | | | holder and which is not | | | operating in SNPN access | | | operation mode. | | +----------------------------------+----------------------------------+
+-----------------------------+---------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------------------+---------------+---+---+---+---+---+---+---+ | Length of SOR-CMCI contents | octet (o+1) | | | | | | | | | | | | | | | | | | | | octet (o+2) | | | | | | | | +-----------------------------+---------------+---+---+---+---+---+---+---+ | SOR-CMCI rule 1 | octet (o+3)* | | | | | | | | | | | | | | | | | | | | octet q* | | | | | | | | +-----------------------------+---------------+---+---+---+---+---+---+---+ | SOR-CMCI rule 2 | octet (q+1)* | | | | | | | | | | | | | | | | | | | | octet r* | | | | | | | | +-----------------------------+---------------+---+---+---+---+---+---+---+ | ... | octet (r+1)* | | | | | | | | | | | | | | | | | | | | octet s* | | | | | | | | +-----------------------------+---------------+---+---+---+---+---+---+---+ | SOR-CMCI rule n | octet (s+1)* | | | | | | | | | | | | | | | | | | | | octet p* | | | | | | | | +-----------------------------+---------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.7: SOR-CMCI
Table 9.11.3.51.2: SOR-CMCI
+----------------------------------------------------------------------+ | SOR-CMCI rule: | | | | The SOR-CMCI rule is coded according to figure 9.11.3.51.8 and | | table 9.11.3.51.3. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | If the length of SOR-CMCI contents field indicates a length bigger | | than indicated in figure 9.11.3.51.7, receiving entity shall ignore | | any superfluous octets located at the end of the SOR-CMCI. | +----------------------------------------------------------------------+
+----------------------------------+---------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------+---------------+---+---+---+---+---+---+---+ | Length of SOR-CMCI rule contents | octet q+1 | | | | | | | | | | | | | | | | | | | | octet q+2 | | | | | | | | +----------------------------------+---------------+---+---+---+---+---+---+---+ | Tsor-cm timer value | octet q+3 | | | | | | | | +----------------------------------+---------------+---+---+---+---+---+---+---+ | Criterion type | octet q+4 | | | | | | | | +----------------------------------+---------------+---+---+---+---+---+---+---+ | Criterion value | octet (q+5)* | | | | | | | | | | | | | | | | | | | | octet r* | | | | | | | | +----------------------------------+---------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.8: SOR-CMCI rule
Table 9.11.3.51.3: SOR-CMCI rule
+----------------------------------------------------------------------+ | Tsor-cm timer value | | | | The Tsor-cm timer value field is coded according to octet 2 of the | | GPRS timer information element as specified in 3GPP TS 24.008 [12] | | subclause 10.5.7.3 and indicates the Tsor-cm timer value. When the | | unit field of the Tsor-cm timer value field indicates that the timer | | is deactivated, the receiving entity shall consider that Tsor-cm | | timer value is set to the infinity value. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | Criterion type | +----------------------------------------------------------------------+ | Bits | | | | **8 7 6 5 4 3 2 1** | | | | 0 0 0 0 0 0 0 1 DNN | | | | 0 0 0 0 0 0 1 0 S-NSSAI SST | | | | 0 0 0 0 0 0 1 1 S-NSSAI SST and SD | | | | 0 0 0 0 0 1 0 0 IMS registration related signalling | | | | 0 0 0 0 0 1 0 1 MMTEL voice call | | | | 0 0 0 0 0 1 1 0 MMTEL video call | | | | 0 0 0 0 0 1 1 1 SMS over NAS or SMSoIP | | | | 0 0 0 0 1 0 0 0 SOR security check not successful | | | | 1 1 1 1 1 1 1 1 match all | | | | All other values are spare. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | The receiving entity shall ignore SOR-CMCI rule with criterion of | | criterion type set to a spare value. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | For \"DNN\", the criterion value field shall be encoded as a DNN | | length-value pair field. | | | | For \"S-NSSAI SST\", the criterion value field shall be encoded as | | one octet SST field. | | | | For \"S-NSSAI SST and SD\", the criterion value field shall be | | encoded as a sequence of one octet SST field and three octets SD | | field. The SST field shall be transmitted first. | | | | The DNN length-value pair field shall be encoded as a sequence of | | one octet DNN value length field and a DNN value field. The DNN | | value length field shall be transmitted first. The DNN value length | | field indicates the length in octets of the DNN value field. The DNN | | value field contains an APN as specified in 3GPP TS 23.003 [4]. | | | | The SST field contains SST of HPLMN\'s S-NSSAI. | | | | The SD field contains SD of HPLMN\'s S-NSSAI. | | | | For \"match all\", \"SOR security check not successful\", \"IMS | | registration related signalling\", \"MMTEL voice call\", \"MMTEL | | video call\", and \"SMS over NAS or SMSoIP\", the criterion value | | field is zero octets long. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | If the length of SOR-CMCI rule contents field indicates a length | | bigger than indicated in figure 9.11.3.51.8, receiving entity shll | | ignore any superfluous octets located at the end of the SOR-CMCI | | rule. | | | | The UE applies SOR-CMCI rules as described in 3GPP TS 23.122 [5] | | annex C. | +----------------------------------------------------------------------+
+-------+-------+-------+-------+-------+-------+------+------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+------+------+-------+ | L | octet | | | | | | | | | ength | (p+1) | | | | | | | | | of | | | | | | | | | | S | octet | | | | | | | | | OR-SN | (p+2) | | | | | | | | | PN-SI | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | CLGI | CLSI | octet | | | | | | | | | | (p+3) | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+------+------+-------+ | CH | octet | | | | | | | | | contr | (p | | | | | | | | | olled | +4)* | | | | | | | | | p | | | | | | | | | | riori | octet | | | | | | | | | tized | t* | | | | | | | | | list | | | | | | | | | | of | | | | | | | | | | pref | | | | | | | | | | erred | | | | | | | | | | SNPNs | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+------+-------+ | CH | octet | | | | | | | | | contr | (t | | | | | | | | | olled | +1)* | | | | | | | | | p | | | | | | | | | | riori | octet | | | | | | | | | tized | u* | | | | | | | | | list | | | | | | | | | | of | | | | | | | | | | GINs | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+------+-------+
Figure 9.11.3.51.9: SOR-SNPN-SI
Table 9.11.3.51.4: SOR-SNPN-SI
+----------------------------------+----------------------------------+ | CH controlled prioritized list | | | of preferred SNPNs indicator | | | (CLSI) value (octet p+3, bit 1) | | | | | | Bit | | +----------------------------------+----------------------------------+ | **1** | | +----------------------------------+----------------------------------+ | 0 | CH controlled prioritized list | | | of preferred SNPNs absent | +----------------------------------+----------------------------------+ | 1 | CH controlled prioritized list | | | of preferred SNPNs present | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | If the CLSI bit is set to \"CH | | | controlled prioritized list of | | | preferred SNPNs present\", the | | | CH controlled prioritized list | | | of preferred SNPNs field is | | | present. If the CLSI bit is set | | | to \"CH controlled prioritized | | | list of preferred SNPNs | | | absent\", the CH controlled | | | prioritized list of preferred | | | SNPNs field is absent. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | CH controlled prioritized list | | | of GINs indicator (CLGI) value | | | (octet p+3, bit 2) | | | | | | Bit | | +----------------------------------+----------------------------------+ | **2** | | +----------------------------------+----------------------------------+ | 0 | CH controlled prioritized list | | | of GINs absent | +----------------------------------+----------------------------------+ | 1 | CH controlled prioritized list | | | of GINs present | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | If the CLGI bit is set to \"CH | | | controlled prioritized list of | | | GINs present\", the CH | | | controlled prioritized list of | | | GINs field is present. If the | | | CLGI bit is set to \"CH | | | controlled prioritized list of | | | GINs absent\", the CH controlled | | | prioritized list of GINs field | | | is absent. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | If the length of SOR-SNPN-SI | | | contents field indicates a | | | length bigger than indicated in | | | figure 9.11.3.51.9, receiving | | | entity shall ignore any | | | superfluous octets located at | | | the end of the SOR-SNPN-SI. | | +----------------------------------+----------------------------------+
+---------------------+---------------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+---------------------+---+---+---+---+---+---+---+ | Length of CH | octet p+4 | | | | | | | | | controlled | | | | | | | | | | prioritized list of | octet p+5 | | | | | | | | | preferred SNPNs | | | | | | | | | | contents | | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | SNPN identity 1 | octet (p+6)* | | | | | | | | | | | | | | | | | | | | octet (p+14)* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | SNPN identity 2 | octet (p+15)* | | | | | | | | | | | | | | | | | | | | octet (p+23)* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | ... | octet (p+24)* | | | | | | | | | | | | | | | | | | | | octet (p+n*9-2)* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | SNPN identity n | octet (p+n*9-3)* | | | | | | | | | | | | | | | | | | | | octet (p+n*9+5)* | | | | | | | | | | = octet t* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.10: CH controlled prioritized list of preferred SNPNs
+---------+---------+---------+-------+---------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+---------+-------+---------+---------+---+---+---+ | MCC | MCC | octet | | | | | | | | digit 2 | digit 1 | p+15 | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | MNC | MCC | octet | | | | | | | | digit 3 | digit 3 | p+16 | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | MNC | MNC | octet | | | | | | | | digit 2 | digit 1 | p+17 | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | 0 | 0 | 0 | 0 | NID | octet | | | | | | | | | ass | p+18 | | | | | Spare | Spare | Spare | Spare | ignment | | | | | | | | | | mode | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | p+19 | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | p+20 | | | | | | | | digit 4 | digit 3 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | p+21 | | | | | | | | digit 6 | digit 5 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | p+22 | | | | | | | | digit 8 | digit 7 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | p+23 | | | | | | | | digit | digit 9 | | | | | | | | | 10 | | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+
Figure 9.11.3.51.11: SNPN identity
Table 9.11.3.51.5: CH controlled prioritized list of preferred SNPNs
+----------------------------------------------------------------------+ | Mobile country code (MCC): | | | | The MCC field is coded as in ITU-T Recommendation E.212 [42], | | annex A. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | Mobile network code (MNC): | | | | The coding of MNC field is the responsibility of each administration | | but BCD coding shall be used. The MNC shall consist of 2 or 3 | | digits. If a network operator decides to use only two digits in the | | MNC, MNC digit 3 shall be coded as \"1111\". | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NID assignment mode (see NOTE) | +----------------------------------------------------------------------+ | NID assignment mode is coded as specified in 3GPP TS 23.003 [4]. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NID value (see NOTE) | +----------------------------------------------------------------------+ | NID value is coded as specified in 3GPP TS 23.003 [4]. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NOTE: NID coding deviates from coding of value part of NID IE as | | specified in subclause 9.2.7 of 3GPP TS 24.502 [18]. | +----------------------------------------------------------------------+
+---------------------+---------------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+---------------------+---+---+---+---+---+---+---+ | Length of CH | octet t+1 | | | | | | | | | controlled | | | | | | | | | | prioritized list of | octet t+2 | | | | | | | | | GINs contents | | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | GIN 1 | octet (t+3)* | | | | | | | | | | | | | | | | | | | | octet (t+11)* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | GIN 2 | octet (t+12)* | | | | | | | | | | | | | | | | | | | | octet (t+20)* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | ... | octet (t+21)* | | | | | | | | | | | | | | | | | | | | octet (t+n*9-5)* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+ | GIN n | octet (t+n*9-6)* | | | | | | | | | | | | | | | | | | | | octet (t+n*9+2)* | | | | | | | | | | = octet u* | | | | | | | | +---------------------+---------------------+---+---+---+---+---+---+---+
Figure 9.11.3.51.12: CH controlled prioritized list of GINs
+---------+---------+---------+-------+---------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+---------+-------+---------+---------+---+---+---+ | MCC | MCC | octet | | | | | | | | digit 2 | digit 1 | t+12 | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | MNC | MCC | octet | | | | | | | | digit 3 | digit 3 | t+13 | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | MNC | MNC | octet | | | | | | | | digit 2 | digit 1 | t+14 | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | 0 | 0 | 0 | 0 | NID | octet | | | | | | | | | ass | t+15 | | | | | Spare | Spare | Spare | Spare | ignment | | | | | | | | | | mode | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | t+16 | | | | | | | | digit 2 | digit 1 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | t+17 | | | | | | | | digit 4 | digit 3 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | t+18 | | | | | | | | digit 6 | digit 5 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | t+19 | | | | | | | | digit 8 | digit 7 | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+ | NID | NID | octet | | | | | | | | value | value | t+20 | | | | | | | | digit | digit 9 | | | | | | | | | 10 | | | | | | | | | +---------+---------+---------+-------+---------+---------+---+---+---+
Figure 9.11.3.51.13: GIN
Table 9.11.3.51.6: CH controlled prioritized list of GINs
+----------------------------------------------------------------------+ | Mobile country code (MCC): | | | | The MCC field is coded as in ITU-T Recommendation E.212 [42], | | annex A. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | Mobile network code (MNC): | | | | The coding of MNC field is the responsibility of each administration | | but BCD coding shall be used. The MNC shall consist of 2 or 3 | | digits. If a network operator decides to use only two digits in the | | MNC, MNC digit 3 shall be coded as \"1111\". | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NID assignment mode (see NOTE) | +----------------------------------------------------------------------+ | NID assignment mode is coded as specified in 3GPP TS 23.003 [4]. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NID value (see NOTE) | +----------------------------------------------------------------------+ | NID value is coded as specified in 3GPP TS 23.003 [4]. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NOTE: NID coding deviates from coding of value part of NID IE as | | specified in subclause 9.2.7 of 3GPP TS 24.502 [18]. | +----------------------------------------------------------------------+
#### 9.11.3.51A Supported codec list
See subclause 10.5.4.32 in 3GPP TS 24.008 [12].
#### 9.11.3.52 Time zone
See subclause 10.5.3.8 in 3GPP TS 24.008 [12].
#### 9.11.3.53 Time zone and time
See subclause 10.5.3.9 in 3GPP TS 24.008 [12].
#### 9.11.3.53A UE parameters update transparent container
The purpose of the UE parameters update transparent container when sent from
the network to the UE is to provide UE parameters update data, optional
acknowledgement request and optional re-registration request. The purpose of
the UE parameters update transparent container when sent from the UE to the
network is to indicate the UE acknowledgement of successful reception of the
UE parameters update transparent container.
The UE parameters update transparent container information element is coded as
shown in figure 9.11.3.53A.1, figure 9.11.3.53A.2, figure 9.11.3.53A.3, figure
9.11.3.53A.4, figure 9.11.3.53A.4B, figure 9.11.3.53A.5, figure 9.11.3.53A.6,
figure 9.11.3.53A.7 and table 9.11.3.53A.1.
The UE parameters update transparent container is a type 6 information element
with a minimum length of 20 octets.
+---------------------+------------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+------------------+---+---+---+---+---+---+---+ | UE parameters | octet 1 | | | | | | | | | update transparent | | | | | | | | | | container IEI | | | | | | | | | +---------------------+------------------+---+---+---+---+---+---+---+ | Length of UE | octet 2 | | | | | | | | | parameters update | | | | | | | | | | transparent | octet 3 | | | | | | | | | container contents | | | | | | | | | +---------------------+------------------+---+---+---+---+---+---+---+ | UE parameters | octet 4 | | | | | | | | | update header | | | | | | | | | +---------------------+------------------+---+---+---+---+---+---+---+ | UPU-MAC-I~AUSF~ | octet 5-20 | | | | | | | | +---------------------+------------------+---+---+---+---+---+---+---+ | Counter~UPU~ | octet 21-22 | | | | | | | | +---------------------+------------------+---+---+---+---+---+---+---+ | UE parameters | octet 23* - n* | | | | | | | | | update list | | | | | | | | | +---------------------+------------------+---+---+---+---+---+---+---+
Figure 9.11.3.53A.1: UE parameters update transparent container information
element for UE parameters update data type with value \"0\"
+---------+---------+-------+-------+---------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+-------+-------+---------+---------+---+---+---+ | 0 | 0 | 0 | 0 | UE | octet | | | | | | | | | par | 23* | | | | | Spare | Spare | Spare | Spare | ameters | | | | | | | | | | update | | | | | | | | | | data | | | | | | | | | | set 1 | | | | | | | | | | type | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | Length | octet | | | | | | | | | of UE | 24*- | | | | | | | | | par | | | | | | | | | | ameters | 25* | | | | | | | | | update | | | | | | | | | | data | | | | | | | | | | set 1 | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | UE | octet | | | | | | | | | par | 26*- | | | | | | | | | ameters | | | | | | | | | | update | x* | | | | | | | | | data | | | | | | | | | | set 1 | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | ... | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | 0 | 0 | 0 | 0 | UE | octet | | | | | | | | | par | y* | | | | | Spare | Spare | Spare | Spare | ameters | | | | | | | | | | update | | | | | | | | | | data | | | | | | | | | | set n | | | | | | | | | | type | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | Length | octet | | | | | | | | | of UE | y+1*- | | | | | | | | | par | | | | | | | | | | ameters | y+2* | | | | | | | | | update | | | | | | | | | | data | | | | | | | | | | set n | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | UE | octet | | | | | | | | | par | y+3*- | | | | | | | | | ameters | | | | | | | | | | update | n* | | | | | | | | | data | | | | | | | | | | set n | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+
Figure 9.11.3.53A.2: UE parameters update list
* * *
8 7 6 5 4 3 2 1  
Secured packet octet a* - a+z*
* * *
Figure 9.11.3.53A.3: UE parameters update data set for UE parameters update
data set type with value \"0001\"
+--------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------+-------------+---+---+---+---+---+---+---+ | Default configured NSSAI | octet b* - | | | | | | | | | | | | | | | | | | | | c* | | | | | | | | +--------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.53A.4: UE parameters update data set for UE parameters update
data set type with value \"0010\"
+-------+-------+-------+-------+-------+-------+-----+------+-----------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-----+------+-----------+ | 0 | 0 | 0 | 0 | 0 | 0 | AOL | DREI | octet d* | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+-----+------+-----------+
Figure 9.11.3.53A.4A: UE parameters update data set for UE parameters update
data set type with value \"0011\"
* * *
8 7 6 5 4 3 2 1  
Routing indicator digit 2 Routing indicator digit 1 octet e*  
Routing indicator digit 4 Routing indicator digit 3 octet (e+1)*
* * *
Figure 9.11.3.53A.4B: UE parameters update data set for UE parameters update
data set type with value \"0100\"
+------------------------------------------------------+--------------+ | UE parameters update transparent container IEI | octet 1 | +------------------------------------------------------+--------------+ | Length of UE parameters update transparent container | octet 2 | | contents | | | | octet 3 | +------------------------------------------------------+--------------+ | UE parameters update header | octet 4 | +------------------------------------------------------+--------------+ | UPU-MAC-I~UE~ | octet 5 - 20 | +------------------------------------------------------+--------------+
Figure 9.11.3.53A.5: UE parameters update transparent container information
element for UE parameters update data type with value \"1\"
+-------+-------+-------+-------+-------+-----+-----+---------------+---------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-----+-----+---------------+---------+ | 0 | 0 | 0 | 0 | 0 | REG | ACK | UPU data type | octet 4 | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | | | | | +-------+-------+-------+-------+-------+-----+-----+---------------+---------+
Figure 9.11.3.53A.6: UE parameters update header for UE parameters update data
type with value \"0\"
+-------+-------+-------+-------+-------+-------+-------+---------------+---------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+---------------+---------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | UPU data type | octet 4 | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | | +-------+-------+-------+-------+-------+-------+-------+---------------+---------+
Figure 9.11.3.53A.7: UE parameters update header for UE parameters update data
type with value \"1\"
Table 9.11.3.53A.1: UE parameters update transparent container information
element
+----------------------------------+----------------------------------+ | UPU-MAC-I~AUSF~, UPU-MAC-I~UE~ | | | and Counter~UPU~ are coded as | | | specified in | | | 3GPP TS 33.501 [24] | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | UPU data type (octet 4, bit 1) | | +----------------------------------+----------------------------------+ | 0 | The UE parameters update | | | transparent container carries a | | | UE parameters update list | +----------------------------------+----------------------------------+ | 1 | The UE parameters update | | | transparent container carries an | | | acknowledgement of successful | | | reception of a UE parameters | | | update list | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Acknowledgement (ACK) value | | | (octet 4, bit 2) | | +----------------------------------+----------------------------------+ | 0 | acknowledgement not requested | +----------------------------------+----------------------------------+ | 1 | acknowledgement requested | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Re-registration (REG) value | | | (octet 4, bit 3) | | +----------------------------------+----------------------------------+ | 0 | re-registration not requested | +----------------------------------+----------------------------------+ | 1 | re-registration requested | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | UE parameters update data set | | | type | | +----------------------------------+----------------------------------+ | Bits | | | | | | 4 3 2 1 | | +----------------------------------+----------------------------------+ | 0 0 0 1 Routing indicator update | | | data | | +----------------------------------+----------------------------------+ | 0 0 1 0 Default configured NSSAI | | | update data | | +----------------------------------+----------------------------------+ | 0 0 1 1 Disaster roaming | | | information update data | | +----------------------------------+----------------------------------+ | 0 1 0 0 ME routing indicator | | | update data | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | All other values are reserved | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Disaster Roaming Enabled | | | Indication (DREI) value (octet | | | d*, bit 1) | | +----------------------------------+----------------------------------+ | 0 Disast | | | er roaming is disabled in the UE | | | --- -------- | | | -------------------------------- | | | 1 Disas | | | ter roaming is enabled in the UE | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Indication of \'applicability of | | | \"lists of PLMN(s) to be used in | | | disaster condition\" provided by | | | a VPLMN\' (AOL) value (octet | | | d*, bit 2) | | +----------------------------------+----------------------------------+ | 0 false | | | --- ------- | | | 1 true | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | The secured packet is coded as | | | specified in | | | 3GPP TS 31.115 [22B]. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | The default configured NSSAI is | | | encoded as the value part of the | | | NSSAI IE (see | | | subclause 9.11.3.37). | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Routing indicator | | +----------------------------------+----------------------------------+ | Routing indicator is encoded as | | | the routing indicator field of | | | the 5GS mobile identity IE (see | | | subclause 9.11.3.4). | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | NOTE: When the routing indicator | | | is updated, if the SNPN uses the | | | EAP based primary authentication | | | and key agreement procedure | | | using the EAP-AKA\' or the 5G | | | AKA based primary authentication | | | and key agreement procedure, | | | then UE parameter update data | | | set type is set to \"routing | | | indicator update data\", | | | otherwise, UE parameter update | | | data set type is set to \"ME | | | routing indicator update data\". | | +----------------------------------+----------------------------------+
#### 9.11.3.54 UE security capability
The UE _security_ capability information element is used by the UE and by the
network to indicate which security algorithms are supported by the UE in N1
mode for NAS security as well as which security algorithms are supported over
NR and E-UTRA connected to 5GCN for AS security.
The UE _security_ capability information element is coded as shown in figure
9.11.3.54.1 and table 9.11.3.54.1.
The UE _security capability_ is a type 4 information element with a minimum
length of 4 octets and a maximum length of 10 octets.
Octets 5 to 10 are optional. If octet 5 is included, then also octet 6 shall
be included.
If the UE does not support any security algorithm for AS security over E-UTRA
connected to 5GCN, it shall not include octets 5 and 6. The UE shall not
include octets 7 to 10.
If the UE does not support any security algorithm for AS security over E-UTRA
connected to 5GCN, and if the network includes octets 7 to 10, then the
network shall also include octets 5 to 6.
If the network includes octet 7, then it shall include also octet 8. If the
network includes octet 9, then it shall include also octet 10.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | UE | octet | | | | | | | | | _sec | 1 | | | | | | | | | urity | | | | | | | | | | c | | | | | | | | | | apabi | | | | | | | | | | lity_ | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of UE | | | | | | | | | | _sec | | | | | | | | | | urity | | | | | | | | | | capab | | | | | | | | | | ility | | | | | | | | | | cont | | | | | | | | | | ents_ | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 128- | 128- | 128- | 5 | 5 | 5 | 5 | octet | | G-EA0 | | | | G-EA4 | G-EA5 | G-EA6 | G-EA7 | 3 | | | 5 | 5 | 5 | | | | | | | | G-EA1 | G-EA2 | G-EA3 | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 128- | 128- | 128- | 5 | 5 | 5 | 5 | octet | | G-IA0 | | | | G-IA4 | G-IA5 | G-IA6 | G-IA7 | 4 | | | 5 | 5 | 5 | | | | | | | | G-IA1 | G-IA2 | G-IA3 | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | EEA0 | 128- | 128- | 128- | EEA4 | EEA5 | EEA6 | EEA7 | octet | | | | | | | | | | 5* | | | EEA1 | EEA2 | EEA3 | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | EIA0 | 128- | 128- | 128- | EIA4 | EIA5 | EIA6 | EIA7 | octet | | | | | | | | | | 6* | | | EIA1 | EIA2 | EIA3 | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | octet | | | | | | | | | | 7* | | | | | | | | | | -10* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.54.1: UE security capability information element
Table 9.11.3.54.1: UE _security capability_ information element
+----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithms | | | | | | supported (see NOTE 1) | | | | | | (octet 3) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 5G-EA0 supported (octet 3, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 5G-EA0 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 5G-EA0 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 128-5G-EA1 supported | | | | | | (octet 3, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 128-5G-EA1 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 128-5G-EA1 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 128-5G-EA2 supported | | | | | | (octet 3, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 128-5G-EA2 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 128-5G-EA2 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 128-5G-EA3 supported | | | | | | (octet 3, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 128-5G-EA3 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 128-5G-EA3 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 5G-EA4 supported (octet 3, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 5G-EA4 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 5G-EA4 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 5G-EA5 supported (octet 3, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 5G-EA5 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 5G-EA5 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 5G-EA6 supported (octet 3, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 5G-EA6 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 5G-EA6 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS encryption algorithm | | | | | | 5G-EA7 supported (octet 3, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS encryption algorithm | | | | | | 5G-EA7 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS encryption algorithm | | | | | | 5G-EA7 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithms | | | | | | supported (see NOTE 2) | | | | | | (octet 4) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 5G-IA0 supported (octet 4, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 5G-IA0 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 5G-IA0 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 128-5G-IA1 supported | | | | | | (octet 4, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 128-5G-IA1 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 128-5G-IA1 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 128-5G-IA2 supported | | | | | | (octet 4, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 128-5G-IA2 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 128-5G-IA2 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 128-5G-IA3 supported | | | | | | (octet 4, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 128-5G-IA3 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 128-5G-IA3 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 5G-IA4 supported (octet 4, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 5G-IA4 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 5G-IA4 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 5G-IA5 supported (octet 4, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 5G-IA5 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 5G-IA5 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 5G-IA6supported (octet 4, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 5G-IA6 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 5G-IA6 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 5GS integrity algorithm | | | | | | 5G-IA7 supported (octet 4, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | 5GS integrity algorithm | | | | | | 5G-IA7 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | 5GS integrity algorithm | | | | | | 5G-IA7 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithms | | | | | | supported (see NOTE 3) | | | | | | (octet 5) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | EEA0 supported (octet 5, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | EEA0 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | EEA0 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | 128-EEA1 supported (octet | | | | | | 5, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | 128-EEA1 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | 128-EEA1 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | 128-EEA2 supported (octet | | | | | | 5, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | 128-EEA2 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | 128-EEA2 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | 128-EEA3 supported (octet | | | | | | 5, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | 128-EEA3 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | 128-EEA3 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | EEA4 supported (octet 5, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | EEA4 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | EEA4 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | EEA5 supported (octet 5, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | EEA5 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | EEA5 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | EEA6 supported (octet 5, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | EEA6 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | EEA6 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS encryption algorithm | | | | | | EEA7 supported (octet 5, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS encryption algorithm | | | | | | EEA7 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS encryption algorithm | | | | | | EEA7 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithms | | | | | | supported (see NOTE 4) | | | | | | (octet 6) | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | EIA0 supported (octet 6, | | | | | | bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | EIA0 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | EIA0 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | 128-EIA1 supported (octet | | | | | | 6, bit 7) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | 128-EIA1 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | 128-EIA1 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | 128-EIA2 supported (octet | | | | | | 6, bit 6) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | 128-EIA2 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | 128-EIA2 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | 128-EIA3 supported (octet | | | | | | 6, bit 5) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | 128-EIA3 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | 128-EIA3 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | EIA4 supported (octet 6, | | | | | | bit 4) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | EIA4 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | EIA4 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | EIA5 supported (octet 6, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | EIA5 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | EIA5 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | EIA6 supported (octet 6, | | | | | | bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | EIA6 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | EIA6 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | EPS integrity algorithm | | | | | | EIA7 supported (octet 6, | | | | | | bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | EPS integrity algorithm | | | | | | EIA7 not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | EPS integrity algorithm | | | | | | EIA7 supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | For the UE not supporting | | | | | | any security algorithm for | | | | | | AS security over E-UTRA | | | | | | connected to 5GCN, all | | | | | | bits in octets 5 to 10 are | | | | | | spare and shall be | | | | | | ignored, if the respective | | | | | | octet is received with the | | | | | | information element. | | | | | | | | | | | | For the UE supporting at | | | | | | least one security | | | | | | algorithm for AS security | | | | | | over E-UTRA connected to | | | | | | 5GCN all bits in octets 7 | | | | | | to 10 are spare and shall | | | | | | be ignored, if the | | | | | | respective octet is | | | | | | received with the | | | | | | information element. | | | | | | | | | | | | If the AMF receives any of | | | | | | the octets 7 to 10 | | | | | | (NOTE 5), it shall store | | | | | | the octets as received and | | | | | | include them when sending | | | | | | the UE security capability | | | | | | information element to the | | | | | | UE. | | | | | +----------------------------+---+---+---+----------------------------+ | NOTE 1: The code points in | | | | | | octet 3 are used to | | | | | | indicate support for 5GS | | | | | | encryption algorithms for | | | | | | NAS security in N1 mode | | | | | | and support for 5GS | | | | | | encryption algorithms for | | | | | | AS security over NR. | | | | | | | | | | | | NOTE 2: The code points in | | | | | | octet 4 are used to | | | | | | indicate support for 5GS | | | | | | integrity algorithms for | | | | | | NAS security in N1 mode | | | | | | and support for 5GS | | | | | | integrity algorithms for | | | | | | AS security over NR. | | | | | | | | | | | | NOTE 3: The code points in | | | | | | octet 5 are used to | | | | | | indicate support for EPS | | | | | | encryption algorithms for | | | | | | AS security over E-UTRA | | | | | | connected to 5GCN. | | | | | | | | | | | | NOTE 4: The code points in | | | | | | octet 6 are used to | | | | | | indicate support for EPS | | | | | | integrity algorithms for | | | | | | AS security over E-UTRA | | | | | | connected to 5GCN. | | | | | | | | | | | | NOTE 5: The AMF can | | | | | | receive this information | | | | | | element also from another | | | | | | AMF or MME during N1 mode | | | | | | to N1 mode or S1 mode to | | | | | | N1 mode handover | | | | | | preparation. | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.55 UE\'s usage setting
The purpose of the UE\'s usage setting information element is to provide the
network with the UE\'s usage setting as defined in 3GPP TS 24.301 [15]. The
network uses **the UE\'s usage setting** to select the RFSP index.
The UE\'s usage setting information element is coded as shown in figure
9.11.3.55.1 and table 9.11.3.55.1.
The UE\'s usage setting is a type 4 information element with a length of 3
octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | UE\'s | octet | | | | | | | | | usage | 1 | | | | | | | | | se | | | | | | | | | | tting | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | UE\'s | | | | | | | | | | usage | | | | | | | | | | se | | | | | | | | | | tting | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | UE\'s | octet | | | | | | | | | usage | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | se | | | | | | | | | | tting | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.55.1: UE\'s usage setting information element
Table 9.11.3.55.1: UE\'s usage setting information element
* * *
UE\'s usage setting (octet 3, bit 1)  
0 voice centric 1 data centric
All other bits in the octet 3 are spare and shall be coded as zero,
* * *
#### 9.11.3.56 UE status
The purpose of the UE status information element is to provide the network
with information concerning aspects of the current UE registration status
which is used for interworking with EPS.
The UE status information element is coded as shown in figure 9.11.3.56.1 and
table 9.11.3.56.1.
The UE status is a type 4 information element with a length of 3 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | UE | octet | | | | | | | | | s | 1 | | | | | | | | | tatus | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of UE | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | N1 | S1 | octet | | | | | | | | mode | mode | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | reg | reg | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.56.1: UE status information element
Table 9.11.3.56.1: UE status information element
* * *
EMM registration status (S1 mode reg) (octet 3, bit 1)  
0 UE is not in EMM-REGISTERED state 1 UE is in EMM-REGISTERED state
5GMM registration status (N1 mode reg) (octet 3, bit 2)  
0 UE is not in 5GMM-REGISTERED state 1 UE is in 5GMM-REGISTERED state
All other bits in the octet 3 are spare and shall be coded as zero.
* * *
#### 9.11.3.57 Uplink data status
The purpose of the Uplink data status information element is to indicate to
the network which preserved PDU sessions have uplink data pending.
The Uplink data status information element is coded as shown in figure
9.11.3.57.1 and table 9.11.3.57.1.
The Uplink data status information element is a type 4 information element
with minimum length of 4 octets a maximum length of 34 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | U | octet | | | | | | | | | plink | 1 | | | | | | | | | data | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | u | | | | | | | | | | plink | | | | | | | | | | data | | | | | | | | | | s | | | | | | | | | | tatus | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 3 | | (7) | (6) | (5) | (4) | (3) | (2) | (1) | (0) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 4 | | \ | \ | \ | \ | \ | \ | (9) | (8) | | | (15) | (14) | (13) | (12) | (11) | (10) | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | spare | octet | | | | | | | | | | 5* | | | | | | | | | | -34* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.57.1: Uplink data status information element
Table 9.11.3.57.1: Uplink data status information element
+----------------------------------------------------------------------+ | PSI(x) shall be coded as follows: | | | | PSI(0): | | | | Bit 1 of octet 3 is spare and shall be coded as zero. | | | | PSI(1) -- PSI(15): | | | | 0 indicates that no uplink data are pending for the corresponding | | PDU session identity or the PDU session is in PDU SESSION INACTIVE | | state or is in PDU SESSION ACTIVE state with user-plane resources | | already established. | | | | 1 indicates that uplink data are pending for the corresponding PDU | | session identity and the user-plane resources for the corresponding | | PDU session are not established. | | | | All bits in octet 5 to 34 are spare and shall be coded as zero, if | | the respective octet is included in the information element. | +----------------------------------------------------------------------+
#### 9.11.3.58 Void
#### 9.11.3.59 Void
#### 9.11.3.60 Void
#### 9.11.3.61 Void
#### 9.11.3.62 Void
#### 9.11.3.63 Void
#### 9.11.3.64 Void
#### 9.11.3.65 Void
#### 9.11.3.66 Void
#### 9.11.3.67 Void
#### 9.11.3.68 UE radio capability ID
The purpose of the UE radio capability ID information element is to carry a UE
radio capability ID.
The UE radio capability ID information element is coded as shown in figure
9.11.3.68.1 and table 9.11.3.68.1.
The UE radio capability ID is a type 4 information element with a length of n
octets.
* * *
8 7 6 5 4 3 2 1  
UE radio capability ID IEI octet 1  
Length of UE radio capability ID _contents_ octet 2  
UE radio capability ID octet 3  
octet n
* * *
Figure 9.11.3.68.1: UE radio capability ID information element
Table 9.11.3.68.1: UE radio capability ID information element
* * *
UE radio capability ID (octets 3 to n) The UE radio capability ID contents
contain the UE radio capability ID as specified in 3GPP TS 23.003 [4], with
each hexadecimal digit coded over 4 bits, starting with the first hexadecimal
digit coded in bits 4 to 1 of octet 3, the second hexadecimal digit coded in
bits 8 to 5 of octet 3, and so on. If the UE radio capability ID contains an
odd number of hexadecimal digits, bits 8 to 5 of the last octet (octet n)
shall be coded as \"1111\".
* * *
#### 9.11.3.69 UE radio capability ID deletion indication
The purpose of the UE radio capability ID deletion indication information
element is to indicate to the UE that deletion of UE radio capability IDs is
requested.
The UE radio capability ID deletion indication is a type 1 information
element.
The UE radio capability ID deletion indication information element is coded as
shown in figure 9.11.3.69.1 and table 9.11.3.69.1.
+------------+-------+------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------+-------+------------+---------+---+---+---+---+---+ | UE radio | 0 | Deletion | octet 1 | | | | | | | capability | | request | | | | | | | | ID | spare | | | | | | | | | deletion | | | | | | | | | | indication | | | | | | | | | | | | | | | | | | | | IEI | | | | | | | | | +------------+-------+------------+---------+---+---+---+---+---+
Figure 9.11.3.69.1: UE radio capability ID deletion indication information
element
Table 9.11.3.69.1: UE radio capability ID deletion indication information
element
* * *
Deletion requested (octet 1)  
Bits  
3 2 1  
0 0 0 UE radio capability ID deletion not requested 0 0 1 Network-assigned UE
radio capability IDs deletion requested
All other values are unused and shall be interpreted as \"UE radio capability
ID deletion not requested\", if received by the UE.
* * *
#### 9.11.3.70 Truncated 5G-S-TMSI configuration
The purpose of the Truncated 5G-S-TMSI configuration information element is to
provide the size of the components of the truncated 5G-S-TMSI to the UE in
NB-N1 mode to create the truncated 5G-S-TMSI.
The Truncated 5G-S-TMSI configuration information element is coded as shown in
figure 9.11.3.70.1 and table 9.11.3.70.1.
The Truncated 5G-S-TMSI configuration is a type 4 information element with 3
octets length.
* * *
8 7 6 5 4 3 2 1  
Truncated 5G-S-TMSI configuration IEI octet 1  
Length of Truncated 5G-S-TMSI configuration _contents_ octet 2  
Truncated AMF Set ID value Truncated AMF Pointer value octet 3
* * *
Figure 9.11.3.70.1: Truncated 5G-S-TMSI configuration information element
Table 9.11.3.70.1: Truncated 5G-S-TMSI configuration information element
+----------------------------+---+---+---+----------------------------+ | Truncated AMF Pointer | | | | | | value (bits 4 to 1 of | | | | | | octet 3) | | | | | | | | | | | | This field represents the | | | | | | size of the least | | | | | | significant bits of the | | | | | | AMF Pointer. | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | 2 | 1 | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | reserved | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | 1 least significant bit of | | | | | | the AMF Pointer | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | 2 least significant bits | | | | | | of the AMF Pointer | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | 3 least significant bits | | | | | | of the AMF Pointer | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 0 | 4 least significant bits | | | | | | of the AMF Pointer | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 1 | 5 least significant bits | | | | | | of the AMF Pointer | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 1 | 0 | 6 least significant bits | | | | | | of the AMF Pointer | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other values shall be | | | | | | interpreted as \"6 least | | | | | | significant bits of the | | | | | | AMF Pointer\" by this | | | | | | version of the protocol. | | | | | +----------------------------+---+---+---+----------------------------+ | Truncated AMF Set ID value | | | | | | (bits 8 to 5 of octet 3) | | | | | | | | | | | | This field represents the | | | | | | size of the least | | | | | | significant bits of the | | | | | | AMF Set ID. | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | 2 | 1 | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | reserved | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | 1 least significant bit of | | | | | | the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | 2 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | 3 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 0 | 4 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 1 | 5 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 1 | 0 | 6 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 1 | 1 | 7 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | 0 | 0 | 8 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | 0 | 1 | 9 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | 1 | 0 | 1 | 0 | 10 least significant bits | | | | | | of the AMF Set ID | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other values shall be | | | | | | interpreted as \"10 least | | | | | | significant bits of the | | | | | | AMF Set ID\" by this | | | | | | version of the protocol. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | NOTE: Total sum of the | | | | | | \"Truncated AMF Set ID | | | | | | value\" and the | | | | | | \"Truncated AMF Pointer | | | | | | value\" in the Truncated | | | | | | 5G-S-TMSI configuration IE | | | | | | is specified in | | | | | | 3GPP TS 23.003 [4] and | | | | | | 3GPP TS 36.300 [25B]. | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.71 WUS assistance information
See subclause 9.9.3.62 in 3GPP TS 24.301 [15].
#### 9.11.3.72 N5GC indication
The purpose of the N5GC indication information element is to indicate to the
network that the registration request by the W-AGF is on behalf of an N5GC
device.
The N5GC indication information element is coded as shown in figure
9.11.3.72.1.
The N5GC indication is a type 1 information element.
+---------------------+-------+-------+-------+---------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------+-------+-------+---------+---------+---+---+---+ | N5GC indication IEI | 0 | 0 | 0 | N5GCREG | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +---------------------+-------+-------+-------+---------+---------+---+---+---+
Figure 9.11.3.72.1: N5GC indication
Table 9.11.3.72.1: N5GC indication
N5GC device indication bit (N5GCREG) (octet 1, bit 1)
* * *
Bit  
1  
0 N5GC device registration is not requested 1 N5GC device registration is
requested
Bits 2 to 4 are spare and shall be coded as zero.
#### 9.11.3.73 NB-N1 mode DRX parameters
The purpose of the NB-N1 mode DRX parameters information element is to
indicate that the UE wants to use DRX in NB-N1 mode and for the network to
indicate the DRX cycle value to be used at paging in NB-N1 mode.
The NB-N1 mode DRX parameters is a type 4 information element with a length of
3 octets.
The NB-N1 mode DRX parameters information element is coded as shown in figure
9.11.3.73.1 and table 9.11.3.73.1.
The value part of a DRX parameter information element is coded as shown in
table 9.11.3.73.1.
* * *
8 7 6 5 4 3 2 1  
NB-N1 mode DRX parameters IEI octet 1  
Length of NB-N1 mode DRX parameters contents octet 2  
0 0 0 0 NB-N1 mode DRX value  
Spare octet 3
* * *
Figure 9.11.3.73.1: NB-N1 mode DRX parameters information element
Table 9.11.3.73.1: NB-N1 mode DRX parameters information element
+----------------------------+---+---+---+----------------------------+ | NB-N1 mode DRX value | | | | | | (octet 3, bits 1 to 4) | | | | | | | | | | | | This field represents the | | | | | | DRX cycle parameter \'T\', | | | | | | for NB-N1 mode, as defined | | | | | | in 3GPP TS 36.304 [25C]. | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | 2 | 1 | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | DRX value not specified | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | DRX cycle parameter T = 32 | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | DRX cycle parameter T = 64 | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | DRX cycle parameter T = | | | | | | 128 | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 0 | DRX cycle parameter T = | | | | | | 256 | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 1 | DRX cycle parameter T = | | | | | | 512 | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 1 | 1 | DRX cycle parameter T = | | | | | | 1024 | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other values shall be | | | | | | interpreted as \"DRX value | | | | | | not specified\" by this | | | | | | version of the protocol. | | | | | | | | | | | | Bits 5 to 8 of octet 3 are | | | | | | spare and shall be coded | | | | | | as zero. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.74 Additional configuration indication
The purpose of the Additional configuration indication information element is
to indicate additional information associated with the generic UE
configuration update procedure.
The Additional configuration indication information element is coded as shown
in figure 9.11.3.74.1 and table 9.11.3.74.1.
The Additional configuration indication is a type 1 information element.
+-----------------------------------------+-------+-------+-------+------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=========================================+=======+=======+=======+======+=========+===+===+===+ | Additional configuration indication IEI | 0 | 0 | 0 | SCMR | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +-----------------------------------------+-------+-------+-------+------+---------+---+---+---+
Figure 9.11.3.74.1: Additional configuration indication
Table 9.11.3.74.1: Additional configuration indication
Signalling connection maintain request (SCMR) (octet 1, bit 1)
* * *
Bit  
1  
0 no additional information 1 release of N1 NAS signalling connection not
required
Bits 2 to 4 are spare and shall be coded as zero,
#### 9.11.3.75 Extended rejected NSSAI
The purpose of the Extended rejected NSSAI information element is to identify
a collection of rejected S-NSSAIs if UE supports extended rejected NSSAI.
The Extended rejected NSSAI information element is coded as shown in figure
9.11.3.75.1, figure 9.11.3.75.2 and table 9.11.3.75.1.
The Extended rejected NSSAI is a type 4 information element with a minimum
length of 5 octets and a maximum length of 90 octets.
+--------------------------------------------+--------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +============================================+==============+===+===+===+===+===+===+===+ | Extended rejected NSSAI IEI | octet 1 | | | | | | | | +--------------------------------------------+--------------+---+---+---+---+---+---+---+ | Length of Extended rejected NSSAI contents | octet 2 | | | | | | | | +--------------------------------------------+--------------+---+---+---+---+---+---+---+ | Partial extended rejected NSSAI list 1 | octet 3\ | | | | | | | | | | \ | | | | | | | | | | octet m | | | | | | | | +--------------------------------------------+--------------+---+---+---+---+---+---+---+ | Partial extended rejected NSSAI list 2 | octet m+1*\ | | | | | | | | | | \ | | | | | | | | | | octet n* | | | | | | | | +--------------------------------------------+--------------+---+---+---+---+---+---+---+ | ... | octet n+1*\ | | | | | | | | | | \ | | | | | | | | | | octet u* | | | | | | | | +--------------------------------------------+--------------+---+---+---+---+---+---+---+ | Partial extended rejected NSSAI list n | octet u+1*\ | | | | | | | | | | \ | | | | | | | | | | octet v* | | | | | | | | +--------------------------------------------+--------------+---+---+---+---+---+---+---+
Figure 9.11.3.75.1: Extended rejected NSSAI information element
+--------------------+--------------+--------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +====================+==============+====================+=========+===+===+===+===+===+ | spare | Type of list | Number of elements | octet 3 | | | | | | +--------------------+--------------+--------------------+---------+---+---+---+---+---+ | Rejected S-NSSAI 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet j | | | | | | | | +--------------------+--------------+--------------------+---------+---+---+---+---+---+ | Rejected S-NSSAI 2 | octet j+1* | | | | | | | | | | | | | | | | | | | | octet k* | | | | | | | | +--------------------+--------------+--------------------+---------+---+---+---+---+---+ | ... | octet k+1 | | | | | | | | | | | | | | | | | | | | octet p* | | | | | | | | +--------------------+--------------+--------------------+---------+---+---+---+---+---+ | Rejected S-NSSAI n | octet p+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +--------------------+--------------+--------------------+---------+---+---+---+---+---+
Figure 9.11.3.75.2: Partial extended rejected NSSAI list -- type of list = 000
+----------------------+--------------+--------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +======================+==============+====================+=========+===+===+===+===+===+ | spare | Type of list | Number of elements | octet 3 | | | | | | +----------------------+--------------+--------------------+---------+---+---+---+---+---+ | Back-off timer value | octet 4 | | | | | | | | +----------------------+--------------+--------------------+---------+---+---+---+---+---+ | Rejected S-NSSAI 1 | octet 5 | | | | | | | | | | | | | | | | | | | | octet j | | | | | | | | +----------------------+--------------+--------------------+---------+---+---+---+---+---+ | Rejected S-NSSAI 2 | octet j+1* | | | | | | | | | | | | | | | | | | | | octet k* | | | | | | | | +----------------------+--------------+--------------------+---------+---+---+---+---+---+ | ... | octet k+1* | | | | | | | | | | | | | | | | | | | | octet p* | | | | | | | | +----------------------+--------------+--------------------+---------+---+---+---+---+---+ | Rejected S-NSSAI n | octet p+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +----------------------+--------------+--------------------+---------+---+---+---+---+---+
Figure 9.11.3.75.3: Partial extended rejected NSSAI list -- type of list = 001
+----------------------------+-------------+---------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +============================+=============+=========+===+===+===+===+===+===+ | Length of rejected S-NSSAI | Cause value | octet 4 | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+ | SST | octet 5 | | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+ | SD | octet 6* | | | | | | | | | | | | | | | | | | | | octet 8* | | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+ | Mapped HPLMN SST | octet 9* | | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+ | Mapped HPLMN SD | octet 10* | | | | | | | | | | | | | | | | | | | | octet 12* | | | | | | | | +----------------------------+-------------+---------+---+---+---+---+---+---+
Figure 9.11.3.75.4: Rejected S-NSSAI
Table 9.11.3.75.1: Extended rejected NSSAI information element
+----------------+---+-----+---+----------------+----------------+ | Value part of | | | | | | | the Extended | | | | | | | rejected NSSAI | | | | | | | information | | | | | | | element (octet | | | | | | | 3 to v) | | | | | | +================+===+=====+===+================+================+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | The value part | | | | | | | of the | | | | | | | Extended | | | | | | | rejected NSSAI | | | | | | | information | | | | | | | element | | | | | | | consists of | | | | | | | one or more | | | | | | | partial | | | | | | | extended | | | | | | | rejected NSSAI | | | | | | | lists. The | | | | | | | length of each | | | | | | | partial | | | | | | | extended | | | | | | | rejected NSSAI | | | | | | | list can be | | | | | | | determined | | | | | | | from the | | | | | | | \'type of | | | | | | | list\' field | | | | | | | and the | | | | | | | \'number of | | | | | | | elements\' | | | | | | | field in the | | | | | | | first octet of | | | | | | | the partial | | | | | | | extended | | | | | | | rejected NSSAI | | | | | | | list. | | | | | | | | | | | | | | Each rejected | | | | | | | S-NSSAI | | | | | | | consists of | | | | | | | one S-NSSAI | | | | | | | and an | | | | | | | associated | | | | | | | cause value. | | | | | | | Each rejected | | | | | | | S-NSSAI also | | | | | | | includes the | | | | | | | mapped HPLMN | | | | | | | S-NSSAI if | | | | | | | available. The | | | | | | | length of each | | | | | | | rejected | | | | | | | S-NSSAI can be | | | | | | | determined by | | | | | | | the \'length | | | | | | | of rejected | | | | | | | S-NSSAI\' | | | | | | | field in the | | | | | | | first octet of | | | | | | | the rejected | | | | | | | S-NSSAI. | | | | | | +----------------+---+-----+---+----------------+----------------+ | The UE shall | | | | | | | store the | | | | | | | complete list | | | | | | | received | | | | | | | (NOTE 0). If | | | | | | | more than 8 | | | | | | | rejected | | | | | | | S-NSSAIs are | | | | | | | included in | | | | | | | this | | | | | | | information | | | | | | | element, the | | | | | | | UE shall store | | | | | | | the first 8 | | | | | | | rejected | | | | | | | S-NSSAIs and | | | | | | | ignore the | | | | | | | remaining | | | | | | | octets of the | | | | | | | information | | | | | | | element. | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Partial | | | | | | | extended | | | | | | | rejected NSSAI | | | | | | | list: | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Number of | | | | | | | elements | | | | | | | (octet 3, bits | | | | | | | 1 to 4) | | | | | | +----------------+---+-----+---+----------------+----------------+ | Bits | | | | | | +----------------+---+-----+---+----------------+----------------+ | 4 | 3 | 2 | 1 | | | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 0 | 0 | 1 element | | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 0 | 1 | 2 element | | +----------------+---+-----+---+----------------+----------------+ | | | ... | | | | +----------------+---+-----+---+----------------+----------------+ | 0 | 1 | 1 | 0 | 7 element | | +----------------+---+-----+---+----------------+----------------+ | 0 | 1 | 1 | 1 | 8 element | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | All other | | | | | | | values are | | | | | | | unused and | | | | | | | shall be | | | | | | | interpreted as | | | | | | | 8, if received | | | | | | | by the UE. | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Type of list | | | | | | | (octet 3, bits | | | | | | | 5 to 7) | | | | | | | (NOTE 7) | | | | | | +----------------+---+-----+---+----------------+----------------+ | Bits | | | | | | +----------------+---+-----+---+----------------+----------------+ | 7 | 6 | 5 | | | | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 0 | | list of | | | | | | | S-NSSAIs | | | | | | | without any | | | | | | | associated | | | | | | | back-off timer | | | | | | | value | | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 1 | | list of | | | | | | | S-NSSAIs with | | | | | | | one associated | | | | | | | back-off timer | | | | | | | value that | | | | | | | applies to all | | | | | | | S-NSSAIs in | | | | | | | the list | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | All other | | | | | | | values are | | | | | | | reserved. | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Bit 8 of octet | | | | | | | 3 is spare and | | | | | | | shall be coded | | | | | | | as zero. | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Back-off timer | | | | | | | value (octet | | | | | | | 4): | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Back-off timer | | | | | | | value is coded | | | | | | | as the value | | | | | | | part of GPRS | | | | | | | timer 3 in | | | | | | | subcl | | | | | | | ause 10.5.7.4a | | | | | | | in | | | | | | | 3GPP TS | | | | | | | 24.008 [12]. | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Rejected | | | | | | | S-NSSAI: | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Cause value | | | | | | | (octet 4) | | | | | | +----------------+---+-----+---+----------------+----------------+ | Bits | | | | | | +----------------+---+-----+---+----------------+----------------+ | 4 | 3 | 2 | 1 | | | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 0 | 0 | | S-NSSAI not | | | | | | | available in | | | | | | | the current | | | | | | | PLMN or SNPN | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 0 | 1 | | S-NSSAI not | | | | | | | available in | | | | | | | the current | | | | | | | registration | | | | | | | area | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 1 | 0 | | S-NSSAI not | | | | | | | available due | | | | | | | to the failed | | | | | | | or revoked | | | | | | | network | | | | | | | slice-specific | | | | | | | authentication | | | | | | | and | | | | | | | authorization | +----------------+---+-----+---+----------------+----------------+ | 0 | 0 | 1 | 1 | | S-NSSAI not | | | | | | | available due | | | | | | | to maximum | | | | | | | number of UEs | | | | | | | reached | +----------------+---+-----+---+----------------+----------------+ | All other | | | | | | | values are | | | | | | | reserved. | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Slice/service | | | | | | | type (SST) | | | | | | | (octet 5) | | | | | | +----------------+---+-----+---+----------------+----------------+ | This field | | | | | | | contains the 8 | | | | | | | bit SST value. | | | | | | | The coding of | | | | | | | the SST value | | | | | | | part is | | | | | | | defined in | | | | | | | 3GPP TS | | | | | | | 23.003 [4]. | | | | | | | (NOTE 5) | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+ | Slice | | | | | | | differentiator | | | | | | | (SD) (octet 6 | | | | | | | to octet 8) | | | | | | +----------------+---+-----+---+----------------+----------------+ | This field | | | | | | | contains the | | | | | | | 24 bit SD | | | | | | | value. The | | | | | | | coding of the | | | | | | | SD value part | | | | | | | is defined in | | | | | | | 3GPP TS | | | | | | | 23.003 [4]. | | | | | | | (NOTE 6) | | | | | | | | | | | | | | If the SST | | | | | | | encoded in | | | | | | | octet 4 is not | | | | | | | associated | | | | | | | with a valid | | | | | | | SD value, and | | | | | | | the sender | | | | | | | needs to | | | | | | | include a | | | | | | | mapped HPLMN | | | | | | | SST (octet 8) | | | | | | | and a mapped | | | | | | | HPLMN SD | | | | | | | (octets 9 to | | | | | | | 11), then the | | | | | | | sender shall | | | | | | | set the SD | | | | | | | value (octets | | | | | | | 5 to 7) to | | | | | | | \"no SD value | | | | | | | associated | | | | | | | with the | | | | | | | SST\". | | | | | | | | | | | | | | mapped HPLMN | | | | | | | Slice/service | | | | | | | type (SST) | | | | | | | (octet 9) | | | | | | | | | | | | | | This field | | | | | | | contains the 8 | | | | | | | bit SST value | | | | | | | of an S-NSSAI | | | | | | | in the | | | | | | | S-NSSAI(s) of | | | | | | | the HPLMN to | | | | | | | which the SST | | | | | | | value is | | | | | | | mapped. The | | | | | | | coding of the | | | | | | | SST value part | | | | | | | is defined in | | | | | | | 3GPP TS 23.003 | | | | | | | [4]. | | | | | | | | | | | | | | mapped HPLMN | | | | | | | Slice | | | | | | | differentiator | | | | | | | (SD) (octet 10 | | | | | | | to octet 12) | | | | | | | | | | | | | | This field | | | | | | | contains the | | | | | | | 24 bit SD | | | | | | | value of an | | | | | | | S-NSSAI in the | | | | | | | S-NSSAI(s) of | | | | | | | the HPLMN to | | | | | | | which the SD | | | | | | | value is | | | | | | | mapped. The | | | | | | | coding of the | | | | | | | SD value part | | | | | | | is defined in | | | | | | | 3GPP TS 23.003 | | | | | | | [4]. | | | | | | +----------------+---+-----+---+----------------+----------------+ | NOTE 0: The | | | | | | | number of | | | | | | | rejected | | | | | | | S-NSSAI(s) | | | | | | | shall not | | | | | | | exceed eight. | | | | | | | | | | | | | | NOTE 1: Octet | | | | | | | 4 and octet 5 | | | | | | | shall always | | | | | | | be included. | | | | | | | | | | | | | | NOTE 2: If the | | | | | | | octet 6 is | | | | | | | included, then | | | | | | | octet 7 and | | | | | | | octet 8 shall | | | | | | | be included. | | | | | | | | | | | | | | NOTE 3: If the | | | | | | | octet 9 is | | | | | | | included, then | | | | | | | octets 10, 11, | | | | | | | and 12 may be | | | | | | | included. | | | | | | | | | | | | | | NOTE 4: If the | | | | | | | octet 10 is | | | | | | | included, then | | | | | | | octet 11 and | | | | | | | octet 12 shall | | | | | | | be included. | | | | | | | | | | | | | | NOTE 5: If the | | | | | | | Cause value is | | | | | | | \"S-NSSAI not | | | | | | | available due | | | | | | | to the failed | | | | | | | or revoked | | | | | | | network | | | | | | | slice-specific | | | | | | | authentication | | | | | | | and | | | | | | | au | | | | | | | thorization\", | | | | | | | this field | | | | | | | shall contain | | | | | | | the 8 bit SST | | | | | | | value of an | | | | | | | S-NSSAI in the | | | | | | | S-NSSAI(s) of | | | | | | | the HPLMN and | | | | | | | octets 9, 10, | | | | | | | 11, and 12 | | | | | | | shall not be | | | | | | | included. | | | | | | | | | | | | | | NOTE 6: If the | | | | | | | Cause value is | | | | | | | \"S-NSSAI not | | | | | | | available due | | | | | | | to the failed | | | | | | | or revoked | | | | | | | network | | | | | | | slice-specific | | | | | | | authentication | | | | | | | and | | | | | | | au | | | | | | | thorization\", | | | | | | | this field | | | | | | | shall contain | | | | | | | the 24 bit SD | | | | | | | value of an | | | | | | | S-NSSAI in the | | | | | | | S-NSSAI(s) of | | | | | | | the HPLMN and | | | | | | | octets 9, 10, | | | | | | | 11, and 12 | | | | | | | shall not be | | | | | | | included. | | | | | | | | | | | | | | NOTE 7: The | | | | | | | partial | | | | | | | extended | | | | | | | rejected NSSAI | | | | | | | with type of | | | | | | | list = 001 | | | | | | | shall only be | | | | | | | used for | | | | | | | rejected | | | | | | | S-NSSAI(s) | | | | | | | with the | | | | | | | rejection | | | | | | | cause | | | | | | | \"S-NSSAI not | | | | | | | available due | | | | | | | to maximum | | | | | | | number of UEs | | | | | | | reached\". | | | | | | +----------------+---+-----+---+----------------+----------------+ | | | | | | | +----------------+---+-----+---+----------------+----------------+
#### 9.11.3.76 UE request type
See subclause 9.9.3.65 in 3GPP TS 24.301 [15].
#### 9.11.3.77 Paging restriction
The purpose of the Paging restriction information element is to request the
network to restrict paging.
The Paging restriction information element is coded as shown in figure
9.11.3.77.1, figure 9.11.3.77.2 and table 9.11.3.77.1.
The Paging restriction is a type 4 information element with a minimum length
of 3 octets and a maximum length of 35 octets.
+---------+---------+-------+-------+---------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+-------+-------+---------+---------+---+---+---+ | Paging | octet 1 | | | | | | | | | rest | | | | | | | | | | riction | | | | | | | | | | IEI | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | Length | octet 2 | | | | | | | | | of | | | | | | | | | | Paging | | | | | | | | | | rest | | | | | | | | | | riction | | | | | | | | | | c | | | | | | | | | | ontents | | | | | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+ | 0 | 0 | 0 | 0 | Paging | octet 3 | | | | | | | | | rest | | | | | | Spare | Spare | Spare | Spare | riction | | | | | | | | | | type | | | | | +---------+---------+-------+-------+---------+---------+---+---+---+
Figure 9.11.3.77.1: Paging restriction information element for Paging
restriction type = \"All paging is restricted\" and for Paging restriction
type = \"All paging is restricted except voice\"
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | P | octet | | | | | | | | | aging | 1 | | | | | | | | | r | | | | | | | | | | estri | | | | | | | | | | ction | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | P | | | | | | | | | | aging | | | | | | | | | | r | | | | | | | | | | estri | | | | | | | | | | ction | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | P | octet | | | | | | | | | aging | 3 | | | | | Spare | Spare | Spare | Spare | r | | | | | | | | | | estri | | | | | | | | | | ction | | | | | | | | | | type | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 4 | | (7) | (6) | (5) | (4) | (3) | (2) | (1) | (0) | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | PSI | PSI | PSI | PSI | PSI | PSI | PSI | PSI | octet | | | | | | | | | | 5 | | \ | \ | \ | \ | \ | \ | (9) | (8) | | | (15) | (14) | (13) | (12) | (11) | (10) | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 0 0 | octet | | | | | | | | | 0 0 0 | 6* | | | | | | | | | 0 0 | -35* | | | | | | | | | | | | | | | | | | | spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.3.77.2: Paging restriction information element for Paging
restriction type = \"All paging is restricted except for specified PDU
session(s)\" and for Paging restriction type = \"All paging is restricted
except for voice service and specified PDU session(s)\"
Table 9.11.3.77.1: Paging restriction information element
+----------------------------+---+---+---+----------------------------+ | Paging restriction type | | | | | | (bits 4 to 1 of octet 3) | | | | | +----------------------------+---+---+---+----------------------------+ | Bits | | | | | +----------------------------+---+---+---+----------------------------+ | 4 | 3 | 2 | 1 | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | reserved | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | All paging is restricted | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | All paging is restricted | | | | | | except for voice service | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | All paging is restricted | | | | | | except for specified PDU | | | | | | session(s) | +----------------------------+---+---+---+----------------------------+ | 0 | 1 | 0 | 0 | All paging is restricted | | | | | | except for voice service | | | | | | and specified PDU | | | | | | session(s) | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other values are | | | | | | reserved. | | | | | +----------------------------+---+---+---+----------------------------+ | Bits 5 to 8 of octet 3 are | | | | | | spare and shall be coded | | | | | | as zero. | | | | | | | | | | | | PSI(x) (bits 8 to 1 of | | | | | | octet 4 and octet 5): | | | | | | | | | | | | This field indicates the | | | | | | PDU session identity of | | | | | | the PDU session for which | | | | | | paging is restricted. | | | | | | | | | | | | PSI(0): (bit 1 of octet 4) | | | | | | | | | | | | Spare and shall be coded | | | | | | as zero. | | | | | | | | | | | | PSI(1) -- PSI(15): | | | | | | | | | | | | 0 indicates that paging is | | | | | | restricted for the PDU | | | | | | session associated with | | | | | | the PDU session identity. | | | | | | | | | | | | 1 indicates that paging is | | | | | | not restricted for the PDU | | | | | | session associated with | | | | | | the PDU session identity. | | | | | +----------------------------+---+---+---+----------------------------+ | All bits in octet 6 to 35 | | | | | | are spare and shall be | | | | | | coded as zero, if the | | | | | | respective octet is | | | | | | included in the | | | | | | information element. | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.3.78 Void
#### 9.11.3.79 NID
See subclause 9.2.7 in 3GPP TS 24.502 [18].
#### 9.11.3.80 PEIPS assistance information
The purpose of the _PEIPS assistance information,_ information element is to
transfer the required assistance information to indicate the paging subgroup
used when paging the UE.
The coding of the information element allows combining different types of
PEIPS assistance information.
The _PEIPS assistance information,_ information element is coded as shown in
figure 9.11.3.80.1, figure 9.11.3.80.2, figure 9.11.3.80.3 and table
9.11.3.80.1.
The _PEIPS assistance information_ is a type 4 information element, with a
minimum length of 3 octets.
+-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | PEIPS assistance information IEI | octet 1 | | | | | | | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of PEIPS assistance information contents | octet 2 | | | | | | | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | PEIPS assistance information type 1 | octet 3 | | | | | | | | | | | | | | | | | | | | octet i | | | | | | | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | PEIPS assistance information type 2 | octet i+1* | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+ | PEIPS assistance information type p | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +-------------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.80.1: PEIPS assistance information information element
* * *
8 7 6 5 4 3 2 1  
Type of information Paging subgroup ID value octet 1
* * *
Figure 9.11.3.80.2: PEIPS assistance information type --type of information=
\"000\"
* * *
8 7 6 5 4 3 2 1  
Type of information UE paging probability information value octet 1
* * *
Figure 9.11.3.80.3: PEIPS assistance information type --type of information=
\"001\"
Table 9.11.3.80.1: PEIPS assistance information information element
* * *
Value part of the PEIPS assistance information information element (octets 3
to n)
The value part of the PEIPS assistance information information element
consists of one or several types of PEIPS assistance information.
PEIPS assistance information type:
Type of information (octet 1)  
Bits  
8 7 6  
0 0 0 Paging subgroup ID  
0 0 1 UE paging probability information
All other values are reserved.
Paging subgroup ID value: (octet 1, bits 1-5)  
This field contains the value (in decimal) of paging subgroup ID that is
assigned by the AMF for paging the UE. This field has a valid range of values
from (0-7). All other values are reserved and shall be interpreted as 0 by
this version of the protocol.  
UE paging probability information value: (octet 1, bits 1-5)  
This field contains the value of UE paging probability information provided by
the UE to the AMF. It represents the probability of the UE receiving the
paging.
Bit  
5 4 3 2 1 UE paging probability information value 0 0 0 0 0 p00 0 0 0 0 1 p05
0 0 0 1 0 p10 0 0 0 1 1 p15 0 0 1 0 0 p20 0 0 1 0 1 p25 0 0 1 1 0 p30 0 0 1 1
1 p35 0 1 0 0 0 p40 0 1 0 0 1 p45 0 1 0 1 0 p50 0 1 0 1 1 p55 0 1 1 0 0 p60 0
1 1 0 1 p65 0 1 1 1 0 p70 0 1 1 1 1 p75 1 0 0 0 0 p80 1 0 0 0 1 p85 1 0 0 1 0
p90 1 0 0 1 1 p95 1 0 1 0 0 p100
All other values shall be interpreted as 10100 by this version of the
protocol.
* * *
#### 9.11.3.81 5GS additional request result
The purpose of the 5GS additional request result information element is to
inform the UE about the result of additional request.
The 5GS additional request result information element is coded as shown in
figure 9.11.3.81.1 and table 9.11.3.81.1.
The 5GS additional request result is a type 4 information element with a
length of 3 octets.
* * *
8 7 6 5 4 3 2 1  
5GS additional request result IEI octet 1  
Length of 5GS additional request result contents octet 2  
0 Spare 0 Spare 0 Spare 0 Spare 0 Spare 0 Spare PRD octet 3
* * *
Figure 9.11.3.81.1: 5GS additional request result information element
Table 9.11.3.81.1: 5GS additional request result information element
* * *
Paging restriction decision (PRD) (bits 2 to 1 of octet 3)  
Bits  
2 1  
0 0 no additional information 0 1 paging restriction is accepted 1 0 paging
restriction is rejected
All other values are reserved.  
Bits 3 to 8 of octet 3 are spare and shall be coded as zero.
* * *
#### 9.11.3.82 NSSRG information
The purpose of the NSSRG information information element is to identify one or
more NSSRG values associated with each of the HPLMN S-NSSAIs in a configured
NSSAI.
The NSSRG information information element is coded as shown in figure
9.11.3.82.1, figure 9.11.3.82.2 and table 9.11.3.82.1.
The NSSRG information is a type 6 information element with minimum length of 7
octets and maximum length of 4099 octets.
+--------------------------------------+--------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +======================================+==============+===+===+===+===+===+===+===+ | NSSRG information IEI | octet 1 | | | | | | | | +--------------------------------------+--------------+---+---+---+---+---+---+---+ | Length of NSSRG information contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +--------------------------------------+--------------+---+---+---+---+---+---+---+ | NSSRG values for S-NSSAI 1 | octet 4\ | | | | | | | | | | \ | | | | | | | | | | octet m | | | | | | | | +--------------------------------------+--------------+---+---+---+---+---+---+---+ | NSSRG values for S-NSSAI 2 | octet m+1*\ | | | | | | | | | | \ | | | | | | | | | | octet n* | | | | | | | | +--------------------------------------+--------------+---+---+---+---+---+---+---+ | ... | octet n+1*\ | | | | | | | | | | \ | | | | | | | | | | octet u* | | | | | | | | +--------------------------------------+--------------+---+---+---+---+---+---+---+ | NSSRG values for S-NSSAI x | octet u+1*\ | | | | | | | | | | \ | | | | | | | | | | octet v* | | | | | | | | +--------------------------------------+--------------+---+---+---+---+---+---+---+
Figure 9.11.3.82.1: NSSRG information information element
+------------------------------------+--------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +====================================+==============+===+===+===+===+===+===+===+ | Length of NSSRG values for S-NSSAI | octet 4 | | | | | | | | +------------------------------------+--------------+---+---+---+---+---+---+---+ | S-NSSAI value | octet 5 | | | | | | | | | | | | | | | | | | | | octet w | | | | | | | | +------------------------------------+--------------+---+---+---+---+---+---+---+ | NSSRG value 1 for the S-NSSAI | octet w+1 | | | | | | | | +------------------------------------+--------------+---+---+---+---+---+---+---+ | NSSRG value 2 for the S-NSSAI | octet w+2* | | | | | | | | +------------------------------------+--------------+---+---+---+---+---+---+---+ | ... | octet w+3*\ | | | | | | | | | | \ | | | | | | | | | | octet m-1* | | | | | | | | +------------------------------------+--------------+---+---+---+---+---+---+---+ | NSSRG value y for the S-NSSAI | octet m* | | | | | | | | +------------------------------------+--------------+---+---+---+---+---+---+---+
Figure 9.11.3.82.2: NSSRG values for S-NSSAI
Table 9.11.3.82.1: NSSRG information information element
+----------------------------------------------------------------------+ | Value part of the NSSRG information information element (octet 4 to | | v) | | | | The value part of the NSSRG information information element consists | | of one or more NSSRG values for each S-NSSAI in the Configured NSSAI | | IE. | | | | S-NSSAI value (octet 5 to w) (see NOTE 2) | | | | S-NSSAI value is coded as the length and value part of S-NSSAI | | information element as specified in subclause 9.11.2.8 starting with | | the second octet. See NOTE 1. | +======================================================================+ | NSSRG value for the S-NSSAI (octet w+1) | +----------------------------------------------------------------------+ | This field contains the 8 bit NSSRG value. | +----------------------------------------------------------------------+ | NOTE 1: If a mapped HPLMN SST is included in a S-NSSAI value, then | | the NSSRG value(s) are associated with the Mapped HPLMN SST, and the | | Mapped HPLMN SD, if included. | | | | NOTE 2: The NSSRG information IE shall contain the complete set of | | S-NSSAI(s) included in the configured NSSAI. | +----------------------------------------------------------------------+
#### 9.11.3.83 List of PLMNs to be used in disaster condition
The purpose of the list of PLMNs to be used in disaster condition information
element is to provide the \"list of PLMN(s) to be used in disaster condition\"
associated with the serving PLMN to the UE.
The list of PLMNs to be used in disaster condition information element is
coded as shown in figures 9.11.3.83.1 and 9.11.3.83.2 and table 9.11.3.83.1.
The list of PLMNs to be used in disaster condition is a type 4 information
element, with a minimum length of 2 octets.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | List of PLMNs to be | octet 1 | | | | | | | | | used in disaster | | | | | | | | | | condition list IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of list of | octet 2 | | | | | | | | | PLMNs to be used in | | | | | | | | | | disaster condition | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | PLMN ID 1 | octet 3* | | | | | | | | | | | | | | | | | | | | octet 5* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | PLMN ID 2 | octet 6* | | | | | | | | | | | | | | | | | | | | octet 8* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | ... | octet 9* | | | | | | | | | | | | | | | | | | | | octet q* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | PLMN ID n | octet q+1* | | | | | | | | | | | | | | | | | | | | octet q+3* | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.83.1: List of PLMNs to be used in disaster condition information
element
* * *
8 7 6 5 4 3 2 1  
MCC digit 2 MCC digit 1 octet q+1  
MNC digit 3 MCC digit 3 octet q+2  
MNC digit 2 MNC digit 1 octet q+3
* * *
Figure 9.11.3.83.2: PLMN ID n
Table 9.11.3.83.1: List of PLMNs to be used in disaster condition information
element
+----------------------------------------------------------------------+ | MCC, Mobile country code (octet q+1 and bits 1 to 4 octet q+2) | | | | The MCC field is coded as in ITU-T Recommendation E.212 [42], | | annex A. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | MNC, Mobile network code (bits 5 to 8 of octet q+2 and octet q+3) | | | | The coding of this field is the responsibility of each | | administration but BCD coding shall be used. The MNC shall consist | | of 2 or 3 digits. If a network operator decides to use only two | | digits in the MNC, bits 5 to 8 of octet q+2 shall be coded as | | \"1111\". | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | The MCC and MNC digits are coded as octets 6 to 8 of the Temporary | | mobile group identity IE in figure 10.5.154 of | | 3GPP TS 24.008 [12]. | +----------------------------------------------------------------------+ | NOTE: The PLMN IDs are provided in decreasing order of priority, | | i.e. PLMN ID 1 indicates highest priority and PLMN ID n indicates | | lowest priority. | +----------------------------------------------------------------------+
#### 9.11.3.84 Registration wait range
The purpose of the registration wait range information element is to provide
the disaster roaming wait range or the disaster return wait range to the UE.
The registration wait range information element is coded as shown in figure
9.11.3.84.1 and table 9.11.3.84.1.
The registration wait range is a type 4 information element, with a length of
4 octets.
* * *
8 7 6 5 4 3 2 1  
Registration wait range IEI octet 1  
Length of registration wait range octet 2  
Minimum registration wait time octet 3  
Maximum registration wait time octet 4
* * *
Figure 9.11.3.84.1: Registration wait range information element
Table 9.11.3.84.1: Registration wait range information element
+----------------------------------------------------------------------+ | Minimum registration wait time (octet 3) | | | | The minimum registration wait time contains the minimum duration of | | the registration wait time, encoded as octet 2 of the GPRS timer | | information element (see 3GPP TS 24.008 [12] subclause 10.5.7.3). | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | Maximum registration wait time (octet 4) | | | | The maximum registration wait time contains the maximum duration of | | the registration wait time, encoded as octet 2 of the GPRS timer | | information element (see 3GPP TS 24.008 [12] subclause 10.5.7.3). | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+
#### 9.11.3.85 PLMN identity
The purpose of the PLMN identity information element is to provide a PLMN
identity.
The PLMN identity information element is coded as shown in figure 9.11.3.85.1,
and table 9.11.3.85.1.
The PLMN identity is a type 4 information element.
* * *
8 7 6 5 4 3 2 1  
PLMN identity IEI octet 1  
Length of PLMN identity contents octet 2  
MCC digit 2 MCC digit 1 octet 3  
MNC digit 3 MCC digit 3 octet 4  
MNC digit 2 MNC digit 1 octet 5
* * *
Figure 9.11.3.85.1: PLMN identity information element
Table 9.11.3.85.1: PLMN identity information element
MCC, Mobile country code (octet 3, octet 4 bits 1 to 4)
* * *
The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. MNC,
Mobile network code (octet 4 bits 5 to 8, octet 5) The coding of this field is
the responsibility of each administration but BCD coding shall be used. The
MNC shall consist of 2 or 3 digits. If a network operator decides to use only
two digits in the MNC, bits 5 to 8 of octet 4 shall be coded as \"1111\". The
MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group
identity IE in figure 10.5.154 of 3GPP TS 24.008 [12].
#### 9.11.3.86 Extended CAG information list
The purpose of the Extended CAG information list information element is to
provide \"CAG information list\" or to delete the \"CAG information list\" at
the UE.
The Extended CAG information list information element is coded as shown in
figures 9.11.3.86.1 and 9.11.3.86.2 and table 9.11.3.86.1.
The Extended CAG information _list_ is a type 6 information element, with a
minimum length of 3 octets.
+--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Extended CAG information list IEI | octet 1 | | | | | | | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of Extended CAG information list contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Entry 1 | octet 4* | | | | | | | | | | | | | | | | | | | | octet a* | | | | | | | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Entry 2 | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | octet g* | | | | | | | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+ | Entry n | octet g+1* | | | | | | | | | | | | | | | | | | | | octet h* | | | | | | | | +--------------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.86.1: Extended CAG information list information element
+-------+-------+-------+-------+-------+-------+-------+------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | L | octet | | | | | | | | | ength | q | | | | | | | | | of | | | | | | | | | | entry | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | | octet | | | | | | | | | | q+1 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MCC | MCC | octet | | | | | | | | digit | digit | q+2 | | | | | | | | 2 | 1 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MNC | MCC | octet | | | | | | | | digit | digit | q+3 | | | | | | | | 3 | 3 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MNC | MNC | octet | | | | | | | | digit | digit | q+4 | | | | | | | | 2 | 1 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | CAG | octet | | | | | | | | | | q+5 | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | only | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | q+6* | | | | | | | | | 1 | | | | | | | | | | | octet | | | | | | | | | | q+9* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | q | | | | | | | | | 2 | +10* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | q | | | | | | | | | | +13* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | ... | octet | | | | | | | | | | q | | | | | | | | | | +14* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | q+4 | | | | | | | | | | m+1* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | q+4 | | | | | | | | | m | m+2* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | q+4 | | | | | | | | | | m+5* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+
Figure 9.11.3.86.2: Entry n
Table 9.11.3.86.1: Extended CAG information list information element
+----------------------------------+----------------------------------+ | Value part of the Extended CAG | | | information list information | | | element (octet 4 to h) | | | | | | The value part of the Extended | | | CAG information list information | | | element consists of one or more | | | entries. | | | | | | Entry n: | | | | | | Length of entry contents (octet | | | q and q+1) | | | | | | MCC, Mobile country code (octet | | | q+2 and bits 1 to 4 octet q+3) | | | | | | The MCC field is coded as in | | | IT | | | U-T Recommendation E.212 [42], | | | annex A. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | MNC, Mobile network code (bits 5 | | | to 8 of octet q+3 and octet q+4) | | | | | | The coding of this field is the | | | responsibility of each | | | administration, but BCD coding | | | shall be used. The MNC shall | | | consist of 2 or 3 digits. If a | | | network operator decides to use | | | only two digits in the MNC, bits | | | 5 to 8 of octet q+2 shall be | | | coded as \"1111\". | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | The MCC and MNC digits are coded | | | as octets 6 to 8 of the | | | Temporary mobile group identity | | | IE in figure 10.5.154 of | | | 3GPP TS 24.008 [12]. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Indication that the UE is only | | | allowed to access 5GS via CAG | | | cells (CAGonly) (bit 1 of octet | | | q+5) | | +----------------------------------+----------------------------------+ | Bit | | +----------------------------------+----------------------------------+ | 1 | | +----------------------------------+----------------------------------+ | 0 | \"Indication that the UE is only | | | allowed to access 5GS via CAG | | | cells\" is not set (i.e., the UE | | | is allowed to access 5GS via | | | non-CAG cells) | +----------------------------------+----------------------------------+ | 1 | \"Indication that the UE is only | | | allowed to access 5GS via CAG | | | cells\" is set (i.e., the UE is | | | not allowed to access 5GS via | | | non-CAG cells) | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | CAG-ID m (octet q+4m+2 to octet | | | q+4m+5) | | | | | | This field contains the 32 bit | | | CAG-ID. The coding of the CAG-ID | | | is defined as the CAG-Identifier | | | in 3GPP TS 23.003 [4]. | | | | | | NOTE 1: The Length of Extended | | | CAG information list contents | | | shall be 0 if no subscription | | | data for CAG information list | | | exists. | | | | | | NOTE 2: The Length of entry | | | contents shall be 4 if there is | | | no allowed CAG-ID for the PLMN. | | | | | | NOTE 3: For a given PLMN ID, | | | there shall be up to one Entry | | | containing the MCC value and the | | | MNC value of the PLMN ID. | | +----------------------------------+----------------------------------+
#### 9.11.3.87 NSAG information
The purpose of the NSAG information information element is to provide NSAG
information to the UE.
The NSAG information information element is coded as shown in figures
9.11.3.87.1, 9.11.3.87.2 and 9.11.3.87.3, and table 9.11.3.87.1.
The NSAG information information element can contain a maximum of 32 NSAG
entries.
In the NSAG information information element, at most 4 NSAG entries can
contain a TAI list.
The NSAG information is a type 6 information element, with a minimum length of
9 octets and a maximum length of 3143 octets.
+-------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=====================================+=============+===+===+===+===+===+===+===+ | NSAG information IEI | octet 1 | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of NSAG information contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | NSAG 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | NSAG 2 | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet n+1* | | | | | | | | | | | | | | | | | | | | octet u* | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+ | NSAG x | octet u+1* | | | | | | | | | | | | | | | | | | | | octet v* | | | | | | | | +-------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.87.1: NSAG information information element
+----------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +======================+=============+===+===+===+===+===+===+===+ | Length of NSAG | octet 4 | | | | | | | | +----------------------+-------------+---+---+---+---+---+---+---+ | | | | | | | | | | +----------------------+-------------+---+---+---+---+---+---+---+ | NSAG identifier | octet 5 | | | | | | | | +----------------------+-------------+---+---+---+---+---+---+---+ | S-NSSAI list of NSAG | octet 6 | | | | | | | | | | | | | | | | | | | | octet j | | | | | | | | +----------------------+-------------+---+---+---+---+---+---+---+ | NSAG priority | octet j+1 | | | | | | | | +----------------------+-------------+---+---+---+---+---+---+---+ | TAI list | octet j+2* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +----------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.87.2: NSAG
+--------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +================================+=============+===+===+===+===+===+===+===+ | Length of S-NSSAI list of NSAG | octet 7 | | | | | | | | +--------------------------------+-------------+---+---+---+---+---+---+---+ | S-NSSAI value 1 | octet 8 | | | | | | | | | | | | | | | | | | | | octet k | | | | | | | | +--------------------------------+-------------+---+---+---+---+---+---+---+ | S-NSSAI value 2 | octet k+1* | | | | | | | | | | | | | | | | | | | | octet s* | | | | | | | | +--------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet s+1* | | | | | | | | | | | | | | | | | | | | octet i-1* | | | | | | | | +--------------------------------+-------------+---+---+---+---+---+---+---+ | S-NSSAI value x | octet i* | | | | | | | | | | | | | | | | | | | | octet j* | | | | | | | | +--------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.3.87.3: S-NSSAI list of NSAG
Table 9.11.3.87.1: NSAG information information element
+----------------------------------------------------------------------+ | NSAG part of the NSAG information information element (octet 4 to m) | | | | Each entry of the NSAG information information element consists of | | one NSAG in the NSAG information IE. | +======================================================================+ | NSAG identifier(octet 5) | | | | NSAG identifier field contains an 8 bits NSAG ID value. | +----------------------------------------------------------------------+ | S-NSSAI list of NSAG (octet 6 to j) | | | | S-NSSAI list of NSAG field consists of one or more S-NSSAIs in the | | configured NSSAI. Each S-NSSAI in S-NSSAI list of NSAG field is | | coded as the length and value part of S-NSSAI information element as | | specified in subclause 9.11.2.8 starting with the second octet, | | without the mapped HPLMN SST field and without the mapped HPLMN SD | | field. | +----------------------------------------------------------------------+ | NSAG priority (octet j+1) | | | | The NSAG priority field indicates the priority of NSAG for cell | | reselection (see 3GPP TS 38.304 [28]) and random access (see | | 3GPP TS 38.321 [58]). | +----------------------------------------------------------------------+ | TAI list (octet j+2 to m) | | | | The TAI list field is coded as the length and value part of the 5GS | | tracking area identity list IE defined in subclause 9.11.3.9 | | starting with the second octet. | +----------------------------------------------------------------------+
#### 9.11.3.88 ProSe relay transaction identity
The purpose of the ProSe relay transaction identity (PRTI) information element
is to uniquely identify an authentication and key agreement procedure for 5G
ProSe UE-to-network relay. The PRTI allows distinguishing up to 254 different
bi-directional messages.
The ProSe relay transaction identity information element is coded as shown in
figure 9.11.3.88.1 and table 9.11.3.88.1.
The ProSe relay transaction identity is a type 3 information element with a
length of 2 octets.
* * *
8 7 6 5 4 3 2 1  
ProSe relay transaction identity IEI octet 1  
ProSe relay transaction identity value octet 2
* * *
Figure 9.11.3.88.1: ProSe relay transaction identity information element
Table 9.11.3.88.1: ProSe relay transaction identity information element
* * *
ProSe relay transaction identity value (octet 2)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 No ProSe relay transaction identity assigned 0 0 0 0 0 0 0 1 \
to } ProSe relay transaction identity value  
1 1 1 1 1 1 1 0 / 1 1 1 1 1 1 1 1 Reserved
* * *
#### 9.11.3.89 Relay key request parameters
The purpose of the relay key request parameters information element is to
transport the parameters of the key request for 5G ProSe UE-to-network relay
as specified in 3GPP TS 33.503 [56].
The relay key request parameters information element is coded as shown in
figure 9.11.3.89.1, figure 9.11.3.89.2 and table 9.11.3.89.1.
The relay key request parameters is a type 6 information element.
+----------------------------------------+----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +========================================+==========+===+===+===+===+===+===+===+ | Relay key request parameters IEI | octet 1 | | | | | | | | +----------------------------------------+----------+---+---+---+---+---+---+---+ | Length of Relay key request parameters | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------+----------+---+---+---+---+---+---+---+ | Relay service code | octet 4 | | | | | | | | | | | | | | | | | | | | octet 6 | | | | | | | | +----------------------------------------+----------+---+---+---+---+---+---+---+ | Nonce_1 | octet 7 | | | | | | | | | | | | | | | | | | | | octet 22 | | | | | | | | +----------------------------------------+----------+---+---+---+---+---+---+---+ | Remote UE identity | octet 23 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +----------------------------------------+----------+---+---+---+---+---+---+---+
Figure 9.11.3.89.1: Relay key request parameters information element
+--------------+------------+-------+-------+-------+-------+-------+------+----------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==============+============+=======+=======+=======+=======+=======+======+==========+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | RUIT | octet 23 | | | | | | | | | | | | spare | spare | spare | spare | spare | spare | spare | | | +--------------+------------+-------+-------+-------+-------+-------+------+----------+ | Remote UE ID | octet 23+1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +--------------+------------+-------+-------+-------+-------+-------+------+----------+
Figure 9.11.3.89.2: Remote UE identity
Table 9.11.3.89.1: Relay key request parameters information element
+----------------------------------------------------------------------+ | Relay service code (octet 4 to 6) | | | | The relay service code contains 24-bit relay service code as defined | | in 3GPP TS 24.554 [19E]. | | | | Nonce_1 (octet 7 to 22) | | | | Nonce_1 is the 128-bit nonce value as defined in | | 3GPP TS 24.554 [19E]. | | | | Remote UE ID type (RUIT) (octet 23, bit 1) | | | | Bit | | | | **1** | | | | 0 SUCI | | | | 1 CP-PRUK ID | | | | Remote UE ID (octet 23+1 to n) | | | | Remote UE ID indicates the value of the 5G ProSe remote UE identity. | | | | If the Remote UE ID type is set to SUCI, the Remote UE ID is coded | | as 5GS mobile identity IE starting from octet 2 with the Type of | | identity set to \"SUCI\" (see subclause 9.11.3.4). | | | | If the Remote UE ID type is set to 5GPRUK ID, the Remote UE ID is | | coded as the 5GPRUK ID as defined in 3GPP TS 33.503 [56]. | +----------------------------------------------------------------------+
#### 9.11.3.90 Relay key response parameters
The purpose of the relay key response parameters information element is to
transport the parameters of the key response for 5G ProSe UE-to-network relay
as specified in 3GPP TS 33.503 [56].
The relay key response parameters information element is coded as shown in
figure 9.11.3.90.1 and table 9.11.3.90.1.
The relay key response parameters is a type 6 information element.
+-----------------------------------------+----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=========================================+==========+===+===+===+===+===+===+===+ | Relay key response parameters IEI | octet 1 | | | | | | | | +-----------------------------------------+----------+---+---+---+---+---+---+---+ | Length of Relay key response parameters | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +-----------------------------------------+----------+---+---+---+---+---+---+---+ | Key K~NR_ProSe~ | octet 4 | | | | | | | | | | | | | | | | | | | | octet 35 | | | | | | | | +-----------------------------------------+----------+---+---+---+---+---+---+---+ | Nonce_2 | octet 36 | | | | | | | | | | | | | | | | | | | | octet 51 | | | | | | | | +-----------------------------------------+----------+---+---+---+---+---+---+---+ | CP-PRUK ID | octet 52 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +-----------------------------------------+----------+---+---+---+---+---+---+---+
Figure 9.11.3.90.1: Relay key response parameters information element
Table 9.11.3.90.1: Relay key response parameters information element
+----------------------------------------------------------------------+ | Key K~NR_ProSe~ (octet 5 to 35) | | | | Key K~NR_ProSe~ contains a 256-bit root key that is established | | between the two entities that communicating using NR PC5 unicast | | link as defined in 3GPP TS 33.503 [56]. | | | | Nonce_2 (octet 36 to 51) | | | | Nonce_2 is the 128-bit nonce value as defined in | | 3GPP TS 24.554 [19E]. | | | | CP-PRUK ID (octet 52 to m) | | | | The CP-PRUK ID is defined in 3GPP TS 33.503 [56]. | +----------------------------------------------------------------------+
#### 9.11.3.91 Priority indicator
The purpose of the Priority indicator information element is to convey a
priority indication to the UE.
The Priority indicator information element is coded as shown in figure
9.11.3.91.1 and table 9.11.3.91.1.
The Priority indicator is a type 1 information element.
+------------------------+-------+-------+-------+------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +========================+=======+=======+=======+======+=========+===+===+===+ | Priority indicator IEI | 0 | 0 | 0 | MPSI | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +------------------------+-------+-------+-------+------+---------+---+---+---+
Figure 9.11.3.91.1: Priority indicator
Table 9.11.3.91.1: Priority indicator
+---------------------------------------+-----------------------------+ | MPS indicator (MPSI) (octet 1, bit 1) | | +=======================================+=============================+ | Bit | | | | | | **1** | | +---------------------------------------+-----------------------------+ | 0 | Access identity 1 not valid | | | | | 1 | Access identity 1 valid | +---------------------------------------+-----------------------------+ | | | +---------------------------------------+-----------------------------+ | Bits 2, 3, 4 are spare and shall be | | | coded as zero. | | +---------------------------------------+-----------------------------+
### 9.11.4 5GS session management (5GSM) information elements
#### 9.11.4.1 5GSM capability
The purpose of the 5GSM capability information element is to indicate UE
capability related to the PDU session management.
The 5GSM capability information element is coded as shown in figure 9.11.4.1.1
and table 9.11.4.1.1.
The 5GSM capability is a type 4 information element with a minimum length of 3
octets and a maximum length of 15 octets.
* * *
8 7 6 5 4 3 2 1  
5GSM capability IEI octet 1  
Length of 5GSM capability contents octet 2  
TPMIC ATSSS-ST EPT-S1 MH6-PDU RqoS octet 3  
0 Spare 0 Spare 0 Spare 0 Spare 0 Spare 0 Spare 0 Spare APMQF octet 4* 0 0 0 0
0 0 0 0 octet 5* -15* Spare
* * *
Figure 9.11.4.1.1: 5GSM capability information element
Table 9.11.4.1.1: 5GSM capability information element
+----------------------------+---+---+---+----------------------------+ | 5GSM capability value | | | | | +----------------------------+---+---+---+----------------------------+ | RqoS (octet 3, bit 1) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | 5GSM capability to support | | | | | | reflective QoS. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Reflective QoS not | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Reflective QoS supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Multi-homed IPv6 PDU | | | | | | session (MH6-PDU) (octet | | | | | | 3, bit 2) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | 5GSM capability for | | | | | | Multi-homed IPv6 PDU | | | | | | session. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Multi-homed IPv6 PDU | | | | | | session not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Multi-homed IPv6 PDU | | | | | | session supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Ethernet PDN type in S1 | | | | | | mode (EPT-S1) (octet 3, | | | | | | bit 3) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates UE\'s | | | | | | 5GSM capability for | | | | | | Ethernet PDN type in S1 | | | | | | mode. | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Ethernet PDN type in S1 | | | | | | mode not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Ethernet PDN type in S1 | | | | | | mode supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Supported ATSSS steering | | | | | | functionalities and | | | | | | steering modes (ATSSS-ST) | | | | | | (octet 3, bits 4 to 7) | | | | | +----------------------------+---+---+---+----------------------------+ | These bits indicate the | | | | | | 5GSM capability of ATSSS | | | | | | steering functionalities | | | | | | and steering modes | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 0 | ATSSS not supported | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 0 | 1 | ATSSS Low-Layer | | | | | | functionality with any | | | | | | steering mode supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 0 | MPTCP functionality with | | | | | | any steering mode and | | | | | | ATSSS-LL functionality | | | | | | with only active-standby | | | | | | steering mode supported | +----------------------------+---+---+---+----------------------------+ | 0 | 0 | 1 | 1 | MPTCP functionality with | | | | | | any steering mode and | | | | | | ATSSS-LL functionality | | | | | | with any steering mode | | | | | | supported | +----------------------------+---+---+---+----------------------------+ | All other values are | | | | | | reserved. | | | | | +----------------------------+---+---+---+----------------------------+ | Transfer of port | | | | | | management information | | | | | | containers (TPMIC) (octet | | | | | | 3, bit 8) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | 5GSM capability to support | | | | | | transfer of port | | | | | | management information | | | | | | containers | | | | | +----------------------------+---+---+---+----------------------------+ | 0 | | | | Transfer of port | | | | | | management information | | | | | | containers not supported | +----------------------------+---+---+---+----------------------------+ | 1 | | | | Transfer of port | | | | | | management information | | | | | | containers supported | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | Access performance | | | | | | measurements per QoS flow | | | | | | rule (APMQF) (octet 4, | | | | | | bit1) | | | | | +----------------------------+---+---+---+----------------------------+ | This bit indicates the | | | | | | 5GSM capability to support | | | | | | access performance | | | | | | measurements using the QoS | | | | | | flow of the non default | | | | | | QoS rule, that is used by | | | | | | the service data flow | | | | | | (SDF) traffic. | | | | | +----------------------------+---+---+---+----------------------------+ | --- -- -- -- --------- | | | | | | -------------------------- | | | | | | -------------------------- | | | | | | 0 Access | | | | | | performance measurements p | | | | | | er QoS flow not supported. | | | | | | --- -- -- -- --------- | | | | | | -------------------------- | | | | | | -------------------------- | | | | | +----------------------------+---+---+---+----------------------------+ | --- -- -- -- ----- | | | | | | -------------------------- | | | | | | -------------------------- | | | | | | 1 Acc | | | | | | ess performance measuremen | | | | | | ts per QoS flow supported. | | | | | | --- -- -- -- ----- | | | | | | -------------------------- | | | | | | -------------------------- | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+ | All other bits in octet 4 | | | | | | to 15 are spare and shall | | | | | | be coded as zero, if the | | | | | | respective octet is | | | | | | included in the | | | | | | information element. | | | | | +----------------------------+---+---+---+----------------------------+ | | | | | | +----------------------------+---+---+---+----------------------------+
#### 9.11.4.2 5GSM cause
The purpose of the 5GSM cause information element is to indicate the reason
why a 5GSM request is rejected.
The 5GSM cause information element is coded as shown in figure 9.11.4.2.1 and
table 9.11.4.2.1.
The 5GSM cause is a type 3 information element with 2 octets length.
* * *
8 7 6 5 4 3 2 1  
5GSM cause IEI octet 1  
Cause value octet 2
* * *
Figure 9.11.4.2.1: 5GSM cause information element
Table 9.11.4.2.1: 5GSM cause information element
* * *
Cause value (octet 2)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 1 0 0 0 Operator determined barring 0 0 0 1 1 0 1 0 Insufficient
resources 0 0 0 1 1 0 1 1 Missing or unknown DNN 0 0 0 1 1 1 0 0 Unknown PDU
session type 0 0 0 1 1 1 0 1 User authentication or authorization failed 0 0 0
1 1 1 1 1 Request rejected, unspecified 0 0 1 0 0 0 0 0 Service option not
supported 0 0 1 0 0 0 0 1 Requested service option not subscribed 0 0 1 0 0 0
1 1 PTI already in use 0 0 1 0 0 1 0 0 Regular deactivation 0 0 1 0 0 1 0 1
5GS QoS not accepted 0 0 1 0 0 1 1 0 Network failure 0 0 1 0 0 1 1 1
Reactivation requested 0 0 1 0 1 0 0 1 Semantic error in the TFT operation 0 0
1 0 1 0 1 0 Syntactical error in the TFT operation 0 0 1 0 1 0 1 1 Invalid PDU
session identity 0 0 1 0 1 1 0 0 Semantic errors in packet filter(s) 0 0 1 0 1
1 0 1 Syntactical error in packet filter(s) 0 0 1 0 1 1 1 0 Out of LADN
service area 0 0 1 0 1 1 1 1 PTI mismatch 0 0 1 1 0 0 1 0 PDU session type
IPv4 only allowed 0 0 1 1 0 0 1 1 PDU session type IPv6 only allowed 0 0 1 1 0
1 1 0 PDU session does not exist 0 0 1 1 1 0 0 1 PDU session type IPv4v6 only
allowed 0 0 1 1 1 0 1 0 PDU session type Unstructured only allowed 0 0 1 1 1 0
1 1 Unsupported 5QI value 0 0 1 1 1 1 0 1 PDU session type Ethernet only
allowed 0 1 0 0 0 0 1 1 Insufficient resources for specific slice and DNN 0 1
0 0 0 1 0 0 Not supported SSC mode 0 1 0 0 0 1 0 1 Insufficient resources for
specific slice 0 1 0 0 0 1 1 0 Missing or unknown DNN in a slice 0 1 0 1 0 0 0
1 Invalid PTI value 0 1 0 1 0 0 1 0 Maximum data rate per UE for user-plane
integrity protection is too low 0 1 0 1 0 0 1 1 Semantic error in the QoS
operation 0 1 0 1 0 1 0 0 Syntactical error in the QoS operation 0 1 0 1 0 1 0
1 Invalid mapped EPS bearer identity 0 1 0 1 0 1 1 0 UAS services not allowed
0 1 0 1 1 1 1 1 Semantically incorrect message 0 1 1 0 0 0 0 0 Invalid
mandatory information 0 1 1 0 0 0 0 1 Message type non-existent or not
implemented 0 1 1 0 0 0 1 0 Message type not compatible with the protocol
state 0 1 1 0 0 0 1 1 Information element non-existent or not implemented 0 1
1 0 0 1 0 0 Conditional IE error 0 1 1 0 0 1 0 1 Message not compatible with
the protocol state 0 1 1 0 1 1 1 1 Protocol error, unspecified
Any other value received by the UE shall be treated as 0001 1111, \" Request
rejected, unspecified \". Any other value received by the network shall be
treated as 0110 1111, \"protocol error, unspecified\".
* * *
#### 9.11.4.3 Always-on PDU session indication
The purpose of the Always-on PDU session indication information element is to
indicate whether a PDU session is established as an always-on PDU session.
The Always-on PDU session indication information element is coded as shown in
figure 9.11.4.3.1 and table 9.11.4.3.1.
The Always-on PDU session indication is a type 1 information element.
+--------------------------------------+-------+-------+-------+------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +======================================+=======+=======+=======+======+=========+===+===+===+ | Always-on PDU session indication IEI | 0 | 0 | 0 | APSI | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +--------------------------------------+-------+-------+-------+------+---------+---+---+---+
Figure 9.11.4.3.1: Always-on PDU session indication
Table 9.11.4.3.1: Always-on PDU session indication
Always-on PDU session indication (APSI) (octet 1)
* * *
Bit  
**1**  
0 Always-on PDU session not allowed 1 Always-on PDU session required
Bits 2, 3 and 4 are spare and shall be coded as zero,
#### 9.11.4.4 Always-on PDU session requested
The purpose of the Always-on PDU session requested information element is to
indicate whether a PDU session is requested to be established as an always-on
PDU session.
The Always-on PDU session requested information element is coded as shown in
figure 9.11.4.4.1 and table 9.11.4.4.1.
The Always-on PDU session requested is a type 1 information element.
+-------------------------------------+-------+-------+-------+------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=====================================+=======+=======+=======+======+=========+===+===+===+ | Always-on PDU session requested IEI | 0 | 0 | 0 | APSR | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +-------------------------------------+-------+-------+-------+------+---------+---+---+---+
Figure 9.11.4.4.1: Always-on PDU session requested
Table 9.11.4.4.1: Always-on PDU session requested
Always-on PDU session requested (APSR) (octet 1)
* * *
Bit  
**1**  
0 Always-on PDU session not requested 1 Always-on PDU session requested
Bits 2, 3 and 4 are spare and shall be coded as zero,
#### 9.11.4.5 Allowed SSC mode
The purpose of the Allowed SSC mode information element is to indicate the SSC
modes allowed to be used by the UE for the PDU session.
The Allowed SSC mode information element is coded as shown in figure
9.11.4.5.1 and table 9.11.4.5.1.
The Allowed SSC mode is a type 1 information element.
+----------------------+-------+------+------+------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------+-------+------+------+------+---------+---+---+---+ | Allowed SSC mode IEI | 0 | SSC3 | SSC2 | SSC1 | octet 1 | | | | | | | | | | | | | | | | Spare | | | | | | | | +----------------------+-------+------+------+------+---------+---+---+---+
Figure 9.11.4.5.1: Allowed SSC mode information element
Table 9.11.4.5.1: Allowed SSC mode information element
SSC1 (octet 1, bit 1)
* * *
Bit  
1  
0 SSC mode 1 not allowed 1 SSC mode 1 allowed
SSC2 (octet 1, bit 2)  
Bit  
2  
0 SSC mode 2 not allowed 1 SSC mode 2 allowed
SSC3 (octet 1, bit 3)  
Bit  
3  
0 SSC mode 3 not allowed 1 SSC mode 3 allowed
Bit 4 is spare and shall be encoded as zero.
#### 9.11.4.6 Extended protocol configuration options
See subclause 10.5.6.3A in 3GPP TS 24.008 [12].
#### 9.11.4.7 Integrity protection maximum data rate
The purpose of the integrity protection maximum data rate information element
is for the UE to indicate to the network the maximum data rate per UE for
user-plane integrity protection for uplink and the maximum data rate per UE
for user-plane integrity protection for downlink that are supported by the UE.
The integrity protection maximum data rate is coded as shown in figure
9.11.4.7.1 and table 9.11.4.7.2.
The integrity protection maximum data rate is a type 3 information element
with a length of 3 octets.
* * *
8 7 6 5 4 3 2 1  
Integrity protection maximum data rate IEI octet 1  
Maximum data rate per UE for user-plane integrity protection for uplink octet
2  
Maximum data rate per UE for user-plane integrity protection for downlink
octet 3
* * *
Figure 9.11.4.7.1: Integrity protection maximum data rate information element
Table 9.11.4.7.2: Integrity protection maximum data rate information element
* * *
Maximum data rate per UE for user-plane integrity protection for uplink (octet
2)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 64 kbps (NOTE 3) 0 0 0 0 0 0 0 1 NULL (NOTE 1) 1 1 1 1 1 1 1 1
Full data rate (NOTE 2) All other values are spare and shall not be used by a
UE compliant to the present version of this specification. If received they
shall be interpreted as \"64 kbps\".
Maximum data rate per UE for user-plane integrity protection for downlink
(octet 3)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 64 kbps (NOTE 3) 0 0 0 0 0 0 0 1 NULL (NOTE 1) 1 1 1 1 1 1 1 1
Full data rate (NOTE 2) All other values are spare and shall not be used by a
UE compliant to the present version of this specification. If received they
shall be interpreted as \"64 kbps\".  
NOTE 1: This value shall be used when N3 data transfer is not supported by the
UE or when the UE does not support standalone NR connected to 5GCN.  
NOTE 2: If the UE supports N3 data transfer and supports standalone NR
connected to 5GCN (this includes UEs supporting NR-NR dual connectivity, NR-E-
UTRA dual connectivity with MN terminated bearers or both of them as described
in 3GPP TS 37.340 [51]), then the UE shall use this value.  
NOTE 3: The network can receive this value from a UE compliant to an earlier
version of this specification.
* * *
#### 9.11.4.8 Mapped EPS bearer contexts
The purpose of the mapped EPS bearer contexts information element is to
indicate a set of EPS bearer contexts for a PDU session, as described in
subclause 6.1.4.1.
The mapped EPS bearer contexts information element is a type 6 information
element with a minimum length of 7 octet and a maximum length of 65538 octets.
The mapped EPS bearer contexts information element is coded as shown in figure
9.11.4.8.1, figure 9.11.4.8.2, figure 9.11.4.8.3 and table 9.11.4.8.1.
| 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
| Mapped EPS bearer contexts IEI | octet 1 |  |  |  |  |  |  |   
| Length of Mapped EPS bearer contexts contents | octet 2 |  |  |  |  |  |  |   
|  | octet 3 |  |  |  |  |  |  |   
| Mapped EPS bearer context 1 | octet 4 octet u |  |  |  |  |  |  |   
| Mapped EPS bearer context 2 | octet u+1 octet v |  |  |  |  |  |  |   
| â€¦ | octet v+1 octet w |  |  |  |  |  |  |   
| Mapped EPS bearer context n | octet w+1 octet x |  |  |  |  |  |  |   
Figure 9.11.4.8.1: Mapped EPS bearer contexts
| 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
| EPS bearer identity | octet 4 |  |  |  |  |  |  |   
| Length of Mapped EPS bearer context | octet 5 octet 6 |  |  |  |  |  |  |   
| Operation code | 0 Spare | E bit | Number of EPS parameters | octet 7 |  |  |  |   
| EPS parameters list | octet 8* octet u* |  |  |  |  |  |  |   
Figure 9.11.4.8.2: Mapped EPS bearer context
| 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
| EPS parameter identifier 1 | octet 8 |  |  |  |  |  |  |   
| Length of EPS parameter contents 1 | octet 9 |  |  |  |  |  |  |   
| EPS parameter contents 1 | octet 10 octet h |  |  |  |  |  |  |   
| EPS parameter identifier 2 | octet h+1 |  |  |  |  |  |  |   
| Length of EPS parameter contents 2 | octet h+2 |  |  |  |  |  |  |   
| EPS parameter contents 2 | octet h+3 octet i |  |  |  |  |  |  |   
| â€¦ | octet i+1 octet j |  |  |  |  |  |  |   
| EPS parameter identifier N | octet j+1 |  |  |  |  |  |  |   
| Length of EPS parameter contents N | octet j+2 |  |  |  |  |  |  |   
| EPS parameter contents N | octet j+3 octet u |  |  |  |  |  |  |   
Figure 9.11.4.8.3: EPS parameters list
Table 9.11.4.8.1: Mapped EPS bearer contexts information element
+----------------------------------------------------------------------+ | EPS bearer identity (octet 4) | | | | Bits 5 to 8 contain the EPS bearer identity, and are coded as | | specified in subclause 9.3.2 of 3GPP TS 24.301 [15]. Bits 1 to 4 | | are spare and shall be coded as zero. | | | | Operation code (bits 8 to 7 of octet 7)\ | | Bits\ | | 8 7 | | | | 0 0 Reserved\ | | 0 1 Create new EPS bearer | | | | 1 0 Delete existing EPS bearer | | | | 1 1 Modify existing EPS bearer | | | | Bit 6 of octet 7 is spare and shall be coded as zero. | | | | E bit (bit 5 of octet 7) | | | | For the \"create new EPS bearer\" operation, the E bit is encoded as | | follows: | | | | Bit\ | | 5 | | | | 0 parameters list is not included (NOTE) | | | | 1 parameters list is included | | | | For the \"modify existing EPS bearer\" operation, the E bit is | | encoded as follows: | | | | Bit\ | | 5 | | | | 0 extension of previously provided parameters list | | | | 1 replacement of all previously provided parameters list | | | | If the E bit is set to \"parameters list is included\", the number | | of EPS parameters field has non-zero value. If the E bit is set to | | \"extension of previously provided parameters list\" or | | \"replacement of previously provided parameters list\", the number | | of parameters field has non-zero value. | | | | For the \"create new EPS bearer\" operation and \"delete existing | | EPS bearer\" operation, bit 5 of octet 7 is ignored. | | | | Number of EPS parameters (bits 4 to 1 of octet 7) | | | | The number of EPS parameters contains the binary coding for the | | number of EPS parameters in the EPS parameters list field. The | | number of EPS parameters field is encoded in bits 4 through 1 of | | octet 7 where bit 4 is the most significant and bit 1 is the least | | significant bit. | | | | EPS parameters list (octets 8 to u) | | | | The EPS parameters list contains a variable number of EPS | | parameters. | | | | Each EPS parameter included in the EPS parameters list is of | | variable length and consists of: | | | | - an EPS parameter identifier (1 octet);\ | | - the length of the EPS parameter contents (1 octet); and\ | | - the EPS parameter contents itself (variable amount of octets). | | | | The EPS parameter identifier field is used to identify each EPS | | parameter included in the EPS parameters list and it contains the | | hexadecimal coding of the EPS parameter identifier. Bit 8 of the EPS | | parameter identifier field contains the most significant bit and bit | | 1 contains the least significant bit. In this version of the | | protocol, the following EPS parameter identifiers are specified: | | | | - 01H (Mapped EPS QoS parameters);\ | | - 02H (Mapped extended EPS QoS parameters); and | | | | - 03H (Traffic flow template). | | | | - 04H (APN-AMBR). | | | | - 05H (extended APN-AMBR). | | | | If the EPS parameters list contains an EPS parameter identifier that | | is not supported by the receiving entity the corresponding EPS | | parameter shall be discarded. | | | | The length of EPS parameter contents field contains the binary coded | | representation of the length of the EPS parameter contents field. | | The first bit in transmission order is the most significant bit. | | | | When the parameter identifier indicates mapped EPS QoS parameters, | | the length and parameter contents field are coded as specified in | | subclause 9.9.4.3 of 3GPP TS 24.301 [15]. | | | | When the parameter identifier indicates mapped extended EPS QoS | | parameters, the length and parameter contents field are coded as | | specified in subclause 9.9.4.30 of 3GPP TS 24.301 [15]. | | | | When the parameter identifier indicates traffic flow template, the | | length and parameter contents field are coded from octet 2 as shown | | figure 10.5.144 and table 10.5.16.2 of 3GPP TS 24.008 [12]. | | | | When the parameter identifier indicates APN-AMBR, the length and | | parameter contents field are coded as specified in subclause 9.9.4.2 | | of 3GPP TS 24.301 [15]. | | | | When the parameter identifier indicates Extended APN-AMBR, the | | length and parameter contents field are coded as specified in | | subclause 9.9.4.29 of 3GPP TS 24.301 [15]. | +----------------------------------------------------------------------+ | NOTE: This value shall not be used In this version of the | | specification. | +----------------------------------------------------------------------+
#### 9.11.4.9 Maximum number of supported packet filters
The purpose of the Maximum number of supported packet filters information
element is for the UE to indicate to the network the maximum number of packet
filters, associated with signaled QoS rules, that can be supported by the UE
for the PDU session that is being established, when the PDU session type
\"IPv4\", \"IPv6\", \"IPv4v6\" or \"Ethernet\".
The Maximum number of supported packet filters is coded as shown in figure
9.11.4.9.1 and table 9.11.4.9.1.
The Maximum number of supported packet filters is a type 3 information element
with a length of 3 octets.
+--------+--------+-------+-------+-------+-------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+-------+-------+-------+-------+--------+---+---+ | M | octet | | | | | | | | | aximum | 1 | | | | | | | | | number | | | | | | | | | | of | | | | | | | | | | sup | | | | | | | | | | ported | | | | | | | | | | packet | | | | | | | | | | f | | | | | | | | | | ilters | | | | | | | | | | IEI | | | | | | | | | +--------+--------+-------+-------+-------+-------+--------+---+---+ | M | octet | | | | | | | | | aximum | 2 | | | | | | | | | number | | | | | | | | | | of | | | | | | | | | | sup | | | | | | | | | | ported | | | | | | | | | | packet | | | | | | | | | | f | | | | | | | | | | ilters | | | | | | | | | +--------+--------+-------+-------+-------+-------+--------+---+---+ | M | 0 | 0 | 0 | 0 | 0 | octet | | | | aximum | | | | | | 3 | | | | number | Spare | Spare | Spare | Spare | Spare | | | | | of | | | | | | | | | | sup | | | | | | | | | | ported | | | | | | | | | | packet | | | | | | | | | | f | | | | | | | | | | ilters | | | | | | | | | | (cont | | | | | | | | | | inued) | | | | | | | | | +--------+--------+-------+-------+-------+-------+--------+---+---+
Figure 9.11.4.9.1: Maximum number of supported packet filters information
element
Table 9.11.4.9.1: Maximum number of supported packet filters information
element
+----------------------------------------------------------------------+ | Maximum number of supported packet filters (octet 2 to 3) | +----------------------------------------------------------------------+ | In the Maximum number of supported packet filters field bit 8 of the | | first octet is the most significant bit and bit 6 of second octet is | | the least significant bit. Bit 5 to bit 1 of the second octet are | | spare bits and shall be coded as zero. | | | | The number of supported packet filters shall be in the range of 17 | | to 1024. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+
#### 9.11.4.10 PDU address
The purpose of the PDU address information element is to assign to the UE:
\- an IPv4 address associated with a PDU session;
\- an interface identifier for the IPv6 link local address associated with the
PDU session; or
\- an IPv4 address and an interface identifier for the IPv6 link local
address, associated with the PDU session.
This purpose of the PDU address information element is also to enable the
W-AGF acting on behalf of the FN-RG to provide an interface identifier for the
IPv6 link local address associated with the PDU session suggested to be
allocated to the FN-RG, and to enable the SMF to provide SMF\'s IPv6 link
local address to the W-AGF acting on behalf of the FN-RG.
The PDU address information element is coded as shown in figure 9.11.4.10.1
and table 9.11.4.10.1.
The PDU address is a type 4 information element with minimum length of 7
octets and a maximum length of 31 octets.
+--------+--------+-------+-------+--------+--------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+-------+-------+--------+--------+--------+---+---+ | PDU | octet | | | | | | | | | a | 1 | | | | | | | | | ddress | | | | | | | | | | IEI | | | | | | | | | +--------+--------+-------+-------+--------+--------+--------+---+---+ | Length | octet | | | | | | | | | of PDU | 2 | | | | | | | | | a | | | | | | | | | | ddress | | | | | | | | | | co | | | | | | | | | | ntents | | | | | | | | | +--------+--------+-------+-------+--------+--------+--------+---+---+ | 0 | 0 | 0 | 0 | SI6LLA | PDU | octet | | | | | | | | | s | 3 | | | | Spare | Spare | Spare | Spare | | ession | | | | | | | | | | type | | | | | | | | | | value | | | | +--------+--------+-------+-------+--------+--------+--------+---+---+ | PDU | octet | | | | | | | | | a | 4 | | | | | | | | | ddress | | | | | | | | | | infor | octet | | | | | | | | | mation | n | | | | | | | | +--------+--------+-------+-------+--------+--------+--------+---+---+ | SMF\'s | octet | | | | | | | | | IPv6 | ( | | | | | | | | | link | n+1)* | | | | | | | | | local | | | | | | | | | | a | octet | | | | | | | | | ddress | (n | | | | | | | | | | +16)* | | | | | | | | +--------+--------+-------+-------+--------+--------+--------+---+---+
Figure 9.11.4.10.1: PDU address information element
Table 9.11.4.10.1: PDU address information element
* * *
PDU session type value (octet 3, bits 1 to 3)  
Bits  
3 2 1  
0 0 1 IPv4 0 1 0 IPv6 0 1 1 IPv4v6
All other values are reserved.
SI6LLA (SMF\'s IPv6 link local address) bit (octet 3, bit 4) (see NOTE)  
Bit  
4  
0 SMF\'s IPv6 link local address field is absent 1 SMF\'s IPv6 link local
address field is present
Bits 5 to 8 of octet 3 are spare and shall be coded as zero.
PDU address information (octet 4 to n)
If the PDU session type value indicates IPv4, the PDU address information in
octet 4 to octet 7 contains an IPv4 address.
If the PDU session type value indicates IPv6, the PDU address information in
octet 4 to octet 11 contains an interface identifier for the IPv6 link local
address.
If the PDU session type value indicates IPv4v6, the PDU address information in
octet 4 to octet 11 contains an interface identifier for the IPv6 link local
address and in octet 12 to octet 15 contains an IPv4 address.
SMF\'s IPv6 link local address (octet n+1 to n+16)
SMF\'s IPv6 link local address field contains SMF\'s IPv6 link local address.
NOTE: In the UE to network direction, the SI6LLA bit shall be set to \"SMF\'s
IPv6 link local address field is absent\".
* * *
#### 9.11.4.11 PDU session type
The purpose of the PDU session type information element is to indicate type of
the PDU session.
The PDU session type information element is coded as shown in figure
9.11.4.11.1 and table 9.11.4.11.1.
The PDU session type is a type 1 information element.
+----------------------+-------+------------------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------+-------+------------------------+---------+---+---+---+---+---+ | PDU session type IEI | 0 | PDU session type value | octet 1 | | | | | | | | | | | | | | | | | | Spare | | | | | | | | +----------------------+-------+------------------------+---------+---+---+---+---+---+
Figure 9.11.4.11.1: PDU session type information element
Table 9.11.4.11.1: PDU session type information element
PDU session type value (octet 1, bit 1 to bit 3)
* * *
Bits  
3 2 1  
0 0 1 IPv4 0 1 0 IPv6 0 1 1 IPv4v6 1 0 0 Unstructured 1 0 1 Ethernet 1 1 1
reserved
All other values are unused and shall be interpreted as \"IPv4v6\", if
received by the UE or the network.
#### 9.11.4.12 QoS flow descriptions
The purpose of the QoS flow descriptions information element is to indicate a
set of QoS flow descriptions to be used by the UE, where each QoS flow
description is a set of parameters as described in subclause 6.2.5.1.1.4.
The QoS flow descriptions information element is a type 6 information element
with a minimum length of 6 octets. The maximum length for the information
element is 65538 octets.
The QoS flow descriptions information element is coded as shown in figure
9.11.4.12.1, figure 9.11.4.12.2, figure 9.11.4.12.3, figure 9.11.4.12.4, and
table 9.11.4.12.1.
+------------------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------------------+-----------+---+---+---+---+---+---+---+ | QoS flow descriptions IEI | octet 1 | | | | | | | | +------------------------------------------+-----------+---+---+---+---+---+---+---+ | Length of QoS flow descriptions contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +------------------------------------------+-----------+---+---+---+---+---+---+---+ | QoS flow description 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet u | | | | | | | | +------------------------------------------+-----------+---+---+---+---+---+---+---+ | QoS flow description 2 | octet u+1 | | | | | | | | | | | | | | | | | | | | octet v | | | | | | | | +------------------------------------------+-----------+---+---+---+---+---+---+---+ | ... | octet v+1 | | | | | | | | | | | | | | | | | | | | octet w | | | | | | | | +------------------------------------------+-----------+---+---+---+---+---+---+---+ | QoS flow description n | octet w+1 | | | | | | | | | | | | | | | | | | | | octet x | | | | | | | | +------------------------------------------+-----------+---+---+---+---+---+---+---+
Figure 9.11.4.12.1: QoS flow descriptions information element
+-----------------+-----------+----------------------+---------+-------+-------+---------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------+-----------+----------------------+---------+-------+-------+---------+---+---+ | 0 | 0 | QFI | octet 4 | | | | | | | | | | | | | | | | | Spare | Spare | | | | | | | | +-----------------+-----------+----------------------+---------+-------+-------+---------+---+---+ | Operation code | 0 | 0 | 0 | 0 | 0 | octet 5 | | | | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | | | | +-----------------+-----------+----------------------+---------+-------+-------+---------+---+---+ | 0 | E | Number of parameters | octet 6 | | | | | | | | | | | | | | | | | Spare | | | | | | | | | +-----------------+-----------+----------------------+---------+-------+-------+---------+---+---+ | Parameters list | octet 7* | | | | | | | | | | | | | | | | | | | | octet u* | | | | | | | | +-----------------+-----------+----------------------+---------+-------+-------+---------+---+---+
Figure 9.11.4.12.2: QoS flow description
+-------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------+-----------+---+---+---+---+---+---+---+ | Parameter 1 | octet 7 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+ | Parameter 2 | octet m+1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+ | ... | octet n+1 | | | | | | | | | | | | | | | | | | | | octet o | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+ | Parameter n | octet o+1 | | | | | | | | | | | | | | | | | | | | octet u | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+
Figure 9.11.4.12.3: Parameters list
+------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------+---------+---+---+---+---+---+---+---+ | Parameter identifier | octet 7 | | | | | | | | +------------------------------+---------+---+---+---+---+---+---+---+ | Length of parameter contents | octet 8 | | | | | | | | +------------------------------+---------+---+---+---+---+---+---+---+ | Parameter contents | octet 9 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +------------------------------+---------+---+---+---+---+---+---+---+
Figure 9.11.4.12.4: Parameter
Table 9.11.4.12.1: QoS flow descriptions information element
+----------------------------------------------------------------------+ | QoS flow identifier (QFI) (bits 6 to 1 of octet 4) | | | | QFI field contains the QoS flow identifier. | | | | Bits | | | | 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 no QoS flow identifier assigned | | | | 0 0 0 0 0 1 QFI 1 | | | | to | | | | 1 1 1 1 1 1 QFI 63 | | | | The network shall not set the QFI value to 0. | +----------------------------------------------------------------------+ | Operation code (bits 8 to 6 of octet 5) | | | | Bits | | | | 8 7 6 | | | | 0 0 1 Create new QoS flow description | | | | 0 1 0 Delete existing QoS flow description | | | | 0 1 1 Modify existing QoS flow description | | | | All other values are reserved. | +----------------------------------------------------------------------+ | E bit (bit 7 of octet 6) | | | | For the \"create new QoS flow description\" operation, the E bit is | | encoded as follows: | | | | Bit\ | | 7 | | | | 0 reserved | | | | 1 parameters list is included | | | | For the \"Delete existing QoS flow description\" operation, the E | | bit is encoded as follows: | | | | Bit\ | | 7 | | | | 0 parameters list is not included | | | | 1 reserved | | | | For the \"modify existing QoS flow description\" operation, the E | | bit is encoded as follows: | | | | Bit\ | | 7 | | | | 0 extension of previously provided parameters | | | | 1 replacement of all previously provided parameters | | | | If the E bit is set to \"parameters list is not included\", the | | number of parameters field has zero value. If the E bit is set to | | \"parameters list is included\", the number of parameters field has | | non-zero value. If the E bit is set to \"extension of previously | | provided parameters\" or \"replacement of all previously provided | | parameters\", the number of parameters field has non-zero value. If | | the E bit is set to \"extension of previously provided parameters\" | | and one of the parameters in the new parameters list already exists | | in the previously provided parameters, the parameter shall be set to | | the new value. | | | | Number of parameters (bits 6 to 1 of octet 6) | | | | The number of parameters field contains the binary coding for the | | number of parameters in the parameters list field. The number of | | parameters field is encoded in bits 6 through 1 of octet 6 where bit | | 6 is the most significant and bit 1 is the least significant bit. | | | | Parameters list (octets 7 to u) | | | | The parameters list contains a variable number of parameters. | | | | Each parameter included in the parameters list is of variable length | | and consists of: | | | | - a parameter identifier (1 octet);\ | | - the length of the parameter contents (1 octet); and\ | | - the parameter contents itself (variable amount of octets). | | | | The parameter identifier field is used to identify each parameter | | included in the parameters list and it contains the hexadecimal | | coding of the parameter identifier. Bit 8 of the parameter | | identifier field contains the most significant bit and bit 1 | | contains the least significant bit. In this version of the protocol, | | the following parameter identifiers are specified: | | | | - 01H (5QI);\ | | - 02H (GFBR uplink); | | | | - 03H (GFBR downlink); | | | | - 04H (MFBR uplink); | | | | - 05H (MFBR downlink); | | | | - 06H (Averaging window); and | | | | - 07H (EPS bearer identity). | | | | If the parameters list contains a parameter identifier that is not | | supported by the receiving entity the corresponding parameter shall | | be discarded. | | | | The length of parameter contents field contains the binary coded | | representation of the length of the parameter contents field. The | | first bit in transmission order is the most significant bit. | | | | When the parameter identifier indicates 5QI, the parameter contents | | field contains the binary representation of 5G QoS identifier (5QI) | | that is one octet in length. | | | | 5QI: | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Reserved | | | | 0 0 0 0 0 0 0 1 5QI 1 | | | | 0 0 0 0 0 0 1 0 5QI 2 | | | | 0 0 0 0 0 0 1 1 5QI 3 | | | | 0 0 0 0 0 1 0 0 5QI 4 | | | | 0 0 0 0 0 1 0 1 5QI 5 | | | | 0 0 0 0 0 1 1 0 5QI 6 | | | | 0 0 0 0 0 1 1 1 5QI 7 | | | | 0 0 0 0 1 0 0 0 5QI 8 | | | | 0 0 0 0 1 0 0 1 5QI 9 | | | | 0 0 0 0 1 0 1 0 5QI 10 | | | | 0 0 0 0 1 0 1 1 | | | | to Spare | | | | 0 1 0 0 0 0 0 0 | | | | 0 1 0 0 0 0 0 1 5QI 65 | | | | 0 1 0 0 0 0 1 0 5QI 66 | | | | 0 1 0 0 0 0 1 1 5QI 67 | | | | 0 1 0 0 0 1 0 0 Spare | | | | 0 1 0 0 0 1 0 1 5QI 69 | | | | 0 1 0 0 0 1 1 0 5QI 70 | | | | 0 1 0 0 0 1 1 1 5QI 71 | | | | 0 1 0 0 1 0 0 0 5QI 72 | | | | 0 1 0 0 1 0 0 1 5QI 73 | | | | 0 1 0 0 1 0 1 0 5QI 74 | | | | 0 1 0 0 1 0 1 1 5QI 75 | | | | 0 1 0 0 1 1 0 0 5QI 76 | | | | 0 1 0 0 1 1 0 1 | | | | to Spare | | | | 0 1 0 0 1 1 1 0 | | | | 0 1 0 0 1 1 1 1 5QI 79 | | | | 0 1 0 1 0 0 0 0 5QI 80 | | | | 0 1 0 1 0 0 0 1 Spare | | | | 0 1 0 1 0 0 1 0 5QI 82 | | | | 0 1 0 1 0 0 1 1 5QI 83 | | | | 0 1 0 1 0 1 0 0 5QI 84 | | | | 0 1 0 1 0 1 0 1 5QI 85 | | | | 0 1 0 1 0 1 1 0 5QI 86 | | | | 0 1 0 1 0 1 1 1 5QI 87 | | | | 0 1 0 1 1 0 0 0 5QI 88 | | | | 0 1 0 1 1 0 0 1 5QI 89 | | | | 0 1 0 1 1 0 1 0 5QI 90 | | | | 0 1 0 1 1 0 1 1 | | | | to Spare | | | | 0 1 1 1 1 1 1 1 | | | | 1 0 0 0 0 0 0 0 | | | | to Operator-specific 5QIs | | | | 1 1 1 1 1 1 1 0 | | | | 1 1 1 1 1 1 1 1 Reserved | | | | The network shall consider all other values not explicitly defined | | in this version of the protocol as unsupported. | | | | If the UE receives a 5QI value (excluding the reserved 5QI values) | | that it does not understand, the UE shall choose a 5QI value from | | the set of 5QI values defined in this version of the protocol (see | | 3GPP TS 23.501 [8]) and associated with: | | | | - GBR QoS flows, if the QoS flow includes a GFBR uplink parameter, | | a GFBR downlink parameter, a MFBR uplink parameter and a MFBR | | downlink parameter; and | | | | - non-GBR QoS flows, if the QoS flow does not include any one of a | | GFBR uplink parameter, a GFBR downlink parameter, a MFBR uplink | | parameter or a MFBR downlink parameter. | | | | The UE shall use this chosen 5QI value for internal operations only. | | The UE shall use the received 5QI value in subsequent NAS signalling | | procedures. | | | | When the parameter identifier indicates \"GFBR uplink\", the | | parameter contents field contains one octet indicating the unit of | | the guaranteed flow bit rate for uplink followed by two octets | | containing the value of the guaranteed flow bit rate for uplink. | | | | Unit of the guaranteed flow bit rate for uplink (octet 1) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 value is not used (see NOTE 2) | | | | 0 0 0 0 0 0 0 1 value is incremented in multiples of 1 Kbps | | | | 0 0 0 0 0 0 1 0 value is incremented in multiples of 4 Kbps | | | | 0 0 0 0 0 0 1 1 value is incremented in multiples of 16 Kbps | | | | 0 0 0 0 0 1 0 0 value is incremented in multiples of 64 Kbps | | | | 0 0 0 0 0 1 0 1 value is incremented in multiples of 256 Kbps | | | | 0 0 0 0 0 1 1 0 value is incremented in multiples of 1 Mbps | | | | 0 0 0 0 0 1 1 1 value is incremented in multiples of 4 Mbps | | | | 0 0 0 0 1 0 0 0 value is incremented in multiples of 16 Mbps | | | | 0 0 0 0 1 0 0 1 value is incremented in multiples of 64 Mbps | | | | 0 0 0 0 1 0 1 0 value is incremented in multiples of 256 Mbps | | | | 0 0 0 0 1 0 1 1 value is incremented in multiples of 1 Gbps | | | | 0 0 0 0 1 1 0 0 value is incremented in multiples of 4 Gbps | | | | 0 0 0 0 1 1 0 1 value is incremented in multiples of 16 Gbps | | | | 0 0 0 0 1 1 1 0 value is incremented in multiples of 64 Gbps | | | | 0 0 0 0 1 1 1 1 value is incremented in multiples of 256 Gbps | | | | 0 0 0 1 0 0 0 0 value is incremented in multiples of 1 Tbps | | | | 0 0 0 1 0 0 0 1 value is incremented in multiples of 4 Tbps | | | | 0 0 0 1 0 0 1 0 value is incremented in multiples of 16 Tbps | | | | 0 0 0 1 0 0 1 1 value is incremented in multiples of 64 Tbps | | | | 0 0 0 1 0 1 0 0 value is incremented in multiples of 256 Tbps | | | | 0 0 0 1 0 1 0 1 value is incremented in multiples of 1 Pbps | | | | 0 0 0 1 0 1 1 0 value is incremented in multiples of 4 Pbps | | | | 0 0 0 1 0 1 1 1 value is incremented in multiples of 16 Pbps | | | | 0 0 0 1 1 0 0 0 value is incremented in multiples of 64 Pbps | | | | 0 0 0 1 1 0 0 1 value is incremented in multiples of 256 Pbps | | | | Other values shall be interpreted as multiples of 256 Pbps in this | | version of the protocol. | | | | Value of the guaranteed flow bit rate for uplink (octets 2 and 3) | | | | Octets 2 and 3 represent the binary coded value of the guaranteed | | flow bit rate for uplink in units defined by the unit of the | | guaranteed flow bit rate for uplink. | | | | When the UE indicates subscribed GFBR for uplink, the \"GFBR | | uplink\" parameter is not included in the \"Parameters list\". | | | | When the parameter identifier indicates \"GFBR downlink\", the | | parameter contents field contains one octet indicating the unit of | | the guaranteed flow bit rate for downlink followed by two octets | | containing the value of the guaranteed flow bit rate for downlink. | | | | Unit of the guaranteed flow bit rate for downlink (octet 1) | | | | The coding is identical to that of the unit of the guaranteed flow | | bit rate for uplink. | | | | Value of the guaranteed flow bit rate for downlink (octets 2 and 3) | | | | Octets 2 and 3 represent the binary coded value of the guaranteed | | flow bit rate for downlink in units defined by the unit of the | | guaranteed flow bit rate for downlink. | | | | When the UE indicates subscribed GFBR for downlink, the \"GFBR | | downlink\" parameter is not included in the \"Parameters list\". | | | | When the parameter identifier indicates \"MFBR uplink\", the | | parameter contents field contains the one octet indicating the unit | | of the maximum flow bit rate for uplink followed by two octets | | containing the value of maximum flow bit rate for uplink. | | | | Unit of the maximum flow bit rate for uplink (octet 1) | | | | The coding is identical to that of the unit of the guaranteed flow | | bit rate for uplink. | | | | Value of the maximum flow bit rate for uplink (octets 2 and 3) | | | | Octets 2 and 3 represent the binary coded value of the maximum flow | | bit rate for uplink in units defined by the unit of the maximum flow | | bit rate for uplink. | | | | When the UE indicates subscribed MFBR for uplink, the \"MFBR | | uplink\" parameter is not included in the \"Parameters list\". | | | | When the parameter identifier indicates \"MFBR downlink\", the | | parameter contents field contains one octet indicating the unit of | | the maximum flow bit rate for downlink followed by two octets | | containing the value of the maximum flow bit rate for downlink. | | | | Unit of the maximum flow bit rate for downlink (octet 1) | | | | The coding is identical to that of the unit of the guaranteed flow | | bit rate for uplink. | | | | Value of the maximum flow bit rate for downlink (octets 2 and 3) | | | | Octets 2 and 3 represent the binary coded value of the maximum flow | | bit rate for downlink in units defined by the unit of the maximum | | flow bit rate for downlink. | | | | When the UE indicates subscribed MFBR for downlink, the \"MFBR | | downlink\" parameter is not included in the \"Parameters list\". | | | | In this version of the protocol, for messages specified in the | | present document, the sending entity shall not request 0 kbps for | | both the maximum flow bit rate for downlink and the maximum flow bit | | rate for uplink at the same time. Any entity receiving a request for | | 0 kbps in both the maximum flow bit rate for downlink and the | | maximum flow bit rate for uplink shall consider that as a | | syntactical error (see clause 7). | | | | When the parameter identifier indicates \"averaging window\", the | | parameter contents field contains the binary representation of the | | averaging window for both uplink and downlink in milliseconds and | | the parameter contents field is two octets in length. | | | | When the parameter identifier indicates EPS bearer identity, the | | length of EPS bearer identity is one octet, bits 5 to 8 of the | | parameter contents contain the EPS bearer identity as specified in | | subclause 9.3.2 of 3GPP TS 24.301 [15] (see NOTE) and bits 1 to 4 | | of the parameter contents are spare and shall be coded as zero. The | | UE shall not include the EPS bearer identity parameter in any mobile | | originated 5GSM messages. | +----------------------------------------------------------------------+ | | +----------------------------------------------------------------------+ | NOTE 1: The total number of EPS bearer identities included in all | | QoS flow descriptions of a UE cannot exceed fifteen. | | | | NOTE 2: In this release of the specifications if received it shall | | be interpreted as value is incremented in multiples of 1 Kbps. In | | earlier releases of specifications, the interpretation of this value | | is up to implementation. | +----------------------------------------------------------------------+
#### 9.11.4.13 QoS rules
The purpose of the QoS rules information element is to indicate a set of QoS
rules to be used by the UE, where each QoS rule is a set of parameters as
described in subclause 6.2.5.1.1.2:
a) for classification and marking of uplink user traffic; and
b) for identification of a QoS flow which the network is to use for a
particular downlink user traffic.
NOTE: The UE needs to be aware of a QoS flow which the network is to use for a
particular downlink user traffic e.g. to determine whether a resource is
available for downlink media of a media stream of an SDP media description
provided by the UE in an IMS session.
The QoS rules may contain a set of packet filters consisting of zero or more
packet filters for UL direction, zero or more packet filters for DL direction,
zero or more packet filters for both UL and DL directions or any combinations
of these. The set of packet filters determine the traffic mapping to QoS
flows.
The QoS rules information element is a type 6 information element with a
minimum length of 7 octets. The maximum length for the information element is
65538 octets.
The QoS rules information element is coded as shown in figure 9.11.4.13.1,
figure 9.11.4.13.2, figure 9.11.4.13.3, figure 9.11.4.13.4 and table
9.11.4.13.1.
| 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
| QoS rules IEI | octet 1 |  |  |  |  |  |  |   
| Length of QoS rules IE | octet 2 |  |  |  |  |  |  |   
|  | octet 3 |  |  |  |  |  |  |   
| QoS rule 1 | octet 4 octet u |  |  |  |  |  |  |   
| QoS rule 2 | octet u+1 octet v |  |  |  |  |  |  |   
| â€¦ | octet v+1 octet w |  |  |  |  |  |  |   
| QoS rule n | octet w+1 octet x |  |  |  |  |  |  |   
Figure 9.11.4.13.1: QoS rules information element
| 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
| QoS rule identifier | octet 4 |  |  |  |  |  |  |   
| Length of QoS rule | octet 5 |  |  |  |  |  |  |   
|  | octet 6 |  |  |  |  |  |  |   
| Rule operation code | DQR bit | Number of packet filters | octet 7 |  |  |  |  |   
| Packet filter list | octet 8* octet m* |  |  |  |  |  |  |   
| QoS rule precedence | octet m+1* |  |  |  |  |  |  |   
| 0 Spare | Segregation | QoS flow identifier (QFI) | octet m+2* |  |  |  |  |   
Figure 9.11.4.13.2: QoS rule (u=m+2)
* * *
     8       7   6   5   4                            3           2   1   
     0       0   0   0   Packet filter identifier 1   octet 8             
     Spare                                                                
     0       0   0   0   Packet filter identifier 2   octet 9             
     Spare                                                                
     ...                                                                  
     0       0   0   0   Packet filter identifier N   octet N+7           
     Spare
* * *
Figure 9.11.4.13.3: Packet filter list when the rule operation is \"modify
existing QoS rule and delete packet filters\" (z=N+7)
| 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |   
---|---|---|---|---|---|---|---|---|---  
| 0 | 0 | Packet filter direction 1 | Packet filter identifier 1 | octet 8 |  |  |  |   
| Spare |  |  |  |  |  |  |  |   
| Length of packet filter contents 1 | octet 9 |  |  |  |  |  |  |   
| Packet filter contents 1 | octet 10 octet m |  |  |  |  |  |  |   
| 0 | 0 | Packet filter direction 2 | Packet filter identifier 2 | octet m+1 |  |  |  |   
| Spare |  |  |  |  |  |  |  |   
| Length of packet filter contents 2 | octet m+2 |  |  |  |  |  |  |   
| Packet filter contents 2 | octet m+3 octet n |  |  |  |  |  |  |   
| â€¦ | octet n+1 octet y |  |  |  |  |  |  |   
| 0 | 0 | Packet filter direction N | Packet filter identifier N | octet y+1 |  |  |  |   
| Spare |  |  |  |  |  |  |  |   
| Length of packet filter contents N | octet y+2 |  |  |  |  |  |  |   
| Packet filter contents N | octet y+3 octet z |  |  |  |  |  |  |   
Figure 9.11.4.13.4: Packet filter list when the rule operation is \"create new
QoS rule\", or \"modify existing QoS rule and add packet filters\" or \"modify
existing QoS rule and replace all packet filters\"
Table 9.11.4.13.1: QoS rules information element
+----------------------------------------------------------------------+ | QoS rule identifier (octet 4) | | | | The QoS rule identifier field is used to identify the QoS rule. | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 no QoS rule identifier assigned | | | | 0 0 0 0 0 0 0 1 QRI 1 | | | | to | | | | 1 1 1 1 1 1 1 1 QRI 255 | | | | The network shall not set the QRI value to 0. | | | | QoS rule precedence (octet m+1) | | | | The QoS rule precedence field is used to specify the precedence of | | the QoS rule among all QoS rules (both the signalled QoS rules as | | described in subclause 6.2.5.1.1.2 and the derived QoS rules as | | described in subclause 6.2.5.1.1.3) associated with the PDU session | | of the QoS flow. This field includes the binary coded value of the | | QoS rule precedence in the range from 0 to 255 (decimal). The higher | | the value of the QoS rule precedence field, the lower the precedence | | of that QoS rule is. For the \"delete existing QoS rule\" operation, | | the QoS rule precedence value field shall not be included. For the | | \"create new QoS rule\" operation, the QoS rule precedence value | | field shall be included. | | | | The value 80 (decimal) is reserved. | | | | Segregation bit (bit 7 of octet m+2) (see NOTE 1) | | | | In the UE to network direction the segregation bit indicates whether | | the UE is requesting the network to bind service data flows | | described by the QoS rule to a dedicated QoS Flow and it is encoded | | as follows. In the network to UE direction this bit is spare. | | | | Bit | | | | 7 | | | | 0 Segregation not requested | | | | 1 Segregation requested | | | | QoS flow identifier (QFI) (bits 6 to 1 of octet m+2) (see NOTE 1) | | | | The QoS flow identifier (QFI) field contains the QoS flow | | identifier. | | | | Bits | | | | 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 no QoS flow identifier assigned | | | | 0 0 0 0 0 1 QFI 1 | | | | to | | | | 1 1 1 1 1 1 QFI 63 | | | | The network shall not set the QFI value to 0. | | | | For the \"delete existing QoS rule\" operation, the QoS flow | | identifier value field shall not be included. For the \"create new | | QoS rule\" operation, the QoS flow identifier value field shall be | | included. | | | | DQR bit (bit 5 of octet 7) | | | | The DQR bit indicates whether the QoS rule is the default QoS rule | | and it is encoded as follows: | | | | Bit | | | | 5 | | | | 0 the QoS rule is not the default QoS rule. | | | | 1 the QoS rule is the default QoS rule. | | | | Rule operation code (bits 8 to 6 of octet 7)\ | | Bits\ | | 8 7 6 | | | | 0 0 0 Reserved\ | | 0 0 1 Create new QoS rule | | | | 0 1 0 Delete existing QoS rule | | | | 0 1 1 Modify existing QoS rule and add packet filters | | | | 1 0 0 Modify existing QoS rule and replace all packet filters | | | | 1 0 1 Modify existing QoS rule and delete packet filters | | | | 1 1 0 Modify existing QoS rule without modifying packet filters | | | | 1 1 1 Reserved | | | | Number of packet filters (bits 4 to 1 of octet 7) | | | | The number of packet filters contains the binary coding for the | | number of packet filters in the packet filter list. The number of | | packet filters field is encoded in bits 4 through 1 of octet 7 where | | bit 4 is the most significant and bit 1 is the least significant | | bit. For the \"delete existing QoS rule\" operation and for the | | \"modify existing QoS rule without modifying packet filters\" | | operation, the number of packet filters shall be coded as 0. For the | | \"create new QoS rule\" operation and the \"modify existing QoS rule | | and replace all packet filters\" operation, the number of packet | | filters shall be greater than or equal to 0 and less than or equal | | to 15. For all other operations, the number of packet filters shall | | be greater than 0 and less than or equal to 15. | | | | Packet filter list (octets 8 to m) | | | | The packet filter list contains a variable number of packet filters. | | | | For the \"delete existing QoS rule\" operation, the length of QoS | | rule field is set to one. | | | | For the \"delete existing QoS rule\" operation and the \"modify | | existing QoS rule without modifying packet filters\" operation, the | | packet filter list shall be empty. | | | | For the \"modify existing QoS rule and delete packet filters\" | | operation, the packet filter list shall contain a variable number of | | packet filter identifiers. This number shall be derived from the | | coding of the number of packet filters field in octet 7. | | | | For the \"create new QoS rule\" operation and for the \"modify | | existing QoS rule and replace all packet filters\" operation, the | | packet filter list shall contain 0 or a variable number of packet | | filters. This number shall be derived from the coding of the number | | of packet filters field in octet 7. | | | | For the \"modify existing QoS rule and add packet filters\" | | operation, the packet filter list shall contain a variable number of | | packet filters. This number shall be derived from the coding of the | | number of packet filters field in octet 7. | | | | Each packet filter is of variable length and consists of | | | | a packet filter direction (2 bits);\ | | - a packet filter identifier (4 bits);\ | | - the length of the packet filter contents (1 octet); and\ | | - the packet filter contents itself (variable amount of octets). | | | | The _packet filter direction_ field is used to indicate for what | | traffic direction the filter applies. | | | | Bits | | | | 6 5 | | | | 0 0 reserved | | | | 0 1 downlink only (see NOTE 2) | | | | 1 0 uplink only | | | | 1 1 bidirectional | | | | The packet filter identifier field is used to identify each packet | | filter in a QoS rule. The least significant 4 bits are used. When | | the UE requests to \"create new QoS rule\", \"modify existing QoS | | rule and replace all packet filters\" or \"modify existing QoS rule | | and add packet filters\", the packet filter identifier values shall | | be set to 0. | | | | The length of the packet filter contents field contains the binary | | coded representation of the length of the packet filter contents | | field of a packet filter. The first bit in transmission order is the | | most significant bit. | | | | The packet filter contents field is of variable size and contains a | | variable number (at least one) of packet filter components. Each | | packet filter component shall be encoded as a sequence of a one | | octet packet filter component type identifier and a fixed length | | packet filter component value field. The packet filter component | | type identifier shall be transmitted first. | | | | In each packet filter, there shall not be more than one occurrence | | of each packet filter component type. Among the \"IPv4 remote | | address type\" and \"IPv6 remote address/prefix length type\" packet | | filter components, only one shall be present in one packet filter. | | Among the \"IPv4 local address type\" and \"IPv6 local | | address/prefix length type\" packet filter components, only one | | shall be present in one packet filter. Among the \"single local port | | type\" and \"local port range type\" packet filter components, only | | one shall be present in one packet filter. Among the \"single remote | | port type\" and \"remote port range type\" packet filter components, | | only one shall be present in one packet filter. If the \"match-all | | type\" packet filter component is present in the packet filter, no | | other packet filter component shall be present in the packet filter | | and the length of the packet filter contents field shall be set to | | one. If the \"Ethertype type\" packet filter component is present in | | the packet filter and the \"Ethertype type\" packet filter component | | value is neither \"0x0800\" (for IPv4) nor \"0x86DD\" (for IPv6), no | | IP packet filter component shall be present in the packet filter. | | | | The term \"IP packet filter component\" refers to \"IPv4 remote | | address type\", \"IPv4 local address type\", \"IPv6 remote | | address/prefix length type\", \"IPv6 local address/prefix length | | type\", \"Protocol identifier/Next header type\", \"Single local | | port type\", \"Local port range type\", \"Single remote port type\", | | \"Remote port range type\", \"Security parameter index type\", | | \"Type of service/Traffic class type\" and \"Flow label type\". | | | | The term local refers to the UE and the term remote refers to an | | external network entity. | | | | Packet filter component type identifier\ | | Bits\ | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 1 Match-all type (see NOTE 2)\ | | 0 0 0 1 0 0 0 0 IPv4 remote address type\ | | 0 0 0 1 0 0 0 1 IPv4 local address type\ | | 0 0 1 0 0 0 0 1 IPv6 remote address/prefix length type\ | | 0 0 1 0 0 0 1 1 IPv6 local address/prefix length type\ | | 0 0 1 1 0 0 0 0 Protocol identifier/Next header type\ | | 0 1 0 0 0 0 0 0 Single local port type\ | | 0 1 0 0 0 0 0 1 Local port range type\ | | 0 1 0 1 0 0 0 0 Single remote port type\ | | 0 1 0 1 0 0 0 1 Remote port range type\ | | 0 1 1 0 0 0 0 0 Security parameter index type\ | | 0 1 1 1 0 0 0 0 Type of service/Traffic class type\ | | 1 0 0 0 0 0 0 0 Flow label type | | | | 1 0 0 0 0 0 0 1 Destination MAC address type\ | | 1 0 0 0 0 0 1 0 Source MAC address type\ | | 1 0 0 0 0 0 1 1 802.1Q C-TAG VID type\ | | 1 0 0 0 0 1 0 0 802.1Q S-TAG VID type\ | | 1 0 0 0 0 1 0 1 802.1Q C-TAG PCP/DEI type\ | | 1 0 0 0 0 1 1 0 802.1Q S-TAG PCP/DEI type\ | | 1 0 0 0 0 1 1 1 Ethertype type\ | | 1 0 0 0 1 0 0 0 Destination MAC address range type\ | | 1 0 0 0 1 0 0 1 Source MAC address range type | | | | All other values are reserved. | | | | The description and valid combinations of packet filter component | | type identifiers in a packet filter are defined in | | 3GPP TS 23.**501 [8]**. | | | | For \"match-all type\", the packet filter component shall not | | include the packet filter component value field. | | | | For \"IPv4 remote address type\", the packet filter component value | | field shall be encoded as a sequence of a four octet IPv4 address | | field and a four octet IPv4 address mask field. The IPv4 address | | field shall be transmitted first. | | | | For \"IPv4 local address type\", the packet filter component value | | field shall be encoded as defined for \"IPv4 remote address type\". | | | | For \"IPv6 remote address/prefix length type\", the packet filter | | component value field shall be encoded as a sequence of a sixteen | | octet IPv6 address field and one octet prefix length field. The IPv6 | | address field shall be transmitted first. | | | | For \"IPv6 local address/prefix length type\", the packet filter | | component value field shall be encoded as defined for \"IPv6 remote | | address /prefix length\". | | | | For \"protocol identifier/Next header type\", the packet filter | | component value field shall be encoded as one octet which specifies | | the IPv4 protocol identifier or Ipv6 next header. | | | | For \"single local port type\" and \"single remote port type\", the | | packet filter component value field shall be encoded as two octets | | which specify a port number. | | | | For \"local port range type\" and \"remote port range type\", the | | packet filter component value field shall be encoded as a sequence | | of a two octet port range low limit field and a two octet port range | | high limit field. The port range low limit field shall be | | transmitted first. | | | | For \"security parameter index\", the packet filter component value | | field shall be encoded as four octets which specify the IPSec | | security parameter index. | | | | For \"type of service/traffic class type\", the packet filter | | component value field shall be encoded as a sequence of a one octet | | type-of-service/traffic class field and a one octet | | type-of-service/traffic class mask field. The | | type-of-service/traffic class field shall be transmitted first. | | | | For \"flow label type\", the packet filter component value field | | shall be encoded as three octets which specify the IPv6 flow label. | | The bits 8 through 5 of the first octet shall be spare whereas the | | remaining 20 bits shall contain the IPv6 flow label. | | | | For \"destination MAC address type\" and \"source MAC address | | type\", the packet filter component value field shall be encoded as | | 6 octets which specify a MAC address. When the _packet filter | | direction_ field indicates \"bidirectional\", the destination MAC | | address is the remote MAC address and the source MAC address is the | | local MAC address. | | | | For \"802.1Q C-TAG VID type\", the packet filter component value | | field shall be encoded as two octets which specify the VID of the | | customer-VLAN tag (C-TAG). The bits 8 through 5 of the first octet | | shall be spare whereas the remaining 12 bits shall contain the VID. | | If there are more than one C-TAG in the Ethernet frame header, the | | outermost C-TAG is evaluated. | | | | For \"802.1Q S-TAG VID type\", the packet filter component value | | field shall be encoded as two octets which specify the VID of the | | service-VLAN tag (S-TAG). The bits 8 through 5 of the first octet | | shall be spare whereas the remaining 12 bits shall contain the VID. | | If there are more than one S-TAG in the Ethernet frame header, the | | outermost S-TAG is evaluated. | | | | For \"802.1Q C-TAG PCP/DEI type\", the packet filter component value | | field shall be encoded as one octet which specifies the 802.1Q C-TAG | | PCP and DEI. The bits 8 through 5 of the octet shall be spare, the | | bits 4 through 2 contain the PCP and bit 1 contains the DEI. If | | there are more than one C-TAG in the Ethernet frame header, the | | outermost C-TAG is evaluated. | | | | For \"802.1Q S-TAG PCP/DEI type\", the packet filter component value | | field shall be encoded as one octet which specifies the 802.1Q S-TAG | | PCP. The bits 8 through 5 of the octet shall be spare, the bits 4 | | through 2 contain the PCP and bit 1 contains the DEI. If there are | | more than one S-TAG in the Ethernet frame header, the outermost | | S-TAG is evaluated. | | | | For \"ethertype type\", the packet filter component value field | | shall be encoded as two octets which specify an ethertype. | | | | For \"destination MAC address range type\", the packet filter | | component value field shall be encoded as a sequence of a 6 octet | | destination MAC address range low limit field and a 6 octet | | destination MAC address range high limit field. The destination MAC | | address range low limit field shall be transmitted first. When the | | packet filter direction field indicates \"bidirectional\", the | | destination MAC address range is the remote MAC address range. | | | | For \"source MAC address range type\", the packet filter component | | value field shall be encoded as a sequence of a 6 octet source MAC | | address range low limit field and a 6 octet source MAC address range | | high limit field. The source MAC address range low limit field shall | | be transmitted first. When the packet filter direction field | | indicates \"bidirectional\", the source MAC address is the local MAC | | address range. | +----------------------------------------------------------------------+ | NOTE 1: Octet m+2 shall not be included without octet m+1. | | | | NOTE 2: The \"Match-all type\" packet filter component type | | identifier shall not be used with packet filter direction \"downlink | | only\". | +----------------------------------------------------------------------+
#### 9.11.4.14 Session-AMBR
The purpose of the Session-AMBR information element is to indicate the initial
subscribed PDU session aggregate maximum bit rate when the UE establishes a
PDU session or to indicate the new subscribed PDU session aggregate maximum
bit rate if it is changed by the network.
The Session-AMBR information element is coded as shown in figure 9.11.4.14.1
and table 9.11.4.14.1.
The Session-AMBR is a type 4 information element with a length of 8 octets.
* * *
8 7 6 5 4 3 2 1  
Session-AMBR IEI octet 1  
Length of Session-AMBR contents octet 2  
Unit for Session-AMBR for downlink octet 3  
Session-AMBR for downlink octet 4-5  
Unit for Session-AMBR for uplink octet 6  
Session-AMBR for uplink octet 7-8
* * *
Figure 9.11.4.14.1: Session-AMBR information element
Table 9.11.4.14.1: Session-AMBR information element
+----------------------------------------------------------------------+ | Unit for Session-AMBR for downlink (octet 3) | | | | 0 0 0 0 0 0 0 0 value is not used (see NOTE) | | | | 0 0 0 0 0 0 0 1 value is incremented in multiples of 1 Kbps | | | | 0 0 0 0 0 0 1 0 value is incremented in multiples of 4 Kbps | | | | 0 0 0 0 0 0 1 1 value is incremented in multiples of 16 Kbps | | | | 0 0 0 0 0 1 0 0 value is incremented in multiples of 64 Kbps | | | | 0 0 0 0 0 1 0 1 value is incremented in multiples of 256 kbps | | | | 0 0 0 0 0 1 1 0 value is incremented in multiples of 1 Mbps | | | | 0 0 0 0 0 1 1 1 value is incremented in multiples of 4 Mbps | | | | 0 0 0 0 1 0 0 0 value is incremented in multiples of 16 Mbps | | | | 0 0 0 0 1 0 0 1 value is incremented in multiples of 64 Mbps | | | | 0 0 0 0 1 0 1 0 value is incremented in multiples of 256 Mbps | | | | 0 0 0 0 1 0 1 1 value is incremented in multiples of 1 Gbps | | | | 0 0 0 0 1 1 0 0 value is incremented in multiples of 4 Gbps | | | | 0 0 0 0 1 1 0 1 value is incremented in multiples of 16 Gbps | | | | 0 0 0 0 1 1 1 0 value is incremented in multiples of 64 Gbps | | | | 0 0 0 0 1 1 1 1 value is incremented in multiples of 256 Gbps | | | | 0 0 0 1 0 0 0 0 value is incremented in multiples of 1 Tbps | | | | 0 0 0 1 0 0 0 1 value is incremented in multiples of 4 Tbps | | | | 0 0 0 1 0 0 1 0 value is incremented in multiples of 16 Tbps | | | | 0 0 0 1 0 0 1 1 value is incremented in multiples of 64 Tbps | | | | 0 0 0 1 0 1 0 0 value is incremented in multiples of 256 Tbps | | | | 0 0 0 1 0 1 0 1 value is incremented in multiples of 1 Pbps | | | | 0 0 0 1 0 1 1 0 value is incremented in multiples of 4 Pbps | | | | 0 0 0 1 0 1 1 1 value is incremented in multiples of 16 Pbps | | | | 0 0 0 1 1 0 0 0 value is incremented in multiples of 64 Pbps | | | | 0 0 0 1 1 0 0 1 value is incremented in multiples of 256 Pbps | | | | Other values shall be interpreted as multiples of 256 Pbps in this | | version of the protocol. | | | | Session-AMBR for downlink (octets 4 and 5) | | | | Octets 4 and 5 represent the binary coded value of PDU session | | aggregated maximum bit rate for downlink in units defined by octet | | 3. | | | | Unit for Session-AMBR for uplink (octet 6) | | | | The coding is identical to the unit coding defined for Session-AMBR | | for downlink (octet 3) | | | | Session-AMBR for uplink (octets 7 and 8) | | | | Octets 7 and 8 represent the binary coded value of PDU session | | aggregated maximum bit rate for uplink in units defined by octet 6. | +----------------------------------------------------------------------+ | NOTE: In this release of the specifications if received it shall be | | interpreted as value is incremented in multiples of 1 Kbps. In | | earlier releases of specifications, the interpretation of this value | | is up to implementation. | +----------------------------------------------------------------------+
#### 9.11.4.15 SM PDU DN request container
The purpose of the SM PDU DN request container information element is to carry
a DN-specific identity of the UE in the network access identifier (NAI)
format.
The SM PDU DN request container information element is coded as shown in
figure 9.11.4.15.1 and table 9.11.4.15.1.
The SM PDU DN request container is a type 4 information element with minimal
length of 3 octets and maximum length of 255 octets.
* * *
8 7 6 5 4 3 2 1  
SM PDU DN request container information IEI octet 1  
SM PDU DN request container information length octet 2  
DN-specific identity octets 3*-n*
* * *
Figure 9.11.4.15.1: SM PDU DN request container information element
Table 9.11.4.15.1: SM PDU DN request container information element
+----------------------------------------------------------------------+ | DN-specific identity (octet 3 to octet n) | | | | A DN-specific identity of the UE in the network access identifier | | (NAI) format according to IETF RFC 7542 [37], encoded as UTF-8 | | string. | +----------------------------------------------------------------------+
#### 9.11.4.16 SSC mode
The purpose of the SSC mode information element is to indicate SSC mode.
The SSC mode information element is coded as shown in figure 9.11.4.16.1 and
table 9.11.4.16.1.
The SSC mode is a type 1 information element.
+--------------+-------+----------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------+-------+----------------+---------+---+---+---+---+---+ | SSC mode IEI | 0 | SSC mode value | octet 1 | | | | | | | | | | | | | | | | | | Spare | | | | | | | | +--------------+-------+----------------+---------+---+---+---+---+---+
Figure 9.11.4.16.1: SSC mode information element
Table 9.11.4.16.1: SSC mode information element
SSC mode value (octet 1, bit 1 to bit 4)
* * *
Bits  
3 2 1  
0 0 1 SSC mode 1 0 1 0 SSC mode 2 0 1 1 SSC mode 3 1 0 0 unused; shall be
interpreted as \"SSC mode 1\", if received by the network 1 0 1 unused; shall
be interpreted as \"SSC mode 2\", if received by the network 1 1 0 unused;
shall be interpreted as \"SSC mode 3\", if received by the network
All other values are reserved.
#### 9.11.4.17 Re-attempt indicator
The purpose of the Re-attempt indicator information element is to indicate a
condition under which the UE is allowed in the current PLMN or its equivalent
PLMN(s) for the same DNN, to re-attempt a session management procedure (see
3GPP TS 24.301 [15]) corresponding to the 5GS session management procedure
which was rejected by the network.
The Re-attempt indicator information element is coded as shown in figure
9.11.4.17.1 and table 9.11.4.17.1.
The Re-attempt indicator is a type 4 information element with a length of 3
octets.
+-------+-------+-------+-------+-------+-------+-------+------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | Re-at | octet | | | | | | | | | tempt | 1 | | | | | | | | | indi | | | | | | | | | | cator | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | Re-at | | | | | | | | | | tempt | | | | | | | | | | indi | | | | | | | | | | cator | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | E | RATC | octet | | | | | | | | PLMNC | | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+
Figure 9.11.4.17.1: Re-attempt indicator
Table 9.11.4.17.1: Re-attempt indicator
RATC (octet 3, bit 1)
* * *
Bit  
1  
0 UE is allowed to re-attempt the procedure in S1 mode 1 UE is not allowed to
re-attempt the procedure in S1 mode
EPLMNC (octet 3, bit 2)  
Bit  
2  
0 UE is allowed to re-attempt the procedure in an equivalent PLMN 1 UE is not
allowed to re-attempt the procedure in an equivalent PLMN
Bits 3 to 8 of octet 3 are spare and shall be encoded as zero.
#### 9.11.4.18 5GSM network feature support
The purpose of the 5GSM network feature support information element is to
indicate whether certain session management related features are supported by
the network.
The 5GSM network feature support information element is coded as shown in
figure 9.11.4.18.1 and table 9.11.4.18.1.
The 5GSM network feature support is a type 4 information element with a
minimum length of 3 octets and a maximum length of 15 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5GSM | octet | | | | | | | | | ne | 1 | | | | | | | | | twork | | | | | | | | | | fe | | | | | | | | | | ature | | | | | | | | | | su | | | | | | | | | | pport | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | 5GSM | | | | | | | | | | ne | | | | | | | | | | twork | | | | | | | | | | fe | | | | | | | | | | ature | | | | | | | | | | su | | | | | | | | | | pport | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | E | octet | | | | | | | | | PT-S1 | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 4* | | | | | | | | | | -15* | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 9.11.4.18.1: 5GSM network feature support information element
Table 9.11.4.18.1: 5GSM network feature support information element
* * *
5GSM network feature support contents  
Ethernet PDN type in S1 mode (IEPT-S1) (octet 3, bit 1)  
This bit indicates network\'s capability for Ethernet PDN type in S1 mode.  
0 Ethernet PDN type in S1 mode not supported 1 Ethernet PDN type in S1 mode
supported
All other bits in octet 3 to 15 are spare and shall be coded as zero, if the
respective octet is included in the information element.
* * *
#### 9.11.4.19 Void
#### 9.11.4.20 Serving PLMN rate control
See subclause 9.9.4.28 in 3GPP TS 24.301 [15].
#### 9.11.4.21 5GSM congestion re-attempt indicator
The purpose of the 5GSM congestion re-attempt indicator information element is
to indicate whether the back-off timer is applied in the registered PLMN or
all PLMNs, and additionally to indicate whether the back-off timer is applied
in the current access type or both 3GPP access type and non-3GPP access type.
The 5GSM congestion re-attempt indicator information element is coded as shown
in figure 9.11.4.21.1 and table 9.11.4.21.1.
The 5GSM congestion re-attempt indicator is a type 4 information element with
a length of 3 octets.
+-------+-------+-------+-------+-------+-------+-------+-----+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+ | 5GSM | octet | | | | | | | | | conge | 1 | | | | | | | | | stion | | | | | | | | | | re-at | | | | | | | | | | tempt | | | | | | | | | | indi | | | | | | | | | | cator | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | 5GSM | | | | | | | | | | conge | | | | | | | | | | stion | | | | | | | | | | re-at | | | | | | | | | | tempt | | | | | | | | | | indi | | | | | | | | | | cator | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | CATBO | ABO | octet | | | | | | | | | | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+-------+-----+-------+
Figure 9.11.4.21.1: 5GSM congestion re-attempt indicator
Table 9.11.4.21.1: 5GSM congestion re-attempt indicator
+----------------------------------+----------------------------------+ | ABO (All PLMNs Back-off timer) | | | (octet 3, bit 1) | | +==================================+==================================+ | Bit | | +----------------------------------+----------------------------------+ | 1 | | +----------------------------------+----------------------------------+ | 0 | The back-off timer is applied in | | | the registered PLMN. | +----------------------------------+----------------------------------+ | 1 | The back-off timer is applied in | | | all PLMNs. | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | CATBO (Current Access Type | | | Back-off Timer) (octet 3, bit 2) | | | | | | Bit | | | | | | **2** | | +----------------------------------+----------------------------------+ | 0 | The back-off timer is applied in | | | both 3GPP access type and | | | non-3GPP access type | +----------------------------------+----------------------------------+ | 1 | The back-off timer is applied in | | | the current access type | +----------------------------------+----------------------------------+ | Bits 3 to 8 of octet 3 are spare | | | and shall be encoded as zero. | | +----------------------------------+----------------------------------+
#### 9.11.4.22 ATSSS container
The purpose of the ATSSS container information element is to transfer
parameters associated with ATSSS.
The ATSSS container information element is coded as shown in figure
9.11.4.22.1 and table 9.11.4.22.1.
The ATSSS container is a type 6 information element with a minimum length of 3
octets and a maximum length of 65538 octets.
+------------------------------------+------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +====================================+============+===+===+===+===+===+===+===+ | ATSSS container IEI | octet 1 | | | | | | | | +------------------------------------+------------+---+---+---+---+---+---+---+ | Length of ATSSS container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +------------------------------------+------------+---+---+---+---+---+---+---+ | ATSSS container contents | octet 4*\ | | | | | | | | | | \ | | | | | | | | | | octet x* | | | | | | | | +------------------------------------+------------+---+---+---+---+---+---+---+
Figure 9.11.4.22.1: ATSSS container information element
Table 9.11.4.22.1: ATSSS container information element
* * *
ATSSS container contents are defined in 3GPP TS 24.193 [13B].
* * *
#### 9.11.4.23 Control plane only indication
The purpose of the control plane only indication information element is to
indicate that a PDU session is only for control plane CIoT 5GS optimization.
The control plane only indication information element is coded as shown in
figure 9.11.4.23.1.
The control plane only indication is a type 1 information element.
+-----------------------------------+-------+-------+-------+------------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------------------------+-------+-------+-------+------------+---------+---+---+---+ | Control plane only indication IEI | 0 | 0 | 0 | CPOI value | octet 1 | | | | | | | | | | | | | | | | Spare | Spare | Spare | | | | | | +-----------------------------------+-------+-------+-------+------------+---------+---+---+---+
Figure 9.11.4.23.1: Control plane only indication information element
Table 9.11.4.23.1: Control plane only indication information element
Control plane only indication value (CPOI) (octet 1)
* * *
Bit  
1  
0 reserved 1 PDU session can be used for control plane CIoT 5GS optimization
only
The value 0 is reserved. If received, it shall be interpreted as if the
control plane only indication IE was not included in the message.  
Bits 4 to 2 of octet 1 are spare and shall be all encoded as zero.
#### 9.11.4.24 IP header compression configuration
The purpose of the IP header compression configuration information element is
to negotiate ROHC channel setup parameters specified in IETF RFC 5795 [39B]
and, optionally, provide additional header compression context setup
parameters.
The IP header compression configuration information element is coded as shown
in figure 9.11.4.24.1 and table 9.11.4.24.1.
The IP header compression configuration is a type 4 information element with a
minimum length of 5 octets and a maximum length of 257 octets.
The optional Additional IP header compression parameters container field
conveys the additional header compression context setup parameters as
specified in 3GPP TS 23.501 [8] in a generic container. This field corresponds
to the profile-specific information in the header of the ROHC IR packet type
in IETF RFC 5795 [39B].
* * *
8 7 6 5 4 3 2 1  
IP header compression configuration IEI octet 1  
Length of IP header compression configuration contents octet 2  
Spare P0x0104 P0x0103 P0x0102 P0x0006 P0x0004 P0x0003 P0x0002 octet 3 MAX_CID
octet 4  
octet 5  
Additional IP header compression context setup parameters type octet 6*  
Additional IP header compression context setup parameters container octet 7*
                                                                        octet n\*
* * *
Figure 9.11.4.24.1: IP header compression configuration information element
Table 9.11.4.24.1: IP header compression configuration information element
+----------------------------------------------------------------------+ | ROHC Profiles (octet 3) | | | | The ROHC Profiles shall indicate which of the ROHC profiles is | | supported. When a particular bit is set to 1, this indicates that | | the corresponding profile is supported. The No Compression profile | | 0x0000 (see IETF RFC 5795 [39B]) shall always be supported. When | | all the bits are set to 0, this indicates that only the No | | Compression profile 0x0000 is supported. | | | | Profile 0x0002 support indicator (see IETF RFC 3095 [33A] and | | IETF RFC 4815 [38A]) (octet 3 bit 1) | | | | 0 RoHC profile 0x0002 (UDP/IP) is not supported | | | | 1 RoHC profile 0x0002 (UDP/IP) is supported | | | | Profile 0x0003 support indicator (see IETF RFC 3095 [33A] and | | IETF RFC 4815 [38A]) (octet 3 bit 2) | | | | 0 RoHC profile 0x0003 (ESP/IP) is not supported | | | | 1 RoHC profile 0x0003 (ESP/IP) is supported | | | | Profile 0x0004 support indicator (see IETF RFC 3843 [34A] and | | IETF RFC 4815 [38A]) (octet 3 bit 3) | | | | 0 RoHC profile 0x0004 (IP) is not supported | | | | 1 RoHC profile 0x0004 (IP) is supported | | | | Profile 0x0006 support indicator (see IETF RFC 6846 [40B]) (octet | | 3 bit 4) | | | | 0 RoHC profile 0x0006 (TCP/IP) is not supported | | | | 1 RoHC profile 0x0006 (TCP/IP) is supported | | | | Profile 0x0102 support indicator (see IETF RFC 5225 [39A]) (octet | | 3 bit 5) | | | | 0 RoHC profile 0x0102 (UDP/IP) is not supported | | | | 1 RoHC profile 0x0102 (UDP/IP) is supported | | | | Profile 0x0103 support indicator (see IETF RFC 5225 [39A]) (octet | | 3 bit 6) | | | | 0 RoHC profile 0x0103 (ESP/IP) is not supported | | | | 1 RoHC profile 0x0103 (ESP/IP) is supported | | | | Profile 0x0104 support indicator (see IETF RFC 5225 [39A]) (octet | | 3 bit 7) | | | | 0 RoHC profile 0x0104 (IP) is not supported | | | | 1 RoHC profile 0x0104 (IP) is supported | | | | Bits 8 is spare and shall be set to 0. | | | | MAX_CID (octet 4 and octet 5) | | | | This is the MAX_CID value as specified in 3GPP TS 36.323 [25]. It | | is encoded in binary coding with a value in the range from 1 to | | 16383. | | | | Additional IP header compression context parameters type (octet 6). | | | | The Additional IP header compression context parameters type octet | | indicates the profile associated with the profile-specific | | information in the Additional IP header compression context | | parameters container. | | | | Bits | | | | **8 7 6 5 4 3 2 1** Type | | | | 0 0 0 0 0 0 0 0 0x0000 (No Compression) | | | | 0 0 0 0 0 0 0 1 0x0002 (UDP/IP) | | | | 0 0 0 0 0 0 1 0 0x0003 (ESP/IP) | | | | 0 0 0 0 0 0 1 1 0x0004 (IP) | | | | 0 0 0 0 0 1 0 0 0x0006 (TCP/IP) | | | | 0 0 0 0 0 1 0 1 0x0102 (UDP/IP) | | | | 0 0 0 0 0 1 1 0 0x0103 (ESP/IP) | | | | 0 0 0 0 0 1 1 1 0x0104 (IP) | | | | 0 0 0 0 1 0 0 0 Other | | | | 0 0 0 0 1 0 0 1 | | | | to | | | | 1 1 1 1 1 1 1 1 Spare | | | | Additional IP header compression context parameters container | | (octets 7 to n). | | | | Additional IP header compression context parameters container | | carries the profile-specific information (see | | IETF RFC 5795 [39B]). The maximum size is 251 octets. | | | | NOTE: If the Additional IP header compression context setup | | parameters container is included, then the Additional IP header | | compression context parameters type shall be included in the octet | | 6. | +----------------------------------------------------------------------+
#### 9.11.4.25 DS-TT Ethernet port MAC address
The purpose of the DS-TT Ethernet port MAC address information element is to
signal the MAC address of the DS-TT Ethernet port used for a PDU session of
\"Ethernet\" PDU session type.
The DS-TT Ethernet port MAC address information element is coded as shown in
figure 9.11.4.25.1 and table 9.11.4.25.1.
The DS-TT Ethernet port MAC address is a type 4 information element with a
length of 8 octets.
* * *
8 7 6 5 4 3 2 1  
DS-TT Ethernet port MAC address IEI octet 1  
Length of DS-TT Ethernet port MAC address contents octet 2  
octet 3  
DS-TT Ethernet port MAC address contents  
octet 8
* * *
Figure 9.11.4.25.1: DS-TT Ethernet port MAC address information element
Table 9.11.4.25.1: DS-TT Ethernet port MAC address information element
+----------------------------------------------------------------------+ | DS-TT Ethernet port MAC address contents (octets 3 to 8) | | | | The DS-TT Ethernet port MAC address contents consist of the binary | | representation of the MAC address of the DS-TT Ethernet port used | | for the PDU session, starting with the LSB bit of the first octet of | | the MAC address included in bit 1 of octet 3. | +----------------------------------------------------------------------+
#### 9.11.4.26 UE-DS-TT residence time
The purpose of the UE-DS-TT residence time information element is to signal
the time taken within the UE and DS-TT to forward a packet between the UE and
the DS-TT port.
The UE- DS-TT residence time information element is coded as shown in figure
9.11.4.26.1 and table 9.11.4.26.1.
The UE-DS-TT residence time is a type 4 information element with a length of
10 octets.
* * *
8 7 6 5 4 3 2 1  
UE-DS-TT residence time IEI octet 1  
Length of UE-DS-TT residence time contents octet 2  
octet 3  
UE-DS-TT residence time contents  
octet 10
* * *
Figure 9.11.4.26.1: UE-DS-TT residence time information element
Table 9.11.4.26.1: UE-DS-TT residence time information element
+----------------------------------------------------------------------+ | UE-DS-TT residence time contents (octets 3 to 10) | | | | The UE-DS-TT residence time contents contain the UE-DS-TT residence | | time encoded as specified for the correctionField in | | IEEE Std 1588-2019 [43B], with the LSB bit of the first octet of | | the UE-DS-TT residence time included in bit 1 of octet 3. If the | | UE-DS-TT residence time.is too big to be represented, all bits of | | octets 3 to 10 shall be coded as \"1\" except the MSB bit of octet | | 10. | +----------------------------------------------------------------------+
#### 9.11.4.27 Port management information container
The purpose of the Port management information container information element
is to transport a port management service message as specified in clause 8 of
3GPP TS 24.539 [19BA].
The Port management information container information element is coded as
shown in figure 9.11.4.27.1 and table 9.11.4.27.1.
The Port management information container is a type 6 information element with
a minimum length of 4 octets and a maximum length of 65538 octets.
+----------------------------------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Port management information container IEI | octet 1 | | | | | | | | +----------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Length of Port management information container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Port management information container | octet 4 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +----------------------------------------------------------+---------+---+---+---+---+---+---+---+
Figure 9.11.4.27.1: Port management information container information element
Table 9.11.4.27.1: Port management information container information element
* * *
Port management information container (octet 4 to n) A port management service
message as specified in clause 8 of 3GPP TS 24.539 [19BA].
* * *
#### 9.11.4.28 Ethernet header compression configuration
The purpose of the Ethernet header compression configuration information
element is to negotiate the use of EHC and the length of the CID field in the
EHC packet (see 3GPP TS 38.323 [29]).
The Ethernet header compression configuration information element is coded as
shown in figure 9.11.4.28.1 and table 9.11.4.28.1.
The Ethernet header compression configuration is a type 4 information element
with the length of 3 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Eth | octet | | | | | | | | | ernet | 1 | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | c | | | | | | | | | | ompre | | | | | | | | | | ssion | | | | | | | | | | con | | | | | | | | | | figur | | | | | | | | | | ation | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | L | oc | | | | | | | | | ength | tet 2 | | | | | | | | | of | | | | | | | | | | Eth | | | | | | | | | | ernet | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | c | | | | | | | | | | ompre | | | | | | | | | | ssion | | | | | | | | | | con | | | | | | | | | | figur | | | | | | | | | | ation | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | 0 | 0 | 0 | 0 | 0 | 0 | CID | oc | | | | | | | | | L | tet 3 | | | Spare | Spare | Spare | Spare | Spare | Spare | ength | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+
Figure 9.11.4.28.1: Ethernet header compression configuration information
element
Table 9.11.4.28.1: Ethernet header compression configuration information
element
+-----------------------------+-------+-----------------------------+ | Length of CID field value | | | | (CID Length) (octet 3 bits | | | | 1 and 2) | | | +-----------------------------+-------+-----------------------------+ | | | | +-----------------------------+-------+-----------------------------+ | Bit | | | +-----------------------------+-------+-----------------------------+ | 2 | **1** | | +-----------------------------+-------+-----------------------------+ | 0 | 0 | Ethernet header compression | | | | not used | +-----------------------------+-------+-----------------------------+ | 0 | 1 | 7 bits | +-----------------------------+-------+-----------------------------+ | 1 | 0 | 15 bits | +-----------------------------+-------+-----------------------------+ | | | | +-----------------------------+-------+-----------------------------+ | All other values shall be | | | | interpreted as \"7 bits\". | | | | | | | | Bits 3 to 8 of octet 3 are | | | | spare and shall be coded as | | | | zero. | | | +-----------------------------+-------+-----------------------------+
#### 9.11.4.29 Remote UE context list
The purpose of the Remote UE context list information element is to provide
identity and optionally IP address of a 5G ProSe remote UE connected to, or
disconnected from, a UE acting as a 5G ProSe layer-3 UE-to-network relay.
The Remote UE context list information element is coded as shown in figure
9.11.4.29.1, figure 9.11.4.29.2, table 9.11.4.29.1 and table 9.11.4.29.2.
The Remote UE context list is a type 6 information element with a minimum
length of 16 octets and a maximum length of 65538 octets.
+-------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Remote UE context list IEI | octet 1 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of remote UE context list contents | octet 2 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | | octet 3 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Number of remote UE contexts | octet 4 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Remote UE context 1 | octet 5 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | | | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | | octet a | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Remote UE context k | octet b+1* | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | | | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | | octet c* | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.29.1: Remote UE context list
Table 9.11.4.29.1: Remote UE context list
* * *
Remote UE context (octet 5 etc) The contents of remote UE context are
applicable for one individual UE and are coded as shown in figure 9.11.4.29.2
and table 9.11.4.29.2.
* * *
+--------+--------+--------+--------+--------+--------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +========+========+========+========+========+========+========+===+===+ | Length | octet | | | | | | | | | of | 5 | | | | | | | | | remote | | | | | | | | | | UE | | | | | | | | | | c | | | | | | | | | | ontext | | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | 0 | 0 | 0 | 0 | Remote | Remote | octet | | | | | | | | UE ID | UE ID | 6 | | | | Spare | Spare | Spare | Spare | format | type | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | Length | octet | | | | | | | | | of | 7 | | | | | | | | | remote | | | | | | | | | | UE ID | | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | Remote | octet | | | | | | | | | UE ID | 8 | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | | octet | | | | | | | | | | q | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | | Octet | | | | | | | | | | j* | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | Spare | UPRI4I | TPRI4I | Pr | octet | | | | | | | | | otocol | j+1* | | | | | | | | | used | | | | | | | | | | by | | | | | | | | | | remote | | | | | | | | | | UE | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | A | octet | | | | | | | | | ddress | j+2* | | | | | | | | | infor | | | | | | | | | | mation | octet | | | | | | | | | | j+k* | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+ | HPLMN | octet | | | | | | | | | ID | (j+ | | | | | | | | | | k+1)* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | (j+ | | | | | | | | | | k+3)* | | | | | | | | +--------+--------+--------+--------+--------+--------+--------+---+---+
Figure 9.11.4.29.2: Remote UE context
Table 9.11.4.29.2: Remote UE context list information element
+---------------+---+---------------+---------------+--------------+ | Remote UE ID | | | | | | type (bits 1 | | | | | | to 3 of octet | | | | | | 6) | | | | | +===============+===+===============+===============+==============+ | Bits | | | | | +---------------+---+---------------+---------------+--------------+ | 3 | 2 | 1 | | | +---------------+---+---------------+---------------+--------------+ | 0 | 0 | 1 | | UP-PRUK ID | +---------------+---+---------------+---------------+--------------+ | 0 | 1 | 0 | | CP-PRUK ID | +---------------+---+---------------+---------------+--------------+ | All other | | | | | | values are | | | | | | reserved. | | | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | Remote UE ID | | | | | | format (bit 4 | | | | | | of octet 6) | | | | | | (NOTE) | | | | | +---------------+---+---------------+---------------+--------------+ | Bit | | | | | +---------------+---+---------------+---------------+--------------+ | **4** | | | | | +---------------+---+---------------+---------------+--------------+ | 0 | | | Network | | | | | | access | | | | | | identifier | | | | | | (NAI) | | +---------------+---+---------------+---------------+--------------+ | 1 | | | 64-bit string | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | Bits 5 to 8 | | | | | | of octet 6 | | | | | | are spare and | | | | | | shall be | | | | | | coded as | | | | | | zero. | | | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | Remote UE ID | | | | | | (octet 8 to | | | | | | octet j) | | | | | +---------------+---+---------------+---------------+--------------+ | The UP-PRUK | | | | | | ID or the | | | | | | CP-PRUK ID of | | | | | | the 5G ProSe | | | | | | Remote UE. | | | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | Protocol used | | | | | | by remote UE | | | | | | (octet j+1, | | | | | | bits 1 to 3) | | | | | | | | | | | | Bits | | | | | +---------------+---+---------------+---------------+--------------+ | 3 | 2 | 1 | | | +---------------+---+---------------+---------------+--------------+ | 0 | 0 | 0 | | No IP info | +---------------+---+---------------+---------------+--------------+ | 0 | 0 | 1 | | IPv4 | +---------------+---+---------------+---------------+--------------+ | 0 | 1 | 0 | | IPv6 | +---------------+---+---------------+---------------+--------------+ | 1 | 0 | 0 | | Unstructured | +---------------+---+---------------+---------------+--------------+ | 1 | 0 | 1 | | Ethernet | +---------------+---+---------------+---------------+--------------+ | All other | | | | | | values are | | | | | | reserved. | | | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | TCP port | | | | | | range for | | | | | | IPv4 | | | | | | indicator | | | | | | (TPRI4I) | | | | | | (octet j+1, | | | | | | bits 4) | | | | | +---------------+---+---------------+---------------+--------------+ | Bit | | | | | +---------------+---+---------------+---------------+--------------+ | **4** | | | | | +---------------+---+---------------+---------------+--------------+ | 0 | | TCP port | | | | | | range for | | | | | | IPv4 absent | | | +---------------+---+---------------+---------------+--------------+ | 1 | | TCP port | | | | | | range for | | | | | | IPv4 present | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | UDP port | | | | | | range for | | | | | | IPv4 | | | | | | indicator | | | | | | (UPRI4I) | | | | | | (octet j+1, | | | | | | bits 5) | | | | | +---------------+---+---------------+---------------+--------------+ | Bit | | | | | +---------------+---+---------------+---------------+--------------+ | **5** | | | | | +---------------+---+---------------+---------------+--------------+ | 0 | | UDP port | | | | | | range for | | | | | | IPv4 absent | | | +---------------+---+---------------+---------------+--------------+ | 1 | | UDP port | | | | | | range for | | | | | | IPv4 present | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | Bits 4 to 8 | | | | | | of octet j+1 | | | | | | are spare and | | | | | | shall be | | | | | | coded as | | | | | | zero. | | | | | +---------------+---+---------------+---------------+--------------+ | | | | | | +---------------+---+---------------+---------------+--------------+ | If the | | | | | | Protocol used | | | | | | by remote UE | | | | | | indicates | | | | | | IPv4 and: | | | | | | | | | | | | - TPRI4I bit | | | | | | indicates | | | | | | \"TCP port | | | | | | range for | | | | | | IPv4 absent\" | | | | | | and UPRI4I | | | | | | bit indicates | | | | | | \"UDP port | | | | | | range for | | | | | | IPv4 | | | | | | absent\", the | | | | | | Address | | | | | | information | | | | | | in octet j+2 | | | | | | to octet j+5 | | | | | | contains the | | | | | | IPv4 address. | | | | | | | | | | | | - TPRI4I bit | | | | | | indicates | | | | | | \"TCP port | | | | | | range for | | | | | | IPv4 | | | | | | present\" and | | | | | | UPRI4I bit | | | | | | indicates | | | | | | \"UDP port | | | | | | range for | | | | | | IPv4 | | | | | | absent\", the | | | | | | Address | | | | | | information | | | | | | in octet j+2 | | | | | | to octet j+9 | | | | | | contains the | | | | | | IPv4 address | | | | | | followed by | | | | | | the TCP port | | | | | | range field. | | | | | | | | | | | | - TPRI4I bit | | | | | | indicates | | | | | | \"TCP port | | | | | | range for | | | | | | IPv4 absent\" | | | | | | and UPRI4I | | | | | | bit indicates | | | | | | \"UDP port | | | | | | range for | | | | | | IPv4 | | | | | | present\", | | | | | | the Address | | | | | | information | | | | | | in octet j+2 | | | | | | to octet j+9 | | | | | | contains the | | | | | | IPv4 address | | | | | | followed by | | | | | | the UDP port | | | | | | range field. | | | | | | | | | | | | - TPRI4I bit | | | | | | indicates | | | | | | \"TCP port | | | | | | range for | | | | | | IPv4 | | | | | | present\" and | | | | | | UPRI4I bit | | | | | | indicates | | | | | | \"UDP port | | | | | | range for | | | | | | IPv4 | | | | | | present\", | | | | | | the Address | | | | | | information | | | | | | in octet j+2 | | | | | | to octet j+13 | | | | | | contains the | | | | | | IPv4 address | | | | | | followed by | | | | | | the UDP port | | | | | | range field | | | | | | followed by | | | | | | the TCP port | | | | | | range field. | | | | | | | | | | | | See NOTE. | | | | | | | | | | | | The UDP port | | | | | | range field | | | | | | consists of | | | | | | the lowest | | | | | | UDP port | | | | | | number field | | | | | | followed by | | | | | | the highest | | | | | | UDP port | | | | | | number field, | | | | | | of the UDP | | | | | | port range | | | | | | assigned to | | | | | | the remote UE | | | | | | in the NAT | | | | | | function of | | | | | | 5G ProSe | | | | | | layer-3 | | | | | | UE-to-network | | | | | | relay. | | | | | | | | | | | | The TCP port | | | | | | range field | | | | | | consists of | | | | | | the lowest | | | | | | TCP port | | | | | | number field | | | | | | followed by | | | | | | highest TCP | | | | | | port number | | | | | | field, of the | | | | | | TCP port | | | | | | range | | | | | | assigned to | | | | | | the remote UE | | | | | | in the NAT | | | | | | function of | | | | | | 5G ProSe | | | | | | layer-3 | | | | | | UE-to-network | | | | | | relay. | | | | | | | | | | | | Each port | | | | | | number field | | | | | | is two octets | | | | | | long and bit | | | | | | 8 of first | | | | | | octet of the | | | | | | port number | | | | | | field | | | | | | represents | | | | | | the most | | | | | | significant | | | | | | bit of the | | | | | | port number | | | | | | and bit 1 of | | | | | | second octet | | | | | | of the port | | | | | | number field | | | | | | the least | | | | | | significant | | | | | | bit. | | | | | | | | | | | | If the | | | | | | Protocol used | | | | | | by remote UE | | | | | | indicates | | | | | | IPv6, the | | | | | | Address | | | | | | information | | | | | | in octet j+2 | | | | | | to octet j+9 | | | | | | contains the | | | | | | /64 IPv6 | | | | | | prefix of a | | | | | | remote UE. | | | | | | Bit 8 of | | | | | | octet j+2 | | | | | | represents | | | | | | the most | | | | | | significant | | | | | | bit of the | | | | | | /64 IPv6 | | | | | | prefix and | | | | | | bit 1 of | | | | | | octet j+9 the | | | | | | least | | | | | | significant | | | | | | bit. | | | | | | | | | | | | If the | | | | | | Protocol used | | | | | | by remote UE | | | | | | indicates | | | | | | Ethernet, the | | | | | | Address | | | | | | information | | | | | | in octet j+2 | | | | | | to octet j+7 | | | | | | contains the | | | | | | remote UE MAC | | | | | | address. Bit | | | | | | 8 of octet | | | | | | j+2 | | | | | | represents | | | | | | the most | | | | | | significant | | | | | | bit of the | | | | | | MAC address | | | | | | and bit 1 of | | | | | | octet j+7 the | | | | | | least | | | | | | significant | | | | | | bit. | | | | | | | | | | | | If the | | | | | | Protocol used | | | | | | by remote UE | | | | | | indicates | | | | | | Unstructured, | | | | | | the Address | | | | | | information | | | | | | octets are | | | | | | not included. | | | | | | | | | | | | If the | | | | | | Protocol used | | | | | | by remote UE | | | | | | indicates No | | | | | | IP info, the | | | | | | Address | | | | | | information | | | | | | octets are | | | | | | not included | | | | | +---------------+---+---------------+---------------+--------------+ | If the Remote | | | | | | UE ID type | | | | | | field | | | | | | indicates | | | | | | \"UP-PRUK | | | | | | ID\" and the | | | | | | Remote UE ID | | | | | | format field | | | | | | indicates | | | | | | \"64-bit | | | | | | string\", | | | | | | then the | | | | | | HPLMN ID | | | | | | field is | | | | | | present | | | | | | otherwise the | | | | | | HPLMN ID | | | | | | field is | | | | | | absent. The | | | | | | HPLMN ID | | | | | | field | | | | | | indicates | | | | | | HPLMN ID of | | | | | | the 5G ProSe | | | | | | remote UE and | | | | | | is coded as | | | | | | value part of | | | | | | the PLMN ID | | | | | | information | | | | | | element as | | | | | | specified in | | | | | | 3GPP TS 2 | | | | | | 4.554 [19E] | | | | | | subc | | | | | | lause 11.3.33 | | | | | | starting with | | | | | | the second | | | | | | octet. | | | | | +---------------+---+---------------+---------------+--------------+ | NOTE: In the | | | | | | present | | | | | | release of | | | | | | the | | | | | | s | | | | | | pecification, | | | | | | providing | | | | | | information | | | | | | for IP | | | | | | protocols | | | | | | other than | | | | | | UDP or TCP is | | | | | | not specified | | | | | +---------------+---+---------------+---------------+--------------+
#### 9.11.4.30 Requested MBS container
The purpose of the Requested MBS container information element is for UE to
request to join or leave one or more multicast MBS sessions.
The Requested MBS container information element is coded as shown in figure
9.11.4.30.1, figure 9.11.4.30.2, figure 9.11.4.30.3, figure 9.11.4.30.4 and
table 9.11.4.30.1.
The Requested MBS container is a type 6 information element with a minimum
length of 8 octets and a maximum length of 65538 octets.
+--------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +============================================+=============+===+===+===+===+===+===+===+ | Requested MBS container IEI | octet 1 | | | | | | | | +--------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of Requested MBS container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +--------------------------------------------+-------------+---+---+---+---+---+---+---+ | multicast MBS session information 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet i | | | | | | | | +--------------------------------------------+-------------+---+---+---+---+---+---+---+ | multicast MBS session information 2 | octet i+1* | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +--------------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +--------------------------------------------+-------------+---+---+---+---+---+---+---+ | multicast MBS session information p | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +--------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.30.1: Requested MBS container information element
+----------+---------+---+---+----------+----------+---------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +==========+=========+===+===+==========+==========+=========+===+===+ | 0 | 0 | 0 | 0 | MBS | Type of | octet 4 | | | | | | | | o | m | | | | | | | | | peration | ulticast | | | | | | | | | | MBS | | | | | | | | | | session | | | | | | | | | | ID | | | | +----------+---------+---+---+----------+----------+---------+---+---+ | spare | | | | | | | | | +----------+---------+---+---+----------+----------+---------+---+---+ | m | octet 5 | | | | | | | | | ulticast | | | | | | | | | | MBS | octet i | | | | | | | | | session | | | | | | | | | | ID | | | | | | | | | +----------+---------+---+---+----------+----------+---------+---+---+
Figure 9.11.4.30.2: multicast MBS session information
8 7 6 5 4 3 2 1
* * *
TMGI octet 5  
octet i
Figure 9.11.4.30.3: multicast MBS session ID for Type of multicast MBS session
ID = \"Temporary Mobile Group Identity (TMGI)\"
+------------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +====================================+===========+===+===+===+===+===+===+===+ | Source IP address information | octet 5 | | | | | | | | | | | | | | | | | | | | octet v | | | | | | | | +------------------------------------+-----------+---+---+---+---+---+---+---+ | Destination IP address information | Octet v+1 | | | | | | | | | | | | | | | | | | | | Octet i | | | | | | | | +------------------------------------+-----------+---+---+---+---+---+---+---+
Figure 9.11.4.30.4: multicast MBS session ID for Type of multicast MBS session
ID = \"Source specific IP multicast address for IPv4\" or \"Source specific IP
multicast address for IPv6\"
**Table 9.11.4.30.1: Requested MBS container information element**
Type of multicast MBS session ID (bits 1 to 2 of octet 4)
* * *
Bits  
**2** **1**  
0 1 Temporary Mobile Group Identity (TMGI) 1 0 Source specific IP multicast
address for IPv4 1 1 Source specific IP multicast address for IPv6 All other
values are reserved.
MBS operation (bits 3 to 4 of octet 4)  
Bits  
**4** **3**  
0 1 Join multicast MBS session 1 0 Leave multicast MBS session All other
values are reserved.
Bits 5 to 8 of octet 4 are spare and shall be coded as zero.
If Type of multicast MBS session ID is set to \"Temporary Mobile Group
Identity (TMGI)\", the multicast MBS session ID contains the TMGI (octet 5 to
i) and is coded as described in subclause 10.5.6.13 in 3GPP TS 24.008 [12]
starting from octet 2. The structure of the TMGI is defined in 3GPP TS 23.003
[4].
If Type of multicast MBS session ID is set to \"Source specific IP multicast
address for IPv4\" or \" Source specific IP multicast address for IPv6\", the
multicast MBS session ID contains the Source IP address information and the
Destination IP address information.
Source IP address information (octet 5 to v)  
This field contains the IP unicast address used as source address in IP
packets for identifying the source of the multicast service.
If the type of multicast MBS session ID indicates \"Source specific IP
multicast address for IPv4\", the Source IP address information in octet 5 to
octet 8 contains an IPv4 address. If the type of multicast MBS session ID
indicates \"Source specific IP multicast address for IPv6\", the Source IP
address information in octet 5 to octet 20 contains an IPv6 address.
Destination IP address information (octet v+1 to i)  
This field contains the IP multicast address used as destination address in
related IP packets for identifying a multicast service associated with the
source.
If the type of multicast MBS session ID indicates \"Source specific IP
multicast address for IPv4\", the Destination IP address information in octet
v+1 to octet v+4 contains an IPv4 address. If the type of multicast MBS
session ID indicates \"Source specific IP multicast address for IPv6\", the
Source IP address information in octet v+1 to octet v+16 contains an IPv6
address.
#### 9.11.4.31 Received MBS container
The purpose of the Received MBS container information element is to indicate
to the UE the information of the multicast MBS sessions that the network
accepts or rejects the UE to join, the information of the multicast MBS
sessions that the UE is removed from, or the information of the updated MBS
service area.
The Received MBS container information element is coded as shown in figure
9.11.4.31.1, figure 9.11.4.31.2, figure 9.11.4.31.3, figure 9.11.4.31.4,
figure 9.11.4.31.5, figure 9.11.4.31.6, figure 9.11.4.31.7, figure
9.11.4.31.8, figure 9.11.4.31.9, figure 9.11.4.31.10, figure 9.11.4.31.11 and
table 9.11.4.31.1.
The Received MBS container is a type 6 information element with a minimum
length of 9 octets and a maximum length of 65538 octets.
+-------------------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Received MBS container IEI | octet 1 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Length of Received MBS container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Received MBS information 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet i | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Received MBS information 2 | octet i+1* | | | | | | | | | | | | | | | | | | | | octet l* | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet l+1* | | | | | | | | | | | | | | | | | | | | octet m* | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+ | Received MBS information p | octet m+1* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +-------------------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.1: Received MBS container information element
+---------+---------+----+---------+------+-----+------+---------+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------+---------+----+---------+------+-----+------+---------+---+ | Re | MSAI | MD | octet 4 | | | | | | | jection | | | | | | | | | | cause | | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | 0 | 0 | 0 | IPAT | MSCI | MTI | IPAE | octet 5 | | +---------+---------+----+---------+------+-----+------+---------+---+ | spare | | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | TMGI | octet 6 | | | | | | | | | | | | | | | | | | | | octet j | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | Source | octet | | | | | | | | | IP | j+1* | | | | | | | | | address | | | | | | | | | | info | octet | | | | | | | | | rmation | v* | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | Dest | octet | | | | | | | | | ination | v+1* | | | | | | | | | IP | | | | | | | | | | address | octet | | | | | | | | | info | k* | | | | | | | | | rmation | | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | MBS | octet | | | | | | | | | service | k+1* | | | | | | | | | area | | | | | | | | | | | octet | | | | | | | | | | s* | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | MBS | octet | | | | | | | | | timers | s+1* | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | i* | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+ | MBS | octet | | | | | | | | | s | i+1* | | | | | | | | | ecurity | | | | | | | | | | co | octet | | | | | | | | | ntainer | e* | | | | | | | | +---------+---------+----+---------+------+-----+------+---------+---+
Figure 9.11.4.31.2: Received MBS information
+--------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------+-------------+---+---+---+---+---+---+---+ | MBS TAI list | octet k+1* | | | | | | | | | | | | | | | | | | | | octet i* | | | | | | | | +--------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.3: MBS service area for MBS service area indication = \"MBS
service area included as MBS TAI list\"
+-------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------+-------------+---+---+---+---+---+---+---+ | NR CGI list | octet k+1* | | | | | | | | | | | | | | | | | | | | octet i* | | | | | | | | +-------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.4: MBS service area for MBS service area indication = \"MBS
service area included as NR CGI list\"
+--------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------+-------------+---+---+---+---+---+---+---+ | MBS TAI list | octet k+1* | | | | | | | | | | | | | | | | | | | | octet y* | | | | | | | | +--------------+-------------+---+---+---+---+---+---+---+ | NR CGI list | octet y+1* | | | | | | | | | | | | | | | | | | | | octet i* | | | | | | | | +--------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.5: MBS service area for MBS service area indication = \"MBS
service area included as MBS TAI list and NR CGI list\"
+--------------------------------+--------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------+--------------+---+---+---+---+---+---+---+ | Length of NR CGI list contents | octet k+1* | | | | | | | | +--------------------------------+--------------+---+---+---+---+---+---+---+ | NR CGI 1 | octet k+2* | | | | | | | | | | | | | | | | | | | | octet k+9* | | | | | | | | +--------------------------------+--------------+---+---+---+---+---+---+---+ | NR CGI 2 | octet k+10* | | | | | | | | | | | | | | | | | | | | octet k+17* | | | | | | | | +--------------------------------+--------------+---+---+---+---+---+---+---+ | ... | octet k+18* | | | | | | | | | | | | | | | | | | | | octet c* | | | | | | | | +--------------------------------+--------------+---+---+---+---+---+---+---+ | NR CGI w | octet c+1* | | | | | | | | | | | | | | | | | | | | octet s* | | | | | | | | +--------------------------------+--------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.6: NR CGI list
* * *
8 7 6 5 4 3 2 1  
NR Cell ID octet k+1*  
octet k+5*  
MCC digit 2 MCC digit 1 octet k+6*  
MNC digit 3 MCC digit 3 octet k+7*  
MNC digit 2 MNC digit 1 octet k+8*
* * *
Figure 9.11.4.31.7: NR CGI
+----------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------+-------------+---+---+---+---+---+---+---+ | MBS start time | octet s+1* | | | | | | | | | | | | | | | | | | | | octet s+6* | | | | | | | | +----------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.8: MBS timers for MBS timer indication = \"MBS start time\"
* * *
8 7 6 5 4 3 2 1  
MBS back-off timer octet s+1*
* * *
Figure 9.11.4.31.9: MBS timers for MBS timer indication = \"MBS back-off
timer\"
+----------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------+-------------+---+---+---+---+---+---+---+ | Number of MBS security keys sets | octet i+1* | | | | | | | | +----------------------------------+-------------+---+---+---+---+---+---+---+ | MBS security keys set 1 | octet i+2* | | | | | | | | | | | | | | | | | | | | octet t* | | | | | | | | +----------------------------------+-------------+---+---+---+---+---+---+---+ | MBS security keys set 2 | octet t+1* | | | | | | | | | | | | | | | | | | | | octet g* | | | | | | | | +----------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet g+1* | | | | | | | | | | | | | | | | | | | | octet v* | | | | | | | | +----------------------------------+-------------+---+---+---+---+---+---+---+ | MBS security keys set q | octet v+1* | | | | | | | | | | | | | | | | | | | | octet e* | | | | | | | | +----------------------------------+-------------+---+---+---+---+---+---+---+
Figure 9.11.4.31.10: MBS security container
+---------------+--------------+-------------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------+--------------+-------------+---+---+---+---+---+---+ | 0 | MTKI | octet i+2* | | | | | | | | | | | | | | | | | | spare | | | | | | | | | +---------------+--------------+-------------+---+---+---+---+---+---+ | Key domain ID | octet i+3* | | | | | | | | | | | | | | | | | | | | octet i+5* | | | | | | | | +---------------+--------------+-------------+---+---+---+---+---+---+ | MSK ID | octet i+6* | | | | | | | | | | | | | | | | | | | | octet i+9* | | | | | | | | +---------------+--------------+-------------+---+---+---+---+---+---+ | MSK | octet i+10* | | | | | | | | | | | | | | | | | | | | octet i+25* | | | | | | | | +---------------+--------------+-------------+---+---+---+---+---+---+ | MTK ID | octet i+26* | | | | | | | | | | | | | | | | | | | | octet i+27* | | | | | | | | +---------------+--------------+-------------+---+---+---+---+---+---+ | Encrypted MTK | octet i+28* | | | | | | | | | | | | | | | | | | | | octet i+43* | | | | | | | | +---------------+--------------+-------------+---+---+---+---+---+---+
Figure 9.11.4.31.11: MBS security keys set
**Table 9.11.4.31.1: Received MBS container information element**
+-------------+-------------+-------------+-------------+-------------+ | MBS | | | | | | decision | | | | | | (MD) (bits | | | | | | 1 to 3 of | | | | | | octet 4) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MD | | | | | | indicates | | | | | | the network | | | | | | decision of | | | | | | the join | | | | | | requested | | | | | | by the UE, | | | | | | the network | | | | | | requests to | | | | | | remove the | | | | | | UE from the | | | | | | multicast | | | | | | MBS session | | | | | | or the | | | | | | network | | | | | | request to | | | | | | update the | | | | | | MBS service | | | | | | area or the | | | | | | security | | | | | | information | | | | | | of | | | | | | multicast | | | | | | MBS | | | | | | multicast | | | | | | session. | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bits | | | | | +-------------+-------------+-------------+-------------+-------------+ | **3** | **2** | **1** | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 0 | 1 | MBS service | | | | | | area update | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 1 | 0 | MBS join is | | | | | | accepted | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 1 | 1 | MBS join is | | | | | | rejected | | +-------------+-------------+-------------+-------------+-------------+ | 1 | 0 | 0 | Remove UE | | | | | | from | | | | | | multicast | | | | | | MBS session | | +-------------+-------------+-------------+-------------+-------------+ | 1 | 0 | 1 | MBS | | | | | | security | | | | | | information | | | | | | update | | +-------------+-------------+-------------+-------------+-------------+ | All other | | | | | | values are | | | | | | unused in | | | | | | this | | | | | | version of | | | | | | the | | | | | | sp | | | | | | ecification | | | | | | and | | | | | | interpreted | | | | | | as 000 if | | | | | | received. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | If MD is | | | | | | set to | | | | | | \"MBS join | | | | | | is | | | | | | rejected\" | | | | | | or "Remove | | | | | | UE from | | | | | | multicast | | | | | | MBS | | | | | | session", | | | | | | bits 6 to 8 | | | | | | of octet 4 | | | | | | shall | | | | | | contain the | | | | | | Rejection | | | | | | cause which | | | | | | indicates | | | | | | the reason | | | | | | of | | | | | | rejecting | | | | | | the MBS | | | | | | join | | | | | | request or | | | | | | the reason | | | | | | of removing | | | | | | the UE from | | | | | | multicast | | | | | | MBS | | | | | | session, | | | | | | re | | | | | | spectively, | | | | | | otherwise | | | | | | bits 6 to 8 | | | | | | of octet 4 | | | | | | are spare | | | | | | and shall | | | | | | be coded as | | | | | | zero. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS service | | | | | | area | | | | | | indication | | | | | | (MSAI) | | | | | | (bits 4 and | | | | | | 5 of octet | | | | | | 4) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MSAI | | | | | | indicates | | | | | | whether and | | | | | | how the MBS | | | | | | service | | | | | | area is | | | | | | included in | | | | | | the IE. | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bits | | | | | +-------------+-------------+-------------+-------------+-------------+ | **5** | **4** | | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 0 | MBS service | | | | | | area not | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 1 | MBS service | | | | | | area | | | | | | included as | | | | | | MBS TAI | | | | | | list | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | 0 | MBS service | | | | | | area | | | | | | included as | | | | | | NR CGI list | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | 1 | MBS service | | | | | | area | | | | | | included as | | | | | | MBS TAI | | | | | | list and NR | | | | | | CGI list | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | Rejection | | | | | | cause (bits | | | | | | 6 to 8 of | | | | | | octet 4) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The | | | | | | Rejection | | | | | | cause | | | | | | indicates | | | | | | the reason | | | | | | of | | | | | | rejecting | | | | | | the join | | | | | | request or | | | | | | the reason | | | | | | of removing | | | | | | the UE from | | | | | | the | | | | | | multicast | | | | | | MBS | | | | | | session. | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bits | | | | | +-------------+-------------+-------------+-------------+-------------+ | **8** | **7** | > **6** | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 0 | > 0 | | No | | | | | | additional | | | | | | information | | | | | | provided | +-------------+-------------+-------------+-------------+-------------+ | 0 | 0 | > 1 | | I | | | | | | nsufficient | | | | | | resources | +-------------+-------------+-------------+-------------+-------------+ | 0 | 1 | > 0 | | User is not | | | | | | authorized | | | | | | to use MBS | | | | | | service | +-------------+-------------+-------------+-------------+-------------+ | 0 | 1 | > 1 | | multicast | | | | | | MBS session | | | | | | has not | | | | | | started or | | | | | | will not | | | | | | start soon | +-------------+-------------+-------------+-------------+-------------+ | 1 | 0 | > 0 | | User is | | | | | | outside of | | | | | | local MBS | | | | | | service | | | | | | area | +-------------+-------------+-------------+-------------+-------------+ | 1 | 0 | > 1 | | Session | | | | | | context not | | | | | | found | +-------------+-------------+-------------+-------------+-------------+ | 1 | 1 | > 0 | | multicast | | | | | | MBS session | | | | | | is released | +-------------+-------------+-------------+-------------+-------------+ | All other | | | | | | values are | | | | | | unused in | | | | | | this | | | | | | version of | | | | | | the | | | | | | sp | | | | | | ecification | | | | | | and | | | | | | interpreted | | | | | | as 000 if | | | | | | received. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | IP address | | | | | | existence | | | | | | (IPAE) | | | | | | (bit1 of | | | | | | octet 5) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The IPAE | | | | | | indicates | | | | | | whether the | | | | | | Source IP | | | | | | address | | | | | | information | | | | | | and | | | | | | Destination | | | | | | IP address | | | | | | information | | | | | | are | | | | | | included in | | | | | | the IE or | | | | | | not. | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bit | | | | | +-------------+-------------+-------------+-------------+-------------+ | **1** | | | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | | Source and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | not | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | | Source and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | If IPAE is | | | | | | set to | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | included\", | | | | | | Source IP | | | | | | address | | | | | | information | | | | | | and | | | | | | Destination | | | | | | IP address | | | | | | information | | | | | | shall be | | | | | | included in | | | | | | the IE, | | | | | | otherwise | | | | | | Source IP | | | | | | address | | | | | | information | | | | | | and | | | | | | Destination | | | | | | IP address | | | | | | information | | | | | | shall not | | | | | | be included | | | | | | in the IE. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS timer | | | | | | indication | | | | | | (MTI) (bits | | | | | | 2 and 3 of | | | | | | octet 5) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MTI | | | | | | indicates | | | | | | whether | | | | | | there is | | | | | | MBS timer | | | | | | included in | | | | | | the IE or | | | | | | not. | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bit | | | | | +-------------+-------------+-------------+-------------+-------------+ | **3** | **2** | | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 0 | No MBS | | | | | | timers | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | 1 | MBS start | | | | | | time | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | 0 | MBS | | | | | | back-off | | | | | | timer | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | All other | | | | | | values are | | | | | | unused in | | | | | | this | | | | | | version of | | | | | | the | | | | | | sp | | | | | | ecification | | | | | | and | | | | | | interpreted | | | | | | as 00 if | | | | | | received | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS | | | | | | security | | | | | | container | | | | | | indication | | | | | | (MSCI) (bit | | | | | | 4 of octet | | | | | | 5) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MSCI | | | | | | indicates | | | | | | whether the | | | | | | MBS | | | | | | security | | | | | | container | | | | | | is included | | | | | | in the IE | | | | | | or not | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bit | | | | | +-------------+-------------+-------------+-------------+-------------+ | **4** | | | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | MBS | | | | | | security | | | | | | container | | | | | | not | | | | | | included | | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | MBS | | | | | | security | | | | | | container | | | | | | included | | | | +-------------+-------------+-------------+-------------+-------------+ | IP address | | | | | | type (IPAT) | | | | | | (bit 5 of | | | | | | octet 5) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The IPAT | | | | | | indicates | | | | | | the type of | | | | | | the source | | | | | | IP address | | | | | | information | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | i | | | | | | nformation. | | | | | | This field | | | | | | is ignored | | | | | | when IPAE | | | | | | is set to | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | not | | | | | | included\". | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bit | | | | | +-------------+-------------+-------------+-------------+-------------+ | **5** | | | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | Source IP | | | | | | address | | | | | | information | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | are IPv4 | | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | Source IP | | | | | | address | | | | | | information | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | are IPv6 | | | | +-------------+-------------+-------------+-------------+-------------+ | Bits 6 to 8 | | | | | | of octet 5 | | | | | | are spare | | | | | | and shall | | | | | | be coded as | | | | | | zero. | | | | | +-------------+-------------+-------------+-------------+-------------+ | TMGI | | | | | | (octets 6 | | | | | | to j) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The TMGI is | | | | | | coded as | | | | | | described | | | | | | in | | | | | | subclaus | | | | | | e 10.5.6.13 | | | | | | in | | | | | | 3GPP TS 24 | | | | | | .008 [12] | | | | | | starting | | | | | | from octet | | | | | | 2. The | | | | | | structure | | | | | | of the TMGI | | | | | | is defined | | | | | | in | | | | | | 3GPP TS 23 | | | | | | .003 [4]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | Source IP | | | | | | address | | | | | | information | | | | | | (octet j+1 | | | | | | to v) | | | | | +-------------+-------------+-------------+-------------+-------------+ | This field | | | | | | contains | | | | | | the IP | | | | | | unicast | | | | | | address | | | | | | used as | | | | | | source | | | | | | address in | | | | | | IP packets | | | | | | for | | | | | | identifying | | | | | | the source | | | | | | of the | | | | | | multicast | | | | | | service. | | | | | | The value | | | | | | of this | | | | | | field is | | | | | | copied from | | | | | | the | | | | | | co | | | | | | rresponding | | | | | | source IP | | | | | | address | | | | | | information | | | | | | in the | | | | | | requested | | | | | | MBS | | | | | | container. | | | | | | If the IPAT | | | | | | indicates | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | are IPv4\", | | | | | | the Source | | | | | | IP address | | | | | | information | | | | | | in octet | | | | | | j+1 to | | | | | | octet j+4 | | | | | | contains an | | | | | | IPv4 | | | | | | address. If | | | | | | the IPAT | | | | | | indicates | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | are IPv6\", | | | | | | the Source | | | | | | IP address | | | | | | information | | | | | | in octet | | | | | | j+1 to | | | | | | octet j+16 | | | | | | contains an | | | | | | IPv6 | | | | | | address. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | Destination | | | | | | IP address | | | | | | information | | | | | | (octet v+1 | | | | | | to k) | | | | | +-------------+-------------+-------------+-------------+-------------+ | This field | | | | | | contains | | | | | | the IP | | | | | | multicast | | | | | | address | | | | | | used as | | | | | | destination | | | | | | address in | | | | | | related IP | | | | | | packets for | | | | | | identifying | | | | | | a multicast | | | | | | service | | | | | | associated | | | | | | with the | | | | | | source. The | | | | | | value of | | | | | | this field | | | | | | is copied | | | | | | from the | | | | | | co | | | | | | rresponding | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | in the | | | | | | requested | | | | | | MBS | | | | | | container. | | | | | | If the IPAT | | | | | | indicates | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | are IPv4\", | | | | | | the | | | | | | Destination | | | | | | IP address | | | | | | information | | | | | | in octet | | | | | | v+1 to | | | | | | octet v+4 | | | | | | contains an | | | | | | IPv4 | | | | | | address. If | | | | | | the IPAT | | | | | | indicates | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | are IPv6\", | | | | | | the | | | | | | Destination | | | | | | IP address | | | | | | information | | | | | | in octet | | | | | | v+1 to | | | | | | octet v+16 | | | | | | contains an | | | | | | IPv6 | | | | | | address. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS service | | | | | | area (octet | | | | | | k+1 to s) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MBS | | | | | | service | | | | | | area | | | | | | contains | | | | | | the MBS TAI | | | | | | list, the | | | | | | NR CGI list | | | | | | or both, | | | | | | that | | | | | | identifies | | | | | | the service | | | | | | area(s) for | | | | | | a local MBS | | | | | | service. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS TAI | | | | | | list (octet | | | | | | k+1 to s) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MBS TAI | | | | | | list is | | | | | | coded as | | | | | | octet 2 and | | | | | | above of | | | | | | the 5GS | | | | | | tracking | | | | | | area | | | | | | identity | | | | | | list IE | | | | | | defined in | | | | | | subclaus | | | | | | e 9.11.3.9. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | NR CGI | | | | | | (octet k+2 | | | | | | to k+9) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The NR CGI | | | | | | globally | | | | | | identifies | | | | | | an NR cell. | | | | | | It contains | | | | | | the NR Cell | | | | | | ID and the | | | | | | PLMN ID of | | | | | | that cell. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | NR Cell ID | | | | | | (octet k+2 | | | | | | to k+6) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The NR Cell | | | | | | ID consists | | | | | | of 36 bits | | | | | | identifying | | | | | | an NR Cell | | | | | | ID as | | | | | | specified | | | | | | in | | | | | | subcla | | | | | | use 9.3.1.7 | | | | | | of | | | | | | 3GPP TS 38. | | | | | | 413 [31], | | | | | | in | | | | | | hexadecimal | | | | | | repr | | | | | | esentation. | | | | | | Bit 8 of | | | | | | octet y+1 | | | | | | is the most | | | | | | significant | | | | | | bit and bit | | | | | | 5 of octet | | | | | | y+5 is the | | | | | | least | | | | | | significant | | | | | | bit. Bits 1 | | | | | | to 4 of | | | | | | octet y+5 | | | | | | are spare | | | | | | and shall | | | | | | be coded as | | | | | | zero. | | | | | +-------------+-------------+-------------+-------------+-------------+ | MCC, Mobile | | | | | | country | | | | | | code (octet | | | | | | k+6 and | | | | | | bits 1 to 4 | | | | | | octet k+7) | | | | | | | | | | | | The MCC | | | | | | field is | | | | | | coded as in | | | | | | ITU-T R | | | | | | ecommendati | | | | | | on E.212 [ | | | | | | 42], annex | | | | | | A. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MNC, Mobile | | | | | | network | | | | | | code (bits | | | | | | 5 to 8 of | | | | | | octet k+7 | | | | | | and octet | | | | | | k+8) | | | | | | | | | | | | The coding | | | | | | of this | | | | | | field is | | | | | | the | | | | | | res | | | | | | ponsibility | | | | | | of each | | | | | | adm | | | | | | inistration | | | | | | but BCD | | | | | | coding | | | | | | shall be | | | | | | used. The | | | | | | MNC shall | | | | | | consist of | | | | | | 2 or 3 | | | | | | digits. If | | | | | | a network | | | | | | operator | | | | | | decides to | | | | | | use only | | | | | | two digits | | | | | | in the MNC, | | | | | | bits 5 to 8 | | | | | | of octet | | | | | | k+7 shall | | | | | | be coded as | | | | | | \"1111\". | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MCC and | | | | | | MNC digits | | | | | | are coded | | | | | | as octets 6 | | | | | | to 8 of the | | | | | | Temporary | | | | | | mobile | | | | | | group | | | | | | identity IE | | | | | | in | | | | | | figu | | | | | | re 10.5.154 | | | | | | of | | | | | | 3GPP TS 24. | | | | | | 008 [12]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS start | | | | | | time | | | | | | (octets s+1 | | | | | | to s+6) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MBS | | | | | | start time | | | | | | is coded as | | | | | | described | | | | | | in | | | | | | subclau | | | | | | se 10.5.3.9 | | | | | | in | | | | | | 3GPP TS 24 | | | | | | .008 [12] | | | | | | starting | | | | | | from octet | | | | | | 2 till | | | | | | octet 7. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS | | | | | | back-off | | | | | | timer | | | | | | (octet s+1) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MBS | | | | | | back-off | | | | | | timer is | | | | | | coded as | | | | | | octet 3 | | | | | | described | | | | | | in | | | | | | subclaus | | | | | | e 10.5.7.4a | | | | | | in | | | | | | 3GPP TS 24. | | | | | | 008 [12]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MTK | | | | | | indication | | | | | | (MTKI) | | | | | | (bit1 of | | | | | | octet i+2) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MTKI | | | | | | indicates | | | | | | whether the | | | | | | MTK ID and | | | | | | Encrypted | | | | | | MTK are | | | | | | included in | | | | | | the MBS | | | | | | security | | | | | | keys set or | | | | | | not. | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bit | | | | | +-------------+-------------+-------------+-------------+-------------+ | **1** | | | | | +-------------+-------------+-------------+-------------+-------------+ | 0 | | MTK ID and | | | | | | Encrypted | | | | | | MTK not | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | 1 | | MTK ID and | | | | | | Encrypted | | | | | | MTK | | | | | | included | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | Bits 2 to 8 | | | | | | of octet | | | | | | i+2 are | | | | | | spare and | | | | | | shall be | | | | | | coded as | | | | | | zero | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | Key domain | | | | | | ID (octet | | | | | | i+3 to i+5) | | | | | | | | | | | | The key | | | | | | domain ID | | | | | | is 3 bytes | | | | | | long and is | | | | | | defined in | | | | | | 3GPP TS 33. | | | | | | 246 [57]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS Service | | | | | | Key | | | | | | Identifier | | | | | | (MSK ID) | | | | | | (octets i+6 | | | | | | to i+9) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MSK ID | | | | | | is 4 bytes | | | | | | long and is | | | | | | defined in | | | | | | 3GPP TS 33. | | | | | | 246 [57]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS Service | | | | | | Key (MSK) | | | | | | (octets | | | | | | i+10 to | | | | | | i+25) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MSK is | | | | | | 16 bytes | | | | | | long and is | | | | | | defined in | | | | | | 3GPP TS 33. | | | | | | 246 [57]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | MBS Traffic | | | | | | Key | | | | | | Identifier | | | | | | (MTK ID) | | | | | | (octets | | | | | | i+26 to | | | | | | i+27) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The MTK ID | | | | | | is 2 bytes | | | | | | long and is | | | | | | defined in | | | | | | 3GPP TS 33. | | | | | | 246 [57]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | Encrypted | | | | | | MBS Traffic | | | | | | Key | | | | | | (Encrypted | | | | | | MTK) | | | | | | (octets | | | | | | i+28 to | | | | | | i+43) | | | | | +-------------+-------------+-------------+-------------+-------------+ | The | | | | | | Encrypted | | | | | | MTK is 16 | | | | | | bytes long | | | | | | and | | | | | | contains | | | | | | the | | | | | | encrypted | | | | | | version of | | | | | | MTK using | | | | | | MSK as | | | | | | defined in | | | | | | 3GPP TS 33. | | | | | | 246 [57]. | | | | | +-------------+-------------+-------------+-------------+-------------+ | | | | | | +-------------+-------------+-------------+-------------+-------------+ | NOTE: The | | | | | | IPAE bit is | | | | | | not | | | | | | expected to | | | | | | be set to | | | | | | \"Source | | | | | | and | | | | | | destination | | | | | | IP address | | | | | | information | | | | | | included\" | | | | | | when the | | | | | | MBS | | | | | | decision | | | | | | (MD) | | | | | | indicates | | | | | | \"Remove UE | | | | | | from | | | | | | multicast | | | | | | MBS | | | | | | session\". | | | | | +-------------+-------------+-------------+-------------+-------------+
#### 9.11.4.32 PDU session pair ID
The purpose of the PDU session pair ID information element is to indicate a
PDU session pair ID.
The PDU session pair ID information element is coded as shown in figure
9.11.4.32.1 and table 9.11.4.32.1.
The PDU session pair ID is a type 4 information element with a length of 3
octets.
* * *
8 7 6 5 4 3 2 1  
PDU session pair ID IEI octet 1  
Length of PDU session pair ID IE octet 2  
PDU session pair ID octet 3
* * *
Figure 9.11.4.32.1: PDU session pair ID information element
Table 9.11.4.32.1: PDU session pair ID information element
* * *
PDU session pair ID (octet 3)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 PDU session pair ID 0 to to  
0 0 0 0 0 1 1 0 PDU session pair ID 6
All other values are reserved.
* * *
#### 9.11.4.33 RSN
The purpose of the RSN information element is to indicate an RSN.
The RSN information element is coded as shown in figure 9.11.4.33.1 and table
9.11.4.33.1.
The RSN is a type 4 information element with a length of 3 octets.
* * *
8 7 6 5 4 3 2 1  
RSN IEI octet 1  
Length of RSN IE octet 2  
RSN octet 3
* * *
Figure 9.11.4.33.1: RSN information element
Table 9.11.4.33.1: RSN information element
* * *
RSN (octet 3)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 v1 0 0 0 0 0 0 0 1 v2
All other values are spare and shall not be used by a UE compliant to the
present version of this specification.
* * *
#### 9.11.4.34 ECS address
The purpose of the ECS address information element is to indicate the ECS
address (either IPv4 address, IPv6 address, or FQDN) and the associated
spatial validity condition.
The ECS address information element is coded as shown in figure 9.11.4.34-1,
figure 9.11.4.34-2, table 9.11.4.34-1, and table 9.11.4.34-2.
The ECS address information element is a type 6 information element with
minimum length of 8 octets and a maximum length of 65538 octets.
+---------------+---------------+---------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------+---------------+---------+---+---+---+---+---+---+ | ECS address | octet 1 | | | | | | | | | IEI | | | | | | | | | +---------------+---------------+---------+---+---+---+---+---+---+ | Length of ECS | octet 2 | | | | | | | | | address | | | | | | | | | | contents | octet 3 | | | | | | | | +---------------+---------------+---------+---+---+---+---+---+---+ | Type of ECS | Type of | octet 4 | | | | | | | | address | spatial | | | | | | | | | | validity | | | | | | | | | | condition | | | | | | | | +---------------+---------------+---------+---+---+---+---+---+---+ | ECS address | octet 5 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +---------------+---------------+---------+---+---+---+---+---+---+ | Spatial | octet (a+1)* | | | | | | | | | validity | | | | | | | | | | condition | octet n* | | | | | | | | | contents | | | | | | | | | +---------------+---------------+---------+---+---+---+---+---+---+
Figure 9.11.4.34-1: ECS address information element
+-----------------------------------------------+---------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +===============================================+===============+===+===+===+===+===+===+===+ | Length of spatial validity condition contents | octet (a+1) | | | | | | | | | | | | | | | | | | | | octet (a+2) | | | | | | | | +-----------------------------------------------+---------------+---+---+---+---+---+---+---+ | Spatial validity information 1 | octet b | | | | | | | | | | | | | | | | | | | | octet c | | | | | | | | +-----------------------------------------------+---------------+---+---+---+---+---+---+---+ | Spatial validity information 2 | octet (c+1)* | | | | | | | | | | | | | | | | | | | | octet d* | | | | | | | | +-----------------------------------------------+---------------+---+---+---+---+---+---+---+ | ... | octet (d+1)* | | | | | | | | | | | | | | | | | | | | octet e* | | | | | | | | +-----------------------------------------------+---------------+---+---+---+---+---+---+---+ | Spatial validity information N | octet (e+1)* | | | | | | | | | | | | | | | | | | | | octet n* | | | | | | | | +-----------------------------------------------+---------------+---+---+---+---+---+---+---+
Figure 9.11.4.34-2: Spatial validity condition contents
Table 9.11.4.34-1: ECS address information element
* * *
Type of ECS address (octet 4, bit 1 to 4)  
Bits  
4 3 2 1  
0 0 0 0 IPv4 0 0 0 1 IPv6 0 0 1 0 FQDN 1 1 1 1 Unspecified
All other values are spare. The receiving entity shall ignore an ECS address
IE with type of ECS address containing a spare value.
Type of spatial validity condition (octet 4, bit 5 to 8)  
Bits  
8 7 6 5  
0 0 0 0 No spatial validity condition 0 0 0 1 Geographical service area 0 0 1
0 Tracking area 0 0 1 1 Country-wide
All other values are spare. The receiving entity shall ignore a spatial
validity condition with type of spatial validity condition containing an
unknown value.
If the type of ECS address indicates IPv4, then the ECS address field contains
an IPv4 address in octet 5 to octet 8.
If the type of ECS address indicates IPv6, then the ECS address field contains
an IPv6 address in octet 5 to octet 20 and is encoded according to IETF RFC
4291 [RFC4291].
If the type of ECS address indicates FQDN, then the ECS address field contains
in octet 5 the length of FQDN value and in octet 6 to octet a an FQDN value
encoded as defined in subclause 19.4.2 in 3GPP TS 23.003 [4].
If the type of ECS address indicates unspecified, then the remaining fields of
ECS address information element shall be passed to the upper layers.
Spatial validity condition contents (octet (a+1)* to n*)  
The spatial validity condition contents contain a variable number of spatial
validity condition information.
* * *
Table 9.11.4.34-2: Spatial validity condition contents
* * *
If the type of spatial validity condition of the ECS address indicates No
spatial validity condition, then the spatial validity condition information
field is empty. If the type of spatial validity condition of the ECS address
indicates geographical service area, then the spatial validity condition
information field contains a geographical service area which is specified by
geographical descriptions as defined in 3GPP TS 23.032 [4B]. If the type of
spatial validity condition of the ECS address indicates tracking area, then
the spatial validity condition information field contains a TAI as defined in
subclause 9.11.3.8 starting from octet 2. If the type of spatial validity
condition of the ECS address indicates country-wide, then the spatial validity
condition information field contains an MCC as defined in in ITU-T
Recommendation E.212 [42], annex A. The first MCC digit is coded in bit 1 to 4
of the octet b, the second MCC digit is coded in bit 5 to 8 of the octet b,
and the third MCC digit is coded in bit 1 to 4 of the octet b+1. Bit 5 to bit
8 of the octet b+1 shall be padded with 1. If only two digits are used for for
MCC, octet b+1 shall be padded with 1.
* * *
#### 9.11.4.35 Void
## 9.12 3GPP specific coding information defined within present document
### 9.12.1 Serving network name (SNN)
The serving network name (SNN) is used:
\- in the Network name field of the AT_KDF_INPUT attribute defined in _IETF
RFC 5448_ [40];
\- in K~AUSF~ derivation function as specified in 3GPP TS 33.501 [24] annex A;
and
\- in RES* and XRES* derivation function as specified in 3GPP TS 33.501 [24]
annex A.
SNN shall contain a UTF-8 string without terminating null characters.
SNN is of maximum length of 1020 octets.
SNN consists of SNN-service-code and SNN-network-identifier, delimited by a
colon.
SNN-network-identifier identifies the serving PLMN or the serving SNPN.
MCC and MNC in the SNN-PLMN-ID are MCC and MNC of the serving PLMN. If the MNC
of the serving PLMN has two digits, then a zero is added at the beginning.
MCC and MNC in the SNN-SNPN-ID are MCC and MNC of the serving SNPN. If the MNC
of the serving SNPN has two digits, then a zero is added at the beginning.
SNN-NID contains an NID in hexadecimal digits.
ABNF syntax of SNN is specified in table 9.12.1.1
Table 9.12.1.1: ABNF syntax of SNN
SNN = SNN-service-code \":\" SNN-network-identifier
SNN-service-code = %x35.47 ; \"5G\"
SNN-network-identifier = SNN-PLMN-ID / SNN-SNPN-ID
SNN-PLMN-ID = SNN-mnc-string SNN-mnc-digits \".\" SNN-mcc-string SNN-mcc-
digits \".\" SNN-3gppnetwork-string \".\" SNN-org-string ; applicable when not
operating in SNPN access operation mode.
SNN-SNPN-ID = SNN-mnc-string SNN-mnc-digits \".\" SNN-mcc-string SNN-mcc-
digits \".\" SNN-3gppnetwork-string \".\" SNN-org-string \":\" SNN-NID ;
applicable when operating in SNPN access operation mode.
SNN-mnc-digits = DIGIT DIGIT DIGIT ; MNC of the PLMN ID
SNN-mcc-digits = DIGIT DIGIT DIGIT ; MCC of the PLMN ID
SNN-mnc-string = %x6d.6e.63 ; \"mnc\" in lower case
SNN-mcc-string = %x6d.63.63 ; \"mcc\" in lower case
SNN-3gppnetwork-string = %x33.67.70.70.6e.65.74.77.6f.72.6b ; \"3gppnetwork\"
in lower case
SNN-org-string = %x6f.72.67 ; \"org\" in lower case
SNN-NID = 11SNN-hexadecimal-digit ; NID in hexadecimal digits
SNN-hexadecimal-digit = DIGIT / %x41 / %x42 / %x43 / %x44 / %x45 / %x46
NOTE: SNN-service-code allows for distinguishing of ANID specified in 3GPP TS
24.302 [16] and SNN as either of SNN or ANID can be carried in the
AT_KDF_INPUT attribute.
EXAMPLE 1: In case of a PLMN, if PLMN ID contains MCC = 234 and MNC = 15, SNN
is 5G:mnc015.mcc234.3gppnetwork.org.
EXAMPLE 2: In case of an SNPN, if SNPN ID contains a PLMN ID of MCC = 234 and
MNC = 15 and an NID of 123456ABCDEH, SNN is
5G:mnc015.mcc234.3gppnetwork.org:123456ABCDE.
# 10 List of system parameters
## 10.1 General
The description of timers in the following tables should be considered a brief
summary. The precise details are found in clauses 4 to 6, which should be
considered the definitive descriptions.
## 10.2 Timers of 5GS mobility management
Timers of 5GS mobility management are shown in table 10.2.1 and table 10.2.2.
NOTE: Timers T3324, T3346, T3245 and T3247 are defined in 3GPP TS 24.008 [12].
Timers T3444, T3445, T3447 and T3448 are defined in 3GPP TS 24.301 [15].
Table 10.2.1: Timers of 5GS mobility management -- UE side
+----------+----------+----------+----------+----------+----------+ | TIMER | TIMER | STATE | CAUSE OF | NORMAL | ON\ | | NUM. | VALUE | | START | STOP | EXPIRY | +----------+----------+----------+----------+----------+----------+ | T3502 | Default | 5 | At | Tran | In | | | 12 min. | GMM-DERE | regi | smission | itiation | | | | GISTERED | stration | of | of the | | | NOTE 1 | 5GMM-RE | failure | REGI | regi | | | | GISTERED | and the | STRATION | stration | | | | | attempt | REQUEST | pr | | | | | counter | message | ocedure, | | | | | is equal | | if still | | | | | to 5 | | required | +----------+----------+----------+----------+----------+----------+ | T3510 | 15s | 5 | Tran | REGI | Start | | | | GMM-REGI | smission | STRATION | T3511 or | | | NOTE 7 | STERED-I | of | ACCEPT | T3502 as | | | | NITIATED | REGI | message | s | | | NOTE 8 | | STRATION | received | pecified | | | | | REQUEST | or | in | | | In | | message | REGI | sub | | | WB-N1/CE | | | STRATION | clause 5 | | | mode, | | | REJECT | .5.1.2.7 | | | 85s | | | message | if T3510 | | | | | | received | expired | | | For | | | | during | | | access | | | | regi | | | via a | | | | stration | | | s | | | | p | | | atellite | | | | rocedure | | | NG-RAN | | | | for | | | cell, | | | | initial | | | 27s | | | | regis | | | | | | | tration. | | | NOTE 12 | | | | | | | | | | | Start | | | | | | | T3511 or | | | | | | | T3502 as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | sub | | | | | | | clause 5 | | | | | | | .5.1.3.7 | | | | | | | if T3510 | | | | | | | expired | | | | | | | during | | | | | | | the | | | | | | | regi | | | | | | | stration | | | | | | | p | | | | | | | rocedure | | | | | | | for | | | | | | | mobility | | | | | | | and | | | | | | | periodic | | | | | | | regi | | | | | | | stration | | | | | | | update | +----------+----------+----------+----------+----------+----------+ | T3511 | 10s | 5 | At | Tran | Retran | | | | GMM-DERE | regi | smission | smission | | | | GISTERED | stration | of | of the | | | | .ATTEMPT | failure | REGI | REGI | | | | ING-REGI | due to | STRATION | STRATION | | | | STRATION | lower | REQUEST | REQUEST | | | | | layer | message | message, | | | | 5GMM-R | failure, | | if still | | | | EGISTERE | T3510 | 5GMM-C | required | | | | D.ATTEMP | timeout | ONNECTED | | | | | TING-REG | or | mode | | | | | ISTRATIO | regi | entered | | | | | N-UPDATE | stration | (NOTE 5) | | | | | | rejected | | | | | | 5GMM-R | with | | | | | | EGISTERE | other | | | | | | D.NORMAL | 5GMM | | | | | | -SERVICE | cause | | | | | | or | values | | | | | | 5GM | than | | | | | | M-REGIST | those | | | | | | ERED.NON | treated | | | | | | -ALLOWED | in | | | | | | -SERVICE | sub | | | | | | | clause 5 | | | | | | | .5.1.2.5 | | | | | | | for | | | | | | | initial | | | | | | | regi | | | | | | | stration | | | | | | | or | | | | | | | sub | | | | | | | clause 5 | | | | | | | .5.1.3.5 | | | | | | | for | | | | | | | mobility | | | | | | | and | | | | | | | periodic | | | | | | | regi | | | | | | | stration | | | +----------+----------+----------+----------+----------+----------+ | T3512 | Default | 5GMM-RE | In | When | In | | | 54 min | GISTERED | 5GMM-REG | entering | 5 | | | | | ISTERED, | state | GMM-IDLE | | | NOTE 1 | | when | 5 | mode, | | | | | 5GMM-C | GMM-DERE | In | | | NOTE 2 | | ONNECTED | GISTERED | itiation | | | | | mode is | | of the | | | | | left and | When | periodic | | | | | if the | entering | regi | | | | | NW does | 5GMM-C | stration | | | | | not | ONNECTED | p | | | | | indicate | mode if | rocedure | | | | | support | the NW | if the | | | | | for | does not | UE is | | | | | strictly | indicate | not | | | | | periodic | support | re | | | | | regi | for | gistered | | | | | stration | strictly | for | | | | | timer as | periodic | e | | | | | s | regi | mergency | | | | | pecified | stration | s | | | | | in | timer as | ervices. | | | | | subclaus | s | | | | | | e 5.3.7. | pecified | In | | | | | | in | 5GMM-C | | | | | If the | subclaus | ONNECTED | | | | | network | e 5.3.7. | mode, | | | | | i | | restart | | | | | ndicates | | the | | | | | support | | timer | | | | | for | | T3512. | | | | | strictly | | | | | | | periodic | | Locally | | | | | regi | | de | | | | | stration | | register | | | | | timer, | | if the | | | | | T3512 is | | UE is | | | | | started | | re | | | | | after | | gistered | | | | | the | | for | | | | | su | | e | | | | | ccessful | | mergency | | | | | co | | services | | | | | mpletion | | | | | | | of | | | | | | | regi | | | | | | | stration | | | | | | | update | | | | | | | pr | | | | | | | ocedure. | | | | | | | T3512 is | | | | | | | r | | | | | | | estarted | | | | | | | if it | | | | | | | expires | | | | | | | in | | | | | | | 5GMM-C | | | | | | | ONNECTED | | | | | | | mode as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | subclaus | | | | | | | e 5.3.7. | | | +----------+----------+----------+----------+----------+----------+ | T3516 | 30s | 5 | RAND and | SECURITY | Delete | | | | GMM-REGI | RES* | MODE | the | | | NOTE 7 | STERED-I | stored | COMMAND | stored | | | | NITIATED | as a | message | RAND and | | | NOTE 8 | | result | received | RES* | | | | 5GMM-RE | of an 5G | | | | | In | GISTERED | authen | SERVICE | | | | WB-N1/CE | | tication | REJECT | | | | mode, | 5GM | c | message | | | | 48s For | M-DEREGI | hallenge | received | | | | access | STERED-I | | | | | | via a | NITIATED | | REGI | | | | s | | | STRATION | | | | atellite | 5GMM-S | | ACCEPT | | | | NG-RAN | ERVICE-R | | message | | | | cell, | EQUEST-I | | received | | | | 35s | NITIATED | | | | | | | | | AUTHEN | | | | NOTE 12 | | | TICATION | | | | | | | REJECT | | | | | | | message | | | | | | | received | | | | | | | | | | | | | | AUTHEN | | | | | | | TICATION | | | | | | | FAILURE | | | | | | | message | | | | | | | sent | | | | | | | | | | | | | | 5G | | | | | | | MM-DEREG | | | | | | | ISTERED, | | | | | | | 5 | | | | | | | GMM-NULL | | | | | | | or | | | | | | | | | | | | | | 5 | | | | | | | GMM-IDLE | | | | | | | mode | | | | | | | entered | | +----------+----------+----------+----------+----------+----------+ | T3517 | (a) 5s | 5GMM-S | Tran | (a) | Abort | | | for case | ERVICE-R | smission | In | the | | | h) in | EQUEST-I | of | dication | p | | | su | NITIATED | SERVICE | from the | rocedure | | | bclause | | REQUEST | lower | | | | 5.6.1.1; | | message, | layers | | | | or | | or | that the | | | | | | CONTROL | UE has | | | | (b) | | PLANE | changed | | | | 15s for | | SERVICE | to S1 | | | | cases | | REQUEST | mode or | | | | other | | message | E-UTRA | | | | than h) | | | c | | | | in | | | onnected | | | | s | | | to 5GCN | | | | ubclause | | | for case | | | | 5.6.1.1 | | | h) in | | | | | | | su | | | | NOTE 7 | | | bclause | | | | | | | 5.6.1.1; | | | | NOTE 8 | | | or | | | | | | | | | | | NOTE 10 | | | (b) | | | | | | | SERVICE | | | | In | | | ACCEPT | | | | WB-N1/CE | | | message | | | | mode, | | | r | | | | 61s For | | | eceived, | | | | access | | | or | | | | via a | | | | | | | s | | | SERVICE | | | | atellite | | | REJECT | | | | NG-RAN | | | message | | | | cell, | | | received | | | | 27s | | | for | | | | | | | cases | | | | NOTE 12 | | | other | | | | | | | than h) | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.6.1.1 | | | | | | | | | | | | | | see | | | | | | | sub | | | | | | | clause 5 | | | | | | | .6.1.4.2 | | +----------+----------+----------+----------+----------+----------+ | T3519 | 60s | 5 | Tran | REGI | Delete | | | | GMM-REGI | smission | STRATION | stored | | | NOTE 7 | STERED-I | of | ACCEPT | SUCI | | | | NITIATED | IDENTITY | message | | | | NOTE 8 | | RESPONSE | with new | | | | | 5GMM-RE | message, | 5G-GUTI | | | | In | GISTERED | REGI | received | | | | WB-N1/CE | | STRATION | | | | | mode, | 5GM | REQUEST | CONFI | | | | 90s For | M-DEREGI | message, | GURATION | | | | access | STERED-I | or | UPDATE | | | | via a | NITIATED | DEREGI | COMMAND | | | | s | | STRATION | message | | | | atellite | 5GMM-S | REQUEST | with new | | | | NG-RAN | ERVICE-R | message | 5G-GUTI | | | | cell, | EQUEST-I | with | received | | | | 65s | NITIATED | freshly | DEREGI | | | | | (NOTE 6) | g | STRATION | | | | | | enerated | ACCEPT | | | | | | SUCI | message | | +----------+----------+----------+----------+----------+----------+ | T3520 | 15s | 5 | Tran | AUTHEN | On first | | | | GMM-REGI | smission | TICATION | expiry | | | NOTE 7 | STERED-I | of | REQUEST | during a | | | | NITIATED | AUTHEN | message | 5G AKA | | | NOTE 8 | | TICATION | received | based | | | | 5GMM-RE | FAILURE | or | primary | | | In | GISTERED | message | AUTHEN | authen | | | WB-N1/CE | | with any | TICATION | tication | | | mode, | 5GM | of the | REJECT | and key | | | 33s For | M-DEREGI | 5GMM | message | a | | | access | STERED-I | cause | received | greement | | | via a | NITIATED | #20, | | pr | | | s | | #21, | or | ocedure, | | | atellite | 5GMM-S | #26 or | | the UE | | | NG-RAN | ERVICE-R | #71 | SECURITY | should | | | cell, | EQUEST-I | | MODE | consider | | | 20s | NITIATED | Tran | COMMAND | the | | | | | smission | message | network | | | NOTE 12 | | of | received | as false | | | | | AUTHEN | | and | | | | | TICATION | when | follow | | | | | RESPONSE | entering | item g | | | | | message | 5 | of | | | | | with an | GMM-IDLE | subc | | | | | EAP- | mode | lause 5. | | | | | response | | 4.1.3.7, | | | | | message | in | if the | | | | | after | dication | UE is | | | | | d | of | not | | | | | etection | tran | re | | | | | of an | smission | gistered | | | | | error as | failure | for | | | | | d | of | e | | | | | escribed | AUTHEN | mergency | | | | | in | TICATION | s | | | | | subcl | FAILURE | ervices. | | | | | ause 5.4 | message | | | | | | .1.2.2.4 | from | On first | | | | | | lower | expiry | | | | | | layers | during a | | | | | | | 5G AKA | | | | | | | based | | | | | | | primary | | | | | | | authen | | | | | | | tication | | | | | | | and key | | | | | | | a | | | | | | | greement | | | | | | | pr | | | | | | | ocedure, | | | | | | | the UE | | | | | | | will | | | | | | | follow | | | | | | | sub | | | | | | | clause 5 | | | | | | | .4.1.3.7 | | | | | | | under | | | | | | | \"For | | | | | | | items c, | | | | | | | d, e and | | | | | | | f:\", if | | | | | | | the UE | | | | | | | is | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | s | | | | | | | ervices. | | | | | | | | | | | | | | On first | | | | | | | expiry | | | | | | | during | | | | | | | an EAP | | | | | | | based | | | | | | | primary | | | | | | | authen | | | | | | | tication | | | | | | | and key | | | | | | | a | | | | | | | greement | | | | | | | pr | | | | | | | ocedure, | | | | | | | the UE | | | | | | | should | | | | | | | consider | | | | | | | the | | | | | | | network | | | | | | | as false | | | | | | | and | | | | | | | follow | | | | | | | item e | | | | | | | of | | | | | | | subcla | | | | | | | use 5.4. | | | | | | | 1.2.4.5, | | | | | | | if the | | | | | | | UE is | | | | | | | not | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | s | | | | | | | ervices. | | | | | | | | | | | | | | On first | | | | | | | expiry | | | | | | | during | | | | | | | an EAP | | | | | | | based | | | | | | | primary | | | | | | | authen | | | | | | | tication | | | | | | | and key | | | | | | | a | | | | | | | greement | | | | | | | pr | | | | | | | ocedure, | | | | | | | the UE | | | | | | | will | | | | | | | follow | | | | | | | subcl | | | | | | | ause 5.4 | | | | | | | .1.2.4.5 | | | | | | | under | | | | | | | \"For | | | | | | | item | | | | | | | e:\", if | | | | | | | the UE | | | | | | | is | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | services | +----------+----------+----------+----------+----------+----------+ | T3521 | 15s | 5GM | Tran | DEREGI | Retran | | | | M-DEREGI | smission | STRATION | smission | | | NOTE 7 | STERED-I | of | ACCEPT | of | | | | NITIATED | DEREGI | message | DEREGI | | | NOTE 8 | | STRATION | received | STRATION | | | | | REQUEST | | REQUEST | | | In | | message | | message | | | WB-N1/CE | | when | | | | | mode, | | de-regi | | | | | 45s For | | stration | | | | | access | | p | | | | | via a | | rocedure | | | | | s | | is not | | | | | atellite | | due to a | | | | | NG-RAN | | \"switch | | | | | cell, | | off\" | | | | | 27s | | | | | | | | | | | | | | NOTE 12 | | | | | +----------+----------+----------+----------+----------+----------+ | T3525 | Default | 5GMM-R | T3517 | When | The UE | | | 60s | EGISTERE | expires | entering | may | | | | D.NORMAL | and | state | initiate | | | NOTE 3 | -SERVICE | service | other | service | | | | or | request | than | request | | | NOTE 7 | 5GM | attempt | 5GMM-R | p | | | | M-REGIST | counter | EGISTERE | rocedure | | | NOTE 8 | ERED.NON | is | D.NORMAL | | | | | -ALLOWED | greater | -SERVICE | | | | In | -SERVICE | than or | state or | | | | WB-N1/CE | | equal to | 5GMM | | | | mode, | | 5 | -REGISTE | | | | default | | | RED.NON- | | | | 120s | | | ALLOWED- | | | | | | | SERVICE, | | | | For | | | | | | | access | | | or | | | | via a | | | | | | | s | | | UE | | | | atellite | | | camped | | | | NG-RAN | | | on a new | | | | cell, | | | PLMN | | | | default | | | other | | | | 72s | | | than the | | | | | | | PLMN on | | | | NOTE 12 | | | which | | | | | | | timer | | | | | | | started, | | | | | | | | | | | | | | or | | | | | | | | | | | | | | Us | | | | | | | er-plane | | | | | | | r | | | | | | | esources | | | | | | | est | | | | | | | ablished | | | | | | | with the | | | | | | | network | | +----------+----------+----------+----------+----------+----------+ | T3540 | 10s | 5 | REGI | N1 NAS | Release | | | | GMM-DERE | STRATION | si | the NAS | | | NOTE 7 | GISTERED | REJECT | gnalling | si | | | (ap | | message | co | gnalling | | | plicable | 5GMM-RE | or | nnection | co | | | to case | GISTERED | DEREGI | released | nnection | | | f) in | | STRATION | | for the | | | su | | REQUEST | PDU | cases | | | bclause | | message | sessions | a), b), | | | 5.3.1.3) | | received | have | f) and | | | | | with any | been set | g) as | | | NOTE 8 | | of the | up | d | | | | | 5GMM | except | escribed | | | In | | cause | for the | in | | | WB-N1/CE | | #3, | case the | s | | | mode, | | #6, | UE has | ubclause | | | 34s | | #7, | set | 5.3.1.3 | | | (ap | | #11, | Request | | | | plicable | | #12, | type to | | | | to case | | #13, | \"NAS | | | | f) in | | #15, | si | | | | su | | #27, | gnalling | | | | bclause | | #31, | co | | | | 5.3.1.3) | | #36, | nnection | | | | | | #62, | r | | | | NOTE 11 | | #72, | elease\" | | | | | | #73, | in the | | | | For | | #74, | UE | | | | access | | #75 or | request | | | | via a | | #76 | type IE | | | | s | | | in the | | | | atellite | | SERVICE | REGI | | | | NG-RAN | | REJECT | STRATION | | | | cell, | | message | REQUEST | | | | default | | received | message | | | | 22s | | with any | as | | | | (ap | | of the | d | | | | plicable | | 5GMM | escribed | | | | to case | | cause | in | | | | f) in | | #3, | s | | | | su | | #6, | ubclause | | | | bclause | | #7, | 5.3.1.3 | | | | 5.3.1.3) | | #11, | case b) | | | | | | #12, | | | | | NOTE 12 | | #13, | Other | | | | | | #15, | use | | | | | | #27, | cases | | | | | | #36, | see | | | | | | #72, | s | | | | | | #73, | ubclause | | | | | | #74, | 5.3.1.3 | | | | | | #75 or | | | | | | | #76. | | | | | | | | | | | | | | REGI | | | | | | | STRATION | | | | | | | ACCEPT | | | | | | | message | | | | | | | received | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.3.1.3 | | | | | | | case b) | | | | | | | and case | | | | | | | h) | | | | | | | | | | | | | | SERVICE | | | | | | | ACCEPT | | | | | | | message | | | | | | | received | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.3.1.3 | | | | | | | case f) | | | | | | | | | | | | | | AUTHEN | | | | | | | TICATION | | | | | | | REJECT | | | | | | | message | | | | | | | received | | | | | | | | | | | | | | DEREGI | | | | | | | STRATION | | | | | | | ACCEPT | | | | | | | message | | | | | | | received | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.3.1.3 | | | | | | | case k) | | | +----------+----------+----------+----------+----------+----------+ | | | 5GMM-RE | CONFI | N1 NAS | Release | | | | GISTERED | GURATION | si | the NAS | | | | | UPDATE | gnalling | si | | | | | COMMAND | co | gnalling | | | | | message | nnection | co | | | | | received | released | nnection | | | | | as | Other | for the | | | | | d | use | case e) | | | | | escribed | cases | and | | | | | in | see | perform | | | | | s | s | a new | | | | | ubclause | ubclause | regi | | | | | 5.3.1.3 | 5.3.1.3 | stration | | | | | case e) | | p | | | | | and h) | | rocedure | | | | | | | as | | | | | SERVICE | | d | | | | | ACCEPT | | escribed | | | | | message | | in | | | | | received | | s | | | | | as | | ubclause | | | | | d | | 5 | | | | | escribed | | .5.1.3.2 | | | | | in | | | | | | | s | | Release | | | | | ubclause | | the NAS | | | | | 5.3.1.3 | | si | | | | | case i) | | gnalling | | | | | | | co | | | | | | | nnection | | | | | | | for the | | | | | | | case h) | | | | | | | and i) | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.3.1.3 | +----------+----------+----------+----------+----------+----------+ | | | 5 | REGI | | Release | | | | GMM-DERE | STRATION | | the NAS | | | | GISTERED | REJECT | | si | | | | | message | | gnalling | | | | 5GMM-DER | received | | co | | | | EGISTERE | with the | | nnection | | | | D.NORMAL | 5GMM | | for the | | | | -SERVICE | cause | | cases c) | | | | | #9 or | | and d) | | | | 5GM | #10 | | as | | | | M-REGIST | | | d | | | | ERED.NON | SERVICE | | escribed | | | | -ALLOWED | REJECT | | in | | | | -SERVICE | message | | s | | | | | received | | ubclause | | | | | with the | | 5.3.1.3 | | | | | 5GMM | | and | | | | | cause | | in | | | | | #9, | | itiation | | | | | #10 or | | of the | | | | | #28 | | regi | | | | | | | stration | | | | | | | p | | | | | | | rocedure | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | sub | | | | | | | clause 5 | | | | | | | .5.1.2.2 | | | | | | | or | | | | | | | 5 | | | | | | | .5.1.3.2 | +----------+----------+----------+----------+----------+----------+ | Non-3GPP | Default | All 5GMM | Entering | N1 NAS | Im | | de-regi | 54 min. | state | 5 | si | plicitly | | stration | | over | GMM-IDLE | gnalling | de- | | timer | NOTE 1 | non-3GPP | mode | co | register | | | | access | over | nnection | the UE | | | NOTE 2 | except | non-3GPP | over | for | | | | 5 | access | non-3GPP | non-3GPP | | | NOTE 4 | GMM-DERE | | access | access | | | | GISTERED | | est | on 1st | | | | over | | ablished | expiry | | | | non-3GPP | | or when | | | | | access | | entering | | | | | | | state | | | | | | | 5 | | | | | | | GMM-DERE | | | | | | | GISTERED | | | | | | | over | | | | | | | non-3GPP | | | | | | | access | | +----------+----------+----------+----------+----------+----------+ | T3526 | NOTE 9 | 5 | Rejected | The | Remove | | | | GMM-DERE | S-NSSAI | as | the | | | | GISTERED | with | sociated | S-NSSAI | | | | 5GMM-RE | r | rejected | in the | | | | GISTERED | ejection | S-NSSAI | rejected | | | | | cause | for the | NSSAI | | | | | **\ | maximum | for the | | | | | "maximum | number | maximum | | | | | number | of UEs | number | | | | | of UEs | reached | of UEs | | | | | per | as | reached | | | | | network | s | as | | | | | slice | pecified | sociated | | | | | rea | in | with the | | | | | ched\"** | s | T3526 | | | | | r | ubclause | timer. | | | | | eceived. | 4.6.2.2 | | | | | | | deleted. | | +----------+----------+----------+----------+----------+----------+ | T3527 | 15s | 5GMM-R | Tran | RELAY | Retran | | | | EGISTERE | smission | KEY | smission | | | | D.NORMAL | of RELAY | REJECT | of RELAY | | | | -SERVICE | KEY | message | KEY | | | | | REQUEST | received | REQUEST | | | | | message | or | message | | | | | | | | | | | | Tran | RELAY | | | | | | smission | AUTHEN | | | | | | of RELAY | TICATION | | | | | | AUTHEN | REQUEST | | | | | | TICATION | message | | | | | | RESPONSE | received | | | | | | message | or | | | | | | | | | | | | | | RELAY | | | | | | | KEY | | | | | | | ACCEPT | | | | | | | message | | | | | | | received | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | provided | | | | | | | by the | | | | | | | network | | | | | | | operator | | | | | | | during | | | | | | | the | | | | | | | regi | | | | | | | stration | | | | | | | pr | | | | | | | ocedure. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The | | | | | | | default | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | used if | | | | | | | the | | | | | | | network | | | | | | | does not | | | | | | | indicate | | | | | | | a value | | | | | | | in the | | | | | | | REGI | | | | | | | STRATION | | | | | | | ACCEPT | | | | | | | message | | | | | | | and the | | | | | | | UE does | | | | | | | not have | | | | | | | a stored | | | | | | | value | | | | | | | for this | | | | | | | timer. | | | | | | | | | | | | | | NOTE 3: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | UE | | | | | | | implem | | | | | | | entation | | | | | | | s | | | | | | | pecific, | | | | | | | with a | | | | | | | minimum | | | | | | | value of | | | | | | | 60 | | | | | | | seconds | | | | | | | if not | | | | | | | in NB-N1 | | | | | | | mode and | | | | | | | if not | | | | | | | in | | | | | | | WB-N1/CE | | | | | | | mode. | | | | | | | | | | | | | | NOTE 4: | | | | | | | If the | | | | | | | T3346 | | | | | | | value | | | | | | | received | | | | | | | in the | | | | | | | mobility | | | | | | | ma | | | | | | | nagement | | | | | | | messages | | | | | | | is | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | the | | | | | | | non-3GPP | | | | | | | de-regi | | | | | | | stration | | | | | | | timer, | | | | | | | the UE | | | | | | | sets the | | | | | | | non-3GPP | | | | | | | de-regi | | | | | | | stration | | | | | | | timer | | | | | | | value to | | | | | | | be 4 | | | | | | | minutes | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | timer | | | | | | | T3346. | | | | | | | | | | | | | | NOTE 5: | | | | | | | The | | | | | | | co | | | | | | | nditions | | | | | | | for | | | | | | | which | | | | | | | this | | | | | | | applies | | | | | | | are | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | subc | | | | | | | lause 5. | | | | | | | 5.1.3.7. | | | | | | | | | | | | | | NOTE 6: | | | | | | | The | | | | | | | co | | | | | | | nditions | | | | | | | for | | | | | | | which | | | | | | | this | | | | | | | applies | | | | | | | to the | | | | | | | 5GMM-S | | | | | | | ERVICE-R | | | | | | | EQUEST-I | | | | | | | NITIATED | | | | | | | state | | | | | | | are | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | sub | | | | | | | clause 5 | | | | | | | .4.1.3.7 | | | | | | | case c) | | | | | | | and | | | | | | | case d). | | | | | | | | | | | | | | NOTE 7: | | | | | | | In NB-N1 | | | | | | | mode, | | | | | | | the | | | | | | | timer | | | | | | | value | | | | | | | shall be | | | | | | | ca | | | | | | | lculated | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 4.17. | | | | | | | | | | | | | | NOTE 8: | | | | | | | In WB-N1 | | | | | | | mode, if | | | | | | | the UE | | | | | | | supports | | | | | | | CE mode | | | | | | | B and | | | | | | | operates | | | | | | | in | | | | | | | either | | | | | | | CE mode | | | | | | | A or CE | | | | | | | mode B, | | | | | | | then the | | | | | | | timer | | | | | | | value is | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in this | | | | | | | table | | | | | | | for the | | | | | | | case of | | | | | | | WB-N1/CE | | | | | | | mode | | | | | | | (see | | | | | | | subclaus | | | | | | | e 4.19). | | | | | | | | | | | | | | NOTE 9: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | provided | | | | | | | by the | | | | | | | network | | | | | | | operator | | | | | | | during | | | | | | | the | | | | | | | regi | | | | | | | stration | | | | | | | p | | | | | | | rocedure | | | | | | | or the | | | | | | | generic | | | | | | | UE | | | | | | | confi | | | | | | | guration | | | | | | | update | | | | | | | p | | | | | | | rocedure | | | | | | | along | | | | | | | with the | | | | | | | rejected | | | | | | | S-NSSAI | | | | | | | with | | | | | | | r | | | | | | | ejection | | | | | | | cause | | | | | | | \ | | | | | | | "maximum | | | | | | | number | | | | | | | of UEs | | | | | | | per | | | | | | | network | | | | | | | slice | | | | | | | re | | | | | | | ached\". | | | | | | | The | | | | | | | default | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | implem | | | | | | | entation | | | | | | | specific | | | | | | | with a | | | | | | | minimum | | | | | | | value of | | | | | | | 12 | | | | | | | minutes | | | | | | | and used | | | | | | | if the | | | | | | | network | | | | | | | does not | | | | | | | provide | | | | | | | a value | | | | | | | in the | | | | | | | REGI | | | | | | | STRATION | | | | | | | ACCEPT | | | | | | | message, | | | | | | | the | | | | | | | REGI | | | | | | | STRATION | | | | | | | REJECT | | | | | | | message, | | | | | | | or the | | | | | | | CONFI | | | | | | | GURATION | | | | | | | UPDATE | | | | | | | COMMAND | | | | | | | message | | | | | | | along | | | | | | | with the | | | | | | | rejected | | | | | | | S-NSSAI | | | | | | | with | | | | | | | r | | | | | | | ejection | | | | | | | cause | | | | | | | \ | | | | | | | "maximum | | | | | | | number | | | | | | | of UEs | | | | | | | per | | | | | | | network | | | | | | | slice | | | | | | | re | | | | | | | ached\". | | | | | | | | | | | | | | NOTE 10: | | | | | | | Based on | | | | | | | impleme | | | | | | | ntation, | | | | | | | the | | | | | | | timer | | | | | | | may be | | | | | | | set to a | | | | | | | value | | | | | | | between | | | | | | | 250ms | | | | | | | and 15s | | | | | | | when the | | | | | | | MUSIM UE | | | | | | | i | | | | | | | ndicates | | | | | | | \"NAS | | | | | | | si | | | | | | | gnalling | | | | | | | co | | | | | | | nnection | | | | | | | r | | | | | | | elease\" | | | | | | | in the | | | | | | | UE | | | | | | | request | | | | | | | type IE | | | | | | | of the | | | | | | | SERVICE | | | | | | | REQUEST | | | | | | | message | | | | | | | or | | | | | | | CONTROL | | | | | | | PLANE | | | | | | | SERVICE | | | | | | | REQUEST | | | | | | | message. | | | | | | | | | | | | | | NOTE 11: | | | | | | | Based on | | | | | | | impleme | | | | | | | ntation, | | | | | | | the | | | | | | | timer | | | | | | | may be | | | | | | | set to a | | | | | | | value | | | | | | | between | | | | | | | 250ms | | | | | | | and 10s | | | | | | | when the | | | | | | | MUSIM UE | | | | | | | not in | | | | | | | NB-N1 | | | | | | | mode or | | | | | | | WB-N1 | | | | | | | mode | | | | | | | i | | | | | | | ndicated | | | | | | | \"NAS | | | | | | | si | | | | | | | gnalling | | | | | | | co | | | | | | | nnection | | | | | | | r | | | | | | | elease\" | | | | | | | or | | | | | | | \"R | | | | | | | ejection | | | | | | | of | | | | | | | paging\" | | | | | | | in the | | | | | | | UE | | | | | | | request | | | | | | | type IE | | | | | | | of the | | | | | | | SERVICE | | | | | | | REQUEST | | | | | | | message | | | | | | | or | | | | | | | CONTROL | | | | | | | PLANE | | | | | | | SERVICE | | | | | | | REQUEST | | | | | | | message; | | | | | | | or | | | | | | | i | | | | | | | ndicated | | | | | | | \"NAS | | | | | | | si | | | | | | | gnalling | | | | | | | co | | | | | | | nnection | | | | | | | r | | | | | | | elease\" | | | | | | | in the | | | | | | | UE | | | | | | | request | | | | | | | type IE | | | | | | | of the | | | | | | | REGI | | | | | | | STRATION | | | | | | | REQUEST | | | | | | | message. | | | | | | | | | | | | | | NOTE 12: | | | | | | | In | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | access, | | | | | | | this | | | | | | | value | | | | | | | shall be | | | | | | | selected | | | | | | | when | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | RAT type | | | | | | | is | | | | | | | NR(MEO) | | | | | | | or | | | | | | | NR(GEO). | | | | | | +----------+----------+----------+----------+----------+----------+
Table 10.2.2: Timers of 5GS mobility management -- AMF side
+----------+----------+----------+----------+----------+----------+ | TIMER | TIMER | STATE | CAUSE OF | NORMAL | ON\ | | NUM. | VALUE | | START | STOP | EXPIRY | +----------+----------+----------+----------+----------+----------+ | T3513 | NOTE 4 | 5GMM-RE | Paging | Paging | Network | | | | GISTERED | p | p | d | | NOTE 7 | | | rocedure | rocedure | ependent | | | | | i | c | | | NOTE 9 | | | nitiated | ompleted | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | sub | | | | | | | clause 5 | | | | | | | .6.2.2.1 | | +----------+----------+----------+----------+----------+----------+ | T3522 | 6s | 5GM | Tran | DEREGI | Retran | | | | M-DEREGI | smission | STRATION | smission | | NOTE 6 | In | STERED-I | of | ACCEPT | of | | | WB-N1/CE | NITIATED | DEREGI | message | DEREGI | | NOTE 8 | mode, | | STRATION | received | STRATION | | | 24s | | REQUEST | | REQUEST | | | | | message | | message | | | For | | | | | | | access | | | | | | | via a | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | cell, | | | | | | | 11s | | | | | | | | | | | | | | NOTE 12 | | | | | +----------+----------+----------+----------+----------+----------+ | T3550 | 6s | 5GMM-CO | Tran | REGI | Retran | | | | MMON-PRO | smission | STRATION | smission | | NOTE 6 | In | CEDURE-I | of | COMPLETE | of | | | WB-N1/CE | NITIATED | REGI | message | REGI | | NOTE 8 | mode, | | STRATION | received | STRATION | | | 18s | | ACCEPT | | ACCEPT | | | | | message | | message | | | For | | as | | | | | access | | s | | | | | via a | | pecified | | | | | s | | in | | | | | atellite | | sub | | | | | NG-RAN | | clause 5 | | | | | cell, | | .5.1.2.4 | | | | | 11s | | and | | | | | | | 5 | | | | | NOTE 12 | | .5.1.3.4 | | | +----------+----------+----------+----------+----------+----------+ | T3555 | 6s | 5GMM-RE | Tran | CONFI | Retran | | | | GISTERED | smission | GURATION | smission | | NOTE 6 | In | | of | UPDATE | of | | | WB-N1/CE | | CONFI | COMPLETE | CONFI | | NOTE 8 | mode, | | GURATION | message | GURATION | | | 24s | | UPDATE | received | UPDATE | | | | | COMMAND | | COMMAND | | | For | | message | | message | | | access | | with | | | | | via a | | \ | | | | | s | | "acknowl | | | | | atellite | | edgement | | | | | NG-RAN | | req | | | | | cell, | | uested\" | | | | | 11s | | set in | | | | | | | the | | | | | NOTE 12 | | Acknowl | | | | | | | edgement | | | | | | | bit of | | | | | | | the | | | | | | | Confi | | | | | | | guration | | | | | | | update | | | | | | | in | | | | | | | dication | | | | | | | IE | | | +----------+----------+----------+----------+----------+----------+ | T3560 | 6s | 5GMM-CO | Tran | AUTHEN | Retran | | | | MMON-PRO | smission | TICATION | smission | | NOTE 6 | In | CEDURE-I | of | RESPONSE | of | | | WB-N1/CE | NITIATED | AUTHEN | message | AUTHEN | | NOTE 8 | mode, | | TICATION | received | TICATION | | | 24s | | REQUEST | | REQUEST | | | | | message | AUTHEN | message | | | For | | | TICATION | or | | | access | | Tran | FAILURE | SECURITY | | | via a | | smission | message | MODE | | | s | | of | received | COMMAND | | | atellite | | SECURITY | | message | | | NG-RAN | | MODE | SECURITY | | | | cell, | | COMMAND | MODE | | | | 11s | | message | COMPLETE | | | | | | | message | | | | | | | received | | | | | | | | | | | | | | SECURITY | | | | | | | MODE | | | | | | | REJECT | | | | | | | message | | | | | | | received | | +----------+----------+----------+----------+----------+----------+ | T3565 | 6s | 5GMM-RE | Tran | SERVICE | Retran | | | | GISTERED | smission | REQUEST | smission | | NOTE 6 | In | | of | message | of | | | WB-N1/CE | | NOTI | received | NOTI | | NOTE 8 | mode, | | FICATION | | FICATION | | | 24s For | | message | CONTROL | message | | | access | | | PLANE | | | | via a | | | SERVICE | | | | s | | | REQUEST | | | | atellite | | | message | | | | NG-RAN | | | received | | | | cell, | | | | | | | 11s | | | NOTI | | | | | | | FICATION | | | | NOTE 12 | | | RESPONSE | | | | | | | message | | | | | | | received | | | | | | | | | | | | | | REGI | | | | | | | STRATION | | | | | | | REQUEST | | | | | | | | | | | | | | Message | | | | | | | received | | | | | | | | | | | | | | DEREGI | | | | | | | STRATION | | | | | | | REQUEST | | | | | | | message | | | | | | | received | | | | | | | | | | | | | | NGAP UE | | | | | | | context | | | | | | | resume | | | | | | | request | | | | | | | message | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | 3GPP | | | | | | | TS 38.41 | | | | | | | 3 [31] | | | | | | | received | | +----------+----------+----------+----------+----------+----------+ | T3570 | 6s | 5GMM-CO | Tran | IDENTITY | Retran | | | | MMON-PRO | smission | RESPONSE | smission | | NOTE 6 | In | CEDURE-I | of | message | of | | | WB-N1/CE | NITIATED | IDENTITY | received | IDENTITY | | NOTE 8 | mode, | | REQUEST | | REQUEST | | | 24s | | message | | message | | | | | | | | | | For | | | | | | | access | | | | | | | via a | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | cell, | | | | | | | 11s | | | | | | | | | | | | | | NOTE 12 | | | | | +----------+----------+----------+----------+----------+----------+ | T3575 | 15s | 5GMM-RE | Tran | NETWORK | Retran | | | | GISTERED | smission | SLICE- | smission | | NOTE 6 | In | | of | SPECIFIC | of | | | WB-N1/CE | | NETWORK | AUTHEN | NETWORK | | NOTE 8 | mode, | | SLICE- | TICATION | SLICE- | | | 60s | | SPECIFIC | COMPLETE | SPECIFIC | | | | | AUTHEN | message | AUTHEN | | | For | | TICATION | received | TICATION | | | access | | COMMAND | | COMMAND | | | via a | | message | | message | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | cell, | | | | | | | 27s | | | | | | | | | | | | | | NOTE 12 | | | | | +----------+----------+----------+----------+----------+----------+ | Active | NOTE 10 | All | Entering | N1 NAS | Activate | | timer | | except | 5 | si | MICO | | | | 5 | GMM-IDLE | gnalling | mode for | | | | GMM-DERE | mode | | the UE. | | | | GISTERED | after | co | | | | | | in | nnection | | | | | | dicating | est | | | | | | MICO | ablished | | | | | | mode | | | | | | | ac | | | | | | | tivation | | | | | | | to the | | | | | | | UE with | | | | | | | an | | | | | | | active | | | | | | | timer | | | | | | | value. | | | +----------+----------+----------+----------+----------+----------+ | Implicit | NOTE 2 | All | The | N1 NAS | Im | | de-regi | | except | mobile | si | plicitly | | stration | | 5 | r | gnalling | de- | | timer | | GMM-DERE | eachable | co | register | | | | GISTERED | timer | nnection | the UE | | | | | expires | est | on 1^st^ | | | | | while | ablished | expiry | | | | | the | | | | | | | network | | | | | | | is in | | | | | | | 5 | | | | | | | GMM-IDLE | | | | | | | mode | | | | | | | | | | | | | | Entering | | | | | | | 5 | | | | | | | GMM-IDLE | | | | | | | mode | | | | | | | over | | | | | | | 3GPP | | | | | | | access | | | | | | | if the | | | | | | | MICO | | | | | | | mode is | | | | | | | a | | | | | | | ctivated | | | | | | | and | | | | | | | strictly | | | | | | | periodic | | | | | | | mo | | | | | | | nitoring | | | | | | | timer is | | | | | | | not | | | | | | | running | | | | | | | | | | | | | | The | | | | | | | strictly | | | | | | | periodic | | | | | | | mo | | | | | | | nitoring | | | | | | | timer | | | | | | | expires | | | | | | | while | | | | | | | the | | | | | | | network | | | | | | | is in | | | | | | | 5 | | | | | | | GMM-IDLE | | | | | | | mode | | | +----------+----------+----------+----------+----------+----------+ | Mobile | NOTE 1 | All | Entering | N1 NAS | Network | | r | | except | 5 | si | de | | eachable | | 5 | GMM-IDLE | gnalling | pendent, | | timer | | GMM-DERE | mode | co | but | | | | GISTERED | | nnection | t | | | | | | est | ypically | | | | | | ablished | paging | | | | | | | is | | | | | | | halted | | | | | | | on 1^st^ | | | | | | | expiry, | | | | | | | and | | | | | | | start | | | | | | | implicit | | | | | | | de-regi | | | | | | | stration | | | | | | | timer, | | | | | | | if the | | | | | | | UE is | | | | | | | not | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | s | | | | | | | ervices. | | | | | | | | | | | | | | Im | | | | | | | plicitly | | | | | | | de- | | | | | | | register | | | | | | | the UE | | | | | | | which is | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | services | +----------+----------+----------+----------+----------+----------+ | Non-3GPP | NOTE 3 | All | Entering | N1 NAS | Im | | implicit | | except | 5 | si | plicitly | | de-regi | | 5 | GMM-IDLE | gnalling | de- | | stration | | GMM-DERE | mode | co | register | | timer | | GISTERED | over | nnection | the UE | | | | | non-3GPP | over | for | | | | | access | non-3GPP | non-3GPP | | | | | | access | access | | | | | | est | on 1^s^ | | | | | | ablished | expiry | +----------+----------+----------+----------+----------+----------+ | Strictly | NOTE 5 | All | At the | Entering | In | | periodic | | except | su | 5G | 5 | | mo | | 5 | ccessful | MM-DEREG | GMM-IDLE | | nitoring | | GMM-DERE | co | ISTERED. | mode, | | timer | | GISTERED | mpletion | | start | | | | | of | | implicit | | | | | regi | | de-regi | | | | | stration | | stration | | | | | update | | timer as | | | | | p | | s | | | | | rocedure | | pecified | | | | | if | | in | | | | | strictly | | subclaus | | | | | periodic | | e 5.3.7. | | | | | regi | | | | | | | stration | | In | | | | | timer | | 5GMM-C | | | | | in | | ONNECTED | | | | | dication | | mode, | | | | | is | | Strictly | | | | | s | | periodic | | | | | upported | | mo | | | | | as | | nitoring | | | | | s | | timer is | | | | | pecified | | started | | | | | in | | again as | | | | | subclaus | | s | | | | | e 5.3.7. | | pecified | | | | | | | in | | | | | | | subclaus | | | | | | | e 5.3.7. | +----------+----------+----------+----------+----------+----------+ | Implem | NOTE 11 | 5GMM-RE | At the | DEREGI | N | | entation | | GISTERED | su | STRATION | etwork-i | | specific | | | ccessful | REQUEST | nitiated | | timer | | | co | message | de-regi | | for | | | mpletion | r | stration | | on | | | of | eceived. | p | | boarding | | | initial | | rocedure | | services | | | regi | | p | | | | | stration | | erformed | | | | | for | | | | | | | on | | | | | | | boarding | | | | | | | services | | | | | | | in SNPN | | | | | | | or | | | | | | | initial | | | | | | | regi | | | | | | | stration | | | | | | | for the | | | | | | | UE which | | | | | | | the | | | | | | | subs | | | | | | | cription | | | | | | | is only | | | | | | | for | | | | | | | confi | | | | | | | guration | | | | | | | of SNPN | | | | | | | subs | | | | | | | cription | | | | | | | pa | | | | | | | rameters | | | | | | | in PLMN | | | | | | | via the | | | | | | | user | | | | | | | plane or | | | | | | | su | | | | | | | ccessful | | | | | | | co | | | | | | | mpletion | | | | | | | of | | | | | | | regi | | | | | | | stration | | | | | | | p | | | | | | | rocedure | | | | | | | for | | | | | | | mobility | | | | | | | and | | | | | | | periodic | | | | | | | regi | | | | | | | stration | | | | | | | update | | | | | | | if the | | | | | | | implem | | | | | | | entation | | | | | | | specific | | | | | | | timer | | | | | | | for | | | | | | | on | | | | | | | boarding | | | | | | | services | | | | | | | is not | | | | | | | running | | | | | | | and: | | | | | | | | | | | | | | - the | | | | | | | UE is | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | on | | | | | | | boarding | | | | | | | services | | | | | | | in SNPN; | | | | | | | or | | | | | | | | | | | | | | - the | | | | | | | UE\'s | | | | | | | subs | | | | | | | cription | | | | | | | only | | | | | | | allows | | | | | | | for | | | | | | | confi | | | | | | | guration | | | | | | | of SNPN | | | | | | | subs | | | | | | | cription | | | | | | | pa | | | | | | | rameters | | | | | | | in PLMN | | | | | | | via the | | | | | | | user | | | | | | | plane. | | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | The | | | | | | | default | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | 4 | | | | | | | minutes | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | timer | | | | | | | T3512. | | | | | | | If the | | | | | | | UE is | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | s | | | | | | | ervices, | | | | | | | the | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | set | | | | | | | equal to | | | | | | | the | | | | | | | value of | | | | | | | timer | | | | | | | T3512. | | | | | | | If the | | | | | | | T3346 | | | | | | | value | | | | | | | provided | | | | | | | in the | | | | | | | mobility | | | | | | | ma | | | | | | | nagement | | | | | | | messages | | | | | | | is | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | the | | | | | | | timer | | | | | | | T3512, | | | | | | | the AMF | | | | | | | sets the | | | | | | | mobile | | | | | | | r | | | | | | | eachable | | | | | | | timer | | | | | | | and the | | | | | | | implicit | | | | | | | de-regi | | | | | | | stration | | | | | | | timer | | | | | | | such | | | | | | | that the | | | | | | | sum of | | | | | | | the | | | | | | | timer | | | | | | | values | | | | | | | is | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | timer | | | | | | | T3346. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | network | | | | | | | de | | | | | | | pendent. | | | | | | | If MICO | | | | | | | is | | | | | | | ac | | | | | | | tivated, | | | | | | | the | | | | | | | default | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | 4 | | | | | | | minutes | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | timer | | | | | | | T3512. | | | | | | | | | | | | | | NOTE 3: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | network | | | | | | | de | | | | | | | pendent. | | | | | | | The | | | | | | | default | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | 4 | | | | | | | minutes | | | | | | | greater | | | | | | | than the | | | | | | | non-3GPP | | | | | | | de-regi | | | | | | | stration | | | | | | | timer. | | | | | | | If the | | | | | | | T3346 | | | | | | | value | | | | | | | provided | | | | | | | in the | | | | | | | mobility | | | | | | | ma | | | | | | | nagement | | | | | | | messages | | | | | | | is | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | the | | | | | | | non-3GPP | | | | | | | de-regi | | | | | | | stration | | | | | | | timer, | | | | | | | the AMF | | | | | | | sets the | | | | | | | non-3GPP | | | | | | | implicit | | | | | | | de-regi | | | | | | | stration | | | | | | | timer | | | | | | | value to | | | | | | | be 8 | | | | | | | minutes | | | | | | | greater | | | | | | | than the | | | | | | | value of | | | | | | | timer | | | | | | | T3346. | | | | | | | | | | | | | | NOTE 4: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | network | | | | | | | de | | | | | | | pendent. | | | | | | | | | | | | | | NOTE 5: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | the same | | | | | | | as the | | | | | | | value of | | | | | | | timer | | | | | | | T3512. | | | | | | | | | | | | | | NOTE 6: | | | | | | | In NB-N1 | | | | | | | mode, | | | | | | | the | | | | | | | timer | | | | | | | value | | | | | | | shall be | | | | | | | ca | | | | | | | lculated | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | subclau | | | | | | | se 4.17. | | | | | | | | | | | | | | NOTE 7: | | | | | | | In NB-N1 | | | | | | | mode, | | | | | | | the | | | | | | | timer | | | | | | | value | | | | | | | shall be | | | | | | | ca | | | | | | | lculated | | | | | | | by using | | | | | | | an NAS | | | | | | | timer | | | | | | | value | | | | | | | which is | | | | | | | network | | | | | | | de | | | | | | | pendent. | | | | | | | | | | | | | | NOTE 8: | | | | | | | In WB-N1 | | | | | | | mode, if | | | | | | | the UE | | | | | | | supports | | | | | | | CE mode | | | | | | | B and | | | | | | | operates | | | | | | | in | | | | | | | either | | | | | | | CE mode | | | | | | | A or CE | | | | | | | mode B, | | | | | | | then the | | | | | | | timer | | | | | | | value is | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in this | | | | | | | table | | | | | | | for the | | | | | | | case of | | | | | | | WB-N1/CE | | | | | | | mode | | | | | | | (see | | | | | | | subclaus | | | | | | | e 4.19). | | | | | | | | | | | | | | NOTE 9: | | | | | | | In WB-N1 | | | | | | | mode, if | | | | | | | the UE | | | | | | | supports | | | | | | | CE mode | | | | | | | B, then | | | | | | | the | | | | | | | timer | | | | | | | value | | | | | | | shall be | | | | | | | ca | | | | | | | lculated | | | | | | | by using | | | | | | | an NAS | | | | | | | timer | | | | | | | value | | | | | | | which | | | | | | | value is | | | | | | | network | | | | | | | de | | | | | | | pendent. | | | | | | | | | | | | | | NOTE 10: | | | | | | | If the | | | | | | | AMF | | | | | | | includes | | | | | | | timer | | | | | | | T3324 in | | | | | | | the | | | | | | | REGI | | | | | | | STRATION | | | | | | | ACCEPT | | | | | | | message | | | | | | | and if | | | | | | | the UE | | | | | | | is not | | | | | | | re | | | | | | | gistered | | | | | | | for | | | | | | | e | | | | | | | mergency | | | | | | | s | | | | | | | ervices, | | | | | | | the | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | equal to | | | | | | | the | | | | | | | value of | | | | | | | timer | | | | | | | T3324. | | | | | | | | | | | | | | NOTE 11: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer | | | | | | | needs to | | | | | | | be large | | | | | | | enough | | | | | | | to allow | | | | | | | a UE to | | | | | | | complete | | | | | | | the | | | | | | | confi | | | | | | | guration | | | | | | | of one | | | | | | | or more | | | | | | | entries | | | | | | | of the | | | | | | | \"list | | | | | | | of | | | | | | | su | | | | | | | bscriber | | | | | | | data\" | | | | | | | and | | | | | | | con | | | | | | | sidering | | | | | | | that | | | | | | | confi | | | | | | | guration | | | | | | | of SNPN | | | | | | | subs | | | | | | | cription | | | | | | | pa | | | | | | | rameters | | | | | | | in PLMN | | | | | | | via the | | | | | | | user | | | | | | | plane or | | | | | | | on | | | | | | | boarding | | | | | | | services | | | | | | | in SNPN | | | | | | | involves | | | | | | | third | | | | | | | party | | | | | | | entities | | | | | | | outside | | | | | | | of the | | | | | | | ope | | | | | | | rator\'s | | | | | | | network. | | | | | | | | | | | | | | NOTE 12: | | | | | | | In | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | access, | | | | | | | this | | | | | | | value | | | | | | | shall be | | | | | | | selected | | | | | | | when | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | RAT type | | | | | | | is | | | | | | | NR(MEO) | | | | | | | or | | | | | | | NR(GEO). | | | | | | +----------+----------+----------+----------+----------+----------+
## 10.3 Timers of 5GS session management
Timers of 5GS session management are shown in table 10.3.1 and table 10.3.2.
NOTE: Timer T3396 is defined in 3GPP TS 24.008 [12].
Table 10.3.1: Timers of 5GS session management -- UE side
+----------+----------+----------+----------+----------+----------+ | TIMER | TIMER | STATE | CAUSE OF | NORMAL | ON\ | | NUM. | VALUE | | START | STOP | THE\ | | | | | | | 1^st^, | | | | | | | 2^nd^, | | | | | | | 3^rd^, | | | | | | | 4^th^ | | | | | | | EXPIRY | | | | | | | (NOTE 1) | +----------+----------+----------+----------+----------+----------+ | T3580 | 16s | PDU | Tran | PDU | Retran | | | | SESSION | smission | SESSION | smission | | NOTE 4 | In | ACTIVE | of PDU | ESTAB | of PDU | | | WB-N1/CE | PENDING | SESSION | LISHMENT | SESSION | | NOTE 5 | mode, | | ESTAB | ACCEPT | ESTAB | | | 24s | | LISHMENT | message | LISHMENT | | | | | REQUEST | received | REQUEST | | | For | | message | or | message | | | access | | | | | | | via a | | | PDU | | | | s | | | SESSION | | | | atellite | | | ESTAB | | | | NG-RAN | | | LISHMENT | | | | cell, | | | REJECT | | | | 21s | | | message | | | | | | | received | | | | NOTE 7 | | | or | | | | | | | | | | | | | | PDU | | | | | | | SESSION | | | | | | | ESTAB | | | | | | | LISHMENT | | | | | | | REQUEST | | | | | | | message | | | | | | | received | | | | | | | in a DL | | | | | | | NAS | | | | | | | T | | | | | | | RANSPORT | | | | | | | message | | | | | | | with | | | | | | | 5GMM | | | | | | | cause | | | | | | | #22, | | | | | | | #28, | | | | | | | #65. | | | | | | | #67, | | | | | | | #69, | | | | | | | #90, | | | | | | | #91 or | | | | | | | #92 | | +----------+----------+----------+----------+----------+----------+ | T3581 | 16s | PDU | Tran | PDU | Retran | | | | SESSION | smission | SESSION | smission | | NOTE 4 | In | MODI | of PDU | MODI | of PDU | | | WB-N1/CE | FICATION | SESSION | FICATION | SESSION | | NOTE 5 | mode, | PENDING | MODI | COMMAND | MODI | | | 24s | | FICATION | message | FICATION | | | | | REQUEST | with the | REQUEST | | | For | | message | same PTI | message | | | access | | | is | | | | via a | | | received | | | | s | | | or PDU | | | | atellite | | | SESSION | | | | NG-RAN | | | MODI | | | | cell, | | | FICATION | | | | 21s | | | REJECT | | | | | | | message | | | | NOTE 7 | | | received | | | | | | | or | | | | | | | | | | | | | | PDU | | | | | | | SESSION | | | | | | | MODI | | | | | | | FICATION | | | | | | | REQUEST | | | | | | | message | | | | | | | received | | | | | | | in a DL | | | | | | | NAS | | | | | | | T | | | | | | | RANSPORT | | | | | | | message | | | | | | | with | | | | | | | 5GMM | | | | | | | cause | | | | | | | #22, | | | | | | | #28. | | | | | | | #67, | | | | | | | #69, or | | | | | | | #90 | | +----------+----------+----------+----------+----------+----------+ | T3582 | 16s | PDU | Tran | PDU | Retran | | | | SESSION | smission | SESSION | smission | | NOTE 4 | In | INACTIVE | of PDU | RELEASE | of PDU | | | WB-N1/CE | PENDING | SESSION | COMMAND | SESSION | | NOTE 5 | mode, | | RELEASE | message | RELEASE | | | 24s | | REQUEST | with the | REQUEST | | | | | message | same PTI | message | | | For | | | is | | | | access | | | received | | | | via a | | | or PDU | | | | s | | | SESSION | | | | atellite | | | RELEASE | | | | NG-RAN | | | REJECT | | | | cell, | | | message | | | | 21s | | | received | | | | | | | | | | | NOTE 7 | | | | | +----------+----------+----------+----------+----------+----------+ | T3583 | Default | PDU | UE | UE | On 1^st^ | | | 1 min. | SESSION | creates | deletes | expiry: | | | | ACTIVE | or | the | Deletion | | | NOTE 2 | | updates | derived | of the | | | | | a | QoS rule | derived | | | | | derived | (see | QoS rule | | | | | QoS rule | subcla | | | | | | | use 6.2. | | | | | | | 5.1.4.5) | | +----------+----------+----------+----------+----------+----------+ | T3584 | NOTE 3 | PDU | PDU | PDU | None | | | | SESSION | SESSION | SESSION | | | | | ACTIVE | ESTAB | RELEASE | | | | | PENDING | LISHMENT | COMMAND | | | | | | REJECT, | message | | | | | PDU | PDU | (see | | | | | SESSION | SESSION | NOTE 6) | | | | | MODI | MODI | or PDU | | | | | FICATION | FICATION | SESSION | | | | | PENDING | REJECT, | MODI | | | | | | or PDU | FICATION | | | | | PDU | SESSION | COMMAND | | | | | SESSION | RELEASE | message | | | | | ACTIVE | COMMAND | or PDU | | | | | or PDU | received | SESSION | | | | | SESSION | with | AUTHEN | | | | | INACTIVE | 5GSM | TICATION | | | | | PENDING | cause | COMMAND | | | | | | #67 and | message | | | | | | with a | or | | | | | | timer | DEREGI | | | | | | value | STRATION | | | | | | for | REQUEST | | | | | | T3584 | message | | | | | | | with the | | | | | | PDU | re-regi | | | | | | SESSION | stration | | | | | | ESTAB | type | | | | | | LISHMENT | \ | | | | | | REQUEST, | "re-regi | | | | | | or PDU | stration | | | | | | SESSION | re | | | | | | MODI | quired\" | | | | | | FICATION | | | | | | | REQUEST | | | | | | | received | | | | | | | in a DL | | | | | | | NAS | | | | | | | T | | | | | | | RANSPORT | | | | | | | message | | | | | | | with | | | | | | | 5GMM | | | | | | | cause | | | | | | | #67 and | | | | | | | with a | | | | | | | timer | | | | | | | value | | | | | | | for | | | | | | | T3584 | | | | | | | (see | | | | | | | subc | | | | | | | lause 5. | | | | | | | 4.5.3.3) | | | +----------+----------+----------+----------+----------+----------+ | T3585 | NOTE 3 | PDU | PDU | DU | None | | | | SESSION | SESSION | SESSION | | | | | ACTIVE | ESTAB | RELEASE | | | | | PENDING | LISHMENT | COMMAND | | | | | | REJECT, | message | | | | | PDU | PDU | (see | | | | | SESSION | SESSION | NOTE 6) | | | | | MODI | MODI | or PDU | | | | | FICATION | FICATION | SESSION | | | | | PENDING | REJECT, | MODI | | | | | | or PDU | FICATION | | | | | PDU | SESSION | COMMAND | | | | | SESSION | RELEASE | message | | | | | ACTIVE | COMMAND | or PDU | | | | | or PDU | received | SESSION | | | | | SESSION | with | AUTHEN | | | | | INACTIVE | 5GSM | TICATION | | | | | PENDING | cause | COMMAND | | | | | | #69 and | message | | | | | | with a | or | | | | | | timer | DEREGI | | | | | | value | STRATION | | | | | | for | REQUEST | | | | | | T3585 | message | | | | | | | with the | | | | | | PDU | re-regi | | | | | | SESSION | stration | | | | | | ESTAB | type | | | | | | LISHMENT | \ | | | | | | REQUEST, | "re-regi | | | | | | or PDU | stration | | | | | | SESSION | re | | | | | | MODI | quired\" | | | | | | FICATION | | | | | | | REQUEST | | | | | | | received | | | | | | | in a DL | | | | | | | NAS | | | | | | | T | | | | | | | RANSPORT | | | | | | | message | | | | | | | with | | | | | | | 5GMM | | | | | | | cause | | | | | | | #69 and | | | | | | | with a | | | | | | | timer | | | | | | | value | | | | | | | for | | | | | | | T | | | | | | | 3585(see | | | | | | | subc | | | | | | | lause 5. | | | | | | | 4.5.3.3) | | | +----------+----------+----------+----------+----------+----------+ | Back-off | | | defined | | | | timer | | | in | | | | | | | 3GPP | | | | | | | TS 24.00 | | | | | | | 8 [12] | | | +----------+----------+----------+----------+----------+----------+ | T3586\ | 8s | PDU | REMOTE | REMOTE | On the | | NOTE 4 | | SESSION | UE | UE | 1^st^ | | | In | ACTIVE | REPORT | REPORT | and | | NOTE 5 | WB-N1/CE | | message | RESPONSE | 2^nd^ | | | mode, | | sent | message | expiry, | | | 16s | | | received | retran | | | | | | | smission | | | For | | | | of | | | access | | | | REMOTE | | | via a | | | | UE | | | s | | | | REPORT | | | atellite | | | | message | | | NG-RAN | | | | | | | cell, | | | | On the | | | 13s | | | | 3^rd^ | | | | | | | expiry, | | | NOTE 7 | | | | the | | | | | | | p | | | | | | | rocedure | | | | | | | is | | | | | | | aborted | | | | | | | (see | | | | | | | sub | | | | | | | clause 6 | | | | | | | .6.2.4). | +----------+----------+----------+----------+----------+----------+ | T3587 | NOTE 8 | PDU | PDU | None | In | | | | SESSION | SESSION | | itiating | | | | ACTIVE | MODI | | a | | | | | FICATION | | request | | | | | COMMAND | | to join | | | | | message | | the | | | | | or PDU | | m | | | | | SESSION | | utlicast | | | | | ESTAB | | MBS | | | | | LISHMENT | | session | | | | | ACCEPT | | as | | | | | message | | sociated | | | | | received | | with the | | | | | with | | PDU | | | | | Received | | session | | | | | MBS | | if still | | | | | inf | | needed | | | | | ormation | | | | | | | that | | | | | | | includes | | | | | | | MBS | | | | | | | decision | | | | | | | set to | | | | | | | \"MBS | | | | | | | join is | | | | | | | re | | | | | | | jected\" | | | | | | | and | | | | | | | R | | | | | | | ejection | | | | | | | cause | | | | | | | set to | | | | | | | \"m | | | | | | | ulticast | | | | | | | MBS | | | | | | | session | | | | | | | has not | | | | | | | started | | | | | | | or will | | | | | | | not | | | | | | | start | | | | | | | soon\" | | | | | | | and an | | | | | | | MBS | | | | | | | back-off | | | | | | | timer | | | | | | | value | | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | Ty | | | | | | | pically, | | | | | | | the | | | | | | | pr | | | | | | | ocedures | | | | | | | are | | | | | | | aborted | | | | | | | on the | | | | | | | fifth | | | | | | | expiry | | | | | | | of the | | | | | | | relevant | | | | | | | timer. | | | | | | | Ex | | | | | | | ceptions | | | | | | | are | | | | | | | d | | | | | | | escribed | | | | | | | in the | | | | | | | corre | | | | | | | sponding | | | | | | | p | | | | | | | rocedure | | | | | | | desc | | | | | | | ription. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The | | | | | | | network | | | | | | | may | | | | | | | provide | | | | | | | the | | | | | | | value of | | | | | | | this | | | | | | | timer | | | | | | | ap | | | | | | | plicable | | | | | | | to the | | | | | | | derived | | | | | | | QoS | | | | | | | rules of | | | | | | | a | | | | | | | specific | | | | | | | PDU | | | | | | | session | | | | | | | as RQ | | | | | | | timer | | | | | | | value in | | | | | | | the PDU | | | | | | | SESSION | | | | | | | ESTAB | | | | | | | LISHMENT | | | | | | | ACCEPT | | | | | | | message | | | | | | | and PDU | | | | | | | SESSION | | | | | | | MODI | | | | | | | FICATION | | | | | | | COMMAND | | | | | | | message. | | | | | | | The | | | | | | | maximum | | | | | | | value of | | | | | | | the | | | | | | | timer is | | | | | | | 30 min. | | | | | | | If the | | | | | | | network | | | | | | | i | | | | | | | ndicates | | | | | | | a value | | | | | | | greater | | | | | | | than the | | | | | | | maximum | | | | | | | value, | | | | | | | then the | | | | | | | UE shall | | | | | | | use the | | | | | | | maximum | | | | | | | value. | | | | | | | | | | | | | | NOTE 3: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | provided | | | | | | | by the | | | | | | | network. | | | | | | | | | | | | | | NOTE 4: | | | | | | | In NB-N1 | | | | | | | mode, | | | | | | | then the | | | | | | | timer | | | | | | | value | | | | | | | shall be | | | | | | | ca | | | | | | | lculated | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | subclau | | | | | | | se 4.18. | | | | | | | | | | | | | | NOTE 5: | | | | | | | In WB-N1 | | | | | | | mode, if | | | | | | | the UE | | | | | | | supports | | | | | | | CE mode | | | | | | | B and | | | | | | | operates | | | | | | | in | | | | | | | either | | | | | | | CE mode | | | | | | | A or CE | | | | | | | mode B, | | | | | | | then the | | | | | | | timer | | | | | | | value is | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in this | | | | | | | table | | | | | | | for the | | | | | | | case of | | | | | | | WB-N1/CE | | | | | | | mode | | | | | | | (see | | | | | | | subclaus | | | | | | | e 4.20). | | | | | | | | | | | | | | NOTE 6: | | | | | | | If the | | | | | | | PDU | | | | | | | SESSION | | | | | | | RELEASE | | | | | | | COMMAND | | | | | | | message | | | | | | | includes | | | | | | | the | | | | | | | Back-off | | | | | | | timer | | | | | | | value IE | | | | | | | where | | | | | | | the | | | | | | | timer | | | | | | | value | | | | | | | i | | | | | | | ndicates | | | | | | | neither | | | | | | | zero nor | | | | | | | dea | | | | | | | ctivated | | | | | | | and the | | | | | | | 5GSM | | | | | | | cause is | | | | | | | not | | | | | | | #39, | | | | | | | the UE | | | | | | | then | | | | | | | starts | | | | | | | the | | | | | | | timer | | | | | | | with the | | | | | | | value | | | | | | | provided | | | | | | | in the | | | | | | | Back-off | | | | | | | timer | | | | | | | value IE | | | | | | | after | | | | | | | stopping | | | | | | | the | | | | | | | existing | | | | | | | timer | | | | | | | (see | | | | | | | sub | | | | | | | clause 6 | | | | | | | .3.3.3). | | | | | | | | | | | | | | NOTE 7: | | | | | | | In | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | access, | | | | | | | this | | | | | | | value | | | | | | | shall be | | | | | | | selected | | | | | | | when | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | RAT type | | | | | | | is | | | | | | | NR(MEO) | | | | | | | or | | | | | | | NR(GEO). | | | | | | | | | | | | | | NOTE 8: | | | | | | | The | | | | | | | value of | | | | | | | this | | | | | | | timer is | | | | | | | provided | | | | | | | by the | | | | | | | network | | | | | | | in the | | | | | | | Received | | | | | | | MBS | | | | | | | c | | | | | | | ontainer | | | | | | | IE (see | | | | | | | su | | | | | | | bclause | | | | | | | 6.3.2.3, | | | | | | | s | | | | | | | ubclause | | | | | | | 6.4.1.3 | | | | | | | and | | | | | | | subcl | | | | | | | ause 9.1 | | | | | | | 1.4.31). | | | | | | +----------+----------+----------+----------+----------+----------+
NOTE 1: The back-off timer is used to describe a logical model of the required
UE behaviour. This model does not imply any specific implementation, e.g. as a
timer of timestamp.
NOTE 2: Reference to back-off timer in this section can either refer to use of
timer T3396 or to use of a different packet system specific timer within the
UE. Whether the UE uses T3396 as a back-off timer or it uses different packet
system specific timers as back-off timers is left up to UE implementation.
Table 10.3.2: Timers of 5GS session management -- SMF side
+----------+----------+----------+----------+----------+----------+ | TIMER | TIMER | STATE | CAUSE OF | NORMAL | ON\ | | NUM. | VALUE | | START | STOP | THE\ | | | | | | | 1^st^, | | | | | | | 2^nd^, | | | | | | | 3^rd^, | | | | | | | 4^th^ | | | | | | | EXPIRY | | | | | | | (NOTE 1) | +----------+----------+----------+----------+----------+----------+ | T3590 | 15s | P | Tran | PDU | Retran | | | | ROCEDURE | smission | SESSION | smission | | NOTE 3 | In | TRA | of PDU | AUTHEN | of PDU | | | WB-N1/CE | NSACTION | SESSION | TICATION | SESSION | | NOTE 4 | mode, | PENDING | AUTHEN | COMPLETE | AUTHEN | | | 23s | | TICATION | message | TICATION | | | | | COMMAND | received | COMMAND | | | For | | message | | message | | | access | | | | | | | via a | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | cell, | | | | | | | 21s | | | | | | | | | | | | | | NOTE 5 | | | | | +----------+----------+----------+----------+----------+----------+ | T3591 | 16s | PDU | Tran | PDU | Retran | | | | SESSION | smission | SESSION | smission | | NOTE 3 | In | MODI | of PDU | MODI | of PDU | | | WB-N1/CE | FICATION | SESSION | FICATION | SESSION | | NOTE 4 | mode, | PENDING | MODI | COMPLETE | MODI | | | 24s | | FICATION | message | FICATION | | | | | COMMAND | received | COMMAND | | | For | | message | or PDU | message | | | access | | | SESSION | | | | via a | | | MODI | | | | s | | | FICATION | | | | atellite | | | COMMAND | | | | NG-RAN | | | REJECT | | | | cell, | | | message | | | | 22s | | | received | | | | | | | | | | | NOTE 5 | | | | | +----------+----------+----------+----------+----------+----------+ | T3592 | 16s | PDU | Tran | PDU | Retran | | | | SESSION | smission | SESSION | smission | | NOTE 3 | In | INACTIVE | of PDU | RELEASE | of PDU | | | WB-N1/CE | PENDING | SESSION | COMPLETE | SESSION | | NOTE 4 | mode, | | RELEASE | message | RELEASE | | | 24s | | COMMAND | received | COMMAND | | | | | message | or | message | | | For | | | | | | | access | | | N1 SM | | | | via a | | | delivery | | | | s | | | skipped | | | | atellite | | | in | | | | NG-RAN | | | dication | | | | cell, | | | received | | | | 22s | | | | | | | | | | | | | | NOTE 5 | | | | | +----------+----------+----------+----------+----------+----------+ | T3593 | Default | PDU | R | PDU | N | | | | SESSION | eception | SESSION | etwork-r | | NOTE 3 | 60s | MODI | of PDU | RELEASE | equested | | | | FICATION | SESSION | REQUEST | PDU | | NOTE 4 | (NOTE 2) | PENDING | MODI | message | session | | | | | FICATION | received | release | | | | | COMPLETE | | p | | | | | message | | rocedure | | | | | for | | p | | | | | tra | | erformed | | | | | nsmitted | | | | | | | PDU | | | | | | | SESSION | | | | | | | MODI | | | | | | | FICATION | | | | | | | COMMAND | | | | | | | message | | | | | | | where | | | | | | | the PDU | | | | | | | SESSION | | | | | | | MODI | | | | | | | FICATION | | | | | | | COMMAND | | | | | | | message | | | | | | | included | | | | | | | 5GSM | | | | | | | cause | | | | | | | #39 | | | +----------+----------+----------+----------+----------+----------+ | T3594 | 15s | P | Tran | SERVI | Retran | | | | ROCEDURE | smission | CE-LEVEL | smission | | NOTE 3 | In | TRA | of | AUTHEN | of | | | WB-N1/CE | NSACTION | SERVI | TICATION | SERVI | | NOTE 4 | mode, | PENDING | CE-LEVEL | COMPLETE | CE-LEVEL | | | 23s | | AUTHEN | message | AUTHEN | | | | | TICATION | received | TICATION | | | For | | COMMAND | | COMMAND | | | access | | message | | message | | | via a | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | cell, | | | | | | | 21s | | | | | | | | | | | | | | NOTE 5 | | | | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | Ty | | | | | | | pically, | | | | | | | the | | | | | | | pr | | | | | | | ocedures | | | | | | | are | | | | | | | aborted | | | | | | | on the | | | | | | | fifth | | | | | | | expiry | | | | | | | of the | | | | | | | relevant | | | | | | | timer. | | | | | | | Ex | | | | | | | ceptions | | | | | | | are | | | | | | | d | | | | | | | escribed | | | | | | | in the | | | | | | | corre | | | | | | | sponding | | | | | | | p | | | | | | | rocedure | | | | | | | desc | | | | | | | ription. | | | | | | | | | | | | | | NOTE 2: | | | | | | | If the | | | | | | | PDU | | | | | | | Session | | | | | | | Address | | | | | | | Lifetime | | | | | | | value is | | | | | | | sent to | | | | | | | the UE | | | | | | | in the | | | | | | | PDU | | | | | | | SESSION | | | | | | | MODI | | | | | | | FICATION | | | | | | | COMMAND | | | | | | | message | | | | | | | then | | | | | | | timer | | | | | | | T3593 | | | | | | | shall be | | | | | | | started | | | | | | | with the | | | | | | | same | | | | | | | value, | | | | | | | o | | | | | | | therwise | | | | | | | it shall | | | | | | | use a | | | | | | | default | | | | | | | value. | | | | | | | | | | | | | | NOTE 3: | | | | | | | In NB-N1 | | | | | | | mode, | | | | | | | the | | | | | | | timer | | | | | | | value | | | | | | | shall be | | | | | | | ca | | | | | | | lculated | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in | | | | | | | subclau | | | | | | | se 4.18. | | | | | | | | | | | | | | NOTE 4: | | | | | | | In WB-N1 | | | | | | | mode, if | | | | | | | the UE | | | | | | | supports | | | | | | | CE mode | | | | | | | B and | | | | | | | operates | | | | | | | in | | | | | | | either | | | | | | | CE mode | | | | | | | A or CE | | | | | | | mode B, | | | | | | | then the | | | | | | | timer | | | | | | | value is | | | | | | | as | | | | | | | d | | | | | | | escribed | | | | | | | in this | | | | | | | table | | | | | | | for the | | | | | | | case of | | | | | | | WB-N1/CE | | | | | | | mode | | | | | | | (see | | | | | | | subclaus | | | | | | | e 4.20). | | | | | | | | | | | | | | NOTE 5: | | | | | | | In | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | access, | | | | | | | this | | | | | | | value | | | | | | | shall be | | | | | | | selected | | | | | | | when | | | | | | | s | | | | | | | atellite | | | | | | | NG-RAN | | | | | | | RAT type | | | | | | | is | | | | | | | NR(MEO) | | | | | | | or | | | | | | | NR(GEO). | | | | | | +----------+----------+----------+----------+----------+----------+
10.4
###### ## Annex A (informative): Cause values for 5GS mobility management
# A.1 Causes related to UE identification
Cause #3 -- Illegal UE
This 5GMM cause is sent to the UE when the network refuses service to the UE
either because an identity of the UE is not acceptable to the network or
because the UE does not pass the authentication check.
Cause #6 -- Illegal ME
This 5GMM cause is sent to the UE if the ME used is not acceptable to the
network, e.g. on the prohibited list.
Cause #9 -- UE identity cannot be derived by the network.
This 5GMM cause is sent to the UE when the network cannot derive the UE\'s
identity from the 5G-GUTI or 5G-S-TMSI because of e.g. no matching
identity/context in the network, failure to validate the UE\'s identity due to
integrity check failure of the received message.
Cause #10 -- Implicitly de-registered
This 5GMM cause is sent to the UE either if the network has implicitly de-
registered the UE, e.g. after the implicit de-registration timer has expired,
or if the 5GMM context data related to the subscription does not exist in the
AMF e.g. because of a AMF restart, or because of a registration request for
mobility or registration update is routed to a new AMF.
# A.2 Cause related to subscription options
Cause #5 -- PEI not accepted
This cause is sent to the UE if the network does not accept an initial
registration procedure for emergency services using a PEI.
Cause #7 -- 5GS services not allowed
This 5GMM cause is sent to the UE when it is not allowed to operate 5GS
services.
Cause #11 -- PLMN not allowed
This 5GMM cause is sent to the UE if it requests service, or if the network
initiates a de-registration request, in a PLMN where the UE, by subscription
or due to operator determined barring, is not allowed to operate.
This 5GMM cause can also be sent to the UE when the disaster condition is no
longer being applicable in the current location of the UE.
Cause #12 -- Tracking area not allowed
This 5GMM cause is sent to the UE if it requests service, or if the network
initiates a de-registration request, in a tracking area where the HPLMN or
SNPN determines that the UE, by subscription, is not allowed to operate.
NOTE 1: If 5GMM cause #12 is sent to a roaming subscriber the subscriber is
denied service even if other PLMNs are available on which registration was
possible.
Cause #13 -- Roaming not allowed in this tracking area
This 5GMM cause is sent to a UE which requests service, or if the network
initiates a de-registration request, in a tracking area of a PLMN or SNPN
which by subscription offers roaming to that UE but not in that tracking area.
This 5GMM cause can also be sent to the UE when the disaster condition is no
longer being applicable in the current location of the UE.
NOTE 2: The network does not send 5GMM cause value #13 to the UE operating in
SNPN access operation mode in this release of specification.
Cause #15 -- No suitable cells in tracking area
This 5GMM cause is sent to the UE if it requests service, or if the network
initiates a de-registration request, in a tracking area where the UE, by
subscription, is not allowed to operate, but when it should find another
allowed tracking area in the same PLMN or an equivalent PLMN or the same SNPN.
NOTE 3: Cause #15 and cause #12 differ in the fact that cause #12 does not
trigger the UE to search for another allowed tracking area on the same PLMN or
SNPN.
Cause #27 -- N1 mode not allowed
This 5GMM cause is sent to the UE if it requests service, or if the network
initiates a de-registration request, in a PLMN or SNPN where the UE by
subscription or operator policy, is not allowed to operate in N1 mode.
Cause #31 -- Redirection to EPC required
This 5GMM cause is sent to the UE if it requests service in a PLMN where the
UE by operator policy, is not allowed in 5GCN and redirection to EPC is
required.
Cause #36 -- IAB-node operation not authorized
This 5GMM cause is sent to the UE if a UE operating as an IAB-node requests
service, or if the network initiates a de-registration procedure, in a PLMN or
SNPN where the UE by subscription is not authorized for IAB operation.
Cause #72 -- Non-3GPP access to 5GCN not allowed
This 5GMM cause is sent to the UE if it requests accessing 5GCN over non-3GPP
access in a PLMN or SNPN, where the UE by subscription, is not allowed to
access 5GCN over non-3GPP access.
NOTE 3: The term \"non-3GPP access\" in an SNPN refers to the case where the
UE is accessing SNPN services via a PLMN.
Cause #74 -- Temporarily not authorized for this SNPN
This 5GMM cause is sent to the UE if it requests access, or if the network
initiates a de-registration procedure, in a cell belonging to an SNPN for
which the UE has no subscription to operate or for which the UE is not allowed
to operate onboarding services.
Cause #75 -- Permanently not authorized for this SNPN
This 5GMM cause is sent to the UE if it requests access, or if the network
initiates a de-registration procedure, in a cell belonging to an SNPN with a
globally-unique SNPN identity for which the UE either has no subscription to
operate, the UE\'s subscription has expired or the UE is not allowed to
operate onboarding services.
Cause #76 -- Not authorized for this CAG or authorized for CAG cells only
This 5GMM cause is sent to the UE if the UE requests access or de-
registration:
i) in a CAG cell with a CAG-ID which is not included in the UE\'s \"allowed
CAG list\" for the PLMN; or
ii) in a non-CAG cell, wherein the UE is only allowed to access 5GS via CAG
cells
Cause #77 -- Wireline access area not allowed
This 5GMM cause is sent to the 5G-RG or the W-AGF acting on behalf of the FN-
CRG (or on behalf of the N5GC device) if the 5G-RG or the W-AGF acting on
behalf of the FN-CRG (or on behalf of the N5GC device) request accessing 5GCN
over a wireline access network belonging to a wireline access area, where the
5G-RG or the W-AGF acting on behalf of the FN-CRG (or on behalf of the N5GC
device) are not allowed by subscription to access the 5GCN over the wireline
access.
Cause #79 -- UAS services not allowed
This 5GMM cause is sent to the UE to indicate that the request of UAS services
is not allowed.
Cause #80 -- Disaster roaming for the determined PLMN with disaster condition
not allowed
This 5GMM cause is sent by the network in a PLMN where the UE has requested
registration for disaster roaming services for the determined PLMN with
disaster condition, but the AMF determines that it does not support providing
disaster roaming services to the UE for the determined PLMN with disaster
condition as roaming agreement for disaster roaming services with HPLMN of the
UE does not exist, or the determined PLMN with disaster condition is a
forbidden PLMN of the UE.
# A.3 Causes related to PLMN or SNPN specific network failures and
congestion/authentication failures
Cause #20 -- MAC failure
This 5GMM cause is sent to the network if the USIM detects that the MAC in the
AUTHENTICATION REQUEST message is not fresh.
Cause #21 -- Synch failure
This 5GMM cause is sent to the network if the USIM detects that the SQN in the
AUTHENTICATION REQUEST message is out of range.
Cause #22 -- Congestion
This 5GMM cause is sent to the UE because of congestion in the network (e.g.
no channel, facility busy/congested etc.).
Cause #23 -- UE security capabilities mismatch
This 5GMM cause is sent to the network if the UE detects that the UE security
capability does not match the one sent back by the network.
Cause #24 -- Security mode rejected, unspecified
This 5GMM cause is sent to the network if the security mode command is
rejected by the UE for unspecified reasons.
Cause #26 -- Non-5G authentication unacceptable
This 5GMM cause is sent to the network in N1 mode if the \"separation bit\" in
the AMF field of AUTN is set to 0 in the AUTHENTICATION REQUEST message (see
3GPP TS 33.501 [24]).
Cause #28 -- Restricted service area
This 5GMM cause is sent to the UE if it requests service in a tracking area of
the 3GPP access or in an area of the wireline access, which is a part of the
UE\'s non-allowed area or is not a part of the UE\'s allowed area.
Cause #43 -- LADN not available
This 5GMM cause is sent to the UE if the user-plane resources of the PDU
session are not established when the UE is located outside the LADN service
area.
Cause #62 -- No network slices available
This 5GMM cause is sent by the network if none of the requested network
slice(s) in the registration request are allowed and there are no default
network slice(s) configured in the network.
NOTE: Network does not send this cause in REGISTRATION REJECT message if the
UE does not include a requested NSSAI in the REGISTRATION REQUEST message. In
that case, if the UE is not registered for onboarding services in SNPN, the
network uses other causes (e.g. #13, #15, etc.) based on the subscription.
Cause #65 -- Maximum number of PDU sessions reached
This 5GMM cause is used by the network to indicate that the procedure
requested by the UE was rejected as the network has reached the maximum number
of simultaneously active PDU sessions for the UE.
Cause #67 -- Insufficient resources for specific slice and DNN
This 5GMM cause is sent by the network to indicate that the requested service
cannot be provided due to insufficient resources for specific slice and DNN.
Cause #69 -- Insufficient resources for specific slice
This 5GMM cause is sent by the network to indicate that the requested service
cannot be provided due to insufficient resources for specific slice.
Cause #71 -- ngKSI already in use
This 5GMM cause is sent to the network in N1 mode if the ngKSI value received
in the AUTHENTICATION REQUEST message is already associated with one of the 5G
security contexts stored in the UE.
Cause #73 -- Serving network not authorized
This 5GMM cause is sent to the UE if the UE initiates registration towards a
serving network and the serving network fails to be authorized by the UE\'s
home network.
Cause #78 --PLMN not allowed to operate at the present UE location
This 5GMM cause is sent to the UE to indicate that the PLMN is not allowed to
operate at the present UE location.
NOTE: This cause is only applicable for satellite NG-RAN access.
Cause #90 -- Payload was not forwarded
This 5GMM cause is sent by the network to indicate that the requested service
cannot be provided because payload could not be forwarded by AMF.
Cause #91 -- DNN not supported or not subscribed in the slice
This 5GMM cause is sent by the network to indicate that the requested service
cannot be provided because payload could not be forwarded by AMF because the
DNN is not supported or not subscribed in the slice selected by the network if
the UE did not indicate a slice, or the DNN is not supported or not subscribed
in the slice indicated by the UE.
Cause #92 -- Insufficient user-plane resources for the PDU session
This 5GMM cause is sent by the network to indicate that the requested service
cannot be provided due to insufficient user-plane resources for the PDU
session.
Cause #93 -- Onboarding services terminated
This 5GMM cause is sent by the network if the network initiates a de-
registration procedure because the onboarding services are terminated.
# A.4 Causes related to invalid messages
Cause #95 -- Semantically incorrect message
This 5GMM cause is used to report receipt of a message with semantically
incorrect contents.
Cause #96 -- Invalid mandatory information
This cause 5GMM indicates that the equipment sending this 5GMM cause has
received a message with a non-semantical mandatory IE error.
Cause #97 -- Message type non-existent or not implemented
This 5GMM cause indicates that the equipment sending this 5GMM cause has
received a message with a message type it does not recognize either because
this is a message not defined, or defined but not implemented by the equipment
sending this 5GMM cause.
Cause #98 -- Message type not compatible with protocol state
This 5GMM cause indicates that the equipment sending this 5GMM cause has
received a message not compatible with the protocol state.
Cause #99 -- Information element non-existent or not implemented
This 5GMM cause indicates that the equipment sending this 5GMM cause has
received a message which includes information elements not recognized because
the information element identifier is not defined or it is defined but not
implemented by the equipment sending the 5GMM cause. However, the information
element is not required to be present in the message in order for the
equipment sending the 5GMM cause to process the message.
Cause #100 -- Conditional IE error
This 5GMM cause indicates that the equipment sending this cause has received a
message with conditional IE errors.
Cause #101 -- Message not compatible with protocol state
This 5GMM cause indicates that a message has been received which is
incompatible with the protocol state.
Cause #111 -- Protocol error, unspecified
This 5GMM cause is used to report a protocol error event only when no other
5GMM cause in the protocol error class applies.
###### ## Annex B (informative): Cause values for 5GS session management
# B.1 Causes related to nature of request
Cause #8 -- Operator Determined Barring
This 5GSM cause is used by the network to indicate that the requested service
was rejected by the SMF due to Operator Determined Barring.
Cause #26 -- Insufficient resources
This 5GSM cause is used by the UE or by the network to indicate that the
requested service cannot be provided due to insufficient resources.
Cause #27 -- Missing or unknown DNN
This 5GSM cause is used by the network to indicate that the requested service
was rejected by the external DN because the DNN was not included although
required or if the DNN could not be resolved.
Cause #28 -- Unknown PDU session type
This 5GSM cause is used by the network to indicate that the requested service
was rejected by the external DN because the requested PDU session type could
not be recognised or is not allowed.
Cause #29 -- User authentication or authorization failed
This 5GSM cause is used by the network to indicate that the requested service
was rejected by the external DN due to a failed user authentication, revoked
by the external DN, or rejected by 5GCN due to a failed user authentication or
authorization.
Cause #31 -- Request rejected, unspecified
This 5GSM cause is used by the network or by the UE to indicate that the
requested service or operation or the request for a resource was rejected due
to unspecified reasons.
Cause #32 -- Service option not supported
This 5GSM cause is used by the network when the UE requests a service which is
not supported by the PLMN.
Cause #33 -- Requested service option not subscribed
This 5GSM cause is sent when the UE requests a service option for which it has
no subscription.
Cause #35 -- PTI already in use
This 5GSM cause is used by the network to indicate that the PTI included by
the UE is already in use by another active UE requested procedure for this UE.
Cause #36 -- Regular deactivation
This 5GSM cause is used to indicate a regular UE or network initiated release
of PDU session resources.
Cause #37 -- 5GS QoS not accepted
This 5GSM cause is used by the network if the new 5GS QoS that was indicated
in the UE request cannot be accepted.
Cause #38 -- Network failure
This 5GSM cause is used by the network to indicate that the requested service
was rejected due to an error situation in the network.
Cause #39 -- Reactivation requested
This 5GSM cause is used by the network to request a PDU session reactivation.
Cause #41 -- Semantic error in the TFT operation
This 5GSM cause is used by the UE to indicate a semantic error in the TFT
operation included in the request.
Cause #42 -- Syntactical error in the TFT operation
This 5GSM cause is used by the UE to indicate a syntactical error in the TFT
operation included in the request.
Cause #43 -- Invalid PDU session identity
This 5GSM cause is used by the network or the UE to indicate that the PDU
session identity value provided to it is not a valid value or the PDU session
identified by the PDU session identity IE in the request or the command is not
active.
Cause #44 -- Semantic errors in packet filter(s)
This 5GSM cause is used by the network or the UE to indicate that the
requested service was rejected due to one or more semantic errors in packet
filter(s) of the QoS rule included in the request.
Cause #45 -- Syntactical error in packet filter(s)
This 5GSM cause is used by the network or the UE to indicate that the
requested service was rejected due to one or more syntactical errors in packet
filter(s) of the QoS rule included in the request.
Cause #46 -- Out of LADN service area
This 5GSM cause is used by the network to indicate the UE is out of the LADN
service area.
Cause #47 -- PTI mismatch
This 5GSM cause is used by the network or UE to indicate that the PTI provided
to it does not match any PTI in use.
Cause #50 -- PDU session type IPv4 only allowed
This 5GSM cause is used by the network to indicate that only PDU session type
IPv4 is allowed for the requested IP connectivity.
Cause #51 -- PDU session type IPv6 only allowed
This 5GSM cause is used by the network to indicate that only PDU session type
IPv6 is allowed for the requested IP connectivity.
Cause #54 -- PDU session does not exist
This 5GSM cause is used by the network at handover of a PDU session between
non-3GPP access and 3GPP access, or at interworking of a PDN connection from
non-3GPP access network connected to EPC or from E-UTRAN connected to EPC to a
PDU session, to indicate that the network does not have any information about
the requested PDU session.
Cause #57 -- PDU session type IPv4v6 only allowed
This 5GSM cause is used by the network to indicate that only PDU session types
IPv4, IPv6 or IPv4v6 are allowed for the requested IP connectivity.
Cause #58 -- PDU session type Unstructured only allowed
This 5GSM cause is used by the network to indicate that only PDU session type
Unstructured is allowed for the requested DN connectivity.
Cause #59 -- Unsupported 5QI value
This 5GSM cause is used by the network if the 5QI indicated in the UE request
cannot be supported.
Cause #61 -- PDU session type Ethernet only allowed
This 5GSM cause is used by the network to indicate that only PDU session type
Ethernet is allowed for the requested DN connectivity.
Cause #67 -- Insufficient resources for specific slice and DNN
This 5GSM cause is by the network to indicate that the requested service
cannot be provided due to insufficient resources for specific slice and DNN.
Cause #68 -- Not supported SSC mode
This 5GSM cause is used by the network to indicate that the requested SSC mode
is not supported.
Cause #69 -- Insufficient resources for specific slice
This 5GSM cause is used by the network to indicate that the requested service
cannot be provided due to insufficient resources for specific slice, maximum
number of PDU sessions on a specific slice has been already reached, data rate
on a specific slice has been exceeded, or UE-Slice-MBR has been exceeded.
Cause #70 -- Missing or unknown DNN in a slice
This 5GSM cause is used by the network to indicate that the requested service
was rejected by the external DN because the DNN was not included although
required or if the DNN could not be resolved, in the slice.
Cause #81 -- Invalid PTI value
This 5GSM cause is used by the network or UE to indicate that the PTI provided
to it is invalid for the specific 5GSM message.
Cause #82 -- Maximum data rate per UE for user-plane integrity protection is
too low
This 5GSM cause is used by the network to indicate that the requested service
cannot be provided because the maximum data rate per UE for user-plane
integrity protection is too low.
Cause #83 -- Semantic error in the QoS operation
This 5GSM cause is used by the network or the UE to indicate that the
requested service was rejected due to a semantic error in the QoS operation
included in the request.
Cause #84 -- Syntactical error in the QoS operation
This 5GSM cause is used by the network or the UE to indicate that the
requested service was rejected due to a syntactical error in the QoS operation
included in the request.
Cause #85 -- Invalid mapped EPS bearer identity
This 5GSM cause is used by the network or the UE to indicate that the mapped
EPS bearer identity value provided to it is not a valid value or the mapped
EPS bearer identified by the mapped EPS bearer identity does not exist.
Cause #86 -- UAS services not allowed
This 5GSM cause is used by the network to indicate that the requested UAS
services are not allowed.
# B.2 Protocol errors (e.g., unknown message)
Cause #95 -- Semantically incorrect message
This 5GSM cause is used to report receipt of a message with semantically
incorrect contents.
Cause #96 -- Invalid mandatory information
This 5GSM cause indicates that the equipment sending this 5GSM cause has
received a message with a non-semantical mandatory IE error.
Cause #97 -- Message type non-existent or not implemented
This 5GSM cause indicates that the equipment sending this 5GSM cause has
received a message with a message type it does not recognize either because
this is a message not defined, or defined but not implemented by the equipment
sending this 5GSM cause.
Cause #98 -- Message type not compatible with protocol state
This 5GSM cause indicates that the equipment sending this 5GSM cause has
received a message not compatible with the protocol state.
Cause #99 -- Information element non-existent or not implemented
This 5GSM cause indicates that the equipment sending this 5GSM cause has
received a message which includes information elements not recognized because
the information element identifier is not defined or it is defined but not
implemented by the equipment sending the 5GSM cause. However, the information
element is not required to be present in the message in order for the
equipment sending the 5GSM cause to process the message.
Cause #100 -- Conditional IE error
This 5GSM cause indicates that the equipment sending this cause has received a
message with conditional IE errors.
Cause #101 -- Message not compatible with protocol state
This 5GSM cause indicates that a message has been received which is
incompatible with the protocol state.
Cause #111 -- Protocol error, unspecified
This 5GSM cause is used to report a protocol error event only when no other
5GSM cause in the protocol error class applies.
###### ## Annex C (normative): Storage of 5GMM information
# C.1 Storage of 5GMM information for UEs not operating in SNPN access
operation mode
The following 5GMM parameters shall be stored on the USIM if the corresponding
file is present:
a) 5G-GUTI;
b) last visited registered TAI;
c) 5GS update status;
d) 5G NAS security context parameters from a full native 5G NAS security
context (see 3GPP TS 33.501 [24]);
e) K~AUSF~ and K~SEAF~ (see 3GPP TS 33.501 [24]);
f) SOR counter (see subclause 9.11.3.51); and
g) UE parameter update counter (see subclause 9.11.3.53A);
The UE may support multiple records of NAS security context storage for
multiple registration (see 3GPP TS 31.102 [22]). If the UE supports multiple
records of NAS security context storage for multiple registration, the first
5G security context of one access shall be stored in record 1 of the 5G NAS
Security Context USIM file for that access and the second 5G security context
of that access shall be stored in record 2 of the same file. The presence and
format of corresponding files on the USIM is specified in 3GPP TS 31.102 [22].
If the corresponding file is not present on the USIM, these 5GMM parameters
are stored in a non-volatile memory in the ME together with the SUPI from the
USIM. These 5GMM parameters can only be used if the SUPI from the USIM matches
the SUPI stored in the non-volatile memory; else the UE shall delete the 5GMM
parameters.
The following 5GMM parameters shall be stored in a non-volatile memory in the
ME together with the SUPI from the USIM:
\- configured NSSAI(s);
\- NSSRG information;
\- NSSAI inclusion mode(s);
\- MPS indicator;
\- MCS indicator;
\- operator-defined access category definitions;
\- network-assigned UE radio capability IDs;
\- \"CAG information list\", if the UE supports CAG;
\- signalled URSP (see 3GPP TS 24.526 [19]);
\- SOR-CMCI;
\- one or more lists of type \"list of PLMN(s) to be used in disaster
condition\", if the UE supports MINT;
\- disaster roaming wait range, if the UE supports MINT;
\- disaster return wait range, if the UE supports MINT;
\- indication of whether disaster roaming is enabled in the UE; and
\- indication of \'applicability of \"lists of PLMN(s) to be used in disaster
condition\" provided by a VPLMN\'.
The following 5GMM parameters should be stored in a non-volatile memory in the
ME together with the SUPI from the USIM:
\- allowed NSSAI(s).
Each configured NSSAI consists of S-NSSAI(s) stored together with a PLMN
identity, if it is associated with a PLMN. The UE shall store the S-NSSAI(s)
of the HPLMN. If the UE is in the VPLMN, the UE shall also store the
configured NSSAI for the current PLMN and any necessary mapped S-NSSAI(s). The
configured NSSAI(s) can only be used if the SUPI from the USIM matches the
SUPI stored in the non-volatile memory of the ME; else the UE shall delete the
configured NSSAI(s). A configured NSSAI may be associated with NSSRG
information.
Each NSSAI inclusion mode is associated with a PLMN identity and access type.
The NSSAI inclusion mode(s) can only be used if the SUPI from the USIM matches
the SUPI stored in the non-volatile memory of the ME; else the UE shall delete
the NSSAI inclusion mode(s).
The MPS indicator is stored together with a PLMN identity of the PLMN that
provided it, and is valid in that RPLMN or equivalent PLMN. The MPS indicator
can only be used if the SUPI from the USIM matches the SUPI stored in the non-
volatile memory of the ME, else the UE shall delete the MPS indicator.
The MCS indicator is stored together with a PLMN identity of the PLMN that
provided it, and is valid in that RPLMN or equivalent PLMN. The MCS indicator
can only be used if the SUPI from the USIM matches the SUPI stored in the non-
volatile memory of the ME, else the UE shall delete the MCS indicator.
Operator-defined access category definitions are stored together with a PLMN
identity of the PLMN that provided them, and is valid in that PLMN or
equivalent PLMN. The operator-defined access category definitions can only be
used if the SUPI from the USIM matches the SUPI stored in the non-volatile
memory of the ME, else the UE shall delete the operator-defined access
category definitions. The maximum number of stored operator-defined access
category definitions is UE implementation dependent.
Each network-assigned UE radio capability ID is stored together with a PLMN
identity of the PLMN that provided it as well as a mapping to the
corresponding UE radio configuration, and is valid in that PLMN. A network-
assigned UE radio capability ID can only be used if the SUPI from the USIM
matches the SUPI stored in the non-volatile memory of the ME, else the UE
shall delete the network-assigned UE radio capability ID. The UE shall be able
to store at least the last 16 received network-assigned UE radio capability
IDs. There shall be only one network-assigned UE radio capability ID stored
for a given combination of PLMN identity and UE radio configuration and any
existing UE radio capability ID shall be deleted when a new UE radio
capability ID is added for the same combination of PLMN identity and UE radio
configuration. If the UE receives a network-assigned UE radio capability ID
with a Version ID value different from the value included in the network-
assigned UE radio capability ID(s) stored at the UE for the serving PLMN, the
UE may delete these stored network-assigned UE radio capability ID(s).
The allowed NSSAI(s) can be stored in a non-volatile memory in the ME together
with the SUPI from the USIM. Allowed NSSAI consists of S-NSSAI(s) stored
together with a PLMN identity, if it is associated with a PLMN. If the allowed
NSSAI is stored, then the UE shall store the S-NSSAI(s) of the HPLMN. If the
UE is in the VPLMN, the UE shall also store the allowed NSSAI for the serving
PLMN and any necessary mapping of the allowed NSSAI for the serving PLMN to
the S-NSSAI(s) of the HPLMN. The allowed NSSAI(s) can only be used if the SUPI
from the USIM matches the SUPI stored in the non-volatile memory of the ME;
else the UE shall delete the allowed NSSAI(s).
If the UE is registered for emergency services, the UE shall not store the
5GMM parameters described in this annex on the USIM or in non-volatile memory.
Instead the UE shall temporarily store these parameters locally in the ME and
the UE shall delete these parameters when the UE is deregistered.
If the UE is configured for eCall only mode as specified in 3GPP TS 31.102
[22], the UE shall not store the 5GMM parameters described in this annex on
the USIM or in non-volatile memory. Instead the UE shall temporarily store
these parameters locally in the ME and the UE shall delete these parameters
when the UE enters 5GMM-DEREGISTERED.eCALL-INACTIVE state, the UE is switched-
off or the USIM is removed.
The \"CAG information list\" can only be used if the SUPI from the USIM
matches the SUPI stored in the non-volatile memory of the ME; else the UE
shall delete the \"CAG information list\".
The handling of the SOR-CMCI stored in the non-volatile memory in the ME is
specified in 3GPP TS 23.122 [5].
Each \"list of PLMN(s) to be used in disaster condition\" is stored together
with the PLMN identity of the PLMN that provided it. The stored lists of type
\"list of PLMN(s) to be used in disaster condition\" can only be used if the
SUPI from the USIM matches the SUPI stored in the non-volatile memory of the
ME; else the UE shall delete the lists of type \"list of PLMN(s) to be used in
disaster condition\". The UE shall store at least the \"list of PLMN(s) to be
used in disaster condition\" provided by the HPLMN or EHPLMN. If the
\'applicability of \"lists of PLMN(s) to be used in disaster condition\"
provided by a VPLMN\' is set to \"true\", the UE should also store the \"list
of PLMN(s) to be used in disaster condition\" provided by the VPLMN. The
maximum number of stored lists of type \"list of PLMN(s) to be used in
disaster condition\" provided by a PLMN other than the HPLMN or EHPLMN is UE
implementation dependent.
The disaster roaming wait range can only be used if the SUPI from the USIM
matches the SUPI stored in the non-volatile memory of the ME; else the UE
shall delete the disaster roaming wait range.
The disaster return wait range can only be used if the SUPI from the USIM
matches the SUPI stored in the non-volatile memory of the ME; else the UE
shall delete the disaster return wait range.
The indication of whether disaster roaming is enabled in the UE can only be
used if the SUPI from the USIM matches the SUPI stored in the non-volatile
memory of the ME; else the UE shall delete the indication of whether disaster
roaming is enabled in the UE.
The indication of \'applicability of \"lists of PLMN(s) to be used in disaster
condition\" provided by a VPLMN\' can only be used if the SUPI from the USIM
matches the SUPI stored in the non-volatile memory of the ME; else the UE
shall delete the indication of \'applicability of \"lists of PLMN(s) to be
used in disaster condition\" provided by a VPLMN\'.
# C.2 Storage of 5GMM information for UEs operating in SNPN access operation
mode
The 5GMM information for UEs operating in SNPN access operation mode and not
registering or registered for the onboarding service in SNPN are stored
according to the following conditions:
\- if the UE does not support access to an SNPN using credentials from a
credentials holder, the following 5GMM parameters shall be stored per
subscribed SNPN in a non-volatile memory in the ME together with the
subscriber identifier associated with the SNPN identity of the SNPN in the
\"list of subscriber data\" configured in the ME (see 3GPP TS 23.122 [5]) or
with the SUPI from the USIM if no subscriber identifier is configured in the
entry of the \"list of subscriber data\" associated with the SNPN identity and
the UE has a valid USIM;and
\- if the UE supports access to an SNPN using credentials from a credentials
holder, the following 5GMM parameters shall be stored in a non-volatile memory
in the ME per:
i) the subscribed SNPN together with the subscriber identifier associated with
the selected entry in the \"list of subscriber data\" configured in the ME
(see 3GPP TS 23.122 [5]) or with the SUPI from the USIM if no subscriber
identifier is configured in the selected entry of the \"list of subscriber
data\" configured in the ME and the UE has a valid USIM; or
ii) the PLMN subscription together with the SUPI from the USIM which is
associated with the PLMN subscription:
a) 5G-GUTI;
b) last visited registered TAI;
c) 5GS update status;
d) 5G NAS security context parameters from a full native 5G NAS security
context (see 3GPP TS 33.501 [24]);
e) K~AUSF~ and K~SEAF~ (see 3GPP TS 33.501 [24]);
f) UE parameter update counter (see subclause 9.11.3.53A);
g) configured NSSAI(s);
g1) NSSRG information;
h) NSSAI inclusion mode(s);
i) MPS indicator;
j) MCS indicator;
k) operator-defined access category definitions;
l) network-assigned UE radio capability IDs;
m) zero or more instances of signalled URSP (see 3GPP TS 24.526 [19]), each
associated with a non-subscribed SNPN, the subscribed SNPN or the HPLMN, which
provided the URSP;
n) optionally a non-subscribed SNPN signalled URSP handling indication
indicating whether the UE is allowed to accept URSP signalled by non-
subscribed SNPNs;
o) permanently forbidden SNPNs list;
p) temporarily forbidden SNPNs;
q) SOR counter (see subclause 9.11.3.51); and
r) SOR-CMCI.
The 5GMM information for UEs operating in SNPN access operation mode and
registering or registered for the onboarding service in SNPN are stored as
follows:
a) 5G-GUTI;
b) last visited registered TAI;
c) 5GS update status;
d) 5G NAS security context parameters from a full native 5G NAS security
context (see 3GPP TS 33.501 [24]);
e) K~AUSF~ and K~SEAF~ (see 3GPP TS 33.501 [24]);
f) UE parameter update counter (see subclause 9.11.3.53A);
g) network-assigned UE radio capability IDs;
h) \"permanently forbidden SNPNs\" list for onboarding services; and
i) \"temporarily forbidden SNPNs\" list for onboarding services.
The 5GMM information for UEs operating in SNPN access operation mode are
stored according to the following conditions:
\- if the UE does not support access to an SNPN using credentials from a
credentials holder, the following 5GMM parameters should be stored per
subscribed SNPN in a non-volatile memory in the ME together with the
subscriber identifier associated with the SNPN identity of the SNPN in the
\"list of subscriber data\" configured in the ME (see 3GPP TS 23.122 [5]) or
with the SUPI from the USIM if no subscriber identifier is configured in the
entry of the \"list of subscriber data\" associated with the SNPN identity and
the UE has a valid USIM; and
\- if the UE supports access to an SNPN using credentials from a credentials
holder, the following 5GMM parameters should be stored in a non-volatile
memory in the ME per:
i) the subscribed SNPN together with the subscriber identifier associated with
the selected entry in the \"list of subscriber data\" configured in the ME
(see 3GPP TS 23.122 [5]) or with the SUPI from the USIM if no subscriber
identifier is configured in the selected entry of the \"list of subscriber
data\" configured in the ME and the UE has a valid USIM; or
ii) the PLMN subscription together with the SUPI from the USIM which is
associated with the PLMN subscription:
a) allowed NSSAI(s).
If the 5GMM parameters are associated with the PLMN subscription, then the
5GMM parameters can only be used if the SUPI from the USIM which is associated
with the selected PLMN subscription matches the SUPI stored in the non-
volatile memory; else the UE shall delete the 5GMM parameters.
If the 5GMM parameters are associated with the subscribed SNPN of the entry in
the \"list of subscriber data\", then the 5GMM parameters can only be used if
the subscriber identifier of the selected entry of the \"list of subscriber
data\" matches the subscriber identifier stored in the non-volatile memory or
if the subscriber identifier from the USIM matches the subscriber identifier
stored in the non volatile memory, no subscriber identifier is configured in
the selected entry of the \"list of subscriber data\" configured in the ME and
the UE has a valid USIM.
Each configured NSSAI consists of S-NSSAI(s) stored together with an SNPN
identity, if it is associated with an SNPN. A configured NSSAI may be
associated with NSSRG information.
Each NSSAI inclusion mode is associated with an SNPN identity and access type.
The MPS indicator is stored together with an SNPN identity of the SNPN that
provided it, and is valid in that registered SNPN.
The MCS indicator is stored together with an SNPN identity of the SNPN that
provided it, and is valid in that registered SNPN.
Operator-defined access category definitions are stored together with an SNPN
identity of the SNPN that provided them, and are valid in that SNPN. The
maximum number of stored operator-defined access category definitions is UE
implementation dependent.
Each network-assigned UE radio capability ID is stored together with an SNPN
identity of the SNPN that provided it as well as a mapping to the
corresponding UE radio configuration, and is valid in that SNPN. The UE shall
be able to store at least the last 16 received network-assigned UE radio
capability IDs. There shall be only one network-assigned UE radio capability
ID stored for a given combination of SNPN identity and UE radio configuration
and any existing UE radio capability ID shall be deleted when a new UE radio
capability ID is added for the same combination of SNPN identity and UE radio
configuration. If the UE receives a network-assigned UE radio capability ID
with a Version ID value different from the value included in the network-
assigned UE radio capability ID(s) stored at the UE for the serving SNPN, the
UE may delete these stored network-assigned UE radio capability ID(s).
The handling of the SOR-CMCI stored in the non-volatile memory in the ME is
specified in 3GPP TS 23.122 [5].
The allowed NSSAI(s) can be stored in a non-volatile memory in the ME. Allowed
NSSAI consists of S-NSSAI(s) stored together with an SNPN identity, if it is
associated with an SNPN.
###### ## Annex D (normative): UE policy delivery service
# D.1 General
## D.1.1 Overview
The PCF may provide the UE with one or more UE policies using the network-
requested UE policy management procedure. The UE provides the PCF with a list
of one or more stored UE policy section identifiers (UPSIs), and the PCF
provides each UE policy using one or more UE policy sections, each identified
by a UPSI. The UPSI is composed of two parts:
a) a PLMN ID part containing:
1) the PLMN ID for the PLMN; or
2) the PLMN ID part of the SNPN identity for the SNPN;
of the PCF which provides the UE policies; and
b) a UE policy section code (UPSC) containing a value assigned by the PCF.
The UE processes the UE policy sections, each identified by the UPSI, received
from the PCF and informs the PCF of the result.
The UE provides the PCF with the UE policy related capabilities such as the
UE\'s support for ANDSP and the UE\'s OS Id.
The UE can also request the PCF to provide V2XP as specified in 3GPP TS 24.587
[19B].
The UE can also request the PCF to provide ProSeP as specified in 3GPP TS
24.554 [19E].
## D.1.2 Principles of PTI handling for UE policy delivery service procedures
When the PCF or the UE initiates a procedure, it shall include a valid PTI
value in the message header of the command message or the request message.
When the UE initiates a procedure, the UE shall use a PTI value in range
between 01H and 77H. When the PCF initiates a procedure, the PCF shall use a
PTI value in range between 80H and FEH.
When the PCF initiates a transaction related procedure (i.e. a procedure
consisting of more than one message and the messages are related), it shall
include a valid PTI value in the message header of the command message.
If a response message is sent as result of a received command or request
message, the UE or the PCF shall include in the response message the PTI value
received within the received command or request message (see examples in
figure D.1.2.1, figure D.1.2.2 and figure D.1.2.3).
If a command message is sent as result of a received request message, the PCF
shall include in the command message the PTI value received with the request
message (see examples in figure D.1.2.3).
Figure D.1.2.1: Network-requested transaction related procedure
Figure D.1.2.2: UE-requested transaction related procedure rejected by the
network
Figure D.1.2.3: UE-requested transaction related procedure triggering a
network-requested transaction related procedure
NOTE: In earlier versions of this protocol, the UE can include in the response
message a PTI value which is not the same as the one received within the
command message, and therefore the PCF could not associate the response
message from the UE to the command message sent.
# D.2 Procedures
## D.2.1 Network-requested UE policy management procedure
### D.2.1.1 General
The purpose of the network-requested UE policy management procedure is to
enable the network to:
a) add one or more new UE policy sections to the UE;
b) modify one or more UE policy sections stored at the UE; or
c) delete one or more UE policy sections stored at the UE;
and optionally to enable the HPLMN or the subscribed SNPN to provide a UE
accessing the subscribed SNPN or the HPLMN with a non-subscribed SNPN
signalled URSP handling indication indicating whether the UE is allowed to
accept URSP signalled by non-subscribed SNPNs.
### D.2.1.2 Network-requested UE policy management procedure initiation
In order to initiate the network-requested UE policy management procedure, the
PCF shall:
a) if the network-requested UE policy management procedure is triggered by the
UE-requested V2X policy provisioning procedure as specified in 3GPP TS 24.587
[19B] or the UE-requested ProSeP policy provisioning procedure as specified in
3GPP TS 24.554 [19E], then set the PTI IE to the PTI value of the received UE
POLICY PROVISIONING REQUEST message of the UE-requested V2X policy
provisioning procedure or the UE-requested ProSeP policy provisioning
procedure, otherwise allocate a PTI value currently not used and set the PTI
IE to the allocated PTI value;
b) encode the information about the UE policy sections to be added, modified
or deleted in a UE policy section management list IE as specified in subclause
D.6.2 and include it in a MANAGE UE POLICY COMMAND message;
c) if the PCF is a PCF of the HPLMN or the subscribed SNPN, optionally include
the UE policy network classmark IE in a MANAGE UE POLICY COMMAND message and
set the non-subscribed SNPN signalled URSP handling indication of the UE
policy network classmark IE to \"UE is not allowed to accept URSP signalled by
non-subscribed SNPNs\", or \"UE is allowed to accept URSP signalled by non-
subscribed SNPNs\";
d) send the MANAGE UE POLICY COMMAND message to the UE via the AMF as
specified in 3GPP TS 23.502 [9]; and
e) start timer T3501 (see example in figure D.2.1.2.1).
NOTE: The PCF starts a different timer T3501 for each PTI value.
Figure D.2.1.2.1: Network-requested UE policy management procedure
Upon receipt of the MANAGE UE POLICY COMMAND message with a PTI value
currently not used by a network-requested UE policy management procedure, for
each instruction included in the UE policy section management list IE, the UE
shall:
a) store the received UE policy section of the instruction, if the UE has no
stored UE policy section associated with the same UPSI as the UPSI associated
with the instruction;
b) replace the stored UE policy section with the received UE policy section of
the instruction, if the UE has a stored UE policy section associated with the
same UPSI as the UPSI associated with the instruction; or
c) delete the stored UE policy section, if the UE has a stored UE policy
section associated with the same UPSI as the UPSI associated with the
instruction and the UE policy section contents of the instruction is empty;
and if UE\'s RPLMN is the HPLMN or UE\'s RSNPN is the subscribed SNPN and the
UE policy network classmark IE is included in the MANAGE UE POLICY COMMAND
message, the UE shall delete the non-subscribed SNPN signalled URSP handling
indication stored for the selected entry of \"list of subscriber data\" or the
selected PLMN subscription, if any, and store the non-subscribed SNPN
signalled URSP handling indication received in the UE policy network classmark
IE, for the selected entry of \"list of subscriber data\" or the selected PLMN
subscription.
The UE may continue storing a received UE policy section for a PLMN or SNPN
when the UE registers in another PLMN or SNPN. If necessary, the UE may delete
UE policy sections stored for a PLMN or SNPN other than the RPLMN and the
HPLMN or the registered SNPN, before storing the new received UE policy
sections.
When storing a UE policy sections received from an SNPN and the subscribed
SNPN, the UE shall associate the NID of that SNPN with the UPSI of the stored
UE policy section.
NOTE: The maximum number of UE policy sections for PLMNs or SNPNs other than
the HPLMN and the RPLMN or the registered SNPN and the subscribed SNPN that
the UE can store and how the UE selects the UE policy sections to be deleted
are up to the UE implementation.
### D.2.1.3 Network-requested UE policy management procedure accepted by the
UE
If all instructions included in the UE policy section management list IE were
executed successfully by the UE, the UE shall:
a) create a MANAGE UE POLICY COMPLETE message including the PTI value received
within the MANAGE UE POLICY COMMAND message; and
b) transport the MANAGE UE POLICY COMPLETE message using the NAS transport
procedure as specified in subclause 5.4.5.
Upon receipt of the MANAGE UE POLICY COMPLETE message, the PCF shall stop
timer T3501. The PCF should ensure that the PTI value assigned to this
procedure is not released immediately.
NOTE: The way to achieve this is implementation dependent. For example, the
PCF can ensure that the PTI value assigned to this procedure is not released
during the time equal to or greater than the default value of timer T3501.
### D.2.1.4 Network-requested UE policy management procedure not accepted by
the UE
If the UE could not execute all instructions included in the UE policy section
management list IE successfully, the UE shall:
a) set the PTI IE to the PTI value received within the MANAGE UE POLICY
COMMAND message and encode the UPSI associated with the instructions which
could not be executed successfully and the associated UE policy delivery
service cause indicating the cause of the failure in a UE policy section
management result IE as specified in subclause D.5.3 and include it in a
MANAGE UE POLICY COMMAND REJECT message, and
b) transport the MANAGE UE POLICY COMMAND REJECT message using the NAS
transport procedure as specified in subclause 5.4.5.
Upon receipt of the MANAGE UE POLICY COMMAND REJECT message, the PCF shall
stop timer T3501. Any instruction that was included in the UE policy section
management list IE and whose associated UPSI is not included in a UE policy
section management result IE of the received MANAGE UE POLICY COMMAND REJECT
message is considered as successfully executed.
The PCF should ensure that the PTI value assigned to this procedure is not
released immediately.
NOTE: The way to achieve this is implementation dependent. For example, the
PCF can ensure that the PTI value assigned to this procedure is not released
during the time equal to or greater than the default value of timer T3501.
Upon receipt of the notification from the AMF that the UE is not reachable,
the PCF shall stop the T3501.
### D.2.1.5 Abnormal cases on the network side
The following abnormal cases can be identified:
a) T3501 expired.
The PCF shall, on the first expiry of the timer T3501, retransmit the MANAGE
UE POLICY COMMAND message and shall reset and start timer T3501. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T3501, the PCF shall abort the procedure and release the allocated PTI.
### D.2.1.6 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Receipt of an instruction associated with a UPSI which has a PLMN ID part
that is not equal to the PLMN ID of the UE\'s HPLMN and the instruction
contains a UE policy part with a UE policy part type set to \"URSP\" for a UE
not operating in SNPN access operation mode, or receipt of an instruction
associated with a UPSI which has a PLMN ID part that is not equal to the PLMN
ID part of the selected SNPN and the instruction contains a UE policy part
with a UE policy part type set to \"URSP\" for a UE operating in SNPN access
operation mode.
The UE shall set the UE policy delivery service cause to #111 (Protocol error,
unspecified) for the instruction in the UE policy section management result IE
of the MANAGE UE POLICY COMMAND REJECT message.
b) Receipt of an instruction associated with a UPSI which has a PLMN ID part
that is not equal to the PLMN ID of the UE\'s HPLMN or the UE\'s RPLMN and the
instruction contains a UE policy part with a UE policy part type set to
\"ANDSP\" for a UE not operating in SNPN access operation mode.
The UE shall set the UE policy delivery service cause to #111 (Protocol error,
unspecified) for the instruction in the UE policy section management result IE
of the MANAGE UE POLICY COMMAND REJECT message.
c) Transmission failure of the MANAGE UE POLICY COMPLETE message indication
from lower layers.
The UE shall not diagnose an error and consider the network-initiated UE
policy delivery procedure complete.
NOTE 1: Considering the network-initiated UE policy delivery procedure
complete as a result of this abnormal case does not cause the UE to revert the
execution of the instructions included in the MANAGE UE POLICY COMMAND
message.
d) Transmission failure of the MANAGE UE POLICY COMMAND REJECT message
indication from lower layers.
The UE shall not diagnose an error and consider the network-initiated UE
policy delivery procedure complete.
NOTE 2: Considering the network-initiated UE policy delivery procedure
complete as a result of this abnormal case does not cause the UE to revert the
execution of the instructions included in the MANAGE UE POLICY COMMAND message
and successfully processed by the UE.
e) Receipt of a MANAGE UE POLICY COMMAND message with a PTI set to the same
value as the PTI of a previously received MANAGE UE POLICY COMMAND message.
The UE shall discard the message and retransmit the MANAGE UE POLICY COMMAND
COMPLETE or MANAGE UE POLICY COMMAND REJECT message transmitted in response to
the previously received MANAGE UE POLICY COMMAND message.
NOTE 3: The way to achieve this is UE implementation dependent. For example,
the UE can assume that on the fifth expiry of timer T3501, the PCF will abort
the procedure and that the PTI value assigned to the procedure will be
released.
f) Receipt of an instruction associated with a UPSI which has a PLMN ID part
that is equal to the PLMN ID part of the selected SNPN, the instruction
contains a UE policy part with a UE policy part type set to \"URSP\", UE\'s
RSNPN is a non-subscribed SNPN and:
1) the UE has a stored non-subscribed SNPN signalled URSP handling indication
for the selected entry of \"list of subscriber data\" or the selected PLMN
subscription indicating that the UE is not allowed to accept URSP signalled by
non-subscribed SNPNs; or
2) the UE does not have a stored non-subscribed SNPN signalled URSP handling
indication for the selected entry of \"list of subscriber data\" or the
selected PLMN subscription, and the non-subscribed SNPN signalled URSP
handling indication preconfigured in the selected entry of \"list of
subscriber data\" or the selected PLMN subscription indicates that the UE is
not allowed to accept URSP signalled by non-subscribed SNPNs;
for a UE operating in SNPN access operation mode.
The UE shall set the UE policy delivery service cause to #111 (Protocol error,
unspecified) for the instruction in the UE policy section management result IE
of the MANAGE UE POLICY COMMAND REJECT message.
## D.2.2 UE-initiated UE state indication procedure
### D.2.2.1 General
The purpose of the UE-initiated UE state indication procedure is:
a) to deliver the UPSI(s) of the UE policy section(s) which are:
\- identified by a UPSI with the PLMN ID part indicating the HPLMN or the
selected PLMN, and stored in the UE, if any; or
\- identified by a UPSI with the PLMN ID part indicating the PLMN ID part of
the SNPN identity of the selected SNPN and associated with the NID of the
selected SNPN, and stored in the UE, if any;
b) to indicate whether UE supports ANDSP; and
c) to deliver the UE\'s one or more OS IDs;
to the PCF.
### D.2.2.2 UE-initiated UE state indication procedure initiation
In order to initiate the UE-initiated UE state indication procedure, the UE
shall create a UE STATE INDICATION message. The UE:
a) shall allocate a PTI value currently not used and set the PTI IE to the
allocated PTI value;
b) if not operating in SNPN access operation mode, shall include the UPSI(s)
of the UE policy section(s) which are identified by a UPSI with the PLMN ID
part indicating the HPLMN or the selected PLMN available in the UE in the UPSI
list IE;
c) if operating in SNPN access operation mode, shall include UPSI(s) of the UE
policy section(s) which are identified by a UPSI:
\- with the PLMN ID part indicating the MCC and MNC of the selected SNPN; and
\- associated with the NID of the selected SNPN;
available in the UE in the UPSI list IE;
d) shall specify whether the UE supports ANDSP in the UE policy classmark IE;
and
e) may include the UE\'s one or more OS IDs in the UE OS Id IE.
The UE shall send the UE STATE INDICATION message (see example in figure
D.2.2.2.1). The UE shall transport the created UE STATE INDICATION message
using the registration procedure (see subclause 5.5.1).
Figure D.2.2.2.1: UE-initiated UE state indication procedure
### D.2.2.3 UE-initiated UE state indication procedure accepted by the network
Upon receipt of the UE STATE INDICATION message, the PCF shall operate as
described in 3GPP TS 23.502 [9] and 3GPP TS 29.525 [21].
### D.2.2.4 Abnormal cases on the network side
Apart from the case described in subclause D.2.2.3, no abnormal cases have
been identified.
# D.3 UE policy re-assembly at the UE
When the UE needs to apply ANDSP as specified in 3GPP TS 24.502 [18], the UE
shall consider all UE policy parts with ANDSP contents currently stored at the
UE.
When the UE needs to apply URSP as specified in 3GPP TS 24.526 [19], the UE
shall consider all UE policy parts with URSP contents currently stored at the
UE.
When the UE needs to apply V2XP as specified in 3GPP TS 24.588 [19C], the UE
shall consider all UE policy parts with V2XP contents currently stored at the
UE.
When the UE needs to apply ProSeP as specified in 3GPP TS 24.555 [19F], the UE
shall consider all UE policy parts with ProSeP contents currently stored at
the UE.
# D.4 Void
# D.5 Message functional definition and contents
## D.5.1 Manage UE policy command
### D.5.1.1 Message definition
The MANAGE UE POLICY COMMAND message is sent by the PCF to the UE to request
the UE to manage UE policy sections, see table D.5.1.1.1
Message type: MANAGE UE POLICY COMMAND
Significance: dual
Direction: network to UE
Table D.5.1.1.1: MANAGE UE POLICY COMMAND message content
+----------+----------+----------+----------+--------+----------+ | IEI | Inf | Type/R | Presence | Format | Length | | | ormation | eference | | | | | | Element | | | | | +==========+==========+==========+==========+========+==========+ | | PTI | P | M | V | 1 | | | | rocedure | | | | | | | tra | | | | | | | nsaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +----------+----------+----------+----------+--------+----------+ | | MANAGE | UE | M | V | 1 | | | UE | policy | | | | | | POLICY | delivery | | | | | | COMMAND | service | | | | | | message | message | | | | | | identity | type | | | | | | | | | | | | | | D.6.1 | | | | +----------+----------+----------+----------+--------+----------+ | | UE | UE | M | LV-E | 11-65533 | | | policy | policy | | | | | | section | section | | | | | | ma | ma | | | | | | nagement | nagement | | | | | | list | list | | | | | | | | | | | | | | D.6.2 | | | | +----------+----------+----------+----------+--------+----------+ | 42 | UE | UE | O | TLV | 3-5 | | | policy | policy | | | | | | network | network | | | | | | c | c | | | | | | lassmark | lassmark | | | | | | | | | | | | | | D.6.7 | | | | +----------+----------+----------+----------+--------+----------+ | NOTE: | | | | | | | The | | | | | | | total | | | | | | | length | | | | | | | of the | | | | | | | MANAGE | | | | | | | UE | | | | | | | POLICY | | | | | | | COMMAND | | | | | | | message | | | | | | | content | | | | | | | cannot | | | | | | | exceed | | | | | | | 65535 | | | | | | | octets | | | | | | | (see | | | | | | | Payload | | | | | | | c | | | | | | | ontainer | | | | | | | contents | | | | | | | maximum | | | | | | | length | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | subclau | | | | | | | se 9.11. | | | | | | | 3.39.1). | | | | | | +----------+----------+----------+----------+--------+----------+
### D.5.1.2 UE policy network classmark
The UE policy network classmark is included when the PCF of a PLMN or an SNPN
intends to provide the UE with information about the policy aspects of the
network.
## D.5.2 Manage UE policy complete
### D.5.2.1 Message definition
The MANAGE UE POLICY COMPLETE message is sent by the UE to the PCF to report
that all received instructions have been successfully executed at the UE, see
table D.5.2.1.1
Message type: MANAGE UE POLICY COMPLETE
Significance: dual
Direction: UE to network
Table D.5.2.1.1: MANAGE UE POLICY COMPLETE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | MANAGE UE | UE policy | M | V | 1 | | | POLICY | delivery | | | | | | COMPLETE | service | | | | | | message | message | | | | | | identity | type | | | | | | | | | | | | | | D.6.1 | | | | +-----+-------------+-------------+----------+--------+--------+
## D.5.3 Manage UE policy command reject
### D.5.3.1 Message definition
The MANAGE UE POLICY COMMAND REJECT message is sent by the UE to the PCF to
report that one or more instructions could not be successfully executed at the
UE, see table D.5.3.1.1
Message type: MANAGE UE POLICY COMMAND REJECT
Significance: dual
Direction: UE to network
Table D.5.3.1.1: MANAGE UE POLICY COMMAND REJECT message content
+----------+----------+----------+----------+--------+----------+ | IEI | Inf | Type/R | Presence | Format | Length | | | ormation | eference | | | | | | Element | | | | | +==========+==========+==========+==========+========+==========+ | | PTI | P | M | V | 1 | | | | rocedure | | | | | | | tra | | | | | | | nsaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +----------+----------+----------+----------+--------+----------+ | | MANAGE | UE | M | V | 1 | | | UE | policy | | | | | | POLICY | delivery | | | | | | COMMAND | service | | | | | | REJECT | message | | | | | | message | type | | | | | | identity | | | | | | | | D.6.1. | | | | +----------+----------+----------+----------+--------+----------+ | | UE | UE | M | LV-E | 11-65533 | | | policy | policy | | | | | | section | section | | | | | | ma | ma | | | | | | nagement | nagement | | | | | | result | result | | | | | | | | | | | | | | D.6.3 | | | | +----------+----------+----------+----------+--------+----------+ | NOTE: | | | | | | | The | | | | | | | total | | | | | | | length | | | | | | | of the | | | | | | | MANAGE | | | | | | | UE | | | | | | | POLICY | | | | | | | COMMAND | | | | | | | REJECT | | | | | | | message | | | | | | | content | | | | | | | cannot | | | | | | | exceed | | | | | | | 65535 | | | | | | | octets | | | | | | | (see | | | | | | | Payload | | | | | | | c | | | | | | | ontainer | | | | | | | contents | | | | | | | maximum | | | | | | | length | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | subclau | | | | | | | se 9.11. | | | | | | | 3.39.1). | | | | | | +----------+----------+----------+----------+--------+----------+
## D.5.4 UE state indication
### D.5.4.1 Message definition
The UE STATE INDICATION message is sent by the UE to the PCF:
a) to deliver the UPSI(s) of the UE policy section(s) stored in the UE;
b) to indicate whether the UE supports ANDSP; and
c) to deliver the UE\'s one or more OS IDs;
see table D.5.4.1.1.
Message type: UE STATE INDICATION
Significance: dual
Direction: UE to network
Table D.5.4.1.1: UE STATE INDICATION message content
+----------+----------+----------+----------+--------+---------+ | IEI | Inf | Type/R | Presence | Format | Length | | | ormation | eference | | | | | | Element | | | | | +==========+==========+==========+==========+========+=========+ | | PTI | P | M | V | 1 | | | | rocedure | | | | | | | tra | | | | | | | nsaction | | | | | | | identity | | | | | | | | | | | | | | 9.6 | | | | +----------+----------+----------+----------+--------+---------+ | | UE STATE | UE | M | V | 1 | | | IN | policy | | | | | | DICATION | delivery | | | | | | message | service | | | | | | identity | message | | | | | | | type | | | | | | | | | | | | | | D.6.1 | | | | +----------+----------+----------+----------+--------+---------+ | | UPSI | UPSI | M | LV-E | 9-65531 | | | list | list | | | | | | | | | | | | | | D.6.4 | | | | +----------+----------+----------+----------+--------+---------+ | | UE | UE | M | LV | 2-4 | | | policy | policy | | | | | | c | c | | | | | | lassmark | lassmark | | | | | | | | | | | | | | D.6.5 | | | | +----------+----------+----------+----------+--------+---------+ | 41 | UE OS Id | OS Id | O | TLV | 18-242 | | | | | | | | | | | D.6.6 | | | | +----------+----------+----------+----------+--------+---------+ | NOTE: | | | | | | | The | | | | | | | total | | | | | | | length | | | | | | | of the | | | | | | | UE STATE | | | | | | | IN | | | | | | | DICATION | | | | | | | message | | | | | | | content | | | | | | | cannot | | | | | | | exceed | | | | | | | 65535 | | | | | | | octets | | | | | | | (see | | | | | | | Payload | | | | | | | c | | | | | | | ontainer | | | | | | | contents | | | | | | | maximum | | | | | | | length | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 9.11. | | | | | | | 3.39.1). | | | | | | +----------+----------+----------+----------+--------+---------+
# D.6 Information elements coding
## D.6.1 UE policy delivery service message type
Table D.6.1.1: UE policy delivery service message type
* * *
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 Reserved 0 0 0 0 0 0 0 1 MANAGE UE POLICY COMMAND message 0 0
0 0 0 0 1 0 MANAGE UE POLICY COMPLETE message 0 0 0 0 0 0 1 1 MANAGE UE POLICY
COMMAND REJECT message 0 0 0 0 0 1 0 0 UE STATE INDICATION message 0 0 0 0 0 1
0 1 UE POLICY PROVISIONING REQUEST message (see NOTE) 0 0 0 0 0 1 1 0 UE
POLICY PROVISIONING REJECT message (see NOTE)
All other values are reserved  
NOTE: Coding and usage of UE POLICY PROVISIONING REQUEST message and UE POLICY
PROVISIONING REJECT message are specified in 3GPP TS 24.587 [19B].
* * *
## D.6.2 UE policy section management list
The purpose of the UE policy section management list information element is to
transfer from the PCF to the UE a list of instructions to be performed at the
UE for management of UE policy section stored at the UE.
The UE policy section management list information element is coded as shown in
figure D.6.2.1, figure D.6.2.2, figure D.6.2.3, figure D.6.2.4, figure
D.6.2.5, figure D.6.2.6, figure D.6.2.7 and table D.6.2.1.
The _UE policy section management list information element has_ a minimum
length of 12 octets and a maximum length of 65534 octets.
+------------------------------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------------------------------+---------+---+---+---+---+---+---+---+ | UE policy section management list IEI | octet 1 | | | | | | | | +------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Length of UE policy section management list contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +------------------------------------------------------+---------+---+---+---+---+---+---+---+ | UE policy section management list contents | octet 4 | | | | | | | | | | | | | | | | | | | | octet z | | | | | | | | +------------------------------------------------------+---------+---+---+---+---+---+---+---+
Figure D.6.2.1: UE policy section management list information element
+-----------------------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------------------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section management sublist (PLMN 1) | octet 4 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +-----------------------------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section management sublist (PLMN 2) | octet a+1 | | | | | | | | | | | | | | | | | | | | octet b | | | | | | | | +-----------------------------------------------+-----------+---+---+---+---+---+---+---+ | ... | octet b+1 | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet c | | | | | | | | +-----------------------------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section management sublist (PLMN N) | octet c+1 | | | | | | | | | | | | | | | | | | | | octet z | | | | | | | | +-----------------------------------------------+-----------+---+---+---+---+---+---+---+
Figure D.6.2.2: UE policy section management list contents
+------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | Length of UE policy section management sublist | octet d | | | | | | | | | | | | | | | | | | | | octet d+1 | | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | | MCC digit 1 | octet d+2 | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | MCC digit 2 | | | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | | MCC digit 3 | octet d+3 | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | MNC digit 3 | | | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | | MNC digit 1 | octet d+4 | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | MNC digit 2 | | | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+ | UE policy section management sublist contents | octet d+5 | | | | | | | | | | | | | | | | | | | | octet y | | | | | | | | +------------------------------------------------+-------------+-----------+---+---+---+---+---+---+
Figure D.6.2.3: UE policy section management sublist
+---------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------+-----------+---+---+---+---+---+---+---+ | Instruction 1 | octet d+5 | | | | | | | | | | | | | | | | | | | | octet e | | | | | | | | +---------------+-----------+---+---+---+---+---+---+---+ | Instruction 2 | octet e+1 | | | | | | | | | | | | | | | | | | | | octet f | | | | | | | | +---------------+-----------+---+---+---+---+---+---+---+ | ... | octet f+1 | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet g | | | | | | | | +---------------+-----------+---+---+---+---+---+---+---+ | Instruction N | octet g+1 | | | | | | | | | | | | | | | | | | | | octet e | | | | | | | | +---------------+-----------+---+---+---+---+---+---+---+
Figure D.6.2.4: UE policy section management sublist contents
+-----------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------------------+-----------+---+---+---+---+---+---+---+ | Instruction contents length | octet d+5 | | | | | | | | | | | | | | | | | | | | octet d+6 | | | | | | | | +-----------------------------+-----------+---+---+---+---+---+---+---+ | UPSC | octet d+7 | | | | | | | | | | | | | | | | | | | | octet d+8 | | | | | | | | +-----------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section contents | octet d+9 | | | | | | | | | | | | | | | | | | | | octet k | | | | | | | | +-----------------------------+-----------+---+---+---+---+---+---+---+
Figure D.6.2.5: Instruction
+------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------+-----------+---+---+---+---+---+---+---+ | UE policy part 1 | octet l | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +------------------+-----------+---+---+---+---+---+---+---+ | UE policy part 2 | octet m+1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +------------------+-----------+---+---+---+---+---+---+---+ | ... | octet n+1 | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet o | | | | | | | | +------------------+-----------+---+---+---+---+---+---+---+ | UE policy part N | octet o+1 | | | | | | | | | | | | | | | | | | | | octet p | | | | | | | | +------------------+-----------+---+---+---+---+---+---+---+
Figure D.6.2.6: UE policy section contents
+--------------------------------+-----------+---+---+---------------------+-----------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------+-----------+---+---+---------------------+-----------+---+---+---+ | UE policy part contents length | octet q | | | | | | | | | | | | | | | | | | | | octet q+1 | | | | | | | | +--------------------------------+-----------+---+---+---------------------+-----------+---+---+---+ | 0 | 0 | 0 | 0 | UE policy part type | octet q+2 | | | | +--------------------------------+-----------+---+---+---------------------+-----------+---+---+---+ | Spare | | | | | | | | | +--------------------------------+-----------+---+---+---------------------+-----------+---+---+---+ | UE policy part contents | octet q+3 | | | | | | | | | | | | | | | | | | | | octet r | | | | | | | | +--------------------------------+-----------+---+---+---------------------+-----------+---+---+---+
Figure D.6.2.7: UE policy part
Table D.6.2.1: UE policy section management list information element
* * *
Value part of the UE policy section management list information element
(octets 4 to z)
The value part of the UE policy section management list information element
consists of one or several UE policy section management sublists.
UE policy section management sublist:
Length of UE policy section management sublist (octets d to d+1)
This field contains the binary encoding of the length of the UE policy section
management sublist in units of octets.
MCC, Mobile country code (octet d+2, and bits 4 to 1 of octet d+3)
The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A.
MNC, Mobile network code (bits 8 to 5 of octet d+3, and octet d+4)
The coding of this field is the responsibility of each administration but BCD
coding shall be used. The MNC shall consist of 2 or 3 digits. If a network
operator decides to use only two digits in the MNC, MNC digit 3 shall be coded
as \"1111\".
UE policy section management sublist contents (octets d+5 to y)
The UE policy section management sublist contents consist of one or several
instructions.
Instruction:
Instruction contents length (octets d+5 to d+6)
This field contains the binary encoding of the instruction contents length in
units of octets.
UPSC (octets d+7 to d+8)
This field contains the binary encoding of the UPSC. The value of the UPSC is
set by the PCF.
UE policy section contents (octets d+9 to k)
The UE policy section contents consist of one or several UE policy parts.
UE policy part:
UE policy part contents length (octets q to q+1)
This field contains the binary encoding of the UE policy part contents length
in units of octets.
UE policy part type (bits 4 to 1 of octet q+2)  
Bits  
4 3 2 1  
0 0 0 0 Reserved 0 0 0 1 URSP 0 0 1 0 ANDSP 0 0 1 1 V2XP 0 1 0 0 ProSeP All
other values are reserved.
Bits 8 to 5 of octet q+2 are spare and shall be coded as zero.
UE policy part contents
This field contains a UE policy part encoded as specified in 3GPP TS 24.526
[19] for the UE policy part type field set to \"URSP\" or \"ANDSP\", in 3GPP
TS 24.588 [19C] for the UE policy part type field set to \"V2XP\" and in 3GPP
TS 24.555 [19F] for the UE policy part type field set to \"ProSeP\"
respectively.
* * *
## D.6.3 UE policy section management result
The purpose of the UE policy section management result information element is
to transfer from the UE to the PCF information about instructions for UE
policy section management which the UE could not execute successfully.
The UE policy section management result information element is coded as shown
in figure D.6.3.1, figure D.6.3.2, figure D.6.3.3, figure D.6.3.4, figure
D.6.3.5 and table D.6.3.1.
The _UE policy section management result information element has_ a minimum
length of 12 octets and a maximum length of 65534 octets.
+--------------------------------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------------------------------+---------+---+---+---+---+---+---+---+ | UE policy section management result IEI | octet 1 | | | | | | | | +--------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Length of UE policy section management result contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +--------------------------------------------------------+---------+---+---+---+---+---+---+---+ | UE policy section management result contents | octet 4 | | | | | | | | | | | | | | | | | | | | octet z | | | | | | | | +--------------------------------------------------------+---------+---+---+---+---+---+---+---+
Figure D.6.3.1: UE policy section management result information element
+-------------------------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section management subresult (PLMN 1) | octet 4 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +-------------------------------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section management subresult (PLMN 2) | octet a+1 | | | | | | | | | | | | | | | | | | | | octet b | | | | | | | | +-------------------------------------------------+-----------+---+---+---+---+---+---+---+ | ... | octet b+1 | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet c | | | | | | | | +-------------------------------------------------+-----------+---+---+---+---+---+---+---+ | UE policy section management subresult (PLMN N) | octet c+1 | | | | | | | | | | | | | | | | | | | | octet z | | | | | | | | +-------------------------------------------------+-----------+---+---+---+---+---+---+---+
Figure D.6.3.2: UE policy section management result contents
+---------------+-------------+-----------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------+-------------+-----------+---+---+---+---+---+---+ | Number of | octet d | | | | | | | | | results | | | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | | MCC digit 1 | octet d+1 | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | MCC digit 2 | | | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | | MCC digit 3 | octet d+2 | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | MNC digit 3 | | | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | | MNC digit 1 | octet d+3 | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | MNC digit 2 | | | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+ | UE policy | octet d+4 | | | | | | | | | section | | | | | | | | | | management | octet y | | | | | | | | | subresult | | | | | | | | | | contents | | | | | | | | | +---------------+-------------+-----------+---+---+---+---+---+---+
Figure D.6.3.3: UE policy section management subresult
+----------+------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------+------------+---+---+---+---+---+---+---+ | Result 1 | octet d+4 | | | | | | | | | | | | | | | | | | | | octet d+8 | | | | | | | | +----------+------------+---+---+---+---+---+---+---+ | Result 2 | octet d+9 | | | | | | | | | | | | | | | | | | | | octet d+13 | | | | | | | | +----------+------------+---+---+---+---+---+---+---+ | ... | octet d+14 | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet e | | | | | | | | +----------+------------+---+---+---+---+---+---+---+ | Result N | octet e+1 | | | | | | | | | | | | | | | | | | | | octet e+5 | | | | | | | | +----------+------------+---+---+---+---+---+---+---+
Figure D.6.3.4: UE policy section management subresult contents
+--------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------+-----------+---+---+---+---+---+---+---+ | UPSC | octet f | | | | | | | | | | | | | | | | | | | | octet f+1 | | | | | | | | +--------------------------+-----------+---+---+---+---+---+---+---+ | Failed instruction order | octet f+2 | | | | | | | | | | | | | | | | | | | | octet f+3 | | | | | | | | +--------------------------+-----------+---+---+---+---+---+---+---+ | Cause | octet f+4 | | | | | | | | +--------------------------+-----------+---+---+---+---+---+---+---+
Figure D.6.3.5: Result
Table D.6.3.1: UE policy section management result information element
Value part of the UE policy section management result information element (octets 4 to z) |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |   
The value part of the UE policy section management result information element consists of one or several UE policy section management subresults. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
UE policy section management subresult: |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Number of results (octet d) |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
This field contains the binary encoding of number of results included in the UE policy section management subresult. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
MCC, Mobile country code (octet d+1, and bits 4 to 1 of octet d+2) |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
MNC, Mobile network code (bits 8 to 5 of octet d+2, and octet d+3) |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, MNC digit 3 shall be coded as "1111". |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
UE policy section management subresult contents (octets d+4 to y) The UE policy section management subresult contents consist of one or several results. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Result (octet f to f+4) |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
UPSC (octet f to f+1) |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
This field contains the binary encoding of the UPSC. The value of the UPSC is set by the PCF |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Failed instruction order (octets f+2 to f+3) |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
This field contains the binary encoding of the order of the failed instruction in the UE policy section management sublist. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Cause (octet f+4) |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 1 | 1 | 0 | 1 | 1 | 1 | 1 |  | Protocol error, unspecified  
The receiving entity shall treat any other value as 0110 1111, "protocol error, unspecified". |  |  |  |  |  |  |  |  |   
## D.6.4 UPSI list
The purpose of the UPSI list information element is to transfer from the UE to
the PCF a list of UPSIs.
The UPSI list information element is coded as shown in figure D.6.4.1, figure
D.6.4.2, and table D.6.4.1.
The _UPSI list information element has_ a minimum length of 10 octets and a
maximum length of 65532 octets.
+------------------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------+-------------+---+---+---+---+---+---+---+ | UPSI list IEI | octet 1 | | | | | | | | +------------------------------+-------------+---+---+---+---+---+---+---+ | Length of UPSI list contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +------------------------------+-------------+---+---+---+---+---+---+---+ | UPSI sublist (PLMN 1) | octet 4 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +------------------------------+-------------+---+---+---+---+---+---+---+ | UPSI sublist (PLMN 2) | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +------------------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | octet c* | | | | | | | | +------------------------------+-------------+---+---+---+---+---+---+---+ | UPSI sublist (PLMN N) | octet c+1* | | | | | | | | | | | | | | | | | | | | octet z* | | | | | | | | +------------------------------+-------------+---+---+---+---+---+---+---+
Figure D.6.4.1: UPSI list information element
+------------------------+-------------+-----------+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | Length of UPSI sublist | octet d | | | | | | | | | | | | | | | | | | | | octet d+1 | | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | MCC digit 2 | MCC digit 1 | octet d+2 | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | MNC digit 3 | MCC digit 3 | octet d+3 | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | MNC digit 2 | MNC digit 1 | octet d+4 | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | UPSC | octet d+5 | | | | | | | | | | | | | | | | | | | | octet d+6 | | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | UPSC | octet d+7* | | | | | | | | | | | | | | | | | | | | octet d+8* | | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | ... | octet d+9* | | | | | | | | | | | | | | | | | | | | octet e* | | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+ | UPSC | octet e+1* | | | | | | | | | | | | | | | | | | | | octet e+2* | | | | | | | | +------------------------+-------------+-----------+---+---+---+---+---+---+
Figure D.6.4.2: UPSI sublist
Table D.6.4.1: UPSI list information element
* * *
MCC, Mobile country code (octet d+2, and bits 4 to 1 of octet d+3) The MCC
field is coded as in ITU-T Recommendation E.212 [42], annex A. MNC, Mobile
network code (bits 8 to 5 of octet d+3, and octet d+4) The coding of this
field is the responsibility of each administration but BCD coding shall be
used. The MNC shall consist of 2 or 3 digits. If a network operator decides to
use only two digits in the MNC, MNC digit 3 shall be coded as \"1111\". UPSC
(octets d+5 to d+6) This field contains the binary encoding of the UPSC. The
value of the UPSC is set by the PCF.
* * *
## D.6.5 UE policy classmark
The purpose of the UE policy classmark information element is to provide the
network with information about the policy aspects of the UE.
The UE policy classmark information element is coded as shown in figure
D.6.5.1 and table D.6.5.1.
The UE policy classmark is a type 4 information element with a minimum length
of 3 octets and a maximum length of 5 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | P | octet | | | | | | | | | olicy | 1 | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | P | | | | | | | | | | olicy | | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | Su | octet | | | | | | | Spare | Spare | pport | 3 | | Spare | Spare | Spare | Spare | Spare | | | ANDSP | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 4* | | | | | | | | | | -5* | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure D.6.5.1: UE policy classmark information element
Table D.6.5.1: UE policy classmark information element
Support of ANDSP by the UE (SupportANDSP) (octet 3, bit 1)
* * *
Bit  
1  
0 ANDSP not supported by the UE 1 ANDSP supported by the UE
All other bits in octet 3 to 5 are spare and shall be coded as zero, if the
respective octet is included in the information element.
## D.6.6 UE OS Id
The purpose of the UE OS Id information element is to provide the network with
information about the OS of the UE.
The UE OS Id information element is coded as shown in figure D.6.6.1 and table
D.6.6.1.
The UE OS Id is a type 4 information element with a minimum length of 18 octet
and a maximum length of 242 octets.
8 7 6 5 4 3 2 1
* * *
OS Id IEI octet 1  
Length of OS Id information contents octet 2  
OS Id_1 octets 3 - 18  
... ...  
OS Id_15 octets 227* -242*
Figure D.6.6.1: UE OS Id information element
Table D.6.6.1: UE OS Id information element
OS Id:
* * *
The OS Id is coded as a sequence of a sixteen octet OS Id value field. The OS
Id value field is defined as Universally Unique IDentifier (UUID) as specified
in IETF RFC 4122 [35A].
## D.6.7 UE policy network classmark
The purpose of the UE policy network classmark information element is to
provide the UE with information about the policy aspects of the network.
The UE policy network classmark information element is coded as shown in
figure D.6.7.1 and table D.6.7.1.
The UE policy network classmark is a type 4 information element with a minimum
length of 3 octets and a maximum length of 5 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | UE | octet | | | | | | | | | p | 1 | | | | | | | | | olicy | | | | | | | | | | ne | | | | | | | | | | twork | | | | | | | | | | clas | | | | | | | | | | smark | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of UE | | | | | | | | | | p | | | | | | | | | | olicy | | | | | | | | | | ne | | | | | | | | | | twork | | | | | | | | | | clas | | | | | | | | | | smark | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | NSSUI | octet | | | | | | | Spare | Spare | | 3 | | Spare | Spare | Spare | Spare | Spare | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 4* | | | | | | | | | | -5* | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure D.6.7.1: UE policy network classmark information element
Table D.6.7.1: UE policy network classmark information element
Non-subscribed SNPN signalled URSP handling indication (NSSUI) (octet 3, bit
1) (see NOTE)
* * *
Bits  
1  
0 UE is allowed to accept URSP signalled by non-subscribed SNPNs 1 UE is not
allowed to accept URSP signalled by non-subscribed SNPNs
All other bits in octet 3 to 5 are spare and shall be coded as zero, if the
respective octet is included in the information element.  
NOTE: Receiving entity shall ignore this bit, if received from the RPLMN which
is not the HPLMN or from the RSNPN is not the subscribed SNPN.
# D.7 Timers of UE policy delivery service
Timers of UE policy delivery service are shown in table D.7.1.
Table D.7.1: Timers of UE policy delivery service -- PCF side
* * *
TIMER NUM. TIMER VALUE CAUSE OF START NORMAL STOP ON\ THE\ 1^st^, 2^nd^,
3^rd^, 4^th^ EXPIRY
T3501 NOTE 1 Transmission of MANAGE UE POLICY COMMAND MANAGE UE POLICY COMMAND
COMPLETE or MANAGE UE POLICY COMMAND REJECT message received Retransmission of
MANAGE UE POLICY COMMAND message
NOTE 1: The value of this timer is network dependent.
* * *
# D.8 Handling of unknown, unforeseen, and erroneous UPDS data
## D.8.1 General
The procedures specified in the subclause apply to those messages which pass
the checks described in this subclause.
This subclause also specifies procedures for the handling of unknown,
unforeseen, and erroneous UPDS data by the receiving entity. These procedures
are called \"error handling procedures\", but in addition to providing
recovery mechanisms for error situations they define a compatibility mechanism
for future extensions of the UPDS.
Subclauses D.8.1 to D.8.8 shall be applied in order of precedence.
Detailed error handling procedures in the network are implementation dependent
and may vary from PLMN to PLMN. However, when extensions of UPDS are
developed, networks are assumed to have the error handling which is indicated
in this subclause as mandatory (\"shall\") and that is indicated as strongly
recommended (\"should\").
Also, the error handling of the network is only considered as mandatory or
strongly recommended when certain thresholds for errors are not reached during
a dedicated connection.
For definition of semantical and syntactical errors see 3GPP TS 24.007 [11],
subclause 11.4.2.
## D.8.2 Message too short or too long
### D.8.2.1 Message too short
When a message is received that is too short to contain a complete message
type information element, that message shall be ignored, c.f. 3GPP TS 24.007
[11].
### D.8.2.2 Message too long
The maximum size of a UE policy delivery service message is 65535 octets.
## D.8.3 Unknown or unforeseen procedure transaction identity
### D.8.3.1 Procedure transaction identity
The following network procedures shall apply for handling an unknown,
erroneous, or unforeseen PTI received in a UPDS message:
a) In case the network receives a MANAGE UE POLICY COMPLETE message or MANAGE
UE POLICY COMMAND REJECT message in which the PTI value is an assigned or
unassigned value that does not match any PTI in use, the network shall ignore
the UPDS message.
b) In case the network receives a UPDS message in which the PTI value is a
reserved value, the network shall ignore the UPDS message.
The following UE procedures shall apply for handling an unknown, erroneous, or
unforeseen PTI received in a UPDS message:
a) In case the UE receives a UPDS message in which the PTI value is a reserved
value, the UE shall ignore the UPDS message.
## D.8.4 Unknown or unforeseen message type
If the UE or the network receives a UPDS message with message type not defined
for the UPDS or not implemented by the receiver, it shall ignore the UPDS
message.
NOTE: A message type not defined for the UPDS in the given direction is
regarded by the receiver as a message type not defined for the UPDS, see 3GPP
TS 24.007 [11].
If the UE receives a message not compatible with the UPDS state, the UE shall
ignore the UPDS message.
If the network receives a message not compatible with the UPDS state, the
network actions are implementation dependent.
## D.8.5 Non-semantical mandatory information element errors
### D.8.5.1 Common procedures
When on receipt of a message,
a) an \"imperative message part\" error; or
b) a \"missing mandatory IE\" error
is diagnosed or when a message containing:
a) a syntactically incorrect mandatory IE;
b) an IE unknown in the message, but encoded as \"comprehension required\"
(see 3GPP TS 24.007 [11]); or
c) an out of sequence IE encoded as \"comprehension required\" (see 3GPP TS
24.007 [11]) is received,
the UE shall ignore the UPDS message;
the network shall proceed as follows:
the network shall:
1) try to treat the message (the exact further actions are implementation
dependent); or
2) ignore the message.
## D.8.6 Unknown and unforeseen IEs in the non-imperative message part
### D.8.6.1 IEIs unknown in the message
The UE shall ignore all IEs unknown in a message which are not encoded as
\"comprehension required\" (see 3GPP TS 24.007 [11]).
The network shall take the same approach.
### D.8.6.2 Out of sequence IEs
The UE shall ignore all out of sequence IEs in a message which are not encoded
as \"comprehension required\" (see 3GPP TS 24.007 [11]).
The network should take the same approach.
### D.8.6.3 Repeated IEs
If an information element with format T, TV, TLV, or TLV-E is repeated in a
message in which repetition of the information element is not specified in
subclause D.5, the UE shall handle only the contents of the information
element appearing first and shall ignore all subsequent repetitions of the
information element. When repetition of information elements is specified, the
UE shall handle only the contents of specified repeated information elements.
If the limit on repetition of information elements is exceeded, the UE shall
handle the contents of information elements appearing first up to the limit of
repetitions and shall ignore all subsequent repetitions of the information
element.
The network should follow the same procedures.
## D.8.7 Non-imperative message part errors
This category includes:
a) syntactically incorrect optional IEs; and
b) conditional IE errors.
### D.8.7.1 Syntactically incorrect optional IEs
The UE shall treat all optional IEs that are syntactically incorrect in a
message as not present in the message.
The network shall take the same approach.
### D.8.7.2 Conditional IE errors
When upon receipt of a UPDS message the UE diagnoses a \"missing conditional
IE\" error or an \"unexpected conditional IE\" error, or when it receives a
UPDS message containing at least one syntactically incorrect conditional IE,
the UE shall ignore the message.
When the network receives a message and diagnoses a \"missing conditional IE\"
error or an \"unexpected conditional IE\" error or when it receives a message
containing at least one syntactically incorrect conditional IE, the network
shall either:
a) try to treat the message (the exact further actions are implementation
dependent); or
b) ignore the message.
## D.8.8 Messages with semantically incorrect contents
When a message with semantically incorrect contents is received, the UE shall
perform the foreseen reactions of the procedural part of subclauses D.2. If,
however no such reactions are specified, the UE shall ignore the message.
The network should follow the same procedure.
###### ## Annex E (informative): Void
#