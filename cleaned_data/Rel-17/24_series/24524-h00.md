# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the architecture and functionality required to
support enterprise and corporate services as IMS applications hosted in the
NGN operator\'s network on behalf of an enterprise (Hosted Enterprise
Services).
The present document also specifies the protocol requirements for the UE to
attach to the NGN (in particular the IMS) and also any protocol requirements
related to application servers provided in support of hosted enterprise
services.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] ETSI ES 282 001 (V3.4.1): \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); NGN Functional
Architecture Release 1\".
[2] ETSI ES 282 007 (V2.1.1): \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); IP Multimedia
Subsystem (IMS); Functional architecture\".
[3] ETSI TS 182 012 (V2.1.4): \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); IMS-based PSTN/ISDN
Emulation Subsystem; Functional architecture\".
[4] ETSI ETS 300 738 (First edition): \"Human Factors (HF); Minimum Man-
Machine Interface (MMI) to public network based supplementary services\".
[5] 3GPP TS 23.228: \"Technical Specification Group Services and System
Aspects; IP Multimedia Subsystem (IMS); Stage 2\".
[6] 3GPP TS 23.167: \"Technical Specification Group Services and System
Aspects; IP Multimedia Subsystem (IMS) emergency sessions\".
[7] 3GPP TS 33.203: \"Technical Specification Group Services and System
Aspects; 3G Security; Access security for IP-based services\".
[8] Void.
[9] IETF RFC 3323 (December 2002): \"A Privacy Mechanism for the Session
Initiation Protocol (SIP)\".
[10] IETF RFC 3325 (December 2002): \"Private Extensions to the Session
Initiation Protocol (SIP) for Asserted Identity within Trusted Networks\".
[11] Void.
[12] ETSI ES 282 002 (V1.1.1): \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); PSTN/ISDN Emulation
Subsystem (PES); Functional Architecture\".
[13] 3GPP TS 32.260: \"Technical Specification Group Services and System
Aspects; Telecommunication management; Charging management; IP Multimedia
Subsystem (IMS) charging**\"**.
[14] 3GPP TS 22.519: \"Technical Specification Group Services and System
Aspects; Business communication requirements\".
[15] 3GPP TS 24.229: \"Technical Specification Group Core Network and
Terminals; IP Multimedia Call Control Protocol based on Session Initiation
Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".
[16] ETSI TS 183 043 (V3.4.1): \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); IMS based PSTN/ISDN
Emulation Stage 3 specification\".
[17] 3GPP TS 24.628: \"Technical Specification Group Core Network and
Terminals; Common Basic Communication procedures using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[18] Void.
[19] IETF RFC 5031 (January 2008): \"A Uniform Resource Name (URN) for
Emergency and Other Well-Known Services\".
[20] 3GPP TS 24.611: \"Technical Specification Group Core Network and
Terminals; Anonymous Communication Rejection (ACR) and Communication Barring
(CB) using IP Multimedia (IM) Core Network (CN) subsystem; Protocol
specification\".
[21] IETF RFC 3966 (December 2004): \"The tel URI for Telephone Numbers\".
[22] IETF RFC 3261 (July 2002): \"SIP: Session Initiation Protocol\".
[23] IETF RFC 4967 (July 2007): \"Dial String Parameter for the Session
Initiation Protocol Uniform Resource Identifier\".
[24] IETF RFC 7316 (July 2014): \"The Session Initiation Protocol (SIP)
P‑Private-Network-Indication Private-Header (P-Header)\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TS 22.519 [14], 3GPP TS 24.229 [15] and ETSI TS 183 043 [16] apply:
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
AGCF Access Gateway Control Function
AGF Access Gateway Function
AS Application Server
BGCF Breakout Gateway Control Function
BGF Border Gateway Function
CNGCF Customer Network Gateway Configuration Function
CS Circuit Switched
CSCF Call Session Control Function
HES Hosted Enterprise Services
I-BGF Interconnection-Border Gateway Function
I-CSCF Interrogating-Call Session Control Function
IFC Initial filter Criteria
IMS IP Multimedia Subsystem
IN Intelligent Network
IP Internet Protocol
IPCAN IP Connectivity Access Network
ISC IMS Service Control
ISDN Integrated Services Digital Network
LDAP Lightweight Directory Access Protocol
MGCF Media Gateway Control Function
MGF Media Gateway Function
MRFC Multimedia Resource Function Controller
MRFP Multimedia Resource Function Processor
NASS Network Attachment SubSystem
NGCN Next Generation Corportate Network
NGN Next Generation Network
NGN Next Generation Network
P-CSCF Proxy-Call Session Control Function
PES PSTN/ISDN Emulation Subsystem
PSTN Public Switched Telephony Network
RACS Resource and Admission Control Subsystem
RG Residential Gateway
SCP Service Control Functio
S-CSCF Serving-Call Session Control Function
SGF Signalling Gateway Function
SIP Session Initiation Protocol
SLF Subscription Locator Function
SPDF Service-based Policy Decision Function
T-MGF Trunking-Media Gateway Function
UE User Equipment
UEE User Equipment Emulation
UPSF User Profile Server Function
URI Uniform Resource Identifier
URN Uniform Resource Name
VGW Voice over IP Gateway
# 4 Overview
Hosted Enterprise Services (HES) refers to a solution where an NGN hosts all
business communication capabilities to a set of endpoints connected to a
plurality of access points to this network. This type of network solution is
also known as IP Centrex.
In the simplest configuration all endpoints are connected to a TISPAN NGN IP-
CAN. Endpoints may be SIP phones or legacy phones (Analogue or ISDN) connected
to a gateway. All services by HES are provided by application servers using
standard IMS procedures. User may access services that are specific to the
enterprise they belong to as well as services available to any other IMS
users.
In more complex configurations some of the endpoints may be connected to a
3GPP IPCAN and/or a circuit-switched network, which is itself connected to the
IMS via an MGCF. Endpoints connected to heterogeneous access networks may be
served by the same HES.
Endpoints served by a HES shall have the ability to setup a session,
identifying the communication target by:
\- a SIP URI of the form user \@domain;
\- an E.164 telephone number;
\- a number within a private numbering plan;
\- local service numbers.
With regard to supplementary services, HES have strong similarities with the
provision of PSTN/ISDN simulation services, although the actual set of
services may be different. Examples of services that are enabled by the
architecture described in the present document are:
\- All commonly used PSTN/ISDN services.
\- IMS Multimedia Messaging, Presence and Conferencing services.
\- Personal and Corporate Directory.
\- Unified Voice mail.
\- Operator assisted communications.
\- Hot Line Calling.
\- Abbreviate dialling.
\- Line Hunting.
\- Attended Communication Transfer.
\- Blind Communication Transfer.
\- Communication Pickup.
\- Manager/Secretary filtering.
\- Click to Dial.
Colour Ring Back Tone.
The sole purpose of the above list of services is to illustrate the type of
services that are enabled by the architecture described in the present
document. This list is not intended to be exhaustive nor is it expected that
all implementations will support all of these services. The list actual of
enterprise services hosted in a network is a matter for each operator to
decide.
NOTE: The present document provides a number of examples where domain names
are used. It should be noted that these are for information only and are not
intended to place any constraint on the structure and management of domain
names as long as they are globally routable.
# 5 Architecture
## 5.1 Functional Architecture
### 5.1.1 Overview
The functional architecture for supporting access to Hosted Enterprise
Services is illustrated in figure 1. This functional architecture supports
access from both SIP based endpoints and legacy endpoints.
The functional architecture for supporting access to Hosted Enterprise
Services from both types of endpoints is obtained by a combination of the Core
IMS Architecture defined in ETSI ES 282 007 [2] with the addition of an AGCF
as defined in ETSI TS 182 012 [3] and ETSI ES 282 002 [12]. This should not be
understood as an integration of an AGCF into the functional architecture
defined in ETSI ES 282 007 [2]. The AGCF only applies to configurations where
an H.248-controlled media gateway is required in support of legacy endpoints.
Figure 1: Functional architecture overview
All functional entities behave as defined in ETSI ES 282 007 [2], ETSI TS 182
012 [3] and/or ETSI ES 282 002 [12].
The service logic of the HES resides in one or more application servers. All
sessions to/from a member of a HES shall be handled by at least one
application server.
The service logic of the HES can be provided by the home network operator, or
can be provided by a third party service provider. It is also possible that
the enterprise itself provides the services, by providing equipment that acts
as an application server beyond an ISC gateway function.
SIP-based endpoints may be connected to the IMS via any IP¨CAN valid for the
current specification release. A HES may serve endpoints connected through
both types of IP-CANs.
Legacy endpoints may be connected via a media gateway or a SIP-based Voice
over IP Gateway (VGW). Both types of gateways may be part of the User
Equipment (UE) or reside in the TISPAN IP-CAN. A SIP-based Voice over IP
Gateway (VGW) plays the role of a UE with regards to the P-CSCF. A media
gateway is controlled by the AGCF, which plays the combined role of a UE and a
P-CSCF with regards to other CSCFs of the IMS.
ETSI TS 182 012 [3] provides a more detailed specification of the procedures
that a VGW and AGCF shall support for enabling access to IMS-supported
services from legacy endpoints.
NOTE: The concepts of \"Media Gateway\" and AGCF are defined in both ETSI TS
182 012 [3] and ETSI ES 282 002 [12]. A Media Gateway implements the R-MGF or
A-MGF functional entities defined in ETSI ES 282 001 [1]. ETSI ES 282 002 [12]
uses different names to refer to a Media Gateway depending on its location: a
media gateway located in the customer premises is referred to as a Residential
Gateway (RG) while a media gateway located in the IP-CAN is referred to as an
Analogue Gateway Function (AGF).
### 5.1.2 Involved functional entities - originating session
Figure 2 shows the functional entities involved in an originating session.
Figure 2: Functional entities involved in originating sessions
NOTE: Figure 2 does not show the intermediate functions between the P-CSCF and
the S-CSCF, or those between the S-CSCF and the terminating side.
The originating side can interoperate with any other terminating side
scenario.
### 5.1.3 Involved functional entities - terminating session
Figure 3 shows the functional entities involved in a terminating session.
Figure 3: Functional entities involved in terminating sessions
NOTE: Figure 3 does not show the intermediate functions between the P-CSCF and
the S-CSCF, or those between the S-CSCF and the originating side.
The terminating side can interoperate with any other originating side
scenario.
## 5.2 Architecture involving heterogeneous core networks
A HES can serve a set of endpoints some of which being connected to the IMS
and some others being connected to Circuit-Switched (CS) networks. Example
scenarios are shown in annex B.
# 6 Procedures
## 6.1 Registration
Registration procedures comply with 3GPP TS 23.228 [5] or ETSI TS 182 012 [3]
depending on the type of endpoint.
NOTE: Registration procedures for endpoints not connected directly to a 3GPP
or TISPAN IP CAN are outside the scope of the present document.
The IMS public user identity used at registration is in the form of a SIP URI.
This SIP URI can include a user name in the form of a telephone number with a
user=phone parameter where the telephone number is either a public e.164 or a
private number; if private numbers are used, the private numbering plan shall
be uniquely identifiable by the NGN.
## 6.2 Originating session procedures
Originating communication setup procedures shall comply with 3GPP TS 23.228
[5] or ETSI TS 182 012 [3] depending on the type of endpoint.
In addition to the procedures specified in this subclause, the UE shall comply
with the requirements identified in 3GPP TS 24.229 [15], subclause 4.1.
In addition to the procedures specified in the following subclauses, the AGCF
shall comply with the procedures specified in ETSI TS 183 043 [16] appropriate
to this entity.
In addition to the procedures specified in the following subclauses, each IMS
functional entity shall comply with the procedures specified in the clauses of
3GPP TS 24.229 [15] and 3GPP TS 24.628 [17] appropriate to this entity.
An AS providing the logic of an originating HES may provide communication
admission control in terms of number of simultaneous communications to/from
this particular HES.
Support of private numbering is described in subclause 6.5.
Certain services require that the UE or an AGCF can be configured to insert a
default session destination in the Request URI when a dialstring is not
entered by the end user. In the case of the UE, the default session
destination may be manually configured by the user or received from the CNGCF.
This configured default session destination can either point to the
terminating end point for the session or a value independent from the actual
destination. In the latter case, the AS acting as the originating HES
determines the actual session destination from local configuration data and/or
the user profile and rewrites the Request URI.
The AS procedures for modification of the P-Asserted-Identity headers fields
for originating requests typically depend on:
\- operator and enterprise domain policies;
\- privacy settings as specified in IETF RFC 3323 [9] and IETF RFC 3325 [10];
\- whether the destination belongs to the same enterprise domain than the
session initiator.
with the following restrictions:
\- when the terminating endpoint is outside the HES\'s domain (i.e. public
domain or business trunking services see note) and no privacy restrictions
apply, the identity in the P-Asserted-Identity representing the HES user shall
be a globally routable SIP or tel URI.
NOTE: The originating side hosted enterprise services scenario can
interoperate with any other terminating scenario.
As an example, an AS providing the logic of an originating HES, based on
enterprise policies, can perform the following changes with regards to the
identities it receives in INVITE messages:
\- override the P-Asserted-Identity to an identity derived from the received
value. This identity is in the form of a telephone number representing for
example an attendant or in the form of a URI of type user\@domain, where the
user part represents the HES or a partition of this HES (e.g. site-based
partitions) and the domain part represents the enterprise;
\- override the URI part of the From header field with the value received in
the P-Asserted-Id header field, with the exception that an anonymous value in
the From header field must not be modified.
Depending on the type of changes made, the AS will act as a SIP Proxy as
defined in 3GPP TS 24.229 [15], subclause 5.7.4, as a Routing B2BUA or an
Initiating B2BUA, as defined in 3GPP TS 24.229 [15], subclause 5.7.5.
## 6.3 Terminating session procedures
Terminating communication setup procedures shall comply with 3GPP TS 23.228
[5] or ETSI TS 182 012 [3] depending on the type of endpoint.
In addition to the procedures specified in this subclause, the UE shall comply
with the requirements identified in\ 3GPP TS 24.229 [15], subclause 4.1.
In addition to the procedures specified in the following clauses, the AGCF
shall comply with the procedures specified in ETSI TS 183 043 [16] appropriate
to this entity.
In addition to the procedures specified in the following clauses, each IMS
functional entity shall comply with the procedures specified in the clauses of
3GPP TS 24.229 [15] and 3GPP TS 24.628 [17] appropriate to this entity. An AS
providing the logic of an terminating HES may provide communication admission
control in terms of number of simultaneous communications sent to/from this
particular HES.
Terminating communications to a group is described in subclause 6.6.
## 6.4 Emergency communications
The AGCF procedures for emergency communication are specified in ETSI TS 183
043 [16].
Processing of emergency communications by other network entities shall conform
to 3GPP TS 23.167 [6], except where the enterprise requires a special
arrangement whereby emergency communications are delivered to a destination
within the enterprise (hosted or supported by an NGCN). Such an arrangement
may also involve enterprise specific emergency numbers.
NOTE: Procedures for supporting the above special arrangement are outside the
scope of the present document.
## 6.5 Capabilities provided to an enterprise
### 6.5.1 General
Hosted enterprise services (HES) are deployed on one or more applications
servers. HES may provide enterprise level capabilities. When such capabilities
are offered to a specific enterprise the initial filter criteria of the
service profile of a connected HES user needs to be configured so that the
S-CSCF that serves the HES user invokes the AS that hosts the HES.
The intent of this subclause is not to specify the detail of the individual
services, but only to indicate some specific impacts on the protocol.
3GPP TS 22.519 [14] defines the enterprise capabilities that HES shall
support, this subclause specifies protocol impact of the different
applications.
### 6.5.2 Routeing capabilities
#### 6.5.2.1 Overview
#### 6.5.2.2 Break-in
No specific protocol action is required for a HES providing break-in.
#### 6.5.2.3 Break-out
When break-out is enabled for a specific enterprise, a HES converts incoming
private network traffic to public network traffic if the conditions agreed
between the enterprise and the NGN operator indicate this.
To convert private network traffic to public network traffic the break-out
service shall remove\ Private-Network-Indicator header field if present as
specified in IETF RFC 7316 [24], from the initial request for a dialog or
standalone request for a transaction.
To allow this service to be provided it needs to be ensured that the HES logic
offering this service will be inserted in the signalling path of sessions
originating from and terminating to the served HES user.
### 6.5.3 Communication admission control
When communication admission control is enabled a HES serving an enterprise
executes the NGN operator defined set of rules or policies under which
communication admission control applies, and the enterprise should be able to
configure the capability within those rules and policies.
To allow this service to be provided it needs to be ensured that the HES logic
offering this service will be inserted in the signalling path of sessions
originating from and terminating to the served HES user.
### 6.5.4 Anonymous communication rejection
When anonymous communication rejection is enabled a terminating HES serving a
HES user providing this service shall implement the procedure as specified in
3GPP TS 24.611 [20], subclause 4.5.2.6.2.
To allow this service to be provided it needs to be ensured that the HES logic
offering this service will be inserted in the signalling path of sessions
terminating to the served HES user.
## 6.6 Private numbering
### 6.6.1 General
Sessions from endpoints served by a HES can be established using private
numbering to any type of destination, including the PSTN, another endpoint
served by the same or different HES, an endpoint served by an NGCN belonging
to the same or a different enterprise as well as any other IMS user.
The following subclauses provide further details on the handling of private
numbering by the UE and the network.
NOTE: In case of legacy endpoints the UE procedures required in support of
private numbering are performed by the functional entity providing the UE role
with regards to the IMS (i.e. AGCF or VGW).
6.6.2 UE behaviour
#### 6.6.2.1 General
Private numbering information is sent in the Request-URI of the originating
SIP requests, using one of the following formats:
1) A TEL URI, complying with IETF RFC 3966 [21], with a local number followed
by a phone-context value.
2) A SIP URI, complying with IETF RFC 3261 [22], with the user =phone
parameter.
3) A SIP URI, complying with IETF RFC 3261 [22] and IETF RFC 4967 [23], with
the user=dialstring parameter.
NOTE: A UE can use a SIP URI complying with IETF RFC 3261 [22], where the user
part contains a string of digits corresponding to a private number and the
domain name is specific enough to enable the network to understand that the
user part contains private numbering information and the context in which it
has to be interpreted.
The actual value of the URI depends on whether the user equipment performs an
analysis of the dial string input by the end user.
#### 6.6.2.2 UE without dial string processing capabilities
In this case the UE does not perform any analysis of the dial string. This
requires that the dialling plan be designed so as to enable the AS acting as
an originating HES to differentiate private numbers from other numbers.
The dial string may be sent to the network, in the Request URI of SIP
requests, using one of the following formats:
1) A TEL URI, syntactically complying with IETF RFC 3966 [21], with the dial
string encoded as a local number followed by a pre-configured fixed phone-
context value.
EXAMPLE: tel:\;phone-
context=unprocesseddialstring.example.com.
2) A SIP URI, syntactically complying with IETF RFC 3261 [22], with the user
=phone parameter, embedding a TEL‑URI with a pre-configured fixed phone-
context value.
EXAMPLE: sip:\;\ phone-
context=unprocesseddialstringexample.com\@operator.com;user=phone.
3) A SIP URI, complying with IETF RFC 3261 [22] and IETF RFC 4967 [23], with
the user=dialstring parameter and a with a pre-configured fixed phone-context
value in the user part.
EXAMPLE: sip:\;\ phone-
context=unprocesseddialstringexample.com\@operator.com;user=dialstring.
4) A SIP URI syntactically complying with IETF RFC 3261 [22], where the user
part contains the dial string and the domain name is specific enough to enable
to network to understand that the user part contains a dial string.
EXAMPLE: sip:\\@dialstrings.entreprise.com.
#### 6.6.2.3 UE with dial string processing capabilities
In this case the UE performs sufficient dial string analysis (or receives an
explicit indication from the user) to identify whether private numbering is
used and processes the dial string accordingly before building the Request-
URI.
If the UE detects that a public dialling plan or a private dialling plan is
being used, where the terminal is able to identify a global telephone number,
the procedures described in 3GPP TS 24.229 [15] apply after removing all dial
string elements used for public numbering detection purposes (e.g. escape
codes).
If the UE detects that a private dialling plan is being used, it may decide to
send the dial string unchanged to the network or to alter it to comply with
the private numbering plan (e.g. remove all dial string elements used for
private numbering detection).
Annex A provides examples of UE processing options and of population rules for
the Request-URI fields and parameters. As a general rule, recognition of
special service numbers takes priority over other dialling plan issues. If the
dial string equates to a pre-configured service URN (see IETF RFC 5031 [19])
then the service URN should be sent.
6.6.3 Network behaviour
The use of numbers in PNPs and in user specific dial plans shall be provided
in the following manner:
1) The P-CSCF or AGCF routes the session towards the S-CSCF as per the session
origination procedures.
Processing the Request URI (e.g. address analysis and potential modification
such as translation into globally routable format) shall be performed by an AS
providing the logic of an originating HES in the user\'s Home Network. The
S-CSCF routes the SIP request towards this AS based upon filter criteria.
The translation procedure relies on data stored in the AS or in an external
database, separated from the AS using e.g. a LDAP interface. If user-specific
dialling plans are supported, translation data may also be stored in the UPSF,
in which case the AS accesses this data using the Sh reference point.
2) This AS passes the session request back to the S-CSCF with a Request URI
that contains either a globally routable SIP URI or a Tel URI with a number in
international format. The SIP request shall contain enough information to
route to the terminating network and allow the terminating network to identify
the intended end point.
3) After processing the Request URI the S-CSCF shall route the SIP request,
via normal IMS routing principles, towards its destination.
## 6.7 Group Management
One or more IMS groups (as defined in 3GPP TS 23.228 [5]) may be associated
with one or more HESs. Each group shall be addressable by a globally unique
group identifier. The group identifier shall take the form of a Public Service
Identifier.
## 6.8 Supplementary service control
It shall be possible to configure all services (e.g. communication forwarding
conditions, selective communication filtering criteria, etc.) using the Ut
reference point, a Web portal or using service code commands.
Users shall be able to control supplementary services using service code
commands sent in session initiation requests. One possible syntax for such
commands is defined in ETSI ETS 300 738 [4], in which case the actual values
used in the different fields of the commands may differ from those specified
in ETSI ETS 300 738 [4] ( and service code commands (excluding the START and
FINISH fields) shall be encoded as a local-number using and appropriate
\"phone-context\" value.
# 7 Void
# 8 Security issues
The security requirements for the support of HES are specified in 3GPP TS
33.203 [7].
# 9 Management Issues
## 9.1 Configuration/provisioning issues
### 9.1.1 UPSF
Appropriate Initiate Filter Criteria have to be configured in the UPSF for
each of the public user identities associated to HES usage. Within a user
profile, one of the IFCs shall lead to the AS providing the HES logic for the
user.
Shared IFCs may be used to ease provisioning and minimize the amount of
signalling information over the Cx reference point.
### 9.1.2 User Equipment
SIP-based User Equipment can be configured with the following pieces of
information:
\- Rules the UE must apply to dialled numbers in order to detect the use of
private numbering plans and determine which private numbering plan is being
used.
NOTE: It is expected that these rules do not require a complete number to be
available to derive a private numbering plane.
\- Phone-context identifiers or domain names associated to each numbering plan
supported inside their HES domain.
### 9.1.3 AGCF
The AGCF shall be configured with the same pieces of information than a SIP-
based User Equipment.
### 9.1.4 Charging issues
The charging architecture and functions defined in 3GPP TS 32.260 [13] are
applicable.
Charging Information on operator-assisted communications shall be collected
and recorded for the public user identity of the actual calling user rather
than the public user identity of the operator, even though this operator may
be connected to the network as a normal user. The collected information shall
enable creating a consolidated charging record including the information
related to the segment between the user and the operator and between the
operator and the destination.
Charging records shall keep track of the services invoked during each
communication.
Charging records shall contain sufficient information to enable generating
consolidated reports based on:
\- the distribution of communications during a day, a week, a month or a year;
\- the distribution between internal and external communications;
\- the number of incoming/outgoing communications;
\- the number of nationals/internationals sessions;
\- the number of forwarded communications per forwarding condition;
\- the use of voice mail and conferencing services;
\- the number of successful/unsuccessful communications.
###### ## Annex A (informative): Processing of dial strings by the UE
Processing of a dial string by a UE depends on whether one or more private
numbering plans are supported.
# A.1 Single private numbering plan
If the UE detects that a private dialling plan is being used, it may decide to
send the dial string unchanged to the network or to alter it to comply with
the private numbering plan (e.g. remove all dial string elements used for
private numbering detection). The resulting dial string may be sent, in the
Request URI of SIP requests, using one of the following formats:
1) A TEL URI, complying with IETF RFC 3966 [21], with local number and a pre-
configured fixed phone-context value.
tel:\;phone-context=pnp.entreprise.com.
2) A SIP URI, complying with IETF RFC 3261 [22], with the user =phone
parameter.
sip:\;phone-
context=pnp.entreprise.com\@operator.com;user=phone.
3) A SIP URI, complying with IETF RFC 3261 [22] and IETF RFC 4967 [23], with
the user =dialstring parameter (see note).
sip:\;phone-
context=pnp.entreprise.com\@operator.com;user=dialstring.
NOTE: This option only applies if the dial string was not completely processed
into a private number string.
4) A SIP URI complying with IETF RFC 3261 [22], where the user part contains
the dialled string (possibly modified) and the domain name is specific enough
to enable to network to understand that the user part contains a dialstring
according to a private numbering plan or private dialling plan.
sip:\\@pnp.entreprise.com.
In the first three cases, the phone-context value indicates that a private
number is being used that belongs to the single private numbering plan.
# A.2 Multiple private numbering plans
If the end user is entitled to use more than one private numbering plan, the
UE will either proceed as above, providing that the remaining dial string
contains sufficient information for the network to identify the private
numbering plan being used, or determine the private numbering plan being used
and send the dial string in the Request URI of SIP requests, using one of the
following formats:
1) A TEL URI, complying with IETF RFC 3966 [21], with local number and a pre-
configured phone-context value corresponding to the private numbering plan
used.
tel:\;phone-context=pnp-value.entreprise.com.
2) A SIP URI, complying with IETF RFC 3261 [22], with the user =phone
parameter.
sip:\;phone-context=pnp-
value.entreprise.com\@operator.com;user=phone.
3) A SIP URI, complying with IETF RFC 3261 [22] and IETF RFC 4967 [23], with
the user =dialstring parameter (see note).
sip:\;phone-context=pnp-
value.entreprise.com\@operator.com;user=dialstring.
NOTE: This option only applies if the dial string was not completely processed
into a private number string.
4) A SIP URI complying with IETF RFC 3261 [22], where the user part contains
the dialled string (possibly modified) and the domain name is specific enough
to enable to network to understand that the user part contains a dial string
according to a particular private numbering plan or private dialling plan.
sip:\\@pnp-value.entreprise.com.
In the first three cases, the phone-context value indicates the private
numbering plan the dial string belongs to.
###### ## Annex B (informative): Scenarios for HES extension to CS users
Figure B.1 provides an overview of a functional architecture that can support
a number of deployment scenarios for extending HES to CS endpoints. Functions
within the dotted box in figure B.1 represent functions that may physically
reside in one or more IMS application servers. For a given deployment scenario
not all of the functions may be needed however to provide HES to a CS endpoint
at least one AS will contain HES logic.
NOTE: A multimode UE is included in the set of endpoints a HES can serve. An
example of a multimode UE is one that can assume the UE role and the Legacy
Endpoint role (see figure B.1). Simultaneous connectivity to IP-CAN and CS is
subject to the constraints of the access network and the UE.
Figure B.1: Functional Architecture for supporting hybrid accesses
The functional architecture shown in figure B.1 allows the following
deployment scenarios:
**\- Scenario 1 (S1):** In this scenario IN triggers in the CS network route
the call to an IN SCF interacts with the HES logic. The IN SCF controls the
call in the CS network as per the HES logic. For this approach both the IN SCF
and HES logic are co-located in the same IMS AS.
**\- Scenario 2 (S2):** In this scenario IN triggers in the CS network route
the call to an IN SCF which has access to HES routing data. The IN SCF
redirects the call to the IMS. HES are applied to the session using the ISC
reference point to access the IMS logic which in turn accesses the HES logic.
**\- Scenario 3 (S3):** In this scenario the CS network routes calls from CS
users to the IMS. The mechanism by which this re-routing is achieved is out of
scope of the present document. Upon entering the IMS PSI routing is used to
route the call to the IMS User Equipment Emulation (UEE). The UEE is used to
anchor the call in the IMS. The UEE uses IMS logic to initiate a session into
the IMS on behalf of the CS endpoint. To apply HES the filter criteria for
this pseudo user will include the HES. HES are invoked using the ISC reference
point to access the IMS logic which in turn accesses the HES logic. For calls
to the CS user, the UEE will be configured in the terminating filter criteria
to be the last application in the chain.
#