# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides the protocol details for multimedia telephony
communication service and associated supplementary services in the IP
Multimedia (IM) Core Network (CN) subsystem based on the requirements from
3GPP TS 22.173 [2].
Multimedia telephony and supplementary services allow users to establish
communications between them and enrich that by enabling supplementary
services.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.173: \"IP Multimedia Core Network Subsystem (IMS) Multimedia
Telephony Service and supplementary services; Stage 1\".
[3] 3GPP TS 24.604: \"Communication Diversion (CDIV); Protocol specification
using IP Multimedia (IM) Core Network (CN) subsystem; Protocol specification
\".
[4] 3GPP TS 24.605: \"Conference (CONF) using IP Multimedia (IM) Core Network
(CN) subsystem; Protocol specification\".
[5] 3GPP TS 24.606: \"Message Waiting Indication (MWI) using IP Multimedia
(IM) Core Network (CN) subsystem; Protocol specification\".
[6] 3GPP TS 24.607: \"Originating Identification Presentation (OIP) and
Originating Identification Restriction (OIR) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[7] 3GPP TS 24.608: \"Terminating Identification Presentation (TIP) and
Terminating Identification Restriction (TIR) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[8] 3GPP TS 24.610: \"Communication HOLD (HOLD) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[9] 3GPP TS 24.611: \"Anonymous Communication Rejection (ACR) and
Communication Barring (CB) using IP Multimedia (IM) Core Network (CN)
subsystem; Protocol specification\".
[10] 3GPP TS 24.629: \"Explicit Communication Transfer (ECT) using IP
Multimedia (IM) Core Network (CN) subsystem; Protocol specification\".
[11] 3GPP TS 24.623: \"Extensible Markup Language (XML) Configuration Access
Protocol (XCAP) over the Ut interface for Manipulating Simulation Services\".
[12] 3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia telephony;
Media handling and interaction\".
[13] 3GPP TS 24.229: \"Internet Protocol (IP) multimedia call control protocol
based on Session Initiation Protocol (SIP) and Session Description Protocol
(SDP); Stage 3\".
[14] 3GPP TS 24.247: \"Messaging using the IP Multimedia (IM) Core Network
(CN) subsystem; Stage 3\".
[15] Void
[16] IETF RFC 3841 (August 2004): \"Caller Preferences for the Session
Initiation Protocol (SIP)\".
[17] 3GPP TS 24.647: \"Advice Of Charge (AOC) using IP Multimedia (IM)Core
Network (CN) subsystem; Protocol Specification\".
[18] 3GPP TS 24.654: \"Closed User Group (CUG) using IP Multimedia (IM) Core
Network (CN) subsystem, Protocol Specification\".
[19] 3GPP TS 24.239: \"IP Multimedia Subsystem (IMS) Flexible alerting
supplementary service\".
[20] 3GPP TS 24.238: \"Session Initiation Protocol (SIP) based user
configuration; stage 3\".
[21] 3GPP2 C.S0055-A: \"Packet Switched Video Telephony Services\".
[22] ETSI TS 181 005: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Service and Capability
Requirements\".
[23] 3GPP TS 24.615: \"Communication Waiting (CW) using IP Multimedia (IM)
Core Network (CN) subsystem, Protocol Specification\".
[24] 3GPP TS 24.642: \"Completion of Communications to Busy Subscriber (CCBS)
Completion of Communications by No Reply (CCNR) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[25] 3GPP TS 24.182: \"**IP Multimedia Subsystem (IMS) Customized Alerting
Tones (CAT); Protocol specification** \".
[26] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
[27] 3GPP TS 24.183: \"**IP Multimedia Subsystem (IMS) Customized Ringing
Signal (CRS); Protocol specification** \".
[28] IETF RFC 3362 (August 2002): \"Real-time Facsimile (T.38) - image/t38
MIME Sub-type Registration\".
[29] 3GPP TS **24.259:** \"Personal Network Management (PNM); Stage 3\".
[30] 3GPP TS 24.390: \"Unstructured Supplementary Service Data (USSD) using IP
Multimedia (IM) Core Network (CN) subsystem IMS; Stage 3\".
[31] IETF RFC 6809 (November 2012): \"Mechanism to Indicate Support of
Features and Capabilities in the Session Initiation Protocol (SIP)\".
[32] 3GPP TS 24.167: \"3GPP IMS Management Object (MO); Stage 3\".
[33] 3GPP TS 23.221: \"Architectural requirements\".
[34] Void.
[35] 3GPP TS 24.628: \"Common Basic Communication procedures using IP
Multimedia (IM) Core Network (CN) subsystem; Protocol Specification\".
[36] 3GPP TS 24.275: \"Management Object (MO) for basic communication part of
IMS multimedia telephony (MMTEL) communication service\".
[37] 3GPP TS 22.011: \"Service accessibility\".
[38] 3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity
Module (USIM) application\".
[39] 3GPP TS 24.196: \"Technical Specification Group Core Network and
Terminals; Enhanced Calling Name\".
[40] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols; Stage 3\".
[41] 3GPP TS 23.122: \"Non-Access-Stratum functions related to Mobile Station
(MS) in idle mode\".
[42] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[43] 3GPP TS 24.174: \"Support of Multi-Device and Multi-Identity in IMS;
Stage 3\".
[44] IETF RFC 5688 (January 2010): \"A Session Initiation Protocol (SIP) Media
Feature Tag for MIME Application Subtype\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TS 21.905 [1] apply.
**MMTEL voice** : a multimedia telephony communication session as described in
clause 5.2 with only audio or only real-time text or only both audio and real-
time text.
**MMTEL video** : a multimedia telephony communication session as described in
clause 5.2 with video.
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 22.011 [37] apply:
**3GPP PS data off**
**3GPP PS data off exempt service**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.229 [13] apply:
**3GPP PS data off status**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.122 [41] apply:
**Equivalent Home PLMN (EHPLMN)**
**Home PLMN (HPLMN)**
**Visited PLMN (VPLMN)**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.501 [42] apply:
**NG-RAN**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.174 [43] apply:
**MuD**
**MiD**
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
CS Circuit Switched
CN Core Network
ICSI IMS Communication Service Identifier
IP Internet Protocol
IM IP Multimedia
MMTEL Multimedia Telephony
NG-RAN Next Generation Radio Access Network
PS Packet Switched
UDP User Datagram Protocol
UDPTL UDP Transport Layer
# 4 Overview of multimedia telephony communication service and associated
supplementary services in the IP Multimedia (IM) Core Network (CN) subsystem
## 4.1 General
In accordance with the service definition and requirements in 3GPP TS 22.173
[2], the IMS multimedia telephony communication service specified herein
allows multimedia conversational communication between two or more end points.
An end point is typically located in a UE, but can also be located in a
network entity.
As for traditional circuit-switched telephony, the protocols for the IMS
multimedia Telephony communication service allow a user to connect to any
other user, regardless of operator and access technology.
The IMS multimedia Telephony communication service consists of two principal
parts: a basic communication part, and an optional supplementary services
part.
## 4.1A Roles
### 4.1A.1 Multimedia telephony participant
A UE shall implement the role of a multimedia telephony participant.
### 4.1A.2 Multimedia telephony application server
An application server shall implement the role of a multimedia telephony
application server. Various application server usages are called out by
references to the various supplementary services, see clause 4.3. It is an
implementation decision on how to allocate the functionality to one or more
application servers.
## 4.2 Overview of basic communication part
The basic communication part of an IMS multimedia telephony communication
service session is realised by a single SIP session. It utilises media
capabilities and flexibility provided by the SIP protocol and the 3GPP IMS
specifications. In accordance with the service definition in 3GPP TS 22.173
[2], media capabilities include RTP-based transfer of voice, real-time video,
real-time text and data, and UDPTL-based transfer of fax (IETF RFC 3362 [28]),
as well as TCP/MSRP-based transfer of text, arbitrary files and sharing of
media files with predefined formats.
To ensure interoperability, media handling (including codecs and formats) is
fully specified for RTP-based and MSRP-based transfer in:
\- 3GPP TS 26.114 [12] for 3GPP systems;
\- 3GPP2 C.S0055-A [21] for 3GPP2 systems; and
\- ETSI TS 181 005 [22] (codecs) and 3GPP TS 26.114 [12] (formats and other
media handling) for fixed-broadband accesses.
The service is highly dynamic in terms of media component usage: the protocols
allow a communication session to start with one or more media components, and
components can then be added and/or removed during the communication session.
The protocols allow both one-way and two ways transfer between end points.
Full duplex speech, and speech combined with other media components, are
typical media cases but the protocols do not mandate the use of speech in all
sessions.
## 4.3 Overview of supplementary services part
The supplementary services part of the IMS multimedia telephony communication
service consists of a number of specified supplementary services. These are
fully standardized to ensure interoperability between multiple end points, and
between end points and network control entities. The behaviour of
supplementary services is similar to supplementary services specified for CS
speech (TS 11). Supplementary services uses SIP as enabling protocol.
Configuration of supplementary services by the user should:
\- take place over the Ut interface using XCAP as enabling protocol as
described in 3GPP TS 24.623 [11]; or
\- use SIP based user configuration as described in 3GPP TS 24.238 [20] ;
NOTE: Other possibilities for user configuration, such as web-based
provisioning or pre-provisioning by the operator are outside the scope of the
present document, but are not precluded.
The \"SS_domain_setting\" leaf in 3GPP TS 24.167 [32] provides a mechanism to:
a) instruct the UE to only use the PS domain for SS setting control;
b) instruct the UE to only use the CS domain for SS setting control; or
c) instruct the UE to use the PS domain for SS setting control when the PS
domain is being used by the UE for voice services, and to use the CS domain
for SS setting control when the CS domain is being used by the UE for voice
services.
If one of the restrictions described in the bullets a) or c) applies, then the
\"PS_domain_IMS_SS_control_preference\" leaf in 3GPP TS 24.167 [32] provides a
mechanism to:
\- restrict the UE to use the Ut interface with XCAP as enabling protocol as
described in 3GPP TS 24.623 [11]; or
\- restrict the UE to use SIP based user configuration as described in 3GPP TS
24.238 [20].
# 5 Basic Communication
## 5.1 IMS communication service identifier
URN used to define the ICSI for the IMS Multimedia Telephony Communication
Service: urn:urn-7:3gpp-service.ims.icsi.mmtel. The URN is registered at
http://www.3gpp.com/Uniform-Resource-Name-URN-list.html.
Summary of the URN: This URN indicates that the device supports the IMS
Multimedia Telephony Communication Service.
The URN is intended primarily for use in the following applications,
protocols, services, or negotiation mechanisms:
This URN is most useful in a communications application, for describing the
capabilities of a device, such as a phone or PDA.
Examples of typical use: Indicating that a mobile phone can support the IMS
Multimedia Telephony Communication Service.
Related standards or documents:
3GPP TS 24.173: \"IMS Multimedia Telephony Communication Service and
Supplementary Services, stage 3\"
## 5.2 Session control procedures
The IMS multimedia telephony communication service can support different types
of media, including media types listed in 3GPP TS 22.173 [2]. The session
control procedures for the different media types shall be in accordance with
3GPP TS 24.229 [13] and 3GPP TS 24.247 [14], with the following additions:
a) Multimedia telephony is an IMS communication service and the P-Preferred-
Service and P-Asserted-Service headers shall be treated as described in 3GPP
TS 24.229 [13]. The coding of the ICSI value in the P-Preferred-Service and
P-Asserted-Service headers shall be according to clause 5.1.
b) The multimedia telephony participant shall include the \"+g.3gpp. icsi-
ref\" header field parameter equal to the ICSI value defined in clause 5.1 in
the Contact header field in initial requests and responses as described in
3GPP TS 24.229 [13].
c) The multimedia telephony participant shall include an Accept-Contact header
field containing the \"+g.3gpp.icsi-ref\" header field parameter containing
the ICSI value defined in clause 5.1 in initial requests. If the multimedia
telephony participant supports the IMS data channel usage as specified in 3GPP
TS 26.114 [12], then the multimedia telephony participant may include an
Accept-Contact header field containing the \"sip.app-subtype\" media feature
tag defined in IETF RFC 5688 [44] with a value of \"webrtc-datachannel\" in a
request for a new dialog or standalone transaction. If the user requests
capabilities other than multimedia telephony and IMS data channel, the Accept-
Contact header field may contain other feature parameters and feature
parameter values, and other Accept-Contact header fields may be added to
express user preferences as per IETF RFC 3841 [16].
NOTE 1: How the user indicates other feature parameters and the feature
parameter values is outside of the scope of this document.
d) The multimedia telephony application server shall include the
\"+g.3gpp.icsi-ref\" header field parameter equal to the ICSI value defined in
clause 5.1 in a Feature-Caps header field in requests sent to the terminating
user and in 1xx or 2xx responses to requests from the originating user as
described in 3GPP TS 24.229 [13] and IETF RFC 6809 [31].
e) The multimedia telephony participant may use the presence of a
\"+g.3gpp.icsi-ref\" header field parameter equal to the ICSI value defined in
clause 5.1 in a Feature-Caps header field in requests and responses as
described in IETF RFC 6809 [31] to determine that a multimedia telephony
application server is participating in the session and multimedia telephony is
the IMS communication service supported for use in the dialog.
NOTE 2: ICSI values with subclass identifiers are considered equal to the
value defined in clause 5.1 when determining that the multimedia telephony
application server is participating in the session.
f) The multimedia telephony application server may insert a Response-Source
header field in accordance with the procedures in clause 5.7.1.0 of 3GPP TS
24.229 [13], where the \"role\" header field parameter is set to \"tas\" when
initiating a failure response to any received request.
## 5.3 Interworking
The multimedia telephony participant could receive initial requests that do
not contain the ICSI value defined in clause 5.1 in the Accept-Contact header
but still invoke the IMS multimedia telephony communication service
application.
## 5.4 Call progress indications
The UE shall support the UE procedures specified in 3GPP TS 24.628 [35].
# 6 Supplementary services and enhancements
## 6.1 High level requirements
## 6.2 Originating Identification Presentation (OIP)
The OIP service is specified in 3GPP TS 24.607 [6].
## 6.3 Originating Identification Restriction (OIR)
The OIR service is specified in 3GPP TS 24.607 [6].
## 6.4 Terminating Identification Presentation (TIP)
The TIP service is specified in 3GPP TS 24.608 [7].
## 6.5 Terminating Identification Restriction (TIR)
The TIR service is specified in 3GPP TS 24.608 [7].
## 6.6 Communication Diversion (CDIV)
The CDIV service is specified in 3GPP TS 24.604 [3].
## 6.7 Communication Hold (HOLD)
The HOLD service is specified in 3GPP TS 24.610 [8].
## 6.8 Communication Barring (CB)
The CB service is specified in 3GPP TS 24.611 [9].
## 6.9 Message Waiting Indication (MWI)
The MWI service is specified in 3GPP TS 24.606 [5].
## 6.10 Conference (CONF)
The CONF service is specified in 3GPP TS 24.605 [4].
## 6.11 Explicit Communication Transfer (ECT)
The ECT service is specified in 3GPP TS 24.629 [10].
## 6.12 XCAP over Ut interface for Manipulating NGN Services
The XCAP is specified in 3GPP TS 24.623 [11].
## 6.13 Advice Of Charge (AOC)
The AOC service is specified in 3GPP TS 24.647 [17].
## 6.14 Closed User Groups (CUG)
The CUG service is specified in 3GPP TS 24.654 [18].
## 6.15 Three-Party (3PTY)
The 3PTY service is specified in 3GPP TS 24.605 [4].
NOTE: 3PTY can be seen as a special case of CONF and most of service
interactions for CONF apply also to 3PTY.
## 6.16 Flexible Alerting (FA)
The FA service is specified in 3GPP TS 24.239 [19].
NOTE: 3GPP TS 22.173 also contains a Reverse charging service, but no stage 3
work has been done for that in this release.
## 6.17 Communication Waiting (CW)
The CW service is specified in 3GPP TS 24.615 [23].
## 6.18 Completion of Communications to Busy Subscriber (CCBS) Completion of
Communications by No Reply (CCNR)
The Completion of Communications to Busy Subscriber (CCBS) Completion of
Communications by No Reply (CCNR) service is specified in 3GPP TS 24.642 [24].
## 6.19 Customized Alerting Tones (CAT)
The CAT service is specified in 3GPP TS 24.182 [25].
## 6.20 Customized Ringing Signal (CRS)
The CRS service is specified in 3GPP TS 24.183 [27].
## 6.21 Personal Network Management (PNM)
The PNM service is specified in 3GPP TS 24.259 [29].
## 6.22 Unstructured Supplementary Service Data (USSD)
USSD using IMS is specified in 3GPP TS 24.390 [30].
NOTE: Usage of USSD using IMS is subject to policy specified in 3GPP TS 23.221
[33].
## 6.23 Enhanced Calling Name (eCNAM)
Enhanced CNAM (eCNAM) is specified in 3GPP TS 24.196 [39].
## 6.24 Multi-Device and Multi-Identity (MuD/MiD)
The MuD and MiD services are specified in 3GPP TS 24.174 [43].
###### ## Annex A (informative): Void
###### ## Annex B (informative): Void.
###### ## Annex C (informative): Void
###### ## Annex D (informative): Void
###### ## Annex E (informative): Void
###### ## Annex F (informative): Void
###### ## Annex G (informative): Void
###### ## Annex H (informative): Void
###### ## Annex I (informative): Void
###### ## Annex J (normative): IP-Connectivity Access Network specific
concepts when using EPS to access IM CN subsystem
# J.1 Scope
The present annex defines IP-CAN specific requirements for a multimedia
telephony communication service and associated supplementary services in the
IP Multimedia (IM) Core Network (CN) subsystem, where the IP-CAN is Evolved
Packet System (EPS).
# J.2 EPS aspects when connected to the IM CN subsystem
## J.2.1 Procedures at the UE
### J.2.1.1 Service Specific Access Control
The following information is provided by lower layer:
\- BarringFactorForMMTEL-Voice: barring rate for MMTEL voice;
\- BarringTimeForMMTEL-Voice: barring timer for MMTEL voice;
\- BarringFactorForMMTEL-Video: barring rate for MMTEL video; and
\- BarringTimeForMMTEL-Video: barring timer for MMTEL video.
Upon request from a user to establish a multimedia telephony communication
session as described in clause 5.2, the UE shall:
1) if the multimedia telephony communication session to be established is an
emergency session, then skip the rest of steps below and continue with session
establishment as described in clause 5.2;
2) retrieve SSAC related information mentioned above from lower layers;
NOTE 1: The values of SSAC related information retrieved from lower layers can
depend on whether the UE has an Access Class with a value in the range 11..15
or not. Determination of the values of the SSAC related information is
described in clause 5.3.3.10 of 3GPP TS 36.331 [26].
3) if video is offered in the multimedia telephony communication session:
A) if back-off timer Tx is running, reject the multimedia telephony
communication session establishment and skip the rest of steps below; or
B) else, then:
I) draw a new random number \"rand1\" that is uniformly distributed in the
range 0 â‰¤ rand1 \< 1; and
II) if the random number \"rand1\" is lower than BarringFactorForMMTEL-Video,
then skip the rest of steps below and continue with session establishment as
described in clause 5.2;
NOTE 2: If the BarringFactorForMMTEL-Video is set to 1, the session is
exempted from barring.
III) else, then;
i) draw a new random number \"rand2\" that is uniformly distributed in the
range 0 â‰¤ rand2 \< 1; and
ii) start back-off timer Tx with the timer value calculated using the formula:
Tx = (0,7 + 0,6*rand2) * BarringTimeForMMTEL-Video; and
iii) reject the multimedia telephony communication session establishment and
skip the rest of steps below;
4) if audio is offered in the multimedia telephony communication session:
A) if back-off timer Ty is running, reject the multimedia telephony
communication session establishment and skip the rest of steps below; or
B) else, then;
I) draw a new random number \"rand3\" that is uniformly distributed in the
range 0 â‰¤ rand3 \< 1; and
II) if the random number \"rand3\" is lower than BarringFactorForMMTEL-Voice,
then skip the rest of steps below and continue with session establishment as
described in clause 5.2;
NOTE 3: If the BarringFactorForMMTEL-Voice is set to 1, the session is
exempted from barring.
III) else, then;
i) draw a new random number \"rand4\" that is uniformly distributed in the
range 0 â‰¤ rand4 \< 1; and
ii) start timer Ty with the timer value calculated using the fomula:
Ty = (0,7 + 0,6*rand4) * BarringTimeForMMTEL-Voice; and
iii) reject the multimedia telephony communication session establishment;
NOTE 4: If the multimedia telephony communication implemenation and the access
stratum protocol implementation are located in separate physical entities, it
is expected that the interconnecting protocol supports the transfer of
information elements needed for the service specific access control
enforcement.
Service Specific Access Control is not activated when the UE is in other radio
accesses (e.g. UTRAN/GERAN). And when UE camping on E-UTRAN moves to other
radio accesses (e.g. UTRAN/GERAN), back-off timer (Tx or Ty or both) shall be
stopped if running.
### J.2.1.2 Smart Congestion Mitigation
The following information is provided to the non-access stratum:
\- MO-MMTEL-voice-started;
\- MO-MMTEL-voice-ended.
\- MO-MMTEL-video-started; and
\- MO-MMTEL-video-ended;
Upon request from a user to establish an originating multimedia telephony
communication session as described in clause 5.2, and if the session
establishment is continued after performing the Service Specific Access
Control as specified in clause J.2.1.1:
1) if only audio or only real-time text or only both audio and real-time text
(see clause 4.2 for 3GPP systems) are offered in the multimedia telephony
communication session, and no other originating multimedia telephony
communication session initiated with offering only audio or only real-time
text or only both audio and real-time textexists, the UE sends the MO-MMTEL-
voice-started indication to the non-access stratum and continue with session
establishment as described in clause 5.2;
2) if video is offered in the multimedia telephony communication session, and
no other originating multimedia telephony communication session initiated with
offering video exists, the UE sends the MO-MMTEL-video-started indication to
the non-access stratum and continue with session establishment as described in
clause 5.2.
When an originating multimedia telephony communication session ends (i.e. a
response to a BYE or a failure response to the initial INVITE request is
transferred), the originating multimedia telephony communication session was
initiated with offering only audio or only real-time text or only both audio
and real-time text (i.e. in the SDP offer in the initial INVITE request), and
no other originating multimedia telephony communication session initiated with
offering only audio or only real-time text or only both audio and real-time
text exists, the UE sends the MO-MMTEL-voice-ended to the non-access stratum.
When an originating multimedia telephony communication session ends (i.e. a
response to a BYE or a failure response to the initial INVITE request is
transferred), the originating multimedia telephony communication session was
initiated with offering video (i.e. in the SDP offer in the initial INVITE
request), and no other originating multimedia telephony communication session
initiated with offering video exists, the UE sends the MO-MMTEL-video-ended
indication to the non-access stratum.
NOTE 1: If the UE supports other 3GPP specific mechanisms for communicating
with the non-access stratum protocol implementation, e.g. DHCP discovery via
PCO, then the UE is expected to support the transfer of information elements
needed for the smart congestion mitigation enforcement.
NOTE 2: Adding or removing media during the multimedia telephony communication
session has no impact on the information relating to smart congestion
mitigation.
### J.2.1.3 MMTEL request timeouts
If the UE supports timer RequestTimeout, then upon a request from a user to
establish an originating multimedia telephony communication session as
described in clause 5.2, the UE shall start timer RequestTimeout when sending
an initial INVITE request.
The UE may support being configured for the RequestTimeout timer with the
operator\'s IMS multimedia telephony communication service policy as specified
in 3GPP TS 24.275 [36].
### J.2.1.4 Abnormal cases
Upon request from a user to establish a MMTEL voice or an MMTEL video session
as described in clause 5.2, if:
a) the UE receives, from the lower layers, a notification that the service
request:
1) was not accepted due to congestion; or
2) resulted in starting timer T3325 (see 3GPP TS 24.008 [80]); and
b) an originating initial INVITE transaction, for which a 2xx response has not
yet been received, exists;
then:
a) if a provisional response has been received, the UE shall cancel INVITE
transaction; and
b) if an alternative radio access network is available:
1) if the service request was not accepted due to congestion, the UE shall
attempt the MMTEL voice or an MMTEL video session on the alternative radio
access network; or
2) if the service request resulted in starting timer T3325, the UE should
attempt the MMTEL voice or an MMTEL video session on the alternative radio
access network.
# J.3 Application usage of SIP
## J.3.1 Procedures at the UE
### J.3.1.1 3GPP PS data off
#### J.3.1.1.1 General
The UE may support the 3GPP PS data off.
If the UE supports the 3GPP PS data off:
a) the UE can be configured with:
1) up to two indications whether the MMTEL voice is a 3GPP PS data off exempt
service, one indication is valid for the UE camping in the HPLMN or the
EHPLMN, and the other indication is valid for any VPLMN the UE is roaming in;
and
2) up to two indications whether the MMTEL video is a 3GPP PS data off exempt
service, one indication is valid for the UE camping in the HPLMN or the
EHPLMN, and the other indication is valid for any VPLMN the UE is roaming in;
b) the UE may support being configured with the indication whether the MMTEL
voice is a 3GPP PS data off exempt service using one or more of the following
methods:
1) the EF~3GPPPSDATAOFF~ described in 3GPP TS 31.102 [38];
2) the MMTEL_voice_exempt node of 3GPP TS 24.275 [36], if the UE is in the
HPLMN or the EHPLMN; and
3) the MMTEL_voice_roaming_exempt node of 3GPP TS 24.275 [36], if the UE is in
the VPLMN.
If the UE is configured with both the MMTEL_voice_exempt node of 3GPP TS
24.275 [36] and the EF~3GPPPSDATAOFF~ described in 3GPP TS 31.102 [38], then
the EF~3GPPPSDATAOFF~ shall take precedence;
If the UE is configured with both the MMTEL_voice_roaming_exempt node of 3GPP
TS 24.275 [36] and the EF~3GPPPSDATAOFF~ described in 3GPP TS 31.102 [38],
then the EF~3GPPPSDATAOFF~ shall take precedence; and
c) the UE may support being configured with the indication whether the MMTEL
video is a 3GPP PS data off exempt service using one or more of the following
methods:
1) the EF~3GPPPSDATAOFF~ described in 3GPP TS 31.102 [38];
2) the MMTEL_video_exempt node of 3GPP TS 24.275 [36], if the UE is in the
HPLMN or the EHPLMN; and
3) the MMTEL_video_roaming_exempt node of 3GPP TS 24.275 [36], if the UE is in
the VPLMN.
If the UE is configured with both the MMTEL_video_exempt node of 3GPP TS
24.275 [36] and the EF~3GPPPSDATAOFF~ described in 3GPP TS 31.102 [38], then
the EF~3GPPPSDATAOFF~ shall take precedence;
If the UE is configured with both the MMTEL_video_roaming_exempt node of 3GPP
TS 24.275 [36] and the EF~3GPPPSDATAOFF~ described in 3GPP TS 31.102 [38],
then the EF~3GPPPSDATAOFF~ shall take precedence.
When the UE is only configured with the indication valid for the UE camping in
the HPLMN or the EHPLMN, the UE shall use this indication also when the UE is
in the VPLMN.
#### J.3.1.1.2 Enforcement
If the 3GPP PS data off status is \"active\":
a) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with an EPS IP-CAN bearer, with media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
NOTE 1: When the 3GPP PS data off status is \"active\", an MMTEL session which
is not MMTEL voice and which is not MMTEL video (e.g. MMTEL session with only
fax) is released.
b) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with an EPS IP-CAN bearer, and with:
1) an SDP offer; or
2) an SDP answer;
with media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
NOTE 2: When the 3GPP PS data off status is \"active\", an MMTEL session which
is not MMTEL voice and which is not MMTEL video (e.g. MMTEL session with only
fax) cannot be initiated.
c) if the UE is not configured with indication that MMTEL voice is a 3GPP PS
data off exempt service:
1) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with an EPS IP-CAN bearer, with only audio, only real-time
text or only audio and real-time text; and
2) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with an EPS IP-CAN bearer and with:
A) an SDP offer; or
B) an SDP answer;
with only audio, only real-time text or only audio and real-time text;
NOTE 3: If the UE doesn\'t send an intitial SIP INVITE due to conditions as
described in bullet c.2, the UE can attempt a request for a service equivalent
to MMTel voice via the CS domain -- if supported and available -- and,
otherwise, the UE can attempt the service according to 3GPP TS 24.229 [13] and
as described in clause 5.2 via non-3GPP access.
d) if the UE is not configured with indication that MMTEL video is a 3GPP PS
data off exempt service:
1) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with an EPS IP-CAN bearer, and with video;
2) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with an EPS IP-CAN bearer and with:
A) an SDP offer; or
B) an SDP answer;
with video; and
e) if the UE is not configured with indication that MMTEL voice is a 3GPP PS
data off exempt service and the UE is not configured with indication that
MMTEL video is a 3GPP PS data off exempt service:
1) the UE shall de-register the binding of a UE\'s contact address containing
an IP address associated with an EPS IP-CAN bearer from IM CN subsystem
according to 3GPP TS 24.229 [13];
2) the UE shall re-register the binding of a UE\'s contact address containing
an IP address associated with an EPS IP-CAN bearer with IM CN subsystem with a
Contact header field without the g.3gpp.icsi-ref media feature tag; or
3) the UE shall re-register the binding of a UE\'s contact address containing
an IP address associated with an EPS IP-CAN bearer with IM CN subsystem with a
Contact header field with the g.3gpp.icsi-ref media feature tag not including
the urn:urn-7:3gpp-service.ims.icsi.mmtel ICSI according to 3GPP TS 24.229
[13].
NOTE 4: Which of the bullets 1), 2), and 3) the UE performs is influenced by
other 3GPP PS data off exempt services.
## J.3.2 Procedures at the multimedia telephony application server
### J.3.2.1 3GPP PS data off
A multimedia telephony application server supporting the 3GPP PS data off can
be configured with:
1) up to two indications whether the MMTEL voice is a 3GPP PS data off exempt
service, one indication is valid for the UE camping in the HPLMN or the
EHPLMN, and the other indication is valid for any VPLMN the UE is roaming in;
and
2) up to two indications whether the MMTEL video is a 3GPP PS data off exempt
service, one indication is valid for the UE camping in the HPLMN or the
EHPLMN, and the other indication is valid for any VPLMN the UE is roaming in.
When the multimedia telephony application server is only configured with the
indication valid for the UE camping in the HPLMN or the EHPLMN, the multimedia
telephony application server shall use this indication also when the UE is in
the VPLMN.
If the multimedia telephony application server supports the 3GPP PS data off,
the multimedia telephony application server shall support obtaining
registration state information from a received third-party SIP REGISTER
request including information contained in the body of the third-party SIP
REGISTER request as specified in 3GPP TS 24.229 [13], of the served UE.
If a received registration state information of the served UE indicates a
Contact header field with the g.3gpp.ps-data-off media feature tag with the
\"active\" value:
a) the multimedia telephony application server shall not send according to
3GPP TS 24.229 [13] a SIP message related to a multimedia telephony
communication session as described in clause 5.2 with:
1) an SDP offer; or
2) an SDP answer;
containing media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
towards a contact address (or via a registration flow) of the served UE such
that the contact address (or the registration flow) was registered or re-
registered by a SIP REGISTER request with a P-Access-Network-Info header field
with \"3GPP-GERAN\", \"3GPP-UTRAN\", \"3GPP-E-UTRAN\" or \"3GPP-NR\" access
class, and with the \"network-provided\" header field parameter;
b) if the multimedia telephony application server is not configured with
indication that MMTEL voice is a 3GPP PS data off exempt service for the
served UE, the multimedia telephony application server shall not send
according to 3GPP TS 24.229 [13] a SIP message related to the IMS multimedia
telephony communication service with:
1) an SDP offer; or
2) an SDP answer;
containing media streams:
1) with only audio;
2) with only real-time text; or
3) with only audio and real-time text;
towards a contact address (or via a registration flow) of the served UE such
that the contact address (or the registration flow) was registered or re-
registered by a SIP REGISTER request with a P-Access-Network-Info header field
with \"3GPP-GERAN\", \"3GPP-UTRAN\", \"3GPP-E-UTRAN\" or \"3GPP-NR\" access
class, and with the \"network-provided\" header field parameter; and
c) if the multimedia telephony application server is not configured with
indication that MMTEL video is a 3GPP PS data off exempt service for the
served UE, the multimedia telephony application server shall not send
according to 3GPP TS 24.229 [13] a SIP message related to a multimedia
telephony communication session as described in clause 5.2, with:
1) an SDP offer; or
2) an SDP answer;
containing media streams with video towards a contact address (or via a
registration flow) of the served UE such that the contact address (or the
registration flow) was registered or re-registered by a SIP REGISTER request
with a P-Access-Network-Info header field with \"3GPP-GERAN\", \"3GPP-UTRAN\",
\"3GPP-E-UTRAN\" or \"3GPP-NR\" access class, and with the \"network-
provided\" header field parameter.
###### ## Annex K (normative): IP-Connectivity Access Network specific
concepts when using GPRS to access IM CN subsystem
# K.1 Scope
The UE may support the present annex.
The present annex defines IP-CAN specific requirements for a multimedia
telephony communication service and associated supplementary services in the
IP Multimedia (IM) Core Network (CN) subsystem, where the IP-CAN is General
Packet Radio Service (GPRS).
# K.2 GPRS (Iu mode only) aspects when connected to the IM CN subsystem
## K.2.1 Procedures at the UE
### K.2.1.1 General
The UE may support any of the procedures of clause K.2.1.
### K.2.1.2 Application specific Congestion control for Data Communication
(ACDC) procedure
The following information is provided to the non-access stratum:
\- MO-MMTEL-voice-started;
\- MO-MMTEL-voice-ended.
\- MO-MMTEL-video-started; and
\- MO-MMTEL-video-ended;
Upon request from a user to establish an originating multimedia telephony
communication session as described in clause 5.2:
1) if only audio or only real-time text or only both audio and real-time text
(see clause 4.2 for 3GPP systems) are offered in the multimedia telephony
communication session, and no other originating multimedia telephony
communication session initiated with offering only audio or only real-time
text or only both audio and real-time textexists, the UE sends the MO-MMTEL-
voice-started indication to the non-access stratum and continue with session
establishment as described in clause 5.2;
2) if video is offered in the multimedia telephony communication session, and
no other originating multimedia telephony communication session initiated with
offering video exists, the UE sends the MO-MMTEL-video-started indication to
the non-access stratum and continue with session establishment as described in
clause 5.2.
When an originating multimedia telephony communication session ends (i.e. a
response to a BYE or a failure response to the initial INVITE request is
transferred), the originating multimedia telephony communication session was
initiated with offering only audio or only real-time text or only both audio
and real-time text (i.e. in the SDP offer in the initial INVITE request), and
no other originating multimedia telephony communication session initiated with
offering only audio or only real-time text or only both audio and real-time
text exists, the UE sends the MO-MMTEL-voice-ended to the non-access stratum.
When an originating multimedia telephony communication session ends (i.e. a
response to a BYE or a failure response to the initial INVITE request is
transferred), the originating multimedia telephony communication session was
initiated with offering video (i.e. in the SDP offer in the initial INVITE
request), and no other originating multimedia telephony communication session
initiated with offering video exists, the UE sends the MO-MMTEL-video-ended
indication to the non-access stratum.
NOTE 1: If the UE supports other 3GPP specific mechanisms for communicating
with the non-access stratum protocol implementation, e.g. DHCP discovery via
PCO, then the UE is expected to support the transfer of information elements
needed for the application specific congestion control for data communication
enforcement.
NOTE 2: Adding or removing media during the multimedia telephony communication
session has no impact on the information relating to application specific
congestion control for data communication.
# K.3 Application usage of SIP
## K.3.1 Procedures at the UE
### K.3.1.1 3GPP PS data off
#### K.3.1.1.1 General
The requirements in clause J.3.1.1.1 apply.
#### K.3.1.1.2 Enforcement
If the 3GPP PS data off status is \"active\":
a) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with a GPRS IP-CAN bearer, and with media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
NOTE 1: When the 3GPP PS data off status is \"active\", an MMTEL session which
is not MMTEL voice and which is not MMTEL video (e.g. MMTEL session with only
fax) is released.
b) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with a GPRS IP-CAN bearer and with:
1) an SDP offer; or
2) an SDP answer;
with media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
NOTE 2: When the 3GPP PS data off status is \"active\", an MMTEL session which
is not MMTEL voice and which is not MMTEL video (e.g. MMTEL session with only
fax) cannot be initiated.
c) if the UE is not configured with indication that MMTEL voice is a 3GPP PS
data off exempt service:
1) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with a GPRS IP-CAN bearer, and with only audio, only real-
time text or only audio and real-time text; and
2) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with a GPRS IP-CAN bearer and with:
A) an SDP offer; or
B) an SDP answer;
with only audio, only real-time text or only audio and real-time text;
NOTE 3: If the UE doesn\'t send an intitial SIP INVITE due to conditions as
described in bullet c.2, the UE can attempt a request for a service equivalent
to MMTel voice via the CS domain -- if supported and available -- and,
otherwise, the UE can attempt the service according to 3GPP TS 24.229 [13] and
as described in clause 5.2 via non-3GPP access.
d) if the UE is not configured with indication that MMTEL video is a 3GPP PS
data off exempt service:
1) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with a GPRS IP-CAN bearer, and with video;
2) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with a GPRS IP-CAN bearer and with:
A) an SDP offer; or
B) an SDP answer;
with video; and
e) if the UE is not configured with indication that MMTEL voice is a 3GPP PS
data off exempt service and the UE is not configured with indication that
MMTEL video is a 3GPP PS data off exempt service:
1) the UE shall de-register the binding of a UE\'s contact address containing
an IP address associated with a GPRS IP-CAN bearer from IM CN subsystem
according to 3GPP TS 24.229 [13];
2) the UE shall re-register the binding of a UE\'s contact address containing
an IP address associated with a GPRS IP-CAN bearer with IM CN subsystem with a
Contact header field without the g.3gpp.icsi-ref media feature tag; or
3) the UE shall re-register the binding of a UE\'s contact address containing
an IP address associated with a GPRS IP-CAN bearer with IM CN subsystem with a
Contact header field with the g.3gpp.icsi-ref media feature tag not including
the urn:urn-7:3gpp-service.ims.icsi.mmtel ICSI according to 3GPP TS 24.229
[13].
NOTE 4: Which of the bullets 1), 2), and 3) the UE performs is influenced by
other 3GPP PS data off exempt services.
## K.3.2 Procedures at the multimedia telephony application server
### K.3.2.1 3GPP PS data off
The requirements in clause J.3.2.1 apply.
###### ## Annex L (normative): Timers
Table L.1 provides a description of the timers specified in the present
document.
Table L.1: Timers
+-------------+-------------+-------------+-------------+-------------+ | Timer | Timer value | Cause of | Normal stop | On expiry | | | | start | | | +-------------+-------------+-------------+-------------+-------------+ | Req | C | On sending | On receipt | UE shall | | uestTimeout | onfigurable | of an | of any SIP | abort the | | | value | initial | response | current | | | between 5 | INVITE | | session | | | seconds and | request | | attempt. | | | 15 seconds | | | | | | | | | If an | | | | | | alternative | | | | | | radio | | | | | | access | | | | | | network is | | | | | | available, | | | | | | the UE | | | | | | shall | | | | | | attempt the | | | | | | session on | | | | | | the | | | | | | alternative | | | | | | radio | | | | | | access | | | | | | network. | +-------------+-------------+-------------+-------------+-------------+
###### ## Annex M (normative): IP-Connectivity Access Network specific
concepts when using 5GS to access IM CN subsystem
# M.1 Scope
The present annex defines IP-CAN specific requirements for a multimedia
telephony communication service and associated supplementary services in the
IP Multimedia (IM) Core Network (CN) subsystem, where the IP-CAN is 5G System
(5GS).
# M.2 5GS aspects when connected to the IM CN subsystem
## M.2.1 Procedures at the UE
### M.2.1.1 Indications to lower layers about start and stop of MMTEL sessions
The following information is provided to the non-access stratum:
\- MO-MMTEL-voice-started;
\- MO-MMTEL-voice-ended;
\- MO-MMTEL-video-started;
\- MO-MMTEL-video-ended;
\- for 3GPP access only, handover of ongoing MMTEL voice call from non-3GPP
access; and
\- for 3GPP access only, handover of ongoing MMTEL video call from non-3GPP
access.
Upon request from a user to establish an originating multimedia telephony
communication session as described in clause 5.2:
1) if the multimedia telephony communication session to be established is an
emergency session, then skip the rest of steps below and continue with session
establishment as described in clause 5.2;
2) if only audio or only real-time text or only both audio and real-time text
(see clause 4.2 for 3GPP systems) are offered in the multimedia telephony
communication session, and no other originating multimedia telephony
communication session initiated with offering only audio or only real-time
text or only both audio and real-time text exists, the UE sends the MO-MMTEL-
voice-started indication to the non-access stratum and
a) if the barring result is \"not-barred\", continue with session
establishment as described in clause 5.2; and
b) if the barring result is \"barred\", reject the multimedia telephony
communication session establishment and skip the rest of steps below; and
3) if video is offered in the multimedia telephony communication session, and
no other originating multimedia telephony communication session initiated with
offering video exists, the UE sends the MO-MMTEL-video-started indication to
the non-access stratum and
a) if the barring result is \"not-barred\", continue with session
establishment as described in clause 5.2; and
b) if the barring result is \"barred\", reject the multimedia telephony
communication session establishment and skip the rest of steps below.
NOTE: Adding or removing media during the multimedia telephony communication
session is not subject to unified access control.
When an originating multimedia telephony communication session ends (i.e. a
response to a BYE or a failure response to the initial INVITE request is
transferred), the originating multimedia telephony communication session was
initiated with offering only audio or only real-time text or only both audio
and real-time text (i.e. in the SDP offer in the initial INVITE request), and
no other originating multimedia telephony communication session initiated with
offering only audio or only real-time text or only both audio and real-time
text exists, the UE sends the MO-MMTEL-voice-ended to the non-access stratum.
When an originating multimedia telephony communication session ends (i.e. a
response to a BYE or a failure response to the initial INVITE request is
transferred), the originating multimedia telephony communication session was
initiated with offering video (i.e. in the SDP offer in the initial INVITE
request), and no other originating multimedia telephony communication session
initiated with offering video exists, the UE sends the MO-MMTEL-video-ended
indication to the non-access stratum.
When an ongoing multimedia telephony communication session is handed over from
non-3GPP access to 3GPP access:
1) if only audio or only real-time text or only both audio and real-time text
(see clause 4.2 for 3GPP systems) are used in the multimedia telephony
communication session, the UE sends the MO-MMTEL-voice-started indication and
the handover of ongoing MMTEL voice call from non-3GPP access indication to
the non-access stratum; and
2) if video is used in the multimedia telephony communication session, the UE
sends the MO-MMTEL-video-started indication and the handover of ongoing MMTEL
video call from non-3GPP access indication to the non-access stratum.
### M.2.1.2 MMTEL request timeouts
If the UE supports timer RequestTimeout, then upon a request from a user to
establish an originating multimedia telephony communication session as
described in clause 5.2, the UE shall start timer RequestTimeout when sending
an initial INVITE request.
The UE may support being configured for the RequestTimeout timer with the
operator\'s IMS multimedia telephony communication service policy as specified
in 3GPP TS 24.275 [36].
### M.2.1.2A Registration and authentication
If:
a) the UE includes a \"+g.3gpp.icsi-ref\" header field parameter equal to
\"urn:urn-7:3gpp-service.ims.icsi.mmtel\" in the Contact header field of the
SIP REGISTER request; and
b) the IP-CAN of 5GS indicated that interworking without N26 is supported as
specified in 3GPP TS 24.501 [42];
the UE should include a transport=tcp URI parameter in the Contact header
field of the SIP REGISTER request.
NOTE 1: The UE includes a transport=tcp parameter to ensure that the P-CSCF
uses TCP connection when it receives an initial request for a dialog or a
request for a standalone transaction destined for the UE. The use of TCP is to
ensure the reception of transmitted SIP messages in case fallback to EPS for
voice is used and the IP-CAN of 5GS supports interworking without N26.
If:
a) the UE changes from another IP-CAN to an IP-CAN of 5GS; and
b) the IP-CAN of 5GS indicated that interworking without N26 is supported as
specified in 3GPP TS 24.501 [42];
the UE may perform re-registration of a previously registered public user
identity bound to the other IP-CAN. In this case, if the UE includes a
\"+g.3gpp. icsi-ref\" header field parameter equal to \"urn:urn-7:3gpp-
service.ims.icsi.mmtel\" in the Contact header field of the SIP REGISTER
request, the UE should include a transport=tcp URI parameter in the Contact
header field of the SIP REGISTER request.
NOTE 2: This document does not specify how the UE detects that the used IP-CAN
has changed.
NOTE 3: The UE can send the reregistration request irrespective of whether or
not it has established a SIP dialog.
### M.2.1.3 Abnormal cases
Upon request from a user to establish an MMTEL voice or an MMTEL video session
as described in clause 5.2, if
a) the UE receives, from the lower layers, a notification that the service
request
1) was not accepted due to congestion; or
2) resulted in starting timer T3525 (see 3GPP TS 24.501 [42]); and
b) an originating initial INVITE transaction, for which a 2xx response has not
yet been received, exists;
then:
a) if a provisional response has been received, the UE shall cancel the INVITE
transaction; and
b) if an alternative radio access network is available, the UE shall attempt
the MMTEL voice or an MMTEL video session on the alternative radio access
network.
# M.3 Application usage of SIP
## M.3.1 Procedures at the UE
### M.3.1.1 3GPP PS data off
#### M.3.1.1.1 General
The requirements in clause J.3.1.1.1 apply.
Additionally, the following requirements apply.
In case of SNPN, if the UE supports the 3GPP PS data off:
a) the UE can be configured with:
1) up to two indications of whether the MMTEL voice is a 3GPP PS data off
exempt service for each subscribed SNPN whose entry exists in the \"list of
subscriber data\", one indication is valid for the UE camping in the
subscribed SNPN, and the other indication is valid for any non-subscribed SNPN
the UE is camping in using the subscribed SNPN\'s credentials;
2) up to two indications of whether the MMTEL video is a 3GPP PS data off
exempt service for each subscribed SNPN whose entry exists in the \"list of
subscriber data\", one indication is valid for the UE camping in the
subscribed SNPN, and the other indication is valid for any non-subscribed SNPN
the UE is camping in using the subscribed SNPN\'s credentials;
3) an indication of whether the MMTEL voice is a 3GPP PS data off exempt
service for PLMN subscription, valid for any non-subscribed SNPN the UE is
camping in using the PLMN subscription; and
4) an indication of whether the MMTEL video is a 3GPP PS data off exempt
service for PLMN subscription, valid for any non-subscribed SNPN the UE is
camping in using the PLMN subscription;
b) for a subscribed SNPN whose entry exists in the \"list of subscriber
data\", the UE may support being configured with the indication of whether the
MMTEL voice is a 3GPP PS data off exempt service using one or more of the
following methods:
1) the MMTEL_voice_exempt node of 3GPP TS 24.275 [36], if the UE is in the
subscribed SNPN; and
2) the MMTEL_voice_exempt_non_subscribed_SNPN node of 3GPP TS 24.275 [36], if
the UE is in the non-subscribed SNPN.
For PLMN subscription, the UE may support being configured with the indication
of whether the MMTEL voice is a 3GPP PS data off exempt service using the
following method:
1) the MMTEL_voice_exempt_non_subscribed_SNPN node of 3GPP TS 24.275 [36], if
the UE is in the non-subscribed SNPN; and
c) for a subscribed SNPN whose entry exists in the \"list of subscriber
data\", the UE may support being configured with the indication of whether the
MMTEL video is a 3GPP PS data off exempt service using one or more of the
following methods:
1) the MMTEL_video_exempt node of 3GPP TS 24.275 [36], if the UE is in the
subscribed SNPN; and
2) the MMTEL_video_exempt_non_subscribed_SNPN node of 3GPP TS 24.275 [36], if
the UE is in the non-subscribed SNPN.
For PLMN subscription, the UE may support being configured with the indication
of whether the MMTEL video is a 3GPP PS data off exempt service using the
following method:
1) the MMTEL_video_exempt_non_subscribed_SNPN node of 3GPP TS 24.275 [36], if
the UE is in the non-subscribed SNPN.
When the UE is only configured with the indication valid for the UE camping in
the subscribed SNPN, the UE shall use this indication also when the UE is in
the non-subscribed SNPN.
#### M.3.1.1.2 Enforcement
If the 3GPP PS data off status is \"active\":
a) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with a 5GS QoS flow using NG-RAN, with media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
NOTE 1: When the 3GPP PS data off status is \"active\", an MMTEL session which
is not MMTEL voice and which is not MMTEL video (e.g. MMTEL session with only
fax) is released.
b) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with a 5GS QoS flow using NG-RAN, and
with:
1) an SDP offer; or
2) an SDP answer;
with media streams:
1) other than only audio;
2) other than only real-time text;
3) other than only audio and real-time text; and
4) not including video;
NOTE 2: When the 3GPP PS data off status is \"active\", an MMTEL session which
is not MMTEL voice and which is not MMTEL video (e.g. MMTEL session with only
fax) cannot be initiated.
c) if the UE is not configured with indication that MMTEL voice is a 3GPP PS
data off exempt service:
1) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with an 5GS QoS flow using NG-RAN, with only audio, only
real-time text or only audio and real-time text; and
2) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with a 5GS QoS flow using NG-RAN and with:
A) an SDP offer; or
B) an SDP answer;
with only audio, only real-time text or only audio and real-time text;
NOTE 3: If the UE doesn\'t send an intitial SIP INVITE due to conditions as
described in bullet c.2, the UE can attempt a request for a service equivalent
to MMTel voice via the CS domain -- if supported and available -- and,
otherwise, the UE can attempt the service according to 3GPP TS 24.229 [13] and
as described in clause 5.2 via non-3GPP access.
d) if the UE is not configured with indication that MMTEL video is a 3GPP PS
data off exempt service:
1) the UE shall release according to 3GPP TS 24.229 [13] any multimedia
telephony communication session as described in clause 5.2, which is not an
IMS emergency call, established with a UE\'s contact address containing an IP
address associated with a 5GS QoS flow using NG-RAN, and with video;
2) the UE shall not send according to 3GPP TS 24.229 [13] a SIP message
related to a multimedia telephony communication session as described in clause
5.2, which is not an IMS emergency call, from a UE\'s contact address
containing an IP address associated with a 5GS QoS flow using NG-RAN and with:
A) an SDP offer; or
B) an SDP answer;
with video; and
e) if the UE is not configured with indication that MMTEL voice is a 3GPP PS
data off exempt service and the UE is not configured with indication that
MMTEL video is a 3GPP PS data off exempt service:
1) the UE shall de-register the binding of a UE\'s contact address containing
an IP address associated with an 5GS QoS flow using NG-RAN from IM CN
subsystem according to 3GPP TS 24.229 [13];
2) the UE shall re-register the binding of a UE\'s contact address containing
an IP address associated with an 5GS QoS flow using NG-RAN with IM CN
subsystem with a Contact header field without the g.3gpp.icsi-ref media
feature tag; or
3) the UE shall re-register the binding of a UE\'s contact address containing
an IP address associated with an 5GS QoS flow with IM CN subsystem with a
Contact header field with the g.3gpp.icsi-ref media feature tag not including
the urn:urn-7:3gpp-service.ims.icsi.mmtel ICSI according to 3GPP TS 24.229
[13].
NOTE 4: Which of the bullets 1), 2), and 3) the UE performs is influenced by
other 3GPP PS data off exempt services.
### M.3.1.2 Establishing an MMTEL session
If the UE is establishing an MMTEL session offering audio and if the IP-CAN of
5GS indicated that interworking without N26 is supported as specified in 3GPP
TS 24.501 [42], the UE should transmit the SIP INVITE request using TCP as
transport protocol.
NOTE: The use of TCP is to ensure the reception of transmitted SIP messages in
case fallback to EPS for voice is used and the IP-CAN of 5GS supports
interworking without N26.
## M.3.2 Procedures at the multimedia telephony application server
### M.3.2.1 3GPP PS data off
The requirements in clause J.3.2.1 apply.
Additionally, the following requirements apply.
When serving a UE in an SNPN using an entry of \"list of subscriber data\", a
multimedia telephony application server supporting the 3GPP PS data off can be
configured with:
1) up to two indications of whether the MMTEL voice is a 3GPP PS data off
exempt service, one indication is valid for the UE camping in the subscribed
SNPN, and the other indication is valid for any non-subscribed SNPN the UE is
camping in using the subscribed SNPN\'s credentials; and
2) up to two indications of whether the MMTEL video is a 3GPP PS data off
exempt service, one indication is valid for the UE camping in the subscribed
SNPN, and the other indication is valid for any non-subscribed SNPN the UE is
camping in using the subscribed SNPN\'s credentials.
When the multimedia telephony application server is only configured with the
indication valid for the UE camping in the subscribed SNPN, the multimedia
telephony application server shall use this indication also when the UE is in
the non-subscribed SNPN.
When serving a UE in an SNPN using PLMN subscription, a multimedia telephony
application server supporting the 3GPP PS data off can be configured with:
1) an indication of whether the MMTEL voice is a 3GPP PS data off exempt
service, valid for any non-subscribed SNPN the UE is camping in using the PLMN
subscription; and
2) an indication of whether the MMTEL video is a 3GPP PS data off exempt
service, valid for any non-subscribed SNPN the UE is camping in using the PLMN
subscription.
#