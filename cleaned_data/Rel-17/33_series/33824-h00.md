# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
_The present document:_
\- Describes potential security threats and vulnerabilities that are
applicable to the enhanced IAB architecture specified in the TS 38.300 [3], TS
38.331 [8], TS 38.321 [9] and TS 38.340 [10].
\- Identifies potential security requirements for those potential security
threats and vulnerabilities.
\- Proposes candidate solutions to ensure that the enhanced IAB architecture
specified in the 3GPP TS 38.300 [3], TS 38.331 [8], TS 38.321 [9] and TS
38.340 [10] does not introduce security vulnerabilities in the 5G system
providing a secure connection for the UEs connecting to the NR through IAB
node(s).
\- Concludes with the solutions that should be included in a future normative
phase.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 38.874: \"NR; Study on integrated access and backhaul\".
[3] 3GPP TS 38.300: \" NR and NG-RAN Overall Description\".
[4] 3GPP TS 38.401: \" NG-RAN; Architecture description\".
[5] 3GPP TS 33.501: \"Security architecture and procedures for 5G system
(Release 15)\".
[6] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
[7] 3GPP TS 23.501: \"System Architecture for the 5G System\".
[8] 3GPP TS 38.331: \"Radio Resource Control (RRC) protocol specification\".
[9] 3GPP TS 38.321: \"NR; Medium Access Control (MAC) protocol
specification\".
[10] 3GPP TS 38.340: \"NR; Adaptation layer\".
[11] 3GPP TR 33.340: \"Backhaul Adaptation Protocol (BAP) specification\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
**IAB-donor:** A RAN node that has wired transport to the core network and
provides wireless access to UEs and wireless backhauling functionality to IAB-
nodes.
**IAB-node:** A RAN node that provides wireless access to UEs and wirelessly
backhauls the access traffic.
**Access-node:** An IAB-node serving an access UE.
**Parent-node:** An IAB-node that is serving other IAB-nodes
**Child-node:** An IAB-node which is served by another Parent-node.
**Access-link:** A link between an access UE and an IAB-node.
**Backhaul-link:** A link between a Child-node and a Parent-node.
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
BAP Backhaul Adaptation Protocol
IAB Integrated Access and Backhaul
# 4 Security aspects in the 5G System to enable support of NR Integrated
Access and Backhaul
## 4.1 IAB Architecture
This clause aims to provide some brief details of IAB architecture as
background to the rest of the analysis in the present document. A more
complete description of architecture is covered in TS 38.401 [4].
Figure 4.1-1: IAB Architecture
The NG-RAN supports multi-hop backhauling for flexible range extension by the
IAB-node connecting to the gNB capable of serving the IAB-nodes via NR Uu,
named IAB-donor gNB [4].
## 4.2 IAB security architecture
This clause provides the IAB security architecture diagram and lists the
groups of related security aspects.
{width="6.696527777777778in" height="2.93125in"}
Figure 4.2-1: IAB security architecture
The IAB security architecture is shown in Figure 4.2-1. There are following
groups of security aspects:
(A) Authentication, AS, and NAS security of UE.
(B) Security of backhaul-link between Child-node and Parent-node.
(C) Authentication, AS, and NAS security of MT part of IAB-node.
(D) Security of F1*-C between MT/DU part of IAB-node and IAB-donor.
(E) Security of F1*-U between MT/DU part of IAB-node and IAB-donor.
## 4.3 Existing security mechanisms
It is assumed that the UE is agnostic to the IAB architecture. Therefore, all
security mechanisms between the UE and the network (including UE-RAN and UE-
CN) are inherited, i.e., remain unchanged, from TS 33.501 [5]. However, the
present document could study security aspects between the UE and network that
are different from TS 33.501 [5], if any.
Some security mechanisms that are directly related to the present document and
inherited from TS 33.501 [5] are listed below:
(1) Authentication procedures between the UE and the CN.
(2) AS security mechanism between the UE and the RAN. The key hierarchy is
reused for the AS keys. The IAB node is acting as the UE and the IAB donor is
acting as the gNB in the key hierarchy.
(3) NAS security mechanism between the UE and the CN. The key hierarchy is
reused for the NAS keys. The IAB node is acting as the UE in the key
hierarchy.
(4) Mobility (handovers, RNA update, and mobility registration update) between
the UE and the network (RAN/CN).
(5) The role of the 5G Core in the IAB architecture is unchanged in the key
hierarchy compared to 5GS Rel-15.
# 5 Key issues
## 5.1 Key issues on IAB security architecture
### 5.1.1 Key Issue #1.1: Topology discovery security for IAB
#### 5.1.1.1 Key issue details
When an IAB-node accesses to the current IAB-topology, the IAB-donor need to
learn the parent of the new IAB-node and discover the topology. There are two
potential options as specified in TR 38.874 [2].
> **Option 1** : The DU includes into an F1-AP message an identifier of the
> collocated IAB-UE. This may, for instance, be a TNL or RNL identifier. The
> identifier may have been assigned by the CU-CP to the IAB-UE before.
>
> **Option 2** : The IAB-UE includes into an RRC message an identifier for the
> collocated DU. This identifier may have been assigned by the CU-CP to the DU
> before.
The integration of an IAB-node to the topology may trigger the topology
adaptation. The IAB-topology can be changed to provide coverage and ensure
service continuity. Based on the information such as backhaul link quality,
link- and node-load, neighbour-node signal strength, the new topology is
determined.
5.1.1.2 Security Threat
In case the identifier of collocated IAB-UE or DU for topology discovery lack
confidentiality, integrity and replay protection, it will be possible for an
attacker to eavesdrop, modify, and replay packets, which may lead to IAB-
donor\'s discovering false topology information. The incorrect topology
information may influence backhaul link quality even lead to link failure.
5.1.1.3 Potential security requirements
NOTE: Not addressed in the present document.
## 5.2 Key issues on authentication framework for IAB Node
### 5.2.1 Key Issue #2.1: Authentication and authorization for an IAB node
acting as a MT
#### 5.2.1.1 Key issue details
An IAB-node connects to an IAB donor at startup in a 3GPP network supporting
the IAB architecture.
At startup the IAB-node acts as an MT. The MT part of the IAB-node acts as a
UE towards the IAB donor.
The network provides configuration to the IAB-nodes, for L2 transport and
resource management like:
\- the setup and release of IAB-nodes; configuration of adaptation layer at
the IAB-nodes and IAB-donor DU; configuration of BH RLC channels, QoS
information, routing tables, bearer-mappings; configuration of means for
network synchronization; and configuration for sharing of time-domain
resources among backhaul and access links (see physical layer specification).
\- IP address allocation for the IAB-nodes.
\- QoS flow configuration across multiple hops.
The IAB-node acting as MT needs to be authenticated by the 3GPP network and
the IAB-node needs to authenticate the 3GPP network. Further, the network
needs to authorize the IAB node to provide service.
5.2.1.2 Security threats
If the IAB-node acting as a MT is not authenticated by the 3GPP network, then
a false IAB-node is able to connect to the 3GPP network via an IAB-donor.
If the IAB-node acting as a MT does not authenticate the 3GPP network, then
the IAB-node may connect to a false IAB-donor or a false 5G core network.
The unauthorized IAB Node with valid subscription credentials, may get access
to obtain/provide IAB service.
5.2.1.3 Potential security requirements
Mutual authentication of the IAB node acting as a MT and the 3GPP core network
supporting IAB architecture shall be supported.
The 5GC/EPC shall authorize the IAB Node to provide IAB functionalities.
### 5.2.2 Key Issue #2.2: Activating control plane communication security in
IAB node
#### 5.2.2.1 Key issue details
An IAB-node acting as a MT connects to an IAB-donor at startup in the IAB
architecture. The MT part of the IAB node acts as a UE towards the IAB-donor.
The network provides configuration to the IAB nodes, for L2 transport and
resource management like:
\- the setup and release of IAB-nodes; configuration of adaptation layer at
the IAB-nodes and IAB-donor DU; configuration of BH RLC channels, QoS
information, routing tables, bearer-mappings; configuration of means for
network synchronization; and configuration for sharing of time-domain
resources among backhaul and access links (see physical layer specification).
\- IP address allocation for the IAB-nodes.
\- QoS flow configuration across multiple hops.
If the network need to be able to securely provide the configurations.
IAB node security also needs to be studied for the cases where single or
multiple hops failed due to RLF failure. During the RLF, the network needs to
perform topology change hierarchically to minimize disruption in service
continuity which results in a backhaul link change from one IAB-Node to
another. In this scenario, the PDCP endpoints are not changed, but the F1-AP
link needs to be rebuilt, such behaviour is transparent to UE. F1-AP link
establishment needs study from a security perspective for secure link
establishment, Key derivations and transfer of keys from one IAB Node to
another IAB node to maintain service continuity.
Security keys for communication needs to be established between the IAB-node
and the 5G core network; and between the IAB-node and the IAB-donor.
#### 5.2.2.2 Security threats
If an IAB-node acting as MT and a 5G core network does not integrity protects
and cipher the communication sent between them, then an attacker can modify,
replay or eavesdrop the communication.
If an IAB-node acting as MT and an IAB donor does not integrity protect and
cipher the communication sent between them then, then an attacker can modify,
replay or eavesdrop the communication.
Potential disruption of the network\'s service. If the IAB node is not
securely configured, then any illegitimate node may be part of the multi-hop
backhauling and leads to risk of theft of service and Denial of Service
against the system.
#### 5.2.2.3 Potential security requirements
The control plane communication between the IAB node acting as MT and the 5G
core network shall support encryption, integrity protection and replay
protection.
The control plane communication between the IAB node acting as MT and the IAB-
donor shall support encryption, integrity protection and replay protection.
Secure control plane configuration of the IAB nodes shall be supported.
The system shall support secure service continuity.
### 5.2.3 Key Issue #2.3: Protection of recovery from backhaul-RLF
#### 5.2.3.1 Key issue details
Regarding the work split in clause 4.2, this key issue belongs to the group
#(B) illustrated in Figure 4.2-1, i.e., security of backhaul-link between
child-node and parent-node.
TR 38.874 [2] discusses recovery from backhaul-RLF in clauses 9.7.12 to
9.7.15. One possible option described in clause 9.7.14 is:
\"- Option 2: The IAB-node DU explicitly alerts child IAB-nodes about the
upstream RLF. Child IAB-nodes receiving this alert can forward the alert
further downstream. Each IAB-node receiving such alert initiates BH-RLF
recovery as discussed above.\"
A simplified illustration of backhaul-RLF recovery is shown in Figure
5.2.3.1-1. The RLF occurs between the IAB-donor and the IAB-node#1. This
causes backhaul connectivity loss for the parent-node IAB-node#1. This also
causes upstream backhaul connectivity loss for child-nodes IAB-node#2 and IAB-
node#n. For the sake of example, the parent IAB-node#1 cannot recover the
backhaul-link via the IAB-node#3 because of a big mountain between them.
Therefore, the parent IAB-node#1 informs the child IAB-node#2 about the
upstream backhaul connectivity loss so that the child IAB-node#2 can itself
seek means to recover. The child IAB-node#2 identifies that the Path1 is lost.
Therefore, it recovers using Path2 via the IAB-node#3.
{width="6.697222222222222in" height="2.9472222222222224in"}
Figure 5.2.3.1-1: A simplified illustration of backhaul-RLF recovery
This backhaul-RLF recovery is likely achieved by some form of control message
between the parent-node and the child-node via a new adaptation layer called
the BAP (Backhaul Adaptation Protocol), or via lower layer mechanism like MAC
control element.
Even though this backhaul-RLF recovery is a rare event, it is very crucial to
protect any form of control messages between the parent-node and the child-
node. This is explained further in the threats below.
Note: Reference for the recovery messages is not addressed in the present
document.
#### 5.2.3.2 Security threats
A parent-node is responsible for multiple child-nodes and ultimately to
multiple UEs being served via the IAB system. If the control message from the
parent-node to the child-node is not protected, then over-the-air attacker
could potentially trigger backhaul-RLF recovery on the child-node. It could
mean abrupt loss of connection for large number of UEs, short- or long-term
degradation in throughput or speed, and loss of operator\'s reputation, among
other things.
#### 5.2.3.3 Potential security requirements
NOTE: Not addressed in the present document.
### 5.2.4 Key Issue #2.4: Unprotected BAP Control PDU exchange
#### 5.2.4.1 Key issue details
TS 38.340 [11], details the function supported by the BAP sublayer.
Specifically, the flow control feedback and polling signalling and BH RLF
indication are exchanged without protection between the BAP sublayers of IAB-
nodes or between the IAB-node and IAB-donor.
Clause 5.2.3, Key Issue #2.3: Protection of recovery from backhaul-RLF,
illustrates the backhaul-RLF recovery scenario.
#### 5.2.4.2 Security threats
If the fake BAP Control PDU is transmitted by a fake node to the parent IAB-
node or to the IAB-donor, then acting on the received fake BAP Control PDU
could lead to QoE degradation (degradation of the system throughput) of the UE
served by the victim IAB-node and may lead to unnecessary link release and re-
establishment.
#### 5.2.4.3 Potential security requirements
NOTE: Not addressed in the present document.
## 5.3 Key issues on F1* interface security
### 5.3.1 Key issue #3.1: F1 interface security for IAB
#### 5.3.1.1 Issue details
The integrated Access and Backhaul (IAB) is specified in TS 38.300 [3] and TS
38.401 [4] to realize the NR CU-DU split over NR wireless links. The overall
architecture is shown in the Figure 5.3.1.1-1. The IAB is realized either in
SA mode (a) or EN-DC (b). An IAB donor node has gNB-CU functionality and an
IAB node has gNB-DU functionality. Each IAB node is connected to the IAB-donor
node either directly (i.e., a single hop) or via another IAB node (i.e.,
multiples hops).
{width="6.502083333333333in" height="3.6680555555555556in"}
Figure 5.3.1.1-1: IAB architecture; a) IAB-node using SA mode with NGC; b)
IAB-node using EN-DC
The protocol stacks for control plane and user plane between IAB-donor node
and IAB node and between IAB nodes described in [3] are shown in Figures
5.3.1.1-2 and 5.3.1.1-3. It is noted that an IAB-node that has the gNB-DU part
communicates with an IAB-donor node that has the gNB-CU part using F1
protocols as in the wireline CU-DU interface.
NOTE: Backhaul Adaptation Protocol (BAP) is introduced for bearer mapping
between adjacent IAB nodes to support routing and bearer mapping over wireless
links.
{width="3.2527777777777778in" height="2.0840277777777776in"}
Figure 5.3.1.1-2: Protocol stack for the support of F1-U protocol
{width="3.4159722222222224in" height="2.16875in"}
Figure 5.3.1.1-3: Protocol stack for the support of F1-C protocol
Without having security protection on the protocol layers, the IAB is
vulnerable to adversary attacks on both control plane and user plane of F1
interface, e.g., packet injection, packet modification, replay, eavesdropping.
Furthermore, if the security protection is not applied end-to-end, then an
attacker that breaks into any on the intermediate node will similarly be able
to perform the above attacks.
This key issue is to study potential solutions for F1 interface security for
IAB.
#### 5.3.1.2 Security threats
An attacker may inject malicious control plane signalling or replay control
plane signalling in IAB (F1-C) over the wireless link between an IAB donor and
an IAB node or between IAB nodes.
An attacker may modify control plane signalling in IAB (F1-C) over the
wireless link between an IAB donor and an IAB node or between IAB nodes.
An attacker may inject bogus user plane packets or replay user plane packets
in IAB (F1-U) over the wireless link between an IAB donor and an IAB node or
between IAB nodes.
An attacker may modify user plane packets in IAB (F1-U) over the wireless link
between an IAB donor and an IAB node or between IAB nodes.
An attacker may eavesdrop control plane signalling in IAB (F1-C) over the
wireless links between an IAB donor and an IAB node or between IAB nodes.
An attacker may eavesdrop user plane packets in IAB (F1-U) over the wireless
links between an IAB donor and an IAB node or between IAB nodes.
An attacker that compromises an intermediate node will be able to inert bogus
packet, modify packets of eavesdrop on packets.
#### 5.3.1.3 Potential security requirements
The system shall support end-to-end confidentiality protection of F1-C control
plane signalling between the terminating nodes of the F1-C interface, i.e. the
IAB node and the IAB-donor.
The system shall support end-to-end integrity and replay protection of F1-C
control plane signalling between the terminating nodes of the F1-C interface,
i.e. the IAB node and the IAB-donor.
The system shall support end-to-end confidentiality protection of F1-U user
plane packets between the terminating nodes of the F1-U interface, i.e. the
IAB node and the IAB-donor.
The system shall support end-to-end integrity and replay protection of F1-U
user plane packets between the terminating nodes of the F1-U interface, i.e.
the IAB node and the IAB-donor.
# 6 Solutions
## 6.1 Solutions for authentication of IAB Node
### 6.1.1 Solution #1.1: Authentication and authorization of IAB Node
#### 6.1.1.1 Introduction
This solution addresses the security requirement for the Authentication and
Authorization of IAB Node in key issue #2.1 and key issue #2.2.
#### 6.1.1.2 Solution details
In the CU/DU architecture, the IAB Node host the DU and UE functionalities and
would effectively look like a DU connected through the wireless interface to
the controlling CU.
Therefore for secure connection setup purposes, the IAB-UE functionalities of
the IAB Node, performs the primary authentication and key agreement procedure
with the 5GC as specified in TS 33.501 [5], as shown in Figure 6.1.1.2-1 or
with the EPC as specified in TS 33.401 [6], as shown in Figure 6.1.1.2-2.
Further the IAB-UE functionality in the IAB Node performs the NAS and AS
security setup procedures as specified in the TS 33.501 [5] or TS 33.401 [6],
to obtain IAB configuration data securely from the network. This solution
assumes that, IAB node (IAB-UE) acts as a UE for performing the primary
authentication and key agreement procedure, subscription credential(s) storage
requirements, NAS security setup and AS security setup procedures as specified
in TS 33.501 [5] and TS 33.401 [6].
Figure 6.1.1.2-1: Authentication of IAB Node, NAS and AS security Set-up in
5GS
Figure 6.1.1.2-2: Authentication of IAB Node, NAS and AS security Set-up in
EPS
The authorization for connectivity of the IAB Node to the 5GC/EPS is evaluated
by the network once the IAB Node is successfully identified and authenticated.
This authorization is executed during IAB Node Registration procedure. The
core network authorizes the IAB Node through the subscription profile.
#### 6.1.1.3 Evaluation
This solution reuses the existing authentication, authorization and security
context establishment procedure as specified in TS 33.501 [5] and TS 33.401
[6], which fulfils the potential security requirements of key issue
#2.1(Authentication and Authorization of IAB Node) and key issue #2.2
(Activating control plane communication security in IAB node).
## 6.2 Solutions for key hierarchy and the related procedure
### 6.2.1 Solution #2.1: Shared secret for F1 security context establishment
#### 6.2.1.1 Introduction
This solution addresses the security credentials establishment for the
security requirements in key issue #3.1.
#### 6.2.1.2 Solution details
For establishment of the secure RRC connection with the network (IAB MT
setup), the MT functionality in the IAB node performs authentication with the
network and establish the AS security context for the secure exchange of the
RRC messages (Solution #1.1). Further, for establishment of secure F1
interface (IAB DU setup), it is required to perform an authentication
mechanism over IKEv2 to establish IPSec tunnels (Solution #3.1). As the IAB
Node\'s MT functionality and DU functionality establish the security context
independently, multiple authentication procedures are performed between the
IAB Node and to the same network (for the same RAN technology). Instead of
performing the mutual authentication again between the IAB Node and the IAB
Donor, the Access Stratum (AS) security context key K~gNB~ (in possession of
the MT functionality in the IAB node and in the IAB Donor) is used to derive a
Shared Key, which will be used to compute the AUTH value directly and the
authentication run is skipped (skipping full authentication run, for example,
EAP-TLS or EAP-AKA procedure).
During the UE Registration procedure, the network performs verification of IAB
subscription information for IAB-node authorization (see TS 23.501 [7]).
Therefore, only after successful verification of IAB-node authorization, the
5GC completes the Registration procedure and provides AS security context key
K~gNB~ to the IAB-donor. By using the AS security context key K~gNB,~ the IAB
Donor ensures that the IAB Node is authorized already by the core network.
{width="6.259722222222222in" height="3.477777777777778in"}
Figure 6.2.1.1-1: Establishment of F1 security association using Shared Key
\- **Phase 1:** IAB-MT setup. In this phase, the MT functionality of the new
IAB-node (e.g. the IAB-node 2 in Figure 6.2.1.1-1) connects to the network as
a normal UE, by performing RRC connection setup procedure with IAB-donor-CU,
authentication with the core network, IAB-node 2-related context management,
IAB-node 2\'s access traffic-related radio bearer configuration at the RAN
side, and, optionally, OAM connectivity establishment.
As part of AS security establishment, the MT functionality of the new IAB-node
and the IAB donor, derives the key K~gNB~. In case of NSA, the MT
functionality of the new IAB-node and the IAB donor are in possession of the
K~gNB~ which is the S-K~gNB~ provided by the MeNB.
\- **Phase 2-1:** Backhaul RLC channel establishment. In this phase, at least
the backhaul RLC channels for CP traffic e.g. carrying F1-C messages to and
from the IAB-node, are established.
\- **Phase 2-2:** Routing update. In this phase, the BAP layer is updated to
support routing between the new IAB-node 2 and the IAB-donor-DU. This includes
configuration of a BAP routing identifier for routing in downstream direction
on the IAB-donor-DU and a BAP route identifier in upstream direction on MT
functionality of IAB-node 2. The routing tables are updated for all ancestor
IAB-nodes (e.g. IAB-node 1) and the IAB-donor-DU with routing entries for the
new BAP routing identifier. The DU functionality of the new IAB-node
configures an IP address to establish IP connectivity to the operator\'s
network.
\- **Phase 3:** IAB-DU part setup. In this phase, the DU functionality of the
IAB-node 2 is configured. The DU functionality of the IAB-node 2 initiates the
set up F1-C connection with the IAB-donor-CU and establish security context.
For the establishment of security context for the F1 interface (F1-C and/or
F1-U), the IAB-node 2 initiates IKEv2 procedure (as detailed in Solution #3.1)
with the IAB-donor-CU to establish the IPsec SAs. The Access Stratum (AS)
security context key K~gNB~ (in possession of the MT functionality in the IAB
node and in the IAB Donor) is used to derive a pre shared key (K~IAB~), which
will be used to compute the AUTH value directly and the authentication run is
skipped (skipping full authentication run, for example, EAP-TLS or EAP-AKA
procedure). The IAB node and the IAB Donor uses the K~IAB~ derivation function
detailed in Figure 6.2.1.1-2 for the deriving the K~IAB~.
After the F1 is setup, the IAB node can now start serving the UEs.
{width="3.6770833333333335in" height="1.40625in"}
Figure 6.2.1.1-2: K~IAB~ derivation function
During the topology adaptation (as detailed in TS 38.401 [4]), it may be
possible to **allocate different TNL address(es) that is (are) routable via
the target IAB-donor-DU. Therefore it is required to (re)establish the IPsec
associations between the IAB-node and the IAB-donor.**
6.2.1.3 Evaluation
This solution details the mechanism for establishment of secure F1 interface,
performing an authentication mechanism over IKEv2 to establish IPsec tunnels,
which is required for Solution #3.1 (concluded for normative work, see clause
7.4.1).
This solution does not require any additional pre-provisioned security
credentials for performing an authentication mechanism over IKEv2 to establish
IPsec tunnels. The security credential required to perform IKEv2 procedure is
derived using the AS security context (which is established as part of IAB-UE
setup procedure).
Further using the PSK authentication method for establishment of secure F1 due
to IAB-node migration skips the full authentication run, therefore the
solution is more efficient than performing an additional authentication
procedure over IKEv2.
## 6.3 Solutions for protection of the F1*-U/C interfaces (wireless backhaul
links)
### 6.3.1 Solution #3.1: F1 interface security for IAB
#### 6.3.1.1 Introduction
This solution addresses the key issue #3.1: F1 interface security for IAB.
#### 6.3.1.2 Solution details
The control plane signalling between the IAB node and the IAB-donor node is
confidentiality, integrity and replay protected in an end-to-end manner in the
same way as the wireline fronthaul control (F1-C) protection using IPsec ESP
and IKEv2 as specified in TS 33.501 [5]. Alternatively, the F1-C interface
could be protected using DTLS. Figure 6.3.2-1 shows the protocol stack when
IPsec is used for F1-C protection.
{width="4.422916666666667in" height="2.7243055555555555in"}
Figure 6.3.2-1: F1-C protocol stack for IAB
The user plane traffic between the IAB node and the IAB-donor node is
confidentiality, integrity and replay protected in an end-to-end manner in the
same way as the wireline fronthaul user plane (F1-U) protection specified in
TS 33.501 [5]. F1-U is used to transport traffic between UE and CU that is
protected in PDCP layer as shown in Figure 6.3.1.2-2.
{width="6.34375in" height="2.533333333333333in"}
Figure 6.3.1.2-2: F1-U protocol stack for IAB
#### 6.3.1.3 Evaluation
The solution provides confidentiality and integrity protection of both control
plane (i.e., F1-C) and user plane (i.e., F1-U) interfaces between the IAB node
and IAB-donor, in an end-to-end manner. Therefore, the solution fulfils the
potential security requirements of KI #3.1.
Furthermore, the solution allows to reuse the F1 security protocols for the
wireline F1 interface as specified in TS 33.501. This simplifies the handling
of the security in an environment that supports both wireline F1 interface and
wireless F1 interface as the same security protocol is used for both
interfaces.
### 6.3.2 Solution #3.2: F1 security context establishment
#### 6.3.2.1 Introduction
This solution addresses the F1 security establishment requirements for IAB in
key issue #3.1.
#### 6.3.2.2 Solution details
IAB integration procedure consists of 3 phases [3].
1) IAB-MT setup:
The IAB-MT performs registration to the network as a UE and consequently, the
AS security is established between the IAB-MT and IAB donor.
2) Backhaul RLC channel establishment and routing update:
If the IAB-MT is authorized to run as an IAB node based on the CN indication
to the IAB donor, the backhaul RLC channels and the BAP layer are established
and configured using the secure RRC signalling to support routing between the
IAB node and the IAB donor.
3) IAB-DU setup:
F1 security establishment for IAB is performed over the RLC channel using the
procedure specified in clause 9.8.2 of TS 33.501 [5].
The first phase results in AS security establishment between the IAB donor and
IAB node; and the third phase results in the establishment of secure F1
between the IAB donor and IAB node.
#### 6.3.2.3 Evaluation
This solution supports a mechanism to fulfil the security requirements of key
issue #3.1.
This solution supports a unified F1 security context establishment procedure
for both wireline and wireless F1 interfaces.
Note: Further evaluation on reusing the current wireline F1-C for wireless
F1-C is needed but not addressed in the present document.
# 7 Conclusions
## 7.1 Conclusions on authentication framework for IAB-node
Solution #1.1 is recommended as baseline for normative work to support
authentication and authorization of the IAB Node, when the IAB-UE
functionality in the IAB Node performs IAB-UE setup procedure. The normative
work on IAB-node IAB-UE security procedures refers to the appropriate clauses
in TS 33.501 [5] and TS 33.401 [6] for the authentication, credential storage,
NAS and AS security setup procedures.
## 7.2 Conclusions on authentication framework for IAB-node (IAB-DU part
setup)
In order to establish IPsec ESP, authentication methods for IKEv2 are
supported using both certificates and pre-shared key (PSK).
Additionally, to support a flexible plug and play of IAB-node and IAB-donor
without a pre-configuration of the PSK(s), dynamic PSK computation for IKEv2
PSK authentication may also be supported. When dynamic PSK is used, the IAB-
node and the IAB-donor calculates the PSK (K~IAB~) as specified in solution
2.1 of the present document.
## 7.3 Conclusions on F1 interface security
### 7.3.1 Key Issue #3.1: F1 interface security for IAB
F1 interface security for the wireline link between CU and DU is specified in
TS 33.501. In IAB, the F1 interface is realized over a single hop or multiple
hop wireless link(s). Since F1 interface is a logical interface between two
end-points (i.e., CU and DU), the security for the F1 interface should be
defined independently of the underlying transport medium (e.g., wireline,
wireless, or single hop or multiple hops). Therefore, it is recommended that
the solution #3.1 is used as the basis for normative work for F1 interfaces
between IAB node and IAB-donor.
The support of DTLS for F1-C, between the IAB-node (gNB-DU) and the IAB-donor-
CU, is optional for the IAB-node and the IAB-donor-CU.
#