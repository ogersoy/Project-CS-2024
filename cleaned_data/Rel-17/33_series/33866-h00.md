# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document studies the security aspects of enablers for network
automation for the 5G system based on the outcome of TR 23.700-91 [1]. More
specifically, the present document identifies security issues, requirements
and corresponding potential security solutions related to the following
objectives:
\- UE data collection protection to fulfil the NWDAF functionalities including
privacy consideration, data authenticity, data integrity, and accessibility
aspects requirements.
\- Detection of cyber-attacks and anomaly events supported by NWDAF and its
related functions, specifically to identify parameters provided by UE and NFs,
which can help to detect attacks and abnormal behaviours;
\- Protection of data transferring (e.g. privacy consideration) in the inter-
NWDAF/NWDAF instances.
NOTE: The user consent for UE data collection is not addressed in the present
document, it will be discussed in TR 33.867 [2].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 23.700-91: \"Study on enablers for network automation for the 5G
System (5GS); Phase 2\".
[2] 3GPP TS 33.867: \"Study on user consent for 3GPP services\".
[3] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[4] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services \".
[5] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[6] Draft NISTIR 8269: \"A Taxonomy and Terminology of Adversarial Machine
Learning\"; [https://doi.org/10.6028/NIST.IR.8269-draft]{.underline}.
[7] ETSI GR SAI 001: \"AI Threat Ontology\"..
[8] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[9] 3GPP TR 28.809: \"Study on enhancement of management data analytics\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [3] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [3].
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[3] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [3].
AF Application Function
DDoS Distributed Denial of Service
DoS Denial of Service
eNA enablers for Network Automation
MDAS Management Data Analytics Service
MitM Man in the Middle
ML Machine Learning
NWDAF Network Data Analytics Function
OAM Operation, Administration and Maintenance
# 4 Overview of eNA
TS 23.288 [4] provides the Stage 2 architecture enhancements for 5G System
(5GS) to support network data analytics services in 5G Core network, which
forms the baseline for the present study on security aspects of enablers for
Network Automation (eNA) for the 5G system (5GS).
The Network Data Analytics Function (NWDAF) as specified in TS 23.501 [5]
interacts with different entities within 5GS for data collection based on
subscription to events, retrieval of information from data repositories,
retrieval of information about NFs (e.g. from NRF for NF-related information)
and on demand provision of analytics to consumers. The NWDAF provides
analytics to 5GC NFs and OAM. Analytics information is either statistical
information of the past events or predictive information.
TR 23.700-91 [1] is an architectural study on enhancements for analytics and
NWDAF, for which any security impact will be documented in the present
document. There is a particular security impact for UE data collection
protection, detection of cyber-attacks and anomaly events supported by NWDAF
and its related functions, on the protection of data transfer in inter-
NWDAF/NWDAF cases.
# 5 Key issues
## 5.1 Key issues related to securing the data provided to any type of
analytics function
### 5.1.1 Key Issue #1.1:Integrity protection of data transferred between AF
and NWDAF
#### 5.1.1.1 Key issue details
The 5GS supports the collection and utilisation of the UE data and delivering
it to the NWDAF as an input to generate the analytic information (to be
consumed by other NF).
As per KI#8 in TR 23.700-91 [1], there is no direct interface between the UE
and the NWDAF. When AF is used for the communication between the NWDAF and UE
for data collection, there is a need to study the security aspects for the
data provided by the UE to NWDAF via AF and vice versa.
This key issue studies the integrity aspects on data collection and
utilization of UE data in order to derive the analytics.
#### 5.1.1.2 Security Threats
If the data shared between AF and NWDAF is not secured, it may lead to the
following issue;
Data can be modified and replayed by unauthorized parties.
#### 5.1.1.3 Potential Requirements
_Integrity and replay protection shall be supported on the interface between
AF and NWDAF for the UE data collection._
### 5.1.2 Key Issue #1.2: Processing of tampered data
#### 5.1.2.1 Key issue details
5GS is expected to use ML. Two centralized frameworks currently responsible
for ML-based analytics, e.g., abnormal behavior analytics, are NWDAF (TS
23.288 [4]) in 5GC and MDAS (TR 28.809 [9]) on OAM. Furthermore, decentralized
AI/ML is used in several use cases, such as efficiency optimization in RAN. In
addition, a new data collection framework DCCF (clause 6.9, TR 23.700-91 [1])
is proposed for Rel-17.
Network data analytics is including the following steps:
\- Request of analytics by consumer
\- Collection of data by analytics function
\- Processing of collected data by analytics function
\- Reply containing analytics output to a consumer by analytics function
While 3GPP provides sound security on the network level, the data used by
AI/ML is not being subject to security controls. This key issue seeks
solutions to remedy several attacks against a 5GS involving tampered data.
#### 5.1.2.2 Security threats
NOTE: Threats need to be revisited if in line with NIST 8269 [6] and ETSI SAI
[7] terminology.
Data used by AI/ML is not being subject to security controls. This allows for
a number of attacks against a 5GS with severe impact on performance up to
denial of service (DoS) conditions:
\- **Adversarial examples** are generated by slightly perturbating input data.
The data is perturbated in a space in which AI/ML algorithms are sensitive to
change, leading to severe performance degradation and misclassifications in
the inference process. This attack is well-known in human-centric use cases,
such as image/audio classification.
\- During training, tampered training data can lead to **model skewing**.
Skewed models will provide false results in inference.
\- Tampered data may also lead to the **information disclosure** of
confidential/proprietary AI/ML algorithms by inference.
\- In more **simple attacks** , perturbations may not be slight (as those
generated by adversarial example methods). In non-human-centric use cases (as
most are in 5GS), the perturbations may just be false data to force
misinterpretation.
Unprotected analytic functions are subject to:
\- Decreased efficiency, e.g. power consumption, load balancing, QoS
optimization
\- System failure (DoS scenario)
\- Inference of confidential ML algorithms employed by 5GS
\- Leakage of privacy-related data derived from AI/ML models
#### 5.1.2.3 Potential security requirements
A 5GS analytics function shall be protected from processing unsanitized or
tampered data.
> NOTE 1: The algorithm used for data sanitization is beyond the scope of
> 3GPP.
>
> NOTE 2: The threat of data being tampered during transmission is beyond the
> scope of this key issue.
### 5.1.3 Key Issue #1.3: Authorization of NF Service Consumers for data
access via DCCF
#### 5.1.3.1 Key issue details
A Data Collection Coordination Function (DCCF) is used to coordinate the
collection of data from one or more NF(s) based on data collection requests
from one or more Consumer NF(s). DCCF and Data Repository Function (DRF) can
be standalone NFs, possibly co-located with NWDAF, or can be hosted by NWDAF.
Data Collection notification to one or more Consumer NF(s) may be supported
via a Messaging Framework. Adaptors supporting 3GPP services allow NFs to
interact with the Messaging Framework. Only the interface between 3GPP
entities and the adaptors is in 3GPP scope. This includes 3GPP services
offered by adaptors to allow NFs to interact with the Messaging Framework.
TR 23.700-91-100 conclusion mentions that \"Additional authorization for
Consumers to access data from a Data Source via the DCCF and to access data
from DRF (directly or via DCCF) needs to be coordinated with SA3\". According
to SA2 KI#11 conclusions, if a consumer subscribes to analytics notifications
to the DCCF, the DCCF can subscribe itself to the data source and notify the
data source that notifications are to be sent directly to the consumer. The
data source will then send notifications to the consumer via the MF or the
DCCF.
This key issue addresses the authorization of data consumer to access the data
(via DCCF) from the data source or the DRF, and the authorization aspects of
the DCCF being allowed to subscribe the data on behalf of the consumer at the
data source or the DRF, i.e. the security aspect on usage
subscription/notification mechanisms for a consumer to receive notifications
on a different path (as adapted in SA2 conclusions) will be studied.
#### 5.1.3.2 Security threats
DCCF introduces a new path for an NF Service Consumer (NFc) to access the data
from data sources or an NF Service Producer (NFp). Due to the introduction of
DCCF between consumer and producer, the existing security mechanism will not
be sufficient, and the following threats need to be addressed:
An unauthorized data consumer could request service from the DCCF.
NOTE: This threat can be addressed by existing SBA mechanisms. Therefore, no
related requirement is added.
Based on a request from a DCCF, the Messaging Framework may provide data from
a producer to a requesting data consumer, even though the consumer is not
authorized to receive this data.
Based on a request from a DCCF data received from a data producer is stored in
the DRF. When the data are later retrieved, the DCCF may provide the stored
data to a non-authorized consumer if requested.
A DCCF could subscribe for data from the data source on behalf of the data
consumer without the data consumer authorizing DCCF to do so.
The data producer may be unable to correctly verify the identity of the data
consumer since the data request is coming from DCCF on behalf of the consumer.
#### 5.1.3.3 Potential security requirements
The data consumer shall be authorized to access the data from the data source.
Authorization of the DCCF shall be supported to access a service of a data
source on behalf of a data consumer.
Note: Whether the service request including the URI, service name, etc., needs
to be verified by the data source is not addressed in the present document.
### 5.1.4 Key Issue #1.4: Security protection of data via Messaging Framework
#### 5.1.4.1 Key issue details
In [1], in the conclusions for the Key Issue #11 \'Increasing efficiency of
data collection\', DCCF (Data Collection Coordination Function) is defined for
efficient data collection in 5GS. The DCCF is a control-plane function that
coordinates data collection and triggers data delivery to Data Consumers.
TR 23.700-91 [1] lists several agreed principles for normative work, some of
which are as follows:
\- \"When a Data Collection Coordination Functionality (DCCF) is deployed, it
is used to coordinate collection of data from one or more NF(s) based on data
collection requests from one or more Consumer NF(s).\"
\- \"Data Collection notification to one or more Consumer NF(s) may be
supported via a Messaging Framework. Adaptors supporting 3GPP services allow
NFs to interact with the Messaging Framework.
\- \"The DCCF coordinates data collection so the same data is not requested
multiple times from the same data source.\"
The Messaging Framework is not expected to be standardized by 3GPP. It
contains Messaging Infrastructure that propagates event information and data
(e.g.: streaming and notifications) from data sources to data consumers. A
Data consumer that uses the Data Management Framework sends requests to the
DCCF rather than to a data producer.
In TS 23.288 [4], the Figure 5A.3.2-1 depicts the data delivery via a
Messaging Framework.
While the Messaging Framework is not standardized by 3GPP, a Messaging
Framework Adaptor NF (MFAF) offers 3GPP defined services: 3GPP DCCF Adaptor
(3DA) Data Management service and 3GPP Consumer Adaptor (3CA) Data Management
service of the Messaging Framework Adaptor Function (MFAF) which are used for
interaction between the 3GPP Network and the Messaging Framework.
Since the Messaging Framework is not expected to be standardized by 3GPP, it
may not be trusted.
The DCCF and the Messaging Framework decouple the data collection between the
data consumer and the data source; however, this may induce a security problem
because the data consumer cannot verify that the data from the data source is
not modified by the Messaging Framework and the confidentiality of the data
cannot be guaranteed by the Messaging Framework.
Formatting and/or Processing instructions are options that may be provided in
requests by Data Consumers via the Ndccf_DataManagement service. When using
the MFAF, the DCCF sends the formatting and/or processing instructions to the
MFAF via the Nmfaf_3daData_Management Service so the MFAF may format and/or
process the data before sending notifications to the Data Consumers /
notification endpoints. When using Data Delivery via the DCCF, the DCCF
performs formatting and/or processing before sending notifications.
#### 5.1.4.2 Threats
An attacker may eavesdrop or manipulate or replay the communication or
initiate the MitM attacks on the interface.
If the integrity of the data collected from the data source is not protected,
then the Messaging Framework may modify the data, which results in producing
wrong analytics.
If the confidentiality of the data collected from the data source is not
protected, then the Messaging Framework may access the sensitive data, which
may cause privacy leakage.
Replay attacks may lead to the utilization of the same data more than once,
and therefore, it may cause wrong analytic results.
#### 5.1.4.3 Potential security requirements
The transfer of the data between the data source and data consumer via the
messaging framework shall be confidentiality, integrity, and replay protected.
Confidentiality protection, integrity protection, and replay-protection shall
be supported on the new interfaces between 3GPP entities and MFAF.
NOTE: MFAF and its services i.e., Nmfaf_3caDataManagement Service and
Nmfaf_3daDataManagement Service to interact with the messaging framework are
defined in TS 23.288. Further, security and deployment of the messaging
framework which is a part of MFAF is up to implementation and out of scope of
3GPP.
### 5.1.5 Key Issue #1.5: UE data collection protection at NF/NWDAF
#### 5.1.5.1 Key issue details
UEs register to 5GS and request services, e.g. the initial registration
request to AMF. For fulfilling the service, but also for analytics purposes,
5GS NFs will collect data about the UE being served, e.g. AMF needs to
maintain a mapping between SUPI and 5G-GUTI and for accounting the time window
for the service used. UE-related data, processed by one NF, may also need to
be transferred to another NF to fulfill a service request or for analytics
purposes. UE can also provide privacy-sensitive data such as positioning
information, user profiling info, etc to NFs, which may be transferred to
NWDAF.
This KI is about NF/NWDAF collecting information about the UEs (e.g., UE
mobility events, UE registration failures) from the 5G NFs (e.g., AMF, 5G RAN)
and determines the threats and requirements for the protection of data related
to UE, which are collected by core NFs.
#### 5.1.5.2 Security threats
If the communication between UE and network is not confidentiality protected,
then sensitive information about UEs may be leaked to unauthorized entities.
If the integrity of the data collected from UE is not protected, the analytics
may not be accurate.
Replay attacks may lead to the utilization of the same UE data more than once,
and therefore, it may cause wrong analytic results.
UE-related data stored in an NF or transferred between different NFs may be
altered by a malicious entity. The attacker may provide false or modified
information to other NFs or an analytics function such as NWDAF. For instance,
the malicious entity can modify the UE information statistics or logs sent to
the NWDAF.
In case of the network is not authenticated by the UE, the UE may send UE-
related data to an unauthorized entity, which may lead to leakage of sensitive
data from the UE.
If an unauthenticated UE is sending data, it may send erroneous data to
NF/NWDAF. This can compromise the efficiency, performance, and output of
analytics algorithms implemented in the analytics functions. If the NF/NWDAF
which is receiving UE data is not properly authenticated and authorized, the
sender may transfer the UE-related data to an unauthorized NF or analytics
function.
#### 5.1.5.3 Potential security requirements
1\. UE and network shall mutually authenticate each other.
2\. The communication between UE and the network shall be confidentiality
protected.
3\. The data collected from UE shall be integrity protected.
4\. Data transferred from UE to NFs and from NFs to the analytics function
shall be protected against replay attacks.
5\. Authorization of NFs and analytics functions to receive, send, or transfer
UE-related data shall be assured.
## 5.2 Key issues related to the detection of cyber-attacks and anomaly events
by analytics function
### 5.2.1 Key Issue #2.1: Cyber-attacks detection supported by NWDAF
#### 5.2.1.1 Key issue details
NWDAF has been defined to offer automatic network analytics and alarming, with
possible capabilities of artificial intelligence and machine learning to help
proactively manage the 5G network. TR 23.700-91 [1] has identified the use
case of NWDAF detecting cyber-attacks by monitoring events and data packets in
the UE and the network, with the support of machine-learning algorithms. To
achieve cyber-attacks detection, the NWDAF can collaborate with UE and any
other NFs to collect related data as inputs and providing alerts of anomaly
events as outputs to OAM and other NFs which have subscribed to them so that
they could take proper actions.
This key issue describes what kind of cyber-attacks can be detected by NWDAF.
In order to mitigate the identified cyber-attacks, the data/parameters
collected by NWDAF need to be studied.
The specific cyber-attacks for which an analytics function may provide
detection support include but are not limited to the following examples:
**(1) MitM attacks on the radio interface:** MitM attacks or fraudulent relay
nodes may modify or change messages between the UE and the RAN, resulting in
failures of higher layer protocols such as NAS or the primary authentication.
The NWDAF may detect MitM attacks.
**(2) DoS attacks:** 5G has high performance requirements for system capacity
and data rate, improved capacity and higher data rate may lead to much higher
processing capability cost for network entities, which may make some network
entities (e.g. RAN, Core Network Entities) to suffer from DDoS attack. The
NWDAF may also enable the detection of DDoS attacks, e.g. when observing
abnormal amount of transactions dispersed by a UE or group of UEs at a
location and/or a slice (refer to table 6.7.5.1-1, TS 23.288) to initiate
signaling storm attack.
#### 5.2.1.2 Security threats
Cyber-attack may not be detected by the 5G network, thus further attacks could
be conducted.
Anomaly events may not be detected by the 5G network, thus further attacks
could be conducted.
#### 5.2.1.3 Potential security requirements
The 5GS system shall support the detection of cyber-attacks by providing
related inputs or collecting output analytics using an analytics function such
as NWDAF.
### 5.2.2 Key Issue #2.2: Anomalous NF behaviour detection by NWDAF
#### 5.2.2.1 Key issue details
The 5GC supports different NF deployments that could be in distributed or
redundant fashion so that the NF provides the services from several locations
and several execution instances. When these NFs are distributed across diverse
cloud infrastructure, it is possible that the NFs may behave in an undefined
manner. The undefined behaviour of the NF may be caused by internal errors
such as configuration mistakes or internal data corruption. This misbehaviour
may impact one or more UE services based on the type of NF. Thus, the
correlation of which NF is handling which UE data is an important aspect, such
that NWDF is enabled to conclude from the reported UE-related data, which NF
may have anomalous behaviour.
In all such instances, it is imperative that an analytics function such as
NWDAF monitors the behaviour of all the NFs and ensures that the NFs behave as
defined. If the NFs behave erroneously, it should be possible to detect the
anomaly so that appropriate steps can be taken, e.g. by an operator, to
control the potentially damaging behaviour.
Note, it is up to the operator to define the details of what NFs should report
if such monitoring and detection by NWDAF is desired. However, there is a need
to enable NWDAFs to receive or request reports by NFs which serve the
detection of anomalous NF behaviour.
#### 5.2.2.2 Security threats
Different NFs may behave in an undefined manner. Anomalous or malicious NF
behaviour could be, for instance, include attempts to access NF/NF service
which was not authorized to a NF as NF/NF service consumer, to unusually high
consumption of network or compute resources for NF as either NF/NF service
consumer or producer, to triggering of DoS attack on NF service producer by
continuously sending malicious messages, e.g. ill http request, etc., attempts
to exhaust connections of http server.
The above conditions can happen either due to internal data corruption,
configuration errors, or cross communication between NFs from different
vendors. Based on the NF type, such NFs could cause damage to either one or
multiple UEs. For example, in the case of an AMF or SMF dedicated to a network
slice, the service for all UEs within the whole network slice could be
affected. Even the whole network slice could get out of service.
An erroneous NF may succeed in knocking the whole network out of service by
sending wrong messages to other NFs, causing other NFs to get out of service.
The NFs within the 5GC are already authenticated and allowed to communicate
with each other based on successful authentication and authorization. If the
NF is misconfigured or has internal data corruption, etc, the assumption of
trust becomes invalid and causes potential threats.
#### 5.2.2.3 Potential security requirements
It should be possible for the network to detect anomalous NFs using the data
collected from UE and NFs.
NOTE: By this requirement, it is only assured that specific data can be
collected by and/or reported to an analytics function. Which AI/ML is used is
implementation-specific and out of scope in 3GPP.
## 5.3 Key issues related to data transfer protection
### 5.3.1 Key Issue #3.1: Privacy preservation for transmitted data between
multiple NWDAF instances
#### 5.3.1.1 Key issue details
In the case of Multiple NWDAF Instances, during the transfer of
data/metadata/analytics output, it needs to be ensured that the privacy of the
user is preserved.
It needs to be ensured that appropriate measures are taken by the sender NWDAF
to protect any information which can reveal the privacy of the user, such as
positioning information, user profile information, etc., before sending
privacy-related data to another NWDAF instance. Privacy-related information
that has been allowed by the User for analysis should not be transferred
without sufficient protection mechanism.
#### 5.3.1.2 Security threats
Information that can reveal the identity of the user can compromise privacy
when transmitted unprotected.
The transfer of personally identifiable information without adequate
protection measures constitutes a threat against user privacy and possibly
violates regulations on data protection.
Note 1: Description of the attacker model is not addressed in the present
document.
NOTE 2: A user signs the privacy agreement with an operator. When the
permission is granted from the user, the operator is authorized to process the
data for the purpose agreed by the user. The user is unaware of and has no
need to know which NWDAF instance the data is transferred to. What matters is
whether the data is used for the agreed purpose. Transferring the data from
one NWDAF instance to another within the operator\'s network has no privacy
implications.
#### 5.3.1.3 Potential security requirements
Any information which can reveal the identity of the user, such as positioning
information, user profile information, etc, should be securely protected
before data is being shared or transferred to other NWDAF Instances.
### 5.3.2 Key Issue #3.2: Protection of UE data in transit
#### 5.3.2.1 Key issue details
The UE is providing the core network functions with data, which are reported
to or requested by analytics functions. The transfer of any data between core
network functions needs to be protected.
According to TS 23.288 [4] the NWDAF collects data from various data sources
and provides Analytics Output to different NWDAF data consumers. In addition,
according to the solutions for KI#2 \"Multiple NWDAF Instances\" proposed in
TR 23.700-91 [1] the analytics data or the analytics output can be transferred
from one NWDAF instance to another NWDAF instance.
Data in transit needs to be protected while in transfer between NWDAFs, NF to
NWDAFs, and NWDAF to another entity, e.g. DCCF.
This key issue addresses security for data in transit involving an analytics
function.
#### 5.3.2.2 Security Threats
If data is transferred between NFs or different NWDAF Instances, a MitM (for
instance a malicious SCP) can compromise data by eavesdropping or
modification.
A rogue NWDAF Instance can send wrong or modified data to another NWDAF
instance.
#### 5.3.2.3 Potential security requirements
Data transferred between core network functions shall be integrity,
confidentiality, and replay protected.
### 5.3.3 Key Issue #3.3: Ensuring restrictive transfer of ML models between
authorized NWDAF instances
#### 5.3.3.1 Key issue details
In TS 23.288 Clause 5.1 Note 3, it is stated \"_In this Release of the
specification an NWDAF containing AnLF is locally configured with (a set of)
NWDAF (MTLF) ID(s) and the analytics ID(s) supported by each NWDAF containing
MTLF to retrieve trained ML models. An NWDAF containing AnLF uses NWDAF
discovery for NWDAF(MTLF) within the set of configured NWDAF containing MTLF
ID(s), if necessary._ \"
Since machine learning models are trained using proprietary algorithms, and
sometimes are also trained using sensitive data, securing them and ensuring
restricted usage and secure transfer is paramount. Therefore, this key issue
will study how to ensure that trained model sharing is only allowed among
authorized NWDAF instances.
#### 5.3.3.2 Security Threats
If ML models are shared with an NF, which is not authorized, proprietary and
sensitive implementation-specific information may be leaked.
#### 5.3.3.3 Potential security requirements
Only authorized NWDAF instances should be allowed to consume ML models from
other NWDAF instances.
# 6 Solutions
## 6.0 Mapping of solutions to key issues
Table 6.0-1: Mapping of solutions to key issues
Solutions Key Issues
* * *
                                                                                                                             1 Key issues related to securing the data provided to any type of analytics function   2 Key issues related to detection of cyber-attacks and anomaly events by analytics function   3 Key issues related to data transfer protection                                       
                                                                                                                             1.1                                                                                    1.2                                                                                           1.3                                                1.4   1.5   2.1   2.2   3.1   3.2   3.3
#1: UE data collection protection X  
#2: Network Analysis Framework for DDoS Attack X  
#3: Usage of current SBA mechanisms to protect data in transit X  
#4: DCCF determining if NF Service consumer is authorized to invoke a service
to a Data Producer NF for data collection X  
#5: Providing the security of data via Messaging Framework X  
#6: Integrity protection of data transferred between AF and NWDAF X  
#7: Detection of anomalous NF behaviour by NWDAF X  
#8: Privacy preservation of transmitted data X  
#9: Processing of tampered data X  
#10:Authorization of NF Service Consumers for data access via DCCF X  
#11: Authorization of NF Service Consumers to access data from ADRF via DCCF X  
#12: Solution on Authorization of Data Consumers for data access via DCCF X  
#13: Solution for UE data collection protection at NF/NWDAF X  
#14: Solution to ML restrictive transfer X #15: Solution on Protection of data
sent via MFAF using existing SBA mechanisms X
## 6.1 Solution #1: UE data collection protection
### 6.1.1 Introduction
This solution addresses KI#1.5 on UE data collection protection at NF/NWDAF.
### 6.1.2 Solution details
For enhancing the 5GS to support collection and utilisation of data provided
by the UE in NWDAF in order to provide input information to generate analytics
information (to be consumed by other NFs) the communication between UE and
NF/NWDAF needs to be secured.
In line with 5GS generic security requirements it is therefore proposed that
the transfer of data between UE and NF/NWDAF related to UE data collection re-
uses existing 5GS security mechanisms.
For UE data collection by NFs and NWDAF, the current NAS and AS security
mechanisms for authentication, confidentiality, integrity and replay
protection as described in TS 33.501 are used.
NOTE: Whether user consent is necessary is subject of the user consent study
FS_UC3S.
For transfer of UE data to NF/NWDAF privacy requirements could apply.
### 6.1.3 Evaluation
This solution reuse the existing 5GS security mechanisms, include the current
NAS and AS security mechanisms to solve the security problems between UE and
network..
This solution provides authentication, confidentiality, integrity and replay
protection as described in TS 33.501.
This solution meets the requirement in KI#1.5 without any extra system impact.
## 6.2 Solution #2: Network Analysis Framework for DDoS Attack
### 6.2.1 Introduction
The solution addresses key issue #2.1: Cyber-attacks Detection supported by
NWDAF.
### 6.2.2 Solution details
#### 6.2.2.1 Introduction
As depicted in clause 6.7.5 in TS 23.288 [4], the NWDAF could collect the
following input data:
\- Exceptions information from AF, including: IP address 5-tuple, exception
ID, exception level, and exception trend.
\- UE mobility information from OAM is UE location carried in MDT data.
\- Network data related to UE mobility from AMF, including: UE ID, UE
location, Timestamp, TAC, frequent mobility registration update.
\- Service data related to UE mobility provided by AF, including: UE ID,
Application ID, UE location, Timestamp.
\- Service data related to UE communication provided by SMF, AF, UPF,
including: UE ID, group ID, S-NSSAI, DNN, Application ID, Expected UE
behaviour parameters, communication description per application (e.g.
communication start, communication stop, UL data rate, DL data rate, traffic
volume), TAC.
The NWDAF could output the following: Exception ID, Exception Level, Exception
trend, UE characteristics, SUPI list (1..SUPImax), Ratio, Amount, Additional
measurement, Confidence.
Specifically, exception ID can be \"Suspicion of DDoS attack\" means that the
UE may trigger a DDoS attack. In this case, Additional measurement is
\"Victim\'s address (target IP address list)\". And the mitigation can be
\"PCF may request SMF to release the PDU session. SMF may release the PDU
session and apply SM back-off timer.\"
However, the analysis is just for DDoS attack to external AF.
DDoS attack to internal NF, e.g. RAN, Core Network should also be
investigated. In order to make it more clear to capture the DDoS analysis, it
is proposed a network analysis framework for DDoS attack.
#### 6.2.2.2 Network Analysis Framework for DDoS attack
The framework is depicted in table 6.2.2.2-1. In column DDoS attack, target
network entity and attack method are clarified. In column analysis, input,
output and mitigation are listed as the same way as TS 23.288 [4]. With the
framework, it will be more clear how to capture attack and how to detect the
DDoS attack.
Table 6.2.2.2-1: Network Analysis Framework for DDoS attack.
+-------------+-------------+-------------+-------------+-------------+ | DDoS Attack | Analysis | | | | +=============+=============+=============+=============+=============+ | Target | Method | Input | Output | Mitigation | +-------------+-------------+-------------+-------------+-------------+ | AF | DDoS using | AF: GPSI, | DDoS to AF | PCF may | | | heavy UP | external | | request SMF | | | traffic | group ID, | | to release | | | | Exception | | the PDU | | | | information | | session. | | | | (IP address | | | | | | 5-tuple, | | SMF may | | | | exception | | release the | | | | ID, | | PDU session | | | | exception | | and apply | | | | level, and | | SM back-off | | | | exception | | timer. | | | | trend), | | | | | | Application | | | | | | ID, | | | | | | co | | | | | | mmunication | | | | | | description | | | | | | per | | | | | | application | | | | | | (co | | | | | | mmunication | | | | | | start, | | | | | | co | | | | | | mmunication | | | | | | stop, UL | | | | | | data rate, | | | | | | DL data | | | | | | rate, | | | | | | traffic | | | | | | volume), | | | | | | Expected UE | | | | | | Behaviour | | | | | | parameters | | | | | | | | | | | | SMF: SUPI, | | | | | | internal | | | | | | group ID, | | | | | | Application | | | | | | ID | | | | | | | | | | | | UPF: UE | | | | | | co | | | | | | mmunication | | | | | | description | | | | | | per | | | | | | application | | | | | | (co | | | | | | mmunication | | | | | | start, | | | | | | co | | | | | | mmunication | | | | | | stop, UL | | | | | | data rate, | | | | | | DL data | | | | | | rate, | | | | | | traffic | | | | | | volume) | | | | | | | | | | | | AMF: TAC | | | +-------------+-------------+-------------+-------------+-------------+ | RAN | DDoS using | OAM: Global | DDoS to RAN | AMF may | | | heavy RRC | RAN Node | | provide AMF | | | signaling | ID, time | Victim RAN | UE N2AP ID | | | | stamp, | Node ID | and RAN UE | | | | SUPI, | | N2AP ID to | | | | initial RRC | Malicious | RAN of | | | | message | SUPI | malicious | | | | number | | SUPI. | | | | | | | | | | AMF: Global | | RAN may | | | | RAN Node | | treat the | | | | ID, time | | malicious | | | | stamp, | | UEs based | | | | SUPI, | | on local | | | | initial NAS | | policy, | | | | message | | e.g. | | | | number, | | release its | | | | TAIs, NGAP | | resource. | | | | UE-TNLA | | | | | | binding | | | | | | info, | | | | | | number of | | | | | | requests | | | | | | received, | | | | | | threshold | | | | | | value of | | | | | | requests | | | | | | received | | | | | | per unit | | | | | | time | | | +-------------+-------------+-------------+-------------+-------------+ | AMF | DDoS using | OAM: Global | DDoS to AMF | AMF may | | | heavy NAS | RAN Node | | treat the | | | signaling | ID, time | Victim AMF | malicious | | | | stamp, | instance ID | UEs based | | | | SUPI, | | on local | | | | initial RRC | Malicious | policy, | | | | message | SUPI | e.g. | | | | number | | release its | | | | | | resource. | | | | AMF: AMF | | | | | | instance | | | | | | ID, Global | | | | | | RAN Node | | | | | | ID, time | | | | | | stamp, | | | | | | SUPI, | | | | | | initial NAS | | | | | | message | | | | | | number, | | | | | | initial SM | | | | | | message | | | | | | number | | | +-------------+-------------+-------------+-------------+-------------+
#### 6.2.2.3 The Rational of Each Input Data
When the UEs initiate a DDoS attack to the AF using heavy UP traffic,
exception information can provide training data for identifying abnormal UP
traffic, communication description per application and Expected UE Behaviour
parameters can provide training data for identifying normal UP traffic, TAC
identifies the same type of the UE.
When the UEs initiates a DDoS attack to the RAN using heavy RRC signaling,
number of initial RRC messages and number of initial NAS messages to RAN or
AMF can provide training data for identifying normal RRC signaling. Further
information about the TAI assist in understanding the geographical area from
where the attack might be originating, and the NGAG UE-TNLA binding
information assist in identifying the UEs from which the attack is being
generated.
When the UEs initiates a DDoS attack to the AMF using heavy NAS signaling,
number of initial RRC messages and number of initial NAS messages to AMF can
provide training data for identifying normal NAS signalling, number of initial
SM message can identify the abnormal SM signaling caused by UP faults.
### 6.2.3 Evaluation
Not addressed in the present document.
## 6.3 Solution #3: Usage of current SBA mechanisms to protect data in transit
### 6.3.1 Introduction
This solution addresses KI#3.2 on protection of data in transfer.
### 6.3.2 Solution details
Any data transferred between core network functions is protected by SBA
mechanisms as described in clause 13.3 and clause 13.4 of TS 33.501 [8] for
authentication and authorization of NF Service Consumer and NF Service
Producer.
According to TS 33.501 [8], clause 13.3.0, all network functions support
mutually authenticated TLS and HTTPS. TLS is used for transport protection
within a PLMN unless network security is provided by other means. Thus,
communication between NFs is integrity, confidentiality and replay protected.
By using an access token issued by NRF, NFs are authorized for requesting
analytics from an analytics function or providing analytics data to the
analytics function.
### 6.3.3 Evaluation
This solution addresses the requirement of key issue #3.2.
This solution reuses the existing 5GS security mechanisms, including the
current SBA security mechanisms to solve the security problems of data
transition between NFs.
This solution provides mutual authentication, confidentiality, integrity and
replay protection between NFs as described in TS 33.501 [8].
## 6.4 Solution #4: DCCF determining if NF Service consumer is authorized to
invoke a service to a Data Producer NF for data collection
### 6.4.1 Introduction
This solution addresses KI#1.3, especially the threat that based on a request
from a DCCF, the Messaging Framework may provide data from a NF Service
Producer to a requesting NF Service Consumer, even though the NF Service
Consumer is not authorized to receive this data.
### 6.4.2 Solution details
#### 6.4.2.0 General
Currently before an NF Service Consumer invokes a service of an NF Service
producer, the NF Service Consumer needs to request authorization from the NRF.
The NRF determines if the NF Service Consumer is authorized to use the service
of the Service Producer and provides an authorization token. The NF Service
Consumer uses the authorization token in the service request to the NF Service
Producer and the NF Service Producer executes the service by validating the
authorization token.
The above procedure will be used when the NF Service Consumer requires the
service of the DCCF for data collection. In such a case the NF Service
Consumer will provide an access_token provided by the NRF in the service
request to the DCCF.
NOTE 1: It is assumed that the NF Service Consumer relies on the DCCF to
determine the Data Producer NFs for data collection.
When the DCCF receives the request for data collection, the DCCF identifies
the Data Producer NF that can provide the requested data and request
authorization from the NRF to invoke the services supported by the identified
Data Producers in order to retrieve the data. The issue is that in the
authorization request to the NRF, the NRF will not have information on the
identity of the NF Service Consumer that requested the data. It is proposed to
solve the issue by allowing the DCCF to include in the authorization request
to the NRF the authorization token provided by the NF Service Consumer in the
service request to the DCCF. In addition, to allow the NRF to verify the
identity of the service consumer it is also proposed to NF Service Consumer
includes a CCA token which will be used by the NRF to verify the identity of
the NF Service Consumer.
Note 2: Authorization aspects for MFAF are FFS, i.e. if MFAF need also be
authorized to receive data.
The solution is shown in detail in the following clause.
#### 6.4.2.1 Detailed Procedure
Figure 6.4.2-1: Service consumer authorization for DCCF selected Service
Producers
1\. An NF service consumer (e.g. NWDAF) discovers a DCCF to retrieve data. The
NF Service consumer requests authorization from an NRF by invoking an
Nnrf_AccessToken_Get request including the information to identify the target
NF (DCCF) and the source NF.
2\. The NRF authorizes the request and generates an access token as described
in TS 33.501.
3\. The access token (access_token_nwdaf) is provided to the NF service
consumer.
4\. The NF Service Consumer initiates an NF service request to the DCCF which
includes the access_token_nwdaf. The NF Service Consumer also generates a
Client Credentials Assertion (CCA) token (CCA_NWDAF) as described in TS 33.501
and includes it in the request message in order to authenticate itself towards
the NRF when the request is sent via the DCCF. From NF service consumer
perspective, the NF service producer is the DCCF and end point is NRF, both
included in the CCA.
5\. The DCCF verifies that the access_token_nwdaf is valid and executes the
service.
6\. The DCCF determines that the requested service is provided by a different
NF Service Producer(s). Since the service is provided by different NF(s) the
DCCF verifies that the NF Service Consumer can access (indirectly) the
services provided by the identified NF Service Producer(s).
7\. The DCCF requests authorization from the NRF by invoking an
Nnrf_AccessToken_Get request including the information to identify the target
NF (NF Service Producer), the source NF (DCCF) and additional authorization
information by including the CCA_nwdaf provided by the NF Service Consumer.
For indirect communications, the DCCF may also include its own CCA, if there
is SCP in between DCCF and NRF.
8\. The NRF determines whether the DCCF and the NF Service Consumer (based on
the CCA_nwdaf) are allowed to access the service provided by the identified NF
Service Producers. Since the CCA_nwdaf includes the NF instance ID, the NF
type of the expected audience and the signature based on the private key, the
NRF can determine that this NF instance was authorized to access the DCCF
before. Further based on the NF type in the CCA and the requested NF Service
Producers from the DCCF in the access token request, the NRF can determine
whether the selected NF Service Producers match that NF type and can be
authorizes for the NF instance ID from the NF Service Consumer.
9\. The NRF generates and provides an access token to the DCCF as described in
TS 33.501.
10\. The DCCF uses the access token to initiate an NF service to the
identified NF Service Producer to retrieve the data. The DCCF includes the
CCA_nwdaf in the request. If the DCCF determines that the service consumer is
not allowed to use the service of the data producer then the DCCF does not
instruct the MF to collect data from the data producer.
11\. The NF Service Producer(s) verify the access token and the CCA_nwdaf and
execute the service.
12\. The NF Service Producer(s) provide requested data in the response to step
10.
13\. The DCCF forwards the provided data to the NF Service Consumer in the
response to step 4.
### 6.4.3 Evaluation
The proposed solution fullfills the following security requirements:
The data consumer is authorized to access the data from the data source.
Authorization of the DCCF is supported to access a service of a data source on
behalf of a data consumer.
Service consumer authorization is based on the CCA_nwdaf.
## 6.5 Solution #5: Providing the Security protection of data via Messaging
Framework
### 6.5.1 Introduction
This solution addresses KI#1.4 on the security of data via Messaging
Framework.
The DCCF is a control-plane function that coordinates data collection and
triggers data delivery to Data Consumers.
The Figure 6.2.6.3.4-1 in TS 23.288 [4] depicts how a data consumer (e.g.
NWDAF) obtain data and be notified of events using the DCCF and a Messaging
Framework. The 3GPP DCCF Adaptor (3da) Data Management service and 3GPP
Consumer Adaptor (3ca) Data Management service of the Messaging Framework
Adaptor Function (MFAF) are used to interact with the 3GPP Network and the
Messaging Framework.
### 6.5.2 Solution details
#### 6.5.2.0 General
This solution proposes to use existing SBA mechanism for confidentiality
protection, integrity protection, and replay-protection on the new interfaces
between 3GPP entities and the MFAF.
This solution also proposes a procedure for the confidentiality, integrity,
and replay protection of the transferred data against the Messaging Framework
in case that the collected data is not requested to be formatted/processed.
For the same type of data collection, the DCCF can manage an encryption key
and an integrity key. The DCCF provides the keys to the data consumer and the
data producer. The data producer will use the keys to encrypt the data and
generating the MIC (Message Integrity Code), while the data consumer will use
the key to decrypt the data and check the MIC. In such way, the data will not
be revealed to the Messaging Framework and any modification of the data can be
detected. In case a new Data Consumer subscribes to the same type of data
where a notification procedure is already ongoing, then a key refresh
procedure is carried out. In the following the term subscription ID is used,
where the subscription ID includes information to identify the Data required
(e.g. a set of Event ID(s) from Data Producer NF), information to identify the
UE (single UE, group of UE(s) or any UE), optionally information to identify
the data producer, and filtering information such as location area or time of
day where data is required from.
Our solution is exemplified using the steps of the solution shown in Figure
6.5.2-1 based on the procedure shown in Figure 6.2.6.3.4-1 in TS 23.288 [4].
Our solution steps are marked as bold, as additional steps to this example
procedure.
Figure 6.5.2.0-1: Protection of data sent via the messaging framework
1\. The data consumer-1 subscribes to data via the DCCF by invoking the
Ndccf_DataManagement_Subscribe (Service_Operation, Data Specification, NF (or
NF-Set) ID, ADRF Information, Data Consumer Notification Target Address (+
Notification Correlation ID)) service operation as specified in clause 8.2.2
in [4]. The data consumer may specify one or more notification endpoints and
the NF or NF set to collect data from.
> Service_Operation is the service operation to be used by the DCCF to request
> data (e.g. Namf_EventExposure_Subscribe or OAM Subscribe). Data
> Specification provides Service_Operation-specific required parameters (e.g.
> event IDs, UE-ID(s), target of event reporting) and optional input
> parameters used to retrieve the data. The data consumer may optionally
> include the Data Source NF Instance (or NF Set) ID and ADRF information
> indicating whether the data are to be stored in an ADRF and, optionally, an
> ADRF ID.
2\. If the NF instance or NF Set ID is not provided by the data consumer, the
DCCF determines the NF instances that can provide data as described in clause
5A.2 and clause 6.2.2.2 in [4]. If the consumer requested storage of data in
an ADRF, but the ADRF ID is not provided by the data consumer, or the
collected data is to be stored in an ADRF according to configuration on the
DCCF, the DCCF selects an ADRF to store the collected data.
3\. The DCCF determines the Data Source (e.g. AMF-1) that can provide the data
and checks that the requested data is not already being collected.
> **If the requested data is not being collected yet, then the DCCF generates
> a data encryption key K~E~ and a data integrity key K~I.~ The DCCF will keep
> a mapping between the subscription (Identified by a Subscription ID) and the
> pair of keys.**
4\. The DCCF sends an Nmfaf_3daDataManagement_ Configure (Data Consumer
Information, MFAF Notification Information) to configure the MFAF to map
notifications received from the Data Source to outgoing notifications sent to
endpoints.
> Data Consumer Information contains for each notification endpoint, the data
> consumer Notification Target Address (+ Data Consumer Notification
> Correlation ID to be used by the MFAF when sending notifications in step 8.
**4a. The DCCF sends the subscription response to the Data Consumer-1. In the
response, the DCCF provides key K~E~ and key K~I~ as well as a Subscription
ID.**
5\. The DCCF subscribes to data from the NF using the
Nnf_EventExposureSubscribe (Data Specification, MFAF Notification Target
Address (+ MFAF Notification Correlation ID)) service operation as specified
in clause 5A.2 and clause 6.2.2.2 in [4], using the MFAF Notification Target
Address (+ MFAF Notification Correlation ID) received in step 4. The DCCF adds
the data consumer to the list of data consumers that are subscribed for these
data.
**The request also includes key K~E~ and a data integrity key K~I~**.
6\. The Data Source acknowledges the request with a Subscription ID.
7\. When new output data are available, the Data Source uses
Nnf_EventExposure_Notify to send the data to the MFAF. The Notification
includes the MFAF Notification Correlation ID.
**The data source associates the data with a Sequence Number. The data source
encrypts the data using K~E~ and protects the integrity of the data by
including a MIC (Message Integrity Code). The data source computes the MIC as
HASH ~KI~ (data \|\| Sequence Number).**
8\. The MFAF uses Nmfaf_3caDataManagement_Notify to send the data to all
notification endpoints indicated in step 4. Notifications are sent to the
Notification Target Address(es) using the Data Consumer Notification
Correlation ID(s) received in step 4. The MFAF may store the information in
ADRF if requested by consumer or if required by DCCF configuration.
**The message also includes the Sequence number received in step 7.**
> **When Data Consumer-1 receives the data, it will check the data integrity
> and decrypt the data.**
9\. Data Consumer-2 (e.g.: NWDAF-2) sends a request for the same Data via the
DCCF by invoking the Ndccf_DataManagement_Subscribe. The message may indicate
whether the requested data should be sent to Data Consumer-2, and/or to other
Consumers such as Data Repository. The Notification Correlation ID of
Consumer-2 is included for notifications sent to Data Consumer-2.
10\. The DCCF determines that the requested data is already being collected
from a Data Source (e.g.: AMF-1).
**10a. (If key refresh is needed) The DCCF initiates a key refresh procedure
for the data as described in Figure 6.5.2.2-1.**
**10b-12. Same procedure as in step 4a-7 for Data Consumer-2.**
**13-14. Same procedure as in step8 for Data Consumer-1 and Data Consumer-2.**
**When the DCCF provides the key K~E~ and key K~I~, it also maintains a timer
for renewing the keys. When DCCF decides to renew the keys, it will send to
the data consumer a message with the new keys associated with the Subscription
ID mentioned in step 4a. When the DCCF sends the new keys to the data
consumer, it put the Subscription ID mentioned in step 6 in the message.**
#### 6.5.2.1 DCCF initiated key refresh procedure
Since the keys K~E~ and K~I~ are shared between several data consumers and
data source, it is recommended to frequently change the keys either with a
limited lifetime or sequence number wrap around in data source. The data
consumer is trusted in this solution, when to perform the key refresh
procedure depends on different events, e.g., when the key lifetime expires, or
sequence number wrap around in data source.
Figure 6.5.2.2-1: DCCF initiated key refresh
1\. The DCCF receives a new subscription request from Data Consumer-2 to an
existing event notification for a specific subscription ID or the key refresh
timer for a specific subscription ID expires/reaches the value of the key
lifetime. The DCCF generates fresh keys K~E~ and K~I~ .
2\. The DCCF identifies based on the subscription ID the subscribed Data
Consumer and the Data Source. The DCCF deletes the old key pairs and binds the
new key pair to the involved NFs of the subscription ID.
3\. The DCCF sends a Key Refresh Request to all Data Consumers and the Data
Source including the subscription ID and the new keys K~E~ and K~I~.
> In case the DCCF would like to store data in the Data Repository Function
> (DRF), then the DCCF adds the DRF as a data consumer for a specific
> subscription ID. The DRF then can decrypt the encrypted data and store it
> unencrypted in the DRF (tamperproof) memory. Once a data consumer would like
> to read historic data of a specific subscription ID from the DRF, then it
> creates a corresponding subscription ID and the DCCF will add the DRF as a
> data source. With those scenarios, the DRF will always be able to store the
> data of producers and to provide them to consumers, because the DRF will
> always have the corresponding keys K~E~ and K~I~ to encrypt/decrypt the
> data.
### 6.5.3 Evaluation
This solution addresses key issue#1.4 (Security protection of data via
Messaging Framework) and fulfils the requirements in case that the collected
data is not requested to be formatted/processed.
The solution proposes to use existing SBA mechanism for the protection of the
new interfaces.
According to the solution, DCCF provides keys to data consumers and data
producer to establish security for data transfer.
_Impacts to DCCF:_
\- Groups the data consumers for the same type of data collection
\- Manages the encryption and integrity keys, which are the same for all data
consumers of this group of data collection and data producer to establish
security for data transfer.
_Impacts to data producer:_
\- Produced data is encrypted with the keys from the DCCF and protected with a
MIC (Message Integrity Code)
Impacts to data consumer:
\- Received data is decrypted with the keys from the DCCF and validated by
checking the MIC.
Note: Further evaluation is needed.
## 6.6 Solution #6: Integrity protection of data transferred between AF and
NWDAF
### 6.6.1 Introduction
This solution addresses KI#1.1 on integrity protection of data transferred
between AF and NWDAF.
### 6.6.2 Solution details
To enhance the 5GS to support collection and utilisation of UE related data
for providing the inputs to generate analytics information (to be consumed by
other NFs), the communication between UE and AF/NWDAF needs to be secured.
The NWDAF interacts with the 5GC NFs and the AF using Service-based
Interfaces. When the AF is located in the operator\'s network, the NWDAF uses
Service-Based Interface to communicate with the AF directly. When the AF is
located outside the operator\'s network, the NEF is used to exchange the
messages between the AF and the NWDAF as defined in Rel-16. The security
aspects of NEF is specified in clause 12 of TS 33.501 [8].
The existing 5G security mechanism can be re-used for the transfer of UE data
over the SBA interface between AF and NWDAF. For the UE data collection by AF
and NWDAF, the current NAS and SBA based security mechanisms for
authentication, confidentiality, integrity and replay protection as described
in TS 33.501 [8] are used.
### 6.6.3 Evaluation
This solution reuse the current mechanisms to protect the communication
between AF and NWDAF.
AF may located in or outside the operator\'s network, both of the situation
use the current mechanisms in this solution.
This solution meets the requirement in KI#1.1 without any extra system impact.
## 6.7 Solution#7: Detection of anomalous NF behaviour by NWDAF
### 6.7.1 Introduction
This solution addresses key issue #2.2.
The 5GC supports various NF deployments in order to ensure that the NF can
provide services from multiple locations. These cloud platforms may be owned
and operated by the PLMN operator himself or they may be run on commercial
public cloud platforms. When NFs are distributed across multiple cloud
infrastructures, it is possible that the NFs behave in an anomalous manner.
Such anomalous behaviour can arise either due to configuration errors or
internal data corruption, or due to an attack.
To allow an operator to manage its NF cloud deployment efficiently, additional
security relevant log data from the NFs can be provided to the NWDAF, which
can then be used to analyse and detect the root cause for an anomaly.
### 6.7.2 Solution details
#### 6.7.2.1 General
The OAM or some operator defined AF may subscribe/request to the NWDAF to
notify/respond when it detects an abnormal behaviour for a particular NF
instance (for example excessive resource usage or consistent failure to
provide its service). There can be various causes of abnormal behaviour such
as an erroneous operation at a NF, an error at the side of the cloud provider
where the NF is deployed, or an impending attack at a particular NF by a
malicious entity in the system.
In order to analyse the root cause of the anomaly with certain degree of
confidence, more information or related data can help. Thus, NWDAF requests
inputs from different entities in the system (such as OAM, NRF and NFs) for
detailed analysis. Security related data for analytics can also be collected
by NWDAF from the NFs (or via OAM). The final output analytics is then sent to
the OAM or the AF for adequate measures.
In order to facilitate the security related log data collection from NFs two
different methods are proposed
NOTE: Defining the protocols used for log collection is not in the scope of
the present document.
#### 6.7.2.2 Collection of security related log data of NFs via NFs
EventExposure APIs
The procedure depicted in Figure 6.7.2.2-1 allows a consumer to request
analytics from NWDAF for anomalous NF behaviour and its root cause.
Figure 6.7.2.2-1: NF anomalous behaviour analytics provided by NWDAF using
security logs obtained from NFs EventExposure APIs
> 1\. The OAM or operator\'s AF sends a request/subscription to the NWDAF for
> NF anomalous behaviour analytics using either the
> _Nnwdaf_AnalyticsInfo_Request_ or _Nnwdaf_AnalyticsSubscription_Subscribe_
> service operation.
>
> 2\. If the request is authorized, and in order to provide the requested
> analytics, the NWDAF may subscribe to OAM services to retrieve resource
> usage and NF resources configuration of all targeted NF instances, following
> the procedure specified in clause 6.2.3.2 in TS 23.288 [4].
>
> 3a. The NWDAF subscribes to NRF to receive notification on changes, e.g., on
> the load and status of NF instances registered in NRF, using
> _Nnrf_NFManagement_NFStatusSubscribe_ service operation for all targeted NF
> instances. NF instances are identified by their NF id.
>
> 3b. NRF notifies NWDAF of changes on the load and status of the requested NF
> instances by using _Nnrf_NFManagement_NFStatusNotify_ service operation.
>
> 4a. The NWDAF subscribes or requests the additional security specific log
> info (as specified in the table 6.7.2.3-1) for a particular NF by invoking
> the _Nnf_EventExposure_Subscribe_ service operation.
>
> 4b. The NF then notifies the NWDAF (e.g. with the complete log report) by
> invoking _Nnf_EventExposure_Notify_ service operation.
>
> 5\. The NWDAF derives the relevant analytics using the inputs provided by
> the OAM, NRF, and the NF (as specified in the table 6.7.2.3-2)
>
> 6\. The NWDAF provides requested NF anomalous information along with the
> corresponding root cause (for instance a malicious NF trying to attack other
> NF for denial of service, or an erroneous NF unable to provide service to
> other NFs) using either the _Nnwdaf_AnalyticsInfo_Request_ response or
> _Nnwdaf_AnalyticsSubscription_Subscribe_ response, depending on the service
> used in step 1.
#### 6.7.2.3 Collection of security related log data of NFs via OAM
The procedure depicted in Figure 6.7.2.3-1 allows a consumer to request
analytics from NWDAF for anomalous NF behaviour and its root cause using the
security specific NF logs obtained from OAM.
Figure 6.7.2.3-1: NF anomalous behaviour analytics provided by NWDAF using
security logs obtained from OAM
> 1\. The OAM or operator\'s AF sends a request/subscription to the NWDAF for
> NF anomalous behaviour analytics using either the
> _Nnwdaf_AnalyticsInfo_Request_ or _Nnwdaf_AnalyticsSubscription_Subscribe_
> service operation.
>
> 2\. If the request is authorized, and in order to provide the requested
> analytics, the NWDAF may subscribe to OAM services to retrieve resource
> usage and NF resources configuration of all targeted NF instances, following
> the procedure specified in clause 6.2.3.2 in TS 23.288 [4]. The NWDAF
> further sends the request to the OAM to provide the security specific log
> into (as specified in the table 6.7.2.3-1).
3\. OAM then collects all the requested information along with the security
logs from the NFs and provide it to NWDAF.
> 4a. The NWDAF subscribes to NRF to receive notification on changes, e.g., on
> the load and status of NF instances registered in NRF, using
> _Nnrf_NFManagement_NFStatusSubscribe_ service operation for all targeted NF
> instances. NF instances are identified by their NF id.
>
> 4b. NRF notifies NWDAF of changes on the load and status of the requested NF
> instances by using _Nnrf_NFManagement_NFStatusNotify_ service operation.
>
> 5\. The NWDAF derives the relevant analytics using the inputs provided by
> the OAM and NRF (as specified in the table 6.7.2.3-2)
>
> 6\. The NWDAF provides requested NF anomalous information along with the
> corresponding root cause (for instance a malicious NF trying to attack other
> NF for denial of service, or an erroneous NF unable to provide service to
> other NFs) using either the _Nnwdaf_AnalyticsInfo_Request_ response or
> _Nnwdaf_AnalyticsSubscription_Subscribe_ response, depending on the service
> used in step 1.
Table 6.7.2.3-1: Security specific parameters provided by NFs (NF/NRF) to
assist in detection
* * *
Information Description Timestamp A time stamp associated with the service
request which was sent by the NF Service Consumer to a NF Service Producer. NF
Service Consumer / SCP Identifier The consumer instance or the SCP which sends
the service request along with the access token to the NF Service Producer. NF
Service Producer Identifier The producer instance which receives the requests
and which verifies the access token received along with the requests
Authorization status of NF Service Consumer Indicated if a given NF Service
Consumer is authorized to receive an access token or not, as provided by NRF.
Access Token Authenticity Information such as, if access token provided is for
the service request it is sent, and if it is generated for the NF Service
Consumer which is requesting the service. Access Token Validity Verification
result, i.e. whether the access token is valid or invalid. Number of requests
to access a service Number of simultaneous requests received at the NF Service
Producer for a particular time window. Requested Service Name Name of the
service for which the requests had been received. Service Response
Confirmation Confirmation whether the NF Service Producer was able to fulfil
the service requests or not.
* * *
Table 6.7.2.3-2: Inputs provided to NWDAF in assisting the detection of
anomalous NF
* * *
Information Source Description Security Log Data OAM/NF Additional security
relevant log info as described in table 6.7.2-1. NF Load NRF The load of
specific NF instance(s) recorded in their NF profile as defined per TS 29.510
[2]. NF resource usage OAM The usage of assigned virtual resources for
specific NF instance(s) (e.g., mean usage of virtual CPU, memory, disk) as
defined in TS 28.552 [3] clause 5.7.
* * *
Table 6.7.2.3-3 and Table 6.7.2.3-4 specifies the output analytics from NWDAF.
Table 6.7.2.3-3: Anomalous NF behaviour statistics
**Information** **Description**
* * *
Exceptions (1..max) List of observed exceptions > Exception ID The risk
detected by NWDAF > Exception category Indication if the anomalous behaviour
is an attack or genuine error > Exception level Scalar value indicating the
severity of the abnormal behaviour > List of target NF(s) One or more NFs
which are affected due to the anomalous NF in the system > List of anomalous
NF(s) One or more NFs which are the probable cause of the anomalous activity
in the system (either because they are malicious or due to internal errors)
Table 6.7.2.3-4: Anomalous NF behaviour predictions
**Information** **Description**
* * *
Exceptions (1..max) List of predicted exceptions > Exception ID The risk
detected by NWDAF > Exception category Indication if the anomalous behaviour
is an attack or genuine error > Exception level Scalar value indicating the
severity of the abnormal behaviour > List of target NF(s) One or more NFs
which are affected due to the anomalous NF in the system > List of anomalous
NF(s) One or more NFs which are the probable cause of the anomalous activity
in the system (either because they are malicious or due to internal errors) >
Confidence Confidence of this prediction
Based on the input, an analytics function can monitor and find abnormalities
in NF load or NF resource usage, which can result in an alert. Specific
security log data can help to understand if this is normal behaviour or could
be resulting from a NF that is behaving anomalous.
Thus, when NFs send service requests to other NFs, input data such as the
number of service requests sent, the percentage of successful service
requests, the percentage of successful access token verification and the
serving NF load and resource usage can be used to provide training data for
normal service requests reception and load.
Input data such as NF Service Consumer / SCP identifier, the NF Service
Producer Identifier and the Requested Service Name can be used to identity the
anomalous/erroneous NF in the system.
NOTE: The derivation of output from input depends on the algorithms used or
the policy present. How to derive the output from input is up to
implementation logic, which is out of scope of 3GPP.
### 6.7.3 Evaluation
The solution proposes NWDAF to collect NF related data such as resource
utilization, load information and additional security specific log data to
facilitate analysis and detection in anomalous behavior.
The solution proposes to provide input data which will be useful in addressing
the security requirements present in the KI 2.2.
## 6.8 Solution#8: Privacy preservation of transmitted data
### 6.8.1 Introduction
This solution addresses key issue #3.1.
During the transfer of data/metadata/analytics-output from one NWDAF to
another NWDAF, it should be ensured that any information that can reveal the
identity of the user or compromise in another way the privacy of the user is
protected.
Therefore, appropriate measures should be taken by the sender NWDAF to protect
any information that can hamper privacy and maybe reveal the identity of the
user. Some of the examples are positioning information, user profile
information, etc. These information should be processed/filtered by a NWDAF
before sending the data to another NWDAF.
Thus, the privacy-sensitive information has to be protected (in accordance
with the regulatory requirements and the operator\'s policies) before being
transferred to any other NWDAF.
### 6.8.2 Solution details
To protect the sensitive and private information of the user, a privacy
framework is introduced By this, different privacy rules can be applied by
different operators/vendors based upon specific policies and requirements,
e.g. by local policy.
The privacy rules can be stored in the home network in
\- UDM/UDR if privacy is configured per subscriber, or
\- NRF if privacy is generic for all the subscribers of one or several NFs.
User privacy policies and rules can be retrieved from UDM. NRF can also push
this information to NFs.
Service requests related to User data need to be indicated, e.g. by an IE
\'DataPurposeID\'. The NF Service Consumer (i.e. requester NWDAF1 NF) needs to
send this \'DataPurposeID\' along with the request to the NF Service Producer
(e.g. NWDAF2). Based on this IE, the NWDAF2 will process privacy related data
accordingly to the specific policy or requirement valid in this operator
network, before sending a service response to the requester NWDAF1.
{width="6.697222222222222in" height="3.4618055555555554in"}
Figure 6.8.2-1: Generic Procedure to preserve user privacy based upon the
predefined policies
Step 0: If an operator configures the privacy rules in the NRF (generic for
all subscribers), then the NRF can push the policy/rules to NF in the response
of registration/heartbeat. A heartbeat message is sent by NFs every some
seconds (i.e. 10-20 seconds). Therefore whenever the privacy rule is changed
in the NRF, the NRF can push updated rules to the NFs.
Step 1: NWDAF1 sends a user data request to NWDAF 2 (Sending NWDAF Instance)
with an additional IE DataPurposeID indicating the purpose.
NOTE 1: DataPurposeID specifies the purpose of the user data request
corresponding to an analytics ID. For instance, the DataPurposeID can be
\'Advertisement\' corresponding to the user data request of analytics ID
\'location\'.
Step 2: NWDAF2 sends a request to retrieve the user privacy policies for a
specific subscriber from the UDM/UDR. Or it can use the locally configured
policies based upon the operator\'s or geographical requirements.
Step 3: UDM/UDR sends the privacy policies configured for the subscriber
either by the operator or by the user or based upon the privacy local policy
for a specific geographical region.
Note 2: Not addressed in the present document what is privacy local policy of
a specific geographical region.
Step 4: NWDAF2, after receiving the policies, applies them to the requested
user data for the DataPurposeID. For instance, because of the privacy policy
it can either reject the request completely or it sends the data without or
with anonymization. The latter preserves the sensitive information of the
user. Policies received in Step 0 are also applied along with policy received
in Step 3.
Note 3: Not addressed in the present document \"DataPurposeID\" in relation
with privacy.
Step 5: NWDAF2 sends the processed data to NWDAF1 as a response to the initial
request.
### 6.8.3 Evaluation
Not addressed in the present document.
## 6.9 Solution#9: Processing of tampered data
### 6.9.1 Introduction
This solution addresses key issue #1.2.
Consumer NFs request analytics from the analytics function. The analytics
function then requests the requested data from the data providers. These can
be any NF but can also be third party data resources).
While 3GPP provides sound security on network function level, the data used by
AI/ML is not being subject to these security controls so far. The attack
potential makes it necessary that a 5G analytics functions needs to be be
protected from processing unsanitized/tampered data received from different
resources (data providers).
Thus, to protect 5GS analytics functions from attacks on data level (i.e.
manipulated data to influence analytics result), a protection mechanisms is
required. This mechanism needs to be suited to protect different types of
analytics functions and input data.
### 6.9.1 Solution details
To protect 5G analytics function from attacks on data level, an additional
function (NF for Adversarial ML protection) is added to the analytics process
which will provide protection on data level. The analytics function therefore
sends, based on the request for analytics in step 1, the data request via the
NF for Adversarial ML protection (step 2), which forwards it to the data
provider (step 3).
The NF for Adv. ML protection is able to sanitize input data to filter
potentially malicious modifications. For this, a set of sanitation algorithms
are included in the function and an identifier is provided to indicate which
sanitation policy to use. The sanitation policy includes the type of data that
is expected and the type of sanitation that is required. The policies are pre-
configured by the operator.
Before the analytics function re-collects and processes the information from
the data provider, the NF for Adversarial ML protection pre-processes the
analytics data received in a reply from the data provider in step 4, i.e. it
provides sanitation to the collected data before forwarding it back to the
analytics function in step 5. The analytics function then processes the
sanitized data. After the analytics function has processed the data, it sends
the result to the consumer that requested the analytics.
The sanitization policies for instance may include the following parameters:
\- A sanitation policy identifier (SP ID) to differentiate and reference each
sanitation policy.
\- A request type (e.g. \"Analytics ID\" for NWDAF). The request type defines
the structure of the data that is expected to be received by the consumer or
the data which data provider sends to the consumer and also the usage of the
data during analytics.
\- (Optional) A flag that indicates whether the sanitized data is used for
learning or inference. The reason to differentiate between learning and
interference is that some sanitation algorithms, e.g. adversarial learning,
may not be suitable for inference. However, depending on the actual policies
configured, this flag may not be relevant.
NOTE: The actual sanitization policies and their implementation are
operator\'s specific and out of scope of 3GPP.
The detailed procedure is depicted in Figure 6.9.1-1:
Figure 6.9.1-1: Data sanitization to prevent adversarial attacks on the
analytics function
Pre-configuration: The sanitation polices are configured to the adversarial
machine learning protection/sanitation NF. These policies are typically
operator specific.
Step 1. Data consumer requests analytics service from any analytics function,
e.g. NWDAF.
Step 2. The analytics function determines which NF (or data provider) is
responsible for providing the required data for the analytics and sends a data
request to the NF responsible for data sanitization or Adversarial ML
protection.
Step 3. The Data Sanitation NF forwards the data request to the data provider
and subscribe to the respective data.
Step 4. The data provider then sends the data to the Data Sanitation NF. This
data may contain perturbations aimed at attacking the analytics function.
Step 5. The sanitization NF receives the data, identifies the sanitization
policy, and then processes the data according the policy defined. The NF then
sends this data to the analytics function.
Step 6. The analytics function sends the subscribed analytics to the NF
Service Consumer using the sanitized data.
### 6.9.2 Evaluation
The proposed solution satisfies the stated security requirements of key issue
#1.2.
If a new NF is introduced, the new interfaces with it would extend the attack
surface.
## 6.10 Solution #10: Authorization of NF Service Consumers for data access
via DCCF
### 6.10.1 Introduction
This solution addresses KI# 1.3, specially the following threats:
\- Based on a request from a DCCF, the Messaging Framework may provide data
from a producer to a requesting data consumer, even though the consumer is not
authorized to receive this data. A DCCF could subscribe for data from the data
source on behalf of data consumer without the data consumer authorizing DCCF
to do so.
\- A DCCF could subscribe for data from the data source on behalf of data
consumer without the data consumer authorizing DCCF to do so.
\- The data producer may be unable to correctly verify the identity of the
data consumer since the data request is coming from DCCF on behalf of the
consumer.
### 6.10.2 Solution details
#### 6.10.2.0 General
NF Service consumer (for instance NWDAF) accesses the services of DCCF using
the existing SBI mechanisms.
Similarly, DCCF accesses the services of MFAF (if the notification is sent via
MFAF) using the existing SBI mechanisms.
The service request to access the DCCF by NF Service Consumer also contains
the Client Credentials Assertion (CCA) token (CCA_NWDAF) as described in TS
33.501. DCCF now further requests the NRF to provide an access token to access
services on behalf of the NF Service Consumer. The access token request to
access a service from a service producer (i.e. data producer) by DCCF or MFAF,
also contains the NF Service consumer information, therefore, enabling NRF to
authorize both DCCF, NF Service Consumer and MFAF (if notification is sent via
MFAF). The NRF also adds the NF service consumer information to the claims of
the access token sent to DCCF to request data from the data producer.
The NRF is also able to verify if the NF Service Consumer has authorized DCCF
to access services on its behalf by verifying the CCA_NWDAF and whether its
audience claims match the DCCF.
The service producer (i.e. the data producer) when receiving the service
request by DCCF is therefore able to verify the actual NF service consumer,
since it is part of the access token claims sent along with the request by the
DCCF, and the service producer is able to verify if the NF service consumer
has authorized DCCF to access services on its behalf or not. Finally, NF
Service Producer is also able to verify if MFAF (if the notification is sent
via MFAF) is authorized to receive the notification data. Only after this
successful verification, the NF Service Producer sends the notification to the
NF Service Consumer via DCCF or MFAF.
#### 6.10.2.1 Authorization of NF Service Consumer (i.e. Data consumer) when
notification sent via DCCF
The detailed procedure for NF Service Consumer to receive data from Service
Producers via DCCF is depicted in Figure 6.10.2-1:
Figure 6.10.2-1: Service Consumer Authorization to receive data from Service
Producers via DCCF
1\. An NF service consumer (e.g. NWDAF) discovers a DCCF to retrieve data. The
NF Service consumer requests authorization from an NRF by invoking
Nnrf_AccessToken_Get request including the information to identify the target
NF (DCCF) and the source NF (NWDAF).
2\. The NRF verifies the information provided by the NF Service Consumer and
generates an access token as described in TS 33.501.
3\. The access token (access_token_nwdaf) is provided to the NF service
consumer.
4\. The NF Service Consumer initiates an NF service request to the DCCF which
includes the access_token_nwdaf. The NF Service Consumer also generates a
Client Credentials Assertion (CCA) token (CCA_NWDAF) as described in TS 33.501
and includes it in the request message in order to authenticate itself towards
the NF Service Producers.
5\. The DCCF verifies that the access_token_nwdaf is valid and executes the
service.
6\. The DCCF determines the NF Service Producer(s) from where the data is to
be collected.
NOTE 1: If the NF Service Consumer sends the info of NF Service Producer (i.e.
NF Service Producer type and Instance ID) along with the service request in
Step 4, then DCCF does not determine the NF Service Producer, but requests an
access token from the NRF using the NF Producer details sent by the NF Service
Consumer (as described in Step 7.)
7\. The DCCF requests authorization from the NRF by invoking an
Nnrf_AccessToken_Get request including the information to identify the target
NF (NF Service Producer), the source NF (DCCF, NF Service Consumer i.e.,
NWDAF) and the CCA_NWDAF provided by the NF Service Consumer.
8\. The NRF determines whether the DCCF and the NF Service Consumer (e.g.
NWDAF) are allowed to access the service provided by the identified NF Service
Producers. The NRF also verifies if the NF Service Consumer has authorized the
DCCF to request an access token on its behalf by verifying the audience
included in its CCA.
9\. The NRF after successful verification generates and provides an access
token to the DCCF as described in TS 33.501, with additional access token
claims, such that the subject of the access token claims maps to DCCF and NF
Service Consumer (e.g. NWDAF).
10\. The DCCF uses the access token to initiate an NF service to the
identified NF Service Producer to subscribe to the data. The request also
consists of CCA_NWDAF, so that the NF Service Producer(s) can authenticate the
NF Service Consumer (e.g. NWDAF) and can also implicitly ensure that the NF
service consumer has authorized DCCF to access services on its behalf.
11\. The NF Service Producer(s) authenticate the NF Service Consumer and
verify the access token as specified in TS 33.501. NF Service Producer(s)
execute the service after successful verification.
12\. The NF Service Producer(s) provide requested data to the DCCF.
13\. The DCCF forwards the received data to the data consumer(s).
NOTE 2: In the case a new data consumer comes at a later stage to request the
data which is already being collected by DCCF, steps 1-10 apply. When the
request is received by the NF Service Producer (i.e. the data producer), it
authenticates the NF Service Consumer and verifies the access token provided
along with the service request, and sends to DCCF the access token
verification response. DCCF based upon the response received, either updates
the subscription info to include the new data consumer as well and sends the
data to both the consumers, or in the case of access token verification
failure, the DCCF rejects the request received by the data consumer.
#### 6.10.2.2 Authorization of NF Service Consumer (i.e. Data consumer) when
notification sent via MFAF
The detailed procedure for NF Service Consumer to receive data from Service
Producers via MFAF is depicted in Figure 6.10.2-2:
Figure 6.10.2-2: Service Consumer Authorization to receive data from Service
Producers via MFAF
1\. An NF service consumer (e.g. NWDAF) discovers a DCCF to retrieve data. The
NF Service consumer requests authorization from an NRF by invoking
Nnrf_AccessToken_Get request including the information to identify the target
NF (DCCF) and the source NF (NWDAF).
2\. The NRF verifies the information provided by the NF Service Consumer and
generates an access token as described in TS 33.501.
3\. The access token (access_token_nwdaf) is provided to the NF service
consumer.
4\. The NF Service Consumer initiates an NF service request to the DCCF which
includes the access_token_nwdaf. The NF Service Consumer also generates a
Client Credentials Assertion (CCA) token (CCA_NWDAF) as described in TS 33.501
and includes it in the request message in order to authenticate itself towards
the NF Service Producers.
5\. The DCCF verifies that the access_token_nwdaf is valid and executes the
service.
6\. If the NF Service consumer does not send the NF Service Producer info in
Step 4., the DCCF determines the NF Service Producer(s) from where the data is
to be collected.
7\. If the data collection and coordination is happening via MFAF, the DCCF
requests authorization from the NRF by invoking an Nnrf_AccessToken_Get
request including the information to identify the target NF (NF Service
Producer), the source NF (DCCF, NF Service Consumer i.e. NWDAF) and the
CCA_nwdaf provided by the NF Service Consumer.
8\. The NRF determines whether the DCCF and the NF Service Consumer (e.g.
NWDAF) are allowed to access the service provided by the identified NF Service
Producers. The NRF also verifies if the NF Service Consumer has authorized the
DCCF to request an access token on its behalf by verifying the audience
included in its CCA.
9\. The NRF after successful verification generates and provides an access
token to the DCCF as described in TS 33.501, with additional access token
claims, such that the subject of the access token claims maps to DCCF, NF
Service Consumer (e.g. NWDAF).
10, 11. DCCF then requests NRF to obtain an access token to consume the
services of MFAF in order to send configuration request to MFAF. The NRF after
verifying provides an access token (access_token_dccf) as a response.
12\. DCCF then sends a configuration request as specified in TS 23.288 clause
6.2.6.3.4 to MFAF (along with access_token_dccf). The MFAF then verifies the
access_token_dccf and in case of successful verification, services the
request.
NOTE 1: MFAF, when receiving the request from DCCF to configure the
notification address, needs to verify the that NF Service Consumer in fact
initiates the data request and the received configuration.
13\. The DCCF uses the access_token_nwdaf to initiate an NF service to the
identified NF Service Producer to subscribe to the data. The request also
consists of CCA_nwdaf, so that the NF Service Producer can authentication the
NF Service Consumer (i.e. NWDAF) and also implicitly ensure that NF service
consumer has authorized DCCF to access services on its behalf.
14\. The NF Service Producer(s) authenticate the NF Service Consumer and
verify the access token as specified in TS 33.501. NF Service Producer(s)
execute the service after successful verification.
15\. The NF Service Producer(s) provide requested data to MFAF as
notification.
16\. The MFAF then forwards the provided data to the NF Service Consumer as a
notification.
NOTE 2: In case a new data consumer comes at a later stage to request the
data, which is already being collected by DCCF or MFAF, steps 1-9 apply. When
the request is received by the NF Service Producer (i.e. the data producer),
it authenticates the NF Service Consumer and verifies the access token
provided along with the service request and sends to DCCF the access token
verification response. DCCF based upon the response received, either updates
the subscription info at the MFAF to include the new data consumer as well and
instructs MFAF to send the data to both the consumers, or in the case of
access token verification failure, the DCCF rejects the request received by
the data consumer.
### 6.10.3 Evaluation
The solution proposes authorization mechanisms in order to authorize a data
consumer to request a service of data producer, and to authorize DCCF and MFAF
to request service on behalf of the data consumer.
The solution reuses existing mechanisms of CCA and OAuth 2.0 as defined in TS
33.501, with the enhancements in the access token request sent by the NF
Service Consumer and the claims generated by the NRF, and provides protection
against the following threats:
1\. Based on a request from a DCCF, the Messaging Framework may provide data
from a producer to a requesting data consumer, even though the consumer is not
authorized to receive this data.
2\. A DCCF could subscribe for data from the data source on behalf of the data
consumer without the data consumer authorizing DCCF to do so.
3\. The data producer may be unable to correctly verify the identity of the
data consumer since the data request is coming from DCCF on behalf of the
consumer.
The solution fulfills the following requirements of the KI 1.3:
1\. The data consumer sis authorized to access the data from the data source.
2\. Authorization of the DCCF is supported to access a service of a data
source on behalf of a data consumer.
## 6.11 Solution #11: Authorization of NF Service Consumers to access data
from ADRF via DCCF
### 6.11.1 Introduction
This solution addresses KI #1.3, specially the following threats:
\- Based on a request from a DCCF, data received from a data producer is
stored in the DRF. When the data are later retrieved, the DCCF may provide the
stored data to a non-authorized consumer if requested.
### 6.11.2 Solution details
NF Service consumer (e.g. NWDAF) accesses the services of DCCF using the
existing SBI mechanisms. NF Service Producer (or Data producer) when sending
the data to the NF Service Consumer, may also send the data to ADRF for
storage and archiving if requested/subscribed to by ADRF (e.g. based on a
requested by the NF Service Consumer or the DCCF). Alternatively, the
Messaging Framework may be configured by DCCF to forward a copy of the data to
ADRF.
The NF Service Producer (Data Producer), when sending the data to the ADRF
also appends its own NF type and its own NF Instance ID as metadata to the
data which is sent for archiving. If NF Service Producer does not add this
metadata, then DCCF may add this information before sending it to the ADRF.
The access token get request sent from DCCF to NRF to request the desired data
on behalf of the NF Service Consumer contains the following information: NF
Instance IDs of the NF Service Consumer (e.g. NWDAF) and the DCCF, NF Type (or
NF Instance ID) of the NF Service Producers (i.e. ADRF and the Data Producer).
NRF after verifying the request, authorizes the NF Service Consumer to request
the data and adds in the access token claims the NF Type (or the NF Instance
ID) of the NF Service Producers (i.e. the ADRF and the Data Producer).
The ADRF when receiving the request from DCCF (based on a request from the NF
Service Consumer) verifies the access token generated by ensuring that the NF
Type (or NF Instance ID) matches that of ADRF, and the NF Type (or NF Instance
ID) of the Data Producer matches the metadata information that was earlier
appended by the Data Producer (or DCCF or MFAF) when archiving the data. Only
after a successful verification, ADRF sends the data to the NF Service
Consumer via DCCF (or MFAF).
The detailed procedures are depicted in Figure 6.11.2-1 (without MFAF) and
Figure 6.Y.2-2 (with MFAF).
**Procedure 1: Service Consumer Authorization to receive data from ADRF via
DCCF (without MFAF)**
Figure 6.11.2-1: Service Consumer Authorization to receive data from ADRF via
DCCF(without MFAF)
Step 0. ADRF subscribes/requests data from data producer (directly or via
DCCF).
Step 1. NF Service Producer (data producer) sends the data to ADRF (directly
or via DCCF) and may add metadata information containing Source NF Type as its
own NF Type and Source NF Instance ID as its own Instance ID.
Step 2. If, in step 1, the data is sent via DCCF and the data producer did not
add its metadata, then DCCF when forwarding the data to ADRF, adds the
metadata related to the data producer (i.e. NF type and NF Instance ID) prior
to sending the data to ADRF for storage.
NOTE 1: Steps 1-2 ensure that the NF Service Producer information from which
the data was collected is present in the ADRF. If the information is already
present, Steps 1-2 are not needed, and the procedure defined in Clause
6.2.6.3.3 in TS 23.288 is followed.
Step 3. NF Service consumer (data consumer) sends request to DCCF to get
historical data (as specified in clause 6.2.6.3.3, TS 23.288 [4]) with
optionally also providing the NF Type (or NF Instance ID) of the target NF
Service Producer (or data producer). The request also contains the access
token to request services from DCCF and CCA of NF Service Consumer.
Step 4. DCCF, after verifying that the NF Service Consumer is authorized to
access the services of DCCF, sends to NRF an access token request to collect
historical data from data producer(s) including the information to identify
the target NFs (NF Service Producer (i.e. ADRF) and data producer), the source
NF (DCCF, NF Service Consumer) and the CCA provided by the NF Service Consumer
NOTE 2: Both ADRF and data producer info is needed in the access token request
as target NFs, since DCCF is consuming ADRF services, and the data producer
audience claim is required for the ADRF to verify if the data consumer and
DCCF are authorized to receive the data belonging to a data producer,
Step 5. The NRF determines whether the DCCF and the NF Service Consumer are
allowed to access the services provided by the identified NF Service
Producers(s). The NRF also verifies if the NF Service Consumer has authorized
the DCCF to request an access token on its behalf by verifying the audience
included in its CCA. NRF, after verification, provides an access token
containing ADRF NF Type (or NF Instance ID) and data producer NF Type (or NF
Instance ID(s)) in the audience claims of the access token and the NF Service
Consumer (i.e. the data consumer) and the DCCF in the subject claim of the
access token.
Step 6. DCCF forwards the historical data request to ADRF along with the
access token received.
Step 7. ADRF now authenticates the NF Service Consumer via the CCA provided
and performs two verifications. First, it verifies the access token as
mentioned in the TS 33.501 [8], ADRF then also verifies if the metadata info
of the requested data (e.g. Source NF type (or NF Instance ID)) matches the
claims info of the access token.
Step 8. ADRF sends the data to NF consumer via DCCF in case of successful
verification.
**Procedure 2: Service Consumer Authorization to receive data from ADRF via
DCCF (with MFAF)**
Figure 6.11.2-2: Service Consumer Authorization to receive data from ADRF via
DCCF (with MFAF)
> Step 0. ADRF subscribes/requests data from Data Producer (directly or via
> DCCF). If DCCF is involved, DCCF configures MFAF to forward the data to the
> ADRF and to add metadata information containing Source NF Type as the NF
> Type of the Data Producer and source NF Instance ID as NF Instance ID of the
> data producer (if the data producer does not append this metadata
> information).
>
> Step 1. NF Service Producer (data producer) sends the data to ADRF (directly
> or via DCCF) and may add metadata information containing Source NF Type as
> its own NF Type and Source NF Instance ID as its own Instance ID.
>
> Step 2. If the data producer did not add its metadata, then MFAF when
> forwarding the data to ADRF, adds the metadata related to the data producer
> (i.e. NF type and NF Instance ID) (as instructed by the DCCF in step 0)
> prior to sending the data to ADRF for storage.
NOTE 1: Steps 1-2 ensure that the NF Service Producer information from which
the data was collected is present in the ADRF. If the information is already
present, Steps 1-2 are not needed, and the procedure defined in Clause
6.2.6.3.3 in TS 23.288 [4] is followed.
> Step 3. NF Service consumer (data consumer) sends request to DCCF to get
> historical data (as specified in clause 6.2.6.3.3, TS 23.288) with
> optionally also providing the NF Type (or NF Instance ID) of the target NF
> Service Producer (or data producer). The request also contains the access
> token to request services from DCCF and CCA of NF Service Consumer.
>
> Step 4. DCCF, after verifying that the NF Service Consumer is authorized to
> access the services of DCCF, sends to NRF an access token request to collect
> historical data from data producer(s) including the information to identify
> the target NFs (NF Service Producer (i.e. ADRF) and data producer), the
> source NF (DCCF, NF Service Consumer) and the CCA provided by the NF Service
> Consumer
>
> Step 5. NRF, after verification, provides an access token containing ADRF NF
> Type (or NF Instance ID) and data producer NF Type (or NF Instance ID(s)) in
> the audience claims of the access token.
>
> Step 6a/6b. DCCF forwards the historical data request to ADRF along with the
> access token received. DCCF also configures the MFAF to forward the data to
> the data consumer
NOTE: For communication between DCCF and MFAF, authorization token for
enabling DCCF to access services of MFAF will also be included
> Step 7. ADRF now performs two verifications. First, it checks if an audience
> claim is matching its own NF type (or NF Instance ID). Second, ADRF verifies
> if the Source NF type (or NF Instance ID) present in the metadata of the
> requested data matches an audience claim an of the access token.
>
> Step 8. ADRF sends the data to NF consumer via MFAF in case of successful
> verification.
### 6.11.3 Evaluation
The solution proposes authorization mechanisms in order to authorize a data
consumer to request a service of data producer via DCCF, and to authorize DCCF
and MFAF to request services on behalf of the data consumer. Further, the
solution proposes mechanisms to enable ADRF to verify is a NF Service Consumer
is authorized to access and receive the data which is already collected from
the NF Service Producer and stored in the ADRF.
The solution uses existing mechanisms of CCA and OAuth 2.0 as defined in TS
33.501, with the enhancements in the access token request sent by the NF
Service Consumer and the claims generated by the NRF, and provides protection
against the following threats:
1\. Based on a request from a DCCF, the Messaging Framework may provide data
from a producer to a requesting data consumer, even though the consumer is not
authorized to receive this data.
2\. Based on a request from a DCCF data received from a data producer is
stored in the ADRF. When the data are later retrieved, the DCCF may provide
the stored data to a non-authorized consumer if requested.
3\. A DCCF could subscribe for data from the data source on behalf of the data
consumer without the data consumer authorizing DCCF to do so.
The solution fulfills the following requirements of the KI 1.3:
1\. The data consumer is authorized to access the data from the data source.
2\. Authorization of the DCCFis supported to access a service of a data source
on behalf of a data consumer.
## 6.12 Solution #12: Solution on Authorization of Data Consumers for data
access via DCCF
### 6.12.1 Introduction
This solution addresses KI#1.3 on Authorization of data consumers for data
access via DCCF.
Based on a request from a DCCF, data producer sends data to a requesting data
consumer, even though the data consumer is not authorized to receive this
data. This solution addresses the unauthorized data consumer issue in the case
that DCCF is used to coordinate the data collection.
### 6.12.2 Solution details
The data consumer requests authorization from the NRF to invoke services of a
DCCF and a data producer. After data consumer requests a token for the DCCF
service request, the consumer requests another token for data collection
request.
The NRF determines if the data consumer is authorized to use the service of
the DCCF and the NRF sends a token for DDCF service. The NRF then determines
if the data consumer is authorized to collect the requested data from the data
producer, and then the NRF provides another access token to the data consumer.
The data consumer uses these tokens for the service requests to the DCFF and
data producer. The DCCF executes the service by verifying the token for DCCF
service. Then the DCCF sends the data request by the token for data collection
to the data producer. The data producer executes the service by verifying the
token and sends the data to the data consumer via DCCF.
It is assumed that data consumer knows the data producer in advance.
The solution is shown in detail below:
Figure 6.12.2-1: Authorization of data consumer for services of DCCF and data
producer
1\. The data consumer requests a token from the NRF for the DCCF service.
2\. The NRF checks if the data consumer is allowed to access DCCF. If the
check was successful, NRF generates the token. The access token that the
consumer receives from the NRF contains the information that the consumer is
authorized to invoke DCCF services.
3\. The NRF sends the token for the DCCF service to the data consumer.
4\. The data consumer requests a token from the NRF for the data collection
requests from the target data producer if possible. In the token request, the
data consumer includes, besides the existing token request parameters, the
following additional parameters: the data that the data consumer wants to
collect, information about the data producer that is available to the data
consumer, e.g., name of the data producer service or data producer NF instance
ID if available to the data consumer.
5\. The NRF checks if the data consumer is allowed to consume the data. If the
check was successful, NRF generates the token. The access token that the
consumer receives from the NRF contains the information that which data the
consumer is allowed to retrieve. Besides the existing parameters, the token
contains the following additional information: the data that the data consumer
wants to collect, both the data producer NF ID (if there exists) and the name
of the data producer service.
6\. The NRF sends the token for data collection to the data consumer.
7\. The consumer sends the received token for the DCCF service to the DCCF.
This request also includes the access token for data collection.
8\. The DCCF verifies the token and checks the authorization result. If the
consumer is allowed to get services from the DCCF and collect data, then the
DCCF coordinates the data collection request.
8a. DCCF requests an access token for itself from the NRF to get the service
from data producer. NRF provides an access token for the service of data
producer to the DCCF.
9\. The DCCF sends the request to the data producer to retrieve the service.
This request includes the access token received by DCCF in step 8a and the
access token for data collection, ensuring the data consumer is authorized to
consume this data.
10\. The data producer verifies the access token, checks the tokens from the
data consumer and execute the service.
11\. The data producer provides requested data to the DCCF.
12\. The DCCF forwards the provided data to the data consumer.
NOTE: In the case that a second Data Consumer comes a later stage for the same
type of data, steps 1-12 are applied.
### 6.12.3 Evaluation
Not addressed in the present document.
## 6.13 Solution #13: Solution for UE data collection protection at NF/NWDAF
### 6.13.1 Introduction
This solution solves the key issue #1.5, UE data collection at NF/NWDAF.
There are 5 security requirements in key issue #1.5, namely:
\- R1: UE and network shall mutually authenticate each other.
\- R2: The communication between UE and network shall be confidentiality
protected.
\- R3: The data collected from UE shall be integrity protected.
\- R4: Data transferred from UE to NFs and from NFs to the analytics function
shall be protected against replay attacks.
\- R5: Authorization of NFs and analytics functions to receive, send, or
transfer UE related data shall be guaranteed.
This solution re-uses existing security mechanism to solve all these security
requirements.
### 6.13.2 Solution details
Existing security mechanism to solve each of the above security requirement is
explained below.
\- R1: UE and network shall mutually authenticate each other.
Existing primary authentication in TS 33.501[8] is used to authenticate UE and
network.
\- R2: The communication between UE and network shall be confidentiality
protected.
Existing AS and NAS security mechanism in TS 33.501 [8] is used to provide the
required confidentiality.
\- R3: The data collected from UE shall be integrity protected.
Existing AS and NAS security mechanism in TS 33.501 [8] is used to provide the
required integrity.
\- R4: Data transferred from UE to NFs and from NFs to the analytics function
shall be protected against replay attacks.
Existing AS and NAS security mechanism in TS 33.501 [8] is used to provide the
required protection against replay attacks between the communication from UE
and NFs in the network.
For the communication between two NFs in the network, replay attack prevention
is provided by security in transport layer (e.g. via TLS) and application
layer (via HTTPS).
\- R5: Authorization of NFs and analytics functions to receive, send, or
transfer UE related data shall be guaranteed.
Current authorization for SBA is re-used to provide the authorization of NFs
and NWDAF to request data.
NOTE: The security of data transfer involving messaging framework and DCCF is
studied in other key issues.
### 6.13.3 System impact
There is no system impact.
### 6.13.4 Evaluation
The solution fulfils the requirement of key issue #1.5.
This solution reuses the existing 5GS security mechanisms, including the
primary authentication mechanism, NAS and AS security mechanism, SBA security
mechanism to solve the security problems of UE data collection.
This solution provides mutual authentication, confidentiality, integrity and
replay protection between UE and network and provides authorization and replay
protection between NFs as described in TS 33.501 [8].
## 6.14 Solution #14: Solution to ML restrictive transfer
### 6.14.1 Introduction
This contribution proposes a solution to key issue #3.3, Ensuring restrictive
transfer of ML models between authorized NWDAF instances.
This solution leverages existing SBA authorization to fulfil the requirement,
i.e. \"only authorized NWDAF instances should be allowed to consume ML models
from other NWDAF instances.\"
### 6.14.2 Solution details
The solution is predicated on that NDWAFs instances that are allowed to share
the ML models are placed in the same set. The existing SBA authorization
mechanism is then re-used.
**Access Token Request**
When a service consumer NWDAF requests a token from NRF to access the service
from an expected service provider NWDAF for ML provisioning or subscription,
the NRF includes in the access token the NF Set ID of the expected service
provider NWDAF, as specified in clause 13.4.1.1 of TS 33.501 [8].
**Service Request**
When the service consumer NWDAF request to access the service for ML
provisioning or subscription from the service provider NWDAF, the service
consumer sends, among others, the access token obtained from NRF which
includes the NF Set ID of the expected service provider NWDAF.
The service provider NWDAF then checks that the NF Set ID in the access token
matches its own NF Set ID, as specified in clause 13.4.1.1 of TS 33.501 [8].
If the check fails, then the service consumer NWDAF is denied of the requested
service.
### 6.14.3 System impact
There is no system impact.
### 6.14.4 Evaluation
This solution requires that NWDAF instances that are allowed to share ML
models are placed in the same NF set.
The solution fulfils the security requirement of the key issue #3.3.
## 6.15 Solution #15: Protection of data sent via MFAF using existing SBA
mechanisms
### 6.15.1 Introduction
This solution addresses KI 1.4 on security and protection of data via
Messaging Framework
### 6.15.2 Solution details
In TS 23.288 [4] Clause 5A.3.2, Messaging Framework Adaptor NF (MFAF) has been
defined which offers 3GPP defined services that allow the 5GS to interact with
the Messaging Framework. Furthermore, MFAF receives the data from Data source
and sends the data to the Data Consumer via 3GPP defined services.
According to TS 33.501 [8] clause 13.3.0 all network functions supports
mutually authenticated TLS and HTTPS. TLS is used for transport protection
within a PLMN, and thus ensuring communication between NFs is integrity,
confidentiality and replay protected. Since the services defined to access the
MFAF and to send data to MFAF and receive data from MFAF are 3GPP defined
services, they adhere to the authorization mechanisms defined for SBA.
Therefore, the existing TLS and HTTPS protection and the authorization
mechanisms defined for SBA are applicable for protection of data sent via
MFAF.
### 6.15.3 Evaluation
The solution proposes the security of data via Messaging Framework and MFAF by
reusing the existing security mechanism defined for SBA in TS 33.501 Clause
13.
# 7 Conclusions
## 7.1 Conclusions on Key Issue #1.1
Solution #6 is recommended as baseline for integrity protection of data
transferred between AF and NWDAF.
## 7.2 Conclusions on Key Issue #1.2
No normative work needed since there is no valid solution for key issue #1.2.
## 7.3 Conclusions on Key Issue #1.3
Solution #10 is recommended as baseline for the normative work for KI 1.3.
Note: \'Whether an additional solution is necessary for the case that the data
consumer knows the data producer instance in advance is not addressed in the
present document.
## 7.4 Conclusions on Key Issue #1.4
This contribution proposes to use Solution #15 (Protection of data sent via
MFAF using existing SBA mechanisms) as the normative basis for key issue #1.4
(security protection of data via Messaging Framework. The Solution #15
proposes to re-use existing SBA security mechanism and it satisfies the
security requirements of key issue #1.4.
## 7.5 Conclusions on Key Issue #1.5
It is recommended to use solution #1 and #13 as baseline of KI#1.5.
There is no extra normative work to do for KI#1.5.
## 7.6 Conclusions on Key Issue #2.1
There is no normative work needed for key issue #2.1.
## 7.7 Conclusions on Key Issue #2.2
Since standardizing NF abnormal behaviour and the exact inputs requires more
time to study, therefore no normative work is considered for KI #2.2 for this
release.
## 7.8 Conclusions on Key Issue #3.1
There is no normative work needed for key issue #3.1.
## 7.9 Conclusions on Key Issue #3.2
Solution #3 is recommended as baseline for the protection of UE data in
transit.
## 7.10 Conclusions on Key Issue #3.3
There is no normative work needed for key issue #3.3.
#