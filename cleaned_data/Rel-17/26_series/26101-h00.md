# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes a generic frame format for the Adaptive Multi-
Rate (AMR) speech codec and the Enhanced Full Rate (GSM-EFR) speech codec.
This format shall be used as a common reference point when interfacing speech
frames between different elements of the 3G system and between different
systems. Appropriate mappings to and from this generic frame format will be
used within and between each system element.
Annex A describes a second frame format which shall be used when octet
alignment of AMR frames is required.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] TS 26.090: \"AMR Speech Codec; Speech Transcoding Functions\".
[2] TS 26.093: \"AMR Speech Codec; Source Controlled Rate Operation\".
[3] TS 26.092: \"AMR Speech Codec; Comfort Noise Aspects\".
[4] TS 46.060: \"EFR Speech Codec; Speech Transcoding Functions\".
[5] TS 46.062: \"EFR Speech Codec; Comfort Noise Aspects\".
# 3 Definitions and Abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply:
**AMR mode:** one of the eight AMR codec bit-rates denoted also with indices 0
to 7 where 0 maps to the 4.75 kbis/s mode and 7 maps to the 12.2 kbit/s mode.
**AMR codec mode:** same as AMR mode.
**RX_TYPE:** classification of the received frame as defined in [2].
**TX_TYPE:** classification of the transmitted frame as defined in [2].
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
CRC Cyclic Redundancy Check
FQI Frame Quality Indicator
GSM Global System for Mobile communication
LSB Least Significant Bit
MSB Most Significant Bit
RX Receive
PDC Personal Digital Communication (ARIB standard)
SCR Source Controlled Rate operation
SID Silence Descriptor (Comfort Noise Frame)
TDMA Time Division Multiple Access (IS-641)
TX Transmit
# 4 AMR codec frame format (AMR IF1)
This clause describes the generic frame format for both the speech and comfort
noise frames of the AMR speech codec. This format is referred to as AMR
Interface Format 1 (AMR IF1). Annex A describes AMR Interface Format 2 (AMR
IF2).
Each AMR codec mode follows the generic frame structure depicted in figure 1.
The frame is divided into three parts: AMR Header, AMR Auxiliary Information,
and AMR Core Frame. The AMR Header part includes the Frame Type and the Frame
Quality Indicator fields. The AMR auxiliary information part includes the Mode
Indication, Mode Request, and Codec CRC fields. The AMR Core Frame part
consists of the speech parameter bits or, in case of a comfort noise frame,
the comfort noise parameter bits. In case of a comfort noise frame, the
comfort noise parameters replace Class A bits of AMR Core Frame while Class B
and C bits are omitted.
{width="4.727777777777778in" height="2.2916666666666665in"}
Figure 1: Generic AMR frame structure
## 4.1 AMR Header and AMR Auxiliary Information
This subclause describes the AMR Header of figure 1.
### 4.1.1 Frame Type, Mode Indication, and Mode Request
Table 1a defines the 4-bit Frame Type field. Frame Type can indicate the use
of one of the eight AMR codec modes, one of four different comfort noise
frames, or an empty frame. In addition, three Frame Type Indices are reserved
for future use. The same table is reused for the Mode Indication and Mode
Request fields which are 3-bit fields each and are defined only in the range
0...7 to specify one of the eight AMR codec modes.
Table 1a: Interpretation of Frame Type,\ Mode Indication and Mode Request
fields
* * *
Frame Type Mode Indication Mode Request Frame content (AMR mode, comfort
noise, or other) 0 0 0 AMR 4,75 kbit/s 1 1 1 AMR 5,15 kbit/s 2 2 2 AMR 5,90
kbit/s 3 3 3 AMR 6,70 kbit/s (PDC-EFR) 4 4 4 AMR 7,40 kbit/s (TDMA-EFR) 5 5 5
AMR 7,95 kbit/s 6 6 6 AMR 10,2 kbit/s 7 7 7 AMR 12,2 kbit/s (GSM-EFR) 8 - -
AMR SID 9 - - GSM-EFR SID 10 - - TDMA-EFR SID 11 - - PDC-EFR SID 12-14 - - For
future use 15 - - No Data (No transmission/No reception)
* * *
### 4.1.2 Frame Quality Indicator
The content of the Frame Quality Indicator field is defined in Table 1b. The
field length is one bit. The Frame Quality Indicator indicates whether the
data in the frame contains errors.
Table 1b: Definition of Frame Quality Indicator
+-------------------------------+-------------------------------------+ | Frame Quality Indicator (FQI) | Quality of data | +-------------------------------+-------------------------------------+ | 0 | Bad frame or Corrupted frame | | | | | | (bits may be used to assist error | | | concealment) | +-------------------------------+-------------------------------------+ | 1 | Good frame | +-------------------------------+-------------------------------------+
### 4.1.3 Mapping to TX_TYPE and RX_TYPE
Table 1c shows how the AMR Header data (FQI and Frame Type) maps to the
TX_TYPE and RX_TYPE frames defined in [2].
Table 1c: Mapping of Frame Quality Indicator and Frame Type to\ TX_TYPE and
RX_TYPE [2], respectively
* * *
Frame Quality Indicator Frame Type Index TX_TYPE or\ Comment RX_TYPE
1 0-7 SPEECH_GOOD The specific Frame Type Index depends on the bit-rate being
used.
0 0-7 SPEECH_BAD The specific Frame Type Index depends on the bit-rate being
used. The corrupted data may be used to assist error concealment.
1 8\ SID_FIRST or\ For AMR: SID_FIRST and SID_UPDATE\ 8 SID_UPDATE are
differentiated using one Class A bit: STI.
0 8 SID_BAD For AMR
1 9 GSM-EFR SID For GSM-EFR
0 9 GSM-EFR SID_BAD For GSM-EFR
1 10-11 SID_UPDATE For TDMA-EFR and PDC-EFR
0 10-11 SID_BAD For TDMA-EFR and PDC-EFR
1 15 NO_DATA Typically a non-transmitted frame or an erased or stolen frame
with no data usable to assist error concealment.
* * *
### 4.1.4 Codec CRC
Generic AMR codec frames with Frame Type 0.11 are associated with an 8-bit CRC
for error-detection purposes. The Codec CRC field of AMR Auxiliary Information
in figure 1 contains the value of this CRC. These eight parity bits are
generated by the cyclic generator polynomial:
\- G(x)=D^8^ + D^6^ + D^5^ + D^4^ + 1
which is computed over all Class A bits of AMR Core Frame. Class A bits for
Frame Types 0.7 are defined in subclause 4.2.2 (for speech bits) and for Frame
Types 8.11 in subclause 4.2.3 (for comfort noise bits).
When Frame Type Index of table 1a is 15 the CRC field is not included in the
Generic AMR frame.
## 4.2 AMR Core Frame
This subclause contains the description of AMR Core Frame of figure 1. The
descriptions for AMR Core Frame with speech bits and with comfort noise bit
are given separately.
### 4.2.1 AMR Core Frame with speech bits: Bit ordering
This subclause describes how AMR Core Frame carries the coded speech data. The
bits produced by the speech encoder are denoted as
{_s_(1),_s_(2),...,_s_(_K_)}, where _K_ refers to the number of bits produced
by the speech encoder as shown in table 2. The notation _s_(_i_) follows that
of [1]. The speech encoder output bits are ordered according to their
subjective importance. This bit ordering can be utilized for error protection
purposes when the speech data is, for example, carried over a radio interface.
Tables B.1 to B.8 in Annex B define the AMR IF1 bit ordering for all the eight
AMR codec modes. In these tables the speech bits are numbered in the order
they are produced by the corresponding speech encoder as described in the
relevant tables of TS 26.090 [1]. The reordered bits are denoted below, in the
order of decreasing importance, as {_d_(0),_d_(1),...,_d_(_K-1_)}.
The ordering algorithm is described in pseudo code as:
\- for _j_ = 0 to _K_ -1
\- _d_(_j_) := _s_(_table~m~_(_j_)+1);
where _table~m~_(_j_) refers to the relevant table in Annex B depending on the
AMR mode _m_ =0..7. The Annex B tables should be read line by line from left
to right. The first element of the table has the index 0.
### 4.2.2 AMR Core Frame with speech bits: Class division
The reordered bits are further divided into three indicative classes according
to their subjective importance. This class division is only informative and
provides supporting information for mapping this generic format into specific
formats. The three different importance classes can then be subject to
different error protection in the network.
The importance classes are Class A, Class B, and Class C. Class A contains the
bits most sensitive to errors and any error in these bits typically results in
a corrupted speech frame which should not be decoded without applying
appropriate error concealment. This class is protected by the Codec CRC in AMR
Auxiliary Information. Classes B and C contain bits where increasing error
rates gradually reduce the speech quality, but decoding of an erroneous speech
frame is usually possible without annoying artefacts. Class B bits are more
sensitive to errors than Class C bits. The importance ordering applies also
within the three different classes and there are no significant step-wise
changes in subjective importance between neighbouring bits at the class
borders.
The number of speech bits in each class (Class A, Class B, and Class C) for
each AMR mode is shown in table 2. The classification in table 2 and the
importance ordering _d_(_j_), together, are sufficient to assign all speech
bits to their correct classes. For example, when the AMR codec mode is 4.75,
then the Class A bits are _d_(0).._d_(41), Class B bits are _d_(42).._d_(94),
and there are no Class C bits.
Table 2: Number of bits in Classes A, B, and C for each AMR codec mode
* * *
Frame Type AMR\ Total number of bits Class A Class B Class C codec mode
**0** 4,75 95 42 53 0
**1** 5,15 103 49 54 0
**2** 5,90 118 55 63 0
**3** 6,70 134 58 76 0
**4** 7,40 148 61 87 0
**5** 7,95 159 75 84 0
**6** 10,2 204 65 99 40
**7** 12,2 244 81 103 60
* * *
### 4.2.3 AMR Core Frame with comfort noise bits
The AMR Core Frame content for the additional frame type with Frame Type Index
8 in table 1a is described in this subclause. This consists of the frame
related to Source Controlled Rate Operation specified in [2].
The data content (comfort noise bits) of the additional frame types is carried
in AMR Core Frame. The comfort noise bits are all mapped to Class A of AMR
Core Frame and Classes B and C are not used. This is a notation convention
only and the class division has no meaning for comfort noise bits.
The number of bits in each class (Class A, Class B, and Class C) for the AMR
comfort noise bits (Frame Type Index 8) is shown in table 3. The contents of
SID_UPDATE and SID_FIRST are divided into three parts (SID Type Indicator
(STI), Mode Indication (mi(i)), and Comfort Noise Parameters (s(i)) as defined
in [2]. In case of SID_FIRST the Comfort Noise Parameters bits (s(i)) shall be
set to \"0\".
The comfort noise parameter bits produced by the AMR speech encoder are
denoted as s(i) = {_s_(1),_s_(2),...,_s_(_35_)}. The notation _s_(_i_) follows
that of [3]. These bits are numbered in the order they are produced by the AMR
encoder without any reordering. These bits are followed by the SID Type
Indicator **STI** and the Mode Indication\ mi(i) ={_mi_(0), _mi_(1), _mi_(2)}
={L _SB .. MSB_}. Thus, the AMR SID or comfort noise bits
{_d_(0),_d_(1),...,_d_(38)}are formed as defined by the pseudo code below.
\- for _j_ = 0 to 34;
\- _d_(_j_) := _s_(_j_ +1);
\- _d_(35) := **STI;**
\- for _j_ = 36 to 38;
\- _d_(_j_) := _mi_(_j_ -36). Note: This mapping is different to the usual
mapping: LSB first.
Note: The alternative would be: _d_(_j_) := _mi_(38-j): MSB first.
Table 3. Bit classification for Frame Type 8 (AMR SID)
+--------+-----+--------+--------+--------+--------+--------+---+---+ | Frame | FQI | AMR | Total | Class | Class | Class | | | | Type | | | number | A | B | C | | | | Index | | TX | of | | | | | | | | | _TYPE | bits | | | | | | | | | or | | | | | | | | | | RX | | | | | | | | | | _TYPE | | | | | | | +--------+-----+--------+--------+--------+--------+--------+---+---+ | | | | | **SID | * |** Co | | | | | | | | Type | _Mode\ | mfort\ | | | | | | | | Ind | Indic | Noise | | | | | | | | icator | ation\ | Par | | | | | | | | ( | m | ameter | | | | | | | | STI)__| i(i)__| s(i)_ * | | | +--------+-----+--------+--------+--------+--------+--------+---+---+ | 8 | 1 | SID_ | 39 | 1 (= | 3 | 35 | 0 | 0 | | | | UPDATE | | \"1\") | | | | | +--------+-----+--------+--------+--------+--------+--------+---+---+ | 8 | 1 | SID\ | 39 | 1 (= | 3 | 35 (= | 0 | 0 | | | | _FIRST | | \"0\") | | \"0\") | | | +--------+-----+--------+--------+--------+--------+--------+---+---+ | 8 | 0 | SI | 39 | 1 | 3 | 35 | 0 | 0 | | | | D_BAD | | | | | | | +--------+-----+--------+--------+--------+--------+--------+---+---+
The number of bits in each class (Class A, Class B, and Class C) for the
comfort noise bits of Frame Types 9-11 is shown in Table 7.
Table 4: void
## 4.3 AMR frame composition
The generic AMR frame is formed as a concatenation of AMR Header, AMR
Auxiliary Information and the AMR Core Frame, in this order. The MSB of the
Frame Type is placed in bit 8 of the first octet (see example in table 5
below), the LSB of the Frame Type is placed in bit 5. Then the next parameter
follows, which is the Frame Quality Indicator, and so on. Between Mode Request
and Codec CRC five spare bits are inserted to align the Codec CRC and the AMR
Core frame to the octet boundary. The first bit of the AMR Core frame d(0) is
placed in bit 8 of octet 4. The last bit of the generic AMR frame is the last
bit of AMR Core Frame, which is the last bit of speech bits or the last bit of
comfort noise bits, as defined in subclauses 4.2.1 and 4.2.3. Table 5 shows
the composition for the example of the Codec Mode 6.7kbit/s and table 6 shows
the composition for the AMR SID frame.
Table 5: Mapping of an AMR speech coding mode into the generic AMR frame, AMR
IF1,\ example: AMR 6.7 kbit/s, \"good frame\", Mode Request = 1.
* * *
              MSB                         Mapping of bits\   LSB                                                        
                                          AMR 6.7
**Octet** bit 8 bit 7 bit 6 bit 5 bit 4 bit 3 bit 2 bit 1
**1** Frame Type (=3) FQI Mode Indication (=3)
              0                           0                  1                      1        1        0        1        1
**2** Mode Request (=1) spare
              0                           0                  1                      0        0        0        0        0
**3** Codec CRC
              CRC(7)                      CRC(6)             CRC(5)                 CRC(4)   CRC(3)   CRC(2)   CRC(1)   CRC(0)
**4** AMR Core Frame (octet 1)
              d(0)                        d(1)               d(2)                   d(3)     d(4)     d(5)     d(6)     d(7)
**5..19**
**20** AMR Core Frame (octet 17) undefined
              d(128)                      d(129)             d(130)                 d(131)   d(132)   d(133)
* * *
Table 6: Mapping of an AMR SID frame into the generic AMR frame, AMR IF1,\
example: AMR SID_Update, \"good frame\", Mode Indication = 3, Mode Request =
2.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | MSB | Ma | LSB | | | | | | | | | pping | | | | | | | | | | of | | | | | | | | | | bits\ | | | | | | | | | | AMR | | | | | | | | | | SID | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **Oc | bit 8 | bit 7 | bit 6 | bit 5 | bit 4 | bit 3 | bit 2 | bit 1 | | tet** | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **1** | Frame | FQI | Mode | | | | | | | | Type | | Indic | | | | | | | | (=8) | | ation | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | 1 | 0 | 0 | 0 | 1 | unde | | | | | | | | | | fined | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **2** | Mode | spare | | | | | | | | | Re | | | | | | | | | | quest | | | | | | | | | | (=2)\ | | | | | | | | | | MSB | | | | | | | | | | ... | | | | | | | | | | LSB | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **3** | Codec | | | | | | | | | | CRC | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | C | C | C | C | C | C | C | C | | | RC(7) | RC(6) | RC(5) | RC(4) | RC(3) | RC(2) | RC(1) | RC(0) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **4** | AMR | | | | | | | | | | Core | | | | | | | | | | Frame | | | | | | | | | | ( | | | | | | | | | | octet | | | | | | | | | | 1) | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | d(0) | d(1) | d(2) | d(3) | d(4) | d(5) | d(6) | d(7) | | | =s(1) | =s(2) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **5 | | | | | | | | | | ..7** | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **8** | | | | STI | Mode | u | | | | | | | | | Indic | ndef. | | | | | | | | | ation | | | | | | | | | | (=3) | | | | | | | | | | | | | | | | | | | | LSB | | | | | | | | | | ... | | | | | | | | | | MSB | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | d(32) | d(33) | d(34) | 1 | 1 | 1 | 0 | | | | | | = | | | | | | | | | | s(35) | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Table 7 summarizes all possible AMR frame format combinations in terms of
number of bits in each field.
Table 7. Number of bits for different fields in different AMR frame
compositions
* * *
Frame Type Index Frame Type Frame Quality Indicator Mode Indication Mode
Request Codec CRC Class A Class B Class C Total AMR Core Frame  
0 4 1 3 3 8 42 53 0 114 1 4 1 3 3 8 49 54 0 122 2 4 1 3 3 8 55 63 0 137 3 4 1
3 3 8 58 76 0 153 4 4 1 3 3 8 61 87 0 167 5 4 1 3 3 8 75 84 0 178 6 4 1 3 3 8
65 99 40 223 7 4 1 3 3 8 81 103 60 263 8 4 1 3 3 8 39 0 0 58 9 4 1 3 3 8 43 0
0 62 10 4 1 3 3 8 38 0 0 57 11 4 1 3 3 8 37 0 0 56 12 Not used  
13 Not used  
14 Not used  
15 4 0 0 0 0 0 0 0 4
* * *
## 4.4 GSM-EFR Frame Composition
This subclause contains the description of the generic GSM-EFR Frame of Figure
1. The descriptions for the generic GSM-EFR Frame with speech bits and with
comfort noise bit are given separately.
### 4.4.1 GSM-EFR Frame with speech bits
The generic GSM-EFR frame for speech data bits is formed like for the AMR mode
12.2 kbit/s.\ The same Frame Type (Frame Type 7) is used also for GSM-EFR. The
Mode Indication and Mode Request fields are set to \"7\". The GSM-EFR Core
Frame for speech data bits is identical to the AMR Core Frame for speech data
bits in the AMR mode with 12.2 kbit/s.
### 4.4.2 GSM-EFR Frame with comfort noise bits
The GSM-EFR Frame content for the additional frame type with Frame Type Index
9 in Table 1a are described in this subclause. This consists of the frame
related to GSM-EFR Comfort Noise Aspects as specified in [4] and [5].
The comfort noise bits are all mapped to Class A. Classes B and C are not used
(see Table 7).
The contents of GSM-EFR SID is the Comfort Noise Parameters (s(i)) as defined
in [4]. The Comfort noise parameters are computed as described in [5] by the
GSM-EFR speech encoder and are denoted as s(i) = {_s_(1),_s_(2),...,_s(38),
s(87),s(88),...,s(91)_}. The notation _s_(_i_) follows that of [4] (Table 6).
The notation _d_(_j_) = {d(0) ... d(42)} is local to the present document and
is formed as defined by the pseudo code below.
for _j_ = 0 to 37\ _d_(_j_) := _s_(_j_ +1); /* LSP parameters in _s_(1) to
_s_(38) */;
> for _j_ = 38 to 42\ _d_(_j_) := _s_(_j_ +49); /* fixed codebook gain
> parameter in _s_(87)-_s_(91) */
Table 8 shows the composition for the generic GSM-EFR SID frame.
Table 8: Mapping of the GSM-EFR SID frame into the generic AMR frame format,
AMR IF1,\ Example of a good GSM-EFR SID frame (FQI=1).
* * *
              MSB                    Mapping of bits for GSM-EFR SID   LSB
**Octet** bit 8 bit 7 bit 6 bit 5 bit 4 bit 3 bit 2 bit 1 **1** Frame Type
(=9) FQI Mode Indication (=7)  
1 0 0 1 1 1 1 1 **2** Mode Request (=7) spare  
1 1 1 0 0 0 0 0 **3** Codec CRC  
CRC(7) CRC(6) CRC(5) CRC(4) CRC(3) CRC(2) CRC(1) CRC(0) **4** Core Frame
(octet 1)  
d(0)=s(1) d(1)=s(2) d(2) d(3) d(4) d(5) d(6) d(7) **5..7**
**8**  
d(32)) d(33) d(34) d(35) d(36)=s(37) d(37)=s(38) d(38)=s(87) d(39)=s(88) **9**
spare  
d(40)=s(89) d(41)=s(90) d(42)=s(91) 0 0 0 0 0
* * *
###### ## Annex A (informative): AMR Interface Format 2 (with octet alignment)
This annex defines an octet-aligned frame format for the AMR codec. This
format is useful, for example, when the AMR codec is used in connection with
applicable ITU-T Hâ€‘series of recommendations. The format is referred to as AMR
Interface Format 2 (AMR IF2).
The AMR IF2 frame is formed by concatenation of the 4-bit Frame Type field (as
defined for AMR IF1 in subclause 4.1.1) and the AMR Core Frame (as defined for
AMR IF1 in subclause 4.2) as shown in figure A.1. The length of the AMR Core
Frame field depends on the particular Frame Type. The total number of bits in
the AMR IF2 speech frames in the different modes is typically not a multiple
of eight and bit stuffing is needed to achieve an octet structure.
{width="5.000694444444444in" height="2.3756944444444446in"}
Figure A.1: Frame structure for AMR IF2
Table A.1a shows an example how the AMR 6.7 kbit/s mode is mapped into AMR
IF2. The four LSBs of the first octet (octet 1) consist of the Frame Type(=3)
for the AMR 6.7 kbit/s mode (see table 1a in AMR IF1 specification). This data
field is followed by the 134 AMR Core Frame speech bits (_d_(0)..._d_(133))
which consist of 58 Class A bits and 76 Class B bits as described in table 2
for AMR IF1. This results in a total of 138 bits and 6 bits are needed for Bit
Stuffing to arrive to the closest multiple of 8 which is 144 bits.
Table A.1a: Example mapping of the AMR speech coding mode 6.7kbit/s into AMR
IF2.\ The bits used for Bit Stuffing are denoted as UB (for \"unused bit\").
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | MSB | Ma | LSB | | | | | | | | | pping | | | | | | | | | | of | | | | | | | | | | bits\ | | | | | | | | | | AMR | | | | | | | | | | 6.7 | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **Oc | bit 8 | bit 7 | bit 6 | bit 5 | bit 4 | bit 3 | bit 2 | bit 1 | | tet** | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **1** | | | | | Frame | | | | | | | | | | Type | | | | | | | | | | (= 3) | | | | | | | | | | | | | | | | | | | | MSB | | | | | | | | | | ...\ | | | | | | | | | | ..... | | | | | | | | | | LSB | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | d(3) | d(2) | d(1) | d(0) | 0 | 0 | 1 | 1 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **2** | d(11) | d(10) | d(9) | d(8) | d(7) | d(6) | d(5) | d(4) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **3** | ... | ... | ... | ... | ... | ... | ... | d(12) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | * | Stu | d | d | | | | | | | _18_ * | ffing | (133) | (132) | | | | | | | | bits | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | UB | UB | UB | UB | UB | UB | d | d | | | | | | | | | (133) | (132) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Table A.1b shows the composition of AMR IF2 frames for all Frame Types in
terms of how many bits are used for each field of figure A.1.
Tables A.2 to A.5 specify how the AMR Core Frame comfort noise bits of Frame
Types 8-11 are mapped to AMR IF2. Table A.6 specifies the mapping for an empty
frame (\"no transmission\").
Table A.1b: Composition of AMR IF2 Frames for all Frame Types.
* * *
Frame Type Index Frame content Number of bits in Frame Type Number of Bits in
AMR Core Frame Number of Bits in\ Number of octets (N) Bit Stuffing
**0** AMR 4,75 4 95 5 13
**1** AMR 5,15 4 103 5 14
**2** AMR 5,90 4 118 6 16
**3** AMR 6,70 4 134 6 18
**4** AMR 7,40 4 148 0 19
**5** AMR 7,95 4 159 5 21
**6** AMR 10,2 4 204 0 26
**7** AMR 12,2 4 244 0 31
**8** AMR SID 4 39 5 6
**9** GSM-EFR SID 4 43 1 6
**10** TDMA-EFR SID 4 38 6 6
**11** PDC-EFR SID 4 37 7 6
**12-14** For future use - - - -
**15** No Data 4 0 4 1
* * *
Table A.2: Mapping of bits for Frame Type 8 (AMR SID)\ (Bits s1 to s35 refer
to TS 26.092)
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | MSB | Ma | LSB | | | | | | | | | pping | | | | | | | | | | of | | | | | | | | | | bits\ | | | | | | | | | | AMR | | | | | | | | | | SID | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **Oc | bit 8 | bit 7 | bit 6 | bit 5 | bit 4 | bit 3 | bit 2 | bit 1 | | tet** | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **1** | Index | index | Frame | | | | | | | | of | of | Type | | | | | | | | 1^st^ | LSF | (= 8) | | | | | | | | LSF | refe | | | | | | | | | subv | rence | MSB | | | | | | | | ector | v | ... | | | | | | | | | ector | ...\ | | | | | | | | | | ..... | | | | | | | | | | LSB | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | s4 | s3 | s2 | s1 | 1 | 0 | 0 | 0 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **2** | Index | index | | | | | | | | | of | of | | | | | | | | | 2^nd^ | 1^st^ | | | | | | | | | LSF | LSF | | | | | | | | | subv | subv | | | | | | | | | ector | ector | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | s12 | S11 | s10 | s9 | s8 | s7 | s6 | s5 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **3** | index | | | | | | | | | | of | | | | | | | | | | 2^nd^ | | | | | | | | | | LSF | | | | | | | | | | subv | | | | | | | | | | ector | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | s20 | S19 | s18 | s17 | s16 | s15 | s14 | s13 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **4** | index | | | | | | | | | | of | | | | | | | | | | 3^rd^ | | | | | | | | | | LSF | | | | | | | | | | subv | | | | | | | | | | ector | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | s28 | s27 | s26 | s25 | s24 | s23 | s22 | s21 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **5** | SID | frame | index | | | | | | | | Type | e | of | | | | | | | | Indi | nergy | 3^rd^ | | | | | | | | cator | | LSF | | | | | | | | | | subv | | | | | | | | | | ector | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | t1 | s35 | s34 | s33 | s32 | s31 | s30 | s29 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | **6** | Stu | Mode | | | | | | | | | ffing | I | | | | | | | | | bits | ndica | | | | | | | | | | tion\ | | | | | | | | | | MSB | | | | | | | | | | mi(i) | | | | | | | | | | LSB | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | UB | UB | UB | UB | UB | mi(2) | mi(1) | mi(0) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Definitions of additional descriptor bits needed for the silence descriptor in
the table are as follows: SID-type Indicator STI is {0=SID_FIRST, 1=SID_UPDATE
}, Mode Indication (mi(0)- mi(2)) is the AMR codec mode according to the first
eight entries in table 1a.
Table A.3: Mapping of bits for Frame Type 9 (GSM-EFR SID)\ (Bits s1 to s91
refer to GSM 46.060)
* * *
              MSB                            Mapping of bits\               LSB                                                            
                                             GSM-EFR SID
**Octet** bit 8 bit 7 bit 6 bit 5 bit 4 bit 3 bit 2 bit 1
**1** Index of 1^st^ LSF subMatrix Frame Type (= 9)
              s4                             s3                             s2                             s1      1       0       0       1
**2** Index of 2^nd^ LSF submatrix index of 1^st^ LSF subMatrix
              s12                            s11                            s10                            s9      s8      s7      s6      s5
**3** Index of 3^rd^ LSF submatrix Index of 2^nd^ LSF submatrix
              s20                            s19                            s18                            s17     s16     s15     s14     s13
**4** index of 4^th^ LSF submatrix sign of 3^rd^ LSF submatrix index of 3^rd^
LSF submatrix
              s28                            s27                            s26                            s25     s24     s23     s22     s21
**5** index of 5^th^ LSF submatrix index of 4^th^ LSF submatrix
              s36                            s35                            s34                            s33     s32     s31     s30     s29
**6** Stuffing bit fixed codebook gain index of 5^th^ LSF submatrix
              UB                             s91                            s90                            s89     s88     s87     s38     s37
* * *
Table A.4: Mapping of bits for Frame Type 10 (TDMA-EFR SID)\ (Bits cn0 to cn37
refer to IS-641-A)
* * *
              MSB                             Mapping of bits\                LSB                                                         
                                              TDMA-EFR SID
**Octet** **bit 8** **bit 7** **bit 6** **bit 5** **bit 4** **bit 3** **bit
2** **bit 1**
**1** Index of 1^st^ LSF subvector Frame Type (= 10)
              cn3                             cn2                             cn1         cn0         1           0           1           0
**2** Index of 2^nd^ LSF subvector index of 1^st^ LSF subvector
              cn11                            Cn10                            cn9         cn8         cn7         cn6         cn5         cn4
**3** Index of 3^rd^ LSF subvector Index of 2^nd^ LSF subvector
              cn19                            cn18                            cn17        cn16        cn15        cn14        cn13        cn12
**4** Random Excitation Gain index of 3^rd^ LSF subvector
              cn27                            cn26                            cn25        cn24        cn23        cn22        cn21        cn20
**5** Index of 1^st^ RESC parameter Random Excitation Gain
              cn35                            cn34                            cn33        cn32        cn31        cn30        cn29        cn28
**6** Stuffing bits Index of 2^nd^ RESC parameter
              UB                              UB                              UB          UB          UB          UB          cn37        cn36
* * *
Table A.5: Mapping of bits for Frame Type 11 (PDC-EFR SID)\ (Bits s1 to s35
refer to ARIB xx)
* * *
              MSB                            Mapping of bits\                LSB                                                            
                                             PDC-EFR SID
**Octet** bit 8 bit 7 bit 6 bit 5 bit 4 bit 3 bit 2 bit 1
**1** index of 1^st^ LSF subvector index of LSF reference vector Frame Type (=
11)
              s4                             s3                              s2                             s1      1       0       1       1
**2** index of 2^nd^ LSF subvector index of 1^st^ LSF subvector
              s12                            s11                             s10                            s9      s8      s7      s6      s5
**3** index of 2^nd^ LSF subvector
              s20                            s19                             s18                            s17     s16     s15     s14     s13
**4** index of 3^rd^ LSF subvector
              s28                            s27                             s26                            s25     s24     s23     s22     s21
**5** SID type frame energy Index of 3^rd^ LSF subvector
              t1                             s35                             s34                            s33     s32     s31     s30     s29
**6** Stuffing bits SID type
              UB                             UB                              UB                             UB      UB      UB      UB      t2
* * *
Definition of additional descriptor bits needed for the table is as follows:
SIDâ€‘type is {0=POST0, 1=POST1(SID_UPDATE), 2=PRE, 3=POST1_BAD }, where LSB of
SID_type is t1 and MSB of SID-type is t2.
Table A.6: Mapping of bit for Frame Type 15 (No Data)
* * *
              MSB             Mapping of Bits\    LSB                                     
                              No Data
**Octet** bit 8 bit 7 bit 6 bit 5 bit 4 bit 3 bit 2 bit 1
**1** Stuffing bits Frame Type (= 15)
              UB              UB                  UB      UB      1       1       1       1
* * *
###### ## Annex B (normative): Tables for AMR Core Frame bit ordering
This annex contains the tables required for ordering the AMR Core Frame speech
bits corresponding to the different AMR modes. These tables represent
_table~m~_(_j_) in subclause 4.2.1 where _m_ =0..7 is the AMR mode. The tables
are read from left to right so that the first element (top left corner) of the
table has index 0 and the last element (the rightmost element of the last row)
has the index _K_ -1 where _K_ is the total number of speech bits in the
specific mode. For example, _table_ ~0~(20)=27, as defined in table B.1.
Table B.1: Ordering of the speech encoder bits for the 4.75 kbit/s mode:
_table_ ~0~(_j_)
* * *
j=0 j=1 j=2 ... ... ... ... ... ... ... 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
23 24 25 26 27 28 48 49 61 62 82 83 47 46 45 44 81 80 79 78 17 18 20 22 77 76
75 74 29 30 43 42 41 40 38 39 16 19 21 50 51 59 60 63 64 72 73 84 85 93 94 32
33 35 36 53 54 56 57 66 67 69 70 87 88 90 91 34 55 68 89 37 58 71 92 31 52 65
86
* * *
Table B.2: Ordering of the speech encoder bits for the 5.15 kbit/s mode:
_table_ ~1~(_j_)
* * *
7 6 5 4 3 2 1 0 15 14 13 12 11 10 9 8 23 24 25 26 27 46 65 84 45 44 43 64 63
62 83 82 81 102 101 100 42 61 80 99 28 47 66 85 18 41 60 79 98 29 48 67 17 20
22 40 59 78 97 21 30 49 68 86 19 16 87 39 38 58 57 77 35 54 73 92 76 96 95 36
55 74 93 32 51 33 52 70 71 89 90 31 50 69 88 37 56 75 94 34 53 72 91
* * *
Table B.3: Ordering of the speech encoder bits for the 5.9 kbit/s mode:
_table_ ~2~(_j_)
* * *
0 1 4 5 3 6 7 2 13 15 8 9 11 12 14 10 16 28 74 29 75 27 73 26 72 30 76 51 97
50 71 96 117 31 77 52 98 49 70 95 116 53 99 32 78 33 79 48 69 94 115 47 68 93
114 46 67 92 113 19 21 23 22 18 17 20 24 111 43 89 110 64 65 44 90 25 45 66 91
112 54 100 40 61 86 107 39 60 85 106 36 57 82 103 35 56 81 102 34 55 80 101 42
63 88 109 41 62 87 108 38 59 84 105 37 58 83 104
* * *
Table B.4: Ordering of the speech encoder bits for the 6.7 kbit/s mode:
_table_ ~3~(_j_)
* * *
0 1 4 3 5 6 13 7 2 8 9 11 15 12 14 10 28 82 29 83 27 81 26 80 30 84 16 55 109
56 110 31 85 57 111 48 73 102 127 32 86 51 76 105 130 52 77 106 131 58 112 33
87 19 23 53 78 107 132 21 22 18 17 20 24 25 50 75 104 129 47 72 101 126 54 79
108 133 46 71 100 125 128 103 74 49 45 70 99 124 42 67 96 121 39 64 93 118 38
63 92 117 35 60 89 114 34 59 88 113 44 69 98 123 43 68 97 122 41 66 95 120 40
65 94 119 37 62 91 116 36 61 90 115
* * *
Table B.5: Ordering of the speech encoder bits for the 7.4 kbit/s mode:
_table_ ~4~(_j_)
* * *
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 26 87 27 88 28 89 29 90 30 91 51 80
112 141 52 81 113 142 54 83 115 144 55 84 116 145 58 119 59 120 21 22 23 17 18
19 31 60 92 121 56 85 117 146 20 24 25 50 79 111 140 57 86 118 147 49 78 110
139 48 77 53 82 114 143 109 138 47 76 108 137 32 33 61 62 93 94 122 123 41 42
43 44 45 46 70 71 72 73 74 75 102 103 104 105 106 107 131 132 133 134 135 136
34 63 95 124 35 64 96 125 36 65 97 126 37 66 98 127 38 67 99 128 39 68 100 129
40 69 101 130
* * *
Table B.6: Ordering of the speech encoder bits for the 7.95 kbit/s mode:
_table_ ~5~(_j_)
* * *
8 7 6 5 4 3 2 14 16 9 10 12 13 15 11 17 20 22 24 23 19 18 21 56 88 122 154 57
89 123 155 58 90 124 156 52 84 118 150 53 85 119 151 27 93 28 94 29 95 30 96
31 97 61 127 62 128 63 129 59 91 125 157 32 98 64 130 1 0 25 26 33 99 34 100
65 131 66 132 54 86 120 152 60 92 126 158 55 87 121 153 117 116 115 46 78 112
144 43 75 109 141 40 72 106 138 36 68 102 134 114 149 148 147 146 83 82 81 80
51 50 49 48 47 45 44 42 39 35 79 77 76 74 71 67 113 111 110 108 105 101 145
143 142 140 137 133 41 73 107 139 37 69 103 135 38 70 104 136
* * *
Table B.7: Ordering of the speech encoder bits for the 10.2 kbit/s mode:
_table_ ~6~(_j_)
* * *
7 6 5 4 3 2 1 0 16 15 14 13 12 11 10 9 8 26 27 28 29 30 31 115 116 117 118 119
120 72 73 161 162 65 68 69 108 111 112 154 157 158 197 200 201 32 33 121 122
74 75 163 164 66 109 155 198 19 23 21 22 18 17 20 24 25 37 36 35 34 80 79 78
77 126 125 124 123 169 168 167 166 70 67 71 113 110 114 159 156 160 202 199
203 76 165 81 82 92 91 93 83 95 85 84 94 101 102 96 104 86 103 87 97 127 128
138 137 139 129 141 131 130 140 147 148 142 150 132 149 133 143 170 171 181
180 182 172 184 174 173 183 190 191 185 193 175 192 176 186 38 39 49 48 50 40
52 42 41 51 58 59 53 61 43 60 44 54 194 179 189 196 177 195 178 187 188 151
136 146 153 134 152 135 144 145 105 90 100 107 88 106 89 98 99 62 47 57 64 45
63 46 55 56
* * *
Table B.8: Ordering of the speech encoder bits for the 12.2 kbit/s mode:
_table_ ~7~(_j_)
* * *
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 23 15 16 17 18 19 20 21 22 24 25 26 27 28
38 141 39 142 40 143 41 144 42 145 43 146 44 147 45 148 46 149 47 97 150 200
48 98 151 201 49 99 152 202 86 136 189 239 87 137 190 240 88 138 191 241 91
194 92 195 93 196 94 197 95 198 29 30 31 32 33 34 35 50 100 153 203 89 139 192
242 51 101 154 204 55 105 158 208 90 140 193 243 59 109 162 212 63 113 166 216
67 117 170 220 36 37 54 53 52 58 57 56 62 61 60 66 65 64 70 69 68 104 103 102
108 107 106 112 111 110 116 115 114 120 119 118 157 156 155 161 160 159 165
164 163 169 168 167 173 172 171 207 206 205 211 210 209 215 214 213 219 218
217 223 222 221 73 72 71 76 75 74 79 78 77 82 81 80 85 84 83 123 122 121 126
125 124 129 128 127 132 131 130 135 134 133 176 175 174 179 178 177 182 181
180 185 184 183 188 187 186 226 225 224 229 228 227 232 231 230 235 234 233
238 237 236 96 199
* * *
#