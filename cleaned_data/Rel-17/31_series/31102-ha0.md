# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# Introduction
The present document defines the Universal Subscriber Identity Module (USIM)
application. This application resides on the UICC, an IC card specified in TS
31.101 [11]. In particular, TS 31.101 [11] specifies the application
independent properties of the UICC/terminal interface such as the physical
characteristics and the logical structure.
TS 31.101 [11] is one of the core documents for this specification and is
therefore referenced in many places in the present document.
# 1 Scope
The present document defines the USIM application for 3GPP telecom network
operation.
The present document specifies:
\- specific command parameters;
\- file structures;
\- contents of Efs (Elementary Files);
\- security functions;
\- application protocol to be used on the interface between UICC (USIM) and
ME.
This is to ensure interoperability between a USIM and an ME independently of
the respective manufacturer, card issuer or operator.
The present document does not define any aspects related to the administrative
management phase of the USIM. Any internal technical realisation of either the
USIM or the ME is only specified where these are reflected over the interface.
The present document does not specify any of the security algorithms which may
be used.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TS 21.111: \"USIM and IC Card Requirements\".
[2] 3GPP TS 22.011: \"Service accessibility\".
[3] 3GPP TS 22.024: \"Description of Charge Advice Information (CAI)\".
[4] 3GPP TS 22.030: \"Man‑Machine Interface (MMI) of the User Equipment
(UE)\".
[5] 3GPP TS 23.038: \"Alphabets and language\".
[6] 3GPP TS 23.040: \"Technical realization of the Short Message Service
(SMS)\".
[7] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[8] 3GPP TS 22.067: \"enhanced Multi Level Precedence and Pre-emption service
(eMLPP) ‑ Stage 1\".
[9] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols; Stage 3\".
[10] 3GPP TS 24.011: \"Point‑to‑Point (PP) Short Message Service (SMS) support
on mobile radio interface\".
[11] 3GPP TS 31.101: \"UICC-Terminal Interface, Physical and Logical
Characteristics\".
[12] 3GPP TS 31.111: \"USIM Application Toolkit (USAT)\".
[13] 3GPP TS 33.102: \"3GPP Security; Security Architecture\".
[14] 3GPP TS 33.103: \"3GPP Security; Integration Guidelines\".
[15] 3GPP TS 22.086: \"Advice of charge (AoC) Supplementary Services ‑ Stage
1\".
[16] 3GPP TS 23.041: \"Technical realization of Cell Broadcast (CB)\".
[17] 3GPP TS 02.07: \"Mobile Stations (MS) features\".
[18] 3GPP TS 51.011 Release 4: \"Specification of the Subscriber Identity
Module -- Mobile Equipment (SIM -- ME) interface\".
[19] ISO 639 (1988): \"Code for the representation of names of languages\".
[20] ISO/IEC 7816‑4: \"Integrated circuit cards, Part 4: Organization,
security and commands for interchange\".
[21] Void.
[22] ITU-T Recommendation E.164: \"The international public telecommunication
numbering plan\".
[23] 3GPP TS 23.073: \"Support of Localised Service Area (SoLSA); Stage 2\".
[24] 3GPP TS 22.101: \"Service aspects; service principles\".
[25] 3GPP TS 23.003: \"Numbering, Addressing and Identification\".
[26] Void.
[27] 3GPP TS 22.022: \"Personalisation of Mobile Equipment (ME); Mobile
functionality specification\".
[28] 3GPP TS 44.018 \"Mobile Interface Layer3 Specification, Radio Resource
control protocol\".
> [29] 3GPP TS 23.022: \"Functions related to Mobile Station (MS) in idle mode
> and group receive mode\".
[30] 3GPP TS 23.057: \"Mobile Execution Environment (MexE);Functional
description; Stage 2\".
[31] 3GPP TS 23.122: \"NAS Functions related to Mobile Station (MS) in idle
mode\".
[32] Void.
[33] 3GPP TS 25.101: \"UE Radio Transmission and Reception (FDD)\".
[34] 3GPP TS 45.005: \"Radio Transmission and Reception\".
[35] ISO/IEC 8825-1 (2008): \"Information technology -- ASN.1 encoding rules :
Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER)
and Distinguished Encoding Rules (DER)\".
[36] 3GPP TS 23.097: \"Multiple Subscriber Profile (MSP)\".
[37] Void.
[38] 3GPP TS 23.140 Release 6: \"Multimedia Messaging Service (MMS);
Functional description; stage 2\".
[39] ETSI TS 102 222 V7.1.0: \"Administrative commands for telecommunications
applications\".
[40] 3GPP TS 24.234 Release 12: \"3GPP System to WLAN Interworking; UE to
Network protocols;Stage 3\".
[41] 3GPP TS 33.234 Release 12: \"3G Security; Wireless Local Area Network
(WLAN) interworking security\".
[42] 3GPP TS 33.220: \"Generic Authentication Architecture (GAA); Generic
bootstrapping architecture\".
[43] 3GPP TS 33.246: \"Security of Multimedia Broadcast/Multicast Service\".
[44] 3GPP TS 43.020: \"Technical Specification Group Services and system
Aspects; Security related network functions\"
[45] 3GPP2 X.S0016-000-A v1.0: \"3GPP2 Multimedia Messaging System MMS
Specification Overview, Revision A\"
[46] 3GPP TS 43.068: \"Technical Specification Group Core Network; Voice Group
Call Service (VGCS); Stage 2\".
[47] 3GPP TS 33.110: \"Key establishment between a Universal Integrated
Circuit Card (UICC) and a terminal\".
[48] IETF RFC 3629 (2003): \"UTF-8, a transformation format of ISO 10646\".
[49] Open Mobile Alliance; OMA-TS-BCAST_SvcCntProtection\ URL:
http://www.openmobilealliance.org/
[50] ETSI TS TS 102 483 V8.1.0: \"UICC-Terminal interface; Internet Protocol
connectivity between UICC and Terminal\".
[51] 3GPP TS 24.301: \"Technical Specification Group Core Network and
Terminals; Non-Access-Stratum (NAS) protocol for Evolved Packet Systems (EPS):
Stage 3\".
[52] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
[53] 3GPP2 C.S0074-A v1.0: \"UICC-Terminal Interface Physical and Logical
Characteristics for cdma2000 Spread Spectrum Systems\"
[54] 3GPP TS 22.220: \"Service requirements for Home NodeBs and Home eNodeBs
\".
[55] 3GPP TS 24.341: \"Support of SMS over IP networks; Stage 3\"
[56] IETF RFC 3261: \"SIP: Session Initiation Protocol\".
[57] IETF RFC 3629 (2003): \"UTF-8, a transformation format of ISO 10646\".
[58] 3GPP TS 24.285: \"Allowed Closed Subscriber Group (CSG) list; Management
Object (MO)\"
[59] OMA Smartcard-Web-Server Approved Version 1.1 - 12 May 2009
(OMA‑TS‑Smartcard_Web_Server-V1_1-20090512-A).[60] ISO/IEC 15948:2003:
\"Information technology - Computer graphics and image processing - Portable
Network Graphics (PNG): Functional specification\".
[61] Void.
[62] ETSI TS 101 220 : \"Smart Cards; ETSI numbering system for
telecommunication application providers\".
[63] 3GPP TS 24.229: \"IP multimedia call control protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\"
[64] 3GPP TS 31.103: \"Characteristics of the IP Multimedia Services Identity
Module (ISIM) application\".
[65] 3GPP TS 24.368: \"Non-Access Stratum (NAS) configuration Management
Object (MO)\".
[66] ETSI TS 102 484 V10.1.0: \'\'Smart Cards; Secure channel between a UICC
and end-point terminal\"
[67] ISO/IEC 7816-15:2004: \"**Identification cards -- Integrated circuit
cards -- Part 15: Cryptographic information application\"**
[68] 3GPP TS 22.268: \"Public Warning System (PWS) Requirements\".
[69] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[70] 3GPP TS 24.334: \"Proximity-services (ProSe) User Equipment (UE) to
Proximity-services (ProSe) Function Protocol aspects; Stage 3\".
[71] 3GPP TS 24.333: \"Proximity-services (ProSe) Management Objects (MO)\"
[72] 3GPP TS 33.303: \"Proximity-based Services (ProSe); Security aspects\"
[73] 3GPP TS 23.303: \"Proximity-based services (ProSe); Stage 2\"
[74] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\"
[75] 3GPP TS 23.032: \" Technical Specification Group Services and System
Aspects; Universal Geographical Area Description (GAD)\"
[76] 3GPP TS 33.187: \"Security aspects of Machine-Type Communications (MTC)
and other mobile data applications communications enhancements\"
[77] 3GPP TS 32.277: \"Proximity-based Services (ProSe) charging\"
[78] 3GPP TS 23.682: \"Technical Specification Group Services and System
Aspects; Architecture enhancements to facilitate communications with packet
data networks and applications\"
[79] 3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via
non-3GPP access networks\".
[80] IETF RFC 4122: \"A Universally Unique IDentifier (UUID) URN Namespace\".
[81] 3GPP TS 24.105: \"**Application specific Congestion control for Data
Communication (ACDC) Management Object (MO)** \".
[82] Void
[83] Void
[84] GSMA: \"IMEI Allocation and Approval Process Version 9.0\"
[85] 3GPP TS 36.306: \"Technical Specification Group Radio Access Network;
Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) radio
access capabilities\"
> [86] 3GPP TS 24.607: \"Originating Identification Presentation (OIP) and
> Originating Identification Restriction (OIR) using IP Multimedia (IM) Core
> Network (CN) subsystem; Protocol specification\"
>
> [87] 3GPP TS 24.417: \"Management Object (MO) for Originating Identification
> Presentation (OIP) and Originating Identification Restriction (OIR) using IP
> Multimedia (IM) Core Network (CN) subsystem; Stage 3\".
>
> [88] 3GPP TS 24.167: \"3GPP IMS Management Object (MO); Stage 3\".
[89] 3GPP TS 24.483: \"Mission Critical Services(MCS) Management Object
(MO)\".
[90] void
> [91] 3GPP TS 24.117: \"TV service configuration Management Object (MO)\"
[92] 3GPP TS 36.101: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) radio transmission and reception\".
[93] 3GPP TS 24.424: \"Management Object (MO) for Extensible Markup Language
(XML) Configuration Access Protocol (XCAP) over the Ut interface for
Manipulating Supplementary Services (SS)\".
[94] 3GPP TS 24.391: \"Unstructured Supplementary Service Data (USSD) using IP
Multimedia (IM) Core Network (CN) subsystem (IMS) Management Object (MO)\".
[95] 3GPP TS 24.275: \"Management Object (MO) for basic communication part of
IMS multimedia telephony (MMTEL) communication service\".
[96] Void.
[97] 3GPP TS 24.385: \"V2X services Management Object (MO)\".
[98] 3GPP TS 24.386: \"User Equipment (UE) to V2X control function; protocol
aspects \".
[99] 3GPP TS 26.346: \" Technical Specification Group Services and System
Aspects; Multimedia Broadcast/Multicast Service (MBMS); Protocols and
codecs\"[100] OMA-DDS-DM_ConnMO-V1_0-20081107-A: \" Standardized Connectivity
Management Objects\".
[101] 3GPP TS 24.424: \"Management Object (MO) for Extensible Markup Language
(XML) Configuration Access Protocol (XCAP) over the Ut interface for
Manipulating Supplementary Services (SS)\".
[100] OMA-DDS-DM_ConnMO-V1_0-20081107-A: \" Standardized Connectivity
Management Objects\".
[102] 3GPP TS 24.623: \"Extensible Markup Language (XML) Configuration Access
Protocol (XCAP) over the Ut interface for Manipulating Supplementary
Services\".
[103] OMA OMA-TS-XDM_Core-V1_1-20080627-A: \"XML Document Management (XDM)
Specification\".
[104] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[105] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
[106] 3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\".
[107] IETF RFC 5480: \"Elliptic Curve Cryptography Subject Public Key
Information\".
[108] IETF RFC 7748: \"Elliptic Curves for Security\".
[109] 3GPP TS 24.526: \"User Equipment (UE) policies for 5G System (5GS);
Stage 3\".
[110] 3GPP TS 24.175: \"Management Object (MO) for Multi-Device and Multi-
Identity in IMS\".
[111] 3GPP TS 24.174: \"Support of Multi-Device and Multi-Identity in IMS;
Stage 3\".
[112] 3GPP TS 24.587: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); Protocol aspects; Stage 3\".
[113] 3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); User Equipment (UE) policies; Stage 3\".
[114] 3GPP TS 24.554: \" Proximity-services (ProSe) in 5G System (5GS)
protocol aspects; Stage 3\".
[115] 3GPP TS 24.555: \"Proximity-services (ProSe) in 5G System (5GS); User
Equipment (UE) policies; Stage 3\".
[116] 3GPP TS 23.304: \"Proximity-services (ProSe) in 5G System (5GS)\".
[117] 3GPP TS 24.502: \"Technical Specification Group Core Network and
Terminals; Access to the 3GPP 5G Core Network (5GCN) via Non-3GPP Access
Networks (N3AN); Stage 3\".
# 3 Definitions, symbols, abbreviations and coding conventions
## 3.1 Definitions
For the purposes of the present document, the following definition applies.
**ADM** : access condition to an EF which is under the control of the
authority which creates this file.
Allocation of these levels and the respective requirements for their
fulfilment are the responsibility of the appropriate administrative authority
The definition of access condition ADM does not preclude the administrative
authority from using ALW, PIN, PIN2 and NEV if required.
A terminal does not need to evaluate access conditions indicated as ADM in the
present document.
**PIN/ADM** : A terminal is required to evaluate the access condition and
verify it in order to access the EF if the access condition is set to PIN or
PIN2.
**EHPLMN** : represents the Equivalent HPLMNs for network selection purposes.
The behaviour of EHPLMNs is defined in TS 23.122 [31].
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
\|\| Concatenation
⊕ Exclusive OR
f1 Message authentication function used to compute MAC
f1* A message authentication code (MAC) function with the property that no
valuable information can be inferred from the function values of f1* about
those of f1, ..., f5 and vice versa
f2 Message authentication function used to compute RES and XRES
f3 Key generating function used to compute CK
f4 Key generating function used to compute IK
f5 Key generating function used to compute AK
## 3.3 Abbreviations
For the purposes of the present document, the following abbreviations apply:
3GPP 3^rd^ Generation Partnership Project
5GCN 5G Core Network
AC Access Condition
ACDC Application specific Congestion control for Data Communication
ACL APN Control List
ADF Application Dedicated File
AID Application Identifier
AK Anonymity key
ALW ALWays
AMF Authentication Management Field
AoC Advice of Charge
APN Access Point Name
ASME Access Security Management Entity
ASN.1 Abstract Syntax Notation One
AuC Authentication Centre
AUTN Authentication token
BDN Barred Dialling Number
BER-TLV Basic Encoding Rule - TLV
B-TID Bootstrapping Transaction Identifier
CAG Closed Access Group
CCP Capability Configuration Parameter
CK Cipher key
CLI Calling Line Identifier
CNL Co-operative Network List
CPBCCH COMPACT Packet BCCH
CS Circuit switched
DCK Depersonalisation Control Keys
DF Dedicated File
DO Data Object
EC-GSM-IoT Extended coverage in GSM for IoT
DUCK Discovery User Confidentiality Key
DUIK Discovery User Integrity Key
DUSK Discovery User Scrambling Key
eDRX Extended Discontinuous Reception
EARFCN Evolved Absolute Radio Frequency Channel Number
EF Elementary File
EPC Evolved Packet Core
ePDG Evolved Packet Data Gateway
EPS Evolved Packet System
FCP File Control Parameters
FFS For Further Study
FQDN Full Qualified Domain Name
GCI Global Cable Identifier
GLI Global Line Identifier
GSM Global System for Mobile communications
HE Home Environment
HNB Home NodeB
HeNB Home eNodeB
IARI IMS Application Reference Identifier
ICC Integrated Circuit Card
ICE In Case of Emergency
ICI Incoming Call Information
ICT Incoming Call Timer
ID Identifier
Idi Identity of the initiator
Idr Identity of the responder
IEI Information Element Identifier
IK Integrity key
IMSI International Mobile Subscriber Identity
IOPS Isolated E-UTRAN Operation for Public Safety
K USIM Individual key
K~C~ Cryptographic key used by the cipher A5
KSI Key Set Identifier
LI Language Indication
LSA Localised Service Areas
LSB Least Significant Bit
MAC Message authentication code
MAC-A MAC used for authentication and key agreement
MAC-I MAC used for data integrity of signalling messages
MBMS Multimedia Broadcast/Multicast Service
MCC Mobile Country Code
MCData Mission Critical Data
MCPTT Mission Critical Push To Talk
MCS Mission Critical Services
MCVideo Mission Critical Video
MexE Mobile Execution Environment
MF Master File
MGV-F _MTK Generation and Validation Function_
MICO Mobile Initiated Connection Only
MiD Multi-iDentity
MIKEY Multimedia Internet KEYing
MINT Minimization of Service Interruption
MM Multimedia Message
MMI Man Machine Interface
MMS Multimedia Messaging Service
MMSS MultiMode System Selection
MNC Mobile Network Code
MODE Indication packet switched/circuit switched mode
MSB Most Significant Bit
MSK MBMS Service Key
MTC Machine Type Communications
MTK MBMS Traffic Key
MuD Multi-Device
MUK MBMS User Key
NAI Network Access Identifier
NB-IoT Narrowband IoT
NEV NEVer
ngKSI Key Set Identifier in 5G
NG-RAN Next Generation Radio Access Network
NID Network Identifier for SNPN
NPI Numbering Plan Identifier
NSI Network Specific Identifier
NSWO Non-Seamless WLAN Offload
OCI Outgoing Call Information
OCT Outgoing Call Timer
PBID Phonebook Identifier
PGK ProSe Group Key
PIN Personal Identification Number
PL Preferred Languages
PS Packet switched
PSDK Public Safety Discovery Key
PS_DO PIN Status Data Object
PSM Power Saving Mode
PTK ProSe Traffic Key
RAND Random challenge
RAND~MS~ Random challenge stored in the USIM
RES User response
RFU Reserved for Future Use
RLOS Restricted Local Operator Services
RST Reset
SDN Service dialling number
SE Security Environment
SEQp Sequence number for MGV-F stored in the USIM
SFI Short EF Identifier
SGSN Serving GPRS Support Node
SN Serving Network
SNPN Standalone Non-Public Network
SoLSA Support of Localised Service Areas
SOR-CMCI Steering of roaming connected mode control information
SQN Sequence number
SRES Signed RESponse calculated by a USIM
SUCI Subscription Concealed Identifier
SUPI Subscription Permanent Identifier
SW Status Word
TLV Tag Length Value
TMGI Temporary Mobile Group Identity
TV Television
UAC Unified Access Control
URSP UE Route Selection Policy
USAT USIM Application Toolkit
USD User Service Description
USIM Universal Subscriber Identity Module
V2X Vehicle-to-Everything
VLR Visitor Location Register
WLAN Wireless Local Area Network
WSID WLAN Specific Identifier
XRES Expected user RESponse
## 3.4 Coding Conventions
The following coding conventions apply to the present document.
All lengths are presented in bytes, unless otherwise stated. Each byte is
represented by bits b8 to b1, where b8 is the most significant bit (MSB) and
b1 is the least significant bit (LSB). In each representation, the leftmost
bit is the MSB.
The coding of Data Objects in the present document is according to TS 31.101
[11].
\'XX\': Single quotes indicate hexadecimal values. Valid elements for
hexadecimal values are the numbers \'0\' to \'9\' and \'A\' to \'F\'.
# 4 Contents of the Files
This clause specifies the Efs for the 3GPP session defining access conditions,
data items and coding. A data item is a part of an EF which represents a
complete logical entity, e.g. the alpha tag in an EF~ADN~ record.
A file is associated with attributes that depending of the file type indicates
how data is to be accessed e.g. file size, record length etc. Although in the
present document some files and data items stored in a file are indicated as
having a fixed length; when reading such structures the terminal shall derive
the length of the data item from the attributes provided in the file
information i.e. not use the fixed value specified for the file in the present
document. Although the terminal is able to read the entire structure it should
only use those elements in the data item which is recognised by the terminal.
For any EF, when the SFI is not indicated in the description of the file it is
not allowed to assign an SFI. If in the description of the file an SFI value
is indicated the file shall support SFI. The SFI value shall be assigned by
the card issuer. It is mandatory for Efs stating an SFI value (\'YY\') in the
description of their structure to provide an SFI. For files where in the file
description the SFI is indicated as \'Optional\' the file may support an SFI.
For an overview containing all files see figures 4.1 and 4.2.
## 4.1 Contents of the EFs at the MF level
The EFs at the Master File (MF) level are specified in TS 31.101 [11].
The information in EF~PL~ may be used by the ME for MMI purposes.
This information may also be used for the screening of Cell Broadcast messages
in a preferred language, as follows.
When the CB Message Identifier capability is available, the ME selects only
those CB messages the language of which corresponds to an entry in this EF or
in EF~LI,~ whichever of these Efs is used (see clause 5.1.1). The CB message
language is defined by the Data Coding Scheme (see TS 23.038 [5]) received
with the CB message. The ME shall be responsible for translating the language
coding indicated in the Data Coding Scheme for the Cell Broadcast Service (as
defined in TS 23.038 [5]) to the language coding as defined in ISO 639 [19] if
it is necessary to check the language coding in EF~PL~.
## 4.2 Contents of files at the USIM ADF (Application DF) level
The Efs in the USIM ADF contain service and network related information.
The File Ids \'6F1X\' (for Efs), \'5F1X\' and \'5F2X\' (for DFs) with X
ranging from \'0\' to \'F\' are reserved under the USIM ADF for administrative
use by the card issuer.
### 4.2.1 EF~LI~ (Language Indication)
This EF contains the codes for one or more languages. This information,
determined by the user/operator, defines the preferred languages of the user
in order of priority. This information may be used by the ME for MMI purposes.
This information may also be used for the screening of Cell Broadcast messages
in a preferred language, as follows.
When the CB Message Identifier capability is available, the ME selects only
those CB messages the language of which corresponds to an entry in this EF or
in EF~PL,~ whichever of these Efs is used (see clause 5.1.1). The CB message
language is defined by the Data Coding Scheme (DCS: see TS 23.038 [5])
received with the CB message. The ME shall be responsible for translating the
language coding indicated in the Data Coding Scheme for the Cell Broadcast
Service (as defined in TS 23.038 [5]) to the language coding as defined in ISO
639 [19] if it is necessary to check the language coding in EF~PL~.
+----------------------+----------------------+----------+---------+ | Identifier: \'6F | Structure: | Optional | | | 05\' | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'02\' | | | | +----------------------+----------------------+----------+---------+ | File size: 2n bytes, | Update activity: low | | | | (n ≥ 1) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 2 | 1^st^ language code | M | 2 bytes | | | (highest priority). | | | +----------------------+----------------------+----------+---------+ | 3 to 4 | 2^nd^ language code | O | 2 bytes | +----------------------+----------------------+----------+---------+ | 2n-1 to 2n | N^th^ language code | O | 2 bytes | | | (lowest priority). | | | +----------------------+----------------------+----------+---------+
Coding:
each language code is a pair of alpha-numeric characters, defined in ISO 639
[19]. Each alpha-numeric character shall be coded on one byte using the SMS
default 7-bit coded alphabet as defined in TS 23.038 [5] with bit 8 set to 0.
Unused language entries shall be set to \'FF FF\'.
### 4.2.2 EF~IMSI~ (IMSI)
If service n°130 is \"available\", this file shall not be available.
This EF contains the International Mobile Subscriber Identity (IMSI).
+----------------------+------------------------+----------+---------+ | Identifier: \'6F07\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+---------+ | SFI: \'07\' | | | | +----------------------+------------------------+----------+---------+ | File size: 9 bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 | Length of IMSI | M | 1 byte | +----------------------+------------------------+----------+---------+ | 2 to 9 | IMSI | M | 8 bytes | +----------------------+------------------------+----------+---------+
\- Length of IMSI
Contents:
\- the length indicator refers to the number of significant bytes, not
including this length byte, required for the IMSI.
Coding:
\- according to TS 24.008 [9].
‑ IMSI
Contents:
\- International Mobile Subscriber Identity.
Coding:
\- this information element is of variable length. If a network operator
chooses an IMSI of less than 15 digits, unused nibbles shall be set to \'F\'.
Byte 2:
* * *
        b8   B7   b6   B5   b4   b3   b2   b1   
                                                1
                                                0
                                                0
                                                Parity
                                                LSB of Digit 1
                                                :
                                                :
                                                MSB of Digit 1
* * *
For the parity bit, see TS 24.008 [9].
Byte 3:
* * *
        b8   b7   b6   B5   b4   b3   b2   b1   
                                                LSB of Digit 2
                                                :
                                                :
                                                MSB of Digit 2
                                                LSB of Digit 3
                                                :
                                                :
                                                MSB of Digit 3
* * *
etc.
### 4.2.3 EF~Keys~ (Ciphering and Integrity Keys)
This EF contains the ciphering key CK, the integrity key IK and the key set
identifier KSI.
+----------------------+------------------------+-----------+----------+ | Identifier: \'6F08\' | Structure: transparent | Mandatory | | +----------------------+------------------------+-----------+----------+ | SFI: \'08\' | | | | +----------------------+------------------------+-----------+----------+ | File size: 33 bytes | Update activity: high | | | +----------------------+------------------------+-----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+-----------+----------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+-----------+----------+ | 1 | Key set identifier KSI | M | 1 byte | +----------------------+------------------------+-----------+----------+ | 2 to 17 | Ciphering key CK | M | 16 bytes | +----------------------+------------------------+-----------+----------+ | 18 to 33 | Integrity key IK | M | 16 bytes | +----------------------+------------------------+-----------+----------+
\- Key Set Identifier KSI.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                KSI
                                                bits b4 to b8 are coded 0
* * *
‑ Ciphering key CK.
Coding:
\- the least significant bit of CK is the least significant bit of the 17^th^
byte. The most significant bit of CK is the most significant bit of the 2^nd^
byte.
‑ Integrity key IK.
Coding:
\- the least significant bit of IK is the least significant bit of the 33^rd^
byte. The most significant bit of IK is the most significant bit of the 18^th^
byte.
### 4.2.4 EF~KeysPS~ (Ciphering and Integrity Keys for Packet Switched domain)
This EF contains the ciphering key CKPS, the integrity key IKPS and the key
set identifier KSIPS for the packet switched (PS) domain.
+----------------------+--------------------------+-----------+----------+ | Identifier: \'6F09\' | Structure: transparent | Mandatory | | +----------------------+--------------------------+-----------+----------+ | SFI: \'09\' | | | | +----------------------+--------------------------+-----------+----------+ | File size: 33 bytes | Update activity: high | | | +----------------------+--------------------------+-----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------+-----------+----------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------+-----------+----------+ | 1 | Key set identifier KSIPS | M | 1 byte | +----------------------+--------------------------+-----------+----------+ | 2 to 17 | Ciphering key CKPS | M | 16 bytes | +----------------------+--------------------------+-----------+----------+ | 18 to 33 | Integrity key IKPS | M | 16 bytes | +----------------------+--------------------------+-----------+----------+
\- Key Set Identifier KSIPS.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                KSIPS
                                                bits b4 to b8 are coded 0
* * *
‑ Ciphering key CKPS.
Coding:
\- the least significant bit of CKPS is the least significant bit of the
17^th^ byte. The most significant bit of CKPS is the most significant bit of
the 2^nd^ byte.
‑ Integrity key IKPS.
Coding:
\- the least significant bit of IKPS is the least significant bit of the
33^rd^ byte. The most significant bit of IKPS is the most significant bit of
the 18^th^ byte.
### 4.2.5 EF~PLMNwAcT~ (User controlled PLMN selector with Access Technology)
If service n° 20 is \"available\", this file shall be present.
This EF contains the coding for n PLMNs, where n is at least eight. This
information is determined by the user and defines the preferred PLMNs of the
user in priority order. The first record indicates the highest priority and
the n^th^ record indicates the lowest. The EF also contains the Access
Technologies for each PLMN in this list. (see TS 23.122 [31])
+----------------------+----------------------+----------+---------+ | Identifier: \'6F60\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'0A\' | | | | +----------------------+----------------------+----------+---------+ | File size: 5n bytes | Update activity: low | | | | (where n ≥8) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | 1^st^ PLMN (highest | M | 3 bytes | | | priority) | | | +----------------------+----------------------+----------+---------+ | 4 to 5 | 1^st^ PLMN Access | M | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | 6 to 8 | 2^nd^ PLMN | M | 3 bytes | +----------------------+----------------------+----------+---------+ | 9 to 10 | 2^nd^ PLMN Access | M | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | : | : | | | +----------------------+----------------------+----------+---------+ | 36 to 38 | 8^th^ PLMN | M | 3 bytes | +----------------------+----------------------+----------+---------+ | 39 to 40 | 8^th^ PLMN Access | M | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | 41 to 43 | 9^th^ PLMN | O | 3 bytes | +----------------------+----------------------+----------+---------+ | 44 to 45 | 9^th^ PLMN Access | O | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | : | : | | | +----------------------+----------------------+----------+---------+ | (5n-4) to (5n‑2) | N^th^ PLMN (lowest | O | 3 bytes | | | priority) | | | +----------------------+----------------------+----------+---------+ | (5n-1) to 5n | N^th^ PLMN Access | O | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+
‑ PLMN
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- according to TS 24.008 [9].
\- Access Technology Identifier:
Coding:
\- 2 bytes are used to select the access technology where the meaning of each
bit is as follows:
\- bit = 1: access technology selected;
\- bit = 0: access technology not selected.
Byte5 n-1:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                satellite E-UTRAN in NB-S1 mode
                                                satellite E-UTRAN in WB-S1 mode
                                                satellite NG-RAN
                                                NG-RAN
                                                E-UTRAN in NB-S1 mode (see table 4.2.5.1 below)
                                                E-UTRAN in WB-S1 mode (see table 4.2.5.1 below)
                                                E-UTRAN (see table below)
                                                UTRAN
NOTE 1: NG-RAN refers to E-UTRA or NR connected to 5GCN.
Table 4.2.5.1: Coding of the E-UTRAN
* * *
b7 b6 b5 Description 0 x x E-UTRAN not selected 1 0 0 E-UTRAN in WB-S1 mode
and NB-S1 mode 1 0 1 E-UTRAN in NB-S1 mode only 1 1 0 E-UTRAN in WB-S1 mode
only 1 1 1 E-UTRAN in WB-S1 mode and NB-S1 mode
* * *
NOTE 2: E-UTRAN refers to E-UTRA connected to EPC.
Byte 5n:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                RFU
                                                RFU
                                                GSM (see table 4.2.5.2 below)
                                                EC-GSM-IoT (see table 4.2.5.2 below)
                                                cdma2000 1xRTT
                                                cdma2000 HRPD
                                                GSM COMPACT
                                                GSM (see table 4.2.5.2 below)
* * *
Table 4.2.5.2: Coding of the GSM
* * *
b8 b4 b3 Description 0 x x GSM and EC-GSM-IoT not selected 1 0 0 GSM and EC-
GSM-IoT 1 0 1 GSM without EC-GSM-IoT 1 1 0 EC-GSM-IoT only 1 1 1 GSM and EC-
GSM-IoT
* * *
### 4.2.6 EF~HPPLMN~ (Higher Priority PLMN search period)
This EF contains the interval of time between searches for a higher priority
PLMN (see 3GPP TS 23.122 [31]).
+----------------------+------------------------+-----------+--------+ | Identifier: \'6F31\' | Structure: transparent | Mandatory | | +----------------------+------------------------+-----------+--------+ | SFI: \'12\' | | | | +----------------------+------------------------+-----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+------------------------+-----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+-----------+--------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+-----------+--------+ | 1 | Time interval | M | 1 byte | +----------------------+------------------------+-----------+--------+
‑ Time interval.
Contents:
the time interval between two searches.
Coding:
For UEs not using any of the following at the time of starting the timer: NB-
IoT, GERAN EC-GSM-IoT and Category M1 of E-UTRAN enhanced-MTC as specified in
3GPP TS 36.306 [85], the time interval is coded in integer multiples of n
minutes. The range is from n minutes to a maximum value. The encoding is:
‑ \'00\': No higher priority PLMN search attempts;
‑ \'01\': n minutes;
‑ \'02\': 2n minutes;
‑ : :
‑ \'YZ\': (16Y+Z)n minutes (maximum value).
For UEs using any of the following at the time of starting the timer: NB-IoT,
GERAN EC-GSM-IoT and Category M1 of E-UTRAN enhanced-MTC as specified in 3GPP
TS 36.306 [85], the time interval is coded as follows. The range is from n
hours to a maximum value. The encoding is:
‑ \'00\': No higher priority PLMN search attempts;
‑ \'01\': n hours (2 hours);
‑ \'02\' to \'28\': 2n hours (i.e. range from 4 hours to 80 hours with step of
2 hours);
‑ \'29\' to \'50\': 4n-80 hours (i.e. range from 84 hours to 240 hours with
step of 4 hours).
\- All other values shall be interpreted by the ME as a default period.
For specification of the integer timer interval n, the maximum value and the
default period refer to 3GPP TS 23.122 [31].
NOTE 1: Care should be taken in the configuration of this EF, as the value
stored can be interpreted in different ways depending on the type of device
and radio technology used by the device.
NOTE 2: If EF~MCHPPLMN~ is configured as per clause 4.4.11.20, the time
interval between two searches for a higher priority PLMN (see 3GPP TS 23.122
[31]) is calculated by multiplying the time interval configured in EF~HPPLMN~
and the multiplier coefficient configured in EF~MCHPPLMN.~
### 4.2.7 EF~ACMmax~ (ACM maximum value)
If service n° 13 is \"available\", this file shall be present.
This EF contains the maximum value of the accumulated call meter.
+----------------------+----------------------+----------+---------+ | Identifier: \'6F37\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: 3 bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/PIN2 | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | Maximum value | M | 3 bytes | +----------------------+----------------------+----------+---------+
‑ Maximum value.
Contents:
\- maximum value of the Accumulated Call Meter (ACM).
Coding:
First byte:
* * *
        b8    b7    b6    b5    b4    b3    b2    b1
        223   222   221   220   219   218   217   216
* * *
Second byte:
* * *
        b8    b7    b6    b5    b4    b3    b2   b1
        215   214   213   212   211   210   29   28
* * *
Third byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
        27   26   25   24   23   22   21   20
* * *
For instance, \'00\' \'00\' \'30\' represents 25+24.
All ACM data is stored in the USIM and transmitted over the USIM/ME interface
as binary.
ACMmax is not valid, as defined in TS 22.024 [3], if it is coded \'000000\'.
If a GSM application is present on the UICC and the ACMmax value is to be
shared between the GSM and the USIM application this file shall be shared
between the two applications.
### 4.2.8 EF~UST~ (USIM Service Table)
This EF indicates which services are available. If a service is not indicated
as available in the USIM, the ME shall not select this service.
+-----------------------------+---------------------------+-----------+--------+ | Identifier: \'6F38\' | Structure: transparent | Mandatory | | +-----------------------------+---------------------------+-----------+--------+ | SFI: \'04\' | | | | +-----------------------------+---------------------------+-----------+--------+ | File size: X bytes, (X ≥ 1) | Update activity: low | | | +-----------------------------+---------------------------+-----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+---------------------------+-----------+--------+ | Bytes | Description | M/O | Length | +-----------------------------+---------------------------+-----------+--------+ | 1 | Services n1 to n8 | M | 1 byte | +-----------------------------+---------------------------+-----------+--------+ | 2 | Services n9 to n16 | O | 1 byte | +-----------------------------+---------------------------+-----------+--------+ | 3 | Services n17 to n24 | O | 1 byte | +-----------------------------+---------------------------+-----------+--------+ | 4 | Services n25 to n32 | O | 1 byte | +-----------------------------+---------------------------+-----------+--------+ | etc. | | | | +-----------------------------+---------------------------+-----------+--------+ | X | Services n(8X‑7) to n(8X) | O | 1 byte | +-----------------------------+---------------------------+-----------+--------+
* * *
‑Services  
Contents: Service n°1: Local Phone Book Service n°2: Fixed Dialling Numbers
(FDN) Service n°3: Extension 2 Service n°4: Service Dialling Numbers (SDN)
Service n°5: Extension3 Service n°6: Barred Dialling Numbers (BDN) Service
n°7: Extension4 Service n°8: Outgoing Call Information (OCI and OCT) Service
n°9: Incoming Call Information (ICI and ICT) Service n°10: Short Message
Storage (SMS) Service n°11: Short Message Status Reports (SMSR) Service n°12:
Short Message Service Parameters (SMSP) Service n°13: Advice of Charge (AoC)
Service n°14: Capability Configuration Parameters 2 (CCP2) Service n°15: Cell
Broadcast Message Identifier Service n°16: Cell Broadcast Message Identifier
Ranges Service n°17: Group Identifier Level 1 Service n°18: Group Identifier
Level 2 Service n°19: Service Provider Name Service n°20: User controlled PLMN
selector with Access Technology Service n°21: MSISDN Service n°22: Image (IMG)
Service n°23: Support of Localised Service Areas (SoLSA) Service n°24:
Enhanced Multi‑Level Precedence and Pre‑emption Service Service n°25:
Automatic Answer for eMLPP Service n°26: RFU Service n°27: GSM Access Service
n°28: Data download via SMS-PP Service n°29: Data download via SMS‑CB Service
n°30: Call Control by USIM Service n°31: MO-SMS Control by USIM Service n°32:
RUN AT COMMAND command Service n°33: shall be set to \'1\' Service n°34:
Enabled Services Table Service n°35: APN Control List (ACL) Service n°36:
Depersonalisation Control Keys Service n°37: Co-operative Network List Service
n°38: GSM security context Service n°39: CPBCCH Information Service n°40:
Investigation Scan Service n°41: MexE Service n°42: Operator controlled PLMN
selector with Access Technology Service n°43: HPLMN selector with Access
Technology Service n°44: Extension 5 Service n°45: PLMN Network Name Service
n°46: Operator PLMN List Service n°47: Mailbox Dialling Numbers Service n°48:
Message Waiting Indication Status Service n°49: Call Forwarding Indication
Status Service n°50: Reserved and shall be ignored Service n°51: Service
Provider Display Information Service n°52 Multimedia Messaging Service (MMS)
Service n°53 Extension 8 Service n°54 Call control on GPRS by USIM Service
n°55 MMS User Connectivity Parameters Service n°56 Network\'s indication of
alerting in the MS (NIA) Service n°57 VGCS Group Identifier List (EF~VGCS~ and
EF~VGCSS~) Service n°58 VBS Group Identifier List (EF~VBS~ and EF~VBSS~)
Service n°59 Pseudonym Service n°60 User Controlled PLMN selector for I-WLAN
access Service n°61 Operator Controlled PLMN selector for I-WLAN access
Service n°62 User controlled WSID list Service n°63 Operator controlled WSID
list Service n°64 VGCS security Service n°65 VBS security Service n°66 WLAN
Reauthentication Identity Service n°67 Multimedia Messages Storage Service
n°68 Generic Bootstrapping Architecture (GBA) Service n°69 MBMS security
Service n°70 Data download via USSD and USSD application mode Service n°71
Equivalent HPLMN Service n°72 Additional TERMINAL PROFILE after UICC
activation Service n°73 Equivalent HPLMN Presentation Indication Service n°74
Last RPLMN Selection Indication Service n°75 OMA BCAST Smart Card Profile
Service n°76 GBA-based Local Key Establishment Mechanism Service n°77 Terminal
Applications Service n°78 Service Provider Name Icon Service n°79 PLMN Network
Name Icon Service n°80 Connectivity Parameters for USIM IP connections Service
n°81 Home I-WLAN Specific Identifier List Service n°82 I-WLAN Equivalent HPLMN
Presentation Indication Service n°83 I-WLAN HPLMN Priority Indication Service
n°84 I-WLAN Last Registered PLMN Service n°85 EPS Mobility Management
Information Service n°86 Allowed CSG Lists and corresponding indications
Service n°87 Call control on EPS PDN connection by USIM Service n°88 HPLMN
Direct Access Service n°89 eCall Data Service n°90 Operator CSG Lists and
corresponding indications Service n°91 Support for SM-over-IP Service n°92
Support of CSG Display Control Service n°93 Communication Control for IMS by
USIM Service n°94 Extended Terminal Applications Service n°95 Support of UICC
access to IMS Service n°96 Non-Access Stratum configuration by USIM Service
n°97 PWS configuration by USIM Service n°98 RFU Service n°99 URI support by
UICC Service n°100 Extended EARFCN support Service n°101 ProSe Service n°102
USAT Application Pairing Service n°103 Media Type support Service n°104 IMS
call disconnection cause Service n°105 URI support for MO SHORT MESSAGE
CONTROL Service n°106 ePDG configuration Information support Service n°107
ePDG configuration Information configured Service n°108 ACDC support Service
n°109 Mission Critical Services Service n°110 ePDG configuration Information
for Emergency Service support Service n°111 ePDG configuration Information for
Emergency Service configured Service n°112 eCall Data over IMS Service n°113
URI support for SMS-PP DOWNLOAD as defined in 3GPP TS 31.111 [12] Service
n°114 From Preferred Service n°115 IMS configuration data Service n°116 TV
configuration Service n°117 3GPP PS Data Off Service n°118 3GPP PS Data Off
Service List Service n°119 V2X Service n°120 XCAP Configuration Data Service
n°121 EARFCN list for MTC/NB-IOT UEs Service n°122 5GS Mobility Management
Information Service n°123 5G Security Parameters Service n°124 Subscription
identifier privacy support Service n°125 SUCI calculation by the USIM Service
n°126 UAC Access Identities support Service n°127 Control plane-based steering
of UE in VPLMN Service n°128 Call control on PDU Session by USIM Service n°129
5GS Operator PLMN List Service n°130 Support for SUPI of type NSI or GLI or
GCI Service n°131 3GPP PS Data Off separate Home and Roaming lists Service
n°132 Support for URSP by USIM Service n°133 5G Security Parameters extended
Service n°134 MuD and MiD configuration data Service n°135 Support for Trusted
non-3GPP access networks by USIM Service n°136 Support for multiple records of
NAS security context storage for multiple registration Service n°137 Pre-
configured CAG information list Service n°138 SOR-CMCI storage in USIM Service
n°139 5G ProSe Service n°140 Storage of disaster roaming information in USIM
Service n°141 Pre-configured eDRX parameters Service n°142 5G NSWO support
Service n°143 PWS configuration for SNPN in USIM Service n°144 Multiplier
Coefficient for Higher Priority PLMN search via NG-RAN satellite access
Service n°145 K~AUSF~ derivation configuration Service n°146 Network
Identifier for SNPN (NID)
* * *
The EF shall contain at least one byte. Further bytes may be included, but if
the EF includes an optional byte, then it is mandatory for the EF to also
contain all bytes before that byte. Other services are possible in the future
and will be coded on further bytes in the EF. The coding falls under the
responsibility of the 3GPP.
Service n°46 can only be declared \"available\" if service n°45 is declared
\"available\".
Service n°95, n°99 and n°115 shall not be declared \"available\" if an ISIM
application is present on the UICC.
Service n°125 shall only be taken into account if Service n°124 is declared
\"available\". If Service n°124 and Service n°125 are declared \"available\",
the \"SUCI calculation is to be performed by the USIM\". If Service n°124 is
declared \"available\" and Service n°125 is not declared \"available\", the
\"SUCI calculation is to be performed by the ME\".
Coding:
1 bit is used to code each service:\ bit = 1: service available;\ bit = 0:
service not available.
\- Service available means that the USIM has the capability to support the
service and that the service is available for the user of the USIM unless the
service is identified as \"disabled\" in EF~EST~.\ Service not available means
that the service shall not be used by the USIM user, even if the USIM has the
capability to support the service.
First byte:
* * *
        b8   b7   b6   B5   B4   b3   b2   b1   
                                                Service n°1
                                                Service n°2
                                                Service n°3
                                                Service n°4
                                                Service n°5
                                                Service n°6
                                                Service n°7
                                                Service n°8
* * *
Second byte:
* * *
        b8   b7   b6   B5   B4   b3   b2   b1   
                                                Service n°9
                                                Service n°10
                                                Service n°11
                                                Service n°12
                                                Service n°13
                                                Service n°14
                                                Service n°15
                                                Service n°16
* * *
etc.
### 4.2.9 EF~ACM~ (Accumulated Call Meter)
If service n° 13 is \"available\", this file shall be present.
This EF contains the total number of units for both the current call and the
preceding calls.
NOTE: The information may be used to provide an indication to the user for
advice or as a basis for the calculation of the monetary cost of calls (see TS
22.086 [15]).
+----------------------+----------------------+----------+---------+ | Identifier: \'6F39\' | Structure: cyclic | Optional | | +----------------------+----------------------+----------+---------+ | SFI: Optional | | | | +----------------------+----------------------+----------+---------+ | Record length: 3 | Update activity: | | | | bytes | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/PIN2 | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | INCREASE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | Accumulated count of | M | 3 bytes | | | units | | | +----------------------+----------------------+----------+---------+ | NOTE: If a SFI is | | | | | assigned, the | | | | | recommended value is | | | | | \'1C\'. However | | | | | cards may exist that | | | | | indicate another | | | | | value. Therefore the | | | | | terminal shall be | | | | | able to handle other | | | | | values. | | | | +----------------------+----------------------+----------+---------+
‑ Accumulated count of units
Contents:
value of the ACM.
Coding:
see the coding of EF~ACMmax~.
If a GSM application is present on the UICC and the ACM value is to be shared
between the GSM and the USIM application this file shall be shared between the
two applications.
### 4.2.10 EF~GID1~ (Group Identifier Level 1)
If service n° 17 is \"available\", this file shall be present.
This EF contains identifiers for particular USIM‑ME associations. It can be
used to identify a group of USIMs for a particular application.
+----------------------+--------------------------+----------+---------+ | Identifier: \'6F3E\' | Structure: transparent | Optional | | +----------------------+--------------------------+----------+---------+ | File size: n bytes | Update activity: low | | | +----------------------+--------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------+----------+---------+ | 1 to n | USIM group identifier(s) | O | n bytes | +----------------------+--------------------------+----------+---------+
### 4.2.11 EF~GID2~ (Group Identifier Level 2)
If service n° 18 is \"available\", this file shall be present.
This EF contains identifiers for particular USIM‑ME associations. It can be
used to identify a group of USIMs for a particular application.
+----------------------+--------------------------+----------+---------+ | Identifier: \'6F3F\' | Structure: transparent | Optional | | +----------------------+--------------------------+----------+---------+ | File size: n bytes | Update activity: low | | | +----------------------+--------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------+----------+---------+ | 1 to n | USIM group identifier(s) | O | n bytes | +----------------------+--------------------------+----------+---------+
NOTE: The structure of EF~GID1~ and EF~GID2~ is identical. They are provided
to allow the network operator to enforce different levels of security
dependant on an application.
### 4.2.12 EF~SPN~ (Service Provider Name)
If service n° 19 is \"available\", this file shall be present.
This EF contains the service provider name in text format and appropriate
requirements for the display by the ME. The service provider name may also be
provided in a graphical format in EF~SPNI~. The ME shall use the service
provider name in the text format or the graphical format or both to display
the service provider name according to the rules defined in clause 4.2.88.
+----------------------+------------------------+----------+----------+ | Identifier: \'6F46\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+----------+ | File Size: 17 bytes | Update activity: low | | | +----------------------+------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+----------+ | 1 | Display Condition | M | 1 byte | +----------------------+------------------------+----------+----------+ | 2 to 17 | Service Provider Name | M | 16 bytes | +----------------------+------------------------+----------+----------+
‑ Display Condition
Contents: display condition for the service provider name in respect to the
registered PLMN (see TS 22.101 [24]).
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0: display of registered PLMN name not required when registered PLMN is either HPLMN or a PLMN in the service provider PLMN list (see EFSPDI). B1=1: display of registered PLMN name required when registered PLMN is either HPLMN or a PLMN in the service provider PLMN list(see EFSPDI).  
|  |  |  |  |  |  |  |  |  | B2=0: display of the service provider name is required when registered PLMN is neither HPLMN nor a PLMN in the service provider PLMN list(see EFSPDI). B2=1: display of the service provider name is not required when registered PLMN is neither HPLMN nor a PLMN in the service provider PLMN list(see EFSPDI).  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101)  
‑ Service Provider Name
Contents:
service provider string
Coding:
the string shall use:
\- either the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5]
with bit 8 set to 0. The string shall be left justified. Unused bytes shall be
set to \'FF\'.
\- or one of the UCS2 code options defined in the annex of TS 31.101 [11].
### 4.2.13 EF~PUCT~ (Price per Unit and Currency Table)
If service n° 13 is \"available\", this file shall be present.
This EF contains the Price per Unit and Currency Table (PUCT). The PUCT is
Advice of Charge related information which may be used by the ME in
conjunction with EF~ACM~ to compute the cost of calls in the currency chosen
by the subscriber, as specified in TS 22.024 [3].
+----------------------+----------------------+----------+---------+ | Identifier: \'6F41\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: 5 bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/PIN2 | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | Currency code | M | 3 bytes | +----------------------+----------------------+----------+---------+ | 4 to 5 | Price per unit | M | 2 bytes | +----------------------+----------------------+----------+---------+
‑ Currency code
Contents:
the alpha‑identifier of the currency code.
Coding:
bytes 1, 2 and 3 are the respective first, second and third character of the
alpha identifier. This alpha‑tagging shall use the SMS default 7‑bit coded
alphabet as defined in TS 23.038 [5] with bit 8 set to 0.
‑ Price per unit
Contents:
price per unit expressed in the currency coded by bytes 1 to 3.
Coding:
byte 4 and bits b1 to b4 of byte 5 represent the Elementary Price per Unit
(EPPU) in the currency coded by bytes 1 to 3. Bits b5 to b8 of byte 5 are the
decimal logarithm of the multiplicative factor represented by the absolute
value of its decimal logarithm (EX) and the sign of EX, which is coded 0 for a
positive sign and 1 for a negative sign.
Byte 4:
* * *
        b8    b7    b6   b5   b4   B3   b2   b1
        211   210   29   28   27   26   25   24   of EPPU
* * *
Byte 5:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
                            23   22   21   20   of EPPU
                                                Sign of EX
                                                20 of Abs(EX)
                                                21 of Abs(EX)
                                                22 of Abs(EX)
* * *
\- The computation of the price per unit value is made by the ME in compliance
with TS 22.024 [3] by the following formula:
price per unit = EPPU * 10EX.
\- The price has to be understood as expressed in the coded currency.
If a GSM application is present on the UICC and the PUCT information is to be
shared between the GSM and the USIM application, then this file shall be
shared between the two applications.
### 4.2.14 EF~CBMI~ (Cell Broadcast Message identifier selection)
If service n° 15 is \"available\", this file shall be present.
This EF contains the Message Identifier Parameters which specify the type of
content of the cell broadcast messages that the subscriber wishes the UE to
accept.
Any number of CB Message Identifier Parameters may be stored in the USIM. No
order of priority is applicable.
+----------------------+-------------------------+----------+---------+ | Identifier: \'6F45\' | Structure: transparent | Optional | | +----------------------+-------------------------+----------+---------+ | File size: 2 n bytes | Update activity: low | | | +----------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-------------------------+----------+---------+ | 1 to 2 | CB Message Identifier 1 | O | 2 bytes | +----------------------+-------------------------+----------+---------+ | 3 to 4 | CB Message Identifier 2 | O | 2 bytes | +----------------------+-------------------------+----------+---------+ | : | : | : | : | +----------------------+-------------------------+----------+---------+ | 2n‑1 to 2n | CB Message Identifier n | O | 2 bytes | +----------------------+-------------------------+----------+---------+
‑ Cell Broadcast Message Identifier
Coding:
\- as in TS 23.041 [16], \"Message Format on BTS‑MS Interface ‑ Message
Identifier\";
\- values listed show the types of message which shall be accepted by the UE;
\- unused entries shall be set to \'FF FF\'.
### 4.2.15 EF~ACC~ (Access Control Class)
This EF contains the assigned access control class(es). The access control
class is a parameter to control the access attempts. 15 classes are split into
10 classes randomly allocated to normal subscribers and 5 classes allocated to
specific high priority users. For more information see TS 22.011 [2].
+----------------------+------------------------+-----------+---------+ | Identifier: \'6F78\' | Structure: transparent | Mandatory | | +----------------------+------------------------+-----------+---------+ | SFI: \'06\' | | | | +----------------------+------------------------+-----------+---------+ | File size: 2 bytes | Update activity: low | | | +----------------------+------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+-----------+---------+ | 1 to 2 | Access control classes | M | 2 bytes | +----------------------+------------------------+-----------+---------+
‑ Access control classes
Coding:
\- each ACC is coded on one bit. An ACC is \"allocated\" if the corresponding
bit is set to 1 and \"not allocated\" if this bit is set to 0. Bit b3 of byte
1 is set to 0.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
        15   14   13   12   11   10   09   08   Number of the ACC (except for bit b3)
* * *
Byte 2:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
        07   06   05   04   03   02   01   00   Number of the ACC
* * *
### 4.2.16 EF~FPLMN~ (Forbidden PLMNs)
This EF contains the coding for n Forbidden PLMNs (FPLMN). It is read by the
ME as part of the USIM initialization procedure and indicates PLMNs which the
UE shall not automatically attempt to access.
A PLMN is written to the EF if a network rejects a Location Update with the
cause \"PLMN not allowed\". The ME shall manage the list as follows.
When n FPLMNs are held in the EF, and rejection of a further PLMN is received
by the ME from the network, the ME shall modify the EF using the UPDATE
command. This new PLMN shall be stored in the n^th^ position, and the existing
list \"shifted\" causing the previous contents of the first position to be
lost.
When less than n FPLMNs exist in the EF, storage of an additional FPLMN shall
not cause any existing FPLMN to be lost.
Dependent upon procedures used to manage storage and deletion of FPLMNs in the
EF, it is possible, when less than n FPLMNs exist in the EF, for \'FFFFFF\' to
occur in any position. The ME shall analyse all the EF for FPLMNs in any
position, and not regard \'FFFFFF\' as a termination of valid data.
+-----------------------------+------------------------+-----------+---------+ | Identifier: \'6F7B\' | Structure: transparent | Mandatory | | +-----------------------------+------------------------+-----------+---------+ | SFI: \'0D\' | | | | +-----------------------------+------------------------+-----------+---------+ | File size: 3n bytes, (n≥ 4) | Update activity: low | | | +-----------------------------+------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +-----------------------------+------------------------+-----------+---------+ | 1 to 3 | PLMN 1 | M | 3 bytes | +-----------------------------+------------------------+-----------+---------+ | 4 to 6 | PLMN 2 | M | 3 bytes | +-----------------------------+------------------------+-----------+---------+ | 7 to 9 | PLMN 3 | M | 3 bytes | +-----------------------------+------------------------+-----------+---------+ | 10 to 12 | PLMN 4 | M | 3 bytes | +-----------------------------+------------------------+-----------+---------+ | : | : | : | : | +-----------------------------+------------------------+-----------+---------+ | (3n-2) to 3n | PLMN n | O | 3 bytes | +-----------------------------+------------------------+-----------+---------+
‑ PLMN
Contents:
Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
according to TS 24.008 [9].
For instance, using 246 for the MCC and 81 for the MNC and if this is stored
in PLMN 3 the contents is as follows:
Bytes 7 to 9: \'42\' \'F6\' \'18\'.
If storage for fewer than n PLMNs is required, the unused bytes shall be set
to \'FF\'.
### 4.2.17 EF~LOCI~ (Location Information)
This EF contains the following Location Information:
‑ Temporary Mobile Subscriber Identity (TMSI);
‑ Location Area Information (LAI);
‑ Location update status.
See clause 5.2.5 for special requirements when updating EF~LOCI~.
+----------------------+------------------------+-----------+---------+ | Identifier: \'6F7E\' | Structure: transparent | Mandatory | | +----------------------+------------------------+-----------+---------+ | SFI: \'0B\' | | | | +----------------------+------------------------+-----------+---------+ | File size: 11 bytes | Update activity: high | | | +----------------------+------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+-----------+---------+ | 1 to 4 | TMSI | M | 4 bytes | +----------------------+------------------------+-----------+---------+ | 5 to 9 | LAI | M | 5 bytes | +----------------------+------------------------+-----------+---------+ | 10 | RFU | M | 1 byte | +----------------------+------------------------+-----------+---------+ | 11 | Location update status | M | 1 byte | +----------------------+------------------------+-----------+---------+
‑ TMSI
Contents:\ Temporary Mobile Subscriber Identity.
Coding:\ according to TS 24.008 [9].
* * *
        B8    b7   b6   b5   b4   B3   b2   b1
        MSB
* * *
‑ LAI
Contents:\ Location Area Information.
Coding:\ according to TS 24.008 [9].
Byte 5: first byte of LAI
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
‑ Location update status
Contents:\ status of location update according to TS 24.008 [9].
Coding:
Byte 11:
Bits: b3 b2 b1
0 0 0 : updated.
0 0 1 : not updated.
0 1 0 : PLMN not allowed.
0 1 1 : Location Area not allowed.
1 1 1 : reserved.
Bits b4 to b8 are RFU (see TS 31.101 [11]).
### 4.2.18 EF~AD~ (Administrative Data)
This EF contains information concerning the mode of operation according to the
type of USIM, such as normal (to be used by PLMN subscribers for 3GPP network
operations), type approval (to allow specific use of the ME during type
approval procedures of e.g. the radio equipment), cell testing (to allow
testing of a cell before commercial use of this cell), manufacturer specific
(to allow the ME manufacturer to perform specific proprietary auto‑test in its
ME during e.g. maintenance phases).
It also provides an indication about how some ME features shall work during
normal operation as well as information about the length of the MNC, which is
part of the International Mobile Subscriber Identity (IMSI) if service n°130
is \"not available\".
+----------------------+---------------------------+-----------+---------+ | Identifier: \'6FAD\' | Structure: transparent | Mandatory | | +----------------------+---------------------------+-----------+---------+ | SFI: \'03\' | | | | +----------------------+---------------------------+-----------+---------+ | File size: 4+X bytes | Update activity: low | | | +----------------------+---------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------+-----------+---------+ | 1 | UE operation mode | M | 1 byte | +----------------------+---------------------------+-----------+---------+ | 2 to 3 | Additional information | M | 2 bytes | +----------------------+---------------------------+-----------+---------+ | 4 | length of MNC in the IMSI | M | 1 byte | +----------------------+---------------------------+-----------+---------+ | 5 to 4+X | RFU | O | X bytes | +----------------------+---------------------------+-----------+---------+
‑ UE operation mode:
Contents:\ mode of operation for the UE
Coding:
Initial value
‑ \'00\' normal operation.
‑ \'80\' type approval operations.
‑ \'01\' normal operation + specific facilities.
‑ \'81\' type approval operations + specific facilities.
‑ \'02\' maintenance (off line).
‑ \'04\' cell test operation.
All other values are RFU
‑ Additional information:
Contents:\ additional information depending on the UE operation mode
Coding:
‑ specific facilities (if b1=1 in byte 1):
Byte 2 (first byte of additional information):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                RFU (see TS 31.101)
* * *
Byte 3 (second byte of additional information):
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0: ciphering indicator feature disabled b1=1: ciphering indicator feature enabled  
|  |  |  |  |  |  |  |  |  | b2: CSG Display Control bit, see below  
|  |  |  |  |  |  |  |  |  | b3: ProSe services for Public Safety, see below  
|  |  |  |  |  |  |  |  |  | b4: extended DRX cycle  
|  |  |  |  |  |  |  |  |  | b5: 5G ProSe, see below  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101)  
b1 is used to control the ciphering indicator feature as specified in TS
22.101 [24].
b2 is used to indicate which CSGs the UE shall display during manual CSG
selection. This bit corresponds to the value of OperatorCSGEntries_Only leaf
described in TS 24.285 [58]. This bit shall be ignored when service n°92 is
not \"available\".
> \- b2=0: for every PLMN not included in EF_OCSGL, or for which a CSG display
> indicator tag is not present, all available CSGs can be displayed without
> any restriction.
>
> \- b2=1: for every PLMN not included in EF_OCSGL or any PLMN for which a CSG
> display indicator tag is not present, only the available CSGs found in the
> Operator CSG list shall be displayed.
>
> b3 is used to indicate whether the USIM enables the Public Safety UE to use
> the ME provisioning parameters for Public Safety usage, in the cases
> described in TS 24.334 [70].
>
> \- b3=0: the ME is not authorized for ProSe services for Public Safety usage
> (i.e. Direct Discovery and Direct Communication as per TS 24.334 [70])
> without contacting the ProSe Function.
>
> \- b3=1: the ME is authorized to use the parameters stored in the USIM or in
> the ME for ProSe services for Public Safety usage, as described in TS 24.334
> [70] without contacting the ProSe Function.
>
> b4 is used to indicate whether the UICC polling interval to retrieve
> proactive commands can be modified (as described in TS 31.101 [11]) or
> weather the UICC interface can be deactivated (as described in clause
> 5.1.11) during extended DRX cycle.
>
> \- b4=0: the ME is not authorized to modify the polling interval and/or
> disable the UICC interface during extended DRX cycle.
>
> \- b4=1: the ME is authorized to modify the polling interval and/or disable
> the UICC interface during extended DRX cycle.
>
> b5 is used to indicate whether the USIM enables the UE to use \"operator-
> managed\" radio resources, in the cases described in 3GPP TS 23.304 [116].
>
> \- b5=0: the UE is not authorized to use \"operator-managed\" radio
> resources.
>
> \- b5=1: the UE is authorized to use \"operator-managed\" radio resources.
\- ME manufacturer specific information (if b2=1 in byte 1):
Byte 2 (first byte of additional information):
* * *
        B8   b7   b6   B5   B4   b3   b2   b1   
                                                Any value
* * *
Byte 3 (second byte of additional information):
* * *
        B8   b7   b6   b5   B4   b3   b2   b1   
                                                Any value
* * *
\- Length of MNC in the IMSI:
Contents:
The length indicator refers to the number of digits, used for extracting the
MNC from the IMSI if service n°130 is \"not available\" and the value shall be
set to 0 if service n°130 is \"available\".
Coding:
Byte 4:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                This value codes the number of digits of the MNC in the IMSI. Only the values '0000', \'0010\' and \'0011\' are currently specified, '0000' value is used if service n°130 is \"available\", all other values are reserved for future use.
                                                RFU (see TS 31.101)
* * *
### 4.2.19 Void
### 4.2.20 EF~CBMID~ (Cell Broadcast Message Identifier for Data Download)
If service n° 29 is \"available\", this file shall be present.
This EF contains the message identifier parameters which specify the type of
content of the cell broadcast messages which are to be passed to the USIM.
Any number of CB message identifier parameters may be stored in the USIM. No
order of priority is applicable.
+----------------------+-------------------------+----------+---------+ | Identifier: \'6F48\' | Structure: transparent | Optional | | +----------------------+-------------------------+----------+---------+ | SFI: \'0E\' | | | | +----------------------+-------------------------+----------+---------+ | File size: 2n bytes | Update activity: low | | | +----------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-------------------------+----------+---------+ | 1 to 2 | CB Message Identifier 1 | O | 2 bytes | +----------------------+-------------------------+----------+---------+ | 3 to 4 | CB Message Identifier 2 | O | 2 bytes | +----------------------+-------------------------+----------+---------+ | : | : | : | : | +----------------------+-------------------------+----------+---------+ | 2n‑1 to 2n | CB Message Identifier n | O | 2 bytes | +----------------------+-------------------------+----------+---------+
‑ Cell Broadcast Message Identifier.
Coding:
\- as in TS 23.041 [16]. Values listed show the identifiers of messages which
shall be accepted by the UE to be passed to the USIM.\ Unused entries shall be
set to \'FF FF\'.
### 4.2.21 EF~ECC~ (Emergency Call Codes)
This EF contains emergency call codes.
+----------------------+----------------------+-----------+---------+ | Identifier: \'6FB7\' | Structure: linear | Mandatory | | | | fixed | | | +----------------------+----------------------+-----------+---------+ | SFI: \'01\' | | | | +----------------------+----------------------+-----------+---------+ | Record size: X+4 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+-----------+---------+ | 1 to 3 | Emergency Call Code | M | 3 bytes | +----------------------+----------------------+-----------+---------+ | 4 to X+3 | Emergency Call Code | O | X bytes | | | Alpha Identifier | | | +----------------------+----------------------+-----------+---------+ | X+4 | Emergency Service | M | 1 byte | | | Category | | | +----------------------+----------------------+-----------+---------+
‑ Emergency Call Code.
Contents:
\- Emergency Call Code.
Coding:
\- the emergency call code is of a variable length with a maximum length of 6
digits. Each emergency call code is coded on three bytes, with each digit
within the code being coded on four bits as shown below. If a code of less
than 6 digits is chosen, then the unused nibbles shall be set to \'F\'.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 1
                                                ::
                                                ::
                                                MSB of Digit 1
                                                LSB of Digit 2
                                                :
                                                :
                                                MSB of Digit 2
* * *
Byte 2:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 3
                                                :
                                                :
                                                MSB of Digit 3
                                                LSB of Digit 4
                                                :
                                                :
                                                MSB of Digit 4
* * *
Byte 3:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 5
                                                :
                                                :
                                                MSB of Digit 5
                                                LSB of Digit 6
                                                :
                                                :
                                                MSB of Digit 6
* * *
\- Emergency Call Code Alpha Identifier.
Contents:\ Information about the dialled emergency number to be displayed to
the user.
Coding:\ this alpha‑tagging shall use\ either:
> \- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit
> 8 set to 0. The alpha identifier shall be left justified. Unused bytes shall
> be set to \'FF\'.
>
> Or
\- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
\- Emergency Service Category.
Contents:\ Information to be sent to the network indicating the category of
the emergency call.
Coding:\ Coding according to TS 24.008 [9].
### 4.2.22 EF~CBMIR~ (Cell Broadcast Message Identifier Range selection)
If service n° 16 is \"available\", this file shall be present.
This EF contains ranges of cell broadcast message identifiers that the
subscriber wishes the UE to accept.
Any number of CB Message Identifier Parameter ranges may be stored in the
USIM. No order of priority is applicable.
+----------------------+-------------------------------+----------+---------+ | Identifier: \'6F50\' | Structure: transparent | Optional | | +----------------------+-------------------------------+----------+---------+ | File size: 4n bytes | Update activity: low | | | +----------------------+-------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-------------------------------+----------+---------+ | 1 to 4 | CB Message Identifier Range 1 | O | 4 bytes | +----------------------+-------------------------------+----------+---------+ | 5 to 8 | CB Message Identifier Range 2 | O | 4 bytes | +----------------------+-------------------------------+----------+---------+ | : | : | : | : | +----------------------+-------------------------------+----------+---------+ | (4n‑3) to 4n | CB Message Identifier Range n | O | 4 bytes | +----------------------+-------------------------------+----------+---------+
‑ Cell Broadcast Message Identifier Ranges.
Contents:\ \- CB Message Identifier ranges:
Coding:\ \- bytes one and two of each range identifier equal the lower value
of a cell broadcast range, bytes three and four equal the upper value of a
cell broadcast range, both values are coded as in TS 23.041 [16] \"Message
Format on BTS‑MS Interface ‑ Message Identifier\". Values listed show the
ranges of messages which shall be accepted by the UE.\ Unused entries shall be
set to \'FF FF FF FF\'.
### 4.2.23 EF~PSLOCI~ (Packet Switched location information)
This EF contains the following Location Information:
‑ Packet Temporary Mobile Subscriber Identity (P-TMSI);
‑ Packet Temporary Mobile Subscriber Identity signature value (P-TMSI
signature value);
‑ Routing Area Information (RAI);
‑ Routing Area update status.
+----------------------+----------------------------+-----------+---------+ | Identifier: \'6F73\' | Structure: transparent | Mandatory | | +----------------------+----------------------------+-----------+---------+ | SFI: \'0C\' | | | | +----------------------+----------------------------+-----------+---------+ | File size: 14 bytes | Update activity: high | | | +----------------------+----------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------------+-----------+---------+ | 1 to 4 | P-TMSI | M | 4 bytes | +----------------------+----------------------------+-----------+---------+ | 5 to 7 | P-TMSI signature value | M | 3 bytes | +----------------------+----------------------------+-----------+---------+ | 8 to13 | RAI | M | 6 bytes | +----------------------+----------------------------+-----------+---------+ | 14 | Routing Area update status | M | 1 byte | +----------------------+----------------------------+-----------+---------+
‑ P-TMSI.
Contents:\ Packet Temporary Mobile Subscriber Identity.
Coding:\ according to TS 24.008 [9].
Byte 1: first byte of P-TMSI
* * *
        b8    b7   B6   B5   B4   B3   b2   b1
        MSB
* * *
‑ P-TMSI signature value.
Contents:\ Packet Temporary Mobile Subscriber Identity signature value.
Coding:\ according to TS 24.008 [9].
Byte 5: first byte of P-TMSI signature value.
* * *
        B8    b7   B6   B5   B4   B3   b2   b1
        MSB
* * *
‑ RAI
Contents:\ Routing Area Information.
Coding:\ according to TS 24.008 [9].
Byte 8: first byte of RAI
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
‑ Routing Area update status.
Contents:\ status of routing area update according to TS 24.008 [9].
Coding:
byte 14:
Bits: b3 b2 b1.
0 0 0 : updated.
0 0 1 : not updated.
0 1 0 : PLMN not allowed.
0 1 1 : Routing Area not allowed.
1 1 1 : reserved.
Bits b4 to b8 are RFU (see TS 31.101 [11]).
### 4.2.24 EF~FDN~ (Fixed Dialling Numbers)
If service n° 2 and/or service n° 89 is \"available\", this file shall be
present.
This EF contains Fixed Dialling Numbers (FDN) and/or Supplementary Service
Control strings (SSC). In addition it contains identifiers of associated
network/bearer capabilities and identifiers of extension records at the USIM
ADF level. It may also contain an associated alpha‑tagging. If this file is
present in the USIM, the Enabled Services Table (EF~EST~) shall also be
present.
+----------------------+----------------------+----------+----------+ | Identifier: \'6F3B\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | Record length: X+14 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Dialling Number/SSC | M | 10 bytes | | | String | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension2 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+
For contents and coding of all data items see the respective data items of the
EF~ADN~ (clause 4.4.2.3), with the exception that extension records are stored
in the EF~EXT2~.
By default, destination addresses which are not in EF~FDN~ shall not be
allowed on any CS bearer service/teleservice, or IMS communication or SMS when
FDN is enabled.
For the FDN procedures related to SMS see TS 22.101 [24] and TS 31.111 [12].
NOTE: The value of X (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~ADN~.
### 4.2.25 EF~SMS~ (Short messages)
If service n° 10 is \"available\", this file shall be present.
This EF contains information in accordance with TS 23.040 [6] comprising short
messages (and associated parameters) which have either been received by the UE
from the network, or are to be used as an UE originated message.
+--------------------------+-------------------------+----------+-----------+ | Identifier: \'6F3C\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+-----------+ | Record length: 176 bytes | Update activity: low | | | +--------------------------+-------------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+-----------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+-----------+ | 1 | Status | M | 1 byte | +--------------------------+-------------------------+----------+-----------+ | 2 to 176 | Remainder | M | 175 bytes | +--------------------------+-------------------------+----------+-----------+
‑ Status.
Contents:
Status byte of the record which can be used as a pattern in the SEARCH RECORD
command. For UE originating messages sent to the network, the status shall be
updated when the UE receives a status report, or sends a successful SMS
Command relating to the status report.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
                                 X    X    0    free space
                                 X    X    1    used space
                                 0    0    1    message received by UE from network; message read
                                 0    1    1    message received by UE from network; message to be read
                                 1    1    1    UE originating message; message to be sent
                                                RFU (see TS 31.101 \[11\])
* * *
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  |   
|  |  |  |  | X | X | 1 | 0 | 1 | UE originating message; message sent to the network:  
|  |  |  |  | 0 | 0 | 1 | 0 | 1 | Status report not requested  
|  |  |  |  | 0 | 1 | 1 | 0 | 1 | Status report requested but not (yet) received;  
|  |  |  |  | 1 | 0 | 1 | 0 | 1 | Status report requested, received but not stored in EF-SMSR;  
|  |  |  |  | 1 | 1 | 1 | 0 | 1 | Status report requested, received and stored in EF-SMSR;  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
‑ Remainder.
Contents:
This data item commences with the TS‑Service‑Centre‑Address as specified in TS
24.011 [10]. The bytes immediately following the TS‑Service‑Centre‑Address
contain an appropriate short message TPDU as specified in TS 23.040 [6], with
identical coding and ordering of parameters.
Coding:
according to TS 23.040 [6] and TS 24.011 [10]. Any TP‑message reference
contained in an UE originated message stored in the USIM, shall have a value
as follows:
Value of the TP‑message‑reference:
message to be sent: \'FF\'.
Message sent to the network: the value of TP‑Message‑Reference used in the\
message sent to the network.
Any bytes in the record following the TPDU shall be filled with \'FF\'.
It is possible for a TS‑Service‑Centre‑Address of maximum permitted length,
e.g. containing more than 18 address digits, to be associated with a maximum
length TPDU such that their combined length is 176 bytes. In this case the ME
shall store in the USIM the TS‑Service‑Centre‑Address and the TPDU in bytes 2
to 176 without modification, except for the last byte of the TPDU, which shall
not be stored.
### 4.2.26 EF~MSISDN~ (MSISDN)
If service n° 21 is \"available\", this file shall be present.
This EF contains MSISDN(s) related to the subscriber. In addition it contains
identifiers of associated network/bearer capabilities and identifiers of
extension records at the USIM ADF level. It may also contain an associated
alpha‑tagging.
+----------------------+----------------------+----------+----------+ | Identifier: \'6F40\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | Record length: X+14 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/ADM | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Dialling Number/SSC | M | 10 bytes | | | String | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension5 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+
For contents and coding of all data items see the respective data items of
EF~ADN~.
If the USIM stores more than one MSISDN number and the ME displays the MSISDN
number(s) within the initialisation procedure then the one stored in the first
record shall be displayed with priority.
NOTE: The value of X (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~ADN~.
### 4.2.27 EF~SMSP~ (Short message service parameters)
If service n° 12 is \"available\", this file shall be present.
This EF contains values for Short Message Service header Parameters (SMSP),
which can be used by the ME for user assistance in preparation of mobile
originated short messages. For example, a service centre address will often be
common to many short messages sent by the subscriber.
The EF consists of one or more records, with each record able to hold a set of
SMS parameters. The first (or only) record in the EF shall be used as a
default set of parameters, if no other record is selected.
To distinguish between records, an alpha‑identifier may be included within
each record, coded on Y bytes.
The SMS parameters stored within a record may be present or absent
independently. When a short message is to be sent from the UE, the parameter
in the USIM record, if present, shall be used when a value is not supplied by
the user.
+---------------------------+---------------------------+----------+----------+ | Identifier: \'6F42\' | Structure: linear fixed | Optional | | +---------------------------+---------------------------+----------+----------+ | Record length: 28+Y bytes | Update activity: low | | | +---------------------------+---------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------------+---------------------------+----------+----------+ | Bytes | Description | M/O | Length | +---------------------------+---------------------------+----------+----------+ | 1 to Y | Alpha‑Identifier | O | Y bytes | +---------------------------+---------------------------+----------+----------+ | Y+1 | Parameter Indicators | M | 1 byte | +---------------------------+---------------------------+----------+----------+ | Y+2 to Y+13 | TP‑Destination Address | M | 12 bytes | +---------------------------+---------------------------+----------+----------+ | Y+14 to Y+25 | TS‑Service Centre Address | M | 12 bytes | +---------------------------+---------------------------+----------+----------+ | Y+26 | TP‑Protocol Identifier | M | 1 byte | +---------------------------+---------------------------+----------+----------+ | Y+27 | TP‑Data Coding Scheme | M | 1 byte | +---------------------------+---------------------------+----------+----------+ | Y+28 | TP‑Validity Period | M | 1 byte | +---------------------------+---------------------------+----------+----------+
Storage is allocated for all of the possible SMS parameters, regardless of
whether they are present or absent. Any bytes unused, due to parameters not
requiring all of the bytes, or due to absent parameters, shall be set to
\'FF\'.
‑ Alpha‑Identifier.
Contents:
Alpha Tag of the associated SMS‑parameter.
Coding:
see clause 4.4.2.3 (EF~ADN~).
NOTE: The value of Y may be zero, i.e. the alpha‑identifier facility is not
used. By using the command GET RESPONSE the ME can determine the value of Y.
‑ Parameter Indicators.
Contents:
each of the default SMS parameters which can be stored in the remainder of the
record are marked absent or present by individual bits within this byte.
Coding:
allocation of bits:
bit number Parameter indicated.
1 TP‑Destination Address.
2 TS‑Service Centre Address.
3 TP‑Protocol Identifier.
4 TP‑Data Coding Scheme.
5 TP‑Validity Period.
6 reserved, set to 1.
7 reserved, set to 1.
8 reserved, set to 1.
Bit value Meaning.
0 Parameter present.
1 Parameter absent.
‑ TP‑Destination Address.
Contents and Coding:\ as defined for SM‑TL address fields in TS 23.040 [6].
‑ TP‑Service Centre Address.
Contents and Coding:\ as defined for RP‑Destination address Centre Address in
TS 24.011 [10].
‑ TP‑Protocol Identifier.
Contents and Coding:\ as defined in TS 23.040 [6].
‑ TP‑Data Coding Scheme.
Contents and Coding:\ as defined in TS 23.038 [5].
‑ TP‑Validity Period.
Contents and Coding:\ as defined in TS 23.040 [6] for the relative time
format.
### 4.2.28 EF~SMSS~ (SMS status)
If service n° 10 is \"available\", this file shall be present.
This EF contains status information relating to the short message service.
+----------------------+----------------------+----------+---------+ | Identifier: \'6F43\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: 2+X bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Last Used TP‑MR | M | 1 byte | +----------------------+----------------------+----------+---------+ | 2 | SMS \"Memory Cap. | M | 1 byte | | | Exceeded\" Not. Flag | | | +----------------------+----------------------+----------+---------+ | 3 to 2+X | RFU | O | X bytes | +----------------------+----------------------+----------+---------+
‑ Last Used TP‑MR.
Contents:
\- the value of the TP‑Message‑Reference parameter in the last mobile
originated short message, as defined in TS 23.040 [6].
Coding:
\- as defined in TS 23.040 [6].
‑ SMS \"Memory Capacity Exceeded\" Notification Flag.
Contents:
\- this flag is required to allow a process of flow control, so that as memory
capacity in the UE becomes available, the Network can be informed. The process
for this is described in TS 23.040 [6].
Coding:
b1=1 means flag unset; memory capacity available;
b1=0 means flag set;
b2 to b8 are reserved and set to 1.
### 4.2.29 EF~SDN~ (Service Dialling Numbers)
If service n° 4 and or service n° 89 is \"available\", this file shall be
present.
This EF contains special service numbers (SDN) and/or the respective
supplementary service control strings (SSC). In addition it contains
identifiers of associated network/bearer capabilities and identifiers of
extension records at the USIM ADF level. It may also contain associated
alpha‑tagging. If the service n° 89 is available this file will contain the
eCall test and reconfiguration numbers that are used by an UE in eCall and
normal service mode.
+----------------------+----------------------+----------+----------+ | Identifier: \'6F49\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | Record length: X+14 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1‑X | Alpha identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 bytes | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Dialling Number/SSC | M | 10 bytes | | | String | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension3 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+
For contents and coding of all data items see the respective data items of the
EF~ADN~ (clause 4.4.2.3), with the exception that extension records are stored
in the EF~EXT3~ and capability/configuration parameters are stored in
EF~CCP2~.
NOTE: The value of X (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~ADN~.
### 4.2.30 EF~EXT2~ (Extension2)
If service n° 3 is \"available\", this file shall be present.
This EF contains extension data of an FDN (see FDN in 4.2.24).
+-------------------------+-------------------------+----------+----------+ | Identifier: \'6F4B\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | Record length: 13 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | Record type | M | 1 byte | +-------------------------+-------------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +-------------------------+-------------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +-------------------------+-------------------------+----------+----------+
For contents and coding see clause 4.4.2.4 (EF~EXT1~).
### 4.2.31 EF~EXT3~ (Extension3)
If service n° 5 is \"available\", this file shall be present.
This EF contains extension data of an SDN (see SDN in 4.2.29).
+-------------------------+-------------------------+----------+----------+ | Identifier: \'6F4C\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | Record length: 13 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | Record type | M | 1 byte | +-------------------------+-------------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +-------------------------+-------------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +-------------------------+-------------------------+----------+----------+
For contents and coding see clause 4.4.2.4 (EF~EXT1~).
### 4.2.32 EF~SMSR~ (Short message status reports)
If service n° 11 is \"available\", this file shall be present.
This EF contains information in accordance with TS 23.040 [6] comprising short
message status reports which have been received by the UE from the network.
Each record is used to store the status report of a short message in a record
of EF~SMS~. The first byte of each record is the link between the status
report and the corresponding short message in EF~SMS~.
+-------------------------+-------------------------+----------+----------+ | Identifier: \'6F47\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | Record length: 30 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | SMS record identifier | M | 1 | +-------------------------+-------------------------+----------+----------+ | 2 to 30 | SMS status report | M | 29 bytes | +-------------------------+-------------------------+----------+----------+
\- SMS record identifier.
Contents:
\- this data item identifies the corresponding SMS record in EF~SMS~, e.g. if
this byte is coded \'05\' then this status report corresponds to the short
message in record #5 of EF~SMS~.
Coding:
\- \'00\' - empty record;
\- \'01\' to \'FF\' - record number of the corresponding SMS in EF~SMS~.
\- SMS status report:
Contents:
\- this data item contains the SMS-STATUS-REPORT TPDU as specified in TS
23.040 [6], with identical coding and ordering of parameters.
Coding:
\- according to TS 23.040 [6]. Any bytes in the record following the TPDU
shall be filled with \'FF\'.
### 4.2.33 EF~ICI~ (Incoming Call Information)
If service n°9 is \"available\", this file shall be present.
This EF is located within the USIM application. The incoming call information
can be linked to the phone book stored under DF~TELECOM~ or to the local phone
book within the USIM. The EF~ICI~ contains the information related to incoming
calls.
The time of the call and duration of the call are stored in this EF. This EF
can also contain associated alpha identifier that may be supplied with the
incoming call. In addition it contains identifiers of associated
network/bearer capabilities and identifiers of extension records at the USIM
ADF level. The structure of this EF is cyclic, so the contents shall be
updated only after a call is disconnected.
If CLI is supported and the incoming phone number matches a number stored in
the phone book the incoming call information is linked to the corresponding
information in the phone book. If the incoming call matches an entry but is
indicated as hidden in the phone book the link is established but the
information is not displayed by the ME if the code for the secret entry has
not been verified. The ME shall not ask for the secret code to be entered at
this point.
Optionally the ME may store the link to phone book entry in the file, so that
it does not need to look again for a match in the phone book when it reuses
the entry. But the ME will have to check that the incoming call number still
exits in the linked phone book entry, as the link might be broken (entry
modified). When not used by the ME or no link to the phone book has been
found, this field shall be set to \'FFFFFF\'.
The first byte of this link is used to identify clearly the phone book
location either global (i.e. under DF~TELECOM~) or local (i.e. USIM specific).
To allow the reuse of the referring mechanism in further implementation of the
phonebook under discussion, this byte can be used to indicate those.
For the current version of the phone book, the phone book entry is identified
as follows:
\- the record number in the EF~PBR~ which indicates the EF~ADN~ containing the
entry;
\- the record number inside the indicated EF~ADN~.
The structure of EF~ICI~ is shown below. Coding scheme is according to EF~ADN~
Structure of EF~ICI~
+----------------------+----------------------+----------+----------+ | Identifier: \'6F80\' | Structure: Cyclic | Optional | | +----------------------+----------------------+----------+----------+ | SFI: \'14\' | | | | +----------------------+----------------------+----------+----------+ | Record length: X+28 | Update activity: | | | | bytes | high | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD number | M | 1 byte | | | contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Incoming Call Number | M | 10 bytes | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension5 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+ | X+15 to X+21 | Incoming call date | M | 7 bytes | | | and time (see detail | | | | | 1) | | | +----------------------+----------------------+----------+----------+ | X+22 to X+24 | Incoming call | M | 3 bytes | | | duration (see detail | | | | | 2) | | | +----------------------+----------------------+----------+----------+ | X+25 | Incoming call status | M | 1 byte | | | (see detail 3) | | | +----------------------+----------------------+----------+----------+ | X+26 to X+28 | Link to phone book | M | 3 bytes | | | entry (see detail 4) | | | +----------------------+----------------------+----------+----------+
NOTE: When the contents except incoming call status are invalid, they are
filled with \'FF\'.
**Detail 1 Coding of date and time.**
Content:\ the date and time are defined by the ME.
Coding:\ it is according to the extended BCD coding from Byte1 to Byte 7. The
first 3 bytes show year, month and day (yy.mm.dd). The next 3 bytes show hour,
minute and second (hh.mm.ss). The last Byte 7 is Time Zone. The Time Zone
indicates the difference, expressed in quarters of an hour, between the local
time and GMT. Bit 4 in Byte 7 represents the algebraic sign of this difference
(0: positive, 1: negative). If the terminal does not support the Time Zone,
Byte 7 shall be \"FF\". Byte X+15: Year.
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit year
                                                MSB of first digit year
                                                LSB of second digit year
                                                MSB of second digit year
* * *
Byte X+16: Month
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit month
                                                MSB of first digit month
                                                LSB of second digit month
                                                MSB of second digit month
* * *
Byte X+17: Day
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit day
                                                MSB of first digit day
                                                LSB of second digit day
                                                MSB of second digit day
* * *
Byte X+18: Hour
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit hour
                                                MSB of first digit hour
                                                LSB of second digit hour
                                                MSB of second digit hour
* * *
Byte X+19: Minute
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit minute
                                                MSB of first digit minute
                                                LSB of second digit minute
                                                MSB of second digit minute
* * *
Byte X+20: Second
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit second
                                                MSB of first digit second
                                                LSB of second digit second
                                                MSB of second digit second
* * *
Byte X+21: Time Zone
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of first digit indicates by quarters an hour
                                                MSB of first digit indicates by quarters an hour
                                                the algebraic sign (0: positive, 1: negative)
                                                LSB of second digit indicates by quarters an hour
                                                MSB of second digit indicates by quarters an hour
* * *
**Detail 2 Coding of call duration.**
Call duration is indicated by second.
Byte X+22:
* * *
        b8    b7    b6    b5    b4    b3    b2    b1
        223   222   221   220   219   218   217   216
* * *
Byte X+23:
* * *
        b8    b7    b6    b5    b4    b3    b2   b1
        215   214   213   212   211   210   29   28
* * *
Byte X+24:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
        27   26   25   24   23   22   21   20
* * *
For instance, \'00\' \'00\' \'30\' represents 25+24.
**Detail 3 Coding of Call status.**
Byte X+25:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Answered=\'0\'/ Not Answered=\'1\'
                                                RFU
* * *
**Detail 4 Link to phone book entry**
For the current implementation of the phone book the following coding applies:
Phone book reference.
Byte X+26:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
                                                0 Global Phone Book (DF~TELECOM~)\
                                                1 Local Phone Book (USIM Specific)
                                                RFU
* * *
EF~PBR~ record number:
\- Byte X+27: Hexadecimal value.
EF~ADN~ record number:
\- Byte X+28: Hexadecimal value.
### 4.2.34 EF~OCI~ (Outgoing Call Information)
If service n°8 is \"available\", this file shall be present.
This EF is located within the USIM application. The outgoing call information
can be linked to the phone book stored under DF~TELECOM~ or to the local phone
book within the USIM. The EF~OCI~ contains the information related to outgoing
calls.
The time of the call and duration of the call are stored in this EF. It may
also contain associated alpha identifier. In addition it contains identifiers
of associated network/bearer capabilities and identifiers of extension records
at the USIM ADF level. The structure of this file is cyclic, so the contents
shall be updated only after a call is disconnected.
If the dialled phone number matches a number stored in the phone book the
outgoing call information might be linked to the corresponding information in
the phone book. The dialled number may match with a hidden entry in the phone
book. If the dialled number matches a hidden entry in the phone book the link
is established but the information related to the phone book entry is not
displayed by the ME, if the hidden code has not been verified. The ME shall
not perform hidden code verification at this point.
Optionally, the ME may store the link to phone book entry in the file, so that
it does not need to look again for a match in the phone book when it reuses
the entry. But the ME will have to check that the outgoing call number still
exists in the linked phone book entry, as the link might be broken (entry
modified). When not used by the ME or no link to the phone book has been
found, this field shall be set to \'FFFFFF\'.
Coding scheme is according to EF~ICI~.
Structure of EF~OCI~
+----------------------+----------------------+----------+----------+ | Identifier: \'6F81\' | Structure: Cyclic | Optional | | +----------------------+----------------------+----------+----------+ | SFI: \'15\' | | | | +----------------------+----------------------+----------+----------+ | Record length: X+27 | Update activity: | | | | bytes | high | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Outgoing Call | M | 10 bytes | | | Number/SSC String | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension5 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+ | X+15 to X+21 | Outgoing call date | M | 7 bytes | | | and time | | | +----------------------+----------------------+----------+----------+ | X+22 to X+24 | Outgoing call | M | 3 bytes | | | duration | | | +----------------------+----------------------+----------+----------+ | X+25 to X+27 | Link to Phone Book | M | 3 bytes | | | Entry | | | +----------------------+----------------------+----------+----------+
NOTE: When the contents are invalid, they are filled with \'FF\'.
### 4.2.35 EF~ICT~ (Incoming Call Timer)
If service n°9 is \"available\", this file shall be present.
This EF contains the accumulated incoming call timer duration value for the
current call and previous calls. The EF is USIM specific and resides within
the USIM application.
This file should have only one entry.
Structure of EF~ICT~
+----------------------+----------------------+----------+---------+ | Identifier: \'6F82\' | Structure: cyclic | Optional | | +----------------------+----------------------+----------+---------+ | Record length: 3 | Update activity: | | | | bytes | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/PIN2 | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | INCREASE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | Accumulated call | M | 3 bytes | | | timer value | | | +----------------------+----------------------+----------+---------+
Coding:
Accumulated call timer value is indicated by second.
Byte 1:
* * *
        b8    b7    b6    b5    b4    b3    b2    b1
        223   222   221   220   219   218   217   216
* * *
Byte 2:
* * *
        b8    b7    b6    b5    b4    b3    b2   b1
        215   214   213   212   211   210   29   28
* * *
Byte 3:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1
        27   26   25   24   23   22   21   20
* * *
For example, \'00\' \'00\' \'30\' represents 25+24.
### 4.2.36 EF~OCT~ (Outgoing Call Timer)
If service n°8 is \"available\", this file shall be present.
This EF contains the accumulated outgoing call timer duration value for the
current call and previous calls. The EF is USIM specific and resides within
the USIM application. The contents of this EF shall be updated only after a
call is disconnected. The coding of this EF is the same as EF~ICT~.
This file should have only one entry.
Structure of EF~OCT~
+----------------------+----------------------+----------+---------+ | Identifier: \'6F83\' | Structure: cyclic | Optional | | +----------------------+----------------------+----------+---------+ | Record length: 3 | Update activity: | | | | bytes | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/PIN2 | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | INCREASE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | Accumulated call | M | 3 bytes | | | timer value | | | +----------------------+----------------------+----------+---------+
### 4.2.37 EF~EXT5~ (Extension5)
If service n° 44 is \"available\", this file shall be present.
This EF contains extension data of EF~ICI~, EF~OCI~ and EF~MSISDN~ of the USIM
application.
+-------------------------+-------------------------+----------+----------+ | Identifier: \'6F4E\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | Record length: 13 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | Record type | M | 1 byte | +-------------------------+-------------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +-------------------------+-------------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +-------------------------+-------------------------+----------+----------+
For contents and coding see EF~EXT1~.
### 4.2.38 EF~CCP2~ (Capability Configuration Parameters 2)
If service n° 14 is \"available\", this file shall be present.
This EF contains parameters of required network and bearer capabilities and
terminal configurations associated with a call established using a fixed
dialling number, a barred dialling number, an MSISDN, a service dialling
number, an incoming call, an outgoing call or an MBDN. It is referred by
EF~FDN~, EF~BDN,~ EF~MSISDN~, EF~SDN~, EF~ICI~, EF~OCI~, EF~MBDN~ and EF~CFIS~
at USIM ADF level.
+----------------------+----------------------+----------+---------+ | Identifier: \'6F4F\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'16\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X | Update activity: low | | | | bytes, X≥15 | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | Bearer capability | M | X bytes | | | information element | | | +----------------------+----------------------+----------+---------+
‑ Bearer capability information elements.
\- Contents and Coding:\ \- see TS 24.008 [9]. The Information Element
Identity (IEI) shall be excluded, i.e. the first byte of the EF~CCP2~ record
shall be Length of the bearer capability contents.\ ‑ unused bytes are filled
with \'FF\'.
### 4.2.39 EF~eMLPP~ (enhanced Multi Level Precedence and Pre-emption)
If service n° 24 is \"available\", this file shall be present.
This EF contains information about priority levels and fast call set‑up
conditions for the enhanced Multi Level Precedence and Pre-emption service
that can be used by the subscriber.
+----------------------+-----------------------------+----------+--------+ | Identifier: \'6FB5\' | Structure: transparent | Optional | | +----------------------+-----------------------------+----------+--------+ | File size: 2 bytes | Update activity: low | | | +----------------------+-----------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-----------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+-----------------------------+----------+--------+ | 1 | Priority levels | M | 1 byte | +----------------------+-----------------------------+----------+--------+ | 2 | Fast call set‑up conditions | M | 1 byte | +----------------------+-----------------------------+----------+--------+
‑ Priority levels.
Contents:
\- the eMLPP priority levels subscribed to.
Coding:
\- each eMLPP priority level is coded on one bit. Priority levels subscribed
to have their corresponding bits set to 1. Priority levels not subscribed to
have their corresponding bits set to 0. Bit b8 is reserved and set to 0.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                priority level A
                                                priority level B
                                                priority level 0
                                                priority level 1
                                                priority level 2
                                                priority level 3
                                                priority level 4
                                                0
* * *
NOTE: Priority levels A and B can not be subscribed to (see TS 22.067 [5] for
details).
EXAMPLE 1: If priority levels 0, 1 and 2 are subscribed to, EF~eMLPP~ shall be
coded \'1C\'.
‑ Fast call set‑up conditions.
Contents:\ for each eMLPP priority level, the capability to use a fast call
set‑up procedure.
Coding:\ each eMLPP priority level is coded on one bit. Priority levels for
which fast call set‑up is allowed have their corresponding bits set to 1.
Priority levels for which fast call set‑up is not allowed have their
corresponding bits set to 0. Bit b8 is reserved and set to 0.
Byte 2: fast call set-up condition for:
* * *
          b8   b7   b6   b5   b4   b3   b2   b1   
                                                  fast call set-up condition for priority level A
` fast call set-up condition for priority level B fast call set-up condition
for priority level 0 fast call set-up condition for priority level 1 fast call
set-up condition for priority level 2 fast call set-up condition for priority
level 3 fast call set-up condition for priority level 4 0
* * *
EXAMPLE 2: If fast call set‑up is allowed for priority levels 0, and 1, then
byte 2 of EF~eMLPP~ is coded \'0C\'.
### 4.2.40 EF~AaeM~ (Automatic Answer for eMLPP Service)
If service n° 25 is \"available\", this file shall be present.
This EF contains those priority levels (of the Multi Level Precedence and Pre-
emption service) for which the ME shall answer automatically to incoming
calls.
+----------------------+----------------------------------+----------+--------+ | Identifier: \'6FB6\' | Structure: transparent | Optional | | +----------------------+----------------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+----------------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+----------------------------------+----------+--------+ | 1 | Automatic answer priority levels | M | 1 byte | +----------------------+----------------------------------+----------+--------+
‑ Automatic answer priority levels.
Contents:
\- for each eMLPP priority level, the capability for the mobile station to
answer automatically to incoming calls (with the corresponding eMLPP priority
level).
Coding:
\- each eMLPP priority level is coded on one bit. Priority levels allowing an
automatic answer from the mobile station have their corresponding bits set to
1. Priority levels not allowing an automatic answer from the mobile station
have their corresponding bits set to 0. Bit b8 is reserved and set to 0.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Automatic answer priority for priority level A
                                                Automatic answer priority for priority level B
                                                Automatic answer priority for priority level 0
                                                Automatic answer priority for priority level 1
                                                Automatic answer priority for priority level 2
                                                Automatic answer priority for priority level 3
                                                Automatic answer priority for priority level 4
                                                0
* * *
EXAMPLE: If automatic answer is allowed for incoming calls with priority
levels A, 0 and 1, then EF~AaeM~ is coded \'0D\'.
### 4.2.41 Void
### 4.2.42 EF~Hiddenkey~ (Key for hidden phone book entries)
This EF contains the hidden key that has to be verified by the ME in order to
display the phone book entries that are marked as hidden. The hidden key can
consist of 4 to 8 digits.
+----------------------+------------------------+----------+---------+ | Identifier: \'6FC3\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+---------+ | File size: 4 bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 to 4 | Hidden Key | M | 4 bytes | +----------------------+------------------------+----------+---------+
‑ Hidden Key.
Coding:
\- the hidden key is coded on 4 bytes using BCD coding. The minimum number of
digits is 4. Unused digits are padded with \'F\'.
NOTE 1: Digits are not swapped, i.e. for instance the key \"1234\" is coded as
\'12 34 FF FF\'.
NOTE 2: The phone book entries marked as hidden are not scrambled by means of
the hidden key. They are stored in plain text in the phone book.
### 4.2.43 Void
### 4.2.44 EF~BDN~ (Barred Dialling Numbers)
If service n° 6 is \"available\", this file shall be present.
This EF contains Barred Dialling Numbers (BDN) and/or Supplementary Service
Control strings (SSC). In addition it contains identifiers of associated
network/bearer capabilities and identifiers of extension records. It may also
contain an associated alpha‑tagging. As the BDN service relies on the Call
Control feature, BDN shall only be available if Call Control is available. If
this file is present in the USIM, the Enabled Services Table (EF~EST~) shall
also be present.
+----------------------+----------------------+----------+----------+ | Identifier: \'6F4D\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | Record length: X+15 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Dialling Number/SSC | M | 10 bytes | | | String | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension4 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+ | X+15 | Comparison Method | M | 1 byte | | | Pointer | | | +----------------------+----------------------+----------+----------+
For contents and coding of all data items, except for the Comparison Method
Pointer, see the respective data items of EFADN, with the exception that
extension records are stored in the EFEXT4 and capability/configuration
parameters are stored in EF~CCP2~. The Comparison Method Pointer refers to a
record number in EF~CMI~.
NOTE: The value of X (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EFADN.
### 4.2.45 EF~EXT4~ (Extension4)
If service n° 7 is \"available\", this file shall be present.
This EF contains extension data of a BDN/SSC.
+-------------------------+-------------------------+----------+----------+ | Identifier: \'6F55\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | Record length: 13 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | Record type | M | 1 byte | +-------------------------+-------------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +-------------------------+-------------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +-------------------------+-------------------------+----------+----------+
For contents and coding see clause 4.4.2.4 EF~EXT1~.
### 4.2.46 EF~CMI~ (Comparison Method Information)
If service n° 6 is \"available\", this file shall be present.
This EF contains the list of Comparison Method Identifiers and alpha-tagging
associated with BDN entries (see EF~BDN~).
+--------------------------+------------------------------+----------+---------+ | Identifier: \'6F58\' | Structure: linear fixed | Optional | | +--------------------------+------------------------------+----------+---------+ | Record length: X+1 bytes | Update activity: low | | | +--------------------------+------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+------------------------------+----------+---------+ | 1 to X | Alpha Identifier | M | X bytes | +--------------------------+------------------------------+----------+---------+ | X+1 | Comparison Method Identifier | M | 1 byte | +--------------------------+------------------------------+----------+---------+
\- Alpha Identifier.
Contents:
Alpha-tagging of the associated Comparison Method Identifier.
Coding:
Same as the alpha identifier in EF~ADN~.
‑ Comparison Method Identifier.
Contents:
\- this byte describes the comparison method which is associated with a BDN
record. Its interpretation is not specified but it shall be defined by the
card issuers implementing the BDN feature on their USIMs.
Coding:
\- binary; values from 0 to 255 are allowed.
The default coding 255 is reserved for empty field.
### 4.2.47 EF~EST~ (Enabled Services Table)
If service n° 2, 6, 34 or 35 is \"available\" (as indicated in the USIM
Service Table), this file shall be present.
This EF indicates which services are enabled. If a service is not indicated as
enabled in this table, the ME shall not select the service.
+-----------------------------+---------------------------+----------+--------+ | Identifier: \'6F56\' | Structure: transparent | Optional | | +-----------------------------+---------------------------+----------+--------+ | SFI: \'05\' | | | | +-----------------------------+---------------------------+----------+--------+ | File size: X bytes, (X ≥ 1) | Update activity: low | | | +-----------------------------+---------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+---------------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------------+---------------------------+----------+--------+ | 1 | Services n1 to n8 | M | 1 byte | +-----------------------------+---------------------------+----------+--------+ | 2 | Services n9 to n16 | O | 1 byte | +-----------------------------+---------------------------+----------+--------+ | etc. | | | | +-----------------------------+---------------------------+----------+--------+ | X | Services n(8X-7) to n(8X) | O | 1 byte | +-----------------------------+---------------------------+----------+--------+
* * *
‑Services  
Contents: Service n°1: Fixed Dialling Numbers (FDN) Service n°2: Barred
Dialling Numbers (BDN) Service n°3: APN Control List (ACL)
* * *
The EF shall contain at least one byte. Further bytes may be included, but if
the EF includes an optional byte, then the EF shall also contain all bytes
before that byte. Other services are possible in the future. The coding falls
under the responsibility of the 3GPP.
Coding:
\- 1 bit is used to code each service:\ \- bit = 1: service activated;\ \- bit
= 0: service deactivated.\ \- Unused bits shall be set to \'0\'.
A service which is listed in this table is enabled if it is indicated as
available in the USIM Service Table (UST) and indicated as activated in the
Enabled Services Tables (EST) otherwise this service is, either not available
or disabled.
First byte:
* * *
        b8   b7   b6   B5   b4   b3   b2   b1   
                                                Service n°1
                                                Service n°2
                                                Service n°3
                                                Service n°4
                                                Service n°5
                                                Service n°6
                                                Service n°7
                                                Service n°8
* * *
etc.
### 4.2.48 EF~ACL~ (Access Point Name Control List)
If service n° 35 is \"available\", this file shall be present.
This EF contains the list of allowed APNs (Access Point Names) or DNNs. If
this file is present in the USIM, the Enabled Services Table (EF~EST~) shall
also be present.
+---------------------------+------------------------+----------+----------+ | Identifier: \'6F57\' | Structure: transparent | Optional | | +---------------------------+------------------------+----------+----------+ | File size: X bytes (X>1) | Update activity: low | | | +---------------------------+------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------------+------------------------+----------+----------+ | Bytes | Description | M/O | Length | +---------------------------+------------------------+----------+----------+ | 1 | Number of APNs/DNNs | M | 1 byte | +---------------------------+------------------------+----------+----------+ | 2 to X | APN/DNN TLVs | M | X-1 byte | +---------------------------+------------------------+----------+----------+
For contents and coding of APN/DNN-TLV values see TS 23.003 [25]. The tag
value of the APN/DNN-TLV shall be \'DD\'. \"Network provided APN/DNN\" is
coded with a TLV object of length zero.
### 4.2.49 EF~DCK~ (Depersonalisation Control Keys)
If service n° 36 is \"available\", this file shall be present.
This EF provides storage for the de-personalization control keys associated
with the OTA de-personalization cycle of TS 22.022 [27].
+----------------------+----------------------+----------+---------+ | Identifier: \'6F2C\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File Size: 16 bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 4 | 8 digits of network | M | 4 bytes | | | de‑personalization | | | | | control key | | | +----------------------+----------------------+----------+---------+ | 5 to 8 | 8 digits of network | M | 4 bytes | | | subset | | | | | de‑personalization | | | | | control key | | | +----------------------+----------------------+----------+---------+ | 9 to 12 | 8 digits of service | M | 4 bytes | | | provider | | | | | de‑personalization | | | | | control key | | | +----------------------+----------------------+----------+---------+ | 13 to 16 | 8 digits of | M | 4 bytes | | | corporate | | | | | de‑personalization | | | | | control key | | | +----------------------+----------------------+----------+---------+
Empty control key bytes shall be coded \'FFFFFFFF\'.
### 4.2.50 EF~CNL~ (Co-operative Network List)
If service n° 37 is \"available\", this file shall be present.
This EF contains the Co-operative Network List for the multiple network
personalization services defined in TS 22.022 [27].
+----------------------+----------------------+----------+---------+ | Identifier: \'6F32\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: 6n bytes, | Update activity: low | | | | (n ≥ 1) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 6 | Element 1 of | M | 6 bytes | | | co-operative net | | | | | list | | | +----------------------+----------------------+----------+---------+ | : | : | : | : | +----------------------+----------------------+----------+---------+ | 6n‑5 to 6n | Element n of | O | 6 bytes | | | co-operative net | | | | | list | | | +----------------------+----------------------+----------+---------+
‑ Co-operative Network List.
Contents:
\- PLMN network subset, service provider ID and corporate ID of co-operative
networks.
Coding:
\- For each 6 byte list element.
Bytes 1 to 3: PLMN (MCC + MNC): according to TS 24.008 [9].
Byte 4:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LS bit of network subset digit 1
                                                :
                                                :
                                                MS bit of network subset digit 1
                                                LS bit of network subset digit 2
                                                :
                                                :
                                                MS bit of network subset digit 2
* * *
Byte 5:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LS bit of service provider digit 1
                                                :
                                                :
                                                MS bit of service provider digit 1
                                                LS bit of service provider digit 2
                                                :
                                                :
                                                MS bit of service provider digit 2
* * *
Byte 6:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LS bit of corporate digit 1
                                                :
                                                :
                                                MS bit of corporate digit 1
                                                LS bit of corporate digit 2
                                                :
                                                :
                                                MS bit of corporate digit 2
* * *
\- Empty fields shall be coded with \'FF\'.
\- The end of the list is delimited by the first MCC field coded \'FFF\'.
### 4.2.51 EF~START-HFN~ (Initialisation values for Hyperframe number)
This EF contains the values of START~CS~ and START~PS~ of the bearers that
were protected by the keys in EF~KEYS~ or EF~KEYSPS~ at release of the last CS
or PS RRC connection. These values are used to control the lifetime of the
keys (see TS 33.102 [13]).
+----------------------+------------------------+-----------+---------+ | Identifier: \'6F5B\' | Structure: transparent | Mandatory | | +----------------------+------------------------+-----------+---------+ | SFI: \'0F\' | | | | +----------------------+------------------------+-----------+---------+ | File size: 6 bytes | Update activity: high | | | +----------------------+------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+-----------+---------+ | 1 to 3 | START~CS~ | M | 3 bytes | +----------------------+------------------------+-----------+---------+ | 4 to 6 | START~PS~ | M | 3 bytes | +----------------------+------------------------+-----------+---------+
‑ START~CS~
Contents: Initialisation value for Hyperframe number -- CS domain.
Coding: The LSB of START~CS~ is stored in bit 1 of byte 3. Unused nibbles are
set to \'F\'.
‑ START~PS~
Contents: Initialisation value for Hyperframe number -- PS domain.
Coding: As for START~CS~.
### 4.2.52 EF~THRESHOLD~ (Maximum value of START)
This EF contains the maximum value of START~CS~ or START~PS~. This value is
used to control the lifetime of the keys (see TS 33.102 [13]).
+----------------------+----------------------+-----------+---------+ | Identifier: \'6F5C\' | Structure: | Mandatory | | | | transparent | | | +----------------------+----------------------+-----------+---------+ | SFI: \'10\' | | | | +----------------------+----------------------+-----------+---------+ | File size: 3 bytes | Update activity: low | | | +----------------------+----------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+-----------+---------+ | 1 to 3 | Maximum value of | M | 3 bytes | | | START~CS~ or | | | | | START~PS~. | | | +----------------------+----------------------+-----------+---------+
‑ Maximum value of START~CS~ or START~PS~.
Coding: As for START~CS~
### 4.2.53 EF~OPLMNwACT~ (Operator controlled PLMN selector with Access
Technology)
If service n° 42 is \"available\", this file shall be present.
This EF contains the coding for n PLMNs where n is determined by the operator.
This information is determined by the operator and defines the preferred PLMNs
in priority order. The first record indicates the highest priority and the
n^th^ record indicates the lowest. The EF also contains the Access
Technologies for each PLMN in this list. (see TS 23.122 [31])
+----------------------+----------------------+----------+---------+ | Identifier: \'6F61\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'11\' | | | | +----------------------+----------------------+----------+---------+ | File size: 5n bytes | Update activity: low | | | | , (n ≥ 8) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | 1^st^ PLMN (highest | M | 3 bytes | | | priority) | | | +----------------------+----------------------+----------+---------+ | 4 to 5 | 1^st^ PLMN Access | M | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | : | : | | | +----------------------+----------------------+----------+---------+ | 36 to 38 | 8^th^ PLMN | M | 3 bytes | +----------------------+----------------------+----------+---------+ | 39 to 40 | 8^th^ PLMN Access | M | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | 41 to 43 | 9^th^ PLMN | O | 3 bytes | +----------------------+----------------------+----------+---------+ | 44 to 45 | 9^th^ PLMN Access | O | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | : | : | | | +----------------------+----------------------+----------+---------+ | (5n-4) to (5n‑2) | N^th^ PLMN (lowest | O | 3 bytes | | | priority) | | | +----------------------+----------------------+----------+---------+ | (5n-1) to 5n | N^th^ PLMN Access | O | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+
‑ PLMN.
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- according to TS 24.008 [9].
\- Access Technology Identifier:
Coding:
\- See EF~PLMNwACT~ for coding.
### 4.2.54 EF~HPLMNwAcT~ (HPLMN selector with Access Technology)
If service n°43 is \"available\", this file shall be present.
The HPLMN Selector with access technology data field shall contain the HPLMN
code, or codes together with the respected access technology (see TS 23.122
[31]).
+----------------------+----------------------+----------+---------+ | Identifier: \'6F62\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: \'13\' | | | | +----------------------+----------------------+----------+---------+ | File size: 5n (n ≥ | Update activity: low | | | | 1) bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 3 | 1^st^ PLMN | M | 3 bytes | +----------------------+----------------------+----------+---------+ | 4 to 5 | 1^st^ PLMN Access | M | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | 6 to 8 | 2^nd^ PLMN | O | 3 bytes | +----------------------+----------------------+----------+---------+ | 9 to 10 | 2^nd^ PLMN Access | O | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+ | : | : | | | +----------------------+----------------------+----------+---------+ | (5n-4) to (5n‑2) | n^th^ PLMN | O | 3 bytes | +----------------------+----------------------+----------+---------+ | (5n-1) to 5n | n^th^ PLMN Access | O | 2 bytes | | | Technology | | | | | Identifier | | | +----------------------+----------------------+----------+---------+
‑ PLMN
Contents:
Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
according to TS 24.008 [9].
\- Access Technology:
Contents: The Access Technology of the HPLMN that the ME will assume when
searching for the HPLMN. No priority is defined for the preferred access
technology and the priority is an implementation issue, but this file may be
used to optimise the procedure.
Coding:
\- See EF~PLMNwACT~ for coding.
### 4.2.55 EF~ARR~ (Access Rule Reference)
This EF contains the access rules for files located under the USIM ADF in the
UICC. If the security attribute tag \'8B\' is indicated in the FCP it contains
a reference to a record in this file.
Structure of EF~ARR~ at ADF-level
+----------------------+----------------------+-----------+---------+ | Identifier: \'6F06\' | Structure: Linear | Mandatory | | | | fixed | | | +----------------------+----------------------+-----------+---------+ | SFI: \'17\' | | | | +----------------------+----------------------+-----------+---------+ | Record Length: X | Update activity: low | | | | bytes, (X > 0) | | | | +----------------------+----------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+-----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+-----------+---------+ | 1 to X | Access Rule TLV data | M | X bytes | | | objects | | | +----------------------+----------------------+-----------+---------+
This EF contains one or more records containing access rule information
according to the reference to expanded format as defined in ISO/IEC 7816‑4
[20]. Each record represents an access rule. Unused bytes in the record are
set to \'FF\'.
If the card cannot access EF~ARR~ , any attempt to access a file with access
rules indicated in this EF~ARR~ shall not be granted.
### 4.2.56 Void
### 4.2.57 EF~NETPAR~ (Network Parameters)
This EF contains information concerning the cell frequencies
Network Parameter storage may reduce the extent of the terminal search of FDD,
TDD or GSM carriers when selecting a cell. The network parameters stored in
the USIM shall be in accordance with the procedures specified in this clause.
The RF carrier frequency information is stored on 2 bytes and coded on 16 bits
starting from 0,0 MHz. Each increment of the 16 bit value is an increment of
200 kHz in frequency. This allows the exact channel frequency to be stored in
this data field making it independent of any band information. It is up to the
terminal to associate the indicated frequency with a particular band, e.g. GSM
900, GSM 1800 etc. This means that a range from 0 to 13,1 GHz can be covered,
with the resolution of 200 kHz. The frequency indicated is always the terminal
receiver carrier frequency.
The EF provides a minimum storage capacity of 46 bytes in order to provide the
capability of storing at least two cell information TLV objects, e.g. GSM/FDD
or FDD/TDD in its minimum configuration, i.e. the terminal can rely on the
required memory space for storing at least two cell information lists offering
8 GSM neighbour carrier frequencies and 8 Intra/Inter frequencies,
respectively. In what configuration the available memory actually is being
used is up to the terminal.
A terminal shall ignore a TLV object or the value of a carrier frequency which
is beyond its capabilities, i.e. an FDD only terminal shall ignore the GSM
related frequency information. When updating this file, the terminal shall
update it with the current values available in the terminal. Updating of this
file shall start from the beginning of the file. The terminal need not respect
the structure of any information previously stored, i.e. an FDD only terminal
may overwrite the GSM parameters stored in this file by another terminal.
The GSM cell information constructed TLV object contains the information of
the BCCH channel frequency that the terminal is currently camped on, indicated
by tag \'80\'. The constructed TLV object also contains an indication of up to
32 neighbour BCCH carrier frequencies indicated by tag \'81\'. In order to
store a complete set of GSM network parameters, a total of 72 bytes is
required. The terminal shall convert the BCCH channel information, as
specified in TS 44.018 [28], received from the network into the corresponding
frequency before storing it in the USIM.
The FDD cell information constructed TLV object contains the scrambling code
information for the intra frequency carrier, tag \'80\', and the inter
frequency scrambling codes, tag \'81\'. The intra frequency carrier
information may contain up to 32 scrambling codes (m) while there is a
limitation of the number of inter frequency scrambling codes (n1, n2, n3). The
number of inter frequencies that can be indicated is limited to three and the
total amount of scrambling codes for the inter frequencies is limited to 32
(n1+n2+n3 \ Two values for the LAC/TAC are stored in order to allow a range of LAC/TAC
> values to be specified for a given PLMN. A value of \'0000\' stored in bytes
> 4 to 5 and a value of \'FFFE\' stored in bytes 6 to 7 shall be used to
> indicate the entire range of LACs/TACs for the given PLMN. In the case where
> only a single LAC/TAC value is to be specified then the value stored in
> bytes 4 to 5 shall be identical to the value stored in bytes 6 to 7 for the
> given PLMN. If a range of LAC/TAC values are to be specified, then the value
> stored in bytes 4 to 5 shall be the start of the LAC/TAC range and the value
> stored in bytes 6 to 7 shall be the end of the LAC/TAC range for the given
> PLMN.
\- PLMN Network Name Record Identifier
Contents:\ Identifier of operator name to be displayed
Coding:\ A value of \'00\' indicates that the name is to be taken from other
sources, see TS 22.101 [24]
> A value in the range \'01\' to \'FE\' indicates the record number in EF~PNN~
> that shall be displayed as the registered PLMN name. It also indicates the
> record number in EF~PNNI~ that may be displayed as the registered PLMN name
> icon.
NOTE: The intent of this file is to provide exceptions to the other sources of
a network name. Care should be taken not to introduce too many PLMN entries.
An excessive number of entries could result in a longer initialisation period.
### 4.2.60 EF~MBDN~ (Mailbox Dialling Numbers)
If service n°47 is \"available\", this file shall be present.
This EF contains dialling numbers to access mailboxes associated with
Voicemail, Fax, Electronic Mail and other messages. It may also contain
associated alpha‑tags for each supported mailbox. Each dialling number shall
be associated with a message waiting indication group type using EF~MBI~ (see
TS 23.038 [5] for message waiting indication group types).
+----------------------+----------------------+----------+----------+ | Identifier: \'6FC7\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | Record length: X+14 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/ADM | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Dialling Number/SSC | M | 10 bytes | | | contents | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension 6 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+
For contents and coding of all data items see the respective data items of the
EF~ADN~ (clause 4.4.2.3), with the exception that extension records are stored
in the EF~EXT6~ and with the exception that Capability/Configuration
parameters are stored in the EF~CCP2.~
NOTE: The value of X (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~ADN~.
### 4.2.61 EF~EXT6~ (Extension6)
This EF contains extension data of an MBDN (see MBDN in 4.2.60).
+----------------------+----------------------+----------+----------+ | Identifier: \'6FC8\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | Record length: 13 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/ADM | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 | Record type | M | 1 byte | +----------------------+----------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +----------------------+----------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +----------------------+----------------------+----------+----------+
For contents and coding, see clause 4.4.2.4 (EF~EXT1~).
### 4.2.62 EF~MBI~ (Mailbox Identifier)
If service n°47 is \"available\", this file shall be present.
This EF contains information to associate mailbox dialling numbers in EF~MBDN~
with a message waiting indication group type and subscriber profile (as
defined in TS 23.097 [36]). A message waiting indication group type may either
be Voicemail, Fax, Electronic Mail, Other or Videomail (as defined in TS
23.040 [6]).
This EF contains as many records as there are subscriber profiles (shall be
record to subscriber profile). Each record contains references to mailbox
dialling numbers in EF~MBDN~ (one reference for each message waiting
indication group type).
+-----------------------+-----------------------+----------+--------+ | Identifier: \'6FC9\' | Structure: linear | Optional | | | | fixed | | | +-----------------------+-----------------------+----------+--------+ | Record length: X | Update activity: low | | | | bytes, (X ≥ 4) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/ADM | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | Mailbox Dialling | M | 1 byte | | | Number Identifier -- | | | | | Voicemail | | | +-----------------------+-----------------------+----------+--------+ | 2 | Mailbox Dialling | M | 1 byte | | | Number Identifier -- | | | | | Fax | | | +-----------------------+-----------------------+----------+--------+ | 3 | Mailbox Dialling | M | 1 byte | | | Number Identifier -- | | | | | Electronic Mail | | | +-----------------------+-----------------------+----------+--------+ | 4 | Mailbox Dialling | M | 1byte | | | Number Identifier -- | | | | | Other | | | +-----------------------+-----------------------+----------+--------+ | 5 | Mailbox Dialling | O | 1 byte | | | Number Identifier -- | | | | | Videomail | | | +-----------------------+-----------------------+----------+--------+
‑ Mailbox Dialling Number Identifier (message waiting group type = Voicemail,
Fax, Electronic Mail, Other or Videomail).
Contents:
Identifies the mailbox dialling number to be associated with message waiting
type.
Coding:\ \'00\' -- no mailbox dialling number associated with message waiting
indication group type.\ \'xx\' -- record number in EF~MBDN~ associated with
message waiting indication group type.
### 4.2.63 EF~MWIS~ (Message Waiting Indication Status)
If service n°48 is \"available\", this file shall be present.
This EF contains the status of indicators that define whether or not a
Voicemail, Fax, Electronic Mail, Other or Videomail message is waiting (as
defined in TS 23.040 [6]). The ME uses the status after re-activation to
determine whether or not to display the respective message-waiting indication
on its display.
This EF contains as many records as there are subscriber profiles (shall be
record to subscriber profile) as defined in TS 23.097 [36] for MSP.
+-----------------------+-----------------------+----------+--------+ | Identifier: \'6FCA\' | Structure: Linear | Optional | | | | fixed | | | +-----------------------+-----------------------+----------+--------+ | Record length: X | Update activity: high | | | | bytes, (X ≥ 5) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | Message Waiting | M | 1 byte | | | Indicator Status | | | +-----------------------+-----------------------+----------+--------+ | 2 | Number of Voicemail | M | 1 byte | | | Messages Waiting | | | +-----------------------+-----------------------+----------+--------+ | 3 | Number of Fax | M | 1 byte | | | Messages Waiting | | | +-----------------------+-----------------------+----------+--------+ | 4 | Number of Electronic | M | 1 byte | | | Mail Messages Waiting | | | +-----------------------+-----------------------+----------+--------+ | 5 | Number of Other | M | 1 byte | | | Messages Waiting | | | +-----------------------+-----------------------+----------+--------+ | 6 | Number of Videomail | O | 1 byte | | | Messages waiting | | | +-----------------------+-----------------------+----------+--------+
Message Waiting Indication Status
Contents:
Indicates the status of the message-waiting indication.
Coding:
The indicator status for each indicator type is 1 bit long and set as follows:
bit = 1: Set Indication Active
bit = 0: Set Indication Inactive
* * *
        b8   b7   B6   b5   b4   b3   b2   b1   
                                                Message Waiting Indication Status -- Voicemail
                                                Message Waiting Indication Status -- Fax
                                                Message Waiting Indication Status -- Electronic Mail
                                                Message Waiting Indication Status -- Other
                                                Message Waiting Indication Status - Videomail
                                                RFU
* * *
Number of Voicemail Messages Waiting
Contents:
Contains the number of voicemail messages waiting (see TS 23.040 [6]).
Coding:\ Binary.
Number of Fax Messages Waiting
Contents:
Contains the number of fax messages waiting (see TS 23.040 [6]).
Coding:
Binary.
Number of Electronic Mail Messages Waiting
Contents:
Contains the number of electronic mail messages waiting (see TS 23.040 [6])
Coding:
Binary.
Number of Other Messages Waiting
Contents:
Contains the number of other messages waiting (see TS 23.040 [6]).
Coding:
Binary.
Number of Videomail Messages Waiting
Contents:
Contains the number of Videomail messages waiting (see TS 23.040 [6]).
Coding:
> Binary.
### 4.2.64 EF~CFIS~ (Call Forwarding Indication Status)
If service n°49 is \"available\", this file shall be present.
This EF contains the status of indicators that are used to record whether call
forward is active. The ME uses the status after re-activation to determine
whether or not to display the respective Call Forwarding indicator on its
display.
This EF contains as many records as there are subscriber profiles (shall be
record to subscriber profile) as defined in TS 23.097 [36] for MSP.
+----------------------+----------------------+----------+----------+ | Identifier: \'6FCB\' | Structure: Linear | Optional | | | | Fixed | | | +----------------------+----------------------+----------+----------+ | Record length: 16 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 | MSP number | M | 1 byte | +----------------------+----------------------+----------+----------+ | 2 | CFU indicator status | M | 1 byte | +----------------------+----------------------+----------+----------+ | 3 | Length of BCD number | M | 1 byte | +----------------------+----------------------+----------+----------+ | 4 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | 5 to 14 | Dialling Number | M | 10 bytes | +----------------------+----------------------+----------+----------+ | 15 | Capab | M | 1 byte | | | ility/Configuration2 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | 16 | Extension 7 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+
> NOTE: For contents and coding of data items not detailed below, see the
> respective data items of EF~ADN~ (clause 4.4.2.3), Capability/Configuration2
> Record Identifier and Extension 7 Record Identifier.
MSP number:
Contents:\ The MSP number contains the Profile Identity of the subscriber
profile. The Profile Identity shall be between 1and 4 as defined in TS 23.097
[36] for MSP.
Coding:
Binary.
CFU indicator status:
Contents:\ Indicates the status of the call forward unconditional indicator.
Service code = 21 (CFU) or 002 (for CFU part of all CF), as defined in TS
22.030 [4]
Coding:\ The indicator status for each indicator type is 1 bit long and is set
as follows:\ bit = 1: Set indication active\ bit = 0: Set indication inactive.
|  | B8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | CFU indicator status – Voice MMI Service code = 11 (Telephony), as defined in TS 22.030 [4]).  
|  |  |  |  |  |  |  |  |  | CFU indicator status – Fax MMI Service code = 13 (Fax), as defined in TS 22.030 [4]).  
|  |  |  |  |  |  |  |  |  | CFU indicator status – All data teleservices MMI Service code = 12 (Data (Teleservices)), as defined in TS 22.030 [4]).  
|  |  |  |  |  |  |  |  |  | CFU indicator status – SMS MMI Service code = 16 (SMS), as defined in TS 22.030 [4].  
|  |  |  |  |  |  |  |  |  | CFU indicator status – All bearer services MMI Service code = 20 (Data (Bearer Services)), as defined in TS 22.030 [4]).  
|  |  |  |  |  |  |  |  |  | RFU (e.g. for other MMI service codes)  
### 4.2.65 EF~EXT7~ (Extension7)
This EF contains extension data of a CFIS (Call Forwarding Indication Status -
see 4.2.64).
+-------------------------+-------------------------+----------+----------+ | Identifier: \'6FCC\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | Record length: 13 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | Record type | M | 1 byte | +-------------------------+-------------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +-------------------------+-------------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +-------------------------+-------------------------+----------+----------+
For contents and coding see clause 4.4.2.4 (EF~EXT1~).
### 4.2.66 EF~SPDI~ (Service Provider Display Information)
If service n°51 is \"available\", this file shall be present.
This EF contains information regarding the service provider display i.e. the
service provider PLMN list.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FCD\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'1B\' | | | | +----------------------+----------------------+----------+---------+ | File size: x bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to x | TLV object(s) | M | x bytes | | | containing Service | | | | | Provider information | | | +----------------------+----------------------+----------+---------+
* * *
Tag Value Tag Description \'A3\' Service provider display information Tag
\'80\' Service provider PLMN list tag
* * *
The service provider display information object is a constructed TLV coded
according to ISO/IEC 8825-1 [35].
‑ Service provider PLMN list
Contents:
> This TLV contains a list of n PLMNs in which the Service Provider Name shall
> be displayed, as defined in clause 4.2.12 (EF~SPN~).
Coding:
* * *
**Description** **M/O** **Length** Service provider PLMN list tag M 1 byte
Length (see note) M x bytes 1^st^ PLMN entry M 3 bytes 2^nd^ PLMN entry O 3
bytes 3^rd^ PLMN entry O 3 bytes ...  
n^th^ PLMN entry O 3 bytes Note: the length is 3*n bytes, where n denotes the
number of PLMN entries. The length can be coded on one or more bytes according
to ISO/IEC 8825-1 [35].
* * *
Each PLMN is coded as follows:
> Mobile Country Code (MCC) followed by the Mobile Network Code (MNC)
> according to TS 24.008 [9].
>
> In case a PLMN entry is not used, it shall be set to \'FF FF FF\'.
### **4.2.67 EF~MMSN~ (MMS Notification)**
If service n°52 is \"available\", this file shall be present.
This EF contains information in accordance with TS 23.140 [38] and
X.S0016‑000‑A v1.0 [45] comprising MMS notifications (and associated
parameters) which have been received by the UE from the network. A 3GPP
terminal needs only to support the MMS implementation specified in TS 23.140
[38].
+--------------------------+------------------------------+----------+---------+ | Identifier: \'6FCE\' | Structure: Linear fixed | Optional | | +--------------------------+------------------------------+----------+---------+ | Record length: 4+X bytes | Update activity: low | | | +--------------------------+------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+------------------------------+----------+---------+ | 1 to 2 | MMS Status | M | 2 bytes | +--------------------------+------------------------------+----------+---------+ | 3 | MMS Implementation | M | 1 byte | +--------------------------+------------------------------+----------+---------+ | 4 to X+3 | MMS Notification | M | X bytes | +--------------------------+------------------------------+----------+---------+ | X+4 | Extension file record number | M | 1 byte | +--------------------------+------------------------------+----------+---------+
\- MMS Status
Content:
The status bytes contain the status information of the notification.
Coding:
b1 indicates whether there is valid data or if the location is free. B2
indicates whether the MMS notification has been read or not. Bits b3-b4 of the
first byte indicate the MM retrieval, MM rejection, or MM forwarding status,
Bits b5-b8 of the first byte and the entire second byte are reserved for
future use.
First byte:
* * *
b8 b7 b6 b5 b4 b3 b2 b1
                                          X   X   X   0   Free space                         
                                          X   X   X   1   Used space                         
                                          X   X   0   1   Notification not read              
                                          X   X   1   1   Notification read                  
                                          0   0   X   1   MM not retrieved                   
                                          0   1   X   1   MM retrieved                       
                                          1   0   X   1   MM rejected                        
                                          1   1   X   1   MM forwarded                       
                                                          Reserved for future use
* * *
Second byte:
* * *
b8 b7 b6 b5 b4 b3 b2 b1  
Reserved for future use
* * *
\- MMS Implementation
Contents:
The MMS Implementation indicates the used implementation type, e.g. WAP.
Coding:
Allocation of bits:
Bit number Parameter indicated
1 WAP implementation of MMS as defined in TS 23.140 [38]
2 Reserved for 3GPP2: M-IMAP implementation of MMS as defined in X.S0016‑000‑A
v1.0 [45]
3 Reserved for 3GPP2: SIP implementation of MMS as defined in X.S0016‑000‑A
v1.0 [45]
4-8 Reserved for future use
Bit value Meaning
0 Implementation not supported.
1 Implementation supported.
\- MMS Notification
Contents:
The MMS Notification contains the MMS notification.
Coding:
The MMS Notification is coded according to the MMS Implementation as indicated
in Byte 3.
Any unused byte shall be set to \'FF\'.
\- Extension file record number
Contents:
\- extension file record number. This byte identifies the number of a record
in the EF~EXT8~ containing extension data for the notification information.
The use of this byte is optional. If it is not used it shall be set to \'FF\'.
Coding:
\- binary.
### 4.2.68 EF~EXT8~ (Extension 8)
If service n°53 is \"available\", this file shall be present.
This EF contains extension data of a MMS Notification (Multimedia Messaging
Service - see 4.2.67).
+--------------------------+-------------------------+----------+---------+ | Identifier: \'6FCF\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+---------+ | Record length: X+2 bytes | Update activity: low | | | +--------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+---------+ | 1 | Record type | M | 1 byte | +--------------------------+-------------------------+----------+---------+ | 2 to X+1 | Extension data | M | X bytes | +--------------------------+-------------------------+----------+---------+ | X+2 | Identifier | M | 1 byte | +--------------------------+-------------------------+----------+---------+
The structure of this EF is identical to the structure of EF~EXT1~ (see clause
4.4.2.4).
\- Record type.
Contents:
type of the record, see clause 4.4.2.4
Coding:
according to the \"additional data\" type
‑ Extension data.
Contents:\ additional data (MMS notification extension)
Coding:
the first byte of the extension data gives the number of bytes of the
remainder of the MMS notification in this record. The following bytes contain
the extension of the MMS notification.
‑ Identifier.
Contents:\ identifier of the next extension record (in EXT8) to enable longer
storage of information.
Coding:\ record number of next record. \'FF\' identifies the end of the chain.
### **4.2.69 EF~MMSICP~ (MMS Issuer Connectivity Parameters)**
If service n°52 is \"available\", this file shall be present.
This EF contains values for Multimedia Messaging Connectivity Parameters as
determined by the issuer, which can be used by the ME for MMS network
connection. This file may contain one or more sets of Multimedia Messaging
Issuer Connectivity Parameters. The first set of Multimedia Messaging Issuer
Connectivity Parameters is used as the default set. Each set of Multimedia
Messaging Issuer Connectivity Parameters may consist of one or more Interface
to Core Network and Bearer information TLV objects, but shall contain only one
MMS implementation TLV object, one MMS Relay/Server TLV object and one Gateway
TLV object. The order of the Interface to Core Network and Bearer information
TLV objects in the MMS Connectivity TLV object defines the priority of the
Interface to Core Network and Bearer information, with the first TLV object
having the highest priority.
+---------------------+---------------------+----------+------------+ | Identifier: | Structure: | Optional | | | \'6FD0\' | Transparent | | | +---------------------+---------------------+----------+------------+ | File Size: | Update activity: | | | | X~1~+...+ X~n~ | low | | | | bytes | | | | +---------------------+---------------------+----------+------------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+------------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+------------+ | 1 to X~1~ | MMS Connectivity | M | X~1~ bytes | | | Parameters TLV | | | | | object | | | +---------------------+---------------------+----------+------------+ | X~1~+1 to X~1~ + | MMS Connectivity | O | X~2~ bytes | | X~2~ | Parameters TLV | | | | | object | | | +---------------------+---------------------+----------+------------+ | ... | ... | | | +---------------------+---------------------+----------+------------+ | X~1~+...+ X~n-1~+1 | MMS Connectivity | O | X~n~ bytes | | to X~1~+...+ X~n~ | Parameters TLV | | | | | object | | | +---------------------+---------------------+----------+------------+
MMS Connectivity Parameters tags
* * *
Description Tag Value MMS Connectivity Parameters Tag \'AB\' MMS
Implementation Tag \'80\' MMS Relay/Server Tag \'81\' Interface to Core
Network and Bearer Information Tag \'82\' GatewayTag \'83\' Reserved for
3GPP2: MMS Authentication Mechanism Tag \'84\' Reserved for 3GPP2: MMS
Authentication User Name Tag \'85\'
* * *
\- MMS Connectivity Parameters contents
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | MMS Connectivity | \'AB\' | M | 1 | | Parameters Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | MMS Implementation Tag | \'80\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 1 | M | 1 | +-------------------------+--------+-----+----------------+ | MMS Implementation | -- | M | 1 | | Information | | | | +-------------------------+--------+-----+----------------+ | MMS Relay/Server Tag | \'81\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | MMS Relay/Server | -- | M | X1 | | Address | | | | +-------------------------+--------+-----+----------------+ | MMS Authentication | \'84\' | C1 | 1 | | Mechanism Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X2 | C1 | Note 2 | +-------------------------+--------+-----+----------------+ | MMS Authentication | -- | C1 | X2 | | Mechanism | | | | +-------------------------+--------+-----+----------------+ | MMS Authentication User | \'85\' | C1 | 1 | | Name Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X3 | C1 | Note 2 | +-------------------------+--------+-----+----------------+ | MMS Authentication User | -- | C1 | X3 | | Name | | | | +-------------------------+--------+-----+----------------+ | 1^st^ Interface to Core | \'82\' | C2 | 1 | | Network and Bearer | | | | | Information Tag | | | | | (highest priority) | | | | +-------------------------+--------+-----+----------------+ | Length | Y1 | C2 | Note 2 | +-------------------------+--------+-----+----------------+ | 1^st^ Interface to Core | -- | C2 | Y1 | | Network and Bearer | | | | | information | | | | +-------------------------+--------+-----+----------------+ | 2^nd^ Interface to Core | \'82\' | C2 | 1 | | Network and Bearer | | | | | Information Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Y2 | C2 | Note 2 | +-------------------------+--------+-----+----------------+ | 2^nd^ Interface to Core | -- | C2 | Y2 | | Network and Bearer | | | | | information | | | | +-------------------------+--------+-----+----------------+ | ... | | | | +-------------------------+--------+-----+----------------+ | N^th^ Interface to Core | \'82\' | C2 | 1 | | Network and Bearer | | | | | Information Tag (lowest | | | | | priority) | | | | +-------------------------+--------+-----+----------------+ | Length | Y3 | C2 | Note 2 | +-------------------------+--------+-----+----------------+ | N^th^ Interface to Core | -- | C2 | Y3 | | Network and Bearer | | | | | information | | | | +-------------------------+--------+-----+----------------+ | GatewayTag | \'83\' | O | 1 | +-------------------------+--------+-----+----------------+ | Length | Z | O | Note 2 | +-------------------------+--------+-----+----------------+ | Gateway Information | -- | O | Z | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | | | | | | | C1: Reserved for 3GPP2: | | | | | only present if M-IMAP | | | | | or SIP indicated in tag | | | | | 80. | | | | | | | | | | C2: Only present if WAP | | | | | is indicated in tag 80. | | | | +-------------------------+--------+-----+----------------+
\- MMS Implementation Tag \'80\'
See clause 4.2.67 for contents and coding.
\- MMS Relay/server Tag \'81\'
Contents:
The MMS relay/server contains the address of the associated MMS relay/server.
Coding:
The MMS relay/server address is coded according to the guideline provided in
TS 23.140 [38].
\- MMS Authentication Mechanism Tag \'84\'
Contents:
The MMS authentication mechanism contains the authentication mechanism used
for M-IMAP and SIP.
Coding:
The MMS authentication mechanism is coded according to the guidelines provided
in X.S0016‑000‑A v1.0 [45].
\- MMS Authentication User Name Tag \'85\'
Contents:
The MMS Authentication User Name contains the authentication user name used
for M-IMAP and SIP.
Coding:
The MMS authentication User Name is coded according to the guidelines provided
in X.S0016‑000‑A v1.0 [45].
\- Interface to Core Network and Bearer Information Tag \'82\'
Contents:
The Interface to Core Network and Bearer Information may contain the following
information to set up the bearer: Bearer, Address, Type of address, Speed,
Call type, Authentication type, Authentication id, Authentication password.
Coding:
The coding is according to the guideline provided in TS 23.140 [38].
\- Gateway Tag \'83\'
Contents:
The Gateway may contain the following information; Address, Type of address,
Port, Service, Authentication type, Authentication id and Authentication
password.
Coding:
The coding is according to the guideline provided in TS 23.140 [38].
Unused bytes shall be set to \'FF\'.
An Example for the coding of these parameters can be found in Annex J.2.
### **4.2.70 EF~MMSUP~ (MMS User Preferences)**
If service n°52 is \"available\", this file shall be present.
This EF contains values for Multimedia Messaging Service User Preferences,
which can be used by the ME for user assistance in preparation of mobile
multimedia messages (e.g. default values for parameters that are often used).
+------------------------+---------------------------------+----------+---------+ | Identifier: \'6FD1\' | Structure: Linear Fixed | Optional | | +------------------------+---------------------------------+----------+---------+ | Record Length: X bytes | Update activity: low | | | +------------------------+---------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+---------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+---------------------------------+----------+---------+ | 1 to X | MMS User Preference TLV Objects | M | X bytes | +------------------------+---------------------------------+----------+---------+
MMS User Preference tags
* * *
Description Tag Value MMS Implementation Tag \'80\' MMS User preference
profile name Tag \'81\' MMS User Preference information Tag \'82\'
* * *
MMS User Preference information
* * *
Description Value M/O Length (bytes) MMS Implementation Tag \'80\' M 1 Length
1 M Note MMS Implementation information -- M 1 MMS User preference profile
name Tag \'81\' M 1 Length X M Note MMS User profile name -- M X MMS User
Preference information Tag \'82\' M 1 Length Y M Note MMS User Preference
information -- M Y Note: The length is coded according to ISO/IEC 8825-1 [35]
* * *
\- MMS Implementation Tag \'80\'
For contents and coding see 4.2.67
\- MMS User preference profile name Tag \'81\'
Contents:
Alpha tagging of the MMS user preference profile.
Coding:
this alpha‑tagging shall use either:
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified.
Or:
\- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
\- MMS User Preference information Tag \'82\'
Contents:
The following information elements may be coded; Sender Visibility, Delivery
Report, Read-Reply, Priority, Time of Expiry and Earliest Delivery Time.
Coding:
Depending upon the MMS implementation as indicated in Tag \'80\'.
An Example for the coding of these parameters can be found in Annex J.1.
### **4.2.71 EF~MMSUCP~ (MMS User Connectivity Parameters)**
If service n°52 and n°55 are \"available\", this file shall be present.
This EF contains values for Multimedia Messaging Connectivity Parameters as
determined by the user, which can be used by the ME for MMS network
connection. This file may contain one or more sets of Multimedia Messaging
User Connectivity Parameters. Each set of Multimedia Messaging User
Connectivity Parameters may consist of one or more Interface to Core Network
and Bearer information TLV objects, but shall contain only one MMS
implementation TLV object, one MMS Relay/Server TLV object and one Gateway TLV
object. The order of the Interface to Core Network and Bearer information TLV
objects in the MMS Connectivity TLV object defines the priority of the
Interface to Core Network and Bearer information, with the first TLV object
having the highest priority.
+---------------------+---------------------+----------+------------+ | Identifier: | Structure: | Optional | | | \'6FD2\' | Transparent | | | +---------------------+---------------------+----------+------------+ | File Size: | Update activity: | | | | X~1~+...+ X~n~ | low | | | | bytes | | | | +---------------------+---------------------+----------+------------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/PIN2 | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+------------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+------------+ | 1 to X~1~ | MMS Connectivity | O | X~1~ bytes | | | Parameters TLV | | | | | object | | | +---------------------+---------------------+----------+------------+ | X~1~+1 to X~1~ + | MMS Connectivity | O | X~2~ bytes | | X~2~ | Parameters TLV | | | | | object | | | +---------------------+---------------------+----------+------------+ | ... | ... | | | +---------------------+---------------------+----------+------------+ | X~1~+...+ X~n-1~+1 | MMS Connectivity | O | X~n~ bytes | | to X~1~+...+ X~n~ | Parameters TLV | | | | | object | | | +---------------------+---------------------+----------+------------+
For the contents and coding see 4.2.69
### 4.2.72 EF~NIA~ (Network\'s Indication of Alerting)
If service n°56 is \"available\", this file shall be present.
This EF contains categories and associated text related to the Network\'s
indication of alerting in the MS service defined in TS 22.101 [24].
+---------------------------+-------------------------+----------+---------+ | Identifier: \'6FD3\' | Structure: linear fixed | Optional | | +---------------------------+-------------------------+----------+---------+ | Record length : X+1 bytes | Update activity: low | | | +---------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +---------------------------+-------------------------+----------+---------+ | 1 | Alerting category | M | 1 byte | +---------------------------+-------------------------+----------+---------+ | 2 to X+1 | Informative text | M | X bytes | +---------------------------+-------------------------+----------+---------+
‑ Alerting category
Contents:
category of alerting for terminating traffic.
Coding:
according to TS 24.008 [9]. Value \'FF\' means that no information on alerting
category is available.
‑ Informative text
Contents:
text describing the type of terminating traffic associated with the category.
Coding:
see the coding of the Alpha Identifier item of the EF~ADN~. The maximum number
of characters for this informative text is indicated in TS 22.101 [24].
### 4.2.73 EF~VGCS~ (Voice Group Call Service)
If service n°57 is \"available\", this file shall be present.
This EF contains a list of those VGCS group identifiers the user has
subscribed to. The elementary file is used by the ME for group call
establishment and group call reception.
+----------------------------------+------------------------+----------+---------+ | Identifier: \'6FB1\' | Structure: transparent | Optional | | +----------------------------------+------------------------+----------+---------+ | File size: 4n bytes, (1≤ n ≤ 50) | Update activity: low | | | +----------------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------------------+------------------------+----------+---------+ | 1 to 4 | Group ID 1 | M | 4 bytes | +----------------------------------+------------------------+----------+---------+ | 5 to 8 | Group ID 2 | O | 4 bytes | +----------------------------------+------------------------+----------+---------+ | : | : | : | : | +----------------------------------+------------------------+----------+---------+ | (4n‑3) to 4n | Group ID n | O | 4 bytes | +----------------------------------+------------------------+----------+---------+
‑ Group ID
Contents: VGCS Group ID, according to TS 23.003 [25]
Coding:
The VGCS Group ID is of a variable length with a maximum length of 8 digits.
Each VGCS Group ID is coded on four bytes, with each digit within the code
being coded on four bits corresponding to BCD code. If a VGCS Group ID of less
than 8 digits is chosen, then the unused nibbles shall be set to \'F\'. VGCS
Group ID Digit 1 is the most significant digit of the Group ID.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 1 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 1 of Group ID 1
                                                LSB of Digit 2 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 2 of Group ID 1
* * *
Byte 2:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 3 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 3 of Group ID 1
                                                LSB of Digit 4 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 4 of Group ID 1
* * *
Byte 3:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 5 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 5 of Group ID 1
                                                LSB of Digit 6 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 6 of Group ID 1
* * *
Byte 4:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 7 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 7 of Group ID 1
                                                LSB of Digit 8 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 8 of Group ID 1
* * *
:
: etc........
Byte (4n-3) to 4n:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 7 of Group ID n
                                                :
                                                :
                                                MSB of Digit 7 of Group ID n
                                                LSB of Digit 8 of Group ID n
                                                :
                                                :
                                                MSB of Digit 8 of Group ID n
* * *
If storage for fewer than the maximum possible number _n_ of VGCS Group Ids,
is required, the excess bytes shall be set to \'FF\'.
### 4.2.74 EF~VGCSS~ (Voice Group Call Service Status)
If service n°57 is \"available\", this file shall be present.
This EF contains the status of activation for the VGCS group identifiers. The
elementary file is directly related to the EF~VGCS~. This EF shall always be
allocated if EF~VGCS~ is allocated.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FB2\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: 7 bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/ADM | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 7 | Act | M | 7 bytes | | | ivation/Deactivation | | | | | Flags | | | +----------------------+----------------------+----------+---------+
Activation/Deactivation Flags
Contents: Activation/Deactivation Flags of the appropriate Group Ids
Coding: bit = 0 means ‑ Group ID deactivated\ bit = 1 means ‑ Group ID
activated
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Group ID 1
                                                :
                                                :
                                                :
                                                :
                                                :
                                                :
                                                Group ID 8
* * *
etc : : : : : : : :
Byte 7:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Group ID 49
                                                Group ID 50
                                                b3=1
                                                b4=1
                                                b5=1
                                                b6=1
                                                b7=1
                                                b8=1
* * *
### 4.2.75 EF~VBS~ (Voice Broadcast Service)
If service n°58 is \"available\", this file shall be present.
This EF contains a list of those VBS group identifiers the user has subscribed
to. The elementary file is used by the ME for broadcast call establishment and
broadcast call reception.
+-----------------------------------+------------------------+----------+---------+ | Identifier: \'6FB3\' | Structure: transparent | Optional | | +-----------------------------------+------------------------+----------+---------+ | File size: 4n bytes, (1 ≤ n ≤ 50) | Update activity: low | | | +-----------------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-----------------------------------+------------------------+----------+---------+ | 1 to 4 | Group ID 1 | M | 4 bytes | +-----------------------------------+------------------------+----------+---------+ | 5 to 2 | Group ID 2 | O | 4 bytes | +-----------------------------------+------------------------+----------+---------+ | : | : | : | : | +-----------------------------------+------------------------+----------+---------+ | (4n‑3) to 4n | Group ID n | O | 4 bytes | +-----------------------------------+------------------------+----------+---------+
Group ID
Contents: VBS Group ID, according to TS 23.003 [25]
Coding: The VBS Group ID is of a variable length with a maximum length of 8
digits. Each VBS Group ID is coded on four bytes, with each digit within the
code being coded on four bits corresponding to BCD code. If a VBS Group ID of
less than 8 digits is chosen, then the unused nibbles shall be set to \'F\'.
VBS Group ID Digit 1 is the most significant digit of the Group ID.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 1 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 1 of Group ID 1
                                                LSB of Digit 2 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 2 of Group ID 1
* * *
Byte 2:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 3 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 3 of Group ID 1
                                                LSB of Digit 4 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 4 of Group ID 1
* * *
Byte 3:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 5 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 5 of Group ID 1
                                                LSB of Digit 6 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 6 of Group ID 1
* * *
Byte 4:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 7 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 7 of Group ID 1
                                                LSB of Digit 8 of Group ID 1
                                                :
                                                :
                                                MSB of Digit 8 of Group ID 1
* * *
:
: etc........
Byte (4n-3) to 4n:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of Digit 7 of Group ID n
                                                :
                                                :
                                                MSB of Digit 7 of Group ID n
                                                LSB of Digit 8 of Group ID n
                                                :
                                                :
                                                MSB of Digit 8 of Group ID n
* * *
If storage for fewer than the maximum possible number _n_ of VBS Group Ids, is
required, the excess bytes shall be set to \'FF\'.
### 4.2.76 EF~VBSS~ (Voice Broadcast Service Status)
If service n°58 is \"available\", this file shall be present.
This EF contains the status of activation for the VBS group identifiers. The
elementary file is directly related to the EF~VBS~. This EF shall always be
allocated if EF~VBS~ is allocated.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FB4\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: 7 bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN/ADM | | | | | | | | | | (fixed during | | | | | administrative | | | | | management) | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 7 | Act | M | 7 bytes | | | ivation/Deactivation | | | | | Flags | | | +----------------------+----------------------+----------+---------+
Activation/Deactivation Flags
Contents: Activation/Deactivation Flags of the appropriate Group Ids
Coding: see coding of EF~VGCSS~
### 4.2.77 EF~VGCSCA~ (Voice Group Call Service Ciphering Algorithm)
If service n°64 is \"available\", this file shall be present.
This EF contains the ciphering algorithm identifiers for each of the Master
Group Key (V_Ki) of each VGCS group that the user has subscribed to (defined
in EF**~VGCS~**).
+-----------------------+-----------------------+----------+--------+ | Identifier: \'6FD4\' | Structure: | Optional | | | | transparent | | | +-----------------------+-----------------------+----------+--------+ | File size: 2n bytes, | Update activity: low | | | | (1 ≤ n ≤ 50) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | VGCS Group ciphering | M | 1 byte | | | algorithm identifier | | | | | for 1^st^ V_Ki of | | | | | Group 1 | | | +-----------------------+-----------------------+----------+--------+ | 2 | VGCS Group ciphering | M | 1 byte | | | algorithm identifier | | | | | for 2^nd^ V_Ki of | | | | | Group 1 | | | +-----------------------+-----------------------+----------+--------+ | 3 | VGCS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 1^st^ V_Ki of | | | | | Group 2 | | | +-----------------------+-----------------------+----------+--------+ | 4 | VGCS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 2^nd^ V_Ki of | | | | | Group 2 | | | +-----------------------+-----------------------+----------+--------+ | : | : | : | : | +-----------------------+-----------------------+----------+--------+ | 2n-1 | VGCS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 1^st^ V_Ki of | | | | | Group n | | | +-----------------------+-----------------------+----------+--------+ | 2n | VGCS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 2^nd^ V_Ki of | | | | | Group n | | | +-----------------------+-----------------------+----------+--------+
Ciphering Algorithm Identifier:
Contents: Ciphering Algorithm identifier for the specified Master Group Key of
each Voice Call Group
Coding:
* * *
Value \'00\' no ciphering \'01\' ciphering with algorithm GSM A5/1 \'02\'
ciphering with algorithm GSM A5/2 \'03\' ciphering with algorithm GSM A5/3
\'04\' ciphering with algorithm GSM A5/4 \'05\' ciphering with algorithm GSM
A5/5 \'06\' ciphering with algorithm GSM A5/6 \'07\' ciphering with algorithm
GSM A5/7 \'08\' to \'FF\' RFU
* * *
### 4.2.78 EF~VBSCA~ (Voice Broadcast Service Ciphering Algorithm)
If service n°65 is \"available\", this file shall be present.
This EF contains the ciphering algorithm identifiers for each of the Master
Group Key (V_Ki) of each VBS group that the user has subscribed to (defined in
EF**~VBS~**).
+-----------------------+-----------------------+----------+--------+ | Identifier: \'6FD5\' | Structure: | Optional | | | | transparent | | | +-----------------------+-----------------------+----------+--------+ | File size: 2n bytes, | Update activity: low | | | | (1 ≤ n ≤ 50) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | VBS Group ciphering | M | 1 byte | | | algorithm identifier | | | | | for 1^st^ V_Ki of | | | | | Group 1 | | | +-----------------------+-----------------------+----------+--------+ | 2 | VBS Group ciphering | M | 1 byte | | | algorithm identifier | | | | | for 2^nd^ V_Ki of | | | | | Group 1 | | | +-----------------------+-----------------------+----------+--------+ | 3 | VBS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 1^st^ V_Ki of | | | | | Group 2 | | | +-----------------------+-----------------------+----------+--------+ | 4 | VBS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 2^nd^ V_Ki of | | | | | Group 2 | | | +-----------------------+-----------------------+----------+--------+ | : | : | : | : | +-----------------------+-----------------------+----------+--------+ | 2n-1 | VBS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 1^st^ V_Ki of | | | | | Group n | | | +-----------------------+-----------------------+----------+--------+ | 2n | VBS Group ciphering | O | 1 byte | | | algorithm identifier | | | | | for 2^nd^ V_Ki of | | | | | Group n | | | +-----------------------+-----------------------+----------+--------+
Ciphering Algorithm Identifier:
Contents: Ciphering Algorithm identifier for the specified Master Group Key of
each Voice Broadcast Group
Coding: See coding of EF**~VGCSCA~**
### 4.2.79 EF~GBABP~ (GBA Bootstrapping parameters)
If service n°68 is \"available\", this file shall be present.
This EF contains the AKA Random challenge (RAND) and Bootstrapping Transaction
Identifier (B-TID) associated with a GBA bootstrapping procedure.
+----------------------------+------------------------+----------+---------+ | Identifier: \'6FD6\' | Structure: transparent | Optional | | +----------------------------+------------------------+----------+---------+ | File length: L+X+N+3 bytes | Update activity: low | | | +----------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------------+------------------------+----------+---------+ | 1 | Length of RAND (X) | M | 1 byte | +----------------------------+------------------------+----------+---------+ | 2 to (X +1) | RAND | M | X bytes | +----------------------------+------------------------+----------+---------+ | X+2 | Length of B-TID (L) | M | 1 byte | +----------------------------+------------------------+----------+---------+ | (X+3) to (X+2+L) | B-TID | M | L bytes | +----------------------------+------------------------+----------+---------+ | X+L+3 | Length of key lifetime | M | 1 byte | +----------------------------+------------------------+----------+---------+ | (X+L+4) to (X+L+N+3) | Key lifetime | M | N bytes | +----------------------------+------------------------+----------+---------+
Length of RAND
Contents: number of bytes, not including this length byte, of RAND field
RAND
Contents: Random challenge used in the GBA_U bootstrapping procedure.
Coding: as defined in TS 33.103 [13]
Length of B-TID
Contents: number of bytes, not including this length byte, of B-TID field
B-TID
Content: Bootstrapping Transaction Identifier the GBA_U bootstrapped keys
Coding: As defined in TS 33.220 [42]
Length of key lifetime
Contents: number of bytes, not including this length byte, of key lifetime
field
Key lifetime
Content: Lifetime of the GBA_U bootstrapped keys
Coding: As defined in TS 33.220 [42]
### 4.2.80 EF~MSK~ (MBMS Service Keys List)
If service n°69 is \"available\", this file shall be present.
A record of this EF contains the list of MBMS Service Keys (MSK) and
associated parameters, which are related to an MBMS Key Domain. There are up
to two MSKs per Key Domain ID/Key Group ID pair, where the Key Group ID is the
Key Group part of the MSK ID as defined in TS 33.246 [43]. Two 4 byte MSK IDs
stored within a record have the same value for the 2 byte Key Group part.
+---------------------+---------------------+------------+---------+ | Identifier: | Structure: linear | Optional | | | \'6FD7\' | fixed | | | +---------------------+---------------------+------------+---------+ | Record length: 8n+4 | Update activity: | | | | bytes, (n ≥ 2) | high | | | +---------------------+---------------------+------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+------------+---------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+------------+---------+ | 1 to 3 | Key Domain ID | M | 3 bytes | +---------------------+---------------------+------------+---------+ | 4 | Number of stored | M | 1 byte | | | MSK IDs and | | | | | corresponding TS | | | +---------------------+---------------------+------------+---------+ | 5 to 8 | 1^st^ MSK ID | M | 4 bytes | +---------------------+---------------------+------------+---------+ | 9 to 12 | 1^st^ Time Stamp | M | 4 bytes | | | Counter (TS) | | | +---------------------+---------------------+------------+---------+ | 13 to 16 | 2^nd^ MSK ID | M | 4 bytes | +---------------------+---------------------+------------+---------+ | 17 to 20 | 2^nd^ Time Stamp | M | 4 bytes | | | Counter (TS) | | | +---------------------+---------------------+------------+---------+ | : | : | : | : | +---------------------+---------------------+------------+---------+ | 8(n-1)+5 to 8n | n^th^ MSK ID | O | 4 bytes | | | | | | | | | (See Note) | | +---------------------+---------------------+------------+---------+ | 8n+1 to 8n+4 | n^th^ Time Stamp | C | 4 bytes | | | Counter (TS) | | | | | | (See Note) | | +---------------------+---------------------+------------+---------+ | Note: In the | | | | | current version of | | | | | the specification, | | | | | these bytes are | | | | | RFU. | | | | +---------------------+---------------------+------------+---------+
Key Domain ID:
Content: Identifier of the Domain of the BM-SC providing MBMS Service.
Coding: As defined in TS 33.246 [43]
Number of stored MSK IDs and corresponding TS:\ Content: Number of stored MSK
IDs and corresponding Time Stamp counter (TS) within the record, as defined in
TS 33.246 [43]. This number shall not exceed the maximum limit of MSK IDs
fixed in TS 33.246 [43] (e.g if the maximum number of MSK IDs is 2, then this
byte may only take the following values: \'00\', \'01\', \'02\').\ Coding:
binary.
MSK ID:
Content: Identifier of MBMS Service Key (MSK) within a particular Key Domain.
Coding: As defined in TS 33.246 [43]
Time Stamp Counter (TS):
Content: Counter for MIKEY replay protection in MTK delivery. Each counter is
associated with a particular MSK.
Coding: As defined in TS 33.246 [43]
Any unused bytes shall be set to \'FF\'.
### 4.2.81 EF~MUK~ (MBMS User Key)
If service n°69 is \"available\", this file shall be present.
This EF contains the identifier of the MBMS User Key (MUK) that is used to
protect the transfer of MBMS Service Keys (MSK). The file also contains the
Time Stamp Counter associated with the MUK, which is used for Replay
Protection in MSK transport messages. This EF shall not contain MUK IDs with
the same Idi part.
+------------------------+---------------------------+----------+--------+ | Identifier: \'6FD8\' | Structure: linear fixed | Optional | | +------------------------+---------------------------+----------+--------+ | Record length: Z bytes | Update activity: low | | | +------------------------+---------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+---------------------------+----------+--------+ | Bytes | Description | M/O | Bytes | +------------------------+---------------------------+----------+--------+ | 1 to Z | MBMS User Key TLV objects | M | 1 to Z | +------------------------+---------------------------+----------+--------+
MBMS User Key tags
* * *
**Description** **Tag Value** MUK ID Tag \'A0\' Time Stamp Counter Tag \'81\'
* * *
MBMS User Key information
* * *
Description Value M/O Length (bytes) MUK ID Tag \'A0\' M 1 Length X M Note MUK
Idr Tag \'80\' M 1 Lenght A M Note MUK Idr value -- M A MUK Idi Tag \'82\' M 1
Lenght W M Note MUK Idi Value - M W Time Stamp Counter Tag \'81\' M 1 Length Y
M Note Time Stamp Counter value -- M Y Note: The length is coded according to
ISO/IEC 8825-1 [35]
* * *
\- MUK ID Tag \'A0\'. This constructed data object consists of the Idr, and
the Idi
\- Idr Tag \'80\'
Content:
Idr part of MBMS User Key (MUK).
Coding:
As defined in TS 33.246 [43]
\- Idi Tag \'82\'
Content:
Idi part of MBMS User Key (MUK).
Coding:
As defined in TS 33.246 [43]
\- Time Stamp Counter Tag \'81\'
Content:
> Counter for MIKEY replay protection in MSK delivery. The counter is
> associated with the particular MUK. The length value is defined in TS 33.246
> [43].
Coding:
As defined in TS 33.246 [43]
Unused bytes shall be set to \'FF\'.
### 4.2.82 Void
### 4.2.83 EF~GBANL~ (GBA NAF List)
If service n°68 is \"available\", this file shall be present.
This EF contains the list of NAF_ID and B-TID associated to a GBA NAF
derivation procedure.
+------------------------+--------------------------------+----------+---------+ | Identifier: \'6FDA\' | Structure: Linear fixed | Optional | | +------------------------+--------------------------------+----------+---------+ | Record length: Z bytes | Update activity: low | | | +------------------------+--------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+--------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+--------------------------------+----------+---------+ | 1 to Z | NAF Key Identifier TLV objects | M | Z bytes | +------------------------+--------------------------------+----------+---------+
NAF Key Identifier tags
* * *
**Description** **Tag Value** NAF_ID Tag \'80\' B-TID Tag \'81\'
* * *
NAF Key Identifier information
* * *
Description Value M/O Length (bytes) NAF_ID Tag \'80\' M 1 Length X M Note
NAF_ID value -- M X B-TID Tag \'81\' M 1 Length Y M Note B-TID value -- M Y
Note: The length is coded according to ISO/IEC 8825-1 [35]
* * *
\- NAF_ID Tag \'80\'
Contents:
Identifier of Network Application Function used in the GBA_U NAF Derivation
procedure.
Coding:
As defined in TS 33.220 [42]
\- B-TID Tag \'81\'
Content:
Bootstrapping Transaction Identifier of the GBA_U bootstrapped key
Coding:
As defined in TS 33.220 [42]
Unused bytes shall be set to \'FF\'
### 4.2.84 EF~EHPLMN~ (Equivalent HPLMN)
If service n°71 is \"available\", this file shall be present.
This EF contains the coding for n EHPLMNs. The usage of EHPLMN is defined in
TS 23.122 [31]. This data field may contain the HPLMN code derived from the
IMSI as an EHPLMN entry.
+-----------------------+---------------------------------+----------+---------+ | Identifier: \'6FD9\' | Structure: transparent | Optional | | +-----------------------+---------------------------------+----------+---------+ | SFI: \'1D\' | | | | +-----------------------+---------------------------------+----------+---------+ | File size: 3n, (n ≥1) | Update activity: low | | | +-----------------------+---------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+---------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-----------------------+---------------------------------+----------+---------+ | 1 to 3 | 1^st^ EHPLMN (highest priority) | M | 3 bytes | +-----------------------+---------------------------------+----------+---------+ | 4 to 6 | 2^nd^ EHPLMN | O | 3 bytes | +-----------------------+---------------------------------+----------+---------+ | : | : | | | +-----------------------+---------------------------------+----------+---------+ | (3n-2) to (3n) | n^th^ EHPLMN (lowest priority) | O | 3 bytes | +-----------------------+---------------------------------+----------+---------+
‑ EHPLMN
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- according to TS 24.008 [9].
Unused entries shall be set to \'FF FF FF\'
### 4.2.85 EF~EHPLMNPI~ (Equivalent HPLMN Presentation Indication)
If service n°71 and service n°73 are \"available\", this file shall be
present.
This EF contains an indication to the ME for the presentation of the available
EHPLMN(s). The usage of the EHPLMN presentation indication is defined in TS
23.122 [31].
+----------------------+--------------------------------+----------+--------+ | Identifier: \'6FDB\' | Structure: transparent | Optional | | +----------------------+--------------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+--------------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------------+----------+--------+ | 1 | EHPLMN Presentation Indication | M | 1 byte | +----------------------+--------------------------------+----------+--------+
\- EHPLMN Presentation Indication:
> Contents:
EHPLMN display mode
Coding:
\- \'00\' - No preference for the display mode
\- \'01\' - Display the highest-priority available EHPLMN only
\- \'02\' - Display all the available EHPLMNs
\- All other values are RFU
### 4.2.86 EF~LRPLMNSI~ (Last RPLMN Selection Indication)
If service n°74 is \"available\", this file shall be present.
This EF contains an indication to the ME for the selection of the RPLMN or the
home network at switch on, or following recovery from lack of coverage. The
usage of the Last RPLMN Selection Indication is defined in TS 23.122 [31].
+----------------------+---------------------------------+----------+--------+ | Identifier: \'6FDC\' | Structure: transparent | Optional | | +----------------------+---------------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+---------------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------------+----------+--------+ | 1 | Last RPLMN Selection Indication | M | 1 byte | +----------------------+---------------------------------+----------+--------+
\- Last RPLMN Selection Indication:
> Contents:
Last RPLMN Selection Indication
Coding:
\- \'00\' - The UE shall attempt registration on the last RPLMN at switch-on
or recovery from out-of-coverage as described in TS 23.122 [31]
\- \'01\' - The UE shall attempt registration either on the HPLMN or the last
RPLMN at switch-on or recovery from out-of-coverage as described in TS 23.122
[31]
\- All other values are RFU
### 4.2.87 EF~NAFKCA~ (NAF Key Centre Address)
If service n°68 and service n°76 are \"available\", this file shall be
present.
This EF contains one or more NAF Key Centre addresses. The first record in the
EF shall be considered to be of the highest priority. The last record in the
EF shall be considered to be the lowest priority.
+------------------------+---------------------------+----------+---------+ | Identifier: \'6FDD\' | Structure: Linear fixed | Optional | | +------------------------+---------------------------+----------+---------+ | Record length: Z bytes | Update activity: low | | | +------------------------+---------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+---------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+---------------------------+----------+---------+ | 1 to Z | NAF Key Centre TLV object | M | Z bytes | +------------------------+---------------------------+----------+---------+
Unused bytes shall be set to \'FF\'.
NAF Key Centre tags
Description Tag Value
* * *
**NAF Key Centre address Tag** **\'80\'**
NAF Key Centre information
Description Value M/O Length (bytes)
* * *
**NAF Key Centre address Tag** **\'80\'** **M** **1** **Length** **X** **M**
**Note** **NAF Key Centre address value** **\--** **M** **X** **Note: The
length is coded according to ISO/IEC 8825-1 [35].**
\- NAF Key Centre Address value (Tag \'80\')
Contents:\ Fully qualified Domain Name (FQDN) of the NAF Key Centre used in
the Local Key Establishment procedures (see TS 33.110 [47]).
Coding:\ Encoded to an octet string according to UTF-8 encoding rules as
described in IETF RFC 3629 [48].
### 4.2.88 EF~SPNI~ (Service Provider Name Icon)
If service n°78 is \"available\", this file shall be present.
This EF may contain one or several links to the service provider name icon.
When more than one link is available, it is up to the ME to choose the link
type to be used (e.g. the link type that is supported by the ME). The
requirements for the display by the ME are defined in clause 4.2.12.
+----------------------+------------------------+----------+---------+ | Identifier: \'6FDE\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+---------+ | File Size: X bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 to X | Icon TLV object(s) | M | X bytes | +----------------------+------------------------+----------+---------+
This file may contain one or several service provider name Icon TLV object(s).
The coding of the service provider name Icon TLV objects is described
hereafter:
+------------------------+-----------------------+-------+--------+ | Length | Description | Value | Status | +------------------------+-----------------------+-------+--------+ | 1 byte | Icon Tag (See Note 1) | -- | M | +------------------------+-----------------------+-------+--------+ | 1 byte | Length (see Note 2) | Y+1 | M | +------------------------+-----------------------+-------+--------+ | 1 byte | Icon Qualifier | -- | M | +------------------------+-----------------------+-------+--------+ | Y bytes | Icon Link | -- | M | +------------------------+-----------------------+-------+--------+ | Note 1: The tag value | | | | | indicates the type and | | | | | format of the Icon | | | | | Link that is provided | | | | | in the TLV value field | | | | | (e.g. Tag \'80\' | | | | | indicates that the | | | | | Icon link is a URI, | | | | | while Tag \'81\' | | | | | indicates that the | | | | | Icon Link is the | | | | | record number of the | | | | | corresponding image in | | | | | EF~IMG~). | | | | | | | | | | Note 2: coded | | | | | according to ISO/IEC | | | | | 8825-1 [35]. | | | | +------------------------+-----------------------+-------+--------+
‑ Icon Tag
Contents: Tag value.
\- When the Icon Link is an URI, the Tag value shall be set to \'80\'.
> \- When the Icon Link is a pointer to the record number of the corresponding
> image in EF~IMG~, the Tag value shall be set to \'81\'.
>
> \- All other values are RFU.
Coding: binary.
\- Icon Qualifier
Contents: The icon qualifier indicates to the ME how the icon shall be used.
\- \'01\' = icon is self-explanatory, i.e. if displayed, it replaces the
corresponding name in text format.
\- \'02\' = icon is not self-explanatory, i.e. if displayed, it shall be
displayed together with the corresponding name in text format.
> \- All other values are RFU.
Coding: binary.
‑ Icon Link
Contents: Link to the icon. This link shall point to a UICC resource.
Coding:
> \- When the Tag value indicates an URI (i.e. Tag = \'80\') , the Icon Link
> shall be encoded to an octet string according to UTF-8 encoding rules as
> described in IETF RFC 3629 [48] (e.g.
> http://127.0.0.1:3516/pub/files/spng.jpg).
>
> \- When the Tag value indicates that the Icon Link contains the record
> number of the corresponding image in EF~IMG~ (i.e. Tag = \'81\'), the Icon
> Link shall be encoded in binary.
### 4.2.89 EF~PNNI~ (PLMN Network Name Icon)
If service n°79 is \"available\", this file shall be present.
This EF contains one or several links to the PLMN network name icon. When more
than one link is available in a record, it is up to the ME to choose the link
type to be used (e.g. the link type that is supported by the ME).
+------------------------+-------------------------+----------+---------+ | Identifier: \'6FDF\' | Structure: linear fixed | Optional | | +------------------------+-------------------------+----------+---------+ | Record length: X bytes | Update activity: low | | | +------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+-------------------------+----------+---------+ | 1 to X | Icon TLV object(s) | M | X bytes | +------------------------+-------------------------+----------+---------+
Each record may contain one or several PLMN network name Icon TLV object(s).
The coding of the Icon TLV object(s) is described in EF~SPNI~.
### 4.2.90 EF~NCP-IP~ (Network Connectivity Parameters for USIM IP
connections)
If service n°80 is \"available\", this file shall be present.
This EF contains the network activation parameters to be used by the ME for
establishing a data channel (e.g. PDP context activation) for UICC remote IP
connectivity as described in ETSI TS 102 483 [50].
Each record contains a network connectivity parameters set. A network
connectivity parameters set may comprise an Access Point Name, a Login and
Password of the Access Point Name, a Data Destination Address Range and the
Bearer Description. The priority order of the different Network Connectivity
Parameters sets is the same as the order of the record numbers.
Each network connectivity parameters set provides a condition and the network
connectivity parameters to be used when this condition is met:
\- The network activation parameters present in a record shall be associated
with this Data Destination Address Range in the same record (i.e. if a record
contains a Data Destination Address Range, all IP packets that are sent by the
UICC to any network destination address belonging to this Address Range shall
transit through a network connection established using the parameters provided
in that record).
> Note: A Data Destination Address Range TLV with a zero length prefix matches
> all addresses of the address type.
In a record, if the Access Point Name has a value part, the associated Login
and Password may be provided. If supported by the ME, the Login and Password
may be used for Access Point Name authentication. If only the Login is
present, the ME shall use its default Password configuration if any. If the
Login and Password are not present, the ME shall use its default
Login/Password configuration if any. If no authentication is requested, the
Login and Password shall be ignored. The Password TLV can only be provided in
a record if a Login TLV is provided in the same record.
In any record, if the Access Point Name has no value part, the ME may use its
default Access Point Name or the default subscription value together with the
other network connectivity parameters of that record.
When present, the Bearer Description TLV provides recommended values for
parameters that the ME should use to establish the data link for UICC remote
IP connections. However if the ME or network does not support these values,
the ME selects the most appropriate values.
Structure of EF~NCP-IP~
+------------------------+------------------------------------+----------+---------+ | Identifier: \'6FE2\' | Structure: linear fixed | Optional | | +------------------------+------------------------------------+----------+---------+ | Record length: Z bytes | Update activity: low | | | +------------------------+------------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+------------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+------------------------------------+----------+---------+ | 1 to M | Data Destination Address Range TLV | M | M bytes | +------------------------+------------------------------------+----------+---------+ | M+1 to M+N | Access Point Name TLV | M | N bytes | +------------------------+------------------------------------+----------+---------+ | M+N+1 to M+N+O | Login TLV | C | O bytes | +------------------------+------------------------------------+----------+---------+ | M+N+O+1 to M+N+O+P | Password TLV | C | P bytes | +------------------------+------------------------------------+----------+---------+ | M+N+O+P+1 to M+N+O+P+Q | Bearer description TLV | C | Q bytes | +------------------------+------------------------------------+----------+---------+
‑ Data Destination Address Range TLV
> Contents: the data destination address or the range of data destination
> addresses.
>
> Coding: the coding of the Data Destination Address Range TLV object is
> described hereafter.
+------------------+------------------+------------------+--------+ | Length | Description | Value | Status | +------------------+------------------+------------------+--------+ | 1 byte | Data Destination | 83 | M | | | Address Range | | | | | Tag | | | +------------------+------------------+------------------+--------+ | 1 byte | Length (see | X | M | | | note1) | | | +------------------+------------------+------------------+--------+ | 1 byte | Type of Address | -- | M | +------------------+------------------+------------------+--------+ | 1 byte | Prefix length | \'00\' to \'20\' | M | | | (in bits) | for IPv4 | | | | | | | | | | \'00\' to \'80\' | | | | | for IPv6 | | +------------------+------------------+------------------+--------+ | 0 to 16 bytes | Prefix | -- | | +------------------+------------------+------------------+--------+ | Note 1: coded | | | | | according to | | | | | ISO/IEC 8825-1 | | | | | [35]. | | | | +------------------+------------------+------------------+--------+
‑ Type of Address
Contents: the type of data destination address range.
Coding:
\- \'21\' = IPv4 address range;
\- \'57\' = IPv6 address range;
\- Other values are RFU.
\- Prefix length
Contents: the number N of valid bits of the prefix of the address range. A
prefix length of zero denotes the default \"all IP addresses\" range.
Coding: binary
‑ Prefix
Contents: Prefix, i.e. the leftmost bits of the address range. All addresses
where the leftmost N bits match the prefix belong to the address range.
Coding:
> \- the leftmost N bits encode the prefix of the address range. If N is not
> an integer multiple of 8, the prefix is right padded with zeroes to the next
> octet boundary.
‑ Access Point Name TLV
> Contents: Access Point Name provides information to the ME necessary to
> identify the Gateway entity which provides interworking with an external
> packet data network.
>
> Coding: the coding of the Access Point Name TLV object is described
> hereafter. The Access Point Name Value is coded as defined in TS 23.003
> [25].
* * *
Length Description Value Status 1 byte Access Point Name Tag 80 M 1 byte
Length (see note 1) W M W bytes Access Point Name Value -- M Note 1: coded
according to ISO/IEC 8825-1 [35].
* * *
‑ Login TLV
> Contents: the login of the Access Point Name.
>
> Coding: the coding of the Login TLV object is described hereafter. The Login
> Value is coded as for SMS Data coding scheme defined in TS 23.038 [5]. Parts
> of the data coding scheme other than the character set indication shall be
> ignored.
* * *
Length Description Value Status 1 byte Login Tag 81 M 1 byte Length (see note
1) X M X bytes Login Value -- M Note 1: coded according to ISO/IEC 8825-1
[35].
* * *
‑ Password TLV
> Contents: the password of the Access Point Name.
>
> Coding: the coding of the Password TLV object is described hereafter. The
> Password Value is coded as for SMS Data coding scheme defined in TS 23.038
> [5]. Parts of the data coding scheme other than the character set indication
> shall be ignored.
* * *
Length Description Value Status 1 byte Password Tag 82 M 1 byte Length (see
note 1) Y M Y bytes Password Value -- M Note 1: coded according to ISO/IEC
8825-1 [35].
* * *
‑
‑ Bearer Description TLV
> Contents: bearer description.
>
> Coding: the coding of the Bearer Description TLV object is described
> hereafter. The Bearer Description Value is encoded as the value part of the
> \"Bearer description\" TLV data object defined in TS 31.111 [12].
* * *
Length Description Value Status 1 byte Bearer Description Tag 84 M 1 byte
Length (see note 1) Z M Z bytes Bearer Description Value -- M Note 1: coded
according to ISO/IEC 8825-1 [35].
* * *
Any unused bytes shall be set to \'FF\'.
### 4.2.91 EF~EPSLOCI~ (EPS location information)
If service n°85 is \"available\", this file shall be present.
This EF contains the following EPS location information:
‑ Globally Unique Temporary Identifier (GUTI);
‑ Last visited registered Tracking Area Identity (TAI);
‑ EPS update status.
+----------------------+-----------------------------+----------+----------+ | Identifier: \'6FE3\' | Structure: transparent | Optional | | +----------------------+-----------------------------+----------+----------+ | SFI: \'1E\' | | | | +----------------------+-----------------------------+----------+----------+ | File size: 18 bytes | Update activity: high | | | +----------------------+-----------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-----------------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+-----------------------------+----------+----------+ | 1 to 12 | GUTI | M | 12 bytes | +----------------------+-----------------------------+----------+----------+ | 13 to17 | Last visited registered TAI | M | 5 bytes | +----------------------+-----------------------------+----------+----------+ | 18 | EPS update status | M | 1 byte | +----------------------+-----------------------------+----------+----------+
‑ GUTI.
> Contents:
Globally Unique Temporary Identifier.
> Coding:
as the GUTI part of the EPS mobile identity information element defined in TS
24.301 [51]. Byte 1 corresponds to \"octet 2\" of an EPS mobile identity
information element containing a GUTI. Byte 12 corresponds to \"octet 13\" of
an EPS mobile identity information element information element containing a
GUTI.
Byte 1: first byte of GUTI
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
‑ Last visited registered TAI
Contents:
Last visited registered Tracking Area Identity.
Coding:
as the content of the tracking area identity information element defined in TS
24.301 [51]. Byte 13 corresponds to \"octet 2\" of a tracking area identity
information element. Byte 17 corresponds to \"octet 6\" of a tracking area
identity information element.
Byte 13: first byte of last visited registered TAI
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
‑ EPS update status.
Contents:
status of EPS update according to TS 24.301 [51].
Coding:
byte 18:
Bits: b3 b2 b1.
0 0 0 : UPDATED.
0 0 1 : NOT UPDATED.
0 1 0 : ROAMING NOT ALLOWED.
0 1 1 : reserved.
1 0 0 : reserved.
1 0 1 : reserved.
1 1 0 : reserved.
1 1 1 : reserved.
Bits b4 to b8 are RFU (see TS 31.101 [11]).
Unused bytes shall be set to \'FF\'.
### 4.2.92 EF~EPSNSC~ (EPS NAS Security Context)
If service n°85 is \"available\", this file shall be present.
This EF contains the EPS NAS Security context as defined in TS 33.401 [52].
This file shall contain only one record.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FE4\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'18\' | | | | +----------------------+----------------------+----------+---------+ | Record size: X bytes | Update activity: | | | | (X≥54) | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | EPS NAS Security | M | X bytes | | | Context TLV Object | | | +----------------------+----------------------+----------+---------+
EPS NAS Security Context tags
* * *
Description Tag Value EPS NAS Security Context Tag \'A0\'
* * *
EPS NAS Security Context information
* * *
Description Value M/O Length (bytes) EPS NAS Security Context Tag \'A0\' M 1
Length (length of all subsequent data) Y M Note 1 Key set identifier KSI~ASME~
Tag \'80\' M 1 Length K M Note 1 Key set identifier KSI~ASME~ -- M K ASME key
(K~ASME~) Tag \'81\' M 1 Length L M Note 1 ASME key (K~ASME~) -- M L Uplink
NAS count Tag \'82\' M 1 Length M M Note 1 Uplink NAS count -- M M Downlink
NAS count Tag \'83\' M 1 Length N M Note 1 Downlink NAS count -- M N
Identifiers of selected NAS integrity and encryption algorithms Tag \'84\' M 1
Length S M Note 1 Identifiers of selected NAS integrity and encryption
algorithms -- M S Note 1: The length is coded according to ISO/IEC 8825-1 [35]
* * *
\- Key set identifier KSI~ASME~ Tag \'80\'
Contents:
The ASME key set identifier as defined in TS 33.401 [52]. In this release the
KSI~ASME~ is coded on 1 byte.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                KSI~ASME~
                                                bits b4 to b8 are coded 0
* * *
\- ASME key (K~ASME~) Tag \'81\'
Contents:
The ASME Key as defined in TS 33.401 [52]. In this release a valid ASME key is
coded on 32 bytes. The ME shall treat any ASME key values stored in this EF as
invalid if the ASME key set identifier indicates that no ASME key is available
or if the length indicated in the ASME key TLV is set to \'00\',
Coding:
The most significant bit of K~ASME~ is the most significant bit of the 1^st^
byte of this TLV value field. The least significant bit of K~ASME~ is the
least significant bit of the last byte of this TLV value field.
\- Uplink NAS count Tag \'82\'
Contents:
The uplink NAS count as defined in TS 33.401 [52]. In this release the Uplink
NAS count is coded on 4 bytes.
Coding:
The most significant bit of the uplink NAS count is the most significant bit
of the 1^st^ byte of this TLV value field. The least significant bit of the
uplink NAS count is the least significant bit of the last byte of this TLV
value field.
\- Downlink NAS count Tag \'83\'
Contents:
The downlink NAS count as defined in TS 33.401 [52]. In this release the
downlink NAS count is coded on 4 bytes.
Coding:
The most significant bit of the downlink NAS count is the most significant bit
of the 1^st^ byte of this TLV value field. The least significant bit of the
downlink NAS count is the least significant bit of the last byte of this TLV
value field.
\- Identifiers of selected NAS integrity and encryption algorithms Tag \'84\'
Contents:
The identifiers of selected NAS integrity and encryption algorithms as defined
in TS 33.401 [52] and TS 24.301 [51]. In this release the identifiers of
selected NAS integrity and encryption algorithms are coded on 1 byte.
Coding:
as the content of the NAS security algorithms information element defined in
TS 24.301 [51].
Byte 1 of this TLV value field: first byte of the NAS security algorithms
information element
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
Unused bytes shall be set to \'FF\'.
In order to mark the stored EPS NAS security context as invalid:
\- the record bytes shall be set to \'FF\', or
\- the KSI~ASME~ is set to \'07\', or
\- the length indicated in the ASME key TLV is set to \'00\'.
### 4.2.93 EFUFC (USAT Facility Control)
This EF contains data for USAT Facility Control related to AT commands for
USAT (see TS 31.111 [12]).
+-----------------------------+------------------------+----------+---------+ | Identifier: \'6FE6\' | Structure: transparent | Optional | | +-----------------------------+------------------------+----------+---------+ | File size: X bytes, (X ≥ 1) | Update activity: low | | | +-----------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-----------------------------+------------------------+----------+---------+ | 1 to X | Facility list | M | X bytes | +-----------------------------+------------------------+----------+---------+
The facility list has the same format as the TERMINAL PROFILE defined in TS
31.111 [12].
By setting the corresponding bits to 1, the facility list defines facilities
which can only be provided by the MT and which are not allowed to be provided
by the TE.
If a TERMINAL PROFILE is longer than the facility list, for the purpose of
facility control, the exceeding bytes of the TERMINAL PROFILE shall be
compared according to the generic rules found in TS 31.111 [12].
### 4.2.94 EF~NASCONFIG~ (Non Access Stratum Configuration)
If service n°96 is \"available\", this file shall be present. This EF contains
some of the NAS configuration parameters defined in TS 24.368 [65]. For each
of these NAS configuration parameters, a parameter provided in EF~NASCONFIG~
shall take precedence over the corresponding parameter stored in the ME\'s
non-volatile memory.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FE8\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | NAS configuration | M | Z bytes | | | parameter TLV | | | | | objects | | | +----------------------+----------------------+----------+---------+
NAS configuration parameter information
+------------------------+--------+-------+----------------+ | Description | Value | M/O/C | Length (bytes) | +------------------------+--------+-------+----------------+ | NAS signalling | \'80\' | O | 1 | | priority Tag | | | | +------------------------+--------+-------+----------------+ | Length | L1 | C | Note 1 | +------------------------+--------+-------+----------------+ | NAS signalling | -- | C | L1 | | priority value | | | | +------------------------+--------+-------+----------------+ | NMO I Behaviour Tag | \'81\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | L2 | C | Note 1 | +------------------------+--------+-------+----------------+ | NMO I Behaviour value | -- | C | L2 | +------------------------+--------+-------+----------------+ | Attach with IMSI Tag | \'82\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | L3 | C | Note 1 | +------------------------+--------+-------+----------------+ | Attach with IMSI value | -- | C | L3 | +------------------------+--------+-------+----------------+ | Minimum Periodic | \'83\' | O | 1 | | Search Timer Tag | | | | +------------------------+--------+-------+----------------+ | Length | L4 | C | Note 1 | +------------------------+--------+-------+----------------+ | Minimum Periodic | -- | C | L4 | | Search Timer value | | | | +------------------------+--------+-------+----------------+ | Extended access | \'84\' | O | 1 | | barring Tag | | | | +------------------------+--------+-------+----------------+ | Length | L5 | C | Note 1 | +------------------------+--------+-------+----------------+ | Extended access | -- | C | L5 | | barring value | | | | +------------------------+--------+-------+----------------+ | Timer T3245 Behaviour | \'85\' | O | 1 | | Tag | | | | +------------------------+--------+-------+----------------+ | Length | L6 | C | Note 1 | +------------------------+--------+-------+----------------+ | Timer T3245 Behaviour | -- | C | L6 | | value | | | | +------------------------+--------+-------+----------------+ | _Override NAS | \'86\' | O | 1 | | signalling low | | | | | priority Tag_ | | | | +------------------------+--------+-------+----------------+ | Length | L7 | C | Note 1 | +------------------------+--------+-------+----------------+ | Override NAS | -- | C | L7 | | signalling low | | | | | priority value | | | | +------------------------+--------+-------+----------------+ | Override Extended | \'87\' | O | 1 | | access barring Tag | | | | +------------------------+--------+-------+----------------+ | Length | L8 | C | Note 1 | +------------------------+--------+-------+----------------+ | Override Extended | -- | C | L8 | | access barring value | | | | +------------------------+--------+-------+----------------+ | Fast First Higher | \'88\' | O | 1 | | Priority PLMN Search | | | | | Tag | | | | +------------------------+--------+-------+----------------+ | Length | L9 | C | Note 1 | +------------------------+--------+-------+----------------+ | Fast First Higher | -- | C | L9 | | Priority PLMN value | | | | +------------------------+--------+-------+----------------+ | E-UTRA Disabling | \'89\' | O | 1 | | Allowed for EMM cause | | | | | #15 Tag | | | | +------------------------+--------+-------+----------------+ | Length | L10 | C | Note 1 | +------------------------+--------+-------+----------------+ | E-UTRA Disabling | - | C | L10 | | Allowed for EMM cause | | | | | #15 Value | | | | +------------------------+--------+-------+----------------+ | SM_RetryWaitTime Tag | \'8A\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | L11 | C | Note 1 | +------------------------+--------+-------+----------------+ | SM_RetryWaitTime | -- | C | L11 | | value | | | | +------------------------+--------+-------+----------------+ | SM_RetryAtRATChange | \'8B\' | O | 1 | | Tag | | | | +------------------------+--------+-------+----------------+ | Length | L12 | C | Note 1 | +------------------------+--------+-------+----------------+ | SM_RetryAtRATChange | -- | C | L12 | | value | | | | +------------------------+--------+-------+----------------+ | Default_DCN_ID Tag | \'8C\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | L13 | C | Note 1 | +------------------------+--------+-------+----------------+ | Default_DCN_ID value | -- | C | L13 | +------------------------+--------+-------+----------------+ | Exception Data | \'8D\' | O | 1 | | Reporting Allowed Tag | | | | +------------------------+--------+-------+----------------+ | Length | L14 | C | Note 1 | +------------------------+--------+-------+----------------+ | Exception Data | -- | C | L14 | | Reporting Allowed | | | | | value | | | | +------------------------+--------+-------+----------------+ | RLOSPreferredPLMNList | \'8E\' | O | 1 | | Tag | | | | +------------------------+--------+-------+----------------+ | Length | L15 | C | 4n (Note 1) | +------------------------+--------+-------+----------------+ | RLOSPreferredPLMNList | -- | C | L15 | | value | | | | +------------------------+--------+-------+----------------+ | RLOSAllowedMCCList Tag | \'8F\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | L16 | C | 2n (Note 1) | +------------------------+--------+-------+----------------+ | RLOSAllowedMCCList | -- | C | L16 | | value | | | | +------------------------+--------+-------+----------------+ | No E-UTRA Disabling In | \'90\' | O | 1 | | 5GS Tag | | | | +------------------------+--------+-------+----------------+ | Length | L17 | C | Note 1 | +------------------------+--------+-------+----------------+ | Note 1 : The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35] | | | | | | | | | | Note 2: C; if the Tag | | | | | is present, this is | | | | | mandatory. | | | | +------------------------+--------+-------+----------------+
\- NAS signalling priority
Contents:
> As described in TS 24.368 [65], used to determine the NAS signalling
> priority included in NAS messages.
Coding:
> As defined for the NAS_SignallingPriority leaf in TS 24.368 [65].
\- NMO I Behaviour
Content:
> As described in TS 24.368 [65], indicates whether the \"NMO I, Network Mode
> of Operation I\" indication is applied by the UE.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 value to be interpreted as defined for the NMO\_I\_Behaviour leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
* * *
\- Attach with IMSI
Content:
> As described in TS 24.368 [65], indicates whether attach with IMSI is
> performed when moving to a non-equivalent PLMN.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 value to be interpreted as defined for the AttachWithIMSI leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
* * *
\- Minimum Periodic Search Timer
Content:
> As described in TS 24.368 [65], gives a minimum value in minutes for the
> timer T controlling the periodic search for higher prioritized PLMNs. The
> content applies a minimum value that may override the value in file
> EF~HPPLMN~ (Higher Priority PLMN search period), as specified in TS 23.122
> [31] clause 4.4.3.3.1.
Coding:
> As defined for the MinimumPeriodicSearchTimer leaf in TS 24.368 [65].
\- Extended access barring
Content:
> As described in TS 24.368 [65], indicates whether the UE applies extended
> access barring.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 value to be interpreted as defined for ExtendedAccessBarring leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
* * *
\- Timer T3245 Behaviour
Content:
> As described in TS 24.368 [65], indicates whether the timer T3245 and the
> related functionality is used by the UE.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 value to be interpreted as defined for Timer\_T3245\_Behaviour leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
* * *
\- Override NAS signalling low priority
Contents:
> As described in TS 24.368 [65], used to determine whether the NAS signalling
> priority included in NAS messages can be overriden.
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for the Override\_NAS\_SignallingLowPriority leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
> The Override NAS signalling low priority tag and the Override Extended
> access barring tag shall be set to the same value, e.g., if the UE is
> configured to override the NAS signalling low access priority indicator,
> then it has also to be configured to override Extended access barring (see
> 3GPP TS 23.401 [69] clause 4.3.17.4).
\- Override Extended access barring
Contents:
> As described in TS 24.368 [65], used to determine whether the Extended
> access barring included in NAS messages can be overriden.
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for the Override\_ ExtendedAccessBarring leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
> The Override Extended access barring tag and the Override NAS signalling low
> priority tag shall be set to the same value, e.g., if the UE is configured
> to override Extended access barring, then it has also to be configured to
> override the NAS signalling low access priority indicator (see 3GPP TS
> 23.401 [69] clause 4.3.17.4).
\- Fast First Higher Priority PLMN Search
Contents:
> Determine whether the UE can perform Fast First Higher Priority PLMN Search
> upon selecting a VPLMN as specified in 3GPP TS 23.122 [31].
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for the FastFirstHigherPriorityPLMNSearch leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
\- E-UTRA Disabling Allowed for EMM cause #15
Contents:
> Determine whether the UE is allowed to disable the E-UTRA capability when it
> receives the Extended EMM IE with value cause \"E-UTRAN not allowed\" as
> specified in 3GPP TS 24.301 [51].
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for the EUTRADisablingAllowedforEMMcause15 leaf in 3GPP TS 24.368 \[65\]
                                                RFU (see TS 31.101 \[11\])
\- SM_RetryWaitTime
Contents:
> As described in TS 24.368 [65], provides a configured UE retry wait time
> value applicable when in HPLMN or EHPLMN (see 3GPP TS 23.122 [31]) for
> controlling the UE session management retry behaviour when prior session
> management request was rejected by the network with cause value #8, #27,
> #32, #33 as specified in 3GPP TS 24.008 [9] and 3GPP TS 24.301 [51], or when
> prior session management request was rejected by the network with cause
> value #8, #27, #32, #33, #70 as specified in 3GPP TS 24.501 [104].
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                bits b1 to b8 to be interpreted as defined for the SM\_RetryWaitTime leaf in 3GPP TS 24.368 \[65\]
\- SM_RetryAtRATChange
Contents:
> As described in TS 24.368 [65], indicates the UE\'s retry behaviour when in
> HPLMN or EHPLMN (see 3GPP TS 23.122 [31]) after inter-system change between
> S1 mode and A/Gb or Iu mode or N1 mode as specified in 3GPP TS 24.008 [9]
> and 3GPP TS 24.301 [51] and 3GPP TS 24.501 [104].
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for the SM\_RetryAtRATChange leaf in 3GPP TS 24.368 \[65\]
                                                RFU (see TS 31.101 \[11\])
\- Default_DCN_ID
Contents:
> As described in 3GPP TS 24.368 [65], indicates the default DCN-ID which is
> provided by NAS to the lower layers at establishment of the NAS signalling
> connection as specified in 3GPP TS 24.301 [51].
Coding:
> As the DCN-ID value inside the DCN-ID IEI defined in TS 24.008 [9] clause
> 10.5.5.35.
\- Exception Data Reporting Allowed
Contents:
> As described in 3GPP TS 24.368 [65], for the UE in NB-S1 mode indicates
> whether the UE is allowed to use the RRC establishment cause mo-
> ExceptionData, as specified in 3GPP TS 24.301 [51].
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for the ExceptionDataReportingAllowed leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
\- RLOSPreferredPLMNList
Contents:
> As described is 3GPP TS 24.368 [65], it contains in descending priority
> order, a list of preferred RLOS PLMNs configured to the UE for selection of
> a PLMN offering access to RLOS as specified in 3GPP TS 23.122 [31].
Coding:
* * *
**Bytes** **Description** **M/O** **Length** 1 to 3 1^st^ PLMN (highest
priority) M 3 bytes 4 1^st^ PLMN Config M 1 byte 5 to 7 2^nd^ PLMN O 3 bytes 8
2^nd^ PLMN Config O 1 byte 9 to 11 3^rd^ PLMN O 3 bytes 12 3^rd^ PLMN Config O
1 byte : : : : (4n-3) to (4n-1) n^th^ PLMN O 3 bytes 4n n^th^ PLMN Config O 1
byte
* * *
Coding of PLMN Config:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0: This PLMN has higher priority than the next PLMN in the list b1=1: This PLMN has same priority than the next PLMN in the list  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
\- RLOSAllowedMCCList
Contents:
As described is 3GPP TS 24.368 [65], it contains a list of allowed MCC
configured to the UE to allow the UE to check whether the MCC of the PLMN ID
of the serving network that advertises RLOS service is present in the list and
whether the MCC part of the IMSI configured in the USIM is present in the list
of MCCs before initiating the RLOS connection as specified in 3GPP TS 23.122
[31].
Coding:
* * *
**Bytes** **Description** **M/O** **Length** 1 to 2 1^st^ MCC M 2 bytes 3 to 4
2^nd^ MCC O 2 bytes 5 to 6 3^rd^ MCC O 2 bytes : : : : (2n-1) to (2n) n^th^
MCC O 2 bytes
* * *
Coding of MCC: according to TS 24.008 [9].
\- A BCD value of \'D\' in any of the MCC digits shall be used to indicate a
\"wild\" value for that corresponding MCC digit. A value of \'DDD\' represents
\"any MCC\" value.
\- No E-UTRA Disabling In 5GS
Contents:
As described in TS 24.368 [65], used to indicate whether E-UTRA Disabling In
5GS is disabled or enabled.
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                b1 value to be interpreted as defined for NoEUTRADisablingIn5GS leaf in TS 24.368 \[65\].
                                                RFU (see TS 31.101 \[11\])
If any of these NAS configuration parameters is neither included in
EF~NASCONFIG~ nor stored in the ME\'s non-volatile memory, the default value
as defined for the corresponding leaf in TS 24.368 [65] shall apply.
Unused bytes shall be set to \'FF\'.
### 4.2.95 EF~UICCIARI~ (UICC IARI)
If service n°95 is \"available\", this file shall be present.
As specified in TS 24.229 [63] a ME includes the list of IARIs for the IMS
applications it intends to use when sending an initial registration or when
sending subsequent registrations to the IMS in the form of a SIP REGISTER
request.
This EF contains a list of IARIs associated with active applications installed
on the UICC that are included in the SIP REGISTER request in accordance with
the procedures of TS 24.229 [63].
NOTE: If this file is present in both the USIM and the ISIM, the file in the
ISIM is used. It is assumed that the presence of this file in the USIM when an
ISIM is present on the UICC is an incorrect configuration of the UICC.
+-------------------------+-------------------------+----------+---------+ | Identifier: \'6FE7\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+---------+ | Record length: X bytes. | Update activity: low | | | +-------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +-------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+---------+ | 1 to X | IARI TLV object | M | X bytes | +-------------------------+-------------------------+----------+---------+
IARI TLV object:
Contents:
\- The content and coding is defined below.
Coding of the IARI TLV objects
* * *
Length Description Value Status 1 byte IARI TLV TAG \'80\' M 1 byte Length of
IARI Y M Y bytes IARI value - M
* * *
\- Coding:
\- IMS Application Reference Identifier: shall be coded as specified in TS
24.229 [63].
Unused bytes shall be set to \'FF\'.
### 4.2.96 EF~PWS~ (Public Warning System)
If service n°97 is \"available\", this file shall be present. This EF contains
the configuration parameters for PWS, as defined in TS 22.268 [68].
+----------------------+------------------------+----------+-----------+ | Identifier: \'6FEC\' | Structure: transparent | Optional | | +======================+========================+==========+===========+ | File size: 1+Z bytes | Update activity: low | | | +----------------------+------------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +----------------------+------------------------+----------+-----------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+-----------+ | 1 to Z+1 | PWS configuration | M | 1+Z bytes | +----------------------+------------------------+----------+-----------+
Contents:
Configuration for PWS
Coding:
First byte:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0 process all PWS warning messages in HPLMN and equivalent PLMNs b1=1 ignore all PWS warning messages in HPLMN and equivalent PLMNs  
|  |  |  |  |  |  |  |  |  | b2=0 process all PWS warning messages in VPLMNs b2=1 ignore all PWS warning messages in VPLMNs  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
Successive bytes:
> RFU (see TS 31.101 [11])
### 4.2.97 EF~FDNURI~ (Fixed Dialling Numbers URI)
If service n° 2 and service n° 99 are \"available\", this file may be present.
This EF contains a list of FDN stored in URI address format. It may also
contain an associated alpha‑tagging.
Structure of EF~FDNURI~
+--------------------------+-------------------------+----------+---------+ | Identifier: \'6FED\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+---------+ | | | | | +--------------------------+-------------------------+----------+---------+ | Record length: X+Y bytes | Update activity: low | | | +--------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+---------+ | 1 to X | URI Address | M | X bytes | +--------------------------+-------------------------+----------+---------+ | X+1 to X+Y | Alpha Identifier | O | Y bytes | +--------------------------+-------------------------+----------+---------+
‑ URI Address.
> Content:\ The URI Address associated to the referenced file Record number.
>
> Coding:\ Same as URI TLV data object in EF~IMPU~ defined in TS 31.103 [64].
‑ Alpha Identifier.
> Contents:
>
> -Alpha‑tagging of the associated dialling number.
>
> Coding:
>
> this alpha‑tagging shall use either:
>
> \- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit
> 8 set to 0. The alpha identifier shall be left justified. Unused bytes shall
> be set to \'FF\'.
>
> Or:
>
> \- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
If FDN is enabled, the ME shall only allow outgoing calls using destination
addresses which are in EF~FDNURI~, in addition to the EF~FDN~ entries,
following the same principle as defined in the Fixed Number Dialling
description in TS 22.101 [24] applied to URI addresses.
The EF~FDNURI~ shall be enforced:
\- If the dialling number introduced by the user is an URI
\- Or if the dialling number has been stored in the UE as a URI
NOTE: The value of Y (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~FDN~.
### 4.2.98 EF~BDNURI~ (Barred Dialling Numbers URI)
If service n° 6 and service n° 99 are \"available\", this file may be present.
This EF contains a list of BDN stored in URI address format. It may also
contain an associated alpha‑tagging.
Structure of EF~BDNURI~
+--------------------------+-------------------------+----------+---------+ | Identifier: \'6FEE\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+---------+ | | | | | +--------------------------+-------------------------+----------+---------+ | Record length: X+Y bytes | Update activity: low | | | +--------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN2 | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+---------+ | 1 to X | URI Address | M | X bytes | +--------------------------+-------------------------+----------+---------+ | X+1 to X+Y | Alpha Identifier | O | Y bytes | +--------------------------+-------------------------+----------+---------+
‑ URI Address.
> Content:\ The URI Address associated to the referenced file Record number.
>
> Coding:\ Same as URI TLV data object in EF~IMPU~ defined in TS 31.103 [64].
‑ Alpha Identifier.
Contents:
Alpha‑tagging of the associated dialling number.
Coding:
this alpha‑tagging shall use either:
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified. Unused bytes shall be
set to \'FF\'.
or:
\- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
If BDN is enabled, the ME shall only allow outgoing calls using destination
addresses which are neither in EF~BDNURI~ nor in the EF~BDN~ entries,
following the same principle as defined in the Barring of Dialled Numbers
described in TS 22.101 [24] applied to URI addresses.
The EF~BDNURI~ shall be enforced:
\- If the dialling number introduced by the user is an URI
\- Or if the dialling number has been stored in the UE as a URI
NOTE: The value of Y (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~BDN~.
### 4.2.99 EF~SDNURI~ (Service Dialling Numbers URI)
If service n° 4 and service n° 99 are \"available\", this file may be present.
This EF contains a list of SDN stored in URI address format. It may also
contain an associated alpha‑tagging. If the service n°112 is available this
file will contain the eCall test and reconfiguration URIs that are used by an
UE in eCall and normal service mode.
Structure of EF~SDNURI~
+--------------------------+-------------------------+----------+---------+ | Identifier: \'6FEF\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+---------+ | | | | | +--------------------------+-------------------------+----------+---------+ | Record length: X+Y bytes | Update activity: low | | | +--------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+---------+ | 1 to X | URI Address | M | X bytes | +--------------------------+-------------------------+----------+---------+ | X+1 to X+Y | Alpha Identifier | O | Y bytes | +--------------------------+-------------------------+----------+---------+
‑ URI Address.
> Content:\ The URI Address associated to the referenced file Record number.
>
> Coding:\ Same as URI TLV data object in EF~IMPU~ defined in TS 31.103 [64].
‑ Alpha Identifier.
Contents:
Alpha‑tagging of the associated dialling number.
Coding:
this alpha‑tagging shall use either:
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified. Unused bytes shall be
set to \'FF\'.
or:
\- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
If SDN is enabled, the ME shall perform SDN procedure using destination
addresses which are in EF~SDNURI~ or in EF~SDN~ entries, following the same
principle as defined in the Service Dialling Numbers description in TS 22.101
[24] applied to URI addresses.
NOTE: The value of Y (the number of bytes in the alpha‑identifier) may be
different to the length denoted X in EF~SDN~.
4.2.100 EF~IAL~ (IMEI(SV) Allowed Lists)
The file EF~IAL~ stores ranges of values of IMEI(SV) to which the USIM is
authorized to be paired as defined in this specification.
This file shall be present if USAT Application Pairing is supported as defined
in this specification.
This file shall contain at least one IMEI(SV) range of values to which the
USIM is authorized to be paired.
+---------------------+---------------------+----------+-----------+ | Identifier: | Structure: linear | Optional | | | \'6FF0\' | fixed | | | +---------------------+---------------------+----------+-----------+ | Record length: X+2 | Update activity: | | | | bytes (X>=16) | low | | | +---------------------+---------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ ADM | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +---------------------+---------------------+----------+-----------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+-----------+ | 1 to X+2 | IMEI or IMEISV | M | X+2 bytes | | | range TLV object | | | +---------------------+---------------------+----------+-----------+
\- IMEI(SV) range of values TLV object.
The content and coding is defined below, where IMEI and IMEISV are defined in
3GPP TS 23.003[25]:
Coding of the IMEI Range TLV objects
* * *
Length Description Status 1 byte Tag of Range of IMEI values: \'80\' M 1 byte
Length M X bytes IMEI range of values that the USIM is authorized to be paired
to (Detail 1) C
* * *
Coding of the IMEISV Range TLV objects
* * *
Length Description Status 1 byte Tag of Range of IMEISV values: \'81\' M 1
byte Length M X bytes IMEISV range of values that the USIM is authorized to be
paired to (Detail 1) C
* * *
Detail 1:
\- Following the Length of the TLV, the range is defined as follow: [lower
value][higher value].
\- The authorized values of IMEI or IMEISV in an authorized range of values
include the lower and higher values of the specified range.
\- To define an authorized individual IMEI or IMEISV, the lower value and the
higher value of a range shall both be equal to the value of the authorized
IMEI or IMEISV.
\- For an IMEI, the Check Digit is not considered in the evaluation
\- For an IMEISV, the TAC\|SNR part and the SVN part may be evaluated
separately
Coding:
\- IMEI and IMEISV coding is defined in 3GPP TS 23.003 [25] and 3GPP TS 24.008
[9]
\- Unused nibble (IMEI) is set to \'F\'
Unused bytes shall be set to \'FF\'.
UICC OTA mechanism is used to update the file EF~IAL~ stored in the USIM. This
mechanism provides dynamic management of the pairing to change the allowed
combinations of USIM and MTC ME(s) by adding or removing authorized IMEI(SV)
ranges in the file EF~IAL~.
### 4.2.101 EF~IPS~ (IMEI(SV) Pairing Status)
The EF~IPS~ file stores the status of USAT Application Pairing checking.
This file shall be present if USAT Application Pairing is supported as defined
in this specification.
The status flag of pairing check (with value \"OK\" or \"KO\") stored in the
file EF~IPS~ can be read by any terminal hosting the UICC. The information
stored in the file EF~IPS~ provides a mechanism to detect changes of
association between a USIM and a MTC ME. The information stored in the file
EF~IPS~ can be read locally by e.g. the maintenance person.
Structure of EF~IPS~
+----------------------+----------------------+----------+---------+ | Identifier: \'6FF1\' | Structure: Cyclic | Optional | | +----------------------+----------------------+----------+---------+ | Record length: 4 | Update activity: | | | | bytes | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1-2 | Status of the last | O | 2 bytes | | | pairing procedure | | | | | (detail 1) | | | +----------------------+----------------------+----------+---------+ | 3 | Link to a record of | O | 1 byte | | | EF~IPD~ (detail 2) | | | +----------------------+----------------------+----------+---------+ | 4 | Reserved for future | - | 1 byte | | | use | | | +----------------------+----------------------+----------+---------+
Due to the frequency of the pairing procedure, it is recommended that this
file contain at least 100 records.
Detail 1:
These 2 bytes contain the status of the last pairing procedure as defined
below:
\- If the pairing is successful then:
1\. Byte 1 is the character \"O\"
2\. Byte 2 is the character \"K\"
\- If the pairing is not successful then:
1\. Byte 1 is the character \"K\"
2\. Byte 2 is the character \"O\"
The characters are coded using the SMS default 7-bit coded alphabet as defined
in TS 23.038 [5] with bit 8 set to 0.
Detail 2:
This byte contains a link to a record of EF~IPD~ file:
\- Unsigned integer coded from \'01\' to \'FE\'
### 4.2.102 EF~IPD~ (IMEI(SV) of Pairing Device)
The EF~IPD~ contains the IMEI(SV) as defined in TS 23.003[25] that was used in
the USAT Application Pairing procedure.
This file shall be present if USAT Application Pairing is supported as defined
in this specification.
+---------------------+---------------------+----------+-----------+ | Identifier: | Structure: linear | Optional | | | \'6FF2\' | fixed | | | +---------------------+---------------------+----------+-----------+ | Record length: X+2 | Update activity: | | | | bytes (X>=8) | high | | | +---------------------+---------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ ADM | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +---------------------+---------------------+----------+-----------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+-----------+ | 1 to X+2 | IMEI or IMEISV TLV | M | X+2 bytes | | | object | | | +---------------------+---------------------+----------+-----------+
\- IMEI(SV) TLV object.
The content and coding is defined below, where IMEI and IMEISV are defined in
3GPP TS 23.003[25]:
Coding of the IMEI TLV object
* * *
Length Description Status 1 byte Tag for an IMEI: \'80\' M 1 byte Length M X
bytes IMEI value used in the pairing procedure C
* * *
Coding of the IMEISV TLV object
* * *
Length Description Status 1 byte Tag for an IMEISV: \'81\' M 1 byte Length M X
bytes IMEISV value used in the pairing procedure C
* * *
\- Coding:IMEI and IMEISV coding is defined in 3GPP TS 23.003 [25] and 3GPP TS
24.008 [9]
\- Unused nibble (IMEI) is set to \'F\'
Unused bytes are set to \'FF\'.
### 4.2.103 EF~ePDGId~ (Home ePDG Identifier)
If service n°106 and service n°107 are \"available\", this file shall be
present.
This EF contains zero or more Home Evolved Packet Data Gateway (ePDG)
Identifier data objects as defined in the \"Selection of the ePDG\" UE
procedure of 3GPP TS 24.302 [79].
+---------------------+---------------------+----------+-----------+ | Identifier: | Structure: | Optional | | | \'6FF3\' | transparent | | | +---------------------+---------------------+----------+-----------+ | File size: >X | Update activity: | | | | bytes | low | | | +---------------------+---------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+-----------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+-----------+ | 1 to X | Home ePDG | O | X bytes | | | identifier TLV data | | | | | object | | | +---------------------+---------------------+----------+-----------+ | X+1 to Y | Home ePDG | O | Y-X bytes | | | identifier TLV data | | | | | object | | | +---------------------+---------------------+----------+-----------+ | ... | | | | +---------------------+---------------------+----------+-----------+
Home ePDG Identifier TLV data object
Contents:
\- Address of Evolved Packet Data Gateway, in the format of a FQDN, an IPv4
address, or an IPv6 address.
Coding:
\- The tag value of this Home ePDG Identifier TLV data object shall be \'80\'.
The format of the data object is as follows:
* * *
Field Length (bytes) Tag 1 Length 1 Address Type 1 Home ePDG Address Address
Length
* * *
Address Type: Type of the ePDG address.
\- This field shall be set to the type of the ePDG address according to the
following:
* * *
Value Address Type \'00\' FQDN \'01\' IPv4 \'02\' IPv6 All other values are
reserved
* * *
ePDG Address: Address of the Evolved Packet Data Gateway
Contents:
\- This field shall be set to the address of the ePDG.
Coding:
\- When the Address Type is set to \'00\', the corresponding ePDG FQDN Address
shall be encoded to an octet string according to UTF-8 encoding rules as
specified in IETF RFC 3629 [48].
\- When the Address Type is set to \'01\', the corresponding ePDG IPv4 Address
is in octet 5 to octet 8 of the Home ePDG Identifier TLV data object. Bit 8 of
octet 5 represents the most significant bit of the IP address and bit 1 of
octet 8 the least significant bit.
\- When the Address Type is set to \'02\', the corresponding ePDG IPv6 Address
is in octet 5 to octet 20 of the Home ePDG Identifier TLV data object. Bit 8
of octet 5 represents the most significant bit of the IP address and bit 1 of
octet 20 the least significant bit.
Unused bytes shall be set to \'FF\'.
### 4.2.104 EF~ePDGSelection~ (ePDG Selection Information)
If service n°106 and service n°107 are \"available\", this file shall be
present.
This EF contains Evolved Packet Data Gateway (ePDG) selection information for
one or more PLMNs as defined in the \"Selection of the ePDG\" UE procedure of
3GPP TS 24.302 [79].
+----------------------+----------------------+----------+---------+ | Identifier: \'6FF4\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ePDG selection | O | Z bytes | | | information TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
The file contains one ePDG selection information TLV data object. The ePDG
selection information TLV data object contains a list of PLMNs which are
preferred for ePDG selection. The list of PLMNs may include the HPLMN. For
each PLMN, it is indicated:
\- the preference order (priority) given to ePDG of a PLMN and
\- whether selection of an ePDG in such PLMN should be based on
Tracking/Location Area Identity FQDN or on Operator Identifier FQDN,
as specified in the \"Selection of the ePDG\" UE procedure of 3GPP TS 24.302
[79].
ePDG selection information TLV data object:
* * *
Description Value M/O/C Length (bytes) ePDG Selection Information Tag \'80\' M
1 Length 5n M Note PLMN 1 -- C 3 ePDG Priority -- C 2 ePDG FQDN format \'00\'
or \'01\' C 1 ...  
PLMN n -- C 3 ePDG Priority -- C 2 ePDG FQDN format indicator \'00\' or \'01\'
C 1 Note: The length is coded according to ISO/IEC 8825-1 [35]
* * *
PLMN:
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- According to TS 24.008 [9].
\- A BCD value of \'D\' in any of the MCC and/or MNC digits shall be used to
indicate a \"wild\" value for that corresponding MCC/MNC digit.
\- A value of \'DDDDDD\' represents \"any PLMN\" value.
ePDG Priority:
Contents:
\- The PLMN Priority represents the preference order given to ePDGs of a PLMN.
Coding:
> \- ePDG Priority value is coded as a 2-Byte integer.
ePDG FQDN format:
Contents:
\- Indicates whether the selection of an ePDG in this PLMN should be based on
Tracking/Location Area Identity FQDN or on Operator Identifier FQDN (see 3GPP
TS 24.302 [79]).
Coding:
> \- \'00\': Indicates that Operator Identifier FQDN format shall be used (see
> 3GPP TS 24.302 [79]).
>
> \- \'01\': Indicates that location based FQDN format shall be used (see 3GPP
> TS 24.302 [79]).
>
> \- Other values are RFU.
### 4.2.104a EF~ePDGIdEm~ (Emergency ePDG Identifier)
If service n°111 and service n°110 are \"available\", this file shall be
present.
This EF contains zero or more Emergency Evolved Packet Data Gateway (ePDG)
Identifier data objects.
+---------------------+---------------------+----------+-----------+ | Identifier: | Structure: | Optional | | | \'6FF5\' | transparent | | | +---------------------+---------------------+----------+-----------+ | File size: >X | Update activity: | | | | bytes | low | | | +---------------------+---------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+-----------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+-----------+ | 1 to X | Emergency ePDG | O | X bytes | | | identifier TLV data | | | | | object | | | +---------------------+---------------------+----------+-----------+ | X+1 to Y | Emergency ePDG | O | Y-X bytes | | | identifier TLV data | | | | | object | | | +---------------------+---------------------+----------+-----------+ | ... | | | | +---------------------+---------------------+----------+-----------+
> For coding, see EF~ePDGId~
### 4.2.105 EF~ePDGSelectionEm~ (ePDG Selection Information for Emergency
Services)
If service n°111 and service n°110 are \"available\", this file shall be
present.
This EF contains Evolved Packet Data Gateway (ePDG) selection information for
Emergency Services.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FF6\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ePDG selection | O | Z bytes | | | information for | | | | | Emergency Services | | | | | TLV data object | | | +----------------------+----------------------+----------+---------+
> For coding, see EF~ePDGSelection~
### 4.2.106 EF~FromPreferred~ (From Preferred)
If service n°114 is \"available\", this file shall be present.
It shall be possible to define if the UE uses the From header field for the
determination of the originating party identity in the OIP service. For more
detailed description see 3GPP TS 24.607 [86] clause 4.5.2.12.
NOTE: If this file is present in both the USIM and the ISIM, the file in the
ISIM is used. It is assumed that the presence of this file in the USIM when an
ISIM is present on the UICC is an incorrect configuration of the UICC.
+----------------------+------------------------+----------+---------+ | Identifier: \'6FF7\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+---------+ | File size: n bytes. | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 | Status | M | 1 bytes | +----------------------+------------------------+----------+---------+
‑ Status.
Contents:
Status byte indication if From header field is used or not.
Coding:
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             See 3GPP TS 24.417 \[87\] clause 5.4.
                                             RFU (see 3GPP TS 31.101 \[3\])
* * *
### 4.2.107 EF~IMSConfigData~ (IMS Configuration Data)
If service n°115 is \"available\", this file shall be present.
This EF contains the IMS configuration data object as specified in 3GPP TS
24.167 [88].
For the structure, content and coding of this file, see EF~IMSConfigData~ in
3GPP TS 31.103 [2].
NOTE: If this file is present in both the USIM and the ISIM, the file in the
ISIM is used. It is assumed that the presence of this file in the USIM when an
ISIM is present on the UICC is an incorrect configuration of the UICC.
### 4.2.108 EF~TVCONFIG~ (TV Configuration)
If service n°116 is \"available\", this file shall be present.
This EF contains the configuration of the parameters related to TV service
provided via a PLMN.
+-----------------------+-------------------------+----------+---------------+ | Identifier: \'6FFB\' | Structure: linear fixed | Optional | | +-----------------------+-------------------------+----------+---------------+ | Record size: Z bytes. | Update activity: low | | | +-----------------------+-------------------------+----------+---------------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +-----------------------+-------------------------+----------+---------------+ | Bytes | Description | M/O | Length | +-----------------------+-------------------------+----------+---------------+ | 1 to 3 | PLMN identity | M | 3 bytes | +-----------------------+-------------------------+----------+---------------+ | 54 to 4+X | TMGI List TLV | O | X bytes | +-----------------------+-------------------------+----------+---------------+ | 4+X+1 to 4+X+1+Y | EARFCN List TLV | O | Y bytes | +-----------------------+-------------------------+----------+---------------+ | 4+X+Y+2 to Z | RFU | C | Z-X-Y-3 bytes | +-----------------------+-------------------------+----------+---------------+
\- PLMN
Contents:
> As described in TS 24.117 [91], the identity of the PLMN for which the TV
> service configuration applies.
Coding:
> According to TS 24.008 [9].
\- TMGI List TLV
Contents:
> List of TMGIs.
Coding:
* * *
Description Value M/O Length (bytes) TMGI List Tag \'A0\' M 1 Length 9n M Note
ENTRY 1 --- C 9 ENTRY 2 --- C 9 ...  
ENTRY n --- C 9 NOTE: The length is coded according to ISO/IEC 8825-1 [35]
* * *
> Each entry is coded:
* * *
1 to 6 TMGI M 6 bytes 7 to 8 USD File Id M 2 bytes 9 Service type M 1 byte
* * *
\- TMGI
Contents:
> The TMGI is defined as specified in TS 23.003 [25].
>
> Coding:
>
> TMGI is coded in 6 bytes:
\- bytes 1 to 3: contain the MBMS Service ID, with the first digit coded in
the most significant nibble of the first byte, and the last digit coded in the
least significant nibble of the third byte.
\- bytes 4 to 6: contain the MCC and MNC values of the TMGI, coded as a PLMN
according to TS 24.008 [9].
\- USD File Id
Contents:
> File identifier of the EF~TVUSD~ inside the DF~TV~ containing the User
> Service Description (USD).
Coding:
> According to TS 31.101 [11]
\- Service type
Contents:
> Type of service for which the entry is valid.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                For Service Announcement service. This is equivalent to an entry in the TMGIListForSA leaf in TS 24.117 \[91\].
                                                For User service. This is equivalent to an entry in the TMGIListForService leaf in TS 24.117 \[91\].
                                                RFU
* * *
\- EARFCN List TLV
Contents:
> List of _the_ E-UTRA ARFCN value of MBMS frequency.
Coding:
* * *
Description Value M/O Length (bytes) EARFCN List Tag \'A1\' M 1 Length 4m M
Note EARFCN 1 --- C 4 EARFCN 2 --- C 4 ...  
EARFCN m --- C 4 NOTE: The length is coded according to ISO/IEC 8825-1 [35]
* * *
Each EARFCN is coded in 4 bytes, as specified in 3GPP TS 36.101 [92].
### 4.2.109 EF~3GPPPSDATAOFF~ (3GPP PS Data Off)
If service n° 117 is \"available\", this file shall be present.
This EF contains information about which SIP and non SIP Services are 3GPP PS
Data Off Exempt in Home and/or roaming.
If service n° 131 is \"available\", byte1 contains the 3GPP PS Data Off Exempt
status for services in the Home and byte 2 contains the 3GPP PS Data Off
Exempt status for services in roaming.
If service n° 131 is \"not available\", byte1 contains 3GPP PS Data Off Exempt
status for services for both Home and roaming. The ME shall ignore byte2 in
that case.
+----------------------+---------------------------------+----------+---------+ | Identifier: \'6FF9\' | Structure: transparent | Optional | | +----------------------+---------------------------------+----------+---------+ | File size: 4 byte | Update activity: low | | | +----------------------+---------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------------+----------+---------+ | 1-4 | SIP and non-SIP Exempt Services | M | 4 bytes | +----------------------+---------------------------------+----------+---------+
‑ SIP and non-SIP Exempt Services.
Contents:
\- the services that are 3GPP PS Data Off exempt as specified in 3GPP TS
22.011 [2].
Coding:
\- each service that can be 3GPP PS Data Off exempt is coded on one bit.
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 value to be interpreted as defined for the USSI\_exempt leaf in TS 24.391 \[94\]
                                                b2 value to be interpreted as defined for the MMTEL\_voice\_exempt leaf in TS 24.275 \[95\]
                                                b3 value to be interpreted as defined for the MMTEL\_video\_exempt leaf in TS 24.275 \[95\]
                                                b4 value to be interpreted as defined for the SSP\_XCAP\_config\_exempt leaf in TS 24.424 \[93\]
                                                b5 value to be interpreted as defined for the SMSoIP\_exempt leaf in TS 24.167 \[88\]
                                                b6 value to be interpreted as defined for the Bearer\_independent\_protocol leaf of the Exempted\_service\_list in TS 24.368 \[65\]
                                                b7 value to be interpreted as defined for the Device\_management\_over\_PS leaf of the Exempted\_service\_list in TS 24.368 \[65\]
                                                RFU
* * *
Byte 2 (if valid):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 value to be interpreted as defined for the USSI\_roaming\_exempt leaf in TS 24.391 \[94\]
                                                b2 value to be interpreted as defined for the MMTEL\_voice\_roaming\_exempt leaf in TS 24.275 \[95\]
                                                b3 value to be interpreted as defined for the MMTEL\_video\_roaming\_exempt leaf in TS 24.275 \[95\]
                                                b4 value to be interpreted as defined for the SSP\_XCAP\_config\_roaming\_exempt leaf in TS 24.424 \[93\]
                                                b5 value to be interpreted as defined for the SMSoIP\_roaming\_exempt leaf in TS 24.167 \[88\]
                                                b6 value to be interpreted as defined for the Bearer\_independent\_protocol leaf of the Exempted\_service\_list\_roaming in TS 24.368 \[65\]
                                                b7 value to be interpreted as defined for the Device\_management\_over\_PS leaf of the Exempted\_service\_list\_roaming in TS 24.368 \[65\]
                                                RFU
* * *
Bytes 3 to 4 are RFU.
### 4.2.110 EF~3GPPPSDATAOFFservicelist~ (3GPP PS Data Off Service List)
If service n° 118 is \"available\", this file shall be present. This file
contains a list of particular IMS services not defined by 3GPP, where each
such IMS service is identified by an IMS communication service identifier.
(See 3GPP TS 22.011 [2]). The usage of this file is described in 3GPP TS
24.229 [63] clauses 4.17 B.3.1.5 and L.3.1.5.
+-------------------------+-------------------------+----------+---------+ | Identifier: \'6FFA\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+---------+ | Record length: X bytes. | Update activity: low | | | +-------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +-------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+---------+ | 1 to X | ICSI TLV object | M | X bytes | +-------------------------+-------------------------+----------+---------+
ICSI TLV object:
Contents:
\- The content and coding is defined below.
Coding of the ICSI TLV objects
* * *
Length Description Value Status 1 byte ICSI TLV TAG \'80\' M 1 byte Length of
ICSI Y M Y bytes ICSI value - M
* * *
\- Coding:
IMS Communication Service Identifier: shall be coded as specified in TS 24.229
[63].
### 4.2.111 EF~XCAPConfigData~ (XCAP Configuration Data)
If service n°120 is \"available\", this file shall be present.
This EF contains the XCAP configuration data object as specified in 3GPP TS
24.424 [101], OMA OMA-TS-XDM_MO-V1_1-20080627-A [103] and OMA-DDS-
DM_ConnMO-V1_0-20081107-A [100]:
For the structure, content and coding of this file, see EF~XCAPConfigData~ in
3GPP TS 31.103 [2].
NOTE: If this file is present in both the USIM and the ISIM, the file in the
ISIM is used. It is assumed that the presence of this file in the USIM when an
ISIM is present on the UICC is an incorrect configuration of the UICC.
### 4.2.112 EF~EARFCNList~ (EARFCN list for MTC/NB-IOT UEs)
If Service n°121 is \"available\", this file shall be present.
This EF contains NAS configuration MO having a list of EARFCNs and associated
geographical area coordinates configured in the UE for initial cell search of
MTC carrier or NB-IoT carrier.
+----------------------+-----------------------------+----------+---------+ | Identifier: \'6FFD\' | Structure: transparent | Optional | | +----------------------+-----------------------------+----------+---------+ | File size: X bytes. | Update activity: low | | | +----------------------+-----------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +----------------------+-----------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-----------------------------+----------+---------+ | 1 to Z | EARFCN List TLV data object | M | Z bytes | +----------------------+-----------------------------+----------+---------+
This EF contains one or more EARFCN List TLV data objects
EARFCN List information:
+----------------------+-------------+-------+----------------+ | Description | Value | M/O/C | Length (bytes) | +----------------------+-------------+-------+----------------+ | EARFCN List TLV | \'A0\' | M | 1 | +----------------------+-------------+-------+----------------+ | Length | X | M | Note 1 | +----------------------+-------------+-------+----------------+ | EARFCN Tag | \'80\' | M | 1 | +----------------------+-------------+-------+----------------+ | Length | Note2 | M | 1 | +----------------------+-------------+-------+----------------+ | EARFCN value | -- | M | Note2 | +----------------------+-------------+-------+----------------+ | Geographical Area -- | \'81\' | M | 1 | | Polygon Tag | | | | +----------------------+-------------+-------+----------------+ | Length | 6*n (n>2) | M | Note 1 | +----------------------+-------------+-------+----------------+ | Geographical Area -- | -- | M | 6*n (n>2) | | Polygon value | | | | +----------------------+-------------+-------+----------------+ | Note 1: The length | | | | | is coded according | | | | | to ISO/IEC | | | | | 8825-1 [35] | | | | | | | | | | Note 2: EARFCN is | | | | | coded in 4 bytes, as | | | | | specified in 3GPP TS | | | | | 36.101 [92] | | | | +----------------------+-------------+-------+----------------+
Each EARFCN List TLV data object shall contain one EARFCN and one or more
Geographical Area objects.
\- Geographical Area -- Polygon Tag \'81\'
Contents:
> A geographical area defined by a polygon with 3 or more points.
Coding:
* * *
**Bytes** **Description** **M/O** **Length** 1 to 3 Latitude of point 1 M 3
bytes 4 to 6 Longitude of point 1 M 3 bytes 7 to 9 Latitude of point 2 M 3
bytes 10 to 12 Longitude of point 2 M 3 bytes 13 to 15 Latitude of point 3 M 3
bytes 16 to 18 Longitude of point 3 M 3 bytes 19 to 21 Latitude of point 4 O 3
bytes 22 to 24 Longitude of point 4 O 3 bytes : : : : (6n-5) to 6n-3 Latitude
of point n O 3 bytes (6n-2) to 6n Longitude of point n O 3 bytes Latitude and
longitude are coded as defined in clause 6.1 of 3GPP TS 23.032 [75].
* * *
NOTE: The upper limit of 15 specified in 3GPP TS 23.032 [9] for the number of
points in a polygon shape does not apply to the number of coordinates in a
geographical area described as a polygon here.
### 4.2.113 EF~MuDMiDConfigData~ (MuD and MiD Configuration Data)
If service n°134 is \"available\", this file shall be present.
This EF contains the MuD and MiD configuration data object as specified in
3GPP TS 24.175 [110]:
For the structure, content and coding of this file, see EF~MuDMiDConfigData~
in 3GPP TS 31.103 [2].
NOTE: If this file is present in both the USIM and the ISIM, the file in the
ISIM is used. It is assumed that the presence of this file in the USIM when an
ISIM is present on the UICC is an incorrect configuration of the UICC.
4.2.114 EF~eAKA~ (enhanced AKA support)
The file EF~eAKA~ stores information about the support of the enhanced AKA.
The content of the EF may be updated via OTA. The content of this EF is
internal to the USIM.
It contains information if the enhanced SQN calculation as defined in 3GPP TS
33.102 [13] Annex J is supported by the USIM. This information can be used by
the USIM internally to identify which SQN calculation to use.
.
+---------------------------+------------------------+----------+---------+ | Identifier: \'6F01\' | Structure: transparent | Optional | | +===========================+========================+==========+=========+ | File size: X bytes, (X≥1) | Update activity: low | | | +---------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ADM | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +---------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +---------------------------+------------------------+----------+---------+ | 1 - X | eAKA support | M | X bytes | +---------------------------+------------------------+----------+---------+
\- eAKA support.
Contents:
\- indicates the support of the enhanced SQN calculation
Coding:
\- the support is indicated by bit 1 in Byte 1 as defined below
Byte 1:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0: enhanced SQN calculation not supported b1=1: enhanced SQN calculation supported  
|  |  |  |  |  |  |  |  |  | RFU  
|  |  |  |  |  |  |  |  |  | RFU  
|  |  |  |  |  |  |  |  |  | RFU  
|  |  |  |  |  |  |  |  |  | RFU  
|  |  |  |  |  |  |  |  |  | RFU  
|  |  |  |  |  |  |  |  |  | RFU  
|  |  |  |  |  |  |  |  |  | RFU  
All other bytes are RFU.
## 4.3 DFs at the USIM ADF (Application DF) Level
DFs may be present as child directories of USIM ADF. The following DFs are
defined:
DF~PHONEBOOK~ \'5F3A\' (see Note 2).
DF~GSM-ACCESS~ \'5F3B\'.
DF~MexE~ \'5F3C\'.
DF~WLAN~ \'5F40\'.
DF~HNB~ \'5F50\'.
DF~SoLSA~ \'5F70\'.
DF~BCAST~ \'5F80\' (see Note 1).
DF~ProSe~ \'5F90\'.
DF~ACDC~ \'5FA0\'
DF~TV~ \'5FB0\'
DF~5GS~ \'5FC0\'
DF~SAIP~ \'5FD0\' (see Note 3)
DF~SNPN~ \'5FE0\'
DF~5G_ProSe~ \'5FF0\'
Note 1: The DF identifier \'5F80\' is reserved for OMA BCAST Smart Card
Profile [49]
Note 2: DF for application specific phonebook. This DF has the same structure
as the DF~PHONEBOOK~ under DF~TELECOM~.
Note 3: The DF identifier \'5FD0\' is reserved for Trusted Connectivity
Alliance (TCA) (formerly SIMalliance).
## 4.4 Contents of DFs at the USIM ADF (Application DF) level
### 4.4.1 Contents of files at the DF SoLSA level
This only applies if the Support of Localised Service Areas is supported, as
indicated by Service Number 23 in the USIM Service Table and specified in TS
23.073 [23] .
The Efs contain information about the users subscribed local service areas.
#### 4.4.1.1 EF~SAI~ (SoLSA Access Indicator)
This EF contains the \'LSA only access indicator\'. This EF shall always be
allocated if DF~SoLSA~ is present.
If the indicator is set, the network will prevent terminated and/or originated
calls when the MS is camped in cells that are not included in the list of
allowed LSAs in EF~SLL~. Emergency calls are, however, always allowed.
The EF also contains a text string which may be displayed when the MS is out
of the served area(s).
+------------------------+---------------------------------+----------+---------+ | Identifier: \'4F30\' | Structure: transparent | Optional | | +------------------------+---------------------------------+----------+---------+ | File size: X + 1 bytes | Update activity: low | | | +------------------------+---------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+---------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+---------------------------------+----------+---------+ | 1 | LSA only access indicator | M | 1 byte | +------------------------+---------------------------------+----------+---------+ | 2 to X+1 | LSA only access indication text | M | X bytes | +------------------------+---------------------------------+----------+---------+
‑ LSA only access indicator
Contents: indicates whether the MS is restricted to use LSA cells only or not.
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0: LSA only access not activated b1=1: LSA only access activated  
|  |  |  |  |  |  |  |  |  | RFU  
‑ LSA only access indication text
Contents: text to be displayed by the ME when it\'s out of LSA area.
Coding: the string shall use either
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified. Unused bytes shall be
set to \'FF\'; or
\- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
#### 4.4.1.2 EF**~SLL~** (SoLSA LSA List)
This EF contains information describing the LSAs that the user is subscribed
to. This EF shall always be allocated if DF~SoLSA~ is present.
Each LSA is described by one record that is linked to a LSA Descriptor file.
Each record contains information of the PLMN, priority of the LSA, information
about the subscription and may also contain a text string and/or an icon that
identifies the LSA to the user. The text string can be edited by the user.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F31\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | Record length: X + | Update activity: low | | | | 10 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | LSA name | O | X bytes | +----------------------+----------------------+----------+---------+ | X+1 | Configuration | M | 1 byte | | | parameters | | | +----------------------+----------------------+----------+---------+ | X+2 | RFU | M | 1 byte | +----------------------+----------------------+----------+---------+ | X+3 | Icon Identifier | M | 1 byte | +----------------------+----------------------+----------+---------+ | X+4 | Priority | M | 1 byte | +----------------------+----------------------+----------+---------+ | X+5 to X+7 | PLMN code | M | 3 bytes | +----------------------+----------------------+----------+---------+ | X+8 to X+9 | LSA Descriptor File | M | 2 byte | | | Identifier | | | +----------------------+----------------------+----------+---------+ | X+10 | LSA Descriptor | M | 1 byte | | | Record Identifier | | | +----------------------+----------------------+----------+---------+
‑ LSA name
Contents: LSA name string to be displayed when the ME is camped in the
corresponding area, dependant on the contents of the LSA indication for idle
mode field.
Coding: the string shall use either
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified. Unused bytes shall be
set to \'FF\'; or
\- one of theUCS2 code options defined in the annex of TS 31.101 [11].
‑ Configuration parameters
Contents: Icon qualifier, control of idle mode support and control of LSA
indication for idle mode.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Icon qualifier
                                                Idle mode support
                                                LSA indication for idle mode
                                                RFU
* * *
Icon qualifier:
Contents: The icon qualifier indicates to the ME how the icon is to be used.
> B2, b1: 00: icon is not to be used and may not be present\ 01: icon is self-
> explanatory, i.e. if displayed, it replaces the LSA name\ 10: icon is not
> self-explanatory, i.e. if displayed, it shall be displayed together with the
> LSA name\ 11: RFU
Idle mode support:
Contents: The idle mode support is used to indicate whether the ME shall
favour camping on the LSA cells in idle mode.
> B3 = 0: Idle mode support disabled\ b3 = 1: Idle mode support enabled
LSA indication for idle mode:
Contents: The LSA indication for idle mode is used to indicate whether or not
the ME shall display the LSA name when the ME is camped on a cell within the
LSA.
> B4 = 0: LSA indication for idle mode disabled\ b4 = 1: LSA indication for
> idle mode enabled
Bits b5 to b8 are RFU (see clause 9.3).
\- Icon Identifier
Contents: The icon identifier addresses a record in EF~IMG~.
Coding: binary.
‑ Priority
> Contents: Priority of the LSA which gives the ME the preference of this LSA
> relative to the other LSAs.
>
> Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Priority
                                                RFU
* * *
> \'0\' is lowest priority, \'F\' is highest.
‑ PLMN code
Contents: MCC + MNC for the LSA.
Coding: according to TS 24.008 [9] and EF~LOCI~.
\- LSA Descriptor File Identifier:
Contents: these bytes identify the EF which contains the LSA Descriptors
forming the LSA.
Coding: byte X+8: high byte of the LSA Descriptor file;\ byte X+9: low byte of
the LSA Descriptor file.
\- LSA Descriptor Record Identifier:
Contents: this byte identifies the number of the first record in the LSA
Descriptor file forming the LSA.
Coding: binary.
#### 4.4.1.3 LSA Descriptor files
Residing under DF~SoLSA~, there may be several LSA Descriptor files. These Efs
contains one or more records again containing LSA Descriptors forming the
LSAs. LSAs can be described in four different ways. As a list of LSA Ids, as a
list of LAC + Cis, as a list of Cis or as a list of LACs. As the basic
elements (LSA ID, LAC + CI, CI and LAC) of the four types of lists are of
different length, they can not be mixed within one record. Different records
may contain different kinds of lists within the Efs. Examples of codings of
LSA Descriptor files can be found in annex F.
+-----------------------------+--------------------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: linear fixed | Optional | | +-----------------------------+--------------------------------+----------+---------+ | Record length: n*X+2 bytes | Update activity: low | | | +-----------------------------+--------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+--------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-----------------------------+--------------------------------+----------+---------+ | 1 | LSA descriptor type and number | M | 1 byte | +-----------------------------+--------------------------------+----------+---------+ | 2 to X+1 | 1^st^ LSA Descriptor | M | X bytes | +-----------------------------+--------------------------------+----------+---------+ | X+2 to 2X+1 | 2^nd^ LSA Descriptor | M | X bytes | +-----------------------------+--------------------------------+----------+---------+ | : | : | : | : | +-----------------------------+--------------------------------+----------+---------+ | (n-1)*X+2 to n*X+1 | n^th^ LSA Descriptor | M | X bytes | +-----------------------------+--------------------------------+----------+---------+ | n*X+2 | Record Identifier | M | 1 byte | +-----------------------------+--------------------------------+----------+---------+
\- LSA descriptor type and number:
Contents: The LSA descriptor type gives the format of the LSA descriptor and
the number of valid LSA Descriptors within the record.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSA descriptor type
                                                Number of LSA Descriptors
* * *
LSA descriptor type:
Contents: Gives the format of the LSA Descriptors.
> B2, b1: 00: LSA ID.\ 01: LAC + CI\ 10: CI\ 11: LAC
Number of LSA Descriptors:
Contents: Gives the number of valid LSA Descriptors in the record.
Coding: binary, with b8 as MSB and b3 as LSB leaving room for 64 LSA
Descriptors per record.
‑ LSA Descriptor
Contents: Dependant of the coding indicated in the LSA descriptor type:
\- in case of LSA ID the field length \'X\' is 3 bytes;
\- in case of LAC + CI the field length \'X\' is 4 bytes;
\- in case of CI the field length \'X\' is 2 bytes;
\- in case of LAC the field length \'X\' is 2 bytes.
Coding: according to TS 24.008 [9].
\- Record Identifier:
> Contents: This byte identifies the number of the next record containing the
> LSA Descriptors forming the LSA.
Coding: record number of next record. \'FF\' identifies the end of the chain.
This file utilises the concept of chaining as for EF~EXT1~.
The identifier \'4FXX\' shall be different from one LSA Descriptor file to the
other and different from the identifiers of EF~SAI~ and EF~SLL~. For the range
of \'XX\', see 3GPP TS 31.101 [11].
### 4.4.2 Contents of files at the DF PHONEBOOK level
The Efs in the DF~PHONEBOOK~ level contain phone book related features as
required in 3GPP TS 21.111 [1].
The UICC may contain a global phonebook, or application specific phonebooks,
or both in parallel. When both phonebook types co-exist, they are independent
and no data is shared. In this case, when the terminal supports application
specific phonebooks, it shall be possible for the user to select which
phonebook the user would like to access.
Support of the global phonebook is mandatory, except for Terminals of type ND,
NK or NS, as specified in 3GPP TS 31.111 [12] Annex P, for which support is
optional. Terminals that support the global phonebook shall conditionally
support, the application specific phonebooks, also known as local phonebook.
The support of local phone book is:
a) optional for terminals that support alternative phonebook applications; and
NOTE 1: Such terminals could be of type \"Smartphone\" as described in GSMA:
\"IMEI Allocation and Approval Process\" [84].
b) mandatory for terminals that do not support alternative phonebook
applications.
NOTE 2: Such terminals could be of type \"Feature Phone\" as described in
GSMA: \"IMEI Allocation and Approval Process\" [84].
It is recommended that the terminal searches for the global phonebook located
under DF~TELECOM~ as its presence is not indicated anywhere in the USIM
application.
The global phonebook is located in DF~PHONEBOOK~ under DF~TELECOM.~. Each
specific USIM application phonebook is located in DF~PHONEBOOK~ of its
respective Application ADF~USIM~. The organisation of files in DF~PHONEBOOK~
under ADF~USIM~ and under DF ~TELECOM~ follows the same rules. Yet
DF~PHONEBOOK~ under ADF~USIM~ may contain a different set of files than
DF~PHONEBOOK~ under DF~TELECOM~. All phonebook related Efs are located under
their respective DF~PHONEBOOK~. USIM specific phonebooks are dedicated to
application specific entries. Each application specific phonebook is protected
by the application PIN.
EF~ADN~ and EF~PBR~ shall always be present if the DF~Phonebook~ is present.
If any phonebook file other than EF~ADN~ or EF~EXT1,~ is used, then EF~PBC~
shall be present.
If a GSM application resides on the UICC, the Efs ADN and EXT1 from one
DF~PHONEBOOK~ (defined at GSM application installation) are mapped to
DF~TELECOM~. Their file Ids are specified in 3GPP TS 51.011 [18], i.e. EF~ADN~
= \'6F3A\' and EF~EXT1~ = \'6F4A\', respectively.
If the UICC is inserted into a terminal accessing the ADN and EXT1 files under
DF~TELECOM~; and a record in these files has been updated, a flag in the
corresponding entry control information in the EF~PBC~ is set from 0 to 1 by
the UICC. If the UICC is later inserted into a terminal that supports the
global and/or application specific phonebook, the terminal shall check the
flag in EF~PBC~ and if this flag is set, shall update the EF~CC~, and then
reset the flag. A flag set in EF~PBC~ results in a full synchronisation of the
phonebook between an external entity and the UICC (if synchronisation is
requested).
The EF structure related to the public phonebook is located under
DF~PHONEBOOK~ in DF~TELECOM~. A USIM specific phonebook may exist for
application specific entries. The application specific phonebook is protected
by the application PIN. The organisation of files in the application specific
phonebook follows the same rules as the one specified for the public phone
book under DF~TELECOM~. The application specific phonebook may contain a
different set of files than the one in the public area under DF~TELECOM~.
#### 4.4.2.1 EF~PBR~ (Phone Book Reference file)
This file describes the structure of the phonebook. All Efs representing the
phonebook are specified here (with the exception of EF~PSC~, EF~PUID~ and
EF~CC~), together with their file identifiers (FID) and their short file
identifiers (SFI), if applicable.
Certain kinds of Efs can occur more than once in the phonebook, e.g. there may
be two entities of Abbreviated Dialling Numbers, EF~ADN~ and EF~ADN1~. For
these kinds of Efs, no fixed FID values are specified. Instead, the value
\'4FXX\' indicates that the value is to be assigned by the card issuer. These
assigned values are then indicated in the associated TLV object in EF~PBR~.
The SFI value assigned to an EF which is indicated in EF~PBR~ shall correspond
to the SFI indicated in the TLV object in EF~PBR~.
The reference file is a file that contains information how the information in
the different files is to be combined together to form a phone book entry. The
reference file contains records. Each record specifies the structure of up to
254 entries in the phone book. Each phone book entry consists of data stored
in files indicated in the reference file record. The entry structure shall be
the same over all the records in the EF ~PBR~. If more than 254 entries are to
be stored, a second record is needed in the reference file. The structure of a
phone book entry is defined by different TLV objects that are stored in a
reference file record. The reference file record structure describes the way a
record in a file that is part of the phonebook is used to create a complete
entry. Three different types of file linking exist.
Type 1 files: Files that contain as many records as the reference/master file
(EF~ADN~, EF~ADN1~) and are linked on record number bases (Rec1 -> Rec1). The
master file record number is the reference.
Type 2 files: Files that contain less entries than the master file and are
linked via pointers in the index administration file (EF~IAP~).
Type 3 files: Files that are linked by a record identifier within a record.
Table 4.1: Phone Book Reference file Constructed Tags
* * *
Tag Value Constructed TAG Description \'A8\' Indicating files where the amount
of records equal to master EF, type 1 \'A9\' Indicating files that are linked
using the index administration file, type 2. Order of pointer appearance in
index administration EF is the same as the order of file Ids following this
tag \'AA\' Indicating files that are linked using a record identifier, type 3.
(The file pointed to is defined by the TLV object.)
* * *
The first file ID in the first record of EF~PBR~ indicated using constructed
Tag \'A8\' is called the master EF. Access conditions for all other files in
the Phonebook structure using Tags \'A8\', \'A9\' or \'AA\' is set to the same
as for the master EF unless otherwise specified in the present document.
File Ids indicated using constructed Tag \'A8\' is a type 1 file and contains
the same number of records as the first file that is indicated in the data
part of this TLV object. All files following this Tag are mapped one to one
using the record numbers/Ids of the first file indicated in this TLV object.
File Ids indicated using constructed Tag \'A9\' are mapped to the master EF
(the file ID indicated as the first data object in the TLV object using Tag
\'A8\') using the pointers in the index administration file. The order of the
pointers in the index administration file is the same as the order of the file
Ids presented after Tag \'A9\'. If this Tag is not present in the reference
file record the index administration file is not present in the structure. In
case the index administration file is not present in the structure it is not
indicated in the data following tag \'A8\'.
File Ids indicated using constructed Tag \'AA\' indicate files that are part
of the reference structure but they are addressed using record identifiers
within a record in one or more of the files that are part of the reference
structure. The length of the tag indicates whether the file to be addressed
resides in the same directory or if a path to the file is provided in the TLV
object.
Type 2 and type 3 files contain records that may be shared between several
phonebook entries (except when otherwise indicated). The terminal shall ensure
that a shared record is emptied when the last phonebook entry referencing it
is modified in such a way that it doesn\'t reference the record anymore.
NOTE: in the current version of the specification, only type 3 files contain
records that may be shared.
Each constructed Tag contains a list of primitive Tags indicating the order
and the kind of data (e.g. ADN, IAP,...) of the reference structure.
The primitive tag identifies clearly the type of data, its value field
indicates the file identifier and, if applicable, the SFI value of the
specified EF. That is, the length value of a primitive tag indicates if an SFI
value is available for the EF or not:
\- Length = \'02\' Value: \'FID (2 bytes)\'
\- Length = \'03\' Value: \'FID (2 bytes)\', \'SFI (1 byte)\'
Table 4.2: Tag definitions for the phone book kind of file
* * *
Tag Value TAG Description \'C0\' EF~ADN~ data object \'C1\' EF~IAP~ data
object \'C2\' EF~EXT1~ data object \'C3\' EF~SNE~ data object \'C4\' EF~ANR~
data object \'C5\' EF~PBC~ data object \'C6\' EF~GRP~ data object \'C7\'
EF~AAS~ data object \'C8\' EF~GAS~ data object \'C9\' EF~UID~ data object
\'CA\' EF~EMAIL~ data object \'CB\' EF~CCP1~ data object \'CC\' EF~PURI~ data
object
* * *
Table 4.3 (below) lists the allowed types for each kind of file:
Table 4.3: Presence of files as type
* * *
File name Type 1 Type 2 Type 3 EF~AAS~ X EF~ADN~ X  
EF~ANR~ X X  
EF~EMAIL~ X X  
EF~EXT1~ X EF~GAS~ X EF~GRP~ X  
EF~IAP~ X  
EF~PBC~ X  
EF~SNE~ X X  
EF~UID~ X  
EF~CCP1~ X EF~PURI~ X X
* * *
Phone Book Reference file EF~PBR~ structure
+--------------------+--------------------+--------------+---------+ | Identifier: | Structure: linear | Conditional\ | | | \'4F30\' | fixed | (see Note) | | +--------------------+--------------------+--------------+---------+ | Record Length: X | Update activity: | | | | bytes | low | | | +--------------------+--------------------+--------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+---------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+---------+ | 1 to X | TLV object(s) for | M | X bytes | | | indicating Efs | | | | | that are part of | | | | | the phone book | | | | | structure | | | +--------------------+--------------------+--------------+---------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if | | | | | DF~Phonebook~ is | | | | | present. | | | | +--------------------+--------------------+--------------+---------+
At the end of each record, unused bytes, if any, shall be filled with \'FF\'.
#### 4.4.2.2 EF~IAP~ (Index Administration Phone book)
This file is present if Tag \'A9\' is indicated in the reference file.
The EF contains pointers to the different records in the files that are part
of the phone book. The index administration file record number/ID is mapped
one to one with the corresponding EF~ADN~ (shall be record to record). The
index administration file contains the same amount of records as EF~ADN~. The
order of the pointers in an EF~IAP~ shall be the same as the order of file Ids
that appear in the TLV object indicated by Tag \'A9\' in the reference file
record. The amount of bytes in a record is equal to the number of files
indicated the EF~PBR~ following tag \'A9\'.
The value \'FF\' is an invalid record number/ID and is used in any location in
to indicate that no corresponding record in the indicated file is available.
The content of EF~IAP~ is set to \'FF\' at the personalisation stage.
Index administration file EF~IAP~ structure
+---------------------+---------------------+--------------+--------+ | Identifier: | Structure: linear | Conditional\ | | | \'4FXX\' | fixed | (see Note) | | +---------------------+---------------------+--------------+--------+ | SFI: \'YY\' | | | | +---------------------+---------------------+--------------+--------+ | Record Length: X | Update activity: | | | | bytes, (X ≥ 1) | low | | | +---------------------+---------------------+--------------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+--------------+--------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+--------------+--------+ | 1 | Record number of | M | 1 byte | | | the first object | | | | | indicated after Tag | | | | | \'A9\' | | | +---------------------+---------------------+--------------+--------+ | 2 | Record number of | C | 1 byte | | | the second object | | | | | indicated after Tag | | | | | \'A9\' | | | +---------------------+---------------------+--------------+--------+ | X | Record number of | C | 1 byte | | | the x^th^ object | | | | | indicated after Tag | | | | | \'A9\' | | | +---------------------+---------------------+--------------+--------+ | NOTE 1: This file | | | | | is mandatory if and | | | | | only if type 2 | | | | | files are present. | | | | | | | | | | NOTE 2: x^th^-field | | | | | marked with \'C\' | | | | | is mandatory if | | | | | x^th^-object | | | | | indicated following | | | | | tag \'A9\' is | | | | | present in EF~PBR~ | | | | +---------------------+---------------------+--------------+--------+
#### 4.4.2.3 EF~ADN~ (Abbreviated dialling numbers)
This EF contains Abbreviated Dialling Numbers (ADN) and/or Supplementary
Service Control strings (SSC). In addition it contains identifiers of
associated network/bearer capabilities and identifiers of extension records.
It may also contain an associated alpha‑tagging.
+--------------------+--------------------+--------------+----------+ | Identifier: | Structure: linear | Conditional\ | | | \'4FXX\' | fixed | (see Note) | | +--------------------+--------------------+--------------+----------+ | SFI: \'YY\' | | | | +--------------------+--------------------+--------------+----------+ | Record length: | Update activity: | | | | X+14 bytes | low | | | +--------------------+--------------------+--------------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+----------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +--------------------+--------------------+--------------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC | | | | | contents | | | +--------------------+--------------------+--------------+----------+ | X+2 | TON and NPI | M | 1 byte | +--------------------+--------------------+--------------+----------+ | X+3 to X+12 | Dialling | M | 10 bytes | | | Number/SSC String | | | +--------------------+--------------------+--------------+----------+ | X+13 | Capabil | M | 1 byte | | | ity/Configuration1 | | | | | Record Identifier | | | +--------------------+--------------------+--------------+----------+ | X+14 | Extension1 Record | M | 1 byte | | | Identifier | | | +--------------------+--------------------+--------------+----------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if | | | | | DF~PHONEBOOK~ is | | | | | present. | | | | +--------------------+--------------------+--------------+----------+
‑ Alpha Identifier.
Contents:
\- Alpha‑tagging of the associated dialling number.
Coding:
\- this alpha‑tagging shall use either:
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified. Unused bytes shall be
set to \'FF\'.
Or:
\- one of the UCS2 coded options as defined in the annex of TS 31.101 [11].
NOTE 1: The value of X may be from zero to 241. Using the command GET RESPONSE
the ME can determine the value of X.
‑ Length of BCD number/SSC contents.
Contents:
\- this byte gives the number of bytes of the following two data items
containing actual BCD number/SSC information. This means that the maximum
value is 11, even when the actual ADN/SSC information length is greater than
11. When an ADN/SSC has extension, it is indicated by the extension1
identifier being unequal to \'FF\'. The remainder is stored in the EF~EXT1~
with the remaining length of the additional data being coded in the
appropriate additional record itself (see clause 4.4.2.4).
Coding:
\- according to TS 24.008 [9].
‑ TON and NPI.
Contents:
\- Type of number (TON) and numbering plan identification (NPI).
Coding:
\- according to TS 24.008 [9]. If the Dialling Number/SSC String does not
contain a dialling number, e.g. a control string deactivating a service, the
TON/NPI byte shall be set to \'FF\' by the ME (see note 2).
NOTE 2: If a dialling number is absent, no TON/NPI byte is transmitted over
the radio interface (see TS 24.008 [9]). Accordingly, the ME should not
interpret the value \'FF\' and not send it over the radio interface.
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                NPI
                                                TON
                                                1
* * *
‑ Dialling Number/SSC String
Contents:
\- up to 20 digits of the telephone number and/or SSC information.
Coding:
\- according to TS 24.008 [9], TS 22.030 [4] and the extended BCD‑coding (see
table 4.4). If the telephone number or SSC is longer than 20 digits, the first
20 digits are stored in this data item and the remainder is stored in an
associated record in the EF~EXT1~. The record is identified by the Extension1
Record Identifier. If ADN/SSC require less than 20 digits, excess nibbles at
the end of the data item shall be set to \'F\'. Where individual dialled
numbers, in one or more records, of less than 20 digits share a common
appended digit string the first digits are stored in this data item and the
common digits stored in an associated record in the EF~EXT1~. The record is
identified by the Extension 1 Record Identifier. Excess nibbles at the end of
the data item shall be set to \'F\'.
Byte X+3
* * *
        B8   b7   B6   b5   b4   b3   b2   b1   
                                                LSB of Digit 1
                                                :
                                                :
                                                MSB of Digit 1
                                                LSB of Digit 2
                                                :
                                                :
                                                MSB of Digit 2
* * *
Byte X+4:
* * *
        B8   b7   B6   b5   b4   b3   b2   b1   
                                                LSB of Digit 3
                                                :
                                                :
                                                MSB of Digit 3
                                                LSB of Digit 4
                                                :
                                                :
                                                MSB of Digit 4
* * *
etc.
‑ Capability/Configuration1 Record Identifier.
Contents:
\- capability/configuration identification byte. This byte identifies the
number of a record in the EF~CCP1~ containing associated
capability/configuration parameters required for the call. The use of this
byte is optional. If it is not used it shall be set to \'FF\'.
Coding:
\- binary.
‑ Extension1 Record Identifier.
Contents:
\- extension1 record identification byte. This byte identifies the number of a
record in the EF~EXT1~ containing an associated called party subaddress or
additional data. The use of this byte is optional. If it is not used it shall
be set to \'FF\'.
\- if the ADN/SSC requires both additional data and called party subaddress,
this byte identifies the additional record. A chaining mechanism inside
EF~EXT1~ identifies the record of the appropriate called party subaddress (see
clause 4.4.2.4).
Coding:
\- binary.
NOTE 3: EF~ADN~ in the public phone book under DF~TELECOM~ may be used by
USIM, GSM and also other applications in a multi‑application card. If the
non‑GSM application does not recognise the use of Type of Number (TON) and
Number Plan Identification (NPI), then the information relating to the
national dialling plan shall be held within the data item dialling number/SSC
and the TON and NPI fields set to UNKNOWN. This format would be acceptable for
3GPP network operation and also for the non‑GSM application where the TON and
NPI fields shall be ignored.
EXAMPLE: SIM storage of an International Number using E.164 [22] numbering
plan.
> TON NPI Digit field.
>
> USIM application 001 0001 abc...
>
> Other application compatible with 3GPP specification 000 0000 xxx...abc...
>
> where \"abc...\" denotes the subscriber number digits (including its country
> code), and \"xxx...\" denotes escape digits or a national prefix replacing
> TON and NPI.
NOTE 4: When the ME acts upon the EF~ADN~ with a SEARCH RECORD command in
order to identify a character string in the alpha‑identifier, it is the
responsibility of the ME to ensure that the number of characters used as
SEARCH RECORD parameters are less than or equal to the value of X if the MMI
allows the user to offer a greater number.
Table 4.4: Extended BCD coding
* * *
BCD Value Character/Meaning \'0\' \"0\" **:** : \'9\' \"9\" \'A\' \"*\" \'B\'
\"#\" \'C\' DTMF Control digit separator (see TS 22.101 [24]). \'D\' \"Wild\"
value. This will cause the MMI to prompt the user for a single digit (see TS
22.101 [24]). \'E\' RFU. \'F\' Endmark e.g. in case of an odd number of
digits.
* * *
BCD values \'C\', \'D\' and \'E\' are never sent across the radio interface.
NOTE 5: The interpretation of values \'D\', \'E\' and \'F\' as DTMF digits is
for further study.
NOTE 6: A second or subsequent \'C\' BCD value will be interpreted as a 3
second PAUSE (see TS 22.101 [24]).
#### 4.4.2.4 EF~EXT1~ (Extension1)
This EF contains extension data of an ADN/SSC.
Extension data is caused by:
‑ an ADN/SSC which is greater than the 20 digit capacity of the ADN/SSC
Elementary File or where common digits are required to follow an ADN/SSC
string of less than 20 digits. The remainder is stored in this EF as a record,
which is identified by a specified identification byte inside the ADN/SSC
Elementary File. The EXT1 record in this case is specified as additional data;
‑ an associated called party subaddress. The EXT1 record in this case is
specified as subaddress data.
+-------------------------+-------------------------+----------+----------+ | Identifier: \'4FXX\' | Structure: linear fixed | Optional | | +-------------------------+-------------------------+----------+----------+ | SFI: \'YY\' | | | | +-------------------------+-------------------------+----------+----------+ | Record length: 13 bytes | Update activity: low | | | +-------------------------+-------------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+----------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+----------+ | 1 | Record type | M | 1 byte | +-------------------------+-------------------------+----------+----------+ | 2 to 12 | Extension data | M | 11 bytes | +-------------------------+-------------------------+----------+----------+ | 13 | Identifier | M | 1 byte | +-------------------------+-------------------------+----------+----------+
‑ Record type.
Contents:
\- type of the record.
Coding:
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                Called Party Subaddress
                                                Additional data
                                                RFU
* * *
\- b3 to b8 are reserved and set to 0;
\- a bit set to 1 identifies the type of record;
\- only one type can be set;
\- \'00\' indicates the type \"unknown\" or \"free\".
The following example of coding means that the type of extension data is
\"additional data\":
* * *
        B8   b7   b6   b5   b4   b3   b2   b1
        0    0    0    0    0    0    1    0
* * *
‑ Extension data.
Contents:\ additional data or Called Party Subaddress depending on record
type.
Coding:
Case 1, Extension1 record is additional data:
\- The first byte of the extension data gives the number of bytes of the
remainder of ADN/SSC. The coding of remaining bytes is BCD, according to the
coding of ADN/SSC. Unused nibbles at the end shall be set to \'F\'. It is
possible if the number of additional digits exceeds the capacity of the
additional record to chain another record inside the EXT1 Elementary File by
the identifier in byte 13. In this case byte 2 (first byte of the extension
data) of all records for additional data within the same chain indicates the
number of bytes (\'01\' to \'0A\') for ADN/SSC (respectively MSISDN, LND)
within the same record unequal to \'FF\'.
Case 2, Extension1 record is Called Party Subaddress:
\- The subaddress data contains information as defined for this purpose in TS
24.008 [9]. All information defined in TS 24.008 [9], except the information
element identifier, shall be stored in the USIM. The length of this subaddress
data can be up to 22 bytes. In those cases where two extension records are
needed, these records are chained by the identifier field. The extension
record containing the first part of the called party subaddress points to the
record which contains the second part of the subaddress.
‑ Identifier.
Contents:\ identifier of the next extension record to enable storage of
information longer than 11 bytes.
Coding:\ record number of next record. \'FF\' identifies the end of the chain.
\- Example of a chain of extension records being associated to an ADN/SSC. The
extension1 record identifier (Byte 14+X) of EF~ADN~ is set to 3.
In this example, ADN/SSC is associated to additional data (records 3 and 4)
which represent the last 27 or 28 digits of the whole ADN/SSC (the first 20
digits are stored in EF~ADN~) and a called party subaddress whose length is
more than 11 bytes (records 6 and 1).
#### 4.4.2.5 EF~PBC~ (Phone Book Control)
This EF contains control information related to each entry in the phone book.
This EF contains as many records as the EF~ADN~ associated with it (shall be
record to record). Each record in EF~PBC~ points to a record in its EF~ADN~.
This file indicates the control information and the hidden information of each
phone book entry.
The content of EF~PBC~ is linked to the associated EF~ADN~ record by means of
the ADN record number/ID (there is a one to one mapping of record
number/identifiers between EF~PBC~ and EF~ADN~).
Structure of control file EF~PBC~
+---------------------+---------------------+--------------+--------+ | Identifier: | Structure: linear | Conditional\ | | | \'4FXX\' | fixed | (see Note) | | +---------------------+---------------------+--------------+--------+ | SFI: \'YY\' | | | | +---------------------+---------------------+--------------+--------+ | Record length: 2 | Update activity: | | | | bytes | low | | | +---------------------+---------------------+--------------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+--------------+--------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+--------------+--------+ | 1 | Entry Control | M | 1 byte | | | Information | | | +---------------------+---------------------+--------------+--------+ | 2 | Hidden Information | M | 1 byte | +---------------------+---------------------+--------------+--------+ | NOTE: This file is | | | | | mandatory if one or | | | | | both of the | | | | | following is true:\ | | | | | - hidden entries | | | | | are supported\ | | | | | - a GSM SIM | | | | | application is | | | | | supported in the | | | | | UICC. | | | | +---------------------+---------------------+--------------+--------+
‑ Entry Control Information.
Contents:
\- provides some characteristics about the phone book entry e.g. modification
by a terminal accessing the ADN and EXT1 files under DF~TELECOM~ (see clause
4.4.2).
Coding:
* * *
        b8   B7   b6   B5   b4   B3   b2   B1   
                                                Modified phonebook entry \'1\', no change \'0\'
                                                RFU (see TS 31.101)
* * *
‑ Hidden Information.
Contents:\ indicates to which USIM application of the UICC this phone book
entry belongs, so that the corresponding secret code can be verified to
display the phone book entry. If the secret code is not verified, then the
phone book entry is hidden.
Coding:\ \'00\' -- the phone book entry is not hidden;\ \'xx\' -- the phone
book entry is hidden. \'xx\' is the record number in EF~DIR~ of the associated
USIM application.
#### 4.4.2.6 EF~GRP~ (Grouping file)
This EF contains the grouping information for each phone book entry. This file
contains as many records as the associated EF~ADN~. Each record contains a
list of group identifiers, where each identifier can reference a group to
which the entry belongs.
Structure of grouping file EF~GRP~
+---------------------+---------------------+--------------+--------+ | Identifier: | Structure: linear | Conditional\ | | | \'4FXX\' | fixed | (see Note) | | +---------------------+---------------------+--------------+--------+ | SFI: \'YY\' | | | | +---------------------+---------------------+--------------+--------+ | Record Length: X | Update activity: | | | | bytes (1 ≤ X ≤10) | low | | | +---------------------+---------------------+--------------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+--------------+--------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+--------------+--------+ | 1 | Group Name | M | 1 byte | | | Identifier 1 | | | +---------------------+---------------------+--------------+--------+ | 2 | Group Name | O | 1 byte | | | Identifier 2 | | | +---------------------+---------------------+--------------+--------+ | X | Group Name | O | 1 byte | | | Identifier X | | | +---------------------+---------------------+--------------+--------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if EF~GAS~ is | | | | | present. | | | | +---------------------+---------------------+--------------+--------+
‑ Group Name Identifier x.
Content:\ \- indicates if the associated entry is part of a group, in that
case it contains the record number of the group name in EF~GAS~.\ \- One entry
can be assigned to a maximum of 10 groups.
Coding:\ \- \'00\' -- no group indicated;\ \'XX\' -- record number in EF~GAS~
containing the alpha string naming the group of which the phone book entry is
a member.
#### 4.4.2.7 EF~AAS~ (Additional number Alpha String)
This file contains the alpha strings that are associated with the user defined
naming tags for additional numbers referenced in EF~ANR~.
Structure of EF~AAS~
+------------------------+-------------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: linear fixed | Optional | | +------------------------+-------------------------+----------+---------+ | SFI: Optional | | | | +------------------------+-------------------------+----------+---------+ | Record length: X bytes | Update activity: low | | | +------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+-------------------------+----------+---------+ | 1 to X | Alpha text string | M | X bytes | +------------------------+-------------------------+----------+---------+
‑ Alpha text string.
Content:\ \- user defined text for additional number.
Coding:\ \- same as the alpha identifier in EF~ADN~.
#### 4.4.2.8 EF~GAS~ (Grouping information Alpha String)
This file contains the alpha strings that are associated with the group name
referenced in EF~GRP~.
Structure of EF~GAS~
+--------------------+--------------------+--------------+---------+ | Identifier: | Structure: linear | Conditional\ | | | \'4FXX\' | fixed | (see Note) | | +--------------------+--------------------+--------------+---------+ | SFI: Optional | | | | +--------------------+--------------------+--------------+---------+ | Record length: X | Update activity: | | | | bytes | low | | | +--------------------+--------------------+--------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+---------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+---------+ | 1 to X | Alpha text string | M | X bytes | +--------------------+--------------------+--------------+---------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if EF~GRP~ is | | | | | present. | | | | +--------------------+--------------------+--------------+---------+
‑ Alpha text string
Content:\ \- group names.
Coding:\ \- same as the alpha identifier in EF~ADN~.
#### 4.4.2.9 EF~ANR~ (Additional Number)
Several phone numbers and/or Supplementary Service Control strings (SSC) can
be attached to one EF~ADN~ record, using one or several EF~ANR~. The amount of
additional number entries may be less than or equal to the amount of records
in EF~ADN~. The EF structure is linear fixed. Each record contains an
additional phone number or Supplementary Service Control strings (SSC). This
record cannot be shared between several phonebook entries. The first byte
indicates whether the record is free or the type of additional number
referring to the record number in EF~AAS~, containing the text to be
displayed. The following part indicates the additional number and the
reference to the associated record in the EF~ADN~ file. In addition it
contains identifiers of associated network/bearer capabilities and identifiers
of extension records.
Structure of EF~ANR~
+----------------------+----------------------+----------+----------+ | Identifier: \'4FXX\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | SFI: \'YY\' | | | | +----------------------+----------------------+----------+----------+ | Record length: 15 or | Update activity: low | | | | 17 bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 | Additional Number | M | 1 byte | | | Record identifier | | | +----------------------+----------------------+----------+----------+ | 2 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | 3 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | 4 to 13 | Additional | M | 10 bytes | | | number/SSC String | | | +----------------------+----------------------+----------+----------+ | 14 | Capab | M | 1 byte | | | ility/Configuration1 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | 15 | Extension1 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+ | 16 | ADN file SFI | C | 1 byte | +----------------------+----------------------+----------+----------+ | 17 | ADN file Record | C | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+ | NOTE: The fields | | | | | marked C above are | | | | | mandatory if and | | | | | only if the file is | | | | | not type 1 (as | | | | | specified in | | | | | EF~PBR~) | | | | +----------------------+----------------------+----------+----------+
‑ Additional Number Record Identifier
Content:\ \- describes the type of the additional number defined in the file
EF~AAS~.
Coding:\ \- \'00\' -- no additional number description;\ \'xx\' -- record
number in EF~AAS~ describing the type of number (e.g. \"FAX\");\ \'FF\' --
free record.
\- Length of BCD number/SSC contents
Contents:\ \- this byte gives the number of bytes of the following two data
items containing actual BCD number/SSC information. This means that the
maximum value is 11, even when the actual additional number/SSC information
length is greater than 11. When the additional number/SSC has extension, it is
indicated by the extension1 identifier being unequal to \'FF\'. The remainder
is stored in the EF~EXT1~ with the remaining length of the additional data
being coded in the appropriate additional record itself (see clause 4.4.2.4).
Coding:\ \- same as the length of BCD number/SSC string byte in EF~ADN.~
‑ TON and NPI.
Contents:\ \- Type of number (TON) and numbering plan identification (NPI).
Coding:\ \- same as the TON and NPI byte in EF~ADN.~
‑ Additional number/SSC string
Content:\ \- up to 20 digits of the additional phone number and/or SSC
information linked to the phone book entry.
Coding:\ \- same as the dialling number /SSC string in EF~ADN.~
‑ Capability/Configuration1 Record Identifier.
Contents:\ \- This byte identifies the number of a record in the EF~CCP1~
containing associated capability/configuration parameters required for the
call. The use of this byte is optional. If it is not used it shall be set to
\'FF\'.
Coding:\ \- binary.
‑ Extension1 Record Identifier.
Contents:\ \- extension1 record identification byte. This byte identifies the
number of a record in the EF~EXT1~ containing an associated called party
subaddress or additional data. The use of this byte is optional. If it is not
used it shall be set to \'FF\'.\ if the number requires both additional data
and called party subaddress, this byte identifies the additional record. A
chaining mechanism inside EF~EXT1~ identifies the record of the appropriate
called party subaddress (see clause 4.4.2.4).
Coding:\ \- binary.
‑ ADN file SFI.
Content:\ \- Short File identifier of the associated EF~ADN~ file.
Coding:\ \- as defined in the UICC specification.
‑ ADN file Record Identifier
Content:\ \- record identifier of the associated phone book entry.
Coding:\ \- \'xx\' -- record identifier of the corresponding ADN record.
#### 4.4.2.10 EF~SNE~ (Second Name Entry)
The phone book also contains the option of a second name entry. The amount of
second name entries may be less than or equal to the amount of records in
EF~ADN~. Each record contains a second name entry. This record cannot be
shared between several phonebook entries.
Structure of EF~SNE~
+----------------------+----------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'YY\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X or | Update activity: low | | | | X+2 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | Alpha Identifier of | M | X bytes | | | Second Name | | | +----------------------+----------------------+----------+---------+ | X+1 | ADN file SFI | C | 1 byte | +----------------------+----------------------+----------+---------+ | X+2 | ADN file Record | C | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+---------+ | NOTE: The fields | | | | | marked C above are | | | | | mandatory if and | | | | | only if the file is | | | | | not type 1 (as | | | | | specified in | | | | | EF~PBR~) | | | | +----------------------+----------------------+----------+---------+
‑ Alpha Identifier of Second Name.
Content:\ \- string defining the second name of the phone book entry.
Coding:\ \- as the alpha identifier for EF~ADN~.
‑ ADN file SFI.
Content:\ \- Short File identifier of the associated EF~ADN~ file.
Coding:\ \- as defined in the UICC specification.
‑ ADN file Record Identifier
Content:\ record identifier of the associated phone book entry.
Coding:\ \'xx\' -- record identifier of the corresponding ADN record.
#### 4.4.2.11 EF~CCP1~ (Capability Configuration Parameters 1)
This EF contains parameters of required network and bearer capabilities and ME
configurations associated with a call established using a phone book entry.
Structure of EF~CCP1~
+----------------------+----------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'YY\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X | Update activity: low | | | | bytes, X ≥ 15 | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | Bearer capability | M | X bytes | | | information element | | | +----------------------+----------------------+----------+---------+
‑ Bearer capability information element.
Contents and Coding:\ \- see TS 24.008 [9]. The Information Element Identity
(IEI) shall be excluded; i.e. the first byte of the EF~CCP1~ record shall be
Length of the bearer capability contents.
\'\'- unused bytes are filled with \'FF\'
#### 4.4.2.12 Phone Book Synchronisation
To support synchronisation of phone book data with other devices, the USIM may
provide the following files to be used by the synchronisation method: a phone
book synchronisation counter (PSC), a unique identifier (UID) and change
counter (CC) to indicate recent changes.
If synchronisation is supported in the phonebook, then EF~PSC~, EF~UID~,
EF~PUID~ and EF~CC~ are all mandatory.
##### 4.4.2.12.1 EF~UID~ (Unique Identifier)
The EF~UID~ is used to uniquely identify a record and to be able to keep track
of the entry in the phone book. The terminal assigns the (UID) when a new
entry is created. The value of the UID does not change as long as the value of
the PBID remains the same. The UID shall remain on the UICC, in EF~UID~, until
the PBID is regenerated. This means that when a phone book entry is deleted,
the content of the linked information (e.g. ADN, E-MAIL,..) shall be set to
the personalization value \'FF...FF\'. But the UID-value of the deleted record
shall not be used when a new entry is added to the phonebook until the PBID is
regenerated, but it shall be set to a new value.
If/when the PBID is regenerated, all UIDs for the entry in the phone book
shall be assigned new values starting from 1. If more than one EF~UID~ exists
(i.e. multiple phone book file sets) then all values of UIDs used in that
phone book shall be unique over all phone book file sets within that phone
book. The new value of the UID for each entry shall then be kept until the
PBID is regenerated again.
Structure of EF~UID~
+--------------------+--------------------+--------------+---------+ | Identifier: | Structure: linear | Conditional\ | | | \'4FXX\' | fixed | (see Note) | | +--------------------+--------------------+--------------+---------+ | SFI: \'YY\' | | | | +--------------------+--------------------+--------------+---------+ | Record length: 2 | Update activity: | | | | bytes | low | | | +--------------------+--------------------+--------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+---------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+---------+ | 1 to 2 | Unique Identifier | M | 2 bytes | | | (UID) of Phone | | | | | Book Entry | | | +--------------------+--------------------+--------------+---------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if | | | | | synchronisation is | | | | | supported in the | | | | | phonebook. | | | | +--------------------+--------------------+--------------+---------+
‑ Unique Identifier of Phone Book Entry.
Content:\ \- number to unambiguously identify the phone book entry for
synchronisation purposes.
Coding:\ \- hexadecimal value. At initialisation all UIDs are personalised to
\'\'00 00\'\' (i.e. empty).
##### 4.4.2.12.2 EF~PSC~ (Phone book Synchronisation Counter)
The phone book synchronisation counter (PSC) is used by the ME to construct
the phone book identifier (PBID) and to determine whether the accessed phone
book is the same as the previously accessed phone book or if it is a new
unknown phone book (might be the case that there is one phonebook under DF-
telecom and one phone book residing in a USIM-application). If the PSC is
unknown, a full synchronisation of the phone book will follow.
The PSC is also used to regenerate the UIDs and reset the CC to prevent them
from running out of range. When the UIDs or the CC has reached its maximum
value, a new PSC is generated. This leads to a scenario where neither the CC
nor the UIDs will run out of range.
The PSC shall be regenerated by the terminal if one of the following situation
applies:
\- the values of the UIDs have run out of range;
\- the whole phone book has been reset/deleted;
\- the value of the CC has run out of range.
Structure of EF~PSC~
+--------------------+--------------------+--------------+---------+ | Identifier: | Structure: | Conditional\ | | | \'4F22\' | transparent | (see Note) | | +--------------------+--------------------+--------------+---------+ | SFI: \'YY\' | | | | +--------------------+--------------------+--------------+---------+ | File size: 4 bytes | Update activity: | | | | | low | | | +--------------------+--------------------+--------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+---------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+---------+ | 1 to 4 | Phone book | M | 4 bytes | | | synchronisation | | | | | counter (PSC) | | | +--------------------+--------------------+--------------+---------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if | | | | | synchronisation is | | | | | supported in the | | | | | phonebook. | | | | +--------------------+--------------------+--------------+---------+
‑ PSC: Unique synchronisation counter of Phone Book.
Content:\ number to unambiguously identify the status of the phone book for
synchronisation purposes.
Coding:\ hexadecimal value.
> The phone book identifier (PBID) coding based on the EF~PSC~ is described
> hereafter:
\- For a phone book residing in DF-telecom:
\- PBID = ICCid (10bytes) \"fixed part\" + 4 bytes (in EF~PSC~) \"variable
part\".
\- For a phone book residing in an USIM application:
\- PBID = 10 last bytes of (ICCid XOR AID) \"fixed part\" + 4 bytes (in
EF~PSC~) \"variable part\".
> To be able to detect if the PSC needs to be regenerated (i.e. the variable
> part) the following test shall be made by the terminal before for each
> update of either the CC or the assignment of a new UID:
\- Each time the terminal has to increment the value of the UID the following
test is needed:
\- If UID = \'FF FF\' then.
{Increment **PSC** mod \'FF FF FF FF\'; all the UIDs shall be regenerated}.
\- Each time the terminal has to increment the value of CC the following test
is needed:
If CC = \'FF FF\' then.
{Increment **PSC** mod \'FF FF FF FF\'; CC=0001}.
NOTE: If the phonebook is deleted then the terminal will change the **PSC**
according to:
Incrementing **PSC** modulus \'FFFFFFFF\'.
##### 4.4.2.12.3 EF~CC~ (Change Counter)
The change counter (CC) shall be used to detect changes made to the phone
book.
Every update/deletion of an existing phone book entry or the addition of a new
phone book entry causes the terminal to increment the EF~CC~. The concept of
having a CC makes it possible to update the phone book in different terminals,
which still are able to detect the changes (e.g. changes between different
handset and/or 2^nd^ and 3^rd^ generation of terminals).
Structure of EF~CC~
+--------------------+--------------------+--------------+---------+ | Identifier: | Structure: | Conditional\ | | | \'4F23\' | transparent | (see Note) | | +--------------------+--------------------+--------------+---------+ | SFI: \'YY\' | | | | +--------------------+--------------------+--------------+---------+ | File size: 2 bytes | Update activity: | | | | | high | | | +--------------------+--------------------+--------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+---------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+---------+ | 1 to 2 | Change Counter | M | 2 bytes | | | (CC) of Phone Book | | | +--------------------+--------------------+--------------+---------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if | | | | | synchronisation is | | | | | supported in the | | | | | phonebook. | | | | +--------------------+--------------------+--------------+---------+
‑ Change Counter of Phone Book.
Content:\ \- indicates recent change(s) to phone book entries for
synchronisation purposes.
Coding:\ \- hexadecimal value. At initialisation, CC shall be personalised to
\'00 00\' (i.e. empty).
##### 4.4.2.12.4 EF~PUID~ (Previous Unique Identifier)
The PUID is used to store the previously used unique identifier (UID). The
purpose of this file is to allow the terminal to quickly generate a new UID,
which shall then be stored in the EF~UID~.
Structure of EF~PUID~
+--------------------+--------------------+--------------+---------+ | Identifier: | Structure: | Conditional\ | | | \'4F24\' | transparent | (see Note) | | +--------------------+--------------------+--------------+---------+ | SFI: \'YY\' | | | | +--------------------+--------------------+--------------+---------+ | File size: 2 bytes | Update activity: | | | | | high | | | +--------------------+--------------------+--------------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------+--------------------+--------------+---------+ | Bytes | Description | M/O | Length | +--------------------+--------------------+--------------+---------+ | 1 to 2 | Previous Unique | M | 2 bytes | | | Identifier (PUID) | | | | | of Phone Book | | | | | Entry | | | +--------------------+--------------------+--------------+---------+ | NOTE: This file is | | | | | mandatory if and | | | | | only if | | | | | synchronisation is | | | | | supported in the | | | | | phonebook. | | | | +--------------------+--------------------+--------------+---------+
‑ Previous unique Identifier of Phone Book Entry.
Content:\ \- Previous number that was used to unambiguously identify the phone
book entry for synchronisation purposes.
Coding:
\- As for EF~UID~
#### 4.4.2.13 EF~EMAIL~ (e-mail address)
This EF contains the e-mail addresses that may be linked to a phone book
entry. Several e-mail addresses can be attached to one EF~ADN~ record, using
one or several EF~EMAIL~. The number of email addresses may be equal to or
less than the amount of records in EF~ADN~. Each record contains an e-mail
address. The first part indicates the e-mail address, and the second part
indicates the reference to the associated record in the EF~ADN~ file. This
record cannot be shared between several phonebook entries.
Structure of EF~EMAIL~
+----------------------+----------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'YY\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X or | Update activity: low | | | | X+2 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | E-mail Address | M | X bytes | +----------------------+----------------------+----------+---------+ | : | : | : | : | +----------------------+----------------------+----------+---------+ | : | : | : | : | +----------------------+----------------------+----------+---------+ | X+1 | ADN file SFI | C | 1 byte | +----------------------+----------------------+----------+---------+ | X+2 | ADN file Record | C | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+---------+ | NOTE: The fields | | | | | marked C above are | | | | | mandatory if and | | | | | only if the file is | | | | | not type 1 (as | | | | | specified in | | | | | EF~PBR~) | | | | +----------------------+----------------------+----------+---------+
‑ E-mail Address.
Content:\ \- string defining the e-mail address
Coding:\ \- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5]
with bit 8 set to 0. The alpha identifier shall be left justified. Unused
bytes shall be set to \'FF\'.
‑ ADN file SFI.
Content:\ \- short File identifier of the associated EF~ADN~ file.
Coding:\ \- as defined in TS 31.101 [11].
‑ ADN file Record Identifier.
Content:\ \- record identifier of the associated phone book entry.
Coding:\ \- binary.
#### 4.4.2.14 Phonebook restrictions
This clause lists some general restrictions that apply to the phonebook:
\- if an EF~PBR~ file contains more than one record, then they shall all be
formatted identically on a type-by-type basis, e.g. if EF~PBR~ record #1
contains one type 1 e-mail then all EF~PBR~ records shall have one type 1
email;
\- if an EF~PBR~ record contains more than one reference to one kind of file,
such as two EF~EMAIL~ files, then they shall all be formatted identically on a
type-by-type basis, e.g. if an EF~PBR~ record has 2 email addresses, then they
shall have the same record size and the same number of records in each EF~PBR~
entry;
\- an EF~PBR~ record may contain TLV entries indicating that the file exist as
a type 1 and 2 file, e.g. a phonebook entry may have two emails, one with a
one-to-one mapping (type 1) and one with a indirect mapping (type 2).
Regardless of the type, files in all entries shall have the same record
configuration;
\- an EF~PBR~ record shall not contain more than one occurrence of a given
kind of file indicated in tag \'AA\' (type 3 link). For instance, an EF~PBR~
record may only contain one reference to an EF~EXT1~.
#### 4.4.2.15 EF~PURI~ (Phonebook URIs)
This EF contains the URI address that may be linked to a phonebook entry.
Several URI addresses can be attached to one EF~ADN~ record, using one or
several EF~PURI~. The number of URI addresses may be equal to or less than the
amount of records in EF~ADN~. Each record contains a URI address. The first
part indicates the URI address, and the second part indicates the reference to
the associated record in the EF~ADN~ file. This record cannot be shared
between several phonebook entries.
Structure of EF~PURI~
+----------------------+----------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'YY\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X or | Update activity: low | | | | X+2 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | URI Address | M | X bytes | +----------------------+----------------------+----------+---------+ | X+1 | ADN file SFI | C | 1 byte | +----------------------+----------------------+----------+---------+ | X+2 | ADN file Record | C | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+---------+ | NOTE: The fields | | | | | marked C above are | | | | | mandatory if and | | | | | only if the file is | | | | | not type 1 (as | | | | | specified in | | | | | EF~PBR~) | | | | +----------------------+----------------------+----------+---------+
‑ URI Address.
Content:\ \- The URI Address associated to the ADN Record.
Coding:\ \- Same as URI TLV data object in EF~IMPU~ defined in TS 31.103 [64].
‑ ADN file SFI.
Content:\ \- Short File identifier of the associated EF~ADN~ file.
Coding:\ \- as defined in TS 31.101 [11].
‑ ADN file Record Identifier.
Content:\ \- record identifier of the associated phone book entry.
Coding:\ \- binary.
### 4.4.3 Contents of files at the DF GSM-ACCESS level (Files required for GSM
Access)
The Efs described in this clause are required for the USIM application to be
able to access service through a GSM network.
The presence of this DF and thus the support of a GSM access is indicated in
the \'USIM Service Table\' as service no. \'27\' being available.
#### 4.4.3.1 EF~Kc~ (GSM Ciphering key Kc)
If service n°27 is \"available\", this file shall be present.
This EF contains the ciphering key Kc and the ciphering key sequence number n
for enciphering in a GSM access network.
+----------------------+---------------------------------+----------+---------+ | Identifier: \'4F20\' | Structure: transparent | Optional | | +----------------------+---------------------------------+----------+---------+ | SFI: \'01\' | | | | +----------------------+---------------------------------+----------+---------+ | File size: 9 bytes | Update activity: high | | | +----------------------+---------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------------+----------+---------+ | 1 to 8 | Ciphering key Kc | M | 8 bytes | +----------------------+---------------------------------+----------+---------+ | 9 | Ciphering key sequence number n | M | 1 byte | +----------------------+---------------------------------+----------+---------+
‑ Ciphering key Kc.
Coding:
\- the least significant bit of Kc is the least significant bit of the eighth
byte. The most significant bit of Kc is the most significant bit of the first
byte.
‑ Ciphering key sequence number n
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                N
                                                bits b4 to b8 are coded 0
* * *
NOTE: TS 24.008 [9] defines the value of n=111 as \"key not available\".
Therefore the value \'07\' and not \'FF\' should be present following the
administrative phase.
#### 4.4.3.2 EF~KcGPRS~ (GPRS Ciphering key KcGPRS)
If service n°27 is \"available\", this file shall be present.
This EF contains the ciphering key KcGPRS and the ciphering key sequence
number n for GPRS (see TS 23.060 [7]).
+----------------------+----------------------+----------+---------+ | Identifier: \'4F52\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'02 | | | | +----------------------+----------------------+----------+---------+ | File size: 9 bytes | Update activity: | | | | | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 8 | Ciphering key KcGPRS | M | 8 bytes | +----------------------+----------------------+----------+---------+ | 9 | Ciphering key | M | 1 byte | | | sequence number n | | | | | for GPRS | | | +----------------------+----------------------+----------+---------+
‑ Ciphering key KcGPRS.
Coding:
the least significant bit of KcGPRS is the least significant bit of the eighth
byte. The most significant bit of KcGPRS is the most significant bit of the
first byte.
‑ Ciphering key sequence number n for GPRS.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                n
                                                bits b4 to b8 are coded 0
* * *
NOTE: TS 24.008 [9] defines the value of n=111 as \"key not available\".
Therefore the value \'07\' and not \'FF\' should be present following the
administrative phase.
#### 4.4.3.3 Void
#### 4.4.3.4 EF~CPBCCH~ (CPBCCH Information)
If service n°39 is \"available\", this file shall be present.
This EF contains information concerning the CPBCCH according to TS 44.018
[28].
CPBCCH storage may reduce the extent of a Mobile Station\'s search of CPBCCH
carriers when selecting a cell. The CPBCCH carrier lists shall be in
accordance with the procedures specified TS 23.022 [29]. The MS stores CPBCCH
information (from the System Information 19 message, Packet System Information
3, and Packet System Information 3 bis) on the USIM. The same CPBCCH carrier
shall never occur twice in the list.
+----------------------+----------------------------------+----------+---------+ | Identifier: \'4F63\' | Structure: transparent | Optional | | +----------------------+----------------------------------+----------+---------+ | File size: 2n bytes | Update activity: high | | | +----------------------+----------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------------------+----------+---------+ | 1 to 2 | Element 1 of CPBCCH carrier list | M | 2 bytes | +----------------------+----------------------------------+----------+---------+ | : | : | : | : | +----------------------+----------------------------------+----------+---------+ | 2n-1 to 2n | Element n of CPBCCH carrier list | M | 2 bytes | +----------------------+----------------------------------+----------+---------+
‑ Element in CPBCCH carrier list
Coding:\ Byte 1: first byte of CPBCCH carrier list element
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                LSB of ARFCN
                                                :
                                                :
                                                :
                                                :
                                                :
                                                :
                                                :
* * *
Byte 2: second byte of CPBCCH carrier list element
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                :
                                                MSB of ARFCN
                                                High/Low band indicator
                                                bits b4 to b7 are RFU
                                                Empty indicator
* * *
\- ARFCN (10 bits) as defined in TS 45.005 [34].
\- High/Low band indicator: If the ARFCN indicates possibly a channel in the
DCS 1800 or a channel in the PCS 1900 band, if the bit is set to \'1\' the
channel is in the higher band (GSM 1900). If the bit is set to \'0\', the
lower band (GSM 1800) is indicated. If ARFCN indicates a unique channel, this
indicator shall be set to \'0\'.
\- Empty indicator: If this bit is set to \'1\', no valid CPBCCH carrier is
stored in this position. If the Empty Indicator is set to \'1\', the content
of the CPBCCH carrier field shall be ignored. The empty indicator shall also
be used, and set to \'1\', if storage of fewer than maximum number n, of
CPBCCH carrier fields is required.
#### 4.4.3.5 EF~InvScan~ (Investigation Scan)
If service n°40 is \"available\", this file shall be present.
This EF contains two flags used to control the investigation scan for higher
prioritized PLMNs not offering voice services.
+----------------------+--------------------------+----------+--------+ | Identifier: \'4F64\' | Structure: transparent | Optional | | +----------------------+--------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+--------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------+----------+--------+ | 1 | Investigation scan flags | M | 1 byte | +----------------------+--------------------------+----------+--------+
‑ Investigation scan flags
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                In limited service mode
                                                After successful PLMN selection
                                                Bits b3 to b8 are coded RFU
* * *
A \'1\' in a bit position indicates that the investigation scan shall be
performed for the condition corresponding to that bit position and a \'0\'
that it shall not be performed.
If this elementary file is not present, no investigation scan shall be
performed.
### 4.4.4 Contents of files at the MexE level
This clause specifies the Efs in the dedicated file DF~MexE~. It only applies
if the USIM supports MexE (see TS 23.057 [30]).
The presence of this DF is indicated in the \'USIM Service Table\' as service
no. \'41\' being available.
The Efs in the Dedicated File DF~MexE~ contain execution environment related
information.
#### 4.4.4.1 EF~MexE-ST~ (MexE Service table)
If service n°41 is \"available\", this file shall be present.
This EF indicates which MexE services are available. If a service is not
indicated as available in the USIM, the ME shall not select this service.
+-------------------------+-------------------------+----------+--------+ | Identifier: \'4F40\' | Structure: transparent | Optional | | +-------------------------+-------------------------+----------+--------+ | File size: X bytes, X 1 | Update activity: low | | | +-------------------------+-------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-------------------------+-------------------------+----------+--------+ | Bytes | Description | M/O | Length | +-------------------------+-------------------------+----------+--------+ | 1 | Services n1 to n8 | M | 1 byte | +-------------------------+-------------------------+----------+--------+ | 2 | Services n9 to n16 | O | 1 byte | +-------------------------+-------------------------+----------+--------+ | etc. | | | | +-------------------------+-------------------------+----------+--------+ | X | Services (8X‑7) to (8X) | O | 1 byte | +-------------------------+-------------------------+----------+--------+
* * *
‑Services  
Contents: Service n°1: Operator Root Public Key Service n°2: Administrator
Root Public Key Service n°3: Third Party Root Public Key Service n°4: RFU
* * *
Coding:
the coding rules of the USIM Service Table apply to this table.
#### 4.4.4.2 EF~ORPK~ (Operator Root Public Key)
If service n°41 is \"available\", this file shall be present.
This EF contains the descriptor(s) of certificates containing the Operator
Root Public Key. This EF shall only be allocated if the operator wishes to
verify applications and certificates in the MexE operator domain using a root
public key held in the USIM. Each record of this EF contains one certificate
descriptor.
For example, an operator may provide a second key for recover disaster
procedure in order to limit OTA data to load.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F41\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | Record length: X + | Update activity: low | | | | 10 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Parameters indicator | M | 1 byte | +----------------------+----------------------+----------+---------+ | 2 | Flags | M | 1 byte | +----------------------+----------------------+----------+---------+ | 3 | Type of certificate | M | 1 byte | +----------------------+----------------------+----------+---------+ | 4 to 5 | Key/certificate file | M | 2 bytes | | | identifier | | | +----------------------+----------------------+----------+---------+ | 6 to 7 | Offset into | M | 2 bytes | | | key/certificate file | | | +----------------------+----------------------+----------+---------+ | 8 to 9 | Length of | M | 2 bytes | | | key/certificate data | | | +----------------------+----------------------+----------+---------+ | 10 | Key identifier | M | 1 byte | | | length (X) | | | +----------------------+----------------------+----------+---------+ | 11 to 10+X | Key identifier | M | X bytes | +----------------------+----------------------+----------+---------+
‑ Parameter indicator
Contents:\ The parameter indicator indicates if record is full and which
optional parameters are present
Coding: bit string
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Certificate descriptor is valid (bit1=0 key descriptor is valid)
                                                Reserved bit set to 1 (bitx=0 optional parameter present)
* * *
‑ Flags
Contents:\ The authority flag indicates whether the certificate identify an
authority (i.e. CA or AA) or not.
Coding: bit string
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Authority certificate (bit=1 certificate of an authority)
                                                RFU
                                                RFU
* * *
‑ Type of certificate
Contents:\ This field indicates the type of certificate containing the key.
> Coding: binary:\ 0 : WTLS\ 1 : X509\ 2 : X9.68\ Other values are reserved
> for further use
\- Key/certificate File Identifier
> Contents:
these bytes identify an EF which is the key/certificate data file (see clause
4.4.4.5), holding the actual key/certificate data for this record.
> Coding:
>
> byte 4: high byte of Key/certificate File Identifier;
>
> byte 5: low byte of Key/certificate File Identifier.
\- Offset into Key/certificate File
> Contents:
these bytes specify an offset into the transparent key/certificate data File
identified in bytes 4 and 5.
> Coding:
>
> byte 6: high byte of offset into Key/certificate Data File;
>
> byte 7: low byte of offset into Key/certificate Data File
\- Length of Key/certificate Data
> Contents:
these bytes yield the length of the key/certificate data, starting at the
offset identified in \"Offset into Key/certificate File\" field.
> Coding:
>
> byte 8: high byte of Key/certificate Data length;
>
> byte 9: low byte of Key/certificate Data length.
‑ Key identifier length
Contents:\ This field gives length of key identifier
Coding:\ binary
‑ Key identifier
Contents:\ This field provides a means of identifying certificates that
contain a particular public key (chain building) and linking the public key to
its corresponding private key. For more information about value and using see
TS 23.057 [30].
Coding:\ octet string
NOTE: transparent key/certificate data longer than 256 bytes may be read using
successive READ BINARY commands.
#### 4.4.4.3 EF~ARPK~ (Administrator Root Public Key)
If service n°41 is \"available\", this file shall be present.
This EF contains the descriptor(s) of certificates containing the
Administrator Root Public Key. This EF shall only be allocated if the SIM
issuer wishes to control the Third Party certificates on the terminal using an
Administrator root public key held in the USIM. Each record of this EF
contents one certificate descriptor.
This file shall contain only one record.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F42\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | Record length: X + | Update activity: low | | | | 10 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Parameters indicator | M | 1 byte | +----------------------+----------------------+----------+---------+ | 2 | Flags | M | 1 byte | +----------------------+----------------------+----------+---------+ | 3 | Type of certificate | M | 1 byte | +----------------------+----------------------+----------+---------+ | 4 to 5 | Key/certificate file | M | 2 bytes | | | identifier | | | +----------------------+----------------------+----------+---------+ | 6 to 7 | Offset into | M | 2 bytes | | | key/certificate file | | | +----------------------+----------------------+----------+---------+ | 8 to 9 | Length of | M | 2 bytes | | | key/certificate data | | | +----------------------+----------------------+----------+---------+ | 10 | Key identifier | M | 1 byte | | | length (X) | | | +----------------------+----------------------+----------+---------+ | 11 to 10+X | Key identifier | M | X bytes | +----------------------+----------------------+----------+---------+
For contents and coding of all data items see the respective data items of the
EF~ORPK~ (clause 4.4.4.2).
#### 4.4.4.4 EF~TPRPK~ (Third Party Root Public Key)
If service n°41 is \"available\", this file shall be present.
This EF contains descriptor(s) of certificates containing the Third Party root
public key (s). This EF shall only be allocated if the USIM issuer wishes to
verify applications and certificates in the MexE Third Party domain using root
public key(s) held in the USIM. This EF can contain one or more root public
keys. Each record of this EF contains one certificate descriptor.
For example, an operator may provide several Third Party Root Public Keys.
+----------------------+----------------------+----------+---------+ | Identifier:\'4F43\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | Record length: X + Y | Update activity: low | | | | + 11 bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Parameters indicator | M | 1 byte | +----------------------+----------------------+----------+---------+ | 2 | Flags | M | 1 byte | +----------------------+----------------------+----------+---------+ | 3 | Type of certificate | M | 1 byte | +----------------------+----------------------+----------+---------+ | 4 to 5 | Key/certificate file | M | 2 bytes | | | identifier | | | +----------------------+----------------------+----------+---------+ | 6 to 7 | Offset into | M | 2 bytes | | | key/certificate file | | | +----------------------+----------------------+----------+---------+ | 8 to 9 | Length of | M | 2 bytes | | | key/certificate data | | | +----------------------+----------------------+----------+---------+ | 10 | Key identifier | M | 1 byte | | | length (X) | | | +----------------------+----------------------+----------+---------+ | 11 to 10+X | Key identifier | M | X bytes | +----------------------+----------------------+----------+---------+ | 11+X | Certificate | M | 1 byte | | | identifier length | | | | | (Y) | | | +----------------------+----------------------+----------+---------+ | 12+X to 11+X+Y | Certificate | M | Y bytes | | | identifier | | | +----------------------+----------------------+----------+---------+
‑ Certificate identifier length
Contents:\ This field gives the length of the certificate identifier
Coding:\ binary
‑ Certificate identifier
Contents:\ This field identifies the issuer and provides an easy way to find a
certificate. For more information about the value and usage see TS 23.057
[30].
Coding:\ Octet string
For contents and coding of all other data items see the respective data items
of the EF~ORPK~ (clause 4.4.4.2).
#### 4.4.4.5 EF~TKCDF~ (Trusted Key/Certificates Data Files)
Residing under DF~MexE~, there may be several key/certificates data files.
These Efs containing key/certificates data shall have the following
attributes:
+----------------------+------------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+---------+ | File size: Y bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 to Y | Key/Certificate Data | M | Y bytes | +----------------------+------------------------+----------+---------+
Contents and coding:
> Key/certificate data are accessed using the key/certificates descriptors
> provided by EF~TPRPK~ (see clause 4.4.4.4).
The identifier \'4FXX\' shall be different from one key/certificate data file
to another. For the range of \'XX\', see TS 31.101 [11]. The length Y may be
different from one key/certificate data file to another.
### 4.4.5 Contents of files at the DF WLAN level
This clause describes the additional files that are used for WLAN purposes.
DF~WLAN~ shall be present at the ADF~USIM~ level if either of the services
nº59, nº60, nº61, nº62, nº63, nº66, n°81, n°82, n°83, n°84 or n°88 are
\"available\" in the corresponding EF~UST~ (USIM Service Table).
#### 4.4.5.1 EF~Pseudo~ (Pseudonym)
If service n°59 is \"available\", this file shall be present.
This EF contains a temporary user identifier (pseudonym) for subscriber
identification. Pseudonyms may be provided as part of a previous
authentication sequence. Pseudonyms are used as defined in TS 24.234 [40].
+----------------------------+------------------------+----------+---------+ | Identifier: \'4F41\' | Structure: Transparent | Optional | | +----------------------------+------------------------+----------+---------+ | SFI : \'01\' | | | | +----------------------------+------------------------+----------+---------+ | File size: Y bytes (Y≥n+2) | Update activity: high | | | +----------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------------+------------------------+----------+---------+ | 1 to 2 | Pseudonym Length | M | 2 bytes | +----------------------------+------------------------+----------+---------+ | 3 to n+2 | Pseudonym | M | n bytes | +----------------------------+------------------------+----------+---------+
-Pseudonym Length
Contents:\ \- these bytes give the number of bytes of the following data item
containing the Pseudonym value.
Coding:\ \- unsigned length coded on 2 bytes
\- Pseudonym.
> Contents:
-Pseudonym to be used as the username part of the NAI
> Coding:
>
> \- As described for the user portion of the NAI in TS 33.234 [41]. Unused
> bytes shall be set to \'FF\' and shall not be considered as a part of the
> value.
#### 4.4.5.2 EF~UPLMNWLAN~ (User controlled PLMN selector for I-WLAN Access)
If service n°60 is \"available\", this file shall be present.
This EF contains the coding for preferred PLMNs to be used for WLAN PLMN
Selection. This information is determined by the user and defines the
preferred PLMNs of the user in priority order. The first PLMN entry indicates
the highest priority and the n^th^ PLMN entry indicates the lowest. It shall
be possible to store at least the number of PLMNs specified in TS 24.234 [40].
+-----------------------------+-------------------------------+----------+---------+ | Identifier: \'4F42\' | Structure: transparent | Optional | | +-----------------------------+-------------------------------+----------+---------+ | SFI: \'02\' | | | | +-----------------------------+-------------------------------+----------+---------+ | File size: 3n (where n ≥10) | Update activity: low | | | +-----------------------------+-------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+-------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-----------------------------+-------------------------------+----------+---------+ | 1 to 3 | 1^st^ PLMN (highest priority) | M | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | 4 to 6 | 2^nd^ PLMN | M | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | : | : | | | +-----------------------------+-------------------------------+----------+---------+ | 28 to 30 | 10^th^ PLMN | M | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | 31 to 33 | 11^th^ PLMN | O | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | : | : | | | +-----------------------------+-------------------------------+----------+---------+ | (3n-2) to 3n | N^th^ PLMN (lowest priority) | O | 3 bytes | +-----------------------------+-------------------------------+----------+---------+
‑ PLMN
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- according to TS 24.008 [9].
#### 4.4.5.3 EF~OPLMNWLAN~ (Operator controlled PLMN selector for I-WLAN
Access)
If service n°61 is \"available\", this file shall be present.
This EF contains the coding for operator preferred PLMNs to be used for WLAN
PLMN Selection. This information is determined by the operator and defines the
operator preferred PLMNs in priority order. The first PLMN entry indicates the
highest priority and the n^th^ PLMN entry indicates the lowest. It shall be
possible to store at least the number of PLMNs specified in TS 24.234 [40].
+-----------------------------+-------------------------------+----------+---------+ | Identifier: \'4F43\' | Structure: transparent | Optional | | +-----------------------------+-------------------------------+----------+---------+ | SFI: \'03\' | | | | +-----------------------------+-------------------------------+----------+---------+ | File size: 3n (where n ≥10) | Update activity: low | | | +-----------------------------+-------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+-------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-----------------------------+-------------------------------+----------+---------+ | 1 to 3 | 1^st^ PLMN (highest priority) | M | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | 4 to 6 | 2^nd^ PLMN | M | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | : | : | | | +-----------------------------+-------------------------------+----------+---------+ | 28 to 30 | 10^th^ PLMN | M | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | 31 to 33 | 11^th^ PLMN | O | 3 bytes | +-----------------------------+-------------------------------+----------+---------+ | : | : | | | +-----------------------------+-------------------------------+----------+---------+ | (3n-2) to 3n | N^th^ PLMN (lowest priority) | O | 3 bytes | +-----------------------------+-------------------------------+----------+---------+
‑ PLMN
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- according to TS 24.008 [9].
#### 4.4.5.4 EF~UWSIDL~ (User controlled WLAN Specific Identifier List)
If service n°62 is \"available\", this file shall be present.
This file contains the user preferred list of WLAN specific identifier (WSID)
for WLAN selection in priority order. The first record indicates the highest
priority and the n^th^ record indicates the lowest. This file is used for WLAN
selection and shall store a list of at least the number of WSIDs specified in
TS 24.234 [40].
+------------------------+-------------------------+----------+---------+ | Identifier: \'4F44\' | Structure: linear fixed | Optional | | +------------------------+-------------------------+----------+---------+ | SFI: \'04\' | | | | +------------------------+-------------------------+----------+---------+ | Record size: X+1 bytes | Update activity: low | | | +------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+-------------------------+----------+---------+ | 1 | Length of WSID | M | 1 bytes | +------------------------+-------------------------+----------+---------+ | 2 to X + 1 | WSID | M | X bytes | +------------------------+-------------------------+----------+---------+
-Length of WSID
Contents:\ \- this byte gives the number of bytes of the following data item
containing the WSID.
Coding:\ \- unsigned length coded on one byte
-WSID
Contents:\ \- WLAN specific identifier (WSID) as defined in TS 24.234 [40].
Coding:
\- binary. Unused bytes shall be set to \'FF\' and not used either as a part
of the value or for length calculation.
#### 4.4.5.5 EF~OWSIDL~ (Operator controlled WLAN Specific IdentifierList)
If service n°63 is \"available\", this file shall be present.
This file contains the operator preferred list of WLAN specific identifier
(WSID) for WLAN selection in priority order. The first record indicates the
highest priority and the n^th^ record indicates the lowest. This file is used
for WLAN selection It shall be possible to store at least the number of PLMNs
specified in TS 24.234 [40].
+--------------------------+-------------------------+----------+---------+ | Identifier: \'4F45\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+---------+ | SFI: \'05\' | | | | +--------------------------+-------------------------+----------+---------+ | Record size: X + 1 bytes | Update activity: low | | | +--------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+---------+ | 1 | Length of WSID | M | 1 bytes | +--------------------------+-------------------------+----------+---------+ | 2 to X + 1 | WSID | M | X bytes | +--------------------------+-------------------------+----------+---------+
-Length of WSID
Contents:\ \- this byte gives the number of bytes of the following data item
containing the WSID.
Coding:\ \- unsigned length coded on one byte
-WSID
Contents:\ \- WLAN specific identifier (WSID) as defined in TS 24.234 [40].
Coding:
\- binary. Unused bytes shall be set to \'FF\' and not used either as a part
of the value or for length calculation.
#### 4.4.5.6 EF~WRI~ (WLAN Reauthentication Identity)
If service n°66 is \"available\", this file shall be present.
This EF contains a list of parameters linked to a re-authentication identity
to be used in fast re-authentication. Re-authentication identities and related
parameters (Master Key and Counter Value) are provided as part of a previous
authentication sequence.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F46\' | Structure: | Optional | | | | Transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'06\' | | | | +----------------------+----------------------+----------+---------+ | File size: n bytes, | Update activity: | | | | (n ≥ J+K+L+6) | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Reauthentication | M | 1 byte | | | Identity Tag \'80\' | | | +----------------------+----------------------+----------+---------+ | 2 | Re-authentication | M | 1 byte | | | Identity Length | | | +----------------------+----------------------+----------+---------+ | 3 to J+2 | Re-authentication | M | J bytes | | | Identity Value | | | +----------------------+----------------------+----------+---------+ | J+3 | Master Key Tag | M | 1 byte | | | \'81\' | | | +----------------------+----------------------+----------+---------+ | J+4 | Master Key Length | M | 1 byte | +----------------------+----------------------+----------+---------+ | J+5 to J+K+4 | Master Key Value | M | K bytes | +----------------------+----------------------+----------+---------+ | J+K+5 | Counter Tag \'82\' | M | 1 byte | +----------------------+----------------------+----------+---------+ | J+K+6 | Counter Length | M | 1 byte | +----------------------+----------------------+----------+---------+ | J+K+7 to J+K+L+6 | Counter Value | M | L bytes | +----------------------+----------------------+----------+---------+
\- Reauthentication Identity
Contents:\ \- Re-authentication identity TLV to be used as the username part
of the NAI.
Coding:\ Tag \'80\'\ Unsigned length on 1 byte\ Value: As described for the
user portion of the NAI in TS 33.234 [41]. Unused bytes shall be set to \'FF\'
and shall not be considered as a part of the value.
\- Master Key
Contents:\ \- Master Key TLV.
Coding:\ Tag \'81\'\ Unsigned length on 1 byte\ Value: As described in TS
33.234 [41].
\- Counter
Contents:\ \- Counter TLV
Coding:\ Tag \'82\'\ Unsigned length on 1 byte\ Value: As described in TS
33.234 [41].
#### 4.4.5.7 EF~HWSIDL~ (Home I-WLAN Specific Identifier List)
If service n°81 is \"available\", this file shall be present.
This file contains the Home I-WLAN specific identifier list (WSID list) for
I-WLAN selection in priority order. The WSIDs in this list are known to
connect to the HPLMN. The first record indicates the highest priority and the
n^th^ record indicates the lowest. This file is used for I-WLAN selection. It
shall be possible to store at least the number of WSIDs specified in TS 24.234
[40].
+--------------------------+-------------------------+----------+---------+ | Identifier: \'4F47\' | Structure: linear fixed | Optional | | +--------------------------+-------------------------+----------+---------+ | SFI: \'07\' | | | | +--------------------------+-------------------------+----------+---------+ | Record size: X + 1 bytes | Update activity: low | | | +--------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+-------------------------+----------+---------+ | 1 | Length of WSID | M | 1 bytes | +--------------------------+-------------------------+----------+---------+ | 2 to X + 1 | WSID | M | X bytes | +--------------------------+-------------------------+----------+---------+
For contents and coding see EF~OWSIDL~.
#### 4.4.5.8 EF~WEHPLMNPI~ (I-WLAN Equivalent HPLMN Presentation Indication)
If service n°82 is \"available\", this file shall be present.
This EF contains an indication to the ME for the presentation of the available
EHPLMN(s) during I-WLAN selection procedures. The usage of the I-WLAN EHPLMN
presentation indication is defined in TS 24.234 [40].
+----------------------+---------------------------------------+----------+--------+ | Identifier: \'4F48\' | Structure: transparent | Optional | | +----------------------+---------------------------------------+----------+--------+ | SFI: \'08\' | | | | +----------------------+---------------------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+---------------------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------------------+----------+--------+ | 1 | I-WLAN EHPLMN Presentation Indication | M | 1 byte | +----------------------+---------------------------------------+----------+--------+
\- I-WLAN EHPLMN Presentation Indication:
> Contents:
I-WLAN EHPLMN display mode
> Coding:
\- \'00\' - No preference for the display mode
\- \'01\' - Display the highest-priority available EHPLMN only
\- \'02\' - Display all the available EHPLMNs
\- All other values are RFU
#### 4.4.5.9 EF~WHPI~ (I-WLAN HPLMN Priority Indication)
If service n°83 is \"available\", this file shall be present.
This EF contains an indication to the ME for the selection of the I-WLAN
EHPLMN or the I-WLAN last Registered PLMN. The usage of the I-WLAN HPLMN
Priority Indication file is defined in TS 24.234 [40].
+----------------------+----------------------------------------+----------+--------+ | Identifier: \'4F49\' | Structure: transparent | Optional | | +----------------------+----------------------------------------+----------+--------+ | SFI: \'09\' | | | | +----------------------+----------------------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+----------------------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+----------------------------------------+----------+--------+ | 1 | I-WLAN Last RPLMN Selection Indication | M | 1 byte | +----------------------+----------------------------------------+----------+--------+
\- I-WLAN Last RPLMN Selection Indication:
> Contents:
I-WLAN Last RPLMN Selection Indication
> Coding:
\- \'00\' - The UE shall attempt registration on the last I-WLAN RPLMN as
described in TS 24.234 [40]
\- \'01\' - The UE shall attempt registration on the I-WLAN home network as
described in TS 24.234 [40]
\- All other values are RFU
#### 4.4.5.10 EF~WLRPLMN~ (I-WLAN Last Registered PLMN)
If service n°84 is \"available\", this file shall be present.
This EF contains I-WLAN Last Registered PLMN Selection. The usage of the
I-WLAN Last Registered PLMN is defined in TS 24.234 [40].
+----------------------+-----------------------------+----------+---------+ | Identifier: \'4F4A\' | Structure: transparent | Optional | | +----------------------+-----------------------------+----------+---------+ | SFI: \'0A\' | | | | +----------------------+-----------------------------+----------+---------+ | File size: 3 bytes | Update activity: low | | | +----------------------+-----------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-----------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-----------------------------+----------+---------+ | 1 to 3 | I-WLAN Last Registered PLMN | M | 3 bytes | +----------------------+-----------------------------+----------+---------+
‑ I-WLAN Last Registered PLMN
> Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
> Coding:
\- according to TS 24.008 [9].
#### 4.4.5.11 EF~HPLMNDAI~ (HPLMN Direct Access Indicator)
If service n°88 is \"available\", this file shall be present.
This EF contains HPLMN Direct Access related informations. The usage of the
HPLMN Direct Access Indicator file is defined in TS 24.234 [40].
+----------------------+--------------------------------+----------+--------+ | Identifier: \'4F4B\' | Structure: transparent | Optional | | +----------------------+--------------------------------+----------+--------+ | SFI: \'0B\' | | | | +----------------------+--------------------------------+----------+--------+ | File size: 1 byte | Update activity: low | | | +----------------------+--------------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------------+----------+--------+ | 1 | HPLMN Direct Access Indication | M | 1byte | +----------------------+--------------------------------+----------+--------+
\- HPLMN Direct Access Indication:
> Contents:
HPLMN Direct Access Indication
> Coding:
\- \'00\' -- HPLMN Direct Access Indicator is disabled
\- \'01\' -- HPLMN Direct Access Indicator is enabled
\- All other values are RFU
### 4.4.6 Contents of files at the DF HNB level
#### 4.4.6.1 Introduction
This clause describes the additional files that are used for Home (e)NodeB
purposes.
DF~HNB~ shall be present at the ADF~USIM~ level if service nº86 and/or service
nº90 isare \"available\" in EF~UST~ .
#### 4.4.6.2 EF~ACSGL~ (Allowed CSG Lists)
If service n°86 is \"available\", this file shall be present.
This EF contains the coding for CSG ID belonging to the Allowed CSG lists.
Furthermore, for each CSG ID in the list, a link to the corresponding HNB name
and CSG Type may be provided.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F81\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'01\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | CSG Lists TLV object | M | X bytes | +----------------------+----------------------+----------+---------+ | Note: The CSG List | | | | | in different records | | | | | may contain the same | | | | | PLMN | | | | +----------------------+----------------------+----------+---------+
The CSG List TLV object shall contain only one PLMN TLV object, Tag \'80\',
and at least one CSG information TLV, Tag \'81\'. A record may contain one or
more CSG List TLV objects. This means that all CSG Ids in one CSG List TLV
object belong to the same PLMN.
CSG List Tags
* * *
**Description** **Tag Value** CSG List TLV object Tag \'A0\'
* * *
CSG List information
* * *
Description Value M/O Length (bytes) CSG List Tag \'A0\' M 1 Length Y M Note
PLMN Tag \'80\' M 1 Length A M Note PLMN -- M A CSG Information Tag \'81\' M 1
Length W M Note CSG Information - M W Note: The length is coded according to
ISO/IEC 8825-1 [35]
* * *
\- PLMN Tag \'80\'
Contents:
Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
according to TS 24.008 [9].
> CSG Information Tag \'81\'
.
Tag \'81\' Coding:
* * *
1 CSG Type indication M 1 byte 2 HNB Name indication M 1 byte 3 to W CSG ID M
W-2 bytes Note: The length of the CSG ID is calculated from the TLV object
length
* * *
\- CSG Type indication
Contents:
the CSG Type for the subsequent CSG ID.
Coding:
> a value of \'00\' indicates that the CSG Type is to be taken from other
> sources (e.g. stored in the non-volatile memory of the ME). A value in the
> range \'01\' to \'FE\' indicates the record number in EF~CSGT~ that shall be
> displayed as the CSG Type.
\- HNB Name indication
Contents:
the HNB name for the subsequent CSG ID.
Coding:
> a value of \'00\' indicates that the HNB name is to be taken from other
> sources (e.g. broadcasted by the Home Node B or stored in the non-volatile
> memory of the ME). A value in the range \'01\' to \'FE\' indicates the
> record number in EF~HNBN~ that shall be displayed as the HNB name.
\- CSG ID
Contents:
CSG ID which is part of the allowed CSG list.
Coding:
> the CSG ID shall be encoded as defined in TS 23.003 [25]. The CSG ID is
> coded left justified, i.e. the most significant bit of the CSG ID is coded
> on bit 8 of byte 3, over the number of bits as specified in TS 23.003 [25]
> using bytes 3 to W . The unused rightmost bits of byte W shall be set 1.
Unused bytes shall be set to \'FF\'.
#### 4.4.6.3 EF~CSGT~ (CSG Type)
If service n°86 is \"available\", this file shall be present.
This EF contains the CSG Type. The CSG Type is defined in TS 22.220 [54]. The
association between a CSG ID and the corresponding CSG Type is provided in
EF~ACSGL~. The CSG Type may be provided in text or in graphic format.
+------------------------+-------------------------+----------+---------+ | Identifier: \'4F82\' | Structure: linear fixed | Optional | | +------------------------+-------------------------+----------+---------+ | SFI: \'02\' | | | | +------------------------+-------------------------+----------+---------+ | Record length: X bytes | Update activity: low | | | +------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+-------------------------+----------+---------+ | 1 to X | CSG Type TLV objects | M | X bytes | +------------------------+-------------------------+----------+---------+
CSG Type tags
* * *
Description Tag Value Text CSG Type Tag \'89\' Graphics CSG Type Tag \'80\' or
\'81\'
* * *
CSG Type information
Contents:
CSG Type contains either Text CSG Type or Graphic CSG Type or both the Graphic
and Text CSG Types
Coding:
Text CSG Type:
* * *
Description Value M/O Length (bytes) Text CSG Type Tag \'89\' M 1 Length K M
Note Text CSG Type -- M K Note: The length is coded according to ISO/IEC
8825-1 [35].
* * *
Graphic CSG Type:
+-------------------+------------------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------+------------------+-----+----------------+ | Graphic CSG Type | \'80\' or \'81\' | M | 1 | | Tag | | | | +-------------------+------------------+-----+----------------+ | Length | K + 1 | M | Note 1 | +-------------------+------------------+-----+----------------+ | Graphic CSG Type | -- | M | 1 | | Icon Qualifier | | | | +-------------------+------------------+-----+----------------+ | Graphic CSG Type | -- | M | K (Note 2) | | Icon Link | | | | +-------------------+------------------+-----+----------------+ | Note 1: The | | | | | length is coded | | | | | according to | | | | | ISO/I | | | | | EC 8825-1 [35]. | | | | | | | | | | Note 2: The tag | | | | | value indicates | | | | | the type and | | | | | format of the | | | | | Icon Link that is | | | | | provided in the | | | | | TLV value field | | | | | (e.g. Tag \'80\' | | | | | indicates that | | | | | the Icon link is | | | | | a URI, while Tag | | | | | \'81\' indicates | | | | | that the Icon | | | | | Link is the | | | | | record number of | | | | | the corresponding | | | | | image in | | | | | EF~IMG~). | | | | +-------------------+------------------+-----+----------------+
\- Text CSG Type Tag \'89\'
Contents:
Tag value for the CSG Type in text format.
Coding:
\- \'89\' = the Text CSG Type is coded using one of the UCS2 code options as
defined in TS 31.101 [11].
\- Graphic CSG Type Tag
Contents:
Tag value for the CSG Type in graphic format with the Icon Qualifier or an
Icon Link
Coding:
\- \'80\' = the Graphic CSG Type Icon Link is an URI
> \- \'81\' = the Graphic CSG Type Icon Link is a pointer to the record number
> of the corresponding image in EF~IMG~,
>
> \- All other values are RFU.
\- Graphic CSG Type Icon Qualifier
Contents:
The icon qualifier indicates to the ME how the icon shall be used.
Coding:
\- \'01\' = icon is self-explanatory, i.e. if displayed, it replaces the
corresponding name in text format.
\- \'02\' = icon is not self-explanatory, i.e. if displayed, it shall be
displayed together with the corresponding name in text format.
> \- All other values are RFU.
‑ Graphic CSG Type Icon Link
Contents:
Link to the icon. This link shall point to a UICC resource.
Coding:
> \- When the Tag value indicates an URI (i.e. Tag = \'80\') , the Icon Link
> shall be encoded to an octet string according to UTF-8 encoding rules as
> described in IETF RFC 3629 [48] (e.g.
> http://127.0.0.1:3516/pub/files/csgtype.jpg).
>
> \- When the Tag value indicates that the Icon Link contains the record
> number of the corresponding image in EF~IMG~ (i.e. Tag = \'81\'), the Icon
> Link shall be encoded in binary.
Unused bytes shall be set to \'FF\'.
#### 4.4.6.4 EF~HNBN~ (Home NodeB Name)
If service n°86 is \"available\", this file shall be present.
This EF contains the HNB name. The HNB name is defined in TS 22.220 [54]. HNB
name is a common name referring to HNB/HeNB. The association between a CSG ID
and the corresponding HNB name is provided in EF~ACSGL~.
+-------------------------------+-------------------------+----------+---------+ | Identifier: \'4F83\' | Structure: linear fixed | Optional | | +-------------------------------+-------------------------+----------+---------+ | SFI: \'03\' | | | | +-------------------------------+-------------------------+----------+---------+ | Record length: X bytes; X ≥ 3 | Update activity: low | | | +-------------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +-------------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-------------------------------+-------------------------+----------+---------+ | 1 to X | HNB Name TLV object | M | X bytes | +-------------------------------+-------------------------+----------+---------+
HNB Name tags
* * *
Description Tag Value HNB Name Tag \'80\'
* * *
HNB Name information
* * *
Description Value M/O Length (bytes) HNB Name Tag \'80\' M 1 Length K M Note
HNB Name -- M K Note 1: The length is coded according to ISO/IEC 8825-1 [35].
* * *
\- HNB Name Tag \'80\'
Contents:
name of the HNB or HeNB.
Coding:
coded using one of the UCS2 code options as defined in TS 31.101 [11].
Unused bytes shall be set to \'FF\'.
#### 4.4.6.5 EF~OCSGL~ (Operator CSG Lists)
If service n°90 is \"available\", this file shall be present.
This EF contains the coding for CSG Ids belonging to the Operator CSG lists.
Furthermore, for each CSG ID in the list, a link to the corresponding HNB name
and CSG type may be provided. Within one PLMN the first occurrence of CSG ID
indicates the highest priority CSG ID and the last occurrence indicates the
lowest.
NOTE 1: There is no requirement for the ME to take the priority into account.
Additionally, if service n°92 is \"available\", this EF allows the HPLMN to
control, on a per PLMN basis, which available CSGs are displayed by the ME
during a manual CSG selection. If there is no CSG display indicator for a
PLMN, the ME shall display the available CSGs according to the value in EF~AD~
byte 3 bit 2.
NOTE 2: Operators should ensure that all CSG display indicators have the same
value if the same PLMN is used in multiple CSG List TLV objects.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F84\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'04\' | | | | +----------------------+----------------------+----------+---------+ | Record length: Y | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | Operator CSG List | M | X bytes | | | TLV objects | | | +----------------------+----------------------+----------+---------+ | Note: The CSG List | | | | | in different records | | | | | may contain the same | | | | | PLMN | | | | +----------------------+----------------------+----------+---------+
The Operator CSG List TLV object shall contain only one PLMN TLV object, Tag
\'80\', and at least one Operator CSG information TLV, Tag \'81\'. A record
may contain one or more Operator CSG List TLV objects. This means that all CSG
Ids in one Operator CSG List TLV object belong to the same PLMN.
Additionally, the Operator CSG List TLV object may contain one CSG Display
Indicator TLV object, if service n°92 is available.
CSG List Tags
* * *
**Description** **Tag Value** Operator CSG List TLV object Tag \'A0\'
* * *
CSG List information
* * *
Description Value M/O Length (bytes) CSG List Tag \'A0\' M 1 Length Y M Note
PLMN Tag \'80\' M 1 Length A M Note PLMN -- M A CSG Information Tag \'81\' M 1
Length W M Note CSG Information - M W CSG Display indicator tag \'82\' O 1
Length Z O Note CSG Display indicator - O Z Note: The length is coded
according to ISO/IEC 8825-1 [35]
* * *
\- PLMN Tag \'80\'
Contents:
Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
according to TS 24.008 [9].
\- CSG Information Tag \'81\'
Tag \'81\' Coding:
* * *
1 CSG Type indication M 1 byte 2 HNB Name indication M 1 byte 3 to W CSG ID M
W-2 bytes Note: The length of the CSG ID is calculated from the TLV object
length
* * *
> \- CSG Type indication
>
> Contents:
>
> the CSG Type for the subsequent CSG ID.
>
> Coding:
>
> a value of \'00\' indicates that the CSG Type is to be taken from other
> sources (e.g. stored in the non-volatile memory of the ME). A value in the
> range \'01\' to \'FE\' indicates the record number in EF~CSGT~ that shall be
> displayed as the CSG Type.
>
> \- HNB Name indication
>
> Contents:
>
> the HNB name for the subsequent CSG ID.
>
> Coding:
>
> a value of \'00\' indicates that the HNB name is to be taken from other
> sources (e.g. broadcasted by the Home Node B or stored in the non-volatile
> memory of the ME). A value in the range \'01\' to \'FE\' indicates the
> record number in EF~HNBN~ that shall be displayed as the HNB name.
>
> \- CSG ID
>
> Contents:
>
> CSG ID which is part of the allowed CSG list.
>
> Coding:
>
> the CSG ID shall be encoded as defined in TS 23.003 [25]. The CSG ID is
> coded left justified, i.e. the most significant bit of the CSG ID is coded
> on bit 8 of byte 3, over the number of bits as specified in TS 23.003 [25]
> using bytes 3 to W. The unused rightmost bits of byte W shall be set 1.
>
> \- CSG display indicator Tag \'82\':
>
> Coding:
>
> \- \'00\' All available CSG Ids can be displayed during a manual CSG
> selection
>
> \- \'01\' Only CSG Ids contained in Operator CSG lists shall be displayed
> during a manual CSG selection
Unused bytes shall be set to \'FF\'
#### 4.4.6.6 EF~OCSGT~ (Operator CSG Type)
If service n°90 is \"available\", this file shall be present.
This EF contains the Operator CSG Types. The CSG Type is defined in TS 22.220
[54]. The association between an Operator CSG ID and the corresponding
Operator CSG Type is provided in EF~OCSGL~. The Operator CSG Type may be
provided in text or in graphic format.
+------------------------+-------------------------+----------+---------+ | Identifier: \'4F85\' | Structure: linear fixed | Optional | | +------------------------+-------------------------+----------+---------+ | SFI: \'05\' | | | | +------------------------+-------------------------+----------+---------+ | Record length: X bytes | Update activity: low | | | +------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +------------------------+-------------------------+----------+---------+ | 1 to X | CSG Type TLV objects | M | X bytes | +------------------------+-------------------------+----------+---------+
For coding see EF~CSGT~
#### 4.4.6.7 EF~OHNBN~ (Operator Home NodeB Name)
If service n°90 is \"available\", this file shall be present.
This EF contains the Operator HNB names. The HNB name is defined in TS 22.220
[54]. HNB Name is a common name referring to HNB/HeNB. The association between
an Operator CSG ID and the corresponding Operator HNB name is provided in
EF~OCSGL~.
+-------------------------------+-------------------------+----------+---------+ | Identifier: \'4F86\' | Structure: linear fixed | Optional | | +-------------------------------+-------------------------+----------+---------+ | SFI: \'06\' | | | | +-------------------------------+-------------------------+----------+---------+ | Record length: X bytes; X ≥ 3 | Update activity: low | | | +-------------------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +-------------------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +-------------------------------+-------------------------+----------+---------+ | 1 to X | HNB Name TLV object | M | X bytes | +-------------------------------+-------------------------+----------+---------+
For coding see EF~HNBN~
### 4.4.7 Void
### 4.4.8 Contents of files at the DF ProSe level
#### 4.4.8.1 Introduction
This clause describes the additional files that are used for ProSe purposes.
DF~ProSe~ shall be present at the ADF~USIM~ level if service nº101 is
\"available\" in EF~UST~ .
#### 4.4.8.2 EF~PROSE_MON~ (ProSe Monitoring Parameters)
If service n°1 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the authorized PLMNs for restricted ProSe direct discovery
for public safety as described in TS 24.334 [70]. This file shall be used only
if the ME is authorized as per content of EF~AD~ or received service
authorization from the ProSe Function.
Each record shall be associated with a different PLMN.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F01\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'01\' | | | | +----------------------+----------------------+----------+---------+ | Record size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ProSe Discovery | O | Z bytes | | | monitoring | | | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
ProSe Discovery monitoring parameters information
* * *
Description Value M/O/C Length (bytes) ProSe Discovery monitoring parameters
TLV \'A0\' M 1 Length X M Note PLMN Tag \'80\' M 1 Length L1 M Note PLMN value
-- M L1 Model Tag \'82\' O 1 Length 1 C 1 Model value -- C 1 Note: The length
is coded according to ISO/IEC 8825-1 [35]
* * *
\- PLMN
Contents:
> As described in TS 24.333 [71], the PLMN code of the operator in which the
> UE is authorised to use ProSe direct discovery monitoring.
Coding:
> As defined for the \/MonitoringPolicy/\/PLMN leaf in TS 24.333 [71].
\- Model
Contents:
> Model used for the ProSe direct discovery, as described in TS 24.334 [70].
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 indicates if the UE is authorised for Restricted Model A monitoring policy
                                                b2 indicates if the UE is authorised for Restricted Model B discoveree policy.
                                                RFU (see TS 31.101 \[11\])
* * *
> If the data object is missing, the UE shall behave as if only Restricted
> Model A monitoring policy is allowed. All other values are reserved.
Unused bytes shall be set to \'FF\'.
#### 4.4.8.3 EF~PROSE_ANN~ (ProSe Announcing Parameters)
If service n°1 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the authorized PLMNs for restricted ProSe direct discovery
for public safety, as described in TS 24.334 [70]. This file shall be used
only if the ME is authorized as per content of EF~AD~ or received service
authorization from the ProSe Function.
Each record shall be associated with a different PLMN.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F02\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'02\' | | | | +----------------------+----------------------+----------+---------+ | Record size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ProSe Discovery | O | Z bytes | | | announcing | | | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
ProSe Discovery announcing parameters information
+------------------------+--------+-------+----------------+ | Description | Value | M/O/C | Length (bytes) | +------------------------+--------+-------+----------------+ | ProSe Discovery | \'A0\' | M | 1 | | announcing parameters | | | | | TLV | | | | +------------------------+--------+-------+----------------+ | Length | X | M | Note 1 | +------------------------+--------+-------+----------------+ | PLMN Tag | \'80\' | M | 1 | +------------------------+--------+-------+----------------+ | Length | L1 | M | Note 1 | +------------------------+--------+-------+----------------+ | PLMN value | -- | M | L1 | +------------------------+--------+-------+----------------+ | Range Tag (Note 3) | \'81\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | L2 | C | Note 1 | +------------------------+--------+-------+----------------+ | Range value | -- | C | L2 | +------------------------+--------+-------+----------------+ | Model Tag | \'82\' | O | 1 | +------------------------+--------+-------+----------------+ | Length | 1 | C | 1 | +------------------------+--------+-------+----------------+ | Model value | -- | C | 1 | +------------------------+--------+-------+----------------+ | Note 1 : The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35] | | | | | | | | | | Note 2: C; if the Tag | | | | | is present, this is | | | | | mandatory. | | | | | | | | | | Note 3: The Range data | | | | | object is obsolete | | | | | from Rel-13 onwards | | | | | and shall be ignored | | | | | if present. | | | | +------------------------+--------+-------+----------------+
\- PLMN
Contents:
> As described in TS 24.333 [71], the PLMN code of the operator in which the
> UE is authorised to use ProSe direct discovery announcing.
Coding:
> As defined for the \/AnnouncingPolicy/\/PLMN leaf in TS 24.333 [71].
\- Model
Contents:
> Model used for the ProSe direct discovery, as described in TS 24.334 [70].
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 indicates if the UE is authorised for Restricted Model A announcing policy
                                                b2 indicates if the UE is authorised for Restricted Model B discoverer policy.
                                                RFU (see TS 31.101 \[11\])
* * *
> If the data object is missing, the UE shall behave as if only Restricted
> Model A announcing policy is allowed. All other values are reserved.
Unused bytes shall be set to \'FF\'.
#### 4.4.8.4 EF~PROSEFUNC~ (HPLMN ProSe Function)
If service n°2 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the IP address of the HPLMN ProSe Function.
NOTE: only usage of the first record is supported in the current release of
the specification.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F03\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'03\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | HPLMN ProSe Function | M | Z bytes | | | Address TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
HPLMN ProSe Function information
* * *
Description Value M/O Length (bytes) HPLMN ProSe Function Tag \'80\' M 1
Length A + 1 M 1 Address type -- M 1 HPLMN ProSe Function Address -- M A
* * *
\- Address type
Contents:
Type of the HPLMN ProSe Function address.
Coding:
> A value of \'00\' indicates FQDN, a value of \'01\' indicates IPv4, a value
> of \'02\' indicates IPv6. All other values are reserved.
\- HPLMN ProSe Function Address
Contents:
Address of the HPLMN ProSe function.
Coding:
> Depending on the Address type. When the HPLMN ProSe Function type is set to
> \'00\', the corresponding HPLMN ProSe Function Address shall be encoded to
> an octet string according to UTF-8 encoding rules as specified in IETF RFC
> 3629 [48].
Unused bytes shall be set to \'FF\'.
#### 4.4.8.5 EF~PROSE_RADIO_COM~ (ProSe Direct Communication Radio Parameters)
If service n°3 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the radio paramenters to be used for ProSe direct
communication for public safety when the UE is not served by E-UTRAN, as
described in TS 24.334 [70]. This file shall be used only if the ME is
authorized as per content of EF~AD~ or received service authorization from the
ProSe Function.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F04\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+=========+ | SFI: \'04\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | ProSe Direct | M | 1 byte | | | Communication not | | | | | served by E-UTRAN | | | +----------------------+----------------------+----------+---------+ | 2 to Z + 1 | ProSe Radio | M | Z bytes | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
The file may contain one or more ProSe Radio parameters TLV data objects.
ProSe Direct Communication not served by E-UTRAN:
Contents:
> Indicates if the ME is authorized to perform ProSe Direct Communication
> and/or one-to-one ProSe direct communication when not served by E-UTRAN.
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0 indicates that the UE is not authorised to perform one-to-many ProSe direct communication when not served by E-UTRAN b1=1 indicates that UE is authorised to perform one-to-many ProSe direct communication when not served by E-UTRAN  
|  |  |  |  |  |  |  |  |  | b2=0 indicates that the UE is not authorised to perform one-to-one ProSe direct communication when not served by E-UTRAN b2=1 indicates that the UE is authorised to perform one-to-one ProSe direct communication when not served by E-UTRAN.  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
ProSe Radio parameters information:
+------------------------+--------+-------+----------------+ | Description | Value | M/O/C | Length (bytes) | +------------------------+--------+-------+----------------+ | ProSe Direct | \'A0\' | M | 1 | | Communication | | | | | parameters TLV | | | | +------------------------+--------+-------+----------------+ | Length | X | M | Note 1 | +------------------------+--------+-------+----------------+ | Geographical Area -- | \'80\' | M | 1 | | Polygon Tag | | | | +------------------------+--------+-------+----------------+ | Length | L1 | M | Note 1 | +------------------------+--------+-------+----------------+ | Geographical Area -- | -- | M | L1 | | Polygon value | | | | +------------------------+--------+-------+----------------+ | Radio parameters Tag | \'81\' | M | 1 | +------------------------+--------+-------+----------------+ | Length | L2 | M | Note 1 | +------------------------+--------+-------+----------------+ | Radio parameters value | -- | M | L2 | +------------------------+--------+-------+----------------+ | Note 1 : The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35] | | | | | | | | | | Note 2: C; if the Tag | | | | | is present, this is | | | | | mandatory. | | | | +------------------------+--------+-------+----------------+
Each ProSe Radio parameters TLV data object shall contain one or more
Geographical Area objects and one Radio parameters object.
\- Geographical Area -- Polygon Tag \'80\'
Contents:
> A geographical area defined by a polygon with 3 or more points.
Coding:
* * *
1 to 3 Latitude of point 1 M 3 bytes 4 to 6 Longitude of point 1 M 3 bytes 7
to 9 Latitude of point 2 M 3 bytes 10 to 12 Longitude of point 2 M 3 bytes 13
to 15 Latitude of point 3 M 3 bytes 16 to 18 Longitude of point 3 M 3 bytes :
: : : (6n-5) to 6n-3 Latitude of point n M 3 bytes (6n-2) to 6n Longitude of
point n M 3 bytes Latitude and longitude are coded as defined in clause 6.1 of
3GPP TS 23.032 [75].
* * *
NOTE: The upper limit of 15 specified in 3GPP TS 23.032 [9] for the number of
points in a polygon shape does not apply to the number of coordinates in a
geographical area described as a polygon for ProSe communications.
\- Radio parameters Tag \'81\'
Contents:
> The radio parameters used for ProSe Direct Communication
Coding:
> Coded as _SL-Preconfiguration_ in 3GPP TS 36.331 [74].
#### 4.4.8.6 EF~PROSE_RADIO_MON~ (ProSe Direct Discovery Monitoring Radio
Parameters)
If service n°4 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the radio paramenters to be used for ProSe direct
communication for public safety when the UE is not served by E-UTRAN, as
described in TS 24.334 [70]. This file shall be used only if the ME is
authorized as per content of EF~AD~ or received service authorization from the
ProSe Function.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F05\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+=========+ | SFI: \'05\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | ProSe Direct | M | 1 byte | | | Discovery Monitoring | | | | | not served by | | | | | E-UTRAN | | | +----------------------+----------------------+----------+---------+ | 2 to Z + 1 | ProSe Radio | M | Z bytes | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
ProSe Direct Discovery monitoring not served by E-UTRAN:
Contents:
> Indicates if the ME is authorized to perform restricted ProSe Direct
> Discovery monitoring when not served by E-UTRAN.
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0 indicates that the UE is not authorised to perform ProSe direct discovery model A monitoring when not served by E-UTRAN b1=1 indicates that the UE is authorised to perform ProSe direct discovery model A monitoring when not served by E-UTRAN  
|  |  |  |  |  |  |  |  |  | b2=0 indicates that the UE is not authorised to perform ProSe direct discovery model B discoveree operation when not served by E-UTRAN b2=1 indicates that the UE is authorised to perform ProSe direct discovery model B discoveree operation when not served by E-UTRAN.  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
ProSe Radio parameters information
+------------------------+--------+-------+----------------+ | Description | Value | M/O/C | Length (bytes) | +------------------------+--------+-------+----------------+ | ProSe Radio parameters | \'A0\' | M | 1 | | TLV | | | | +------------------------+--------+-------+----------------+ | Length | X | M | Note 1 | +------------------------+--------+-------+----------------+ | Geographical Area -- | \'80\' | M | 1 | | Polygon Tag | | | | +------------------------+--------+-------+----------------+ | Length | L1 | M | Note 1 | +------------------------+--------+-------+----------------+ | Geographical Area -- | -- | M | L1 | | Polygon value | | | | +------------------------+--------+-------+----------------+ | Radio parameters Tag | \'81\' | M | 1 | +------------------------+--------+-------+----------------+ | Length | L2 | M | Note 1 | +------------------------+--------+-------+----------------+ | Radio parameters value | -- | M | L2 | +------------------------+--------+-------+----------------+ | Note 1 : The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35] | | | | | | | | | | Note 2: C; if the Tag | | | | | is present, this is | | | | | mandatory. | | | | +------------------------+--------+-------+----------------+
Each ProSe Radio parameters TLV data object shall contain one or more
Geographical Area objects and one Radio parameters object.
\- Geographical Area -- Polygon Tag \'80\'
Contents:
> A geographical area defined by a polygon with 3 or more points.
Coding:
* * *
1 to 3 Latitude of point 1 M 3 bytes 4 to 6 Longitude of point 1 M 3 bytes 7
to 9 Latitude of point 2 M 3 bytes 10 to 12 Longitude of point 2 M 3 bytes 13
to 15 Latitude of point 3 M 3 bytes 16 to 18 Longitude of point 3 M 3 bytes :
: : : (6n-5) to 6n-3 Latitude of point n M 3 bytes (6n-2) to 6n Longitude of
point n M 3 bytes Latitude and longitude are coded as defined in clause 6.1 of
3GPP TS 23.032 [75].
* * *
NOTE: The upper limit of 15 specified in 3GPP TS 23.032 [9] for the number of
points in a polygon shape does not apply to the number of coordinates in a
geographical area described as a polygon for ProSe communications.
\- Radio parameters Tag \'81\'
Contents:
> The radio parameters used for ProSe Direct Communication
Coding:
Coded as _SL-Preconfiguration_ in 3GPP TS 36.331 [74].
#### 4.4.8.7 EF~PROSE_RADIO_ANN~ (ProSe Direct Discovery Announcing Radio
Parameters)
If service n°5 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the radio paramenters to be used for ProSe direct
communication for public safety when the UE is not served by E-UTRAN, as
described in TS 24.334 [70]. This file shall be used only if the ME is
authorized as per content of EF~AD~ or received service authorization from the
ProSe Function.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F06\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+=========+ | SFI: \'06\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | ProSe Direct | M | 1 byte | | | Discovery Announcing | | | | | not served by | | | | | E-UTRAN | | | +----------------------+----------------------+----------+---------+ | 2 to Z + 1 | ProSe Radio | M | Z bytes | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
ProSe Direct Discovery announcing not served by E-UTRAN:
Contents:
> Indicates if the ME is authorized to perform restricted ProSe Direct
> Discovery announcing when not served by E-UTRAN.
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0 indicates that the UE is not authorised to perform ProSe direct discovery model A announcing when not served by E-UTRAN b1=1 indicates that the UE is authorised to perform ProSe direct discovery model A announcing when not served by E-UTRAN  
|  |  |  |  |  |  |  |  |  | b2=0 indicates that the UE is not authorised to perform ProSe direct discovery model B discoverer operation when not served by E-UTRAN b2=1 indicates that the UE is authorised to perform ProSe direct discovery model B discoverer operation when not served by E-UTRAN.  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
ProSe Radio parameters information
+------------------------+--------+-------+----------------+ | Description | Value | M/O/C | Length (bytes) | +------------------------+--------+-------+----------------+ | ProSe Radio parameters | \'A0\' | M | 1 | | TLV | | | | +------------------------+--------+-------+----------------+ | Length | X | M | Note 1 | +------------------------+--------+-------+----------------+ | Geographical Area -- | \'80\' | M | 1 | | Polygon Tag | | | | +------------------------+--------+-------+----------------+ | Length | L1 | M | Note 1 | +------------------------+--------+-------+----------------+ | Geographical Area -- | -- | M | L1 | | Polygon value | | | | +------------------------+--------+-------+----------------+ | Radio parameters Tag | \'81\' | M | 1 | +------------------------+--------+-------+----------------+ | Length | L2 | M | Note 1 | +------------------------+--------+-------+----------------+ | Radio parameters value | -- | M | L2 | +------------------------+--------+-------+----------------+ | Note 1 : The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35] | | | | | | | | | | Note 2: C; if the Tag | | | | | is present, this is | | | | | mandatory. | | | | +------------------------+--------+-------+----------------+
Each ProSe Radio parameters TLV data object shall contain one or more
Geographical Area objects and one Radio parameters object.
\- Geographical Area -- Polygon Tag \'80\'
Contents:
> A geographical area defined by a polygon with 3 or more points.
Coding:
* * *
1 to 3 Latitude of point 1 M 3 bytes 4 to 6 Longitude of point 1 M 3 bytes 7
to 9 Latitude of point 2 M 3 bytes 10 to 12 Longitude of point 2 M 3 bytes 13
to 15 Latitude of point 3 M 3 bytes 16 to 18 Longitude of point 3 M 3 bytes :
: : : (6n-5) to 6n-3 Latitude of point n M 3 bytes (6n-2) to 6n Longitude of
point n M 3 bytes Latitude and longitude are coded as defined in clause 6.1 of
3GPP TS 23.032 [75].
* * *
NOTE: The upper limit of 15 specified in 3GPP TS 23.032 [9] for the number of
points in a polygon shape does not apply to the number of coordinates in a
geographical area described as a polygon for ProSe communications.
\- Radio parameters Tag \'81\'
Contents:
> The radio parameters used for ProSe Direct Communication
Coding:
> Coded as _SL-Preconfiguration_ in 3GPP TS 36.331 [74].
#### 4.4.8.8 EF~PROSE_POLICY~ (ProSe Policy Parameters)
If service n°6 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the policy paramenters to be used for ProSe direct
communication for public safety, as described in TS 24.334 [70]. This file
shall be used only if the ME is authorized as per content of EF~AD~ or
received service authorization from the ProSe Function.
Each record shall be associated with a different ProSe group.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F07\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'07\' | | | | +----------------------+----------------------+----------+---------+ | Record size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ProSe Policy | M | Z bytes | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
ProSe Policy parameters information:
* * *
Description Value M/O Length (bytes) ProSe Policy parameters Tag \'A0\' M 1
Length X M Note ProSe Layer-2 Group ID tag \'80\' M 1 Length 3 M 1 ProSe
Layer-2 Group ID -- M 3 ProSe UE ID tag \'81\' M 1 Length 3 M 1 ProSe UE ID --
M 3 ProSe Group IP multicast address tag \'82\' M 1 Length A M 1 ProSe Group
IP multicast address -- M A Address type tag \'83\' M 1 Length 1 M 1 Address
type -- M 1 IPv4 address as source tag \'84\' O 1 Length 4 C 1 IPv4 address as
source -- C 4 Group related security tag \'85\' M 1 Length B M Note Group
related security contents -- M B Application Layer Group ID tag \'86\' O 1
Length C C Note Application Layer Group ID -- C C Note: The length is coded
according to ISO/IEC 8825-1 [35]
* * *
\- ProSe Layer-2 Group ID tag \'80\'
Contents:
Contains the ProSe Layer-2 Group ID, as defined in TS 23.303 [73]
Coding:
As per TS 33.303 [72]
\- ProSe UE ID tag \'81\'
Contents:
Contains the ProSe UE ID, equivalent to the layer-2 source address of the
sending UE, as defined in TS 23.303 [73]
Coding:
As per TS 33.303 [72]
\- ProSe Group IP multicast address tag \'82\'
Contents:
> IPv4 or IPv6 group IP multicast addressed to be used for ProSe direct
> communication associated with the corresponding layer-2 group ID.
Coding:
Depending on the Address type
\- Address type tag \'83\'
Contents:
Type of IP address.
Coding:
A value of \'01\' indicates IPv4, a value of \'02\' indicates IPv6. All other
values are reserved.
\- IPv4 address as source tag \'84\'
Contents:
> IPv4 addressed to be used as source, in case of IPv4 address. This TLV shall
> be ignored if address type is different from IPv4.
Coding:
IPv4 address
\- Group related security tag \'85\'
Contents:
Parameters related to the group security.
Coding:
* * *
1 to 32 PGK as defined in TS 33.303 [72] M 32 bytes 33 PGK Id as defined in TS
33.303 [72]. M 1 byte 34 Algorithm Info as defined in TS 33.303 [72] M 1 byte
35 to B RFU O (B-34) bytes
* * *
> \- Application Layer Group ID \'86\'
Contents:
Application layer group that the UE belongs to.
Coding:
> As per TS 23.303 [73]
Unused bytes shall be set to \'FF\'.
#### 4.4.8.9 EF~PROSE_PLMN~ (ProSe PLMN Parameters)
If service n°3 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the authorized PLMNs for ProSe direct communication for
public safety, as described in TS 24.334 [70]. This file shall be used only if
the ME is authorized as per content of EF~AD~ or received service
authorization from the ProSe Function.
Each record shall be associated with a different PLMN.
+----------------------+---------------------------------------+----------+---------+ | Identifier: \'4F08\' | Structure: linear fixed | Optional | | +======================+=======================================+==========+=========+ | SFI: \'08\' | | | | +----------------------+---------------------------------------+----------+---------+ | Record size: Z bytes | Update activity: low | | | +----------------------+---------------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------------------+----------+---------+ | 1 to Z | ProSe PLMN parameters TLV data object | O | Z bytes | +----------------------+---------------------------------------+----------+---------+
ProSe Policy parameters information:
* * *
Description Value M/O Length (bytes) ProSe PLMN parameters Tag \'A0\' M 1
Length X M Note PLMN tag \'80\' M 1 Length 3 M 1 PLMN -- M 3 Direct
communication authorisation tag \'81\' O 1 Length 1 C 1 Direct communication
authorisation -- C 1 NOTE: The length is coded according to ISO/IEC 8825-1
[35]
* * *
\- PLMN tag \'80\'
Contents:
Contains the PLMNs in which the UE is authorised to perform ProSe direct
communication when served by E-UTRAN
Coding:
According to TS 24.008 [9].
\- Direct communication authorisation tag \'81\'
Contents:
Indicates if the UE is authorised to use one-to-one and/or one-to-many ProSe
direct communication.
Coding:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                b1 indicates if the UE is authorised for one-to-many ProSe direct communication
                                                b2 indicates if the UE is authorised for one-to-one ProSe direct communication.
                                                RFU (see TS 31.101 \[11\])
* * *
If the data object is missing, the UE shall behave as if only one-to-many
ProSe direct communication is authorized in the PLMN. All other values are
reserved.
Unused bytes shall be set to \'FF\'.
#### 4.4.8.10 EF~PROSE_GC~ (ProSe Group Counter)
If service n°7 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the PTK ID and Counter associated with the PGK currently in
use for a ProSe Group.
+--------------------------+---------------------------------+----------+---------+ | Identifier: \'4F09\' | Structure: Transparent | Optional | | +==========================+=================================+==========+=========+ | SFI: \'09\' | | | | +--------------------------+---------------------------------+----------+---------+ | File size: X >= 9 bytes | Update activity: high | | | +--------------------------+---------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +--------------------------+---------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +--------------------------+---------------------------------+----------+---------+ | 1 to L | ProSe Group Counter data object | O | L bytes | +--------------------------+---------------------------------+----------+---------+ | L+1 to 2xL | ProSe Group Counter data object | O | L bytes | +--------------------------+---------------------------------+----------+---------+ | : | : | : | : | +--------------------------+---------------------------------+----------+---------+
ProSe Group Counter:
* * *
Description Value M/O Length (bytes) ProSe Group Counter Tag \'80\' M 1 Length
X >= 7 M Note ProSe Layer-2 Group ID -- M 3 PTK ID -- M 2 Counter -- M 2 RFU
-- O X Note: The length is coded according to ISO/IEC 8825-1 [35]
* * *
\- ProSe Layer-2 Group ID
Contents:
Contains the ProSe Layer-2 Group ID, as defined in TS 23.303 [73]
Coding:
As per TS 33.303 [72]
\- PTK ID
Contents:
Contains the PTK value, as defined in TS 33.303 [72]
Coding:
As per TS 33.303 [72]
\- Counter
Contents:
Contains the Counter for the PGK used in the group, as defined in TS 33.303
[72]
Coding:
As per TS 33.303 [72]
Unused bytes shall be set to \'FF\'.
#### 4.4.8.11 EF~PST~ (ProSe Service Table)
If service n°101 is \"available\" in the USIM Service Table, this file shall
be present. This EF indicates which ProSe services are available. If a service
is not indicated as available in the ProSe Service Table, the ME shall not
select this service.
+-----------------------------+-----------------------------+----------+--------+ | Identifier: \'4F10\' | Structure: transparent | Optional | | +=============================+=============================+==========+========+ | SFI: \'10\' | | | | +-----------------------------+-----------------------------+----------+--------+ | File size: X bytes, (X ≥ 1) | Update activity: low | | | +-----------------------------+-----------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+-----------------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------------+-----------------------------+----------+--------+ | 1 | Services n°1 to n°8 | M | 1 byte | +-----------------------------+-----------------------------+----------+--------+ | 2 | Services n°9 to n°16 | O | 1 byte | +-----------------------------+-----------------------------+----------+--------+ | etc. | | | | +-----------------------------+-----------------------------+----------+--------+ | X | Services n°(8X‑7) to n°(8X) | O | 1 byte | +-----------------------------+-----------------------------+----------+--------+
‑Services
* * *
Contents: Service n°1: ProSe direct discovery parameters Service n°2: HPLMN
ProSe Function Service n°3: ProSe Direct Communication radio parameters
Service n°4: ProSe Direct Discovery monitoring radio parameters Service n°5:
ProSe Direct Discovery announcing radio parameters Service n°6: ProSe policy
parameters Service n°7: ProSe group counter Service n°8: ProSe Usage
Information Reporting configuration Service n°9: UICC ProSe Direct
Communication usage information reporting Service n°10 ProSe Group Member
Discovery parameters Service n°11 ProSe Relay parameters
The EF shall contain at least one byte. Further bytes may be included, but if
the EF includes an optional byte, then it is mandatory for the EF to also
contain all bytes before that byte. Other services are possible in the future
and will be coded on further bytes in the EF.
If service n°9 is \"available\", then service n°8 shall also be \"available\".
If service n°10 is \"available\", then service n°1 shall also be
\"available\".
Coding:
Same as coding of USIM Service Table
#### 4.4.8.12 EF~PROSE_UIRC~ (ProSe UsageInformationReportingConfiguration)
If service n°8 is \"available\" in the ProSe Service Table, this file shall be
present.
This EF contains the description of the configuration to be used by the UE for
reporting the usage information for direct communication for public safety, as
described in TS 24.334 [70] and TS 32.277 [77]. This file shall be used only
if the UE is authorized for direct communication as per content of EF~AD~ or
received service authorization from the ProSe Function.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F11\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+=========+ | SFI: \'11\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ProSe | M | Z bytes | | | UsageInformationRe | | | | | portingConfiguration | | | | | TLV data objects | | | +----------------------+----------------------+----------+---------+
ProSe UsageInformationReportingConfiguration parameters information:
* * *
Description Value M/O Length (bytes) ProSe ServerAddress tag \'80\' C 1 Length
A C Note ProSe ServerAddress -- C A ProSe CollectionPeriod tag \'81\' M 1
Length 3 M 1 ProSe CollectionPeriod -- M 3 ProSe ReportingWindow tag \'82\' M
1 Length 3 M 1 ProSe ReportingWindow -- M 3 ProSe ReportGroupParameters tag
\'83\' O 1 Length 1 O 1 ProSe ReportGroupParameters -- O 1 ProSe
ReportTimeStampsFirstTransmissionAndReception tag \'84\' O 1 Length 1 O 1
ProSe ReportTimeStampsFirstTransmissionAndReception -- O 1 ProSe
ReportDataTransmitted tag \'85\' O 1 Length 1 O 1 ProSe ReportDataTransmitted
-- O 1 ProSe ReportDataReceived tag \'86\' O 1 Length 1 O 1 ProSe
ReportDataReceived -- O 1 ProSe ReportTimeStampsOutOfCoverage tag \'87\' O 1
Length 1 O 1 ProSe ReportTimeStampsOutOfCoverage -- O 1 ProSe
ReportLocationInCoverage tag \'88\' O 1 Length 1 O 1 ProSe
ReportLocationInCoverage -- O 1 ProSe ReportRadioParameters tag \'89\' O 1
Length 1 O 1 ProSe ReportRadioParameters -- O 1 NOTE: The length is coded
according to ISO/IEC 8825-1 [35]
* * *
\- ProSe ServerAddress
Contents:
> As described in TS 24.333 [71], used to determine the IPv4 or IPv6 address
> the UE or the USIM shall use to send the usage report to. If no server
> address is provided, the UE shall upload the usage information reports to
> the IP address of the HPLMN ProSe Function. If the USIM supports storage of
> the usage information, the server address is mandatory.
Coding:
> As defined for the ProSe ServerAddress leaf in TS 24.333 [71].
\- ProSe CollectionPeriod
Contents:
> As described in TS 24.333 [71], contains the time interval, in unit of
> minutes, at which the UE shall generate the usage information reports.
> Setting the CollectionPeriod to a value of 0 disables generation of usage
> information reports at the UE.
Coding:
> As defined for the ProSe CollectionPeriod leaf in TS 24.333 [71].
\- ProSe ReportingWindow
Contents:
> As described in TS 24.333 [71], contains the time window, in units of
> minutes, during which the UE shall upload the usage information report to
> the server. Setting the ReportingWindow to a value of 0 disables upload of
> the usage information reports by the UE.
Coding:
> As defined for the ProSe ReportingWindow leaf in TS 24.333 [71].
\- ProSe ReportGroupParameters
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the group parameters for one-to-many ProSe direct communication in the usage
> information. The default value 0 applies if this TLV is not provisioned.
Coding:
> As defined for the ProSe ReportGroupParameters leaf in TS 24.333 [71].
\- ProSe ReportTimeStampsFirstTransmissionAndReception
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the time stamps of the first transmission/reception during the collection
> period in the usage information. The default value 0 applies if this TLV is
> not provisioned
Coding:
> As defined for the ProSe ReportTimeStampsFirstTransmissionAndReception leaf
> in TS 24.333 [71].
\- ProSe ReportDataTransmitted
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the amount of data transmitted during the collection period in the usage
> information, and whether with location information. The default value 1
> applies if this TLV is not provisioned
Coding:
> As defined for the ProSe ReportDataTransmitted leaf in TS 24.333 [71].
\- ProSe ReportDataReceived
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the amount of data received during the collection period in the usage
> information, and whether with location information. The default value 1
> applies if this TLV is not provisioned
Coding:
> As defined for the ProSe ReportDataReceived leaf in TS 24.333 [71].
\- ProSe ReportTimeStampsOutOfCoverage
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the time stamps when it went in and out of E-UTRAN coverage during the
> collection period in the usage information. The default value 0 applies if
> this TLV is not provisioned
Coding:
> As defined for the ProSe ReportTimeStampsOutOfCoverage leaf in TS 24.333
> [71].
\- ProSe ReportLocationInCoverage
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the list of locations of the UE when in E-UTRAN coverage during the
> collection period in the usage information.
Coding:
> As defined for the ProSe ReportLocationInCoverage leaf in TS 24.333 [71].
\- ProSe ReportRadioParameters
Contents:
> As described in TS 24.333 [71], indicates whether or not the UE shall report
> the radio parameters used for ProSe direct communication (i.e. indicator of
> which radio resources used and radio frequency used) during the reporting
> period in the usage information.
Coding:
> As defined for the ProSe ReportRadioParameters leaf in TS 24.333 [71].
#### 4.4.8.12 EF~PROSE_GM_DISCOVERY~ (ProSe Group Member Discovery Parameters)
If service n°10 is \"available\" in the ProSe Service Table, this file shall
be present.
This EF contains the ProSe discovery parameters for public safety, as
described in TS 24.334 [70]. This file shall be used only if the ME is
authorized as per content of EF~AD~ or received service authorization from the
ProSe Function.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F12\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'12\' | | | | +----------------------+----------------------+----------+---------+ | Record size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Y | Group member | O | Y bytes | | | discovery parameters | | | | | TLV data object | | | +----------------------+----------------------+----------+---------+
Group member discovery parameters information:
* * *
Description Value M/O Length (bytes) Group member discovery parameters Tag
\'A0\' M 1 Length X M Note User Info ID tag \'80\' M 1 Length 6 M 1 User Info
ID -- M 6 Discovery Group ID tag \'81\' M 1 Length 3 M 1 Discovery Group ID --
M 3 Application Layer Group ID tag \'82\' M 1 Length Y M Note Application
Layer Group ID -- M Y NOTE: The length is coded according to ISO/IEC 8825-1
[35]
* * *
Each record shall contain at most one Group member discovery parameters
information.
\- User Info ID tag \'80\'
Contents:
> Indicates the user information which is sent by the announcing or discoverer
> or discoveree UE over the air during Group Member Discovery procedures.
Coding:
As defined in TS 24.334 [70].
\- Discovery Group ID tag \'81\'
Contents:
> Indicates the group ID of the discovery group that the UE belongs to when
> group member discovery is performed.
Coding:
As defined in TS 24.334 [70].
\- Application Layer Group ID tag \'82\'
Contents:
> Indicates the Application Layer Group ID identifying an application layer
> group that the UE belongs to.
Coding:
As per TS 23.303 [73]
Unused bytes shall be set to \'FF\'.
#### 4.4.8.13 EF~PROSE_RELAY~ (ProSe Relay Parameters)
If service n°11 is \"available\" in the ProSe Service Table, this file shall
be present.
This EF contains the authorized PLMNs for ProSe UE-to-network relay for public
safety, as described in TS 24.334 [70]. This file shall be used only if the ME
is authorized as per content of EF~AD~ or received service authorization from
the ProSe Function.
Each record shall be associated with a different PLMN.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F13\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'13\' | | | | +----------------------+----------------------+----------+---------+ | Record size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | ProSe Relay | O | Z bytes | | | parameters TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
ProSe Relay parameters information:
* * *
Description Value M/O Length (bytes) ProSe Relay parameters Tag \'A0\' M 1
Length X M Note PLMN tag \'80\' M 1 Length 3 M 1 PLMN -- M 3 Relay type tag
\'81\' M 1 Length 1 M 1 Relay type -- M 1 NOTE: The length is coded according
to ISO/IEC 8825-1 [35]
* * *
\- PLMN tag \'80\'
Contents:
> Contains the PLMNs in which the UE is authorised to act as a ProSe UE-to-
> network relay and/or use a ProSe UE-to-network relay.
Coding:
According to TS 24.008 [9].
\- Relay type tag \'81\'
Contents:
> Indicates if the UE is authorized to act as a ProSe UE-to-network relay
> and/or use a ProSe UE-to-network relay.
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0 indicates that the UE is not authorised to act as a ProSe UE-to-network relay. b1=1 indicates that the UE is authorised to act as a ProSe UE-to-network relay.  
|  |  |  |  |  |  |  |  |  | b2=0 indicates that the UE is not authorised to use a ProSe UE-to-network relay. b2=1 indicates that the UE is authorised to use a ProSe UE-to-network relay.  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
Unused bytes shall be set to \'FF\'.
#### 4.4.8.14 EF~PROSE_RELAY_DISCOVERY~ (ProSe Relay Discovery Parameters)
If service n°11 is \"available\" in the ProSe Service Table, this file shall
be present.
This EF contains the ProSe direct discovery parameters when it is used for
ProSe UE-to-network relay discovery for public safety, as described in TS
24.334 [70]. This file shall be used only if the ME is authorized as per
content of EF~AD~ or received service authorization from the ProSe Function.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F14\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+=========+ | SFI: \'14\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | | (Z > 5 bytes) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 6 | User Info ID | M | 6 bytes | +----------------------+----------------------+----------+---------+ | -- | Remote UE parameters | O | X bytes | | | TLV data object | | | +----------------------+----------------------+----------+---------+ | -- | Relay parameters TLV | O | Y bytes | | | data object | | | +----------------------+----------------------+----------+---------+
User Info ID
Contents:
> Indicates the user information which is sent by the announcing or discoverer
> or discoveree UE over the air during Group Member Discovery procedures.
Coding:
> As defined in TS 24.334 [70].
Remote UE parameters information:
The EF can contain multiple Remote UE parameters data objects.
* * *
Description Value M/O Length (bytes) Remote UE parameters Tag \'A0\' M 1
Length X M Note Relay Service Code tag \'80\' M 1 Length 3 M 1 Relay Service
Code -- M 3 User Info ID of Relay tag \'81\' O 1 Length 6 C 1 User Info ID of
Relay -- C 6 IP Versions tag \'82\' M 1 Length 1 M 1 IP Versions -- M 1
Security content tag \'83\' M 1 Length Y M Note Security content -- M Y NOTE:
The length is coded according to ISO/IEC 8825-1 [35]
* * *
\- Relay Service Code tag \'80\'
Contents:
> Indicates the connectivity service that the ProSe UE-to-network relay
> provides to public safety applications.
Coding:
As defined in TS 24.334 [70].
\- User Info ID of Relay tag \'81\'
Contents:
> Indicates the user information of the ProSe UE-to-network relay that the
> remote UE seeks to discover during ProSe UE-to-network relay discovery
> procedures.
Coding:
As defined in TS 24.334 [70].
\- IP Versions tag \'82\'
Contents:
> Indicates the IP version(s) that the remote UE can use for the relay traffic
> associated with the Relay Service Code.
Coding:
> A value of \'01\' indicates IPv4, a value of \'02\' indicates IPv6, a value
> of \'03\' indicates IPv4v6. All other values are reserved.
\- Security Content tag \'83\'
Contents:
Parameters related to the relay discovery.
Coding:
+-------------+----------------------------+---------+--------------+ | **Byte(s)** | **Description** | **M/O** | **Length** | +-------------+----------------------------+---------+--------------+ | 1 to 32 | PSDK as defined in TS | M | 32 bytes | | | 33.303 [72] | | | +-------------+----------------------------+---------+--------------+ | 33 | PSDK Id as defined in TS | M | 1 byte | | | 33.303 [72]. | | | +-------------+----------------------------+---------+--------------+ | 34 | Bitmask of keys: | M | 1 byte | | | | | | | | - b1=1 indicates that | | | | | DUSK is to be used | | | | | | | | | | - b2=1 indicates that | | | | | DUCK is to be used | | | | | | | | | | - b3=1 indicates that | | | | | DUIK is to be used | | | | | | | | | | - all other bits are RFU | | | +-------------+----------------------------+---------+--------------+ | 35 to 57 | DUCK encryption bitmask, | M | 23 bytes | | | as defined in TS 24.334 | | | | | [70] (applicable when | | | | | DUCK is used) | | | +-------------+----------------------------+---------+--------------+ | 58 to Y | RFU | O | (Y-57) bytes | +-------------+----------------------------+---------+--------------+
Relay parameters information:
The EF can contain multiple Relay parameters data objects.
* * *
Description Value M/O Length (bytes) Relay parameters Tag \'A1\' M 1 Length X
M Note Relay Service Code tag \'80\' M 1 Length 3 M 1 Relay Service Code -- M
3 PDN type tag \'81\' O 1 Length 1 C 1 PDN type -- C 1 APN tag \'82\' O 1
Length 3 C 1 APN -- C 3 ProSe Relay UE ID tag \'83\' M 1 Length 3 M 1 ProSe
Relay UE ID -- M 3 Security content tag \'84\' M 1 Length Y M Note Security
content -- M Y NOTE: The length is coded according to ISO/IEC 8825-1 [35]
* * *
\- Relay Service Code tag \'80\'
Contents:
> Indicates the connectivity service that the ProSe UE-to-network relay
> provides to public safety applications.
Coding:
> As defined in TS 24.334 [70].
\- PDN type tag \'81\'
Contents:
> Indicates the IP version of the PDN connection to be used for the relayed
> traffic associated with a Relay Service Code.
Coding:
> A value of \'01\' indicates IPv4, a value of \'02\' indicates IPv6. All
> other values are reserved.
\- APN tag \'82\'
Contents:
> Indicates the PDN connection that the ProSe UE-to-network relay uses for the
> relayed traffic associated with a Relay Service Code. If this TLV is
> missing, then the default APN is used for the PDN connectivity.
Coding:
> A network access point name
\- ProSe Relay UE ID tag \'83\'
Contents:
> Indicates the link layer identifier used for direct communication associated
> with a Relay Service Code.
Coding:
> As defined in TS 24.334 [70].
\- Security Content tag \'84\'
Contents:
Parameters related to the relay discovery.
Coding:
+-------------+----------------------------+---------+--------------+ | **Byte(s)** | **Description** | **M/O** | **Length** | +-------------+----------------------------+---------+--------------+ | 1 to 32 | PSDK as defined in TS | M | 32 bytes | | | 33.303 [72] | | | +-------------+----------------------------+---------+--------------+ | 33 | PSDK Id as defined in TS | M | 1 byte | | | 33.303 [72]. | | | +-------------+----------------------------+---------+--------------+ | 34 | Bitmask of keys: | M | 1 byte | | | | | | | | - b1=1 indicates that | | | | | DUSK is to be used | | | | | | | | | | - b2=1 indicates that | | | | | DUCK is to be used | | | | | | | | | | - b3=1 indicates that | | | | | DUIK is to be used | | | | | | | | | | - all other bits are RFU | | | +-------------+----------------------------+---------+--------------+ | 35 to 57 | DUCK encryption bitmask, | M | 23 bytes | | | as defined in TS 24.334 | | | | | [70] (applicable when | | | | | DUCK is used) | | | +-------------+----------------------------+---------+--------------+ | 58 to Y | RFU | O | (Y-57) bytes | +-------------+----------------------------+---------+--------------+
Unused bytes shall be set to \'FF\'.
### 4.4.9 Contents of files at the DF ACDC level
#### 4.4.9.1 Introduction
This clause describes the additional files that are used for ACDC
configuration.
DF~ACDC~ shall be present at the ADF~USIM~ level if service nº108 is
\"available\" in EF~UST~ (USIM Service Table).
#### 4.4.9.2 EF~ACDC_LIST~ (ACDC List)
If service n°108 is \"available\", this file shall be present.
This EF contains the link to EFs containing the ACDC for each operating system
identifier. The ME parses the content of the EF~ACDC_LIST~ and retrieves the
file id and optionally the SFI to further access the relevant ACDC
configuration.
+----------------------+----------------------+----------+----------+ | Identifier: \'4F01\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+==========+ | SFI: \'01\' | | | | +----------------------+----------------------+----------+----------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to L1 | ACDC OS TLV data | M | L1 bytes | | | object 1 | | | +----------------------+----------------------+----------+----------+ | L1+1 to L1+L2 | ACDC OS TLV data | O | L2 bytes | | | object 2 | | | +----------------------+----------------------+----------+----------+ | : | : | : | : | +----------------------+----------------------+----------+----------+ | L1+L2+...+L(n-1)+1 | ACDC OS TLV data | O | Ln bytes | | to L1+L2+...+Ln | object n | | | +----------------------+----------------------+----------+----------+
ACDC OS TLV data object
* * *
Description Value M/O/C Length (bytes) ACDC OS tag \'A0\' M 1 Length X+19 M
Note OS Id -- M 16 File Id -- M 2 SFI -- M 1 RFU -- O X Note: The length is
coded according to ISO/IEC 8825-1 [35]
* * *
\- OS Id
Contents:
> The Operating System identifier
Coding:
> A Universally Unique IDentifier (UUID) as specified in IETF RFC 4122 [80].
\- File Id
Contents:
> File Id of the EF containing the ACDC configuration for the Operating System
Coding:
> According to TS 31.101 [11]
\- SFI
Contents:
> Short File Identifier of the EF containing configuration for the Operating
> System
Coding:
> According to TS 31.101 [11]. The value \'0\' indicates that SFI is not
> allocated for the file.
Unused bytes shall be set to \'FF\'.
#### 4.4.9.3 EF~ACDC_OS_CONFIG~ (ACDC OS configuration)
This EF contains the ACDC configuration for a specific Operating System. The
ME retrieves ths file id or the SFI of the file from the EF~ACDC_LIST~.
+----------------------+----------------------+----------+----------+ | Identifier: \'4FXX\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+==========+ | SFI: \'XX\' | | | | | (optional) | | | | +----------------------+----------------------+----------+----------+ | File size: Z bytes | Update activity: low | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to L1 | ACDC App Id 1 | M | L1 bytes | +----------------------+----------------------+----------+----------+ | L1+1 to L1+L2 | ACDC App Id 2 | O | L2 bytes | +----------------------+----------------------+----------+----------+ | | : | : | : | +----------------------+----------------------+----------+----------+ | L1+L2+...+L(n-1)+1 | ACDC App Id n | O | Ln bytes | | to L1+L2+...+Ln | | | | +----------------------+----------------------+----------+----------+
ACDC App Id
* * *
Description Value M/O/C Length (bytes) ACDC App Id tag \'A0\' M 1 Length X M
Note ACDC category tag \'80\' M 1 Length 1 M 1 ACDC category -- M 1 OS App Id
tag \'81\' M 1 Length L M Note OS App Id -- M L Note: The length is coded
according to ISO/IEC 8825-1 [35]
* * *
\- ACDC category
Contents:
> The ACDC category indicates the category to which the identified application
> belongs.
Coding:
> As the _ACDCCategory leaf in 24.105 [81]_
\- OS App Id
Contents:
> indicates an OS specific application identifier
Coding:
> As the _OSAppId leaf in 24.105 [81]_
Unused bytes shall be set to \'FF\'.
### 4.4.10 Contents of files at the DF TV level
#### 4.4.10.1 Introduction
This clause describes the additional files that are used for TV service
configuration.
DF~TV~ shall be present at the ADF~USIM~ level if service nº116 is
\"available\" in EF~UST~ (USIM Service Table).
#### 4.4.10.2 EF~TVUSD~ (TV User Service Description)
This file contains the User Service Description (USD) associated with one or
more entries in the EF~TVCONFIG~. The ME retrieves this file identifier from
the EF~TVCONFIG~.
Multiple EF~TVUSD~ files may exist in the DF, each one associated with a
different entry in EF~TVCONFIG~.
+----------------------+------------------------+----------+-----------+ | Identifier: \'4FXX\' | Structure: transparent | Optional | | +======================+========================+==========+===========+ | File size: Z bytes | Update activity: low | | | +----------------------+------------------------+----------+-----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+-----------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+-----------+ | 1 to L | USD TLV data object | M | L bytes | +----------------------+------------------------+----------+-----------+ | L+1 to Z | RFU | O | Z-L bytes | +----------------------+------------------------+----------+-----------+
USD TLV data object:
* * *
Description Value M/O/C Length (bytes) USD Tag \'A0\' M 1 Length X M Note USD
-- C X Note: The length is coded according to ISO/IEC 8825-1 [35]
* * *
USD:
Contents:
\- User Service Description (USD).
Coding:
\- According to TS 26.346 [99] clause J.1.
### 4.4.11 Contents of files at the DF~5GS~ level
#### 4.4.11.1 Introduction
This clause describes the files that are specific for 5GS.
DF~5GS~ shall be present at the ADF~USIM~ level if any of the following
services are \"available\" in EF~UST~ (USIM Service Table):
* * *
Service n°122 5GS Mobility Management Information Service n°123 5G Security
Parameters Service n°124 Subscription identifier privacy support Service n°125
SUCI calculation by the USIM Service n°126 UAC Access Identities support
Service n°127 Control plane-based steering of UE in VPLMN Service n°128 Call
control on PDU Session by USIM Service n°129 5GS Operator PLMN List Service
n°130 Support for SUPI of type NSI or GLI or GCI Service n°132 Support for
URSP by USIM Service n°133 5G Security Parameters extended Service n°134 MuD
and MiD configuration data Service n°135 Support for Trusted non-3GPP access
networks by USIM Service n°136 Support for multiple records of NAS security
context storage for multiple registration Service n°137 Pre-configured CAG
information list Service n°138 SOR-CMCI storage in USIM Service n°140 Storage
of disaster roaming information in USIM Service n°141 Pre-configured eDRX
parameters Service n°142 5G NSWO support Service n°144 Multiplier Coefficient
for Higher Priority PLMN search via NG-RAN satellite access Service n°145
K~AUSF~ derivation configuration
* * *
#### 4.4.11.2 EF~5GS3GPPLOCI~ (5GS 3GPP location information)
If service n°122 is \"available\" in EF~UST~, this file shall be present.
This EF contains the following 5GS location information for 3GPP access:
‑ 5G-Globally Unique Temporary Identifier (5G-GUTI);
‑ Last visited registered Tracking Area Identity in 5GS (TAI);
‑ 5GS update status.
+----------------------+----------------------+----------+----------+ | Identifier: \'4F01\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+----------+ | SFI: \'01\' | | | | +----------------------+----------------------+----------+----------+ | File size: 20 bytes | Update activity: | | | | | high | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to 13 | 5G-GUTI for 3GPP | M | 13 bytes | | | access | | | +----------------------+----------------------+----------+----------+ | 14 to19 | Last visited | M | 6 bytes | | | registered TAI in | | | | | 5GS for 3GPP access | | | +----------------------+----------------------+----------+----------+ | 20 | 5GS update status | M | 1 byte | | | for 3GPP access | | | +----------------------+----------------------+----------+----------+
‑ 5G-GUTI for 3GPP access.
> Contents:
5G-Globally Unique Temporary Identifier for 3GPP access.
> Coding:
as the 5G-GUTI part of the 5GS mobile identity information element defined in
TS 24.501 [104]. Byte 1 corresponds to \"octet 2\" of an 5GS mobile identity
information element containing a 5G-GUTI. Byte 13 corresponds to \"octet 14\"
of an 5GS mobile identity information element information element containing a
5G-GUTI.
Byte 1: first byte of 5G-GUTI for 3GPP access
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
‑ Last visited registered TAI in 5GS for 3GPP access
Contents:
Last visited registered Tracking Area Identity in 5GS for 3GPP access.
Coding:
as the content of the tracking area identity information element defined in TS
24.501 [104]. Byte 14 corresponds to \"octet 2\" of a tracking area identity
information element. Byte 19 corresponds to \"octet 7\" of a tracking area
identity information element.
Byte 14: first byte of last visited registered TAI for 3GPP access
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
‑ 5GS update status for 3GPP access.
Contents:
status of 5GS update for 3GPP access according to TS 24.501 [104].
Coding:
byte 20:
Bits: b3 b2 b1.
0 0 0 : 5U1 UPDATED.
0 0 1 : 5U2 NOT UPDATED.
0 1 0 : 5U3 ROAMING NOT ALLOWED.
0 1 1 : reserved.
1 0 0 : reserved.
1 0 1 : reserved.
1 1 0 : reserved.
1 1 1 : reserved.
Bits b4 to b8 are RFU (see TS 31.101 [11]).
Unused bytes shall be set to \'FF\'.
#### 4.4.11.3 EF~5GSN3GPPLOCI~ (5GS non-3GPP location information)
If service n°122 is \"available\" in EF~UST~, this file shall be present.
This EF contains the following 5GS location information for non-3GPP access:
‑ 5G-Globally Unique Temporary Identifier (5G-GUTI);
‑ Last visited registered Tracking Area Identity in 5GS (TAI);
‑ 5GS update status.
+----------------------+----------------------+----------+----------+ | Identifier: \'4F02\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+==========+ | SFI: \'02\' | | | | +----------------------+----------------------+----------+----------+ | File size: 20 bytes | Update activity: | | | | | high | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to 13 | 5G-GUTI for non-3GPP | M | 13 bytes | | | access | | | +----------------------+----------------------+----------+----------+ | 14 to19 | Last visited | M | 6 bytes | | | registered TAI in | | | | | 5GS for non-3GPP | | | | | access | | | +----------------------+----------------------+----------+----------+ | 20 | 5GS update status | M | 1 byte | | | for non-3GPP access | | | +----------------------+----------------------+----------+----------+
For content and coding see clause 4.4.11.2 for EF~5GS3GPPLOCI~.
#### 4.4.11.4 EF~5GS3GPPNSC~ (5GS 3GPP Access NAS Security Context)
If service n°122 is \"available\" in EF~UST~, this file shall be present.
This EF contains the 5GS 3GPP access NAS security context as defined in TS
24.501 [104], consisting of K~AMF~ with the associated key set identifier, the
UE security capabilities, and the uplink and downlink NAS COUNT values. This
EF also contains the EPS NAS security algorithms to be used when the UE goes
to EPS, either by means of connected mode handover in a network that supports
N26 interface, or by the means of idle mode mobility performed by the UE from
5GS to EPS, as specified in TS 33.501 [105]. This file shall contain one
record.
If Service n°136 is not \"available\" in EF~UST~, the file shall contain one
record.
If service n°136 is \"available\" in EF~UST~, the file shall contain two
records. As specified in TS 33.501 [105] clause 6.3.2.1, in case of multiple
registrations in different PLMNs, each record shall store 5GS 3GPP access NAS
security context for each different PLMN (Refer to Annex O for examples),
+----------------------+----------------------+----------+---------+ | Identifier: \'4F03\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'03\' | | | | +----------------------+----------------------+----------+---------+ | Record size: X bytes | Update activity: | | | | (X≥57) | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5GS NAS Security | M | X bytes | | | Context TLV Object | | | +----------------------+----------------------+----------+---------+
5GS NAS Security Context tags
Description Tag Value
* * *
5GS NAS Security Context Tag \'A0\'
5GS NAS Security Context information
+------------------+--------+----------------+----------------+ | Description | Value | M/O | Length (bytes) | +==================+========+================+================+ | 5GS NAS Security | \'A0\' | M | 1 | | Context Tag | | | | +------------------+--------+----------------+----------------+ | Length (length | Y | M | Note 1 | | of all | | | | | subsequent data) | | | | +------------------+--------+----------------+----------------+ | ngKSI Tag | \'80\' | M | 1 | +------------------+--------+----------------+----------------+ | Length | K | M | Note 1 | +------------------+--------+----------------+----------------+ | ngKSI | -- | M | K | +------------------+--------+----------------+----------------+ | K~AMF~ Tag | \'81\' | M | 1 | +------------------+--------+----------------+----------------+ | Length | L | M | Note 1 | +------------------+--------+----------------+----------------+ | K~AMF~ | -- | M | L | +------------------+--------+----------------+----------------+ | Uplink NAS count | \'82\' | M | 1 | | Tag | | | | +------------------+--------+----------------+----------------+ | Length | M | M | Note 1 | +------------------+--------+----------------+----------------+ | Uplink NAS count | -- | M | M | +------------------+--------+----------------+----------------+ | Downlink NAS | \'83\' | M | 1 | | count Tag | | | | +------------------+--------+----------------+----------------+ | Length | N | M | Note 1 | +------------------+--------+----------------+----------------+ | Downlink NAS | -- | M | N | | count | | | | +------------------+--------+----------------+----------------+ | Identifiers of | \'84\' | M | 1 | | selected NAS | | | | | integrity and | | | | | encryption | | | | | algorithms Tag | | | | +------------------+--------+----------------+----------------+ | Length | S | M | Note 1 | +------------------+--------+----------------+----------------+ | Identifiers of | -- | M | S | | selected NAS | | | | | integrity and | | | | | encryption | | | | | algorithms | | | | +------------------+--------+----------------+----------------+ | Identifiers of | \'85\' | M | 1 | | selected EPS NAS | | | | | integrity and | | | | | encryption | | | | | algorithms for | | | | | use after | | | | | mobility to EPS | | | | | Tag | | | | +------------------+--------+----------------+----------------+ | Length | U | M | Note 1 | +------------------+--------+----------------+----------------+ | Identifiers of | -- | M | U | | selected EPS NAS | | | | | integrity and | | | | | encryption | | | | | algorithms for | | | | | use after | | | | | mobility to EPS | | | | +------------------+--------+----------------+----------------+ | PLMN identifier | \'86\' | C (see Note 2) | 1 | | tag | | | | +------------------+--------+----------------+----------------+ | Length | 3 | C (see Note 2) | Note 1 | +------------------+--------+----------------+----------------+ | PLMN identifier | -- | C (see Note 2) | 3 | +------------------+--------+----------------+----------------+ | Note 1: The | | | | | length is coded | | | | | according to | | | | | ISO/I | | | | | EC 8825-1 [35] | | | | | | | | | | Note 2: If | | | | | service n°136 is | | | | | \"available\", | | | | | PLMN identifier | | | | | shall be | | | | | included to | | | | | identify the | | | | | PLMN of the 5GS | | | | | NAS Security | | | | | Context stored | | | | | in record 2 for | | | | | the access. The | | | | | PLMN identifier | | | | | is not | | | | | applicable for | | | | | record 1 and is | | | | | mandatory for | | | | | record 2. | | | | +------------------+--------+----------------+----------------+
\- ngKSI Tag \'80\'
Contents:
The ngKSI (Key Set Identifier in 5G) as defined in TS 33.501 [105] is coded on
1 byte.
Coding:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                ngKSI
                                                bits b4 to b8 are coded 0
\- K~AMF~ Tag \'81\'
Contents:
The K~AMF~ as defined in TS 33.501 [105] is coded on 32 bytes. The ME shall
treat any K~AMF~ values stored in this EF as invalid if the ngKSI indicates
that no K~AMF~ is available or if the length indicated in the K~AMF~ TLV is
set to \'00\',
Coding:
The most significant bit of K~AMF~ is the most significant bit of the 1^st^
byte of this TLV value field. The least significant bit of K~AMF~ is the least
significant bit of the last byte of this TLV value field.
\- Uplink NAS count Tag \'82\'
Contents:
The uplink NAS count as defined in TS 33.501 [105] is coded on 4 bytes.
Coding:
The most significant bit of the uplink NAS count is the most significant bit
of the 1^st^ byte of this TLV value field. The least significant bit of the
uplink NAS count is the least significant bit of the last byte of this TLV
value field.
\- Downlink NAS count Tag \'83\'
Contents:
The downlink NAS count as defined in TS 33.501 [105] is coded on 4 bytes.
Coding:
The most significant bit of the downlink NAS count is the most significant bit
of the 1^st^ byte of this TLV value field. The least significant bit of the
downlink NAS count is the least significant bit of the last byte of this TLV
value field.
\- Identifiers of selected NAS integrity and encryption algorithms Tag \'84\'
Contents:
The identifiers of selected NAS integrity and encryption algorithms as defined
in TS 33.501 [105] and TS 24.501 [104]. In this release the identifiers of
selected NAS integrity and encryption algorithms are coded as 4-bit
identifiers.
Coding:
Coding is same as the content of the NAS security algorithms information
element defined in TS 24.501 [104].
Byte 1 of this TLV value field: first byte of the value part of the NAS
security algorithms information element
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
\- Identifiers of selected EPS NAS algorithms for use after mobility to EPS
Tag \'85\'
Contents:
The identifiers of selected EPS NAS integrity and encryption algorithms to be
used when the UE goes to EPS, either by means of connected mode handover in a
network that supports N26 interface, or by the means of idle mode mobility
performed by the UE from 5GS to EPS, as specified in TS 33.501 [105] and TS
24.501 [104]. These identifiers are coded as 4-bit identifiers.
Coding:
Coding is same as the content of the EPS NAS security algorithms information
element specified in TS 24.301 [51].
Byte 1 of this TLV value field: first byte of the value part of the EPS NAS
security algorithms information element in TS 24.301 [51].
* * *
        b8    b7   b6   b5   b4   b3   b2   b1
        MSB
* * *
\- PLMN identifier Tag \'86\'
Contents:
The PLMN identifier comprising MCC and MNC defined in TS 23.003 [25] is coded
on 3 bytes.
Coding:
The PLMN identifier is coded according to TS 24.008 [9].
Unused bytes shall be set to \'FF\'.
In order to mark the stored 5GS NAS security context as invalid:
\- the record bytes shall be set to \'FF\', or
\- the ngKSI is set to \'07\', or
\- the length indicated in the K~AMF~ TLV is set to \'00\'.
#### 4.4.11.5 EF~5GSN3GPPNSC~ (5GS non-3GPP Access NAS Security Context)
If Service n°122 is \"available\" in EF~UST~, this file shall be present.
This EF contains the 5GS non-3GPP access NAS security context as defined in TS
24.501 [104], consisting of K~AMF~ with the associated key set identifier, the
UE security capabilities, and the uplink and downlink NAS COUNT values. This
EF also contains the EPS NAS security algorithms to be used when the UE goes
to EPS, either by means of connected mode handover in a network that supports
N26 interface, or by the means of idle mode mobility performed by the UE from
5GS to EPS, as specified in TS 33.501 [105]. .
If Service n°136 is not \"available\" in EF~UST~, the file shall contain one
record.
If service n°136 is \"available\" in EF~UST~, the file shall contain two
records. As specified in TS 33.501 [105] clause 6.3.2.1, in case of multiple
registrations in different PLMNs, each record shall store 5GS non-3GPP access
NAS security context for each different PLMN (Refer to Annex O for examples).
+----------------------+----------------------+----------+---------+ | Identifier: \'4F04\' | Structure: linear | Optional | | | | fixed | | | +======================+======================+==========+=========+ | SFI: \'04\' | | | | +----------------------+----------------------+----------+---------+ | Record size: X bytes | Update activity: | | | | (X≥57) | high | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5GS NAS Security | M | X bytes | | | Context TLV Object | | | +----------------------+----------------------+----------+---------+
For content and coding see clause 4.4.11.4 for EF~5GS3GPPNSC~.
#### 4.4.11.6 EF~5GAUTHKEYS~ (5G authentication keys)
If Service n°123 is \"available\" in EF~UST~, this file shall be present. This
EF contains K~SEAF~ for 3GPP access and the K~AUSF~ that are generated on the
ME using CK and IK as part of AKA procedures as described in TS 33.501 [105].
If Service n°133 is not \"available\" in EF~UST~, the file size is at least 68
bytes.
If Service n°133 is also \"available\" in EF~UST~, this EF additionally
contains K~SEAF~ for non-3GPP access, SOR counter and UE parameter update
counter and the file size is at least 110 bytes.
+---------------------+---------------------+----------+------------+ | Identifier: | Structure: | Optional | | | \'4F05\' | transparent | | | +=====================+=====================+==========+============+ | SFI: \'05\' | | | | +---------------------+---------------------+----------+------------+ | File size: >= 68 | Update activity: | | | | or 110 bytes | high | | | +---------------------+---------------------+----------+------------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+------------+ | Description | Value | M/O | Length | +---------------------+---------------------+----------+------------+ | K~AUSF~ Tag | \'80\' | M | 1 | +---------------------+---------------------+----------+------------+ | Length | K (Note2) | M | Note1 | +---------------------+---------------------+----------+------------+ | K~AUSF~ | -- | M | K (Note2) | +---------------------+---------------------+----------+------------+ | K~SEAF~ for 3GPP | \'81\' | M | 1 | | access Tag | | | | +---------------------+---------------------+----------+------------+ | Length | L (Note2) | M | Note1 | +---------------------+---------------------+----------+------------+ | K~SEAF~ for 3GPP | -- | M | L (Note2) | | access | | | | +---------------------+---------------------+----------+------------+ | K~SEAF~ for | \'82\' | C | 1 | | non-3GPP access Tag | | | | +---------------------+---------------------+----------+------------+ | Length | M (Note2) | C | Note1 | +---------------------+---------------------+----------+------------+ | K~SEAF~ for | -- | C | M (Note2) | | non-3GPP access | | | | +---------------------+---------------------+----------+------------+ | SOR counter Tag | \'83\' | C | 1 | +---------------------+---------------------+----------+------------+ | Length | N | C | Note 1 | +---------------------+---------------------+----------+------------+ | SOR counter | -- | C | N (Note 3) | +---------------------+---------------------+----------+------------+ | UE parameter update | \'84\' | C | 1 | | counter Tag | | | | +---------------------+---------------------+----------+------------+ | Length | O | C | Note 1 | +---------------------+---------------------+----------+------------+ | UE parameter update | -- | C | O (Note 3) | | counter | | | | +---------------------+---------------------+----------+------------+ | Note 1: The length | | | | | is coded according | | | | | to | | | | | IS | | | | | O/IEC 8825-1 [35] | | | | +---------------------+---------------------+----------+------------+ | Note 2: As per TS | | | | | 33.501 [105], the | | | | | length of keys | | | | | K~AUSF~ and K~SEAF~ | | | | | is 32 bytes each | | | | +---------------------+---------------------+----------+------------+ | Note 3: As per TS | | | | | 33.501 [105], the | | | | | length of SOR | | | | | counter and UE | | | | | parameter update | | | | | counter is 2 bytes | | | | | each | | | | +---------------------+---------------------+----------+------------+
‑ K~AUSF~ Tag \'80\'.
> Contents:
>
> \- K~AUSF~ as described in TS 33.501[105]).
>
> Coding:
\- The most significant bit of K~AUSF~ is the most significant bit of the 1st
byte of this TLV value field. The least significant bit of K~AUSF~ is the
least significant bit of the last byte of this TLV value field.
‑ K~SEAF~ for 3GPP access Tag \'81\'.
> Contents:
>
> \- K~SEAF~ for 3GPP access as described in TS 33.501[105]. If there is no
> valid K~SEAF~ for 3GPP access, the contents (Value part of the TLV) shall be
> \'FF...FF\'.
>
> Coding:
>
> \- The most significant bit of K~SEAF~ for 3GPP access is the most
> significant bit of the 1st byte of this TLV value field. The least
> significant bit of K~SEAF~ for 3GPP access is the least significant bit of
> the last byte of this TLV value field.
‑ K~SEAF~ for non-3GPP access Tag \'82\'.
> Contents:
>
> \- K~SEAF~ for non-3GPP access as specified in TS 33.501[105]. If there is
> no valid K~SEAF~ for non-3GPP access, the contents (Value part of the TLV)
> shall be \'FF...FF\'.
>
> Coding:
>
> \- The most significant bit of K~SEAF~ for non-3GPP access is the most
> significant bit of the 1st byte of this TLV value field. The least
> significant bit of K~SEAF~ for non-3GPP access is the least significant bit
> of the last byte of this TLV value field.
\- SOR counter Tag \'83\'
Contents:
\- The SOR counter as defined in 3GPP TS 33.501 [105] clause 6.14.2.3. In this
release the SOR counter is coded on 2 bytes. If there is no valid SOR counter,
the contents (Value part of the TLV) shall be \'FF...FF\'.
Coding:
\- The most significant bit of the SOR counter is the most significant bit of
the 1^st^ byte of this TLV value field. The least significant bit of the SOR
counter is the least significant bit of the last byte of this TLV value field.
\- UE parameter update counter Tag \'84\'
Contents:
\- The UE parameter update counter as defined in 3GPP TS 33.501 [105] clause
6.15.2.2. In this release the UE parameter update counter is coded on 2 bytes.
If there is no valid UE parameter update counter, the contents (Value part of
the TLV) shall be \'FF...FF\'.
Coding:
\- The most significant bit of the UE parameter update counter is the most
significant bit of the 1^st^ byte of this TLV value field. The least
significant bit of the UE parameter update counter is the least significant
bit of the last byte of this TLV value field.
#### 4.4.11.7 EF~UAC_AIC~ (UAC Access Identities Configuration)
If service n°126 is \"available\" in EF~UST~, this file shall be present.
This EF contains the configuration information pertaining to access identities
allocated for specific high priority services that can be used by the
subscriber. The assigned access identities are used, in combination with an
access category, to control the access attempts. For more information see TS
22.261 [106] and TS 24.501 [104].
+----------------------+-------------------------------------+----------+---------+ | Identifier: \'4F06\' | Structure: transparent | Optional | | +----------------------+-------------------------------------+----------+---------+ | SFI: \'06\' | | | | +----------------------+-------------------------------------+----------+---------+ | File size: 4 bytes | Update activity: low | | | +----------------------+-------------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-------------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-------------------------------------+----------+---------+ | 1 to 4 | UAC access identities configuration | M | 4 bytes | +----------------------+-------------------------------------+----------+---------+
‑ UAC access identities configuration
Contents:
‑ Configuration of certain Unified Access Control (UAC) access identities
specified in TS 24.501 [104] clause 4.5.2.
Coding:
‑ Each access identity configuration is coded on one bit.
Byte 1:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0: UE is not configured for Multimedia Priority Service in the HPLMN,EHPLMN or a visited PLMN of the home country. b1=1: UE is configured for Multimedia Priority Service in the HPLMN,EHPLMN or a visited PLMN of the home country.  
|  |  |  |  |  |  |  |  |  | b2=0: UE is not configured for Mission Critical Services in the HPLMN,EHPLMN or a visited PLMN of the home country. b2=1: UE is configured for Mission Critical Services in the HPLMN,EHPLMN or a visited PLMN of the home country.  
|  |  |  |  |  |  |  |  |  | RFU  
Bytes 2 to 4:
Bits b1 to b8 are RFU.
NOTE 1: Access Identities 11 to 15 (as specified in TS 24.501 [104]) are
configured as Access Classes 11 to 15 in EF~ACC~, specified in clause
4.2.15~.~
NOTE 2: The home country is defined as the country to which user subscription
is associated (e.g. the MCC part of the IMSI, see the definition in TS
24.301[51]).
#### 4.4.11.8 EF~SUCI_Calc_Info~ (Subscription Concealed Identifier
Calculation Information EF)
If \"SUCI calculation is to be performed by the ME\" (i.e. service n°124 is
\"available\" in EF~UST~ and service n°125 is not \"available\" in EF~UST~),
this file shall be present. This EF contains information needed by the ME for
the support of subscription identifier privacy as defined in 3GPP TS
33.501[105].
If \"SUCI calculation is to be performed by the USIM\" (i.e. service n°124 is
\"available\" in EF~UST~ and service n°125 is \"available\" in EF~UST~), this
file shall not be available to the ME.
If service n°124 is not \"available\" in EF~UST~, this file shall not be
available to the ME.
Note: How the file is made \"not available to the ME\" is implementation
specific, e.g. the file may not be present, the file may be present but not
readable by the ME, or the file may be present but deactivated.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F07\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'07\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | (X ≥ 2) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Z | Protection Scheme | M | Z bytes | | | Identifier List data | | | | | object | | | +----------------------+----------------------+----------+---------+ | Z+1 to Y+Z | Home Network Public | C | Y bytes | | | Key List data object | | | +----------------------+----------------------+----------+---------+
‑ Protection Scheme Identifier List data object.
Contents:
> This data object shall always be present. If Protection Scheme Identifier
> List data object length is not zero, this data object contains a list of the
> Protection Scheme Identifier and the corresponding Key Index. The first
> Protection Scheme Identifier entry has the highest priority and the last
> Protection Scheme Identifier entry has the lowest priority. The Key Index
> value indicates the position of the Home Network Public Key in the Home
> Network Public Key List, that is applicable to the Protection Scheme.
Coding:
+----------------------+--------+------------+----------------+ | Description | Value | M/O/C | Length (bytes) | +----------------------+--------+------------+----------------+ | Protection Scheme | \'A0\' | M | 1 | | Identifier List data | | | | | object tag | | | | +----------------------+--------+------------+----------------+ | Protection Scheme | L1 | M | Note 1 | | Identifier List data | | | | | object length | | | | +----------------------+--------+------------+----------------+ | Protection Scheme | -- | O | 1 | | Identifier 1 | | | | | (Highest priority) | | | | +----------------------+--------+------------+----------------+ | Key Index 1 | -- | C (Note 2) | 1 | +----------------------+--------+------------+----------------+ | Protection Scheme | -- | O | 1 | | Identifier 2 | | | | +----------------------+--------+------------+----------------+ | Key Index 2 | -- | C (Note 2) | 1 | +----------------------+--------+------------+----------------+ | ... | ... | ... | ... | +----------------------+--------+------------+----------------+ | Protection Scheme | -- | O | 1 | | Identifier N (Lowest | | | | | priority) | | | | +----------------------+--------+------------+----------------+ | Key Index N | -- | C (Note 2) | 1 | +----------------------+--------+------------+----------------+ | Note 1: The length | | | | | is coded according | | | | | to ISO/IEC | | | | | 8825-1 [35] | | | | | | | | | | Note 2: This field | | | | | is present only if | | | | | the corresponding | | | | | Protection Scheme | | | | | Identifier field is | | | | | present | | | | +----------------------+--------+------------+----------------+
> The Protection Scheme Identifier represents a protection scheme as described
> in 3GPP TS 33.501 [105] and it is coded in one byte as follows:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Protection Scheme identifier coded as described in 3GPP TS 24.501 \[104\]
                                                RFU, bit = 0
* * *
> The Key Index is coded in one byte such that its value indicates the
> position of the Home Network Public Key in the Home Network Public Key List
> data object, that is applicable to the Protection Scheme. A Key Index with a
> value of \"1\" refers to the first Network Public Key entry in the Home
> Network Public Key List, and so on. A Key Index with a value of \"0\"
> indicates that there is no Home Network Public Key associated with that
> Protection Scheme (e.g., in the case of null-scheme).
‑ Home Network Public Key List data object.
Contents:
> This data object contains a list of the Home Network Public Key and the
> corresponding Home Network Public Key Identifier that shall be used by the
> ME to calculate the SUCI.
>
> This data object may not be present if none of the protection scheme
> profiles identified by the Protection Scheme Identifiers included in the
> Protection Scheme Identifier List data object use the Home Network Public
> Key (e.g. null-scheme). If this data object is present, it shall contain at
> least one Home Network Public Key and the corresponding Home Network Public
> Key Identifier.
Coding:
* * *
Description Value M/O/C Length (bytes) Home Network Public Key List data
object \'A1\' C 1 Home Network Public Key List data object length L1 C Note 1
Home Network Public Key 1 Identifier tag \'80\' C 1 Home Network Public Key 1
Identifier length L2 C Note 1 Home Network Public Key 1 Identifier -- C L2
Home Network Public Key 1 tag \'81\' C 1 Home Network Public Key 1 length L3 C
Note 1 Home Network Public Key 1 -- C L3 ... ... ... ... Home Network Public
Key N Identifier tag \'80\' O 1 Home Network Public Key N Identifier length L4
O Note 1 Home Network Public Key N Identifier -- O L4 Home Network Public Key
N tag \'81\' O 1 Home Network Public Key N length L5 O Note 1 Home Network
Public Key N -- O L5 Note 1: The length is coded according to ISO/IEC 8825-1
[35]
* * *
> The Home Network Public Key Identifier may have any value in the range from
> 0 to 255 as described in 3GPP TS 23.003 [25] and it is coded in one byte as
> described in 3GPP TS 24.501 [104].
>
> The Home Network Public Key is coded in hexadecimal digits as described in
> IETF RFC 7748 [108] (for Protection Scheme Profile A) and in IETF RFC 5480
> [107] (for Protection scheme Profile B). The length of the Home Network
> Public Key depends on the Protection Scheme and the form of the Home Network
> Public Key (e.g. compressed or uncompressed).
#### 4.4.11.9 EF~OPL5G~ (5GS Operator PLMN List)
If service n°129 is \"available\", this file shall be present.
This EF contains a prioritised list of Tracking Area Identity (TAI) identities
for NG-RAN that are used to associate a specific operator name contained in
EF~PNN~ or EF~PNNI~ with the TAI. The ME shall use this EF in association with
the EF~PNN~ in place of any network name stored within the ME\'s internal list
and any network name received when registered to the PLMN, as defined by TS
24.501 [104]. The PLMN Network Name may also be provided in a graphical format
in EF~PNNI~. The ME shall use the text format or the graphical format or both
to display the service provider name according to the rules defined in clause
4.2.89.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F08\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: \'08\' | | | | +----------------------+----------------------+----------+---------+ | Record length: X | Update activity: low | | | | bytes, (X ≥ 10) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to 9 | Tracking Area | M | 9 bytes | | | Identity | | | +----------------------+----------------------+----------+---------+ | 10 | PLMN Network Name | M | 1 byte | | | Record Identifier | | | +----------------------+----------------------+----------+---------+
\- Tracking Area Identity
Contents:\ Tracking Area Identity for NG-RAN, this comprises of the MCC, MNC
and TAC
Coding:\ PLMN: according to TS 24.501 [104]\ A BCD value of \'D\' in any of
the MCC and/or MNC digits shall be used to indicate a \"wild\" value for that
corresponding MCC/MNC digit
TAC: according to TS 24.501 [104]
> Two values for the TAC are stored in order to allow a range of TAC values to
> be specified for a given PLMN. A value of \'000000\' stored in bytes 4 to 6
> and a value of \'FFFFFE\' stored in bytes 7 to 9 shall be used to indicate
> the entire range of TACs for the given PLMN. In the case where only a single
> TAC value is to be specified then the value stored in bytes 4 to 6 shall be
> identical to the value stored in bytes 7 to 9 for the given PLMN. If a range
> of TAC values are to be specified, then the value stored in bytes 4 to 6
> shall be the start of the TAC range and the value stored in bytes 7 to 9
> shall be the end of the TAC range for the given PLMN.
\- PLMN Network Name Record Identifier
Contents:\ Identifier of operator name to be displayed
Coding:\ A value of \'00\' indicates that the name is to be taken from other
sources, see TS 22.101 [24]
> A value in the range \'01\' to \'FE\' indicates the record number in EF~PNN~
> that shall be displayed as the registered PLMN name. It also indicates the
> record number in EF~PNNI~ that may be displayed as the registered PLMN name
> icon.
NOTE: The intent of this file is to provide exceptions to the other sources of
a network name. Care should be taken not to introduce too many PLMN entries.
An excessive number of entries could result in a longer initialisation period.
#### 4.4.11.10 EF~SUPI_NAI~ (SUPI as Network Access Identifier)
If service n°130 is \"available\", this file shall be present.
This EF contains the SUPI in NAI format consisting of a:
\- network specific identifier(NSI), as specified in TS 23.003 [25], when SUPI
type is NSI or
\- Global Line Identifier (GLI), as specified in TS 23.003 [25] clause
28.15.2, when SUPI type is GLI or
\- Global Cable Identifier (GCI), as specified in TS 23.003 [25] clause
28.16.2, when SUPI type is GCI,
The SUPI contained in this EF shall not be an IMSI.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F09\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'09\' | | | | +----------------------+----------------------+----------+---------+ | File size: Z bytes | Update activity: low | | | | (Z ≥ X) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | Network Access | M | X bytes | | | Identifier TLV data | | | | | object | | | +----------------------+----------------------+----------+---------+
\- Network Access Identifier TLV data object:
Contents:
\- This data object contains the Subscription Permanent Identifier in NAI
format consisting of a:
\- network specific identifier (NSI) or
\- Global Line Identifier (GLI) or
\- Global Cable Identifier (GCI).
Coding:
When SUPI type is network specific identifier:
Description Value M/O Length (bytes)
* * *
Network Specific Identifier Tag \'80\' M 1 Length L M Note Network Specific
Identifier -- M L Note: The length is coded according to ISO/IEC 8825-1 [35]
The Network Specific Identifier in NAI format is a NAI constructed as
specified in IETF RFC 7542 and encoded as UTF-8 string.
When SUPI type is Global Line Identifier:
Description Value M/O Length (bytes)
* * *
Global Line Identifier Tag \'81\' M 1 Length L M Note Global Line Identifier
-- M L Note: The length is coded according to ISO/IEC 8825-1 [35]
The Global Line Identifier as specified in TS 23.003 [25] clause 28.16.2.
When SUPI type is Global Cable Identifier (GCI):
Description Value M/O Length (bytes)
* * *
Global Cable Identifier Tag \'82\' M 1 Length L M Note Global Cable Identifier
-- M L Note: The length is coded according to ISO/IEC 8825-1 [35]
The Global Cable Identifier as specified in TS 23.003 [25] clause 28.15.2.
NOTE 1: The length is coded according to ISO/IEC 8825-1 [35]
#### 4.4.11.11 EF~Routing_Indicator~ (Routing Indicator EF)
If service n°124 is \"available\" in EF~UST~, this file shall be present. This
EF contains Routing Indicator needed by the ME or by the USIM for SUCI
calculation.
+----------------------+------------------------+----------+---------+ | Identifier: \'4F0A\' | Structure: transparent | Optional | | +======================+========================+==========+=========+ | SFI: \'0A\' | | | | +----------------------+------------------------+----------+---------+ | File size: 4 bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 to 4 | Routing Indicator | M | 4 bytes | +----------------------+------------------------+----------+---------+
‑ Routing Indicator
Contents:
> This EF contains Routing Indicator that allows together with the MCC and MNC
> to route network signalling with SUCI to AUSF and UDM instances capable to
> serve the subscriber, as specified in 3GPP TS 23.003 [25].
Coding:
Bytes 1 to 2:
> The Routing Indicator is coded in 2 bytes as specified in 3GPP TS 24.501
> [104]. This EF shall contain at least one valid digit of Routing ID even if
> that only digit is set to 0 (which is the case when the HPLMN intends to not
> configure a valid Routing Indicator in the USIM), as specified in 3GPP TS
> 24.501 [104].
Bytes 3 to 4:
> RFU.
#### 4.4.11.12 EF~URSP~ (URSP)
If service n°132 is \"available\" in EF~UST~, this file shall be present. This
EF contains UE Route Selection Policies per PLMN. The format of the UE Route
Selection Policies are specified in 3GPP TS 24.526 [109].
+------------------+------------------+----------+------------------+ | Identifier: | Structure: | Optional | | | \'4F0B\' | BER-TLV | | | +==================+==================+==========+==================+ | SFI: Optional | | | | +------------------+------------------+----------+------------------+ | File size: > | Update activity: | | | | (L0 + | low | | | | X1+X2+...+XN | | | | | | | | | | +L1+L2+...+LN | | | | | | | | | | + 3 x N) bytes | | | | +------------------+------------------+----------+------------------+ | Access | | | | | Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------+------------------+----------+------------------+ | Bytes | Description | M/O | Length | +------------------+------------------+----------+------------------+ | 1 to L0 +1 | URSP Rules data | O | L0 +1 | | +X1+X2+...+XN | object | | +X1+X2+...+XN | | | | | | | +L1+L2+...+LN | | | +L1+L2+...+LN | | | | | | | + 3 x N | | | + 3 x N | +------------------+------------------+----------+------------------+
\- URSP Rules data object coded as follows:
+----------------------+---------------+-----+-----------------+ | Description | Value | M/O | Length | +======================+===============+=====+=================+ | URSP Rules data | \'80\' | O | 1 byte | | object tag | | | | +----------------------+---------------+-----+-----------------+ | URSP Rules length | X1+X2+...+XN | O | L0 bytes (note) | | | | | | | | +L1+L2+...+LN | | | | | | | | | | + 3 x N | | | +----------------------+---------------+-----+-----------------+ | PLMN 1 | | O | 3 bytes | +----------------------+---------------+-----+-----------------+ | Total length of URSP | X1 | O | L1 bytes (note) | | rules for PLMN 1 | | | | +----------------------+---------------+-----+-----------------+ | UE Route Selection | | O | X1 bytes | | Policy rules for | | | | | PLMN 1 | | | | +----------------------+---------------+-----+-----------------+ | PLMN 2 | | O | 3 bytes | +----------------------+---------------+-----+-----------------+ | Length of URSP rules | X2 | O | L2 bytes (note) | | for PLMN 2 | | | | +----------------------+---------------+-----+-----------------+ | UE Route Selection | | O | X2 bytes | | Policy rules for | | | | | PLMN 2 | | | | +----------------------+---------------+-----+-----------------+ | ... | | | | +----------------------+---------------+-----+-----------------+ | PLMN N | | O | 3 bytes | +----------------------+---------------+-----+-----------------+ | Length of URSP rules | XN | O | LN bytes (note) | | for PLMN N | | | | +----------------------+---------------+-----+-----------------+ | UE Route Selection | | O | XN bytes | | Policy rules for | | | | | PLMN N | | | | +----------------------+---------------+-----+-----------------+ | Note: The length is | | | | | coded according to | | | | | ISO/IEC | | | | | 8825-1 [35]. | | | | +----------------------+---------------+-----+-----------------+
‑ PLMN
Contents:
\- Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
\- According to TS 24.008 [9].
\- Total length of URSP rules
Contents:
\- This field contains the Total length of URSP rules for this PLMN.
Coding:
\- The length is coded according to ISO/IEC 8825-1 [35].
\- UE Route Selection Policy rules for this PLMN
Contents:
\- UE Route Selection Policies used by the UE to determine how to route
outgoing traffic.
Coding:
\- The coding of the URSP rules is specified in clause 5.2 and URSP rule is
encoded as shown in figures 5.2.1 to 5.2.4 and table 5.2.1 of 3GPP TS 24.526
[109].
#### 4.4.11.13 EF~TN3GPPSNN~ (Trusted non-3GPP Serving network names list)
If service n°135 is \"available\" in EF~UST~, this file shall be present.
This EF contains the coding for n Serving network name TLV data objects, n is
determined by the operator.
This information is determined by the home network operator as specified in TS
33.501 [105] (see clause 7.1a).
+---------------------+---------------------+----------+------------+ | Identifier: | Structure: | Optional | | | \'4F0C\' | transparent | | | +---------------------+---------------------+----------+------------+ | SFI: \'0C \' | | | | +---------------------+---------------------+----------+------------+ | File size: Z (>=1) | Update activity: | | | | bytes | low | | | +---------------------+---------------------+----------+------------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+------------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+------------+ | 1 | Number of Serving | M | 1 | | | network name TLV | | | | | data objects (n) | | | +---------------------+---------------------+----------+------------+ | 2 to X~1~+1 | 1^st^ Serving | O | X~1~ bytes | | | network name TLV | | | | | data object | | | +---------------------+---------------------+----------+------------+ | ... | | | | +---------------------+---------------------+----------+------------+ | 2+X~1~+..+X~n-1~ | N^th^ Serving | O | X~n~ bytes | | | network name TLV | | | | | data object | | | +---------------------+---------------------+----------+------------+
\- Number of Serving network name TLV data objects
Contents:
\- Number of TLV data objects coded in the file
\- Serving network name TLV data object
Contents:
\- This data object contains Serving network name for Trusted non-3GPP access
network
Coding:
* * *
Description Value M/O/C Length (bytes) Serving network name tag \'80\' M 1
Length X M Note Serving network name -- M X Note: The length is coded
according to ISO/IEC 8825-1 [35]
* * *
\- The serving network name is defined as specified in TS 33.501 [105] (see
clauses 6.1.1.4) and shall be encoded to an octet string according to UTF-8
encoding rules as specified in IETF RFC 3629 [48]
#### 4.4.11.14 EF~CAG~ (Pre-configured CAG information list EF)
If service n°137 is \"available\" in EF~UST~, this file shall be present. This
EF contains a pre-configured CAG information list used by the ME as specified
in 3GPP TS 23.122 [31] clause 3.8.
+---------------------+---------------------+----------+------------+ | Identifier: | Structure: | Optional | | | \'4F0D\' | transparent | | | +---------------------+---------------------+----------+------------+ | SFI: \'0D\' | | | | +---------------------+---------------------+----------+------------+ | File size: Z (>=2) | Update activity: | | | | bytes | low | | | +---------------------+---------------------+----------+------------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +---------------------+---------------------+----------+------------+ | Bytes | Description | M/O | Length | +---------------------+---------------------+----------+------------+ | 1 to 2 | Length of CAG | M | 2 | | | information list | | | | | entries | | | +---------------------+---------------------+----------+------------+ | 3 to 2+X~1~ | 1^st^ CAG | O | X~1~ bytes | | | information list | | | | | entry | | | +---------------------+---------------------+----------+------------+ | ... | | | | +---------------------+---------------------+----------+------------+ | 3+X~1~+..+X~N-1~ | N^th^ CAG | O | X~N~ bytes | | | information list | | | | to | entry | | | | | | | | | 2+X~1~+...+X~N~ | | | | +---------------------+---------------------+----------+------------+
Length of CAG information list entries
Contents:
\- Total length of all the CAG information list entries that follow
\- CAG information list entry
Contents:
\- Each CAG information list entry contains either:
i) an entry in the CAG information list , the coding of which is specified in
3GPP TS 24.501 [104] clause 9.11.3.18A, Figure 9.11.3.18A.2 and Table
9.11.3.18A.1;or
ii) an entry for HPLMN or EHPLMN including a CAG-ID range, the coding of which
is as shown below.
+-------+-------+-------+-------+-------+-------+-------+------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | L | octet | | | | | | | | | ength | 3+X | | | | | | | | | of | ~1~+\ | | | | | | | | | entry | ...+X | | | | | | | | | incl | ~m-1~ | | | | | | | | | uding | | | | | | | | | | a | | | | | | | | | | C | | | | | | | | | | AG-ID | | | | | | | | | | range | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MCC | MCC | octet | | | | | | | | digit | digit | 4+X | | | | | | | | 2 | 1 | ~1~+\ | | | | | | | | | | ...+X | | | | | | | | | | ~m-1~ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MNC | MCC | octet | | | | | | | | digit | digit | 5+X | | | | | | | | 3 | 3 | ~1~+\ | | | | | | | | | | ...+X | | | | | | | | | | ~m-1~ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | MNC | MNC | octet | | | | | | | | digit | digit | 6+X | | | | | | | | 2 | 1 | ~1~+\ | | | | | | | | | | ...+X | | | | | | | | | | ~m-1~ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 1 | CAG | octet | | | | | | | | | | 7+X | | Spare | Spare | Spare | Spare | Spare | Spare | N | only | ~1~+\ | | | | | | | | OTE 1 | | ...+X | | | | | | | | | | ~m-1~ | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | C | octet | | | | | | | | | AG-ID | 8+X | | | | | | | | | range | ~1~+\ | | | | | | | | | | ...+X | | | | | | | | | | ~m-1~ | | | | | | | | | | | | | | | | | | | | octet | | | | | | | | | | 15+X | | | | | | | | | | ~1~+\ | | | | | | | | | | ...+X | | | | | | | | | | ~m-1~ | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+
where:
a) MCC digits 1 to 3, MNC digits 1 to 3, and CAG only bit, are encoded as
corresponding fields of an entry in the CAG information list; and
b) a CAG-ID range contains two CAG-IDs. The coding of the CAG-ID is defined as
the CAG-Identifier in 3GPP TS 23.003 [25]. It shall be considered that all
CAG-IDs in the CAG-ID range between the first CAG-ID and the second CAG-ID
including the first and second CAG-IDs are allowed.
NOTE 1: Bit 2 in octet 7+X~1~+...+X~m-1~ is set to \'1\' to indicate a range
of CAG ID\'s see 3GPP TS 24.501 [104].
#### 4.4.11.15 EF~SOR-CMCI~ (Steering Of Roaming - Connected Mode Control
Information)
If service n°138 is \"available\" in EF~UST~, this file shall be present.
This EF contains SOR-CMCI parameters as specified in 3GPP TS 24.501 [104]
+----------------------------+------------------------+----------+---------+ | Identifier: \'4F0E\' | Structure: transparent | Optional | | +----------------------------+------------------------+----------+---------+ | SFI: \'0E\' | | | | +----------------------------+------------------------+----------+---------+ | File size: Z bytes (Z ≥ X) | Update activity: low | | | +----------------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------------+------------------------+----------+---------+ | 1 to X | SOR-CMCI data object | O | X bytes | +----------------------------+------------------------+----------+---------+
‑ SOR-CMCI data object
Coding of the SOR-CMCI data object
* * *
Length Description Coding Status 1 SOR-CMCI data object tag '80' O 1 to L (L ≤
4) SOR-CMCI data object length As defined in TS 31.101 [11] for BER-TLV
structured files O X-1-L bytes SOR-CMCI parameters As specified in TS 24.501
[104] clause 9.11.3.51 and start from octet (o+3) of SOR-CMCI as defined in
Figure 9.11.3.51.7 of TS 24.501 [104]. O
* * *
As defined in 3GPP TS 23.122 [31] clause C.4.1, \'no SOR-CMCI rule\' is
defined when:
\- SOR-CMCI data object is not present; or
\- SOR-CMCI data object is zero length
> Then UE behaviour described in 3GPP TS 23.122 [31] clause C.4.2 applies.
#### 4.4.11.16 Void
##### 4.4.11.16.1 Void
##### 4.4.11.16.2 Void
##### 4.4.11.16.3 Void
##### 4.4.11.16.4 Void
##### 4.4.11.16.5 Void
##### 4.4.11.16.6 Void
#### 4.4.11.17 EF~DRI~ (Disaster roaming information EF)
If service n°140 is \"available\" in EF~UST~, this file shall be present.
This EF contains the indication of whether disaster roaming is enabled in the
UE as specified in 3GPP TS 23.122 [31].\ In addition it contains disaster
roaming parameters indicating availability of each related information field.\
Further it contains disaster roaming wait range as specified in 3GPP TS 23.122
[31], disaster return wait range as specified in 3GPP TS 23.122 [31] and the
indication of \'applicability of \"lists of PLMN(s) to be used in disaster
condition\" provided by a VPLMN\' from the USIM into the ME, as specified in
3GPP TS 24.501 [104] annex C.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F0F\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | SFI: \'0F\' | | | | +----------------------+----------------------+----------+---------+ | File size: ≥ 7 bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Disaster roaming is | M | 1 byte | | | enabled | | | +----------------------+----------------------+----------+---------+ | 2 | Disaster roaming | M | 1 byte | | | parameters indicator | | | | | status | | | +----------------------+----------------------+----------+---------+ | 3 to 4 | Disaster roaming | M | 2 bytes | | | wait range | | | +----------------------+----------------------+----------+---------+ | 5 to 6 | Disaster return wait | M | 2 bytes | | | range | | | +----------------------+----------------------+----------+---------+ | 7 | Applicability | M | 1 byte | | | indicator for \"list | | | | | of PLMN(s) to be | | | | | used in disaster | | | | | condition\" provided | | | | | by VPLMN | | | +----------------------+----------------------+----------+---------+
Storage is allocated for all of the possible disaster roaming parameters,
regardless of whether they are present or absent. Any bytes unused, due to
parameters not requiring all of the bytes, or due to absent parameters, shall
be set to \'FF\'.
> ‑ Disaster roaming is enabled
Coding:
> The indication of whether disaster roaming is enabled, it is coded in one
> byte as follows:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Indication of whether disaster roaming is enabled as described in 3GPP TS 24.501 \[104\]
                                                RFU, bit = 0
* * *
‑ Disaster roaming parameters indicator status
Contents:
Each of the disaster roaming information parameters which can be stored in the
remainder of the record are marked absent or present by individual bits within
this byte.
Coding:
allocation of bits:
bit number Parameter indicated.
1 Disaster roaming wait range.
2 Disaster return wait range
3 Applicability indicator for \"list of PLMN(s) to be used in disaster
condition\" provided by VPLMN.
4 reserved, set to 1.
5 reserved, set to 1.
6 reserved, set to 1.
7 reserved, set to 1.
8 reserved, set to 1.
Bit value Meaning.
0 Parameter present.
1 Parameter absent.
> ‑ Disaster roaming wait range
Coding:
> The disaster roaming wait range is coded as specified in 3GPP TS 24.501
> [104] clause 9.11.3.84 and starts from octet 3 of the registration wait
> range as defined in Figure 9.11.3.84.1 of 3GPP TS 24.501 [104].
>
> ‑ Disaster return wait range
Coding:
> The disaster return wait range is coded as specified in 3GPP TS 24.501 [104]
> clause 9.11.3.84 and starts from octet 3 of the registration wait range as
> defined in Figure 9.11.3.84.1 of 3GPP TS 24.501 [104].
>
> ‑ Applicability indicator for \"list of PLMN(s) to be used in disaster
> condition\" provided by VPLMN
>
> Coding:
>
> The applicability indicator for \"list of PLMN(s) to be used in disaster
> condition\" provided by VPLMN is coded as specified in 3GPP TS 24.501 [104].
#### 4.4.11.18 EF~5GSEDRX~ (5GS eDRX Parameters)
If service n°141 is \"available\" in EF~UST~, this file shall be present.
This EF contains the following 5GS eDRX parameters:
‑ ratType: Radio Access Technology Type;
‑ edrxValue: Extended idle mode DRX cycle length.
+-----------------------+-----------------------+----------+--------+ | Identifier: \'4F10\' | Structure: | Optional | | | | transparent | | | +-----------------------+-----------------------+----------+--------+ | SFI: \'10\' | | | | +-----------------------+-----------------------+----------+--------+ | File size: X bytes, | Update activity: low | | | | (X ≥ 2) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | 5GS ratType | M | 1 byte | +-----------------------+-----------------------+----------+--------+ | 2 | The extended idle | M | 1 byte | | | mode DRX cycle length | | | | | value | | | +-----------------------+-----------------------+----------+--------+
‑ 5GS ratType.
> Contents:
The NG-RAN rat type which eDRX values are applicable to.
> Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | 1:the rat type is NG-RAN 0:RFU  
|  |  |  |  |  |  |  |  |  | 1:the rat type is Satellite NG-RAN 0:RFU  
|  |  |  |  |  |  |  |  |  | RFU  
‑ The extended idle mode DRX cycle length value.
Contents:
The extended idle mode DRX cycle length value.
Coding:
> This data object contains the extended idle mode DRX cycle length value, the
> coding of which is specified in 3GPP TS 24.008 table 10.5.5.32.
#### 4.4.11.19 EF~5GNSWO_CONF~ (5G Non-Seamless WLAN Offload configuration)
If service n°142 is \"available\", this file shall be present.
This EF contains 5G Non-Seamless WLAN Offload configuration related
information.
If the 5G Non-Seamless WLAN Offload usage Indicator is enabled ME shall always
use 5G NSWO as in TS 33.501 [105] (i.e., it shall not use EPS NSWO).
+-----------------------+-----------------------+----------+--------+ | Identifier: \'4F11\' | Structure: | Optional | | | | transparent | | | +-----------------------+-----------------------+----------+--------+ | SFI: \'11\' | | | | +-----------------------+-----------------------+----------+--------+ | File size: >= 1 byte | Update activity: low | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | 5G Non-Seamless WLAN | M | 1byte | | | Offload usage | | | | | Indicator | | | +-----------------------+-----------------------+----------+--------+
\- 5G Non-Seamless WLAN Offload usage Indicator:
> Contents:
5G Non-Seamless WLAN Offload usage Indicator
> Coding:
\- \'00\' -- 5G Non-Seamless WLAN Offload usage Indicator is disabled
\- \'01\' --5G Non-Seamless WLAN Offload usage Indicator is enabled
\- All other values are RFU
#### 4.4.11.20 EF~MCHPPLMN~ (Multiplier Coefficient for Higher Priority PLMN
search)
If service n°144 is \"available\" in EF~UST~, this file shall be available.
This EF contains a multiplier coefficient which is used together with timer
interval configured in EF~HPPLMN~ to adjust the interval of time between two
searches for a higher priority PLMN via NG-RAN satellite access (see 3GPP TS
23.122 [31]).
+-----------------------+-----------------------+----------+--------+ | Identifier: \'4F15\' | Structure: | Optional | | | | transparent | | | +-----------------------+-----------------------+----------+--------+ | SFI: \'15\' | | | | +-----------------------+-----------------------+----------+--------+ | File size: X bytes, | Update activity: low | | | | (X ≥ 1) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | Multiplier | M | 1 byte | | | coefficient for | | | | | higher priority PLMN | | | | | search | | | +-----------------------+-----------------------+----------+--------+
‑ Multiplier coefficient.
Contents:
The multiplier coefficient to adjust the time interval for higher priority
PLMN search.
Coding:
For UEs supporting satellite NG-RAN access as specified in 3GPP TS 23.122
[31], the multiplier coefficient is coded as an unsigned byte. The range is
from one to a maximum value of 255. The encoding is:
‑ \'00\': Not defined.
‑ \'01\': 1;
‑ \'02\': 2;
‑ : :
‑ \'FF\': 255; (maximum value).
#### 4.4.11.21 EF~KAUSF_DERIVATION~ (K~AUSF~ derivation configuration)
If service n°145 is \"available\", this file shall be present. This EF
contains the configuration parameter for K~AUSF~ derivation, as defined in TS
33.501 [105].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F16\' | Structure: | Optional | | | | transparent | | | +======================+======================+==========+=========+ | SFI: '16' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | (X ≥ 1) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | K~AUSF~ derivation | M | 1 byte | | | configuration | | | +----------------------+----------------------+----------+---------+ | 2 to X | RFU | O | X bytes | +----------------------+----------------------+----------+---------+
Contents:
Configuration for K~AUSF~ derivation
Coding:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | KAUSF derivation configuration in SNPN: b1=0 Use EMSK for derivation of KAUSF in SNPN b1=1 Use MSK for derivation of KAUSF in SNPN  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
### 4.4.12 Contents of files at the DF SNPN level
#### 4.4.12.1 Introduction
This clause describes the files that are specific for Standalone Non-Public
Networks (SNPNs).
DF~SNPN~ shall be present at the ADF~USIM~ level if any of the following
services are \"available\" in EF~UST~ (USIM Service Table):
* * *
Service n°143 PWS configuration for SNPN in USIM Service n°146 Network
Identifier for SNPN (NID)
* * *
#### 4.4.12.2 EF~PWS_SNPN~ (Public Warning System in SNPNs)
If service n°143 is \"available\", this file shall be present. This EF
contains the configuration parameters for PWS in SNPNs, as defined in TS
23.122 [31].
+----------------------------+---------------------------+----------+--------+ | Identifier: \'4F01\' | Structure: transparent | Optional | | +============================+===========================+==========+========+ | SFI: '01' | | | | +----------------------------+---------------------------+----------+--------+ | File size: X bytes (X ≥ 1) | Update activity: low | | | +----------------------------+---------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | ACTIVATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | +----------------------------+---------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------------+---------------------------+----------+--------+ | 1 | PWS configuration in SNPN | M | 1 byte | +----------------------------+---------------------------+----------+--------+
Contents:
Configuration for PWS in SNPNs
First byte:
|  | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | b1=0 process all PWS warning messages in subscribed SNPN b1=1 ignore all PWS warning messages in subscribed SNPN  
|  |  |  |  |  |  |  |  |  | b2=0 process all PWS warning messages in non-subscibed SNPNs b2=1 ignore all PWS warning messages in non-subscribed SNPNs  
|  |  |  |  |  |  |  |  |  | RFU (see TS 31.101 [11])  
RFU (see TS 31.101 [11])
#### 4.4.12.3 EF~NID~ (Network Identifier for SNPN)
If service n°146 is \"available\", this file shall be present. This file
contains a network identifier for SNPN as specified in 3GPP TS 23.003 [25]
+----------------------+--------------------------+----------+---------+ | Identifier: \'4F02\' | Structure: linear fixed | Optional | | +----------------------+--------------------------+----------+---------+ | SFI: '02' | | | | +----------------------+--------------------------+----------+---------+ | Record size: 6 bytes | Update activity: low | | | +----------------------+--------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+--------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+--------------------------+----------+---------+ | 1 | Assignment mode | M | 1 byte | +----------------------+--------------------------+----------+---------+ | 2-6 | Network Identifier value | M | 5 bytes | +----------------------+--------------------------+----------+---------+
Contents:
\- Assignment mode:
Contents:
\- The assignment mode for the network identifier for SNPN as specified in
3GPP TS 23.003 [25].
Coding:
\- The assignment mode is coded as one hexadecimal value according to 3GPP TS
23.003 [25]. The 4 most significant bits in the Assignment mode byte shall be
ignored by the ME.
* * *
Value Assignment mode \'00\' Coordinated assignment; option 1 \'01\' Self
assignment \'02\' Coordinated assignment; option 2 All other values are
reserved
* * *
\- Network identifier for SNPN value:
Contents and coding see 3GPP TS 23.003 [25].
### 4.4.13 Contents of files at the DF 5G ProSe level
#### 4.4.13.1 Introduction
This clause describes the additional files that are used for 5G ProSe
purposes. The EFs in the Dedicated File DF~5G_ProSe~ contain configuration
data related to 5G ProSe, as specified in 3GPP TS 24.554 [114].
DF~5G_ProSe~ shall be present at the ADF~USIM~ level if service nº139 is
\"available\" in EF~UST~.
#### 4.4.13.2 EF~5G_PROSE_ST~ (5G ProSe Service Table)
If service n°139 is \"available\" in the USIM Service Table, this file shall
be present. This EF indicates which 5G ProSe services are available. If a
service is not indicated as available in the 5G ProSe Service Table, the ME
shall not select this service.
+-----------------------------+-----------------------------+----------+--------+ | Identifier: \'4F01\' | Structure: transparent | Optional | | +=============================+=============================+==========+========+ | SFI: \'01\' | | | | +-----------------------------+-----------------------------+----------+--------+ | File size: X bytes, (X ≥ 1) | Update activity: low | | | +-----------------------------+-----------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------------+-----------------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------------+-----------------------------+----------+--------+ | 1 | Services n°1 to n°8 | M | 1 byte | +-----------------------------+-----------------------------+----------+--------+ | 2 | Services n°9 to n°16 | O | 1 byte | +-----------------------------+-----------------------------+----------+--------+ | etc. | | | | +-----------------------------+-----------------------------+----------+--------+ | X | Services n°(8X‑7) to n°(8X) | O | 1 byte | +-----------------------------+-----------------------------+----------+--------+
+-------------+--------------+---------------------------------------+ | > Services | | | +=============+==============+=======================================+ | > Contents: | Service n°1: | 5G ProSe configuration data for | | | | direct discovery | +-------------+--------------+---------------------------------------+ | | Service n°2: | 5G ProSe configuration data for | | | | direct communication | +-------------+--------------+---------------------------------------+ | | Service n°3: | 5G ProSe configuration data for | | | | UE-to-network relay UE | +-------------+--------------+---------------------------------------+ | | Service n°4: | 5G ProSe configuration data for | | | | remote UE | +-------------+--------------+---------------------------------------+ | | Service n°5: | 5G ProSe configuration data for usage | | | | information reporting | +-------------+--------------+---------------------------------------+
The EF shall contain at least one byte for services. Further bytes may be
included, but if the EF includes an optional byte, then it is mandatory for
the EF to also contain all bytes before that byte. Other services are possible
in the future and will be coded on further bytes in the EF.
Coding:
> Same as coding of USIM Service Table.
#### 4.4.13.3 EF~5G_PROSE_DD~ (5G ProSe configuration data for direct
discovery)
If service n°139 is \"available\" in the USIM Service Table and service n°1 is
\"available\" in EF~5G_PROSE_ST~, this file shall be present. This EF contains
5G ProSe policy for direct discovery. The format of the 5G ProSe policy for
direct discovery are specified in 3GPP TS 24.555 [115].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F02\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: \'02\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes, | Update activity: low | | | | (X ≥ 26) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5G ProSe | M | X bytes | | | configuration data | | | | | for direct discovery | | | | | TLV objects | | | +----------------------+----------------------+----------+---------+
The 5G ProSe configuration data for direct discovery data object parameters
tags:
* * *
Description Tag Value 5G ProSe configuration data for direct discovery Tag
\'A0\' Served by NG-RAN Tag \'80\' Not served by NG-RAN Tag \'81\' ProSe
identifiers Tag \'82\' ProSe identifier to default destination layer-2 ID for
initial discovery signalling mapping rules Tag \'83\' Group member discovery
parameters Tag \'84\' Validity timer Tag \'85\' ProSe direct discovery UE ID
Tag \'86\' HPLMN 5G DDNMF address information Tag \'98\'
* * *
The 5G ProSe configuration data for direct discovery contents:
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | 5G ProSe configuration | \'A0\' | M | 1 | | data for direct | | | | | discovery Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer Tag | \'85\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 5 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer | -- | M | 5 | | information | | | | +-------------------------+--------+-----+----------------+ | Served by NG-RAN Tag | \'80\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Served by NG-RAN | -- | M | X1 | | information | | | | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | \'81\' | M | 1 | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X2 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | -- | M | X2 | | information | | | | +-------------------------+--------+-----+----------------+ | ProSe direct discovery | \'86\' | M | 1 | | UE ID Tag | | | | +-------------------------+--------+-----+----------------+ | Length | 3 | M | Note 2 | +-------------------------+--------+-----+----------------+ | ProSe direct discovery | -- | M | 3 | | UE ID information | | | | +-------------------------+--------+-----+----------------+ | ProSe identifiers Tag | \'82\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X3 | M | Note 2 | +-------------------------+--------+-----+----------------+ | ProSe identifiers | -- | M | X3 | | information | | | | +-------------------------+--------+-----+----------------+ | ProSe identifier to | \'83\' | M | 1 | | default destination | | | | | layer-2 ID for initial | | | | | discovery signalling | | | | | mapping rules Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X4 | M | Note 2 | +-------------------------+--------+-----+----------------+ | ProSe identifier to | -- | M | X4 | | default destination | | | | | layer-2 ID for initial | | | | | discovery signalling | | | | | mapping rules | | | | | information | | | | +-------------------------+--------+-----+----------------+ | Group member discovery | \'84\' | O | 1 | | parameters Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X5 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Group member discovery | -- | O | X5 | | parameters information | | | | +-------------------------+--------+-----+----------------+ | HPLMN 5G DDNMF address | \'98\' | O | 1 | | information Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X6+1 | O | Note 2 | +-------------------------+--------+-----+----------------+ | HPLMN 5G DDNMF address | -- | O | 1 | | information type | | | | +-------------------------+--------+-----+----------------+ | HPLMN 5G DDNMF address | -- | O | X6 | | information information | | | | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | +-------------------------+--------+-----+----------------+
\- Validity timer Tag \'85\'
Contents:
> The Validity timer information contains the timer for controlling the
> validity of 5G ProSe configuration data for direct discovery.
Coding:
> The Validity timer information is encoded as shown in figure 5.3.2.1 and
> table 5.3.2.1 of 3GPP TS 24.555 [115].
\- Served by NG-RAN Tag \'80\'
Contents:
> The Served by NG-RAN information contains 5G ProSe configuration parameters
> for direct discovery when the UE is served by NG-RAN.
Coding:
> The Served by NG-RAN information is encoded as shown in figures 5.3.2.2 to
> 5.3.2.5 and tables 5.3.2.2 to 5.3.2.5 of 3GPP TS 24.555 [115].
\- Not served by NG-RAN Tag \'81\'
Contents:
> The Not served by NG-RAN information contains 5G ProSe configuration
> parameters for direct discovery when the UE is not served by NG-RAN.
Coding:
> The Not served by NG-RAN information is encoded as shown in figures 5.3.2.6
> to 5.3.2.11a and tables 5.3.2.6 to 5.3.2.11a of 3GPP TS 24.555 [115].
\- ProSe direct discovery UE ID
Contents:
> The ProSe direct discovery UE ID information contains ProSe direct discovery
> UE ID for restricted direct discovery.
Coding:
> The ProSe direct discovery UE ID information is encoded as shown in figure
> 5.3.2.1 and table 5.3.2.1 of 3GPP TS 24.555 [115].
\- ProSe identifiers Tag \'82\'
Contents:
> The ProSe identifiers information contains ProSe application identifiers to
> be used for direct discovery.
Coding:
> The ProSe identifiers information is encoded as shown in figure 5.3.2.14 and
> table 5.3.2.14 of 3GPP TS 24.555 [115].
\- ProSe identifier to default destination layer-2 ID for initial discovery
signalling mapping rules Tag \'83\'
Contents:
> The ProSe identifier to default destination layer-2 ID for initial discovery
> signalling mapping rules information contains a list of ProSe identifier to
> default destination layer-2 ID for initial discovery signalling mapping
> rules.
Coding:
> The ProSe identifier to default destination layer-2 ID for initial discovery
> signalling mapping rules information is encoded as shown in figures 5.3.2.15
> to 5.3.2.16 and tables 5.3.2.15 to 5.3.2.16 of 3GPP TS 24.555 [115].
\- Group member discovery parameters Tag \'84\'
Contents:
> The Group member discovery parameters information contains group member
> discovery parameters.
Coding:
> The Group member discovery parameters information is encoded as shown in
> figures 5.3.2.12 to 5.3.2.13 and tables 5.3.2.12 to 5.3.2.13 of 3GPP TS
> 24.555 [115].
\- HPLMN 5G DDNMF address information Tag \'98\'
Contents:
> The HPLMN 5G DDNMF address information information contains the HPLMN 5G
> DDNMF address information type and the HPLMN 5G DDNMF address information.
Coding:
> The HPLMN 5G DDNMF address information type indicates the type of the HPLMN
> 5G DDNMF address information. A value of \'00\' indicates FQDN, a value of
> \'01\' indicates IPv4, a value of \'02\' indicates IPv6, a value of \'03\'
> indicates IPv4v6. All other values are reserved.
>
> The HPLMN 5G DDNMF address information information is encoded as shown in
> figures 5.3.2.17 and tables 5.3.2.17 of 3GPP TS 24.555 [115].
#### 4.4.13.4 EF~5G_PROSE_DC~ (5G ProSe configuration data for direct
communication)
If service n°139 is \"available\" in the USIM Service Table and service n°2 is
\"available\" in EF~5G_PROSE_ST~, this file shall be present. This EF contains
5G ProSe policy for direct communication. The format of the 5G ProSe policy
for direct communication are specified in 3GPP TS 24.555 [115].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F03\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: \'03\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | bytes, (X ≥ 12) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5G ProSe | M | X bytes | | | configuration data | | | | | for direct | | | | | communication TLV | | | | | objects | | | +----------------------+----------------------+----------+---------+
The 5G ProSe configuration data for direct communication data object
parameters tags:
* * *
Description Tag Value 5G ProSe configuration data for direct communication Tag
\'A0\' Served by NG-RAN Tag \'80\' Not served by NG-RAN Tag \'81\' Privacy
config Tag \'87\' 5G ProSe direct communication in NR-PC5 Tag \'88\' ProSe
application to path preference mapping rules Tag \'89\' Validity timer Tag
\'85\' ProSe identifiers to NR Tx profile for broadcast and groupcast mapping
rules Tag \'91\'
* * *
The 5G ProSe configuration data for direct communication contents:
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | 5G ProSe configuration | \'A0\' | M | 1 | | data for direct | | | | | communication Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer Tag | \'85\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 5 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer | -- | M | 5 | | information | | | | +-------------------------+--------+-----+----------------+ | Served by NG-RAN Tag | \'80\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Served by NG-RAN | -- | M | X1 | | information | | | | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | \'81\' | O | 1 | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X2 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | -- | O | X2 | | information | | | | +-------------------------+--------+-----+----------------+ | Privacy config Tag | \'87\' | O | 1 | +-------------------------+--------+-----+----------------+ | Length | X3 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Privacy config | -- | O | X3 | | information | | | | +-------------------------+--------+-----+----------------+ | 5G ProSe direct | \'88\' | O | 1 | | communication in NR-PC5 | | | | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X4 | O | Note 2 | +-------------------------+--------+-----+----------------+ | 5G ProSe direct | -- | O | X4 | | communication in NR-PC5 | | | | | information | | | | +-------------------------+--------+-----+----------------+ | ProSe application to | \'89\' | O | 1 | | path preference mapping | | | | | rules Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X5 | O | Note 2 | +-------------------------+--------+-----+----------------+ | ProSe application to | -- | O | X5 | | path preference mapping | | | | | rules information | | | | +-------------------------+--------+-----+----------------+ | ProSe identifiers to NR | \'91\' | O | 1 | | Tx profile for | | | | | broadcast and groupcast | | | | | mapping rules Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X6 | O | Note 2 | +-------------------------+--------+-----+----------------+ | ProSe identifiers to NR | -- | O | X6 | | Tx profile for | | | | | broadcast and groupcast | | | | | mapping rules | | | | | information | | | | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | +-------------------------+--------+-----+----------------+
\- Validity timer Tag \'85\'
Contents:
> The Validity timer information contains the timer for controlling the
> validity of 5G ProSe configuration data for direct communication.
Coding:
> The Validity timer information is encoded as shown in figure 5.4.2.1 and
> table 5.4.2.1 of 3GPP TS 24.555 [115].
\- Served by NG-RAN Tag \'80\'
Contents:
> The Served by NG-RAN information contains 5G ProSe configuration parameters
> for direct communication when the UE is served by NG-RAN.
Coding:
> The Served by NG-RAN information is encoded as shown in figures 5.4.2.2 to
> 5.4.2.4 and tables 5.4.2.2 to 5.4.2.4 of 3GPP TS 24.555 [115].
\- Not served by NG-RAN Tag \'81\'
Contents:
> The Not served by NG-RAN information contains 5G ProSe configuration
> parameters for direct communication when the UE is not served by NG-RAN.
Coding:
> The Not served by NG-RAN information is encoded as shown in figures 5.4.2.5
> to 5.4.2.10c and tables 5.4.2.5 to 5.4.2.10c of 3GPP TS 24.555 [115].
\- Privacy config Tag \'87\'
Contents:
> The Privacy config information contains configuration parameters for privacy
> configuration.
Coding:
> The Privacy config information is encoded as shown in figures 5.4.2.11 to
> 5.4.2.15 and tables 5.4.2.11 to 5.4.2.15 of 3GPP TS 24.555 [115].
\- 5G ProSe direct communication in NR-PC5 Tag \'88\'
Contents:
> The 5G ProSe direct communication in NR-PC5 information contains
> configuration parameters for 5G ProSe direct communication in NR-PC5.
Coding:
> The 5G ProSe direct communication in NR-PC5 information is encoded as shown
> in figures 5.4.2.16 to 5.4.2.38 and tables 5.4.2.16 to 5.4.2.38 of 3GPP TS
> 24.555 [115].
\- ProSe application to path preference mapping rules Tag \'89\'
Contents:
> The ProSe application to path preference mapping rules information contains
> a list of ProSe application to path preference mapping rules.
Coding:
> The ProSe application to path preference mapping rules information is
> encoded as shown in figures 5.4.2.39 to 5.4.2.40 and tables 5.4.2.39 to
> 5.4.2.40 of 3GPP TS 24.555 [115].
\- ProSe identifiers to NR Tx profile for broadcast and groupcast mapping
rules Tag \'91\'
Contents:
> The ProSe identifiers to NR Tx profile for broadcast and groupcast mapping
> rules information contains a list of ProSe identifiers to NR Tx profile for
> broadcast and groupcast mapping rules.
Coding:
> The ProSe identifiers to NR Tx profile for broadcast and groupcast mapping
> rules information is encoded as shown in figures 5.4.2.41 to 5.4.2.42 and
> tables 5.4.2.41 to 5.4.2.42 of 3GPP TS 24.555 [115].
#### 4.4.13.5 EF~5G_PROSE_U2NRU~ (5G ProSe configuration data for UE-to-
network relay UE)
If service n°139 is \"available\" in the USIM Service Table and service n°3 is
\"available\" in EF~5G_PROSE_ST~, this file shall be present. This EF contains
5G ProSe policy for UE-to-network relay UE. The format of the 5G ProSe policy
for UE-to-network relay UE are specified in 3GPP TS 24.555 [115].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F04\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: \'04\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | bytes, (X ≥ 32) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5G ProSe | M | X bytes | | | configuration data | | | | | for UE-to-network | | | | | relay UE TLV objects | | | +----------------------+----------------------+----------+---------+
The 5G ProSe configuration data for UE-to-network relay UE data object
parameters tags:
* * *
Description Tag Value 5G ProSe configuration data for UE-to-network relay UE
Tag \'A0\' Served by NG-RAN Tag \'80\' Not served by NG-RAN Tag \'81\' Default
destination layer-2 IDs for sending the discovery signalling for announcement
and additional information and for receiving the discovery signalling for
solicitation Tag \'8A\' RSC info list Tag \'8B\' 5QI to PC5 QoS parameters
mapping rules Tag \'8C\' ProSe identifier to ProSe application server address
mapping rules Tag \'8D\' Validity timer Tag \'85\' User info ID for discovery
Tag \'8E\' Privacy timer Tag \'92\' 5G PKMF address information Tag \'93\'
* * *
The 5G ProSe configuration data for UE-to-network relay UE contents:
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | 5G ProSe configuration | \'A0\' | M | 1 | | data for UE-to-network | | | | | relay UE Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer Tag | \'85\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 5 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer | -- | M | 5 | | information | | | | +-------------------------+--------+-----+----------------+ | Served by NG-RAN Tag | \'80\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Served by NG-RAN | -- | M | X1 | | information | | | | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | \'81\' | M | 1 | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X2 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | -- | M | X2 | | information | | | | +-------------------------+--------+-----+----------------+ | Default destination | \'8A\' | M | 1 | | layer-2 IDs for sending | | | | | the discovery | | | | | signalling for | | | | | announcement and | | | | | additional information | | | | | and for receiving the | | | | | discovery signalling | | | | | for solicitation Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X3 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Default destination | -- | M | X3 | | layer-2 IDs for sending | | | | | the discovery | | | | | signalling for | | | | | announcement and | | | | | additional information | | | | | and for receiving the | | | | | discovery signalling | | | | | for solicitation | | | | | information | | | | +-------------------------+--------+-----+----------------+ | User info ID for | \'8E\' | M | 1 | | discovery Tag | | | | +-------------------------+--------+-----+----------------+ | Length | 6 | M | Note 2 | +-------------------------+--------+-----+----------------+ | User info ID for | -- | M | 6 | | discovery information | | | | +-------------------------+--------+-----+----------------+ | RSC info list Tag | \'8B\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X4 | M | Note 2 | +-------------------------+--------+-----+----------------+ | RSC info list | -- | M | X4 | | information | | | | +-------------------------+--------+-----+----------------+ | 5QI to PC5 QoS | \'8C\' | M | 1 | | parameters mapping | | | | | rules Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X5 | M | Note 2 | +-------------------------+--------+-----+----------------+ | 5QI to PC5 QoS | -- | M | X5 | | parameters mapping | | | | | rules information | | | | +-------------------------+--------+-----+----------------+ | ProSe identifier to | \'8D\' | O | 1 | | ProSe application | | | | | server address mapping | | | | | rules Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X6 | O | Note 2 | +-------------------------+--------+-----+----------------+ | ProSe identifier to | -- | O | X6 | | ProSe application | | | | | server address mapping | | | | | rules information | | | | +-------------------------+--------+-----+----------------+ | Privacy timer Tag | \'92\' | O | 1 | +-------------------------+--------+-----+----------------+ | Length | X7 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Privacy timer | -- | O | X7 | | information | | | | +-------------------------+--------+-----+----------------+ | 5G PKMF address | \'93\' | O | 1 | | information Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X8 | O | Note 2 | +-------------------------+--------+-----+----------------+ | 5G PKMF address | -- | O | X8 | | information information | | | | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | +-------------------------+--------+-----+----------------+
\- Validity timer Tag \'85\'
Contents:
> The Validity timer information contains the timer for controlling the
> validity of 5G ProSe configuration data for UE-to-network relay UE.
Coding:
> The Validity timer information is encoded as shown in figure 5.5.2.1 and
> table 5.5.2.1 of 3GPP TS 24.555 [115].
\- Served by NG-RAN Tag \'80\'
Contents:
> The Served by NG-RAN information contains 5G ProSe configuration parameters
> for UE-to-network relay UE when the UE is served by NG-RAN.
Coding:
> The Served by NG-RAN information is encoded as shown in figures 5.5.2.2 to
> 5.5.2.4 and tables 5.5.2.2 to 5.5.2.4 of 3GPP TS 24.555 [115].
\- Not served by NG-RAN Tag \'81\'
Contents:
> The Not served by NG-RAN information contains 5G ProSe configuration
> parameters for UE-to-network relay UE when the UE is not served by NG-RAN.
Coding:
> The Not served by NG-RAN information is encoded as shown in figures 5.5.2.5
> to 5.5.2.11a and tables 5.5.2.5 to 5.5.2.11a of 3GPP TS 24.555 [115].
\- Default destination layer-2 IDs for sending the discovery signalling for
announcement and additional information and for receiving the discovery
signalling for solicitation Tag \'8A\'
Contents:
> The Default destination layer-2 IDs for sending the discovery signalling for
> announcement and additional information and for receiving the discovery
> signalling for solicitation information contains the default destination
> layer-2 IDs for sending the discovery signalling for announcement and
> additional information and for receiving the discovery signalling for
> solicitation.
Coding:
> The Default destination layer-2 IDs for sending the discovery signalling for
> announcement and additional information and for receiving the discovery
> signalling for solicitation information is encoded as shown in figure
> 5.5.2.11b and table 5.5.2.11b of 3GPP TS 24.555 [115].
\- User info ID for discovery Tag \'8E\'
Contents:
> The User info ID for discovery information contains the user info ID for 5G
> ProSe UE-to-network relay UE.
Coding:
> The User info ID for discovery information is encoded as shown in figure
> 5.5.2.1 and table 5.5.2.1 of 3GPP TS 24.555 [115].
\- RSC info list Tag \'8B\'
Contents:
> The RSC info list information contains a list of RSCs related parameters.
Coding:
> The RSC info list information is encoded as shown in figures 5.5.2.12 to
> 5.5.2.16 and tables 5.5.2.12 to 5.5.2.16 of 3GPP TS 24.555 [115].
\- 5QI to PC5 QoS parameters mapping rules Tag \'8C\'
Contents:
> The 5QI to PC5 QoS parameters mapping rules information contains a list of
> 5QI to PC5 QoS parameters mapping rules.
Coding:
> The 5QI to PC5 QoS parameters mapping rules information is encoded as shown
> in figures 5.5.2.17 to 5.5.2.18 and tables 5.5.2.17 to 5.5.2.18 of 3GPP TS
> 24.555 [115].
\- ProSe identifier to ProSe application server address mapping rules Tag
\'8D\'
Contents:
> The ProSe identifier to ProSe application server address mapping rules
> information contains a list of ProSe identifier to ProSe application server
> address mapping rules.
Coding:
> The ProSe identifier to ProSe application server address mapping rules
> information is encoded as shown in figures 5.5.2.19 to 5.5.2.20 and tables
> 5.5.2.19 to 5.5.2.20 of 3GPP TS 24.555 [115].
\- Privacy timer Tag \'92\'
Contents:
> The Privacy timer information contains a binary encoded duration, in units
> of seconds, after which the UE shall change the source layer-2 ID self-
> assigned by the UE while performing transmission of 5G ProSe direct
> communication.
Coding:
> The privacy timer information is encoded as shown in figures 5.5.2.1 and
> tables 5.5.2.1 of 3GPP TS 24.555 [115].
\- 5G PKMF address information Tag \'93\'
Contents:
> The 5G PKMF address information information contains a list of ProSe
> identifier to ProSe application server address mapping rules.
Coding:
> The 5G PKMF address information information is encoded as shown in figures
> 5.5.2.21 to 5.5.2.23 and tables 5.5.2.21 of 3GPP TS 24.555 [115].
#### 4.4.13.6 EF~5G_PROSE_RU~ (5G ProSe configuration data for remote UE)
If service n°139 is \"available\" in the USIM Service Table and service n°4 is
\"available\" in EF~5G_PROSE_ST~, this file shall be present. This EF contains
5G ProSe policy for remote UE. The format of the 5G ProSe policy for remote UE
are specified in 3GPP TS 24.555 [115].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F05\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: \'05\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | bytes, (X ≥ 29) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5G ProSe | M | X bytes | | | configuration data | | | | | for remote UE TLV | | | | | objects | | | +----------------------+----------------------+----------+---------+
The 5G ProSe configuration data for remote UE data object parameters tags:
* * *
Description Tag Value 5G ProSe configuration data for remote UE Tag \'A0\'
Served by NG-RAN Tag \'80\' Not served by NG-RAN Tag \'81\' Default
destination layer-2 IDs for sending the discovery signalling for solicitation
and for receiving the discovery signalling for announcement and additional
information Tag \'8F\' RSC info list Tag \'8B\' N3IWF selection information
for 5G ProSe layer-3 remote UE Tag \'90\' Validity timer Tag \'85\' User info
ID for discovery Tag \'8E\' Privacy timer Tag \'92\' 5G PKMF address
information Tag \'93\'
* * *
The 5G ProSe configuration data for remote UE contents:
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | 5G ProSe configuration | \'A0\' | M | 1 | | data for remote UE Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer Tag | \'85\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 5 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer | -- | M | 5 | | information | | | | +-------------------------+--------+-----+----------------+ | Served by NG-RAN Tag | \'80\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Served by NG-RAN | -- | M | X1 | | information | | | | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | \'81\' | M | 1 | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X2 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Not served by NG-RAN | -- | M | X2 | | information | | | | +-------------------------+--------+-----+----------------+ | Default destination | \'8F\' | M | 1 | | layer-2 IDs for sending | | | | | the discovery | | | | | signalling for | | | | | solicitation and for | | | | | receiving the discovery | | | | | signalling for | | | | | announcement and | | | | | additional information | | | | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X3 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Default destination | -- | M | X3 | | layer-2 IDs for sending | | | | | the discovery | | | | | signalling for | | | | | solicitation and for | | | | | receiving the discovery | | | | | signalling for | | | | | announcement and | | | | | additional information | | | | | information | | | | +-------------------------+--------+-----+----------------+ | User info ID for | \'8E\' | M | 1 | | discovery Tag | | | | +-------------------------+--------+-----+----------------+ | Length | 6 | M | Note 2 | +-------------------------+--------+-----+----------------+ | User info ID for | -- | M | 6 | | discovery information | | | | +-------------------------+--------+-----+----------------+ | RSC info list Tag | \'8B\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | X4 | M | Note 2 | +-------------------------+--------+-----+----------------+ | RSC info list | -- | M | X4 | | information | | | | +-------------------------+--------+-----+----------------+ | N3IWF selection | \'90\' | O | 1 | | information for 5G | | | | | ProSe layer-3 remote UE | | | | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X5 | O | Note 2 | +-------------------------+--------+-----+----------------+ | N3IWF selection | -- | O | X5 | | information for 5G | | | | | ProSe layer-3 remote UE | | | | | information | | | | +-------------------------+--------+-----+----------------+ | Privacy timer Tag | \'92\' | O | 1 | +-------------------------+--------+-----+----------------+ | Length | 2 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Privacy timer | -- | O | 2 | | information | | | | +-------------------------+--------+-----+----------------+ | 5G PKMF address | \'93\' | O | 1 | | information Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X6 | O | Note 2 | +-------------------------+--------+-----+----------------+ | 5G PKMF address | -- | O | X6 | | information information | | | | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | +-------------------------+--------+-----+----------------+
\- Validity timer Tag \'85\'
Contents:
> The Validity timer information contains the timer for controlling the
> validity of 5G ProSe configuration data for remote UE.
Coding:
> The Validity timer information is encoded as shown in figure 5.6.2.1 and
> table 5.6.2.1 of 3GPP TS 24.555 [115].
\- Served by NG-RAN Tag \'80\'
Contents:
> The Served by NG-RAN information contains 5G ProSe configuration parameters
> for remote UE when the UE is served by NG-RAN.
Coding:
> The Served by NG-RAN information is encoded as shown in figures 5.6.2.2 to
> 5.6.2.4 and tables 5.6.2.2 to 5.6.2.4 of 3GPP TS 24.555 [115].
\- Not served by NG-RAN Tag \'81\'
Contents:
> The Not served by NG-RAN information contains 5G ProSe configuration
> parameters for remote UE when the UE is not served by NG-RAN.
Coding:
> The Not served by NG-RAN information is encoded as shown in figures 5.6.2.5
> to 5.6.2.11a and tables 5.6.2.5 to 5.6.2.11a of 3GPP TS 24.555 [115].
\- Default destination layer-2 IDs for sending the discovery signalling for
solicitation and for receiving the discovery signalling for announcement and
additional information Tag \'8F\'
Contents:
> The Default destination layer-2 IDs for sending the discovery signalling for
> solicitation and for receiving the discovery signalling for announcement and
> additional information information contains the default destination layer-2
> IDs for sending the discovery signalling for solicitation and for receiving
> the discovery signalling for announcement and additional information.
Coding:
> The Default destination layer-2 IDs for sending the discovery signalling for
> solicitation and for receiving the discovery signalling for announcement and
> additional information information is encoded as shown in figures 5.6.2.11b
> and tables 5.6.2.11b of 3GPP TS 24.555 [115].
\- User info ID for discovery Tag \'8E\'
Contents:
> The User info ID for discovery information contains the user info ID for 5G
> ProSe remote UE.
Coding:
> The User info ID for discovery information is encoded as shown in figure
> 5.6.2.1 and table 5.6.2.1 of 3GPP TS 24.555 [115].
\- RSC info list Tag \'8B\'
Contents:
> The RSC info list information contains a list of RSCs related parameters.
Coding:
> The RSC info list information is encoded as shown in figures 5.6.2.12 to
> 5.6.2.16a and tables 5.6.2.12 to 5.6.2.16a of 3GPP TS 24.555 [115].
\- N3IWF selection information for 5G ProSe layer-3 remote UE Tag \'90\'
Contents:
> The N3IWF selection information for 5G ProSe layer-3 remote UE information
> contains two parts:
1) N3IWF identifier configuration (either FQDN or IP address) for 5G ProSe
layer-3 remote UE; and
2) 5G ProSe layer-3 UE-to-network relay access node selection information.
Coding:
> The N3IWF selection information for 5G ProSe layer-3 remote UE information
> is encoded as shown in figures 5.6.2.17 to 5.6.2.19 and tables 5.6.2.17 to
> 5.6.2.19 of 3GPP TS 24.555 [115].
\- Privacy timer Tag \'92\'
Contents:
> The Privacy timer information contains a binary encoded duration, in units
> of seconds, after which the UE shall change the source layer-2 ID self-
> assigned by the UE while performing transmission of 5G ProSe direct
> communication.
Coding:
> The privacy timer information is encoded as shown in figures 5.6.2.1 and
> tables 5.6.2.1 of 3GPP TS 24.555 [115].
\- 5G PKMF address information Tag \'93\'
Contents:
> The 5G PKMF address information information contains a list of ProSe
> identifier to ProSe application server address mapping rules.
Coding:
> The 5G PKMF address information information is encoded as shown in figures
> 5.5.2.21 to 5.5.2.23 and tables 5.5.2.21 of 3GPP TS 24.555 [115].
#### 4.4.13.7 EF~5G_PROSE_UIR~ (5G ProSe configuration data for usage
information reporting)
If service n°139 is \"available\" in the USIM Service Table and service n°5 is
\"available\" in EF~5G_PROSE_ST~, this file shall be present. This EF contains
5G ProSe policy for usage information reporting. The format of the 5G ProSe
policy for usage information reporting are specified in 3GPP TS 24.555 [115].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F06\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: \'06\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | bytes, (X ≥ 32) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | 5G ProSe | M | X bytes | | | configuration data | | | | | for usage | | | | | information | | | | | reporting TLV | | | | | objects | | | +----------------------+----------------------+----------+---------+
The 5G ProSe configuration data for usage information reporting data object
parameters tags:
* * *
Description Tag Value 5G ProSe configuration data for UE-to-network relay UE
Tag \'A0\' Validity timer Tag \'85\' Collection period Tag \'94\' Reporting
window Tag \'95\' Reporting indicators Tag \'96\' 5G DDNMF CTF address for
uploading the usage information reports Tag \'97\'
* * *
The 5G ProSe configuration data for usage information reporting contents:
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | 5G ProSe configuration | \'A0\' | M | 1 | | data for usage | | | | | information reporting | | | | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer Tag | \'85\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 5 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer | -- | M | 5 | | information | | | | +-------------------------+--------+-----+----------------+ | Collection period Tag | \'94\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 3 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Collection period | -- | M | 3 | | information | | | | +-------------------------+--------+-----+----------------+ | Reporting window Tag | \'95\' | M | 1 | +-------------------------+--------+-----+----------------+ | Length | 3 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Reporting window | -- | M | 3 | | information | | | | +-------------------------+--------+-----+----------------+ | Reporting indicators | \'96\' | M | 1 | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | 2 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Reporting indicators | -- | M | 2 | | information | | | | +-------------------------+--------+-----+----------------+ | 5G DDNMF CTF address | \'97\' | M | 1 | | for uploading the usage | | | | | information reports Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | 5G DDNMF CTF address | -- | M | X1 | | for uploading the usage | | | | | information reports | | | | | information | | | | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | +-------------------------+--------+-----+----------------+
\- Validity timer Tag \'85\'
Contents:
> The Validity timer information contains the timer for controlling the
> validity of 5G ProSe configuration data for usage information reporting.
Coding:
> The Validity timer information is encoded as shown in figure 5.7.2.1 and
> table 5.7.2.1 of 3GPP TS 24.555 [115].
\- Collection period Tag \'94\'
Contents:
> The Collection period information contains the time interval, in unit of
> minutes, at which the UE shall generate the usage information reports.
Coding:
> The Collection period information is encoded as shown in figures 5.7.2.1 and
> tables 5.7.2.1 of 3GPP TS 24.555 [115].
\- Reporting window Tag \'95\'
Contents:
> The Reporting window information contains the time window, in units of
> minutes, during which the UE shall upload the usage information report.
Coding:
> The Reporting window information is encoded as shown in figures 5.7.2.1 and
> tables 5.7.2.1 of 3GPP TS 24.555 [115].
\- Reporting indicators Tag \'96\'
Contents:
> The Reporting indicators information contains the status of several
> reporting indicators.
Coding:
The reporting indicator is set as follows:\ bit = 1: Set indication active\
bit = 0: Set indication inactive.
Byte 1:
* * *
        b8   b7   B6   b5   b4   b3   b2   b1   
                                                Data received reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 \[115\].
                                                Data transmitted reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 \[115\].
                                                Time stamps of the first transmission/reception reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 \[115\].
                                                Time stamps in and out of NG-RAN coverage reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 \[115\].
                                                Group parameters reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 \[115\].
                                                UE locations reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 \[115\].
* * *
Byte 2:
|  | B8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 |   
---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  | 
> Address type, as defined in tables 5.7.2.1 of 3GPP TS 24.555 [115].  
|  |  |  |  |  |  |  |  |  | QoS flow reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 [115].  
|  |  |  |  |  |  |  |  |  | Radio parameters reporting indicator, as defined in tables 5.7.2.1 of 3GPP TS 24.555 [115].  
|  |  |  |  |  |  |  |  |  | RFU  
\- 5G DDNMF CTF address for uploading the usage information reports Tag \'97\'
Contents:
> The 5G DDNMF CTF address for uploading the usage information reports
> information contains a list of ProSe identifier to ProSe application server
> address mapping rules.
Coding:
> The 5G DDNMF CTF address for uploading the usage information reports
> information is encoded as shown in figures 5.7.2.1 and tables 5.7.2.1 of
> 3GPP TS 24.555 [115].
## 4.5 Contents of Efs at the TELECOM level
The Efs in the Dedicated File DF~TELECOM~ contain service related information.
### 4.5.1 EF~ADN~ (Abbreviated dialling numbers)
In case of a present GSM application on the UICC the first EF~ADN~ (i.e.
reflected by the first record in EF~PBR~) of the DF~PHONEBOOK~ is mapped (with
an identifier equal to \'6F3A\') to DF~TELECOM~ to ensure backwards
compatibility.
A 3GPP ME shall not access this file. The information is accessible for a 3GPP
ME in EF~ADN~ under DF~PHONEBOOK.~
### 4.5.2 EF~EXT1~ (Extension1)
In case of a present GSM application on the UICC the first EF~EXT1~ (i.e.
reflected by the first record in EF~PBR~) of the DF~PHONEBOOK~ is mapped (with
an identifier equal to \'6F4A\') to DF~TELECOM~ to ensure backwards
compatibility.
A 3GPP ME shall not access this file. The information is accessible for a 3GPP
ME in EF~EXT1~ under DF~PHONEBOOK.~
### 4.5.3 EF~ECCP~ (Extended Capability Configuration Parameter)
In case of a present GSM application on the UICC the first EF~CCP1~ (i.e.
reflected by the first record in EF~PBR~) of the DF~PHONEBOOK~ is mapped (with
an identifier equal to \'6F4F\') to DF~TELECOM~ to ensure backwards
compatibility. There shall not be any EF~CCP~ (with a file-id of \'6F3D\')
under DF~TELECOM~ because otherwise a GSM terminal could create
inconsistencies within the phonebook.
A 3GPP ME shall not access this file. The information is accessible for a 3GPP
ME in EF~CCP1~ under DF~PHONEBOOK.~
### 4.5.4 EF~SUME~ (SetUpMenu Elements)
This File is defined in ETSI TS 102 222 [39], and has the file identifier
\'6F54\'.
### 4.5.5 EF~ARR~ (Access Rule Reference)
This EF contains the access rules for files located under the DF~TELECOM~ in
the UICC. If the security attribute tag \'8B\' is indicated in the FCP it
contains a reference to a record in this file.
Structure of EF~ARR~ at DF~Telecom~-level
+------------------------+------------------------------+-----------+---------+ | Identifier: \'6F06\' | Structure: Linear fixed | Mandatory | | +------------------------+------------------------------+-----------+---------+ | Record length: X bytes | Update activity: low | | | +------------------------+------------------------------+-----------+---------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +------------------------+------------------------------+-----------+---------+ | Bytes | Description | M/O | Length | +------------------------+------------------------------+-----------+---------+ | 1 to X | Access Rule TLV data objects | M | X bytes | +------------------------+------------------------------+-----------+---------+
This EF contains one or more records containing access rule information
according to the reference to expanded format as defined in ISO/IEC 7816‑4
[20]. Each record represents an access rule. Unused bytes in the record are
set to \'FF\'.
If the card cannot access EF~ARR~, any attempt to access a file with access
rules indicated in this EF~ARR~ shall not be granted.
### 4.5.6 EF~ICE_DN~ (In Case of Emergency -- Dialling Number)
This EF contains one or more records containing number formatted ICE
information, according to TS 22.101 [24].
This file shall be deactivated if the user does not wish the ICE information
contained in this file to be available and activated if the user wishes the
ICE information in this file to be available.
Structure of EF~ICE_DN~ at DF~Telecom~-level
+----------------------+----------------------+----------+----------+ | Identifier: \'6FE0\' | Structure: Linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+----------+ | SFI: Optional | | | | +----------------------+----------------------+----------+----------+ | Record length: X+14 | Update activity: low | | | | bytes | | | | +----------------------+----------------------+----------+----------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE PIN or | | | | | Issuer Specified PIN | | | | | (see Note) | | | | | | | | | | ACTIVATE PIN or | | | | | Issuer Specified PIN | | | | | (see Note) | | | | +----------------------+----------------------+----------+----------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+----------+ | 1 to X | Alpha Identifier | O | X bytes | +----------------------+----------------------+----------+----------+ | X+1 | Length of BCD | M | 1 byte | | | number/SSC contents | | | +----------------------+----------------------+----------+----------+ | X+2 | TON and NPI | M | 1 byte | +----------------------+----------------------+----------+----------+ | X+3 to X+12 | Dialling Number/SSC | M | 10 bytes | | | String | | | +----------------------+----------------------+----------+----------+ | X+13 | Capab | M | 1 byte | | | ility/Configuration1 | | | | | Record Identifier | | | +----------------------+----------------------+----------+----------+ | X+14 | Extension1 Record | M | 1 byte | | | Identifier | | | +----------------------+----------------------+----------+----------+ | Note: The Issuer | | | | | Specified PIN is a | | | | | PIN with a global | | | | | key reference (see | | | | | TS 31.101 [11]) | | | | | specified by the | | | | | card Issuer. | | | | +----------------------+----------------------+----------+----------+
Coding:
As for EF~ADN~
### 4.5.7 EF~ICE_FF~ (In Case of Emergency -- Free Format)
This EF contains one or more records containing free formatted ICE
information, according to TS 22.101 [24].
This file shall be deactivated if the user does not wish the ICE information
contained in this file to be available and activated if the user wishes the
ICE information in this file to be available.
Structure of EF~ICE_FF~ at DF~Telecom~-level
+----------------------+----------------------+----------+---------+ | Identifier: \'6FE1\' | Structure: Linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | SFI: Optional | | | | +----------------------+----------------------+----------+---------+ | Record length: | Update activity: low | | | | >=X+Y bytes | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE PIN or | | | | | Issuer Specified PIN | | | | | (see Note) | | | | | | | | | | ACTIVATE PIN or | | | | | Issuer Specified PIN | | | | | (see Note) | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | ICE Free Format | M | X bytes | | | Label TLV | | | +----------------------+----------------------+----------+---------+ | X+1 to X+Y | ICE Free Format | M | Y bytes | | | Content TLV | | | +----------------------+----------------------+----------+---------+ | Note: The Issuer | | | | | Specified PIN is a | | | | | PIN with a global | | | | | key reference (see | | | | | TS 31.101 [11]) | | | | | specified by the | | | | | card Issuer. | | | | +----------------------+----------------------+----------+---------+
\- ICE Free Format Label TLV
Contents:
> This TLV contains a label that summarises the type of content that is
> contained in the associated ICE Free Format Content TLV (e.g. \"medical
> alert information\").
Coding:
ICE Free Format Label TLV is coded as follows:
> Tag value is \'80\'
>
> Length is coded according to ISO/IEC 8825-1 [35].
>
> Value is as for value part of the text string TLV in 3GPP TS 31.111 [12]. If
> the length is 0 and there is no value part then the terminal shall interpret
> this as no label is used.
\- ICE Free Format Content TLV
Contents:
> This TLV contains a ICE Free Format Content (e.g. \"Allergy to work\").
Coding:
ICE Free Format Content TLV is coded as follows:
> Tag value is \'81\'
>
> Length is coded according to ISO/IEC 8825-1 [35].
>
> Value is as for value part of the text string TLV in 3GPP TS 31.111 [12]. If
> the length is 0 and there is no value part then the terminal shall interpret
> this as no label is used.
Padding: unused bytes in each record shall be set to \'FF\'.
### 4.5.8 EF~RMA~ (Remote Management Actions)
This File is defined in ETSI TS 102 222 [39], and has the file identifier
\'6F53\'.
### 4.5.9 EF~PSISMSC~ (Public Service Identity of the SM-SC)
This file shall be present if and only if service n°12 and n°91 are
\"available\".
This EF contains the Public Service Identity of the SM-SC (either a SIP URI or
tel URI) that the ME shall use to submit SMS over IP as defined in 24.341
[55].
+----------------------+-------------------------+----------+---------+ | Identifier: \'6FE5\' | Structure: linear fixed | Optional | | +----------------------+-------------------------+----------+---------+ | File size: X bytes | Update activity: low | | | +----------------------+-------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+-------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+-------------------------+----------+---------+ | 1 to X | URI TLV data object | M | X bytes | +----------------------+-------------------------+----------+---------+
‑ URI
Contents:
\- SIP URI or tel URI of the Public Service Identity of the SM-SC.
Coding:
\- For contents and syntax of URI TLV data object values see IETF RFC 3261
[56]. The URI shall be encoded to an octet string according to UTF-8 encoding
rules as specified in IETF RFC 3629 [57]. The tag value of the URI TLV data
object shall be \'80\'.
## 4.6 Contents of DFs at the TELECOM level
### 4.6.0 List of DFs at the TELECOM level
DFs may be present as child directories of DF~TELECOM~. The following DFs have
been defined:
\- DF~GRAPHICS~ \'5F50\'.
\- DF~PHONEBOOK~ \'5F3A\'.
(DF for public phone book. This DF has the same structure as DF~PHONEBOOK~
under ADF USIM).
\- DF~MULTIMEDIA~ \'5F3B\'.
\- DF~MMSS~ \'5F3C\'
(The contents of DF for MMSS are defined in C.S0074-A [53]. This DF for MMSS
is not applicable to 3GPP only terminals).
\- DF~MCS~ \'5F3D\'.
\- DF~V2X~ \'5F3E\'.
### 4.6.1 Contents of files at the DF~GRAPHICS~ level
The Efs in the Dedicated File DF~GRAPHICS~ contain graphical information.
#### 4.6.1.1 EF~IMG~ (Image)
Each record of this EF identifies instances of one particular graphical image,
which graphical image is identified by this EF\'s record number.
Image instances may differ as to their size, having different resolutions, and
the way they are coded, using one of several image coding schemes.
As an example, image k may represent a company logo, of which there are i
instances in the UICC, of various resolutions and perhaps encoded in several
image coding schemes. Then, the i instances of the company\'s logo are
described in record k of this EF.
+----------------------+----------------------+----------+---------+ | Identifier: \'4F20\' | Structure: linear | Optional | | | | fixed | | | +----------------------+----------------------+----------+---------+ | Record length: 9n+1 | Update activity: low | | | | or 9n+2 bytes, (n ≥ | | | | | 1) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 | Number of Actual | M | 1 byte | | | Image Instances | | | +----------------------+----------------------+----------+---------+ | 2 to 10 | Descriptor of Image | M | 9 bytes | | | Instance 1 | | | +----------------------+----------------------+----------+---------+ | 11 to 19 | Descriptor of Image | O | 9 bytes | | | Instance 2 | | | +----------------------+----------------------+----------+---------+ | : | : | : | : | +----------------------+----------------------+----------+---------+ | 9(n-1)+2 to 9n+1 | Descriptor of Image | O | 9 bytes | | | Instance n | | | +----------------------+----------------------+----------+---------+ | 9n + 2 | RFU (see | O | 1 byte | | | TS 31.101 [11]) | | | +----------------------+----------------------+----------+---------+
‑ Number of Actual Image Instances.
Contents:\ \- this byte gives the number of actual image instances described
in the following data items (i.e. unused descriptors are not counted).
Coding:\ \- binary.
‑ Image Instance Descriptor
Contents:\ \- a description of an image instance.
Coding:\ \- Byte 1: Image Instance Width
Contents:\ \- this byte specifies the image instance width, expressed in
raster image points.
Coding:\ \- binary.
Byte 2: Image Instance Height.
Contents:\ \- this byte specifies the image instance height, expressed in
raster image points.
Coding:\ \- binary.
Byte 3: Image Coding Scheme.
Contents:\ \- this byte identifies the image coding scheme that has been used
in encoding the image instance.
Coding:\ \- \'11\' - basic image coding scheme as defined in annex B;\ \-
\'21\' - colour image coding scheme as defined in annex B;\ \- \'22\' - colour
image coding scheme with transparency as defined in annex B;\ other values are
reserved for future use.
Bytes 4 and 5: Image Instance Data File Identifier.
Contents:\ \- these bytes identify an EF which is the image instance data file
(see clause 4.6.1.2), holding the actual image data for this particular
instance.
Coding:\ \- byte 4: high byte of Image Instance Data File Identifier;\ \- byte
5: low byte of Image Instance Data File Identifier.
Bytes 6 and 7: Offset into Image Instance Data File.
Contents:\ \- these bytes specify an offset into the transparent Image
Instance Data File identified in bytes 4 and 5. The data for this image
instance is found starting at this offset in the Image Instance Data File.
Coding:\ \- byte 6: high byte of offset into Image Instance Data File;\ byte
7: low byte of offset into Image Instance Data File.
Bytes 8 and 9: Length of Image Instance Data.
Contents:\ \- these bytes yield the length of the image instance data,
starting at the offset identified in bytes 6 and 7. For the colour image
coding scheme, as defined in annex B, the length of image instance data
excludes the CLUT.
Coding:\ \- byte 8: high byte of Image Instance Data length;\ \- byte 9: low
byte of Image Instance Data length.
NOTE: Transparent image instance data longer than 256 bytes may be read using
successive READ BINARY commands.
#### 4.6.1.2 EF~IIDF~ (Image Instance Data Files)
Residing under DF~GRAPHICS~, there may be several image instance data files.
Each Image Instance Data File contains data for one or more image instances.
These Efs containing image instance data shall have the following attributes:
+----------------------+------------------------+----------+---------+ | Identifier: \'4FXX\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+---------+ | File size: Y bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 to Y | Image Instance Data | M | Y bytes | +----------------------+------------------------+----------+---------+
Contents and coding:\ \- Image instance data are accessed using the image
instance descriptors provided by EF~IMG~ (see clause 4.6.1.1).
The identifier \'4FXX\' shall be different from one image instance data file
to the other. For the range of \'XX\', TS 31.101 [11]. The length Y may be
different from one image instance data file to the other.
#### 4.6.1.3 EFICE_graphics (In Case of Emergency -- Graphics)
This EF contains ICE graphical information, according to TS 22.101 [24].
This file shall be deactivated if the user does not wish the ICE information
contained in this file to be available and activated if the user wishes the
ICE information in this file to be available.
For this EF the Total File Size data object shall be present within the FCP
template in order for the ME to fit the picture to the available memory.
Structure of EF~ICE_graphics~ at DF~graphics~-level
+----------------------+----------------------+----------+---------+ | Identifier: \'4F21\' | Structure: BER-TLV | Optional | | +----------------------+----------------------+----------+---------+ | SFI: Optional | | | | +----------------------+----------------------+----------+---------+ | Record length: X | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ALWAYS | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE PIN or | | | | | Issuer Specified PIN | | | | | (see Note) | | | | | | | | | | ACTIVATE PIN or | | | | | Issuer Specified PIN | | | | | (see Note) | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | ICE graphics Data | M | X bytes | | | object | | | +----------------------+----------------------+----------+---------+ | Note: The Issuer | | | | | Specified PIN is a | | | | | PIN with a global | | | | | key reference (see | | | | | TS 31.101 [11]) | | | | | specified by the | | | | | card Issuer. | | | | +----------------------+----------------------+----------+---------+
\- ICE graphics Data Object
Coding of the ICE graphics Data Objects
* * *
Length Description Coding Status 1 to T bytes (T ≤ 3) ICE graphics Data Object
tag As defined in TS 31.101 [11] for BER-TLV structured files M 1 to L (L ≤ 4)
ICE graphics Data Object length As defined in TS 31.101 [11] for BER-TLV
structured files M X-L-T bytes ICE graphics Content JPEG format M
* * *
#### 4.6.1.4 Void
#### 4.6.1.5 Void
### 4.6.2 Contents of files at the DF~PHONEBOOK~ under the DF~TELECOM~
This DF has the same structure as DF~PHONEBOOK~ under the ADF~USIM~.
### 4.6.3 Contents of files at the DF~MULTIMEDIA~ level
The Efs in the Dedicated File DF~MULTIMEDIA~ contain multimedia information.
This DF shall be present if service n°67 is available, i.e. if the card
supports MMS storage.
#### 4.6.3.1 EF**~MML~** (Multimedia Messages List)
If service n°67 is \"available\", this file shall be present.
This file contains information about the MM data stored in EF~MMDF~. MM
information are encapsulated in a BER-TLV data object. Each data object in
EF~MML~ points to a corresponding MM in EF~MMDF~.
+----------------------+------------------------------+----------+---------+ | Identifier: \'4F47\' | Structure: BER-TLV | Optional | | +----------------------+------------------------------+----------+---------+ | | Update activity: low | | | +----------------------+------------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------------+----------+---------+ | 1 to X | MM Descriptor Data Object(s) | M | X bytes | +----------------------+------------------------------+----------+---------+
\- MM Descriptor Data Object
The content and coding are defined below:
Coding of the MM Descriptor Data Objects
* * *
Length Description Coding Status 1 to A bytes (A ≤ 3) MM Descriptor Data
Object tag As defined in TS 31.101 [11] for BER-TLV structured files M 1 to B
bytes (B ≤ 4) MM Descriptor Data Object length As defined in TS 31.101 [11]
for BER-TLV structured files M 1 byte MMS Implementation tag \'80\' M 1 byte
MMS Implementation length M 1 byte MMS Implementation See below M 1 byte MM
File Identifier / SFI tag \'81\' M 1 byte MM File Identifier / SFI length M 1
or 2 bytes MM File Identifier / SFI See below M 1 byte MM Content Data Object
Tag tag \'82\' M 1 byte MM Content Data Object Tag length M 1 to C bytes (C ≤
3) MM Content Data Object Tag See below M 1 byte MM Size tag \'83\' M 1 byte
MM Size length M 1 to D bytes (D ≤ 4) MM Size in bytes See below M 1 byte MM
Status tag \'84\' M 1 byte MM Status length M 2 bytes MM Status See below M 1
byte MM Alpha Identifier tag \'85\' M 1 byte MM Alpha Identifier length M 1 to
E bytes MM Alpha Identifier See below M
* * *
\- MMS Implementation
Contents:
The MMS Implementation indicates the used implementation type, e.g. WAP.
Coding:
Allocation of bits:
Bit number Parameter indicated
1 WAP implementation of MMS
2 to 8 Reserved for future use
Bit value Meaning
0 Implementation not supported.
1 Implementation supported.
\- MM File Identifier / SFI
Contents:
> file identifier or SFI of EF~MMDF~ which contains the actual MM message. If
> the length of this TLV object is equal to 1 then the content indicates the
> SFI of the EF~MMDF~, the SFI is coded on b1 to b5. Otherwise the TLV
> contains the file identifier.
Coding:
according to TS 31.101 [11].
\- MM Content Data Object Tag
Contents:
tag indentifying a MM (i.e. identifying a data object) within EF~MMDF~.
Coding:
according to TS 31.101 [11].
\- MM Size
Contents:
size of the corresponding MM stored in EF~MMDF~.
Coding:\ according to TS 31.101 [11].
\- MM Status
Contents:
The status bytes contain the status information of the stored Multimedia
Message.
Coding:
First byte:
bit b1 indicates whether the MM has been read or not. Bit b2 indicates the MM
forwarding status. Bit b3 indicates whether it is a received MM or an
originated MM. Bits b4 to b8 are reserved for future use.
Second byte:
Coding of the second byte depends on whether the MM has been identified as a
received MM or originated MM in the first byte:
> \- Received MM coding:\ bits b1 and b2 are used to provide information on
> Read-reply reports. Bits b3 to b8 are reserved for future use.
>
> \- Originated MM coding:\ bit b1 is used to provide information on Delivery-
> report. Bits b2 to b8 are reserved for future use.
First byte:
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             MM read, bit = 1 / MM not read, bit = 0
                                             MM forwarded, bit = 1
                                             Received MM, bit = 1 / Originated MM, bit = 0
                                             RFU, bit = 0
* * *
Second byte coding for Received MM:
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             Read-reply report requested, bit = 1
                                             Read-reply report sent, bit = 1
                                             Read-reply report created, bit = 1
                                             Delivery report requested, bit = 1
                                             Delivery report creation allowed, bit = 1
                                             RFU, bit = 0
* * *
Second byte coding for Originated MM:
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             Delivery report received, bit = 1
                                             Delivery report requested, bit = 1
                                             Read-Reply report requested, bit = 1
                                             Read-Reply report received, bit = 1
                                             MM sent, bit = 1
                                             RFU, bit = 0
* * *
\- MM Alpha Identifier
Contents:
information about the MM to be displayed to the user (e.g. sender, subject,
date etc).
Coding:\ this alpha identifier shall use either:
\- the SMS default 7‑bit coded alphabet as defined in TS 23.038 [5] with bit 8
set to 0. The alpha identifier shall be left justified. Unused bytes shall be
set to \'FF\';\ \- or one of the UCS2 coded options as defined in the annex of
TS 31.101 [11].
#### 4.6.3.2 EF~MMDF~ (Multimedia Messages Data File)
If service n°67 is \"available\", this file shall be present.
Residing under DF~MULTIMEDIA~, this EF contains Multimedia Messages data. The
structure of this EF is BER-TLV (see TS 31.101 [11]). Each MM in this file is
identified by a tag. The tag value for a particular MM in this file is stored
in EF~MML~.
+----------------------+---------------------------+----------+---------+ | Identifier: \'4F48\' | Structure: BER-TLV | Optional | | +----------------------+---------------------------+----------+---------+ | | Update activity: low | | | +----------------------+---------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE PIN | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+---------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+---------------------------+----------+---------+ | 1 to X | MM Content Data Object(s) | M | X bytes | +----------------------+---------------------------+----------+---------+
\- MM Content Data Object
The content and coding are defined below:
Coding of the MM Content Data Objects
* * *
Length Description Coding Status 1 to T bytes (T ≤ 3) MM Content Data Object
tag As defined in TS 31.101 [11] for BER-TLV structured files M 1 to L (L ≤ 4)
MM Content Data Object length As defined in TS 31.101 [11] for BER-TLV
structured files M X-L-T bytes MM Content According to MMS Implementation M
* * *
Contents:
The Multimedia Message content consists of MM headers and a message body. The
content of the Multimedia Message data depends on whether the MM has been
identified as a received MM or an originated MM:
> \- For a received message, the stored Multimedia Message data consists of
> the information elements (i.e. relevant MM control information and MM
> content) of the MM1_retrieve.RES (see TS 23.140 [38]).
>
> \- For an originated message, the stored Multimedia Message data consists of
> the information elements (i.e. relevant MM control information and MM
> content) of the MM1_submit.REQ (see TS 23.140 [38]).
Coding:\ The MM data encapsulation scheme and encoding rules are defined by
the MMS Implementation.
### 4.6.4 Contents of files at the DF~MCS~ level
The EFs in the Dedicated File DF~MCS~ contain management objects related to
Mission Critical Services (including MCPTT, MCS, MCData, MCVideo), as
specified in 3GPP TS 24.483 [89].
#### 4.6.4.1 EF~MST~ (MCS Service Table)
If service n°109 is \"available\" in the USIM Service Table or service n°15 is
\"available\" in the ISIM Service Table, this file shall be present. This EF
indicates the coding of the MCS management objects and which MCPTT, MCS,
MCData or MCVideo services are available. If a service is not indicated as
available in the MCS Service Table, the ME shall not select this service.
+-----------------------+-----------------------+----------+--------+ | Identifier: \'4F01\' | Structure: | Optional | | | | transparent | | | +=======================+=======================+==========+========+ | SFI: \'01\' | | | | +-----------------------+-----------------------+----------+--------+ | File size: X bytes, | Update activity: low | | | | (X ≥ 2) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | Coding of the MCS | M | 1 byte | | | management objects | | | +-----------------------+-----------------------+----------+--------+ | 2 | Services n°1 to n°8 | M | 1 byte | +-----------------------+-----------------------+----------+--------+ | 3 | Services n°9 to n°16 | O | 1 byte | +-----------------------+-----------------------+----------+--------+ | etc. | | | | +-----------------------+-----------------------+----------+--------+ | X | Services n°(8X‑7) to | O | 1 byte | | | n°(8X) | | | +-----------------------+-----------------------+----------+--------+
Coding of the MCS management objects
Contents:
> Indicates the coding used for all the MCS management objects stored in the
> DF~MCS~.
Coding:
> A value of \'00\' indicates the XML format described in TS 24.483 [89]. All
> other values are reserved.
The EF shall contain at least one byte for services. Further bytes may be
included, but if the EF includes an optional byte, then it is mandatory for
the EF to also contain all bytes before that byte. Other services are possible
in the future and will be coded on further bytes in the EF.
‑Services
* * *
Contents: Service n°1: MCPTT UE configuration data Service n°2: MCPTT User
profile data Service n°3: MCS Group configuration data Service n°4: MCPTT
Service configuration data Service n°5: MCS UE initial configuration data
Service n°6: MCData UE configuration data Service n°7: MCData user profile
data Service n°8: MCData service configuration data Service n°9: MCVideo UE
configuration data Service n°10: MCVideo user profile data Service n°11:
MCVideo service configuration data
Coding:
> Same as coding of USIM Service Table.
#### 4.6.4.2 EF~MCS_\ CONFIG~ (MCS configuration data)
If at least one of the services is \"available\" in the MCS Service Table,
this file shall be present.
This EF contains zero, one or more configuration data objects, as specified in
3GPP TS 24.483 [89].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F02\' | Structure: BER-TLV | Optional | | +----------------------+----------------------+----------+---------+ | SFI: \'02\' | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to Y | Mission Critical | O | Y bytes | | | Services | | | | | configuration data | | | | | object | | | +----------------------+----------------------+----------+---------+
The MCS configuration data is encoded as specified in the MCS Service Table.
Unused bytes shall be set to \'FF\'.
Mission Critical Services configuration data object tag:
* * *
MCPTT configuration data objects Tag Values Condition MCPTT UE configuration
data \'80\' Shall be present if service n°1 is \"available\" in the MCS
service table MCPTT user profile data \'81\' Shall be present if service n°2
is \"available\" in the MCS service table MCS Group configuration data \'82\'
Shall be present if service n°3 is \"available\" in the MCS service table
MCPTT Service configuration data \'83\' Shall be present if service n°4 is
\"available\" in the MCS service table MCS UE initial configuration data
\'84\' Shall be present if service n°5 is \"available\" in the MCS service
table MCData UE configuration data \'85\' Shall be present if service n°6 is
\"available\" in the MCS service table MCData user profile data \'86\' Shall
be present if service n°7 is \"available\" in the MCS service table MCData
service configuration data \'87\' Shall be present if service n°8 is
\"available\" in the MCS service table MCVideo UE configuration data \'88\'
Shall be present if service n°9 is \"available\" in the MCS service table
MCVideo user profile data \'89\' Shall be present if service n°10 is
\"available\" in the MCS service table MCVideo service configuration data
\'8A\' Shall be present if service n°11 is \"available\" in the MCS service
table
* * *
#### 4.6.4.3 Void
#### 4.6.4.4 Void
#### 4.6.4.5 Void
### 4.6.5 Contents of files at the DF~V2X~ level
#### 4.6.5.1 V2X configuration data related files
The EFs in the Dedicated File DF~V2X~ contain configuration data related to
V2X, as specified in 3GPP TS 24.386 [98] and 3GPP TS 24.587 [112].
#### 4.6.5.2 EF~VST~ (V2X Service Table)
If service n°119 is \"available\" in the USIM Service Table, this file shall
be present. This EF indicates the coding of the V2X data and which V2X
services are available. If a service is not indicated as available in the V2X
Service Table, the ME shall not select this service.
+-----------------------+-----------------------+----------+--------+ | Identifier: \'4F01\' | Structure: | Optional | | | | transparent | | | +=======================+=======================+==========+========+ | SFI: \'01\' | | | | +-----------------------+-----------------------+----------+--------+ | File size: X bytes, | Update activity: low | | | | (X ≥ 2) | | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | 1 | Coding of the V2X | M | 1 byte | | | management objects | | | +-----------------------+-----------------------+----------+--------+ | 2 | Services n°1 to n°8 | M | 1 byte | +-----------------------+-----------------------+----------+--------+ | 3 | Services n°9 to n°16 | O | 1 byte | +-----------------------+-----------------------+----------+--------+ | etc. | | | | +-----------------------+-----------------------+----------+--------+ | X | Services n°(8X‑7) to | O | 1 byte | | | n°(8X) | | | +-----------------------+-----------------------+----------+--------+
Coding of the V2X data
Contents:
> Indicates the coding used for the V2X data stored in the DF~V2X~.
Coding:
> A value of \'00\' indicates the XML format described in TS 24.385 [97]. A
> value of \'01\' indicates according to 3GPP TS 24.588 [113]. All other
> values are reserved.
Editor\'s Note: the definition of other encoding formats is for future study.
The EF shall contain at least one byte for services. Further bytes may be
included, but if the EF includes an optional byte, then it is mandatory for
the EF to also contain all bytes before that byte. Other services are possible
in the future and will be coded on further bytes in the EF.
+-------------+--------------+----------------------------------------+ | > Services | | | +=============+==============+========================================+ | > Contents: | Service n°1: | V2X configuration data | +-------------+--------------+----------------------------------------+ | | Service n°2: | V2X policy configuration data over PC5 | +-------------+--------------+----------------------------------------+ | | Service n°3: | V2X policy configuration data over Uu | +-------------+--------------+----------------------------------------+
Coding:
> Same as coding of USIM Service Table.
#### 4.6.5.3 EF~V2X_CONFIG~ (V2X configuration data)
This EF contains zero, one or more V2X configuration data objects, as
specified in TS 24.385 [97].
+----------------------+------------------------+----------+---------+ | Identifier: \'4F02\' | Structure: BER-TLV | Optional | | +----------------------+------------------------+----------+---------+ | SFI: \'02\' | | | | +----------------------+------------------------+----------+---------+ | File size: X bytes | Update activity: low | | | +----------------------+------------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+---------+ | 1 to X | V2X configuration data | O | X bytes | +----------------------+------------------------+----------+---------+
The V2X configuration data is encoded as specified in the V2X Service Table.
Unused bytes shall be set to \'FF\'.
V2X configuration data object tag:
* * *
V2X configuration data objects Tag Values Condition V2X configuration data
\'80\' Shall be present if service n°1 is \"available\" in the V2X service
table
* * *
#### 4.6.5.4 EF~V2XP_PC5~ (V2X data policy over PC5)
If service n°2 is \"available\" in EF~VST~, this file shall be present. This
EF contains V2X in 5GS UE policies over PC5. The format of the V2X in 5GS UE
policies over PC5 are specified in 3GPP TS 24.588 [113].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F03\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: Optional | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | bytes, (X ≥ 3) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | V2X data policy over | M | X bytes | | | PC5 TLV objects | | | +----------------------+----------------------+----------+---------+
The V2X in 5GS UE policies over PC5 data object parameters tags:
* * *
Description Tag Value V2X data policy over PC5 Tag \'A0\' Served by E-UTRA or
served by NR Tag \'80\' Not served by E-UTRA and not served by NR Tag \'81\'
V2X service identifier to Tx profiles mapping rules Tag \'82\' Privacy config
Tag \'83\' V2X communication over PC5 in E-UTRA Tag \'84\' V2X communication
over PC5 in NR Tag \'85\'
* * *
The V2X in 5GS UE policies over PC5 contents:
+-------------------------+--------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------------+--------+-----+----------------+ | V2X data policy over | \'A0\' | M | 1 | | PC5 Tag | | | | +-------------------------+--------+-----+----------------+ | Length | Note 1 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Validity timer | -- | M | X1 | +-------------------------+--------+-----+----------------+ | Indicator bits | -- | M | 1 | +-------------------------+--------+-----+----------------+ | Served by E-UTRA or | \'80\' | M | 1 | | served by NR Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X2 | M | Note 2 | +-------------------------+--------+-----+----------------+ | Served by E-UTRA or | -- | M | X2 | | served by NR | | | | | information | | | | +-------------------------+--------+-----+----------------+ | Not served by E-UTRA | \'81\' | O | 1 | | and not served by NR | | | | | Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X3 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Not served by E-UTRA | -- | O | X3 | | and not served by NR | | | | | information | | | | +-------------------------+--------+-----+----------------+ | V2X service identifier | \'82\' | O | 1 | | to Tx profiles mapping | | | | | rules Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X4 | O | Note 2 | +-------------------------+--------+-----+----------------+ | V2X service identifier | -- | | X4 | | to Tx profiles mapping | | | | | rules information | | | | +-------------------------+--------+-----+----------------+ | Privacy config Tag | \'83\' | O | 1 | +-------------------------+--------+-----+----------------+ | Length | X5 | O | Note 2 | +-------------------------+--------+-----+----------------+ | Privacy config | -- | | X5 | | information | | | | +-------------------------+--------+-----+----------------+ | V2X communication over | \'84\' | O | 1 | | PC5 in E-UTRA Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X6 | O | Note 2 | +-------------------------+--------+-----+----------------+ | V2X communication over | -- | O | X6 | | PC5 in E-UTRA | | | | | information | | | | +-------------------------+--------+-----+----------------+ | V2X communication over | \'85 | O | 1 | | PC5 in NR Tag | | | | +-------------------------+--------+-----+----------------+ | Length | X7 | O | Note 2 | +-------------------------+--------+-----+----------------+ | V2X communication over | -- | O | X7 | | PC5 in NR Information | | | | +-------------------------+--------+-----+----------------+ | Note 1: This is the | | | | | total size of the | | | | | constructed TLV object. | | | | | | | | | | Note 2: The length is | | | | | coded according to | | | | | ISO/IEC 8825-1 [35]. | | | | +-------------------------+--------+-----+----------------+
\- Validity timer
Contents:
‑ The validity timer contains the timer for controlling the validity of 5GS UE
policies for V2X communication over PC5.
Contents:
‑ The validity timer is encoded as shown in figure 5.3.1.1 and table 5.3.1.1
of 3GPP TS 24.588 [113].
\- Indicator bits
Contents:
‑ The indicator bits contains bit indications about 5GS UE policies for V2X
communication over PC5.
Contents:
‑ The indicator bits are encoded as shown in figure 5.3.1.1 and table 5.3.1.1
of 3GPP TS 24.588 [113].
\- Served by E-UTRA or served by NR Tag \'80\'
Contents:
‑ The served by E-UTRA or served by NR contains configuration parameters for
V2X communication over PC5 when the UE is served by E-UTRA or served by NR.
Contents:
‑ The served by E-UTRA or served by NR is encoded as shown in figures 5.3.1.3
to 5.3.1.5 and tables 5.3.1.3 to 5.3.1.5 of 3GPP TS 24.588 [113].
\- Not served by E-UTRA and not served by NR Tag \'81\'
Contents:
‑ The not served by E-UTRA and not served by NR contains configuration
parameters for V2X communication over PC5 when the UE is served by E-UTRA or
served by NR.
Contents:
‑ The not served by E-UTRA and not served by NR is encoded as shown in figures
5.3.1.6 to 5.3.1.11 and tables 5.3.1.6 to 5.3.1.11 of 3GPP TS 24.588 [113].
\- V2X service identifier to Tx profiles mapping rules Tag \'82\'
Contents:
‑ The V2X service identifier to Tx profiles mapping rules contains contains a
list of V2X service identifier to Tx profiles mapping rules.
Contents:
‑ The V2X service identifier to Tx profiles mapping rules is encoded as shown
in figures 5.3.1.12 to 5.3.1.14 and tables 5.3.1.12 to 5.3.1.14 of 3GPP TS
24.588 [113].
\- Privacy config Tag \'83\'
Contents:
‑ The privacy config contains configuration parameters for privacy
configuration.
Contents:
‑ The private config is encoded as shown in figures 5.3.1.15 to 5.3.1.18 and
tables 5.3.1.15 to 5.3.1.18 of 3GPP TS 24.588 [113].
\- V2X communication over PC5 in E-UTRA Tag \'84\'
Contents:
‑ The V2X communication over PC5 in E-UTRA contains configuration parameters
for V2X communication over PC5 in E-UTRA.
Contents:
‑ The V2X communication over PC5 in E-UTRA is encoded as shown in figures
5.3.1.19 to 5.3.1.30 and tables 5.3.1.19 to 5.3.1.30 of 3GPP TS 24.588 [113].
\- V2X communication over PC5 in NR Tag \'85\'
Contents:
‑ The V2X communication over PC5 in NR contains configuration parameters for
V2X communication over PC5 in NR.
Contents:
‑ The V2X communication over PC5 in NR is encoded as shown in figures 5.3.1.31
to 5.3.1.58 and tables 5.3.1.31 to 5.3.1.58 of 3GPP TS 24.588 [113].
V2X in 5GS UE policies over PC5 data policy object tag:
* * *
V2X in 5GS UE policies over PC5 data policy Tag Values Condition V2X data
policy over PC5 \'A0\' Shall be present if service n°2 is \"available\" in the
V2X service table
* * *
#### 4.6.5.5 EF~V2XP_Uu~ (V2X data policy over Uu)
If service n°3 is \"available\" in EF~VST~, this file shall be present. This
EF contains V2X in 5GS UE policies over Uu. The format of the V2X in 5GS UE
policies over Uu are specified in 3GPP TS 24.588 [113].
+----------------------+----------------------+----------+---------+ | Identifier: \'4F04\' | Structure: | Optional | | | | Transparent | | | +======================+======================+==========+=========+ | SFI: Optional | | | | +----------------------+----------------------+----------+---------+ | File size: X bytes | Update activity: low | | | | bytes, (X ≥ 3) | | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ PIN | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | 1 to X | V2X data policy over | M | X bytes | | | Uu TLV objects | | | +----------------------+----------------------+----------+---------+
The V2X in 5GS UE policies over Uu data object parameters tags:
* * *
Description Tag Value V2X data policy over Uu Tag \'A0\' V2X service
identifier to PDU session parameters mapping rules Tag \'80\' PLMN infos Tag
\'81\'
* * *
The V2X in 5GS UE policies over Uu contents:
* * *
Description Value M/O Length (bytes) V2X data policy over Uu Tag \'A0\' M 1
Length Note 1 M Note 2 Validity timer -- M X1 Indicator bits -- M 1 V2X
service identifier to PDU session parameters mapping rules Tag \'80\' M 1
Length X2 M Note 2 V2X service identifier to PDU session parameters mapping
rules information -- M X2 PLMN infos Tag \'81\' O 1 Length X3 O Note 2 PLMN
infos information -- O X3
* * *
\- Validity timer
Contents:
‑ The validity timer contains the timer for controlling the validity of 5GS UE
policies for V2X communication over PC5.
Contents:
‑ The validity timer is encoded as shown in figure 5.4.1.1 and table 5.4.1.1
of 3GPP TS 24.588 [113].
\- Indicator bits
Contents:
‑ The indicator bits contains bit indications about 5GS UE policies for V2X
communication over PC5.
Contents:
‑ The indicator bits are encoded as shown in figure 5.4.1.1 and table 5.4.1.1
of 3GPP TS 24.588 [113].
\- V2X service identifier to PDU session parameters mapping rules Tag \'80\'
Contents:
‑ The V2X service identifier to PDU session parameters mapping rules contains
configuration parameters for V2X service identifier to PDU session parameters
mapping rules.
Contents:
‑ The V2X service identifier to PDU session parameters mapping rules is
encoded as shown in figures 5.4.1.17 to 5.4.1.18 and tables 5.4.1.17 to
5.4.1.18 of 3GPP TS 24.588 [113].
\- PLMN infos Tag \'81\'
Contents:
‑ The PLMN infos a list of PLMNs in which the UE is configured to use V2X
communication over Uu.
Contents:
‑ The not served by E-UTRA and not served by NR is encoded as shown in figures
5.4.1.2 to 5.4.1.16 and tables 5.4.1.2 to 5.4.1.16 of 3GPP TS 24.588 [113].
V2X in 5GS UE policies over Uu data policy object tag:
* * *
V2X in 5GS UE policies over Uu data policy Tag Values Condition V2X data
policy over Uu \'A0\' Shall be present if service n°3 is \"available\" in the
V2X service table
* * *
## 4.7 Files of USIM
This clause contains two figures depicting the file structure of the UICC and
the ADF~USIM~. ADF~USIM~ shall be selected using the AID and information in
EF~DIR~.
* * *
                                                                                           MF                                                                                                                              
                                                                                           \'3F00\'
                                                             EF~DIR~                       EF~PL~                         EF~ARR~                        EF~ICCID~                    EF~UMPC~                             
                                                             \'2F00\'                      \'2F05\'                       \'2F06\'                       \'2FE2\'                     \'2F08\'                             
        DF~GSM~          see TS                                                                                                                                                                                            
        \'7F20\'         51.011 \[18\]
        DF~CD~           see TS                                                                                                                                                                                            
        \'7F11\'         31.101 \[11\]
        DF~TELECOM~                                                                                                                                                                                                        
        \'7F10\'
                                                             EF~ARR~                       EF~ADN~                        EF~FDN~                        EF~SMS~                      EF~MSISDN~                           
                                                             \'6F06\'                      \'6F3A\'                       \'6F3B\'                       \'6F3C\'                     \'6F40\'
                                                             EF~SMSP~                      EF~SMSS~                       EF~LND~                        EF~SMSR~                     EF~SDN~                              
                                                             \'6F42\'                      \'6F43\'                       \'6F44\'                       \'6F47\'                     \'6F49\'
                                                             EF~EXT1~                      EF~EXT2~                       EF~EXT3~                       EF~BDN~                      EF~EXT4~                             
                                                             \'6F4A\'                      \'6F4B\'                       \'6F4C\'                       \'6F4D\'                     \'6F4E\'
                                                             EF~ECCP~                      EF~RMA~                        EF~SUME~                       EF~ICE\_DN~                  EF~ICE\_FF~                          
                                                             \'6F4F\'                      \'6F53\'                       \'6F54\'                       \'6FE0\'                     \'6FE1\'
                                                             EF~PSISMSC~                                                                                                                                                   
                                                             \'6FE5\'
                                         DF~GRAPHICS~                                                                                                                                                                      
                                         \'5F50\'
                                                                               EF~IMG~                EF~IIDFn~                      EF~ICE\_graphics~                                                                     
                                                                               \'4F20\'               \'4FXX\'                       \'4F21\'
                                         DF~PHONEBOOK~                                                                                                                                                                     
                                         \'5F3A\'
                                                                               EF~PSC~                EF~CC~                         EF~PUID~                          EF~PBR~                      EF~UID~                
                                                                               \'4F22\'               \'4F23\'                       \'4F24\'                          \'4F30\'                     \'4FXX\'
                                                                               EF~CCP1~               EF~IAP~                        EF~ADN~                           EF~EXT1~                     EF~PBC~                
                                                                               \'4FXX\'               \'4FXX\'                       \'4FXX\'                          \'4FXX\'                     \'4FXX\'
                                                                               EF~GRP~                EF~AAS~                        EF~GAS~                           EF~ANR~                      EF~SNE~                
                                                                               \'4FXX\'               \'4FXX\'                       \'4FXX\'                          \'4FXX\'                     \'4FXX\'
                                                                               EF~EMAIL~              EF~PURI~                                                                                                             
                                                             \'4FXX\'                      \'4FXX\'
                                         DF~MULTIMEDIA~                                                                                                                                                                    
                                         \'5F3B\'
                                                                               EF~MML~                EF~MMDF~                                                                                                             
                                                                               \'4F47\'               \'4F48\'
                                         DF~MMSS~            See                                                                                                                                                           
                                         \'5F3C\'            C.S0074-A\[53\]
                                         DF~MCS~                                                                                                                                                                           
                                         \'5F3D\'
                                                                               EF~MST~                EF~MCS\ \_CONFIG~                                                                                                    
                                                                               \'4F01\'               \'4F02\'
                                         DF~V2X~                                                                                                                                                                           
                                         \'5F3E\'
                                                                               EF~VST~                EF~V2X\_CONFIG~                EF~V2XP\_PC5~                     EF~V2XP\_Uu~                                        
                                                                               \'4F01\'               \'4F02\'                       \'4F03\'                          \'4F04\'
* * *
NOTE 1: Files under DF~TELECOM~ with shaded background are defined in 3GPP TS
51.011 [18].
NOTE 2: Void.
NOTE 3: Files under DF~MMSS~ are defined in C.S0074-A [53].
NOTE 4: The values \'4F03\', \'4F04\' and \'4F05\' under DF~MCS~ were used in
earlier versions of this specification, and should not be re-assigned in
future versions.
**Figure 4.1: File identifiers and directory structures of UICC**
| ADFUSIM |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---  
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFLI |  | EFARR |  | EFIMSI |  | EFKeys |  | EFKeysPS |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F05' |  | '6F06' |  | '6F07' |  | '6F08' |  | '6F09' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFDCK |  | EFHPPLMN |  | EFCNL |  | EFACMmax |  | EFUST |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F2C' |  | '6F31' |  | '6F32' |  | '6F37' |  | '6F38' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFACM |  | EFFDN |  | EFSMS |  | EFGID1 |  | EFGID2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F39' |  | '6F3B' |  | '6F3C' |  | '6F3E' |  | '6F3F' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFMSISDN |  | EFPUCT |  | EFSMSP |  | EFSMSS |  | EFCBMI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F40' |  | '6F41' |  | '6F42' |  | '6F43' |  | '6F45' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFSPN |  | EFSMSR |  | EFCBMID |  | EFSDN |  | EFEXT2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F46' |  | '6F47' |  | '6F48' |  | '6F49' |  | '6F4B' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFEXT3 |  | EFBDN |  | EFEXT5 |  | EFCCP2 |  | EFCBMIR |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F4C' |  | '6F4D' |  | '6F4E' |  | '6F4F' |  | '6F50' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFEXT4 |  | EFEST |  | EFACL |  | EFCMI |  | EFSTART-HFN |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F55' |  | '6F56' |  | '6F57' |  | '6F58' |  | '6F5B' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFTHRESHOLD |  | EFPLMNwAcT |  | EFOPLMNwAcT |  | EFHPLMNwAcT |  | EFPSLOCI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F5C' |  | '6F60' |  | '6F61' |  | '6F62' |  | '6F73' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFACC |  | EFFPLMN |  | EFLOCI |  | EFICI |  | EFOCI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F78' |  | '6F7B' |  | '6F7E' |  | '6F80' |  | '6F81' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFICT |  | EFOCT |  | EFAD |  | EFVGCS |  | EFVGCSS |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6F82' |  | '6F83' |  | '6FAD' |  | '6FB1' |  | '6FB2' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFVBS |  | EFVBSS |  | EFeMLPP |  | EFAaeM |  | EFECC |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FB3' |  | '6FB4' |  | '6FB5' |  | '6FB6' |  | '6FB7' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFHiddenkey |  | EFNETPAR |  | EFPNN |  | EFOPL |  | EFMBDN |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FC3' |  | '6FC4' |  | '6FC5' |  | '6FC6' |  | '6FC7' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFEXT6 |  | EFMBI |  | EFMWIS |  | EFCFIS |  | EFEXT7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FC8' |  | '6FC9' |  | '6FCA' |  | '6FCB' |  | '6FCC' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFSPDI |  | EFMMSN |  | EFEXT8 |  | EFMMSICP |  | EFMMSUP |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FCD' |  | '6FCE' |  | '6FCF' |  | '6FD0' |  | '6FD1' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFMMSUCP |  | EFNIA |  | EFVGCSCA |  | EFVBSCA |  | EFGBAP |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FD2' |  | '6FD3' |  | '6FD4' |  | '6FD5' |  | '6FD6' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFMSK |  | EFMUK |  | EFEHPLMN |  | EFGBANL |  | EFEHPLMNPI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FD7' |  | '6FD8' |  | '6FD9' |  | '6FDA' |  | '6FDB' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFLRPLMNSI |  | EFNAFKCA |  | EFSPNI |  | EFPNNI |  | EFNCP-IP |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FDC' |  | '6FDD' |  | '6FDE' |  | '6FDF' |  | '6FE2' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFEPSLOCI |  | EFEPSNSC |  | EFUFC |  | EFUICCIARI |  | EFNASCONFIG |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FE3' |  | '6FE4' |  | '6FE6' |  | '6FE7' |  | '6FE8' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFPWS |  | EFFDNURI |  | EFBDNURI |  | EFSDNURI |  | EFIAL |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FEC' |  | '6FED' |  | '6FEE' |  | '6FEF' |  | '6FF0' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFIPS |  | EFIPD |  | EFePDGId |  | EFePDGSelection |  | EFePDGIdEm |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FF1' |  | '6FF2' |  | '6FF3' |  | '6FF4' |  | '6FF5' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFePDGSelectionEm |  | EFFromPreferred |  | EFIMSConfigData |  | EF3GPPPSDATAOFF |  | EF3GPPPSDATAOFFservicelist |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FF6' |  | '6FF7' |  | '6FF8' |  | '6FF9' |  | '6FFA' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFTVCONFIG |  | EFXCAPConfigData |  | EFEARFCNList |  | EFMuDMiDConfigData |  | EFeAKA |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '6FFB' |  | '6FFC' |  | '6FFD' |  | '6FFE' |  | '6F01' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFPHONEBOOK |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F3A' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFPSC |  | EFCC |  | EFPUID |  | EFPBR |  | EFUID |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F22' |  | '4F23' |  | '4F24' |  | '4F30' |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFCCP1 |  | EFIAP |  | EFADN |  | EFEXT1 |  | EFPBC |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4FXX' |  | '4FXX' |  | '4FXX' |  | '4FXX' |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFGRP |  | EFAAS |  | EFGAS |  | EFANR |  | EFSNE |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4FXX' |  | '4FXX' |  | '4FXX' |  | '4FXX' |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFEMAIL |  | EFPURI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '4FXX' |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFGSM-ACCESS |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F3B' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFKc |  | EFKcGPRS |  | EFCPBCCH |  | EFinvSCAN |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F20' |  | '4F52' |  | '4F63' |  | '4F64' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFMexE |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F3C' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFMexE-ST |  | EFORPK |  | EFARPK |  | EFTPRK |  | EFTKCDF |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F40' |  | '4F41' |  | '4F42' |  | '4F43' |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFSoLSA |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F70' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFSAI |  | EFSLL |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F30' |  | '4F31' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFWLAN |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F40' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFPseudo |  | EFUPLMNWLAN |  | EF0PLMNWLAN |  | EFUWSIDL |  | EFOWSIDL |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F41' |  | '4F42' |  | '4F43' |  | '4F44' |  | '4F45' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFWRI |  | EFHWSIDL |  | EFWEHPLMNPI |  | EFWHPI |  | EFWLRPLMN |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F46' |  | '4F47' |  | '4F48' |  | '4F49' |  | '4F4A' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFHPLMNDAI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F4B' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFHNB |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F50' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFACSGL |  | EFCSGT |  | EFHNBN |  | EFOCSGL |  | EFOCSGT |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F81' |  | '4F82' |  | '4F83' |  | '4F84' |  | '4F85' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | EFOHNBN |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  | '4F86' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFProSe |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5F90' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFPROSE_MON |  | EFPROSE_ANN |  | EFPROSEFUNC |  | EFPROSE_RADIO_COM |  | EFPROSE_RADIO_MON |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F01' |  | '4F02' |  | '4F03' |  | '4F04' |  | '4F05' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFPROSE_RADIO_ANN |  | EFPROSE_POLICY |  | EFPROSE_PLMN |  | EFPROSE_GC |  | EFPST |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F06' |  | '4F07' |  | '4F08' |  | '4F09' |  | '4F10' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFPROSE_UIRC |  | EFPROSE_GM_DISCOVERY |  | EFPROSE_RELAY |  | EFPROSE_RELAY_DISCOVERY |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F11' |  | '4F12' |  | '4F13' |  | '4F14' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFACDC |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | '5FA0' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFACDC_LIST |  | EFACDC_OS_CONFIG |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F01' |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DFTV '5FB0' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFTVUSD |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4FXX' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DF5GS '5FC0' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  | EF5GS3GPPLOCI |  | EF5GSN3GPPLOCI |  | EF5GS3GPPNSC |  | EF5GSN3GPPNSC |  | EF5GAUTHKEYS |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  | '4F01' |  | '4F02' |  | '4F03' |  | '4F04' |  | '4F05' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  | EFUAC_AIC |  | EFSUCI_Calc_Info |  | EFOPL5G |  | EFSUPI_NAI |  | EFRouting_Indicator |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F06' |  | '4F07' |  | '4F08' |  | '4F09' |  | '4F0A' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EFURSP |  | EFTN3GPPSNN |  | EFCAG |  | EFSSOR-CMCI |  | EFDRI |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F0B' |  | '4F0C' |  | '4F0D' |  | '4F0E' |  | '4F0F |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | EF5GSEDRX |  | EF5GNSWO_CONF |  | EFMCHPPLMN |  | EFKAUSF_DERIVATION |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | ‘4F10' |  | '4F11' |  | '4F15' |  | '4F16' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  | DFSNPN '5FE0' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  | EFPWS_SNPN '4F01' |  | EFNID '4F02' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  | DF5G_ProSe '5FF0' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  | EF5G_ProSe_ST |  | EF5G_ProSe_DD |  | EF5G_ProSe_DC |  | EF5G_ProSe_U2NRU |  | EF5G_ProSe_RU |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  | '4F01' |  | '4F02' |  | '4F03' |  | '4F04' |  | '4F05' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  | EF5G_ProSe_UIR |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  | '4F06' |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
**Figure 4.2: File identifiers and directory structures of USIM**
NOTE 5: The value \'6F65\' under ADFUSIM was used in earlier versions of this
specification, and should not be re-assigned in future versions.
# 5 Application protocol
The requirements stated in the corresponding clause of TS 31.101 [11] apply to
the USIM application.
The procedures listed in clause \"USIM management procedures\" are required
for execution of the procedures in the subsequent clauses \"USIM security
related procedures\" and \"Subscription related procedures\". The procedures
listed in clauses \"USIM security related procedures\" are mandatory. The
procedures listed in \"Subscription related procedures\" are only executable
if the associated services, which are optional, are provided in the USIM.
However, if the procedures are implemented, it shall be in accordance with
clause \"Subscription related procedures\".
If a procedure is related to a specific service indicated in the USIM Service
Table, it shall only be executed if the corresponding bits denote this service
as \"service available\" (see clause \"EF~UST~\"). In all other cases the
procedure shall not start.
## 5.1 USIM management procedures
If a USIM application is present on the UICC, a 3GPP ME shall only use the
USIM application regardless of the radio access technology in use. In this
case, a possibly existing SIM application shall never be used by a 3GPP ME.
### 5.1.1 Initialisation
#### 5.1.1.1 USIM application selection
After UICC activation (see TS 31.101 [11]), the ME selects a USIM application.
If no EF~DIR~ file is found or no USIM applications are listed in the EF~DIR~
file, the ME may then try to select the GSM application as specified in TS
51.011 [18].
NOTE: there may be cards that need to be reset before selecting the GSM
application.
After a successful USIM application selection, the selected USIM (AID) is
stored on the UICC. This application is referred to as the last selected USIM
application. The last selected USIM application shall be available on the UICC
after a deactivation followed by an activation of the UICC.
If a USIM application is selected using partial DF name, the partial DF name
supplied in the command shall uniquely identify a USIM application.
Furthermore if a USIM application is selected using a partial DF name as
specified in TS 31.101 [11] indicating in the SELECT command the last
occurrence the UICC shall select the USIM application stored as the last USIM
application. If, in the SELECT command, the options first, next/previous are
indicated, they have no meaning if an application has not been previously
selected in the same session and shall return an appropriate error code.
#### 5.1.1.2 USIM initialisation
The ME requests the emergency call codes. For service requirements, see TS
22.101 [24].
The ME requests the Language Indication. The preferred language selection
shall always use the EF~LI~ in preference to the EF~PL~ at the MF unless any
of the following conditions applies:
\- if the EF~LI~ has the value \'FFFF\' in its highest priority position, then
the preferred language selection shall be the language preference in the
EF~PL~ at the MF level according the procedure defined in TS 31.101 [11];
\- if the ME does not support any of the language codes indicated in EF~LI~ ,
or if EF~LI~ is not present, then the language selection shall be as defined
in EF~PL~ at the MF level according the procedure defined in TS 31.101 [11];
\- if neither the languages of EF~LI~ nor EF~PL~ are supported by the
terminal, then the terminal shall use its own internal default selection.
The ME then runs the user verification procedure. If the procedure is not
performed successfully, the USIM initialisation stops.
The ME performs the administrative information request.
The ME performs the USIM Service Table request.
The ME performs the Enabled Services Table Request.
In case FDN is enabled, an ME which does not support FDN shall allow emergency
calls but shall not allow MO calls and MO-SMS.
If BDN is enabled, an ME which does not support Call Control shall allow
emergency calls but shall not allow MO calls.
If ACL is enabled, an ME which does not support ACL shall not send any APN to
the network.
If all these procedures have been performed successfully then 3G session shall
start. In all other cases 3G session shall not start.
Afterwards, the ME runs the following procedures if the ME and the USIM
support the related services:
‑ IMSI request if service n°130 is \"not available\";
‑ SUPI_NAI request if service n°130 is \"available\";
‑ Access control information request and/or UAC Access Identities
Configuration procedure;
\- Higher Priority PLMN search period request;
‑ EHPLMN request
‑ HPLMN selector with Access Technology request;
‑ User controlled PLMN selector with Access Technology request;
\- Operator controlled PLMN selector with Access Technology request;
‑ GSM initialisation requests;
‑ Location Information request for CS-and/or PS-mode and/or EPS and/or 5GS;
‑ Cipher key and integrity key request for CS- and/or PS-mode;
\- EPS NAS Security Context request for EPS
\- 5GS NAS Security Context request for 5GS;;
‑ Forbidden PLMN request;
‑ Initialisation value for hyperframe number request;
‑ Maximum value of START request;
‑ CBMID request;
‑ Depending on the further services that are supported by both the ME and the
USIM the corresponding Efs have to be read.
After the USIM initialisation has been completed successfully, the ME is ready
for a 3G session and shall indicate this to the USIM by sending a particular
STATUS command.
#### 5.1.1.3 GSM related initialisation procedures
If GSM access is enabled the following procedures shall be performed if the
applicable service is enabled and if the ME supports the GSM compact access
technology.
\- Investigation Scan request;
\- CPBCCH information request.
### 5.1.2 Session termination
#### 5.1.2.1 3G session termination
NOTE 1: This procedure is not to be confused with the deactivation procedure
in TS 31.101 [11].
The 3G session is terminated by the ME as follows.
The ME shall indicate to the USIM by sending a particular STATUS command that
the termination procedure is starting.
The ME then runs all the procedures which are necessary to transfer the
following subscriber related information to the USIM, if the ME and the USIM
support the related services:
‑ Location Information update for CS-and/or PS-domain and/or EPS and/or 5GS.
‑ Cipher Key and Integrity Key update for CS-and/or PS-domain.
\- EPS NAS Security Context update for EPS domain.
\- 5GS NAS Security Context update for 5GS domain.
‑ Advice of Charge increase.
‑ Forbidden PLMN update.
‑ GSM Termination procedures.
Finally, the ME deletes all these subscriber related information elements from
its memory.
NOTE 2: If the ME has already updated any of the subscriber related
information during the 3G session, and the value has not changed until 3G
session termination, the ME may omit the respective update procedure.
To actually terminate the session, the ME shall then use one of the mechanisms
described in TS 31.101 [11].
##### 5.1.2.1.1 GSM termination procedures
If GSM access is enabled the following termination procedures shall be
performed if the applicable service is enabled.
\- CPBCCH information update (if the ME supports the GSM compact access
technology);
#### 5.1.2.2 3G session reset
The ME shall follow the 3G session termination procedure defined above except
that the ME shall use the Application session reset procedure as described in
TS 31.101 [11] instead of one of the mechanisms to terminate the session.
### 5.1.3 USIM application closure
After termination of the 3G session as defined in 5.1.2 the USIM application
may be closed by closing the logical channels that are used to communicate
with this particular USIM application.
### 5.1.4 Emergency call codes
Request: The ME performs the reading procedure with EF~ECC~. If EF~ECC~ does
not contain any valid number, the ME shall use the emergency numbers it stores
for use in setting up an emergency call without a USIM.
Update: The ME performs the updating procedure with EF~ECC~.
NOTE: The update procedure is only applicable when access conditions of ADM
for update is set to ALW, PIN or PIN2.
### 5.1.5 Language indication
Request: The ME performs the reading procedure with EF~LI~.
Update: The ME performs the updating procedure with EF~LI~.
### 5.1.6 Administrative information request
The ME performs the reading procedure with EF~AD~.
### 5.1.7 USIM service table request
The ME performs the reading procedure with EF~UST~.
### 5.1.8 Void
### 5.1.9 UICC presence detection
The ME checks for the presence of the UICC according to TS 31.101 [11] within
all 30s periods of inactivity on the UICC-ME interface during a call. If the
presence detection according to TS 31.101 [11] fails the call shall be
terminated as soon as possible but at least within 5s after the presence
detection has failed. Here a call covers a circuit switched call, and/or an
active PDP context, and/ or an active EPS bearer context and/or an active 5GS
PDU session.
The ME may suspend the UICC presence detection based on STATUS commands in
case it has an active PDP context, an active EPS bearer context or an active
5GS PDU session, but has not exchanged any data with the network within a 30s
period of inactivity on the UICC-ME interface, and resume it as soon as data
is exchanged with the network, sending immediately a new STATUS command. For
emergency services, if UICC presence detection fails during a call the service
may not be terminated.
### 5.1.10 UICC interface in PSM
As defined in 3GPP TS 23.682 [78], PSM is intended for UEs that are expecting
only infrequent mobile originating and terminating services and that can
accept a corresponding latency in the mobile terminating communication. The
following procedures may be used by the ME in order to reduce power
consumption while in PSM.
If the UICC supports the UICC suspension mechanism (SUSPEND UICC command), the
ME may suspend the UICC after entering the PSM. In this case, the ME shall
successfully resume the UICC before it can leave the PSM.
If the UICC does not support the UICC suspension mechanism, and only in case
the PIN of the USIM is disabled, the ME may optionally deactivate the UICC (as
specified in clause 6A.1 of 3GPP TS 31.101 [11]) after entering the PSM. In
this case, the ME shall perform these steps before it can leave the PSM:
\- re-activate the UICC (as specified in clause 6A.1 of 3GPP TS 31.101 [11]),
> \- re-initialize the USIM (as specified in clause 5.1.1), with the exception
> of re-reading EFs that are not required for the verification of the USIM,
\- take appropriate steps to verify that the same USIM is used.
Verification shall include at least the check of the content of the following
EFs:
\- EF~ICCID~,
\- EF~IMSI~ if Service n°130 is \"not available\",
\- EF~SUPI_NAI~ if service n°130 is \"available\", and
\- EF~LOCI~ and/or EF~PSLOCI~ and/or EF~EPSLOCI~ (depending on which of these
specific EFs containing LOCI the ME used prior to entering PSM).
When the UE is in PSM and in case the ME wants to deactivate the UICC, it
shall wait until the current proactive UICC session, if any, is terminated
and/or any currently open BIP session is closed.
### 5.1.11 UICC interface during eDRX
In order to reduce power consumption when the UE uses extended idle mode DRX
cycle, as defined in 3GPP TS 24.301 [51], in case the UICC supports the UICC
suspension mechanism (SUSPEND UICC command), the ME may suspend the UICC
during the extended idle mode DRX cycle. In this case, the ME shall resume the
UICC successfully before the end of the extended idle mode DRX cycle or before
any other transmission to the network.
In case the UICC does not support the UICC suspension mechanism, the PIN of
the USIM is disabled and deactivation of UICC is authorized in EF~AD~, the UE
may optionally deactivate the UICC (as specified in clause 6A.1 of 3GPP TS
31.101 [11]) during the extended idle mode DRX cycle. In this case, the UE
shall re-activate the UICC (as specified in clause 6A.1 of 3GPP TS 31.101
[11]), re-initialize the USIM (as specified in clause 5.1.1) and take
appropriate steps to verify that the same USIM is used, before the end of the
extended idle mode DRX cycle or before any other transmission to the network.
Verification shall include at least the check of the content of the following
EFs:
\-- EF~ICCID~,
\- EF~IMSI~ if Service n°130 is \"not available\",
\- EF~SUPI_NAI~ if service n°130 is \"available\",
\- EF~LOCI~ and/or EF~PSLOCI~ and/or EF~EPSLOCI~ (depending on which of these
specific EFs containing LOCI the ME used prior to applying eDRX).
When the UE is in extended idle mode DRX cycle and in case the ME wants to
deactivate the UICC, it shall wait until the current proactive UICC session,
if any, is terminated and/or any currently open BIP session is closed.
### 5.1.12 UICC interface during MICO
As described in 3GPP TS 24.501 [104], the UE can make use of MICO in order to
optimize power consumption and signalling efficiency. The following procedures
may be used by the ME in order to reduce power consumption and signalling
while in MICO.
If the UICC supports the UICC suspension mechanism (SUSPEND UICC command), the
ME may suspend the UICC after entering MICO. In this case, the ME shall
successfully resume the UICC before it can leave MICO.
If the UICC does not support the UICC suspension mechanism, and only in case
the PIN of the USIM is disabled, the ME may optionally deactivate the UICC (as
specified in clause 6A.1 of 3GPP TS 31.101 [11]) after entering MICO. In this
case, the ME shall perform these steps before it can leave the MICO:
\- re-activate the UICC (as specified in clause 6A.1 of 3GPP TS 31.101 [11]),
> \- re-initialize the USIM (as specified in clause 5.1.1), with the exception
> of re-reading EFs that are not required for the verification of the USIM,
\- take appropriate steps to verify that the same USIM is used.
Verification shall include at least the check of the content of the following
EFs:
\- EF~ICCID~,
\-- EF~IMSI~ if Service n°130 is \"not available\",
\- EF~SUPI_NAI~ if service n°130 is \"available\", and
\- EF~LOCI~ and/or EF~PSLOCI~ and/or EF~EPSLOCI~ and/or EF~5GS3GPPLOCI~
(depending on which of these specific EFs containing LOCI the ME used prior to
entering MICO).
When the UE is in MICO and in case the ME wants to deactivate the UICC, it
shall wait until the current proactive UICC session, if any, is terminated
and/or any currently open BIP session is closed.
## 5.2 USIM security related procedures
### 5.2.1 Authentication algorithms computation
The ME selects a USIM application and uses the AUTHENTICATE command (see
7.1.1). The response is sent to the ME (in case of the T=0 protocol when
requested by a subsequent GET RESPONSE command).
After a successful AUTHENTICATE command, the ME shall perform cipher and
integrity key update procedure.
### 5.2.2 IMSI request
Requirement: Service n°130 is \"not available\".
Request: The ME performs the reading procedure with EF~IMSI~.
### 5.2.3 Access control information request
The ME performs the reading procedure with EF~ACC~.
### 5.2.4 Higher Priority PLMN search period request
The ME performs the reading procedure with EF~HPPLMN~.
### 5.2.5 Location information
Request: The ME performs the reading procedure with EF~LOCI~.
Update: The ME performs the updating procedure with EF~LOCI~.
In the case when updating [EF]{.smallcaps}~LOCI~ with data containing the TMSI
value and the card reports the error \'6581\' (Memory Problem), the ME shall
terminate 2G or 3G operation.
### 5.2.6 Cipher and Integrity key
Request: The ME performs the reading procedure with EF~Keys~.
Update: The ME performs the updating procedure with EF~Keys~.
### 5.2.7 Forbidden PLMN
Request: The ME performs the reading procedure with EF~FPLMN~.
Update: The ME performs the updating procedure with EF~FPLMN~.
### 5.2.8 Void
### 5.2.9 User Identity Request
The ME selects a USIM and performs:
\- If Service n°130 is \"not available\", the reading procedure with EF~IMSI~.
\- If Service n°130 is \"available\", the reading procedure with EF~SUPI_NAI~.
### 5.2.10 GSM Cipher key
Requirement: Service n°27 \"available\".
Request: The ME performs the reading procedure with EF~Kc~.
Update: The ME performs the updating procedure with EF~Kc~.
### 5.2.11 GPRS Cipher key
Requirement: Service n°27 \"available\".
Request: The ME performs the reading procedure with EF~KcGPRS~.
Update: The ME performs the updating procedure with EF~KcGPRS~.
### 5.2.12 Initialisation value for Hyperframe number
Request: The ME performs the reading procedure with EF~START-HFN~.
Update: The ME performs the updating procedure with EF~START-HFN~.
### 5.2.13 Maximum value of START
Request: The ME performs the reading procedure with EF~THRESHOLD~.
### 5.2.14 HPLMN selector with Access Technology request
Request: The ME performs the reading procedure with EF~HPLMNwAcT.~
### 5.2.15 Packet Switched Location information
Request: The ME performs the reading procedure with EF~PSLOCI~.
Update: The ME performs the updating procedure with EF~PSLOCI~.
### 5.2.16 Cipher and Integrity key for Packet Switched domain
Request: The ME performs the reading procedure with EF~KeysPS~.
Update: The ME performs the updating procedure with EF~KeysPS~.
### 5.2.17 LSA information
Requirement: Service n°23 \"available\".
Request: The ME performs the reading procedure with EF~SAI~, EF~SLL~ and its
associated LSA Descriptor files.
Update: The ME performs the updating procedure with EF~SLL~.
### 5.2.18 Voice Group Call Services
Requirement: Service n°57 \"available\".
Voice Group Call Service
Request: The ME performs the reading procedure with EFVGCS.
Voice Group Call Service Status
Request: The ME performs the reading procedure with EFVGCSS.
Update: The ME performs the updating procedure with EFVGCSS.
### 5.2.19 Voice Broadcast Services
Requirement: Service n°58 \"available\".
Voice Broadcast Service
Request: The ME performs the reading procedure with EF~VBS~.
Voice Broadcast Service Status
Request: The ME performs the reading procedure with EF~VBSS~.
Update: The ME performs the updating procedure with EF~VBSS~.
### 5.2.20 Generic Bootstrapping architecture (Bootstrap)
The ME uses the AUTHENTICATE command in GBA security context (Bootstrapping
Mode) (see 7.1.1). The response is sent to the ME.
After a successful GBA_U Procedure, the ME shall update the B-TID field and
the Key Life Time field in EF~GBABP~
### 5.2.21 Generic Bootstrapping architecture (NAF Derivation)
The ME shall first read EF~GBABP~. The ME then uses the AUTHENTICATE command
in GBA security context (NAF Derviation Mode) (see 7.1.1). The response is
sent to the ME.
### 5.2.22 MSK MIKEY Message Reception
The ME performs the reading of EF~MUK~ and retrieves the Time Stamp Counter
Value associated with the involved MUK. Then it proceeds with Timestamp
Payload checking as described in TS 33.246 [43].
### 5.2.23 MTK MIKEY Message Reception
The ME performs the reading of EF~MSK~ and retrieves the Time Stamp Counter
Value associated with the involved MSK. Then it proceeds with Timestamp
Payload checking as described in TS 33.246 [43].
### 5.2.24 Void
### 5.2.25 EHPLMN request
Requirement: Service n°71 \"available\".
Request: The ME performs the reading procedure with EF~EHPLMN~.
### 5.2.26 Last RPLMN Selection Indication request
Requirement: Service n°74 \"available\".
Request: The ME performs the reading procedure with EF~LRPLMNSI~.
5.2.27 EPS Location Information
Requirement: Service n°85 \"available\".
> Request: The ME performs the reading procedure with EF~EPSLOCI~.
>
> Update: The ME performs the updating procedure with EF~EPSLOCI.~
5.2.28 EPS NAS Security Context
Requirement: Service n°85 \"available\".
> Request: The ME performs the reading procedure with EF~EPSNSC~.
>
> Update: The ME performs the updating procedure with EF~EPSNSC.~
In order to prevent UICC memory wear out due to excessive writing, the update
of EPS NAS security context shall be according to the rules and procedures
specified in TS 33.401 [52].
### 5.2.29 Non Access Stratum Configuration
Requirement: Service n°96 \"available\".
Request: The ME performs the reading procedure with EF~NASCONFIG~.
For each NAS configuration parameter, a parameter provided in EF~NASCONFIG~
shall take precedence over the corresponding parameter stored in the ME\'s
non-volatile memory.
### 5.2.30 PWS Configuration
Requirement: Service n°97 \"available\".
Request: The ME performs the reading procedure with EF~PWS~.
5.2.31 5GS Location Information
Requirement: Service n°122 \"available\".
> Request: The ME performs the reading procedure with EF~5GS3GPPLOCI~ or with
> EF~5GSN3GPPLOCI~.
>
> Update: The ME performs the updating procedure with EF~5GS3GPPLOCI~ or with
> EF~5GSN3GPPLOCI.~
5.2.32 5GS NAS Security Context
Requirement: Service n°122 \"available\".
Request: The ME performs the reading procedure with EF5GS3GPPNSC and
EF5GSN3GPPNSC.
If service n°136 is \"available\" in addition, the ME shall associate the NAS
security context to the appropriate PLMN by parsing the two records and by
retrieving the matching PLMN identifier of the second record.
5GS NAS Security Context in the first record shall be associated with 5G GUTI
in the 5G LOCI file for the same access type (e.g. EF5GS3GPPNSC) and the 5GS
NAS Security Context in the second record shall be associated with the 5G GUTI
as indicated in the PLMN Identifier.
Update: The ME performs the updating procedure with EF5GS3GPPNSC and
EF5GSN3GPPNSC as described in TS 24.501 clauses 4.4.2.1 and C.1 in Annex C.
In order to prevent UICC memory wear out due to excessive writing, the update
of 5GS NAS security context shall be according to the rules and procedures
specified in TS 33.501 [104].
### 5.2.33 SUPI_NAI request
Requirement: Service n°130 is \"available\".
Request: The ME performs the reading procedure with EF~SUPI_NAI~.
### 5.2.34 URSP request
Requirement: Service n°132 is \"available\".
Request: The ME performs the reading procedure with EF~URSP~.
How the ME uses the URSP rules defined in EF~URSP~ is specified in 3GPP TS
24.526 [109] clause 4.2.2.2.
### 5.2.35 Trusted non-3GPP Serving network name list request
Requirement: Service n°135 is \"available\".
Request: The ME performs the reading procedure with EF~TN3GPPSNN~.
### 5.2.36 Steering of roaming connected mode control information request
Requirement: Service n°138 is \"available\".
Request: The ME performs the reading procedure with EF~SOR-CMCI~ as specified
in 3GPP TS 23.122 [31].
## 5.3 Subscription related procedures
### 5.3.1 Phone book procedures
#### 5.3.1.1 Initialisation
The ME first reads the content of EF~PBR~ to determine the configuration
phonebook. If the EF~IAP~ file is indicated in EF~PBR~ following tag \'A8\'
the ME reads the content of EF~IAP~ in order to establish the relation ship
between the content in the files indicated using tag \'A9\' and files
indicated by tag \'A8\'. The ME may read the contents of the phone book
related files in any order.
#### 5.3.1.2 Creation/Deletion of information
In order to avoid unlinked data to introduce fragmentation of the files
containing phone book data the following procedures shall be followed when
creating a new entry in the phone book. The data related to EF~ADN~ is first
stored in the relevant record. As the record number is used as a pointer the
reference pointer is now defined for the entry. The rule for storing
additional information for an entry is that the reference pointer shall be
created before the actual data is written to the location.
In case of deletion of a complete or part of an entry the data shall be
deleted first followed by the reference pointer for that data element. In case
of deletion of a complete entry the contents of EF~ADN~ is the last to be
deleted.
#### 5.3.1.3 Hidden phone book entries
If a phone book entry is marked as hidden by means of EF~PBC~ the ME first
prompts the user to enter the \'Hidden Key\'. The key presented by the user is
compared against the value that is stored in the corresponding EF~Hiddenkey~.
Only if the presented and stored hidden key are identical the ME displays the
data stored in this phone book entry. Otherwise the content of this phone book
entry is not displayed by the ME.
Even if the terminal does not support the Hidden Key Procedures, a hidden
phone book entry shall not be displayed by the terminal.
Request: The ME performs the reading procedure with EF~Hiddenkey~.
Update: The ME performs the updating procedure with EF~Hiddenkey~.
### 5.3.2 Dialling numbers
Requirements:
\- Service n°1 \"available\" for ADN located under the local phonebook;
\- Presence of EF~ADN~ in EF~PBR~ for ADN located under the global phonebook;
\- Presence of EF~ANR~ in EF~PBR~ for ANR;
\- Service n°2 \"available\" for FDN;
\- Service n°21 \"available\" for MSISDN;
\- Service n°4 \"available\" for SDN;
\- Service n°6 \"available\" for BDN;
\- Service n°8 \"available\" for EFOCI;
\- Service n°9 \"available\" for EFICI.
The following procedures may not only be applied to EF~ADN~ and its associated
extension files EF~CCP1~ and EF~EXT1~ as described in the procedures below,
but also to EF~ANR~, EF~FDN~, EF~MSISDN~, EF~BDN~, EF~SDN~, EF~OCI~, EF~ICI~,
and EF~MBDN~ and their associated extension files. If these files are not
\"available\", as denoted in the USIM service table, the current procedure
shall be aborted and the appropriate Efs shall remain unchanged.
As an example, the following procedures are described as applied to ADN.
Update: The ME analyses and assembles the information to be stored as follows
(the byte identifiers used below correspond to those in the definition of the
relevant Efs in the present document):
i) The ME identifies the Alpha‑tagging, Capability/Configuration1 Record
Identifier and Extension1 Record Identifier.
ii) The dialling number/SSC string shall be analysed and allocated to the
bytes of the EF as follows:
‑ if a \"+\" is found, the TON identifier is set to \"International\";
‑ if 20 or less \"digits\" remain, they shall form the dialling number/SSC
string;
‑ if more than 20 \"digits\" remain, the procedure shall be as follows:
\- The ME seeks for a free record in EF~EXT1~. If an Extension1 record is not
marked as \"free\", the ME runs the Purge procedure. If an Extension1 record
is still unavailable, the procedure is aborted.
\- The first 20 \"digits\" are stored in the dialling number/SSC string. The
value of the length of BCD number/SSC contents is set to the maximum value,
which is 11. The Extension1 record identifier is coded with the associated
record number in the EF~EXT1~. The remaining digits are stored in the selected
Extension1 record where the type of the record is set to \"additional data\".
The first byte of the Extension1 record is set with the number of bytes of the
remaining additional data. The number of bytes containing digit information is
the sum of the length of BCD number/SSC contents of EF~ADN~ and byte 2 of all
associated chained Extension1 records containing additional data.
iii) If a called party subaddress is associated to the ADN/SSC the procedure
shall proceed as follows:
\- If the length of the called party subaddress is less than or equal to 11
bytes (see TS 24.008 [9] for coding):
\- The ME seeks for a free record in EF~EXT1~. If an Extension1 record is not
marked as \"free\", the ME runs the Purge procedure. If an Extension1 record
is still unavailable, the procedure is aborted.
\- The ME stores the called party subaddress in the Extension1 record, and
sets the Extension1 record type to \"called party subaddress\".
\- If the length of the called party subaddress is greater than 11 bytes (see
TS 24.008 [9] for coding):
\- The ME seeks for two free records in EF~EXT1~. If no such two records are
found, the ME runs the Purge procedure. If two Extension1 records are still
unavailable, the procedure is aborted.
\- The ME stores the called party subaddress in the two Extension1 records.
The identifier field in the Extension1 record containing the first part of the
subaddress data is coded with the associated EF~EXT1~ record number containing
the second part of the subaddress data. Both Extension1 record types are set
to \"called party subaddress\".
Once i), ii), and iii) have been considered the ME performs the updating
procedure with EF~ADN~. If the USIM has no available empty space to store the
received ADN/SSC, or if the procedure has been aborted, the ME advises the
user.
For reasons of memory efficiency, the ME may analyse all Extension1 records to
recognise if the additional or subaddress data to be stored is already
existing in EF~EXT1~. In this case, the ME may use the existing chain or the
last part of the existing chain from more than one ADN. The ME is only allowed
to store extension data in unused records. If existing records are used for
multiple access, the ME shall not change any data in those records to prevent
corruption of existing chains.
Erasure: The ME sends the identification of the information to be erased. The
content of the identified record in EF~ADN~ is marked as \"free\".
Request: The ME sends the identification of the information to be read. The ME
shall analyse the data of EF~ADN~ to ascertain, whether additional data is
associated in EF~EXT1~ or EF~CCP1~. If necessary, then the ME performs the
reading procedure on these Efs to assemble the complete ADN/SSC.
Purge: The ME shall access each EF which references EF~EXT1~ (EF~EXT2~,
EF~EXT6~) for storage and shall identify records in these files using
extension data (additional data or called party subaddress). Note that
existing chains have to be followed to the end. All referred Extension1
(Extension2, Extension6) records are noted by the ME. All Extension1
(Extension2, Extension6) records not noted are then marked by the ME as
\"free\" by setting the whole record to \'FF\'.
The following three procedures are only applicable to service n°2 (FDN).
FDN capability request. The ME shall check the state of service n°2, i.e. if
FDN is \"enabled\" or \"disabled\". If FDN is enabled, the ME shall only allow
outgoing calls as defined in the fixed number dialling description in TS
22.101 [24]. To ascertain the state of FDN, the ME shall check in EFUST and
EFEST if FDN is enabled (service activated and available). In all other cases
service n°2 is disabled.
FDN enabling is done by activating the FDN service in EFEST.
FDN disabling is done by deactivating the FDN service in EFEST.
The following three procedures are only applicable to service n°6 (BDN).
\- BDN capability request. The ME shall check the state of service n°6, i.e.
if BDN is \"enabled\" or \"disabled\". To ascertain the state of BDN, the ME
shall check in EFUST and EFEST if BDN is \"enabled\" (service available and
activated). In all other cases, the BDN service is \"disabled\".
\- BDN enabling is done by activating the BDN service in EFEST.
\- BDN disabling is done by deactivating the BDN service in EFEST.
### 5.3.3 Short messages
Requirement: Service n°10 \"available\".
Request: The USIM seeks for the identified short message. If this message is
found, the ME performs the reading procedure with EF~SMS~.
If service n°10 is \"available\" and the status of the SMS is \'1D\' (status
report requested, received and stored in EF~SMSR~), the ME performs the
reading procedure with the corresponding record in EF~SMSR~. If the ME does
not find a corresponding record in EF~SMSR~, then the ME shall update the
status of the SMS with \'15\' (status report requested, received but not
stored in EF~SMSR~).
If the short message is not found within the USIM memory, the USIM indicates
that to the ME.
Update: The ME looks for the next available area to store the short message.
If such an area is available, it performs the updating procedure with EF~SMS~.
If there is no available empty space in the USIM to store the received short
message, a specific MMI will have to take place in order not to loose the
message.
Erasure: The ME will select in the USIM the message area to be erased.
Depending on the MMI, the message may be read before the area is marked as
\"free\". After performing the updating procedure with EF~SMS~, the memory
allocated to this short message in the USIM is made available for a new
incoming message. The memory of the USIM may still contain the old message
until a new message is stored in this area.
If service n°11 is \"available\" and the status of the SMS is \'1D\' (status
report requested, received and stored in EF~SMSR~), the ME performs the
erasure procedure for EF~SMSR~ with the corresponding record in EF~SMSR~.
### 5.3.4 Advice of charge
Requirement: Service n°13 \"available\".
Accumulated Call Meter.
Request: The ME performs the reading procedure with EF~ACM~. The USIM returns
the last updated value of the ACM.
Initialisation: The ME performs the updating procedure with EF~ACM~ using the
new initial value.
Increasing: The ME performs the increasing procedure with EF~ACM~ sending the
value which has to be added.
Accumulated Call Meter Maximum Value.
Request: The ME performs the reading procedure with EF~ACMmax~.
Initialisation: The ME performs the updating procedure with EF~ACMmax~ using
the new initial maximum value.
Price per Unit and Currency Table (PUCT).
Request: The ME performs the reading procedure with EF~PUCT~.
Update: The ME performs the updating procedure with EF~PUCT~.
### 5.3.5 Capability configuration parameters
Requirement: Service n°14 \"available\".
Request: The ME performs the reading procedure with EF~CCP2~.
Update: The ME performs the updating procedure with EF~CCP2~.
Erasure: The ME sends the identification of the requested information to be
erased. The content of the identified record in EF~CCP2~ is marked as
\"free\".
### 5.3.6 User controlled PLMN selector with Access Technology
Requirement: Service n°20 \"available\".
Request: The ME performs the reading procedure with EF~PLMNwACT~.
Update: The ME performs the updating procedure with EF~PLMNwACT~.
### 5.3.7 Cell broadcast message identifier
Requirement: Service n°15 \"available\".
Request: The ME performs the reading procedure with EF~CBMI~.
Update: The ME performs the updating procedure with EF~CBMI~.
### 5.3.8 Group identifier level 1
Requirement: Service n°17 \"available\".
Request: The ME performs the reading procedure with EF~GID1~.
### 5.3.9 Group identifier level 2
Requirement: Service n°18 \"available\".
Request: The ME performs the reading procedure with EF~GID2~.
### 5.3.10 Service provider name
Requirement: Service n°19 \"available\".
Request: The ME performs the reading procedure with EF~SPN~.
### 5.3.11 Enhanced multi level precedence and pre-emption service
Requirement: Service n°24 \"available\".
Request: The ME performs the reading procedure with EF~eMLPP~.
### 5.3.12 Cell broadcast message identifier ranges
Requirement: Service n°16 \"available\".
Request: The ME performs the reading procedure with EF~CBMIR~.
Update: The ME performs the updating procedure with EF~CBMIR~.
### 5.3.13 Short message status report
Requirement: Service n°11 \"available\".
Request: If the status of a stored short message indicates that there is a
corresponding status report, the ME performs the reading procedure on the
records of EF~SMSR~ and identifies the record containing the appropriate
status report.
Update: If a status report is received, the ME first seeks within the SMS
record identifiers of EF~SMSR~ for the same record number it used for the
short message in EF~SMS~. If such a record identifier is found in EF~SMSR~, it
is used for storage. If such a record identifier is not found, then the ME
seeks for a free entry in EF~SMSR~ for storage. If no free entry is found the
ME runs the Purge procedure with EF~SMSR~. If there is still no free entry,
the status report is not stored.
If the ME found an appropriate record in EF~SMSR~ for storage, it updates the
record with the status report setting the record identifier in EF~SMSR~ to the
appropriate record number of the short message in EF~SMS~.
The status in EF~SMS~ is updated accordingly by performing the update
procedure with EF~SMS~.
Erasure: The ME runs the update procedure with EF~SMSR~ by at least storing
\'00\' in the first byte of the record. The ME may optionally update the
following bytes with \'FF\'.
Purge: The ME shall read the SMS record identifier (byte 1) of each record of
EF~SMSR~. With each record the ME checks the corresponding short messages in
EF~SMS~. If the status (byte 1) of the corresponding SMS is not equal \'1D\'
(status report requested, received and stored in EF~SMSR~), the ME shall
perform the erasure procedure with the appropriate record in EF~SMSR~.
### 5.3.14 APN Control List
Requirement: Service n°35 \"available\".
Request: The ME performs the reading procedure with EF~ACL~.
Update: The ME performs the updating procedure with EF~ACL~.
Enabling: The ME activates service n°3 in EF~EST~ (bit n°3 set to \"1\").
Disabling: The ME deactivates service n°3 in EF~EST~ (bit n°3 set to \"0\").
When the APN Control List service is enabled, the ME shall check that the
entire APN of any PDP context is listed in EF~ACL~ before requesting this PDP
context activation from the network. If the APN is not present in EF~ACL~, the
ME shall not request the corresponding PDP context activation from the
network.
In the case that the APN Control List is enabled and no APN is indicated in
the PDP context request, indicating that a network provided APN is to be used,
then the ME shall only request the PDP context activation if \"network
provided APN\" is contained within EF~ACL~.
If the APN Control List service is enabled and the ME is to provide an APN as
part of attach for PDN connectivity, then the ME shall verify that the APN
value is present in the EF~ACL~ and if it is not the ME shall not proceed with
the attach procedure. If the APN Control List service is enabled and the ME
does not indend to provide an APN as part of the attach for PDN connectivity
and use a network provided APN, the ME shall not check if \"network provided
APN\" is contained within EF~ACL~.
If the APN Control List service is enabled and the ME is to provide a DNN as
part of PDU session establishment, then the ME shall verify that the DNN value
is present in the EF~ACL~ and if it is not the ME shall not proceed with the
PDU session establishment procedure. If the APN Control List service is
enabled and the ME does not intend to provide a DNN as part of the PDU session
establishment and use a network provided DNN, the ME shall not check if
\"network provided DNN\" is contained within EF~ACL~.
### 5.3.15 Depersonalisation Control Keys
Requirement: Service n°36 \"available\".
Request: The ME performs the reading procedure with EF~DCK~.
### 5.3.16 Co-operative Network List
Requirement: Service n°37 \"available\".
Request: The ME performs the reading procedure with EF~CNL~.
### 5.3.17 CPBCCH information
Requirement: Service n°39 \"available\".
Request: The ME performs the reading procedure with EF~CPBCCH~.
Update: The ME performs the updating procedure with EF~CPBCCH~.
### 5.3.18 Investigation Scan
Requirement: Service n°40 \"available\".
Request: The ME performs the reading procedure with EF~InvScan~.
### 5.3.19 Enabled Services Table Request
Requirement: Service n°2, 6, 34 or 35 \"available\".
Request: The ME performs the reading procedure with EF~EST~.
Update: The ME performs the updating procedure with EF~EST~.
### 5.3.20 Operator controlled PLMN selector with Access Technology
Requirement: Service n°42 \"available\".
Request: The ME performs the reading procedure with EF~OPLMNwACT~
### 5.3.21 HPLMN selector with Access Technology
Requirement: Service n°43 \"available\".
Request: The ME performs the reading procedure with EFHPLMNwACT
### 5.3.22 Automatic Answer on eMLPP service
Requirement: Service n°25 \"available\"
Request: The ME performs the reading procedure with EF~AaeM~.
Update: The ME performs the updating procedure with EF~AaeM~.
### 5.3.23 Network Parameter information
Request: The ME performs the reading procedure with EF~NETPAR~.
Update: The ME performs the updating procedure with EF~NETPAR~.
### 5.3.24 PLMN network name
Requirement: Service n°45 \"available\".
Request: The ME performs the reading procedure with EF~PNN~.
### 5.3.25 Operator PLMN List
Requirement: Service n°46 \"available\".
Request: The ME performs the reading procedure with EF~OPL~
### 5.3.26 Message Waiting Indication
Requirement: Service n°48 \"available\".
Request: The ME performs the reading procedure with EF~MWIS~.
Update: The ME performs the updating procedure with EF~MWIS~.
### 5.3.27 Call Forwarding Indication Status
Requirement: Service n°49 \"available\".
Request: The ME performs the reading procedure with EF~CFIS~.
Update: The ME performs the updating procedure with EF~CFIS~.
### 5.3.28 Service Provider Display Information
Requirement: Service n°19 and 51 are \"available\".
Request: The ME performs the reading procedure with EF~SPDI~.
Update: The ME performs the updating procedure with EF~SPDI~.
### 5.3.29 MMS Notifications
Requirement: Service n°52 \"available\".
Request: The ME sends the identification of the information to be read, then
the ME performs the reading procedure with EF~MMSN.~ If Service n°53 is
available the ME shall analyse the data of EF~MMSN~ to ascertain, whether
additional data is associated in EF~EXT8~. If necessary, then the ME performs
the reading procedure on EF~EXT8~ to assemble the complete MMS notification.
Update: The ME analyses and assembles the MMS notification to be stored as
follows:
\- if the MMS notification contains not more bytes than the maximum possible
number for EF~MMSN~ then the ME looks for the next available area to store the
MMS notification. If such an area is available, it performs the updating
procedure with EF~MMSN~.
\- if the MMS notification contains [more]{.underline} bytes than the maximum
possible number for EF~MMSN~ then the ME seeks for a sufficient number of free
records in EF~EXT8~ to store the complete MMS notification.
\- If there is not a sufficient number of EF~EXT8~ records marked as \"free\"
to store the complete MMS notification, the procedure is aborted.
\- Otherwise, the ME performs the updating procedure and stores as many bytes
as possible in EF~MMSN~. The Extension file record number of EF~MMSN~ is coded
with the associated record number in the EF~EXT8~. The remaining bytes are
stored in the selected EF~EXT8~ record where the type of the record is then
set to \"additional data\". The second byte of the EF~EXT8~ record is set with
the number of bytes of the remaining additional data. It is possible, if the
number of additional digits exceeds the capacity of the additional record, to
chain another record inside the EF~EXT8~ by the identifier in the last byte of
the record. In this case byte 2 of each record for additional data within the
same chain indicates the number of bytes within the same record.
The ME is only allowed to store extension data in unused records of EF~EXT8~
If there is no available empty space in the USIM to store the MMS
notification, it is up to ME implementation how the notification is handled.
Erasure: The ME will select in the USIM the MMS notification to be erased.
Depending on the MMI, the MMS notification may be read before the area is
marked as \"free\". The memory of the USIM may still contain the old MMS
notification until a new message is stored. If Service n°53 is available all
associated records in EF~EXT8~ are then marked by the ME as \"free\" by
setting them to \'FF\'.
### 5.3.30 MMS Issuer Connectivity Parameters
Requirement: Service n°52 \"available\".
Request: the ME performs the reading procedure with EF~MMSICP~.
Update: The ME performs the updating procedure with EF~MMSICP.~
### 5.3.31 MMS User Preferences
Requirement: Service n°52 \"available\".
Request: the ME performs the reading procedure with EF~MMSUP~.
Update: The ME performs the updating procedure with EF~MMSUP.~
### 5.3.32 MMS User Connectivity Parameters
Requirement: Service n°52 and n°55 \"available\".
Request: the ME performs the reading procedure with EF~MMSUCP~.
Update: The ME performs the updating procedure with EF~MMSUCP.~
### 5.3.33 Network\'s indication of alerting
Requirement: Service n°56 \"available\".
Request: The ME performs the reading procedure with EF~NIA~.
### **5.3.34 Multimedia Messages Storage**
If the terminal supports Multimedia Message Storage on the USIM, then the
following procedures apply.
As defined in TS 23.140 [38] a Multimedia Message consists of content, or
multimedia objects, and headers to describe various properties of that
content. An MM is stored in EF~MMDF~, a BER-TLV structured file.
A list of multimedia messages is stored in the BER-TLV file EF~MML~where each
data object identifies one Multimedia Message stored in EF~MMDF.~
Prerequisite: Service n°67 \"available\".
Request: The ME performs the reading procedures on EF~MML~ to verify the
presence and to get the location information of the targeted MM. Then the ME
performs the reading procedure of the EF~MMDF~ file to get the MM.
Update: The ME chooses a free identity (i.e. not listed in EF~MML~) for the
multimedia message and check for available space in the EF~MMDF~ file. This
procedure could be done for each update or once at the startup of the UE and
after a REFRESH command involving one of the DF~MULTIMEDIA~ files. Then the ME
performs the following procedures:
If there is no available empty space in the EF~MMDF~ file to store the MM, the
procedure is aborted and the user is notified.
Else, the ME stores the MM in EF~MMDF~, then updates the information in
EF~MML~ accordingly.
Erasure: After a successful deletion of an MM in EF~MMDF~ the terminal updates
the information in EF~MML~ accordingly.
### 5.3.35 Equivalent HPLMN Presentation Indication request
Requirement: Service n°73 \"available\".
Request: The ME performs the reading procedure with EF~EHPLMNPI~.
### 5.3.36 NAF Key Centre Address request
Requirement: Service n°68 and service n°76 \"available\".
Request: The ME performs the reading procedure with EF~NAFKCA~.
### 5.3.37 Service provider name Icon
Requirement: Service n°19 and service n°78 \"available\".
Request: The ME performs the reading procedure with EF~SPN~ and EF~SPNI~.
### 5.3.38 PLMN network name Icon
Requirement: Service n°45 and service n°79 \"available\".
Request: The ME performs the reading procedure with EF~PNN~ and EF~PNNI~.
### 5.3.39 ICE Information request
The ICE information shall be accessible even when the security features of the
UE or UICC have been enabled. The ICE access procedure is described in TS
22.030 [4]. The terminal shall discover that the ICE feature is supported by
the ability to select one of the ICE files i.e. EF~ICE_DN~, EF~ICE_FF~ or
EF~ICE_graphics~.
Request: The terminal performs the read procedure with EF~ICE_DN~ and/or
EF~ICE_FF~ and/or EF~ICE_graphics~.
Update: The terminal performs the update procedure with EF~ICE_DN~ and/or
EF~ICE_FF~ and/or EF~ICE_graphics~.
Disable ICE display: The terminal performs the deactivate procedure
consecutively on all the supported files (EF~ICE_DN~, EF~ICE_FF~ and
EF~ICE_graphics~).
Enable ICE display: The terminal performs the activate procedure consecutively
on all the supported files (EF~ICE_DN~, EF~ICE_FF~ and EF~ICE_graphics~ ).
The content of the EF~ICE_DN~, EF~ICE_FF~ and EF~ICE_graphics~ shall be
preserved when enabling and disabling the ICE display.
### 5.3.40 eCall Related Procedures
The eCall feature on the USIM provides two numbers or URIs, a test number or
URI and a reconfiguration number or URI, to the terminal to be used with the
eCall. eCall support on the USIM is indicated in the service table when
Service n° 89 or Service n° 112 is \"available\".
Depending on the type of eCall support and the domain, EF~FDN~ or EF~SDN~ or
EF~FDNURI~ or EF~SDNURI~ is used to provide the eCall functionality.
#### 5.3.40.1 eCall Only support
Requirement: Service n° 89 is \"available\" and FDN is enabled (Service n° 2
is \"available\" and FDN service is enabled in EF~EST~).
Request: The ME performs the reading procedure with EF~FDN~.
If eCall only calls are supported, then EF~FDN~ shall only contain two
entries. The first entry shall contain the eCall test number and the second
entry shall contain the eCall reconfiguration number. These numbers are used
for eCall over CS domain. If Service n° 112 or Service n° 99 are not
available, these numbers are used also for eCall over IMS Emergency Services
using the PS domain in E-UTRAN or in NG-RAN, after being converted into tel
URIs. A terminal in eCall only mode performs the FDN related procedures.
Requirement: Service n° 112 and Service n° 99 are \"available\" and FDN is
enabled (Service n° 2 is \"available\" and FDN service is enabled in EF~EST~).
Request: The ME performs the reading procedure with EF~FDNURI~.
If eCall only calls are supported, then EF~FDNURI~ shall only contain two
entries. The first entry shall contain the eCall test URI and the second entry
shall contain the eCall reconfiguration URI. These URIs are used for eCall
over IMS Emergency Services using the PS domain in E-UTRAN or in NG-RAN. A
terminal in eCall only mode performs the FDN related procedures.
NOTE: These URIs can contain MSISDNs encoded as tel URIs.
#### 5.3.40.2 eCall and Normal call support
Requirement: Service n° 89 and Service n° 4 are \"available\" and FDN is
disabled (either Service n°2 is not \"available\" or FDN service is disabled
in EF~EST~).
Request: The ME performs the reading procedure with EF~SDN~.
If eCall and normal calls are supported, then the last two entries of EF~SDN~
shall contain the eCall test number and the eCall reconfiguration number
respectively. These numbers are used for eCalls over CS domain. If Service n°
112 or Service n° 99 are not available, these numbers are used also for eCall
over IMS Emergency Services using the PS domain in E-UTRAN or in NG-RAN, after
being converted into tel URIs. A terminal in eCall and normal mode performs
the SDN related procedures.
Requirement: Service n° 112 and Service n° 99 and Service n° 4 are
\"available\" and FDN is disabled (either Service n°2 is not \"available\" or
FDN service is disabled in EF~EST~).
Request: The ME performs the reading procedure with EF~SDNURI~.
If eCall and normal calls are supported, then the last two entries of
EF~SDNURI~ shall contain the eCall test URI and the eCall reconfiguration URI
respectively. These URIs are used for eCall over IMS Emergency Services using
the PS domain in E-UTRAN or in NG-RAN. A terminal in eCall and normal mode
performs the SDN related procedures.
NOTE: These URIs can contain MSISDNs encoded as tel URIs.
#### 5.3.40.3 Change of eCall mode
It is possible to re-configure the USIM from eCall only support to eCall and
Normal call support, or vice versa, either by changing the content of the USIM
Service Table, and/or by changing the content of the EF~EST~. The terminal
shall be notified of the changes by using the REFRESH proactive command,
defined in TS 31.111 [12], using one of the following modes:
\- USIM Initialization and File Change Notification
\- USIM Initialization and Full File Change Notification
\- UICC Reset
\- USIM Application Reset
\- 3G Session Reset
### 5.3.41 SM-over-IP
Requirement: Service n°12 and n°91 \"available\".
Request: the ME performs the reading procedure with EF~PSISMSC~.
Update: The ME performs the updating procedure with EF~PSISMSC~.
### 5.3.42 UICC access to IMS
Requirement: Service n°95 is \"available\" and the ISIM application defined in
TS 31.103 [64] is not present on the UICC.
Request: The terminal performs the reading procedure with EF~UICCIARI~.
The procedures and command for \"UICC access to IMS\" are defined in TS 31.111
[12]. An ME supporting UICC access to IMS shall perform the reading procedure
with EF~UICCIARI~ prior to sending a registration to the IMS.
### 5.3.43 TV Configuration
Requirement: Service n°116 \"available\".
Request: The ME performs the reading procedure with EF~TVCONFIG~.
### 5.3.44 3GPP PS Data Off related procedures
Requirement: service n°117 is \"available\" in the USIM Service Table.
Request: If the ME supports 3GPP PS Data Off the ME shall perform the reading
procedure with EF~3GPPPSDataOff.~
### 5.3.45 3GPP PS Data Off service list related procedures
Requirement: service n°118 is \"available\" in the USIM Service Table.
Request: If the ME supports 3GPP PS Data Off the ME shall perform the reading
procedure with EF~3GPPPSDATAOFFservicelist~. If the ME performs the reading
procedure with EF~3GPPPSDATAOFFservicelist~, the UE shall use the 3GPP PS Data
Off Service list in the EF~3GPPPSDATAOFFservicelist~ as described in TS 24.229
[63] clauses 4.17, B.3.1.5 and L.3.1.5.
### 5.3.46 EARFCN list for MTC/NB-IOT UEs
Requirement: Service n°121 \"available\".
Request: The ME performs the reading procedure with EF~EARFCNList~.
### 5.3.47 SUCI Calculation information procedure
Requirement: \"SUCI calculation is to be performed by the ME\" (i.e. Service
n°124 is \"available\"and Service n°125 is not \"available\").
Request: As part of the SUCI calculation performed by the ME, the ME performs
the reading procedure with EF~SUCI_Calc_Info~.
### 5.3.48 SUCI Calculation by the USIM procedure
Requirement: \"SUCI calculation is performed by the USIM\" (i.e. Service n°124
and Service n°125 are \"available\").
Request: The ME uses the GET IDENTITY command in SUCI context to retrieve the
SUCI calculated by the USIM
Following procedures apply for 5G NSWO authentication.
\- If \"5G NSWO support\" is activated (i.e. Service nº142 is \"available\"),
the ME shall use the GET IDENTITY command in the SUCI 5G NSWO context to
retrieve the SUCI calculated by the USIM.
\- if USIM service 142 is not available and if the SUPI type is IMSI, the ME
shall use the GET IDENTITY command in the SUCI context to retrieve the SUCI
calculated by the USIM and contruct the SUCI in the NAI format as below.
\- The ME shall construct the realm part of the SUCI using the Home Network
Identifier in the SUCI retrieved from the USIM as specified in TS 23.003 [25].
\- The ME shall construct the username part of the SUCI using the complete
SUCI excluding the Home Network Identifier received from the USIM.
Editors note: CT1 needs to update TS 24.502 [117] on how the ME shall format
the SUCI to include the realm part of the SUCI for 5G NSWO. Reference to the
clause in 24.502 [117] shall be added here once it is updated.
### 5.3.49 Control plane-based Steering of Roaming related procedures
If service n°127 is \"available\" in the USIM Service Table, the Registration
Accept shall contain control plane based Steering of Roaming information
during the initial registration procedure in a VPLMN.
The control plane-based Steering of Roaming procedure and the related
information from the HPLMN are specified in 3GPP TS 23.122 [31].
### 5.3.50 5GS Operator PLMN List
Requirement: Service n°129 \"available\".
Request: The ME performs the reading procedure with EF~OPL5G~.
### 5.3.51 Routing Indicator procedure for ME
Requirement: Service n°124 is \"available\".
Request: As part of the SUCI calculation performed by the ME, the ME performs
the reading procedure with EF~Routing_Indicator~.
### 5.3.52 5GS eDRX procedure for ME
Requirement: Service n°141 \"available\".
Request: The ME performs the reading procedure with EF~5GSEDRX~.
### 5.3.53 5G NSWO procedure
Requirement: Service n°142 is \"available\".
Request: If Non-seamless WLAN offload (NSWO) is supported by the ME, it shall
perform the reading procedure with EF~5GNSWO_CONF~ and it shall follow the
authentication procedure in 5G NSWO as defined in TS 33.501 [105] Annex S.
## 5.4 USAT related procedures
### 5.4.1 Data Download via SMS‑PP
Requirement: USIM Service n°28 \"available\".
The procedures and commands for Data Download via SMS‑PP are defined in TS
31.111 [12].
### 5.4.2 Image Request
The terminal sends the identification of the information to be read. The
terminal shall analyse the data of EF~IMG~ to identify the files containing
the instances of the image. If necessary, then the terminal performs READ
BINARY commands on these files to assemble the complete image instance data.
### 5.4.3 Data Download via SMS‑CB
Requirement: USIM Service n°29 \"available\".
The ME shall perform the reading procedure with EF~CBMID~, and add the message
identifiers to the Cell Broadcast search list. On receiving a cell broadcast
message the procedure defined in TS 31.111 [12] applies.
### 5.4.4 Call Control by USIM
Requirement: USIM Service n°30 \"available\".
The procedures and commands for Call Control by USIM are defined in TS 31.111
[12]. It is mandatory for the ME to perform the procedures if it has indicated
that it supports Call Control by USIM in the TERMINAL PROFILE command.
### 5.4.5 MO-SMS control by USIM
Requirement: USIM Service n°31 \"available\".
The procedures and commands for MO-SMS control by USIM are defined in TS
31.111 [12]. It is mandatory for the ME to perform the procedures if it has
indicated that it supports MO-SMS control by USIM in the TERMINAL PROFILE
command.
### 5.4.6 Data Download via USSD and USSD application mode
Requirement: Service n°70 \"available\".
The procedures and commands for Data Download via USSD and USSD application
mode are defined in TS 31.111 [12].
### 5.4.7 Additional TERMINAL PROFILE after UICC activation
Requirement: USIM Service n°72 \"available\".
The procedures and commands for Additional TERMINAL PROFILE after UICC
activation are defined in TS 31.111 [12] and allow the ME to send multiple
Terminal Profile downloads.
### 5.4.8 Terminal Applications
Requirement: Service n°77 \"available\"
The procedures and commands for \"Terminal Applications\" are defined in TS
31.111 [12]
### 5.4.9 Call control on EPS PDN connection by USIM
Requirement: USIM Service n°87 \"available\".
The procedures and commands for Call control on EPS PDN connection by USIM are
defined in TS 31.111 [12].
### 5.4.10 Communication Control for IMS by USIM
Requirement: USIM Service n°93 \"available\".
The procedures and commands for Communication Control for IMS by USIM are
defined in TS 31.111 [12]. It is mandatory for the ME to perform the
procedures if it has indicated that it supports Communication Control for IMS
by USIM in the TERMINAL PROFILE command.
### 5.4.11 USAT Facility Control
Requirement: The ME supports the USAT over AT feature specified in TS 31.111
[12].
Request: The ME performs the reading procedures of EF~UFC~.
### 5.4.12 Extended Terminal Applications
Requirement: Service n°77 and n°94 \"available\"
The procedures and commands for \"Extended Terminal Applications\" are defined
in TS 31.111 [12].
### 5.4.13 USAT application pairing procedure
The use of a USIM can be restricted to specific MEs using the USAT Application
Pairing procedure and information stored in the USIM as specified in this
specification and defined in 3GPP TS 33.187 [76].
To support the USAT Application Pairing procedure, the ME shall support USAT
PROVIDE LOCAL INFORMATION command (IMEI or IMEISV), as specified in 3GPP TS
31.111 [12].
USAT Application Pairing is successful when the IMEI or IMEISV retrieved from
the terminal belongs to a range of values the UICC is configured with in
EF~IAL~.
EF~IAL~, EF~IPS~, E~FIPD~ are defined in this document to support this
procedure.
If the service n°102 is \"available\" in the USIM Service Table, the UICC
shall start the UICC proactive session immediately after TERMINAL PROFILE and
the first proactive command shall be PROVIDE LOCAL INFORMATION with IMEI or
IMEISV. The ME shall respond with TERMINAL RESPONSE with IMEI or IMEISV before
performing any AUTHENTICATE command.
The UICC shall respond to any AUTHENTICATE command with error status words SW1
SW2 = \'69 85\' if:
\- IMEI or IMEISV provided by the ME is not in the corresponding allowed list
configured in the USIM (EF~IAL~)
\- ME has not provided any IMEI
If the AUTHENTICATE command had been executed before the pairing procedure has
been successfully performed (in the case of pre-Rel-12 MEs), the UICC may need
to trigger a network attachment procedure by sending a proactive command
REFRESH(3G SESSION RESET).
### 5.4.14 Call control on PDU Session by USIM
Requirement: USIM Service n°128 \"available\".
The procedures and commands for Call control on PDU Session by USIM are
defined in TS 31.111 [12].
## 5.5 MexE related procedures
MexE is an optional feature. The higher level procedures, and contents and
coding of the commands are given in TS 23.057 [30]. Procedures relating to the
transmission of commands and responses across the USIM/ME interface are given
in this clause. A USIM or ME supporting MexE shall conform to the requirements
given in this clause.
### 5.5.1 MexE ST
Requirement: Service n°41 (MexE) \"available\".
Request: The ME performs the reading procedure with EF~MexE-ST~
### 5.5.2 Operator root public key
Requirement: Service n°41 (MexE) \"available\" and MexE ST service n°1
(EF~ORPK~) \"available\".
Request: The ME performs the reading procedure with EF~ORPK~. The ME shall
analyse the data of EF~ORPK~ (clause 4.4.1.4.2) to identify the files
containing the certificate instances. If necessary, then the ME performs READ
BINARY commands on these files to assemble the complete certificate instance
data.
### 5.5.3 Administrator root public key
Requirement: Service n°41 (MexE) \"available\" and MexE ST service n°2
(EF~ARPK~) \"available\".
Request: The ME performs the reading procedure with EF~ARPK.~ The ME shall
analyse the data of EF~ARPK~ (clause 4.4.1.4.3) to identify the file
containing the certificate instance. If necessary, then the ME performs READ
BINARY commands on this file to assemble the complete certificate instance
data.
### 5.5.4 Third Party root public key(s)
Requirement: Service n°41 (MexE) \"available\" and MexE ST service n°3
(EF~TPRPK~) \"available\".
Request: The ME performs the reading procedure with EF~TPRPK.~ The ME shall
analyse the data of EF~TPRPK~ (clause 4.4.1.4.4) to identify the files
containing the certificate instances. If necessary, then the ME performs READ
BINARY commands on these files to assemble the complete certificate instance
data.
### 5.5.5 Trusted Key/Certificates Data Files
Requirement: Service n°41 (MexE) \"available\".
Request: The ME performs the reading procedure with EF~TKCDF.~ The ME shall
analyse the data of EF~TKCDF~ and, if necessary, perform READ BINARY commands
on these files
## 5.6 WLAN related procedures
### 5.6.1 WLAN Selection related Procedures
Requirement: service n°62 or n°63 or n°81 or n°82 or n°83 or n°84 or n°88
\"available\"
The ME shall read the User, Home and Operator controlled WSIDs, the I-WLAN
Equivalent HPLMN Presentation Indication, I-WLAN HPLMN Priority Indication,
the I-WLAN Last Registered PLMN and the HPLMN Direct Access Indicationfrom the
corresponding list files (i.e. EF~UWSIDL~, EF~HWSIDL~, EF~OWSIDL~,
EF~WEHPLMNPI~ , EF~WLRPLMN~, EF~WHPI~ and EF~HPLMDAI~)to perform WLAN
selection procedures as described in TS 24.234 [40].
The user may change the User controlled WSIDs.
### 5.6.2 WLAN PLMN Selection related procedures
Requirement: service n°60 or nº61 \"available\"
The ME shall read the User controlled PLMN selector and/or Operator controlled
PLMN selector in EF~UPLMNWLAN~ and EF~OPLMNWLAN~ respectively for WLAN PLMN
Selection procedures as described in TS 24.234 [40].
The user may change the User controlled PLMN selector for WLAN.
### 5.6.3 WLAN access authentication related procedures
Requirement: service n°59 \"available\"
When the ME tries a full authentication, it shall inspect if a valid Pseudonym
is available in EF~Pseudo.~and use it as the user name portion of the NAI for
WLAN access authentication following the procedures described in TS 24.234
[40].
The ME shall manage pseudonyms as defined in TS 24.234 [40].
### 5.6.4 WLAN access re-authentication related procedures
Requirement: service n°66 \"available\"
When the ME tries a fast re-authentication, it shall inspect if a valid
reauthentication identity is available in EF~WRI~ and use it as the user name
portion of the NAI for WLAN access re-authentication following the procedures
described in TS 24.234 [40].
The ME shall manage re-authentiction identities, Master Key and counter values
as described in TS 24.234 [40].
## 5.7 Network Connectivity Parameters for UICC IP connections related
procedures
The EF~NCP-IP~ access procedures are described in ETSI TS 102 483 [50].
Requirement: Service n°80 is \"available\"
Request: The terminal performs the read procedure with EF~NCP-IP~ before
establishing a remote data link for UICC remote IP connectivity as described
in ETSI TS 102 483 [50].
Refresh: The terminal performs the refresh procedure with EF~NCP-IP~.
## 5.8 H(e)NB related procedures
### 5.8.1 CSG Access Control procedures
Requirement: Service n°86 is \"available\"
Request: The terminal performs the read procedure with EF~ACSGL~.
Update: The terminal performs the updating procedure with EF~ACSGL~
The ME shall read the allowed CSG Ids from EF~ACSGL~ in order to perform
H(e)NB selection procedures. The lists in EF~ACSGL~ shall take precedence over
the list stored in the ME non-volatile memory.
Requirement: Service n°90 is \"available\"
Request: The terminal performs the read procedure with with EF~OCSGL~.
The ME shall read the Operator CSG Ids from EF~OCSGL~ in order to perform
H(e)NB selection procedures. The list in EF~OCSGL~ shall take precedence over
the list stored in the ME non-volatile memory.
Requirement: Service n°92 is \"available\"
In case of a manual CSG cell selection, the ME shall read EF~AD~ and CSG Lists
Display Indicators from EF~OCSGL~ and display CSG Ids accordingly. The
configuration in EF~OCSGL~ shall take precedence over the configuration stored
in the ME non-volatile memory.
If service n°92 is not \"available\", in case of a manual CSG cell selection,
all available CSGs may be displayed without any restriction.
### 5.8.2 CSG Type related procedures
Requirement: Service n°86 is \"available\"
Request: The terminal performs the read procedure with EF~ACSGL~ and EF~CSGT~.
Update: The terminal performs the updating procedure with EF~ACSGL~
The ME shall discover the association between the selected CSG ID and a CSG
Type from EF~ACSGL~. If this association exists, the provided CSG Type shall
be displayed.
Requirement: Service n°90 is \"available\"
Request: The terminal performs the read procedure with EF~OCSGL~ and
EF~OCSGT~.
The ME shall discover the association between the selected CSG ID and either a
CSG Type from EF~ACSGL~ or an Operator CSG Type from EF~OCSGL~. The Operator
CSG Type has precedence.
### 5.8.3 HNB name display related procedures
Requirement: Service n°86 is \"available\"
Request: The terminal performs the read procedure with EF~ACSGL~ and EF~HNBN~.
Update: The terminal performs the updating procedure with EF~ACSGL~ and
EF~HNBN~.
The ME shall discover the association between the selected CSG ID and a HNB
name from EF~ACSGL~. If this association exists, the provided HNB name shall
be displayed.
Requirement: Service n°90 is \"available\"
Request: The terminal performs the read procedure with EF~OCSGL~ and
EF~OHNBN~.
The ME shall discover the association between the selected CSG ID and either a
HNB Name from EF~ACSGL~ or an Operator HNB from EF~OCSGL~. The Operator HNB
Name has precedence. If this association exists, the HNB Name shall be
displayed.
Requirement: Service n°92 is \"available\"
In case of a manual CSG cell selection, the ME shall read EF~AD~ and the CSG
Lists Display Indicators from EF~OCSGL~ and display HNB Name accordingly. The
configuration in EF~OCSGL~ shall take precedence over the configuration stored
in the ME non-volatile memory.
If service n°92 is not \"available\", in case of a manual CSG cell selection,
all available CSGs may be displayed without any restriction.
## 5.9 ProSe related procedures
### 5.9.1 ProSe Direct Discovery Provisioning parameters
Requirement: service n°1 is \"available\" in the ProSe Service Table.
Request: The ME performs the reading procedure with EF~PROSE_MON~. and
EF~PROSE_ANN~.
### 5.9.2 HPLMN ProSe Function address
Requirement: service n°2 is \"available\" in the ProSe Service Table.
Request: The ME performs the reading procedure with EF~PROSEFUNC~.
### 5.9.3 ProSe direct communication related Procedures
Requirement: service n°3 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function.
Request: The ME performs the reading procedure with EF~PROSE_RADIO_COM~.
### 5.9.4 ProSe direct discovery related Procedures
Requirement: service n°4 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function.
Request: The ME performs the reading procedure with EF~PROSE_RADIO_MON~.
Requirement: service n°5 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function.
Request: The ME performs the reading procedure with EF~PROSE_RADIO_ANN~.
### 5.9.5 ProSe direct communication related Procedures
Requirement: service n°6 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function.
Request: The ME performs the reading procedure with EF~PROSE_POLICY~.
### 5.9.6 ProSe direct communication related Procedures
Requirement: service n°3 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function
Request: The ME performs the reading procedure with EF~PROSE_PLMN~.
### 5.9.7 ProSe Group Counter related Procedures
Requirement: service n°7 is \"available\" in the ProSe Service Table.
Request: The ME performs the reading procedure with EF~PROSE_GC~. The content
from the USIM shall be combined with that one from the non-volatile memory on
the ME, with USIM taking precedence in case the same group is available in
both.
Update: The ME performs the updating procedure with EF~PROSE_GC~. If the EF
does not have free space, the ME shall use the non-volatile memory on the ME.
The ME is responsible to remove entries no longer used from the EF~PROSE_GC~
in order to guarantee that EF is not filled with unnecessary entries.
### 5.9.8 ProSe Usage Information Reporting Configuration related Procedures
Requirement: service n°8 is \"available\" in the ProSe Service Table.
Request: The ME performs the reading procedure with EF~PROSE_UIRC~. The
content from the USIM shall be used by the ME to construct the content of the
usage information report according the procedures defined in TS 24.334[70],
with the USIM configuration parameters taking precedence in case the usage
information reporting configuration parameters have also been provisioned in
the ME.
### 5.9.9 ProSe Group Member Discovery related Procedures
Requirement: service n°10 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function.
Request: The ME performs the reading procedure with EF~PROSE_GM_DISCOVERY~.
### 5.9.10 ProSe Relay related Procedures
Requirement: service n°11 is \"available\" in the ProSe Service Table and
\"Prose services for Public Safety\" is enabled in EF~AD~ or the ME received
service authorization from the ProSe Function.
Request: The ME performs the reading procedure with EF~PROSE_RELAY~ and
EF~PROSE_RELAY_DISCOVERY~.
## 5.10 ePDG Selection related procedures
### 5.10.1 Home ePDG Identifier
Requirement: service n°106 and n°107 are \"available\" in the USIM Service
Table.
Request: The ME performs the reading procedure with EF~ePDGId~. The UE then
shall use the Home ePDG identifier(s) present in the EF~ePDGId~ to perform the
ePDG selection procedure as defined in 3GPP TS 24.302 [79].
If EF~ePDGId~ and EF~ePDGSelection~ are empty, the UE shall consider \"ePDG
configuration information is configured but empty\", then the UE shall follow
the procedure specified in the \"Selection of the ePDG\" UE procedure as
defined in 3GPP TS 24.302 [79].
### 5.10.2 ePDG Selection Information
Requirement: service n°106 and n°107 are \"available\" in the USIM Service
Table.
Request: The ME performs the reading procedure with EF~ePDGSelection~. The UE
then shall use the ePDG selection information present in the EF~ePDGSelection~
to perform the ePDG selection procedure as defined in 3GPP TS 24.302 [79].
If EF~ePDGId~ and EF~ePDGSelection~ are empty, the UE shall consider \"ePDG
configuration information is configured but empty\", then the UE shall follow
the procedure specified in the \"Selection of the ePDG\" UE procedure as
defined in 3GPP TS 24.302 [79].
### 5.10.3 ePDG configuration information configured but empty
Requirement: service n°106 is \"available\" and service n°107 is not
\"available\" in the USIM Service Table.
Request: The UE shall consider \"ePDG configuration information is configured
but empty\", then the UE shall follow the procedure specified in the
\"Selection of the ePDG\" UE procedure as defined in 3GPP TS 24.302 [79].
## 5.11 ACDC related procedures
### 5.11.1 ACDC Configuration
Requirement: service n°108 is \"available\".
Request: The ME performs the reading procedure with EF~ACDC~.
## 5.12 MCS related procedures
### 5.12.1 MCS configuration
Requirement: At least one of the services is \"available\" in the MCS Service
Table.
Request: The ME performs the reading procedure with EF~MCS\ _CONFIG~.
### 5.12.2 Void
### 5.12.3 Void
### 5.12.4 Void
## 5.13 ePDG Selection for Emergency Services related procedures
### 5.13.1 Emergency ePDG Identifier
Requirement: service n°110 and n°111 are \"available\" in the USIM Service
Table.
Request: The ME performs the reading procedure with EF~ePDGIdEm~. The UE then
shall use the Emergency ePDG identifier(s) present in the EF~ePDGIdEm~ to
perform the ePDG selection procedure.
If EF~ePDGIdEm~ and EF~ePDGSelectionEm~ are empty, the UE shall consider that
the ePDG configuration information for Emergency Services is configured but
empty.
### 5.13.2 ePDG Selection Information for Emergency Services
Requirement: service n°110 and n°111 are \"available\" in the USIM Service
Table.
Request: The ME performs the reading procedure with EF~ePDGSelectionEm~. The
UE then shall use the ePDG selection information for Emergency Services
present in the EF~ePDGSelectionEm~ to perform the ePDG selection procedure.
If EF~ePDGIdEm~ and EF~ePDGSelectionEm~ are empty, the UE shall consider that
the ePDG configuration information for Emergency Services is configured but
empty.
### 5.13.3 ePDG configuration information for Emergency Services configured
but empty
Requirement: service n°111 is \"available\" and service n°110 is not
\"available\" in the USIM Service Table.
Request: The UE shall consider the ePDG configuration information is
configured but empty.
### 5.13.4 From Preferred related procedures
Requirement: service n°114 is \"available\" in the USIM Service Table.
Request: The ME performs the reading procedure with EF~FromPreferred~. The UE
then shall use the From Preferred value in the EF~FromPreferred~ as described
in 3GPP TS 24.607 [86] clause 4.5.2.12.
### 5.13.5 IMS Configuration Data related procedures
Requirement: service n°115 is \"available\" in the USIM Service Table.
Request: The ME may perform the reading procedure with EF~IMSConfigData~. If
the ME performs the reading procedure with EF~IMSConfigData~, the UE shall use
the IMS Configuration Data in the EF~IMSConfigData~ as described in 3GPP TS
24.229 [63] clause L.2.2.5.1D and 3GPP TS 24.229 [63] clause 6.1.1.
### 5.13.6 XCAP Configuration Data related procedures
Requirement: service n°120 is \"available\" in the USIM Service Table.
Request: The ME may perform the reading procedure with EF~XCAPConfigData~ . If
the ME performs the reading procedure with EF~XCAPConfigData~ , the UE shall
use the EF~XCAPConfigData~ as described in TS 24.623 [102] clause 5.2.1.3 and
TS 24.623 [102] clause B.2
### 5.13.7 Multi-device and multi-identity related procedures
Requirement: service n°134 is \"available\" in the USIM Service Table.
Request: The ME performs the reading procedure with EF~MuDMiDConfigData~ . The
UE shall use the EF~MuDMiDConfigData~ as described in TS 24.174 [45] clauses
4.5.3.1 and 4.5.3.6.
## 5.14 V2X related procedures
### 5.14.1 V2X configuration
Requirement: service n°1 is \"available\" in the V2X Service Table.
Request: The ME performs the reading procedure with EF~V2X_CONFIG~.
### 5.14.2 V2X data policy over PC5
Requirement: service n°2 is \"available\" in the V2X Service Table.
Request: The ME performs the reading procedure with EF~V2X_PC5~.
### 5.14.3 V2X data policy over Uu
Requirement: service n°3 is \"available\" in the V2X Service Table.
Request: The ME performs the reading procedure with EF~V2X_Uu~.
## 5.15 UAC Access Identities related procedures
### 5.15.1 UAC Access Identities Configuration
Requirement: Service n°126 is \"available\".
Request: The ME performs the reading procedure with EF~UAC_AIC~.
## 5.16 CAG selection related procedures
### 5.16.1 Pre-configured CAG information list reading procedure for ME
Requirement: Service n°137 is \"available\".
Request: The ME performs the reading procedure with EF~CAG~ as specified in
3GPP TS 21.322 [31] clause 3.8.
## 5.17 5G ProSe related procedures
### 5.17.1 5G ProSe configuration data for direct discovery
Requirement: service n°139 is \"available\" in the USIM Service Table and
service n°1 is \"available\" in the 5G ProSe Service Table.
Request: The ME performs the reading procedure with EF~5G_PROSE_DD~.
### 5.17.2 5G ProSe configuration data for direct communication
Requirement: service n°139 is \"available\" in the USIM Service Table and
service n°2 is \"available\" in the 5G ProSe Service Table.
Request: The ME performs the reading procedure with EF~5G_PROSE_DC~.
### 5.17.3 5G ProSe configuration data for UE-to-network relay UE
Requirement: service n°139 is \"available\" in the USIM Service Table and
service n°3 is \"available\" in the 5G ProSe Service Table.
Request: The ME performs the reading procedure with EF~5G_PROSE_U2NRU~.
### 5.17.4 5G ProSe configuration data for remote UE
Requirement: service n°139 is \"available\" in the USIM Service Table and
service n°4 is \"available\" in the 5G ProSe Service Table.
Request: The ME performs the reading procedure with EF~5G_PROSE_RU~.
### 5.17.5 5G ProSe configuration data for usage information reporting
Requirement: service n°139 is \"available\" in the USIM Service Table and
service n°5 is \"available\" in the 5G ProSe Service Table.
Request: The ME performs the reading procedure with EF~5G_PROSE_UIR~.
## 5.18 Disaster roaming related procedures
### 5.18.1 Disaster roaming information reading procedure for ME
Requirement: Service n°140 is \"available\".
Request: If the ME supports MINT (see 3GPP TS 23.122 [31]), the ME performs
the reading procedure with EF~DRI~.
## 5.19 SNPN (Standalone NPN) related procedures
### 5.19.1 PWS configuration in SNPN.
Requirement: Service n°143 is \"available\".
Request: The ME performs the reading procedure with EF~PWS_SNPN.~
### 5.19.2 K~AUSF~ derivation configuration
Requirement: Service n° 145 is \"available\".
Request: The ME performs the reading procedure with EF~KAUSF_DERIVATION.~
## 5.20 NG-RAN satellite access related procedures
### 5.20.1 Multiplier coefficient for Higher Priority PLMN search via NG-RAN
satellite access for ME
Requirement: Service n°144 is \"available\".
Request: If the ME supports the NG-RAN via satellite access (see 3GPP TS
23.122 [31]), the ME performs the reading procedure with EF~MCHPPLMN~.
# 6 Security features
The security aspects of 3G are specified in TS 33.102 [13] and TS 33.103 [14].
This clause gives information related to security features supported by the
USIM to enable the following:
\- authentication of the USIM to the network;
\- authentication of the network to the USIM;
\- authentication of the user to the USIM;
\- data confidentiality over the radio interface;
\- file access conditions;
\- conversion functions to derive GSM parameters.
## 6.1 Authentication and key agreement procedure
This clause gives an overview of the authentication mechanism and cipher and
integrity key generation which are invoked by the network. For the
specification of the corresponding procedures across the USIM/ME interface see
clause 5.
The mechanism achieves mutual authentication by the user and the network
showing knowledge of a secret key K which is shared between and available only
to the USIM and the AuC in the user\'s HE. In addition, the USIM and the HE
keep track of counters SQN~MS~ and SQN~HE~ respectively to support network
authentication. SQN~HE~ is a counter in the HLR/AuC, individual for each user
and SQN~MS~ denotes the highest sequence number the USIM has ever accepted.
When the SN/VLR initiates an authentication and key agreement, it selects the
next authentication vector and sends the parameters RAND and AUTN
(authentication token) to the user. Each authentication token consists of the
following components: a sequence number SQN, an Authentication Management
Field (AMF) and a message authentication code MAC over the RAND, SQN and AMF.
The USIM checks whether AUTN can be accepted and, if so, produces a response
RES which is sent back to the SN/VLR. The SN/VLR compares the received RES
with XRES. If they match the SN/VLR considers the authentication and key
agreement exchange to be successfully completed. The USIM also computes CK and
IK. The established keys CK and IK will be used by the ME to perform ciphering
and integrity functions.
A permanent secret key K is used in this procedure. This key K has a length of
128 bits or 256 bits and is stored within the USIM for use in the algorithms
described below. Also more than one secret key K can be stored in the USIM.
The active key to be used by the algorithms is signalled within the AMF field
in the AUTN.
## 6.2 Cryptographic Functions
The names and parameters of the cryptographic functions supported by the USIM
are defined in TS 33.102 [13]. These are:
f1: a message authentication function for network authentication used to
compute XMAC;
f1*: a message authentication function for support to re-synchronisation with
the property that no valuable information can be inferred from the function
values of f1* about those of f1, ..., f5, f5* and vice versa;
f2: a message authentication function for user authentication used to compute
SRES;
f3: a key generating function to compute the cipher key CK;
f4: a key generating function to compute the integrity key IK;
f5: a key generating function to compute the anonymity key AK (optional);
f5*: a key generating function to compute AK in re-synchronisation procedures
with the property that no valuable information can be inferred from the
function values of f5* about those of f1, f1*, f2, ..., f5 and vice versa.
These cryptographic functions may exist either discretely or combined within
the USIM.
## 6.3 GSM Conversion Functions
To gain GSM access, the USIM provides the conversion functions c2 and c3.
These functions derive the required GSM parameters (SRES, cipher key Kc) from
available 3G parameters.
## 6.4 User verification and file access conditions
The security architecture as defined in TS 31.101 [11] applies to the USIM
application with the following definitions and additions.
\- The USIM application shall use a global key reference as PIN and local key
reference as PIN2. For access to DF~TELECOM~ the PIN shall be verified. Access
with PIN2 is limited to the ADF(USIM).
\- The only valid values for the usage qualifier are \'00\' (verification
requirement is not used) and \'08\' (user authentication knowledge based
(PIN)) as defined in ISO/IEC 7816‑4 [20].
Disabling of PIN2 is allowed. This is, however, not the case if PIN2 is mapped
to the CHV2 of a GSM application.
# 7 USIM Commands
## 7.1 AUTHENTICATE
### 7.1.1 Command description
The function can be used in several different contexts:
\- a 5G security context, when 5G authentication vectors (RAND, XRES, CK, IK,
AUTN) are available (i.e. the UE is located in a 5GS domain, as specified in
TS 33.501 [105] or
\- a EPS security context, when EPS authentication vectors (RAND, XRES, CK,
IK, AUTN) are available (i.e. the UE is located in an EPS domain, as specified
in TS 33.401 [52] or
\- a 3G security context, when 3G authentication vectors (RAND, XRES, CK, IK,
AUTN) are available (i.e. the UE is located in the UTRAN, or in a GSM radio
access network which is connected to a 3G or 3G capable VLR/SGSN), or
\- a GSM security context, when GSM authentication data are available only
(i.e. the UE is located in the GSM radio access network which is connected to
a non-3G capable VLR/SGSN)
\- a VGCS/VBS security context, when VGCS/VBS authentication data is available
\- a GBA_U security context, when a GBA bootstrapping procedure is requested
\- a MBMS security context, when a MBMS security procedure is requested
\- a Local Key Establishment security context, when a Local Key Establishment
procedure is requested.
The function is used in GSM or 3G/EPS/5G security context during the procedure
for authenticating the USIM to its HE and vice versa. In addition, a cipher
key and an integrity key are calculated. For the execution of the command the
USIM uses the subscriber authentication key K, which is stored in the USIM.
The function is used in VGCS/VBS security context during the procedure for
retrieving the VGCS/VBS Short Term Key (VSTK) used by the terminal in
establishing VGCS/VBS calls.
The function is used in GBA security context in two different modes:
a) Bootstrapping Mode: during the procedure for mutual authenticating of the
USIM and the Bootstrapping Server Function (BSF) and for deriving bootstrapped
key material from the AKA run.
b) NAF Derivation Mode: during the procedure for deriving Network Application
Function (NAF) specific keys from previous bootstrapped key material.
The function is used in MBMS security context in two different modes:
a) MSK Update Mode: during the procedure for updating an MBMS Service Key
(MSK).
b) MTK Generation Mode: during the procedure for retrieving the MBMS Traffic
Key (MTK) used by the terminal to decrypt MBMS data.
The function is related to a particular USIM and shall not be executable
unless the USIM application has been selected and activated, and the current
directory is the USIM ADF or any subdirectory under this ADF and a successful
PIN verification procedure has been performed (see clause 5).
#### 7.1.1.1 3G/EPS/5G security context
The USIM first computes the anonymity key AK = f5~K~ (RAND) and retrieves the
sequence number SQN = (SQN ⊕ AK) ⊕ AK.
Then the USIM computes XMAC = f1~K~ (SQN \|\| RAND \|\| AMF) and compares this
with the MAC which is included in AUTN. If they are different, the USIM
abandons the function.
Next the USIM verifies that the received sequence number SQN is previously
unused. If it is unused and its value is lower than SQN~MS~, it shall still be
accepted if it is among the last 32 sequence numbers generated. A possible
verification method is described in TS 33.102 [13].
NOTE: This implies that the USIM has to keep a list of the last used sequence
numbers and the length of the list is at least 32 entries.
If the USIM detects the sequence numbers to be invalid, this is considered as
a synchronisation failure and the USIM abandons the function. In this case the
command response is AUTS, where:\ _AUTS = Conc(SQN~MS~)_ \|\| _MACS;\
Conc(SQN~MS~) = SQN~MS~ ⊕ f5*~K~(RAND)_ is the concealed value of the counter
_SQN~MS~_ in the USIM; and.\ _MACS = f1*~K~(SQN~MS~ \|\| RAND \|\| AMF)_
where:\ _RAND_ is the random value received in the current user authentication
request;\ the AMF assumes a dummy value of all zeroes so that it does not need
to be transmitted in clear in the resynchronisation message.
If the sequence number is considered in the correct range, the USIM computes
RES = f2~K~ (RAND), the cipher key CK = f3~K~ (RAND) and the integrity key IK
= f4~K~ (RAND) and includes these in the command response. Note that if this
is more efficient, RES, CK and IK could also be computed earlier at any time
after receiving RAND.
The use of AMF is HE specific and while processing the command, the content of
the AMF has to be interpreted in the appropriate manner. The AMF may e.g. be
used for support of multiple algorithms or keys or for changing the size of
lists, see TS 33.102 [13].
If Service n°27 is \"available\", the USIM calculates the GSM response
parameter K~C~, using the conversion function defined in TS 33.102 [13].
Input:
‑ RAND, AUTN (AUTN:= SQN ⊕ AK \|\| AMF \|\| MAC).
Output:
\- RES, CK, IK if Service n°27 is \"not available\".
Or
\- RES, CK, IK, K~C~ if Service n°27 is \"available\".
Or
\- AUTS.
#### 7.1.1.2 GSM security context
USIM operation in an GSM security context is supported if Service n°38 is
\"available\".
The USIM computes RES = f2~K~ (RAND), the cipher key CK = f3~K~ (RAND) and the
integrity key IK = f4~K~ (RAND). Next the USIM calculates the GSM response
parameters SRES and K~C~, using the conversion functions defined in TS 33.102
[13].
Input:
‑ RAND.
Output:
‑ SRES; K~C~.
#### 7.1.1.3 VGCS/VBS security context
USIM operation in a VGCS/VBS security context is supported if both Service
n°57 and Service n°64 are \"available\" (VGCS security context) or if both
Service n°58 and Service n°65 are \"available\" (VBS security context).
The USIM computes the Short Term Key (VSTK) associated with a particular
VGCS/VBS Group Identifier (Group_Id). For this computation, the USIM uses the
Voice Group (for VGCS) or Broadcast Group (for VBS) Key (V_Ki) identified by
their respective Group_Id and Master Group Key Identifier (VK_Id). The USIM
retrieves the Group_Id and the service flag (VGCS or VBS) from the received
Voice Service Identifier (Vservice_Id).
NOTE: The Group_Id has a variable length according to TS 43.068 [46].
The USIM shall first search if the Group_Id corresponds to a stored VGCS Group
Identifier in EF**~VGCS~** or a stored VBS Group Identifier in EF**~VBS~**.
Then, the USIM shall retrieve the V_Ki corresponding to the given Group_Id and
VK_Id.
Then the USIM uses V_Ki and VSTK_RAND as input parameters for the A8_V key
derivation function (as defined in TS 43.020 [44]) in order to compute and
returns VSTK.
Input:
‑ Vservice_Id, VK_Id, VSTK_RAND
Output:
‑ VSTK.
#### 7.1.1.4 GBA security context (Bootstrapping Mode)
USIM operations in GBA security context are supported if service n°68 is
\"available\".
The USIM receives the RAND and AUTN*. The USIM first computes the anonymity
key AK = f5~K~ (RAND) and retrieves the sequence number SQN = (SQN ⊕ AK) ⊕ AK.
The USIM calculates IK = f4~K~ (RAND) and MAC (by performing the MAC
modification function described in TS 33.220 [42]). Then the USIM computes
XMAC = f1~K~ (SQN \|\| RAND \|\| AMF) and compares this with the MAC
previously produced. If they are different, the USIM abandons the function.
Then the USIM performs the checking of AUTN* as in UMTS security context. If
the USIM detects the sequence numbers to be invalid, this is considered as a
synchronisation failure and the USIM abandons the function. In this case the
command response is AUTS, which is computed as in UMTS security context.
If the sequence number is considered in the correct range, the USIM computes
RES = f2~K~ (RAND) and the cipher key CK = f3~K~ (RAND).
The USIM then derives and stores GBA_U bootstrapped key material from CK, IK
values. The USIM shall also stores RAND in the RAND field of EF~GBABP~
The USIM stores GBA_U bootstrapped key material from only one bootstrapping
procedure. The previous bootstrapped key material, if present, shall be
replaced by the new one. This key material is linked with the data contained
in EF~GBABP~ : RAND, which is updated by the USIM and B-TID, which shall be
further updated by the ME.
NOTE: According to TS 33.220 [42], NAF-specific keys that may be stored on the
USIM are not affected by this bootstrapping operation.
RES is included in the command response after flipping the least significant
bit.
Input:
‑ RAND, AUTN*
Output:
\- RES
> or
\- AUTS
#### 7.1.1.5 GBA security context (NAF Derivation Mode)
USIM operations in GBA security context are supported if service n°68 is
\"available\".
The USIM receives the NAF_ID and IMPI.
The USIM performs Ks_ext_NAF and Ks_int_NAF derivation as defined in TS 33.220
[42] using the key material from the previous GBA_U bootstrapping procedure.
If no key material is available this is considered as a GBA Bootstrapping
failure and the USIM abandons the function. The status word \'6985\'
(Conditions of use not satisfied) is returned.
Otherwise, the USIM stores Ks_int_NAF and associated B-TID together with
NAF_ID. The Ks_int_NAF keys related to other NAF_Ids, which are already stored
in the USIM, shall not be affected. The USIM updates EF~GBANL~ as follows:
\- If a record with the given NAF_ID already exists, the USIM updates the
B-TID field of this record with the B-TID value associated to the GBA_U
bootstrapped key involved in this GBA_U NAF derivation procedure.
\- If a record with the given NAF_ID does not exist, the USIM uses an empty
record to store the NAF_ID and the B-TID value associated to the GBA_U
bootstrapped key involved in this GBA_U NAF Derivation procedure.
NOTE: According to TS 33.220 [42], the USIM can contain several Ks_int_NAF
together with the associated B-TID and NAF_ID, but there is at most one pair
of Ks_int_NAF and associated B-TID stored per NAF_ID.
\- In case no empty record is available the USIM shall overwrite an existing
record to store the NAF_ID and the B-TID value associated to the GBA_U
bootstrapped key involved in this GBA_U NAF Derivation procedure. To determine
the record to overwrite, the USIM shall construct a list of record numbers by
storing in the list first position the record number of the last used (i.e.
involved in an Authentication command) or derived Ks_int_NAF and by shifting
down the remaining list elements. The last record number in this list
corresponds to the record to overwrite when the USIM runs out of free records.
If an existing record corresponding to a Ks_int_NAF key in use is overwritten,
the application Ks_int_NAF shall not be affected (e.g. in case a Ks_int_NAF
was put into use as an MBMS MUK key, the MUK key shall continue to be
available for the MBMS application).
Then, the USIM returns Ks_ext_NAF.
Input:
‑ NAF_ID, IMPI
Output:
\- Ks_ext_NAF
#### 7.1.1.6 MBMS security context (MSK Update Mode)
USIM operations in MBMS security context are supported if service n°69 is
\"available\".
The USIM receives the MIKEY packet containing an MSK update message. First,
the USIM uses the MUK ID to identify the Ks_int_NAF corresponding with a
previous bootstrapping procedure.
The USIM shall check if a new NAF derivation procedure involving the received
Idi in the MIKEY message has been performed or if it is the first time that
this Idi is used. If this check cannot be performed because the corresponding
Ks_int_NAF key was overwritten, the USIM abandons the function and returns the
status word \'6985\' (Conditions of use not satisfied). In case of a new NAF
derivation procedure or a new Idi, the USIM shall store the last bootstrapped
Ks_int_NAF as the last generated MUK and update EF~MUK~ as follows:
\- If a record with the received Idi (included in the MUK ID: see TS 33.246
[43]) value is already present, then the MUK ID is stored in the corresponding
field of this record, and the associated Time Stamp Counter (TS) field is
reset. Additionally, the USIM internally stores the last successfully used MUK
(i.e. MUK that was used during the last successful MSK update procedure),
along with its MUK ID for further use (e.g. to detect Key freshness failure).
\- If a record with the received Idi does not exist, the USIM uses an empty
record to include the MUK ID, and reset the associated TS field.
\- In case there is no empty record available in EF~MUK~ the USIM abandons the
function and the status word \'9867\' (Authentication error, no available
memory space in EF~MUK~) is returned.
NOTE: In case no empty record in EF~MUK~ is available the ME should run a MUK
Deletion Mode procedure to free entries in EF~MUK~ before running an MSK
Update Mode procedure that involves a new MUK key.
NOTE: In case the ME receives the status word \'6985\', the ME should derive
the required Ks_int_NAF key. In case the corresponding bootstrapping key Ks is
still available, the ME should invoke the Authenticate command in \"GBA - NAF
derivation Mode\" before invoking again the AUTHENTICATE command in \"MBMS -
MSK Update Mode\". In case the corresponding bootstrapping key has been
updated, the ME should put the new B-TID into use.
If the received MUK ID does not correspond to the last generated MUK (i.e.
last bootstrapped MUK) then the USIM proceeds as follows:
\- If the received MUK ID corresponds to the last successfully used MUK then
the USIM uses this MUK to verify the integrity of the message. If the
verification is unsuccessful, the USIM abandons the function and returns the
status word \'9862\' (Authentication error, incorrect MAC). If the
verification is successful, the USIM abandons the function and returns the
status word \'9865\' (Key Freshness Failure), indicating to the ME that the
received MIKEY message is protected using the last successfully used MUK that
does not correspond to the last generated MUK (the new B-TID shall be put into
use: see TS 33.246 [43]). In this case, the USIM shall not return a MIKEY
verification message.
\- Otherwise, this is considered as a bootstrapping failure (incorrect MUK)
and the USIM abandons the function. The status word \'6A88\' (Referenced data
not found) is returned.
Otherwise, if the received MUK ID corresponds to the last generated MUK, the
USIM uses the MUK value for MSK validation and derivation functions as
described in TS 33.246 [43]. If the validation is unsuccessful, the status
word \'9862\' (Authentication error, incorrect MAC) is returned and the USIM
abandons the function.
After a successful MSK Update procedure the USIM stores the received
credentials (e.g. MSK and/or Key Validity data) and updates EF~MSK~ as
follows:
\- If a record with the received Key Domain ID and Key Group part (i.e. Key
Group part of the MSK ID) already exists, USIM stores the older MSK ID (if
any) and its associated TS as the 2^nd^ MSK ID and TS. The newer MSK ID is
stored as the 1^st^ MSK ID. In case the received MSK message has the same MSK
ID as a stored MSK, the TS associated to this stored MSK is stored as the
1^st^ TS. Otherwise, the 1^st^ TS value is reset. The number of stored MSK IDs
and corresponding TS shall be set to \'02\' if the USIM stores two different
MSK IDs. The USIM shall not store two MSK IDs with the same Key Number part in
the same record.
\- If a record with the received Key Domain ID and Key Group part does not
exist, the USIM uses an empty record to include those values. The received MSK
ID is stored as the 1^st^ MSK ID and the associated TS is reset. The 2^nd^ MSK
ID and the associated TS are set to \'FF FF\'. The number of stored MSK IDs
and corresponding TS shall be set to \'01\'. In case there is no empty record
available in EF~MSK~ the USIM abandons the function and the status word
\'9866\' (Authentication error, no available memory space) is returned.
\- In the case of a BM-SC solicited pull procedure (i.e. when the Key Number
part of the MSK ID is set to 0x0), EF~MSK~ is not updated.
NOTE: In case no empty record is available the ME should run an MSK Deletion
Mode procedure to free entries in EF~MSK~ before running an MSK Update Mode
procedure that contains a new MSK key.
Then, the USIM stores the Time Stamp field (retrieved from the MIKEY message)
in its corresponding field under EF~MUK~.
The USIM stores internally the last successfully used MUK along with its MUK
ID for further use. This MUK may be used beyond its GBA validity (i.e. after
the derivation of a new Ks_int_NAF resulting from a new bootstrap procedure)
to verify the integrity of a MIKEY message in order to detect a
synchronization failure. This may occur if the last derived Ks_int_NAF did not
reach the BM-SC.
The MSK is not necessarily updated in the MIKEY message, since a MSK transport
message can be sent e.g. to update the Key Validity data or as part of a BM-SC
solicited pull procedure. In such a case the USIM shall use the status word
\'9000\' to inform the ME that the MIKEY message validation using the last
generated MUK has succeeded.
Finally, if the V-bit in the HDR field of the received MIKEY message is set
then the USIM shall produce a MSK Verification Message as described in TS
33.246 [43]. In this case the command response is the MIKEY verification
message.
Input:
‑ MIKEY message
Output:
\- MIKEY message
or
\- None
#### 7.1.1.7 Void
#### 7.1.1.8 MBMS security context (MTK Generation Mode)
USIM operations in MBMS security context are supported if service n°69 is
\"available\".
The USIM receives the MIKEY message containing an MBMS MTK and a Salt key (if
Salt key is available). First, the USIM retrieves the MSK with the Key Domain
ID and the MSK ID given by the Extension payload of the MIKEY message (as
described in TS 33.246 [43]).
If the needed MSK does not exist, this is considered as a MSK failure and the
USIM abandons the function. The status word \'6A88\' (Referenced data not
found) is returned.
If the key validity data of the MSK indicates an invalidated MSK (i.e. SEQl is
greater than SEQu) then the USIM returns the status word \'6985\' (Conditions
of use not satisfied) and abandons the function. SEQl and SEQu are defined in
TS 33.246 [43].
Otherwise, the USIM performs the MBMS Generation and Validation Function
(MGV-F) as described in TS 33.246 [43] using MSK.
If the USIM detects that the given MTK ID is invalid, this is considered as a
SEQp freshness failure and the USIM abandons the function. The status word
\'9865\' (Key freshness failure) is returned.
If the integrity validation of the MIKEY message is unsuccessful, the USIM
abandons the function and returns the status word \'9862\' (Authentication
error, incorrect MAC).
After successful MGV_F procedure the USIM stores the Time Stamp field
(retrieved from the MIKEY message) as the Time Stamp Counter (TS) associated
with the involved MSK under EF~MSK~
The USIM also stores MTK ID (retrieved from the MIKEY message) as the SEQl
associated with MSK.
Then, the USIM returns MTK and Salt key (if Salt key is available).
Input:
‑ MIKEY message
Output:
> \- MTK and Salt (if available).
#### 7.1.1.9 MBMS security context (MSK Deletion Mode)
USIM operations in MBMS security context are supported if service n°69 is
\"available\".
The USIM receives the Key Domain ID and the Key Group part of the MSK ID. The
USIM shall identify in the EF~MSK~ the record containing MSK IDs having this
Key Domain ID and Key Group part.
If no record is identified, the USIM abandons the function and returns the
status word \'6A88\' (Referenced data not found).
If a record is found, the USIM shall delete all corresponding MSKs and set to
\'FF\' the bytes of this record.
Input:
‑ Key Domain ID, MSK ID Key Group part
Output:
> \- None.
#### 7.1.1.10 MBMS security context (MUK Deletion Mode)
USIM operations in MBMS security context are supported if service n°69 is
\"available\".
The USIM shall identify in EF~MUK~ the record containing the received MUK ID.
If no record is identified, the USIM abandons the function and returns the
status word \'6A88\' (Referenced data not found).
If a record is found, the USIM shall delete the corresponding MUK and set to
\'FF\' the bytes of this record. If a corresponding Ks_int_NAF key is present
(i.e. with the same NAF_ID), it shall be deleted and its corresponding record
in EF~GBANL~ shall be set to \'FF\'. In case the corresponding Ks key is
present (i.e. with the same B-TID), it shall be deleted and the content of
EF~GBABP~ shall be set to \'FF\'.
Input:
MUK ID TLV
Output:
\- None
#### 7.1.1.11 Local Key Establishment security context (Key Derivation mode)
USIM operations in this security context are supported if service n°68 and
service n°76 are \"available\".
The USIM receives the NAF_ID corresponding to the NAF Key Centre, the
Terminal_ID, the Terminal_appli_ID, the UICC_appli_ID, RANDx, the Counter
Limit value and the MAC as described in TS 33.110 [47].
The USIM uses the NAF_ID to identify the Ks_int_NAF associated to the NAF Key
Centre. If no valid Ks_int_NAF is available, this is considered as a Key
Establishment failure and the USIM abandons the function. The status word
\'6A88\' (Referenced data not found) is returned.
If the Ks_local key derivation is not authorized by the local UICC policy
(e.g. Terminal_appli_ID/UICC_appli_ID association not authorized or
Terminal_ID value not authorized), the USIM abandons the function. The status
word \'6985\' (Conditions of use not satisfied) is returned.
Otherwise, the USIM retrieves the appropriate Ks_int_NAF, derives Ks_local as
described in TS 33.110 [47]. The USIM verifies the MAC value received from the
Terminal as described in TS 33.110 [47]:
\- If the verification is unsuccessful, the USIM abandons the function and
returns the status word \'9862\' (Authentication error, incorrect MAC).
\- If the verification is successful, the USIM stores Ks_local and associated
parameters Terminal_ID, Terminal_appli_ID, UICC_appli_ID, RANDx and the
Ks_local Counter Limit. The USIM returns the Local Key Establishment Operation
Response TLV (indicating a successful Key Derivation operation) and a response
MAC, which is derived as described in TS 33.110 [47].
The minimum number of Local keys that can be stored by the USIM shall be
defined by the service provider at the pre-issuance of the card.
In case the maximum number of Local Key was already reached or there is not
enough available memory in the USIM, the USIM shall overwrite a Local Key and
its associated data in order to store the new one. To determine the Ks_local
to overwrite, the USIM shall construct a list of Ks_local identifiers by
storing in the list first position the Ks_local identifier of the last used or
derived Ks_local and by shifting down the remaining list elements. The last
Ks_local identifier in this list corresponds to the Ks_local to overwrite when
the USIM runs out of free memory or when the maximum number of Ks_local keys
is reached. If an existing Ks_local in use is overwritten, the application
using Ks_local shall not be affected.
Input:
\- Local Key Establishment Mode (Key Derivation mode), Counter Limit, request
MAC, Key Identifier (i.e. NAF_ID, Terminal_ID, Terminal_appli_ID,
UICC_appli_ID, RANDx)
Output:
\- Key Derivation operation status, response MAC.
#### 7.1.1.12 Local Key Establishment security context (Key Availability Check
mode)
USIM operations in this security context are supported if service n°68 and
service n°76 are \"available\".
The USIM receives a Ks_local identifier. The USIM checks if a corresponding
valid Ks_local is available. If a valid Ks_local key is available the Local
Key Establishment Operation Response TLV (indicating a successful Key
Availability Check operation) is returned. In case no valid Ks_local key is
available the command fails and the status word \'6A88\' (Referenced data not
found) is returned.
Input:
Local Key Establishment Mode (Key Availability Check mode), Key identifier
(i.e. NAF_ID, Terminal_ID, Terminal_appli_ID, UICC_appli_ID, RANDx).
Output:
\- Key Availability Check Operation Status.
### 7.1.2 Command parameters and data
This command can be used with an EVEN or an ODD instruction (INS) code. The
EVEN instruction code can be used when the challenge data provided by the
terminal is not TLV encapsulated data and the length of the challenge data
provided by the terminal is less than 256 bytes.
The ODD instruction code shall be used with the security context specified in
table 2, when challenge and response data is TLV encapsulated regardless of
their length. Terminals and UICCs that do not support security context
requiring TLV format (e.g. MBMS), do not have to support AUTHENTICATE command
with ODD instruction code.
EVEN INS code
* * *
Code Value CLA As specified in TS 31.101 [11] INS \'88\' P1 \'00\' P2 See
table 1 below Lc See below Data See below Le \'00\', or maximum length of data
expected in response
* * *
Parameter P2 specifies the authentication context as follows:
Table 7.1.2-1: Coding of the reference control P2
+--------------------+------------------------------------------------+ | Coding | Meaning | | | | | b8-b1 | | +--------------------+------------------------------------------------+ | \'1-------\' | Specific reference data (e.g. DF | | | specific/application dependant key) | +--------------------+------------------------------------------------+ | \'----- XXX\' | Authentication context: | | | | | | 000 GSM context | | | | | | 001 3G/EPS/5G context | | | | | | 010 VGCS/VBS context | | | | | | 100 GBA context | +--------------------+------------------------------------------------+
All other codings are RFU.
ODD INS code
The authentication data and the authentication response data are encapsulated
in BER-TLV objects structured using tag \'73\' for BER-TLV structured data and
tag \'53\' otherwise.
How this command can chain successive blocks of authentication data, or
authentication response data is described in TS 31 101 [11].
If P1 indicates \"First block of authentication data\" or \"Next block of
authentication data\":
Input:
> \- Authentication data encapsulated in a BER-TLV data object.
Output:
> \- None.
* * *
Code **Value** CLA As specified in TS 31.101 [11] INS \'89\' P1 As specified
in TS 31.101 [11] P2 See table 2 below Lc Length of the subsequent data field
Data Authentication related data Le Not present
* * *
If P1 indicates \"First block of authentication response data\" or \"Next
block of authentication response data\":
Input:
> \- None.
Output:
> \- Authentication response data encapsulated in a BER-TLV data object.
* * *
Code **Value** CLA As specified in TS 31.101 [11] INS \'89\' P1 As specified
in TS 31.101 [11] P2 See table 2 below Lc Not present Data Not present Le
Length of the response data
* * *
Parameter P1 is used to control the data exchange between the terminal and the
UICC as defined in TS 31.101 [11].
Parameter P2 specifies the authentication context as follows:
Table 7.1.2-2: Coding of the reference control P2
+--------------------+------------------------------------------------+ | Coding | Meaning | | | | | b8-b1 | | +--------------------+------------------------------------------------+ | \'1-------\' | Specific reference data (e.g. DF | | | specific/application dependant key) | +--------------------+------------------------------------------------+ | \'----- XXX\' | Authentication context: | | | | | | 101 MBMS context | | | | | | 110 Local Key Establishment mode | +--------------------+------------------------------------------------+
All other codings are RFU.
Command parameters/data:
#### 7.1.2.1 GSM/3G/EPS/5G security context
* * *
**Byte(s)** **Description** **Length** 1 Length of RAND (L1) 1 2 to (L1+1)
RAND L1 (L1+2) Length of AUTN (L2) (see note) 1 (L1+3) to (L1+L2+2) AUTN (see
note) L2 Note: Parameter present if and only if in 3G/EPS/5G security context.
* * *
The coding of AUTN is described in TS 33.102 [13]. The most significant bit of
RAND is coded on bit 8 of byte 2. The most significant bit of AUTN is coded on
bit 8 of byte (L1+3).
Response parameters/data, case 1, 3G/EPS/5G security context, command
successful:
+---------------------------+---------------------------+------------+ | **Byte(s)** | **Description** | **Length** | +---------------------------+---------------------------+------------+ | 1 | \"Successful 3G | 1 | | | authentication\" tag = | | | | \'DB\' | | +---------------------------+---------------------------+------------+ | 2 | Length of RES (L3) | 1 | +---------------------------+---------------------------+------------+ | 3 to (L3+2) | RES | L3 | +---------------------------+---------------------------+------------+ | (L3+3) | Length of CK (L4) | 1 | +---------------------------+---------------------------+------------+ | (L3+4) to (L3+L4+3) | CK | L4 | +---------------------------+---------------------------+------------+ | (L3+L4+4) | Length of IK (L5) | 1 | +---------------------------+---------------------------+------------+ | (L3+L4+5) to (L3+L4+L5+4) | IK | L5 | +---------------------------+---------------------------+------------+ | (L3+L4+L5+5) | Length of K~C~ (= 8) (see | 1 | | | note) | | +---------------------------+---------------------------+------------+ | (L3+L4+L5+6 | K~C~ (see note) | 8 | | | | | | to | | | | | | | | (L3+L4+L5+13) | | | +---------------------------+---------------------------+------------+ | Note: Parameter present | | | | if and only if Service | | | | n°27 is \"available\". | | | +---------------------------+---------------------------+------------+
The most significant bit of RES is coded on bit 8 of byte 3. The most
significant bit of CK is coded on bit 8 of byte (L3+4). The most significant
bit of IK is coded on bit 8 of byte (L3+L4+5).
Response parameters/data, case 2, 3G/EPS/5G security context, synchronisation
failure:
* * *
**Byte(s)** **Description** **Length** 1 \"Synchronisation failure\" tag =
\'DC\' 1 2 Length of AUTS (L1) 1 3 to (L1+2) AUTS L1
* * *
The coding of AUTS is described in TS 33.102 [13]. The most significant bit of
AUTS is coded on bit 8 of byte 3.
Response parameters/data, case 3, GSM security context, command successful:
* * *
**Byte(s)** **Description** **Length** 1 Length of SRES (= 4) 1 2 to 5 SRES 4
6 Length of K~C~ (= 8) 1 7 to 14 K~C~ 8
* * *
The most significant bit of SRES is coded on bit 8 of byte 2. The most
significant bit of Kc is coded on bit 8 of byte 7.
#### 7.1.2.2 VGCS/VBS security context
* * *
**Byte(s)** **Description** **Length** 1 Length of Vservice_Id 1 2 to 5
Vservice_Id 4 6 Length of VK_Id 1 7 VK_Id 1 8 Length of VSTK_RAND (L1) 1 9 to
L1+8 VSTK_RAND L1
* * *
Vservice_Id is coded in the same way as the octets 2-5 in the Descriptive
group or broadcast call reference information element as defined in TS 24.008
[9].
An Example for the coding of Vservice_Id can be found in Annex K.
The coding of VK_Id is as follows:
Coding of VK_Id
+--------------+------------------------------------+ | Coding | Meaning | | | | | b8-b1 | | +--------------+------------------------------------+ | \'00000001\' | Corresponds to the 1^st^ group key | +--------------+------------------------------------+ | \'00000010\' | Corresponds to the 2^nd^ group key | +--------------+------------------------------------+
The coding of VSTK_RAND is described in TS 43.020 [44]. The VSTK_RAND shall be
inserted left-aligned into the L1 bytes, with unused bits to the right set to
zero.
Response parameters/data, VGCS/VBS security context, command successful:
* * *
**Byte(s)** **Description** **Length** 1 \"Successful VGCS/VBS operation\" tag
= \'DB\' 1 2 Length of VSTK (16) 1 3 to 18 VSTK 16
* * *
#### 7.1.2.3 GBA security context (Bootstrapping Mode)
* * *
**Byte(s)** **Description** **Length** 1 \"GBA Security Context Bootstrapping
Mode\" tag = \'DD\' 1 2 Length of RAND (L1) 1 3 to (L1+2) RAND L1 (L1+3)
Length of AUTN (L2) 1 (L1+4) to (L1+L2+3) AUTN L2
* * *
Response parameters/data, GBA security context (Bootstrapping Mode),
synchronisation failure:
* * *
**Byte(s)** **Description** **Length** 1 \"Synchronisation failure\" tag =
\'DC\' 1 2 Length of AUTS (L1) 1 3 to (L1+2) AUTS L1
* * *
AUTS coded as for UMTS Security context.
Response parameters/data, GBA security context (Bootstrapping Mode), command
successful:
* * *
**Byte(s)** **Description** **Length** 1 \"Successful GBA operation\" tag =
\'DB\' 1 2 Length of RES (L) 1 3 to (L+2) RES L
* * *
RES coded as for UMTS Security context.
#### 7.1.2.4 GBA security context (NAF Derivation Mode)
* * *
**Byte(s)** **Description** **Length** 1 \"GBA Security Context NAF Derivation
Mode\" tag = \'DE\' 1 2 Length of NAF_ID (L1) 1 3 to (L1+2) NAF_ID L1 (L1+3)
Length of IMPI (L2) 1 (L1+4) to (L1+L2+3) IMPI L2
* * *
Response parameters/data, GBA security context (NAF Derivation Mode), command
successful:
* * *
**Byte(s)** **Description** **Length** 1 \"Successful GBA operation\" tag =
\'DB\' 1 2 Length of Ks_ext_NAF (L) 1 3 to (L+2) Ks_ext_NAF L
* * *
Coding of Ks_ext_NAF as described in TS 33.220 [42].
#### 7.1.2.5 MBMS security context (All Modes)
* * *
**Byte(s)** **Description** **Coding** **Length** 1 MBMS Data Object tag
(\'53\') As defined in TS 31.101 [11] for BER-TLV data object 1 2 to 1+A bytes
(A ≤ 4) MBMS Data Object length (L1) As defined in TS 31.101 [11] for BER-TLV
data object A A+2 MBMS Security Context Mode See below 1 A+3 to (A+L1+1) MIKEY
message or Key Domain ID \|\| MSK ID Key Group part or MUK ID TLV L1-1
* * *
Only the MIKEY message shall be transmitted in the MBMS security context mode
\'01\' or \'02\'.
Only the Key Domain ID (coded on 3 bytes as described in TS 33.246 [43])
concatenated with the Key Group part of the MSK ID (coded on two bytes as
described in TS 33.246 [43] where the last transmitted byte represents the
least significant byte of the Key Group part) shall be transmitted in the MBMS
security context mode \'03\'.
Only the MUK ID TLV shall be transmitted in the MBMS security context mode
\'04\'. The MUK ID TLV, containing the MUK Idr and MUK Idi only, shall be
encoded as described in clause 4.2.81.
Parameter MBMS Security Context Mode specifies the MBMS mode in which MBMS
security procedure is performed as follows:
Coding of MBMS Security Context Mode
* * *
Coding Meaning \'01\' MSK Update Mode \'02\' MTK Generation Mode \'03\' MSK
Deletion Mode \'04\' MUK Deletion Mode
* * *
Response parameters/data, MBMS security context (MSK Update Mode), command
successful:
* * *
**Byte(s)** **Description** **Coding** **Length** 1 MBMS operation response
Data Object tag (\'53\') As defined in TS 31.101 [11] for BER-TLV data object
1 2 to 1+A bytes (A ≤ 4) MBMS operation response Data Object length (L) As
defined in TS 31.101 [11] for BER-TLV data object A A+2 \"Successful MBMS
operation\" tag = \'DB\' (see note 1) 1 A+3 to (A+L+1) MIKEY message (see note
1) L-1 NOTE 1: Parameter present if a MIKEY verification message is returned.
Otherwise, the USIM returns \"53 01 DB\"
* * *
Response parameters/data, MBMS security context (MTK Generation Mode), command
successful:
* * *
**Byte(s)** **Description** **Coding** **Length** 1 MBMS operation response
Data Object tag (\'53\') As defined in TS 31.101 [11] for BER-TLV data object
1 2 to 1+A bytes (A ≤ 4) MBMS operation response Data Object length (L) As
defined in TS 31.101 [11] for BER-TLV data object A A+2 \"Successful MBMS
operation\" tag = \'DB\' 1 A+3 to (A+L+1) MTK \|\| Salt (if Salt key is
available) L-1
* * *
Response parameters/data, MBMS security context (MSK and MUK Deletion Mode),
command successful:
* * *
**Byte(s)** **Description** **Coding** **Length** 1 MBMS operation response
Data Object tag (\'53\') As defined in TS 31.101 [11] for BER-TLV data object
1 2 MBMS operation response Data Object length As defined in TS 31.101 [11]
for BER-TLV data object 1 3 \"Successful MBMS operation\" tag = \'DB\' 1
* * *
The coding of parameters is described in TS 33.246 [43].
> Note: The constructed TLV tag value \'AE\' is used by OMA BCAST Smart Card
> Profile [49] for the encapsulation of command and response parameters/data.
#### 7.1.2.6 Local Key Establishment security context (All Modes)
The Local Key Establishment Control TLV is included in the command data to
indicate the security context mode. The Local Key Establishment Control TLV is
also included in the response data to indicate the operation status.
Table 3: Coding of the Local Key Establishment Control TLV
+-----------+---------------------------+---------------------------+ | Tag Value | Length | Value / Meaning | +-----------+---------------------------+---------------------------+ | \'80\' | Coded according to | Local Key Establishment | | | ISO/IEC 8825-1 [35] | context: | | | | | | | | \'01\': Key Derivation | | | | mode | | | | | | | | \'02\': Key Availability | | | | Check mode | | | | | | | | Operation Status: | | | | | | | | \'DB\': Successful | | | | Operation | +-----------+---------------------------+---------------------------+
##### 7.1.2.6.1 Local Key Establishment security context (Key Derivation mode)
Command parameters/data:
* * *
Byte(s) Description Coding Length 1 Key Derivation Data Object tag (\'73\') As
defined in TS 31.101 [11] for BER-TLV data object 1 2 to A+1 bytes (A ≤ 4) Key
Derivation Data Object length (L) As defined in TS 31.101 [11] for BER-TLV
data object A A+2 to (A+L+1) Key Derivation Data Object L
* * *
\- Key Derivation Data Object content: The TLVs defined in table 4 are
included in the Key Derivation Data Object.
Table 4: Coding of the Key Derivation Data Object
+-------------------+-------------------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------+-------------------+-----+----------------+ | Local Key | Coded as defined | M | B | | Establishment | in | | | | Control TLV | clause 7.1.2.6. | | | | | The value field | | | | | shall be set to | | | | | \'01\' | | | +-------------------+-------------------+-----+----------------+ | Counter Limit tag | \'81\' | M | 1 | +-------------------+-------------------+-----+----------------+ | Length | C | M | Note 1 | +-------------------+-------------------+-----+----------------+ | Counter Limit | Coded as defined | M | C | | | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | Request MAC tag | \'82\' | M | 1 | +-------------------+-------------------+-----+----------------+ | Length | D | M | Note 1 | +-------------------+-------------------+-----+----------------+ | Request MAC | Coded as defined | M | D (see Note 3) | | | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | Key Identifier | \'A0\' | M | 1 | | tag | | | | +-------------------+-------------------+-----+----------------+ | Length | E (see Note 2) | M | Note 1 | +-------------------+-------------------+-----+----------------+ | NAF_ID tag | \'83\' | M | 1 | +-------------------+-------------------+-----+----------------+ | Length | F | M | Note 1 | +-------------------+-------------------+-----+----------------+ | NAF_ID | Coded as defined | M | F | | | in | | | | | TS 33.220 [42] | | | +-------------------+-------------------+-----+----------------+ | Terminal_ID tag | \'84\' | M | 1 | +-------------------+-------------------+-----+----------------+ | Length | G | M | Note 1 | +-------------------+-------------------+-----+----------------+ | Terminal_ID | Coded as defined | M | G | | | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | Te | \'85\' | M | 1 | | rminal_appli_ID | | | | | tag | | | | +-------------------+-------------------+-----+----------------+ | Length | H | M | Note 1 | +-------------------+-------------------+-----+----------------+ | Te | Coded as defined | M | H | | rminal_appli_ID | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | UICC_appli_ID | \'86\' | M | 1 | | tag | | | | +-------------------+-------------------+-----+----------------+ | Length | I | M | Note 1 | +-------------------+-------------------+-----+----------------+ | UICC_appli_ID | Coded as defined | M | I | | | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | RANDx tag | \'87\' | M | 1 | +-------------------+-------------------+-----+----------------+ | Length | J | M | Note 1 | +-------------------+-------------------+-----+----------------+ | RANDx | Coded as defined | M | J (see Note 4) | | | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | Note 1: The | | | | | length is coded | | | | | according to | | | | | ISO/I | | | | | EC 8825-1 [35]. | | | | | | | | | | Note 2: The Key | | | | | Identifier TLV is | | | | | a constructed TLV | | | | | containing the | | | | | following | | | | | primitive TLVs: | | | | | NAF_ID, | | | | | Terminal_ID, | | | | | Ter | | | | | minal_appli_ID, | | | | | UICC_appli_ID | | | | | and RANDx. E is | | | | | the length of the | | | | | constructed Key | | | | | Identifier value. | | | | | | | | | | Note 3: The most | | | | | significant bit | | | | | of the request | | | | | MAC is coded on | | | | | bit 8 of the | | | | | first byte | | | | | following the MAC | | | | | Length. | | | | | | | | | | Note 4: The most | | | | | significant bit | | | | | of the RANDx is | | | | | coded on bit 8 of | | | | | the first byte | | | | | following the | | | | | RANDx Length. | | | | +-------------------+-------------------+-----+----------------+
Response parameters/data, Local Key Establishment security context (Key
Derivation mode), command successful:
* * *
Byte(s) Description Coding Length 1 Key Derivation Operation Response Data
Object tag (\'73\') As defined in TS 31.101 [11] for BER-TLV data object 1 2
to A1+1 bytes (A1 ≤ 4) Key Derivation Operation Response Data Object length
(L1) As defined in TS 31.101 [11] for BER-TLV data object A1 A1+2 to (A1+L1+1)
Key Derivation Operation Response Data Object L1
* * *
Key Derivation Operation Response Data Object content: The TLVs defined in
table 5 are included in the Key Derivation Operation Response Data Object.
Table 5: Coding of the Key Derivation Operation Response Data Object
+-------------------+-------------------+-----+----------------+ | Description | Value | M/O | Length (bytes) | +-------------------+-------------------+-----+----------------+ | Local Key | Coded as defined | M | B | | Establishment | in | | | | Control TLV | clause 7.1.2.6. | | | | | The value field | | | | | shall be set to | | | | | \'DB\' | | | +-------------------+-------------------+-----+----------------+ | Response MAC tag | \'82\' | M | 1 | +-------------------+-------------------+-----+----------------+ | Length | C | M | Note 1 | +-------------------+-------------------+-----+----------------+ | Response MAC | Coded as defined | M | C (see Note 2) | | | in | | | | | TS 33.110 [47] | | | +-------------------+-------------------+-----+----------------+ | Note 1: The | | | | | length is coded | | | | | according to | | | | | ISO/I | | | | | EC 8825-1 [35]. | | | | | | | | | | Note 2: The most | | | | | significant bit | | | | | of the response | | | | | MAC is coded on | | | | | bit 8 of the | | | | | first byte | | | | | following the MAC | | | | | length. | | | | +-------------------+-------------------+-----+----------------+
##### 7.1.2.6.2 Local Key Establishment security context (Key Availability
Check mode)
Command parameters/data:
* * *
Byte(s) Description Coding Length 1 Key Availability Check Data Object tag
(\'73\') As defined in TS 31.101 [11] for BER-TLV data object 1 2 to 1+A bytes
(A ≤ 4) Key Availability Check Data Object length (L) As defined in TS 31.101
[11] for BER-TLV data object A A+2 to (A+L+1) Key Availability Check Data
Object L
* * *
\- Key Availability Check Data Object content: The TLVs defined in table 6 are
included in the Key Availability Check Data Object.
Table 6: Coding of the Key Availability Check Data Object
* * *
Description Value M/O Length (bytes) Local Key Establishment Control TLV Coded
as defined in clause 7.1.2.6. The value field shall be set to \'02\' M B Key
Identifier TLV Coded as defined in clause 7.1.2.6.1 M C
* * *
Response parameters/data, Local Key Establishment security context (Key
Availability Check mode), command successful:
* * *
Byte(s) Description Coding Length 1 Key Availability Check Operation Response
Data Object tag (\'73\') As defined in TS 31.101 [11] for BER-TLV data object
1 2 to 1+A1 bytes (A1 ≤ 4) Key Availability Check Operation Response Data
Object length (L1) As defined in TS 31.101 [11] for BER-TLV data object A1
A1+2 to (A1+L1+1) Key Availability Check Operation Response Data Object L1
* * *
\- Key Availability Check Operation Response Data Object content: The TLV
defined in table 7 is included in the Key Availability Check Operation
Response Data Object.
Table 7: Coding of the Key Availability Check Operation Response Data Object
* * *
Description Value M/O Length (bytes) Local Key Establishment Control TLV Coded
as defined in clause 7.1.2.6. The value field shall be set to \'DB\' M B
* * *
## 7.2 Void
## 7.3 Status Conditions Returned by the USIM
Status of the card after processing of the command is coded in the status
bytes SW1 and SW2. This clause specifies the coding of the status bytes in the
following tables, in addition to the ones defined in TS 31.101 [11].
### 7.3.1 Security management
* * *
**SW1** **SW2** **Error description** \'98\' \'62\' ‑ Authentication error,
incorrect MAC \'98\' \'64\' ‑ Authentication error, security context not
supported \'98\' \'65\' ‑ Key freshness failure \'98\' \'66\' - Authentication
error, no memory space available \'98\' \'67\' - Authentication error, no
memory space available in EF~MUK~
* * *
### 7.3.2 Status Words of the Commands
The following table shows for each command the possible status conditions
returned (marked by an asterisk *).
Commands and status words
+----------------------------+----------------+----------------+ | > **Status Words** | > AUTHENTICATE | > GET IDENTIYY | +----------------------------+----------------+----------------+ | 90 00 | * | * | +----------------------------+----------------+----------------+ | 91 XX | * | * | +----------------------------+----------------+----------------+ | 93 00 | | | +----------------------------+----------------+----------------+ | 98 50 | | | +----------------------------+----------------+----------------+ | 98 62 | * | | +----------------------------+----------------+----------------+ | 98 64 | * | | +----------------------------+----------------+----------------+ | 98 65 | * | | +----------------------------+----------------+----------------+ | 98 66 | * | | +----------------------------+----------------+----------------+ | 98 67 | * | | +----------------------------+----------------+----------------+ | 62 00 | * | * | +----------------------------+----------------+----------------+ | 62 81 | | | +----------------------------+----------------+----------------+ | 62 82 | | | +----------------------------+----------------+----------------+ | 62 83 | | | +----------------------------+----------------+----------------+ | 62 F1 | * | | +----------------------------+----------------+----------------+ | 62 F3 | * | | +----------------------------+----------------+----------------+ | 63 CX | | | +----------------------------+----------------+----------------+ | 63 F1 | * | | +----------------------------+----------------+----------------+ | 64 00 | * | * | +----------------------------+----------------+----------------+ | 65 00 | * | * | +----------------------------+----------------+----------------+ | 65 81 | * | * | +----------------------------+----------------+----------------+ | 67 00 | * | * | +----------------------------+----------------+----------------+ | 67 XX -- (see note) | * | * | +----------------------------+----------------+----------------+ | 68 00 | * | * | +----------------------------+----------------+----------------+ | 68 81 | * | * | +----------------------------+----------------+----------------+ | 68 82 | * | * | +----------------------------+----------------+----------------+ | 69 81 | | | +----------------------------+----------------+----------------+ | 69 82 | * | * | +----------------------------+----------------+----------------+ | 69 83 | | | +----------------------------+----------------+----------------+ | 69 84 | * | | +----------------------------+----------------+----------------+ | 69 85 | * | * | +----------------------------+----------------+----------------+ | 69 86 | | | +----------------------------+----------------+----------------+ | 6A 80 | | | +----------------------------+----------------+----------------+ | 6A 81 | * | * | +----------------------------+----------------+----------------+ | 6A 82 | | | +----------------------------+----------------+----------------+ | 6A 83 | | | +----------------------------+----------------+----------------+ | 6A 86 | * | * | +----------------------------+----------------+----------------+ | 6A 87 | | | +----------------------------+----------------+----------------+ | 6A 88 | * | * | +----------------------------+----------------+----------------+ | 6B 00 | * | * | +----------------------------+----------------+----------------+ | 6E 00 | * | * | +----------------------------+----------------+----------------+ | 6F 00 | * | * | +----------------------------+----------------+----------------+ | 6F XX -- (see note) | * | * | +----------------------------+----------------+----------------+ | NOTE: Except SW2 = \'00\'. | | | +----------------------------+----------------+----------------+
## 7.4 Optional commands
The following command is optional for the USIM application:
\- GET CHALLENGE command as defined in TS 31.101 [11].
\- GET IDENTITY command as defined in clause 7.5
Note: OMA BCAST Smart Card Profile [49] defines a command using instruction
code INS \'1B\'
## 7.5 GET IDENTITY
### 7.5.1 Command description
The function can be used in the following contexts:
\- a SUCI context, to retrieve the SUCI when \"SUCI calculation is to be
performed by the USIM\".
\- a SUCI NSWO context, to retrieve the SUCI when \"SUCI calculation is to be
performed by the USIM\" and \"5G NSWO support\" is activated (i.e. Service
nº142 is \"available\").
The function is related to a particular USIM and shall not be executable
unless the USIM application has been selected and activated, and the current
directory is the USIM ADF or any subdirectory under this ADF and a successful
PIN verification procedure has been performed (see clause 5).
If GET IDENTITY command is not supported by the UICC, then the status word
\'6D00\' (Instruction code not supported or invalid) shall be returned.
#### 7.5.1.1 SUCI context
SUCI context shall be supported if \"SUCI calculation is to be performed by
the USIM\" (i.e. Service n°124 and Service n°125 are \"available\").
The command returns the SUCI which is a privacy preserving identifier
containing the concealed SUPI. The function is used in 5GS in the specific
cases described in 3GPP TS 33.501 [105] prior to mutual authentication between
the UE and the SN.
The SUCI returned is calculated as described in 3GPP TS 33.501 [105].
For the execution of the command, the following information shall be available
in the USIM:
\- Home network identifier (i.e. MCC and MNC when SUPI Type is IMSI or domain
name when SUPI Type is Network Specific Identifier, Global Line Identifier or
Global Cable Identifier) (see NOTE).
\- Routing indicator (configured in EF~Routing_Indicator~).
\- Home network public key (see Note).
\- Home network public key identifier (see Note).
\- Protection scheme identifier (see Note).
\- SUPI.
NOTE: Provision and storage of the information in the USIM when \"SUCI
calculation is to be performed by the USIM\" (i.e. Service n°124 and Service
n°125 are \"available\") is out of the scope of the specification.
The SUCI is designed for one-time use, however, the freshness and randomness
of SUCI returned upon each call of the command depends on the protection
scheme configured. There is the special case where the protection scheme used
is null-scheme, in such case SUCI contains the non concealed SUPI.
If the home network public key is not provisioned in the USIM, the SUCI shall
be calculated using the null-scheme irrespective of the protection scheme
stored in the USIM.
The returned SUCI consists of the concatenation of the following information
as described in 3GPP TS 23.003 [25]:
\- SUPI Type
> \- Home network identifier (i.e. MCC and MNC when SUPI Type is IMSI or
> domain name when SUPI Type is Network Specific Identifier, Global Line
> Identifier or Global Cable Identifier).
\- Routing indicator.
\- Protection scheme identifier.
\- Home network public key identifier.
\- Scheme output, resulting from the protection scheme profile, identified by
the protection scheme identifier. The protection scheme profile shall be one
of those defined in Annex C of 3GPP TS 33.501 [105] or one of those specified
by the Home network.
\- - Network Identifier for SNPN (NID) in case of SUCI in NAI format (see 3GPP
TS 23.003 [25] for details) and if Service n°146 is \"available\".
If SUCI context is supported and:
\- Service n°124 is not \"available\" or:
\- \"SUCI calculation is to be performed by the ME\" (i.e. Service n°124 is
\"available\", and Service n°125 is not \"available\")
the status word \'6985\' (Conditions of use not satisfied) shall be returned
Editor\'s Note: It is FFS to specify the behavior in case other parameters
(e.g. Home network public key identifier, some necessary data is not
provisioned) are not correctly configured
#### 7.5.1.2 SUCI 5G NSWO context
SUCI 5G NSWO context shall be supported if \"SUCI calculation is to be
performed by the USIM\" (i.e. Service n°124 and Service n°125 are
\"available\") and \"5G NSWO support\" is activated (i.e. Service nº142 is
\"available\").
The command returns the SUCI which is a privacy preserving identifier
containing the concealed SUPI. The function is used in 5GS in the specific
cases of NSWO authentication described in 3GPP TS 33.501 [105] Annex S.
For the execution of the command, the following information shall be available
in the USIM:
\- Home network identifier (i.e. MCC and MNC when SUPI Type is IMSI) (see NOTE
1).
\- Routing indicator (configured in EF~Routing_Indicator~).
\- Home network public key (see NOTE 1).
\- Home network public key identifier (see NOTE 1).
\- Protection scheme identifier (see NOTE 1).
\- SUPI (NOTE 2).
\- Network Identifier for SNPN (NID) (NOTE 3)
NOTE 1: Provision and storage of the information in the USIM when \"SUCI
calculation is to be performed by the USIM\" (i.e. Service n°124 and Service
n°125 are \"available\") is out of the scope of the specification.
NOTE 2: As per TS 33.501 [105] Annex C.3.1, when the SUPI is of type IMSI, the
subscription identifier part of the IMSI (i.e., MSIN) that is used to
construct the scheme-input shall be coded as hexadecimal digits using packed
BCD coding.
NOTE 3: Network Identifier for SNPN is used in case NSWO is used via an SNPN
(see 3GPP TS 23.003 [25] for details) and if Service n°146 is
\"available\".The SUCI is designed for one-time use, however, the freshness
and randomness of SUCI returned upon each call of the command depends on the
protection scheme configured. There is the special case where the protection
scheme used is null-scheme, in such case, SUCI contains the non concealed
SUPI.
If the home network public key is not provisioned in the USIM, the SUCI shall
be calculated using the null scheme irrespective of the protection scheme
stored in the USIM.
The returned SUCI shall be in the NAI format as in TS 23.003 [25] and is
computed as described in 3GPP TS 33.501 [105] Annex S.3.
If SUCI 5G NSWO context is supported and:
\- Service n°124 is not \"available\" or
\- \"SUCI calculation is to be performed by the ME\" (i.e. Service n°124 is
\"available\", and Service n°125 is not \"available\") or
\- \"5G NSWO support\" is not activated (i.e. Service nº142 is not
\"available\")
the status word \'6985\' (Conditions of use not satisfied) shall be returned.
Editor\'s Note: It is FFS to specify the behavior in case other parameters
(e.g. Home network public key identifier, some necessary data is not
provisioned) are not correctly configured
### 7.5.2 Command parameters and data
* * *
Code Value CLA As specified in TS 31.101 [11] INS \'78\' P1 \'00\' P2 Identity
context, see Table 7.5.2-1 below Lc Length of the subsequent data field or not
present, see below Data See below Le \'00\', or maximum length of data
expected in response
* * *
Parameter P2 specifies the identity context as follows:
Table 7.5.2-1: Coding of the reference control P2
* * *
b8 b7 b6 b5 b4 b3 b2 b1 Meaning \- X X X X X X X Identity Context (See below)
\- 0 0 0 0 0 0 1 SUCI \- 0 0 0 0 0 1 0 SUCI 5G NSWO
* * *
All other codings are RFU.
#### 7.5.2.1 SUCI context
Command parameters/data: None
Response parameters/data:
* * *
**Byte(s)** **Description** **Length** 1 to Le SUCI TLV data object Le
* * *
Subscription Concealed Identifier TLV data object:
* * *
Description Value M/O/C Length (bytes) SUCI TLV data object tag \'A1\' M 1
Length X M Note SUCI value -- M X NOTE: The length is coded according to
ISO/IEC 8825-1 [35]
* * *
\- SUCI
> It contains the SUCI as defined in 3GPP TS 33.501 [105].
>
> When SUPI Type is IMSI, the SUCI is coded as part of 5GS mobile identity
> information element for type of identity \"SUCI\" and SUPI format \"IMSI\"
> defined in 3GPP TS 24.501 [104]. The correspondence between the SUCI value
> and the octets of the above referenced 5GS mobile identity information
> element is provided below:
>
> Byte 1 corresponds to \"octet 4\" and the value is \'01\':
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                1
                                                0
                                                0
                                                0
                                                0
                                                0
                                                0
                                                0
* * *
> From byte 2 to 4, the Home Network Identifier (i.e. MCC and MNC) is coded
> and corresponds from \"octet 5\" to \"octet 7\".
>
> Byte 5 and 6 code the Routing Indicator which correspond to \"octet 8\" and
> \"octet 9\".
>
> Byte 7 codes the Protection Scheme Identifier which corresponds to \"octet
> 10\".
>
> Byte 8 codes the Home Network Public Key Identifier which corresponds to
> \"octet 11\".
>
> Byte 9 corresponds to \"octet 12\". From Byte 9 onwards, the Scheme Output
> is coded and the length depends on the Protection Scheme used.
>
> When SUPI Type is Network Specific Identifier (i.e. service n°130 is
> \"available\" and EF~SUPI_NAI~ contains a Network Specific Identifier), the
> SUCI is coded as part of 5GS mobile identity information element for type of
> identity \"SUCI\" and SUPI format \"Network specific identifier\" defined in
> 3GPP TS 24.501 [104]. The correspondence between the SUCI value and the
> octets of the above referenced 5GS mobile identity information element is
> provided below:
>
> Byte 1 corresponds to \"octet 4\" and the value is \'11\':
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             1
                                             0
                                             0
                                             0
                                             1
                                             0
                                             0
                                             0
* * *
> Byte 2 corresponds to \"octet 5\". From byte 2 onwards, the SUCI NAI is
> coded as defined in 3GPP TS 24.501 [104].
>
> When SUPI Type is Global Line Identifier (i.e. service n°130 is
> \"available\" and EF~SUPI_NAI~ contains a Global Line Identifier), the SUCI
> is coded as part of 5GS mobile identity information element for type of
> identity \"SUCI\" and SUPI format \"Global Line Identifier\" (GLI) defined
> in 3GPP TS 24.501 [104]. The correspondence between the SUCI value and the
> octets of the above referenced 5GS mobile identity information element is
> provided below:
>
> Byte 1 corresponds to \"octet 4\" and the value is \'31\':
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             1
                                             0
                                             0
                                             0
                                             1
                                             1
                                             0
                                             0
* * *
> Byte 2 corresponds to \"octet 5\". From byte 2 onwards, the SUCI NAI is
> coded as defined in 3GPP TS 24.501 [104].
>
> When SUPI Type is Global Cable Identifier (i.e. service n°130 is
> \"available\" and EF~SUPI_NAI~ contains a Global Cable Identifier), the SUCI
> is coded as part of 5GS mobile identity information element for type of
> identity \"SUCI\" and SUPI format \"Global Cable Identifier\" (GCI) defined
> in 3GPP TS 24.501 [104]. The correspondence between the SUCI value and the
> octets of the above referenced 5GS mobile identity information element is
> provided below:
>
> Byte 1 corresponds to \"octet 4\" and the value is \'21\':
* * *
     b8   b7   b6   b5   b4   b3   b2   b1   
                                             1
                                             0
                                             0
                                             0
                                             0
                                             1
                                             0
                                             0
* * *
> Byte 2 corresponds to \"octet 5\". From byte 2 onwards, the SUCI NAI is
> coded as defined in 3GPP TS 24.501 [104].
#### 7.5.2.2 SUCI 5G NSWO context
Command parameters/data: None
Response parameters/data:
* * *
**Byte(s)** **Description** **Length** 1 to Le SUCI TLV data object Le
* * *
Subscription Concealed Identifier TLV data object:
* * *
Description Value M/O/C Length (bytes) SUCI TLV data object tag \'A1\' M 1
Length X M Note SUCI value -- M X NOTE: The length is coded according to
ISO/IEC 8825-1 [35]
* * *
\- SUCI
> It contains the SUCI in NAI format as defined in TS 33.501 [105] Annex S.
>
> When SUPI Type is IMSI, the SUCI in NAI format is coded as part of 5GS
> mobile identity information element as defined in 3GPP TS 24.501 [104]
> Figure 9.11.3.4.4. The correspondence between the SUCI value and the octets
> of the above referenced 5GS mobile identity information element is provided
> below:
>
> Byte 1 corresponds to \"octet 4\" and the value is \'01\':
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                1
                                                0
                                                0
                                                0
                                                0
                                                0
                                                0
                                                0
* * *
> Byte 2 corresponds to \"octet 5\". From byte 2 onwards, the SUCI NAI field
> contains an NAI constructed as specified in clause 28.7.3 of 3GPP TS 23.003
> [25].
# 8 Void
###### ## Annex A (informative): EF changes via Data Download or USAT
applications
This annex defines if changing the content of an EF by the network (e.g. by
sending an SMS), or by a USAT Application, is advisable. Updating of certain
EFs \"over the air\" such as EF~ACC~ could result in unpredictable behaviour
of the UE; these are marked \"Caution\" in the table below. Certain EFs are
marked \"No\"; under no circumstances should \"over the air\" changes of these
EFs be considered.
+------------------------+------------------------+------------------+ | File identification | Description | Change advised | +------------------------+------------------------+------------------+ | \'2F00\' | Application directory | Caution | +------------------------+------------------------+------------------+ | \'2F05\' | Preferred languages | Yes | +------------------------+------------------------+------------------+ | \'2F06\' | Access rule reference | Caution | +------------------------+------------------------+------------------+ | \'2F08\' | UICC Maximum Power | No | | | Consumption | | +------------------------+------------------------+------------------+ | \'2FE2\' | ICC identification | No | +------------------------+------------------------+------------------+ | \'4F01\' | ProSe Monitoring | Yes | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F01\' | ACDC List | Yes | +------------------------+------------------------+------------------+ | \'4F01\' | MCS Service Table | Yes | +------------------------+------------------------+------------------+ | \'4F01\' | V2X Service Table | Yes | +------------------------+------------------------+------------------+ | \'4F01\' | 5GS 3GPP location | Caution (Note 1) | | | information | | +------------------------+------------------------+------------------+ | \'4F01\' | 5G ProSe Service Table | Yes | +------------------------+------------------------+------------------+ | '4F01' | PWS configuration in | Yes | | | SNPN. | | +------------------------+------------------------+------------------+ | \'4F02\' | V2X configuration data | Yes | +------------------------+------------------------+------------------+ | \'4F02\' | ProSe Announcing | Yes | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F02\' | MCS configuration data | Yes | +------------------------+------------------------+------------------+ | \'4F02\' | 5GS non-3GPP location | Caution (Note 1) | | | information | | +------------------------+------------------------+------------------+ | \'4F02\' | 5G ProSe configuration | Yes | | | data for direct | | | | discovery | | +------------------------+------------------------+------------------+ | \'4F02\' | Network Identifier for | Caution | | | SNPN | | +------------------------+------------------------+------------------+ | \'4F03\' | HPLMN ProSe Function | Yes | +------------------------+------------------------+------------------+ | \'4F03\' | 5GS 3GPP Access NAS | Caution | | | Security Context | | +------------------------+------------------------+------------------+ | \'4F03\' | V2X data policy over | Yes | | | PC5 | | +------------------------+------------------------+------------------+ | \'4F03\' | 5G ProSe configuration | Yes | | | data for direct | | | | communication | | +------------------------+------------------------+------------------+ | \'4F04\' | ProSe Direct | Yes | | | Communication Radio | | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F04\' | 5GS non-3GPP Access | Caution | | | NAS Security Context | | +------------------------+------------------------+------------------+ | \'4F04\' | V2X data policy over | Yes | | | Uu | | +------------------------+------------------------+------------------+ | \'4F04\' | 5G ProSe configuration | Yes | | | data for UE-to-network | | | | relay UE | | +------------------------+------------------------+------------------+ | \'4F05\' | ProSe Direct Discovery | Yes | | | Monitoring Radio | | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F05\' | 5G authentication keys | No | +------------------------+------------------------+------------------+ | \'4F05\' | 5G ProSe configuration | Yes | | | data for remote UE | | +------------------------+------------------------+------------------+ | \'4F06\' | ProSe Direct Discovery | Yes | | | Announcing Radio | | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F06\' | UAC Access Identities | Caution | | | Configuration | | +------------------------+------------------------+------------------+ | \'4F06\' | 5G ProSe configuration | Yes | | | data for usage | | | | reporting information | | +------------------------+------------------------+------------------+ | \'4F07\' | ProSe Policy | Yes | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F07\' | Subscriber Concealed | Yes | | | Identifier Calculation | | | | Information | | +------------------------+------------------------+------------------+ | \'4F09\' | SUPI as Network Access | Caution | | | Identifier | | +------------------------+------------------------+------------------+ | \'4F09\' | ProSe Group Counter | No | +------------------------+------------------------+------------------+ | \'4F0A\' | Routing Indicator | Yes (Note 5) | +------------------------+------------------------+------------------+ | \'4F0B\' | UE Route Selection | Yes | | | Policies | | +------------------------+------------------------+------------------+ | \'4F0C\' | Trusted non-3GPP | Yes | | | Serving network name | | | | list | | +------------------------+------------------------+------------------+ | \'4F0D\' | Pre-configured CAG | Caution | | | information list | | +------------------------+------------------------+------------------+ | \'4F0E\' | Steering of roaming | Yes | | | connected mode control | | | | information | | +------------------------+------------------------+------------------+ | \'4F0F\' | Disaster roaming | Yes | | | information | | +------------------------+------------------------+------------------+ | \'4F10\' | ProSe Service Table | Caution | +------------------------+------------------------+------------------+ | '4F10\' | 5GS eDRX Parameters | Yes | +------------------------+------------------------+------------------+ | \'4F11\' | ProSe | Caution (Note 4) | | | UsageInformation | | | | ReportingConfiguration | | +------------------------+------------------------+------------------+ | \'4F11 | 5G Non-Seamless WLAN | Yes | | | Offload configuration | | +------------------------+------------------------+------------------+ | \'4F12\' | ProSe Group Member | Yes | | | Discovery Parameters | | +------------------------+------------------------+------------------+ | \'4F13\' | ProSe Relay Parameters | Yes | +------------------------+------------------------+------------------+ | \'4F14\' | ProSe Relay Discovery | Yes | | | Parameters | | +------------------------+------------------------+------------------+ | \'4F15\' | Multiplier coefficient | Yes | | | for Higher Priority | | | | PLMN search period via | | | | NG-RAN satellite | | | | access | | +------------------------+------------------------+------------------+ | \'4F16\' | K~AUSF~ derivation | Caution | | | configuration | | +------------------------+------------------------+------------------+ | \'4F20\' | Image data | Yes | +------------------------+------------------------+------------------+ | \'4F20\' | GSM Ciphering key Kc | No | +------------------------+------------------------+------------------+ | \'4FXX\' | Image Instance data | Yes | | | Files | | +------------------------+------------------------+------------------+ | \'4FXX\' | ACDC OS Configuration | Yes | +------------------------+------------------------+------------------+ | \'4F21\' | ICE graphics | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | Unique identifier | Yes | +------------------------+------------------------+------------------+ | \'4F22\' | Phone book | Yes | | | synchronisation | | | | counter | | +------------------------+------------------------+------------------+ | \'4F23\' | Change counter | Yes | +------------------------+------------------------+------------------+ | \'4F24\' | Previous unique | Yes | | | identifier | | +------------------------+------------------------+------------------+ | \'4F30\' | Phone book reference | Yes | | | file | | +------------------------+------------------------+------------------+ | \'4FXX\' | Capability | Yes | | | configuration | | | | parameters 1 | | +------------------------+------------------------+------------------+ | \'4F30\' | SoLSA Access Indicator | Caution | +------------------------+------------------------+------------------+ | \'4F31\' | SoLSA LSA List | Caution | +------------------------+------------------------+------------------+ | \'4FXX\' | LSA Descriptor files | Caution | +------------------------+------------------------+------------------+ | \'4F52\' | GPRS Ciphring key | No | | | KcGPRS | | +------------------------+------------------------+------------------+ | \'4F63\' | CPBCCH Information | No | +------------------------+------------------------+------------------+ | \'4F64\' | Investigation Scan | Caution | +------------------------+------------------------+------------------+ | \'4FXX\' | Additional number | Yes | | | alpha string | | +------------------------+------------------------+------------------+ | \'4FXX\' | Additional number | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | Second name entry | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | Grouping information | Yes | | | alpha string | | +------------------------+------------------------+------------------+ | \'4FXX\' | Phone book control | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | E-mail addresses | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | Index administration | Yes | | | phone book | | +------------------------+------------------------+------------------+ | \'4FXX\' | Extension 1 | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | Abbreviated dialling | Yes | | | numbers | | +------------------------+------------------------+------------------+ | \'4FXX\' | Grouping file | Yes | +------------------------+------------------------+------------------+ | \'4FXX\' | TV User Service | Yes | | | Description | | +------------------------+------------------------+------------------+ | \'4F41\' | Pseudonym | Caution | +------------------------+------------------------+------------------+ | \'4F42\' | User controlled PLMN | No | | | selector for I-WLAN | | +------------------------+------------------------+------------------+ | \'4F43\' | Operator controlled | Caution | | | PLMN selector for | | | | I-WLAN | | +------------------------+------------------------+------------------+ | \'4F44\' | User controlled WSID | No | | | List | | +------------------------+------------------------+------------------+ | \'4F45\' | Operator controlled | Caution | | | WSID List | | +------------------------+------------------------+------------------+ | \'4F46\' | WLAN Reauthentication | No | | | Identity | | +------------------------+------------------------+------------------+ | 4F47\' | Home I-WLAN Specific | Yes | | | Identifier List | | +------------------------+------------------------+------------------+ | \'4F47\' | Multimedia Messages | Yes | | | List | | +------------------------+------------------------+------------------+ | \'4F48\' | I-WLAN Equivalent | Yes | | | HPLMN Presentation | | | | Indication | | +------------------------+------------------------+------------------+ | \'4F48\' | Multimedia Messages | Yes | | | Data File | | +------------------------+------------------------+------------------+ | \'4F49\' | I-WLAN HPLMN Priority | Yes | | | Indication | | +------------------------+------------------------+------------------+ | \'4F4A\' | I-WLAN Last Registered | Caution | | | PLMN | | +------------------------+------------------------+------------------+ | \'4F4B\' | HPLMN Direct Access | Yes | | | Indicator | | +------------------------+------------------------+------------------+ | \'4F81\' | Allowed CSG lists | Yes | +------------------------+------------------------+------------------+ | \'4F82\' | CSG Type | Yes | +------------------------+------------------------+------------------+ | \'4F83\' | HNB name | Yes | +------------------------+------------------------+------------------+ | \'4F84\' | Operator CSG lists | Yes | +------------------------+------------------------+------------------+ | \'4F85\' | Operator CSG Type | Yes | +------------------------+------------------------+------------------+ | \'4F86\' | Operator HNB name | Yes | +------------------------+------------------------+------------------+ | \'6F01\' | enhanced AKA support | Caution | +------------------------+------------------------+------------------+ | \'6F05\' | Language indication | Yes | +------------------------+------------------------+------------------+ | \'6F06\' | Access rule reference | Caution | | | (under ADF~USIM~ and | | | | DF~TELECOM~) | | +------------------------+------------------------+------------------+ | \'6F07\' | IMSI | Caution (Note 1) | +------------------------+------------------------+------------------+ | \'6F08\' | Ciphering and | No | | | integrity keys | | +------------------------+------------------------+------------------+ | \'6F09\' | Ciphering and | No | | | integrity keys for | | | | packet switched domain | | +------------------------+------------------------+------------------+ | \'6F2C\' | De-personalization | Caution | | | Control Keys | | +------------------------+------------------------+------------------+ | \'6F31\' | Higher Priority PLMN | Caution | | | search period | | +------------------------+------------------------+------------------+ | \'6F32\' | Co-operative network | Caution | | | list | | +------------------------+------------------------+------------------+ | \'6F37\' | ACM maximum value | Yes | +------------------------+------------------------+------------------+ | \'6F38\' | USIM service table | Caution | +------------------------+------------------------+------------------+ | \'6F39\' | Accumulated call meter | Yes | +------------------------+------------------------+------------------+ | \'6F3B\' | Fixed dialling numbers | Yes (Note 2) | +------------------------+------------------------+------------------+ | \'6F3C\' | Short messages | Yes | +------------------------+------------------------+------------------+ | \'6F3E\' | Group identifier level | Yes | | | 1 | | +------------------------+------------------------+------------------+ | \'6F3F\' | Group identifier level | Yes | | | 2 | | +------------------------+------------------------+------------------+ | \'6F40\' | MSISDN storage | Yes | +------------------------+------------------------+------------------+ | \'6F41\' | PUCT | Yes | +------------------------+------------------------+------------------+ | \'6F42\' | SMS parameters | Yes | +------------------------+------------------------+------------------+ | \'6F43\' | SMS status | Yes | +------------------------+------------------------+------------------+ | \'6F45\' | CBMI | Caution | +------------------------+------------------------+------------------+ | \'6F46\' | Service provider name | Yes | +------------------------+------------------------+------------------+ | \'6F47\' | Short message status | Yes | | | reports | | +------------------------+------------------------+------------------+ | \'6F48\' | CBMID | Yes | +------------------------+------------------------+------------------+ | \'6F49\' | Service Dialling | Yes (Note 2) | | | Numbers | | +------------------------+------------------------+------------------+ | \'6F4B\' | Extension 2 | Yes | +------------------------+------------------------+------------------+ | \'6F4C\' | Extension 3 | Yes | +------------------------+------------------------+------------------+ | \'6F4D\' | Barred dialling | Yes | | | numbers | | +------------------------+------------------------+------------------+ | \'6F4E\' | Extension 5 | Yes | +------------------------+------------------------+------------------+ | \'6F4F\' | Capability | Yes | | | configuration | | | | parameters 2 | | +------------------------+------------------------+------------------+ | \'6F50\' | CBMIR | Yes | +------------------------+------------------------+------------------+ | \'6F54\' | SetUp Menu Elements | Yes | +------------------------+------------------------+------------------+ | \'6F55\' | Extension 4 | Yes | +------------------------+------------------------+------------------+ | \'6F56\' | Enabled services table | Caution | +------------------------+------------------------+------------------+ | \'6F57\' | Access point name | Yes | | | control list | | +------------------------+------------------------+------------------+ | \'6F58\' | Comparison method | Yes | | | information | | +------------------------+------------------------+------------------+ | \'6F5B\' | Initialisation value | Caution | | | for Hyperframe number | | +------------------------+------------------------+------------------+ | \'6F5C\' | Maximum value of START | Yes | +------------------------+------------------------+------------------+ | \'6F60\' | User controlled PLMN | No | | | selector with Access | | | | Technology | | +------------------------+------------------------+------------------+ | \'6F61\' | Operator controlled | Caution | | | PLMN selector with | | | | Access Technology | | +------------------------+------------------------+------------------+ | \'6F62\' | HPLMN selector with | Caution | | | Access Technology | | +------------------------+------------------------+------------------+ | \'6F73\' | Packet switched | Caution (Note 1) | | | location information | | +------------------------+------------------------+------------------+ | \'6F78\' | Access control class | Caution | +------------------------+------------------------+------------------+ | \'6F7B\' | Forbidden PLMNs | Caution | +------------------------+------------------------+------------------+ | \'6F7E\' | Location information | No (Note 1) | +------------------------+------------------------+------------------+ | \'6F80\' | Incoming call | Yes | | | information | | +------------------------+------------------------+------------------+ | \'6F81\' | Outgoing call | Yes | | | information | | +------------------------+------------------------+------------------+ | \'6F82\' | Incoming call timer | Yes | +------------------------+------------------------+------------------+ | \'6F83\' | Outgoing call timer | Yes | +------------------------+------------------------+------------------+ | \'6FAD\' | Administrative data | Caution | +------------------------+------------------------+------------------+ | \'6FB1\' | Voice Group Call | Yes | | | Service | | +------------------------+------------------------+------------------+ | \'6FB2\' | Voice Group Call | Yes | | | Service Status | | +------------------------+------------------------+------------------+ | \'6FB3\' | Voice Broadcast | Yes | | | Service | | +------------------------+------------------------+------------------+ | \'6FB4\' | Voice Broadcast | Yes | | | Service Status | | +------------------------+------------------------+------------------+ | \'6FB5\' | Enhanced Multi Level | Yes | | | Pre-emption and | | | | Priority | | +------------------------+------------------------+------------------+ | \'6FB6\' | Automatic Answer for | Yes | | | eMLPP Service | | +------------------------+------------------------+------------------+ | \'6FB7\' | Emergency Call Codes | Caution | +------------------------+------------------------+------------------+ | \'6FC3\' | Key for hidden phone | No | | | book entries | | +------------------------+------------------------+------------------+ | \'6FC4\' | Network Parameters | No | +------------------------+------------------------+------------------+ | \'6FC5\' | PLMN Network Name | Yes | +------------------------+------------------------+------------------+ | \'6FC6\' | Operator Network List | Yes | +------------------------+------------------------+------------------+ | \'6FC7\' | Mailbox Dialling | Yes | | | Numbers | | +------------------------+------------------------+------------------+ | \'6FC8\' | Extension 6 | Yes | +------------------------+------------------------+------------------+ | \'6FC9\' | Mailbox Identifier | Caution | +------------------------+------------------------+------------------+ | \'6FCA\' | Message Waiting | Caution | | | Indication Status | | +------------------------+------------------------+------------------+ | \'6FCB\' | Call Forwarding | Caution | | | Indication Status | | +------------------------+------------------------+------------------+ | \'6FCC\' | Extension 7 | Yes | +------------------------+------------------------+------------------+ | \'6FCD\' | Service Provider | Yes | | | Display Information | | +------------------------+------------------------+------------------+ | \'6FCE\' | > MMS Notification | Yes | +------------------------+------------------------+------------------+ | \'6FCF\' | > Extension 8 | Yes | +------------------------+------------------------+------------------+ | \'6FD0\' | > MMS Issuer | Yes | | | > Connectivity | | | | > Parameters | | +------------------------+------------------------+------------------+ | \'6FD1\' | > MMS User Preferences | Yes | +------------------------+------------------------+------------------+ | \'6FD2\' | > MMS User | Yes | | | > Connectivity | | | | > Parameters | | +------------------------+------------------------+------------------+ | \'6FD3\' | Network\'s indication | Caution | | | of alerting (NIA) | | +------------------------+------------------------+------------------+ | \'6FD4\' | Voice Group Call | Yes | | | Service Ciphering | | | | Algorithm | | +------------------------+------------------------+------------------+ | \'6FD5\' | Voice Broadcast | Yes | | | Service Ciphering | | | | Algorithm | | +------------------------+------------------------+------------------+ | \'6FD6\' | GBA Bootstrapping | Caution | | | parameters | | +------------------------+------------------------+------------------+ | \'6FD7\' | MBMS Service Keys List | Caution | +------------------------+------------------------+------------------+ | \'6FD8\' | MBMS User Key | Caution | +------------------------+------------------------+------------------+ | \'6FD9\' | EHPLMN | Caution | +------------------------+------------------------+------------------+ | \'6FDA\' | GBA NAF List | Caution | +------------------------+------------------------+------------------+ | \'6FDB\' | EHPLMN Presentation | Caution | | | Indication | | +------------------------+------------------------+------------------+ | \'6FDC\' | Last RPLMN Selection | Caution | | | Indication | | +------------------------+------------------------+------------------+ | \'6FDD\' | NAF Key Centre Address | Caution | +------------------------+------------------------+------------------+ | \'6FDE\' | Service Provider Name | Yes | | | Icon | | +------------------------+------------------------+------------------+ | \'6FDF\' | PLMN Network Name Icon | Yes | +------------------------+------------------------+------------------+ | \'6FE0\' | In Case of Emergency | Yes | | | -- Dialling Number | | +------------------------+------------------------+------------------+ | \'6FE1\' | In Case of Emergency | Yes | | | -- Free Format | | +------------------------+------------------------+------------------+ | \'6FE2\' | Network Connectivity | Yes | | | Parameters for UICC IP | | | | connections | | +------------------------+------------------------+------------------+ | \'6FE3\' | EPS location | Caution (Note 1) | | | information | | +------------------------+------------------------+------------------+ | \'6FE4\' | EPS NAS Security | Caution | | | Context | | +------------------------+------------------------+------------------+ | \'6FE5\' | Public Service | Yes | | | Identity of the SM-SC | | +------------------------+------------------------+------------------+ | \'6FE6\' | USAT Facility Control | Caution | +------------------------+------------------------+------------------+ | \'6FE7\' | UICC IARI | Caution (Note 3) | +------------------------+------------------------+------------------+ | \'6FE8\' | Non Access Stratum | Yes | | | Configuration | | +------------------------+------------------------+------------------+ | \'6FE9\' | UICC certificate | Yes | +------------------------+------------------------+------------------+ | \'6FEA\' | Relay Node ID | Yes | +------------------------+------------------------+------------------+ | \'6FEB\' | Max value of Secure | Caution | | | Channel counter | | +------------------------+------------------------+------------------+ | \'6FEC\' | Public Warning System | Yes | +------------------------+------------------------+------------------+ | \'6FED\' | FDN URI | Yes (Note 2) | +------------------------+------------------------+------------------+ | \'6FEE\' | BDN URI | Yes | +------------------------+------------------------+------------------+ | \'6FEF\' | SDN URI | Yes (Note 2) | +------------------------+------------------------+------------------+ | \'6FF0\' | IMEI(SV) Allowed List | Yes | +------------------------+------------------------+------------------+ | \'6FF1\' | IMEI(SV) Pairing | Caution | | | Status | | +------------------------+------------------------+------------------+ | \'6FF2\' | IMEI(SV) Pairing | Caution | | | Devices | | +------------------------+------------------------+------------------+ | \'6FF3\' | Home ePDG Identifier | Yes | +------------------------+------------------------+------------------+ | \'6FF4\' | ePDG Selection | Yes | | | Information | | +------------------------+------------------------+------------------+ | \'6FF5\' | Emergency ePDG | Yes | | | Identifier | | +------------------------+------------------------+------------------+ | \'6FF6\' | ePDG Selection | Yes | | | Information for | | | | Emergency Services | | +------------------------+------------------------+------------------+ | \'6FF7\' | From Preferred | Yes | +------------------------+------------------------+------------------+ | \'6FF8\' | IMSConfigData | Caution | +------------------------+------------------------+------------------+ | \'6FF9\' | 3GPPPSDATAOFF | Caution | +------------------------+------------------------+------------------+ | \'6FFA\' | 3G | Caution | | | PPPSDATAOFFservicelist | | +------------------------+------------------------+------------------+ | \'6FFB\' | TV Configuration | Yes | +------------------------+------------------------+------------------+ | \'6FFC\' | XCAP Configuration | Yes | | | Data | | +------------------------+------------------------+------------------+ | \'6FFD\' | EARFCN List for | Yes | | | MTC/NB-IOT UEs | | +------------------------+------------------------+------------------+ | \'6FFE\' | MuD and MiD | Yes | | | configuration data | | +------------------------+------------------------+------------------+ | NOTE1: If EF~IMSI~ is | | | | changed, the UICC | | | | should issue REFRESH | | | | as defined in 3GPP TS | | | | 31.111 [12] and | | | | update EF~LOCI~, | | | | EF~PSLOCI,~ | | | | EF~EPSLOCI,~ | | | | EF~5GS3GPPLOCI~ and | | | | EF~5GSN3GPPLOCI~ | | | | accordingly. | | | | | | | | NOTE2: This file may | | | | contain eCALL related | | | | test and | | | | reconfiguration | | | | numbers or URIs. | | | | | | | | NOTE3: If EF~UICCIARI~ | | | | is changed, the UICC | | | | shall issue a REFRESH | | | | command as defined in | | | | TS 31.111. The ME | | | | shall read the updated | | | | list of IARIs | | | | associated with active | | | | applications installed | | | | on the UICC. | | | | | | | | NOTE4: Updating | | | | EF~ProSe_UIRC~ | | | | Over-The-Air, | | | | especially adding more | | | | parameters to the | | | | report, may cause a | | | | reduction of number of | | | | reports to be able to | | | | be stored in the UE. | | | | | | | | NOTE5: If | | | | EF~Routing_Indicator~ | | | | is changed, the UICC | | | | shall issue File | | | | Change Notification | | | | REFRESH, as defined in | | | | 3GPP TS 31.111 [12]. | | | +------------------------+------------------------+------------------+
Editor\'s Note: The REFRESH for SUPI_NAI update needs to be further specified.
###### ## Annex B (normative): Image Coding Schemes
The following image coding schemes are applicable to rectangular raster
images. Raster image points are assumed to be of square shape. They are
numbered sequentially from 1 onwards, starting at the upper left corner,
proceeding line by line downwards, each line in turn proceeding from left to
right, and ending at the image\'s lower right corner.
The following example illustrates the numbering scheme for raster image points
by showing how the corner points are numbered, assuming an image length of x
points and an image height of y points.
* * *
1 x
(x * (y-1) + 1) (x * y)
* * *
# B.1 Basic Image Coding Scheme
This coding scheme applies to rectangular raster images made up of raster
points that are either set or not set. This coding scheme does not support any
notion of colour. Image data are coded as follows:
* * *
Byte(s) Description Length 1 image width = X 1 2 image height = Y 1 3 to K+2
image body K
* * *
Coding of image body:
\- The status of each raster image point is coded in one bit, to indicate
whether the point is set (status = 1) or not set (status = 0).
Byte 1:
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                status of raster point 8
                                                status of raster point 7
                                                status of raster point 6
                                                status of raster point 5
                                                status of raster point 4
                                                status of raster point 3
                                                status of raster point 2
                                                status of raster point 1
* * *
Byte 2:
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                status of raster point 16
                                                status of raster point 15
                                                status of raster point 14
                                                status of raster point 13
                                                status of raster point 12
                                                status of raster point 11
                                                status of raster point 10
                                                status of raster point 9
* * *
etc.
Unused bits shall be set to 1.
# B.2 Colour Image Coding Scheme
This coding scheme applies to coloured rectangular raster images. Raster image
point colours are defined as references into a colour look-up table (CLUT),
which contains a subset of the red-green-blue colour space. The CLUT in turn
is located in the same transparent file as the image instance data themselves,
at an offset defined within the image instance data.
Image data are coded as follows:
* * *
Byte(s) Description Length 1 Image width = X 1 2 Image height = Y 1 3 Bits per
raster image point = B 1 4 Number of CLUT entries = C 1 5 to 6 Location of
CLUT (Colour Look-up Table) 2 7 to K+6 Image body K
* * *
Bits per raster image point:
Contents:\ \- the number B of bits used to encode references into the CLUT,
thus defining a raster image point\'s colour. B shall have a value between 1
and 8.
Coding:\ \- binary.
Number of entries in CLUT:
Contents:\ \- the number C of entries in the CLUT which may be referenced from
inside the image body. CLUT entries are numbered from 0 to C-1. C shall have a
value between 1 and 2**B.
Coding:\ \- binary. The value 0 shall be interpreted as 256.
Location of CLUT:
Contents:\ \- this item specifies where the CLUT for this image instance may
be found. The CLUT is always located in the same transparent file as the image
instance data themselves, at an offset determined by these two bytes.
Coding:\ \- Byte 1: high byte of offset into Image Instance File.\ \- Byte 2:
low byte of offset into Image Instance File.
Image body:
Coding:\ \- each raster image point uses B bits to reference one of the C CLUT
entries for this image instance. The CLUT entry being thus referenced yields
the raster image point\'s colour. The image body is arrayed as for the Basic
Colour Image Coding Scheme, that is, starting with the highest bit of the
first raster image point\'s colour information.
Byte 1:
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                \... etc
                                                \... etc
                                                \... etc
                                                \... etc
                                                \... etc
                                                Bit B-2 of raster point 1 CLUT reference
                                                Bit B-1 of raster point 1 CLUT reference
                                                Bit B (MSB) of raster point 1 CLUT reference
* * *
etc.
Unused bits shall be set to 1.
The CLUT (Colour Look-up Table) for an image instance with C colours is
defined as follows:
Contents:\ \- C CLUT entries defining one colour each.
Coding:\ \- the C CLUT entries are arranged sequentially:
* * *
Byte(s) of CLUT CLUT Entry 1-3 entry 0 ... ... 3*(C-1) +1 to 3*C Entry C-1
* * *
Each CLUT entry in turn comprises 3 bytes defining one colour in the red-
green-blue colour space:
* * *
Byte(s) of CLUT entry Intensity of Colour 1 Red 2 Green 3 Blue
* * *
A value of \'FF\' means maximum intensity, so the definition \'FF\' \'00\'
00\' stands for fully saturated red.
NOTE 1: Two or more image instances located in the same file can share a
single CLUT.
NOTE 2: Most MEs capable of displaying colour images are likely to support at
least a basic palette of red, green, blue and white.
# B.3 Colour Image Coding Scheme with Transparency
This coding scheme is identical to the Colour Image Coding Scheme as defined
in appendix B.2, with the following exception:
\- Entry number C-1in the colour look-up table (CLUT), where C is the number
of entries in the CLUT, defines transparency. Raster image points which point
to this entry are transparent, so that the underlying colour in the display is
shown.
The three colour-coding bytes of entry number C-1 in the CLUT are of no
importance when referenced from images using the \'22\' coding scheme.
NOTE: Two different descriptors in the EF~IMG~ file with Image Coding Scheme
\'21\' and \'22\' may point to the same actual image instance. In that case,
the descriptor with Image Coding Scheme \'21\' would describe an image where a
raster image point pointing to entry number C-1 in the CLUT would have the
colour described in that CLUT entry, while the descriptor with Image Coding
Scheme \'22\' would describe an image where a raster image point pointing to
entry number C-1 in the CLUT is transparent.
###### ## Annex C (informative): Structure of the Network parameters TLV
objects
Structure of the GSM network parameter TLV object, 0\ 0x01 (MMS implementation information = \"(WAP\")
**0x81** MMS User Preference Profile Name Tag
0x0E (Length = \"14\")
> 43 68 72 69 73 74 6D 61 73 20 43 61 72 64
>
> (profile name = \"Christmas Card\"; 14 characters, 14 Bytes)
**0x82** MMS User Information Preference Information Tag
0x19 (Length = \"25\")
> **0x14** 0x80 (visibility: = \"hide\"; 2 Bytes)
>
> **0x06** 0x80 (delivery report: = \"yes\"; 2 Bytes)
>
> **0x10** 0x80 (read-reply: = \"yes\"; 2 Bytes)
>
> **0x0F** 0x81 (priority: = \"normal\"; 2 Bytes)
>
> **0x07** 0x07 0x80 0x05 0x11 0x22 0x33 0x44 0x55\ (Delivery-Time-Tag, Value-
> Length, Absolute-Token-Tag, Date-Value-Length, Date-Value; 9 Bytes)
>
> **0x08** 0x06 0x81 0x04 0x55 0x22 0x33 0x44\ (Expiry Tag, Value-Length,
> Relative-Token-Tag, Delta-Second-Value-Length, Delta-Second-Value; 8 Bytes)
# J.2 Coding Example for MMS Issuer/User Connectivity Parameters
**0xAB** MMS Connectivity Parameters Tag
0x81 0x88 (Length = \"136\") (Length bytes greater than 127 are coded onto 2
bytes according to ISO/IEC 8825-1 [35])
**0x80** MMS Implementation Tag
0x01 (Length = \"1\")
> 0x01 (MMS implementation information = \"WAP\"; 1 Byte)
**0x81** MMS Relay/Server Tag
0x17 (Length = \"23\")
> 0x68 0x74 0x74 0x70 0x3A 0x2F 0x2F 0x6D 0x6D 0x73 0x2D 0x6F 0x70 0x65 0x72
> 0x61 0x74 0x6F 0x72 0x2E 0x63 0x6F 0x6D\ (MMS Relay/Server information =
> \"http://mms-operator.com\"; 23 characters; 23 Bytes)
**0x82** Interface to Core Network and Bearer Tag
0x32 (Length = \"50\")
> **0x10** 0xAA (bearer = \"GSM-CSD\"; 2 Bytes)
>
> **0x08** 0x2B 0x34 0x39 0x35 0x33 0x34 0x31 0x39 0x30 0x36 0x00\ (address =
> \"+495341906\", 12 Bytes)
>
> **0x09** 0x87 (type of address = \"E164\"; 2 Bytes)
>
> **0x25** 0xC5 (speed = \"autobauding\"; 2 Bytes)
>
> **0x0A** 0x90 (call type = \"ANALOG_MODEM\"; 2 Bytes)
>
> **0x0C** 0x9A (authentication type = \"PAP\"; 2 Bytes)
>
> **0x0D** 0x64 0x75 0x6D 0x6D 0x79 0x11 0x6E 0x61 0x6D 0x65 0x00\
> (authentication id = \"dummy_name\"; 12 Bytes)
>
> **0x0E** 0x64 0x75 0x6D 0x6D 0x79 0x11 0x70 0x61 0x73 0x73 0x77 0x6F 0x72
> 0x64 0x00\ (authentication pw = \"dummy_password\"; 16 Bytes)
**0x83** Gateway Tag
0x36 (Length = \"54\")
> **0x20** 0x31 0x37 0x30 0x2E 0x31 0x38 0x37 0x2E 0x35 0x31 0x2E 0x33 0x00\
> (address = \"170.187.51.3\"; 14 Bytes)
>
> **0x21** 0x85 (type of address = \"IPv4\"; 2 Bytes)
>
> **0x23** 0x39 0x32 0x30 0x33 0x00 (port = \"9203\"; 6 Bytes)
>
> **0x24** 0xCB (service = \"CO-WSP\"; 2 Bytes)
>
> **0x19** 0x9C (authentication type = \"HTTP BASIC\"; 2 Bytes)
>
> **0x1A** 0x64 0x75 0x6D 0x6D 0x79 0x11 0x6E 0x61 0x6D 0x65 0x00\
> (authentication id = \"dummy_name\"; 12 Bytes)
>
> **0x1B** 0x64 0x75 0x6D 0x6D 0x79 0x11 0x70 0x61 0x73 0x73 0x77 0x6F 0x72
> 0x64 0x00\ (authentication pw = \"dummy_password\"; 16 Bytes)
###### ## Annex K (informative): Examples of VService_Id coding
This annex gives examples for the coding of VService_Id,
It is assumed that:
\- acknowledgement flag bit is set to 0;
\- the call priority bits are set to 0.
**GroupId** **Content of EF~vbs~ or EF~vgcs~** **VService_Id(vbs)**
**VService_Id(vgcs)**
* * *
00000000 F0FFFFFF 00000000 00000010 00000001 F1FFFFFF 00000020 00000030
00000012 21FFFFFF 00000180 00000190 00000123 21F3FFFF 00000F60 00000F70
00001234 2143FFFF 00009A40 00009A50 00012345 2143F5FF 00060720 00060730
00123456 214365FF 003C4800 003C4810 01234567 214365F7 025AD0E0 025AD0F0
12345678 21436587 178C29C0 178C29D0 99999999 99999999 BEBC1FE0 BEBC1FF0
13452670 31546207 19A8AFC0 19A8AFD0
###### ## Annex L (normative): USIM-INI and USIM-RN for Relay Nodes
# L.1 Introduction
USIM-RN and USIM-INI are used for Relay Node network connections
establishment.
USIM-INI, if present on the UICC, and USIM-RN include at least all mandatory
files defined for a USIM in the present document, with the exception of files
related to emergency calls.
Editor\'s note: It is FFS whether the list of files mandatory to support can
be reduced further.
USIM-INI is only required in case of a certificate based solution as described
in TS 33.401 [52].
For the certificate-based solution, the UICC shall support BIP-UICC server
mode (see TS 31.111 [12]) and may support the Inter-Chip USB UICC/terminal
interface (see TS 31.101 [11]) to perform the TLS handshake.
The USIM-RN is used to ensure a one to one binding with the Relay Node. The
security architecture for Relay Nodes is defined in TS 33.401 [52].
# L.2 Application selection procedure
Application selection is performed according to the procedures defined in
clause 5.1.1.1. The following provisions apply:
When using pre-shared keys, only a USIM-RN is required, and the Relay Node
will establish directly a secure channel with USIM-RN. It is assumed that the
Relay Node knows the \"3G application code\" within the PIX value reserved for
3GPP USIM-RN.
When using certificate based procedure, the UICC inserted in the Relay Node
shall contains two USIMs, the USIM-RN and USIM-INI. In case initial
provisioning is required, the Relay Node will first select USIM-INI, either by
direct application selection or by use of the EF_DIR file.
> 1\. Direct application selection: with full or with partial AID. It is
> assumed that the Relay Node knows the \"3G application code\" within the PIX
> value reserved for 3GPP USIM-INI.
>
> 2\. By use of the EF_DIR file: The Relay Node identifies the USIM-INI, which
> is characterised by an AID with a \"3G application code\" within the PIX
> value reserved for 3GPP USIM-INI, see TS 31.101 [11], and selects the USIM-
> INI by AID. The AID of the USIM-RN is characterised by an AID with a \"3G
> application code\" within the PIX value reserved for 3GPP USIM-RN, see TS
> 31.101 [11]. If the only applications present in EF_DIR are a USIM-RN and a
> USIM-INI, the terminal omits user presentation and proceeds to application
> selection.
The USIM applications USIM-INI and USIM-RN are not simultaneously active.
USIM-INI is used to establish an initial network connection and USIM-INI is
deactivated once the network related operations are finished. USIM-INI is
deactivated prior to activating USIM-RN.
USIM-INI may be selected on any logical channel, see TS 31.101 [11]. Prior to
selecting USIM-RN a new logical channel shall be opened using the MANAGE
CHANNEL command as specified in TS 31.101 [11], an application to application
secure channel can only be established on a logical channel different from
channel 0. USIM-RN is then selected on the new logical channel.
USIM-RN shall be configured to support implicit and explicit application
selection. The Relay Node will first select USIM-INI, according to the
application selection mechanisms specified in TS 31.101 [11]. When the USIM-RN
is selected explicitly, the Relay Node shall send a SELECT by AID APDU command
in clear text prior to secure channel establishment. The implicit selection
mechanism is performed by specifying USIM-RN AID in the MANAGE SECURE CHANNEL
-- Establish Master SA command.
# L.3 Secure channel operation
The USIM-RN shall allow communication only via \"Secured APDU\" secure channel
as defined in ETSI TS 102 484 [66].
NOTE: The above implies in particular that the AUTHENTICATE command to the
USIM-RN is not executed outside the secure channel.In case the pre-shared key
solution is used to establish the secure channel only the USIM-RN is required
for establishing the connection, and the Relay Node will establish directly a
secure channel with the USIM-RN before attaching to the network. The initial
network connection using USIM-INI is not required in this case, and hence
USIM-INI is not required.
In case the certificate based solution is used, the UICC inserted in the Relay
Node shall contain two USIMs, USIM-RN and USIM-INI. A TLS handshake shall be
used to provide key material for the Master SA for the secured APDU protocol,
according to ETSI TS 102 484 [66].
# L.4 Support of commands
The Relay Node may limit the set of APDU commands encapsulated in TRANSACT
DATA command to the strict minimum (READ BINARY, READ RECORD, SELECT, STATUS,
UPDATE BINARY, UPDATE RECORD, AUTHENTICATE).
The Relay Node and the UICC shall support letter class \'e\' toolkit commands
for BIP, see TS 31.111 [12]. In order to support toolkit the TERMINAL PROFILE,
TERMINAL RESPONSE, ENVELOPE and FETCH commands need to be supported. These
commands are not issued on the secure channel. According to TS 31.111 [12],
USAT commands shall be sent on logical channel 0.
# L.5 Storage of certificates
If the UICC supports the certificate based procedure, the UICC shall be
provisioned with the UICC certificate and the root certificate. The UICC
certificate, which is used as a server certificate in the TLS handshake, is
stored in EF~CERT~ in USIM-INI as it needs to be accessed by the RN for
reading the CRL distribution point before establishing the secure channel, for
details cf. TS 33.401 [52]. The root certificate, which is used to verify the
RN certificate in the TLS handshake, is only needed for UICC-internal purposes
and need not be stored in an EF.
# L.6 Relay Node files support
## L.6.1 USIM-INI Files
### L.6.1.1 EF~CERT~ (UICC Certificate)
This file contains the UICC Certificate.
+-----------------------+-----------------------+----------+--------+ | Identifier: \'6FE9\' | Structure: | Optional | | | | transparent | | | +-----------------------+-----------------------+----------+--------+ | | | | | +-----------------------+-----------------------+----------+--------+ | File size: N bytes | Update activity: low | | | +-----------------------+-----------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +-----------------------+-----------------------+----------+--------+ | Bytes | Description | M/O | Length | +-----------------------+-----------------------+----------+--------+ | X | UICC Certificate | M | X | +-----------------------+-----------------------+----------+--------+ | The format is as | | | | | specified in TS | | | | | 33.401 [52]. | | | | +-----------------------+-----------------------+----------+--------+
## L.6.2 USIM-RN Files
### L.6.2.1 eF~RNid~ (Relay Node identifier)
This EF contains the Relay Node identifier the USIM-RN is bound to, see TS
33.401 [52].
An USIM-RN shall contain this file. The content of this file is not intended
to be read on UICC-RN interface. It serves as a storage location for the Relay
Node identifier to which the UICC is bound. The file content is described for
the purpose of Over-The-Air update.
+----------------------+----------------------+----------+---------+ | Identifier: \'6FEA\' | Structure: | Optional | | | | transparent | | | +----------------------+----------------------+----------+---------+ | | | | | +----------------------+----------------------+----------+---------+ | File size: N bytes | Update activity: low | | | +----------------------+----------------------+----------+---------+ | Access Conditions: | | | | | | | | | | READ ADM | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+----------------------+----------+---------+ | Bytes | Description | M/O | Length | +----------------------+----------------------+----------+---------+ | | Country Tag \'80\' | O | 1 byte | +----------------------+----------------------+----------+---------+ | | Country Length = 2 | C | 1 byte | +----------------------+----------------------+----------+---------+ | | Country code (ASCII | C | 2 bytes | | | characters) | | | +----------------------+----------------------+----------+---------+ | | Organization Tag | M | 1 byte | | | \'81\' | | | +----------------------+----------------------+----------+---------+ | | Organization Length | M | 1 byte | +----------------------+----------------------+----------+---------+ | | Organization name | M | K bytes | | | (characters coded in | | | | | UTF8) | | | +----------------------+----------------------+----------+---------+ | | Common Name Tag | M | 1 byte | | | \'82\' | | | +----------------------+----------------------+----------+---------+ | | Common Name Length | M | 1 byte | +----------------------+----------------------+----------+---------+ | | Common Name | M | L bytes | | | (characters coded in | | | | | UTF8) | | | +----------------------+----------------------+----------+---------+ | | Serial Number Tag | O | 1 byte | | | \'82\' | | | +----------------------+----------------------+----------+---------+ | | Serial Number Length | C | 1 byte | +----------------------+----------------------+----------+---------+ | | Serial Number | C | M bytes | | | (characters coded in | | | | | ASCII) | | | +----------------------+----------------------+----------+---------+ | NOTE: C: if the Tag | | | | | is present, this is | | | | | mandatory | | | | +----------------------+----------------------+----------+---------+
### L.6.2.2 EF~SCCmax~ (maximum value of Secure Channel Counter)
This EF contains the maximum number of transaction allowed with the same
Connection SA, when a secure channel is established. When the counter value in
TRANSACT DATA command reaches the maximum value, the terminal shall derive new
key material using Manage Secure Channel APDU -- establish SA -- Connection
SA, see ETSI TS 102.484 [66].
An USIM with an Application ID in the USIM-RN range shall contain this file.
+----------------------+------------------------+----------+--------+ | Identifier: \'6FEB\' | Structure: transparent | Optional | | +----------------------+------------------------+----------+--------+ | | | | | +----------------------+------------------------+----------+--------+ | File size: 8 bytes | Update activity: low | | | +----------------------+------------------------+----------+--------+ | Access Conditions: | | | | | | | | | | READ ALW | | | | | | | | | | UPDATE ADM | | | | | | | | | | DEACTIVATE ADM | | | | | | | | | | ACTIVATE ADM | | | | +----------------------+------------------------+----------+--------+ | Bytes | Description | M/O | Length | +----------------------+------------------------+----------+--------+ | 8 | Secure Channel counter | M | 8 byte | +----------------------+------------------------+----------+--------+
> NOTE: The value of the Secure channel counter is set at personalisation. It
> is not intended to be updated or modified as a result of establishing a new
> Connection SA.
###### ## Annex M (normative): USIM application dedicated for IOPS
# M.1 Introduction
IOPS allows to provide network service to Public Safety users even in the case
the network has no or only limited backhaul connectivity. One of the main
issues in such cases is the missing backhaul to perform authentication. A
solution has been defined by using local HSSs which take over the
responsibility for authentication in IOPS mode.
A problem identified for IOPS security when making use of local HSS is the
higher probability of a compromise of a local HSS. Therefore the security
solution described in 3GPP TS 33.401 [52] uses a local HSS with different
authentication credentials than the standard HSS in normal operation.
Additionally there might be several local HSSs and to further reduce the
impact of possible compromised local HSSs, each local HSS should use different
authentication credentials.
The security solution described in 3GPP TS 33.401 [52] is based on a USIM
application dedicated for IOPS and using derived individual keys per local
HSS.
3GPP TS 23.401 [69] Annex K specifies a PLMN identity dedicated for IOPS mode
of operation. Additionally a USIM dedicated for IOPS uses an Access Control
Class of \'11\' or \'15\'.
# M.2 Features of the USIM dedicated for IOPS
The USIM dedicated for IOPS may be implemented as a single USIM on a UICC or
as a secondary USIM application together with a normal USIM on one UICC. The
USIM for IOPS is a regular USIM application and contains all mandatory EFs for
a USIM and may also include any of the optional EFs defined for a USIM.
The USIM dedicated for IOPS nevertheless has some specifics:
> \- As specified in 3GPP TS 23.401 [69] Annex K, the Access Control Class in
> EF~ACC~ is set to either \'11\' or \'15\'. The specific values for the
> Access Control Class prevent UEs with different Access Control Classes from
> trying to attach to the IOPS network.
>
> \- The entry for the USIM dedicated for IOPS in EF~DIR~ has a label starting
> with \'USIM-IOPS\'.
In case multiple local HSSs are to be supported, The USIM should also support:
> \- The AMF (Authentication Management Field) mechanism as described in 3GPP
> TS 33.401 [52] Annex F.4.1 is supported.
>
> \- An Operator specific mechanism to derive local HSS individual keys is
> supported (see 3GPP TS 33.401 [52] Annex F.4).
NOTE: The mechanism to derive local HSS specific keys in the USIM dedicated
for IOPS is specific to an Operator and needs to be agreed for the local HSS
and the USIM. One example mechanism is described in 3GPP TS 33.401 [52] Annex
F.4.2.
# M.3 Selection mechanisms
The method for selecting a USIM dedicated for IOPS is left to ME
implementation.
###### ## Annex N (normative): USIM supporting non-IMSI SUPI Type
# N.1 Introduction
**IMSI based USIM** is a USIM Application which is configured with a SUPI of
type IMSI (i.e Service n°130 in the USIM Service Table shall not be
\"available\").
**Non-IMSI based USIM** is **a** USIM Application which is configured with a
SUPI of type non-IMSI (i.e Service n°130 in the USIM Service Table shall be
\"available\"). Examples of non-IMSI type are: NSI, GCI and GLI.
Both USIM application types shall use different AID ranges as defined in Annex
O of 3GPP TS 31.101 [11].
# N.2 Features of USIM supporting non-IMSI SUPI type
The non-IMSI based USIM may be implemented as a single USIM application on a
UICC or as a secondary USIM application together with an IMSI based USIM on
one UICC.
The non-IMSI based USIM is a regular USIM application and shall contain all
mandatory EFs defined for a USIM application in the present document and may
also include any of the optional EFs defined for a USIM application except
EF~IMSI~.
No additional features are supported by Non-IMSI based USIM.
# N.3 Application selection procedure
Application selection is performed according to the procedures defined in
clause 5.1.1.1. The following provisions apply:
The method for selecting a non-IMSI based USIM is based on the presence of the
corresponding application with the associated AID in EF~DIR~, as defined in
the Annex O of 3GPP TS 31.101 [11].
NOTE: In case the UICC has multiple USIM Applications with different
configurations of SUPI types (i.e. at least one IMSI based USIM and at least
one non-IMSI based USIM), a non-IMSI based USIM can be selected in parallel
with an IMSI based USIM.
###### ## Annex O (informative): Examples of NAS security contexts management
in multiple registrations
+-------+-------+-------+-------+-------+-------+-------+-------+ | Step | **Sce |** 5GS | **5G | * |** 5GS | | | | | nario | 3GPPL | S3GPP | _5GSN | N3GPP | | | | | 1_ _| OCI_ _| NSC_ _| 3GPPL | NSC_ _| | | | | | | | OCI_ _| | | | +=======+=======+=======+=======+=======+=======+=======+=======+ | | | |__R |__R | |__R |__R | | | | | ecord | ecord | | ecord | ecord | | | | | 1_ _| 2_ _| | 1_ _| 2_ * | +-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | UE is | GU | 3gppN | - | GU | n | - | | | aut | TI-A1 | SC-A1 | | TI-A1 | 3gppN | | | | henti | | | | | SC-A1 | | | | cated | | | | | | | | | to | | | | | | | | | P | | | | | | | | | LMN-A | | | | | | | | | with | | | | | | | | | dual | | | | | | | | | conne | | | | | | | | | ction | | | | | | | | | (3GPP | | | | | | | | | and | | | | | | | | | non- | | | | | | | | | 3GPP) | | | | | | | | | | | | | | | | | | \ | | | | | | | | |  | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | UE | | Use | | | | | | | swi | | GU | | | | | | | tches | | TI-A1 | | | | | | | from | | from | | | | | | | P | | 5G | | | | | | | LMN-A | | SN3GP | | | | | | | to | | PLOCI | | | | | | | P | | and | | | | | | | LMN-B | | | | | | | | | on | | n | | | | | | | non | | 3gppN | | | | | | | -3GPP | | SC-A1 | | | | | | | | | from | | | | | | | | | 5 | | | | | | | | | GSN3G | | | | | | | | | PPNSC | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | UE | GU | 3gppN | | GU | n | n | | | succe | TI-A1 | SC-A1 | | TI-B1 | 3gppN | 3gppN | | | ssful | | | | | SC-B1 | SC-A1 | | | RE | | | | | | | | | GISTR | | | | | | | | | ATION | | | | | | | | | to | | | | | | | | | P | | | | | | | | | LMN-B | | | | | | | | | on | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | UE | GU | 3gppN | - | GU | n | - | | | succe | TI-B2 | SC-B1 | | TI-B1 | 3gppN | | | | ssful | | | | | SC-B1 | | | | REG | | | | | | | | | ISTRA | | | | | | | | | TION | | | | | | | | | to | | | | | | | | | P | | | | | | | | | LMN-B | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | | | | | | | | | | | | \ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | UE | | | | | | | | | sw | | | | | | | | | itche | | | | | | | | | s-off | | | | | | | | | (UE | | | | | | | | | init | | | | | | | | | d | | | | | | | | | e-reg | | | | | | | | | istra | | | | | | | | | tion) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | UE | GU | 3gppN | - | GU | n | - | | | s | TI-B2 | SC-B1 | | TI-B1 | 3gppN | | | | tores | | | | | SC-B1 | | | | to | | (S | | | | | | | USIM | | tored | | | (S | | | | the | | in | | | tored | | | | valid | | USIM) | | | in | | | | 3GPP | | ^(1)^ | | | USIM) | | | | Sec | | | | | ^(1)^ | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | (PL | | | | | | | | | MN-B) | | | | | | | | | and | | | | | | | | | the | | | | | | | | | valid | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | | | Sec | | | | | | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | (PL | | | | | | | | | MN-B) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | ME | | | | | | | | | c | | | | | | | | | lears | | | | | | | | | all | | | | | | | | | Sec | | | | | | | | | urity | | | | | | | | | Con | | | | | | | | | texts | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | UE | | | | | | | | | s | | | | | | | | | witch | | | | | | | | | es-on | | | | | | | | | back | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | UE | GU | 3gppN | - | GU | n | - | | | reads | TI-B2 | SC-B1 | | TI-B1 | 3gppN | | | | from | | | | | SC-B1 | | | | USIM | | | | | | | | | the | | | | | | | | | 3GPP | | | | | | | | | Sec | | | | | | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | (PL | | | | | | | | | MN-B) | | | | | | | | | and | | | | | | | | | the | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | | | Sec | | | | | | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | (PL | | | | | | | | | MN-B) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | UE | | Use | | | | | | | tries | | GU | | | | | | | to | | TI-B1 | | | | | | | reco | | from | | | | | | | nnect | | 5G | | | | | | | to | | SN3GP | | | | | | | P | | PLOCI | | | | | | | LMN-C | | and | | | | | | | on | | | | | | | | | non | | n | | | | | | | -3GPP | | 3gppN | | | | | | | Sec | | SC-B1 | | | | | | | urity | | from | | | | | | | Co | | 5 | | | | | | | ntext | | GSN3G | | | | | | | | | PPNSC | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | UE | GU | 3gppN | | GU | n | n | | | gets | TI-B2 | SC-B1 | | TI-C1 | 3gppN | 3gppN | | | RE | | | | | SC-C1 | SC-B1 | | | GISTR | | | | | | | | | ATION | | | | | | | | | succe | | | | | | | | | ssful | | | | | | | | | on | | | | | | | | | P | | | | | | | | | LMN-C | | | | | | | | | over | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | UE | Use | | | | | | | | tries | e.g. | | | | | | | | to | GU | | | | | | | | reco | TI-B2 | | | | | | | | nnect | from | | | | | | | | to | 5 | | | | | | | | P | GS3GP | | | | | | | | LMN-C | PLOCI | | | | | | | | on | | | | | | | | | 3GPP | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | UE | GU | 3gppN | | GU | n | - | | | gets | TI-C2 | SC-C1 | | TI-C1 | 3gppN | | | | RE | | | | | SC-C1 | | | | GISTR | | | | | | | | | ATION | | | | | | | | | succe | | | | | | | | | ssful | | | | | | | | | on | | | | | | | | | P | | | | | | | | | LMN-C | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | | | | | | | | | | | | \ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | UE | | | | | | | | | sw | | | | | | | | | itche | | | | | | | | | s-off | | | | | | | | | (UE | | | | | | | | | init | | | | | | | | | d | | | | | | | | | e-reg | | | | | | | | | istra | | | | | | | | | tion) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | UE | GU | 3gppN | | GU | n | - | | | s | TI-C2 | SC-C1 | | TI-C1 | 3gppN | | | | tores | | | | | SC-C1 | | | | to | | (S | | | | | | | USIM | | tored | | | (S | | | | the | | in | | | tored | | | | valid | | USIM) | | | in | | | | 3GPP | | ^(1)^ | | | USIM) | | | | Sec | | | | | ^(1)^ | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | (PL | | | | | | | | | MN-C) | | | | | | | | | and | | | | | | | | | the | | | | | | | | | valid | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | | | Sec | | | | | | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | (PL | | | | | | | | | MN-C) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | UE | GU | 3gppN | | GU | n | n | | | swi | TI-C2 | SC-C1 | | TI-D1 | 3gppN | 3gppN | | | tches | | | | | SC-D1 | SC-C1 | | | ON, | | | | | | | | | reads | | | | | | | | | sec | | | | | | | | | urity | | | | | | | | | con | | | | | | | | | texts | | | | | | | | | from | | | | | | | | | the | | | | | | | | | USIM | | | | | | | | | and | | | | | | | | | regi | | | | | | | | | sters | | | | | | | | | to | | | | | | | | | P | | | | | | | | | LMN-D | | | | | | | | | over | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | | | and | | | | | | | | | to | | | | | | | | | P | | | | | | | | | LMN-C | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | UE | GU | 3gppN | - | GU | n | - | | | regi | TI-D2 | SC-D1 | | TI-D1 | 3gppN | | | | sters | | | | | SC-D1 | | | | to | | | | | | | | | P | | | | | | | | | LMN-D | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | | | | | | | | | | | | \ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | UE | GU | 3gppN | | GU | n | n | | | regi | TI-D2 | SC-D1 | | TI-C3 | 3gppN | 3gppN | | | sters | | | | | SC-C2 | SC-D1 | | | to | | | | | | | | | P | | | | | | | | | LMN-C | | | | | | | | | over | | | | | | | | | non- | | | | | | | | | 3GPP, | | | | | | | | | rema | | | | | | | | | ining | | | | | | | | | regis | | | | | | | | | tered | | | | | | | | | in | | | | | | | | | P | | | | | | | | | LMN-D | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | | | a | | | | | | | | | ccess | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | UE | GU | 3gppN | | GU | n | n | | | de | TI-D2 | SC-D1 | | TI-C3 | 3gppN | 3gppN | | | -regi | | | | | SC-C2 | SC-D1 | | | sters | | | | | (S | | | | from | | | | | tored | | | | P | | | | | in | | | | LMN-C | | | | | USIM) | | | | over | | | | | ^(1)^ | | | | non | | | | | | | | | -3GPP | | | | | | | | | and | | | | | | | | | re | | | | | | | | | mains | | | | | | | | | regis | | | | | | | | | tered | | | | | | | | | in | | | | | | | | | P | | | | | | | | | LMN-D | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | | | a | | | | | | | | | ccess | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | UE | GU | 3gppN | | GU | n | n | | | de | TI-D2 | SC-D1 | | TI-C3 | 3gppN | 3gppN | | | -regi | | (S | | | SC-C2 | SC-D1 | | | sters | | tored | | | | | | | from | | in | | | | (S | | | P | | USIM) | | | | tored | | | LMN-D | | ^(1)^ | | | | in | | | over | | | | | | USIM) | | | 3GPP | | | | | | ^(1)^ | | | a | | | | | | | | | ccess | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 21 | UE | GU | 3gppN | | GU | n | n | | | regi | TI-D2 | SC-D1 | | TI-C4 | 3gppN | 3gppN | | | sters | | | | | SC-C3 | SC-D1 | | | to | | | | | | | | | P | | | | | | | | | LMN-C | | | | | | | | | over | | | | | | | | | non | | | | | | | | | -3GPP | | | | | | | | | a | | | | | | | | | ccess | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 22 | UE | GU | 3gppN | | GU | n | | | | regi | TI-C5 | SC-C3 | | TI-C4 | 3gppN | | | | sters | | | | | SC-C3 | | | | to | | | | | | | | | P | | | | | | | | | LMN-C | | | | | | | | | also | | | | | | | | | over | | | | | | | | | 3GPP | | | | | | | | | a | | | | | | | | | ccess | | | | | | | | | | | | | | | | | | \ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | [Ge | | | | | | | | | neral | | | | | | | | | not | | | | | | | | | e:]{. | | | | | | | | | under | | | | | | | | | line} | | | | | | | | | U | | | | | | | | | nless | | | | | | | | | spec | | | | | | | | | ified | | | | | | | | | as | | | | | | | | | 'S | | | | | | | | | tored | | | | | | | | | in | | | | | | | | | USIM' | | | | | | | | | all | | | | | | | | | the | | | | | | | | | data | | | | | | | | | ment | | | | | | | | | ioned | | | | | | | | | under | | | | | | | | | 5GS3G | | | | | | | | | PPNSC | | | | | | | | | or | | | | | | | | | 5 | | | | | | | | | GSN3G | | | | | | | | | PPNSC | | | | | | | | | repr | | | | | | | | | esent | | | | | | | | | data | | | | | | | | | saved | | | | | | | | | in | | | | | | | | | the | | | | | | | | | ME | | | | | | | | | m | | | | | | | | | emory | | | | | | | | | that | | | | | | | | | is | | | | | | | | | wr | | | | | | | | | itten | | | | | | | | | to | | | | | | | | | the | | | | | | | | | USIM | | | | | | | | | if | | | | | | | | | the | | | | | | | | | d | | | | | | | | | evice | | | | | | | | | is | | | | | | | | | sw | | | | | | | | | itche | | | | | | | | | d-off | | | | | | | | | or | | | | | | | | | de- | | | | | | | | | regis | | | | | | | | | tered | | | | | | | | | from | | | | | | | | | the | | | | | | | | | ne | | | | | | | | | twork | | | | | | | | | at | | | | | | | | | the | | | | | | | | | given | | | | | | | | | step. | | | | | | | | | | | | | | | | | | [Note | | | | | | | | | 1]{.u | | | | | | | | | nderl | | | | | | | | | ine}: | | | | | | | | | 5G | | | | | | | | | NAS | | | | | | | | | Sec | | | | | | | | | urity | | | | | | | | | Co | | | | | | | | | ntext | | | | | | | | | and | | | | | | | | | assoc | | | | | | | | | iated | | | | | | | | | NAS | | | | | | | | | DL/UL | | | | | | | | | C | | | | | | | | | OUNTs | | | | | | | | | (> | | | | | | | | | 0) | | | | | | | | | are | | | | | | | | | wr | | | | | | | | | itten | | | | | | | | | to | | | | | | | | | the | | | | | | | | | USIM | | | | | | | | | as | | | | | | | | | per | | | | | | | | | cl | | | | | | | | | auses | | | | | | | | | 4. | | | | | | | | | 4.2.1 | | | | | | | | | ( | | | | | | | | | NSC), | | | | | | | | | 4. | | | | | | | | | 4.3.1 | | | | | | | | | (NAS | | | | | | | | | COU | | | | | | | | | NTS), | | | | | | | | | and | | | | | | | | | annex | | | | | | | | | C of | | | | | | | | | 3GPP | | | | | | | | | 2 | | | | | | | | | 4.501 | | | | | | | | | [1 | | | | | | | | | 04]. | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+
#