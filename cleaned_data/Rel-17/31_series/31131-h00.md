# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
A Subscriber Identity Module Application Programming Interface (SIM API) has
been defined in TS 42.019 [4] as a technology-independent API by which toolkit
applications and (U)SIMs co-operate. That specification is independent of the
programming language technology used to create the application, the platform
used to host the application and the runtime environment used to execute the
application.
The present document includes information applicable to (U)SIM toolkit
application developers creating applications using the C programming language
ISO/IEC 9899 [7]. The present document describes an interface between toolkit
applications written in the C programming language and the (U)SIM in order to
realize the co-operation set forth in TS 42.019 [4]. In particular, the API
described herein provides the service of assembling proactive commands and
disassembling the responses to these commands for the application programmer.
Software tools, integrated software development environments and software
management systems that may be used to create application programs are
explicitly out of scope of the present document.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
```{=html}
``` \- For a non-specific reference, the latest version applies. In the > case
of a reference to a 3GPP document (including a GSM document), > a non-specific
reference implicitly refers to the latest version > of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 31.111: \"USIM Application Toolkit (USAT)\".
[3] 3GPP TS 23.048: \"Security Mechanisms for the (U)SIM application toolkit;
Stage 2\".
[4] 3GPP TS 42.019: \"Subscriber Identity Module Application Programming
Interface (SIM API); Stage 1\".
[5] ISO 639 (1988): \"Code for the representation of names of languages\".
[6] 3GPP TS 23.038: \"Alphabets and language‑specific information\".
[7] ISO/IEC 9899: \"Programming Languages - C\".
[8] 3GPP TS 11.14: \"Specification of the SIM Application Toolkit for the
Subscriber Identity Module - Mobile Equipment (SIM -- ME) interface\".
[9] Tool Interface Standard (TIS) Executable and Linking Format Specification
Version 1.2.
[10] SYSTEM V Application Binary Interface, Edition 4.1.
[11] 3GPP TS 51.011: \"Specification of the Subscriber Identity Module \-
Mobile Equipment (SIM‑ME) interface\".
[12] Void.
[13] 3GPP TS 31.115: \"Secured packet structure for (U)SIM Toolkit
applications\".
[14] 3GPP TS 31.116: \"Remote APDU Structure for (U)SIM Toolkit
applications\".
[15] 3GPP TS 31.102: \"Characteristics of the USIM Application\".
[16] 3GPP TS 31.101: \"UICC-Terminal Interface, Physical and Logical
Characteristics\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply:
**application:** computer program that defines and implements a useful domain-
specific functionality\ The term may apply to the functionality itself, to the
representation of the functionality in a programming language, or to the
realization of the functionality as executable code.
**application executable:** representation of an application as collection of
executable codes
**application program:** representation of an application in a programming
language such as assembly language, C, Java, WML or XHTML
**Application Programming Interface (API):** collection of entry points and
data structures that an application program can access when translated into an
application executable
**byte code:** processor-independent representation of a basic computer
operation such as \"increment by one\" that is executed by computer program
called a byte code interpreter
**data structure:** memory address that can be accessed by an application
executable in order to read or write data
**entry point:** memory address that can be branched to by an application
executable in order to access functionality defined by an application-
programming interface\ Depending on the software technology, an entry point is
also called a subroutine, a function or a method.
**executable code:** generic term for either byte code or native code
**framework:** defines a set of Application Programming Interface (API)
functions for developing applications and for providing system services to
those applications
**loadfile:** representation of an application executable that is transmitted
from the terminal to the smart card operating system\ A loadfile typically
includes information about the application executable in addition to the
application executable itself.
**native code:** processor-dependent representation of a basic computer
operation such as \"increment by one\" that is executed by the hardware
circuitry of a computer\'s central processing unit
**toolkit application:** uses the commands described in TS 31.111 [2] and TS
11.14 [8]
## 3.2 Abbreviations
For the purpose of the present document, the following abbreviations apply:
APDU Application Protocol Data Unit
API Application Programming Interface
CAT Card Application Toolkit
CS Circuit Switched
DCS Digital Cellular System
DF Dedicated File
DTMF Dual Tone Multiple Frequency
EF Elementary File
ELF Executable and Linkable Format
FID File Identifier
GSM Global System for Mobile communications
ME Mobile Equipment
NAA Network Access Application (SIM or USIM)
OTA Over The Air
SIM Subscriber Identity Module
SMS Short Message Service
STK SIM ToolKit
SW Status Word
TAR Toolkit Application Reference
TLV Tag, Length, Value
TPDU Transport Protocol Data Unit
UICC (not an acronym)
URL Uniform Resource Locator
USIM Universal Subscriber Identity Module
USSD Unstructured Supplementary Services Data
# 4 Description
The (U)SIM Application consists of the following:
\- APDU handlers for communicating with the ME;
\- File system and file access control;
\- Toolkit Framework that provides services to Toolkit applications.
The present document describes the C programming language binding for the
interface between the (U)SIM application and toolkit applications described in
TS 42.019 [4]. This API allows application programmers using the C programming
language to access functions and data described in TS 31.111 [2] and TS 11.14
[8], such that the (U)SIM-based applications and the services they implement
can be developed and loaded onto ICCs. If required and supported by the
underlying smart card technology, toolkit applications can be loaded or
deleted remotely, after the card has been issued.
## 4.1 Overview
The _\'C\'-binding for (U)SIM API_ shall provide function calls for pro-active
functions and transport functions. The figure below shows the interactions
between a typical toolkit application (shown in blue) and the various
functional blocks of the (U)SIM (shown in orange). The C-bindings for these
APIs are presented in subclause 4.2.
Figure 1
## 4.2 Design Rationale and Upward Compatibility
Some functions on the C SIM API take parameters that correspond to optional
TLVs in TS 31.111 [2] and TS 11.14 [8]. If the actual parameter value passed
to the function is NULL, the corresponding TLV is not passed to the ME; an
example of an optional parameter is CatIconIdentifier that corresponds to the
ICON IDENTIFIER TLV.
Some proactive commands have a very large number of optional TLVs, such as
SETUP CALL. Therefore, this API offers two variants that address this aspect,
CatSetupCall and CatSetupCallEx. The first function, CatSetupCall, takes as
parameters everything that is necessary to issue a successful SETUP CALL
proactive command (i.e. everything required to construct the mandatory TLVs as
required by TS 31.111 [2] and TS 11.14 [8]) and also includes optional user
interface TLVs (title and icon) for ease of use.
The second function, CatSetupCallEx, takes a parameter block that can be
extended in future versions of the present specification. The parameter block
contains members that correspond to all mandatory and optional TLVs for the
SETUP CALL proactive command.
The reason for introducing the \"...Ex\" variants is threefold:
\- Rather than extend the parameter list of a function to take a large number
of optional parameters for each call, it is preferable to set up the
parameters using named structure members before issuing the call to the
function.
\- If a future version of TS 31.111 [2] or TS 11.14 [8] extends the optional
parameters for a proactive command, the corresponding parameter block can be
extended to encompass these parameters without changing the function
prototype.
\- Any source code written for an older version of this C SIM API can be
recompiled with a later version without change and will remain upwardly
compatible at the source as long as the suggested coding standards are adhered
to.
## 4.3 Application Triggering
The application-triggering portion of the SIM Toolkit Framework is responsible
for the activation of toolkit applications, based on the APDU received by the
card.
The ME shall not be adversely affected by the presence of applications on the
(U)ICC card. For instance a syntactically correct Envelope shall not result in
an error status word in case of a failure of an application. The only
application as seen by the ME is the (U)SIM application. As a result, a
toolkit application may return an error, but this error will not be sent to
the ME.
The difference between an application and a toolkit application is that a
toolkit application does not typically handle APDUs directly. It will handle
higher-level messages. Furthermore the execution of a function could span over
multiple APDUs, in particular, the proactive protocol commands.
All the applications that have registered interest in the event are triggered
in order of their priority.
\- The current context is switched to the toolkit application.
\- A pending transaction is aborted.
\- The current file context of the toolkit application is the MF.
\- The current file context of the current selected application is unchanged.
On termination of a toolkit application execution of CatExit():
\- The context switches back to the context of the current selected
application, the NAA application.
\- A pending toolkit application transaction is aborted.
Here after are the events that can trigger a toolkit application:
_EVENT_PROFILE_DOWNLOAD_
Upon reception of the Terminal Profile command by the (U)SIM, the Toolkit
Framework stores the ME profile and then triggers the registered toolkit
application that may want to change their registry. A toolkit application may
not be able to issue a proactive command.
_EVENT_MENU_SELECTION, EVENT_MENU_SELECTION_HELP_REQUEST_
A toolkit application might be activated upon selection in the ME\'s menu by
the user, or request help on this specific menu.
In order to allow the user to choose in a menu, the Toolkit Framework shall
have previously issued a SET UP MENU proactive command. When a toolkit
application changes a menu entry of its registry object, the Toolkit Framework
shall dynamically update the menu stored in the ME during the current card
session. The SIM Toolkit Framework shall use the data of the EFsume file (TS
51.011 [11] and TS 31.102 [15]) when issuing the SET UP MENU proactive
command.
The positions of the toolkit application menu entries in the item list, the
requested item identifiers and the associated limits (e.g. maximum length of
item text string) are defined at the loading of the toolkit application.
If at least one toolkit application registers to
EVENT_MENU_SELECTION_HELP_REQUEST, the SET UP MENU proactive command sent by
the Toolkit Framework shall indicate to the ME that help information is
available. A toolkit application registered for one or more menu entries may
be triggered by the event EVENT_MENU_SELECTION_HELP_REQUEST, even if it is not
registered to this event. A toolkit application registered for one or more
menu entries should provide help information.
_EVENT_FORMATTED_SMS_PP_ENV, EVENT_UNFORMATTED_SMS_PP_ENV,_
_EVENT_FORMATTED_SMS_PP_UPD, EVENT_UNFORMATTED_SMS_PP_UPD_
A toolkit application can be activated upon the reception of a short message.
There are two ways for a card to receive an SMS: via the Envelope SMS-PP Data
Download or the UpdateRecord EFsms instruction.
The reception of the SMS by the toolkit application cannot be guaranteed for
the Update Record EFsms instruction.
The received SMS may be:
\- formatted according to TS 23.048 [3] or an other protocol to identify
explicitly the toolkit application for which the message is sent;
\- unformatted or using a toolkit application specific protocol the Toolkit
Framework will pass this data to all registered toolkit applications.
_EVENT_FORMATTED_SMS_PP_ENV_
This event is triggered by an envelope APDU containing an SMS_DATADOWNLOAD BER
TLV with an SMS_TPDU simple TLV according to TS 23.048 [3].
The Toolkit Framework shall:
\- verify the TS 23.048 [3] security of the SMS TPDU;
\- trigger the toolkit application registered with the corresponding TAR
defined at application loading;
\- take the optional Application Data posted by the triggered toolkit
application if present;
\- secure and send the response packet.
The toolkit application will only be triggered if the TAR is known and the
security verified. Application data will also be deciphered.
_EVENT_UNFORMATTED_SMS_PP_ENV_
The registered toolkit applications will be triggered by this event and get
the data transmitted in the APDU envelope SMS_DATADOWNLOAD.
_EVENT_FORMATTED_SMS_PP_UPD_
This event is triggered by Update Record EFsms with an SMS TP-UD field
formatted according to TS 23.048 [3].
The Toolkit Framework shall:
\- update the EFsms file with the data received, it is then up to the
receiving toolkit application to change the SMS stored in the file (i.e. the
toolkit application need to have access to the EFsms file);
\- verify the TS 23.048 [3] security of the SMS TPDU;
\- convert the Update Record EFsms in a TLV List, an EnvelopeHandler;
\- trigger the toolkit application registered with the corresponding TAR
defined at application loading.
_EVENT_UNFORMATTED_SMS_PP_UPD_
The SIM Toolkit Framework will first update the EFsms file, convert the
received APDU as described above, and then trigger all the registered toolkit
applications. All of them may modify the content of EFsms (i.e. the toolkit
applications need to have access to the EFsms file).
_EVENT_UNFORMATTED_SMS_CB_
When the ME receives a new cell broadcast message, the cell broadcast page may
be passed to the card using the envelope command. e.g. the application may
then read the message and extract a meaningful piece of information that could
be displayed to the user, for instance.
_EVENT_CALL_CONTROL_BY_SIM_
When the NAA is in call control mode and when the user dials a number, this
number is passed to the Toolkit Framework. Only one toolkit application can
handle the answer to this command: call barred, modified or accepted.
_EVENT_EVENT_DOWNLOAD_MT_CALL, EVENT_EVENT_DOWNLOAD_CALL_CONNECTED,_
_EVENT_EVENT_DOWNLOAD_CALL_DISCONNECTED,
EVENT_EVENT_DOWNLOAD_LOCATION_STATUS,_
_EVENT_EVENT_DOWNLOAD_USER_ACTIVITY,
EVENT_EVENT_DOWNLOAD_IDLE_SCREEN_AVAILABLE,_
_EVENT_EVENT_DOWNLOAD_CARD_READER_STATUS_
The toolkit application will be triggered by the registered event download
trigger, upon reception of the corresponding Envelope command. In order to
allow the toolkit application to be triggered by these events, the Toolkit
Framework shall have previously issued a SET UP EVENT LIST proactive command.
When a toolkit application changes one or more of these requested events of
its registry, the Toolkit Framework shall dynamically update the event list
stored in the ME during the current card session.
_EVENT_MO_SHORT_MESSAGE_CONTROL_BY_SIM_
Before sending an SMS MO entered by the user, the SMS is submitted to the
Toolkit framework. Only one toolkit application can register to this event.
_EVENT_TIMER_EXPIRATION_
This event is registered when the application executes a successful Toolkit
CatGetTimer(). The toolkit application can then manage this (these) timer(s),
and it will be triggered at the reception of the APDU Envelope TIMER
EXPIRATION. The Toolkit Framework shall reply busy to this Envelope APDU if it
cannot guaranty to trigger the corresponding toolkit application.
_EVENT_UNRECOGNIZED_ENVELOPE_
The application registered to this event shall be triggered by the framework
if the BER-TLV tag contained in the ENVELOPE APDU is not defined in the
associated release of TS 31.111 [2] and TS 11.14 [8] and if no corresponding
constant is defined in the list of the ToolkitConstants interface. By
providing the means to transfer an arbitrary block of data, the Unrecognized
Envelope Event will allow a toolkit application to handle the evolution of the
specifications TS 31.111 [2] and TS 11.14 [8].
_EVENT_STATUS_COMMAND_
At reception of a STATUS APDU command, the SIM Toolkit Framework shall trigger
the registered toolkit application.
A range of events is reserved for experimental and proprietary usage (from
-128 to -1). As the definition of these events is not standardized, the use of
these events may make the toolkit application behave differently on different
platforms.
The toolkit application shall be triggered for the registered events upon
reception, and shall be able to access to the data associated to the event
using OpenEnvelope() or the low-level functions.
The order of triggering the toolkit application shall follow the priority
level of each toolkit application defined at its loading. If several toolkit
applications have the same priority level, the last loaded toolkit application
takes precedence.
## 4.4 Proactive command handling
The (U)SIM application toolkit protocol (i.e. 91xx, Fetch, Terminal Response)
is handled by the network access application and the Toolkit Framework. The
toolkit application shall not handle those events.
The network access application and the Toolkit Framework shall handle the
transmission of the proactive command to the ME, and the reception of the
response. The Toolkit Framework will then return in the toolkit application
just after the proactive command. It shall then provide to the toolkit
application the values as indicated in the function parameters. It also
provides the raw return information so that the toolkit application can
analyse the response.
The proactive command is sent to the ME as defined and constructed by the
toolkit library without any check of the Toolkit Framework.
The toolkit application shall not issue the following proactive commands: SET
UP MENU, SET UP EVENT LIST, POLL INTERVAL, POLLING OFF; as those are system
proactive commands that will affect the services of the Toolkit Framework.
## 4.5 Application Loading
Applications compliant to the present document are represented for loading as
loadfiles in the Executable and Linkable Format (ELF) described in Tool
Interface Standard (TIS) Executable and Linking Format Specification [9] and
SYSTEM V Application Binary Interface [10]. The application executable in the
ELF loadfile may be either native code or byte code that has been created
through a process of compiling the representation of the application program
in the C programming language.
The e_machine entry in the ELF header is set to according to the table in
annex A and indicates the architecture for which the application executable in
the loadfile has been prepared.
Coding for other processors, processor instruction set extensions and byte
code interpreters will be defined as needed processor-specific or interpreter-
specific supplements to SYSTEM V Application Binary Interface [10] may also be
provided as needed.
Loadfile linkers, loaders and installers, whether on-card or off-card, return
an error condition if the application representation in the loadfile cannot be
accommodated or if resources requested by the application are not available.
The over-the-air application loading mechanism, protocol and application life
cycle are defined in TS 23.028 [3].
# 5 \'C\'-language binding for (U)SIM API
## 5.1 Overview
This subclause presents the \'C\'-language binding to (U)SIM API. It is
divided into sections as follows:
\- Toolkit application entry and exit.
\- Man-Machine Interface.
\- Timers.
\- Supplementary card reader.
\- UICC file store access.
\- Registry.
\- Miscellaneous.
\- Low-level functions.
\- Network services.
\- Supporting data types.
For each function, the prototype is given followed by a table describing the
parameters and whether they are input [in] or output [out] parameters. There
is explanatory text which explains the function\'s purpose and whether it is a
proactive command or not.
## 5.2 Toolkit Application Functions
Toolkit applications will start by executing the application-defined function
_main_. There are no arguments to _main_ , nor are there any return results.
The application can find out why it was invoked using the
_CatGetFrameworkEventt_ function. The Framework events that can cause an
application to be invoked can be split into the following groups:
\- Command monitoring.
\- ME monitor events.
\- Application lifecycle change.
Command monitoring enables applications to be invoked when the framework
receives commands from the ME. Currently supported commands that can be
monitored are:
\- TERMINAL PROFILE: monitoring this command enables an application to be
invoked when the ME is powered on.
\- STATUS: monitoring this command enables an application to be invoked when
the ME polls for proactive commands.
\- ENVELOPE: monitoring this command enables the application to be informed of
specific envelope type arrival for example call control envelopes can be
monitored.
ME monitor events are events that the framework can ask the ME to monitor; for
example an event can be sent on call connection. ME monitored events are
delivered to the application in the EVENT DOWNLOAD envelope as received from
the ME.
The application lifecycle event enables the framework to invoke an application
when the application status has changed. This is mainly to enable an
application to be run at installation time so that it can set up its registry
entries. The details of the application lifecycle events are provided in TS
31.116 [14].
### 5.2.1 main
**void\ main (void);**
The main function is the application entry point. The application should not
return from _main_ ; it must call the _CatExit_ function.
An example main function is given below:
void main(void)\ {\ switch (CatGetFrameworkEvent())\ {\ case
EVENT_APPLICATION_LIFECYCLE_INSTALL:\ // set up registry for this application\
CatSetMenuString(.....\ CatNotifyOnEnvelope(SMS_PP_DOWNLOAD_TAG,1);\
CatNotifyOnEvent(CARD_READER_STATUS,1);\ break;\ case EVENT_ENVELOPE_COMMAND:\
{\ BYTE length;\ switch (CatOpenEnvelope(&length))\ {\ case
MENU_SELECTION_TAG:\ // search for help request .....\ break;\ case
SMS_PP_DOWNLOAD_TAG:\ .....\ break;\ case EVENT_DOWNLOAD_TAG:\ // search for
card reader status event .....\ break;\ default:\ CatExit();\ }\ }\ break;\
default:\ CatExit();\ break;\ }\ CatExit();\ }
### 5.2.2 CatGetFrameworkEvent
**CatFrameworkEventType\ CatGetFrameworkEvent(void);**
* * *
_RETURN_ Framework event type that caused the application to run; see
CatFrameworkEventType for details.
* * *
### 5.2.3 CatExit
**void\ CatExit (void) ;**
* * *
* * *
_CatExit_ causes the application to terminate execution and return control to
the framework. When the application is restarted, it enters at _main_.
## 5.3 Registry
The menu entry(ies) of the application, together with the set of framework
events that the application is interested in, may be registered using the
functions defined in this subclause.
### 5.3.1 CatSetMenuString
**void\ CatSetMenuString (BYTE** _MenuID_ ,\ **BYTE** _MenuStringLength_ ,
**const void ***_MenuString_ ,\ **const CatIconIdentifier**
*****_IconIdentifier_ ,\ **BYTE** _HelpAvailable,_ \ **BYTE**
_NextAction_**)** ;
* * *
_MenuID_ [in] The menu ID by which this entry is known. _MenuStringLength_
[in] The length, in bytes, of MenuString. _MenuString_ [in] The menu entry to
be placed in the registry. If MenuString is NULL or MenuStringLength is zero,
any existing menu entry associated with MenuID is removed and is not displayed
by the ME. _IconIdentifier_ [in] Optional icon identifier; see
CatIconIdentifier for member details. If IconIdentifier is NULL or if
IconIdentifier.UseIcon is zero, no icon identifier is sent to the ME.
_HelpAvailable_ [in] If non zero the application can supply help. _NextAction_
[in] The (optional) next action value
* * *
_CatSetMenuString_ allows the application to define a menu entry together with
an icon. A non-zero value can be supplied if a next action indicator is
required. This function will implicitly request that the application is
notified of menu selection envelopes i.e. there is no requirement to call the
_CatNotifiyOnEnvelope_ function. An application can have several menu entries
and must examine the menu selection envelope to decide which menu selection
caused it to be invoked.
The ordering of menu entries within a menu presented by the ME is based on
increasing integer values of identifiers selected by the application. Note
that any application\'s menu item ordering may be further overridden by an
external source, e.g. card issuer, via a request to the SIM Toolkit framework
this mechanism is beyond the scope of the present document.
### 5.3.2 CatNotifyOnFrameworkEvent
**void\ CatNotifyOnFrameworkEvent(CatFrameworkEventType Event, BYTE
Enabled);**
* * *
_Event_ [in] A framework event the application is interested in, see
CatFrameworkEventType for details. _Enabled_ [in] If non-zero the framework
event is monitored otherwise the framework event isn\'t monitored. By default
only application lifecycle events are monitored.
* * *
_CatNotifyOnFrameworkEvent_ enables the application to add/remove a framework
event to/from the set of framework events that it is interested in.
### 5.3.3 CatNotifyOnEnvelope
**void\ CatNotifyOnEnvelope(CatEnvelopeTagType Tag, BYTE Enabled);**
* * *
_Tag_ [in] The particular envelope type to monitor; see CatEnvelopeTagType for
details. _Enabled_ [in] If non-zero the envelope type is monitored otherwise
the envelope type isn\'t monitored.
* * *
_CatNotifyOnEnvelope_ enables the application to add/remove an envelope
monitoring event to/from the set of the envelope monitoring events it is
interested in. Note that the monitoring of MENU SELECTION, TIMER EXPIRATION
and EVENT DOWNLOAD envelopes is handled by the framework.
### 5.3.4 CatNotifyOnEvent
**void\ CatNotifyOnEvent(CatEventType EventType, BYTE Enabled);**
* * *
_EventType_ [in] The particular event type to monitor; see CatEventType for
details. _Enabled_ [in] If non-zero the event type is monitored otherwise the
event isn\'t monitored.
* * *
_CatNotifyOnEvent_ enables the application to add/remove an ME monitored event
to/from the set of ME monitored events it is interested in.
## 5.4 Man-Machine Interface
### 5.4.1 CatAddItem
**void\ CatAddItem(BYTE** _ItemTextLength_ , **const void ***_ItemText_ ,
**BYTE** _ItemIdentifier_**)** ;
* * *
_ItemTextLength_ [in] The length in bytes of the following _ItemText_ field.
_ItemText_ [in] Text associated with item. _ItemIdentifier_ [in] Specifies a
unique identifier to be associated with this selection. This value is returned
in the SelectedItem parameter of CatSelectItem if this item is selected from
the menu.
* * *
_CatAddItem_ adds an item to a list for the user to select. See
_CatSelectItem_ below for details on the construction of a display list.
### 5.4.2 CatSelectItem
**void\ CatSelectItem (BYTE** _TitleLength_ , **const void ***_Title_ ,\
**CatSelectItemOptions** _Options_**)** ;
* * *
_TitleLength_ [in] The length in bytes of Title. _Title_ [in] Title of the
list of choices. Options [in] Acceptable values for this parameter are listed
in CatSelectItemOptions.
* * *
_CatSelectItem_ initiates the construction of a list of items to be displayed
to the user and from which the user is expected to select exactly one entry.
After _CatSelectItem_ has been called, entries are added to the list one at a
time using the _CatAddItem_ entry point above. When all items have been added
to the list, the list is sent to the ME using the _CatEndSelectItem_ entry
point below. _CatEndSelectItem_ causes the list to be displayed and returns to
the caller the item selected.
### 5.4.3 CatEndSelectItem
**CatGeneralResult\ CatEndSelectItem (BYTE ***_SelectedItem,\ *__const
CatIconIdentifier *_ **IconIdentifier** _)_ *;
* * *
_SelectedItem_ [out] Index of item selected by user. _IconIdentifier_ [in]
Optional icon identifier; see CatIconIdentifier for member details. If
IconIdentifier is NULL or if IconIdentifier.UseIcon is zero, no icon
identifier is sent to the ME. _RETURN_ The GeneralResult code of the SELECT
ITEM proactive command.
* * *
_CatEndSelectItem_ issues the proactive command SELECT ITEM that displays on
the ME a list of items for the user to choose from. The terminal response is
parsed and if successful the _SelectedItem_ parameter is set to the index of
the item chosen. See _CatSelectItem_ above for details on the construction of
a display list.
### 5.4.4 CatDisplayText
**CatGeneralResult\ CatDisplayText (CatDCSValue** _TextDCS_ , **BYTE**
_TextLength_ , **const void ***_Text_ ,\ **CatDisplayTextOptions Text**
_Options_ ,
**CatTextFormat TextFormat,**
**CatForegroundColor ForegroundColour,**
**CatBackgroundColour BackgroundColour,\ const CatIconIdentifier
***_IconIdentifier_ ,\ **BYTE** _ImmediateResponse_**)** ;
* * *
_TextDCS_ [in] The data coding scheme for _Text_. Acceptable values for this
parameter are listed in CatDCSValue.
_TextLength_ [in] The length in bytes of _Text_.
_Text_ [in] String to display on ME.
_TextOptions_ [in] Acceptable values for this parameter are listed in
CatDisplayTextOptions.
_TextFormat_ [in] Format of text; e.g. bold, italic, etc.
_ForegroundColour_ [in] Foreground colour of text; i.e. colour of the letters.
_BackgroundColour_ [in] Background colour of text; i.e. colour filled in
behind the letters.
_IconIdentifier_ [in] Optional icon identifier; see CatIconIdentifier for
member details. If _IconIdentifier_ is NULL or if _IconIdentifier_._UseIcon_
is zero, no icon identifier is sent to the ME.
_ImmediateResponse_ [in] True-program continues execution as soon as ME
receives instruction.\ False-program waits until text is cleared on the ME
before continuing, and the Immediate Response TLV is not passed to the ME.
_RETURN_ The GeneralResult code of the DISPLAY TEXT proactive command.
* * *
### 5.4.5 CatGetInKey
**CatGeneralResult\ CatGetInKey (CatDCSValue** _TitleDCS_ , **BYTE**
_TitleLength_ , **const void ***_Title_ ,\ **CatGetInKeyOptions** _Options_ ,\
**const CatIconIdentifier ***_IconIdentifier_ ,\ **CatDCSValue ***_DCSOut_ ,
**void ***_KeyOut_**)** ;
* * *
_TitleDCS_ [in] The data-coding scheme for _Title_. Acceptable values for this
parameter are listed in CatDCSValue. _TitleLength_ [in] The length in bytes of
_Title_. _Title_ [in] String to display on ME. _Options_ [in] Acceptable
values for this parameter are listed in CatGetInKeyOptions. _IconIdentifier_
[in] Optional icon identifier; see CatIconIdentifier for member details. If
_IconIdentifier_ is NULL or if _IconIdentifier_._UseIcon_ is zero, no icon
identifier is sent to the ME. _DcsOut_ [out] The packing type of the returned
key. This parameter is set to one of the values listed in . _KeyOut_ [out] The
key pressed. _RETURN_ The GeneralResult code of the GET INKEY proactive
command.
* * *
_CatGetInKey_ issues the proactive command GET INKEY. The terminal response is
parsed and if successful the _DCSOut_ and _KeyOut_ parameters are updated.
### 5.4.6 CatGetInput
**CatGeneralResult\ CatGetInput(CatDCSValue** _TitleDCS_ , **BYTE**
_TitleLength_ , **const void ***_Title_ ,\ **CatGetInputOptions** _Options_ ,\
**CatDCSValue** _DefaultReplyDCS_ ,\ **BYTE** _DefaultReplyLength_ , **const
void ***_DefaultReply_ ,\ **BYTE** _MinimumResponseLength_ ,\ **BYTE**
_MaximumResponseLength_ ,\ **const CatIconIdentifier ***_IconIdentifier_ ,\
**CatDCSValue ***_MsgOutDCS_ , **BYTE ***_MsgOutLength_ , **void ***_MsgOut_);
* * *
_TitleDCS_ [in] The data-coding scheme for _Title_. Acceptable values for this
parameter are listed in . _TitleLength_ [in] The length in bytes of _Title_.
_Title_ [in] String to display on ME while waiting for the user to press a
key. _Options_ [in] Acceptable values for this parameter are listed in
CatGetInputOptions. _DefaultReplyDCS_ [in] The data-coding scheme for
_DefaultReply_. Acceptable values for this parameter are listed in .
_DefaultReplyLength_ [in] The length in bytes of _DefaultReply_.
_DefaultReply_ [in] Default response string; use NULL for \"no reply\"-no
Default Reply tag length value (TLV) is sent to the ME.
_MinimumResponseLength_ [in] Minimum allowed length for the response, in
either characters or digits. _MaximumResponseLength_ [in] Maximum allowed
length for the response, in either characters or digits. _IconIdentifier_ [in]
Optional icon identifier; see CatIconIdentifier for member details. If
_IconIdentifier_ is NULL or if _IconIdentifier_._UseIcon_ is zero, no icon
identifier is sent to the ME. _MsgOutDCS_ [out] Packing type of the returned
data. This parameter is set to one of the values listed in . _MsgOutLength_
[out] Length of the returned message in bytes. _MsgOut_ [out] A pointer to
where the returned string or message is placed. _RETURN_ The GeneralResult
code of the GET INPUT proactive command.
* * *
_CatGetInput_ issues the proactive command GET INPUT. The terminal response is
parsed and if successful _MsgOutDCS_ , _MsgOutLength_ , _MsgOut_ parameters
are updated.
### 5.4.7 CatSetupIdleModeText
**CatGeneralResult\ CatSetupIdleModeText (CatDCSValue** _TextDCS_ , **BYTE**
_TextLength_ , **const void ***_Text_ ,\ **const CatIconIdentifier
***_IconIdentifier_);
* * *
_TextDCS_ [in] The data-coding scheme for _Text_. Acceptable values for this
parameter are listed in . _TextLength_ [in] The length in bytes of _Text_.
_Text_ [in] String to display while ME is idle. _IconIdentifier_ [in] Optional
icon identifier; see CatIconIdentifier for member details. If _IconIdentifier_
is NULL or if _IconIdentifier_._UseIcon_ is zero, no icon identifier is sent
to the ME. _RETURN_ The GeneralResult code of the SETUP IDLE MODE TEXT
proactive command.
* * *
_CatSetupIdleModeText_ issues the proactive command SET UP IDLE MODE TEXT that
sets the ME\'s default text string.
### 5.4.8 CatPlayTone
**CatGeneralResult\ CatPlayTone (BYTE** _TextLength_ , **const void ***_Text_
,\ **CatTone** _Tone_ ,\ **CatTimeUnit** _Units_ , **BYTE** _Duration,\
*__const CatIconIdentifier *_ *_IconIdentifier_);
* * *
_TextLength_ [in] The length in bytes of the string _Text_ to display on the
ME. _Text_ [in] String to display on ME while sound is being played. _Tone_
[in] Specifies tone to play. Acceptable values for this parameter are listed
in CatTone. _Units_ [in] Unit of time specified for _duration_ parameter.
Acceptable values for this parameter are listed in CatTimeUnit. _Duration_
[in] Amount of time to play the tone, in units specified in the _Units_
parameter _IconIdentifier_ [in] Optional icon identifier; see
CatIconIdentifier for member details. If _IconIdentifier_ is NULL or if
_IconIdentifier_._UseIcon_ is zero, no icon identifier is sent to the ME.
_RETURN_ The GeneralResult code of the PLAY TONE proactive command.
* * *
_CatPlayTone_ issues the proactive command PLAY TONE.
## 5.5 Timers
### 5.5.1 CatGetTimer
**BYTE\ CatGetTimer (void);**
* * *
_RETURN_ The identifier of the timer.
* * *
_CatGetTimer_ returns the ID of a timer that is not currently in use. If no
timer is available, this function returns zero. Timer identifiers are assigned
by the framework.
### 5.5.2 CatFreeTimer
**void\ CatFreeTimer (BYTE** _TimerID_**)** ;
* * *
_TimerID_ [in] ID of timer to free; obtained from CatGetTimer.
* * *
_CatFreeTimer_ frees the handle to the specified timer, making it available
for the next request. It is not a proactive command. No information is passed
to the ME by this function.
### 5.5.3 CatStartTimer
**void\ CatStartTimer (BYTE** _TimerID_ , **CatTimerValue ***_TimerValue_**)**
;
* * *
_TimerID_ [in] ID of the timer to initialize; obtained from CatGetTimer.
_TimerValue_ [in] Initial value of the timer. The value is specified in a
structure of type CatTimerValue. _RETURN_ The GeneralResult code of the TIMER
MANAGEMENT proactive command.
* * *
_CatStartTimer_ issues a proactive TIMER MANAGEMENT command to initialize a
timer to the parameter values.
### 5.5.4 CatGetTimerValue
**void\ CatGetTimerValue (BYTE** _TimerID_ , **CatTimerValue
***_TimerValue_**)** ;
* * *
_TimerID_ [in] ID of the timer from which to obtain values; obtained from
CatGetTimer _TimerValue_ [out] The time remaining to run of timer _TimerID_.
The value is returned in a structure of type CatTimerValue. _RETURN_ The
GeneralResult code of the TIMER MANAGEMENT proactive command.
* * *
_CatGetTimerValue_ issues a proactive TIMER MANAGEMENT command to obtain the
timer\'s current value.
## 5.6 Supplementary Card Reader Management
These functions access the supplementary card-reader on a dual-slot ME.
### 5.6.1 CatPowerOnCard
**CatGeneralResult\ CatPowerOnCard (CatDevice** _DeviceID_ , **BYTE
***_ATRLength,_ **void ***_ATR_**)** ;
* * *
_DeviceID_ [in] The device to power on. An acceptable value for this parameter
is a card reader device selected from CatDevice. _ATRLength_ [in/out] Size of
the ATR buffer on input and the umber of bytes returned by the card as the ATR
on output. _ATR_ [out] Pointer to where answer to reset (ATR) will be stored.
_RETURN_ The GeneralResult code of the POWER ON CARD proactive command.
* * *
_CatPowerOnCard_ issues the proactive command POWER ON CARD that powers on a
supplementary card reader. The terminal response is parsed and if successful
the _ATR_ and _ATRLength_ parameters are.
### 5.6.2 CatPowerOffCard
**CatGeneralResult\ CatPowerOffCard (CatDevice** _DeviceID_**)** ;
* * *
_DeviceID_ [in] The device to power off. An acceptable value for this
parameter is a card reader device selected from CatDevice. _RETURN_ The
GeneralResult code of the POWER OFF CARD proactive command.
* * *
_CatPowerOffCard_ issues the proactive command POWER OFF CARD that turns off
the supplementary card reader.
### 5.6.3 CatPerformCardAPDU
**CatGeneralResult\ CatPerformCardAPDU (CatDevice** _DeviceID_ ,\ **BYTE**
_CAPDULength_ ,**const void ***_CAPDU,_ \ **BYTE ***_RAPDULength,_ **void
***_RAPDU_**)** ;
* * *
_DeviceID_ [in] The device to send the command APDU (C-APDU) to. An acceptable
value for this parameter is a card reader device selected from CatDevice.
_CAPDU_ [in] _Pointer to the command C-APDU to be sent to the additional card
device._ _CAPDULength_ [in] The number of bytes in the C-APDU. _RAPDU_ [out]
Pointer to the buffer that will contain the response APDU (R-APDU) returned by
the card in the additional card reader. You must allocate enough space to hold
the R-APDU sent by the card. _RAPDULength_ [out] The number of bytes returned
by the card in the additional card reader. _RETURN_ The GeneralResult code of
the PERFORM CARD APDU proactive command.
* * *
_CatPerformCardAPDU_ issues the proactive command PERFORM CARD APDU that sends
application program data units (APDU) to the supplementary card reader. The
terminal response is parsed and if successful the _RAPDU_ and _RAPDULength_
parameters are updated.
### 5.6.4 CatGetReaderStatus
**CatGeneralResult\ CatGetReaderStatus (CatDevice** _DeviceID_ ,
**CatReaderStatusOptions** _Options_ ,\ **BYTE ***_Status_**)** ;
* * *
_DeviceID_ [in] Device to detect status of. An acceptable value for this
parameter is a card reader device selected from CatDevice. _Options_ [in]
Selects what type of status information to return. An acceptable value for
this parameter is selected from CatGetReaderStatusOptions. _Status_ [out]
Status of additional card reader. _RETURN_ The GeneralResult code of the GET
READER STATUS proactive command.
* * *
_CatGetReaderStatus_ issues the proactive command GET READER STATUS that
retrieves the status of the additional card readers on the ME. The terminal
response is parsed and if successful the _Status_ parameter is updated.
## 5.7 UICC File Store Access
The abstract type FID is used to denote the file and a set of pre-processor
macros are defined that enumerate all of the standard files of a NAA file
store. A FID could be implemented as an unsigned 16-bit number as follows:
\- typedef unsigned short FID;
\- #define FID_MF 0x3F00
The starting file-context of a Toolkit application is the MF. When a Toolkit
application exits, the file-context is lost.
The Access Control privileges of the application are granted during
installation according to the level of trust. When an application requests
access to UICC or operator specific files, the Toolkit Framework checks if
this access is allowed by examination of the file control information stored
on the card. If access is granted the Toolkit Framework will process the
access request, if access is not granted, an appropriate status word will be
returned.
Contents and coding of the file(s) containing access control information are
defined in 3GPP TS 31.101 [16].
All UICC functions return the status bytes according to 3GPP TS 31.101 [16],
where 90 00 represents success.
### 5.7.1 CatSelect
**UINT16\ CatSelect (CatFID** _FileIdentifier,_ **CatFileStatus
***_Status_**)** ;
* * *
_FileIdentifier_ [in] _The file to select._ _Status_ [out] _Useful information
about the directory or file if it is successfully selected._ _RETURN_ _The
returned 16-bit unsigned value is a concatenation of the SW response bytes
with SW1 as the high byte and SW2 as the low byte, so a successful execution
would return 0x9000._
* * *
_CatSelect_ selects the specified file as the current working file.
### 5.7.2 CatStatus
**UINT16\ CatStatus (CatFileStatus ***_Status_**)** ;
* * *
_NumBytes_ [out] The number of bytes written. _Status_ [out] The status of the
currently selected file. _RETURN_ _The returned 16-bit unsigned value is a
concatenation of the SW response bytes with SW1 as the high byte and SW2 as
the low byte, so a successful execution would return 0x9000._
* * *
_CatStatus_ returns the file status of the currently selected file as
specified in 3GPP TS 31.101 [16].
### 5.7.3 CatGetCHVStatus
**void\ CatGetCHVStatus (BYTE CHVStatus[4]);**
* * *
_CHVStatus_ [out] Updates the _CHVStatus_ array with the statusof CHV1, CHV2,
UNBLOCKCHV1, and UNBLOCKCHV2 with CHV1 at array element zero.
* * *
_CatGetCHVStatus_ returns the current CHV status values. The format of the
returned bytes is specified in 3GPP TS 31.101 [16].
### 5.7.4 CatReadBinary
**UINT16\ CatReadBinary (DWORD** _Offset_ ,\ **DWORD ***_NumBytes,\_**void
***_Buffer_**)** ;
* * *
_Offset_ [in] _The offset into the file._ _NumBytes_ [in/out] The number of
bytes to be read on input and the actual number read on output _Buffer_ [out]
The buffer into which the data is written. _RETURN_ _The returned 16-bit
unsigned value is a concatenation of the SW response bytes with SW1 as the
high byte and SW2 as the low byte, so a successful execution would return
0x9000._
* * *
_CatReadBinary_ reads _NumBytes_ from position _Offset_ in the currently
selected file into _Buffer_.
### 5.7.5 CatUpdateBinary
**UINT16\ CatUpdateBinary (DWORD** _Offset_ ,\ **DWORD** _NumBytes,\_**const
void ***_Buffer_**)** ;
* * *
_Offset_ [in] _The offset into the file._ _NumBytes_ [in] The number of bytes
to write. _Buffer_ [in] _The buffer containing the data to write to the file._
_RETURN_ _The returned 16-bit unsigned value is a concatenation of the SW
response bytes with SW1 as the high byte and SW2 as the low byte, so a
successful execution would return 0x9000._
* * *
_CatUpdateBinary_ writes _NumBytes_ contained in _Buffer_ to position _Offset_
in the currently selected file.
### 5.7.6 CatReadRecord
**UINT16\ CatReadRecord (DWORD** _RecordNumber_ ,\ **CatRecordAccessMode**
_Mode_ ,\ **DWORD Offset, DWORD ***_NumBytes_ ,\ **void ***_Buffer_**)** ;
* * *
_RecordNumber_ [in] _The record number from which to read when Mode is
ABSOLUTE or 0 otherwise._ _Mode_ [in] Indication of which record is to be
read; viz. NEXT, PREVIOUS, CURRENT or ABSOLUTE. _Offset_ [in] The offset into
the record. _NumBytes_ [in/out] The number of bytes to be read from the record
on input and the number of bytes actually read on output _Buffer_ [out] _The
buffer into which the data is read._ _RETURN_ _The returned 16-bit unsigned
value is a concatenation of the SW response bytes with SW1 as the high byte
and SW2 as the low byte, so a successful execution would return 0x9000._
* * *
_CatReadRecord_ reads _NumBytes_ from the record _RecordNumber_ of the
currently selected file into _Buffer_.
### 5.7.7 CatUpdateRecord
**UINT16\ CatUpdateRecord (DWORD** _RecordNumber_ ,\ **CatRecordAccessMode**
_Mode_ ,\ **DWORD Offset, DWORD** _NumBytes_ ,\ **const void ***_Buffer_**)**
;
* * *
_RecordNumber_ [in] _The record number to which to write when Mode is ABSOLUTE
or 0 otherwise_ _Mode_ [in] Indication of which record is to be read; viz.
NEXT, PREVIOUS, CURRENT or ABSOLUTE. _Offset_ [in] The offset into the record.
_NumBytes_ [in] The number of bytes to write into the record. _Buffer_ [out]
_The buffer containing the data to write to the record._ _RETURN_ _The
returned 16-bit unsigned value is a concatenation of the SW response bytes
with SW1 as the high byte and SW2 as the low byte, so a successful execution
would return 0x9000._
* * *
_CatUpdateRecord_ writes _NumBytes_ into the record _RecordNumber_ of the
currently selected file from _Buffer_.
### 5.7.8 CatSearch
**UINT16\ CatSearch (CatSearchModes** _Mode_ ,\ **DWORD Offset, DWORD**
_PatternLength_ ,_\ *__const void *_ **Pattern** _)_ *;
* * *
_Mode_ [in] _Defines the seek method, One of\ SEEK_FROM_BEGINNING_FORWARD,\
SEEK_FROM_END_BACKWARD,\ SEEK_FROM_NEXT_FORWARD,\ SEEK_FROM_PREVIOUS_BACKWARD_
_Offset_ [in] _The offset into the record at which to being pattern matching._
_PatternLength_ [in] The size in bytes of the pattern to search for.
_Pattern_ [in] _The buffer containing the pattern to search for._
_RETURN_ _The returned 16-bit unsigned value is a concatenation of the SW
response bytes with SW1 as the high byte and SW2 as the low byte, so a
successful execution would return 0x9000._
* * *
_CatSearch_ searches records in the currently selected file starting at Offset
for the pattern of length _PatternLength_ contained in _Pattern_. If the
pattern is found the current record is set appropriately.
### 5.7.9 CatIncrease
**UINT16\ CatIncrease(DWORD** _Increment_ ,\ **DWORD _*_**_Value_**)** ;
* * *
_Increment_ [in] _The value to increase by._ _Value_ [out] _The new value._
_RETURN_ _The returned 16-bit unsigned value is a concatenation of the SW
response bytes with SW1 as the high byte and SW2 as the low byte, so a
successful execution would return 0x9000._
* * *
_CatIncrease_ adds _Increment_ to the current record of the selected cylic
file and returns the new _Value._ The most significant byte of _Increment_ is
ignored.
### 5.7.10 CatInvalidate
**UINT16\ CatInvalidate (void);**
* * *
_RETURN_ _The returned 16-bit unsigned value is a concatenation of the SW
response bytes with SW1 as the high byte and SW2 as the low byte, so a
successful execution would return 0x9000._
* * *
_CatInvalidate_ invalidates the selected file.
### 5.7.11 CatRehabilitate
**UINT16\ CatRehabilitate (void) ;**
* * *
_RETURN_ _The returned 16-bit unsigned value is a concatenation of the SW
response bytes with SW1 as the high byte and SW2 as the low byte, so a
successful execution would return 0x9000._
* * *
_CatRehabilitate_ rehabilitates the selected file.
## 5.8 Miscellaneous
### 5.8.1 CatGetTerminalProfile
**void\ CatGetTerminalProfile (BYTE ***_ProfileOutLength,_ **BYTE
***_Profile_**)** ;
* * *
_ProfileOutLength_ [out] The number of bytes written to Profile. _Profile_
[out] The address at which the terminal profile is written.
* * *
_CatGetTerminalProfile_ returns the stored terminal profile in _Profile_.
### 5.8.2 CatMoreTime
**CatGeneralResult\ CatMoreTime (void);**
* * *
_RETURN_ _The GeneralResult code of the MORE TIME proactive command._
* * *
_CatMoreTime_ issues the proactive command MORE TIME to the ME that it needs
more time to process an application.
### 5.8.3 CatPollingOff
**CatGeneralResult\ CatPollingOff (void);**
* * *
_RETURN_ _The GeneralResult code of the POLLING OFF proactive command._
* * *
_CatPollingOff_ issues the proactive command POLLING OFF that disables
proactive polling; this essentially turns off _CatPollInterval_.
### 5.8.4 CatPollInterval
**CatGeneralResult\ CatPollInterval (CatTimeUnit** _Unit_ , **BYTE**
_Interval_ ,\ **CatTimeInterval ***_ActualIntervalOut_**)** ;
* * *
_Unit_ [in] Desired time interval. Acceptable values for this parameter are
listed in . _Interval_ [in] Interval in _unit_ s. _ActualIntervalOut_ [out]
Response from ME negotiating the interval. This may or may not be the same as
_Unit_ and _Interval_. The value returned is in a structure of type
CatTimeInterval. _RETURN_ _The GeneralResult code of the POLL INTERVAL
proactive command._
* * *
_CatPollInterval_ issues the proactive command POLL INTERVAL that requests the
ME to set a time interval between status application program data units (APDU)
that the ME sends to the UICC. The ME responds with a time interval of its own
that most closely matches the application programming interface (API) request.
Polling can be disabled by using _CatPollingOff_.
### 5.8.5 CatRefresh
**CatGeneralResult\ CatRefresh (CatRefreshOptions** _Options_);
**CatGeneralResult\ CatRefreshWithFileList (CatRefreshOptions** _Options_ ,\
**BYTE** _FileListLength_ ,\ **const void ***_FileList_**)** ;
* * *
_Options_ [in] Informs the ME of what needs refreshing. Acceptable values for
this parameter are listed in CatRefreshOptions. _FileListLength_ [in] The
length, _in bytes_ , of _FileList_. _FileList_ [in] The file identifiers of
the files that have changed. _RETURN_ _The GeneralResult code of the REFRESH
proactive command._
* * *
_CatRefresh_ issues the proactive command REFRESH that informs ME that the NAA
has changed configuration due to UICC activity (such as an application
running).
### 5.8.6 CatLanguageNotification
**void\ CatLanguageNotification (CatLanguageNotificationOptions** _Options_ ,\
**const void ***_Language_**)** ;
* * *
_Options_ [in] Language options. An acceptable value for this parameter is a
card reader device selected from CatLanguageNotificationOptions. _Language_
[in] _The 2-character language code as defined by ISO 639 [5], encoded using
SMS default 7-bit coded alphabet as defined by TS 23.038 [6]._ _RETURN_ _The
GeneralResult code of the LANGUAGE NOTIFICATION proactive command._
* * *
_CatLanguageNotification_ issues the proactive command LANGUAGE NOTIFICATION
that notifies the ME about the language currently used for any text string
within proactive commands or envelope command responses.
### 5.8.7 CatLaunchBrowser
**CatGeneralResult\ CatLaunchBrowser (CatLaunchBrowserOptions** _Options_ ,\
**BYTE** _TitleLength_ , **const void ***_Title_ ,\ **BYTE** _URLLength_ ,
**const void ***_URL,\ *__const CatIconIdentifier *_ **IconIdentifier** _)_ *;
* * *
_Options_ [in] Options used to launch the browser. Acceptable values for this
parameter are listed in CatLaunchBrowserOptions. _TitleLength_ [in] The length
in bytes of the string _Title_ _Title_ [in] String to display on the ME during
the user confirmation phase. _URLLength_ [in] The length in bytes of _URL_.
_URL_ [in] The URL to open the browser at. _IconIdentifier_ [in] Optional icon
identifier; see CatIconIdentifier for member details. If IconIdentifier is
NULL or if IconIdentifier.UseIcon is zero, no icon identifier is sent to the
ME. _RETURN_ _The GeneralResult code of the LAUNCH BROWSER proactive command._
* * *
_CatLaunchBrowser_ and _CatLaunchBrowserEx_ issue the proactive command LAUNCH
BROWSER that launches a browser on the ME.
**CatGeneralResult\ CatLaunchBrowserEx (const CatLaunchBrowserExParams
*_params_);**
The structure _CatLaunchBrowserExParams_ has the following members:
typedef struct\ {\ // Mandatory fields\ CatLaunchBrowserOptions Options,\ BYTE
URLLength;\ const void *URL;
// Optional fields\ BYTE BrowserIdentityLength;\ const void *BrowserIdentity;\
BYTE BearerLength;\ const BYTE *Bearer;\ BYTE NumProvisioningFileReferences;\
BYTE *ProvisioningFileReferenceLengths;\ const BYTE
**ProvisioningFileReferences;\ BYTE GatewayProxyIdLength;\ const void *
GatewayProxyId;\ CatAlphaString Title;\ CatIconIdentifier IconIdentifier;\ }
CatLaunchBrowerExParams;
with the following members:
* * *
_URLLength_ [in] The length in bytes of _URL_. _URL_ [in] The URL to open the
browser at. _BrowserIdentityLength_ [in] Length in bytes of _BrowserIdentity_.
_BrowserIdentity_ [in] _The browser identity. If BrowserIdentity is NULL, no
BROWSER IDENTITY TLV is sent to the ME._ _BearerLength_ [in] Length in bytes
of _Bearer_. _Bearer_ [in] The list of bearers in order of priority requested.
The type CatBearer defines the values acceptable. If _Bearer_ is NULL, no
BEARER TLV is sent to the ME. _NumProvisioningFileReferences_ [in] The number
of Provisioning File References. _ProvisioningFileReferenceLengths_ [in] A
pointer to the array of Provisioning File References lengths.
_ProvisioningFileReferences_ [in] A pointer to the array of Provisioning File
References. _GatewayProxyIdLength_ [in] Length in bytes of _GatewayProxyId_.
_GatewayProxyId_ [in] The gateway or proxy identity. If _GatewayProxyId_ is
NULL, no TEXT STRING TLV describing the gateway/proxy is sent to the ME.
_Title_ [in] String to display on the ME; see CatAlphaString. _IconIdentifier_
[in] Optional icon identifier; see CatIconIdentifier for member details. If
_IconIdentifier_._UseIcon_ is zero, no icon identifier is sent to the ME.
* * *
## 5.9 Low-level Interface
This subclause presents a low-level programming interface that allows you to:
\- Construct proactive commands and send them to the ME.
\- Access the terminal response from the ME.
\- Search the terminal response and contents of envelopes for specified TLVs.
\- Unpack the contents of envelopes from the ME and send responses.
These functions are provided so that functionality that is not provided in the
high level API is still accessible. All of these functions work on a single
data buffer that has a single data pointer and can only be accessed
sequentially. The high-level proactive functions may make use of the data
buffer so consequently the high-level proactive functions should not be used
whilst using the low-level functions.
### 5.9.1 CatResetBuffer
**void\ CatResetBuffer(void);**
This function resets the data pointer to the beginning of the buffer.
### 5.9.2 CatStartProactiveCommand
**void\ CatStartProactiveCommand(BYTE** _Command_ ,\ **BYTE** _Options_ ,\
**BYTE** _To_**)** ;
* * *
_Command_ [in] Command byte of proactive command. _Options_ [in] Command
options of proactive command. _To_ [in] The destination device identity.
* * *
_CatStartProactiveCommand_ resets the data pointer and starts the construction
of a proactive command by writing the command tag, command details and device
identities to the data buffer. The data pointer is left pointing after the
device identities so that proactive command specific data can be written.
### 5.9.3 CatSendProactiveCommand
**CatGeneralResult\ CatSendProactiveCommand (BYTE ***_Length_**)** ;
* * *
_Length_ [out] Pointer that is updated with the length of the terminal
response _RETURN_ The general result byte of the terminal response
* * *
_CatSendProactiveCommand_ sends the contents of the data buffer as a proactive
command and updates the data buffer with the terminal response. The general
result byte of the terminal response is returned by this function. The length
of the terminal response is written to *Length. The data pointer is set to
point to the additional information of the terminal response.
### 5.9.4 CatOpenEnvelope
**CatEnvelopeTagType\ CatOpenEnvelope(BYTE ***_Length_**)** ;
* * *
_Length_ [out] Pointer that is updated with the length of the envelope
_RETURN_ The envelope tag
* * *
_CatOpenEnvelope_ returns the envelope tag of the data buffer and the length
of the envelope data. The data pointer is set to point to the envelope data.
### 5.9.5 CatSendEnvelopeResponse
**void\ CatSendEnvelopeResponse (void);**
_CatSendEnvelopeResponse_ sends the contents of the data buffer as a
successful envelope response.
### 5.9.6 CatSendEnvelopeErrorResponse
**void\ CatSendEnvelopeErrorResponse (void);**
This function sends the contents of the data buffer as an unsuccessful
envelope response.
### 5.9.7 CatPutData
**void\ CatPutData(BYTE** _Length_ ,\ **const void ***_Data_**)** ;
* * *
_Length_ [in] Length of Data _Data_ [in] Pointer to Data
* * *
_CatPutData_ appends Length bytes of data to the data buffer.
### 5.9.8 CatPutByte
**void\ CatPutByte (BYTE** _Data_**)** ;
* * *
_Data_ _[in]_ Data byte.
* * *
_CatPutByte_ appends the supplied data byte to the data buffer.
### 5.9.9 CatPutTLV
**void\ CatPutTLV (BYTE** _Tag_ ,\ **BYTE** _Length_ ,\ **const void
***_Value_**)** ;
* * *
_Tag_ [in] _Tag byte._ _Length_ [in] Length of value. _Value_ [in] A pointer
to the value.
* * *
_CatPutTLV_ appends a general TLV to the data buffer.
### 5.9.10 CatPutBytePrefixedTLV
**void\ CatPutBytePrefixedTLV (BYTE** _Tag_ ,\ **BYTE** _Prefix_ ,\ **BYTE**
_Length_ ,\ **const void ***_Value_**)** ;
* * *
_Tag_ [in] Tag byte. _Prefix_ [in] Prefix byte. _Length_ [in] Length of value.
_Value_ [in] A pointer to the value.
* * *
_CatPutBytePrefixedTLV_ appends a TLV to the data buffer with a single byte
placed before the Value.
### 5.9.11 CatPutOneByteTLV
**void\ CatPutOneByteTLV (BYTE** _Tag_ ,\ **BYTE** _Value_**)** ;
* * *
_Tag_ [in] _Tag byte._ _Value_ [in] Value byte.
* * *
_CatPutOneByteTLV_ appends a single byte valued TLV to the data buffer.
### 5.9.12 CatPutTwoByteTLV
**void\ CatPutTwoByteTLV (BYTE** _Tag_ ,\ **BYTE** _Value1_ ,\ **BYTE**
_Value2_**)** ;
* * *
_Tag_ [in] Tag byte. _Value1_ [in] First Value byte. _Value2_ [in] Second
Value byte.
* * *
_CatPutTwoByteTLV_ appends a two byte valued TLV to the data buffer.
### 5.9.13 CatGetByte
**BYTE\ CatGetByte (void);**
* * *
_RETURN_ Data byte.
* * *
_CatGetByte_ returns the byte at the current data pointer and increments the
data pointer by one.
### 5.9.14 CatGetData
**const void *\ CatGetData (BYTE** _Length_**)** ;
* * *
_Length_ [in] Length of Data _RETURN_ Pointer to Data.
* * *
_CatGetData_ returns the current data pointer and increments the data pointer
by _Length_ bytes.
### 5.9.15 CatFindNthTLV
**const void *\ CatFindNthTLV (BYTE** _Tag_ ,\ **BYTE** _Occurrence_ ,\ **BYTE
***_Length_**)** ;
* * *
_Tag_ [in] Tag to find. _Occurrence_ [in] Occurrence of Tag to find with \"1\"
being the first. _Length_ [out] Length of found TLV. _RETURN_ Pointer to data
of found TLV
* * *
_CatFindNthTLV_ finds the nth TLV that matches Tag in the data buffer, where
nth is specified by the _Occurrence_ parameter. If a match is found the data
pointer is updated to the found TLV, the function returns a pointer to the
found value and updates _Length_ with the data length. If no match was found
the function returns the null pointer and the data pointer is left unchanged.
### 5.9.16 CatFindNthTLVInUserBuffer
**const void *\ CatFindNthTLVInUserBuffer (BYTE** BufferLen**,\ const void ***
Buffer**,\ BYTE** _Tag_**,\ BYTE** _Occurrence_**,\ BYTE ***_Length_**);**
* * *
_BufferLen_ [in] Length of buffer _Buffer_ [in] Buffer to search _Tag_ [in]
Tag to find. _Occurrence_ [in] Occurrence of Tag to find with \"1\" being the
first. _Length_ [out] Length of found TLV. _RETURN_ Pointer to data of found
TLV
* * *
_CatFindNthTLVInUserBuffer_ finds the nth TLV that matches _Tag_ is the
supplied buffer. The function returns a pointer to the found value and updates
_Length_ with the data length. If no match was found the function returns the
null pointer.
## 5.10 Network Services
### 5.10.1 CatGetLocationInformation
**CatGeneralResult\ CatGetLocationInformation (CatLocationInformation
***_LocationInformation_**);**
* * *
_LocationInformation_ [out] A pointer to where the location information from
the ME is placed. Refer to the CatLocalInformation section for member details.
_RETURN_ The GeneralResult code of the PROVIDE LOCAL INFORMATION proactive
command. The GeneralResult code of the DISPLAY TEXT proactive command.
* * *
_CatProvideLocationInformation_ requests the ME to send location information
to the (U)SIM using the PROVIDE LOCAL INFORMATION proactive command.
### 5.10.2 CatGetTimingAdvance
**CatGeneralResult\ CatGetTimingAdvance (CatTimingAdvance
***_TimingAdvance_**);**
* * *
_TimingAdvance_ [out] A pointer to where the timing advance information from
the ME is placed. Refer to the CatTimingAdvance section for member details.
_RETURN_ The GeneralResult code of the PROVIDE LOCAL INFORMATION proactive
command.
* * *
_CatProvideTimingAdvance_ requests the ME to send timing advance information
to the (U)SIM using the PROVIDE LOCAL INFORMATION proactive command.
### 5.10.3 CatGetIMEI
**CatGeneralResult\ CatGetIMEI (BYTE** _IMEI_**[8]);**
* * *
_IMEI_ [out] A pointer to where the IMEI of the ME is placed. _RETURN_ The
GeneralResult code of the PROVIDE LOCAL INFORMATION proactive command.
* * *
_CatGetIMEI_ requests the ME to send the IMEI to the (U)SIM using the PROVIDE
LOCAL INFORMATION proactive command.
### 5.10.4 CatGetNetworkMeasurementResults
**CatGeneralResult\ CatGetNetworkMeasurementResults (BYTE**
_MeasurementResults_**[10]);**
* * *
_MeasurementResults_ [out] A pointer to where the network measurement results
from the ME is placed. _RETURN_ The GeneralResult code of the PROVIDE LOCAL
INFORMATION proactive command.
* * *
_CatGetNetworkMeasurementResults_ requests the ME to send the network
measurement results to the (U)SIM using the PROVIDE LOCAL INFORMATION
proactive command.
### 5.10.5 CatGetDateTimeAndTimeZone
**CatGeneralResult\ CatGetDateTimeAndTimeZone (BYTE**
_DateTimeAndTimeZone_**[7]);**
* * *
_DateTimeAndTimeZone_ [out] A pointer to where the date, time, and time zone
from the ME is placed. _RETURN_ The GeneralResult code of the PROVIDE LOCAL
INFORMATION proactive command.
* * *
_CatGetDateTimeAndTimeZones_ requests the ME to send the date, time, and time
zone information to the (U)SIM using the PROVIDE LOCAL INFORMATION proactive
command.
### 5.10.6 CatGetLanguage
**CatGeneralResult\ CatGetLanguage (BYTE** _Language_**[2]);**
* * *
_DateTimeAndTimeZone_ [out] A pointer to where the language from the ME is
placed. _RETURN_ The GeneralResult code of the PROVIDE LOCAL INFORMATION
proactive command.
* * *
_CatGetLanguage_ requests the ME to send the language information to the
(U)SIM using the PROVIDE LOCAL INFORMATION proactive command.
### 5.10.7 CatSetupCall
**CatGeneralResult\ CatSetupCall (BYTE** _CallSetupMessageLength_**, const
void ***_CallSetupMessage_**,\ CatTypeOfNumberAndNumberingPlanIdentifier**
_TONandNPI_**,\ BYTE** _DiallingNumberLength_**, const void
***_DiallingNumber_**,\ CatSetupCallOptions** _Options,\ *__const
CatIconIdentifier *_ **UserConfirmationIconIdentifier** _,\ BYTE_ __
CallSetupMessageLength** _, const void *_** CallSetupMessage** _,\ const
CatIconIdentifier *_** CallSeupIconIdentifier***);**
* * *
_UserConfirmationMessageLength_ [in] Length in bytes of
_UserConfirmationMessage_. _UserConfirmationMessage_ [in] Message to display
for user confirmation or NULL. _TONandNPI_ [in] Acceptable values for this
parameter are listed in CatTypeOfNumberAndNumberingPlanIdentifier.
_DiallingNumberLength_ [in] Length in bytes of _DiallingNumber_.
_DialingNumber_ [in] Number to call is coded as binary-coded decimal.
_Options_ [in] Acceptable values for this parameter are listed in
CatSetupCallOptions. _UserConfirmationIconIdentifier_ [in] Optional icon
identifier to use during the user confirmation phase; see CatIconIdentifier
for member details. If UserConfirmationIconIdentifier is NULL or if
UserConfirmationIconIdentifier.UseIcon is zero, no user confirmation phase
icon identifier is sent to the ME. _CallSetupMessageLength_ [in] Length in
bytes of _CallSetupMessage_. _CallSetupMessage_ [in] Message to display for
call set up or NULL. _CallSetupIconIdentifier_ [in] Optional icon identifier
to use during the call setup phase; see CatIconIdentifier for member details.
If CallSetupIconIdentifier is NULL or if CallSetupIconIdentifier.UseIcon is
zero, no call setup phase icon identifier is sent to the ME. _RETURN_ The
GeneralResult code of the SET UP CALL proactive command.
* * *
_CatSetupCall_ and _CatSetupCallEx_ issue the SET UP CALL proactive command to
the ME.
**CatGeneralResult\ CatSetupCallEx (const CatSetupCallExParams
***_Params_**);**
The type _CatSetupCallExParams_ is defined as follows:
typedef struct\ {\ // Mandatory fields\ CatSetupCallOptions Options;\
CatTypeOfNumberAndNumberingPlanIdentifier TONandNPI;\ BYTE
DiallingNumberLength;\ const void *DialingNumber;
// Optional fields\ CatAlphaString UserConfirmationMessage;\ BYTE
CapabilityConfigParamsLength;\ const void *CapabilityConfigParams;\ BYTE
CalledPartySubaddressLength;\ const void *CalledPartySubaddress;\
CatTimeInterval RedialMaximumDuration;\ CatIconOption UserConfirmationIcon;\
CatAlphaString CallSetupMessage;\ CatIconOptions CallSetupIcon;\ }
CatSetupCallExParams;
With the following members:
* * *
_Options_ Acceptable values for this parameter are listed in
CatSetupCallOptions. _TONandNPI_ Acceptable values for this parameter are
listed in CatTypeOfNumberAndNumberingPlanIdentifier. _DiallingNumberLength_
Length in bytes of _DiallingNumber_. _DialingNumber_ Number to call is coded
as binary-coded decimal. _UserConfirmationMessage_ String to display during
the user confirmation phase; see CatAlphaString. If this parameter is null, no
user confirmation message TLV is passed to the ME.
_CapabilityConfigParamsLength_ Length in bytes of CapabilityConfigParams.
_CapabilityConfigParams_ A pointer to the capability configuration parameters
as coded for EF~CCP~. _CalledPartySubaddressLength_ Length in bytes of
CalledPartySuba _ddress_. _CalledPartySubaddress_ The called party subaddress.
_RedialMaximumDuration_ An optional maximum duration for the redial mechanism.
If the timeInterval member of this structure is zero, no duration TLV is sent
to the ME. _UserConfirmationIcon_ _The icon to display during the user
confirmation phase. If the UseIcon member of this structure is zero, no user
confirmation icon TLV is sent to the ME._ _CallSetupMessage_ String to display
during the call set up phase; see CatAlphaString. _CallSetupIcon_ The icon to
display during the call setup phase.
* * *
Optional parameters are specifically chosen to use an all-zero binary
representation. This means that it is simple to set up only the required
members of the _SetupCallExParams_ structure by zeroing the whole structure
using _memset_ , filling in the required members, and sending the result to
_CatSetupCallEx_. As all optional parameters use a zero binary representation,
the _memset_ serves to _initialise_ them all to the \"not present\" status.
### 5.10.8 CatSendShortMessage
**CatGeneralResult\ CatSendShortMessage (BYTE** _TitleLength_**, const void
***_Title_**,\ CatTypeOfNumberAndNumberingPlanIdentifier** _TONandNPI_**,\
BYTE** _AddressLength_**, const void ***_Address_**,\ BYTE**
_SmsTPDULength_**, const void ***_SmsTPDU_**,\ CatSendShortMessageOptions**
_Options_**,\ const CatIconIdentifier ***_IconIdentifier_ **);\ **
* * *
_TitleLength_ [in] Length in bytes of _Title_. _Title_ [in] String to display
while ME is sending a message. _TONandNPI_ [in] Acceptable values for this
parameter are listed in . _AddressLength_ [in] Length in bytes of _Address_.
_Address_ [in] Address of the service center where message is being sent.
_SmsTPDULength_ [in] Length in bytes of _SmsTPDU_. _SmTPDU_ [in] Formatted
short message service (SMS) message to send. _Options_ [in] Specifies who
packs the message. Acceptable values for this parameter are listed in
CatSendShortMessageOptions. _IconIdentifier_ [in] Optional icon identifier;
see CatIconIdentifier for member details. If IconIdentifier is NULL or if
IconIdentifier.UseIcon is zero, no icon identifier is sent to the ME. _RETURN_
The GeneralResult code of the SEND SHORT MESSAGE proactive command.
* * *
_CatSendShortMessage_ issues the SEND SHORT MESSAGE proactive command.
### 5.10.9 CatSendSS
**CatGeneralResult\ CatSendSS (BYTE** _TitleLength_**, const void
***_Title_**,\ CatTypeOfNumberAndNumberingPlanIdentifier** _TONandNPI_**,\
BYTE** _SSStringLength_**, const void ***_SSString_**,\ const
CatIconIdentifier ***_IconIdentifier_**);**
* * *
_TitleLength_ [in] Length in bytes of _Title_. _Title_ [in] String to display
while ME is sending a message. _TONandNPI_ [in] Acceptable values for this
parameter are listed . _SSStringLength_ [in] Length in bytes of _SSString_.
_SSString_ [in] SS string to ME. _IconIdentifier_ [in] Optional icon
identifier; see CatIconIdentifier for member details. If IconIdentifier is
NULL or if IconIdentifier.UseIcon is zero, no icon identifier is sent to the
ME. _RETURN_ The GeneralResult code of the SEND SS proactive command.
* * *
_CatSendSS_ issues the SEND SS proactive command to the ME.
### 5.10.10 CatSendUSSD
**CatGeneralResult\ CatSendUSSD (BYTE** _TitleLength_**, const void
***_Title_**,\ CatDCSValue** _MessageDCS_**, BYTE** _MessageLength_**, const
void ***_Message_**,\ CatDCSValue ***_MsgOutDCS_**, BYTE ***_MsgOutLength_**,
void ***_MsgOut_**,\ const CatIconIdentifier ***_IconIdentifier_**);**
* * *
_TitleLength_ [in] The length in bytes of _Title_. Title [in] String to
display while ME is sending a message. _MessageDCS_ [in] The data-coding
scheme for _Message_. Acceptable values for this parameter are listed in .
_MessageLength_ [in] The length in bytes of _Message_. _Message_ [in] Message
to send. _MsgOutDCS_ [out] _Identifies type of DCS for the returned message._
_MsgOutLength_ [out] Length of the returned message in bytes. _MsgOut_ [out]
Returned string or message. _IconIdentifier_ [in] Optional icon identifier;
see CatIconIdentifier for member details. If IconIdentifier is NULL or if
IconIdentifier.UseIcon is zero, no icon identifier is sent to the ME. _RETURN_
The GeneralResult code of the SEND USSD proactive command.
* * *
_CatSendUSSD_ issues the SEND USSD proactive command. The terminal response is
parsed and if successful the MsgOutDCS, MsgOutLength and MsgOut parameters are
updated.
### 5.10.11 CatOpenCSChannel
**CatGeneralResult\ CatOpenCSChannel(CatOpenChannelOptions** _Options_**,\
BYTE** _UserConfirmationLength_**, const void ***_UserConfirmation_**,\
const** CatIconIdentifier *****_UserConfimationIconIdentifier_**,\
CatTypeOfNumberAndNumberingPlanIdentifier** _TONandNPI_**,\ BYTE**
_DiallingNumberLength_**, const void ***_DiallingNumber_**,\ BYTE**
_BearerDescription[3]_**,\ UINT16 ***_BufferSize_**,\ CatDevice
***_ChannelIdentifier_**);**
* * *
_Options_ [in] Acceptable values for this parameter are listed in
CatOpenChannelOptions. _UserConfirmationLength_ [in] Length in bytes of
_UserConfirmation_. _UserConfirmation_ [in] String to display when ME alerts
user that channel is to be opened. _UserConfirmationIconIdentifier_ [in]
Optional icon identifier to use during the user confirmation phase; see
CatIconIdentifier for member details. If UserConfirmationIconIdentifier is
NULL or if UserConfirmationIconIdentifier.UseIcon is zero, no user
confirmation phase icon identifier is sent to the ME. _TONandNPI_ [in]
Acceptable values for this parameter are listed in
CatTypeOfNumberAndNumberingPlanIdentifier. _DiallingNumberLength_ [in] Length
in bytes of _DiallingNumber_. _DialingNumber_ [in] Number to call is coded as
binary-coded decimal. _BearerDescription_ [in/out] Initially contains the
bearer description parameters (data rate, bearer service and connection
element) and is modified to the actual bearer description as allocated by the
ME. _BufferSize_ [in/out] Initially contains the desired buffer size and is
modified to the actual buffer size as allocated by the ME. _ChannelIdentifier_
[out] The channel identifier that has been allocated by the ME. _RETURN_ The
GeneralResult code of the OPEN CHANNEL proactive command.
* * *
**CatGeneralResult\ CatOpenCSChannelEx(const CatOpenCSChannelExParams
***_Params_ ,\ **CatDevice ***_ChannelIdentifier_ ,\ **BYTE**
_BearerDescription[3]_ ,\ **UINT16 ***_BufferSize_**)** ;
* * *
_Params_ [in] Constant parameter set as defined below. _ChannelIdentifier_
[out] The channel identifier that has been allocated by the ME.
_BearerDescription_ [out] An array to which the actual bearer description
allocated by the ME will be written. _BufferSize_ [out] The actual buffer size
allocated by the ME. _RETURN_ The GeneralResult code of the OPEN CHANNEL
proactive command.
* * *
_CatOpenCSChannel_ and _CatOpenCSChannelEx_ issue the proactive command OPEN
CHANNEL related to a CS bearer. The terminal response is parsed and if the
command was successful the _BearerDescription_ , _BufferSize_ and
_ChannelIdentifier_ parameters are updated.
The type _CatOpenCSChannelExParams_ is defined as follows:
typedef struct\ {\ // Mandatory fields\ CatOpenChannelOptions Options;\ BYTE
AddressLength;\ const BYTE *Address;\ BYTE BearerDescription[3];\ UINT16
BufferSize;
// Optional fields\ CatAlphaString UserConfirmationMessage;_\ *
CatIconIdentifier UserConfirmationIconIdentifier;\ BYTE SubAddressLength;_ \ *
const BYTE *SubAddress;\ BYTE Duration1Defined;\ CatTimeInterval Duration1;\
BYTE Duration2Defined;\ CatTimeInterval Duration2;\ CatAddressType
LocalAddress;\ CatTextString UserLogin;\ CatTextString UserPassword;\
CAT_MEInterfaceTransportLevelType CAT_MEInterfaceTransportLevel;\
CatAddressType DataDestinationAddress;\ } CatOpenCSChannelExParams;
With the following members:
* * *
_Options_ Acceptable values for this parameter are listed in
CatOpenChannelOptions. This field is mandatory. _AddressLength_ Length in
bytes of _Address_. This field is mandatory. _Address_ _The address to call.
This field is mandatory._ _BearerDescription_ _The desired bearer parameters
(data rate, bearer service and connection element). This field is mandatory._
_BufferSize_ The desired buffer size. This field is mandatory.
_UserConfirmationMessage_ String to display during the user confirmation
phase; see CatAlphaString. If this parameter is null, no user confirmation
message TLV is passed to the ME. If UserConfirmationMessage is not null but
UserConfirmationMessageLength is zero, a user confirmation message TLV is
passed to the ME with the length component set to zero.
_UserConfirmationIconIdentifier_ _The icon to display during the user
confirmation phase. If the UseIcon member of this structure is zero, no user
confirmation icon TLV is sent to the ME._ _SubAddressLength_ Length in bytes
of SubAddress. _SubAddress_ The subaddress to call. _Duration1Defined_ Set to
nonzero if Duration1 is defined. _Duration1_ _Duration of reconnect tries; see
CatTimeInterval._ _Duration2Defined_ _Set to nonzero if Duration2 is defined._
_Duration2_ _Duration of timeout; see CatTimeInterval._ _LocalAddress_ _The
LocalAddress; see CatAddressType._ _UserLogin_ _The user login string._
_UserPassword_ The user password string. _CAT_MEInterfaceTransportLevel_ See
CAT_MEInterfaceTransportLevelType. _DataDestinationAddress_ The
DataDestinationAddress; see CatAddressType.
* * *
### 5.10.12 CatOpenGPRSChannel
**CatGeneralResult\ CatOpenGPRSChannel(CatOpenChannelOptions** _Options_**,\
BYTE** _UserConfirmationLength_**, const void ***_UserConfirmation_**,\ const
CatIconIdentifier ***_UserConfirmationIconIdentifier_**,\ BYTE**
_BearerDescription[8]_**,\ UINT16 ***_BufferSize_**,\ CatDevice
***_ChannelIdentifier_**);**
* * *
_Options_ [in] Acceptable values for this parameter are listed in
CatOpenChannelOptions. _UserConfirmationLength_ [in] Length in bytes of
_UserConfirmation_. _UserConfirmation_ [in] String to display when ME alerts
user that channel is to be opened. _UserConfirmationIconIdentifier_ [in]
Optional icon identifier to use during the user confirmation phase; see
CatIconIdentifier for member details. If _UserConfirmationIconIdentifier_ is
NULL or if _UserConfirmationIconIdentifier_.UseIcon is zero, no user
confirmation phase icon identifier is sent to the ME. _BearerDescription_
[in/out] Initially contains the bearer description and is modified to the
actual bearer description as allocated by the ME. _BufferSize_ [in/out]
Initially contains the desired buffer size and is modified to the actual
buffer size as allocated by the ME. _ChannelIdentifier_ [out] The channel
identifier that has been allocated by the ME. _RETURN_ The GeneralResult code
of the OPEN CHANNEL proactive command.
* * *
**CatGeneralResult\ CatOpenGPRSChannelEx(const CatOpenGPRSChannelExParams
***_Params_**,\ CatDevice ***_ChannelIdentifier_**,\ BYTE**
_ActualBearerDescription[8]_ ,**\ UINT16 ***_ActualBufferSize_**);**
* * *
_Params_ [in] Constant parameter set as defined below. _ChannelIdentifier_
[out] The channel identifier that has been allocated by the ME.
_ActualBearerDescription_ [out] An array to which the actual bearer
description allocated by the ME will be written. _ActualBufferSize_ [out] The
actual buffer size allocated by the ME. _RETURN_ The GeneralResult code of the
OPEN CHANNEL proactive command.
* * *
_CatOpenGPRSChannel_ and _CatOpenGPRSChannelEx_ issue the proactive command
OPEN CHANNEL related to a GPRS bearer. The terminal response is parsed and if
the command was successful the _BearerDescription_ , _BufferSize_ and
_ChannelIdentifier_ parameters are updated.
The type _CatOpenGPRSChannelExParams_ is defined as follows:
typedef struct\ {\ // Mandatory fields\ GsmOpenChannelOptions Options;\ BYTE
AddressLength;\ const BYTE *Address;\ BYTE BearerDescription[8];\ UINT16
BufferSize;
// Optional fields\ CatAlphaString UserConfirmationMessage;\ CatIconIdentifier
UserConfirmationIconIdentifier;\ BYTE AccessPointNameLength;\ const BYTE
*AccessPointName;\ CatAddressType LocalAddress;\
CAT_ME_InterfaceTransportLevelType CAT_ME_InterfaceTransportLevel;\
CatAddressType DataDestinationAddress;\ } GsmOpenGPRSChannelExParams;
With the following members:
* * *
_Options_ Acceptable values for this parameter are listed in
CatOpenChannelOptions. This field is mandatory. _AddressLength_ Length in
bytes of _Address_. This field is mandatory. _Address_ _The address to call.
This field is mandatory._ _BearerDescription_ _The desired bearer. This field
is mandatory._ _BufferSize_ The desired buffer size. This field is mandatory.
_UserConfirmationMessage_ String to display during the user confirmation
phase; see CatAlphaString. If this parameter is null, no user confirmation
message TLV is passed to the ME. If UserConfirmationMessage is not null but
UserConfirmationMessageLength is zero, a user confirmation message TLV is
passed to the ME with the length component set to zero.
_UserConfirmationIconIdentifier_ The icon to display during the user
confirmation phase. If the UseIcon member of this structure is zero, no user
confirmation icon TLV is sent to the ME. _AccessPointNameLength_ The length in
bytes of AccessPoint. _AccessPointName_ The Access Point Name. _LocalAddress_
See CatAddressType. _CAT_ME_InterfaceTransportLevel_ See
CAT_MEInterfaceTransportLevelType. _DataDestinationAddress_ See
CatAddressType.
* * *
### 5.10.13 CatCloseChannel
**CatGeneralResult\ CatCloseChannel (CatDevice** _ChannelIdentifier_ ,\
**BYTE** _TitleLength_**, const void ***_Title_ _,_**_*\ const
CatIconIdentifier *_** IconIdentifier***);**
* * *
_ChannelIdentifier_ [in] The channel identifier as returned from one of the
open commands _TitleLength_ [in] The length in bytes of _Title_. _Title_ [in]
String to display while ME is closing the channel. _IconIdentifier_ [in]
Optional icon identifier; see CatIconIdentifier for member details. If
_IconIdentifier_ is NULL or if _IconIdentifier_.UseIcon is zero, no icon
identifier is sent to the ME. _RETURN_ The GeneralResult code of the CLOSE
CHANNEL proactive command.
* * *
_CatCloseChannel_ issues a CLOSE CHANNEL proactive command that closes an open
channel.
### 5.10.14 CatReceiveData
**CatGeneralResult\ CatReceiveData (CatDevice** _ChannelIdentifier_ ,\
**BYTE** _TitleLength_**, const void ***_Title_**,**_\_**BYTE**
_RequestedChannelDataLength_**,\ const CatIconIdentifier
***_IconIdentifier_**,\ **** BYTE * **_ChannelData_** ,**_\_** BYTE *
**_NumChannelBytesRead,\_** BYTE * **_NumChannelBytesLeft_**);**
* * *
_ChannelIdentifier_ [in] The channel identifier as returned from one of the
open commands _TitleLength_ [in] The length in bytes of _Title_. _Title_ [in]
String to display while ME is receiving data. _RequestedChannelDataLength_
[in] The number of bytes requested to be read. _IconIdentifier_ [in] Optional
icon identifier; see CatIconIdentifier for member details. If _IconIdentifier_
is NULL or if _IconIdentifier_.UseIcon is zero, no icon identifier is sent to
the ME. _ChannelData_ [out] Received channel data. _NumChannelBytesRead_ [out]
_The number of bytes received as channel data._ _NumChannelBytesLeft_ [out]
The number of bytes remaining to be read from the channel buffer, or 255 if
there are more than 255 bytes left to be read. _RETURN_ The GeneralResult code
of the RECEIVE DATA proactive command.
* * *
_CatReceiveData_ issues a RECEIVE DATA proactive command that receives data
from an open channel. The terminal response is parsed and if the command is
successful the received data is copied into the ChannelData array and the
NumChannelBytesRead and NumChannelBytesLeft parameters are updated.
### 5.10.15 CatSendData
**CatGeneralResult\ CatSendData (CatDevice** _ChannelIdentifier_ ,\
**CatSendDataOptions** _Options_**,\ **** BYTE**_TitleLength_** , const void *
**_Title_** ,\ BYTE**_ChannelDataLength,\_** const void * **_ChannelData_** ,\
const CatIconIdentifier * **_IconIdentifier_** ,\ BYTE *
**_ActualBytesSent_**);**
* * *
_ChannelIdentifier_ [in] The channel identifier as returned from one of the
open commands _TitleLength_ [in] The length in bytes of _Title_. _Title_ [in]
String to display while ME is receiving data. _Options_ [in] Specifies who
packs the message. Acceptable values for this parameter are listed in
CatSendDataOptions. _ChannelDataLength_ [in] The number of bytes to be sent
from _ChannelData_. _ChannelData_ [in] The data to be sent. _IconIdentifier_
[in] Optional icon identifier; see CatIconIdentifier for member details. If
_IconIdentifier_ is NULL or if _IconIdentifier_._UseIcon_ is zero, no icon
identifier is sent to the ME. _ActualBytesSent_ [out] The number of bytes sent
(derived from the CHANNEL DATA LENGTH TLV in the TERMINAL RESPONSE). _RETURN_
The GeneralResult code of the SEND DATA proactive command.
* * *
_CatSendData_ issues the proactive command SEND DATA that sends data to an
open channel.
### 5.10.16 CatGetChannelStatus
**CatGeneralResult\ CatGetChannelStatus (CatDevice** _ChannelIdentifier_ ,
**void ***_ChannelStatus_**);**
* * *
_ChannelIdentifier_ [in] The channel identifier. _ChannelStatus_ [out]
Returned channel status bytes. _RETURN_ The GeneralResult code of the GET
CHANNEL STATUS proactive command.
* * *
_CatGetChannelStatus_ issues a proactive command GET CHANNEL STATUS. The
terminal response is parsed if the command is successful to find the status of
the supplied channel.
### 5.10.17 CatServiceSearch
**CatGeneralResult\ CatServiceSearch (CatBearer** _BearerId,\_**BYTE**
_AttributeLength_**, void ***_Attributes,_**\ **** void *
**_ServiceAvailability_**);**
* * *
_BearerId_ [in] The identifier of the bearer whose services will be searched.
_AttributeLength_ [in] The length of the following attribute array.
_Attributes_ [in] Attributes that describe bearer services, typically in a
bearer specific format. _ServiceAvailability_ [in] List of services offered by
the bearer that satisfy the attributes, typically in a bearer specific format.
* * *
_CatServiceSearch_ searches for a particular service on a bearer.
### 5.10.18 CatGetServiceInformation
**CatGeneralResult\ CatGetServiceInformation (BYTE** _TitleLength_**, const
BYTE ***_Title_**,**_\ *__const catIconIdentifier *_ **IconIdentifier** _,\
**__CatBearer_ __ BearerId** _,_** \ **_BYTE *_** AttributeLength, void
*Attributes,\ **_void *_** ServiceInformation***);**
* * *
_TitleLength_ [in] The length in bytes of _Title_. _Title_ [in] String to
display acquiring service information. _IconIdentifier_ [in] Optional icon
identifier; see CatIconIdentifier for member details. If _IconIdentifier_ is
NULL or if _IconIdentifier_._UseIcon_ is zero, no icon identifier is sent to
the ME. _BearerId_ [in] The identifier of the bearer whose service information
is requested. _AttributeLength_ [in] _The number of bytes in the following
attribute array._ _Attributes_ [in] Attributes describing the service
information requested. _ServiceInformation_ [out] The requested information.
* * *
_CatGetServiceInformation_ retrieves information about a particular service on
a bearer.
### 5.10.19 CatDeclareService
**CatGeneralResult\ CatDeclareService (CatBearer** _BearerId_**, BYTE**
_ServiceId_**,**_\_**CatTransportProtocol** _TransportProtocol_**,\ **** WORD
* **_PortNumber_** ,**_\_** BYTE**_ServiceRecordLength,\_** void *
**_ServiceRecord_**);**
* * *
_BearerId_ [in] The identifier of the bearer for which this service is being
offered. _TransportProtocol_ [in] The transport protocol on which the service
is provided. _PortNumber_ [in] The port on which the service is provided.
_ServiceRecordLength_ [in] The number of bytes in the following service
record. _ServiceRecord_ [in] The service record describing the service.
* * *
_CatDeclareService_ describes a new service.
### 5.10.20 CatRunATCommand
**CatGeneralResult\ CatRunATCommand (BYTE** _TitleLength_**, const void
***_Title_**,\ BYTE** _CommandLength_**, const void ***_Command_**,\ const
CatIconIdentifier ***_IconIdentifier_**,\ void ***_Response_**, BYTE
***_ResponseLength_**);**
* * *
_TitleLength_ [in] Length in bytes of _Title_. _Title_ [in] String to display
on ME while command is executing. _CommandLength_ [in] Length in bytes of
_Command_. _Command_ [in] AT command string _IconIdentifier_ [in] Optional
icon identifier; see CatIconIdentifier for member details. If _IconIdentifier_
is NULL or if _IconIdentifier_._UseIcon_ is zero, no icon identifier is sent
to the ME. _Response_ [out] ME response string. _ResponseLength_ [out] _Length
in bytes of ME response string._ _RETURN_ _The GeneralResult code of the RUN
AT COMMAND proactive command._
* * *
_CatRunATCommand_ issues the proactive command RUN AT COMMAND that sends an AT
command to the ME. The terminal response is parsed and if successful the
parameters _Response_ and _ResponseLength_ are updated.
### 5.10.21 CatSendDTMFCommand
**CatGeneralResult\ CatSendDTMFCommand (BYTE** _TitleLength_**, const void
***_Title_**,\ BYTE** _DTMFCodeLength_**, const void ***_DTMFCode_ _,\
***__const CatIconIdentifier *_ **IconIdentifier** _);_ *
* * *
_TitleLength_ [in] The length in bytes of _Title_. _Title_ [in] Title
displayed while the DTMF string is sent to the network. _DTMFCodeLength_ [in]
The length in bytes of _DTMFCode_. _DTMFCode_ [in] DTMF string sent to the
network. _IconIdentifier_ [in] Optional icon identifier; see CatIconIdentifier
for member details. If IconIdentifier is NULL or if IconIdentifier.UseIcon is
zero, no icon identifier is sent to the ME. _RETURN_ _The GeneralResult code
of the SEND DTMF COMMAND proactive command._
* * *
_CatSendDTMF_ issues the proactive command SEND DTMF COMMAND that sends a dual
tone multiple frequency (DTMF) string to the network.
## 5.11 Supporting Data Types
\- typedef unsigned char BYTE.
\- typedef unsigned short WORD.
\- typedef unsigned long int DWORD.
### 5.11.1 CatRecordAccessMode
typedef enum {
NEXT = 0x02,
PREVIOUS = 0x03,
CURRENT = 0x04,
ABSOLUTE = 0x04
} CatRecordAccessMode;
### 5.11.2 CatSearchMode
typedef enum {
BEGINNING_FORWARD,\ END_BACKWARD,\ NEXT_FORWARD,\ PREVIOUS_BACKWARD
} CatSearchMode;
### 5.11.3 CatFrameworkEventType
typedef enum\ {\ // Command monitoring events\
EVENT_TERMINAL_PROFILE_COMMAND,\ EVENT_STATUS_COMMAND\
EVENT_ENVELOPE_COMMAND,\ // Application lifecycle events start here\
EVENT_APPLICATION_LIFECYCLE_INSTALL = 0x20\ // Framework fabricated events
start here\ EVENT_UPDATE_EF_SMS = 0x40
EVENT_PROFILE_DOWNLOAD,
EVENT_FORMATTED_SMS_PP_UPD,
EVENT_STATUS_COMMAND,
EVENT_UNFORMATTED_SMS_PP_UPD,
EVENT_MENU_SELECTION,
EVENT_FORMATTED_SMS_PP_ENV,
EVENT_UNFORMATTED_SMS_PP_ENV,
EVENT_FORMATTED_SMS_PP_CB,
EVENT_MENU_SELECTION_HELP_REQUEST,
EVENT_CALL_CONTROL_BY_SIM,
EVENT_MO_SHORT_MESSAGE_CONTROL_BY_SIM,
EVENT_TIMER_EXPIRATION,
EVENT_DOWNLOAD_MT_CALL_EVENT,
EVENT_DOWNLOAD_CALL_CONNECTED_EVENT,
EVENT_DOWNLOAD_CALL_DISCONNECTED_EVENT,
EVENT_DOWNLOAD_LOCATION_STATUS_EVENT,
EVENT_DOWNLOAD_USER_ACTIVITY_EVENT,
EVENT_DOWNLOAD_IDLE_SCREEN_AVAILABLE_EVENT,
EVENT_DOWNLOAD_CARD_READER_STATUS_EVENT,
EVENT_DOWNLOAD_LANGUAGE_SELECTION_EVENT,
EVENT_DOWNLOAD_BROWSER_TERMINATION_EVENT,
EVENT_DOWNLOAD_DATA_AVAILABLE_EVENT,
EVENT_DOWNLOAD_CHANNEL_STATUS_EVENT,
EVENT_UNRECOGNIZED_ENVELOPE,
EVENT_TERMINAL_RESPONSE,
EVENT_APPLICATION_INSTALL\ } CatFrameworkEventType;
### 5.11.4 CatEnvelopeTagType
typedef enum {\ SMS_PP_DOWNLOAD_TAG = 0xD1,\ CELL_BROADCAST_TAG = 0xD2,\
MENU_SELECTION_TAG = 0xD3,\ CALL_CONTROL_TAG = 0xD4,\
MO_SHORT_MESSAGE_CONTROL_TAG = 0xD5,\ EVENT_DOWNLOAD_TAG = 0xD6,\
TIMER_EXPIRATION = 0xD7\ } CatEnvelopeTagType;
### 5.11.5 CatEventType
typedef enum {\ MT_CALL_EVENT = 0x00,\ CALL_CONNECTED_EVENT = 0x01,\
CALL_DISCONNECTED_EVENT = 0x02,\ LOCATION_STATUS_EVENT = 0x03,\
USER_ACTIVITY_EVENT = 0x04,\ IDLE_SCREEN_AVAILABLE = 0x05,\ CARD_READER_STATUS
= 0x06,\ LANGUAGE_SELECTION = 0x07,\ BROWSER_TERMINATION = 0x08,\
DATA_AVAILABLE = 0x09,\ CHANNEL_STATUS = 0x0A\ } CatEventType;
### 5.11.6 CatTextString
typedef struct
{
CatDCSValue DCSValue;\ BYTE TextStringLength;\ const void *TextString;\ }
CatTextString;
### 5.11.7 CatAlphaString
typedef struct
{\ BYTE AlphaStringLength;\ const void *AlphaString;\ } CatTextString;
### 5.11.8 CatIconIdentifier
typedef struct
{
BYTE UseIcon;
BYTE IconIdentifier;\ BYTE IconOptions;
} CatIconIdentifier;
The _CatIconIdentifier_ structure is defined as follows:
* * *
_UseIcon_ If zero, the icon identifier is not used in the proactive command.
If non-zero, the IconIdentifier and IconOption members are used in the
proactive command. _IconIdentifier_ Index of the icon to display.
_IconOptions_ Options with which to display the icon selected from
CatIconOption. This is specified as a BYTE rather than CatIconOptios as, in C,
an enumeration uses the same storage as an int which is at least 16 bits,
whereas the proactive commands that use these identifiers use 8-bit
quantities.
* * *
### 5.11.9 CatIconOption
typedef enum
{
SHOW_WITHOUT_TEXT = 0x00,
SHOW_WITH_TEXT = 0x01
} CatIconOption;
### 5.11.10 CatDCSValue
typedef enum
{
DCS_SMS_PACKED = 0x00,
DCS_SMS_UNPACKED = 0x04,
DCS_SMS_UNICODE = 0x08
} CatDCSValue;
### 5.11.11 CatDisplayTextOptions
typedef enum
{
NORMAL_PRIORITY_AUTO_CLEAR = 0x00,
NORMAL_PRIORITY_USER_CLEAR = 0x80,
HIGH_PRIORITY_AUTO_CLEAR = 0x01,
HIGH_PRIORITY_USER_CLEAR = 0x81
} CatDisplayTextOptions;
### 5.11.12 CatGetInKeyOptions
typedef enum
{
YES_NO_OPTION_NO_HELP = 0x04,
YES_NO_OPTION_WITH_HELP = 0x84,
DIGITS_ONLY_NO_HELP = 0x00,
DIGITS_ONLY_WITH_HELP = 0x80,
SMS_CHARACTER_NO_HELP = 0x01,
SMS_CHARACTER_WITH_HELP = 0x81,
UCS2_CHARACTER_NO_HELP = 0x03,
UCS2_CHARACTER_WITH_HELP = 0x83
} CatGetInKeyOptions;
### 5.11.13 CatGetInputOptions
typedef enum
{
PACKED_DIGITS_ONLY_NO_HELP = 0x08,
PACKED_DIGITS_ONLY_WITH_HELP = 0x88,
PACKED_DIGITS_ONLY_NO_ECHO_NO_HELP = 0x0C,
PACKED_DIGITS_ONLY_NO_ECHO_WITH_HELP = 0x8C,
UNPACKED_DIGITS_ONLY_NO_HELP = 0x00,
UNPACKED_DIGITS_ONLY_WITH_HELP = 0x80,
UNPACKED_DIGITS_ONLY_NO_ECHO_NO_HELP = 0x04,
UNPACKED_DIGITS_ONLY_NO_ECHO_WITH_HELP = 0x84,
PACKED_SMS_ALPHABET_NO_HELP = 0x09,
PACKED_SMS_ALPHABET_WITH_HELP = 0x89,
PACKED_SMS_ALPHABET_NO_ECHO_NO_HELP = 0x0D,
PACKED_SMS_ALPHABET_NO_ECHO_HELP = 0x8D,
UNPACKED_SMS_ALPHABET_NO_HELP = 0x01,
UNPACKED_SMS_ALPHABET_WITH_HELP = 0x81,
UNPACKED_SMS_ALPHABET_NO_ECHO_NO_HELP = 0x05,
UNPACKED_SMS_ALPHABET_NO_ECHO_WITH_HELP = 0x85,
UCS2_ALPHABET_NO_HELP = 0x03,
UCS2_ALPHABET_WITH_HELP = 0x83,
UCS2_ALPHABET_NO_ECHO_NO_HELP = 0x07,
UCS2_ALPHABET_NO_ECHO_WITH_HELP = 0x87
} CatGetInputOptions;
### 5.11.14 CatSelectItemOptions
typedef enum
{
PRESENT_AS_DATA_VALUES_NO_HELP = 0x01,
PRESENT_AS_DATA_VALUES_WITH_HELP = 0x81,
PRESENT_AS_NAVIGATION_OPTIONS_NO_HELP = 0x03,
PRESENT_AS_NAVIGATION_OPTIONS_WITH_HELP = 0x83,
DEFAULT_STYLE_NO_HELP = 0x00,
DEFAULT_STYLE_WITH_HELP = 0x80
} CatSelectItemOptions;
### 5.11.15 CatTimeUnit
typedef enum
{
GSM_MINUTES = 0x00,
GSM_SECONDS = 0x01,
GSM_TENTHS_OF_SECONDS = 0x02
} CatTimeUnit;
### 5.11.16 CatTone
typedef enum
{
DIAL_TONE = 0x01,
CALLER_BUSY = 0x02,
CONGESTION = 0x03,
RADIO_PATH_ACKNOWLEDGE = 0x04,
CALL_DROPPED = 0x05,
SPECIAL_INFORMATION_OR_ERROR = 0x06,
CALL_WAITING_TONE = 0x07,
RINGING_TONE = 0x08,
GENERAL_BEEP = 0x10,
POSITIVE_ACKNOWLEDGE_TONE = 0x11,
NEGATIVE_ACKNOWLEDGE_TONE = 0x12
} CatTone;
### 5.11.17 CatRefreshOptions
typedef enum
{
REFRESH_SIM_INIT_AND_FULL_FILE_CHANGE_NOTIFICATION = 0x00,\
REFRESH_FILE_CHANGE_NOTIFICATION = 0x01,
REFRESH_SIM_INIT_AND_FILE_CHANGE_NOTIFICATION = 0x02,
REFRESH_SIM_INIT = 0x03,\ REFRESH_SIM_RESET = 0x04
} CatRefreshOptions;
### 5.11.18 CatGetReaderStatusOptions
typedef enum
{
CARD_READER_STATUS = 0x00,\ CARD_READER_IDENTIFIER = 0x01\ }
CatGetReaderStatusOptions;
### 5.11.19 CatDevice
typedef enum
{
DEVICE_KEPYAD = 0x01,
DEVICE_DISPLAY = 0x02,
DEVICE_EARPIECE = 0x03,
DEVICE_CARD_READER_0 = 0x10,
DEVICE_CARD_READER_1 = 0x11,
DEVICE_CARD_READER_2 = 0x12,
DEVICE_CARD_READER_3 = 0x13,
DEVICE_CARD_READER_4 = 0x14,
DEVICE_CARD_READER_5 = 0x15,
DEVICE_CARD_READER_6 = 0x16,
DEVICE_CARD_READER_7 = 0x17,
DEVICE_CHANNEL_1 = 0x21,
DEVICE_CHANNEL_2 = 0x22,
DEVICE_CHANNEL_3 = 0x23,
DEVICE_CHANNEL_4 = 0x24,
DEVICE_CHANNEL_5 = 0x25,
DEVICE_CHANNEL_6 = 0x26,
DEVICE_CHANNEL_7 = 0x27,
DEVICE_SIM = 0x81,
DEVICE_ME = 0x82,
DEVICE_NETWORK = 0x83
} CatDevice;
### 5.11.20 CatGeneralResult
typedef enum
{
CAT_COMMAND_SUCCESSFUL = 0x00,
CAT_COMMAND_SUCCESSFUL_WITH_PARTIAL_COMPREHENSION = 0x01,
CAT_COMMAND_SUCCESSFUL_WITH_MISSING_INFORMATION = 0x02,
CAT_REFRESH_SUCCESSFUL_WITH_ADDITIONAL_EFS_READ = 0x03,
CAT_COMMAND_SUCCESSFUL_BUT_ICON_NOT_FOUND = 0x04,
CAT_COMMAND_SUCCESSFUL_BUT_MODIFIED_BY_CALL_CONTROL = 0x05,
CAT_COMMAND_SUCCESSFUL_BUT_LIMITED_SERVICE = 0x06,
CAT_COMMAND_SUCCESSFUL_WITH_MODIFICATION = 0x07,
CAT_ABORTED_BY_USER = 0x10,
CAT_BACKWARD = 0x11,
CAT_NO_RESPONSE = 0x12,
CAT_HELP_REQUIRED = 0x13,
CAT_USSD_ABORTED_BY_USER = 0x14,
CAT_ME_UNABLE_TO_PROCESS_COMMAND = 0x20,
CAT_NETWORK_UNABLE_TO_PROCESS_COMMAND = 0x21,
CAT_USER_REJECTED_SETUP_CALL = 0x22,
CAT_USER_CLEARED_BEFORE_RELEASE = 0x23,
CAT_ACTION_CONTRADICT_TIMER_STATE = 0x24,
CAT_TEMP_PROBLEM_IN_CALL_CONTROL = 0x25,
CAT_LAUNCH_BROWSER_ERROR = 0x26,
CAT_COMMAND_BEYOND_ME_CAPABILITIES = 0x30,
CAT_COMMAND_TYPE_NOT_UNDERSTOOD = 0x31,
CAT_COMMAND_DATA_NOT_UNDERSTOOD = 0x32,
CAT_COMMAND_NUMBER_NOT_KNOWN = 0x33,
CAT_SS_RETURN_ERROR = 0x34,
CAT_SMS_RP_ERROR = 0x35,
CAT_REQUIRED_VALUES_MISSING = 0x36,
CAT_USSD_RETURN_ERROR = 0x37,
CAT_MULTIPLE_CARD_COMMAND_ERROR = 0x38,
CAT_PERMANENT_PROBLEM_IN_SMS_OR_CALL_CONTROL = 0x39,
CAT_BEARER_INDEPENDENT_PROTOCOL_ERROR = 0x3A
} CatGeneralResult;
### 5.11.21 CatTimerValue
typedef struct
{
BYTE hour;
BYTE minute;
BYTE second;
} CatTimerValue;
The _CatTimerValue_ data type has three one-byte values:
* * *
_hour_ Hours part of timer. _Minute_ Minutes part of timer. _Second_ Seconds
part of timer.
* * *
### 5.11.22 CatTimeInterval
typedef struct
{
BYTE timeUnit;
BYTE timeInterval;
} CatTimeInterval;
The _CatTimInterval_ data type has two one-byte values:
* * *
_timeUnit_ One of the CatTimeUnit enumeration values. This is specified as a
BYTE rather than CatTimeUnit as, in C, an enumeration uses the same storage as
an int which is at least 16 bits, whereas the proactive commands that use
these identifiers use 8-bit quantities. _TimeInterval_ The number of
timeUnits.
* * *
### 5.11.23 CatFileStatus
typedef struct
{
;
WORD recordLength;
WORD numberOfRecords;
BYTE lengthOfTrailer;\ BYTE trailer[];
} CatEFStatus;
typedef struct
{
BYTE numberOfDFs;\ BYTE numberofEFs;
BYTE CHV1Status;
BYTE unblockCHV1Status;
BYTE CHV2Status;
BYTE unblockCHV2Status;
BYTE lengthOfTrailer;
BYTE trailer[];
} CatDFStatus;
typedef struct
{
DWORD totalFileSize;
UINT16 fileID;
BYTE fileDescriptorByte;
BYTE fileType; // 00=RFU, 01=MF, 02=DF, 04=EF
BYTE fileLifeCycleStatus;
union\ {
CatEFStatus ef;\ CatDFStatus df;\ } u;
} CatFileStatus;
### 5.11.24 CatLanguageNotificationOptions
typedef enum
{
LANGUAGE_NON_SPECIFIC_NOTIFICATION = 0x00,\ LANGUAGE_SPECIFIC_NOTIFICATION =
0x01\ } CatLanguageNotificationOptions;
### 5.11.25 CatLocationInformation
typedef struct
{
BYTE mobileCountryNetworkCodes[3];\ BYTE LAC[2];\ BYTE cellID[2];\ }
CatLocationInformation;
### 5.11.26 CatTimingAdvance
typedef struct
{
BYTE MEStatus;\ BYTE timingAdvance;\ } CatTimingAdvance;
### 5.11.27 CatLaunchBrowserOptions
typedef enum
{
LAUNCH_BROWSER_IF_NOT_ALREADY_LAUNCHED = 0x00,
USE_EXISTING_BROWSER = 0x02,
CLOSE_EXISTING_BROWSER_AND_LAUNCH_NEW_BROWSER = 0x03
} CatLaunchBrowserOptions;
### 5.11.28 CatSetupCallOptions
typedef enum
{
CALL_ONLY_IF_NOT_BUSY = 0x00,
CALL_ONLY_IF_NOT_BUSY_WITH_REDIAL = 0x01,
CALL_AND_PUT_ALL_OTHER_CALLS_ON_HOLD = 0x02,
CALL_AND_PUT_ALL_OTHER_CALLS_ON_HOLD_WITH_REDIAL = 0x03,
CALL_AND_DISCONNECT_ALL_OTHER_CALLS = 0x04,
CALL_AND_DISCONNECT_ALL_OTHER_CALLS_WITH_REDIAL = 0x05
} CatSetupCallOptions;
### 5.11.29 CatTypeOfNumberAndNumberingPlanIdentifier
typedef enum
{
TON_UNKNOWN_AND_NPI_UNKNOWN = 0x80,
TON_INTERNATIONAL_AND_NPI_UNKNOWN = 0x90,
TON_NATIONAL_AND_NPI_UNKNOWN = 0xA0,
TON_NETWORK_AND_NPI_UNKNOWN = 0xB0,
TON_SUBSCRIBER_AND_NPI_UNKNOWN = 0xC0,
TON_UNKNOWN_AND_NPI_TELEPHONE = 0x81,
TON_INTERNATIONAL_AND_NPI_TELEPHONE = 0x91,
TON_NATIONAL_AND_NPI_TELEPHONE = 0xA1,
TON_NETWORK_AND_NPI_TELEPHONE = 0xB1,
TON_SUBSCRIBER_AND_NPI_TELEPHONE = 0xC1,
TON_UNKNOWN_AND_NPI_DATA = 0x83,
TON_INTERNATIONAL_AND_NPI_DATA = 0x93,
TON_NATIONAL_AND_NPI_DATA = 0xA3,
TON_NETWORK_AND_NPI_DATA = 0xB3,
TON_SUBSCRIBER_AND_NPI_DATA = 0xC3,
TON_UNKNOWN_AND_NPI_TELEX = 0x84,
TON_INTERNATIONAL_AND_NPI_TELEX = 0x94,
TON_NATIONAL_AND_NPI_TELEX = 0xA4,
TON_NETWORK_AND_NPI_TELEX = 0xB4,
TON_SUBSCRIBER_AND_NPI_TELEX = 0xC4,
TON_UNKNOWN_AND_NPI_NATIONAL = 0x88,
TON_INTERNATIONAL_AND_NPI_NATIONAL = 0x98,
TON_NATIONAL_AND_NPI_NATIONAL = 0xA8,
TON_NETWORK_AND_NPI_NATIONAL = 0xB8,
TON_SUBSCRIBER_AND_NPI_NATIONAL = 0xC8,
TON_UNKNOWN_AND_NPI_PRIVATE = 0x89,
TON_INTERNATIONAL_AND_NPI_PRIVATE = 0x99,
TON_NATIONAL_AND_NPI_PRIVATE = 0xA9,
TON_NETWORK_AND_NPI_PRIVATE = 0xB9,
TON_SUBSCRIBER_AND_NPI_PRIVATE = 0xC9,
TON_UNKNOWN_AND_NPI_ERMES = 0x8A,
TON_INTERNATIONAL_AND_NPI_ERMES = 0x9A,
TON_NATIONAL_AND_NPI_ERMES = 0xAA,
TON_NETWORK_AND_NPI_ERMES = 0xBA,
TON_SUBSCRIBER_AND_NPI_ERMES = 0xCA
} CatTypeOfNumberAndNumberingPlanIdentifier;
### 5.11.30 CatSendShortMessageOptions
typedef enum
{
PACKING_NOT_REQUIRED = 0x00,
PACKING_BY_THE_ME_REQUIRED = 0x01
} CatSendShortMessageOptions;
### 5.11.31 CatSendDataOptions
typedef enum
{
STORE_DATA_IN_TX_BUFFER = 0x00,\ SEND_DATA_IMMEDIATELY = 0x01
} CatSendDataOptions;
### 5.11.32 CatMEInterfaceTransportLevelType
typedef struct\ {\ enum\ {\ UDP = 0x01,\ TCP = 0x02\ } TransportProtocolType;\
UINT16 CAT_ME_PortNumber;\ } CAT_MEInterfaceTransportLevelType;
### 5.11.33 CatBearer
typedef enum
{
BEARER_SMS = 0x00,\ BEARER_CSD = 0x01,\ BEARER_USSD = 0x02,\ BEARER_GPRS =
0x03
} CatBearer;
### 5.11.34 CatOpenChannelOptions
typedef enum
{
ON_DEMAND_LINK_ESTABLISHMENT = 0x00,\ IMMEDIATE_LINK_ESTABLISHMENT = 0x01\ }
CatOpenChannelOptions;
### 5.11.35 CatAddressType
typedef struct\ {
enum
{
IPV4 = 0x21,
IPV6 = 0x97
} AddressType;\ BYTE AddressLength;\ const void *Address;\ } CatAddressType;
### 5.11.36 CatFID
#define FID_DF_GRAPHICS 0x5F50
#define FID_DF_TELECOM 0x7F10
#define FID_EF_ADN 0x6F3A
#define FID_EF_ARR 0x2F06
#define FID_EF_BDN 0x6F4D
#define FID_EF_CCP 0x6F3D
#define FID_EF_DIR 0x2F00
#define FID_EF_EXT1 0x6F4A
#define FID_EF_EXT2 0x6F4B
#define FID_EF_EXT3 0x6F4C
#define FID_EF_EXT4 0x6F4E
#define FID_EF_FDN 0x6F3B
#define FID_EF_ICCID 0x2FE2
#define FID_EF_IMG 0x4F20
#define FID_EF_LND 0x6F44
#define FID_EF_MSISDN 0x6F40
#define FID_EF_PL 0x2F05
#define FID_EF_SDN 0x6F49
#define FID_EF_SMS 0x6F3C
#define FID_EF_SMSP 0x6F42
#define FID_EF_SMSR 0x6F47
#define FID_EF_SMSS 0x6F43
### 5.11.37 CatTextFormat
#define TEXT_FORMAT_LEFT 0x00
#define TEXT_FORMAT_CENTER 0x01
#define TEXT_FORMAT_RIGHT 0x02
#define TEXT_FORMAT_LANGUAGE_DEPENDENT 0x03
#define TEXT_FORMAT_NORMAL_SIZE 0x00
#define TEXT_FORMAT_LARGE_SIZE 0x04
#define TEXT_FORMAT_SMALL_SIZE 0x08
#define TEXT_FORMAT_BOLD 0x10
#define TEXT_FORMAT_ITALIC 0x20
#define TEXT_FORMAT_UNDERLINED 0x40
#define TEXT_FORMAT_STRIKETHROUGH 0x80
### 5.11.38 CatTextForegroundColour
typedef enum {
BLACK = 0x00,
DARK_GREY = 0x01,
DARK_RED = 0x02,
DARK_YELLOW = 0x03,
DARK_GREEN = 0x04,
DARK_CYAN = 0x05,
DARK_BLUE = 0x06,
DARK_MAGENTA = 0x07,
GREY = 0x08,
WHITE = 0x09,
BRIGHT_RED = 0x0A,
BRIGHT_YELLOW = 0x0B,
BRIGHT_GREEN = 0x0C,
BRIGHT_CYAN = 0x0D,
BRIGHT_BLUE = 0x0E,
BRIGHT_MAGENTA = 0x0F
} CatTextForegroundColour;
### 5.11.39 CatTextBackgroundColour
typedef enum {
BLACK = 0x00,
DARK_GREY = 0x10,
DARK_RED = 0x20,
DARK_YELLOW = 0x30,
DARK_GREEN = 0x40,
DARK_CYAN = 0x50,
DARK_BLUE = 0x60,
DARK_MAGENTA = 0x70,
GREY = 0x80,
WHITE = 0x90,
BRIGHT_RED = 0xA0,
BRIGHT_YELLOW = 0xB0,
BRIGHT_GREEN = 0xC0,
BRIGHT_CYAN = 0xD0,
BRIGHT_BLUE = 0xE0,
BRIGHT_MAGENTA = 0xF0
} CatTextBackgroundColour;
###### ## Annex A (normative): Application executable architecture
Name Value Meaning
* * *
EM_NONE 0 No machine EM_M32 1 AT&T WE 32100 EM_SPARC 2 SPARC EM_386 3 Intel
80386 EM_68K 4 Motorola 68000 EM_88K 5 Motorola 88000 RESERVED 6 Reserved for
future use EM_860 7 Intel 80860 EM_MIPS 8 MIPS I Architecture EM_S370 9 IBM
System/370 Processor EM_MIPS_RS3_LE 10 MIPS RS3000 Little-endian RESERVED
11-14 Reserved for future use EM_PARISC 15 Hewlett-Packard PA-RISC RESERVED 16
Reserved for future use EM_VPP500 17 Fujitsu VPP500 EM_SPARC32PLUS 18 Enhanced
instruction set SPARC EM_960 19 Intel 80960 EM_PPC 20 PowerPC EM_PPC64 21
64-bit PowerPC RESERVED 22-35 Reserved for future use EM_V800 36 NEC V800
EM_FR20 37 Fujitsu FR20 EM_RH32 38 TRW RH-32 EM_RCE 39 Motorola RCE EM_ARM 40
Advanced RISC Machines ARM EM_ALPHA 41 Digital Alpha EM_SH 42 Hitachi SH
EM_SPARCV9 43 SPARC Version 9 EM_TRICORE 44 Infineon Tricore embedded
processor EM_ARC 45 Argonaut RISC Core EM_H8_300 46 Hitachi H8/300 EM_H8_300H
47 Hitachi H8/300H EM_H8S 48 Hitachi H8S EM_H8_500 49 Hitachi H8/500 EM_IA_64
50 Intel IA-64 processor architecture EM_MIPS_X 51 Stanford MIPS-X EM_COLDFIRE
52 Motorola ColdFire EM_68HC12 53 Motorola M68HC12 EM_MMA 54 Fujitsu MMA
Multimedia Accelerator EM_PCP 55 Siemens PCP EM_NCPU 56 Sony nCPU embedded
RISC processor EM_NDR1 57 Denso NDR1 microprocessor EM_STARCORE 58 Motorola
Star*Core processor EM_ME16 59 Toyota ME16 processor EM_ST100 60
STMicroelectronics ST100 processor EM_TINYJ 61 Advanced Logic Corp. TinyJ
embedded processor family Reserved 62-65 Reserved for future use EM_FX66 66
Infineon FX66 microcontroller EM_ST9PLUS 67 STMicroelectronics ST9+ 8/16 bit
microcontroller EM_ST7 68 STMicroelectronics ST7 8-bit microcontroller
EM_68HC16 69 Motorola MC68HC16 Microcontroller EM_68HC11 70 Motorola MC68HC11
Microcontroller EM_68HC08 71 Motorola MC68HC08 Microcontroller EM_68HC05 72
Motorola MC68HC05 Microcontroller EM_SVX 73 Silicon Graphics SVx EM_ST19 74
STMicroelectronics ST19 8-bit microcontroller EM_VAX 75 Digital VAX EM_CRIS 76
Axis Communications 32-bit embedded processor EM_JAVELIN 77 Infineon
Technologies 32-bit embedded processor EM_FIREPATH 78 Element 14 64-bit DSP
Processor EM_ZSP 79 LSI Logic 16-bit DSP Processor EM_MMIX 80 Donald Knuth\'s
educational 64-bit processor EM_HUANY 81 Harvard University machine-
independent object files EM_PRISM 82 SiTera Prism EM_MEL 83 Multos Executable
Language (MEL) byte codes EM_RTE 84 Microsoft Smart Card for Windows Runtime
Environment byte codes
###### ## Annex B (informative): Example
/**
** Example of Toolkit Application written for the C SIM API
*/
#pragma AID A0000000090001
#include \
#include \"application.h\"
#include \"cat.h\"
#include \"catlow.h\"
#define DF_GSM 0x7F20
#define EF_PUCT 0x6F41
const BYTE SERVER_OPERATION = 0x0F;
const BYTE EXIT_REQUESTED_BY_USER = 0x10;
static const char menuEntry[] = \"Service1\";
static const char menuTitle[]= \"MyMenu\";
static char item1[] = \"ITEM1\";
static char item2[] = \"ITEM2\";
static char item3[] = \"ITEM3\";
static char item4[] = \"ITEM4\";
static char textDText[] = \"Hello, world\";
static char textGInput[] = \"Your name?\";
BYTE ItemIdentifier;
static BYTE * byteptr;
static void * bufptr;
static BYTE buffer[10];
static BYTE itemId;
static BYTE result;
static BYTE repeat;
void main(void)
{
switch (CatGetFrameworkEvent())
{
case EVENT_APPLICATION_LIFECYCLE_INSTALL:
// Define the application Menu Entry and register to the EVENT_MENU_SELECTION
CatSetMenuString (1,sizeof(menuEntry),(const void *)MenuEntry,NULL,0,0);
// register to the EVENT_UNFORMATTED_SMS_PP_ENV
CatNotifyOnEnvelope(SMS_PP_DOWNLOAD_TAG,1);
break;
case EVENT_ENVELOPE_COMMAND:
{
BYTE length;
switch (CatOpenEnvelope(&length))
{
case MENU_SELECTION_TAG:
// Prepare the Select Item proactive command
// Append the Menu Title
CatSelectItem (sizeof(MenuTitle),
(const void *)MenuTitle,
DEFAULT_STYLE_NO_HELP);
// add all the Item
CatSelectAddItem(sizeof(item1),(const void *)item1,1);
CatSelectAddItem(sizeof(item2),(const void *)item2,2);
CatSelectAddItem(sizeof(item3),(const void *)item3,3);
CatSelectAddItem(sizeof(item4),(const void *)item4,4);
// ask the CAT Toolkit Framework to send
//the proactive command and check the result
if (!CatEndSelectItem(&ItemId,NULL))
{
switch(ItemId)
{
case 1:
case 2:
case 3: // DisplayText
CatDisplayText (DCS_SMS_UNPACKED,
sizeof(textDText),
(const void *) textDText,
NORMAL_PRIORITY_USER_CLEAR, NULL, 0);
break;
case 4: // Ask the user to enter data and display it
repeat=0;
do
{
if (CatGetInput(DCS_SMS_UNPACKED,
sizeof(textGInput),
(const void *) textGInput,
UNPACKED_SMS_ALPHABET_NO_HELP,
DCS_SMS_UNPACKED, 0, NULL,
0, sizeof(buffer), NULL,
(CatDCSValue *)&result,
&repeat,
(void *)buffer)==EXIT_REQUESTED_BY_USER)
break;
// display the entered text
CatDisplayText ((CatDCSValue )result,
repeat, (const void *) buffer,
NORMAL_PRIORITY_USER_CLEAR, NULL, 0);
} while (repeat);
}
}
break;
case EVENT_UNFORMATTED_SMS_PP_ENV:
CatOpenEnvelope(&result);
byteptr=(BYTE *)catGetData(1); /* go to numberlength */
result=(*byteptr)>>1;
/* calculate numberlength, rounded up */
if ((*byteptr)&1)result++;
catGetData(result+12); /* move to the beginning of the data */
// get the offset of the instruction in the TP-UD field
CatGetData(SERVER_OPERATION);
result=CatGetBYTE();
switch(result)
{
case 0x41 : // Update of a gsm file
bufptr=CatGetData(3);
// write these data in the Efpuct
CatSelect(FID_DF_GSM);
CatSelect(FID_EF_PUCT);
CatUpdateBinary(0,3,bufptr);
break;
case 0x36 : // change the MenuTitle for the SelectItem
bufptr=CatGetData(sizeof(menuTitle));
memcpy(bufptr,memuTitle,sizeof(menuTitle));
}
}
}
break;
default:
CatExit();
break;
}
CatExit();
}
#