# Foreword
This Technical Specification has been produced by the 3GPP.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of this TS, it will be re-released by the TSG with an identifying
change of release date and an increase in version number as follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater Indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the technical characteristics and methods of
test for testing the SIM API for the C programming language 3GPP TS 31.131
[11] implemented in the subscriber identity modules for GSM and 3G networks.
It specifies the following parts:
\- test applicability
\- test environment description
\- tests format
\- test area reference
\- conformance requirements
\- test suite files
\- test procedure
\- test coverage and,
\- a description of the associated testing tools that may be used.
# 2 References
The following documents contain provisions, which, through reference in this
text, constitute provisions of the present document.
• References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
• For a specific reference, subsequent revisions do not apply.
• For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 31.111: \"3^rd^ Generation Partnership Project; Technical
Specification Group; USIM Application Toolkit (USAT)\".
[3] 3GPP TS 23.048: \"3^rd^ Generation Partnership Project; Technical
Specification Group Terminals; Security Mechanisms for the SIM application
toolkit\".
[4] 3GPP TS 42.019: \"3^rd^ Generation Partnership Project; Technical
Specification Group Terminals; Subscriber Identity Module Application
Programming Interface (SIM API); Stage 1\".
[5] ISO 639 (1988): \"Code for the representation of names of languages\".
[6] 3GPP TS 23.038: \"Alphabets and language‑specific information\".
[7] ISO/IEC 9899 Second Edition 1999-12-01: \"Programming Languages -- C\".
[8] 3GPP TS 11.14: \"Specification of the SIM Application Toolkit for the
Subscriber Identity Module -- Mobile Equipment (SIM -- ME) interface\" version
4.0.0 Release 4.
[9] Tool Interface Standard (TIS) Executable and Linking Format Specification
Version 1.2
[10] SYSTEM V Application Binary Interface, Edition 4.1
[11] 3GPP TS 31.131 V1.1.2: \"\'C\'-language binding to (U)SIM API\".
[12] GSM 11.10-1: \"Digital cellular telecommunication system (Phase 2+);
Mobile Station (MS) conformance specification; Part 1: Conformance
specification\".
[13] 3GPP TS 51.011: \"Specification of the Subscriber Identity Module \--
Mobile Equipment (SIM-ME) interface\".
[14] ETSI TS 102.221: \"UICC-Terminal interface; Physical and logical
characteristics\".
[15] ETSI TS 102.226: \"Remote APDU Structure for UICC based Applications.\"
# 3 Definitions and Acronyms
## 3.1 Definitions
The definitions specified in GSM 11.10-1 [12] shall apply, unless otherwise
specified in the present clause.
**Application:** A computer program that defines and implements a useful
domain-specific functionality. The term may apply to the functionality itself,
to the representation of the functionality in a programming language, or to
the realization of the functionality as executable code.
**Application Executable:** The representation of an application as collection
of executable codes.
**Application Program:** The representation of an application in a programming
language such as assembly language, C, Java, WML or XHTML.
**Application Programming Interface:** A collection of entry points and data
structures that an application program can access when translated into an
application executable.
**Byte Code:** A processor-independent representation of a basic computer
operation such as \"increment by one\" that is executed by computer program
called a byte code interpreter.
**Data Structure:** A memory address that can be accessed by an application
executable in order to read or write data.
**Entry Point:** A memory address that can be branched to by an application
executable in order to access functionality defined by an application-
programming interface. Depending on the software technology, an entry point is
also called a subroutine, a function or a method.
**Executable Code:** The generic term for either byte code or native code.
**Framework :** A framework defines a set of Application Programming Interface
(API) functions for developing applications and for providing system services
to those applications.
**Native Code:** A processor-dependent representation of a basic computer
operation such as \"increment by one\" that is executed by the hardware
circuitry of a computer\'s central processing unit.
**Null Operation** : A computer operation that accomplishes nothing.
Abbreviated as NOP and pronounced \"No Op\".
**Toolkit Application:** An application that uses the commands described in
[2].
## 3.2 Acronyms
For the purpose of the present document, the following abbreviations apply:
AC Application Code
AID Application Identifier
APDU Application Protocol Data Unit
API Application Programming Interface
CAD Card Acceptance Device
CPDU Command Protocol Data Unit
CAT Card Application Toolkit
DF Dedicated File
DTMF Dual Tone Multiple Frequency
EF Elementary File
FID File Identifier
GSM Global System for Mobile communications
IFD Interface Device
NOP Null Operation
ME Mobile Equipment
NVM Non-Volatile Memory
ROM Read-Only Memory
SE Sending Entity
SIM Subscriber Identity Module
SMS Short Message Service
STK SIM ToolKit
TLV Tag, Length, Value
TPDU Transport Protocol Data Unit
UICC (not an acronym)
URL Uniform Resource Locator
USIM Universal Subscriber Interface Module
# 4 Test Environment
This clause specifies requirements that shall be met and the testing rules
that shall be followed during the test procedure.
## 4.1 Applicability
The tests defined in this specification shall be performed taking into account
the services supported by the card as specified in the EF~SST~ file.
The tests can be performed with either C source code files (.c) or with ELF
loadfiles (.elf).
## 4.2 Test Environment Description
The C SIM API test specification covers applications that are linked into the
smart card mask and stored in read-only memory as well as applications that
are loaded into read/write memory after it has been manufactured. The C SIM
API test specification also covers applications whose executable form is
either as byte codes or as native codes.
The general architecture for the test environment is given in the following
diagram:
## 4.3 Test Format
### 4.3.1 Test Area Reference
Each test area is referenced as follows:
API: API Testing: \'API_[entry point name]\' where
entry point name:
API entry point defined in 3GPP TS 31.131 [11]
#### 4.3.1.1 Conformance Requirements
The conformance requirements are expressed in the following way:
\- Entry point prototype as listed in 3GPP TS 31.131 [11] specification.
\- Normal execution:
\- Contains normal execution and correct parameters limit values, each
referenced as a Conformance Requirement Reference Normal (CRRN)
\- Parameters error:
\- Contains parameter errors and incorrect parameter limit values, each
referenced as a Conformance Requirement Reference Parameter Error (CRRP)
\- Context error:
\- Contains errors due to the context the entry point is used in, each
referenced as a Conformance Requirement Reference Context Error (CRRC)
#### 4.3.1.2 Test Area Files
The test area contains the source code of a program that translates the test
procedure found in each section below into C test application program (.c) and
an APDU Tool test script (.s). A test is conducted by compiling the C program,
installing it on the UICC, and running the associated test script.
The test area also contains the C header files that are referenced by the
output of the translator. The test scripts must be processed through a C pre-
processor [7] before they are provided to the APDU Tool.
#### 4.3.1.3 Test Procedure
Each test procedure contains pseudo-code that describes the test together with
the expected responses from the API and the expected command and response APDU
traffic. The test procedure may be translated into a C test application
program and APDU Tool test script using the program in the Test Area
#### 4.3.1.4 Test Coverage
The table at the end of each test procedure indicates the correspondence
between the Conformance Requirements Reference (CRR) and the different test
cases.
## 4.4 Initial Conditions
The Initial Conditions are a set of general prerequisites for the (U)SIM prior
to the execution of testing. For each test procedure described in this
document, the following rules apply to the Initial Conditions:
\- unless otherwise stated, the file system and the files\' content shall
ulfil the requirements described in the \"Default Prepersonalisation\"
paragraph at the time of running the test with test number 1;
\- unless otherwise stated, tests with test number 1 through i have been
successfully executed before the test with test number i+1 is executed.
When both statements apply, a test procedure is said to be in the \"Default
Initial Conditions\" state.
## 4.5 Test Equipment
These subclauses recommend a minimum specification for each of the items of
test equipment referenced in the tests.
### 4.5.1 APDU Tool
This test tool shall meet the following requirements:
\- be able to send commands to the card TPDU;
\- be able to check none, only a part, or all of the data returned;
\- be able to check none, only part, or all of the status returned;
\- be able to accept all valid status codes returned;
\- be able to support CAD commands;
\- be able to generate a log file for each test execution.
\- if more data is returned than defined in the test specification the event
shall be noted in the log and the tool shall continue;
\- if less data is returned than defined in the test specification the event
shall be noted in the log and the tool shall continue;
\- if there is an error in data or status returned the event shall be noted in
the log and the tool shall continue.
The log file produced by the test tool shall include the following
information:
\- all commands issued;
\- all data returned;
\- all status returned;
\- all errors codes;
\- expected data and status in case of error;
\- comments from the scripts;
a log message to report success or failure of the test;
transmission error events including anomalies in returned data;
## 4.6 Testing Methodology
### 4.6.1 Test Interfaces and Facilities
The SIM-ME interface provides the main transport interface for the purpose of
performing conformance tests.
The SIM API interface provides the main test interface for the purpose of
performing conformance tests.
# 5 Test Plan
The test plan is divided according to the entry point sections of 3GPP TS
31.131 [11] although the sections of the test plan do not appear in the same
order as the corresponding sections in TS 31.131 [11].
# 6 API Test Plan
## 6.1 UICC File Store Access
### 6.1.1 CatSelect
Test Area Reference: API_CatSelect
#### 6.1.1.1 Conformance Requirements
The entry point with the following signature shall be compliant to its
definition in the API.
WORD CatSelect(CatFID FileIdentifier, CatFileStatus *Status)
##### 6.1.1.1.1 Normal execution {#normal-execution .H6}
CRRN1: If the desired file is selected, the proper status information has been
returned in *Status.
CRRN2: After selecting a DF/MF no EF is selected.
CRRN3: After selecting a linear fixed EF no record is selected.
CRRN4: After selecting a cyclic EF the first record which is the last updated
record is selected.
CRRN5: The file with a file identifier that matches fid shall be found
according to the following selection rules:
1) An immediate child EF or DF of the current MF/DF can be selected,
2) A sibling DF of the current DF can be selected,
3) The current MF/DF it self can be selected,
4) The parent MF/DF of the current DF can be selected,
The MF can always be selected.
CRRN6: If status is NULL the invocation is a NOP.
##### 6.1.1.1.2 Parameter errors {#parameter-errors .H6}
##### 6.1.1.1.3 Context errors {#context-errors .H6}
CRRC1: If the file with a file identitifier which matches FileIdentitifer
could not be found according to the selection rules listed in CRRN5 then the
FILE_NOT_FOUND status word shall be returned.
CRRC2: If the entry point call causes a memory problem (e.g. memory access
error), the MEMORY_PROBLEM status word shall be returned.
CRRC3: If the entry point call causes an error to occur that is not expected
and thus not handled, the INTERNAL_ERROR status word shall be returned.
#### 6.1.1.2 Test Procedure
SET Test TO CatSelect.
/* Test Case 1: Select MF in MF (Transparent EF) */
IF {CatSelect(FID_MF, &FCP) == SW_OK}
THEN {FCP.fileType == FT_MF}.
/* Test Case 2: Select EF-ICCID in MF (Transparent EF) */
IF {CatSelect(FID_EF_ICCID, &FCP) == SW_OK}
THEN {FCP.fileType == FT_EF}.
/* Test Case 3: Select DF-GSM in MF*/
IF {CatSelect(FID_DF_GSM, &FCP) == SW_OK}
THEN {FCP.fileType == FT_DF}.
/* Test Case 4: Select EF-ACM in DF-GSM (Cyclic EF) */
IF {CatSelect(FID_EF_ACM, &FCP) == SW_OK}
THEN {FCP.fileType == FT_EF}.
/* Test Case 5: Select MF*/
IF {CatSelect(FID_MF, &FCP) == SW_OK}
THEN {FCP.fileType == FT_MF}.
/* Test Case 6: Select DF-TELECOM in MF */
IF {CatSelect(FID_DF_TELECOM, &FCP) == SW_OK}
THEN {FCP.fileType == FT_DF}.
/* Test Case 7: Select EF-FDN in DF-TELECOM (Linear Fixed EF) */
IF {CatSelect(FID_EF_FDN, &FCP) == SW_OK}
THEN {FCP.fileType == FT_EF}.
/* Test Case 8: Status is null*/
IF {CatSelect(FID_EF_FDN, NULL) == SW_OK}
THEN {FCP.fileType == FT_EF}.
/* Test Case 9: EF not selected after MF/DF selection */
IF {CatSelect(FID_MF, &FCP) == SW_OK}
AND {CatSelect(FID_EF_ICCID, &FCP) == SW_OK}
AND {CatSelect(FID_MF, &FCP) == SW_OK}
THEN {CatReadBinary(0, &bytes, buffer) == SW_NO_CURRENT_FILE}
AND {FCP.fileType == FT_UNKNOWN}.
/* Test Case 10: Selected file not available */
IF {CatSelect(FID_MF, &FCP) == SW_OK}
THEN {CatSelect(FID_EF_ACM, &FCP) == SW_FILE_NOT_FOUND}
AND {FCP.fileType == FT_UNKNOWN}.
/* Test Case 11: No record is selected after selecting linear fixed EF */
IF {CatSelect(FID_MF, &FCP) == SW_OK}
AND {CatSelect(FID_DF_SIMTEST, &FCP) == SW_OK}
AND {CatSelect(FID_EF_LARU, &FCP) == SW_OK}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_RECORD_NOT_FOUND}
AND {FCP.fileType == FT_EF}.
#### 6.1.1.3 Test Coverage
* * *
CRR Number Test Case Number N1 1,2, 3 N2 4 N3 5 N4 6 N5 7 N6 8 C1 9, 10, 11
C2, C3 Not Tested
* * *
### 6.1.2 CatStatus
Test Area Reference: API_CatStatus
#### 6.1.2.1 Conformance Requirements
The entry point with the following header shall be compliant to its definition
in the API.
WORD CatStatus(CatFileStatus *Status)
##### 6.1.2.1.1 Normal execution {#normal-execution-1 .H6}
CRRN1: The status information of the current EF is returned.
CRRN2: If Status is NULL the invocation is a NOP.
##### 6.1.2.1.2 Parameter errors {#parameter-errors-1 .H6}
##### 6.1.2.1.3 Context errors {#context-errors-1 .H6}
#### 6.1.2.2 Test Procedure
SET Test TO CatStatus.
/* Test Case 1: Status of MF */
IF {CatSelect(FID_MF, &FCP) == SW_OK}
AND {CatStatus(&Status) == SW_OK}
THEN {memcmp(&FCP, &Status, sizeof(CatDFStatus)) == 0}
AND {Status.fileType == FT_MF}.
/* Test Case 2: Status of EF-ICCID */
IF {CatSelect(FID_EF_ICCID, &FCP) == SW_OK}
AND {CatStatus(&Status) == SW_OK}
THEN {memcmp(&FCP, &Status, sizeof(CatEFStatus)) == 0}.
/* Test Case 3: Status of DF-TELECOM /
IF {CatSelect(FID_DF_TELECOM, &FCP) == SW_OK}
AND {CatStatus(&Status) == SW_OK}
THEN {memcmp(&FCP, &Status, sizeof(CatDFStatus)) == 0}.
/* Test Case 4: Status with NULL argument */
IF {CatStatus(NULL) == SW_OK}
THEN {NOP}.
#### 6.1.2.3 Test Coverage
* * *
CRR Number Test Case Number N1 1, 2, 3 N2 4
* * *
### 6.1.3 CatGetCHVStatus
Test Area Reference: API_CatGetCHVStatus
#### 6.1.3.1 Conformance Requirements
The entry point with the following header shall be compliant to its definition
in the API.
WORD CatGetCHVStatus(BYTE *CHV)
##### 6.1.3.1.1 Normal execution {#normal-execution-2 .H6}
CRRN1: The current CHV status information is returned.
##### 6.1.3.1.2 Parameter errors {#parameter-errors-2 .H6}
##### 6.1.3.1.3 Context errors {#context-errors-2 .H6}
#### 6.1.3.2 Test Procedure
SET Test TO CatGetCHVStatus.
/* Test Case 1: Get the ATR CHV Status */
IF {(CatGetCHVStatus(CHVStatus),SW_OK) == SW_OK}
THEN {CHVStatus[0] == 0}
AND {CHVStatus[1] == 0}
AND {CHVStatus[2] == 0}
AND {CHVStatus[3] == 0}.
#### 6.1.3.3 Test Coverage
* * *
CRR Number Test Case Number N1 1
* * *
### 6.1.4 CatReadBinary
Test Area Reference: API_CatReadBinary
#### 6.1.4.1 Conformance Requirements
The entry point with the following header shall be compliant to its definition
in the API.
WORD CatReadBinary(DWORD Offset, DWORD *Bytes, void *Buffer);
##### 6.1.4.1.1 Normal execution {#normal-execution-3 .H6}
CRRN1: If data can be accessed at the specified offset in the currently
selected transparent file, an attempt is made to read the number of bytes in
Bytes. The bytes read are returned in Buffer and the actual number of bytes
read returned in Bytes.
CRRN2: If Bytes is non-null and Buffer is null, then the number of bytes that
could be read is returned in Bytes.
CRRN3: If Bytes is null or *Bytes is zero the invocation is a NOP
##### 6.1.4.1.2 Parameter errors {#parameter-errors-3 .H6}
CRRP1: If Offset exceeds the length of the file, the status word
OUT_OF_FILE_BOUNDARIES shall be returned.
##### 6.1.4.1.3 Context errors {#context-errors-3 .H6}
CRRC1: If there is no currently selected EF, the status word NO_EF_SELECTED
shall be returned.
CRRC2: If the currently selected EF is not transparent, the status word
FILE_INCONSISTENT shall be returned.
CRRC3: If the calling application does not fulfil the access condition, READ,
to perform this function, the status word SECURITY_CONDITION_NOT_SATISFIED
shall be returned.
CRRC4: If the currently selected EF is invalidated and the file status of the
EF does not allow for the reading of an invalidated file, the status word
INVALIDATION_STATUS_CONTRADICTION shall be returned.
CRRC5: If the entry point call causes a memory problem (e.g. memory access
error), an instance the status word MEMORY_PROBLEM shall be returned.
CRRC6: If the entry point call causes an error to occur that is not expected
and thus not handled, an instance of the status word INTERNAL_ERROR shall be
returned.
#### 6.1.4.2 Test Procedure
SET Test TO CatReadBinary
AND Data TO {0x0F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF}.
/* Test Case 1: Read from EF-ICCID in MF */
IF {CatSelect(FID_EF_ICCID, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 5}
THEN {CatReadBinary(0, &bytes, buffer) == SW_OK}
AND {bytes == 5}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 2: Offset \ EOF*/
IF {CatSelect(FID_EF_ICCID, NULL) == SW_OK}
AND {bytes = 5}
THEN {CatUpdateBinary(7, bytes, Data) == SW_OK}
AND {CatReadBinary(7, &bytes, buffer) == SW_OK}
AND {bytes == 5}
AND {memcmp(Data, buffer, bytes) == 0}.
/* Test Case 3: Offset > EOF */
IF {CatSelect(FID_EF_ICCID, NULL) == SW_OK}
THEN {CatUpdateBinary(11, 5, Data) == SW_OK}
AND {CatReadBinary(11, &bytes, buffer) == SW_OK}
AND {bytes == 5}
AND {memcmp(Data, buffer, bytes) == 0}.
/* Test Case 4: Buffer is NULL */
IF {CatSelect(FID_EF_ICCID, NULL) == SW_OK}
THEN {CatUpdateBinary(0, 5, NULL) == SW_OK}.
/* Test Case 5: No EF selected */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
THEN {CatUpdateBinary(0, 5, Data) == SW_NO_CURRENT_FILE}.
/* Test Case 6: EF is not transparent */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
THEN {CatUpdateBinary(0, 5, Data) == SW_INCOMPATIBLE_FILE_STRUCTURE}.
/* Test Case 7: Access condition not fulfilled */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_TNU, NULL) == SW_OK}
THEN {CatUpdateBinary(0, 5, Data) == SW_SECURITY_STATUS_NOT_SATISFIED}.
/* Test Case 8: EF is invalidated*/
IF {CatSelect(FID_EF_TNU, NULL) == SW_OK}
AND {(CatInvalidate(), SW_OK) == SW_OK}
THEN {CatUpdateBinary(0, 5, Data) == SW_REFERENCED_DATA_INVALIDATED}.
#### 6.1.5.3 Test Coverage
* * *
CRR Number Test Case Number N1 1,2,3 P1 4 C1 5 C2 6 C3 7 C4 8 C5, C6 Not
Tested
* * *
### 6.1.6 CatReadRecord
Test Area Reference: API_CatReadRecord
#### 6.1.6.1 Conformance Requirements
The entry point with the following header shall be compliant to its definition
in the API.
UINT16 CatReadRecord(DWORD RecordNumber, CatRecordAccessModes Mode,\ DWORD
Offset, DWORD *NumBytes, void *Buffer);
##### 6.1.6.1.1 Normal execution {#normal-execution-5 .H6}
CRRN1: NumBytes bytes starting at Offset from the record specified by Mode and
RecordNumber of the currently selected linear fixed or cyclic EF are read into
Buffer.
CRRN2: If the access mode is ABSOLUTE or CURRENT:
\- if RecordNumber is not 0, the record addressed by RecordNumber will be
read;
\- if RecordNumber is 0 the current selected record will be read; and
\- the current record pointer shall not change.
CRRN3: If the access mode is NEXT:
\- the next record relative to the current selected record will be selected
and read;
\- if no current record is selected, the first record will be selected and
read;
\- if the current record pointer is set to the last record for a cyclic EF the
record pointer is set to the first record and the record is read;
\- the current record pointer of any other Application shall not be changed.
CRRN4: If the access mode is PREVIOUS:
\- the previous record relative to the current selected record will be
selected and read;
\- if no current record is selected, the last record will be selected and
read;
\- if the current record pointer is set to the first record, for a linear
fixed EF the entry point responses with an error exception and for a cyclic EF
the record pointer is set to the last record and the record is read;
\- the current record pointer of any other Application shall not be changed.
##### 6.1.6.1.2 Parameter errors {#parameter-errors-5 .H6}
CRRP1: If the currently selected EF is linear fixed and the access mode is
ABSOLUTE and RecordNumber is greater than records available, the status word
RECORD_NUMBER_NOT_AVAILABLE shall be returned
CRRP2: If the currently selected EF is linear fixed and the access mode is
CURRENT, RecordNumber is 0 and there is no current record selected, the status
word RECORD_NUMBER_NOT_AVAILABLE shall be returned.
CRRP3: If the currently selected EF is linear fixed and the access mode is
NEXT and the current record pointer is set to the last record, the status word
RECORD_NUMBER_NOT_AVAILABLE shall be returned.
CRRP4: If the currently selected EF is linear fixed and the access mode is
PREVIOUS and the current record pointer is set to the first record, the status
word RECORD_NUMBER_NOT_AVAILABLE shall be returned.
##### 6.1.6.1.3 Context errors {#context-errors-5 .H6}
CRRC1: If the calling Application has currently no EF selected, the status
word NO_EF_SELECTED shall be returned.
CRRC2: If the currently selected EF is neither linear fixed nor cyclic, the
status word FILE_INCONSISTENT shall be returned.
CRRC3: If the calling Application does not fulfil the access condition, READ,
to perform this function, the status word AC_NOT_FULFILLED shall be returned.
CRRC4: If the currently selected EF is invalidated and the file status of the
EF does not allow for reading an invalidated file, the status word
INVALIDATION_STATUS_CONTRADICTION shall be returned.
CRRC5: If the entry point call causes a memory problem (e.g. memory access
error), the status word MEMORY_PROBLEM shall be returned.
CRRC6: If the entry point call causes an error to occur that is not expected
and thus not handled, the status word INTERNAL_ERROR shall be returned.
#### 6.1.6.2 Test Procedure
SET Test TO CatReadRecord
AND Data55 TO {0x55,0x55,0x55,0x55}
AND DataAA TO {0xAA,0xAA,0xAA,0xAA}.
/* Test Case 1: Read Absolute Linear Fixed EF */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(1, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, Data55, bytes) == 0}.
/* Test Case 2: Read Current Fixed EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, Data55, bytes) == 0}.
/* Test Case 3: Read Next from Linear Fixed EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_NEXT, 0, &bytes, buffer) == SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, DataAA, bytes) == 0}.
/* Test Case 4: Read Next from Linear Fixed EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 0}
THEN {CatReadRecord(0, REC_ACC_MODE_NEXT, 0, &bytes, buffer) ==
SW_RECORD_NOT_FOUND}.
/* Test Case 5: Read Previous from Linear Fixed EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_PREVIOUS, 0, &bytes, buffer) == SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, Data55, bytes) == 0}.
/* Test Case 6: Read Previous from Linear Fixed EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 0}
THEN {CatReadRecord(0, REC_ACC_MODE_PREVIOUS, 0, &bytes, buffer) ==
SW_RECORD_NOT_FOUND}.
/* Test Case 7: Read Absolute and Current from Cyclic EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, Data55, bytes) == 0}.
/* Test Case 8: Read Next from Cyclic EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_NEXT, 0, &bytes, buffer) == SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, DataAA, bytes) == 0}.
/* Test Case 9: Read Next from Cyclic EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
THEN {CatReadRecord(0, REC_ACC_MODE_NEXT, 0, &bytes, buffer) == SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, Data55, bytes) == 0}.
/* Test Case 10: Read Previous from Cyclic EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_PREVIOUS, 0, &bytes, buffer) == SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, DataAA, bytes) == 0}.
/* Test Case 11: Read Previous from Cyclic EF */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_PREVIOUS, 0, &bytes, buffer) == SW_OK}
AND {bytes == 4}
AND {memcmp(buffer, Data55, bytes) == 0}.
/* Test Case 12: NumBytes > Record Length */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {bytes = 5}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_INCORRECT_P1_P2}.
/* Test Case 13: No current record in linear fixed EF */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {bytes = 4}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_RECORD_NOT_FOUND}.
/* Test Case 14: No EF selected */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_TNR, NULL) == SW_OK}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_INCOMPATIBLE_FILE_STRUCTURE}.
/* Test Case 15: EF is neither Cyclic nor Linear Fixed */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_NO_CURRENT_FILE}.
/* Test Case 16: Access condition not fulfilled */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LNR, NULL) == SW_OK}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_SECURITY_STATUS_NOT_SATISFIED}.
/* Test Case 17: EF is invalidated */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {(CatInvalidate(), SW_OK) == SW_OK}
THEN {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_REFERENCED_DATA_INVALIDATED}.
#### 6.1.6.3 Test Coverage
* * *
CRR Number Test Case Number N1 1,2,3,5,7,8,9,10,11 N2 1,7 N3 3,4,8,9 N4
5,6,10,11 P1 Not Tested P2 Not Tested P3 4 P4 6 C1 14 C2 15 C3 16 C4 17 C5, C6
Not Tested
* * *
### 6.1.7 CatUpdateRecord
Test Area Reference: API_CatUpdateRecord
#### 6.1.7.1 Conformance Requirements
The entry point with the following header shall be compliant to its definition
in the API.
UINT16 CatUpdateRecord(DWORD RecordNumber, CatRecordAccessModes Mode,\ DWORD
Offset, DWORD NumBytes, void *Buffer);
##### 6.1.7.1.1 Normal execution {#normal-execution-6 .H6}
CRRN1: NumBytes of data starting at Offset in the record specified by Mode and
RecordNumber of the current selected linear fixed or cyclic EF are overwritten
by the data in Buffer.
CRRN2: If the access mode is ABSOLUTE or CURRENT and the file is a linear
fixed EF:
\- the record addressed by RecordNumber will be updated;
\- if RecordNumber is 0 the current selected record will be updated; and
\- the current record pointer shall not change.
CRRN3: If the access mode is NEXT and the file is a linear fixed EF:
\- the next record relative to the current selected record will be selected
and updated;
\- if no current record is selected, the first record will be selected and
updated;
\- the current record pointer of any other application shall not be changed.
CRRN4: If the access mode is PREVIOUS:
\- the previous record relative to the current selected record will be
selected and updated;
\- if no current record is selected, the last record will be selected and
updated;
\- if a cyclic EF is updated, the oldest record will be updated independent of
the current record pointer and this record becomes record number 1 and the
current record;
\- the current record pointer of any other application shall not be changed in
case of a linear fixed EF.
##### 6.1.7.1.2 Parameter errors {#parameter-errors-6 .H6}
CRRP1: If the currently selected EF is linear fixed and the access mode is
ABSOLUTE and RecordNumber is greater than records available, the status word
RECORD_NUMBER_NOT_AVAILABLE shall be returned
CRRP2: If the currently selected EF is linear fixed and the access mode is
CURRENT, RecordNumber is 0 and there is no current record selected, the status
word RECORD_NUMBER_NOT_AVAILABLE shall be returned.
CRRP3: If the currently selected EF is linear fixed and the access mode is
NEXT and the current record pointer is set to the last record, the status word
RECORD_NUMBER_NOT_AVAILABLE shall be returned.
CRRP4: If the currently selected EF is linear fixed and the access mode is
PREVIOUS and the current record pointer is set to the first record, the status
word RECORD_NUMBER_NOT_AVAILABLE shall be returned.
CRRP5: If the currently selected EF is linear fixed and Offset plus NumBytes
is greater than the record length, then the status word OUT_OF_FILE_BOUNDARIES
shall be returned.
##### 6.1.7.1.3 Context errors {#context-errors-6 .H6}
CRRC1: If the calling Application has currently no EF selected, the status
word NO_EF_SELECTED shall be returned.
CRRC2: If the currently selected EF is neither linear fixed nor cyclic, the
status word FILE_INCONSISTENT shall be returned.
CRRC3: If the calling Application does not fulfil the access condition,
UPDATE, to perform this function, the status word AC_NOT_FULFILLED shall be
returned.
CRRC4: If the currently selected EF is invalidated and the file status of the
EF does not allow for reading an invalidated file, the status word
INVALIDATION_STATUS_CONTRADICTION shall be returned.
CRRC5: If the entry point call causes a memory problem (e.g. memory access
error), the status word MEMORY_PROBLEM shall be returned.
CRRC6: If the entry point call causes an error to occur that is not expected
and thus not handled, the status word INTERNAL_ERROR shall be returned.
#### 6.1.7.2 Test Procedure
SET Test TO CatUpdateRecord
AND Data TO {1,2,3,4}.
/* Test Case 1: Update Absolute Record in Linear Fixed EF */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatUpdateRecord(1, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, bytes, Data) ==
SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 2: Update Current Record in Linear Fixed EF */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatUpdateRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, bytes, Data) ==
SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 3: Update Next from Linear Fixed EF, no record pointer set */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatUpdateRecord(0, REC_ACC_MODE_NEXT, 0, bytes, Data) == SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 4: Update Next from Linear Fixed EF, record pointer set */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
AND {CatReadRecord(1, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
THEN {CatUpdateRecord(0, REC_ACC_MODE_NEXT, 0, bytes, Data) == SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 5: Update Next from Linear Fixed EF, no more records */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {bytes = 4}
THEN {CatUpdateRecord(0, REC_ACC_MODE_NEXT, 0, bytes, Data) ==
SW_RECORD_NOT_FOUND}.
/* Test Case 6: Update Previous from Linear Fixed EF, no record pointer set */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatUpdateRecord(0, REC_ACC_MODE_PREVIOUS, 0, bytes, Data) == SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 7: Update Previous from Linear Fixed EF, record pointer set */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
AND {CatReadRecord(2, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
THEN {CatUpdateRecord(0, REC_ACC_MODE_PREVIOUS, 0, bytes, Data) == SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 8: Update Previous from Linear Fixed EF, no more records */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
AND {CatReadRecord(1, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
THEN {CatUpdateRecord(0, REC_ACC_MODE_PREVIOUS, 0, bytes, Data) ==
SW_RECORD_NOT_FOUND}.
/* Test Case 9: Update Previous from Cyclic EF */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_CARU, NULL) == SW_OK}
AND {memset(buffer, 0, sizeof(buffer))}
AND {bytes = 4}
THEN {CatUpdateRecord(0, REC_ACC_MODE_PREVIOUS, 0, bytes, Data) == SW_OK}
AND {bytes == 4}
AND {CatReadRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, &bytes, buffer) ==
SW_OK}
AND {memcmp(buffer, Data, bytes) == 0}.
/* Test Case 10: No EF selected */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
THEN {CatUpdateRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, bytes, buffer) ==
SW_NO_CURRENT_FILE}.
/* Test Case 11: Update Absolute from Linear Fixed EF beyond Records */
IF {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {bytes = 5}
THEN {CatUpdateRecord(3, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, bytes, buffer) ==
SW_INCORRECT_P1_P2}.
/* Test Case 12: No current record in linear fixed EF, update current */
IF {CatSelect(FID_DF_SIMTEST, NULL) == SW_OK}
AND {CatSelect(FID_EF_LARU, NULL) == SW_OK}
AND {bytes = 4}
THEN {CatUpdateRecord(0, REC_ACC_MODE_ABSOLUTE_CURRENT, 0, bytes, buffer) ==
SW_RECORD_NOT_FOUND}.
/* Test Case 13: Record Length \ ::= [ \ **\n**] +
\ ::= \ \| \ \| _\ _
\ ::= \ \| \ \| \ \| \
\ ::= **RST**
\ ::= **INI** _\ _
\ ::= **CMD** _\ _ [ \ ] ( \ )
\ ::= **[** _\ _ **]**
\ ::= **(** _\ _ **)**
\ ::= **REM** _\ _
\ ::= **SWI {** [\] + **}**
\ ::= \ **: \n** \
Description of syntax metalanguage :
**\n** represents a linebreak
[ x ] means x can appear optionally
[ x ] + means 1 or more appearances of x
x \| y means x or y
**[]{}:** (bold) these are characters that appear literally in the script
files
_\ _ any character until the end of the line
_\ _ a line containing no text is acceptable
_\ _ data written in hexadecimal, each byte separated from the
following by a whitespace
Each simple statement beginning with 3 characters different than the ones
defined indicates another tool command, and shall be ignored by the parser if
not recognised.
\' \', \'\t\' : Can be used as separator
A long statement can be broken into several lines by using the character
\'**\** \' at the end of each line which is not the last one in the statement.
For more details refer to the examples in A.3.
# A.2 Semantics
Following is the meaning of each of the statements:
**CMD** : Sends an APDU Command to the card, including (optionally) the
expected response data and also (optionally) the expected status words SW1,
SW2.
**RST** : Resets and powers on the card
**INI** : Performs the terminal profile with the following data. Afterwards,
it shall perform all the fetch and terminal response commands until there is
no proactive session in progress.
**REM** : Used for comments
**SWI** : Activates a switch condition. Every labelled list represents a list
of statements to be executed, if the label matches the SW resulting from the
previously executed command.
Evaluation of expected response and status in the case of a CMD:
\ data within **[**...**]** has to be checked, it needs to be
present for an outgoing command. Bytes written as XX shall not be checked by
the APDU tool.
\ status contained within **(**...**)** has to be checked; when
several status are valid they shall be separated by commas. Bytes written as
XX shall not be checked by the APDU tool.
# A.3 Example
REM this is an example
RST
INI FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
REM Case 1 example
CMD A0 C2 00 00 00 (91 33 , 69 XX)
REM Case 2 example
CMD A0 B6 00 00 07 \
[XX XX XX 55 55 XX 55] \
(91 33 , 67 XX)
CMD A0 B6 00 00 07 \
(91 33 , 67 XX)
CMD A0 C0 00 00 1F \
[10 A0 00 00 00 09 00 02 FF FF FF FF 89 28 A4 05 \
02 0D CC CC CC CC CC CC CC CC CC CC CC CC CC ] \
(90 00)
REM Case 3 example
CMD A0 C2 00 00 33 \
D1 31 82 02 83 81 06 05 80 11 22 33 44 8B 24 40 \
08 00 24 23 85 18 41 04 51 10 10 00 00 00 00 13 \
02 70 00 00 0E 0D 00 00 00 00 28 A4 05 00 00 00 \
00 00 00 \
(90 00)
REM Case 4 example with switch statement
CMD 00 A4 04 00 10 \
A0 00 00 00 09 00 02 FF FF FF FF 89 41 04 44 02 \
(61 XX, 6A 82)
SWI {
61 XX:
CMD 00 C0 00 00 14 \
[10 A0 00 00 00 09 00 02 FF FF FF FF 89 41 04 44 \
02 02 CC CC] \
(90 00)
CMD A0 A4 00 00 02 \
3F 00
6A 82:
RST
}
## A.4 Style and formatting
In order to show a common appearance all the scripts shall follow those format
rules:
− start always with a \'RST\' followed by an \'INI\' command.
− The command, data to be checked and status to be checked shall be presented
in the following order:
CMD COMMAND [EXPECTED DATA] (EXPECTED STATUS)
− APDU shall be presented with command (CLA INS P1 P2 P3) in one line and data
(if present) in next line grouped 16 bytes per line (see example above).
− The expected data (if present) shall be presented in 16 bytes groups per
line (see example above).
###### ## Annex B (normative): Default Prepersonalisation
# B.1 General Default Prepersonalisation
This table shows the default prepersonalisation, the file system and the
files\' content, that the test SIM cards shall contain unless otherwise
stated.
+-------------+------------+-------------------+-------------------+ | Name | Identifier | Default Value | Special Features | +-------------+------------+-------------------+-------------------+ | EF~ICCID~ | 2FE2 | 0F FF FF FF FF FF | This value is not | | | | FF FF FF FF | compliant with | | | | | GSM 11.11 | +-------------+------------+-------------------+-------------------+ | EF~IMSI~ | 6F07 | FF FF FF FF FF FF | This value is not | | | | FF FF FF | compliant with | | | | | GSM 11.11 | +-------------+------------+-------------------+-------------------+ | EF~LP~ | 6F05 | 01 FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~Kc~ | 6F20 | FF FF FF FF FF FF | | | | | FF FF 07 | | +-------------+------------+-------------------+-------------------+ | EF~PLMNsel~ | 6F30 | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~HPLMN~ | 6F31 | 05 | | +-------------+------------+-------------------+-------------------+ | EF~ACMmax~ | 6F37 | 00 00 00 | Access condition | | | | | UPDATE: CHV1 | +-------------+------------+-------------------+-------------------+ | EF~SST~ | 6F38 | FF 3F C3 03 0C 00 | | | | | FF 0F 00 33 | | +-------------+------------+-------------------+-------------------+ | EF~ACM~ | 6F39 | 00 00 00 | Access condition | | | | | UPDATE: CHV1 | +-------------+------------+-------------------+-------------------+ | EF~PUCT~ | 6F41 | FF FF FF 00 00 | Access condition | | | | | UPDATE: CHV1 | +-------------+------------+-------------------+-------------------+ | EF~BCCH~ | 6F74 | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~ACC~ | 6F78 | 00 00 | | +-------------+------------+-------------------+-------------------+ | EF~FPLMN~ | 6F7B | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~LOCI~ | 6F7E | FF FF FF FF 00 F0 | | | | | 00 00 00 FF 01 | | +-------------+------------+-------------------+-------------------+ | EF~AD~ | 6FAD | 00 FF FF | | +-------------+------------+-------------------+-------------------+ | EF~Phase~ | 6FAE | 03 | | +-------------+------------+-------------------+-------------------+ | EF~FDN~ | 6F3B | Default value in | Records: 5 | | | | all the records: | | | | | | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~SMSP~ | 6F42 | FF FF FF FF FF FF | Records: 1 | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~LND~ | 6F44 | FF FF FF FF FF FF | Records: 1 | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~SMSS~ | 6F43 | FF FF | | +-------------+------------+-------------------+-------------------+ | EF~SMS~ | 6F3C | 1^st^ record: 00 | Records: 3 | | | | FF ... FF(length | | | | | 176) | | | | | | | | | | 2^nd^ record:00 | | | | | FF ... FF(length | | | | | 176) | | | | | | | | | | 3^rd^ record: 00 | | | | | FF ... FF(length | | | | | 176) | | +-------------+------------+-------------------+-------------------+ | EF~ADN~ | 6F3A | FF FF FF FF FF FF | Records: 1 | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~CCP~ | 6F3D | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF | | +-------------+------------+-------------------+-------------------+ | EF~MSISDN~ | 6F40 | FF FF FF FF FF FF | Records: 1 | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~SDN~ | 6F49 | FF FF FF FF FF FF | Records: 1 | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF FF FF | | | | | FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~SUME~ | 6F54 | 85 0C 54 4F 4F 4C | | | | | 4B 49 54 20 54 45 | | | | | 53 54 FF FF FF FF | | +-------------+------------+-------------------+-------------------+ | EF~CBMI~ | 6F45 | FF FF | | +-------------+------------+-------------------+-------------------+ | EF~IM~ | 4F20 | FF FF FF FF FF FF | | | | | FF FF FF FF FF | | +-------------+------------+-------------------+-------------------+
The default value for the CHV1 shall be \"0x31 0x31 0x31 0x31 0xFF 0xFF 0xFF
0xFF\" and its state shall be \'disabled\' during test Applications execution.
# B.2 File System Access Default Prepersonalisation
## B.2.1 DF~SIMTEST~ (SIM Test)
Identifier: \'3113\'
## B.2.2 EF~TNR~ (Transparent Never Read)
+----------------------+------------------------+---------------+-----+---------+ | Identifier: \'6F01\' | Structure: transparent | Mandatory | | | +----------------------+------------------------+---------------+-----+---------+ | File size: 3 bytes | Update activity: low | | | | +----------------------+------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ NEVER | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +----------------------+------------------------+---------------+-----+---------+ | Bytes | Description | Default Value | M/O | Length | +----------------------+------------------------+---------------+-----+---------+ | 1 -- 3 | Test Data | AA AA AA | M | 3 bytes | +----------------------+------------------------+---------------+-----+---------+
## B.2.3 EF~TNU~ (Transparent Never Update)
+----------------------+------------------------+---------------+-----+---------+ | Identifier: \'6F02\' | Structure: transparent | Mandatory | | | +----------------------+------------------------+---------------+-----+---------+ | File size: 3 bytes | Update activity: low | | | | +----------------------+------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE NEVER | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +----------------------+------------------------+---------------+-----+---------+ | Bytes | Description | Default Value | M/O | Length | +----------------------+------------------------+---------------+-----+---------+ | 1 -- 3 | Test Data | 55 55 55 | M | 3 bytes | +----------------------+------------------------+---------------+-----+---------+
## B.2.4 EF~TARU~ (Transparent Always Read and Update)
+----------------------+------------------------+---------------+-----+-----------+ | Identifier: \'6F03\' | Structure: transparent | Mandatory | | | +----------------------+------------------------+---------------+-----+-----------+ | File size: 260 bytes | Update activity: low | | | | +----------------------+------------------------+---------------+-----+-----------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +----------------------+------------------------+---------------+-----+-----------+ | Bytes | Description | Default Value | M/O | Length | +----------------------+------------------------+---------------+-----+-----------+ | 1 -- 260 | Test Data | FF ... FF | M | 260 bytes | +----------------------+------------------------+---------------+-----+-----------+
## B.2.5 EF~CNR~ (Cyclic Never Read)
+------------------------+-----------------------+---------------+-----+---------+ | Identifier: \'6F04\' | Structure: cyclic | Mandatory | | | +------------------------+-----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: high | | | | +------------------------+-----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ NEVER | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+
## B.2.6 EF~CNU~ (Cyclic Never Update)
+------------------------+-----------------------+---------------+-----+---------+ | Identifier: \'6F05\' | Structure: cyclic | Mandatory | | | +------------------------+-----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: high | | | | +------------------------+-----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE NEVER | | | | | | | | | | | | INCREASE NEVER | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+
## B.2.7 EF~CNIC~ (Cyclic Never Increase)
+------------------------+-----------------------+---------------+-----+---------+ | Identifier: \'6F06 | Structure: cyclic | Mandatory | | | +------------------------+-----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: high | | | | +------------------------+-----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE NEVER | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+
## B.2.8 EF~CNIV~ (Cyclic Never Invalidate)
+------------------------+-----------------------+---------------+-----+---------+ | Identifier: \'6F07 | Structure: cyclic | Mandatory | | | +------------------------+-----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: high | | | | +------------------------+-----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE NEVER | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+
## B.2.9 EF~CNRH~ (Cyclic Never Rehabilitate)
+------------------------+-----------------------+---------------+-----+---------+ | Identifier: \'6F08\' | Structure: cyclic | Mandatory | | | +------------------------+-----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: high | | | | +------------------------+-----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE NEVER | | | | | +------------------------+-----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+
## B.2.10 EF~CARU~ (Cyclic Always Read and Update)
+------------------------+-----------------------+---------------+-----+---------+ | Identifier: \'6F09\' | Structure: cyclic | Mandatory | | | +------------------------+-----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: high | | | | +------------------------+-----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-----------------------+---------------+-----+---------+ | 1 | Test Data | 55 55 55 | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+ | 2 | Test Data | AA AA AA | M | 3 bytes | +------------------------+-----------------------+---------------+-----+---------+
## B.2.11 EF~LNR~ (Linear Fixed Never Read)
+------------------------+-------------------------+---------------+-----+---------+ | Identifier: \'6F0A\' | Structure: linear fixed | Mandatory | | | +------------------------+-------------------------+---------------+-----+---------+ | Record length: 4 bytes | Update activity: low | | | | +------------------------+-------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ NEVER | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-------------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-------------------------+---------------+-----+---------+ | 1 | Test Data -- Record 1 | FF FF FF FF | M | 4 bytes | +------------------------+-------------------------+---------------+-----+---------+ | 2 | Test Data -- Record 2 | FF FF FF FF | M | 4 bytes | +------------------------+-------------------------+---------------+-----+---------+
## B.2.12 EF~LNU~ (Linear Fixed Never Update)
+------------------------+-------------------------+---------------+-----+---------+ | Identifier: \'6F0B\' | Structure: linear fixed | Mandatory | | | +------------------------+-------------------------+---------------+-----+---------+ | Record length: 4 bytes | Update activity: low | | | | +------------------------+-------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE NEVER | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-------------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-------------------------+---------------+-----+---------+ | 1 | Test Data -- Record 1 | FF FF FF FF | M | 4 bytes | +------------------------+-------------------------+---------------+-----+---------+ | 2 | Test Data -- Record 2 | FF FF FF FF | M | 4 bytes | +------------------------+-------------------------+---------------+-----+---------+
## B.2.13 EF~LARU~ (Linear Fixed Always Read and Update)
+------------------------+-------------------------+---------------+-----+---------+ | Identifier: \'6F0C\' | Structure: linear fixed | Mandatory | | | +------------------------+-------------------------+---------------+-----+---------+ | Record length: 4 bytes | Update activity: low | | | | +------------------------+-------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+-------------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+-------------------------+---------------+-----+---------+ | 1 | Test Data -- Record 1 | 55 55 55 55 | M | 4 bytes | +------------------------+-------------------------+---------------+-----+---------+ | 2 | Test Data -- Record 2 | AA AA AA AA | M | 4 bytes | +------------------------+-------------------------+---------------+-----+---------+
## B.2.14 EF**CINA** (Cyclic Increase Not Allowed)
+-----------------+-----------------+---------------+-----+---------+ | Identifier: | Structure: | Mandatory | | | | \'6F0D\' | cyclic | | | | +-----------------+-----------------+---------------+-----+---------+ | Record length: | Update | | | | | 3 bytes | activity: high | | | | +-----------------+-----------------+---------------+-----+---------+ | Access | | | | | | Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | (see note 1) | | | | | | | | | | | | INVALIDATE | | | | | | ALWAYS | | | | | | | | | | | | REHABILITATE | | | | | | ALWAYS | | | | | +-----------------+-----------------+---------------+-----+---------+ | Logical Record | Description | Default Value | M/O | Length | | Number | | | | | +-----------------+-----------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +-----------------+-----------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +-----------------+-----------------+---------------+-----+---------+ | Note 1: This | | | | | | file will be | | | | | | personalised in | | | | | | a way such that | | | | | | increase is not | | | | | | allowed, as | | | | | | indicated by | | | | | | the FCI byte 8, | | | | | | bit 7 (GSM | | | | | | 11.11: FCI | | | | | | structure of an | | | | | | EF returned by | | | | | | the SELECT | | | | | | command) | | | | | +-----------------+-----------------+---------------+-----+---------+
## B.2.15 EF**TRAC** (Transparent Read Access Condition CHV2)
+------------------------+------------------------+---------------+-----+---------+ | Identifier: \'6F0E\' | Structure: transparent | Mandatory | | | +------------------------+------------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: low | | | | +------------------------+------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ CHV2 | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+------------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+------------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+------------------------+---------------+-----+---------+
## B.2.16 EF**TIAC** (Transparent Invalidate Access Condition CHV1)
+------------------------+------------------------+---------------+-----+---------+ | Identifier: \'6F0F\' | Structure: transparent | Mandatory | | | +------------------------+------------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: low | | | | +------------------------+------------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE CHV1 | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+------------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+------------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+------------------------+---------------+-----+---------+
## B.2.17 EF**CIAC** (Cyclic Increase Access Condition CHV2)
+------------------------+----------------------+---------------+-----+---------+ | Identifier: \'6F10\' | Structure: cyclic | Mandatory | | | +------------------------+----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: low | | | | +------------------------+----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE CHV2 | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+----------------------+---------------+-----+---------+
## B.2.18 EF**CIAA** (Cyclic Increase Access Condition ADM)
+------------------------+----------------------+---------------+-----+---------+ | Identifier: \'6F11\' | Structure: cyclic | Mandatory | | | +------------------------+----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: low | | | | +------------------------+----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ADM | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE ALWAYS | | | | | +------------------------+----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+----------------------+---------------+-----+---------+
## B.2.19 EF**CNRI** (Cyclic Never Rehabilitate Invalidated)
+------------------------+----------------------+---------------+-----+---------+ | Identifier: \'6F12\' | Structure: cyclic | Mandatory | | | +------------------------+----------------------+---------------+-----+---------+ | Record length: 3 bytes | Update activity: low | | | | +------------------------+----------------------+---------------+-----+---------+ | Access Conditions: | | | | | | | | | | | | READ ALWAYS | | | | | | | | | | | | UPDATE ALWAYS | | | | | | | | | | | | INCREASE ALWAYS | | | | | | | | | | | | INVALIDATE ALWAYS | | | | | | | | | | | | REHABILITATE NEVER | | | | | +------------------------+----------------------+---------------+-----+---------+ | Logical Record Number | Description | Default Value | M/O | Length | +------------------------+----------------------+---------------+-----+---------+ | 1 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+----------------------+---------------+-----+---------+ | 2 | Test Data | 00 00 00 | M | 3 bytes | +------------------------+----------------------+---------------+-----+---------+
The file status shall be invalidated as defined in [12]
#