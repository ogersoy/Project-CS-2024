# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
When 64 kbit/s traffic channels are used on the Abis interface, the speech
shall be coded according to CCITT Recommendation G.711 and the data rate
adaptation shall be as specified in 3GPP TS 44.021 and 3GPP TS 48.020.
In the case where 16 kbit/s traffic channels are used for full rate speech,
enhanced full rate speech, Adaptive Multi-Rate speech, Adaptive Multi-Rate
Wideband speech or full rate data service, then the present document shall
apply for frame structure and for control of remote transcoders and additional
rate adaptors.
For Adaptive Multi-Rate speech the present document specifies the 16 kBit/s
submultiplexing, both for the full and the half rate traffic channels
(TCH/AFS, TCH/AHS, TCH/WFS and O-TCH/WHS). The specification for 8 kBit/s
submultiplexing is given in 3GPP TS 48.061, both for the full and the half
rate traffic channels (TCH/AFS and TCH/AHS).
Additionally, the present document specifies the 32 kBit/s submultiplexing for
Adaptive Multi-Rate Wideband speech. However it reuses the frame structure of
the 16 kBit/s submultiplexing for Adaptive Multi-Rate speech.
The use and general aspects of the Abis interface are given in 3GPP TS 48.051.
NOTE: The present document should be considered together with the 3GPP TS 06
series of specifications, 3GPP TS 44.021 (Rate Adaptation on the MS-BSS
Interface) and 3GPP TS 48.020 (Rate Adaptation on the BS/MSC Interface).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TS 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 44.006: \"Mobile Station - Base Station System (MS - BSS)
interface Data Link (DL) layer specification\".
[3] 3GPP TS 44.021: \"Rate adaption on the Mobile Station
[4] Void.
[5] 3GPP TS 46.010: \"Full rate speech; Transcoding\".
[6] 3GPP TS 46.011: \"Full rate speech; Substitution and muting of lost frames
for full rate speech channels\".
[7] 3GPP TS 46.012: \"Full rate speech; Comfort noise aspect for full rate
speech traffic channels\".
[8] 3GPP TS 46.031: \"Full rate speech; Discontinuous Transmission (DTX) for
full rate speech traffic channels\".
[9] 3GPP TS 46.032: \"Voice Activity Detector (VAD)\".
[10] 3GPP TS 48.020: \"Rate adaption on the Base Station System ‑
Mobile‑services Switching Centre (BSS ‑ MSC) interface\".
[11] 3GPP TS 48.051: \"Base Station Controller ‑ Base Transceiver Station (BSC
‑ BTS) interface; General aspects\".
[12] 3GPP TS 48.054: \"Base Station Controller - Base Transceiver Station (BSC
- BTS) interface Layer 1 structure of physical circuits\".
[13] 3GPP TS 48.058: \"Base Station Controller ‑ Base Transceiver Station (BSC
‑ BTS) interface; Layer 3 specification\".
[14] 3GPP TS 12.21: \"Network Management (NM) procedures and message on the
A-bis interface\".
[15] CCITT Recommendation G.711: \"Pulse code modulation (PCM) of voice
frequencies\".
[16] CCITT Recommendation I.460: \"Multiplexing, rate adaption and support of
existing interfaces\".
[17] CCITT Recommendation V.110: \"Support of data terminal equipments (DTEs)
with V-Series interfaces by an integrated services digital network\".
[18] Void.
[19] 3GPP TS 46.060: \"Enhanced Full rate speech transcoding\".
[20] 3GPP TS 46.061: \"Substitution and muting of lost frames for Enhanced
Full rate speech channels\".
[21] 3GPP TS 46.062: \"Comfort noise aspect for Enhanced Full rate speech
traffic channels\".
[22] 3GPP TS 46.081: \"Discontinuous Transmission (DTX) for Enhanced Full rate
speech traffic channel\".
[23] 3GPP TS 46.082: \"Voice Activity Detection (VAD)\".
[24] Void.
[25] 3GPP TS 26.090: \"Adaptive Multi-Rate speech transcoding\".
[26] 3GPP TS 26.091: \"Substitution and muting of lost frames for Adaptive
Multi-Rate speech traffic channels\".
[27] 3GPP TS 26.092: \"Comfort noise aspect for Adaptive Multi-Rate speech
traffic channels\".
[28] 3GPP TS 26.093: \"Discontinuous Transmission (DTX) for Adaptive Multi-
Rate speech traffic channels\".
[29] 3GPP TS 26.094: \"Voice Activity Detection (VAD) for Adaptive Multi-Rate
speech traffic channels \".
[30] 3GPP TS 45.009: \"Link Adaptation\".
[31] 3GPP TS 48.061: \"Inband control of remote transcoders and rate adaptors
(half rate)\".
[32] 3GPP TS 28.062: \"Inband Tandem Free Operation (TFO) of Speech Codecs\".
[33] 3G 26.171: \"Digital cellular telecommunications system; Adaptive Multi-
Rate Wideband speech processing functions, General Description.\"
[34] 3G 26.190: \"Digital cellular telecommunications system; Adaptive Multi-
Rate Wideband speech transcoding\".
[35] 3G 26.191: \"Digital cellular telecommunications system; Substitution and
muting of lost frames for Adaptive Multi-Rate Wideband speech traffic
channels\".
[36] 3G 26.192: \"Digital cellular telecommunications system; Comfort noise
aspect for Adaptive Multi-Rate Wideband speech traffic channels\".
[37] 3G 26.193: \"Digital cellular telecommunications system; Discontinuous
Transmission (DTX) for Adaptive Multi-Rate Wideband speech traffic channels\".
[38] 3G 26.194: \"Digital cellular telecommunications system; Voice Activity
Detection (VAD) for Adaptive Multi-Rate Wideband speech traffic channels \".
# 3 Abbreviations
Abbreviations used in the present document are listed in 3GPP TS 21.905.
Additionally:
AMR Adaptive Multi-Rate\ AMR-WB Adaptive Multi-Rate Wideband\ CMC
Codec_Mode_Command\ CMI Codec_Mode_Indication\ CMR Codec_Mode_Request\ Onset
Speech Onset Frame Classification\ PAB Phase Alignment Bit\ PAC Phase
Alignment Command\ RATSCCH Robust AMR Traffic Synchronised Control CHannel\
RIF Request or Indication Flag\ TAC Time Alignment Command\ TAE Time Alignment
Extension\ TFO Tandem Free Operation\ TFOE TFO Enable\ UFE Uplink Frame Error
# 4 General Approach
When the transcoders/rate adaptors are positioned remote to the BTS, the
information between the Channel Codec Unit (CCU) and the remote
Transcoder/Rate Adaptor Unit (TRAU) is transferred in frames with a fixed
length of 320 bits (20 ms). In the present document, these frames are denoted
\"TRAU frames\". Within these frames, both the speech/data and the TRAU
associated control signals are transferred.
The Abis interface should be the same if the transcoder is positioned 1) at
the MSC site of the BSS or if it is positioned 2) at the BSC site of the BSS.
In case 1), the BSC should be considered as transparent for 16 kbit/s
channels.
In case of 4,8 and 9,6 kbit/s channel coding when data is adapted to the 320
bit frames, a conversion function is required in addition to the
conversion/rate adaption specified in 3GPP TS 48.020. This function
constitutes the RAA. In case of 14,5 kbit/s channel coding, no RAA rate
adaption is required because V.110 framing is not used.
The TRAU is considered a part of the BSC, and the signalling between the BSC
and the TRAU (e.g. detection of call release, handover and transfer of O&M
information) may be performed by using BSC internal signals. The signalling
between the CCU and the TRAU, using TRAU frames as specified in the present
document, is mandatory when the Abis interface is applied.
NOTE: If standard 64 kbit/s switching is used in the BSC, multiplexing
according to CCITT Recommendation I.460 should apply at both sides of the
switch.
In figure 4.1, a possible configuration of the TRAU and the CCU is shown.
The functions inside the TRAU are:
\- \"Remote Transcoder and Rate Adaptor Control Function\" (RTRACF);
\- \"Remote Speech Handler Function\" (RSHF);
\- The RAA function in case of 4.8 and 9.6 kbit/s channel coding;
\- The RAA' function in case of 14.5 kbit/s channel coding;
\- The RA2 function;
\- The transcoder function.
\- Optionally the TFO functions (see 3GPP TS 28.062).
The functions inside the CCU are:
\- \"Transcoder and Rate Adaptor Control Function\" (TRACF);
\- \"Speech Handler Function\" (SHF);
\- The RAA function in case of 4.8 and 9.6 kbit/s channel coding;
\- The RA1/RA1\' function in case of 4.8 and 9.6 kbit/s channel coding;
\- The RA1'/RAA' function in case of 14.5 kbit/s channel coding;
\- The channel codec function;
\- If AMR or AMR-WB is supported, the Link Adaptation (see 3GPP TS 45.009).
The present document will not describe the procedures inside the TRAU and the
CCU. The layout in figure 4.1 is only intended as a reference model.
Figure 4.1: Functional entities for handling of remote control of remote
transcoders and rate adaptors
NOTE: This figure applies only for 4,8 and 9,6 kbit/s channel coding.
# 5 Frame Structure
## 5.1 Frames for Speech Services
### 5.1.1 Frames for Full Rate and Enhanced Full Rate Speech
* * *
                                  **Bit number**
**Octet no.** **1** **2** **3** **4** **5** **6** **7** **8** **0** 0 0 0 0 0
0 0 0 **1** 0 0 0 0 0 0 0 0 **2** 1 C1 C2 C3 C4 C5 C6 C7 **3** C8 C9 C10 C11
C12 C13 C14 C15 **4** 1 D1 D2 D3 D4 D5 D6 D7 **5** D8 D9 D10 D11 D12 D13 D14
D15 **6** 1 D16 D17 D18 D19 D20 D21 D22 **7** D23 D24 D25 D26 D27 D28 D29 D30
**8** 1 D31 D32 D33 D34 D35 D36 D37 **9** D38 D39 D40 D41 D42 D43 D44 D45
**10** 1 D46 D47 D48 D49 D50 D51 D52 **11** D53 D54 D55 D56 D57 D58 D59 D60
**12** 1 D61 D62 D63 D64 D65 D66 D67 **13** D68 D69 D70 D71 D72 D73 D74 D75
**14** 1 D76 D77 D78 D79 D80 D81 D82 **15** D83 D84 D85 D86 D87 D88 D89 D90
**16** 1 D91 D92 D93 D94 D95 D96 D97 **17** D98 D99 D100 D101 D102 D103 D104
D105 **18** 1 D106 D107 D108 D109 D110 D111 D112 **19** D113 D114 D115 D116
D117 D118 D119 D120 **20** 1 D121 D122 D123 D124 D125 D126 D127 **21** D128
D129 D130 D131 D132 D133 D134 D135 **22** 1 D136 D137 D138 D139 D140 D141 D142
**23** D143 D144 D145 D146 D147 D148 D149 D150 **24** 1 D151 D152 D153 D154
D155 D156 D157 **25** D158 D159 D160 D161 D162 D163 D164 D165 **26** 1 D166
D167 D168 D169 D170 D171 D172 **27** D173 D174 D175 D176 D177 D178 D179 D180
**28** 1 D181 D182 D183 D184 D185 D186 D187 **29** D188 D189 D190 D191 D192
D193 D194 D195 **30** 1 D196 D197 D198 D199 D200 D201 D202 **31** D203 D204
D205 D206 D207 D208 D209 D210 **32** 1 D211 D212 D213 D214 D215 D216 D217
**33** D218 D219 D220 D221 D222 D223 D224 D225 **34** 1 D226 D227 D228 D229
D230 D231 D232 **35** D233 D234 D235 D236 D237 D238 D239 D240 **36** 1 D241
D242 D243 D244 D245 D246 D247 **37** D248 D249 D250 D251 D252 D253 D254 D255
**38** 1 D256 D257 D258 D259 D260 C16 C17 **39** C18 C19 C20 C21 T1 T2 T3 T4
* * *
### 5.1.2 Frames for Adaptive Multi-Rate Speech (AMR-NB)
* * *
                                  **Bit number**
**Octet no.** **1** **2** **3** **4** **5** **6** **7** **8** **0** 0 0 0 0 0
0 0 0 **1** 0 0 0 0 0 0 0 0 **2** 1 C1 C2 C3 C4 C5 C6 C7 **3** C8 C9 C10 C11
C12 C13 C14 C15 **4** 1 C16 C17 C18 C19 C20 C21 C22 **5** C23 C24 C25 D1 D2 D3
D4 D5 **6** 1 D6 D7 D8 D9 D10 D11 D12 **7** D13 D14 D15 D16 D17 D18 D19 D20
**8** 1 D21 D22 D23 D24 D25 D26 D27 **9** D28 D29 D30 D31 D32 D33 D34 D35
**10** 1 D36 D37 D38 D39 D40 D41 D42 **11** D43 D44 D45 D46 D47 D48 D49 D50
**12** 1 D52 D52 D53 D54 D55 D56 D57 **13** D58 D59 D60 D61 D62 D63 D64 D65
**14** 1 D66 D67 D68 D69 D70 D71 D72 **15** D73 D74 D75 D76 D77 D78 D79 D80
**16** 1 D81 D82 D83 D84 D85 D86 D87 **17** D88 D89 D90 D91 D92 D93 D94 D95
**18** 1 D96 D97 D98 D99 D100 D101 D102 **19** D103 D104 D105 D106 D107 D108
D109 D110 **20** 1 D111 D112 D113 D114 D115 D116 D117 **21** D118 D119 D120
D121 D122 D123 D124 D125 **22** 1 D126 D127 D128 D129 D130 D131 D132 **23**
D133 D134 D135 D136 D137 D138 D139 D140 **24** 1 D141 D142 D143 D144 D145 D146
D147 **25** D148 D149 D150 D151 D152 D153 D154 D155 **26** 1 D156 D157 D158
D159 D160 D161 D162 **27** D163 D164 D165 D166 D167 D168 D169 D170 **28** 1
D171 D172 D173 D174 D175 D176 D177 **29** D178 D179 D180 D181 D182 D183 D184
D185 **30** 1 D186 D187 D188 D189 D190 D191 D192 **31** D193 D194 D195 D196
D197 D198 D199 D200 **32** 1 D201 D202 D203 D204 D205 D206 D207 **33** D208
D209 D210 D211 D212 D213 D214 D215 **34** 1 D216 D217 D218 D219 D220 D221 D222
**35** D223 D224 D225 D226 D227 D228 D229 D230 **36** 1 D231 D232 D233 D234
D235 D236 D237 **37** D238 D239 D240 D241 D242 D243 D244 D245 **38** 1 D246
D247 D248 D249 D250 D251 D252 **39** D253 D254 D255 D256 T1 T2 T3 T4
* * *
### 5.1.3 Frames for Adaptive Multi-Rate Wideband Speech (AMR-WB) (16 kbit/s)
The frame format for AMR-NB shall be used for all frames for AMR-WB as well,
see chapters 5.1.2 and 5.5.1.3.
### 5.1.4 Frames for Adaptive Multi-Rate Wideband Speech (AMR-WB) (32 kbit/s)
The frame format for AMR-NB shall be used for all frames for AMR-WB as well,
see chapters 5.1.2 and 5.5.1.3. In case of the AMR-WB modes 15.85 and 23.85
two 16kbit/s frames (channel "a" and channel "b") are used to compose a
32kbit/s frame.
### 5.1.5 Frames for Speech Codec Configuration Exchange
* * *
                  **\                                                            
                  Bit number**
**Octet no.** **1** **2** **3** **4** **5** **6** **7** **8**
**0** 0 0 0 0 0 0 0 0
**1** 0 0 0 0 0 0 0 0
**2** 1 C1 C2 C3 C4 C5 D1 D2
**3** D3 D4 D5 D6 D7 D8 D9 D10
**4** 1
**5** D25
**6** 1
**7** D40
**8** 1
**9** D55
**10** 1
**11** D70
**12** 1
**13** D85
**14** 1
**15** D100
**16** 1
**17** D115
**18** 1
**19** D130
**20** 1
**21** D145
**22** 1
**23** D160
**24** 1
**25** D175
**26** 1
**27** D190
**28** 1
**29** D205
**30** 1
**31** D220
**32** 1
**33** D235
**34** 1
**35** D250
**36** 1
**37** D265
**38** 1 D272
**39** D273 D274 D275 D276 T1 T2 T3 T4
* * *
## 5.2 O&M Frames
* * *
                            Bit number
Octet no. 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 2 1 C1 C2 C3 C4
C5 C6 C7 3 C8 C9 C10 C11 C12 C13 C14 C15 4 1 D1 D2 D3 D4 D5 D6 D7 5 D8 D9 D10
D11 D12 D13 D14 D15 6 1 D16 D17 D18 D19 D20 D21 D22 7 D23 D24 D25 D26 D27 D28
D29 D30 8 1 D31 D32 D33 D34 D35 D36 D37 9 D38 D39 D40 D41 D42 D43 D44 D45 10 1
D46 D47 D48 D49 D50 D51 D52 11 D53 D54 D55 D56 D57 D58 D59 D60 12 1 D61 D62
D63 D64 D65 D66 D67 13 D68 D69 D70 D71 D72 D73 D74 D75 14 1 D76 D77 D78 D79
D80 D81 D82 15 D83 D84 D85 D86 D87 D88 D89 D90 16 1 D91 D92 D93 D94 D95 D96
D97 17 D98 D99 D100 D101 D102 D103 D104 D105 18 1 D106 D107 D108 D109 D110
D111 D112 19 D113 D114 D115 D116 D117 D118 D119 D120 20 1 D121 D122 D123 D124
D125 D126 D127 21 D128 D129 D130 D131 D132 D133 D134 D135 22 1 D136 D137 D138
D139 D140 D141 D142 23 D143 D144 D145 D146 D147 D148 D149 D150 24 1 D151 D152
D153 D154 D155 D156 D157 25 D158 D159 D160 D161 D162 D163 D164 D165 26 1 D166
D167 D168 D169 D170 D171 D172 27 D173 D174 D175 D176 D177 D178 D179 D180 28 1
D181 D182 D183 D184 D185 D186 D187 29 D188 D189 D190 D191 D192 D193 D194 D195
30 1 D196 D197 D198 D199 D200 D201 D202 31 D203 D204 D205 D206 D207 D208 D209
D210 32 1 D211 D212 D213 D214 D215 D216 D217 33 D218 D219 D220 D221 D222 D223
D224 D225 34 1 D226 D227 D228 D229 D230 D231 D232 35 D233 D234 D235 D236 D237
D238 D239 D240 36 1 D241 D242 D243 D244 D245 D246 D247 37 D248 D249 D250 D251
D252 D253 D254 D255 38 1 D256 D257 D258 D259 D260 D261 D262 39 D263 D264 S1 S2
S3 S4 S5 S6
* * *
## 5.3 Data Frames
### 5.3.1 Data Frame (for Synchronisation)
* * *
                                                        Bit number
Octet no. 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 2 1 C1 C2 C3 C4
C5 C6 C7 3 C8 C9 C10 C11 C12 C13 C14 C15 4 1 . 5 1 . 6 1 . 7 1 Data frame
position 1  
8 1 63 bits.  
9 1 (72 bits including bit position 1)  
10 1  
11 1  
12 1  
13 1  
14 1  
15 1  
161 1 Data frame position 2  
17 1  
18 1  
19 1  
20 1  
21 1  
22 1  
23 1  
24 1  
25 1 Data frame position 3  
26 1  
27 1  
28 1  
29 1  
30 1  
31 1  
32 1  
33 1 Data frame position 4  
34 1  
35 1  
36 1  
37 1  
38 1  
39 1
* * *
### 5.3.2 Extended data frame (E-TRAU : data transport)
* * *
                                                             Bit number
Octet no. 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 2 1 C1 C2 C3 C4
C5 C6 C7 3 C8 C9 C10 C11 C12 C13 M1 M2 4 D1 D2 ...  
5  
6  
7 Data block of 288 data bits and M1, M2.  
8  
9  
10  
11  
12  
13  
14  
15  
16  
17  
18  
19  
20  
21  
22  
23  
24  
25  
26  
27  
28  
29  
30  
31  
32  
33  
34  
35  
36  
37  
38  
39 ... D287 D288
* * *
## 5.4 Idle Speech Frames
* * *
                                Bit number
Octet no. 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 2 1 C1 C2 C3 C4
C5 C6 C7 3 C8 C9 C10 C11 C12 C13 C14 C15 4 1 1 1 1 1 1 1 1 5 1 1 1 1 1 1 1 1 6
1 1 1 1 1 1 1 1 7 1 1 1 1 1 1 1 1 8 1 1 1 1 1 1 1 1 9 1 1 1 1 1 1 1 1 10 1 1 1
1 1 1 1 1 11 1 1 1 1 1 1 1 1 12 1 1 1 1 1 1 1 1 13 1 1 1 1 1 1 1 1 14 1 1 1 1
1 1 1 1 15 1 1 1 1 1 1 1 1 16 1 1 1 1 1 1 1 1 17 1 1 1 1 1 1 1 1 18 1 1 1 1 1
1 1 1 19 1 1 1 1 1 1 1 1 20 1 1 1 1 1 1 1 1 21 1 1 1 1 1 1 1 1 22 1 1 1 1 1 1
1 1 23 1 1 1 1 1 1 1 1 24 1 1 1 1 1 1 1 1 25 1 1 1 1 1 1 1 1 26 1 1 1 1 1 1 1
1 27 1 1 1 1 1 1 1 1 28 1 1 1 1 1 1 1 1 29 1 1 1 1 1 1 1 1 30 1 1 1 1 1 1 1 1
31 1 1 1 1 1 1 1 1 32 1 1 1 1 1 1 1 1 33 1 1 1 1 1 1 1 1 34 1 1 1 1 1 1 1 1 35
1 1 1 1 1 1 1 1 36 1 1 1 1 1 1 1 1 37 1 1 1 1 1 1 1 1 38 1 1 1 1 1 1 C16 C17
39 C18 C19 C20 C21 T1 T2 T3 T4
* * *
## 5.5 Coding
In the following clauses, the coding of the frames is described. Any spare or
not used control bits should be coded binary \"1\".
For all frame types the octet 0, 1 and the first bit of octets 2, 4, 6, 8, ...
38 are used as frame sync.
### 5.5.1 Coding of Frames for Speech Services
#### 5.5.1.1 Coding of Frames for Full Rate and Enhanced Full Rate Speech
##### 5.5.1.1.1 Coding of Control bits (C-bits)
* * *
**Description** **Uplink** **Downlink**
                                     C1C2C3C4 C5                                   C1C2C3C4 C5
Frame type FR Speech: 0 0 0 1 0. Speech: 1 1 1 0 0 (Bits C1 - C5). EFR Speech:
1 1 0 1 0 Speech: 1 1 0 1 0
Time Binary number indicating the Binary number indicating Alignment required
timing adjustment to the timing adjustment made. (Bits C6 - C11) be made in
steps of 250/500 μs.
                                     The following values apply for the coding     
                                     C6C7   . . .    C11                           
                                     0  0  0  0  0  0  No change in frame timing   
                                     0  0  0  0  0  1  Delay frame 1 x 500 μs      
                                     0  0  0  0  1  0  Delay frame 2 x 500 μs      
                                                .   .   .  \....                   
                                                .   .   .  \....                   
                                     1  0  0  1  1  1  Delay frame 39 x 500 μs     
                                     1  0  1  0  0  0  Not used                    
                                                .   .   .  \....                   
                                     1  1  1  1  0  1  Not used                    
                                     1  1  1  1  1  0  Delay frame 1 x 250 μs      
                                     1  1  1  1  1  1  Advance frame 250 μs
Frame indicators. The definition C12: BFI C12 - C15: Spare and coding of these
indicators 0 : BFI = 0  
are given in 3GPP TS 46.031. 1 : BFI = 1 IF FR. Speech
                                     C13 C14: SID                                  ELSE
Bits C12 - C16 0 0 :SID = 0 C12: UFE 0 1 :SID = 1 0 :UFE=0 bad uplink frame 1
0 :SID = 2 1 : UFE=1 good up-link frame Downlink  
Uplink Frame Error C15: TAF  
(UFE) C12 0 : TAF = 0  
(see clause 6.8.3) 1 : TAF = 1 C13 - C15: spare
                                     C16: Spare                                    C16: SP
                                                                                    0  :  SP = 0
                                                                                    1  :  SP = 1
DTX indicator C17: DTXd C17: Spare 0 : DTX not applied  
1 : DTX applied
Bits C18 - C21 Spare Spare
* * *
##### 5.5.1.1.2 Coding of Data Bits (D-bits)
**For Full Rate Speech:**
Bits D1 .. D260: Speech block transferred in the same order as output from the
transcoder (see 3GPP TS 46.010).
**For Enhanced Full Rate Speech** :
The speech block is subdivided in five subsets. The order within a given
subset is the same as output from the transcoder (see ETS 300 726, 3GPP TS
46.060). Three parity bits are added at the end of each sub-set.
These parity bits are added to the bits of the subset, according to a
degenerate (shortened) cyclic code using the generator polynomial:
g(D) = D^3^ + D + 1
The encoding of the cyclic code is performed in a systematic form which means
that, in GF(2), the polynomial:
d(m)D^n^ + d(m+1)D^n‑1^ + ......+ d(m + n‑3)D^3^ + p(0)D^2^ + p(1)D + p(2)
where p(0), p(1), p(2) are the parity bits, when divided by g(D), yields a
remainder equal to:
1 + D + D^2^
For every CRC, the transmission order is p(0) first followed by p(1) and p(2)
successively.
Bit D1 : spare (binary \"1\").
Bits D2...D39 : Indexes of the LSF submatrices.
Bits D40...D42 : CRC over bits D1 to D22, D25 to D27 and D29.
Bits D43...D95 : Indexes of the parameters of first sub-frame.
Bits D96...D98 : CRC over bits D43 to D52, D91 and D92.
Bits D99...D148 : Indexes of the parameters of second sub-frame.
Bits D149...D151 : CRC over bits D99 to D103, D105, D144 and D145.
Bits D152...D204 : Indexes of the parameters of third sub-frame.
Bits D205...D207 : CRC over bits D152 to D161, D200 and D201.
Bits D208...D257 : Indexes of the parameters of fourth sub-frame.
Bits D258...D260 : CRC over bits D208 to D212, D214, D253 and D254.
##### 5.5.1.1.3 Time Alignment Bits (T1...T4)
Bits T1 .. T4: Bits positioned at the end of the downlink frames. If the
timing of the frame is to be advanced 250 µs, these 4 bits are not transferred
in order to reduce the frame length accordingly. When transferred the bits are
set to binary \"1\".
#### 5.5.1.2 Coding of Frames for Adaptive Multi-Rate Speech (AMR-NB)
##### 5.5.1.2.1 Coding of Control bits (C-bits)
* * *
Control Bits Description Uplink Description Downlink
C1...C5 Frame_Type (Codec_Type) Frame_Type (Codec_Type)
C6...C11 Time Alignment Command (TAC) or Phase Alignment Control (PAC) or\
Time Alignment Command (TAC) or\ TFO Information or\ Phase Alignment Control
(PAC) or\ Handover Information TFO Information or\ Handover Information
C12 Request or Indication Flag (RIF) Request or Indication Flag (RIF)
C13 spare, set to 1 Uplink Frame Error (UFE)
C14 . C15 . C16 Config_Prot Config_Prot
C17 . C18 Message_No Message_No
C19 DTX in downlink requested (DTXd) spare, reserved for TFO (see 28.062)
C20 TFO Enabled (TFOE) spare, reserved for TFO (see 28.062)
C21 . C22 Frame_Classification, Rx_Type Frame_Classification, Tx_Type
C23 . C24 . C25 Codec_Mode_Indication (RIF == 0) or\ Codec_Mode_Indication
(RIF == 0) or\ Codec_Mode_Request (RIF == 1) or\ Codec_Mode_Request (RIF == 1)
or\ 0.0.0 (Frame_Classification == 0.0) 0.0.0 (Frame_Classification == 0.0)
* * *
Detailed Description:
**Frame Type:\** The coding of the Frame_Type (also called \"Codec_Type\") for
AMR is identical in uplink and downlink.\ C1...C5:\ **0.0.1.1.0** : Adaptive
Multi-Rate Codec.
**Time Alignment Field:\** The Time Alignment Field (Bits C6...C11) is used to
carry either the Time Alignment Command (TAC), the Phase Alignment Control
(PAC) or the TFO and Handover Information. The Time Alignment Command is coded
as for the Full Rate and Enhanced Full Rate (clause 5.5.1.1.1).
[Time Alignment Command (TAC):\ ]{.underline}In the uplink direction (BTS to
TRAU) the TAC indicates the required timing adjustment for the downlink TRAU
frame to be made by the TRAU in 250/500μs steps.\ C6...C11:\ **0.0.0.0.0.0**
No change in frame timing\ **0.0.0.0.0.1** Delay frame 1 x 500μs (send four
additional T-Bit-pairs after the end of the TRAU Frame)\ **0.0.0.0.1.0** Delay
frame 2 x 500μs (send eight additional T-Bit-pairs after the end of the TRAU
Frame)\ ...\ **1.0.0.1.1.1** Delay frame 39 x 500μs (send 156 additional
T-Bit-pairs after the end of the TRAU Frame)\ (1.0.1.0.0.0 to 1.1.0.1.1.1: 16
code-points, unused, reserved)\ (1.1.1.0.0.0 to 1.1.1.0.1.1: 4 code-points,
reserved for TFO)\ (**1.1.1.1**.0.0 reserved for TFO)\ (**1.1.1.1.0.1**
reserved for AMR CMI/CMR Phase Alignment Command (PAC), no change in frame
timing)\ **1.1.1.1.1.0** Delay frame by 250μs (send two additional T-Bit-pairs
after the end of the TRAU Frame)\ **1.1.1.1.1.1** Advance frame by 250μs (do
not send the two T-Bit-pairs at the end of the TRAU Frame).
[Phase Alignment Command (PAC)]{.underline} (useful when TFO is not supported
or disabled): **[\ ]{.underline}** The Phase Alignment Command (PAC) can be
used by the BTS to command the TRAU to change (invert) the phase of CMI/CMR,
respectively RIF, in downlink TRAU frames, see clause 6.6.1.2.1.\ C6...C11:\
**1.1.1.1.0.1** AMR CMI/CMR Phase Alignment Command (PAC), no change in frame
timing.
In No_Speech frames the Phase Alignment Command may optionally be transmitted
by one additional bit (PAB, see subclause 5.5.1.2.2) that allows a direct time
and phase alignment in one step.
[TFO Information]{.underline} (defined when TFO is supported, see 3GPP TS
28.062):**[\ ]{.underline}** C6...C11\ **1.1.1.0**.0.0\ **1.1.1.0**.0.1\
**1.1.1.0**.1.0\ **1.1.1.0**.1.1\ **1.1.1.1**.0.0\ These five codes are
reserved for Tandem Free Operation (see 3GPP TS 28.062). They result in no
change in frame timing. If the BTS does not support TFO or TFO is disabled
these codes shall not be used in uplink and shall be ignored in downlink. The
procedure to exchange this information between BTS and TRAU is described in
3GPP TS 28.062.
**Request or Indication Flag (RIF):\** This flag indicates the phase of the
Codec_Mode_Indication (RIF == 0) respectively the Codec_Mode_Request (RIF ==
1). It has the same meaning in uplink and in downlink. Typically this flag
toggles every frame. Exceptions may occur at handover and CMI/CMR phase
alignment, see clause 6.6.1.2.1.
**Uplink Frame Error (UFE):\** In downlink the UFE indicates that the most
recently received uplink TRAU frame had detectable errors.\ In uplink this bit
shall be set to \"1\".\ UFE == 0: \"Uplink Frame received with Errors\";\ UFE
== 1: \"Uplink Frame received without Errors\".\ Note: the UFE is not related
to the frame classification (Rx_Type) as computed by the BTS radio receiver.
It is related to inconsistencies in the TRAU frame synchronization, control
bits or CRCs within the TRAU frame.
**Config_Prot\** This field is reserved for the Configuration Protocol in case
of Tandem Free Operation (see 3GPP TS 28.062). If the BTS does not support TFO
or TFO is disabled, then this field shall be set to \"0.0.0\".
**Message_No\** This field is reserved for the Configuration Protocol in case
of Tandem Free Operation (see 3GPP TS 28.062). If the BTS does not support TFO
or TFO is disabled, then this field shall be set to \"0.0\".
**DTX in downlink requested (DTXd)\** See clause 6.6.2.2.
**TFO Enabled (TFOE)\** This bit enables or disables Tandem Free Operation in
the TRAU. If the BTS does not support TFO or TFO is disabled, then this bit
shall be set to \"0\". Coding:\ TFOE == 0: TFO Disabled;\ TFOE == 1: TFO
Enabled.
**Frame_Classification:\** This field classifies the contents of the TRAU
frame as seen by the radio receiver, see 3GPP TS 26.093:\ C21...C22:\ 1 1
\"Speech_Good\" the frame can be decoded without restriction\ 1 0
\"Speech_Degraded\" the frame might contain undetected errors\ 0 1
\"Speech_Bad\" the frame contains errors that can not be corrected\ 0 0
\"No_Speech\" the frame is not a speech frame, see below.
In the uplink direction the Frame_Classification is also called \"Rx_Type\"
and is always set by the BTS.\ \ In the downlink direction the
Frame_Classification is also called \"Tx_Type\".\ If Tandem Free Operation is
not ongoing, then the codes \"Speech_Degraded\", and \"Speech_Bad\" shall not
be used in the downlink direction. If Tandem Free Operation is ongoing, then
all codes may be used in the downlink direction. For the handling within the
downlink BTS, see 3GPP TS 28.062).
**Codec_Mode_Indication / Codec_Mode_Request:\** This 3-bit field has three
different meanings, depending on the Frame_Classification field and the
Request_or_Indication_Flag (RIF):\ If Frame_Classification is different than
\"0.0\" then this field contains\ either the Codec_Mode_Indication (CMI), if
RIF equals 0;\ or the Codec_Mode_Request (CMR), if RIF equals 1.\ If
Frame_Classification is equal to \"0.0\", i.e. when a No_Speech frame is
transmitted, then this field shall be set to \"0.0.0\". CMI and CMR are then
simultaneously transmitted in the Data Bits.\ The coding is identical in
uplink and downlink.\ C23 . C24. C25:\ 0 0 0 Codec_Mode 4,75 kBit/s\ 0 0 1
Codec_Mode 5,15 kBit/s\ 0 1 0 Codec_Mode 5,90 kBit/s\ 0 1 1 Codec_Mode 6,70
kBit/s\ 1 0 0 Codec_Mode 7,40 kBit/s\ 1 0 1 Codec_Mode 7,95 kBit/s\ 1 1 0
Codec_Mode 10,2 kBit/s\ 1 1 1 Codec_Mode 12,2 kBit/s\ The CMI indicates the
Codec_Mode to be used for decoding the associated speech parameters in the
same and the next frame. The CMR indicates the highest allowed Codec_Mode to
be used for encoding in the opposite direction.\ \ Note 1: In the TRAU frames,
the Codec_Mode_Request, respectively the Codec_Mode_Indication are coded
absolutely (three bits for eight possible modes). On the radio interface,
because of bandwidth limitation, these parameters are coded with two bits
only. The CCU shall perform the required translation.
Note 2: In case of no Tandem Free Operation the uplink CMR is a
Codec_Mode_Command (CMC) from the BTS to the TRAU and the TRAU shall try to
follow the command as soon as possible. The only allowed exception is in case
of DTX when SID or No_Data frames can be used during speech pauses. In the
downlink direction the CMR is typically set by the TRAU to \"1.1.1\". This CMR
from the TRAU must be combined with the corresponding CMR for the local uplink
direction, see 3GPP TS 45.009 and 28.062, before it is sent down to the MS.
Note 3: In case of an ongoing Tandem Free Operation, the local uplink CMR is
an indication from the local BTS to the TRAU, respectively to the distant BTS,
on the highest allowed Codec_Mode in the local downlink direction. This
indication must be combined with the corresponding CMR in the distant uplink
direction to set the Codec Mode to use in that direction. The local downlink
CMR is the indication from the distant radio link on the highest allowed
Codec_Mode in the distant downlink direction. This CMR from the TRAU must be
combined with the corresponding CMR for the local uplink direction, see 3GPP
TS 45.009 and 28.062, before it is sent down to the MS.
##### 5.5.1.2.2 Coding of Data bits (D-bits)
In Codec_Mode 10,2 kBit/s the bits D1...D20 and D234...D253 are reserved for
Tandem Free Operation In all Codec_Modes below 10,2 kBit/s and in all
No_Speech frames the bits D1...D31 (31 bits) and D203...D256 (54 bits) are
reserved for Tandem Free Operation (see 3GPP TS 28.062).\ In No_Speech frames
additionally bits D44...D57 (14 bits) are reserved for TFO as well.
If the BTS does not support TFO or TFO is disabled, then the bits in these
fields shall all be set to \"1\".
**Coding of Speech Frames:\** The contents of the Data bits for all eight AMR
Codec_Modes are defined in the following, in cases when the
Frame_Classification is either set to Speech_Good, Speech_Degraded, or
Speech_Bad. The speech block is subdivided into four subsets. The order within
a given subset is the same as output from the transcoder (see 3GPP TS 26.090).
The four times three parity bits (CRC1 to CRC4), added at the end of each
subset, are generated using the same cyclic code as defined for the Enhanced
Full Rate (see clause 5.5.1.1.2). The TRAU frame formats in uplink and
downlink direction are identical.
**AMR_Mode 12,2 kBit/s, see 3GPP TS 26.090:\** D1...D38: Indexes of the LSF
submatrices (s1...s38)\ D39...D91: Indexes of the parameters of first sub-
frame (s39...s91)\ D92...D94: CRC1 over bits C1...C25, s1...s29, s39...s50,
s87...s89.\ D95...D144: Indexes of the parameters of second sub-frame
(s92...s141)\ D145...D147: CRC2 over bits s92...s100, s137...s139.\
D148...D200: Indexes of the parameters of third sub-frame (s142...s194)\
D201...D203: CRC3 over bits s142...s153, s190...s192.\ D204...D253: Indexes of
the parameters of fourth sub-frame (s195....s244)\ D254...D256: CRC4 over bits
s195...s199, s201...s203, s240...s242.
**AMR_Mode 10,2 kBit/s, see 3GPP TS 26.090:\** D21...D46: Indexes of the LSF
submatrices (s1...s26)\ D47...D92: Indexes of the parameters of first sub-
frame (s27...s72)\ D93...D95: CRC1 over bits C1...C25, D1...D20, s1...s25,
s27...s34, s66, s67, s69, s70.\ D96...D138: Indexes of the parameters of
second sub-frame (s73...s115)\ D139...D141: CRC2 over bits s73...s76, s109,
s110, s112, s113.\ D142...D187: Indexes of the parameters of third sub-frame
(s116...s161)\ D188...D190: CRC3 over bits s116...s123, s155, s156, s158,
s159.\ D191...D233: Indexes of the parameters of fourth sub-frame
(s162...s204)\ D254...D256: CRC4 over bits s162...s165, s198, s199, s201,
s202, D234...D253.
**AMR_Mode 7,95 kBit/s, see 3GPP TS 26.090:\** D32...D58: Indexes of the LSF
submatrices (s1...s27)\ D59...D92: Indexes of the parameters of first sub-
frame (s28...s61)\ D93...D95: CRC1 over bits C1...C25, s1...s35, s53, s54,
s57, s60.\ D96...D127: Indexes of the parameters of second sub-frame
(s62...s93)\ D128...D130: CRC2 over bits s62...s65, s85, s86, s89...s92.\
D131...D164: Indexes of the parameters of third sub-frame (s94...s127)\
D165...D167: CRC3 over bits s94...s101, s119, s120, s123...s126.\ D168...D199:
Indexes of the parameters of fourth sub-frame (s128...s159)\ D200...D202: CRC4
over bits s128...s131, s151, s152, s155...s158.
**AMR_Mode 7,40 kBit/s, see 3GPP TS 26.090:\** D32...34 spare (3 bits); set to
\"1\"\ D35...D60: Indexes of the LSF submatrices (s1...s26)\ D61...D92:
Indexes of the parameters of first sub-frame (s27...s58)\ D93...D95: CRC1:
bits C1...C25, s1...s20, s22...s24, s27...s32, s52, s53, s55...s57.\
D96...D124: Indexes of the parameters of second sub-frame (s59...s87)\
D125...D127: CRC2 over bits s59...s61, s81, s82, s84...s86.\ D128...D159:
Indexes of the parameters of third sub-frame (s88...s119)\ D160...D162: CRC3
over bits s88...s93, s113, s114, s116...s118.\ D163...D191: Indexes of the
parameters of fourth sub-frame (s120...s148)\ D192...D194: CRC4 over bits
s120...s122, s142, s143, s145, s146.\ D195...D202: spare (8 bits); set to
\"1\".
**AMR_Mode 6,70 kBit/s, see 3GPP TS 26.090:\** D32...D37: spare (6 bits); set
to \"1\"\ D38...D63: Indexes of the LSF submatrices (s1...s26)\ D64...D92:
Indexes of the parameters of first sub-frame (s27...s55)\ D93...D95: CRC1 over
bits C1...C25, s1...s17, s20, s24, s27...s34, s49...s53.\ D96...D120: Indexes
of the parameters of second sub-frame (s56...s80)\ D121...D123: CRC2 over bits
s56...s59, s74...s78.\ D124...D152: Indexes of the parameters of third sub-
frame (s81...s109)\ D153...D155: CRC3 over bits s81...s88, s103...s107.\
D156...D180: Indexes of the parameters of fourth sub-frame (s110...s134)\
D181...D183: CRC4 over bits s110...s113, s128...s132.\ D184...D202: spare (19
bits); set to \"1\".
**AMR_Mode 5,90 kBit/s, see 3GPP TS 26.090:\** D32...D41: spare (10 bits); set
to \"1\"\ D42...D67: Indexes of the LSF submatrices (s1...s26)\ D68...D92:
Indexes of the parameters of first sub-frame (s27...s51)\ D93...D95: CRC1 over
bits C1...C25, s1...s17, s27...s34, s48...s51.\ D96...D116: Indexes of the
parameters of second sub-frame (s52...s72)\ D117...D119: CRC2 over bits
s52...s54, s69...s72.\ D120...D144: Indexes of the parameters of third sub-
frame (s73...s97)\ D145...D147: CRC3 over bits s73...s80, s94...s97.\
D148...D168: Indexes of the parameters of fourth sub-frame (s98...s118)\
D169...D171: CRC4 over bits s98...s100, s115...s118.\ D172...D202: spare (31
bits); set to \"1\".
**AMR_Mode 5,15 kBit/s, see 3GPP TS 26.090:\** D32...D46 spare (15 bits); set
to \"1\"\ D47...D69: Indexes of the LSF submatrices (s1...s23)\ D70...D92:
Indexes of the parameters of first sub-frame (s24...s46)\ D93...D95: CRC1 over
bits C1...C25, s1...s16, s19...s29, s42...s46.\ D96...D114: Indexes of the
parameters of second sub-frame (s47...s65)\ D115...D117: CRC2 over bits
s47...s48, s61...s65.\ D118...D136: Indexes of the parameters of third sub-
frame (s66...s84)\ D137...D139: CRC3 over bits s66...s67, s80...s84.\
D140...D158: Indexes of the parameters of fourth sub-frame (s85...s103)\
D159...D161: CRC4 over bits s85...s86, s99...s103.\ D162...D202: spare (41
bits); set to \"1\".
**AMR_Mode 4,75 kBit/s, see 3GPP TS 26.090:\** D32...D44: spare (13 bits); set
to \"1\"\ D45...D67: Indexes of the LSF submatrices (s1...s23)\ D68...D92:
Indexes of the parameters of first sub-frame (s24...s48)\ D93...D95: CRC1 over
bits C1...C25, s1...s16, s18, s19, s21...s29, s45...s48.\ D96...D108: Indexes
of the parameters of second sub-frame (s49...s61)\ D109...D111: CRC2 over bits
s49,s50.\ D112...D132: Indexes of the parameters of third sub-frame
(s62...s82)\ D133...D135: CRC3 over bits s62, s63, s79...s82.\ D136...D148:
Indexes of the parameters of fourth sub-frame (s83...s95)\ D149...D151: CRC4
over bits s83, s84.\ D152...D202: spare (51 bits); set to \"1\".
**Coding of No_Speech Frames:\** The following tables define the contents of
the Data bits when the Frame_Classification is set to \"No_Speech\". The three
parity bits (CRC1) added are generated using the same cyclic code as defined
for the Enhanced Full Rate (see clause 5.5.1.1.2). The TRAU Frame Formats in
uplink and downlink direction are identical.
**SID_Update and SID_Bad Frame:\** D32...D34: No_Speech_Classification\
D35...D37: Codec_Mode_Indication_abs\ D38...D40: Codec_Mode_Request_abs\ D41:
PAB: Phase Alignment Bit (optional)\ D42...D43: TAE: Time Alignment Extension
(optional)\ D44...D57: reserved for TFO\ D58...D60: Moving average predictor,
initial values (s1...s3)\ D61...D86: Indexes of LSF submatrices (s4...s29)\
D87...D92: Logarithmic frame energy (s30...s35)\ D93...D95: CRC1 over bits
C1...C25, D32...D92.\ D96...D207: spare (112 bits); set to \"1\".
**No_Data, SID_First and Onset Frame:\** Bits D32...D34:
No_Speech_Classification\ Bits D35...D37: Codec_Mode_Indication_abs\ Bits
D38...D40: Codec_Mode_Request_abs\ Bit D41: PAB: Phase Alignment Bit
(optional)
Bits D42...D43: TAE: Time Alignment Extension (optional)\ Bits D44...D57:
reserved for TFO\ Bits D58...D92: spare (35 bits); set to \"1\"\ Bits
D93...D95: CRC1 over bits C1...C25, D32...D92.\ Bits D96...D207: spare (112
bits); set to \"1\".
[**No_Speech_Classification:** \ ]{.underline}If the Frame_Classification is
set to \"0.0\", then the TRAU frame contains no speech parameters. The
No_Speech_Classification is coded in the D-Bits:\ D32...D34:\ 1.1.1:
Sid_First\ 1.1.0: Onset\ 1.0.1: Sid_Update\ 1.0.0: Sid_Bad (SID_Update with
bad parameters)\ 0.1.1: spare\ 0.1.0: spare\ 0.0.1: spare\ 0.0.0: No_Data
(nothing received or frame has been stolen, e.g. by FACCH or RATSCCH).
[**Codec_Mode_Indication_abs (CMI_abs):** \ ]{.underline}The meaning in uplink
and downlink is identical. In No_Speech frames the CMI is always transmitted,
independent of the setting of the RIF bit. Coding:\ D35 . D36 . D37:\ 0.0.0
Codec_Mode 4,75 kBit/s\ 0.0.1 Codec_Mode 5,15 kBit/s\ 0.1.0 Codec_Mode 5,90
kBit/s\ 0.1.1 Codec_Mode 6,70 kBit/s\ 1.0.0 Codec_Mode 7,40 kBit/s\ 1.0.1
Codec_Mode 7,95 kBit/s\ 1.1.0 Codec_Mode 10,2 kBit/s\ 1.1.1 Codec_Mode 12,2
kBit/s
[**Codec_Mode_Request_abs (CMR_abs):** \ ]{.underline}The meaning in uplink
and downlink is identical. In No_Speech frames the CMR is always transmitted,
independent of the setting of the RIF bit. Coding:\ D38 . D39 . D40:\ 0.0.0
Codec_Mode 4,75 kBit/s\ 0.0.1 Codec_Mode 5,15 kBit/s\ 0.1.0 Codec_Mode 5,90
kBit/s\ 0.1.1 Codec_Mode 6,70 kBit/s\ 1.0.0 Codec_Mode 7,40 kBit/s\ 1.0.1
Codec_Mode 7,95 kBit/s\ 1.1.0 Codec_Mode 10,2 kBit/s\ 1.1.1 Codec_Mode 12,2
kBit/s
[**Phase Alignment Bit (PAB):** \ ]{.underline}This bit is defined only in
No_Speech frames. It is optional and shall be set to \"0\", if not used.\ The
PAB has exactly the same meaning and function as the Phase Alignment Command
(PAC). For the exact procedure see clause 6.6.1.2.1.\ PAB set to 0: CMI/CMR
phase in downlink TRAU frames shall not be changed\ PAB set to 1: CMI/CMR
phase in downlink TRAU frames shall be inverted.\ PAB shall only be used
together with TAC values between **0.0.0.0.0.0** (\"No change in frame
timing\") and **1.0.0.1.1.1** (\"Delay frame 39 x 500μs\").
[**Time Alignment Extension (TAE):** \ ]{.underline}The TAE specifies
optionally a Time Alignment Extension. Coding:\ D42 . D43: Meaning:\ 0.0: No
additional delay with respect to the Time Alignment Command\ 0.1 Additional
delay of 125 µs\ 1.0 Additional delay of 250 µs\ 1.1 Additional delay of 375
µs\ TAE together with the Time Alignment Command (TAC) allow a \"one step\"
time alignment of 125 µs accuracy in No_Speech frames. TAE shall only be used
together with TAC values between **0.0.0.0.0.0** (\"No change in frame
timing\") and **1.0.0.1.1.1 (** \"Delay frame 39 x 500μs\").\ The TAC_TAE
combination **0.0.0.0.0.0_0.1** shall be interpreted as **\"** Delay frame by
125μs\".\ The TAC_TAE combination **1.0.0.1.1.1_1.0** shall be interpreted as
**\"** Advance frame by 250μs\".\ The TAC_TAE combination **1.0.0.1.1.1_1.1**
shall be interpreted as **\"** Advance frame by 125μs\".
##### 5.5.1.2.3 Time Alignment Bits (T1...T4)
The coding and meaning is as described in 3.5.1.1.3 (Time Alignment Bits).
#### 5.5.1.3 Coding of Frames for Adaptive Multi-Rate Wide Band Speech (AMR-
WB) for 16kbit/s and 32kbit/s sub-multiplexing
##### 5.5.1.3.1 Coding of Control bits (C-bits)
+----------------+----------------+----------------+----------------+ | Control Bits | Description\ | Description\ | Description\ | | | Uplink | Downlink | Uplink and | | | | | Downlink\ | | | For the 16k | For the 16k | for the 16k | | | main part | main part | upper | | | | | extension | +----------------+----------------+----------------+----------------+ | C1...C5 | Frame_Type | Frame_Type | Frame Type | | | (Codec_Type) | (Codec_Type) | (Codec_Type) | +----------------+----------------+----------------+----------------+ | C6...C11 | Time Alignment | Time Alignment | Time Alignment | | | Command (TAC) | Command (TAC) | Command (TAC) | | | or Phase | or\ | or Phase | | | Alignment | Phase | Alignment | | | Control (PAC) | Alignment | Control (PAC) | | | or\ | Control (PAC) | or\ | | | TFO | or\ | TFO | | | Information | TFO | Information | | | or\ | Information | or\ | | | Handover | or\ | Handover | | | Information | Handover | Information | | | | Information | | +----------------+----------------+----------------+----------------+ | C12 | Request or | Request or | spare, set to | | | Indication | Indication | 1 | | | Flag (RIF) | Flag (RIF) | | +----------------+----------------+----------------+----------------+ | C13 | spare, set to | Uplink Frame | spare, set to | | | 1 | Error (UFE) | 1 | +----------------+----------------+----------------+----------------+ | C14 . C15 . | Config_Prot | Config_Prot | spare, set to | | C16 | | | 1.1.1 | +----------------+----------------+----------------+----------------+ | C17 . C18 | Message_No | Message_No | spare, set to | | | | | 1.1 | +----------------+----------------+----------------+----------------+ | C19 | DTX in | spare, | spare, set to | | | downlink | reserved for | 1 | | | requested | TFO (see | | | | (DTXd) | 28.062) | | +----------------+----------------+----------------+----------------+ | C20 | TFO Enabled | spare, | spare, set to | | | (TFOE) | reserved for | 1 | | | | TFO (see | | | | | 28.062) | | +----------------+----------------+----------------+----------------+ | C21 . C22 | Frame_C | Frame_C | spare, set to | | | lassification, | lassification, | 1.1 | | | Rx_Type | Tx_Type | | +----------------+----------------+----------------+----------------+ | C23 . C24 . | Codec_Mod | Codec_Mod | spare, set to | | C25 | e_Indication\ | e_Indication\ | 1.1.1 | | | (RIF == 0) or\ | (RIF == 0) or\ | | | | Codec_ | Codec_ | | | | Mode_Request\ | Mode_Request\ | | | | (RIF == 1) or\ | (RIF == 1) or\ | | | | 0.0.0\ | 0.0.0\ | | | | (Frame_ | (Frame_ | | | | Classification | Classification | | | | == 0.0) | == 0.0) | | +----------------+----------------+----------------+----------------+
Detailed Description:
**Frame Type:\** The coding of the Frame_Type (also called \"Codec_Type\") for
AMR-WB is identical in uplink and downlink.\ C1...C5:\ **0.1.0.1.0:**
**Adaptive Multi-Rate Wide Band** Codec, in lower 16k main part\
**0.1.0.1.1:** **Adaptive Multi-Rate Wide Band** Codec, in upper 16k extension
part.
**Time Alignment Field:\ As in case of AMR-NB.** \ \ [Phase Alignment Command
(PAC):\ ]{.underline}As in case of AMR-NB.
[TFO Information:\ ]{.underline}As in case of AMR-NB.
**Request or Indication Flag (RIF):\** As in case of AMR-NB.
**Uplink Frame Error (UFE):\** As in case of AMR-NB.
**Config_Prot:\** This field is reserved and shall be set to \"0.0.0\".
**Message_No:\** This field is reserved and shall be set to \"0.0\".
**DTX in downlink requested (DTXd):\** As in case of AMR-NB.
**TFO Enabled (TFOE):\** As in case of AMR-NB.
**Frame_Classification:\** As in case of AMR-NB.
**Codec_Mode_Indication / Codec_Mode_Request:\** As in case of AMR-NB, except
that the coding is adapted to the AMR-WB modes.\ The coding is identical in
uplink and downlink.\ C23.C24.C25: Coding for AMR-WB\ 0 0 0 Codec_Mode 6,60
kBit/s\ 0 0 1 Codec_Mode 8,85 kBit/s\ 0 1 0 Codec_Mode 12,65 kBit/s\ 0 1 1
Codec_Mode 15,85 kBit/s\ 1 0 0 Codec_Mode 23,85 kBit/s\ 1 0 1 undefined\ 1 1 0
undefined\ 1 1 1 undefined.\ The CMI indicates the Codec_Mode to be used for
decoding the associated speech parameters in the same and the next frame. The
CMR indicates the highest allowed Codec_Mode to be used for encoding in the
opposite direction.\ \ Note 1: In the TRAU frames, the Codec_Mode_Request,
respectively the Codec_Mode_Indication are coded absolutely (three bits for
five possible modes). On the radio interface, because of bandwidth limitation,
these parameters are coded with two bits only. The CCU shall perform the
required translation.
Note 2: In case of no Tandem Free Operation the uplink CMR is a
Codec_Mode_Command (CMC) from the BTS to the TRAU and the TRAU shall try to
follow the command as soon as possible. The only allowed exception is in case
of DTX when SID or No_Data frames can be used during speech pauses. In the
downlink direction the CMR is typically set by the TRAU to \"1.1.1\". This CMR
from the TRAU must be combined with the corresponding CMR for the local uplink
direction, see 3GPP TS 45.009 and 28.062, before it is sent down to the MS.
Note 3: In case of an ongoing Tandem Free Operation, the local uplink CMR is
an indication from the local BTS to the TRAU, respectively to the distant BTS,
on the highest allowed Codec_Mode in the local downlink direction. This
indication must be combined with the corresponding CMR in the distant uplink
direction to set the Codec Mode to use in that direction. The local downlink
CMR is the indication from the distant radio link on the highest allowed
Codec_Mode in the distant downlink direction. This CMR from the TRAU must be
combined with the corresponding CMR for the local uplink direction, see 3GPP
TS 45.009 and 28.062, before it is sent down to the MS.
##### 5.5.1.3.2 Coding of Data bits (D-bits)
**Coding of Speech Frames for AMR-WB:\** The contents of the Data bits for all
five AMR-WB Codec_Modes are defined in the following, in cases when the
Frame_Classification is either set to Speech_Good, Speech_Degraded, or
Speech_Bad. The three parity bits are generated using the same cyclic code as
defined for the Enhanced Full Rate (see subclause 5.5.1.1.2). The TRAU frame
formats in uplink and downlink directions are identical.
All undefined bits are spare and set to 1.
**AMR-WB Mode 23.85kbit/s (477 bits per frame):**
For this codec mode the lower main 16k part is not sufficient to carry all
data bit. The remaining bits are therefore transported in the upper 16k
extension part.
**16 k lower main part:** \ D15...D92: s1, s2 ... s78 [first block and first
sub-frame]\ D93...D95: CRC over bits C1 ... C25, D15 ... D92\ D96...D148:
s157, s158 ... s209 [second sub-frames]\ D149...D203: s263, s264 ... s317
[third sub-frame]\ D204...D256: s372, s373 ... s424 [fourth sub-frame]
**16k upper extension part:** \ D15...D92: s79, s80 ... s156 [first block and
first sub-frame]\ D93...D95: CRC over bits D15 ... D92\ D96...D148: s210, s211
... s262 [second sub-frames]\ D150...D203: s318, s319 ... s371 [third sub-
frame]\ D204...D256: s425, s426 ... s477 [fourth sub-frame]
**AMR-WB Mode 15,85 kbit/s (317 bits per frame):**
For this codec mode the lower main 16k part is not sufficient to carry all
data bit. The remaining bits are therefore transported in the upper 16k
extension part . The arrangement is such that the delay as well as the load in
the upper extension part are minimised. Therefore only D-Bits in columns 3, 5,
7 of the TRAU Frame structure in the upper extension part are used. One 3-bit
CRC is included in each part (lower main or upper extension) after the first
sub-frame.
**16 k lower main part:** \ D1...D92: s1, s2, s3, ... s92 [first block and
first sub-frame]\ D93...D95: CRC over bits C1 ... C25, s1 ... s92\ D96...D148:
s117, s118...s169 [second sub-frame]\ D149...D203: s183, s184...s237 [third
sub-frame]\ D204...D256: s252, s253...s304 [fourth sub-frame]
**16k upper extension part:** \ D32, D34...D86, D88: s93, s94... s115, s116
[first block and first sub-frame]\ D90.D92.D94: CRC over bits s93...s116\
D116, D120...D146: s170...s182 [second sub-frame]\ D169, D172...D202:
s238...s251 [third sub-frame]\ D225, D227...D255: s305...s317 [fourth sub-
frame]
**AMR-WB Mode 12,65 kbit/s (253 bits per frame):**
The 253 bits of this mode fit well into the 256 D-bits of the lower main 16k
part. One 3-bit CRC protects the first sub-frame.\ The D-bits of **16k upper
extension part** (if present) are unused.
D1...D47: VAD-flag and indices of the LSF submatrices (s1... s47)\ D48...D100:
First sub-frame (s48... s100)\ D101..D103: CRC over bits C1 ... C25, s1 ...
s100\ D104 ... D256: remaining sub-frames (s101 ... s253)
**AMR-WB Mode 8.85 kbit/s (177 bits per frame):**
The 177 bits of this mode fit well into the 256 D-bits of the lower main 16k
part. One 3-bit CRC protects the first sub-frame. The D-bits of **16k upper
extension part** (if present) are unused.
D12...D58: VAD-flag and indices of the LSF submatrices (s1... s47)\ D59...D92:
First sub-frame (s48... s81)\ D93...D95: CRC over bits C1 ... C25, s1 ... s81\
D96...D191: remaining sub-frames (s82 ... s177)
**AMR-WB Mode 6.60 kbit/s (132 bits per frame):**
The 132 bits of this mode fit well into the 256 D-bits of the lower main 16k
part. One 3-bit CRC protects the first sub-frame. The D-bits of **16k upper
extension part** (if present) are unused.
D30...D66: VAD-flag and indices of the LSF submatrices (s1... s37)\ D67...D92:
First sub-frame (s38... s63)\ D93...D95: CRC over bits C1 ... C25, s1 ... s63\
D96...D164: remaining sub-frames (s64 ... s132)
**Coding of No_Speech Frames:\** The following tables define the contents of
the Data bits when the Frame_Classification is set to \"No_Speech\". The three
parity bits added are generated using the same cyclic code as defined for the
Enhanced Full Rate (see subclause 5.5.1.1.2). The TRAU Frame Formats in uplink
and downlink direction are identical. All unused D-bits are set to spare
("1").
**SID_Update and SID_Bad Frame for AMR-WB:\** D1...D31 spare, set to 1\
D32...D34: No_Speech_Classification\ D35...D37: Codec_Mode_Indication_abs\
D38...D40: Codec_Mode_Request_abs\ D41: PAB: Phase Alignment Bit (optional)\
D42...D43: TAE: Time Alignment Extension (optional)\ D44...D57: spare, set to
\"1\"\ D58...D85: Indexes of LSF submatrices (s1...s28)\ D86...D91:
Logarithmic frame energy (s29...s34)\ D92...D92: CN_Dithering flag (s35)\
D93...D95: CRC1 over bits C1...C25, D32...D92.\ D96...D256: spare, set to
\"1\".
**No_Data, SID_First and Onset Frame for AMR-WB:\** D1...D31 spare, set to 1\
D32...D34: No_Speech _Classification\ D35...D37: Codec_Mode_Indication_abs\
D38...D40: Codec_Mode_Request_abs\ D41: PAB: Phase Alignment Bit (optional)\
D42...D43: TAE: Time Alignment Extension (optional)\ D44...D57: spare, set to
\"1\"\ D58...D92: spare (35 bits); set to \"1\"\ D93...D95: CRC1 over bits
C1...C25, D32...D92.\ D96...D256: spare, set to \"1\".
**[No_Speech_Classification:\ ]{.underline}** As in case of AMR-NB.
**[Codec_Mode_Indication_abs (CMI_abs):\ ]{.underline}** The meaning in uplink
and downlink is identical. In No_Speech frames the CMI is always transmitted,
independent of the setting of the RIF bit. Coding:\ D35 . D36 . D37:\ 0.0.0
Codec_Mode 6,60 kBit/s\ 0.0.1 Codec_Mode 8,85 kBit/s\ 0.1.0 Codec_Mode 12,65
kBit/s\ 0.1.1 Codec_Mode 15,85 kBit/s\ 1.0.0 Codec_Mode 23,85 kBit/s\ 1.0.1
undefined\ 1.1.0 undefined\ 1.1.1 undefined
[**Codec_Mode_Request_abs (CMR_abs):** \ ]{.underline}The meaning in uplink
and downlink is identical. In No_Speech frames the CMR is always transmitted,
independent of the setting of the RIF bit. Coding:\ D38 . D39 . D40:\ 0.0.0
Codec_Mode 6,60 kBit/s\ 0.0.1 Codec_Mode 8,85 kBit/s\ 0.1.0 Codec_Mode 12,65
kBit/s\ 0.1.1 Codec_Mode 15,85 kBit/s\ 1.0.0 Codec_Mode 23,85 kBit/s\ 1.0.1
undefined\ 1.1.0 undefined\ 1.1.1 undefined
##### 5.5.1.3.3 Time Alignment Bits (T1a...T4a)
Bits T1a...T4a Bits positioned at the end of the downlink and uplink frames.
If the timing of the frame is to be advanced, these 2..4 bits are not
transferred in order to reduce the frame length accordingly. When transferred,
the bits are set to binary "1".
#### 5.5.1.4 void
#### 5.5.1.5 Coding of Configuration Frames
**Control bits (C-bits):**
* * *
**Description** **Uplink** **Downlink** C1C2C3C4 C5 C1C2C3C4 C5 Frame type 1 1
1 1 0: Configuration 1 1 1 1 0: Configuration Bits C1 - C5
* * *
**Data Bits (D-bits):**
Bits D1 ... D276:
These data bits are reserved for Configuration Exchange to support Tandem Free
Operation.\ They are defined in TS 28.062.
**Time Alignment Bits (T1...T4)**
Bits T1 .. T4:
Bits positioned at the end of the frames. If the timing of the frame is to be
advanced 250 µs, these 4 bits are not transferred in order to reduce the frame
length accordingly. When transferred the bits are set to binary \"1\".
### 5.5.2 Coding of O&M Frames
Control bits (C-bits):
* * *
**Description** **Uplink** **Downlink** C1C2C3C4 C5 C1C2C3C4 C5 Frame type 0 0
1 0 1 : O&M 1 1 0 1 1 : O&M Bits C1 - C5  
Bits C6 - C15 Spare Spare
* * *
Data Bits (D-bits):
Bits D1 .. D264: Bits used for transfer of O&M information. The coding and use
of these bits are left to the manufacturer of the BSC/TRAU.
Spare Bits:
Bits S1 .. S6: Spare
### 5.5.3 Coding of Data Frames
Control bits (C-bits):
* * *
**Description** **Uplink** **Downlink** Frame type. C1C2C3C4 C5 C1C2C3C4 C5
Bits C1 - C5 0 1 0 0 0 : Data 1 0 1 1 0 : Data except 14.5 except 14.5
                         1  0  1  0  0 : Data14.5^1)^    1  0  1  0  0  : Data 14.5^1)^
Intermediate RA bit 0: 8 kbit/s 0: 8 kbit/s rate. 1: 16 kbit/s 1: 16 kbit/s
Bit C6  
for data services  
except 14.5  
Spare Spare Spare for Data 14.5  
Bits C7 - C15 Spare Spare
* * *
NOTE 1: The Data frame is in case of data 14.5 kbit/s used only for
synchronization purposes. The data bits are in this case set according to
clause 6.5.1.
### 5.5.4 Coding of Extended Data Frames
Control bits (C-bits):
* * *
**Description** **Uplink** **Downlink** Frame type. C1C2C3C4 C5 C1C2C3C4 C5
Bits C1 - C5 1 1 1 1 1 : 1 1 1 1 1 : Extended Data Extended data frame 14.5
kbit/s Frame 14.5
Bit C6  
Idle/Data/UFE Idle/data UFE Frame indication
Bits C7 - C13 Spare Bit C7 indicating idle/data frame. Bit C8-C13 spare
Multi Frame Structure M1, M2 M1, M2 defined in 3GPP TS 44.021  
Bits M1, M2
* * *
### 5.5.5 Coding of Idle Speech Frames
Control bits (C-bits):
* * *
**Description** **Uplink** **Downlink** C1C2C3C4 C5 C1C2C3C4 C5 Frame type. 1
0 0 0 0 : Idle Speech 0 1 1 1 0 : Idle Speech Bits C1 - C5
Bits C6 - C21 Coding as for Coding as for Speech frames. Speech frames.
* * *
NOTE: Idle Speech frames shall not be used in AMR or AMR-WB; instead
Frame_Classification set to \"No_Data\" shall be applied.
Time Alignment Bits:
Bits T1 .. T4: Coding as for Speech frames.
## 5.6 Order of Bit Transmission
The order of bit transmission is:
The first octet is transferred first with the bit no. 1 first, bit no. 2 next
etc.
# 6 Procedures
In this clause, when nothing is particularly stated, procedures for AMR_WB
apply to 16 kbit/s and 32 kbit/s multiplexing, and in the second case, to
channel a and channel b.
## 6.1 Remote Control of Transcoders and Rate Adaptors
When the transcoder is positioned remote to the BTS, the Channel Codec Unit
(CCU) in the BTS has to control some of the functions in the remote
Trans­coder/Rate Adaptor Unit (TRAU) in the BSC.
This remote control is performed by inband signalling carried by the control
bits (C-bits) in each TRAU frame.
The following functions in the TRAU are remotely controlled by the CCU:
\- Shift between speech and data.
\- Control of the rate adaption functions for data calls.
\- Downlink frame timing for speech frames.
\- Transfer of DTX information.
In addition, the following functions are provided in case of AMR or AMR-WB
speech:
\- Control of Codec Mode adaptation
\- Transfer of TFO Configuration Parameters (optional, see 3GPP TS 28.062)
\- Downlink Phase Alignment (optional)
\- Transfer of Information on TFO Status (optional, see 3GPP TS 28.062)
\- Transfer of Information on Pre-Handover Warning (optional)
In addition, the inband signalling also provides means for transfer of O&M
signals between the TRAU and the BSC/BTS.
## 6.2 Resource Allocation
At reception of the ASSIGNMENT REQUEST message, e.g. at call setup, when a
circuit switched connection is required, the BSC provides an appropriate TRAU
to the circuit to be used between the BSC and the BTS and sends the CHANNEL
ACTIVATION message to the BTS.
When receiving the CHANnel ACTIVation message, the BTS allocates the
appropriate radio resources and a Channel Codec Unit (CCU) to be used.
In case of FR and EFR Speech or Data (except 14.5 kbit/s):
The CCU now starts sending uplink frames with the appropriate \"Frame Type\"
and, for data calls, the intermediate rate adaption bit rate set.
When receiving the first frame, the TRAU sets the mode of operation
accordingly and starts sending downlink frames with the \"Frame Type\" and,
for data calls, the intermediate rate adaption bit rate set as an
acknowledgement indication.
In case of Adaptive Multi-Rate or Adaptive Multi_rate Wideband speech: see
clause 6.6.1.3.
In case of Data 14.5 kbit/s:
The CCU starts sending uplink Data TRAU Frames with the appropriate \"Frame
Type\" set to establish initial synchronization.
When receiving the first frame, the TRAU sets the mode of operation
accordingly and as an acknowledgement starts sending downlink Data TRAU Frames
with the same "Frame Type".
The CCU starts sending uplink Extended Data TRAU Frames with the appropriate
\"Frame Type\" set upon reception of that acknowledge indication.
When receiving the first frame, when the \"Frame Type\" is set to Extended
Data TRAU frame, the TRAU sets the mode of operation accordingly and as an
acknowledgement starts sending downlink Extended Data TRAU frames with the
same "Frame Type".
## 6.3 Resource Release
At release of circuit switched resources, e.g. at call release, the connection
between the CCU and the TRAU will be released by the BSC. The BSC has to
indicate that the connection has been released. How this is performed is a BSC
internal matter. However, three methods have been identified.
i) The BSC indicates the call release to the TRAU by inserting the PCM idle
bit pattern described in 3GPP TS 48.054 on the circuits towards the TRAU. The
TRAU shall be able to detect this idle bit pattern. When received at the TRAU,
the TRAU will loose frame synchronization and will start timer Tsync (see
clause 6.8.2). If, when Tsync expires, the idle bit pattern has been detected,
the TRAU shall terminate the operation (go idle) until a valid frame is again
received.
ii) This second alternative does not apply to Enhanced Full Rate Speech,
Adaptive Multi-Rate speech, Adaptive Multi-Rate Wideband speech and Data 14.5
kbit/s cases.
After a call release, the TRAU downlink channel is switched to the TRAU uplink
channel (16 kbit/s side).
The TRAU shall be able to detect the looped downlink frame. When it is
detected, the TRAU shall terminate the normal operation (go idle) until a
valid uplink TRAU frame is again received.
iii) It is handled by BSC internal signals (e.g. if the BSC and TRAU are
collocated).
## 6.4 In Call Modification
If the subscriber orders \"In Call Modification\", the CCU sets the \"Frame
Type\" and, for data calls, the inter mediate rate adaption bit rate in the
uplink frames to the new mode of operation. When receiving this information,
the TRAU changes the mode of operation accordingly and sets the new \"Frame
Type\" and, for data calls, the inter­mediate rate adaption bit rate in the
downlink frames. The same procedure applies for mode change between Data 14,5
kbit/s.
In case of mode change to data 14,5 kbit/s from Speech or Data (other than
14.5 kbit/s) the same procedure as for "Resource Allocation" is performed.
In case of mode change from any other speech or data service to **AMR or AMR-
WB speech** , the same procedure as for \"Resource Allocation\" shall be
performed. In case of mode change within AMR speech, i.e. a change of the AMR
or AMR-WB Configuration, the BSC should take care that a smooth transition
from the old AMR or AMR-WB configuration into the new one is performed, see
3GPP TS 45.009 and 3GPP TS 28.062.
## 6.5 Transfer of Idle Frames, Handling of Missing Data
Between the TRAU and the CCU a TRAU frame shall be transferred every 20 ms.
### 6.5.1 In Full Rate data case
If no data is received from the MS (uplink direction) or no data is received
from the MSC side of the interface (downlink direction), idle data frames
shall be transferred instead of data frames. Idle data frames are data frames
with all data bit positions set to binary \"1\". In addition, for data 14,5
kbit/s; the C6 bit shall be set to '1' in the uplink extended data frame. For
each idle frame sent downlink for data 14.5 kbit/s the C7 bit is set to '1'.
### 6.5.2 In Full Rate speech case
If no speech is received from the MS (uplink direction), the CCU shall send
TRAU speech frames with BFI flag set to 1 (bad frame) or idle speech frames.If
no speech is received from the MSC side of the interface (downlink direction),
idle speech frames shall be transferred instead of speech frames.
### 6.5.3 In Enhanced Full Rate speech case
If no speech is received from the MS (uplink direction), the CCU shall send
TRAU speech frames with BFI flag set to 1 (bad frame). If no speech is
received from the MSC side of the interface (downlink direction), idle speech
frames shall be transferred instead of speech frames.
### 6.5.4 In Adaptive Multi-Rate speech case
If no speech is received from the MS (uplink direction), or a speech frame is
stolen on the radio interface (e.g. by FACCH) the CCU shall send TRAU
No_Speech frames with Frame_Type set to \"AMR\" and with
No_Speech_Classification set to \"No_Data\". The Code_Mode_Indication shall be
set to the previously used value. CMI and CMR shall be set to the
Initial_Codec_Mode, if at resource allocation.
If no speech is received from the MSC side (downlink direction), i.e. the
\"PCM_Idle\" pattern is received instead, the TRAU shall send TRAU No_Speech
frames with Frame_Type set to \"AMR\", and with No_Speech_Classification set
to \"No_Data\". The Codec_Mode_Indication shall be set to the previously used
value or to the Initial_Codec_Mode, if at resource allocation.
### 6.5.5 In Adaptive Multi-Rate Wideband speech case
If no speech is received from the MS (uplink direction), or a speech frame is
stolen on the radio interface (e.g. by FACCH) the CCU shall send TRAU
No_Speech frames with Frame_Type set to \"AMR-WB\" and with
No_Speech_Classification set to \"No_Data\". The Code_Mode_Indication shall be
set to the previously used value. CMI and CMR shall be set to the
Initial_Codec_Mode, if at resource allocation.
If no speech is received from the MSC side (downlink direction), i.e. the
\"PCM_Idle\" pattern is received instead, the TRAU shall send TRAU No_Speech
frames with Frame_Type set to \"AMR-WB\", and with No_Speech_Classification
set to \"No_Data\". The Codec_Mode_Indication shall be set to the previously
used value or to the Initial_Codec_Mode, if at resource allocation.
## 6.6 Procedures for Speech Services
### 6.6.1 Time Alignment of Speech Service Frames
The time alignment needed for obtaining minimum buffer delay will differ from
call to call. The reasons for this are:
\- The BSC will have no information about the radio timing at the BTS, and
will start sending frames at an arbitrary or default time. Each TRAU frame is
320 bits (20 ms) long and will in the worst case be received at the BTS 318
bits out of phase.
\- The different timeslots on one carrier are sent at different times (max
4.04 ms which equals 7 timeslots in a TDMA radio frame).
\- Different channels may be transferred on different transmission systems
using different routes in the network. The transmission delay may therefore
differ.
The required time alignment between radio frames and TRAU frames is considered
to be an internal BTS matter for uplink frames. However, the buffer delay for
these frames should be kept to a minimum.
For downlink frames, the procedures in the following clauses should apply. In
order to describe the time alignment procedure in the TRAU, two time alignment
states are described (Initial Time Alignment state and Static Time Alignment
state).
In order to achieve optimum timing between the radio TDMA frames and the
frames on the Abis transmission side, the speech coding and decoding functions
in the transcoder should not be synchronized.
#### 6.6.1.1 Initial Time Alignment State
The TRAU shall enter the Initial Time Alignment state at the switching-on of
the system, when it goes idle (e.g. when receiving the PCM idle pattern after
a call release as described in clause 6.3), if loss of frame synchronization
is detected, in call modification from data to speech is performed or if BSS
internal handover is detected.
In the Initial Time Alignment state, the frames shall only be delayed (or no
change)(see note). The transcoder is able to adjust the time for transmitting
the speech frames in steps of 125 µs (one speech sample). The CCU calculates
the required timing adjustment and returns a frame including the number of
250/500 µs steps by which the frames in the downlink direction have to be
delayed (binary number in the \"Time Alignment\" field).
When receiving this information, the TRAU processes this data and sets the
\"Time Alignment\" field in the next downlink frame as ordered and then delays
the subsequent frame accordingly.
NOTE: If the TRAU, in this state, receives an order to advance the next frame
250 µs, this order shall be interpreted as \"Delay frame 39*500 µs\".
When a frame is delayed due to timing adjustments, the TRAU shall fill in the
gap between the frames with the appropriate number of binary \"1\" (T-bits).
After having adjusted the timing, the TRAU shall receive at least three new
frames before a new adjustment is made. This in order to avoid oscillation in
the regulation.
The TRAU shall change from the Initial Time Alignment state to the Static Time
Alignment state when it has performed two subsequent timing adjustments which
are less than 500 µs (including no change).
The procedure is illustrated in figure 6.1.
Optionally, in case of AMR or AMR-WB speech, two additional bits (TAE) may be
used in an uplink No_Speech frame to code a time alignment command with a
precision of 125 µs. When receiving this information, the TRAU processes this
data and sets the \"Time Alignment\" field in the next downlink frame as
ordered and then delays the subsequent frame accordingly. It needs to send the
TAE bits back only if the downlink frame is a No_Speech frame, too.
#### 6.6.1.2 The Static Time Alignment State
In the Static Time Alignment state, the TRAU performs timing adjustments in
single steps of 250 µs or 125 µs (AMR or AMR-WB only). The timing may either
be delayed (time alignment code \"Delay frame by 250 µs (125 µs)\"), advanced
(time alignment code \"Advance frame by 250 µs (125 µs)\") or not changed
(time alignment code \"No Change in Time Alignment\" or all other codes that
result in no change).
When receiving an order for adjusting the timing, the transcoder skips or
repeats two (one) speech samples in order to achieve the correct timing.
If the timing is to be advanced 250 µs (125 µs), the TRAU sets the \"Time
Alignment\" field in the next downlink frame as ordered and then the 4 (2)
last bits of the frame are not transferred (the T-bits).
If the timing is to be delayed, the TRAU sets the \"Time Alignment\" field in
the next downlink frame as ordered and then delays the subsequent frame by
adding the appropriate number of binary \"1\" between the frames.
After having adjusted the timing, the TRAU shall receive at least three new
frames before a new adjustment is made.
If, in this state and TFO is not ongoing (see 3GPP TS 28.062), the TRAU
detects a change in the timing of the uplink frames bigger than n x 250 µS,
where n = 4, it shall enter the Initial Time Alignment state and in that state
it may perform an adjustment on the downlink equal to the change detected on
the uplink.
In case of AMR or AMR-WB speech the time alignment may be done in steps of 125
µs by using the TAC and TAE. If TFO is ongoing in case of AMR or AMR-WB speech
the TRAU shall not perform any time alignment in downlink direction.
##### 6.6.1.2.1 Phase Alignment of Codec_Mode_Indication for AMR or AMR-WB
In the Static Time Alignment state for Adaptive Multi-Rate speech and Adaptive
Multi-Rate Wideband, it might be necessary to align the phase of the
Codec_Mode_Indication and Codec_Mode_Request as indicated in downlink TRAU
frames by the RIF bit, to the phase of CMI / CMR on the radio interface. One
of the following four alternative methods shall be applied:
**Alternative 1:** If TFO is not ongoing (see 3GPP TS 28.062), then the CCU
may send one \"Phase Alignment Command\" (PAC) uplink (see 3.5.1.2.1). The
TRAU shall send two consecutive TRAU frames with Codec_Mode_Indication (RIF
set to \"0\" two times) and by this shall invert the phase of
Codec_Mode_Indication and Codec_Mode_Request in downlink on the Abis/Ater
interface (consider the round trip delay).
**Alternative 2:** Similar to Alternative 1: If TFO is not ongoing (see 3GPP
TS 28.062), then the CCU may send one No_Speech frame with the Phase Alignment
Bit (PAB) set accordingly. This may be done already within the initial time
alignment state together with the initial time alignment command (TAC and
TAE). By this the DL TRAU frames can be aligned in time and phase within one
step to a precision of 125 µs.
**Alternative 3:** If TFO is ongoing (see 3GPP TS 28.062) no time and phase
alignment shall be performed on the Abis/Ater interface. Instead, the CCU
shall buffer (up to 40ms) the downlink speech frames, until they can be sent
on the radio interface. If the TRAU receives a time or phase alignment command
while in TFO it may ignore it.
**Alternative 4:** The CCU may send a specific RATSCCH Message downlink to the
mobile station (see 3GPP TS 45.009) and by that invert the phase of the CMI /
CMC on the radio interface and thus avoid the buffer delay (20ms). This
alternative is especially useful in TFO, but may be used also without TFO.
Figure 6.1: Initial Time Alignment Procedure
#### 6.6.1.3 Initiation at Resource Allocation
When the BTS receives the CHANNEL ACTIVATION message from the BSC, it
allocates the appropriate radio resources and a Channel Codec Unit (CCU). **In
case of FR or EFR** the CCU then initiates sending of speech frames (or idle
speech frames if speech is not received from the MS) towards the transcoder
with normal frame phase for the TDMA channel in question. The \"Time
Alignment\" field in these frames is set to \"no change\".
The TRAU will now be in the Initial Time Alignment state. When receiving the
first frame it shall start sending speech frames (or idle speech frames)
towards the BTS with arbitrary or default phase related to the uplink frame
phase.
When receiving these frames the CCU calculates the timing adjustment required
in order to achieve minimum buffer delay and sets the \"Time Alignment\" field
in the uplink frames accordingly.
The procedures described for the Initial and for the Static Time Alignment
states are then followed during the call.
**In case of AMR or AMR-WB** the CCU shall initiate sending of TRAU No_Speech
frames towards the transcoder with normal frame phase for the TDMA channel in
question unless speech is received on the radio interface. The \"Time
Alignment\" field shall be set to \"no change\", the TAE shall be set to
\"0.0\" and PAB shall be set to \"0\". The RIF shall correspond to the phase
of the uplink radio interface. The CMI / CMR shall be set to
\"Initial_Codec_Mode\". Consequently, speech transmission will start in uplink
and downlink in this mode. In case the BTS supports TFO it shall send the TFO
Configuration parameters uplink (see 3GPP TS 28.062). The TRAU will now be in
the Initial Time Alignment state. When receiving the first UL TRAU frame it
shall start sending No_Speech frames (or speech frames, if speech is received
from the MSC side) towards the BTS with arbitrary or default phase related to
the uplink frame phase. After receiving downlink TRAU frames the CCU may
perform time alignment and phase alignment (optionally using TAC, TAE and
PAB). The CCU shall keep the Codec_Mode in uplink and downlink fixed to the
Initial_Codec_Mode until the correct time and phase alignment in downlink TRAU
frames is achieved. Then the Codec_Mode adaptation may be enabled, see also
3GPP TS 45.009.
#### 6.6.1.4 Time Alignment During Handover
##### 6.6.1.4.1 BSS External Handover
For BSS external handover, the procedure described in clause 6.6.1.3 should be
used by the new BSC/BTS at resource allocation.
##### 6.6.1.4.2 BSS Internal Handover
If TFO is not ongoing and a BSS internal handover has been performed, the
timing of the downlink frames may have to be adjusted several steps of 125,
250 or 500 µs. In order to speed up the alignment of the downlink frames, this
must be detected by the TRAU, e.g. by detecting the change in the uplink frame
timing as described in clause 6.6.1.2. The TRAU should then enter the Initial
Time Alignment state and in that state it may perform an adjustment on the
downlink equal to the change detected on the uplink.
In case of AMR or AMR-WB, when TFO is ongoing, the BTS shall not send any time
alignment or phase alignment commands and the TRAU shall not perform any time
or phase alignment in downlink direction. Instead the BTS shall buffer the
speech frames accordingly (see clause 6.6.1.2.1, alternative 3). Alternatively
the BTS may perform a phase alignment on the radio interface by sending a
RATSCCH message (see clause 6.6.1.2.1, alternative 4), thus avoiding the
buffer delay (20ms).
Please note that optionally before and after handover the AMR or AMR-WB link
adaptation should be frozen to the Intial_Codec_Mode, until all necessary time
and phase alignments have been performed. CMI and CMC should therefore be
identical during that period. Consequently a phase mismatch does not matter
until the adaptation is enabled.
### 6.6.2 Procedures for Discontinuous Transmission (DTX)
The procedures for comfort noise are described in 3GPP TS 46.012, for Full
rate speech and in 3GPP TS 46.062 for Enhanced Full rate speech, the overall
operation of DTX is described in 3GPP TS 46.031 and in 3GPP TS 46.081 for
respectively Full rate speech and Enhanced Full rate speech and the Voice
Activity Detector is described in 3GPP TS 46.032 and 3GPP TS 46.082 for
respectively Full rate speech and Enhanced full rate speech. The relevant
procedures for Adaptive Multi-Rate speech are described in 3GPP TS 26.092,
3GPP TS 26.093 and 3GPP TS 26.094 and for Adaptive Multi-Rate Wideband speech
in 3GPP TS 26.192, 3GPP TS 26.193 and 3GPP TS 26.194. For the case of DTX in
ongoing TFO see 3GPP TS 28.062.
The DTX Handler function is considered as a part of the TRAU when remote
transcoders are applied. The specification of the DTX Handler is given in 3GPP
TS 46.031 for Full rate speech, in 3GPP TS 46.081 for Enhanced Full Rate
speech, in 3GPP TS 26.093 for Adaptive Multi-Rate speech and in 3G 26.193 for
Adaptive Multi-Rate Wideband speech.
#### 6.6.2.1 DTX procedures in the uplink direction
In case of the Full Rate and Enhanced Full Rate speech: In all frames in the
uplink direction, the BFI (Bad Frame Indicator), the SID (Silence Descriptor)
indicator and the TAF (Time Alignment Flag) indicator is set as output from
the RSS (see 3GPP TS 46.031 and 3GPP TS 46.081).
In the comfort noise states, the MS will transmit a new frame only every 480
ms (24 frames). These frames are transferred in the normal way between the CCU
and the TRAU. Between these frames the CCU shall transfer uplink idle speech
frames in case of Full Rate Speech and speech frames with BFI set to \"1\" in
case of Enhanced Full rate Speech.
In case of the Adaptive Multi-Rate or Adaptive Multi-rate Wideband speech all
frames are classified by the Rx_Type, see also 3GPP TS 26.093 and 3GPP TS
26.193. In the comfort noise states, the MS will transmit a new SID_Update
frame only about every 160 ms (8 frames). These frames are transferred in the
normal way between the CCU and the TRAU. Between these SID_Update frames the
CCU and TRAU shall transfer \"No_Data\" frames uplink.
#### 6.6.2.2 DTX procedures in the downlink direction
To inform the DTX handler in the remote transcoder whether downlink DTX may be
applied or not, the DTXd bit (C17 in case of Full Rate and Enhanced Full Rate,
C19 in case of Adaptive Multi-Rate and Adaptive Multi-Rate Wideband speech in
16 kbit/s and 32 kbit/s multiplexing) in the uplink speech frame is used. The
coding is as follows:
DTXd = 0 : downlink DTX is not applied (\"not requested\" in case of AMR or
AMR-WB);
DTXd = 1 : downlink DTX is applied (\"requested\" in case of AMR or AMR-WB).
Though this parameter is linked with the resource allocation in the BTS at
call setup, its value may vary during the connection.
In case of Full Rate and Enhanced Full Rate speech in the downlink frames the
SP (Speech) indicator is set as output from the TX DTX handler (see 3GPP TS
46.031 and 3GPP TS 46.081).
If downlink DTX is not used, the SP indicator should be coded binary \"1\".
In case of the Adaptive Multi-Rate and Adaptive Multi-Rate Wideband speech all
downlink frames are classified by the Tx_Type, see also 3GPP TS 26.093 and
3GPP TS 26.193. In ongoing TFO, in case the distant side uses uplink DTX,
downlink DTX may be applied by the TRAU, although DTXd is set to \"not
requested\". For handling in the downlink BTS see 3GPP TS 26.093 and 3GPP TS
26.193 and 28.062.
## 6.7 Procedures for Data Frames
### 6.7.1 9.6 and 4.8 kbit/s channel coding
When rate adaption to 64 Kbit/s is performed at the BTS (sub‑64 kbit/s traffic
channels are not used), the rate adaption between the format used on the radio
interface and the 64 Kbit/s format is made by the RA1/RA1\' and the RA2
function as described in GSM. 48.020. This is illustrated in figure 6.2.
> +------+ +-------------+
>
> -┼-\| RA2 +-----┼------\| RA1 \| RA1\' +---┼----
>
> \| +------+ \| +------┴------+ \|
>
> 64 Kbit/s CCITT V.110 Channel
>
> 80 bits codec
>
> frame frame
Figure 3GPP TS 48.060/4.2: Rate adaption when performed at the BTS.
When sub‑64 kbit/s traffic channels are used, up to four data frames are
transferred in each TRAU frame. In order to convert between the TRAU frame
format and the CCITT 80 bits frame format an additional inter­mediate rate
adaption function, RAA, is applied. This is illustrated in figure 6.3.
> +------+ +---+ Abis +---+ +---------+
>
> -┼-\| RA2 +---┼----\|RAA+---┼---\|RAA+-┼-\| RA1\|RA1\'+--┼--
>
> \| +------+ \| +---+ \| +---+ \| +----┴----+ \|
>
> 64 Kbit/s CCITT TRAU CCITT Channel
>
> V.110 4 X 72 + 32 V.110 codec
>
> 80 bits bits 80 bits frame
>
> frame frame frame
Figure 3GPP TS 48.060/4.3: Rate adaption when 16 kbit/s traffic channels are
used
#### 6.7.1.1 The RAA Function
The RAA function is used to convert between the CCITT V.110 80 bits frame
format and the TRAU frame format. When going from the V.110 format to the TRAU
frame format the first octet (all bits coded binary \"0\") in the CCITT V.110
80 bits frame is stripped off. Up to four such frames are then transferred in
each TRAU frame as shown in clause 5.3.
When going from the TRAU frame format to the V.110 format the data frames are
separated and the synchronization octet (all bits coded binary \"0\") is again
included.
The 80 bits V.110 frame is illustrated in figure 6.4, and the modified 72 bits
frame is illustrated in figure 6.5.
* * *
                           Bit number
Octet no. 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 1 1 D1 X X X X X X 2 1 X X X X X X
X 3 1 X X X X X X X 4 1 X X X X X X X 5 1 X X X X X X X 6 1 X X X X X X X 7 1
X X X X X X X 8 1 X X X X X X X 9 1 X X X X X X X
* * *
Figure 3GPP TS 48.060/4.4: CCITT V.110 80 bits frame
* * *
                           Bit number
Octet no. 1 2 3 4 5 6 7 8 0 1 D1 X X X X X X 1 1 X X X X X X X 2 1 X X X X X X
X 3 1 X X X X X X X 4 1 X X X X X X X 5 1 X X X X X X X 6 1 X X X X X X X 7 1
X X X X X X X 8 1 X X X X X X X
* * *
Figure 3GPP TS 48.060/4.5: Modified CCITT V.110 72 bits frame transferred\ in
a TRAU data frame position
#### 6.7.1.2 The RA1/RA1\' Function
This function is described in 3GPP TS 44.021.
#### 6.7.1.3 The RA2 Function
This function is described in 3GPP TS 44.021.
#### 6.7.1.4 Procedures for 8 kbit/s intermediate rate adaption rate
For 8 kbit/s intermediate rate adaption rate up to two data frames are
transferred in each TRAU frame. The first data frame is transferred in TRAU
data frame position 1 and the subsequent data frame is transferred in TRAU
data frame position 3 (see clause 5.3).
In TRAU data frame position 2 and 4, all bits are coded binary \"1\".
If the data transfer terminates before the TRAU frame has been completed, the
remaining data bit positions in the TRAU frame should be coded binary \"1\".
#### 6.7.1.5 Procedures for 16 kbit/s intermediate rate adaption rate
For 16 kbit/s intermediate rate adaption rate, up to four data frames are
transferred in each TRAU frame. The first data frame is transferred in TRAU
data frame position 1, the next in data frame position 2 etc.
If the data transfer terminates before the TRAU frame has been completed, the
remaining data bit positions in the TRAU frame should be coded binary \"1\".
#### 6.7.1.6 Support of Non-Transparent Bearer Applications
In 3GPP TS 48.020, the procedures for transfer of non-transparent bearer
applications are specified. The 240 bit RLP frame is converted to four
modified V.110 80 bit frames.
The same conversion is applied when transferred in a TRAU frame. The frames
are coded as specified in clauses 4.7.4 and 4.7.5.
### 6.7.2 14.5 kbit/s channel coding
When rate adaption to 64 Kbit/s is performed at the BTS (sub‑64 kbit/s traffic
channels are not used), the rate adaption between the format used on the radio
interface and the 64 Kbit/s format is as described in 3GPP TS 48.020.
When sub‑64 kbit/s traffic channels are used, up to eight 36 bits frames are
transferred in each E-TRAU frame. In order to convert between the E-TRAU frame
format and the 36 bits frame format used for the radio interface an additional
intermediate rate adaption function, RA1'/RAA', is applied. This is
illustrated in figure 6.3.1 (see also 3GPP TS 48.020).
> +------+ +----+ Abis +----------+
>
> -┼-\| RA2 +---┼----\|RAA\'+---┼----------\| RAA\'\|RA1\'+--┼--
>
> \| +------+ \| +----+ \| +-----┴----+ \|
>
> 64 Kbit/s A-TRAU E-TRAU Radio
>
> 8 X 36 + 32 320 Interface
>
> bits bits frame
>
> frame frame
Figure 3GPP TS 48.060/4.3.1: Rate adaption when 16 kbit/s traffic channels are
used
#### 6.7.2.1 The RAA' Function
See 3GPP TS 48.020
#### 6.7.2.2 The RA1'/RAA\' Function
This function is described in 3GPP TS 48.020.
#### 6.7.2.3 The RA2 Function
This function is described in 3GPP TS 44.021.
## 6.8 Frame Synchronization
### 6.8.1 Search for Frame Synchronization
**Case of Full Rate, Enhanced Full Rate, Adaptive Multi-Rate (AMR-NB) and
Adaptive Multi-Rate Wide Band (AMR-WB):**
The frame synchronization is obtained by means of the first two octets in each
frame, with all bits coded binary \"0\", and the first bit in octet no. 2, 4,
6, 8, ... 38 coded binary \"1\". The following 35 bit alignment pattern is
used to achieve frame synchronization:
00000000 00000000 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX\
1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX\
1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX\
1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX\
1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX 1XXXXXXX XXXXXXXX
### 6.8.2 Frame Synchronization After Performing Downlink Timing Adjustments
If the timing of the downlink speech frames is adjusted, the adjustment is
indicated in bits C6 - C11 as described in clauses 4.6.1.1 and 4.6.1.2. The
frame synchronization unit shall change its frame synchronization window
accordingly.
### 6.8.3 Frame Synchronization Monitoring and Recovery
The monitoring of the frame synchronization shall be a continuous process.
Loss of frame synchronization shall not be assumed unless at least three
consecutive frames, each with at least one framing bit error, are detected.
In case of Full Rate speech:
If the TRAU looses its frame synchronization it starts a timer Tsync = 1
second. If Tsync expires before frame synchronization is again obtained the
TRAU initiates sending of the urgent alarm pattern described in clause 6.10.2.
The exception from this procedure is when \"Resource Release\" is detected
while Tsync is running (see clause 6.3). In this case, the procedure in clause
6.3 shall be followed.
If loss of frame synchronization is detected by the CCU it starts a timer
Tsync. If Tsync expires before frame synchronization is again obtained the
call shall be released and an indication given to O&M.
Tsync is reset every time frame synchronization is again obtained.
In case of Enhanced Full Rate speech, Adaptive Multi-Rate speech and Adaptive
Multi-Rate Wideband speech with 16 kbit/s multiplexing:
When it detects a framing bit error, the TRAU uses the control bit UFE (uplink
Frame Error) in the next downlink TRAU frame to indicate it to the CCU. When
the CCU receives a TRAU frame indicating an Uplink Frame Error and which has
no errors on the synchronization pattern and the control bits, it starts a
timer TsyncU.
If loss of frame synchronization is detected by the CCU it starts a timer
TsyncD. If TsyncD or TsyncU expires before frame synchronization is again
obtained, the call shall be released as specified in 3GPP TS 48.058 with the
case field set to \" Remote Transcoder Failure\".
TsyncD is reset every time frame synchronisation is again obtained.
TsyncU is reset every time three consecutive TRAU frames are received without
Uplink Frame Error indication, without errors on the frame synchronisation
pattern and on the control bits.
TsyncD and TsyncU are parameters set by O&M (default value = 1 second).
In case of Adaptive Multi-Rate Wideband speech with 32 kbit/s multiplexing:
When it detects a framing bit error in channel a or channel b, the TRAU uses
the control bit UFE (uplink Frame Error) in the next downlink TRAU frame to
indicate it to the CCU. When the CCU receives a TRAU frame indicating an
Uplink Frame Error in channel a or in channel b which has no errors on the
synchronization pattern and the control bits, it starts a timer TsyncU.
If loss of frame synchronization is detected by the CCU it starts a timer
TsyncD. If TsyncD or TsyncU expires before frame synchronization is again
obtained, the call shall be released as specified in GSM 08.58 with the case
field set to \" Remote Transcoder Failure\".
TsyncD is reset every time frame synchronisation is again obtained.
TsyncU is reset every time three consecutive TRAU frames are received without
Uplink Frame Error indication, without errors on the frame synchronisation
pattern and on the control bits in channel a AND in channel b.
TsyncD and TsyncU are parameters set by O&M (default value = 1 second).
In case of Data 14.5 kbit/s:
The following 17 bit alignment pattern of the Extended Data TRAU Frame is used
for Frame Synchronization Monitoring:
> 00000000 00000000 1XXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX\
> XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX\
> XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX\
> XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX\
> XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX
When it detects a framing bit error, the TRAU uses the control bit UFE (uplink
Frame Error) in the next downlink Extended Data TRAU Frame to indicate it to
the CCU. When the CCU receives an Extended Data TRAU Frame indicating an
Uplink Frame Error and which has no errors on the synchronization pattern and
the control bits, it starts a timer TsyncU and TsyncR.
If loss of frame synchronization is detected by the CCU it starts a timer
TsyncD and starts sending Data TRAU Frames in the uplink direction to trigger
the TRAU to start sending Data TRAU Frames in the downlink direction to be
used for downlink Synchronization Recovery.
If TsyncR expires before frame synchronization is again obtained, the CCU
starts sending Data TRAU Frames in the uplink direction to be used for uplink
Synchronization Recovery.
If TsyncD or TsyncU expires before frame synchronization is again obtained,
the call shall be released as specified in 3GPP TS 48.058 with the case field
set to \" Remote Transcoder Failure\".
TsyncD is reset every time frame synchronization is again obtained.
TsychU and TsyncR is reset every time three consecutive TRAU frames are
received without Uplink Frame Error indication, without errors on the frame
synchronization pattern and on the control bits.
TsyncD and TsyncU are parameters set by O&M (default value = 1 second)
TsyncR are a parameter set by O&M (default value = 60 milliseconds).
## 6.9 Correction/detection of bit errors on the terrestrial circuits
### 6.9.1 Error Detection on the Control Bits
For the control bits, (C-bits), no error coding is made. Exception: In case of
AMR or AMR-WB the C-Bits are protected by CRC. However, in order to reduce the
possibility of misinterpretation of control information due to bit errors, the
following procedure should be followed.
#### 6.9.1.1 General Procedure
If any undefined combination of the C-bits is received (see clause 5.5), the
frame should be reacted upon as received with errors.
#### 6.9.1.2 Frames for Speech Services
In addition to the general procedure described in the previous clause, the
following procedure should be followed:
Bits C6 - C11: Time Alignment.
The full range of the time alignment adjustment should only be applied when
the TRAU is in the Initial Time Alignment state (see clauses 4.6.1.1 and
4.6.1.2).
If, in the Static Time Alignment state, a time alignment order is received
indicating an adjustment of more than 250 µs, the next downlink frame should
be delayed only one 250 µs step.
If an uplink frame is received with the \"Time Alignment\" field set to an
unused value, this value should be interpreted as \"no change\".
### 6.9.2 Handling of frames received with errors
If TRAU frame is received in the uplink or downlink with detectable errors in
the control bits, then the control information shall be ignored. The speech or
data bits may be handled as if no error had been detected.
If frame synchronisation has been lost (see clause 6.8.3) in the uplink
direction the TRAU shall:
\- for speech, mute the decoded speech as if it has received frames with
errors (cf. 3GPP TS 46.011 and 3GPP TS 46.061 and 3GPP TS 26.091);
\- for data, send idle frames as defined in 3GPP TS 48.020 to the
MSC/interworking.
#### 6.9.2.1 In case of Full Rate speech
If frame synchronisation has been lost in the downlink direction then the same
procedure shall be followed as when frame synchronisation is lost on the PCM
link.
#### 6.9.2.2 In case of Enhanced Full Rate, Adaptive Multi-Rate and Adaptive
Multi-Rate Wideband speech
For speech calls, the CCU shall transmit a layer two fill frame on the air
interface if frame synchronization has been lost in the downlink direction.
If a CRC error is detected in a downlink TRAU speech frame a solution can be
to transmit a layer two fill frame on the air interface, another solution can
be to replace the bad part of the TRAU speech frame only. The choice of the
solution is left open.
If a CRC error is detected in a uplink TRAU speech frame, the TRAU speech
frame shall be regarded as bad or partly bad and the TRAU shall apply the
procedure defined in 3GPP TS 46.061, 3GPP TS 26.091 or 3GPP TS 26.191
respectively.
## 6.10 Procedures for Operation & Maintenance
The general procedures for Operation and Maintenance are described in 3GPP TS
12.21.
If the transcoders are positioned outside the BTS, some O&M functions will be
required for the TRAU and the CCU. In particular this applies for transcoders
positioned at the MSC site.
The transcoders outside the BTS are considered a part of the BSC, and the O&M
functions for the TRAU should therefore be implemented in the BSC.
The CCU is a part of the BTS and the O&M functions for this unit should
therefore be implemented in the BTS.
### 6.10.1 Transfer of O&M Information Between the TRAU and the BSC
The transfer of O&M information between the BSC and the TRAU is possible to do
in two ways. Either it is handled directly between the BSC and the TRAU or a
BTS is used as a message transfer point. The choice between the two methods is
up to the manufacturer of the BSC:
i) The transfer of O&M information between the BSC and the TRAU is handled
internally by the BSC. The O&M signalling between the TRAU and the BSC may
either be handled by proprietary BSC solutions or the O&M TRAU frames defined
in clauses 3.2 and 3.5.2 could be used. In the latter case, the BSC has to act
as a terminal for the O&M TRAU frames sent between the TRAU and the BSC.
ii) The O&M information between the TRAU and the BSC is transferred using O&M
TRAU frames between the TRAU and the CCU in a BTS. The BTS then acts as a
relay function between the O&M TRAU frames and the associated O&M messages
sent between the BTS and the BSC.
### 6.10.2 Procedures in the TRAU
In case of urgent fault conditions in the TRAU, e.g. loss of frame
synchronization, non-ability of the transcoder to process data etc., this
should if possible, be signalled to the BTS/BSC as an urgent alarm pattern.
The urgent alarm pattern is a continuous stream of binary \"0\".
If O&M TRAU frames information between the TRAU and the BSC is transferred
using O&M frames between the CCU in a BTS and the TRAU, the TRAU sends O&M
frames periodically until the identical O&M TRAU frame is received for
acknowledgement. The period is at least 64*20ms (1,28 sec).
In case of minor fault conditions, when no immediate action is required, the
TRAU may send O&M frames indicating the fault instead of the urgent alarm
pattern.
### 6.10.3 Procedures in the BSC
The BSC should be able to detect a faulty TRAU, take it out of service and
give an indication to O&M. A faulty TRAU could be detected e.g. by routine
tests, alarms from the TRAU, release of call initiated by the BTS due to
remote transcoder failure etc. How this is handled by the BSC is regarded as a
BSC internal matter.
#### 6.10.3.1 Use of O&M Frames
The use and coding of O&M TRAU frames is left to the implementor of the
BSC/TRAU.
If O&M TRAU frames are used, they are always carrying 264 data bits.
Any corresponding O&M message between the BSC and the BTS shall always carry
all 264 O&M data bits.
### 6.10.4 Procedures in the BTS
If a CCU in a BTS receives O&M TRAU frames from the TRAU, the BTS shall:
\- send the identical frame to the TRAU for acknowledgement; and
\- put the 264 data bits from the received frames into an appropriate O&M
message and send it to the BSC.
If the CCU receives O&M frames during a call then \"stolen frames\" shall be
indicated to the MS and layer 2 frames of format A (see 3GPP TS 44.006) shall
be transmitted.
If the CCU receives O&M frames during a data call, then the same procedure
shall be used as when V.110 frame is lost.
If receiving an O&M message from the BSC, carrying TRAU O&M information, the
BTS puts the 264 data bits from the received message into an O&M TRAU frame
and then the CCU allocated to the addressed connection sends the frame to the
TRAU in one single O&M TRAU frame. Repetition is done according to 3GPP TS
12.21.
In case of a faulty CCU, the O&M procedures are BTS internal.
If the CCU receives the urgent alarm pattern, the BTS shall initiate release
of the call as specified in 3GPP TS 48.058 with the cause field set to
\"Remote Transcoder Failure\".
#