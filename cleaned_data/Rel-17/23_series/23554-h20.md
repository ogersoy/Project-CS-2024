# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
# 1 Scope
The present document specifies the functional architecture, procedures,
information flows and APIs for MSGin5G Service. MSGin5G Service provides
messaging communication capability in 5GS especially for Massive Internet of
Things (MIoT).
MSGin5G Service includes the following message communication models:
\- Point-to-Point message;
\- Application-to-Point message/ Point-to-Application message;
\- Group message;
\- Broadcast message.
The corresponding service requirements are defined in 3GPP TS 22.262 [2].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.262: \"Message Service within the 5G System\".
[3] GSMA PRD RCC.07: \"RCC.07 Rich Communication Suite 9.0 Advanced
Communications Services and Client Specification\".
[4] OMA OMA-ERELD-LightweightM2M-V1_1-20180612-C: \"Enabler Release Definition
for LightweightM2M\".
[5] 3GPP TS 23.434: \"Service Enabler Architecture Layer for Verticals\".
[6] 3GPP TS 23.222: \"Functional architecture and information flows to support
Common API Framework for 3GPP Northbound APIs; Stage 2\".
> [7] 3GPP TS 23.502: \"Procedures for the 5G System\".
>
> [8] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
> with packet data networks and applications\".
>
> [9] 3GPP TS 29.122: \"T8 reference point for northbound Application
> Programming Interfaces (APIs)\".
>
> [10] 3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs;
> Stage 3\".
>
> [11] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
> Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
>
> [12] 3GPP TS 23.501: \"System Architecture for the 5G System (5GS); Stage
> 2\".
>
> [13] 3GPP TS 23.204: \"Support of Short Message Service (SMS) over generic
> 3GPP Internet Protocol (IP) access; Stage 2\".
>
> [14] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service
> (CBS)\".
>
> [15] 3GPP TS 23.040: \"Technical realization of the Short Message Service
> (SMS)\".
>
> [16] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**Application-to-Point messaging:** An MSGin5G message delivery that is
originated at an Application Server in the network and terminated at a UE.
**Broadcast Area:** an area consisting of one or more cells where the
broadcast message is delivered.
**Broadcast messaging:** An MSGin5G message delivery that is delivered to UEs
in a Broadcast Area.
**Constrained UE:** a UE (with or without MSGin5G client) which may not have
capability to connect to the 3GPP network.
**Group messaging** : message delivery that is originated at a UE or an
Application Server and is terminated at all members of the group (a group
member can be of type UE, Legacy 3GPP UE or Non-3GPP UE).
**Legacy 3GPP Message Gateway:** the entity in MSGin5G Service to support
interworking with Legacy 3GPP UEs.
**Legacy 3GPP UE:** the UE that supports legacy 3GPP message sending and
receiving (e.g. SMS, NIDD, etc) in MSGin5G Service.
**MSGin5G Client:** the client that enables MSGin5G message sending and
receiving.
**Message Gateway:** general terminology for Legacy 3GPP Message Gateway or
Non-3GPP Message Gateway.
**MSGin5G Gateway UE:** a MSGin5G UE which constructs and sends MSGin5G
message upon receiving request along with required application specific data
from the application client on the Constrained UE (without MSGin5G client).
The same MSGin5G UE can also deliver the received MSGin5G message towards the
target application client on the Constrained UE (without MSGin5G client).
**MSGin5G Group:** the group of UEs which members may be MSGin5G UE, Legacy
3GPP UE and Non-3GPP UE.
**MSGin5G message:** the message defined in the present specification that is
exchanged between the MSGin5G Service endpoints under the MSGin5G Service.
**MSGin5G Relay UE:** a MSGin5G UE which receives MSGin5G message from
Constrained UE (with MSGin5G client) and forwards it to the MSGin5G server and
vice-versa.
**MSGin5G Server:** A server in MSGin5G Service that receives and delivers
MSGin5G messages among MSGin5G Service endpoints.
**MSGin5G Service:** an MNO message service using the 5G System that enables
Point- to-Point, Application-to-Point, Point-to-Application, Group and
Broadcast message delivery for thing-to-thing communication and person-to-
thing communication.
**Messaging Topic:** an identifier for a topic to which a UE or an Application
Server can subscribe to in order to receive messages that are characterized by
a Message Topic.
**MSGin5G UE:** the UE that uses MSGin5G Client in MSGin5G Service.
**Non-3GPP Message Gateway:** the entity in MSGin5G Service to support
interworking with Non-3GPP UEs.
**Non-3GPP UE:** the UE that supports non-3GPP message sending and receiving
(e.g. RCS message as specified in GSMA PRD RCC.07 [3], OMA LWM2M message as
specified in OMA OMA-ERELD-LightweightM2M [4]) in MSGin5G Service.
NOTE: The MSGin5G UE utilizes MSGin5G Client in MSGin5G Service. The Legacy
3GPP UE and Non-3GPP UE does not utilize MSGin5G Client in MSGin5G Service.
**Non-MSGin5G UE:** general terminology for Legacy 3GPP UE or Non-3GPP UE.
**Point-to-Application messaging:** An MSGin5G message delivery that is
originated at a UE and terminated at an Application Server.
**Point-to-Point messaging:** An MSGin5G message delivery that originates at a
UE and terminates at a UE, where at least one of the end points is an MSGin5G
UE.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
\ \
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5GS 5G System
CAPIF Common API Framework for northbound APIs
NIDD Non IP Data Delivery
SCEF Service Capability Exposure Function
SEAL Service Enabler Architecture Layer for Verticals
SMSC Short Message Service Center
VAL Vertical Application Layer
CoAP Constrained Application Protocol
SCS Service Capability Server
# 4 Architectural requirements
## 4.1 General
### 4.1.1 Description
This subclause specifies the general architecture requirements for MSGin5G
Service.
### 4.1.2 Requirements
[AR-4.1.2-a] The MSGin5G Client shall support one or more applications which
need to use the MSGin5G message exchanging capabilities.
[AR-4.1.2-b] The MSGin5G Server shall support one or more Applications Servers
which support the MSGin5G message exchanging capabilities.
[AR-4.1.2-c] The MSGin5G messaging related capabilities (e.g. registration,
Point-to-Point messaging, Group messaging, message delivery status, etc.)
should be exposed as APIs to the Applications Server(s).
[AR-4.1.2-d] The application architecture shall enable the communication
between the UEs in different PLMNs. The UEs support MSGin5G Service.
## 4.2 UE types
### 4.2.1 Description
This subclause specifies the requirements for UE types supported by MSGin5G
Service.
Editor\'s note: It is FFS whether the MSGin5G Server and the Message Gateway
require understanding of the UE type of the UEs served.
### 4.2.2 Requirements
[AR-4.2.2-a] The application architecture shall support the message exchanging
between the following UE types:
1\. MSGin5G UE:
1) light weight constrained devices (e.g. sensors, actuators) and
2) unconstrained devices with advanced capabilities (e.g. washing machine,
micro-ovens)
2\. Legacy 3GPP UE
3\. Non-3GPP UE
[AR-4.2.2-b] The application architecture shall enable the unconstrained
devices to act as a UE Message Gateway to constrained devices to communicate
with MSGin5G Server.
## 4.3 Communication models
### 4.3.1 Description
This subclause specifies the requirements for MSGin5G communication models.
### 4.3.2 Requirements
[AR-4.3.2-a] The application architecture shall support the following message
communication models:
1 Point-to-Point message;
2 Application-to-Point message/ Point-to-Application message;
3 Group message;
4 Broadcast message.
[AR-4.3.2-b] The application architecture shall support the interconnecting
between MSGin5G and other different messaging delivery mechanisms, e.g. SMS
specified in 3GPP TS23.040 [15], or RCS message as specified in GSMA PRD
RCC.07 [3]).
# 5 Application layer architecture
## 5.1 General
The following aspects of MSGin5G Service are described in this clause:
\- application architecture;
\- functional entities;
\- reference points; and
\- capability exposure for enabling MSGin5G Service.
## 5.2 Application Architecture
Figure 5.2-1 shows the application architecture of the MSGin5G Service. The
MSGin5G Service shall fulfil the service requirements which are enumerated in
3GPP TS 22.262 [2] and the architecture requirements enumerated in clause 4.
Figure 5.2-1: Application Architecture of the MSGin5G Service
The MSGin5G Client(s) interacts with SEAL Clients over the SEAL-C reference
point specified for each SEAL service. The Legacy 3GPP Message Gateway and
Non-3GPP Message Gateway may interact with SEAL clients over the SEAL-C
reference point specified for each SEAL service. The MSGin5G Server(s)
interacts with SEAL Servers over the SEAL-S reference point specified for each
SEAL service. The interaction between a SEAL Client and the corresponding SEAL
Server is supported by SEAL-UU reference point specified for each SEAL service
as specified in 3GPP TS 23.434 [5].
NOTE2: For simplicity, the SEAL clients\' interaction with Legacy 3GPP Message
Gateway and Non-3GPP Message Gateway, and the SEAL-UU interface between Legacy
3GPP Message Gateway and Non-3GPP Message Gateway and SEAL servers are not
shown in Figure 5.2-1.
The MSGin5G UE-1 may be constrained devices and unconstrained devices with
advanced capabilities, and can communicate with MSGin5G Server over MSGin5G-1
reference point. The MSGin5G UE-2 is a constrained device which does not have
enough capability to communicate with MSGin5G Server. If allowed by
configuration, the MSGin5G UE-1 may act as a UE Message Gateway to MSGin5G
UE-2.
The Legacy 3GPP Message Gateway interacts with MSGin5G Server over MSGin5G-2
reference point on behalf of Legacy 3GPP UE (e.g., SMS, NIDD).
The Non-3GPP Message Gateway interacts with MSGin5G Server over MSGin5G-4
reference point on behalf of Non-3GPP UE.
NOTE 3: A SEAL Group Management Server and a SEAL Configuration Management
Server (both specified in 3GPP TS 23.434 [5]) may be collocated in the MSGin5G
Server. A SEAL Configuration Management Client specified in 3GPP TS 23.434 [5]
may be collocated in the MSGin5G Client, Legacy 3GPP Message Gateway and
Non-3GPP Message Gateway. The implementation of such deployment option is out
of this specification.
NOTE 4: In certain deployment options, the MSGin5G UE-2 may not contain
MSGin5G Client. In such scenario, the Application Client in MSGin5G UE-2 will
interact with MSGin5G Client in MSGin5G UE-1 to send and receive messages.
NOTE 5: When both MSGin5G UE-1 and MSGin5G UE-2 support MSGin5G Client,
MSGin5G Client in MSGin5G UE-1 acts as a MSGin5G Relay UE for the MSGin5G
Client in MSGin5G UE-2 to receive MSGin5G Service. When MSGin5G UE-2 does not
support an MSGin5G Client and only MSGin5G UE-1 supports an MSGin5G Client,
MSGin5G Client in MSGin5G UE-1 acts as a MSGin5G Gateway UE for the
Application Client in MSGin5G UE-2 to receive MSGin5G Service.
NOTE 6: Depending on the non-3GPP message service, the interaction between
Non-3GPP message client and Non-3GPP Message Gateway may involve 3GPP Core
Network.
NOTE 7: 3GPP Core Network may not be involved for the interaction between the
Non-3GPP Message Gateway and the MSGin5G Server.
Editor\'s note: Specifying details of MSGin5G Client interaction towards
Application Client is FFS.
## 5.3 Functional entities
### 5.3.1 General
The functional entities of the application architecture for the MSGin5G
Service are described in this clause.
### 5.3.2 MSGin5G Server
#### 5.3.2.1 General functionalities
An MSGin5G Server provides server-side functionality to assist MSGin5G Clients
with the sending and receiving of messages via the MSGin5G Service to/from
Application Servers and/or other MSGin5G Service endpoints on other UEs.
Functionalities of MSGin5G Server:
\- To resolve message delivery mechanism for the MSGin5G Service endpoint
based on the terminating MSGin5G Service ID to determine if the message is to
be delivered to an MSGin5G UE, an Application Server or a Message Gateway for
final delivery;
\- To resolve the MSGin5G Group Service ID to determine the members of the
Group specified in 3GPP TS 23.434[5];
\- Interworking with non 3GPP messaging service through the Non-3GPP Message
Gateway;
\- Interworking with legacy 3GPP messaging service through the Legacy 3GPP
Message Gateway;
\- Exchanging MSGin5G messages with application servers, MSGin5G Clients,
Legacy 3GPP Message Gateway and Non-3GPP Message Gateway;
\- Supporting MSGin5G message segmentation according to service provider\'s
policy;
\- Supporting UE configuration procedures as specified in TS 23.434 [5] or
communicating with the SEAL Configuration Management Server to provide MSGin5G
configuration data on a UE to be ready for the MSGin5G Service; and
\- Managing information related to the MSGin5G Service, such as MSGin5G Client
availability, Legacy 3GPP Message Gateway and Non-3GPP Message Gateway.
Editor\'s note: What MSGin5G Client information related to the MSGin5G Service
will be managed by the MSGin5G Server is FFS.
#### 5.3.2.2 Target resolution
Upon receiving the MSGin5G message request to deliver the message to the
recipient (which could be any of the MSGin5G UE, Legacy 3GPP UE, Non-3GPP UE
or Application Server) on the terminating side, the MSGin5G Server checks the
recipient\'s registration repository (created at the time of each MSGin5G
UE/Application Server registration to MSGin5G Server, or the Message Gateway
performs registration with the MSGin5G Server on behalf of the Non-MSGin5G
UEs) for the Identities of MSGin5G service endpoints, i.e. UE Service ID/AS
Service ID. The MSGin5G Server will attempt for delivery MSGin5G message
request towards recipient based on the UE Service ID/AS Service ID. If the
recipient is Non-MSGin5G UE, the Message Gateway that the Non-MSGin5G UE is
registered with will receive the MSGin5G message request on behalf of the Non-
MSGin5G UE, and then delivers the message to the Non-MSGin5G UE by using the
Non-MSGin5G message delivery mechanism.
### 5.3.3 MSGin5G Client
An MSGin5G Client provides client-side functionality for UE Application
Clients with the sending and receiving of messages via the MSGin5G Service
to/from Application Servers and/or other MSGin5G Service endpoints; i.e. UEs.
Functionalities of MSGin5G Client including:
\- may expose MSGin5G APIs to enable Application Clients to use an MSGin5G
Service;
\- supporting registration of an MSGin5G Client to an MSGin5G Server to use
MSGin5G Service;
\- supporting configuration of an MSGin5G Client required to use MSGin5G
Service;
\- construction of MSGin5G message when requested by a native application or
Application Client;
\- delivery of MSGin5G message payload to the targeted native application or
Application Client; and
\- exchanging MSGin5G messages via an MSGin5G Server to/from Application
Servers and/or other MSGin5G Service endpoints; i.e. UEs. and
\- acting as a relay for MSGin5G Client resides in other UE, which does not
have enough capability to communicate with MSGin5G Server (i.e. a constrained
device), to use MSGin5G Service.
NOTE 1: A native application on an MSGin5G UE is the application logic built
within the MSGin5G Client.
NOTE 2: The MSGin5G Client resides in a constrained device is same as the
MSGin5G Client resides in a unconstrained device. E.g. both of them use same
transport/data formats and have the same capabilities.
### 5.3.4 Message Gateway
#### 5.3.4.1 General Description of Message Gateway
A Message Gateway in MSGin5G application architecture provides functionality
to deliver MSGin5G messages to Non-MSGin5G UEs.
A Message Gateway performs the role of interconnecting two different messaging
delivery mechanisms and assures the message integrity between different
message delivery mechanisms. A message delivery mechanism comprises the
specific set of protocols, procedures and rules.
Functionalities of Message Gateway:
\- Enables seamless delivery of an MSGin5G message between different message
delivery mechanisms with integrity;
\- Communicates with the MSGin5G Server using either an MSGin5G Client
functionality or similar functions to enable sending and receiving MSGin5G
messages;
\- Delivers payload of an MSGin5G message to the Non-MSGin5G UE using the
specific message delivery mechanism available to that Non-MSGin5G UE and vice
versa;
\- Performs message sender and receiver addresses conversion according to the
two connected message delivery mechanisms and maintain the mapping of the
address pair used for a response message delivery;
\- Perform registration and de-registration with the MSGin5G Server on behalf
of the Non-MSGin5G UEs;
\- Act as a service endpoint to perform message segmentation and reassembly
for the Non-MSGin5G UEs when needed; and
\- Performs protocol conversion according to the service supported by the
target UE;
\- Supports the MSGin5G message delivery status report
1\. If application level message delivery status report is not supported by
the Non-MSGin5G message delivery mechanisms, based on the information (e.g.
response to the message delivery request, transport level information, etc)
obtained from the Non-MSGin5G message delivery mechanisms, the Message Gateway
fetches the delivery status from the above information and uses it to create
an MSGin5G message delivery status report on behalf of Non-MSGin5G UE. If the
delivery status is failure, also fetch the suitable failure reason from the
above information and use it as reason of failure in the MSGin5G message
delivery status report.
2\. If application level message delivery status report is supported by the
Non-MSGin5G message delivery mechanisms (e.g. RCS specified in GSMA PRD RCC.07
[3]), translates the application level message delivery status report in the
Non-MSGin5G message delivery mechanisms to MSGin5G message delivery status
report.
There are two types of Message Gateways used to deliver MSGin5G messages to
different UE types: the Legacy 3GPP Message Gateway and the non-3GPP Message
Gateway
NOTE: Implementation of the Message Gateway and the MSGin5G Server together is
deployment option that is out of this specification.
#### 5.3.4.2 Legacy 3GPP Message Gateway
The Legacy 3GPP Message Gateway is used to deliver MSGin5G message to Legacy
3GPP UEs, using their 3GPP supported message delivery mechanisms.
#### 5.3.4.3 Non-3GPP Message Gateway
The Non-3GPP Message Gateway is used to deliver MSGin5G message to Non-MSGin5G
UEs, using their (non-3GPP) supported message delivery mechanisms.
### 5.3.5 Application Client
The Application Client is an entity in the application layer to implement and
perform the application service logic for its own service.
The Application Client interacts with MSGin5G Client for sending and receiving
MSGin5G messages. The Application Client provides needed information for the
MSGin5G Client to perform MSGin5G Service with other endpoints.
### 5.3.6 Application Server
The Application Server is an entity in the application layer to implement and
perform the application service logic.
The Application Server supports sending and receiving messages with MSGin5G
Service layer protocols and procedures.
### 5.3.7 Legacy 3GPP Message Client
The Legacy 3GPP Message Client provides client-side functionality for a Legacy
3GPP messaging service (e.g. SMS, NIDD).
NOTE: The details of the Legacy 3GPP Message Client are out of scope of the
present document.
### 5.3.8 Non-3GPP Message Client
The Non-3GPP Message Client provides client-side functionality for a Non-3GPP
messaging service.
NOTE: The details of the Non-3GPP message client are out of scope of the
present document.
### 5.3.9 SEAL Client
The following SEAL Clients for MSGin5G Service are supported:
\- Group management client as specified in 3GPP TS 23.434 [5];
\- Configuration management client as specified in 3GPP TS 23.434 [5].
### 5.3.10 SEAL server
The following SEAL servers for MSGin5G Service are supported:
\- Group management server as specified in 3GPP TS 23.434 [5];
\- Configuration management server as specified in 3GPP TS 23.434 [5].
Editor\'s note: Usage of other SEAL services (e.g. location) from 3GPP TS
23.434 [5] for MSGin5G Service is FFS.
## 5.4 Reference Points
### 5.4.1 General
The reference points of the service architecture for the MSGin5G Service are
described in this clause.
### 5.4.2 MSGin5G-1
The interactions related to enabling MSGin5G message exchange between an
MSGin5G Client and an MSGin5G Server are supported by the MSGin5G-1 reference
point. This reference point supports:
\- Registration of an MSGin5G Client to an MSGin5G Server when not using IMS
based solution; and
\- The exchange of MSGin5G messages.
### 5.4.3 MSGin5G-2
The interactions related to enabling MSGin5G message exchange between an
MSGin5G Server and the Legacy 3GPP Message Gateway are supported by the
MSGin5G-2 reference point. This reference point supports:
\- The exchange of MSGin5G messages between MSGin5G Server and the Legacy 3GPP
Message Gateway; and
\- Perform registration /de-registration on behalf of the Legacy 3GPP UEs that
the Message Gateway connects with the MSGin5G Server.
NOTE: Indicating the delivery mechanism on the MSGin5G-2 reference point is
out of scope of current functionality.
### 5.4.4 MSGin5G-3
The interactions related to enabling MSGin5G message exchange between an
Application Server and an MSGin5G Server are supported by the MSGin5G-3
reference point. This reference point supports:
\- Access to MSGin5G Server and APIs to enable sending and receiving of
MSGin5G messages; and
\- Adherence to CAPIF as specified in 3GPP TS 23.222 [6].
### 5.4.5 MSGin5G-4
The interactions related to enabling MSGin5G message exchange between a
Non-3GPP Message Gateway and an MSGin5G Server are supported by the MSGin5G-4
reference point. This reference point supports:
\- The exchange of MSGin5G messages between MSGin5G Server and the Non-3GPP
Message Gateway; and
\- Perform registration/de-registration on behalf of the Non-3GPP UEs that the
Message Gateway connects with the MSGin5G Server
### 5.4.6 MSGin5G-5
The interactions related to enabling MSGin5G message related information
exchange between an Application Client and an MSGin5G Client are supported by
the MSGin5G-5 reference point. This reference point supports:
\- Providing information from Application Clients required to enable the
MSGin5G Client to construct an MSGin5G message to be delivered to other
MSGin5G Service endpoints.
\- Configuring application clients with information required to enable the
MSGin5G Client and MSGin5G Server to exchange and route MSGin5G messages to
other MSGin5G Service endpoints.
\- Sending notifications and information in the incoming MSGin5G messages
received by the MSGin5G Client to the Application Clients from other MSGin5G
Service endpoints.
### 5.4.7 MSGin5G-6
The MSGin5G Client of MSGin5G UE-2 communicates with MSGin5G Client of MSGin5G
UE-1 over MSGin5G-6 reference point. The interface is based on NR PC5.
### 5.4.8 SEAL-C
The following SEAL-C reference points for MSGin5G Service are supported:
\- GM-C reference point for group management as specified in 3GPP TS 23.434
[5];
\- CM-C reference point for configuration management as specified in 3GPP TS
23.434 [5].
### 5.4.9 SEAL-S
The following SEAL-S reference points for MSGin5G Service are supported:
\- GM-S reference point for group management as specified in 3GPP TS 23.434
[5];
\- CM-S reference point for configuration management as specified in 3GPP TS
23.434 [5].
### 5.4.10 SEAL-UU
The following SEAL-UU reference points for MSGin5G Service are supported:
\- GM-UU reference point for group management as specified in 3GPP TS 23.434
[5];
\- CM-UU reference point for configuration management as specified in 3GPP TS
23.434 [5].
## 5.5 Capability exposure for enabling MSGin5G Service
### 5.5.1 MSGin5G application enabler layer adaptation to CAPIF
The MSGin5G Server and Application Server may support CAPIF. When CAPIF is
supported:
\- The MSGin5G Server shall support the CAPIF API provider domain functions
(i.e. CAPIF-2/2e, CAPIF-3/3e, CAPIF-4/4e and CAPIF-5/5e as specified in 3GPP
TS 23.222 [6]) as shown in Figure 5.5.1-1;
\- The Application Server shall act as API invoker and support the API invoker
functions (i.e. CAPIF-1/1e and CAPIF-2/2e as specified in 3GPP TS 23.222 [6])
as shown in Figure 5.5.1-1.
Figure 5.5.1-1: MSGin5G adaptation to the CAPIF architecture
## 5.6 Service based interface representation for MSGin5G Service
### 5.6.1 General
The Service based architecture for MSGin5G Service is represented using
functional entities and reference points between the functional entities as
specified in subclause 5.
### 5.6.2 Service based architecture
Figure 5.6.2-1 is the Service based Architecture for MSGin5G Service.
Figure 5.6.2-1: Service based MSGin5G Architecture
NOTE: The AS, L3G and N3G in this Service based MSGin5G Architecture are in
the same trust domain.
The M5S function is a service based function exhibited by MSGin5G Server.
The M5C function is the MSGin5G Client.
The AC is the application client.
The L3G function is a service based function exhibited by Legacy 3GPP Message
Gateway.
The N3G function is a service based function exhibited by Non-3GPP Message
Gateway.
The M5S manages the distribution of the messages it has received from MSGin5G
UE, from Application Server, or from N3G (on behalf of Non-3GPP UE) or from
L3G (on behalf of Legacy 3GPP UE).
The M5S invokes services provided by L3G/N3G to send MSGin5G Messages towards
Legacy 3GPP UE or Non-3GPP UE.
The AS/L3G/N3G invokes services provided by M5S to send MSGin5G Messages to
M5S on behalf of Legacy 3GPP UE or Non-3GPP UE.
The M5S invokes services provided by SEAL Group management function to do
MSGin5G Group management.
The M5S/L3G/N3G invokes services provided by SEAL Configuration management
function to do service configuration (including UE service ID provisioning).
### 5.6.3 Service based interfaces
Table 5.6.3-1 specifies the service based interfaces supported by MSGin5G
Service.
Table 5.6.3-1: Service based interfaces supported by MSGin5G Service
* * *
Service based interface Application function entity Mapping server entity APIs
offered Mm5s MSGin5G Server function MSGin5G Server Specified in 9.1 Ml3g
Legacy 3GPP Message Gateway function Legacy 3GPP Message Gateway Specified in
9.2.1 Mn3g Non-3GPP Message Gateway function Non-3GPP Message Gateway
Specified in 9.2.2
* * *
# 6 Identities
## 6.1 Identities for MSGin5G Service endpoints
### 6.1.1 General
MSGin5G Service endpoints shall be identified by unique identifiers within the
MSGin5G Service domain. For each MSGin5G Service endpoint the identifier shall
be a unique URI that can be used to identify the MSGin5G Service endpoint\'s
home service domain.
The following clauses describe different types if MSGin5G Service endpoint
identifiers.
### 6.1.2 UE Service Identity (UE Service ID)
UE Service ID is the identifier of a UE (i.e. MSGin5G UEs, Legacy 3GPP UEs and
Non-3GPP UEs).
For an MSGin5G UE, the assigned UE Service ID is used by the MSGin5G Client to
register with the MSGin5G Server and to send and receive MSGin5G messages. It
is used by the MSGin5G Server to authenticate and authorize the associated UE
to the MSGin5G Service at the application layer.
For a Legacy 3GPP UE or a Non-3GPP UE, the assigned UE Service ID is used by
the Message Gateway to register with the MSGin5G Server, to map into the
Service ID in their defined message delivery mechanisms for interworking, and
to send/receive MSGin5G messages to/from MSGin5G Server on behalf of Legacy
3GPP UE or Non-3GPP UE.
### 6.1.3 Application Server Service Identity (AS Service ID)
AS Service ID is the identifier of an Application Server. It is used to
perform mutual authentication with the MSGin5G Server for establishing a
secured service connection, and it is used to send/receive MSGin5G messages
to/from other MSGin5G Service endpoints via MSGin5G Server.
### 6.1.4 Message Gateway Service Identity (MGW Service ID)
MGW Service ID is the identifier of Message Gateway. It is used to perform
mutual authentication with the MSGin5G Server for establishing a secured
service connection, and it is used to send/receive MSGin5G messages to/from
MSGin5G Server on behalf of Legacy 3GPP UE or Non-3GPP UE.
## 6.2 MSGin5G Group Service Identity (Group Service ID)
The Group Service ID is a unique identifier within the MSGin5G Service that
represents a pre-defined MSGin5G Group. A pre-defined MSGin5G Group is
established before the MSGin5G Group messages are sent to it, and is assigned
a unique and permanent Group Service ID when it is established. This Group
Service ID shall be communicated to all members of the group. A service
endpoint (UE or Application Server) shall use this Group Service ID to send a
message to all members of the group.
The Group Service ID shall be a unique URI that can be used to identify where
the group is hosted.
## 6.3 Broadcast Area Service Identity (Broadcast Area ID)
The Broadcast Area ID is the identity of the Service Area where the broadcast
message is delivered.
## 6.4 MSGin5G UE Identity (MSGin5G UE ID)
The MSGin5G UE ID is a unique identifier that represents the MSGin5G UE (i.e.
the device identifier of the MSGin5G UE). The MSGin5G UE ID may be pre-
configured to the MSGin5G UE by its vendor.
## 6.5 Non-MSGin5G UE identity (Non-MSGin5G UE ID)
The Non-MSGin5G UE ID is a unique identifier that represents the Non-MSGin5G
UE in the Non-MSGin5G Service. A Non-MSGin5G UE ID is associated with a
specific Non-MSGin5G UE. It is used by the Message Gateway in the MSGin5G
Service to record the Non-MSGin5G UE. It is also used by the Message Gateway
as a part of VAL UE ID when the Message Gateway executes the Non-MSGin5G UE
configuration procedure on behalf of a Non-MSGin5G UE. The format of Non-
MSGin5G UE ID may differ among different VALs. The non-MSGin5G ID may be pre-
configured to the Non-MSGin5G UE by its vendor.
## 6.6 Application Identity (Application ID)
Application ID is an identifier that represents the application for which the
payload of message is intended. The content of Application ID is outside the
scope of this document.
## 6.7 MSGin5G Server address
MSGin5G Server address is the identifier of an MSGin5G Server within an
MSGin5G service provider\'s domain. The MSGin5G Service endpoints in this
MSGin5G service provider\'s domain can contact an MSGin5G Server by using the
MSGin5G Server address of this MSGin5G Server.
# 7 Generic description of the MSGin5G Service (informative)
## 7.1 General
Massive Internet of Things (MIoT) is one of key market segments of 5G. The
typical IoT device communication is sending and receiving small data which can
be delivered just in a message. The MSGin5G Service is designed and optimized
for massive IoT device communication including thing-to-thing communication
and person-to-thing communication.
The MSGin5G Service is a message enabler for applications. An Application
Client in a UE utilizes MSGin5G Service to send a message to another UE, to
multiple UEs or to the Application Server, or the Application Server utilizes
the MSGin5G Service to send a message to a UE or to multiple UEs. All messages
will be routed via the MSGin5G Server in the 5G system. The MSGin5G Service
flow is shown in figure 7.1-1.
If the UE supports a legacy 3GPP message service (e.g. SMS, NIDD, or CB) and
does not support the MSGin5G Service (i.e. UE has no MSGin5G Client), the
message will be translated to the appropriate message delivery mechanism by
the Legacy 3GPP Message Gateway. A UE that does not support any 3GPP message
service can connect to the MSGin5G Service via Non-3GPP Message Gateway that
facilitates the translation between the MSGin5G Service and non-3GPP message
delivery mechanism. The connection between such UE and the gateway can be via
3GPP access or non 3GPP access (e.g. WLAN) and is out of scope of the present
specification.
An Application Server resides outside the 3GPP domain and connects to the
MSGin5G Server via a CAPIF-aware reference point.
The message communication models include:
\- Point-to-Point messaging: message that is originated at a UE (UE A) and
terminated at another UE (UE B, a Legacy 3GPP UE or a Non-3GPP UE).
\- Application-to-Point messaging: message that is originated at an
Application Sever and terminated at a UE.
\- Point-to-Application messaging: message that is originated at a UE and
terminated at an Application Sever
\- Group Messaging: message that is originated at a UE or an Application
Server and is terminated at a group of UEs (a group member can be of type UE
A, Legacy 3GPP UE or Non-3GPP UE).
\- Broadcast Messaging: message that is originated at an Application Sever or
an MSGin5G UE and broadcasted to all the UEs in a specific Broadcast Area
within coverage of a cell or of multiple cells, existing broadcast function
(e.g. CB specified in 3GPP TS 23.041 [14]) may be reused in broadcast
messaging of MSGin5G Service.
Editor\'s note: How to send the broadcast message from MSGin5G Server to the
MSGin5G UE, Legacy 3GPP UE and Non-3GPP UE is FFS.
\- Topic Messaging: message that is originated at an Application Sever or a UE
and is delivered to all UEs and Application Server(s) that have subscribed to
the topic.
{width="6.691666666666666in" height="3.3722222222222222in"}
Figure 7.1-1: The MSGin5G Service overview
## 7.2 Service flow
Before a UE or an Application Server can use the MSGin5G Service it needs to
register with the MSGin5G Server.
A UE registers with its identity, its security credentials, the capabilities
that it supports, and its availability. The MSGin5G Server will use the
availability registration and de-registration to determine if the UE is
available for message delivery. If a UE is unavailable for message delivery,
the MSGin5G Server will store the message and deliver it once the UE becomes
available again.
When a UE or an Application Server sends an MSGin5G message to a recipient UE
then such message will be sent to the MSGin5G Server and this server will
deliver the message to the UE based on the capabilities of the recipient UE
(MSGin5G UE, Legacy 3GPP UE or Non-3GPP UE). If the recipient UE is a Legacy
3GPP UE then the MSGin5G Server will forward the message to the Legacy 3GPP
Message Gateway and this gateway will convert the message to a message that is
supported by the recipient UE (e.g. SMS, NIDD or CB). If the recipient UE is a
Non-3GPP UE then the MSGin5G Server will forward the message to the Non-3GPP
Message Gateway and this gateway will convert the message to a message that is
supported by the recipient UE.
A Legacy 3GPP UE sends the application payload to the Legacy 3GPP Message
Gateway and this gateway will forward the application payload in an MSGin5G
message to the MSGin5G Server, which will deliver the message to the recipient
UE(s). A Non-3GPP UE sends the application payload to the Non-3GPP Message
Gateway and this gateway will forward the application payload in an MSGin5G
message to the MSGin5G Server, which will deliver the message to the recipient
UE(s).
NOTE: Conversion by a Message Gateway is out of scope of the present
specification.
If a UE or an Application Server sends an MSGin5G message to a group of UEs,
the MSGin5G Server will deliver the message to all group members taking into
account if such a UE is an MSGin5G UE, a Legacy 3GPP UE or a Non-MSGin5G UE
and if such UE is available for delivery.
If a UE or an Application Server sends an MSGin5G message containing a
Messaging Topic to the MSGin5G Server, the MSGin5G Server will distribute the
message to all UEs and Application Servers that have subscribed to that topic.
If a UE or an Application Server sends a broadcast message to a Broadcast
Area, the MSGin5G Server forwards the message to the Legacy 3GPP Message
Gateway and this gateway will forward the message to the broadcast function.
Editor\'s note: For broadcast messaging, whether the Legacy 3GPP Message
Gateway is enough and technically right for broadcasting message to all UEs is
FFS.
An originating UE or Application Server may request the recipient UE(s) to
acknowledge reception of the message. If such a request is made, a message
delivery status report shall be sent by the recipient MSGin5G UE or the
Message Gateway (on behalf of the Non-MSGin5G UE) as a point-to-point message
back to the originating UE or Application Server. The acknolwedgement
information is included in the payload and the format of this information is
out of scope of the present specification.
The Non-MSGin5G UE may respond to an incoming MSGin5G message; it is subject
to the Message Gateway implementation to maintain the transaction of the
incoming MSGin5G message and reply to it to the sender, with the response it
receives from the Non-MSGin5G UE.
# 8 Procedures and information flows
## 8.1 Configuration
### 8.1.1 General
The configuration procedure is used to get the MSGin5G Service configuration
information (e.g. UE Service ID). The configuration procedure is used by the
MSGin5G UE or used by Message Gateway on behalf of the Non-MSGin5G UE. The
MSGin5G Service configuration information is used in the future messaging
communication.
The VAL UE configuration data specified in TS 23.434 [5] is used in this
configuration procedure. After the configuration procedure, the MSGin5G UE, or
the Message Gateway on behalf of the Non-MSGin5G UE can register to MSGin5G
Server.
NOTE 1: The configuration on the Message Gateway to support the Non-MSGin5G UE
for MSGin5G Service can also be done without using the SEAL configuration
procedures and is implementation specific.
NOTE 2: The MSGin5G Service configuration information can also be pre-
configured to the MSGin5G UE/Non-MSGin5G UE and is implementation specific.
### 8.1.2 MSGin5G UE Configuration
In the MSGin5G UE configuration procedure, the MSGin5G UE acts as
Configuration management client specified in 3GPP TS 23.434 [5].
The following steps of configuration management service apply for the MSGin5G
UE:
\- Send the Get VAL UE configuration request specified in clause 11.3.2.1 of
3GPP TS 23.434 [5];
\- Receive the related Get VAL UE configuration response specified in clause
11.3.2.2 of 3GPP TS 23.434 [5];
The usage of the above information flows is clarified as below:
\- The MSGin5G UE ID works as VAL UE ID which is mandatory in the Get VAL UE
configuration request;
\- The UE Service ID works as VAL user ID;
\- The service identifier of MSGin5G Service works as VAL service ID;
Besides the IEs specified in clause 11.3.2.1 of 3GPP TS 23.434 [5], the
information in table 8.1.2-1 is also included in the Get VAL UE configuration
request.
Table 8.1.2-1: Additional Information in the Get VAL UE configuration request
* * *
Information element Status Description MSGin5G UE information O Other
information needed by the configuration procedure. (see NOTE) NOTE: The
information can be the device type, device vendor, etc. It is specified by
application provider or MSGin5G Service provider and is out of scope of this
document. The MSGin5G Service provider can configure the MSGin5G UE with
different configuration data based on this IE. E.g. all sensors can be
configured to a same MSGin5G Server.
* * *
The information in table 8.1.2-2 is included in the Get VAL UE configuration
response as a part of VAL UE configuration data.
Table 8.1.2-2: Information in the Get VAL UE configuration response
* * *
Information element Status Description UE Service ID M UE Service ID assigned
to the requesting MSGin5G UE. MSGin5G Server address M The MSGin5G Server
which serves this MSGin5G UE. MSGin5G Service specific information O The
specific information of the MSGin5G Service specified by the MSGin5G Service
provider. (see NOTE) NOTE: E.g. the segment size of MSGin5G message in this
service provider. The detailed definition is out of scope of this document.
* * *
Besides the functionalities of Configuration Management Server specified in
3GPP TS 23.434 [5], the MSGin5G Configuration Function should also checks
whether the MSGin5G UE ID (i.e. VAL UE ID) is included in a former Get VAL UE
configuration request.
\- If so, the MSGin5G Configuration Function included the UE Service ID
assigned to the MSGin5G UE in the former configuration procedure as a part of
VAL UE configuration data,
\- Otherwise, a new UE Service ID is assigned to the MSGin5G UE and included
in the VAL UE configuration data.
Then the MSGin5G Configuration Function processes the configuration request
according to the service policy.
### 8.1.3 Non-MSGin5G UE Configuration
When a Non-MSGin5G UE interacts to the Message Gateway first time (e.g. a Non-
MSGin5G UE sends a message to an MSGin5G UE/Application Server or vice versa),
the Message Gateway records the Non-MSGin5G UE ID and performs the
configuration procedure on behalf of the Non-MSGin5G UE to get the MSGin5G
Service configuration information (e.g. UE Service ID).
NOTE 1: All the necessary service information (including the UE Service ID) of
a Non-MSGin5G UE can be pre-configured with the Message Gateway before the
Non-MSGin5G UE first uses the MSGin5G Service. This configuration procedure is
outside the scope of the current specification.
In the Non-MSGin5G UE configuration procedure, the Message Gateway acts as
Configuration management client specified in 3GPP TS 23.434 [5] on behalf of
each Non- MSGin5G UE.
The following steps of configuration management service may apply for the
Message Gateway:
\- Send the Get VAL UE configuration request specified in clause 11.3.2.1 of
3GPP TS 23.434 [5];
\- Receive the related Get VAL UE configuration response specified in clause
11.3.2.2 of 3GPP TS 23.434 [5];
The usage of the above information flows is clarified as below:
\- An Information Element contains both Non-MSGin5G UE ID and MGW Service ID
works as VAL UE ID which is mandatory in the Get VAL UE configuration request;
NOTE 2: The Non-MSGin5G UE ID may differ among different VALs and may not
unique among different Gateways. It is not enough to use only Non-MSGin5G UE
ID as VAL UE ID.
\- The UE Service ID works as VAL user ID;
\- The service identifier of MSGin5G Service works as VAL service ID;
Besides the IEs specified in clause 11.3.2.1 of 3GPP TS 23.434 [5], the
information in table 8.1.3-1 is also included in the Get VAL UE configuration
request.
Table 8.1.3-1: Additional Information in the Get VAL UE configuration request
* * *
Information element Status Description Non-MSGin5G UE information O Other
information needed by the configuration procedure. (see NOTE) NOTE: The
information can be the device type, device Vendor, etc. It is specified by
application provider or MSGin5G Service provider and is out of scope of this
document. The MSGin5G Service provider can configure the Non-MSGin5G UE with
different configuration data based on this IE. E.g. all sensors can be
configured to a same MSGin5G Server.
* * *
The information in table 8.1.3-2 is included in the Get VAL UE configuration
response as a part of VAL UE configuration data.
Table 8.1.3-2: Information in the Get VAL UE configuration response
* * *
Information element Status Description UE Service ID M UE service ID assigned
to the requesting Non-MSGin5G UE. MSGin5G Server address M The MSGin5G Server
which serves this MSGin5G UE. MSGin5G Service specific information O The
specific information of the MSGin5G Service specified by the MSGin5G Service
provider. (see NOTE) NOTE: E.g. the segment size of MSGin5G message in this
service provider, the detailed definition is out of scope of this document.
* * *
Editor\'s note: The definition of MSGin5G Server address is needed to be
added.
Besides the functionalities of Configuration Management Server specified in
3GPP TS 23.434 [5], the MSGin5G Configuration Function should also check
whether the MSGin5G UE ID (i.e. VAL UE ID) is included in a former Get VAL UE
configuration request.
\- If so, the MSGin5G Configuration Function included the UE Service ID
assigned to the MSGin5G UE in the former configuration procedure as a part of
VAL UE configuration data,
\- Otherwise, a new UE Service ID is assigned to the MSGin5G UE and included
in the VAL UE configuration data.
Then the MSGin5G Configuration Function processes the configuration request
according to the service policy.
## 8.2 Registration
### 8.2.1 MSGin5G UE Registration
The signalling flow for MSGin5G UE registration is illustrated in figure
8.2.1-1. The procedure assumes that the MSGin5G UE is responsible for
initiating registration to the MSGin5G Server in order to establish
association with the MSGin5G Server to receive MSGin5G Services.
Pre-conditions:
1\. The MSGin5G UE has connected to the serving network successfully.
2\. A UE Service ID has been provisioned on the MSGin5G UE.
3\. The MSGin5G Server address has been provisioned on the MSGin5G UE.
4\. Both the MSGin5G UE and MSGin5G Server have been configured with the
necessary credentials to enable authenticating one another.
Figure 8.2.1-1: MSGin5G Client registration
1\. The MSGin5G UE sends an MSGin5G UE registration request to the MSGin5G
Server. The request includes security credentials required for the MSGin5G
Client to register to the MSGin5G Server. The request includes the UE Service
ID and MSGin5G Client Profile information as detailed in Table 8.2.1-1.
Table 8.2.1-1: MSGin5G UE registration request
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the requesting MSGin5G UE. UE credential information M The
information needed to authenticate the UE. The authentication and
authorization between MSGin5G client and MSGin5G Server are specified in Annex
Y.2 of 3GPP TS 33.501 [16]. MSGin5G Client Profile O Set of parameters
describing the MSGin5G Client >MSGin5G Client Triggering Information O UE
Identifier (i.e., MSISDN, external ID), port number(s) and associated protocol
(e.g., SMS, NIDD, etc.) for device triggering. The MSGin5G Server uses the
information in step 5 of clause 8.8.3. See Table 8.2.1-2. >MSGin5G Client
Communication Availability O Communication availability information for the
MSGin5G Client to receive MSGin5G messages. This IE informs the MSGin5G Server
if the client has a specific application-level schedule/periodicity to its
MSGin5G communications, which may be used in conjunction with UE reachability
monitoring to determine whether and when MSGin5G communications are attempted.
See Table 8.2.1-3.
* * *
Table 8.2.1-2: MSGin5G Client Triggering Information
* * *
Information element Status Description MSGin5G UE ID M Identity of the UE
hosting the MSGin5G Client (e.g., the External Identifier defined in TS 23.682
[19], or an MSISDN) MSGin5G Client Ports M List of port numbers that the
MSGin5G Client listens on for device triggers from the MSGin5G Server. Also
included with each port number is an associated protocol (e.g., SMS, NIDD,
etc.).
* * *
Table 8.2.1-3: MSGin5G Client and Non-MSGin5G UE Communication Availability
* * *
Information element Status Description Scheduled communication time M Time
when the UE becomes available for communication. Communication duration time M
Duration time of periodic communication. Periodic communication indicator O
Identifies whether the client communicates periodically or not, e.g., on
demand. Periodic communication interval O Interval Time of periodic
communication. This IE is mandatory if the Periodic communication indicator
indicates periodic communications. Data size indication O Indicates the
expected data size to be exchanged during the communication duration. Store
and forward option O Indicates opting out of store and forward services for
incoming MSGin5G requests.
* * *
Editor\'s note: Whether MSGin5G client capabilities are needed is FFS.
2\. Upon receiving the request, the MSGin5G Server validates the registration
request and verifies the security credentials.
3\. The MSGin5G Server sends an MSGin5G UE registration response to the
MSGin5G UE. If the registration is successful, the MSGin5G Server stores the
MSGin5G Client Profile information.
Table 8.2.1-4: MSGin5G UE registration response
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the requesting MSGin5G UE. Registration result M Indication if the
registration is success or failure
* * *
### 8.2.2 MSGin5G UE De-Registration
By de-registering, the MSGin5G UE informs the MSGin5G Server that it wishes to
terminate its association with the MSGin5G Server.
NOTE: De-registration implies that Client Triggering Information and the
Client Communication Availability Information are no longer valid.
The procedure assumes that the MSGin5G UE is responsible for initiating the
de-registration from the MSGin5G Server. The signalling flow for MSGin5G UE
de-registration is illustrated in figure 8.2.2-1.
Pre-conditions:
> 1\. The MSGin5G UE is registered to the MSGin5G Server.
Figure 8.2.2-1: MSGin5G UE de-registration
1\. The MSGin5G UE determines to de-register from the MSGin5G Server.
2\. The MSGin5G UE sends an MSGin5G UE de-registration request to the MSGin5G
Server that includes the UE Service ID, as detailed in Table 8.2.2-1.
Table 8.2.2-1: MSGin5G UE de-registration request
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the Non-MSGin5G UE. UE credential information M The information
needed to authenticate the UE. The authentication and authorization between
MSGin5G client and MSGin5G Server are specified in Annex Y.2 of 3GPP TS 33.501
[16].
* * *
3\. The MSGin5G Server validates the MSGin5G UE de-registration request and
verifies the security credentials. The MSGin5G Server deletes any applicable
MSGin5G Client Profile information that it has stored.
4\. The MSGin5G Server an MSGin5G UE de-registration response as detailed in
Table 8.2.2-2 to the MSGin5G UE.
Table 8.2.2-2: MSGin5G UE de-registration response
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the non-SGin5G UE. De-registration result M Indication if the de-
registration is success or failure
* * *
### 8.2.3 Non-MSGin5G UE Registration
Non-MSGin5G UEs (i.e., Legacy 3GPP UEs or Non-3GPP UEs) are connected to the
MSGin5G Server through a Message Gateway. The Message Gateway performs
registration with the MSGin5G Server on behalf of the Non-3GPP UEs, based on
the registration request from the Non-3GPP UE or on pre-provisioned
information. After the procedure is complete, the Message Gateway may
communicate the result to the UE to enable MSGin5G Services at the Non-3GPP
UEs.
The signalling flow is illustrated in figure 8.2.3-1.
Pre-conditions:
1\. The Message Gateway has been pre-provisioned with the MSGin5G Server
address and UE Service ID for a Non-3GPP UE.
2\. Both the Non-3GPP UE and Message Gateway have been configured with the
necessary credentials to enable authentication and Non-3GPP UE registration at
the Message Gateway.
3\. A secured connection has been established between the Message Gateway and
the MSGin5G Server.
Figure 8.2.3-1: Non-MSGin5G UE registration
1\. The Non-MSGin5G UE registers at the Message Gateway. Alternatively, the
Non-MSGin5G UE registration information is configured at the Message Gateway.
The Message Gateway, based on the registration request and pre-provisioned
information, registers the UE with the MSGin5G Server, a corresponding UE
Service ID and, if available, a Non-MSGin5G UE profile.
Table 8.2.3-1: Non-MSGin5G UE registration request
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the requesting Non-MSGin5G UE. MGW Service ID M The service
identifier of the Message Gateway performing registration on behalf of a Non-
MSGin5G UE UE credential information M The information needed to authenticate
the UE. The authentication and authorization between MSGin5G client and
MSGin5G Server are specified in Annex Y.2 of 3GPP TS 33.501 [16]. Non-MSGin5G
UE Profile O Set of parameters describing the Non-MSGin5G UE >Non-MSGin5G UE
Communication Availability O Communication availability information for the
Non-MSGin5G UE to receive messages. This IE informs the MSGin5G Server if the
UE has a specific application-level schedule/periodicity to its MSGin5G
communications, which may be used to determine whether and when MSGin5G
communications are attempted. See Table 8.2.1-3.
* * *
2\. The Message Gateway sends the Non-MSGin5G UE registration request to the
MSGin5G Server. The request includes the information detailed in Table
8.2.3-1.
3\. The MSGin5G Server authenticates the Message Gateway and authorises the
Non-MSGin5G UE to receive the MSGin5G Service. The MSGin5G Server records the
UE\'s availability for MSGin5G Service.
4\. The MSGin5G Server returns the result of the registration in the Non-
MSGin5G UE registration response message with the information detailed in
table 8.2.2-2.
### 8.2.4 Non-MSGin5G UE De-registration
The Message Gateway performs de-registration with the MSGin5G Server on behalf
of the Non-MSGin5G UEs, in order to terminate services from the MSGin5G
Server. After the procedure is complete, the Message Gateway communicates the
result to the requesting UE.
The procedure assumes that the Non-MSGin5G UE is responsible for initiating
the de-registration from the MSGin5G Server. The signaling flow for Non-
MSGin5G UE de-registration is illustrated in figure 8.2.4-1.
Pre-conditions:
1\. The Message Gateway successfully performed registration with the MSGin5G
Server on behalf of the Non-MSGin5G UE.
Figure 8.2.4-1 : Non-MSGin5G UE de-registration
1\. The Message Gateway determines to de-register the Non-MSGin5G UE with the
MSGin5G Server.
2\. The Message Gateway sends a Non-MSGin5G UE de-registration request to the
MSGin5G Server that includes the UE Service ID associated with the Non-MSGin5G
UE, as shown in Table 8.2.4-1.
Table 8.2.4-1: Non-MSGin5G UE de-registration request
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the Non-MSGin5G UE. UE credential information M The information
needed to authenticate the UE. The authentication and authorization between
MSGin5G client and MSGin5G Server are specified in Annex Y.2 of 3GPP TS 33.501
[16].
* * *
3\. The MSGin5G Server validates the Non-MSGin5G UE de-registration request
and verifies the security credentials. The MSGin5G Server deletes any
applicable MSGin5G Client Profile information that it has stored.
4\. The MSGin5G Server deletes any applicable information that it has stored
and replies with a Non-MSGin5G UE de-registration response as shown in table
8.2.4-2.
Table 8.2.4-2: Non-MSGin5G UE De-registration response
* * *
Information element Status Description UE Service ID M UE service identifier
assigned to the Non-MSGin5G UE. De-registration result M Indication if the de-
registration is success or failure
* * *
Editor\'s note: Support for bulk registration and de-registration of Non-
MSGin5G UE s (i.e., registering more than one UE Service ID at the same time)
is FFS.
8.2.5 Application Server Registration
The signalling flow for Application Server registration is illustrated in
figure 8.2.5-1. Application Server may use the procedure in this clause to do
registration. The procedure assumes that the Application Server is responsible
for triggering registration to the MSGin5G Server in order to establish
association with the MSGin5G Server to receive MSGin5G Service.
NOTE: The procedure in this clause is optional for Application Server
registration.
Pre-conditions:
1\. The Application Server has connected to the serving network successfully.
2\. An AS Service ID has been provisioned.
3\. The MSGin5G Server address has been provisioned on the Application Server.
4\. Both the Application Server and MSGin5G Server have been configured with
the necessary credentials to enable authenticating one another.
Figure 8.2.5-1: Application Server registration
1\. The Application Server sends an Application Server registration request to
the MSGin5G Server. The request includes security credentials required for the
Application Server to register to the MSGin5G Server. The request includes the
AS Service ID and Application Server Profile information as detailed in Table
9.1.2.3-1.
2\. Upon receiving the request, the MSGin5G Server validates the Application
Server registration request and verifies the security credentials. The
authentication and authorization between Application Server and MSGin5G Server
are specified in Annex Y.4 of 3GPP TS 33.501 [16].
3\. The MSGin5G Server sends an Application Server registration response to
the Application Server, the response includes the information elements as
specified in Table 9.1.2.4-1. If the registration is successful, the MSGin5G
Server stores the AS Profile information as detailed in Table 9.1.2.3-1.
8.2.6 Application Server De-registration
By de-registering, the Application Server informs the MSGin5G Server that it
wishes to terminate its association with the MSGin5G Server.
The procedure assumes that the Application Server is responsible for
triggering the de-registration from the MSGin5G Server. The signalling flow
for Application Server de-registration is illustrated in figure 8.2.6-1.
Pre-conditions:
1\. The Application Server is registered to the MSGin5G Server.
Figure 8.2.6-1: Application Server de-registration
1\. The Application Server determines to de-register from the MSGin5G Server.
2\. The Application Server sends an Application Server de-registration request
to the MSGin5G Server that includes the AS Service ID, as detailed in Table
9.1.2.5-1.
3\. The MSGin5G Server validates the Application Server de-registration
request and verifies the security credentials. The authentication and
authorization between Application Server and MSGin5G Server are specified in
Annex Y.4 of 3GPP TS 33.501 [16]. The MSGin5G Server deletes any applicable AS
Profile information that it has stored.
4\. The MSGin5G Server replies an Application Server de-registration response
as detailed in Table 9.1.2.6-1.
## 8.3 Message delivery procedures into and from MSGin5G Server
### 8.3.1 General
All MSGin5G message traffic is routed via the MSGin5G Server. The present
clause specifies all MSGin5G message traffic towards and from the MSGin5G
Server.
Editor\'s note: Alignment of this solution with the architecture and the
conclusions from the study is FFS.
### 8.3.2 MSGin5G inbound messages into the MSGin5G Server
Figure 8.3.2-1 shows the procedure for an MSGin5G UE that initiates an MSGin5G
message request.
Figure 8.3.2-1: New MSGin5G message request from UE
Figure 8.3.2-2 shows the procedure for an Application Server that initiates an
API request specified in clause 9.1.1.1 for sending an MSGin5G message to UE.
Figure 8.3.2-2: Application Server initiates a request for sending an MSGin5G
message
Figure 8.3.2-3 shows the procedure for a Legacy 3GPP Message Gateway or a
non-3GPP Message Gateway that sends a new MSGin5G message request to the
MSGin5G Server on behalf of a Legacy 3GPP UE or Non-3GPP UE.
Figure 8.3.2-3: New MSGin5G message request sending from Message Gateway
The following procedure applies to the above figures 8.3.2-1, 8.3.2-2 and
8.3.2-3 with the exception that step 1 only applies to figure 8.3.2-1.
1\. The Application Client in the UE sends a request to the MSGin5G Client for
invoking the MSGin5G Client to send a new MSGin5G message to a recipient or to
multiple recipients.
Editor\'s note: Whether the APIs provided by the MSGin5G Client to the
Application Client is to be specified in another clause of the TS is FFS.
2\. As shown in figure 8.3.2-1 or 8.3.2-3, the MSGin5G Client or Message
Gateway sends the MSGin5G message request to the MSGin5G Server and includes
the IEs as listed in table 8.3.2-1 in the request; or as shown in figure
8.3.2-2, the Application Server sends an API request to the MSGin5G Server for
sending an MSGin5G message, the API request includes the IEs as listed in
table 8.3.2-1.
NOTE: If the value of the Store and forward flag IE in the MSGin5G message
request indicates that store and forward services are requested by the sender,
the procedure in 8.3.x. applies instead.
Table 8.3.2-1: Request to MSGin5G Server for sending MSGin5G message
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | Originating UE Service | M | The service identity of the | | ID/AS Service ID | | sending MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | | | or the sending Application | | | | Server. | +-----------------------------+--------+-----------------------------+ | Recipient UE Service ID/AS | O | The service identity of the | | Service ID | | receiving MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | (see NOTE 1, NOTE 2) | | or the receiving | | | | Application Server. | | | | | | | | This IE is mandatory for | | | | Point-to-Point messaging, | | | | Application-to-Point | | | | messaging, AOMT messaging | | | | and MOAT messaging and is | | | | not present in other | | | | message scenarios. | +-----------------------------+--------+-----------------------------+ | Group Service ID | O | The service identifier of | | | | the target MSGin5G Group. | | (see NOTE 1) | | | | | | This IE is mandatory for a | | | | Group Message and is not | | | | present in other message | | | | scenarios. | +-----------------------------+--------+-----------------------------+ | Broadcast Area ID | O | The service identifier of | | | | the Broadcast Service Area | | (see NOTE 1) | | where the message needs to | | | | be broadcast. | | | | | | | | This IE is mandatory in the | | | | Broadcast Message and is | | | | not present in other | | | | message scenarios. | +-----------------------------+--------+-----------------------------+ | Messaging Topic (see NOTE | O | Indicates which Messaging | | 1) | | Topic this message is | | | | related to. | | | | | | | | This IE is mandatory for a | | | | message distribution based | | | | on topic and is not present | | | | in other message scenarios. | +-----------------------------+--------+-----------------------------+ | Application ID | O | Identifies the | | | | application(s) for which | | | | the payload is intended. | | | | | | | | This list of Application | | | | IDs IE is required when the | | | | message is sent to one or | | | | multiple Application | | | | Clients served by same | | | | MSGin5G Client. | | | | | | | | This list of Application | | | | IDs IE may be included when | | | | the message is sent to an | | | | Application Server or to an | | | | Application Client. | | | | | | | | MSGin5G Server is unaware | | | | of the content. | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of this | | | | message. | +-----------------------------+--------+-----------------------------+ | Security credentials | O | Security information | | | | required by the MSGin5G | | | | Server. | | | | | | | | This is a placeholder for | | | | SA3 security information. | +-----------------------------+--------+-----------------------------+ | Delivery status required | O | Indicates if delivery | | | | acknowledgement from the | | | | recipient is requested. | +-----------------------------+--------+-----------------------------+ | Payload | O | Payload of the message. | | | | | | | | MSGin5G Server/Client is | | | | unaware of the content. | | | | | | | | If the request is sent from | | | | MSGin5G Client or Message | | | | Gateway to the MSGin5G | | | | Server, the maximum size of | | | | this IE is a configurable | | | | value that shall not exceed | | | | 2048 octets. | +-----------------------------+--------+-----------------------------+ | Priority type | O | Application priority level | | | | requested for this message. | +-----------------------------+--------+-----------------------------+ | Message is segmented | O | Indicates this message is | | | | part of a segmented | | | | message. | +-----------------------------+--------+-----------------------------+ | Segmentation set identifier | O | All segmented messages | | | | associated within the same | | | | set of segmented messages | | | | (i.e. associated with the | | | | same MSGin5G message) are | | | | assigned the same unique | | | | identifier. | | | | | | | | Mandatory IE to be present | | | | in every segmented message. | +-----------------------------+--------+-----------------------------+ | Total number of message | O | Indicates the total number | | segments | | of segments for the | | | | message. | | | | | | | | The Total Segments needs to | | | | be included only in the | | | | first segment of the | | | | message. | +-----------------------------+--------+-----------------------------+ | Message segment number | O | An incrementing message | | | | segment number that | | | | indicates segmented message | | | | number of each segmented | | | | message within a set of | | | | segmented messages | +-----------------------------+--------+-----------------------------+ | Last segment flag | O | An indicator of whether | | | | this segmented message is | | | | the last segment in the set | | | | of segmented messages or | | | | not. | | | | | | | | The Last Segment Flag needs | | | | to be included only in the | | | | last segment of the | | | | message. Message segment | | | | number of the segment with | | | | \"Last Segment Flag\" set | | | | can be considered as total | | | | segments. | +-----------------------------+--------+-----------------------------+ | Store and forward flag | M | An indicator of whether | | | | store and forward services | | | | are requested for this | | | | message. If the value | | | | indicates that store and | | | | forward services are | | | | requested by the sender, | | | | the store and forward | | | | procedure in clause X | | | | applies. | +-----------------------------+--------+-----------------------------+ | Store and forward | O | Parameters used by MSGin5G | | parameters | | Server for providing store | | | | and forward services, as | | | | detailed in table 8.3.2-2. | | | | This IE shall be included | | | | only if the value of the | | | | Store and forward flag IE | | | | indicates that store and | | | | forward services are | | | | requested. The MSGin5G | | | | store and forward procedure | | | | is detailed in clause X. | +-----------------------------+--------+-----------------------------+ | NOTE 1: Only one of these | | | | IEs shall be included to | | | | represent the type of | | | | message request. The | | | | MSGin5G client may | | | | construct the related IEs | | | | based on the information | | | | received from Application | | | | Client, e.g. adds the | | | | MSGin5G service domain. | | | | | | | | NOTE 2: When the originator | | | | is an Application Server, | | | | (i.e. Originating AS | | | | Service ID is present), | | | | this IE shall be a UE | | | | Service ID. | | | +-----------------------------+--------+-----------------------------+
Table 8.3.2-2: Store and forward parameters
* * *
**Value** **Status** **Description** Message expiration time O Indicates
message expiration time used for providing store and forward services if the
destination is not available for communications, The MSGin5GServer attempts
delivery at or before the message expiration time, or when the recipient
becomes available. Application specific store and forward information O
Application specific information about store and forward handling, e.g. a
delivery time/date.
* * *
3\. The MSGin5G Server authenticates the message and verifies that the sender
is authorized to send the message.
4\. The MSGin5G Server may send a Message response to the originating entity
if the message is rejected or stored and includes the IEs as listed in table
8.3.2-3 in the response.
Table 8.3.2-3: Message Response
* * *
Information element Status Description Originating UE Service ID/AS Service ID
M The identity of the MSGin5G Client, Legacy 3GPP UE, Non-3GPP UE or the
identity of the Application Server that initiated the previous Request.
Message ID M Identifier of the initiating Request. Delivery Status O Indicates
if delivery is a failure, or if the message is stored for deferred delivery.
Failure Cause O The reason for failure
* * *
### 8.3.3 MSGin5G outbound messages from the MSGin5G Server
Figure 8.3.3-1 shows the procedure for the MSGin5G Server that forwards an
MSGin5G message.
Figure 8.3.3-1: MSGin5G message towards UE
Figure 8.3.3-2 shows the same procedure (step 1 only), however for the MSGin5G
Server that sends the message to an Application Server by application request.
Figure 8.3.3-2: message towards an Application Server
Figure 8.3.3-3 shows the procedure for the MSGin5G Server that sends an
MSGin5G message to a Legacy 3GPP Message Gateway or a Non-3GPP Message
Gateway.
Figure 8.3.3-3: MSGin5G message towards a Message Gateway
The following procedure applies to the above figures 8.3.3-1, 8.3.3-2 and
8.3.3-3 with the exception that step 2 only applies to figure 8.3.3-1.
1\. The MSGin5G Server sends the MSGin5G message request and includes the IEs
as listed in table 8.3.3-1.
Table 8.3.3-1: MSGin5G message request from MSGin5G Server
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | Originating UE Service | M | The service identity of the | | ID/AS Service ID | | originating MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | | | or the originating | | | | Application Server. | | | | | | | | This IE is copied from the | | | | associated inbound message. | +-----------------------------+--------+-----------------------------+ | Recipient UE Service ID/AS | O | The service identity of the | | Service ID | | receiving entity. | | | | | | (see NOTE1, NOTE 2) | | This IE is present in case | | | | the recipient is an | | | | individual UE or | | | | Application Server | | | | | | | | For Point-to-Point | | | | messaging, | | | | Application-to-Point | | | | mes | | | | saging/Point-to-Application | | | | messaging, this IE is | | | | copied from the associated | | | | inbound message. | | | | | | | | For Group messaging, this | | | | IE can be a Recipient UE | | | | Service ID only. This IE is | | | | fetched from the | | | | participant information of | | | | the recipient in the group | | | | profile. | | | | | | | | For message delivery based | | | | on Messaging Topic | | | | subscription, this IE is | | | | the UE Service ID/AS | | | | Service ID of the Messaging | | | | Topic subscriber. | +-----------------------------+--------+-----------------------------+ | Broadcast Area ID | O | The identifier of the | | | | Service Area where the | | (see NOTE 1) | | message needs to be | | | | broadcast. | | | | | | | | This IE is mandatory in the | | | | Broadcast Message and is | | | | not present in other | | | | message scenarios. | | | | | | | | This IE is copied from the | | | | associated inbound message. | +-----------------------------+--------+-----------------------------+ | Application ID | O | Identifies the application | | | | for which the payload is | | | | intended. | | | | | | | | This list of Application | | | | ID(s) IE is required when | | | | the message is sent to one | | | | or multiple Application | | | | Clients served by same | | | | MSGin5G Client. This list | | | | of Application ID(s) IE may | | | | be included when the | | | | message is sent to an | | | | Application Server or to an | | | | Application Client. | | | | | | | | This list of IEs is copied | | | | from the associated inbound | | | | message. | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of this | | | | message. | | | | | | | | This IE is copied from the | | | | associated inbound message | | | | request. | +-----------------------------+--------+-----------------------------+ | Delivery status required | O | Indicates if delivery | | | | acknowledgement from the | | | | recipient is requested. | | | | | | | | This IE is copied from the | | | | associated inbound message. | +-----------------------------+--------+-----------------------------+ | Payload | O | Payload of the message. | | | | | | | | This IE is copied from the | | | | associated inbound message. | +-----------------------------+--------+-----------------------------+ | Message is segmented | O | Indicates this message is | | | | part of a segmented | | | | message. | +-----------------------------+--------+-----------------------------+ | Group Service ID | O | The service identifier of a | | | | Group. | | | | | | | | This IE is included if | | | | message delivery is based | | | | on Group messaging. | | | | | | | | This IE is copied from the | | | | Recipient Group Service ID | | | | IE in the associated | | | | inbound message. | +-----------------------------+--------+-----------------------------+ | Messaging Topic | O | Indicates which Messaging | | | | Topic this message is | | | | related to. | | | | | | | | This IE is included if | | | | message delivery is based | | | | on a Messaging Topic | | | | subscription. | | | | | | | | This IE is copied from the | | | | Messaging Topic IE in the | | | | associated inbound message. | +-----------------------------+--------+-----------------------------+ | Segmentation Set Identifier | O | All segmented messages | | | | associated within the same | | | | set of segmented messages | | | | (i.e. associated with the | | | | same MSGin5G message) are | | | | assigned the same unique | | | | identifier. | | | | | | | | Mandatory IE to be present | | | | in every segmented message. | +-----------------------------+--------+-----------------------------+ | Total number of message | O | Indicates the total number | | segments | | of segments for the | | | | message. | | | | | | | | The Total Segments needs to | | | | be included only in the | | | | first segment of the | | | | message. | +-----------------------------+--------+-----------------------------+ | Message segment number | O | An incrementing message | | | | segment number that | | | | indicates segmented message | | | | number of each segmented | | | | message within a set of | | | | segmented messages. | +-----------------------------+--------+-----------------------------+ | Last Segment Flag | O | An indicator of whether | | | | this segmented message is | | | | the last segment in the set | | | | of segmented messages or | | | | not. | | | | | | | | The Last Segment Flag needs | | | | to be included only in the | | | | last segment of the | | | | message. Message segment | | | | number of the segment with | | | | \"Last Segment Flag\" set | | | | can be considered as total | | | | segments. | +-----------------------------+--------+-----------------------------+ | NOTE 1: Only one of these | | | | IEs shall be included to | | | | represent the type of | | | | message request. The | | | | MSGin5G client may | | | | construct the IEs specified | | | | in table 8.11.5-1 based on | | | | the IEs above in the | | | | received MSGin5G message, | | | | e.g. removes the MSGin5G | | | | service domain, if the | | | | Payload is sent to | | | | Application Client. | | | | | | | | NOTE 2: When the originator | | | | is an Application Server, | | | | (i.e. Originating AS | | | | Service ID is present), | | | | this IE shall be a UE | | | | Service ID. | | | +-----------------------------+--------+-----------------------------+
If the received MSGin5G message request is for Group Message, the MSGin5G
Server shall, in addition to the Recipient Group Service ID IE, add the
Recipient UE Service ID of each individual group member, excluding the message
originator.
If the received MSGin5G message request is for a Topic Message, the MSGin5G
Server shall, in addition to the Messaging Topic IE, add the Recipient UE
Service ID/AS Service ID of each individual Topic subscriber, excluding the
message originator.
### 8.3.4 MSGin5G message delivery status report into the MSGin5G Server
Figure 8.3.4-1 shows the procedure for an MSGin5G UE that initiates an MSGin5G
message delivery status report.
Figure 8.3.4-1: message delivery status report from MSGin5G UE
Figure 8.3.4-2 shows the procedure for an Application Server that initiates an
API request for MSGin5G message delivery status report specified in clause
9.1.1.4 to UE.
Figure 8.3.4-2: message delivery status report from Application Server
Figure 8.3.2-3 shows the procedure for a Legacy 3GPP Message Gateway or a
Non-3GPP Message Gateway that sends an MSGin5G message delivery status report
to the MSGin5G Server on behalf of a Legacy 3GPP UE or Non-3GPP UE.
Figure 8.3.4-3: message delivery status report from Message Gateway (on behalf
of Non-MSGin5G UE)
Pre-conditions:
1\. The sender of an MSGin5G message has asked for a message delivery status
report.
Procedures:
The following procedure applies to the above figures 8.3.4-1, 8.3.4-2 and
8.3.4-3 with the exception that step 1 only applies to figure 8.3.4-1.
1\. The Application Client in the MSGin5G UE sends a request to the MSGin5G
Client for invoking the MSGin5G Client to send an MSGin5G message delivery
status report to a recipient.
Editor\'s note: Whether the APIs provided by the MSGin5G Client to the
Application Client is to be specified in another clause of the TS is FFS.
2\. As shown in figure 8.3.4-1 or 8.3.4-3, the MSGin5G Client or Message
Gateway sends the MSGin5G message delivery status report to the MSGin5G Server
and includes the IEs as listed in table 8.3.4-1, or as shown in figure
8.3.4-2, the Application Server sends an API request to the MSGin5G Server for
sending an MSGin5G message, the API request includes the IEs as listed in
table 8.3.4-1.
Table 8.3.4-1: message delivery status report to MSGin5G Server
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | Originating UE Service | M | The service identity of the | | ID/AS Service ID | | sending MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | | | or the sending Application | | | | Server. | +-----------------------------+--------+-----------------------------+ | Recipient UE Service ID/AS | M | The service identity of the | | Service ID (NOTE) | | receiving MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | | | or the receiving | | | | Application Server. | | | | | | | | This is the sender of the | | | | message that this message | | | | delivery status report is | | | | for. | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of | | | | message delivery status | | | | report. | | | | | | | | The message ID of the | | | | MSGin5G message that is | | | | being acknowledged is | | | | included in this IE. | +-----------------------------+--------+-----------------------------+ | Security Credentials | O | Security information | | | | required by the MSGin5G | | | | Server. | | | | | | | | This is a placeholder for | | | | SA3 security information. | +-----------------------------+--------+-----------------------------+ | Failure Cause | O | The Failure Cause indicates | | | | the failure reason, if | | | | applicable. | +-----------------------------+--------+-----------------------------+ | Delivery Status | M | The delivery status | | | | description, including | | | | success or failure in | | | | delivery | +-----------------------------+--------+-----------------------------+ | NOTE: When the originator | | | | is an Application Server, | | | | (i.e. Originating AS | | | | Service ID is present), | | | | this IE shall be a UE | | | | Service ID. | | | +-----------------------------+--------+-----------------------------+
3\. The MSGin5G Server verifies that the sender is authorized to send the
message delivery status report.
4\. The MSGin5G Server may send a response to the originating entity if the
message delivery status report is rejected and includes the IEs as listed in
table 8.3.2-3 in the response.
### 8.3.5 MSGin5G message delivery status report from the MSGin5G Server
Figure 8.3.5-1 shows the procedure for the MSGin5G Server that forwards an
MSGin5G message delivery status report to an MSGin5G UE.
Figure 8.3.5-1: message delivery status report towards an MSGin5G UE
Figure 8.3.5-2 shows the procedure for the MSGin5G Server that forwards an
MSGin5G message delivery status report to an Application Server.
Figure 8.3.5-2: Message delivery status report towards an Application Server
Figure 8.3.5-3 shows the procedure for the MSGin5G Server that forwards an
MSGin5G message delivery status report to a Legacy 3GPP Message Gateway or a
Non-3GPP Message Gateway.
Figure 8.3.5-3: message delivery status report towards a Message Gateway
The following procedure applies to the above figures 8.3.5-1, 8.3.5-2 and
8.3.5-3 with the exception that step 2 only applies to figure 8.3.5-1.
1\. the MSGin5G Server sends the MSGin5G message delivery status report to the
MSGin5G UE or Message Gateway and includes the IEs as listed in table 8.3.5-1,
or as shown in figure 8.3.5-2 and figure 8.3.5-3, the MSGin5G Server sends an
API request to the Application Server for sending an MSGin5G message, the API
request includes the IEs as listed in table 8.3.5-1.
Table 8.3.5-1: message delivery status report to MSGin5G Server
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | Originating UE Service | M | The service identity of the | | ID/AS Service ID | | sending MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | | | or the sending Application | | | | Server. | +-----------------------------+--------+-----------------------------+ | Recipient UE Service ID/AS | M | The service identity of the | | Service ID (see NOTE) | | receiving MSGin5G Client, | | | | Legacy 3GPP UE, Non-3GPP UE | | | | or the receiving | | | | Application Server. | | | | | | | | This is the sender of the | | | | message that this message | | | | delivery status report is | | | | for. | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of | | | | message delivery status | | | | report. | | | | | | | | The message ID of the | | | | MSGin5G message that is | | | | being acknowledged is | | | | included in this IE. | +-----------------------------+--------+-----------------------------+ | Failure Cause | O | The Failure Cause indicates | | | | the failure reason, if | | | | applicable. | +-----------------------------+--------+-----------------------------+ | Delivery Status | M | The delivery status | | | | description, including | | | | success or failure in | | | | delivery. | +-----------------------------+--------+-----------------------------+ | NOTE: When the originator | | | | is an Application Server, | | | | (i.e. Originating AS | | | | Service ID is present), | | | | this IE shall be a UE | | | | Service ID. | | | +-----------------------------+--------+-----------------------------+
2\. The MSGin5G Client sends the MSGin5G message delivery status report to
Application Client.
### 8.3.6 MSGin5G Store and Forward
Figure 8.3.6-1 shows the procedure for providing store and forward services
for MSGin5G message requests.
This procedure applies when an MSGin5G inbound message is received at the
MSGin5G Server and the recipient UE is not available; otherwise, the procedure
detailed in clause 8.3.2 applies.
Pre-conditions:
1\. The MSGin5G Client or Application Server has registered to the MSGin5G
Server.
2\. The MSGin5G server has determined that the recipient UE is not available.
NOTE: In addition to UE registration status, the MSGin5G Server can use e.g,
UE reachability status monitoring specified in clause 8.2 or the recipient\'s
Communication Availability information specified in clause 8.9.2 to determine
whether the recipient is available, i.e. reachable for message delivery.
Figure 8.3.6-1: Store and forward procedure
1\. Inbound MSGin5G message handling, see steps 1-3 in clause 8.3.2. The value
of the Store and forward flag IE (see **Table 8.3.2-1)** in the MSGin5G
message indicates that store and forward services are requested by the sender.
2\. The MSGin5G Server checks the registration information of the recipient
UE. If the Store and forward option IE (see **Table 8.2.1-3)** indicates that
the recipient UE opts out of store and forward services, the message is
discarded and the procedure ends. If the Store and forward flag IE (see Table
8.3.2-1) in the received message indicates that store and forward services are
not requested by the sender, the message is discarded and the procedure ends.
> If store and forward processing is required, the MSGin5G Server uses the
> Application specific store and forward information IE (see Table 8.3.2-2) to
> determine storage and forwarding
3\. The MSGin5G Server may send a message response as defined in table 8.3.2-3
which includes store and forward status information in the Delivery Status IE,
e.g., that the delivery had been deferred
4\. The recipient UE becomes available.
5\. When the recipient UE becomes available, the MSGin5G Server attempts
delivery of the request using the procedure specified in clause 8.3.3.
> If the UE does not become available prior to the expiration time, the
> MSGin5G Server attempts delivery of the request at the message expiration
> time and the stored message is discarded afterwards.
6\. The MSGin5G Server may send a message response as defined in table 8.3.2-3
which includes store and forward status information in the Delivery Status IE,
e.g., that the message was discarded.
## 8.4 Message Aggregation
### 8.4.1 General
Based on maximum segment size allowed to transmit over available transport,
the MSGin5G Service can optimize communications by aggregating one or more
messages towards the target.
The following pre-conditions apply for message aggregation:
1\. The recipient UE(s) support an MSGin5G Client or the (Legacy-3GPP and
non-3GPP) Message Gateway supports the MSGin5G Client capability.
2\. The MSGin5G Client 1 and MSGin5G Client 2 are registered with the MSGin5G
Server, or an Application Server has established a secured communication with
the MSGin5G Server.
### 8.4.2 Message Aggregation at MSGin5G Client
Figure 8.4.2-1 shows the procedure for an MSGin5G Client aggregating Point-to-
Point messages including a group of messages each carrying small amounts of
data.
Editor\'s note: the detailed procedures of Message Aggregation used in Group
messaging, Broadcast messaging and Message delivery based on Messaging Topic
is FFS.
NOTE 1: Aggregation of multiple messages can also be done with the Application
Client; in this case it is implementation specific and out of the scope of the
current specification.
Figure 8.4.2-1: MSGin5G UE aggregates messages towards target MSGin5G UE
Figure 8.4.2-2 shows the procedure for an MSGin5G Client aggregating Point-to-
Application messages each carrying small amounts of data.
Figure 8.4.2-2: MSGin5G UE aggregates messages towards target Application
Server
The following procedure applies to the above figures 8.4.2-1 and 8.4.2-2 with
the exception that step 7 only applies to figure 8.4.2-1.
1\. Application Client(s) on UE 1 initiates a request to the MSGin5G Client 1
to send a message to another target or to send a group message.
2\. The MSGin5G Client 1 checks if aggregation is allowed for this message,
checks the message data size, and the priority level to determine if the
received message can be aggregated. For example, MSGin5G Client 1 finds that
the messages have small payload size when compared to the maximum segment size
that can be transmitted over available transport and are not high priority
messages, which could be sent as per scheduling policy towards a selected
target.
NOTE 2: MSGin5G Client 1 decides to continue aggregating messages until
optimal use of segment size before sending message towards MSGin5G Server.
NOTE 3: How the MSGin5G Client 1 uses individual message priority, maximum
time to wait, etc for aggregating and sending is out of scope of the present
document.
3\. The MSGin5G Client 1 aggregates multiple MSGin5G message requests intended
for a selected target and sends the Aggregated message request as defined in
Table 8.4.2-1 and Table 8.4.2-2 according to scheduling policy towards MSGin5G
Server.
Table 8.4.2-1: Aggregated message request (MSGin5G Client to MSGin5G Server)
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | Originator UE Service ID | M | The service identity of the | | | | sending MSGin5G Client. | +-----------------------------+--------+-----------------------------+ | Recipient UE Service ID/AS | M | The service identity of the | | Service ID (see NOTE) | | receiving MSGin5G Client or | | | | the receiving Application | | | | Server. | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of the | | | | aggregated message | +-----------------------------+--------+-----------------------------+ | Security credentials | O | Security information | | | | required by the MSGin5G | | | | Server. | | | | | | | | This is a placeholder for | | | | SA3 security information. | +-----------------------------+--------+-----------------------------+ | Number of individual | M | Indicates total number of | | messages | | messages which are | | | | aggregated into single | | | | message | +-----------------------------+--------+-----------------------------+ | List of individual messages | M | Each element in this list | | | | contains information as | | | | specified in Table 8.3.2-1. | +-----------------------------+--------+-----------------------------+ | Store and forward flag | O | An indicator of whether | | | | store and forward services | | | | are requested for this | | | | aggregated message. If the | | | | value indicates that store | | | | and forward services are | | | | requested by the sender, | | | | the store and forward | | | | procedure in clause 8.3.6 | | | | applies. The forward | | | | services can be applied to | | | | the aggregated message only | | | | if all messages in this | | | | aggregated message can be | | | | store and forwarded. | +-----------------------------+--------+-----------------------------+ | Store and forward | O | Parameters used by MSGin5G | | parameters | | Server for providing store | | | | and forward services, as | | | | detailed in table 8.3.2-2. | | | | This IE shall be included | | | | only if the value of the | | | | Store and forward flag IE | | | | indicates that store and | | | | forward services are | | | | requested. The MSGin5G | | | | store and forward procedure | | | | is detailed in clause | | | | 8.3.6. | +-----------------------------+--------+-----------------------------+
Table 8.4.2-2: Individual message data
* * *
Information element Status Description Individual Message ID M Unique
identifier of this individual message. Application ID O Identifies the
application for which the payload is intended. Delivery status required O
Indicates if delivery acknowledgement from the recipient is requested. Payload
M Payload of the message Priority type O Application priority level requested
for this message.
* * *
NOTE 4: Total size of Aggregated message request is less than or equal to
maximum segment size allowed to be transmitted over available transport.
4\. MSGin5G Server checks whether the MSGin5G Client 1 is authenticated and
authorized to send Aggregated message request. If authenticated and
authorized, the MSGin5G Server skips step 5.
5\. If MSGin5G Client 1 is not authorized to send Aggregated message request,
the Aggregated message request is not valid, or the message is stored for
deferred delivery, the MSGin5G Server sends Aggregated message response to the
MSGin5G Client 1. The information elements defined in Table 8.4.2-3 are
included in the response.
Table 8.4.2-3: Aggregated message response (MSGin5G Server to MSGin5G Client)
* * *
Information element Status Description Original MSGin5G Client ID M The
identity of the MSGin5G Client sending the original message. Message ID M
Unique identifier of this message Delivery Status O Indicates if delivery is a
failure, or if the message is stored for deferred delivery. Failure Cause O
This IE contains the failure reason, e.g. the originator is not authorized to
send a message request or one of the multiple messages aggregated has an
issue, may be included in this IE.
* * *
Editor\'s note: If the Application ID should be in table 8.4.2-3 instead of
table 8.3.2-3 is FFS.
6\. If MSGin5G Client 1 is authorized to send Aggregated message request, the
MSGin5G Server sends Aggregated message request towards the selected target
MSGin5G Client(s) 2/ Application Server.
7\. The MSGin5G Client 2 splits the received Aggregated message request into
multiple individual MSGin5G message requests per application and sends them
towards Application Client(s).
8\. The Application Client(s)/ Application Server may initiate sending a
message delivery status report, if requested in the original message that is
received as in Step 7 (for MSGin5G UE) or Step 6 (for Application Server).
MSGin5G Client 2/ Application Server sends the message delivery status report
towards the Application Client(s) on UE 1 via MSGin5G Server and MSGin5G
Client 1.
NOTE 5: The message delivery status reports can also be aggregated into a
single message.
### 8.4.3 Message Aggregation at MSGin5G Server
Figure 8.4.3-1 shows the procedure for MSGin5G Server aggregating Application-
to-Point messages each carrying small data targeted towards the target UE.
NOTE 1: Aggregation of multiple messages can also be done at the Application
Server; in this case it is implementation specific and out of the scope of the
current specification.
Figure 8.4.3-1: MSGin5G Client aggregates messages towards target end point
1\. The Application Server initiates to send Application-to-Point message or a
group message towards target UE(s) 1 and sends the request to MSGin5G Server
and includes an indication that message aggregation is allowed for this
message.
2\. The MSGin5G Server checks the message data size and the priority level to
determine if the received message can be aggregated. For example, MSGin5G
Server finds that the messages have small payload size when compared to the
maximum segment size that can be transmitted over available transport and are
not high priority messages, which could be sent as per scheduling policy
towards a selected target.
NOTE 2: MSGin5G Server decides to continue aggregating messages until optimal
use of segment size before sending message towards MSGin5G Client 1.
3\. The MSGin5G Server aggregates multiple MSGin5G message requests intended
for the target UE and sends the Aggregated message request as defined in Table
8.4.3-1 and Table 8.4.2-2 according to scheduling policy towards the MSGin5G
Client 1.
Table 8.4.3-1: Aggregated message request (MSGin5G Server to MSGin5G Client)
* * *
Information element Status Description Originating AS Service ID M The service
identity of the sending Application Server. Recipient UE Service ID M The
service identity of the receiving MSGin5G Client. Message ID M Unique
identifier of this message Number of individual messages M Indicates total
number of messages which are aggregated into single message List of Individual
messages M Each element in this list contains information as specified in
Table 8.3.3-1
* * *
NOTE 3: Total size of Aggregated message request is less than or equal to
maximum segment size allowed to transmit over available transport.
4\. The MSGin5G Client 1 splits the received Aggregated message request into
multiple individual MSGin5G message requests per application and sends towards
Application Client(s) as notifications.
NOTE 4: The MSGin5G Server may aggregate messages towards the target UE if it
receives message from multiple MSGin5G UEs (instead of application server).
## 8.5 MSGin5G Message Segmentation and Reassembly
### 8.5.1 General
This clause introduces MSGin5G message segmentation and reassembly
functionality to the MSGin5G Service.
Segmentation and reassembly operations are performed either by the MSGin5G
Server or by the MSGin5G Client, depending on the communication models. For
Application-to-Point use case, the MSGin5G Server performs MSGin5G message
segmentation while the MSGin5G Client performs MSGin5G message reassembly. For
Point-to-Application use case, the MSGin5G Client performs MSGin5G message
segmentation while the MSGin5G Server performs MSGin5G message reassembly.
The maximum segmentation size of MSGin5G message is 2048 bytes and can be
configurable.
### 8.5.2 Application-to-Point Segmentation and Reassembly
Figure 8.5.2-1 shows the MSGin5G message segmentation and reassembly procedure
for Application-to-Point MSGin5G message use cases (e.g. AOMT).
NOTE 1: Segmentation can also be done by the Application Server, in this case
the Application Server will create a segmented message and send it as a
regular MSGin5G message. In this case it is implementation specific and out of
the scope of the current specification.
Pre-conditions:
1\. A UE hosts an MSGin5G Client and an Application Client.
2\. The MSGin5G Client registers with the MSGin5G Server.
3\. An Application Server needs to deliver application data to the Application
Client on the UE and the size of the application data exceeds the maximum
allowed packet size (e.g. due to limitation by the UE\'s access network
transport).
Figure 8.5.2-1: Application-to-Point MSGin5G Message Segmentation and
Reassembly
1\. An Application Server sends a message to an MSGin5G Server that targets an
Application Client on a UE.
2\. The MSGin5G Server compares the size of the received message to the
maximum allowed packet size and detects that the size exceeds the limit. As a
result, the MSGin5G Sever segments the received message into a set of
segmented messages. Within each segmented message, the information elements
defined in Table 8.3.3-1 are included to enable the MSGin5G Client on the
targeted UE to reassemble the segmented messages, with following
clarifications.
a) The MSGin5G message request includes following information elements from
Table 8.3.3-1:
i) Originating AS Service ID, Recipient UE Service ID, Message ID,
Segmentation Set Identifier and Message segment number in each segmented
message
ii) Delivery status required and Total number of message segments, only if it
is the first segment of the message
iii) Last Segment Flag, only if it is the last segment of the message.
3\. The MSGin5G Server sends each segmented message to the targeted UE. If any
segment is not received within the expected time (based on configuration) then
proceed to step 4.
4\. If MSGin5G Client has received all segments (determined based on First
segment and Last Segment), the MSGin5G Client reassembles all the segmented
messages into a single MSGin5G message based on the information elements
mentioned in step 2. If not all segments are received within expected time,
then the MSGin5G Client recovers the segments as described in clause 8.5.6
MSGin5G message segment recovery procedure, before continuing with rest of the
steps.
NOTE 2: When no further segments received within expected time and if both
first segment and last segment are missing, recovery can be initiated as
described in clause 8.5.6 MSGin5G message segment recovery procedure for
recovering the first segment and then for remaining segments.
Editor\'s note: For Application-to-Point messages to UEs without MSGin5G
Clients, reassembly and the responsibility of the Message Gateway in this
procedure are FFS.
5\. The MSGin5G Client sends Message status request to the MSGin5G Server. The
information elements defined in Table 8.5.2-2 are included in the request. The
result information element will contain \"success\" if the reassembly of the
segments is success. Otherwise, the result information element will contain
\"failure\".
Table 8.5.2-2: Message Received Confirmation Request Information Elements
* * *
**Information element** **Status** **Description** Segmentation Set Identifier
M The Segmentation Set Identifier as received in segments. Result M Indicates
the \"success\" or \"failure\"
* * *
NOTE 3: The MSGin5G Server may send acknowledge back to MSGin5G Client based
on application requirement.
Editor\'s note: Whether table 8.5.2-2 can be replaced with the existing Table
8.3.2-3 is FFS.
6\. If reassembly of segments is success, the MSGin5G Client delivers the
contents of the MSGin5G message to the targeted Application Client. If MSGin5G
Client has not received all messages (even after recovery procedure) or
reassembly of segments failed for any reason (e.g. corrupt data) then the
MSGin5G Client will notify receiving of failed message to Application Client.
### 8.5.3 Point-to-Application Message Segmentation and Reassembly
Figure 8.5.3-1 shows the MSGin5G message segmentation and reassembly procedure
for Point-to-Application MSGin5G message use cases (e.g. MOAT).
Pre-conditions:
1\. A UE hosts an MSGin5G Client and an Application Client.
2\. The MSGin5G Client registers with the MSGin5G Server.
3\. An Application Client on the UE needs to deliver application data to an
Application Server and the size of the application data exceeds the maximum
allowed packet size (e.g. due to limitation by the UE\'s access network
transport).
Figure 8.5.3-1: Point-to-Application MSGin5G Message Segmentation and
Reassembly
1\. An Application Client on a UE sends a message to an MSGin5G Client that
targets an Application Server and that has a size that exceeds the maximum
allowed packet size.
2\. The MSGin5G Client compares the size of the received message to the
maximum allowed packet size and detects that the size exceeds the limit. As a
result, the MSGin5G Client segments the received message into a set of
segmented messages such that each segmented message can fit within the maximum
allowed packet size. Within each segmented message, the information elements
defined in Table 8.3.2-1 are included to enable the MSGin5G Server to
reassemble the segmented messages, with following clarifications.
a) The MSGin5G message request includes following information elements from
Table 8.3.2-1:
i) Originating UE Service ID, Recipient AS Service ID, Message ID,
Segmentation set identifier and Message segment number in each segmented
message
ii) Delivery status required and Total number of message segments, only if it
is the first segment of the message
iii) Last segment flag, only if it is the last segment of the message.
Editor\'s note: For UEs without MSGin5G Clients, the segmentation of Point-to-
Application messages and the responsibility of the Message Gateway in this
procedure are FFS.
3\. The MSGin5G Client sends each segmented message to the MSGin5G Server. If
any segment is not received within the expected time (based on configuration)
then proceed to step 4.
4\. If MSGin5G Server has received all segments (determined based on first
segment and last Segment), the MSGin5G Server reassembles all the segmented
messages into a single MSGin5G message based on the information elements
mentioned in step 2. If not all segments are received within expected time,
then the MSGin5G Server recovers the segments as described in clause 8.5.6
MSGin5G message segment recovery procedure, before continuing with rest of the
steps.
NOTE 1: When no further segments received within expected time and if both
first segment and last segment are missing, recovery can be initiated as
described in clause 8.5.6 MSGin5G message segment recovery procedure for
recovering the first segment and then for remaining segments.
5\. The MSGin5G Server sends message received confirmation to the MSGin5G
Client. The information elements defined in Table 8.5.2-2 are included in the
request. The result information element will contain \"success\" if the
reassembly of the segments is success. Otherwise, the result information
element will contain \"failure\".
NOTE 2: The MSGin5G Client may send acknowledge back to MSGin5G Server based
on application requirement.
6\. If reassembly of segments is success, the MSGin5G Server delivers the
contents of the MSGin5G message to the targeted Application Server. If MSGin5G
Server has not received all messages (even after recovery procedure) or
reassembly of segments failed for any reason (e.g. corrupt data) then the
MSGin5G Server will notify receiving of failed message to application server.
Editor\'s note: MSGin5G message segmentation and reassembly for Broadcast
messages is FFS.
### 8.5.4 Point-to-Point Message Segmentation and Reassembly
Figure 8.5.4-1 shows the MSGin5G message segmentation and reassembly procedure
for Point-to-Point MSGin5G message use cases (e.g. MOMT).
This procedure assumes that a UE is only aware of the maximum payload size of
the delivery mechanism it is currently using, and it is not aware of the
maximum payload size of the recipient UE.
Pre-conditions:
1\. Both UEs host an MSGin5G Client and an Application Client.
2\. The MSGin5G Clients register with the MSGin5G Server.
3\. An Application Client on the UE needs to deliver application data to an
Application Client on another UE and the size of the application data exceeds
the allowed maximum packet size (e.g. due to limitation by the UE\'s access
network transport).
Figure 8.5.4-1: Point-to-Point MSGin5G Message Segmentation and Reassembly
1\. An Application Client on UE 1 sends a message to MSGin5G Client 1 that
targets Application Client on UE 2.
2\. The MSGin5G Client 1 compares the size of the received message to the
maximum allowed packet size and detects that the size exceeds the limit of the
originating UE. As a result, the MSGin5G Client segments the received message
into a set of segmented messages such that each segmented message can fit
within the maximum allowed packet size. Within each segmented message, the
information elements defined in Table 8.51.2-1 are included to enable
reassembly of the segmented messages, with following clarifications.
a) The MSGin5G message request includes following information elements from
Table 8.3.2-1:
i) Originating UE Service ID, Recipient UE Service ID, Message ID,
Segmentation set identifier and Message segment number in each segmented
message
ii) Delivery status required and Total number of message segments, only if it
is the first segment of the message
iii) Last segment flag, only if it is the last segment of the message.
3\. The MSGin5G Client 1 sends each segmented message to the MSGin5G Server.
If any segment is not received within the expected time (based on
configuration) then proceed to step 4.
4\. The MSGin5G Server checks if each segment does not exceed the configured
maximum packet size of the targeted UE. If the maximum packet size is not
exceeded, then the MSGin5G Server proceeds with step 6.
> If the maximum packet size is exceeded then the the MSGin5G Server performs
> the following operations:
a) If all segments are received within expected time,, then the MSGin5G Server
reassembles subsequent segmented messages, until the Last segment flag
indication is received, into a single MSGin5G message. The re-assembled
message is then segmented such that each segment is smaller than the maximum
allowed packet size of the targeted UE. Within each segmented message, the
information elements as mentioned in step 2 are included to enable reassembly
at the target, then proceeds with step 6.
b) If not all segments are received within expected time, then the MSGin5G
Server acts as Message Receiver to recover the segments as described in clause
8.5.6 MSGin5G message segment recovery procedure, before continuing with rest
of the steps.if all segments are received after recovery procedure, then the
MSGin5G Server skips to step 4-a,otherwise proceed to step 5.
5\. The MSGin5G Server sends Message received confirmation to the MSGin5G
Client 1. The information elements defined in Table 8.5.2-2 are included in
the request, the Result information element is \"failure\", and further steps
are not executed.
6\. The MSGin5G Server sends each segmented message to the MSGin5G Client 2.
If any segment as a separate message is not received within the expected time
(based on configuration) then proceed to step 8.
7\. The MSGin5G Client 2 reassembles all the segmented messages into a single
MSGin5G message based on the information elements defined mentioned in step 2.
If not all segments are received within expected time, then the MSGin5G Client
2 acts as Message receiver to recover the segments as described in clause
8.5.6 MSGin5G message segment recovery procedure, before continuing with rest
of the steps.
8\. The MSGin5G Client 2 sends Message received confirmation to the MSGin5G
Client. The information elements defined in Table 8.5.2-2 are included in the
request. The Result information element will contain \"success\" if the
reassembly of the segments is success. Otherwise, the Result information
element will contain \"failure\".
NOTE: The MSGin5G Client may send acknowledge back to MSGin5G Server based on
application requirement.
9\. The MSGin5G Client 2 delivers the contents of the MSGin5G message to the
targeted Application Client. If MSGin5G Client has not received all messages
(even after recovery procedure) or reassembly of segments failed for any
reason (e.g. corrupt data) then the MSGin5G Client will notify receiving of
failed message to Application Client.
### 8.5.5 Group Message Segmentation and Reassembly
A Group Message is sent from the MSGin5G Server to a group of recipient UEs.
The MSGin5G Server sends the message to each individual recipient taking into
account the maximum packet size that is supported by the recipient and
segments the message as described in clause 8.5.4.
Editor\'s note: For group member UEs without MSGin5G Client, how the
segmentation is carried out and the responsibility of the Message Gateway in
this procedure are FFS
### 8.5.6 MSGin5G Message Segment Recovery
Figure 8.5.6-1 illustrates an MSGin5G message segmentation recovery procedure.
The procedure is applicable to Application-to-Point messages, Point-to-
Application messages, Point-to-Point message and Group messages.
Pre-conditions:
1\. The Message sender has delivered segmented messages to Message receiver.
Figure 8.5.6-1: MSGin5G Message Segmentation and Reassembly
1\. The Message Receiver detects that few segments are missing to reassemble
complete message.
2\. The Message receiver sends Segment recovery request to Message sender. The
information elements defined in Table 8.5.6-1 are included in the request
message.
Table 8.5.6-1: Segment Recovery Request Information Elements
* * *
Information element Status Description Segmentation Set Identifier M The
Segmentation Set Identifier as received in segments. List of Segment range M
List of Segment range which the client wants to recover, each segment range
consist of start and end sequence number of missing segments e.g. (5-7, 10-10,
15-19)
* * *
3\. The Message sender sends Segment recovery acknowledgement to the MSGin5G
Receiver.
4\. The Message sender sends each segmented message to the Message receiver
within an individual access network transport packet. If any segment is not
received within the expected time (based on configuration) then the Message
receiver may consider as recovery failed or may initiate the procedure again
with updated list of segment range.
NOTE: The MSGin5G message segment recovery procedure may repeat based on the
configuration.
5\. If Message receiver has received all segments (determined based on First
segment and Last Segment), the Message receiver reassembles all the segmented
messages into a single MSGin5G message.
## 8.6 MSGin5G messaging procedure on Message Gateway
### 8.6.1 General MSGin5G messaging procedure on Message Gateway
Figure 8.6.1-1 shows the MSGin5G message delivery procedure on Message Gateway
for Non-MSGin5G UEs.
Figure 8.6.1-1: MSGin5G messaging procedure on Message Gateway.
1\. The MSGin5G Server forwards the MSGin5G message request to recipient Non-
MSGin5G UE based on the UE Service ID. The Message Gateway receives the
MSGin5G message request on behalf of the Non-MSGin5G UE as specified in clause
8.6.1. A Delivery status required IE may be included in the MSGin5G message
request.
2\. The Message Gateway records if a message delivery status report is
requested in the message. Then it translates the MSGin5G message to Non-
MSGin5G message (e.g. SMS, RCS message as specified in GSMA PRD RCC.07 [3])
with message delivery status report requested and finishes the information
exchange procedure with Non-MSGin5G UE (e.g. sends the non-MSGin5G message to
the Non-MSGin5G UE and receives the needed response).
NOTE 1: The information exchange procedure between Message Gateway and Non-
MSGin5G UE is out of scope of this specification.
3\. The Message Gateway checks if application level message delivery status
report is supported by the Non-MSGin5G message delivery mechanism. If not
supported, step 4a will be used and steps 4b and 5b will be skipped; otherwise
step 4b-5b will be used and step 4a will be skipped.
4a. Based on the information (e.g. response to the non-MSGin5G message
delivery request, transport level information, etc) obtained from the non-
MSGin5G message delivery mechanism, the Message Gateway fetches the delivery
status from the above information and uses it to create an MSGin5G message
delivery status report. If the delivery status is failure, the Message Gateway
also fetches the suitable failure reason from the above information and uses
it as reason of failure in the MSGin5G message delivery status report. The
Information Elements listed in table 8.3.4-1 are included in the MSGin5G
message delivery status report.
4b. A non-MSGin5G application level message delivery status report is received
by the Message Gateway.
NOTE 2: The procedure of non-MSGin5G application level message delivery status
report is out of scope of this specification.
5b. The Message Gateway translates the non-MSGin5G application level message
delivery status report to MSGin5G message delivery status report as specified
in clause 8.3.4. The Information Elements listed in table8.3.4-1 are also
included in this MSGin5G message delivery status report, but the Delivery
Status and Failure Cause IEs are fetched from the non-MSGin5G application
level message delivery status report.
6\. The Message Gateway sends the MSGin5G message delivery status report to
the MSGin5G Server on behalf of the Non-MSGin5G UE as specified in clause
8.3.4.
### 8.6.2 Non-MSGin5G UE receives message from group
#### 8.6.2.1 Legacy 3GPP UE receives message from group
Figure 8.6.2.1-1 shows the procedure for Legacy 3GPP UE to receive message
from group.
Pre-conditions:
1\. The MSGin5G Server has received the message to send to target UE.
Figure 8.6.2.1-1: Legacy 3GPP UE receives a message from the group
1\. The MSGin5G Server sends the MSGin5G message request to the recipient
based on the UE Service ID. The Legacy 3GPP Message Gateway receives the
MSGin5G message request on behalf of the Non-GPP UE as defined in clause 8.3.3
with following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
Group Service ID, Recipient UE Service ID, Message ID, Payload information
elements from Table 8.3.3-1. The MSGin5G message request may include Delivery
status required, Application ID and Priority type information elements from
Table 8.3.3-1.
2\. The Legacy 3GPP Message Gateway translates the MSGin5G message request to
Legacy 3GPP message (e.g. SMS).
3\. The Legacy 3GPP message gateway sends Legacy 3GPP message (e.g. SMS) to
Legacy 3GPP UE.
4\. The Legacy 3GPP UE delivers the payload of the legacy 3GPP message (e.g.
SMS) to the targeted Application Client on the Legacy 3GPP UE.
#### 8.6.2.2 Non-3GPP message client receives message from group
Figure 8.6.2.2-1 shows the procedure for Non-3GPP message client to receive
message from group.
Pre-conditions:
1\. The MSGin5G Server has received the message to send to target UE.
Figure 8.6.2.2-1: Non-3GPP message client receives a message from the group
1\. The MSGin5G Server sends the MSGin5G message request to the recipient
based on the UE Service ID. The MSGin5G Gateway receives the MSGin5G message
request on behalf of the Non-GPP UE as defined in clause 8.3.3 with following
clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
Group Service ID, Recipient UE Service ID, Message ID, Payload information
elements from Table 8.3.3-1. The MSGin5G message request may include Delivery
status required, Application ID and Priority type information elements from
Table 8.3.3-1.
2\. The Non-3GPP Message Gateway translates the MSGin5G message to Non-3GPP
message.
3\. The Non-3GPP Message Gateway sends message to Non-3GPP Message Client.
4) The Non-3GPP UE delivers the payload of the non-3GPP message (e.g. RCS) to
the targeted Application Client on the Non-3GPP UE.
NOTE: The procedure to translate MSGin5G message to Non-3GPP message and to
send Non-3GPP message from Non-3GPP Message Gateway to Non-3GPP Message Client
are out of scope of 3GPP.
## 8.7 E2E Message delivery procedures
Editor\'s note: It is also FFS how endpoints are provided with the Service IDs
of the counterparts with which the E2E message delivery procedures are used.
Editor\'s note: Generalizing MSISDN to Legacy 3GPP identifier in pre-
conditions is FFS.
### 8.7.1 Point-to-Point Message delivery procedures
#### 8.7.1.1 From MSGin5G UE to MSGin5G UE
Figure 8.7.1.1-1 shows the message delivery procedure from MSGin5G UE 1 to
MSGin5G UE 2.
Pre-conditions:
1\. Both MSGin5G Client 1 in MSGin5G UE 1 and MSGin5G Client 2 in MSGin5G UE 2
have registered with the MSGin5G Server.
Figure 8.7.1.1-1 Message delivery between MSGin5G UEs
1\. The MSGin5G Client 1 sends an MSGin5G message request to MSGin5G Server as
specified in clause 8.3.2 with following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
UE Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
b) Upon receiving the MSGin5G message request, the MSGin5G Server determines
that the MSGin5G Client 1 is authorized to send message to MSGin5G Client 2.
2\. The MSGin5G Server forwards the MSGin5G message request to MSGin5G Client
2 as specified in clause 8.3.3.
3\. If Delivery status required is included in the MSGin5G message request,
MSGin5G Client 2 sends MSGin5G message delivery status report to the MSGin5G
Server as specified in clause 8.3.4 and then the MSGin5G Server sends MSGin5G
message delivery status report to MSGin5G Client 1 as specified in clause
8.3.5.
#### 8.7.1.2 From MSGin5G UE to Legacy 3GPP UE
Figure 8.7.1.2-1 shows the message delivery procedure from MSGin5G UE to
Legacy 3GPP UE.
Pre-conditions:
1\. MSGin5G Client in MSGin5G UE has registered with the MSGin5G Server and
the Legacy 3GPP Message Client in Legacy 3GPP UE has registered with the
MSGin5G Server via the Legacy 3GPP Message Gateway.
2\. Legacy 3GPP Message Gateway is aware of the UE Service ID of Legacy 3GPP
UE and maintains the mapping to IDs used in the legacy network.
Figure 8.7.1.2-1 Message delivery from MSGin5G UE to Legacy 3GPP UE
1\. The MSGin5G Client sends an MSGin5G message request to MSGin5G Server as
specified in clause 8.3.2 with following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
UE Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
2\. Upon receiving the MSGin5G message request, the MSGin5G Server determines
that the MSGin5G Client is authorized to send message to the recipient UE.
3\. The MSGin5G Server forwards the MSGin5G message request to the recipient
based on the UE Service ID. The Legacy 3GPP Gateway receives the MSGin5G
message request on behalf of the Legacy 3GPP UE as specified in 8.3.3.
4\. The Legacy 3GPP Message Gateway determines which legacy 3GPP message
delivery mechanism (e.g. SMS, NIDD, Device triggering, etc.) will be used
based on Legacy 3GPP UE capability, the UE communication status, the MSGin5G
Service configuration, etc. When selected, the Legacy 3GPP Message Gateway
maps the UE Service ID to the corresponding identifier. For example (not an
exhaustive list):
a) if the Legacy 3GPP Message Gateway selected the device triggering delivery
mechanism, it maps the UE Service ID to MSISDN and Application port ID
b) if the Legacy 3GPP Message Gateway selected the NIDD delivery mechanism, it
maps the UE Service ID to External Identifier or MSISDN.
c) if the Legacy 3GPP Message Gateway selected the SMS delivery mechanismm, it
maps the UE Service ID to MSISDN.
5-7. The Legacy 3GPP Message Gateway sends the payload of the MSGin5G message
to the terminating Legacy 3GPP UE using the determined delivery mechanism. For
example:
a) For Device triggering delivery mechanism, the Legacy 3GPP Message Gateway
interacts with the MTC-IWF/SCEF/NEF and maps the payload of the MSGin5G
message to one or more Device Triggering requests. The MTC-IWF/SCEF/NEF
interacts with SMS-SC for delivery to the UE and to receive the message
delivery status report (see TS 23.682 [8] clause 5.2, TS 29.122 [9] clause
4.4.6 and TS 29.522 [10] clause 4.4.3)
b) For NIDD delivery mechanism, the Legacy 3GPP Message Gateway may interact
with the SCEF/NEF and maps the payload of the MSGin5G message to one or more
NIDD submit request messages. The Reliable Data Service Configuration, Maximum
Latency, Priority, PDN Connection Establishment Option settings are based on
pre-configurations (see TS 23.682 [8] clause 5.13, TS 29.122 [9] clause
4.4.5.3 and TS 29.522 [10] clause 4.4.12.3). Alternatively, if tunnel
parameters are provisioned in the Legacy 3GPP Message Gateway and UPF/P-GW the
payload could be tunnelled via the UPF/P-GW (see TS 23.401 [11] (clause
4.3.17.8.3.3) , TS 23.501[12] clause 5.6.10.3, TS 23.502 [7] clause 4.24);
c) For SMS delivery mechanism, the Legacy 3GPP Message Gateway sends SMS to
the Legacy 3GPP UE through the SMSC according the procedure in TS 23.204 [13]
or the procedure in clause 4.13.3 of TS 23.502 [7].
8\. If Delivery status required is included in the MSGin5G message request,
the Legacy 3GPP Message Gateway sends MSGin5G message delivery status report
to the MSGin5G Server as specified in clause 8.3.4 and then the MSGin5G Server
sends the message delivery status report to the MSGin5G Client as specified in
clause 8.3.5.
#### 8.7.1.3 From MSGin5G UE to Non-3GPP UE
Figure 8.7.1.3-1 shows the message delivery procedure from MSGin5G UE to
Non-3GPP UE.
Pre-conditions:
1\. MSGin5G Client in MSGin5G UE has registered with the MSGin5G Server and
the Non-3GPP Message Client in Non-3GPP UE has registered with the MSGin5G
Server via the Non-3GPP Message Gateway.
2\. Non-3GPP Message Gateway is aware of the non-3GPP message client in
Non-3GPP UE and provides the mapping to UE Service ID.
Figure 8.7.1.3-1 Message Delivery from MSGin5G UE to Non-3GPP UE
1\. The MSGin5G Client sends an MSGin5G message request to the MSGin5G Server
as specified in 8.3.2 with following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
UE Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
2\. The MSGin5G Server determines that the MSGin5G Client is authorized to
send message to the recipient UE.
3\. The MSGin5G Server forwards the MSGin5G message request to the recipient
based on the UE Service ID. The Non-3GPP Message Gateway receives the MSGin5G
message request on behalf of the Non-3GPP UE as specified in clause 8.6.1.
4\. The Non-3GPP Message Gateway translates the MSGin5G message to the
Non-3GPP message with message delivery status report requested and sends it to
the Non-3GPP Message Client. This step is outside the scope of the current
specification.
5\. If message delivery status report is requested, the Non-3GPP Message
Gateway sends the MSGin5G message delivery status report to the MSGin5G Server
as specified in clause 8.3.4, the MSGin5G Server forwards the MSGin5G message
delivery status report to the MSGin5G Client as specified in clause 8.3.5.
#### 8.7.1.4 From Legacy 3GPP UE to MSGin5G UE
This procedure is used for message reply from Legacy 3GPP UE (e.g. SMS UE) to
MSGin5G UE.
Figure 8.7.1.4-1 shows the message delivery procedure from Legacy 3GPP UE
(e.g. SMS UE) to MSGin5G UE.
Pre-conditions:
1\. MSGin5G Client in MSGin5G UE has registered with the MSGin5G Server and
the Legacy 3GPP Message Client in Legacy 3GPP UE has registered with the
MSGin5G Server via the Legacy 3GPP Message Gateway.
2\. The Legacy 3GPP UE received a message from the MSGin5G UE.
3\. The Legacy 3GPP Message Gateway is aware of the Legacy 3GPP UE and
provides the mapping to UE Service ID.
4 The Legacy 3GPP Message Gateway assigns a routable Legacy 3GPP identifier,
e.g. MSISDN or External Identifier, to the MSGin5G UE when it sent MSGin5G
message to Legacy 3GPP UE. The Legacy 3GPP Message Gateway keeps the mapping
between the UE Service ID of the MSGin5G UE and the MSISDN assigned to it.
5\. The Legacy 3GPP UE replies to the MSGin5G UE upon receiving the message
from the MSGin5G UE.
Figure 8.7.1.4-1: Legacy 3GPPs UE replies to MSGin5G UE
1\. The Legacy 3GPP UE sends a Legacy 3GPPmessage request to the Legacy 3GPP
Message Gateway (e.g. through SMSC if SMS is used according the procedure in
3GPP TS 23.204 [13] or the procedure in clause 4.13.3 of TS 23.502 [7]).
2\. The Legacy 3GPP Message Gateway translates the SMS message to MSGin5G
message and sends an MSGin5G message request to the MSGin5G Server as
specified in 8.3.2 with the following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
UE Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
b) Upon receiving the MSGin5G message request, the MSGin5G Server determines
that the Legacy 3GPP UE with its UE Service ID is allowed to reply message to
the MSGin5G UE.
3\. The MSGin5G Server forwards the MSGin5G message request to the target
MSGin5G Client as specified in 8.3.3.
4-6. If the message delivery status report is requested by the with its UE
Service ID UE, the MSGin5G Client in MSGin5G UE sends an MSGin5G message
delivery status report to the MSGin5G Server as specified in clause 8.3.4, the
MSGin5G Server sends the MSGin5G message delivery status report to the Legacy
3GPP Message Gateway specified in clause 8.3.5, the Legacy 3GPP Message
Gateway translates the MSGin5G message delivery status report to a Legacy 3GPP
message delivery status report and sends it to the Legacy 3GPP UE.
#### 8.7.1.5 From Non-3GPP UE to MSGin5G UE
This procedure is used for message reply from Non-3GPP UE to MSGin5G UE.
Figure 8.7.1.5-1 shows the message delivery procedure from Non-3GPP UE to
MSGin5G UE.
Pre-conditions:
1\. MSGin5G Client in MSGin5G UE has registered with the MSGin5G Server and
the Non-3GPP Message Client in Non-3GPP UE has registered with the MSGin5G
Server via the Non-3GPP Message Gateway.
2\. The Non-3GPP UE received a message from the MSGin5G UE.
3\. The Non-3GPP Message Gateway is aware of the Non-3GPP message client on
the Non-3GPP UE and provides the mapping to UE Service ID.
4 The Non-3GPP Message Gateway assigns a routable Non-3GPP identifier to the
MSGin5G UE when it sent MSGin5G message to Non-3GPP UE. The Non-3GPP Message
Gateway keep the mapping between the UE Service ID of the MSGin5G UE and the
MSISDN assigned to it.
5\. The Non-3GPP UE replies to the MSGin5G UE upon receiving the message from
the MSGin5G UE.
Figure 8.7.1.5-1: Non-3GPP UE replies to MSGin5G UE
1\. The Non-3GPP UE sends a Non-3GPP message request to the Non-3GPP Message
Gateway.
2\. The Non-3GPP Message Gateway translates the Non-3GPP message to MSGin5G
message with message delivery status report requested and sends an MSGin5G
message request to the MSGin5G Server as specified in clause 8.3.2 with the
following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
UE Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
b) Upon receiving the MSGin5G message request, the MSGin5G Server determines
that the Non-3GPP UE with its UE Service ID is allowed to reply message to the
MSGin5G UE.
3\. The MSGin5G Server forwards the MSGin5G message request to the target
MSGin5G Client as specified in clause 8.3.3.
4\. If the message delivery status report is request by the Non-3GPP UE, the
MSGin5G Client in MSGin5G UE sends an MSGin5G message delivery status report
to the MSGin5G Server specified in clause 8.3.4, the MSGin5G Server sends the
MSGin5G message delivery status report to the Non-3GPP Message Gateway
specified in clause 8.3.5, the Non-3GPP Message Gateway translates the MSGin5G
message delivery status report to a Non-3GPP message delivery status report
and sends it to the Non-3GPP UE.
### 8.7.2 Application-to-Point Message delivery procedures
#### 8.7.2.1 From Application Server to MSGin5G UE
Editor\'s note: It is FFS whether and how NIDD can be chosen as alternative
delivery mechanism in application -to-Point message delivery to MSGin5G UEs.
Figure 8.7.2.1-1 shows the message delivery procedure from Application Server
to MSGin5G UE.
Pre-conditions:
1\. The MSGin5G Client is registered with the MSGin5G Server.
2\. The Application Server has established a secured communication with the
MSGin5G Server
Figure 8.7.2.1-1 Message delivery from Application Server to MSGin5G UE
1\. The Application Server sends API Request to MSGin5G Server for sending
MSGin5G message as specified in clause 8.3.2 with the following
clarifications:
a) The API request includes Originating AS Service ID, Recipient UE Service ID
and Message ID information elements in Table 8.3.2-1, and may include Delivery
status required, Application ID, Payload, Priority type information elements
from Table 8.3.2-1.
b) Upon receiving the API Request for MSGin5G message delivery, the MSGin5G
Server determines that the Application Server is allowed to send message to
the MSGin5G UE.
2\. The MSGin5G Server sends MSGin5G message request to MSGin5G Client as
specified in clause 8.3.3.
3\. If Delivery status required is included in the MSGin5G message request,
MSGin5G Client 2 sends message delivery status report to the MSGin5G Server
specified in clause 8.3.4.
4\. The MSGin5G Server sends the message delivery status report to the
Application Server as specified in clause 8.3.5
#### 8.7.2.2 From Application Server to Legacy 3GPP UE
Figure 8.7.2.2-1 shows the message delivery procedure from Application Server
to Legacy 3GPP UE.
Pre-conditions:
1\. The Application server has established a secured communication with the
MSGin5G Server
2\. The Legacy 3GPP Message Client in Legacy 3GPP UE has registered with the
MSGin5G Server via the Legacy 3GPP Message Gateway.
3\. Legacy 3GPP Message Gateway is aware of the legacy 3GPP message client
(i.e. SMS client) in Legacy 3GPP UE and provides the mapping to UE Service ID.
Figure 8.7.2.2-1Application Server to Legacy 3GPP UE messaging
1\. The Application Server sends an API Request to MSGin5G Server for sending
MSGin5G message as specified in clause 8.3.2 with the following
clarifications:
a) The API Request includes Originating AS Service ID, Recipient UE Service ID
and Message ID information elements in Table 8.3.2-1, and may include Delivery
status required, Application ID, Payload, Priority type information elements
from Table 8.3.2-1.
2\. Upon receiving the API Request for MSGin5G message delivery, the MSGin5G
Server determines that the Application Server is allowed to send message to
the recipient UE
3\. The MSGin5G Server sends MSGin5G message request to the recipient based on
the UE Service ID. The Legacy 3GPP Gateway receives the MSGin5G message
request on behalf of the Legacy 3GPP UE as specified in clause 8.3.3.
4-7. Same with step 4-7 in clause 8.7.1.2
8\. The Legacy 3GPP Message Gateway sends the MSGin5G message delivery status
report to the MSGin5G Server as specified in clause 8.3.4.
#### 8.7.2.3 From Application Server to Non-3GPP UE
Figure 8.7.2.3-1 shows the message delivery procedure from Application Server
to Non-3GPP UE.
Pre-conditions:
1\. The Application Server has established a secured communication with the
MSGin5G Server
2\. The Non-3GPP Message Client in Non-3GPP UE has registered with the MSGin5G
Server via the Non-3GPP Message Gateway.
3\. Non-3GPP Message Gateway is aware of the non-3GPP message client in
Non-3GPP UE and provides the mapping to UE Service ID.
Figure 8.7.2.3-1 Application Server to Non-3GPP UE messaging
1\. The Application Serve sends an API Request to MSGin5G Server for sending
MSGin5G message as specified in 8.3.2 with the following clarifications:
a) The API Request includes Originating AS Service ID, Recipient UE Service ID
and Message ID information elements in Table 8.3.2-1, and may include Delivery
status required, Application ID, Payload, Priority type information elements
from Table 8.3.2-1.
2\. Upon receiving the API Request for MSGin5G message delivery, the MSGin5G
Server determines that the Application Server is allowed to send message to
the Non-3GPP UE.
3\. The MSGin5G Server sends MSGin5G message request to the recipient based on
the UE Service ID. The Non-3GPP Message Gateway receives the MSGin5G message
request on behalf of the Non-3GPP UE as specified in clause 8.3.3.
4\. The Non-3GPP Message Gateway translates the MSGin5G message to the
Non-3GPP message and sends it to the Non-3GPP UE. This step is outside the
scope of the current specification.
5-6. If message delivery status report is required, the Non-3GPP Message
Gateway sends the MSGin5G message delivery status report to the MSGin5G Server
as specified in clause 8.3.4, the MSGin5G Server sends the message delivery
status report to the Application Server as specified in clause 8.3.5.
### 8.7.3 Point-to-Application Message delivery procedures
#### 8.7.3.1 From MSGin5G UE to Application Server
Figure 8.7.3.1-1 shows the message delivery procedure from MSGin5G UE to
Application Server.
Pre-conditions:
1) The Application Server and MSGin5G Client in MSGin5G UE have registered
with the MSGin5G Server.
Figure 8.7.3.1-1: Message delivery from MSGin5G UE to Application Server
1\. The MSGin5G Client sends an MSGin5G message request to MSGin5G Server as
specified in clause 8.3.2 with the following clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
AS Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
b) Upon receiving the MSGin5G message request, the MSGin5G Server determines
the recipient is an Application Server and the MSGin5G Client is allowed to
send message to Application Server.
2\. The MSGin5G Server forwards the MSGin5G message request to Application
Server as specified in clause 8.3.3.
3-4. If Delivery status required is included in the MSGin5G message request,
Application Server sends message delivery status report to the MSGin5G Server
as specified in clause 8.3.4, the MSGin5G Server sends the delivery status to
MSGin5G Client as specified in clause 8.3.5.
#### 8.7.3.2 From Legacy 3GPP UE to Application Server
This procedure is used for message reply from Non-3GPP UE to Application
Server.
Figure 8.7.3.2-1 shows the message delivery procedure from Legacy 3GPP UE to
Application Server.
Pre-conditions:
1\. The Application server has established a secured communication with the
MSGin5G Server.
2\. The Legacy 3GPP Message Client in Legacy 3GPP UE has registered with the
MSGin5G Server via the Legacy 3GPP Message Gateway.
3 The Legacy 3GPP UE received a message from the Application Server.
4\. The Legacy 3GPP Message Gateway is aware of the Legacy 3GPP Message client
on the Legacy 3GPP UE and provides the mapping between its identifiers and UE
Service ID.
5\. The Legacy 3GPP Message Gateway assigns a routable Legacy 3GPP identifier,
e.g. MSISDN or External Identifier, to the Application Server when it sent
MSGin5G message to Legacy 3GPP UE. The Legacy 3GPP Message Gateway keeps the
mapping between the AS Service ID of the Application Server and the MSISDN
assigned to it
Figure 8.7.3.2-1: Legacy 3GPP UE replies to Application Server
1\. The Legacy 3GPP UE sends an Legacy 3GPP message request to the Legacy 3GPP
Message Gateway (e.g. through SMSC if SMS is used according the procedure in
3GPP TS 23.204 [13] or the procedure in clause 4.13.3 of TS 23.502 [7]).
2\. The Legacy 3GPP Message Gateway translates the Legacy 3GPP message to
MSGin5G message, and may include message delivery status report requested in
the MSGin5G message. The Legacy 3GPP Message Gateway sends the MSGin5G message
request to the MSGin5G Server as specified in clause 8.3.2 with the following
clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
AS Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, and may include Application ID, Payload and
Priority type information elements from Table 8.3.2-1.
b) Upon receiving the MSGin5G message request, the MSGin5G Server determines
that the Legacy 3GPP UE with its UE Service ID is allowed to reply message to
the Application Server.
3\. The MSGin5G Server forwards the MSGin5G message in API request to
Application Server as specified in clause 8.3.3.
4-6. If message delivery status report is requested, the Application Server
sends message delivery status report by API request to MSGin5G Server as
specified in clause 8.3.4, the MSGin5G Server forwards the message delivery
status report to the Legacy 3GPP Message Gateway as specified in clause 8.3.5,
the Legacy 3GPP Message Gateway translates the MSGin5G message delivery status
report to a Legacy 3GPP message delivery status report and sends it to the
Legacy 3GPP UE.
#### 8.7.3.3 From Non-3GPP UE to Application Server
This procedure is used for message reply from Legacy 3GPP UE to Application
Server.
Figure 8.7.3.3-1 shows the message delivery procedure from Non-3GPP UE to
Application Server.
Pre-conditions:
1\. The Application server has established a secured communication with the
MSGin5G Server
2\. The Non-3GPP Message Client in Non-3GPP UE has registered with the MSGin5G
Server via the Non-3GPP Message Gateway.
2\. The Non-3GPP UE received a message from the Application Server.
3\. The Non-3GPP Message Gateway is aware of the Non-3GPP message client on
the Non-3GPP UE and provides the mapping between its identifiers and UE
Service ID.
4\. The Non-3GPP Message Gateway assigns a routable Non-3GPP identifier to the
Application Server when it sent MSGin5G message to Non-3GPP UE. The Non-3GPP
Message Gateway keep the mapping between the AS Service ID of the Application
Server and the MSISDN assigned to it
Figure 8.7.3.3-1: Non-3GPP UE replies to Application Server
1\. The Non-3GPP UE sends a Non-3GPP message request to the Non-3GPP Message
Gateway.
2\. The Non-3GPP Message Gateway translates the Non-3GPP Message to MSGin5G
message and may include MSGin5G message delivery status report requested in
the MSGin5G message. The Non-3GPP Message Gateway sends an MSGin5G message
request to the MSGin5G Server as specified in clause 8.3.2 with the following
clarifications:
a) The MSGin5G message request includes Originating UE Service ID, Recipient
AS Service ID and Message ID information elements in Table 8.3.2-1, and may
include Delivery status required, Application ID, Payload, Priority type
information elements from Table 8.3.2-1.
b) Upon receiving the MSGin5G message request, the MSGin5G Server determines
that the Non-3GPP UE with its UE Service ID is allowed to reply message to the
Application Server.
3\. The MSGin5G Server forwards the MSGin5G message in API request to
Application Server as specified in clause 8.3.3.
4-6. If the delivery status is required, the Application Server sends message
delivery status report by API request to MSGin5G Server as specified in clause
8.3.4, the MSGin5G Server sends the message delivery status report to the
Non-3GPP Message Gateway as specified in clause 8.3.5, the Non-3GPP Message
Gateway translates the MSGin5G message delivery status report to a Non-3GPP
message delivery status report and sends it to the Non-3GPP UE.
### 8.7.4 MSGin5G Group messaging
#### 8.7.4.1 General
This clause introduces a group messaging procedure for MSGin5G Client and
MSGin5G Server to send and receive Group message after a group is created. In
this procedure, the group creation and membership management are handled by
group management function specified in 3GPP TS 23.434 [5].
#### 8.7.4.2 Message delivery from UE to group
Figure 8.7.4.2-1 shows the MSGin5G Group messaging procedure in which MSGin5G
Client (both IMS and non-IMS UE) sends a message to a group.
Editor\'s note: Solution for the group hosted on the legacy side where MSGin5G
Client is one of the group members is FFS.
Pre-conditions:
1\. An MSGin5G Group is created by following group management SEAL service
procedures as specified in 3GPP TS 23.434 [5].
2\. All participants in the MSGin5G Group may get the Group information i.e.
the Group Service ID.
3\. The group consists of different types of UEs i.e. MSGin5G UE, Legacy 3GPP
UE and Non-3GPP UE.
4\. The MSGin5G Server has a copy of the group profile with all the group
members by using Group information query specified in 3GPP TS 23.434 [5].
Figure 8.7.4.2-1: Group messaging in MSGin5G Service
1\. The MSGin5G Client 1 sends a message to a group as specified in clause
8.3.2 with following clarifications:
a) The MSGin5mG Message request includes Originating UE Service ID, Recipient
Group Service ID and Message ID information elements from Table 8.3.2-1. The
MSGin5G message request may include Delivery status required, Application ID,
Payload and Priority type information elements from Table 8.3.2-1.
NOTE: If the originating UE is member of the group, the originating UE is not
included as recipient of the group message.
2\. Upon receiving the MSGin5G message request to send the group message, the
MSGin5G Server may send the message to the Application Server based on service
ID present in the received MSGin5G message request (e.g. to log application
specific message or for analytics). Otherwise go to step 4.
a) Upon receiving the MSGin5G message request, the Application Server
validates the message and if the message is not valid, the Application Server
sends MSGin5G message response with delivery status set as Reject to the
MSGin5G Server. Otherwise, go to step 3.
b) The MSGin5G Server sends the MSGin5G message response with delivery status
set as reject to the MSGin5G Client 1. The information elements defined in
Table 8.3.2-3 are included in the response. Following procedures will be
skipped.
3\. The Application Server initiates to send message to all group members and
sends the MSGin5G message request to the MSGin5G Server.
Editor\'s note: Whether to keep or correct step 2 or 3 is FFS.
4 Upon receiving the MSGin5G message request, if the MSGin5G Server determines
the MSGin5G Client-1 is authorized to send the group message, the MSGin5G
server resolves the group ID to determine the members of that group, based on
the information from the group management server as specified in 3GPP TS
23.434 [5].
5\. The MSGin5G Server sends the message to all participants of the group by
their UE Service ID. The MSGin5G message request includes Originating UE
Service ID, Recipient Group ID, Recipient UE Service ID, Message ID, Payload
information elements from Table 8.3.3-1. The MSGin5G message request may
include Delivery status required, Application ID and Priority type information
elements from Table 8.3.3-1. The MSGin5G Server routes, using the procedures
in clause 8.3.3, the message to:
a) the MSGin5G UE,
b) the Legacy 3GPP UE,
c) the Non-3GPP UE.
NOTE: Steps 5 a), 5 b) and 5 c) can happen in parallel and in any order.
5\. Upon receiving the group message, if message delivery status report is
requested and if supported by target message client, the MSGin5G Client or
Legacy 3GPP UE or Non-3GPP message client sends the message delivery status
report to originator MSGin5G Client 1 as specified in clause 8.2.4 and 8.3.5.
#### 8.7.4.3 Message delivery procedure from Application Server to group
Figure 8.6.4.3-1 shows the MSGin5G Group messaging procedure in which
Application Server sends a message to a group.
Pre-conditions:
1\. An MSGin5G Group is created by following group management SEAL service
procedures as specified in 3GPP TS 23.434 [5].
2\. The group consists of different types of UEs i.e. MSGin5G UE, Legacy 3GPP
UE and Non-3GPP UE, they may receive group message from one Application
Server.
Figure 8.7.4.3-1: Group messaging in MSGin5G Service
1\. The Application Server sends a message to a group as specified in clause
8.3.2.
2 Upon receiving the MSGin5G message request, if the AS is authorized to send
the group message, the MSGin5G server resolves the group ID to determine the
members of that group, based on the information from the group management
server specified in 3GPP TS 23.434 [5].
3\. The MSGin5G Server sends the message to all participants of the group
based on UE Service ID. The MSGin5G Message Request includes Originating AS
Service ID, Recipient Group ID, Recipient UE Service ID, Message ID, Payload
information elements from Table 8.3.3-1. The MSGin5G Message Request may
include Delivery Status Required, Application ID and Priority Type information
elements from Table 8.3.3-1. The MSGin5G Server routes, using the procedures
in clause 8.7.2, the message to:
a) the MSGin5G UE,
b) the Legacy 3GPP UE,
c) the Non-3GPP UE.
NOTE: Steps 3 a), 3 b) and 3 c) can happen in parallel and in any order.
4\. Upon receiving the group message, if message delivery status report is
requested and if supported by target message client, the MSGin5G Client or
Legacy 3GPP UE or Non-3GPP message client sends the message delivery status
report to originator Application Server as specified in clause 8.3.4 and
8.3.5.
### 8.7.5 Message delivery between different PLMNs
#### 8.7.5.1 General
MSGin5G message may be delivered between different PLMNs.
The procedure may apply to Point-to-Point message and Group message,
Application-to-Point message and Point-to-Application message delivery based
on the business agreement between the PLMNs.
#### 8.7.5.2 Inter-PLMN message exchange procedure
Pre-condition:
1\. The Message Sender (e.g. MSGin5G Client 1 in MSGin5G UE 1) is registered
to the MSGin5G Server 1 in one PLMN.
2\. The Message Receiver (e.g. MSGin5G Client 2 in MSGin5G UE 2) is registered
to the MSGin5G Server 2 in another PLMN.
3\. MSGin5G Server 1 and MSGin5G Server 2 have established a secured
connection.
Figure 8.7.5-1 shows message delivery between MSGin5G endpoints in different
PLMNs, where Message Sender is registered in MSGin5G Server 1 and Message
Receiver is registered in MSGin5G Server 2.
Figure 8.7.5-1: Message delivery between MSGin5G UEs in different PLMNs
1\. The Message Sender sends an MSGin5G message request to MSGin5G Server 1 in
PLMN 1 as specified in clause 8.3.2.
2\. The MSGin5G Server 1 analyses the target UE Service ID and determines that
the message is targeted to the Message Receiver in PLMN 2, authenticates that
the Message Sender is allowed to send a message to the Message Receiver, and
then the MSGin5G Server 1 forwards the MSGin5G message request to MSGin5G
Server 2 in PLMN 2.
3\. MSGin5G Server 2 forwards the MSGin5G message request to the Message
Receiver as specified in clause 8.3.3.
4-6. If the message delivery status report is requested, the Message Receiver
sends a message delivery status report to Message Sender as per procedure
specified in clause 8.3.4 and 8.3.5.
Editor\'s Note: how the Message delivery based on Messaging Topic works for
UEs/Application Servers reside in different MSGin5G Servers and different
PLMNs is FFS.
## 8.8 Other MSGin5G messaging related procedures
### 8.8.1 Messaging Topic Subscription
An MSGin5G Client or an Application Server can subscribe one or more Messaging
Topic(s) on the MSGin5G Server. The Messaging Topic IE will be populated by
the Application Client or the Application Server and the content of this IE is
out of scope.
When an MSGin5G Client or an Application Server is subscribed to a Messaging
Topic, then the MSGin5G Server will deliver messages that contain the same
Messaging Topic to the subscriber.
Figure 8.8.1-1 shows the MSGin5G Client/Application Server subscribing to
Messaging Topic(s) on the MSGin5G Server.
Pre-conditions:
1\. The MSGin5G Client or Application Server has registered to the MSGin5G
Server.
Figure 8.8.1-1: MSGin5G Service endpoint subscribes to Messaging topic(s)
1\. The MSGin5G Client or Application Server sends a Messaging Topic
subscription request to the MSGin5G Server. The request includes the
information elements listed in Table 8.8.1-1.
Table 8.8.1-1: Messaging Topic subscription request
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | Originating UE Service | M | The service identity of the | | ID/AS Service ID | | sending MSGin5G Client or | | | | the sending Application | | | | Server. | +-----------------------------+--------+-----------------------------+ | Messaging Topic | M | A list of Messaging | | | | Topic(s) that is to be | | | | subscribed. The number of | | | | Messaging Topic(s) included | | | | in this IE can be one or | | | | more. | +-----------------------------+--------+-----------------------------+ | Expiration | O | The date and time when the | | | | subscription expires. | | | | | | | | This date and time apply to | | | | all Messaging Topic(s) | | | | subscribed in this request. | | | | | | | | If this IE is included, the | | | | value of it should be | | | | larger than 0. | | | | | | | | If this IE is not included, | | | | the expiration time is | | | | subject to operator policy. | +-----------------------------+--------+-----------------------------+ | NOTE: The content of the | | | | Messaging Topic is out of | | | | scope of the present | | | | document. | | | +-----------------------------+--------+-----------------------------+
2\. The MSGin5G Server validates the Messaging Topic subscription request and
checks the local stored Messaging Topic(s).
a) If the subscribed Messaging Topic has already been created, the MSGin5G
Server checks whether the UE Service ID/AS Service ID of the subscriber is
already included in the subscribers list of this Messaging Topic.
1\. If not, the MSGin5G Server adds the UE Service ID/AS Service ID of the
subscriber to the subscribers list of this Messaging Topic. The MSGin5G Server
sets the validity time of this subscription to the value of the Expire IE or
to a default value according to the service policy.
2\. Else, the MSGin5G Server updates the validity time of this subscription.
b) If the subscribed Messaging Topic has not been already created, the MSGin5G
Server creates this Messaging Topic, and adds the UE Service ID/AS Service ID
of the subscriber to the subscribers list of this Messaging Topic. The MSGin5G
Server sets the validity time of this subscription to the value of the Expire
IE or to a default value according to the service policy.
3\. The MSGin5G Server sends a Messaging Topic Subscription response to the
originator of the request. The response includes the information listed in
Table 8.8.1-2.
Table 8.8.1-2: Messaging Topic Subscription response
* * *
Information element Status Description Subscription status M Indicates whether
the subscription was successfully added or deleted on the MSGin5G Server.
Expiration O The validity date and time of this subscription set by the
MSGin5G Server.
* * *
8.8.2 Message delivery based on Messaging Topic
If an MSGin5G Client or an Application Server is in the subscribers list of a
Messaging Topic, the MSGin5G Server delivers messages that contain this
Messaging Topic to it.
Figure 8.8.2-1 shows the Message delivery to a subscribing service endpoint
based on Messaging Topic.
Pre-conditions:
> 1\. The MSGin5G Client or Application Server subscribed to a Messaging Topic
> with the MSGin5G Server. A Messaging Topic with the UE Service ID/AS Service
> ID of the subscriber has been created.
Figure 8.8.2-1: Message delivery to subscribing service endpoint based on
Messaging Topic
1\. The MSGin5G Server receives an MSGin5G message request or an API message
request corresponding to step 2 in figures 8.3.2-1 or 8.3.2-2 which includes
the IEs as listed in table 8.3.2-1. The MSGin5G message request or API message
request contains a Messaging Topic IE corresponding to the Messaging Topic for
which the subscription exists.
2\. The MSGin5G Server uses the procedure described in clause 8.3.3 to deliver
the message to all subscriber(s) of this Messaging Topic. In each outbound
message, the UE Service ID/AS Service ID of subscriber should be added as the
Recipient UE Service ID/AS Service ID IE specified in table 8.3.3-1.
### 8.8.3 Messaging Topic Unsubscription
Corresponding to message topic unsubscription, an MSGin5G Client or an
Application Server can unsubscribe one or more Messaging Topic(s) on the
MSGin5G Server.
Figure 8.8.3-1 shows the MSGin5G Client/Application Server unsubscribing to
Messaging Topic(s) on the MSGin5G Server.
Pre-conditions:
1\. The MSGin5G Client or Application Server has subscribed one or more
message topic(s) on the MSGin5G Server.
Figure 8.8.3-1: MSGin5G Service endpoint unsubscribes to Messaging topic(s)
1\. The MSGin5G Client or Application Server sends a Messaging Topic
unsubscription request to the MSGin5G Server. The request includes the
information listed in Table 8.8.3-1.
Table 8.8.3-1: Messaging Topic unsubscription request
* * *
Information element Status Description Originating UE Service ID/AS Service ID
M The service identity of the sending MSGin5G Client or the sending
Application Server. Messaging Topic(s) M A list of Messaging Topic(s) that is
to be subscribed. The number of Messaging Topic(s) included in this IE can be
one or more.
* * *
2\. The MSGin5G Server validates the Messaging Topic unsubscription request
and checks the local stored Messaging Topic(s). If the subscribed Messaging
Topic has already been created and if the UE Service ID/AS Service ID of the
subscriber is already included in the subscribers list of this Messaging
Topic, the MSGin5G Server removes the UE Service ID/AS Service ID from the
subscribers list of this Messaging Topic.
3\. The MSGin5G Server sends a Messaging Topic Unsubscription response to the
originator of the request. The response includes the information listed in
Table 8.8.3-2.
Table 8.8.3-2: Messaging Topic Unsubscription response
* * *
Information element Status Description subscription status M Indicates whether
the subscription was successfully deleted on the MSGin5G Server
* * *
8.9 Usage of Network Capabilities
### 8.9.1 General
The present clause specifies the functionality leveraged by the MSGin5G
Service via Core Network exposure.
### 8.9.2 UE reachability status monitoring
#### 8.9.2.1 General
UE reachability status leverages the 3GPP network monitoring functionality
exposed via T8/N33 reference point detailed in 3GPP TS 23.502 [7] and TS
29.522[10]. How the MSGin5G Server determines whether and how (e.g., via
request/response or subscription) to monitor the UE reachability using the
3GPP Network capabilities is implementation dependent.
NOTE 1: Use of the UE reachability status monitoring procedure in the
application layer has no impact to how the Core Network delivers the message
to the UE.
NOTE 2: MSGin5G Service provider policies may indicate whether the UE
reachability status monitoring feature is enabled or not.
Editor\'s note: The use of UE reachability monitoring in conjunction with
other features (e.g., device triggering, store and forward) is to be further
described after the individual, stand-alone functions have a basic definition
in the specification.
#### 8.9.2.2 Procedures
##### 8.9.2.2.1 Request-response
Figure 8.9.2.2.1-1 shows the procedure which may be used by the MSGin5G Server
to make a request for UE reachability status information.
Pre-conditions:
1\. A UE hosts an MSGin5G Client.
2\. The MSGin5G Client registers with the MSGin5G Server and shares UE contact
information.
3\. The MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network, e.g., that the UE is a sleepy node.
NOTE: How the MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network is implementation dependent.
{width="3.3965277777777776in" height="3.295138888888889in"}
Figure 8.9.2.2.1-1: MSGin5G reachability status request-response.
1\. The MSGin5G Server sends a one-time Monitoring Request to the 3GPP Network
using SCEF/NEF capabilities.
> The one-time Monitoring Request includes monitoring type set to
> UE_REACHABILITY, Maximum Number of Reports of 1 and does not include the
> Monitoring Duration IE.
2\. The 3GPP network processes the monitoring request and determines the
reachability status of the UE(s), as described in 3GPP TS 29.122 [9].
3\. If the Monitoring Request is successfully processed, a monitoring response
providing the UE(s) reachability status is sent to the MSGin5G Server. The
response may include idle mode information e.g., active time granted to the
UE, eDRX cycle length, periodic RAU/TAU timer, etc., depending on the
parameters indicated in the request.
##### 8.9.2.2.2 Subscribe
Figure 8.9.2.2.2-1 shows the procedure which may be used by the MSGin5G Server
to subscribe for monitoring of UE reachability.
Pre-conditions:
1\. A UE hosts an MSGin5G Client.
2\. The MSGin5G Client registers with the MSGin5G Server and shares UE contact
information.
3\. The MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network, e.g., that the UE is a sleepy node.
NOTE: How the MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network is implementation dependent.
{width="3.5215277777777776in" height="3.6083333333333334in"}
Figure 8.9.2.2.2-1: MSGin5G reachability status subscribe.
1\. The MSGin5G Server sends a Monitoring Event Subscribe request to the 3GPP
Network using existing SCEF/NEF capabilities.
> The Monitoring Event Subscribe is a Monitoring Request with monitoring type
> set to UE_REACHABILITY , and either the Maximum Number of Reports greater
> than 1 or the Monitoring Duration IE are included.
3\. The 3GPP network processes the Monitoring Event Subscribe request as
described in 3GPP TS 29.122 [9].
4\. If the Monitoring Event Subscribe Request is successfully processed, a
response indicating the request was accepted is sent to the MSGin5G Server.
##### 8.9.2.2.3 Notify
Figure 8.9.2.2.3-1 shows the procedure which may be for updating MSGin5G
reachability status.
Pre-conditions:
1\. The MSGin5G Server has subscribed for reachability status monitoring for a
UE or group of UEs.
2\. The monitored UE(s) transitions to Connected Mode, Idle Mode or eDRX
paging occasion and the 3GPP Network Entities detects the change in UE
reachability status.
{width="4.035416666666666in" height="3.636111111111111in"}
Figure 8.9.2.2.3-1: MSGin5G reachability status notify.
1\. Based on the reachability status change of a monitored UE(s), the 3GPP
Network sends a Monitoring Notification message for UE reachability to the
MSGin5G Server as specified in 3GPP TS 29.122 [9].
> The notification may include idle mode information e.g., active time granted
> to the UE, eDRX cycle length, periodic RAU/TAU timer, etc., depending on the
> subscription.
2\. After receiving a UE Reachability monitoring notification, the MSGin5G
Server responds with an acknowledgement of the notification via SCEF/NEF.
3\. The MSGin5G Server uses the information provided in the UE reachability
monitoring event report to update its information on the UE\'s availability,
e.g., MSGin5G Client Availability information. The MSGin5G Server may provide
additional services based on reachability information, e.g., forward a stored
message, etc.
##### 8.9.2.2.4 Unsubscribe
Figure 8.9.2.2.4-1 shows the procedure which may be used by the MSGin5G Server
to unsubscribe from monitoring of UE reachability.
Pre-conditions:
1\. The MSGin5G Server has subscribed for reachability status monitoring for a
UE or group of UEs.
2\. Later, the MSGin5G Server determines to unsubscribe for monitoring of UE
reachability events in the Core Network,
NOTE 1: How the MSGin5G Server determines to subscribe or unsubscribe for
monitoring of UE reachability events in the Core Network is implementation
dependent.
NOTE 2: If the initial MSGin5G Server subscription for reachability status
monitoring reaches the Maximum Number of Reports or Monitoring Duration
indicated in the request, the 3GPP Network automatically deletes the
subscription and an explicit MSGin5G reachability status unsubscribe is not
necessary.
{width="3.3895833333333334in" height="3.7680555555555557in"}
Figure 8.9.2.2.4-1: MSGin5G reachability status unsubscribe.
1\. The MSGin5G Server sends a Monitoring event unsubscribe request to the
3GPP Network using existing SCEF/NEF capabilities.
2\. The 3GPP network processes the Monitoring event unsubscribe request and
deletes the subscription, as described in 3GPP TS 29.122 [9].
3\. If the Monitoring event unsubscribe request is successfully processed, a
response indicating the subscription was deleted is sent to the MSGin5G Server
via SCEF/NEF.
#### 8.9.2.3 Flows
The following information flows are specified for UE reachability status
monitoring:
\- UE Reachability monitoring request and response;
\- UE Reachability monitoring subscribe and unsubscribe
\- UE Reachability monitoring notify
All UE reachability monitoring interactions from MSGin5G Server (acting as
SCS/AS) to SCEF/NEF occur over T8/N33 reference points capabilities detailed
in 3GPP TS 23.502 [7] and TS 29.522[10]. As specified in TS 29.522[10] clause
4.4.2, all UE Reachability monitoring procedures use APIs specified in TS
23.682 [8] clause 5.6.1.4 and 3GPP TS 29.122 [9] clause 4.4.2.2.
### 8.9.3 MSGin5G device triggering
#### 8.9.3.1 General
MSGin5G device triggering is the means by which an Application Server sends an
MSGin5G message and the 3GPP network device triggering capabilities exposed
via T8 /N33 reference point are leveraged. For example, when an Application
Server initiates an MSGin5G message request, but the target UE is not
reachable, the MSGin5G Server may use the 3GPP network device triggering
mechanism to wake up the device and provide the payload to the destination.
#### 8.9.3.2 Procedure
Figure8.9.3.2-1 shows the MSGin5G device triggering procedure.
Pre-conditions:
1\. A UE hosts an MSGin5G Client and/or Application Client which are supported
by the MSGin5G Service.
2\. The MSGin5G Client registers with the MSGin5G Server.
3\. At a later time, the UE becomes unreachable by the MSGin5G Server.
Figure 8.9.3.2-1: MSGin5G Triggering Procedure
1\. The Application Server sends an API request to the MSGin5G Server for
sending an MSGin5G message, the API request includes the IEs as detailed in
clause 9.1.2.1.
2\. If the MSGin5G Server determines that the recipient MSGin5G Client is not
reachable, it initiates a device trigger request via the SCEF/NEF as a result
of the step 1 request.
> To determine the reachability of the target UE, the MSGin5G Server may use
> the UE reachability status monitoring procedure in clause 8.9.2. The MSGin5G
> Server may also use availability information provided by the MSGin5G Client
> at registration in the MSGin5G Client Communication Availability IE, as
> detailed in Table 8.2.1-1.
NOTE 1: How the MSGin5G Server uses the MSGin5G Client Communication
Availability IE, the UE reachability status monitoring procedure, or a
combination thereof to make this determination is implementation specific.
NOTE 2: If the recipient MSGin5G Client is reachable then the trigger request
is not required, the MSGin5G Server sends the MSGin5G message as detailed in
clause 8.3.3 and the rest of the steps in this procedure are skipped.
> 3\. The MSGin5G Server sends a request for Device Triggering via SCEF/NEF
> and determines the flow as detailed in clause 8.9.3.3.2. The Device
> Triggering request uses the UE Identifier, port number(s) and associated
> protocol information provided by the MSGin5G Client at registration in the
> MSGin5G Client Triggering Information IE.
>
> The MSGin5G Server may use MSGin5G Client Communication Availability and/or
> pre-configured information to determine the timing of the Device Triggering
> request, e.g. the trigger may be sent to ensure that the target UE is
> reachable prior to resuming MSGin5G communications.
4\. The MSGin5G Server receives a response from SCEF/NEF indicating the
success or failure status of the request, as detailed in clause 8.9.3.3.
5\. The device trigger is delivered to the target via SCEF/NEF and the Core
Network. The targeted MSGin5G Client or Application Client receives the device
trigger request. The targeted MSGin5G Client or Application Client parses the
payload of the trigger request and determines the device trigger purpose. The
target UE becomes reachable, and the MSGin5G Client or Application Client
becomes available for further MSGin5G communications.
6\. The MSGin5G Server receives a Device Triggering delivery status report
from SCEF/NEF indicating the success of the delivery, as detailed in clause
8.9.3.3.
7\. The MSGin5G Server send a Device Triggering delivery status report
response to SCEF/NEF to acknowledge the delivery status report, as detailed in
clause 8.9.3.3.
8\. The MSGin5G Server responds to the request received in step 1.
Based on the trigger purpose derived from the payload, the targeted MSGin5G
Client or Application Client performs the corresponding actions (e.g.
establish access network connectivity, contact the Application Server etc).
#### 8.9.3.3 Flows
The following information flows are specified for MSGin5G triggering:
1\. request for device triggering;
2\. response to device triggering;
3\. device triggering delivery report; and
4\. device triggering delivery report response.
All device triggering interactions from MSGin5G Server (acting as SCS/AS) to
SCEF/NEF occur over T8/N33 reference points, using capabilities detailed in
3GPP TS 23.502 [7] and TS 29.522[10]. As specified in TS 29.522[10] clause
4.4.3, all device triggering flows use APIs specified in TS 23.682 [8] clause
5.17.1 and 3GPP TS 29.122 [9] clause 4.4.6.
8.10 Usage of SEAL
### 8.10.1 General
The MSGin5G Service functional entities MSGin5G Client and MSGin5G Server
utilize the SEAL services. All SEAL services specified in 3GPP TS 23.434 [5]
are available to MSGin5G Service. In this clause, only the details of the
information flows, procedures and APIs whose utilization by MSGin5G Service
are well-known are described.
### 8.10.2 Configuration management service
#### 8.10.2.1 General
The MSGin5G Service functional entities MSGin5G Client and MSGin5G Server
utilize configuration management service procedures of SEAL to support MSGin5G
Service.
#### 8.10.2.2 Information flows
The following information flows of Configuration Management service are
applicable for the MSGin5G Service:
\- Get VAL UE configuration request specified in subclause 11.3.2.1 of 3GPP TS
23.434 [5];
\- Besides the IEs specified in subclause 11.3.2.1 of 3GPP TS 23.434 [5], the
information in table 8.10.2.2-1 is also included in the Get VAL UE
configuration request.
Table 8.10.2.2-1: Additional information in the Get VAL UE configuration
request
* * *
Information element Status Description MSGin5G UE information O Other
information needed by the configuration procedure.(NOTE) NOTE: The information
can be the device type, device Vendor, etc. It is specified by application
provider or MSGin5G Service provider and is out of scope of this document. The
MSGin5G Service provider can configure the MSGin5G UE with different
configuration data based on this IE. E.g. all sensors can be configured to a
same MSGin5G Server.
* * *
\- Get VAL UE configuration response specified in subclause 11.3.2.2 of 3GPP
TS 23.434 [5];
\- Besides the IEs specified in subclause 11.3.2.2 of 3GPP TS 23.434 [5], the
information in table 8.10.2.2-2 is also included in the Get VAL UE
configuration response.
Table 8.10.2.2-2: Additional information in the Get VAL UE configuration
response
* * *
Information element Status Description UE service ID M MSGin5G Service ID
assigned to the requesting MSGin5G UE. MSGin5G Server address M The MSGin5G
Server which serves this MSGin5G UE. MSGin5G Service specified information O
The specific information of the MSGin5G Service specified by the MSGin5G
Service provider. (NOTE) NOTE: E.g. the segment size of MSGin5G message in
this service provider, the detailed definition is out of scope of this
document.
* * *
The usage of the above information flows are clarified as below:
\- The VAL UE ID is the MSGin5G UE ID;
\- VAL service ID is the service identifier of the MSGin5G Service; and
\- VAL UE configuration data is the MSGin5G UE configuration data.
#### 8.10.2.3 Procedures
The following procedures of configuration management service are applicable
for the MSGin5G Service:
\- VAL UE configuration data specified in subclause 11.3.3 of 3GPP TS 23.434
[5].
### 8.10.3 Group management service
#### 8.10.3.1 General
The MSGin5G Service functional entities MSGin5G Client and MSGin5G Server
utilize SEAL Client and SEAL Server for the group management service (e.g.
creation, join, leave) on the group configuration information (e.g. group join
policy, group leader) provided by the MSGin5G Server. The decisions and
corresponding triggers (e.g. group creation, join, leave) for group management
are responsibility of the application leveraging MSGin5G Service. The group
management service of SEAL provides support for creating group for MSGin5G
Service for applications leveraging MSGin5G Service.
#### 8.10.3.2 Information flows
Editor\'s note: The reference to information flows of group management
procedures as specified in 3GPP TS 23.434 [5] are FFS.
#### 8.10.3.3 Procedures
The following procedures of group management service of SEAL as specified in
3GPP TS 23.434 [5] are applicable for the MSGin5G Service:
\- Group creation specified in clause 10.3.3;
\-- Subsequent to Step 3, when the identity list with the list of VAL user IDs
or VAL UE IDs that are part of the created group contain the list of VAL user
IDs or VAL UE IDs which does not have group management client on the UE (e.g.
Legacy 3GPP UEs or Non-3GPP UEs), it is responsibility of the VAL server
(MSGin5G Server) to initiate the group creation notification towards those
UEs.
\- Group configuration management specified in clause 10.3.6;
\- Group membership update specified in clause 10.3.5.2.
Editor\'s note: Adding new Group deletion procedure to TS 23.434 and adding
any other SEAL procedure references to this specification is FFS.
Editor\'s note: Whether MSGin5G Service endpoints can dynamically join and
leave group is FFS.
#### 8.10.3.4 APIs
The following APIs of group management service of SEAL as specified in 3GPP TS
23.434 [5] are applicable for the MSGin5G Service:
\- SS_GroupManagement API specified in clause 10.4.2;
\- SS_Group_Management_Event API specified in clause 10.4.5.
## 8.11 Constrained devices in MSGin5G Service
### 8.11.1 General
This clause specifies the procedures for the constrained device UE-2 which
does not support an MSGin5G Client to perform registration to use MSGin5G UE-1
as gateway UE and to send messages and receive messages using MSGin5G UE-1
which is acting as a gateway UE for the UE-2. The communications between
MSGin5G UE-1 and UE-2 is over MSGin5G-5 reference point.
NOTE: The procedure in this clause is also applicable to UE that is out of
network coverage.
Editor\'s note: The API definition for the procedures defined in this clause
is FFS.
Editor\'s note: Whether the procedures in this clause are applicable to
Application Client within MSGin5G UE-1 is FFS.
### 8.11.2 Constrained device registration to use gateway UE
The signalling flow for registration of Application Client-2 on the UE-2
(which is a Constrained UE) with MSGin5G Client-1 on MSGin5G UE-1 to use it as
a gateway UE is illustrated in figure 8.11.2-1.
Pre-conditions:
1\. The MSGin5G UE-1 is configured with information to recognize and authorize
UE-2.
2\. The UE-2 is a Constrained UE and does not have access network connection
to connect with the MSGin5G Server.
3\. The UE-2 has discovered MSGin5G UE-1 is having connectivity to the MSGin5G
Server and offers gateway UE functionality.
4\. The UE-2 is using NR-PC5 to communicate with MSGin5G UE-1.
Figure 8.11.2-1: Registration of application client on UE-2 with MSGin5G
Client-1 to use gateway UE functionality
1) An Application Client-2 on the UE-2 registers with MSGin5G Client-1 in
MSGin5G UE-1 to request MSGin5G Client-1 to act as a gateway UE. The request
message includes information elements as specified in Table 8.11.2-1.
Table 8.11.2-1: Information elements for Registration to gateway UE request
* * *
Information element Status Description Layer-2 ID M Layer-2 identity of UE-2
Application ID M Application ID of the application client on UE-2 Credential
information M UE-2 credential information
* * *
Editor\'s note: The security parameters to include in the message between UE-2
and MSGin5G UE-1 are FFS.
2) Upon receiving the request from the Application Client-2, the MSGin5G
Client-1 authorizes the Application Client-2 on UE-2 to use gateway
functionality and MSGin5G Client-1 stores the mapping between Application ID
and Layer-2 ID of the UE-2.
NOTE 1: The MSGin5G Client-1 may reject the request for registration to use
gateway UE functionality based on local condition (like available power or
connectivity to access network or any other reason outside the scope of 3GPP).
3) The MSGin5G Client-1 sends response to the Application Client-2. The
response message includes information elements as specified in Table 8.11.2-2.
Table 8.11.2-2: Information elements for Registration to gateway UE response
* * *
Information element Status Description Result M Indicates success or failure
of the request Registration ID O Identifies registration. This IE is included
only if Result IE is set to success. Failure reason O Indicates failure
reason. This IE is included only if Result IE is set to failure.
* * *
NOTE 2: If MSGin5G Client-1 decided to reject the request for registration to
use gateway UE functionality or if authorization fails as in step 2), the
MSGin5G Client-1 sends a failure response to the Application Client-2.
Otherwise, the MSGin5G Client-1 sends a success response to the Application
Client-2.
NOTE 3: The MSGin5G Client-1 may act as Gateway UE for multiple Constrained
UEs, at the same time.
### 8.11.3 Constrained device Deregistration from using gateway UE
The signalling flow for deregistration of Application Client-2 on the UE-2
(which is a Constrained UE) with MSGin5G Client-1 to discontinue use of
gateway UE functionality is illustrated in figure 8.11.3-1.
Pre-conditions:
1\. The UE-2 is a Constrained UE and is successfully registered with MSGin5G
UE-1 acting as a gateway UE.
Figure 8.11.3-1: Deregistration of Application Client on UE-2 with MSGin5G
Client-1 on MSGin5G UE-1 to discontinue use of gateway UE functionality
1) An Application Client-2 on the UE-2 deregisters with MSGin5G Client-1 in
MSGin5G UE-1 to discontinue usage of gateway UE functionality of MSGin5G UE-1.
The request message includes information elements as specified in Table
8.11.3-1.
Table 8.11.3-1: Information elements for De-registration to gateway UE request
* * *
Information element Status Description Registration ID M Identifies the
registration
* * *
2) Upon receiving the request from the Application Client-2, the MSGin5G
Client-1 removes the mapping between Application ID and Layer-2 ID of the
UE-2. The MSGin5G Client-1 sends response to the Application Client-2 on UE-2.
The response message includes information elements as specified in Table
8.11.2-2.
### 8.11.4 Constrained device sending message using Gateway UE
The signalling flow for the Application Client-2 on the UE-2 (which is a
Constrained UE) to send message using gateway UE functionality on MSGin5G UE-1
is illustrated in figure 8.11.4-1.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The UE-2 is Constrained UE and is successfully registered with MSGin5G
UE-1 acting as a gateway UE.
Figure 8.11.4-1: Application Client-2 on UE-2 sends message using gateway UE
functionality on MSGin5G UE-1
1) An Application Client-2 on the UE-2 sends a request to send MSGin5G message
to the MSGin5G Client-1. The information elements defined in Table 8.11.4-1
are included in the message.
Table 8.11.4-1: Information elements for Request to send MSGin5G message
+--------------------------+--------+-----------------------------+ | Information element | Status | Description | +--------------------------+--------+-----------------------------+ | Recipient address | O | Indicates details of the | | | | recipient. This IE is | | | | mandatory to initiate | | | | Point-to-Point messaging | | | | and Point-to-Application | | | | messaging. | +--------------------------+--------+-----------------------------+ | Recipient Group address | O | Indicates target group. | | | | | | | | This IE is mandatory to | | | | initiate Group messaging. | +--------------------------+--------+-----------------------------+ | Application ID | O | Identifies the | | | | application(s) for which | | | | the payload is intended. | +--------------------------+--------+-----------------------------+ | Payload | M | Payload of the message. | | | | | | | | MSGin5G Server/Client is | | | | unaware of the content. | +--------------------------+--------+-----------------------------+ | Delivery status required | O | Indicates whether delivery | | | | status is required or not | +--------------------------+--------+-----------------------------+
Editor\'s note: If Priority type needs to be communicated from application
clients is FFS.
2) Upon receiving the request from the Application Client-2 in UE-2, the
MSGin5G Client-1 constructs the related IEs specified in table 8.3.2-1 and
sends Point-to-Point Message, Point-to-Application Message or Group Message
based on these Ies.
a) if the size of the received message exceeds the maximum allowed packet
size, the MSGin5G Client-1 sends the message as specified in clause 8.5; and
b) If the size of the received message does not exceed the maximum allowed
packet size, the MSGin5G Client-1 sends the message as specified in clause
8.7.
NOTE 1: The MSGin5G Client-1 may also reject the request to send MSGin5G
message based on local condition (like available power or connectivity to
access network or any other reason outside the scope of 3GPP).
3) The MSGin5G Client-1 sends response to send MSGin5G message to Application
Client-2 on UE-2. The response message includes information elements as
specified in Table 8.11.4-2.
Table 8.11.4-2: Information elements for Response to send MSGin5G message
* * *
Information element Status Description Result M Indicates success or failure
of the request Failure reason O Indicates failure reason. This IE is included
only if Result IE is set to failure.
* * *
NOTE 2: If the MSGin5G Client-1 has decided to reject the request to send the
message or the MSGin5G Client-1 received reject response from MSGin5G Server
in step 2, the MSGin5G Client-1 sends failure response to the Application
Client-2 and stops performing further steps.
4) If delivery status is requested while sending the message in step 1, the
MSGin5G Client-1 may receive MSGin5G message delivery status report from the
MSGin5G Server.
5) Upon receiving the MSGin5G message delivery status report, the MSGin5G
Client-1 sends the message delivery status report to the Application Client-2
on UE-2. The message delivery status report includes information elements as
specified in Table 8.11.4-3.
Table 8.11.4-3: Information elements for MSGin5G message delivery status
* * *
Information element Status Description Delivery status M Indicates delivery
status
* * *
### 8.11.5 Constrained device receiving message via Gateway UE
The signalling flow for Application Client-2 on the UE-2 (which is Constrained
UE) to receive message (Group message, Point-to-Point message or Application-
to-Point message) using gateway UE functionality on MSGin5G UE-1 is
illustrated in figure 8.11.5-1.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The UE-2 is Constrained UE and is successfully registered with MSGin5G
UE-1 acting as a gateway UE.
Figure 8.11.5-1: UE-2 receives message using gateway UE functionality on
MSGin5G UE-1
1) The MSGin5G Client-1 receives either a Group message or a Point-to-Point
message or Application-to-Point message as specified in clause 8.2.3 for the
Application Client-2 on UE-2 for which the MSGin5G Client-1 is acting as
Gateway UE. The MSGin5G Client-1 performs reassembly if the received message
is segmented. The MSGin5G Client-1 may also perform segment recovery procedure
as specified in clause 8.4.6 to recover missing segments.
2) Upon successfully receiving a message for the Application Client-2 on UE-2,
the MSGin5G Client-1 sends message received request to Application Client-2
based on Application ID on the UE-2. The request includes information elements
as specified in Table 8.11.5-1.
Table 8.11.5-1: Information elements for Message received request
+--------------------------+--------+-----------------------------+ | Information element | Status | Description | +--------------------------+--------+-----------------------------+ | Originator address | O | Indicates details of the | | | | originator. This IE is | | | | mandatory for | | | | Point-to-Point messaging | | | | and Application-to-Point | | | | messaging, i.e. Originating | | | | UE Service ID/AS Service | | | | ID.. | +--------------------------+--------+-----------------------------+ | Group Service address | O | Indicates group for which | | | | the message is received. | | | | | | | | This IE is mandatory for | | | | Group Message. | +--------------------------+--------+-----------------------------+ | Payload | M | Payload of the message. | | | | | | | | MSGin5G Server/Client is | | | | unaware of the content. | +--------------------------+--------+-----------------------------+ | Delivery status required | O | Indicates whether delivery | | | | status is required or not | +--------------------------+--------+-----------------------------+ | Priority type | O | Application priority level | | | | requested for this message. | +--------------------------+--------+-----------------------------+
3) Upon successfully receiving the message, the Application Client-2 on UE-2
sends the message received response to the MSGin5G Client-1.
4) If delivery status is requested in the received message, the Application
Client-2 on UE-2 sends message delivery status to the MSGin5G Client-1.
5) Upon receiving the delivery status, the MSGin5G Client-1 sends message
delivery status report to the MSGin5G Server.
# 9 APIs and related information flows
## 9.1 APIs provided by MSGin5G Server
### 9.1.1 Mm5s APIs
#### 9.1.1.1 M5S_AS_Originating_Message_Delivery API
##### 9.1.1.1.1 General
**API description:** This API enables the Application Server to send MSGin5G
message to the MSGin5G Server.
##### 9.1.1.1.2 Send_MSGin5G_Message operation
**API operation name:** Send_MSGin5G_Message
**Description:** Send an MSGin5G message to MSGin5G Server.
**Known Consumers:** Application Server
**Inputs:** Refer subclause 9.1.2.1
**Outputs:** Refer subclause 8.3.2
See subclause 8.3.2 for the details of usage of this API operation.
#### 9.1.1.2 M5S_UE_Originating_Message_Delivery API
##### 9.1.1.2.1 General
**API description:** This API enables the Message Gateway or other 5GS
Function to delivery MSGin5G message to the MSGin5G Server.
##### 9.1.1.2.2 Send_ MSGin5G_Message operation
**API operation name:** Send_MSGin5G_Message
**Description:** Send an MSGin5G Message to MSGin5G Server.
**Known Consumers:** L3G, N3G.
**Inputs:** Refer subclause 8.3.2
**Outputs:** Refer subclause 8.3.2
See subclause 8.3.2 for the details of usage of this API operation.
#### 9.1.1.3 M5S_AS_Originating_Delivery_Status_Report API
##### 9.1.1.3.1 General
**API description:** This API enables the Application Server to delivery
MSGin5G message delivery status report to the MSGin5G Server.
##### 9.1.1.3.2 Report_Message_Delivery_Status operation
**API operation name:** Report_Message_Delivery_Status
**Description:** Send an MSGin5G message delivery status report to MSGin5G
Server.
**Known Consumers:** Application Server
**Inputs:** Refer subclause 9.1.2.2
**Outputs:** Refer subclause 8.3.4
See subclause 8.3.4 for the details of usage of this API operation.
#### 9.1.1.4 M5S_UE_Originating_Delivery_Status_Report API
##### 9.1.1.4.1 General
**API description:** This API enables the Message Gateway or other 5GS
Function to deliver MSGin5G message delivery status report to the MSGin5G
Server.
##### 9.1.1.4.2 Report_Message_Delivery_Status operation
**API operation name:** Report_Message_Delivery_Status
**Description:** Send an MSGin5G message delivery status report to MSGin5G
Server.
**Known Consumers:** L3G, N3G.
**Inputs:** Refer subclause 8.3.4
**Outputs:** Refer subclause 8.3.4
See subclause 8.3.4 for the details of usage of this API operation.
#### 9.1.1.5 M5S_AS_Registration API
##### 9.1.1.5.1 General
**API description:** This API enables the Application Server to register to
MSGin5G Server.
##### 9.1.1.5.2 Registration operation
**API operation name:** Registration
**Description:** Do registration or update registration to an MSGin5G Server,
by using this API, the Application Server provides/updates its information,
including the URL used for the message delivery from MSGin5G Server to
Application Server.
**Known Consumers:** Application Server
**Inputs:** Refer subclause 9.1.2.3
**Outputs:** Refer subclause 9.1.2.4
##### 9.1.1.5.3 Deregistration operation
**API operation name:** Send_MSGin5G_Message
**Description:** Do deregistration with an MSGin5G Server.
**Known Consumers:** Application Server
**Inputs:** Refer subclause 9.1.2.5
**Outputs:** Refer subclause 9.1.2.6
### 9.1.2 Mm5s Information flows
#### 9.1.2.1 M5S Application Server originating message send request
The information flows from the Application Server to the MSGin5G Server for
message delivery includes the IEs in table 8.3.2-1. Additionally, the
following information in table 9.1.2.1-2 elements needs to be included:
Table 9.1.2.1-2: M5S Northbound Message Delivery Send request
* * *
Information element Status Description Latency O The latency requirement for
the message. Authorization Information O The authorization information used to
determine whether the Application Server is allowed to send the message
* * *
#### 9.1.2.2 M5S Application Server originating message delivery status report
request
The information flows from the Application Server to the MSGin5G Server for
message delivery status report includes the IE in table 8.3.4-1, and the
following information in table 9.1.2.2-1 elements needs to be included:
Table 9.1.2.2-1: M5S Northbound Message Delivery Send request
* * *
Information element Status Description Authorization Information O The
authorization information used to determine whether the Application Server is
allowed to send the message
* * *
#### 9.1.2.3 M5S Application Server registration request
The information flows from the Application Server to the MSGin5G Server for
registration request includes the information elements in Table 9.1.2.3-1.
Table 9.1.2.3-1: Application Server Registration request
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +-----------------------------+--------+-----------------------------+ | AS service ID | M | The MSGin5G identifier of | | | | the Application Server. | | | | | | | | This ID is configured | | | | before registration. | +-----------------------------+--------+-----------------------------+ | Application ID | O | The identifier of the | | | | application specified by | | | | the application provider. | +-----------------------------+--------+-----------------------------+ | Authorization Information | O | The authorization | | | | information used to | | | | determine whether the | | | | Application Server is | | | | allowed to send the message | +-----------------------------+--------+-----------------------------+ | Security Credentials | O | Security information | | | | required for the | | | | Application Server to | | | | register to the MSGin5G | | | | Server. | +-----------------------------+--------+-----------------------------+ | Notification target URI | O | The URL for receiving | | | | message, message delivery | | | | status report, etc. The | | | | MSGin5G Server uses this | | | | URL to interact to | | | | Application Server. | +-----------------------------+--------+-----------------------------+ | Application Profile (NOTE) | O | The elements in Application | | | | Profile include the | | | | information of the | | | | Application Server, e.g. | | | | application name, | | | | application provider, | | | | application scenario | | | | description, application | | | | category, etc. | | | | | | | | This IE is used by MSGin5G | | | | Server to compare with | | | | application client | | | | information. | +-----------------------------+--------+-----------------------------+ | NOTE: The detailed | | | | definition of Application | | | | Profile is out of scope of | | | | this document. | | | +-----------------------------+--------+-----------------------------+
#### 9.1.2.4 M5S Application Server registration response
The information flows from the MSGin5G Server to the Application Server for
registration response includes the information elements in Table 9.1.2.4-1.
Table 9.1.2.4-1: Application Server registration response
* * *
Information element Status Description AS service ID M The MSGin5G identifier
of the Application Server. Registration result M Indication if the
registration is success or failure
* * *
Editor\'s note: Whether other information may be included in the Application
Server registration response is FFS.
#### 9.1.2.5 M5S Application Server de-registration request
The information flows from the Application Server to the MSGin5G Server for
de-registration request includes the information elements in Table 9.1.2.5-1.
Table 9.1.2.5-1: Application Server de-registration request
* * *
Information element Status Description AS service ID M The MSGin5G identifier
of the Application Server.
* * *
#### 9.1.2.6 M5S Application Server de-registration response
The information flows from the MSGin5G Server to the Application Server for
de-registration response includes the information elements in Table 9.1.2.6-1.
Table 9.1.2.6-1: Application Server de-registration response
* * *
Information element Status Description AS service ID M The MSGin5G identifier
of the Application Server. De-registration result M Indication if the de-
registration is success or failure
* * *
## 9.2 APIs provided by Message Gateway
### 9.2.1 Ml3g APIs
#### 9.2.1.1 L3G_Message_Delivery API
##### 9.2.1.1.1 General
**API description:** This API enables the MSGin5G Server to delivery MSGin5G
Message to the Legacy 3GPP Message Gateway.
##### 9.2.1.1.2 Send_Message operation
**API operation name:** Send_MSGin5G_Message
**Description:** Send an MSGin5G Message to Legacy 3GPP Message Gateway.
**Known Consumers:** M5S.
**Inputs:** Refer subclause 8.3.3
**Outputs:** Refer subclause 8.3.3
See subclause 8.3.3 for the details of usage of this API operation.
#### 9.2.1.2 L3G_Delivery_Status_Report API
##### 9.2.1.2.1 General
**API description:** This API enables the MSGin5G Server to delivery MSGin5G
Message to the Legacy 3GPP Message Gateway.
##### 9.2.1.2.2 Report_Message_Delivery_Status operation
**API operation name:** Report_Message_Delivery_Status
**Description:** Send an MSGin5G message delivery status report to Legacy 3GPP
Message Gateway.
**Known Consumers:** M5S.
**Inputs:** Refer subclause 8.3.5
**Outputs:** Refer subclause 8.3.5
See subclause 8.3.5 for the details of usage of this API operation.
### 9.2.2 Mn3g APIs
#### 9.2.2.1 N3G_Message_Delivery API
##### 9.2.2.1.1 General
**API description:** This API enables the MSGin5G Server to delivery MSGin5G
message to the Non-3GPP Message Gateway.
##### 9.2.2.1.2 Send_Message operation
**API operation name:** Create_MSGin5G_Message
**Description:** Send an MSGin5G message to Non-3GPP Message Gateway.
**Known Consumers:** M5S.
**Inputs:** Refer subclause 8.3.3
**Outputs:** Refer subclause 8.3.3
See subclause 8.3.3 for the details of usage of this API operation.
#### 9.2.2.2 N3G_Delivery_Status_Report API
##### 9.2.2.2.1 General
**API description:** This API enables the MSGin5G Server to delivery MSGin5G
message to the Non-3GPP Message Gateway.
##### 9.2.2.2.2 Report_Message_Delivery_Status operation
**API operation name:** Report_Message_Delivery_Status
**Description:** Send an MSGin5G message delivery status report to Non-3GPP
Message Gateway.
**Known Consumers:** M5S.
**Inputs:** Refer subclause 8.3.5
**Outputs:** Refer subclause 8.3.5
See subclause 8.3.5 for the details of usage of this API operation.
# 10 Information Elements
## 10.1 Payload
The _Payload_ Information Element carries the application payload that is
transferred by the MSGin5G Service, of which the content is transparent to the
MSGin5G Service.
If the message originates from an MSGin5G UE, the _Payload_ IE is a string of
maximum length that can be transported without segmentation but not more than
2048 octets.
## 10.2 Application ID
The _Application ID_ Information Element identifies the Application Client on
the UE or in the Application Server.
The _Application ID_ is a string, which shall allow identifying 65535
different Application Clients. The _Application ID_ is configured or
provisoned in the Application Client or the Application Server.
Editor\'s note: The number \"65535\" may be revisited in Stage 3.
## 10.3 Messaging Topic
The _Messaging Topic_ Information Element indicates the topic of the message,
which an interested UE or Application Server can subscribe to.
1\. The _Messaging Topic_ IE is a string, which shall allow identiying 65535
different Messaging Topics. Allocating and populating the _Messaging Topic_ IE
is done by the Application Client or the Application Server.
Editor\'s note: The number \"65535\" may be revisited in Stage 3.
## 10.4 Broadcast Area ID
The _Broadcast Area ID_ Information Element identifies the service area where
the Broadcast Message will be delivered.
The _Broadcast Area ID_ IE is a string, which shall allow identiying 65535
different Broadcast Areas. The _Broadcast Area ID_ is provisoned on the
Application Client or the Application Server and is mapped by the Legacy 3GPP
Message Gateway onto the Broadcast Area as used by the broadcast service in
the 5GC.
Editor\'s note: The number \"65535\" may be revisited in Stage 3.
Editor\'s note: For broadcast messaging, whether the Legacy 3GPP Message
Gateway is enough and technically right for broadcasting message to all UEs is
FFS.
## 10.5 Message ID
The _Message ID_ Information Element uniquely identifies a specific MSGin5G
message in the MSGin5G Service. If message delivery status report is requested
by an MSGin5G message, the Message ID IE in this MSGin5G message is used by
the sender of the MSGin5G message to match the message delivery status report
with the original MSGin5G message. It is also used by the MSGin5G Server in
aggregating the message delivery status report message delivery status
reports.
The _Message ID_ is globally unique within the MSGin5G Service and is
generated by the sender of a new message.
## 10.6 Failure Cause
The Failure Cause Information Element indicates the the failure reason of an
MSGin5G message, if this MSGin5G message can not be delivered successfully.
The Failure Cause IE is a string, which shall allow identiying 65535 different
failure reasons.
Editor\'s note: The number \"65535\" may be revisited in Stage 3.
# Annex A (informative): Change history
+-------+-------+-------+-------+-------+-------+-------+-------+ | **C | | | | | | | | | hange | | | | | | | | | hist | | | | | | | | | ory** | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | **D | * |** T | * | ** | ** | **Su |** New | | ate**| *Meet | Doc** | _CR_ _| Rev_ _| Cat_ _| bject | vers | | | ing_ _| | | | | /Comm | ion_ _| | | | | | | | ent_ * | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA6\ | | | | | TR | 0.0.0 | | 20-11 | #40-e | | | | | ske | | | | | | | | | leton | | | | | | | | | a | | | | | | | | | greed | | | | | | | | | in | | | | | | | | | SA6 | | | | | | | | | #40: | | | | | | | | | S6-2 | | | | | | | | | 02295 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA6\ | | | | | I | 0.1.0 | | 21-01 | #41-e | | | | | mplem | | | | | | | | | ented | | | | | | | | | pCRs | | | | | | | | | app | | | | | | | | | roved | | | | | | | | | in | | | | | | | | | SA6# | | | | | | | | | 41-e: | | | | | | | | | S6-2 | | | | | | | | | 10363 | | | | | | | | | | | | | | | | | | Edit | | | | | | | | | orial | | | | | | | | | ch | | | | | | | | | anges | | | | | | | | | by | | | | | | | | | the | | | | | | | | | rappo | | | | | | | | | rteur | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA6\ | | | | | I | 0.2.0 | | 21-03 | #42-e | | | | | mplem | | | | | | | | | ented | | | | | | | | | pCRs | | | | | | | | | app | | | | | | | | | roved | | | | | | | | | in | | | | | | | | | SA6# | | | | | | | | | 42-e: | | | | | | | | | S6-21 | | | | | | | | | 0615, | | | | | | | | | S6-21 | | | | | | | | | 0588, | | | | | | | | | S6-21 | | | | | | | | | 0597, | | | | | | | | | S6-2 | | | | | | | | | 10720 | | | | | | | | | | | | | | | | | | Edit | | | | | | | | | orial | | | | | | | | | ch | | | | | | | | | anges | | | | | | | | | by | | | | | | | | | the | | | | | | | | | rappo | | | | | | | | | rteur | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA | | | | | I | 0.3.0 | | 21-04 | 6#42 | | | | | mplem | | | | BIS-e | | | | | ented | | | | | | | | | pCRs | | | | | | | | | app | | | | | | | | | roved | | | | | | | | | in | | | | | | | | | SA | | | | | | | | | 6#42 | | | | | | | | | B | | | | | | | | | IS-e: | | | | | | | | | S6-21 | | | | | | | | | 0827, | | | | | | | | | S6-21 | | | | | | | | | 1087, | | | | | | | | | S6-21 | | | | | | | | | 1088, | | | | | | | | | S6-21 | | | | | | | | | 0989, | | | | | | | | | S6-21 | | | | | | | | | 1089, | | | | | | | | | S6-21 | | | | | | | | | 1090, | | | | | | | | | S6-21 | | | | | | | | | 1091, | | | | | | | | | S6-21 | | | | | | | | | 1092, | | | | | | | | | S6-21 | | | | | | | | | 1093, | | | | | | | | | S6-21 | | | | | | | | | 1094, | | | | | | | | | S6-21 | | | | | | | | | 1095, | | | | | | | | | S6-21 | | | | | | | | | 0988, | | | | | | | | | S6-21 | | | | | | | | | 0969, | | | | | | | | | S6-21 | | | | | | | | | 1071, | | | | | | | | | S6-21 | | | | | | | | | 1096, | | | | | | | | | S6-21 | | | | | | | | | 0822, | | | | | | | | | S6-21 | | | | | | | | | 1042, | | | | | | | | | S6-21 | | | | | | | | | 1043, | | | | | | | | | S6-21 | | | | | | | | | 1097, | | | | | | | | | S6-2 | | | | | | | | | 11098 | | | | | | | | | | | | | | | | | | Edit | | | | | | | | | orial | | | | | | | | | ch | | | | | | | | | anges | | | | | | | | | by | | | | | | | | | the | | | | | | | | | rappo | | | | | | | | | rteur | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA | | | | | I | 0.4.0 | | 21-06 | 6#43 | | | | | mplem | | | | -e | | | | | ented | | | | | | | | | pCRs | | | | | | | | | app | | | | | | | | | roved | | | | | | | | | in | | | | | | | | | SA6# | | | | | | | | | 43-e: | | | | | | | | | S6-21 | | | | | | | | | 1135, | | | | | | | | | S6-21 | | | | | | | | | 1136, | | | | | | | | | S6-21 | | | | | | | | | 1367, | | | | | | | | | S6-21 | | | | | | | | | 1337, | | | | | | | | | S6-21 | | | | | | | | | 1232, | | | | | | | | | S6-21 | | | | | | | | | 1338, | | | | | | | | | S6-21 | | | | | | | | | 1230, | | | | | | | | | S6-21 | | | | | | | | | 1342, | | | | | | | | | S6-21 | | | | | | | | | 1339, | | | | | | | | | S6-21 | | | | | | | | | 1340, | | | | | | | | | S6-21 | | | | | | | | | 1341, | | | | | | | | | S6-21 | | | | | | | | | 1399, | | | | | | | | | S6-21 | | | | | | | | | 1400, | | | | | | | | | S6-21 | | | | | | | | | 1349, | | | | | | | | | S6-21 | | | | | | | | | 1490, | | | | | | | | | S6-21 | | | | | | | | | 1169, | | | | | | | | | S6-21 | | | | | | | | | 1343, | | | | | | | | | S6-21 | | | | | | | | | 1344, | | | | | | | | | S6-21 | | | | | | | | | 1430, | | | | | | | | | S6-2 | | | | | | | | | 11355 | | | | | | | | | | | | | | | | | | Edit | | | | | | | | | orial | | | | | | | | | ch | | | | | | | | | anges | | | | | | | | | by | | | | | | | | | the | | | | | | | | | rappo | | | | | | | | | rteur | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | S | SP-2 | | | | Pr | 1.0.0 | | 21-06 | A#92 | 10474 | | | | esent | | | | -e | | | | | ation | | | | | | | | | for | | | | | | | | | i | | | | | | | | | nform | | | | | | | | | ation | | | | | | | | | at | | | | | | | | | SA\ | | | | | | | | | #92-e | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA6\ | | | | | I | 1.1.0 | | 21-07 | #44-e | | | | | mplem | | | | | | | | | ented | | | | | | | | | pCRs | | | | | | | | | app | | | | | | | | | roved | | | | | | | | | in | | | | | | | | | SA6# | | | | | | | | | 44-e: | | | | | | | | | S6-21 | | | | | | | | | 1527, | | | | | | | | | S6-21 | | | | | | | | | 1722, | | | | | | | | | S6-21 | | | | | | | | | 1723, | | | | | | | | | S6-21 | | | | | | | | | 1726, | | | | | | | | | S6-21 | | | | | | | | | 1727, | | | | | | | | | S6-21 | | | | | | | | | 1724, | | | | | | | | | S6-21 | | | | | | | | | 1841, | | | | | | | | | S6-21 | | | | | | | | | 1774, | | | | | | | | | S6-21 | | | | | | | | | 1775, | | | | | | | | | S6-21 | | | | | | | | | 1776, | | | | | | | | | S6-21 | | | | | | | | | 1777, | | | | | | | | | S6-21 | | | | | | | | | 1780, | | | | | | | | | S6-21 | | | | | | | | | 1779, | | | | | | | | | S6-21 | | | | | | | | | 1781, | | | | | | | | | S6-21 | | | | | | | | | 1592, | | | | | | | | | S6-21 | | | | | | | | | 1842, | | | | | | | | | S6-21 | | | | | | | | | 1628, | | | | | | | | | S6-21 | | | | | | | | | 1629, | | | | | | | | | S6-21 | | | | | | | | | 1843, | | | | | | | | | S6-21 | | | | | | | | | 1844, | | | | | | | | | S6-2 | | | | | | | | | 11713 | | | | | | | | | | | | | | | | | | Edit | | | | | | | | | orial | | | | | | | | | ch | | | | | | | | | anges | | | | | | | | | by | | | | | | | | | the | | | | | | | | | rappo | | | | | | | | | rteur | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA6\ | | | | | I | 1.2.0 | | 21-09 | #45-e | | | | | mplem | | | | | | | | | ented | | | | | | | | | pCRs | | | | | | | | | app | | | | | | | | | roved | | | | | | | | | in | | | | | | | | | SA6# | | | | | | | | | 45-e: | | | | | | | | | S6-21 | | | | | | | | | 2164, | | | | | | | | | S6-21 | | | | | | | | | 2153, | | | | | | | | | S6-21 | | | | | | | | | 2084, | | | | | | | | | S6-21 | | | | | | | | | 2089, | | | | | | | | | S6-21 | | | | | | | | | 1944, | | | | | | | | | S6-21 | | | | | | | | | 2154, | | | | | | | | | S6-21 | | | | | | | | | 2105, | | | | | | | | | S6-21 | | | | | | | | | 1954, | | | | | | | | | S6-21 | | | | | | | | | 1955, | | | | | | | | | S6-21 | | | | | | | | | 2155, | | | | | | | | | S6-21 | | | | | | | | | 1957, | | | | | | | | | S6-21 | | | | | | | | | 1959, | | | | | | | | | S6-21 | | | | | | | | | 2156, | | | | | | | | | S6-2 | | | | | | | | | 12177 | | | | | | | | | | | | | | | | | | Edit | | | | | | | | | orial | | | | | | | | | ch | | | | | | | | | anges | | | | | | | | | by | | | | | | | | | the | | | | | | | | | rappo | | | | | | | | | rteur | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | | | | Pr | 2.0.0 | | 21-09 | #93-e | 10947 | | | | esent | | | | | | | | | ation | | | | | | | | | for | | | | | | | | | app | | | | | | | | | roval | | | | | | | | | at | | | | | | | | | SA\ | | | | | | | | | #93-e | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | | | | MCC | 1 | | 21-09 | #93-e | 10947 | | | | Edit | 7.0.0 | | | | | | | | orial | | | | | | | | | u | | | | | | | | | pdate | | | | | | | | | for | | | | | | | | | p | | | | | | | | | ublic | | | | | | | | | ation | | | | | | | | | after | | | | | | | | | TSG | | | | | | | | | SA | | | | | | | | | app | | | | | | | | | roval | | | | | | | | | (SA | | | | | | | | | #93) | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | | | | | | Edit | 1 | | 21-09 | | | | | | orial | 7.0.1 | | | | | | | | c | | | | | | | | | orrec | | | | | | | | | tions | | | | | | | | | as | | | | | | | | | a | | | | | | | | | greed | | | | | | | | | by | | | | | | | | | SA6 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0001 | 1 | F | R | 1 | | 21-12 | #94-e | 11521 | | | | emove | 7.1.0 | | | | | | | | ENs | | | | | | | | | with | | | | | | | | | no | | | | | | | | | ac | | | | | | | | | tions | | | | | | | | | in | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 5 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0002 | 1 | F | C | 1 | | 21-12 | #94-e | 11521 | | | | orrec | 7.1.0 | | | | | | | | tions | | | | | | | | | in | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 7 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0004 | 2 | F | Add | 1 | | 21-12 | #94-e | 11521 | | | | defin | 7.1.0 | | | | | | | | ition | | | | | | | | | of | | | | | | | | | MS | | | | | | | | | Gin5G | | | | | | | | | S | | | | | | | | | erver | | | | | | | | | ad | | | | | | | | | dress | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0005 | 1 | F | Corre | 1 | | 21-12 | #94-e | 11521 | | | | ction | 7.1.0 | | | | | | | | on | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 5. | | | | | | | | | 3.2.2 | | | | | | | | | t | | | | | | | | | arget | | | | | | | | | resol | | | | | | | | | ution | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0006 | 1 | F | Corre | 1 | | 21-12 | #94-e | 11521 | | | | ction | 7.1.0 | | | | | | | | on | | | | | | | | | me | | | | | | | | | ssage | | | | | | | | | del | | | | | | | | | ivery | | | | | | | | | proc | | | | | | | | | edure | | | | | | | | | to | | | | | | | | | Me | | | | | | | | | ssage | | | | | | | | | Ga | | | | | | | | | teway | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0007 | 1 | D | Edit | 1 | | 21-12 | #94-e | 11521 | | | | orial | 7.1.0 | | | | | | | | of | | | | | | | | | MS | | | | | | | | | Gin5G | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0008 | 1 | F | R | 1 | | 21-12 | #94-e | 11521 | | | | emove | 7.1.0 | | | | | | | | API | | | | | | | | | Re | | | | | | | | | lated | | | | | | | | | EN | | | | | | | | | and | | | | | | | | | m | | | | | | | | | odify | | | | | | | | | F | | | | | | | | | igure | | | | | | | | | 8. | | | | | | | | | 3.5-2 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0010 | 1 | F | Corre | 1 | | 21-12 | #94-e | 11521 | | | | ction | 7.1.0 | | | | | | | | on | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 8.3.3 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0011 | 1 | F | Corre | 1 | | 21-12 | #94-e | 11521 | | | | ction | 7.1.0 | | | | | | | | on | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 8.7.5 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0012 | 2 | F | 5G | 1 | | 21-12 | #94-e | 11521 | | | | MARCH | 7.1.0 | | | | | | | | store | | | | | | | | | and | | | | | | | | | fo | | | | | | | | | rward | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0014 | 1 | B | Me | 1 | | 21-12 | #94-e | 11521 | | | | ssage | 7.1.0 | | | | | | | | topic | | | | | | | | | unsu | | | | | | | | | bscri | | | | | | | | | ption | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0015 | 1 | F | Edi | 1 | | 21-12 | #94-e | 11521 | | | | toral | 7.1.0 | | | | | | | | corre | | | | | | | | | ction | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0016 | | F | C | 1 | | 21-12 | #94-e | 11521 | | | | orrec | 7.1.0 | | | | | | | | tions | | | | | | | | | on | | | | | | | | | broa | | | | | | | | | dcast | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0017 | | F | Alig | 1 | | 21-12 | #94-e | 11521 | | | | nment | 7.1.0 | | | | | | | | on | | | | | | | | | Me | | | | | | | | | ssage | | | | | | | | | Ga | | | | | | | | | teway | | | | | | | | | IE | | | | | | | | | name | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0018 | 1 | F | R | 1 | | 21-12 | #94-e | 11521 | | | | emove | 7.1.0 | | | | | | | | one | | | | | | | | | IE | | | | | | | | | from | | | | | | | | | AS | | | | | | | | | o | | | | | | | | | rigin | | | | | | | | | ating | | | | | | | | | me | | | | | | | | | ssage | | | | | | | | | send | | | | | | | | | re | | | | | | | | | quest | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0019 | 1 | F | Corre | 1 | | 21-12 | #94-e | 11521 | | | | ction | 7.1.0 | | | | | | | | on | | | | | | | | | Me | | | | | | | | | ssage | | | | | | | | | A | | | | | | | | | ggreg | | | | | | | | | ation | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0020 | 1 | F | Sec | 1 | | 21-12 | #94-e | 11521 | | | | urity | 7.1.0 | | | | | | | | a | | | | | | | | | spect | | | | | | | | | of | | | | | | | | | MS | | | | | | | | | Gin5G | | | | | | | | | align | | | | | | | | | with | | | | | | | | | SA3 | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0021 | 2 | F | Corre | 1 | | 22-03 | #95-e | 20105 | | | | ction | 7.2.0 | | | | | | | | on | | | | | | | | | Me | | | | | | | | | ssage | | | | | | | | | Se | | | | | | | | | gment | | | | | | | | | Rec | | | | | | | | | overy | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0022 | 2 | F | Corre | 1 | | 22-03 | #95-e | 20105 | | | | ction | 7.2.0 | | | | | | | | on | | | | | | | | | Poin | | | | | | | | | t-to- | | | | | | | | | Point | | | | | | | | | Me | | | | | | | | | ssage | | | | | | | | | Se | | | | | | | | | gment | | | | | | | | | ation | | | | | | | | | and | | | | | | | | | Reass | | | | | | | | | embly | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0023 | 1 | F | Corre | 1 | | 22-03 | #95-e | 20105 | | | | ction | 7.2.0 | | | | | | | | on | | | | | | | | | Usage | | | | | | | | | of | | | | | | | | | Ne | | | | | | | | | twork | | | | | | | | | Ca | | | | | | | | | pabil | | | | | | | | | ities | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0024 | 1 | F | Edi | 1 | | 22-03 | #95-e | 20105 | | | | toral | 7.2.0 | | | | | | | | c | | | | | | | | | orrec | | | | | | | | | tions | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0026 | 2 | F | Cla | 1 | | 22-03 | #95-e | 20105 | | | | rific | 7.2.0 | | | | | | | | ation | | | | | | | | | on | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 5.3.3 | | | | | | | | | funct | | | | | | | | | ional | | | | | | | | | e | | | | | | | | | ntity | | | | | | | | | of | | | | | | | | | MS | | | | | | | | | Gin5G | | | | | | | | | C | | | | | | | | | lient | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0027 | 2 | F | Cla | 1 | | 22-03 | #95-e | 20105 | | | | rific | 7.2.0 | | | | | | | | ation | | | | | | | | | and | | | | | | | | | corre | | | | | | | | | ction | | | | | | | | | on | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 8.8 | | | | | | | | | Other | | | | | | | | | MS | | | | | | | | | Gin5G | | | | | | | | | mess | | | | | | | | | aging | | | | | | | | | re | | | | | | | | | lated | | | | | | | | | proce | | | | | | | | | dures | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0028 | 2 | F | Cla | 1 | | 22-03 | #95-e | 20105 | | | | rific | 7.2.0 | | | | | | | | ation | | | | | | | | | and | | | | | | | | | corre | | | | | | | | | ction | | | | | | | | | on | | | | | | | | | c | | | | | | | | | lause | | | | | | | | | 8.11 | | | | | | | | | C | | | | | | | | | onstr | | | | | | | | | ained | | | | | | | | | de | | | | | | | | | vices | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | SA\ | SP-2 | 0029 | 1 | F | D | 1 | | 22-03 | #95-e | 20105 | | | | efini | 7.2.0 | | | | | | | | tions | | | | | | | | | of | | | | | | | | | Ga | | | | | | | | | teway | | | | | | | | | UE | |