# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
**The aim of this Technical Report is to study and specify potential**
enhancements to the IMS architecture to enable IMS FE to integrate with the
5GC network functions to enable IMS applications to directly leverage the
features and capabilities of 5GC.
The specific capabilities of 5GC included in this study:
\- How can IMS utilize services provided by 5GC NFs other than PCF, such as
HSS/UDM and AMF.
\- How can localized routing of IMS media and signalling traffic be leveraged.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[3] 3GPP TS 29.562: \"Home Subscriber Server (HSS) Services for interworking
with the IP Multimedia Subsystem (IMS); Stage 3\".
[4] 3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5GC 5G Core Network
AMF Access and Mobility Management Function
# 4 Architecture Assumptions
# 5 Key Issues
## 5.1 Key issue #1: Routing of IMS traffic via a localized UPF
### 5.1.1 Description
The 5GC enables traffic to route via localized UPF close to the edge of the
network (in some cases adjacent to the RAN nodes). Some IMS services may be
able to benefit from the lower latency and/or lower backhaul requirements that
such deployments can enable, however current IMS applications and services are
not able to leverage these capabilities. This key issue investigates the
interactions required to leverage localized routing of IMS media and
signalling traffic, the changes to enable effective control and management of
such routing, and impacts of mobility and roaming.
### 5.1.2 Requirements
The existing 5GC and IMS architecture does not specifically support having
user plane and IMS media plane entities in the same location and hence user
plane path handling is not optimized. To optimise the user plane path, a
location of the MGCF and MRF close to the actual UPF (that the user plane
needs to traverse) is desirable. For instance, UPF and MGCF could be located
in the same data centre.
When selecting an MGCF or MRF, IMS nodes shall be enabled to base this
selection on the actually used UPF. The solutions to this key issue may take
additional IMS nods (e.g. IMS-AGW, ATGW and TrGW) into account.
## 5.2 Key issue #2: How can IMS utilize services provided by 5GC NFs other
than PCF
### 5.2.1 Description
All of the 5GC control plane NFs are specified as service based and any NF can
be consumer of the services provided by other NFs, if supported by the
procedures.
### 5.2.2 Requirements
This key issue addresses IMS and 5GC service interfaces aspects on:
\- How IMS can utilize services provided by 5GC NFs other than PCF.
\- How to determine the UE location in IMS entities with service operations
(e.g. determination of the visited PLMN ID in case of Home-Routed VoLTE
roaming).
# 6 Solutions
## 6.1 Solution #1: Conveying UPF FQDN to IMS nodes
### 6.1.1 Description
This is a solution to key issue #1.
This solution proposes to convey the UPF FQDN or a more generic information
like \"user-plane-locality\" or \"voice-media-locality\" for the IMS PDU
session from SMF to UDM during SMF registration. The UDM stores the IMS PDU
session\'s UPF FQDN (or \"user-plane-locality\" or voice-media-locality\") in
the UDR as part of the SMF registration. The HSS retrieves the IMS PDU
session\'s UPF FQDN (or \"user-plane-locality\" or voice-media-locality\")
from the UDR and forwards it to the S-CSCF via Cx (or Nhss-ims) when an S-CSCF
registers. When performing call setup procedure, the S-CSCF on the MO side
convey the UPF FQDN (or \"user-plane-locality\" or voice-media-locality\") of
the MO UE to the BGCF via SIP messages.
When the BGCF determines that selection of an MGCF close to the actual UPF is
required, it makes use of the conveyed UPF FQDN (or \"user-plane-locality\" or
voice-media-locality\") and maps it based on a locally configured mapping
table or using discovery via NRF (see solution#5) to the optimal MGCF.
When the IMS-AS determines that selection of an MGCF or MRF close to the
actual UPF is required, it retrieves the UPF FQDN (or \"user-plane-locality\"
or voice-media-locality\") via HSS from the UDR and selects (based on a
locally configured mapping table or using discovery via NRF (see solution#5))
the optimal MRF for the actual UPF.
### 6.1.2 Impacts on existing nodes and functions
#### 6.1.2.1 SMF
When the SMF makes use of the Nudm_UECM_registration service operation to
register for the IMS PDU session at the UDM, it needs to convey the actual UPF
FQDN (or \"user-plane-locality\" or voice-media-locality\") to the UDM.
#### 6.1.2.2 UDM
When the UDM receives the actual UPF FQDN (or \"user-plane-locality\" or
voice-media-locality\") within the Nudm_UECM_registration service operation,
it needs to store the UPF FQDN (or \"user-plane-locality\" or voice-media-
locality\") as part of the SmfRegistration in the UDR.
#### 6.1.2.3 UDR
When the UDM makes use of the Nudr_DR_Create service operation to store the
SMF registration for the IMS PDU session, it needs to store the received UPF
FQDN (or \"user-plane-locality\" or voice-media-locality\").
When the HSS makes use of the Nudr_DR_Query service operation to retrieve SMF
registration for the IMS PDU session, the UDR needs to respond with the
SmfRegistration including the stored UPF FQDN (or \"user-plane-locality\" or
voice-media-locality\").
#### 6.1.2.4 HSS
When the HSS receives a registration request from the S-CSCF or a request from
the IMS-AS to provide the UPF FQDN (or \"user-plane-locality\" or voice-media-
locality\"), in needs to make use of the Nudr_DR_Query service operation to
retrieve the UPF FQDN (or \"user-plane-locality\" or voice-media-locality\")
from the UDR as part of the SmfRegistration for the IMS PDU session, and
return the retrieved UPF FQDN (or \"user-plane-locality\" or voice-media-
locality\") to the IMS-AS or S-CSCF.
#### 6.1.2.5 S-CSCF
The S-CSCF on the MO side forwards the received UPF FQDN (or \"user-plane-
locality\" or voice-media-locality\") to the BGCF.
#### 6.1.2.6 BGCF
When the BGCF determines that an MGCF close to the actual UPF need to be
selected, it makes use of the UPF FQDN (or \"user-plane-locality\" or voice-
media-locality\") received from the S-CSCF and maps it according to a locally
configured mapping table to an optimal MGCF.
#### 6.1.2.7 IMS-AS
When the IMS-AS determine that an MRF close to the actual UPF need to be
selected, it needs to retrieve the actual UPF FQDN (or \"user-plane-locality\"
or voice-media-locality\") for the IMS PDU session from the HSS. The IMS-AS
then makes use of the UPF FQDN (or \"user-plane-locality\" or voice-media-
locality\") and maps it according to a locally configured mapping table to an
optimal MRF.
## 6.2 Solution #2: IMS utilize services provided by AMF
### 6.2.1 Description
This solution addresses Key Issue #2: How can IMS utilize services provided by
5GC NFs other than PCF.
In IMS network, the P-CSCF needs to be notified of some events related to
access network, e.g. UE location information and other access network related
events. This information will be used in IMS network for billing, LI, service
trigger and so on. In 4G, the P-CSCF subscribes to notification of these
events over Rx interface. Since 5GC supports SBI, IMS network is able to use
the SBI provided by AMF to subscribe to notification of these events.
Figure 6.2.1-1 illustrates how IMS obtains the AMF address serving the UE
during IMS registration procedure.
Figure 6.2.1-1: IMS obtains the AMF instance ID during IMS registration
procedure
1-12. Normal IMS registration procedure.
13\. The S-CSCF requests the AMF instance ID in SAR from the HSS/UDM.
14\. The HSS/UDM sends AMF instance ID in the SAA to the S-CSCF.
15\. The S-CSCF sends the AMF instance ID to the P-CSCF in the SIP 200 OK.
16\. The P-CSCF sends SIP 200 OK to the UE as in normal IMS registration
procedure.
17\. (Option A) The P-CSCF subscribes to AMF change event from S-CSCF.
18\. (Option A) The S-CSCF responds to P-CSCF.
19\. The S-CSCF subscribes to notification of AMF change to the HSS/UDM.
20\. When the AMF changes, the HSS/UDM notifies the S-CSCF.
21a. (Option A) The S-CSCF sends SIP NOTIFY with the new AMF instance ID to
the P-CSCF.
21b. (Option B) The S-CSCF sends SIP MESSAGE with the new AMF instance ID to
the P-CSCF.
Once the IMS (P-CSCF) obtains the instance ID of the AMF serving the UE, the
IMS (P-CSCF) can subscribe to notification of the events supported by AMF e.g.
events related to UE location information and access network information.
Before the IMS (P-CSCF) invoking services provided by AMF, it needs to query
NRF with the received AMF instance ID to get the AMF endpoints to which it can
invoke service request.
Figure 6.2.1-2 illustrates the P-CSCF utilizes services provides by AMF to
subscribe to notification of the UE location information.
Figure 6.2.1-2: P-CSCF utilizes Services provided by AMF to subscribe to
notification of the UE location information
1\. The P-CSCF receives the SIP INVITE message.
2\. The P-CSCF queries NRF with previously received AMF instance ID, to get
the AMF profile.
3\. The NRF responds to P-CSCF with the AMF profile.
4\. The P-CSCF invokes Namf_EventExposure_Subscribe service operation, based
on the AMF profile received in step 3, for event subscription to UE location
changes.
NOTE: The Namf_EventExposure service allows one time reporting, i.e. the
subscription to notification is only for one time reporting.
5\. When the UE location changes, the AMF invokes Namf_EventExposure_Notify to
notify the P-CSCF of the UE location.
When the UE moves from the old AMF to the new AMF, the S-CSCF receives
notification from the UDM/HSS, and the S-CSCF notifies the P-CSCF of the new
AMF address. The P-CSCF invokes Namf_EventExposure_UnSubscribe service
operation on the old AMF to unsubscribe the event notification and invokes
Namf_EventExposure_Subscribe service operation on the new AMF service as
defined in clause 5.2.2 of the TS 23.502 [2].
If there are two AMFs serving a single UE for 3GPP access and non 3GPP access
respectively, the AMF for 3GPP access should be used.
### 6.2.2 Impacts on existing nodes and functions
#### 6.2.2.1 HSS
Nhss services specified in 3GPP TS 29.562 [3] needs to be enhanced to:
\- Retrieve AMF instance ID; and
\- subscribe and notify AMF instance ID change event.
#### 6.2.2.2 CSCF
P-CSCF needs to:
\- subscribe AMF instance ID change event from S-CSCF; and
\- utilize services provides by AMF to subscribe to notification of UE
location information.
S-CSCF needs to:
\- Retrieve AMF instance ID from HSS; and
\- subscribe and notify AMF instance ID change event from HSS.
### 6.2.3 Solution Evaluation
The solution enables IMS network to use the SBI provided by AMF to subscribe
to notification of events related to access network, e.g. UE location
information and other access network related events. In figure 6.2.1-1, Option
A is better than Option B as Option A provides more flexibility.
## 6.3 Solution #3: P-CSCF directly communicates UDM
### 6.3.1 Description
This solution addresses Key Issue #2: How can IMS utilize services provided by
5GC NFs other than PCF. This solution differs from solution #2 mainly on how
the P-CSCF gets the serving AMF of the UE.
This solution proposes P-CSCF directly communicates with UDM to get the
necessary information, the procedure is shown in Figure 6.3.1-1.
Figure 6.3.1-1: P-CSCF directly communicates with UDM
1\. The P-CSCF invoke Nnrf_NFDiscovery service towards a preconfigured NRF to
get the UDM which can serve the UE, in the service request the P-CSCF include
the SUPI or GPSI of the UE as query. The P-CSCF derives the SUPI or GPSI from
the IMPI or IMPU of the UE.
2\. The NRF responds to P-CSCF with the profile of the UDM which can serve the
UE.
3\. The P-CSCF may invoke Nudm_UECM service towards the UDM to get the context
information of the UE.
4\. The P-CSCF may invoke Nudm_SDM service towards the UDM to get the
subscription information of the UE.
5\. The P-CSCF may invoke Nudm_EventExposure service towards the UDM to
subscribe events of interest.
### 6.3.2 Impacts on existing nodes and functions
#### 6.3.2.1 P-CSCF
P-CSCF shall be able to invoke services provided by NRF and UDM.
### 6.3.3 Solution Evaluation
See clause 7.2.
## 6.4 Solution #4: Conveying UPF service area to IMS nodes via PCF N5
### 6.4.1 Description
This is a solution to key issue #1.
This solution proposes to convey the UPF service area for the IMS PDU session
from SMF to PCF and on to P-CSCF during multimedia session establishment. The
PCF either stores the UPF service area as part of the SM policy or fetches the
UPF service area from the SMF when requested by P-CSCF. PCF may also subscribe
to a new event \"UPF service area change\" upon establishment of the SM policy
association.
When the P-CSCF receives a multimedia session request, it fetches the UPF
service area (and possibly network provided location information, see Annex
B.8 in 3GPP TS 29.514 [4]) and selects (based on a locally configured mapping
from UPF service area) the optimal MGW (e.g. ATGW) for the actual UPF service
area.
The P-CSCF forwards the UPF service area retrieved from PCF in the SIP request
(e.g. as part of the PANI header). Other IMS functions (e.g. MGCF, IMS-AS) may
use the information to select, e.g. optimal IM-MGW, MRF.
Figure 6.4.1-1 illustrates how IMS obtains the UPF service area at multimedia
session establishment.
Figure 6.4.1-1: IMS obtains the UPF service area
1\. P-CSCF receives an initial session request.
2\. Based on local policy, P-CSCF requests the current UPF service area
(possibly with NPLI) via Npcf_PolicyAuthorization_Create.
3\. Either UPF service area is available at PCF (e.g. SMF included the
information based on local policy at Npcf_SMPolicyControl_Create) or PCF
requests the information from SMF (Npcf_SMPolicyControl_UpdateNotify).
4\. PCF returns the UPF service area (possibly with NPLI, if requested
previously).
5\. Based on current UPF service area, P-CSCF selects an optimal MGW/ATGW,
using local configuration.
6\. P-CSCF invokes Npcf_PolicyAuthorization_Update service operation to
provide the IP address used for the session on the selected MGW/ATGW.
7\. PCF responds to the Npcf_PolicyAuthorization_Update request.
8\. Before forwarding the SIP request, P-CSCF includes the UPF service area
(e.g. in SIP PANI header) so that IMS nodes (e.g. IMS-AS) may use it to assist
a media plane function (e.g. MRF).
### 6.4.2 Impacts on existing nodes and functions
#### 6.4.2.1 SMF
When the SMF makes use of the Npcf_SMPolicyControl service, it may send (based
on local policy) the UPF service area (serving scope) as received from NRF
during UPF NF discovery.
#### 6.4.2.2 PCF
When the PCF receives the Npcf_SMPolicyAuthorization service operation, it may
request SMF (based on local policy) to be notified about UPF service area
change.
#### 6.4.2.3 P-CSCF
When the P-CSCF receives the initial SIP request for a multimedia session, it
makes use of the Npcf_PolicyAuthorization_Create (based on local policy) to
retrieve the UPF service area. The P-CSCF uses the information to select the
optimal MGW and include the information in the SIP request before forwarding
the request to S-CSCF.
The P-CSCF may also create a new Individual Application Session Context with
the PCF for the AF signalling using the Npcf_PolicyAuthorization_Create
service operation in order to subscribe to UPF (service area) changes so that,
at call establishment, the current UPF information is already known to P-CSCF
and PCF interaction is skipped (avoiding latency increase).
NOTE 1: The P-CSCF can already create an Individual Application Session
Context in order be notified about Signalling path status. If so, the UPF
information can additionally be requested as part of the same Application
Session Context.
#### 6.4.2.4 IMS-AS
When the IMS-AS selects an MRF, it may make use of the UPF service area
received in the SIP request.
#### 6.4.2.5 MGCF
When the MGCF selects an IM-MGW, it may make use of the UPF service area
received in the SIP request.
#### 6.4.2.6 BGCF
When the BGCF selects an MGCF, it may make use of the UPF service area
received in the SIP request.
## 6.5 Solution #5: Discovery of NFs from IMS nodes
### 6.5.1 Description
This is a solution to key issue #2.
The NRF can be provisioned (e.g. via O&M) with new types of NF profiles (e.g.
NF types ATGW, IM-MGW, MRF) so that SBI capable P-CSCFs, IMS-ASs, etc. can
discover MGWs, MRFs, etc. Such NF profile(s) may contain information about
codecs supported, transcoding support, service area (serving scope), etc.
without the need of configuring, e.g. ATGWs per UPF service area and the
related information on each and every P-CSCF, IMS-AS, MGCF, etc. instance in
the network.
Figure 6.5.1-1 illustrates how IMS nodes discover ATGW, IM-MGW, MRF.
Figure 6.5.1-1: IMS nodes discover ATGW, IM-MGW, MRF
1\. IMS node receiving the UPF information (e.g. P-CSCF, IMS-AS) discovers the
media plane IMS NF (e.g. ATGW, MRF) with the required parameters (e.g. UPF
service area, codecs required to be supported)
2\. NRF returns the matching NF profiles.
### 6.5.2 Impacts on existing nodes and functions
#### 6.5.2.1 IMS-AS
The IMS-AS discovers and selects an MRF, making use of the UPF service area
received in the SIP request.
#### 6.5.2.2 MGCF
The MGCF discovers and selects an IM-MGW, making use of the UPF service area
received in the SIP request.
#### 6.5.2.3 NRF
New type(s) of NF(s) are defined (e.g. ATGW), with the associated information
(e.g. codecs supported, UPF service area) so that they can be discovered by
IMS nodes.
## 6.6 Solution #6: P-CSCF discovery support with one slice connecting to
multiple IMS network
### 6.6.1 Description
#### 6.6.1.1 General
This solution addresses scenario 3 of Key Issue #1 Network Slicing and IMS to
support P-CSCF discovery for one slice connecting to different IMS network of
TR 23.700-10.
In scenario 3 of KI#1 in TR 23.700-10, different UEs may be connected to their
home IMS networks via the same single slice instance, which means the P-CSCF
discovery mechanism needs the same SMF to return different P-CSCFs addresses
to UEs belonging to different home IMS network.
To fulfil the requirement above, home network domain name of the UE home IMS
network is taken into account when the SMF discovers P-CSCF. The SMF can be
configured with P-CSCF addresses based on home network domain name
granularity, or SMF includes home network domain name when querying NRF for
P-CSCF instance. The SMF returns P-CSCF addresses to the UE accordingly.
The home network domain name is retrieved from the UDM. The home network
domain name is subscribed and stored as part of Subscriber Data in UDM, which
is retrieved by SMF during PDU session establishment procedure by invoking
Nudm_SDM_Get service operation.
NOTE: this solution can not apply when the UE has subscriptions to multiple
IMS networks.
#### 6.6.1.2 Procedures
##### 6.6.1.2.1 Procedure with home network domain name retrieved from the UDM
The following flow describes the procedure for P-CSCF discovery when home
network domain name is retrieved from the UDM.
Figure 6.6.1.2.1-1: P-CSCF discovery with home network domain name retrieved
from the UDM
1\. The UE initiates PDU session establishment procedure to create a PDU
session for IMS by sending PDU SESSION ESTABLISHMENT REQUEST.
2\. The AMF selects SMF.
3\. The SMF invokes Nsmf_PDUSession_CreateSMContext service operation to
create a PDU session for IMS.
4a. The SMF retrieves session management subscription data from the UDM.
4b. The home network domain name is provided as part of the subscription data.
5a. The SMF may discover P-CSCF locally if the SMF is configured with P-CSCF
addresses based on home network domain name granularity.
5b. The SMF may discover P-CSCF via NRF by including home network domain name
when invoking Nnrf_NFDiscovery service operation.
6\. The SMF returns the discovered P-CSCF address to the UE following existing
procedure.
### 6.6.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
Session management subscription data is extended to include IMS home network
domain name.
SMF supports retrieval of IMS home network domain name from the session
management subscription data.
SMF and NRF supports discovery of P-CSCF taking into account home network
domain name when invoking Nnrf_NFDiscovery service operation.
### 6.6.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.7 Solution #7: IMS node communicating directly to UDM to fetch UPF
information
### 6.7.1 Description
This is a solution to key issue #1.
This solution is a combination of solution#1 and solution#3, as such:
\- When the SMF registers to UDM during IMS PDU session, it stores the UPF
FQDN or a more generic information like \"user-plane-locality\" or \"voice-
media-locality\" or \"service area\" in the UDM. This is as described in
clause 6.1.1.
\- When performing call setup procedure, the relevant IMS entity, i.e. IMS
node which needs to select an IMS media plane node close to the UPF serving
the UE, retrieves the UPF information directly from UDM, the procedure is
similar to that described in Figure 6.3.1-1 as such:
\- if an MRF close to UPF is to be selected, then the AS communicates with
UDM;
\- if an MGCF close to UPF is to be selected, then the BGCF communicates with
UDM;
\- if an IMS-AGW close to UPF is to be selected, then the P-CSCF communicates
with UDM;
\- if an ATGW close to UPF is to be selected, then the ATCF communicates with
UDM;
\- if an TrGW close to UPF is to be selected, then the IBCF communicates with
UDM.
### 6.7.2 Impacts on existing nodes and functions
#### 6.7.2.1 SMF
When the SMF makes use of the Nudm_UECM_registration service operation to
register for the IMS PDU session at the UDM, it needs to convey the actual UPF
FQDN (or \"user-plane-locality\" or voice-media-locality\") to the UDM.
#### 6.7.2.2 UDM
When the UDM receives the actual UPF FQDN (or \"user-plane-locality\" or
voice-media-locality\" or \"service area\") within the Nudm_UECM_registration
service operation, it needs to store the UPF FQDN (or \"user-plane-locality\"
or voice-media-locality\" or \"service area\") as part of the SmfRegistration
in the UDR.
#### 6.7.2.3 UDR
When the UDM makes use of the Nudr_DR_Create service operation to store the
SMF registration for the IMS PDU session, it needs to store the received UPF
FQDN (or \"user-plane-locality\" or voice-media-locality\" or \"service
area\").
When the HSS makes use of the Nudr_DR_Query service operation to retrieve SMF
registration for the IMS PDU session, the UDR needs to respond with the
SmfRegistration including the stored UPF FQDN (or \"user-plane-locality\" or
voice-media-locality\" or \"service area\").
#### 6.7.2.4 IMS control plane nodes
The IMS control plane nodes, which are required to select a corresponding IMS
media plane node close to the UPF serving the UE, need to be enhanced by:
\- to support invoking APIs provided by NRF and UDM;
\- to make use of the UPF FQDN (or \"user-plane-locality\" or voice-media-
locality\" or \"service area\") retrieved from the UDM and map it according to
a locally configured optimal media plane node.
# 7 Overall Evaluation
## 7.1 Evaluation of solutions addressing key issue #1
Table 7.1-1: Pros and Cons of solutions for KI#1
+-------------+--------------------------+--------------------------+ | Solution Id | Pros | Cons | +=============+==========================+==========================+ | Solution#1 | > 1\. If no NPLI is | > 1\. It impacts | | | > enabled at P-CSCF, | > multimedia control | | | > there is no latency | > plane IMS functions | | | > increased at call | > (e.g. HSS, S-CSCF) | | | > establishment, but | > which are not managing | | | > only at registration | > user plane traffic. | | | > procedure. | > | | | > | > 2\. It impacts legacy | | | > 2\. It does not impact | > diameter interfaces | | | > the PCF | > (e.g. Cx). | | | > | > | | | > 3\. It meets the | > 4\. It requires a | | | > requirements by simple | > complex configuration | | | > protocol extensions to | > since each UPF | | | > Nudm, Nudr, and | > instance added needs | | | > Nhss-ims (or Cx/Sh) | > to be configured at | | | | > each and every IMS | | | | > node, even if they | | | | > serve the same area | | | | > and they require the | | | | > same MGW involved in | | | | > the multimedia | | | | > session. | | | | > | | | | > 4\. It does not solve | | | | > the scenario of UPF | | | | > reallocation after the | | | | > IMS registration. | +-------------+--------------------------+--------------------------+ | Solution#4 | > 1\. It does not impact | > 1\. It requires | | | > multimedia control | > impacts in SBI | | | > plane IMS functions | > interfaces (N5/N7) | | | > (e.g. HSS, S-CSCF), | > | | | > but only IMS nodes | > 2\. It requires N5 | | | > managing media plane. | > interaction if the | | | > | > current UPF is | | | > 2\. It does not impact | > requested at | | | > legacy diameter | > Multimedia Session | | | > interfaces. | > establishment. This | | | > | > interaction is not | | | > 3\. It is independent | > additional if NPLI is | | | > of how many UPF | > requested. | | | > instances are added in | > | | | > the network since it | > NOTE 1: The benefits | | | > uses the UPF service | > of the N5 interaction, | | | > area (serving scope), | > even if the latency | | | > regardless of how many | > might be increased at | | | > UPF instances serve | > establishment (if no | | | > the same area. This | > NPLI is required) is | | | > result in a much | > that during the | | | > simpler configuration | > lifetime of the | | | > and maintenance in IMS | > multimedia session | | | > nodes. | > (e.g. voice call) the | | | > | > packets sent/received | | | > 4\. The media plane | > are being forwarded | | | > selection is based on | > using optimal user | | | > the current UPF when | > plane routing. | | | > the multimedia session | | | | > is established, not in | | | | > the UPF selected at | | | | > PDU session | | | | > establishment. | | | | > | | | | > 5\. It reuses existing | | | | > SBI service for IMS | | | | > AF/P-CSCF produced by | | | | > PCF in a natural way | | | | > to retrieve, in | | | | > addition to Network | | | | > Provided Location | | | | > information, the UPF | | | | > service area. | | | | > | | | | > 6\. The whole | | | | > procedure is performed | | | | > when the requesting | | | | > IMS node is going to | | | | > make use of the | | | | > information, instead | | | | > of doing in a | | | | > proactive manner and | | | | > impacting interfaces | | | | > and internal S-CSCF | | | | > registration binding | | | | > storage with | | | | > information which | | | | > might not be used and | | | | > might also be obsolete | | | | > in the case of UPF | | | | > reallocation. | | +-------------+--------------------------+--------------------------+ | Solution#7 | > 1\. It does not impact | > 1\. It requires | | | > multimedia control | > relevant IMS nodes | | | > plane IMS functions | > e.g. P-CSCF, BGCF and | | | > (e.g. HSS, S-CSCF), | > IMS-AS to support SBI. | | | > but only IMS nodes | > | | | > managing media plane. | > 2\. It does not solve | | | > | > the scenario of UPF | | | > 2\. It does not impact | > reallocation after the | | | > legacy diameter | > IMS registration. | | | > interfaces. | | | | > | | | | > 3\. It does not impact | | | | > the PCF. | | | | > | | | | > 4\. It does not | | | | > coupled with the IMS | | | | > session establishment | | | | > procedure. | | | | > | | | | > 5\. It is independent | | | | > of how many UPF | | | | > instances are added in | | | | > the network since it | | | | > uses the UPF service | | | | > area (serving scope), | | | | > regardless of how many | | | | > UPF instances serve | | | | > the same area. This | | | | > result in a much | | | | > simpler configuration | | | | > and maintenance in IMS | | | | > nodes. | | +-------------+--------------------------+--------------------------+
## 7.2 Evaluation of Solutions addressing key issue #2
Solution #3 differs from solution #2 mainly on how P-CSCF gets the serving AMF
of the UE. P-CSCF doesn\'t directly communicate with HSS/UDM in solution #2.
It depends on S-CSCF communicating with HSS/UDM. In solution #3, P-CSCF
directly communicates with UDM by querying NRF. However, since IMS network can
still uses N5 interface in 5G, it seems that there is no much benefit for the
IMS network to use the SBI provided AMF to subscribe to notification of some
events related to access network.
Table 7.2-1: Pros and Cons of Solution #5 for Key Issue #2
+-------------+--------------------------+--------------------------+ | Solution Id | Pros | Cons | +=============+==========================+==========================+ | Solution#5 | 1. It avoids the O&M | 1. It requires IMS | | | and replications of | control plane nodes to | | | large configurations in | support NF discovery via | | | IMS nodes for user plane | NRF. | | | nodes. | | | | | 2. It adds the O&M and | | | 2. It leverages the | replications of large | | | capabilities of some IMS | configurations to NRFs. | | | nodes (e.g., P-CSCF) for | | | | NRF discovery based on | 3. It adds signalling | | | UPF/UPF service area. | load on Nnrf. | | | | | | | 3. It allows easy | | | | introduction of new user | | | | planes nodes by means of | | | | NRF notifications | | | | towards the control | | | | planes subscribing to | | | | the user plane nodes. | | +-------------+--------------------------+--------------------------+
# 8 Conclusions
## 8.1 Conclusion of Solutions for Key Issue#1
It is recommended to adopt solution#1 (Conveying UPF FQDN to IMS nodes) as
basis for normative work.
It is also proposed to take Solution#4 to normative phase, since it avoids
impacting NFs (HSS, S-CSCF) which are not related to user plane functions (see
table 7.1-1). The exchange of user plane information fits in a much more
natural manner in PCF/P-CSCF, given that these NFs are already notified about
other user plane events.
## 8.2 Conclusions Related to key issue #2
Solution #2 and solution #3 will not be pursued.
Solution#5 (IMS User-Plane nodes discovery via NRF) is considered useful, so
it is recommended to consider its adoption for normative work so that other
solutions for Key Issue #1 (e.g., Solution #1, Solution #4) can also benefit
from it.
#