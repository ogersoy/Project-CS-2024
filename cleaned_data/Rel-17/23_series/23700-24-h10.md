# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document studies solutions to satisfy the requirements for MSGin5G
Service (message service for MIoT over 5G System). This TR will study the
application architecture needed to support MSGin5G service over 5G system,
based on the stage 1 requirements specified in 3GPP TS 22.262 [2].
# 2 References {#references-1}
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.262: \"Message Service within the 5G System\".
[3] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
[4] GSMA PRD RCC.07: \"RCC.07 Rich Communication Suite 9.0 Advanced
Communications Services and Client Specification v10.0\".
[5] OMA OMA-ERELD-LightweightM2M-V1_1-20180612-C: \"Enabler Release Definition
for LightweightM2M\".
[6] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service (CBS)\".
[7] 3GPP TS 23.038: \"Alphabets and language-specific information\".
[8] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); protocol
specification\".
[9] 3GPP TS 23.434: \"Service Enabler Architecture Layer for Verticals\".
[10] 3GPP TS 23.502: \"Procedures for the 5G System\".
[11] 3GPP TS 23.040: \"Technical realization of the Short Message Service
(SMS)\".
[12] ATIS-0700008.v002: \"Cell Broadcast Entity (CBE)-to-Cell Broadcast Center
(CBC) Interface Specification\".
[13] 3GPP TS 23.222: \"Functional architecture and information flows to
support Common API Framework for 3GPP Northbound APIs; Stage 2\".
[14] 3GPP TS 23.501: \"System Architecture for the 5G System (5GS); Stage 2\".
[15] 3GPP TS 23.204: \"Support of Short Message Service (SMS) over generic
3GPP Internet Protocol (IP) access; Stage 2\".
[16] 3GPP TS 29.122: \"T8 reference point for northbound Application
Programming Interfaces (APIs)\".
[17] 3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs;
Stage 3\".
[18] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[19] 3GPP TS 23.682 \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
[20] 3GPP TS 32.290 \"Telecommunication management; Charging management; 5G
system; Services, operations and procedures of charging using Service Based
Interface (SBI)\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**Controller UE:** usually a smart device or an application in the terminal
that can send control message instructions to machine equipment. A controller
terminal can control multiple controlled terminals.
**Controlled UE:** an IoT equipment which can access the network through a
variety of technologies and network slicing. A controlled terminal can be
controlled by a number of controller terminals.
**Non-3GPP Message** : the message supported in a message service which is not
defined by 3GPP (e.g. RCS message as specified in GSMA PRD RCC.07 [4], OMA
LWM2M message as specified in OMA OMA-ERELD-LightweightM2M [5]).
**MSGin5G service capabilities:** the subset of MSGin5G service available to
access and/or communicate with other UEs or application servers. The whole set
of MSGin5G service includes point-to-point messaging, application-to-point
messaging, group messaging and broadcast messaging.
For the purpose of the present document, the following terms given in 3GPP TS
22.262 [2] apply:
**MSGin5G Server**
**MSGin5G Gateway**
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
# 4 Scenarios
## 4.1 General
Four message communication models are specified in 3GPP TS 22.262 [2],
including:
a) point-to-point message
b) application-to-point message
c) group message
d) broadcast message
In this document, three logical UE types will be used to describe the
scenarios of each message communication model from technical point of view,
the definitions of UE types are specified in clause 8.1.
The correspondence between UE types A/B/C/D described in 3GPP TS 22.262 [2]
and the UE types described in this Technical Report:
\- The MSGin5G UE type corresponds to both types A and B.
\- The Legacy 3GPP type is derived from type C and supports NIDD, broadcast,
etc. in addition to SMS. Legacy 3GPP UE type may also originate MSGin5G
Application Service messaging.
\- The Non-3GPP type is derived from type D.
This Technical Report will focus on the common key issues of MSGin5G Service.
The requirements specified in 3GPP TS 22.262 [2] and assumptions based on 3GPP
TS 22.262 [2] apply to the scenarios。
1) The following applies to the point-to-point message scenario:
\- Typical use case of point-to-point message is remote control of intelligent
terminals (see 3GPP TS 22.262 [2])
\- [R-5.2.2-001] The MSGin5G Service shall support Mobile Originated Mobile
Terminated (MOMT) messaging, i.e. messages are originated and terminated at
UEs.
\- [R-5.2.2-002] The MSGin5G Service shall support addressing the UE by
IMSI/MSISDN or IMEI.
The following assumptions can be made based on 3GPP TS 22.262 [2]:
\- Most UEs in this scenario do not have the limitation of power, and are
online most time.
2) The following applies to the application-to-point message scenario:
\- Typical use cases of application-to-point message are monitoring data
reporting and remote control. (see 3GPP TS 22.262 [2])
\- [R-5.3.2-001] The MSGin5G Service shall support Mobile Originated
Application Terminated (MOAT) messaging, i.e. messages are originated at a UE
and terminated at an application server in the network.
\- [R-5.3.2-002] The MSGin5G Service shall support Application Originated
Mobile Terminated (AOMT) messaging, i.e. messages are originated at an
application server in the network and terminated at a UE.
\- [R-5.3.2-003] The MSGin5G Service shall support Application Originated
Mobile Terminated messaging service with max latency of 10 seconds while
maintaining battery life of at least 3 months for small data traffic once
every hour and typical sized IOT battery [200-500mAh].
\- [R-5.1.2-006] The MSGin5G Service shall support a server in the network
triggering the UE to perform an action (e.g. wake up and establish a PDN
connection).
Based on requirements [R-5.3.2-003] and [R-5.1.2-006] listed above, the
following assumptions can be made:
\- UE Power Saving Mode specified in 3GPP TS 23.682 [3] is needed to be
considered.
\- Requirement [R-5.2.2-002] listed above will also apply.
3) The following applies to the group message scenario:
\- Typical use case of group message is smart home. (see 3GPP TS 22.262 [2]).
\- [R-5.4.2-001] The MSGin5G Service shall support group message
communication, i.e. a UE sends a message to a group of UEs. All the members in
a group can send messages. The UEs in a group can be located in different
geographical areas.
The following assumptions can be made based on 3GPP TS 22.262 [2]:
\- All kinds of UE (e.g. application server, devices with or without power and
computation limitation, devices always online or usually without IP
connection) may use group message. Only a limited number of UEs in the group
have the ability of group management.
\- Requirement [R-5.2.2-002] listed above will also apply to both originating
UE and terminating UE.
4) The following applies to the broadcast message scenario:
\- [R-5.5.2-002] The MSGin5G Service shall support an authorized application
server or UE to send a broadcast message to all the UEs within a specific area
which is configured according to application policy.
\- The assumptions of UE type in the group message scenario will also apply.
\- Requirement [R-5.2.2-002] listed above applies to the originating UE.
## 4.2 Scenario 1: Point-to-point message
### 4.2.1 Scenario 1.1: Message between MSGin5G UE s
This scenario describes the case where Controller UE1 (e.g. a mobile handset
terminal 1 or an application client APP 1 in a mobile handset Terminal 1)
communicates with Controlled UE2 (e.g. wearable devices Terminal 2 like smart
watch) or Controlled UE C. Both UE1 and UE2 are MSGin5G UE type and connected
to a same 5G system, use MSGin5G service and served by same MSGin5G
application layer. UE C is connected to the 5G system that supports SMS but
does not support the MSGin5G Service. APP2 in the terminal 1 may also MSGin5G
capable, but not used in this communication.
NOTE 1: MSGin5G application layer may consist of numerous functions, e.g.
MSGin5G Server. The application architecture to support the scenarios will be
studied.
NOTE 2: The UE1, UE2, etc in this Clause mean the party 1 and party 2 in a
messaging procedure. It is not related t to a specific UE type.
The message will be routed via the 5G system from UE1 to UE2 or UE C, or vice
versa. The message may also be first routed to the MSGin5G application layer
and then forwarded to the other party. The scenario is illustrated in figure
4.2.1-1.
Figure 4.2.1-1: Message between MSGin5G Clients
The scenario consists of the following aspects:
\- If message is originated by authorized UE1, the MSGin5G server identifies
the identity of UE2 or UE C and forwards the MSGin5G message to UE2 or UE C.
UE2 or MSGin5G server may send the delivery status to UE1.
\- If message is originated by authorized UE2, the MSGin5G service identifies
the identity of UE1 (e.g. a specific APP1in terminal 1) and forwards the
MSGin5G message to UE1. UE1 or MSGin5G server may send the delivery status to
UE2 or UE C.
### 4.2.2 Scenario 1.2: Message between non-3GPP Controller UE and MSGin5G
Controlled UE
This scenario describes the case where Controller UE1 (e.g. a mobile handset
Terminal 1, or an application client APP 1 in a mobile handset Terminal 1)
communicates with Controlled UE2 (e.g. wearable device Terminal 2 like a smart
watch) by using non-3GPP message service (e.g. RCS message service specified
in GSMA PRD RCC.07 [4]), and UE2 uses MSGin5G service and is 5GMSG transport
capable.
UE1 is connected to a non-3GPP message server and then connected to MSGin5G
application layer via Non-3GPP Message Gateway. UE2 connected the 5G system
directly and served by MSGin5G application layer. The scenario is illustrated
in figure 4.2.2-1.
NOTE: The Non-3GPP Message Gateway facilitates the translation between the
MSGin5G Service and non-3GPP message service. The application functional
aspect and procedure in Non-3GPP Message Gateway will be studied.
Figure 4.2.2-1: Message between non-3GPP Controller UE and MSGin5G Controlled
UE
The scenario consists of the following aspects:
\- UE 1 is authorized by the MSGin5G service via Non-3GPP Message Gateway.
\- The Non-3GPP Message Gateway records the mapping between the identity in
MSGin5G service and the identity in non-3GPP message service for both UE1 and
UE2.
\- If message is originated by authorized UE1, non-3GPP message server
forwards the message to Non-3GPP Message Gateway. MSGin5G server identifies
the UE2 and forward the MSGin5G message to UE2. UE2 or MSGin5G server may send
the delivery status to UE 1.
For the case where Controlled UE2 (e.g. wearable device Terminal 2 like smart
watch) communicates with Controller UE1 (e.g. a mobile handset Terminal 1, or
an application client APP 1 in a mobile handset Terminal 1) that uses non-3GPP
message (e.g. RCS message service specified in GSMA PRD RCC.07 [4]) .
\- If message is originated by authorized UE2, the MSGin5G service forwards
the message to UE1 (mobile handset terminal 1 or a specific application in
terminal 1) in the MSGin5G service, and the Non-3GPP Message Gateway forward
the message to UE1. UE1 or MSGin5G server may send the delivery status to UE
2.
### 4.2.3 Scenario 1.3: Message between MSGin5G Controller UE and non-3GPP
Controlled UE
This scenario describes the case where Controller UE1 (e.g. a mobile handset
Terminal 1, or an application client APP 1 in a mobile handset Terminal 1)
communicates with Controlled UE B (e.g. wearable devices Terminal 2 like smart
watch) by using MSGin5G service, and UE2 uses non-3GPP message service (e.g.
OMA LWM2M specified in OMA OMA-ERELD-LightweightM2M [5]).
UE1 connected to 5G system and served by MSGin5G application layer. UE2 served
by non-3GPP message server. The MSGin5G message and non-3GPP message will be
transferred to each other by the Non-3GPP Message Gateway. The scenario is
illustrated in figure 4.2.3-1.
Figure 4.2.3-1: Message between MSGin5G Controller UE and non-3GPP Controlled
UE
The scenario consists of the following aspects:
\- UE2 is authorized by the MSGin5G service via Non-3GPP Message Gateway.
\- The Non-3GPP Message Gateway records the mapping between the identity in
MSGin5G service and the identity in non-3GPP message service for both UE1 and
UE2.
\- If message is originated by authorized UE1, the MSGin5G server forwards the
message to UE2 in the MSGin5G service, and the Non-3GPP Message Gateway
forwards the message to UE2. UE2 or MSGin5G server may send the delivery
status to UE1.
For the case where Controlled UE2 (e.g. wearable device Terminal 2 like smart
watch) that uses non-3GPP message communicates with Controller UE1 (e.g. a
mobile handset Terminal 1, or an application client APP 1 in a mobile handset
Terminal 1).
\- If message is originated by authorized UE2, the MSGin5G server forwards the
MSGin5G message to the Non-3GPP Message Gateway. MSGin5G server identifies the
identity of UE1and forward the non-3GPP message to UE1. UE1 or MSGin5G server
may send the delivery status to UE2.
NOTE: The scenario is out of scope if both UE1 and UE2 use non-3GPP message.
### 4.2.4 Scenario 1.4: Message between MSGin5G UE and Legacy 3GPP UE
This scenario describes the case where MSGin5G UE (e.g. a mobile handset, or
an application client in a mobile handset) communicates with Legacy 3GPP UE
(e.g. wearable devices like smart watch) by using MSGin5G service.
UE1 is MSGin5G UE which is connected to 5G system and is served by MSGin5G
application layer.
UE2 is Legacy 3GPP UE which is connected to 5G system and is served by Legacy
3GPP message service.
The scenario is illustrated in figure 4.2.4-1.
Figure 4.2.4-1: Message between MSGin5G UE and Legacy 3GPP UE
The scenario consists of the following aspects:
\- If a message is originated by authorized UE1, the MSGin5G application layer
identifies the type of UE2 and forwards the message to the Legacy 3GPP Message
Gateway, the Legacy 3GPP Message Gateway converts the message formate and
delivers the message to UE2. UE2 may send the delivery status to UE1.
\- If a message is replied to originated by authorized UE2, the UE2 sends the
reply message to the Legacy 3GPP Message Gateway, the Legacy 3GPP Message
Gateway converts the message format and delivers the message to the MSGin5G
application layer, the MSGin5G application layer identifies the type of UE1
and forwards the message to UE1. UE1 may send the delivery status to UE2.
NOTE: The scenario that UE2 replies to a message from UE1 should be supported.
## 4.3 Scenario 2: Application-to-point message
### 4.3.1 Application-to-point scenarios overview
In the application-to-point scenarios MSGin5G messages originate from an
application, which may reside on Controller UEs. Controller UEs can be MSGin5G
UE type, Non-3GPP UE type or a combination of them. In all cases the message
is sent to the MSGin5G application layer and terminates at the Application
Server. All UEs send messages to the application layer via the 5G access
network and the Application Server is connected to the MSGin5G application
layer directly.
The Application Server processes the received messages and this could result,
depending on the service requirements, in a message that is sent by the
Application Server and which terminates at a Controlled UE. Controlled UEs can
be MSGin5G UE type, Legacy 3GPP UE type, Non-3GPP UE type or a combination of
them. .
An example of such a service is where electric scooters send their status
(e.g. location and battery level) at a regular interval to the server (APP1)
and when such a scooter is rented by an individual (APP2) the server sends a
message to that scooter to unlock it.
### 4.3.2 Scenario 2.1: Message from UE to Application Server
This scenario describes the case where a UE (e.g. a mobile handset terminal or
an application client APP 1 in a mobile handset terminal) communicates with
the Application Server. the UE may be MSGin5G UE, Legacy 3GPP UE or Non-3GPP
UE.
MSGin5G UE is connected to the 5G access network and sends messages via the
5GMSG transport to the MSGin5G application layer.
Legacy 3GPP UE is connected to the 5G access network and replies messages via
legacy 3GPP Message Gateway to the MSGin5G application layer.
Non-3GPP UE replies messages via the Non-3GPP Message Gateway to the MSGin5G
application layer.
NOTE: MSGin5G application layer may consist of numerous functions, e.g.
MSGin5G Server. The application architecture to support the scenarios will be
studied.
The message will be routed via the 5G system from the UE to the Application
Server. The scenario is illustrated in figure 4.3.2-1. In figure 4.3.2-1, UE1
is a MSGin5G UE, UE2 is a Legacy 3GPP UE, UE3 is a non-3GPP UE.
Figure 4.3.2-1: Message from UE to Application Server
The scenario consists of the following aspects:
\- If a message is originated by authorized MSGin5G UE, the MSGin5G
application layer identifies the identity of the Application Server and sends
a message to this Application Server. The Application Server may send the
delivery status to the originating UE via the MSGin5G service.
\- If Legacy 3GPP UE or Non-3GPP UE replies a message which is from
Application Server, the message is replied to the Message Gateway, the Message
Gateway converts the message format and then replies a MSGin5G message to
MSGin5G server. Then the MSGin5G server identifies the identity of the
Application Server and replies a message to this Application Server. The
Application Server may give the delivery status to the UE via the MSGin5G
service.
### 4.3.3 Scenario 2.2: Message from Application Server to UE
This scenario describes the case where Application Server communicates with
UEs using the MSGin5G service. The UEs can be MSGin5G UE type, Legacy 3GPP UE
type, Non-3GPP UE type or a combination of them.
The Application Server is connected directly to the MSGin5G application layer.
MSGin5G UE is connected to the 5G access network and receives messages via the
MSGin5G service.
Legacy 3GPP UE is connected to the 5G access network and receives messages via
Legacy 3GPP Message Gateway.
Non-3GPP UE receives its non-3GPP messages via the Non-3GPP Message Gateway.
The scenario is illustrated in figure 4.3.3-1, UE1 is a MSGin5G UE, UE2 is a
Legacy 3GPP UE, UE3 is a non-3GPP UE.
NOTE: The Non-3GPP Message Gateway facilitates the translation between the
MSGin5G Service and non-3GPP message service. The Legacy 3GPP Message Gateway
facilitates the translation between the MSGin5G Service and legacy 3GPP
message service.
Figure 4.3.3-1: Message from Application Server to UEs
The scenario consists of the following aspects:
\- The Application Server is authorized to use the MSGin5G application layer.
\- If a message is originated by an authorized Application Server and should
terminate at MSGin5G UE, then MSGin5G application layer delivers the message
to the UE. The UE may send the delivery status to the Application Server.
If a message is originated by an authorized Application Server and should
terminate at Legacy 3GPP UE, MSGin5G application layer delivers the message to
the Legacy 3GPP Message Gateway, and then the Legacy 3GPP Message Gateway
converts the message format and delivers the message to the UE. The UE may
send the delivery status to the Application Server.
\- The Non-3GPP Message Gateway records the mapping between the identity in
MSGin5G service and the identity in non-3GPP message service for Non-3GPP UE.
\- If a message is originated by an authorized Application Server and should
terminate at Non-3GPP UE then the MSGin5G application layer identifies the
Non-3GPP UE and forwards the MSGin5G message to Non-3GPP Message Gateway. The
Non-3GPP Message Gateway converts the message format and delivers the message
to the Non-3GPP UE. The Non-3GPP UE may send the delivery status to the
Application Server.
## 4.4 Scenario 3: Group message
### 4.4.1 Scenario 3.1: Group message between MSGin5G UEs
This scenario describes the case where MSGin5G UE1 (e.g. a mobile handset
terminal 1 or an application client APP 1 in a mobile handset Terminal 1)
communicates with a group of UEs (MSGin5G UEs or legacy 3GPP UEs or non-3GPP
UE). All UEs may be in different geographical area.
NOTE: MSGin5G server may consist of numerous functions, e.g. MSGin5G Server
group function. The application architecture to support the scenarios will be
studied.
The message will be first routed to the MSGin5G server and then forwarded to
all other parties. The scenario is illustrated in figure 4.4.1-1.
Figure 4.4.1-1: Group message between MSGin5G UEs
The scenario consists of the following aspects:
\- all UEs in group can communicate with each other, which means the message
sent by a MSGin5G UE will be received by all the other UEs in the group,
either directly from MSGin5G server (if MSGin5G UEs) or via Message gateway
(if Non-3GPP UEs or Legacy 3GPP UE).
NOTE: Group message between UE C and UE D is also supported when the group is
hosted on MSGin5G Server.
### 4.4.2 Scenario 3.2: Group message between non-3GPP UEs and MSGin5G UEs
This scenario describes the case where non-3GPP UE1 (e.g. a mobile handset
Terminal, or an application client APP 1 in a mobile handset Terminal 1)
communicates with a group of UEs by using non-3GPP message (e.g. RCS message
service specified in GSMA PRD RCC.07 [4]), and some of UEs in this group use
MSGin5G service. All UEs in the group may be in different geographical area.
UE1 connect to a non-3GPP message server and then connected to MSGin5G server
via Non-3GPP Message Gateway. All MSGin5G UEs connected the 5G system directly
and served by MSGin5G server. The scenario is illustrated in figure 4.4.2-1.
NOTE: The Non-3GPP Message Gateway facilitates the translation between the
MSGin5G Service and non-3GPP message service. The application functional
aspect and procedure in Non-3GPP Message Gateway will be studied.
Figure 4.4.2-1: Message from non-3GPP Message Service to MSGin5G group
The scenario consists of the following aspects:
\- all UEs in group can communicate with each other, which means the message
sent by a non-3GPP UE will be received by all the other 5 MSGin5G UEs in the
group, and all the other MSGin5G UEs can send the message to a non-3GPP UE.
## 4.5 Scenario 4: Broadcast message
### 4.5.1 Scenario 4.1: Message Broadcast from MSGin5G Server
This scenario describes the case where an APP Server in the network
communicates with Controlled UEs by using MSGin5G service via broadcast.
The message will be routed via the 5G system from the APP Server to UEs. The
scenario is illustrated in figure 4.5.1-1.
The recipient UE is connected to the same 5G system and support broadcast.
Figure 4.5.1-1: Message Broadcast from APP Server to UEs
The scenario consists of the following aspects:
\- The message is originated by authorized APP Server and the APP Server also
provides the service area information.
\- The MSGin5G Server forwards the MSGin5G message to the 5G System, which
takes care of broadcasting the message in the designated service area.
\- UEs that support the MSGin5G Service and are located in the service area
and configured to receive the message will receive it via broadcast.
### 4.5.2 Scenario 4.2: Message Broadcast initiated from MSGin5G UE
This scenario describes the case where Controller UE1 (e.g. a mobile handset
Terminal 1, or an application client APP 1 in a mobile handset Terminal 1)
communicates with Controlled UEs 2 via broadcast.
The message will be routed via the 5G system from the APP in UE1 to UEs 2\.
The scenario is illustrated in figure 4.5.2-1.
Figure 4.5.2-1: Message Broadcast from APP in UE1 to UEs2
The scenario consists of the following aspects:
\- The message is originated by authorized APP in UE1 and the APP also
provides the service area information.
\- The MSGin5G Server forwards the MSGin5G message to the 5G System, which
takes care of broadcasting the message in the designated service area.
\- UEs that support the MSGin5G Service and are located in the service area
and configured to receive the message will receive it via broadcast.
### 4.5.3 Scenario 4.3: Message broadcast from non-3GPP Message Service to
MSGin5G UEs
This scenario describes the scenario where Non-3GPP UE1 (e.g. OMA LWM2M
specified in OMA OMA-ERELD-LightweightM2M [5]) delivers a broadcast message by
using non-3GPP Message service to MSGin5G UEs2 (e.g. a mobile handset terminal
1 or an application client APP 1 in a mobile handset Terminal 1) to MSGin5G
UEs2which is configured according to application policy.
MSGin5G UEs2 connected to 5G system and served by MSGin5G server. The MSGin5G
message and non-3GPP message will be translated by the Non-3GPP Message
Gateway. The scenario is illustrated in figure 4.5.3-1.
Figure 4.5.3-1: Message broadcast from non-3GPP message service to MSGin5G UEs
2
The scenario consists of the following aspects:
\- If broadcast message is originated by authorized Non-3GPP UE1, the MSGin5G
Server broadcasts the message to all the UEs. MSGin5G UEs may send the
delivery status back to Non-3GPP UE1 or APP Server.
# 5 Key Issues
## 5.1 Key Issue 1: support acknowledgement of delivery status
### 5.1.1 Description
The requirement of supporting delivery status is specified in requirement
[R-5.1.2-004] of 3GPP TS 22.262 [2].
In many use cases of MSGin5G service, the message originator cares about
delivery status of some specific messages, or makes further decision based on
the delivery status of previous messages. In some other use cases, the message
originator may not care about delivery messages, e.g. a smart device in a
group may not care whether a message it sent to the group is received by some
other smart devices in the group, or in case of broadcast to a large number of
devices an acknowledgement from receiving devices may not be useful.
Furthermore, if non-3GPP message is used by some UEs, delivery status of
MSGin5G service is needed to be mapped to delivery status of non-3GPP message.
Issues include:
\- How to identify if delivery status is required for some specific message.
\- How to require the delivery status of some specific message.
\- How the delivery status of MSGin5G service interwork with non-3GPP message
services.
### 5.1.2 Identified Gaps
The following gaps have been identified to fulfill the delivery status
acknowledgement:
\- The protocol requirements for delivery status acknowledgement and sending a
delivery status acknowledgement shall be studied.
\- If delivery status acknowledgement is supported by the non-3GPP message
service, the procedure of delivery status acknowledgement interworking in the
Non-3GPP Message Gateway will be defined.
\- If delivery status acknowledgement is not supported by the non-3GPP message
service, then if the Non-3GPP Message Gateway or MSGin5G server will send the
delivery status acknowledgement on behalf of the non-3GPP UE needs to be
defined.
## 5.2 Key Issue 2: Cell Broadcast Service in MSGin5GS
### 5.2.1 Description
#### 5.2.1.1 Issue statement
This key issue analyses if the Cell Broadcast Service as specified in 3GPP TS
23.041 [6] fulfills the requirements of the broadcast component of MSGin5GS as
specified in 3GPP TS 22.262 [2].
#### 5.2.1.2 Introduction to the Cell Broadcast Service
The Cell Broadcast Service supports unacknowledged broadcasting of a text
message in one or more cells. The message consists of Warning Message Content,
Message Identifier, Serial Number and Data Coding Scheme parameters.
The Message Identifier indicates the source or type of content and together
with the Serial Number identifies the message uniquely. The Data Coding Scheme
indicates how the Warning Message Content is encoded.
The Warning Message Content NG-RAN IE contains the user information and is a
string of maximum 9600 octets. This IE contains a maximum of 15 CBS-Message-
Information-Pages of 82 octets each which results in 1230 octets, and not in
9600 octets. It is not specified how 9600 octets can be encoded.
The message is broadcast over the radio interface in SIB8; no data is sent
over the User Plane (see 3GPP TS 38.331 [8]). The cmas-indication in the
paging message is used to notify the UEs that SIB1 contains the scheduling
information for receiving SIB8. The paging message is broadcast with a
periodicity of 40 ms and SIB1 has a periodicity of 80 ms. SIB8 is broadcast
with a configurable periodicity and 80 ms, 160 ms, 320 ms, and 640 ms are
possible values. SIB8 may be segmented when it is broadcast over the air
interface, when the maximum size of SIB8 is exceeded. This means that 200 ms
is the minimum latency until the UE can start receiving the SIB8. The duration
for receiving SIB8 depends on the total size of SIB8.
#### 5.2.1.3 Analyses of the requirements
3GPP TS 22.262 [2] contains general requirements in subclause 5.1.2 and
broadcast message specific requirements in subclause 5.5.2. Other requirements
are not related to message broadcast. These requirements are copied here (in
italics) and analysed individually.
[R-5.1.2-001] The MSGin5G Service shall support UE sending and receiving a
text or data message with end-to-end latency of less than 500 ms.
The latency for broadcasting SIB8 is at least 200 ms.
[R-5.1.2-002] The MSGin5G Service shall support variable size of payload of
text and data with a maximum of 2048 bytes, and support segmented transmission
if the content is larger than the maximum payload length of a message.
Cell Broadcast allows encoding of a payload of up to 1230 octets, but it is
not specified how 2048 octets can be encoded, even though the maximum size of
the payload string is specified to be 9600 octets.
[R-5.1.2-003] The MSGin5G Service shall support delivery of a message to a
specific application in the terminated UE. This message contains the contents
that can be handled by the specific application.
The _Data Coding Scheme_ IE can be used to indicate that the payload is (U)SIM
specific and shall be processed by an application instead of being displayed
immediately (see 3GPP TS 23.038 [7]).
[R-5.1.2-004] The MSGin5G Service shall support acknowledgement of delivery
status (success, failure) of a message and indication of reason if the
delivery is failed.
The NG-RAN nodes report successful scheduling of broadcast to the CBC (not of
failed scheduling).
[R-5.1.2-005] The MSGin5G Service shall support storage of a message if a UE
is unavailable (disconnected or power off) for future delivery once the UE
becomes available.
Cell Broadcast messages are repeatedly broadcast for as long as the message is
valid.
[R-5.1.2-006] The MSGin5G Service shall support a server in the network
triggering the UE to perform an action (e.g. wake up and establish a PDN
connection).
Cell Broadcast uses the cmas-indication in the paging message to notify the UE
to obtain SIB1 which contains the scheduling information to obtain SIB8 and
the _Warning Message Content NG-RAN_ IE is used by the application to perform
an action.
[R-5.1.2-007] The MSGin5G Service shall support a UE sending and receiving
messages via a MSGin5G Gateway.
The Cell Broadcast Centre (see 3GPP TS 23.041 [6]) could be an instantiation
of a MSGin5G Gateway for broadcasting messages. Cell Broadcast does not
support non-3GPP access.
[R-5.1.2-008] The MSGin5G Service shall support the mobility of a UE (i.e. the
UE can still send/receive messages when it changes the location of network
access).
Cell Broadcast broadcasts SIB8 repeatedly in one or more cells and UEs will
receive that as long as they remain in coverage of those cells.
[R-5.5.2-001] The MSGin5G Service shall support broadcasting a text or data
message with end-to-end latency less than [500] ms.
This requirement is identical to requirement R-5.1.2-001 above from a
broadcast perspective.
[R-5.5.2-002] The MSGin5G Service shall support an authorized application
server or UE to send a broadcast message to all the UEs within a specific area
which is configured according to application policy.
3GPP TS 23.041 [6] specifies a Cell Broadcast Entity which serves as an entity
where the broadcast message is generated. CBE functionality and an interface
towards the Cell Broadcast Centre are not specified.
### 5.2.2 Identified Gaps
If Cell Broadcast technology is used to support the broadcast message in the
MSGin5G Service then the following requirements apply:
\- It needs to be specified how a maximum of 2048 octets can be encoded in the
Warning Message Content NG-RAN IE.
\- The architecture for the MSGin5G architecture contains a Cell Broadcast
Centre and the interface between that Cell Broadcast Centre and the MSGin5G
Server may need to be specified.
## 5.3 Key Issue 3: identifier(s) of the UE
### 5.3.1 Description
The requirement of identifying the UE is specified in requirement
[R-5.2.2-002] of 3GPP TS 22.262 [2]. It also applies to other three message
scenarios according to the assumptions in clause 4.1.
Different MSGin5G enabled applications in a mobile handset Terminal shall be
identified by MSGin5G services and the requirement is specified in requirement
[R-5.2.2-003] of 3GPP TS 22.262 [2]. It also applies to other three message
scenarios according to the assumptions in clause 4.1.
Furthermore, if MSGin5G UE communicates with non-3GPP message UE, the
identifiers of non-3GPP UE shall be mapped with identifier of MSGin5G UE.
Issues include:
\- How to uniquely identify a UE in MSGin5G service, the UE may include
MSGin5G enabled devices, MSGin5G enabled application in a device and non-3GPP
message device.
\- There may be many kinds of non-3GPP message services, whether it is
necessary to establish a unique mechanism to map the non-3GPP identifier to
MSGin5G identifier, and how to establish the mechanism.
### 5.3.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- The IMSI/MSISDN or IMEI may not suitable to identify all kind of UEs, e.g.
the applications in a mobile handset. The following studies are needed:
\- Whether the existing identifier(s) can fulfil the requirements.
\- Whether new identifier(s) is needed to be specified.
\- If the identifier(s) of UE is assigned by MSGin5G services, the procedure
of generating, assigning and managing the identifier(s) are needed to be
defined.
\- The procedure of managing both the MSGin5G identifiers(s) and identifier(s)
of non-3GPP message services in Non-3GPP Message Gateway is needed to be
defined.
## 5.4 Key Issue 4: network triggering the UE
### 5.4.1 Description
The requirement of network triggering the UE is specified in requirement
[R-5.1.2-006] of 3GPP TS 22.262 [2]. It applies to all message scenarios.
Some performance requirements also apply to the network triggering mechanism,
i.e. the requirement [R-5.5.2-001] of 3GPP TS 22.262 [2].
Issues include:
\- Whether the existing network triggering mechanism, i.e. network triggered
service request specified in clause 4.2.3.3 of 3GPP TS 23.502 [10], can fulfil
the network triggering requirement specified in 3GPP TS 22.262 [2].
\- When UE uses non-3GPP message service, whether it is necessary for MSGin5G
service to trigger the UE and how MSGin5G service triggers the UE.
### 5.4.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- If network triggered service request specified in clause 4.2.3.3 of 3GPP TS
23.502 [10] is used to trigger the UE, potential impact to on 5G system is
needed to be studied.
\- Specify an MSGin5G trigger procedure on top of 5GS if needed.
\- How to trigger non-3GPP message UE and the related procedure are needed to
be studied.
## 5.5 Key Issue 5: Message transfer from MSGin5G UE and Non-3GPP UE to
MSGin5G Server
### 5.5.1 Description
MSGin5G UE is a Controller UE that sends messages in MSGin5G message format to
the MSGin5G Server.
Non-3GPP UE is a Controller UE that sends messages in a non-3GPP message
format via the Non-3GPP Message Gateway to the MSGin5G Server.
The 5G Network provides data delivery methods over the control plane (i.e. via
N1) and over the user plane (i.e. via N3). Application Servers access control
plane and user plane data delivery features via N6 or via exposed APIs (e.g.
T8 and Nnef).
### 5.5.2 Identified gaps
\- Whether the MSGin5G Service uses existing control plane data delivery
methods, existing user plane data delivery methods or both.
\- Whether the MSGin5G Service requires new or enhanced data delivery methods.
\- Whether the MSGin5G Service uses existing methods (e.g. N6, T8, and Nnef)
in order to access user plane and/or control plane data delivery methods.
\- Whether the MSGin5G Service requires new or enhanced methods in order to
access data delivery methods.
## 5.6 Key Issue 6: Message delivery from MSGin5G Server to Non-3GPP UE
### 5.6.1 Description
The MSGin5G Server supports messages in the MSGin5G message format and needs
to be able to deliver messages to Non-3GPP UE type devices that do not support
the MSGin5G message format, but support a non-3GPP message format.
The Non-3GPP Message Gateway acts as a gateway as shown in figure 5.6.1-1 and
takes care of message delivery via the 5G System.
Figure 5.6.1-1 also shows message delivery (and reception) to Device E. Device
E is a device that does not support the MSGin5G Service and is not connected
to the 5G System but is connected to the MSGin5G Server, via the MSGin5G
Inter-Working Function (IWF), but has otherwise similar capabilities and
functionality as Non-3GPP UE has.
Figure 5.6.1-1: Non-3GPP Message Gateway as gateway
The Non-3GPP Message Gateway needs to support the capability of message
delivery to Non-3GPP UE in point-to-point, point-to-group and broadcast
scenarios. The MSGin5G Server supports this same capability for delivery of
messages to MSGin5G UE in the same scenarios.
### 5.6.2 Identified gaps
\- The interface between the MSGin5G Server and the Non-3GPP Message Gateway
needs to be specified.
\- The interface between the MSGin5G Server and the MSGin5G IWF needs to be
specified and it needs to be studied if the interface towards the Non-3GPP
Message Gateway can be the same as the interface towards the MSGin5G IWF.
NOTE: Functionality of the Non-3GPP Message Gateway and MSGin5G IWF beyond the
interface to the MSGin5G Server are out of scope of the study.
## 5.7 Key Issue 7: group message
### 5.7.1 Description
The requirement of group message is specified in requirement [R-5.4.2-001] of
3GPP TS 22.262 [2]:
\- [R-5.4.2-001] The MSGin5G Service shall support group message
communication, i.e. a UE sends a message to a group of UEs. All the members in
a group can send messages. The UEs in a group can be located in different
geographical areas.
The requirements of roaming and interconnection specified in 3GPP TS 22.262
[2] are also applied:
\- [R-8.2-001] The MSGin5G Service shall support a roaming UE sending and
receiving messages.
\- [R-9.2-001] The MSGin5G Service shall support an UE within an operator
sending a message to another UE within another operator.
The following conclusion can be made based on the requirements above:
\- The UEs in a group may locate in different PLMNs or roam to VPLMN.
According to requirement [R-5.1.2-007] of 3GPP TS 22.262 [2], non-3GPP message
UE may also send and receive group message via MSGin5G Gateway (i.e. Non-3GPP
Message Gateway in this TR).
Issues include:
\- How to support different UEs sending and receiving group message in an
MGSin5G group. The UE may include MSGin5G UE located in HPLMN, MSGin5G UE
located in VPLMN, MSGin5G UE interconnected from other PLMN and non-3GPP UE,
### 5.7.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- The procedures of group message, including originating and terminating
group message for different UEs, are needed to be specified.
\- The related functional requirements, e.g. identifier of group,
authorization of UEs, etc, are needed to be specified.
## 5.8 Key Issue 8: group management
### 5.8.1 Description
The requirement of group management is specified in requirement [R-5.4.2-002]
of 3GPP TS 22.262 [2]. However, it is not specified that who (e.g. all UEs or
some specific UEs in the group, the MSGin5G server) has the capability of
group management.
Issues include:
\- Analyze who can have the capability of group management from the technical
perspective.
\- How to generate, manage and synchronize the group information on UE and
MSGin5G server. The UE may include MSGin5G UE located in HPLMN, MSGin5G UE
located in VPLMN, MSGin5G UE interconnected from other PLMN and non-3GPP UE,
\- How to manage non-3GPP UE in a MSGin5G group message group.
### 5.8.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- Whether the existing mechanism, e.g. SEAL specified in 3GPP TS 23.434 [9]
can fulfil the group management requirements specified in 3GPP TS 22.262 [2].
If gaps are identified, the following studies are needed:
\- The group information used for MSGin5G group management.
\- The procedures of MSGin5G group management.
\- The group management interworking in the Non-3GPP Message Gateway are
needed to be defined.
\- Technical requirements caused by the characters of UEs are needed to be
fulfilled.
\- UE may have the limitation of resource, some specified mechanism of
managing the group data in the UE are needed.
\- Long latency may exist between UE and MSGin5G server due to the UE may be
offline or in Power Saving Mode specified in 3GPP TS 23.682 [3]. The group
data in the UE and the MSGin5G server may not be synchronized on time, so some
abnormal scenarios are needed to be specified.
## 5.9 Key Issue 9: Application-to-point message exchange
### 5.9.1 Description
The requirements of application-to-point message exchange are specified in
requirement [R-5.3.2-001] and [R-5.3.2-002] of 3GPP TS 22.262 [2].
Various application servers may use the MSGin5G Services, and different types
of UE, e.g. MSGin5G UE legacy 3GPP UE and non-3GPP UE, may exchange
Application-to-point message with those application servers.
Issues include:
\- For the MOAT message,
\- How to uniquely identify a logical application server in MSGin5G service.
The logical application servers may be connected to the MSGin5G application
layer in the 5G core network directly or through the NEF.
NOTE: The logical application server is used for a specific user service.
There is only a single logical application server and many applications
clients in UEs for a specific user service. Multiple logical application
servers, each for a specific user service, may connect to a MSGin5G Server.
\- How to share the contact information of logical application server with
different types of UE.
\- How to interact between MSGin5G server and different logical application
servers in MOAT scenario.
\- For the AOMT message
\- How to share the contact information of different types of UE with
different logical application servers. The UEs can be MSGin5G UE, legacy 3GPP
UE and non-3GPP UE. The logical application servers may be connected to the
MSGin5G application layer in the 5G core network directly or through the NEF.
\- How to interact between MSGin5G server and different logical application
servers in AOMT scenario.
### 5.9.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- Whether the identifier(s) of UE also suitable for identifying the different
kinds of logical application servers.
\- The procedure of sharing contact information between different kinds of
logical application servers and UEs is needed to be defined.
\- The interaction procedure between different kinds of logical application
servers and MSGin5G Server is needed to be defined.
## 5.10 Key Issue 10: broadcast area configuration
### 5.10.1 Description
The service requirement of broadcast area configuration is specified in
requirement [R-5.5.2-002] of 3GPP TS 22.262 [2].
[R-5.5.2-002] The MSGin5G Service shall support an authorized application
server or UE to send a broadcast message to all the UEs within a specific area
which is configured according to application policy.
and 5.5.1 of 3GPP TS 22.262 [2]
The receivers of broadcast messages can be all UEs within a cell or multiple
cells. The broadcast areas can be configured according to the policy of
application.
The requirement applies to broadcast message scenarios.
The following conclusion can be made based on the requirements above:
\- broadcast area configuration should be specified in MSGin5G application
layer.
Issues include:
\- Whether the existing broadcast area configuration, i.e. cell broadcast
service specified in 3GPP TS 23.041 [6] supports the broadcast area
configuration requirement specified in 3GPP TS 22.262 [2]
\- What and how broadcast areas configuration related information can be used
in the application layer
### 5.10.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- What is broadcast area configuration information used for MSGin5G broadcast
message.
\- How broadcast areas configuration related information can be used in the
application layer.
\- The broadcast area configuration interworking in the Non-3GPP Message
Gateway are needed to be defined.
## 5.11 Key Issue 11: mobility management of MSGin5G related information
### 5.11.1 Description
The service requirement of mobility management of the UE is specified in
requirement [R-5.1.2-008] of 3GPP TS 22.262 [2]. It applies to all message
scenarios.
[R-5.1.2-008] The MSGin5G Service shall support the mobility of a UE (i.e. the
UE can still send/receive messages when it changes the location of network
access).
Issues include:
\- What mobility management of MSGin5G related information are required to be
supported in MSGin5G service application layer.
\- Whether and how additional service APIs are required to be supported in
MSGin5G service application layer,
### 5.11.2 Identified Gaps
The following gaps have been identified to fulfil the identifier requirements:
\- The mobility management of MSGin5G related information which fulfils the
service requirement is needed to be defined.in MSGin5G service application
layer.
\- Specify an MSGin5G mobility management on top of 5GS if needed.
\- How to manage the mobility of non-3GPP message UE and the related procedure
are needed to be studied.
## 5.12 Key Issue 12: End-to-end latency
### 5.12.1 Description
In clause 5.1 of 3GPP TS 22.262 [2], the requirement of end-to-end latency is
specified as below:
[R-5.1.2-001] The MSGin5G Service shall support UE sending and receiving a
text or data message with end-to-end latency less than [500] ms.
NOTE 1: Initial connection activation latencies may be longer depending on
receiving UE power saving states, paging, etc.
The requirement [R-5.1.2-001] is specified in the general clause of service
requirements so it will apply to all of the four message scenarios. A similar
requirement [R-5.5.2-001] listed below is also listed in clause 5.5 of 3GPP TS
22.262 [2].
[R-5.5.2-001] The MSGin5G Service shall support broadcasting a text or data
message with end-to-end latency less than [500] ms.
A further requirement for the Application-to-point message scenario listed
below is also specified in 3GPP TS 22.262 [2]:
[R-5.3.2-003] The MSGin5G Service shall support Application Originated Mobile
Terminated messaging service with max latency of 10 seconds while maintaining
battery life of at least 3 months for small data traffic once every hour and
typical sized IOT battery [200-500mAh].
This requirement applies to the AOMT messaging service, so [R-5.1.2-001] still
applies to the MOAT messaging service.
Issues include:
\- The main factors affecting the end-to-end latency in each message scenario
are needed to be studied.
\- How to ensure that the end-to-end latency in point-to-point message
scenario is less than [500] ms.
\- How to ensure that the end-to-end latency in AOMT messaging service is less
than [10] seconds.
\- How to ensure that the end-to-end latency in MOAT messaging service is less
than [500] ms.
\- How to ensure that the end-to-end latency in Group message scenario is less
than [500] ms.
\- How to ensure that the end-to-end latency in Broadcast message scenario is
less than [500] ms
### 5.12.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- Whether some procedures in 5G system can be used to limit the end-to-end
messaging latency is needed to be studied. The procedures may be different in
each message scenario.
\- If new procedures are used, the potential impact on 5G system is needed to
be studied.
\- Specify some MSGin5G specific procedures to reduce the end-to-end messaging
latency on top of 5GS if needed.
## 5.13 Key Issue 13: Message store and forward
### 5.13.1 Description
In many MSGin5G Service use cases, a targeted UE may not be immediately
available to receive a message (e.g. UE may be disconnected or powered-off).
In such cases, the MSGin5G Service may not be able to deliver the message
successfully to a targeted UE.
To satisfy these types of use cases, a requirement for supporting Message
store and forward capabilities is specified in [R-5.1.2-005] of 3GPP TS 22.262
[2] below:
[R-5.1.2-005] The MSGin5G Service shall support storage of a message if a UE
is unavailable (disconnected or power off) for future delivery once the UE
becomes available.
The requirement [R-5.1.2-005] is specified in the general clause so it will
apply to all of the four message scenarios.
Store-and-forwarding of messages by the MSGin5G Service enables the storing
(i.e. buffering) of messages when targeted UEs are unavailable and the
forwarding of stored messages to targeted UEs once they become available. By
supporting store-and-forwarding of messages, the MSGin5G Service can
significantly improve the overall performance and efficiency of the system.
Issues include:
\- How the MSGin5G Service can determine that theUE (including MSGin5G UE,
legacy-3GPP UE and non-3GPP UE) is unavailable e.g. based on the application
layer registration status,network connection status API provided by the lower
layer, etc.
\- How to determine that store and forward is needed.
\- What is the relationship between store and forward mechanism and other
application feature, e.g. network triggering specified in [R-5.1.2-006] of
3GPP TS 22.262 [2]. If the UE is unavailable, whether the MSGin5G service
needs to notify the UE that there are messages waiting for it to pick up.
\- How to determine that the UE becomes available.
\- If a message is stored by the MSGin5G Service, how long can the message be
stored waiting for a UE to become available.
### 5.13.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- The procedure to identify if the UE (including MSGin5G UE, legacy-3GPP UE
and non-3GPP UE) is available or unavailable to receive MSGin5G message needs
to be studied.
\- Study how to identify that store and forward mechanism needs to be used.
## 5.14 Key Issue 14: Message Segmentation and Reassembly
### 5.14.1 Description
3GPP TS 22.262[2] defines the following requirement in the general clause,
therefore being applicable to all of the four message scenarios:
[R-5.1.2-002] The MSGin5G Service shall support variable size of payload of
text and data with a maximum of 2048 bytes and support segmented transmission
if the content is larger than the maximum payload length of a message.
### 5.14.2 Identified Gaps
The following aspects have been identified for study:
\- Weather a fixed-length segment size (e.g. 2048 octets) fulfils the
segmentation service requirements.
\- Whether there are differences in handling between the four message
scenarios.
\- The relationship between message segmentation and other service
requirements, e.g. store and forward (specified in [R-5.1.2-005] of 3GPP TS
22.262 [2]).
The following capability gaps have been identified:
\- The capability for the transmitting MSGin5G Service endpoint to detect when
the size of a MSGin5G message exceeds the maximum packet size.
\- The capability for the transmitting MSGin5G Service endpoint to segment and
deliver a MSGin5G message that exceeds the maximum packet size into a set of
segmented messages that individually do not exceed the maximum packet size.
\- The capability for the receiving MSGin5G Service endpoint to reassemble a
set of segmented messages received via individual packets into a single
MSGin5G message.
\- The capability for the receiving MSGin5G Service endpoint to indicate
successful reception of all the segmented messages.
\- The capability for the receiving MSGin5G Service endpoint to detect the
lost segmented messages and request the transmitting MSGin5G Service endpoint
to retransmit.
\- The capability for the transmitting MSGin5G Service endpoint to retransmit
the segmented messages that are lost.
## 5.15 Key Issue 15: Message delivery from MSGin5G Server
### 5.15.1 Description
The key issue addresses message delivery from the MSGin5G Server to an end-
point or to multiple end-points.
It is assumed that the MSGin5G Server is the only entity in the MSGin5G
Service that is aware how messages need to be forwarded towards the various
UEs that participate in the service and that only the MSGin5G Server has
access to a broadcast function, an SMS delivery function in the 5GC, and to a
Non-3GPP Message Gateway.
### 5.15.2 Identified Gaps
The following gaps are identified:
\- The MSGin5G Server needs to be able to forward messages to the requested
end-point, based on UE types (determined by the Service ID).
\- The MSGin5G Server needs to be able to forward messages to a Group of UEs.
The MSGin5G Server needs to forward the message to each of the Group members.
Further details on the group message are described in Key Issue 7.
\- The MSGin5G Server needs to be able to forward messages to the broadcast
function in the 5GC, so the message will be broadcast in a service area.
\- The MSGin5G Server needs to be able to forward messages to the Application
Server. The Application Server may reside outside the 3GPP domain and may be
connected through the NEF to 5GC.
\- The MSGin5G Server needs to be able to forward messages to the Non-3GPP
Message Gateway for UEs that support a non-3GPP transport mechanism. Further
details on message transfer to a Non-3GPP Message Gateway are described in Key
Issue 6.
## 5.16 Key Issue 16: Charging
### 5.16.1 Description
The key issue addresses charging aspects as listed in requirements [R-6.2-001]
and [R-6.2-002] in TS 22.262 [2].
All message transfer passes through the MSGin5G Server and it can therefore be
assumed that generating charging records will be done in the MSGin5G Server.
### 5.16.2 Identified Gaps
The following gaps are identified:
\- What information is needed by the MSGin5G Server to generate charging
records according to operator or application service provider policy?
\- How operator and application service provider charging policies can be
configured and modified at the MSGin5G Server.
\- Is the 3GPP charging management framework as specified in TS 32.290 [20]
applicable for these charging policies?
\- What information is needed by the interworking gateway to generate charging
records according to operator or application service provider policy?
## 5.17 Key Issue 17: Interconnection
### 5.17.1 Description
The requirement of MSGin5G Interconnection listed below is specified in
[R-9.2-001] and [R-9.2-002] of 3GPP TS 22.262 [2].
Issues include:
\- If MSGin5G services are provided by different PLMNs, how to exchange the
MSGin5G service capabilities between the PLMNs.
\- Whether all four message scenarios (as specified in clause 4) can be
interconnected between difference PLMNs.
\- If the MSGin5G service capabilities between different PLMNs are different,
how to interconnect MSGin5G services between different PLMNs.
\- Whether procedures for group management or configuration management for
interconnection among different PLMNs are needed.
### 5.17.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- The information of service capabilities needed to be exchange between
different PLMNs and the related exchanging procedures are needed to be
studied.
\- When at least one party of the message exchang (e.g. to identify UE is in
different PLMN, to register UE from different PLMN, to send and receive
message from different PLMN, etc.) belongs to a different PLMN, the procedures
of the message exchanging are needed to be studied. This gap applies to all of
the four message scenarios.
## 5.18 Key Issue 18: Roaming
### 5.18.1 Description
The requirement of MSGin5G Roaming listed below is specified in clause 8.2 of
3GPP TS 22.262 [2].
[R-8.2-001] The MSGin5G Service shall support a roaming UE sending and
receiving messages.
There are multiple options for MSGin5G roaming when UE moves from home PLMN to
visited PLMN:
\- The MSGin5G service is always provided by the home PLMN.
\- The MSGin5G service is provided by the visited PLMN if MSGin5G service is
supported by the visited PLMN, otherwise the MSGin5G service is provided by
the home PLMN.
Different option may have different application architecture requirements.
Issues include:
\- How to provide MSGin5G service when the UE is roaming, i.e. which option
listed above is suitable to be chosen.
\- Whether network architectures of different roaming scenario (i.e. local
breakout and home routed) affect MSGin5G services.
\- Whether MSGin5G Roaming is needed to be supported by the network layer. How
the network layer supports MSGin5G Roaming.
\- Whether some requirements, e.g. end-to-end delay specified in [R-5.1.2-001]
of 3GPP TS 22.262 [2] and network triggering specified in [R-5.1.2-006] of
3GPP TS 22.262 [2], can be fulfilled in roaming scenario.
### 5.18.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- Application layer architecture to support roaming of MSGin5G UEs and the
related procedures for roaming UEs are needed to be studied.
\- If MSGin5G Roaming is needed to be supported by the network layer, the
potential impacts to on 5G system are needed to be studied.
## 5.19 Key Issue 19: Efficient resource usage of the control plane and user
plane
### 5.19.1 Description
The typical IoT device communication is sending and receiving small data which
can be delivered just in a message. The characteristics of Massive Internet of
Things (MIoT) devices including high density connection, flexible mobility,
saving power, limited computing capability, bulk of devices, and traffic
pattern of short burst of small data brings various new demands on message
communication, e.g. light weight message communication for provision and
monitoring, ultra low latency and high reliability message communication for
remote control, and extremely high resource efficiency for large scale
connections. The MSGin5G Service is basically designed and optimized for
massive IoT device communication including thing-to-thing communication and
person-to-thing communication.
Following requirement is described in 3GPP TS 22.262 [2].
Considering the massive connections of IoT devices and high throughput of
message communication between devices or between devices and application
servers, the MSGin5G Service needs to be in a resource efficient manner to
optimize the resource usage of the both control plane and user plane.
Following generic requirement is also specified in 3GPP TS 22.262 [2].
The IoT devices usually have limitation in computation and storage, and are
powered by batteries or small solar photovoltaic equipment, so the message
communications need to be light weight and well scheduled in order to save
power and data traffic consumption in the device.
The following conclusion can be made based on the requirements above:
> \- There is extremely high number of message exchange between devices or
> between devices and application servers.
>
> \- The typical IoT device communication is sending and receiving small data
> which can be delivered just in a message.
>
> \- The requirement applies to all type of message communication models.
>
> \- The communication needs to be well scheduled in order to save power and
> data traffic consumption in the device.
In principle, the MSGin5G Service needs to enable optimization of the resource
usage for both the control plane and user plane in a resource efficient
manner.
Issues include:
> \- How to make MSGin5G communication resource efficient to optimize the
> resource usage of both the control plane and user plane?
>
> \- What scheduling policy needs to be followed in order to make sure that
> application server is not overloaded with messages at particular time?
>
> \- How MSGin5G service can support distributing the scheduling policy to
> application client?
>
> \- How to efficiently use resources for sending and receiving of typical
> small data?
### 5.19.2 Identified Gaps
The following gaps have been identified to fulfil the efficient resource usage
of the control plane and user plane requirements:
> \- Mechanisms to support small data message exchange in a resource efficient
> manner.
>
> \- Determining scheduling policy and making it available to MSGin5G client.
>
> \- The behavior on MSGin5G client for using resource efficiently and the
> related procedures are needed to be studied.
## 5.20 Key Issue 20: Obtain Contact Information
### 5.20.1 Description
In all message scenarios, a message sender may send messages to receiver(s),
e.g. other UE(s), a group or an application server, only if the sender knows
the contact information of the receiver(s). In person to person messaging,
e.g. person to person SMS, the sender can input the contact information, i.e.
MSISDN, of the receiver, or selects a receiver from address book. But in MIoT
scenario, many senders may have limitation on abilities; the mechanism in
person to person messaging may not work. It is necessary to define a new
mechanism for message sender in MSGin5G service to obtain contact information.
Issues include:
\- How to obtain the contact information of the other party in each messaging
scenarios. The other party includes MSGin5G Client, legacy-3GPP Client,
Non-3GPP Client, Application Server, MSGin5G Group and Broadcast Message
receivers.
\- Whether different procedures for different scenarios are needed, e.g.
procedure for ability limited sender and procedure for more intelligent
sender.
\- How to maintain the contact information of receivers on the sender side.
\- How to update the contact information of the other party on the sender
side.
### 5.20.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- The procedure for each kinds of sender to obtain the contact information of
the other party is needed to be studied. The sender includes MSGin5G Client
and Application Server.
\- The procedures of contact information maintenance are needed to be studied.
## 5.21 Key Issue 21: Study if IMS is feasible as a solution
### 5.21.1 Description
IMS, IP Multimedia Subsystem, is a framework of all-IP architecture developed
by 3GPP to support both real-time and non real-time services. It is built on
top of the 3GPP packet core network that brings the power and wealth of IP
based service to the mobile communication world. IMS provides two fundamental
importance to deliver vertical services in 3GPP network:
1\. IP based transport for both real-time and non real-time services.
2\. Introduction of a multimedia call model based on IETF SIP (Session
initiation Protocol).
IMS is access independent and consists of IP routers. On top of the IP
transport, IMS supports session control layer that is based on the IETF SIP
protocols. IMS supports endpoint registration and routing of SIP signalling
messages to the application server related to a specific service. IMS
application layer utilizes the application and content servers to provide
various value-added services.
IMS has been successfully deployed in many of the MNOs today supporting
variety of vertical services such as RCS and Mission Critical services. The
Mission Critical Data service, based on IMS, is developed in SA6 that supports
many key messaging features described in TS 22.262 [2]. It is obvious that IMS
can be considered as a candidate also to provide application layer solution
for the MSGin5G service but there are requirements in TS 22.262 [2] that will
need further investigation with regarding to using IMS such as:
1\. Support for Non-IP Data Delivery (NIDD) mechanism.
2\. Application server originated and terminated MSGin5G messages.
3\. Efficient message delivery to power limited and sensitive IoT devices.
4\. Message segmentation when the message payload exceeds certain size limit.
5\. Support of MSGin5G service stringent KPIs (i.e. end to end message
delivery in less than 500ms, light weight message, Ultra low latency and high
reliability message, Extremely high resource efficiency for large scale
connections, Scheduled communication in order to save power and data traffic
consumption, Light weight security mechanism).
6\. Support of the store and forward capability when the recipient endpoint is
not available.
7\. Support of network triggering to a UE for certain actions.
### 5.21.2 Identified Gaps
The following gaps regarding IMS as an application layer solution are
identified:
1\. How IMS supports non-IP data delivery endpoints.
2\. If IMS solution can meet the KPI stated in TS 22.262[2]:
a. Light weight message communication for provisioning and monitoring;
b. Ultra-low latency and high reliability message communication for remote
control;
c. Extremely high resource efficiency for large scale connections;
d. Scheduled communication in order to save power and data traffic consumption
in the device;
e. Light weight security mechanism.
3\. How IMS supports UE to Application server messaging and Application to UE
messaging.
4\. How IMS supports message segmentation.
5\. How IMS supports message store and forward when the receiving endpoint is
not available.
6\. Can IMS services be accessed without USIM?
## 5.22 Key Issue 22: MSGin5G Service Exposure of multiple delivery mechanisms
to the applications
### 5.22.1 Description
The MSGin5G Service has been specified in TS 22.262 to use \"enhancements and
optimizations on the 3GPP network capabilities to facilitate IoT applications
including device triggering, small data transfer, and Non IP Data Delivery
(NIDD) etc.\". In addition, specific requirements address the need to
interwork with legacy message delivery mechanisms such as SMS and to support
broadcast.
The MSGin5G Service provides support for MSGin5G message delivery by enabling
routing based on MSGin5G service ID. In addition, the MSGin5G Service needs to
support methods of exposing the capabilities of the various delivery
mechanisms, without burdening applications with the need to provide management
of these methods and without 5GS API exposure to the Application
Servers/Clients.
The following related issues are identified:
\- how the MSGin5G Service can enable the use of multiple delivery mechanisms
without exposing unnecessary 5GS information to the applications.
\- how of the MSGin5G Service enables MSGin5G message delivery for each
delivery mechanism, in addition to routing based on MSGin5G service ID
\- what information is necessary to be provided by applications to the MSGin5G
Service in order to utilize the capability of supporting multiple delivery
mechanisms
\- what information is required by the MSGin5G Service from the 3GPP System to
in order to enable the use of multiple delivery mechanisms
### 5.22.2 Identified Gaps
The following gaps have been identified to fulfill the store-and-forwarding of
MSGin5G messages.
\- MSGin5G Service mechanisms enabling Application Servers and Clients to use
various delivery mechanism options without direct 5GS API exposure to the
Application Servers/Clients
\- The capability for a MSGin5G Service to determine which delivery mechanisms
are available for the target recipient based on information received from the
3GPP System and applications.
\- Procedures detailing how the MSGin5G Service uses each of the delivery
mechanisms available for MSGin5G message delivery in the 3GPP System can be
employed to deliver MSGin5G messages.
## 5.23 Key Issue 23: Message delivery from Legacy 3GPP UE
### 5.23.1 Description
A Legacy 3GPP UE may deliver messages to a MSGin5G UE. i.e. MSGin5G service
needs to support the message delivery from a Legacy 3GPP UE to the MSGin5G
server and to the MSGin5G endpoint, including MSGin5G UE, MSGin5G Group or the
Application Server.
Issues include:
\- How to deliver messages from Legacy 3GPP UE (e.g. SMS, NIDD) to the MSGin5G
endpoint?
\- Who would translate a legacy 3GPP message (e.g. SMS, NIDD) to a MSGin5G
message?
\- How to address a MSGin5G endpoint in the application layer architecture by
the Legacy 3GPP UEs so that a message payload can be sent?
### 5.23.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- The architecture and the procedure for message delivery from Legacy 3GPP UE
to the MSGin5G endpoint, including MSGin5G UE, MSGin5G group or the
Application Server.
## 5.24 Key Issue 24: Capabilities of UE without MSGin5G client
### 5.24.1 Description
#### 5.24.1.1 UE types
This key issue studies capabilities of a UE that does not support a MSGin5G
client.
For the purpose of the key issue all UEs that are part of the application
service support an Application client or a native legacy client and these
clients use the MSGin5G service to exchange messages (i.e. payload).
As shown in figure 5.24.1-1, a UE supports an Application client or a legacy
client and may also support a MSGin5G client. A UE that supports a MSGin5G
client supports all functionality that will be specified for the MSGin5G
service (MSGin5G UE). The present key issue studies what functionality can be
supported by a UE that does not support a MSGin5G client (legacy UE).
Figure 5.24.1-1: UE types
#### 5.24.1.2 Legacy UEs that support Cell Broadcast
A legacy UE that supports Cell Broadcast can only receive the payload and any
other IEs such as Sender ID or Delivery Status cannot be supported. If the
recipient UE requires such IEs then these IEs could be sent as part of the
payload at the application layer, but the payload is out of scope. Cell
Broadcast is downlink-only, hence such a legacy UE can only be a terminating
UE. Message segmentation and reassembly is provided by the Cell Broadcast
service but cannot be supported at the MSGin5G layer due to the lack of a
MSGin5G client.
NOTE: A legacy UE can only receive the payload IE from the MSGin5G message via
Cell Broadcast.
#### 5.24.1.3 Legacy UEs that support SMS
A legacy UE that supports SMS can send payload to a recipient which is
identified by an MSISDN. Since the SMSC needs to deliver the SMS payload to
the legacy 3GPP Message Gateway, the final recipient of the payload cannot be
identified in the MSGin5G service. Only if the legacy UE knows the MSISDN of
the final recipient can the payload be sent, but this bypasses the MSGin5G
service.
NOTE 1: A legacy UE cannot initiate sending an unsolicited message to another
UE via SMS in the MSGin5G service, unless a recipient ID of the final
destination (e.g. Application server) is pre-coded in the legacy 3GPP Message
Gateway.
NOTE 2: The above conclusion applies to sending unsolicited messages and not
to solicited messages in a response to reception of earlier received SMS
payload.
A legacy UE that supports SMS can receive the payload and the MSISDN of the
sender, but other IEs cannot be supported. If the recipient UE requires such
IEs then these IEs could be sent as part of the payload at the application
layer, but the payload is out of scope. The MSISDN of the sender may be the
MSISDN of the legacy 3GPP Message Gateway or of the sending UE if the legacy
3GPP Message Gateway maps (spoofs) sender ID to the MSISDN of the sender UE.
NOTE 3: SMS supports the delivery status request, and this request is
delivered to the UE and responded to by the UE to the SMSC. However, the
delivery status request IE is not delivered to the Application client.
NOTE 4: A legacy UE can receive the payload IE and the sender ID (as MSISDN).
#### 5.24.1.4 Legacy UEs that support NIDD
A legacy UE that supports NIDD can exchange messages via the Legacy 3GPP
Message Gateway. The Legacy 3GPP Message Gateway maps the External Identifier
or MSISDN of the UE to the identifiers necessary for MSGin5G routing and
performs the NIDD Configuration and NIDD data delivery procedures as described
in TS 23.682 [3] clause 5.13.
### 5.24.2 Identified Gaps
None.
## 5.25 Key Issue 25: deliver message to Application Client
### 5.25.1 Description
The requirement of deliver message to specific Application Client listed below
is specified in [R-5.1.2-003] of 3GPP TS 22.262 [2].
[R-5.1.2-003] The MSGin5G Service shall support delivery of a message to a
specific application in the terminated UE. This message contains the contents
that can be handled by the specific application.
It is assume that each specific application is handled by a specific
Application Client in the terminated UE. Multiple Application Clients may be
hosted in the terminated UE. Meanwhile, the terminated UE may or may not
support a MSGin5G client.
Issues include:
\- How to enable the MSGin5G client to route MSGin5G messages to the specific
Application Client, especially when Application ID is not included in the
message (i.e. Application ID is not known by the sender) or Application ID of
the Application Client is not known by the MSGin5G client in the terminated UE
\- If MSGin5G client is not supported by the terminated UE, how to deliver the
received message to the specific Application Client hosted in the terminated
UE.
,- If the message can not be delivered to the MSGin5G client but can be
delivered to the Legacy-3GPP Client (e.g. the terminated UE loses data
connection), how to deliver the received message to the specific Application
Client hosted in the terminated UE.
### 5.25.2 Identified Gaps
The following gaps have been identified to fulfil the identified requirements:
\- The Application Clients configuration procedure which enables the MSGin5G
Client to route MSGin5G messages to Application Clients is needed to be
studied.
\- If MSGin5G client is not supported by the terminated UE, or the message can
not be delivered to the MSGin5G client but can be delivered to the
Legacy-3GPP/non-3GPP Client, whether it is possible to deliver the message to
the Application Client is needed to be studied. If the message can be
delivered to the Application Client, the related procedure of message delivery
is needed to be studied.
## 5.26 Key issue 26 -- Capability exposure to Application Server using CAPIF
MSGin5G server provides service APIs to its typical consumer Application
Server, the Application Server can invoke the MSGin5G server service APIs
directly by local configuration which has the API end point.
The CAPIF as specified 3GPP TS 23.222 [13] provides a common API framework for
3GPP northbound APIs. Since MSGin5G server offers capabilities to Application
Servers, the MSGin5G server can be treated as an entity providing 3GPP
northbound API as well.
Therefore, this study will need to address how to support the Application
Server to access the MSGin5G server service API by using CAPIF.
NOTE: Consumers of MSGin5G server APIs other than Application Server is out of
scope of the present document and could be potentially specified during the
normative phase.
# 6 Solutions
## 6.1 Solution 1: Payload size of 2048 octets in Broadcast
### 6.1.1 Description
3GPP TS 23.041 [6] specifies in subclause 9.3.51 the maximum payload for the
CB Data element to be 1230 octets. The payload consists of N pages of 82
octets each and N is equal to 15 or less.
By allowing N to be 25 or less, the maximum payload can be increased to 2050
octets.
### 6.1.2 Impacts on existing nodes and functionality
There is no backwards compatibility with this solution. The CBCF, the gNodeBs
and the UEs will need to support a maximum of 25 pages of CB Data instead of
the 15 as they do now.
### 6.1.3 Solution evaluation
SA1 has indicated in its reply-LS that \"_the value [2048] is an example value
which was chosen as the upper limit of the payloads to be supported by 5GMSG
Service\"._ Therefore, the maximum value of 1230 octets that is currently
supported is adequate and Cell Broadcast, as specified in 3GPP TS 23.041 [6]
can be used in broadcast message scenarios.
## 6.2 Solution 2: Registering MSGin5G Client to MSGin5G Server
### 6.2.1 Description
#### 6.2.1.1 General
This solution describes how the MSGin5G server identifies a UE and the
Application Clients on the UE that interact with the MSGin5G service. This
solution addresses the following open issue/gap under Key Issue #3.
\- How to uniquely identify a UE in MSGin5G service, the UE may include
MSGin5G UE s, Legacy 3GPP UEs and non-3GPP UEs.
\- If the identifier(s) of UE is assigned by MSGin5G server, the procedure of
generating, assigning and managing the identifier(s) are needed to be defined.
The solution introduces a registration procedure for a MSGin5G Client to
register with a MSGin5G Server. The procedure is used to create a new, or
update an existing, registration. The procedure is also used to provide the
MSGin5G Client with a unique identifier that is assigned by the MSGin5G
Server. During registration, the MSGin5G Client provides profile/availability
information for the MSGin5G Client and the Application Clients that are
serviced by the MSGin5G Client to the MSGin5G Server. The profile/availability
information includes contact information such as UE Identifier(s) and port
number(s) which the MSGin5G Client and the Application Clients listen on for
incoming MSGin5G messages, supported MSGin5G capabilities (e.g. MOMT, AOMT,
MOAT, Group, Broadcast) and MSGin5G service requirements (e.g. required time
windows of service, message latency and data rates). The MSGin5G Server
validates the profile information to determine whether the MSGin5G
requirements specified in the profiles can be fulfilled. The MSGin5G Server
also stores the profile information such that this information can be later
used by the MSGin5G Server to deliver MSGin5G messages to/from the MSGin5G
Client and Application Clients.
The solution also introduces a MSGin5G Client de-registration procedure. This
procedure is used by a MSGin5G Client to de-register from an MSGin5G Server.
#### 6.2.1.2 MSGin5G Client Registration
The signalling flow for MSGin5G Client registration is illustrated in figure
6.2.1.2-1. The solution assumes that the MSGin5G Client is responsible for
triggering the registration to the MSGin5G Server.
NOTE 1: The trigger for registering is based on application service logic and
is out of scope of this specification.
Pre-conditions:
1\. The UE on which the MSGin5G Client resides is connected to an access
network that provides connectivity to the MSGin5G Server.
2\. The MSGin5G Client has been configured with the MSGin5G Server Identity.
3\. The MSGin5G Client has been configured with the address (e.g. URI) of the
MSGin5G Server.
4\. Both the MSGin5G Client and MSGin5G Server have been configured with the
necessary credentials to enable authenticating one another.
NOTE 2: The structure and definition of the credentials required by the
MSGin5G Client and MSGin5G Server to authenticate are left for SA3 to define.
Figure 6.2.1.2-1: MSGin5G Client registration
1\. The MSGin5G Client sends a MSGin5G Client registration request (MSGin5G
Client Profile) to the MSGin5G Server. The request includes security
credentials required for the MSGin5G Client to register to the MSGin5G Server.
The request also includes a MSGin5G Client Profile for the MSGin5G Client
initiating the registration request. The MSGin5G Client Profile includes the
information listed in Table 6.2.1.2-1.
Table 6.2.1.2-1: MSGin5G Client Profile
Information element Status Description
* * *
UE ID M Identity of the UE hosting the MSGin5G Client (e.g. the External
Identifier defined in TS 23.682 [19], or an MSISDN) MSGin5G Client Ports M
List of port numbers that the MSGin5G Client listens on for messages (e.g.
device triggers) from the MSGin5G Server and that target the MSGin5G Client.
Also included with each port number is an associated protocol (e.g. SMS, NIDD,
etc.). MSGin5G Client ID O MSGin5G Client identifier assigned to the MSGin5G
Client by the MSGin5G Server upon initial registration. MSGin5G Client
Capabilities O A list of the MSGin5G capabilities supported by the MSGin5G
Client (e.g. MOMT, AOMT, MOAT, Group, Broadcast) MSGin5G Client Availability O
Availability information (availability status indicator, schedule, etc. e.g.
based on the Maximum Response Time, Active Time, periodic TAU/RAU Timer [19])
of the MSGin5G Client to receive MSGin5G messages.
2\. Upon receiving the request from the MSGin5G Client, the MSGin5G Server
validates the registration request and verifies the security credentials. The
MSGin5G Server also checks if a MSGin5G Client ID is present within the
MSGin5G Client Profile of the request to determine if the request is a new
registration or an update to an existing registration. A registration update
may be used to send a new or updated MSGin5G Client Profile to the MSGin5G
Server. The MSGin5G Server also checks if the MSGin5G Client Capabilities are
compatible with its own MSGin5G Server Capabilities.
3\. The MSGin5G Server sends a MSGin5G Client registration response to the
MSGin5G Client. If the registration is a new registration, the MSGin5G Server
assigns a unique MSGin5G Client ID to the MSGin5G Client and returns it in the
response. The MSGin5G Client stores the identifier and uses it in all future
MSGin5G communication with the MSGin5G Server. If the MSGin5G Server is not
able to fulfil, or provide, the MSGin5G services that are indicated within the
MSGin5G Client Profile, then the MSGin5G Server will indicate this in the
MSGin5G Client registration response. If the registration is successful, the
MSGin5G Server stores the profile information such that this information can
be later used by the MSGin5G Server to deliver MSGin5G messages to/from the
MSGin5G Client and Application Clients.
#### 6.2.1.3 MSGin5G Client De-Registration
By de-registering, the MSGin5G Client informs the MSGin5G Server that it is no
longer available to send or receive MSGin5G messages to or from the MSGin5G
Server and wishes to terminate its association with the MSGin5G Server.
The procedure assumes that the MSGin5G Client is responsible for triggering
the de-registration from the MSGin5G Server.
NOTE: The trigger condition for de-registering is based on application service
logic and is out of scope of this specification.
The signalling flow for MSGin5G Client de-registration is illustrated in
figure 6.2.1.3-1.
Pre-conditions:
1\. The MSGin5G Client is registered to the MSGin5G Server.
Figure 6.2.1.3-1: MSGin5G Client De-registration
1\. The MSGin5G Client determines that de-registration from the MSGin5G Server
is needed (e.g. the UE powering down).
2\. The MSGin5G Client sends a De-registration Request to the MSGin5G Server
that includes the MSGin5G Client ID of the MSGin5G Client.
3\. The MSGin5G Server deletes any applicable MSGin5G Client Profile
information that it has stored and replies to the MSGin5G Client with a De-
registration Response.
### 6.2.2 Impacts on existing nodes and functionality
There is no backwards compatibility with this solution.
### 6.2.3 Solution evaluation
This solution allows a MSGin5G Client to register to a MSGin5G Server. The
solution enables a MSGin5G Server to assign a unique identity to a MSGin5G
Client and to validate whether MSGin5G capabilities of the MSGin5G Client are
compatible with MSGin5G capabilities of the MSGin5G Server. The solution
enables a 5GSMSG Client to share contact information (e.g. UE identifiers and
port numbers) with a MSGin5G Server. This solution is suitable for the
constrained devices. This solution is also suitable for the device acting as a
UE Message gateway to the constrained device. This solution is useful when
device is not aware of its own MSGin5G service ID.
## 6.3 Solution 3: MSGin5G Triggering
### 6.3.1 Description
#### 6.3.1.1 General
This solution addresses the identified gap under Key Issue #4 regarding
specification of a MSGin5G trigger procedure.
The solution introduces a procedure that allows a MSGin5G Server to initiate a
MSGin5G trigger to a UE that targets either a MSGin5G Client or Application
Client on the UE. Within the MSGin5G trigger request, a MSGin5G trigger
payload is defined that includes informational elements such as the purpose of
the trigger so that trigger actions can be performed by the targeted MSGin5G
Client or Application Client on the UE. The procedure is agnostic to access
network technologies and can be used over top of 3GPP as well as non-3GPP
access networks.
#### 6.3.1.2 MSGin5G Triggering
Figure 6.3.1.2-1 shows the MSGin5G triggering procedure.
Pre-conditions:
1\. A UE hosts a MSGin5G Client and/or Application Specific Client which are
supported by the MSGin5G service.
2\. The MSGin5G Client registers with the MSGin5G Server and shares UE contact
information (e.g. UE access network identifier and port number(s)).
Alternatively, the MSGin5G Server may be provisioned with the contact
information (e.g. for UEs that do not host a MSGin5G Client and cannot
register to a MSGin5G Server).
3\. At a later time, the UE becomes unreachable by the MSGin5G Server.
Figure 6.3.1.2-1: MSGin5G Triggering Procedure
1\. An Application Server initiates a request to a MSGin5G Server to send a
MSGin5G message to a targeted MSGin5G client or Application Client on a UE.
2\. The MSGin5G Server determines that the UE is not reachable at this time
and sends a trigger request to the UE. For example, if a MSGin5G Server
detects that the UE does not have an access network connection and the MSGin5G
Server needs to send a MSGin5G message to the UE, then the MSGin5G Server
sends a MSGin5G trigger to the UE to have it establish an access network
connection. This trigger is initiated as a result of a MSGin5G request
received from an Application Server that targets an Application Client on a
UE. Alternatively, a MSGin5G Server initiates a trigger to a UE independent of
receiving a MSGin5G request from an Application Server.
If the UE is reachable then the trigger request is not required and the
MSGin5G Server sends the MSGin5G message to the UE as requested by the
Application Server.
3\. The MSGin5G Server determines the access network (e.g. 3GPP, etc.) and the
access network message delivery method (e.g. SMS, NIDD, etc.) to deliver the
trigger request to the targeted UE. To make this determination, the MSGin5G
Server can rely on information provided to the MSGin5G Server by the MSGin5G
Client of the targeted UE during the MSGin5G Client registration procedure.
Alternatively, the MSGin5G Server can rely on information for the targeted UE
that is provisioned into the MSGin5G Server.
4\. The MSGin5G Server sends a MSGin5G trigger request to the targeted UE
which includes the information in Table 6.3.1.2-1. The MSGin5G Server embeds
the MSGin5G trigger request information within an access network trigger
request (e.g. an SMS trigger). For example, the MSGin5G Server configures the
destination address of the access network trigger request with the UE
Identifier of the targeted UE. The MSGin5G Server configures the destination
port of the access network trigger request with the MSGin5G Client Port if the
UE supports a MSGin5G Client or an Application Client Port if the UE does not
support a MSGin5G Client. The MSGin5G server embeds the Trigger Purpose within
the payload of the access network trigger request.
NOTE 1: The details of how a MSGin5G Server maps the information within a
MSGin5G trigger request to an access network trigger request is dependent on
the type of access network and is out of scope of this study.
Table 6.3.1.2-1: MSGin5G Trigger Request
+---------------------+--------+-------------------------------------+ | Information element | Status | Description | +=====================+========+=====================================+ | UE Identifier | M | The identifier of the UE (e.g. 3GPP | | | | External Identifier, non-3GPP | | | | device identifier, IMSI, etc.) | +---------------------+--------+-------------------------------------+ | Client Port | O | The port number that the MSGin5G | | | | Client or Application Client is | | | | listening on to receive trigger | | | | requests. | +---------------------+--------+-------------------------------------+ | Trigger Purpose | M | Specifies the purpose of the | | | | trigger request. | | | | | | | | - For a MSGin5G Client or | | | | Application Client on the UE to | | | | establish an access network | | | | connection | | | | | | | | - For a MSGin5G Client on the UE | | | | to register to the MSGin5G Server | | | | | | | | - For an Application Client on the | | | | UE to be available for a period of | | | | time to receive a request from an | | | | Application Server | +---------------------+--------+-------------------------------------+ | Trigger Info | M | Access Network specific information | | | | used to deliver the trigger payload | | | | information, e.g. reference number, | | | | validity period etc. | +---------------------+--------+-------------------------------------+
5\. The access network delivers the trigger request to the targeted UE.
NOTE 2: The access network trigger delivery procedures are out of scope of
this study.
6\. The MSGin5G Server receives a response from the access network indicating
the success or failure status of the request. The type of status indication
provided depends on the capabilities of the access network mechanism used.
7\. The targeted MSGin5G Client and/or Application Client on the UE listens on
its respective port number and receives the access network trigger request.
The targeted MSGin5G Client and/or Application Client parses the payload of
the access network trigger request which contains the Trigger Purpose.
Based on the Trigger Purpose, the targeted MSGin5G Client or Application
Client performs the corresponding actions (e.g. establish access network
connectivity, update Application Server with Application Client\'s contact
information, etc).
### 6.3.2 Impacts on existing nodes and functionality
This solution leverages existing access network triggering functionality and
defines a MSGin5G trigger procedure that overlays on top of them, hence there
is no backwards compatibility issues or impact with this solution.
### 6.3.3 Solution evaluation
The solution defines a MSGin5G trigger procedure that is agnostic to access
network technologies and can be used over top of 3GPP as well as non-3GPP
access networks should be defined. This enables the MSGin5G Service to trigger
3GPP as well as non-3GPP devices if/when required.
## 6.4 Solution 4: Group management using SEAL
### 6.4.1 General
The following solution corresponds to the key issue #8 describing the group
management using the procedures in SEAL TS 23.434 [9].
### 6.4.2 Solution description for establishing a group
The solution in SEAL TS 23.434 [9] subclause 10.3.3 is used for group creation
in MSGin5G Service. The MSGin5G Client (or the Application Server) interacts
with the Group management client of the SEAL group management service and the
MSGin5G Server interacts with the Group management server of the SEAL group
management service specified in 3GPP TS 23.434 [9].
### 6.4.3 Solution description for adding UEs to the group or removing UEs
from the group
The solution in SEAL TS 23.434[9] subclause 10.3.5.2 is used for adding UEs to
the group or removing UEs from the group in MSGin5G Service. The MSGin5G
Client (or the Application Server) interacts with the Group management client
of the SEAL group management service and the MSGin5G Server interacts with the
Group management server of the SEAL group management service specified in 3GPP
TS 23.434 [9].
### 6.4.4 Solution description for configuration of a maximum number of
members in a group
The solution in SEAL TS 23.434[9] subclause 10.3.6.1 is used for configuration
of a maximum number of members in a group in MSGin5G Service. The MSGin5G
Client (or the Application Server) interacts with the Group management client
of the SEAL group management service and the MSGin5G Server interacts with the
Group management server of the SEAL group management service specified in 3GPP
TS 23.434 [9].
### 6.4.5 Solution description for group notification interworking using SEAL
Figure 6.4.5-1 below illustrates MSGin5G Server (VAL server) sending the group
notification towards the Message Gateways (the Legacy 3GPP Message Gateway or
the non-3GPP Message Gateway or both) in order to notify the UEs (who are
members of the created group) which do not support SEAL client (Group
management client). In this procedure, the group notification is handled by
MWGin5G Server, when the group management is using SEAL as specified in 3GPP
TS 23.434 [9].
Pre-conditions:
1) MSGin5G Server interacts with SEAL Server using the procedures over SEAL-S
reference point as specified in 3GPP TS 23.434 [9].
2) MSGin5G Server is aware of the legacy 3GPP message client (e.g. SMS client)
in legacy 3GPP UE and interacts with it via Legacy 3GPP Message Gateway.
3) MSGin5G Server is aware of the Non-3GPP message client in Non-3GPP UE and
interacts with it via Non-3GPP Message Gateway.
4) The group creation notification includes identities belonging to different
types of UEs i.e. MSGin5G UE, Legacy 3GPP UE and Non-3GPP UE.
5) Legacy 3GPP Message Gateway and Non-3GPP Message Gateway does not support
SEAL group management functionality.
Figure 6.4.5-1: Group notification in MSGin5G service
1) The SEAL Server (Group management server) sends a group creation
notification message to the MSGin5G Server including the list of identities
belonging to different types of UEs i.e. MSGin5G UE, Legacy 3GPP UE and
Non-3GPP UE. The information elements defined in table 10.3.2.3-1 specified in
3GPP TS 23.434 [9] are included in the message.
2) The MSGin5G server (VAL server) determines whether the received group
creation notification message has list of identities that belong to Legacy
3GPP UEs or Non-3GPP UEs or both i.e. MSGin5G server analyses the registration
status of the members in the received identity list and determines if it is to
be routed to a Legacy 3GPP UE or Non-3GPP UEs or both and that a group
notification message should be sent to those UEs.
3) Upon determining in Step 2) that the group notification message should be
sent to Legacy 3GPP UEs:
3a) The MSGin5G Server initiates the group notification message to the legacy
3GPP Message Gateway for delivery. The information elements defined in Table
6.4.5-1 are included in the request.
Table 6.4.5-1: group notification to Legacy 3GPP UEs
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | MSGin5G Server Address | M | The address of the MSGin5G | | | | server sending the message. | +-----------------------------+--------+-----------------------------+ | List of MSGin5G service | M | The service identity of the | | ID(s) | | recipient Legacy 3GPP UE(s) | | | | where the notification is | | | | to be sent. (NOTE 1) | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of this | | | | message | +-----------------------------+--------+-----------------------------+ | Application ID | O | Identifies the application | | | | for which the payload is | | | | intended. | +-----------------------------+--------+-----------------------------+ | Group ID | M | Payload of the message | | | | containing VAL group ID | | | | that was created | +-----------------------------+--------+-----------------------------+ | List of members | M | List of VAL user IDs or VAL | | | | UE IDs that are part of the | | | | created group | +-----------------------------+--------+-----------------------------+ | Group Configuration | M | Group configuration | | | | information (NOTE 2) | +-----------------------------+--------+-----------------------------+ | NOTE 1: List of MSGin5G | | | | service ID(s) could be one | | | | or more. | | | | | | | | NOTE 2: Group configuration | | | | information can be obtained | | | | independently by MSGin5G | | | | Server (VAL server) | | | | according to subclause | | | | 10.3.6.2 specified in | | | | 3GPP TS 23.434 [9]. | | | +-----------------------------+--------+-----------------------------+
3b) The legacy 3GPP Message Gateway translates the group notification message
to a legacy 3GPP message and sends it to the legacy 3GPP message client
according the procedures in TS 23.204 or the procedure in clause 4.13.3 of TS
23.502. This step is outside the scope of the current specification.
NOTE: Whether or not to include, group members and group configuration
information towards the Legacy 3GPP UE is outside the scope of the current
specification.
4) Upon determining in Step 2) that the group notification message should be
sent to Non-3GPP UEs:
4a) The MSGin5G Server initiates the group notification message to the
Non-3GPP Message Gateway for delivery. The information elements defined in
Table 6.4.5-2 are included in the request.
Table 6.4.5-2: group notification to Non-3GPP UEs
Information element Status Description
* * *
MSGin5G Server Address M The address of the MSGin5G server sending the
message. MSGin5G service ID M The service identity of the recipient Non-3GPP
UEs where the notification is to be sent. Message ID M Unique identifier of
this message Application ID O Identifies the application for which the payload
is intended. Group ID M Payload of the message containing VAL group ID that
was created List of members M List of VAL user IDs or VAL UE IDs that are part
of the created group Group Configuration O Group configuration information
(NOTE) NOTE: Group configuration information can be obtained independently by
MSGin5G Server (VAL server) according to subclause 10.3.6.2 specified in 3GPP
TS 23.434 [9].
4b) The Non-3GPP Message Gateway translates the group notification message to
a Non-3GPP message and sends it to the Non-3GPP message client. This step is
outside the scope of the current specification.
### 6.4.6 Solution description for SEAL enhancements to group notification
interworking
The solution in SEAL TS 23.434 [9] subclause 10.3.3 is necessary to be
enhanced for group management in MSGin5G Service for supporting group
management interworking with the Message Gateway. The enhancement is required
for both the types of Message Gateways used to deliver MSGin5G messages to
different UE types: the Legacy 3GPP Message Gateway and the non-3GPP Message
Gateway.
The MSGin5G Client (or the Application Server) interacts with the Group
management client of the SEAL group management service and the MSGin5G Server
interacts with the Group management server of the SEAL group management
service specified in 3GPP TS 23.434 [9].
Figure 6.4.5-1 below illustrates the group creation operations by authorized
VAL user/UE/administrator to create a group. It applies to the scenario of
normal group creation by a VAL administrator or by authorized user/UE. Further
the identity list that is part of the group to be created may contain the list
of VAL user IDs or VAL UE IDs which does not have group management client on
the UE (e.g. legacy UEs).
Pre-conditions:
1\. The group management client, group management server, VAL server and the
VAL group members belong to the same VAL system.
2\. The authorized VAL user/UE/administrator is aware of the users\'
identities which will be combined to form the VAL group.
3\. Identity list that is part of the group to be created may contain the list
of VAL user IDs or VAL UE IDs which does not have group management client on
the UE (e.g. legacy UEs).
Figure 6.4.6-1: Figure 10.3.3-1 in SEAL TS 23.434 [9] subclause 10.3.3
1\. The group management client of the authorized VAL user/UE/administrator
requests group create operation to the group management server. The identities
of the users or UEs being combined and the information of the VAL services
that are enabled on the group shall be included in this message.
2\. During the group creation, the group management server creates and stores
the information of the group. The group management server performs the check
on the policies e.g. maximum limit of the total number of VAL group members
for the VAL group(s).
NOTE: The exact policies are out of scope of the present document.
3\. The group management server may conditionally notify the VAL server
regarding the group creation with the information of the group members. When
the identity list with the list of VAL user IDs or VAL UE IDs that are part of
the created group contain the list of VAL user IDs or VAL UE IDs which does
not have group management client on the UE (e.g. Legacy UEs or Non-3GPP UEs),
it is responsibility of the VAL server to initiate the group creation
notification towards those UEs.4. The VAL group members of the VAL group are
notified about the newly created VAL group configuration data. Such
notification is sent to the VAL group members having group management client
and for the VAL group members not having group management client (e.g. Legacy
UEs or Non-3GPP UEs) the notification is sent as described in Step-3.
5\. The group management server provides a group creation response to the
group management client of the administrator/authorized VAL user/UE.
### 6.4.7 Solution description for group list fetch using SEAL
This solution addresses issues related to synchronization of group information
between UE and SEAL Group management server. As specified in KI#8, the UE may
be offline or in Power Saving Mode and may not be aware about newly created or
deleted MSGin5G groups in which the UE/User is a member. In this procedure,
the MSGin5G Client request to list of groups is handled by the SEAL client,
when the group management is using SEAL as specified in 3GPP TS 23.434 [9].
#### 6.4.7.1 Information Elements
##### 6.4.7.1.1 Group list fetch request
Table 6.4.7.1.1-1 describes the information flow for group list fetch request
from the SEAL Client (group management client) to the SEAL Server (group
management server).
Table 6.4.7.1.1-1: Group list fetch request
* * *
Information element Status Description Identity M The MSGin5G service ID (VAL
user or VAL UE) performing the operation. Period O Indicates to the group
management server to provide list of the groups created between specified
period.
* * *
##### 6.4.7.1.2 Group list fetch response
Table 6.4.7.1.2-1 describes the information flow for Group list fetch response
from the SEAL Server (group management server) to the SEAL Client (group
management client).
Table 6.4.7.1.2-1: Get group list fetch response
* * *
Information element Status Description Result M Result from the SEAL Server
(group management server) in response to group list fetch request indicating
success or failure MSGin5G service ID (VAL User ID) M The identity of the
MSGin5G service ID (VAL User) for whom this notification is targeted. Group
service ID (VAL group IDs) M The list of Group service ID (VAL groups) for
which the MSGin5G service ID (VAL User) is member
* * *
#### 6.4.7.2 Group List Fetch
Pre-conditions:
1) Group is previously defined on the SEAL Server (group management server)
including the list of users.
2) List of groups to which a MSGin5G service ID (VAL UE/ VAL User) belongs to
is known to the SEAL Server (group management server) for each of the MSGin5G
service ID (VAL UE/ VAL User).
3) MSGin5G service ID (VAL user) has not received group announcement message
as it was offline previously.
Figure 6.4.7.2-1: Group list fetch
1) The MSGin5G Client (VAL client) requests SEAL Client (group management
client) to provide the list of groups in which the MSGin5G service ID (VAL UE
or VAL User) is a member.
2) The SEAL Client (group management client) initiates the group list fetch
request towards the SEAL server (group management server). The information
elements described in clause 6.4.7.1.1 are included in the group list fetch
request.
3) The SEAL server (group management server) checks the authorization of group
list subscribe request and if authorized, sends the group list fetch response
containing list of groups in which the MSGin5G service ID (VAL user) is
member. The information elements described in clause 6.4.7.2.1 are included in
the group list fetch response.
4) The SEAL Client (group management client) notifies the list of groups to
the MSGin5G Client (VAL client).
### 6.4.8 Solution description for enhancements to control group notifications
The solution enhances the information flows specified in clause 10.3.2.14 and
clause 10.3.2.29 of 3GPP TS 23.434 [9] for the MSGin5G UE to control the
group.
The changes to clause 10.3.2.14 of 3GPP TS 23.434 [9] are highlighted in
**_bold italics_** as follows:
+----------------------------------------------------------------------+ | #### 10.3.2.22 Subscribe | | group configuration request {#subscribe-group-configuration-request} | | | | Table 10.3.2.22-1 describes the information flow subscribe group | | configuration request from the group management client to the group | | management server. | | | | Table 10.3.2.22-1: Subscribe group configuration request | | | | +-------------------------+---------+-------------------------+ | | | Information element | Status | Description | | | +=========================+=========+=========================+ | | | Requester Identity | M | The identity of the | | | | | | group management client | | | | | | performing the request. | | | +-------------------------+---------+-------------------------+ | | | VAL group ID | M | VAL group ID of the | | | | | | group | | | +-------------------------+---------+-------------------------+ | | | VAL services requested | O | Service(s) for which | | | | | | group configuration is | | | | (see NOTE) | | requested | | | +-------------------------+---------+-------------------------+ | | | **_Minimum time between |_** O** _|_** Defaults to 0 if | | | | consecutive | | notification is | | | | notifications** _| | expected immediately | | | | | | otherwise indicates the | | | | | | time interval between | | | | | | consecutive | | | | | | notifications_** | | | +-------------------------+---------+-------------------------+ | | | NOTE: If \'VAL services | | | | | | requested\' is not | | | | | | present, group | | | | | | configuration is | | | | | | requested for all | | | | | | services defined for | | | | | | the VAL group | | | | | +-------------------------+---------+-------------------------+ | +----------------------------------------------------------------------+
The changes to clause 10.3.2.29 of 3GPP TS 23.434 [9] are highlighted in
**_bold italics_** as follows:
+----------------------------------------------------------------------+ | ### | | # 10.3.2.29 Group registration request {#group-registration-request} | | | | Table 10.3.2.29-1 describes the information flow for a group | | management client to register to a VAL group in response to a group | | announcement from the group management server. | | | | Table 10.3.2.29-1: Group registration request | | | | ---------------------------- -- | | ------- ------------------------------------------------------------ | | -------------------------------------------------------------------- | | Information element Status Description | | VAL UE ID | | M Identity of the VAL UE registering to the VAL group. | | VAL Group ID M | | The group ID to be registered by the VAL UE for the VAL group. | | Identity list subscription M Indicates interest to r | | eceive notifications of newly registered or de-registered VAL UE IDs | | **_Message filters_** | | **_O_** **_Group message communication will be sent to the VAL UE | | after applying message filters as described in Table 10.3.2.29-2._** | | ---------------------------- -- | | ------- ------------------------------------------------------------ | | -------------------------------------------------------------------- | | | | Table 10.3.2.29-2: Group message filters | | | | +-------------------------+---------+-------------------------+ | | | Information element | Status | Description | | | +-------------------------+---------+-------------------------+ | | | **_Identities_** | **_O_** | **_List of VAL UE | | | | | | identities whose | | | | | | messages will be send | | | | | | to the VAL UE being | | | | | | registered_** | | | +-------------------------+---------+-------------------------+ | | | **_Max number of |_** O** _|_** Total number of | | | | messages (NOTE 1)**_| | messages allowed to be | | | | | | sent to the VAL UE in a | | | | | | given time frame as | | | | | | defiend by the VAL | | | | | | service._** | | | +-------------------------+---------+-------------------------+ | | | **_Message Types (NOTE |_** O** _|_** List of message | | | | 2)**_| | types which will be | | | | | | sent to the VAL UE | | | | | | being registered (e.g. | | | | | | high priority messages, | | | | | | or configuration | | | | | | messages, etc.)._** | | | +-------------------------+---------+-------------------------+ | | | **_NOTE 1: Specifying | | | | | | value for max number of | | | | | | messages is outside the | | | | | | scope of SEAL and up to | | | | | | the implementation of a | | | | | | particular Vertical | | | | | | requirement._** | | | | | | | | | | | | **_NOTE 2: Message | | | | | | types are as decided by | | | | | | the specific | | | | | | Vertical._** | | | | | +-------------------------+---------+-------------------------+ | +----------------------------------------------------------------------+
The changes to clause 10.3.2.31 of 3GPP TS 23.434 [9] are highlighted in
**_bold italics_** as follows:
+--------------------------------------------------------------------------+ | +----------------------------------------------------------------------+ | | | ### | | | | # 10.3.2.31 Identity list notification {#identity-list-notification} | | | | | | | | Table 10.3.2.31-1 describes the information flow identity list | | | | notification from the group management server to the group | | | | management client. | | | | | | | | Table 10.3.2.31-1: Identity list notification | | | | | | | | --------------------- -------- --------------- | | | | -------------------------------------------------------------------- | | | | Information element Status Description | | | | VAL group ID M Identity of the VAL group | | | | Identity list M List of VAL U | | | | E IDs who are newly registered or de-registered members of the group | | | | --------------------- -------- --------------- | | | | -------------------------------------------------------------------- | | | | | | | | Table 10.3.2.31-2 describes the information flow identity list | | | | notification from the group management server to the VAL server. | | | | | | | | Table 10.3.2.31-2: Identity list notification | | | | | | | | ---------------------------- --------- --------------- | | | | -------------------------------------------------------------------- | | | | Information element Status Description | | | | VAL group ID M Identity of the VAL group | | | | Identity list M List of VAL U | | | | E IDs who are newly registered or de-registered members of the group | | | | **_Message filters list_** **_O_** **_List | | | | of Message filters per VAL UE ID_** **_who are newly registered._** | | | | ---------------------------- --------- --------------- | | | | -------------------------------------------------------------------- | | | +----------------------------------------------------------------------+ | +--------------------------------------------------------------------------+
### 6.4.9 Solution evaluation
This solution defines group management using the procedures in SEAL TS 23.434
[9]. Group management aspects including establishing a group, adding UEs to
the group or removing UEs from the group, configuration of a maximum number of
members in a group, group notification interworking and group list fetch are
covered. Additional group management aspects such as group update notification
could be resolved directly during normative phase. Further, this solution
defines SEAL enhancements that are required for group notification
interworking.
## 6.5 Solution 5: MSGin5G Group messaging
### 6.5.1 Description
#### 6.5.1.1 General
This solution addresses the identified gap under Key Issue #7 regarding
MSGin5G group messaging.
This solution introduces a group messaging procedure for MSGin5G Client and
MSGin5G server to send and receive Group message after a group is created. In
this procedure, the group creation and membership management are handled by
group management function specified in 3GPP TS 23.434 [9].
Editor\'s Note: How the message will be routed to non-IMS UE from MSGin5G
server is FFS.
#### 6.5.1.2 MSGin5G Group messaging
Figure 6.5.1.2-1 shows the MSGin5G Group messaging procedure in which MSGin5G
client (both IMS and non-IMS UE) sends a message to a group.
Editor\'s Note: Solution for the group hosted on the legacy side where MSGin5G
client is one of the group member is FFS.
Pre-conditions:
1) A MSGin5G Group is created by following group management SEAL service
procedures as specified in 3GPP TS 23.434 [9].
2) All participants in the MSGin5G Group may get the Group information i.e. a
list of group members in the Group information query response as specified in
3GPP TS 23.434 [9].
3) The group consists of different types of UEs i.e. MSGin5G UE, Legacy 3GPP
UE and Non-3GPP UE.
Figure 6.5.1.2-1: Group messaging in MSGin5G service
1) The MSGin5G client 1 sends a message to a group as specified in clause
6.5.1.3.
2) Upon receiving the request to send the group message, the MSGin5G server
may send the message to the application server based on service ID present in
the received Group Message Request (e.g. to log application specific message
or for analytics). Otherwise go to step 4.
2a) Upon receiving the Group Message Request, the application server validates
the message and if the message is not valid, the application server sends
Group Message Reject message to the MSGin5G server. The information elements
defined in Table 6.5.1.3-2 are included in the request. Otherwise go to step
3.
2b) The MSGin5G server sends the Group Message Reject message to the MSGin5G
client 1. The information elements defined in Table 6.5.1.3-2 are included in
the request. Following procedure will be skipped.
3) The application server initiates to send message to all group members and
sends the Group Message Request to the MSGin5G server.
4) The MSGin5G server sends the message to all participants of the group based
on UE types (determined by service ID) as follows:
a) if the target UE supports MSGin5G client, the MSGin5G server sends the
message as specified in clause 6.5.1.4.
b) if the target UE supports Legacy 3GPP message client, the MSGin5G server
sends the message as specified in clause 6.5.1.5.
c) if the target UE supports Non-3GPP message client, the MSGin5G server sends
the message as specified in clause 6.5.1.6.
NOTE: Steps 4-a), 4-b) and 4-c) can happen in parallel and in any order.
5) Upon receiving the group message, if delivery status is requested and if
supported by target message client, the MSGin5G client or Legacy 3GPP message
client or Non-3GPP message client sends the delivery status message to
originator MSGin5G client 1.
#### 6.5.1.3 MSGin5G client sends message to group
Figure 6.5.1.3-1 shows the MSGin5G Group messaging procedure which MSGin5G
client initiates sending a message to a group.
Pre-conditions:
1) A UE hosts a MSGin5G client and an Application Client.
2) The non-IMS MSGin5G client registers with the MSGin5G Server.
3) Information to make selection of group to send message is available at the
Application Client.
Figure 6.5.1.3-1: MSGin5G client sends message to a group
1) An Application Client on a UE requests to an MSGin5G client to send a
message to a group.
2) The MSGin5G client sends the Group Message Request to the MSGin5G server.
The information elements defined in Table 6.5.1.3-1 are included in the
request.
Table 6.5.1.3-1: Group Message Request (MSGin5G client to MSGin5G Server)
Information element Status Description
* * *
Originator MSGin5G client service ID M The identity of the MSGin5G client
sending the message. Group ID M The identifier of the target MSGin5G Group.
Message ID M Unique identifier of this message Disposition Type O Indicates
the disposition type expected from the receiver (i.e., delivered) Application
ID O Identifies the application for which the payload is intended. Generally
same as application ID of the application which initiated this message.
Payload M Payload of the message Priority Type O Application priority level
requested for this message.
3) MSGin5G server checks whether the MSGin5G client 1 is authorized to send
Group Message Request. If authorized, the MSGin5G server resolves the MSGin5G
Group ID to determine the members of that group and determines the
registration status of non-IMS UEs, based on the information from the group
management server. The MSGin5G server validates the request based on the
policy e.g. to limit certain types of message or content to certain members
due to location or user privilege.
4) If MSGin5G client 1 is not authorized to send Group Message Request or the
group message request is not valid, the MSGin5G server sends Group Message
Reject message to the MSGin5G client 1. The information elements defined in
Table 6.5.1.3-2 are included in the request.
Table 6.5.1.3-2: Group Message Reject message
Information element Status Description
* * *
Originator MSGin5G client service ID M The identity of the MSGin5G client who
initiated the Group Message Request Group ID M The identifier of the MSGin5G
Group. Message ID M Identifier contained in the Group Message Request Reject
Code O The code for reject reason
#### 6.5.1.4 MSGin5G client receives message from group
Figure 6.5.1.4-1 shows the procedure for MSGin5G client to receive message
from group.
Pre-conditions:
1) A UE hosts a MSGin5G client and an Application Client
2) The non-IMS MSGin5G client registers with the MSGin5G server.
3) The MSGin5G server is aware of the UE type (determined by service ID) which
is MSGin5G client.
4) The MSGin5G server has received the message to send to target UE.
Figure 6.5.1.4-1: MSGin5G client receives a message from the group
1) The MSGin5G server sends the Group Message Request to the MSGin5G client.
The information elements defined in Table 6.5.1.4-1 are included in the
request.
Table 6.5.1.4-1: Group Message Request (MSGin5G server to MSGin5G client)
Information element Status Description
* * *
Originator MSGin5G client service ID M The identity of the MSGin5G client who
initiated the message. Group ID M The identifier of the MSGin5G Group to which
the message is sent Recipient ID M The identity of the MSGin5G client service
ID of the receiver UE. Message ID M Unique identifier of this message
Disposition Type O Indicates the disposition type expected from the receiver
(i.e. delivered) as specified in Group Message Request received from
originating MSGin5G client Application ID O Identifies the application for
which the payload is intended as specified in Group Message Request received
from originating MSGin5G client Payload M Payload of the message Priority Type
O Application priority level requested for this message as specified in Group
Message Request received from originating MSGin5G client.
2) The MSGin5G client delivers the contents of the MSGin5G message to the
targeted Application Client.
#### 6.5.1.5 Legacy 3GPP message client receives message from group
Figure 6.5.1.5-1 shows the procedure for Legacy 3GPP message client to receive
message from group.
Pre-conditions:
1) Based on service ID, an application server has received the group message
from the originator.
2) The MSGin5G server is aware of the UE type (determined by service ID) which
is Legacy 3GPP message client.
3) The MSGin5G server has received the message to send to target UE.
Figure 6.5.1.5-1: Legacy 3GPP message client receives a message from the group
1) The MSGin5G server sends the Group Message Request to the MSGin5G Gateway.
The information elements defined in Table 6.5.1.4-1 are included in the
request.
2) The MSGin5G server translates the MSGin5G Group message to legacy 3GPP
message (e.g. SMS).
3) The Legacy 3GPP message gateway sends legacy 3GPP message (e.g. SMS) to
3GPP Message Client.
4) The 3GPP Message Client delivers the contents of the legacy 3GPP message
(e.g. SMS) to the targeted Application Client.
#### 6.5.1.6 Non-3GPP message client receives message from group
Figure 6.5.1.6-1 shows the procedure for Non-3GPP message client to receive
message from group.
Pre-conditions:
1) The MSGin5G server is aware of the UE type (determined by service ID) which
is Non-3GPP message client.
2) The MSGin5G server has received the message to send to target UE.
Figure 6.5.1.6-1: Non-3GPP message client receives a message from the group
1) The MSGin5G server sends the Group Message Request to the Non-3GPP Message
Gateway. The information elements defined in Table 6.5.1.4-1 are included in
the request.
2) The Non-3GPP Message Gateway translates the MSGin5G message to Non-3GPP
message.
3) The Non-3GPP Message Gateway sends message to Non-3GPP Message Client.
NOTE: The procedure to translate MSGin5G message to Non-3GPP message and to
send Non-3GPP message from Non-3GPP Message Gateway to Non-3GPP Message Client
are out of scope of 3GPP.
### 6.5.2 Impacts on existing nodes and functionality
SEAL specified in 3GPP TS 23.434 is needed to be introduced if this solution
is used for MSGin5G Group messaging. Before Group message exchange, a MSGin5G
Group is needed to be created by using SEAL. The identifier of the group
created by SEAL is needed to be assigned according to the rules of MSGin5G
services. Enhancements to SEAL for supporting group management in case of a
non-IMS UE is required.
### 6.5.3 Solution evaluation
This procedure can be used by MSGin5G Client, Legacy-3GPP Client, Non-3GPP
Message Gateway Function and MSGin5G Server to send and receive group message.
This procedure can simplify the functional requirements for the MSGin5G Client
and MSGin5G Server.
## 6.6 Solution 6: Charging
### 6.6.1 Description
Editor\'s Note: Any solution needs to distinguish between UE charging and
vertical/tenant charging and all charging solutions for MSGin5G services
should be specified in SA5 which should be involved at some stage.
## 6.7 Solution 7: MSGin5G Server message broadcast
### 6.7.1 Description
#### 6.7.1.1 General
All MSGin5G message traffic passes through the MSGin5G Server, including
broadcast messages. Broadcast messages originate from an Application Client on
a UE or from the Application Server and need to be broadcast in a pre-
configured service area.
The only broadcast service that has been specified for 5GS Release-16 is the
Cell Broadcast Service as specified in 3GPP TS 23.041 [6]. If the modification
in 3GPP TS 23.041 [6] to extend the maximum payload, as proposed in Solution
1, is implemented then Cell Broadcast can be used for the broadcast message.
If the modification is not implemented, then the broadcast message may need to
be segmented.
#### 6.7.1.2 MSGin5G message broadcast
Figure 6.7.1.2-1 shows the MSGin5G broadcast message procedure which message
is sent by an Application Server. The broadcast message can also be initiated
from an Application Client. The payload shall be received by Application
Clients located in the service area.
Pre-conditions:
1\. The service areas are pre-configured in the MSGin5G Server: Each service
area is identified by a Service Area ID. The polygon that defines the service
area is stored in the CBCF and can be addressed by its Service Area ID.
Figure 6.7.1.2-1: Broadcast message procedure - message sent by Application
Server
1\. The Application Server sends a message request (i.e. MSGin5G broadcast
message request) to MSGin5G Server. The request includes the information
listed in Table 6.7.1.2-1.
Table 6.7.1.2-1: Broadcast message request from Application Server to MSGin5G
Server
Information element Status Description
* * *
Originator ID M The application level identifier of the message originator. In
this message, the originator is the Application Server. Message ID M Unique
identifier of this message. Service Area ID C The identifier of the Service
Area where the message needs to be broadcast. This IE is mandatory in the
Broadcast Message and is not present in other message scenarios. Payload M The
payload of the message.
NOTE: The procedure addressing the other requirements, e.g. fragment and store
message in MSGin5G Server, will be provided in other solutions. In this
solution, the related steps are omitted.
2\. Upon receiving the message, the MSGin5G Server validates the broadcast
message request by checking some conditions, e.g. whether the originator is
authenticated and is authorized to send a broadcast message, whether the
Service Area ID exists, etc. The MSGin5G Server will go to step 4 if the
MSGin5G Server validates the broadcast message request successfully.
3\. The MSGin5G server sends a broadcast message rejection message to the
Application Server. The broadcast message rejection message includes the
information listed in Table 6.7.1.2-2. The remaining steps of broadcast
message will not be processed.
Table 6.7.1.2-2: Broadcast message rejection message from MSGin5G Server to
Application Server
Information element Status Description
* * *
Originator ID M The application level identifier of the message originator. In
this message, the originator is the MSGin5G Server. Recipient ID M The
application level identifier of the message recipient. In this message, the
destination is the identifier of the broadcast message originator. Message ID
M Indicates which message request this message is responding. It is equal to
the Message ID included in the broadcast message request which is rejected.
Reject Reason O This IE contains the failure reason, e.g. the service area
does not exist, or the originator is not authorized to send a broadcast
message, may be included in this IE.
4\. The MSGin5G Server transfers the request to the CBCF and includes at least
the Service Area ID and the payload. Furthermore:
\- The Start Time is assumed to be immediate.
\- The Expiration Time may be configured in the CBCF or in the MSGin5G Server.
Alternatively, the Expiration Time is provided as an information element in
the broadcast message request.
\- The Repetition Interval is assumed to be configured in the CBCF or in the
MSGin5G Server. Alternatively, the Repetition Interval is provided as an
information element in the broadcast message request.
\- The Message Identifier is assumed to be configured in the CBCF or in the
MSGin5G Server and is allocated specifically for the MSGin5G service.
Alternatively, the Message Identifier is provided as an information element in
the broadcast message request or as an information element that can be mapped
onto a Message Identifier.
5\. The CBCF broadcasts the message via the 5GS in the service area.
6\. Since broadcast is downlink-only, any delivery status report needs to be
initiated by the MSGin5G Client.
### 6.7.2 Impacts on existing nodes and functionality
No protocol specification exists in 3GPP for submitting messages to a CBCF.
### 6.7.3 Solution evaluation
The CBCF can be used for transferring the broadcast message if a protocol
specification is developed.
## 6.8 Solution 8: Identities
### 6.8.1 General
This solution is to address key issue #3 \"identifier(s) of UE\". As all the
service endpoints in MSGin5G service need to have an identity to be identified
and to be used for message delivery. This solution also addresses identities
of other non-UE service entities such as the Application server and group.
### 6.8.2 UE service Identity (MSGin5G service ID)
All UEs in the MSGin5G service shall be assigned with an application layer
identifier, i.e. MSGin5G service ID. The MSGin5G service ID is a unique
identifier within the MSGin5G service that represents a service endpoint (i.e.
MSGin5G UEs, legacy 3GPP UEs and non-3GPP UEs) to send and receive the MSGin5G
messages. As the MSGin5G service ID identifies the service endpoint it is used
by the MSGin5G server to authenticate and authorize the associated UE to the
MSGin5G service at the application layer.
For a MSGin5G UE, the assigned MSGin5G service ID is used by the MSGin5G
client to register with the MSGin5G server and to send and receive MSGin5G
messages. For a legacy 3GPP UE or a non 3GPP UE, the assigned MSGin5G service
ID is used to map into the service ID in their defined message delivery
mechanisms for interworking.
To accommodate different types of UE, the MSGin5G service ID shall conform to
the following characteristics:
1 Unique within the MSGin5G service.
2 Permanently assigned to a UE so that a message sender knows how to address
the recipient to send a message and how a group can be created with its group
members.
3 Flexible enough to accommodate the different types of UE that may be reached
with different transport mechanisms and messaging service technologies.
A UE shall register its MSGin5G service ID with the MSGin5G server so that the
MSGin5G server can authenticate the authenticity of the UE and be aware the
availability of the UE. The UE shall send the recipient UE a message using the
recipient UE\'s MSGin5G service ID. In a MSGin5G UE, the MSGin5G service ID
shall be assigned to its MSGin5G client; the application client in a MSGin5G
UE is defined in 7.2.5.
The MSGin5G service ID shall be a URI that can be used to identify the UE\'s
home service domain.
### 6.8.3 Application server service identity (AS service ID)
The Application server in the MSGin5G service shall be assigned with an
application layer identifier, i.e. AS service ID. The AS service ID is a
unique identifier within the MSGin5G service that represents a specific
Application server. The Application server uses the AS service ID to perform
mutual authentication with the MSGin5G server for establishing a secured
service connection. A service endpoint UE (i.e. MSGin5G UEs, legacy 3GPP UEs
and non 3GPP UEs) shall use the AS service ID of the target Application server
to send a message to it. The Application server shall use the MSGin5G service
ID of the recipient UE to send a message to that UE.
The AS service ID shall be a URI that can be used to identify the Application
server\'s home service domain.
### 6.8.4 MSGin5G group service identity (Group service ID)
A pre-defined MSGin5G message group in the MSGin5G service shall be assigned
with an application layer identifier; i.e. Group service ID. The Group service
ID is a unique identifier within the MSGin5G service that represents a
specific pre-defined group. A pre-defined group is created using SEAL with its
unique Group service ID and this Group service ID shall be communicated to all
members of the group. A service endpoint (UE or Application server) shall use
this Group service ID to send a message to all members of the group.
The Group service ID shall be a URI that can be used to identify where the
group is hosted.
### 6.8.5 Message Gateway service identity (GW service ID)
The Message Gateway in the MSGin5G service is assigned with an application
layer identifier, i.e. GW service ID. The GW service ID is a unique identifier
within the MSGin5G service that represents a specific Message Gateway. The
Message Gateway uses the GW service ID to perform mutual authentication with
the MSGin5G server for establishing a secured service connection.
The GW service ID is a URI that is used to identify the Message Gateway\'s
home service domain.
### 6.8.6 MSGin5G UE identity (MSGin5G UE ID)
The MSGin5G UE ID is a unique identifier that represents the MSGin5G UE. The
format of MSGin5G UE ID may differ among different VALs. The MSGin5G UE ID may
be pre-configured to the MSGin5G UE by its vendor.
### 6.8.7 non-MSGin5G UE identity (non-MSGin5G UE ID)
The non-MSGin5G UE ID is a unique identifier that represents the non-MSGin5G
UE. A non-MSGin5G UE ID is associated with a specific non-MSGin5G UE. The
format of non-MSGin5G UE ID may differ among different VALs. The non-MSGin5G
ID may be pre-configured to the non-MSGin5G UE by its vendor.
### 6.8.8 Solution Evaluation
This solution proposes to assign a unique application layer identifier within
the MSGin5G service to each of the service endpoints (such as Appliaction
server, Message Gateway and all types of UEs etc.) and assign it permanently
to the service endpoint. This application layer identifier will be used to
identify the service endpoint for message delivery. With the flexibile
structure of the application layer identifier, it can be used by the MSGin5G
server to correctly route a message either directly to a UE or to a Message
Gateway where interworking function will be provided to deliver the payload of
a MSGin5G message with the apporpriate message delivery mechanism,
## 6.9 Solution 9: Point to point Messaging
### 6.9.1 General
This solution addresses point-to-point messaging that including message
origination from a MSGin5G UE to all types of UEs, i.e. another MSGin5G UE, a
legacy 3GPP UE or a non-3GPP UE. It addresses the key issues in #5 and #6.
### 6.9.2 Message origination from a UE
Editor\'s Note: Whether and how the solution applies to IMS and non-IMS is
FFS.
Figure 6.9.2-1 illustrates a MSGin5G UE sending a MSGin5G message to another
MSGin5G UE.
Pre-conditions:
1\. Both MSGin5G client-1 in MSGin5G UE-1and MSGin5G client-2 in MSGin5G UE-2
are registered with the MSGin5G server.
Figure 6.9.2-1 MSGin5G UE to MSGin5G UE messaging
1) The MSGin5G client-1 in MSGin5G UE-1 sends a message to MSGin5G UE-2 by
initiating a MSGin5G message request to the MSGin5G server. The delivery
report is requested in the message. The information elements defined in table
6.9.2-1 are included in the message.
NOTE: If the delivery report is not requested this procedure will stop after
step 3 and step 4 and 5 will not be needed.
Table 6.9.2-1: MSGin5G message request
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
message. Recipient MSGin5G service ID M The service identity of the recipient
receiving the message. Message ID M Unique identifier of this message Delivery
report O Indicates if delivery acknowledgement is requested Application ID O
Identifies the application client for which the payload is intended. Payload M
Payload of the message
2) The MSGin5G server authenticates that the MSGin5G UE-1 is allowed to send a
message to MSGin5G UE-2.
3) Based on the registration of MSGin5G UE-2 with the MSGin5G server, the
MSGin5G server determines to forward the MSGin5G message request to the
MSGin5G UE-2.
4) The MSGin5G client-2 in MSGin5G UE-2 sends the MSGin5G message delivery
report to the MSGin5G server. The information elements defined in table
6.9.2-2 are included in the message.
Table 6.9.2-2: MSGin5G message delivery report
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
delivery report. Recipient MSGin5G service ID M The service identity of the
recipient receiving the delivery report. Message ID M Unique identifier of the
received message Delivery status O Indicates if delivery is success of failure
Failure reason O Reason of delivery failure
5) The MSGin5G server forwards the MSGin5G message delivery report to the
MSGin5G client-1.
Figure 6.9.2-2 illustrates a MSGin5G UE sending a MSGin5G message to a legacy
3GPP UE with SMS client.
Pre-conditions:
1\. MSGin5G client in MSGin5G UE is registered with the MSGin5G server.
2\. Legacy 3GPP message gateway is aware of the Legacy 3GPP message client
(i.e. SMS client) in Legacy 3GPP UE and provides the mapping to MSGin5G
service ID.
Figure 6.9.2-2 MSGin5G UE messaging to a legacy 3GPP UE (with SMS client)
1) The MSGin5G client in MSGin5G UE sends a message to the legacy 3GPP UE by
initiating a MSGin5G message request to the MSGin5G server. The delivery
report is requested in the message. The information elements defined in table
6.9.2-1 are included in the message and the recipient MSGin5G service ID set
to the legacy 3GPP UE\'s MSGin5G service ID.
NOTE: If the delivery report is not requested this procedure will stop after
step 4 and step 5 to 7 will not be needed.
2) The MSGin5G server authenticates that the MSGin5G UE is allowed to send a
message to the legacy 3GPP UE.
3) The MSGin5G server analyses the registration status of the recipient
MSGin5G service ID and determines it is to be routed to a legacy 3GPP UE and
forwards the MSGin5G message request to the legacy 3GPP message gateway for
delivery.
4) The legacy 3GPP message gateway translates the MSGin5G message to a legacy
3GPP message (i.e. SMS) with delivery report requested and sends it to the
legacy 3GPP message client (i.e. SMS) through the SMSC according the procedure
in TS 23.204 [15] or the procedure in clause 4.13.3 of TS 23.502. This step is
outside the scope of the current specification.
5) The legacy 3GPP message client sends a legacy 3GPP message delivery report
to the legacy 3GPP message gateway. This step is outside the scope of the
current specification.
6) The legacy 3GPP message gateway translates the legacy 3GPP message delivery
report to the MSGin5G message delivery report and sends it to the MSGin5G
server. The information elements defined in table 6.9.2-2 are included in the
message. The translation of a legacy 3GPP message delivery report into the
MSGin5G message delivery report is outside the scope of the current
specification.
7) The MSGin5G server forwards the MSGin5G message delivery report to the
MSGin5G client.
Figure 6.9.2-3 illustrates a MSGin5G UE sending a MSGin5G message to a
non-3GPP UE.
Pre-conditions:
1\. MSGin5G client in MSGin5G UE is registered with the MSGin5G server.
2\. Non-3GPP message gateway is aware of the non-3GPP message client in
non-3GPP UE and provides the mapping to MSGin5G service ID.
Figure 6.9.2-3 MSGin5G UE messaging to a non-3GPP UE (with SMS client)
1) The MSGin5G client in MSGin5G UE sends a message to the non-3GPP UE by
initiating a MSGin5G message request to the MSGin5G server. The delivery
report is requested in the message. The information elements defined in table
6.9.2-1 are included in the message and the recipient MSGin5G service ID set
to the non-3GPP UE\'s MSGin5G service ID.
NOTE: If the delivery report is not requested this procedure will stop after
step 4 and step 5 to 7 will not be needed.
2) The MSGin5G server authenticates that the MSGin5G UE is allowed to send a
message to the non-3GPP UE.
3) The MSGin5G server analyses the registration status of the recipient
MSGin5G service ID and determines it is to be routed to a non-3GPP UE and
forwards the MSGin5G message request to the non-3GPP message gateway for
delivery.
4) The non-3GPP message gateway translates the MSGin5G message to the non-3GPP
message with delivery report requested and sends it to the non-3GPP message
client. This step is outside the scope of the current specification.
5) The non-3GPP message client sends a non-3GPP message delivery report to the
non-3GPP message gateway. This step is outside the scope of the current
specification.
6) The non-3GPP message gateway translates the non-3GPP message delivery
report to the MSGin5G message delivery report and sends it to the MSGin5G
server. The information elements defined in table 6.9.2-2 are included in the
message. The translation of a non-3GPP message delivery report into the
MSGin5G message delivery report is outside the scope of the current
specification.
7) The MSGin5G server forwards the MSGin5G message delivery report to the
MSGin5G client.
### 6.9.3 Solution Evaluation
This solution covers the MSGin5G UE message origination to all types of UEs in
MSGin5G service. It follows the client-server application layer architecture
that uses the application layer service ID to identify the recipient UE and
delivery of the message. It uses an efficient application messaging delivery
mechanism with a single protocol and procedure between the UEs and the MSGin5G
server.
## 6.10 Solution 10: Application to point Message Exchange
### 6.10.1 General
This solution addresses key issue #9 \"application-to-point messaging\" that
including message origination from an Application server to all possible
MSGin5G service endpoints, i.e. a MSGin5G UE, a legacy 3GPP UE or a non-3GPP
UE.
### 6.10.2 Application to UE Messaging
Editor\'s Note: Whether and how the solution applies to IMS and non-IMS is
FFS.
Figure 6.10.2-1 illustrates an Application server sending a MSGin5G message to
a MSGin5G UE.
Pre-conditions:
1\. The MSGin5G client has registered with the MSGin5G server.
2\. The Application server supports a MSGin5G client or similar functions to
send and receive MSGSin5G messages.
3\. The Application server has established a secured communication with the
MSGin5G server
Figure 6.10.2-1 Application server to MSGin5G UE messaging
1) The Application server sends a message to the MSGin5G UE by initiating a
MSGin5G message request to the MSGin5G server. The delivery report is
requested in the message. The information elements defined in table 6.10.2-1
are included in the message.
NOTE: If the delivery report is not requested this procedure will stop after
step 3 and step 4 and 5 will not be needed.
Table 6.10.2-1: MSGin5G message request
Information element Status Description
* * *
AS service ID M The service identity of the application server sending the
message. MSGin5G service ID M The service identity of the recipient UE/client
receiving the message. Message ID M Unique identifier of this message Delivery
report O Indicates if delivery acknowledgement is requested Application ID O
Identifies the application for which the payload is intended. Payload M
Payload of the message
2) The MSGin5G server authenticates that the Application server is allowed to
send a message to the MSGin5G UE.
3) Based on the registration of MSGin5G UE-2 with the MSGin5G server, the
MSGin5G server forwards the MSGin5G message request to the MSGin5G UE.
4) The MSGin5G client in MSGin5G UE sends the MSGin5G message delivery report
to the MSGin5G server. The information elements defined in table 6.10.2-2 are
included in the message.
Table 6.10.2-2: MSGin5G message delivery report
Information element Status Description
* * *
MSGin5G service ID M The service identity of the sender UE/client sending the
delivery report. AS service ID M The service identity of the application
server receiving the delivery report. Message ID M Unique identifier of the
received message Delivery status O Indicates if delivery is success of failure
Failure reason O Reason of delivery failure
5) The MSGin5G server forwards the MSGin5G message delivery report to the
Application server.
Figure 6.10.2-2 illustrates an application server sending a MSGin5G message to
a legacy 3GPP UE with SMS client.
Pre-conditions:
1\. The Application server supports a MSGin5G client or similar functions to
send and receive MSGSin5G messages.
2\. The Application server has established a secured communication with the
MSGin5G server
3\. Legacy 3GPP Message Gateway is aware of the legacy 3GPP message client
(i.e. SMS client) in legacy 3GPP UE and provides the mapping to MSGin5G
service ID.
Figure 6.10.2-2 Application server messaging to a legacy 3GPP UE (with SMS
client)
1) The Application server sends a message to the legacy 3GPP UE by initiating
a MSGin5G message request to the MSGin5G server. The delivery report is
requested in the message. The information elements defined in table 6.10.2-1
are included in the message.
NOTE: If the delivery report is not requested this procedure will stop after
step 4 and step 5 to 7 will not be needed.
2) The MSGin5G server authenticates that the Application server is allowed to
send a message to the legacy 3GPP UE.
3) The MSGin5G server analyses the registration status of the recipient
MSGin5G service ID and determines it is to be routed to a legacy 3GPP UE and
forwards the MSGin5G message request to the legacy 3GPP Message Gateway for
delivery.
4) The legacy 3GPP Message Gateway translates the MSGin5G message to a legacy
3GPP message (i.e. SMS) with delivery report requested and sends it to the
legacy 3GPP message client (i.e. SMS) through the SMSC according the procedure
in TS 23.204 [15] or the procedure in clause 4.13.3 of TS 23.502. This step is
outside the scope of the current specification.
5) The legacy 3GPP message client sends a legacy 3GPP message delivery report
to the legacy 3GPP Message Gateway. This step is outside the scope of the
current specification.
6) The legacy 3GPP Message Gateway translates the legacy 3GPP message delivery
report to the MSGin5G message delivery report and sends it to the MSGin5G
server. The information elements defined in table 6.10.2-2 are included in the
message. The translation of a legacy 3GPP message delivery report into the
MSGin5G message delivery report is outside the scope of the current
specification.
7) The MSGin5G server forwards the MSGin5G message delivery report to the
Application server.
Figure 6.10.2-3 illustrates an application server sending a MSGin5G message to
a non-3GPP UE.
Pre-conditions:
1\. The Application server supports a MSGin5G client or similar functions to
send and receive MSGSin5G messages.
2\. The Application server has established a secured communication with the
MSGin5G server
3\. Non-3GPP Message Gateway is aware of the non-3GPP message client in
non-3GPP UE and provides the mapping to MSGin5G service ID.
Figure 6.10.2-3 Application server to non-3GPP UE messaging
1) The Application server sends a message to the non-3GPP UE by initiating a
MSGin5G message request to the MSGin5G server. The delivery report is
requested in the message. The information elements defined in table 6.10.2-1
are included in the message.
NOTE: If the delivery report is not requested this procedure will stop after
step 4 and step 5 to 7 will not be needed.
The MSGin5G server authenticates that the Application server is allowed to
send a message to the non-3GPP UE.
2) The MSGin5G server analyses the registration status of the recipient
MSGin5G service ID and determines it is to be routed to a non-3GPP UE and
forwards the MSGin5G message request to the non-3GPP Message Gateway for
delivery.
3) The non-3GPP Message Gateway translates the MSGin5G message to the non-3GPP
message with delivery report requested and sends it to the non-3GPP message
client. This step is outside the scope of the current specification.
4) The non-3GPP message client sends a non-3GPP message delivery report to the
non-3GPP message gateway. This step is outside the scope of the current
specification.
5) The non-3GPP Message Gateway translates the non-3GPP message delivery
report to the MSGin5G message delivery report and sends it to the MSGin5G
server. The information elements defined in table 6.10.2-2 are included in the
message. The translation of a non-3GPP message delivery report into the
MSGin5G message delivery report is outside the scope of the current
specification.
6) The MSGin5G server forwards the MSGin5G message delivery report to the
application server.
### 6.10.3 Solution Evaluation
This solution covers the Application server message origination to all types
of UEs in MSGin5G service. It follows the client-server application layer
architecture that uses the application layer service ID to identify the
recipient UE and delivery of the message. It uses an efficient application
messaging delivery mechanism with a single protocol and procedure among the
Application server, all UEs and the MSGin5G server.
## 6.11 Solution 11: MSGin5G Application-to-point message exchange
### 6.11.1 Description
#### 6.11.1.1 General
This solution addresses the identified gaps under Key Issue #9 regarding
MSGin5G Application-to-point messaging procedure.
This solution includes three procedures:
\- UE registers to MSGin5G server and obtains contact information of Logical
Application Server(s).
\- Application Server registers to MSGin5G server and obtains contact
information of UEs.
\- The Message exchanging procedure between Application Servers and UEs.
NOTE: The Application Server in this clause refers to logical application
server which is used for one specific user service. There is only a single
logical application server and many applications clients in UEs for a specific
user service. An Application Server may contain one or multiple logical
application server. Multiple logical application servers, each for a specific
user service, may connect to a MSGin5G Server. An UE may communicate with
multiple logical Application Servers.
#### 6.11.1.2 Client registration enhancement for Application-to-point
messaging
All MSGin5G Clients are needed to be registered to MSGin5G server as per
clause 6.2 if they use MSGin5G service. If Application-to-point messaging is
needed by the UE, the procedures of clause 6.2 apply as well as an additional
Application Profile information is needed to be included in the MSGin5G Client
registration request. The information included in the Application Profile are
listed in Table 6.11.1.2-1. If the Application profile of the Client is
changed, e.g. new application has been installed on the UE, the MSGin5G Client
can re-register to MSGin5G server. The same procedure applies for the re-
registration.
Table 6.11.1.2-1: Additional information of MSGin5G Client Profile for
Application-to-point messaging
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | List of application IDs | O | A list of identifiers of | | | | the Application specified | | | | by the application | | | | provider. | +-----------------------------+--------+-----------------------------+ | List of application Filters | O | Either application provider | | | | or service specified | | | | information such as | | | | \"application category\". | | | | (NOTE) | | | | | | | | The detailed definition of | | | | application Filters is out | | | | of scope of this document. | +-----------------------------+--------+-----------------------------+ | NOTE: The \"application | | | | category\" can be | | | | \"Monitoring data | | | | reporting, remote control, | | | | etc\". It is specified by | | | | application provider or | | | | MSGin5G service provider | | | | and is out of scope of this | | | | document. | | | +-----------------------------+--------+-----------------------------+
Upon receiving the request from the MSGin5G Client, the MSGin5G Server records
the Application Profile in the UE registration request and compares it with
the available Application Profile received in the Application Server(s)
registration request. If at least one Application ID of the Application
Server(s) is the same as an Application ID in the MSGin5G Client registration
request, or the Application Profile of at least one Application Server(s)
matches any application Filters in the MSGin5G Client registration request,
the MSGin5G server includes information listed in Table 6.11.1.2-2 in the
registration response. If there is no Application Profile obtained from the
Application Server(s), or no matched result, the Application Server list may
not be included in the registration response.
Table 6.11.1.2-2: Additional information in the registration response
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | Application Server list | O | The list of AS service ID | | (NOTE) | | assigned to the matched | | | | Application Server(s). This | | | | list includes application | | | | servers that match what | | | | UE\'s Application Profile | | | | in the Registration | | | | Request. | +-----------------------------+--------+-----------------------------+ | NOTE 1: The MSGin5G server | | | | can use accurate matching | | | | between the Application | | | | Profile of UE and | | | | Application Server if | | | | application ID is presented | | | | in the MSGin5G Client | | | | registration request. | | | | Otherwise application | | | | filters are used according | | | | to the service policy. | | | | | | | | NOTE 2: The UE may not know | | | | the application ID before | | | | its registration. It will | | | | use AS service ID obtained | | | | from the registration | | | | response in the message | | | | request. | | | +-----------------------------+--------+-----------------------------+
If the Application Server list is changed, the MSGin5G Server may send a
registration update request including the new Application Server list to the
MSGin5G Client. The procedure is shown in Figure 6.11.1.2-1.
Figure 6.11.1.2-1: MSGin5G Client registration Update
#### 6.11.1.3 Application Server registration
Figure 6.11.1.3-1 shows the MSGin5G Application Server registration procedure.
Pre-conditions:
1\. The Application Server is responsible for triggering the registration to
the MSGin5G Server.
Figure 6.11.1.3-1: Application Server registration
1) The Application Server sends an Application Server registration request to
the MSGin5G Server. The request includes the information listed in Table
6.11.1.3-1.
Table 6.11.1.3-1: Application Server registration request
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | Application ID | M | The identifier of the | | | | Application specified by | | | | the application provider. | | | | | | | | The MSGin5G server will | | | | record the Application ID | | | | and assign a MSGin5G | | | | identifier associated to | | | | the Application ID. | +-----------------------------+--------+-----------------------------+ | AS service ID | O | The MSGin5G identifier of | | | | the Application Server | | | | assigned by the MSGin5G | | | | server. | | | | | | | | Once the MSGin5G identifier | | | | is assigned, it may not | | | | change unless required by | | | | the Application Server. If | | | | the registration is the | | | | initial registration, the | | | | AS service IDis not | | | | included in the | | | | registration request. | +-----------------------------+--------+-----------------------------+ | Security Credentials | M | Security information | | | | required for the | | | | Application Server to | | | | register to the MSGin5G | | | | Server. | +-----------------------------+--------+-----------------------------+ | Application Profile (NOTE) | M | The elements in Application | | | | Profile include the | | | | information of the | | | | Application Server, e.g. | | | | application name, | | | | application provider, | | | | application scenario | | | | description, application | | | | category, etc. | | | | | | | | This IE is used by MSGin5G | | | | Server to compare with | | | | application Filters in the | | | | MSGin5G Client registration | | | | request if Application ID | | | | IE is not presented but | | | | application Filters IE is | | | | presented in this | | | | registration request. | +-----------------------------+--------+-----------------------------+ | NOTE: The detailed | | | | definition of Application | | | | Profile is out of scope of | | | | this document. | | | +-----------------------------+--------+-----------------------------+
Editor\'s Note: The security mechanism of MSGin5G service is FFS. It will be
considered by SA3.
2) The MSGin5G Server validates the registration request and verifies the
security credentials. The MSGin5G Server also checks if an AS service ID is
present.
1) If AS service ID is not present, the MSGin5G server considers that the
registration is a new registration. The MSGin5G server:
i. assigns a AS service ID to the Application Server.
ii. compares the Application Profile in the UE registration request and the
Application Profile in the Application Server(s) registration request, if
Application Profile in the UEs\' registration request is matched to
Application Profile of Application Server, the MSGin5G server includes the
list of UEs\' identifier in the registration response.
2) If AS service ID is present, the MSGin5G server considers that the
registration is an update registration. The MSGin5G server includes the AS
service ID and newest UE list in the registration response.
3) The MSGin5G Server sends an Application Server registration response to the
Application Server. The response includes the information listed in Table
6.11.1.3-2.
Table 6.11.1.3-2: Application Server registration response
Information element Status Description
* * *
AS service ID M The MSGin5G identifier of the Application Server assigned by
the MSGin5G server UE list O list of UEs\' identifier which may communicate
with the Application Server.
4) If the UE list is changed, the MSGin5G Server will send a registration
update request including the new UE list to the Application Server.
#### 6.11.1.4 Message exchanging procedure between Application Servers and
MSGin5G Client
Figure 6.11.1.4-1 shows the Application Server sending a MSGin5G message to a
MSGin5G Client.
Pre-conditions:
1\. The MSGin5G client has registered with the MSGin5G server.
2\. The Application server supports a MSGin5G client or similar functions to
send and receive MSGSin5G messages.
3\. The Application server has established a secured communication with the
MSGin5G server.
4\. The Application Server gets the identifier of MSGin5G UE from the
registration procedure described in clause 6.11.1.3.
Figure 6.11.1.4-1: Application Server sending a MSGin5G message to a MSGin5G
Client
1) The Application Server sends a MSGin5G message request to the MSGin5G
server via MSGin5G-3 reference point, The request includes the information
listed in Table 6.11.1.4-1.
Table 6.11.1.4-1: MSGin5G Message request from Application Server to MSGin5G
server
Information element Status Description
* * *
Originator ID M The AS service ID. Recipient ID M The MSGin5G identifier of
the MSGin5G client receiving the message. The Application Server obtains the
identifier of the recipient from the Application Server registration response
or registration Update. Message ID M Unique identifier of this message.
Security Credentials O Security information required by the MSGin5G Server.
Delivery status request O Indicates that whether the delivery status of this
message from the recipient is required. Application ID O Identifies the
application for this messaging exchange. Payload M Payload of the message
2) Upon receiving the message, the MSGin5G Server validates the MSGin5G
message request, e.g. authenticates that the Application server, and checks
whether the MSGin5G message request is allowed to be sent to the receiving
client.
3) The MSGin5G server forwards the MSGin5G message request to the MSGin5G
Client.
4) If delivery status is required, the MSGin5G Client sends the Delivery
status message to the MSGin5G Server and the MSGin5G Server forward the
Delivery status message to the originating Application Server.
NOTE: Solution 26 can also be used for sending Delivery status message.
Figure 6.11.1.4-2 shows the MSGin5G Client sending a MSGin5G message to a
Application Server.
Pre-conditions:
1\. The MSGin5G Clients is registered to a MSGin5G Server via the MSGin5G-1
reference point and gets the identifier of Application Server from the
registration procedure described in clause 6.11.1.2.
Figure 6.11.1.4-2: MSGin5G Client sending a MSGin5G message to a Application
Server
1) The MSGin5G Client sends a MSGin5G message request to the MSGin5G server
via MSGin5G-1 reference point, The request includes the information listed in
Table 6.11.1.4-2.
Table 6.11.1.4-2: MSGin5G Message request from Application Server to MSGin5G
server
Information element Status Description
* * *
Originator ID M The MSGin5G identifier of MSGin5G Client Recipient ID M The
MSGin5G identifier of the Application Server receiving the message, i.e. AS
service ID. The MSGin5G Client obtains the identifier of Application Server
from the Client registration response or registration Update. Message ID M
Unique identifier of this message. Security Credentials O Security information
required by the MSGin5G Server. Delivery status request O Indicates that
whether the delivery status of this message from the recipient is required.
Application ID O Identifies the application for this messaging exchange.
Payload M Payload of the message
2) Upon receiving the message, the MSGin5G Server validates the MSGin5G
message request, e.g. authenticates that the MSGin5G Client, ,and checks
whether the MSGin5G message request is allowed to be sent to the Application
Server.
3) The MSGin5G server forwards the MSGin5G message request to the Application
Server.
4) If delivery status is required, the Application Server sends the Delivery
status message to the MSGin5G Server and the MSGin5G Server forward the
Delivery status message to the originating MSGin5G Client.
NOTE: Solution 26 can also be used for sending Delivery status message.
### 6.11.2 Impacts on existing nodes and functionality
This solution reuses the MSGin5G UE registration procedure and adds some
application related information to the registration Request/Response in
solution 2 in this document.
### 6.11.3 Solution evaluation
This solution defines three procedures to addresses the three identified gaps
in KI9. The Application Server uses similar MSGin5GG identifier and exchanges
contact information with MSGin5G Clients in the registration procedure.
## 6.12 Solution 12: Message segmentation and reassembly
### 6.12.1 General
This solution is to address key issue #14 regarding the application layer
message segmentation and reassembly when the message payload size is over a
certain size limit. The proposed solution re-uses the point-to-point and group
message delivery mechanisms with additional information elements in the
message to indicate the message is part of a whole message.
### 6.12.2 Segmentation and reassembly in point-to-point messaging
The point-to-point messaging is described in XXX. When a payload of the
message is over a configured payload size limit, it needs to be delivered in
message segments.
The sender endpoint (either the MSGin5G client on a MSGin5G UE or an
Application server) of the message will divide the whole message into message
segments with each payload size within the configured payload size limit. Each
message segment is assigned with a unique message segment number in the
ascending order and is sent as a standalone point-to-point MSGin5G message
with the additional information elements described in table 6.12.2-1.
NOTE: When the Application server is a sender or receiving endpoint in the
context of segmentation and reassembly; it assumes that the Application server
supports a MSGin5G client or similar functions to send and receive MSGSin5G
messages.
If the message is sent to another MSGin5G UE or a target Application server,
the MSGin5G client in the recipient UE or the targeted Application server
makes sure all the message segments are received using the information
elements described in table 6.12.2-1. If there is a missing message segment,
the MSGin5G client in the recipient UE or the targeted Application server
reports it back to the sender endpoint for re-transmission with the additional
information element described in table 6.12.2-2. The recipient UE or the
targeted Application server only sends the delivery report, if requested, when
all the message segments are received.
If the message is sent to a legacy 3GPP UE or a non-3GPP UE, the message
gateway makes sure all the message segments are received. If there is a
missing message segment, the message gateway reports it back to the sender
endpoint for re-transmission with the information element described in table
6.12.2-2. The message gateway reassembles the message, after received all
message segments, first and then delivers it to the recipient UE. The
recipient UE sends back a delivery report, if requested, after it receives the
message.
Table 6.12.2-1: Additional IEs for MSGin5G message request
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | Message is segmented | O | Indicates this message is | | (NOTE1) | | part of the whole message | +-----------------------------+--------+-----------------------------+ | Total number of message | O | Indicates how many segments | | segments (NOTE2) | | of the whole message is | | | | divided | +-----------------------------+--------+-----------------------------+ | Message segment number | O | The message segment number | | | | in the whole message | +-----------------------------+--------+-----------------------------+ | NOTE1: When the Message is | | | | segmented IE is set to yes | | | | both the Total number of | | | | message segments and the | | | | Message segment number IEs | | | | are mandatory. | | | | | | | | NOTE2: This IE only needs | | | | to be sent in the first | | | | segmented message. | | | +-----------------------------+--------+-----------------------------+
Table 6.12.2-2: Additional IEs for MSGin5G message delivery report
Information element Status Description
* * *
Message segment number O Indicates the missing message segment.
Figure 6.12.2-1 illustrates a message sending endpoint (i.e. the MSGin5G
client on a 5SMSGS UE or an Application server) sends a message in segments to
the receiving endpoint (i.e. another MSGin5G client on a MSGin5G UE, a message
gateway or an Application server) using the point-to-point messaging procedure
in 6.9.2.
Pre-conditions:
1) The point-to-point messaging procedure in 6.9.2 is used to deliver message
from the sending endpoint to the receiving endpoint.
2) The sending endpoint can be the MSGin5G client on a MSGin5G UE or an
Application server.
3) The receiving endpoint can be another MSGin5G client on a MSGin5G UE, an
Application server or the message gateway.
Figure 6.12.2-1 Message sent in segments between sending and receiving
endpoint
1\. The sending endpoint determines that the message payload is larger than
the configured size limited and divides the message in segments. Each segment
is assigned a message segment number in the ascending order. The sending
endpoint constructs a MSGin5G message for each of the message segment and
sends them in the ascending order of the message segment number.
2\. The sending endpoint sends the MSGin5G message request (with a message
segment) to the receiving endpoint using the point-to-point messaging
procedure in 6.9.2; the additional information elements in table 6.12.2-1 are
included.
3\. The receiving endpoint stores the message segment payload locally and
sends a MSGin5G message delivery report back to the sending endpoint.
4\. A message segment is lost before it reaches to the receiving endpoint.
5\. The sending endpoint sends a MSGin5G message request (with a message
segment) to the receiving endpoint.
6\. The receiving endpoint detects a missing message segment.
7\. The receiving endpoint reports the missing segment to the sending endpoint
and sends the MSGin5G message deliver report, with addition information
element described in table 6.12.2-2, that includes the missing message segment
number.
8\. The sending endpoint resends the missing message segment in a MSGin5G
message request.
9\. The receiving endpoint receives all the message segments and assembles the
message payloads to its original content. If the message is meant to be
delivered to a legacy 3GPP UE or a non 3GPP UE, the message gateway will use
the appropriate message delivery mechanism to deliver the reassembled message.
### 6.12.3 Segmentation and reassembly in group messaging
The group messaging is described in 6.5. When a payload of the message is over
a configured payload size limit, it needs to be delivered in message segments
with each message segment\'s payload size within the configured payload size
limit.
The procedures for the group messaging segmentation and reassembly are the
same as described in the point-to-point messaging segmentation and reassembly
in clause 6.12.2.
### 6.12.4 Solution Evaluation
This solution proposes to reuse the base point-to-point and group messaging
procedures with additional information elements. The message recipient(s) will
use these additional information elements to learn that a message is being
segmented and needs to apply the segmentation and reassembly procedures, This
solution provides consistency in basic MSGin5G messaging procedures as it
reuses the same procedures as described for sending standalone messages.
## 6.13 Solution 13: MSGin5G Message Segmentation and Reassembly
### 6.13.1 Description
#### 6.13.1.1 General
This solution addresses the identified gaps under Key Issue #14 by introducing
MSGin5G message segmentation and reassembly functionality to the MSGin5G
Service. Application-to-point, Point-to-application, Point-to-point MSGin5G
use cases and group message delivery are supported.
For non-IMS messaging MSGin5G segmentation and reassembly operations are
performed either by the MSGin5G Server or the MSGin5G Client, depending on the
use case. For Application-to-point use case, the MSGin5G Server performs
MSGin5G message segmentation while the MSGin5G Client performs MSGin5G message
reassembly. For Point-to-application use case, the MSGin5G Client performs
MSGin5G message segmentation while the MSGin5G Server performs MSGin5G message
reassembly.
The maximum segmentation size of MSGin5G message is 2048 bytes and can be
configurable.
Editor\'s Note: For each use case, is FFS how the information about the
configured maximum packet size is made available at the entity performing
segmentation.
#### 6.13.1.2 Application-to-point non-IMS Message Segmentation and Reassembly
Figure 6.13.1.2-1 shows the non-IMS message segmentation and reassembly
procedure for Application-to-point MSGin5G message use cases (e.g. AOMT).
Pre-conditions:
1\. A UE hosts a MSGin5G Client and an Application Client.
2\. The MSGin5G Client registers with the MSGin5G Server.
**3\. An Application Server needs to deliver application data to the
Application Client on the UE and the size of the application data exceeds the
maximum allowed packet size (e.g. due to limitation by the UE\'s access
network transport).**
Figure 6.13.1.2-1: Application-to-point MSGin5G Message Segmentation and
Reassembly
1) An Application Server sends a message to a MSGin5G Server that targets an
Application Client on a UE.
2) The MSGin5G Server compares the size of the received message to the maximum
allowed packet size and detects that the size exceeds the limit. As a result,
the MSGin5G Sever segments the received message into a set of segmented
messages. Within each segmented message, the information elements defined in
Table 6.13.1.2-1 are included to enable the MSGin5G Client on the targeted UE
to reassemble the segmented messages.
Table 6.13.1.2-1: Segmentation and Reassembly Information Elements
+---------------------------+------------+---------------------------+ | **Information element** | **Status** | **Description** | +===========================+============+===========================+ | Segmentation Set | M | All segmented messages | | Identifier | | associated within the | | | | same set of segmented | | | | messages (i.e. associated | | | | with the same MSGin5G | | | | message) are assigned the | | | | same unique identifier. | +---------------------------+------------+---------------------------+ | Segment Sequence Number | M | An incrementing counter | | | | that indicates the | | | | sequence number of each | | | | segmented message within | | | | a set of segmented | | | | messages. | +---------------------------+------------+---------------------------+ | Last Segment Flag | O | An indicator of whether | | | | this segmented message is | | | | the last segment in the | | | | set of segmented messages | | | | or not. (See NOTE 1) | +---------------------------+------------+---------------------------+ | Total Segments | O | An integer indicating | | | | total number of segmented | | | | messages associated the | | | | Segmentation Set | | | | Identifier. (See NOTE 2) | +---------------------------+------------+---------------------------+ | NOTE 1: The Last Segment | | | | Flag needs to be included | | | | only in the last segment | | | | of the message. | | | | | | | | NOTE 2: The Total | | | | Segments needs to be | | | | included only in the | | | | first segment of the | | | | message. | | | +---------------------------+------------+---------------------------+
3) The MSGin5G Server sends each segmented message to the targeted UE. The
target UE checks for the Last Segment Flag in each of the received segment
before proceeding to Step 4. If the next segment is not received within the
expected time (based on configuration) then proceed to step 4.
4) If MSGin5G Client has received segment with Last Segment Flag indication,
the MSGin5G Client reassembles all the segmented messages into a single
MSGin5G message based on the information elements defined in Table 6.13.1.2-1.
If any segment(s) is (are) not received before last segment or no segments
received within expected time, then the MSGin5G Client acts as Message
receiver and recovers the segments as described in clause 6.13.1.6 MSGin5G
Message Segment recovery procedure, before continuing with rest of the steps.
Editor\'s Note: For application-to-point messages to UEs without MSGin5G
Clients, reassembly and the responsibility of the Message Gateway in this
procedure are FFS.
5) The MSGin5G Client sends Message status request to the MSGin5G server. The
information elements defined in Table 6.13.1.2-2 are included in the request.
The result information element will contain \"success\" if the reassembly of
the segments is success. Otherwise, the result information element will
contain \"failure\".
Table 6.13.1.2-2: Message Received Confirmation Request Information Elements
**Information element** **Status** **Description**
* * *
Segmentation Set Identifier M The Segmentation Set Identifier as received in
segments. Result M Indicates the \"success\" or \"failure\"
NOTE: The MSGin5G server may send acknowledge back to MSGin5G Client based on
application requirement.
6) If reassembly of segments is success, the MSGin5G Client delivers the
contents of the MSGin5G message to the targeted Application Client. If MSGin5G
client has not received all messages (even after recovery procedure) or
reassembly of segments failed for any reason (e.g. corrupt data) then the
MSGin5G client will notify receiving of failed message to application client.
#### 6.13.1.3 Point-to-application non-IMS Message Segmentation and Reassembly
Figure 6.13.1.3-1 shows the non-IMS message segmentation and reassembly
procedure for Point-to-application MSGin5G message use cases (e.g. MOAT).
Pre-conditions:
1\. A UE hosts a MSGin5G Client and an Application Client.
2\. The MSGin5G Client registers with the MSGin5G Server.
**3\. An Application Client on the UE needs to deliver application data to an
Application Server and the size of the application data exceeds the maximum
allowed packet size (e.g. due to limitation by the UE\'s access network
transport).**
Figure 6.13.1.3-1: Point-to-application MSGin5G Message Segmentation and
Reassembly
1) An Application Client on a UE sends a message to a MSGin5G Client that
targets an Application Server and that has a size that exceeds the maximum
allowed packet size.
2) The MSGin5G Client compares the size of the received message to the maximum
allowed packet size and detects that the size exceeds the limit. As a result,
the MSGin5G Client segments the received message into a set of segmented
messages such that each segmented message can fit within the maximum allowed
packet size. Within each segmented message, the information elements defined
in Table 6.13.1.2-1 are included to enable the MSGin5G Server to reassemble
the segmented messages.
Editor\'s Note: For UEs without MSGin5G Clients, the segmentation of point-to-
application messages and the responsibility of the Message Gateway in this
procedure are FFS.
3) The MSGin5G Client sends each segmented message to the MSGin5G Server. The
MSGin5G Server checks for the Last Segment Flag in each of the received
segment before proceeding to Step 4. If the next segment is not received
within the expected time (based on configuration) then proceed to step 4.
4) If MSGin5G Server has received segment with Last Segment Flag indication in
it, the MSGin5G Server reassembles all the segmented messages into a single
MSGin5G message based on the information elements defined in Table 6.13.1.2-1.
If any segment(s) is (are) not received before last segment or no segments
received within expected time, then the MSGin5G server acts as Message
receiver and recovers the segments as described in clause 6.13.1.6 MSGin5G
Message Segment recovery procedure, before continuing with rest of the steps.
5) The MSGin5G Server sends Message received confirmation to the MSGin5G
client. The information elements defined in Table 6.13.1.2-2 are included in
the request. The result information element will contain \"success\" if the
reassembly of the segments is success. Otherwise, the result information
element will contain \"failure\".
NOTE: The MSGin5G client may send acknowledge back to MSGin5G server based on
application requirement.
6) If reassembly of segments is success, the MSGin5G Server delivers the
contents of the MSGin5G message to the targeted Application Server. If MSGin5G
server has not received all messages (even after recovery procedure) or
reassembly of segments failed for any reason (e.g. corrupt data) then the
MSGin5G server will notify receiving of failed message to application server.
Editor\'s Note: MSGin5G Message Segmentation and Reassembly for broadcast
messages is FFS.
#### 6.13.1.4 Point-to-Point non-IMS Message Segmentation and Reassembly
Figure 6.13.1.4-1 shows the non-IMS message segmentation and reassembly
procedure for Point-to-Point MSGin5G message use cases (e.g. MOMT).
This procedure assumes that a UE is only aware of the maximum payload size of
the delivery mechanism it is currently using, and it is not aware of the
maximum payload size of the recipient UE.
Pre-conditions:
1\. Both UEs host a MSGin5G Client and an Application Client.
2\. The MSGin5G Clients register with the MSGin5G Server.
**3\. An Application Client on the UE needs to deliver application data to an
Application Client on another UE and the size of the application data exceeds
the allowed maximum packet size (e.g. due to limitation by the UE\'s access
network transport).**
Figure 6.13.1.4-1: Point-to-Point MSGin5G Message Segmentation and Reassembly
1) An Application Client on a UE sends a message to a MSGin5G Client that
targets an Application Client on another UE.
2) The MSGin5G Client compares the size of the received message to the maximum
allowed packet size and detects that the size exceeds the limit of the
originating UE. As a result, the MSGin5G Client segments the received message
into a set of segmented messages such that each segmented message can fit
within the maximum allowed packet size. Within each segmented message, the
information elements defined in Table 6.13.1.2-1 are included to enable
reassembly of the segmented messages.
3) The MSGin5G Client sends each segmented message to the MSGin5G Server. The
MSGin5G Server checks for the Last Segment Flag in each of the received
segment before proceeding to Step 4. If the next segment is not received
within the expected time (based on configuration) then proceed to step 4.
4) The MSGin5G Server checks if each segment does not exceed the configured
maximum packet size of the targeted UE. If the maximum packet size is not
exceeded, then the MSGin5G Server proceeds with step 5.
If the maximum packet size is exceeded, then the MSGin5G Server reassembles
subsequent segmented messages, until the Last Segment Flag indication is
received, into a single MSGin5G message. The re-assembled message is then
segmented such that each segment is smaller than the maximum allowed packet
size of the targeted UE. Within each segmented message, the information
elements defined in Table 6.13.1.2-1 are included to enable reassembly at the
target.
5) If MSGin5G client in UE 2 has received segment with Last Segment Flag
indication in it, the MSGin5G Server delivers the contents of the MSGin5G
message to the targeted MSGin5G Client. The MSGin5G Client in UE 2 checks for
the Last Segment Flag in each of the segment received as separate message
before proceeding to Step 7. If the next segment as a separate message is not
received within the expected time (based on configuration) then proceed to
step 7.
6) The 5GMSG Client reassembles all the segmented messages into a single
MSGin5G message based on the information elements defined in Table 6.13.1.2-1.
7) The MSGin5G Server sends Message received confirmation to the MSGin5G
client. The information elements defined in Table 6.13.1.2-2 are included in
the request. The result information element will contain \"success\" if the
reassembly of the segments is success. Otherwise, the result information
element will contain \"failure\".
NOTE: The MSGin5G client may send acknowledge back to MSGin5G server based on
application requirement.
7) The MSGin5G Client delivers the contents of the MSGin5G message to the
targeted Application Client. If MSGin5G client has not received all messages
(even after recovery procedure) or reassembly of segments failed for any
reason (e.g. corrupt data) then the MSGin5G client will notify receiving of
failed message to application client.
#### 6.13.1.5 Group Message Segmentation and Reassembly
A Group Message is sent from the MSGin5G Server to a group of recipient UEs.
The MSGin5G Server sends the message to each individual recipient taking into
account the maximum packet size that is supported by the recipient and
segments the message as described in clause 6.13.1.4.
Editor\'s Note: For group member UEs without MSGin5G Client, how the
segmentation is carried out and the responsibility of the Message Gateway in
this procedure are FFS
#### 6.13.1.6 MSGin5G message segment recovery
Figure 6.13.1.6-1 illustrates an MSGin5G message Segmentation recovery
procedure. The procedure is applicable to application-to-point messages,
point-to-application messages, group messages and broadcast messages.
Pre-conditions:
1\. The Message sender has delivered segmented messages to Message receiver.
Figure 6.13.1.6-1: MSGin5G Message Segmentation and Reassembly
1) The Message Receiver detects that few segments are missing to reassemble
complete message.
2) The Message receiver sends Segment recovery request to Message sender. The
information elements defined in Table 6.13.1.6-1 are included in the request
message.
Table 6.13.1.6-1: Segment Recovery Request Information Elements
Information element Status Description
* * *
Segmentation Set Identifier M The Segmentation Set Identifier as received in
segments. List of Segment range M List of Segment range which the client wants
to recover, each segment range consist of start and end sequence number of
missing segments e.g. (5-7, 10-10, 15-19)
3) The Message sender sends Segment recovery acknowledgement to the MSGin5G
Client.
4) The Message Sender sends each segmented message to the Message Receiver
within an individual access network transport packet. If the next segment is
not received within the expected time (based on configuration) then the
Message Receiver may consider as recovery failed or may initiate the procedure
again with updated list of segment range.
NOTE: The MSGin5G message segment recovery procedure may repeat based on the
configuration.
### 6.13.2 Impacts on existing nodes and functionality
The solutions introduced in clauses 6.13.1.2 and 6.13.1.3 enables the MSGin5G
Service to support segmentation and reassembly capabilities which can be
layered over top of existing delivery mechanisms that do not support
segmentation and reassembly. Therefore, the impact on existing nodes and
functionality is minimal.
### 6.13.3 Solution evaluation
The solution introduced in clauses 6.13.1.2 and 6.13.1.3 enables the MSGin5G
Service to support segmentation and reassembly of non-IMS messages when the
size of a MSGin5G exceeds the maximum packet size. By supporting segmentation
and reassembly, the MSGin5G Service can improve the overall performance and
efficiency of the system. The solution is applicable for use case scenarios
that support a MSGin5G Client and MSGin5G Server in the communication path.
For MSGin5G use case scenarios that do not include a MSGin5G Client (e.g.
legacy UE), this solution is not applicable.
## 6.14 Solution 14: Acknowledgement of Delivery Status
### 6.14.1 Description
The present solution addresses the issues raised in Key Issue #1 for all
scenarios as described in clause 4.
The present solution leaves it to the message originator (Application Client
or Application Server) to indicate if acknowledgement of the delivery status
is required and the originator indicates this by adding the _Disposition Type_
IE in the message as proposed in solution 5.
The present solution assumes that the acknowledgement will be provided by the
recipient endpoint and will be an application level acknowledgement, which
also allows signalling MSGin5G application errors.
The present solution is an alternative to deriving an acknowledgement from a
request-response type message. Deriving an acknowledgement from a request-
response type message is not always possible for the following reasons:
\- For non-3GPP type message delivery any response message from a non-3GPP UE
is out of scope.
\- A broadcast message is downlink only and a response message does not exist.
\- If a recipient UE is unavailable and the message is stored until the UE is
available again then the response is delayed by minutes, hours or even days
and any underlying transport connection may have timed out.
\- If all members of the group need to acknowledge the delivery status for a
group message then aggregating all responses is problematic if one or more UEs
are unavailable and delivery is delayed.
An acknowledgement is possible when the message recipient receives a message
and the _Disposition Type_ IE is present, the recipient generates an
acknowledgement message and sends it to the message originator in a point-to-
point delivery as described in scenario 1 in clause 4.2.
### 6.14.2 Impacts on existing nodes and functionality
The present solution uses MSGin5G point-to-point message delivery and has no
impact above the impact that the MSGin5G service has.
### 6.14.3 Solution evaluation
Point-to-point message delivery in MSGin5G uses the same delivery method as
the proposed acknowledgement.
## 6.15 Solution 15: Point to point Messaging (UE reply a message)
### 6.15.1 Description
This solution is a point-to-point message solution for Legacy 3GPP UE or
Non-3GPP UE replying a message to MSGin5G UE.
#### 6.15.1.1 SMS UE replying a message to MSGin5G UE
Figure 6.15.3-1 shows the solution of a SMS UE (i.e. a Legacy 3GPP UE with SMS
Client) replying a message to a MSGin5G UE.
Pre-conditions:
1) MSGin5G client in MSGin5G UE and SMS Client in SMS UE has registered with
the MSGin5G server.
Editor\'s Note: The SMS UE registration procedure is FFS.
2) The SMS UE received a message from the MSGin5G UE.
3) The Legacy 3GPP message gateway is aware of the SMS client and provides the
mapping to MSGin5G service ID.
4) The SMS UE replies to the MSGin5G UE upon receiving the message from the
MSGin5G UE.
Figure 6.15.1.2-1: SMS UE replies to MSGin5G UE
1) The SMS UE sends an SMS message request to the Legacy 3GPP Message Gateway
through SMSC according the procedure in 3GPP TS 23.204 [15] or the procedure
in clause 4.13.3 of TS 23.502 [10]. The delivery report is requested in the
message.
NOTE: If the delivery report is not requested this procedure will stop after
step 3 and step 4 to 6 will not be needed.
2) The Legacy 3GPP Message Gateway translates the SMS message to MSGin5G
message with delivery report requested and sends a MSGin5G message request to
the MSGin5G Server, including the IEs of MSGin5G message according to the
table 6.15.1.2-1.
Table 6.15.1.2-1: MSGin5G message request
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
message. Recipient MSGin5G service ID M The service identity of the recipient
receiving the message. Message ID M Unique identifier of this message Delivery
report O Indicates if delivery acknowledgement is requested Application ID O
Identifies the application client for which the payload is intended. Payload M
Payload of the message
3) The MSGin5G Server forwards the MSGin5G message request to the target
MSGin5G Client in a MSGin5G UE.
4) The MSGin5G Client in MSGin5G UE sends an MSGin5G message delivery report
to the MSGin5G Server.
5) The MSGin5G Server forwards the MSGin5G message delivery report to the
Legacy 3GPP Message Gateway.
6) The Legacy 3GPP Message Gateway translates the MSGin5G message delivery
report to a SMS message delivery report and sends it to the SMS Client through
SMSC.
#### 6.15.1.2 Non-3GPP UE replying a message to MSGin5G UE
Figure 6.15.3-1 shows the solution of a Non-3GPP UE (e.g. RCS, LwM2M) replying
a message to a MSGin5G UE.
Pre-conditions:
1) MSGin5G client in MSGin5G UE and Non-3GPP UE has registered with the
MSGin5G server.
Editor\'s Note: The Non-3GPP UE registration procedure is FFS.
2) The Non-3GPP UE received a message from the MSGin5G UE.
3) The Non-3GPP Message Gateway is aware of the Non-3GPP message client on the
Non-3GPP UE and provides the mapping to MSGin5G service ID.
4) The Non-3GPP UE replies to the MSGin5G UE upon receiving the message from
the MSGin5G UE.
Figure 6.15.1.2-1: Non-3GPP UE replies to MSGin5G UE
1) The Non-3GPP message client in Non-3GPP UE sends a Non-3GPP message request
to the Non-3GPP Message Gateway. The delivery report is requested in the
message.
NOTE: If the delivery report is not requested this procedure will stop after
step 3 and step 4 to 6 will not be needed.
2) The Non-3GPP Message Gateway translates the Non-3GPP message to MSGin5G
message with delivery report requested and sends a MSGin5G message request to
the MSGin5G Server, including the IEs of MSGin5G message according to the
table 6.15.1.2-1.
Table 6.15.1.2-1: MSGin5G message request
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
message. Recipient MSGin5G service ID M The service identity of the recipient
receiving the message. Message ID M Unique identifier of this message Delivery
report O Indicates if delivery acknowledgement is requested Application ID O
Identifies the application client for which the payload is intended. Payload M
Payload of the message
3) The MSGin5G Server forwards the MSGin5G message request to the target
MSGin5G Client in a MSGin5G UE.
4) The MSGin5G Client in MSGin5G UE sends an MSGin5G message delivery report
to the MSGin5G Server.
5) The MSGin5G Server forwards the MSGin5G message delivery report to the
Non-3GPP Message Gateway.
6) The Non-3GPP Message Gateway translates the MSGin5G message delivery report
to a Non-3GPP message delivery report and sends it to the Non-3GPP message
client.
### 6.15.2 Solution Evaluation
The solution in 6.15.1.1 is applicable for the SMS UE which is IMS or non-IMS
based UE. This solution enables message reply from SMS UE (Legacy UE with SMS
client) to MSGin5G UE, it requires Legacy 3GPP Message Gateway can be aware of
SMS client on the SMS UE and provides the mapping to MSGin5G service ID. It
requires the SMS UE registered with the MSGin5G server. It follows the SMS
procedure in 3GPP TS 23.204 [15] or the procedure in clause 4.13.3 of TS
23.502 [10].
The solution in 6.15.1.2 is applicable for the Non-3GPP UE which has a
Non-3GPP message client. This solution enables message reply from Non-3GPP UE
to MSGin5G UE, it requires Non-3GPP Message Gateway can be aware of the
Non-3GPP message client on the Non-3GPP UE and can provide the mapping to
MSGin5G service ID. It requires the Non-3GPP UE registered with the MSGin5G
server. It has no impact on current Non-3GPP Message Service procedure.
## 6.16 Solution 16: Use of Broadcast Area configuration in MSGin5G message
broadcast
### 6.16.1 Description
The present solution addresses the issues raised in Key Issue #10.
The service requirement of broadcast area configuration states that the
MSGin5G Service shall support an authorized Application Server or UE to send a
broadcast message to all the UEs within a specific area which is configured
according to application policy.
Since the broadcast area is configured according to application policy it
cannot be freely defined by the message originator and for the message
originator the broadcast area is static once it is defined and is addressable
through a Service Area ID.
Table 6.16.1-1 shows a generic message request. The message request is
broadcast in a service area when the _Service Area ID_ is present.
NOTE: It is left for the normative phase if this ID is a single ID or a list
of IDs.
Table 6.16.1-1: Message Request
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | Originator MSGin5G client | M | The identity of the MSGin5G | | service ID | | client who initiated the | | | | message. | +-----------------------------+--------+-----------------------------+ | Service Area ID | O | The identity of the Service | | | | Area where the broadcast | | | | message is delivered. | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of this | | | | message | +-----------------------------+--------+-----------------------------+ | Disposition Type | O | Indicates the disposition | | | | type expected from the | | | | receiver (i.e. delivery | | | | acknowledgement) | +-----------------------------+--------+-----------------------------+ | Application ID | O | Identifies the application | | | | for which the payload is | | | | intended as specified in | | | | Group Message Request | | | | received from originating | | | | MSGin5G client.\ | | | | This IE will be mapped to a | | | | CB Message Identifier.\ | | | | If this IE is not present a | | | | default CB Message | | | | Identifier will be used. | +-----------------------------+--------+-----------------------------+ | Payload | M | Payload of the message | +-----------------------------+--------+-----------------------------+ | Priority Type | O | Application priority level | | | | requested for this message | | | | as specified in Group | | | | Message Request received | | | | from originating MSGin5G | | | | client. | | | | | | | | This IE will be mapped to a | | | | CB Message Identifier.\ | | | | If this IE is not present a | | | | default CB Message | | | | Identifier will be used. | +-----------------------------+--------+-----------------------------+
### 6.16.2 Impacts on existing nodes and functionality
If the preconfigured broadcast areas are configured on the CBC, then the CBC
needs to support this.
NOTE: For public warning services a CBC supports pre-configured areas, but
there is no 3GPP requirement for this.
### 6.16.3 Solution evaluation
A service area can be configured as a Service Area ID while the shape (e.g. a
polygon) of the service area is stored in the CBC. Addressing the service area
is through the Service Area ID. Alternatively, the shape of the service area
can be stored on the MSGin5G server and addressing the service area is through
providing the shape to the CBC in the message request. Both implementations
exist in public warning system deployments.
## 6.17 Solution 17: Aggregated messaging for small data messages
Editor\'s Note: There may be other ways to aggregate the small data such as
using the Application client, which is FFS.
### 6.17.1 General
This solution addresses the identified gap under Key Issue #19 regarding
efficient resource usage of the control plane and user plane.
As identified in the Key Issue #19, the typical IoT device communication is
sending and receiving small data that can be delivered just in a message. It
may be possible that an IoT device sends data which is significantly smaller
than maximum segment size allowed to transmit over available transport,
resulting in lots of overhead. It is also described in the Key Issue #19 that
there may be use cases with a high number of message communications between
devices or, between devices and application servers. For these cases, control
plane and user plane resources will not be utilized to its full capacity. It
is also described in the Key Issue #19 that MSGin5G communications need to be
well scheduled in order to save power and data traffic consumption at the
device.
This clause introduces a solution for these issues using a procedure to
aggregate MSGin5G messages with typical small data. Based on maximum segment
size allowed to transmit over available transport, the MSGin5G service can
optimize communications by aggregating one or more messages towards the
target.
### 6.17.2 Solution for aggregated point-to-point messaging
#### 6.17.2.1 MSGin5G Client aggregates messages towards target end point
Figure 6.17.2.1-1 shows the procedure for MSGin5G Client aggregating point-to-
point messages carrying small data targeted from a UE towards another target
UE.
Pre-conditions:
1 A UE 1 hosts a MSGin5G Client 1 and an Application Client(s).
2 A UE 2 hosts a MSGin5G Client 2 and an Application Client(s)
3 The MSGin5G Client 1 and MSGin5G Client 2 register with the MSGin5G Server.
Figure 6.17.2.1-1: MSGin5G Client aggregates messages towards target end point
1) Application Client(s) on UE 1 initiates MSGin5G message request to the
MSGin5G Client 1 to send a message to another target.
2) The MSGin5G Client 1 checks the message data size and the priority level to
determine if the received messages can be aggregated. For example, MSGin5G
Client 1 finds that the messages have small payload size when compared to the
maximum segment size that can be transmitted over available transport and are
not high priority messages, which could be sent as per scheduling policy
towards a selected target.
NOTE 1: MSGin5G Client 1 decides to continue aggregating messages until
optimal use of segment size before sending message towards MSGin5G Server.
NOTE 2: How the MSGin5G Client 1 uses individual message priority, maximum
time to wait, etc for aggregating and sending is out of scope of the present
document.
3) The MSGin5G Client 1 aggregates multiple MSGin5G message requests intended
for a selected target and sends the aggregated message request as defined in
Table 6.17.2.1-1 and Table 6.17.2.1-2 according to scheduling policy towards
MSGin5G Server.
Table 6.17.2.1-1: Aggregated message request (MSGin5G Client to MSGin5G
Server)
Information element Status Description
* * *
Originator MSGin5G Client ID M The identity of the MSGin5G Client sending the
message. Destination MSGin5G Client ID M The identity of the target MSGin5G
Client for the message delivery. Message ID M Unique identifier of the
aggregated message Number of individual messages M Indicates total number of
messages which are aggregated into single message List of individual messages
M Each element in this list contains information as specified in Table
6.17.2.1-2.
Table 6.17.2.1-2: Individual message data
Information element Status Description
* * *
Individual Message ID M Unique identifier of this individual message
Application ID O Identifies the application for which the payload is intended
Disposition Type O Indicates the disposition type expected from the receiver
(i.e. delivery report) Payload M Payload of the message Priority Type O
Application priority level requested for this message.
NOTE 3: Total size of Aggregated message request is less than or equal to
maximum segment size allowed to be transmitted over available transport.
4) MSGin5G server checks whether the MSGin5G Client 1 is authenticated and
authorized to send Aggregated message request. If authenticated and
authorized, the MSGin5G server skips step 5.
5) If MSGin5G Client 1 is not authorized to send Aggregated message request or
the Aggregated message request is not valid, the MSGin5G server sends
Aggregated message reject to the MSGin5G Client 1. The information elements
defined in Table 6.17.2.1-3 are included in the request.
Table 6.17.2.1-3: Aggregated message reject (MSGin5G Server to MSGin5G Client)
Information element Status Description
* * *
Destination MSGin5G Client ID M The identity of the MSGin5G Client sending the
original message. Message ID M Unique identifier of this message Reject Reason
O This IE contains the failure reason, e.g. the originator is not authorized
to send a message request or one of the multiple messages aggregated has an
issue, may be included in this IE.
6) If MSGin5G Client 1 is authorized to send Aggregated message request, the
MSGin5G server sends Aggregated message request towards the selected target
MSGin5G Client 2.
7) The MSGin5G Client 2 splits the received Aggregated message request into
multiple individual MSGin5G message requests per application and sends them
towards Application Client(s).
8) The Application Client(s) may initiate sending MSGin5G message delivery
report, if requested in the original message that is received as in Step 7.
MSGin5G Client 2 forwards the MSGin5G message delivery report towards the
Application Client(s) on UE 1 via MSGin5G Server and MSGin5G Client 1.
### 6.17.3 Solution for aggregated application-to-point messaging
#### 6.17.3.1 MSGin5G Server aggregates messages towards target end point
Figure 6.17.3.1-1 shows the procedure for MSGin5G Server aggregating
application-to-point messages carrying small data targeted towards the target
UE.
Pre-conditions:
1\. A UE 1 hosts a MSGin5G Client 1 and Application Client(s).
2\. The MSGin5G Client 1 registers with the MSGin5G Server.
3\. An Application Server needs to deliver application data to Application
Client(s) on UE 1.
Figure 6.17.3.1-1: MSGin5G Client aggregates messages towards target end point
1) The Application server initiates to send application-to-point message
towards target UE 1 and sends the MSGin5G Message Request to MSGin5G server.
2) The MSGin5G server checks the message data size and the priority level to
determine if the received messages can be aggregated. For example, MSGin5G
server finds that the messages have small payload size when compared to the
maximum segment size that can be transmitted over available transport and are
not high priority messages, which could be sent as per scheduling policy
towards a selected target.
NOTE 1: MSGin5G Server decides to continue aggregating messages until optimal
use of segment size before sending message towards MSGin5G Client 1.
3) The MSGin5G server aggregates multiple MSGin5G message requests intended
for the target UE and sends the aggregated message request as defined in Table
6.17.3.1-1 and Table 6.17.3.1-2 according to scheduling policy towards the
MSGin5G Client 1.
Table 6.17.3.1-1: Aggregated message request (MSGin5G Server to MSGin5G
Client)
Information element Status Description
* * *
Destination MSGin5G Client ID M The identity of the MSGin5G Client of the
receiver UE. Message ID M Unique identifier of this message Number of
individual messages M Indicates total number of messages which are aggregated
into single message List of Individual messages M Each element in this list
contains information as specified in Table 6.17.3.1-2.
Table 6.17.3.1-2: Individual message data
Information element Status Description
* * *
Individual Message ID O Unique identifier of this individual message
Application ID M Identifies the application for which the payload is intended
Disposition Type O Indicates the disposition type expected from the receiver
(i.e. delivery report) Payload O Payload of the message Priority Type O
Application priority level requested for this message.
NOTE 2: Total size of Aggregated message request is less than or equal to
maximum segment size allowed to transmit over available transport.
4) The MSGin5G Client 1 splits the received Aggregated message request into
multiple individual MSGin5G message requests per application and sends towards
Application Client(s) as notifications.
### 6.17.4 Solution for aggregated group messaging
Editor\'s Note: There may be other ways to aggregate the small data such as
using the Application client, which is FFS.
#### 6.17.4.1 MSGin5G Client aggregates messages towards target group
Figure 6.17.4.1-1 shows the procedure for MSGin5G Client aggregating messages
carrying small data targeted towards a group. The messages may be initiated
from one or more application client(s).
Pre-conditions:
1\. A MSGin5G Group is created by following group management SEAL service
procedures as specified in 3GPP TS 23.434 [9].
2\. All participants in the MSGin5G Group may get the Group information i.e. a
list of group members in the Group information query response as specified in
3GPP TS 23.434 [9].
3\. A UE hosts a MSGin5G Client 1 and Application Client(s).
4\. The MSGin5G Client 1 registers with the MSGin5G Server.
Figure 6.17.4.1-1: MSGin5G Client aggregates messages towards target group
1) The Application Client(s) on UE 1 requests MSGin5G Client 1 to send
message(s) to a group.
2) The MSGin5G Client 1 checks the message data size and the priority level to
determine if the received messages can be aggregated. For example, MSGin5G
Client 1 finds that the messages have small payload size when compared to the
maximum segment size that can be transmitted over available transport and are
not high priority messages, which could be sent as per scheduling policy
towards a selected target.
NOTE 1: MSGin5G Client 1 decides to continue aggregating messages until
optimal use of segment size before sending message towards MSGin5G Server.
NOTE 2: How the MSGin5G Client 1 uses individual message priority, maximum
time to wait for messages, etc for aggregating and sending is out of scope of
the present document.
3) The MSGin5G Client 1 aggregates multiple MSGin5G message requests intended
for a selected target group and sends the aggregated message request as
defined in Table 6.17.4.1-1 and Table 6.17.4.1-2 according to scheduling
policy towards MSGin5G Server.
Table 6.17.4.1-1: Aggregated group message request (MSGin5G Client to MSGin5G
Server)
Information element Status Description
* * *
Originator MSGin5G Client ID M The identity of the MSGin5G Client sending the
message. Group ID M The identifier of the MSGin5G group. Message ID M Unique
identifier of this message Number of individual messages M Indicates total
number of messages which are aggregated into single message List of Individual
Group Message data M Each element in this list contains information as
specified in Table 6.17.4.1-2.
Table 6.17.4.1-2: Individual message data
Information element Status Description
* * *
Individual Message ID M Unique identifier of this individual message
Application ID O Identifies the application for which the payload is intended
Disposition Type O Indicates the disposition type expected from the receiver
(i.e. delivery report) Payload M Payload of the message Priority Type O
Application priority level requested for this message.
NOTE 3: Total size of Aggregated Group Message Request is less than or equal
to maximum segment size allowed to be transmitted over available transport.
4) MSGin5G server checks whether the MSGin5G Client 1 is authenticated and
authorized to send Aggregated Group Message Request. If authorized, the
MSGin5G server resolves the MSGin5G group ID to determine the members of that
group and determines the registration status of non-IMS UEs, based on the
information from the group management server. The MSGin5G server validates the
request based on the policy e.g. to limit certain types of message or content
to certain members due to location or user privilege. If authenticated and
authorized, the MSGin5G server skips step 5.
5) If MSGin5G Client 1 is not authorized to send Aggregated Group Message
Request or the Aggregated group message request is not valid, the MSGin5G
server sends Aggregated Group Message Reject message to the MSGin5G Client 1.
The information elements defined in Table 6.5.1.3-2 are included in the
Aggregated Group Message Reject message.
6) If MSGin5G Client 1 is authorized to send Aggregated Group Message Request,
the MSGin5G server sends group message as specified in step#2 onwards clause
6.5.1.2, where instead of group message request, Aggregated Group Message
request will be sent.
### 6.17.5 Solution evaluation
Typical IoT device communication is sending and receiving small data that can
be delivered just in a message and it is possible that the small data is
significantly smaller than the maxmimum segment size allowed to transmit. The
solution introduced in 6.17.2, 6.17.3 and 6.17.4 enables aggregated messaging
(point-to-point, application-to-point, and group messaging) for efficient
resource usage of the control plane and user plane.
## 6.18 Solution 18: Interconnection
### 6.18.1 Description
This solution addresses the identified gap under Key Issue #17 regarding
interconnection.
### 6.18.2 Message delivery between MSGin5G Clients in different PLMNs
Pre-condition:
1\. MSGin5G UE1 (MSGin5G Client1) registered to the MSGin5G Server1 in one
PLMN.
2\. MSGin5G UE2 (MSGin5G Client2) registered to the MSGin5G Server2 in another
PLMN.
3\. MSGin5G Server 1 and MSGin5G Server 2 has established a secured
connection.
Figure 6.18.2-1 shows message delivery between MSGin5G UEs in different PLMNs
Figure 6.18.2-1: Message delivery between MSGin5G UEs in different PLMNs
1) The MSGin5G Client1 in MSGin5G UE1 sends an MSGin5G message request to
MSGin5G Server1 in one PLMN, the target of the message is MSGin5G Client2 in
MSGin5G UE2 in different PLMN. The delivery report is requested in the
message.
2) The MSGin5G Server1 analyses the target MSGin5G service ID and determines
that the message is to the MSGin5G UE2 in PLMN2, authenticates that the
MSGin5G UE1 is allowed to send a message to the MSGin5G UE2, and then the
MSGin5G Server1 forwards the MSGin5G message request to MSGin5G Server2 in
PLMN2.
3) MSGin5G Server2 forwards the MSGin5G message request to the MSGin5G Client2
in MSGin5G UE2.
4) The MSGin5G Client2 sends a MSGin5G message delivery report to the MSGin5G
Server2.
5) The MSGin5G Server2 forwards the MSGin5G message delivery report to the
MSGin5G Server1.
6) The MSGin5G Server1 forwards the MSGin5G message delivery report to the
MSGin5G Client1.
## 6.19 Solution 19: MSGin5G application enabler layer adaptation to CAPIF
### 6.19.1 Solution description
The MSGin5G Server and Application Server may support CAPIF. When CAPIF is
supported:
\- The MSGin5G server shall support the CAPIF API provider domain functions
(i.e. CAPIF-2/2e, CAPIF-3/3e, CAPIF-4/4e and CAPIF-5/5e as specified in 3GPP
TS 23.222 [5]) as shown in Figure 6.19.1-1;
\- The Application Server shall act as API invoker and support the API invoker
functions (i.e. CAPIF-1/1e and CAPIF-2/2e as specified in 3GPP TS 23.222 [5])
as shown in Figure 6.19.1-1.
Figure 6.19.1-1: MSGin5G adaptation to the CAPIF architecture
### 6.19.2 Solution evaluation
This solution provides a viable solution for key issue#26 for MSGin5G
server\'s capability exposure to application specific server using CAPIF. No
additional changes are required in CAPIF for this solution. Consumers of
MSGin5G Server APIs other than Application Server is out of scope of the
present document and could be potentially specified during the normative
phase.
## 6.20 Solution 20: Support of multiple delivery mechanisms for legacy 3GPP
UEs
### 6.20.1 Description
This clause addresses identified gaps about message delivery to Legacy 3GPP
UEs when multiple delivery mechanisms are supported.
### 6.20.2 Overview of message delivery to Legacy 3GPP UE
Pre-condition:
1) The MSGin5G server received an MSGin5G message request, the target of this
MSGin5G message includes a Legacy 3GPP UE.
2) The MSGin5G server is able to determine whether a terminating UE is a
Legacy 3GPP UE, and which message delivery mechanisms are available (e.g.
target resolution and Gateway selection mechanisms in clause 8.3.2.1).
3) The Legacy 3GPP Message Gateway is provided by the MSGin5G Server with
information on service IDs to maintain mappings to the IDs used in the legacy
network
Figure 6.20.2-1 shows message delivery from MSGin5G Server to the Legacy 3GPP
UE.
Figure 6.20.2-1: Message delivery from MSGin5G server to Legacy 3GPP UE
1) The MSGin5G server receives an MSGin5G message request
2) The MSGin5G server determines the message service supported by the target
UE based on registration status of MSGin5G service ID of the target UE and
identifies that the target UE is a Legacy 3GPP UE.
3) The MSGin5G server selects the Legacy 3GPP Message Gateway corresponding to
the target UE based on available mapping and forwards the MSGin5G message.
4）
a) The Legacy 3GPP Message Gateway maps the service ID to the corresponding
identifier based on Legacy 3GPP UE capability, the UE communication status,
the MSGin5G service configuration, etc. For example (the following is not an
exhaustive list):
i. For the Device triggering delivery mechanism, it maps the service ID to
MSISDN and Application port ID
ii. For NIDD delivery mechanism it maps the service ID to External Identifier
or MSISDN.
NOTE: The examples above show how the Legacy 3GPP Message Gateway can enable
the MSGin5G message delivery via a variety of available delivery mechanisms.
Implementation and configuration choices may limit the delivery mechanisms
available.
Editor\'s note: How the choice of delivery mechanism is made is FFS.
b) The Legacy 3GPP Message Gateway maps MSGin5G message Information Elements
and payload depending on delivery mechanism.
5-7) The Legacy 3GPP Message Gateway sends the payload of the MSGin5G message
to the terminating Legacy 3GPP UE using the determined delivery mechanism. For
example:
i. For Device triggering delivery mechanism, the Legacy 3GPP Message Gateway
interacts with the MTC-IWF/SCEF/NEF and maps the payload of the MSGin5G
message to one or more Device Triggering requests. The MTC-IWF/SCEF/NEF
interacts with SMS-SC for delivery to the UE and to receive the Message
Delivery Report (see TS 23.682 [3] clause 5.2, TS 29.122 [16] clause 4.4.6, TS
29.522 [17] clause 4.4.3)
ii. For NIDD delivery mechanism, the Legacy 3GPP Message Gateway may interact
with the SCEF/NEF and maps the payload of the MSGin5G message to one or more
NIDD submit request messages. The Reliable Data Service Configuration, Maximum
Latency, Priority, PDN Connection Establishment Option settings are based on
pre-configurations (see TS 23.682 [3] clause 5.13, TS 29.122 [16] clause
4.4.5.3, TS 29.522 [17] clause 4.4.12.3). Alternatively, if tunnel parameters
are provisioned in the Legacy 3GPP Message Gateway and UPF/P-GW the payload
could be tunnelled via the UPF/P-GW (see 23.401 [18] (clause 4.3.17.8.3.3) ,
23.501[14] clause 5.6.10.3, 23.502 [10] clause 4.24)
> The Legacy 3GPP UE receives the payload of the MSGin5G message and the
> mapped Information Elements and interprets them depending on the receiving
> client.
8) The Legacy 3GPP Message Gateway may send MSGin5G delivery report to the
MSGin5G Server.
9) The MSGin5G Server may send MSGin5G delivery report to the Application
Server.
### 6.20.3 Solution Evaluation
This solution describes how the MSGin5G Service can enable the use of multiple
delivery mechanisms (e.g. NIDD, device triggering) without exposing management
of these mechanisms to the applications. The solution enables the MSGin5G
Service to provide such delivery mechanisms as alternatives to those described
in Solutions 9 and 10
## 6.21 Solution 21: Store-and-forwarding of MSGin5G messages
### 6.21.1 Description
#### 6.21.1.1 General
This solution enables a MSGin5G Service to support store-and-forwarding of
MSGin5G messages.
#### 6.21.1.2 Store-and-forwarding of MSGin5G messages
Figure 6.21.1.2-1 shows the procedure for store-and-forwarding of MSGin5G
messages.
Pre-conditions:
1) A UE hosts a MSGin5G Client and/or Application Specific Client which are
supported by the MSGin5G Service.
2) The MSGin5G Client registers with the MSGin5G Server and shares UE contact
information.
**3) The UE becomes unreachable by the MSGin5G Server.**
Figure 6.21.1.2-1: Store-and-Forward Procedure
1\. An Application Server sends a message to a MSGin5G Server to forward to a
targeted Application Client on a MSGin5G UE.
2\. The MSGin5G Server determines that the message target is not available to
receive the message based on one or more of the following methods:
a) Detecting that a targeted UE does not have a network connection established
or active. The MSGin5G Server may interwork with 5GS to collect this
information.
b) Using the availability information that the MSGin5G Client provides to the
MSGin5G Server in the MSGin5G Client Profile (Table 6.2.1.2-1).
3\. The MSGin5G Server stores the message until the message target become
available. To determine the availability of the message target, the MSGin5G
Server may use the availability information as described in step #2.
Alternatively, in order to determine availability, the MSGin5G Server may
interwork with an access network to determine whether the targeted UE has an
access network connection established or active (e.g. via monitoring events
such as Loss of Connectivity, UE reachability, Communication failure etc., see
3GPP TS 23.502 clause 4.15.3)
**If the message storage expiration time expires before the target becomes
available, the MSGin5G Server may discard the message and proceeds to step 8,
returning an error to the message originator in the delivery report. The
MSGin5G Server uses a storage expiration time based on:**
a) optional storage expiration time parameter, as defined in Table 6.21.1.2-1,
if provided by the message originator, or
b) storage expiration time local policies
Table 6.21.1.2-1: MSGin5G Message Storage expiration time
Information element Status Description
* * *
Storage expiration time O Indicates when the message should be discarded, if
stored
NOTE: This solution assumes a message acknowledgement solution defining the
delivery report message and stage 3 defining the necessary error codes.
4\. The MSGin5G Server detects that the message target is available using the
same availability determination method as in step #2.
5\. The MSGin5G Server sends MSGin5G Message request(s) forwarding any
messages that are stored for the message target. When forwarding stored
messages, the MSGin5G Server may use the information provided in the Priority
Type IE (Table 6.5.1.3-1).
NOTE: This solution assumes that an Application-to-point message exchange
solution defines the messages in steps 5 and 7.
6\. The MSGin5G Client delivers the message to the Application Client
7\. An MSGin5G message delivery report is sent by the MSGin5G client to the
MSGin5G Server
8\. The MSGin5G Server provides an MSGin5G delivery report to the originator
### 6.21.2 Impacts on existing nodes and functionality
The solution introduced in clause 6.21.1.2 enables a MSGin5G Server to provide
store-and-forward capabilities with no backwards compatibility issues or
impacts.
### 6.21.3 Solution evaluation
The solution introduced in clause 6.21.1.2 enables the MSGin5G Service to
support store-and-forwarding of MSgin5G messages when a targeted UE is
unavailable to receive the messages. By supporting store-and-forwarding of
messages, the MSGin5G Service can improve the overall performance and
efficiency of the system.
## 6.22 Solution 22: MOAT Messaging
### 6.22.1 Description
This solution is for a MOAT (UEs to App Server) messaging.
#### 6.22.1.1 MSGin5G UE sending/replying a message to Application Server
Figure 6.22.1.1-1 shows the solution of a MSGin5G UE sending/replying a
message to an APP Server.
Pre-conditions:
1) The APP Server and MSGin5G Client in MSGin5G UE has registered with the
MSGin5G server.
Figure 6.22.1.1-1: MSGin5G UE sending/replying a message to App Server
1) The MSGin5G UE sends an MSGin5G message request to MSGin5G Server through
5GC. The delivery report is requested in the message.
Table 6.22.1.1-1: MSGin5G message request
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
message. AS service ID M The service identity of the recipient (i.e.
application server) receiving the message. Message ID M Unique identifier of
this message Delivery report O Indicates if delivery acknowledgement is
requested Application ID O Identifies the application for which the payload is
intended. Payload M Payload of the message
NOTE 1: If the delivery report is not requested this procedure will stop after
step 3 and step 4 will not be needed.
2) The MSGin5G Server sends the application request to the target App Server
for delivering message payload.
NOTE 2: The application request can be any request (e.g. API request)
supported by the App Server.
3) The App Server sends a response corresponding to the application request in
step 2.
4) Based on the response in step 3, the MSGin5G Server sends the MSGin5G
message delivery report to the MSGin5G UE based on the received delivery
status in step 3.
#### 6.22.1.2 Legacy 3GPP UE replying a message to Application Server
Figure 6.22.1.2-1 shows the solution of a SMS UE (i.e. a Legacy 3GPP UE with
SMS Client) replying a message to an APP Server.
Pre-conditions:
1) APP Server and SMS Client in SMS UE has registered with the MSGin5G server.
2) The SMS UE received a message from the App Server.
3) The Legacy 3GPP message gateway is aware of the SMS client and provides the
mapping to MSGin5G service ID.
4) The SMS UE replies to the MSGin5G UE upon receiving the message from the
APP Server.
Figure 6.22.1.2-1: SMS UE replies to App Server
1) The SMS UE sends an SMS message request to the Legacy 3GPP Message Gateway
through SMSC according the procedure in 3GPP TS 23.204 [15] or the procedure
in clause 4.13.3 of TS 23.502 [10]. The delivery report is requested in the
message.
NOTE 1: If the delivery report is not requested this procedure will stop after
step 4 and step 5 to 6 will not be needed.
2) The Legacy 3GPP Message Gateway translates the SMS message to MSGin5G
message with delivery report requested and sends a MSGin5G message request to
the MSGin5G Server, including the IEs of MSGin5G message according to the
table 6.22.1.2-1.
Table 6.22.1.2-1 MSGin5G message request
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
message. AS service ID M The service identity of the recipient (i.e.
application server) receiving the message. Message ID M Unique identifier of
this message Delivery report O Indicates if delivery acknowledgement is
requested Application ID O Identifies the application for which the payload is
intended. Payload M Payload of the message
3) The MSGin5G Server sends the application request to the target App Server
for delivering message payload.
NOTE 2: The application request can be any request (e.g. API request)
supported by the App Server.
4) The App Server sends a response corresponding to the application request in
step 3.
5) Based on the response in step 4, the MSGin5G Server sends the MSGin5G
message delivery report to the Legacy 3GPP Message Gateway based on the
received delivery status from App Server.
6) The Legacy 3GPP Message Gateway translates the MSGin5G message delivery
report to a SMS message delivery report and sends it to the SMS Client through
SMSC.
#### 6.22.1.3 Non-3GPP UE replying a message to Application Server
Figure 6.22.1.3-1 shows the solution of a Non-3GPP UE (e.g. RCS, LwM2M)
replying a message to a MSGin5G UE.
Pre-conditions:
1) APP Server and Non-3GPP UE has registered with the MSGin5G server.
2) The Non-3GPP UE received a message from the App Server.
3) The Non-3GPP Message Gateway is aware of the Non-3GPP message client on the
Non-3GPP UE and provides the mapping to MSGin5G service ID.
4) The Non-3GPP UE replies to the App Server upon receiving the message from
the App Server.
Figure 6.22.1.3-1: Non-3GPP UE replies to MSGin5G UE
1) The Non-3GPP message client in Non-3GPP UE sends a Non-3GPP message request
to the Non-3GPP Message Gateway. The delivery report is requested in the
message.
NOTE 1: If the delivery report is not requested this procedure will stop after
step 4 and step 5 to 6 will not be needed.
2) The Non-3GPP Message Gateway translates the Non-3GPP message to MSGin5G
message with delivery report requested and sends a MSGin5G message request to
the MSGin5G Server, including the IEs of MSGin5G message according to the
table 6.22.1.3-1
Table 6.22.1.3-1: MSGin5G message request
Information element Status Description
* * *
Originator MSGin5G service ID M The service identity of the sender sending the
message. AS service ID M The service identity of the recipient (i.e.
application server) receiving the message. Message ID M Unique identifier of
this message Delivery report O Indicates if delivery acknowledgement is
requested Application ID O Identifies the application for which the payload is
intended. Payload M Payload of the message
3) The MSGin5G Server sends the application request to the target App Server
for delivering message payload.
NOTE 2: The application request can be any request (e.g. API request)
supported by the App Server.
4) The App Server sends a response corresponding to the application request in
step 3.
5) Based on the response in step 4, the MSGin5G Server sends the MSGin5G
message delivery report to the Legacy 3GPP Message Gateway based on the
received delivery status from App Server.
6) The Non-3GPP Message Gateway translates the MSGin5G message delivery report
to a SMS message delivery report and sends it to the Non-3GPP message client.
### 6.22.2 Solution Evaluation
These solutions enables message delivery from UEs (MSGin5G UE, Non-3GPP UE and
Legacy 3GPP UE) to Application Server. The message is delivered from UEs to
MSGin5G server, then the MSGin5G server delivers the message payload to the
Application Server by application request supported by the Application Server.
It requires MSGin5G Server gets and knows the capability of the Application
Server by the registration of Application Server. It is a flexible solution
that it need not the Application Server support receiving MSGin5G message
request.
## 6.23 Solution 23: APIs provided by MSGin5G server
### 6.23.1 Description
This solution addresses the following identified issues and gaps related with
the interaction between AS and MSGin5G Server under Key Issue #9.
### 6.23.2 APIs provided to Application Server
MSGin5G server provides restful APIs to Application Server.
#### 6.23.2.1 Application-to-Point Message Delivery API
MSGin5G server provides Application-to-Point Message Delivery API to
Application Server.
The Application Server may use this API with the information elements in Table
6.11.1.4-1 for delivering a message to a recipient (i.e. a UE).
#### 6.23.2.2 Broadcast Message Delivery API
MSGin5G server provides Broadcast Message Delivery API to Application Server.
The Application Server may use this API with the information elements in Table
6.23.2.2-1 for delivering broadcast message to UEs in a Service Area.
Table 6.23.2.2-1: Message Delievery API request
Information element Status Description
* * *
Originator ID M The identifier of Application Server Service Area ID M The
identifier of Group if the message is broadcast message. Application ID O The
identifier of application Message Content M Message content that will be used
as a payload of a MSGin5G message Security Credentials O Security information
required by the MSGin5G Server.
#### 6.23.2.4 Application Server Registration API
MSGin5G server provides Application Server Registration API to Application
Server, the Application Server may use this API to register on the MSGin5G
Server. The API request includes the information elements in Table 6.11.1.3-1,
the API response includes the information elements in Table 6.11.1.3-2.
### 6.23.3 Solution evaluation
This solution defines the MSGin5G server exposing APIs to the consumers i.e.
application server. Currently Application-to-Point Message Delivery API,
Broadcast Message Delivery API and Application Server Registration API are
identified. Need for Group message delivery API is yet to be identified. And
more such APIs are expected to be identified during the normative phase.
## 6.24 Solution 24: MSGin5G message delivery based on messaging topic
### 6.24.1 Description
#### 6.24.1.1 General
In all message scenarios, when message sender sends messages to receiver(s),
the contact information of the receiver(s) is needed. This issue is listed in
Key Issue 20. But in MIoT scenario, many devices are capability limited and
may not know contact information of every receiver. This solution will address
this issue.
In this solution, a subscription-notification mechanism is used for MSGin5G
Client/Application Server in all messaging scenarios. This solution includes
three procedures:
1\. MSGin5G client/Application Server subscribes to one or more messaging
topic(s) on the MSGin5G Server.
2\. MSGin5G client/Application Server sends message with the identifier of the
messaging topic to the MSGin5G server.
3\. The MSGin5G server sends the message received in procedure 2 to all
MSGin5G Client/Application Server which have the subscription of the same
messaging topic.
NOTE1: The subscription in this solution is not related to a session event and
keeping a connection between MSGin5G client/Application Server and MSGin5G
Server is not needed.
NOTE 2: A messaging topic is a specific identifier used by MSGin5G server and
MSGin5G Client s to filter the message requests. All messages with the same
messaging topic information will be sent to the subscribers who have the
subscription of this messaging topic.
Editor\'s Note: It is FFS whether additional interactions need to be specified
for the purpose of topic management and discovery
#### 6.24.1.2 MSGin5G service endpoint subscribes messaging topic(s)
A MSGin5G client/Application Server can subscribe one or more messaging
topic(s) on the MSGin5G Server.
Figure 6.24.2-1 shows the MSGin5G Client/Application Server subscribes
messaging topic(s) on the MSGin5G Server.
Pre-conditions:
1\. The MSGin5G Client/Application Server has registered to the MSGin5G
Server.
Figure 6.24.1.2-1: MSGin5G service endpoint subscribes messaging topic(s)
1\. The MSGin5G Client/Application Server sends a Messaging topic subscription
request to the MSGin5G Server. The request includes the information listed in
Table 6.24.1.2-1.
Table 6.24.1.2-1: Messaging topic subscription request
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | Subscriber ID | M | The MSGin5G identifier of | | | | the subscriber, i.e. | | | | MSGin5G Client or | | | | Application Server. | +-----------------------------+--------+-----------------------------+ | Subscribed messaging topic | M | A list of identifiers of | | list | | the messaging topic. This | | | | IE may include: | | | | | | | | - MSGin5G ID of | | | | Application Server or | | | | MSGin5G Client. | | | | | | | | - Application ID. | | | | | | | | - A Group ID | | | | | | | | - Broadcast Service Area | | | | ID | | | | | | | | - Other specified | | | | identifier. | | | | | | | | The Subscribed messaging | | | | topic list is needed to be | | | | set on the MSGin5G | | | | Client/Application Server | | | | during the provisioning | | | | procedure (NOTE) | +-----------------------------+--------+-----------------------------+ | Expire | O | The valid time duration of | | | | this subscription. If this | | | | IE is included and the | | | | value is 0, the | | | | subscription is to be | | | | deleted on the MSGin5G | | | | Server. | +-----------------------------+--------+-----------------------------+ | NOTE: The detailed | | | | definition of messaging | | | | topic list is out of scope | | | | of this document. | | | +-----------------------------+--------+-----------------------------+
NOTE: The subscription can also be made during the registration as similar as
Client/Application Server registration in Solution 11. If the subscription is
made during the registration, the Subscribed messaging topic list and Expire
IEs are needed to be included in the registration request.
2\. The MSGin5G Server validates the Messaging topic subscription request and
checks the local stored messaging topic.
a) If the subscribed messaging topic has already been created, the MSGin5G
server checks whether the MSGin5G ID of the subscriber is included in this
messaging topic.
i. If not, the MSGin5G Server adds the MSGin5G ID of the subscriber to this
messaging topic. The MSGin5G Server sets the valid time of this subscription
to the value of Expire IE or to a default value according to the service
policy.
ii. Else, the MSGin5G Server updates the valid time of this subscription
b) If the Subscribed messaging topic has not been already created, the MSGin5G
Server creates this messaging topic, and adds the MSGin5G ID of the subscriber
to this messaging topic. Set the valid time duration of this subscription to
the value of Expire IE or a default value according to the service policy.
3\. The MSGin5G Server sends a Messaging topic subscription response to the
originator of the request. The response includes the information listed in
Table 6.24.1.2-2.
Table 6.24.1.2-2: Messaging topic subscription response
Information element Status Description
* * *
Subscription status M Indicates whether the subscription was successful on the
MSGin5G Server Expire O The valid time of this subscription set by the MSGin5G
Server.
#### 6.24.1.3 MSGin5G message delivery based on messaging topic
Figure 6.24.1.3-1 shows the message exchange procedure of Point-to-point
Messaging/Application-to-point Messaging. At least in the first message
exchange procedure, the MSGin5G Server sends the message to the receiver on
behalf of the originating sender.
Pre-conditions:
1\. All of the MSGin5G endpoints (Sender A / Receiver B) have registered to
the MSGin5G Server.
2\. The MSGin5G message Sender A does not have the contact information of the
message Receiver B. The Sender and receiver can be a MSGin5G Client or an
Application Server.
3\. Only the contact information of the MSGin5G Server is known by the MSGin5G
message Sender A from the provisioning or registration procedure.
4\. The MSGin5G message Receiver B has subscribed a messaging topic \"XXX\" on
the MSGin5G Server.
NOTE: During the message exchange procedure, if delivery report is required by
the sender, the sender may obtain the contact information of the receiver from
the delivery report. After that, message exchange procedures in solution 5, 7,
9, 10, 11 can be used for the further message exchange. The procedure defined
in this solution can still be used according to the policy of the MSGin5G
message sender.
Figure 6.24.1.3-1: MSGin5G message delivery based on messaging topic
1\. The Sender A sends a MSGin5G message request to the MSGin5G server. The
request includes the information listed in Table 6.24.1.3-1.
Table 6.24.1.3-1: Message request with Messaging Topic from MSGin5G Sender A
to MSGin5G server
Information element Status Description
* * *
Originator ID M The MSGin5G identifier of the sending MSGin5G endpoint. i.e.
Sender A. Recipient ID M The MSGin5G identifier of the MSGin5G Server Message
ID M Unique identifier of this message. Messaging topic M Indicates which
messaging topic this message is related to. In this case, the messaging topic
is \"XXX\" Delivery status request O Indicates that whether the delivery
status of this message from the recipient is required. Application ID O
Identifies the application for this messaging exchange. Payload M Payload of
the message
2\. Upon receiving the message:
a) The MSGin5G Server validates the message request, e.g. it authenticates the
sender of this message;
b) The MSGin5G Server checks whether the messaging topic (i.e. \"XXX\")
included in this message is existed and whether the Sender A is allowed to
send message with this messaging topic. If the two conditions cannot be
fulfilled, the MSGin5G Server sends a Message Reject message including the
information listed in Table 6.24.1.3-2 to the Sender A;
Table 6.24.1.3-2: Message Reject message
Information element Status Description
* * *
Originator ID M The MSGin5G identifier of the sending MSGin5G endpoint.
Message ID M Identifier contained in the Message request from MSGin5G endpoint
to MSGin5G server Reject Code O The code for reject reason
c) The MSGin5G Server checks the subscription of this messaging topic (i.e.
\"XXX\") and obtains the contact information of the subscriber(s), i.e. the
contact information of the Receiver B.
3\. The MSGin5G Server sends the MSGin5G message request including the
information listed in Table 6.24.1.3-3 to the Receiver B.
Table 6.24.1.3-3: Message request with Messaging Topic from MSGin5G Server to
MSGin5G Receiver B
Information element Status Description
* * *
Originator ID M The MSGin5G identifier of the sending MSGin5G endpoint.
Recipient ID M The MSGin5G identifier of the receiving MSGin5G endpoint.
Message ID M Unique identifier of this message. Messaging topic M Indicates
which messaging topic this message is related to. In this case, the messaging
topic is \"XXX\" Delivery status request O Indicates that whether the delivery
status of this message from the recipient is required. Application ID O
Identifies the application for this messaging exchange. Payload M Payload of
the message
4\. If delivery status is required, the Receiver B sends the Delivery status
message to the Sender A as described in solution 9 or10.
Figure 6.24.1.3-2 shows a MSGin5G Client sending message to a MSGin5G Group.
The sender A does not know the message is sent to a MSGin5G Group.
Pre-conditions:
1\. All of the MSGin5G endpoints (Sender A, Receiver B and Receiver C) have
registered to the MSGin5G Server.
2\. The MSGin5G message Sender A does not know the MSGin5G Group.
3\. Only the contact information of the MSGin5G Server and a topic \"YYY\" are
known by the MSGin5G message Sender A from the provisioning or registration
procedure.
4\. The MSGin5G message Receiver B and Receiver C have subscribed the
messaging topic \"YYY\" on the MSGin5G Server.
Figure 6.24.1.3-2: MSGin5G Group message delivery based on messaging topic
1\. Sender A sends a MSGin5G message request to the MSGin5G server. The
request includes the information listed in Table 6.24.1.3-4.
Table 6.24.1.3-4: Message request with Messaging Topic from MSGin5G Sender A
to MSGin5G server
Information element Status Description
* * *
Originator ID M The MSGin5G identifier of the sending MSGin5G endpoint.
Recipient ID M The MSGin5G identifier of the MSGin5G Server Message ID M
Unique identifier of this message. Messaging topic M Indicates which messaging
topic this message is related to. In this case, the Messaging topic could be a
Group ID. In this case, the messaging topic is \"YYY\" Delivery status request
O Indicates that whether the delivery status of this message from the
recipient is required. Application ID O Identifies the application for this
messaging exchange. Payload M Payload of the message
2\. Upon receiving the message:
a) The MSGin5G Server validates the message request, e.g. it authenticates the
sender of this message;
b) The MSGin5G Server checks whether the messaging topic (i.e. \"YYY\")
included in this message is existed and whether the Sender A is allowed to
send message with this messaging topic. If the two conditions can not be
fulfilled, the MSGin5G Server sends a Message Reject message including the
information listed in Table 6.24.1.3-2 to the Sender A.
c) The MSGin5G Server checks the subscription of this messaging topic (i.e.
\"YYY\"), obtains the contact information of the subscriber(s), i.e. the
contact information of the Receiver B and Receiver C.
d) Optionally, the MSGin5G Server checks the messaging topic, finds that the
messaging topic is related to a MSGin5G Group. The MSGin5G Server obtains the
Group information, e.g. Group ID, the list of group members, related to this
messaging topic.
3\. The MSGin5G server sends the MSGin5G message request including the
information listed in Table 6.24.1.3-5 to the Receiver B.
Table 6.24.1.3-5: Message request with Messaging Topic from MSGin5G Server\ to
MSGin5G Receiver B/C
Information element Status Description
* * *
Originator ID M The MSGin5G identifier of the sending MSGin5G endpoint, i.e.
Sender A. Recipient ID M The MSGin5G identifier of Receiver B Message ID M
Unique identifier of this message. Group ID M The identifier of the MSGin5G
Group. Messaging topic M Indicates which messaging topic this message is
related to. In this case, the messaging topic is \"YYY\" Delivery status
request O Indicates that whether the delivery status of this message from the
recipient is required. Application ID O Identifies the application for this
messaging exchange. Payload M Payload of the message
4\. The MSGin5G server sends the MSGin5G message request including the
information listed in Table 6.24.1.3-5 to the Receiver C. In this message, the
Recipient ID is the MSGin5G identifier of Receiver C.
5\. If delivery status is required, the Receiver B and Receiver C sends the
Delivery status message to the Sender A as described in solution 5.
### 6.24.2 Impacts on existing nodes and functionality
This solution is an alternative messaging procedure for MSGin5G
Client/Application Server. If the contact information of the receiver(s) is
not known by the sender, the procedure in this solution is needed to be used.
Otherwise, both the procedure in this solution and procedures in solution 5,
7, 9, 10, 11 can be chosen according to the service policy.
### 6.24.3 Solution evaluation
This solution defines messaging procedures for the light weight constrained
devices (e.g. sensors, actuators). In some MIoT scenarios, the feature of this
kind of devices is very simple that they can even not know the communication
type (e.g. point-to-point or group). This MIoT scenario is different from
other communication scenario such as person-to-person communication. In
person-to-person communication, the sender can input the contact of the
receiver, or selects the contact of receiver from address book. On the
contrary, it is very difficult for light weight constrained devices to know
the contact of \"real\" receiver when they are deployed to different service
provider\'s system. It is also very difficult for the MSGin5G service provider
to configure the contacts of all devices to each device considering the
massive number of devices.
In this solution, the contact information of the message receiver may not be
known by the sender. A subscription-notification mechanism is used for MSGin5G
Client/Application Server in all messaging scenarios. The Messaging topic can
be configured by service provider or application provider, it can also be pre-
defined in the devices. All device produced by different vendors can send
messages including the message topic to the MSGin5G Server and the MSGin5G
Server will deliver the message to the related receiver based on the message
topic. is known by them.
This solution can support all of the four messaging scenarios and can be used
flexibly.
NOTE: This solution will consider Chat Group concept where applicable (e.g.
group messaging requirements) during normative phase.
## 6.25 Solution 25: Roaming
### 6.25.1 Description
This solution addresses the identified gap under Key Issue #18 regarding
roaming.
### 6.25.2 MSGin5G roaming architecture and messaging procedures
Since MSGin5G service may not be provided by every PLMN operator, and many
features, e.g. group management and broadcast area configuration, are provided
according to PLMN operator\'s application policy, the MSGin5G service is
needed to be always provided by the home PLMN. MSGin5G service is a home
routed scenario in 5G system.
Figure 6.25.2-1 shows the MSGin5G roaming architecture, based on the roaming
architecture in the case of home routed from 3GPP TS 23.501 [14]. The MSGin5G
server is in the HPLMN and resides in a trusted DN.
Figure 6.25.2-1: MSGin5G System Architecture for roaming
If the roaming UE hosts a MSGin5G Client, there is no difference in the
messaging procedures in application layer when UE is roaming.
If the roaming UE only hosts a Legacy-3GPP Client or a non-3GPP Client, the
message is delivered between the roaming UE and HPLMN according to the related
Legacy-3GPP or non-3GPP message delivery mechanism.
Editor\'s Note: In some special scenario, MSGin5G roaming architecture may
support based on other roaming architectures defined in 3GPP TS 23.501. This
kind of MSGin5G roaming architecture is FFS.
## 6.26 Solution 26: Aggregated delivery report
### 6.26.1 Aggregated delivery report
The Figure 6.26.1-1 shows the procedure for sending delivery report from
message receiver UE back to message sender UE.
Pre-conditions:
1) MSGin5G client-1, MSGin5G client-2 and MSGin5G Client-3 are registered with
the MSGin5G server and are member of the same group.
2) MSGin5G client-4 is not initially registered and member of the group along
with MSGin5G client-1, MSGin5G client-2 and MSGin5G Client-3.
Figure 6.26.1-1 Procedure to aggregate delivery report for group messages
1) 5GMSG client-1 sends a group message to the MSGin5G server as specified in
clause 6.5.1.3.
Editor\'s note: Whether end-to-end delivery report is enough or an
intermediate acknowledgement is required for message delivery, to meet the
reliability requirements is FFS.
2) The MSGin5G server determines whether participant UEs are registered and
online or not, based on registry information.
3) For all the clients which are online, the MSGin5G server sends group
message to the recipient UEs as specified in clause 6.5.1.4.
4) For all the clients which are offline, the MSGin5G server stores the group
message for later delivery.
5) If delivery status is requested, the MSGin5G Client-2 sends delivery
report.
6) Upon receiving the delivery report from MSGin5G Client-2, the MSGin5G
server decides to wait for aggregating delivery reports from multiple
recipient Clients.
7) The MSGin5G Client-3 sends delivery report.
NOTE: The MSGin5G server decides to continue aggregating delivery reports
until optimal use of segment size before sending aggregated delivery report
towards MSGin5G Client-1 or until maximum waiting time (specifying this is out
of scope of the present document) to aggregate delivery reports.
8) The MSGin5G server sends Aggregated Delivery Report to MSGin5G Client-1.
9) Upon MSGin5G Client-4 coming online and performing registration, the
MSGin5G Server sends the stored group message to MSGin5G Client-4.
10) If delivery status is requested, the MSGin5G Client-4 sends delivery
report.
11) The MSGin5G Server forwards the delivery report to the MSGin5G Client-1.
### 6.26.2 Solution evaluation
The solution introduced in 6.26.1 enables aggregated delivery report for
sending delivery report from message receiver UE back to message sender UE.
Aggregation of delivery report is applicable to all the group messaging
solutions described in this specification that requires delivery reports. The
format of the aggregated report is to be defined in the normative phase.
## 6.27 UE Registration
### 6.27.1 MSGin5G UE Registration
Editor\'s Note: If the service is part of the IMS service, no separate UE
registration is needed as it will be part of the UE IMS registration for all
IMS services.
A UE registers with its home MSGin5G server to inform the server that it is
online and available to receive the MSGin5G service.
The figure in 6.27.1-1 illustrates the signaling flow on how a MSGin5G UE
registers with the MSGin5G server through its MSGin5G client.
Pre-conditions:
1\. The UE has connected to the serving network successfully.
2\. A MSGin5G service ID has been provisioned on the UE.
3 The MSGin5G server address has been provisioned on the UE.
Figure 6.27.1-1: MSGin5G UE registration
1\. The MSGin5G UE is ready for the MSGin5G service and sends Registration
request to the MSGin5G server. The information in table 6.27.1-1 is included
in the request.
> Table 6.27.1-1: Registration request
Information element Status Description
* * *
MSGin5G service ID M MSGin5G service identifier assigned to the requesting
MSGin5G UE.
Editor\'s Note: It is FFS whether additional Application Client information is
required in the registration request in order to enable flexible AS services
for mIoT cases.
2\. The MSGin5G server processes the registration request.
NOTE: It is the responsibility to define any needed authentication and
authorization procedures.
3\. The MSGin5G server returns the result of the registration in Registration
response with the information in table 6.27.1-2.
Table 6.27.1-2: Registration response
Information element Status Description
* * *
MSGin5G service ID M MSGin5G service identifier assigned to the requesting
MSGin5G UE. Registration result M Indication if the registration is success or
failure
### 6.27.2 MSGin5G UE De-Registration
When a UE de-registers with its home serving MSGin5G server to inform the
server that it no longer wants to receive the MSGin5G service.
The figure in 6.27.2-1 illustrates the signaling flow on how a MSGin5G UE de-
registers with the MSGin5G server through its MSGin5G client.
Pre-conditions:
1\. The UE has connected to the serving network successfully.
2\. The MSGin5G UE has successfully registered with the MSGin5G server.
Figure 6.27.2-1: MSGin5G UE de-registration
1\. The MSGin5G UE no longer wants to receive the MSGin5G service and sends
De-registration request to the MSGin5G server. The information in table
6.27.2-1 is included in the request.
> Table 6.27.2-1: De-registration request
Information element Status Description
* * *
MSGin5G service ID M MSGin5G service identifier assigned to the MSGin5G UE.
2\. The MSGin5G server process the de-registration request.
3\. The MSGin5G server returns the result of the de-registration in De-
registration response with the information in table 6.27.2-2.
Table 6.27.2-2: De-registration response
Information element Status Description
* * *
MSGin5G service ID M MSGin5G service identifier assigned to the MSGin5G UE.
Registration result M Indicates if the registration is success or failure
### 6.27.3 non-MSGin5G UE Registration
A non-MSGin5G UE (such as a legacy 3GPP UE or a non-3GPP UE) connects to its
home serving MSGin5G server through a Message Gateway. The Message Gateway
will be informed when the non-MSGin5G UE is registered to receive messaging
service through its existing registration service. Once the Message Gateway
learns that the non-MSGin5G UE has registered to receive its message delivery
service it will perform the UE registration with the MSGin5G server on behalf
of the non-MSGin5G UE using its assigned MSGin5G service ID.
The figure in 6.27.3-1 illustrates the signaling flow on how a non-MSGin5G UE
registers with its home serving MSGin5G server through its serving Message
Gateway.
Pre-conditions:
1\. A MSGin5G service ID has been provisioned for the non-MSGin5G UE on the
Message Gateway.
2\. The non MSGin5G UE has successfully performed the registration with its
message delivery service.
3\. The home serving MSGin5G server address of the non-MSGin5G UE has been
provisioned on the Message Gateway.
4\. A secured connection has been established between the Message Gateway and
the MSGin5G server.
Figure 6.27.3-1: non-MSGin5G UE registration
1\. The Message Gateway has been informed that the non-MSGin5G UE has
registered with its message delivery service.
2\. The Message Gateway sends Registration request to the MSGin5G server to
register the non-MSGin5G UE with its assigned MSGin5G service ID. The
information in table 6.27.1-1 are included in the request.
Table 6.27.3-1: Registration request
Information element Status Description
* * *
GW service ID M The Message Gateway service identifier assigned to the Message
Gateway. MSGin5G service ID M MSGin5G service identifier assigned to the non-
MSGin5G UE.
1\. The MSGin5G server process the registration request.
2\. The MSGin5G server returns the result of the registration in Registration
response with the information in table 6.27.1-2.
Table 6.27.3-2: Registration response
Information element Status Description
* * *
GW service ID M The Message Gateway service identifier assigned to the Message
Gateway. MSGin5G service ID M MSGin5G service identifier assigned to the non-
MSGin5G UE. Registration result M Indication if the registration is success or
failure
Editor\'s Note: It is FFS if bulk registration (i.e. register more than one
MSGin5G service ID) will be supported.
### 6.27.4 non-MSGin5G UE De-registration
When a non-MSGin5G de-registers from its message delivery service the Message
Gateway may also de-register the MSGin5G service ID associated with this UE
with its home serving MSGin5G server.
The figure in 6.27.4-1 illustrates the signaling flow on how a Message Gateway
de-registers with the MSGin5G server for a non-MSGin5G UE when it has de-
registered with its message delivery service.
Pre-conditions:
1\. A MSGin5G service ID has been provisioned with the non-MSGin5G UE on the
Message Gateway.
2\. The non-MSGin5G UE has successfully performed the de-registration with its
message delivery service.
3\. A secured connection has been established between the Message Gateway and
the MSGin5G server.
Figure 6.27.4-1: non MSGin5G UE de-registration
1\. The non-MSGin5G UE has de-registered from its message delivery service and
the Message Gateway is informed.
2\. The Message Gateway, on behave of the non-MSGin5G UE, sends De-
registration request to the MSGin5G server. The information in table 6.27.4-1
are included in the request.
> Table 6.27.4-1: De-registration request
Information element Status Description
* * *
GW service ID M The Message Gateway service identifier assigned to the Message
Gateway. MSGin5G service ID M MSGin5G service identifier assigned to the non-
MSGin5G UE.
3\. The MSGin5G server process the de-registration request.
4\. The MSGin5G server returns the result of the de-registration in De-
registration response with the information in table 6.27.4-2.
Table 6.27.4-2: De-registration response
Information element Status Description
* * *
GW service ID M The Message Gateway service identifier assigned to the Message
Gateway. MSGin5G service ID M MSGin5G service identifier assigned to the non-
SGin5G UE. Registration result M Indication if the registration is success or
failure
Editor\'s Note: It is FFS if bulk de-registration (i.e. de-register more than
one MSGin5G service ID) will be supported.
### 6.27.5 Solution Evaluation
A UE is assigned a service layer ID (i.e. MSGin5G service ID) used in MSGin5G
service to route the MSGin5G message to it, as described in 6.8. To make
MSGin5G message delivery effective, it is important to know a UE\'s status by
the MSGin5G server. The MSGin5G server learns the availability and readiness
of a UE through the UE registration. A UE uses the UE registration to inform
the MSGin5G server that it is online and ready for the MSGin5G serivce. This
solution assumes that all UEs are assigned with its permennant MSGin5G service
ID and use it to register with the MSGin5G server. With the permenant assigned
the MSGin5G service ID for all UEs, a UE can be addressed by any other UEs at
any time with its MSGin5G service ID. It also makes possbile for a UE be
included in a pre-configured group for group communication. This solution
provides UE registration procedures that cover all UE types, i.e. MSGin5G UE,
legacy 3GPP UEs and non-3GPP UEs. The non-MSGin5G UE registration is
performed, to base on its registration status in its message delivery service,
by the Message Gateway that it connects to. De-registration procedures are
also supported when a UE no longer wants to receive the MSGin5G messages. This
solution is suitable for unconstrained devices with advanced capabilities.
This solution is useful when device is already aware of its own MSGin5G
service ID.
## 6.28 Solution 28: Support for constrained devices in MSGin5G service
### 6.28.1 Description
#### 6.28.1.1 General
This solution addresses the Key Issue #3 regarding how to uniquely identify a
UE (which is constrained device and uses UE Message Gateway) in MSGin5G
service.
This solution addresses the identified gap under Key Issue #7 regarding
MSGin5G group messaging.
This solution addresses the key issues in #5 and #6 regarding point-to-point
messaging.
This solution addresses key issue #9 \"application-to-point messaging\" that
including message origination from an Application server to the constrained
device using UE Message Gateway.
#### 6.28.1.2 MSGin5G UE-2 (Constrained device) Registration
The signalling flow for registration of MSGin5G Client-2 on the MSGin5G UE-2
(which is constrained device) is illustrated in figure 6.28.1.2-1. The
solution assumes that the MSGin5G Client-2 is responsible for triggering the
registration to the MSGin5G Server.
NOTE 1: The trigger for registering is based on application service logic and
is out of scope of this specification.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The MSGin5G UE-2 is constrained device and does not have connection to an
access network that provides connectivity to the MSGin5G Server.
3\. The MSGin5G Client-2 has been configured with the MSGin5G Server Identity.
4\. The MSGin5G Server have been configured with the necessary credentials to
enable authenticating MSGin5G Client-2.
5\. The MSGin5G UE-2 has discovered MSGin5G UE-1 having connectivity to the
MSGin5G server, and have mutually authenticated each other.
Figure 6.28.1.2-1: Registration of MSGin5G client-2 residing on the MSGin5G
UE-2
1) Upon receiving a request from an Application Client on the MSGin5G UE-2 to
register with MSGin5G server, the MSGin5G Client-2 sends a MSGin5G Request For
Registration message to the MSGin5G Client-1. The request includes security
credentials required for the MSGin5G Client-2 to register to the MSGin5G
Server. The information elements defined in Table 6.28.1.2-1 are included in
the request.
Table 6.28.1.2-1: MSGin5G Request For Registration Message
Information element Status Description
* * *
UE ID M Identity of the UE hosting the MSGin5G Client (e.g. the External
Identifier defined in TS 23.682 [x], or an MSISDN) MSGin5G Client Capabilities
O A list of the MSGin5G capabilities supported by the MSGin5G Client (e.g.
MOMT, AOMT, MOAT, Group, Broadcast) MSGin5G service ID O MSGin5G Client
identifier assigned to the MSGin5G Client by the MSGin5G Server upon initial
registration. This element is added while performing registration update. AS
service ID M Identity of the MSGin5G server to which the 5GMSGS client-2
intends to register to.
2) Upon receiving the request from the MSGin5G client-2, the MSGin5G Client-1
may reject the MSGin5G Request For Registration based on local condition (like
available power or connectivity to access network or any other reason outside
the scope of 3GPP). If the MSGin5G Client-1 decides to reject the MSGin5G
Request For Registration message, then go to step-3. Otherwise, the MSGin5G
Client-1 performs the registration procedure as specified in clause 6.2.1.2 or
6.27.1 with following clarification and additional information elements
defined in Table 6.28.1.2-2.
NOTE 3: Registration procedure as specified in clause 6.2.1.2 is used when the
MSGin5G UE-2 is not aware of its own MSGin5G Service ID, otherwise
registration procedure as specified in clause 6.27.1 is used.
Table 6.28.1.2-2: Additional information for MSGin5G Client Registration
request
Information element Status Description
* * *
MSGin5G service ID of the UE Message Gateway UE O MSGin5G Client identifier of
the MSGin5G Client-1 who sends registration request for MSGin5G Client-2.
\- UE ID in MSGin5G Client Registration request is set to UE ID received in
MSGin5G Request For Registration message;
\- MSGin5G Client Capabilities in MSGin5G Client Registration request is set
to the MSGin5G Client Capabilities received in Request for Registration
message;
> The MSGin5G server accepts the registration request from MSGin5G Client-1 on
> behalf of MSGin5G Client-2 based on security credentials provided in the
> registration request message, and further upon successful registration
> stores the mapping where MSGin5G Client-1 acting as UE Message Gateway to
> MSGin5G Client-2. The mapping will be used while sending message to MSGin5G
> Client-2.
NOTE 3: The MSGin5G Client-1 may decide to use different client ports other
than the ports used in its own registration request.
3) Upon deciding the reject the request for registration message in step 2) or
upon receiving a response from MSGin5G Server, the MSGin5G client-1 sends a
MSGin5G Response For Registration message to the MSGin5G Client-1 indicating
success or failure of the registration. In case of successful registration,
the MSGin5G Client-1 includes the MSGin5G Service ID assigned by MSGin5G
server to the MSGin5G Client-2. In case of failure, the MSGin5G Client-1
includes reason for the failure in the notification message.
NOTE 4: The MSGin5G Client-1 may act as UE Message Gateway for multiple
constrained devices. The MSGin5G Client-1 needs to maintain mapping between UE
ID, AS Server ID and MSGin5G service ID of the device initiated the request.
#### 6.28.1.3 MSGin5G UE-2 (Constrained device) Deregistration
The signalling flow for deregistration of MSGin5G Client-2 on the MSGin5G UE-2
(which is constrained device) is illustrated in figure 6.28.1.3-1. The
solution assumes that the MSGin5G Client-2 is responsible for triggering
deregistration to the MSGin5G Server.
NOTE 1: The trigger for deregistering is based on application service logic
and is out of scope of this specification.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The MSGin5G UE-2 is constrained device and does not have connection to an
access network that provides connectivity to the MSGin5G Server.
3\. The MSGin5G Server have been configured with the necessary credentials to
enable authenticating MSGin5G Client-2.
4\. The MSGin5G UE-2 has discovered MSGin5G UE-1 having connectivity to the
MSGin5G server, and have mutually authenticated each other.
5\. The MSGin5G Client-2 has been registered with MSGin5G server using MSGin5G
UE-1 as a UE Message Gateway.
Figure 6.28.1.3-1: Deregistration of MSGin5G client-2 residing on the MSGin5G
UE-2
1) Upon receiving a request from an Application Client on the MSGin5G UE-2 to
deregister with MSGin5G server, the MSGin5G Client-2 sends a MSGin5G Request
For Deregistration message to the MSGin5G Client-1. The information elements
defined in Table 6.28.1.3-1 are included in the request.
Table 6.28.1.3-1: MSGin5G Request For Deregistration Message
Information element Status Description
* * *
MSGin5G service ID M MSGin5G Client identifier assigned to the MSGin5G Client
by the MSGin5G Server upon initial registration. This element is added while
performing registration update.
> The MSGin5G server removes the mapping where MSGin5G Client-1 acting as UE
> Message Gateway to MSGin5G Client-2.
2) Upon receiving the request from the MSGin5G client-2, the MSGin5G Client-1
performs the deregistration procedure as specified in clause 6.2.1.3 or
6.27.2.
3) Upon receiving a response from MSGin5G Server, the MSGin5G client-1 sends a
MSGin5G Response For Deregistration message to the MSGin5G Client-1 indicating
success or failure of the deregistration.
#### 6.28.1.4 MSGin5G UE-2 (Constrained device) sending point-to-point message
using UE Message Gateway
The signalling flow for MSGin5G Client-2 on the MSGin5G UE-2 (which is
constrained device) to send point-to-point message is illustrated in figure
6.28.1.4-1.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The MSGin5G UE-2 is constrained device and does not have connection to an
access network that provides connectivity to the MSGin5G Server.
3\. The MSGin5G Client-2 has registered with MSGin5G server using MSGin5G UE-1
which is acting as UE-Message Gateway.
Figure 6.28.1.4-1: MSGin5G client-2 residing on the MSGin5G UE-2 sends point-
to-point message
1) Upon receiving a request from an Application Client on the MSGin5G UE-2 to
send point-to-point message, the MSGin5G Client-2 sends a Request to Send
MSGin5G message to the MSGin5G Client-1. The information elements defined in
Table 6.9.2-1 are included in the request.
2) Upon receiving the request from the MSGin5G client-2, the MSGin5G Client-1
may reject the request to send MSGin5G message based on local condition (like
available power or connectivity to access network or any other reason outside
the scope of 3GPP). If MSGin5G Client-1 decides to reject the request, then go
to step-3. Otherwise, if the size of the received message exceeds the maximum
allowed packet size, the MSGin5G Client-1 sends point to point message as
specified in clause 6.13.1.4. If the size of the received message does not
exceed the maximum allowed packet size, the MSGin5G Client-1 sends point to
point message as specified in clause 6.9.2. The 5GMSGS client-1 uses the
information elements received in request to send MSGin5G message request from
MSGin5G Client-2 to send MSGin5G message request with additional information
elements defined in Table 6.28.1.4-1.
Table 6.28.1.4-1: Additional information for MSGin5G message request
Information element Status Description
* * *
MSGin5G Service ID of UE Message Gateway O MSGin5G Client identifier of the
MSGin5G Client-1 who sends point to point message for MSGin5G Client-2.
3) The MSGin5G Client-1 sends Response to Send MSGin5G message to MSGin5G
Client-2. If the MSGin5G Client-1 has decided to reject the request to send
the message in step 2) or the MSGin5G Client-1 received reject response from
MSGin5G Server in step 2), the MSGin5G Client-1 sends failure response to the
MSGin5G Client-2 and stops performing further steps. Otherwise, the MSGin5G
Client-1 sends success response to the MSGin5G Client-2.
4) If delivery status is enabled while sending the message, the MSGin5G
Client-1 may received delivery report from the MSGin5G service.
5) Upon receiving the delivery report, the MSGin5G Client-1 sends the delivery
report to the MSGin5G Client-2.
#### 6.28.1.5 MSGin5G UE-2 (Constrained device) sending group message using UE
Message Gateway
The signalling flow for MSGin5G Client-2 on the MSGin5G UE-2 (which is
constrained device) to send group message is illustrated in figure 6.28.1.5-1.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The MSGin5G UE-2 is constrained device and does not have connection to an
access network that provides connectivity to the MSGin5G Server.
3\. The MSGin5G Client-2 has registered with MSGin5G server using MSGin5G UE-1
which is acting as UE-Message Gateway.
4\. A MSGin5G Group is created by following group management SEAL service
procedures as specified in 3GPP TS 23.434 [9], and the MSGin5G UE-2 is member
of the group.
Figure 6.28.1.5-1: MSGin5G client-2 residing on the MSGin5G UE-2 sends group
message
1) Upon receiving a request from an Application Client on the MSGin5G UE-2 to
send point-to-point message, the MSGin5G Client-2 sends a Request to Send
MSGin5G Group message to the MSGin5G Client-1. The information elements
defined in Table 6.5.1.3-1 are included in the request.
2) Upon receiving the request from the MSGin5G client-2, the MSGin5G Client-1
may reject the request to send MSGin5G message based on local condition (like
available power or connectivity to access network or any other reason outside
the scope of 3GPP). If MSGin5G Client-1 decides to reject the request, then go
to step-3. Otherwise, if the size of the received message exceeds the maximum
allowed packet size, the MSGin5G Client-1 sends the group message as specified
in clause 6.13.1.5. If the size of the received message does not exceed the
maximum allowed packet size, the MSGin5G Client-1 sends the group message as
specified in clause 6.5.1.2. The 5GMSGS client-1 uses the information elements
received in request to send MSGin5G message request from MSGin5G Client-2 to
send MSGin5G message request with additional information elements defined in
Table 6.28.1.5-1.
Table 6.28.1.5-1: Additional information for MSGin5G message request
Information element Status Description
* * *
MSGin5G Service ID of UE Message Gateway O MSGin5G Client identifier of the
MSGin5G Client-1 who sends point to point message for MSGin5G Client-2.
3) The MSGin5G Client-1 sends Response to Send MSGin5G Group message to
MSGin5G Client-2. If the MSGin5G Client-1 has decided to reject the request to
send the message in step 2) or the MSGin5G Client-1 received reject response
from MSGin5G Server in step 2), the MSGin5G Client-1 sends failure response to
the MSGin5G Client-2 and stops performing further steps. Otherwise, the
MSGin5G Client-1 sends success response to the MSGin5G Client-2.
4) If delivery status is enabled while sending the message, the MSGin5G
Client-1 may received delivery report(s) from the MSGin5G service.
5) Upon receiving the delivery report(s), the MSGin5G Client-1 sends the
delivery report(s) to the MSGin5G Client-2.
#### 6.28.1.6 MSGin5G UE-2 (Constrained device) receiving message via UE
Message Gateway
The signalling flow for MSGin5G Client-2 on the MSGin5G UE-2 (which is
constrained device) to receive message (group message, point-to-point message
or point-to-application message) is illustrated in figure 6.28.1.6-1.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The MSGin5G UE-2 is constrained device and does not have connection to an
access network that provides connectivity to the MSGin5G Server.
3\. The MSGin5G Client-2 has registered with MSGin5G server using MSGin5G UE-1
which is acting as UE-Message Gateway.
Figure 6.28.1.6-1: MSGin5G client-2 residing on the MSGin5G UE-2 receives
message
1) The MSGin5G Client-1 receives either a group message as specified in clause
6.5.1.4 or a point-to-point message as specified in clause 6.13.1.4 or
application-to-point message as specified in clause 6.13.1.2 for the MSGin5G
Client-2 for which the MSGin5G Client-1 is acting as UE Message Gateway. The
MSGin5G Client-1 performs reassembly is the received message is segmented. The
MSGin5G Cleint-1 may also perform segment recovery procedure as specified in
clause 6.13.1.6 to recover missing segments.
2) Upon successfully receiving a message for the MSGin5G Client-2, the MSGin5G
Client-1 will send MSGin5G message received request to MSGin5G Client-2. The
information elements defined in Table 6.28.1.6-1 are included in the request.
Table 6.28.1.6-1: MSGin5G message received request
Information element Status Description
* * *
Originator MSGin5G service ID M The identity of the MSGin5G client who
initiated the message. Group ID O The identifier of the MSGin5G Group to which
the message is sent Message ID M Unique identifier of this message Disposition
Type O Indicates the disposition type expected from the receiver (i.e.
delivered) as specified in Group Message Request received from originating
MSGin5G client Application ID O Identifies the application for which the
payload is intended as specified in Group Message Request received from
originating MSGin5G client Payload M Payload of the message Priority Type O
Application priority level requested for this message as specified in Group
Message Request received from originating MSGin5G client.
3) Upon successfully receiving the message, the MSGin5G Client-2 sends MSGin5G
send message response to the MSGin5G client-1.
4) If delivery report is required, the MSGin5G client-2 sends delivery report
to the MSGin5G Client-1.
5) Upon receiving the delivery report, the MSGin5G Client-1 sends delivery
report to the MSGin5G server.
#### 6.28.1.7 MSGin5G UE-2 (Constrained device) sending message using UE
Message Gateway
The signalling flow for MSGin5G Client-2 on the MSGin5G UE-2 (which is
constrained device) to send message (group message, point-to-point message or
point-to-application message) is illustrated in figure 6.28.1.7-1.
Pre-conditions:
1\. The MSGin5G UE-1 is connected to an access network that provides
connectivity to the MSGin5G Server.
2\. The MSGin5G UE-2 is constrained device and does not have connection to an
access network that provides connectivity to the MSGin5G Server.
3\. The MSGin5G Client-2 has registered with MSGin5G server using MSGin5G UE-1
which is acting as UE-Message Gateway.
Figure 6.28.1.7-1: MSGin5G client-2 residing on the MSGin5G UE-2 sends message
1) Upon receiving a request from an Application Client on the MSGin5G UE-2 to
send message (either group message or point-to-point message or point-to-
application message), the MSGin5G Client-2 sends a MSGin5G send message
request message to the MSGin5G Client-1. The information elements defined in
Table 6.28.1.7-1 are included in the request.
Table 6.28.1.7-1: MSGin5G send message request
Information element Status Description
* * *
Originator MSGin5G service ID M The identity of the MSGin5G client sending the
message. Recipient MSGin5G service ID O (NOTE) The service identity of the
recipient receiving the message. Group ID O (NOTE) The identifier of the
target MSGin5G Group. Message ID M Unique identifier of this message
Disposition Type O Indicates the disposition type expected from the receiver
(i.e., delivered) Application ID O Identifies the application for which the
payload is intended. Generally same as application ID of the application which
initiated this message. Payload M Payload of the message Priority Type O
Application priority level requested for this message. NOTE: At least one of
these rows shall be present.
2) Upon receiving the request from the MSGin5G client-2, the MSGin5G Client-1
sends group message as specified in clause 6.5.1.3 or sends point-to-point
message as specified in clause 6.13.1.4 or sends point-to- application message
as specified in clause 6.13.1.3. The MSGinClient-1 may perform segmentation of
the message if the total payload size exceeds the maximum allowed packet size.
3) The MSGin5G Client-1 sends MSGin5G send message response to the MSGin5G
client-2.
### 6.28.2 Solution evaluation
Typical IoT deployment consists of MSGin5G UE which are of heterogeneous
nature including light weight constrained devices (e.g. sensors, actuators)
and unconstrained devices with advanced capabilities (e.g. washing machine,
micro-ovens). When constrained devices do not have capability to communicate
with MSGin5G Server, they rely on another MSGin5G UE in the proximity acting
either as a relay UE or a gateway UE for consuiming MSGin5G Service. This
solution enables constrained devices to be part of the MSGin5G Service.
When the MSGin5G UE acts as a gateway for the constrained devices (i.e.
MSGin5G Client is not supported by the constrained devices), the MSGin5G
Client in the MSGin5G UE interacts with multiple Application Clients from the
MSGin5G Service point of view. If the Application Clients all communicate with
a same logical Application Server (i.e. a same specific user service), from
the Application's point of view, if the Application Server wants to
communicate with a specific Application Client, it has to include the
identities of Application Clients in the information sent to the specific
Application Client within the Application domain. From the MSGin5G Service's
point of view, the identities of Application Clients can be seen as
Application ID.
E.g. If Application Server wants to send message to Application Client A, it
includes the identity of Application Client A (i.e. AC ID A) in the message.
The MSGin5G Server includes the AC ID A in the Application ID IE in the
message sent to MSGin5G UE. The MSGin5G UE delivers the message to Application
Client A based on the Application ID, i.e. AC ID A.
Therefore, in the Message Gateway scenario, Application ID is enough for the
message delivery. Application Client ID is not mandatory.
## 6.29 Solution 29: MSGin5G UE Configuration
### 6.29.1 Description
#### 6.29.1.1 General
When a MSGin5G Client is deployed in a PLMN which provides MSGin5G Service
first time, a configuration procedure is needed for it to get the MSGin5G
Service configuration information (e.g. MSGin5G Service ID) to use in the
future messaging communication, if this ID is not pre-configured.. The
configuration procedures may use VAL UE configuration data specified in TS
23.434 [9] as described in this solution. After the configuration procedure,
the MSGin5G UE can register to MSGin5G Server with the MSGin5G Service ID got
from the configuration procedure.
#### 6.29.1.2 The MSGin5G UE Configuration Function.
A MSGin5G Configuration Function is logical function which is used for
configuring MSGin5G functional entities, that is implemented based on
Configuration Management aspects from SEAL configuration management Server as
specified in 3GPP TS 23.434 [9].
The MSGin5G Configuration Function is utilized for offline configuration
(before the MSGin5G UE is sending and receiving messages from the MSGin5G
Server) and online configuration (during the MSGin5G UE is sending and
receiving messages from the MSGin5G Server).
#### 6.29.1.3 MSGin5G UE configuration
In the MSGin5G UE configuration procedure, the MSGin5G UE acts as
Configuration management client specified in 3GPP TS 23.434 [9].
The following steps of configuration management service may apply for the
MSGin5G UE:
\- Get VAL UE configuration request specified in subclause 11.3.2.1 of 3GPP TS
23.434 [9];
\- Get VAL UE configuration response specified in subclause 11.3.2.2 of 3GPP
TS 23.434 [9];
The usage of the above information flows is clarified as below:
\- The VAL UE ID is the MSGin5G UE ID;
\- The VAL user ID is the MSGin5G service ID specified in clause 6.8;
\- The VAL service ID is the service identifier of MSGin5G Service;
Besides the IEs specified in subclause 11.3.2.1 of 3GPP TS 23.434 [9], the
information in table 6.29.1.3-1 is also included in the Get VAL UE
configuration request.
Editor\'s note: IEs in this solution are for FFS during normative phase.
Table 6.29.1.3-1: Additional Information in the Get VAL UE configuration
request
Information element Status Description
* * *
MSGin5G UE information O Other information needed by the configuration
procedure.(NOTE) NOTE: The information can be the device type, device Vendor,
etc. It is specified by application provider or MSGin5G service provider and
is out of scope of this document. The MSGin5G service provider can configure
the MSGin5G UE with different configuration data based on this IE. E.g. all
sensors can be configured to a same MSGin5G Server.
> \- Besides the IEs specified in subclause 11.3.2.2 of 3GPP TS 23.434 [9],
> the information in table 6.29.1.3-2 is also included in the Get VAL UE
> configuration response as a part of VAL UE configuration data.
>
> Table 6.29.1.3-2: Additional information in the Get VAL UE configuration
> response
Information element Status Description
* * *
MSGin5G service ID M MSGin5G service ID assigned to the requesting MSGin5G UE.
MSGin5G Server M The MSGin5G Server which serves this MSGin5G UE. MSGin5G
service specified information O The specific information of the MSGin5G
Service specified by the MSGin5G Service Provider. (NOTE) NOTE1: e.g. the
segment size of MSGin5G Message in this Service Provider, The detailed
definition is out of scope of this document.
The following additional functional requirement is needed to be added to the
Configuration Management Server:
> \- The MSGin5G Configuration Function checks whether the MSGin5G UE ID (i.e.
> VAL UE ID) is included in a former Get VAL UE configuration request. If so,
> the MSGin5G Configuration Function included the MSGin5G Service ID assigned
> to the MSGin5G UE in the former configuration procedure as a part of VAL UE
> configuration data, otherwise a new MSGin5G Service ID is assigned to the
> MSGin5G UE, and included in the VAL UE configuration data. Then the MSGin5G
> Configuration Function processes the configuration request according to the
> service policy.
### 6.29.2 Solution Evaluation
This solution provides a MSGin5G UE configuration procedures. The MSGin5G UE
may use this solution to obtain MSGin5G Service ID which is mandatory for the
future messaging communication.
## 6.30 Solution 30: non-MSGin5G UE Configuration
### 6.30.1 Description
#### 6.30.1.1 General
When a non-MSGin5G UE (such as a legacy 3GPP UE or a non-3GPP UE) connects to
the Message Gateway (such as a Legacy-3GPP Message Gateway or a non-3GPP
Message Gateway) first time (e.g. a non-MSGin5G UE sends a message to a
MSGin5G UE or a Application Server which uses MSGin5G Service), the non-
MSGin5G Message Gateway records the non-MSGin5G UE ID and performs the
configuration procedure on behalf of the non-MSGin5G UE to get the MSGin5G
Service configuration information (e.g. MSGin5G Service ID). the MSGin5G
Service configuration information is needed to be used in the future messaging
communication.
#### 6.30.1.2 non-MSGin5G UE configuration
The configuration procedures may re-use VAL UE configuration data specified in
TS 23.434 [9] as described in this solution. After the configuration
procedure, the non-MSGin5G Gateway can register to MSGin5G Server on behalf of
the Non-MSGIn5G UE with the MSGin5G Service ID got from the configuration
procedure.
In the non-MSGin5G UE configuration procedure, the non-MSGin5G Message Gateway
acts as Configuration management client specified in 3GPP TS 23.434 [9] on
behalf of each non- MSGin5G UE.
The following steps of configuration management service may apply for the non-
MSGin5G Message Gateway:
\- Get VAL UE configuration request specified in subclause 11.3.2.1 of 3GPP TS
23.434 [9];
\- Get VAL UE configuration response specified in subclause 11.3.2.2 of 3GPP
TS 23.434 [9];
The usage of the above information flows are clarified as below:
\- The VAL UE ID is the non-MSGin5G UE ID plus GW service ID;
\- The VAL user ID is the MSGin5G service identifier assigned to the non-
MSGin5G UE specified in clause 6.8;
\- The VAL service ID is the service identifier of MSGin5G Service;
Besides the IEs specified in subclause 11.3.2.1 of 3GPP TS 23.434 [9], the
information in table 6.30.1.2-1 is also included in the Get VAL UE
configuration request.
> Table 6.30.1.2-1: Additional Information in the Get VAL UE configuration
> request
Information element Status Description
* * *
Non-MSGin5G UE information O Other information needed by the configuration
procedure.(NOTE) NOTE1: The information can be the device type, device Vendor,
etc. It is specified by application provider or MSGin5G service provider and
is out of scope of this document. The MSGin5G service provider can configure
the non-MSGin5G UE with different configuration data based on this IE. E.g.
all sensors can be configured to a same MSGin5G Server.
\- Besides the IEs specified in subclause 11.3.2.2 of 3GPP TS 23.434 [9]. The
information in table 6.30.1.2-2 is also included in the Get VAL UE
configuration response as a part of VAL UE configuration data.
> Table 6.30.1.2-2: Additional information in the Get VAL UE configuration
> response
Information element Status Description
* * *
MSGin5G service ID M MSGin5G service ID assigned to the requesting non-MSGin5G
UE. MSGin5G Server M The MSGin5G Server which serves this MSGin5G UE. MSGin5G
service specified information O The specific information of the MSGin5G
Service specified by the MSGin5G Service Provider. (NOTE) NOTE1: e.g. the
segment size of MSGin5G Message in this Service Provider, The detailed
definition is out of scope of this document.
The following additional functional requirement is needed to be added to the
Configuration Management Server:
\- The MSGin5G Configuration Function checks whether the non-MSGin5G UE ID
(i.e. VAL UE ID) is included in a former Get VAL UE configuration request. If
so, the MSGin5G Configuration Function included the MSGin5G Service ID
assigned to the non-MSGin5G UE in the former configuration procedure as a part
of VAL UE configuration data, otherwise a new MSGin5G Service ID is assigned
to the non-MSGin5G UE, and included in the VAL UE configuration data. Then the
MSGin5G Configuration Function processes the configuration request according
to the service policy.
### 6.30.2 Solution Evaluation
This solution provides a non-MSGin5G UE configuration procedures. The non-
MSGIn5G UE may use this solution to obtain MSGin5G Service ID which is
mandatory for the future messaging communication.
## 6.31 Solution 31: UE reachability status monitoring
### 6.31.1 Description
#### 6.31.1.1 General
This solution addresses identified gaps under Key Issue #13, namely how the
MSGin5G Service can use the capabilities of underlying network to monitor UE
reachability and provide corresponding notification.
UE reachability status monitoring applies to the MSGin5G UEs configured for
Power Saving Mode (PSM) and is relevant subsequent to MSGin5G Client
Registration. If UE reachability status monitoring is not performed, then the
MSGin5G Server has to keep attempting the delivery of message hoping to hit
the delivery time to the UE in connected mode.
UEs configured for Power Saving Mode (PSM) are available for mobile
terminating services during connected mode and during the period of an Active
Time immediately following, when it may be paged. 3GPP TS 23.502 [10]
specifies several SCEF/ NEF mechanisms, including device triggering and
monitoring procedures, which may be leveraged in such cases.
When the MSGin5G Server receives a registration request from the MSGin5G
Client it determines that the UE is requesting MSGin5G services and is
reachable for service. For MIoT UEs using PSM, the MSGin5G Server may also
leverage monitoring procedures for fine-gained determination of reachability
status.
Monitoring procedures allow an SCS/AS to request to receive reports when a
device becomes reachable for receiving either SMS or downlink data. The
MSGin5G Server (acting as SCS/AS) may provide functionality based on UE
monitoring to Application Servers, so that multiple Application Servers can
rely upon a single monitoring subscription in the Core Network for the UE.
The monitoring procedure described in 3GPP TS 23.502 [10] clause 4.15.3 may be
used also for deleting a previously configured Monitoring Event or for one-
time reporting. Inclusion of either Maximum Number of Reports (with a value
higher than one) or Monitoring Duration makes the request a Continuous
Monitoring Request equivalent with a subscription. Alternatively, a one-time
request-response model is supported. 3GPP TS29.522 [17] describes the
corresponding APIs.
#### 6.31.1.2 UE reachability status request-response
Figure 6.31.1.2-1 shows the procedure which may be used by the MSGin5G Server
to make a one-time request for UE reachability status information.
Pre-conditions:
1\. A UE hosts a MSGin5G Client and/or Application Specific Client which are
supported by the MSGin5G service.
2\. The MSGin5G Client registers with the MSGin5G Server and shares UE contact
information.
3\. The MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network, e.g., that the UE is a sleepy node.
NOTE 1: How the MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network is implementation dependent.
Figure 6.31.1.2-1: MSGin5G reachability status request-response.
1\. The MSGin5G Server sends a one-time Monitoring Request to the 3GPP Network
using SCEF/NEF capabilities.
NOTE 2: In this procedure, all MSGin5G interactions between the 3GPP network
and the MSGin5G Server use existing NEF capabilities detailed in 3GPP TS
23.502 [10] and TS 29.522[17]. As specified in TS 29.522[17] clause 4.4.2, NEF
monitoring procedures use SCEF APIs specified in TS 23.682 [2] and 3GPP TS
29.122 [16].
The one-time Monitoring Request includes monitoringType set to
UE_REACHABILITY, Maximum Number of Reports of 1 and does not include the
Monitoring Duration IE.
2\. The 3GPP network processes the Monitoring Request and determines the
reachability status of the UE(s), as described in 3GPP TS 29.122 [16].
3\. If the Monitoring Request is successfully processed, a Monitoring Response
providing the UE(s) reachability status is sent to the MSGin5G Server. The
response may include idle mode information e.g., active time granted to the
UE, eDRX cycle length, periodic RAU/TAU timer, etc., depending on the
parameters indicated in the request.
#### 6.31.1.3 UE reachability status subscribe.
Figure 6.31.1.3-1 shows the procedure which may be used by the MSGin5G Server
to subscribe for monitoring of UE reachability.
Pre-conditions:
1\. A UE hosts a MSGin5G Client and/or Application Specific Client which are
supported by the MSGin5G service.
2\. The MSGin5G Client registers with the MSGin5G Server and shares UE contact
information.
3\. The MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network, e.g., that the UE is a sleepy node.
NOTE 1: How the MSGin5G Server determines to subscribe for monitoring of UE
reachability events in the Core Network is implementation dependent.
Figure 6.31.1.3-1: MSGin5G reachability status subscribe.
1\. The MSGin5G Server sends a Monitoring Event Subscribe request to the 3GPP
Network using existing SCEF/NEF capabilities.
NOTE 2: In this procedure, all MSGin5G interactions between the 3GPP network
and the MSGin5G Server use existing NEF capabilities detailed in 3GPP TS
23.502 [10] and TS 29.522[17]. As specified in TS 29.522[17] clause 4.4.2, NEF
monitoring procedures use SCEF APIs specified in TS 23.682 [2] and 3GPP TS
29.122 [16].
The Monitoring Event Subscribe is a Monitoring Request with monitoringType set
to UE_REACHABILITY , and either the Maximum Number of Reports greater than 1
or the Monitoring Duration IE are included.
3\. The 3GPP network processes the Monitoring Event Subscribe request as
described in 3GPP TS 29.122 [16].
4\. If the Monitoring Event Subscribe Request is successfully processed, a
response indicating the request was accepted is sent to the MSGin5G Server.
#### 6.31.1.4 UE reachability status notify.
Figure 6.31.1.4-1 shows the procedure which may be for updating MSGin5G
reachability status.
Pre-conditions:
1\. The MSGin5G Server has subscribed for reachability status monitoring for a
UE or group of UEs.
2\. The monitored UE(s) transitions to Connected Mode, Idle Mode or eDRX
paging occasion and the 3GPP Network Entities detects the change in UE
reachability status.
Figure 6.31.1.4-1: MSGin5G reachability status notify.
1\. Based on the reachability status change of a monitored UE(s), the 3GPP
Network sends a Monitoring Notification message for UE reachability to the
MSGin5G Server as specified in 3GPP TS 29.122 [16].
NOTE: In this procedure, all MSGin5G interactions between the 3GPP network and
the MSGin5G Server use existing NEF capabilities detailed in 3GPP TS 23.502
[10] and TS 29.522[17]. As specified in TS 29.522[17] clause 4.4.2, NEF
monitoring procedures use SCEF APIs specified in TS 23.682 [2] and 3GPP TS
29.122 [16].
> The notification may include idle mode information e.g., active time granted
> to the UE, eDRX cycle length, periodic RAU/TAU timer, etc., depending on the
> subscription.
2\. After receiving a UE Reachability Monitoring Notification, the MSGin5G
Server responds with an acknowledgement of the notification via SCEF/NEF.
3\. The MSGin5G Server uses the information provided in the UE Reachability
Monitoring Event Report to update its information on the UE\'s availability,
e.g., MSGin5G Client Availability information. The MSGin5G Server may provide
additional services based on reachability information, e.g., forward a stored
message, etc.
#### 6.31.1.5 UE reachability status unsubscribe
Figure 6.31.1.5-1 shows the procedure which may be used by the MSGin5G Server
to unsubscribe from monitoring of UE reachability.
Pre-conditions:
1\. The MSGin5G Server has subscribed for reachability status monitoring for a
UE or group of UEs.
2\. Later, the MSGin5G Server determines to un-subscribe for monitoring of UE
reachability events in the Core Network,
NOTE 1: How the MSGin5G Server determines to subscribe or unsubscribe for
monitoring of UE reachability events in the Core Network is implementation
dependent.
NOTE 2: If the initial MSGin5G Server subscription for reachability status
monitoring reaches the Maximum Number of Reports or Monitoring Duration
indicated in the request, the 3GPP Network automatically deletes the
subscription and an explicit MSGin5G reachability status unsubscribe is not
necessary.
Figure 6.31.1.5-1: MSGin5G reachability status unsubscribe.
1\. The MSGin5G Server sends a Monitoring Event Unsubscribe request to the
3GPP Network using existing SCEF/NEF capabilities.
NOTE: In this procedure, all MSGin5G interactions between the 3GPP network and
the MSGin5G Server use existing NEF capabilities detailed in 3GPP TS 23.502
[10] and 3GPP TS 29.522[17]. As specified in 3GPP TS 29.522[17] clause 4.4.2,
NEF monitoring procedures use SCEF APIs specified in 3GPP TS 23.682 [2] and
3GPP TS 29.122 [16].
2\. The 3GPP network processes the Monitoring Event Unsubscribe request and
deletes the subscription, as described in 3GPP TS 29.122 [16].
3\. If the Monitoring Event Unsubscribe Request is successfully processed, a
response indicating the subscription was deleted is sent to the MSGin5G Server
via SCEF/NEF.
### 6.31.2 Impacts on existing nodes and functionality
This solution leverages existing 3GPP network monitoring functionality and
defines a MSGin5G procedure that utilizes it, hence there are no backwards
compatibility issues or network impact with this solution.
### 6.31.3 Solution evaluation
This solution defines a MSGin5G procedure for utilizing existing 3GPP Network
capabilities to provide enhanced services to the Application Servers. It
enables an optional capability of the MSGin5G Server to provide multiple
functionalities (e.g., store and forward, triggering) by leveraging the
monitoring procedures on behalf of multiple Application Servers. How the
MSGin5G Server determines whether and how (e.g. via request/response or
subscription) to monitor the UE reachability using the 3GPP Network
capabilities is implementation dependent.
NOTE: Use of reachability procedure in the application layer has no impact to
how core network delivers the message to the UE.
# 7 Architectural requirements
## 7.1 Capability requirements
### 7.1.1 General
The application architecture for the MSGin5G Application Service is designed
based on the following capabilities:
\- **Supported UE types** : MSGin5G UE could be
1\. light weight constrained devices (e.g. sensors, actuators) and
2\. unconstrained devices with advanced capabilities (e.g. washing machine,
micro-ovens)
\- **Supported communication modes** : standalone communication
\- **Supported communication payload size** : small data message and large
data message
\- **Supported communication frequency** : sporadic and periodic messages
\- **Supported communication target** : only one target device (point-to-
point) and large number of target devices (one-to-many)
\- **Supported communication priority type** : normal and high priority.
Editor\'s note: The details of how priority type is used in solutions is FFS.
### 7.1.2 Requirements
In order to support the capabilities listed above, the application
architecture for MSGin5G Application Service shall support the following
architecture requirements:
[AR-7.1.2-a] The application architecture shall enable deployment of MSGin5G
UE which are of heterogeneous nature including light weight constrained
devices (e.g. sensors, actuators) and unconstrained devices with advanced
capabilities (e.g. washing machine, micro-ovens).
[AR-7.1.2-b] The application architecture shall enable the standalone
communication mode.
[AR-7.1.2-c] The application architecture shall enable the communication
payload size varying from small data message to large data message.
[AR-7.1.2-d] The application architecture shall enable the communication
frequency including sporadic and periodic messages.
[AR-7.1.2-e] The application architecture shall enable the communication
targets varying from only one target device (point-to-point) to a large number
of target devices (one-to-many).
[AR-7.1.2-f] The application architecture shall enable the communication
priority including normal and high priority messages.
# 8 Application architecture of the MSGin5G Service
## 8.1 Application architecture principles
The application architecture for MSGin5G Service is designed based on the
following architecture principles
The three logical UE types, depending on the type of underlying transport
services supported, as follows:
\- MSGin5G UE type - supports MSGin5G client and supports one or more 3GPP
defined delivery mechanisms for sending and receiving MSGin5G message
requests.
NOTE 1: All the MSGin5G UEs that are in a broadcast area and support 3GPP
broadcast message may receive broadcast message sent from MSGin5G UE or
Application server.
\- Legacy 3GPP UE type - does not support MSGin5G client, and support one or
more 3GPP defined message delivery mechanism (e.g. SMS, NIDD, etc).
NOTE 2: All the Legacy 3GPP UEs that are in a broadcast area and support 3GPP
broadcast message may receive broadcast message sent from MSGin5G UE or
Application server.
\- Non-3GPP UE type - supports one of non-3GPP message delivery mechanism
(e.g. RCS, LwM2M)
For point to point message, MSGin5G UE may initiate a MSGin5G message request
to MSGin5G UE, Legacy 3GPP UE or Non-3GPPP UE, upon receiving the message, and
the Legacy 3GPP UE or Non-3GPP UE may reply the message.
For application to point message, Application Server may initiate a MSGin5G
message request to MSGin5G UE, Legacy 3GPP UE or Non-3GPPP UE, upon receiving
the message, the Legacy 3GPP UE or Non-3GPP UE may reply the message.
Editor\'s Note: It is FFS whether a Legacy 3GPP UE and a Non-3GPP UE can
initiate new messages to MSGin5G UE or Application Server.
For group message, MSGin5G UE may initiate a MSGin5G message request to a
MSGin5G Group, all the UEs in the group may send message to the MSGin5G Group
as specified in the requirement [R-5.4.2-001] in 3GPP TS 22.262 [2].
Editor\'s Note: If Legacy 3GPP UE or Non-3GPP UE is in a MSGin5G Group,
whether the Legacy 3GPP UE or Non-3GPP UE can initiate (i.e. start) a group
message or respond to a received group message is FFS.
MSGin5G Service supports UE:
\- That could be IMS and non-IMS base
\- a non-IMS UE may be 3GPP UE and non-3GPP UE
\- MSGin5G UE comprises both application client (optional) and MSGin5G client.
NOTE 3: Application service logic in the application client is out of scope of
this specification.
## 8.2 Application architecture
Figure 8.2-1 shows the application architecture of the MSGin5G Service. The
MSGin5G Service shall fulfil the service requirements which are enumerated in
3GPP TS 22.262 [2].
NOTE 1: \"MSGin5G\" in this document is referred to the new defined transport
for the MSGin5G service. The service name in this document uses the \"MSGin5G
Service\" term in 3GPP TS 22.262 [2].
Figure 8.2-1: Application Architecture of the MSGin5G Service
The MSGin5G client(s) , Legacy-3GPP Message Gateway and Non-3GPP Message
Gateway may interact with SEAL clients over the SEAL-C reference point
specified for each SEAL service. The MSGin5G server(s) interacts with SEAL
servers over the SEAL-S reference point specified for each SEAL service. The
interaction between a SEAL client and the corresponding SEAL server is
supported by SEAL-UU reference point specified for each SEAL service as
specified in 3GPP TS 23.434 [9].
NOTE2: For simplicity, the SEAL clients interact with Legacy 3GPP Message
Gateway and Non-3GPP Message Gateway, and the SEAL-UU interface between Legacy
3GPP Message Gateway and Non-3GPP Message Gateway and SEAL servers are not
shown in Figure 8.2-1.
The MSGinUE-1 may be constrained devices and unconstrained devices with
advanced capabilities, and can communicate with MSGin5G server over MSGin5G-1
reference point. The MSGin5G UE-2 is constrained device which do not have
enough capability to communicate with MSGin5G Server. If allowed by
configuration, the MSGin5G UE-1 may act as a UE Message Gateway to MSGin5G
UE-2.
NOTE 3: In certain deployment option, a Group management function based on
SEAL Group Management Server specified in 3GPP TS 23.434 [9], and a MSGin5G
configuration function based on Configuration Management aspects from SEAL
configuration management Server specified in 3GPP TS 23.434 [9], can be
implemented in the MSGin5G Server. A configuration management client specified
in 3GPP TS 23.434 [9] can be implemented in the MSGin5G Client, Legacy-3GPP
Message Gateway and Non-3GPP Message Gateway. The implementation of such
deployment option is out of this specification.
NOTE 4: In certain deployment option, the UE-2 may not contain MSGin5G Client.
In such scenario, the application client in UE-2 will interact with MSGin5G
Client in UE-1 to send messages.
NOTE 5: When both UE-1 and UE-2 support MSGin5G client, MSGin5G client in UE-1
acts as a relay for the MSGin5G client in UE-2 to receive MSGin5G service.
When UE-2 does not support MSGin5G client and only UE-1 supports MSGin5G
client, MSGin5G client in UE-1 acts as a gateway for the Application client in
UE-2 to receive MSGin5G service.
Editor\'s note: Specifying details of MSGin5G Client interaction towards
Application Client is FFS.
## 8.3 Functional elements
### 8.3.1 General
The functional entities of the application architecture for the MSGin5G
Service are described in this clause.
### 8.3.2 MSGin5G Server
A MSGin5G server provides server-side functionality to assist MSGin5G clients
with the sending and receiving of messages via the MSGin5G Service to/from
Application Servers and/or other MSGin5G service endpoints on other UEs.
Functionalities of MSGin5G Server:
\- To resolve message delivery mechanism for the MSGin5G service end point
based on the terminating MSGSin5G service ID to determine if the message is to
be delivered to a MSGin5G UE, an Application Server or a Message Gateway for
final delivery;
\- Interworking with non 3GPP messaging service through the Non-3GPP Message
Gateway;
\- Interworking with legacy 3GPP messaging service through the Legacy 3GPP
Message Gateway;
\- Exchanging MSGin5G messages with application servers, MSGin5G clients,
Legacy 3GPP Message Gateway and Non-3GPP Message Gateway;
\- Supporting MSGin5G message segmentation according to Service Provider
policy; and
\- Supporting UE configuration procedures as specified in TS23.434 [9] when
the configuration function is implemented in the MSGin5G server to configure
needed information, such as MSGin5G Service ID, maximum message size etc., on
a UE to be ready for the MSGin5G service.
#### 8.3.2.1 Target resolution and Gateway selection
Upon receiving the MSGin5G Message Request to deliver the message to the
target UE (which could be any of the MSGin5G UE, Legacy 3GPP UE, Non-3GPP UE)
on the terminating side, the MSGin5G service performs certain actions in order
to ensure message delivery to the right target UE and in appropriate format.
The actions include determining the service supported by the target UE, need
for gateway and selection of appropriate gateway, and the need for translation
the MSGin5G Message Request to a format understood by the target UE.
Upon receiving the MSGin5G Message Request, the MSGin5G server checks the
MSGin5G UE registration repository (created at the time of each MSGin5G UE
registration to MSGin5G Server) for the target end point identifier. If the
target found in the registration repository is MSGin5G UE, MSGin5G Server will
attempt for delivery towards MSGin5G UE. If the target found in the
registration repository is non-MSGin5G UE, MSGin5G server delivers the message
to Message Gateway that the non-MSGin5G UE is registered with, determined from
the non-MSGin5G UE registration.
#### 8.3.2.2 Protocol Conversion Function
The MSGin5G service supports both constrained devices with limited
capabilities and unconstrained devices with advanced capabilities. It may be
possible that both types of devices support different protocols. The protocol
conversion function in the Msgin5G Server converts one protocol format (for
example, CoAP) into another protocol format (for example, HTTP) or vice versa.
NOTE: The actual protocol selection is out of scope of this specification.
### 8.3.3 MSGin5G Client
A MSGin5G client provides client-side functionality for UE Application Clients
with the sending and receiving of messages via the MSGin5G Service to/from
Application Servers and/or other MSGin5G service endpoints; i.e. UEs.
Functionalities of MSGin5G client:
\- Exposing MSGin5G APIs to enable application clients to use a MSGin5G
Service;
\- Supporting registration of a MSGin5G client to a MSGin5G Server to enable
the exchange of configuration information required to use a MSGin5G Service;
and
\- Exchanging MSGin5G messages via a MSGin5G Server to/from Application
Servers and/or other MSGin5G service endpoints; i.e. UEs.
### 8.3.4 Message Gateway
A Message Gateway in MSGin5G application architecture provides functionality
to deliver MSGin5G messages to non-MSGin5G UEs.
A Message Gateway performs the role of interconnecting two different messaging
delivery mechanisms and assure the message integrity between different message
delivery mechanisms. A message delivery mechanism comprises the specific set
of protocols, procedures and rules.
Functionalities of Message Gateway:
\- Enable s seamless delivery of a MSGin5G message between different message
delivery mechanisms with integrity;
\- Communicates with the MSGin5G server using either a MSGin5G client
functionality or similar functions to enable sending and receiving MSGin5G
messages;
\- Delivers payload of a MSGin5G message to the non-MSGin5G UE using the
specific message delivery mechanism available to that non-MSGin5G UE and vice
versa; Performs message sender and receiver addresses conversion according to
the two connected message delivery mechanisms and maintain the mapping of the
address pair used for a response message delivery;
\- Perform registration and de-registration with the MSGin5G server on behalf
of the non-MSGin5G UEs;
\- Act as a service endpoint to perform message segmentation and reassembly
for the non-MSGin5G UEs when needed;
\- Performs conversion of the target UE address that is understood in the
destination domain; and
\- Performs protocols and non-message payload information conversion according
to the service supported by the target UE and assure no loss of message
payload and essential non message payload information such as a delivery
report request;
\- Supports the MSGin5G message delivery status report
1\. If application level message delivery status report is not supported by
the Non-MSGin5G message delivery mechanisms (e.g. SMS), based on the
information (e.g. response to the message delivery request, transport level
information, etc) obtained from the Non-MSGin5G message delivery mechanisms,
fetch the delivery status from the above information and use it to create a
MSGin5G message delivery status report on behalf of Non-MSGin5G UE. If the
delivery status is failure, also fetch the suitable failure reason from the
above information and use it as reason of failure in the MSGin5G message
delivery status report.
2\. If application level message delivery status report is supported by the
Non-MSGin5G message delivery mechanisms (e.g. RCS specified in GSMA PRD RCC.07
[4]), translates the application level message delivery status report in the
Non-MSGin5G message delivery mechanisms to MSGin5G message delivery status
report.
There are two types of Message Gateways used to deliver MSGin5G messages to
different UE types: the Legacy 3GPP Message Gateway and the non-3GPP Message
Gateway
NOTE: Implementation of the Legacy 3GPP Message Gateway and the MSGin5G Server
together is deployment option that is out of this specification.
#### 8.3.4.1 Legacy 3GPP Message Gateway
The Legacy 3GPP Message Gateway is used to deliver MSGin5G message to Legacy
3GPP UEs.
#### 8.3.4.2 Non-3GPP Message Gateway
The Non-3GPP Message Gateway is used to deliver MSGin5G message to non-3GPP
UEs.
### 8.3.5 Application Client
The application client provides client-side messaging service logic and needed
information for the MSGin5G client to perform MSGin5G service with other
endpoints. Using application client to provide this information to the MSGin5G
client is optional as there are other ways to provide this information to the
MSGin5G client such as a native UE implementation with pre-configured
information.
### 8.3.6 Application Server
The Application Server supports sending and receiving messages with MSGin5G
service layer protocols and procedures.
### 8.3.7 Void
### 8.3.8 Non-3GPP Message Client
The Non-3GPP message client provides client-side functionality for a Non-3GPP
messaging service.
NOTE: The details of the Non-3GPP message client are out of scope of the
present document.
### 8.3.9 Void
### 8.3.10 SEAL client
The following SEAL clients for MSGin5G Service are supported:
\- Group management client as specified in 3GPP TS 23.434 [9];
\- Configuration management client as specified in 3GPP TS 23.434 [9].
### 8.3.11 SEAL server
The following SEAL servers for MSGin5G Service are supported:
\- Group management server as specified in 3GPP TS 23.434 [9];
\- Configuration management server as specified in 3GPP TS 23.434 [9].
Editor\'s Note: Usage of other SEAL services (e.g. location) from 3GPP TS
23.434 [9] for MSGin5G Service is FFS.
## 8.4 Reference Points
### 8.4.1 General
The reference points of the service architecture for the MSGin5G Service are
described in this clause.
### 8.4.2 MSGin5G-1
The interactions related to enabling MSGin5G message exchange between a
MSGin5G client and a MSGin5G Server are supported by the MSGin5G-1 reference
point. This reference point supports:
\- Registration of a MSGin5G client to a MSGin5G Server when not using IMS
base solution; and
\- The exchange of MSGin5G messages.
### 8.4.3 MSGin5G-2
The interactions related to enabling MSGin5G message exchange between a
MSGin5G Server and the Legacy 3GPP Message Gateway are supported by the
MSGin5G-2 reference point. This reference point supports:
\- indicating the underlying message delivery mechanism to the Legacy 3GPP
Message Gateway;
\- exchange of MSGin5G messages; and
\- registration of Legacy 3GPP Message Gateway to MSGin5G Server.
### 8.4.4 MSGin5G-3
The interactions related to enabling MSGin5G message exchange between an
Application Server and a MSGin5G Server are supported by the MSGin5G-3
reference point. This reference point supports:
\- Access to MSGin5G Server and APIs to enable sending and receiving of
MSGin5G messages; and
\- Adherence to CAPIF as specified in 3GPP TS 23.222 [13].
### 8.4.5 MSGin5G-4
The interactions related to enabling MSGin5G message exchange between a
Non-3GPP Message Gateway and a MSGin5G Server are supported by the MSGin5G-4
reference point. This reference point supports:
\- Registration of Non-3GPP Message Gateway to MSGin5G Server; and
\- The exchange of MSGin5G messages.
### 8.4.6 MSGin5G-5
The interactions related to enabling MSGin5G message related information
exchange between an application client and a MSGin5G client are supported by
the MSGin5G-5 reference point. This reference point supports:
\- Providing information from application clients required to enable the
MSGin5G client to construct a MSGin5G message to be delivered to other MSGin5G
service endpoints.
\- Configuring application clients with information required to enable the
MSGin5G client and MSGin5G Server to exchange and route MSGin5G messages to
other MSGin5G service endpoints.
\- Sending notifications and information in the incoming MSGin5G messages
received by the MSGin5G client to the application clients from other MSGin5G
service endpoints.
### 8.4.7 MSGin5G-6
The MSGin5G Client-2 of MSGin5G UE-2 communicates with MSGin5G Client-1 of
MSGin5G UE-1 over MSGin5G-6 reference point. The interface is based on NR PC5.
### 8.4.8 Void
### 8.4.9 SEAL-C
The following SEAL-C reference points for MSGin5G Service are supported:
\- GM-C reference point for group management as specified in 3GPP TS 23.434
[9];
\- CM-C reference point for configuration management as specified in 3GPP TS
23.434 [9].
### 8.4.10 SEAL-S
The following SEAL-S reference points for MSGin5G Service are supported:
\- GM-S reference point for group management as specified in 3GPP TS 23.434
[9];
\- CM-S reference point for configuration management as specified in 3GPP TS
23.434 [9].
### 8.4.11 SEAL-UU
The following SEAL-UU reference points for MSGin5G Service are supported:
\- GM-UU reference point for group management as specified in 3GPP TS 23.434
[9];
\- CM-UU reference point for configuration management as specified in 3GPP TS
23.434 [9].
# 9 Overall Evaluation
This Technical Report describes the architecture and high-level stage-2
procedure alternatives for MSGin5G service. In this document, 26 Key Issues
are derived from stage 1 requirements and technical analysis. 20 of them are
addressed by solutions. The related information are shown in Table 9-1.
Editor\'s note: The data of KIs and solutions is based on the approved until
SA6#41-e. When more KIs and Solutions are finished, this table is needed to be
updated accordingly.
Table 9-1: Key Issues and Solutions
+----------------------+---------------------+----------------------+ | Key Issue | Stage 1 requirement | Solution | +======================+=====================+======================+ | Key Issue 1: support | [R-5.1.2-004] | Solution 14: | | acknowledgement of | | Acknowledgement of | | delivery status | | Delivery Status | | | | | | | | (NOTE: Several other | | | | solutions related | | | | with message | | | | delivery contains | | | | the solution of | | | | Delivery Status | | | | report) | | | | | | | | Solution 26: | | | | Aggregated delivery | | | | report (Used for | | | | Group Message status | | | | acknowledgement) | +----------------------+---------------------+----------------------+ | Key Issue 2: Cell | [R-5.5.2-002] | Solution 1: Payload | | Broadcast Service in | | size of 2048 octets | | MSGin5G | | in Broadcast | | | | | | | | Solution 7: MSGin5G | | | | Server message | | | | broadcast | +----------------------+---------------------+----------------------+ | Key Issue 3: | [R-5.2.2-002] | Solution 2: | | identifier(s) of the | | Registering MSGin5G | | UE | [R-5.2.2-003] | Client to MSGin5G | | | | Server | | | | | | | | Solution 8: | | | | Identities | | | | | | | | Solution 11 (Cover | | | | client registration | | | | enhancement for | | | | Application-to-point | | | | messaging in | | | | 6.11.1.2 and | | | | Application Server | | | | registr | | | | ation/deregistration | | | | in 6.11.1.3) | | | | | | | | Solution 27 UE | | | | Registration | | | | | | | | Solution 28: Support | | | | for constrained | | | | devices in MSGin5G | | | | service | +----------------------+---------------------+----------------------+ | Key Issue 4: network | [R-5.1.2-006] | Solution 3: MSGin5G | | triggering the UE | | Triggering | +----------------------+---------------------+----------------------+ | Key Issue 5: Message | [R-5.1.2-007] | Solution 9: Point to | | transfer from | | point Messaging | | MSGin5G UE and | | (covers message | | Non-3GPP UE to | | delivery from | | MSGin5G Server | | MSGin5G UE to 3 | | | | types of UE). | | | | | | | | Solution 15: Point | | | | to point Messaging | | | | (UE reply a message) | | | | (covers message | | | | reply from non-3GPP | | | | UE to MSGin5G UE) | | | | | | | | Solution 28: Support | | | | for constrained | | | | devices in MSGin5G | | | | service | +----------------------+---------------------+----------------------+ | Key Issue 6: Message | [R-5.1.2-007] | Solution 9: Point to | | delivery from | | point Messaging | | MSGin5G Server to | | | | Non-3GPP UE | | Solution 10: | | | | Application to point | | | | Message Exchange | | | | | | | | Solution 28: Support | | | | for constrained | | | | devices in MSGin5G | | | | service | +----------------------+---------------------+----------------------+ | Key Issue 7: group | [R-5.4.2-001] | Solution 5: MSGin5G | | message | | Group messaging | | | [R-8.2-001] | | | | | Solution 28: Support | | | [R-9.2-001] | for constrained | | | | devices in MSGin5G | | | [R-5.1.2-007] | service | | | | | | | [R-10.2-001] | | +----------------------+---------------------+----------------------+ | Key Issue 8: group | [R-5.4.2-002] | Solution 4: Group | | management | | management using | | | | SEAL (establishing a | | | | group, adding UEs to | | | | the group or | | | | removing UEs from | | | | the group, | | | | configuration of a | | | | maximum number of | | | | members in a group, | | | | group notification | | | | interworking, group | | | | list fetch) | +----------------------+---------------------+----------------------+ | Key Issue 9: | [R-5.3.2-001] | Solution 10: | | Application-to-point | | Application to point | | message exchange | [R-5.3.2-002] | Message | | | | Exchange(Covers | | | [R-10.2-001] | message delivery | | | | from Application | | | | Server to 3 types of | | | | UEs) | | | | | | | | Solution 11: MSGin5G | | | | Application-to-point | | | | message | | | | exchange(Covers | | | | message delivery | | | | from Application | | | | Server to MSGin5G | | | | UE) | | | | | | | | Solution 22: MOAT | | | | Messaging (Covers | | | | message delivery | | | | from 3 types of UEs | | | | to 3 Application | | | | Server) | | | | | | | | Solution 23: APIs | | | | provided by MSGin5G | | | | server (Addresses | | | | interface between | | | | MSGin5G Server and | | | | Application Server) | | | | | | | | Solution 28: Support | | | | for constrained | | | | devices in MSGin5G | | | | service | +----------------------+---------------------+----------------------+ | Key Issue 10: | [R-5.5.2-002] | Solution 16: Use of | | broadcast area | | Broadcast Area | | configuration | | configuration in | | | | MSGin5G message | | | | broadcast | +----------------------+---------------------+----------------------+ | Key Issue 11: | [R-5.1.2-008] | No Solution is | | mobility management | | needed. | | of MSGin5G related | | | | information | | | +----------------------+---------------------+----------------------+ | Key Issue 12: | [R-5.1.2-001] | No Solution is | | End-to-end latency | | needed. | | | [R-5.5.2-001] | | | | | | | | [R-5.3.2-003] | | +----------------------+---------------------+----------------------+ | Key Issue 13: | [R-5.1.2-005] | Solution 21: | | Message store and | | Store-and-forwarding | | forward | | of MSGin5G messages | +----------------------+---------------------+----------------------+ | Key Issue 14: | [R-5.1.2-002] | Solution 12: Message | | Message Segmentation | | segmentation and | | and Reassembly | | reassembly | | | | | | | | Solution 13: MSGin5G | | | | Message Segmentation | | | | and Reassembly | +----------------------+---------------------+----------------------+ | Key Issue 15: | | No Solution is | | Message delivery | | needed. | | from MSGin5G Server | | | +----------------------+---------------------+----------------------+ | Key Issue 16: | [R-6.2-001] | Solution 6: Charging | | Charging | | | | | [R-6.2-002] | NOTE: no content, | | | | will be handled by | | | | SA5 | +----------------------+---------------------+----------------------+ | Key Issue 17: | [R-9.2-001] | Solution 18: | | Interconnection | | Interconnection | | | [R-9.2-002] | | +----------------------+---------------------+----------------------+ | Key Issue 18: | [R-8.2-001] | Solution 25: Roaming | | Roaming | | | +----------------------+---------------------+----------------------+ | Key Issue 19: | generic requirement | Solution 17: | | Efficient resource | | Aggregated messaging | | usage of the control | e.g. section 4.1 | for small data | | plane and user plane | | messages | +----------------------+---------------------+----------------------+ | Key Issue 20: Obtain | | Solution 24: MSGin5G | | Contact Information | | message delivery | | | | based on messaging | | | | topic (Covers the | | | | scenario that the | | | | contact information | | | | of the other | | | | party/parties is/are | | | | unknown) (gaps | | | | partial addressed) | +----------------------+---------------------+----------------------+ | Key Issue 21: Study | | No Solution is | | if IMS is feasible | | needed. | | as a solution | | | +----------------------+---------------------+----------------------+ | Key Issue 22: | | Solution 20: Support | | MSGin5G Service | | of multiple delivery | | Exposure of multiple | | mechanisms for | | delivery mechanisms | | legacy 3GPP UEs | | to the applications | | | +----------------------+---------------------+----------------------+ | Key Issue 23: | [R-10.2-001] | Solution 15: Point | | Message delivery | | to point Messaging | | from Legacy 3GPP UE | | (UE reply a | | | | message)(see | | | | 6.15.1.2) | +----------------------+---------------------+----------------------+ | Key Issue 24: | | No Solution is | | Capabilities of UE | | needed. | | without MSGin5G | | | | client | | | +----------------------+---------------------+----------------------+ | Key Issue 25: | [R-5.1.2-003] | No Solution is | | deliver message to | | needed. | | Application Client | | | +----------------------+---------------------+----------------------+ | Key issue 26 -- | [R-5.3.2-002] | Solution 19: MSGin5G | | Capability exposure | | application enabler | | to Application | | layer adaptation to | | Server using CAPIF | | CAPIF | +----------------------+---------------------+----------------------+
NOTE: All requirements specified in 3GPP TS 22.262 [2] have been addressed in
the present document.
# 10 Conclusions and recommendations
## 10.1 Conclusions
The results from the study will be considered for follow-up normative work in
Release 17 as follows:
Editor\'s Note: The conclusions listed below are used for early consideration.
When more solutions are provided and analyses of these solutions are finished,
the following conclusions are needed to be updated accordingly.
> 1) The architecture requirements and UE definitions (in clause 8) will be
> considered as the basis for technical specification with necessary
> enhancements and additions;
>
> 2) For key issue 3, the solution8 for UE identification will be used as the
> baseline solution for technical specification with necessary enhancements
> (e.g. if enabling multiple Application Clients on a UE to communicate with
> the same Application Server, an identifier for Application Clients is
> necessary for routing).
>
> 3) The message reply from a Legacy 3GPP UE or Non-3GPP UE to a MSGin5G UE in
> Solution 15 will be used as the baseline solution for technical
> specification with necessary enhancements.
>
> 4) The solution (in Solution 18) for interconnection will be used as the
> baseline solution for technical specification with necessary enhancements;
>
> 5) The solution 19 and solution 23 for MSGin5G Server to interact with
> Application Server will be used as the baseline solution for technical
> specification with necessary enhancements.
>
> **6) As solution 13, if** MSGin5G **Server/Client receives a message payload
> from Application Server/Client and the message payload size exceeds the
> maximum allowed packet size (e.g. due to limitation by the UE\'s access
> network transport), the MSGin5G Server/Client will need to perform the**
> message segmentation and re-assembly.
>
> 7) For MOAT messaging
>
> \- The solution of message delivery from a MSGin5G UE to Application Server
> in Solution 22 will be used as the baseline solution for technical
> specification with necessary enhancements. The MSGin5G UE may obtains the
> identifier of the available Application Server service ID list by the
> MSGin5G Client registration as solution 11.
>
> \- The solution of message reply from a Legacy 3GPP UE or Non-3GPP UE to
> Application Server in Solution 22 will be used as the baseline solution for
> technical specification with necessary enhancements.
>
> 8) As shown in solution 9, 10, 15, 20 and 22, the Legacy 3GPP Message
> Gateway will be used for interworking with legacy 3GPP messaging services,
> the Non-3GPP Message Gateway will be used for interworking with non-3GPP
> message services.
>
> 9) The solution 24 is needed to be used as a messaging mechanism especially
> for the scenarios which the MSGin5G Service ID of the receiver is difficult
> to be got by the sender.
>
> 10) The solution 4 addressing the Group Management aspects will be used as
> the baseline solution for technical specification with necessary
> enhancements. Group management function based on SEAL Group Management
> Server specified in 3GPP TS 23.434 [9] can be implemented in the MSGin5G
> Server or outside of MSGin5G Server as a SEAL server.
>
> 11) The solution 5 addressing the Group Messaging aspects will be used as
> the baseline solution for technical specification with necessary
> enhancements.
>
> 12) The solution 17 addressing the Aggregated messaging for small data
> messages will be used as the baseline solution for technical specification
> with necessary enhancements.
>
> 13) The solution 26 addressing the sending delivery report from message
> receiver UE back to message sender UE with store and forward with
> aggregation of delivery report, will be used as the baseline solution for
> technical specification with necessary enhancements.
>
> 14) For key issue 1, solution 14 for Acknowledgement of Delivery Status,
> implemented to complement the message delivery solutions 9, 10, 15, 20 and
> 22, will be used as the baseline solution for the technical specification
> with necessary enhancements.
>
> 15) For key issue 4, solution 3 for MSGin5G Triggering will be used as the
> baseline solution for technical specification with necessary enhancements.
>
> 16) The solution 28 enabling support for constrained devices in MSGin5G
> service will be used as the baseline solution for technical specification
> with necessary enhancements.
>
> 17) Solution 27 is proposed as the baseline for registration with pre-
> provisioned ID with necessary enhancements;
>
> 18) Solution 2 proposes a registration procedure for MSGin5G UEs that don\'t
> have pre-provisioned MSGin5G service ID; Support for this use case will be
> be further developed in normative phase based on this solution, with
> necessary enhancements.
19) For point to point message delivery from MSGin5G UE to 3 types of UE,
\- the solution of message delivery from MSGin5G Client to MSGin5G Server in
solution 9 will be used as the baseline solution for technical specification
with necessary enhancements.
\- the solution of message delivery from MSGin5G Server to MSGin5G Client or
Non-3GPP UE in solution 9 will be used as the baseline solution for technical
specification with necessary enhancements.
\- for message delivery from MSGin5G Server to Legacy 3GPP UE, MSGin5G server
determines the target UE is a Legacy 3GPP UE and sends MSGin5G Message Request
to Legacy 3GPP Message Gateway. The Legacy 3GPP Message Gateway determines
which legacy 3GPP message delivery mechanism (e.g. SMS, NIDD, Device
triggering, etc.) will be used for delivering message to Legacy 3GPP UE. If
SMS mechanism is selected by Legacy 3GPP Message Gateway, solution 9 will be
used as the baseline solution for technical specification with necessary
enhancements. If NIDD or Device Triggering is selected by Legacy 3GPP Message
Gateway, solution 20 will be used as the baseline solution for technical
specification with necessary enhancements.
20) For AOMT message delivery,
\- the solution of message delivery in from Application Server to MSGin5G
Server, Application Server delivers message to MSGin5G Server by invoking
Application-to-Point Message Delivery API in solution 23.
\- the solution of message delivery from MSGin5G Server to MSGin5G Client in
solution 10/11 will be used as the baseline solution for technical
specification with necessary enhancements.
\- the solution of message delivery from MSGin5G Server to Non-3GPP UE in
solution 10 will be used as the baseline solution for technical specification
with necessary enhancements.
\- for message delivery from MSGin5G Server to Legacy 3GPP UE, MSGin5G server
determines the target UE is a Legacy 3GPP UE and sends MSGin5G Message Request
to Legacy 3GPP Message Gateway. The Legacy 3GPP Message Gateway determines
which legacy 3GPP message delivery mechanism (e.g. SMS, NIDD, Device
triggering, etc.) will be used for delivering message to Legacy 3GPP UE. If
SMS mechanism is selected by Legacy 3GPP Message Gateway, solution 10 will be
used as the baseline solution for technical specification with necessary
enhancements. If NIDD or Device Triggering is selected by Legacy 3GPP Message
Gateway, solution 20 will be used as the baseline solution for technical
specification with necessary enhancements.
###### ### Annex A: 5G Architecture considerations
The figures in clause 4 on scenarios show high-level diagrams that need to be
mapped onto the 5G architecture as specified in 3GPP TS 23.501 [14] in order
to verify if the MSGin5G service can be provided by the 5G architecture. The
MSGin5G service architecture as shown in figure A-1 is taken from 3GPP TS
22.262 [2] and shows the consolidated service architecture for all scenarios.
Figure A-1: MSGin5G Service Architecture
UE A is a Controller UE which uses the MSGin5G Service to send messages to
Controlled UEs, possibly via the APP Server in case the MSGin5G Server is
unable to deal with APP specific issues.
UE B is a Controlled UE that supports the MSGin5G Service.
UE C is a Controlled UE which doesn\'t support the MSGin5G Service, but
supports SMS. The MSGin5G Server converts MSGin5G messages into SMS messages.
UE D is a Controller UE or a Controlled UE which doesn\'t support the MSGin5G
Service, but supports a non-3GPP messaging service.
All UEs (UE A, UE B, UE C and UE D) use the NG-RAN, either via the NR access
network or via a non-3GPP access network.
NOTE1: Even though figure A-1 suggest the MSGin5G Gateway is in between the 5G
Core or Access Network and UE D, 3GPP TS 22.262 [2] states that UE D is
connected via NG-RAN.
NOTE2: Access via E-UTRAN is not in scope of the study.
The APP Server can generate messages in MSGin5G format which are distributed
to Controlled UEs by the MSGin5G Server.
Figure A-2 shows the MSGin5G architecture, based on the non-roaming
architecture from 3GPP TS 23.501 [14] where the MSGF and MGWF reside in a
trusted DN.
Figure A-2: MSGin5G System Architecture for non-roaming
All UEs are connected to the NG-RAN. MSGin5G UE and Non-3GPP UE are Controller
UEs and MSGin5G UE, Legacy 3GPP UE and Non-3GPP UE are Controlled UEs.
The MSGin5G Server is shown as the MSGin5G Function (MSGF) in figure A-2. The
MSGin5G Gateway is shown as the MSGin5G Gateway Function (MGWF) and the APP
Server connects directly to the MSGF (in case it supports the MSGin5G Service)
or to the MGWF (if it supports a non-3GPP messaging service) and may reside
outside the 5GS in an external DN.
The MSGF manages the distribution of the messages it has received from MSGin5G
UE, Non-3GPP UE, from an APP Server, or from the MSGF. The MSGF may use
application specific functionality from the APP server that doesn\'t reside in
the MSGF itself.
A CBCF is specified in 3GPP in 3GPP TS 23.041 [6] and can be used for
broadcasting messages in the MSGin5G message format to MSGin5G UE devices and
in separate messages in a non-3GPP message format to Non-3GPP UED devices.
Even though the CBCF is shown in figure A-2 as a Service Producer network
function, it has no service-based interface. This interface could be specified
in stage 2 or ATIS-0700008.v002 [12] could be referred to.
The SMSF is specified in 3GPP TS 23.501 [14] and its services can be invoked
by the MSGF to send a message as SMS to Legacy 3GPP UE.
Messages towards Non-3GPP UE devices are sent from the MSGF in MSGin5G format
to the MGWF and are converted by the MGWF into a non-3GPP message format and
also distributed by the MSGF. An APP Server can be used to create messages in
the MSGin5G format and the APP Server may receive messages from MSGin5G UE or
Non-3GPP UE. These messages are routed to the MSGF for further distribution to
UEs of type MSGin5G UE, Legacy 3GPP UE or Non-3GPP UE.
An APP Server that doesn\'t support the MSGin5G Service can send its messages
to the MGWF, which converts the message to MSGin5G format before forwarding it
to the MSGF.
MSGin5G UE can send its MSGin5G messages to the MSGF via the Control Plane or
the User Plane (see Key Issue 5).
Non-3GPP UE can send messages in a non-3GPP message format via the Control
Plane or the User Plane (see Key Issue 5) to the MGWF and the MGWF will
convert the message into a MSGin5G message format before forwarding it to the
MSGF.
Editor\'s Note: Gaps are yet to be identified.
###### ### Annex B: Aggregated New Message Request
# B.1 Description
This contribution considers the New Message Request that is received by the
MSGin5G server. In this request all solutions in the TR that provide details
on a New Message Request for a particular Key Issue are aggregated into a
single message request for the inbound message into the MSGin5G server.
The outbound message from the MSGin5G Server is not considered in the present
annex.
Figure B.1-1 shows the procedure for a UE that initiates a message request.
Figure B.1-1: New Message Request from UE
Figure B.1-2 shows the same procedure (from step 2 onwards), however for an
Application Server that initiates a message request.
Figure B.1-2: New Message Request from Application Server
Figure B.1-3 shows the procedure (from step 2 onwards) for a Legacy 3GPP
Gateway or a non-3GPP Gateway that forwards a new message request to the
MSGin5G Server.
Figure B.1-3: New Message Request forwarding from Gateway
The following procedure applies to the above figures B.1-1, B.1-2 and B.1-3
with the exception that step 1 only applies to figure B.1-1.
1\. The Application Client-1 in the UE invokes the MSGin5G Client in the UE to
send payload in a new message request to a recipient or to multiple
recipients.
NOTE: The API is out of scope of the present annex.
2\. The Message Request is sent to the MSGin5G Server and includes the IEs as
listed in table B.1-1 in the request.
Table B.1-1: Message Request to MSGin5G Server
+-----------------------------+--------+-----------------------------+ | Information element | Status | Description | +=============================+========+=============================+ | Originating MSGin5G service | M | The service identity of the | | ID | | sending MSGin5G Client or | | | | the sending Application | | | | Server. | +-----------------------------+--------+-----------------------------+ | Recipient MSGSin5G service | O | The service identity of the | | ID | | receiving MSGin5G Client or | | | | the receiving Application | | | | Server. | | | | | | | | This IE is mandatory for | | | | point-to-point messaging, | | | | application-to-point | | | | messaging, AOMT messaging | | | | and MOAT messaging and is | | | | not present in other | | | | message scenarios. | +-----------------------------+--------+-----------------------------+ | Recipient Group ID | O | The identifier of the | | | | target MSGin5G Group. | | | | | | | | This IE is mandatory for a | | | | Group message request and | | | | is not present in other | | | | message scenarios. | +-----------------------------+--------+-----------------------------+ | Recipient Service Area ID | O | The identifier of the | | | | Service Area where the | | | | message needs to be | | | | broadcast. | | | | | | | | This IE is mandatory in the | | | | Broadcast Message and is | | | | not present in other | | | | message scenarios. | +-----------------------------+--------+-----------------------------+ | Application ID | O | Identifies the application | | | | for which the payload is | | | | intended. | | | | | | | | This IE is required when | | | | the message is sent to | | | | multiple Application | | | | Clients served by same | | | | MSGin5G Client. | | | | | | | | This IE may be included | | | | when the message is sent to | | | | an Application Server or | | | | from an Application Client. | | | | | | | | The content of this IE is | | | | transparent to the MSGin5G | | | | message delivery service | | | | (i.e. MSGin5G Service is | | | | unaware of the content). | +-----------------------------+--------+-----------------------------+ | Message ID | M | Unique identifier of this | | | | message | +-----------------------------+--------+-----------------------------+ | Security Credentials | O | Security information | | | | required by the MSGin5G | | | | Server. | +-----------------------------+--------+-----------------------------+ | Delivery Status | O | Indicates if delivery | | | | acknowledgement from the | | | | recipient is requested | +-----------------------------+--------+-----------------------------+ | Payload | M | Payload of the message. | | | | | | | | The content of this IE is | | | | transparent to the MSGin5G | | | | message delivery service | | | | (i.e. MSGin5G Service is | | | | unaware of the content). | +-----------------------------+--------+-----------------------------+ | Priority Type | O | Application priority level | | | | requested for this message. | +-----------------------------+--------+-----------------------------+ | Message is segmented | O | Indicates this message is | | | | part of a segmented | | | | message. | +-----------------------------+--------+-----------------------------+ | Total number of message | O | Indicates the total number | | segments | | of segments for the | | | | message. | +-----------------------------+--------+-----------------------------+ | Message segment number | O | The message segment number | | | | for the segmented message | +-----------------------------+--------+-----------------------------+
Extended description of Information Elements:
\- The _Originating MSGin5G service ID_ IE is required to route the response.
Based on the _Message ID_ IE the MSGin5G Client is aware which Application
Client initiated the request and where the Delivery Status response (if any)
should go; hence there is no need for an Originating Application ID IE.
The recipient is identified through the:
_\- Recipient MSGin5G service ID_ IE for a point-to-point message, or the
_\- Recipient Group ID_ IE for a group message, or the
_\- Recipient Service Area ID_ IE for the broadcast message,
> and the _Application ID_ IE in case the receiving MSGin5G Client serves
> multiple Application Clients, or the Application Server serves multiple
> applications.
\- The _Message ID_ IE identifies the request and is also used in responses
and status reports.
\- The _Security Credentials_ IE is a placeholder for SA3 security
information.
\- The _Delivery Status_ IE is a flag that indicates if the recipient needs to
acknowledge reception of the payload.
\- The _Payload_ IE is the application payload which needs to be delivered to
the recipient, of which the content is out of scope.
\- The _Priority Type_ IE is used by the MSGin5G Server.
\- The _Message is segmented_ IE; the _Total number of message segments_ IE
and the M _essage segment number_ IE are used in segmented messages. The
maximum segment size is a configured value.
3\. Based on registration information (or other information) the MSGin5G
Server determines if the recipients are available to receive the message or if
the message needs to be stored for deferred delivery.
4\. If the message needs to be stored for deferred delivery the MSGin5G Server
stores the message request with the relevant delivery information.
5\. The MSGin5G Server may return a response to the originating entity and
includes the IEs as listed in table B.1-2 in the response.
Table B.1-2: Message Response
Information element Status Description
* * *
Originating MSGin5G service ID M The identity of the MSGin5G Client or the
identity of the Application Server that initiated the Message Request. Message
ID M Identifier contained in the Message Request Delivery Status O Indicates
if delivery is a failure, or if the message is stored for deferred delivery.
Failure Code O The code for failure reason Message segment number O Indicates
the missing message segment.
Extended description of Information Elements:
\- The _Originating MSGin5G service ID_ IE is copied from the Message Request
as received in step 2.
\- The _Message ID_ IE is copied from the Message Request as received in step
2.
\- The _Delivery Status_ IE is included in the response for the last message
segment and indicates if delivery by the MSGin5G Server to recipient(s)
\- Failed, or
\- If delivery is deferred for at least one recipient, the number of
recipients for which delivery is deferred.
\- The _Failure Code_ IE identifies the type of the error.
\- The _Message segment number_ IE identifies the message segment for which
delivery to the MSGin5G Server failed.
6\. If the _Delivery Status_ IE was present in the Message Request in step 2,
the recipient(s) will send the delivery status to the message originator. This
step is out of scope of the present procedure but is shown to distinguish
between the _Delivery Status_ IE is the Message Request in step 2 and the
_Delivery Status_ IE in the Message Response.
# B.2 Evaluation
The Aggregated New Message Request allows a single request to be used for all
inbound messages into the MSGin5G Server. Depending on the sending entity
(only) relevant Information Elements are populated.
This Aggregated New Message Request does not include aggregation of messages
with small data payload that are sent in a single message. For such
aggregation Solution #17 is required. The Aggregated New Message Request can
be used for the individual messages since all IEs in table 6.17.2.1-2 for the
individual message data are included in the Aggregated New Message Request.
#