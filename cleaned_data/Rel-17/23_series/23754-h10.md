# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
This study item shall address the following system enablers for supporting
Unmanned Aerial Systems Connectivity, Identification, and Tracking:
\- a mechanism for Unmanned Aerial Vehicles (UAV) controller and UAV(s)
identification and tracking in the 3GPP system;
\- this includes how the 3GPP system can provide support for UAV to ground
identification (e.g. to authorized third parties such as police devices);
\- a mechanism to support UAV controller and UAV(s) authorization and
authentication by UTM;
\- a mechanism to handle unauthorized UAVs and revocation of authorization
(e.g. lack of connectivity to carry the UAV command and control messages,
denied registration, etc.) that enables the system to keep track of and
control UAV(s).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] FAA Remote Identification of Unmanned Aircraft System,
https://www.federalregister.gov/documents/2019/12/31/2019-28100/remote-
identification-of-unmanned-aircraft-systems.
[3] UAS Identification and Tracking (UAS ID) Aviation Rulemaking Committee
(ARC),
https://www.faa.gov/regulations_policies/rulemaking/committees/documents/media/UAS%20ID%20ARC%20Final%20Report%20with%20Appendices.pdf.
[4] LAANC: UAS Data Exchange: Low Altitude Authorization and Notification
Capability (LAANC),
https://www.faa.gov/uas/programs_partnerships/data_exchange/.
[5] 3GPP TS 22.125: \"Unmanned Aerial System (UAS) support in 3GPP\".
[6] 3GPP TR 23.755: \" Study on application layer support for Unmanned Aerial
Systems (UAS)\".
[7] 3GPP TS 23.502: \"Procedures for the 5G System (5GS)\".
[8] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".
[9] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall
description; Stage 2\".
[10] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[11] ASTM F3411‑19: \"Standard Specification for Remote ID and Tracking\",
https://www.astm.org/Standards/F3411.htm.
[12] 3GPP TS 23.501: \"System architecture for the 5G System (5GS)\".
[13] 3GPP TS 23.271: \"Functional stage 2 description of Location Services
(LCS)\".
[14] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[15] CAAC UAV cloud system data specification:
http://www.caac.gov.cn/XXGK/XXGK/BZGF/HYBZ/202008/t20200824_204191.html.
> [16] CAAC Regulations on the Management of Flight Dynamic Data of Light and
> Small Civil UAVs:
> http://www.caac.gov.cn/XXGK/XXGK/GFXWJ/201911/t20191120_199530.html.
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
**Networked UAV Controller:** a UAV Controller connected to the 3GPP network
and connected to the UAV via a 3GPP network.
**Non Networked UAV Controller:** a UAV Controller not connected to the 3GPP
network and connected to UAV via a transport outside the scope of 3GPP, e.g.
internet connectivity or direct wireless communication over a technology
outside the scope of 3GPP.
**Third Party Authorized Entity:** is either a privileged Networked UAV
Controller, or a privileged Non-Networked UAV Controller, or another entity
which gets information on sets of UAV controllers and UAVs from the 3GPP
network, and may be connected to the UAV via the Internet; it may be
authorized by the UTM to interface with sets of UAV(s).
**Command and Control (C2) Communication:** the user plane link to deliver
messages with information of command and control for UAV operation from a UAV
controller or a UTM to a UAV or to report telemetry data from a UAV to its UAV
controller or a UTM.
**CAA (Civil Aviation Administration)-level UAV Identity** : is assigned by
USS/UTM, and uniquely identify a UAV at least within the scope of a USS/UTM.
**Networked Remote ID:** The capability of providing Remote Identification and
Tracking over 3GPP network.
**Broadcast Remote ID:** The capability of providing Remote Identification and
Tracking over broadcast radio links.
NOTE: In the scope of this release, the radio link for Broadcast Remote ID is
assumed to utilize radio technologies outside the scope of 3GPP as identified
in \'FAA Remote Identification of Unmanned Aircraft System\' [2].
The following definitions are adopted from TS 22.125 [5]:
**Above ground level (AGL)**
**Unmanned Aerial System (UAS)**
The following definitions are adopted from TR 23.755 [6]:
**Remote Identification (Remote ID) of UAS**
**UAS Service Supplier (USS)**
**UAS Traffic Management (UTM)**
**UAV controller**
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
\ \
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
ATC Air Traffic Control
BRID Broadcast Remote Identification
FAA Federal Aviation and Administration
LAANC Low Altitude Authorization and Notification Capability
NRID Networked Remote Identification
RID Remote Identification
# 4 Architectural Requirements and Assumptions
Editor\'s note: This clause will list general architectural assumptions and
principles for this study.
## 4.1 Architectural Requirements
Editor\'s note: This clause will define the architectural requirements.
\- Solution should be applicable to EPS and 5GS.
\- The 3GPP system shall enable UTM to associate the UAV and UAV controller
and identify them for both 3GPP networked UAV controller and non-3GPP
networked UAV controller.
\- The 3GPP network shall enable the serving PLMN of the UAV(s) and the
serving PLMN of the corresponding UAV controller to be different.
\- Solutions shall minimize the impact on 5GS and EPS system protocols.
## 4.2 Architectural Assumptions
\- Each UAS consist of one UAV Controller and one UAV.
\- The UTM is a set of functionalities defined outside the 3GPP system and
subject to specific regional requirements
\- Connectivity for Command and control of a UAV may be between the UAV and,
mutually exclusively, an UAV Controller, or a TPAE, or the UTM.
\- UAVs not connected through the 3GPP network are out of scope of the 3GPP
system.
\- Each networked component of a UAS is considered as an individual UE from
the perspective of the 3GPP system.
\- A UAV can be replaced by another from a UAS.
\- An UAV Controller can be removed from a UAS and replaced with another UAV
Controller or a TPAE.
\- It shall be possible for the 3GPP system to identify if the 3GPP
connectivity service (i.e. a PDU Session or a PDN Connection) requested by a
UAV or UAVC will be used for a UAV flight operation or not.
NOTE 1: When a UAV requests 3GPP connectivity service for a flight operation,
the 3GPP system can perform certain UAV procedures, such as, provide
identification and tracking information to UTM, etc.
\- A UAV is assigned, and a networked UAVC may be assigned, a CAA-level UAV
Identity by functions in the aviation domain (e.g. USS) or by functions in the
USS/UTM. This assigned identity is used for Remote Identification and
Tracking.
\- A 3GPP UAV ID is used by the 3GPP system to identify the UAV. GPSI is used
as the 3GPP UAV ID.
\- The 3GPP CN is aware of the CAA-level UAV Identity. A mapping shall be
possible in the mobile operator network and in the UAS application layer
outside of 3GPP between the 3GPP UAV ID and the CAA-level UAV ID.
\- The USS/UTM accesses 3GPP services (e.g. location services) for a UAV
corresponding to the CAA-level UAV Identity by using the 3GPP UAV Identity
(i.e. the GPSI).
\- Consistent identification information for the UAV is used for both
Networked Remote ID and Broadcast Remote ID, based on regulatory requirements
(e.g. [2]), and the UAV identification information used for Networked Remote
ID are assumed to be also applicable for Broadcast Remote ID and to satisfy
the regulatory requirements.
NOTE 2: The study will not define how the solutions defined in Release 17
apply to access technologies outside the scope of 3GPP (e.g. Bluetooth or Wi-
Fi).
\- It is assumed that mechanisms are available to ensure privacy and
protection (e.g. anti-spoofing) of the CAA-assigned UAV Identity when used for
Remote Identification. Security solutions to provide such privacy are outside
the scope of SA WG2 (e.g. in SA WG3\'s scope) and may be outside the scope of
3GPP (e.g. in ASTM\'s scope).
Editor\'s note: Whether security solutions to protect the CAA-Level UAV ID for
privacy and against spoofing are necessary is FFS and should be discussed in
coordination with SA3.
\- For UAV authentication and authorization the following is assumed:
\- The UAV is authenticated at registration with the 3GPP using the existing
UE authentication mechanisms based on MNO credentials
\- A UAV USS-registration takes place between the UAV and the USS/UTM. This
e.g. involves authorization of the UAV and may involve authentication and is
not performed by 3GPP system: it is not the 3GPP system that decides on the
authorization. The results of such procedure may be known to the 3GPP system.
This may be out of band and performed before accessing the 3GPP system. This
is not performed each time the UAV registers with the 3GPP system. This is not
performed on a per-flight basis and may have longer lifetime. However, this
may be part of or follow-on of the 3GPP registration,
authentication/authorization procedures.
\- A UAV authentication/authorization with UTM is triggered by the MNO when
the UAV accesses the 3GPP system. This may be required when the UAV registers
with the 3GPP system or when the UAV request to establish user plane resources
from the 3GPP system for UAV operations. This may be needed to ensure the UAV
has successfully registered with USS/UTM and has been authorized for UAV
operations by USS/UTM. This involves the USS, and it is not the 3GPP system
that decides to authorize the UAV: the 3GPP system receives confirmation of
the authorization from the USS.
\- For networked UAV controllers and non-networked UAV controllers, pairing
between the UAV and the UAV controller for the use of UAV3 or UAV5 may be at
least authorized, or even authenticated. The pairing
authorization/authentication, when performed, is authorized by the USS/UTM,
not by the 3GPP system. The 3GPP system enables such authorization process.
The result of such authorization/authentication are made known to the MNO in
order to enable the USS/UTM to enable the connectivity between the UAV and the
UAV controller.
Editor\'s note: Further work is needed to clarify if the 3GPP system needs to
be aware of of connectivity set-up between UAV and UAV controller.
\- The USS/UTM may indicate to the 3GPP system revocation of UAV3 connectivity
between the UAV and UAV Controller.
NOTE 3: In some scenarios, the UAV to UAV Controller pairing may be
established before the UAV connects to the 3GPP system or even before the UAV
is registered with the USS/UTM. This may be common if UAV8 is used.
\- Flight plan authorization is the responsibility of air traffic control and
is not performed by the 3GPP system. The 3GPP system may support the
authorization of flight plan (i.e. the aviation-level flight plan
authorization that UAV needs to receive from USS/UTM) between the UAV and the
USS/UTM. Support of authorization of flight plan does not imply that the 3GPP
system is involved in authorizing the flight plan (e.g. may provide transport
for exchange of information related to flight plan authorization).
\- The UAV is authorized for connectivity to USS over UAV9 based on existing
MNO policies, and is allowed to establish connectivity with a DNN to exchange
traffic with the USS without USS authorization
\- One or more USS(s) may be present in a specific region and may manage UAVs
over one or more 3GPP networks.
NOTE 4: Region in some geographies may correspond to a country or a set of
countries (e.g. the whole Europe, North America including Canada, USA, and
Mexico, etc.). The inclusions or exclusions of country(ies) to a region is
outside the scope of 3GPP.
\- For this release, it is assumed a UAV is served by the same USS/UTM for the
duration of a flight.
\- The 3GPP system should provide enablers to support geofencing (for in-
flight UAV) and geocaging (for UAV on the ground intending to fly)
functionality in USS/UTM.
NOTE 5: Geofencing mechanisms are an air traffic control functionality
performed by the USS/UTM and are out of scope of this study. The 3GPP system
provides enablers to support geofencing/geocaging functionality in USS/UTM,
e.g. location services, enablement of UAV3/UAV4 for C2 connectivity, event
notification to a subscribing USS/UTM, etc. However, no specific geofencing
mechanisms are defined in 3GPP.
\- Activation of RAN aerial features for UAV accessing via E-UTRA reuses the
existing mechanism defined in TS 36.300 [9].
\- It is assumed that both the UAV and the networked UAV controller in a UAS
are served by the same USS.
NOTE 6: A non-networked UAV controller connected to the UAV via UAV8 is not
identified by the USS separately from the UAV with which it is associated.
\- It is assumed that in this release the UAV uses 3GPP access (i.e. LTE & NR)
for 3GPP UAV related operations.
\- It is assumed that UAV reports the real-time flight information
periodically to USS/UTM via 3GPP network, and the report frequency depends on
geography and regulations(CAAC UAV cloud system data specification [15]).
## 4.3 Reference Architecture
Editor\'s note: This clause describes the reference architecture for this
study.
Figure 4.3-1: Overview of UAV architecture in a 3GPP System.
The architecture considers a Third Party Authorized Entity (TPAE), which is
not part of the UTM functionality.
NOTE 1: There may be a connection between TPAE and UTM/USS which is outside
the scope of 3GPP.
The following reference points are considered:
NOTE 2: for all the reference points below, C2 is an application-level
protocol, and specific solutions for C2 are outside the scope of this TR. The
messaging content of reference points for C2 is out of scope of this TR.
NOTE 3: The semantics (i.e. protocol format and content) of reference points
for remote identification are outside the scope of this study since such
content is defined outside 3GPP. However, the UAV identification information
is part of the study.
\- UAV1: interfaces the UAV and UAVC with the 3GPP system to support UAV and
UAVC authorization, authentication, identification, and tracking.
\- UAV2: interfaces a TPAE with the 3GPP system for remote identification and
tracking.
NOTE 4: The semantics of UAV2 are outside the scope of this study. However,
the UAV identification information is part of the study.
NOTE 5: No assumptions are made as to whether UAV2 is a control plane or user
plane interface.
\- UAV3: 3GPP user plane connectivity for transporting C2. UAV3 can be intra-
PLMN or inter-PLMN.
NOTE 6: C2 is an application-level protocol, and specific solutions for C2 are
outside the scope of this TR. The messaging content of UAV3 is out of scope of
this TR.
\- UAV4: interfaces a TPAE with a UAV over 3GPP network for:
\- Command and control (C2)
\- Remote identification (RID) and tracking of the UAV.
NOTE 7: At any given time, a UAV may be controlled mutually exclusively by an
UAVC, a TPAE, or the UTM. Therefore, C2 to a UAV may be either over UAV3, UAV4
or UAV9.
\- UAV5: like UAV3 for transporting C2 but interfacing a UAV with a non-
networked UAVC via the Internet outside the scope of 3GPP.
\- UAV6: interfaces the 3GPP system with external USS/UTM for functionality
exposure, support of identification and tracking, and UAV authorization.
NOTE 8: No assumptions are made as to whether UAV6 is a control plane or user
plane interface.
\- UAV7: for RID information sent in broadcast (BRID), on a transport outside
the scope of 3GPP.
\- UAV8: UAV8 is used for C2 over a transport outside the scope of 3GPP.
\- UAV9: UAV9 supports connectivity between the UAV or a networked UAV
Controller and the USS/UTM for UAS management, such as authentication and
authorization, transporting C2, networked remote identification (NRID) and
tracking of the UAV, etc.
\- U2U: supports UAV to UAV communications for broadcast RID.
NOTE 9: U2U is outside the scope of this TR.
Editor\'s note: Whether there is additional interface between a TPAE and a UAV
via Internet is FFS.
# 5 Key Issues
Editor\'s note: This clause provides a short description of the key issue.
The following issues will investigate architectural changes to address the
following issues:
Issue 1: UAV identification:
\- What identities are associated to and how are they used by an UAV and/or a
UAV Controller in the 3GPP system, and what identities are exchanged with
parties outside the 3GPP system (e.g. third party authorized entities for UAV
identification) to enable 3GPP system to provide support for UAV
authorization, authentication, identification, and tracking of UAVs
NOTE: UAV identification excludes UAV detection, e.g. by the RAN, and focuses
on the assignment and usage of UAV identities in the 3GPP system.
\- how does the 3GPP system interact with the UTM to enable UAV
identification.
Issue 2: UAV authorization by UTM:
\- how are UAVs authorized for operation in the 3GPP system to enable UAV
tracking and identification once the UAV is authorized for flight by the UTM
Issue 3: UAV Controller identification and authorization/authentication:
\- whether and how UAV Controllers need to be authenticated and authorized as
part of UAS authentication and authorization, UAV Controller and UAV(s)
associated, and UAV Controller to UAV(s) communications authorized:
\- this includes identification and authorization/authentication of UAV pilot,
UAV controller(s), UAV operator.
Issue 4: UAV and UAV Controller tracking:
\- What information is required for the 3GPP system to track the UAV and the
UAV Controller?
Issue 5: UAV authorization revocation and (re)authorization failures:
\- How are UAV handled in the case of failed (re)authorization or revocation
of authorization by the UTM, considering handling of UAV connectivity with UAV
Controller and expected UAV behaviour.
Issue 6: UAV Controller and UAV association:
\- How are an UAV Controller and a (set of) UAV(s) associated and considered a
UAS, e.g. to enable UTM flight mission authorization for the UAS, and to what
extent is the 3GPP system involved in the association?
Issue 7: User Plane Connectivity for UAVs:
\- How UAV(s) and a UAV Controller establish connectivity in the 3GPP system
with the UTM for UAV operation.
# 6 Solutions
Editor\'s note: This clause is intended to document the agreed architecture
solutions. Each solution should clearly describe which of the key issues it
covers and how.
## 6.0 Mapping Solutions to Key Issues
Table 6.0-1: Mapping of Solutions to Key Issues
              Key Issues
* * *
Solutions 1 2 3 4 5 6 7 1 X  
2 X X X X X X X 3 X  
4 X X X X X X X 5 X X X X 6 X X X  
7 X X X  
8 X  
9 X X  
10 X  
11 X  
12 X  
13 X X 14 X  
15 X  
16 X X  
17 X X X  
18 X  
19 X  
20 X  
21 X X 22 X X X  
23 X X X X X 24 X X  
25 X X 26 X X X X 27 X X
## 6.1 Solution 1: Identification of UAVs in a target area
### 6.1.1 Introduction
This solution addresses the key issue #4.
Similar to Solution #13 and Solution #16, this solution is to support
UTM/USS\'s Geofencing need.
Appling Geofencing is an important aspect for UAS management of UTM/USS.
Geofencing areas, particularly as no-fly zones, are defined by aviation
authorities, are areas where the UAV is not allowed to fly in such areas. For
live data acquisition by law enforcement, UTM/USS may query the 3GPP system to
identify whether there are any UAV in the target area. This solution provides
a method for 3GPP network identifying the UAVs in a target area.
### 6.1.2 Functional Description
The solution is based on the UTM definition and UAS model in 3GPP ecosystem as
described in Figure 6.1.1-1, referred from TS 22.125 [5].
_\"Unmanned Aerial System Traffic Management (UTM) is used to provide a number
of services to support UAS and their operations including but not limited to
UAS identification and tracking, authorisation, enforcement, regulation of UAS
operations, and also to store the data required for UAS(s) to operate. It also
allows authorised users (e.g., air traffic control, public safety agencies) to
query the identity and metadata of a UAV and its UAV controller\"._
Figure 6.1.1-1: UAS model in 3GPP ecosystem in TS 22.125 [5]
This procedure allows the UTM to ask for the list of UAV(s) present in the
target area described by the UTM for further processing (e.g., tracking,
statistics). The UTM asks for the authorized UAV(s) that the system knows
within the area. The report that is provided by the network to the UTM shall
include the list of authorized UAV(s) in the target area. The UTM can then
initiate current location procedure defined in TS 23.273 [8] for each UE in
the list, and have a finer granularity information of the target UAV(s).
### 6.1.3 Procedures
This solution applies to both 5GC and EPC. With reference to the procedure, in
the case of EPC, the NEF is replaced by the SCEF and the AMF is replaced by
the MME.
Figure 6.1.2-1: Procedure for UAV Tracking
1\. UE registers to the network and is authorized as a UAV. The UTM might be
involved in the authorization procedure. The authorized information is stored
in the AMF as part of the UE context. The other solutions on UAV
identification and authorization can be used, such as Solution #5 and Solution
#6.
2\. UTM sends subscribed monitoring area to the NEF to subscribe the identity
list of authorized UAV(s) in the target area as a Monitoring Event.
Additionally, the target area information (e.g., list of cells, geographic
area) is included.
3\. NEF identifies the AMF(s) based on the target area information, and
subscribes the event exposure to AMF(s) indicating request for the identity
list of authorized UAV(s) and the associating target area (e.g., list of
cell(s), NG-RAN node(s) and/or TAI(s)).
4\. AMF collects the list of authorized UAV(s) in the target area based on the
authorization information in step 1.
5\. AMF sends the event report to notify UAV presence in area of interest, and
the event report includes the identity list of authorized UAV(s).
NOTE 1: The event report can be an immediate or one-time reporting, periodic
reporting or event based reporting.
NOTE 2: The final decision on used identity depends on the result of KI #1 on
which UE identity is selected for interaction between 3GPP network and
UTM/USS.
6\. The NEF combines the results from all the involved AMF(s), and forwards to
the UTM the list of authorized UAV(s).
7\. After UTM receives the identity list of the authorized UAV(s), it may
initiate the Location Procedure for each UAV in the list as defined in TS
23.273 [8], where the periodic location can be used for tracking each UAV.
### 6.1.4 Impacts on services, entities and interfaces
The solution has impacts in the following entities:
\- AMF/MME:
\- Needs to support the Monitoring Event \"identity list of aerial UEs in the
target area\".
\- Needs to store the UAV related information.
\- Needs to notify the identity list of UAV(s) to NEF.
\- NEF/SCEF:
\- Needs to support the Monitoring Event \"identity list of aerial UEs in the
target area\".
## 6.2 Solution #2: 3GPP reference architecture for UAV remote identification
### 6.2.1 Introduction
This solution addresses the 3GPP reference architecture used by the solutions
of all the key issues for 5GC and for EPC respectively. It includes the
mapping of the network entities and interfaces in the UAV reference
architecture to the 3GPP reference architecture.
Editor\'s note: The 3GPP reference architecture for UAV remote identification
will be updated based on the solutions adopted for each key issue once it is
concluded.
### 6.2.2 Functional Description
#### 6.2.2.1 3GPP reference architecture for UAV remote identification (5GC)
Figure 6.2.2-1: 3GPP reference architecture for UAV remote identification
(5GC)
As shown in Figure 6.2.2-1:
\- UAV/UAVC is considered as an individual UE from the perspective of the 3GPP
system.
\- TPAE is considered as an application server in the Data Network.
Editor\'s note: Whether a TPAE can be considered as an individual UE is FFS.
\- UTM/USS is considered an AF, performing as a Control Plane NF and/or an
application server in the Data Network.
Editor\'s note: Whether the UTM/USS is a DN-AAA is dependent on authentication
and authorization solution.
\- UAV1 is over N1.
\- UAV2 is over N6.
Editor\'s note: Whether a UAV2 can be over N1 is FFS.
\- UAV6 is over N33, N5 and/or N6.
Editor\'s note: How other UAV interfaces are realized in the 3GPP network is
FFS.
#### 6.2.2.2 3GPP reference architecture for UAV remote identification (EPC)
Editor\'s note: The 3GPP EPC reference architecture for UAV remote
identification is TBD.
## 6.3 Solution #3: USS/UTM Discovery
### 6.3.1 Introduction
This solution addresses KI#2 and KI#7.
This solution applies to both 5GC and EPC.
Since there may be multiple USS(s) deployed in the network, and the
association between a UAV and a USS is outside the scope of 3GPP and is not
related to the UAV subscription with the mobile operator, the 3GPP network
shall discover the USS/UTM that is serving a specific UAV, and which can
retrieve the CAA-level authentication/authorization data of the UAV, for the
UAV 3GPP authentication/authorization and for PDU session establishment to the
USS/UTM.
USS/UTM Discovery is applied in the following scenarios:
\- Case 1: UAV 3GPP authentication/authorization at Registration.
\- Case 2: UAV/UAVC authentication/authorization by USS/UTM at PDU session
establishment.
\- Case 3: UAV/UAVC C2 communications pairing authentication/authorization at
PDU session establishment.
### 6.3.2 Functional Description
The solution assumes that a UAV UE may be configured with a serving USS/UTM
address information when the CAA-level registration is successful.
NOTE 1: It is expected that the UAV may be configured with the USS/UTM address
information either at manufacturing time (when the UAS manufactures may also
be the USS), or later as part of the UAV/UAVC registration (e.g. the
preconfigured USS/UTM redirects the UAV to the USS/UTM to use in the area).
How the UAV is configured with or determines the USS/UTM address is out of
scope of 3GPP and may depend on local regulations.
NOTE 2: Discovery and resolution of the USS addressing information depend on
the format of the CAA-Level UAV ID. E.g., according to the ASTM standard [11],
resolution mechanisms defined by ASTM and applied by FAA will be used to
identify the USS corresponding to a CAA-Level UAV ID, and such mechanism do
not use an explicit USS address provided to the UAV. It has to be noted that
such mechanisms are needed e.g. by a TPAE that receives Broadcast Remote ID
and do not receive an USS address by the UAV, and as such cannot rely on the
USS address.
The serving USS/UTM address information, if provided to the UAV, may be a
FQDN. In that case, it shall be resolved by DNS. How the USS/UTM address is
configured in the UAV is outside the scope of 3GPP. The UAV may use a default
PDU sessions for such configuration.
This serving USS/UTM address may be stored in the UAV UE for a long time until
it is updated by the USS/UTM.
For Case 1, UAV UE provides the CAA-Level UAV ID and may be the USS/UTM
address, during the registration process.
For both Case 2 and Case 3, the UAV UE provides the CAA-Level UAV ID and may
provide the USS/UTM address during PDU session establishment request. The SMF
then uses the USS/UTM address received in the PDU session establishment
request from the UAV UE to reach the USS/UTM for secondary authentication. SMF
makes use of DNS resolution if the USS/UTM address is in the form of an FQDN.
SMF includes the CAA-Level UAV ID in the authentication request towards the
USS/UTM.
NOTE 3: The 3GPP system shall be able to verify that the USS/UTM address
provided by the UAV/UAVC UE can be trusted. Security solutions for
verification of the USS/UTM address and establishing trust relationship by
3GPP network shall be covered at SA WG3.
### 6.3.3 Procedures
We could have an abstract call flow as follows:
1: The UAV(C) is preconfigured with USS/UTM address information
2: The UAV(C) establishes a generic PDU Session to contact the UTM/USS, get
registered to an USS/UTM etc...
3: On this PDU Session, the UAV(C) discovers the USS/UTM to use for a given
flight, registers on this USS/UTM, etc. and may get a trusted USS/UTM address
information. This step is out of scope of 3GPP
4: The UAV(C) request to establish a PDU Session to start operating as an UAS.
As it needs to get authorized, it provides the CAA-Level Id and the trusted
USS/UTM address information it may have got from the USS/UTM.
5: Based on local policies associated with the (DNN, S-NSSAI), the SMF
determines that a secondary authentication is needed before establishing the
PDU session; The SMF uses the received trusted USS/UTM address information to
reach the DN-AAA. Otherwise it uses an USS/UTM address determined based on the
(DNN, S-NSSAI). In the latter case it is up to the USS/UTM DN-AAA to forward
the request to the actual USS/UTM based on the CAA-Level Id.
6: Once the secondary authentication is successfully completed by the USS/UTM,
the SMF continues with the PDU session establishment
### 6.3.4 Impacts on services, entities and interfaces
This solution may have the following impacts to existing entities and
interfaces:
\- N1: UE provides the USS/UTM address and CAA-Level UAV ID in the PDU Session
Establishment request.
\- SMF: Retrieves USS/UTM address and the CAA-Level UAV ID from the PDU
session establishment request. If secondary authorization/authentication by an
DN-AAA server during the PDU Session establishment is required, the SMF shall
use the USS/UTM address retrieved from PDU session establishment request as
the DN-AAA address for secondary authentication.
## 6.4 Solution 4: Solution using User plane for UAV identification and
authorization
### 6.4.1 Introduction
This solution addresses the following Key Issues:
#1 UAV identification:
Both the UAV identity and the 3GPP UAV identity are made available to the
UTM/USS.
#2 UAV authorization by UTM:
The solution supplies the UTM/USS with needed information for UAV
Authorization.
#3 UAV Controller identification and authorization/authentication:
The procedure describes the identification and authorization of the UAV, but
the same principle would also be possible to use for the UAV Controller
(UAVC).
#4 UAV and Controller tracking:
The solution enables the UTM/USS to track UE and session related events for
the UAV and UAVC via operator provided network APIs.
#5 UAV authorization revocation and (re)authorization:
The solution enables the UTM/USS to use operator provided network API\'s for
(re) authorization and revocation of the UAV.
#6 UAV Controller and UAV association:
The solution support setting up of an association between UAVC and UAV.
#7 User Plane Connectivity for UAVs.
The solution supports the UAV and UTM/USS to set-up a secure e2e connection.
This solution introduces a simple method for the UTM/USS to authorize a UAV
and set-up a secure connection for Command and Control between UAV and UTM/USS
using the 3GPP network.
The UAV is registered for a service in the UTM/USS and uses a 3GPP network
subscription that allows/enables for the UAV to use the MNO services and
allows the specific UAV to use the specific UTM/USS.
To enable this, both the requesting UAV (HW/SW) and the mobile subscription
used, needs to be authenticated. This way a man in the middle attack can be
prevented and it is secured that the UAV is using a correct network
subscription.
The solution also supports the UTM/USS to interact with the network operator
regarding a specific authorized UAV and UAVC using network APIs independently
on the intermediate network scenario (e.g. if NATs are deployed) and also
prevents the need for the corresponding specific UE ID to be pre-provisioned
in the UTM/USS.
This solution can, for example, be extended to enable abilities to request
specific policies (such as charging and QoS) for certain application dataflows
sent from/to the UAV and abilities for the UAV application to request specific
network related info, for example related to network coverage etc.
This solution is based on UAV Authentication and Authorization over the user
plane and introduces new 3GPP AF, UAS AF. The UAS AF validates that the UAV
has a valid UAV subscription and includes relevant UAV subscription
information and UAV application information to be sent to the UTM/USS to
support the UTM/USS in the Authentication and Authorization of the UAV.
The solution enables both the UAV and UAVC to use a single PDU session (one
for each of the UAV and UAVC) for all services (including support for C2
connections etc.).
The C2 connection over the user plane between the UAV and the UTM/USS does not
go via UAS AF.
Support for key issue #4 UAV and Controller tracking:
The NEF and the SCEF both offer the MonitoringEvent and the AsSessionWithQoS
APIs, which can be used by an application server to track mobility and session
related events for a certain UE.
In order to identify the applicable UE the MonitoringEvent API makes use of a
subscription identifier (GUTI, MSISDN, ExternalId) and in order to identify
the applicable PDU-session/PDN-connection the AsSessionWithQoS API makes use
of the corresponding UE IP-address as visible in the core network.
If there is a NAT deployed in between the UE IP address as seen by the
application server will be different than the one used in the core network and
will not be useful for session identification by the API. By the UAS-AF
including information in the Request for UAV A&A sent to the UTM/USS (step 6
in fig 6.4.2.1-1 and step 5 in fig 6.4.2.2-1) about the applicable
subscription identity and UE IP address as seen from the core network the
UTM/USS will be able to directly call the above mentioned NEF API\'s for UAV
and UAVC tracking purposes.
Support for key issue #5 UAV authorization revocation and (re)authorization:
The NEF and the SCEF both offer the AsSessionWithQoS API which can be used by
an application server to activate, modify and revoke policies for specific
data flows on a specific PDU-session/PDN-connection.
In analogy with what above is described for Key issue #4 the UAS-AF can
provide the UTM/USS with the information needed to use this API for
(re)authorization and revocation of data flows used e.g. for C2 communication.
Potential ways of achieving this are:
1). At PDU-session activation, all traffic except to the UAS-AF will be
blocked. This can e.g. be handled using predefined PCC-rules with gate closed.
2). When the USS has authorized the UAV it will, using the UE-IP-address
received from the UAS-AF in the AA-request, request authorization of traffic
between the UAV and the USS via the NEF/SCEF before returning the AA-response.
3). If there is a separate UAVC that controls the UAV, authorize the C2
connection between that UAVC and the UAV via the NEF/SCEF when they have been
paired. If already paired during UAV authorization this can be done with step
2).
4). Authorization for other application level services that shall be allowed
from the UAV. This can be triggered from the USS via the NEF/SCEF possibly
already in step 2), if allowed access can be determined then or later, if
enabled by some other trigger.
### 6.4.2 Procedure
Figure 6.4.2.1-1 shows a 5GC high-level procedure for UP-based UAV
Authentication and Authorization and in figure 6.4.2.2-1 the same principle is
shown for an EPC solution. The main difference is that in the EPC solution
relevant subscription parameters are added to the Authentication and
Authorization request via predefined PCC rules with header enrichments by the
PGW as the UAS AF cannot get access to this information in the EPC case.
#### 6.4.2.1 Procedure for 5GS
Figure 6.4.2.1-1: 5GC UAV Authentication and Authorization
1\. The UAV performs a Registration to the network.
2\. The UAV triggers a PDU Session Establishment.
3\. The UAV triggers request for UAV Operation (C2).
4\. UAV sends request for authentication and authorization to the UAS AF over
the user plane, e.g. including UAV identity, UAV application identity, UTM/USS
identity (if available), etc.
NOTE 1: The UAS AF can be reached using a URL belonging to the domain of the
MNO from which the destination IP typically is retrieved by the client via
DNS. Then traffic going to the UAS AF can be detected by UPF (e.g. Packet
routing & forwarding, Packet inspection, User Plane part of policy rule
enforcement etc.) using preconfigured IP or hostname (IP may be retrieved from
DNS using the hostname). Specific policies (e.g. allow/block) can under
control of the PCF be applied to the matching traffic based on subscription
date (UAV, UAVC, neither).
5\. The UAS AF can get the relevant subscription information from PCF or UDM
with support from existing BSF functionality.
6\. UAS AF checks if the UAV has a valid aerial subscription based on the
subscription information received from PCF or UDM. If the check is successful,
the UAS AF based on the UAV information, determines the UTM/USS serving the
UAV and triggers A&A request towards the UTM/USS. The UAV may provide a
UTM/USS identity as part of the request (see step 4) and the UAS AF stores a
predefined list with valid UTM/USS identities including URLs to corresponding
requests.\ The UAS AF can include information to the UTM/USS needed for
further interaction between UTM/USS and 5GS regarding the PDU session using
network APIs e.g. for requesting dedicated policies, see clause 6.4.2.3,
monitoring, reauthorization etc.
The request can contain an indication about the used mobile operator and 3GPP
UAV identity. Additionally, it forwards also the UAV specific information
received in the UAV request e.g. using HTTPS POST.
If the check is un-successful a response is sent to the UAV rejecting the
request.
NOTE 2: To handle a very specific use case with the combination of roaming and
LBO were the visited PCF will not have access to the home PCF two alternatives
can be seen. First option is one requiring some additional standard work where
the visited PCF on request from UAS AF retrieves the aerial subscription
information from the AMF using existing interfaces (N5/T8 and N15). Second
option is not requiring any additional standard work and is based on the
knowledge that the UE is configured with a well-known DNN/APN for UAV
operation and the subscription info (VPLMN Address Allowed) allowing the same
DNN/APN to be used in a roaming case. In this second solution the information
about aerial subscription is not needed.
7\. UTM/UTS checks the request for UAV operation from the UAS AF using the
combined information from the UAV and from the UAVs mobile network operator.
NOTE 3: The UAV information sent to the UTM/USS via the UAS AF is handled in
the user plane and on application level. How the UTM/USS verifies the UAV
information is done purely on the application level and out of 3GPP scope.
The UAS operator may have already provided flight path information to the
UTM/USS with a procedure which is out of scope of 3GPP.
8\. If the result of the check in step 6 is successful, UTM/USS triggers an
accept response to the UAS AF. The response can include UAV application
specific information which may e.g. include a token to be included for
authentication reasons in succeeding application content interactions.
If the check is un-successful a response is sent to the UAS AF rejecting the
request.9. The UAS AF forwards the response from the UTM/USS to the UAV as a
response to the request in step 4.
10\. UAV triggers a set-up of a secure connection to UTM/USS e.g. using the
token received in step 9.
NOTE 4: As an example, secure web-socket, gRPC, etc. can be used to establish
a secure connection which is outside the scope of 3GPP.
11\. After step 9 UAV Operation can be handled over the secure connection
between UAV and UTM/USS.
#### 6.4.2.2 Procedure for EPS
Figure 6.4.2.2-1: EPC UAV Authentication and Authorization
1\. The UAV performs an Attach and a PDN connection activation. As the UAV has
a subscription indicating UAV capability the PCRF generates a PCC rule
indicating UAV application and header enrichment policy.
2\. The UAV triggers request for UAV Operation (C2).
3\. UAV sends a request for UAV authentication and authorization to the UAS AF
which can be e.g. a HTTP POST including application identity, UAV identity,
etc.
4\. PGW detects the UAV application traffic and triggers e.g. header
enrichment and adds UAV subscription information.
NOTE 1: The UAS AF can be reached using a URL belonging to the domain of the
MNO from which the destination IP typically is retrieved by the client via
DNS. Then traffic going to the UAS AF can be detected by PCEF/DPI using
preconfigured IP or hostname (IP may be retrieved from DNS using the
hostname). Specific policies (e.g. allow/block) can under control of the PCRF
be applied to the matching traffic based on subscription date (UAV, UAVC,
neither).
NOTE 2: If TLS is used and header enrichment shall be performed, an
alternative is to integrate a HTTP(S) proxy functionality in the PGW. Since
the UAS-AF is in the MNO\'s domain it should be possible to provision the
corresponding certificate to the PGW. This would enable the PGW to terminate
TLS for HTTPS-requests destined to the UAS-AF and then apply header-enrichment
on the unencrypted request before forwarding them to the UAS-AF.
In the case of roaming the certificate is managed by the visited MNO and the
certificate needs to be verified by the UAV UE which is not possible without
specific solution. As this part of the solution is only for the specific case
of EPC it is assumed it can either be limited to non-roaming use or where
implicit trust can be assumed. The latter is out of 3GPP scope.
5\. UAS AF checks if the UAV has a valid aerial subscription based on the
subscription information received from the PGW.
If the check is successful, the UAS AF based on the application identity,
looks up the corresponding UAV application URL and triggers a request towards
the UTM/USS e.g. using HTTPS POST. If the check is unsuccessful a response is
sent to the UAV rejecting the request. The UAS AF can include information to
the UTM/USS needed for further interaction between UTM/USS using network APIs
and EPS regarding the PDU session, e.g. for requesting dedicated policies, see
clause 6.4.2.3, monitoring, etc.
6\. UTM/UTS checks the request for UAV operation from the UAV.
NOTE 3: The UAV information sent to the UTM/USS via the UAS AF is handled in
the user plane and on application level. How the UTM/USS verifies the UAV
information is done purely on the application level and out of 3GPP scope.
7\. If the check in step 6 is successful, UTM/USS triggers a accept response
to UAS AF acknowledging the request including an application specific
information. This information may e.g. include a token to be included for use
in succeeding application content interactions.
If the check is un-successful a response is sent to the UAV rejecting the
request.
8\. The UAS AF sends the response the UAV.
9\. UAV triggers a set-up of a secure connection to UTM/USS e.g. using the
token received in step 8.
10\. After step 9 UAV Operation can be handled over the secure connection
between UAV and UTM/USS.
Instead of a PGW, SMF/PGW/UPF can be used to the above EPS based solution for
UAV Authentication and Authorization is to use the 5GC/EPC Interworking
Architecture which is shown in the below figure 6.4.2.2-2. Such a solution
will in principle have the same functionality as the 5GS solution in clause
6.4.2.1. and will support UAV mobility between EPS and 5GS.
Figure 6.4.2.2-2 5GC/EPC Interworking Arch UAV Authentication and
Authorization
1\. The UAV performs an Attach and a PDN connection activation. As the UAV has
a subscription indicating UAV capability the PCF generates a PCC rule
indicating UAV application and header enrichment policy.
2\. The UAV triggers request for UAV Operation (C2).
3\. UAV sends request for authentication and authorization to the UAS AF over
the user plane, e.g. including UAV identity, UAV application identity, UTM/USS
identity (if available), etc.
NOTE 4: The UAS AF can be reached using a URL belonging to the domain of the
MNO from which the destination IP typically is retrieved by the client via
DNS. Then traffic going to the UAS AF can be detected by UPF (e.g. Packet
routing & forwarding, Packet inspection, User Plane part of policy rule
enforcement etc.) using preconfigured IP or hostname (IP may be retrieved from
DNS using the hostname). Specific policies (e.g. allow/block) can under
control of the PCF be applied to the matching traffic based on subscription
date (UAV, UAVC, neither).
4\. The UAS AF can get the relevant subscription information from PCF or
UDM/HSS with support from existing BSF functionality.
5\. UAS AF checks if the UAV has a valid aerial subscription based on the
subscription information received from PCF or UDM/HSS. If the check is
successful, the UAS AF based on the UAV information, determines the UTM/USS
serving the UAV and triggers A&A request towards the UTM/USS. The UAV may
provide a UTM/USS identity as part of the request (see step 3) and the UAS AF
stores a predefined list with valid UTM/USS identities including URLs to
corresponding requests.\ The UAS AF can include information to the UTM/USS
needed for further interaction between UTM/USS and EPS/5GS regarding the PDU
session using network APIs e.g. for requesting dedicated policies, see clause
6.4.2.3, monitoring, reauthorization etc.
The request can contain an indication about the used mobile operator and 3GPP
UAV identity. Additionally, it forwards also the UAV specific information
received in the UAV request e.g. using HTTPS POST.
If the check is un-successful a response is sent to the UAV rejecting the
request.
6\. UTM/UTS checks the request for UAV operation from the UAS AF using the
combined information from the UAV and from the UAVs mobile network operator.
NOTE 5: The UAV information sent to the UTM/USS via the UAS AF is handled in
the user plane and on application level. How the UTM/USS verifies the UAV
information is done purely on the application level and out of 3GPP scope.
The UAS operator may have already provided flight path information to the
UTM/USS with a procedure which is out of scope of 3GPP.
7\. If the result of the check in step 6 is successful, UTM/USS triggers an
accept response to the UAS AF. The response can include UAV application
specific information which may e.g. include a token to be included for
authentication reasons in succeeding application content interactions.
If the check is un-successful a response is sent to the UAS AF rejecting the
request.
8\. The UAS AF forwards the response from the UTM/USS to the UAV as a response
to the request in step 3.
9\. UAV triggers a set-up of a secure connection to UTM/USS e.g. using the
token received in step 8.
NOTE 6: As an example, secure web-socket, gRPC, etc. can be used to establish
a secure connection which is outside the scope of 3GPP.
10\. After step 9 UAV Operation can be handled over the secure connection
between UAV and UTM/USS.
#### 6.4.2.3 Procedure for UAVC and UAV Association
Below procedure shows how an association is set-up between the UAV and UAVC
including setting up policies requested by USS/UTM for C2. This principle can
also be used to set-up user plane for C2 between UAV and USS.
Figure 6.4.2.3-1 UAV and UAVC Association
In figure 6.4.2.3-1 the procedure is shown as both UAV and UAVC would be
registered with the same operator. If the UAV and UAVC are registered with
different operators\' steps 1a), 1b) and steps 3) to 6) will be performed in
respective operators\' network.
1a. UAV performs registration, A&A and set-up a secure connection between UAV
and UTM/USS, see clauses 6.4.2.1 and 6.4.2.2.
1b. UAVC performs registration, A&A and set-up a secure connection between UAV
and UTM/USS, see clauses 6.4.2.1 and 6.4.2.2.
2\. UAS or UTM/USS request a set-up of an association for C2 between UAV and
UAVC which is handled over the secure connection established in step 1a and 1b
i.e. handled over the user plane in the application layer and out of 3GPP
scope. Step 2 may include multiple interactions between the USS and the
UAV/UAVC and may continue also after steps 3-5 in figure so that the USS can
acknowledge a successful \"pairing\" after the policy has been successfully
applied in the user-plane.
3\. The UTM/USS sends a request for dedicated policy for the C2 communication
to NEF, see step 2. The 5GC/EPC can in the \"Request A&A for UAV Control\"
(see step 6 in clause 6.4.2.1 and step 5 in clause 6.4.2.2) include
information (e.g. IP address, GPSI etc.) to UTM/USS for further interaction
with the 5GC/EPC using network APIs. The UTM/USS can than directly via NEF
request specific policies using existing functionality via N33.
4\. The policy requested by UTM/USS is set-up by the CN.
5\. The NEF sends a response to the UTM/USS for the policy request.
6\. The user plane is set-up with requested policies for C2 between UAV and
UAVC.
### 6.4.3 Impacts on services, entities and interfaces
The solution has the following impacts on existing entities:
\- UDM/HSS:
\- Additional subscription information related to the UAV.
\- AMF/PCF:
\- Handle subscription information for UAV.
\- Handling of subscription request from UAS AF via PCF.
\- new AF added for providing 3GPP UAS related function.
## 6.5 Solution #5: UAV authentication and authorization by USS/UTM based on
NAS supplementary and secondary authentication and authorization procedures
### 6.5.1 Introduction
This solution addresses Key Issue #1, #2, #3, #5, #6, and #7.
This solution is applicable to EPC and 5GS.
This solution enables a:
\- USS UAV Authorization/Authentication (UUAA) to ensure the UAV has
successfully registered with USS/UTM and has therefore been authorized for
operations by USS/UTM.
NOTE: The same functionality can be applied to a networked UAV Controller.
\- Authorization of UAV and networked UAV controller pairing.
\- Flight path authorization/registration for flight operation.
### 6.5.2 Functional Description
#### 6.5.2.1 Assumptions
The USS/UTM assigns a CAA-level UAV ID for the UAV at the time of registration
with the USS to be able to identify itself to the USS/UTM. The registration
procedure may be carried out offline at the application layer (with a
procedure which is out of scope of SA WG2) or via the UFES if supported by the
3GPP network.
The CAA-level UAV ID is assumed to uniquely identify the UAV at least within
the scope of the USS/UTM (e.g. country of operation of the USS/UTM) to enable
the CAA-level UAV ID correlation to UAV registration data with the USS by
authorized Remote ID clients. The CAA-level UAV ID may also identify the
assigning USS/UTM where it is listed. Based on local regulations, the CAA-
level UAV ID may be static (e.g., serial number) or dynamic (e.g., session
id). However, a consistent format for CAA-level UAV ID (either static or
dynamic) is assumed when sent to the Remote ID USS or when broadcasted.
NOTE 1: The format of the CAA-level UAV ID is defined outside 3GPP, and
multiple formats may need to be supported depending on geography and
regulations (e.g. ANSI Serial Number, a Session ID, etc.).
NOTE 2: The provisioning of credentials between the USS/UTM and the UAV, if
any, will be defined depending on the security solution selected for the UAV
registration with USS/UTM and for protecting the CAA-Level UAV ID.
Editor\'s note: Whether security credentials are also assigned with the CAA-
level UAV ID or not is to be defined in SA WG3 or outside 3GPP.
It is assumed that the UE is assigned an External Identifier as 3GPP UAV ID,
to be used for aerial operations as part of the Generic Public Subscription
Identifier (GPSI), as described in clause 5.9.8 of TS 23.501 [12] and defined
in TS 23.003 [14]. The External Identifier is used for interaction with
external functions such as the USS; the USS/UTM uses the External Identifier
to identify the UAV when requesting services from the 3GPP system. The
External Identifier is allocated by the MNO without any knowledge of which
USS/UTM the UAS will use, in order to support independence of the MNO
subscription from the UAS operator subscription to a USS/UTM. The 3GPP UAV ID
is assigned by the mobile network without any interactions with the USS/UTM,
and does not need to be known a priori to the USS/UTM via any agreement
between the USS/UTM and the 3GPP operator.
NOTE 3: It is assumed that an MSISDN is not used as GPSI for the subscription
corresponding to the UAV.
Both the scenario where the USS/UTM has a-priori relationship with the MNO and
assigns the External Identifier corresponding to the SUPI, and the scenario
where the USS/UTM is chosen dynamically without any a-priori association
between the USS/UTM and the MNO must be supported. In the second case, the MNO
is expected to assign External Identifiers for each aerial subscription
according to an MNO specific mechanism, and such External Identifiers are
expected to be communicated to the USS/UTM during the interaction between the
UAV and the USS/UTM or between the MNO and the USS/UTM, as described below. We
cannot assume the External Identifier is known to the USS/UTM, since the
USS/UTM is not part of assigning the External Identifier for a UAV
subscription and we cannot assume a close relationship between the MNO and the
USS/UTM.
A UAV Flight Enablement Subsystem (UFES) is used in the 3GPP system. The role
of the UFES is to provide a single interface to the USS/UTM, thus limiting the
impacts to the 3GPP system. Principally, the UFES performs the USS/UTM
selection without requiring 3GPP network nodes (e.g. AMF, SMF in 5GC, or PGW
in EPC) to implement such USS/UTM discovery mechanisms. The UFES supports
delivery of the UAV External Identifier as 3GPP UAV ID to the USS/UTM, and can
retrieve relevant subscription information from UDM and/or receive policy
control information by the PCF. USS/UTM selection by the UFES is based on the
CAA-Level UAV ID, as described in clause 6.5.2.3, and neither on UDM
subscription information nor PCC policy.
Multiple UFES may be deployed in the network, and it is assumed that any UFES
can interface with any USS/UTM in the country of the PLMN. Control plane NFs
(e.g. AMF, SMF) may utilize the NRF to discover UFES instance(s) unless NEF
information is available by other means, e.g. locally configured in UFES
consumers. The following factors may be considered for UFES selection:
S-NSSAI(s), 3GPP UAV ID, etc.
Editor\'s note: The UFES is logical function that may be collocated with other
NF in the 3GPP core (e.g. NEF, SMF).
Editor\'s note: Whether the functionality of UFES is a standalone NF or part
of NEF is FFS.
#### 6.5.2.2 Overview of the Solution
In order to address the various aspects of authentication and authorization of
UAS in the 3GPP system, the solution introduces the following building blocks:
1\. UAS operator (i.e. the owner of the UAS) performs a procedure to register
the UAS with the UTM/USS. 3GPP does not focus on the detail of this procedure.
It is assumed that the registrant provides aviation-level information (e.g.
UAV Serial Number, pilot information, UAS operator, etc.), whose content is
dependent on the CAA and specific geography. This procedure may happen offline
or via 3GPP Internet connectivity. During this step, the UAV is assigned a
CAA-Level UAV ID. USS may or may not be involved.
2\. UAS operator may perform a procedure to request a flight authorization for
a UAV with a UTM/USS. This procedure is out of scope of SA2.
3\. UE primary authentication: the UAV is authenticated by the 3GPP system
using the MNO credentials.
4\. USS UAV Authorization/Authentication (UUAA):
\- a UAV 3GPP authentication/authorization may be performed by the CN when a
UAV that has performed point 1 accesses the 3GPP system, after point 1 and 2
above are executed, in order to ensure the UAV has successfully registered
with USS/UTM and has therefore been authorized for operations by USS/UTM.
\- The UUAA is triggered by the 3GPP CN based on subscription, local policies,
and the information provided by the UAV (as described in the description of
the procedures), or the request of UAV re-authorization/re-authentication is
received from UTM. The final decision to authorize the UAV is made by the
USS/UTM, and the CN receives confirmation of the authorization from USS/UTM.
\- If the UUAA fails, the network may keep the UAV registered in the 3GPP
system, or perform a de-registration procedure to deregister it, based on the
network policy.
\- If the network keeps the UAV registered, the network should not allow the
UAV to establish connectivity for any DNN/APN associated with UAVs services
(e.g. for UAV-USS connectivity of for C2 connectivity between a UAV and a
UAVC) until the UTM triggered UAV re-authorization/re-authentication is
success.
\- If the 3GPP CN keeps the UAV registered to the 3GPP system, the indication
of UUAA failure will be indicated back to UAV by the 3GPP CN. If the 3GPP CN
is to deregister the UAV, the reason for de-registering the UAV is made known
to the UAV.
5\. Authorization of UAV and networked UAV controller pairing: the pairing
between the UAV and the networked UAV controller for the use of UAV3 may be at
least authorized, or even authenticated, by the USS/UTM, and not by the 3GPP
system. The authorization/authentication is between the UAV and the USS/UTM,
however the results are made known to the CN in order to enable the USS/UTM to
enable the connectivity between the UAV and the UAV networked controller.
The solution supports both the scenario where a single PDU session/PDN
connection is used both UAV-USS/UTM communications and for C2 with networked
UAV controller and other payloads (e.g. C2 related telemetry), and the
scenario where different PDU sessions/PDN connections are used respectively
for UAV-USS/UTM traffic and for C2 with networked UAV controller and other
payloads (e.g. C2 related telemetry). It is assumed that the decision to use a
single PDU session or multiple is a mobile operator decision:
\- In the case of single PDU session, the solution assumes that no additional
authorization is required for the PDU session that enables UAV-USS/UTM
communications not related to C2, as described in the working assumption. When
the PDU session is used for UAV operations (i.e. C2 between a UAV and a
networked UAV controller and/or flight authorization request), then the PDU
session is authorized by the USS/UTM and appropriate traffic filters are
installed to enable C2 communication between UAV-C and UAV (these filters may
be provided directly by the USS via the UFES in the authorization procedure,
or provided by USS to PCF via UFES using network exposure mechanisms); de-
authorization of the pairing results in blocking the traffic between the UAV
and the current networked UAV controller (e.g. the USS may insert another
UAVC, as described in other solutions);
\- in the case of separate PDU sessions, the PDU session for UAV-USS/UTM
traffic enables UAV-USS/UTM communications to exchange traffic not related to
C2 without any specific authorization procedure, as described in the working
assumption. The establishment of the PDU session for C2 with the networked UAV
controller, and other payload (e.g. C2 telemetry), is performed every time a
new pairing of UAV and network UAV controller needs to be performed (e.g.
pairing has changed) or every time a flight authorization is required, or the
establishment of C2 user plane resources need to be authorized, and it is
authorized by the USS/UTM as part of the pairing authorization, and
appropriate traffic filters are installed to enable such traffic in the case
of successful authorization (these filters may be provided directly by the
USS/UTM via the UFES in the authorization procedure, or provided by USS/UTM to
PCF via UFES using network exposure mechanisms); de-authorization of the
pairing results in blocking the traffic between the UAV and the networked UAV
controller, and may trigger the release of the PDU session used for C2.
NOTE 1: the details of the UAV and networked UAV controller pairing depend on
work done in the regulatory framework, in particular with respect to whether a
networked UAV controller is assumed to be identifiable separately from the
associated UAV in terms of identifiers handled by the UTM and CAA. In this
solution we assume that the UAV and the networked UAV controller have mutual
knowledge of identities and/or addresses, depending on how the regulatory
framework will define their pairing.
NOTE 2: this solution does not consider the scenario of pairing between a UAV
and a non-network UAV controller which communicate using N8, since in such
case the assumption is that the pairing takes place independently of the 3GPP
system and in most cases it is static.
The authorization of UAV and networked UAV controller pairing is performed for
the purpose of matching a networked UAV controller with a UAV. During this
procedure, the UAV (respectively the networked UAV controller) can provide the
information necessary to identify the networked UAV controller (respectively
the UAV) to which it is to be paired. As a result of the authorized pairing,
the USS/UTM provides to the 5GS with the authorized UAV and networked UAV
controller pairing information according to the solutions defined in 6.5.3.1
and 6.5.3.2) in the case of successful authorization, or information that
indicates the authorization of UAV and networked UAV controller pairing has
failed.
If the pairing authorization is successful, the UAV or UAV-C may establish a
dedicated UP connectivity for C2 communication (e.g. either new QoS flows in
an existing PDU session/PDN connection or a separate PDU session/PDN
connection) between the UAV and the networked UAV-C.
If the pairing authorization fails, the establishment of UP connectivity for
C2 communication between the UAV and networked UAV-C is not allowed. If there
is the existing UP connectivity for communication with the USS/UTM, this
remains in use for communication with the USS/UTM only.
If the pairing authorization fails, it is expected that an indication is
provided by the USS/UTM to the UAV so that the UAV is informed of the cause of
failure of establishment of connectivity for user plane connectivity for C2.
This indication is at application layer and is passed transparently between
the USS/UTM and the UAV.
5\. Authorization for establishment of user plane resource: the USS/UTM
verifies any information the UAV may provide (e.g. flight related information
), authorizes the request, and may interact with the 3GPP system to e.g.
request the UAV location or subscribe to UAV location reporting. During this
operation, the USS/UTM can interact with CN to provide information via
SCEF/NEF. This step is also carried out when a UAV is controlled by a non-
network UAV controller. In such a case the UAV includes in the user plane
establishment request an indication associated to the flight operation (i.e.
flight authorization request, Flight Authorization ID, etc.).
If authorization for establishment of user plane resource fails, the
establishment of UP connectivity for C2 communication between the UAV and
networked UAV-C is not allowed. If there is the existing UP connectivity for
communication with the USS/UTM, this remains in use for communication with the
USS/UTM only.
If the authorization for establishment of user plane resource fails, it is
expected that an indication is provided by the USS/UTM to the UAV so that the
UAV is informed of the cause of failure of establishment of connectivity for
user plane connectivity for C2. This indication is at application layer and is
passed transparently between the USS/UTM and the UAV.
Building block 1 is executed in the same way for EPS and 5GS. Building block 2
is executed using existing EPS or 5GS mechanisms.
#### 6.5.2.3 USS Discovery
In the geography of a 3GPP network there may be multiple USS/UTM (s) serving
UASs, and no direct association is expected between the 3GPP network serving a
UAS and the USS/UTM providing services to the UAS. The association between a
UAV and a USS/UTM is outside the scope of SA2 and is not related to the UAV
subscription with the mobile operator. Therefore, in order to enable the
interaction between the 3GPP network and the USS/UTM serving a UAS, the 3GPP
network needs to discover the correct USS/UTM serving a specific UAV. This is
required at UUAA during the registration, at the authorization of UAV and
networked UAV controller pairing, and at the authorization for establishment
of user plane resources.
Two scenarios are assumed:
\- Scenario 1: the UAV may be configured with a USS/UTM address information
when the registration between the UAV and the USS/UTM is successful. In this
scenario, the UAV may be configured with mechanisms outside the scope of 3GPP
with address information of the USS/UTM. The USS/UTM address information may
be a FQDN, which shall be resolved by DNS. This serving USS/UTM address may be
stored in the UAV UE for a long time until it is updated by the USS/UTM.
\- Scenario 2: the USS/UTM address can be derived directly from the CAA-Level
UAV ID. In such scenario, since the CAA-Level UAV ID is assigned by an USS/UTM
according to mechanisms and formats defined in other standards, e.g. ASTM
F3411 -- 19 [11], then the CAA-Level UAV ID resolution shall be based on
mechanism and network infrastructure solutions defined outside of 3GPP, and
the network elements selecting the USS shall implement such mechanisms.
Since the detailed format of the CAA-Level UAV ID is outside the scope of
3GPP, the solution proposes that the UAV is capable of providing either the
CAA-Level UAV ID only during the UUAA procedure and in the PDU session/PDN
connection establishment procedures (scenario 2), or both the USS/UTM address
information and the CAA-Level UAV ID (scenario 1) when the UAV is configured
with both.
In this solution, for interactions between the 3GPP networks and the USS/UTM
via the UFES, the UFES performs the USS discovery based on the information
described above.
#### 6.5.2.4 Applicability to 5GS
For 5GS:
\- The procedure for UUAA is performed during the Registration Procedure and
is similar to the NSSAA procedure. Following a Registration Procedure with a
successful primary authentication, the AMF determines the subscription is for
an UAV and, based on local policies and possibly the result of previous UUAA
procedures, and based on the information provided by the UAV, it determines
that UUAA is required and indicates to the UAV that there is pending UUAA. The
CN then triggers the UUAA with the USS/UTM. UUAA uses credentials obtained by
the UAV during registration with the CAA and/or the USS/UTM, and include the
CAA-Level UAV ID assigned to the UAV during such registration.
\- Authorization of UAV and networked UAV controller pairing and flight path
authorization/registration for flight operation: these may take place during
PDU Session Establishment for UAV3/UAV5 connectivity and may be based either
on the PDU Session authentication and authorization mechanism already defined
for PDU Session Establishment, or the use of service-based mechanisms with the
USS via the UFES. The UAV uses the same credentials provided in the UUAA.
#### 6.5.2.5 Applicability to EPC
For EPC:
\- a dedicated APN is used for UAVs connectivity to USS/UTM and to support
UAV3/UAV5 connectivity. Connectivity for aerial traffic is not allowed over
other PDN connections
\- It is assumed that the PDN GW is configured with pre-defined PCC rules
which enable the PDN GW to provide additional information with header
enrichments, and convey at least the 3GPP UAV ID.
\- When a single PDN connection is used for UAS services (i.e. both for UAV-
USS/UTM communications and for C2), the UUAA, Authorization of UAV and
networked UAV controller pairing, Flight path authorization/registration for
flight operation, , and authorization to establish user plane resources for
C2, when performed, take place during the PDN Connection Establishment.
Establishment of such PDN Connection is always authorized for a UAV with
aerial subscription by using PCO-based mechanisms and NAS transport. This may
include a single procedure where the UAV sends information to the USS/UTM in
PCO and receives a response from USS/UTM in PCO, or by using a more complex
PCO transport similarly to how \"secondary authentication/authorization by a
DNN-AAA server during PDN connection establishment\" is supported in EPC. This
does not imply that EAP authentication is used, since it depends on the
security mechanisms defined at \"application\" level for UAV-USS/UTM security
and to secure the CAA-level UAV ID, which are out of scope of SA WG2.
\- if multiple PDN connections are used for UAS services (i.e. one for UAV-
USS/UTM communications and a separate PDU session for C2), the UUAA is
performed during the Attach Procedure, whereas Authorization of UAV and
networked UAV controller pairing, Flight path authorization/registration for
flight operation, and authorization to establish user plane resources for C2,
when performed, take place during the PDN Connection Establishment for the PDU
Session for C2. In both cases, PCO-based mechanisms and NAS transport are
used. This may include a single procedure where the UAV sends information to
the USS/UTM in PCO and receives a response from USS/UTM in PCO, or by using a
more complex PCO transport similarly to how \"secondary
authentication/authorization by a DNN-AAA server during PDN connection
establishment\" is supported in EPC. This does not imply that EAP
authentication is used, since it depends on the security mechanisms defined at
\"application\" level for UAV-USS/UTM security and to secure the CAA-level UAV
ID, which are out of scope of SA WG2.
For the support of multiple PDN connections, it is assumed that the 3GPP
operator defines which APNs correspond to the PDN connection for UAV-USS/UTM
connectivity, and which one for C2 connectivity; it is also assumed that the
UAV can map the appropriate traffic to the different APNs.
\- The authorization is performed between the UAV and the USS/UTM as in the
5GS case.
\- If UUAA fails, then the PDN connection is not established during the Attach
procedure; the 3GPP system may detach the UAV, or may allow the UAV to remain
attached with only SMS service, depending on network policies.
\- In case of single PDN connection, if Authorization of UAV and networked UAV
controller pairing, Flight path authorization/registration for flight
operation, or and authorization to establish user plane resources for C2 fail,
then the PDN connection is establish but only traffic between the UAV and the
USS/UTM is allowed.
\- In case of multiple PDN connection, if Authorization of UAV and networked
UAV controller pairing, Flight path authorization/registration for flight
operation, or and authorization to establish user plane resources for C2 fail
during the establishment of the PDN connection for C2, then the PDN connection
is not established.
\- Authorization of UAV and networked UAV controller pairing and Flight path
authorization/registration for flight operation are also performed between the
UAV and the USS/UTM via PCO communications.
\- PCO is extended to enable the UE to carry the information for UUAA,
Authorization of UAV and UAV controller pairing, and Flight path
authorization/registration for flight operation between the UAV and the
networked UAV controller.
Though the solution suggests the use of default APN and DNN for UAV services,
the solution does not advocate but does not oppose the use of specific well-
known APN/DNN for UAV services. The solution addresses both UAVs that are UE
using only UAV services, and UAVs that may support other type of data network
connectivity for other services.
### 6.5.3 Procedures
#### 6.5.3.1 5GS Procedures
##### 6.5.3.1.1 5GS Procedure For Authentication/Authorization
The procedure for UAV Authentication and Authorization by USS in the 5GS case
is depicted in Figure 6.5.3-1.
The description of the procedure is split in two parts.
**PART 1:**
Figure 6.5.3-1: Procedure for UAV Authentication and Authorization with
USS/UTM in 5GS -- Part 1
1\. [Outside the scope of SA WG2] [Optional, may be performed over 3GPP
connectivity] A registration is performed for the UAV by the UAS operator. The
USS/UTM is informed of the UAV being registered (procedure out of scope of
3GPP, details defined outside 3GPP). UAS operator provides UAV\'s aviation-
level information, e.g. UAV identification (serial number of the UAV), Pilot
information, UAS make and model number, etc. Details may change depending on
the USS/UTM and CAA. UAV is assigned a CAA-level UAV ID. The procedure can be
carried out over 3GPP user plane connectivity.
NOTE 1: It is assumed that the CAA-level UAV ID can be resolved to an address
of the USS serving the UAV (e.g. DNS lookup, or other resolution mechanisms
defined outside 3GPP, as in the case of the ASTM standard).
2\. [Outside the scope of SA WG2] [Optional] UAS operator request a flight
path authorization/registration for flight for a UAV with USS/UTM (procedure
is out of scope of 3GPP). UAS operator provides CAA-level UAV ID and e.g.
flight Information, altitude, time of flight. Details change depending on USS
and CAA. USS/UTM optionally assigned a Flight Authorisation ID for the
authorised flight. The format of the Flight Authorization ID is defined
outside 3GPP. This step may be performed offline or via 3GPP user plane
connectivity. The request for flight path authorization may be also carried
out in step 8 (Authorisation for UAV operation - Option 1) or step 12
(Authorisation for UAV operation - Option 2).
NOTE 2: It is assumed that the Flight Authorization ID contains information
that can be resolved to an address of the USS/UTM serving the UAV (e.g. DNS
lookup, or other resolution mechanisms defined outside 3GPP, as in the case of
the ASTM standard).
3\. The UAV triggers a Registration Request procedure and, if the UE intends
to use UAS services, it indicates support of UAS services in the UE
capabilities. If the UAV intends to register to access only other services
(e.g. Internet connectivity for software updates), the UAV does not provide
such indication. A UAV that does not provide the support of UAS services in
the UE capabilities is restricted from establishing connectivity for UAS
services (e.g. for C2 connectivity to a UAVC) and, before being capable of
accessing UAS services, the UAV must re-register and provide the support of
UAS services in the UE capabilities.
If the UE intends to use UAS services, the UAV also includes a CAA-Level UAV
identity (e.g. a permanent identity). The UAV that omits such indication is
considered by the AMF to be performing a Registration as a regular UE (i.e.,
not using UAS service, performing UUAA etc.).
The UAV may also include an UUAA Aviation Payload containing application layer
information that is transparent to the AMF. The UAV may include the USS/UTM
address information (see clause 6.5.2.3).
NOTE 3: It is assumed that mobility or initial registration procedure may
trigger a UAV authentication and authorization.
4\. The network performs a primary authentication during the Registration
Procedure as specified in TS 23.501 [12] clause 4.2.2.2.2.
5\. The AMF determine whether a USS UAV Authorization/Authentication (UUAA) is
required based on the UAV subscription, the UE capabilities indicated at
registration, and any UUAA information stored in the UAV context resulting
from previous UUAA procedures, if any. The AMF also selects the UFES as
described in clause 6.5.2.1.
NOTE 4: It is assumed that in 5GS the subscription is marked as an aerial
subscription, as already enabled in EPC since Rel. 15. Aerial UE function is
also part of UAV UE subscription in 5G, and detailed descriptions can be found
in Solution #8.
6\. The AMF returns a Registration Accept message to the UAV.
NOTE 5: It is assumed Network Slice-Specific Authentication and Authorization,
as defined in TS 23.501 [12], takes plane before UUAA. If UAV fails the slice
authentication, UUAA procedure will not be triggered.
[Optional, when UUAA is performed] The Registration Accept message in addition
contains a \"pending UUAA\" indication if the UUAA needs to be performed.
\- restricted services: the AMF assigns the Tracking Areas of the Registration
Area as a Non-Allowed Area (i.e. the UAV is only allowed to exchange NAS
signalling and is not allowed to trigger a PDU session establishment, among
other procedures). The AMF may return also other configuration information,
e.g. UAS information such as types of communication allowed by the operator
for UAS operations. Upon receiving the \"pending UUAA\" indication the UAV
behaves as a UE receiving a \"Pending NSSAA\" indication and is restricted
from performing e.g. any PDU session establishment dedicated for the UAS
service.
\- differentiated services: the AMF assigns the Tracking Areas of the
Registration Area as per regular operations. The AMF may return also other
configuration information, e.g. UAS information such as types of communication
allowed by the operator for UAS operations (e.g. network-assisted, direct,
etc.). Upon receiving the \"pending UUAA\" indication the UAV is restricted
from performing any PDU session establishment dedicated for UAS services (e.g.
for connectivity to USS or for C2 connectivity). The UAV may access any other
non-UAS PDU sessions (e.g., for software update over Internet connectivity).
Such PDU sessions may be have been established prior to the UUAA (e.g., when
UUAA is triggered by a Mobility Registration procedure) or after. The UAV may
also establish a PDU session for connectivity between the UAV and the USS/UTM.
It is assumed that the UAV is configured to know which PDU sessions (i.e.
which S-NSSAIs and DNNs) are dedicated to C2 connectivity via existing
mechanisms (e.g. URSP), and that the AMF is aware of which PDU sessions are
used for UAS services.
7\. [Optional UUAA] The AMF triggers a UUAA procedure.
7a. the AMF requests UUAA services to the UFES including the information
provided by the UAV in step 3 or 7a/7b, along with the UAV SUPI. Along with
this information, the AMF may also include the network provided location
information (NPLI) (e.g. Cell ID or geographical area corresponding to a Cell
ID) or any location information obtained by NILR procedures (defined in TS
23.273 [8]) or other positioning procedures. The AMF provides to the UFES the
UAV GPSI to be used as 3GPP UAV ID, since the UFES acts as as a proxy towards
USS/UTM, similar to NSSAAF in a NSSAA procedure. The AMF may also provide the
UAV PEI.
7b. The UFES discovers and selects the USS/UTM as described in clause 6.5.2.3.
7c. The UFES triggers an authentication request to the UFES, including the
information obtained from the AMF. If the AMF did not provide the UAV GPSI,
the UFES retrieves the GPSI based on the UAV SUPI and provides it to the
USS/UTM as 3GPP UAV ID.
7d. Depending on the security mechanisms used, multiple roundtrips may be
required.
NOTE 6: Security details will be determined by SA WG3.
7e. If the authorization based on the CAA-Level UAV ID succeeds, the USS/UTM
returns UAV Authorization Information to the UFES. The USS/UTM stores the
pairing between the CAA-Level UAV ID and the 3GPP UAV ID.
7f. The UFES notifies the AMF of the result of the procedure providing the UAV
Authorization Information.
7g. The AMF stores the UAV Authorization Information in the UE context to
determine later whether UUAA is required during future registrations and to
allow UE to establish PDU session(s) dedicated for the UAS service. Such
information may include an authorized CAA-level UAV ID assigned by the
USS/UTM. The UAV authorization information received from the USS/UTM may
contain validity conditions that provide a long-term authorization. This would
allow the 3GPP system at future UUAA procedures to authorize the UAS without
interacting with the USS/UTM.
The UAV Authorization Information may contain authorized operations and
necessary information applicable to existing or future PDU sessions, which may
be transferred by the AMF to the SMF to influence SMF decisions for traffic of
PDU sessions.
If the UAV performs periodic registration or mobility registration to 5GC, the
UUAA may be re-initiated, thus authorized operations and necessary information
is applicable to both existing and future PDU sessions.
The UAV Authorization Information may indicate to disable all connectivity of
the UAV except for the connectivity to UTM based on necessary information
contained in response information, which can be dedicated DNN of USS/UTM,
combination of DNN and S-NSSAI of USS/UTM, or traffic filtering information
(e.g. 5 Tuple) identifying the traffic flow to USS/UTM. For example:
\- The UAV may establish a PDU session with dedicated DNN for C2 communication
which contains QoS flow(s) to the UAVC, and may establish other PDU sessions
with common DNN for other purposes, based on received authorized operations
and necessary information, the SMF may only keep the QoS flow to USS/UTM and
disable all other PDU sessions and QoS flows.
\- The UAV may establish a PDU session with common DNN for C2 communication
and other purposes, based on received authorized operations and necessary
information, the SMF may only keep the QoS flow to USS/UTM and disable all
other QoS flows in this PDU session.
7h. [Optional] The AMF may return the results of the UUAA to the UAV. If the
UAV Authorization Information created by the USS/UTM contains information
dedicated to the UAV, such information is delivered to the UAV. This may be
returned in a NAS Message used as transport or in the UCU at step 9.
NOTE 7: The details of UUAA procedure depends on the security model (i.e.
security credentials) used at the application level to secure the
communications between the UAV and the USS/UTM and to secure the Remote
Identification solution. It is assumed that such security mechanisms,
similarly to V2X, are defined at the application layer and outside a 3GPP.
Based on the security solution, the UUAA may require multiple roundtrips
between the UAV and the USS/UTM.
NOTE 8: The UUAA procedure is executed over NAS Transport, and in the case of
the NSSAA procedure.
8\. [Optional] USS/UTM may subscribe/request network capability information
such as network coverage and mobility limitations information. The details are
described in solution #12, clause 6.12.
9\. [Optional, only if UUAA is performed in step 7] Upon successful UUAA, the
AMF triggers the UE Configuration Update procedure to deliver a new
Registration Area, since the UE was placed in restricted/forbidden areas in
the registration accept. The AMF may deliver additional information if
received from UFES/USS (e.g. a new CAA-level UAV ID).
**PART 2:**
Figure 6.5.3.1-2: Procedure for UAV Authentication and Authorization with
USS/UTM in 5GS -- Part 2
NOTE 9: in the following steps, if multiple PDU sessions are established for
UAV to USS/UTM and UAV to UAVC communications, respectively, the first PDU
session established is for UAV to USS communications. In case of multiple PDU
sessions, the UAV provides the information related to authorizing the pairing
between the UAV and UAVC only during the establishment of the PDU session for
UAV to UAVC communications.
10\. The UE sends a PDU Session Establishment Request message to the SMF in
order to establish a PDU session to support only UAV-USS/UTM connectivity (in
the case of multiple separate PDU sessions for UAV-USS communications and UAV-
UAVC communications, respectively) or to support as well as a C2 connection
with a networked UAV controller (in the case of single PDU sessions for UAV-
USS communications and UAV-UAVC communications, respectively).
It is assumed that the UAV is configured with the appropriate S-NSSAI and DNN
to use or that the 3GPP Network has configured the Default S-NSSAI and Default
DNN to be dedicated for UAV-USS/UTM connectivity.
The UAV provides a \"UAV operation request indication\", which may be an
explicit indication, or a specific DNN, or a specific combination of DNN and
S-NSSAI, to indicate to the SMF that the PDU Session is for UAV services (i.e.
communication with USS/UTM and for C2 connectivity).
NOTE 10: The details of the \"UAV operation request indication\" will be
defined during normative stage.
NOTE 11: A dedicated well-known DNN may be used for UAV services, but this
should be defined outside 3GPP (e.g. in GSMA) for roaming and interworking
purposes. At a minimum, the UAV needs to be configured with the DNN to be used
for UAV services or the MNO needs to set the Default DNN to correspond to the
APN for UAV services.
To perform authorization for pairing a networked UAV controller and UAV and
for UAV flight authorization by the USS/UTM supports authorization for
establishment of a PDU session for UAV operations by the USS/UTM the UAV
provides to the SMF with an Aviation Connectivity Payload containing the CAA-
Level UAV ID, and the optional Flight Authorisation ID if the UE obtained one
at step 2. The UAV may also include the information for flight path
authorization/registration for flight operation. If the UAV has the networked
UAV controller information (from pre-configuration or received in step 2), the
UAV includes also the information for the authorization of UAV and networked
UAV controller pairing in the Aviation Connectivity Payload.
11\. The SMF retrieves the SM subscription data from UDM and performs the
necessary actions for UAV IP address allocation. The SMF selects the UFES as
described in clause 6.5.2.1.
12\. [Optional, alternative to step 14]:
12a. The SMF sends an UAV Operation Request (e.g. using a service interface)
to the UFES, including the CAA-level UAV ID, UAV IP Address, Flight
Authorisation ID (if available), UAV Location, GPSI, and optionally USS/UTM
information determined in step 11 and networked UAV controller information.
UAV Location is the network provided location information (NPLI) obtained from
AMF which can be Cell ID or geographical area corresponding to a Cell ID or
any location information obtained by NILR procedures (defined in TS 23.273
[8]) or other positioning procedures based on subscription. The SMF may also
include the PEI.
12b. The UFES selects a USS/UTM as described in 6.5.2.3.
12c. The UFES forwards the information to the USS/UTM. The UFES may store the
information on the SMF/PDU Session serving the UAV for C2 connectivity, to be
used for C2 connectivity revocation.
12d. Depending on the security mechanisms used, multiple roundtrips may be
required.
NOTE 12: Security details will be determined by SA WG3.
12e. The USS/UTM validates the request based on the CAA-Level UAV ID, the PEI,
the optional Flight Authorization ID (if one is provided) , and the optional
networked UAV controller information.
The USS/UTM determine Remote Identification & Tracking Info (RITI) for the UAV
to use. This may include a new CAA-level UAV ID (e.g. a new temporary identity
for Remote Identification) that is used as a means to remotely identify the
UAV, and Authorisation Data that may include the authorised area & time where
the UAV can operate
The Authorisation Data may contain authorized operations and necessary
information applicable to existing PDU sessions, which influence SMF decisions
for traffic of PDU sessions.
Because authentication can be re-initiated at any time by SMF or USS/UTM after
initial authentication, authorized operations and necessary information can be
updated when necessary.
The authorized operations may indicate to disable all connectivity of the UAV
except for the connectivity to UTM based on necessary information contained in
response information, which can be dedicated DNN of USS/UTM, combination of
DNN and S-NSSAI of USS/UTM, or traffic filtering information (e.g. 5 Tuple).
12e. The USS/UTM sends a UAV Operation Accept to the UFES containing the
Authorization Data and RITI.
12f. The UFES sends a UAV Operation Accept to the SMF containing the
Authorization Data and RITI. The UFES may store the correspondence between the
CAA-Level UAV ID, the 3GPP UAV ID, the Authorization Data, and the RITI.
13\. The SMF interacts with the PCF and forwards the Authorization Data
received from the USS/UTM. The PCF uses the Authorization Data to provide PCC
rule(s) to the SMF in the response. The SMF configures user plane connectivity
for UAV to USS/UTM communication and, if the UAV and UAVC pairing has been
authorized, optionally also for UAV to UAV Controller communication (e.g.
default QoS for non-flight communication only) based on information that the
PCF may provide.
NOTE 13: The configuration of the user plane connectivity may only permit UAS
related traffic in the PDU Session based on the received authorized operations
and necessary information from the USS/UTM and disable all other traffic, e.g.
by using PCC rule(s).
14\. The PDU session establishment succeeds only upon indication from the
USS/UTM that either step 13 or 14 succeeded. The SMF forwards the RITI to the
UAV within the PCO of the session management message.
NOTE 14: The details of the exchange of aviation level information such as
RITI in NAS signalling (e.g. PCO or new IEs) will be defined in normative
phase.
15\. UAV broadcasts remote identification information for remote
identification based on RITI information.
16\. UAV sends remote identification information to the USS/UTM based on RITI
information.
17\. When separate PDU sessions are used for UAV to USS and UAV to UAVC
communications, the UAV establishes an additional dedicated PDU session for C2
connectivity following the steps 10 to 14 with the difference that networked
UAV controller information shall be provided by the UAV to enable
communication with the UAVc. The user plane connectivity for the PDU Session
should be restricted first and will be enabled by the next steps.
NOTE 15: Steps18 and 19 apply to both scenario, using a single PDU session and
using separate PDU Sessions for communication with the UTM/USS and for C2
communication.
18\. The USS/UTM interacts with the UFES using network exposure mechanisms
(e.g. for UAV location reporting, providing traffic filters, requesting QoS
for the PDU Session which will be used for C2 communication). The UFES
interacts with the PCF and forwards the traffic filters and requested QoS
information. The PCF interacts with the SMF and provides PCC rule(s)
containing the traffic filter and QoS information. The PCC rule(s) may only
permit UAS related traffic in the PDU Session based on received authorized
operations and necessary information from the UTM and disable all other
traffic.
19\. The SMF establishes the necessary QoS Flow(s) based on information that
the PCF provides (e.g. policies and/or traffic filters) to enable the
communication between the UAV and the UAV controller for the flight operation
(e.g. with QoS support for in-flight related communication).
20\. The UE exchanges C2 traffic with the networked UAV Controller.
##### 6.5.3.1.2 Procedure For UUAA Revocation
Figure 6.5.3.1.2-1: Procedure for UUAA Revocation in 5GS
1\. USS/UTM determines that UUAA is to be revoked.
2\. USS/UTM sends an authorization revocation message to the UFES, addressing
the UAV via the 3GPP UAV ID. The request contains a Revocation Cause
indicating this is UUAA revocation.
3\. The UFES identifies the AMF serving the UAV by invoking the Nudm_UECM_Get
service operation and forwards the request for revocation.
4\. The AMF triggers the UUAA revocation. Two expected behaviors are possible:
\- restricted services: the AMF triggers the removal of all the PDU sessions
associated with the UAV (a cause code indicating revocation of authorization
is provided in the SM signalling, detailed to be defined in stage 3) towards
the corresponding SMFs, and performs a UCU procedure assigning the Tracking
Areas of the Registration Area as a Non-Allowed Area (i.e. the UAV is only
allowed to exchange NAS signalling and is not allowed to trigger a PDU session
establishment, among other procedures), providing a \"failed UUAA\"
indication. The UAV is restricted from performing e.g. any PDU session
establishment dedicated for the UAS service. If the UAV needs to perform a new
UUA, the UE performs a re-registration.
\- differentiated services: the AMF triggers the removal of all the PDU
session(s) for UAS services towards the corresponding SMFs, i.e. for UAV-
USS/UTM communication and for C2 connectivity associated with the UAV (a cause
code indicating revocation of authorization is provided in the SM signalling,
detailed to be defined in stage 3). The UAV may continue to access any other
non-UAS PDU sessions
NOTE: In the case of PDU sessions dedicated to UAV-USS/UTM communications and
to C2 connectivity, it is assumed the AMF is configured with information on
which specific PDU sessions (e.g. S-NSSAI and DNN) are dedicated for UAS-
USS/UTM communication and for C2 connectivity.
5, 6. The UUA connectivity revocation is confirmed to the UFES and USS/UTM.
##### 6.5.3.1.3 Procedure For Revocation of Pairing
This procedure is used to stop communication between the UAV and UAVC, e.g. as
a result of pairing or a flight path being revoked.
Figure 6.5.3.1.3-1: Procedure for Pairing revocation in 5GS
1\. USS/UTM determines that pairing is to be revoked.
2\. USS/UTM sends a pairing revocation request to the UFES, addressing the UAV
via the 3GPP UAV ID. The request contains a Revocation Cause indicating this
is pairing revocation.
The request contains necessary information provided by USS/UTM (e.g. dedicated
DNN of UTM, combination of DNN and S-NSSAI of UTM, or traffic filtering
information (e.g. 5 Tuple) identifying the traffic flow to UTM) to indicate to
5GS which traffic flows of the UAV should be allowed or blocked/released.
3\. The UFES identifies the SMF serving the UAV for C2 connectivity between
UAV and UAVC, e.g. based on information stored during the establishment and
authorization of C2 connectivity between UAV and UAVC. This corresponds to the
SMF serving the UAV for the common PDU session for UAV-USS/UTM communication
and for C2 connectivity between UAV and UAVC.
4a. Revocation of the C2 connectivity between UAV and UAVC is implemented by
the SMF by removing the QoS flows for C2 connectivity between UAV and UAVC
based on information received from the USS/UTM.
4b. In the case of dedicated PDU session for C2 connectivity between UAV and
UAVC, the revocation of C2 connectivity between UAV and UAVC is implemented by
the SMF by releasing the PDU session with an appropriate cause based on the
information received from the USS/UTM.
5, 6. The C2 connectivity revocation is confirmed to the UFES and USS/UTM.
##### 6.5.3.1.4 Procedure For Update/Revocation of flight-related
communication
This procedure is used to stop or update flight related communication between
the UAV and UAVC, e.g. when a flight path is revoked or completed.
Figure 6.5.3.1.4-1: Procedure for Update/Revocation of flight-related
communication in 5GS
1\. USS/UTM determines to update or revoke QoS requirements for flight related
communication.
2\. USS/UTM initiates the AF session with required QoS update procedure as
described in clause 4.15.6.6a of TS 23.502 [7] or AF session with required QoS
revoke procedure by sending the Nnef_AFsessionWithQoS_Update message or the
Nnef_AFsessionWithQoS_Revoke message, respectively.
3.-8. When using AF session with required QoS update procedure, steps 2-8 are
the same as steps 2-7 described in clause 4.15.6.6a of TS 23.502 [7].When
using AF session with required QoS revoke procedure, steps 2-8 are the same as
steps 2-7 described in clause 4.15.6.6a of TS 23.502 [7] with the following
difference:
\- Instead of updating the request QoS, the UFES/NEF revokes the request QoS
by using Npcf_PolicyAuthorization_Delete service operation.
This results in signalling to RAN and the UE to update or remove the QoS Flows
used for flight related communication.
#### 6.5.3.2 EPS Procedures
#### 6.5.3.2.1 EPS Procedure For Authentication/Authorization
The procedure for UAV Authentication and Authorization by USS in the EPS case
is depicted in Figure 6.5.3-2.
In this procedure, both the scenario of single PDN connection for both UAV-
USS/UTM communication and C2, and the scenario of separate PDN connection for
UAV-USS/UTM communications and C2 are shown. In this solution, the attach
procedure succeeds and a PDN connection is established for at least UAV-
USS/UTM communication only if the UUAA succeeds.
The option where the UUAA and the authorization of UAV and networked UAV-C
pairing are performed via an EAP mechanisms using NAS transport and PCO
extensions is possible but not depicted in the picture.
Figure 6.5.3.2.1-1: Procedure for UAV Authentication and Authorization with
USS/UTM in EPS.
1\. [Outside the scope of 3GPP] As step 1 of clause 6.5.3-1.
2\. [Outside the scope of 3GPP] [Optional] As step 2 of clause 6.5.3-1.
3\. The UAV sends an Attach Request to the MME. In EPS, Protocol Configuration
Options (PCO) in the ESM message container are used to transfer parameters
between the UE and the PDN GW, and sent transparently through the MME and the
Serving GW. The PCO is extended to enable the UAV to insert the CAA-Level UAV
ID, the Flight Authorization ID (if available), the UUAA Aviation Payload
containing application layer information that is transparent to the EPC, and
the Aviation Connectivity Payload containing the information for flight path
authorization/registration for flight operation and for the authorization of
UAV and networked UAV controller pairing (the information exchanged between
UAV and USS/UTM for authorization for pairing of the networked UAV controller
and UAV can refer to clause 6.5.3.1). The UAV in the UUAA procedure uses
credentials obtained by the UAV during registration with the USS/UTM. The UAV
may include the USS/UTM address information (see clause 6.5.2.3).
4\. Primary authentication/authorization is performed as specified in TS
23.401 [10] clause 5.3.2.1.
5\. The MME determines the UAV has an aerial subscription and selects the
Default APN for connectivity with the USS/UTM.
6\. The MME sends a Create Session Request to the SMF+PGW-C via the SGW. The
MME may include the ME Identity (IMEISV of the UAV). For the default APN used
for connectivity with the USS, the HSS must allow selection of a SMF+PGW-C in
the VPLMN for such APN since the USS/UTM is always located in the VPLMN.
NOTE 1: A dedicated well-known APN may be used for UAV services, but this
should be defined outside 3GPP (e.g. in GSMA) for roaming and interworking
purposes. At a minimum, the UAV needs to be configured with the APN to be used
for UAV services or the MNO needs to set the Default APN to correspond to the
APN for UAV services.
NOTE 2: It is expected that the MME selects an SMF+PGW-C, with the Default APN
for UAV-USS/UTM communications always resolving to an SMF+PWG-C.
7\. The SMF+PGW-Cverifies whether a secondary authentication is required for
the PDN connection establishment request:
\- For the scenario of single PDN connection, UUAA, authorization of UAV and
networked UAV controller pairing, and authorization for establishment of user
plane resource are always requested for APNs corresponding to UAS services,
and may be verified against the UAV subscription if the node is an SMF+PGW-C.
\- For the scenario with multiple PDN connections, at these steps only UUAA
would be performed and the SMF+PGW-Cverifies as above if it is required.
7a. The SMF+PGW-C establishes an N4 session with the UPF+PGW-U.
7b. The SMF+PGW-C installs traffic filters and access control list (ACL) so
that the UE is not able to access any data network using the PDN connection
until a secondary authentication is successfully completed with the USS/UTM.
8[a-c]. If the UE provided the CAA-Level UAV ID, then the SMF+PGW-C sends back
a Creation Session Response, otherwise the SMF+PGW-C rejects the establishment
of the session. The MME sends attach accept. The UE then sends attach
complete.
9[a-b]. VOID
10\. The UUAA, and optionally in the case of single PDN connection also
authorization of UAV and networked UAV controller pairing, and flight path
authorization/registration for flight, are performed.
10a. The SMF+PGW-C selects the UFES based on pre-configured policies or as
defined in the 5GS procedure. The SMF+PGW-C provides the information sent by
the UAV in the PCO (CAA-level UAV ID, optional Flight Authorization ID,
optional Aviation Connectivity Payload, optional USS/UTM address information,
User Location Information (ECGI or geographical area corresponding to ECGI))
and the UAV\'s IMEISV (if provided) to the UFES. The SMF+PGW-C also provides
the UFES the External Identifier to be used as 3GPP UAV ID.
10b. The UFES discovers and selects the USS as described in 6.5.2.3.
10c. The UFES forwards the information to the USS/UTM.
10d. The USS validates the request for UUAA based on the CAA-Level UAV ID, the
Flight Authorization ID (if one is provided).
If the Aviation Connectivity Payload is included, the USS/UTM also verifies
the UAV and networked UAV controller pairing.
The USS/UTM may determine Remote Identification & Tracking Info (RITI) for the
UAV to use (e.g. in the case of UUAA-only and separate PDN connections, the
USS/UTM may do so only when authorizing UAV and networked UAV-C pairing and
establishment of user plane resources for C2 connectivity). This may include
amongst others, a new CAA-level UAV ID, a UAV Type that is used as a means to
remotely identify the UAV.
The USS/UTM also determines Authorization Data containing information about
the connectivity between the UAV and the USS/UTM. If the USS/UTM also
authorizing the UAV and networked UAV-C pairing, Authorization Data contains
also information about the user plane connectivity between the UAV and the
networked UAV Controller. Some of the RITI information, e.g. the CAA-level UAV
ID, are received and stored by the UFES, together with the Authorization Data.
The USS determines Authorization Data containing authorized operations and
necessary information applicable to existing or future PDN connections, which
influence SMF+PGW-C decisions for traffic of PDN connections.
The authorized operations may indicate to disable all connectivity of the UAV
except for the connectivity to USS/UTM based on necessary information
contained in Authorization Data, which can be dedicated APN of USS/UTM, or
traffic filtering information (e.g. 5 Tuple) identifying the traffic flow to
USS/UTM. For example:
\- The UAV may establish a PDN connection with dedicated APN for C2
communication which contains one bearer to USS/UTM and another bearer to UAVC,
and may establish other PDN connections with common APN for other purposes,
based on received authorized operations and necessary information, the
SMF+PGW-C may only keep the bearer to USS/UTM and disable all other PDU
connections and bearers.
The UAV may establish a PDU connection with common APN for C2 communication
and other purposes, based on received authorized operations and necessary
information, the SMF+PGW-C may only keep the bearer to USS/UTM and disable all
other bearers in this PDN connection.
10e. The USS/UTM returns the response to the UFES.
10f. The UFES returns the response to the PGW.
10[g-h]. The SMF+PGW-C sends an Update Bearer Request to the MME including the
RITI in the PCO. The MME sends the PCO in a Downlink NAS transport message to
the UAV UE and confirms the bearer update procedure by sending an Update
Bearer Response to the SMF+PGW-C
11\. If the PGW received the Authorization Data (including optional authorized
UAV and networked UAV controller pairing information), the PGW installs
traffic filters for the connectivity between the UAV and the networked UAV
controller, and for connectivity between the UAV and the USS/UTM.
12\. [Optional] USS/UTM may subscribe/request network capability information
such as network coverage and mobility limitations information. The details are
described in solution #12, clause 6.12.
[Optional] Steps 13-20 are performed only in the case of separate PDN
connections.
13\. The UAV sends a PDN Connection Request to the MME for the establishment
of a PDN Connection for C2 connectivity with a networked UAV-C. The UAV
includes in the PCO the CAA-Level UAV ID, the Flight Authorization ID (if
available), and the Aviation Connectivity Payload containing the information
for flight path authorization/registration for flight operation and for the
authorization of UAV and networked UAV controller pairing (the information
exchanged between UAV and USS/UTM for authorization for pairing networked UAV
controller and UAV can refer to clause 6.5.3.1). The UAV may include the
USS/UTM address information (see 6.5.2.3).
14\. The MME sends a Create Session Request to the SMF+PGW-C via the SGW. The
MME may include the ME Identity (IMEISV of the UAV). The MME selects a
SMF+PGW-C suitable to serving the APN for C2 connectivity (it is expected to
select the same PGW serving the PDN connection for UAV-USS/UTM connectivity).
15\. The SMF+PGW-C verifies whether a secondary authentication is required for
the PDN connection establishment request, in particular the authorization of
UAV and networked UAV controller pairing, and flight path
authorization/registration for flight, are performed. This is performed as
step 14, with the USS/UTM verifying the UAV and networked UAV controller
pairing. The USS/UTM may determine Remote Identification & Tracking Info
(RITI) for the UAV to use. This may include amongst others, a new CAA-level
UAV ID, a UAV Type that is used as a means to remotely identify the UAV. The
USS/UTM also determines Authorization Data containing information about the
user plane connectivity between the UAV and the networked UAV Controller.
16\. The SMF+PGW-C establishes an N4 session with the UPF+PGW-U.
17\. If the SMF+PGW-C received the Authorization Data (including optional
authorized UAV and networked UAV controller pairing information), the
SMF+PGW-C installs traffic filters for the connectivity between the UAV and
the networked UAV controller.
18\. The SMF+PGW-C confirms the procedure to the MME along with providing the
RITI in the PCO.
19\. The new MME sends PDN Connection Accept to the UE with the PCO containing
the RITI.
20\. The USS/UTM may acts as an SCS/AS and communicates to the UFES, which
acts as a SCEF, to trigger the establishment of an application session with a
required QoS and providing traffic filters to enable UAV to networked UAV
controller connectivity, and optionally for UAV to USS/UTM connectivity. The
USS/UTM may also use other SCEF services of the UFES.
21\. UAV broadcasts remote identification information for remote
identification based on RITI information.
22\. UAV sends remote identification information to the USS/UTM based on RITI
information.
23\. The UE exchanges C2 traffic with the UAV Controller.
##### 6.5.3.2.2 Procedures for Authorization Revocation
Figure 6.5.3.2.2-1: Procedure for Revocation in EPC
1\. USS/UTM determines that UUAA or just authorization for C2 connectivity is
to be revoked.
2\. USS/UTM sends an authorization revocation message to the UFES, addressing
the UAV via the 3GPP UAV ID. The request contains a Revocation Cause
indicating this is UUAA revocation, or C2 revocation.
3\. The UFES identifies the PGW serving the UAV based on the cause for
revocation and forwards the request:
\- in the case of single PDN connection, a single PGW is serving the UE.
\- in the case of separate PDN connections, separate PGWs may be serving the
UE (though it is expected that the same PGW serves both PDN connections), and
the UFES selects the PGW depending on the cause for revocation. If the
revocation is for UUAA, the UFES forwards the revocation to both since this
corresponds to releasing both the PDN connection for UAV-USS/UTM communication
and the PDN connection for C2. If the revocation is for C2 connectivity, the
UFES sends the revocation only to the PGW serving the PDN connection for C2
connectivity.
4\. The PGW(s) receiving the request triggers the release of the PDN
connection.
5, 6. The UUA connectivity revocation is confirmed to the UFES and USS/UTM.
### 6.5.4 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to services, entities and
interfaces.
For 5GS:
\- The AMF is enhanced to provide the \"UUAA pending\" indication to the UAV
and to act accordingly with respect to limiting the establishment of PDU
sessions while the UUAA is pending.
\- The AMF and SMFs are enhanced to support the authorization procedures as
defined above, to store the results of successful authorization procedures,
and to verify upon further registration procedures (AMF) or PDU session
establishment whether authorization procedures needs to be performed or not.
\- The SMF supporting the DNN or DNN+S-NSSAI combination used for UAV
connectivity to USS and UAV-networked UAV controller connectivity are enhanced
to exchange direct signalling to the USS via the UFES.
For EPS:
\- The PDN GW interfaces with the UFES for the UAV APN.
\- The PDN GW is enhanced to handle the \"enhanced\" PCO.
Editor\'s note: The exact details of the interface are FFS.
For both EPS and 5GS:
\- An UFES function is introduced as described above. The UFES may be mapped
to existing functionality, e.g. SCEF, NEF, AAA-P depending on the specific
implementation of the interfaces between the 3GPP system and the USS/UTM.
Service exposure interfaces:
\- UFES exposes a service interface for supporting UUAA towards the USS/UTM,
including UUAA revocation
\- UFES exposes a service interface fo supporting authorization of UAV and
networked UAV controller pairing, for flight authorization, and to authorize
the establishment of user plane connectivity for C2.
## 6.6 Solution #6: Control-plane assisted UAV authentication and
authorization
### 6.6.1 Introduction
The solution addresses key issue #1, #2 and #5.
Figure 6.6.1-1 illustrates the procedure for Additional CP-based
Authentication and Authorization, after the primary authentication procedures,
the MNO can request additional ID identification and Position related
authorization (e.g. no-fly/fly-limited areas check) to external entity (UTM)
meanwhile the trusted position from the MNO can be provided.
Figure 6.6.1-1: Additional CP-based Authentication and Authorization
When the additional CP-based authentication/authorization performed after the
primary authentication procedures, the MNO can receive the command from UTM
contained in the Authorization Response to perform Authorized Operations for
the subsequent flight-related behaviour (e.g. nothing, or limited PDU
sessions, or disconnect all the UP connectivity for the consideration of high
security in some confidential areas).
Editor\'s note: It is FFS whether the solution can apply to EPS.
### 6.6.2 Functional Description
#### 6.6.2.1 Architecture
Figure 6.6.2.1-1: Architecture for Additional CP-based Authentication and
Authorization
Editor\'s note: Whether considering a new defined NF as the interface to UTM
is FFS.
### 6.6.3 Procedures
The figure 6.6.3-1 below shows a high-level flow of the actions needed for a
successful additional CP-based authentication/authorization procedure.
Figure 6.6.3-1: High-level flow of Additional CP-based Authentication and
Authorization
0\. When the general registration depicted in Figure 4.2.2.2.2.1-1 has
completed. The MNO can perform additional CP-based authentication and
authorization procedures.
Editor\'s note: Whether the additional CP-based authentication/authorization
procedures can be performed during the primary authentication procedures (e.g.
additional authentication information can be involved in the registration
request) is FFS.
1\. If the AMF don\'t have the Aerial UE information, it can use Nudm_SDM_Get
service to obtain from UDM.
Editor\'s note: It is FFS why the AMF would not get the complete UAV
subscription profile from the UDM, including any aerial UE information, as in
the case of the same feature already specified for the EPC.
2\. AMF determines that it needs to contact the UTM based on local
configuration and/or the Aerial UE information (UAV-specific) contained in the
subscription. The AMF can find the UTM based on local configuration or using
the CAA-Level UAV ID which contains information that can be resolved to
identify the UTM. The CAA-Level ID can be allocated by UTM or MNO.
Editor\'s note: Whether other NF (e.g. UCF) shall trigger the additional CP-
based authentication/authorization procedures is FFS.
Editor\'s note: It is FFS how the AMF can be configured with local information
about the UTM/USS, given that according to regulatory requirements the
relationship between the UAV and the USS/UTM may change over time and that
such relationship is not connected to the UAV subscription with the MNO, and
is not specific to an MNO.
Editor\'s note: How the CAA-Level UAV ID is used to resolve to the correct UTM
in the case the CAA-Level UAV ID is allocated by the UTM or the MNO is FFS.
3\. AMF can obtain existing location info (e.g. Cell ID) or perform NPLI
procedures or other positioning procedures defined in clause 4.13.5.1 of TS
23.502 [7].
4\. AMF can get Authentication Message from UE via NAS, which contains:
\- CAA-Level UAV ID, sent to the UTM for the ID Identification.
\- The location information provided by UE (e.g. GPS location), shall be
transparently sent to UTM and used to be compared with the trusted positioning
information by UTM.
\- The flight path provided by UE can be planned flight path which should be
checked by UTM.
5\. AMF constructs the DN Request Container which contains Authentication
Message received from UE and trusted positioning information provided by the
MNO.
6\. The AMF identifies the UTM based on local configuration and AMF sends the
DN Request Container to the right UTM for ID Identification and/or Position
related check.
7\. The UTM will response the Authorized Operations which are going to be
performed by MNO for the subsequent UAV behaviour. The Authorized Operations
applicable to established/upcoming PDU sessions or QoS flows between UAV and
UAVC may be:
\- No limitation when receiving the successful response from UTM.
\- Disable target established/upcoming PDU sessions or QoS flows based on
differentiated types of PDU sessions or QoS flows (e.g. indication in the PDU
session establishment used to differentiate flight or non-flight purposes)
when receiving the failed response from UTM;
\- Disable target established/upcoming PDU sessions or QoS flows based on the
allow lists (e.g. allowed DNNs or IP addresses) when receiving the failed
response from UTM.
Editor\'s note: It is FFS whether the Authorized Operations can be something
else.
Editor\'s note: Whether it is realistic to expect that an application layer
entity external to the 3GPP system like the USS/UTM is aware of concepts like
PDU sessions is FFS.
### 6.6.4 Impacts on services, entities and interfaces
Editor\'s note: This clause lists impacts to services, entities and
interfaces.
## 6.7 Solution #7: Enhanced Secondary Authentication/Authorization for UAVs
### 6.7.1 Introduction
The solution addresses key issue #1, #2 and #5 for the 5GS and is not
applicable to the EPS.
Figure 6.7.1-1 illustrates the procedure for UAV authorization by UTM, using
an enhanced Secondary Authentication/Authorization procedure, whatever PDU
session the UAV is trying to establish, the MNO can help provide the UAVID and
trusted position to the UTM for related authentication and authorization
(including no-fly area check) during the secondary authentication procedures.
Figure 6.7.1-1 Enhanced Secondary Authentication/Authorization
In the case that the communication link between UAV and UTM is UP-based, UAVs
may be controlled by non-networked UAVC (e.g. the 3rd party UAS server). The
communication link between UAVs and networked UAVCs can be established using
N6 routing (via the relaying UAS Server), or via 5G-LAN like method (UPF local
switch).
Editor\'s note: The relationship between the communication link between UAV
and UTM being UP-based and the UAV being controlled by a non-networked UAVC is
FFS.
The connection between UAV and controller should be under UTM control, which
means UAV cannot have connection to controller only but no connection with
UTM. If mis-behaved, the UAV may skip the PDU Session establishment to the
UTM, and just establishes a link to the UAS server.
5G network should be able to detect whether the PDU session established by the
UAV targets to the UTM and then receive the command from UTM to perform
Authorized Operations (e.g. nothing, or limited PDU sessions, or disconnect
all the UP connectivity for the consideration of high security in some
confidential areas).
Editor\'s note: The UTM and UAS server can belong to different domains,
whether existing secondary authentication can support the authentication by
UTM in another domain (regarded as the AAA Server) or any enhancement is
needed depends on SA WG3.
### 6.7.2 Functional Description
#### 6.7.2.1 Architecture
Figure 6.7.2.1-1: Architecture for enhanced secondary authentication
**NOTE** : The UTM and UAS server can belong to the same DN domain.
### 6.7.3 Procedures
The figure 6.7.3-1 below shows a high-level flow of the actions needed for a
successful enhanced secondary authentication procedure.
Figure 6.7.3-1: High-level flow of enhanced secondary authentication
0\. The SMF determines that it needs to contact the UTM/DN-AAA server based on
local configuration and/or the Aerial UE information (UAV-specific) contained
in the subscription. If the SMF don\'t have the Aerial UE information, it can
use Nudm_SDM_Get service to obtain from UDM.
The SMF identifies the UTM based on local configuration or using the DN-
specific identity described in step 0 of TS 23.502 [7], clause 4.3.2.3. Here
the DN-specific identity can be the CAA-Level UAV ID and contain information
that can be resolved to identify the UTM. The CAA-Level UAV ID can be
allocated by UTM or MNO.
Editor\'s note: How the CAA-Level UAV ID is used to resolve to the correct UTM
in the case the CAA-Level UAV ID is allocated by the UTM or the MNO is FFS.
1\. Same as the step 1 of clause 4.3.2.3 in TS 23.502 [7].
2\. Same as the step 2 of clause 4.3.2.3 in TS 23.502 [7].
Editor\'s note: It is FFS whether the steps of clause .3.2.3 in TS 23.502 [7]
are unmodified.
Editor\'s note: It is FFS whether steps 2 and 3a are carried out over a AAA
interface.
Editor\'s note: It is FFS what UAV identifier the UTM is given during the
authentication/authorization request.
3a. Same as the step 3a of clause 4.3.2.3 in TS 23.502 [7]. If the A DN
Authorization Profile Index which is a reference to authorization data for
policy and charging control locally configured in the SMF or PCF, indicates
the MNO provides the trusted position information to UTM in the following
procedures, step 3b-3e can be performed.
3b. The SMF can perform the Namf_Location_ProvidePositioningInfo or
Namf_Location_ProvideLocationInfo service operation to get the trusted
position information of UAV.
3c. AMF can obtain existing location info (e.g. Cell ID) or perform NPLI
procedures or other positioning procedures defined in clause 4.13.5.1 of TS
23.502 [7].
3d. AMF responses the trusted positioning procedures to SMF.
3e. Same as the step 3b of clause 4.3.2.3 in TS 23.502 [7].
3f. Same as the step 3c and 3d of clause 4.3.2.3 in TS 23.502 [7] with the
following difference: in addition to the CAA-Level UAV ID, optionally the
location information provided by itself and flight path can also be contained
in the Authentication Message.
The location information provided by UE (e.g. GPS location) shall be
transparently sent to UTM and used to be compared with the trusted positioning
information by UTM.
The flight path provided by UE can be planned flight path which should be
checked by UTM.
3g. Same as the step 3e of clause 4.3.2.3 in TS 23.502 [7].
3h. SMF constructs the DN Request Container which contains Authentication
Message received from UE and trusted positioning information provided by the
MNO.
3i. Same as the step 3f of clause 4.3.2.3 in TS 23.502 [7].
4\. Same as the step 4 of clause 4.3.2.3 in TS 23.502 [7]. If an SM PDU DN
Response Container contained in the response indicates the Authorized
Operations which shall be performed by the SMF targeting the PDU session or
QoS flows between UAV and UAVC. The Authorized Operations applicable to
established/upcoming PDU sessions or QoS flows can be:
\- No limitation when receiving the successful response from UTM.
\- Disable target established/upcoming PDU sessions or QoS flows based on
differentiated types of PDU sessions or QoS flows (e.g. indication in the PDU
session establishment used to differentiate flight or non-flight purposes)
when receiving the failed response from UTM;
\- Disable target established/upcoming PDU sessions or QoS flows based on the
allow lists (e.g. allowed DNNs or IP addresses) when receiving the failed
response from UTM;
Editor\'s note: It is FFS whether the Authorized Operations can be something
else.
5\. Same as the step 5 of clause 4.3.2.3 in TS 23.502 [7].
### 6.7.4 Impacts on services, entities and interfaces
Editor\'s note: This clause lists impacts to services, entities and
interfaces.
Editor\'s note: This clause describes procedures and information flows for the
solution.
## 6.8 Solution #8: Support of Aerial UE function in the 5G system
### 6.8.1 Functional Description
The solution addresses key issue #1 on how are UAVs identified in the 3GPP
system.
In 4G system, the Aerial UE function has been supported for subscription-based
Aerial UE identification and authorization. Detailed descriptions can be found
in the clause 4.3.31 of TS 23.401 [10] and clause 23.17.1 of TS 36.300 [9].
Based on the Aerial UE function, the eNB recognizes the UEs capable of Aerial
communication, and then execute specific functionalities for these UEs which
including:
1) height reporting;
2) interference detection;
3) signalling flight path information transfer from UE to E-UTRAN;
4) location information reporting (described in TS 36.300 [9]).
It can reuse the 4G procedures to support the Aerial UE function after
aligning with 5G\'s NFs and interface messages.
Editor\'s note: Whether there is any enhancement for the Aerial UE function is
FFS.
### 6.8.2 Procedures
Corresponding to the 4G procedures supporting the Aerial UE function,
following action flows reflect how the 5G system supports the Aerial UE
function:
\- Support of Aerial UE function is stored in the user\'s subscription
information in UDM.
\- UDM transfers this information to the AMF via registration procedures.
\- AMF that supports Aerial UE function provides the user\'s subscription
information on Aerial UE authorisation to the NG-RAN via the NG AP Initial
Context Setup Request during Registration and Service Request procedures.
\- The NG-RAN supporting Aerial UE function handling uses the per user
information supplied by the AMF to determine whether or not to allow the UE to
use Aerial UE function.
\- During N2-based or Xn-based handover procedures, the Aerial UE subscription
information shall be sent to target NG-RAN.
Editor\'s note: Whether the specific functionalities supported in LTE for
these UAVs (described in clause 23.17.1 of TS 36.300 [9]) can be still
supported in NR depends on the RAN WG.
### 6.8.3 Impacts on services, entities and interfaces
\- Impact to the UDM:
\- Enhancement for adding Support of Aerial UE function in the subscription.
\- Impact to the AMF:
\- Enhancement for delivering Aerial UE subscription information to NG-RAN.
\- Impact to the NG-RAN:
\- Enhancement for support the Aerial UE function which refers to specific
functionalities for UAVs.
\- Enhancement for handover procedures to send Aerial UE subscription
information to target NG-RAN
## 6.9 Solution #9: UAV Identities Allocation and Usage for Remote
Identification
### 6.9.1 Introduction
The solution defines a set of mechanisms to enable a UAV to obtain an identity
to be used for Remote Identification transparently to the 3GPP system or with
the support of the 3GPP system. Such identity is used for identification of
the UAV towards the UTM and the TPAEs.
The solution assumes that the CAA-Level UAV ID is defined outside 3GPP,
however proposes functional assumptions for such identity, and describes its
usage in the 3GPP system.
Though the details of the CAA-Level UAV ID format used to identify a UAV with
the USS/UTM, and used for Remote Identification, are defined outside of 3GPP,
the use of such identity for enabling Remote Identification via the 3GPP
system are highly important to the system design for 3GPP. Specifically, how
such identity is used to enable a TPAE to query about UAV information using
UAV2 needs to be defined with respect to the 3GPP system, and a solution
identified as to which entity resolves the CAA-Level UAV ID to a network
function that can reply to such queries.The solution proposes multiple options
for the CAA-Level UAV ID assignment and resolutions.
The solution also addresses network publishing aspects for Remote
Identification.
### 6.9.2 Functional Description
The following clauses describe the building blocks of the solution.
#### 6.9.2.1 Adoption of a UAV Flight Enablement Subsystem (UFES)
In this solution, the UAV Flight Enablement Subsystem defined in solution 5 in
clause 6.5.2.1 is a 3GPP subsystem that interfaces the 3GPP System with the
USS and support that USS in performing UAV Remote Identification and tracking.
In addition, the UFES terminates UAV2 towards a TPAE, either directly or via
NEF/SCEF interfacing.
NOTE: In some 3GPP network deployments, the UFES may actually act as the USS,
for 3GPP operators that choose to provide USS services for UAVs. In such
cases, UFES and USS are a single functional entity in the 3GPP MNO network.
In addition to the functionality described in clause 6.5.2.1, the UFES can
perform the following functions:
\- provides remote identification and tracking information to TPAEs/USS/UTM
that may be monitoring a UAV, upon request from the TPAEs/USS/UTM. Per Civil
Aviation Authority regulation (e.g. FAA), The remote identification and
tracking information can include identification information of the UAV, UAV
controller, UAV pilot/operator, UAV pre-configured or historic flight path,
UAV and its UAV controller location and operation time information, UAV
operation status ( such as battery level if in auto-pilot mode), so on
\- support the USS in the 3GPP-assisted CAA-Level UAV ID assignment described
in clause 6.9.2.2.
#### 6.9.2.2 Functional Assumptions about the CAA-Level UAV ID for Remote
Identification
From a functional point of view, though the actual format of the CAA-Level UAV
ID is defined outside 3GPP and is not decided by 3GPP, it is assumed that the
CAA-Level UAV ID used for Remote Identification contains at least the
following information:
\- an identity unique to the UAV, which may preferably have temporary
validity: this identifies uniquely the UAV with the entity that allocates the
CAA-level UAV ID. The identity formats identified in the conclusions in clause
8 are supported: _Serial Number Identification_ , a _CAA-Issued Registration
Identifier (aka Session ID),_ and _USS/UTM-Issued UUID_.
NOTE 1: The details of such identity are defined outside 3GPP. Whether a
single identity is used, or a set of identities through which the UAV cycles
periodically (similarly to the V2X design) is FFS.
NOTE 2: Whether privacy or confidentiality requirements will apply to the
unique UAV temporary identity depends on regulations in various regions.
Solutions may be identified by SA WG3 or externally to 3GPP, as in the case of
V2X.
\- CAA-level UAV ID Routing Information, used by an entity attempting to
retrieve the UAV data (e.g. TPAE) to identify and address the appropriate
entity where to send the query. In solutions for UAV authentication and
authorization (e.g. solution 5 in clause 6.5), this is also used by functions
in the 3GPP system to identify the appropriate USS that serves the UAV. The
exact format of the CAA-Level UAV ID Routing Information is defined outside
3GPP, but the use is based on the USS Discovery description in clause 6.5.2.3.
#### 6.9.2.3 CAA-Level UAV ID assignment
Two potential types of CAA-level UAV ID assignment can be considered:
1\. USS-assigned CAA-Level UAV ID: the ID is assigned completely at USS level,
and uses one of the formats defined in clause 6.9.2.3.1.
2\. 3GPP-assisted CAA-Level UAV ID assignment: in this scenario:
\- the USS e.g. delegates to the UFES the role of \"resolver\" of the CAA-
Level UAV ID and return to an entity (e.g. the TPAE) querying information
about the UAV based on the CAA-Level UAV ID the UAV data that the UFES
retrieves from the USS.
\- The CAA-Level UAV ID is assigned by the USS with the support of
functionality of the 3GPP system. The USS decides the specific identity, and
the UFES may provide the \"CAA-level UAV ID Routing Information\" to enable a
resolver of the CAA-level UAV ID to resolve to the UFES, if such function is
delegated by the USS to the UFES.
\- In case of 3GPP-assisted CAA-Level UAV ID assignment, the UFES interacts
with the USS to allocates the UAV identities to be used for Remote
Identification (i.e. the CAA-Level UAV ID).
It has to be noted that a UAV is already aware of the different types of
identity that may be assigned by a USS, thus this solution does not require
further awareness of the UAV regarding which entity assigns the CAA-Level UAV
ID.
NOTE: It is assumed that the UAV is not aware of which assignment mechanisms
is used for the CAA-Level UAV ID.
##### 6.9.2.3.1 3GPP Assisted CAA-Level UAV ID Assignment
The solution for the specific scenarios of 3GPP Assisted CAA-Level UAV ID
Assignment considers the allocation to the UAV of a CAA-Level UAV ID by the
USS in collaboration with the UFES, for the use by the UAV for UAV
authentication and authorization with the 3GPP system and the USS, and for the
use for Remote Identification.
The CAA-Level UAV ID allows a TPAE to identify and address the network
function from which the UAV registration information with the civil aviation
authority (e.g. FAA) can be retrieved.
NOTE: It is assumed that the TPAE has authorization and security agreements in
place to be able to perform such retrieval. This is out of scope of 3GPP.
In particular, the CAA-Level UAV ID is used by the TPAE to identify a network
function that can \"resolve\" the CAA-Level UAV ID to the actual UAV
information, e.g. UAV serial number, pilot information, UAS operator, etc.
Such ID resolver receives the query from the TPAE, containing information
including the CAA-Level UAV ID, and identifies to which UAV the query relates.
When the UAV registers with the USS before registering to a 3GPP system, the
UAV operator provides information about the serving PLMN to the USS. In order
to allocated a CAA-Level UAV ID, the USS interacts with the 3GPP network if
3GPP Assisted CAA-Level UAV ID Assignment is desired, using a NEF/SCEF
service. The 3GPP network selects a UFES to respond to the USS, and the UFES
provides to the USS the CAA-Level Routing Information to enable an entity
attempting to resolve the identity received in a Broadcast Remote ID message
to address the UFES.
When the UAV registers with the 3GPP network and is authenticated/authorized,
or when PDN connectivity/PDU session is established for USS and/or C2
connectivity, the serving UFES provides the same information to the USS, and
the USS would use it if a new CAA-Level UAV ID is allocated.
In this option, the USS acts as the CAA-Level UAV ID resolver, but obtains the
routing information part of the CAA-Level UAV ID from the UFES, thus queries
from the TPAE are directed to the UFES.
#### 6.9.2.4 Resolution of UAV Identity for Broadcast Remote Identification
##### 6.9.2.4.1 USS-assigned CAA-Level UAV ID
If the CAA-Level UAV ID is assigned by an USS according to mechanisms and
formats defined in other standards, e.g. ASTM, then the CAA-Level UAV ID
resolution must be based on mechanism and network infrastructure solutions
defined outside of 3GPP.
If the USS assigns the CAA-Level UAD ID implementing mechanisms that can be
based on ProSe discovery concepts, then the identity resolution takes place as
in the case of 3GPP Assigned CAA-Level UAV ID or 3GPP Assisted CAA-Level UAV
ID Assignment.
##### 6.9.2.4.2 3GPP Assisted CAA-Level UAV ID Assignment
When the UAV performs a registration with the USS with the UFES involvement:
1\. The UE obtains the CAA-Level UAV ID from the USS, and uses the CAA-Level
UAV ID for Remote Identification messages.
2\. Monitoring entities (e.g. TPAE) use the CAA-Level UAV ID to identify the
\"resolver\" for the identity. This, depending on the format of the CAA-Level
UAV ID, may happen via DNS or other mechanism. Once the TPAE identifies the
network function to contact, it sends a query containing the CAA-Level UAV ID
to obtain the UAV information.
NOTE: Monitoring entities are entities, as defined e.g. in [2], entities that
monitor the Broadcast Remote Identification messages from UAVs, and do not
required to be assigned to a UAV or associated to a UAV.
#### 6.9.2.5 Applicability for Network publishing Remote Identification and
tracking
When 3GPP system is used to provide the network publish function for UAV
remote Identification as defined by the CAA, UFES can be used to coordinate
with UAV and the other 3GPP functions to provide UAV remote Identification and
tracking information to TPAE or USS/UTM.
In case of in the case of 3GPP Assisted CAA-Level UAV ID Assignment, it is
assumed that the mapping between USS assigned CAA-level UAV ID and the
associated 3GPP UAV ID is known and stored by the UFES after UAV being
authorized by the USS/UTM, via mechanisms defined in other solutions. If UFES
receives a remote identification and tracking query with the USS-assigned CAA-
Level UAV ID, the UFES uses the mapped 3GPP UAV ID to coordinate with
different 3GPP functions to collect the UAV remote identification and tracking
information. In addition, the UFES can retrieve aviation-level information
(e.g. pilot information, USS operator, etc.) from the USS to provide it to the
querying party (e.g. TPAE).
There are two ways for UFES to collect UAV\'s remote identification and
tracking information:
1\. Direct communication between UAV and UFES, such as using two-way
query/response communications between UFES and UAV to allow UAV to provide the
UAV remote Identification and tracking information, as well as the information
for networked UAV controller; or allowing UAV and network UAV controller
periodically send their remote identification information to the UFES. CAA-
Level UAV ID is used for the communication between UAV and UFES.
NOTE: The communication between UAV and UFES can be either Control-plane based
using NAS message with an aviation container which contains the UAV tracking
information and can be transparent to 3GPP system; or user-plane based which
UAV/network UAV controller communicate with UFES using internet-based
application level protocol via the data plane established for UAV.
2\. UFES uses existing 3GPP services, such as network exposure function or
LCS, to track the UAV and provide the information to TPAE or UTM per request.
UFES may use the mapped 3GPP UAV ID for the interaction with different 3GPP
functions.
### 6.9.3 Procedures
#### 6.9.3.1 Use of CAA-level UAV ID for Broadcast Remote Identification
This clause provides an example of how the CAA-Level UAV ID is used for
Broadcast Remote Identification.
Figure 6.9.3.1-1: Use of CAA-Level UAV ID For Broadcast Remote Identification.
1\. The UAV generates the following for Remote Identification broadcasting:
\- UAV Identification: this is the CAA-Level UAV ID which is expected to be
protected against spoofing (i.e. to avoid impersonation) and for
confidentiality (i.e. protected between the UAV and the UFES/USS), and
verifiable by the TPAE by querying the UFES/USS to retrieve the UAV
information (e.g. UAV Hardware ID, UAV Pilot, UAV Operator, etc.)
\- UAV Flight Information: this corresponds to dynamic flight information
(e.g. height, direction, speed, etc.), protected for spoofing and verifiable
by the received party (e.g. a TPAE or another UAV).
Editor\'s note: How the information in the RID broadcasting is protected is
FFS and shall be defined by SA WG3 or outside 3GPP.
2-3. Upon receiving the UAV Broadcast Remote Identification information, a
receiving entity (e.g. UAV) verifies the validity of the Flight Information,
and may use such information for e.g. collision avoidance.
4-5. Upon receiving the UAV broadcast Remote Identification information from
an UAV, the TPAE identifies the relevant UFES/USS using the CAA-Level UAV ID
as described in clause 6.9.2.4 and based on the CAA-Level UAV ID functional
assumptions.
6\. The TPAE discovers the UFES/USS address (e.g. via DNS if the UFES/USS
Routing Information is an FQDN), and requests information verification from
the UFES/USS by providing the information received in the Broadcast Remote
Identification information. In case of USS assigned CAA-Level UAV ID, the
query is routed directly to the USS. In the case of 3GPP-assisted CAA-Level
UAV ID assignment, the query is routed to the UFES which in turn interacts
with the USS, as needed, and retrieves the UAV information (UAV Hardware ID,
UAV pilot, UAV operator, etc.) and returns it to the TPAE.
#### 6.9.3.2 Remote identification and tracking for Unknown UAV (Unknown to
TPAE or UTM)
Figure 6.9.3.2-1: UAV Identity registration and allocation based on UAV
bootstrapping
1\. UAV conducts registration and data connectivity procedure with 3GPP
network. In this phase the 3GPP system and UFES will have this new UAV
identifier information (e.g. create an entry with mapping between the 3GPP UAV
ID and the CAA-Level UAV ID).
2\. UAV updates UFES with its remote identification information (e.g. if the
controller may be changed during the flight) as well as the operation status
information.
3\. UFES updates the record of UAV remote Identification information which is
stored in the UDM.
4\. TPAE queries (the query may reach UFES or USS depending on how TPAE is
setup, depending on specific deployments; if sent to USS, the USS forwards to
the UFESs of the MNOs serving UAVs registered with the USS) regarding the
remote identification information of an un-identified UAV in certain location.
5\. UFES sends Nnef_EventExposure_Subscribe (Location) to NEF.
6\. NEF sends Namf_EventExposure_Subscribe (Area of interest) to AMF. The
message includes a request for the identifier(s) of UAV(s) in the area of
interest.
7\. AMF sends Namf_EventExposure_Notify (3GPP UAV ID(s)) to NEF.
8\. NEF sends Nnef_EventExposure_Notify (3GPP UAV ID(s)) to UFES.
10\. UFES queries the latest stored UAV remote identification and tracking
information from UDM using the UE ID.
11\. UFES (directly or via USS) sends to the TPAE the UAV remote
identification, UAV location and tracking information including the CAA-level
UAV ID of the UAV in the queried location.
#### 6.9.3.3 Remote identification and tracking known UAV (TPAE or UTM has
some UAV identifier information)
Figure 6.9.3.3-1: UAV Identity registration and allocation based on UAV
bootstrapping
Steps 1-3 are same as previous procedure.
4\. TPAE sends query to UFES for remote Identification and tracking
information of the UAV with CAA-level UAV ID.
5\. UFES Maps the UAV Identifiers from TPAE to the 3GPP UAV ID.
6\. UFES obtains the UAV remote Identification information from UDM with 3GPP
UAV ID.
7\. UFES responses with TPAE with the UAV remote Identification and tracking
information.
### 6.9.4 Impacts on services, entities and interfaces
Editor\'s note: This clause lists impacts to services, entities and
interfaces.
## 6.10 Solution 10: Control Plane based Registration of UAV and issuance of
CAA-Level UAV Identity for Remote Identification and Tracking
### 6.10.1 Introduction
This solution addresses the key issue #2. This solution can be applied to
LTE/EPS with minimal changes.
For Remote Identification and Tracking, the UAV must use a unique CAA-level
UAV identity when it reports on such information as e.g. its current flight
status, its destination etc. This CAA-level UAV identity while identifying to
those who need to know who this UAV is, preserves the secrecy of its owner,
its UAV Operator, even the pilot and Controller of the UAV. The requirements
of such an CAA-level UAV identity can be found in FAA\'s proposed rule on
Remote Identification of Unmanned Aircraft Systems [2] and in ASTM F3411 -- 19
[11].
To be issued this CAA-level UAV identity, the UAV has to register to the
USS/UTM for autorization to operate in a Unmanned Aerial System. When making
such a request to register to the UTM, the UAV has to provide certain of its
characteristics e.g. make, model, serial number, engine manufacturer, type of
engine, number of engines, maximum takeoff weight, which are outside the scope
of 3GPP (e.g. see FAA\'s proposed rule on Remote Identification of Unmanned
Aircraft Systems [2], Clause \"A. Registration Under Part 47\"). None of such
characteristics need to be known to the 3GP system and in fact could be kept
transparent to the 3GPP system.
The 5GC is the medium between the UAV and the UTM (and vice versa). In this
solution, the 5GC acts as the \"go between\" receiving from the UAV and
passing to the UTM the UAV characteristics provided by the UAV as part of the
registration to the UTM. This \"go between\" is also done when UTM, once it
decides it can authorize the UAV to operate, issues the CAA-level UAV ID to
the UAV.In this solution, as these characteristics the UAV provides at
registration to the UTM is not determined or mandated by the 5GS, but rather
the UTM and by regulations such as those by the FAA, these characteristics of
the UAV is seen as a Classmark of the UAV. Further some of these UAV
characteristics might not of interest to the 5GS so this solution\'s proposal
of a UAV Classmark distinguishes that the charcateristics are particular for
the UAS feature of 3GPP.
This solution is not exclusive to the use case that the UAV (or the UAS) does
not yet have an CAA-level UAV ID. It could be that that an Assigned ID exist
for the UAS due to its issuance at point of sale /shipping or previous
registration with USS/UTM for UAS operations. If the UAV has a CAA-level UAV
ID when it triggers the 3GPP registration procedure, the UAV will provide that
CAA-level UAV ID in that registration procedure.
### 6.10.2 Functional description
#### 6.10.2.1 Applicability to 5GS
Figure 6.10.2-1: Procedure for registering to UTM for UAS operations and
issuance of CAA-Level UAV ID in 5GS
1\. UAV starts registration to 5GS by sending REGISTRATION_REQUEST. As part of
registering to 5GS, the UAV provides what a UE would provide when requesting
registration. In addition, the UAV will provide a UAV Classmark payload which
is transparent to the 3GPP RAN and CN functions, which contains UAS specific
characteristics, such as serial number of the aerial equipment (i.e. drone),
pilot\'s contact details, engine manufacturer, type of engine, weight class
etc, as determined by UTM and regulatory requirements, defined outside of 3GPP
and not in scope of 3GPP.
If the UAV already has a CAA-Level UAV ID, e.g. been assigned by USS/UTM to
UAV at point of sale, the UAV will provide that assigned CAA-Level UAV ID as
part of this 3GPP registration.
Through subscription checks, AMF determines that it is a UAV seeking to
register to 5GS and as this is an initial registration and AMF has no existing
context of this UAV in the AMF, the AMF decides to perform verification and
registration checks with the USS/UTM, i.e. AMF decides to contact USS/UTM for
verification because AMF has no context of this UAV. Such verification checks
with USS/UTM need not be done at registration update.
NOTE 1: It is not suggested here that each Registraion Request the 5GS
contacts the USS/UTM. For instance if it is a periodic Registration Update or
mobility updates where the 5GC already has the UAV context that includes the
CAA-Level UAV ID such interactions with USS/UTM are unnecessary.
2\. 5GC starts registration procedures as it does for a UE, re TS 23.502 [7],
clause 4.2.2. As part of the registration procedures of TS 23.502 [7], clause
4.2.2, authentication and security mode setting procedures can be performed.
The UAV Classmark is not used as part of the 5GC registration procedure.
2a. This aligns with step 9 of registration procedure given in TS 23.502 [7],
clause 4.2.2
2b. [optional] If the UAV/UE did not provided the CAA-Level UAV ID, the AMF
can invoke the identity request procedure to obtain the UAV\'s CAA-Level UAV
ID.
2c. [alternatively] As an alternative, a network can complete the 3GPP
registration procedure before proceeding with USS/UTM checks (which includes
authenctication and authorization).
3\. Having completed authentication and due to UE profile checks - such as
IMSI checks, 5G-GUTI checks, UE subscription checks -- 5GC is aware that a
USS/UTM registration check is needed and contacts USS/UTM via the NEF. With
the indication from 5GC to UTM that a UAV is seeking registration, the UAV
Classmark is provided to the UTM. The UAV Classmark need not be processed by
the 5GC.
4\. USS/UTM does its verification checks, and can decide to keep to the
existing CAA-Level UAV ID or issue a new CAA-Level UAV ID. These are outside
the scope of 3GPP. The CAA-Level UAV ID is used for Remote Identification and
Tracking purposes.
This step does not involve the USS/UTM triggering a secondary authentication.
This is expected to be a verification check of the UAV e.g. querying if
USS/UTM have context of this UAV, e.g. if the UAV provided CAA-Level UAV ID
and UAV\'s profile in given in the UAV Classmark ties up to USS/UTM\'s
records.
NOTE 2: Depending on the security solutions out of the control of 3GPP (i.e.
at USS level), the step may require multiple roundtrips between the USS and
the UAV via the 3GPP system.
4a. [not shown in Figure] The USS/UTM checks fails and USS/UTM will indicate
as such. It can also be that even if the USS/UTM checks pass the USS/UTM wants
to do another authentication check of the UAV involving the use of secondary
authentication procedure -- such secondary authentication procedures are not
disimilar to the UUAA of solution 5 -- and so indicate an appropriate value to
let the 3GPP system complete its registration procedure with the UAV and
follow up with a secondary authentication.
NOTE 3: What kinds of checks the USS/UTM does is out of scope of 3GPP.
5\. UTM provides the UAV\'s registration acceptance to the 5GC, providing
along with it the CAA-Level UAV ID.
NOTE 4: This solution does not preclude that USS/UTM can choose to indicate
acceptance to 5GC and later (e.g. after step 6) runs further secondary
authentication or UUAA related procedures towards the UAV, like in step 7 of
clause 6.5.3.1, for further or enhanced authenctiation and authorization of
the UAV.
5a. USS/UTM indicated that UAV has failed its registration/verification checks
and may provide a cause code for reason for failure.
6\. 5GC completes registration procedure by sending to UAV
REGISTRATION_ACCEPT. Along with what 5GC would send in REGISTRATION_ACCEPT,
the 5GC also includes the CAA-Level UAV ID that was proviode to 5GC by
USS/UTM.
The CAA-Level UAV ID can now be used to tag onto information that UAV needs to
provide as part of Remote Identification and Tracking required for UAS
operations.
In the case that step 2c is utilized, the 5GC will instead provide the CAA-
Level UAV ID to the UAV by UE Configuration Update message as 3GPP
registration has already completed.
6a. [Conditional] Operator can utilise network policy to decide if the UAV/UE
is allowed to stay registered under MNO subscription or that the UAV/UE is
told to deregister. If the UAV is allowed to stay registered, the UAV will be
informed by REGISTRATION ACCEPT (if step 2c is not utilized) but informed that
USS/UTM authentication/authorization has failed. If the UAV is not allowed to
stay registered, the UAV will be informed by REGISTRATION REJECT (if step 2c
is not utilized) with a reject cause code indicating failure to
verify/register to USS/UTM, or by DEREGISTRATION REQUEST (if step 2c is
utilized) with an indication that the deregistration is due to failure to
verify/register to USS/UTM.
NOTE 5: The Registration procedure proposed wherein at the completion of the
Registration procedurethe CAA-Level UAV ID is provide to the UAV, Is not
suggested that is the only way the CAA-Level UAV ID can be provided to the UAV
or UAVc or UAS. This CAA-Level UAV ID could be provide at point of
sale/purchase and is outside the scope of 3GPP.
In this solution, the USS/UTM is shielded by the NEF from any inter AMF
changes in 5GC. However, any inter AMF change need to be made known to the
NEF. This would require a new Namf or Nnef event service, which will be
determined in normative phase of work.
NOTE 6: In case of inter AMF change due to mobility in CM-IDLE or in
CM_CONNECTED, the procedures of TS 23.502, clause 4.2.2.2.2 and clause 4.9.1.3
respectively will be followed. The decision whether the target AMF will repeat
step 4 will be based on network and operator policies.
#### 6.10.2.2 Applicability to EPS
Figure 6.10.2.2-1: Procedure for registering to UTM for UAS operations and
issuance of CAA-Level UAV ID in EPS
1\. UAV starts an attach procedure to EPS by sending ATTACH REQUEST to the
MME. As part of the attach procedure to EPS, the UAV provides what a UE would
provide when requesting to attach. In addition, the UAV will provide a UAV
Classmark payload which is transparent to the 3GPP RAN and CN functions, which
contains UAS specific characteristics, such as serial number of the aerial
equipment (i.e drone), pilot\'s contact details, engine manufacturer, type of
engine, weight class etc, as determined by UTM and regulatory requirements,
defined outside of 3GPP and not in scope of 3GPP.
If the UAV already has a CAA-Level UAV ID, e.g. been assigned by USS/UTM to
UAV at point of sale, the UAV will provide that assigned CAA-Level UAV ID as
part of this 3GPP registration.
Through subscription checks, MME determines that it is a UAV seeking to attach
to EPS and as there is no existing context of this UAV in the MME, the MME
decides to perform verification and registration checks with the USS/UTM, i.e.
MME decides to contact USS/UTM for verification because MME has no context of
this UAV. Such verification checks with USS/UTM need not be done at tracking
area updating procedures.
2\. EPC starts the attach procedure as it does for a UE, re TS 23.401 [10],
clause 5.3.2.1. As part of the attach procedure TS 23.401 [10], clause
5.3.2.1, authentication and security mode setting procedures can be performed.
The UAV Classmark is not used as part of the EPC attach procedure.
2a. This aligns with step 5a of the attach procedure given in TS 23.401 [10]],
suclause 5.3.2.1.
2b. [optional] If the UAV/UE did not provided the CAA-Level UAV ID, the MME
can invoke the identity request procedure to obtain the UAV\'s CAA-Level UAV
ID.
2c. [alternatively] As an alternative, a network can complete the EPS attach
procedure before proceeding with USS/UTM checks (which includes
authenctication and authorization).
3\. Having completed authentication and due to UE profile checks - such as
IMSI checks, GUTI checks, UE subscription checks -- EPC is aware that a
USS/UTM registration check is needed and contacts USS/UTM via the SCEF. With
the indication from EPC to UTM that a UAV is seeking registration, the UAV
Classmark is provided to the UTM. The UAV Classmark need not be processed by
the EPC.
4\. USS/UTM does its verification checks, and can decide to keep to the
existing CAA-Level UAV ID or issue a new CAA-Level UAV ID. These are outside
the scope of 3GPP.The CAA-Level UAV ID, is used for Remote Identification and
Tracking purposes.
NOTE 1: Depending on the security solutions out of the control of 3GPP (i.e.
at USS level), the step may require multiple roundtrips between the USS and
the UAV via the 3GPP system.
4a. [not shown in Figure] The USS/UTM checks fails and USS/UTM will indicate
as such. It can also be that even if the USS/UTM checks pass the USS/UTM wants
to do its own authentication at application level i.e. application to
application by setting up a user plane and PDN connection, and so indicate an
appropriate value to let the 3GPP system complete its registration procedure
with the UAV and follow up with its authentication at application level
NOTE 2: What kinds of checks the USS/UTM does is out of scope of 3GPP.
5\. UTM provides the UAV\'s registration acceptance to the , providing along
with it the CAA-Level UAV ID.
NOTE 3: This solution does not preclude that USS/UTM can choose to indicate
acceptance to EPC and later (e.g. when pairing with UAVC is requested or
flight path authorization is requested) runs further UUAA related procedures
towards the UAV, like in step 7 of clause 6.5.3.2, for further or enhanced
authenctiation and authorization of the UAV.
5a. USS/UTM indicated that UAV has failed its registration/verification checks
and may provide a cause code for reason for failure.
6\. EPC completes the attachprocedure by sending to UAV ATTACH_ACCEPT. Along
with what EPC would send in ATTACH_ACCEPT, the EPC also includes the CAA-Level
UAV ID that was proviode to EPC by UTM.
The CAA-Level UAV ID can now be used to tag onto information that UAV needs to
provide as part of Remote Identification and Tracking required for UAS
operations.
In the case that step 2c is utilized, the EPC will instead provide the CAA-
Level UAV ID to the UAV by EMM Information message as attach procedure has
already completed.
6a. [Conditional] Operator can utilise network policy to decide if the UAV/UE
is allowed to stay attached under MNO subscription or that the UAV/UE is told
to detach. If the UAV is allowed to stay attached, the UAV will be informed by
ATTACH ACCEPT (if step 2c is not utilized) but informed that USS/UTM
authentication/authorization has failed. If the UAV is not allowed to stay
attached, the UAV will be informed by ATTACH REJECT (if step 2c is not
utilized) with a reject cause code indicating failure to verify/register to
USS/UTM, or by DETACH REQUEST (if step 2c is utilized) with an indication that
the detach is due to failure to verify/register to USS/UTM.
In this solution, the USS/UTM is shielded by the SCEF from any inter MME
changes in EPC. However, any inter MME change need to be made known to the
SCEF. This would require a new event indication between MME and SCEF, which
will be determined in normative phase of work.
NOTE 4: In case of inter MME change due to mobility in ECM-IDLE or in
ECM_CONNECTED, the procedures of TS 23.401 [10], clause 5.3.3 will be
followed. The decision whether the target MME will repeat step 4 will be based
on network and operator policies.
### 6.10.3 Impacts on services, entities and interfaces
The solution has the following impacts on existing entities:
\- AMF (for 5GS) and MME (for EPS):
\- Management of UAV subscription information and profile;
\- determining correct USS/UTM to contact and managing/processing the
information associated with this determination;
\- service interactions to NEF towards USS/UTM.
\- UDM (for 5GS) and HSS (for EPS):
\- UAV subscription information including any local configurations and SLA
associated with UAS feature.
\- NEF (for 5GS) and SCEF (for EPS):
\- Exposure and interface to UTM/USS;
\- A new service indication of AMF (MME) change to NEF (SCEF).
## 6.11 Solution 11: N**etwork publishing server and indication of UAS flight
authorization**
### 6.11.1 Introduction
This solution addresses the key issue #2. This solution can be applied to
LTE/SAE with minimal changes.
Within FAA\'s proposed rule on Remote Identification of Unmanned Aircraft
Systems [2] and in ASTM F3411 19 [11], it is suggested that the UAS has to
support two methods to provide remote identification and tracking information,
namely, (1) Direct broadcast; and (2) network publishing to an FAA-approved
internet-based database.
For the UAS to publish to this approved database, the UAS must know the
location, the address, of this database. Given that Remote Identification and
Tracking has to be done when UAS is performing flight operations, this
solution proposes that the address of the approved database for network
publishing be given to the UAS when the UAS sought and is given the
authorization for flight operations by the USS.
An added reason to provide the UAS with the address of the approved database
for network publishing database, is that there can be some considerable time
difference (even days or weeks) between the UAS having performed its
registration to USS to the time the pilot (of the UAS) wishes to perform
flight operations. What\'s more, in many countries with sizable land masses,
there may be more than one database for network publishing database. So
picking the one when USS gets the UAS request for authorization of flight
operations allows optimal choice of location of such database.
Given that the 3GPP system is not involved in the UAS\'s network publishing
functions, this solution proposes that the 3GP system need not be aware of the
address of the approved database for network publishing. However, as the 3GPP
system is involved in allocating radio resources to the UAS when in flight
operations, it is not just useful but necessary that the 3GPP knows that USS
has given flight authorization to the UAS. Thus in this solution, USS
indicates to the 3GPP system when USS grants the UAS authorization to perform
flight operations.
### 6.11.2 Functional description
The following are assumptions and pre-requistes:
\- The UAV has registered with the 3GPP system. This can be done for instance
by following the necessary steps indicated in the solution \"Registration of
UAV and issuance of Assigned Identity for Remote Identification and
Tracking\".
\- The UAV has registered with the USS and has obtained the CAA-Level UAV ID.
This can be done for instance by following the necessary steps indicated in
the solution \"Registration of UAV and issuance of Assigned Identity for
Remote Identification and Tracking\".
When the UAS wishes to engage in flight operations, the UAS contacts the USS
and request for authorization for flight operations. To enable such UAS -- USS
exchange the UE, using session management procdures of TS 23.502 [7], will
establish the user plane between UAS to 3GPP and over then over the data
network to the USS.
The USS will process the UAS\'s request for flight operations and if the USS
decides to grant authorization, the UAS will be informed of this. As part of
the authorization for flight operations, the USS can provide to the UAS the
location (or address) of the approved database for network publishing of
Remote Identification and Tracking informtion.
Separately, after providing authorization for flight operations to the UAS,
the USS will inform the 3GPP system that flight operations for the UAS has
been authorized. With this information, the 3GPP will be able to grant
resources to the UAS when the UAS in the course of its flight operations
request resources from the 3GPP system.
### 6.11.3 Procedures
Figure 6.11.3-1: Procedure for UAS flight authorization, indication of
database for network publishing and authorized flight operations
1\. The UAV/UE initiates a registration procedure to register to the 3GPP
system. This could be a standalone registration procedure as detailed in TS
23.502 [7], clause 4.2.2, or it can involve a linked procedure whereby the
3GPP system will extend that registration procedure toward sthe USS to obtain
USS registration of the UAV. An example of how this can be performed is given
in the Solution 6.10: \"Registration of UAV and issuance of Assigned Identity
for Remote Identification and Tracking \".
2\. The UAV is now registered to 3GPP (i.e 3GPP registered) and also
registered for UAS services with USS (i.e USS registered). With this the UAS
has a USS_Assigned_ID.
NOTE 1: There is no suggestion that step 2 always happens when step 1 happens.
For instance, for a registration update by the UAV/UE, contacting the USS is
not necessary.
NOTE 2 The time between step 2 and step 3 can be some time in between, maybe
even hours or even days.
3\. UAS wishes to perform flight operations and if the user plane resources
for UAS to contact UTM/USS is not available, the UE initiates session
management procedures of TS 23.502 [7], to establish connectivity with the
USS. Whilst the session mamangement procedures are part of the 3GPP system,
the intent of UAS using the allocated resources for flight authorization
request need not be made known to the 3GPP system.
4\. From UE subscription profile, the SMF knows it is a UAV requesting the
establishment of a PDU Session. The SMF is not aware what the PDU Session is
for but knows that it is a registered UAV requesting for a PDU Session.
The SMF interacts with NEF requesting notification of USS/UTM flight path
authorisation for that UAV. Other events such as USS/UTM authorisation to UAV
for UAV --UAVC pairing might also be requested too. It will be decided in
normative phase if this event request for the notification of flight
authorization is a new service event or a modification (additional) to an
existing service event.
The NEF identifies and discovers the USS/UTM through the available CCA-Level
UAV ID.
4a. NEF having discovered the relevant USS/UTM, subscribes to the USS/UTM to
notify the NEF whenever UAV\'s request for flight authorization is granted.
The specific UAV can be indicated in this request by using either the 3GPP UAV
ID or the CAA-Levl UAV ID following the conclusion of KI#1.
5\. Between the UAS and USS communication and information exchange is
performed over the user plane. The USS grants the UAS the authorization to
perform flight operations. This solution assumes that, along with that, the
USS provides the USS with the address (and location details) of the database
to which the UAS can publish flight information as part of Remote
Identification and Tracking.
NOTE 3: Step 5 is application level exchange and is transparent to the 3GPP
system.
6\. USS informs the 3GPP system that the UAV has been granted authorization
for flight operations. With knowledge of that authorization, the 3GPP system
knows the UAV is entitled to request 3GPP resouces as part of the flight
operations.
7\. NEF passes the notification to SMF that UAS flight operations has been
authorized. This can be used by SMF for decision making when UAV request
further session resources.
With the CAA-Level UAV-ID available to the 3GPP system and the SMF having the
UAV subscription profile / UE context and there knowing there is the CAA-Level
UAV ID will be able to associate that a request for PDU Establishment is by a
UAV. As the subscribe event services and notify event services can also be
linked to a UAV by its CAA-Level UAV ID, SMF thus know that certain UAVs have
been authenticated and authorized for flight operations.
When this solution is applied to LTE/SAE, the AMF will be replaced by the MME,
the SMF replaced by the PGW and the NEF replaced by the SCEF.
### 6.11.4 Impacts on services, entities and interfaces
The solution has the following impacts on existing entities:
\- SMF (for 5GS) and PGW (for EPS);
\- using UAV subscription information and profile to determine subscribing to
events;
\- new or added event service to and from NEF (SCEF);
\- NEF (for 5GS) and SCEF (for EPS);
\- Discovery of USS/UTM
\- Exposure and interface to UTM/USS.
\- New event subscribe and Notify to SMF (PGW) and USS/UTM.
## 6.12 Solution 12: Exposing Restricted Area for UAV Flight Path
Authorization
### 6.12.1 Introduction
This solution is for key issue #2: UAV authorization by UTM.
According to the service scenario of UAV, it is considerable to apply
different level of UAV authentication/authorization. The most fundamental
requirement is to support UAV authentication/authorization itself by 3GPP
network and UTM.
Knowing the network mobility restriction information for a specific area is
directly related with the successful and safe operation of UAV. If the UAV
network connectivity suddenly dropped, then the desired or planned operation
of UAV is impossible, and will be consequence into terrible accidents.
Meanwhile, it is also needed be considered that UAV can occur interference to
the normal ground located UEs (e.g. smartphone, car). To protect 3GPP network
from the interference, the preferred UAV operational area of MNO needed be
delivered to UTM/USS.
The objective of this solution is to expose mobility limitation information to
AF (USS/UTM), i.e. areas in which the UAV flight should not be authorized in
order to minimize the UAV impacts on other UE or to respect any other
limitations identified by the MNO based on local policies. By providing this
information, it is expected to enable a more precise definition of flight
paths for UAV operation by UTM/USS, in order to enable better coverage for C2
and Remote Identification connectivity.
### 6.12.2 Functional Description
The below is the principles of the solution:
\- A PCF have a list of mobility limitations information to protect network
from the interference occurred by UAV operations, or identifying areas in
which UAV connectivity for C2 during flight is not preferable or should be
forbidden. Note that this information contains forbidden area and non-allowed
area information, and may be preconfigured by the operator.
\- An NEF translates 5G representation of location (list of TAIs/cell IDs)
into a general representation (altitude, longitude, latitude)
\- UTM/USS authorizes/re-routes UAV flight path to avoid the area such as
requested non-allowed area for a successful UAV operation (this is out of
scope of 3GPP).
### 6.12.3 Procedures
For the procedure to provide network capability to AF (USS/UTM) is depicted in
figure 6.12.3-1.
Figure 6.12.3-1: procedure to provide network capability to AF (USS/UTM)
1\. An UAV request flight path authorization (out of scope of this solution).
2\. An UTM/USS request NEF to subscribe network capability information (e.g.
network coverage, and mobility limitations information). The request may
contain device type, departure time, flight path.
3\. (Optional) an NEF translate geographical representation of flight path
into list of TAIs/cell IDs. If UTM/USS have the information of TAI/cell IDs
deployment, this step could be skipped.
4\. An NEF subscribe PCF for network capability information with translated
request in step 3.
5\. An PCF derive mobility limitations information for a requested departure
time along with the flight path.
NOTE: An PCF can derive mobility limitations information using local policy as
described in Clause 5.3.4.1 of TS 23.501 [12].
6\. An PCF notify the network mobility limitations information to NEF.
7\. NEF translate the notification into geographical representation if
required.
8\. NEF notify UTM/USS with the translated notification by step 7.
9\. UTM/USS response the UAV about the flight path authorization by
considering network mobility limitations information. (out of scope of this
solution).
### 6.12.4 Impacts on services, entities and interfaces
PCF:
\- Need to derive Mobility limitations information).
\- Need to expose network capability to NEF.
NEF:
\- Need to translate geographical representation into/from list of TAIs or
cell IDs.
**\- Need to** expose network capability to UTM/USS.
## 6.13 Solution 13: Area of Interest for support of UTM\'s geofencing
### 6.13.1 Description
This is a solution for Key Issue #4 and 7.
This solution proposes the following principles:
\- Area of Interest mechanism is used for the area monitoring and notification
to support UTM/USS\'s Geofencing needs;
\- NEF exposes the UAV presence monitoring and report capability to UTM/USS
(i.e. for UAV moving in or out of the monitoring area), it\'s applicable when
the monitoring area is at coarse granularity. E.g. a whole city which assumes
can be mapped to 3GPP network area. It\'s not used for finer granularity
monitoring, e.g. take a highway road as the boundary. UTM/USS may decide to
use this capability e.g. when the Geofencing area is at coarse granularity.
It\'s also possible UTM/USS gets the UAV location by LCS and do the finer
granularity monitoring by the UTM/USS itself after the UTM/USS receives the
report from NEF about the UAV presence of a coarse granularity area. Whether
to use this capability offered by NEF is decided by UTM/USS. The UTM/USS logic
is out of 3GPP scope;
\- UTM/USS subscribes Area of Interest to AMF via NEF, the subscribed Area of
Interest is decided by the UTM/USS based on Geofencing area;
\- The subscribed monitoring area could be geographical information (e.g.,
longitude/latitude, zip code, etc), NEF will map it to 3GPP network area
information e.g. a list of TAs/Cell ids before sending it to AMF.
\- AMF performs monitoring of UAV presence in the subscribed area, i.e. UAV
moving in or out of a subscribed Area of Interest;
\- AMF reports the UAV presence in the subscribed area to the UTM/USS via NEF.
Then UTM/USS takes the decisions and triggers the appropriate actions
according to the received area monitoring results;
\- UTM/USS could indicate AMF via NEF to report the area monitoring results to
SMF, if UTM/USS preconfigures traffic routing policies at SMF, SMF is able to
take the appropriate network layer actions based on the area monitoring
result, i.e. without constant or repeated triggers/requests from UTM, the 3GPP
network can consider those policies as active and ongoing instructions from
UTM. The traffic routing policy includes 3GPP UAV ID(s) (e.g. GPSI or External
Group Identifier) to identify the UAV(s)/UAVC(s) and the corresponding network
layer actions e.g. revoke the resources of the related C2 communications.
NOTE: The solution does not propose that the 5GS concepts of Area of Interest
are extended to consider areas of interest defined by geographical
coordinates, it can be used if the monitoring areas provided by geographical
coordinates can be mapped to Area of interest defined by 3GPP network i.e.
TAI(s), Cell id(s) or (R)AN node id(s).
This solution applies to both 5GC and EPC. With reference to Figure 6.13.2-1,
in the case of EPC, the NEF is replaced by the SCEF and the AMF is replaced by
the MME.
### 6.13.2 Procedures
Figure 6.13.2-1 Geofencing based on Area of Interest
1\. UTM/USS decides the subscribed monitoring area, i.e. the area to be
monitored at 3GPP network. The decision is based on the Geofencing area known
to the UTM.
2\. UTM/USS provides the subscribed monitoring area to NEF. The subscribed
monitoring area could be geographical information (e.g., longitude/latitude,
zip code, etc), NEF will map it to 3GPP network area information e.g. a list
of TAs/Cell ids before sending it to AMF.
[optional] UTM/USS provides policies for the network layer actions to be
performed when the UAV moves in or out of the subscribed monitoring area. E.g.
revoke the connectivity between UAV and UAV controller, steering the traffic
toward/ from the UAV to UTM/TPAE for further analysis, etc.
NOTE: Which UAV ID is received from UTM/USS, and whether NEF needs to do the
UAV ID mapping follows the conclusion of KI#1.
3\. NEF reuse the Area of Interest mechanism as specified in TS 23.501 [12]
clause 5.3.4.4 to subscribe to the AMF, the monitoring area. If the UTM/USS
policies are received at step2, the NEF also provides the received policies to
SMF, and indicates AMF to report the area monitoring results to SMF.
4\. Determination of UE presence in Area of Interest is described in TS 23.502
[7] Annex D, clause D.1.
5\. AMF reports the UAV presence in the subscribed area, i.e. UAV moving in or
out of a subscribed Area of Interest to the NEF.
6\. [Conditional] If triggered by NEF to do so in step 3, the AMF also report
the UAV presence in the subscribed area, i.e. UAV moving in or out of a
subscribed Area of Interest, to SMF.
7\. [Conditional]If traffic policies have been forwarded by the NEF, the SMF
takes the appropriate network layer actions based on the area monitoring
result and the polices set out by UTM/USS policies, i.e. without constant or
repeated triggers/requests from UTM, the 3GPP network layer actions can
consider those policies as active and ongoing instructions from UTM/USS.
8\. NEF forwards the report from AMF of UAV moving in or out of the monitoring
area to UTM.
9\. UTM/USS decides the actions according to the received area monitoring
results. UTM/USS provides instructions to NEF if the network layer actions are
needed.
10\. UTM/USS may also perform application layer control for the UAV.
### 6.13.3 Impacts on services, entities and interfaces
\- Area of Interest mechanism is reused for the area monitoring and
notification to support Geofencing.
\- NEF do the mapping between the monitoring area and 3GPP network area.
\- If UTM/USS preconfigures some policies at SMF, SMF is able to take the
appropriate network layer actions based on the monitoring report from AMF of
Area of Interest. i.e. the policies are considered to be active instructions
from UTM.
## 6.14 Solution #14: UAV and UAVC tracking and flight route analysis
### 6.14.1 Introduction
This solution addresses KI#4: UAV and UAV Controller tracking:
\- What information is required for the 3GPP system to track the UAV and the
UAV Controller.
### 6.14.2 Functional Description
In this solution, UAVF is responsible to detect, identify and report the
problematic UAV and UAVC to UTM. UTM provides GPSI/MSISDN of UAV/UAVC to UAVF
for problematic UAV and UAVC report. The following cases are supported by
UAVF:
\- Whether UAV flies according to the pre-defined flight route: in this case,
UTM also provides UE trajectory to UAVF. The UAVF requests periodic location
information of GPSI/MSISDN from GMLC, compares the location with the
trajectory, if the UAVF detects that the UE location deviate the trajectory,
it notifies the UTM.
Editor\'s note: Whether there are other cases is FFS.
Editor\'s note: What information is included in UE trajectory and the trigger
for UAVF to report to the UTM is FFS.
### 6.14.3 Procedures
#### 6.14.3.1 UAV and UAV Controller tracking
Figure 6.14.3.1-1: UAV and UAV Controller tracking and flight analyses
1\. The UTM sends Flight route tracking request (GPSI/MSISDN, UE trajectory)
to UAVF. The UTM obtains UAV GPSI during UAV authentication and authorization
procedure which is described in the solutions for KI#2 and KI#3.
2\. The UAVF requests periodic UE locations from GMLC by invoking the Deferred
5GC-MT-LR for periodic events in clause 6.3.1 in TS 23.273 [8] (if GPSI is
received in step 1) or the Instigation and Reporting of Periodic and Triggered
Location in clause 9.1.19.1 in TS 23.271 [13] (if MSISDN is received in step
1).
3\. The UAVF analyses the UE location with UE trajectory.
4\. [Conditional] When UAVF decides that the UAV location deviate the UE
trajectory, it sends Flight route tracking response (deviation from trajectory
notify, deviation distance) to the UTM.
5\. Based on notification, the UTM may perform flight control, e.g. sends
warnings or updates flight route.
### 6.14.4 Impacts on services, entities and interfaces
UAVF:
\- Acts as LCS Client to collect UE locations from 3GPP system.
\- Receives UE trajectory from UTM.
\- Notify UTM when problematic UAV and UAVC is detected, e.g. when UAV
deviates from trajectory is detected.
UTM:
\- Provide UE trajectory to UAVF.
## 6.15 Solution #15: UAV and UAV Controller tracking based on LCS mechanism
### 6.15.1 Introduction
This solution addresses KI#4: UAV and UAV Controller tracking:
\- What information is required for the 3GPP system to track the UAV and the
UAV Controller.
### 6.15.2 Functional Description
This solution re-uses the LCS mechanism to provide positions of UAV and UAV
Controller to UTM:
\- UTM acts as a LCS Client to access LCS services from a GMLC.
\- UTM requests UAV and UAVC location from 3GPP system by invoking mobile
terminated location request procedure when flight authorization is received to
verify UAV and UAVC provided location.
\- UTM requests periodic UAV and UAVC location from 3GPP system by invoking
deferred mobile terminated location request procedure after the flight is
authorized to track UAV and UAVC locations.
\- UTM cancels periodic UAV and UAVC location reporting from 3GPP system when
the flight is finished.
\- UTM stores the mapping between UAV/UAVC ID and ID used in the 3GPP system
(i.e. 3GPP UAV ID). The mapping is obtained during authentication and
authorization procedure.
### 6.15.3 Procedures
#### 6.15.3.1 UAV and UAV Controller tracking in 5GS based on eLCS mechanism
Figure 6.15.3.1-1: UAV and UAV Controller tracking based on eLCS mechanism
0\. The AMF triggers UAV/UAV Controller authentication and authorization to
the UTM. In this step, the AMF sends the mapping between UAV/UAVC ID provided
by UAV/UAVC and 3GPP UAV ID to UDM. After step 0, the UAV/UAVC requests PDU
Session establishment. The UAV/UAVC ID is used for identification of UAV
towards the UTM and the TPAEs and is defined outside 3GPP. The 3GPP UAV ID is
described in solutions for Key Issue #1, #2 and #3.
1\. The UAV/UAV Controller sends Flight authorization Request (UAV ID, UAV
Controller ID, flight path, UAV location, UAV Controller location) to the UTM.
This message is sent via user plane and is out of scope for 3GPP.
2\. The UTM sends a LCS Service Request to GMLC to request UAV/UAVC location
from network. The request includes UAV/UAVC ID, the required QoS and other
attributes.
3\. This step is same as steps 2-23a in 5GC-MT-LR procedure in clause 6.1.2 in
TS 23.273 [8]. Once the location is received from the 3GPP system, the UTM
verifies the location information provided by UAV/UAV Controller.
4\. The UTM sends Flight authorization Response to UAV/UAV Controller.
5\. The UTM sends LCS Service Request to GMLC to request periodic location of
UAV/UAVC.
6\. This step is same as steps 2-30a in Deferred 5GC-MT-LR procedure in clause
6.3.1 in TS 23.273 [8]. The UTM receives the periodic location of UAV and
UAVC.
7\. UTM analyses the positions of UAV and UAV Controller, e.g. the UTM decides
whether the UAV is approaching no-fly zones.
8\. [Conditional] Based on the analyses in step 7, the UTM controls the flight
when necessary, e.g. sends warnings to UAV/UAV Controller or updates the
flight route when the UAV is approaching no-fly zones.
9\. When the flight is finished, the UTM sends LCS Cancel Location to GMLC.
10\. This step is the same as steps 2-12a in Cancellation of Reporting of
Location Events by LCS Client procedure in clause 6.3.3 in TS 23.273 [8].
#### 6.15.3.2 UAV and UAV Controller tracking in EPS based on LCS mechanism
The tracking procedure is similar with the procedure in clause 6.15.3.1 with
the following differences:
\- The AMF is replaced by MME.
\- The E-SMLC is involved in the positioning procedure but not the LMF.
\- Step 1: The MMF registers the mapping between UAV/UAVC ID and the 3GPP UAV
ID to HSS.
\- Steps 2 - 3 are same as the EPC Mobile Terminating Location Request
procedure in clause 9.1.15 in TS 23.271 [13].
\- Steps 5 - 6 are same as the Instigation and Reporting of Periodic and
Triggered Location in clause 9.1.19.1 in TS 23.271 [13].
\- Steps 9 - 10 are same as the LCS Client cancellation of a Deferred Location
Request for Periodic and Triggered Location in clause 9.1.19.2 in TS 23.271
[13].
### 6.15.4 Impacts on services, entities and interfaces
AMF: sends the mapping between UAV/UAVC ID and 3GPP UAV ID to UDM.
MME: sends the mapping between UAV/UAVC ID and 3GPP UAV ID to HSS.
GMLC: obtains the serving AMF/MME of UAV/UAVC from UDM based on the UAV/UAVC
ID provided by UTM.
## 6.16 Solution #16: Location Exposure to UTM/USS
### 6.16.1 Introduction
This solution addresses KI#4 and may be applied to KI#5.
This solution applies to both 5GC and EPC.
This procedure provides Location Exposure service to UTM/USS to enable UAV
location tracking, flight plan authorization, geofencing and geocaging.
### 6.16.2 Functional Description
The UTM/USS may subscribe to the 3GPP network on UAV geographical location
and/or its presence in a geographical area. The UTM/USS may subscribe location
reporting of the UAV or UAVC for one time or multiple times. A Unified
Location Service Exposure procedure can be applied, in which UTM/USS sends the
subscription request to NEF. The UTM/USS may look up the CAA-level UAV ID and
retrieve 3GPP UE ID (e.g. GPSI) and include the CAA-level UAV ID and 3GPP UE
ID together with the target geographical area in the subscription request
message to the NEF.
Editor\'s note: Whether the UTM/USS needs to use both the CAA-Level UAV ID and
the 3GPP UE ID in requests to NEF is FSS.
Editor\'s note: How the 3GPP UE ID, i.e. SUPI or GPSI (and in the case of
GPSI, what\'s format of GPSI is FFS), is known to the UTM/USS may also be
addressed in solutions for other KIs (e.g. KI#1 or KI#2), and whether they can
be adopted by this solution as well is FFS.
The NEF determines a NF service to perform further procedure based on the
expected QoS of the UAV geographical location or the granularity of UAV
presence in an area of interest:
\- When the expected QoS of the UAV geographical location or the granularity
of UAV presence in an area of interest is finer than cell id level, GMLC
service is invoked.
\- Otherwise, AMF service is invoked.
The UAV location estimation or UAV presence in an area of interest is notified
to the NEF by the GMLC or AMF, and then is forwarded to the UTM/USS. If
available, the NEF may also include the UAV-C\'s CAA-level UAV ID and 3GPP UE
ID in the location response message to the UTM/USS.
NOTE: In some deployment scenario where it is for certain that the finer than
cell id level granularity of location information is required and where the
UTM/USS is not deemed as an external party for event exposure (e.g. for
regulatory service), the UTM/USS can communicate with GMLC directly, bypassing
NEF, i.e. the GMLC based location service is used.
Editor\'s note: Whether the NEF needs to use both the CAA-Level UAV ID and the
3GPP UE ID in messages to UTM/USS is FSS.
If the UTM/USS has subscribed location reporting of the UAV or UAVC for
multiple times, e.g. for a deferred location request, the UTM/USS shall be
able to cancel the subscription, e.g. when the flight is completed.
### 6.16.3 Procedures
#### 6.16.3.1 General
In the procedure as described in clause 6.16.3.2 and clause 6.16.3.3:
\- UAV/UAVC performs as the UE.
\- UTM/USS performs as either NF/AF or external AF or external Client.
It is assumed that a UAV/UAVC UE shall always allow it to be located by
UTM/USS, thus the steps for LCS privacy checking are skipped.
This procedure applies to both 5GC and EPC. In case of EPC, the NEF is
replaced by SCEF, AMF is replaced by MME, LMF is replaced by E-SMLC and the
service based signalling is replaced by point to point signalling.
#### 6.16.3.2 Unified Location Service Exposure Procedure
Figure 6.16.3.2-1: Unified Location Service Exposure Procedure
1a. An external AF sends an LCS Service Request to an NEF in the HPLMN for a
target UE using an NEF API and includes an identification of the UE (e.g. SUPI
or GPSI) and details of the location request such as whether a current or last
know immediate location or a deferred location is requested, the location
accuracy and response time, the geographical area where UAV presence is to be
monitored and the UAV behaviour (e.g. moves in, out or stay in the area), LDR
request information and other information applicable to the type of request.
1b. As an alternative to step 1a, a consumer NF in the HPLMN for a target UE
invokes an Nnef_EventExposure_Subscribe service operation towards an NEF in
the HPLMN and includes a global identification of the UE (e.g. SUPI or GPSI)
and details of the location request as in step 1a.
2\. Based on the service requirements in step 1a or step 1b (e.g. location
QoS, granularity of the area of interest and whether an immediate or deferred
location is requested) and on the availability of GMLC versus AMF based
location service, the NEF determines whether the location request in step 1a
or step 1b can be mapped to a GMLC based location service or to an AMF
location event exposure service. The NEF determines to use whichever mapping
is supported or, when both mappings are supported, may employ implementation
or operator dependent procedures to make a choice. When a GMLC based location
service is determined, steps 3-7 are performed and steps 8-15 are omitted.
When an AMF location event exposure service is determined, steps 8-15 are
performed and steps 3-7 are omitted. If NEF determines the location request is
handled by AMF, it allocates an LDR reference number.
NOTE 1: The NEF may take the potential load to the system, e.g. AMF/UDM load,
or GMLC load, into consideration when deciding which location service to use,
or whether to reject the request from NF or AF. The NEF may also take into
account QoS. For example, when QoS accuracy exceeds cell ID, the GMLC location
service shall be used if available.
NOTE 2: When UE presence in an area of interest is subscribed, the granularity
of the area of interest is determined by how accurately the geographical area
received in step 1 can be mapped to the coverage of list of cell id, gNB id
and TAI, e.g. a mapping ratio threshold might be set for the determination.
3\. When a GMLC based location service is determined in step 2, the NEF
invokes an Ngmlc_Location_ProvideLocation Request service operation towards an
HGMLC in the HPLMN. The service operation may include all of the information
received from the AF or NF in step 1a or 1b.
NOTE 3: If it is requested to track UE geographical location in an area of
interest or UE presence in an area of interest of finer than cell id level
granularity, the NEF can first subscribe to AMF on UE presence in an area of
interest using AMF location event exposure service as described in steps 8-15,
and when receiving from AMF of notification on UE presence in the area of
interest, the NEF invokes GMLC service.
4\. For a request for an immediate location, the HGMLC performs steps 2-10 of
the 5GC-MT-LR procedure in clause 6.1.1 in the case of regulatory location or
steps 2-23 of the 5GC-MT-LR procedure in clause 6.1.2 in the case of
commercial location. For a request for deferred location, the HGMLC performs
steps 2-29 of the deferred 5GC-MT-LR procedure for periodic, triggered or UE
available location events in clause 6.3.1. If UE presence in an area of
interest is subscribed, the GMLC can:
\- either invokes deferred location procedure by providing list of cell id(s)
which covers the geographical area as well as the time interval for periodic
UE location notification.
\- Or first subscribes to AMF on UE presence in an area of interest using AMF
location event exposure service as described in steps 8-15, and then invokes
deferred location procedure.
5\. The HGMLC invokes the Ngmlc_Location_ProvideLocation Response service
operation towards the NEF to confirm the request in step 3 for a request for
deferred location or to return the UE location for a request for an immediate
location.
6\. If UE presence in an area of interest is subscribed, HGMLC determines if
UE moves in or out of the geographical area based on the received UE location
estimation result.
Editor\'s note: Currently the cell id level geofencing can be achieved by
configuring UE with the \"Area Event\" in a deferred location request. It is
FFS whether finer than cell id level geofencing can be performed by UE itself
when required based on UTM/USS location requirements (e.g. geographical area
with large cells and restricted fly zones smaller than the cell size). If not
or if the UE is not trusted to geofence its own location, it is FFS if the
geofence is in GMLC or AF (USS/UTM).
7\. If deferred location was requested in step 1, the HGMLC invokes one or
more Ngmlc_Location_EventNotify service operations towards the NEF, to convey
a single UE location in the case of deferred location for the UE available
event or to convey an indication of location activation in the UE followed by
one or more location event reports in the case of deferred location for
periodic or triggered location events. If UE presence in an area of interest
is subscribed, HGMLC notifies UAV behaviour (e.g. moves in, out or stay in the
area) to the NEF.
8-15. When an AMF location event exposure service is determined in step 2, the
NEF retrieves the serving AMF ID of the UAV from UDM and subscribes to AMF on
UE location estimate or UE presence in an area of interest. Steps 8-15 as
defined in clause 6.5.1 of TS 23.273 [8] applies.
16-17. Steps 16-17 as defined in clause 6.5.1 of TS 23.273 [8] applies. In
addition, the NEF may include CAA-level UAV ID in the messages to the AF.
Editor\'s note: Whether the NEF needs to include the CAA-Level UAV ID in
messages to AF is FSS.
#### 6.16.3.2 Procedure of Cancellation of Reporting of Location Events by the
UTM/USS
Procedure defined in clause 6.3.3 of TS 23.273 [8] applies.
### 6.16.4 Impacts on services, entities and interfaces
Editor\'s note: This clause lists impacts to services, entities and
interfaces.
This solution may have the following impacts to existing entities and
interfaces:
\- NEF/SCEF: Determines the granularity of the area of interest, and maps the
geographical area into list of cell id, gNB id and TAI. NEF/SCEF receives and
stores the CAA-level UAV ID and sends it to the UTM in location reporting
messages.
\- GMLC: Determines UE presence in an area of interest of finer than cell id
level granularity.
## 6.17 Solution #17: Network-Assisted UAV Verification and Monitoring
### 6.17.1 Introduction
This solution addresses Key Issue #2, #4, #5.
The solution defines a set of mechanisms to enable UAV to be authorized for
flight operation in the 3GPP system including tracking and identification once
the UAV is authorized by the UTM.
### 6.17.2 Functional Description
The solution considers the scenario where 5GS assists the UTM to authorize a
UAV for e.g. flight operation. Due to law enforcement, it is concluded that
UAV cannot take off without permission from authorized government agency (e.g.
UTM).
5GS either establishes link between UAV and UTM, which allows UTM to authorize
the UAV locally, or 5G NF execute verifications on behalf of UTM. In addition,
5G NF may provide the verification results and UAV behaviour information to
UTM for final authorization decision.
The following verifications are proposed to be executed by 5G network:
\- verify the location from where the UAV is taking off and reporting it to
USS.
In addition, the solution considers another scenario where 5GS assists the UTM
to monitor and track UAV flight behaviour. Specifically, after permitting UAV
to take off, UTM can subscribe to 3GPP system for the instant or periodic UAV
flight report that shall include the UAV flight behaviour information, such as
UAV position, historical trajectory of the current flight or monitoring events
notifications (e.g. loss of connectivity, UAV reachability). If detecting any
abnormal UAV flight behaviour based on the report provided by 3GPP system and
UTM local policy, UTM could, for example, take charge of UAV by sending the C2
communication to UAV immediately.
All air traffic management and knowledge of restricted or no-fly zones is
assumed to be in the USS, and the 3GPP system is not required to have
configuration or knowledge of air traffic management aspects.
### 6.17.3 Procedures
This procedure enables UTM to require 3GPP system to execute specific
verification regarding specific target UAV, such verification result can be
used by UTM as criteria to authorize UAV flight operation. Furthermore, this
procedure also enables UTM to request the 3GPP system to report UAV behaviour
information periodically for monitor and tracking purposes.
Figure 6.17.3-1: Procedure for Network-Assisted UAV Authorization & Monitoring
upon Flight Operations
1\. UAV register to network and is authorized as a UAV. The UTM might be
involved in the authorization procedure.
2\. UAV triggers and establish the PDU session with UTM for C2 communication.
NOTE 1: The PDU Session establishment can reuse current PDU Session
establishment procedure defined in clause 4.3.2.2 of TS 23.502 [7] or refer to
solution 5.
3\. When UAV is triggered e.g. by an upper layer application to take off, UAV
sends flight operation permission request to UTM via user plane of 3GPP
system. This request may include UAV identity, UAV current location, UAV
planned trajectory, etc.
NOTE 2: Step 3 is outside the scope of 3GPP.
4\. UTM sends the Nnef_ProvideLocation Request to NEF to request 5GS to
execute specific verifications regarding to target UAV, such as verify whether
the UAV taking off site is within a restricted zone or not. This request may
include the UAV identity, UAVC identity, UAV current location, and also
indicate which verification type core network is requested to execute.
5\. The NEF forwards the request to UCF.
6\. After receiving the request, the network shall conduct the verification
procedure as requested by UTM regarding to target UAV, such as obtaining the
location information of UAV and corresponding UAVC by following the Location
Procedures defined in TS 23.273 [8].
7\. UCF transfer the verification results or some other UAV flight behaviour
information (e.g. UAV position) obtained in step 6 to NEF.
8\. NEF forwards the verification results or other requested UAV flight
behaviour information to UTM.
9\. UTM evaluates the flight permission request sent by UAV based on the
verification results or UAV flight behaviour information provided by the
network and local policy, and then returns the flight permission response to
UAV via user plane of 3GPP. Receiving information regarding the UAV location,
the USS can verify e.g. if the UAV is within a restricted zone. If UAV does
not get flight permission from the UTM, step 10 to step 16 are skipped.
10.If the UTM authorizes the UAV to take flight in step 9, UTM shall send
Nnef_EventExposure_Subscribe request to the NEF to subscribe for the UAV
flight report, this request shall indicate what UAV flight behaviour
information required by UTM, such as UAV position, historical trajectory or
monitoring events notifications (e.g. Loss of Connectivity, UE reachability).
11\. NEF invokes the Nnef_EventExposure_Subscribe Request to UCF for
subscribing the UAV flight status report required by UTM.
12\. UCF acknowledges the execution of the subscription to NEF.
13\. NEF acknowledges the execution of the subscription to UTM.
14\. Core network periodically monitors the UAV flight status e.g. UAV
position, historical trajectory or subscribed monitoring events (e.g. Loss of
Connectivity, UE reachability)as requested by the UTM.
15\. UCF invokes the Nnef_EventExposure_Notify to NEF to transfer the UAV
flight report, this report includes the information requested by the UTM.
16\. NEF forwards the UAV flight report to UTM.
17\. After receiving the UAV flight report provided by core network, UTM shall
evaluate the UAV flight behaviour based on the local policy or criteria, if
detecting any UAV abnormal behaviour, UTM may, for example, take over the UAV
control immediately by C2 communication with UAV.
NOTE 3: Step 17 is outside the scope of 3GPP.
### 6.17.4 Impacts on services, entities and interfaces
UE side:
\- Application layer needs to be enhanced to support the fight authorization
by UTM.
5GC side (UCF):
\- 5GC needs to support the network-assisted UAV flight verification and
flight behaviour monitor procedures.
## 6.18 Solution #18: Handling of PDU session established by UAV
### 6.18.1 Introduction
This solution addresses Key Issue #5.
The solution defines a set of mechanisms to enable 3GPP and UTM to handle UAV
in the case of failed (re)authorization or revocation of authorization by the
UTM(i.e. KI#5).
NOTE: In this release, if required, dedicated DNN is enough for UAVs to
establish PDU sessions used for C2 communication.
### 6.18.2 Functional Description
Figure 6.18.2-1: Overview of user connectivity
Figure 6.18.2-1 shows the scenarios where UE may build user connectivity with
UTM (Connectivity A), UAV controller (Connectivity B), or third application
server (Connectivity C) simultaneously. There is no restriction on whether
Connectivity A and B and C are in the same DN or different DNs, and whether
are belonging to the same PDU session or different PDU sessions.
For authorization aspect, UTM don\'t have to be aware of specific information
on PDU sessions/QoS flows to some other entities (third part AS or UAV
controller), if authorization failed by UTM, UTM can trigger the PDU session
modification or PDU session release procedure by providing necessary
information which can be dedicated DNN of UTM, combination of DNN and S-NSSAI
of UTM, or traffic filtering information (e.g. 5 Tuple) identifying the
traffic flow to UTM, regarding as an allowed list by 5GC.
When 5GC receives the allowed list mentioned above, whether existing PDU
sessions or QoS flows are in the allowed list or not will be checked and
corresponding PDU sessions or QoS flows outside the allowed list will be
released or blocked by performing PDU session release or PDU session
modification procedure.
### 6.18.3 Procedures
#### 6.18.3.1 UTM Initiated PDU Session Release
When the UTM initiates a PDU Session Release then the steps for UE or Network
Initiated PDU Session Release, as described in TS 23.502 [7] clauses 4.3.4.2
or 4.3.4.3 are followed with the following exceptions:
\- The trigger for release (step 1 options in both examples) comes from the
UTM.
\- UTM shall provide necessary information (e.g. dedicated DNN of UTM,
combination of DNN and S-NSSAI of UTM, or traffic filtering information (e.g.
5 Tuple) identifying the traffic flow to UTM) to 5GC, regarding as an allowed
list.
\- When 5GC receives the allowed list mentioned above, whether existing PDU
sessions are in the allowed list or not will be checked and corresponding PDU
sessions outside the allowed list will be released.
\- Once the PDU Session release has completed the UTM is informed of the
result of the PDU Session release.
#### 6.18.3.2 UTM Initiated PDU Session Modification
When the UTM initiates a PDU Session Modification then the steps for UE or
Network Initiated PDU Session Modification, as described in TS 23.502 [7]
clauses 4.3.3.2 or 4.3.3.3 are followed with the following exceptions:
\- The trigger for modify (step 1 options in both examples) comes from the UTM
by providing MNO with the IP address of UTM.
\- UTM shall provide necessary information (e.g. dedicated DNN of UTM,
combination of DNN and S-NSSAI of UTM, or traffic filtering information (e.g.
5 Tuple) identifying the traffic flow to UTM) to 5GC, regarding as an allowed
list.
\- When 5GC receives the allowed list mentioned above, whether existing QoS
flows are in the allowed list or not will be checked and corresponding QoS
flows outside the allowed list will be released or blocked.
\- Once the PDU Session modification has completed the UTM is informed of the
result of the PDU Session modification.
### 6.18.4 Impacts on services, entities and interfaces
\- 5GC needs to be enhanced to support UTM Initiated PDU Session
Release/Modification procedures.
\- UTM/USS is required to be aware of a network operators PDU session
parameters (e.g. DNN, S-NSSAI, etc.).
## 6.19 Solution #18: USS/UTM triggered C2 communication authorization
revocation
### 6.19.1 Introduction
This solution addresses Key Issue #5, i.e.:
\- How is UAV handled in the case of revocation of authorization by the UTM,
considering handling of UAV connectivity with UAV Controller and expected UAV
behaviour.
### 6.19.2 Functional Description
The solution describes how authorization for C2 communication is revoked
following a request from the USS/UTM to the 3GPP network. This solution
considers that for public safety reasons, 3GPP network and USS/UTM need to
ensure a controlled revocation of authorization for connectivity resources
used for C2 communications. For example, the removal/interruption of C2
communications between an airborne UAV and an initial controller can only
proceed on the condition that an alternative C2 communication has been
established with another controller.
The UAV and the UAV-C(s) may be served by the same or different PLMNs and the
solution is applicable to both EPS and 5GS network.
The main building blocks of the solution are:
1\. **Revocation of Authorization triggering** : UTM sends an authorization
revocation message to UAV\'s serving PLMN. For example, the revocation of
authorization may be for C2 connectivity used with an initial controller and
can be triggered following a successful switch of the C2 communications to
another controller. When applicable, the UTM sends a similar message to the
PLMN serving UAV-C.
2\. **Revocation of C2 connectivity authorization: the PLMN serving UAV
initiates the release of the network resources used by UAV for the C2
communication based on an indication from the UTM. The UTM may provide an
explicit reason for the revocation (e.g., C2 switch over successful, UAV
mission complete). Based on operator policy, PLMN may also perform** other
(safety) checks (e.g., alternate PDU Session being used for C2 communications,
UAV location on the ground and/or altitude) before proceeding with the release
of the connectivity resources that have been revoked. When applicable, the
same operation is performed in the PLMN serving UAV-C.
### 6.19.3 Procedures
Figure 6.19.3-1: Procedure for C2 communication switching for change of UAV-C
0\. UAV is performing C2 communication with a UAV-C#1.
1\. UTM determines that C2 communication used by UAV is to be revoked. For
example, this may be triggered following a successful switch of the UAV
control from a first controller to another controller.
2\. UTM sends an authorization revocation message to UAV\'s serving PLMN
indicating the cause (e.g., UAV control switched). The message includes the
UAV UE id, the UAS id#1, and the UAV transport address (e.g., PDU session IP
address) to be revoked. Where UAS id is a temporary CAA-level UAV id allocated
by USS/UTM (see solutions for KI#1,2,3).The UAV UE id and PDU Session IP
address have been provided by PLMN1 to UTM during a prior C2 communications
establishment procedure (e.g., as per \"Solution #21: Connectivity setup for
C2 communication and association between UAV and UAV\").
Editor\'s note: How the cause for authorization revocation is used in the 3GPP
system is FFS.
Editor\'s note: The details of what information the UTM provides to PLMN for
authorization revocation is FFS.
3\. PLMN1 (e.g., SMF) initiates the release of indicated PDU Session/PDN
Connection. Optionally and based on operator policy, PLMN1 may perform
additional checks before proceeding with the release of C2 communications
(e.g., another PDU Session is being used to control the UAV). The cause IE in
the PDU Session release message indicates an authorization revocation.
4\. PLMN1 acknowledges the authorization revocation message.
### 6.19.4 Impacts on services, entities and interfaces
Editor\'s note: This clause lists impacts to services, entities and
interfaces.
## 6.20 Solution 20: UAV and UAVC Association and Connectivity Control Using
Secondary Authorization
### 6.20.1 Introduction
This solution is for Key Issue #6: UAV controller and UAV association.
One of the UAS requirements is controlling the connectivity between UAV and
UAV controller based on their association status. While the basic paring
procedures between UAV and UAV controller may be performed using, e. g., on-
site direct communication, their mutual association for UAS service needs to
be authorized by the USS/UTM to enforce the permitted usage and related
regulatory requirements.
A UAV UE or a UAV controller UE may communicate with the USS/UTM to request
authorization of its association with the corresponding party, using 3GPP or
non3GPP communication. Further, it can be assumed that the authorization of
association may be performed during the UAS registration of the UAV UE or a
UAV controller UE, or using a separate procedure defined for the purpose. The
details of the authorization of association and the UAS registration protocol
is defined between a UAV UE and the USS/UTM in the application layer and is
out of scope of 3GPP.
When a UAV UE is attached in the 3GPP network, the registration and
association status of the peer UAV or UAV controller UE is used in determining
initiation of PDU session establishment procedure at the UAV (controller) UE
as well as authorizing the requested PDU session at the network. That is, if
the UAV UE starts PDU session establishment procedure for communication with a
paired UAV controller that is not yet registered or associated, the PDU
session should not be allowed by the network. Otherwise, the resources for the
network and the UE will be wasted. When the UAV or UAV controller is
registered and authorized for the association by the UTM, the counter party
and the 5G network needs to be informed appropriately.
### 6.20.2 Functional Description
In the solution, a UAV and a UAV controller UE performs UAS registration in
the USS/UTM to get authorized for UAS service. The UAS registration procedure
may be performed before UE\'s registration with the 3GPP network using a
non3GPP networks connectivity. The UAV and the UAV controller are required to
perform authentication and authorization with USS/URM when they complete
initial registration in the 3GPP network.
The UAV and the UAV controller UE provide information on its desired counter
party UEs to the USS/UTM during the UAS registration.
A UAV or a UAV controller initiates a PDU session establishment with DN
authorization towards the USS/UTM to request authorization of association with
a counter party UE selected from the received list.
The USS/UTM evaluates and sends the allowed list of counter party UEs (among
the available UEs) to the UAV and the UAV controller UE.
The USS/UTM informs the counter party UE of the association request and
triggers the PDU session establishment by the counter party UE.
The USS/UTM delivers the IP addresses of the UAV and the UAV controller UE to
the 3GPP network to request update of the PDU sessions.
The USS/UTM provides an activation signalling for UAS communication to the UAV
and the UAV controller UE when it receives completion of resource setup from
the network or the two UEs.
### 6.20.3 Procedures
Figure 6.20.3-1: UAV-UAV controller association and C2 communication setup
1\. A UAV Controller UE performs initial registration in the 3GPP network and
establish a PDU session for communication between the UAV Controller and the
USS/UTM.
2\. The UAV Controller UE performs UAS Registration with USS/UTM using
application layer signalling to get authentication and authorization for the
UAS service, if it has not registered in the USS/UTM. It is assumed that the
UAV may also include information on its counter party (UAV controller) UEs in
the Registration signalling message. The UAS registration is replaced by a
notification of network connectivity change towards the USS/UTM if the UAV
Controller UE is already registered in the USS/UTM.
NOTE: The details of such information exchange at application layer are out of
scope of SA WG2.
3-4. The UAV UE performs the same procedures as described in step 1-2 for the
UAV Controller UE.
5\. The UAV UE initiates a PDU Session Establishment with DN authorization
procedure to request USS/UTM authorization on association with the UAV
Controller UE.
6\. The UAV UE provides the UAV Controller UE ID to the USS/UTM during the
authorization procedure. The authentication/authorization procedure may be
simplified just to handle association authorization. Upon successful
authorization, the USS/UTM provides the counter party UE ID to the network for
use in connectivity control.
7\. The UAV UE receives a PDU Session Establishment Response message from the
3GPP network for communication with the selected counter party UE.
8 The 3GPP network provides the IP address of the UAV UE to the USS/UTM.
9\. The USS/UTM sends an application signalling to the counter party UE to
trigger the PDU Session Establishment. The message includes the initiating UAV
UE ID.
10\. Same DN authorization procedure as for step 5-8 is performed for the UAV
Controller UE. The USS/UTM receives the IP address of the UAV Controller UE
from the 3GPP network.
11-12. The USS/UTM sends a UAS Association Update message to the 3GPP network,
in which a UAV UE (or UAV Controller UE) is registered, to deliver the IP
addresses of the UAV controller UE (or UAV UE, respectively).
13-14. The 3GPP network performs the PDU session modification procedure to
update packet filter information for UAS communication. The UAC and UAV
controller start UAS communication.
### 6.20.4 Impacts on services, entities and interfaces
The following changes on UAV (Controller) UE and 3GPP Network are assumed to
be required in the solution:
\- UAV UE and UAV Controller UE are required to:
\- Support registration with USS/UTM when they are connected to 3GPP networks.
\- Supports secondary authorization procedure for authorization of association
with corresponding UAV (Controller) UE, during PDU Session Establishment for
C2 connectivity.
\- 3GPP Network is required to:
\- Support secondary authorization procedure with USS/UTM
\- Support an interface and protocols to perform UAS association update
signalling
## 6.21 Solution #21: Connectivity setup for C2 communication and association
between UAV and UAV-C
### 6.21.1 Introduction
This solution addresses Key Issue #6 and #7, i.e.:
\- How are an UAV and an UAV-C associated as an UAS and how do the UAV and
UAV-C receive the UAS association information?
\- How does the UAV or UAV-C establish dedicated UP connection (UAV3 or UAV5)
for C2 communication between each other?
### 6.21.2 Functional Description
This solution assumes that the UAV and the UAV-C have established User Plane
paths (UAV9) with the USS/UTM and have successfully been authenticated and
authorized by the USS/UTM for UAV operations (based on KI#1,2 and 3
solutions).
The UAV and the UAV-C may be served by the same or different PLMNs and the
solution is applicable to both EPS and 5GS network.
The following UAS related identifier definitions are used:
**\- UAV Permanent Id (UPID):** this corresponds e.g. to a manufacturer H/W
id, serial number. It is used as a long-term identifier for UAV authentication
along associated credentials (e.g., certificate).
**\- UAS Temporary Id (UTID):** allocated by USS/UTM after successful UAV
authentication and authorization by USS/UTM or following successful pairing
authorization by USS/UTM of UAV with UAV-C. The UTID (e.g., corresponds to FAA
Session ID) may be used for UAS remote identification and tracking. UTID is
assumed to be a pseudonym, i.e., different from UPID for privacy protection
reasons, unless otherwise mandated by local regulations. The UTID is assumed
to be CAA Level ID. The same UTID may be shared between a UAV and UAV-C pair
forming a UAS, or UAV and UAV-C may have separate UTIDs.
The main building blocks of the solution are:
1\. **Association Triggering:** The association between the UAV and the UAV-C
is triggered by the UAV or UAV-C issuing an Association Request to the USS/UTM
(application layer signalling). The Association Request may contain the peer
device identifier (e.g., UPID). Alternatively, the USS/UTM may detect that
both the UAV and UAV-C are present in the network and may trigger the
association procedure according to its internal logic (e.g., based on online
presence and \"ready\" operational status). If available, a preferred or
desired peer device identifier may be provided by UAV or UAV-C to USS/UTM
during a prior Authentication and Authorization by USS/UTM phase.
2\. **Association authorization:** the USS/UTM checks certain information to
authorize the association. For example, the USS/UTM may check that UPID
requested by UAV-C above corresponds to an authorized and available UAV and
the UAV\'s owner/pilot certificate matches that of the UAV-C. If the
association request is authorized, the USS/UTM allocates a UTID identifying
the UAV-UAV-C pairing and informs the UAV, the UAV-C and their serving network
about the association information, such as the UTID. Association authorization
by USS/UTM is enabled to fulfil the service requirements of association and
authorization to operate i.e. respectively [R-5.1-001] and [R-5.1-010] from TS
22.125 [5]. These requirements imply that the network should not authorize C2
traffic with any random UAV-C but strictly with the one that is successfully
paired with the UAV.
3\. **UP path establishment for C2 communication:** both UAV and UAV-C
initiate the UP connection establishment (e.g. PDU Session establishment) for
C2 communication with their serving network upon being informed that an
association is authorized by USS/UTM. The UP connection establishment may
include the indication that the establishment request is for C2 communication
and may include the associated UTID. When the UP connection is successfully
set up, the serving network may update the USS/UTM with trusted UP connection
information such as the transport information for C2 communication, e.g. IP
address. At this point the UP connections are ready but the UAV or UAV-C
can\'t exchange C2 communication over it yet, they need to wait for further
USS/UTM authorization for C2 communication (e.g., obtain peer IP address after
authorization of flight plan).
If the UAV or UAV-C has previously established UP connection for UAV
operations (e.g. connectivity to UTM/USS for authentication), the UAV or UAV-C
may use the existing UP connection (with potential modification) for C2
communication. If the UAV-C is non-networked UAV-C, the UP connection
establishment for C2 is not needed.
In another alternative, the UE may pre-establish limited UP connections before
the UAS association is requested and authorized.
4\. **C2 communication authorization:** when the UP connections of the UAV and
UAV-C are established, the USS/UTM may authorize the C2 communication and
notify the UAV, UAV-C and their serving network (e.g., provide respective peer
IP address). Upon this authorization, the serving network may modify the UP
connection to make it fully functional for C2 communication. The UAV and the
UAV-C can start exchanging C2 communication after this authorization.
The definition of phases above for pairing and controlling of connectivity
between UAV and UAV Controller is needed to support various operational
scenarios. For example, the UAV and UAV-C may come online and be authorized by
USS/UTM at different times. In another scenario, it may be necessary to enable
pairing and limited connectivity before a flight plan is finally submitted and
authorized by USS/UTM to enable IP connectivity for C2 communication.
NOTE: A UAV-C may control multiple UAVs. For each UAV/UAV-C pair, the same
procedure described here may apply.
### 6.21.3 Procedures
In the procedure, it is assumed that the UAV and the UAV-C are served by the
same USS/UTM via different PLMNs which could be either EPC or 5GC. It is also
assumed that the UAV and the UAV-C has successfully registered with the 3GPP
network and established UP connectivity with the USS/UTM.
Figure 6.21.3-1: Procedure for UAV/UAV-C association and C2 communication path
setup
1\. The UAV and the UAV-C perform authentication and authorization procedure
with the USS/UTM. After successful authentication and authorization, the
USS/UTM maintains a context for the UAV and UAV-C respectively which may
contain their identifiers, such as UAV UE ID (3GPP identifiers) and UPID (e.g.
drone serial number). Note that UAV-C may not be connected through a PLMN and
in that case the PLMN related procedures described here on the UAV-C side may
not be needed.
If the UAV or UAV-C has been previously authenticated and authorized for UAV
operations, this step is not mandatory each time for establishing C2
communication.
2\. The UAV-C initiates an Association Request and indicates the peer UPID in
the request. Other information such as flight plan information may be
submitted at this time or at a later stage.
3\. The USS/UTM checks whether the association request can be authorized, e.g.
by checking whether the owner certificates match each other. If the
association request is approved, the USS/UTM allocates a UTID for the
associated UAV and UAV-C respectively.
4\. The USS/UTM sends an association notification message to the serving PLMNs
of the UAV and UAV-C. The USS/UTM may have stored the information of the UAV
or networked UAV-C\'s serving PLMN during the previous UAV
authentication/authorization procedure. The notification message may contain
the UAV/UAV-C UE ID and the allocated UTID of UAV or UAV-C. If the UE has
already established the UP connectivity for UAV operation (e.g. for
communication with UTM), the PLMN may modify the existing UP connection to
enable it for C2 communication. In this case, Step 6 is optional.
5\. The USS/UTM may also send an association notification message to the UAV
and UAV-C via user plane. The network may forward the association information
message (including UTID) to the UE via control plane signalling.
6\. Upon receiving the association notification, the UAV and the UAV-C may
initiate UP connectivity setup for C2 communication. The APN or DNN used for
the connectivity establishment may be dedicated for C2 communication and
configured in the UE (e.g. via URSP rule). In the connectivity request the
UAV/UAV-C may indicate the connectivity is used for C2 communication and
include the associated UTID. The serving network may accept the connectivity
establishment but may indicate to the UAV and UAV-C that the connectivity is
limited pending further authorization.
7\. The serving PLMNs acknowledge the association notification to the USS/UTM
and may inform the USS/UTM of the established UP connectivity info for C2
communication, such as the transport address (UAV/UAV-C IP addresses). The
transport addresses of the UAV(or UAV-C) will be forwarded by the USS/UTM to
the serving network of its peer-device (in Step 8), for the network to set up
proper forwarding rules; or forwarded to the application in the peer-device
(in Step11). Also, the IP address received from the network is considered
trusted by USS/UTM as opposed to if it was send directly by the UAV. The
serving PLMN provides the UTID to the USS/UTM for the latter to retrieve the
corresponding UAV context. In the case of networked UAV-C the UTID may be used
to further locate the specific UAS context, as the UAV-C may control multiple
UAVs simultaneously.
8\. The USS/UTM updates the UAS context with the received UP connectivity info
(e.g. peer transport addresses) for C2 communication.
9\. At this point, the USS/UTM may authorize the C2 communication between the
UAV and UAV-C and send a notification message to the UAV and UAV-C\'s serving
PLMNs. Based on the UAV IP addresses received in the message, the network may
set up proper forwarding rules to enable UAV/UAV-C communication.
10\. The UAV and UAV-C\'s serving PLMNs may modify the UP connectivity to make
it fully functional for C2 communication.
11\. The USS/UTM may optionally send an application layer notification via
user plane to the UAV and UAV-C to inform them that they are now authorized
for C2 communication. The application layer trigger may be used by USS/UTM to
synchronize when UAV and UAV can start sending C2 traffic.
12\. The UAV and UAV-C may now start exchanging C2 communication.
### 6.21.4 Impacts on services, entities and interfaces
The solution has the following impacts on existing entities and interfaces:
\- UDM/HSS:
\- Additional subscription information related to the UAV.
\- AMF/MME:
\- Handle subscription information for UAV.
\- Handle information from UTM/USS for association authorization and C2
communication authorization.
\- SMF/MME/PGW-C:
\- Handle dedicated APN/DNN for UAV communication.
\- Handle UAV communication indication in connectivity establishment request:
\- Modify the UP connectivity to enable C2 communication.
## 6.22 Solution #23: UAV identification and authentication by RID USS
### 6.22.1 Introduction
The paper provides solutions to KI #1, #2 & #5 that are applicable for both
5GC and EPC.
### 6.22.2 Functional Description
#### 6.22.2.1 Assumptions
The solution is based on some key assumption with respect to the role of 3GPP
for supporting UAS
\- The USS referred throughout document is only a Remote ID USS.
\- Remote ID USS are a third-party company that will communicate with the UAS
/ ground station to provide Remote ID interfacing.
\- The 3GPP network is not involved in providing control functionality for the
registration of the UAS and allocation of the CAA-Level UAV Id, though such
functions may take place over user plane connectivity. It is assumed that the
UAS operators has registered the UAS with relevant authorities and a CAA-Level
UAV ID is assigned to the UAV
\- The UAV UE has an aerial subscription in HSS/UDM subscriber profile
\- The Remote ID USS system may perform an authentication of the CAA Level UAV
Id and 3GPP system may not be aware of the result of the authentication done
by USS.
\- 3GPP system provides the 3GPP ID (i.e. external Identifier) corresponding
to the CAA Level UAV Id to the USS, so that the USS can access any service
exposed 3GPP system using the 3GPP level ID.
#### 6.22.2.2 Overview of the solution
The UAV UE has an aerial subscription in the subscriber data in HSS/UDM.
During the registration/attach procedure, when the subscriber data is
downloaded into the AMF/MME, it identifies the UE as an UAV UE. This
implicitly means that the AMF/MME must notify the relevant Remote ID USS about
the presence of a UAV UE along with the CAA Level UAV Id and the UAV UEs GPSI
(e.g. external identifier) and may be also the current location of the UAV.
Editor\'s note: It is FFS whether a UAV that registers with the 3GPP system
for e.g. plain Internet connectivity (e.g. to download a software update)
should require the 3GPP system to notify the USS.
After the completion of the registration/attach procedure, the AMF/MME then
requests the UAV UE to provide the CAA Level UAV Id. Once the CAA Level UAV Id
is received from the UAV UE, the AMF/MME then sends a notification event to
Remote ID USS (via NEF/SCEF) with event type (UAV UE registration), CAA Level
UAV ID, GPSI (e.g. external Identifier) and may be also include the current
location information of the UAV UE.
The Remote ID USS may at this point authenticate the CAA Level UAV ID
presented by the UAV UE. If the UAV is authenticated by the USS, the USS may
through interfaces outside the scope of 3GPP, indicate to the UAS operator
that they can operate the UAS. The 3GPP system is not involved in these
operations and may also not be aware of the outcome of the authentication done
by the Remote ID USS.
Editor\'s note: It is FFS if this is aligned with the agreed working
assumptions.
The Remote ID USS now has a mapping between the CAA Level UAV ID and 3GPP
level ID i.e. the GPSI. From now onwards the Remote ID USS uses the 3GPP Level
ID i.e. the GPSI to access any service exposed by the 3GPP system, for
example: location tracking of the UAV.
### 6.22.3 Procedures
#### 6.22.3.1 UAV identification and notification to Remote ID USS
Figure 6.22.3.1-1: UAV identification and notification to Remote ID USS
1-3. 3GPP registration of the UAV UE as per TS 23.502, Figure 4.2.2.2-1 for
5GC and TS 23.401, Figure 5.3.2.1-1 for EPC.
4\. From the downloaded UE subscription data, the AMF/MME identifies that the
UE has an aerial subscription and it is an UAV UE. This implicitly configures
an event notification to be sent to the Remote ID USS. The event notification
is sent only at initial registration. The event notification to USS shall
contain the CAA Level UAV Id assigned to the UAV. So, the AMF/MME at this
point, sends an Identity Request to the UAV UE to provide the CAA Level UAV
Id.
5\. UAV UE includes the CAA Level UAV Id in Identity Response.
6\. The AMF/MME now creates an event notification. The event notification
contains event type as \"UAV UE registration\" and information elements like
CAA Level UAV Id, GPSI (e.g. external identifier) and may also contain the
current location of the UAV UE. The notification is sent to the USS via
NEF/SCEF. Based on operator policies, the USS address can be pre-configured or
could be derived based on the CAA Level UAV Id.
7\. The Remote ID USS may at this point authenticate the CAA Level UAV ID
presented by the UAV UE. If the UAV is authenticated by the USS, the USS may
through interfaces outside the scope of 3GPP, indicate to the UAS operator
that they can operate the UAS. The 3GPP system is not involved in these
operations and may also not be aware of the outcome of the authentication done
by the Remote ID USS. The Remote ID USS is assumed to store and maintain a
mapping between the CAA Level UAV Id and GPSI (e.g. external identifier)
8\. Remote ID USS further uses the GPSI (e.g. external identifier) for
accessing any services exposed by the MNO for that UAV UE... The USS may use
the GPSI (e.g. external Identifier) to send the configuration request to the
3GPP network, that can be further sent to the UAV UE by the network.
### 6.22.4 Impacts on existing entities and interfaces
This solution may have the following impacts to existing entities and
interfaces:
For 5GC:
\- N1: UE provides the CAA Level UAV Id, when requested by the AMF
\- AMF: If the UE has an aerial subscription, after registration accept, the
AMF requests the UE to provide CAA Level UAV ID. Once the CAA Level UAV ID is
received from the UE, the AMF then further sends an event notification (via
NEF) to the USS, indicating registration of a UAV UE, the CAA Level UAV Id and
GPSI (e.g. external identifier)
\- NEF: NEF sends the event notification from AMF to USS. The event contains
event type is \"UAV UE registration\" and other parameters like CAA Level UAV
ID, GPSI etc.
For EPC:
\- MME: If the UE has an aerial subscription, after attach accept, the MME
requests the UE to provide CAA Level UAV ID. Once the CAA Level UAV ID is
received from the UE, the MME then further sends an event notification (via
SCEF) to the USS, indicating registration of a UAV UE, its CAA Level UAV Id
and GPSI (e.g. external identifier)
\- SCEF: SCEF sends the event notification from MME to USS. The event contains
event type is \"UAV UE registration\" and other parameters like CAA Level UAV
ID, GPSI.
\- S1: UE provides the CAA Level UAV Id, when requested by the MME
## 6.23 Solution #23: UAV/UAVC authentication/authorization by USS/UTM and C2
communication establishment
### 6.23.1 Introduction
This solution addresses Key Issue #2, #3, #5, #6 and #7. This solution is
applicable to both 5GC and EPC. The solution facilitates below capabilities:
\- Authentication/authorization of UAV by USS/UTM during PDU session
establishment
\- Obtain UAV and networked UAVC IP address for C2 communication (from 3GPP
network) and perform necessary C2 communication authentication/authorization
and pairing.
\- Initiate re- authentication/ re-authorization when deemed necessary by the
USS/UTM
\- Revoke authentication/authorization and tear down the PDU sessions
### 6.23.2 Functional Description
#### 6.23.2.1 Assumptions
The solution is based on below assumptions:
\- An UAS consists of one UAV controller (UAVC) and one UAV. A single USS/UTM
is serving both the UAV and the UAVC associated within an UAS
\- The process for associating the UAV and UAVC to form an UAS is outside the
scope of 3GPP and is assumed to be done at the USS/UTM.
\- The UAV and UAVC forming the UAS may be served by different MNO. The
identification, authentication / authorization of the UAVC and UAV can happen
independently.
\- The registration of the UAV with aviation authority (CAA) is outside the
scope of 3GPP. Once the UAV is registered to the CAA, a CAA-Level UAV ID is
assigned to the UAV.
\- At 3GPP level the UAV is publicly identified by an MNO assigned GPSI in the
form of an External Identifier.
\- The UAV may establish separate PDU sessions with dedicated DNN/S-NSSAI (or
dedicated APNs in EPC) for
\- Communication with USS/UTM (e.g. OAM purpose, Networked Remote Id, Tracking
etc)
\- Command and control (C2) communication between UAV and mutually exclusively
an UAVC or a TPAE or an USS/UTM
\- Possibly One or more PDU sessions (PDN connection in EPC) for other
communication purposes (e.g. for video streaming etc).
\- The UAV gets via means out of scope of 3GPP a USS/UTM address and this is
included by the UAV in the request for the PDU session establishment. How the
USS/UTM address is configured in UAV is outside the scope of 3GPP.
\- Mapping between CAA-Level UAV ID and External Identifier is maintained by
the USS/UTM.
\- For EPC, the PDN connections used by UAV are served by a combo SMF+PGW-C
regardless of whether the UAV support 5G NAS or whether their subscription
allows access to 5GC. This allows reusing common procedures between EPC and
5GC; and of course, allows UAV/UAVC to freely move between 5GC and EPC
coverage.
\- The solution re-uses (with necessary adaptation) Secondary
authentication/authorization by a DN-AAA.
NOTE 1: Re-using (with necessary adaptation) of Secondary
authentication/authorization by a DN-AAA allows to reuse an existing feature
(limiting the cost of introduction of the UAS support by 3GPP systems) that
can equally apply over EPC and 5GC.
NOTE 2: APN used by the UAV for contacting the USS/UTM resolves to SMF+PGW-C
only.
NOTE 3: The 3GPP system shall be able to verify that the USS/UTM address
provided by the UAV/UAVC UE can be trusted. Security solutions for
verification of the USS/UTM address and establishing trust relationship by
3GPP network shall be covered at SA WG3.
#### 6.23.2.2 Overview of the solution
An UAS consists of one UAV controller (UAVC) and one UAV. The UAVC can be a
networked meaning the UAVC is connected to a 3GPP network and connected to the
UAV via the 3GPP network or the UAVC can be non-networked meaning the UAVC is
not connected to the 3GPP network and connected to UAV via a transport outside
the scope of 3GPP e.g. internet. In this release of specification, a networked
UAVC is considered as a normal UE, without having any aerial subscription and
without having the need for secondary authentication & authorization by the
USS/UTM. However, the concepts defined in the paper for authentication &
authorization of an UAV by the USS/UTM can be utilised for a networked UAVC
also, if in future there is a need to do so.
Based on the type of UAVC (networked or non-networked) used in an UAS, the
complete solution can be viewed in two different representation from 3GPP
point view.
An overview of the solution is first provided for the case of a non-networked
UAVC;
NOTE 1: Despite the fact that a 5GC wording is used in the figure, it applies
also to EPC with e.g. PDU sessions replaced with PDN connections
Figure 6.23.2.1-1: Overall solution for an UAV with non-networked UAVC
The UAV may establish multiple PDU sessions.
In Figure 6.23.2.1-1 above, PDU session1 is used for communication with
USS/UTM. This PDU session may be used by the UAV to register with the USS/UTM
and provide any further information that the USS/UTM may need to register the
UAS. During the PDU session establishment the USS/UTM may perform
Authentication & authorization of the UAV. This PDU session may further be
used for any communication with USS/UTM that are not related to command and
control (C2) operations. For example: for Networked Remote ID (NRID) or for
tracking purpose or even for USS/UTM to update certain C2 communication
related configuration in the UAV.
For C2 communication the UAV may establish a second PDU session. The USS/UTM
authenticates/authorizes this PDU session establishment request for C2
communication by the UAV. The USS/UTM also performs
authentication/authorization of the UAV if it was not performed earlier. The
USS/UTM may also allocate a dynamically generated CAA-Level UAV ID (e.g.
session Id) to the UAV. After the second PDU session establishment, the
USS/UTM receives the C2 communication IP address(es) for the UAV from the 3GPP
network. The USS/UTM may use this IP address to configure the authorized UAVC
to control the UAV, however, how this configuration is done is outside the
scope of 3GPP.
When the UAVC IP address for C2 communication is available with the USS/UTM,
it configures this IP address in the UAV and may also further do some
additional configuration in the UAV to enable C2 communication. PDU Session1
of the UAV may be used for such communication between UAV and USS/UTM.
The USS/UTM also provides (as part of authorization data) the C2 communication
IP address of the UAVC to the 3GPP network anchoring the PDU session for C2
communication of the UAV. This IP address in configured in Access Control List
(ACL) for the PDU session such that, using the second PDU session the UAV is
able to access only the configured IP addresses meant for C2 communication
that are authorized by the USS/UTM.
The UAV can now connect on the C2 communication link over the PDU session2
NOTE 2: SMF are configured to associate the PDU Session for C2 (corresponding
to a specific (DNN, S-NSSAI)) with an empty default ACL; this means that as
long as the USS/UTM has not authorized an IP address in the ACL, no
communication is possible on such PDU session.
NOTE 3: It is possible that by default the USS/UTM puts in the ACL it
configures in the network its own IP in order to be able to take control of
the UAV in case of an issue; this depends on USS/UTM policies that are out of
scope of 3GPP.
NOTE 4: The UAV may establish additional one or more other PDU sessions for
various other purposes and are not shown in above.
Although in this release of specification a networked UAVC is considered as a
normal UE without any aerial subscription and without the need for any A&A by
USS/UTM Figure 6.23.2.1-2 below shows the solution overview with a networked
UAVC, if in future such need arises to also perform A&A for UAVC by the
USS/UTM. The UAV UE behaviour is independent of whether the UAVC is a
networked or non-networked. In the case of a networked UAVC, as can be seen
from the Figure 6.23.2.1-2, the UAVC UE also may establish multiple different
PDU sessions e.g. one for communication with USS/UTM and another one
specifically for C2 communication.
The UAV and networked UAVC registers to 3GPP network and establishes PDU
sessions independent of each other. It is also possible that the UAV and UAVC
are served by different MNOs. However, from UAS operations point of view both
are served by a single USS/UTM system.
In the case of a networked UAVC, the authentication/authorization and C2
communication pairing configuration can be facilitated by the 3GPP, similar to
how it works for an UAV.
Figure 6.23.2.1-2: Overall solution for an UAV with networked UAVC
#### 6.23.2.3 Usage of secondary DN AAA authentication / authorization
For 5GC the solution enhances the feature \"Secondary
authentication/authorization by a DN-AAA server during the establishment of a
PDU Session\" provided by 3GPP (TS 23.501, clause 5.6.6 and TS 23.502, clause
4.2.3.2) to expose a service based interface from SMF to facilitate the
USS/UTM to authenticate/authorize the UAV using web based mechanism instead of
an EAP based mechanism.
For EPC the solution introduces similar procedure as for 5GC, in the SMF+PGW-C
to facilitate the USS/UTM to authenticate/authorize the UAV and networked
UAVC.
It is proposed to use a new network function UAV NF (or alternatively enhance
the existing NFs like NEF), that will provide a single interface towards the
USS/UTM for authentication and authorization and for USS/UTM to access other
3GPP exposed services. The UAV NF may perform the USS/UTM selection (as
described in clause 6.5.2.3) and will work as an intermediary between SMF
(SMF+PGW-C) and USS/UTM for supporting the authentication & authorization of
the UAV.
The UAV provides the necessary identifiers and information needed by the
USS/UTM system. These may include (and not limited to and is out of scope of
3GPP, thus not further described):
\- UAV SN to identify the UAV HW
\- CAA-Level UAV ID
\- Other USS/UTM specific Identifiers/information to identify,
authenticate/authorize the UAV controller, the pilot etc.
\- Additional aviation specific information like Current location, Flight
information, flight authorization specific information, location (latitude,
longitude, altitude) of the UAV controller etc.
PDU session (PDN connection in EPC) establishment for C2 communication is
continued only after the USS/UTM has successfully authenticated/authorized the
UAV. The authorization data is also provided to the 3GPP network.
The 3GPP system or the USS/UTM may initiate a re-authentication/re-
authorization of the UAV at any point of time.
The USS/UTM may at any point revoke the authorization, forcing 3GPP network to
tear down the PDU session or change the ACL associated with the PDU Session
for C2 to e.g. remove the UAVC IP address from the list of authorized IP
address and e.g. replace it with the IP address of a TPAE.
### 6.23.3 Procedures
#### 6.23.3.1 Authentication/authorization and C2 communication establishment
of UAV/UAVC by USS/UTM via 5GC network
The procedure for UAV authentication and authorization and further
authentication and authorization of C2 communication establishment by the
USS/UTM during PDU session establishment in a 5GC network is depicted in
Figure 6.23.3.1-1 below.
Figure 6.23.3.1‑1: Authentication/authorization and C2 communication
establishment for UAV/UAVC by USS/UTM via 5GC
1\. The UAV registers to the 3GPP network. The UE\'s subscription information
obtained by AMF from the UDM has an indication for support for Aerial UE
function and the AMF provides the subscription information on Aerial UE
authorization to the gNB.
NOTE 1: It is assumed that the UAV has been registered to the CAA level
authority, a CAA-Level UAV ID is available with the UAV/UAVC and the UAV/UAVC
has a USS/UTM address configured.
2\. The UAV initiates a PDU session establishment request for communication
with USS/UTM.
3\. Based on the UAV UE\'s subscriber profile, DNN and S-NSSAI provided in the
request the AMF selects the SMF and sends Nsmf_PDUSession_CreateSMContext
Request to the SMF. It is assumed that the UAV is configured with the
appropriate S-NSSAI and DNN to use or that the 3GPP Network has configured the
Default S-NSSAI and Default DNN to be dedicated for UAV-USS/UTM connectivity.
4\. The SMF obtains subscription data from the UDM for the given SUPI obtained
from the AMF.
The SMF checks the subscription data whether a secondary authentication is
required for the PDU session request and whether the UE request is allowed
according to the user subscription and local policies. If the secondary
authentication is required and the UE request is allowed, the SMF may further
send a request to the UAV to fetch the USS/UTM specific identifier (e.g. CAA-
Level UAV ID) and (optionally) a USS/UTM address for secondary authentication
if it was not already provided by the UAV in step 2 above.
The SMF send UAV authentication & authorization request to the UAV NF
including the CAA-Level UAV ID received from the UAV UE, the GPSI (e.g.
External Identifier of the UE) and USS/UTM address if received. The SMF may
also reserve an IP address for the PDU session and include the UE IP address
information in the UAV authentication & authorization request to the UAV NF.
5\. UAV NF shall verify that the USS/UTM address provided by the UAV can be
trusted. If the USS/UTM address provided by the UAV is an FQDN, UAV NF uses
DNS resolution to find out the IP address of the USS/UTM. The UAV NF forwards
the UAV authentication & authorization request to the selected USS/UTM.
6\. Depending on the security mechanism, multiple roundtrip messages may be
exchanged between the UAV and USS/UTM.
NOTE 2: Security details will be determined by SA WG3.
7\. If the authentication & authorization was successful at USS/UTM, the
USS/UTM provides the successful response with authorization information to the
UAV NF. The USS/UTM may maintain a mapping of the CAA-Level UAV ID and the
3GPP level UAV ID (i.e. the GPSI) to further access services exposed by the
3GPP network using the 3GPP level UAV ID.
8\. The UAV NF provides the UAV A&A response to the SMF.
9\. After successful authorization by the USS/UTM, further PDU session
establishment procedure is continued.
10\. SMF may notify the USS/UTM the IP address(es) allocated to the UAV via
the UAV NF if it was not provided in step 4. The USS/UTM may store the
correlated GPSI and PDU session IP address with the authorized CAA-Level UAV-
ID to enable further service requests via network exposure APIs to the 3GPP
system related to the authorized UAV. The GPSI may e.g.be used to activate
monitoring of the UAV/UE location and the PDU session IP address for requests
for dedicated QoS and gating to be applied for the authorized PDU session. It
may also be used to revoke the established connectivity/PDU-session if it is
deemed necessary by the USS/UTM.
11\. [Optional] USS/UTM may provide access control list information, so that
the PDU session is used only for accessing UAS services (e.g. connecting to
the USS/UTM or other UAV operations). For this the USS/UTM interacts with the
PCF via UAV NF to configure dedicated polices.
12\. The UAV may use this PDU session for communicating with to the USS/UTM
for Networked Remote ID (NRID) and tracking related communication with
USS/UTM.
13\. Once the UAV is ready for flight operation, it initiates a new PDU
session establishment request for C2 communication if separate PDU sessions
are used for USS/UTM communication and for C2 communication. If a single PDU
session is used for both, the UAV UE requests for PDU session modification
indicating C2 related operation.
14\. The SMF verifies whether a secondary authentication is required for the
PDU session establishment/modification request and performs authentication of
the request by the USS/UTM using the same procedures as explained in steps 4
-- 8 for UAV authentication and authorization.
15\. SMF continues with the PDU session establishment/modification only after
successful authentication & authorization done the by USS/UTM.
16\. If a separate PDU session was used for C2 communication and the UE IP
address allocation for the PDU session was not included in the authentication
& authorization request towards USS/UTM in step 14, the SMF notifies the IP
addresses allocated to the UAV UE to the USS/UTM via the UAV NF. If the same
PDU session is used for C2 communication this step is skipped as the UE IP
address is already notified in step 4 or 10\. The USS/UTM may store the
correlated GPSI and PDU session IP address with the authorized CAA-Level UAV-
ID to enable further service requests via network exposure APIs to the 3GPP
system related to the authorized UAV. The PDU session IP address may be used
for requests for dedicated QoS and gating to be applied for the authorized PDU
session. It may also be used to revoke the established connectivity/PDU-
session if it is deemed necessary by the USS/UTM.
17\. USS/UTM provides necessary access control list information, so that using
the PDU session the UAV can be controlled only by authorized UAV controller or
TPAE. If this pairing information is not available, the USS/UTM may provide
its own IP address as a UAV controller. And later when the UAV controller IP
address is known to the USS/UTM, it may update the access control list, using
the same SBI interfaces, to allow C2 communication between the UAV and UAV
controller using this PDU session. The USS/UTM interacts with the PCF via
UFES/NEF to configure dedicated polices required for setting up C2
communication and/or UAV/UAVC pairing as \"negotiated\" between UAV(C) and
USS/UTM. SMF updates the ACL in UPF with the IP addresses provided by the
USS/UTM.
18\. USS/UTM may now further configure the C2 communication related
information on the UAV. This is done at the application level using PDU
session that was established in Step 2-9, and the complete communication is
transparent to 3GPP.
#### 6.23.3.2 Authentication/authorization and C2 communication establishment
of UAV/UAVC by USS/UTM via EPC network
Figure 6.23.3.2‑1: Authentication/authorization and C2 communication
establishment for UAV/UAVC by USS/UTM via EPC
The procedure for UAV authentication and authorization and further
authentication and authorization of C2 communication establishment by the
USS/UTM during PDN connection establishment in a EPC network is depicted in
Figure 6.23.3.2-1 above.
[1-3]. The UAV UE sends an attach request to the EPC network. MME performs the
primary authentication and downloads subscription data from HSS. The
subscription data obtained by MME from the HSS has an indication for support
for Aerial UE function and the MME provides the subscription information on
Aerial UE authorization to the eNB. The MME initiates default bearer
establishment procedure during the attach procedure according to TS 23.401
[10] Figure 5.3.2.1-1.
[4-7]. The SMF+PGW-C checks the subscription data whether a secondary
authentication is required for the PDN connection establishment request and
whether the UE request is allowed according to the user subscription and local
policies and establishes a N4 session with UPF+PGWu (same behaviour as in 5GC
case). If the secondary authentication is required, the SMF+PGW-C sends back
Create Session Response. If the CAA-Level UAV ID and USS/UTM address were not
included in step 3, the SMF+PGW-C includes a PCO in the Create Session
Response requesting for the CAA-Level UAV ID and signed USS/UTM address. The
SMF+PGW-C also ensures (same behaviour as in 5GC case), with appropriate ACL
(Access Control List) configuration at the UPF+PGW-U, that the UE is not able
to access any data network using this PDN connection until a secondary
authentication is performed by the USS/UTM. The MME sends attach accept and
the NAS message containing the PCO requesting CAA-Level UAV ID.
8\. The UE sends attach complete and also provides the CAA-Level UAV ID to the
MME.
[9-10]. MME sends a Modify Bearer Request including the PCO containing the
CAA-Level UAV ID to the SMF+PGW-C. The SMF+PGW-C then sends back a Modify
Bearer Response to the MME.
11\. The SMF+PGW-C now performs the UAV A&A using a services based interface
towards UAV NF as explained in steps 4 -- 8 in clause 6.23.3.1.
NOTE 1: Requesting CAA-Level UAV identity in steps 6, 7 are completely
optional. If CAA-Level UAV Id is always provided by the UAV UE in attach
request, then the additional PCO requesting CAA-Level UAV Id is not included
in step 7 and Step 9, 10 are completely skipped.
NOTE 2: It is proposed to complete the attach procedure before the SMF+PGW-C
completes authentication & authorization with USS/UTM to avoid situations like
the attach procedure getting timed out at the UE side while the network awaits
completion of authentication & authorization with USS/UTM.
12[a-c]. The SMF+PGW-C sends an Update Bearer Request to the MME including the
authorization data in the PCO. The MME sends the PCO in a Downlink NAS
transport message to the UAV UE and confirms the bearer update procedure by
sending an Update Bearer Response to the SMF+PGW-C. SMF+PGW-C also notifies
the IP address(es) allocated for the PDN connection of the UAV, to the USS/UTM
via the UAV NF, if it was not included in the authentication & authorization
request towards USS/UTM in step 11. The USS/UTM may store the correlated
External Identifier and UE IP address with the authorized CAA-Level UAV-ID to
enable further service requests via network exposure APIs to the 3GPP system
related to the authorized UAV. The External Identifier may e.g. be used to
activate monitoring of the UAV/UE location and the UE IP address for requests
for dedicated QoS and gating to be applied for the authorized PDN connection.
It may also be used to revoke the established PDN connection if it is deemed
necessary by the USS/UTM.
13\. [Optional] USS/UTM may provide access control list information, so that
the PDN connection is used only for accessing UAS services (e.g. connecting to
the USS/UTM or other UAV operations). For this the USS/UTM interacts with the
PCF via UAV NF to configure dedicated polices. The SMF+PGW-C then configures
the Access Control List into the UPF+PGW-C
14\. The UAV may use this PDN connection for communicating with the USS/UTM
e.g. for Networked Remote ID (NRID) and tracking related communication with
USS/UTM.
15\. Once the UAV is ready for flight operation, it initiates a new PDN
connection establishment request for C2 communication if separate PDN
connections are used for USS/UTM communication and for C2 communication. If a
single PDN connection is used for both, then the UAV UE requests for Bearer
modification indicating C2 related operation.
16\. The SMF+PGW-C verifies whether a secondary authentication is required for
the PDN connection establishment/modification request and performs
authentication of the request by the USS/UTM using the same procedures as
explained in steps 4 -- 8 of clause 6.23.3.1 for UAV authentication and
authorization.
17\. SMF+PGW-C continues with the PDN connection establishment/bearer
modification only after successful authentication & authorization done the by
USS/UTM.
18\. If a separate PDN connection is used for C2 communication and the UE IP
address allocation for the PDN connection was not included in the
authentication & authorization request towards USS/UTM in step 16, the
SMF+PGW-C notifies the IP addresses allocated to the UAV UE for the PDN
connection, to the USS/UTM via the UAV NF. If the same PDN connection is used
for C2 communication this step is skipped as the UE IP address is already
notified to the USS/UTM. The USS/UTM may store the correlated External
Identifier and UE IP address with the authorized CAA-Level UAV-ID to enable
further service requests via network exposure APIs to the 3GPP system related
to the authorized UAV. The UE IP address may be used for requests for
dedicated QoS and gating to be applied for the authorized PDN connection. It
may also be used to revoke the established PDN connection if it is deemed
necessary by the USS/UTM.
19\. USS/UTM provides necessary access control list information, so that using
the PDN connection the UAV can be controlled only by authorized UAV controller
or TPAE. If this pairing information is not available, the USS/UTM may provide
its own IP address as a UAV controller. And later when the UAV controller IP
address is known to the USS/UTM, it may update the access control list, using
the same SBI interfaces, to allow C2 communication between the UAV and UAV
controller using this PDN connection. SMF+PGW-C updates the ACL in UPF+PGWu
with the IP addresses provided by the USS/UTM.
20\. USS/UTM may now further configure the C2 communication related
information on the UAV. This is done at the application level using PDN
connection that was established in Step 3-13, and the complete communication
is transparent to 3GPP.
#### 6.23.3.3 Authentication/authorization revocation by USS/UTM
Figure 6.23.3.3‑1: Authentication/authorization revocation or update
When the USS/UTM determines the need for updating the authorization data (e.g.
update the access control list) or revoke the UAV authorization (or C2
communication authorization), it uses the service based interface exposed by
UAV NF to send the authorization update request or authorization revocation
request. The request is sent on the 3GPP Level ID that the USS/UTM had
received during the A&A procedure. The SMF (or SMF+PGW-C) updates the access
control list for the PDU session (or PDN connection) based on the information
received in the authorization data update request. If the request was for
revocation of the authorization, the SMF may decide to terminate the PDU
session (or PDN connection). The SMF then sends a response acknowledging the
successful execution of the authorization data update or revocation.
### 6.23.4 Impacts on existing entities and interfaces
This solution may have the following impacts to existing entities and
interfaces:
For 5GC:
\- N1: UE provides the signed USS/UTM address and CAA-Level UAV ID in the PDU
session establishment request
\- SMF: Retrieves signed USS/UTM address and the CAA-Level UAV ID from the PDU
session establishment request. Define a new SBI interface (if needed) for
secondary DN authentication/authorization during PDU session establishment.
When the USS/UTM provides a success response for the secondary authentication
result (via UAV AF), use the authorization data to configure the ACL in UPF,
such that the UE can access only the configures list of IP addresses using the
PDU session.
For EPC:
\- SMF+PGW-C: Supports \"Secondary authorization/authentication by an DN-AAA
server during the PDU Session establishment\" using a SBI interface in the
same way as the SMF in the case of 5GC. Retrieves the USS/UTM address and CAA-
Level UAV ID included in the PCO by the UE. Additionally, same changes as
described above for SMF in 5GC case.
\- S1: Provides USS/UTM address and CAA-Level UAV ID to the SMF+PGW-C in a
PCO.
## 6.24 Solution #24: UAV Re-authentication and Re-authorization
### 6.24.1 Introduction
This solution addresses Key Issue #2 and #3 to support UAV Re-authentication
and Re-authorization, UAV and UAVC pairing re-authorization.
This solution is applicable to EPC and 5GS.
### 6.24.2 Functional Description
The UTM can trigger UAV re-authentication and re-authorization via UFES at any
time. In 5GS, the AMF triggers UUAA procedure to re-authenticate and re-
authorize the UAV. In EPS, the PGW initiates bearer modification procedure to
transfer the re-authentication and re-authorization information via PCO.
The UTM can update the UAV and UAVC pairing authorization and RITI at any
time. In 5GS, the SMF transfers the updated authorization data and RITI to
UAV. In EPS, the PGW initiates bearer modification procedure to transfer the
authorization data and RITI via PCO to UAV.
In this solution, the UFES could be an existing functionality, e.g. SCEF, NEF.
### 6.24.3 Procedures
#### 6.24.3.1 5GS Procedures
##### 6.24.3.1.1 UTM triggered UAV Re-authentication and Re-authorization in
5GS
Figure 6.24.3.1.1-1: UTM triggered UAV Re-authentication and Re-authorization
1\. The UTM requests the re-authentication and re-authorization for the UAV
identified by the 3GPP UAV ID.
2-3. [Conditional] If UFES does not maintain the serving AMF of the UAV, UFES
gets AMF ID from UDM using Nudm_UECM_Get with the 3GPP UAV ID in the received
request in step 1.
4\. The UFES notifies Re-auth event to the AMF to re-authenticate/re-authorize
the UAV using Nufes_UUAA_Notify with the 3GPP UAV ID and the UAV re-auth
event.
5\. The AMF triggers the UUAA procedure.
##### 6.24.3.1.2 UTM Triggered UAV and UAVC Pairing Re-authorization
Figure 6.24.3.1.2-1: UTM triggered UAV Re-authentication and Re-authorization
1\. The UTM requests to update the UAV and UAVC pairing authorization data and
RITI.
2-3. [Conditional] If the UFES does not maintain the serving SMF of the UE,
UFES gets SMF ID from UDM using Nudm_UECM_Get service operation.
4\. The UFES notifies the UAV and UAVC pairing authorization data and RITI to
the SMF to update the authorization using Nufes_UUAA_Notify.
5\. Option 1: The SMF sends PDU Session Modification Command to UAV. The
message includes the UAV and UAVC pairing authorization data and RITI.
6\. Option 1: The UAV sends PDU Session Modification Command Ack to SMF.
7\. Option 2: The SMF triggers secondary authorization/authentication
procedure. This step is the same as the steps 3b-4 in secondary
authorization/authentication by an DN-AAA server during the PDU Session
establishment in clause 4.3.2.3 in TS 23.502.
#### 6.24.3.3 EPS Procedures
##### 6.24.3.3.1 UTM triggered Re-authentication and Re-authorization
Figure 6.24.3.3.1-1: UTM triggered Re-authentication and Re-authorization in
EPS
1\. The UTM sends UAV Re-auth request (CAA-level UAV ID, authorization data
and RITI) to UFES.
2\. The UFES sends UAV operation request to PGW.
3\. The PGW initiated bearer modification procedure in clause 5.4.2.1 in TS
23.401 [10] to send authorization data and RITI to UE via PCO.
4\. The PGW sends UAV operation response to UFES. The message includes the
information that the UE provided in PCO.
5\. The UFES sends UAV Re-auth response to UTM. The message includes the
information that the UFES received in step 4.
### 6.24.4 Impacts on services, entities and interfaces
For 5GS:
\- The AMF is enhanced to trigger UUAA when re-auth event or authorization
data is received
\- The SMF sends authorization data and RITI to UE via PDU Session
modification command or secondary authorization/authentication procedure.
For EPS:
\- The PDN GW initiates bearer modification procedure to transfer re-
authentication and re-authorization data in PCO.
For both EPS and 5GS:
\- An UFES function is introduced as described above. The UFES may be mapped
to existing functionality, e.g. SCEF, NEF, AAA-P depending on the specific
implementation of the interfaces between the 3GPP system and the UTM.
## 6.25 Solution #25: Network Exposure to support UAV and UAVC tracking
### 6.25.1 Introduction
This is a solution for Key Issue #4 and #7. It\'s a partial merge of solution
1, 9, 13,14,15,16, and 17 where certain aspects where commonality exist are
brought together here in this solution.
In the Figure 6.25.3-1:
Step1, 3a, 4, 5 are from the concept of solution 15, with the difference that
the UAVF is added to expose the location service to UTM/USS.
Step2, 3a, 3b, 7, 8a, 8b are from the concept of solution 16, with replacing
NEF in solution 16 by the UAVF, the GMLC enhancement is not included.
Step 6, 9, 10a are from the concept of solution 13, 14, 16, and 17 that the
3GPP network can monitoring the UAV presence in the monitoring area by
comparing the UAV location with the monitoring area and can expose other
monitoring events notifications (e.g. Loss of Connectivity, UE reachability)
to USS/UTM.
Step 8b, 10b are from the concept of solution 13 with replacing NEF in
solution 13 by the UAVF, and preconfigure the traffic routing policies at UAVF
instead of at SMF.
Step 11,12, 15 are from the concept of solution 1 for tracking unknow UAVs in
the target area which can be mapped to 3GPP network areas. The difference is
to reuse the existing AMF event \"Number of UEs present in a geographical
area\" or \"location Reporting\" with Any UE in the event filter.
Step 13 is from the concept used in solution 9 for tracking unknown UAVs in
the target area but applied here for the case that the target area cannot be
mapped to 3GPP network areas. Here while the AMF event \"Number of UEs present
in a geographical area\" or \"location Reporting\" can be also used, upon
receiving the list of UEs from AMF, the UAVF invokes GMLC procedures for
obtaining location to resolve the target areas that cannot be mapped to 3GPP
areas.
### 6.25.2 Functional Description
This solution proposes the following principles:
\- A 3GPP network NF UAVF is introduced in this solution, the following
functions are supported by UAVF:
\- This NF is operated by the PLMN serving the target UAV/UAVC UE: it is part
of 5GC/EPC, reached by USS/UTM via NEF/SCEF (or may encompass the NEF/SCEF
functionality) and has access to PLMN based information such as SUPI, TA, cell
Id.
NOTE 1: in the scope of this solution, the term UAVC is used to indicated
exclusively a networked UAVC.
\- Providing to UTM/USS location information about the UAV and /or UAVC. Based
on the request from UTM/USS this location information could be:-
\- Immediate reporting or deferred reporting (e.g. periodic reporting) based
on the request from UTM/USS. It\'s shown in the first dotted box of Figure
6.25.3-1.
\- Monitoring the UAV presence in the monitoring area (e.g. moving in or out
of the monitoring area) and providing the monitoring report to UTM/USS. The
UAVF reuses the Area of Interest mechanism to receive the reporting of UE
presence in the monitoring area from AMF if the monitoring area can be mapped
to 3GPP network areas. Or the UAVF determines the UAV presence in the
monitoring area by comparing the location report from GMLC with the monitoring
area from UTM/USS. It\'s shown in the second dotted box of Figure 6.25.3-1.
\- Providing the list of 3GPP UAV IDs corresponding to the UAVs served by the
PLMN being queried and present in the identified target area to UTM/USS. It
could be immediate reporting or deferred reporting (e.g. periodic reporting)
based on the request from UTM/USS. It\'s shown in the third dotted box. The
AMF event \"Number of UEs present in a geographical area\" or \"location
Reporting\" with Any UE in the event filter can be reused. If the target area
can be mapped to 3GPP network areas, UAVF identifies the UAVs from the UE list
received from AMF, and feedback the identified UAVs to UTM/USS.
If the target area cannot be mapped to 3GPP network areas, UAVF provides a TA
List which is larger than the target area to AMF for the list of UEs to be
queried. Then upon receiving the list of UEs from AMF, UAVF queries the UEs\'
location from GMLC, and then identifies the UAVs in the target area and
feedback to UTM/USS.
The list reported to the USS/UTM contains only UAVs.
NOTE 2: UAVF exposes the above UAV and UAVC locations report and UAV presence
monitoring report capabilities to UTM/USS, it\'s decided by UTM/USS to choose
one of or a combination of these capabilities. The UTM/USS logic is out of
3GPP scope.
NOTE 3: Enhancement on GMLC to support the reporting of UE presence in the
monitoring area is not considered in this solution.
\- Mapping the 3GPP UAV ID provided by UTM/USS to the 3GPP UE IDs required by
location related NFs. i.e. AMF, GMLC.
\- Receiving a 3GPP UAV ID from UTM/USS in the location request messages and
sending the CAA-level UAV ID to UTM/USS in the location report(s).
\- Mapping the monitoring area from UTM/USS (e.g., longitude/latitude, zip
code, UE trajectory, etc) to 3GPP network area information e.g. a list of
TAs/Cell ids.
\- Decides the related NF, i.e. AMF or GMLC to invoke, e.g. based on the UAV
capability or network capability, the location accuracy, monitoring area
received from UTM/USS.
\- Be preconfigured or receives from UTM/USS the traffic routing policies,
when the location of UAV or the UAV presence in the monitoring area matches a
policy, UAVF based on the policy indicates SMF to take the appropriate network
layer actions, e.g. revoke the connectivity between UAV and UAV controller,
steering the traffic toward/ from the UAV to UTM/USS/TPAE for further
analysis, etc. UAVF considers those policies as active and ongoing
instructions from UTM/USS without constant or repeated triggers/requests from
UTM/USS. The traffic routing policy includes 3GPP UAV ID(s) (e.g. GPSI or
External Group Identifier) to identify the UAV(s)/UAVC(s) and the
corresponding network layer actions e.g. revoke the resources of the related
C2 communications.
This solution applies to both 5GC and EPC. With replace the AMF by the MME,
replace the SMF by the PGW.
### 6.25.3 Procedures
Figure 6.25.3-1
Step 1-5 shows the procedure that the 3GPP network exposes the UAV and UAVC
location service to UTM/USS.
1\. The UTM/USS sends the location request to UAVF to request UAV and/or UAVC
locations from network. The UAV/UAVC ID provided by UTM/USS follows the
conclusion of KI#1. The request also includes the location accuracy
[Conditional] If the UTM/USS needs to calculate the distance between UAVC and
UAV, the UTM/USS may indicate the UAVF to provide location information of UAVC
and/or UAV at the same time, e.g., using the same start time for periodic
reporting or a synchronization indication for immediate reporting in the
location request.
NOTE 1: Whether the request also includes other attributes is to be determined
in the normative phase.
2\. UAVF decides the related NF, i.e. AMF/MME or GMLC for location reporting,
e.g. based on the UAV/UAVC capability or network capability, location accuracy
etc.
[Conditional] If UAVF needs to provide location information of UAVC and UAV at
the same time, it can request the AMF/MME or GMLC to provide the position of
the UAVC and/or UAV at the same time by providing the start time of reporting.
3\. UAVF maps the UAV/UAVC ID provided by UTM/USS to the UE IDs required by
the NF decided by step2. i.e. AMF/MME or GMLC. UAVF gets the UAV/UAVC location
from AMF/MME or GMLC by the current location services supported by AMF or
GMLC.
4\. UAVF provides the UAV and/or UAVC locations reporting to UTM/USS. The UAVF
includes the UAV and/ or UAVC CAA-level UAV ID in the location reporting
message to UTM/USS as well as a location information (geo co-ordinate)
suitable for USS/UTM (that is not assumed to know what TA and Cell Id are).
5\. UTM/USS can use the output received at step 4 from UAVF to e.g. compares
the received UAV location with the monitoring area (e.g. allowed area or non-
allowed area for Geofencing).
Step 6-10b shows the procedure that the 3GPP network exposes the UAV presence
monitoring service to UTM/USS.
6\. The UTM/USS sends the UAV presence monitoring request to UAVF to request
UAV presence events from 3GPP network (e.g. moving in or out of the monitoring
area). The request also includes the monitoring area, location accuracy and
other attributes. The monitoring area could be area inside or outside the
fence for Geofencing.
NOTE 2: The UTM/USS can also subscribe to the UAVF other Monitoring Events
(e.g. Loss of Connectivity, UE reachability) already defined in clause
4.15.3.1 of TS 23.501, the UAVF can obtain corresponding Monitoring Events
Notifications from related NFs (e.g. AMF, UDM), and respond to the UTM/USS.
7\. UAVF decides the related NF, i.e. AMF or GMLC for location reporting, e.g.
based on the UAV capability or network capability, location accuracy, the
monitoring area etc.
8\. UAVF maps the 3GPP UAV ID provided by UTM/USS to the UE IDs required by
the NF decided by step7. i.e. AMF or GMLC. In case the monitoring area can be
mapped to 3GPP network areas, UAVF provides the monitoring area to AMF and
gets the reporting of UE presence in the monitoring area by reusing the Area
of Interest mechanism. Otherwise UAVF gets the UAV location from GMLC by the
current location services supported by GMLC. It\'s also possible UAVF gets the
UAV location from GMLC if it determines that a finer granularity of location
is needed when the report is received about the UAV presence of a coarse
granularity area.
9\. UAVF determines the UAV presence in the monitoring area by the reporting
of UE presence in the monitoring area from AMF or by comparing the location
report from GMLC with the monitoring area from UTM/USS.
10\. UAVF reports the UAV presence in the monitoring area to UTM/USS by
including its CAA-Level UAV-ID in the report(s). The UAVF may include the
UAVC\'s CAA-level UAV ID and 3GPP UAV ID in the reports to enable to the
UTM/USS to look up the UAVC associated with the UAV. Or if traffic routing
policies are stored in the UAVF, based on the policy and the UAV presence in
the monitoring area events detected at step9, UAVF indicates SMF to take the
appropriate network layer actions, e.g. revoke the connectivity between UAV
and UAV controller, steering the traffic toward/ from the UAV to UTM/USS/TPAE
for further analysis, etc. UAVF considers those policies as active and ongoing
instructions from UTM/USS without constant or repeated triggers/requests from
UTM/USS. The UAVF will provide the 3GPP UE ID(s) of the UAV(s)/UAVC(s) and the
corresponding network layer actions to SMF.
Steps 11-14 shows the procedure that allows the 3GPP network to provide the
UAV identity for each UAV or UAVC served by the queried PLMN, and
corresponding to the USS/UTM query conditions (e.g. a target area), to
UTM/USS.
11\. The UTM/USS sends the UAV list request to UAVF to request UAV UE
identity, providing query conditions (e.g. including a target area) from 3GPP
network.
12\. UAVF decides the AMF(s) based on the query conditions (e.g. target area
information) and obtains the UE list in the target area from AMF by reusing
the event \"Number of UEs present in a geographical area\" or \"location
Reporting\" with Any UE in the event filter. If the target area cannot be
mapped to 3GPP network areas, UAVF provides a TA List which is larger than the
target area to AMF for the list of UEs to be queried. The 3GPP system
separates out the UEs that are actual UAVs based on e.g. available CAA-Level
UAV ID, checking for UEs with aerial subscriptions, and whether the UAV has
successfully registered and has been authorized by the USS/UTM.
13\. [Optional] From the list of UEs generated in step 12, for UAVs that are
in target areas that do not map to 3GPP network areas, the UAVF then queries
the UAV(s) location from GMLC.
14\. If step 13 is executed, from the list of locations returned by the GMLC
the UAVF compares the UAV locations to the target area (provide in step 11) to
identify the UAVs to report. If the target area can be mapped to 3GPP network
areas, the list received in step 12 is used.
15\. UAVF feedbacks the identified UAVs to UTM/USS.
### 6.25.4 Impacts on services, entities and interfaces
\- Add a 3GPP NF which is UAVF as described above together with the
corresponding service API of the UAVF exposed via NEF.
\- No impact to other NF (than NEF).
## 6.26 Solution 26: UAV establishing user plane connectivity for remote
identification & tracking for UAV operations
### 6.26.1 Introduction
This solution addresses the key issues 1#, 2#, 3#, #7.
This solution describes in more detail an option included in Solution 5 that
specifically addresses the establishment of user plane connectivity between a
UAV/UAV-C and the UTM/USS that enables remote identification and tracking for
UAV operations.
The establishment of user plane connectivity for C2 communication and the
UAV-C/UAV pairing authorisation are not addressed in this solution.
### 6.26.2 Functional Description
Editor\'s note: This clause outlines solution principles and documents any
assumptions made.
The procedure follows the procedures described in Solution 5 which are:
\- Registration of UAV to UTM/USS
\- A UAS operator registers the UAV, providing the PEI of the UAV device to a
UTM/USS with a procedure which is out of scope of 3GPP. The registration
procedure includes details of the UAS operator, pilot, UAV make and model etc.
The UTM/USS may assign a CAA Level UAV ID.
\- Requesting flight authorisation from UTM/USS
\- A UAS operator is also required to request a flight authorisation from the
UTM/USS. The procedure is also out of scope of 3GPP. When the request is
authorised the UTM/USS may assign a Flight Authorisation ID which is used by
the UTM/USS to associate an authorised flight to a UAV.
\- UAV registration to 3GPP network
\- A UAV registers with the 3GPP network using standard 3GPP procedure.
\- As described in Solution 5 an optional UUAA procedure may take place for
the 3GPP network to verify that a UAV has been registered to a UTM/USS.
\- Requesting user plane resources for UAV operation
\- When a UAV is authorised for a flight by UTM/USS the UAV requests user
plane connectivity in the 3GPP system for flight operation in order to convey
remote identification and tracking information of the authorized flight to a
UTM/USS. As described in Solution 5. the UAV includes in a PDU session
establishment request an indication for UAV operation.
NOTE: The indication can be an explicit indication or may be identified by
using a specific DNN/S-NSSAI.
The UAV also include in the request the relevant Flight Authorisation ID, CAA
Level UAV ID, if provided by the UTM/USS in a container.
\- When the SMF/UFES identifies that the PDU session is for UAV operation the
SMF/UFES request authorisation from a UTM/USS. The request includes the
information contained in the container provided by the UAV and includes the
CAA Level UAV ID and Flight Authorisation ID if provided. The SMF also
includes the PEI of the UAV.
\- The UTM/USS authorises the request and includes in the Authorisation Accept
authorisation data that includes Remote Identification & Tracking Information
(RITI).
\- RITI includes:
\- A destination endpoint for sending the UAV data (e.g. the UTM/USS address)
\- A UAV ID which is created by the UTM/USS and is used for remote
identification and tracking of the UAV. The UAV ID is linked to a flight
authorised by the UTM/USS.
\- Optionally a Reporting Frequency indicating how frequently the UAV sends it
data to the UTM/USS
\- The SMF includes the RITI in the PDU session establishment accept message
to the UAV and is used by the UAV when a UAV session is established with a
UTM/USS
\- The UAV uses the RITI to identify the UTM (endpoint) and establish a UAV
session. The UAV ID is used as the means to remotely identify a UAV via
broadcast information and for UAV sessions over user plane connectivity
between the UAV and UTM.
### 6.26.3 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
The procedure for establishment of a PDU session for UAV operations is shown
below:
Figure 6.26.3-1: Establishment of a PDU session for UAV operations
0\. **UAV registration** : A UAS operator registers the UAV, providing the PEI
of the UAV device to a UTM/USS with a procedure which is out of scope of 3GPP.
The registration procedure includes details of the UAS operator, pilot, UAV
make and model etc. The UTM/USS may assign a CAA-Level UAV ID.
1\. **UAV Flight Authorisation Request** : A UAS operator requests flight
authorisation from the UTM/USS provider. At this step the UAS operator
provides information identifying the UAV device (i.e. the PEI) and flight path
information. The UTM/USS authorises the request and may assign a Flight
Authorisation ID. This procedure is also out of scope of 3GPP.
2\. UAV is configured with the Flight information (may include Flight
Authorisation ID if provided by the UTM/USS). This operation is also out of
scope of 3GPP.
3\. The UAV registers with the 5GC of PLMN-a by performing a normal 5G
registration procedure.
4\. During the procedure the AMF obtains the PEI of the UAV.
5\. During registration an optional UUAA procedure may be initiated by the AMF
as described in Solution 5.
6\. When the UAV requires connectivity to convey remote identification and
tracking information for UAV operation to a UTM/USS the UAV initiates a PDU
Session Establishment Request including an indication that the PDU session is
required for UAV operation. The UAV includes in a UAV operations transparent
container, the CAA-Level UAV ID and the Flight Authorisation ID of the
associated flight path if provided by the UTM/USS in step 1.
Editor\'s note: It is FFS if the \"indication for UAV operation\" in the PDU
Session Establishment Request is explicitly (i.e. specific UAV operation
indication) or implicitly (i.e. specific DNN, S-NSSAI) included.
7\. The AMF first selects an SMF that is capable to support PDU Sessions for
UAV operation and forwards the PDU session establishment request to the
selected SMF. This message includes the \"UAV operation request\" indication,
the UAV operations transparent container, the PEI of the UAV and the present
location of the UAV, i.e., the present Tracking Area Identity (TAI) and Cell
Identity (CID) of the UAV. The \"UAV operation request\" indicates to SMF that
the requested PDU Session is needed in order to support UAV operations (e.g.
in order to allow a UAV to fly according to an authorized flight plan).
8\. The SMF/UFES obtains the SM subscription data of the UAV from UDM and
selects a UTM/USS to verify the UAV is authorised for UAV operation. The
SMF/UFES select a UTM/USS based on the present location of the UAV and the
CAA-level UAV ID provided by the UAV.
9\. The SMF/UFES sends a UAV Operation Request message to UTM/USS which
includes the PEI, the UAV operations transparent container and the present
location of the UAV. This message is sent to the UTM/USS via UAV6 reference
point.
10\. The UTM/USS authorises the request and determines the RITI. The RITI
includes; a globally unique CAA-Level UAV ID, generated by the UTM/USS, that
is used as a means to remotely identify the UAV and also includes the UTM
endpoint address for the UAV to report data. In addition, the UTM/USS may
determine Authorisation Data that include the authorised area & time where the
UAV can operate.
NOTE: At this point the UTM/USS verifies that the UAV s authorised for UAV
operation based on PEI of the UAV and, if provided, the CAA-Level UAV ID and
Flight Authorisation ID.
11\. UTM/USS sends a UAV Operation Accept response to SMF via UAV6 reference
point including the RITI. The UTM may also provide Authorisation Data denoting
conditions that this PDU session is authorised to be active (e.g. location
area/time).
12\. The SMF/UFES stores the authorization data and may subsequently use it to
determine if the UAV operates in compliance within this data, e.g. if it
remains within the authorized area of operation.
After this step, the SMF may interact with the PCF, as normally, and receive
PCC rules applicable to the PDU Session for UAV operation. As an example,
these PCC rules may contain QoS information that should be applied by the
radio access network for establishing the resources needed to support the UAV
operation.
13\. The SMF sends a PDU Session Establishment Accept message that contains
the RITI to the UAV.
14\. The UAV broadcasts the CAA-Level UAV ID which is used for remote
identification of the UAV over the air.
15abc. The UAV also uses the UAV ID to report flight information data (i.e.
position, speed altitude etc) to the UTM (endpoint) identified by the received
RITI. The UAV ID is used by the UTM to associate the UAV with a valid flight
authorization.
16\. The UTM receives the UAV data provided by the UAV and identifies / tracks
the UAV.
### 6.26.4 Impacts on Existing Nodes and Functionality
The solution has impacts in the following entities:
\- UAV:
\- Include a new indication for UAV operation when requesting a PDU session.
\- SMF:
\- Determining a PDU session is for UAV operation.
\- Request authorisation for UAV operation to a UTM/USS (via a UFES) via a new
reference point UAV6.
## 6.27 Solution #27: Replacement of the UAV Controller of a UAS
### 6.27.1 Introduction
This solution addresses the requirement \"An UAV Controller can be removed
from a UAS and replaced with another UAV Controller or a TPAE\" (see clause
4.2), as part of Key Issues 3 and 6.
This solution assumes that the UAV is already registered and authorized within
the 3GPP systems, as well as within the CAA/UTM system, and that this UAV is
already communicating with UAV Controller 1, associated with a USS. UAV
Controller 1 is replaced by UAV Controller 2, which is associated with the
same USS.
As for Solution 5, a UAV Flight Enablement Subsystem (UFES) may be used in the
3GPP system, to provide a single interface to the USS, thus limiting the
impacts to the 3GPP system.
### 6.27.2 Procedures
#### 6.27.2.1 5GS Procedure
Figure 6.27.2.1-1: Procedure for replacing the UAV Controller of a UAS
1\. The UAV is communicating with UAV Controller 1.
2\. The USS sends a UAV Operation Update to the SMF (via UFES if applicable),
containing new authorized UAV and UAV Controller pairing information.
NOTE 1: Other solutions define the content of such UAV and UAVC pairing
information, e.g. 3GPP UAV IDs and corresponding IP addresses. How the IP
addresses of UAV and UAVC are available to the USS/UTM is also described in
other solutions.
3\. The SMF configures user plane connectivity for UAV to UAV Controller 2
communication based on information provided by the USS (e.g. policies and/or
UTM authorized UAV and UAV Controller pairing information ) to enable user
plane connectivity between the UAV and the UAV Controller 2 and disable user
plane connectivity between the UAV and the UAV Controller 1.
NOTE 2: The configuration includes configuring over N4 traffic filters with
the IP addresses received at step 2 that enable/disable UAV and UAV controller
connectivity, QoS information for data flow, etc., as for a regular IP data
flow.
4\. [Conditional] If UAV Controller 1 or UAV Controller 2 is a Networked UAV
Controller, steps 2 and 3 are repeated with the SMF(s) serving UAV Controller
1 and UAV Controller 2, respectively, which may belong to the same or to a
different PLMN.
NOTE 3: The messages can be combined with step 2 if the same UFES is used.
5\. The UAV communicates with UAV Controller 2.
#### 6.27.2.2 EPS Procedure
Figure 6.27.2.2-1: Procedure for replacing the UAV Controller of a UAS
1\. The UAV is communicating with UAV Controller 1.
2\. The USS sends a UAV Operation Update to the P-GW (via UFES if applicable),
containing new authorized UAV and UAV Controller pairing information.
NOTE 1: Other solutions define the content of such UAV and UAVC pairing
information, e.g. 3GPP UAV IDs and corresponding IP addresses. How the IP
addresses of UAV and UAVC are available to the USS/UTM is also described in
other solutions.
3\. The P-GW configures user plane connectivity for UAV to UAV Controller 2
communication based on information provided by the USS (e.g. policies and/or
UTM authorized UAV and UAV Controller pairing information ) to enable user
plane connectivity between the UAV and the UAV Controller 2 and disable user
plane connectivity between the UAV and the UAV Controller 1.
NOTE 2: The configuration includes configuring over N4 traffic filters with
the IP addresses received at step 2 that enable/disable UAV and UAV controller
connectivity, QoS information for data flow, etc., as for a regular IP data
flow.
4\. [Conditional] If UAV Controller 1 or UAV Controller 2 is a Networked UAV
Controller, steps 2 and 3 are repeated with the P-GW(s) serving UAV Controller
1 and UAV Controller 2, respectively, which may belong to the same or to a
different PLMN.
NOTE 3: The messages can be combined with step 2 if the same UFES is used.
5\. The UAV communicates with UAV Controller 2.
### 6.27.4 Impacts on services, entities and interfaces
For 5GS: an \"update\" operation is added to the SMF service that receives the
authorisation data from USS. This may be a new service or an update of an
existing one, to be determined during normative phase.
For EPS: the reference point between the P-GW and the UFES or USS for
authorisation data is extended to allow update of the authorisation data.
# 7 Evaluation
Editor\'s note: This clause will provide a general evaluation of the
solutions.
## 7.1 Evaluation on Key Issue #4
Evaluations on solutions addressing key issue #4 are as follows:
Solution 1 supports unknown UAV tracking, i.e. 3GPP network can provide UAV
list for the UAVs in the target area to UTM/USS. AMF is enhanced to support a
new event \"identity list of aerial UEs in the target area\".
Solution 2 just provides an architecture for UAV operation but does not show
the details. The solution is incomplete.
Solution 4 re-uses the existing \"monitoring\" capability exposed by the 5G
network. The NEF and the SCEF both offer the MonitoringEvent and the
AsSessionWithQoS APIs, which can be used by an application server to track
mobility and session related events for a certain UE. The UTM/USS will be able
to directly call the above-mentioned NEF API\'s for UAV and UAVC tracking
purposes.
Solution 9 support both unknown UAV tracking and tracking for known UAVs. For
unknown UAV tracking, proposes that TPAE subscribed to the 5G network by
proving the area identity, which is used to let the network to report the UAV
identity present in the area. For known UAV tracking, the tracking info is
reported by UAV to UFES and stored in UDM for later tracking request.
Solution 13 3GPP network, using current area of interest mechanism, monitor
and report the UAV presence (i.e. for UAV moving in or out) of the monitoring
area to UTM/USS. This is applicable when the monitoring area received from
UTM/USS can be mapped to 3GPP network area. It\'s also possible for SMF, based
on the rule preconfigured by UTM/USS, to take the preconfigured network layer
action when the AOI report is received from AMF.
Solution 14 proposes the UTM to provide UAV UE trajectory to the 5GS (UAVF).
It is the UAVF to subscribe to the GMLC of the UAV periodic location. When
UAVF is notified of the UAV location, it verifies whether the UAV current
location is problematic according to the UAV trajectory received before.
Solution 15 re-uses R16 LCS mechanism by the UTM to request UAV location. But
it requires the GMLC to support querying with CAA-level UAV ID.
Solution 16 proposes that the UTM/USS might subscribe to the 3GPP network on
UAV geographical location and/or its presence in a geographical area for one
time or multiple times. A Unified Location Service Exposure procedure can be
applied, in which UTM/USS sends the subscription request to NEF. The UTM/USS
may look up the CAA-level UAV ID, retrieve 3GPP UE ID (e.g. GPSI), and include
the CAA-level UAV ID and 3GPP UE ID together with the target geographical area
in the subscription request message to the NEF. The solution reuses existing
LCS mechanism and 5G exposure capability, while the GMLC needs to be enhanced
to determine UE presence in an area of interest.
Solution 17 proposes that UTM can request 5GS to execute specific
verifications regarding to target UAV, such as verify whether the UAV taking
off site is within a restricted zone or not. This request may include the UAV
identity, UAVC identity, UAV current location, and also indicate which
verification type core network is requested to execute. The solution also re-
uses existing LCS mechanism which allows the LCS client (UTM) to request the
(UAV)UE location.
Solution 25 is a solution supported by multiple companies in S2-140e meeting;
partially merge the solution 1, 9, 13, 14, 15, 16. 3GPP network supports
several options for UAV and UAVC tracking:
1) reporting the UAV/UAVC location;
2) monitoring and reporting the UAV presence (i.e. for UAV moving in or out)
of the monitoring area;
3) support unknown UAV tracking, i.e. providing UAV list for the UAVs in the
target area; and
4) support to receive preconfigured rule(s) from UTM/USS.
then base on the preconfigured rule(s), take immediately network layer action
when the AOI report is received from AMF. All the enhancements are at UAVF
which may encompass the NEF/SCEF functionality, No impact to other NF (than
NEF). In addition, an optional indication to request network to calculate
simultaneous the UAV and UAVc location, by which UTM can calculate the
distance between the UAV and UAVc.
Above all, it is observed that solution 25 for CP and solution #4 for UP cover
the proposal of all solutions.
Editor\'s NOTE: Further evaluation on solution 25 and solution 4 may be
provides.
## 7.2 Evaluation on key issue #5
Evaluation of all solutions addressing key issue 5 in the TR is as following:
Solution 2 is incomplete thus no need to evaluate it.
Solution 4 proposes the NEF and the SCEF both offer the AFSessionWithQoS API
which can be used by an application server to activate, modify and revoke
policies for specific data flows on a specific PDU-session/PDN-connection.
Further evaluation on solution 4 will be provided.
Solution 5 merged solution #6, #7 in meeting 140e. The three options proposed
in the solution for UAV authorization can also be used for authorization
revocation and re-authorization, triggered by the 5GS. There is an additional
revocation procedure triggered by UTM/USS is specifically described in
solution 18.
UUAA authorization and re-authorization should have a unified solution, and
revocation of the previous authorization is considered as the result of re-
authorization. We should also allow the revocation procedure triggered by the
UTM/USS, which is covered by solution 18.
Solution 16 also proposes no particular solution for key issue 5. It mainly
addresses key issue \"tacking of UAV\" and probably the UAV location retrieved
by UTM is the pre-condition for UAV authorization revocation. This aspect is
covered by solution 5 and solution 18.
Solution 17 considers the aspect of key issue 5 on \"re-authorization of
UAV\". Paper S2-2005666 is updating the solution by resolving the FFS.
Evaluation can be done in the next meeting when the solution is more stable.
Solution 18 proposes how UTM can trigger the UAV authorization revocation and
re-authorization.
Solution 19 discusses the scenario for switch of the UAV control from a first
controller to another controller. It proposes these parameters sent from the
UTM to 5GS: cause (UAV control switched), UAV ID, UAS ID, PDU session ID. The
solution has a tight dependency on the conclusion of key issue 6, thus it is
suggested to evaluate the solution key issue 6 conclusion/principle is
reached.
Solution 22 does not show clearly how the UAV authorization is done so it is
incomplete in terms of key issue 5.
Solution 23 proposes that UAV authentication and authorization is done by
USS/UTM during PDU session (PDN connection) establishment, using secondary
authentication and authorization procedure or service-based mechanisms with
the USS via the NEF/SCEF or a new network function. The result is notified to
SMF or NEF/SCEF or the new network function, respectively. The options
proposed in this solution for UAV authorization can also be used for
authorization revocation and re-authorization triggered by the 5GS.
To summarize, solution 5 and 23 addresses key issue 5 covering all use cases
and should be chosen as baseline for the normative work.
## 7.3 Key Issue #6: UAV Controller and UAV association
Sol#2: This solution has no specific details on how to address this key issue.
Sol#4: This solution proposes that UAV/UAVC pairing authentication and
authorization is handled on application layer and is out of SA WG2 scope.
Sol#5: This solution proposes that UAV/UAVC pairing authentication and
authorization is done by USS/UTM using the PDU session secondary
authentication and authorization procedure or service-based mechanisms with
the USS via the UFES (which may encompass NEF/SCEF), the result is notified to
SMF or SMF and UFES, respectively.
Sol#20: This solution proposes that UAV/UAVC pairing authentication and
authorization is done by USS/UTM during PDU session secondary authentication
and authorization procedure, the result is notified to SMF.
Sol#21: This solution proposes that UAV/UAVC pairing authentication and
authorization is done by USS/UTM and the result (including a UTID) is notified
to the PLMN/UAV/UAVC before PDU session setup, hence, the SMF can re-
authenticate/authorizes the UAV/UAVC based on the result and the UTID during
PDU session setup.
Sol#23: This solution proposes that UAV/UAVC pairing authentication and
authorization is done by USS/UTM using the PDU session secondary
authentication and authorization procedure or service-based mechanisms with
the USS via the NEF/SCEF or a new network function. The result is notified to
SMF or NEF/SCEF or the new network function, respectively.
Sol#27: This solution proposes that USS/UTM provides new authorized UAV/UAVC
pairing information to SMF.
## 7.4 Comparison of sol #4 to CP solutions
Solution #4 is defined as a user plane solution compared to the other
solutions (e.g. #5 and #23) which can be defined as control plane solutions as
the latter are using the NAS signalling from the UAV UE and the CN control
plane for application info transfer between 3GPP network and the USS/UTM.
Table 7.4-1
+----------------------+----------------------+----------------------+ | Items | Solution #4 | Control Plane | | | | solutions | +======================+======================+======================+ | UAV UE | No effects as using | New API between UAV | | | UP | app and UE to | | | | transfer application | | | | info over NAS | +----------------------+----------------------+----------------------+ | NAS Protocol | No | New application info | | | | parameters and new | | | | NAS procedures e.g. | | | | for additional UUAA | | | | roundtrips. | +----------------------+----------------------+----------------------+ | Core Network | New UAS AF. | New UFES | | | | | | | Updates to handle | Updates to AMF and | | | subscription | SMF to handle | | | requests from UAS AF | application info and | | | may affect AMF and | subscription info. | | | PCF. | | +----------------------+----------------------+----------------------+ | RAN | No | No | +----------------------+----------------------+----------------------+ | Interface to USS/UTM | New web-based | New web-based | | | interface between | interface between | | | UAS AF and USS/UTM | UFES and USS/UTM if | | | | UFES type AF used in | | | | all CP solutions. | +----------------------+----------------------+----------------------+ | Support of UAV | Full support | Full support | | features | | | +----------------------+----------------------+----------------------+ | Support of USS/UTM | Full support | Full support | | features | | | +----------------------+----------------------+----------------------+
## 7.5 Evaluations on key issue #7
Following table summarises the solutions that have been proposed for KI#7 and
also provide an overview of evaluation and impacts.
Table 7.5.1: Summaries and evaluation on solutions for KI#7
+----------------------+----------------------+----------------------+ | Solution number | Solution\'s proposal | Evaluation | | | for KI#7 | | +======================+======================+======================+ | **Sol#2: 3GPP | Proposes an | No evaluation | | reference | architecture for UAS | possible as there is | | architecture for UAV | feature and no | no description on | | remote | specific procedures | management and | | identification** | for this KI. | control of user | | | | plane. | +----------------------+----------------------+----------------------+ | **Sol#4: Solution | UAV and UAVC to use | Solution assumes | | using User plane for | a single PDU session | single PDU session | | UAV identification | (one for each of the | for communicating | | and authorization** | UAV and UAVC) for | with UTM and C2 | | | all services | connection with | | | (including support | UAV-C. | | | for C2 connections) | | | | | USS/UTM provides | | | Specific or | dedicated policies | | | dedicated policies | via new NF (UASF) / | | | are provided to | NEF / SCEF for user | | | USS/UTM to guide | plane resource | | | requesting and use | control and | | | of user plane | management and for | | | resources | configuring C2 | | | | connectivity. | | | | | | | | The solution works | | | | for both 5GS and | | | | EPS. | +----------------------+----------------------+----------------------+ | **Sol#5: UAV | Authentication and | Authentication and | | authentication and | authorization are | authorization by | | authorization by | sought with USS/UTM | USS/UTM are sought | | USS/UTM based on NAS | before user plane | for UAV request for | | supplementary and | resources provided. | user plane | | secondary | 3GPP system is | resources. | | authentication and | informed of outcome. | | | authorization | Single PDU or | Solution supports | | procedures** | separate PDU | single or multiple | | | Sessions for both | PDU Sessions. | | | UAV-USS/UTM | | | | communications and | USS/UTM provide | | | for C2. | traffic filters to | | | | manage C2 | | | The UAV/UAV-C | communication. | | | provides extra UAV | | | | operation indication | Solution works for | | | in the PDU Session | both 5GS and EPS. | | | request. | | | | | | | | Traffic filters | | | | (provided by | | | | USS/UTM) are | | | | installed in 3GPP | | | | for the C2 | | | | connection | | +----------------------+----------------------+----------------------+ | **Sol#13: Area of | USS/UTM provides to | Policies and rules | | Interest for support | 3GPP CN traffic | from the USS/UTM are | | of UTM\'s | routing policies. | applied to the user | | geofencing** | These configured | plane resource | | | policies are applied | control and | | | by SMF to the | management. Allowing | | | traffic over the | network entities to | | | allocated user plane | act at network layer | | | resources for UAV | based on those | | | connectivity. | provided policies | | | | and rules. | | | | | | | | Solution works for | | | | both 5GS and EPS. | +----------------------+----------------------+----------------------+ | **Sol#21: | The solution allows | Support of single or | | Connectivity setup | a single or separate | multiple PDU | | for C2 communication | PDU session for | Sessions from UE to | | and association | communicating with | different end points | | between UAV and | the UTM and C2 | services are already | | UAV-C** | connection but focus | in 5GS. | | | on the establishment | | | | of a dedicated C2 | UAV has to | | | connection. | explicitly indicate | | | | request for user | | | The UAV/UAV-C | plane resources is | | | provides extra C2 | for C2 | | | communication | communications. Such | | | indication and | request will have to | | | CAA-level ID in the | be authenticated and | | | PDU Session request. | authorized by the | | | | USS/UTM. | | | The use of dedicated | | | | C2 connection also | The solution is | | | depends on an | complete and | | | authorization by | addresses both 5GS | | | USS/UTM (in addition | and EPS | | | to pairing | | | | authorization). | | | | | | | | The transport | | | | address of UAV/UAVC | | | | for C2 connection is | | | | exchanged through | | | | USS/UTM to enable | | | | end-to-end | | | | communication. | | +----------------------+----------------------+----------------------+ | **Sol#23: UAV/UAVC | Separate PDU | Support of single or | | authenti | Sessions for UAV to | separate PDU | | cation/authorization | USS/UTM and UAV to | sessions for UAV to | | by USS/UTM and C2 | UAVC i.e C2 | USS/UTM and for C2. | | communication | communications. IP | USS/UTM required to | | establishment** | addresses of UAV & | \"pass on\" end | | | UAVC obtained | point IP address for | | | through USS/UTM over | C2. | | | one PDU Session. | | | | Then a separate PDU | Policies and rules | | | Session for C2 | from the USS/UTM are | | | communications as | applied to the user | | | data over user plane | plane resource | | | to the provided IP | control and | | | addresses. | management. Allowing | | | | network entities to | | | | act at network layer | | | | based on those | | | | provided policies | | | | and rules. | | | | | | | | The solution is | | | | complete and | | | | addresses both 5GS | | | | and EPS | +----------------------+----------------------+----------------------+ | **Sol#25: Network | USS/UTM provides to | Policies and rules | | Exposure to support | 3GPP CN traffic | from the USS/UTM are | | UAV and UAVC | routing policies. | applied to the user | | tracking** | These configured | plane resource | | | policies are applied | control and | | | by UAVF to the | management. Allowing | | | traffic over the | network entities to | | | allocated user plane | act at network layer | | | resources for UAV | based on those | | | connectivity. | provided policies | | | | and rules. | | | | | | | | Solution works for | | | | both 5GS and EPS. | +----------------------+----------------------+----------------------+ | **Sol#26: UAV | While this solution | No evaluation | | establishing user | indicates it | possible | | plane connectivity | addresses KI#7, | | | for remote | there is no | | | identification & | description of how | | | tracking for UAV | user plane resources | | | operations** | for UAV connectivity | | | | (between UAV and | | | | UAVC) are requested, | | | | allocated and | | | | managed | | +----------------------+----------------------+----------------------+
From the table of summary above, the following evaluations are arrived at:
\- Common among solutions is that request for resources for UAV UAVC
connectivity go through USS/UTM authentication and authorization.
\- Sol#4 uses single PDU Sessions/PDN Connections to managed UAV to UAVC
connection as well as exchange with USS/UTM, other solutions (Sol #20)
supports using separate PDU Sessions/PDN Connections, while Sol#5, Sol#21 and
Sol#23 supports both. In terms of using single or more PDU session / PDN
connections, that should have no direct impact to existing PDU Session/PDN
Connection handling, other than that solutions (Sol#5, #21, #23) suggesting a
new indication is introduced to indicate the request for resources is for C2
communication.
\- For the purpose of peer-to-peer C2 communication, solutions exist (Sol#20,
#21, #23) that propose that when the PDU Session/PDN connection is
established, the 3GPP system reports the device\'s transport address for C2
communication to the UTM/USS. The UTM/USS informs the serving 3GPP system of
the peer device\'s transport address for C2 communication.
\- The majority of solutions further suggests that USS/UTM can provide to the
3GPP system traffic routing polices and filters to enable C2 communications.
# 8 Conclusions
Editor\'s note: This clause will capture conclusions from the study.
## 8.1 General
The following principles are applied, as applicable, when developing UAV
support in 3GPP:
No commercial relationship is assumed between the 3GPP Network and a USS/UTM,
in order to enable an UAS operator to change the serving USS/UTM while
remaining with same 3GPP Network subscription, and vice versa. The 3GPP
Network subscription for the UAV cannot be assumed to contain any information
about the USS/UTM based on a commercial relationship between the 3GPP Network
and the USS/UTM.
In the scope of this release, a networked UAVC is considered as a regular UE
that is not subject to any aerial features or any additional authorizations
involving the USS/UTM.
The following conclusions are proposed for normative work:
1) standardize a new 3GPP UAS Network Function for support of aerial
functionality related to UAV identification and tracking, and to support
Remote Identification.
\- The UAS-NF is based on the functional definition of UFES of solution #5
plus the UAVF of solution #25.
\- The UAS-NF makes use of existing NEF/SCEF exposure services for UAV
authentication/authorization, for UAV flight authorization, for UAV-UAVC
pairing authorization, and related revocation; for location reporting, and
control of QoS/traffic filtering for C2 communication.
Current NEF/SCEF services and APIs will be leveraged to the maximum extent:
enhancements may be defined during normative work.
2) Consider the integration of the new NF in the NEF/SCEF.
3) Standardize a control plane solution for interfacing of the UAV and the
5GS/EPS with the USS/UTM, focusing on solutions #5 and #23 and aiming at a
single solution being standardized.
4) Keep dependency to application related information and functionality as
much as possible outside the 3GPP network.
5) Maximize the similarities between a 5GS and EPS solution.
6) Allow for deployment models where the USS/UTM and the UAVC are executing in
cloud environments and where the corresponding C2 communication with the UAV
are based on Web technologies (e.g. web-sockets, GRPC etc.). Due to
intermediate NATs and Proxies, knowledge about originating IP-addresses of
requests cannot be assumed on application level.
7) there is a trust relationship between the 3GPP system and the USS as in the
case of any other external system interfacing via service exposure and/or IP
traffic with the 3GPP system.
The following conclusions apply:
\- A UAV is registered with CAA authorities either before connecting with the
3GPP system or using plain internet connectivity via the 3GPP system. During
such registration the UAV is assigned a CAA-level UAV-ID.
\- A UAV when it requests for UAS services (i.e. to take advantage of aerial
features, connectivity with USS/UTM for Networked Remote Identification, and
C2 connectivity) also provides the CAA-Level UAV ID and aviation level
information to 5GS or EPS. The aviation level information is transparent to
the 5GS/EPS. A UAV that has not performed a registration with CAA authorities
shall not attempt to request for UAS services.
The 3GPP systems provides a mechanism to support the
authentication/authorization procedure between the UAV and the USS/UTM. During
this procedure, the USS/UTM may access additional information from the 3GPP
system to decide about the authentication/authorization and provides
information about the result of the authentication/authorization.
\- The EPS/5GS discovers the USS/UTM as described in solution #5 in clause
6.5.2.3, with the differences identified in the conclusions of key issue #2.
This happens either during 5GS registration (when the UUAA is performed during
5GS registration), or during PDU session/PDN connection establishment.
\- During the UAV authentication/authorization procedure, the 3GPP system
provides 3GPP identities/information for the UAV including the GPSI,
optionally the PEI, the CAA-Level UAV ID and any aviation level information
the UAV has provided to the 3GPP system. The USS/UTM uses such information for
the authentication/authorization and for future interactions with the 3GPP
system regarding the UAV via NEF/SCEF.
\- the 3GPP system supports USS/UTM authorization of pairing between a UAV and
a networked UAVC or a UAVC that connects to the UAV via Internet connectivity
during the establishment of the PDN connection/PDU session for UAS services
(i.e. connectivity to USS/UTM and for C2 traffic). Modifications or
establishment of the pairing or re-authorization take place via modification
of the established PDN connection/PDU session. During such procedures, the
USS/UTM provides to the 3GPP system information (e.g. QoS requirement, data
flow descriptors, etc.) that enable traffic between the UAV and the UAVC. How
the USS/UTM is made aware of the UAVC is outside the scope of 3GPP in this
Release.
\- For EPC, the PDN connections used by UAV are served by a combo SMF+PGW-C
regardless of whether the UAV support 5G NAS or whether their subscription
allows access to 5GC. This reduces (or removes completely) the impact on
legacy network elements like SGW, PGW and allows reusing common procedures in
EPC and 5GC for PDN connection (or PDU session) establishment. The APNs used
by the UAV for contacting USS/UTM or for C2 communication always resolves to
an SMF+PWG-C.e
## 8.2 Key Issue #1
A UAS operator registers the UAV to a UTM/USS with a procedure which is out of
scope of 3GPP. The UTM/USS assigns a CAA-Level UAV ID.
An UAV is identified by USS/UTM using a CAA-level UAV ID assigned by USS/UTM,
and identified by the 3GPP System using a 3GPP UAV ID assigned by the MNO.
The CAA-level UAV ID is used for Remote ID functionality (network or broadcast
remote ID). Remote Identification support by 3GPP in the scope of this release
applies to the UAV, not to UAV Controller. In the scope of this release, it is
assumed that the assignment of a CAA-level UAV ID for Remote Identification
functionality applies solely to the UAV, as defined in Remote Identification
standards and regulatory documents. No CAA-level UAV ID is assigned to and
used by a networked UAVC and UAVC that exchange data (e.g. C2 information)
with the UAV via Internet connectivity.
Both USS-assigned CAA-Level UAV ID and 3GPP Assisted CAA-Level UAV ID
Assignment are supported, as described in solution #9.
Various formats of CAA-level UAV ID must be supported by the UAV to support
various geo-specific regulations. At least _Serial Number Identification_ , a
_CAA-Issued Registration Identifier (aka Session ID),_ and _USS/UTM-Issued
UUID_ shall be supported.
It is assumed that the mechanisms for resolution of CAA Level UAV ID to the
USS serving the corresponding UAV, defined outside 3GPP, and available to
entities outside the 3GPP system (e.g. the TPAE), are used in the 3GPP system
to discover the USS for the UAV. It may be also possible to use other UAV
information (e.g. UAV-provided USS address or FQDN) sent by the UAV to 3GPP
system, to be used by the 3GPP System, to discover the USS for the UAV. 3GPP
system is provided the CAA-level UAV ID by the UAV, and it may optionally
provide the CAA-level UAV ID to the UTM/USS when providing MNO services
towards the UTM/USS (e.g. at first UUAA procedure to create an association in
the USS between the CAA-Level UAV ID and the 3GPP UAV ID).
The USS/UTM is made aware of the 3GPP UAV ID of the UAV during procedures of
UAV authorization supported by the 3GPP network. This is provided explicitly
to the USS/UTM by the 3GPP system UAS NF. The 3GPP UAV ID is either provided
to the UAS NF by the AMF (if UUAA is performed at registration), by the SMF,
or via augmentation by the SMF+PGW. In addition, the 3GPP system also includes
information about the subscription identity used (GPSI/External-id/MSISDN),
optionally the IP-address allocated to the PDU-session and optionally also a
3GPP equipment identifier (PEI/IMEI/IMEI-SV).
The USS/UTM uses the 3GPP UAV ID to invoke MNO services (e.g. exposure
function or location services) or during authorization or authorization
revocation. The 3GPP UAV ID is in the format of a GPSI, and at least the
External Identifier is supported.
The External Identifier is allocated by the 3GPP network without interaction
with the USS/UTM and must be unique within the geography (e.g. at least
country) of the 3GPP network.
An UAS Network function implementing the functionality of the UFES as
described in solution #9 is used to support 3GPP Assisted CAA-Level UAV ID
Assignment. The interaction between the 3GPP system and the TPAE over UAV2
(e.g. for Remote Identification query) is out of the scope of 3GPP and is
expected to be defined in aviation standards.
The CAA-Level UAV ID assigned by the USS is known and may be stored in the
UFES, in particular in the case of 3GPP Assisted CAA-Level UAV ID Assignment.
Whether specific mechanisms are needed for interworking between EPS and 5GS,
and what the mechanisms are, will be defined during the normative phase.
## 8.3 Key Issue #2
An UAV is authenticated and authorized by USS/UTM via a USS UAV Authentication
& Authorization (UUAA) with the support of the 3GPP system before connectivity
for UAS services (e.g. UAS-USS connectivity for NRID) is enabled.
Depending on 3GPP network operator and/or regulatory requirements, the UUAA is
performed:
\- in 5GS: either as a separate procedure during the 5GS registration
procedure (see clause 6.5.3.1.1), or when the UAV requests user plane
resources for UAV operation (i.e. PDU session establishment) (see clause
8.X.1). From a UE implementation point of view it is mandatory to support UUAA
during Registration and PDU session establishment procedure. From a network
deployment point of view it is mandatory to support UUAA during PDU session
establishment procedure.
\- in EPS: during the attach procedure and the corresponding PDN connection
establishment (see 6.5.3.2.1)
A UAV that is in possession of a CAA-Level UAV ID provides the CAA-Level UAV
ID in both 5GS Registration and in PDU Session/PDN Connection establishment.
The CN determine whether UUAA is executed at 5GS registration or at PDU
session/PDN Connection establishment based on local policies.
If UUAA is performed at Registration Procedure, the SMF serving the PDU
Session for the UAV (e.g. the PDU session for UAV-USS connectivity and, if
separate PDU sessions are used, the PDU session for C2 connectivity) is
notified by the AMF of the successful UUAA.
If UUAA is not performed during the Registration procedure, the UUAA is
performed at PDU session (or PDN connection) establishment when the UAV
requests user plane resources for UAV operation and the UAV provides its CAA
level Id during PDU session (PDN connection) establishment.
When UUAA is performed at registration, the UAV flight authorization and UAV-
UAVC pairing authorization is performed at PDU session/PDN connection
establishment/modification procedures.
The execution of the USS UAV Authentication & Authorization during the
registration procedure is optional and is based on specific PLMN policies, USS
requirements, and geographic regulatory requirements.
The USS UAV authentication & authorization procedure is supported as follows:
\- A UAV registers with the 3GPP system using 3GPP credentials
\- The UAV configured and provisioned to perform UUAA (i.e. at a minimum
having a CAA-Level UAV ID allocated during a UAV registration with USS) always
provides a CAA Level UAV identity to the 3GPP system when it registers for UAV
services. The 3GPP system determines whether to initiate UAV
authentication/authorization based on request from UAV, subscription, local
policies, and optionally results of previous authentication/authorization.
NOTE: The details of how the CAA Level UAV ID is provided (e.g. a specific
parameter or a transparent container) will be defined during normative work.
\- USS UAV authentication and authorization by USS/UTM is conditional on the
UE having performed successfully a primary 3GPP authentication and with Aerial
UE function as part of the subscription.
\- An UAV is authenticated and authorized by USS/UTM using a CAA-level UAV ID.
The credentials and related authentication method used by the UAV and UTM/USS
are outside of the 3GPP scope.
\- The UAV may also include an UUAA Aviation Payload containing application
layer information that is transparent to the 3GPP System. Requirements on the
transport (e.g. transparent container) of such payload will be defined during
the normative phase in conjunction with the aviation community.
\- The 3GPP network shall be informed by the USS/UTM of the UAV authentication
and authorization result and enforce the result accordingly. Upon successful
UAV authentication and authorization by USS/UTM, UAV is authorized to
establish limited connectivity to communicate with USS/UTM.
\- If the result of the UAV authentication and authorization indicated by the
USS/UTM is negative, the UAV is informed by the 3GPP system that USS/UTM
authentication and authorization has failed.
A UAV request for user plane connectivity to the 3GPP system for UAV
operations (i.e. C2 between a UAV and a networked UAV controller or a UAVC
that connects to the UAV via Internet connectivity, and/or flight
authorization request) may also require additional authorization by the
UTM/USS, as described in conclusions of KI#7.
Details of authentication and authorization applicable to the single PDU
session/PDN connection for USS and UAV-C connectivity, and separate PDU
sessions/PDN connections for USS and UAV-C connectivity are supported, are
described in conclusions for KI#7.
The following applies:
\- It shall be noted if the UUAA is performed at registration there will not
be any connectivity (i.e. PDU Session) set up between the UAV and the USS/UTM
at that time.
\- For the USS/UTM to be able to interact with the MNO e.g. regarding
providing session-related policies, the USS/UTM needs information about the
PDU Session/PDN Connection (e.g. UE IP address) which is only available after
PDU session establishment. This means that such session-related policies can
be communicated to the MNO only during the PDU Session/PDN Connection
establishment
\- When the UAV requires connectivity for UAV services (i.e. connectivity with
USS/UTM and possibly connectivity with UAVC), the UAV initiates PDU session
establishment request to a well-known DNN/APN, as defined e.g. by GSMA for
UAV/UTM interaction.
\- The 3GPP system ensures that such an authorization request received from an
UE, which is properly authenticated and authorized as a UAV, is safely
forwarded with guaranteed integrity to the requested USS/UTM, if there is a
mutual trust relation between the 3GPP system and the USS/UTM.
\- The 3GPP system ensures that the used UE subscription is allowed for
aerial/UAV use
\- Based on the information included in the authorization request and
information registered for the UAV the USS/UTM authorizes the UAV as being
under control of the USS, and either explicitly (when UUAA is done at PDU
session establishment) or implicitly (when UUAA is done at registration) that
the PDU-session to be used for that purpose. Essential input to this decision
is the CAA-level UAV-ID verified (e.g. authenticated by USS/UTM) and the
correlated information from the 3GPP system that the used UE is approved for
aerial/UAV usage. In addition, the USS may take the correlated and
authenticated info on the used subscription (3GPP UAV ID, i.e. the GPSI) and
optionally the 3GPP equipment (PEI) into account as a multi factor
authentication input for the authorization decision.
\- After PDU session/PDN connection for traffic between the UAV and the USS
and for C2 is (are) established, the USS may store the correlated GPSI and PDU
session IP address(es) with the authorized CAA-Level UAV-ID to enable further
service requests via network exposure APIs to the 3GPP system related to the
authorized UAV. The GPSI may e.g. be used to activate monitoring of the UAV/UE
location and the PDU session IP address for requests for dedicated QoS and
gating to be applied for the authorized PDU session. It may also be used to
revoke the established connectivity/PDU-session if it is deemed necessary by
the USS.
### 8.3.1 UUAA In PDU Session Establishment
NOTE 1: UFES in these flows is the same as UAS NF.
In steps 2 - 12 a PDU session for UAV(C) connectivity to USS/UTM is set-up.
This PDU session is used for application level UAV(C) - USS/UTM communication
e.g. UAV tracking, C2 related configuration, UAV/UAVC pairing.
In the case of UAV/UAVC pairing it can be that the UAV and UAVC is in
different operators\' networks and the configuration of the C2 communication
must be handled in each operator\'s network.
Step 13 handles setting up the dedicated policies need for C2, UAV/UAVC
pairing, tracking performed in the 3GPP network, and other exposure
functionality performed by the 3GPP network, etc.
Figure 8.3.1‑1: Authentication/authorization and C2 communication
establishment for UAV/UAVC by USS/UTM via 5GC
1\. The UAV/UAVC registers to the 3GPP network. The UE\'s subscription
information obtained by AMF from the UDM has an indication on support for
Aerial UE function and the AMF provides the subscription information on Aerial
UE authorization to the gNB.
NOTE 2: It is assumed that the UAV has been registered to the CAA level
authority, a CAA-Level UAV ID is available with the UAV/UAVC and the UAV/UAVC
has a USS/UTM address configured.
2\. Once the UAV/UAVC is registered to the USS/UTM, it can initiate a PDU
session establishment request for USS/UTM connectivity and/or C2
communication. The UAV/UAVC shall include the signed USS/UTM address and CAA-
Level UAV ID, etc. in the PDU session establishment request.
3\. Based on the UAV/UAVC UE\'s subscriber profile, DNN and S-NSSAI provided
in the request the AMF selects the SMF and sends
Nsmf_PDUSession_CreateSMContext Request to the SMF, including the USS/UTM
address and CAA-Level UAV ID, etc.
4\. The SMF obtains subscription data from the UDM and performs the necessary
actions for UAV IP address allocation.
If the UUAA is required, the SMF sends an UAV Operation Request (e.g. using a
service interface) to the UFES, including the CAA-level UAV ID, USS/UTM
address, GPSI, PEI, \"allowed for aerial use\", UAV IP Address, etc.
NOTE 3: Security details will be determined by SA WG3.
5\. The UFES selects a USS/UTM from either CAA-Level UAV ID or the USS/UTM
address.\ The UFES checks if the subscription is \"allowed for aerial use\"
and forwards the received information from the SMF to the USS/UTM, using a
service-based interface. The USS/UTM is assumed to be known and trusted by the
3GPP System.
6\. Optionally the USS/UTM and the UAV/UAVC may exchange multiple messages as
required by the authentication/authorization method used.
7\. The USS/UTM validates the request based on CAA-Level UAV ID and GPSI and
optionally PEI. Upon successful authorization, the USS/UTM notifies the UFES
on the authentication/authorization result, including security info to be used
by the UAV to set up a secure connection to the USS/UTM using the PDU
session.\ The USS/UTM stores a mapping between CAA-Level UAV ID and the
External Identifier. The External Identifier and/or UAV IP Address can be used
at a later point by the USS/UTM for accessing various services exposed by 3GPP
network e.g. location information retrieval, monitoring event configuration
etc.\ The External Identifier and/or UAV IP Address can be used at a later
point by the USS/UTM for requesting dedicated policies for e.g. C2, etc.
8\. The UFES sends the authentication/authorization result to the SMF.\ As
alternative to step 13, if C2 and pairing related information is available
from UAV(C) and/or USS/UTM during the initial PDU Session Establishment
procedure the SMF may interact with the PCF to set up PCC rule(s) for the C2
communication and/or UAV/UAVC pairing.
NOTE 4: If the UAV and UAVC are located in different operators network the
dedicated policies needs to be configured in respective operator networks.
9-11. The final parts of PDU Session Establishment procedure are performed.
The security info from step 7 is transferred to the UAV.
12\. A secure connection is set up based on the \"security info\" received
from USS/UTM in steps 7 to 10. The PDU session may further be used for
Networked Remote ID (NRID), Tracking, for C2 related configuration or UAV/UAVC
pairing, etc.
13\. The USS/UTM interacts with the PCF via UFES/NEF to configure dedicated
polices required for setting up C2 communication and/or UAV/UAVC pairing as
\"negotiated\" between UAV(C) and USS/UTM in step 12.
## 8.4 Key Issue #3
In the scope of this release, a network UAVC is considered as a regular UE
that is not subject to any aerial features or any additional authorizations.
## 8.5 Key Issue #4: (UAV and UAV Controller tracking)
Solution 25 is adopted as the basis for normative work with following
principles:
\- 3GPP network supports the following UAV and UAVC tracking capabilities. The
UTM/USS chooses one of, or a combination of, these tracking capabilities to
use. The UTM/USS/TPAE logic on its choice is out of 3GPP\'s scope.
\- reporting the UAV/UAVC location;
\- monitoring and reporting the UAV presence (i.e. for UAV moving in or out)
of the monitoring area. Either the UAVF reuses the Area of Interest event or
location Reporting mechanism supported by AMF/MME, or if the target area or
location cannot be mapped to 3GPP network areas, the UAVF determines the UAV
presence in the monitoring area by comparing the location report from GMLC
with the monitoring area;
\- support unknown UAV tracking, i.e. providing a list of the UAVs in the
target area or location and served by the PLMN. The 3GPP system separates out
the UEs that are actual UAVs based on e.g. available CAA-Level UAV ID,
checking for UEs with aerial subscriptions, and whether the UAV has
successfully registered and has been authorized by the USS/UTM If the target
area or location cannot be mapped to 3GPP network areas, the UAVF will obtain
location of identified UAVs via LCS procedure and compare with the target area
or location to identify the UAVs in the target area or location;
\- may receive policies or rules from USS/UTM for action when Area of Interest
(AOI) reports are received.
\- NEF determines whether to invoke AMF or GMLC procedure.
\- the 3GPP system may provide the UAV location during the
authorization/authentication procedures supported by the 3GPP system in the
interaction between the CN and the USS/UTM, or the USS/UTM may verify the UAV
location during such procedures.
\- All the enhancements are at UAVF which may encompass the NEF/SCEF
functionality.
\- The 3GPP UAV ID is included by the USS/UTM for tracking and to request
location services from the MNO.
\- The CAA-level UAV ID is optionally transmitted by the 3GPP system to the
USS/UTM during tracking and location reporting of UAV as described in solution
#25. The 3GPP UAV ID may also be included in the reports as described in
solution #25.
\- The 3GPP system maps 3GPP UAV ID (e.g. GPSI) when received from UTM/USS to
3GPP internal IDs (e.g. SUPI) according to existing mechanisms.
\- 3GPP system maps the geographic area received from UTM/USS to 3GPP area
(e.g. TAIs/Cell Ids).
## 8.6 Key Issue #5
UAV authorization and authentication may be revoked by the USS/UTM at any time
by invoking MNO services (e.g. exposure function or location services) by
using the 3GPP UAV ID and providing a Revocation Cause indicating this is
authorization and authentication revocation.
Authorization for C2 connectivity and UAV and UAVC pairing may be revoked by
the USS/UTM at any time by invoking MNO services (e.g. exposure function or
location services) by using the 3GPP UAV ID and providing a Revocation Cause
indicating this is C2 or pairing revocation.
## 8.7 Key Issue #6
The functionality to support authorization of UAV and UAV controller pairing
applies to networked UAV Controllers and non-networked UAV controllers that
are connected to UAV via internet (e.g. cloud UAVC).
In the scope of this release, how a UAV and a UAVC are considered as a UAS by
the USS/UTM is outside the scope of 3GPP. However, the 3GPP system may support
the USS/UTM to enforce authorization from the USS/UTM between of a UAV and a
UAVC pairing decision based on their transport addresses.
The UAV/UAVC pairing authentication and authorization is done by USS/UTM
during PDU session secondary authentication/authorization procedure or new
service-based mechanisms with the USS via the NEF/SCEF or a new UAS Network
Function (UAS-NF), the result is notified to either the SMF or the NEF/SCEF or
UAS NF, respectively, i.e. a CP-based signalling mechanism is chosen for
normative work.
The UAV may provide information for the authorization of UAV and networked UAV
controller pairing to USS/UTM. The USS/UTM is required to authorize the
UAV/UAVC pairing, i.e. the UAV requests to be paired with a UAVC. The USS/UTM
informs the results of pairing authorization to the 3GPP system in terms of
identification of the traffic that needs to be enabled.
The 3GPP system should enable a UAV to receive a new CAA-level UAV identifier
from USS/UTM as part of a successful pairing authorization.
When the USS/UTM determines that the UAVC needs to be replaced, the USS/UTM
provides new authorized UAV/UAVC pairing information to the SMF or new UAS NF,
respectively.
For initial pairing authentication and authorization, solution #5 or #23 is
selected as baseline for the normative work.
For UAVC replacement, solution #27 may be taken in addition to improve KI#6.
## 8.8 Key Issue #7
In the scope of this release, a network UAVC is considered as a regular UE
that is not subject to any new mechanisms to enable establishment of user
plane connectivity with a USS/UTM. The networked UAVC uses a PDN
connection/PDU session established according to existing mechanisms to connect
to an USS/UTM.
The procedure for the UAV to request user plane connectivity with UAVC defined
in Solutions #5, #26 is proposed to be taken into account during the normative
phase. The procedure is as follows:
\- Prior to any request by UAV for user plane connectivity with UAVC, or
during the user plane connectivity request, the UAV must obtain flight
authorization from the UTM/USS. The flight authorization must be made known to
the 3GPP system.
\- Single PDU session/PDN connection for USS and UAV-C connectivity, and
separate PDU sessions/PDN connections for USS and UAV-C connectivity are
supported. The mechanism that may be used is up to deployment.
\- Based on the architectural assumptions, a UAV is authorized for
connectivity to USS/UTM over UAV9 based on existing MNO policies, and is
allowed to establish connectivity with an appropriate DNN/APN to exchange
traffic with the USS (for communications not related to sending Remote
Identification message or C2) without explicit USS/UTM authorization for the
establishment of the user place connectivity.
\- In the case of single PDU session/PDN connection for USS and UAV-C
connectivity:
\- The single PDU session in 5GS can be established without performing any
UUAA at PDU session establishment (if UUAA is performed at registration), or
UUAA is performed during PDU session establishment if UUAA is not performed at
registration
\- For the single PDN connection in EPS, UUAA is performed during PDN
connection establishment
\- The authorization for connectivity between UAV and UAV-C may be performed
during PDU session/PDN connection establishment (together with UUAA if UUA is
performed), or after the PDU session/PDN connection is established (the
details are to be defined during normative work, and may rely on PDU
session/PDN connection modification procedures)
\- In the case of separate PDU sessions/PDN connections for USS and UAV-C
connectivity:
\- The PDU session for USS connectivity in 5GS can be established without
performing UUAA at PDU session establishment (if UUAA is performed at
registration), or UUAA is performed during PDU session establishment if UUAA
is not performed at registration
\- For the PDN connection for USS connectivity in EPS, UUAA is performed
during PDN connection establishment
\- The authorization for the PDU session/PDN connection for UAV and UAV-C
connectivity is performed when the PDU session/PDN connection for UAV and
UAV-C connectivity is established.
\- To perform authorization for the PDU session/PDN connection for UAV and
UAV-C connectivity (both in the case of single or separate PDU session/PDU
connection) the UAV provides to the SMF an Aviation Connectivity Payload
containing:
\- the CAA-Level UAV ID;
\- an optional Flight Authorization ID;
NOTE: flight authorization from the UTM/USS, when performed during the user
plane connectivity request, must minimize the amount of information exchanged
between the UAV and the USS in the Aviation Connectivity Payload. Such
information depends on decisions in the aviation community, and details will
be defined during normative phase. Whether this can be achieved by the UAV
operator obtaining offline a Flight Authorization ID from the USS via means
outside the scope of 3GPP, and having the UAV provide the Flight Authorization
ID in the PDU session/PDN connection establishment will be determined during
the normative phase.
\- if the UAV has the information on the networked UAV controller or UAVC that
connects to the UAV via Internet connectivity, the UAV includes also the
information for the authorization of UAV and networked UAV controller pairing
in the Aviation Connectivity Payload.
\- When the UAV requires user plane connectivity for C2 the UAV requests a PDU
session for UAV operations, if none exists, or a PDU session modification
procedure if one exists. The UAV includes in the request the relevant UAV
operations information in a transparent container (e.g. CAA-Level UAV ID). How
the UAV indicates UAV operations connectivity in the PDU session establishment
will be defined during the normative phase. The 3GPP system authorizes the PDU
session connectivity for UAV operations with a UTM/USS based on the CAA-Level
ID.
\- If a dedicated PDU Session or PDN connection for C2 communication with
UAV-C is used (i.e. to implement UAV3), it should be established after the
pairing authorization is successful. If a common PDU session is used for both
communicating with USS /UTM and UAV-C (i.e., to implement both UAV9 and UAV3),
the C2 communication with UAV-C should only be allowed (e.g. with setup of
appropriate packet filters and access control list) after the pairing
authorization is successful.
\- The request for user plane connectivity for C2 shall be initiated by the
UAV towards the USS/UTM via PDU Session establishment in the 3GPP system and
interacting between the 3GPP CN and the USS/UTM through a UAS-NF or using
NEF/SCEF functions.
\- Once the USS/UTM has authenticated the UAV and authorized the request for
user plane connectivity for C2, this authorization is informed back to the
3GPP system via the UAS-NF or NEF/SCEF functions and only then will the 3GPP
system allocate the required resources to the UAV and UAVC. The UTM/USS may
include in the authorization response information Remote Identification &
Tracking Information (RITI) that is transparently provided to the UAV (e.g. a
new CAA-Level UAV ID).
\- After the PDU Session/PDN connection used for C2 communication is
successfully established or modified, the serving 3GPP system should report
the device\'s transport address for C2 communication to the UTM/USS. The
UTM/USS should inform the serving 3GPP system of the peer device\'s transport
address for C2 communication.
\- USS/UTM can provide traffic routing policies for the C2 connectivity which
will be used by the 3GPP NFs for data traffic over the allocated user plane
resources.
**Other Aspects:**
The USS/UTM is not assumed to have knowledge of PDU sessions or PDN
connections: the USS/UTM authorizes connectivity requests sent from the 3GPP
system for a UAV or UAV controller, can revoke such authorization, and can
provide information to control such connectivity (e.g. ACL, QoS information,
etc.).
For geofencing, enable both the \"direct query from USS\" model, the \"direct
USS subscription\" model, and the \"area of interest subscription\" model.
For geo-caging, both the option of the 3GPP system providing the UAV location
to the USS during procedures, and the option where the USS retrieves it on
demand, are supported.
Enable a USS UAV discovery mechanism where the USS/UTM query MNO for UAVs
served by the MNO in a specific location.
Editor\'s note: For NR to be used for UAVs, \"aerial features\" as defined in
TS 36.300 [9] for E-UTRA, must be enabled and RAN work is needed.
###### ### Annex A: UAV Regulations
# A.1 Introduction
The description in this annex is derived from material external to 3GPP, as
indicated in the references.
NOTE: Given that the content of the external references will change over time,
the content of this clause will not be maintained to match the current status
of the references.
# A.2 LAANC
LAANC [4] is the Low Altitude Authorization and Notification Capability, a
collaboration between FAA and Industry. It directly supports UAS integration
into the airspace.
LAANC provides:
\- Drone pilots with access to controlled airspace at or below 400 feet.
\- Awareness of where pilots can and cannot fly.
\- Air Traffic Professionals with visibility into where and when drones are
operating.
Through the UAS Data Exchange, the capability facilitates the sharing of
airspace data between the FAA and companies approved by the FAA to provide
LAANC services. The companies are known as UAS Service Suppliers \- and the
desktop applications and mobile apps to utilize the LAANC capability are
provided by the UAS Service Suppliers (USS).
LAANC automates the application and approval process for airspace
authorizations. Through automated applications developed by an FAA Approved
UAS Service Suppliers (USS) pilots apply for an airspace authorization.
Requests are checked against multiple airspace data sources in the FAA UAS
Data Exchange such as UAS Facility Maps, Special Use Airspace data, Airports
and Airspace Classes, as well as Temporary Flight Restrictions and Notices to
Airmen. If approved, pilots can receive their authorization in near-real time.
Unless specifically requested in an authorization, drone pilots do not need to
notify the tower before they fly.
LAANC provides airspace authorizations only. Pilots must still check Notices
to Airmen, weather conditions, and abide by all airspace restrictions.
# A.3 ARC
The Federal Aviation Administration (FAA or the Agency) chartered the Unmanned
Aircraft Systems (UAS) Identification (ID) and Tracking Aviation Rulemaking
Committee (ARC) (UAS-ID ARC) to provide recommendations to the FAA regarding
technologies available for remote identification and tracking of UAS. This was
used as a basis for the FAA proposed rule on Remote Identification.
ARC [3] report for available technologies for UAS remote ID tracking
identified eight viable technologies for UAS ID tracking: Automatic Dependent
Surveillance Broadcast (ADS-B); Low Power Direct RF; Networked Cellular;
Satellite; SW-based Flight Notification with Telemetry; Unlicensed Integrated
C2; Physical Indicator; and Visual Light Encoding.
The ARC recommendation identified that there are two ways of providing remote
ID and tracking data. The first is by broadcasting locally and the second is
by publishing information to an FAA-approved internet based database.
\- Direct broadcast (locally).
Direct broadcasting means to transmit data in one direction only with no
specific destination or recipient. Data can be received by anyone within
broadcast range. A direct broadcast requires no handshaking and does not
require bi-directional communication capabilities to work. Although range is
limited to the broadcast area, dependability is high as there is no reliance
on infrastructure \"repeaters.\"
Receiving stations can also be tied into a larger network to publish received
data to an FAA-approved internet-based database.
The direct broadcast capability would enable public safety officials equipped
with an appropriate receiver to obtain information transmitted from the
vehicle. Transmission and receipt of required UAS information is not network
dependent for direct broadcast solutions. Since public safety officials may
not be able to equip with receivers for all possible direct broadcast
technologies, the ARC recommends the FAA adopt an industry standard for data
transmission, which may need to be created, to ensure UA equipment and public
safety receivers are interoperable.
\- Network publishing (to an FAA-approved internet-based database).
Publishing means the act of transmitting data to an internet service or
federation of services. Clients, whether ATC or public safety officials, can
access the data to obtain ID and tracking information for UAS for which such
data has been published.
Networked Cellular, Satellite, and SW-based Flight Notification w/ Telemetry
are among methods by which data can be published, as well as broadcast to a
networked ground station.
As interoperability is established at the IP and application level,
technologies do not need to be compatible as long as the transmitter hardware
can pass data to the internet based service(s) and the client can connect to
the internet based service(s).
The FAA should leverage internet-based database infrastructure that exists or
that is already under development and that could integrate with the FAA\'s
future UTM roadmap.
To accomplish this objective, the FAA could provision remote ID and tracking
services using private UAS Service Suppliers (USS) to provide services
specific to UAS operations. Such services would be accomplished through an
exchange of information between the operator, the USS and the FAA, whereby the
USS would be the primary interface to the operator.
The USS would follow business rules provided by the FAA to collect and
transmit to the FAA telemetry information. USS will provide full information
regarding operations as required by the FAA (telemetry information, id, etc.)
to the FAA in a manner similar to how USS will interact with the notice and
authorization APIs. USS could provide remote ID and tracking services on
behalf of the FAA.
USS are expected to be private entities. They provide the primary interface to
the operator initially via system application software that is likely to
include mobile applications and eventually from on board hardware that will
publish to the USS for transmission to the FAA. The USS could manage (if
necessary) communications and messaging with the operator and with the FAA.
The USS could manage and store all the records of telemetry. The USS would
send telemetry data to the FAA for display to ATC or the appropriate parties.
There are privacy considerations that need to be addressed, and the ARC
recommends that information held by USS be governed by restrictive use
conditions imposed on the USS related to the use and dissemination of any data
and information collected.
# A.4 ASTM F38
ASTM International is defining a standard (to be published as F3411) in ASTM
F38 committee aiming to satisfy the growing demand for better identification
and tracking of unmanned aircraft systems in airspace systems worldwide,
called the Remote ID.
The Remote ID standard supports technology that allows the general public and
public safety officials to identify a drone using an assigned ID, while
preserving privacy of the operator\'s personal identifiable information.
Remote ID outlines how drones can transmit the assigned ID, location, speed,
and direction by broadcasting over the air and/or sending over a wireless
internet connection to a UAS service supplier (USS).
# A.5 FAA regulations on Remote Identification
The following is a summary of the Federal Aviation Administration (FAA) and
Department of Transportation (DOT) proposed rule for Remote Identification
(RID) [2] for UAS:
\- No ID registration is necessary for UAV under 0.55lb.
\- Three phases are foreseen:
\- phase 1, the current proposal.
\- phase 2, remote ID collection in real time from in-flight UAS.
\- phase 3, collection of technical requirements in order to build a sound
remote ID ecosystem.
\- Two categories: standard and limited:
\- Standard: ID broadcast and unicast to a USS through an internet connection.
\- Limited: only unicast to USS, no broadcast needed.
\- Proposal implementation timeline: in 3 years of effective of the proposal.
\- FAA prohibits the use of ADS-B out one UAS unless approved otherwise.
However, ADS-B in is not prohibited.
\- USS four primary functions:
\- Share remote id in real-time over internet.
\- ID access Security.
\- Meet contractually-established parameters.
\- Inform UAS status to FAA, such as using one-time session id for
communication with FAA.
\- Main elements included in this proposal:
\- UAS owners.
\- UAS operators.
\- UAS designers/producers.
\- Developers of RID (compliance to FAA, this proposal).
\- Remote ID USS.
\- UTM: unmanned aircraft system traffic management:
\- FAA envision that third-party will supply such services, which does not
exist currently.
\- ICAO does not prescribe any remote ID equipage for UAS, but in developing
material address UTM and UAS operations under IFR.
\- In summary, FAA believes on internet-based solution is appropriate, when
its available, with Cellular or WI-FI. (See FAA\'s option on page 101).
\- Recommended minimum UAS performance requirements:
\- Location, auto USS connection, time mark, self-testing and monitoring,
Tamper resistance, connectivity, error correction, msg transmission, inter-op.
\- LAANC [4] will be main interface for any USS in order to be FAA
conformance.
# A.6 CAAC regulations on Flight Information Reporting
The Civil Aviation Administration of China (CAAC) has published CAAC Data
specifications of unmanned aircraft cloud system [15], which stipulates the
data reporting requirements of UAVs during the flight.
In CAAC UAV cloud system data specification [15] the definition of UOM i.e.
civilian UAS operation management system is introduced, which almost the same
as UTM.
According to the regulations, UAV reports the real-time flight information
(e.g. UAV flight order ID, UAV Manufacture ID, UAS ID, Timestamp, flight time,
coordinate, longitude, latitude, altitude, height, real time speed, flight
path angle, etc. (CAAC Regulations on the Management of Flight Dynamic Data of
Light and Small Civil UAVs [16])) periodically to USS/UTM via mobile network,
and the report frequency is at least once per second in densely populated
areas, and at least once every 30 seconds in non-populated areas.
To support the above requirements, the data link for the flight information
reporting needs to be maintained during the UAV flight.
#