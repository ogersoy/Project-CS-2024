# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
**The aim of this Technical Report is to study and specify potential**
enhancements to the IMS architecture to enable IMS FE to integrate with the
5GC network functions to enable IMS applications to directly leverage the
features and capabilities of 5GC.
The specific capabilities of 5GC included in this study:
\- In regard to 5GC network slicing; what enhancements (if any) are necessary
for IMS to efficiently support devices and networks with multiple slices and
different IMS services per slice?
\- Should (and How does) IMS leverage the 5GC\'s support for localized routing
of traffic and placement of IMS elements? How do such optimizations impact IMS
media bearers, IMS signalling bearers, and IMS functions? How is service
continuity provided in presence of localized routing?
\- Whether and how can IMS applications and network functions utilize the
service based capabilities and service based interfaces of the 5GC (for
interactions between the IMS and the 5GC)? Which 5GC functions should be
interfaced with IMS using service based interfaces?
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[3] 3GPP TS 23.501: \"System Architecture for the 5G System\".
[4] 3GPP TS 23.502: \"Procedures for the 5G System\".
[5] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System;
Stage 2\".
[6] 3GPP TS 23.237: \"IP Multimedia Subsystem (IMS) Service Continuity; Stage
2\".
[7] 3GPP TS 23.203: \"Policy and charging control architecture\".
[8] IETF RFC 6665: \"SIP-Specific Event Notification\".
[9] 3GPP TS 29.329: \"Sh Interface based on Diameter - Protocol details\".
[10] 3GPP TS 29.228: \"IP Multimedia (IM) Subsystem Cx and Dx interfaces;
Signalling flows and message contents\".
[11] 3GPP TS 29.229: \"Cx and Dx interfaces based on the Diameter protocol;
Protocol details\".
[12] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[14] 3GPP TS 29.328: \"IP Multimedia (IM) Subsystem Sh interface; Signalling
flows and message contents\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1], and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], TS 23.228 [2], TS 23.501 [3] and the following apply. An abbreviation
defined in the present document takes precedence over the definition of the
same abbreviation, if any, in TR 21.905 [1].
5GC 5G Core
5GS 5G System
AGW Access Gateway
BP Branching Point
CSRN Circuit Switched Routing Number
FE Functional Entity
GRUU Globally Routable User Agent URI
I-CSCF Interrogating CSCF
IMS AS IMS Application Server IMS FE IMS Functional Entity
IPX IP Exchange
LBO Local Breakout
MMTEL Multi Media Telephony
P-CSCF Proxy CSCF
PSA PDU Session Anchor
SA Session Anchor
S-CSCF Serving CSCF
SCC AS Service Continuity Control Application Server TADS Terminating Access
Domain Selection
UL-CL Uplink Classifier
ULC Uplink Classifier
Editor\'s note: 5G related abbreviations are pending update to TR 21.905 [1]
Editor\'s note: It is FFS which abbreviation for UL-CL/ULC and SA/PSA is
preferred.
# 4 Architecture Assumptions
The following architectural assumptions are applicable for all potential
solutions:
\- IMS architecture defined is TS 23.228 [2] (release 15) is the baseline,
especially with regard to usage of SIP signalling.
\- The IMS Service Based Cx, Dx, Sh are produced logically by the HSS, so the
functional allocation of the IMS service logic to HSS is in line with TS
23.228 [2].
\- All existing IMS architectural models (e.g. TS 23.228 [2], TS 23.237 [6],
etc.) shall be supported
\- SIP signalling is used between UE and IMS Network
# 5 Key Issues
## 5.1 Key Issue 1: Routing of IMS traffic via a localized UPF
The 5GC enables traffic to route via localized UPF close to the edge of the
network (in some cases adjacent to the RAN nodes). Some IMS services may be
able to benefit from the lower latency and/or lower backhaul requirements that
such deployments can enable, however current IMS applications and services are
not able to leverage these capabilities. This key issue investigates the
interactions required to leverage localized routing of IMS media and
signalling traffic, the changes to enable effective control and management of
such routing, and impacts of mobility and roaming.
Example Use Case A:
Routing of IMS traffic (e.g. video) between two (or more) users using an
efficient UP path.
Example Use Case B:
A \"best effort video service\" where the IMS video traffic from UE is
offloaded at a UPF closer to the UE to minimize the backhaul resource usage
based on a decision by the IMS.
The following is a partial list of the issues to be addressed:
\- How can the IMS network influence or control how the 5GC selects the UP
path?
\- Which IMS node interacts with the 5GC (i.e. IMS AS, CSCF, or other IMS
node)?
\- How does an application server request traffic to route using a local UPF?
\- How does IMS request traffic to route using (or prevent routing using) a
local UPF?
\- How is the mobility of the UE considered, and how is service continuity
ensured?
\- If the UE is roaming, how can the localized routing be extended into the
VPLMN (if supported)?
\- What are the impacts on billing and charging?
## 5.2 Key Issue 2: Placement of IMS application server in localized
environments
The 5GC in release 15 defined some functionality to enable \"mobile edge
computing\" (i.e. computing resources located close to the edge of the
network) to enable enhanced services to users. The functionality defined in
release 15 focused on general compute applications, and did not analyse the
special case of IMS applications. This key issue investigates the enhancements
to current capabilities of IMS and 5GC to enable the operation of IMS servers
in the mobile edge space.
Example Use Case A:
For a given venue (e.g. stadium) IMS videos may be stored and retrieved
locally for playback only on UE\'s that are located on a group of small cells
that serve the venue.
Example Use Case B:
Mission critical services that require optimization of signalling traffic as
well as media may require, placement of P-CSCF and AGW (or other IMS FE) close
to AN.
The following is a partial list of the issues to be addressed:
\- How can IMS leverage 5G support for edge computing?
\- What additions to IMS and 5G support for edge computing capabilities are
required?
\- What restrictions are there (if any) on IMS applications in the edge
network?
\- How are the localized IMS applications identified?
\- How are IMS applications outside the local PLMN impacted (e.g. roaming).
\- What impacts does the solution have on mobility?
\- What impacts does the solution have on service, and application continuity?
\- Is there any further impact on routing of IMS media and IMS signalling?
## 5.3 Key Issue 3: Network Slicing and IMS
In release 15, 5GC developed capabilities to divide the network into slices to
better offer services to users and devices - in many cases the details of
network slicing do not impact IMS, however if the IMS domain offers different
services to different 5GC network slices there may be some impacts. This key
issue investigates the impacts to the IMS domain due to 5GC network slicing,
and how a IMS network can ensure a user or device with multiple 5GC network
slices and multiple IMS services from utilizing the appropriate 5GC network
slice for each IMS service and prevent inappropriate services been used from
the incorrect 5GC network slice.
Examples of the use cases that solutions to this key issue will enable
include:
**Use Case A: Different 5GC slices optimized for different IMS services**
In this use case each 5GC slice supports a different IMS service and the 5GC
slice is optimized for the media type associated with the IMS service. It is
possible that either a shared or separate IMS network provides the services
for each slice (scenario 1 or scenario 2 described below).
Figure 5.3.1 shows an example implementation of this use case where 3 5GC
slices are used, one for IMS messaging service, one for IMS voice service, and
one for IMS video call service. The diagram shows the association of the IMS
services to their appropriate slice, the IMS services may be supported by a
shared IMS network (i.e. Scenario 2), in which case the 5GC slices will
connect to through the common IMS network.
Figure 5.3.1: Example use case with different 5GC slices optimized for
different IMS services
**Use Case B: Different 3rd party 5GC slices with support for 3rd party IMS
services**
In this use case separate 5GC slices are operated by different parties (some
separate from the network operator); each 5GC slice is used to support IMS
services according to the 5GC slice operator\'s service needs; these IMS
services may be different or duplicated per slice according to service
requirements. Additionally, some 5GC slices may provide non-IMS services.
While it is feasible that a shared IMS network provides the services for each
slice (as per scenario 1 described below), this is an unlikely implementation
and it is assumed each party has their own IMS network (as per scenario 2
described below).
Figure 5.3.2 shows an example implementation of this use case where 3 5GC
slices are provided, one provided by an automobile manufacturer, one provided
by an automotive entertainment service provider, and one provided by a network
operator. A different mix of IMS and connectivity services are provided by
each 5GC slice. The diagram shows the association of the IMS services to their
appropriate slice, however as each slice is provided by different parties it
is unlikely that the IMS services share an IMS network (i.e. Scenario 2); thus
each 5GC slice would be associated with a different IMS network supporting the
IMS services associated with the 5GC slice.
Figure 5.3.2: Example use case with different 3rd party 5GC slices providing
IMS services
Two scenarios are possible (and may be mixed when more than 2 slices are
considered):
Scenario 1 - Each 5GC network slice is associated with a separate and distinct
IMS network
Figure 5.3-3 UE connects to two IMS networks through two 5GC network slices
Scenario 2 - Each 5GC slice is associated with a common IMS network
Figure 5.3-4: UE connects to common IMS network through two 5GC network slices
Solutions may relate to one, or both, of these scenarios.
The following is a partial list of what aspects the solutions to this key
issue need to address:
> \- How the IMS service ensures a specific 5GC slice is used.
>
> \- What an IMS service does if a required 5GC slice is not available or
> prohibited.
>
> \- When the IMS FEs and UE are in different PLMNs (i.e. roaming), how the
> two networks interact.
>
> \- How IMS FEs identify the currently used 5GC slice for a specific IMS
> service.
>
> \- Whether the IMS applications are aware of the 5GC slice information.
>
> \- What additional information is carried in the IMS signalling between IMS-
> FE\'s and UE
>
> \- Any changes to the P-CSCF discovery procedures due to 5GC slicing.
>
> \- How the UE and network register and authenticate the IMS service in
> specific slice (whether the IMS is shared or separated).
>
> \- For MT services, how does the IMS network determine to deliver the
> service to the appropriate 5GC network slice.
>
> \- Whether there are any impacts to the \'UE\'s IMS identities and what they
> are if any.
>
> \- IMS backward compatibility to Rel-15.
>
> \- Solutions should specify if they are applicable to scenario 1 only,
> scenario 2 only, or both scenarios 1&2\. Solutions that apply to both
> scenarios 1&2 should identify any aspects that apply differently between the
> to two scenarios.
## 5.4 Key Issue 4: Discovery of Network Functions
This key issue explores options for :
\- discovery of network functions exposed to IMS e.g.:
\- discovery of PCF services by P-CSCF,
\- discovery of HSS by IMS network entities (e.g. I-CSCF, S-CSCF, IMS AS) in
deployments using both Diameter and service-based interfaces.
\- as well as discovery of IMS functions e.g. P-CSCF by SMF.
## 5.5 Key Issue 5: Enabling SBA-based Cx
This key issue explores mapping of existing Cx procedures to currently defined
Nudm services and operations and introducing an SBA-based interface to HSS. In
particular, the following aspects, among others, will be studied: -
\- The benefits of introducing SBA to this interface;
\- Adding an SBA-based interface to HSS;
\- How an SBA-based Cx interface for HSS and UDM can inherit from currently
defined Nudm services and operations including:
\- whether an SBA-based Cx interface should be re-used with potential extra
services/operations/parameters.
\- or whether dedicated services should be created for IMS.
The outcome should strive to get same result for SBA-based Cx and SBA-based Sh
interfaces.
## 5.6 Key Issue 6: Enabling SBA-based Sh
This key issue explores mapping of existing Sh procedures to currently defined
Nudm services and operations and introducing an SBA-based interface to HSS. In
particular, the following aspects, among others, will be studied:
\- The benefits of introducing SBA to this interface;
\- Depicting some use cases.
\- Adding an SBA-based interface to HSS
\- How an SBA-based Sh interface for HSS and UDM can inherit from currently
defined Nudm services and operations including:
\- whether an SBA-based Sh interface should be re-used with potential extra
services/operations/parameters.
\- or whether dedicated services should be created for IMS.
The outcome should strive to get same result for SBA-based Sh and SBA-based Cx
interfaces.
NOTE: In existing Sh operations, HSS currently acts as a proxy toward other
Network Functions/network entities, e.g. TADS, NetLoc, CSRN retrieval, etc.
## 5.7 Key Issue 7: How can IMS utilize services provided by Npcf
As specified in TS 23.503 [5], to allow the 5G system to interwork with AFs
supporting existing services, the PCF shall support the corresponding Rx
procedures and requirements as defined in TS 23.203 [7]. This facilitates the
migration from EPC to 5GC without requiring these AFs to upgrade to support
the service based N5 interface. However, with the introduction of service
based interface to PCF, the removal of the Rx point-to-point interface may be
expected to ease testing, reliability, and troubleshooting issues.
This key issue addresses the following aspects:
\- how IMS utilizes services provided by Npcf to support the interaction with
PCF.
\- what information is used by P-CSCF and how P-CSCF derives the information
to determine which PCC interface is used for a specific IMS session
establishment, when P-CSCF supports N5 and Rx simultaneously.
\- what input and output parameters are needed in Npcf service operations to
add support existing IMS procedures over 5GS.
## 5.8 Key Issue #8: How can IMS utilize services provided by 5GC NFs other
than PCF
All of the 5GC control plane NFs are specified as service based and any NF can
be consumer of the services provided by other NFs, if supported by the
procedures.
This key issue addresses the following aspects:
\- How IMS can utilize services provided by 5GC NFs other than PCF.
\- How to determine the UE location in IMS entities with service operations
(e.g. determination of the visited PLMN ID in case of Home-Routed VoLTE
roaming).
## 5.x Key issue #X: \
### 5.x.1 Description
Editor\'s note: This clause provides a short description of the key issue.
### 5.x.2 Requirements
Editor\'s note: This clause provides the requirements the solutions to this
key issue need to address.
# 6 Solutions
## 6.1 Solution 1: Entire IMS in localized network
### 6.1.1 Description
#### 6.1.1.1 General
This is a solution to key issue #2.
In this solution, all functions of the IMS (except HSS) are in a local network
(i.e. a network located physically close to the RAN nodes). The proximity to
and the number of RAN nodes inside the local network will be determined by the
specifics of the implementation and the services used.
#### 6.1.1.2 Architecture
The following diagram shows the configuration of the IMS and 5GC functional
elements, it assumes that IMS Access Gateways are used for media traffic
(however other IMS topologies are possible).
Figure 6.1.1.2: IMS located in local network near RAN nodes
The IMS HSS is located outside the local network (this may be co-located with
the 5GC functions or other core network functions).
NOTE: Some interfaces and functions omitted for clarity.
Editor\'s note: The nature of the P-CSCF to PCF interface is FFS.
The local network is a sub-network of the operator network located physically
close to the access network, typically this is a group of cells (including a
single cell) with common connectivity; this may be the result of deployment
constraints (e.g. fibre cluster), or service need (e.g. stadium, campus).
Depending on IP routing configuration the local network may or may not enable
IP connectivity to/from UE\'s connected to cells outside the local area (hence
this is not the same as LADN).
#### 6.1.1.3 Determination of Localized Routing
When the UE establishes the PDU Session for IMS service, the SMF shall select
the UPF in the local network, the SMF can make this determination based on the
DNN, subscription information (e.g. NSSAI), roaming status, or a combination
of these attributes and from the location information of the access node (TA
or Cell ID). Using static configuration in the SMF (based on the UPF used),
the local P-CSCF is discovered, and from there registration with the local IMS
proceeds according to normal IMS procedures (albeit with the FE\'s in the
local network).
Editor\'s note: Whether (and how) the UE can simultaneously register to a
local IMS, and a centralized IMS is FFS.
Editor\'s note: The selection by the SMF for a localized P-CSCF based on
factors other than the selected UPF is FFS.
#### 6.1.1.4 Mobility Aspects
So long as the UE does not move to a RAN node outside the local network area,
the existing mobility functions of the 5GC are used unchanged.
When the UE moves to a RAN node outside the local network area the UE may lose
IP connectivity to the P-CSCF forcing it to re-register for IMS service in the
new area, this will result in termination (and possible interruption) of
ongoing service sessions, re-authentication, and re-establishment of any
security associations. If the UE maintains IP address preservation without RAT
change after moving outside the local network area, the P-CSCF will trigger
re-registration.
Editor\'s note: How the P-CCSF determines that the UE has moved outside the
local area and subsequent procedures are FFS.
### 6.1.2 Impacts on existing nodes and functions
No new functionality.
If the number of local networks deployed is large the PCF will need to support
many different P-CSCF registrations and interfaces to each P-CSCF than for
similar centralized networks. Similarly, the HSS will need to support many
more interfaces with the S-CSCF and IMS-AS, than typical for a centralized
implementation.
### 6.1.3 Solution Evaluation
Editor\'s note: Evaluation of the solution is FFS.
## 6.2 Solution 2: IMS AS Influences routing of IMS media traffic as a 5G AF
### 6.2.1 Description
#### 6.2.1.1 General
This is a solution to key issue #1
When the IMS AS determines that routing of media traffic via a localized UPF
is necessary, it uses the \"AF influence of traffic routing\" feature of the
5GC, to direct the traffic for a specific media flow to the local UPF. If
local routing is not possible the 5GC routes the media using the centralized
network.
Editor\'s note: Whether and how, the P-CSCF switches the media to use local
routing if it becomes available subsequently to the media establishment is
FFS.
#### 6.2.1.2 Architecture
The following diagram assumes that the IMS AS interacts with the PCF to
influence the routing of traffic, the use of the same capability via the NEF
is also possible (but not shown). It is also assumed that IMS Access Gateways
are used for media traffic (however other IMS topologies are possible).
Figure 6.2.1.2: IMS and 5GC architecture for local UPF routing by IMS AS
NOTE: Some interfaces and functions omitted for clarity.
IMS AS uses Npcf to communicate with PCF to request localized routing be used
for media traffic.
Editor\'s note: The nature of the P-CSCF to PCF interface is FFS.
The local network is a sub-network of the operator network located physically
close to the access network, typically this is a group of cells (including a
single cell) with common connectivity; this may be the result of deployment
constraints (e.g. fibre cluster), or service need (e.g. stadium, campus). The
IP routing configuration of the local network should provide IP connectivity
to/from UE\'s connected to cells outside the local area (hence this is not the
same as LADN).
#### 6.2.1.3 Establishment Procedure
When the UE requests the PDU session for IMS signalling, based on the DNN,
S-NSSAI, subscription information, roaming status, or a combination of these
factors, the SMF will establish the IMS PDU session with a UPF uplink
classifier in the local network, and a UPF session anchor (for IMS signalling)
in the core network.
When IMS later requires a locally routed media bearer, it will use the
procedure described in figure 6.2.1.3 to establish the media bearer (by
modifying the PDU session used for IMS).
The following procedure assumes IMS AS is interacting with PCF (as a 5G AF).
Figure 6.2.1.3 High-level IMS Media Bearer Establishment with local UPF
1: IMS Session Initiation, either:
1a: UE sends a SIP INVITE message to its P-CSCF, or
1b: The P-CSCF receives a SIP INVITE for a MT session towards a UE.
2: IMS Session establishment continues.
3: IMS AS determines that localized routing may be applicable to this session
(depending on the service and use case this may be at different points in the
IMS session establishment).
Editor\'s note: How the IMS AS determines the need for localized routing is
FFS.
4: The IMS AS uses the Npcf_PolicyAuthorization_Create or Modify service
specifying the UE it wishes to influence and the list of DNAI that are
applicable. (the IMS AS continues the IMS Session establishment procedure).
Editor\'s note: How the IMS AS can obtain or determine the DNAI is FFS.
5\. The IMS requests the P-CSCF top create an IMS media bearer for this
session (according to the SDF agreed in the session establishment procedure).
Based on configuration the P-CSCF determines the applicable AGW (and hence
UPF) the media session will utilize.
Editor\'s note: Whether and If steps 4 and 5 can be combined into a single
interaction is FFS.
6\. P-CSCF requests modification of the PDU session to create the requested
media bearer to the selected AGW (indicating SCC mode 2 or SCC mode 3); the
SMF selects the UPF SA and inserts the UPF ULC according to existing
procedures.
7\. Media Bearer established.
Editor\'s note: IMS AS use of the NEF to influence traffic routing is FFS.
#### 6.2.1.3 Mobility Aspects
So long as the UE does not move to a RAN node outside the local network area,
the existing mobility functions of the 5GC are used unchanged.
When the UE moves to a RAN node outside the local network area, the PCF
informs the IMS AS (via the event notify procedure), the IMS AS updates the
DNAI for the localized routing, and triggers the P-CSCF to re-allocate the IMS
AGW; using either SSC mode 2 or 3 (depending on media and service type) the
media is transitioned to the new IMS AGW and service continues.
Editor\'s note: Details of the IMS-AGW re-allocation procedure and how SSC
modes 2 or 3 are used for mobility are FFS.
There is no support for EPC interworking, if the UE moves to a RAN node not
connected to 5GC, the media session is terminated.
### 6.2.2 Impacts on existing nodes and functions
Editor\'s note: Impacts to existing nodes and functions are FFS
### 6.2.3 Solution Evaluation
Since in release 15, AF influence of traffic routing is only defined in the
non-roaming case and LBO roaming case, this solution is only applicable to UEs
located in their HPLMN (or equivalent), as the IMS AS is always located in the
home network.
Editor\'s note: Additional evaluations are FFS
## 6.3 Solution 3: P-CSCF Influences routing of IMS media traffic as a 5G AF
### 6.3.1 Description
#### 6.3.1.1 General
This is a solution to key issue #1
When the IMS AS determines that routing of media traffic via a localized UPF
is necessary, it indicates this in the to the P-CSCF, such that the P-CSCF can
then use the \"AF influence of traffic routing\" feature of the 5GC, to direct
the traffic for a specific media flow to the local UPF. If local routing is
not possible the 5GC routes the media using the centralized network.
Editor\'s note: Whether and how, the P-CSCF switches the media to use local
routing if it becomes available subsequently to the media establishment is
FFS.
#### 6.3.1.2 Architecture
The following diagram assumes that the P-CSCF interacts with the PCF to
influence the routing of traffic, the use of the same capability via the NEF
is also possible (but not shown). It is also assumed that IMS Access Gateways
are used for media traffic (however other IMS topologies are possible).
Figure 6.3.1.2: IMS and 5GC architecture for local UPF routing by P-CSCF
NOTE: Some interfaces and functions omitted for clarity.
P-CSCF uses Npcf to communicate with PCF to request localized routing be used
for media traffic.
Editor\'s Note: Whether (and if) the P-CSCF uses Npcf for other functions is
FFS.
The local network is a sub-network of the operator network located physically
close to the access network, typically this is a group of cells (including a
single cell) with common connectivity; this may be the result of deployment
constraints (e.g. fibre cluster), or service need (e.g. stadium, campus). The
IP routing configuration of the local network should provide IP connectivity
to/from UE\'s connected to cells outside the local area (hence this is not the
same as LADN).
#### 6.3.1.3 Establishment Procedure
When the UE requests the PDU session for IMS signalling, based on the DNN,
S-NSSAI, subscription information, roaming status, or a combination of these
factors, the SMF will establish the IMS PDU session with a UPF uplink
classifier in the local network, and a UPF session anchor (for IMS signalling)
in the core network.
When IMS later requires a locally routed media bearer, it will use the
procedure described in figure 6.3.1.3 to establish the media bearer (by
modifying the PDU session used for IMS)
The following procedure assumes P-CSCF is interacting with PCF (as a 5G AF).
Figure 6.3.1.3: High-level IMS Media Bearer Establishment with local UPF
1: IMS Session Initiation, either:
1a: UE sends a SIP INVITE message to its P-CSCF, or
1b: The P-CSCF receives a SIP INVITE for a MT session towards a UE.
2: IMS Session establishment continues.
3: IMS AS determines that localized routing may be applicable to this session
(depending on the service and use case this may be at different points in the
IMS session establishment).
Editor\'s note: How the IMS AS determines the need for localized routing is
FFS.
4: The IMS requests the P-CSCF to create an IMS media bearer for this session
(according to the SDF agreed in the session establishment procedure) -
included in this message is an indication that localized media bearers are
preferred.
5: The P-CSCF uses the Npcf_PolicyAuthorization_Create or Modify service
specifying the UE\'s routing it wishes to influence and the list of DNAI that
are applicable. (the P-CSCF continues the IMS Session establishment
procedure).
Editor\'s note: How the P-CSCF determines or obtains the DNAI is FFS.
6\. Based on configuration the P-CSCF determines the applicable AGW (and hence
UPF) the media session will utilize and requests modification of the PDU
session to create the requested media bearer to the selected AGW (indicating
SCC mode 2 or SCC mode 3); the SMF selects the UPF SA and inserts the UPF ULC
according to existing procedures.
Editor\'s note: Whether and If steps 5 and 6 can be combined into a single
interaction is FFS.
Editor\'s note: Determination if support for both SSC mode 2 and 3 is FFS.
7\. Media Bearer established.
#### 6.3.1.3 Mobility Aspects
So long as the UE does not move to a RAN node outside the local network area,
the existing mobility functions of the 5GC are used unchanged.
When the UE moves to a RAN node outside the local network area, the PCF
informs the P-CSCF (via the event notify procedure), the P-CSCF then updates
the DNAI for the localized routing, and triggers the re-allocation of the IMS
AGW; using either SSC mode 2 or 3 (depending on media and service type) the
media is transitioned to the new IMS AGW and service continues. The UE retains
the same IP address for the media flow and the IMS AGW provides any required
mapping to/from IP addresses in the local network.
Editor\'s Note: Details of the IMS-AGW re-allocation procedure and how SSC
modes 2 or 3 are used for mobility are FFS.
There is no support for EPC interworking, if the UE moves to a RAN node not
connected to 5GC, the media session is terminated.
### 6.3.2 Impacts on existing nodes and functions
Editor\'s Note: Impacts to existing nodes and functions are FFS
### 6.3.3 Solution Evaluation
Since in release 15, AF influence of traffic routing is only defined in the
non-roaming case and LBO roaming case, this solution is restricted to UEs
located in their HPLMN (or equivalent).
Editor\'s Note: How (and if) the local P-CSCF in LBO roaming case can use this
functionality is FFS.
Editor\'s Note: Additional evaluations are FFS
## 6.4 Solution 4: Multi-homing based PSA addition to the PDU Session for IMS
for localized routing
### 6.4.1 Description
This solution corresponds to the Key Issue#1 \"Routing of IMS traffic via a
localized UPF\".
To enable routing of IMS traffic via a localized UPF, \"Single PDU Session
with multiple PDU Session Anchors (PSA\'s)\" can be used as described in
clause 5.6.4 of TS 23.501 [3]. This localized routing can be achieved by the
procedure defined in clause 4.3.5.4 of TS 23.502 [4]. Uplink Classifier (UL
CL) based PSA addition has no UE impact while multi-homing based PSA addition
has UE impact as described in steps 7 and 8 in Figure 4.3.5.4-1: Addition of
additional PDU Session Anchor and Branching Point or UL CL of TS 23.502 [4].
When the UE acquires the new IP prefix due to multi-homing based PSA addition
to the PDU Session for IMS, how the upper layer of the UE (i.e. IMS layer) can
use the new IPv6 address should be defined. In particular, the UE does not
have to perform IMS registration by using the new IPv6 address which means the
new IPv6 address is used for IMS media routing via a localized UPF and not
used for SIP signalling as illustrated in Figure 6.4.1-1.
Figure 6.4.1-1: Routing of IMS media via a localized UPF with new IP address
Editor\'s note: It is FFS whether an IMS AGW is needed for gating control of
media flows offloaded via PSA-L.
Editor\'s note: It is FFS how the IMS determines whether the remote party is
reachable via the local address.
Editor\'s note: It is FFS how service continuity is ensured when the UE moves
outside of the area served by the local PSA.
NOTE: Which IMS media can be locally routed by using the new IP address is
based on UE policy.
In order to make the IMS layer\'s behaviour clear, it is proposed to get the
NAS layer of the UE provide an indication that the new IPv6 address is only
for IMS media to the IMS layer when the UE has acquired the new IP prefix due
to multi-homing based PSA addition to the PDU Session for IMS.
Figure 6.4.1-2 is same as Figure 4.3.5.4-1: Addition of additional PDU Session
Anchor and Branching Point or UL CL of TS 23.502 [4] and only step 7 has
addition for the proposed solution.
Figure 6.4.1-2: Multi-homing based PSA addition to the PDU Session for IMS for
localized routing
For the proposed solution, step 7 has the following addition:
\- The NAS layer of the UE provides the upper layer (i.e. IMS layer) with an
indication that the new IPv6 address is only for IMS media.
### 6.4.2 Impacts on existing nodes and functions
UE:
\- The NAS layer of the UE provides the upper layer (i.e. IMS layer) with an
indication that the new IPv6 address is only for IMS media when the UE has
acquired the new IP prefix due to multi-homing based PSA addition to the PDU
Session for IMS.
\- When the IMS layer of the UE receives the indication that the new IPv6
address is only for IMS media from the NAS layer, the UE does not perform IMS
registration by using the new IPv6 address.
Core network:
\- No impact.
IMS network:
\- No impact.
### 6.4.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.5 Solution 5: Routing of IMS traffic via a localised UPF with two IP
addresses
### 6.5.1 Description
The solution addresses Key Issues #1.
Depicted in Figure 6.5.1-1 is a simplified architecture for routing of IMS
traffic via localised UPFs (UPF-BP, UPF-SA) and IMS AGW with no more than two
IP addresses. The objective is to offload selected IMS traffic flows as close
to the network edge while enabling service continuity upon UE mobility. The
figure is illustrated with a Multi-homed IPv6 PDU Session, however, the same
can be achieved using multiple PDU Sessions.
Figure 6.5.1-1: Routing of IMS traffic via a localised UPF with two IP
addresses
The salient features of this solution approach are the following:
\- UE uses a common IP address for SIP signalling (Gm) and user plane traffic.
\- Most of the time UE uses only one IP address. The second IP address is used
only to enable SSC mode 3 service continuity. After completion of service
continuity, the old IP address is released.
\- The P-CSCF in this approach can be (but does not have to be) located close
to the network edge. An IMS AGW can be used for control of media flows.
Editor\'s note: It is FFS how P-CSCF discovery works when the additional
prefix is assigned in a Multi-homed IPv6 PDU Session.
Editor\'s note: It is FFS how the localized IMS AGW selection works when the
P-CSCF resides in a central location.
Consider the following scenario:
1\. Initially UE is connected via PSA1. It is registered with the IMS via
P-CSCF1. Both SIP and user plane traffic transit via PSA1. UE\'s IMS sessions
are anchored in a Service Continuity Control Application Server (SCC AS) as
described in TS 23.237 [6].
2\. Due to UE mobility at some point, the network establishes PSA2 and assigns
a second IP address/prefix to the UE as described in TS 23.502 [4] clause
4.3.5.2 (\"Change of SSC mode 3 PDU Session Anchor with multiple PDU
Sessions\") or TS 23.502 [4] clause 4.3.5.3 (\"Change of SSC mode 3 PDU
Session Anchor with IPv6 Multi-homed PDU Session\"). In either case the IMS
client is provided with the information about how long the network is willing
to keep the old PSA (PSA1) via the PDU Session Address Lifetime value provided
in NAS signalling or via the valid lifetime parameter in Router Advertisement
message.
3\. Based on the information about the remaining lifetime of PSA1, the IMS
client in the UE triggers another IMS registration via PSA2 and P-CSCF2.
4\. After the new IMS registration is completed, the SIP client in the UE
performs the PS-PS Access Transfer procedure described in TS 23.237 [6] to
move all traffic flows from PSA1 to PSA2.
5\. After all traffic is consolidated on PSA2, the SIP client releases the old
registration via P-CSCF1 and PSA1 is also released.
### 6.5.2 Impacts on existing nodes and functions
### 6.5.3 Solution Evaluation
## 6.6 Solution 6: Routing of IMS traffic via a localised UPF with three IP
addresses
### 6.6.1 Description
#### 6.6.1.1 General
The solution addresses Key Issues #1.
Depicted in Figure 6.6.1.1-1 is a simplified architecture for routing of IMS
traffic via localised UPFs (UPF-BP, UPF-SA) with no more than three IP
addresses. The objective is to offload selected IMS traffic flows as close to
the network edge while enabling service continuity due to UE mobility. The
figure is illustrated with a Multi-homed IPv6 PDU Session, however, the same
can be achieved using multiple PDU Sessions.
Figure 6.6.1.1-1: Routing of IMS traffic via a localised UPF with three IP
addresses
The salient features of this solution approach are the following:
\- UE uses a distinct IP address for SIP signalling (Gm) which is anchored in
a remote IP anchor (PSA-R).
\- User plane traffic that is offloadable is routed on an IP address/prefix
that is anchored in a local IP anchor (PSA-L). Non-offloadable user plane
traffic is routed via the remote IP anchor (PSA-R).
\- Most of the time UE uses only two IP addresses: one for Gm and the other
one for user plane traffic. The third IP address is used only to enable SSC
mode 3 service continuity. After completion of service continuity, the old IP
address for user plane traffic is released.
\- The P-CSCF in this approach is located in a remote location.
Editor\'s note: It is FFS whether an IMS AGW is needed for gating control of
media flows offloaded via PSA-L1 and PSA-L2. And if so, it is FFS how that IMS
AGW is relocated by the P-CSCF.
Consider the following scenario:
1\. Initially UE is connected via PSA-R for SIP signalling and PSA-L1 for user
plane. Its registration with the IMS is always anchored via the same P-CSCF.
2\. At some point the network establishes PSA-L2 and assigns a third IP
address/prefix to UE as described in TS 23.502 [4] clause 4.3.5.2 (\"Change of
SSC mode 3 PDU Session Anchor with multiple PDU Sessions\") or TS 23.502 [4]
clause 4.3.5.3 (\"Change of SSC mode 3 PDU Session Anchor with IPv6 Multi-
homed PDU Session\"). In either case the IMS client is provided with the
information about how long the network is willing to keep the old local PSA
(PSA-L1) via the PDU Session Address Lifetime value provided in NAS signalling
or via the valid lifetime parameter in Router Advertisement message.
3\. Based on the information about the remaining lifetime PSA1 the IMS client
in the UE uses reINVITE to move all traffic flows from PSA-L1 to PSA-L2.
4\. After all traffic is consolidated on PSA-L2, PSA-L1 is released.
#### 6.6.1.2 Determining traffic offloadability
UE needs to be able to determine whether specific media flow is offloadable or
not. The media flow is considered offloadable if it satisfies the following
two conditions:
1\. The media flow is \"intrinsically offloadable\" i.e. the network considers
that it is acceptable for specific media types (e.g. video) to be routed via
the Internet (instead of being routed via the operator\'s controlled IP
transport network or the IPX).
2\. The remote party is reachable via the local IP address.
Intrinsic offloadability can be determined either by DM configuration or by
using the SIP Specific Event Notification framework as defined in RFC 6665
[8]. In the latter case a new event needs to be defined e.\". \"notification
for intrinsically offloadable services or media ty\"es\".
The remote party reachability can be checked using the SIP OPTIONS capability
exchange as described below. This procedure can be initiated any time during
an established SIP media session (typically when the UE is assigned a local IP
address).
Consider a scenario with two UEs: UE-A and UE-B, where UE-A has a local IP
address (in addition to the IMS IP address that is used for Signalling) that
can be used for traffic offload of \"intrinsically offloadable\" media flows.
In contrast, UE-B has only the IMS IP address.
UE-A knows that it can offload traffic (i.e. it knows that it has
\"intrinsically offloadable\" media flows) and triggers a SIP OPTIONS exchange
with UE-B as follows:
UE-A --> SIP OPTIONS to UE-B
\
**Supported: \ **
**\ **
m1 audio (IMS IP address) [UE-A\'s IP address that is used for Signalling]
m2 video (IMS IP address) [UE-A\'s IP address that is used for Signalling]
m3 video (local IP address) [This is the local IP address of UE-A]
On receiving SIP OPTIONS, UE-B responds with 200 OK as follows:
UE-B -> 200 OK to UE-A
\
**Supported: \ **
**\ **
m1 audio (IMS IP address) [UE-B\'s IP address that is used for Signalling]
m2 video (IMS IP address) [UE-B\'s IP address that is used for Signalling]
m3 video (IMS IP address) [UE-B\'s IP address that is used for Signalling]
Even though UE-B has not indicated a local IP address, UE-A can still try to
use its local IP address to reach UE-B on its IMS IP address.
UE-A first needs to perform a reachability check by sending a Ping message
from its local IP address to UE-B\'s IMS IP address. If UE-B responds to
Use\'-A\'s Ping message, UE-A triggers a SIP reINVITE for \"m3 video\" media
indicating UE-A\'s local IP address. UE-B acknowledges the message indicating
UE-B\'s IMS IP address.
If at some point later UE-B acquires a local IP address, it can trigger the
SIP OPTIONS exchange mechanism and perform the reachability check by sending a
Ping message from its local IP address to UE-A\'s IMS IP address.
### 6.6.2 Impacts on existing nodes and functions
### 6.6.3 Solution Evaluation
## 6.7 Solution 7: IMS traffic local routing by applying AF influence
mechanism
### 6.7.1 Description
This solution applies to Key Issue 1: Routing of IMS traffic via a localized
UPF which will investigate the interactions required to leverage localized
routing of IMS media and signalling traffic, the changes to enable effective
control and management of such routing.
The 5GC enables to route traffic via localized UPF close to the edge of the
network. Some IMS services may benefit from the lower latency and less
backhaul resource usage resulted from such deployments, such as routing of IMS
traffic (e.g. video) between two users using an efficient UP path when two
users are served by one UPF and IMS-AGW and offloading IMS video traffic at a
UPF closer to the UE.
The following figure shows how an efficient user plane path is created for IMS
services.
Figure 6.7.1-1: Procedure for IMS local routing
1\. The UE sends SIP INVITE message with PANI and media feature tag, which
includes ICSI or IARI, to initiate an originating call.
2\. After receiving the SIP INVITE message, the P-CSCF selects an IMS-AGW or
an IMS-AGW list according to UE\'s location information and requested
services.
NOTE 1: The P-CSCF obtains the UE location from the received PANI or the
P-CSCF can obtain the UE location via Rx/N5 interface from PCF using the
existing UE location retrieval or subscription to notification mechanism
during or after IM registration procedure.
NOTE 2: The mapping between the local IMS-AGW or IMS-AGW list corresponding to
the IMS communication service or IMS application, i.e. ICSI or IARI included
in the media feature tag, and the UE location, is configured in the P-CSCF.
OPTION A: If the P-CSCF selects an IMS-AGW, steps 3a-5a are performed.
3a. If the P-CSCF selects an IMS-AGW in step 2, e.g. in case there is only one
IMS-AGW locally deployed, the P-CSCF allocates media termination via H.248
protocol between P-CSCF and IMS-AGW.
4a-5a. The P-CSCF sends AAR to the PCF with the selected DNAI, and/or IP
filter information (e.g. 5 Tuple), and the policies to be applied to the
corresponding PDU Sessions. The policies may influence the SMF to select a UPF
which is closer to the IMS-AGW and the UE.
NOTE 3: This step applies the mechanism \"Processing AF requests to influence
traffic routing\" as specified in TS 23.502 [4] clause 4.3.6.2, including the
mapping of IMS-AGW address and DNAI.
NOTE 4: The 5GC will allocate a UPF according to the UE location and the
selected DNAI.
Editor\'s note: How (from which configured/dynamic information) the P-CSCF
determines the DNAI is FFS.
OPTION B: If the P-CSCF selects an IMS-AGW list, steps 3b-7b will be
performed.
3b-4b. The P-CSCF sends AAR to the PCF with the selected DNAI list, and the
policies to be applied to the corresponding PDU Sessions. The policies may
influence the SMF to select a UPF which is closer to the IMS-AGW and the UE.
NOTE 5: This step applies the mechanism \"Processing AF requests to influence
traffic routing\" as specified in TS  _23.502_  _[4]_ clause _4.3.6.2 \",
including the mapping of IMS-AGW address list and DNAI list_.
NOTE 6: The 5GC will allocate a UPF/DNAI according to the UE location and the
selected DNAI list.
Editor\'s note: How (from which configured/dynamic information) the P-CSCF
determines the list of DNAI is FFS.
5b. When the P-CSCF receives the AAA message, and gets the selected DNAI by
5GC, it allocates media termination with the corresponding IMS-AGW via H.248.
6b-7b. The P-CSCF sends AAR to PCF with IP filter information (e.g. 5 Tuple)
for policy decision.
8\. The P-CSCF forwards the INVITE message to next node.
NOTE 7: The P-CSCF if supported interacts with the PCF by invoking the
services of PCF via N5.
Editor\'s note: The impact on P-CSCF discovery and selection for IMS traffic
local routing is FFS.
Editor\'s note: The procedure in case of UE mobility is to be provided.
Editor\'s note: Whether UP-re-anchoring is required and whether it should be
done before or after IMS-AGW selection for both options is FFS.
### 6.7.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.7.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.8 Solution 8: Application Function influence on network slice selection
### 6.8.1 Description
#### 6.8.1.1 General
Solution is related to Key Issue #3
An Application Function (AF) can provide to the 5G core network information to
assist in determining the 5GC slice required by a specific IMS service. The AF
sends a request to the NEF, providing an IMS service profile, which requests
to associate an IMS service (associated with an identifier e.g. with an App-
id-4) with a certain IMS service profile and with a certain IMS application
provider. This request may also include the external identity of a single UE
(e.g. the MSISDN), or the external identities of multiple UEs. If no UEs are
included, the request could affect all UEs associated (e.g. based on
subscription) with the identified application provider.
The IMS service profile identifies one of the service profiles pre-agreed
between the mobile operator and the IMS operator. How the IMS Service Profile
is constructed is out of scope of 3GPP. An example list of pre-agreed service
profiles is shown below
+-------------------------+---------------------------+ | IMS Service Profile #1 | Service Profile Id = 1010 | | | | | | Service Type = Voice | | | | | | Delay \< 20 msec | +=========================+===========================+ | IMS Service Profile #2 | Service Profile Id = 1012 | | | | | | Service Type = Video | | | | | | Delay \< 10msec | +-------------------------+---------------------------+ | ... | ... | +-------------------------+---------------------------+
The AS maps the IMS service (App-id-4) to one of the pre-agreed service
profiles based on the known characteristics of the IMS service, e.g. based on
the type and/or the traffic requirements of the IMS service and sends the
request to the UDM/UDR via the NEF.
The AS request (that associates an IMS service to an IMS service profile) to
the NEF include:
\- the IMS Service Id.
\- the Service Profile Id.
\- Information on the IMS Application provider.
\- Optionally the affected UE(s) by providing an external identifier (e.g.
MSISDN).
The UDM/UDR uses the IMS service profile id to derive the type of service
required (i.e. Service Type: Voice, Delay Characteristics) and retrieve the
appropriate NSSP policies.
NOTE: It is assumed that the UDR has pre-configured NSSP policies based on the
service profile requested by the AF.
The PCF is notified of new UE Policies and delivers the updated UE Policies
based on the Policy delivery mechanism described in TS 23.502 [4].
The IMS client in the UE checks the updated URSP policies in order to identify
the PDU session to send the IMS traffic of a specific IMS service as
illustrated below:
Figure 6.8.1.1-1: AF influencing URSP rules for network slice selection
Editor\'s note: The solution where the AF provides the IMS Service Profile
directly to the UDM/UDR is FFS.
The procedure that enables this functionality is specified in the next clause.
#### 6.8.1.2 Procedure for AF (IMS AS) to influence network slice selection
Fig. 6.8.1.2-1: Processing AF requests to influence network slice selection
0\. The IMS AS maps an IMS service to one of the service profiles pre-agreed
between the mobile operator and the IMS operator. This mapping can be based
e.g. on the known traffic type and/or traffic requirements of the IMS service.
NOTE 1: The IMS service profiles pre-agreed between the mobile operator and
the IMS operator are outside the scope of 3GPP.
1\. An AF (IMS Application Server) calls the \"Set Profile\" service supported
by NEF, which requests to associate the IMS service (a) with a certain service
profile and (b) with a certain application provider. The IMS service is
identified by an identifier (App-Identifier). The IMS Service Profile is
identified by a Service Profile Id. The request may also include the external
identity of a single UE (e.g. the MSISDN), or the external identities of
multiple UEs. If no UEs are included, the request could affect all UEs
associated (e.g. based on subscription) with the identified application
provider. The IMS service profile is the one determined in the previous step
and identifies one of the service profiles pre-agreed between the mobile
operator and the AF operator.
Editor\'s note: It is FFS if this step requires a new NEF service to be
specified or whether the Nnef_ParameterProvision_UpdateRequest (clause
4.15.6.2 of TS 23.502 [4]), can be re-used.
2\. The NEF calls the \"Nudm_SubscriberDataManagement\" service supported by
UDM, which requests to update the policy data (i.e. NSSP) of a single UE or of
multiple UEs. The UDM maps each of the received external UE identities (e.g.
MSISDNs) to a Subscriber Permanent Identity (SUPI).
Editor\'s note: It is FFS if the \"Nudm_SubscriberDataManagement\" service can
be used to convey Application profile requirements.
3\. Based on the received service profile and application provider, the UDM
determines an S-NSSAI or a prioritized list of S-NSSAIs that should be
associated with the identified application.
4\. The UDM derives an NSSP rule for the identified IMS service using the
S-NSSAI(s) determined in the previous step.
NOTE 2: It is assumed that the UDM/UDR has NSSP rules per IMS Service Profile
type. Based on the IMS service profile requested by the AF the UDM/UDR will
have an associated NSSP rule
5\. The UDM identifies the affected UEs based on the UE identities received in
step 2 and updates the NSSP policy for each one of these UEs. The NSSP policy
for each UE is stored in UDR.
6\. The UDM responds to the service request received in step 2 and, in turn,
the NEF responds to the service request received in step 1.
7\. The PCF(s) serving the affected UEs is notified of updated URSP rule using
the Nudr_PolicyManagement_UpdateNotify service operation as described in
clause 4.16.2.2 of TS 23.502 [4].
8\. A PCF receiving the Notify message from UDM determines that new NSSP
policy is available for the associated UE and sends the updated NSSP policy to
UE via the AMF and the N1 interface. After the UE receives the updated NSSP
policy, the UE shall attempt to send the traffic of the identified application
over a PDU session that matches the S-NSSAI included in the updated NSSP
policy.
NOTE 3: Impacts on IMS signalling are addressed in Solution 11
Editor\'s note:\ \- It is FFS for interoperability across multi-vendors
whether coordination is needed between IMs ASs for IMS Service Profiles and
IMS Service IDs (Application IDs).\ \- Impacts of slicing to IMS charging is
FFS.
### 6.8.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
FFS.
### 6.8.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.9 Solution 9: Enhancements to Npcf services to support IMS functionality
## 6.9.1 Description
This solution addresses the extensions required for Npcf service to support
existing IMS procedures, related to Key Issue #7.
Table 6.9.1-1: Analysis of IMS functionality supported in Npcf service
+----------------+----------------+----------------+----------------+ | IMS | T | Supported by | Enhancements | | functionality | S 23.503 [5] | Npcf | to Npcf | | | Functional | authorization | authorization | | | description | service | service | +================+================+================+================+ | Authorize QoS | QoS control, | Request and | Indication of | | Resources, | Application | revoke | release of QoS | | Resource | Function NF | resource | resources | | Reservation. | functional | reservation, | needs to be | | Enabling of | description. | enabling and | included in | | media flows, | | disabling | the | | Disabling of | | flows is | Npcf_Polic | | media flows, | | supported by | yAuthorization | | Revoke | | Npcf_Polic | Service | | Authorization | | yAuthorization | | | for Access | | Create | | | Network | | /Update/Delete | | | resources, | | Service. | | | Indication | | | | | release of QoS | | | | | resources to | | | | | the P-CSCF in | | | | | TS | | | | | 23.228 [2]. | | | | +----------------+----------------+----------------+----------------+ | Retrieve the | Access Network | | A new EventId | | user location | Info reporting | | needs to be | | and/or UE Time | | | included in | | Zone | | | the | | information | | | Npcf_Polic | | from the | | | yAuthorization | | access network | | | Subscribe/Unsu | | in | | | bscribe/Notify | | TS | | | Service | | 23.228 [2]. | | | includes an | | | | | EventId for | | | | | requesting | | | | | reporting of | | | | | UE location | | | | | and/or UE | | | | | timezone. | +----------------+----------------+----------------+----------------+ | Support for | Support for | | An emergency | | IMS Emergency | IMS Emergency | | indicator | | in | | | needs to be | | TS | | | included in | | 23.167 [12]. | | | Npcf | | | | | _PolicyAuthor | | | | | izationService | | | | | Create | | | | | Request. | | | | | | | | | | The SUPI, GPSI | | | | | and PEI needs | | | | | to be included | | | | | in | | | | | Npcf | | | | | _PolicyAuthor | | | | | izationService | | | | | Create | | | | | Response. | | | | | | | | | | The SUPI, GPSI | | | | | and PEI needs | | | | | to be included | | | | | in | | | | | Npcf | | | | | _PolicyAuthor | | | | | izationService | | | | | Create Request | | | | | include a | | | | | Failure to | | | | | report when a | | | | | non IMS | | | | | session is set | | | | | upon an | | | | | emergency APN. | +----------------+----------------+----------------+----------------+ | Support for | MPS | MPS supported | None. | | Multimedia | | in | | | Priority | | T | | | Service | | S 23.501 [3] | | | including | | in Rel-15. | | | MCPTT | | Npcf services | | | TS | | supports MPS. | | | 23.228 [2]. | | | | +----------------+----------------+----------------+----------------+ | Reporting | Access Type | Npcf service | None, | | change of | with RAT | supports | | | Access Type, | reporting | reporting of | | | together with | | Access Type in | | | the Radio | | TS | | | Access | | 23.502 [4]: | | | Technology to | | | | | the P-CSCF. | | Npcf | | | | | _PolicyAuthor | | | | | izationService | | | | | Subscribe | | | | | includes an | | | | | EventId for | | | | | requesting | | | | | reporting of | | | | | Access Type | | | | | together with | | | | | the Radio | | | | | Access | | | | | technology to | | | | | P-CSCF | | | | | | | | | | Npcf_Poli | | | | | cyAuthorizatio | | | | | nServiceNotify | | | | | includes an | | | | | EventId for | | | | | reporting of | | | | | Access Type | | | | | together with | | | | | the Radio | | | | | Access | | | | | technology to | | | | | P-CSCF | | +----------------+----------------+----------------+----------------+ | Resource | Resource | | An indication | | Sharing for | sharing for | | per media flow | | Network | different AF | | (DL or UL or | | Detected | sessions. | | both) on | | Concurrent | | | whether | | Sessions in | | | resources may | | TS | | | be shared | | 23.228 [2]. | | | needs to be | | | | | included in | | | | | Npcf | | | | | _PolicyAuthor | | | | | izationService | | | | | Create/Update | | | | | Request. | +----------------+----------------+----------------+----------------+
### 6.9.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
Npcf_PolicyAuthorization Service is impacted to support the functionality
listed above in Table 1.
The P-CSCF is impacted to support Npcf_PolicyAuthorization service.
The PCF is impacted to support the extensions to Npcf_PolicyAuthorization
service required for IMS functionality described above.
### 6.9.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.10 Solution 10: Reuse of UDM services and operations for SBA-based Sh
interface
### 6.10.1 Description
This solution addresses Key Issue 6 - explores mapping of existing Sh
procedures to currently defined Nudm services and operations and introducing
an SBA-based interface to HSS.
The Commands over Sh interface can be mapped to services and operations of
UDM/HSS as shown in table 6.10.1-1:
Table 6.10.1-1
NF service Service Operations Example Consumer(s) Mapping to Sh operations
* * *
Subscriber Data Get AS UDR/UDA Management Subscribe AS SNR/SNA (UDM/HSS)
Unsubscribe AS SNR/SNA Notification AS PNR/PNA, PUR/PUA
User-Identity as defined in the TS 29.329 [9] needs to be added as new input
parameters for the above service and operations, and a new subscription data
type for IMS Sh interface needs to be defined as below:
Table 6.10.1-2
Subscription data type Field Description
* * *
IMS Sh data User-Identity See definitions in TS 29.329 [9] Table 6.3.1. MSISDN  
User-Data  
Data-Reference  
Service-Indication  
Subs-Req-Type  
Requested-Domain  
Current-Location  
Identity-Set  
Expiry-Time  
Send-Data-Indication  
Server-Name  
Supported-Features  
Feature-List-ID  
Feature-List  
Supported-Applications  
Public-Identity  
DSAI-Tag  
Wildcarded-Public-Identity  
Wildcarded-IMPU  
Session-Priority  
One-Time-Notification  
Requested-Nodes  
Serving-Node-Indication  
Repository-Data-ID  
Sequence-Number  
Pre-paging-Supported  
Local-Time-Zone-Indication  
UDR-Flags  
Call-Reference-Info  
Call-Reference-Number  
AS-Number  
OC-Supported-Features  
OC-OLR  
DRMP  
Load
### 6.10.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.10.3 Solution Evaluation
See clause 7.2
## 6.11 Solution 11: Procedure for UE to route IMS traffic via multiple 5GC
network slices to the same IMS network
### 6.11.1 Description
#### 6.11.1.1 General
This solution addresses both use cases of Key Issue#3 where the UE either
routes IMS traffic via multiple slices to a single or multiple IMS networks.
The solution describes how the UE uses the URSP rules provided by the network
to route IMS traffic.
It is proposed that all IMS signalling related information is conveyed to the
IMS network via a default 5GC network slice and traffic associated to an IMS
session may be routed via a different 5G network slice based on the
application\'s requirements.
Such approach can be supported by provided to the UE appropriate URSP rules
assisting the UE to determine the 5GC network slice to convey IMS signalling
information and whether traffic associated with an IMS session (i.e. media
information) should be routed via a different 5GC network slice.
When the UE routes IMS traffic via different 5G network slice to the same IMS
network, the UE routes IMS signalling and media to separate PDU sessions
taking into account the URSP rules as shown in the figure below:
Figure 6.11.1.1-1: Routing media of an IMS session to a different 5G network
slice based on URSP rules
The solution requires adding service type information to extend the
application id information in URSP rule. Service type information can be used
to distinguish among IMS signaling and IMS different media services.
Service type information is optional. When service type information of one
application does not exist, it means that IMS signalling and media of the
application go through the same 5GC slice.
Service type information can be used to represent IMS signaling with
\"IMS.signaling\" string, and represent IMS media with \"IMS.media\" string.
The IMS media string define the media type(s) that must be routed over a
different slice (for example, Audio, Video).
The UE requires a URSP rule to determine the PDU session to send IMS
signalling traffic towards the IMS network.
For example, a URSP rule may be provided indicating to the UE that signalling
traffic related to an IMS application must be routed via a PDU session that
points to a default slice towards the IMS DNN:
URSP rule 1:
\- Traffic Descriptor:
\- Application ID.
\- Service Type: IMS.signaling.
\- Route Selection Descriptor:
\- Network Slice Selection: S-NSSAI x.
\- DNN selection: IMS.
If an application requires media of an IMS session to be routed via a
different slice, then the procedure described in clause 6.8.1.2 may be used
where an IMS AS provides assistance information to the network to provide
updated URSP rules to the UE.
For example, a URSP rule may be provided indicating to the UE that audio
traffic related to IMS media must be routed via a PDU session that points to a
different slice and specific DNN as shown below:
URSP rule 1:
\- Traffic Descriptor:
\- Application ID
\- Service Type: IMS.media.Audio.
\- Route Selection Descriptor.
\- Network Slice Selection: S-NSSAI y.
\- DNN selection: DNN x.
When an application requests to establish an IMS session, the UE, before
sending the SIP INVITE request, checks the URSP rules to identify whether the
media of the IMS signalling must be routed over a different slice. The UE can
be configured to check the URSP rules when an IMS session is established based
on:
\- The ICSI/IARI of the service initiated.
\- The type of media requested by the application.
\- The application triggering the IMS session.
If there is a URSP rule that points to a different slice the UE check if there
is an existing PDU session that matches the URSP rule description. Otherwise,
the UE establishes a new PDU session request that satisfies the URSP rule.
The UE then uses the IP address of the second PDU session to construct an SDP
offer that will be included in the SIP INVITE request towards the receiving
entity. The UE sends the SIP INVITE request via the PDU session used for IMS
signalling.
The P-CSCF, when processing the IMS request uses the UE IP address within the
SDP offer as the source IP address of the UE when sending session information
to the PCF either via Rx or N5. If there are multiple PCFs in the PLMN, the
PCF is selected by the Binding Selection Function as described in clause
6.1.1.2 of TS 23.503 [5]. Based on the media resource requested the P-CSCF may
select an AGW (e.g. for media transcoding). The P-CSCF selects the
corresponding AGW for a 5GC network slice based on pre-configuration.
When the PCF receives the request from the P-CSCF the PCF determines the
affected PDU session based on the UE IP address and provides the appropriate
PCC rules to the SMF by invoking the Session Management Policy modification as
described in clause 4.16.5 of TS 23.502 [4].
The SMF then performs an SMF-initiated PDU session modification procedure
providing updated QoS rules for the IMS media traffic.
When the UE routes IMS traffic via different 5G network slice to separate IMS
networks (i.e. the UE has two IMS subscriptions) an additional service type is
required in the URSP rule to allow the UE to associate IMS signalling and/or
session to a specific subscription. An additional field is added on the URSP
\"service type\" to link IMS signalling or traffic associated to an IMS
session to an IMS subscription. It is proposed to use the user\'s IMPI for
this purpose. Based on the user\'s IMPI the UE then uses the route selection
descriptor of the URSP rule to associate the IMS traffic to a PDU session.
NOTE: In case the SIP message only contains the public identify (IMPU) of the
user, the UE can still derive the private identity (IMPI) associated to this
IMPU.
An example of a URSP rule is as follows:
URSP rule x:
\- Traffic Descriptor:
`- Service Type: IMS.media.Audio.
\- Service Type: IMS.subscription.IMPI x.
\- Route Selection Descriptor:
\- Network Slice Selection: S-NSSAI y (dedicated slice for audio media).
\- DNN selection: DNN x.
For this scenario the IMS signalling and media traffic is routed via PDU
sessions towards the different IMS networks as shown below:
Figure 6.11.1.1-2: Routing media of different IMS subscriptions via multiple
5GC network slices based on URSP rules
#### 6.11.1.2 Procedure to route IMS traffic via different 5GC network slice
The following call flow describes the procedure for the case where the UE
routes IMS traffic via different network slices to a single IMS network:
Fig 6.11.1.2-1: Procedure to establish an IMS session where media are routed
over a different 5G network slice
The steps required are as follows:
0\. The UE registers to the IMS network via network slice 1.
1\. The UE establishes a PDU session 1 via network slice 1 where all IMS
signalling is routed.
2\. An application in the UE requests to establish an IMS session.
3\. The UE determines based on the URSP rules that the requested media of the
IMS session must be sent via a different PDU session to 5G network slice 2.
4\. The UE establishes PDU session 2 via network slice 2 based on the rules of
the selected URSP rule.
5\. The UE constructs a SIP INVITE request that is routed via PDU session 1
(to network slice 1).
6\. The UE sets the source address in the SDP offer of the SIP INVITE request
the UE IP address of PDU session 2.
7\. The P-CSCF receives the SIP INVITE requests and uses the source IP address
within the SDP offer as the source UE IP address when sending session
information to the PCF.
8\. After the PCF is selected (e.g. by the BSF), the P-CSCF establishes an
initial session with the PCF (e.g. a Diameter session).
9-12. Steps 9 to 12: The INVITE request with the SDP offer is routed via the
IMS network to the target recipient and the target recipient provides the
response to the SDP offer.
13\. When the P-CSCF receives the response to the INVITE request (e.g. a 183
Session Progress) the P-CSCF provides the session information (included within
the SDP negotiation) to the PCF (of network slice 2).
14\. The PCF decides on PCC rules taking into account the session information
provided by the P-CSCF.
15\. The PCF acknowledge reception of the SDP session information.
16\. The P-CSCF forwards the response to the SIP INVITE to the source UE.
17\. The UE sends a SIP 200 OK message via PDU session 1 (to network slice 1).
18\. The PCF sends the PCC rules to the SMF.
19\. The SMF allocates the required resources based on the PCC rules .
20\. SMF starts a network-initiated PDU session modification request (PDU
session 2) as described in clause 4.3.3.2 of TS 23.502 [4].
21\. The AMF forwards the PDU session medication command message within an N2
request as described in clause 4.3.3.2 of TS 23.502 [4].
22\. The RAN node carries out the appropriate AN procedure to inform the UE of
the PDU session modification.
23\. The sends the media of the IMS session via PDU session 2.
NOTE: The procedure for the case where the UE routes IMS traffic via different
5G network slices to different IMS network is the same.
### 6.11.2 Impacts on existing nodes and functions
The impacts on IMS are as follows:
\- UE
\- UE checks the URSP rules every time an IMS session is established.
\- Alternatively, the UE can be configured for which IMS sessions, e.g. based
on the ICSI/IARI, whether the URSP rules must be checked.
\- P-CSCF
\- P-CSCF is configured to check the source UE IP address within the SDP offer
when providing session information to the PCF.
The impacts on the 5GC are as follows:
\- URSP rules are updated with new traffic descriptor for media and IMS
service identifier.
### 6.11.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.12 Solution 12: New SBA services dedicated for Cx Operations
### 6.12.1 Solution overview
This solution addresses key issue 5 and is based on using new and specific SBA
service operations optimized for Cx interactions with CSCF in IMS.Existing
Release 15 UDM services are not optimized for Cx operations. This leads to the
increased number of transactions that would be required for IMS procedures
using Release 15 UDM services. In addition, the services themselves must be
modified considerably to handle Cx specific operations. Finally, any updates
to UDM services would impact IMS even though they maybe unrelated to IMS.
#### 6.12.1.2 IMS Ncx Services
##### 6.12.1.2.1 Current Cx Services
Table 6.12.1.2.1-1 illustrates existing Cx Diameter operations and their
service grouping according to TS 29.229 [11].
Table 6.12.1.2.1-1
* * *
Command-Name Abbreviation Service Grouping Source Dest. User-Authorization-
Request UAR User Authorization I-CSCF HSS User-Authorization-Answer UAA HSS
I-CSCF Push-Profile-Request PPR User Data Handling HSS S-CSCF Push-Profile-
Answer PPA S-CSCF HSS Server-Assignment-Request SAR
Registration/deregistration, S-CSCF HSS Server-Assignment-Answer SAA HSS
S-CSCF Registration-Termination-Request RTR HSS initiated deregistration HSS
S-CSCF Registration-Termination-Answer RTA S-CSCF HSS Location-Info-Request
LIR Location Management I-CSCF HSS Location-Info-Answer LIA HSS I-CSCF
Multimedia-Auth-Request MAR IMS Authentication S-CSCF HSS Multimedia-Auth-
Answer MAA HSS S-CSCF
* * *
##### 6.12.1.2.2 Dedicated Ncx Services
NOTE: During the normative phase the agreed upon naming conventions shall be
followed.
Table 6.12.1.2.2-1 illustrates the Ncx service operations dedicated to support
Cx existing operations
Table 6.12.1.2.2-1
+----------------+--------------+----------------+----------------+ | Command-Name - | Source-Dest | NF Service | Comment | | Cx | | | | +----------------+--------------+----------------+----------------+ | Serv | S-CSCF - HSS | Nc | Registration, | | er-Assignment- | | x_IMSRegistra | profile | | Request/Answer | | tion_Register | download and | | | | | implicit | | (SAR-SAA) | | | subscription | | | | | to | | | | | notification | | | | | of profile | | | | | updates | +----------------+--------------+----------------+----------------+ | | | Ncx_IMS | SAR in context | | | | Registration_ | of | | | | Deregistration | d | | | | | eregistration. | | | | | | | | | | SAR in context | | | | | of P-CSCF | | | | | restoration. | | | | | | | | | | Implicit | | | | | unsubscribe to | | | | | notification | | | | | of profile | | | | | updates | +----------------+--------------+----------------+----------------+ | Registratio | HSS - S-CSCF | Nc | NW initiated | | n-Termination- | | x_IMSRegistra | d | | Request/Answer | | tion_Deregist | eregistration. | | (RTT/RTA) | | erNotification | | | | | | Implicit | | | | | unsubscribe to | | | | | notification | | | | | of changes to | | | | | subscriber | | | | | profile | +----------------+--------------+----------------+----------------+ | Location-Info- | I-CSCF - HSS | Ncx_IMSReg | Retrieval of | | Request/Answer | | istration_Get | S-CSCF serving | | | | | the User. | | (LIR/LIA) | | | | +----------------+--------------+----------------+----------------+ | Push-Profile- | HSS - S-CSCF | Ncx_IMSRegi | Notification | | Request/Answer | | stration_Upda | of profile | | | | teNotification | updates | | (PPR/PPA) | | | | +----------------+--------------+----------------+----------------+ | User- | I-CSCF - HSS | Ncx_IMSReg | Retrieval of | | Authorization- | | istration_Get | S-CSCF serving | | Request/Answer | | | the User or | | (UAR/UAA) | | | S-CSCF | | | | | capabilities. | +----------------+--------------+----------------+----------------+ | Mu | S-CSCF - HSS | Ncx_IMSAuthe | Retrieval of | | ltimedia-Auth- | | ntication_Get | user\'s | | Request/Answer | | | authentication | | (MAR/MAA) | | Nc | information | | | | x_IMSRegistra | (e.g. AKA AV) | | | | tion_Register | | | | | | Used for | | | | | temporal | | | | | S_CSCF | | | | | registration | +----------------+--------------+----------------+----------------+
Editor\'s note: The handling of S-CSCF Restoration use case is FFS.
#### 6.12.1.3 IMS procedure examples using SBA (Ncx Service Operations)
The following call flows illustrates some examples of IMS procedures based on
the above mapping table.
NOTE: UDM selection is not shown in all call flows.
##### 6.12.1.3.1 IMS Initial Registration
Figure 6.12.1.3.1-1: IMS initial Registration using new Ncx services with CSCF
The following is a brief description of the steps in the call flow:
1\. After the UE has obtained IP connectivity, it can perform IMS
registration. To do so, the UE sends the Register information flow to the
P-CSCF.
2\. The P-CSCF shall send the Register information flow to the Iâ€‘CSCF.
3\. The Iâ€‘CSCF shall fetch the context information for the registering
IMPU/IMPI by sending a Ncx_IMSRegistration_Get Request to the UDM/HSS. UDM/HSS
checks if the IMPU/IMPI pair is registered, and the response is returned in
Ncx_Registration Response. Since no S-CSCF name is returned, the I-CSCF shall
use the returned S-CSCF capability information to select a S-CFCF.
4\. The I-CSCF forwards the Register request to the selected S-CSCF.
5\. The S-CSCF shall temporarily register the IMPI/IMPU context information
(selected S-CSCF) in UDM/HSS, by sending to UDM/HSS the
Ncx_IMSRegistration_Register request.
6\. S-CSCF fetches the authentication information from UDM/HSS by sending to
UDM/HSS Ncx_IMSAuthentication_Get Request and receiving the information in
Ncx_IMSAuthentication_Get response.
7\. The S-CSCF returns a 401 response to the I-CSCF.
8\. I-CSCF forwards the 401 response to P-CSCF.
9\. P-CSCF forwards the 401 response to UE.
10\. The UE includes the required authentication information in a new Register
request to the P-CSCF
11\. P-CSCF forwards the Register request to I-CSCF.
12\. The Iâ€‘CSCF shall fetch the context information for the registering
IMPU/IMPI pair by sending a Ncx_IMSRegistration_Get request to the UDM/HSS.
UDM/HSS checks if the IMPU/IMPI pair is registered, and in this case returns
the allocated S-CSCF name in the Ncx_IMSRegistration_Get Response.
13\. The I-CSCF forwards the Register request to the S-CSCF.
14\. After successful validation of UE authorization related information, the
S-CSCF shall register the IMPI/IMPU context information in UDM/HSS, by sending
to UDM/HSS the Ncx_IMSRegistration_Register request.
15\. The S-CSCF returns a 200 OK to the I-CSCF.
16\. I-CSCF forwards the 200 OK to the P-CSCF.
17\. The P-CSCF forwards the 200 OK to the UE.
##### 6.12.1.3.2 Subsequent IMS Registration
The next call flow illustrates a subsequent registration to refresh the
registration. The call flow is self-explanatory and the steps won\'t be
described further.
Figure 6.12.1.3.2-1: IMS subsequent Registration using new Ncx services with
CSCF
##### 6.12.1.3.3 Network Initiated De-Registration
The next call flow illustrates a network initiated de-registration.
Figure 6.12.1.3.3-1: Network initiated de-registration using Ncx services with
CSCF
The following is a brief description of the steps in the call flow:
1\. Due to administrative action, the UDM/HSS issues to the S-CSCF a
Ncx_IMSDeregistrationNotification.
2\. S-CSCF performs the procedures defined in TS 23.228 [2]. This
automatically unsubscribes the S-CSCF from receiving any notifications to
changes in subscriber profile.
##### 6.12.1.3.4 P-CSCF Restoration (HSS Option)/S-CSCF initiated
Deregistration
The next call flow illustrates P-CSCF restoration based on HSS option.
Figure 6.12.1.3.4-1: P-CSCF Restoration using Ncx services with CSCF
The following is a brief description of the steps in the call flow:
1\. Two cases can trigger this step. In case 1, S-CSCF detects from a
terminating session that P-CSCF is not responding. The S-CSCF sends to UDM/HSS
a Ncx_IMSRegister_Deregister request. In case2, the S-CSCF decides to
deregister a user and informs HSS. In either case, this step automatically
unsubscribes the S-CSCF from receiving any changes to the subscriber profile.
2\. UE may initiate a new Re-registration as per existing procedures.
#### 6.12.1.4 IMS Ncx service Operations dedicated to Cx
Based on the above, the following is a summary of the IMS Ncx service
operations dedicated to Cx current functions.
Table 6.12.1.4-1
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer(s) | | | | Semantics | | +================+================+================+================+ | Ncx_I | Get | Re | S-CSCF, I-CSCF | | MSRegistration | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Register | Re | S-CSCF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Deregister | Re | S-CSCF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Deregistrati | Su | S-CSCF | | | onNotification | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | | Upda | Su | S-CSCF | | | teNotification | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | Ncx_IMS | Get | Re | S-CSCF | | Authentication | | quest/Response | | +----------------+----------------+----------------+----------------+
### 6.12.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.12.3 Solution Evaluation
See clause 7.1.
## 6.13 Solution 13: Reuse services and operations of UDM and NRF for SBA-
based Cx interface
### 6.13.1 Description
This solution addresses Key Issue 5 - explores mapping of existing Cx
procedures to currently defined services and operations of Nudm and Nnrf.
To reuse the currently defined 5GC services for SBA-based Cx, the mapping
between 5GC service operations and Cx commands as defined in the TS 29.228
[10] and TS 29.229 [11] are shown below:
Table 6.13.1-1: NF services provided by UDM
+----------+----------+----------+----------+----------+----------+ | NF | Service | O | Example | Mapping | Comments | | service | Op | peration | Con | of Cx | | | | erations | S | sumer(s) | commands | | | | | emantics | | | | +==========+==========+==========+==========+==========+==========+ | Su | Get | Request/ | AMF, | SAR/SAA, | S | | bscriber | | Response | SMF, | UAR/UAA, | ubscript | | Data | | | SMSF, | LIR/LIA | ion(IRS, | | Ma | | | I-CSCF, | | Alias), | | nagement | | | S-CSCF | | Su | | (SDM) | | | | | bscriber | | | | | | | data, | | | | | | | Location | | | | | | | r | | | | | | | etrieval | +----------+----------+----------+----------+----------+----------+ | | S | Subscrib | AMF, | SAR/SAA | S-CSCF | | | ubscribe | e/Notify | SMF, | | as | | | | | SMSF, | | signment | | | | | S-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | Uns | Subscrib | AMF, | SAR/SAA | S-CSCF | | | ubscribe | e/Notify | SMF, | | as | | | | | SMSF, | | signment | | | | | S-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | Noti | Subscrib | AMF, | RTR/RTA, | Subs | | | fication | e/Notify | SMF, | PPR/PPA | cription | | | | | SMSF, | | modif | | | | | S-CSCF | | ication, | | | | | | | Su | | | | | | | bscriber | | | | | | | data | | | | | | | modi | | | | | | | fication | +----------+----------+----------+----------+----------+----------+ | UE | Regi | Request/ | AMF, | SAR/SAA | UE | | Context | stration | Response | SMF, | | Regi | | | | | SMSF, | | stration | | Ma | | | S-CSCF | | binding | | nagement | | | | | | | (UECM) | | | | | | +----------+----------+----------+----------+----------+----------+ | | De | Subscrib | AMF, | RTR/RTA | Notify | | | registra | e/Notify | S-CSCF | | of | | | tionNoti | | | | Regi | | | fication | | | | stration | | | | | | | state | | | | | | | changing | +----------+----------+----------+----------+----------+----------+ | | Deregi | Request/ | AMF, | SAR/SAA | Regi | | | stration | Response | SMF, | | stration | | | | | SMSF, | | binding | | | | | S-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | Get | Request/ | NEF, | SAR/SAA | P/S | | | | Response | SMSF, | | Rest | | | | | GMLC, | | oration, | | | | | S-CSCF | | Location | | | | | | | inf | | | | | | | ormation | | | | | | | from UDM | +----------+----------+----------+----------+----------+----------+ | | Update | Request/ | AMF, | SAR/SAA | Update | | | | Response | SMF, | | IMS | | | | | S-CSCF | | Rest | | | | | | | oration, | | | | | | | Regi | | | | | | | stration | | | | | | | binding | | | | | | | | | | | | | | Put | | | | | | | data: | | | | | | | P/S-CSCF | | | | | | | Resto | | | | | | | ration,\ | | | | | | | IMS | | | | | | | su | | | | | | | bscriber | | | | | | | regi | | | | | | | stration | | | | | | | state, | | | | | | | IMS UE | | | | | | | ad | | | | | | | dressing | +----------+----------+----------+----------+----------+----------+ | UE | Request | Request/ | AUSF, | MAR/MAA | Authen | | Authen | | Response | S-CSCF | | tication | | tication | | | | | vectors, | | | | | | | IK/CK | | | | | | | for | | | | | | | secure | | | | | | | access | +----------+----------+----------+----------+----------+----------+ | Event | S | Subscrib | NEF | | | | Exposure | ubscribe | e/Notify | | | | +----------+----------+----------+----------+----------+----------+ | | Uns | | NEF | | | | | ubscribe | | | | | +----------+----------+----------+----------+----------+----------+ | | Notify | | NEF | | | +----------+----------+----------+----------+----------+----------+ | P | Update | Request/ | NEF | | | | arameter | | Response | | | | | P | | | | | | | rovision | | | | | | +----------+----------+----------+----------+----------+----------+
Table 6.13.1-2: NF services provided by NRF
+----------+----------+----------+----------+----------+----------+ | Service | Service | O | Example | Mapping | Comments | | Name | Op | peration | Con | of Cx | | | | erations | | sumer(s) | o | | | | | S | | peration | | | | | emantics | | | | +==========+==========+==========+==========+==========+==========+ | Nn | NF | Request/ | AMF, | N/A | S-CSCF | | rf_NFMa | Register | Response | SMF, | | capab | | nagement | | | UDM, | | ilities, | | | | | AUSF, | | NF | | | | | NEF, | | service | | | | | PCF, | | status | | | | | SMSF, | | of | | | | | NSSF, | | S-CSCF | | | | | S-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | NFUpdate | Request/ | AMF, | N/A | S-CSCF | | | | Response | SMF, | | capab | | | | | UDM, | | ilities, | | | | | AUSF, | | NF | | | | | NEF, | | service | | | | | PCF, | | status | | | | | SMSF, | | of | | | | | NSSF, | | S-CSCF | | | | | S-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | NFDe | Request/ | AMF, | N/A | S-CSCF | | | register | Response | SMF, | | capab | | | | | UDM, | | ilities, | | | | | AUSF, | | NF | | | | | NEF, | | service | | | | | PCF, | | status | | | | | SMSF, | | of | | | | | NSSF, | | S-CSCF | | | | | S-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | N | Subscrib | AMF, | UAR/UAA, | S-CSCF | | | FStatusS | e/Notify | SMF, | LIR/LIA | s | | | ubscribe | | PCF, | | election | | | | | NEF, | | | | | | | NSSF, | | | | | | | SMSF, | | | | | | | AUSF, | | | | | | | I-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | NFStat | | AMF, | UAR/UAA, | S-CSCF | | | usNotify | | SMF, | LIR/LIA | s | | | | | PCF, | | election | | | | | NEF, | | | | | | | NSSF, | | | | | | | SMSF, | | | | | | | AUSF, | | | | | | | I-CSCF | | | +----------+----------+----------+----------+----------+----------+ | | NFS | | AMF, | UAR/UAA, | S-CSCF | | | tatusUnS | | SMF, | LIR/LIA | s | | | ubscribe | | PCF, | | election | | | | | NEF, | | | | | | | NSSF, | | | | | | | SMSF, | | | | | | | AUSF, | | | | | | | I-CSCF | | | +----------+----------+----------+----------+----------+----------+ | N | Request | Request/ | AMF, | UAR/UAA | S-CSCF | | nrf_NFD | | Response | SMF, | | s | | iscovery | | | PCF, | | election | | | | | NEF, | | | | | | | NSSF, | | | | | | | SMSF, | | | | | | | AUSF, | | | | | | | I-CSCF | | | +----------+----------+----------+----------+----------+----------+
The current 5GC service operations are extended with extra input and output
parameters to address IMS\'s requirement. Additionally, the service operations
of UDM and NRF need to support Cx messages elements as specified in TS 29.228
[10] and TS 29.229 [11]. As an example, the modification of
Nudm_UECM_registration defined in the TS 23.502 [4] is shown below:
##### _5.2.3.2.1 Nudm_UECM_Registration service operation_
{#nudm_uecm_registration-service-operation .H6}
_Service operation name: Nudm_UECM_Registration_
_Description: Register UE\'s serving NF (if NF Type is AMF, SMSF) or
Session\'s serving NF (if NF Type is SMF) or UE\'s S-CSCF Name (if NF Type is
S-CSCF) on the UDM. This operation implies the following:_
_\- The authorization to provide subscription data for the corresponding NF
consumer and the UE/Session context (identified by input parameters). If this
is successful the consumer is set as a serving NF for the corresponding
UE/Session context._
_\- When the consumer is AMF, it is implicitly subscribed to be notified when
it is deregistered in UDM. This notification is done by means of
Nudm_UECM_DeregistrationNotification operation._
_Inputs, Required for 5GC: NF ID, SUPI, PEI, NF Type, Access Type (if NF Type
is AMF), PDU Session ID (if NF Type is SMF). If NF Type is SMF: DNN or
Indication of Emergency Services._
_Inputs, Required for IMS if NF Type is S-CSCF: Serve-NamePublic-Identity,
Server-Assignment-Type._
_Inputs, Optional for 5GC: None._
_Inputs, Optional for IMS if NF Type is S-CSCF: Wildcarded-Public-Identity,
SCSCF-Restoration-Info, Session-Priority._
_Outputs, Required: Result indication._
_Outputs, Optional: None._
The solution reuses the services and operations of UDM and NRF, with extension
of input/output parameters for SBA-based Cx interface.
Editor\'s note: The impact of using NRF for S-CSCF discovery, on S-CSCF
restoration procedure is FFS.
Editor\'s note: An IMS procedure example needs to be added to show how these
services and operations provided by Nudm and Nnrf can be utilized by the IMS
network, e.g. in the IMS registration procedure.
### 6.13.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.13.3 Solution Evaluation
See clause 7.1.
## 6.14 Solution 14: IMS utilize services provided by Npcf
### 6.14.1 Description
This solution addresses Key Issue 7 - How can IMS utilize services provided by
Npcf.
In IMS network, the P-CSCF needs to be notified of some events related to
access network, e.g. UE location information and other access network related
events. This information will be used in IMS network for billing, LI, service
trigger and so on. In VoLTE network, the P-CSCF subscribes to notification of
these events over Rx interface. Since 5GC supports SBI, this solution proposes
that the IMS utilizes services provided by Npcf to subscribe to notification
of these events.
Figure 6.14.1-1 illustrates how P-CSCF utilizes services provided by Npcf to
subscribe to notification of UE location information.
Figure 6.14.1-1: P-CSCF utilize Services provides by Npcf to subscribe to
notification of e.g. Access Network information, RAN/NAS/non-3GPP Release
cause(s)
1\. The P-CSCF receives the SIP INVITE/re-INVITE/BYE message.
2\. The P-CSCF invokes the corresponding
Npcf_PolicyAuthorization_Create/Update/Delete Request service operations
provided by Npcf to retrieve e.g. the Access Network information, the
RAN/NAS/non-3gpp Release cause, etc. and optionally to subscribe to
notifications on establishment, release of QoS flows and on Access Network
information changes.
3\. The PCF obtains the UE location information from the SMF and the AMF, as
described in the TS 23.502 [4], and sends
Npcf_PolicyAuthorization_Create/Update/Delete Response with the UE location
information.
4\. If not already done in step 2, the P-CSCF subscribes to notifications on
establishment, release of QoS flows and on Access Network Information changes.
5\. P-CSCF is notified of Access Network Information (e.g. user location
and/or user time zone information) at establishment of the QoS Flow. This can
be performed via adding Access Network Information to the
Npcf_PolicyAuthorization_Notify service operation from PCF to P-CSCF.
P-CSCF is notified of RAN/NAS/non-3GPP release cause(s) at the release
initiated by RAN or by CN. This can be performed via adding RAN/NAS/non-3GPP
release cause(s) to the Npcf_PolicyAuthorization_Notify service operation from
PCF to P-CSCF.
### 6.14.2 Impacts on existing nodes and functions
The P-CSCF supports to utilize services provided by Npcf for event
subscription.
### 6.14.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.15 Solution 15: IMS utilize services provided by AMF
### 6.15.1 Description
This solution addresses Key Issue #8 - How can IMS utilize services provided
by 5GC NFs other than PCF.
In IMS network, the P-CSCF needs to be notified of some events related to
access network, e.g. UE location information and other access network related
events. This information will be used in IMS network for billing, LI, service
trigger and so on. In VoLTE network, the P-CSCF subscribes to notification of
these events over Rx interface. Since 5GC supports SBI, IMS network is able to
use the SBI provided by AMF to subscribe to notification of these events.
Figure 6.15.1-1 illustrates how IMS obtains the AMF address serving the UE
during IMS registration procedure.
Figure 6.15.1-1: IMS obtains the AMF address during IMS registration procedure
1-12. Normal IMS registration procedure.
13\. The S-CSCF requests the AMF address in SAR from the HSS/UDM.
14\. The HSS/UDM sends AMF address in the SAA to the S-CSCF.
15\. The S-CSCF sends the AMF address to the P-CSCF in the SIP 200 OK.
16\. The P-CSCF sends SIP 200 OK to the UE as in normal IMS registration
procedure.
17\. The S-CSCF subscribes to notification of AMF change to the HSS/UDM.
18\. When the AMF changes, the HSS/UDM notifies the S-CSCF.
19\. The S-CSCF sends SIP Message with the changed AMF address to the P-CSCF.
Once the IMS (P-CSCF) obtains the AMF address serving the UE, the IMS (P-CSCF)
can subscribe to notification of the events supported by AMF e.g. events
related to UE location information and access network information.
Figure 6.15.1-2 illustrates the P-CSCF utilizes services provides by AMF to
subscribe to notification of the UE location information.
Figure 6.15.1-2: P-CSCF utilizes Services provided by AMF to subscribe to
notification of the UE location information
1\. The P-CSCF receives the SIP INVITE message.
2\. The P-CSCF invokes Namf_EventExposure_Subscribe service operation for
event subscription to UE location changes.
NOTE: The Namf_EventExposure service allows one time reporting, i.e. the
subscription to notification is only for one time reporting.
3\. When the UE location changes, the AMF invokes Namf_EventExposure_Notify to
notify the P-CSCF of the UE location.
When the UE moves from the old AMF to the new AMF, the S-CSCF receives
notification from the UDM/HSS, and the S-CSCF notifies the P-CSCF of the new
AMF address. The P-CSCF invokes Namf_EventExposure_UnSubscribe service
operation on the old AMF to unsubscribe the event notification and invokes
Namf_EventExposure_Subscribe service operation on the new AMF service as
defined in clause 5.2.2 of the TS 23.502 [4].
Editor\'s note: It is FFS how this solution works in the case there are two
AMFs serving a single UE for 3GPP access and non 3GPP access respectively.
### 6.15.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.15.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.16 Solution 16: Enabling SBI-based Sh Using New Service
### 6.16.1 Description
This solution addresses key issue 6.
Data managed through the Sh reference point can be categorized as follows:
\- IMS subscription related data;
\- IMS subscriber context data;
\- IMS operational data;
\- IMS application server repository and vendor specific data.
Current services supported over Sh for the above data can be classified as
follows:
\- Reading of data;
\- Updating of data;
\- Subscription to changes in the data;
\- Notification of changes to the data.
Clearly the above operations are not applicable to all the above data
parameters.
### 6.16.1 Sh Data Parameters
The following IMS information elements in HSS managed through the Sh reference
point within the above categories, as well as the Sh defined procedures
managing them are depicted below:
#### 6.16.1.1 IMS subscription related data
Table 6.16.1.1-1
+-------------------------+---------------+ | XML tag | Operations | +-------------------------+---------------+ | IMSPublicIdentity | Sh-Pull | | | | | | Sh-Subs-Notif | +-------------------------+---------------+ | InitialFilterCriteria | Sh-Pull | | | | | | Sh-Subs-Notif | +-------------------------+---------------+ | Charging information | Sh-Pull | | | | | | Sh-Subs-Notif | +-------------------------+---------------+ | MSISDN +ExtMSISDN | Sh-Pull | +-------------------------+---------------+ | ServiceLevelTraceInfo | Sh-Pull | | | | | | Sh-Subs-Notif | +-------------------------+---------------+ | Service Priority Level | Sh-Pull | | | | | | Sh-Subs-Notif | +-------------------------+---------------+ | ExtendedPriority | Sh-Pull\ | | | Sh-Subs-Notif | +-------------------------+---------------+ | Reference Location Info | Sh-Pull | +-------------------------+---------------+ | IMSI | Sh-Pull | +-------------------------+---------------+ | IMSPrivateUserIdentity | Sh-Pull | | | | | | Sh-Subs-Notif | +-------------------------+---------------+
#### 6.16.1.2 IMS subscriber context data
Table 6.16.1.2-1
+---------------------------------------+---------------+ | XML tag | Operations | +---------------------------------------+---------------+ | IMSUserState | Sh-Pull | | | | | | Sh-Subs-Notif | +---------------------------------------+---------------+ | S-CSCFName | Sh-Pull | | | | | | Sh-Subs-Notif | +---------------------------------------+---------------+ | UserState | Sh-Pull | +---------------------------------------+---------------+ | IP Address Secure Binding Information | Sh-Pull | | | | | | Sh-Subs-Notif | +---------------------------------------+---------------+ | SMSRegistrationInfo | Sh-Pull | | | | | | Sh-Update | +---------------------------------------+---------------+ | STN-SR | Sh-Pull | | | | | | Sh-Update | +---------------------------------------+---------------+ | UE-SRVCC- Capability | Sh-Pull | | | | | | Sh-Subs-Notif | +---------------------------------------+---------------+ | IMEISV | Sh-Pull | +---------------------------------------+---------------+ | LocationInformation | Sh-Pull | +---------------------------------------+---------------+ | UE reachability for IP | Sh-Subs-Notif | +---------------------------------------+---------------+ | T-ADS Information | Sh-Pull | +---------------------------------------+---------------+ | CSRN | Sh-Pull | +---------------------------------------+---------------+
#### 6.16.1.3 IMS operational data
Table 6.16.1.3-1
+---------------+--------------------+ | XML tag | Operations | +---------------+--------------------+ | PSIActivation | Sh-Pull; Sh-Update | | | | | | Sh-Subs-Notif | +---------------+--------------------+ | DSAI | Sh-Pull; Sh-Update | | | | | | Sh-Subs-Notif | +---------------+--------------------+
#### 6.16.1.4 IMS-AS Repository and vendor specific data
Table 6.16.1.4-1
+-----------------+--------------------+ | XML tag | Operations | +-----------------+--------------------+ | Repository Data | Sh-Pull; Sh-Update | | | | | | Sh-Subs-Notif | +-----------------+--------------------+
### 6.16.2 Mapping of Sh Procedure to SBA Services
Given the above categorization of data, the following is proposed:
\- IMS AS to access HSS/UDM for IMS related data. This encompasses IMS
subscription data, IMS subscriber context data, and IMS operational data.
In this solution a new SBA service set, Nudm_Sh, is used to interact with the
IMS AS in the IMS. Nudm_Sh service operations are suited for each type of Sh
Data Parameters.
\- IMS Subscription related data is proposed to be managed using
Nudm_Sh_SubscriptionDataManagement service operations.
\- IMS Subscriber context data is proposed to be managed using
Nudm_Sh_UserContext service operations.
\- IMS Operational data is proposed to be managed using Nudm_Sh_UserContext
service operations.
The functionality for IMS shall continue to be independent even if it is co-
located with UDM/HSS.
IMS AS to access UDR for AS Repository data + any vendor specific data.
This solution proposes to use existing Nudr service operations with UDR for
managing IMS AS Repository data.
Figure 6.16.2-1 depicts the above:
Figure 6.16.2-1
Table 6.16.2-1 illustrates the proposed mapping of current Sh operations to
SBA services.
Table 6.16.2-1
+----------------------+----------------------+----------------------+ | Sh Data Segment | Sh | Nudm_Sh Service | | | Operations/Commands | Operations in IMS AS | | | | context | +======================+======================+======================+ | IMS Subscription | Sh-Pull (UDR/UDA) | Nudm_Sh_SDM_Get | | Data | | | | | Sh-Subs (SNR/SNA) | Nudm | | | | _Sh_SDM_Subscribe | | | Sh-Notif (PNR/PNA) | | | | | Nudm_ | | | | Sh_SDM_Unsubscribe | | | | | | | | Nudm_Sh_SDM_Get | | | | | | | | Nudm_S | | | | h_SDM_Notification | +----------------------+----------------------+----------------------+ | IMS Subscriber | Sh-Pull (UDR/UDA) | Nudm_Sh_UECM_Get | | Context Data | | | | | Sh-Subs (SNR/SNA) | Nudm\ | | | | _Sh_UECM_Subscribe | | | Sh-Notif (PNR/PNA) | | | | | Nudm_S | | | Sh-Update (PUR/PUA) | h_UECM_Unsubscribe | | | | | | | | Nudm_Sh_UECM_Get | | | | | | | | Nudm_Sh | | | | _UECM_Notification | | | | | | | | Nu | | | | dm_Sh_UECM_Update | +----------------------+----------------------+----------------------+ | IMS operational Data | Sh-Pull (UDR/UDA | Nudm_Sh_UECM_Get | | | | | | | Sh-Subs (SNR/SNA) | Nudm\ | | | | _Sh_UECM_Subscribe | | | Sh-Notif (PNR/PNA) | | | | | Nudm_S | | | Sh-Update (PUR/PUA) | h_UECM_Unsubscribe | | | | | | | | Nudm_Sh_UECM_Get | | | | | | | | Nudm_Sh | | | | _UECM_Notification | | | | | | | | Nu | | | | dm_Sh_UECM_Update | +----------------------+----------------------+----------------------+ | IMS-AS Repository | Sh-Pull (UDR/UDA) | Nudr_DR_Query | | Data | | | | | Sh-Subs (SNR/SNA) | Nudr_DR_Subscribe | | | | | | | Sh-Notif (PNR/PNA) | N | | | | udr_DR_UnSubscribe | | | Sh-Update (PUR/PUA) | | | | | Nudr_DR_Notify | | | | | | | | Nudr_DR_Update | +----------------------+----------------------+----------------------+
Editor\'s note: The exact service names is FFS.
Figure 6.16.2-2 shows an example:
{width="6.686805555555556in" height="4.209027777777778in"}
Figure 6.16.2-2
### 6.16.3 Additional Requirements
Based on the above, the following additional high-level requirements can be
identified:
\- A new SBA service set, Nudm_Sh, is proposed to be used to interact with the
IMS AS in the IMS regarding IMS subscription data, IMS subscriber context data
and IMS operation data.
\- UDR Data storage and Nudr service operations must support data segmentation
and their identification, which can be input to services/operations related to
Sh data parameters.
### 6.16.2 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.16.3 Solution Evaluation
See clause 7.2.
## 6.17 Solution 17: Slicing information carried in the IMS registration and
for T-ADS
### 6.17.1 Description
This solution is to resolve the key issue 3: Network slicing and IMS. This
solution cover both multiple IMS core and common IMS core scenario.
The UE uses the URSP to determine the IMS service in the particular slice.
The UE establishes the PDU session for IMS in the particular slicing and makes
the IMS registration.
Editor\'s note: Whether the slicing information is S-NSSAI or something else
is FFS.
When the P-CSCF receives IMS Registration message, it can get Slicing
information from PCC procedure. The P-CSCF checks whether the UE provided
Slicing information is same with network provided Slicing information. If not,
the P-CSCF replace the UE provided slicing information with network provided
Slicing information.
In the 3rd party Registration, the AS gets the UE subscription from HSS/UDM
and slicing information from IMS Registration message. It check whether the
IMS MMTEL service can be provided in this specific 5GC slice according to UE
subscription and/or operator policy.
When the UE has multiple slices simultaneously and establishes the PDU session
for IMS DNN for each slice, the UE makes multiple IMS Registration with IMS
network. Because each PDU session has unique IP address, the IMS network treat
these IMS registration as multiple IMS registration for the same UE.
NOTE: RFC 5626 [92]/5627 [93] has solved multiple registration problem. In the
TS 24.229, clause 4.2 \"If the UE supports GRUU (see table A.4, item A.4/53)
or multiple registrations, then it shall have an Instance ID, in conformance
with the mandatory requirements for Instance IDs specified in RFC 5627 [93]
and RFC 5626 [92]\".
In the 3rd party Registration, the AS gets the UE subscription from HSS/UDM
and slicing information from IMS Registration message. When the MT call arrive
the AS, the AS can choose the slicing (contact address) for MT delivery
according to UE subscription and/or operator policy and IMS service.
### 6.17.2 Registration Procedure
Figure 6.17.2-1: Slicing information carried in the IMS registration
1\. The UE makes Registration in the 5GS as per TS 23.502 [4].
2\. The UE initiates PDU session establishment for IMS DNN in particular slice
as per TS 23.502 [4].
3\. The UE sends IMS Registration message to P-CSCF.
Editor\'s note: Whether the UE sends the information or P-CSCF fetches this
information only is FFS.4. P-CSCF gets the slicing information via PCC
procedure.
5\. The P-CSCF inserts the network provided slice information into
Registration message and forward to IMS core.
6\. The S-CSCF gets the UE subscription from HSS/UDM.
7\. The S-CSCF check whether the register IMS MMTEL service can be provided in
this specific 5GC slice according to UE subscription and operator policy.
Editor\'s note: How the IMS uses the slicing information is FFS.
8\. The S-CSCF perform the IMS 3rd party Registration to AS. The AS store the
slicing information for this IMS Registration.
9\. The IMS registration procedure is completed as per TS 23.228 [2].
Editor\'s note: When the UE receives the rejection for the service it
registers, the UE behaviour regarding URSP is FFS.
### 6.17.3 MT Procedure
Figure 6.17.3-1: IMS MT call procedure
1\. The AS receives the IMS MT call.
2\. The AS select the contact address of UE for particular slicing for the
service deliver according to Service information, slicing information and
operator\'s policy.
3\. The AS sends the SIP INVITE to CSCF.
4\. The CSCF sends the SIP INVITE to UE.
5\. The IMS Call establishment procedure is completed as per TS 23.228 [2].
### 6.17.4 Impacts on existing nodes and functions
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.17.5 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.18 Solution 18: NRF based P-CSCF discovery
### 6.18.1 Description
This solution applies to Key Issue 4: Discovery of Network Functions -
explores options for discovery of network functions exposed to IMS e.g.
discovery of PCF services, as well as discovery of IMS functions e.g. P-CSCF.
Figure 6.18.1-1: Architecture for P-CSCF Discovery
The P-CSCF invokes the NRF services and operations, i.e. NFRegister, NFUpdate,
NFDeregister operations of Nnrf_NFManagement service, as defined in the TS
23.502 [4] clause 5.2.7 to register/update/deregister the P-CSCF address,
location information (e.g. Cell-Id, TA), services and/or slice types supported
by the P-CSCF, e.g. when the P-CSCF profile changes, P-CSCF uses the NFUpdate
operation of Nnrf_NFManagement service to update the profile of P-CSCF stored
in NRF.
The SMF invokes the NRF services and operations, i.e. Nnrf_NFDiscovery service
and NFStatusSubscribe, NFStatusNotify, NFStatusUnSubscribe operations of
Nnrf_NFManagement service to discover and subscribe/unsubscribe and get
updated of the P-CSCF address list from NRF, e.g. discover the P-CSCF address
list during the IMS PDU session establishment procedure.
### 6.18.1A P-CSCF selection
P-CSCF selection functionality is used by the SMF to select the P-CSCF for a
UE.
The SMF can utilize the Network Repository Function to discover the P-CSCF
instance(s) unless P-CSCF information is available by other means, e.g.
locally configured on SMF. The NRF provides the IP address or the FQDN of
P-CSCF instance(s) to the SMF. The P-CSCF selection function in the SMF
selects a P-CSCF instance based on the available P-CSCF instances obtained
from NRF or based on the configured P-CSCF information in the SMF.
The following factors may be considered during the P-CSCF selection:
\- Selected Data Network Name (DNN).
\- Local operator policies.
\- Availability of candidate P-CSCFs.
\- Load balancing across candidate P-CSCFs (e.g. considering weight factors of
candidate P-CSCFs in the P-CSCF Set).
### 6.18.2 Impacts on existing nodes and functions
The SMF needs to utilize NRF for discovery and selection of P-CSCF address(s).
### 6.18.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.19 Solution 19: IMS signalling and media of an application through one
5GC slice
### 6.19.1 Description
This solution addresses network slicing with common IMS network scenario of
Key Issue 3: Network Slicing and IMS Key Issue.
As an example for this scenario, one 5GC slice is used for common voice
communication application and another 5GC slice is used for public safety
communication application.
{width="5.538888888888889in" height="3.009027777777778in"}
Figure 6.19.1-1
IMS signalling and media of an application go through the same 5GC slice, so
each application can map to a single 5GC slice.
In this solution, the UE initiates independent IMS registration through each
5GC slice with the common IMS network.
The procedure is shown in figure 6.19.1-2.
{width="6.678472222222222in" height="5.452083333333333in"}
Figure 6.19.1-2: IMS signalling and media of an application through one 5GC
slice
1\. When the UE registers to 5GC, the UE gets Allowed NSSAI, containing the
S-NSSAIs it can use, and URSP.
2\. According to URSP and IMS application information the UE requests, the UE
establishes the PDU Sessions with each corresponding 5GC Slice for specific
IMS application. The UE uses the IMS application information it requests to
select the corresponding 5GC Slice. The IMS application information may
contain ICSIs or IARIs, as defined in the TS 23.228 [2].
3\. For each PDU session established for IMS, the UE initiates registration
request to IMS network with the corresponding IMS application information
through the corresponding 5GC slice.
Editor\'s note: It is FFS what is the 5G CN entity that communicates with the
IMS network.
4\. After successful IMS registration, the S-CSCF records the binding
relationship between the IMS application information and the UE contact
address.
Editor\'s note: It is FFS what is the UE contact address.
5a. For MO, the UE sends the SIP request with the requested IMS application
information to the IMS network. The Originating S-CSCF routes the SIP request
together with the IMS application information to the IMS network of the called
party, after routing the SIP request to the appropriate application servers
for originating services according to the requested IMS application
information.
5b. For MT, the Terminating S-CSCF routes the SIP request to the appropriate
application servers for terminating services according to the requested IMS
application information.
The Terminating S-CSCF decides the UE contact address registered for the
requested IMS application, then routes the SIP request to the UE with the
matched UE contact address.
When the SIP request does not contain specific IMS application information,
the Terminating S-CSCF selects the appropriate application server based on the
contents of the SIP request (such as SDP media capabilities, Content-Type
header field, media feature tag), and route the SIP request to the UE with the
corresponding UE contact address.
Editor\'s note: In MT calls, it is FFS how a non-supporting terminating S-CSCF
selects the appropriate application server.
Editor\'s note: In MT calls, it is FFS whether the selection of the
application server based on IMS application information and the selection of
the application server based on SDP contents would give same results or not.
### 6.19.2 Impacts on existing nodes and functions
**On the S-CSCF:**
After successful registration, S-CSCF records the binding relationship between
the registered IMS application information and the UE contact address.
The Terminating S-CSCF decides the UE contact address according to the
requested IMS application information, then routes the request to the UE with
the matched UE contact address.
**On the UE:**
According to URSP and IMS application information the UE requests, the UE
establishes the PDU Sessions with each corresponding 5GC Slice for specific
IMS application.
For each PDU session for IMS, the UE initiates registration request to IMS
network with the corresponding IMS application information. The UE uses the
IMS application information it requests to select the corresponding 5GC Slice.
The IMS application information may contain ICSIs or IARIs.
### 6.19.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.20 Solution 20: Selection of Rx or N5 based on P-GW trunk id.
### 6.20.1 Description
This is a solution to part of Key issue #7 - specifically the question of
_what information is used by P-CSCF and how the P-CSCF derives the information
to determine which PCF interface is used for a specific IMS session
establishment, when P-CSCF supports N5 and Rx simultaneously\"?_
When a P-CSCF can support both Rx and N5 interfaces toward the policy
function, it needs to select the appropriate interface/protocol to use.
However, such hybrid P-CSCFs are only deployed during the transition to 5G-RAN
access, and thus the interworking architecture defined in TS 23.501 [3] is
supported, and thus the network will have combined P-GW-C/SMF functionalities.
If the EPC network homogeneously supports the combined P-GW-C/SMF
functionality, then the P-CSCF can always use N5 interface toward the combined
PCF/PCRF function.
If, however, only some nodes support the combined P-GW-C/SMF functions the EPC
will be configured such that any UE indicating support for 5GC will utilize
the combined nodes (in case that the UE moves to an area supporting 5G-RAN),
and only UE\'s not supporting 5GC will utilize the non-combined P-GW or
P-GW-C. Thus, the P-CSCF is able to use the trunk identity (in some
implementations this may be a physical port, VPN, or source MAC address, for
example) corresponding to the access network node to determine the appropriate
protocol/interface to use; If the identity is associated with trunks to a
combined node - use N5; if the identity is associated with a non-combined node
- use Rx.
It is a matter of configuration in the P-CSCF whether to use Rx or N5
interface.
### 6.20.2 Impacts to Existing Nodes and Functions
**P-GW:**
No impact.
**P-GW-C/SMF:**
No impact.
**P-CSCF:**
Select Rx or N5 interface with incoming trunk identifiers.
### 6.20.3 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.21 Solution 21: Selection of Nx or N5 based on UE Contact IP address
### 6.21.1 Description
This is a solution to part of Key issue #7 - specifically the question of
_what information is used by P-CSCF and how the P-CSCF derives the information
to determine which PCF interface is used for a specific IMS session
establishment, when P-CSCF supports N5 and Rx simultaneously\"?_
When a P-CSCF can support both Rx and N5 interfaces toward the policy
function, it needs to select the appropriate interface/protocol to use.
However, such hybrid P-CSCFs are only deployed during the transition to 5G-RAN
access, and thus the interworking architecture defined in TS 23.501 [3] is
supported, and thus the network will have combined P-GW-C/SMF functionalities.
If the EPC network homogeneously supports the combined P-GW-C/SMF
functionality, then the P-CSCF can always use N5 interface toward the combined
PCF/PCRF function.
If, however, only some nodes support the combined P-GW-C/SMF functions the EPC
will be configured such that any UE indicating support for 5GC will utilize
the combined nodes (in case that the UE moves to an area supporting 5G-RAN),
and only UE\'s not supporting 5GC will utilize the non-combined P-GW or
P-GW-C. Since the EPC nodes allocate from different IP address pools, the
contact IP address of the UE can be used to determine the node and hence
whether the node is a combined P-GW-C/SMF, or non-combined P-GW node.
Therefore, the P-CSCF is able to use the UE\'s contact IP address to determine
the appropriate protocol/interface to use; If the IP address is associated
with a combined node - use N5; if the IP address is associated with a non-
combined node - use Rx.
The configuration settings of the SMF/P-GW determine the IP addresses that are
allocated to the UEs, and corresponding configuration in the P-CSCF can
therefore determine whether the Rx or N5 interface is used.
### 6.21.2 Impacts to Existing Nodes and Functions
**P-GW:**
No impact
**P-GW-C/SMF:**
No impact
**P-CSCF:**
Select Rx or N5 interface according to UE contact IP address.
### 6.21.3 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.22 Solution 22: IMS services for SBA-based Cx interface
### 6.22.1 Description
This solution addresses Key Issue 5 - exploring mapping of existing Cx
procedures to currently defined Nudm services and operations and introducing
an SBA-based interface to HSS.
The principle of this solution is to define specific IMS services while
reusing the principles of the UDM services specified in Rel-15 (i.e. SDM,
UECM, UEAuthentication) where service operations are interface agnostic (e.g.
reusable between Sh and Cx) and hence can be used by any IMS NF.
The IMS related service operations are prefixed with \"Nhss_ims_XXX\" (it is
assumed that the IMS data are managed by the HSS part of combo UDM/HSS or by a
standalone HSS).
The currently defined 5GC services for SBA-based Cx defined in the TS 29.228
[10] and TS 29.229 [11] can be replaced by new IMS services as summarized in
the following table and described in detail below.
Table 6.22.1-1: IMS services over Cx
Diameter Command Service Operation(s) Producer Example consumer(s)
* * *
Cx-UAR/UAA Nhss_ims_UECM_Get HSS, combo HSS/UDM I-CSCF Cx-LIR/LIA
Nhss_ims_UECM_Get HSS, combo HSS/UDM I-CSCF Cx-MAR/MAA
Nhss_ims_UEAuthentication_Get + Nhss_ims_UECM_Update HSS, combo HSS/UDM S-CSCF
Cx-SAR/SAA Nhss_ims_UECM_Registration / Nhss_ims_UECM_Deregistration +
Nhss_ims_SDM_Get + Nhss_ims_SDM_Subscribe / Nhss_ims_SDM_Unsubscribe HSS,
combo HSS/UDM S-CSCF Cx-RTR/RTA Nhss_ims_UECM_DeregistrationNotification HSS,
combo HSS/UDM S-CSCF Cx-PPR/PPA Nhss_ims_SDM_Notification HSS, combo HSS/UDM
S-CSCF
**User registration status query (User-Authorization-Request/Answer)**
This procedure is invoked by the I-CSCF during registration procedure to
authorize registration, to provide a first security check (IMPU/IMPI) and to
get the S-CSCF name (if already registered) or the capabilities the S-CSCF has
to support. It is replaced by the following service operation:
Nhss_ims_UECM_Get, used by consumer NFs (NEF) to retrieve registration
information and to perform a first security check (with Service Logic
involvement), with additional parameters:
\- Required inputs: IMPI, IMPU, VPLMNID.
\- Optional inputs: User_Auth_Type, Flags.
\- Optional outputs: S-CSCF name, S-CSCF capabilities.
**User Location Query (Location Information Request/Answer)**
This procedure is used between the I-CSCF and the HSS to obtain the name of
the S-CSCF assigned to a Public Identity, or the name of the AS hosting a PSI
for direct routing. The procedure is invoked by the I-CSCF. It is replaced by
the following service operation:
Nhss_ims_SDM_Get, allowing an NF consumer to get the NF ID or SMS address of
the NF serving the UE (no Service Logic involvement), with additional
parameters:
\- Required inputs: IMPU.
\- Optional inputs: User_Auth_Type, Type of Authorization.
\- Optional outputs: S-CSCF name, S-CSCF capabilities, Flags, Wildcarded-IMPU,
NSN-Cs-Adaptation.
**Authentication (Multimedia-Auth-Request/Answer)**
This procedure is used between S-CSCF and HSS to exchange information to
support the authentication between the end user and its home IMS network.
Invoked by S-CSCF. It is replaced by the following service operation:
Nhss_ims_UEAuthentication_Get, used by the S-CSCF to request the
authentication vectors and to inform the HSS about a successful/unsuccessful
authentication, with following additional parameters:
\- Required inputs: IMPU, Number auth. Items.
\- Optional inputs: IMPI, NSN encr. Key index, SIP authenticate.
\- Optional outputs: IMPU, IMPI, Number auth. Items, Number auth. Items, Auth.
Data, NSN encr. Key index, Proprietary data (Radius related).
**S-CSCF registration/deregistration notification (Server-Assignment-
Request/Answer)**
This procedure is used by the S-CSCF to request the HSS to associate that
S-CSCF to the Public Identity (registration), to download relevant user
information from the HSS, to backup and retrieve S-CSCF Restoration
Information, to provide a P-CSCF Restoration Indication to the HSS
The various use cases (registration, deregistration, user data download) are
described separately. Some use cases require two SBI service operations as
follows:
**Registration:** in this case, SAR/SAA is replaced by the following
exchanges, exactly like it is done for 5GC registration in TS 23.502 [4]
clause 4.2.2.2.2 steps 14a-14c:
i. First, Nhss_ims_UECM_Registration, with following additional parameters:
\- Required inputs: S-CSCF name, Subs Assignt Type, User data already
available.
\- Optional inputs: IMPI, IMPU, Restoration data, Wildcarded IMPU, Served IP,
Flags.
\- Optional outputs: IMPI, Associated registered IMPIs Wildcarded IMPU.
ii. Second, Nhss_ims_SDM_Get, with following additional parameters:
\- Required inputs: IMPU, IMPI.
\- Optional inputs: Wildcarded IMPU.
\- Optional outputs: User data, Charging Info, Loose Route ind., Restoration
data, Wildcarded IMPU, Proprietary data (Radius related).
iii. Third, Nhss_ims_SDM_Subscribe, with following additional parameters:
\- Required inputs: IMPU, IMPI.
\- Optional inputs: none.
**Deregistration:** in this case, SAR/SAA is replaced by the two following
exchanges:
i. First, Nhss_ims_UECM_Deregistration, with following additional parameters:
\- Required inputs: S-CSCF name, Subs Assignt Type.
\- Optional inputs: IMPI, IMPU, Wildcarded IMPU, Served IP, Flags.
ii. Second, Nhss_ims_SDM_Unsubscribe, with following additional parameters:
\- Required inputs: IMPU, IMPI.
\- Optional inputs: none.
**Downloading user data from the HSS:** in this case, SAR/SAA is replaced by:
Nhss_ims_SDM_Get, with following additional parameters:
\- Required inputs: IMPU, IMPI.
\- Optional inputs: Wildcarded IMPU.
\- Optional outputs: User data, Charging Info, Loose Route ind., Restoration
data, Wildcarded IMPU, Proprietary data (Radius related).
**Network initiated de-registration by the HSS, administrative (Registration-
Termination-Request/Answer)**
This procedure is used by the HSS in case of HSS initiated de-registration
where the HSS changes the state of the Public Identities to Not Registered and
send a notification to the S-CSCF indicating the identities that shall be de-
registered. It is replaced by the following service operation:
Nhss_ms_UECM_DeregistrationNotification, with following additional parameters:
\- Required inputs: IMPI, deregistration reason.
\- Optional inputs: IMPU, Associated IMPIs.
\- Optional outputs: Associated IMPIs.
**User Profile download (Push-Profile-Request/Answer)**
This procedure is initiated by the HSS to update at least one of the following
user information in S-CSCF: User profile information, Charging information,
etc. It is replaced by the following service operation:
Nhss_ims_SDM_Notification, used to indicate changes to UE\'s individual
subscription data, with following additional parameters
\- Required inputs: IMPI.
\- Optional inputs: Changed User data, Changed Authentication Data, Changed
Charging Info, Changed Proprietary User Data.
### 6.22.2 Impacts on existing nodes and functions
I-CSCF is impacted as follows:
\- implementation of UECM service Nhss_ims_UECM_Get.
\- implementation of SDM service Nhss_ims_SDM_Get.
S-CSCF is impacted as follows:
\- implementation of Authentication service Nhss_ims_UEAuthentication_Get.
\- implementation of UECM services Nhss_ims_UECM_Registration,
Nhss_ims_UECM_Deregistration, Nhss_ims_UECM_DeregistrationNotification,
Nhss_ims_UECM_Get.
\- implementation of SDM service Nhss_ims_SDM_Get, Nhss_ims_SDM_Subscribe,
Nhss_ims_SDM_Unsubscribe, Nhss_ims_SDM_Notification.
HSS is impacted as follows:
\- implementation of SDM, UECM and Authentication services for IMS.
### 6.22.3 Solution Evaluation
See clause 7.1.
## 6.23 Solution 23: IMS services for SBA-based Sh interface
### 6.23.1 Description
This solution addresses Key Issue 6 - exploring mapping of existing Sh
procedures to currently defined Nudm services and operations and introducing
an SBA-based interface to HSS.
The principle of this solution is to define specific IMS services while
reusing the principles of the UDM services specified in Rel-15 (i.e. SDM,
UECM, UEAuthentication) where service operations are interface agnostic (e.g.
reusable between Sh and Cx) and hence can be used by any IMS NF.
The IMS related service operations are prefixed with \"Nhss_ims_XXX\" (it is
assumed that the IMS data are managed by the HSS part of combo UDM/HSS or by a
standalone HSS).
The currently defined 5GC services for SBA-based Sh defined in TS 29.328 [14]
and TS 29.329 [9] can be replaced by new IMS services as summarized in the
following table and described in detail below.
Table 6.23.1-1: IMS services over Sh
Diameter Command Service Operation(s) Producer Example Consumer(s)
* * *
UDR/UDA Nhss_ims_SDM_Get HSS, combo HSS/UDM AS SNR/SNA (subscription)
Nhss_ims_SDM_Subscribe + Nhss_ims_SDM_Get HSS, combo HSS/UDM AS SNR/SNA
(unsubscription) Nhss_ims_SDM_Unsubscribe HSS, combo HSS/UDM AS PNR/PNA
Nhss_ims_SDM_Notification HSS, combo HSS/UDM AS PUR/PUA Nhss_ims_SDM_Update
HSS, combo HSS/UDM AS
**Data read (Sh-Pull)**
This procedure is mapped to User-Data-Request/Answer in Diameter (according to
clause 6.1.1 of TS 29.328 [14]), is invoked by the AS and is used to read
transparent and/or non-transparent data for a specified user from the HSS. It
is replaced by the following service operations:
Nhss_ims_SDM_Get with following parameters:
\- Required Inputs: User ID, Data reference.
\- Optional Inputs: Wildcarded-PSI, Wildcarded -IMPU, Data ref. related
indicators.
\- Required Outputs: Result code.
\- Optional Outputs: User data, Wildcarded-PSI, Wildcarded -IMPU.
As an alternative, transparent data can be handled by using a Nudr_DR_Query
service operation with extensions required for IMS AS (e.g. MMTel).
**Data Update (Sh-Update)**
This procedure is mapped to Profile-Update-Request/Answer in Diameter (clause
6.1.2 of TS 29.328 [14]), invoked by the AS and it is used to allow the AS to
update the transparent (repository) data stored at the HSS for each IMS Public
User Identity (for Public User Identities matching a Wildcarded Public User
Identity, the transparent data shall be stored per Wildcarded Public User
Identity, and not for each specific Public User Identity matching that
Wildcarded Public User Identity) or Public Service Identity (for Public
Service Identities matching a Wildcarded PSI, the transparent data shall be
stored per Wildcarded PSI, and not for each specific Public Service Identity
matching that Wildcarded PSI).
It is replaced by the following service operation:
Nhss_ims_SDM_Update with following parameters:
\- Inputs Required: NF Type, User ID, Data reference, User data.
\- Inputs Optional: Wildcarded-PSI, Wildcarded -IMPU, IMPI.
\- Outputs Required: Result code.
\- Outputs Optional: Wildcarded-PSI, Wildcarded -IMPU, Repository data, Data
reference.
As an alternative, transparent data can be handled by using a Nudr_DR_Update
service operation with extensions required for IMS AS (e.g. MMTel).
**Subscription to notifications (Sh-Subs-Notif)**
This procedure is mapped to Subscribe-Notifications-Request/Answer in Diameter
(clause 6.1.3 of TS 29.328 [14]), is invoked by the AS and is used to
subscribe to Notifications for when transparent and/or non-transparent data
for a specified IMS Public User Identity or Public Service Identity is updated
by the HSS. It is also optionally used to request the user data from the HSS
in the same Sh diameter operation according to TS 29.328 [14].
For subscribing to notifications, it is replaced by two service operations
(one for subscription, one for fetching subscriber data):
Nhss_ims_SDM_Subscribe with following parameters:
\- Required Inputs: NF Type, User ID, Data reference, Subs. Req. type.
\- Optional Inputs: Expiry time, Wildcarded-PSI, Wildcarded-IMPU, Data ref.
related indicators. IMPI.
\- Required Outputs: Result code.
\- Optional Outputs: User data, Wildcarded-PSI, Wildcarded-IMPU.
Nhss_ims_SDM_Get (if data are requested by AS) with following parameters:
\- Required Inputs: NF Type, User ID, Data reference.
\- Optional Inputs: IMPI.
\- Required Outputs: Result code.
\- Optional Outputs: User data.
As an alternative, transparent data can be handled by using a
Nudr_DR_Subscribe service operation with extensions required for IMS AS (e.g.
MMTel).
For the unsubscribing to notifications, it is replaced by a single service
operation:
Nhss_ims_SDM_Unsubscribe with following parameters:
\- Required Inputs: NF Type, User ID, Data reference, Subs. Req. type.
\- Optional Inputs: Expiry time, Wildcarded-PSI, Wildcarded-IMPU, Data ref.
related indicators. IMPI.
\- Required Outputs: Result code.
\- Optional Outputs: Wildcarded-PSI, Wildcarded-IMPU.
As an alternative, transparent data can be handled by using a
Nudr_DR_Unsubscribe service operation with extensions required for IMS AS
(e.g. MMTel).
**Notifications (Sh-Notif)**
This procedure is mapped to Push-Notification-Request/Answer in Diameter
(clause 6.1.4 of TS 29.328 [14]), invoked by the HSS and is used to inform the
AS of changes in transparent and/or non-transparent data to which the AS has
previously subscribed to receive Notifications for, using Sh-Subs-Notif. It is
replaced by the following service operations:
Nhss_ims_SDM_Notification with following parameters:
\- Required Inputs: User Id, User data.
\- Optional Inputs: Wildcarded-PSI, Wildcarded -IMPU, IMPI.
\- Required Outputs: Result code.
\- Optional Outputs: none.
As an alternative, transparent data can be handled by using a Nudr_DR_Notify
service operation with extensions required for IMS AS (e.g. MMTel).
### 6.23.2 Impacts on existing nodes and functions
AS is impacted as follows:
\- implementation of SDM service operations Nhss_ims_SDM_Get,
Nhss_ims_SDM_Subscribe, Nhss_ims_SDM_Unsubscribe, Nhss_ims_SDM_Notification
and of the new Nhss_ims_SDM_Update.
HSS or combo HSS/UDM is impacted as follows:
\- addition of SDM service operations for IMS.
### 6.23.3 Solution Evaluation
See clause 7.2.
## 6.24 Solution 24: PCF discovery and selection for IMS
### 6.24.1 Description
This solution applies to Key Issue 4: Discovery of Network Functions -
explores options for discovery of network functions exposed to IMS.
IMS Utilizes BSF services and operations for PCF discovery and selection, as
defined in TS 23.501 [3] clause 6.3.7 and TS 23.502 [4] clause 5.2.13.2.4.
### 6.24.2 Impacts on existing nodes and functions
None.
### 6.24.3 Solution Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.25 Solution 25: Selection of Nx or N5 based on two different P-CSCF
FQDN/IP@
### 6.25.1 Description
This is a solution to part of Key issue #7 - specifically the question of what
information is used by P-CSCF and how the P-CSCF derives the information to
determine which PCF interface is used for a specific IMS session
establishment, when P-CSCF supports N5 and Rx simultaneously\".
The solution is as follows.
\- The P-CSCF has two different FQDNs which map to two different IP@, FQDN-1
\~ IP\@1 and FQDN-2 \~ IP\@2.
\- FQDN-1/IP\@1 is used for IMS registrations when UE is anchored on PGW. The
P-CSCF uses Rx to interface with PCRF for this case.
\- FQDN-2/IP\@2 is used for IMS registrations when UE is anchored on SMF+UPF.
The P-CSCF uses N5 with PCF for this case.
The SMF+PGW-C learns if selected PCF for a UE\'s IMS PDU session supports Rx
or N5 interface via the NRF. If the PCF exposes Rx, the SMF+PGW-C acts like a
PGW with regards this solution. Otherwise, the SMF+PGW-C behaves likes a SMF.
When the UE creates PDN connection anchored at the PGW, the FQDN-1/IP\@1 of
the P-CSCF is provided to the UE either as part of attach accept or as part of
DHCP configuration. When the UE creates PDN connection which is anchored at
SMF+UPF, FQDN-2/IP\@2 is provided to the UE.
From TS 24.229, clause 9.2.1, these are the different ways in which UE can
obtain P-CSCF address (and in italics how this solution applies):
The methods for acquiring a P-CSCF address(es) are:
I. Employ Dynamic Host Configuration Protocol for IPv4 RFC 2131 or [
]{.underline} for IPv6 (DHCPv6) RFC 3315. Employ the DHCP options for SIP
servers RFC 3319 or, for IPv6, RFC 3361. Employ the DHCP options for Domain
Name Servers (DNS) RFC 3646.
The UE shall either:
\- in the DHCP query, request a list of SIP server domain names of P-CSCF(s)
and the list of Domain Name Servers (DNS); or
\- request a list of SIP server IP addresses of P-CSCF(s).
_SOLUTION: The DHCP relay (proxy) in the PGW uses a DHCP server to obtain and
provide FQDN-1/IP\@1 (and multiple addresses) and provides this to the UE.
Similarly the DHCP relay (proxy) in the SMF uses a different DHCP server or
different configuration in the DHCP Server, to obtain and provide FQDN21/IP\@2
(and multiple addresses) and provides this to the UE._
_Limitation for this scenario is that when the UE reboots and the type of
anchor for the UE changes (e.g. PGW to SMF) and the lifetime of the FQDN of
PCSCF may still point to the wrong interface (e.g. FQDN-1) of P-CSCF. This
solution would still work if the selection of PGW or SMF+PGW-C by the MME does
not change between UE reboots, e.g. UE\'s subscription or UE network
capability information used for PGW or SMF+PGW-C selection does not change, or
service area of PGW or SMF is PLMN wide._
II. Obtain the P-CSCF address(es) by employing a procedure that the IP-CAN
technology supports. (e.g. GPRS).
_SOLUTION: The PGW is configured to provide IP@/FQDN1 and SMF is configured to
provide IP@/FQDN-2 in PCO._
III. The UE may use pre-configured P-CSCF address(es) (IP address or domain
name). For example:
a. The UE selects a P-CSCF from the list stored in ISIM or IMC;
b. The UE selects a P-CSCF from the list in IMS management object.
NOTE 1: Access-specific annexes provide additional guidance on the method to
be used by the UE to acquire P-CSCF address(es).
_SOLUTION: The solution may not work for this option, but this pre-
configuration of IP@ in UE is not a common deployment option. To make the
solution work for this option, may require the overwriting of the pre-
configuration in the UE with the IP@/FQDN provided in PCO._
When acquiring a P-CSCF address(es), the UE can freely select either method I
or II or III.
NOTE 2: If a P-CSCF address is provisioned or received as a FQDN, procedures
according to RFC 3263 will provide the resolution of the FQDN.
The UE may also request a DNS Server IP address(es) as specified in RFC 3315
and RFC 3646 or RFC 2131.
### 6.25.2 Impacts to Existing Nodes and Functions
**P-GW**
\- Configured to provide FQDN-1/IP\@1 of the P-CSCF at PDN connection setup.
Also if DHCP is being used, the DHCP-proxy at PGW only provides FQDN-1 (and
not FQDN-2) of the P-CSCF.
**SMF+PGW-C**
\- Configured to provide FQDN-2/IP\@2 of the P-CSCF at PDU session setup. Also
if DHCP is being used, the DHCP-proxy at PGW only provides FQDN-2 (and not
FQDN-1) of the P-CSCF.
**P-CSCF**
\- Needs to support two different IP\@s for IMS registration of UEs, one for
UEs whose IMS PDN connections are anchored at PGW and the other for UEs whose
IMS PDU sessions are anchored at the SMF+UPD.
### 6.25.3 Evaluation
This configuration approach works for the case when P-CSCF FQDN/ IP@ is
provided in PCO.
For the approach where PCSCF FQDN/IP@ is provided using DHCP/DNS, the solution
works under the limitation that the type of anchor (PGW or SMF) does not
change between UE reboots.
The solution does not solve the case when PCSCF FQDN/IP@ is pre-configured in
the UE.
This solution is based on configuration only and does not require updates to
specifications.
## 6.26 Solution 26: Use of NRF for User identity to HSS resolution
### 6.26.1 Description
In deployments with both legacy HSS accessible via Diameter and HSS (combined
or not with UDM) upgraded with SBI, the I-CSCF, S-CSCF and IMS AS need to know
the type of interface it shall use to access the HSS: SBI or Diameter.
In existing networks, the I-CSCF (at IMS registration and UE Invite), the
S-CSCF (at IMS registration) and IMS AS determine the HSS to contact by using
either a Subscription Locator Function (SLF) or a Diameter Proxy Agent (DRA)
that proxies the request to the HSS as defined as TS 23.228 [2] clause 5.8.
If SLF is used, a solution would be to configure it for each HSS name with an
indication of SBI support: when an IMS entity (I-CSCF, S-CSCF, AS) queries the
SLF, the SLF would return the HSS name with a the \"SBI support\" indication.
But this solution does not work when a DRA is used because the use of DRA
implies using Diameter.
Another solution would be to use NRF services extended with additional
parameters for IMS as follows:
\- The SBI capable HSS registers to the NRF using the
Nnrf_NFManagement_NFRegister Request message with following additional input
parameters: range of IMPIs, list of IMPUs.
\- The SBI capable IMS entity (e.g. I-CSCF), when it needs to know the HSS
name, sends a Nnrf_NFDiscovery_Request with following additional input
parameters: IMPI (for an IMS registration), IMPU (for an UE Invite).
\- If the IMPI is in the IMPI range or the IMPU is in the list of IMPUs stored
by the SBI capable HSS, the NRF answers with Nnrf_NFDiscovery_Request Response
message containing the HSS name in which the user\'s subscription data can be
found. Otherwise, the Nnrf_NFDiscovery_Request Response message does not
contain any HSS name.
\- If the IMS entity (e.g. I-CSCF) does not contain the HSS name, the IMS
entity shall attempt to discover the HSS by using the SLF or the DRA as if
there were only legacy Diameter-only based HSS.
This solution allows to eliminate the Dx and Dh Diameter interfaces from the
IMS (Dx interface being the standard interface between CSCF and SLF, and Dh
interface being the standard interface between AS and SLF).
NOTE: Scalability issue (due to IMPI/IMPU ranges inputs) needs to be
investigated during normative phase.
### 6.26.2 Extended NRF Service operations
NRF service operations defined in TS 23.502 [4] are extended as follows:
Table 6.26.1-1: NF services provided by the NRF
+-------------+-------------+-------------+-------------+-------------+ | Service | Service | Operation | Example 5GC | Additional | | Name | Operations | | Consumer(s) | IMS | | | | Semantics | | consumers | +=============+=============+=============+=============+=============+ | Nnrf_N | NFRegister | Reque | AMF, SMF, | HSS | | FManagement | | st/Response | UDM, AUSF, | | | | | | NEF, PCF, | | | | | | SMSF, NSSF, | | | | | | UPF, BSF, | | | | | | CHF | | +-------------+-------------+-------------+-------------+-------------+ | | NFUpdate | Reque | AMF, SMF, | HSS | | | | st/Response | UDM, AUSF, | | | | | | NEF, PCF, | | | | | | SMSF, NSSF, | | | | | | UPF, BSF, | | | | | | CHF | | +-------------+-------------+-------------+-------------+-------------+ | | N | Reque | AMF, SMF, | HSS | | | FDeregister | st/Response | UDM, AUSF, | | | | | | NEF, PCF, | | | | | | SMSF, NSSF, | | | | | | UPF, BSF, | | | | | | CHF | | +-------------+-------------+-------------+-------------+-------------+ | | NFStat | Subsc | AMF, SMF, | | | | usSubscribe | ribe/Notify | PCF, NEF, | | | | | | NSSF, SMSF, | | | | | | AUSF, CHF | | +-------------+-------------+-------------+-------------+-------------+ | | NFS | | AMF, SMF, | | | | tatusNotify | | PCF, NEF, | | | | | | NSSF, SMSF, | | | | | | AUSF, CHF | | +-------------+-------------+-------------+-------------+-------------+ | | NFStatus | | AMF, SMF, | | | | UnSubscribe | | PCF, NEF, | | | | | | NSSF, SMSF, | | | | | | AUSF, CHF | | +-------------+-------------+-------------+-------------+-------------+ | Nnrf_ | Request | Reque | AMF, SMF, | I-CSCF, | | NFDiscovery | | st/Response | PCF, NEF, | S-CSCF, AS | | | | | NSSF, SMSF, | | | | | | AUSF, CHF | | +-------------+-------------+-------------+-------------+-------------+ | Nnrf_ | Get | Reque | AMF, SMF, | I-CSCF, | | AccessToken | | st/Response | PCF, NEF, | S-CSCF, AS, | | | | | NSSF, SMSF, | HSS | | | | | AUSF, UDM | | +-------------+-------------+-------------+-------------+-------------+
Nnrf_NFManagement_NFRegister service operation is used by the HSS with
following parameters:
\- Required Inputs: NF Type (HSS).
\- Optional Inputs: IMPI range, list of IMPUs.
\- Required Outputs: Result indication.
\- Optional Outputs: None.
Nnrf_NFManagement_NFUpdate service operation is used by the HSS with following
parameters:
\- Required Inputs: NF Type (HSS).
\- Optional Inputs: Same as Nnrf_NFManagement_NFRegister service operation.
\- Required Outputs: Result indication.
\- Optional Outputs: None.
Nnrf_NFManagement_NFDeregister service operation is used by the HSS with
following parameters:
\- Required Inputs: NF Type (HSS), NF Instance ID, Reason indication.
\- Optional Inputs: None.
\- Required Outputs: Result indication.
\- Optional Outputs: None.
Nnrf_NFDiscovery_Request service operation is used by I-CSCF, S-CSCF, AS with
following parameters:
\- Required Inputs: NF Type.
\- Optional Inputs: IMPI (for an IMS Register if NF Type = I-CSCF), IMPU (for
an UE Invite if NF Type = I-CSCF or if NF Type is S-CSCF or AS).
\- Required Outputs: HSS Name.
\- Optional Outputs: None.
### 6.26.3 Call flows (based on call flows of TS 23.228 [2] clause 5.8)
#### 6.26.3.1 User identity to HSS resolution on IMS Register
Figure 6.26.3.1-1: HSS resolution on register (1st case)
1\. Same as TS 23.228 [2] figure 5.20 step 1.
2\. The Iâ€‘CSCF sends a Nnrf_NFDiscovery_Request message to the NRF and
includes as parameter the user identity which is stated in the REGISTER
request.
3\. Same as TS 23.228 [2] figure 5.20 step 3.
4\. The NRF answers with a Nnrf_NFDiscovery_Request message containing the HSS
name in which the user\'s subscription data can be found.
5\. The Iâ€‘CSCF can proceed by querying the appropriate HSS via service-based
interface.
Figure 6.26.3.1-2: HSS resolution on register (2nd case)
1\. Same as TS 23.228 [2] figure 5.20a step 1.
2\. The Sâ€‘CSCF sends a Nnrf_NFDiscovery_Request message to the NRF and
includes as parameter the user identity which is stated in the REGISTER
request.
3\. Same as TS 23.228 [2] figure 5.20a step 3.
4\. The NRF answers with a Nnrf_NFDiscovery_Request message containing the HSS
name in which the user\'s subscription data can be found.
#### 6.26.3.2 User identity to HSS resolution on UE Invite
Figure 6.26.3.2-1: HSS resolution on UE invite
1\. Same as TS 23.228 [2] figure 5.21 step 1.
2\. Same as TS 23.228 [2] figure 5.21 step 2 except that the Iâ€‘CSCF sends a
Nnrf_NFDiscovery_Request message to the NRF and includes as parameter the user
identity which is stated in the INVITE request.
3\. Same as TS 23.228 [2] figure 5.21 step 3.
4\. The NRF answers with a Nnrf_NFDiscovery_Request Response message
containing the HSS name in which the user\'s subscription data can be found.
#### 6.26.3.3 User identity to HSS resolution on AS access
Figure 6.26.3.3-1: HSS resolution on AS access
1\. An AS sends a Nnrf_NFDiscovery_Request message to the NRF and includes as
a parameter the Public User Identity.
2\. Same as TS 23.228 [2] figure 5.21a step 2.
3\. The NRF answers with a Nnrf_NFDiscovery_Request Response message
containing the HSS name in which the user\'s subscription data can be found.
4\. The AS sends the appropriate Nhss service-based message towards the
correct HSS.
# 7 Overall Evaluation
## 7.1 Evaluation of solutions addressing key issue #5
**Solution 12:**
This solution has the merit to separate IMS services from non-IMS services.
Indeed, IMS service logic and repository may exist even without any mobile
core as it is independent from the type of access (4G, 5G, non-3GPP Core) and
eIMS5G study does not include the move of service logic from HSS.
Solution #12 states that the reuse of UDM services is not optimized: \"the
lack of optimization relates to the increased number of transactions that
would be required for IMS procedures using Rel-15 UDM services\". Hence, the
proposed services are designed to work solely over Cx interface (they are
denoted \"Ncx\"). This approach is point-to-point based. This is not in line
with service-based architecture, which is designed to provide services for
multiple NFs (UDM services are already used by multiple services such as AMF,
SMF, SMSF, GMLC, NEF).
Moreover, the higher number of transactions is inherent to service-based
architecture and is not an argument in favour of a point-to-point solution. A
very good example is the 5GC Registration specified in TS 23.502 [4] clause
4.2.2.2.2 steps 14a to 14c, in which AMF uses three UDM procedures:
\- the new AMF registers with the UDM using Nudm_UECM_Registration.
\- then the AMF retrieves the Access and Mobility Subscription data, SMF
Selection Subscription data and UE context in SMF data using Nudm_SDM_Get.
\- then the AMF subscribes to be notified using Nudm_SDM_Subscribe when the
data requested is modified.
**Solution 13:**
The reuse of UDM services as proposed in solution 13 looks natural when both
non-IMS and IMS data are handled by the UDM. However, as stated above, it is
needed to separate services for IMS from services for non-IMS. It is also
noted that an IMS profile is independent from the type of access (4G, 5G,
non-3GPP).
Furthermore, it is proposed in solution #13 to map RTR/RTA (registration
termination) to Subscriber Data Management services. However, in network
initiated de-registration by the HSS (RTR/RTA), the HSS changes the state of
the Public Identities to Not Registered and sends a notification to the S-CSCF
indicating the identities that shall be de-registered. It involves the Service
Logic and the Nudm_UECM_Get procedure should be used instead.
Similarly, it is also proposed to map UAR/UAA to Subscriber Data Management
services. From TS 29.228, it is stated that User Registration Status Query
procedure (UAR/UAA) is invoked by the I-CSCF during registration procedure to
authorize registration, to provide a first security check (IMPU/IMPI) and to
get the S-CSCF name (if already registered) or the capabilities the S-CSCF has
to support. It involves the Service Logic and the Nudm_UECM_Get procedure
should be used instead.
Moreover, the mapping between SAR/SAA and Cx operations is not detailed
enough. Indeed, in table 6.13.1-1, does not show which UDM services are used
for a particular use case (registration, deregistration, user data download).
For example, it does not explain that SAR/SAA for registration is replaced by
the three service operations Nudm_UECM_Registration, Nudm_SDM_Get and
Nudm_SDM_Subscribe exactly like it is specified for 5GC Registration specified
in TS 23.502 [4] clause 4.2.2.2.2 steps 14a to 14c.
Solution #13 does not either show which parameters are added to the UDM
services.
**Solution 22:**
In that solution, it is proposed to define IMS specific service operations,
based on both solution 13 (based on UDM services principles: SDM, UECM,
UEAuthentication) and solution 12 (separating IMS services from non-IMS
services), where service operations can be used by any NF i.e. interface
agnostic (reused between Sh and Cx) hence satisfying service-based approach.
It also corrects the mapping with regards to SDM vs UECM.
## 7.2 Evaluation of solutions addressing key issue #6
In this TR, there are three solutions addressing Key Issue 6 (Enabling SBA-
based Sh). The evaluation of these solutions is studied below.
\- Solution 10: Reuse of UDM services and operations for SBA-based Sh
interface.
\- Solution 16: Enabling SBI-based Sh Using New Service.
\- Solution X: IMS services for SBA-based Sh interface.
**Solution 16:**
This solution has the merit to separate IMS services from non-IMS services.
Indeed, IMS service logic and repository may exist even without any mobile
core as it is independent from the type of access (4G, 5G, non-3GPP Core) and
eIMS5G study does not include the move of service logic from HSS.
But the main drawback of solution 16 is that it proposes services specific to
an interface: one set of services for Sh, and a separate set of services for
Cx. This is a point-to-point approach, rather than a service-based approach in
which a set of services is assumed to be available for any NF over any
interface.
**Solution 10:**
This solution has the merit to reuse UDM services principles (SDM, UECM). But,
as stated above, where the IMS data may be handled by a separate HSS FE with
associated EPC/IMS UDR, it is needed to separate services for IMS from
services for non-IMS.
**Solution 23:**
In that solution, it is proposed to define IMS specific service operations,
based on both solution 10 (based on UDM services principles: SDM, UECM) and
solution 16 (separating IMS services from non-IMS services), where service
operations can be used by any NF i.e. interface agnostic (reused between Sh
and Cx) hence satisfying service-based approach.
# 8 Conclusions
## 8.1 Conclusions Related to Key Issue #4
With regard to discovery of network functions it is concluded:
\- SMF can utilize the services of the NRF to discover/select the P-CSCF \-
solution 18 is used as the basis for normative work.
\- Solution 24 is used as the basis for normative work to address
discovery/selection of PCF by IMSâ€‘CSCF.
\- HSS discovery/selection will be resolved during normative phase.
## 8.2 Conclusions for Key Issue #5 and Key Issue #6
For Key Issue #5 and Key Issue #6 the following is concluded:
\- The IMS service logic is performed by the IMS-HSS. Whether the IMS Service
Logic is deployed as a combined UDM/HSS is an implementation option.
\- New SBA services are defined for IMS services exposed by the IMS service
logic, with CSCF and IMS-AS as consumers.
\- For interactions with the CSCF Solution 22 is the basis for normative work,
Stage 3 will need to investigate if whether implicit subscription from
solution 12 or explicit subscription (solution 22) are required.
\- For interactions with the IMS-AS Solution 23 will be used as the basis for
normative work. Stage 3 will investigate the data split in solution 16 into
operational and subscription data, if deemed necessary.
\- These new SBA services will support transport of IMS AS transparent data
(as the Sh interface does in diameter-based solutions) - to avoid unnecessary
impacts to existing IMS ASs. Stage 3 will need to investigate if for
transparent data the IMS-AS can use existing services, or enhancements to
existing services to store this type of data in the UDR.
## 8.3 Conclusions Related to Key Issue #7
Regarding key issue of \"How can IMS utilize services provided by Npcf\" the
following is concluded:
\- IMS can utilize the services of the PCF as a AF using existing Npcf
services.
\- Solution #9 and #14 are adopted as the basis for enhancing Npcf to support
IMS specific functions.
\- A note will be added to TS 23.228 [2] clarify that the selection between Rx
and N5 will be based on configuration in the IMS.
## 8.4 Conclusions Related to Key Issues #1, #2, #3 and #8
The investigations related to key issues #1, #2, #3 and #8 were not finalized
and no solutions were agreed for those key issues,
#