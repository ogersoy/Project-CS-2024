# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, certain modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
NOTE 1: The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.
NOTE 2: The constructions \"must\" and \"must not\" are not used as
substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a direct
citation from an external, referenced, non-3GPP document, or so as to maintain
continuity of style when extending or modifying the provisions of such a
referenced document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
NOTE 3: The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
NOTE 4: The constructions \"can\" and \"cannot\" shall not to be used as
substitutes for \"may\" and \"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
NOTE 5: The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The purpose of this Technical Report is to study enhancements for analytics
and NWDAF for the following objectives:
\- Remaining key issues from Release 16: UE driven analytics; How to ensure
that slice SLA is guaranteed; Which data from UPF can be used by NWDAF (e.g.
applications, other user data characteristics);
\- NWDAF architecture enhancements: Multiple NWDAF Instances in one PLMN
including hierarchies, roles and inter-NWDAF instance cooperation;
\- NWDAF features enhancement: Enabling real-time or near real-time NWDAF
communication, including mechanism for data collection; Service MOS based
NWDAF-Assisted UP Optimization; Minimization of the load generated by NWDAF
data collection;
\- New Use Cases/key issues: Interaction between NWDAF and ML Model & Training
Service owned by the operator.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System;
Stage 2\".
[5] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services; Stage 2\".
[6] ITU‑T Recommendation P.1203.3: \"Parametric bitstream-based quality
assessment of progressive download and adaptive audiovisual streaming services
over reliable transport - Quality integration module\".
[7] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol
specification\".
[8] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
[9] 3GPP TS 38.215: \"NR; Physical layer measurements\".
[10] 3GPP TR 23.700‑40: \"Study on enhancement of network slicing\".
[11] 3GPP TS 29.510: \"Network Function Repository Services; Stage 3\".
[12] 3GPP TS 26.512: \"5G Media Streaming (5GMS)\".
[13] 3GPP TR 37.816: \"Study on RAN-centric data collection and utilization
for LTE and NR\".
[14] 3GPP TR 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[15] 3GPP TS 32.255: \"Charging management; 5G data connectivity domain
charging; stage 2\".
[16] ITU‑T Recommendation P.1203.3: \"Parametric bitstream-based quality
assessment of progressive download and adaptive audiovisual streaming services
over reliable transport - Quality integration module\".
[17] 3GPP TS 23.434: \"Service Enabler Architecture Layer for Verticals
(SEAL); Functional architecture and information flows\".
[18] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
Nodes\".
[19] 3GPP TS 28.552: \"Management and orchestration; 5G performance
measurements\".
[20] 3GPP TS 28.310: \" Management and orchestration; Energy efficiency of
5G\".
[21] 3GPP TS 24.502: \"Access to the 3GPP 5G Core Network (5GCN) via non-3GPP
access networks\".
[22] 3GPP TS 37.320: \"Radio measurement collection for Minimization of Drive
Tests (MDT); Overall description; Stage 2\".
[23] 3GPP TS 28.532: \"Management and orchestration; Generic management
services\".
[24] 3GPP TS 28.550: \"Management and orchestration; Performance Assurance\".
[25] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[26] 3GPP TS 28.554: \"5G end to end Key Performance Indicators (KPI)\".
[27] 3GPP TS 26.501: \"5G Media Streaming (5GMS); General description and
architecture\".
[28] 3GPP TR 23.748: \"Study on enhancement of support for Edge Computing in
5G Core network (5GC)\".
[29] 3GPP TS 29.517: \"5G System; Application Function (AF) event exposure
service; Stage 3\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
AR/VR Augmented Reality/Virtual Reality
ASP Application Service Provider
OS Operating System
RFSP RAT/Frequency Selection Priority
RTT Round-Trip Time
SLA Service Level Agreement
SLS Service Level Specification
# 4 Architectural Assumptions
The architecture and framework as specified in TS 23.288 [5], TS 23.501 [2],
TS 23.502 [3] and TS 23.503 [4] are regarded as the baseline for the present
study.
Solutions shall build on the 5G System architectural principles as in TS
23.501 [2], including flexibility and modularity for newly introduced
functionalities.
# 5 Use Cases and Key Issues
## 5.1 Use Cases
### 5.1.1 Use Case #1: NWDAF-assisted RAT/frequency selection
#### 5.1.1.1 Description
Many operators are about to perform frequency reframing and deploy NR with
high and low frequency.
The RFSP mechanism is supported in the current specification. It can be
beneficial to leverage NWDAF to perform/provide the big data analytics in
order to help the PCF to derive suitable RAT/frequency selection policy (e.g.
RFSP). Based on UEs behaviour/Service analytics data provided by NWDAF, there
are two corresponding scenarios we need to consider:
\- Scenario 1: enable inter-RAT selection from NR (i.e. gNB) to E-UTRAN (i.e.
eNB connected to EPC).
\- Scenario 2: enable frequency selection from NR with high frequency to NR
with low frequency.
In scenario 1, e.g. enable inter-RAT selection from NR to E-UTRAN if some
UEs/users are always inactive or use low value services (e.g. P-to-P download)
at some time or somewhere, in order to guarantee other UEs/users\' QoE. On the
contrast, e.g. maintain on current NR RAT for the UEs/users who use services
with higher requirements on low latency and wide bandwidth (e.g. VR, AR). In
this scenario, the service MOS is a key point, which could be taken into
consideration in further study.
In scenario 2, e.g. enable frequency selection from NR with high frequency to
NR with low frequency if some UEs/users want to camp on NR but use the
services without extreme wide bandwidth requirements. While the UEs/users
using services with higher requirements on wide bandwidth will be maintained
on NR with high frequency to guarantee their QoE.
### 5.1.2 Use Case #2: NWDAF supporting detection of anomaly events and
helping in analysing its cause
#### 5.1.2.1 Description
In Rel-16, NWDAF can provide abnormal UE behaviour analytics, as specified in
TS 23.288 [5] clause 6.7.5. One area where NWDAF could help is in detecting
abnormal behaviour in general, not only related to the UE. With the capability
to collect different types of data already in Rel-16, the NWDAF could provide
anomaly type of alerts to other network functions together with additional
information on the possible cause for the anomaly, thus allowing for 5G
service automation, or allowing for troubleshooting in general.
Some examples of anomaly events and information provided could be:
\- Congested cells analysis and a list of heavy users on the congested cells;
\- Signalling events anomaly per device type, per OS, per applications;
\- Signalling congestion events per network function.
Such anomaly events information could be provided to some network functions so
that they could take proper action, e.g. to PCF to derive different policies,
to AMF to apply different signalling parameters, etc.
### 5.1.3 Use Case #3: NWDAF support for dispersion analytics
#### 5.1.3.1 Description
In Rel-16, NWDAF can provide UE mobility statistics or prediction as specified
in TS 23.288 [5] clause 6.7.2. However, mobility information is not sufficient
to determine hot spots areas that may require additional operator attention.
Data dispersion indices go beyond counting or knowing all visited touchpoints
to focus only on locations where a UE or group of UEs have dispersed a
significant amount of data, significant amount of signalling, sustained
significant amount of call drops and significant amount of transaction
failures. Same applies to network slice touchpoints. A data dispersion index
counts the locations on which a subscriber or group of subscribers have
dispersed their bulk of data volume while a voice dispersion index counts the
locations where the subscribers or group of subscribers have spent most of
their talk time. Other dispersion indices similarly measure the locality of
control plane transactions. These indices reveal the cardinality of locations
where dispersion of different measures occurred and point to the identity of
these camping locations which when aggregated across UEs, quickly reveal hot
spot locations.
In contrast to fixed IoT devices, UEs not designated as fixed devices may
nevertheless tend to disperse most (not all) of their data in the same
location (i.e. cell or an area). Such behaviour of camping UEs create hot
spots that may need different operator awareness. In particular, data
dispersion indices can help determine hot spot data location and the optimal
desired location of edge computing resources for a UE or a group of UEs. It
can also exploit the locality information and assist in positioning UPFs in
key locations that optimize the User Plan routing (WT #12) and reduce latency.
Obtaining a UE or UE group dispersion indices is not necessarily UE centric
measure and can be used as a network centric measure. A UE, or group of UEs
mobility profile may indicate N visited locations but in reality, only M \ NSI ID Identification of the Network Slice instance > Number of UE
Registrations Number of UE registrations of the NSI (NOTE 3) > Number of PDU
Sessions establishment Number of PDU Session establishments of the NSI (NOTE
3) > Resource usage The usage of assigned virtual resources currently in use
for the NF instances (mean usage of virtual CPU, memory, disk) as defined in
TS 28.552 [19] clause 5.7, belonging to a particular Network Slice instance. >
Resource usage threshold crossings (optional) Number of resource usage
threshold crossings on the Network Slice instance provided if threshold is
provided by the consumer as Analytics Filter. > Resource usage threshold
crossings time period (1,...,max) (optional) Resource usage threshold crossing
vector including time elapsed between each threshold crossing on the Network
Slice instance provided if threshold is provided by the consumer as Analytics
Filter.
* * *
Table 6.2.1.3.2-2: Output analytics for Network Slice load
* * *
Information Description S-NSSAI Identification of the Network Slice > Number
of UE Registrations Number of UE registrations of the Network Slice (NOTE 3) >
Number of PDU sessions establishments Number of PDU Session establishments of
the Network Slice (NOTE 3)
* * *
NOTE 1: The deployment of Network Slice instances in the network is optional
and depends on the deployment choices of the operator. If Network Slice
instances are not deployed, slice load output analytics may be provided
according to Table 6.2.1.3.2-2.
NOTE 2: Tables 6.2.1.3.2-1 and 6.2.1.3.2-2 show output analytics applicable to
statistics and predictions. Predictions may require one additional entry to
Tables 6.2.1.3.2-1 and 6.2.1.3.2-2 with the confidence of the prediction. This
should not preclude NWDAF from providing instantaneous notifications of
threshold crossings when required, as specified in TS 23.288 [5].
NOTE 3: How the output analytics for number of UE registrations and number of
PDU sessions on a slice is determined based on the analytic filter information
and/or the analytics target period for analytics may be further determined
during normative work (e.g. via averaging).
#### 6.2.1.4 Procedures
NOTE: In all the procedures below, AMF* indicates the AMF instance involved in
the call flow may refer to any AMF instance(s) within a same AMF Set.
##### 6.2.1.4.1 NSSF based solution
Figure 6.2.1.4.1-1: Procedure for NWDAF-assisted slice SLA guarantee solution
based on NSSF
0a.-0b. OAM creates a new slice and configures initial resources in RAN and in
CN allocated to the slice. If a NWDAF subscribed for the slice creation
notification, the OAM notifies the slice information as described in clause
6.2.1.2.
1a.-1b. NSSF and optionally OAM subscribe to slice service experience
analytics from NWDAF. One or multiple subscriptions to one or multiple
S-NSSAI(s), NSI ID(s) are possible.
2\. NSSF and optionally OAM subscribe to slice load analytics from NWDAF.
NOTE 1: Input data for slice load analytics is collected by NWDAF according to
clause 6.2.1.3.1.
3\. New UEs get continuously registered in the slice.
4\. NWDAF collects input data required to derive slice service experience
analytics as described in TS 23.288 [5] and as according to clause 6.2.1.4.3.
NOTE 2: Figure 6.2.1.4.1-1 does not show the exhaustive list of NFs that may
provide input data to NWDAF.
5\. Depending on the Analytics Filter information (e.g., Area of Interest) and
the Analytics Reporting information (e.g. Event Reporting parameters,
Reporting Thresholds), the NWDAF provides the Slice service experience
analytics to NSSF and optionally to OAM.
6\. Depending on the Analytics Filter information (e.g., Area of Interest) and
the Analytics Reporting information (e.g. Event Reporting parameters,
Reporting Thresholds), the NWDAF provides the Slice load analytics to NSSF and
optionally to OAM.
NOTE 3: Whether and How OAM may use NWDAF slice level analytics needs to be
determined by SA WG5
7\. NSSF analyses statistics and predictions on slice load and service
experience aiming to assist in fulfilling slice SLA (e.g. on reported service
experience within the slice for a UE).
8\. [OPTIONAL] OAM continuously monitors slice SLA. For that purpose it may
use as optional inputs NWDAF slice level analytics in addition to other
management data as defined in SA WG5 TSs.
9\. NSSF decides to trigger action based on the slice analytics provided by
NWDAF. Hence, NSSF may trigger either Network Slice load distribution, or
Network Slice instance load distribution, or both. Alternatively, the NSSF
does not trigger any distribution immediately but wait for the UE Registration
and then check if the UE registration can be accepted or not.
NOTE 4: This solution assumes that more than one slice may have been
previously created by OAM.
10a. [OPTIONAL] NSSF triggers a Network Slice load distribution procedure
(details below).
10b. [OPTIONAL] NSSF triggers a Network Slice instance load distribution
procedure (details below).
NOTE 5: Step 10b can only be applied if the deployment choice of the operator
allows Network Slice instance(s) in the 5GC, and those are identified via NSI
ID(s).
11\. [OPTIONAL] OAM may take management decisions based on the collected
inputs including management data and NWDAF analytics. If required, OAM may
inform 5GC of such management decisions.
(Figure 6.2.1.4.1-1, Step 10a) NSSF triggers a Network Slice load distribution
procedure:
Figure 6.2.1.4.1-2: Detail of Step 10a in Figure 6.2.1.4.1-1
1\. Based on the slice level analytics provided by NWDAF, NSSF concludes a
Network Slice restriction is required.
2a. [OPTIONAL] Once NSSF determines that the service experience of one Network
Slice has been degraded/is predicted to degrade, it may issue a restriction so
that no further UE registrations are allocated to that Network Slice if AMF
has previously subscribed to NSSF to be notified when a Network Slice
Restriction applies. This may be the case when e.g. AMF does not check with
NSSF for new UE registrations (i.e. step 2c is not performed). In this case, a
message is sent from NSSF to AMF in the form of a notification service
indicating that the detected S-NSSAI should not be used for new UE
registrations. The notification must contain the restricted S-NSSAI.
2b. The UE initiates registration procedure requesting registration on the
restricted Network Slice (via e.g. S-NSSAI).
2c. [OPTIONAL] If no Network Slice restriction is issued, AMF/NSSF determine
whether the Network Slice restriction can be satisfied for UE registration
leveraging the Network Slice registration procedures defined in TS 23.501 [2].
The AMF contacts the NSSF for a UE Registration, then the NSSF checks the NW
slice restrictions and return to AMF if the slice is allowed.
2d. The UE registration is completed or rejected. If completed, PDU sessions
may be establised for the registered UE if/when required.
(Figure 6.2.1.4.1-1 Step 10b) NSSF triggers a Network Slice instance load
distribution procedure:
Figure 6.2.1.4.1-3: Detail of Step 10b in Figure 6.2.1.4.1-1
1\. Based on the slice level analytics provided by NWDAF, NSSF concludes a
Network Slice instance restriction is required.
2\. [OPTIONAL] Once NSSF determines that the service experience of one Network
Slice instance has been degraded/is predicted to degrade, it may issue a
restriction so that no further UE registrations and/or PDU sessions are
allocated to that Network Slice instance. A message is sent from NSSF to AMF
in the form of a notification service indicating that the detected NSI ID
within the S-NSSAI should not be used for new UE registrations (when step 5 is
not performed) and/or PDU session establishments. The notification must
contain the restricted NSI ID and its corresponding S-NSSAI.
3\. New UE initiates registration procedure requesting registration on the
Network Slice (identified via S-NSSAI) containing the restricted Network Slice
instance (identified via NSI ID).
4\. [OPTIONAL] If AMF handles NSI ID(s) information during UE registration, it
may take into account the Network Slice instance restriction to assign NSI ID
to the new UE registration if AMF does not interact with NSSF for new UE
registrations.
5\. [OPTIONAL] AMF and NSSF may interact as described in TS 23.501 [2] to
determine the NSI ID to be used for the new UE registration.
6\. UE registration is completed or rejected
7\. A UE already registered in the network requests a new PDU session
establishment according to TS 23.502 [3].
8\. [OPTIONAL] If AMF handles NSI ID(s) information during PDU session
establishment, it may take into account the Network Slice instance restriction
to assign NSI ID to the new PDU session establishment.
9\. [OPTIONAL] SMF selection is performed according to TS 23.502 [3]
accounting for the restricted NSI ID(s).
10\. PDU session establishment is completed.
##### 6.2.1.4.2 AMF based solution
Figure 6.2.1.4.2-1: Overall procedure for NWDAF-assisted slice SLA guarantee
solution based on AMF
0a.-0b. OAM creates a new slice and configures initial resources in RAN and in
CN allocated to the slice. If a NWDAF subscribed for the slice creation
notification, the OAM notifies the slice information as described in clause
6.2.1.2.
1a.-1b. AMF and optionally OAM subscribe to slice service experience analytics
from NWDAF. One or multiple subscriptions to one or multiple S-NSSAI(s), NSI
ID(s) are possible.
2\. AMF and optionally OAM subscribe to slice load analytics from NWDAF.
NOTE 1: Input data for slice load analytics is collected by NWDAF according to
clause 6.2.1.3.1.
3\. New UEs get continuously registered in the Network Slice.
4\. NWDAF collects input data required to derive slice service experience
analytics as described in TS 23.288 [5] and as according to clause 6.2.1.3.
NOTE 2: Figure 6.2.1.4.2-1 does not show the exhaustive list of NFs that may
provide input data to NWDAF.
5\. Depending on the Analytics Filter information (e.g., Area of Interest) and
the Analytics Reporting information (e.g. Event Reporting parameters,
Reporting Thresholds), the NWDAF provides the Slice service experience
analytics to AMF and optionally to OAM.
6\. Depending on the Analytics Filter information (e.g., Area of Interest) and
the Analytics Reporting information (e.g. Event Reporting parameters,
Reporting Thresholds), the NWDAF provides the Slice load analytics to AMF and
optionally to OAM.
NOTE 3: Whether and How OAM may use NWDAF slice level analytics needs to be
determined by SA WG5.
7\. AMF analyses statistics and predictions on slice load and service
experience.
8\. [OPTIONAL] OAM continuously monitors slice SLA. For that purpose it may
use as optional inputs NWDAF slice level analytics in addition to other
management data.
9\. AMF decides to trigger action based on the slice analytics provided by
NWDAF. Hence, AMF may trigger either Network Slice load distribution, or
Network Slice instance load distribution, or both.
NOTE 4: This solution assumes that more than one slice may have been
previously created by OAM.
10a. [OPTIONAL] AMF triggers Network Slice load distribution (details below).
10b. [OPTIONAL] AMF triggers Network Slice instance load distribution (details
below).
NOTE 5: Step 10b can only be applied if the deployment choice of the operator
allows Network Slice instance(s) in the 5GC, and those are identified via NSI
ID(s).
11\. [OPTIONAL] OAM may take management decisions based on the collected
inputs including management data and NWDAF analytics. If required, OAM may
inform 5GC of such management decisions.
(Figure 6.2.1.4.2-1, Step 10a) AMF triggers a Network Slice load distribution
procedure:
Figure 6.2.1.4.2-2: Detail of Step 10a in Figure 6.2.1.4.2-1
1\. Based on the slice level analytics provided by NWDAF, AMF concludes a
Network Slice restriction is required.
2a. The UE initiates registration procedure requesting registration on the
restricted Network Slice (via e.g. S-NSSAI).
2b. AMF determines whether the Network Slice restriction can be satisfied for
UE registration leveraging the Network Slice registration procedures defined
in TS 23.501 [2].
2c. The UE registration is completed or rejected. If completed, PDU sessions
may be established for the registered UE if/when required.
NOTE: An alignment with FS_eNS_Ph2 may be required for this solution based on
the outcome of FS_eNS_Ph2.
(Figure 6.2.1.4.2-1, Step 10b) AMF triggers a Network Slice instance load
distribution procedure:
Figure 6.2.1.4.2-3: Detail of Step 10b in Figure 6.2.1.4.2-1
1\. Based on the slice level analytics provided by NWDAF, AMF concludes a
Network Slice instance restriction is required.
2\. New UE initiates registration procedure requesting registration on the
Network Slice (identified via S-NSSAI) containing the restricted Network Slice
instance (identified via NSI ID).
3\. [OPTIONAL] If AMF handles NSI ID(s) information during UE registration, it
may take into account the Network Slice instance restriction to assign NSI ID
to the new UE registration.
4\. UE registration is completed or rejected
5\. A UE already registered in the network requests a new PDU session
establishment according to TS 23.502 [3].
6\. [OPTIONAL] If AMF handles NSI ID(s) information during PDU session
establishment, it may take into account the Network Slice instance restriction
to assign NSI ID to the new PDU session establishment.
7\. SMF selection is performed according to TS 23.502 [3] accounting for the
restricted NSI ID(s).
8\. PDU session establishment is completed.
##### 6.2.1.4.3 Procedures for slice load analytics
Figure 6.2.1.4.3-1: Procedure to support slice load analytics by NWDAF
Fig. 6.2.1.4.3-1 shows the procedure for NWDAF to derive slice load analytics.
The steps are described as follows:
1\. The service consumer subscribes to slice load analytics via the
Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service
operations. In addition, the service consumer provides Analytics ID = Load
level information and a set of Event Filters. Mandatory Analytics Filters
include S-NSSAI and Area of Interest. Optional event filters may include NSI
ID(s) and load threshold value(s).
2\. [OPTIONAL] If NWDAF does not have already the slice information, it gains
the slice information from OAM (as described in clause 6.2.1.2) and discovers
from NRF the AMF, SMF and NSSF instance(s) relevant to the Analytics Filters
provided in the analytics subscription.
3\. [OPTIONAL] If the NSI ID(s) are nor provided in the analytics subscription
by the service consumer, NWDAF invokes Nnssf_NSSelection_Get service operation
from NSSF to obtain the NSI ID(s) corresponding to the S-NSSAI in the
subscription.
4a. NWDAF subscribes to input data from OAM following the procedure captured
in clause 6.2.3.2. of TS 23.288 [5].
4b. [OPTIONAL] NWDAF may collect input data from NRF (see clause 6.5 in TS
23.288 [5]) to derive slice instance resource usage statistics and predictions
for a Network Slice instance.
5\. NWDAF subscribes to AMF\'s event exposure service to collect data on the
number of UEs currently registered on certain Network Slice and, if available,
its constituent Network Slice instance(s). An UE access and mobility
information event is used for that purpose as defined in TS 23.502 [3] using
as Event Filters S-NSSAI and, if available, NSI ID(s). If required, NWDAF may
also collect the corresponding UE IDs.
6\. NWDAF subscribes to SMF\'s event exposure service to collect data on the
number of PDU sessions currently registered on certain Network Slice and, if
available, its constituent Network Slice instance(s). A PDU Session related
event is used for that purpose as defined in TS 23.502 [3] and potential Event
Filters are S-NSSAI, NSI ID(s), UE IDs, etc.
7\. NWDAF derives slice load analytics.
8\. NWDAF delivers analytics to service consumer by invoking
Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response
service operations.
### 6.2.2 Impacts on services, entities and interfaces
NWDAF:
\- Provides slice load analytics to NWDAF service consumer.
\- NWDAF discovers the NFs associated to a slice using the NRF discovery
request for NF type(s) of interest to NWDAF.
NSSF/AMF:
\- Subscribe to both slice service experience and slice load analytics from
NWDAF.
\- Continuously analyse slice level analytics (i.e. service experience and
load) provided by NWDAF.
\- Based on analytics, trigger Network Slice and/or Network Slice instance
load distribution procedure.
\- Support Network Slice/Network Slice instance restriction.
**NRF:**
\- Provides all NF instance IDs of NF instances of specific NF type(s)
belonging to the requested S-NSSAI and optionally NSI ID.
## 6.3 Solution #3: User consent for UE data collection
### 6.3.1 Description
#### 6.3.1.1 General
To satisfy the requirement in Key Issue #15: User consent for UE data
collection/analytics for privacy of some of the UE data, a User consent may be
required for some or all the UE information.
It is network operator\'s responsibility to collect and manage the User
consent, if required, before initiating UE data collection and reporting by
the UE. The user consent information can be considered as part of the
subscription data.
Editor\'s note: Coordination with SA WG3 is required.
#### 6.3.1.2 Procedure
The provision of the User consent for the UE data collection is shown in
Figure 6.3.1.2-1 below.
{width="6.6875in" height="3.4930555555555554in"}
Figure 6.3.1.2-1: User consent provision for UE data collection
1). Nnef_ParameterProvision_Update Request(UE_ext_Id, user consent for UE data
collection) - The Service Provider (AF) may collect the user consent for UE
data collection (if applicable) from its users and provide the information via
the NEF in the user consent for UE data collection parameter along with the UE
Id for which the user consent applies. The Service Provider may also update or
revoke the user consent.
2). AF authorisation - The NEF checks whether the AF is authorized for user
consent provision or update.
3). The NEF may inquire with the UDM to translate UE ext_Id to a 3GPP internal
identity UE_Id. Then the NEF forwards the request from the AF to the UDM via
Nudm_ParameterProvision_Update Request (UE_Id, user consent for UE data
collection).
4). The user consent for UE data collection parameter is stored in the UDM as
a subscription information. The user consent for UE data collection parameter
may define the user consent for UE level data collection from UE or
application or network side. The user consent for UE data collection parameter
may also be provisioned by the network operator.
Alternatively, the user consent for UE data collection parameter may be
configured in the UDM/UDR as a user subscription information.
5). Nudm_SDM_Get (UE_Id, user consent for UE data collection) - The NWDAF may
retrieve the user consent for UE data collection before triggering some UE
data specific analytics and data collection.
6). Nudm_SDM_Get (UE_Id, user consent for UE data collection) - The AMF may
retrieve the user consent for UE data collection before triggering some UE
data specific data collection
NOTE: This step can be covered via regular AMF - UDM communication during UE
registration.
### 6.3.2 Impacts on services, entities and interfaces
UDM:
\- Holds the user consent for **UE data collection** as a subscription data.
NEF:
\- AF authorisation and rejection if needed.
NWDAF/AMF:
\- Retrieves and checks the user consent for UE data collection before
triggering some UE data specific analytics and data collection.
## 6.4 Solution #4: Service Behaviour analytics and Service Experience
analytics for NWDAF-assisted RFSP policy
### 6.4.1 Description
#### 6.4.1.1 General
This solution is proposed to address Key Issue #12: NWDAF-assisted RFSP
policy.
This solution proposes that PCF determines the RFSP value for a UE based on
following aspects:
1) the application(s) in use;
2) the observed service experience.
The application(s) in use means the UE location and/or time of the day that
the application activated. This information can be determined in two method.
Method a) defines a new AnalyticsId named \"service in use\" which is used by
NWDAF to collect the application in use. The input data for \"service in use\"
analytics is described in Table 6.4.1.2-1. PCF as a consumer can subscribe the
\"service in use\" analytics to NWDAF. Method b) PCF detects this application
in use information from AF based on the output of DCAMP. In this case, there
is no need to define new \"service in use\" analytics in NWDAF.
The Observed service experience that supported in clause 6.4 in TS 23.288 [5]
with the enhancement that defined in clause 6.4.1.2 will be used in this
solution.
This solution merges solution#43.
#### 6.4.1.2 Input data
Table 6.4.1.2-1 shows the input data for \"service in use\" analytics.
Table 6.4.1.2-1: Input data related to the Service in use analytics
* * *
Information Source Description Application ID AF To identify the service and
support analytics per type of service (the desired level of service).
Locations of Application AF/NEF Locations of application represented by a list
of DNAI(s). The NEF may map the AF-Service-Identifier information to a list of
DNAI(s) when the DNAI(s) being used by the application are statically defined.
Service Experience AF Refers to the QoE as established in the SLA and during
on boarding. It can be either e.g. MOS or video MOS as specified in ITU-T
P.1203.3 [6] or a customized MOS. Timestamp AF A time stamp associated to the
observed level of Service Experience provided by the AF, mandatory if the
observed Service Experience is provided by the ASP. Start time AF Start time
for the application used by the UE Duration time AF Period for the application
* * *
The input data for Observed service experience analytics that defined in
clause 6.4, TS 23.288 [5] is reused with exception defined in Table 6.4.1.2-2.
Table 6.4.1.2-2: Enhanced Input Data for Observed Service Experience
* * *
Information Source Description Subscriber category UDR/PCF The Subscriber
category may comprise any number of identifiers associated with the subscriber
(e.g. gold, silver, etc.). Each identifier associates operator defined
policies to the subscriber that belong to that category, seeing details
defined in 1 23.503 [4].
* * *
The input data for service experience analytics is to reuse the ones defined
in clause 6.4, TS 23.288 [5] with exception that Table 6.4.2-3: UE level
Network Data from OAM is extended to further retrieve RAT/Frequency
information related to the service experience observation period from OAM in
order to allow NWDAF to be able to provide Service Experience per RAT type and
Frequency.
#### 6.4.1.3 Output Analytics
For enhanced \"Observed service experience\" analytics, the output are listed
as below:
\- Service Experience statistics information per Application defined in TS
23.288 [5] is extended to provide Service Experience per RAT type and
Frequency;
\- Service Experience predictions information per Application defined in TS
23.288 [5] is extended to provide Service Experience per RAT type and
Frequency.
For \"service in use\" analytics, the output are listed as below:
\- Service in use statistics information per UE is defined in Table 6.4.1.3-1;
\- Service in use predictions information per UE is defined in Table
6.4.1.3-2.
Table 6.4.1.3-1: Service in use statistics
+---------------------------+-----------------------------------------+ | Information | Description | +---------------------------+-----------------------------------------+ | UE ID | Identity of the UE (such as SUPI) for | | | the Service in use analytics. | +---------------------------+-----------------------------------------+ | Service in use (1..n) | | +---------------------------+-----------------------------------------+ | > Application ID | Identification of the application. | +---------------------------+-----------------------------------------+ | > Occurrence probability | Probability for the application used by | | | the UE. | +---------------------------+-----------------------------------------+ | > Duration Time | Period for the application used by the | | | UE. | +---------------------------+-----------------------------------------+ | > Start time | Start time for the application used by | | | the UE | +---------------------------+-----------------------------------------+ | > Spatial validity | Area where the Service Behaviour | | | applies. | | | | | | If Area of Interest information was | | | provided in the request or | | | subscription, spatial validity may be a | | | subset of the requested Area of | | | Interest. | +---------------------------+-----------------------------------------+
Table 6.4.1.3-2: Service in use predictions
+---------------------------+-----------------------------------------+ | Information | Description | +---------------------------+-----------------------------------------+ | UE ID | Identity of the UE (such as SUPI) for | | | the Service in use analytics | +---------------------------+-----------------------------------------+ | Service in use (1..n) | | +---------------------------+-----------------------------------------+ | > Application ID | Identification of the application. | +---------------------------+-----------------------------------------+ | > Occurrence probability | Probability for the application used by | | | the UE | +---------------------------+-----------------------------------------+ | > Start time | Start time for the application used by | | | the UE | +---------------------------+-----------------------------------------+ | > Duration Time | Period for the application used by the | | | UE | +---------------------------+-----------------------------------------+ | > Spatial validity | Area where the Service Behaviour | | | applies. | | | | | | If Area of Interest information was | | | provided in the request or | | | subscription, spatial validity may be a | | | subset of the requested Area of | | | Interest. | +---------------------------+-----------------------------------------+ | > Probability assertion | Confidence of this prediction. | +---------------------------+-----------------------------------------+
#### 6.4.1.4 Procedures
##### 6.4.1.4.1 General
The procedure as depicted in Figure 6.4.1.4-1-1: is used by an NF to retrieve
the service experience analytics for a specific application. In order to
determine the applications a UE consumes two different methods are shown:
Method a) Consumer subscribes NWDAF both the new defined \"Service in use\"
and the enhanced \"Observed Service experience\" analytics.
Method b) Depending on the output of DCAMP, It is assumed that the NF consumer
is informed the application in use information, therefore, consumer subscribes
NWDAF to only provide the output of \"Observed Service experience\" analytics,
step 1-3 are omitted in this method.
Figure 6.4.1.4.1-1: Procedure for RFSP index allocation based on the Service
Experience per Application
1\. The consumer NF sends an Analytics subscribe (Analytics ID = Service in
use, Target of Analytics Reporting = SUPI, Analytics Filter information =
(Area of Interest, Analytics target period)) to NWDAF by invoking a
Nnwdaf_AnalyticsSubscription_Subscribe. Note that the NF consumer may not
provide any Analytics Filter Information, then in this case the NWDAF includes
the start time, duration and spatial time as described in table 6.4.1.3-1 or
table 6.4.1.3-2.
2\. NWDAF subscribes the service data from AF in the Table 6.4.1.2-1 by
invoking Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe service
(Event ID = Service Data, Event Filter information = (Application ID, Area of
Interest), Target of Event Reporting = UE ID) as defined TS 23.502 [3].
NOTE 1: In the case of external AF, NEF translates the requested Area of
Interest into a list of geographic zone identifier(s) as described in clause
5.6.7.1 of TS 23.501 [2].
3\. The NWDAF provides the Service in use data analytics to the consumer NF by
means of Nnwdaf_AnalyticsSubscription_Notify, including the output listed in
table 6.4.1.3-1 or table 6.4.1.3-2. The Start time, duration and spatial
validity are provided if the NF consumer did not include Analytics Filter
Information in step 1.
4-6. The NF consumer checks the list of service(s) in use and its behaviour in
terms in time and location then decides for which services Analytics on
Service Experience is needed, these corresponds to Analytics Id on the
existing Service Experience on TS 23.288 [5] and output extended as defined in
clause 6.1.4.3.
NOTE 2: The call flow only shows a subscription-notify model for the
interaction of NWDAF and consumer NF for simplicity instead of both request-
response model and subscription-notification model as defined in clause 6.1,
TS 23.288 [5].
If the consumer NF is PCF, it could use the data analytics to derive suitable
RFSP index (specified in clause 5.3.4.3 of TS 23.501 [2]), i.e. Service
Experience analytics and if requested Service in use analytics which are
defined in clause 6.4.1.3, as follows: The PCF is informed on the services in
use, either from NWDAF or from other NF(s) (depending on the output of DCAMP)
depending on the method to be used. For each application in use, the PCF
requests the Service Experience analytics for the RAT/Frequency (i.e. RFSP
index) where the UE is located, as determined by the PCF operator policies or
by the RFSP subscribed value and then use this information to check and change
the RFSP index value.
### 6.4.2 Impacts on services, entities and interfaces
PCF:
\- Using the information of analysis result of NWDAF to make decision on the
RSFP index.
\- Impacts listed in solution#43.
NWDAF:
\- New Analytics Id on Service in use to estimate the application in use, the
time and the location (method a)
\- Existing Analytics Id on Service Experience is extended with per RAT and
Frequency reporting.
OAM:
\- RAT/Frequency where the UE camped during the service experience observation
period is retrieved from OAM.
## 6.5 Solution #5: ML Model sharing architecture
### 6.5.1 Description
This solution is proposed for Key Issue #1: Logical decomposition of NWDAF and
possible interactions between logical functions and Key Issue #19: Trained
data model sharing between multiple NWDAF instances.
AI Function (AIF) trains the ML Model(s) and provides ML Model(s) to 5G NFs
(e.g. NWDAF). The following figure 6.5.1-1 shows the network data analytics
architecture supporting AIF.
Figure 6.5.1-1: Network data analytics architecture supporting AIF
The AIF is decomposed from a NWDAF, it can be a standalone NF or a NWDAF
functionality.
NOTE 1: The AIF within 3^rd^ party AF is not considered in this release.
The AIF supporting the following functionalities:
\- ML Model Training;
\- ML Model Repository;
\- ML Model Exposure.
In order to support AIF consumer to discover an AIF instance that is able to
provide some specific type of ML Model, each AIF instance should provide the
list of ML Model ID(s) that it support when registering to the NRF, in
addition to other NRF registration elements of the NF profile. Other NFs
requiring the discovery of an AIF instance that provides support for some
specific type of ML Models may query the NRF and include the ML Model ID(s)
that identifies the desired type of ML Model. The ML Model ID identifies an ML
Model and correlates with Analytics ID defined in TS 23.288 [5].
NOTE 2: Discovery, via NRF, of ML models supported by AIF and related
parameters are aligned with Key Issue #19: Trained data model sharing between
multiple NWDAF instances.
In order to support a specified ML Model training, the AIF may need to collect
data from data source (e.g. 3GPP NF(s), data centre).
The AIF service consumer provides the following input parameters listed below.
\- A list of ML Model ID(s): identifies requested ML Model(s);
\- Filter information: indicates the conditions to be fulfilled (e.g.
accuracy, performance).
The AIF provides to the consumer the output information listed below.
\- A list of ML Model ID(s);
\- ML Model.
### 6.5.2 Procedures
#### 6.5.2.1 ML Model exposure procedure
Figure 6.5.2.1-1: procedure of ML Model exposure
1\. AIF service consumer (e.g. AF, 5GC NF) requests the AIF for an ML Model
indicated by ML Model ID(s). The AIF may need to train the ML Model to meet
the requirement. The parameters that can be provided by the AIF service
consumer are listed in clause 6.5.1. Step 1, may be a subscription request,
requesting from the AIF to be notified when updated trained ML models are
available.
2\. When a request for an ML Model received, the AIF either responds with the
requested ML model if it has, or responds with time when the ML model will be
available if ML model is not ready.
3\. If the AIF needs to train the designated ML model, it collect data from
data source (e.g. AF, 5GC NFs) for ML Model training.
NOTE: what the data source is shall comply with the conclusion for KI#11.
> 4\. The AIF performs ML model training.
>
> 5\. The AIF service consumer re-sends the request if needed according to the
> time indicated by AIF in step 2.
6\. The AIF provides a response including the requested ML model to the
consumer.
7\. The AIF determines that the ML model provided in step 6 requires re-
training. This may happen when the AIF is configured with an updated initial
ML model or when the data that were used to train the previously provided ML
model have changed (e.g. an AF provides as input data an updated communication
pattern for a UE).
8\. The AIF trains an updated ML model.
9\. The AIF based on the subscription from the AIF consumer, notifies and
provides to the AIF consumer the updated ML model (if available). If the new
trained ML model is not available the AIF indicate to the AIF service consumer
that an updated ML model is available and the time when the ML model will be
available.
10\. If the AIF service consumer is notified that an updated trained ML model
is available the AIF service consumer may not provide analytics information to
the Analytics Consumer until the updated trained ML Model is provided by the
AIF.
#### 6.5.2.2 NWDAF analytics service supporting AIF
Figure 6.5.2.2-1: NWDAF analytics service supporting AIF
1\. Consumer NF sends an Analytics request/subscribe including Analytics ID to
NWDAF.
2\. In order to provide the requested analytics, the NWDAF may need to
determine which ML model is used for the requested analytics. If the NWDAF do
not have a proper ML Model for the request analytics, the NWDAF may discover
from the NRF the ML Model ID and AIF instance address with requested Analytics
ID and send a request to the AIF for the ML Model indicated by the ML Model
ID.
3\. The NWDAF may need to collect data from 3GPP NFs for the requested
analytics.
4\. The NWDAF derives requested analytics.
5\. If the analytics result does not meet the requirement (e.g. accuracy), the
NWDAF may need to request the AIF to train the ML Model indicated by ML Model
ID, the NWDAF may also indicate that the analytics result does not meet the
requirement, so that the AIF may collect data from the NWDAF to adjust the ML
model, where the data collected from the NWDAF was used to determine that the
analytics result doesn\'t meet the requirements.
6\. The NWDAF derives new requested analytics using the updated ML model
provided by the AIF.
7\. The NWDAF responses to the consumer with the analytics result.
### 6.5.3 Impacts on services, entities and interfaces
A new network function AIF is introduced. The AIF provides ML Model training
and ML Model exposure service.
No impact on current services, entities and interfaces, except:
\- NWDAF requests ML Model from AIF;
\- NF profile in NRF includes list of ML Model ID(s).
## 6.6 Solution #6: NWDAF decompose architecture
### 6.6.1 Description
#### 6.6.1.1 General
This solution addresses Key Issue#1: Logical decomposition of NWDAF and
possible interactions between logical functions.
#### 6.6.1.2 Architecture
The NWDAF may be composed by the following functions:
1). ML model training function: used to train the model;
2). Analytics function: used to do the data analytics for the consumer and
expose the analytics result to the consumer;
Different types of NWDAF maybe deployed in the network, a NWDAF may only
support ML model training function, or only support Analytics function, or
support both of these two Functions.
#### 6.6.1.3 ML Model Training
The ML model training function is used for initial ML model training and the
further update of trained ML model, the initial ML model can be provided by a
ML designer or local configuration. The ML designer is a designer environment
to create the initial ML model which can be operated either by a 3^rd^ party,
or by the operator.
NOTE 1: The ML designer function is out of SA WG2 scope, how the ML designer
provides the initial ML model to ML model training function is out of SA WG2
scope.
NWDAF Data Repository is the data storage entities that stores the data
collected by NWDAF from other 5G NFs. NWDAF Data Repository provides training
data to the ML model training function for the initial model training.
NOTE 2: The NWDAF data repository is addressed by the Key issue 11: Increasing
efficiency of data collection.
The ML model training function is also used to further update the trained ML
model. NWDAF Data Repository provides training data to the ML model training
function for the further update of trained ML model.
#### 6.6.1.4 Data analytics
The successful trained ML models are provided to the Analytics function with
the related analytics IDs, the Analytics Function can register the supported
analytics IDs to NRF. If any analytics request / subscribe is received from
the consumer, the Analytics function will collect the data from NWDAF Data
Repository or trigger the NWDAF Data Repository to collect data from other
entities, performs the data analytics according to the supported ML model and
exposure the output to the consumer.
NOTE 1: The Analytics request / subscribe procedure is initiated from consumer
to the Analytics function is already supported in Rel-16. The data collection
from NWDAF Data Repository is related to Key issue 11: Increasing efficiency
of data collection.
There are two options about how the Analytics function receives the provided
trained ML models.
Option 1: ML model provides via ML designer
Figure 6.6.1.2-1 proposed a NWDAF decompose architecture in which the ML
designer provides the trained ML model to Analytics Function(s).
Figure 6.6.1.4-1: ML model provides the trained ML model to Analytics
Function(s)
Step 1 and 2 in Figure 6.6.1.4-1 refer to the ML model training described in
clause 6.6.1.3. After the initial ML model training success, the ML Model
Training Function sends the trained model to the ML designer and the ML
designer provides the ML model with the corresponding Analytics ID to the
Analytics Function. ML designer may publish the trained model to different
Analytics Functions.
NOTE 2: How ML designer sends the trained ML model to Analytics functions is
to addressed by Key Issue #19: Trained data model sharing between multiple
NWDAF instances.
Option 2: ML model provides by ML Model training function
Step 1 and step 2 in Figure 6.6.1.4-2 refer to the initial ML model training
described in clause 6.6.1.3 (same as option 1). After ML model training
success, the ML Model training function provides the trained ML model and the
corresponding Analytics ID to Analytics function. The trained ML model may
provide the trained model to different Analytics functions.
NOTE 3: How ML Model training function sends the trained ML model to Analytics
functions is to addressed by Key Issue #19: Trained data model sharing between
multiple NWDAF instances.
Figure 6.6.1.4-2: ML Model training function provides ML model
### 6.6.2 Procedures
#### 6.6.2.1 Initial ML Model Training
Figure 6.6.2.1-1 is the call flow of Initial ML Model Training.
Figure 6.6.2.1-1: Initial ML Model Training call flow
0\. The initial ML model maybe received from ML Designer or based on local
configuration. This step is out of 3GPP scope.
1\. ML Model Training Function sends the Initial ML model training data
collection request (Analytics ID) to the NWDAF Data Repository. The Analytics
ID identify the Initial ML model.
2\. NWDAF Data Repository may trigger the data collection from other entities
and provides all the input data that related to the requested Analytics ID to
ML Model Training Function.
3\. ML Model Training Function performs the initial model training.
Step 1 and step 2 will be reused for further update the trained ML model.
#### 6.6.2.2 Analytics Function receives ML model procedure
For option 1 ML model training function sends the trained ML model to ML
designer, and ML designer provides the ML model to different Analytics
Functions. The interaction between ML Model training function and ML designer
and ML designer to Analytics Function are out of SA WG2 scope.
For option 2, a standard interface between ML Model Training Function and
Analytics Function are supported for ML model publish procedure.
The ML Model Training Function may provide the trained ML model to Analytics
Function(s) either by the request received from Analytics Function(s)
described in Figure 6.6.2.2-1 or operator configuration in ML Model Training
Function described in Figure 6.6.2.2-2.
Figure 6.6.2.2-1: ML Model request procedure
1\. Operator may configure the supported Analytics ID(s) for the Analytics
Function, the Analytics Function send the ML Model Request (Analytics ID)
message to ML Traninig Function to collect the trained ML Model.
2\. ML Model Training Function provides the trained ML model to Analytics
Function(s).
NOTE 1: The parameters in step 1 and 2 and are related to Key Issue #19:
Trained data model sharing between multiple NWDAF instances.
Figure 6.6.2.2-2: ML Model Notification procedure
1\. ML Model Training Function provides the trained ML model to Analytics
Function(s) based on the operator\'s configuration.
2\. The Analytics Function(s) send the ACK to ML Model training Function.
NOTE 2: The parameters in step 1 and are related to Key Issue #19: Trained
data model sharing between multiple NWDAF instances.
### 6.6.3 Impacts on services, entities and interfaces
NWDAF
\- NWDAF is decompose to ML Model Training Function and Analytics function.
\- For option 2
\- an interface between ML Model Training Function and Analytics Function is
supported.
\- the ML Model Training Function provides ML Model to Analytics Function via
the interface between ML Model Training Function and Analytics Function.
## 6.7 Solution #7: NWDAF functionality Split
### 6.7.1 Description
This solution addresses Key Issue #1: NWDAF functionality Split.
As shown in Figure 6.7.1-1, the 5GC could support data analytics as:
\- Training Function in NWDAF, could provide training services to 5GC NF(s).
\- Inference Function in NWDAF could invoke the training service provided by
Training Function in NWDAF, if needed.
{width="3.5625in" height="2.875in"}
Figure 6.7.1-1: NWDAF functionality Split
As shown in Figure 6.7.1-1, NWDAF is to support data analytics cross the 5GC
NFs, and AF, which are composed of the following functionalities:
1) Data collection;
2) Training function: refer to the process of creating a machine learning
model, which involves the use of a machine learning algorithm and a training
data set;
3) Inference function: refer to the process of using the trained machine
learning model to make predictions with new data and exposing network work
data analytics to the consumer NF.
As indicated in TS 23.288 [5], the NWDAF instance(s) can be collocated with a
5GS NF.
### 6.7.2 Procedures
Figure 6.7.2-1: Procedure for Inference Function in NWDAF request for Training
service provided by Training Function in NWDAF
1a-1b. Training service provided by Training function in NWDAF 1 or NWDAF 2
sends registration request by invoking Nnrf_NFManagement_NFRegister to
register its own service in the NRF, including some parameters, e.g. IP
address, location, load, algorithm information (Algorithm ID, supported
accuracy, supported convergence time).
2\. The data analytics for an Analytics ID in Inference Function in NWDAF 3 is
triggered by e.g. operator policies.
3\. Inference Function in NWDAF 3 invokes Nnrf_NFDiscovery_Request service
operation using parameters such as algorithm information (Algorithm ID,
supported accuracy, supported convergence time).
4\. NRF matches the requested query and sends this information via
Nnrf_NFDiscovery_Request response service to Inference Function in NWDAF 3
including one or more Training services provided by the Training Function in
NWDAF 1 or NWDAF 2.
5\. Inference Function in NWDAF 3 selects Training Function in NWDAF 1 based
on the output of NRF.
6\. Inference Function in NWDAF 3 sends request including some parameters,
e.g. Analytics ID for a machine learning model to invoke the Training service
provided by the Training Function in NWDAF 1 for machine learning model
generation.
7\. Training Function in NWDAF 1 performs data collection and machine learning
model training.
8\. Inference Function in NWDAF 3 receives the response from the Training
Function in NWDAF 1including machine learning model response and some
parameters, e.g. machine learning model identification, input parameter and
output parameter.
NOTE 1: The services and parameters used in step 6 and 8 are related to Key
Issue #19: Trained data model sharing between multiple NWDAF instances.
9\. Inference Function in NWDAF 3 completes the machine learning model
deployment. In this step, the Inference Function in NWDAF 3 is prepared to use
the received trained model to perform inference.
10\. Infernce Function in NWDAF 3 registers the Analytics ID and address to
NRF by using the current NF service registration mechanism as defined in
clause 4.17.1, TS 23.502 [3].
11\. Consumer NF discovers the Inference Function in NWDAF 3 by using the
current NWDAF discovery and selection mechanism as defined in clause 6.3.13,
TS 23.501 [2].
12a. The Consumer NF invokes the Nnwdaf_AnalyticsSubscripion_Subscribe or
Nnwdaf_AnalyticsInfo_Request service provided by Inference Function in NWDAF 3
for analytics.
12b. Inference Function in NWDAF 3 sends analytics response to the requested
NF.
### 6.7.3 Impacts on services, entities and interfaces
NWDAF is decomposed into Training Function in NWDAF and Inference Function in
NWDAF.
Training Function in NWDAF:
\- Support to register its NF profile (IP address, location, load, algorithm
information (Algorithm ID, supported accuracy, supported convergence time))
into the NRF;
\- Support to provision a machine learning model to Inference Function in
NWDAF.
Inference Function in NWDAF:
\- Support to discover a suitable Training Function in NWDAF via NRF;
\- Support to request a machine learning model from the Training Function in
NWDAF.
NRF:
\- Support to accept the NF registration from Training Function in NWDAF;
## 6.8 Solution #8: NWDAF decomposition
### 6.8.1 Description
This solution addresses Key Issue #1 \"Logical decomposition of NWDAF and
possible interactions between logical functions\".
When considering why and how to split the NWDAF functionality as defined in TS
23.501 [2], principles should be followed as suggested by key issues
envisioned in the present document, including:
\- to support enhanced data collection and/or analytics generation in multiple
NWDAFs scenarios, as described in Key Issue#2;
\- to improve efficiency of data collection from NFs and AFs, as required by
Key Issue #11;
\- to enable trained data model sharing between multiple NWDAF instances, as
suggested by Key Issue #19.
Based on the principles, a possible decomposition of the NWDAF is proposed
with the following sub-functions:
\- DC (Data Collection): Collects data from the NFs for analytics. DC can be a
standalone NF or collocated with different NFs to enable a centralized or
distributed data collection, as proposed in solutions to Key Issue #11 and/or
Key Issue #2.
\- MT (Model Training): Trains a model for analytics with the collected data,
which may also include e.g. pre-processing of the collected data. MT can share
trained models with other NWDAFs to enable and improve analytics, as proposed
in solutions to Key Issue #19. MT uses data provided by the DC to train the
model.
\- AC (Analytics Control): controls and performs analytics, including:
\- receiving the analytics request from the consumer NF;
\- using the model provided by the MT and data provided by the DC for
analytics;
\- providing analytics information to the consumer NF;
\- performing NWDAF service registration and metadata exposure to NFs/AFs.
The sub-functions of the NWDAF support service-based interactions, as shown in
Figure 6.8.1-1.
Figure 6.8.1-1: NWDAF composition
The sub-function(s) of the NWDAF can be standalone NF(s), e.g. DC as a
standalone NF may improve the efficiency of data collection. Some or all of
the sub-functions of the NWDAF can be collocated.
NOTE: Whether the subfunction, i.e. AC, DC or MT, of the NWDAF can be a
separate NF depends on the conclusions on the solutions for KI#2, #11 and #19.
### 6.8.2 Input Data
Void.
### 6.8.3 Output Analytics
Void.
### 6.8.4 Procedures
Figure 6.8.4-1 shows an example procedure for analytics information provision
with NWDAF decomposition, where service-based interfaces are used to show the
interactions between the sub-functions of NWDAF.
NOTE: Service-based interfaces are used between the sub-functions of NWDAF if
they are defined as separate NFs. When the sub-functions of NWDAF are
collocated and not defined as separate NFs, the internal interfaces between
these sub-functions can be service-based or not, which is implementation
dependent.
Figure 6.8.4-1: Procedure for analytics information provision with NWDAF
decomposition
1\. Consumer NF sends an analytics request/subscription to the NWDAF by
invoking an Nnwdaf_AnalyticsInfo_Request or an
Nnwdaf_AnalyticsSubscription_Subscribe, as specified in TS 23.288 [5].
2\. Based on the analytics request/subscription, the AC of the NWDAF sends an
Ndc_DataCollection_Subscribe to the DC, with information for data collection.
NOTE 1: The details of the information for data collection depend on the
solution to Key Issue #11 \"Increasing efficiency of data collection\".
3-4. The DC subscribes to the network data from the NF(s) or the OAM as
specified in TS 23.288 [5].
5\. The DC provides the collected data to the AC.
6\. The AC sends an Nmt_AnalyticsModel_Request to the MT, which includes the
Analytics ID and other information (e.g. analytics filter information) to
request the trained model for the analytics.
NOTE 2: Step 2 and 6 can be performed in parallel.
7-8. If data is needed for training the model, the MT sends an
Ndc_DataCollection_Subscribe to the DC to request data for model training.
NOTE 3: The MT can be a standalone NF or in a different NWDAF. The details of
the interaction between the AC and the MT depend on the solution to Key Issue
#19 \"Trained data model sharing between multiple NWDAF instances\".
9\. The MT sends an Nmt_AnalyticsModel_Request response to the AC, including
the parameters of the trained model for analytics.
10\. With the trained model and the collected data, the AC produces the
analytics information. The AC of the NWDAF provides the analytics information
to the consumer NF by means of either Nnwdaf_AnalyticsInfo_Request response or
Nnwdaf_AnalyticsSubscription_Notify, as specified in TS 23.288 [5].
### 6.8.5 Impacts on services, entities and interfaces
NWDAF:
\- Decomposed into AC (Analytics Control), DC (Data Collection) and MT (Model
Training) subfunctions.
\- Request/provide the trained model from/to the other NWDAF.
\- Request/provide the collected data from/to the other NWDAF.
## 6.9 Solution #9: Data Management Framework for 5GC
### 6.9.1 Introduction
This Solution addresses aspects of KI #1, KI#2 and KI#11 dealing with
Data/Information Management and logical NWDAF decomposition.
It proposes a decomposition of the NWDAF so a Data Management Framework for
5GC is separated from Analytics functions (KI#1). The Data Management
Framework for 5GC uses the Consumer/Producer model of the 5GS services-based
architecture to efficiently exchange data/information of different types. This
includes:
\- Data retrieved from various sources (e.g. OA&M, and NFs such as AMF, SMF,
PCF and AF), to be used as a basis for computing analytics as per Rel-16,
NWDAF Analytics (KI#11)
\- Analytics output from an NWDAF Producer sent to an NWDAF Consumer (KI#2) to
support a hierarchy of NWDAF instances or sent to multiple network functions.
NOTE: In the above, an NWDAF Producer provides Analytics to a Consumer (e.g.
using the Services defined in TS 23.288 [5] clause 7). An NWDAF Consumer is an
NWDAF that Consumes the Analytics of another NWDAF (e.g.: using the services
of the NWDAF Producer).
### 6.9.2 Functional Description
#### 6.9.2.1 General
The Data Management Framework for 5GC is shown in Figure 6.9.2-1. It is
backwards compatible with a Rel. 16 NWDAF. Specifically:
a No change is proposed to the Rel-16 Nnwdaf services defined in TS 23.288 [5]
clause 7. These are the services offered by an NWDAF to a Consumer of NWDAF
analytics
b No change is proposed to the Rel-16 NF Services consumed to obtain Data.
These are the services offered by NFs (e.g. AMF, SMF, PCF, UDM, etc.), mostly
in the form of Event Exposure as described in TS 23.288 [5] Table 6.2.2.1-1.
Hence the solution is backwards compatible with Rel-16 NFs that provide Data.
c For Rel-17, the baseline for services offered by the DCCF (e.g. to an NWDAF
Analytics Function) are the Rel-16 NF Services used to obtain Data. For
example, the baseline for the DCCF service used by an NWDAF consumer to obtain
UE mobility data would be Namf_EventExposure.
A Rel-16 NWDAF can coexist with a Rel-17 NWDAF and the Data Management
Framework. The Rel-16 NWDAF continues to request Data directly from NFs
without using the Data Management Framework and provides analytics to
consumers that discover the Rel-16 NWDAF. The Rel-17 NWDAF would request Data
from the Data Management Framework, and if the data is not collected already,
the Data Management Framework would request the data from a data source. In
other words, a Data Source would independently send Data to the Rel-16 NWDAF
that sent a request directly to the Data Source, and to the Data Management
Framework that sent a request for the Rel-17 NWDAF(s).
The NWDAF is decomposed by moving Data Collection, including the task of
identifying the Data Source, to the Data Management Framework. The Rel-17
NWDAF requests data from the Data Management Framework but may not query the
NRF/BSF/UDM to determine which NF instance serves a UE, nor need it be
concerned about the life-cycles of Data Source NFs, as was the case in Rel-16.
This decomposition also allows other NFs to obtain data via the Data
Management Framework and avoids duplicate data collection from the same Data
Source. The Rel-17 NWDAF (without Data Collection) may be referred to as the
\"NWDAF Analytics Function.\"
NOTE: This solution does not preclude additional decomposition of the NWDAF,
for example to separate Analytics and ML training functions as has been
proposed in other Solutions.
The Framework consists of the following components:
1 Data Collection Coordination Function (DCCF).
2 with optional DCCF Adaptor (DA)
3 Messaging Framework (for Data Forwarding and Replication),
4\. with optional Adaptors (3CA and 3PA) to isolate the Messaging Framework
protocol from the Data Source and the Data Consumer.
The interfaces subject to 3GPP standardization are NF consumer-DCCF, DCCF-NF
producer, DCCF-DA, NF consumer 3CA and NF producer-3PA. It is expected that
3PA can re-use existing interfaces and services.
Figure 6.9.2.1-1: Data Management Framework for 5GC
NOTE 1: When Data Source is OA&M, OA&M services, as defined by SA WG5, are
reused.
NOTE 2: The 3PA may alternatively be standalone or combined with the Data
Source. A 3PA is not needed if the Data Source natively supports the message
bus protocol.
NOTE 3: The 3CA may alternatively be standalone or combined with the Data
Consumer. A 3CA is not needed if the Data Consumer natively supports the
message bus protocol.
NOTE 4: The DA may alternatively be standalone or combined with the DCCF. A DA
is not needed if the DCCF natively supports the message bus protocol.
NOTE 5: The intended Consumer of Data Management Framework services is an
NWDAF Analytics Function or an NF requesting analytics, but as with other NF
services, nothing precludes other Consumers (NFs) from using it.
NOTE 6: NWDAFs co-located with NFs can also be consumers of Data Management
Framework services, thus avoiding duplicate data collection from the NFs, e.g.
by co-located NWDAF and other NWDAFs.
NOTE 7: Adaptors (3CA, 3PA and DA) are not expected to be standardized by
3GPP, only the interface between 3GPP entities and the adaptors is under 3GPP
scope.
#### 6.9.2.2 Data Collection Coordination Function (DCCF)
The DCCF is a control-plane function that coordinates data collection and
triggers data delivery to Data Consumers. A DCCF may support multiple Data
Sources, Data Consumers, and Message Frameworks. However, to prevent duplicate
data collection, each Data Source is associated with only one DCCF.
The DCCF provides the 3GPP defined Ndccf_DataExposure Service to Data
Consumers (e.g.: NWDAF), and uses the services of Data Sources (e.g.: 3GPP NF)
to obtain data. Figure 6.9.2.1-1 shows one DCCF for the 5GC. There can be
multiple instances of the DCCF, e.g. for network slices, geographic regions
where Data Sources reside or for different Data Source types. A DCCF needed by
a Consumer can be discovered using the NRF as described below.
NOTE 1: the DCCF is aware of the Data Sources it is coordinating. The NRF and
UDM can provide the DCCF with the identity of 5GC Data Sources (e.g.: an AMF
serving a UE). The DCCF also hides Data Source life cycle events and changes
of entity serving a UE from the Data Consumer. For example, if an NF Data
Source that serves a UE changes because of a life-cycle event, the NRF may
notify a DCCF that has previously subscribed to NRF event notifications. The
DCCF may also use the UDM to learn the new (UE, NF) association, thus making
the change of the NF serving an UE transparent to the Data Consumer.
NOTE 2: In this release, if there is more than one DCCF, they should
coordinate the collection and distribution of data for orthogonal sets of Data
Sources. In this case a Data Consumer discovers the DCCF for the data it
needs, and the DCCF and the Message Framework delivers the data from the
proscribed set of Data Sources. If a DCCF cannot serve a request from a Data
Consumer it may query the NRF to determine an acceptable DCCF and redirect the
query accordingly.
NOTE 3: DCCF is not intended to support aggregation of analytics data across
multiple NWDAFs. However, the DCCF keeps track of Consumer Requests to the
NWDAF \"Data Source\", and hence knows what analytics are being produced by an
NWDAF. Therefore, the Data Management Framework can be used by a Consumer
(which could be an NWDAF) that consumes (e.g. aggregates) analytics data from
one or more NWDAF acting as a \"Data Source\" or from the Data Repository. The
NWDAF acting as \"Data Source\" supplies Analytics output as \"Data\", using
the services defined in TS 23.288 [5] clause 7 (subscribe/notify), similar to
any other NF.
The DCCF:
\- Receives data requests from Data Consumers via the Ndccf_DataExposure
service. A Data Consumer may be a NWDAF Analytics function (Rel-17 NWDAF) and
the contents of the service requests are based on Rel-16 services (e.g. AMF or
SMF event exposure). The DCCF service may provide additional functionality,
for example to allow one request that requires multiple Data Sources (e.g. AMF
and SMF), and allow formatting and processing of notifications according to
conditions specified by the consumer as described in the bullet list below.
\- If the Data Source is not specified in the Data Request, the DCCF
determines the Data Source that can provide the data requested by the Data
Consumer (e.g. an event requested by the Data Consumer for NF event exposure).
For example, if the request is for UE specific data, the DCCF may query the
NRF/UDM/BSF to determine which NF instance is serving the UE, as described in
TS 23.288 [5] Table 6.2.2.1-2: _NF Services consumed by NWDAF to determine
which NF instances are serving a UE_.
\- If the Data Source is specified in the Data Request (e.g. the data consumer
is configured with the data sources), the DCCF checks whether the Data is
already collected from the Data Source. If not, it will request the Data to
the specified Data Source.
\- The DCCF checks if the Data Consumer is authorized to access DCCF services
using the procedures specified in TS 23.501 [2] clause 7.1.4 \"Network
Function Service Authorization\".
NOTE 1: Additional authorization for Consumers to access data from a Data
Source via the DCCF may be considered by SA WG3.
\- Determine if the requested data is currently being produced by any Data
Source and sent to the Messaging Framework. If the requested data is not being
produced, a new subscription/request is sent towards the Data Source to
trigger a new data collection and the DCCF then subscribe with the messaging
framework for the Consumer to receive future notifications. Similarly, when
the last Data Consumer of a specific data does no longer wants data, the DCCF
cancels data collection from the Data Source and from the messaging framework.
This ensures that the Data Source is only producing the same data once when
there are multiple Data Consumers and is not producing data that no Data
Consumer needs.
The DCCF determines if data is already being collected by maintaining a record
of the prior requests it has made for data (e.g.: via an Nnf_EventExposure
service offered by the Data Source). If parameters in a prior request for data
match those that are needed in a subsequent request, the DCCF may determine
that the requested data is already being collected. The DCCF may then
subscribe with the messaging framework for the new Consumer to receive future
notifications.
Formatting conditions and Processing instructions requested by Data Consumers
via the Ndccf_DataExposure service may be passed to the Messaging Framework
via the Nda_Data_Management Service. The 3CA may then accordingly send
notifications to the consumer. Formatting conditions determine when a
notification is sent to the Consumer. For example formatting may include:
\- Notification Event clubbing (buffering and sending of several notifications
in one message).
\- A Notification Time Window (e.g.: notifications are buffered and sent
between 2 and 3 AM).
\- Cross event reference-based notification (when a subscribing NF is
subscribing to multiple events (e.g.: event X and event Y) the notification
for an Event-X is buffered and reported only when the Event-Y occurs).
\- Consumer triggered Notification.
\- Exact time-based Notification without the event (Data is reported at an
exact time, irrespective of event occurs or not. Example: every 30 min).
\- Mathematical calculation based notification (e.g.: Exponential time window:
The first notification is sent after 5 min. The next notification is sent
after 10 min, and the third is after 15 min etc.).
NOTE 2: The extent of formatting variations to be supported can be decided in
the normative phase.
> Processing instructions allow summarizing of notifications at 3CA to reduce
> the volume of data reported from the 3CA to the Data Consumer. This is
> particularly useful when data from a Data Repository (historical data) is
> requested that comprises a large number of notifications. The type of
> processing is specified by the consumer and may result in joining the
> information from multiple notifications into a common report.
When the DCCF receives a request for historical data (e.g. an NWDAF requesting
analytics previously generated by another NWDAF), the DCCF may trigger
retrieval of the data from the Data Repository and make it available over the
messaging framework.
\- Manages subscription requests and cancellations to the Messaging Framework
on behalf of Data Consumers. The DCCF may use a native Messaging Framework
protocol or alternatively a 3GPP defined protocol with an adaptor that
translates to the Messaging Framework protocol (as depicted in the Figure
6.9.2-1).
\- If standalone 3PAs and 3CAs are used, the DCCF maintains the (NF, 3PA) and
(NF, 3CA) associations.
For DCCF discovery, the DCCF registers with the NRF and is discovered by
Consumers or the SCP using the registration and discovery procedures defined
for the Network Function Service Framework in TS 23.502 [3], clause 4.17. The
DCCF profile in the NRF may specify:
1- The slices (S-NSSAIs) that the DCCF Supports.
2- The Source Types that a DCCF coordinates.
3- The serving area (e.g. list of TAIs) containing Data Sources that the DCCF
coordinates.
Source Type may correspond to an NF Type (e.g.: SMF, AMF, etc.), or different
domains (e.g.: OA&M). Hence a Consumer or SCP may request or select a DCCF
according to the type of information it is requesting, the network slices it
supports and its serving area.
NOTE 3: Additional DCCF Profile parameters can be considered during the
normative stage.
#### 6.9.2.3 Messaging Framework
The Messaging Framework is not expected to be standardized by 3GPP. It
contains Messaging Infrastructure that propagates event information and data
(e.g.: streaming and notifications) from Data Sources to Data Consumers. The
Messaging Framework may support the pub-sub pattern, where data is published
by producer adaptors (or data source if the data source natively supports the
message bus protocol) and can be subscribed to by consumer adaptor (or data
consumers if the data consumer natively supports the message bus protocol).
The Messaging Framework may support multiple event delivery mechanisms such as
best effort or guaranteed delivery. For 3GPP purposes guaranteed delivery of
events may be utilized.
The Messaging Framework may contain one or more Adaptors that translate
between 3GPP defined protocols (e.g.: Rel-16
Nnwdaf_AnalyticsSubscription_Notify) and a Data Forwarding Protocol not
specified by 3GPP. The Messaging Framework adaptors maintain subscription
information, including formatting conditions and processing instructions
received by the DA.
The Adaptor on the Producer side (3PA) allows any Source Data (e.g. from
Rel-16 OA&M or NF EventExposure) to be distributed via the framework without
impact on the Data Source. The DCCF keeps track on the Adaptor instances. An
Adaptor may be associated with specific NF types, manage one or more data
Sources, and may be provisioned on the DCCF together with the sources it
support. If the Messaging Framework directly supports 3GPP interfaces,
Adaptors may not be required.
#### 6.9.2.4 Data Repository
The Data Management Framework is compatible with both a 3GPP defined Data
Repository Function for ML/Analytics and Data Repositories that are not
defined by 3GPP.
\- If 3GPP defines a Data Repository Function for ML/Analytics, then to obtain
data to store in the Data Repository, the Repository acts as a Data Consumer,
and to retrieve data from the Data Repository Function, the Repository acts as
a Data Source as depicted in Figure 6.9.2-1. In both cases 3GPP services are
used.
\- If the Data Repository is not standardized by 3GPP, then it interacts as a
Data Consumer or Data Source using services not defined by 3GPP (e.g. services
native to the Messaging Framework) as depicted in Figure 6.9.2.4-1 and Figure
6.9.2.4-2 and further described below.
NOTE 1: Non-standardized means of storing and retrieving the data are not
precluded (i.e. Data Repository that is not standardized by 3GPP). How NF(s)
interact with the non-standardized Data Repository is out of scope of 3GPP and
is up to implementation(s) not defined in this standard.
Figure 6.9.2.4-1 depicts a Data Repository appearing as a Data Consumer. The
DCCF can manage requests and cancellations for the Data Repository in the same
manner as it does for any Data Consumer. The DCCF may base its request to
provide Data to the Data Repository on:
\- A request from another Data Consumer (e.g. a NF) where the request
indicates that the data should be stored in the Data Repository. For example,
3PA can manage the routing (via the framework) of consumer\'s request to the
data repository.
\- A request from the Data Repository (acting as a Consumer) for data
NOTE 2: Data Repository can request data to e.g. allow some pre-collection of
data which can be used later on for analytics, based on network configuration.
\- Provisioned information of data to be archived in the Data Repository (e.g.
all AMF data requested by Data Consumers).
Authorization of a Data Repository acting as a Consumer is the same as that
described for other Data Consumer authorization (see DCCF description above).
NOTE 3: Additional authorization for Consumers to access data from a Data
Source via the DCCF may be considered by SA WG3.
Figure 6.9.2.4-1: Data Repository as a Consumer
The Data Repository also acts as a Data Source for historical data that has
been stored, as depicted in Figure 6.9.2.4-2. The Data Consumer may interact
directly with the Data Repository (e.g. for operations that require access to
large volumes of data in a Data Repository), or via the Messaging Framework as
depicted in the figure. In case of Communication directly between the Data
Consumers and the Data Repository the messaging framework may forward links to
the data to the data consumers. When the Messaging Framework is used, the DCCF
coordinates requests for persistent data, treating the Data Repository like
any other Data Source. The Data Repository, upon receiving a request for data,
supplies it to the Messaging Framework. For Data Repositories not standardized
by 3GPP, the interactions between the Messaging Framework and the Data
Repository acting as a Data Source are outside the scope of 3GPP. For Data
Repositories standardized by 3GPP, an adaptor (RA, Repository Adaptor) may be
used between the Messaging Framework and the Data Repository, e.g. similar to
the DCCF adaptor.
Figure 6.9.2.4-2: Data Repository as a Data Source
### 6.9.3 Procedures for consumers and producers using 3CA and 3PA
An example procedure is given in Figures 6.9.3-1 for Data Collection &
Distribution for Event Notifications (Subscribe/Notify). The procedure
illustrates how the DCCF manages Data Sources so data are produced only once
and how the DCCF interacts with the messaging framework so data are
distributed to all subscribed Data Consumers. The procedure applies for
consumers and producers using 3CA and 3PA, i.e. all steps are within 3GPP
remit.
Data handled by the messaging framework is associated with an identifier. The
example procedure in figure 6.9.3-1 assumes that the Messaging Framework uses
a Pub/Sub model based on \"Data Tags\" (which could for example be a \"Topic\"
in some message framework protocols). The 3PA can publishes to a \"Data Tag\"
and a 3CA that wishes to receive the data subscribes to the \"Data Tag\".
Other options can also be supported.
Figure 6.9.3-1: Data Collection & Distribution for Event Notifications
(Subscribe/Notify)
1\. Data Consumer-1 (e.g.: NWDAF-1) sends a request for data to the DCCF. The
message includes the Notification Target Address. The message may indicate
whether the requested data should be sent to the Notification Target Address
set to Data Consumer-1 and/or to other Consumers such as Data Repository. The
Notification Correlation ID of the Consumer-1 is included in the request
message and is used for notifications sent to Data Consumer-1 (e.g. in step
8).
2\. If the request is for UE data, the DCCF may query the UDM/NRF/BSF to
determine the NF serving the UE.
3\. The DCCF determines the Data Source (e.g. AMF-1) that can provide the data
and checks that the requested data is not already being collected.
4\. The DCCF controls the message bus and the adaptors so the notifications
traverse the messaging framework. The subscription to the DA includes a
Notification Correlation ID of the 3PA and the Notification Correlation ID for
Data Consumer-1 as received in step 1. The DA may associate these with a
messaging framework. The 3PA is provided with its Notification Correlation ID
and the \"Data Tag\". The 3CA will be provided with the consumer\'s
notification endpoint, the Notification_Correlation_ID of the Consumer and the
\"Data Tag\". The 3CA may then subscribe to the \"Data Tag\" in the messaging
framework.
5\. The DCCF sends a subscription request to a NF producer acting as a data
source. The subscription includes the notification endpoint and Notification
Correlation ID of the 3PA that is acting as the receiver for these
notifications.
6\. The Data Source acknowledges the request
7\. A Notification containing the Notification Correlation ID of the 3PA is
sent to the 3PA after an event trigger at the Data Source. The 3PA publishes
the data in the message framework. It may use \"Data Tag\" the associated with
the Notification Correlation ID of the 3PA received in step 4.
8\. When the data is published to the \"Data Tag\", the Messaging Framework
makes it available to all subscribed 3CA. In this case the only subscriber is
a 3CA serving consumer-1. This 3CA maps the \"Data Tag\" to the Notification
Correlation ID of the Data Consumer received in Step 4 (which was originally
provided by Data Consumer-1) and sends the notification to the notification
endpoint of Data Consumer-1.
9\. Data Consumer-2 (e.g.: NWDAF-2) sends a request for the same Data. The
message may indicate whether the requested data should be sent to Data
Consumer-2, and/or to other Consumers such as Data Repository. The
Notification Correlation ID of Consumer-2 is included for notifications sent
to Data Consumer-2.
10\. The DCCF determines that the requested data is already being collected
from a Data Source (e.g.: AMF-1) and retrieves 3PA ID and the Notification
Correlation ID of the 3PA.
11\. The DCCF sends a subscription request to the Messaging Framework
indicating that there is a new subscriber of the data. The subscribe message
to the DA provides the 3PA ID, the 3PA Notification Correlation ID currently
in use, and the Notification Correlation ID for Data Consumer-2 as received in
step 9. The DA selects the existing \"Data Tag\" corresponding to the 3PA
information and sends the 3CA Consumer-2\'s notification endpoint, the
Notification_Correlation_ID of Consumer-2 and the \"Data Tag\". The 3CA may
then subscribe to the \"Data Tag\" in the messaging framework.
NOTE: The 3CA for Consumer-2 may be different or the same from 3CA for
Consumer-1.
12\. After an event is triggered in the data source, a Notification is sent to
the 3PA and 3PA publishes the data to the corresponding \"Data Tag\"on the
Messaging Framework.
13-14. When the data is published to the \"Data Tag\" the Messaging Framework
makes it available to the subscribed 3CAs. In this case the 3CAs serving
consumer-1 and consumer-2 receive the data and send the notifications to the
notification endpoints of Data Consumer-1 and Data Consumer-2 using the
Notification Correlation ID of Consumer-1 and Consumer-2, respectively. A Data
Repository also receives notifications if it has subscribed via the DCCF.
### 6.9.4 Impacts on services, entities and interfaces
The following new entities are to be standardized
\- DCCF
The following new services interfaces are to be standardized
\- Ndccf_DataExposure Service:
This service enables a Data Consumer to request data. The baseline for this
service is the Rel-16 NF Services used to obtain Data from NFs. For example,
the baseline for the DCCF service used by a Data Consumer to obtain UE
mobility data would be Namf_EventExposure. The responses providing data are
routed via the messaging framework and 3CA. Ndccf_DataExposure must allow the
Data Consumer to:
1\. Identify the data being requested and identify either the NF instance that
may provide the data, an area of interest, or a UE-IDs that the DCCF can use
to discover a serving NF.
2\. Provide formatting conditions and processing instructions that the DCCF
can pass to the 3CA in an Nda_Data_Management request.
Proposed Ndccf_DataExposure Service Operations are:
**Ndccf_DataExposure_Subscribe/Request (Nxxx_Service, NF-ID, UE-ID,
Notification Target Address (+ Notification Correlation ID), Data
Specification, Formatting Conditions, Processing Instructions, Start_Time)**
\- used by the Data Consumer to request data. This service operation may be
used to create a subscription for a new Data Consumer or to modify a
subscription for an existing Data Consumer.
**\- Nxxx_Service -** NF Type and Service that may supply the data (if known
to the Data Consumer)**.**
**\- NF-ID -** ID of the NF (if known to the Data Consumer).
**\- UE ID -** ID of the UE for which data is requested (if applicable).
**\- Notification Target Address (+ Notification Correlation ID).**
**\- Data Specification** \- requested data, which may include event ID and
other parameters specified in Rel. 16 NWDAF data requests.
**\- Formatting** **Conditions** \- as defined for
Nda_Data_Management_Subscribe().
**\- Processing Instructions** \- as defined for
Nda_Data_Management_Subscribe().
**\- Start_Time -** defines the time period when data reporting should start.
NOTE 1: More than one instance of the above parameters may be specified to
allow the Data Consumer to combine multiple data requests in a single message.
NOTE 2: \"Expiry Time\", the time when a subscription is desired to end, is
already an Exposure Service Parameter (TS 23.501 [2] clause 4.15.1). If a
portion of the interval between Start_Time and Expiry Time is in the past,
historical data is requested from a Data Repository. If a portion of the
interval between Start_Time and Expiry Time is in the future, data is
requested from the Data Source. In both cases the data may be sent to the Data
Consumer via the messaging framework.
**\- Ndccf_DataExposure_Unsubscribe (Subscription Correlation ID)** \- used by
the Data Consumer when data is no longer wanted.
**\- Subscription Correlation ID** \- the Correlation ID Provided by the DCCF
when data was requested.
NOTE 3: Additional parameters for these service operations may be considered
during the normative stage.
**\- Nda_Data_Management Service:**
A new service is required for a DCCF to interact with the Messaging Framework
DCCF Adaptor. This service enables a DCCF to request that the Messaging
Framework provide data to a Consumer. Nda_Data_Management service must allow:
1 the 3PA to recognize notifications from a Data Source and to deliver them to
the Messaging Framework.
2 the 3CA to obtain data from the Messaging Framework and send notifications
to the Data Consumer.
Proposed Nda_Data_Management Service Operations are:
**Nda_Data_Management_Subscribe (Nxxx_Service, Nda_Parameters, Formatting
Conditions, Processing Instructions)** \- used when data needs to be sent from
the 3CA to a Data Consumer. This service operation may be used for a
subscription for a new Data Consumer or to modify a subscription for an
existing Data Consumer.
**\- Nxxx_Service -** Identifies the service that will be delivering
notifications to the 3PA (e.g. Namf_EventExposure).
**\- Nda_Parameters** \- Parameters that identify Event Notification from the
Data Source including the 3PA Notification Target Address and 3PA Notification
Correlation ID, and parameters that identify the Consumer including
Notification Target Address and Notification Correlation ID used by the Data
Consumer when it sent a request for notifications to the DCCF
**\- Formatting Conditions -** Consumer requested Notification formatting is
used by the 3CA to format notifications. Formatting conditions may include
event clubbing, a notification time window, periodic notifications (with or
without an event) or consumer triggered notification (aka Notification
Suppression).
**\- Processing Instructions** \- Consumer requested Notification processing
to reduce the volume of data reported. This may be used by the 3CA to condense
multiple notifications into a single notification.
**Nda_Data_Management_Unsubscribe (Subscription Correlation ID)** \- used when
data is no longer to be sent to a Data Consumer from the 3CA.
**\- Subscription Correlation ID** \- the Correlation ID Provided by the DCCF
when data was requested.
NOTE 4: Additional parameters for these service operations may be considered
during the normative stage.
**\- N3ca_EventExposure Service:**
This service enables the 3CA to send data to the Data Consumer as specified by
a DCCF using the **Nda_Data_Management** service.
Proposed Service Operations are:
**N3ca_EventExposure_Notify (Notification Correlation ID, Notification)** \-
used by the 3CA to send data to a Data Consumer.
**\- Notification Correlation ID -** The notification correlation ID supplied
by the Data Consumer when it requested data using the Ndccf_DataExposure
service.
**\- Notification** \- The notification supplied by the 3PA through the
messaging framework as formatted and processed by the 3CA.
3PA impacts:
The 3PA is the notification target specified by the DCCF when the DCCF
subscribes to notifications from a Data Source. The 3PA does not offer any
services. Notifications it receives from a Data Source are sent to the
messaging framework according to instructions the 3PA received from the DA.
NOTE 5: Interfaces between the 3PA, DA and 3CA are not standardized by 3GPP.
NRF impacts:
\- New NF and parameters in NF profile.
\- New discovery parameters.
Data repository service:
\- In the case of 3GPP defined Data Repository, a new service is needed for
the Data repository for the consumer. This service can be used via the
Messaging Framework, i.e., via an adaptor.
A Consumer that uses the Data Management Framework sends requests to the DCCF
rather than a Producer (as is the case in Release 16). Data notifications from
data sources go through 3PA, Messaging framework and 3CA.
Different formatting conditions and processing instructions requested by
Consumer to DCCF (see clause 6.9.2.2).
## 6.10 Solution #10: Handling of mixed and distributed NWDAF deployments
### 6.10.1 High-level Description
This is a solution for Key Issue #2, Multiple NWDAF instances, and Key Issue
#11: Increasing efficiency of data collection.
Key Issue #2: Multiple NWDAF instances says that multiple NWDAFs may be
deployed in a PLMN.
For mixed deployment, when multiple NWDAFs are deployed in a network it is
beneficial if the analytics performed in one distributed NWDAF can be shared
with a central NWDAF, so that the latter is relieved from collecting data and
computing analytic reports computed by the former. An example is when an NWDAF
performs the analytics for specific Analytics IDs for the UEs in a serving
area that can be consumed by an NWDAF performing either the same Analytics on
slice level or used to create new insights. Since there are even more
consumers of analytics (e.g. PCF) than a central NWDAF, the consumer of
analytics is hereby referred to as the NWDAF service consumer.
In order to allow the NWDAF service consumer to discover the NWDAF serving a
UE, the NWDAF serving the UE is registering it in UDM, using the
Nudm_UECM_Registration service operation (utilizing the Subscriber data set),
and then NWDAF service consumers can use UDM to discover it and then request
Analytics using the Nudm_UECM_Get service operation.
For PCF, since it is not using UDM services, a solution utilizing existing
messages extending it with data indicating the NWDAF instance, which is
currently serving the UE, is introduced.
For Key Issue #11: Increasing efficiency of data collection it is important to
reduce signalling load for data collection and achieve communication
efficiencies in large networks consisting of many NF instances and NWDAF
instances.
In a mixed deployment, a distributed NWDAF may collect data close to the data
source to reduce signalling over large distances to either perform analytics
for local use or to perform Analytics for a central NWDAF service consumer to
achieve communication efficiency. To circumvent large amount of storage far
out in the network, a distributed NWDAF may not store statistics for a long
time period for each UE it has served. It may purge the data and statistics
shortly after a UE is no longer served by the distributed NWDAF. If statistics
for a UE is needed an NWDAF service consumer, such as a central NWDAF, may
subscribe to statistics to or request statistics from the distributed NWDAF.
In this way statistics can be reused by the NWDAF service consumer over longer
time periods. The NWDAF service consumer may not make use of the statistics
immediately, but rather collects it for later use.
A NWDAF service consumer can subscribe to or request statistics from a
distributed NWDAF. To allow for an NWDAF service consumer to collect
statistics over a long time period for later use, it is proposed to extend the
usage of the \"Time when analytics information is needed\" to NWDAF Analytics
subscription (currently, TS 23.288 [5] specifies the \"Time when analytics
information is needed\" only for one-time requests). If this parameter is set
for an Analytics subscription it gives the flexibility for the distributed
NWDAF to send statistics when feasible, which may be when signalling in the
network is low (usually during night) or at least before the UE is purged from
the distributed NWDAF.
NOTE: An NWDAF is found via NRF and the consumer uses the associated Serving
Area information and other parameters present in the NF profile to select it.
If there exists multiple NWDAFs that has the same or overlapping Serving Area,
the locality, load, capacity, or similar parameter in the NFProfile (described
in TS 29.510 [11] clause 6.2.6.2.3) is preferably used.
### 6.10.2 Procedures
#### 6.10.2.1 Registration/Deregistration of the NWDAF serving the UE
procedure
In this solution, distributed NWDAFs register with NRF. The NF utilize the NRF
to discover the NWDAF unless NWDAF information is available by other means,
e.g. locally configured in the NF. In addition to the regular registration,
the distributed NWDAFs serving particular UEs for UE related Analytics
register with UDM. This registration in UDM includes the UE ID it is serving,
NWDAFs FQDN or IP address, NWDAF instance ID, and the Analytics IDs it is able
to produce for such UE. This registration may take place at the time the NWDAF
receives a subscription or request to provide Analytics on UE Analytics for a
target SUPI.
Below the diagram for Analytics subscription is shown in Figure 6.10.2.1-1.
Figure 6.10.2.1-1: Registration/Deregistration of NWDAF serving a UE in UDM
with an Analytics subscription
1\. A NF such as an SMF or AMF is elected to serve a UE identified by its
SUPI. This can be part of, e.g. a registration procedure, AMF re-allocation,
PDU session establishment, etc.
2\. The NF (i.e. AMF, SMF) requests UE related Analytics for this UE.
3\. The NWDAF accepts the request.
4\. The NWDAF invokes Nudm_UECM_Registration (SUPI, NWDAF FQDN, NWDAF instance
ID, Analytics ID, S-NSSAI, Serving Area).
5\. UDM acknowledges the registration.
6\. The NWDAF Notifies NF according to subscription
7\. The NF decides to unsubscribe, e.g. the UE is not served by the NF any
longer
8\. The NF unsubscribes to Analytics
9\. The NWDAF invokes Nudm_UECM_Deregistration.
10\. UDM acknowledges the deregistration.
11\. The NWDAF responds to the request
Below the diagram for Analytics request is shown.
Figure 6.10.2.1-2: Registration/Deregistration of NWDAF serving a UE in UDM
with an Analytics request
1\. A NF such as an SMF or AMF is elected to serve a UE identified by its
SUPI. This can be part of, e.g. a registration procedure, AMF re-allocation,
PDU session establishment, etc.
2\. The NF (i.e. AMF, SMF) requests UE related Analytics for this UE.
3\. If the NWDAF doesn\'t have the immediate report available, the NWDAF
invokes Nudm_UECM_Registration (SUPI, NWDAF FQDN, NWDAF instance ID, Analytics
ID, S-NSSAI, Serving Area).
4\. UDM acknowledges the registration.
5\. The NWDAF send a response to the request.
6\. The NWDAF invokes Nudm_UECM_Deregistration.
7\. UDM acknowledges the deregistration.
#### 6.10.2.2 Discovery the NWDAF serving the UE via UDM
When an NWDAF service consumer (e.g. an NWDAF on slice level) is instructed to
produce UE related Analytics, it may well benefit from existing analytic
reports produced by NWDAFs that already produce these analytics. The NWDAF
service consumer first needs to discover if an NWDAF is producing UE related
Analytics for a specific Analytics IDs. The procedure is illustrated in Figure
6.10.2.2-1.
Figure 6.10.2.2-1: Discovery of NWDAF via UDM
1\. An NWDAF service consumer, e.g. NWDAF on slice level, due to a request for
collecting analytic reports for a UE, starts a data collection and analytics
collection procedure for such UE.
2\. The NWDAF services consumer discovers the UDM that is serving the UE by
invoking the procedures specified in TS 23.501 [2] clause 6.3.8, e.g. making a
query to the NRF based on SUPI. As a result, NWDAF services consumer obtains
the address of the UDM NFs serving this UE.
3\. The NWDAF services consumer selects a UDM NF and sends a Nudm_UECM_Get
request (NF type \'NWDAF\', SUPI, Analytics ID, S-NSSAI, Serving Area).
4\. If there exists an NWDAF that performs Analytics for the UE, the NWDAF
service consumer obtains the address of the NWDAF serving the UE for that UE
related Analytics. The NWDAF services consumer subscribes to changes of the
NWDAF serving the UE.
5\. The NWDAF services consumer requests analytics from the NWDAF serving the
UE or if no NWDAF is received in the response in step 4 an NWDAF is selected
using the NWDAF discovery principles defined in clause 6.3.13, TS 23.501 [2].
The NWDAF service consumer may add the parameter \"Time when analytics
information is needed\" for NWDAF Analytics subscription or request. If this
parameter is set for an Analytics subscription it gives the flexibility for
the distributed NWDAF to send statistics when feasible, which may be when
signalling in the network is low (usually during night) or at least before the
UE data and Analytics is deleted in conjunction with the UE stopped being
served by the distributed NWDAF. The NWDAF service consumer may add a
parameter \"Suppression of Notification\" for NWDAF Analytics subscription. If
this parameter is set the NWDAF starts collecting data for Analytics
calculations but will not send any Analytics. When the NWDAF service consumer
would like to retrieve Analytics building on collected data it modifies the
subscription, without the new parameter to the NWDAF.
NOTE 1: As an alternative, \"Analytics target period\" as defined by clause
6.1.3, TS 23.288 [5] can be used for the purpose of \"Suppression of
Notification\" without any modification of subscription if the expected
retrieval time to collect analytics is known by the NWDAF service consumer.
If a DCCF is deployed and when an NWDAF does not have the data available for
the intended UE related Analytics ID, it may in the same request, to DCCF for
Data also add a request/subscription for the Analytics ID and accompanying
parameters such as (e.g. Filters). Sending the request/subscription for the UE
related Analytics ID in the Data request is a way for the requesting NWDAF to
allow another NWDAF to perform the calculation to derive the Analytics. Then
DCCF may decide to let another NWDAF (possibly distributed) do the Analytics
on behalf of the requesting NWDAF. The Analytics is then forward to the
requesting NWDAF.
NOTE 2: Alternatively, the NWDAF may do an Analytics request/subscription
towards DCCF instead of adding the request for UE related Analytics ID in the
Data request.
The procedure is illustrated in Figure 6.10.2.2-2.
Figure 6.10.2.2-2: Discovery of NWDAF via DCCF
1\. An NWDAF, e.g. NWDAF on slice level, due to a request for collecting
analytic reports for a UE, starts a data collection and analytics collection
procedure for such UE.
2\. The NWDAF sends a request for data to DCCF, including the
request/subscription for a UE related Analytics IDs and accompanying
parameters such as (e.g. filters).
3\. If the DCCF has no knowledge of if the requested Analytics IDs are
produced, the NWDAF services consumer selects a UDM NF and sends a
Nudm_UECM_Get request (NWDAF type, SUPI, Analytics ID, S-NSSAI, Serving Area).
4\. The NWDAF service consumer obtains the address of the NWDAF serving the UE
for that UE related Analytics. The NWDAF services consumer subscribes to
changes of the NWDAF serving the UE.
5\. Using the knowledge that the Analytics IDs are produced, the DCCF requests
analytics on behalf of the requesting NWDAF.
6\. The distributed NWDAF starts sending Analytics via notifications to the
requesting NWDAF.
#### 6.10.2.3 Providing the information of the NWDAF serving the UE to
consumers
An NWDAF service consumer may discover the NWDAF serving the UE as defined in
Figure 6.10.2.2-1. Alternatively, the NF serving the UE may provide the NWDAF
serving the UE to the NWDAF service consumer without explicit request. This
solution shows how the AMF or the SMF provides the NWDAF serving the UE to the
PCF at AM or SM Policy establishment.
Figure 6.10.2.3-1: AM and SM Policy Association Establishment including NWDAF
serving the UE
1\. AMF or SMF includes the NWDAF serving the UE identified by the NWDAF
instance Id, the NWDAF FQDN or IP address. Per NWDAF service instance. The
Analytics ID(s) and its serving area is also included.
2\. The PCF stores the NWDAF and its information, then send a response to the
AMF or SMF, including a new Policy Control Request Trigger to subscribe to
change of NWDAF serving this UE.
3\. The PCF evaluates operator policies, if any policy decision depends on UE
related, the PCF checks if the a NWDAF provides these Analytics, then steps 4
and 5 take place, otherwise the PCF performs NWDAF discovery and selection
using NRF to find the NWDAF instance to subscribe to provide the analytics
needed for the operator policies.
4\. PCF subscribes to NWDAF as defined in TS 23.288 [5] for an NF to request
analytics. Examples are Analytics on UE Mobility or UE Communication or
Expected UE behaviour or Abnormal UE behaviour.
5\. PCF receives the analytics.
For those scenarios where the PCF serving the AMF and the SMF are different,
the AMF informs the SMF of their NWDAF at the PDU session establishment or
modification (if the NWDAF serving the UE changes, due to AMF relocation) and
the SMF informs the AMF of the NWDAF serving the UE at the PDU session
establishment response or modification.
The AMF includes the subscription to change of NWDAF serving the UE to the AM
Policy Association in the UE Context transferred to the target AMF.
#### 6.10.2.4 Selection of distributed NWDAF and transfer of statistics
A source AMF using a distributed source NWDAF may send the source NWDAF ID in
the UE context transfer to the target AMF. The target AMF decides whether to
use the source NWDAF or a new target NWDAF. If the target AMF decides to use
the source NWDAF, it may subscribe to the source NWDAF and it communicates in
the response to the source AMF, I am done. Source AMF unsubscribes to source
NWDAF. Source NWDAF deletes subscription from old AMF. If target AMF has
already subscribed, that subscription is kept, with all the inherited data. If
target AMF decides to use a new target NWDAF, it may subscribe to target
NWDAF, including the source NWDAF ID. The target NWDAF requests UE related
statistics from the source NWDAF, and it communicates in the response to the
target AMF, I am done. Target AMF communicates in the response to source AMF,
I am done. Source AMF unsubscribes to source NWDAF. Source NWDAF deletes
subscription from old AMF when statistics has been transmitted to the source
NWDAF.
The procedure is illustrated in Figure 6.10.2.4-1.
Figure 6.10.2.4-1: Selection of distributed NWDAF and transfer of UE related
statistics
1\. A new (target) AMF starts serving the UE.
2\. Target AMF requests UE context from source AMF.
3\. Source AMF sends UE context to target AMF, including the NWDAF ID used by
the source AMF for UE related Analytics, and may also include some relevant
parameters from the NF Profile.
4\. Target AMF may utilize the NRF service to discover NWDAFs.
5\. Target AMF selects an NWDAF. In this example, the Target AMF selects a new
Target NWDAF.
6\. Target AMF subscribes to the selected Target NWDAF.
7\. If the selected NWDAF is a new Target NWDAF, it requests the UE related
statistics from the source NWDAF
8\. The source NWDAF sends the UE related statistics.
9\. The Target NWDAF responds, indicating it has started to retrieve
statistics from the source NWDAF
10\. The Target AMF sends a RegistrationStatusUpdate to the source AMF,
indicating that the source AMF can unsubscribe from source NWDAF.
11\. The Source AMF unsubscribes from the source NWDAF
12\. The Source NWDAF purges statistics when all statistics has been sent to
target NWDAF
NOTE: According to Operator policies and configuration, each NWDAF (source and
target) may register (and deregister) the supported UE according to clause
6.10.2.1 Registration/Deregistration of the NWDAF serving the UE procedure.
If a DCCF is deployed it may be used to support the transfer of statistics.
The procedure is illustrated in Figure 6.10.2.4-2.
Figure 6.10.2.4-2: Selection of distributed NWDAF and transfer of UE related
statistics using DCCF
0\. Source NWDAF has registered into UDM what UEs and Analytics IDs it
supports respectively.\ DCCF requests info from UDM so it is updated on which
NWDAF supports what UEs and Analytics IDs respectively or it receives it via
data requests.
1a. A new (target) NF starts serving the UE.
1b. The Source NF will unsubscribe to the Source NWDAF. The Statistics is kept
during a pre-defined time or until the statistics is forward.
1c. The Source NWDAF will unsubscribe from UDM.
1d. The UDM acknowledges the registration.
1e. If Source NWDAF has used DCCF, the Source NWDAF unsubscribes to data.
1f. The DCCF keeps in memory, for a pre-defined time, the NWDAF and Analytics
IDs for the UE.
1g. The Source NWDAF responds to the unsubscribe request.
2\. Target NF may utilise the NRF service to discover NWDAFs.
3\. Target NF selects an NWDAF. In this example, the Target NF selects a new
Target NWDAF.
4\. Target NF subscribes to the selected Target NWDAF.
5\. The Target NWDAF invokes Nudm_UECM_Registration.
6\. UDM acknowledges the registration.
7\. Target NWDAF requests Data for the UE via the DCCF. The NWDAF may add the
Analytics IDs as well.
8\. The DCCF has the knowledge of the earlier used NWDAF and Analytics IDs for
this UE. The DCCF adds the Source NWDAF ID and Analytics IDs in the response.
9\. If the Analytics IDs where not added in data request, the DCCF sends a
Nudm_UECM_Get request.
10\. The UDM responds with the UE\'s target NWDAF and its related Analytics
IDs.
11\. If the selected NWDAF is a new Target NWDAF, it requests the UE related
statistics from the source NWDAF
12\. The source NWDAF sends the UE related statistics.
13\. The Target NWDAF responds to the request
14\. The Source NWDAF purges statistics when all statistics has been sent to
target NWDAF or when the pre-defined time has passed.
15\. The DCCF purge the Source NWDAF when received the Ndccf_DataSubsciption
or pre-defined time has passed
### 6.10.3 Impacts on services, entities and interfaces
NWDAF: Additional registration into UDM for UE related Analytics for a SUPI.
NWDAF: Add Analytics ID/request for a UE related Analytics ID in a Data
request towards DCCF.
DCCF: Receiving Analytics ID/request for a UE related Analytics ID in a Data
request. Decide if another NWDAF shall forward the Analytics to the requesting
NWDAF. Alternatively receiving a request/subscription for a UE related
Analytics ID.
NWDAF service consumer: Discovery of NWDAF serving the UE and Analytics ID.
UDM: Enhanced Nudm_UECM procedure with new data set for storing NWDAF
registrations.
PCF: Extend Npcf_AMPolicy Control and Npcf_SMPolicyControl to report the NWDAF
serving the UE from the AMF or SMF.
AMF: Report the NWDAF serving the UE to the PCF at SM Policy Association
Establishment and to the SMF at PDU session establishment or modification.
SMF: Report the NWDAF serving the UE to the PCF at SM Policy Association
Establishment and to the SMF at PDU session establishment or modification.
## 6.11 Solution #11: Two-level Hierarchical NWDAFs Architecture
### 6.11.1 Description
This is a solution for Key Issue #2, Multiple NWDAF instances.
As illustrated in Figure 6.11.1-1, a two-level hierarchical NWDAFs
Architecture is proposed.
The 1st level NWDAF is common NWDAF i.e. there\'s no limitation for the NF(s)
the NWDAF could serve. The common NWDAF register with NRF using the current
factors defined in TS 23.501 [2], i.e. S-NSSAI/ Analytics ID/ service area.
Each 1st level NWDAF could cover 0...n 2nd level NWDAFs.
The 2nd level NWDAF could be a collocated NWDAF or a NWDAF serves several
specific NFs. The 2^nd^ level NWDAF registers to the NRF with the current
factors defined in TS 23.501 [2], i.e. S-NSSAI/ Analytics ID/ service area,
and additionally with associated 5GC NF IDs. The 1^st^ level NWDAF needs to
query the NRF to determine whether the 5GC NFs for data collection have
associated 2^nd^ level NWDAFs which can provide the required analytics.
General 5GC NF failure handling procedure applies to the NWDAF shutdown case.
If the 1^st^ level NWDAF detects the shutdown of a 2nd level NWDAF, it can
select another applicable 2nd level NWDAF. In case of no applicable 2nd level
NWDAF can be found, if possible, the 1^st^ level NWDAF performs data analytics
by itself.
An NF (including 1^st^ level NWDAF) queries NRF for NWDAF discovery. NRF
returns the NWDAFs which fully match the request factors. The NF can also
provide to NRF its intention to discover all NWDAFs which can assistant the
analytics by a \"discover NWDAFs for assistance\" indication. For example,
when a NF requests for Analytic ID1 and TAI1+TAI2...+TAIn, NRF returns the
1^st^ level NWDAF info which supports Analytic ID1 and serves
TAI1+TAI2...+TAIn, but when the 1^st^ level NWDAF provides Analytic IDs and
TAI1+TAI2...+TAIn and the \"discover NWDAFs for assistance\" indication to
NRF, NRF returns all the 2^nd^ level NWDAFs with the same Analytics ID but
covering subset area (e.g. only serves TAI1+TAI2, or only serves TAI3) or
serving specific NF(s). if the NWDAF service consumer subscribes to the 1st
level NWDAF for analytics, the 1st level NWDAF could further subscribe to the
2nd level NWDAF(s) for help.
NOTE: The data collection for 1^st^ level NWDAF follows the conclusion of
KI#1. The 2^nd^ level NWDAF could collect data directly from the NF that it
serves, if the analytics at 2^nd^ level NWDAF needs to collect data from other
NFs, it also follows the conclusion of KI#1It does not exclude the possibility
for a 2^nd^ level NWDAF to consume services provided by other NFs than the NF
it serves.
Moreover, some of NWDAFs may be providing different type of analytics but can
help each other, in this case, if the NF requests for NWDAF discovery with
\"discover NWDAFs for assistance\" indication, NRF additionally returns the
NWDAFs info with different Analytic IDs which could assistant the analytics.
Figure 6.11.1-1: Two-level hierarchical NWDAF Architecture
### 6.11.2 Procedures
Figure 6.11.2-1: An example procedure for two-level hierarchical NWDAF
Architecture
This is an example procedure for the two-level hierarchical NWDAF
Architecture. In this procedure we suppose the 1st level NWDAF A supports
Analytics ID1= \"Abnormal behaviour\" and serves TAI1+TAI2...+TAIn, the 1^st^
level NWDAF D supports Analytics ID2= \"UE communication analytics\" and
serves TAI1+TAI2...+TAIn. The 2nd level NWDAF b collocate with SMF1 of slice
1, while the 2nd level NWDAF b supports Analytics ID1. The 2nd level NWDAF c
collocates with another SMF2 of slice 2, the 2nd level NWDAF c supports
Analytics ID1.
1\. The 1st level NWDAF A registers to NRF using Analytics ID1 and
TAI1+TAI2...+TAIn, the 1^st^ level NWDAF D registers to NRF using Analytics
ID2 and TAI1+TAI2...+TAIn.
2\. The 2nd level NWDAF registers to NRF by indicating the Analytics ID it
serves and the associated NFs, e.g., the 2nd level NWDAF b registers to NRF
using Analytics ID1 and indicates it only serves SMF1 of slice 1; the 2nd
level NWDAF c registers with NRF using Analytics ID1 and indicates it only
serves SMF2 of slice 2. The registration with NF ID(s) implicitly indicates
that this is a 2^nd^ level NWDAF.
3\. A NWDAF service consumer wants the analytics for Analytics ID1 of
TAI1+TAI2...+TAIn, so it sends the query to NRF with Analytics ID1 and
TAI1+TAI2...+TAIn.
4\. NRF discovers the NWDAF fully match the request factors, i.e. the 1^st^
level NWDAF A. NRF responds with the identifier of the 1st level NWDAF A.
5\. The NWDAF service consumer subscribes to the 1st level NWDAF A for the
analytics of Analytics ID1 of TAI1+TAI2...+TAIn. The NWDAF service consumer
may also include target UE id, expected analytics type=\" communication
related\" in the request.
6 a. Based on the Analytics ID and Analytics Filter, the 1st level NWDAF
determines the NFs for data collection first. If the analytics filter received
from the consumer NF contains \"AOI\", the 1st level NWDAF has to determine
the corresponding NF by querying NRF with AOI, otherwise, the 1st level NWDAF
A determines the NFs for data collection as specified in clause 6.2.2 of the
TS 23.288 [5].
The 1st level NWDAF A checks whether there are other NWDAFs which can help the
analytics by querying NRF with the Analytics ID1 and the NF ID(s). The 1^st^
level NWDAFA could also query NRF with the Analytics ID1 and TAI1+TAI2...+TAIn
and \"discover NWDAFs for assistance\" indication to get all the 2^nd^ level
NWDAFs with the same Analytics ID but covering subset area or serving specific
NF(s), NRF responds with the NWDAF profiles of the 2nd level NWDAFb, the 2nd
level NWDAFc, the 1st level NWDAF D. If there\'s no other NWDAFs can help the
analytics, the 1^st^ level NWDAF needs to collect the required data from the
NF and perform data analytics by itself.
6b. If the 1st level NWDAF determines that a 2^nd^ level NWDAF associated with
the NF can serve the requested analytics ID, it can request the 2^nd^ level
NWDAF to provide the data analytics directly. For example, the 1st level NWDAF
A determines the SMF(s) serving this UE by interrogating UDM, then NWDAF A
knows which 2nd level NWDAF(s) associated with the serving SMF(s) could
perform data analytics for a particular Analytics ID, e.g. the NWDAF b and c
for Analytics ID1.
The 1st level NWDAF A subscribes to the 2nd level NWDAF b for the analytics of
Analytics ID1= \"Abnormal behaviour\", the target UE id, expected analytics
type=\" communication related\" is also included in the request.
The 1st level NWDAF A subscribes to the 2nd level NWDAF c for the analytics of
Analytics ID1= \"Abnormal behaviour\", the target UE id, expected analytics
type=\" communication related\" is also included in the request.
7\. The 1st level NWDAF A subscribes to the 1st level NWDAF D for the
analytics using Analytics ID2 and the target UE id.
8\. The 1st level NWDAF D performs the Analytics ID2=\"UE communication
analytics\" for the target UE and sends the analytics report to the 1st level
NWDAF A.
9\. The 2nd level NWDAF b performs the analytics of Analytics ID1= Abnormal
behaviour, expected analytics type=\" communication related\" for the target
UE. NWDAF b sends the analytics report of Analytics ID1 for its collocated
SMF1 of slice 1 to the 1st level NWDAF A.
NWDAF c performs the analytics of Analytics ID1= Abnormal behaviour, expected
analytics type=\" communication related\" for the target UE, and sends the
analytics report of Analytics ID1 for its collocated SMF2 of slice 2 to the
1st level NWDAF A.
10\. The 1st level NWDAF A performs the analytics of Analytics ID1, with the
help of analytics report from the 2nd level NWDAF b and the 2nd level NWDAF c,
the 1st level NWDAF D, and the data collected from 5GC NFs if necessary. The
1st level NWDAF A sends the analytics report of Analytics ID1 to the NWDAF
service consumer.
11\. As the UE may moves out of the service area of the 2^nd^ level NWDAF
which is performing UE related data analytics, the 2^nd^ level NWDAF has to
notify the 1^st^ level NWDAF of the UE being out of its service.
12\. The1^st^ level NWDAF executes steps 6 to identify a 5GC NF and/or 2^nd^
level NWDAF which can serve the UE when it receives the notification in step
11.
### 6.11.3 Impacts on services, entities and interfaces
No impact to NWDAF service consumer.
NRF:
\- needs to support a new registration parameter for the NWDAFs, i.e. the 5GC
NF IDs associated with the NWDAF. The registration with NF ID(s) implicitly
indicates that this is a 2^nd^ level NWDAF.
\- needs to understand Analytic IDs and their relationships in order to
understand which different Analytics IDs could assist the requested Analytics
ID.
\- if the \"discover NWDAFs for assistance\" indication is not in the
discovery request, NRF returns the NWDAFs which fully matchs the request
factors. If the \"discover NWDAFs for assistance\" indication is in the
discovery request, NRF returns all the 2^nd^ level NWDAFs with the same
Analytics ID but covering subset area or serving specific NF(s), NRF may
additionally return the NWDAFs info with different Analytic IDs which could
assistant the analytics.
## 6.12 Solution #12: Support for NWDAF interactions within SBA framework
### 6.12.1 Description
#### 6.12.1.1 General
This solution addresses KI#2, KI#11 by utilizing the SBA framework to support
the interactions among multiple NWDAF instances in an efficient manner of data
collection with their cooperation.
The main idea of the solution is as follows:
\- Logical decomposition of NWDAF to data collection (e.g., DCCF, DCNF), data
storage (e.g., DSRF, NWDAFdsf), and model provisioning/training other than
analytics data generation.
These split functionalities can be deployed in a separate NF per each, where
it introduces new NFs and services defined in 5GC. In the other way, they can
be deployed in a separate NWDAF service per each, where it does not incur any
changes to 5GC architecture so that it could minimize impact to the Rel-16
systems.
At the latter case, a NWDAF instance may register itself to NRF with
specifying its services supported (e.g., data analytics, data collection, data
storage, and model provisioning/training) so that a NWDAF instance may
discover the other NWDAF instance(s) which provide the expected NWDAF services
by contacting NRF and interact with them.
\- Support for interactions of multiple NWDAF instances associated (or co-
located) with different target entities (e.g., NFs, NF sets, UEs) in a
distributed manner or a hierarchical manner.
A NWDAF instance may be pre-configured (i.e., associated) based on operator\'s
policy to serve a specific set of entities (e.g., UEs, NFs, NF sets, area of
interest) where the NWDAF instance collects data or generate analytics from.
Then multiple NWDAF instances may help each other to generate aggregated
analytics or collect data from multiple sets of target entities as discussed
in KI#2. A NWDAF instance may be logically associated with a specific set of
target entities to serve. A NWDAF instance may be logically associated with a
5GC NF by co-locating with the 5GC NF according to operator\'s deployment
choice.
No matter how the multiple NWDAF instances are organized, there needs a means
to discover a NWDAF instance which is associated (or co-located) with a target
entity specified. While a NWDAF instance may manage the registration (or
configuration) of association information of the other NWDAF instances, it may
cause extra burden and new NWDAF services defined to maintain the association
information.
As an alternative way, NRF may be exploited by specifying the association
information in the NF profile so that a NWDAF instance can register itself or
discover the others with the associated target entities.
For example, assuming that NWDAF-2 (associated={NF1, NF2}), NWDAF-3
(associated={NF3}) are registered in NRF and NWDAF-1 can provide analytics
data of {NF1, NF2, NF3} as an aggregation point by discovering NWDAF-2 and
NWDAF-3 with NRF and interacting with them. Then NWDAF-1 (associated={NF1,
NF2, NF3}) can be registered in NRF. At this case, a NF consumer (including
NWDAF) may discover and interact with NWDAF-1 to obtain analytics data of
{NF1, NF2, NF3}.
Note that this approach does not preclude hierarchical management of NWDAF
instances: how to manage the hierarchy of the NWDAF instances is up to the
consumer NWDAF instance (NWDAF-1 in the example above) at this stage. NRF may
support the hierarchical management of NWDAF instances with additional
parameters in NWDAF profile but FFS.
This solution is based on the following design principle or assumption:
\- In 5GC, multiple NWDAF instances may be deployed and cooperate with each
other.
\- Each NWDAF instance may provide the following:
\- a different set of NWDAF services (e.g., data analytics, data collection,
data storage, model provisioning/training) to support the logical
decomposition of NWDAF functionalities. (as per KI#1)
\- a different set of analytics information associated with a specific slice,
NFs, NF sets, serving areas, etc. (as per KI#2)
\- Each NWDAF instance needs to register itself to NRF with its NWDAF profile
including its supported services and associated target entities as described
above.
\- A NWDAF instance (or a NF consumer) may discover the other NWDAF
instance(s) by contacting NRF with specifying a set of target NWDAF service(s)
and/or the target entities for analytics aggregation or data collection.
This solution provides the following functionalities to support the principle
aforementioned:
\- **Registration of NWDAF\'s services supported:** An NWDAF instance
registers itself to NRF with its supported services (e.g., data analytics,
data collection, data storage, model provisioning/training).
\- **Registration of NWDAF\'s target entity information:** An NWDAF instance
registers itself to NRF with additional information about the target entities
(e.g. NF(s), NF set(s)) currently associated.
NOTE: this solution does not preclude other means to register NWDAF instances
to NRF e.g., via OAM.
For the registration of NWDAF\'s services supported, the NWDAF instance needs
to publish its relevant services supported for data analytics including data
collection and data storage as studied in Rel-17 using the \'Names of
supported services\' parameter of NF profile.
For the registration of NWDAF\'s target entity information, the NWDAF instance
needs to keep the target entity information updated in NRF at run-time. Using
this information, the other NWDAF instances may reduce the data collection
operations for the same target entities by aggregating the analytics already
being processed that is discovered from NRF.
To support the registration and discovery of multiple NWDAF instances for
their cooperation, each NWDAF instance needs to register itself with the
following parameters of NF profile in _Nnrf_NFManagement_NFRegister_
/_NFUpdate_ :
\- S-NSSAI, Analytics ID(s), NWDAF Serving Area information,
\- Names of supported services (e.g., for data analytics, data collection,
data storage, model provisioning/training).
\- list of NF ID(s) or NF Set ID(s), for target NF(s) co-located (or
associated) with the NWDAF instance
Note that the NWDAF instance needs to update its registration information in
NRF by invoking _Nnrf_NFManagement_NFUpdate_ as per change of supported
services and target entities associated being currently performed.
The following figure illustrates an example of NWDAF interactions for
analytics aggregation from multiple NWDAF instances associated with different
NFs.
Figure 6.12.1.1-1: NWDAF interactions for analytics aggregation
The following figure illustrates an example of NWDAF interactions where each
NWDAF instance provides different service with associated target entities.
Figure 6.12.1.1-2: NWDAF interactions with functionality decomposition
#### 6.12.1.2 Procedures
The following figure presents an example procedure of NWDAF interactions for
analytics aggregation for multiple NFs exploiting the NWDAF\'s target entity
information registered in NRF.
Figure 6.12.1.2-1: An example procedure for NWDAF registration and
interactions for analytics aggregation
1-2. NWDAF-2 registers itself to NRF with its serving Analytics ID(s), TAI(s).
NWDAF-2 also registers its supported services and the NF-2 which is its
analytics target currently being monitored.
3-4. NWDAF-3 registers itself to NRF with its serving Analytics ID(s), TAI(s).
NWDAF-3 also registers its supported services and the NF-3 which is its
analytics target currently being monitored.
5\. NWDAF-1, which is an analytics consumer for NF-2 and NF-3, discovers the
other NWDAF instance(s) which are currently performing the analytics of NF-2
and NF-3 by contacting NRF.
6\. NRF responds with NWDAF-2 for NF-2 and NWDAF-3 for NF-3.
7-8. NWDAF-1 invokes a request or a subscription to NWDAF-2 to obtain the
analytics data of NF-2.
9-10. NWDAF-1 invokes a request or a subscription to NWDAF-3 to obtain the
analytics data of NF-3.
11\. NWDAF-1 aggregates the analytics data from NWDAF-2 and NWDAF-3. It may
consume the aggregated analytics or forward it further to the other consumer.
The following figure presents an example procedure of NWDAF interactions for
an NWDAF instance providing data analytics functionality to collect data from
the other NWDAF instances providing data collection functionality by
exploiting the NWDAF\'s supported services registered in NRF.
Figure 6.12.1.2-2: An example procedure for NWDAF registration and
interactions with functionality decomposition
1-2. NWDAF-2 registers itself to NRF specifying NWDAF profile with \'data
collection\' as its supported service and \'NF-2\' as its associated target
entity.
3-4. NWDAF-3 registers itself to NRF specifying NWDAF profile with \'data
collection\' as its supported service and \'NF-3\' as its associated target
entity.
5\. NWDAF-1, which provides data analytics service, discovers the other NWDAF
instance(s) which are available for collecting data of NF-2 and NF-3 by
contacting NRF.
6\. NRF responds with NWDAF-2 for NF-2 and NWDAF-3 for NF-3.
7-8. NWDAF-1 invokes a request or a subscription to NWDAF-2 to obtain the data
of NF-2.
9-10. NWDAF-1 invokes a request or a subscription to NWDAF-3 to obtain the
data of NF-3.
NOTE: In step 7-10, NWDAF-1 exploits event exposure services provided by
\'data collection\' capability of NWDAF-2 and NWDAF-3 in the similar way done
for collecting data from the NFs of the other types.
11\. NWDAF-1 generates analytics data with the data collected. It may consume
the generated analytics data or forward it further to the other consumer.
### 6.12.2 Impacts on services, entities and interfaces
NWDAF:
\- needs an extension to NF registration and update operations to NRF
\- needs an extension to NF discovery operations for the other NWDAF instances
\- needs an additional capability for aggregation of analytics data and
collecting data from other NWDAF instances
\- needs an additional capability for exposure of collected data.
NRF:
\- needs an extension to NF registration and discovery service interfaces with
an additional parameter for NWDAF profile, i.e., a list of NF ID(s) or NF Set
ID(s), for target NF(s) co-located (or associated) with a NWDAF instance.
## 6.13 Solution #13: Time Coordination for Multiple NWDAFs
### 6.13.1 Description
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
In case of deploying multiple NWDAFs providing different type of analytics, a
tight relation may exist on an action taken by a consumer NF and the timing of
analytics collected from multiple NWDAFs (e.g. in order to adopt a correct AM/
SM policy). This implies without time coordination between multiple NWDAFs, an
un-intended outcome policy may be adopted for a given consumer NF due to
consuming data analytics from each NWDAF independently.
To address the above issue, it is proposed that the error response to \"time
when analytics are needed\" parameter (clause 6.1.3, TS 23.288 [5]) is revised
for time-coordination across multiple NWDAFs.
To do so, the NWDAF Service Consumer uses this parameter as an input on
analytics request to multiple NWDAFs to indicate the (minimum) expected
waiting time before taking an action based on collective consumed analytics
from them. On analytics response, if the time is reached but analytics is not
ready, each NWDAF may indicate a revised waiting time in error response (e.g.
based on history of analytics exposure from the same NWDAF or experienced
changes on analytics collection time from other NFs). The NWDAF Service
Consumer can subsequently update this parameter for future analytics requests
to the same set of NWDAFs. This ensures the NWDAF Service Consumer adopts a
more accurate waiting time before taking an action and the set of NWDAFs are
coordinated on data exposure timing.
### 6.13.2 Procedures
Figure 6.13.2-1: Procedure for time coordination across multiple NWDAFs
1a.-1b. On analytics request, NWDAF Service Consumer indicates the expected
waiting time as time when analytics are needed parameter to the set of NWDAFs
with tightly related analytics. The tightly related analytics can be
determined based on Analytics Filter Information (e.g. \"expected analytics
type\" parameter as defined in clause 6.7.5.1, TS 23.288 [5]).
2a.-2b. On analytics response, if the time is reached but analytics is not
ready, each NWDAF may indicate a revised waiting time in error response (e.g.
based on history of analytics exposure from the same NWDAF or experienced
changes on analytics collection time from other NFs).
3a-3b. On receiving an indicated revised waiting time as part of error
response, the NWDAF Service consumer may update the time when analytics are
needed for future analytics requests to the same set of NWDAFs.
4a-4b. If the time when analytics are needed is revised, NWDAF Service
Consumer, in future requests, indicates revised waiting time to all NWDAFs
within the same set.
NOTE 1: This procedure is only used for Nnwdaf_AnalyticsInfo_Request and
response services. Steps 2a- 2b and steps 3a-3b may happen in different orders
depending on the timing of analytics collection or processing (from other NFs)
for each NWDAF within the set.
NOTE 2: Coordination of time is shown here for a distributed aggregation model
but can be used similarly for centralised or mixed-mode analytics aggregation
models also at aggregation points acting as central NWDAF(s) when aggregating
analytics from other NWDAFs.
### 6.13.3 Impacts on services, entities and interfaces
NWDAF
\- The error response to \"time when analytics are needed\" parameter (clause
6.1.3, TS 23.288 [5]) is revised such that when each NWDAF sends an error
response to the NWDAF Service Consumer, it may include a revised waiting time.
## 6.14 Solution #14: Support flexible Analytics aggregation for multiple
NWDAFs
### 6.14.1 Description
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
In cases where multiple instances of NWDAF are deployed, some specialising in
providing certain type of analytics, or in order for multiple NWDAFs to help
each other to provide the same type analytics, a coordination mechanism should
be defined across the instances. More importantly, a consumer NF may need a
flexible analytics data aggregation mechanism, once it discovers corresponding
NWDAF instances, to realise different deployment options (whether distributed,
centralised aggregation or a mixture of the two).
In this solution, we cover three set of analytics data aggregation models and
relevant procedures for distributed (clause 6.14.2.1), centralised aggregation
(clause 6.14.2.2) and mixed mode deployment (6.14.2.3). For each case we
discuss impacts for services, entities and interfaces in clause 6.14.5. In
particular, we study where the intelligence on analytics data aggregation
model lies and the entities that can hold any assistance information regarding
each analytics data aggregation model for the consumer NF.
### 6.14.2 Procedures
#### 6.14.2.1 Distributed analytics aggregation model
Figure 6.14.2.1-1: Procedure for distributed multiple NWDAFs
In this clause, it is assumed that NWDAF Service Consumer is configured to
aggregate analytics from different NWDAFs in a distributed model. This option
is termed as Option A.
It is assumed that index (k) shows the NWDAF instance ID in a multi-instance
deployment. Each instance NWDAF(k) is specialised in a set of data analytics
types, identified by Analytics IDs(k); Instances with overlapping analytic IDs
may help each other e.g. to cover different sets of UEs as the target of
analytics reporting or to cover different set of Tracking Areas within the
area of interest. Tracking Area Indicator - TAI(k) refers to such areas of
interest that could be covered by NWDAF(k).
NOTE 1: This is in line with Rel-16 developments in TS 23.288 [5] and relevant
aspects in TS 23.501 [2] and TS 23.502 [3].
The details of each step are as follows:
1\. NWDAF service consumer sends (a set of) NF discovery request(s) to NRF
including each required Analytics ID per request. The set of request(s) may
also include extra information, e.g. Network Slice Selection Assistance
Information (i.e. S-NSSAI). NRF response(s) may include multiple NWDAF
instance IDs, NWDAF(k), each covering a set of Analytics ID(s), Analytics
IDs(k) including the requested one, and list of TAIs supported by instance
(k), identified as TAI(k).
NOTE 2: A consumer NF (i.e. NWDAF service consumer) decides on the set of
NWDAFs to aggregate analytics / collect analytics from based on its
implemented selection criteria (e.g. the level of load per NWDAF, number of
analytics IDs directly supported per NWDAF or other KPIs pre-configured by the
network Operator).
2\. NWDAF service consumer sends subscription request to each NWDAF(k)
including Analytics IDs(k) and TAI(k)* (e.g. as Analytics Filter). TAI(k)* is
intersection of TAI(k) with the area of interest for the NWDAF service
consumer. The request can be as the set of tuple of (Analytics IDs(k),
Analytics Filter=TAI(k)*) as shown in step 2a to differentiate the area of
interest per analytics ID. NWDAF(k) notifies with analytics specific
parameters per analytics ID as shown in step 2b.
3\. The NWDAF service consumer may aggregate the target of analytics reporting
across NWDAF(k)s for Analytics IDs(k) for corresponding area of interest
TAI(k)*.
#### 6.14.2.2 Centralised analytics aggregation model
Figure 6.14.2.2-1: Procedure for centralised aggregation for multiple NWDAFs
In centralised aggregation model, an aggregation point, NWDAF (j) per
analytics ID, may aggregate analytics for the same Analytic ID from other
NWDAFs, NWDAF(i), for different sets of UEs as the target of analytics
reporting or to cover different set of Tracking Areas within the area of
interest per Analytics ID.
##### 6.14.2.2.1 Centralised aggregation with AP ID (Option B)
In one option of centralised aggregation (termed as option B), a new
aggregation point identifier (AP ID) can defined per NWDAF when registering a
NWDAF within NRF. In this option, when registering an aggregation point like
NWDAF (j) into NRF in addition to the set of analytics IDs to be supported by
NWDAF (j) and area of interest to be covered by NWDAF (j), the AP ID is also
configured equivalent to NWDAF(j) ID. This also identifies NWDAF(j) as an
aggregation point.
When registering a distributed NWDAF like NWDAF (i) within NRF, in addition to
the set of analytics IDs to be supported by NWDAF(i) and the area of interest
to covered by NWDAF(i), the AP ID is also configured equivalent to one of
NWDAF(j)s already registered as aggregation points.
The configuration of AP IDs, i.e. the mapping between NWDAF (i) and NWDAF (j),
can take into account multiple factors including the expected level of load
per central NWDAF e.g. based on the maximum number of distributed NWDAFs that
a central NWDAF may support, analytics IDs supported per NWDAF, area of
interest supported per NWDAF, any predefined hierarchy for mapping or other
KPIs set by the network operator. NWDAF information maintained in NRF or any
other designated Data Repository structures may hold mapping between per
NWDAFs based on AP IDs. In option B, both NRF and NWDAF service consumer
become aware of the mapping between central and distributed NWDAFs.
The details of each step are as follows:
1\. Similar to step 1 of clause 6.14.2.1, except NRF response may include both
distributed NWDAF (i)s and central NWDAF (j)s. The NRF response also include
the AP ID per NWDAF(i) instance indicating possible aggregation point(s),
NWDAF(j) for different values of (j) i.e. the mapping between central and
distributed NWDAFs. NWDAF service consumer determines central aggregation
points based on the mapping received from NRF.
2\. NWDAF service consumer sends subscription request to NWDAF(j) (to
designate as aggregation point) including Analytics IDs(i), TAI(i)* (as
analytics filter) for NWDAF(i). NWDAF(j) identifies its designation as
aggregation point being the addressee of service consumer request.
NOTE 1: An explicit flag or parameter can be set as input parameter by NWDAF
service consumer to explicitly designate an aggregation point, NWDAF(j) in
step 2.
3\. NWDAF(j) subscribes to all NWDAF (i)s in a similar procedure as clause
6.14.2.1 (single instance subscription procedure). All NWDAF(i)s notify with
analytics specific parameters per analytics ID in the set of Analytics IDs(i).
4\. NWDAF(j) may aggregate the target of analytics reporting across different
NWDAF(i)s for Analytics IDs(i) for corresponding area of interest, TAI(i)*.
5\. NWDAF(j) notifies with analytics specific parameters per analytics ID for
all aggregated analytics IDs per NWDAF(i).
##### 6.14.2.2.2 Centralised aggregation without AP ID with mapping at service
consumer (Option C)
In another option of centralised aggregation (termed as option C), no mapping
is indicated between central and distributed NWDAFs at NRF. In this option, no
AP ID is configured for NWDAFs and only aggregation points are differentiated
when registering in NRF either implicitly or explicitly e.g. by configuring an
identifier. In option C, NRF becomes agnostic to the mapping between central
and distributed NWDAFs.
The details of each step are as follows:
1\. Similar to step 1 of clause 6.14.2.1, except NRF response may include both
distributed NWDAF (i)s and NWDAF (j)s identified as aggregation points. NWDAF
service consumer determines central aggregation point(s) based on its
configuration or implemented selection criteria.
2-5. are as above captured for option B.
##### 6.14.2.2.3 Centralised aggregation with extended list for supporting
analytics (Option D)
As another alternative (termed as Option D), each central NWDAF instance
profile may include an extended set of supporting analytics IDs (direct plus
indirect ones) within NRF. Per indirect analytics ID, central NWDAF may
aggregate analytics from other NWDAFs (for the same Analytics ID), for
different sets of UEs as the target of analytics reporting or to cover
different set of Tracking Areas within the area of interest.
Some central NWDAFs may only aggregate analytics (per indirect analytics ID)
so the extended list may not have directly supported analytics in that cases.
Such extended list may form as part of a pre-negotiation phase between
multiple NWDAFs as part of queries to NRF or based on a pre-defined hierarchy
when each NWDAF registers within NRF. In Option D, NRF and NWDAF service
consumer are agnostic to the mapping between central and distributed NWDAFs
but both may still distinguish an aggregation point (i.e. a central NWDAF)
from distributed NWDAFs. As a result, the implemented selection criteria per
NWDAF service consumer may leverage this as an assistance information in
addition to its other implemented selection criteria.
The details of each step are as follows:
1\. Similar to step 1 of clause 6.14.2.1, except NRF response include both
distributed NWDAF (i)s and NWDAF (j)s identified as aggregation points. NWDAF
service consumer determines central aggregation point based on its implemented
selection criteria.
2\. NWDAF service consumer sends subscription request to NWDAF(j) (to
designate as aggregation point) including all Analytics IDs, TAIs needed,
without indicating any mapping per NWDAF (i)s.
3\. NWDAF (j) based on extended set of supporting analytics IDs knows the
mapping to specific distributed NWDAFs to aggregate analytics from and
subscribes to them.
4\. NWDAF(j) may aggregate the target of analytics reporting across different
NWDAF(i)s for Analytics IDs(i) for corresponding area of interest.
5\. NWDAF (j) notifies with analytics specific parameters per analytics ID for
all aggregated analytics IDs, without indicating any mapping per NWDAF(i)s.
##### 6.14.2.2.4 Centralised aggregation without AP ID with mapping at central
NWDAFs (Option E)
In another option of centralised aggregation (termed as option E), no mapping
is indicated between central and distributed NWDAFs at NRF similar to C or D.
In this option also, no AP ID configured and only aggregation points are
differentiated when registering in NRF either implicitly or explicitly e.g. by
configuring an identifier. Furthermore, in addition to NRF, NWDAF service
consumer becomes agnostic to the mapping between central and distributed
NWDAFs. Instead, each central NWDAF based on configuration, implementation or
queries to NRF decides on mapping to specific distributed NWDAFs.
The details of each step are as follows:
1\. Similar to step 1 of clause 6.14.2.1, except NRF response may include both
distributed NWDAF (i)s and NWDAF (j)s identified as aggregation points. NWDAF
service consumer chooses central aggregation points.
2\. NWDAF service consumer sends subscription request to NWDAF(j) (to
designate as aggregation point) including all Analytics IDs, TAIs needed,
without indicating any mapping of analytics IDs or TAIs per NWDAF (i).
3\. NWDAF (j) based on configuration, implementation or queries to NRF decides
on mapping to specific distributed NWDAFs to aggregate analytics from and
accordingly subscribes to them.
4\. NWDAF(j) may aggregate the target of analytics reporting across different
NWDAF(i)s for Analytics IDs(i) for corresponding areas of interest.
5\. NWDAF (j) notifies with analytics specific parameters per analytics ID for
all aggregated analytics IDs, without indicating any mapping of analytics IDs
or TAIs per NWDAF (i).
#### 6.14.2.3 Mixed-Mode analytics aggregation model
Figure 6.14.2.2-1: Procedure for mixed-mode multiple NWDAFs
In a mixed-mode aggregation model, a mixture of option A from clause 6.14.2.1
with one of the options of the clause 6.14.2.2 (i.e. B or C or D or E) may
occur.
The details of each step are as follows:
1\. NWDAF service consumer sends (a set of) NF discovery request(s) to NRF
including each required Analytics ID per request. The set of request(s) may
also include extra information, e.g. Network Slice Selection Assistance
Information (i.e. S-NSSAI). NRF response may include (1b) a (set of) NWDAF
instance ID(s), i.e. NWDAF(k), to aggregate analytics in distributed manner.
NRF response may also include (1c) a (set of) NWDAF instance ID(s) (i.e.
NWDAF(i)) to aggregate analytics in centralised manner in a (set of) NWDAF
instance IDs (i.e. NWDAF(j)).
2\. NWDAF service consumer subscribes to all NWDAF(k)s similar to distributed
analytics aggregation procedure in clause 6.14.2.1 and receives individual
notifications.
3\. NWDAF service consumer also subscribes to NWDAF(j)s. NWDAF(j) subscribes
to all relevant NWDAF (i)s to be aggregated similar to centralised analytics
aggregation procedure in clause 6.14.2.2 and provides aggregate notification
to NWDAF service consumer.
4\. NWDAF service consumer aggregates analytics from both distributed and
centralised NWDAF instances.
### 6.14.3 Impacts on services, entities and interfaces
**Distributed analytics aggregation model:**
\- [Option A] No impact on current services, entities and interfaces, except
NWDAF service consumer may be extended to support aggregation of analytics for
target analytics IDs across different sections of area of interest.
**Centralised analytics aggregation model:**
\- [Option C]
\- NWDAF service consumer may select an aggregation point (i.e. Central
NWDAF).
\- central NWDAF(s) is extended to support aggregating, per analytics ID, the
analytics from different NWDAFs (e.g. covering different target areas and/ or
targets of analytics reporting).
\- aggregation points are differentiated when registering in NRF either
implicitly or explicitly.
\- [Option B]
In addition to option C impacts, each NWDAF profile may include AP ID as a new
parameter. AP ID can be maintained as part of NWDAF profile information within
NRF.
\- [Option D]
In addition to option C impacts, each central NWDAF profile registered in NRF
may include an extended set of analytics IDs (direct and indirect) that can be
supported. Per indirect analytics ID, central NWDAF may aggregate analytics
from other NWDAFs (for the same Analytics ID), for different sets of UEs as
the target of analytics reporting or to cover different set of Tracking Areas
within the area of interest.
\- [Option E]
In addition to option C impacts, each Central NWDAF based on configuration,
implementation or queries to NRF decides on mapping to specific distributed
NWDAFs.
Mixed-mode analytics aggregation model:
\- NWDAF service consumer may be extended to support aggregation of aggregated
analytics from central NWDAF(s) combined with analytics from distributed
NWDAFs (Mixed-mode only).
## 6.15 Solution #15: Data Collection Coordination
### 6.15.1 Description
This solution addresses Key Issues 2 and 11.
The architecture to support data collection for multiple NWDAF sets or
multiple NWDAFs is shown in Figure 6.15.1-1 and figure 6.15.1-2, respectively.
The Data Collection Coordination Function is in charge of data collection for
multiple NWDAFs. The DCCF can be a separate network function (NF) or can be a
functionality of NWDAF, that depends on the configuration of operators. When
DCCF functionality is part of NWDAF, this NWDAF can work as a normal NWDAF and
it also acts as DCCF to serve others NWDAFs to coordinate data collection. The
DCCF registers in NRF its service area, network slices (S-NSSAIs) and data
types it can collect. This is to support distributed network architecture and
avoid single point of failure. The Data Repository Function is in charge of
data storage for multiple NWDAFs. The DRF can be a separate network function
(NF) or can be a functionality of NWDAF, that depends on the configuration of
operators. When DRF functionality is part of NWDAF, this NWDAF can work as a
normal NWDAF and it also acts as DRF to serve others NWDAFs to store collected
data.
As shown in Figure 6.15.1-1, the DCCF plays the role of controlling signalling
and receiving/forwarding data. It _prevents NWDAF(s) triggering multiple times
the data collection of the same data from the same data provider instance._
When an NWDAF instance receives a request for data analytics, the NWDAF sends
data collection request to the Data Collection Coordination Function (DCCF).
The NWDAF may perform NF discovery and selection to select DCCF that can
perform data collection service. There are two options to discover the NF that
provides data. In the first option, the NWDAF may discover the NFs that
provide the required data. If the NWDAF send data collection request to the
DCCF including the NF ID of data producer. In the second option, the DCCF may
discover the NF that provides data. If the DCCF finds that some of the data
types are being collected as requested by some other NWDAF instances, the DCCF
may modify existing data subscriptions according to the new data collection
request. If the data type has not been collected, the DCCF use event exposure
services of the NFs to collect data. The data types to be collected for an
analytics ID are individual input data defined in TS 23.288 [5].
If the data type has been collected before by other NWDAF(s), the DCCF will
not use the Nnf_EventExposure_Subsribe and instead use
Ndccf_EventExposure_Notify to send the cached collected data to the NWDAF(s)
that subscribed for this data. If existing a DRF that has been stored these
historical data, DCCF can also collect these historical data from DRF.
After receiving the data, the DCCF forwards the received data to the NWDAF
instances that request this data type. Meanwhile, DCCF can cached these data
or forwards these data to DRF.
Please note in case NWDAF is collocated with 5GC NF, the NWDAF will collect
the data from the associated 5GC NF directly and shall not unnecessarily send
data request to DCCF and consequently DCCF cannot cached the requested data.
{width="4.701388888888889in" height="3.7708333333333335in"}
Figure 6.15.1-1: Architecture for data collection by using DCCF
Another architecture, as shown in Figure 6.15.1-2, the DCCF is only used to
control signalling of data collection _. Comparing with the previous one, in
this_ architecture the required data just be transferred between the data
consumer NWDAF and the data provider, which avoids additional data transfer
steps with DCCF.
When a NWDAF instance receives a request for data analytics, the NWDAF may
invoke NF discovery service of NRF to select a DCCF that can perform control
signalling for data collection service, where NWDAF sends the parameters of
request data to the DCCF. Base on the stored data profile provided by other
NWDAF(s) or Data Repository(s) in advance, DCCF can determine the status of
the required data (e.g. has not been collected, is being collected, has been
collected completely). There are may exist three scenarios.
In the first scenario, the DCCF discovers the requested data has not been
collected yet by other NWDAF(s). Then the DCCF responds to the requesting
NWDAF with a message that the query has no result. Consequently, the
requesting NWDAF shall subscribe to/request data provider to collect data.
Once getting the successful response from the data provider, the requesting
NWDAF should register/update the data profile that contains the parameters of
collected data to the DCCF. And then it will update the data profile again to
the DCCF after completing the procedure of data collection.
In the second scenario, the DCCF discovers some other NWDAF instance(s) is
collecting the requested data, then the DCCF responds to the requesting NWDAF
with a message that indicates the ID or address of the NWDAF, which is
collecting the required data. Consequently, the requesting NWDAF shall
subscribe to/request the indicated NWDAF to collect data. Similar as the first
scenario, the NWDAF shall register/update data profile of collected data to
the DCCF in different phases.
In the third scenario, the DCCF discovers some other NWDAF instance(s) or DRF
has collected the requested data. The rest of the operations of DCCF and the
requesting NWDAF are similar as the ones in the second scenario.
NWDAF(s) can cached these data for a period of time and/or store these data as
historical data in DRF. DRF should also register/update the data profile to
DCCF, the operation is similar to the previous NWDAF(s).
{width="5.8125in" height="3.5277777777777777in"}
Figure 6.15.1-2: Architecture for DCCF only used to control signalling for
data collection
### 6.15.2 Procedures
#### 6.15.2.1 Data collection by using DCCF to control signalling and forward
data
The procedure for data collection by using DCCF is illustrated in Figure
6.15.2.1-1.
{width="6.520833333333333in" height="4.590277777777778in"}
Figure 6.15.2.1-1: Procedure for data collection by using DCCF
1\. An NF-A sends analytics requests to an NWDAF by using
Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service
of the NWDAF.
2\. The NWDAF uses Nnrf_NFDiscovery service of NRF to discover and select
DCCF. The information to discover and select a DCCF may include DNN, S-NSSAI,
type of data to be collected, service area.
3\. The NWDAF use a service of DCCF, e.g. Ndccf_EventExposure_Subscribe to
send the data subscription request to the DCCF. The message may contain one or
more of following parameters: the type of data to be collected, and data
collection attributes.
NOTE 1: The DCCF can be a standalone NF or can be a functionality of NWDAF,
that depends on the configuration of operators.
4a. The DCCF may query the NRF to discover the data source NF.
4b.If the data type has not been collected from NF-B before, the DCCF uses an
event exposure service, such as Nnf_EventExposure_Subsribe where the NF could
be AMF, SMF for example, to subscribe for the required data type.
If the data is being collected but having different collection attributes, the
existing subscription parameters may be updated such as Expiry time, Area of
Interest.
If the data type has been collected from NF-B before, the DCCF will not use
the Nnf_EventExposure_Subsribe (step 4b will be skipped) and instead use
Ndccf_EventExposure_Notify to send the cached data to the NWDAF(s) that
subscribed for this data as defined in step 5 directly.
NOTE 1: Either NWDAF or DCCF may discover the NF-B.
NOTE 2: The NF-B is a data provider, it may be a NWDAF instance in some
scenarios, which can expose the collected data to other entities.
4c. The NF-B sends data notification to the DCCF, for example by using
Nnf_EventExposure_Notify service.
5\. The DCCF uses a service, for example Ndccf_EventExposure_Notify to send
the data to the NWDAF(s) that subscribed for this data. And DCCF can also
cache these data from NF-B and/or store these data to DRF.
NOTE 2: The DRF can be a standalone NF or can be a functionality of NWDAF,
that depends on the configuration of operators.
6\. The NWDAF performs data analytics.
7\. The NWDAF sends the analytics results data to the NF-A by using
Nnwdaf_AnalyticInfo_Response or Nnwdaf_AnalyticSubscription_Notify service.
#### 6.15.2.2 Data collection by using DCCF to control signalling
The procedure for the DCCF only used to control signalling for data collection
is illustrated in Figure 6.15.2.2-1.
{width="6.548611111111111in" height="8.416666666666666in"}
Figure 6.15.2.2-1: Procedure for the DCCF only used to control signalling for
data collection
1\. An NF-A (NWDAF consumer) sends analytics requests to an NWDAF by using
Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service
of the NWDAF.
2\. The NWDAF (data consumer) uses Nnrf_NFDiscovery service of NRF to discover
and select DCCF. The information to discover and select a DCCF may include
DNN, S-NSSAI, type of data to be collected and service area. And it also needs
to discover NF-B and/or Data Repository.
3a. The requesting NWDAF inquires the DCCF for example using the DCCF query
service to discover if the data is not collected or is being collected or has
been collected by some other NWDAF instance(s). The input parameters for the
DCCF query service may contain one or more of following ones: Analytics ID,
Event ID list, Time period of data collection, Area of Interest, where in the
Analytics ID indicates the event ID list are used to obtain the analytics for
the Analytic ID.
NOTE 1: The DCCF can be a standalone NF or can be a functionality of NWDAF,
that depends on the configuration of operators.
Scenario 1:
> 3b-1. If the data has not been collected from NF-B before by other NWDAF
> instance(s), the DCCF responds to the requesting NWDAF with a message that
> the inquiry has no result.
>
> 4-1. The requesting NWDAF uses Nnf_EventExposure_Subscribe to subscribe for
> the required data from the NF-B (data provider)(the ID or address of the
> NF-B is discovered in step 2). The NF-B responds to a successful
> subscription message.
Scenario 2:
> 3b-2. If the DCCF discovers some other NWDAF instance(s) (the distributed
> NWDAF) is collecting the requested data (the Data obtaining status of the
> data profile is collecting, as defined in step 5), the DCCF responds to the
> requesting NWDAF with a message that indicates the ID or address of the
> distributed NWDAF.
4-2. The requesting NWDAF uses Nnwdaf_EventExposure_Subscribe service to
subscribe for the required data from the distributed NWDAF. The distributed
NWDAF responds a successful subscription message.
Scenario 3:
3b-3. If the DCCF discovers some other NWDAF instance(s) (the distributed
NWDAF or the data repository) has collected the requested data (the Data
obtaining status of the data profile is completed, as defined in step 6), the
DCCF responds to the requesting NWDAF with a message that indicates the ID or
address of the distributed NWDAF or the data repository. The DCCF decides
which one to be interacted with the requesting NWDAF according to their NF
load status (NF load status can be queried through NRF). DCCF selects NF with
lower load status to achieve load balancing and avoid performance degradation
caused by the high load.
4-3. The requesting NWDAF uses Nnwdaf_EventExposure_Subscribe service to
subscribe for the required data from the distributed NWDAF or the data
repository. The distributed NWDAF responds a successful subscription message.
5\. Upon receiving the successful subscription response either from the NF-B
(in step 4-1) or the distributed NWDAF (in step 4-2 or 4-3), and before
starting to collect data, the requesting NWDAF should register the data
profile that contains the parameters of collected data to the DCCF, the data
profiled may contain one or more of following ones: Analytics ID, Event ID
list, Time period of data collection, Area of Interest, Data obtaining status
(e.g. collecting).
Collect Data:
> According to the subscription from the DCCF, the NF-B (in step 4-1) or the
> distributed NWDAF (in step 4-2 or 4-3) sends the required data to the
> requesting NWDAF, for example by using Nnf_EventExposure_Notify service.
6\. After finishing the data collection either from NF-B (in step 4-1) or the
distributed NWDAF (in step 4-2 or 4-3), the requesting NWDAF should update the
data profile for the collected data to the DCCF, which includes the updated
Data obtaining status (e.g. completed) and the validity of the collected data.
7\. The requesting NWDAF performs data analytics based on the collected data.
8\. The NWDAF sends the analytics results data to the NF-A (NWDAF consumer) by
using Nnwdaf_AnalyticInfo_Response or Nnwdaf_AnalyticSubscription_Notify
service.
9\. The NWDAF can also store collected data and related analysis results to a
Data Repository and update the data profile for the collected data and
obtained data analytics result again to the DCCF, adding the data storage
address or data repository ID(the ID or address of the Data Repository is
discovered in step 2). And the Data Repository can reject the NWDAF data
storage request, if the data requested for storage is being transmitted or has
been stored to the data repository by other NWDAF previously. It can avoid
repeated storage of the same data in the Data Repository.
NOTE 2: The DRF can be a standalone NF or can be a functionality of NWDAF
which depends on the configuration of operators.
During the storage period, the Data Repository could also register/update the
profile that contains the parameters of collected data to the DCCF, similar to
steps 4-1c and 6.
NOTE 3: This solution also applies to the data collection for the scenario
that NWDAF is collocated with 5GC NF, this NWDAF will collect the data from
the associated 5GC NF directly and shall not unnecessarily send required data
to DCCF. In order to enable data consumer can get the collected data from
these collocated NWDAF, they could register/update the profile to the DCCF
during/after the procedure of data collection.
### 6.15.2 Impacts on services, entities and interfaces
A new DCCF is introduced.
\- Impact on Data collection by using DCCF to control signalling and forward
data:
> \- The DCCF provides data collection service for other NWDAFs.
\- The NWDAF uses the service of DCCF for data collection.
\- Impact on Data collection by using DCCF to control signalling:
> \- The DCCF needs to support NWDAF registration/update the profile of
> collected data.
>
> \- The DCCF determines whether NWDAF is collecting data according to the
> profile of collected data by other NWDAFs.
>
> \- The DCCF indicates interacted NWDAF according to the NF load status.
>
> \- The DCCF will delete the corresponding profile after expiration according
> to the validity of the collected data.
>
> \- The NWDAF registers/updates the profile of collected data in DCCF after
> receiving the data provider or corresponding NWDAF response request or
> subscription success, and before data collection starts.
>
> \- After the NWDAF completes collecting data, the the profile of collected
> data is updated in DCCF.
>
> \- Data and analysis results can be transmitted between NWDAFs.
>
> \- The Data Repository (and/or entity with storage function) determines
> whether the same data and/or analysis results are being transmitted or
> stored.
## 6.16 Solution #16: Roles and inter-NWDAF instance cooperation from lower
level NWDAF to upper level NWDAF in hierarchical architecture
### 6.16.1 Description
This solution is proposed to address Key Issue #2: Multiple NWDAF instances
and KI#11: Increasing efficiency of data collection.
The solution describes how to avoid duplication of data collection when NWDAFs
at the lowest levels of hierarchy need data for an analytics ID that might be
also needed and collected by other NWDAFs in the same hierarchical lower
level. The data collection requests or subscriptions refers to the data to be
collected from source NFs or the aggregated data to be collected from other
NWDAF instances in different hierarchies. This solution is complementary to
\"Solution #18: Roles and inter-NWDAF instance cooperation from upper level
NWDAF to lower level NWDAF in hierarchical architecture\".
NOTE: The efficiency is achieved by NWDAF in one level of hierarchy
interacting with the NWDAF in the another level (i.e., upper level in this
case). An efficient data collection means that the same data required for the
same Analytics ID or different Analytics IDs should not be triggered multiple
times by different NWDAFs in the same level of the hierarchy, instead, it
should be triggered by the NWDAF in the upper level and distributed to the
lower levels. This leads to reduction of signalling for subscribing to NFs/OAM
data.
### 6.16.2 Procedure
The procedure of inter-NWDAF instance cooperation from lower level NWDAF to
middle level NWDAF in hierarchical architecture to coordinate data collection
is presented from Figure 6.16.1.2-1 below. The one or more NWDAF instance in
lower level is able to coordinate the triggering of data collection in its
associated upper level for efficient data collection. Optionally, the NWDAF
instances can be configured with the role of Data Collection Coordination
(DCC) functionality.
The discovery of NWDAFs in the different levels of the hierarchy shall be
based on NWDAF Serving area and analytics IDs information exposed in NWDAF NF
Profile. An NWDAF is configured with the whole hierarchy information. The
hierarchy information defines TAs belonging to each level of the hierarchy, as
well as the level of the hierarchy associated with the configured NWDAF. Based
on the hierarchy information, an NWDAF in a level of the hierarchy interacts
with NRF to discover the NWDAFs associated with upper and lower levels of the
hierarchy.
To key increase the efficiency of data collection in hierarchical NWDAF
architecture is to create mechanisms that prevent lower level NWDAF to trigger
subscription to NFs/OAM based only on their local triggered subscriptions to
NFs/OAM data. Instead, the lower level NWDAF should first check with upper
levels if the required data is available at the higher level (therefore, there
is already a subscription for the same data).
One possible mechanism to achieve this is to enable each NWDAF in the
different levels of the hierarchy to have their own _local_ mapping of
subscriptions as a solution option. For example, an Analytics instance ID
which is a local unique ID (e.g., a combination of Analytics ID and Analytics
filter information) at one NWDAF can be used for the mapping of the same
analytics subscription by different consumers, whereas Event instance ID which
is a local unique ID (e.g., a combination of Event ID and Event filter
information) can be used for the mapping of the same data to be collected from
the same data source for the same or multiple analytics ID instances. If the
NWDAF in one level of the hierarchy receives a new Analytics subscription
request to Analytics ID, the NWDAF only creates an Analytics Instance ID, if
no existing Analytics Instance ID can support the new Analytics subscription
request. For example, a new Analytics subscription request with the same
Analytics filter information is already subscribed by one Analytics consumer
and an Analytics Instance ID is already created, the new Analytics
subscription request can be mapped with the existing Analytics Instance ID.
The same concept is applied to the Event instance ID(s) for the
subscription/request of data collection. If a new Analytics Instance ID is
created by a NWDAF, the NWDAF only creates new Event Instance ID(s) if the
existing Event Instance IDs cannot be used.
In this solution, we assume that lower level NWDAFs are co-located with NFs.
Therefore, such NWDAFs can directly trigger the data collection from their
respective NFs and create or reuse the Event instance IDs associated with the
Event IDs of the collocated NFs. If the lower level NWDAF requires data from
other sources rather than the collocated NF for generating the requested
analytics ID, the lower level NWDAFs delegates the triggering of data
collection for other sources to the upper level NWDAF as it is described in
the procedure of Figure 6.16.2-1.
Figure 6.16.2-1: Procedure for inter-NWDAF instance cooperation from lower
level NWDAF to upper level NWDAF in hierarchical architecture
1\. NWDAF instances are configured with the role, e.g. the information of the
NWDAF Serving Area of its own tier (e.g, top level, middle level and lower
level), as well as the NWDAF serving areas in its associated tiers (e.g. upper
level).
2\. An Analytics consumer requests to the NWDAF in a lower level for an
Analytics subscription request.
3a. The requested lower level NWDAF is configured with mechanisms for
efficient data collection. To increase the efficiency of data collection in
hierarchical NWDAF architecture, the lower level NWDAF generates the local
mapping, containing the identification of a subscription to Analytics IDs
(Analytics instance ID) and the list of identification of triggered of data
(Event instance IDs) to be collected for such Analytics ID generation at other
NWDAFs, NFs, AFs, and OAM. If the lower level NWDAF receives a new Analytics
subscription request to Analytics ID, the lower level NWDAF only creates an
Analytics Instance ID, if no existing Analytics Instance ID can support the
new Analytics subscription request. If a new Analytics Instance ID is created
by NWDAF, the NWDAF only creates new Event Instance ID(s) if the existing
Event Instance IDs cannot be used. The lower NWDAF can be able to collect the
data from its co-located NF. Based on the association information, the lower
level NWDAF determines to ask the middle NWDAFs for any other data it
requires.
3b. If the data to generate the requested Analytics ID is not available, the
lower level NWDAF sends the request for data collection to the NWDAF in the
middle level, that has DCC functionality.
4\. The middle level NWDAF creates and/or checks its local mapping. If the
local mapping has already an Event instance ID for the requested data from the
lower level NWDAF, the middle level NWDAF identifies that a subscription
request for such requested data is available, otherwise the middle level NWDAF
will trigger the subscription (thus creating a new Event ID instance) for such
required data at other lower NWDAFs and/or NFs. For example, if the middle
level NWDAF receives a new subscription/request of data collection, the middle
level NWDAF only creates an Event Instance ID, if no existing Event Instance
ID can support the new data collection subscription/request.
Case A:
5a. The requested data is already stored and available at the middle level
NWDAF and, thus the middle level NWDAF sends the requested data to the lower
level NWDAF.
Case B:
5b. If the requested of data is not available at the middle NWDAF, i.e., there
is no Event instance ID associated with to such requested data, and requires a
new data subscription from the data source, e.g. NF The middle level NWDAF
sends the subscription request for the collected data from NF.
5c. The NF sends the collected data to the middle level NWDAF.
5d. The middle level NWDAF stores the collected data to be able to reuse if
the same data collection is required by other NWDAFs.
5e. The middle level NWDAF sends the request data to the lower level NWDAF.
NOTE: For simplicity the procedure in Figure 6.16.2-1 shows only the case when
the subscription to analytics ID arrives at the lower level NWDAF and the
coordination for reduction of signalling for triggering subscriptions to
NFs/OAM happens between lower and middle level NWDAFs. However, the solution
principle is the same if the subscription to analytics ID arrives at middle
level NWDAF and there is the need of coordination between middle and top level
NWDAFs. The case when the subscription to analytics ID arrives at the top
level NWDAF is described in Solution #18, clause 6.18.
### 6.16.3 Impacts on services, entities and interfaces
NWDAF:
\- Inter coordination of NWDAF instances between lower level and upper level
of different hierarchies, mechanisms to support DCC functionalities in
hierarchical architecture and storage capabilities at NWDAF instances.
\- Local mapping mechanisms for efficient data collection, e.g., using new
parameters of Analytics instance ID and Event instance ID.
\- New NWDAF service to support request/response and subscribe/notify
operations to exchange data collected by an NWDAF (not analytics output) in
NWDAF-to-NWDAF interactions.
## 6.17 Solution #17: Alternatives for Interactions among Hierarchical NWDAFs
### 6.17.1 Description
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
As defines by TS 23.288 [5], there exist cases where multiple NWDAFs can be
deployed in the network. Such NWDAFs could either provide the same analytics
ID or to provide different analytics IDs. Operators thus, need to organize
their multiple NWDAFs with supported analytics ID, in such a way that
consumers of analytics are able to identify the proper NWDAF instance that can
provide such analytics.
In addition, there exist cases in which the analytics output required by the
consumer, might require the involvement of multiple NWDAFs. This is the case,
for instance, of AF requesting analytics IDs via NEF. As defined in TS 23.288
[5], NEF translates any area of interest information indicate by an AF into
the area of interest information understood by the operators network and find
the proper NWDAF instance.
This solution proposes the organization of NWDAFs based on a hierarchical
model to support NF consumers to identify the proper NWDAF able to generate
the proper analytics ID without having to handle the issues of subscribing to
multiple NWDAFs. This way, the internal mechanisms of the NWDAFs becomes
transparent for the consumer of analytics.
This proposal assumes:
\- No fixed number for the hierarchy levels. In the solution, three-levels are
used as an example of a possible hierarchy configuration.
\- NWDAFs in higher level are configured to support the same Analytics Ids of
the NWDAFs in the lower levels below them.
\- The same procedure and information defined in TS 23.501 [2] clause 6.3.13
is used by a consumer that needs to discover the proper NWDAF to
subscribe/request the analytics ID. NRF will return the best matching NWDAF in
the hierarchy that can support the requested Analytics IDs. This way, the
consumer of the analytics interacts only with one NWDAF instance even if the
analytics ID for the requested area of interest is related to multiple NWDAFs.
\- NRF relies on the analytics ID and NWDAF serving area exposed by NWDAF
(according to TS 23.501 [2] clause 6.3.13) to determine the proper NWDAF to be
returned to an analytics consumer searching for an NWDAF instance.
\- Consumers of Analytics IDs can subscribe/request to NWDAFs services at any
level of the hierarchy as long as such NWDAFs was identified as the proper
NWDAF (via NRF discovery) to provide the analytics ID.
\- The lower level NWDAFs are co-located with NFs.
\- There exist Analytics Output Generation (AOG) modes for NWDAFs to interact
with each other in order to provide an analytics ID that requires multiple
NWDAFs involvement.
\- NWDAFs are configured with the supported AOG per analytics ID.
\- The AOG mode is an input parameter of NWDAF services (subscription/request
for analytics or request for data collection) for analytics ID generation used
when the consumer of such NWDAF services is another NWDAF. When the consumer
of NWDAF services is a Rel-17 NF (other than an NWDAF) supporting the AOG
modes and authorized by operator policies to indicate the AOG modes in
requests to a Rel-17 NWDAF, such as a DCCF, it may indicate an AOG mode in the
request to the NWDAF.
\- An NWDAF receiving a request from another NWDAF (or authorized consumer)
with the AOG mode, will apply the same AOG mode for the indicated analytics ID
to any interactions with further NWDAFs.
\- An NWDAF receiving a request with a non-supported AOG mode will rejected
such request.
\- The NF, AFs, OAM are not allowed to include the AOG mode in the
subscription to analytics IDs, if not authorized by the operator based on
operator policies. The NWDAF that received a request for analytics generation
from NFs, AFs, OAM without an AOG mode identifies the need to interact with
other NWDAFs, also determines the appropriated AOG mode to be used in the
NWDAFs interactions for the generation of the requested analytics ID.
\- The discovery of NWDAFs in the different levels of the hierarchy shall be
based on NWDAF Serving area and analytics IDs information exposed in NWDAF NF
Profile. An NWDAF is configured with the hierarchy information. The hierarchy
information defines TAs belonging to each level of the hierarchy, as well as
the level of the hierarchy associated with the configured NWDAF. Based on the
hierarchy information, an NWDAF in a level of the hierarchy interacts with NRF
to discover NWDAFs associated with the upper and lower levels of the
hierarchy.
The Analytics Output Generation interaction modes are:
\- Mode #1 - Generation based on Plain Collected Data.
\- Mode #2 - Generation based on Aggregated Collected Data.
\- Mode #3 - Composed/Aggregated Analytics ID.
\- Mode #4 - Mixed Collected Data.
The criteria to determine the appropriate AOG mode is dependent on the
operator\'s needs. For instance:
\- If operators cannot share collected data in a certain area of their network
with other areas due to privacy issues (e.g., operator has a network spanning
two different countries), the operator might use the AOG #3 with analytics
aggregation, in order to avoid disclosing the collected events among NWDAFs in
different regions.
\- If operators want to reduce as much as possible to volume of data exchanged
among NWDAFs, the operators should chose the AOG #3 (analytics aggregation) or
AOG#2 (aggregated collected data) or AOG#4 (Mixed Collected Data) for
analytics generation.
\- If operators want to generate analytics that can consider high level of
variability in the data sample, operators should use AOG#1 to collect the
plain data.
### 6.17.2 Procedures
#### 6.17.2.1 Interaction Mode#1: Generation based on Plain Collected Data
The analytics ID generation is performed by the NWDAF that received the NF
consumer request. NWDAF generates such analytics ID based on the collected
data from lower level NWDAFs (e.g. in other NWDAFs instances in the hierarch
co-located NWDAFs with NFs) and/or NFs related to the requested area by the
consumer of the analytics. The NWDAF that received the consumer request
identifies the AOG mode #1 has to be used for interactions with NWDAF for the
generation of the requested analytics ID.
NOTE: For simplicity the figure shows only the case when the proper NWDAF
identified by NRF is the Top Level NWDAF. However, a consumer can interact
directly with any NWDAF of the hierarchy as long as such NWDAF is the proper
NWDAF identified by NRF.
Figure 6.17.2.1-1: Procedures for analytics generation based on Interaction
Mode #1
0\. Consumer of NWDAF analytics interacts with NRF to discover the proper
NWDAF instance covering the requested area of the analytics ID to be
requested.
1\. Consumer of NWDAF analytics subscribe to the identified NWDAF. If the
consumer is authorized, it may include the AOG mode #1 in the subscription.
2\. If NWDAF does not has the data necessary for generating the requested
analytics ID, NWDAF request to the NWDAFs of the lower layers responsible for
the areas of the requested analytics ID, the collection of the missing data
for the analytics generation. The request for further NWDAFs includes the AOG
mode #1, that has be used for any further NWDAF-to-NWDAF interactions for the
analytics IDs generation.
3\. (a,b) The process of requesting collected data from lower levels of NWDAF
is recursively performed (if the NWDAF does not has the data in the area
required in the received request from an upper level NWDAF) until reaching the
lower level NWDAFs or middle NWDAFs that directly collect from NFs/OAM.
4\. The NWDAFs co-located with 5GC NF in lower levels as well as NF/OAM send
their respective collected data to the upper level NWDAF.
5\. If there are several middle layer, each NWDAF in a middle layer that
receive a request from an upper layer will send the information.
6\. The NWDAF that received the request from the consumer will receive the
collected data from all NWDAFs necessary for the analytics calculation and
will generate the analytics based on such collected data.
7\. NWDAF that received the consumer request for analytics generation notifies
the consumer of such analytics.
#### 6.17.2.2 Interaction Mode#2: Generation based on Aggregated Collected
Data
The analytics ID generation is performed at the NWDAF that received the
consumer request. NWDAF generates such analytics ID based on aggregated data
from lower NWDAF levels. The data types requested to the lower levels are of
the same type of the input data required for the analytics ID. However, the
lower levels of NWDAF process or aggregate the data samples, for instance,
aggregated (avr, max, min), instead of sending every collected sample for the
data type at the lower NWDAFs levels. The NWDAF that received the consumer
request identifies the AOG mode #2 has to be used for interactions with NWDAF
for the generation of the requested analytics ID.
NOTE: For simplicity the figure shows only the case when the proper NWDAF
identified by NRF is the Top Level NWDAF. However, a consumer can interact
directly with any NWDAF of the hierarchy as long as such NWDAF is the proper
NWDAF identified by NRF.
Figure 6.17.2.2-1: Procedures for analytics generation based on Interaction
Mode #2
0\. Consumer of NWDAF analytics interacts with NRF to discover the proper
NWDAF instance covering the requested area of the analytics ID to be
requested.
1\. Consumer of NWDAF analytics subscribe to the identified NWDAF. If the
consumer is authorized, it may include the AOG mode #2 and the definition of
sets of input data types to be collected as aggregated in the subscription.
2\. If NWDAF does not has the data necessary for generating the requested
analytics ID, NWDAF request to the NWDAFs of the lower layers responsible for
the areas of the requested analytics ID, the aggregated data from such level.
The request for further NWDAFs includes the AOG mode #2 that has to be used
for any further NWDAF-to-NWDAF interactions for the analytics IDs generation.
3\. (a,b) The process of requesting collected data from lower levels of NWDAF
is recursively performed (if the NWDAF does not has the data in the area
required in the received request from an upper level NWDAF) until reaching the
lower level NWDAFs.
4\. The NWDAFs co-located with 5GC NF in lower levels send their respective
aggregated data to the upper level NWDAF.
5\. (a,b) If there are several middle layer, each NWDAF in a middle layer that
receive a request from an upper layer will aggregated its data (including
aggregated data from lower levels) and send such aggregated data.
6\. The NWDAF that received the request from the consumer will receive the
aggregated data from all NWDAFs necessary for the analytics calculation and
will generate the analytics based on such aggregated data.
7\. NWDAF that received the request for analytics generation notifies the
consumer of such analytics.
#### 6.17.2.3 Interaction Mode#3: Composed/Aggregated Analytics ID
The analytics ID generation is a result of the composition of multiple
analytics outputs of the NWDAFs for the area of interested required by the
consumer of the analytics ID. The NWDAF that received the consumer request is
the upper NWDAF in the hierarch that can coordinate with the lower level
NWDAFs covering the required areas. The upper NWDAFs is responsible for
subscribing to all NWDAFs involved in the process of generation of the request
analytics, receive the multiple analytics outputs from the NWDAFs and compose,
i.e, aggregate the multiple analytics outputs into a single analytics output
to be sent to the consumer that requested the analytics ID. The NWDAF that
received the consumer request identifies the AOG mode #3 has to used for
interactions with NWDAFs for the generation of the requested analytics ID.
NOTE: For simplicity the figure shows only the case when the proper NWDAF
identified by NRF is the Top Level NWDAF. However, a consumer can interact
directly with any NWDAF of the hierarchy as long as such NWDAF is the proper
NWDAF identified by NRF.
Figure 6.17.2.3-1: Procedures for analytics generation based on Interaction
Mode #3
0\. Consumer of NWDAF analytics interacts with NRF to discover the proper
NWDAF instance covering the requested area of the analytics ID to be
requested.
1\. Consumer of NWDAF analytics subscribe to the identified NWDAF. If the
consumer is authorized, it may include the AOG mode #3 in the subscription.
2\. NWDAF identifies that subscription involves multiple NWDAFs in the lower
branches of the hierarchy, if NWDAF is not in the lower level (i.e. co-located
with 5GC NF). NWDAF subscribe with the same analytics ID to NWDAFs in the
levels below associated with the area of the requested analytics ID by the
consumer. The request for further NWDAFs includes the AOG mode #3, that has be
used for any further NWDAF-to-NWDAF interactions for the analytics IDs
generation.
3\. (a,b) The process of requesting the same analytics ID to lower level of
the hierarchy is recursively performed until reaching the lower level NWDAFs
co-located with 5GC NF or middle NWDAFs that can direct generate the analytics
ID. The middle level NWDAF receives the notification of the analytics IDs from
the lower level NWDAFs
4\. The middle level NWDAFs aggregate the received analytics IDs into a single
analytics ID.
5\. Middle level NWDAF(s) notify/respond notify the upper level NWDAF that
requested such analytics ID.
6\. The NWDAF that received the request from the consumer will receive the
multiple analytics IDs from the NWDAFs, and aggregates the multiple analytics
IDs in to a single analytics ID according to a rule configured by operators.
7\. NWDAF that received the request for analytics generation notifies the
consumer of such analytics with a single analytics output based on the
multiple received analytics outputs from NWDAFs of the lower levels of the
hierarchy.
#### 6.17.2.4 Interaction Mode#4: Mixed Collected Data
The analytics ID generation is performed by the NWDAF that received the
request/subscription from a consumer of analytics. The NWDAF generates such
analytics based on information collected from lower level NWDAFs via plain
data collected data request (Mode #1), and/or aggregated collected data
requests (Mode #2). The NWDAF that received the consumer request identifies
the AOG mode #4 has to used for interactions with NWDAFs for the generation of
the requested analytics ID. The NWDAF, based on operator configuration,
defines which types of data input related to the analytics ID have to be
collected using plain data collection (AOG#1) and the ones to be collected
using aggregated data (AOG#2). This information is included in the requests
that NWDAF sends to other NWDAF when AOG#4 mode is used. Operator may define
this differentiation of data collection of input data based on, for instance,
analytics ID, type of input data, or per consumer of analytics ID.
NOTE: For simplicity the figure shows only the case when the proper NWDAF
identified by NRF is the Top Level NWDAF. However, a consumer can interact
directly with any NWDAF of the hierarchy as long as such NWDAF is the proper
NWDAF identified by NRF.
Figure 6.17.2.4-1: Procedures for analytics generation based on Interaction
Mode #4
0\. Consumer of NWDAF analytics interacts with NRF to discover the proper
NWDAF instance covering the requested area of the analytics ID to be
requested.
1\. Consumer of NWDAF analytics subscribe to the identified NWDAF. If the
consumer is authorized, it may include the AOG mode #4 and the definition of
sets of input data types to be collected as plain or aggregated in the
subscription.
2\. If NWDAF does not has the data necessary for generating the requested
analytics ID, NWDAF request to the NWDAFs of the lower layers responsible for
the areas of the requested analytics ID, the collected and/or aggregated data
from such level, according with the definition of how the types of input data
should be collected, i.e., as plain data (AOG#1) or aggregated data (AOG#2).
The request for further NWDAFs includes the AOG mode #4 and the definition of
sets of input data types to be collected as plain or aggregated. Such
information has be used for any further NWDAF-to-NWDAF interactions for the
analytics IDs generation.
3\. (a,b) The process of requesting collected data from lower levels of NWDAF
is recursively performed (if the NWDAF does not has the data in the area
required in the received request from an upper level NWDAF) until reaching the
lower level NWDAFs or middle NWDAFs that directly collect from NFs/OAM.
4\. (a) The NWDAFs in lower levels send to the upper level NWDAF their
collected data according with the indication of using plain or aggregation for
each type of requested input data.
(b) NF/OAM send their plain collected data to the requesting NWDAF.
5\. (a,b) If there are several middle layer, each NWDAF in a middle layer that
receive a request from an upper layer will prepare the data (aggregating data
from lower levels and/or related collected data NF/OAMs if required per type
of requested input data) and send such prepared data to the NWDAF at the upper
level that requested it.
6\. The NWDAF that received the request from the consumer will receive the
requested data from all NWDAFs necessary for the analytics calculation and
will generate the analytics based on such received data.
7\. NWDAF that received the request for analytics generation notifies the
consumer of such analytics.
### 6.17.3 Impacts on services, entities and interfaces
NF:
\- Authorization to use AOG modes according with operator configuration.
NWDAF:
\- Extensions of NWDAF configuration and NWDAF subscription services to allow
proper interactions among NWDAFs for analytics generation.
\- Definition of new NWDAF service to support interactions related to data
collection (not analytics consumption) among NWDAFs.
NRF:
\- Identify the lowest possible NWDAF in the hierarchy able to be the entry
point for a consumer of analytics ID.
## 6.18 Solution #18: Roles and inter-NWDAF instance cooperation from upper
level NWDAF to lower level NWDAF in hierarchical architecture
### 6.18.1 Description
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
Multiple NWDAF instances can be cooperated with each other in a hierarchical
architecture to support different roles and functionalities. Example of NWDAF
role and hierarchy can be identified based on the Serving area such as NWDAF
instances are configured with the information of the NWDAF Serving Area. A
requirement of the hierarchical NWDAF architecture is inter-NWDAF instance
cooperation, in particular, mechanisms for efficient data collection to
coordinate between NWDAF instances in different hierarchies.
For example, in the hierarchical architecture, the lower-tier NWDAF instances
may offer data collection requests or subscriptions to the higher-tier NWDAF.
The higher-tier NWDAF can request or subscribe data from different source NFs
or NWDAFs on behalf of multiple NWDAF instances and distribute data to
multiple NWDAF instances. The data collection requests or subscriptions refers
to the data to be collected from source NFs or the aggregated data or the
analytics data to be collected from other NWDAF instances in different
hierarchies.
### 6.18.2 Procedure
The NWDAF instances in hierarchical architecture are categorized as top level,
middle level and lower level. Nevertheless, this is just an example of
3-levels of hierarchy deployment and the solution can support N-levels of
hierarchy. In each level one or more NWDAF instance is able to coordinate the
triggering of data collection in its associated lower level by providing
mechanisms for efficient data collection. Optionally, the NWDAF instances are
configured with the role of Data Collection Coordination (DCC) functionality.
The procedure of different cases of inter-NWDAF instance cooperation in
hierarchical architecture to coordinate data collection is presented from
Figure 6.18.2.1-1, Figure 6.18.2.2-1 and Figure 6.18.2.3-1 below.
The discovery of NWDAFs in the different levels of the hierarchy shall be
based on NWDAF Serving area and analytics IDs information exposed in NWDAF NF
Profile. Every NWDAF is configured by the operator with the hierarchy
information. The hierarchy information defines: a) the whole hierarchy
architecture in terms of list of TAs belonging to each level of the hierarchy;
b) the level of the hierarchy associated with the configured NWDAF also in
terms of list of TAs, which in turn is equivalent to NWDAF serving area. Based
on the hierarchy information, an NWDAF in a level of the hierarchy interacts
with NRF to discover the NWDAFs associated with upper and lower levels of the
hierarchy. When interacting with NRF, an NWDAF retrieves the discovered NWDAF
profiles and using the NWDAF serving area information available in such
profiles, the NWDAF is able to map each the discovered NWDAF to the levels and
branches of the hierarchy architecture.
NOTE 1: The configuration of the hierarchy architecture, i.e., list of TAs per
level of the hierarchy can be changed by operator. NWDAF shall be configured
to trigger further interactions with NRF upon any change in hierarchy
architecture.
NOTE 2: The NWDAFs association with the level of the hierarchy architecture
can change even if the whole hierarchy architecture (i.e., list of TAs per
levels of hierarchy) does not change. For instance, the operator might change
the NWDAF serving area of an NWDAF, and therefore, change the level (or
branch) of such NWDAF in the hierarchy architecture. NWDAF shall be configured
to trigger further interactions with NRF upon any change in its configuration
of NWDAF serving area.
In hierarchical NWDAF architecture, each NWDAF in the different levels of the
hierarchy may consider to use local mapping of subscriptions to coordinate the
data collection. For example, an Analytics instance ID which is a local unique
ID (e.g., a combination of Analytics ID and Analytics filter information) can
be used for the mapping of the subscription for same analytics ID from
different consumers into a single process of analytics output generation,
whereas Event instance ID which is a local unique ID (e.g., a combination of
Event ID and Event filter information) used for the mapping of subscriptions
to the same data to be collected from the same data source with one or more
analytics instance IDs. If the NWDAF in one level of the hierarchy receives a
new Analytics subscription request to Analytics ID, the NWDAF only creates an
Analytics Instance ID, if no existing Analytics Instance ID can support the
new Analytics subscription request. For example, a new Analytics subscription
request with the same Analytics filter information is already subscribed by
one Analytics consumer and an Analytics Instance ID is already created, the
new Analytics subscription request can be mapped with the existing Analytics
Instance ID. The same concept is applied to the Event instance ID(s) for the
subscription/request of data collection. If a new Analytics Instance ID is
created by a NWDAF, the NWDAF only creates new Event Instance ID(s) if the
existing Event Instance IDs cannot be used.
#### 6.18.2.1 Case 1: Inter-NWDAF instance cooperation in hierarchical
architecture
Figure 6.18.2.1-1: Case 1: Procedure for inter-NWDAF instance cooperation in
hierarchical architecture
1\. NWDAF instances are configured with the role, e.g. the information of the
NWDAF Serving Area of its own tier, as well as the NWDAF serving areas in its
associated lower tiers.
2\. An Analytics consumer requests to the NWDAF in a tier n (e.g, top level)
for an Analytics subscription request.
3a. The top level NWDAF is configured with mechanisms for efficient data
collection. To coordinate the data collection, the top level NWDAF generates
the local mapping of an identification of a subscription to an Analytics IDs
and the data to be collected from data source NFs. The mapping can be
generated based on the identification of subscription to an Analytics IDs from
step 2 and the list of identification of triggered data to be collected for
such Analytics ID generation at other NWDAFs, NFs, AFs, and OAM. Then the top
level NWDAF determines, based on the association information, if there an
existing subscription to the same analytics ID had already triggered the
subscription or request of the same data.
3b. If there an existing subscription to the same analytics ID had already
triggered for the data collection, the top level NWDAF sends Analytics output
to the Analytics consumer, based on the collected data.
#### 6.18.2.2 Case 2: Inter-NWDAF instance cooperation in hierarchical
architecture
Figure 6.18.2.2-1: Case 2: Procedure for inter-NWDAF instance cooperation in
hierarchical architecture
1-3a. Same as steps (1-3a) in Figure 6.18.2.1-1.
3b. If the triggered of data collection for the subscription request is not
available, the top level NWDAF sends the request for data collection to the
NWDAF in the middle level, that has DCC functionality.
4a. The middle level NWDAF creates and check the mapping of an identification
of a subscription request and the list of identification of triggered of data
to be collected according to step 3a in Figure 6.18.2.1-1.
4b. If an existing subscription to the same request ID had already triggered
the data collection, the middle level NWDAF sends the request data to the top
level NWDAF.
4c. The top level NWDAF sends Analytics output to the Analytics consumer,
based on the collected data.
#### 6.18.2.3 Case 3: Inter-NWDAF instance cooperation in hierarchical
architecture
Figure 6.18.2.3-1: Case 3: Procedure for inter-NWDAF instance cooperation in
hierarchical architecture
1-4a. Same as steps (1-4a) in Figure 6.18.2.2-1.
4b. If the triggered of data collection for the subscription request is not
available, the middle level NWDAF sends the request for data collection to the
NWDAF in the lower level, that has DCC functionality.
4c. If the triggered of data collection for the subscription request requires
a new data subscription from the data source, e.g. NF, the middle level NWDAF
sends the subscription request for collected data from NF.
5a. After receiving the request from step 4b, the lower level NWDAF creates
and check the mapping of an identification of a subscription request and the
list of identification of triggered of data to be collected according to step
3a in Figure 6.18.2.1-1.
5b. If an existing subscription to the same request ID had already triggered
the data collection, the lower level NWDAF sends the request data to the
middle level NWDAF as per step 4b. In a similar way, the requested data as per
step 4c is sent to the middle level NWDAF by the data source, NF.
5c. The collected data is sent to the requested NWDAF, the top level NWDAF.
5d. The top level NWDAF sends Analytics output to the Analytics consumer,
based on the collected data from middle level NWDAF.
### 6.18.3 Impacts on services, entities and interfaces
NWDAF:
\- Inter-coordination of NWDAF instances in different hierarchies and
mechanisms to support DCC functionalities in hierarchical architecture.
\- Local mapping mechanisms to coordinate data collection with NWDAF instances
in different hierarchies, e.g., using new parameters of Analytics instance ID
and Event instance ID.
\- New NWDAF services to expose collected data (not analytics output) between
NWDAF instances in different levels of hierarchies.
\- Definition of hierarchy information containing: a) the whole hierarchy
architecture in terms of list of TAs belonging to each level of the hierarchy;
b) the level of the hierarchy associated with the configured NWDAF also in
terms of list of TAs.
## 6.19 Solution #19: **_Multiple NWDAFs interactions for analytics
consumption and composition related to large areas_**
### 6.19.1 High-level Description
This clause describes a solution for KI#2 for enhancing interactions among
NWDAFs to support composition of a single analytics for a large area of
interest with baseline parameters.
The core of this solution is to propose the usage of the proper
parametrization for the generation of analytics IDs of the same type that need
to be aggregated into a single analytics ID output. Therefore, this solution
proposes the usage of baseline parameters parametrization for the subscription
of analytics ID of the same type into the multiple required NWDAFs.
The proposed baseline parameters are relevant for NWDAFs interactions because
they assure the usage of the same statistical properties and output strategy
among the multiple NWDAFs required to aggregate multiple analytics IDs of the
same type into a single analytics ID output.
This solution also considers that the aggregation of analytics IDs can happen
following two situations:
\- NWDAF as a central point for aggregation (Option A): assumes that NWDAFs
are the entities in the system capable to compose or aggregate a single
analytics output based on the multiple analytics outputs of the same type.
\- NWDAF and/or NFs can perform analytics aggregation (Option B): operator may
decide to allow certain NFs, such as NEF, to operate also with the capability
to compose or aggregate analytics IDs outputs of the same type. In this case,
both NWDAFs and allowed NFs have the capability to aggregate analytics IDs.
The NWDAF or NFs with such capability are configured with the composition rule
that defines the aggregation function to compose the fields of multiple
analytics outputs of the same analytics type into a single analytics output
that is provided to an analytics consumer.
NWDAFs or NFs are also configured with the baseline parameters allowed per
type of analytics type (i.e. analytics IDs). The baseline parameters are:
\- Dataset statistical properties: parameter that defines requirements for the
selection and preparation of the collected data (e.g. balanced datasets -
uniformly distributed samples in labels of predictions) or processes (e.g.
**time dependent weights, covariance**) to be used for the analytics
generation. This parameter guarantees that all NWDAFs involved in the
generation of a single analytics output will have data samples treated with
the same statistical requirements. This can reduce the chances of
discrepancies that can lead consumer of the single analytics ID to suboptimal
decisions.
\- Output strategy: parameter that defines when an analytics output will be
sent to a consumer enabling a synchronization on the output generated by
multiple NWDAFs. Two output strategies are defined:
\- Binary output strategy: analytics output will be sent to the consumer only
when the preferred level of accuracy is reached before the time deadline, both
indicated in the subscription and any periodicity in the analytics reporting
mode is ignored until the level of accuracy is reached, in the case of a first
notification.
\- Gradient output strategy: analytics output will be sent to the consumer
following the periodicity indicated in the analytics reporting information
included in the subscription regardless if the requested level of accuracy has
been reached. In this new output strategy mode, the periodicity in analytics
reporting information has precedence over the level of accuracy. NWDAF
includes in the output sent to the consumer the level of accuracy reached for
the specific notification for a cycle of the periodicity.
The proposed baseline parameters are relevant for NFs consumers because of the
following reasons:
\- NF consumers of NWDAF may use the dataset statistical properties
information in order to influence the data selection mechanisms to be used for
the generation of an analytics IDs. This parameter allows NF consumers of
analytics ID to have assurances that the generated analytics ID reflects the
statistical characteristics of the data that are relevant for the consumer in
all different NWDAFs involved in the analytics generation;
\- The output strategy allows NF consumers of NWDAF to indicate via binary or
gradient options how NWDAFs handle the relationship among: \"preferred level
of accuracy of the analytics\" as listed in TS 23.288 [5] clause 6.1.3; the
parameter \"time when analytics information is needed\" as listed in TS 23.288
[5] clause 6.1.3; the \"periodic reporting mode in an Analytics Reporting
Information\" as listed in TS 23.288 [5] clause 6.1.3; and the availability of
data as listed in TS 23.288 [5] clause 6.2.1. If preferred level of accuracy
is more important than providing an output, the binary strategy is used in the
aggregation of the analytics ID outputs to guarantee that all analytics
outputs have equivalent confidence in the prediction. If having an analytics
output is more important than reaching the preferred level of accuracy, then
all NWDAFs involved in the aggregation of a single analytics ID output must
operate with the gradient output strategy and timely provide the output
indicating the level of accuracy at the moment of the output generation.
### 6.19.2 Procedure for NWDAF Interactions
#### 6.19.2.1 Procedure for NWDAF as Central Aggregation Point
The procedure in Figure 6.19.2.1-1 illustrate the enhanced mechanisms for
NWDAF interactions for analytics generation targeting large areas, when only
NWDAFs can aggregate analytics IDs output of the same type into a single
analytics ID output. This possibility is regarded as option A..
Figure 6.19.2.1-1: (Option A) NWDAF interactions for single analytics output
generation for large areas of interest
1\. NF Consumer determines the proper NWDAF to subscribe for the required
analytics ID covering the entire area of interest based on NRF discovery.
NOTE 1: The determination of the proper NWDAF is out of the scope of this
solution.
2\. NF Consumer subscribes to determined NWDAF capable of composing the single
analytics output (e.g.NWDAF#1), including in the subscription, the analytics
ID, analytics filter information the whole area of interest for the required
analytics ID (e.g. AoI = A,B), analytics reporting information, level of
accuracy and the output strategy. The NF consumer may include the dataset
statistical properties in case it wants to influence the dataset selection
mechanisms for the analytics ID generation.
3\. Based on the received request/subscription NWDAF#1 identifies the need for
interaction with other NWDAF instances. NWDAF#1 determines the proper NWDAFs
serving the areas it needs to aggregate the multiple analytics IDs outputs of
the same type into a single analytics ID output based on NRF discovery.
4\. NWDAF#1 triggers the analytics generation in its serving area. Based on
the composition rule, NWDAF#1 associates the requested analytics ID by the
Consumer, the local analytics output to be generated, and the identification
of the further NWDAFs require to properly cover the requested area of interest
from the NF consumer.
5\. NWDAF#1 subscribes/requests to the further identified NWDAFs (e.g.
NWDAF#2) with the same analytics ID, analytics reporting information, level of
accuracy. If the NF consumer provided the dataset statistical properties, and
output strategy , the NWDAF uses the same parameters from the original NF
consumer request into the request to the identified NWDAFs. If the NF consumer
did not provide the baseline parameters, the NWDAF determines the baseline
parameters that it needs to use for the interactions with other NWDAF. With
the confirmation of the subscription/request to the further NWDAFs, NWDAF#1
further associated the subscription identification of each requested analytics
ID to the composition rule.
6\. (a,b) Each further NWDAF (e.g. NWDAF#2) generates its analytics output
according with the requested/subscribed parameters and sends the analytics
output to the NWDAF#1.
7\. NWDAF#1 generates the single analytics output according with the
composition rule, based on local generated analytics output at NWDAF#1 and all
received analytics outputs from the further NWDAFs (e.g. NWDAF#2).
8\. NWDAF#1 send the notification/response to the NF Consumer with a single
analytics output generated based on the composition rule.
NOTE: Steps 3-8 are recursive and may be further executed by any NWDAF (e.g.,
NWDAF#2) that receive a subscription/request for analytics ID and requires
interactions with other NWDAFs.
#### 6.19.2.2 Procedure for Mixed Aggregation Points
The procedure in Figure 6.19.2.2-1 illustrate the enhanced mechanisms for
NWDAF interactions for analytics generation targeting large areas when both
NWDAFs or NF consumers can aggregate analytics IDs output of the same type
into a single analytics ID output.
Figure 6.19.2.2-1: (Option B) Interactions for single analytics output
generation for large areas of interest
1\. NF Consumer determines the proper NWDAF(s) to subscribe for the required
analytics ID covering the entire area of interest based on NRF discovery.
NOTE 1: The determination of the proper NWDAF is out of the scope of this
solution.
2\. If the NF Consumer is not allowed to aggregated analytics ID,NF Consumer
subscribes to the determined NWDAF capable of composing the single analytics
output (e.g.NWDAF#1), including in the subscription, the analytics ID,
analytics filter information the whole area of interest for the required
analytics ID (e.g. AoI = A,B), analytics reporting information, level of
accuracy and the output strategy. The NF consumer may include the dataset
statistical properties in case it wants to influence the dataset selection
mechanisms for the analytics ID generation.
In case the NF Consumer is allowed by operator to perform the aggregation of
analytics IDs, the NF consumer sends the request for analytics IDs for all the
discovered NWDAF using the same analytics ID, analytics reporting information,
level of accuracy, output strategy and baseline parameters to all NWDAFs. The
analytics filter may be specific to the areas covered by each NWDAF. Based on
the composition rule, NF consumer associates the required analytics ID to each
subscription correlation ID from the required NWDAF.
NOTE 2: Steps 3 - 5 are skipped if NF consumer is allowed to aggregate
multiple analytics ID outputs into a single analytics output.
3\. Based on the received request/subscription NWDAF#1 identifies the need for
interaction with other NWDAF instances. NWDAF#1 determines the proper NWDAFs
serving the areas it needs to aggregate the multiple analytics IDs outputs of
the same type into a single analytics ID output based on NRF discovery.
4\. NWDAF#1 triggers the analytics generation in its serving area. Based on
the composition rule, NWDAF#1 associates the requested analytics ID by the
Consumer, the local analytics output to be generated, and the identification
of the further NWDAFs require to properly cover the requested area of interest
from the NF consumer.
5\. NWDAF#1 subscribes/requests to the further identified NWDAFs (e.g.
NWDAF#2) with the same analytics ID, analytics reporting information, level of
accuracy. If the NF consumer provided the dataset statistical properties, and
output strategy , the NWDAF uses the same parameters from the original NF
consumer request into the request to the identified NWDAFs. If the NF consumer
did not provide the baseline parameters, the NWDAF determines the baseline
parameters that need to be used for the interactions with other NWDAF. With
the confirmation of the subscription/request to the further NWDAFs, NWDAF#1
further associated the subscription identification of each requested analytics
ID to the composition rule.
6\. (a,b) Each NWDAF (e.g. NWDAF#2) generates its analytics output according
with the requested/subscribed parameters and sends the analytics output to the
requester of such analytics ID (NWDAF#1, or NF consumer if allowed to
aggregate analytics ID).In case NF consumer if allowed to aggregate analytics
ID, the NWDAF#1 in the procedure of Figure 6.19.2-1 also sends its generated
analytics ID to the NF Consumer.
7\. NWDAF#1 generates the single analytics output according with the
composition rule, based on local generated analytics output at NWDAF#1 and all
received analytics outputs from the further NWDAFs (e.g. NWDAF#2).
In case the NF consumers are allowed to aggregate analytics IDs, the
aggregation in Step 7 is then executed by the NF consumer. The NF consumer
generates the single analytics output according with the composition rule
based on all analytics outputs received from the NWDAFs (e.g., NWDAF #1, and
NWDAF #2).
NOTE 3: In case the NF consumers are allowed to aggregate analytics IDs, step
8 is skipped.
8\. NWDAF#1 send the notification/response to the NF Consumer with a single
analytics output generated based on the composition rule.
NOTE 4: In case of only NWDAFs are allowed to aggregate analytics IDs, Steps
3-8 are recursive and may be further executed by any NWDAF (e.g., NWDAF#2)
that receive a subscription/request for analytics ID and requires interactions
with other NWDAFs.
### 6.19.3 Impacts on services, entities and interfaces
NWDAF:
\- Extension of services to support the new input parameters: dataset
statistical properties and output strategy.
\- Extension of NWDAF capabilities to generate a single analytics output based
on multiple analytics.
NFs:
\- If allowed by operator to aggregate analytics IDs, extension of
capabilities generate a single analytics output based on multiple analytics.
## 6.20 Solution #20: UE abnormal behaviour analytics interaction between
multiple NWDAF instances
### 6.20.1 Description
This solution is proposed to address Key Issue #2: Multiple NWDAF instances.
This contribution focus on the aspects of how analytics generation can be
enhanced in multiple NWDAFs case, e.g. whether NWDAFs can cooperate with each
other.
When multiple NWDAFs exist, not all of them need to be able to provide the
same type of analytics results and some specific NWDAF instance(s) could
support certain types of analytics, which are identified by analytics IDs.
However, no specific requirement has been defined regarding how different
NWDAFs could cooperate, i.e. in Rel-16 each NWDAF acts independently from the
other NWDAFs.
One NWDAF in one network may provide the specific type of analytics e.g. UE
abnormal behaviour analytics, which may be useful for other NWDAF(s) e.g. to
generate analytics generation.
### 6.20.2 Procedures
Figure 6.20.2-1: Procedure for UE abnormal behaviour analytics interaction
between multiple NWDAF(s)
1-2. The NF sends Nnwdaf_AnalyticsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request to the NWDAF1 responsible for a certain Analytics
ID and the NWDAF1 sends Nnwdaf_AnalyticsSubscription_Notify.
3\. Procedure for UE abnormal behaviour identification and analytics
generation in the NWDAF2 for Abnormal behaviour analytics.
4-5. The NWDAF1 responsible for the certain Analytics ID sends
Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request
(Analytics ID=\"UE abnormal behaviour\") to the NWDAF2 responsible for
Abnormal behaviour analytics and the NWDAF2 sends
Nnwdaf_AnalyticsSubscription_Notify.
The NWDAF2 provides the abnormal UE list and the observed time window to the
NWDAF 1, indicating the time window of the abnormal behaviour analytics.
6-7. Based on the observed time window for the abnormal behaviour analytics,
the NWDAF1 figures out when the abnormal situation occurs and when the
abnormal situation is resolved.
The NWDAF1 may train a new model and generate a new analytics for the certain
Analytics ID, and provides the updated analytics and/or corresponding validity
period to the analytics consumer.
### 6.20.3 Impacts on services, entities and interfaces
NWDAF for UE abnormal behaviour analytics as an analytics provider:
\- Provides the observed time window of the abnormal behaviour analytics,
indicating the time window of the abnormal behaviour analytics.
NWDAF for other analytics as an analytics consumer:
\- Obtain the abnormal UE list and related abnormal behaviour analytics with
the observed time window from NWDAF for UE abnormal behaviour analytics;
\- Based on UE abnormal behaviour analytics, figures out when the abnormal
situation occurs and when the abnormal situation is resolved;
\- Trains a new model and generates a new analytics for the certain Analytics
ID, and provides the updated analytics and corresponding validity period to
the analytics consumer.
## 6.21 Solution #21: Inter-NWDAF instance cooperation based on NWDAF profile
### 6.21.1 Description
#### 6.21.1.1 General
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
NWDAF instance may co-locate with 5GC NFs or be a logic component of 5GC NF
instance. The NWDAF instance may collect and process the raw data from the 5GC
NFs. The co-locating NWDAF instance provides processed data on behalf of the
5GC NFs when other NWDAF instances collect data from the 5GC NFs. The
processed data is comparable to raw data, which means the NWDAF collocated
with NG can pre-process the data e.g. data aggregation.
The 5GC NF co-locating with NWDAF instance adds NF instance ID into the NWDAF
profile and registers to NRF.
NWDAF instance queries NRF the profiles of other NWDAF instances. Based on the
profiles, it finds other NWDAF instances providing processed data of 5GC NFs
for analytics.
#### 6.21.1.2 Procedures
Figure 6.21.1.2-1: Procedures for cooperation between NWDAF instances
1\. The NWDAF queries NRF and gets the profiles of other NWDAF instances.
Based on the NF instance ID in the profile, The NWDAF gets the information
that which NWDAF instance is able to provide processed data on behalf of which
NF.
2\. The NWDAF service consumer subscribes to or requests analytics information
by invoking the Nnwdaf_AnalyticsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request service operation towards NWDAF 1.
3\. NWDAF 1 decides the required data to be collected according to the request
Analytics ID. Because according to the NWDAF profile 5GC NF co-locates with
NWDAF 2, NWDAF 1 requests NWDAF 2 to provide processed data on behalf of 5GC
NF.
4\. The NWDAF 2 provides processed data to the NWDAF 1 by
Nnwdaf_ProcessedData_Response or Nnwdaf_ProcessedData_Notify service
operation.
5\. NWDAF 1 may collect other required data from other NF, AF, or OAM.
6\. NWDAF 1 provides the analytics information to the NWDAF service consumer
by invoking Nnwdaf_AnalyticsSubscription_Notify or
Nnwdaf_AnalyticsInfo_Response service operation.
### 6.21.2 Impacts on services, entities and interfaces
NWDAF:
\- In NWDAF profile, add instance ID of 5GC NF co-locating with NWDAF
instance.
\- NWDAF supports to provide processed data on behalf of co-locating 5GC NFs.
\- NWDAF supports to query NRF and gets the profiles of other NWDAF instances.
\- Based on the profile, NWDAF finds other NWDAF instances providing processed
data of 5GC NFs.
\- NWDAF supports to collect processed data of 5GC NFs from other NWDAF
instances for analytics.
NRF:
\- NRF supports to provide NWDAF profiles for other NWDAF instance discovery.
## 6.22 Solution #22: mitigation of the load for Data Collection
### 6.22.1 Description
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
There may be multiple NWDAF instances deployed in the same PLMN and such NWDAF
instances may request same data from same NFs, thus it is unnecessary for an
NF to report duplicated data to all such NWDAFs.
In order to avoid different NWDAF instances to collect same data for different
analysis purposes, a NWDAF which is responsible for data collection and data
storage is introduced into the 5GC. As data collected from OAM/NFs is stored
in this specific NWDAF with data storage function (called NWDAFdsf), any
authorized NWDAF instance can interact with this NWDAFdsf to retrieve the
cached data. By this way, the signalling load for same data collection can be
mitigated. The following Figure 6.22.1-1 shows the data collection
architecture supporting NWDAFdsf.
Figure 6.22.1-1: Data collection architecture supporting NWDAFdsf
NOTE: As NWDAFs in a PLMN may be deployed in same/different operator\'s data
centers, there may be multiple NWDAFdsf deployed in a PLMN, e.g. each per data
center.
The main functionalities of the NWDAFdsf include:
\- Data collection from 5GC NFs;
\- Caching the collected data;
\- Exposure of the cached data to authorized NWDAF instance.
### 6.22.2 Procedures
Figure 6.22.2-1: Data collection with the help of NWDAFdsf
1\. When a NWDAF needs to collect network data from NFs, it invokes
Nnwdaf_EventExposure_Subscribe (NF ID, Event ID, Target of Event Reporting) to
retrieve data from the NWDAFdsf instead of sending request to the NFs
directly.
2\. The NWDAFdsf may reject the subscription request if the NWDAF is not
allowed to retrieve data from the NWDAdsf. In this case, the NWDAF may need to
collect data from the NFs directly.
If the NWDAFdsf has no related network data, it invokes
Nnf_EventExposure_Subscribe (NF ID, Event ID, Target of Event Reporting) to
collect the data from the NFs identified by the NF ID.
3\. The NWDAFdsf receives and caches the data reported by the NFs.
4\. The NWDAFdsf notifies the NWDAF 1 of the requested data.
5\. Another NWDAF (e.g. NWDAF 2) may request collection for same data from the
NWDAFdsf.
6\. As the same data has been cached in the NWDAFdsf, the NWDAFdsf can
directly respond the NWDAF 2 with the cached data.
7\. The NWDAF 1 can send unsubscribe request to the NWDAFdsf if current data
collection is not needed any longer.
8\. Other NWDAFs may also unsubscribe network data from the NWDAFdsf.
9\. If all NWDAFs subscribing same data collection unsubscribe from the
NWDAFdsf, the NWDAFdsf can send Nnf_EventExposure_unSubscribe to the related
NFs. It is up to NWDAFdsf implementation to handle the cached data, e.g. the
NWDAFdsf drops the cached data if it has no enough storage or the cached data
becomes invalid.
### 6.22.3 Impacts on services, entities and interfaces
## 6.23 Solution #23: flexible data collection and data analysis for
hierarchical NWDAF architecture
### 6.23.1 Description
This solution is proposed for Key Issue 2: Multiple NWDAF instances.
In case multiple NWDAFs are deployed, these NWDAFs may provide the same
Analytics ID(s) or different Analytics ID(s) and be deployed in different
service area or same service area. The NWDAF may organize other NWDAF(s) that
support the same Analytics ID(s) to provide the request analytics. The NWDAF
may organize other NWDAF(s) to provide data collection whose service area
overlap the NWDAF interesting area.
To support the multiple NWDAF(s) flexible deployment (e.g. per NF instance,
per NF set, per slice etc.), the NWDAF service area information may be NF
instance ID(s) or NF set ID(s) or S-NSSAI(s). In this case, the NWDAF seems to
be associated with NF instance(s) or NF set(s) or slice(s).
To support the multiple NWDAF(s) flexible deployment, the NWDAF instance may
only support function of data collection and data exposure.
### 6.23.2 Procedures
#### 6.23.2.1 Procedure of multi-NWDAFs assisted analytics and data collection
Figure 6.23.2.1-1: Procedure of multi-NWDAFs assisted analytics
It is assumed that index (k) shows the NWDAF instance ID in a multi-instance
deployment. Each NWDAF(k) services the target area of the NWDAF interesting
and/or has overlapping Analytics ID(s) with NWDAF.
1\. NWDAF service consumer subscribes/requests to the identified NWDAF
including Analytics ID(s).
2\. The NWDAF decides which data should be collected per Analytics ID(s) and
from which NF instance(s) the data should be collected according to
information (e.g. Area of Interesting or UE related or specified NF(s) etc.)
receiving from the consumer request.
If the NF instance(s) is in the service area of NWDAF, the NWDAF may collect
data directly as specified in TS 23.288 [5].
If the NWDAF needs the help of other NWDAF(s), the NWDAF obtains the NWDAF(k)
who is serving the NF instance(s) as step 2a. The NWDAF sends
subscribes/requests to the NWDAF(k) including the Analytics ID(s) and NF ID(s)
as step 2b. If the NWDAF derives the analytics itself, the NWDAF sends data
collection request to the NWDAF(k) including NF ID(s) and data that the NWDAF
request as step 2c.
3\. The NWDAF(k) collects data from the requested NF ID(s) and/or derives
analytics information that requested Analytics ID(s).
4\. The NWDAF(k) notifies/responses the collection data or analytics
information.
5\. The NWDAF composes analytics information according to the collection data
or analytics information from NWDAF(k).
6\. The NWDAF notifies/responses analytics information to consumer.
### 6.23.3 Impacts on services, entities and interfaces
No impact on current services, entities and interfaces, except:
\- NWDAF supports data collection exposure;
\- NWDAF service area may be defined as NF ID(s) or set of NF ID(s) or
slice(s).
## 6.24 Solution #24: Federated Learning among Multiple NWDAF Instances
### 6.24.1 Description
This is a solution for the Key Issue#2: Multiple NWDAF instances and Key Issue
#19: Trained data model sharing between multiple NWDAF instances.
#### 6.24.1.1 General
As shown in Figure 6.24.1.1-1, multiple NWDAF will be deployed in a big PLMN,
so maybe it is difficult for NWDAF to centralize all the raw data that are
distributed in different Areas. However, it is desired or reasonable for the
NWDAF distributed in an Area to share its model or data analytics with others
NWDAFs.
Figure 6.24.1.1-1: Hierarchical NWDAF deployment in a PLMN
Federated Learning (also called Federated Machine Learning) could be a
possible solution to handle the issues such as data privacy and security,
model training efficiency, and so on, in which there is no need for raw data
transferring (e.g. centralized into single NWDAF) but only need for model
sharing. For example, with multiple level NWDAF architecture, NWDAFs may be
co-located with an 5GC NF (e.g. UPF, SMF), and the raw data cannot be exposed
due to privacy concerns and performance reasons. In such case, the federated
learning will be a good way to let a Server NWDAF coordinate with multiple
localized NWDAFs to complete a machine learning.
The main idea of Federated Learning is to build machine-learning models based
on data sets that are distributed in different network functions. A Client
NWDAF (e.g. deployed in a domain or network function) locally trains the local
ML model with its own data and share it to the server NWDAF. With local ML
models from different Client NWDAFs, the Server NWDAF could aggregate them
into a global or optimal ML model or ML model parameters and send them back to
the Client NWDAFs for inference.
This solution tries to involve the idea of Federated Learning into the NWDAF-
based architecture, which aims to investigate the following aspects:
\- Registration and discovery of multiple NWDAF instances that support
Federated Learning;
\- How to share the ML models or ML model parameters during the Federated
Learning training procedure among multiple NWDAF instances.
#### 6.24.1.2 General procedure for Federated Learning among Multiple NWDAF
Instances
Figure 6.24.1.2-1: General procedure for Federated Learning among Multiple
NWDAF Instances
1-3. Client NWDAF registers its NF profile (Client NWDAF Type (see TS 23.502
[3] clause 5.2.7.2.2), Address of Client NWDAF, Support of Federated Learning
capability information, Analytics ID(s)) into NRF.
4-6. Server NWDAF discovers one or multiple Client NWDAF instances which could
be used for Federated Learning via the NRF to get IP addresses of Client NWDAF
instances by invoking the Nnrf_NFDiscovery_Request (Analytics ID, Support of
Federated Learning capability information) service operation.
It is assumed an Analytics Id is preconfigured for a type of Federated
Learning. Thus, the NRF can realize the Server NWDAF is requesting to perform
federated learning based on the pre-configuration. And the NRF responds to the
central NWDAF the IP address of multiple NWDAF instances which support the
Analytics Id.
NOTE 1： The analytic ID(s) supporting Federated Learning can be configured by
operator.
7a: Each client NWDAF communicates licensing conditions for its data and
training infrastructure to participate in the federated learning task. These
conditions can be based on policies set-up based on how sensitive the data is,
how much compute is expected to be needed to perform local training, who will
get the use the trained model, etc.
7b: Based on the response from NRF, Server NWDAF selects which NWDAF clients
will participate based on its desired license model.
7c. Server NWDAF sends a request to the selected Client NWDAFs that
participate in the Federated learning according to steps 7a and 7b including
some parameters (such as initial ML model, data type list, maximum response
time window, etc.) to help the local model training for Federated Learning.
8\. Each Client NWDAF collects its local data by using the current mechanism
in clause 6.2, TS 23.288 [5].
9\. During Federated Learning training procedure, each Client NWDAF further
trains the retrieved ML model from the server NWDAF based on its own data, and
reports the results of ML model training to the Server NWDAF, e.g. the
gradiente.
NOTE 2: Server NWDAF interacts with Client NWDAF to deliver and update the ML
model, and how to transfer the ML model and local ML model training results
are up to the conclusion of KI#19.
10\. The Server NWDAF aggregates all the local ML model training results
retrieved at step 9 such as the gradient to update the global ML model.
11\. The Server NWDAF sends the aggregated ML model information (updated ML
model) to each Client NWDAF for next ground model training.
12\. Each Client NWDAF updates its own ML model based on the aggregated model
information (updated ML model) distributed by the Server NWDAF at step 11.
NOTE 3: The steps 8-12 should be repeated until the training termination
condition (e.g. maximum number of iterations, or the result of loss function
is lower than a threshold) is reached.
After the training procedure is finished, the globally optimal ML model or ML
model parameters could be distributed to the Client NWDAFs for the inference.
#### 6.24.1.3 Procedure for usage of Federated Learning in Abnormal Behaviour
Figure 6.24.1.3-1: Procedure for usage of Federated Learning in Abnormal
Behaviour
1\. A Server NWDAF determines to train an Abnormal Classifier using the input
data defined in Table 6.7.5.2-1, TS 23.288 [5]). The Server NWDAF discovers
two Client NWDAFs i.e. Client NWDAF 1 in Area A, Client NWDAF 2 in Area B that
are participating in the license model as defined in steps 7 in figure
6.24.1.2-1.
2\. Client NWDAF 1 and Client NWDAF 2 collect raw data from SMF and AMF,
respectively. The data collection procedures from AMF and SMF are defined in
step 2-3, clause 6.7.5.4, TS 23.288 [5].
3-4. Client NWDAF 1 and Client NWDAF 2 collect Exception information from AF,
respectively. The Exception information is defined in clause 6.7.5.2, TS
23.288 [5].
Repeat from step 5-8 until the training termination condition (e.g. maximum
number of iterations) is fulfilled:
5\. During Federated Learning training procedure, based on the local raw data,
Client NWDAF 1 and Client NWDAF 2 further train the retrieved Abnormal
Classifier from the Server NWDAF, respectively.
6\. Client NWDAF 1 and Client NWDAF 2 respectively report the information of
local training results for Abnormal Classifier (e.g. volume of the local
dataset, parameters for update of the Abnormal Classifier) to the Server
NWDAF.
7\. Server NWDAF aggregates all the local training results for Abnormal
Classifier to derive the aggregated Abnormal Classifier information.
8\. Server NWDAF sends the aggregated Abnormal Classifier information to
Client NWDAF 1 and Client NWDAF 2, and then, Client NWDAF 1 and Client NWDAF 2
update the its own Abnormal Classifier based on the aggregated Abnormal
Classifier information distributed by the Server NWDAF.
After the training procedure is finished, the globally optimal Abnormal
Classifier or Abnormal Classifier parameters could be distributed to the
Client NWDAF 1 and Client NWDAF 2 as well as the new Client NWDAFs, if
requested, for the inference.
### 6.24.2 Impacts on services, entities and interfaces
NWDAF:
\- Registration into NRF;
\- New Data Analytics (i.e. new Analytics ID) for Federated Learning, which
can be configured by operator
\- As a server NWDAF,
\- Discover request to NRF with the analytics id corresponding to a federated
learning
\- Client NWDAF instances discovery;
\- Receiving licensing condition from Client NWDAF to check the Client
NWDAF\'s participation in the federated learning task;
\- Initial Federated Learning parameters determination and distribution;
\- Collection of local ML model information from the Client NWDAF instances;
\- Aggregates local model information to update ML model, e.g. for gradient
calculation, reporting to the Server NWDAF;
> \- As a Client NWDAF,
\- Receive aggregated model information (updated ML model) from Server NWDAF
and perform local ML model update.
\- Report the licensing conditions to the Server NWDAF.
NRF:
\- Server NWDAF and Client NWDAF registration and discovery.
## 6.25 Solution #25: Exposing UE mobility analytics for multiple NWDAFs case
### 6.25.1 Introduction
This solution addresses Key Issue #2: Multiple NWDAF instances.
The UE mobility information is regarded as useful information for e.g. some
certain commercial usage for deriving commercial footprint between shopping
centres.
The awareness of users who even stayed in some areas may become useful e.g.
Case 1: The AFs inside Source Area of Interest A may need to enquiry the users
who once stayed in Target Area of Interest B in target period 1 as depicted in
the below figure.
Case 2: The AFs inside Source AOI A may need to enquiry the users who once
stayed in Target AOI B in target period 1 and once stayed in Target AOI C in
target period 2 as depicted in the below figure.
Figure 6.25.1-1: UE mobility analytics provided to NF/AF
To address the above use case, the solution is to enhance the existing
mechanism of data collection and analytics generation for the scenario of
multiple NWDAFs.
### 6.25.2 Input data
Input Data is defined in Table 6.7.2.2-1, Table 6.7.2.2-2, clause 6.7.2.2, TS
23.288 [5] respectively.
### 6.25.3 Output Analytics
Output Data is defined in Table 6.7.2.3-1 and Table 6.7.2.3-2, TS 23.288 [5]
clause 6.7.2.3, TS 23.288 [5] respectively.
### 6.25.4 Procedures
Figure 6.25.4-1: Procedure for UE mobility analytics provided to NF/AF
1a. To obtain the SUPI list and their related mobility analytics, e.g. user
location and time slot, who currently stays in Source Area of Interest and
once stayed in Target Area of Interest(s) in target period(s) or not stayed in
Target Area of Interest(s) in target period(s), the NF/AF sends:
\- For case 1, an Analytics subscription or request (Analytics ID = UE
mobility, Analytics Filter information = Source AOI A, Target AOI B, Analytics
Reporting information = Analytics target period 1) to the NWDAF1 serving the
Source AOI A by Nnwdaf_AnalyticsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request.
\- For case 2, an Analytics subscription or request (Analytics ID = UE
mobility, Analytics Filter information = Source AOI A, Target AOI B, Target
AOI C, Analytics Reporting information = Analytics target period 1, Analytics
target period 2) to the NWDAF1 by Nnwdaf_AnalyticsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request.
For these untrusted NFs, the NF sends the subscription or request via a NEF,
where the NF invokes NEF service Nnef_AnalyticsExposure_Subscribe.
1b-1c. Authorization for the AF is performed in the NEF in case the NEF is
used. The NEF will then convey the request to the NWDAF1 as defined in the
clause 6.1.2.2, TS 23.288 [5].
2a-2e Upon reception of the request from the NF directly or via the NEF for
untrusted NF, the NWDAF1 may subscribe/request to events from AMF/AF/OAM for
UE location information, as the steps 2a-2e described in the clause 6.7.2.4,
TS 23.288 [5].The NWDAF figures out a candidate SUPI list who currently stays
in Source Area of Interest A.
2f-2g. For case 1, to obtain UE mobility analytics in Target Area of Interest
B and related target period 1, the NWDAF1 sends Analytics subscribe/request
(Analytics ID = UE mobility, Target of Analytics Reporting = list of SUPIs,
Analytics Filter information = Target AOI B, Analytics Reporting information =
Analytics target period 1) to the NWDAF2 serving the Target Area of Interest.
The NWDAF2 provides data analytics to the NWDAF1 including SUPI list 2 and
their related mobility analytics, who once stayed in Target Area of Interest B
in target period 1.
For case 2, besides the same interactions between NWDAF1 and NWDAF2 to obtain
SUPI list 2 and their UE mobility analytics in Target Area of Interest B and
related target period 1, in addition,to obtain SUPI list 3 and UE mobility
analytics in Target Area of Interest C and related target period 2, the NWDAF1
sends Analytics subscribe/request (Analytics ID = UE mobility, Target of
Analytics Reporting = list of SUPIs, Analytics Filter information = Target AOI
C, Analytics Reporting information = Analytics target period 2) to the NWDAF3
serving the Target Area of Interest C. The NWDAF3 provides data analytics to
the NWDAF1 including SUPI list 3 and their related mobility analytics, who
once stayed in Target Area of Interest C in target period 2.
NOTE: It is assumed that the NWDAF2 could collect data and keep for a certain
period of time, e.g. 2 weeks, which could be configured by the operators.
3\. The NWDAF1 derives requested analytics, i.e.:
\- For case 1, based on SUPI list 2 and their UE mobility analytics in Target
AOI B provided by NWDAF2 and the UE mobility analytics in Source AOI A
obtained by NWDAF1 itself, NWDAF1 derives the SUPI list and their aggregated
UE mobility analytics, who currently stay in Source AOI A and once stayed in
Target AOI B in target period 1.
\- For case 2, based on SUPI list 2 and their UE mobility analytics in Target
AOI B provided by NWDAF2, SUPI list 3 and their UE mobility analytics in
Target AOI C provided by NWDAF3, and the UE mobility analytics in Source AOI A
obtained by NWDAF1 itself, NWDAF1 derives the intersection SUPI list and their
aggregated UE mobility analytics, who currently stay in Source AOI A and once
stayed in Target AOI B in target period 1 and in Target AOI C in target period
2.
4a-4b. The NWDAF1 sends the requested UE analytics to the NF/AF. The details
for UE mobility analytics provided by the NWDAF are defined in the clause
6.7.2.3, TS 23.288 [5]. Based on the analytics provided by the NWDAF1, the
NF/AF derives the mobility related information for these UEs.
For these untrusted NFs, the NWDAF1 provides requested UE analytics to the NF
via a NEF.
### 6.25.5 Impacts on services, entities and interfaces
NWDAF:
\- For UE mobility analytics, extend the filter information of the existing
Nnwdaf_AnalyticsSubscription_Subscribe service or Nnwdaf_AnalyticsInfo_Request
service, by including a new analytic filter = Source Area of Interest and
Target Area of Interest(s), and extending Analytics Reporting information to
contain multiple Analytics target periods if necessary.
NEF:
\- For UE mobility analytics, extend the filter information of the existing
Nnef_AnalyticsExposure_Subscribe service, by including a new analytic filter =
Source Area of Interest and Target Area of Interest(s), and extending
Analytics Reporting information to contain multiple Analytics target periods
if necessary.
## 6.26 Solution #26: Reselection of NWDAF
### 6.26.1 Description
#### 6.26.1.1 General
This solution is for Key Issue #2: Multiple NWDAF instances.
In scenarios that multiple NWDAF instances are deployed in the same 5G
network, there are some cases that the serving NWDAF of a consumer NF may need
to be changed during the operation due to, e.g. UE mobility, change in NWDAF
profile, new addition or removal of NWDAF instances, etc. Upon change of a
serving NWDAF instance, it is required to inform the related consumer NF of
the event and possibly to update subscriptions between the NWDAF and the
consumer NF. The subscriptions can be renewed between the new NWDAF instance
and the consumer NF, while some of the analytics data and stored input data
can be retrieved from the previous serving NWDAF instance by the new NWDAF
instance, if applicable, to facilitate producing analytics at the new NWDAF.
The new NWDAF may provide the previous serving NWDAF with information on data
types it wants to retrieve from the previous serving NWDAF.
#### 6.26.1.2 Procedure
Figure 6.26.1.2-1: Reselection of NWDAF instance
1\. A consumer NF sends a Nnwdaf_AnalyticsSubscription_Subscribe message to
the NWDAF #1 which request subscription to the analytics data indicated by
Analytics ID, Target of Reporting and Event Reporting Information.
2\. The NWDAF#1 sends Nnf_EventExposure_Subscribe message to request
subscription of input data from the source NF.
3\. The source NF responds to the NWDAF with Nnf_EventExposure_Notify to
accept the requested subscription.
4\. The NWDAF #1 sends Nnwdaf_AnalyticsSubscription_Notify to the consumer NF
to inform that the requested subscription has been accepted.
5\. The NWDAF #1 decides reselection of NWDAF instance, based on, e.g. UE
mobility (event notification from AMF), change in NWDAF profile (e.g. change
of NWDAF service area or selection priority), new addition or removal of NWDAF
instances, etc.
6\. The NWDAF #1, optionally, sends an Nnwdaf_AnalyticsInfo_Request message to
the NWDAF #2 to check acceptability of relocation at the NWDAF #2. The message
includes \"Handover Preparation\" indication and subscription information,
consisting of Subscription ID, Analytics ID, Target of Reporting and Event
Reporting Information, that the NWDAF#1 stores for analytics subscriptions of
consumer NFs. To select a target NWDAF, the NWDAF #1 may retrieve the NF
profile information of candidate target NWDAFs from the NRF, using
Nnrf_NFDiscovery with input parameters, such as Analytics ID(s), preferred
target NF location and TAI) as specified in TS 23.501 [2]/TS 23.502 [3].
NOTE: The step 6 and 7 are optional and can be omitted in case that the NWDAF
#1 is configured not to check the acceptance of the relocation with NWDAF #2.
7\. The NWDAF #2 responds to the NWDAF #1 with a Nnwdaf_AnalyticsInfo_Response
message which includes information on the subscription supported by the NWDAF
#2. The NWDAF #2 may include an indication for transfer of collected data from
the NWDAF #1 in the message. If step 6 is not performed, the step 7 is
skipped.
8\. The NWDAF #1 sends an Nnwdaf_AnalyticsInfo_Request message to the selected
target NWDAF #2 to request a handover of the analytics subscriptions. The
message includes \"Handover\" indication and subscription information.
9\. The NWDAF #2 responds to the NWDAF #1 with a Nnwdaf_AnalyticsInfo_Response
message which includes information on the subscription selected by the NWDAF
#2. The NWDAF #2 may include an indication for transfer of collected data from
the NWDAF #1 in the message.
10\. The NWDAF #2 sends an Nnwdaf_AnalyticsInfo_Request message to the NWDAF
#1 to request transfer of stored analytics data and/or the collected input
data.
11\. The NWDAF #1 responds to send stored analytics data and/or the collected
input data to the NWDAF #2.
12\. The NWDAF #1 sends the source NF a Nnf_EventExposure_Subscribe which
requests subscription for data collection from the source NF.
13\. The source NF responds to the NWDAF #2 with a Nnf_EventExposure_Notify.
14\. The NWDAF #2 sends Nnwdaf_AnalyticsSubscription_Notify to request to
renew the subscription identified by the subscription IDs received from the
NWDAF #1, using analytics subscription information received in step 6 or 8.
### 6.26.2 Impacts on services, entities and interfaces
NWDAF:
\- Need to upgrade to support a subscription transfer procedure
\- Need to upgrade to transfer and receive stored analytics and input data
\- Need to support Nnwdaf_AnalyticsInfo service enhanced to inform the target
NWDAF of handover preparation and handover of analytics subscriptions.
Consumer NF:
\- Need to upgrade to support subscription renewal with a new NWDAF instance
**\- Need to support an** additional parameter for
Nnwdaf_AnalyticsSubscription_Notify which indicates reselection of NWDAF
instance
## 6.27 Solution #27: UE data as an input for analytics generation
### 6.27.1 Description
This clause describes a solution to Key Issue #8: UE data as an input for
analytics generation.
#### 6.27.1.1 Principles of the Solution
The principle of the solution is that an AF for UE Application Layer data
collection is introduced. This AF is provided and controlled by the MNO and
communicates via a protocol over HTTPS on the user plane with the ASP
(Application Service Provider) Application Client in the UE. The AF for UE
data collection in turn distils and enriches input data provided by the
Application Client in the UE and exposes the resulting Analytics Information
to the NWDAF via the normal Naf_EventExposure mechanism. The solution is
applicable to both 3GPP defined services and non-3GPP defined services.
A SLA between the MNO and the ASP exists that determines (per Application Id
in use by the ASP) a) the MNO AF for the ASP´s UE Application Client to
connect to, e.g. via FQDN, b) the information that the ASP\'s UE Application
Client shares with the MNO AF (i.e. Service Experience data, UE Communication
data and Exception Information, although this list can be extended with other
data that the UE can provide in the scope of Rel-17 and onwards, but this
solution does not define new data) c) the authentication info for MNO AF:
method and data to be used by the ASP\'s UE Application Client to ensure that
the entity to send data to is actually the MNO AF and d) the authentication
info for the ASP\'s UE Application Client: method and data to be used by the
MNO AF to verify that the entity it is to receive data from is actually the
ASP\'s UE Application Client. e) data normalization algorithm (if used) for
the collected data from UEs.
The MNO AF that the ASP connects to also registers in NRF as serving the
internal Application Id. (registers the internal Application ID used in the
Event Exposure). The MNO AF also maps the external Application IdIs (provided
by the UE App Client) into the internal Application Id that is used in Event
Exposure.
Figure 6.27.1.1-1: Schematic picture of the setup
The figure above schematically shows the setup. The ordinary ASP Application
Server serves the ASP Application Client with content etc. but may also
provide FQDN as well as authorization and authentication details (this info
may also be pre-provisioned to the Application Client) for the communication
with the AF dedicated to UE data collection. The authorization and
authentication details will include the following information:
\- Whether ASP Application Client is allowed to provide data to the AF for UE
data collection.
\- Which parameters are authorized to provide to the AF for UE data
collection.
\- The authorization information to enable the ASP (Application Client) to
verify that the entity to send data to is actually the MNO AF
The ASP Application Client is designed to establish a use plane communication
with the AF for UE data collection using the FQDN and the
authorization/authentication details that the ASP provides to the Application
Client only if the privacy setting allow sharing application data with the
MNO. This communication channel is established over the user plane using the
existing PDU session.
NOTE: This solution is to be checked with SA WG3 (on security aspects) and
with SA WG4 (on the UE Application Client to MNO AF communication). Responses
will be taking into account as input for conclusions.
#### 6.27.1.2 UE establishes connection to AF for UE data collection
An ASP Application Client (in the UE), for which the SLA between the MNO and
the ASP indicates that data is to be collected and as part of the end user\'s
agreement with the ASP is established that sharing this data for analytics is
okay, is configured to establish a connection with the MNO AF for UE data
collection over the user plane when in operation. The connection is
established over the existing PDU session used by the ASP Application Client.
Figure 6.27.1.2-1: UE ASP Application Client connects to MNO AF for data
collection
1\. The user starts or interacts with the Application Client in the UE.
2\. (Not mandatory) the Application Client contacts the Application Server.
3\. (Not mandatory) the Application Client may receive data (FQDN) needed for
the user plane connection to the MNO AF for UE for data collection. This data
may also be pre-provisioned to the Application Client.
4\. The Application Client initialises the setup of a user plane connection
over the existing PDU session to the MNO AF for data collection.
NOTE: Whether multiple user plane connections are established or a single user
plane connection is established for different applications between the UE and
MNO AF are based on implementations that are out of scope of 3GPP.
5\. Connection ready for use.
As result of the steps 1 to 5, the Application Client provides the Application
Id and the UE IP address that will be stored in the MNO AF to request input
data from the UE Application Client.
Note that steps 1 to 5 described in figure 6.27.1.21 are out of the scope of
SA WG2 work, those are pre-requisites to describe how the MNO AF gets
information to identify the UE Application Client to contact with.
Note that this procedure is used to establish a user plane connection between
the ASP\'s UE Application Client and the MNO AF, next step is to request the
UE Application Client with the input data to collect to start the data
collection as described in 6.27.1.3.
#### 6.27.1.3 UE Data Collection over user plane
When the MNO AF for UE data collection receives a subscription for data from a
NWDAF it communicates with the ASP Application Clients over the user plane
connection described in clause 6.27.1.2 and instructs them to deliver data.
The MNO AF for UE data collection processes (e.g. enriches, aggregates or
normalizes) the data from the ASP\'s UE Application Clients and supplies the
result to the NWDAF using Naf_EventExpoure_Notify.
The figure below schematically shows the exchanges made from a NF subscribing
to Analytics from a NWDAF to the NWDAF starting to deliver Notifications.
Figure 6.27.1.3-1: UE ASP Application Client Data provided to NWDAF
1\. An NF subscribes to Analytics from the NWDAF. Each Analytics Id defines
its input data in TS 23.288 [5], that includes Analytics Filter information
including e.g. AoI, Application ID(s), Note that NWDAF may initiate data
collection prior to this subscription.
NOTE 1: Whether and how to use Application Status as Analytics Filter
Information can be discussed at normative phase.
2\. The NWDAF determines using Nnrf_NFDiscovery Request including the
Application ID(s) provided by NWDAF, which AF for UE data collection provided
by the MNO to use.
3\. The NWDAF subscribes to the AF for UE data collection input data for
analytics, using Naf_EventExposure Subscribe including the Target for Event
Reporting (i.e. SUPI, Internal Group Identifier or any UE), both Event ID(s),
Event Filters listed in clause 5.2.19.2.1 in TS 23.502 [3] and the Application
ID(s) for which input data is requested. Analytics Filter information included
by the consumer NF in step 1 can be applied to the Event Filters.
4\. The AF for UE data collection determines which ASP Application Clients are
in scope for data collection. If the NWDAF provided an Internal-Group-Id as
Target for Event Reporting, then the MNO AF needs to find the list of SUPIs
within that Internal-Group-Id. If the NWDAF provided \"any UE\" as target,
then NWDAF checks the Analytics Filter and contacts AMF to find the list of
SUPIs in that area of interest. The NWDAF contacts all of the ASP Application
Clients supporting that Application Id. If the NWDAF provided an Area of
Interest or Network Slice as Target for Event Reporting, then the MNO AF needs
to find the list of SUPIs that are in scope. The MNO AF requests the ASP\'s UE
Application Client to start reporting input data as requested in the SLA.
5\. The AF for UE data collection communicates with the ASP Application
Client(s) in scope over the connection setup as described in clause 6.27.1.2
and requests and receives data from them. This procedure can be used to
collect data for both 3GPP defined services and non-3GPP defined services.
Event Filters in the received Naf_EventExposure will be used to only request
data from Application Clients in UEs that are of interest given the filters.
NOTE 2: The protocol to be used in these exchanges to be defined by SA WG4.
6\. The AF for UE data collection receives the input data from the UE,
processes it (e.g. enriches, aggregates and normalizes), then enforces the
Event ID(s) and the Event Filter(s) and then notifies the NWDAF on the data
collected according to NWDAF subscription.
7\. The NWDAF produces Analytics.
8\. The NWDAF provides analytics to the consumer NF.
#### 6.27.1.4 Privacy and Integrity Protection of the Analytic Data
The communication between the ASP Application Client and the AF for UE data
collection for the NWDAF will use HTTPS. In addition, integrity protection and
ciphering may be applied to the data. Further, as the ASP ultimately decides
what data that is shared with the MNO via the AF for UE data collection for
the NWDAF the ASP is responsible for ensuring that user privacy is not
compromised, that is the user has an agreement with the ASP that allows or
denies the possibility to share ASP\'s UE Application Client data with the
MNO. The APS\'s UE Application Client is instructed by the ASP to establish a
connection with the MNO AF only if that agreement allows the client to share
data with the MNO.
#### 6.27.1.5 Authentication of the MNO AF and the UE Application Client
In order to enable the MNO (AF) to verify that the entity to receive data from
is actually the ASP Application Client, both method and data to be used by the
MNO AF to authenticate it are negotiated as part of the SLA between the MNO
and the ASP.
Similarly, in order to enable the ASP (Application Client) to verify that the
entity to send data to is actually the MNO AF, both method and data to be used
by the ASP Application Client in the UE to authenticate it are negotiated as
part of the SLA between the MNO and the ASP. ASP sends the method and data
that is used to authenticate MNO AF to UE Application Client as specified in
clause 6.27.1.1.
#### 6.27.1.6 Correlating UE Application Client data and NWDAF requested input
data.
The UE Application client provides the UE IP address/prefix and the external
Application Id while the NWDAF request contains the SUPI and the internal
Application Id. The MNO AF needs to correlate both,
NOTE: It is assumed UE IP address is known at MNO AF based on application-
level interactions between UE Application client and MNO AF. The interactions
to retrieve UE IP address at MNO AF is out of scope of SA2.
In order to correlate the external and internal Application Id (or related
Event ID), the MNO AF registers at the NRF as supporting both Applications (or
related Event ID) as part of its NF profile.
If a SUPI is provided as the target of analytics reporting, in order to
correlate the SUPI and the UE IP address/prefix, the MNO AF obtains the PDU
sessions active for the SUPI, DNN and S-NSSAI if provided by NWDAF and then
subscribes to Event IP address allocation and release to SMF. The procedure is
shown below.
Figure 6.27.1.6-1: Retrieving UE IP address/prefix allocated for a SUPI, DNN
and S-NSSAI
1 Triggered by Naf Event Exposure request with Target for Event Reporting set
to SUPI, or the Internal-Group.Id, the MNO AF contacts UDM using
Nudm_SDM_Subscribe including the target SUPI, and S-NSSASI if available as
well as the Data type set to UE context in SMF data. If an Internal-Group-Id
is provided the MNO AF requests UDM to provide the list of SUPIs using the
Nudm_SMF_Get service including the Internal Group-Id and Data type set to
Group data. The UDM provide the UE context data including the SMFs serving the
SUPI. This step may also be needed multiple times, one per SUPI.
2 The MNO AF contacts each SMF in the list of SMF serving the SUPI using
Nsmf_EventExposure, Event Id on UE IP Address / prefix allocation change or
PDU Session Establishment and/or PDU Session Release.
3 The SMF provides the UE IP address (es) / prefix (es) allocated to a SUPI.
4 The MNO AF stores it for later use, and updates it depending on the
notifications from SMF.
If the target of analytics reporting is any UE, MNO AF subscribes to NRF
Discovery based on the event filter provided on the area of interest (as list
of TAIs) to find matching AMF instances. The SUPIs are retrieved from relevant
AMF(s) based on the event filter and then the procedure to interact with SMF
as above is followed per individual SUPI or list of SUPIs.
#### 6.27.1.7 MNO AF notifications to NWDAF about input data requested.
One of the Event Filters is the Area of interest, in this case the UE App Id
reports the Event with an associated time stamp and at the same time the MNO
AF requests the AMF where the SUPI is registered to provide the UE location,
then at the time the input data is collected, the MNO AF adds the UE location
at the provided time stamp before forwarding to the NWDAF, the procedure is
shown below.
### 6.27.2 Impacts on services, entities and interfaces
AF for UE data collection (MNO AF):
\- Method(s) to authenticate and authorize Application Clients must be
developed in SA WG3/SA WG4.
\- Methods and procedures, as well as identifiers to use, to identify,
correlate and translate internal and external Application IDs, internal and
external UE identifiers, and IP addresses must be defined.
NWDAF:
\- Discovery of Application data reporting method (via ASP AF, MNO AF) per
Application ID must be added.
\- Discovery of which AF for UE data collection to use (given Application ID,
Analytics ID, UE IDs, etc.) must be added.
UE Application Client:
\- Connection and communication procedures towards AF for UE data collection
must be added. The protocol is to be described by SA WG4.
## 6.28 Solution #28: UE assisted analysis for usage of network slice
### 6.28.1 Description
#### 6.28.1.1 General
This solution is proposed to address KI#8.
URSP is a key point for network slicing service. The URSP evaluation is a
behaviour in NAS layer (an example is shown in figure-6.28.1.1), however as
described in clause 6.6.2.3 in TS 23.503, the UE may associate the application
traffic to different PDU session (incl. S-NSSAI) per time, location, URSP
enforcement, etc. Also, as described in clause 4.2.3 in TS 24.526, UE shall
ignore the unknown or unexpected URSP rules when evaluating the URSP rules to
associate an application to PDU session.
For the UE behaviour mentioned above, UE does not notify the network the
result of URSP evaluation. In other words, once the URSP is distributed to UE,
neither core network nor the application server knows which URSP rule(s) are
enforced. Thus, the network cannot know whether the URSP rules (e.g. the
parameters in URSP rule, the Rule precedence) are set properly.
Figure 6.28.1.1: Example of URSP evaluation
The network may need to verify that the traffic is routed over a PDU session
that complies with the characteristics sent in the URSP rule. Although the
NWDAF may receive information such as service behaviour analytics and/or
service experience analytics from an AF, service behaviour analytics and/or
service experience analytics is not sufficient for the network determine if
the URSP rules that are installed in a UE need to be updated. In order verify
proper URSP enforcement and optimize the distribution of URSP, the NWDAF needs
to collect data from UE and other NF about how URSP rules are being applied by
the UE and what URSP rules are installed. The NWDAF can provide the PCF
information about how URSP rules are being applied and the PCF uses this
information to check that the UE is correctly applying URSP Rules and decide
if new URSP rules need to be sent to the UE or if URSP rules need to be
removed from the UE.
It is proposed that UE provides data related to usage of URSP to NWDAF. To
achieve it, a new container can be used for direct communication between UE
and NWDAF. Thus the UE can include the data into the container and use the NAS
message to send the container to NWDAF. Also, NWDAF may include an indication
that a URSP Enforcement Report is desired in the Container. The indication may
be used to indicate two options:
1) When URSP (re)evaluation happens, UE sends URSP Enforcement Report to NWDAF
(e.g. the newly adopted URSP rules/RSDs) to NWDAF if the association between
Application and PDU session is changed. Or
2) UE stores the URSP Enforcement Report when it receives the indication and
sends to NWDAF every time it further receives the indication.
The URSP enforcement report can indicate the time information as well.
NOTE: there could be an alternative way for data transfer between UE and
NWDAF, which is depending on the conclusion of KI#8 (how to transfer data
between UE and NWDAF.
The NWDAF collects the data from UE and other NF, to derive the analytics for
usage of network slice.
#### 6.28.1.2 Input data
Since the URSP evaluation is a behaviour in NAS layer, once the URSP is
distributed to UE, neither core network nor the application server knows which
URSP rule(s) are enforced. In order to verify proper URSP enforcement and
optimize the distribution of URSP, NWDAF shall be able to collect data from UE
and other NF, as described below:
Table 6.28.1.2-1: data for URSP enforcement collected by NWDAF
+-----------------------------+--------+-----------------------------+ | Information | Source | Description | +-----------------------------+--------+-----------------------------+ | URSP Enforcement Report | UE | The UE sends a URSP | | | | Enforcement Report based on | | | | an indication from network. | | | | The indication is sent by | | | | NWDAF. | | | | | | | | It can indicate the time | | | | information. | +-----------------------------+--------+-----------------------------+ | The mapping between traffic | PCF/AF | There can be multiple | | descriptor and the | | traffic descriptors are | | Application(s) | | corresponding to a certain | | | | application. | | | | | | | | PCF/AF can notify which | | | | application a Traffic | | | | Descriptor is corresponding | | | | to. | +-----------------------------+--------+-----------------------------+ | The URSP rules distributed | PCF/AF | URSP may be updated. | | to UE | | | | | | PCF/AF can notify which | | | | URSP rules are distributed | | | | to UE per time/location. | +-----------------------------+--------+-----------------------------+
#### 6.28.1.3 Output Analytics
NWDAF can analyse the data collected from UE and NFs and provide the output
that is shown in the table below. The output analytics may be used by the PCF
to check that the UE is correctly applying URSP Rules and decide if new URSP
rules need to be send to the UE or URSP rules need to be removed from the UE.:
Table 6.28.1.3-1: statistics for UE\'s usage of Network slice
* * *
Analytics Description List of URSP rule/RSDs The URSP rule/RSDs distributed to
UE Applied URSP rule/RSDs The applied URSP rule/RSDs by UE Which network
slice(s) (S-NSSAI) for a given application are used. Due to URSP evaluation,
the UE does not always use the most prioritized or latest URSP rule/RSDs. This
entry provides the How long for a network slices is used for the application.
statistics about if and how often for an S-NSSAI is used for a given UE. Time
information Indicates the Analytics target period
* * *
Table 6.28.1.3-2: Prediction for UE\'s usage of Network slice
* * *
Analytics Description List of URSP rule/RSDs for distribution The URSP
rule/RSDs to be distributed to UE Applied URSP rule/RSDs The URSP rule/RSDs to
be applied by UE Which network slice(s) (S-NSSAI) for a given application are
used. Due to URSP evaluation, the UE does not always use the most prioritized
or latest URSP rule/RSDs. This entry provides the How long for a network
slices is used for the application. statistics about if and how often for an
S-NSSAI is used for a given UE. Time information Indicates the Analytics
target period Confidence Confidence of the prediction
* * *
The NWDAF can share the analytics output (statistics and/or predictions) to
consumers (e.g. PCF and AF). And based on the output, PCF can aware the
enforcement of URSP rules and adjust the URSP rulesaccordingly. For example,
if an URSP rule is never used for a certain UEs, then it might be due to the
Traffic Descriptor is misconfigured and MNO, OTT, UE vendor may collaborate to
fix it.
#### 6.28.1.4 Procedure
Figure 6.28.1.4: Procedure for analytics of usage of network slice and update
URSP to UE accordingly
1\. NWDAF collects data for URSP enforcement from UE as described in Table
6.28.1.2-1.
2\. NWDAF may collects data from PCF and/or AF as described in Table
6.28.1.2-1.
3\. Based on the input in step-1 and 2, NWDAF derives the analytics result as
described in Table 6.28.1.3-1 and Table 6.28.1.3-2.
4\. The analytic result can be exposed to PCF and/or AF. PCF and AF may
interact to update the URSP rules. Then PCF may distribute the updated URSP to
UE using UCU procedure as specified in clause 4.2.4.3 in TS 23.502 [3].
### 6.28.2 Impacts on services, entities and interfaces
UE:
\- Provides the data for URSP enforcement as described in Table 6.28.1.2;
PCF/AF:
\- Provides the the URSP rules distributed to UE and the mapping between
traffic descriptor and the Application(s) as described in Table 6.28.1.2;
NWDAF:
\- Support analytics of usage of network slice based on input from UE and
PCF/AF as described in Table 6.28.1.3
\- Exposure the analytics to other NF (e.g. PCF and AF);
AMF:
\- Support to transfer a new container (i.e. a new value for payload
container) between UE and NWDAF.
## 6.29 Solution #29: Support UE data as an input for Control Plane analytics
### 6.29.1 Description
This solution is proposed for Key Issue 8: UE data as an input for analytics
generation.
UEs are natural data collection points to gather more localised input data to
generate analytics. This is enhanced by logging sensor data, including UE
orientation, altitude, location, speed and heading as also captured in RAN WG
studies in Rel-16 (TR 37.816 [13]).
When it comes to social behaviour and social gatherings like sport matches,
concerts, operas festivals etc., several UEs may adopt tightly correlated
behaviours that we refer here to as \"collective behaviour\" without any
explicit group designation. As an example, such UEs may adopt similar route,
velocity, orientation, mobility pattern or relative proximity as a collective
behaviour within a joint event (e.g. to reach a destination spot). As a
result, collecting input parameters from UEs that reflect user intent or
indicate likely actions that such UEs may take can be useful to generate
analytics data within the 5GC at NWDAF.
As an example, based on such input data (indicating a collective user
behaviour), NWDAF may generate analytics to identify expected changes in load
per tracking area (TA) or AMF region via identifying correlation in collective
behaviour of the indicated non-designated group. Accordingly, OAM (or other
related consumer NFs) may utilise the load analytics (if applicable) to adjust
the weight factor per AMF instance within an AMF set (under Operator policy)
based on the above collective behaviour-derived analytics (within a given AMF
region or TA as defined by TS 23.502 [3]) to avoid future overloads /
congestions.
NOTE: Whether and how OAM may use NWDAF analytics needs to be determined by SA
WG5.
Another example, multiple applications, which are classified into foreground
(FG) and background (BG), could be run in a UE at the same time. The FG
application means the application status in active mode and the BG application
means the application status in in active mode. The Applications status i.e.
active or inactive can be managed differently to efﬁciently guarantee the
service experience in case of network congestion.
\- For application status in active mode, a UE sends a request to the
application server or other UEs and then, they immediately respond to the UE.
When network congestion occurs on Foreground application, the user is likely
to notice a delay since Foreground application is generated by the user
interaction.
\- For application status in inactive mode, a UE periodically communicates
with application servers in order to exchange or update information. Even when
the network congestion occurs, the user of the UE is unlikely to notice the
delay of the communications.
However, it is difﬁcult for the mobile operators to distinguish those types of
Application Status only by IP addresses/port numbers.
Therefore, the NWDAF could collect this Application Status from UE during the
training phase, and then an Application Status Classifier could be trained to
help determine if a new flow of an application is in FG or BG status during
the inference phase. Finally, the FG or BG status for the new flow could be
exposure to the 5GC NF (e.g. PCF) to determine new QoS parameters for the new
flow.
### 6.29.2 Input Data
#### 6.29.2.1 UE input data for Collective Behaviour
For the purpose of enhancing the NF load analytics, the NWDAF may collect the
information as listed in Table 6.29.2-1 from UE. This is in addition to input
data in clause 6.5.2, TS 23.288 [5].
Table 6.29.2.1-1: UE input data for Collective Behaviour (possibly via MNO AF
after anonymization, statistical analysis or normalisation)
+------------------------+-----------------+------------------------+ | Information | Source | Description | +------------------------+-----------------+------------------------+ | List of UE IDs | AF | List of external UE | | | | IDs identified with a | | | | collective behaviour | | | | within area of | | | | interest | +------------------------+-----------------+------------------------+ | UE velocity, | MDT | UE Velocity, | | orientation | | Orientation. | | | (see NOTE 1) | | +------------------------+-----------------+------------------------+ | Collective Attribute | AF | Characterise UE IDs in | | | | close relative | | | (see NOTE 2) | proximity to each | | | | other | +------------------------+-----------------+------------------------+ | Collective Attribute | AF | Characterise | | | | collective attribute | | | (see NOTE 3, 4) | per list of UE IDs | | | | (Route, Destination, | | | | Average Speed, Time | | | | Interval spent per | | | | location). | +------------------------+-----------------+------------------------+ | Timestamp | AF | A time stamp of time | | | | that the collective | | | | attribute collected. | +------------------------+-----------------+------------------------+ | Application ID(s) | AF | Identifying the | | | | application providing | | | (see NOTE 5) | this information | +------------------------+-----------------+------------------------+ | NOTE 1: UE input data | | | | collection for a | | | | specific UE (via MDT), | | | | can be done as | | | | captured in 6.2.3.1, | | | | TS 23.288 [5] | | | | | | | | NOTE 2: UE input data | | | | collection from AF for | | | | known parameters can | | | | be done based on | | | | clause 6.2.2.3, | | | | TS 23.288 [5]. | | | | | | | | NOTE 3: If the NWDAF | | | | e.g. through prior AF | | | | reporting and/ or MDT | | | | does not have the | | | | requested parameters, | | | | it may request the | | | | (MNO) AF to configure | | | | the application client | | | | in the UE in order to | | | | provide the data to | | | | the (MNO) AF. This | | | | enables the (MNO) AF | | | | to provide the data to | | | | the NWDAF as defined | | | | in clause 6.29.4. | | | | | | | | NOTE 4: The collection | | | | of data is subject to | | | | application client | | | | support and user | | | | consent to be checked | | | | at UE configuration | | | | step (see step 0 of | | | | Figure 6.29.4-2 in | | | | clause 6.29.4). | | | | | | | | NOTE 5: The | | | | application ID(s) is | | | | optional. If the | | | | application ID(s) is | | | | not provided, the | | | | relevant application | | | | ID(s) can be | | | | identified by NWDAF | | | | based on the procedure | | | | covered in clause | | | | 6.2.2.3, | | | | TS 23.288 [5] (e.g. | | | | based on event ID(s) | | | | configured or | | | | registered). | | | +------------------------+-----------------+------------------------+
The parameters outlined in Table 6.29.2.1-1 may characterise different sets of
UE IDs with a given collective (behaviour) attribute and a time stamp. Based
upon these, the NWDAF may determine or predict the number of UEs that are
expected to enter into specific TA(s) or AMF Region(s).
#### 6.29.2.2 Application status analytics input
Table 6.29.2.2-1: UE Input data for application status analytics
* * *
Information Source Description > Application ID(s) AF Identifying the
application providing this information > Timestamp UE/AF Identifying a
timestamp for the application > IP 5-tuple UE/AF Identify a flow of the
application > Application Status (NOTE) UE/AF Indicate the flow of the
application is in a foreground status (i.e. active status) or background
status (i.e. inactive status) NOTE: The Application Status could help NWDAF to
train an Application Status Classifier, which could be used to classify a new
application data into foreground status or background status.
* * *
### 6.29.3 Output Analytics
#### 6.29.3.1 NF load analytics output
For the purpose of enhancing the NF load analytics, the NWDAF may generate
analytics as listed in Table 6.29.3.1-1 and Table 6.29.3.1-2. This is in
addition to NF load statistics and predictions in clause 6.5.3, TS 23.288 [5].
Table 6.29.3.1-1: NF load statistics
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | List of resource status (1..max) | List of observed load | | | information for each NF instance | | | along with the corresponding NF | | | id / NF Set ID (as applicable) | +----------------------------------+----------------------------------+ | > NF load (per area of | The average load of the NF | | interest) | instances over the area of | | | interest | | (NOTE 1) | | +----------------------------------+----------------------------------+ | NOTE 1: Applicable only to AMF | | | load based on Input data in | | | clause 6.29.2.1, Table | | | 6.29.2.1-1. | | +----------------------------------+----------------------------------+
Table 6.29.3.1-2: NF load predictions
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | List of resource status (1..max) | List of predicted load | | | information for each NF instance | | | along with the corresponding NF | | | id / NF Set ID (as applicable) | +----------------------------------+----------------------------------+ | > NF load (per area of | The predicted average load of | | interest) | the NF instances over the area | | | of interest | | (NOTE 1) | | +----------------------------------+----------------------------------+ | NOTE 1: Applicable only to AMF | | | load based on Input data in | | | clause 6.29.2.1, Table | | | 6.29.2.1-1. | | +----------------------------------+----------------------------------+
NWDAF may provide statistics or prediction on pattern of AMF load changes to
Consumer NF based on output analytics as outlined in Table 6.29.3.1-1 and
Table 6.29.3.1-2.
#### 6.29.3.2 Application status analytics output
Many network analytics could be derived by the NWDAF by using the input data
from UE.
For example, Application Status statistics information is defined in Table
6.29.3.2-1.
Table 6.29.3.2-1: Application Status statistics
* * *
Information Description UE ID UE ID e.g. SUPI or IMEI for a UE which is
indicated in the Target of Analytics Reporting Application Status (1..max)
List of statistics for application status > Application ID Application ID for
an application of the UE > Timestamp The timestamp for the application >
Application Status The application status (e.g. background i.e. inactive or
foreground i.e. active) for the application
* * *
Application Status predictions information is defined in Table 6.29.3.2-2.
Table 6.29.3.2-2: Application Status predictions
* * *
Information Description UE ID UE ID e.g. SUPI or IMEI for a UE which is
indicated in the Target of Analytics Reporting Application Status (1..max)
List of predicted application status > Application ID Application ID for an
application of the UE > Timestamp The timestamp for the application >
Application Status The application status (e.g. background i.e. inactive or
foreground i.e. active) for the application > Confidence Confidence of this
prediction
* * *
### 6.29.4 Procedures
Figure 6.29.4-1: Procedure to collect UE data for Control Plane load balancing
analytics
Figure 6.29.4-2: Procedure for UE data collection via AF
1\. The Consumer NF sends a request to the NWDAF for NF load analytics. The
Analytics ID is set to \"NF load information\" with additional analytics
filter information based on an area of interest (e.g. to cover specific TAs or
AMF regions). The consumer NF may set a time window in future to get
predictions on pattern of load changes within that window.
2\. NWDAF follows the UE Input Data Collection Procedure (e.g. based on input
data in clause 6.29.2) within the area of interest (via setting the analytics
filter information to specific TA or AMF region as requested at step 1) and
collects the UE input data accordingly.
NOTE 1: NWDAF provides the area of interest as a list of TAIs to (MNO) AF
similar to clause 6.4.4, NOTE 1, TS 23.288 [5].
To do so, NWDAF may subscribe to (MNO) AF (2a) based on policies agreed in
step 0. (MNO) AF may establish application layer connectivity to UE
Application Client (2b) to collect unprocessed UE data (2c). The (MNO) AF may
anonymise, normalise or aggregate the data based on configuration policies
agreed in step 0, before notifying the UE input data as defined in clause
6.29.2 to NWDAF at (2d).
NOTE 2: The exact protocol in steps 0, 2b and 2c is out of the scope of SA WG2
and to be defined by other SA WGs (e.g. SA WG3 and SA WG4) in coordination
with SA WG2.
3\. The NWDAF may optionally retrieve the NF load and NF status information
from NRF for corresponding NF instances.
4\. NWDAF processes the collected input data (e.g. to identify UEs with
collective behaviour) and (optionally) combines with current NF load analytics
(e.g. per AMF instance) retrieved from NRF.
5\. NWDAF provides predicted pattern of load changes (e.g. across TAs or AMF
regions) to the Consumer NF.
6-8. If, at step 1, the Consumer NF has subscribed to receive continuous
reporting of NF load analytics, the NWDAF may generate new analytics and
provide them to the Consumer NF upon reception of notification of new UE input
data.
### 6.29.5 Impacts on services, entities and interfaces
NWDAF:
\- (NF load analytics) To support the area of interest as analytics filter
information for NF Load information.
\- To support data collection from UE via AF (if cannot be collected based on
6.2.3.1 or 6.2.2.3, TS 23.288 [5]).
UE Application Client/ (MNO) AF:
\- To support procedures for UE data collection via (MNO) AF (if cannot be
collected based on 6.2.3.1 or 6.2.2.3, TS 23.288 [5]).
(MNO) AF (Collective UE Behaviour):
\- To provide external UE IDs identified with a collective behaviour.
\- To provide the collective attribute with a time stamp.
\- To provide relevant Application ID(s) where the collective attribute
collected from.
## 6.30 Solution #30: Dispersion Analytics output provided by NWDAF
### 6.30.1 Description
This is a solution for Key Issue #9, Dispersion Analytic Output Provided by
NWDAF.
Dispersion analytics characterizes the interaction of a user, or a group of
users, with the network and identifies at what locations (i.e. area of
interest, TAs, cell) users dispersed most (if not all) their data volume,
sessions transactions (i.e. MM and SM messages), transaction failures, dropped
sessions and voice call minutes. Same concept applies to dispersion at a given
network slice; at which slice users dispersed most (if not all) their data,
session transactions, transaction failures, dropped sessions and voice call
minutes.
As part of the characterization, a user or a group of users, are evaluated and
classified as either fixed users, campers or travellers at the Area of
Interest. This classification is determined per operator\'s defined
thresholds. For example, if a user disperses, during the period of
observation, most (threshold = 95%) of his/her data volume at a location, the
dispersion data-classification of the user is fixed for that location.
Likewise, different thresholds are defined for campers and travellers
categories at the location.
When the network status indication (NSI) of a location is determined as being
congested, as described in TS 23.288 [5] clause 6.8, the PCF can use the
dispersion analytics output to determine the fixed users and top campers at
the location and update policy decisions, e.g. modifying RFSP for the fixed
users and top campers, thereby reducing congestion at that location.
When an AOI is exhibiting multiple transaction failures, dropped sessions and
radio link failures, which could be the result of poor coverage, the AMF may
allow the use of CE (Coverage Enhancement) in the affected location as
described in TS 23.288 [5] clause 6.7.5.3.
Based on collected dispersion information, the NWDAF may generate analytics to
identify expected changes in transaction signal loading conditions at an area
of interest such as TAs and Registration Areas. Accordingly, various loading
factors can be assigned to AMF instances to avoid or mitigate predicted
overload conditions.
#### 6.30.1.1 Dispersion definitions
Dispersion - The percentage of activity that a user, or group of users,
generated at a location during a period of interest. This enables the operator
to rank hot locations by the various activities and identify the top
contributors (users) for that activity. When heavy users at a particular
location are detected, their QoS attributes, or access to an area of interest
or a slice can be limited by the PCF, AMF and NSSF.
\- Data dispersion - The percentage of data traffic volume that a user, or a
group of users, generated at the location during the period of interest.
\- Transaction dispersion - The percentage of MM and SM messages that a user,
or a group of users, generated at the location during the period of interest.
\- Transaction Failure dispersion - The percentage of failed transactions (MM
and SM procedures) that a user, or a group of users, experienced at the
location during the period of interest.
\- Dropped Sessions - The percentage of dropped sessions that a user, or a
group of users, experienced at the location during the period of interest.
\- Voice Call dispersion - The percentage of voice call minutes a user, or a
group of users, used at the location during the period of interest.
Dispersion Classification - Assignment of one of three mobility classes (i.e.
fixed, camper, traveller) per dispersion characteristic:
\- Data-Classifications - fixed, camper, traveller data-classification per
thresholds assigned by the operator. Example: when a user disperses, during
the period of observation, most (threshold = 95%) of his/her data at a
location, the dispersion data-classification of the user at that location is
fixed.
\- Transaction-Classifications - fixed, camper, traveller transactions-
classifications per thresholds assigned by the operator. Example: when a user
disperses, during the period of observation, (threshold=) 40% of his/her
session transactions at a location, the dispersion transaction-classification
of the user is camper at that location.
\- Transaction-Failure-Classifications: fixed, camper, traveller transaction-
failure-classification per thresholds assigned by the operator.
\- Dropped-Call-Classifications - fixed, camper, traveller dropped-calls-
classification per thresholds assigned by the operator.
\- Voice-Call-Classifications - fixed, camper, traveller voice-call-
classification per thresholds assigned by the operator. Example: when a user
disperses, during the period of observation, no more than (threshold=) 10% of
his/her voice talk time (in minutes) at a location, the dispersion voice-call-
classification of the user is traveller for the location.
#### 6.30.1.2 General
A NWDAF supporting dispersion analytics statistics or predictions shall be
able to collect a UE dispersion related information from NFs and to perform
analytics to provide dispersion statistics or predictions. Through dispersion
analytics, the NWDAF can determine that a data hot spot is formed when the
amount of data dispersed by most of the users at the area of interest exceeds
a certain data volume threshold established through statistical trending or
operator policy. Likewise, the NWDAF can determine that transaction hot spot
is formed when the amount of transactions dispersed by heavy users at the area
of interest exceeds a certain threshold established through statistical
trending or operator policy. Rouge devices generating excessive signalling in
an area of interest can be identified by the NWDAF when a signalling storm is
detected.
The service consumer may be a NF (e.g. AMF, PCF).
The consumer of dispersion analytics may indicate in its request:
\- Analytics ID set to \"UE Dispersion Analytics\" and the dispersion analytic
type (i.e. DA Type)
\- The Target of analytics reporting which is a single UE, any UE, or a group
of UEs.
\- Analytics Filter Information optional list of TA(s), Area(s) of Interest,
Cells, or S-NSSAI.
\- An Analytics target period indicating the time period over which the
statistics or predictions are requested.
\- In a subscription, the Notification Correlation Id and the Notification
Target Address.
NOTE: Care must be taken with regards to load when requesting Any UE. This
could be achieved via utilization of some event filters (e.g. Area of Interest
for AMF) and possible analytic filters (e.g. top-heavy users or fixed campers)
and/or Analytics Reporting Information (e.g. SUPImax), or sampling ratio as
part of Event Reporting Information.
#### 6.30.1.3 Input Data
The NWDAF supporting dispersion analytics shall be able to collect UE
dispersion information from NF(s) and AFs. The detailed information collected
by the NWDAF is network data from 5GC including NFs and AFs:
\- Network data related to UE dispersion and bound by location collected from
5GC are defined in the Tables 6.30.1.3-1, 6.30.1.3-2, 6.30.1.3-3 and
6.30.1.3-4;
Table 6.30.1.3-1: Location based UE dispersion collected from serving AMF
* * *
Information Source Description UE ID AMF SUPI Type Allocation Code AMF
Terminal model and vendor information of the UE. UE locations (1..max) AMF UE
positions >UE location Area of Interest (TA or cells that the UE enters)
>Timestamp A time stamp when the AMF detects the UE entering this location
>Transactions AMF Either per UE transaction or optionally if subscription with
periodic notification is requested an amount of UE transactions exchanged at
the location.
* * *
Table 6.30.1.3-2: Location based UE dispersion collected from serving SMF
* * *
Information Source Description UE IP SMF UE IP address UE ID SMF SUPI
>Timestamp A time stamp associated with the collected information
>Transactions SMF Either per UE transaction or optionally if subscription with
periodic notification is requested an amount of UE transactions exchanged.
* * *
Table 6.30.1.3-3: Location based UE dispersion collected from the AF
* * *
Information Source Description IP 5-tuple AF IP address 5-tuple Application ID
(1..max) AF To identify the application for the UE Locations of Application
AF/NEF Location of application represented by a list of DNAI(s). The NEF may
map the AF-Service identifier information to a list of DNAI(s) when the
DNAI(s) being used by the application are statically defined. Timestamp A time
stamp of the collected information >Data Volume AF Amount of UE data volume
exchanged per application during the period of observation, if application ID
is provided in the Analytics request. This parameter is only available when
subscriptions with periodic notification is requested >Application duration AF
(Duration for the application (e.g. Voice talk time)
* * *
Table 6.30.1.3-4: Location based UE dispersion collected from serving UPF
* * *
Information Source Description UE IP UPF UE IP address IP 5-tuple UPF IP
address 5-tuple Application ID (1..max) UPF To identify the application for
the UE Location of Application UPF List of Internet applications represented
by DNAI(s). Timestamp A time stamp of the collected information >Data Volume
UPF amount of UE data volume exchanged per application during the period, if
application ID is provided in the Analytics request. This parameter is only
available when subscriptions with periodic notification is requested
>Application duration UPF (Duration for the application (e.g. Voice talk time)
* * *
The focus of the NWDAF is to calculate the volume of data and amount of
transactions dispersed by the UE at each visited location during a period of
interest. The entry time and exit time to a location is provided by the AMF.
If the optional application ID is requested, the volume per application can be
provided by the UPF or AF.
The Correlation Information as defined in Table 6.2.4-1 of TS 23.288 [5] could
be re-used to correlate the input data from AMF and SMF, the input data from
SMF and UPF, the input data from UPF and AF.
\- Slice data related to UE dispersion from NF(s) are defined in the Tables
6.30.1.3-5, 6.30.1.3-6, 6.30.1.3-7, and 6.30.1.3-8.
Table 6.30.1.3-5: Slice based UE dispersion collected from serving AMF
* * *
Information Source Description UE ID AMF SUPI Type Allocation Code AMF
Terminal model and vendor information of the UE. Slice (1..max) AMF UE
assigned slice >S-NSSAI Slice (up to 8 per UE at any given instance)
>Timestamp A time stamp when the slice was assigned >Transactions AMF Either
per UE transaction or optionally if subscription with periodic notification is
requested an amount of UE transactions exchanged at the slice
* * *
Table 6.30.1.3-6: Slice based UE dispersion collected from serving SMF
* * *
Information Source Description UE IP SMF UE IP address UE ID SMF SUPI Slice
(1..max) UE assigned slice >S-NSSAI Slice (up to 8 per UE at any given
instance) >Timestamp A time stamp associated with the collected information
>Application ID SMF Identify the application for the UE at the slice
>Transactions SMF Either per UE transaction or optionally if subscription with
periodic notification is requested an amount of UE transactions exchanged at
the slice
* * *
Table 6.30.1.3-7: Slice based UE dispersion collected from the AF
* * *
Information Source Description IP 5-tuple AF IP address 5-tuple Application ID
(1..max) AF To identify the application for the UE Locations of Application
AF/NEF Location of application represented by a list of DNAI(s). The NEF may
map the AF-Service identifier information to a list of DNAI(s) when the
DNAI(s) being used by the application are statically defined. Timestamp A time
stamp of collected information >Data Volume AF Amount of UE data volume
exchanged per UE application during the period of observation, if application
ID is provided in the Analytics request. This parameter is only available when
subscriptions with periodic notification is requested >Application duration AF
(Duration for the application (e.g. Voice talk time)
* * *
Table 6.30.1.3-8: Slice based UE dispersion collected from the serving UPF
* * *
Information Source Description UE IP UPF UE IP address IP 5-tuple UPF IP
address 5-tuple Application ID (1..max) UPF To identify the application for
the UE Location of Application UPF List of Internet applications represented
by DNAI(s). Timestamp A time stamp of collected information >Data Volume UPF
Amount of UE data volume exchanged per application during the period, if
application ID is provided in the Analytics request. This parameter is only
available when subscriptions with periodic notification is requested
>Application duration UPF (Duration for the application (e.g. Voice talk time)
* * *
The focus of the NWDAF is to calculate the volume of data and amount of
transactions dispersed by the UE at each slice during a period of interest. A
time stamp for the slice assignment is provided by the AMF.
If the optional application ID is requested, the volume per application can be
provided by the UPF or AF.
The Correlation Information as defined in Table 6.2.4-1 of TS 23.288 [5] could
be re-used to correlate the input data from AMF and SMF, the input data from
SMF and UPF, the input data from UPF and AF.
Data collection may be provided on samples (e.g. spatial subsets of UEs or UE
group, temporal subsets of UE location information).
NOTE: How the data from UPF is retrieved is not specified in this release.
The Namf_EventExposure and Nsmf_EventExposure services are enhanced to provide
transaction count in Tables 6.30.1.3-1 through 6.30.1.3-6.
#### 6.30.1.4 Output Analytics
The NWDAF supporting dispersion analytics shall be able to provide UE
dispersion analytics to consumer NFs or AFs. The dispersion analytics and
prediction can be for data, transactions, failed transactions, sessions drop
and voice calls.
The list of monitored transactions (MM and SM messages) and failed
transactions is a subset of the messages listed in TS 24.501 [14] clauses 8.2
and 8.3. The list of reported and failed transactions is provided in clause
6.30.2 and 6.30.3.
##### 6.30.1.4.1 Data Dispersion Analysis
The data dispersion analytics results provided by the NWDAF could be UE
dispersion statistics as defined in Table 6.30.1.4.1-1 and or UE dispersion
predictions as defined in Table 6.30.1.4.1-2:
Table 6.30.1.4.1-1: Data dispersion statistics bound by location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > UE location (1..max) Observed location
statistics >> UE location TA or cells where the UE dispersed its data >>
Application ID (1..max) To identify the application for the UE >>> Data
dispersed Data volume dispersed at this location and application, if
application ID is provided. >> Data classification Data mobility
classification for this location: fixed, camper, traveller >> Data ranking
Percentile ranking of data usage at this location (i.e. % data dispersed at
this location) >> Ratio Percentage of UEs in the group (in case of UE group)
* * *
Table 6.30.1.4.1-2: Data dispersion prediction bound by location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > UE location (1..max) Predicted location
during the analytics target period >> UE location TA or cells where the UE is
predicted to disperse its data >> Application ID (1..max) To identify the
application for the UE >>> Data dispersion Data volume dispersion prediction
at this location and application, if application ID is provided. >> Confidence
Confidence of this prediction (i.e. data to be dispersed at this location) >>
Data classification Data mobility classification for this location: fixed,
camper, traveller >> Confidence Confidence of this prediction (i.e. mobility
classification at this location) >> Data ranking Percentile ranking of data
usage at this location (i.e. % data dispersed at this location) >> Confidence
Confidence of this prediction (i.e. percentile ranking at this location) >>
Ratio Percentage of UEs in the group (in case of UE group)
* * *
The data dispersion analytics results provided by the NWDAF could be for a UE
or group of UEs dispersion statistics at a given slice as defined in Table
6.30.1.4.1-3 and dispersion predictions as defined in Table 6.30.1.4.1-4:
Table 6.30.1.4.1-3: Data dispersion statistics bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > Slice (1..max) Observed slice statistics
>> S-NSSAI Slice where the UE or group of UEs dispersed data >> Application ID
(1..max) To identify the application for the UE at the slice >>> Data
dispersed Data volume dispersed at this slice and application, if application
ID is provided. >> Data classification Data mobility classification for slice:
fixed, camper, traveller >> Data ranking Percentile ranking of data usage at
this slice (i.e. % data dispersed at this slice) >> Ratio Percentage of UEs in
the group (in case of UE group)
* * *
Table 6.30.1.4.1-4: Data dispersion prediction bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > Slice (1..max) Predicted slice during the
Analytics target period >> S-NSSAI Slice where the UE is predicted to disperse
its data >> Application ID (1..max) To identify the application for the UE at
the slice >>> Data dispersion Data volume dispersion prediction at this slice
and application, if application ID is provided. >> Confidence Confidence of
this prediction (i.e. data to be dispersed at this slice) >> Data
classification Data mobility classification for this slice: fixed, camper,
traveller >> Confidence Confidence of this prediction (i.e. mobility
classification at this slice) >> Data ranking Percentile ranking of data usage
at this slice (i.e. % data dispersed at this slice) >> Confidence Confidence
of this prediction (i.e. percentile ranking at this slice) >> Ratio Percentage
of UEs in the group (in case of UE group)
* * *
NOTE 1: When target of analytics reporting is an individual UE, the NWDAF will
provide the dispersion analytics result (i.e. list of (predicted) time slots)
to the NF service consumer(s) for the UE.
NOTE 2: The Application ID in the Data Dispersion Analytics is optional. When
the Application ID is missing, the Data Dispersion Analytics is applied across
all the applications in an AoI or a slice.
##### 6.30.1.4.2 Transactions Dispersion Analysis
The transaction (MM and MS messages) dispersion analytics results provided by
the NWDAF could be UE dispersion statistics as defined in Table 6.30.1.4.2-1
or UE dispersion predications as defined in Table 6.30.1.4.2-2:
Table 6.30.1.4.2-1: Transaction dispersion statistics bound by location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > UE location (1..max) Observed location
statistics >> UE location TA or cells where the UE dispersed its transactions
>> Transaction dispersed Transactions volume dispersed at this location >>
Transaction classification Transactions mobility classification for this
location: fixed, camper, traveller >> Transaction ranking Percentile ranking
of transactions volume at this location (i.e. % transaction dispersed at this
location) >> Ratio Percentage of UEs in the group (in case of UE group)
* * *
Table 6.30.1.4.2-2: Transaction dispersion prediction bound by location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of predicted time slots > Time slot start
Time slot start within the Analytics target period > Duration Duration of the
time slot > UE location (1..max) Predicted location during the analytic target
period >> UE location TA or cells where the UE is predicted to disperse its
transactions >> Transaction dispersion Transaction volume predicted to be
dispersed at this location >> Confidence Confidence of this prediction (i.e.
data to be dispersed at this location) >> Transaction classification
Transaction mobility classification for this location: fixed, camper,
traveller >> Confidence Confidence of this prediction (i.e. mobility
classification at this location) >> Transaction ranking Percentile ranking of
transactions at this location (i.e. % transaction dispersed at this location)
>> Confidence Confidence of this prediction (i.e. percentile ranking at this
location) >> Ratio Percentage of UEs in the group (in case of UE group)
* * *
The transaction dispersion analytics results provided by the NWDAF could be UE
or group of UEs dispersion statistics at a given slice as defined in Table
6.30.1.4.2-3 and dispersion predictions as defined in Table 6.30.1.4.2-4:
Table 6.30.1.4.2-3: Transaction dispersion statistics bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > Slice (1..max) Observed slice statistics
>> S-NSSAI Slice where the UE or group of UEs dispersed its transactions >>
Transaction dispersed Transactions volume dispersed at this location >>
Transaction classification Transaction mobility classification for slice:
fixed, camper, traveller >> Transaction ranking Percentile ranking of
transactions at this slice (i.e. % transaction dispersed at this slice) >>
Ratio Percentage of UEs in the group (in case of UE group)
* * *
Table 6.30.1.4.2-4: Transaction dispersion prediction bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of predicted time slots > Time slot start
Time slot start within the Analytics target period > Duration Duration of the
time slot > Slice (1..max) Predicted slice during the Analytics target period
>> S-NSSAI Slice where the UE is predicted to disperse its transactions >>
Transaction dispersion Transaction volume to be dispersed at this slice >>
Confidence Confidence of this prediction (i.e. transactions to be dispersed at
this slice) >> Transaction classification Transaction mobility classification
for this slice: fixed, camper, traveller >> Confidence Confidence of this
prediction (i.e. mobility classification at this slice) >> Transaction ranking
Percentile ranking of transactions at this slice (i.e. % transaction dispersed
at this slice) >> Confidence Confidence of this prediction (i.e. percentile
ranking at this slice) >> Ratio Percentage of UEs in the group (in case of UE
group)
* * *
NOTE: When target of analytics reporting is an individual UE, the NWDAF will
provide the dispersion analytics result (i.e. list of (predicted) time slots)
to the NF service consumer(s) for the UE.
##### 6.30.1.4.3 Transactions Failure Dispersion Analysis
Transaction failures dispersion analytics is a metric geared to identify
fragile points of contact in the network that are impacting UEs. These could
be areas of poor coverage. The transactions failures (MM and MS failed
procedures) dispersion analytics results provided by the NWDAF could be UE
dispersion statistics as defined in Table 6.30.1.4.3-1 or UE dispersion
predication as defined in Table 6.30.1.4.3-2:
Table 6.30.1.4.3-1: Transaction failure dispersion statistics bound by
location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > UE location (1..max) Observed location
statistics >> UE location TA or cells where the UE dispersed its transactions
failures >> Transaction failure dispersed Transactions failures dispersed at
this location >> Transaction failure classification Transactions failures
mobility classification for this location: fixed, camper, traveller >>
Transaction failure ranking Percentile ranking of transaction failures at this
location (i.e. % transaction failure dispersed at this location) >> Ratio
Percentage of UEs in the group (in case of UE group)
* * *
Table 6.30.1.4.3-2: Transaction failure dispersion prediction bound by
location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of predicted time slots > Time slot start
Time slot start within the Analytics target period > Duration Duration of the
time slot > UE location (1..max) Predicted location during the analytic target
period >> UE location TA or cells where the UE is predicted to disperse its
transaction failures >> Transaction failure dispersion Transaction failure
predicted to be dispersed at this location >> Confidence Confidence of this
prediction (i.e. data to be dispersed at this location) >> Transaction failure
classification Transaction failure mobility classification for this location:
fixed, camper, traveller >> Confidence Confidence of this prediction (i.e.
mobility classification at this location) >> Transaction failure ranking
Percentile ranking of transaction failures at this location (i.e. %
transaction failures dispersed at this location) >> Confidence Confidence of
this prediction (i.e. percentile ranking at this location) >> Ratio Percentage
of UEs in the group (in case of UE group)
* * *
The transaction dispersion analytics results provided by the NWDAF could be UE
or group of UEs dispersion statistics at a given slice as defined in table
6.30.1.4.3-3 and dispersion predictions as defined in Table 6.30.1.4.3-4:
Table 6.30.1.4.3-3: Transaction failure dispersion statistics bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > Slice (1..max) Observed slice statistics
>> S-NSSAI Slice where the UE or group of UEs dispersed transaction failures
>> Transaction failure dispersed Volume of transaction failures dispersed at
this location >> Transaction failure classification Transaction failures
mobility classification for slice: fixed, camper, traveller >> Transaction
failure ranking Percentile ranking of transaction failures volume at this
slice (i.e. % transaction failures dispersed at this slice) >> Ratio
Percentage of UEs in the group (in case of UE group)
* * *
Table 6.30.1.4.3-4: Transaction failure dispersion prediction bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > Slice (1..max) Predicted slice during the
Analytics target period >> S-NSSAI Slice where the UE is predicted to disperse
its transaction failures >> Transaction failure dispersion Prediction of
transaction failures dispersion at this slice >> Confidence Confidence of this
prediction (i.e. transactions to be dispersed at this slice) >> Transaction
failure classification Transaction failure mobility classification for this
slice: fixed, camper, traveller >> Confidence Confidence of this prediction
(i.e. mobility classification at this slice) >> Transaction failure ranking
Percentile ranking of transaction failures at this slice (i.e. % transaction
failure dispersed at this slice) >> Confidence Confidence of this prediction
(i.e. percentile ranking at this slice) >> Ratio Percentage of UEs in the
group (in case of UE group)
* * *
NOTE: When target of analytics reporting is an individual UE, the NWDAF will
provide the dispersion analytics result (i.e. list of (predicted) time slots)
to NF service consumer(s) for the UE.
##### 6.30.1.4.4 Dropped Sessions Dispersion Analysis
Dropped sessions, or sessions time outs, are non-graceful PDU sessions
termination.
Dropped sessions dispersion analytics is a metric geared to identify fragile
points of contact in the network that are impacting UEs. These could be areas
of poor coverage. The dropped sessions dispersion analytics results provided
by the NWDAF could be UE dispersion statistics as defined in Table
6.30.1.4.5-1 or UE dispersion predictions as defined in Table 6.30.1.4.5-2:
Table 6.30.1.4.5-1: Dropped sessions dispersion statistics bound by location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > UE location (1..max) Observed location
statistics >> UE location TA or cells where the UE dispersed its dropped
sessions >> Dropped Sessions dispersed Dropped sessions dispersed at this
location >> Dropped sessions classification Dropped sessions mobility
classification for this location: fixed, camper, traveller >> Dropped sessions
ranking Percentile ranking of dropped sessions at this location (i.e. %
dropped sessions dispersed at this location) >> Ratio Percentage of UEs in the
group (in case of UE group)
* * *
Table 6.30.1.4.5-2: Dropped sessions dispersion prediction bound by location
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of predicted time slots > Time slot start
Time slot start within the Analytics target period > Duration Duration of the
time slot > UE location (1..max) Predicted location during the analytics
target period >> UE location TA or cells where the UE is expected to disperse
its dropped sessions >> Dropped Session dispersion Predicted dropped sessions
dispersion at this location >> Confidence Confidence of dropped sessions
prediction at this location >> Dropped Sessions classification Dropped
sessions mobility classification for this location: fixed, camper, traveller
>> Confidence Confidence of this prediction (i.e. mobility classification at
this location) >> Dropped Sessions ranking Percentile ranking of dropped
sessions at this location (i.e. % dropped sessions dispersed at this location)
>> Confidence Confidence of this prediction (i.e. percentile ranking at this
location) >> Ratio Percentage of UEs in the group (in case of UE group)
* * *
The dropped sessions dispersion analytics results provided by the NWDAF could
be UE or group of UEs dispersion statistics at a given slice as defined in
table 6.30.1.4.5-3 and dispersion predictions as defined in Table
6.30.1.4.5-4:
Table 6.30.1.4.5-3: Dropped sessions dispersion statistics bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of time slots during the Analytics target
period > Time slot start Time slot start within the Analytics target period >
Duration Duration of the time slot > Slice (1..max) Observed slice statistics
>> S-NSSAI Slice where the UE or group of UEs dispersed data >> Dropped
sessions Dropped sessions dispersed at this slice >> Dropped session
classification Dropped session mobility classification for slice: fixed,
camper, traveller >> Dropped sessions ranking Percentile ranking of dropped
sessions at this slice (i.e. % dropped sessions at this slice) >> Ratio
Percentage of UEs in the group (in case of UE group)
* * *
Table 6.30.1.4.5-4: Dropped sessions dispersion prediction bound by slice
* * *
Information Description UE group ID or UE ID Identifies a UE or a group of
UEs, e.g. internal group ID defined in TS 23.501 [2] clause 5.9.7, SUPI (see
NOTE). Time slot entry (1..max) List of predicted time slots > Time slot start
Time slot start within the Analytics target period > Duration Duration of the
time slot > Slice (1..max) Predicted slice for dropped sessions during the
analytics target period >> S-NSSAI Slice where the UE is predicted to disperse
its dropped sessions >> Dropped sessions dispersion Predicted dropped sessions
to be dispersed at this slice >> Confidence Confidence of this prediction
(i.e. transactions to be dispersed at this slice) >> Dropped sessions
classification Dropped sessions mobility classification for this slice: fixed,
camper, traveller >> Confidence Confidence of this prediction (i.e. mobility
classification at this slice) >> Dropped session ranking Percentile ranking of
predicted dropped sessions at this slice (i.e. % dropped sessions dispersed at
this slice) >> Confidence Confidence of this prediction (i.e. percentile
ranking at this slice) >> Ratio Percentage of UEs in the group (in case of UE
group)
* * *
NOTE: When target of analytics reporting is an individual UE, the NWDAF will
provide the dispersion analytics result (i.e. list of (predicted) time slots)
to NF service consumer(s) for the UE.
### 6.30.2 Procedures
The NWDAF can provide UE dispersion analytics, in the form of statistics or
predictions or both, to another NF. If the NF is an AF, and when the AF is
untrusted, the AF will request analytics via the NEF, and the NEF will then
convey the request to the NWDAF.
Figure 6.30.2-1: UE Dispersion Analytics provided to an NF
1\. The NF sends a request to the NWDAF for dispersion analytics on a specific
UE, any UE, or a group of UEs, using either the Nnwdaf_AnalyticsInfo or
Nnwdaf_AnalyticsSubscription service. The NF can request statistics or
predictions or both. The type of analytics is set to UE Dispersion Analytics,
the dispersion analytic (DA) type combination (i.e. data volume, transactions,
transactions failure, dropped calls, voice minutes) and analytic filter
information = (Area of Interest, slice, target period). The NF provides the UE
id or Internal Group ID in the Target of Analytics Reporting.
2\. If the request is authorized, and in order to provide the requested
analytics, the NWDAF may subscribe to events with all the serving AMFs, SMFs
of the requested UE(s) for notification of location changes or a slice change
(a slice change can be an additional slice or a deletion). This step may be
skipped when e.g. the NWDAF already has the requested analytics available.
The NWDAF subscribes to voice service data from AF(s) by invoking
Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via
NEF).
NOTE: The NWDAF determines the AMF serving the UE, any UE, or the group of UEs
as described in TS 23.288 [5] clause 6.2.2.1.
3\. The NWDAF derives requested analytics.
4\. The NWDAF provides requested UE dispersion analytics to the NF, using
either the Nnwdaf_AnalyticsInfo_Request Response or
Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.
The details for UE dispersion analytics provided by NWDAF are described in
clause 6.30.1.4. The provided analytics enables the consumer to predict
changing network conditions such as data volume change at a location or a
slice, signalling storm conditions at a location or a slice, etc.
5-6. If at step 1, the NF has subscribed to receive notifications for UE
dispersion analytics, after receiving event notification from the AMFs (e.g.
location change) or SMFs (e.g. slice change add/delete) subscribed by NWDAF in
step 2, the NWDAF may generate new dispersion analytics
7\. The NWDAF provides the newly generated dispersion analytics to the NF. The
details for UE dispersion analytics provided by NWDAF are described in clause
6.30.1.4.
### 6.30.3 Assistance to slice load distribution procedure
In this procedure the NSSF, or AMF when NSSF is not deployed subscribes to
receive slice load analytics and attempts to avoid further overloading the
slice with new UE registration or redirect heavy users to another slice or
slice instance. When a slice or slice instance is not receiving acceptable
service experience and is heavily loaded the NSSF or AMF requests the NWDAF to
report the data dispersion analytics of registered UE on the slice and also
report the predicted dispersion of a UE attempting to register at the slice.
With a data volume loading information, the NSSF can decide when to stop
admitting heavy users into a particular slice while potentially still
admitting light users. The NSSF may decide to allow just travellers additions
to a loaded slice and redirect fixed and camper data users to a different
slice.
NOTE: If the NSSF is not deployed, another 5GC NF (e.g. AMF and/or SMF) may
subscribe to the slice dispersion data analytics information to assist with
load mitigation policy.
Editor\'s note: An alignment may be required with Solution #2, once KI#4 is
concluded, to provide dispersion analytics information to assist to the slice
load distribution steps of Solution #2 when a new UE initiates registration on
a loaded or restricted slice.
### 6.30.4 User Data Congestion Mitigation
In this procedure upon notification of one-time or continuous user plan data
congestion in an area of interest, (see TS 23.288 [5] clause 6.8), the PCF
requests the NWDAF to report the data dispersion analytics of either any user
or just the heavy users located at the congested area of interest. This
information is derived from the amount of data volume dispersed at that
location by the users either as statistical information and/or predication.
With this data volume dispersion analytics, the PCF can decide for example
whether to remove PCC Rules for heavy users, that will trigger QoS flow
removal by the SMF and whether to not assign PCC Rules to a newly requested
heavy user\'s QoS flow. Such PCF decision may help on leading to a reduction
of the heavy users data consumption and the data volume demand at the
location. A policy update to mitigate congestion may involve change to non-GBR
QoS flows, modification of the UE-AMBRR which is the aggregated bit rate
across all non-GBR QoS flows of the UE, Session-AMBR, which is the aggregated
maximum bitrate of non-GB flows of the PDU session, update to RFSP and/or
service area restriction.
Figure 6.30.4-1: Procedure for User Data Congestion Mitigation
1-5. User data congestion at an area of interest is reported to all PCFs per
steps 1 through 5 in TS 23.288 [5] procedure 6.8.4. This also maps to internal
event notification, steps 1d in TS 23.502 [3] clause 4.16.5.2.
6\. For a potential policy change decision, the PCFs are requesting data
volume dispersion analysis for the UE in the requested Area of Interest from
the NWDAF (i.e. in this UC, AOI is the reported congested area). If the
Analytic Filter is set to \"top-heavy users\" the request is just for the top-
heavy data users, otherwise the request is for data dispersion analytics of
all UEs in the AOI. If the NWDAF needs to retrieve the list of UEs in the area
of interest, it may subscribe to UE mobility event notifications of AMFs as
described in clause 5.3.4.4 of TS 23.501 [2] using event ID \"UE moving in or
out of Area of Interest\" and Event Filters as described in Table 5.2.2.3.1-1
of TS 23.502 [3].
7\. Per statistical information and/or prediction, the NWDAF derives and rank
the fixed and camping data volume users at the requested area of interest.
8\. The NWDAF identifies all the users in the requested area of interest and
per Analytic Filter settings, returns in the response to the PCF an entry for
each user or an entry for each top-heavy user. The response includes
statistics or prediction of data volume dispersion at the location, the user
ranking and classification (fixed, camper, traveller at the location) as
defined in tables 6.30.1.4.1-1 and 6.30.1.4.1-2.
9\. Based on the NWDAF provided data, the PCFs use the data volume dispersion
and ranking information and possibly other pertinent information per the PCF
local policies, to decide whether to apply a policy change to certain reported
UEs under their control.
10\. The PCFs perform AM or SM policy modification to the UEs under their
control as described in TS 23.502 [3] clause 4.16.5.2 steps 4 and 5. A policy
modification to mitigate congestion may involve for example change non-GBR QoS
flows, modification of UE-AMBR, which is the aggregated bit rate across all
non-GBR flows of the PDU session, update to RFSP and/or service area
restriction. For example, in order to mitigate the user plane data congestion,
the PCF may use the data dispersion for an application to update the policy of
the QoS flows for the application (e.g. reduce the GFBR or MFBR).
NOTE: This step shows optional PCF\'s policy modification at the SMF, AMF or
both. The PCF serving the AMF and serving the SMF may be different ones, as
such the policy modifications are performed by each of these PCF(s).
### 6.30.5 Impacts on services, entities and interfaces
PCF impact:
1) Subscribe for UE dispersion analytics/prediction from the NWDAF.
NSSF impact:
2) Subscribe for UE dispersion analytics/prediction from the NWDAF.
SMF impact:
3) Subscribe for UE dispersion analytics/prediction from the NWDAF.
4) Either provide an Event per UE or a sum of SM transactions information for
a UE at a given slice and specified time period.
5) Either provide an Event per UE or a sum of SM transaction failure
information for a UE at a given slice and specified time slot.
6) Either provide an Event per UE or a sum of dropped sessions information for
a UE at a given slice and specified time slot.
The Nsmf_EventExposure Service is updated to provide this information
AMF impact:
7) Subscribe for UE dispersion analytics/prediction from the NWDAF.
8) Either provide an Event per UE or a sum of MM transactions information for
a UE at a given slice and specified time period.
9) Either provide an Event per UE or a sum of MM transaction failure
information for a UE at a given slice and specified time slot.
The Namf_EventExposure Service is updated to provide this information
NWDAF impact:
11) Support Type of analytics = UE dispersion analytics and provide UE
dispersion analytics information, statistics and prediction.
12) Collect UE dispersion information from AMF, SMF, AF.
## 6.31 Solution #31 (merging Sol# 48, 49(alternative 2), 50 and 51): NWDAF
Assisted UP Optimization for edge computing by extending the existing service
experience analytics
### 6.31.1 Description
This solution is proposed to address Key Issue #10: NWDAF assisted UP
optimization and KI #16: UP optimization for edge computing.
This solution specifies for how NWDAF can provide service experience analytics
per UP path including UPF and DNAI and Application Server instance a) to the
SMF to assist UP optimization for edge computing, b) to the AF to determine if
DNAI relocation is required and/or service parameters adjusting is required or
c) to an LDNSR as defined in TR 23.748 [28] to determine the best Application
Server instance at the current UP path and DNAI. It is proposed to extend the
existing Analytics ID as specified in clause 6.4 of TS 23.288 [5] by adding
the additional input/output parameters required for this solution.
### 6.31.2 Input Data
The service data collected from the AF/NEF, the network data from other 5GC
NFs and the network data from OAM for service experience analytics are defined
in Table 6.31.2-1, Table 6.31.2-2 and Table 6.31.2-3, respectively.
Table 6.31.2-1: Service Data from AF related to the Service Experience
analytics
* * *
Information Source Description Application ID AF To identify the service and
support analytics per type of service (the desired level of service) IP filter
information AF Identify a service flow of the UE for the application Locations
of Application AF/NEF Locations of application represented by a list of
DNAI(s). The NEF may map the AF-Service-Identifier information to a list of
DNAI(s) when the DNAI(s) being used by the application are statically defined.
Service Experience AF Refers to the QoE as established in the SLA and during
on boarding. It can be either e.g. MOS or video MOS as specified in ITU-T
P.1203.3 [16] or a customized MOS Performance Data AF The performance
associated with the communication session of the UE with an Application Server
that includes: Average Packet Delay, Average Loss Rate, and Throughput as
defined in Table 6.49.2-1: Application Server Performance Data from EDN
network, clause 6.49. Application Server Instance AF The IP address or FQDN of
the Application Server that the UE had a communication session when the
measurement was made Timestamp AF A time stamp associated to the observed
level of Service Experience provided by the AF, mandatory if the observed
Service Experience is provided by the ASP.
* * *
NOTE 1: Performance Data and Application Server Instance is new input from AF,
comparing to Service Data from AF defined in Table 6.4.2-1, clause 6.4.2, TS
23.288 [5].
Table 6.31.2-2: QoS flow level Network Data from 5GC NF
+-----------------------+---------+----------------------------+ | Information | Source | Description | +-----------------------+---------+----------------------------+ | Timestamp | 5GC NF | A time stamp associated | | | | with the collected | | | | information. | +-----------------------+---------+----------------------------+ | Location Info | AMF | The UE location | | | | information when the | | | | service is delivered. | +-----------------------+---------+----------------------------+ | DNN | SMF | DNN for the PDU Session | | | | which contains the QoS | | | | flow | +-----------------------+---------+----------------------------+ | S-NSSAI | SMF | S-NSSAI for the PDU | | | | Session which contains the | | | | QoS flow | +-----------------------+---------+----------------------------+ | Application ID | PCF/SMF | Used by NWDAF to identify | | | | the application service | | | | provider and application | | | | for the QoS flow | +-----------------------+---------+----------------------------+ | UPF info | SMF | UPF ID/address/FQDN | | | | information for the UPF | | | | serving the UE | +-----------------------+---------+----------------------------+ | IP filter information | SMF | Provided by the SMF, which | | | | is used by NWDAF to | | | | identify the service data | | | | flow for policy control | | | | and/or differentiated | | | | charging for the QoS flow | +-----------------------+---------+----------------------------+ | QFI | SMF | QoS Flow Identifier | +-----------------------+---------+----------------------------+ | QoS flow Bit Rate | UPF | The observed bit rate for | | | | UL direction; and | | | | | | | | The observed bit rate for | | | | DL direction | +-----------------------+---------+----------------------------+ | QoS flow Packet Delay | UPF | The observed Packet delay | | | | for UL direction; and | | | | | | | | The observed Packet delay | | | | for the DL direction | +-----------------------+---------+----------------------------+ | Packet transmission | UPF | The observed number of | | | | packet transmission | +-----------------------+---------+----------------------------+ | Packet retransmission | UPF | The observed number of | | | | packet retransmission | +-----------------------+---------+----------------------------+
NOTE 2: UPF info is a new input from SMF, comparing to the ones for the QoS
flow level Network Data from 5GC NF defined in Table 6.4.2-2, clause 6.4.2, TS
23.288 [5].
Table 6.31.2-3: UE level Network Data from OAM
* * *
Information Source Description Reference Signal Received Power OAM The per UE
measurement of the received power level in a network cell, including SS-RSRP,
CSI-RSRP as specified in clause 5.5 of TS 38.331 [7] and E-UTRA RSRP as
specified in clause 5.5.5 of TS 36.331 [8] Reference Signal Received Quality
OAM The per UE measurement of the received quality in a network cell,
including SS-RSRQ, CSI-RSRQ as specified in clause 5.5 of TS 38.331 [7] and
E-UTRA RSRQ as specified in clause 5.5.5 of TS 36.331 [8] Signal-to-noise and
interference ratio OAM The per UE measurement of the received signal to noise
and interference ratio in a network cell, including SS-SINR, CSI-SINR, E-UTRA
RS-SINR, as specified in clause 5.1 of TS 38.215 [9] Timestamp OAM A time
stamp associated with the collected information. Cell Energy Saving State OAM
The energy saving state information of the cells within area of interest, e.g.
a list of the cell which is within the area of interest and is in the energy
saving state, as specified in clause 3.1 and 6.2 in TS 28.310 [20].
* * *
NOTE 3: The cell energySaving state information can be provided by OAM. The
providing of this information to the NWDAF will be coordinated with the study
in SA WG5.
NOTE 4: \"Timestamp\" and \"Cell Energy Saving State\" are a new input from
OAM, comparing to UE level Network Data from OAM as defined in Table 6.4.2-3,
clause 6.4.2, TS 23.288 [5].
### 6.31.3 Output Analytics
The NWDAF services as defined in the clause 7.2 and 7.3, TS 23.288 [5], are
used to expose the analytics.
\- Service Experience per UP path statistics information is defined in Table
6.31.3-1.
\- Service Experience per UP path predictions information is defined in Table
6.31.3-2.
Table 6.31.3-1: Service Experience per UP path statistics
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | ServiceExperience per UP path | List of observed service | | (1..n) | experience information for each | | | Application per UP path | | | (including UPF and DNAI). | +----------------------------------+----------------------------------+ | > Application ID | Identification of the | | | application. | +----------------------------------+----------------------------------+ | > Service Experience Type | Type of Service Experience | | | analytics, e.g. on voice, video, | | | other. | +----------------------------------+----------------------------------+ | >>UE location | Indicating the UE location | | | information (e.g. cell ID, gNB | | | ID, etc) when the UE service is | | | delivered. | +----------------------------------+----------------------------------+ | >>UPF Info | Indicating UPF serving the UE | +----------------------------------+----------------------------------+ | >>DNAI | Indicating which DNAI the UE | | | service uses/camps on | +----------------------------------+----------------------------------+ | >>DNN | DNN for the PDU Session which | | | contains the QoS flow | +----------------------------------+----------------------------------+ | >>Application Server Instance | Identifies the Application | | Address | Server Instance (IP address of | | | the Application Server) or FQDN | | | of Application Server | +----------------------------------+----------------------------------+ | >>> Service Experience | Service Experience over the | | | Analytics target period | | | (average, variance), e.g. | | | service MOS. | +----------------------------------+----------------------------------+ | > Spatial validity | Area where the estimated Service | | | Experience applies. | | | | | | If Area of Interest information | | | was provided in the request or | | | subscription, spatial validity | | | may be a subset of the requested | | | Area of Interest. | +----------------------------------+----------------------------------+ | > Validity period | Validity period as defined in | | | clause 6.1.3, TS 23.288 [5]. | +----------------------------------+----------------------------------+
NOTE 1: The UPF info, DNN and Application Server Instance Address is a output
information for the Service Experience statistics as defined in clause 6.4.3,
TS 23.288 [5].
NOTE 2: The item \"DNN\" shall not be included if the consumer NF is an AF.
Table 6.31.3-2: Service Experience per UP path predictions
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | ServiceExperience per UP path | List of observed service | | (1..n) | experience information for each | | | Application per UP path | | | (including UPF and DNAI). | +----------------------------------+----------------------------------+ | > Application ID | Identification of the | | | application. | +----------------------------------+----------------------------------+ | > Service Experience Type | Type of Service Experience | | | analytics, e.g. on voice, video, | | | other. | +----------------------------------+----------------------------------+ | >>UE location | Indicating the UE location | | | information (e.g. cell ID, gNB | | | ID, etc)when the UE service is | | | delivered. | +----------------------------------+----------------------------------+ | >>UPF Info | Indicating which UPF the UE | | | service uses/camps on | +----------------------------------+----------------------------------+ | >>DNAI | Indicating which DNAI the UE | | | service uses/camps on | +----------------------------------+----------------------------------+ | >>DNN | DNN for the PDU Session which | | | contains the QoS flow | +----------------------------------+----------------------------------+ | >>Application Server Instance | Identifies the Application | | Address | Server Instance (IP address of | | | the Application Server) or FQDN | | | of Application Server | +----------------------------------+----------------------------------+ | >>> Service Experience | Service Experience over the | | | Analytics target period | | | (average, variance), e.g. | | | service MOS. | +----------------------------------+----------------------------------+ | > Spatial validity | Area where the estimated Service | | | Experience applies. | | | | | | If Area of Interest information | | | was provided in the request or | | | subscription, spatial validity | | | may be a subset of the requested | | | Area of Interest. | +----------------------------------+----------------------------------+ | > Validity period | Validity period as defined in | | | clause 6.1.3, TS 23.288 [5]. | +----------------------------------+----------------------------------+ | > Probability assertion | Confidence of this prediction. | +----------------------------------+----------------------------------+
NOTE 3: The UPF info, DNN and Application Server Instance Address is a new out
information for the Service Experience predictions as defined in clause 6.4.3,
TS 23.288 [5].
NOTE 4: The item \"DNN\" shall not be included if the consumer NF is an AF.
### 6.31.4 Procedures
Figure 6.31.4-1: Procedure for subscription to network performance analytics
1\. The Consumer NF sends Nnwdaf_AnalyticsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request (Analytics ID=Service Experience per UP path (UPF
and DNAI), Target of Analytics Reporting=any UE, Analytics Filter=Application
ID, Area of Interest, and Analytics target Period(s)) to the NWDAF.
2\. The NWDAF collects the required input data from AMF as described in Clause
6.31.2.
3\. The NWDAF collects the required input data from SMF as described in Clause
6.31.2.
4\. The NWDAF collects the required input data from AF as described in Clause
6.31.2.
5\. The NWDAF provides the data analytics, i.e. the observed Service
Experience per UP path (UPF and DNAI) to the consumer NF by means of either
Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify.
Case 1: Consumer NF is the SMF
6\. An AF may send a request to influence SMF routing decisions for traffic of
PDU Session as defined in clause 5.6.7, TS 23.501 [2] and clause 4.3.6.4, TS
23.502 [3].
7\. The PCF updates the SMF with corresponding new PCC rule(s) with PCF
initiated SM Policy Association Modification procedure as described in clause
4.16.5.2, TS 23.502 [3].
8\. During the procedure that AF influence on traffic routing as defined in
4.3.6.4, TS 23.502 [3], besides the PCC rules from the PCF, if the SMF
determines that there are more than one DNAI available for the same
application the SMF can also take the Service Experience analytics per UP path
from the NWDAF into account to:
\- (re)select UP paths, including UPF and DNAI e.g. as described in clause
4.3.5, TS 23.502 [3];
\- (re)configure traffic steering, updating the UPF regarding the target DNAI
with new traffic steering rules.
Case 2: Consumer NF is the LDNSR
9\. If the consumer NF in step 2 is the LDNSR the LDNRS determines the best
Application Server Instance at the UE location.
Editor\'s note: Whether LDNSR is a consumer depends on the solution
alternatives selected in the EC Study.
Case 3: Consumer NF is AF/Application Server (e.g. EAS)
10-11. The AF / Application Server determines to adjust service parameters.
e.g., service parameters of video for adjustment may be bit rate, frame rate,
codec format, compression parameter, screen size, etc. as depicted in sol#51.
In addition, the Application Server may provide a updated list of DNAI(s) for
SMF to perform relocation when appropriate.
### 6.31.5 Impacts on services, entities and interfaces
AF:
\- Provides Performance Data to NWDAF.
\- Takes the Service Experience analytics with UP path from the NWDAF into
account to adjust service parameters or may provide a updated list of DNAI(s)
for SMF to perform relocation when appropriate.
NWDAF:
\- Provides Service Experience analytics per UP path (UPF and DNAI) to the
consumer SMF.
\- Enhancing the service experience analytics including as output data a list
of Application Server Instances and associated performance data at the
requested UE location and target period.
AF:
\- Providing measured MOS performance data per Application Server Instance.
SMF:
\- Takes the Service Experience analytics with UP path from the NWDAF into
account to do UP path selection and traffic steering.
## 6.32 Solution #32: Enhancing Existing Mechanisms to Reduce Load and
Complexity to Determine Entities serving in Area of Interest
### 6.32.1 High-level Description
This solution focus on KI#11 on reducing the load of data collection and the
complexity at NWDAF in determining entities serving an area of interesting.
This solution is targeting of reduce the load of data collection at NWDAF when
analytics ID are requested with the target of analytics set to \'\'any UE\'\'.
In this case, NWDAF uses the analytics filter information to determine the
entities from which specific data has be retrieved. When the analytics filter
information does not include the area of interest, NWDAF uses its NWDAF
serving area information (i.e. list of TAIs or Cells) to restrict the entities
that it needs to contact for collecting data and generating the analytics ID.
### 6.32.2 Procedure for Determining SMFs/AMFs in AoI per TA granularity
The procedure in Figure 6.32.2-1 illustrate the enhanced mechanisms based on
existing signalling for NWDAF to determine the AMFs and SMFs in an area of
interest per TA granularity.
Figure 6.32.2-1: Procedure for NWDAF Determining SMFs/AMFs in AoI per TA
granularity
0\. AMF and SMF register their NF Profile at NRF which includes the list of
TAIs that such NFs can serve as defined in TS 29.510 [11] Clauses 6.1.6.2.11
and 6.1.6.2.12, respectively.
1\. Analytics Consumer subscribes to Nnwdaf_AnalyticsSubscription service
operation from NWDAF. In the subscription, the target of analytics is set to
\"any UE\" and the analytics filter information may contain the AoI. If it
does not contain, NWDAF uses its own NWDAF serving area information.
2\. NWDAF identifies the need to determine AMFs and SMFs for the AoI
associated with the subscription. If NWDAF already has a network map for data
collection (as defined in TS 23.288 [5] Clause 6.2.2.4) including such
information the next steps are skipped.
3\. (a,b) NWDAF invokes Nnrf_NFDiscovery including in the search request the
AMF and SMF NF Type and the list of TAs related to the area of interest. NRF
send to NWDAF the AMF and SMF NF Profiles that contain at least one of the TAs
indicated in the discovery query request.
4\. In order to keep a consistent network map for data collection for the area
of interest associated with the requested analytics ID, NWDAF subscribes to
Nnrf_NFManagement StatusSubscribe enhanced to support as input a list of TAs
in addition to the current parameters already supported as defined in TS
23.502 [3] Clause 5.2.7.2.5, such as NF Type.
5\. NRF detects changes in NF profiles related to the indicated list of TAs by
NWDAF. The possible changes detected by NRF are: changes in TAs of stored NF
Profiles, or new NF profiles are included in NRF with the TAs indicated in the
subscription to such NRF service operation, or NF profiles are removed.
6 NRF notifies NWDAF with the NF Profiles related to changes in the indicated
list of TAs.
7\. NWDAF process the received notifications from NRF and adds the changes in
AMFs and SMFs serving in area of interest enclosed in the notification in the
network map for data collection. Such updated network map is used to provide
analytics outputs.
### 6.32.3 Procedure for Determining Network Slice Information in AoI
The procedure in Figure 6.32.3-1 illustrate the enhanced mechanisms for NWDAF
determining network slice information in an area of interest, i.e. available
S-NSSAIs per AMF, per TA and associated cells and access type. NWDAF has to
keep such network map in order to properly retrieve data per S-NSSAIs.
Figure 6.32.3-1: NWDAF determining network slice information related to an
area of interest
0\. AMF has the information of its available and restricted S-NSSAIS per TAI
as defined in TS 23.502 [3] clause 5.2.16.3.
1\. Analytics Consumer subscribes to Nnwdaf_AnalyticsSubscription service
operation from NWDAF. In the subscription, the target of analytics is set to
\"any UE\" and the analytics filter information contain a list of S-NSSAIs,
and may contain the AoI. If it does not contain, NWDAF uses its own NWDAF
serving area information.
2\. NWDAF determines the AMFs associated with the TAs related to the area of
interest associated with the analytics subscription.
NOTE: The Procedure in clause 6.33.2 shall be used for NWDAF determining the
AMFs in an area of interest.
3\. NWDAF subscribe to Namf_EventExposure service offered by AMF to retrieve a
new type of event exposed by AMF: Available Network Slice Information in Area
of Interest. The target of the event is a list of S-NSSAIs and the event filer
is a list of TAs or Cells related to the area of interest of the analytics ID
subscription.
4\. (a,b) AMF is capable to control the mapping of TAs with its associated
access type, list of cells, and list of available S-NSSAIs.
4\. (c) When AMF detects changes related to list of available, or restricted
S-NSSAIs, or the access type, or list of cells associated with a TA indicated
in the event subscription, AMF uses the Namf_EventExposure_Notify service
operation to provide to NWDAF the updated information of the Available Network
Slice Information in Area of Interest.
5\. NWDAF process the received notifications from AMF and adds the changes in
the association of TAs with related cells, access type, and list of
available/restricted S-NSSAIs enclosed in the notification in the network map
for data collection. Such updated network map is used to provide analytics
outputs.
### 6.32.4 Procedure for Determining Applications, DNNs, DNAIs in AoI
The procedure in Figure 6.32.4-1 illustrate the enhanced mechanisms for NWDAF
to determine the PDU sessions associated with certain Applications, DNNs and
DNAIs within an area of interest specified per TA granularity.
Figure 6.32.4-1: NWDAF interactions for Determining Applications, DNNs, DNAIs
in AoI
1\. Analytics Consumer subscribes to Nnwdaf_AnalyticsSubscription service
operation from NWDAF. In the subscription, the target of analytics is set to
\"any UE\" and the analytics filter information contain a list of Application
IDs, and/or DNNs, and/or DNAIs, and may contain the AoI in the form of a list
of TAIs. If the subscription/request does not contain an AoI in the form of a
list of TAIs, NWDAF uses its own list of TAIs from the NWDAF serving area
information.
2\. NWDAF determines the AMFs associated with the TAs related to the area of
interest associated with the analytics subscription.
NOTE: The Procedure in clause 6.32.2 shall be used for NWDAF determining the
AMFs in an area of interest.
3\. NWDAF subscribe to Nsmf_EventExposure_Subscribe service operation. The
subscription includes the required Event ID, the event target is set to \"any
PDU session\", and event filers contain the same parameters of the analytics
filter information, i.e. list of Application IDs, and/or DNNS, and/or DNAI,
and the area of interest related to the requested analytics ID.
4\. (a,b) When SMF interacts with AMF via Nsmf_PDUSession_Create / Update /
CreateSMContext / UpdateSMContext due to session establishment, modification,
or release, service request, or handover procedures, AMF includes as input
parameter to the SMF services the UE Location.
5\. Based on the TA related to the UE Location information from AMF, SMF has
the mapping of the PDU sessions associated with TAs and, access type. This map
is used for the comparison with the event subscriptions from NWDAF. If there
are any changes in PDU sessions in the area of interest, for the Application
ID, and/or DNN, and/or DNAI subscribed by NWDAF, SMF will be able to detect
such change.
6\. SMF notify detected changes to NWDAF via Nmsf_EventExposure_Notify service
operation.
7\. NWDAF process the received notifications from AMF and adds the changes in
the association of Application IDs, and/or DNNs, and/or DNAIs serving an area
of interest enclosed in the notification in the network map for data
collection. Such updated network map is used to provide analytics outputs.
### 6.32.5 Impacts on services, entities and interfaces
NRF:
\- Extend input parameters of Nnrf_NFManagement_StatusSubscribe to support
area of interest per TA basis.
AMF:
\- Extend events exposed by AMF with new event ID for \"Network Slices
Information per Area of Interest\".
SMF:
\- Change UE Location parameter from optional to required input in SMF
services Nsmf_PDUSession_Create / Update / CreateSMContext / UpdateSMContext.
\- Enhance the target of event IDs to support \"Any PDU session\", and event
filters in SMF exposed events to support \"area of interest\", \"Application
ID\", \"DNN\" and \"DNAI\".
NWDAF:
\- Introduce the proposed procedures in NWDAF to keep a consistent network map
for data collection considering load in case of analytics
requests/subscriptions with analytics target set to \"Any UE\".
## 6.33 Solution #33: Signalling and computation load control by sobriety and
efficiency mechanisms
### 6.33.1 Description
#### 6.33.1.1 Introduction
This solution is proposed for Key Issue 11: Increasing efficiency of data
collection.
This solution includes several mechanisms for the prevention of high
signalling and computation load induced by usage of analytics. Such techniques
for the minimization of load and data collection can be categorized into two
groups:
1) _Sobriety_ is a set of mechanisms which allows an NWDAF service consumer to
relevantly adapt its requests to the NWDAF in order to optimize the usage of
resources. For example, avoid implicitly requesting more analytics than really
needed. Sobriety addresses the Nnwdaf interface, but also induces a positive
impact on NWDAF computation load and signalling load generated by NWDAF data
collection.
2) _Efficiency_ is the set of mechanisms that allows a service producer to
optimize the consumption of resources when fulfilling the demands at a given
service level. Efficiency addresses the interfaces used by the NWDAF for data
collection and the NWDAF internal logic.
The table below provide a non-restrictive list of possible features in order
to reduce signalling load.
Table 6.33.1.1-1: Sobriety and efficiency mechanisms
+----------------------+----------------------+----------------------+ | Optimisation | Sobriety | Efficiency | +----------------------+----------------------+----------------------+ | Functional | Fine grain | | | optimisation | modularity of | | | | requested analytics | | +----------------------+----------------------+----------------------+ | Dimensional | Extension of | Extension of | | optimisation | existing Analytics | existing Analytics | | | Filters to other | Filters to other | | | events | events | | | | | | | New Analytics | | | | Reporting | | | | constraints (time | | | | granularity, | | | | ordering of results) | | +----------------------+----------------------+----------------------+ | Usage optimisation | Result aggregation | | +----------------------+----------------------+----------------------+
#### 6.33.1.2 Sobriety mechanisms
The sobriety mechanisms concern the Nnwdaf interface. They include the
following features.
a) Fine grain modularity of requested analytics:
This mechanism enables to specify in requests or subscriptions the following
features:
\- which subsets of output elements need to be provided for a given analytics
(e.g. NF load, resource usage or the analytics \"NF load\").
NOTE: This is the same as already specified in TS 23.288 [5] clause 6.6.1 for
network performance analytics.
\- which additional computations (e.g. peak value, variance) need to be
provided on a given output element. The analytics addressed are those which
already provide additional computations (e.g. Service Experience, NF load).
Such options are to be specified on a per-analytics basis.
b) Extension of Analytics filters:
This mechanism extends the Analytics Filters (e.g. Areas of Interest) to all
relevant analytics.
Table 6.33.1.2-1: Additional Analytics Filters
* * *
Existing analytics Filters proposed for Rel-17 Filters already specified in
Rel-16 Slice load level Area of Interest, load level threshold None UE
Mobility GUAMI / AMF Set ID Area of Interest UE Communication SMF/SMF set ID,
Area of Interest S-NSSAI, Application Id
* * *
The additional filters provide means in order to reduce the scope of data
collection (e.g. Area of Interest).
c) New Analytics Reporting constraints:
These parameters enable the service consumer to provide reporting constraints
to the NWDAF which may alleviate both computation and signalling load.
\- Time granularity: indicates the minimum and maximum duration of an entry in
a list of results (e.g. durations in Mobility, Communication, Congestion, QoS
sustainability).
\- Ordering of result objects: indicates criteria for the ordering of objects
(e.g. higher load first, higher duration first). This parameter, used in
conjunction with the Maximum number of objects requested by the consumer, may
help obtaining the most important objects without retrieving a complete list.
d) Aggregation of results:
There are use cases (e.g. overload) where aggregated analytics (e.g. average
load of a set of NFs) may be sufficient to take the first decisions (e.g.
trigger overload control and request finer grain analytics).
This mechanism enables the NWDAF service consumer to indicate whether detailed
lists of analytics or aggregated analytics (e.g. average of analytics of a
list) are requested:
\- When detailed lists of analytics are requested, all values among a list are
requested.
\- When aggregation is chosen, a single analytics value is provided for the
whole set.
The consumption of aggregated analytics minimizes the volume of transferred
data between NWDAF and NWDAF consumer and spares the computation of the
aggregated by the NWDAF consumer.
The general rule for aggregation is: the aggregated value is provided with an
identical computation rule as done per subset, but performed instead on the
whole set.
The table below provides proposals for each analytics of TS 23.288 [5].
Table 6.33.1.2-2: Analytics aggregation per analytics
+----------------------+----------------------+----------------------+ | Existing analytics | Aggregation | Detailed lists | +----------------------+----------------------+----------------------+ | Slice load level | Average load or on | Load per each TA | | | the global network | (Rel-17) | | (NOTE 1) | (Rel-16) or on an | | | | Area of Interest | | +----------------------+----------------------+----------------------+ | NF Load | Average value for a | List per each NF in | | | whole NF set | a NF set (Rel-16) | | (NOTE 2) | (Rel-17) | | +----------------------+----------------------+----------------------+ | Network Performance | A single network | One network | | | performance | performance | | | information entry | information entry | | | for the Area of | per Area subset | | | Interest (Rel-17) | (Rel-16) | +----------------------+----------------------+----------------------+ | UE Mobility | UE location provided | UE location provided | | | with granularity per | with granularity per | | (NOTE 3) | TA (aggregating | Cell | | | cells of each TA) | | +----------------------+----------------------+----------------------+ | NOTE 1: The Slice | | | | Load Level is | | | | provided globally in | | | | Rel-16, regardless | | | | of an area. The | | | | proposal for Rel-17 | | | | is to add the | | | | detailed list of | | | | load levels per TA. | | | | | | | | NOTE 2: The | | | | aggregated value | | | | (whole NF set) | | | | enables to estimate | | | | the global load for | | | | coarse grain | | | | monitor. In Table | | | | 6.5.3-1 of | | | | TS 23.288 [5], the | | | | values \"NF load\", | | | | \"NF status\" etc. | | | | would be changed | | | | into \"NF set | | | | load\", \"NF set | | | | status\" etc. in the | | | | case of aggregated | | | | value per NF Set. | | | | | | | | NOTE 3: The UE | | | | location is provided | | | | as \"TA or cells | | | | which the UE stays\" | | | | in Rel-16 but | | | | without control by | | | | the NWDAF consumer. | | | | The required level | | | | of granularity | | | | depends on the use | | | | case (hand-over, | | | | paging, application | | | | related-use case). | | | | The proposal is to | | | | be able to specify | | | | in the requests of | | | | subscription if the | | | | UE location is | | | | required per TA or | | | | per cell. | | | +----------------------+----------------------+----------------------+
#### 6.33.1.3 Efficiency mechanisms
The efficiency mechanisms address the interfaces used by NWDAF for (data
collection) and includes the following feature.
a) Extension of existing Analytics Filters to other events:
\- This mechanism consists in collecting only the data according to the
Analytics Filters.
\- Additional filters could be added in the NF Event Exposure.
Table 6.33.1.3-1: additional Analytics Filters in NFs Event Exposure
* * *
NF Filters proposed for Rel-17 Filters present in Rel-16 AMF NSSAI, Area of
interest SMF NSSAI, DNN DNAI change type, Traffic Descriptor
* * *
### 6.33.2 Impacts on services, entities and interfaces
Additional parameters to be specified on Nnwdaf and Nsmf services.
## 6.34 Solution #34: Simplify the redundancy in event report notification for
NWDAF data collection
### 6.34.1 General Description
This solution is to address KI#11.
This solution is based on the event reporting subscribing and notifying. One
or multiple NWDAF instances act as the consumers of event exposure service to
perform data collection.
NOTE 1: In the proposed solution, when the NWDAF acts as the consumer, the
data collection efficiency issue of NWDAF is addressed. In case a NF of the
type other than NWDAF acting as the consumer in the proposed solution, and
such NF is used dedicatedly for data collection as proposed in some solutions
for KI#11, the proposed solution is also applicable for addressing the data
collection efficiency issue of NWDAF. For other cases, the data collection
efficiency issue of NWDAF is not addressed with the proposed solution.
1\. Identify the redundancy:
When the producer of the event reporting subscribing service receives a new
event reporting subscription request, it performs a redundancy relationship
checks in order to find all valid event reporting subscriptions that subscribe
the same event report as the current subscription request does. This check can
be made, for example, by looking for subscription whose Event ID, Event Filter
Information, and if necessary, the Event Report Information are all identical
to the ones of the current subscription request.
Based on the result of the check, i.e. all of the event report subscriptions
that subscribe for the identical event report information to the current
subscription, the producer of the event reporting subscribing service checks
the data accessibility between the consumer of these subscriptions and the
consumer of the current subscription request. This check can be made based on
the data accessibility information provided in the current subscription
request, which, for example, identifies the NWDAF instances that are
collocated with the NWDAF instance consumer of current subscription request,
and these NWDAF instances collocated has data accessibility among them.
NOTE 2: The data accessibility is preconfigured in the consumer NF.
For every existed event report subscriptions that subscribe for the identical
event report information to the current subscription, if there is data
accessibility between the consumer of existed event report subscription and
the consumer of the current subscription request, the producer of this event
reporting subscribing service may identify the redundancy relationship between
the existed event report subscription and the current event reporting
subscription request. And if the producer of the event reporting subscribing
service accepts the current subscription request, it records this redundancy
relationship.
NOTE 3: The producer of the event reporting subscribing service records the
existed event reporting subscription as the original subscription and records
the current subscription as the redundant subscription in this redundancy
relationship.
NOTE 4: For one redundancy relationship, there can be more than one original
subscription, but only one redundant subscription.
The producer of the event reporting subscribing service may also inform the
consumer of the current subscription request about the redundancy
relationship. The redundancy relationship may include the consumer NF ID and
the Subscription Correlation ID of the original subscriptions. This redundancy
relationship is sent within event exposure subscribe response.
2\. Simplify the event report notification based on the redundancy:
When the producer of the event reporting subscribing service has decided to
send the event exposure notify to a specific consumer who has subscribed the
corresponding event reporting, depending on the redundancy relationship that
the producer has recorded:
\- If the record indicating this subscription is a redundant subscription, the
producer will simplify the notification by omitting a part of the information.
For example, the optional Event specific parameter list will be omitted in
notification. Then the producer will send the notification by event exposure
notify to the consumer.
\- if the record indicating this subscription is an original subscription or
if the record does not indicating any redundancy relationship for this
subscription, the producer will send notification without simplification in
the normal way to the consumer by event exposure notify, including all the
necessary information corresponding to the event reporting.
By doing so, less redundant event report information needs to be sent in the
notification to the consumers, i.e. the NWDAF instances.
3\. Retrieval of the data at the consumer:
When the consumer NF receives the event reporting notification associated with
the redundant subscription, the consumer NF may decide when and how to
retrieve the omitted information based on the redundancy relationship and the
data accessibility to other NFs.
Taking the NWDAF instance as an example, the data accessibility between
multiple NWDAF instances can be pre-configured. And the implementation of data
retrieval may be implemented by the coordination between the multiple NWDAF
instances.
The coordination between multiple NWDAF instances is FFS in KI#1.
4\. Unsubscribing or subscription update:
If the Subscription Correlation ID is received in the unsubscribe/subscribe
request:
\- If the subscription associated with the Subscription Correlation ID is
recorded as the original subscription in one or multiple redundancy
relationships, when this original subscription is unsubscribed, all these
redundancy relationships are removed from the record.
\- If the subscription associated with the Subscription Correlation ID is
recorded as the redundant subscription in the redundancy relationship, when
this subscription is unsubscribed, the redundancy relationship is removed from
the record.
### 6.34.2 Modification on Namf_EventExposure Service
Taking the Namf_EventExposure Service described in TS 23.502 [3] as an example
for this solution, the modifications are highlighted as following.
#### 6.34.2.1 Namf_EventExposure_Subscribe service operation
**Service operation name:** Namf_EventExposure_Subscribe.
**Description:** The consumer NF uses this service operation to subscribe to
or modify event reporting for one UE, a group of UE(s) or any UE.
**Input, Required:** NF ID, Target of Event Reporting: UE(s) ID (SUPI or
Internal Group Identifier or indication that any UE is targeted), ((set of)
Event ID(s) defined in clause 5.2.2.3.1, Notification Target Address (+
Notification Correlation ID))s, Event Reporting Information defined in Table
4.15.1-1.
**Input, Optional:** (Event Filter (s) associated with each Event ID; Event
Filter (s) are defined in clause 5.2.2.3.1, Subscription Correlation ID (in
the case of modification of the event subscription), Expiry time, Accessible
NF IDs.
NOTE: Accessible NF IDs is used for the AMF to check the redundancy
relationship between this subscription and the existed subscription that
subscribing the identical event report.
**Output, Required:** When the subscription is accepted: Subscription
Correlation ID (required for management of this subscription), Expiry time
(required if the subscription can be expired based on the operator\'s
policy)_._
**Output, Optional:** First corresponding event report is included, if
available (see clause 4.15.1), redundancy relationship.
The NF consumer subscribes to the event notification by invoking
Namf_EventExposure to the AMF. The AMF allocates an Subscription Correlation
ID for the subscription and responds to the consumer NF with the Subscription
Correlation ID. UE ID identifies the UE, SUPI and/or GPSI. Event ID (see
clause 4.15.1) identifies the events that the NF consumer is interested in.
The Subscription Correlation ID is unique within the AMF Set.
The ((set of) Event ID(s), Notification Target Address (+ Notification
Correlation ID)) helps the Event Receiving NF to co-relate a notification
against a corresponding event subscription for the indicated Event ID.
In the case that the NF consumer subscribes to the AMF on behalf of other NF,
the NF consumer include the Notification Target Address(+Notification
Correlation ID) of other NF for the Event ID which is to be notified to other
NF directly, and the Notification Target Address(+Notification Correlation ID)
of itself for the Subscription Correlation ID change event. Each Notification
Target Address(+ Notification Correlation ID) is associated with the related
(set of) Event ID(s).When the Subscription Correlation ID change due to the
AMF reallocation, the notification is sent to NF consumer which triggers this
subscription.
Event filter may include \"AN type(s)\" as part of the list of parameter
values to match, and it indicates to subscribe the event per Access Type.
Event receiving NF ID identifies the NF that shall receive the event
reporting.
If the Accessible NF IDs is included in the input, the AMF performs a
redundancy relationship check in order to find every valid historical event
reporting subscription that subscribes the same event report as the current
subscription does. This check can be made, for example, by looking for
subscription whose Event ID, Event Filter Information, and if necessary, the
identical Event Report Information are all identical to the ones of the
current subscription.
Based on the result of the check, the AMF may get a list of historical event
report subscriptions that subscribes the same event report as the current
subscription does. For each of these historical subscriptions, the AMF check
whether the Event receiving NF ID is matched with the Accessible NF IDs
provided by the input of the current subscription request. If there is one or
multiple matches, a redundancy relationship is recorded by the AMF. And within
this record, the historical subscription is indicated as original subscription
and the current subscription is indicated as redundant subscription.
NOTE: for one redundancy relationship, there can be more than one original
subscriptions, but only one redundant subscription.
When the consumer NF needs to modify an existing subscription previously
created by itself in the AMF, it invokes Namf_EventExposure_Subscribe service
operation which contains the Subscription Correlation ID and the new Event
Filters with Event ID to the AMF.
AMF will update the redundancy relationship record with the Subscription
Correlation ID first:
\- if the subscription associated with the Subscription Correlation ID is
recorded as the only original subscription or one of multiple original
subscriptions in one or multiple redundancy relationships, when this original
subscription is unsubscribed, all these redundancy relationships are removed.
\- if the subscription associated with the Subscription Correlation ID is
recorded as the redundant subscription in one redundancy relationship, when
this subscription is unsubscribed, the redundancy relationship is removed.
If the accessible NF IDs is also provided in this
Namf_EventExposure_Subscribe, the AMF check the redundancy relationship
according to the Accessible NF IDs as above.
#### 6.34.2.2 Namf_EventExposure_UnSubscribe service operation
**Service operation name:** Namf_EventExposure_UnSubscribe.
**Description:** The NF consumer uses this service operation to unsubscribe
for a specific event for one UE, group of UE(s), any UE.
**Input, Required:** Subscription Correlation ID.
Input, Optional: None.
**Output, Required:** Operation execution result indication _._
Output, Optional: None _._
The NF consumer unsubscribes the event notification by invoking
Namf_EventExposure_Unsubscribe (Subscription Correlation ID) to the AMF.
AMF checks redundancy relationship record with the Subscription Correlation
ID:
\- or one of multiple original subscriptions in one or multiple redundancy
relationships, when this original subscription is unsubscribed, all these
redundancy relationships are removed.
\- if the subscription associated with the Subscription Correlation ID is
recorded as the redundant subscription in one redundancy relationship, when
this subscription is unsubscribed, the redundancy relationship is removed.
#### 6.34.2.3 Namf_EventExposure_Notify service operation
**Service operation name** : Namf_EventExposure_Notify.
**Service operation description:** Provides the previously subscribed event
information to the NF Consumer which has subscribed to that event before.
**Input, Required:** AMF ID (GUAMI), Notification Correlation Information,
Event ID, corresponding UE(s) (SUPI(s) and if available GPSI(s)), time stamp.
**Input, Optional:** Event specific parameter list.
Output, Required: None _._
Output, Optional: None _._
When the AMF detects a UE access and mobility event corresponding to a
Subscription, it invokes Namf_EventExposure_Notify service operation to the NF
consumer(s) which has subscribed to the UE mobility event before. The event is
notified towards the consumers for which the Event filters (which may include
\"AN type(s)\") match. The Notification Target Address (+ Notification
Correlation ID) indicates to the Event Receiving NF the specific event
notification subscription. The event specific parameter indicates the type of
mobility event and related information, e.g. Registration Area Update/new
Registration Area.
The optional event specific parameter list provides the values that matched
for generating the event notification. The parameter values to match are
specified during the event subscription (see clause 5.2.2.3.2). For example if
the event type reported is \"AN change\", the event specific parameter list
contains the value of the new AN.
According to the redundancy relationship record, if the subscription is a
redundant subscription, the optional event specific parameter list is omitted.
### 6.34.3 Impacts on services, entities and interfaces
Impact on services:
\- The 5GC NF\'s event exposure service that consumed by NWDAF, such as
Namf_EventExposure, Nsmf_EventExposure, Npcf_EventExposure,
Nudm_EventExposure, Nnef_EventExposure, and Naf_EventExposure services may
need modification to support the redundancy relationship check and
notification simplifying.
Impact on NWDAF:
\- The data accessibility to other NWDAF instances needs to be pre-configured.
\- The coordination between multiple NWDAF instances is needed.
## 6.35 Solution #35: Using a dedicated NF for data collection
### 6.35.1 Description
#### 6.35.1.1 Introduction
This solution is proposed for Key Issue #11: Increasing efficiency of data
collection and Key Issue #1: Logical decomposition of NWDAF and possible
interactions between logical functions and Key Issue #2: Multiple NWDAF
instances.
The solution proposes Network Functions to provide the data required by the
NWDAF to derive analytics to a dedicated NF that collects data from multiple
NFs (Event Providers). This is illustrated below.
Figure 6.35.1.1-1: Proposed NWDAF architecture utilising the DCNF
The advantage with this approach is that the NWDAF collect data from a single
NF (DCNF) reducing the load at the NWDAF on identifying the NF that contains
the required data. An example is shown in Figure 6.35.1-2 where the NWDAF
requires location information from the AMF to derive analytics on location
changes. All AMFs in the PLMN provide location events to a single network
function (DCNF). The NWDAF subscribes from the DCNF to retrieve the relevant
data to derive analytics.
Figure 6.35.1.1-2: NFs providing data to a central data storage NF
The DNCF may be a functionality within the NWDAF or may be a separate Network
Function supporting a dedicated data collection functionality. The advantage
of the latter is that it reduces the processing load at an NWDAF as each NWDAF
will have a single point of contact with the DCNF when subscribing to be
notified of one or more Events.
To support NWDAFs deployed in a distributed environment a DCNF is configured
to support a serving area (stored in the NRF). The NWDAF discovers a DCNF
supporting a specific serving area from the NRF.
#### 6.35.1.2 Data collection procedure from a DCNF
The method how each NF identifies what Events need to be provided to the DCNF
is as follows:
\- The NWDAF subscribes from the DCNF using a new Ndcnf service, with a list
of one or more Events that the NWDAF needs to be notified to derive analytics.
The NWDAF identifies the Events based on the Analytics request by a consumer
NF.
\- The DCNF determines from the list of Events the NF types that needs to be
contacted. The DCNF is configured with the NF types that provides the Event
ID.
The DCNF subscribes from each identified NF with a corresponding list of one
or more Events to be notified by re-using the existing Event Exposure services
listed in TS 23.288 [5] to collect data.
\- There are two methods proposed for the DCNF to collect data. The DCNF
selects the method based on configuration.
\- Method 1: The DCNF interfaces with all NF instances of the same NF type
(e.g. all AMFs) to obtain data. The advantage of this option is that a DCNF
will not have to identify constantly the NF that contains the required data
(for example when a UE moves between AMFs). The disadvantage is that the DCNF
may need to manage multiple event subscriptions. However, in this case NF that
do not have relevant data will not notify the DCNF.
\- Method 2: The DCNF interfaces only with the NF that has the required data.
For example, if an Event ID requested target a specific UE the DCNF determines
the NF serving the UE, from the NRF/UDM/BSF as described in TS 23.288 [5]
clause 6.2.2.
\- When an Event occurs each NF that the DCNF has subscribed to notifies the
DCNF with the data associated with the Event (e.g. TAI. Cell ID if the Event
is Location Changes). The DCNF forwards the notification to the NWDAF having
subscribed to the event notification.
The following signal flow describes the procedure.
Figure 6.35.1.2-3: Method for the NFs to publish data to a DCNF
0\. DCNF registers with the NRF. The DCNF may include in the registration
request the Service Area supported (e.g. geographical area, or cell ID, TAI)
and a list of S-NSSAI(s) indicating the network slices supported
1\. A Consumer NF requests from the NWDAF to provide analytics. For example,
an NF may request analytics on Observed Service Experience for a specific UE
(identified by a SUPI) that uses a specific application on a specific DNN. The
request may indicate that the analytics should be filtered on a specific area
of interest or specific network slices (S-NSSAIs).
2-3. NWDAF discovers the DCNF from the NRF. The NWDAF may include in the
request the Service Area and/or list of S-NSSAI(s) if the Analytics request in
step 2 included this information.
4\. The NWDAF identifies the Events that needs to be collected according to TS
23.288 [5] (each analytics request with specific analytic ID requires specific
list of one or more Event ID(s).
5\. The NWDAF subscribes from the DCNF (using the Event Exposure
subscribe/notify service operation) a list of one or more Events (identified
by Event ID(s), that need to be notified. The NWDAF may include an indication
that the notification should be filtered in an area of interest or applicable
only to specific network slices, if such information was requested in step 2.
The request also includes a Notification Correlation ID.
6\. The DCNF identifies the NF types that needs to be contacted based on the
provided list of Event ID(s). The DCNF is configured with the NF types that
provides the Event ID.
If Method 1 is used the DCNF discovers the NF instances of the identified NF
type from the NRF. This is supported by the DCNF sending an Nnrf_NF_Discovery
request with input the NF type of the target NF to the NRF. The NRF responds
with a list of NF instances.
If Method 2 is used the DCNF determines the NF instance to collect the data as
described in clause 6.2.2 of TS 23.288 [5]. For example, an AMF instance is
determined by querying the UDM to provide the AMF instance serving the UE.
7\. The DCNF subscribes to each identified NF type including a list of one or
more Event ID(s) associated to the NF type. The DCNF uses the existing Event
Exposure APIs provided by each NF to retrieve the relevant data. The DCNF
subscribes to all NFs of specific NF type (e.g. if NF type is AMF the DCNF
subscribes to all AMFs) which avoid the need to track what NF contains the
required information (e.g. NF that serves a specific UE). The DCNF may contact
NFs of NF type in specific area of interest or supported network slice
(identified by S-NSSAI) if the request in step 5 included such information.
The request also includes a Notification Correlation ID that is used by the
DCNF to correlate this request with the subscription from the NWDAF in step 5,
that is, the DCNF maintains a mapping of the subscription from the NWDAF to
the subscription(s) to each NF type.
8\. When an NF identifies that an Event that the DCNF has subscribed to,
occurs, the NF notifies the DCNF
9\. Each NF that the DCNF has subscribed to provides a notification that an
Event (identified by an Event ID) has occurred. The notification includes the
data associated to the Event ID and the Notification Correlation ID provided
in step 7.
10\. The DCNF forwards the data provided by notifying the NWDAF. The DCNF
identifies the EventNotification subscription message using the Notification
Correlation ID. The DCNF may also store the data for the case a separate
consumer NWDAF requires data associated to the same Event.
11\. The DCNF notifies the NWDAF with the relevant data
12 NWDAF builds analytics based on data collected.
#### 6.35.1.3 Data collection procedure from a DCNF by multiple NWDAFs
A DCNF requires to handle Event Notification subscriptions from multiple
NWDAFs. As multiple NWDAFs may request subscription to the same Event a
further signalling optimisation is for the DCNF to re-use existing Event
Notification Subscription(s) from each NF when reporting Events to each NWDAF.
The cases are:
\- If multiple NWDAFs subscribe to the same Event ID, i.e. target the same
UE(s) or target the same area of interest the DCNF re-use an existing Event
Notification subscription to each network function of the same NF type that
report this Event and relay the information to multiple NWDAFs.
\- If multiple NWDAFs subscribe to the same Event ID but contains different
criteria, e.g. a second NWDAF subscribes to be notified of Events targeting a
different UE the DCNF modifies an existing Event Notification subscription to
NFs of the same NF type that report this event, requesting additional criteria
to be reported from the same Event.
\- If multiple NWDAFs subscribe to Event ID(s) that can be reported by the
same NF type the DCNF modifies an existing Event subscription towards one or
more network functions of the same NF type to report additional Event IDs. For
example, the DCNF may have an existing Event Subscription with an AMF
providing notifications of Event ID \"Location Changes\". When a second NWDAF
subscribes to the DCNF to be informed of notifications of Event ID
\"Reachability Status\" changes, the DCNF may modify an existing event
subscription to all NFs of the same NF type adding the additional Event ID
\"Reachability Status\" to be reported to the DCNF.
The DCNF may store the data related to an Event ID locally in case a second
NWDAF request data associated to the same Event ID. Such approach will reduce
the load of signalling and the latency to retrieve the required data. The DCNF
determine for which Event ID(s) the associated data need to be stored locally
based on local configuration. For example, the DCNF is configured to store
locally data related to Event ID(s) that will be used/requested frequently by
an NWDAF (e.g. UE location requests provided by an AMF). The DCNF may remove
from the local cache data for an Event ID if the data are not frequently
requested by a Consumer NF.
NOTE: How the DCNF stores/delete the information locally is based on
implementation and out of scope of 3GPP.
When the DCNF determines that a second NWDAF have subscribed to an existing
Event ID subscription the DCNF does not request a new subscription for the
Event from the associated NF type, forwards notifications of the existing
subscription for this Event and also provide all available local data for this
Event to the second NWDAF.
The call flow below provides the procedure.
Figure 6.35.1-4: Support of multiple NWDAFs subscribing to DCNF with a list of
Event ID(s)
More details of the call flow are provided below:
1-6. Steps 1 through 6 are the same as the steps 1 - 8 in Figure 6.36-3.
7-8. The DCNF also forwards the Event Exposure Notification to NWDAF 1.The
DCNF may locally store the information provided by each NF.
NOTE: How the DCNF stores the information locally is based on implementation
and out of scope of 3GPP.
9\. At some point a second NWDAF (NWDAF 2) may receive a request to provide
analytics output. The NWDAF 2 subscribes to the DCNF for the Events required.
10 The NWDAF 2 subscribes from the DCNF with a list of one or more Events to
be reported.
11\. The DCNF subscribes for new Events or modifies an existing subscription
or provides locally available Events as follows:
\- The DCNF uses an existing subscription to NF(s) if the request from NWDAF 2
matches to the request from NWDAF 1, i.e. the criteria for the Event ID(s)
requested by the NWDAF 2 match the criteria for the Event ID(s) requested by
NWDAF 1.
\- The DCNF may modify an existing subscription to NF(s) if the request from
NWDAF 2 can be supported by an existing Event Notification Subscription
towards specific NF types. For example, the DCNF may determine that the
request from NWDAF 2 requires the same Events to be reported as with NWDAF 1
but contains different criteria (i.e. targets different UEs or different
service area), or the request from NWDAF 2 requires Events that can be
reported by the same NF types that the DCNF has an existing subscription with.
\- The DCNF creates a new subscription to NF(s) if there is no existing
subscription from other NWDAF to report this Event ID.
\- For all cases the DCNF maintains an internal mapping between the Event
Notification subscription from each NWDAF and the Event Notification
subscriptions to the NF for a particular Event ID.
12\. The DCNF subscribes to new Events or modifies an existing subscription
according to step 11.
13\. The NF sends an Event Notification including the Event ID.
14\. The DCNF determines the NWDAF(s) to forward the Event Notification
message for this Event ID based on its mapping table. The DCNF may also store
the data locally and provide such local data when a new NWDAF request data
associated to this Event ID.
15a.-15b The DCNF forwards the Event Notification to NWDAF 1 and/or NWDAF 2.
### 6.35.2 Impacts on services, entities and interfaces
\- New service e.g. Ndcnf_Event_Exposure service is required to be supported
by the NWDAF for interfacing with the DCNF.
\- 5G NFs impact: In method#1, all NFs need to store the DCNF event
subscription for future use, even if the NF does not have the event context
e.g. even if NF does not know whether a UE will attach to the NF, but need to
accept the DCCF event subscription.
## 6.36 Solution #36: Determining UPFs serving UEs or in Area of Interest
### 6.36.1 High-level Description
This solution focus on KI#11 on determining UPFs that are serving UEs and/or
area of interest.
This solution proposes the extension of SMF events to provide also information
about UPFs associated with UEs traffics or PDU sessions in an area of
interest. The procedure in Figure 6.36.1-1 illustrate the enhanced mechanisms.
Figure 6.36.1-1: Procedure for NWDAF Determining UPFs serving UEs or area of
interest
1\. Analytics Consumer subscribes to Nnwdaf_AnalyticsSubscription service
operation from NWDAF requesting the analytics ID = \"Service Experience\".
2\. If the subscription is includes a list of UEs NWDAF needs to determine the
UPFs serving such UEs. If the subscription is set to \"Any UE\", NWDAF has to
determine the UPFs according with the analytics filter information of the
subscription.
3\. NWDAF invokes Nsmsf_EventExposure_Subscribe service operation offered by
the determined SMF(s) request in the new event ID=\"UPF Change\". The target
of the event ID can be either a list of UEs, PDU sessions, or any PDU session
(in case of analytics subscription with \"any UE\"). In case of \"any PDU
session\", the event filters should reflect the same analytics filters used in
the analytics ID request/subscription.
4\. Upon the execution of session establishment, modification, and release,
SMF identifies eventual changes in UPFs associated with UEs or to the filters
used by NWDAF subscription to the \"UPF change\" event ID.
5\. SMF notifies NWDAF about the changes in the UPF serving UEs or serving PDU
sessions matching the event filter information used in the NWDAF event
subscription. The event notification may include new UPF IDs, the PDU session
ID, QFIs with associated (Application Identifier or IP Packet Filter Set or
Ethernet Packet Filter Set), DNN, DNAI, SUPI and S-NSSAI.
6\. NWDAF process the received notifications from SMF and updates the list of
UPFs reflecting the changes in UPFs serving UEs or area of interest enclosed
in the notification. Such updated information about UPFs is used to provide
analytics outputs.
### 6.36.2 Impacts on services, entities and interfaces
SMF:
\- Extend events exposed by SMF with new event ID for \"UPF Change\".
NWDAF:
\- Consume the new exposed event from SMF for determining UPFs serving UEs or
area of interest.
## 6.37 Solution #37: Reduction of Frequency from NFs
### 6.37.1 General
This solution is proposed for Key Issue 11: Increasing efficiency of data
collection. Additionally, this solution addresses the issue of triggers for
NWDAF data collection defined in KI#13: Triggering conditions for analytics.
This solution enables NWDAF to collect data and basic analytics from the NFs
via Event Exposure framework for both training and inference. The Event
Exposure framework is extended to enable the reduction of signalling between
NFs and NWDAF considering two factors: reduction of frequency of
notifications, and reduction of volume of data exposed by the NFs.
This solution can be combined with enhancements proposed by other solutions
proposed for KI#11 based on the event exposure. In addition, this solution is
applicable if the data collection is performed by NWDAF or by any other
dedicated NF as proposed in some solutions for KI#11.
### 6.37.2 High-level Description
Data collection is especially important for UE dedicated analytics (mobility,
communication, exceptions, service experience), where it is essential to
gather data over a long period before being able to produce accurate
analytics. Permanent data collection for all UEs generates high signalling and
computation load. It is however necessary to obtain information about the
recent events of an UE and possibly basic statistical trends, without
collecting events about a UE all the time.
The solution consists in letting each NF producing events for the NWDAF,
permanently log a subset of the most important events for each UE, and
maintain basic statistics on the events.
This solution proposes two complementary mechanisms:
\- An enhanced mechanism in the Event Exposure for data collection of past
events (or a subset thereof), where NWDAF, i.e. the consumer of the exposed
events, can activate or deactivate the reception of notifications from the
NFs. This allows NWDAF to collect data from NFs in bulks and reduce the
signalling , i.e., frequency of notifications, between NF and NWDAF.
\- An additional mechanism to aggregate in the NF the data related to events.
#### 6.37.2.1 Signalling Reduction: Data collection of past events
The data collection of past events mechanism reuses the Event Reporting
Information field of Event Exposure Framework to include the following flags:
\- Deactivate notification flag: The event consumer NF includes in the
subscription to an event ID the deactivation flag to indicate to the event
provider NF to collect, store the requested event but halt the notification to
the consumer. The number of stored events may be limited based on NF
configuration; when this number is reached, the NF continues to store new
events and deletes the oldest events.
\- Activate-deactivate notification flag: The event consumer NF includes in an
event subscription modification request the subscription identification and
the activate-deactivate flag to indicate to the event producer NF to send the
past collected events not already sent to this consumer NF. After sending the
past collected events the event producer continues to store events without
sending notifications to the event consumer.
Alternatively, the event provider NF is configured to store events for all the
UEs it serves without a trigger from the NWDAF, with a limit in the number of
stored events; when this number is reached, the NF continues to store new
events and deletes the oldest events. The event provider NF provides the
stored events upon request or subscription from a consumer NF. When a request
from NWDAF is received, the NF selects the collected data that matches to the
period specified in the NWDAF request.
Using the enhanced mechanism in the Event Reporting Information, NWDAF can
subscribe to events from NFs such as AMF and SMF, avoid notifications and
retrieve the data in bulk when NWDAF requires.
#### 6.37.2.2 Data Volume Reduction: Data Collection of aggregated data
The Data Collection of aggregated data related to events mechanism lets the
event provider NF build for each UE a set of basic statistics tables on UE
states (e.g. registered, connected to a cell, idle, located in a TA) for
different time frames. These tables are updated incrementally at the
occurrence of a new event with little computation effort. The NF purges this
information when the UE is no longer served by the NF.
Based on configuration, the event provider NF either maintains these
statistics tables for all the UEs it serves, or only when an event consumer NF
has subscribed to receive them. In the former case, the NWDAF will be able to
collect statistical information on past UE states without having to
permanently collect information on all UEs.
### 6.37.3 Exposed NF Data
#### 6.37.3.1 Past events
The NWDAF collects from NFs the same data as defined in TS 23.288 [5] when
subscribing to an Event ID, but collects this data in bulk instead of
receiving a notification at every occurrence of an event.
#### 6.37.3.2 Aggregated data
The NWDAF collects the following types of aggregated data exposed by AMF, SMF
and AF for each of the UEs served by the respective NF, using new Event IDs to
be specified for this purpose as part of the NF event exposure service.
NOTE: The names of the new Event IDs to expose the following types of data
will be determined during the normative phase.
a) A recent past statistics table T(0) for each type of UE states, containing
statistical entries per UE state, over a recent time. This table is cleared
periodically with a period T0 (e.g. with T0 = 1 hour, T(0) will contain
statistics for the period started at the top of the current hour) and at that
time its data may be used to update the historical analytics tables
T(1)..T(m). T(0) contains the N most frequent UE states since the last time
T(0) was cleared, along with metrics (average, variance) which are computed
incrementally (e.g. using exponential moving average) using only the last
event and the previous metrics without need of storing the events.
Table 6.37.3.2-1: UE states statistics for the recent past
* * *
Information for Table T(0) Description List of UE states (1..N)  
> State characteristics Key identifier of the state (e.g. Cell-ID) > Duration
> Metrics (average, variance) > Spacing Average and variance of the time
> interval separating two consecutive occurrences of the state. > Last
> occurrence Date of last occurrence > Number of occurrences Counter
* * *
b) Optional historical analytics tables T(1)..T(m) over increasing periods
T~1~..T~m~. Each period T~k~ is a multiple of period T~0~. Each entry of
metrics Duration or Spacing in table T(k) is computed incrementally using only
the metrics in table T(0) before clearing T(0) and the previous metrics in
T(k).
Table 6.37.3.2-2: UE states statistics on longer period
* * *
Information for table T(k) Description List of UE states (1..N)  
> State characteristics Key identifier of the UE state (e.g. Cell-ID) >
> Duration Metrics (average, variance) > Spacing Average and variance of the
> time interval separating two consecutive occurrences of the UE state.
* * *
c) A table T(g) of gauges over a moving period T~g~ (e.g. last hour),
measuring the ratio of occurrence of each event ID, to help classifying the UE
(i.e. for the AMF: Loss of Connectivity, Location Reporting, etc.). Each entry
is updated incrementally when an event occurs, e.g. using exponential moving
average.
Table 6.37.3.2-3: Event ID gauges
* * *
Information for table T(g)  
List of gauges (1..max) Event type 1 > Event ID Event identifier (e.g. Loss of
connectivity) > Spacing Average and variance of the time interval separating
two consecutive occurrences of the Event ID.
* * *
The values of parameters T~0~, N, T~1~..T~m~, T~g~ are configured in NFs,
consistently across the PLMN.
### 6.37.4 Procedures
#### 6.37.4.1 Data Collection with Signalling Reduction
The procedure in Figure 6.37.4.1-1 is used by NWDAF to control the frequency
of data collection from NFs via Event Exposure for data collection. This
mechanism for data collection from NFs with signalling reduction can be used
for collecting data that can support inference or training. Furthermore it can
be used for collecting past events or aggregated data related to events. In
the latter case, both signalling frequency as well as volume of data
collection are reduced.
Figure 6.37.4.1-1: Data Collection with Signalling Reduction reusing Event
Exposure from NFs
0\. (Optional) NF is configured to store collected data for all UEs it serves.
1\. The NWDAF subscribes for a (set of) Event ID(s) by invoking the
Nnf_EventExposure_Subscribe service operation including in event reporting
information the deactivate notification flag. The NF sends a response back
including the Subscription Correlation ID and an indication of successful
deactivation of notifications. The triggers for NWDAF subscribing to NF with
the enhanced mechanism are: local policies (e.g., to allow NWDAF to prepare
for future requests of analytics IDs as defined in TS 23.288 [5] clause
6.2.1), or need for having data for model training. The NWDAF may request the
NF to store data related to Event ID(s), or aggregated data related to UE(s).
2\. Once the NF received the request from NWDAF, there are two alternatives of
actions.
2a. (If NF is not configured to store collected data for all UEs it serves)
The NF triggers a window of offline event collection for the NWDAF
subscription with the indication of \"deactivate notification flag\". The NF
keeps the association between the Event ID, Subscription Correlation ID (which
identifies the consumer of the event), subscriber information (e.g.
notification target information) and the status of the transaction between the
NF and the NWDAF as \"collecting events / non-notification\".
2b. (If NF configured to store collected data for all UEs it serves) The NF
selects the data from the stored collected data to be associated with the
request from NWDAF and further associates the NWDAF request to the collection
of further events.
3\. Upon local policies, NWDAF decides that the events requested from the NF
with deactivation of notification, are now required.
4\. NWDAF invokes the event subscription service operation from the NF
including, with the Event ID, the Subscription Correlation ID, and the
activate- deactivate notification flag. These parameters denote the
identification of the transaction required by the NWDAF, i.e. retrieve data
for a subscribed Event ID and trigger a new time window of event generation
without notification.
5\. NFs based on the parameters received in the request from NWDAF if there is
an existent subscription to an Event ID with a deactivate notification flag.
In positive case, NF identifies and sends the past collected events in the
period between the received activate-deactivate flag and the last deactivate
flag received from the consumer for such subscription identification.
6\. The NFs check whether overall event reporting information (e.g. the
maximum time window for the subscription of such Event ID) has expired. If
yes, it does not trigger another round of offline event collection and
deactivates the subscription. If not expired, the NFs trigger another time
window for collecting the requested event ID(s) without notifying them to
NWDAF.
NOTE: NWDAF can change an existing subscription to an NF using the Data
Collection with Signalling Reduction mechanisms into a regular notification of
events, i.e., with notifications from NFs instead of bulk retrieval of events.
To achieve this, NWDAF has to modify the event subscription removing the
deactivate notification flag from the event reporting information and
including the new event reporting information.
#### 6.37.4.2 Data Collection with Data Volume reduction
The procedure in Figure 6.37.4.2-1 is used by NWDAF to collect data required
to produce analytics requested by an NWDAF service consumer or for model
training. It enables the NWDAF to obtain data related to events that have
occurred prior to this request, and to reduce the volume of data to collect
for past and future events.
Figure 6.37.4.2-1: Procedure for Data Collection of Aggregated Data from UEs
1\. [Conditional] If configured to store events for all the UEs it serves, the
event provider NF (AMF, SMF or AF) starts collecting and aggregating events
related to a UE when it is allocated to this UE.
2\. One of the following events triggers the procedure:
2a/2b: The NWDAF decides to collect data on its own initiative, based on local
policies or for model training.
2c: A NWDAF service consumer sends a request to the NWDAF for UE related
analytics (see TS 23.288 [5] clause 6.7). The \"time when analytics
information is needed\" indicated by the NWDAF service consumer may not allow
enough time for the NWDAF to collect enough data (using Rel-16 procedures) to
provide analytics with the requested accuracy.
NOTE: The call flow only shows a subscription-notification model for the
interaction of NWDAF and NWDAF service consumer for simplicity instead of both
request-response model and request-response model.
3\. The NWDAF subscribes for some of the information described in clause
6.37.2.2. The NWDAF may include the deactivate notification flag in event
reporting information if the NWDAF does not need immediate results.
4-5. [Conditional] If the NF had performed step 1 and the deactivate
notification flag is not set, the NF immediately sends a first notification to
the NWDAF including the requested information, related to events that occurred
before the NWDAF subscription. The NWDAF derives requested analytics and
provides them to the NWDAF service consumer.
6\. [Conditional] At the end of every T~0~ period, if the deactivate
notification flag is not set, the NF sends a notification to the NWDAF
including the requested information, related to events that occurred since the
previous notification; otherwise the NF stores this information for later
notification to the NWDAF, as described in steps 2b-5 of clause 6.37.4.1.
7\. [Conditional] If NWDAF received a request for analytics generation in step
2c, the NWDAF derives new analytics and provides them to the NWDAF service
consumer.
8-11. When UE leaves the NF, the NF purges the information it has stored
related to events except information stored for later notification to the
NWDAF due to the deactivate notification flag. If the subscription from NWDAF
is still active and the deactivate notification flag is not set, the NF sends
a last notification to the NWDAF including the requested information, related
to events that occurred since the previous notification. The NWDAF derives new
analytics and provides them to the NWDAF service consumer.
12\. The NWDAF cancels the subscription started at step 3 by invoking the
Nnf_EventExposure_Unsubscribe service operation.
### 6.37.5 Impacts on services, entities and interfaces
Nnf_EventExposure service is extended with deactivation and activation-
deactivation flags.
Naf_EventExposure, Namf_EventExposure, and Nsmf_EventExposure services: new
Event IDs for offline aggregation of past events.
NWDAF:
\- Triggering the new procedure for data collection with signalling reduction
and data collection with data volume reduction.
The proposed solution is compatible with Rel-16 specification.
## 6.38 Solution #38: Enhancement on network exposure to allow data
approximation
### 6.38.1 Description
#### 6.38.1.1 General
This is a solution for Key Issue #11 and #18: \"Increasing efficiency of data
collection\" and \"Enhancement for real time communication\".
To increase the efficiency of network data collection from NF and to enable
real-time or near-real time data collection, this solution proposes to improve
the network exposure service (see clause 4.15 in TS 23.502 [3]) of NFs. The
solution includes i) to allow some errors on the required data in each NF\'s
notification, where the maximum allowable error is set by the consumer NF
(i.e. NWDAF), and for the producer NF ii) to notify not the all the requested
data but a set of data that has differences from the previous notification.
For the detail, this solution introduces new parameters \"Event Reporting
Granularity\" and \"Reporting Type\" as Event Reporting Information (see
clause 4.15.1 in TS 23.502 [3]) in Nnf_EventExposure_Subscribe operation,
where the \"Event Reporting Granularity\" indicates the maximum allowable
error in the requested data for each notification compared to the previous
one, and \"Reporting Type\" indicates to notify the requested data with either
a set of data that has difference from the previous notification, or all the
requested data for this notification.
If the Event Reporting Granularity is set by consumer NF (i.e. NWDAF) in event
exposure subscription, the producer NF shall send the first notification with
all the requested data, and then, from the second notification, the NF shall
not notify the requested data to the NWDAF, if the changes in data are
described in the Event Reporting Granularity by the end of event notification
cycle.
In the perspective of the NWDAF, if the NWDAF does not receive the
notification of the requested data at the end of reporting cycle, the NWDAF
shall infer the data from the previously reported one with Event Reporting
Granularity. So, the NWDAF can have full history of the required data for
every reporting cycle during subscription period and enables to significantly
reduce frequency of notification.
Also, in order to reduce reporting data volume, this solution proposes that
the producer NF can send the notification with the difference from the
previous one, when \"Reporting Type\" indicates to use differences.
If \"Reporting Type\" is set to use a set of data that has differences from
the previous notification, the NF shall notify only the data which are newly
added or deleted or changed or not described in \"Event Reporting
Granularity\" if \"Event Reporting Granularity\" is applied, compared to the
previously notified one, at the end of event notification cycle. Otherwise,
when \"Reporting Type\" is set to use exact value, the NF shall notify whole
set of the requested data at the end of event notification cycle.
In the perspective of the NWDAF, when NWDAF sets \"Reporting Type\" as use a
set of data that has difference from the previous notification, and receives
the notification with the data that are newly added or deleted or changed or
not described in \"Event Reporting Granularity\" if Event Reporting
Granularity is applied, the NWDAF shall re-assemble the requested data with
the previously notified one and the newly notified one. So, using \"Reporting
Type\" enables to reduce the data volume of each notification without loss of
the requested data.
#### 6.38.1.2 Procedure to data collection from NFs
The following procedure describes for NWDAF to get the required data from the
provider NF to increase data collection efficiency and to support real-time
and near-real time data collection while allowing some errors.
Figure 6.38.1.2-1: Procedure for Event Reporting Granularity based conditional
NF data collection
0\. The NWDAF determines an appropriate maximum amount of error for the
required data to generate a certain analytics and set Event Reporting
Granularity and Reporting Type to collect the data.
1\. The NWDAF subscribes to subscription for NF\'s data collection by invoking
Nnf_EventExposure_Subscribe which includes Event Reporting Granularity and
Reporting Type as parameters.
2\. For every reporting cycle except for the first notification, if the change
in requested data is described in Event Reporting Granularity, NF shall not
notify the requested data to the NWDAF. Otherwise, NF shall notify the
requested data to the NWDAF with either a set of data that has difference from
previously notified one, or all the requested data according to indication of
Reporting Type in step 2 by invoking Nnf_EventExposure_Notify.
NOTE: The first notification only allows to notify all the requested data,
even if Reporting Type indicates to use a set of data that has difference.
3\. If the NWDAF does not receive the notification from the NF at the end of
each reporting cycle, NWDAF infers the requested data for the reporting cycle
from the previously notified one with the Event Reporting Granularity.
Otherwise, in case the notification is based on a set of data that has
difference, the NWDAF re-assembles the requested data for the reporting cycle
from the previously notified one with the received one, and in case the
notification is based on all the requested data, the NWDAF uses the data to
generate the analytics.
#### 6.38.1.3 Contents of Nnf_EventExposure_Subscribe operations
In addition to information defined in TS 23.502 [3],
Nnf_EventExposure_Subscribe contains the following in Event Reporting
Information:
\- Event Reporting Granularity: indicates the maximum amount of allowable
error for NWDAF on the requested data during each event reporting cycle, and
required data granularity of the requested data.
\- Reporting Type: indicates the type of notification value (i.e. either use a
set of data that has difference from the previous notification, or all the
requested data).
If the subscribed event ID supports to collect multiple data from the NF, the
consumer can respectively set Event Reporting Granularity for each data, and
the different type of Event Reporting Granularity can be applied to the
different type of collectable data as described in Table 6.38.1.3-1 as
follows.
Table 6.38.1.3-1 Event Reporting Granularity type and the corresponding
collectable data
+----------------------+----------------------+----------------------+ | | Corresponding data | Examples of Event | | | in Rel-16 | Reporting | | | specification | Granularity | +----------------------+----------------------+----------------------+ | Data expressed as | Application ID, IP | Either | | identification | filter information, | | | | Location of | i) Previous | | | Application (i.e., | notification | | | list of DNAI(s)), UE | | | | ID(s) (i.e., SUPI, | or | | | GPSI), UE group ID, | | | | DNN, S-NSSAI, QFI, | ii) List of | | | TAC, UE location, | identification | | | Exception ID, | (e.g., list of TA(s) | | | Exception trend | etc.) | +----------------------+----------------------+----------------------+ | Data expressed as | Service Experience, | iii) The range of | | number | QoS flow Bit Rate, | change: x, y | | | QoS flow Packet | | | | Delay, Packet | where \"x, y\" | | | transmission, packet | indicates the range | | | retransmission, | of allowable changes | | | Traffic usage | [-x, +y) from the | | | report, Number of | previously notified | | | UEs, Frequent | value. | | | Mobility | | | | Registration Update, | | | | UL data rate, DL | | | | data rate, Traffic | | | | volume, Exception | | | | Level | | +----------------------+----------------------+----------------------+
In case, i) \"Previous notification\" is applied to Event Reporting
Granularity, the producer NF sends a notification only when the data is
changed compared to previously notified one. For example, the NWDAF subscribes
Nnf_EventExposure service to collect UE ID with Event Reporting Granularity
set to Previous notification, the producer NF invokes
Nnf_EventExposure_Notify, only when some UE ID(s) are newly added or
disappeared, compared to the previous notification.
In case, ii) \"List of identification\" is applied to Event Reporting
Granularity, the producer NF sends a notification only when the change in
targeted data (i.e., identification) is not included in the \"List of
identification\". For example, the NWDAF subscribes Nnf_EventExposure service
to collect a UE Location with Event Reporting Granularity set to a certain a
list of TA(s), the producer NF invokes Nnf_EventExposure_Notify, only when the
location of UE is changed to a TA not in the list of TA depicted in Event
Reporting Granularity.
In case iii) \"The range of change\" is applied to Event Reporting
Granularity, the producer NF sends a notification only when the data changes
to exceed the range [(the data in previous notification - x), (the data in
previous notification + y)).
For example, if the NWDAF collects the number of UE in a certain area from the
AMF with the Event Reporting Granularity set by (x=10, y=11), the AMF shall
not notify to the NWDAF when the number of UE in that area changes within
[-10, +11) compared to the previous one. Then, NWDAF shall infer data for the
event reporting cycle within [previous data -10, previous data+11).
NOTE: Event Reporting Granularity and Reporting Type can be updated by re-
invoking Nnf_EventExposure_Subscribe.
When \"Reporting Type\" is set to use a set of data that has difference from
the previous notification, the NF shall notify only the data that are newly
added or deleted or changed or not described in \"Event Reporting
Granularity\" if \"Event Reporting Granularity\" is applied, compared to the
previous notification, at the end of event notification cycle. Otherwise,
\"Reporting Type\" is set to all the requested data, the producer NF shall
notify all the requested data for the subscription at the end of event
notification cycle.
#### 6.38.1.4 Contents of Nnf_EventExposure_Notify operations
When \"Event Reporting Granularity\" is set in Nnf_EventExposure_Subscribe
operation, the invoking condition for Nnf_EventExpsoure_Notify is as described
as follows.
\- An event ID supports to collect single data: the producer NF invokes
Nnf_EventExposure_Notify only when the change in data is not described in
Event Reporting Granularity.
\- An event ID supports to collect multiple data (e.g., Service Data from AF
in TS 23.288 [5]):
\- If Event Reporting Granularity is set to only a specific data, the producer
NF shall invoke Nnf_EventExposure_Notify when the change in the targeted data
is not described in Event Reporting Granularity.
\- Otherwise, Event Reporting Granularity is respectively set to multiple
data, the producer NF shall invoke Nnf_EventExposure_Notify when at least one
change over the data is not described in Event Reporting Granularity.
For example, if NWDAF collects the set of SUPI and UE location for a specific
group of UE from AMF (Event ID = Location Report), and Event Reporting
Granularity are respectively set to \"Previous notification\" for SUPI and UE
location, the producer NF shall invoke Nnf_EventExposure_Notify when at least
one UE location is changed from previous notification or targeted SUPI is
changed due to UE mobility (either new UE moves in or the existing UE moves
out).
When \"Reporting Type\" is set in Nnf_EventExposure_Subscribe operation, the
event specific parameters in Nnf_EventExpsoure_Notify contain the following:
\- \"Reporting Type\" is set to use a set of data that has difference:
\- If Event Reporting Granularity is not applied to subscription, the event
specific parameters shall include i) newly added data, ii) deleted data, and
iii) changed data compared to the previous notification. If the same data
compared to the previous notification is included in the notification, the
NWDAF recognises that the data is ii) deleted data in this notification.
Otherwise, NWDAF recognises the data as i) newly added data, or iii) changed
data.
\- Otherwise, Event Reporting Granularity is applied to subscription, the
event specific parameters shall include the data of which changes are not
described in Event Reporting Granularity. If the same data compared to the
previous notification is included in the notification, the NWDAF recognises
that the data is ii) deleted data in this notification. Otherwise, NWDAF
recognises the data as i) newly added data, or iii) changed data.
\- \"Reporting Type\" is set to use all the requested data: the event specific
parameters shall include all the requested data.
### 6.38.2 Impacts on services, entities and interfaces
This solution requires to extend the existing Nnf_EventExposure_Subscribe and
Nnf_EventExposure_Notify service operation and the feature of following node:
**NWDAF** : The NWDAF can determine a proper Event Reporting Granularity for
the required data to generate the analytics, and can infer the required data
over the subscription period from conditionally notified differences from the
previously notified one.
**All 5GC NFs exposing its events** : NF can provide the requested network
data in terms of differences from the previously notified one, only when the
change in data is not described in the given Event Reporting Granularity over
the event reporting cycle.
## 6.39 Solution #39: Efficient data management for minimizing signalling.
### 6.39.1 Description
This solution is proposed for Key Issue #11: Increasing efficiency of data
collection and Key Issue #1: Logical decomposition of NWDAF and possible
interactions between logical functions and Key Issue #2: Multiple NWDAF
instances.
The solution proposes a data repository and storage function to provide the
collected data by the NWDAF to another NWDAF function as illustrated below:
Figure 6.39.1-1: Architecture for NWDAF together with data repository and
storage function
The Data Repository and Storage Function (DRSF) is like a data base function
which does not carry the functional logic like backend device (e.g. like a
UDR), it contains:
\- Stores all NWDAF collected data and analytical information produced by the
NWDAFs.
\- Provide collected data based on request to other NWDAF.
\- Authorized for an access the stored data.
NWDAF provides the collected data to the DRSF and data profile can be
contained of one or more following parameter:
\- Data Producer details.
\- Data type e.g. slice data, mobility data QoS data, etc.
\- Timestamp e.g. collection time.
\- Data validity time e.g. validity of collected data.
\- Data validity area e.g. data is valid for specific TA or area or slice,
etc.
\- Data source NWDAF details e.g. NWDAF address, serving area.
### 6.39.2 Procedures
The principles for data collection and storage mechanism is as given below:
Figure 6.39.2-1: Procedure for data collection and storage mechanism
1\. NWDAF#1 collects the data from producer as step 1-2, clause 6.2.2.2, TS
23.288 [5].
2\. The NWDAF stores the collected data from the producer in the DRSF. In
addition, NWDAF also stores the determine analytics information. The collected
data also includes the validity conditions and data information to the
collected data.
3\. If the consumer request for the NWDAF_Analytics request to the NWDAF#2.
4-6. The NWDAF#2 retrieves the collected data from the DRSF and determines the
analytics information for the consumer. After, responds with analytics
information to the consumer.
### 6.39.3 Impacts on services, entities and interfaces
NWDAF: new mechanism needed to store the collected data and analytical
information in the DRSP.
New DRSF and Ndrsf interface are introduced.
## 6.40 Solution #40: User Data Congestion Analytics for NWDAF-assisted RFSP
policy
### 6.40.1 Description
This solution is proposed to address Key Issue #12: NWDAF-assisted RFSP
policy.
This solution specifies for how NWDAF can provide User Data Congestion
Analytics as defined in clause 6.8 of TS 23.288 [5] to a service consumer to
derive a suitable RFSP index. The Analytics Filter Information could contain
S-NSSAI.
### 6.40.2 Input Data
The same as clause 6.8.2 of TS 23.288 [5].
### 6.40.3 Output Analytics
The same as clause 6.8.3 of TS 23.288 [5].
### 6.40.4 Procedures
The same as clause 6.8.4 of TS 23.288 [5].
### 6.40.5 Impacts on services, entities and interfaces
PCF:
\- Using the output of User Data Congestion Analytics of NWDAF to make
decision on the RSFP index.
## 6.41 Solution #41: RAT/Frequency usage analytics
### 6.41.1 Description
This is a solution for Key issue #12: NWDAF-assisted RFSP policy.
In the 5G era, there could be various radio access technologies co-existence
in a same region. Each different RAT/frequency may provide different
communication characteristics to the user in terms of bandwidth, latency,
coverage, and power consumption. Therefore, it is desirable to guide a user to
use best RAT/frequency according to the usage type to manage radio resources
to maximize the efficiency.
The objective of this solution is to help keeping the entire network with
proper resources without degrading of services. To archive this objective, it
is essential to figure out the current and future radio demand per
RAT/frequency. If RAT/frequency is figured out with low or no demand in
current or near future.
As described in Use Case #1, MNO able to 1) inter-RAT selection between NR and
E-UTRA, and 2) frequency selection such as low and high frequency. This
contribution proposed a solution to allow 5GC to select or lead UE\'s
RAT/frequency based on RFSP index selection mechanism. According to the TS
23.501, RFSP index could be used 1) to derive UE specific cell reselection
priorities to control idle mode camping, and 2) to decide on redirecting
active mode UEs to different frequency layers or RATs.
The solution provides statistics/predictions to PCF to decide proper RFSP
index to lead UEs into desirable RAT/frequency by NWDAF. NWDAF provides
analytics information about the current/future usage of RAT/frequency for a
specific area. For example, in region A, 20 E-UTRA users and 5 NR users, and 3
users are using low frequency NR and 2 users are using high frequency NR.
Based on this analytics, PCF or OAM can decide to manage base stations or
radio resources by figuring out the usage demand per RAT/frequency. This
solution is based on the selection of RFSP index per UE, not impact to any
existing RAN or OAM mechanism.
#### 6.41.1.1 Information for the support of RFSP index selection
The consumer of these analytics shall indicate in the request or subscription:
\- Analytics Id set to \"Radio/Frequency usage\";
\- The Target of Analytics Reporting: Area of Interest;
\- Analytics Filter Information: one or more combinations of the following
Analytics Filters: S-NSSAI, RAT type;
\- An Analytics target period that indicates the time window for which the
statistics or predictions are requested; and
\- In a subscription, the Notification Correlation Id and the Notification
Target Address.
### 6.41.2 Input Data
The input data for the analytics is described in Table 6.41.2-1.
Table 6.41.2-1. Input data for Radio/Frequency usage
* * *
Information Source Description S-NSSAI AMF Identifies network slice Location
AMF The location of UE RFSP index AMF Currently configured RSFP index for a UE
QoS flow Bit Rate SMF The observed bit rate (UL/DL) Packet transmission SMF
The observed number of packet transmission (UL/DL)
* * *
Editor\'s note: It is FFS whether other data is needed or not, and how to
collect input data for the analytics.
### 6.41.3 Output Analytics
The output analytics of NWDAF is defined in Table 6.41.3-1 and Table 6.41.3-2.
Table 6.41.3-1: Radio/Frequency usage statistics
* * *
Information Description S-NSSAI (optional) Identifies the Network Slice for
which analytics information is provided. Total number of user The total number
of users Number of user per RAT type The number of users per specific RAT type
(e.g. NR, E-UTRA) Number of user per frequency The number of users per
specific RAT type (e.g. low, high) Total data volume The total data volume on
RAN Data volume per RAT type The data volume per RAT type (e.g. NR, E-UTRA)
Data volume per frequency The data volume per frequency (e.g. low, high)
* * *
Table 6.41.3-2: Radio/Frequency usage prediction
* * *
Information Description S-NSSAI (optional) Identifies the Network Slice for
which analytics information is provided. Predicted Total number of user The
total number of users Predicted Number of user per RAT type The number of
users per specific RAT type (e.g. NR, E-UTRA) Predicted Number of user per
frequency The number of users per specific RAT type (e.g. low, high) Predicted
Total data volume The total data volume on RAN Predicted Data volume per RAT
type The data volume per RAT type (e.g. NR, E-UTRA) Predicted Data volume per
frequency The data volume per frequency (e.g. low, high)
* * *
### 6.41.4 Procedure
Figure 6.41.4-1: Procedure to support RFSP index selection
0\. AMF and PCF create an association to handle UE\'s AM policy using
Npcf_AMPolicyControl_Create.
1\. PCF decide to adjust UE\'s RFSP index for internal management objective
such as energy saving.
NOTE: Configuring and internal actions of PCF to internal management objective
is out of scope.
2\. PCF request to subscribe \"RAT/Frequency usage\" analytics to figure the
current/future time to NWDAF. Target of reporting could be area of interest.
3\. The NWDAF collects necessary data from NFs/OAM, and derive
\"RAT/Frequency\" analytics for the request.
4\. The NWDAF notify the analytics outputs listed in Table 6.41.1.1-1.
5\. PCF derive new RFSP index suitable for the internal objective in step 1
for the UEs.
6\. PCF deploy the RFSP index to AMF using AM policy control to UEs.
### 6.41.5 Impacts on services, entities and interfaces
NWDAF:
\- The NWDAF collect data from NFs/OAM, and analyse RAT/Frequency usage
analytics.
PCF:
\- Receives the RAT/Frequency usage analytics from the NWDAF and consider it
for deciding RFSP index.
## 6.42 Solution #42: NWDAF-assisted RFSP Policy Configuration
### 6.42.1 Description
This is a solution for Key issue #12: NWDAF-assisted RFSP policy.
In general, the Rel-16 NWDAF architecture can be used as baseline to support
NWDAF-assisted RFSP policy configuration. NWDAF needs to obtain related
information from other NFs in 5GC and also OAM to perform analytics for RFSP
policy. Figure 6.42-1 provides a functional diagram.
According to TS 23.501 [2], RFSP index needs to be provided to NG-RAN to
derive cell reselection priorities for idle mode UEs and also redirecting
active mode UEs to other RATs.
### 6.42.2 Input Data and Output Analytics
Potential inputs from NFs and OAM (optional)to NWDAF are listed as follows:
\- AMF.
The RFSP index in use and authorized RFSP index (authorized RFSP index can
also be obtained from PCF).
Allowed NSSAI (to derive RFSP policy considering network slicing information):
\- UDM.
The subscribed RFSP index.
Slice related subscription information (this can also come from AMF):
\- PCF.
The authorized RFSP policy:
\- SMF.
Session related information which can help to derive RFSP policy regarding to
redirecting the active mode UE to other RATs:
\- OAM.
To acquire NG-RAN information related to RFSP policy information.
It is not mandatory to acquire NG-RAN related radio access information and
this solution should be workable without more NG-RAN information). However,
having such information can allow NWDAF to be aware how the RFSP index is
mapped to the idle mode cell reselection configurations which may help NWDAF
to perform more accurate analytics.
Figure 6.42.2-1: Functional diagram for NWDAF-assisted RFSP policy
configuration
With the above listed inputs, NWDAF can perform analytics and provide
analytics outcome. As analytics outcome, the NWDAF can generate statistics
related information related to the RFSP index in-use and the predicted
performance information regarding to the candidate RFSP index to be used. The
NF consumer will decide whether to change the RFSP index.
The analytics outcome can be provided to NF consumer which can be AMF or PCF.
### 6.42.3 Procedures
Figure 6.42.3-1 provides the procedure with PCF as the NR consumer for NWDAF.
Figure 6.42.3-1: NWDAF provides analytics outcome to PCF
Figure 6.42.3-2 provides the procedure with AMF as NF consumer for NWDAF.
Figure 6.42.3-2: NWDAF provides analytics outcome to AMF
### 6.42.4 Impacts on services, entities and interfaces
PCF, AMF, UDM, SMF and OAM need to provide RFSP index related info to NDWAF.
NWDAF provides analytics outcome to PCF or AMF regarding to RFSP policy
configuration.
## 6.43 Solution #43: RFSP index value using Analytics Id Service Experience
### 6.43.1 Description
This is a solution for Key issue #12: NWDAF-assisted RFSP policy.
The existing Analytics Id on Service Experience is consumed by the PCF to
request NWDAF to report the Observed Service Experience for a UE.
The PCF is configured with operator policies, as defined in TS 23.503 [4],
that enables the operator to modify the RFSP index value assigned by
subscription taking into consideration the time of the day, the location of
the UE (such as Area of Interest), the application in use, the Access and
Mobility Policy subscription data, the Observed Service Experience and the UE
capabilities.
At UE registration, the AMF establishes an AM Policy association with the PCF
serving the AMF. The PCF serving the AMF checks operator policies that
indicates:
\- if Access and Mobility Policy subscription data is retrieved from UDR.
\- if subscription to Analytics Id Observed Service Experience for the UE and
for an application is needed.
\- If subscription to Event Reporting from the PCF that serves the SMF that
has the PDU session for this UE.
### 6.43.2 Input Data
The existing input data to calculate the Observe Service experience defined in
TS 23.288 [5] is extended to retrieve OAM input data per RAT and Frequency.
### 6.43.3 Output Analytics
The existing output Analytics for Observed Service experience defined in TS
23.288 [5] is extended to provide Observed Service Experience per RAT type and
Frequency.
### 6.43.4 Procedures
Figure 6.43.4-1: Procedure to allocate the RFSP value for an Application
considering Analytics
1\. The AMF sends Npcf_AMPolicyControl_Create to the PCF to establish an AM
policy control association, the requests includes the information listed in TS
23.502 [3] clause 4.16.1, extended with the UE Radio Capabilities.
2\. The PCF checks operator policies to assign the RFSP index value, when a
user consumes Application Id, under the conditions to keep the Service
experience under the configured values for the application under the
conditions reported by the UE Radio Capabilities. For example, a User consumes
gaming services, that requires Service Experience set to 3 or larger, if the
user is gold, RFSP index value is assigned to a value that allows moving UE to
NR with high frequency under the conditions locally defined in RAN.
3\. The PCF retrieves the AM policy control data from the UDR; using
Nudr_DM_Query to retrieve the user category.
4\. The UDR returns the AM policy control data including the user category,
e.g. gold.
5\. The PCF sends an Analytics subscribe (Analytics ID = Service
Experience/Service Behaviour, Target of Analytics Reporting =/UE ID, Analytics
Filter information = (Application ID, S-NSSAI, DNN,), to NWDAF by invoking a
Nnwdaf_AnalyticsSubscription_Subscribe.
6\. The NWDAF provides the data analytics, i.e. the observed Service
Experience (which can be a range of values that can be different per RAT and
Frequency value combination) and service behaviour to the consumer NF by means
of Nnwdaf_AnalyticsSubscription_Notify.
7\. If the consumer NF is a PCF that serves both the AMF and the SMF(s) for a
UE, then the PCF subscribes to SMF to report when the application starts or
stops and step 12 takes place.
8\. If the consumer NF is a PCF that serves the AMF then the PCF maps the
Application ID into the DNN and S-NSSAI that provides access to the
Application and requests the BSF to notify the PCF serving the DNN, S-NSSAI
for the SUPI.
9\. The BSF provides the PCF(s) serving the DNN, S-NSSAI for the SUPI.
10\. The PCF subscribes to reporting service start/stop to the SMF.
11\. The PCF serving the SMF acknowledge the subscription.
12\. The PCF assigns a RFSP value to the AMF.
At the time the PCF serving the SMF reports that application is detected, the
PCF updates the RFSP value to the AMF.
### 6.43.5 Impacts on services, entities and interfaces
PCF: Take analytics on Service Experience Analytics Id and UE Radio
Capabilities into account.
When both PCF-AM and PCF-SM are different PCFs:
\- the PCF-AM subscribes to BSF to discover the PCF-SM serving a DNN, S-NSSAI
for a SUPI.
\- The PCF-AM subscribes to the PCF-SM to report start and stop of
application.
\- The PCF-SM exposes application start and stop and the subscription triggers
provisioning of PCC Rules to the SMF.
AMF: Report UE Radio Capabilities to the PCF at AM Policy Association
establishment.
NWDAF: Analytics Id on Service experience is extended to provide different
values per RAT and Frequency combination.
## 6.44 Solution #44: Analytics for **Session Management Congestion Control
Experience**
### 6.44.1 Description
This solution is for Key Issue #13 \"Triggering conditions for analytics\".
According to the Session Management related Congestion Control mechanisms,
i.e. DNN based congestion control defined in clause 5.19.7.3 of TS 23.501 [2]
and S-NSSAI based congestion control defined in clause 5.19.7.4 of TS 23.501
[2], the SMF that is applying or has applied the SM related Congestion Control
mechanism does not store any information/history about that towards which UEs
the SMF provided the backoff timer. Therefore, fairness to apply the SM
related Congestion Control is not considered and cannot be guaranteed. For
example, among UEs that use a PDU Session associated with S-NSSAI#1, some of
the UEs may experience the S-NSSAI based congestion control high (e.g.
receiving NAS SM reject messages with a long backoff timer) while some of the
UEs may experience the S-NSSAI based congestion control low (e.g. receiving
NAS SM reject messages with a short backoff timer), within a specific period.
The backoff timer provided to each UE can be vary because the backoff timer
can be up to 70 hours.
In order to address the problem described above, this solution proposes a new
Analytics ID called \"Session Management Congestion Control Experience
(SMCCE)\". NWDAF can provide Observed Session Management Congestion Control
Experience analytics for specific DNN and/or S-NSSAI, in the form of
statistics or predictions, to a service consumer.
The service consumer is SMF. The SMF uses potential congestion condition as
trigger to request for the SMCCE analytics to the NWDAF.
The Observed SMCCE analytics provide one or more than one of the following
outputs:
a) A list of UEs whose experience level of Session Management Congestion
Control for specific DNN and/or S-NSSAI is high;
b) A list of UEs whose experience level of Session Management Congestion
Control for specific DNN and/or S-NSSAI is medium;
c) A list of UEs whose experience level of Session Management Congestion
Control for specific DNN and/or S-NSSAI is low or zero.
The request by the service consumer includes mainly the following parameters:
\- Analytics ID = \"Session Management Congestion Control Experience\".
\- Target of Analytics Reporting: one or more SUPI(s).
\- Analytics Filter Information containing:
\- DNN and/or S-NSSAI.
\- Analytics Target Period: the time period over which the statistics or
prediction are requested, either in the past or in the future.
Additionally, the input parameters described in clause 6.1.3 of TS 23.288 [5]
can be appropriately used for the request.
NWDAF collects the data related to Session Management Congestion Control
Experience from SMF and/or from Data Storage (e.g. UDR, NWDAF acting as Data
Storage Function) in order to calculate and provides statistics and
predictions on the observed Session Management Congestion Control Experience
to a consumer NF.
NOTE: Solutions for Key Issues #1, #2 and #11 can be used for Data Storage
(e.g. UDR, NWDAF acting as Data Storage Function) if defined and applied, so
this solution does not intend to introduce the Data Storage only for this
solution.
### 6.44.2 Input Data
For the purpose of SMCCE analytics, the NWDAF collects the Data as listed in
Table 6.44.2-1.
Table 6.44.2-1: Data collected by NWDAF for SMCCE analytics
* * *
Information Description UE ID SUPI SMCC experience for PDU Session Data
related to SMCC experience per PDU Session > DNN DNN for the PDU Session that
SMF collects Data related to SMCCE > S-NSSAI S-NSSAI for the PDU Session that
SMF collects Data related to SMCCE > Start time of data collection Start time
of data collection > End time of data collection End time of data collection >
SM NAS request from UE (1..max) Information on SM NAS messages that SMF
receives from UE for PDU Session >> Type of SM NAS request A type of SM NAS
message transmitted by UE (e.g. PDU Session Establishment Request, PDU Session
Modification Request, etc) >> Timestamp A time stamp when SMF receives SM NAS
message from UE > SM NAS message from network with backoff timer (1..max)
Information on SMCC applied to UE for PDU Session >> Type of SM NAS message
from network A type of SM NAS message with backoff timer provided to UE (e.g.
PDU Session Establishment Reject, PDU Session Modification Reject, PDU Session
Release Command, etc) >> Timestamp A time stamp when SMF sends SM NAS message
to UE >> Provided backoff timer A value of backoff timer provided to UE >>
Type of applied SMCC A type of applied SMCC, i.e. DNN based congestion control
or S-NSSAI based congestion control
* * *
The SMF collects Data related to SMCC experience for all PDU Sessions it
serves as listed in Table 6.44.2-1 and can store the collected Data to Data
Storage if available, e.g. periodically, when the collected data reaches the
maximum number, etc.
### 6.44.3 Output Analytics
The NWDAF outputs the SMCCE analytics. Depending on the Analytics Target
Period, the output consists of statistics or predictions. The detailed
information provided by the NWDAF is defined in Table 6.44.3-1 for statistics
and Table 6.44.3-2 for predictions.
Table 6.44.3-1: SMCCE statistics
* * *
Information Description List of SMCCE Analytics (1..max)  
> DNN (NOTE) DNN that SMCC is applied > S-NSSAI (NOTE) S-NSSAI that SMCC is
> applied > List of UEs classified based on experience level of SMCC One or
> more than one of the following lists (SUPI is used to identify UE) >> List
> of high-experienced UEs A list of UEs whose experience level of SMCC for
> specific DNN and/or S-NSSAI is high >> List of medium-experienced UEs A list
> of UEs whose experience level of SMCC for specific DNN and/or S-NSSAI is
> medium >> List of low-experienced UEs A list of UEs whose experience level
> of SMCC for specific DNN and/or S-NSSAI is low or zero NOTE: For each list
> of SMCCE Analytics, DNN or S-NSSAI is included.
* * *
Table 6.44.3-2: SMCCE predictions
* * *
Information Description List of SMCCE Analytics (1..max)  
> DNN (NOTE) DNN that SMCC is applied > S-NSSAI (NOTE) S-NSSAI that SMCC is
> applied > List of UEs classified based on experience level of SMCC One or
> more than one of the following lists (SUPI is used to identify UE) >> List
> of high-experienced UEs A list of UEs whose experience level of SMCC for
> specific DNN and/or S-NSSAI is high >> List of medium-experienced UEs A list
> of UEs whose experience level of SMCC for specific DNN and/or S-NSSAI is
> medium >> List of low-experienced UEs A list of UEs whose experience level
> of SMCC for specific DNN and/or S-NSSAI is low or zero > Confidence
> Confidence of the prediction. NOTE: For each list of SMCCE Analytics, DNN or
> S-NSSAI is included.
* * *
### 6.44.4 Procedures
Figure 6.44.4-1 shows the procedure for Analytics for **Session Management
Congestion Control Experience**.
Figure 6.44.4-1: Analytics for Session Management Congestion Control
Experience
1\. The SMF requests to analytics information on \"Session Management
Congestion Control Experience\" provided by NWDAF if the SMF wants to take the
analytics information into account when applying the SMCC.
The parameters included in the request are described in clause 6.44.1.
NOTE: The SMF needs to request the analytics information to the NWDAF early
enough before applying Session Management Congestion Control due to potential
congestion, to take the analytics information into account for the SMCC.
The NWDAF performs step 2 and/or step 3. Steps 4 to 7 are following steps of
step 3.
2\. The NWDAF collects Data related to SM Congestion Control Experience from
Data Storage (e.g. UDR, NWDAF acting as Data Storage Function).
3\. The NWDAF sends subscription requests to all the serving SMFs to collect
Data related to SM Congestion Control Experience if it has not subscribed such
data. The SMF that made the request in step 1 can be also the data provider.
If the NWDAF obtains required Data for some UEs in step 2, the NWDAF does not
perform step 3 for those UEs.
4\. The SMF provides the collected Data to the NWDAF.
5\. With the data obtained in step 2 and/or step 6, and optionally with the
SMF load analytics derived in step 8, the NWDAF derives requested analytics.
6\. The NWDAF provides the analytics for Session Management Congestion Control
Experience to the SMF.
7\. The SMF starts SM Congestion Control, i.e. DNN based congestion control
and/or S-NSSAI based congestion control. When applying the SM Congestion
Control, the SMF considers fairness, for example, NAS SM reject messages with
a short backoff timer to the UEs in the list of high-experienced UEs while NAS
SM reject messages with a long backoff timer to the UEs in the list of low-
experienced UEs.
### 6.44.5 Impacts on services, entities and interfaces
NWDAF:
\- supports a new Analytics ID = \"Session Management Congestion Control
Experience\".
SMF:
\- collects Data related to SMCC experience for all PDU Sessions it serves.
\- provides the Data related to SMCC experience to the NWDAF.
\- stores the Data related to SMCC experience to Data Storage (e.g. UDR, NWDAF
acting as Data Storage Function) if available.
\- requests NWDAF outputs for a new Analytics ID = \"Session Management
Congestion Control Experience\".
## 6.45 Solution #45: Triggers for requesting analytics
### 6.45.1 Description
This solution addresses Key Issue #13 \"Triggering conditions for analytics\",
especially on the aspect of triggers which can be used by analytics consumers
to request for or subscribe to analytics from the NWDAF.
In general, an NF may request for or subscribe to the analytics information
from the NWDAF:
\- based on the triggers (e.g. event reports or requests) from the other
NF(s).
\- based on local event, e.g. the detected UE behaviour or network performance
or time conditions.
\- based on the analytics information received. That is, the NF may decide to
further request for or subscribe to the analytics information (e.g. with
different Analytics filters, Target of Analytics Reporting or Analytics IDs)
from the NWDAF, upon receiving the analytics information provided by the NWDAF
for existing subscription(s) or previous request(s).
Specifically, for different NFs, the possible triggers and example scenarios
can be as follows:
PCF:
Triggers for the PCF to request for or subscribe to the analytics information
from the NWDAF may be based on:
\- Policy Control Request from the AMF or SMF;
\- notifications received from UDR or CHF;
\- requests from AF/NEF;
\- analytics information received.
When a trigger condition happens, the PCF may check some local configuration
or evaluate operator policy conditions to decide if any subscription to NWDAF
has to be requested and if so, which one in case different ones might be
requested. E.g. upon SM Policy association establishment request from SMF, the
PCF may evaluate an operator policy depending on the category of the
subscriber and current time to subscribe to abnormal behaviour analytic.
Table 6.45.1-1: Triggers used by PCF to request for or subscribe to analytics
* * *
Triggers Examples Policy Control Request from the AMF or SMF the PCF may
request the analytics from the NWDAF in order to update policy and charging
control decision. Notifications from UDR or CHF Upon a change on the profile
of the subscriber in UDR or a change in a status counter for spending limit in
CHF the PCF may request the analytics from the NWDAF in order to update policy
and charging control decision Request from AF/NEF Upon a request from AF/NEF
for Negotiation for future background data transfer the PCF may request the
analytics from the NWDAF to assist in the determination of the background data
transfer policies analytics information received Upon receiving the analytics
on \"Load level information\" which indicates the load level of a network
slice reached the threshold for a high load level, the PCF may request for or
subscribe to the analytics information on \"Abnormal behaviour\" to detect
whether there are any exceptional UE behaviours in this network slice.
* * *
SMF:
The SMF may request for or subscribe to the analytics information from the
NWDAF:
\- based on UE access and mobility event reports from the AMF.
\- based on Policy Control Request Triggers or updated policy and charging
control decision from the PCF.
\- based on local events.
When a trigger condition happens, the SMF may check some local configuration
to decide if any subscription to NWDAF has to be requested and if so, which
one in case different ones might be requested.
Table 6.45.1-2: Triggers used by SMF to request for or subscribe to analytics
* * *
Triggers Examples UE access and mobility event reports from the AMF When the
\"number of UEs served by the AMF and located in Area Of Interest\" reported
by the AMF reaches a predefined threshold, the SMF may subscribe to the
analytics on \"UE communication\" or \"Network Performance\" with the
Analytics Filter including the Area of Interest, to observe the communication
performance of the UE(s) or the network in the specific area. Policy Control
Request Triggers or updated policy and charging control decision from the PCF
When the SMF receives the Policy Control Request Trigger of \"Usage report\"
from the PCF, the SMF may subscribe to the analytics information on \"Abnormal
behaviour\", to detect whether there are any exceptions on the PDU session or
the Monitoring key specific resources consumed by a UE as specified in TS
23.503 [4]. local events If the SMF detects the number of PDU session
establishment or release reaches a threshold in a specific area, the SMF may
request for or subscribe to the analytics information on \"Abnormal
behaviour\" to detect whether there are any exceptional UE behaviours in this
area.
* * *
AMF:
The AMF may request for or subscribe to the analytics information from the
NWDAF:
\- based on event reporting triggers from the SMF/NEF.
\- based on local events.
When a trigger condition happens, the AMF may check some local configuration
to decide if any subscription to NWDAF has to be requested and if so, which
one in case different ones might be requested.
Table 6.45.1-3: Triggers used by AMF to request for or subscribe to analytics
* * *
Triggers Examples event reporting triggers from the SMF/NEF When the AMF
receives the event reporting trigger from the SMF/NEF on \"UE loss of
communication\", the AMF may subscribe to the analytics information on
\"Abnormal behaviour\" to detect whether there are any mobility related
exceptions. local events When the AMF detects frequent mobility re-
registration of one or more UEs, the AMF may subscribe to the analytics on
\"Abnormal behaviour\" in order to trace the mobility trend of the UE(s) and
take appropriate actions.
* * *
### 6.45.2 Impacts on services, entities and interfaces
## 6.46 Solution #46: NWDAF assisted new application detection
### 6.46.1 Description
This solution is for Key Issue #14: NWDAF-assisted application detection.
To differentiate an application traffic handling, the first step is to
distinguish application traffic from other traffics. In 5G network, an
application can be distinguished by a set of packet headers (SDFs) or
application IDs. The most common approach to detect traffic is a set of packet
headers, which usually contains source and destination address. The
application ID can be used for referring the UPF\'s specific application
detection filter. For managing detection information associated with
application IDs, AF may provide PFDs according to clause 4.18 of TS 23.502 [3]
to update application detection filter information. A PFD contents could
contain flow description (service-side 3-tuple), URL, and domain name/protocol
information. When an AF deliver PFD to NEF (PFDF), it will be distributed to
SMFs and UPFs to enable flow detection according to clause 5.8.2 of TS 23.501
[2].
The objective of this solution is to automate application detection method
using PFDs for newly/updated applications by extracting network traffic
signature using the network data analytics. To realize this solution, one of
the main features is 1) collect measurement of an application to extract
statistical characteristics, 2) collect payload of packets to extract payload
signature (such as domain name contained in the payload). The baseline usage
of the generated analytics is to store the captured application
characteristics as a PFD, and the PFD is used by SMF and UPF to detect an
application defined as TS 23.502 [3].
In details, usually, although the IP 3-tuple for an application is changeable,
Traffic Signature/Feature for the application is unchangeable., the NWDAF
could collect the historical PFD information (including Application ID,
historical IP 3-tuple, historical URL, historical Domain name information)
from the NEF (PFDF) for applications.
Based on PFD information from NEF and traffic information from SMF (UPF), new
PFD information (including Application ID, new IP 3-tuple, new URL, new Domain
name information) for the existing Application ID could be derived by the
NWDAF and provisioned to the NEF as analytics output. The new PFD information
provided by the NWDAF should be also stored into the UDR. Then the new PFD
information could be used by the NEF to be used for PFD provisioning.
Note that two PFD information overlapping scenarios may exist as follows:
> \- A new PFD information provided by the NWDAF has been already provisioned
> by the ASP during the new PFD information generation procedure in NWDAF;
>
> \- A new PFD information provisioned by the ASP has been already provided by
> the NWDAF after it was derived in the NWDAF.
So the NEF may check if the new PFD information provided by the NWDAF or
provisioned by the ASP has been stored in the UDR, if not, the NEF should
store the new PFD information into the UDR.
The below is the principles of the solution:
\- A consumer (e.g. NEF) request to NWDAF to detect new applications, not
matched with SDF or application IDs already available at the UPF. The
triggering to contact NWDAF is not defined, so that it can be configured by
local configuration using OAM.
\- NWDAF collect SMF\'s data for user plane usage report and/or URL, Domain
name part, and IP 3-tuples of packets from unknown application that doesn\'t
have any installed SDF or application detection filter in the SMF/UPF.
\- NWDAF analyse the collected data to generate unique traffic patterns, and
provides it to the consumer (e.g. NEF).
\- The consumer stores PFD associated with an application ID to enable the
detection of application traffic in the future (out of scope).
### 6.46.2 Input Data
NWDAF collects QoS flow related data from SMF for a specific S-NSSAI, DNN, and
UE. This solution collects data for matched on default QoS flow, which no SDF
or Application IDs are known. The detailed data are described in Table
6.46.2-1.
Table 6.46.2-1: input data to detect new application from NFs
* * *
Information Source Description SUPI  
S-NSSAI SMF Identifies the Network Slice for which analytics information is
provided. DNN SMF Identifies the data network name (e.g. internet) for which
analytics information is provided Start/end time UPF Start and end time of
traffic detection Data volume UPF Measured data traffic volume (per UL/DL)
Data duration UPF Measured average data traffic (packets) duration (per UL/DL)
QoS flow Bit Rate UPF The observed bit rate (per UL/DL) Packet transmission
UPF The observed average number of packet transmission (per UL/DL) IP 3-tuple
UPF to Identify a service flow of the UE for an application Packet\'s URL UPF
URL is extracted from the inspected user plane packets. Packet\'s Domain Name
SMFUPF The domain name is extracted from the inspected user plane packets in a
QoS flow Size of packets SMFUPF Average size of packets PFD Information (NOTE
1) NEF (PFDF) PFD Information stored in the NEF (PFDF) as defined in clause
6.1.2.3.2, TS 23.503 [4] > Application ID NEF (PFDF) Identification of the
application that refers to one or more application defection filters. > IP
3-tuple NEF (PFDF) Including protocol, server side IP address and port number
> URL NEF (PFDF) the significant parts of the URL to be matched, e.g. host
name > Domain Name NEF (PFDF) a Domain name matching criteria and information
about applicable protocol(s)
* * *
NOTE 1: How NWDAF collects information from UPF is not defined in this Release
of the specification.
NOTE 2: How many packets are needed to be collected is up to vendor
implementation.
NOTE 3: The PFD Information could be used to train an Application Classifier
for all the Applications or extract one or multiple Traffic Signature/Feature
per Application ID. Then the Application Classifier or the Traffic
Signature/Feature could be used to derive new PFD information for the existing
Application ID in the PFD information. However, these implementation details
are out of 3GPP scope.
### 6.46.3 Output Analytics
The output analytics of NWDAF is defined in Table 6.46.3-1.
The output analysis can be used to provision new PFDs for existing
applications, or define new PFDs for new applications, not known to NEF yet.
With the knowledge on an application\'s URL, domain name, and IP-address, the
NEF can assign an PFD ID for the unknown application, and the assigned PFD ID
can be used to identify/audit/report the unknown application.
Table 6.46.3-1: Output for new application detection
* * *
Information Description Application ID Application ID of the application that
refers to the application detection filter (Flow descriptor, URL or Domain
name information) S-NSSAI Identifies the Network Slice for which analytics
information is provided. DNN Identifies the data network name (e.g. internet)
for which analytics information is provided Flow descriptor Flow descriptor
containing 3-tuple, server side (destination address, port, and protocol) URL
the significant parts of the URL to be matched, e.g. host name defined in
Domain name information a Domain name matching criteria and information about
applicable protocol(s).
* * *
### 6.46.4 Procedures
For the procedure to extract the unique characteristic of application traffic
such as traffic pattern, URL, and/or domain name related information. The
procedure depicted in 6.46.4-1 shows new application detection analytics and
store as PFDs by NEF.
Figure 6.46.4-1: A procedure to extract application characteristics
1\. NEF request to NWDAF to request application detection information. This
request maybe be triggered by local configuration or OAM.
2\. A target UE establishes PDU session for communication.
3\. NWDAF request to subscribe session related information and request the UPF
to report URL, Domain name part, and IP 3-tuples of packets from unknown
application.
4\. A NWDAF extracts the application traffic characteristics.
5\. NWDAF notifies the analytic to the NEF with outputs defined in Table
6.46.3-1.
### 6.46.5 Impacts on services, entities and interfaces
NWDAF:
\- Needs to provide a new analytic for application detection information.
\- Needs to process user plane data for extracting traffic characteristics.
UPF:
\- Needs to report URL, Domain name part, and IP 3-tuples of packets from
unknown application to NWDAF.
\- Needs to provide requested sessions statistics including data volume, data
duration, QoS flow bit rate and packet transmission.
NEF (PFDF):
\- Supports to consume new PFD information from NWDAF.
\- Supports to check if new PFD information has been locally stored or stored
in the UDR, if not, the NEF should store new PFD information into the UDR.
## 6.47 Solution #47: UE Presence Pattern analytics to support edge computing
### 6.47.1 Description
#### 6.47.1.1 Overview
The solution addresses Key Issue #16: UP optimization for edge computing. It
supports the efficient UP resource usage in the edge computing, especially, in
case of LADN, with UE Presence Pattern analytics.
As described in clause 5.6.5 of TS 23.501 [2], the SMF takes actions (e.g.
release the PDU Session immediately or deactivate the user plane connection
for the PDU Session with maintaining the PDU Session) based on operator\'s
policy, with the notification about the UE Presence in LADN service area
notified by AMF (i.e. IN, OUT, or UNKNOWN). This solution provides UE Presence
Pattern analytics from NWDAF to SMF, and it may have an effect on operator\'s
policy configured in SMF to support edge computing, especially LADN service.
For this, this solution proposes two alternatives:
\- Alternative#1: using a new Analytics ID called \"UE Presence Pattern\".
\- Alternative#2: an extension of the existing analytics, \"UE Mobility\"
defined in clause 6.7.2 of TS 23.288 [5].
#### 6.47.1.2 Alternative #1: a new \"UE Presence Pattern\" analytics
NWDAF supporting UE Presence Pattern analytics shall be able to:
\- collect UE mobility/presence related information in LADN service area from
NFs (e.g. AMF, AF) and OAM;
\- collect LADN service area information from NF (e.g. AMF) and OAM;
\- perform data analytics to provide UE Presence Pattern statistics or
predictions.
The service consumer may be a NF (i.e. SMF).
The consumer of these analytics may indicate in the request:
\- Analytics ID = \"UE Presence Pattern\".
\- The Target of Analytics Reporting can be a single UE, any UE, or a group of
UEs.
\- Analytics Filter Information optionally containing:
\- Area of Interest;
\- S-NSSAI;
\- DNN.
\- An Analytics target period indicates the time period over which the
statistics or predictions are requested.
#### 6.47.1.3 Alternative #2: an extension of the existing UE Mobility
analytics
The service consumer may be a NF (i.e. SMF).
Regarding the parameters included in the request by the service consumer, the
parameters described in clause 6.7.2 of TS 23.288 [5] are used with the
following differences:
\- To indicate Area of Interest, LADN DNN can be used as the Analytics Filter
Information.
### 6.47.2 Input Data
#### 6.47.2.1 Alternative #1: a new \"UE Presence Pattern\" analytics
The NWDAF supporting data analytics on UE Presence Pattern shall be able to
collect UE mobility information from OAM, 5GC and AFs, and service data from
AF, as described in clause 6.7.2.2 of TS 23.288 [5]. Additionally, this
solution collects the following inputs.
Table 6.47.2.1-1: UE Presence information in LADN service area
* * *
Information Source Description UE ID AMF SUPI UE Presence AMF, SMF UE presence
in LADN service area >DNN Data Network Name associated for LADN service >UE
Presence [IN, OUT, UNKNOWN] UE Presence in LADN service area >Timestamp A time
stamp when the AMF or SMF detects the UE is determined as this presence.
* * *
#### 6.47.2.2 Alternative #2: an extension of the existing UE Mobility
analytics
The input data described in clause 6.7.2.2 of TS 23.288 [5] can be used.
### 6.47.3 Output Analytics
#### 6.47.3.1 Alternative #1: a new \"UE Presence Pattern\" analytics
The NWDAF supporting data analytics on UE Presence Pattern shall be able to
provide UE Presence Pattern analytics on returning back LADN service area, to
consumer NF (i.e. SMF).
Table 6.47.3.1-1: UE Presence Pattern statistics in LADN service area
* * *
Information Description UE group ID or UE ID, any UE Identifies a UE, any UE,
or a group of UEs DNN Data Network Name associated for LADN service Time slot
entry (1..max) List of time slots during the Analytics target period > Time
slot start Time slot start within the Analytics target period > Duration
Duration of the time slot (average and variance) > UE Presence Pattern
(1..max) Observed location statistics >> Ratio Percentage on which UE, any UE,
or UE group comes in a LADN service area again.
* * *
Table 6.47.3.1-2: UE Presence Pattern predictions in LADN service area
* * *
Information Description UE group ID or UE ID, any UE Identifies an UE or, any
UE, a group of UEs DNN Data Network Name associated for LADN service Time slot
entry (1..max) List of predicted time slots >Time slot start Time slot start
time within the Analytics target period > Duration Duration of the time slot >
UE Presence Pattern (1..max) Predicted UE Presence during the Analytics target
period >> Ratio Percentage on which the UE, any UE, or UE group may come in a
LADN service area again. >> Confidence Confidence of this prediction
* * *
#### 6.47.3.2 Alternative #2: an extension of the existing UE Mobility
analytics
The output data described in clause 6.7.2.3 of TS 23.288 [5] can be used.
### 6.47.4 Procedures
#### 6.47.4.1 Alternative #1: UE Presence Pattern Analytics Procedure
Figure 6.47.4.1-1 shows the analytics procedure on UE Presence Pattern in LADN
service area. The NWDAF can provide UE Presence Pattern related analytics in
LADN service area, in the form of statistics or predictions or both, to
another NF.
Figure 6.47.4.1-1: \"UE Presence Pattern in LADN service area\" analytics
provided to an NF
1\. The NF sends a request to the NWDAF for analytics on a specific UE, any
UE, or a group of UEs, using either the Nnwdaf_AnalyticsInfo or
Nnwdaf_AnalyticsSubscription service. The NF can request statistics or
predictions or both. The type of analytics is set to UE Presence Pattern
information. The NF provides the UE id or Internal Group ID in the Target of
Analytics Reporting. Analytics Filter Information optionally contains LADN
DNN, S-NSSAI, Area of Interest, etc.
2\. If the request is authorized, and in order to provide the requested
analytics, the NWDAF may subscribe to events with all the serving AMFs for
notification of location changes, and may subscribe to events with SMFs
serving LADN PDU Session for notification of UE Presence Pattern in LADN
service area.
The NWDAF subscribes the service data from AF(s) by invoking
Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via
NEF).
The NWDAF collects UE mobility information and/or LADN related information
from OAM, following the procedure captured in clause 6.2.3.2 of TS 23.288 [5].
NOTE: The NWDAF determines the AMF serving the UE, any UE, or the group of UEs
as described in clause 6.2.2.1 of TS 23.288 [5].
This step may be skipped when e.g. the NWDAF already has the requested
analytics available.
3\. The NWDAF derives requested analytics.
4\. The NWDAF provide requested UE Presence Pattern analytics to the NF, using
either the Nnwdaf_AnalyticsInfo_Request response or
Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.
5-7. If at step 1, the NF has subscribed to receive notifications for UE
Presence Pattern analytics, after receiving event notification from the AMFs,
AFs and OAM subscribed by NWDAF in step 2, the NWDAF may generate new
analytics and provide them to the NF.
If a service consumer is SMF, the UE Presence Pattern analytics can be used to
make decision how to handle LADN PDN Session, when informed that the UE
Presence Pattern in a LADN service area is OUT, i.e. release the PDU Session
immediately, or deactivate the user plane connection for the PDU Session with
maintaining the PDU Session.
#### 6.47.4.2 Alternative #2: an extension of the existing UE Mobility
analytics
The procedures described in clause 6.7.2.4 of TS 23.288 [5] can be used with
SMF as a consumer NF.
Additionally, Analytics Filter Information contains LADN DNN to indicate Area
of Interest.
### 6.47.5 Impacts on services, entities and interfaces
#### 6.47.5.1 Alternative #1: a new \"UE Presence Pattern\" analytics
SMF:
\- get information from NWDAF to make decision how to handle LADN PDN Session,
when informed that the UE Presence Pattern in a LADN service area is OUT,
i.e.:
(1) Release the PDU Session immediately; or
(2) Deactivate the user plane connection for the PDU Session with maintaining
the PDU Session.
NWDAF:
\- perform UE Presence Pattern statics and predictions.
#### 6.47.5.2 Alternative #2: an extension of the existing UE Mobility
analytics
SMF:
\- get information from NWDAF to make decision how to handle LADN PDN Session,
e.g. when the UE mobility statistics or predictions indicate UE Presence in
LADN service area the SMF can:
(1) Release the PDU Session immediately; or
(2) Deactivate the user plane connection for the PDU Session with maintaining
the PDU Session.
Existing UE Mobility analytics
\- extending usage of Area of Interest.as Analytics Filter Information (i.e.
using LADN DNN as Area of Interest)
## 6.48 Solution #48 (merging Sol# 49(alternative 1), 50): NWDAF assisted UP
optimization for EC by defining a new DN performance analytics
### 6.48.1 Description
The solution addresses Key Issue #16: UP optimization for edge computing.
In order to promise user experience, when a UE is visiting EC server, the 5GS
needs to select an appropriate anchor UPF to serve the UE. The appropriate
anchor UPF here means that, the UP path via this anchor UPF can satisfy the
QoS requirement well, and the number of anchor UPF relocation can be
minimized.
In this solution, it is proposed to rely on NWDAF analytics to select anchor
UPF and DNAI to promise user experience. Besides UE mobility analytics defined
in Rel-16, a new analytics named \"DN performance analytics\" is introduced,
which contains the performance information for an EC application per specific
area per time period.
The UE mobility analytics and \"DN performance analytics\" will be notified to
the SMF and EC server. Based on such NWDAF analytics, the SMF can select the
anchor UPF which can provide best user experience to the UE along the UE
moving trajectory and determine the most appropriate target DNAI; the EC
server can determine the target DNAI and/or target EC server if EC server
relocation is required.
### 6.48.2 Input
The input data for generating the \" DN performance analytics\" could be
collected from 5GC and EC server. The input data collected from 5GC is defined
in the Table 6.4.2-2 in TS 23.288 [5] with some additions, which are shown in
the table 6.48.2-1; The input data collected from EC server is defined in the
Table 6.4.2-1 in TS 23.288 [5] with some additions, which are shown in the
table 6.48.2-2.
Table 6.48.2-1 Additions to the Table 6.4.2-2 in TS 23.288 [5]
* * *
Information Source Description DNAI SMF Identifies the access to DN to which
the PDN session connects Anchor UPF ID SMF The anchor UPF of the PDU session
containing the QoS flow
* * *
Table 6.48.2-2: Additions to the Table 6.4.2-1 in TS 23.288 [5]
* * *
Information Source Description UE identifier AF IP address of the UE at the
time the measurements was made UE location AF The location of the UE when the
performance measurement was made Application Server Instance AF The IP
address/FQDN of the Application Server that the UE had a communication session
when the measurement was made Performance Data AF The performance associated
with the communication session of the UE with an Application Server that
includes: Average Packet Delay, Average Loss Rate and Throughput.
* * *
### 6.48.3 Output Analytics
The DN performance analytics is shown in the Table 6.48.3-1 and the Table
6.48.3-2.
Table 6.48.3-1 DN service performance statistic
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | Application ID | Identifies the application for | | | which analytics information is | | | provided. | +----------------------------------+----------------------------------+ | S-NSSAI | Identifies the Network Slice for | | | which analytics information is | | | provided. See NOTE1. | +----------------------------------+----------------------------------+ | DNN | Identifies the data network name | | | (e.g. internet) for which | | | analytics information is | | | provided. See NOTE 1. | +----------------------------------+----------------------------------+ | DN performance (0-x) | List of DN performance for the | | | EC application | +----------------------------------+----------------------------------+ | > Application Server Instance | Identifies the Application | | Address | Server Instance (IP address/FQDN | | | of the Application Server). | +----------------------------------+----------------------------------+ | >APP location | Application location, could be | | | identified by DNAI | +----------------------------------+----------------------------------+ | >Serving anchor UPF | The involved anchor UPF. See | | | NOTE 2. | +----------------------------------+----------------------------------+ | >Performance | Performance indicators | +----------------------------------+----------------------------------+ | >> Average Traffic rate | Average traffic rate observed | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >> Maximum Traffic rate | Maximum traffic rate observed | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >>Average Packet Delay | Average packet delay observed | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >>Maximum Packet Delay | Maximum packet delay for | | | observed for UEs communicating | | | with the EC application | +----------------------------------+----------------------------------+ | >> Average Packet Loss Rate | Average packet loss observed for | | | UEs communicating with the EC | | | application | +----------------------------------+----------------------------------+ | >Spatial Validity Condition | Indicates the specific area | | | where the service experience | | | could be promised | +----------------------------------+----------------------------------+ | >Temporal Validity Condition | Indicates the specific time | | | period in which the service | | | experience can be promised | +----------------------------------+----------------------------------+ | NOTE 1: The item \"DNN\" and | | | \"S-NSSAI\" shall not be | | | included if the consumer NF is | | | an untrusted AF. | | | | | | NOTE 2: The item \"Serving | | | anchor UPF\" shall not be | | | included if the consumer NF is | | | an AF. | | +----------------------------------+----------------------------------+
Table 6.48.3-2 DN service performance prediction
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | Application ID | Identifies the application for | | | which analytics information is | | | provided. | +----------------------------------+----------------------------------+ | S-NSSAI | Identifies the Network Slice for | | | which analytics information is | | | provided. See NOTE 1. | +----------------------------------+----------------------------------+ | DNN | Identifies the data network name | | | (e.g. internet) for which | | | analytics information is | | | provided. See NOTE 1. | +----------------------------------+----------------------------------+ | DN performance (0-x) | List of DN performance for the | | | EC application | +----------------------------------+----------------------------------+ | > Application Server Instance | Identifies the Application | | Address | Server Instance (IP address/FQDN | | | of the Application Server). | +----------------------------------+----------------------------------+ | >APP location | Application location, could be | | | identified by DNAI | +----------------------------------+----------------------------------+ | >Serving anchor UPF | The involved anchor UPF. See | | | NOTE 2. | +----------------------------------+----------------------------------+ | >Performance | Performance indicators | +----------------------------------+----------------------------------+ | >> Average Traffic rate | Average traffic rate predicted | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >> Maximum Traffic rate | Maximum traffic rate predicted | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >>Average Packet Delay | Average packet delay predicted | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >>Maximum Packet Delay | Maximum packet delay for | | | predicted for UEs communicating | | | with the EC application | +----------------------------------+----------------------------------+ | >> Average Packet Loss Rate | Average packet loss predicted | | | for UEs communicating with the | | | EC application | +----------------------------------+----------------------------------+ | >Spatial Validity Condition | Indicates the specific area | | | where the service experience | | | could be promised | +----------------------------------+----------------------------------+ | >Temporal Validity Condition | Indicates the specific time | | | period in which the service | | | experience can be promised | +----------------------------------+----------------------------------+ | >Confidence | Confidence of this prediction | +----------------------------------+----------------------------------+ | NOTE 1: The item \"DNN\" and | | | \"S-NSSAI\" shall not be | | | included if the consumer NF is | | | an untrusted AF. | | | | | | NOTE 2: The item \"Serving | | | anchor UPF\" shall not be | | | included if the consumer NF is | | | an AF. | | +----------------------------------+----------------------------------+
### 6.48.4 Procedures
Figure 6.48.4-1: Procedure for NWDAF providing data analytics for an EC
Application
1\. Consumer NF (e.g. SMF, AF) sends an Analytics request/subscribe (Analytics
ID = UE mobility, DN performance) to NWDAF by invoking a
Nnwdaf_AnalyticsInfo_Request or a Nnwdaf_AnalyticsSubscription_Subscribe.
2-4. The NWDAF performs data collection if it hasn\'t subscribed the input
data for the requested analytics. The NWDAF has to collect data from AMF, SMF
and AF.
5\. The NWDAF provides the analytics result to the consumer NF, including UE
mobility analytics and DN performance analytics.
Case 1: Consumer NF is the SMF
6-7. During the PDU session establishment or anchor UPF change (as specified
in clause 4.3.5 of TS 23.502 [3]) procedure, the SMF, as an analytics
consumer, can use UE mobility analytics to predict UE location, and then check
DN performance analytics, by taking UE location into account, to find which
UPF and DNAI for an application can serve the UE with the best user experience
or service performance.
8\. If the consumer NF is the LDNSR as described in TR 23.748 [28], the DN
performance analytics are used to determine which Application Server Instance
provides the best performance based on the current UE location or based on UE
mobility analytics. An example on how LDNSR can leverage performance analytics
is described in Solution 49 clause 6.49.2.4.2.
Editor\'s note: Whether LDNSR is a consumer depends on the solution
alternatives selected in the EC Study
Case 3: Consumer NF is the AF
9.-10. If the consumer NF is the AF, the analytics consumer can also use UE
mobility analytics and DN performance analytics to determine which DNAI is
more suitable if EC server relocation is required.
### 6.48.5 Impacts on services, entities and interfaces
NWDAF:
\- Need to provide a new analytics for DN performance for a specific
application.
\- Need to collect data from multiple UPFs (DNAIs).
\- Collecting performance data of Application Server Instances from each EDN.
NEF:
\- Need to expose DN performance analytics to AF.
## 6.49 Solution #49: Selecting an Edge Application Server instance/DNAI path
based on NWDAF analytics
### 6.49.1 Description
The solution addresses Key Issue #16: UP optimization for edge computing.
As part of the Edge Computing work in SA WG2 described in TR 23.748 [28], the
scope is to facilitate the 3GPP network to assist a UE in discovering an
Application Server instance in an Edge Network. In such cases when an
application client in the UE (client app) initiates an Application Server
(server app) discovery the 3GPP network selects an Application Server instance
(server app instance) in an Edge Network that is close to the location of the
UE to ensure a low latency connection. However, this may not be always the
case as at the time that the Application Server instance is selected the
instance may have limited computing/network resources available due to serving
a high number of UEs. Application Server instances that are not situated close
to the UE may have more computing resources available at the time an
application in the UE requests to discover an Application Server instance and
thus offer better performance. This is illustrated in Figure 6.49.1-1, where
the 3GPP network selects the server app instance of the EDN network in
Location 1 because this is the closest to the UE, however, this server may
provide an average latency (50ms) that is larger to average latency of an
Application Server instance located at the EDN of Location 2 (10ms), which is
not the closest to the UE\'s present location.
Figure 6.49.1-1: Selecting an Application Server instance in an EDN network
The solution leverages the NWDAF to provide performance analytics indicating a
best Application Server instance at the location where an application in the
UE requests to discover an Application Server. The NWDAF collects performance
data of Application Servers in each Edge Data Network and utilize this data to
know the communication performance experienced by many UEs, in different
locations, time of day etc. When the 3GPP network is required to select an
Application Server instance, analytics from the NWDAF are used to determine
the Application Server instance that provides the best performance at the time
the UE requests to discover an instance at the UE\'s present location. This is
illustrated in Figure 6.49.1-2.
Figure 6.49.1-2: 3GPP network selecting the best application server instance
at the UE location based on analytics from the NWDAF
In addition, the Application Server Performance Analytics provided by the
NWDAF can be used by the SMF to determine the DNAI path that offers the best
performance at the UE location.
Two alternatives are provided. In Alternative 1 the NWDAF collect from the AF,
QoS performance data such as Average Packet Delay, Average Loss Rate and
Throughput that the NWDAF uses to derive analytics for Application Server
performance. In alternative 2, the Observed Service Experience analytics are
leveraged where the NWDAF collect from the AF measured MOS performance data
from each Application Server instance.
### 6.49.2 Alternative 1 - Performance Data Collection from AF
#### 6.49.2.1 Description of solution
The NWDAF collects from an AF the performance of an Application Server
instance associated with a communication session of a UE. The performance data
includes the Average Packet Delay, Average Loss Rate and Throughput
performance.
The NWDAF uses the performance data to derive analytics of Application Server
performance at the UE location. A consumer NF uses such analytics to select
the best Application Server instance for a UE.
#### 6.49.2.2 Input Data
The performance data collected by an Edge Data Network are shown in the table
below. The NWDAF interfaces with an AF in an EDN to collect performance data.
A function in the EDN network measures the performance every time a UE
establishes a communication session with an Application Server Instance in an
EDN. For simplicity it assumed that this function additionally supports AF
functionality.
NOTE: It is assumed that the EDN network implements functionality to measure
the performance data of one or more applications deployed in an EDN.
Table 6.49.2.2-1: Application Server Performance Data from EDN network
* * *
Information Source Description Application ID AF The application identity
associated with the communication session of the UE when the measurement was
made UE identifier AF IP address of the UE at the time the measurements was
made UE location AF The location of the UE when the performance measurement
was made Application Server Instance AF The IP address or FQDN of the
Application Server that the UE had a communication session when the
measurement was made Location of Application AF/NEF Locations of application
represented by a list of DNAI(s) as described Service Data provided by AF in
TS 23.288 [5]. Performance Data AF The performance associated with the
communication session of the UE with an Application Server that includes:
Average Packet Delay, Average Loss Rate and Throughput. Timestamp AF A time
stamp associated to the communication session of the UE.
* * *
#### 6.49.2.3 Output Analytics
The NWDAF provides analytics (statistics and/or predictions) for Application
Server Performance shown in tables 6.49.2.3-1 and 6.49.2.3-2.
Table 6.49.2.3-1: Application Server Performance Statistics
* * *
Information Description Application ID Identifies the Application that a UE
had a communication session with an Application Server network Slice for which
analytics information is provided. Application Server Performance (1...n) List
of Application Servers with measured performance data. > Application Server
Instance Address Identifies the Application Server Instance (IP address of the
Application Server) or FQDN of Application Server. > Location of Application
Identifies the DNAI path of the UE when communicating with the Application
Server. > Performance of Application Server Performance of the Application
Server over the Analytics target period.
* * *
Table 6.49.2.3-2: Application Server Performance Predictions
* * *
Information Description Application ID Identifies the Application that a UE
had a communication session with an Application Server network Slice for which
analytics information is provided. Application Server Performance (1...n) List
of Application Servers with predicted performance data. > Application Server
Instance Address Identifies the Application Server Instance (IP address of the
Application Server) or FQDN of Application Server. > Location of Application
Identifies the DNAI path of the UE when communicating with the Application
Server. > Performance of Application Server Predicted performance of the
Application Server over the Analytics target period. > Probability Assertion
Confidence of this prediction.
* * *
#### 6.49.2.4 Procedures
##### 6.49.2.4.1 Collecting performance data from EDN networks
The figure below shows the details on how the NWDAF collects performance data
from each EDN network measuring the performance of UE communication sessions
with each EDN.
Figure 6.49.2.4.1-1: NWDAF collecting performance data from each EDN network
0\. The NRF contains domain names served by each NEF. The AF configures via
the NEF a list of applications supporting the reporting of performance data of
Application Server Instances.
NOTE: Step 0b may be carried out based on configuration at NEF or based on a
new API procedure defined between the AF and the NEF.
1\. The NWDAF is configured to collect performance data for an application.
The NWDAF may be configured to collect performance data for an application
when e.g. there is a Service Level Agreement between the network operator and
application service provider or when the NWDAF is required to provide
performance analytics for this application.
2\. The NWDAF identifies the AF(s) that reports performance data for this
application. Alternatively, the NWDAF may discover the NEF that interfaces
with the AF(s) that reports performance data for this application. The NWDAF
may retrieve this information from the NRF or may be requested as part of an
Analytic request from a NF consumer.
3\. The NWDAF may interface with the NRF to obtain a list of NEFs that
interface with one or more AFs reporting performance data for this
application.
4\. The NWDAF subscribes with every AF that can provide performance data for
the considered application. The subscription request contains an Event ID
identifying the type of information to report (i.e. performance data), an
identifier of the application, and additional parameters already specified in
TS 23.288 [5], such as a target of event reporting (i.e. any UE) and Event
Filter information (for example report performance data at a particular time
of day).
5\. If the request goes via the NEF the NEF forwards the request to the
appropriate AF in each EDN that the NEF can interface to (NEF registers domain
names supported at the NRF).
6\. The NEF forwards the request to the AF(s).
7\. The performance measuring function in the EDN measures performance data
every time an application client (client app) in the UE establishes a
communication session (such as a TCP connection) with the Application Server
Instance (server app instance) supporting the considered application.
8\. The performance measuring function in the EDN may get the UE location by
sending a Location Report request to a Location Manager Server (see TS 23.434
[17], clause 9.2.2). The Location Manager Server than asks the Location
Management Client in the UE to provide its location.
9\. After the communication session is completed the AF may report the
performance data for this communication session to the NWDAF. Alternatively,
in order to minimize the signalling between the AF and the NWDAF, the AF may
send a single report to the NWDAF containing performance data for multiple
communication sessions.
In addition to the performance data the AF report the UE IP address, the
address/ID of the edge application server instance hosting the application, a
timestamp denoting when the performance was measured and an identifier for the
application. The report may be sent to the NWDAF via the NEF.
##### 6.49.2.4.2 NWDAF providing analytics indicating a best application
server instance
The following figure describes how analytics provided by the NWDAF assist the
3GPP network to select an optimal Application Server instance when an
Application Client in the UE requests to discover an Application Server
Instance.
Figure 6.49.2.4.2-1: NWDAF deriving analytics for Application Server Instance
performance
0\. The NWDAF collects performance data of communication sessions with
Application Server Instances each one associated with an Application from
multiple EDN network as described in Figure 6.49.2.4.1-1.
1\. A Consumer NF decides to request from the NWDAF analytics of performance
of server app instances hosted at an EDN at the UE location. The NF may query
the NRF to determine the NWDAF providing analytics at the UE location.
2\. A request for Analytics is sent to the NWDAF. The request includes an
Analytic ID identifying the type of analytics required (i.e. server app
performance), the location of the UE where the performance data are requested
and optional filters such as time of day.
3\. The NWDAF derives performance analytics for the considered application
taking into account the present UE location, DNAI path and the requested time
of the day.
4\. The NWDAF reports analytics containing a list of one or more Application
Server Instances and associated statistical performance data.
5\. The Consumer NF uses the analytics to determine the best Application
Server or DNAI path at the UE location.
If the Consumer NF is the LDNSR as proposed in TR 23.748 [28], the LDNSR can
use the Application Server performance analytics as follows:
Editor\'s note: Whether LDNSR is a consumer depends on the solution
alternatives selected in the EC Study.
Figure 6.49.2.4.2-2: Procedure when the consumer NF is the LDNSR
1\. An application in the UE decides to discover the address of an Application
Server.
2\. The Application sends a DNS request over user plane signalling.
3\. The request is received by an LDNSR using procedures defined in TR 23.748
[28]. The LDNSR determines the UE location based on procedures defined in TR
23.748 [28]. The LDNSR decides to request Application Server performance
analytics. The LDNSR sends a request to the NWDAF to receive analytics of
application server performance at the UE location. The NF may query the NRF to
determine the NWDAF providing analytics at the UE location.
4\. A request for Analytics is sent to the NWDAF. The request includes an
Analytic ID identifying the type of analytics required (i.e. server app
performance), the location of the UE where the performance data are requested
and optional filters such as time of day.
5\. The NWDAF derives performance analytics for the considered application
taking into account the present UE location and the requested time of the day.
6\. The NWDAF reports analytics containing a list of one or more Application
Servers and associated statistical performance data.
7\. The LDNSR determines the L-DNS to route the UE request taking into account
performance analytics provided by the NWDAF at the UE location. If the LDNSR
supports L-DNS functionality the LDNSR may select the Application Server
instance (IP address) that offers the best performance. In such case step 8
below is bypassed.
8\. The LDNSR routes the UE request to the selected L-DNS.
9\. The L-DNS provides to the UE a DNS response.
If the Consumer NF is the SMF the SMF can use the Application Server
Performance Analytics to determine the best DNAI path at the current UE
location.
### 6.49.3 Alternative 2 - Leveraging observed service experience analytics
#### 6.49.3.1 Description of solution
The NWDAF is triggered to derive observed service experience analytics from a
consumer NF. The Observed Service experience is targeted to a specific DNAI
and Application. The NWDAF collects measured MOS experience data from each
edge application server instance (AF instance) as currently described in TS
23.288 [5] and TS 29.517 [29] to derive analytics. The AF additionally
includes in the measured MOS performance data the address of the Application
Server Instance that the UE had a communication session when the MOS
measurement was made.
#### 6.49.3.2 Input Data
The NWDAF interfaces with an AF in an EDN to collect MOS measurement data. The
AF reports the measurement data as currently described in Table 6.4.2-1 of TS
23.288 [5] additionally including an identifier of the Application Server
Instance that the UE had a communication session when the measurement was
made.
Table 6.49.3.2-1: Application Server Performance Data from EDN network
* * *
Information Source Description Application ID AF To identify the service and
support analytics per type of service (the desired level of service) IP filter
information AF Identify a service flow of the UE for the application Location
of Application AF Location of Application represented by a list of DNAI(s)
Application Server Instance ID AF The IP address of the Application Server
that the UE had a communication session when the measurement was made Service
Experience AF Measured MOS performance data Timestamp AF A time stamp
associated to the Service Experience provided by the AF
* * *
#### 6.49.3.3 Output Analytics
The Application Service Experience output analytics contained within the
Observed Service Experience statistics and predictions defined in TS 23.288
[5] include additionally the Application Server Instance address that the UE
had a communication session with when the MOS measurement was made.
Tables 6.49.3.3-1 and 6.49.3.3-2 provides information on the contents of the
Application Service Experience statistics and predictions contained within
Observed Service Experience analytics.
Table 6.49.3.3-1: Observed Service Experience Statistics
* * *
Information Description >Application Service Experience (1...n) List of
observed service experience information for each Application. >> Application
ID Identification of the application. >> Application Server Instance Address
Identifies the Application Server Instance (IP address of the Application
Server). >>Location of Application Identifies the DNAI path of the UE when
communicating with the Application Server >>Service Experience Service
Experience over the Analytics target period (average, variance).
* * *
Table 6.49.3.3-2: Observed Service Experience Predictions
* * *
Information Description >Application Service Experience (1...n) List of
predicted observed service experience information for each Application. >>
Application ID Identification of the application. >> Application Server
Instance Address Identifies the Application Server Instance (IP address/FQDN
of the Application Server). >>Location of Application Identifies the DNAI path
of the UE when communicating with the Application Server >>Service Experience
Predicted Service Experience over the Analytics target period (average,
variance). > Probability assertion Confidence of this prediction
* * *
#### 6.49.3.4 Procedures
The procedure describes how a Consumer NF requests analytics for service
experience to identify the best Application Server Instance.
Figure 6.49.3.4-1: Alternative 2 procedure
0\. The NWDAF collects MOS service data each data associated to a specific
Application Server Instance. The data are described in Table 6.49.3.2-1.
1\. A Consumer NF decides to request from the NWDAF analytics of service
experience. The NF may query the NRF to determine the NWDAF providing
analytics at the UE location.
2\. A request for Analytics is sent to the NWDAF. The request includes an
Analytic ID identifying the type of analytics required (i.e. server app
performance), the location of the UE where the performance data are requested
and optional filters such as time of day.
3\. The NWDAF derives service experience analytics based on the MOS service
data provided by the AF.
4\. The NWDAF reports analytics containing a list of one or more Application
Server Instances and associated service experience
5\. The Consumer NF determines the best Application Server and/or DNAI path at
the UE location.
If the Consumer NF is the LDNSR the LDSNR uses the Analytics to determine the
EDN that has the best performance at the UE location and determine the L-DNS
server to forward a DNS request by a UE.
If the Consumer NF is the SMF the SMF can use the Application Server
Performance Analytics to determine the best DNAI path at the current UE
location.
### 6.49.5 Impacts on services, entities and interfaces
Alternative 1:
NWDAF:
\- Collecting performance data of Application Server Instances from each EDN.
\- Deriving Analytics containing a list of Application Server Instances and
associated performance data at the requested UE location and target period.
AF:
\- Providing measured performance data of the performance associated with the
communication session of the UE with an Application Server that includes:
Average Packet Delay, Average Loss Rate and Throughput.
Alternative 2:
NWDAF:
\- Enhancing the service experience analytics including as output data a list
of Application Server Instances and associated performance data at the
requested UE location and target period.
AF:
\- Providing measured MOS performance data per Application Server Instance.
## 6.50 Solution #50: Network Assisted DNAI selection for Edge Computing
### 6.50.1 Description
This solution is for Key Issue #16: UP optimization for edge computing.
One of the benefits of edge computing is to allow locating serving resources
(e.g. computational resources) near a UE, and it improves network performance
due to the short distance between consumer and producer. To enable this
principle, the network traffic for a service served by edge computing need to
be handled differently according to user location. This solution assumes that
there are multiple application servers (e.g. EAS), and the network path
between PSA UPF and application servers are also different. In case, two PSA
UPF are reachable to a single application server, the routing paths could be
different. In means, that according to the PSA UPF selection (DNAI selection),
the application traffic will experience different network performance. Figure
6.50.1-1 depict a deployment scenario of this solution.
This solution is based on the network data analytics for a DN performance
(e.g. RTT, bandwidth) per application. By providing these analytics to AF or
internal NF such as PCF to help the selection of optimal UPF for a specific
application. To realize this solution, it is expected that 1) NWDAF collect
network traffic related measurement such as per DNAI measurement of traffic
volume, number of packets, 2) NWDAF analyse the network performance per DNAI
for a specific service, and 3) an actuator (e.g. AF, PCF, or SMF) select
optimal DNAI. In this solution, 3) is out of scope. By applying this solution,
it is expected that QoE of the application will be improved thanks to the
better network performances.
Figure 6.50.1-1: Edge computing deployed environment
The below is the principles of the solution:
\- A consumer (e.g. AF, SMF, or PCF) request to subscribe to DN performance
analytics to select best DNAI for a specific service. This solution assumes
that a solution is represented in Application ID.
\- NWDAF collect network data to analyse DN performance for a specific
application such as traffic volume, number of packets.
Editor\'s note: It is FFS to how to collect input data for analytics.
\- NWDAF generates analytics output showing the DN performance (e.g. RTT, and
bandwidth), and notify the output to the consumer.
\- (Out of scope) The consumer selects the best DNAI for a specific service by
considering each DN performance, server load (or UPF load), and user
preference in synthetically.
The consumer of these analytics shall indicate in the request or subscription:
\- Analytics Id set to \"DN performance\";
\- The Target of Analytics Reporting: Application ID;
\- Analytics Filter Information: one or more combinations of the following
Analytics Filters: S-NSSAI, DNN;
\- An Analytics target period that indicates the time window for which the
statistics or predictions are requested; and
\- In a subscription, the Notification Correlation Id and the Notification
Target Address.
### 6.50.2 Input Data
The inputs to bind network data for a specific application. It is expected to
be contained in a subscription request from a consumer. The data collection
for analytics is mainly from SMF to collect user plane performance measured at
UPFs.
Table 6.50.2-1: Input Data from SMF
* * *
Information Source Description S-NSSAI (optional) SMF Identifies the Network
Slice for which analytics information is provided. DNN SMF Identifies the data
network name (e.g. internet) for which analytics information is provided DNAI
(or UPF ID) SMF Identifies the DN for which analytics information is provided
Application ID SMF Identifies target application service QoS flow Bit Rate SMF
The observed bit rate QoS flow Packet Delay SMF The observed Packet delay.
Packet transmission SMF The observed number of packet transmission.
* * *
Editor\'s note: It is FFS to how to collect input data for analytics from
other NFs.
### 6.50.3 Output Analytics
The output analytics of NWDAF is defined in Table 6.50.3-1.
Table 6.50.3-1: Output for DN performance
* * *
Information Description S-NSSAI (optional) Identifies the Network Slice for
which analytics information is provided. DNN Identifies the data network name
(e.g. internet) for which analytics information is provided DNAI Identifies
the DN for which analytics information is provided Application ID Identifies
target application service Bandwidth The experienced bandwidth of given DNAI
for an application. RTT (Round Trip Time) The experience RTT of given DNAI for
an application. Service Experience Service Experience e.g. service MOS of
given DNAI for an application.
* * *
### 6.50.4 Procedures
For the procedure to select an optimal DNAI by AF is depicted in Figure
6.50.4-1. The procedure is based on AF scenario. Internal NF such as PCF or
SMF may consume the proposed analytics to select DNAI for a given S-NSSAI and
DNN.
Figure 6.50.4-1: A procedure to select best DNAI for a specific application
1\. An AF request DNAI performance analytics for a specific application. An
application traffic is represented with Application ID. This request may be
delivered via NEF.
2\. NWDAF collects network data from SMF for a requested application traffic
per UPF. The NWDAF need to collect data from multiple UPFs can serve an
application for S-NSSAI and DNN.
3\. NWDAF generate DN performance analytics as described in Table 6.50.3-1.
4\. NWDAF notifies the analytic to the consumer AF.
5-6. (out of scope) An AF select DNAI considering the output analytics.
### 6.50.5 Impacts on services, entities and interfaces
NWDAF:
\- Need to provide a new analytics for DN performance for a specific
application.
\- Need to collect data from multiple UPFs (DNAIs).
NEF:
\- Need to expose DN performance analytics to AF.
## 6.51 Solution #51: optimization for edge computing
### 6.51.1 Description
#### 6.51.1.1 General
This is a solution for the Key Issue#16: UP optimization for edge computing.
#### 6.51.1.2 Procedure
Figure 6.51.1.2-1: Procedure for UP optimization for edge computing
1\. The consumer MEC sends an Analytics request/subscribe (Analytics ID =
Service Experience, Target of Analytics Reporting = group of UEs in area
serviced by the MEC, Analytics Filter information = (Application ID, Analytics
target period S-NSSAI, DNN, Area of Interest)) to NWDAF via NEF by invoking
Nnef_AnalyticsExposure_Subscribe service operation as specified in clause
6.1.1.2, TS 23.288 [5]. If the analytics information subscription is
authorized by the NEF, the NEF subscribes analytics information to the NWDAF
by using Nnwdaf_AnalyticsSubscription_Subscribe service operation as specified
in clause 6.1.1.2, TS 23.288 [5].
2a. NWDAF subscribes the service data from AF by invoking
Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe service (Event ID
= Service Data, Event Filter information = (Application ID, Area of Interest),
Target of Event Reporting = group of UEs in the area serviced by the MEC).
2b. NWDAF subscribes the network data from 5GC NF(s) by invoking
Nnf_EventExposure_Subscribe service operation.
2c. With these data, the NWDAF estimates the Service experience for the
application for the MEC.
3.. The NWDAF provides the analytics information to the MEC via NEF by means
of Nnwdaf_AnalyticsSubscription_Notify service operation and the NEF notifies
the MEC with the corresponding analytics information by invoking
Nnef_AnalyticsExposure_Notify service operation as specified in clause
6.1.1.2, TS 23.288 [5].
NOTE: The above steps can reuse the procedure defined in clause 6.4.4, TS
23.288 [5], with the MEC acted as a consumer.
4\. Based on statistics or prediction of observed service experience provided
by NWDAF, MEC determines to adjust service parameters. E.g. service parameters
of video for adjustment may be bit rate, frame rate, codec format, compression
parameter, screen size, etc. In this way, the service parameters adjusted can
better match the network conditions and achieve the better user experience.
### 6.51.2 Impacts on services, entities and interfaces
MEC:
\- Support the adjustment of service parameters based on analysis provided by
NWDAF.
## 6.52 Solution #52: Accuracy levels and options
### 6.52.1 Description
#### 6.52.1.1 General
This is a solution for the KI#17 \"Definition of accuracy levels\".
Accuracy depends on the subsets of analytics produced (continuous versus
discrete values, vectors) per analytics ID. Accuracy constraints, in the scope
of the NWDAF, are requirements on the quality of expected outputs. Accuracy
levels with finer grain can guide the choice of relevant data collection and
calculation models, and the amount of resources (signalling, calculation) to
be mobilized.
The control of accuracy options may be modified under the following
principles:
\- Add 2 additional values to every \"accuracy level\" parameter, i.e. allow
up to 4 levels;
\- Define a new \"subset accuracy level\" optional parameter, applicable per
subset of analytics.
\- Keep the existing \"preferred level of accuracy\" global parameter (see TS
23.288 [5] clause 6.1.3), which would act as a default value for the subsets
that don\'t have any \"subset accuracy level\" parameter.
#### 6.52.1.2 Procedures
The NWDAF adapts data collection and computation models according to the
accuracy options.\ No impact on procedures is necessary.
### 6.52.2 Impacts on services, entities and interfaces
Additional parameters on Nnwdaf.
## 6.53 Solution #53: Support of Multiple NWDAF with Efficient Cooperation
### 6.53.1 Functional description
The solution addresses Key Issue #2: Multiple NWDAF instances.
In general, we think for multiple NWDAF instances, two architecture options
can be considered, i.e. hierarchical and distributed.
For hierarchical NWDAF architecture, Local NDWAF only has connection with
Central NWDAF which means a tree topology is assumed. With such tree topology,
both central NWDAF and local NWDAF can discover each other which means they
don\'t need to consult NRF dynamically. The linkage between Local NWDAF and
Central NWDAF can be configured statically.
Figure 6.53.1-1: Hierarchical NWDAF Architecture
For distributed NWDAF architecture, there is no central NWDAF, multiple NWDAF
have peer-to-peer relationship among each other. There may be no need to have
full mesh linkage between NWDAF instances but meanwhile, we think there is
neither need to restrict the number of NWDAF linkages with other NWDAF. NRF
interaction may be needed to configure the linkage between NWDAF instances or
such linkage can be configured in NWDAF.
Figure 6.53.1-2: Distributed NWDAF Architecture
To achieve efficient cooperation, firstly, a NWDAF instance needs to be aware
of their profiles which means one NWDAF is aware of what kind of analytics IDs
a linked NWDAF can support. Secondly, NWDAF needs to exchange their load
status information so that one NWDAF can figure out the possibility to shift
some analytics task to another. Thirdly, NWDAF can interact with each other to
carry out the transferring of these analytics tasks.
### 6.53.2 Procedures
Figure 6.53.2-1 provides the procedure for NF consumer and NWDF interaction to
realize real-time NWDAF communication.
Figure 6.53.2-1: Procedure for Centralized NWDAF architecture
Figure 6.53.2-2: Procedure for Distributed NWDAF architecture
### 6.53.3 Impacts on services, entities and interfaces
For centralize NWDAF architecture, Central NWDAF and Local NWDAF needs support
the exchange of profile, load information and negotiate how to transfer the
analytics and data collection tasks.
For distributed NDWAF architecture, NWDAFs need to support the exchange of
profile, load information and negotiate how to transfer the analytics and data
collection tasks.
## 6.54 Solution #54 (merging Solution #55): Analytics Delay based solution
for Real-Time communication with NWDAF
### 6.54.1 Description
#### 6.54.1.1 General
This solution addresses key issue #18: Enhancement for real-time communication
with NWDAF.
Based on the procedures defined in TS 23.288 [5], an NWDAF analytic process
may include the following steps:
1\. NWDAF service consumer subscribe at NWDAF to be notified on analytics
information by using Nnwdaf_AnalyticsSubscription service, or requests to get
from NWDAF analytics information by using Nnwdaf_AnalyticsInfo service.
2\. NWDAF collects data from the data sources (e.g. NF such as AMF, SMF, PCF,
and AF; OAM) as a basis of the computation of network analytics.
3\. NWDAF derives requested analytics information based on the data collected
from the data source(s).
4\. NWDAF provides requested analytics information to the NWDAF service
consumer by using Nnwdaf_AnalyticsInfo_Request Response or
Nnwdaf_AnalyticsSubscription_Notify service operation.
The existing procedures for analytics derivation (step 3 as mentioned above)
are triggered by the request from NWDAF service consumer. The observation of
the existing mechanism so far is that:
\- The data analytics derivation cannot be done before receiving an analytics
request from the NWDAF service consumer.
For preventing the extra time caused by the existing mechanism, this solution
proposes to enhance NWDAF to support to provide network data analytics within
a Supported Analytics Delay. The NWDAF may process data pre-analytics for some
specific Analytics ID(s) when an analytics subscription or analytics request
is received from a Consumer NF. A NWDAF which supports to provide network data
analytics within a Supported Analytics Delay should send the Supported
Analytics Delay and corresponding Analytics ID(s) to the NRF as part of its NF
Profile during the NF service Registration procedure as specified in clause
4.17.1, TS 23.502 [3]. The NRF should take the Supported Analytics Delay per
Analytics ID into account during the NWDAF discovery procedure performed by
NWDAF service consumer.
A NWDAF may support several Analytics IDs, and it is possible that some of the
Analytics IDs supported by the NWDAF are applicable to be treated within a
given Supported Analytics Delay while others are not.
During the NWDAF discovery procedure (as specified in clause 4.17.4 or 4.17.9,
TS 23.502 [3]), the NWDAF service consumer may indicate whether it expects
real-time communication with NWDAF (i.e. the NWDAF needs to return the network
data analytics within its Supported Analytics Delay) for specific Analytics
ID(s) in the service discovery request. Based on the information corresponding
to the real-time communication expectation received from the NWDAF service
consumer, the NRF selects a candidate NWDAF list for the NWDAF service
consumer. In case of delegate service discovery, the indication of whether
real-time communication with NWDAF is needed is included in the request sent
from the NWDAF service consumer to the SCP. The consumer NF determines a
suitable NWDAF from the candidate NWDAF list by comparing its Expected
Analytics Delay with the Supported Analytics Delay of each candidate NWDAF.
The NWDAF service consumer then establishes the Analytics Subscribe procedure
(as specified in clause 6.1.1, TS 23.288 [5]) or the Analytics Request
procedure (as specified in clause 6.1.2, TS 23.288 [5]) to the selected NWDAF.
Upon receiving the Analytics Request / Subscribe from the NWDAF service
consumer, the NWDAF provides the requested analytics information to the NWDAF
service consumer based on the pre-analytics result in the duration not longer
than its Supported Analytics Delay.
#### 6.54.1.2 Procedure for NWDAF registration
Figure 6.54.1.2-1: Procedure for NWDAF registration
1\. During the data collection, for an Analytics ID, each NWDAF calculates the
Supported Analytics Delay for this Analytics ID. The Supported Analytics Delay
for an Analytics ID is a value for all received Analytic requests for specific
area of interest, which is not a UE or UE group specific.
NOTE 1: The granularity of the NWDAF profile is still Analytics ID itself but
not Analytics ID for certain UE, UE group or NF. The Supported Analytics Delay
can be evaluated by sampling before the NWDAF register the Analytics ID, NWDAF
Serving Area and the Supported Analytics Delay into the NRF.
NOTE 2: The determination of Supported Analytics Delay, and how the NWDAF
avoid updating its Supported Analytics Delay in NRF frequently is NWDAF
implementation specific.
2\. The NWDAF sends Nnrf_NFManagement_NFRegister Request message to NRF,
additionally includes the Support Analytics Delay and corresponding Analytics
ID(s) as part of its NF Profile.
3\. The NRF acknowledge NF Registration is accepted via
Nnrf_NFManagement_NFRegister response.
#### 6.54.1.3 Procedure for NWDAF discovery
Figure 6.54.1.3-1: Procedure for NWDAF discovery
Step 1. The NWDAF service consumer sends Nnrf_NFManagement_NFDiscover Request
message to NRF, includes an indication which indicates it expects real-time
communication with NWDAF for specific Analytics ID(s).
NOTE: The \"time when analytics is needed\" is used for request/response mode
and refer to the timestamp when the consumer NF plan to consume the analytics
from NWDAF as defined in clause 6.1.3, TS 23.288 [5], while the \"Expected
Analytics Delay\" is used for subscribe/notification mode and refer to an
maximum duration in which the consumer can suffer.
Step 2. The NRF determines a set of candidate NWDAF(s) matching the
Nnrf_NFDiscovery_Request and sends the candidate NWDAF profiles (including
Supported Analytics Delay of each candidate NWDAF) to the NWDAF service
consumer.
Step 3. The NWDAF service consumer determines a suitable NWDAF by comparing
its Expected Analytics Delay with the Supported Analytics Delay of each
candidate NWDAF. The Expected Analytics Delay for specific Analytics ID is
internally determined by the NWDAF service consumer based on the local
requirement for real-time or near real-time communication per Analytics ID.
The following impacts are applicable to clause 4.17.9, TS 23.502 [3] when a
NWDAF service consumer requests for the discovery of a NWDAF which supports to
provide the network data analytics within a given analytics delay with
delegated service discovery:
\- Step 1: The NWDAF service consumer sends the service request message to
SCP, includes an indication which indicates it expects the NWDAF to provide
the network data analytics within a given analytics delay for specific
Analytics ID(s).
#### 6.54.1.4 Data pre-collection and pre-analytics
The pre-collection and pre-analytics are not available in NWDAF all the time
but available when an analytics subscription or analytics request is received
from a Consumer NF. For example, the subscription or the request may apply for
a future time period, so the NWDAF may pre-collection and pre-analytics.
Figure 6.54.1.4-1: Data pre-analytics procedure
0\. The NWDAF successfully registered in NRF and receives an analytics Request
or Subscription from a consumer NF.
1\. The NWDAF subscribes to the data source for necessary data/event reporting
by sending Data collection Subscribe Request. In cases of different scenarios,
the Data collection Subscribe procedure may be:
\- Nnf_EventExposure_Subscribe in case of the data source is an NF.
\- Nnef_EventExposure_Subscribe in case of the data source is an AF. In this
case, the service data subscribe request should be forwarded from NEF to AF by
invoking Naf_EventExposure_Subscribe service operation.
\- Nnrf_NFManagement_NFStatusSubscribe in case of the data source is an NRF.
\- Subscribe (Input) in case of the data source is an OAM.
The NWDAF should additionally include a continuous data reporting indication
in the Data collection Subscribe Request to indicate the data source to report
the subscribed data/event continuously to the NWDAF until the NWDAF
unsubscribes the data/event reporting. The immediate reporting flag may be
used by the NWDAF, if available, to obtain the current status of the
subscribed event.
NOTE 1: In case of the data source is an NRF, the NWDAF may invoke
Nnrf_NFDiscovery service before invoking Nnrf_NFManagement_NFStatusSubscribe
to obtain the current NF information from the NRF.
The data source responds the request by sending Data collection Subscribe
Response to the NWDAF.
2\. Data source notifies to the NWDAF the subscribed data/event continuously
based on the continuous data reporting indication received from the NWDAF in
Data collection Subscribe Request. The data/event notification can be done by:
\- Nnf_EventExposure_Notify in case of the data source is an NF.
\- Naf_EventExposure_Notify in case of the data source is an AF.
In this case, the service data notification should be forwarded from NEF to
NWDAF by invoking Nnef_EventExposure_Notify service operation.
\- Nnrf_NFManagement_NFStatusNotify in case of the data source is an NRF.
\- Notification (notifyFileReady) in case of the data source is an OAM.
3\. The NWDAF processes pre-analytics for the Analytics ID(s) requested or
subscribed by the consumer NF based on the data/event reported by the data
source. The NWDAF should keep updating the analytics result of specific
Analytics ID(s) when receiving new notification from the data source.
NOTE 2: The trained data model is derived by the NWDAF itself during the data
pre-analytics procedure or shared from other NWDAFs relies on the conclusion
of KI#19.
4\. The NWDAF sends Data collection Unsubscribe Request to data source when it
decides not to collect data from the data source. The Data collection
Unsubscribe procedure may be:
\- Nnf_EventExposure_Unsubscribe in case of the data source is an NF.
\- Nnef_EventExposure_Unsubscribe in case of the data source is an AF.
In this case, the service data subscribe request should be forwarded from NEF
to AF by invoking Naf_EventExposure_Unsubscribe service operation.
\- Nnrf_NFManagement_NFStatusUnsubscribe in case of the data source is an NRF.
\- Unsubscribe operation in case of the data source is an OAM.
The data source stops reporting data/event to the NWDAF and responds the
request by sending Data collection Unsubscribe Response to the NWDAF.
### 6.54.2 Impacts on services, entities and interfaces
NWDAF:
\- Supports to additionally include the Supported Analytics Delay and
corresponding Analytics ID(s) as part of its NF Profile during the NF service
Registration Procedure. The Supported Analytics Delay is per analytics ID and
applicable to the whole NWDAF serving area, and does not depend on whether
analytics request are related to NFs, specific UEs, group of UEs or even any
UE.
\- Supports to process continuous data collection after the NF service
Registration procedure when receiving analytics subscription or request from
NWDAF service consumer.
\- Supports to process pre-analytics for specific Analytics ID(s) continuously
after obtaining the necessary data.
NRF:
\- Supports to maintain the NF Profile of the NWDAF including the Supported
Analytics Delay.
\- Supports to provide a candidate NWDAF list to the NWDAF service consumer in
the NWDAF discovery response.
NWDAF service consumers:
\- Supports to include an indication in the NF service discovery request which
indicates that real-time communication with NWDAF for specific Analytics ID(s)
is needed.
\- Supports to determines a suitable NWDAF from the candidate NWDAF list by
comparing its Expected Analytics Delay with the Supported Analytics Delay of
each candidate NWDAF.
NOTE: It is needed to check if \"time when analytics information is needed\"
parameter as introduced in Rel-16 (see clause 6.1.3 from TS 23.288 [5]) can be
reused for providing expected analytics delay.
## 6.55 Solution #55: Enhancement for Real-Time and Near-Real-Time
Communication with NWDAF
### 6.55.1 General
This solution addresses key issue #18: Enhancement for real-time communication
with NWDAF.
### 6.55.2 Functional description
The definition of real-time and non-real-time NWDAF communication
**Real-time NWDAF communicatio** n: The NWDAF can perform analytics and
provide the outcome to the NF consumer within a time period (i.e. the required
analytics delay) which is less than the expected analytics delay.
**Near real time NWDAF communication** : The NWDAF can perform analytics and
provide the outcome to the NF consumer within a time period (i.e. the required
analytics delay) which is close to the expected analytics delay.
The expected analytics delay corresponds to actual time NWDAF takes to carry
out the analytics including data collection, analysis and delivery of outcome.
The required analytics delay is a parameter provided by the NF consumer and it
corresponds to how long the NF consume can wait for the NWDAF to carry out the
analytics including data collection, analysis and delivery of outcome.
To realize real-time NWDAF communication, we think it necessary to have a
solution which the required analytics delay can be acquired from the NF
consumer and NWDAF can judge whether it can support real-time communication
with the NF consumer i.e. by comparing whether the expected analytics delay is
less than or close to the required analytics delay.
From functional perspectives, the NF consumer can provide the required
analytics delay when subscribe analytics services or request analytics. The
NWDAF, by its implementation, can judge the expected analytics delay for a
certain task. Upon receiving a subscribe or request, NWDAF can decide whether
the required delay from consumer can be supported by comparing it with the
expected analytics delay. If not, it can indicate to the NF consumer so that
NF consumer is aware whether it can perform real-time communication with
NDWAF.
### 6.55.3 Procedures
Figure 6.55.3-1 provides the procedure for NF consumer and NWDF interaction to
realize real-time NWDAF communication.
Figure 6.55.3-1: NF consumer and NWDAF interaction to support real-time NWDAF
communication.
### 6.55.4 Impacts on services, entities and interfaces
NF consumer and NWDAF needs to exchange expected analytics delay and whether
the delay can be supported.
NOTE: It is needed to check if \"time when analytics information is needed\"
parameter as introduced in Rel-16 (see clause 6.1.3 from TS 23.288 [5]) can be
reused for providing required analytics delay.
## 6.56 Solution #56: Trained ML Model Sharing between NWDAF instances
### 6.56.1 Description
This is a solution for KI #19. It is also related to KI #2- Multiple NWDAF
instances and KI #1- Logical decomposition of NWDAF and possible interactions
between logical functions.
This contribution provides a solution for NWDAF instance to share a trained
Machine Learning (ML) model to other NWDAF instances.
A ML Model Provider NWDAF instance provides the trained data model to ML Model
Consumer NWDAF instances via ML model provision service. It registers its
capability to expose a trained ML model in the NRF. A ML Model Consumer NWDAF
instance discovers the address of the ML Model Provider NWDAF instance by
inquiring the NRF.
Table 6.56.1.1-1: NWDAF services for model provision
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer(s) | | | | Semantics | | +----------------+----------------+----------------+----------------+ | Nnwdaf_ML | Subscribe | Subscribe / | NWDAF | | ModelProvision | | Notify | | | | | | (ML Model | | | | | Consumer) | +----------------+----------------+----------------+----------------+ | | Unsubscribe | | | +----------------+----------------+----------------+----------------+ | | Notify | | | +----------------+----------------+----------------+----------------+ | Nnwda | Request | Request / | NWDAF | | f_MLModelInfo | | Response | | | | | | (ML Model | | | | | Consumer) | +----------------+----------------+----------------+----------------+ | Nnwdaf\ | Notify | Subscribe / | NWDAF | | _MLModelUpdate | | Notify | | | | | | (ML Model | | | | | Provider) | +----------------+----------------+----------------+----------------+ | Nnw | Notify | Su | NWDAF | | daf_LocalTrai | | bscribe/Notify | | | ningDataUpdate | | | (ML Model | | | | | Provider) | +----------------+----------------+----------------+----------------+
The Nnwdaf_MLModelProvision service or Nnwdaf_MLModelInfo service should
include the following input and output.
Input:
\- Analytics ID.
\- Optional: Timestamp.
\- Optional: Indication of local model update capability, e.g. for federated
learning.
\- Optional: Indication of online learning data update capability.
\- Optional: Level of Confidence (The level of confidence describes the
expected level (in %) that the prediction is correct).
\- Optional: area of interests, UE types, application ID, NSSAI, time.
NOTE 1: Timestamp is used to indicate the version of current Model if
available.
NOTE 2: Indication of local model update capability may be skipped if the
local NWDAF profile has indicated both inference and training capabilities at
NRF and Producer NWDAF has knowledge of this local NWDAF capabilities.
NOTE 3: Indication of online learning data update capability may be skipped if
the local NWDAF profile has indicated this capability at NRF and Producer
NWDAF has knowledge of this local NWDAF capabilities.
Output:
\- An address (e.g. URL or FQDN) of Model file.
\- Timestamp.
\- Optional: indication to subscribe local model update with update
conditions, e.g. indicating periodic update time, start and end update, number
of training iterations, etc.
\- Optional: indication to subscribe online learning data update with update
conditions, e.g. indicating periodic update time, start and end update time,
number of training data sets per update, etc.
NOTE 4: Timestamp is used to indicate the version of the provisioned Model.
NOTE 5: If online learning update is not indicated, the offline learning is by
default.
The Nnwdaf_MLModelUpdate_Notify service operation should include the following
input and output.
Input:
\- An address (e.g. URL or FQDN) of Model update file
\- Time stamp of model update
NOTE 6: The identification of targeted ML model to update is provided in Model
update file.
Output:
\- None.
The Nnwdaf_LocalTrainingDataUpdate_Notify service operation should include the
following input and output.
Input:
\- Analytics ID.
\- An address (e.g. URL or FQDN) of Data update file.
NOTE 7: The identification of targeted ML model to update is provided in Data
update file.
\- Timestamp of current Model
Output:
\- None.
NOTE 8: The content of the Model file, Model update file and Data update file
are not defined in Rel-17.
The registered MLModelProvision and MLModelInfo service in the NRF includes
service parameters indicating the available ML models the ML Model Provider
NWDAF can provide (e.g., Analytics IDs). The registered Nnwdaf_MLModelUpdate
service in the NRF includes service parameters indicating the capability of
local ML model update the ML Model Consumer NWDAF can provide (e.g., Analytics
IDs).
After the service discovery, the ML Model Consumer NWDAF instances can either
subscribe to Nnwdaf_MLModelProvision service (to get always the updated ML
model/model parameter) or invoke Nnwdaf_MLModelInfo service to request a ML
model/model parameter (one time request).
ML model trained using the same training algorithm could be combined (e.g.,
using federate learning).
The ML Model Consumer NWDAF instance may further train or combine the ML
model/model parameters obtained from the ML Model Provider NWDAF instances and
become a ML Model Provider NWDAF by registration of the further
trained/combined ML model in NRF.
When the ML Model Provider NWDAF provides ML model to the ML Model Consumer
NWDAF by invoking Nnwdaf_ModelProvision_Notify, the ML Model Provider NWDAF
can indicate to subscribe to Nnwdaf_MLModelUpdate service of the ML Model
Consumer NWDAF in order to get the locally further trained ML model by ML
Model Consumer NWDAF, if the ML Model Consumer NWDAF can train the ML model.
Unless the ML Model Consumer NWDAF unsubscribes the subscription of model
provision, the ML Model Consumer NWDAF continues to notify its updated ML
model to the ML Model Provider NWDAF.
When the ML Model Provider NWDAF provides trained model to the ML Model
consumer NWDAF by invoking Nnwdaf_ModelProvision_Notify, the ML Model Provider
NWDAF can indicate to subscribe to Nnwdaf_ LocalTrainingDataUpdate service of
the ML Model Consumer NWDAF to get the results of locally collected training
data set (input parameters and output parameters of the inference). Unless the
ML Model Consumer NWDAF unsubscribes the subscription of model provision, the
ML Model Consumer NWDAF continues to notify its training data sets to the ML
Model Provider NWDAF.
Detailed procedures for trained model registration, discovery and consumption
is described in clause 6.56.2.
### 6.56.2 Procedure
Figure 6.56.2-1: Procedures for trained model registration, discovery, update
and consumption
1\. ML Model Provider NWDAF registers its trained ML model provision
capability (i.e. \"MLModelProvision service\" with a list of supported ML
model) as part of its profile in the NRF.
2\. NRF stores the NWDAF profile.
3\. NRF sends registration response to ML Model Provider NWDAF.
4\. ML Model Consumer NWDAF sends discovery request of \"MLModelProvision
service\" with a list of service parameters (e.g. Analytics ID) to NRF.
5\. NRF response with the NWDAF instance which provides the requested
\"MLModelProvision service\".
6\. ML Model Consumer NWDAF requests/subscribes to the \"MLModelProvision
service\" of the discovered ML Model Provider NWDAF instance.
7\. The discovered ML Model Provider NWDAF instance response/notify with an
address pointing to the stored ML model file. At this point, the ML Model
Provider NWDAF instance can determine to subscribe to ML model update
notification of the ML Model Consumer NWDAF if the ML Model Consumer NWDAF is
with both the training capability of the local model update and inference
capability. If ML Model Consumer NWDAF has only inference capability, the step
8-11 can be skipped.
The ML Model Provider NWDAF can also determine to subscribe to
LocalTrainingDataUpdate notification of the ML Model Consumer NWDAF if ML
Model Consumer NWDAF is with both local training data update capability and
inference capability. If ML Model Consumer NWDAF has only inference
capability, the step 12-14 can be skipped.
8\. The ML Model Consumer NWDAF locally updates the ML model and the model
parameter, if NWDAF can train the model.
9\. The ML Model Consumer NWDAF sends the results of local ML model update in
step 8 by invoking \"Nnwdaf_MLModelUpdate_Notify\" service operation, if the
ML Model Provider NWDAF subscribed to be notified in step 7.
10\. The ML Model Provider NWDAF aggregates the results of local ML model
update information from the ML Model Consumer NWDAF(s), if needed, and updates
the ML model.
11\. The ML Model Provider NWDAF sends the updated model to the ML Model
Consumer NWDAFs by invoking \"Nnwdaf_MLModelProvision_Notify\".
12\. The ML Model Consumer NWDAF locally collects training data information
when conducting inference operation as well as related situational information
during inferencing, e.g. inference timestamp, UE types, UE location,
application ID, time, etc.
13\. The ML Model Consumer NWDAF sends the results of local update of training
data information and related situational parameters in step 12 by invoking
\"Nnwdaf_LocalTrainingDataUpdate_Notify\" service operation, if the ML Model
Provider NWDAF subscribed to be notified in step 7.
14\. The ML Model Provider NWDAF uses the results of local update information
as training data from the ML Model Consumer NWDAF, if needed, and updates the
ML Model.
15\. The ML Model Provider NWDAF sends the updated model to the ML Model
Consumer NWDAF by invoking \"Nnwdaf_ModelProvision_Notify\".
16\. The ML Model Consumer NWDAF instance may further train the obtained ML
model or combine the obtained ML model/model parameters from multiple ML Model
Provider NWDAF instances to a new ML model.
17\. The ML Model Consumer NWDAF instance registers the new ML model provision
capability at NRF as step 1-3 and become also a ML Model Provider NWDAF.
Afterwards, the ML Model discovery and consumption is the same as step 4-7.
NOTE: The ML model itself is provided to the ML Model Consumer NWDAF instances
in a file.
### 6.56.3 Impacts on services, entities and interfaces
NWDAF:
\- Service based interface for exposing a trained ML model/parameters.
\- Service base interface for receiving a trained ML model/parameters.
\- Service based interface for updating a trained ML model/parameters.
\- Service based interface for updating training data sets.
\- Extended NWDAF profile with trained ML model provision capability.
## 6.57 Solution #57: Reselection of NWDAF due to mobility change
### 6.57.1 Description
This solution is for Key Issue #2: Multiple NWDAF instances.
The consumer NF should select an appropriate NWDAF among multiple NWDAF
instances to make subscriptions for data analytic. There will be some cases
that serving NWDAF of one consumer NF may need to change due to UE mobility
event. Upon the change of UE location, AMF is required to inform the serving
NWDAF, and the serving NWDAF decides whether to continue analysis service or
start NWDAF re-selection. An analytics context relocation is indicated from
the source NWDAF to the target NWDAF. It is also required to inform the
related consumer NF of the NWDAF re-selection event and also to update
subscriptions between the NWDAF and the consumer NF. The analytic data and
stored input data can be transferred from the previous serving NWDAF instance
to new NWDAF, if applicable, to facilitate the new NWDAF to produce the
analytics.
### 6.57.2 Procedures
#### 6.57.2.1 Re-selection of NWDAF without AMF change
Figure 6.57.2.1-1: Procedure for re-selection of NWDAF without AMF change
1\. Consumer NF sends an analytics subscription to the NWDAF1 by invoking an
Nnwdaf_AnalyticsSubscription_Subscribe service; the NWDAF1 subscribes to fetch
the network data or management data from the NF(s) or the OAM and the NF(s) or
the OAM deliver the network data or management data, as defined in TS 23.288
[5].
2\. The NWDAF1 subscribes the UE mobility event notification from AMF by
invoking an Namf_EventExposure_Subscribe service.
3\. UE mobility event is detected by AMF and the AMF notifies the UE mobility
event to the NWDAF1 by invoking the Namf_EventExposure_Notify service if the
TAI of the UE changes. NWDAF1 determines if the UE location is in the serving
area of NWDAF1. If yes, the NWDAF1 could continue the analytics service,
otherwise, the NWDAF1 triggers the re-selection of NWDAF.
4\. The NWDAF1 interacts with NRF by sending Nnrf_NFDiscovery_Request to
discover an appropriate NWDAF2 for the UE.
5a. [OPTIONAL] The NWDAF1 invokes the Nnwdaf_AnalyticsRelocation_Request or
enhanced Nnwdaf_AnalyticsInfo_Request service to the NWDAF2 to trigger
relocation. The NWDAF2 responds to the NWDAF1 with a
Nnwdaf_AnalyticsRelocation_Response or Nnwdaf_AnalyticsInfo_Response service
operation which includes information on the subscription selected by the
NWDAF2.
5b. The NWDAF1 invokes the Nnwdaf_AnalyticsRelocation_Request or enhanced
Nnwdaf_AnalyticsInfo_Request service to the NWDAF2 to transfer subscribed
information in analytics context consisting of Subscription ID, Analytics ID,
Target of Reporting and Event Reporting Information. The NWDAF2 responds to
the NWDAF1 with a Nnwdaf_AnalyticsRelocation_Response or Nnwdaf_AnalyticsInfo
Response service operation which confirms the selected subscribed information
has been received by the NWDAF2.
6\. The NWDAF1 sends Nnf_EventExposure_Unsubscribe to the NF(s) or the OAM to
unsubscribe the fetching the network data.
7\. The NWDAF2 invokes the Nnwdaf_AnalyticsSubscription_Notify service to the
consumer NF to notify the release of the subscriptions of NWDAF1 and take over
the analytics subscription for the consumer NF.
8\. The NWDAF2 invokes the Nnf_EventExposure_Subscribe service to the source
NF(s) or OAM to subscribe the data in the source NF(s) or OAM.
#### 6.57.2.2 Re-selection of NWDAF with AMF change
Figure 6.57.2.2-1: Procedure for re-selection of NWDAF with AMF change
1\~2. Steps 1\~2 are executed as defined in clause 6.57.2.1.
3\. The AMF2 invokes the Namf_Communication_UEContextTransfer service
operation to the AMF1 to fetch the UE context which includes the subscription
of the UE mobility event from AMF1.
4\~9. Steps 3\~8 are executed as defined in clause 6.57.2.1.
### 6.57.3 Impacts on Existing Nodes and Functionality
NWDAF:
\- Supports a subscription negotiation and transfer procedure.
\- Transfers and receives stored analytics and input data.
Consumer NF:
\- Supports subscription renewal to new NWDAF.
## 6.58 Solution #58: Efficient Service for Data Collection in NWDAF-to-NWDAF
Interactions
### 6.58.1 Description
This solution is proposed for Key Issue #2: Multiple NWDAF instances, Key
Issue #11: Increasing efficiency of data collection.
#### 6.58.1.1 General
The goal of this solution is to define the alternatives for realizing the
services related to data collection in NWDAF-to-NWDAF interactions (e.g., in
flat or hierarchical model of NWDAF deployments). Such service can be used for
data collection supporting NWDAF operation for analytics IDs in both inference
(e.g., data collection for analytics ID output generation) or training stages
(e.g., data collection for training a model for an analytics ID).
NWDAF exposing collected data is enhanced with the following capabilities:
\- Providing bulked data to consumers instead of individual data samples in
order to reduce signalling and efficiency on controlling the raw collected
data from sources (i.e., NF events or OAM data). The bulked data is the set of
data samples to be used for an analytics ID for a consumer of NWDAF. The
bulked data is generated based on the set of raw collected data from NFs/OAM
and the properties for the selection of such raw data.
\- The bulked data comprises the following fields: bulked data identification,
type of bulked data (\'\'raw data samples\'\' or \'\'pre-processed data
samples\'\' or a combination of both), if the type of bulked data is \'\'pre-
processed data samples\'\' the data type (e.g., Event ID) and associated
feature type (e.g., average values of Event ID) are included, data values
(when \'\'raw data samples\" type of bulk data is used) or feature values
(when \'\'pre-processed data samples\'\' type of bulked data is used), and
timestamp when the data sample is associated with a bulked data.
\- Exposing runtime collected data (e.g., data from NFs/AFs/OAM retrieved via
notification mechanisms), or historical collected data (e.g., data from
NFs/AFs/OAM that were at some point collected, then stored);
\- Apply selection processes of data samples or processing mechanisms for the
generation of the bulked data according to operator-defined rules. Such rules
define the allowed and/or restricted properties or processes to be applied to
the set of raw collected data to be used for the bulked data. Operators can
define such rules per analytics ID, or per bulk data consumer, or per network
slice, or a combination of them. Examples of properties are network slices;
area of interest; statistical attributes such as averages, mean, skewness;
aggregation levels, such as geographical per cell, per UEs, or temporal such
as per hours or days. Examples of processes are: definition of data collection
mode mechanisms; definition if raw collected data, or pre-processed data, or
both can be used for composing the bulked data; applying anonymization of data
fields in the bulked data to avoid exposing undesired information. It is
possible that operators might define different rules for generation of bulked
data for training or inference.
NOTE: If DCCF is used in the network, DCCF services can also be enhanced with
the capability of providing bulked data for an analytics ID. The principles of
parameters defined alternatives #1, #2, and #3 can also be exposed by DCCF
services to allow the data collection of bulked data for an analytics ID with
plain data, pre-processed data, or analytics output and data used for such
analytics generation.
#### 6.58.1.2 Models for the Data Collection Service
##### 6.58.1.2.1 Alternative 1: Applying Event Exposure Framework Principles
The service used by the entity responsible to provide the bulked data is based
on the Event Exposure framework defined in TS 23.502 [3] clause 4.15.
NWDAF shall expose the Nnwdaf_EventExposure service with the input parameters
as defined in TS 23.502 [3] Clause 4.15.1, as well as the following
extensions:
\- Event ID(s) set to \'\'Bulked data\'\' event type;
\- Target of Event Reporting including a tuple with analytics ID; type of
requested bulked data, which can be set to \'\'raw data samples\'\' or
\'\'pre-processed data samples\'\' or a combination of both; analytics stage
(inference or training);
\- Event Filter Information shall include:
\- fields related to the analytics ID such as: target of analytics information
(e.g., any UE, list of UEs, groups of UEs); analytics filter information
(e.g., area of interest, DNN, Application, S-NSSAI). The analytics ID also
determines the type of data to be collected and associated with the bulked
data;
\- feature type to be applied to the data samples in case the type of the
requested bulk data includes \'\'pre-processed data samples\'\'. Examples of
feature type are maximum values, average values, etc.
\- Event Reporting Information, in addition to the parameters defined in TS
23.502 [3] clause 4.15.1, the following parameters shall be included:
\- interval of time for sample selection;
\- data collection mode (DC mode) indicates the type of collection mechanisms
to be used. This parameter can set to: \'\'runtime\'\', \'\'offline\",
\'\'historical\'\'. Runtime\" indicates that current event exposure mechanisms
are applied, i.e. every time an event is ready, such event is notified to the
consumer. \"Offline\" indicates that mechanisms such as the one described in
clause 6.37 to reduce the frequency of notification from the NFs should be
applied. \'\'Historical\'\' determines that the data should be retrieved from
some previous period in time. When the \'\'historical\'\' DC mode is included,
the interval of the historical time window should be included as input
parameter. The default DC modes for inference and training stages are
respectively, \'\'runtime\" and \'\'offline\";
\- (optional) minimum and/or maximum number of samples to be included in the
bulked data.
The notification message shall contain the subscription correlation ID, and
the generated bulked data.
##### 6.58.1.2.2 Alternative 2: Extensions to NWDAF Services
The extensions of existing NWDAF services allow to provide the bulked data
(i.e., data samples) instead of the calculated analytics output.
In this alternative, the input and output parameters of
Nnwdaf_AnalyticsSubscription and Nnwdaf_AnalyticsInfo services defined,
respectively, in TS 23.288 [5] clause 7.2 and clause 7.3 shall be extended.
The extensions to input parameters of such NWDAF services are:
\- An indication that the service is being invoked in order to retrieve the
bulked data associated with the analytics ID or the analytics output and the
bulked data used to generate such analytics output. Examples of such
indication s are is reusing the AOG modes #1, #2, #4 defined in Solution #17,
clause 6.17.1.1, or the type of bulked data and/or the bulked data flag. In
the case the indication is specified as the AOG mode, this parameter also
denotes the type of bulked data that has to be provided: i.e., \'\'raw data
samples\'\' (AOG Mode #1) or \'\'pre-processed data samples\'\' (AOG Mode #2)
or a combination of both (AOG Mode #4). When the bulked data flag is included,
it denotes that the output of the NWDAF service shall include the bulked data
(i.e., data samples of all data types) for the analytics ID without providing
the analytics output. In the case the indication is the type of bulked data,
the possible values are \'\'raw data samples\'\' or \'\'pre-processed data
samples\'\' or a combination of both. When the output-bulked data flag is
included, it denotes that the output of the NWDAF service (in case of
notification service, for each output) shall include the generated analytics
ID and the bulked data (i.e., data samples of all data types) used to derive
such analytics ID output.
\- Analytics Filter Information shall include feature type to be applied to
the of data samples in case the type of the requested bulk data includes
\'\'pre-processed data samples\'\'. Examples of feature type are maximum
values, average values;
\- Analytics Reporting Information shall include:
\- interval of time for sample selection;
\- data collection mode (DC mode) as described above;
\- (optional) minimum and/or maximum number of samples to be included in the
bulked data.
The AOG Mode and/or bulked data flag input parameters are the indication to
NWDAF that a set of data related to an analytics ID needs to be associated to
a bulked data. Where the analytics ID, target of analytics ID, and analytics
filter information define the properties of the data collected or available at
NWDAF data shall be associated with such bulked data.
The extensions of output parameters for both NWDAF services
Nnwdaf_AnalyticsSubscription and Nnwdaf_AnalyticsInfo are:
\- If no flag or type of bulked data is used in the input parameters of
subscription/request, the output message contains the same parameters
specified in TS 23.288 [5];
\- If the input parameters of subscription/request included the AOG Mode or
type of bulked data and/or the bulked data flag, the output message shall
contain the subscription correlation ID (identifying the requested bulked
data) and the bulked data without containing the analytics output and related
fields (validity period, probability of assertion);
\- If the input parameters of subscription/request included the AOG Mode or
type of bulked data and the output-bulked data flag, the output message shall
contain the subscription correlation ID (identifying both the analytics ID
output and the requested bulked data) the analytics output and related fields
(validity period, probability of assertion), and the bulked data containing
the data used for generating such analytics output.
##### 6.58.1.2.3 Alternative 3: New Dedicated Service
A new dedicated service is exposed by NWDAF for to provide the bulked data.
The following three operations of this new service are defined to enable the
capability of asynchronous retrieval of input mapping initiated by the
consumer. These service operations allow three communication models:
subscribe-notify; request-response; asynchronous initiated by consumer.
The goal is to use the same service for collecting the data for analytics ID
inference or collecting data for analytics ID model training. Data collection
for model training will require such process to have a longer duration than
the process of data collection for inference. Therefore an asynchronous
communication model initiated by NWDAF consumer performing model training,
allows for such consumer to send a request for bulked data creation and later
when needed, fetch it. In case the consumer is an NWDAF collecting data for
inference, all three models of communication could be used upon operator\'s
decision.
Table 6.58.1.2.3-1: New data collection service
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer(s) | | | | Semantics | | +----------------+----------------+----------------+----------------+ | Nxxxx_ | Bulk | Request / | NWDAF | | DataManagement | edDataCreation | Response | | +----------------+----------------+----------------+----------------+ | | Bu | Re | NWDAF | | | lkedDataNotify | quest/Response | | +----------------+----------------+----------------+----------------+ | | B | Request / | NWDAF | | | ulkedDataFetch | Response | | +----------------+----------------+----------------+----------------+
The request for service operation Nxxxx_DataManagement_BulkedDataCreation
includes:
\- Analytics ID;
\- Target of analytics ID as defined in TS 23.288 [5];
\- Bulked data Filter Information shall include:
\- analytics filter information as already defined in TS 23.288 [5];
\- type of bulked data, which can be set to \'\'raw data samples\'\' or
\'\'pre-processed data samples\" or a combination of both; analytics stage
(inference or training);
\- feature type to be applied to the of data samples in case the type of the
requested bulked data includes \'\'pre-processed data samples\'\'. Examples of
feature type are maximum values, average values;
\- analytics stage (e.g., inference, training).
\- Bulked data Reporting Information shall include:
\- interval of time for sample association;
\- data collection mode (DC mode) as described above;
\- (optional) minimum and/or maximum number of samples to be included in the
bulked data;
\- fetch flag, when set to true, it indicates that the bulked data needs to be
generated and included in the response, when set to false, it indicates that
bulked data will not be returned in the response message. The default value of
fetch flag is false;
\- deadline which indicates the limit of time for providing the bulked data
when the fetch flag is set to true.
\- A Notification Target Address (+ Notification Correlation ID), where the
Notification Correlation ID is the unique identification for the bulked data
being generated for the requesting consumer.
The invocation of the new service Nnwdaf_DataManagement_BulkedDataCreation of
NWDAF is the indication to NWDAF that a set of data related to an analytics ID
needs to be associated to a bulked data. Where the analytics ID, target of
analytics ID, and analytics filter information define the properties of the
data collected or available at NWDAF data shall be associated with such bulked
data.
The response for the service operation
Nnwdaf_DataManagement_BulkedDataCreation includes: the bulked data
identification and depending on the use of the fetch flag the dataset (i.e.,
set of raw data samples and/or set of pre-processed data samples) of the
generated bulked data.
The parameters of the service operation Nnwdaf_DataManagement_BulkedDataNotify
includes: the bulked data identification and the generated bulked data.
The request for the service operation Nnwdaf_DataManagement_BulkedDataFetch
includes: the bulked data identification.
The response for the service operation Nnwdaf_DataManagement_BulkedDataFetch
includes: the bulked data identification and the dataset (i.e., set of raw
data samples and/or set of pre-processed data samples) of the generated bulked
data.
#### 6.58.1.3 Criteria for Alternative Selection and Co-existence
Alternative #1 and Alternative #3 enable data collection for both analytics
processes: inference and training. The format of the service is the main
difference.
Alternative #2 can co-exist with one of the other alternatives (#1 or #3).
The Alternative #2 has a value on supporting the data collection for
inference. In special, when one NWDAF has to generate an analytics ID spanning
an area of interests not covered by its NWDAF serving area. In this way, NWDAF
may interact with other NWDAF to collect all the data types related to the
analytics ID in order to generate the analytics output. Furthermore,
Alternative #2 enables NWDAF services to provide both the analytics output and
the bulked data. The major benefit of this alternative is that an NWDAF
consumer of another NWDAF can have both the a) analytics output, that can be
used for the composition of a single analytics output; and b) the bulked data,
that can become historical data at such NWDAF and therefore does not need
further signalling in the future to retrieve such data.
There should not exist a hard classification such as Alternative #1 (or #3) is
used for training and Alternative #2 used for inference, because as defined in
TS 23.288 [5] clause 6.2.1, NWDAF can prepare for future requests of analytics
ID before a request for analytics ID arrives. Therefore, the Alternative #1 or
#3 are the mechanism to support NWDAF to \"prepare for future requests\", by
collecting the data for inference even if NWDAF did not received yet a request
for analytics ID.
### 6.58.2 Procedure
The procedure described in Figure 6.58.2-1 describes how the different models
of data collection can be used in NWDAF-to-NWDAF interactions.
NOTE 1: Figure 6.58.2-1 illustrates only the interactions of NWDAF#1
collecting data from NWDAF#2, nevertheless there is no restriction that
NWDAF#1 can collect further data from other NFs/OAM.
NOTE 2: Figure 6.58.2-1 illustrates the case in which there exist a direct
interaction between NWDAFs. Nevertheless, if DCCF is deployed in the network
an NWDAF (e.g., NWDAF#1) can send the request to DCCF able to expose bulked
data, and such DCCF can further interact with other NWDAFs (e.g., NWDAF#2) if
required or directly with the NFs that provide the type of data required by
the requested bulked data.
Figure 6.58.2-1: NWDAF-to-NWDAF interactions for Data Collection
1\. NWDAF#1 identifies that further data from another NWDAF (i.e., NWDAF#2) is
required in order to perform some operation over an analytics ID. The triggers
for further data collection are related to:
a) the local policies of NWDAF (e.g. preparation for future requests for
analytics ID as specified in TS 23.288 [5] clause 6.2.2.1);
b) a request for analytics generation requiring data not covered by the NWDAF
serving area;
c) a request for model training; d) a request for bulked data generation that
NWDAF#1 cannot generate alone.
The description of steps 2a and 2b depends on the different alternatives
described in clause 6.58.1.2.
**Alternative #1: Applying Event Exposure Framework Principles**
2a. NWDAF#1 invokes Nnwdaf_EventExposure_Subscribe service from NWDAF#2 to
request a bulked data. The request includes the Event ID set to Bulked data,
Target of Event Reporting, Event Filter, Event Reporting Information with the
extensions defined in clause 6.58.1.2.1.
2b. Based on the received request, NWDAF#2 creates a new bulked data for the
requesting consumer and sends a confirmation of the request including the
subscription correlation ID that identifies the bulked data to be generated
for the requesting consumer (e.g., NWDAF#1).
**Alternative #2: Extensions to NWDAF Services**
2a. NWDAF#1 invokes Nnwdaf_AnalyticsSubscription_Subscribe service from
NWDAF#2 to request a bulked data. The request includes the AOG Mode or type of
bulked data and/or the Bulked data flag or the Output-Bulked Data flag,
Analytics ID, Target of Analytics, Analytics Filter Information, and Analytics
Reporting Information with the extensions defined in clause 6.58.1.2.2.
NOTE 1: When the Output-Bulked Data flag is included in the subscription, it
indicates to NWDAF#2 to trace the collected data for the generation of the
requested analytics ID and associated it to the bulked data.
2b. Based on the received request, NWDAF#2 creates a new bulked data for the
requesting consumer and sends a confirmation of the request including the
subscription correlation ID that identifies the bulked data to be generated
and/or the analytics output for the requesting consumer (e.g., NWDAF#1).
NOTE 2: For simplification, the Figure 6.58.2-1 depicts only the
subscribe/notify service of NWDAF. The same principal and parameters can be
used with the request/response service offered by NWDAF.
**Alternative #3: New Dedicated Service**
2a. NWDAF#1 invokes Nnwdaf_DataManagement_BulkedDataCreation service from
NWDAF#2 to request a bulked data. The request includes the Analytics ID,
Target of Analytics, Bulked data Filter Information, Bulked data Reporting
Information, and a Notification Target Address (+ Notification Correlation ID)
as defined in clause 6.58.1.2.3.
2b. Based on the received request, NWDAF#2 creates a new bulked data for the
requesting consumer and sends a confirmation of the request including the
Bulked data identification that identifies the bulked data to be generated for
the requesting consumer (e.g., NWDAF#1)
NOTE 3: The subscription correlation ID in Alternative #1 or #2, or the Bulked
data identification (ID) in Alternative #3 allow the consumer of the requested
bulked data to request to NWDAF any changes in the generation of the bulked
data related to such identification and to identify the received dataset to
the actually requested bulked data.
Step 3 - 4 are executed independent of the Alternative of indication for
bulked data.
3(a,b,c). Based on the received request, NWDAF#2 determines if further data
collection needs to be trigger in order to properly associate collected data
to the bulked data to be generated. NWDAF#2 triggers the data collection if
required using the data collection mechanism indicated in the DC mode
parameter received in Step 2b. If no DC mode parameter is provided in the
request, NWDAF#2 uses default DC modes associated with the analytics stages
(if analytics stages are included in the request) or default DC modes defined
in the rules.
For DC Mode \"Offline\", NWDAF#2 invokes the NF services according with
solutions that allow NFs to store events and reduce the notification
signalling to the consumer. This way, events from NFs are stored for a short
period of time and then transmitted in bulk to the consumer.
For DC Model \"Runtime\", NWDAF#2 invokes the NF services and will receive the
stream of events generated by the NF.
For DC Mode \"Historical\", NWDAF#2 uses the mechanisms to select the
historical information it has available.
4\. Based on the properties of the received request and the rules for bulked
data, NWDAF#2 generates the bulked data including the available or collected
data (directly from NFs or further required bulked data from other NWDAFs).
The description of steps 5, 5a, 5b depends on the different alternatives
described in clause 6.58.1.2.
NOTE 4: It is also possible that instead of providing the dataset of the
generated bulked data, the NWDAF#2 provides a reference to where the dataset
can be retrieved by the consumer of the bulked data, i.e., NWDAF#1.
**Alternative #1: Applying Event Exposure Framework Principles**
5\. NWDAF#2 sends to NWDAF#1 via Nnwdaf_EventExposure_Notify the
identification of the requested bulked data, and the dataset of the generated
bulked data.
**Alternative #2: Extensions to NWDAF Services**
5a. If request does not include Output-Bulked Data flag, NWDAF#2 sends to
NWDAF#1 via Nnwdaf_AnalyticsSubscription_Notify the identification of the
requested bulked data, and the generated bulked data.
5b. If request included Output-Bulked Data flag, NWDAF#2 sends to NWDAF#1 via
Nnwdaf_AnalyticsSubscription_Notify the identification of the requested bulked
data, the generated analytics output, and the bulked data used to generate
such analytics output.
**Alternative #3: New Dedicated Service**
5a-b. If the received request in Step 2 does not include the fetch flag:
NWDAF#2 keeps the generated bulked data (for a limited period of time). When
NWDAF#1 invokes the Nnwdaf_DataManagement_BulkedDataFetch request including
the bulked data identification, NWDAF#2 sends in the response the generated
bulked data associated with the requested bulked data identification.
5\. If the fetch flag is included in the received request in Step 2: NWDAF#2
sends to NWDAF#1 via Nnwdaf_DataManagement_BulkedDataNotify the bulked data
identification and the generated bulked data.
Step 6 is executed independent of the Alternative of indication for the need
of bulked data.
6\. The consumer of the bulked data, i.e., NWDAF#1 uses the received
information to process an analytics output inference request for an analytics
ID or process a model training request associated with the analytics ID or
further process a request to generate bulked data for the analytics ID.
### 6.58.3 Impacts on services, entities and interfaces
NWDAF:
\- Extensions of existing services or new services for exposing a dataset of
the generated bulked data related to an analytics ID as described in clause
6.58.1.2.
\- Bulked data generation.
\- Bulked data generation used to generate an analytics output.
## 6.59 Solution #59: Analytics handover
### 6.59.1 Introduction
This solution addresses aspects of KI #2: Multiple NWDAF instances, in
particular on how data collection and/or analytics generation can be enhanced
in multiple NWDAFs case, e.g. whether NWDAFs can cooperate with each other.
In multiple NWDAFs deployment scenario, it is possible that, within the time
period of data collection and/or analytics, NWDAF is required to handover its
analytics to other NWDAF or NWDAF is required to offload some of its analytics
to other NWDAF. Some examples:
\- One NWDAF1 is serving a specific area (a set of TAIs, e.g. TAI-1) and is
doing analytics for a UE registered in TAI-1. As long as the UE is located
within TAI-1, UE specific analytics (e.g. UE mobility or UE communication
analytics) can be performed by NWDAF1. At some point, the UE can move to a
different TAI-2 which is not served by NWDAF1 but rather served by another
NWDAF2. In this case, NWDAF2 needs to start collecting and providing UE
specific analytics for the UE, somehow taking over from NWDAF 1.
\- NWDAF1 gracefully shuts down, and another NWDAF must take over the existing
task / analytics generation performed by NWDAF1.
\- NWDAF1 gets overloaded and wants to offload some analytics to other
NWDAF(s).
NOTE: NWDAF instances may belong to an NWDAF Set as described in clause 5.21.3
of TS 23.501 [2]. In that case, a NF can be replaced by an alternative NF
within the same NF Set in the case of scenarios such as failure, load
balancing, load re-balancing, as the NF instances within the Set share the
same context data. The focus of this solution, however, is on scenarios where
a) NWDAF instances are not deployed as a Set, b) NWDAF instances do not belong
to the same Set (e.g. as they are serving different areas), or c) as it is
required to hand over from an NWDAF instance in one Set to another NWDAF
instance in another Set (e.g. after a failure of multiple NWDAF instances in a
Set, some of the load may need to be offloaded to another NWDAF Set).
To address these scenarios, a mechanism is proposed to allow one NWDAF to
transfer or handover its ongoing analytics to another NWDAF. The transfer or
handover can be done once the initial NWDAF can no longer progress the
analytics, e.g. for specific area(s) and/or specific UE(s). This is depicted
in procedure defined in clause 6.59.2.1. Alternatively, the transfer could be
prepared if the initial NWDAF anticipates that it will soon not be able to
continue the analytics tasks that it has been requested for, as per procedure
in clause 6.59.2.2.
### 6.59.2 Procedures
#### 6.59.2.1 Analytics handover procedure
Figure 6.59.2.1-1 depicts the procedure when an NWDAF hands over its analytics
to another NWDAF after it realizes that it can no longer cover the ongoing
analytics, e.g. due to graceful shutdown, or overload situation, or due to UE
mobility as exemplarily shown in the figure.
Figure 6.59.2.1-1: Analytics handover procedure for UE related analytics
1\. Consumer NF subscribes using Nnwdaf_AnalyticsSubscription_Subscribe
Request message to NWDAFx for certain analytics, e.g., UE mobility or UE
Communication, for a specific UE. NWDAFx responds to the request from Consumer
NF via Nnwdaf_AnalyticsSubscription_Subscribe Response.
2\. NWDAF subscribes to AMF using Namf_EventExposure_Subscribe Request message
for UE mobility event notifications.
3\. NWDAFx starts performing requested analytics and collecting required data.
This step may also already trigger some notifications to consumer NF (not
shown in the figure for simplicity) if, e.g., the subscription is for periodic
notification on UE location estimates.
4\. (optional) AMF notifies a UE mobility event to the subscribed NWDAF using
Namf_EventExposure_Notify.
5\. NWDAFx decides to handover some analytics to another NWDAF as it cannot
continue to provide the analytics service for those requested analytics.
Possible triggers could be graceful shutdown for NWDAFx, or overload situation
for NWDAFx, or the UE is moving to an area not covered by NWDAFx (as notified
in step 4).
NOTE 1: The NWDAFx can find out that the UE has moved to an area not covered
by NWDAFx by subscribing to Namf_EventExposure service. This is not shown in
the figure, but this can be done as soon as NWDAFx receives request in step 1,
e.g. as part of data collection phase for the analytics.
6\. The NWDAFx needs to discover via NRF the most suitable NWDAF that can
serve the Consumer NF request received in step 1. If the UE is moving to an
area not covered by NWDAFx the NWDAFx discovers the most appropriate NWDAF
based on the new location for the UE.
7\. NWDAFx subscribes, using Nnwdaf_AnalyticsSubscription_Subscribe Request,
to NWDAFy, and in order to inform NWDAFy that this subscription is specific
for a handover, NWDAFx includes a handover indication. NWDAFx also provides
initial subscription information from consumer NF as per step 1, as well as
\"analytics context identifier(s)\" to indicate to the NWDAFy the availability
of analytics context information for particular Analytic ID(s), i.e., possible
historical data that NWDAFx has for the analytics (e.g. events collected by
NWDAFx, time period for collection, NFs contacted for data collection...), and
possible analytics outputs information (e.g. last report provided to consumer
NF, latest analytics available with associated metadata such as confidence
level or number of inputs analysed). In the request message, NWDAFx also
provides a Callback URI to NWDAFy. NWDAFy confirms the request from NWDAFx via
Nnwdaf_AnalyticsSubscription_Subscribe Response.
NOTE 2: NWDAFy will allocate a new subscription Id, if necessary, following
the behaviour of AmfEventSubscription as specified in TS 29.518 [25] clause
6.2.6.2.2 and UEContextTransfer as specified in TS 29.518 [25] clause
5.2.2.2.1.1.
8\. Based on the \"analytics context identifier(s)\" and the callback URI
provided in step 7, the NWDAFy requests the analytics context from NWDAFx.
NWDAFx provides the requested analytics context information in the response
message.
NOTE 3: Alternatively, context transfer, such as sharing the historical data
for data collection, analytics metadata, etc. may be realized by specializing
the existing Network Function/NF Service Context Transfer (as described in TS
23.501 [2] clause 5.21.4 and further specified in TS 23.502 [3] clause 4.26)
for NWDAF.
9\. NWDAFy takes over the analytics generation based on information received
at step 5 from NWDAFx.
10\. NWDAFy will immediately send the new subscription Id (see NOTE 2) to the
notification endpoint for informing the subscription Id creation, along with
the notification correlation Id. The notification correlation information
allows the Consumer NF to correlate the notifications to the initial
subscription request made in step 1.
11\. NWDAFy at some point derives new Output Analytics based on new input
data.
12\. NWDAFy notifies the Consumer NF about the new analytics.
#### 6.59.2.2 Prepared analytics handover procedure
Figure 6.59.2.2-1 depicts the procedure when an NWDAF prepare for handing over
its analytics to another NWDAF.
Figure 6.59.2.2-1: Prepared analytics handover procedure for UE related
analytics
1\. Consumer NF subscribes using Nnwdaf_AnalyticsSubscription_Subscribe
Request message to NWDAFx for certain analytics, e.g., UE mobility or UE
Communication, for a specific UE. NWDAFx responds to the request from Consumer
NF via Nnwdaf_AnalyticsSubscription_Subscribe Response.
2\. NWDAFx starts performing requested analytics and collecting required data.
This step may also already trigger some notifications to consumer NF (not
shown in the figure for simplicity) if e.g. the subscription is for periodic
notification on UE location estimates.
3\. As part of ongoing analytics, NWDAFx estimates that the UE may enter an
area which is not covered by NWDAFx (e.g. by subscribing to AMF event exposure
service for UE mobility event notifications or to other NWDAF providing UE
mobility analytics).
4\. The NWDAFx needs to discover via NRF the NWDAFy and NWDAFz that cover the
potential new area which the UE may enter.
5-8. NWDAFx subscribes, using Nnwdaf_AnalyticsSubscription_Subscribe Request,
to NWDAFy and NWDAFz, and in order to inform NWDAFy and NWDAFz that this
subscription is specific for a prepared handover, NWDAFx includes a \"prepared
handover indication\". NWDAFx also provides initial subscription information
from consumer NF as per step 1, as well as \"analytics context identifier(s)\"
to NWDAFy and NWDAFz indicating the availability of Analytics context for
particular Analytic ID(s). NWDAFy and NWDAFz respond to the request from
NWDAFx via Nnwdaf_AnalyticsSubscription_Subscribe Response. NWDAFy and NWDAFz
then, based on the \"analytics context identifier(s)\" request the analytics
context available at the NWDAFx, i.e., possible historical data that NWDAFx
has for the analytics (e.g. events collected by NWDAFx, time period for
collection, NFs contacted for data collection, etc.), and possible analytics
outputs information (e.g. last report provided to consumer NF, latest
analytics available with associated metadata such as confidence level or
number of inputs analysed).
NOTE 1: Alternatively, context transfer, such as sharing the historical data
for data collection, analytics metadata, etc. may be realized by specializing
the existing Network Function/NF Service Context Transfer (as described in TS
23.501 [2] clause 5.21.4 and further specified in TS 23.502 [3] clause 4.26)
for NWDAF.
NOTE 2: NWDAFy will allocate a new subscription Id, if necessary, following
the behaviour of AmfEventSubscription as specified in TS 29.518 [25] clause
6.2.6.2.2 and UEContextTransfer as specified in TS 29.518 [25] clause
5.2.2.2.1.1.
NWDAFy and NWDAFz may start preparing data collection and analytics generation
phase based on information received from NWDAFx.
9\. NWDAFx gets confirmation that the UE has moved to an area not covered by
NWDAFx but covered by NWDAFy.
NOTE 3: The NWDAFx can find out that the UE has moved to an area not covered
by NWDAFx by subscribing to Namf_EventExposure service.
10-12. NWDAFx subscribes, using Nnwdaf_AnalyticsSubscription_Subscribe, to
NWDAFy, and in order to inform NWDAFy that this subscription is specific for a
handover, NWDAFx includes a handover indication. NWDAFx also provides
analytics context identifier(s) indicating the availability of \"delta\"
information between the context shared at step 5 and any additional
information / data collected or generated by NWDAFx between step 5 and step
10. NWDAFy takes over the analytics generation based on information received
from NWDAFx and requests the \"delta\" analytics context from NWDAFx
13\. NWDAFy informs the Consumer NF about the analytics handover (see also
NOTE 2).
14\. NWDAFx unsubscribes, using Nnwdaf_AnalyticsSubscription_UnSubscribe
Request, towards NWDAFz, with a \"handover cancel indication\". NWDAFz
responds to NWDAFx.
15-16. NWDAFy at some point derives new Output Analytics based on new input
data and notifies the Consumer NF about the new analytics. Notification
correlation information allows the Consumer NF to correlate the notifications
to the initial subscription request made in step 1.
### 6.59.3 Impacts on services, entities and interfaces
NWDAF to NWDAF communication:
\- NWDAF Nnwdaf_AnalyticsSubscription service is enhanced to allow one
\"source\" NWDAF to inform another \"target\" NWDAF about an analytics
handover, a prepared analytics handover or a cancelled analytics handover. The
service is further enhanced with an \"analytics context identifier(s)\"
parameter to allow the source NWDAF to inform the target NWDAF about the
availability of analytics context.
\- NWDAF Nnwdaf_AnalyticsInfo service is enhanced to allow NWDAFs to retrieve
historical data for data collection and analytics outputs together with
analytics metadata. Alternatively, existing Network Function/NF Service
Context Transfer, as described in TS 23.501 [2] clause 5.21.4 and further
specified in TS 23.502 [3] clause 4.26, can be specialized for NWDAF.
## 6.60 Solution #60: Distributed NWDAFs deployment and Aggregation Function
### 6.60.1 Introduction
This solution addresses KI #2: Multiple NWDAF instances.
In a multiple NWDAF deployment scenario, NWDAF instances are specialized to
provide Analytics for one or more Analytics IDs, and each of the NWDAF
instances serves a certain Area of Interest or TAI(s). Additionally, these
NWDAF instances may belong to an NWDAF Set. These distributed NWDAFs are
expected to work as in Release-16 with some additional enhancements to
registration and discovery procedures, data collection and analytics exposure,
as explained in below clauses.
There is a need to address cases where an NF Consumer may require Output
Analytics for an Area of Interest that is not covered by any single
distributed NWDAF instance and, thus, requires multiple NWDAFs that
collectively serve the requested Area of Interest for the particular Analytics
ID. To support such requests, it is proposed to introduce an NWDAF with
aggregation function. An NWDAF with aggregation function is also referred to
as \"Aggregator NWDAF\". This aggregation function, for each of the supported
Analytic IDs, aggregates per Analytics ID Data and/or Output Analytics coming
from multiple Data Sources, i.e., from one or more distributed NWDAFs and/or
from NFs.
NOTE: Aggregation of Output Analytics is done per Analytics ID, i.e. it is not
foreseen that Output Analytics of two different Analytic IDs will be
aggregated. However, it might be possible that an Analytics function is
defined that is using other Analytic IDs as input data, as possible in Rel-16
already.
\"Aggregation Function\" may require additional data, i.e., metadata along
with analytics output data provided by multiple NWDAFs in order to create a
single Output Analytics. This is in addition to regular NWDAF behaviour such
as collecting data from data sources to be able to generate its own output
analytics.
EXAMPLE 1: In order to derive the \"mobility performance\" (see clause 6.6.3
of TS 23.288 [5]) for the whole PLMN, the Aggregator NWDAF needs to calculate
the weighted average based on the mobility performance statistics provided by
the distributed NWDAFs. Therefore, in order to derive the ratio of successful
handovers in the whole PLMN, the number of handovers per area subset provided
by the distributed NWDAFs as \"metadata\" needs to be taken into account when
calculating the overall ratio.
EXAMPLE 2: To aggregate Analytics with different timestamps, i.e. Data for the
Analytics was collected over different time windows, it may be necessary to
know those time windows to be able to provide the aggregated Analytics
requested for a specific time window, as, for example, some of the available
input Analytics may not match the requested time window and therefore should
be excluded from the aggregation.
### 6.60.2 Functional Description
The solution proposes a deployment where multiple NWDAFs (also referred to as
\"Distributed NWDAF\" or \"Distr.NWDAF\") exist, whereby some of the NWDAFs
are enhanced with an \"aggregation functionality\" (also referred to a
\"Aggregator NWDAF\"). Figure 6.60.2-1 shows an example deployment.
Figure 6.60.2-1: Example of distributed NWDAFs deployment with Aggregator
NWDAFs
Distributed NWDAF:
\- Is a \"regular\" NWDAF with functionality as specified in TS 23.288 [5].
Additionally, some or all of the distributed NWDAF(s) may support providing
additional information referred to as \"aggregation analytics metadata\", that
is related to the generation of Output Analytics by the distributed NWDAF and
is needed by the Aggregation functionality of the Aggregator NWDAF to
aggregate the Output Analytics from different NWDAFs, e.g., in those cases
where it is not simply adding together output analytics received from multiple
NWDAF instances in order to generate a requested single Output Analytics. The
support to provide aggregation analytics metadata is indicated by an
\"analytics metadata provisioning capability\" parameter in the NF Profile in
the NRF.
\- Distributed NWDAF may belong to an NWDAF Set, with NF Set functionalities
as defined in Rel-16.
Aggregator NWDAF:
\- Is an NWDAF instance with additional capabilities to aggregate Output
Analytics provided by other Data Sources, e.g. other NWDAFs. This is in
addition to regular NWDAF behaviour such as collecting data from data sources
to be able to generate its own output analytics.
\- Aggregator NWDAF may belong to an NWDAF Set, with NF Set functionalities as
defined in Rel-16.
NOTE 1: The Aggregator NWDAF, like other NWDAFs, is also able to produce
Output Analytics based on Input Data from one or more Data Sources. That is,
in case no distributed NWDAF instance exists to cover a specific Analytics Id
for a specific Area of Interest, it may generate the corresponding Output
Analytics by itself.
\- Has \"aggregator functionality indication\" in its profile registered to
the NRF. This parameter indicates that it is a Aggregator NWDAF.
\- May includes \"aggregation analytics metadata request\" indication in the
Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe request
message sent to other NWDAFs requesting the other NWDAFs to additionally
provide aggregation analytics metadata related to the produced Output
Analytics, if required by Aggregator NWDAF for the aggregation of the Analytic
IDs in question.
NOTE 2: It is assumed that per Analytics ID at least one Aggregator NWDAF
exists which is covering the entire PLMN. This is to ensure that there is at
least one NWDAF in the PLMN that can provide the Output Analytics for a
particular Analytics ID for any requested Area of Interest.
\- Aggregator NWDAF may also support providing additional information referred
to as \"aggregation analytics metadata\" as the Aggregator NWDAF may also be
an Analytics provider to another Aggregator NWDAF.
NRF:
\- Stores the NF Profile of the NWDAF instances, including \"analytics
metadata provisioning capability\" parameter for distributed NWDAF and
\"aggregator functionality\" indication for Aggregator NWDAF.
\- Returns the NWDAF(s) matching attributes in the Nnrf_NFDiscovery_Request,
as in Release-16.
NOTE 3: According to the assumption that the Aggregator NWDAF covers the whole
PLMN, at least the Aggregator NWDAF will be returned in case no other NWDAF
matches the requested parameters.
Analytics Consumer:
\- Requests or subscribes to receive Analytics for one or more Analytic IDs in
a given Area of Interest, as per Release-16 specified behaviour.
### 6.60.3 Procedures
#### 6.60.3.1 NWDAF registration procedure
Figure 6.60.3.1-1 provides the procedure of NWDAF registration to the NRF.
Figure 6.60.3.1-1: NWDAF registration procedure
1\. NWDAF 1 is one of the distributed NWDAFs, and it registers its NF Profile
with NRF. This is similar to the existing procedure, e.g., as defined in TS
23.502 [3], but with an additional indication, if supported by this NWDAF
instance, indicating \"analytics metadata provisioning capability\". This
indicator is used by NWDAF Service Consumer, for example a Aggregator NWDAF,
to request Output Analytics, and if needed, aggregation analytics metadata by
including the indicator \"aggregation analytics metadata request\" in the
request message.
2\. NRF on receipt of the registration request in the above step 1, stores NF
Profile of this NWDAF instance.
3\. NRF confirms successful registration to NWDAF 2 with
Nnrf_NFManagement_NFRegister Response message.
4\. Aggregator Function, i.e., Aggregator NWDAF 1, registers with NRF and
sends Nnrf_NFManagement_NFRegister request to NRF. In the request the
Aggregator NWDAF 1 provides Supported Analytics ID(s), Service Area or TAI(s)
= PLMN and \"aggregator functionality indication\" (i.e., indication that it
additionally provides aggregation functionality).
5\. NRF stores the NF Profile for the Aggregator NWDAF 1, along with
\"aggregator functionality indication\", indicating that NWDAF C can be used
as \"aggregation function\" or \" Aggregator NWDAF\". NF Profile of Aggregator
NWDAF 1 also indicates corresponding \"Set_ID\" in case this Aggregator NWDAF
belongs to a Set.
6\. NRF confirms successful registration to Aggregator NWDAF 1.
7\. NWDAF 2 is one of the distributed NWDAFs, and it registers its NF Profile
with NRF. This is similar to the existing procedure, e.g., as defined in TS
23.502, but with an additional indication, if supported by this NWDAF
instance, indicating \"analytics metadata provisioning capability\". This
indicator is used by NWDAF Service Consumer, for example a Aggregator NWDAF,
to request Output Analytics, and if needed, aggregation analytics metadata by
including indicator \"aggregation analytics metadata request\" in the request
message.
8\. NRF on receipt of the registration request in the above step 7, stores
NFProfile of this NWDAF instance. If indicated by this NWDAF instance, NRF
also stores \"analytics metadata provisioning capability\" in the NFProfile
for this NWDAF instance.
9\. NRF replies to NWDAF 2 with Nnrf_NFManagement_NFRegister Response message.
#### 6.60.3.2 NWDAF discovery procedure
Figure 6.60.3.2-1 provides the procedure of an NF Consumer discovering a NWDAF
with NRF, whereby the procedure is based on the example shown in figure
6.60.2-1.
Figure 6.60.3.2-1: NWDAF discovery procedure
1-3. NF Consumer 1 is interested in Analytics ID 1 over Area of Interest
TAI-1, and so it sends a Nnrf_NFDiscovery_Request to NRF. As usual NRF
behaviour, NRF returns one or more matching NF Profile(s) in the corresponding
response. This is following existing NRF procedure as defined in TS 23.502
[3]. In this example, NRF returns profile for NWDAF 1 and profile for
Aggregator NWDAF 1.
NOTE 1: If the NF consumer receives both a Aggregator NWDAF and a distributed
NWDAF, NF Consumer may select either option. However, NF Consumer can be
configured such that preference is given to a distributed NWDAF, if returned
from NRF, over a Aggregator NWDAF during the NWDAF selection or vice versa,
based on the \"aggregator functionality indication\". This configuration is an
optimization, e.g., to reduce the load on the Aggregator NWDAFs. NF consumers
without such configuration may use other means to select one of the NWDAFs
returned in the NRF discovery response.
4-6. NF Consumer 2 is interested in Analytics ID 3 over Area of Interest
TAI-2, and so it sends a Nnrf_NFDiscovery_Request to NRF. After having
authorized the request, NRF then, in this example, returns the NF Profile of
distributed NWDAF 2 in the corresponding response. This is also following
existing NRF procedure as defined in TS 23.502 [3].
7-9. NF Consumer 3 is interested in Analytics ID 1 and areas of interest as
TAI-1, TAI-2, TAI-n. On receiving this request, as usual NRF behaviour, NRF in
this example finds out there is no single distributed NWDAF serving the
requested areas of interest, and so it responds back with Aggregator NWDAF 1
profile, which is configured as \"aggregator functionality indication\" for
the requested Analytic ID.
NOTE 2: Aggregator functionality indication is included in the NF Profile of
the Aggregator NWDAF.
#### 6.60.3.3 Procedure for analytics exposure
Figure 6.60.3.3-1 provides the procedure of NF consumer / Analytics Consumer
request and/or subscription to get the Analytics ID of its interest.
Figure 6.60.3.3-1: Procedure to support Network Data Analytics
1\. This is the discovery procedure, whereby the example is based on the
procedure shown in figure 6.60.3.2-1. In this example, NRF will return the
Aggregator NWDAF 1 profile as there is no single distributed NWDAF that can
cover the request.
2\. NWDAF Service Consumer sends Analytics information request to Aggregator
NWDAF 1. In the request, NWDAF Service Consumer provides the requested
Analytics ID(s), e.g. UE mobility analytics with Analytics ID 1, along with
the requested area of interest, e.g., TAI-1, TAI-2, TAI-n.
3\. On receiving the request in step 2, Aggregator NWDAF 1, based on previous
queries to NRF or configuration, and based on the request from NWDAF service
consumer (e.g. analytics filter information) knows which other NWDAF instances
to request related Output Analytics. Alternatively, Aggregator NWDAF 1 sends
discovery request(s) to NRF and in response gets from NRF, following usual NRF
behaviour, a list of distributed NWDAF(s) that can provide Output Analytics
needed to generate the requested Analytics ID for the requested area TAI-1,
TAI-2, TAI-n.
NOTE: In the discovery request sent to NRF, Aggregator NWDAF may indicate
\"analytics metadata provisioning capability\" (e.g. as query parameter),
thus, requesting to NRF to reply back with, if available, those NWDAF
instance(s) which also supports \"analytics metadata provisioning capability\"
functionality as indicated during particular NWDAF instance registration
procedure.
4-5. Aggregator NWDAF sends Analytics information request or Analytics
subscription request to each of the Data Sources discovered/determined in step
3, i.e., to NWDAF 1 and NWDAF 2 in the example in Figure 6.60.3.3-1. This
request may indicate \"aggregation-metadata request\" to the Data Source(s)
(i.e. to NWDAF 1 and NWDAF 2), e.g. when the NWDAF 1 and/or NWDAF 2 support
providing such analytics metadata, indicating that the Output Analytics
provided by these NWDAFs needs to be aggregated by the Aggregator NWDAF and so
the \"aggregation analytics metadata\" is also requested, along with usual
analytics output data.
6-7. Distributed NWDAFs reply or notify with the requested Output Analytics
along with \"aggregation analytics metadata\" information required for the
aggregation.
8\. Aggregator NWDAF aggregates received Analytics information, i.e.,
generates a single Output Analytics based on the multiple Analytics outputs
and aggregation analytics metadata information received from NWDAF 1 and NWDAF
2. In this example, the Aggregator NWDAF also takes its own analytics for
TAI-n into account for the aggregation.
9\. Aggregator NWDAF replies to NWDAF Service Consumer the Output Analytics
for the requested analytics ID.
### 6.60.4 Impacts on services, entities and interfaces
NWDAF:
\- Introduction of a NWDAF providing the capability to aggregate Output
Analytics (referred to as \"Aggregator NWDAF\").
\- Enhancement to distributed NWDAFs to provide \"aggregation analytics
metadata\" related to the Output Analytics. This may be supported by only a
subset of the distributed NWDAFs, since \"aggregation analytics metadata\" may
not be always required for aggregating output analytics.
\- Enhancement to NWDAFs to request \"aggregation analytics metadata\" by
providing \"aggregation analytics metadata request\" indication in the request
message.
NRF:
\- NFProfile for Aggregator NWDAF is extended to indicate \"aggregator
functionality indication\", such that a NWDAF service consumer can be
configured to give preference to a distributed NWDAF, if returned from NRF,
over a Aggregator NWDAF or vice versa.
NOTE: This configuration at the NWDAF service consumer is an optimization,
e.g., to reduce the load on the Aggregator NWDAFs. NF consumers without such
configuration may use other means to select one of the NWDAFs returned in the
NRF discovery response.
\- NFProfile for NWDAFs is extended to indicate \"analytics metadata
provisioning capability\" for those NWDAFs which support such additional
functionality.
## 6.61 Solution#61: Improvement of User Data Congestion Analytics
### 6.61.1 Descriptions
This solution is for Key Issue#7: Adding Application attributes and KPIs as
the Input data in some services described in TS 23.288 [5].
KPIs to add in the Input data:
The following KPIs are added as input data: Per UE per Application ID, Bytes
UL/DL, Bytes Peak UL/DL. Also, it is essential to include the Application IDs
that are present in the whole Cell.
These KPIs will allow the ML models to point out the top ten Application IDs
that are influencing most of the degradation in a cell.
### 6.61.2 Input data improvement
The following new information is added to TS 23.288 [5] Table 6.8.2-1: Data
collection for \"User Data Congestion\" analytics.
Table 6.61.2-1: New input data for \"User Data Congestion\" analytics
* * *
Information Source Description Application IDs UPF Per UE, timeslot, per 5QI
and per UPF Bytes UL/DL UPF Per Application ID Bytes UL/DL Peak UPF Per
Application ID
* * *
NOTE: How the information in table above is collected will not be defined in
Rel-17.
### 6.61.3 Output analytics improvement
It is performed two main change in the Output analytics. The purpose of this
change is include in the Output of statistics and prediction a list of top ten
Application IDs that are contributing the most in the UPF traffic
(throughput). This information serves as criteria for the service consumer NFs
in how to act in case of receiving non-desirable outcomes.
The following new information is added to TS 23.288 [5] Table 6.8.3-1: \"User
Data Congestion\" statistics.
Table 6.61.3-1: New output analytics for \"User Data Congestion\" statistics
* * *
Information Description Top ten Application IDs A list of top ten Application
IDs that are contributing the most in the traffic (throughput).
* * *
The following new information is added to TS 23.288 [5] Table 6.8.3-2: \"User
Data Congestion\" predictions.
Table 6.61.2-1: New output analytics for \"User Data Congestion\" predictions
* * *
Information Description Top ten Application IDs A list of top ten Application
IDs that are contributing the most in the traffic (throughput).
* * *
### 6.61.4 Procedures improvement
They are performed changes in the clause 6.9.4, TS 23.288 [5], Procedures
Figure 6.9.4-1 and steps descriptions. The purpose of this change is to
include the part where the NWDAF receives Data available at the UPF. It is
also added the following note:
_NOTE: How NWDAF receives data available at UPFs is not defined in the present
document._
The following new step is added to TS 23.288 [5] Figure 6.9.4-1 and respective
description.
Figure 6.61.4-1: \"User Data Congestion\" analytics provided by NWDAF
1\. The consumer requests or subscribes to analytics information on \"User
Data Congestion\" provided by NWDAF. The parameters included in the request
are described in TS 23.288 [5].
The consumer may include multiple sets of parameters in order to provide
different combinations of \"Location information\" and \"Analytics target
period\" when requesting analytics for monitoring for a path of interest.
2\. NWDAF receives Data available at the UPF.
3\. The NWDAF collects the data specified in clause 6.9.2, TS 23.288 [5] from
the OAM, following the procedure captured in clause 6.2.3.2, TS 23.288 [5].
4\. The NWDAF verifies whether the triggering conditions are met and derives
the requested analytics.
5\. The NWDAF provides response or notification on \"User Data Congestion\" to
the consumer.
NOTE: How NWDAF receives data available at UPFs is not defined in the present
document.
### 6.61.4a User Data Congestion Mitigation
Procedure for User Data Congestion defined in solution#30 is extended to
provide the list of top N applications that are contributing the most in the
traffic, causing peaks of throughput in the location and time when congestion
was reported.
### 6.61.5 Nnwdaf Services Description
The following new information is added to TS 23.288 [5].
_Table 7.1-2: Analytics information provided by NWDAF_
* * *
_Analytics Information_ _Request Description_ _Response Description_ _User
Data Congestion_ _Analytics ID: User Data Congestion_ _For statistics, the
information on the location and the time for the top ten Application IDs that
are contributing the most in the traffic; or, for predictions, the information
on the location and the time when the top ten Application IDs that are
contributing the most in the traffic._
* * *
### 6.61.6 Impacts on services, Existing Nodes and Functionality
UPF:
\- At least one UPF in the path of each PDU session shall have available the
following KPIs.
* * *
Information Source Description Application IDs UPF Packet Detection
information as defined per PDR in the UPF, see TS 23.501 [2]. Average
throughput UL/DL UPF Per Application ID as detected in the PDR for reporting
period provided in the subscription by NWDAF. Corresponds to the number of
bytes counted per Application-ID during each timeslot; UL/DL corresponds to
the counted bytes that are transmitted/received by the UPF toward/from the
subscriber per Application. This measurement is the average through. Peak
throughput DL/UL UPF Per Application ID as detected in the PDR for reporting
period provided in the subscription by NWDAF. the estimation of the byte
counting be in case that the speed of the data stream will stay constant at
max speed during the time slot of measurement at the reporting period.
* * *
The UPF gets a request of KPIs for all applications bound to a list of UE IP
address(s) and the reporting period.
NOTE 1: How the information in table above is reported by the UPF to NWDAF
will not be defined in Rel-17.
NWDAF:
\- To support additional data in the input data as defined in 6.61.6:
\- To support additional data in the output data as follows:
\- Statistics.
* * *
Information Description Top ten Application IDs A list of top ten Application
IDs that are contributing the most in the traffic (throughput).
* * *
\- Predictions.
* * *
Information Description Top ten Application IDs A list of top ten Application
IDs that are contributing the most in the traffic (throughput).
* * *
NOTE 2: The granularity of the top ten Application IDs for statistics and
predictions is per Location information (an area or a path of interest) as
specified at the moment to request the service.
AF:
\- The AF acting as service consumer of this Analytics ID in Rel -16 will need
to add capacity to receive in the Outcome of this Analytics ID the top ten
Application IDs.
### 6.61.7 Improvement of Observed Service Experience Analytics
In Rel-16, this analytics ID focuses only on Application IDs served by AFs
that could interact with the NEF and NWDAF. As a reference in a typical 4G
network in 2020, Application IDs served by AF are less than 5% of the total
Application-IDs present in the traffic.
This contribution aims that the observed Service experience includes
Application IDs that are present in the traffic mix and are not necessarily
linked to the AFs, also improving statistics reporting.
The NWDAF may provide Observed Service Experience no matter if the local AF
serves the applications or the applications are part of the internet traffic
or are a mix of them; for one or both of the following:
\- Service Experience for a Network Slice: Service Experience for UEs (for a
UE or a group of or any UE) for a given Application or a set of Applications
or any Application that is present in the traffic mix (i.e. all Applications)
in a Network Slice.
\- Service Experience for an Application: Service Experience (i.e. for a UE or
a group of UEs or any UE) in an Application that is present in the traffic.
Once the Application-IDs present in internet traffic are included as a
possible targeted Application-IDs the statistics reporting is implicitly
improved, now the reporting is not limited to Application-ID served by those
AFs that can provide the service data information to the NWDAF.
#### 6.61.7.1 Analytics Filter Information improvement
The improvement performs one change in the Analytics Filter Information part
of the Observed Service Experience related network data Analytics ID. It adds
a new parameter TOPN (1... max). This change allows the service consumer to
target the top N applications that are experiencing the poorest service
experience. In this case of the TOPN parameter is specified, the service
consumer shall not include in the analytics filter information or in the NWDAF
when collecting input data the Application-IDs.
The following new information is now part of the TS 23.288 [5] Table 6.4.1-1:
Analytics Filter Information related to the observed service experience.
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | TOPN (1... max) | Top N applications that are | | | experiencing the poorest service | | | experience; that are present in | | | the internet traffic. | +----------------------------------+----------------------------------+ | NOTE 1: If no TOPN is provided, | | | the Analytics Filter information | | | applies only to the provided | | | Application ID in the Network | | | Slice. | | | | | | NOTE 2: When TOPN is provided, a | | | known service consumer that | | | leverage the corresponding | | | output is the PCF. | | | | | | NOTE 3: When TOPN is provided, | | | it applies for the (list of) | | | SUPI(s) described in Table | | | 6.4.2-2. | | +----------------------------------+----------------------------------+
#### 6.61.7.2 Input data improvement
The improvement performs one change in the input data part of the Observed
Service Experience related network data Analytics ID. This change allows the
NWDAF to receive Data information related to service experience available at
the UPF.
The following new information is added to TS 23.288 [5] Table 6.4.2-1: Service
Data from AF related to the observed service experience.
NOTE: How the information in table below is collected will not be defined in
Rel-17.
Table 6.61.7.2-1:
* * *
Information Source Description Application IDs UPF Packet Detection
information as defined per PDR in the UPF, see TS 23.501 [2]. Average Round
Trip Time UL/DL UPF Per Application ID as detected by the PDR. Only UPF to UE.
for reporting period provided in the subscription by NWDAF. Average Packets
Lost UL/DL UPF Per Application ID as detected PDR for reporting period
provided in the subscription by NWDAF. Average throughput UL/DL UPF Per
Application ID as detected in the PDR for reporting period provided in the
subscription by NWDAF. Corresponds to the number of bytes counted per
Application-ID during each timeslot; UL/DL corresponds to the counted bytes
that are transmitted/received by the UPF toward/from the subscriber per
Application. This measurement is the average throughput measured during the
time slot. Peak throughput DL/UL UPF Per Application ID as detected in the PDR
for reporting period provided in the subscription by NWDAF. The estimation of
the byte counting be in case that the speed of the data stream will stay
constant at max speed during the time slot of measurement at the reporting
period.
* * *
#### 6.61.7.3 Procedures improvement
They are performed changes in the clause 6.4.4 Procedures Figure 6.4.4-1 and
steps descriptions. The purpose of this change is to include the part where
the NWDAF receives Data available at the UPF. It is also added the follow
note:
NOTE 1: How NWDAF receives data available at UPFs is not defined in the
present document.
The Figures 6.61.7.3-1, 6.61.7.3-2, 6.61.7.3-3 and respective description is
added to TS 23.288 [5]
Figure 6.61.7.3-1: Procedure for NWDAF providing Service Experience for an
Application
The follow steps descriptions suffer changes:
2b. NWDAF receives Data available at the UPF. Application ID & info related
service experience and KPIs see Table 6.4.1-1, in TS 23.288 [5].
2c. NWDAF subscribes the network data from 5GC NF(s) in the Table 6.4.2-2 in
TS 23.288 [5] by invoking Nnf_EventExposure_Subscribe service operation.
2d. With these data, the NWDAF estimates the Service experience for the
application.
NOTE 2: QoE measurements from the applications are based on outcome of the
ongoing SA WG5 Rel-16 WID \"Management of QoE measurement collection\" which
addresses how to collect the QoE measurements from the applications in the UE.
NOTE 3: How NWDAF receives data available at UPFs is not defined in the
present document.
The following new step is added to TS 23.288 [5] Figure 6.4.5-1 and respective
description.
Figure 6.61.7.3-2: Procedure for NWDAF providing Service Experience for a UE
or a group of UEs in a Network Slice
Figure 6.61.7.3-3: Procedure for NWDAF providing Service Experience for a UE
or a group of UEs in a Network Slice using TOPN information via Analytics
filter
This procedure is similar to the procedure in clause 6.4.5, with the following
differences.
1\. The consumer request TOPN information via Analytics Filter. To receive the
TOPN applications together with the analytics outputs as described in clause
6.61.7.1.
3e. The NWDAF receives Application IDs and respective KPIs available at UPF
see table 6.4.1-1, 6.4.2-2, application service experiences is estimated by
NWDAF per Application ID to rank and report the TOPN Application-IDs having in
account the Application IDs served by AFs.
5\. NWDAF includes in the statistic/prediction outcome, the TOPN Applications
ID experiencing the poorest service experience
5.a. PCF to set up a trigger report and control the QoS of flows of background
traffic Application as described in TS 23.503 [4] clause 4.3.5.
The following takes place when any SMF Notify to the PCF the Start detection
of an application based on subscription in step 5.a
6\. SMF notify Start of application based on subscription in step 5.a.
7\. Policy decision. PCF deploy SM policies to the SMF managing QoS based on
step 6 to assure the QoE for UEs that their SLA is predicted will be
compromised, or is being compromised due to one or more of reported TOPN
Application-IDs.
The following takes place when NWDAF Notify to the PCF with positive Outcome
based on subscription in step 1.
8\. Nnwdaf_AnalyticsSubscription_Notify (estimated Service Experience
including TOPN Applications ID experiencing the poorest service experience).
Based on subscription in step 1. With Positive outcome prediction QoE will
become compliant with SLA.
9\. PCF Remove PCC Rule to detect and report Application start/stop of
background traffic.
NOTE: All the SM PCFs present in the slice should initiate this procedure to
manage the full PLM coverage.
#### 6.61.7.4 Impacts on services, Existing Nodes and Functionality
UPF:
\- At least one UPF in the path of each PDU session shall have available the
following KPIs.
Table 6.61.7.4-1
* * *
Information Source Description Application IDs UPF Packet Detection
information as defined per PDR in the UPF, see TS 23.501 [2]. Average Round
Trip Time UL/DL UPF Per Application ID as detected by the PDR. Only UPF to UE.
for reporting period provided in the subscription by NWDAF. Average Packets
Lost UL/DL UPF Per Application ID as detected PDR for reporting period
provided in the subscription by NWDAF. Average throughput UL/DL UPF Per
Application ID as detected in the PDR for reporting period provided in the
subscription by NWDAF. Corresponds to the number of bytes counted per
Application-ID during each timeslot; UL/DL corresponds to the counted bytes
that are transmitted/received by the UPF toward/from the subscriber per
Application. This measurement is the average throughput measured during the
time slot. Peak throughput DL/UL UPF Per Application ID as detected in the PDR
for reporting period provided in the subscription by NWDAF. The estimation of
the byte counting be in case that the speed of the data stream will stay
constant at max speed during the time slot of measurement at the reporting
period.
* * *
NOTE: How the information in table above is collected will not be defined in
Rel-17.
NWDAF:
\- To support additional Analytics Filter Information. The output for
Analytics on OSE is enhanced to provide the TOP N application for a UE or for
a Group of UEs or for all UEs. How the output is extended is FFS:
* * *
Information Description TOPN (1... max) Top N applications that are
experiencing the poorest service experience
* * *
NFs (e.g. PCF):
\- Those NF using in Rel-16 the Observed Service Experience Analytics, may
need (but is not mandatory) to add additional Analytics Filter Information
added to the target for Analytics.
* * *
Information Description TOPN (1... max) Top N applications that are
experiencing the poorest service experience;
* * *
#### 6.61.7.5 Nnwdaf Services Description
The following new information is added to TS 23.288 [5] Table 7.1-2: Analytics
information provided by NWDA.
Table 6.61.7.1: Analytics information provided by NWDAF
* * *
Analytics Information Request Description Response Description Observed
Service experience information Analytics ID: Service Experience Observed
Service experience statistics or predictions may be provided for a Network
Slice or an Application. They may be derived from an individual UE, a group of
UEs or any UE. For slice service experience, they may be derived from an
Application, a set of Applications or top N applications that are experiencing
the poorest service experience; that are present in the internet traffic, all
Applications on the Network Slice.
* * *
## 6.62 Solution #62: Analytics for WLAN performance and WLANSP using UE Data
### 6.62.1 Description
This solution is for Key Issue #8 \"UE data as an input for analytics
generation\".
The WLAN Selection Policy (WLANSP) is a set of operator-defined rules that
determine how the UE selects and reselects a WLAN access network as defined in
clause 6.6.1 of TS 23.503 [4]. According to the WLANSP rule, the UE selects
the most prioritized available WLAN and connects to it. The priority of each
WLAN is determined by a group of selection criteria in a WLANSP rule and the
WLAN selection procedure is defined in clause 5.3.2.3 of TS 24.502 [21].
The problem of current WLANSP-based WLAN selection is that UE\'s experience is
not reflected to the generation of WLANSP. The PCF cannot know which of rules
and groups of selection criteria was met by the selected WLAN, and the
performance of the selected WLAN is not considered either. Thus, WLAN that has
the highest priority according to the WLANSP may not guarantee the best
performance for the UE.
To address this problem, this solution proposes a new analytics for WLAN
performance and WLANSP using UE data. This solution collects data from the UE
about which of several WLANSP rules and groups of selection criteria is
directly involved in the WLAN selection. It also collects data that can
measure the quality and performance of the WLAN connection from other 5GC NFs.
NWDAF reveals the correlation between WLANSP that UE applied when selecting
the WLAN and the resulting WLAN performance. The main goal of this solution is
to enable WLANSP to be updated by reflecting the analytics results. It is
expected that this analytics results could be used to adjust the WLANSP in a
direction to provide a better WLAN performance for the UE.
The service consumer may be an NF (e.g. PCF).
If a service consumer is PCF, the WLAN performance and WLANSP analytics can be
used to update WLANSP.
The consumer of these analytics may indicate in the request or subscription:
\- Analytics ID set to \"WLAN performance and WLANSP\".
\- Target of Analytics Reporting: a UE, a group of UEs, or any UE.
\- Analytics Filter Information containing:
\- Area of Interest (list of TA or Cells).
\- SSID(s).
\- BSSID(s).
\- An Analytics target period indicates the time period over which the
statistics or prediction are requested, either in the past or in the future.
If the Target of Analytics Reporting is any UE, then the Analytics Filter
should at least include Area of Interest or SSID(s) or BSSID(s).
### 6.62.2 Input Data
For the purpose of WLAN Usage Experience analytics, the NWDAF collects the
data as listed in Table 6.62.2-1.
Table 6.62.2-1: Data collected by NWDAF for WLAN performance and WLANSP
analytics
* * *
Information Source Description UE Data  
UE ID UE SUPI Applied WLANSP rule UE An WLANSP rule that is applied while
connecting to WLAN with an indication that which selection criteria is met by
selected WLAN Discovered available WLAN(s) UE Available WLAN list discovered
as described in clause 5.3.2.3 of TS 24.502 [21]. WLAN Data  
SSID OAM SSID of the selected WLAN during the period of analysis RSSI OAM
Measured RSSI of the selected WLAN during the period of analysis. RTT OAM
Measured RTT of the selected WLAN during the period of interest UE Location
OAM Location information tagged by UE when it reports WLAN MDT measurement
(e.g. Cell ID and/or longitude/latitude if available) Information on WLAN
based PDU Session (1..max) SMF  
> Start time of WLAN based PDU Session The time stamp that indicates when the
> existing PDU Session\'s access type changes to WLAN or when the new WLAN
> based PDU Session is established > End time of WLAN based PDU Session The
> time stamp that indicates when the existing WLAN based PDU Session\'s access
> type is not WLAN any more or when the WLAN based PDU Session is released
> Communication start UPF The time stamp that WLAN based PDU session(s) starts
> Communication stop UPF The time stamp that WLAN based PDU session(s) ends UL
> data rate UPF UL data rate of WLAN based PDU session(s) DL data rate UPF DL
> data rate of WLAN based PDU session(s) Traffic volume UPF Traffic volume of
> WLAN based PDU session(s)
* * *
NOTE 1: WLAN Data from OAM is collected via MDT and aligned with the WLAN
measurement reporting list described in clause 5.1.1.3.3 of TS 37.320 [22]. It
is assumed that not all UEs support MDT WLAN measurements. The PLMNs
supporting WLAN analytics must allow MDT measurements.
NOTE 2: It is assumed that how NWDAF collects the data from UPF is not
defined.
NOTE 3: UE Location from OAM can be used to deduce WLAN location.
NOTE 4: \"WLAN based PDU Session\" in this solution means its Access Type is
Non-3GPP and RAT Type is WLAN.
The UE collects and provides WLANSP related data as listed in Table 6.62.2-1.
The UE generates and reports the data when specific events occurs. Data
collection configuration provided by PCF indicates list of data that needs to
be collected and the events when to report the collected data (e.g. WLAN
disconnection, change from one WLAN/SSID to other WLAN/SSID) to the UE. It
also contains address information of UE data storage.
### 6.62.3 Output Analytics
The NWDAF generates WLAN performance and WLANSP analytics. Depending on the
Analytics Target Period, the output consists of statistics or predictions. The
detailed information provided by the NWDAF is defined in Table 6.62.3-1 for
statistics and Table 6.62.3-2 for predictions.
Table 6.62.3-1: WLAN performance and WLANSP statistics
* * *
Information Description Area of Interest A list of TAIs or Cell Ids List of
WLANSP rule Collected WLANSP rules with an indication that which selection
criteria is met by selected WLAN > SSID SSID that is selected by UE according
to the WLANSP rule and selection criteria List of Analytics per SSID SSIDs of
WLAN access points deployed in the Area of Interest Time slot entry (1...max)
List of time slots during the Analytics target period > Time slot start Time
slot start time within the Analytics target period > Duration Duration of the
time slot > RSSI Measured RSSI > RTT Measured RTT > Traffic Information UL/DL
data rate, Traffic volume > Number of UEs Number of UEs observed for the SSID
* * *
Table 6.62.3-2: WLAN performance and WLANSP predictions
* * *
Information Description Area of Interest A list of TAIs or Cell Ids List of
WLANSP rule Collected WLANSP rules with an indication that which selection
criteria is met by selected WLAN > SSID SSID that is predicted to be selected
by UE according to the WLANSP rule and selection criteria List of Analytics
per SSID SSIDs of WLAN access points deployed in the Area of Interest Time
slot entry (1...max) List of time slots during the Analytics target period >
Time slot start Time slot start time within the Analytics target period >
Duration Duration of the time slot > RSSI Predicted RSSI > RTT Predicted RTT >
Traffic Information Predicted UL/DL data rate, Traffic volume > Number of UEs
Number of UEs predicted for the SSID > Confidence Confidence of the prediction
* * *
### 6.62.4 Procedures
#### 6.62.4.1 UE Data Collection procedure
Figure 6.62.4.1-1: UE Data Collection procedure
0\. If UE supports UE data collection, it includes the indication of UE
support for UE data collection in the UE Policy Container during the
registration procedure.
1\. The PCF provides UE access selection related policy information in UE
policy container, which includes WLANSP rules and data collection
configuration. The UE policy container is transferred to the UE through the
PCF and the AMF, as described in clause 4.2.4.3 of TS 23.502 [3].
If the UE provide the indication of UE support for UE data collection, the PCF
provides the data collection configuration along with the WLANSP. The data
collection configuration instructs UE which data to collect, when and where to
report (i.e. address of NF in charge of storing collected UE data) the
collected data. List of UE data that needs to be collected is listed in clause
6.62.2.
To support the data collection configuration in the UE policy container, a new
UE policy type (e.g. UE data collection policy) needs to be defined.
After the first provision, if the configuration changes, the PCF can provide
the updated data collection configuration.
3\. According to a selected WLANSP rule, the UE selects an available WLAN and
connects to it. Then the UE begins collecting WLAN usage data following the
received data collection configuration.
4\. The UE reports the collected data to the UE data storage.
UE data storage in this procedure can be an existing NF (e.g. UDR, NWDAF
acting as UE Data Storage Function).
Editor\'s note: How to collect and where to store the UE data is FFS and
subject of other Solutions for this KI (KI#8). Which NF will store UE data is
subject to the conclusion of this KI.
UE Data Collection in step 4 is triggered by events described in the data
collection configuration (e.g. WLAN disconnection, change from one WLAN/SSID
to other WLAN/SSID). In case of the WLAN disconnection, the collected data is
sent over 3GPP access.
#### 6.62.4.2 Analytics for WLAN performance and WLANSP
Figure 6.62.4.2-1: Analytics for WLAN performance and WLANSP
1\. The consumer NF sends a request to the NWDAF (Analytics ID = WLAN
performance and WLANSP, Target of Analytics Reporting = (SUPI, any UE),
Analytics Filter information = (Area of Interest, SSID(s), BSSID(s))) for
analytics information on WLAN performance and WLANSP, using either the
Nwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service.
The parameters included in the request are described in clause 6.62.1.
As an analytics consumer, the PCF may request WLANSP performance and WLANSP
analytics to check how WLANSP it provided was working. The analytics can be
requested with the filter information (e.g. Area of Interest or specific
SSID(s)). When Area of Interest is provided, the analytics results include
WLAN performance information of all SSID(s) located in the Area of Interest.
When specific SSID(s) is provided, the analytics results include WLAN
performance information of a specific UE or all UE(s) connected to the
corresponding SSID(s).
2\. If the request is authorized, the NWDAF retrieves UE data from the UE data
storage. The UE data used in the analytics is listed in clause 6.62.2
UE data storage in this procedure can be an existing NF (e.g. UDR, NWDAF
acting as UE Data Storage Function).
Editor\'s note: How to retrieve UE data is FFS and subject of other Solutions
for this KI (KI#8). Which NF will store UE data is subject to the conclusion
of this KI.
3\. The NWDAF collects WLAN measurement data for the period of analysis from
the OAM, following the procedure captured in TS 23.288 [5], clause 6.2.3.2.
4\. The NWDAF derives requested analytics with the collected data. Analytics
output parameters are listed in clause 6.62.3.
5\. The NWDAF provides the requested analytics to the NF, using either the
Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service, depending on the
service used at step 1.
If the consumer NF is the PCF, then it can use the analytics results to modify
the WLANSP to improve WLAN performance. It may adjust selection criteria
attributes (e.g. MaximumBSSLoad, MinimumBackhaulThreshold) or, location and
time validity conditions.
6\. If the NF subscribed the analytics at step 1, the NWDAF provides a new
analytics when it generated the new output.
### 6.62.5 Impacts on services, entities and interfaces
UE:
\- Receives the data collection configuration from the PCF.
\- Collects and reports the data on WLANSP rules to the UE data storage
according to the collection configuration.
NWDAF:
\- Retrieves WLAN measurement data for the period of analysis from the OAM,
and UE data on WLANSP rules from the UE data storage
\- Supports new Analytics ID \"WLAN performance and WLANSP \".
PCF:
\- Provides the data collection configuration to UE along with WLANSP.
\- Defines a new UE policy type.
\- Subscribes to the WLAN performance and WLANSP analytics from the NWDAF
\- Updates WLANSP based on the analytics results.
UPF:
\- Provides data related to WLAN communication.
## 6.63 Solution #63: UE data as an input for service experience analytics
### 6.63.1 Description
This solution is proposed to address KI#8: UE data as an input for analytics
generation.
The solution focuses on addressing the questions of:
\"- What type of information from the UE could be collected by the network
(e.g. NWDAF) as input for analytics generation?\"
\"- What types of analytics information could be provided by NWDAF to other
NFs to leverage the data provided by the UE?\"
It is proposed that enriched observed service experience predictions are
provided by the NWDAF based on input data collected from the UEs involved in
an application. The collected UE input data includes the QoS and the
individual contribution (score/weight) of each UE to the overall application
service experience. The input of these additional UE data to the NWDAF enables
service experience predictions to be made with a higher level of confidence.
No changes are proposed to the types of data output by the NWDAF as service
experience predictions.
On receiving a request for service experience analytics from a consumer NF
(e.g. OAM, PCF) for a target UE(s), the NWDAF gets from the AF the list of UEs
involved in the application with the target UE(s), e.g. the rendering devices,
joystick involved in the online gaming. For each UE involved in the
application, the NWDAF gets input data of individual service experience
contribution (score/weight) and their respective QoS metrics. If the AF and/or
MDT does not have the requested parameters, the AF may ask UEs to collect that
data, before processing and forwarding to the NWDAF.
### 6.63.2 Input Data
The UE input data is collected only for the case of observed service
experience analytics predictions (i.e. target period in the future).
Table 6.63.2-1: UE input data
+------------------------+-----------------+------------------------+ | Information | Source | Description | +------------------------+-----------------+------------------------+ | Application ID | NEF/AF | Identifying the | | | | application providing | | | | this information | +------------------------+-----------------+------------------------+ | List of UE IDs (1...n) | AF | List of UE IDs | | | | involved in the same | | | | application | +------------------------+-----------------+------------------------+ | >QoS | UE (via AF/MDT) | QoS metric(s) from UE | | | | | | | (NOTE 1) | | +------------------------+-----------------+------------------------+ | >Service experience | UE (via AF) | Individual | | contribution | | score/weight of a | | | | UE\'s contribution to | | | | global service | | | | experience | +------------------------+-----------------+------------------------+ | NOTE 1: UE input data | | | | collection for a | | | | specific UE (via MDT) | | | | can be done as in | | | | 6.2.3.1, | | | | TS 23.288 [5]. | | | +------------------------+-----------------+------------------------+
Editor\'s note: The method of data collection from UEs is covered in other
solutions to this KI (KI#8).
### 6.63.3 Output Analytics
The proposed solution is only applicable for observed service experience
analytics predictions. It has no impact on requests for observed service
experience statistics (i.e. target periods in the past).
Output analytics for predictions are according to Table 6.4.3-2 of TS 23.288
[5].
### 6.63.4 Procedures
Figure 6.63.4-1: Procedure to collect UE data for service experience analytics
1\. The Consumer NF sends a request to the NWDAF for service experience
analytics for a target UE. The Analytics ID is set to \"Service Experience\"
with Analytics Filter information set to define the Application ID and with
the Analytics target period set to a time in the future.
2\. NWDAF retrieves from the AF the list of UEs that are related to the target
UE for the same application and contribute to the service experience and
follows the UE Input Data Collection Procedure and collects the UE input data
accordingly.
3\. NWDAF processes the collected input data
4\. NWDAF provides to the Consumer NF predicted service experience analytics
for the application.
5-7. If, at step 1, the Consumer NF has subscribed to receive continuous
reporting of service experience analytics, the NWDAF may generate new
analytics and provide them to the Consumer NF upon reception of notification
of new UE input data.
Editor\'s note: The method of UE Input Data Collection in Step 2 or UE Input
Data notification in Step 5 is FFS and subject of other Solutions to this KI
(KI#8).
### 6.63.5 Impacts on services, entities and interfaces
AF:
\- Requires methods and procedures for AF to collect data from UEs.
NWDAF:
\- Needs to be able to provide service experience predictions for an
application involving multiple UEs based on QoS data and service experience
contribution data of those UEs.
## 6.64 Solution #64: MNO owned Data Collection AF for UE data collection
### 6.64.1 Description
This solution is proposed to address KI#8: UE data as an input for analytics
generation.
This solution introduces a Data Collection AF (DC-AF). UE data is transmitted
via user-plane to ASP server and then the ASP Server sends the data to the DC-
AF.
#### 6.64.1.1 General
As the figure shown below, as a possible way, the M1d/M2d interface defined in
SA WG6 TS 26.501 [27] can be enhanced to realize that the ASP server sending
UE data to ASP server. For example, a new API can be introduced in M1d/M2d
which is used for ASP server provides UE data to DC-AF for UE data collection.
The ASP client and ASP server belongs to OTT application layer. The
communication link between ASP client and ASP server is established over user-
plane using existing PDU session.
NOTE 1: The communication between ASP client and ASP server is out of 3GPP
scope.
The DC-AF (Data Collection AF) is introduced to collect the UE data from ASP
server. Then it can expose the UE data to NWDAF consumer using Nnf. In SA WG2
point of view, the ASP Server and DC-AF seen as AF.
NOTE 2: SA WG2 point of view DC-AF and ASP seen as AF and decomposition of AF
is out of scope of SA WG2.
NOTE 3: This solution can apply to both direct and indirect UE data reporting
when DC-AF is in untrusted domain. In SA2 perspective, both have the same
impact to 5GC.
Figure 6.64.1.1-1
#### 6.64.1.2 DC-AF collects UE data from ASP server
Figure 6.64.1.2-1: DC-AF collects UE data from ASP server
1\. UE ASP Client provides UE data via user-plane application layer, which is
out of 3GPP scope. After the connectivity is established, ASP Server can
interact with UE ASP Client to get UE data via application layer.
2\. ASP Server will initialize the establishment of HTTP connection to DC-AF.
During the establishment, the ASP Server can provide External Application Id,
External UE id (opt.)/UE IP address.
NOTE 1: how ASP server establish the connection to DC-AF needs to be defined
by SA4.
NOTE 2: The connection establishment and specific functionality is out of
scope of SA WG2.
#### 6.64.1.3 Registration and Discovery of DC-AF
In order to discover the DC-AF, DC-AF needs to register to NRF via NEF and
NWDAF can use Discovery request to find the required DC-AF.
Figure 6.64.1.3-1: Registration and Discovery of DC-AF
Step 1-2: After the registration of AF available data at the NEF, NEF
generates an event exposure with new EventID to be associated with available
data to be collected from DC-AF. NEF invokes
Nnrf_NFManagement_NFUpdate_request service operation to update its
registration information (i.e., NEF Profile) including the generated Event
IDs, and associated AF identification, Application ID(s), Analytics ID(s).
The Analytics ID is used to process the UE raw data, and sends the processed
data to NWDAF.
Step 3-4: The NWDAF invokes the Nnrf_NFDiscovery Request service operation to
discover the NEF(s) interfacing with the AF(s) that contain the available data
using as parameter the NEF NF Type, a list of Event ID(s), and optionally AF
identification, application ID, Analytics ID.
#### 6.64.1.4 DC-AF provides UE data to NWDAF consumer
Figure 6.64.1.4-1: NWDAF consumer get UE data from DC-AF
0\. DC-AF may have already collected UE data from ASP server as described in
clause 6.64.1.2.
1\. A consumer NF sends subscription request.
2\. To collect UE data for analytics requested by consumer NF, the NWDAF
invokes service operation for discovery of DC-AF as described in steps 3-4 in
Figure 6.64.1.3.
3\. NWDAF invokes Nnef_EventExposure_Subscribe, including Event Id, Event
Filter, internal UE ID(s), internal Application ID(s), and Analytics ID.
Application ID(s) indicates which Application\'s data is needed. The Analytics
ID is optionally used to indicate how the raw data is processed.
> 4\. In case that external UE id is not used, NEF performs step.4 as
> described in Figure 6.64.1.4-2. This is for NEF to discover UE IP address to
> a SUPI. Otherwise (i.e. external UE id is used), this step can be skipped.
>
> 5\. In case external UE id is used, NEF maps the internal UE ID(s) into
> external UE ID(s) and maps internal Application ID(s) into external
> Application ID(s), and invokes Naf_EventExposure_Subscribe, including
> external UE ID(s), Event Id, Event Filter, external Application ID(s), and
> Analytics Filter.
In case that external UE id is not used and step-4 has been performed, NEF
invokes Nas_EventExposure_Subscribe including UE IP address, Event Id, Event
Filter, external Application ID(s), and Analytics Filter.
6\. DC-AF determines which UE\'s data is needed based on the UE IP address or
external UE id provided by NEF. If the requested UE data is not locally
available, DC-AF may collect UE data upon receiving the request from NWDAF
consumer via ASP server using the connection already established as described
in clause 6.64.1.2. The DC-AF uses the application ID(s), UE IP address,
and/or external UE ID(s) to discover the ASP server for data request. The
protocol in step 4 will be defined in SA WG4 e.g. extending M1d, M2d.
To get UE data, ASP Server needs to interact with UEs in application layer,
which is out of 3GPP scope.
NOTE: Communication between ASP and DC-AF is out of scope of SA WG2 and it is
up to respective WGs to evaluate such an operation required if so how the
communication takes place with required information.
The raw UE data may be pre-processed at DC-AF per analytics/event filter.
7-9. DC-AF responds to NWDAF the requested UE data. And NWDAF can use the UE
data for analytics requested by consumer NF.
Figure 6.64.1.4-2: NEF discovers UE IP address to a SUPI
1-2. NEF invokes Nudm_SDM_Subscribe service operation to get serving SMF(s) of
a SUPI.
3-4. The NEF sends Nsmf_EventExposure_Subscribe to each SMF in the list of SMF
serving the SUPI, with SUPI and the Event Id = UE IP address / Prefix
allocation/change. And SMF(s) respond to DC-AF with the UE IP address for the
SUPI.
5\. NEF stores the mapping between SUPI and UE IP address.
#### 6.64.1.5 Security consideration
The ASP Client and ASP server are transmitting data via user-plane. HTTPS can
be used to protect data encryption and integrity.
For privacy consideration, the ASP can process the raw UE data before sending
the data to DC-AF and DC-AF can further process the data before sending to
NWDAF. Some examples of processing is as follows:
\- Gathering a bunch of UE\'s data and average the UE data;
\- Remove the User identifier;
\- Add noise to each single UE data.
NOTE: All the behaviour for security aspect mentioned in this clause is
implementation specific and out of 3GPP scope.
### 6.64.2 Impacts on services, entities and interfaces
UE:
\- Sends the raw data to ASP Server (out of 3GPP scope).
NWDAF:
\- Discover of AF based on optionally Analytics ID.
NEF: correlate and translate internal and external Application IDs, internal
and external UE identifiers. Store the mapping between the internal UE id and
UE IP address
NRF and AF:
\- AF registers with an optionally Analytics ID.
## 6.65 Solution #65: Triggers for data collection from the UEs
### 6.65.1 Introduction
This solution addresses aspects of Key Issue #8 \"UE data as an input for
analytics generation\" and key issue #13 \"Triggering conditions for
analytics\", specifically on how and when the NWDAF can determine that data
collection from the UEs can be triggered. This is particularly useful when
data collection is needed for analytics in a specific area or slice, for
analytics for a group of UEs, or for any UE.
### 6.65.2 Functional Description
This solution is based on the following principles:
\- During registration, the UEs indicate to the network whether they support
data collection for analytics and which type of data can be provided to the
network for the purpose of analytics (e.g. mobility data). The capability
information is stored in the AMF and can also be stored in the UDM/UDR. The UE
may also indicate the level of abstraction supported for each type of data,
e.g. whether it is raw data, or pre-processed data, such as statistics. The UE
indication may change over time, e.g. under some conditions the UE may decide
that providing data to the network may not be feasible any longer, e.g. when
there are no sufficient data to provide, or too low battery level in the UE to
provide assistance data to the network.
NOTE: The solution does not list all different types of data that can be
collected from the UE by the NWDAF. The list can be finalized based on the
conclusion for Key Issue #8 on which type of information from the UE could be
collected by the NWDAF.
\- The NWDAF can contact the AMFs to know how many UEs can provide support for
data collection for analytics. This is done via the AMF exposing an event
\"number of UEs supporting data for analytics\", which can be used by NWDAF to
retrieve the number of UE in e.g. a given area (list of TAIs) or a slice.
\- NWDAF can decide to start or stop data collection from UEs based on the
ratio of UEs supporting data for analytics in e.g. a given area (list of TAIs)
or a slice.
NOTE: Solution is not applicable to application level mechanisms to collect
data as defined by solutions #27, #29 or #64. NWDAF can still check the number
of UEs in specific areas or specific slices before triggering data collection
at application level for these specific areas or specific slices, but this can
be achieved already in Rel-16 without additional standardization changes.
### 6.65.3 Procedures
Figure 6.65.3-1 depicts the procedure for NWDAF triggering collection of data
from UEs based on the level of support of data collection by the UEs in the
area served by two AMFs.
Figure 6.65.3-1: NWDAF triggering data collection from UEs
0\. The UEs, while registering or updating their registration, inform the AMF
about their support for data collection for analytics. The information
provided by the UEs may contain the type of information that the UEs can
provide to the NWDAF, e.g. mobility data. The UEs may also have different
level of abstraction available for the data, e.g. data that the UE can provide
may be raw data, or it could be pre-processed data, such as statistics. The
AMFs store the information in the UE context. The AMF may also store the
information in the UDM/UDR for further checking by other NFs.
NOTE 1: The AMF can store the information in the UDM, which would allow the
NWDAF to retrieve this capability for a specific UE, if needed.
1\. The NWDAF subscribes to the AMF-A1 to retrieve the number of UEs in the
area served by AMF-A1 which support providing data for analytics. The event id
used is \"number of UEs supporting data for analytics\". The NWDAF may specify
the type of data it is interested to collect, or the level of abstraction. The
NWDAF may specify a specific area (e.g. list of TAIs), or a slice. The NWDAF
may request to be e.g. periodically notified about the number of UEs, or it
may request to be notified when the number of UEs reaches a certain threshold,
possibly compared to the total number of UEs in the area.
NOTE 2: An alternative to a new event ID can be to use existing event ID such
as \"Number of UEs served by the AMF and located in Area Of Interest\" with
new filters.
NOTE 3: The NWDAF can, instead of subscribing to the information on a per area
basis, subscribe on a per slice basis to retrieve the number of UEs served by
the AMF and currently registered in a specific slice.
2\. The NWDAF subscribes to the AMF-A2 to retrieve the number of UEs in the
area served by AMF-A2 which support providing data for analytics.
3-4. The NWDAF receives notifications from AMF-A1 and from AMF-A2. The
notifications contain the number or the ratio of UEs supporting data
collection for analytics. The notifications also contain the list of UEs
supporting such functionality.
5\. Based on the received notifications at steps 3 and 4, and based on local
configuration, the NWDAF may decide to start data collection from UEs
available in area under AMF-A1.
6-7. The NWDAF receives a new notification from AMF-A2, indicating that the
number of UEs supporting data collection for analytics has increased. NWDAF
may decide to start collecting data from UEs in area under AMF-A2 in addition
to the UEs in area under AMF-A1.
8-9. The NWDAF receives a new notification from AMF-A1, indicating that the
number of UEs supporting data collection for analytics has decreased. NWDAF
may decide to stop collecting data from UEs in area under AMF-A1.
NOTE 4: The procedure to start or stop data collection from UEs is not
described in this solution. It is assumed that solutions proposing data
collection mechanisms can be used for steps 5, 7 and 9.
### 6.65.4 Impacts on services, entities and interfaces
The following impacts are identified:
UE:
\- Indicates its support for providing data for analytics, together with the
type of data and the level of abstraction, during initial registration and
registration updates.
NOTE 1: The type of data (e.g. mobility data), the level of abstraction (e.g.
raw data, statistics) would need to be standardized to allow all UEs to report
using similar criteria.
NOTE 2: The solution does not list all different types of data that can be
collected from the UE. The list can be finalized based on the conclusion for
Key Issue #8 on the aspect of which type of information from the UE could be
collected by the NWDAF.
AMF:
\- New event ID \"number of UEs supporting data for analytics\" for
Namf_EventExposure service, which can be used with specific filters such as
area of interest, or slice.
NWDAF:
\- Use of new event ID \"number of UEs supporting data for analytics\" for
Namf_EventExposure service, which can be used with specific filters such as
area of interest, or slice, and which can be used with thresholds which, when
crossed or reached, will trigger notifications to the NWDAF. NWDAF then uses
these notifications to decide when to trigger data collection from UEs.
## 6.66 Solution #66: Including Dispersion data in the Expected UE Behaviour
### 6.66.1 Description
#### 6.66.1.1 Overview
This is a solution for Key Issue #9, Dispersion analytic output provided by
NWDAF.
Solution #30 introduces a new Analytics ID for computing the Dispersion
analytics and providing statistics or predictions of dispersion data for a UE
or group of UEs. According to solution #30 \"Dispersion analytics
characterizes the interaction of a user, or a group of users, with the network
and identifies at what locations (i.e. area of interest, TAs, cell) users
dispersed most (if not all) their data volume, sessions transactions (i.e. MM
and SM messages), transaction failures, dropped sessions and voice call
minutes. Same concept applies to dispersion at a given network slice; at which
slice users dispersed most (if not all) their data, session transactions,
transaction failures, dropped sessions and voice call minutes\".
In many cases NWDAF will require some time to calculate the Dispersion
analytics for a UE or group of UEs, since the dispersion data is based on
observations of the user\'s behaviour during a period of time. Therefore, the
Dispersion analytics may not be immediately available to the consumer NF. By
the time at which the NWDAF is confident on the computed Dispersion analytics,
it may be late for the consumer NF taking a preventing action.
An AF may be a consumer of Dispersion analytics from NWDAF. When the AF have
obtained the Dispersion analytics from NWDAF, it may have enough behavioural
information for determining the typical dispersion data for this UE. The AF
may provision the Dispersion data as part of the Expected UE behaviour in UDM
by following the procedures specified in TS 23.502 [3] clause 4.15.6.2. The
Dispersion data included in the Expected UE behaviour may be offered to the
AMF as part of the Access and Mobility Subscription Data or the SMF as part of
the Session Management Subscription data.
By doing this, when AMF or SMF retrieve the subscription data for a UE from
UDM, they receive the Dispersion data as part of the AMF/SMF-Associated
Expected Behaviour parameters, respectively. This enables AMF and SMF taking
decisions based on the typical Dispersion data of the UE as soon as they are
becoming serving the UE.
Editor\'s note: How the AMF use the retrieved dispersion data for AM and SM
procedure.
Editor\'s note: What type(s) of dispersion data can be stored as subscription
data.
Editor\'s note: How to ensure the retrieved dispersion data is up-to-date as
subscription data, e.g. when the AF requests dispersion data from the NWDAF
and thus stores it as subscription data.
### 6.66.2 Impacts on Existing Nodes and Functionality
\- AF: Including the output of Dispersion analytics in the
Nnef_ParameterProvision service
\- NEF: Receiving output of Dispersion analytics in the
Nnef_ParameterProvision service and adding them to the Nudm_ParameterProvision
service.
\- UDM: Receiving output of Dispersion analytics in the
Nnef_ParameterProvision service. Adding it to the AMF-Associated Expected
Behaviour parameters (which is included in the Access and Mobility
Subscription Data) and to the SMF-Associated Expected Behaviour parameters
(which is included in the Session Management Subscription Data). Storing such
data in UDR.
\- AMF: Receiving the output of Dispersion analytics in the AMF-Associated
Expected Behaviour parameters of the Nudm_SubscriberDataManagement service.
\- SMF: Receiving the output of Dispersion analytics in the SMF-Associated
Expected Behaviour parameters of the Nudm_SubscriberDataManagement service.
## 6.67 Solution #67: User plane session inactivity timer optimization
This solution addresses key issue #10: NWDAF Assisted UP Optimization.
### 6.67.1 Description
This solution describes the utilization of NWDAF analytics to optimize user
plane performance by enhancing the selection of user plane connection
inactivity timer associated to each PDU Session. Figure 6.67.1-1 shows the
overall solution consisting of data sources, NWDAF, analytics consumer, and
UPF. The internal NWDAF architecture shown follows general principles, but the
decision on NWDAF decomposition is made in KI#1.
Figure 6.67.1-1 illustrates the input data sources required for NWDAF to
provide analytics related to the inactivity timer value. In order to respect
the Rel-16 framework already agreed and frozen in 3GPP, the proposed design
may only require supported 5GC entities (i.e. SMF, UPF and AMF), AFs, and OAM
to provide input data. However, other entities could provide required input
data to NWDAF currently not supported in the standard, namely NG-RAN (in
addition to OAM) and the UE (in addition to AMF). The required input data can
be mapped to TS 23.288 [5] in the context of UE communication data (including
start and end time stamps, uplink and downlink data rates, traffic volume,
etc.), cell load measured in number of activated PDU sessions, and UE
information.
With respect to the output analytics provided by NWDAF, the design also
complies with the Rel-16 NWDAF framework by proposing the generation of data
analytics in the form of statistics and predictions for the session inactivity
timer that can be directly fed to the SMF. The data analytics delivered by
NWDAF are then used by SMF to i) activate or deactivate PDU sessions when
needed, and ii) update the inactivity timer value using the NWDAF outputs and
inform UPF of such update. Both actions can be easily performed by SMF by
following the standardized procedures for PDU session activation and
deactivation, as well as user plane management, defined in TS 23.502 [3].
Figure 6.67.1-1: Solution sketch for user plane session inactivity timer
optimization
#### 6.67.1.1 General
To enable the proposed user plane connection optimization based on PDU session
timer, the following existing NWDAF analytics as defined in TS 23.288 [5] are
required, but they need to be extended to support this solution. Hence, we
propose an extension to the current definitions, as described below.
#### 6.67.1.2 Input data
UE Communication analytics
Input data for UE Communication analytics are defined in Table 6.7.3.2-1 of TS
23.288 [5].
Additional new input data to Table 6.7.3.2-1 of TS 23.288 [5] is required for
this solution, as shown in Table 6.67.1.2-1. All input data shown below can be
collected as part of the UE communication service data (i.e. per application)
or as independent entries per PDU session.
Table 6.67.1.2-1: New input data for UE Communication analytics
* * *
Additional input data Source Description (>) PDU Session ID (1...max) SMF
Identification of PDU Session > N4 Session ID SMF, UPF Identification of N4
Session > Inactivity detection time SMF, UPF Value of session inactivity timer
> PDU Session status SMF Status of the PDU Session (activated, deactivated) UE
CM state AMF UE connection management state (e.g. CM-IDLE)
* * *
NOTE 1: 5GC may not be aware of UE\'s RRC state, which is decided by NG-RAN
and may also influence the UE CM state.
NOTE 2: SMF collects N4 Session Level data from SMF independently of NWDAF
input data requests to SMF, as described in clause 6.67.1.4.
#### 6.67.1.3 Output analytics
UE Communication analytics
To enable the optimization of the inactivity timer associated to the user
plane connection, UE Communication output analytics defined in Tables
6.7.3.3-1 and 6.7.3.3-2 of TS 23.288 [5] could be expanded with Table
6.67.1.3-1.
Table 6.67.1.3-1: New output analytics for UE Communication
* * *
Additional Information Description N4 Session ID (1...max) Identification of
N4 Session > Inactivity detection time Value of session inactivity timer
(average, variance)
* * *
#### 6.67.1.4 Procedures
Figure 6.67.1.4-1: Procedure for NWDAF-assisted session inactivity timer
optimization
Figure 6.67.1.4-1 shows the procedure supporting NWDAF-based user plane
optimization. The steps are detailed as follows:
1\. A PDU Session gets established. A corresponding user plane connection
needs to be activated for data transmission. During the course of the
procedure the user plane connection may get deactivated if the inactivity
timer expires, and activated if new data traffic is available.
2\. SMF subscribes to UE communication analytics from NWDAF.
Input data collection: Two alternatives are possible for data collection
related to N4 Session. Alternative 1 uses SMF and its corresponding service
exposure framework to retrieve the required input data while Alternative 2
relies on implementation-specific mechanisms for UPF input data retrieval.
Alternative 1 [ALL MESSAGES OPTIONAL]: SMF based N4 session data collection
3a. NWDAF requests N4 Session related input data to SMF as defined in Table
6.67.1.2-1. It may also request other UE communication data with SMF as source
NF, as specified in TS 23.288 [5] and Table 6.67.1.2-1.
3b. SMF requests a N4 Session Level report from UPF independently of the NWDAF
request, i.e. step 3b is not triggered by step 3a but rather it had been
previously set up.
3c. UPF provides the requested N4 Session Level report to SMF according to
clause 4.4.2.2 in TS 23.502 [3].
3d. SMF provides the requested N4 Session related input data to NWDAF.
Alternative 2: UPF based N4 session data collection
4\. [OPTIONAL] NWDAF collects N4 Session related input data directly from UPF
via implementation-specific mechanisms.
5\. NWDAF collects the remaining input data required to produce the requested
analytics according to TS 23.288 [5].
6\. NWDAF may provide UE Communication analytics to SMF as defined in TS
23.288 [5] and Table 6.67.1.3-1.
8\. While SMF continues its task of activating and deactivating PDU Sessions,
SMF also processes the received analytics provided by NWDAF.
9\. Based on its analysis of NWDAF analytics, SMF may decide to update the
user plane inactivity timer of certain PDU Session(s) associated to
corresponding N4 Session(s).
10\. SMF triggers a N4 Session modification procedure according to clause
4.4.1.3 in TS 23.502 [3] to inform UPF of the inactivity timer update..
### 6.67.2 Impacts on Existing Nodes and Functionality
NWDAF:
\- Enhancements to provide extended UE Communication analytics.
SMF:
\- Enhancements to allow SMF to subscribe to UE Communication analytics and
internally use the analytics to select PDU session inactivity timer.
\- Support of event exposure to provide requested data from NWDAF for extended
UE Communication analytics.
AMF:
\- Support of event exposure to provide requested data (e.g. UE CM state) from
NWDAF for extended UE Communication analytics.
## 6.68 Solution #68: NWDAF assistance to support UP optimization
### 6.68.1 Description
The solution addresses Key Issue #10: NWDAF Assisted UP Optimization.
It supports the efficient UP resource usage, especially for URLLC service,
with Redundant Transmission Experience related analytics.
As described in clause 5.33.2.2 of TS 23.501 [2], the SMF decided that
redundant transmission shall be performed based on authorized 5QI, NG-RAN node
capability and/or operator configuration, the SMF informs the PSA UPF and NG-
RAN to perform redundant transmission via N4 interface and N2 information
accordingly.
This solution provides Redundant Transmission Experience related analytics
from NWDAF to SMF, and it may have an effect on operator\'s policy configured
in SMF to support efficiently redundant transmission for URLLC service, i.e.
to determine redundant transmission shall be performed, or (if it has been
activated) shall be stopped.
NWDAF supporting Redundant Transmission Experience related analytics shall be
able to
\- collect UE mobility related information from NFs (e.g. AMF, AF) and OAM;
\- collect the same performance measurement from OAM as for the Analytics ID
user data congestion;
\- collect packet drop and/or packet delay measurement from NFs (e.g. UPF)
and/or OAM;
\- collect efficiency information on redundant transmission from NFs (e.g.
UPF) and OAM;
\- collect the information related to PDU Session established with redundant
transmission from NF (e.g. SMF) and OAM;
\- perform data analytics to provide Redundant Transmission Experience
statistics or predictions.
The service consumer may be a NF (e.g. SMF).
The consumer of these analytics may indicate in the request:
\- Analytics ID = \"Redundant Transmission Experience \".
\- The Target of Analytics Reporting can be a single UE, any UE, or a group of
UEs.
\- Analytics Filter Information optionally containing:
\- Area of Interest;
\- S-NSSAI;
\- DNN.
\- An Analytics target period indicates the time period over which the
statistics or predictions are requested.
### 6.68.2 Input Data
The NWDAF supporting data analytics on Redundant Transmission Experience shall
be able to collect UE mobility information from OAM, 5GC and AFs, and service
data from AF, as described in clause 6.7.2.2 of TS 23.288 [5]. In addition, it
shall be able to collect the information for PDU session which is established
with redundant transmission from NF and OAM. UE mobility information is
already specified in TS 23.288 [5] Table 6.7.2.2.-1 and service data from AF
related to UE mobility in TS 23.288 [5] Table 6.7.2.2-2. Performance
measurement on user data congestion is already specified in TS 23.288 [5]
Table 6.8.2-1.
Additionally, this solution collects the following input according to existing
measurements defined in clause 5.33.3 QoS Monitoring to Assist URLLC Service
of TS 23.501 [2].
Table 6.68.2-1: packet drop and/or packet delay measurement per QFI or GTP
level
+--------------------------+--------------+--------------------------+ | Information | Source | Description | +--------------------------+--------------+--------------------------+ | UL/DL packet drop GTP | OAM (NOTE 3) | UL/DL packet drop rate | | | | measurement on GTP path | | | | on N3 | +--------------------------+--------------+--------------------------+ | UL/DL packet delay GTP | UPF (NOTE 2) | End-to-End measurements | | | | from UE to UPF | +--------------------------+--------------+--------------------------+ | UL/DL packet delay GTP | OAM (NOTE 3) | UL/DL packet delay | | | | measurement round trip | | | | on GTP path on N3 | +--------------------------+--------------+--------------------------+ | NOTE 1: The information | | | | of Table 6.68.2-1 is | | | | provided both as the | | | | base to compare with the | | | | redundant transmission | | | | performance as well as | | | | when redundant | | | | transmission is enabled. | | | | | | | | NOTE 2: As | | | | TS 23.288 [5], how | | | | NWDAF collects the | | | | information from UPF is | | | | not defined in this | | | | solution. | | | | | | | | NOTE 3: Refer clause 5.1 | | | | of TS 28.552 [19] for | | | | the performance | | | | measurement in NG-RAN | | | | and clause 5.4 1 of | | | | TS 28.552 [19] for the | | | | performance measurement | | | | in UPF. In addition, | | | | Annex A of | | | | TS 28.552 [19] | | | | describes various | | | | performance | | | | measurements, | | | | especially, Annex A.61 | | | | \"Monitoring of one way | | | | delay between PSA UPF | | | | and NG-RAN\" indicates | | | | that the measurements on | | | | the one way DL and UL | | | | delay between PSA UPF | | | | and NG-RAN can be used | | | | to evaluate and optimize | | | | the DL and UL user plane | | | | delay performance | | | | between 5GC and NG-RAN. | | | | Whether the mentioned | | | | RAN measurements are | | | | needed or even available | | | | per UE will be looked | | | | into in normative phase. | | | | | | | | NOTE 4: The NWDAF | | | | actions will not | | | | activate the | | | | measurements for QoS | | | | Monitoring. When QoS | | | | Monitoring is activated | | | | the measurements are | | | | triggered according to | | | | existing procedures. | | | | When QoS Monitoring is | | | | not activated SMF may | | | | per configuration | | | | activate measurements | | | | for QoS Monitoring at | | | | least at the same time | | | | as it requests | | | | Analytics. | | | +--------------------------+--------------+--------------------------+
Table 6.68.2-2: the information related to PDU Session established with
redundant transmission
* * *
Information Source Description DNN SMF Data Network Name associated for URLLC
service UP with redundant transmission SMF Redundant transmission setup
* * *
### 6.68.3 Output Analytics
The NWDAF supporting data analytics on Redundant Transmission Experience shall
be able to provide Redundant Transmission Experience analytics, to consumer NF
(e.g. SMF).
Table 6.68.3-1: Redundant Transmission Experience statistics
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | UE group ID or UE ID, any UE | Identifies a UE, any UE, or a | | | group of UEs | +----------------------------------+----------------------------------+ | DNN | Data Network Name associated for | | | URLLC service | +----------------------------------+----------------------------------+ | Spatial validity | Area where the Redundant | | | Transmission Experience applies. | | | | | | If Area of Interest information | | | was provided in the request or | | | subscription, spatial validity | | | should be the requested Area of | | | Interest. | +----------------------------------+----------------------------------+ | Time slot entry (1..max) | List of time slots during the | | | Analytics target period | +----------------------------------+----------------------------------+ | > Time slot start | Time slot start within the | | | Analytics target period | +----------------------------------+----------------------------------+ | > Duration | Duration of the time slot | | | (average and variance) | +----------------------------------+----------------------------------+ | >Redundant Transmission | Redundant Transmission | | Experience | Experience value | +----------------------------------+----------------------------------+ | >> Ratio | Percentage on which UE, any UE, | | | or UE group efficiently use the | | | PDU session with redundant | | | transmission. | +----------------------------------+----------------------------------+
Table 6.68.3-2: Redundant Transmission Experience predictions
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | UE group ID or UE ID, any UE | Identifies an UE or, any UE, a | | | group of UEs | +----------------------------------+----------------------------------+ | DNN | Data Network Name associated for | | | URLLC service | +----------------------------------+----------------------------------+ | Spatial validity | Area where the estimated | | | Redundant Transmission | | | Experience applies. | | | | | | If Area of Interest information | | | was provided in the request or | | | subscription, spatial validity | | | should be the requested Area of | | | Interest. | +----------------------------------+----------------------------------+ | Time slot entry (1..max) | List of predicted time slots | +----------------------------------+----------------------------------+ | >Time slot start | Time slot start time within the | | | Analytics target period | +----------------------------------+----------------------------------+ | > Duration | Duration of the time slot | +----------------------------------+----------------------------------+ | > Redundant Transmission | Predicted Redundant Transmission | | Experience | Experience value during the | | | Analytics target period | +----------------------------------+----------------------------------+ | >> Ratio | Percentage on which the UE, any | | | UE, or UE group may efficiently | | | use the PDU session with | | | redundant transmission. | +----------------------------------+----------------------------------+ | >> Confidence | Confidence of this prediction | +----------------------------------+----------------------------------+
### 6.68.4 Procedures
#### 6.68.4.1 Analytics Procedure
Figure 6.68.4.1-1 shows the analytics procedure. The NWDAF can provide
analytics, in the form of statistics or predictions or both, to another NF.
Figure 6.68.4.1-1: \"Redundant Transmission Experience\" analytics provided to
an NF
1\. The NF sends a request to the NWDAF for analytics on a specific UE, any
UE, or a group of UEs, using either the Nnwdaf_AnalyticsInfo or
Nnwdaf_AnalyticsSubscription service. The NF can request statistics or
predictions or both. The type of analytics is set to Redundant Transmission
Experience. The NF provides the UE id or Internal Group ID in the Target of
Analytics Reporting. Analytics Filter Information optionally contains DNN,
S-NSSAI, Area of Interest, etc.
2\. If the request is authorized, and in order to provide the requested
analytics, the NWDAF may subscribe to events with all the serving AMFs for
notification of location changes, and may subscribe to events with SMFs
serving PDU Session on URLLC service for notification of redundant
transmission related information.
The NWDAF subscribes the service data from AF(s) by invoking
Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via
NEF).
The NWDAF collects UE mobility information, packet measurement information
and/or redundant transmission related information from OAM, following the
procedure captured in clause 6.2.3.2 of TS 23.288 [5].
NOTE: The NWDAF determines the AMF serving the UE, any UE, or the group of UEs
as described in clause 6.2.2.1 of TS 23.288 [5].
This step may be skipped when e.g. the NWDAF already has the requested
analytics available.
3\. The NWDAF derives requested analytics.
4\. The NWDAF provide requested UE Presence Pattern analytics to the NF, using
either the Nnwdaf_AnalyticsInfo_Request response or
Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.
5-7. If at step 1, the NF has subscribed to receive notifications for
Redundant Transmission Experience analytics, after receiving event
notification from the AMFs, AFs and OAM subscribed by NWDAF in step 2, the
NWDAF may generate new analytics and provide them to the NF.
If a service consumer is SMF, the Redundant Transmission Experience analytics
can be used to make decision if that redundant transmission shall be performed
or (if activated) shall be stopped regarding the PDU session for URLLC
service.
### 6.68.5 Impacts on services, entities and interfaces
SMF:
\- get information from NWDAF to make decision how to support efficiently
redundant transmission for URLLC service, i.e.
(1) to determine redundant transmission shall be performed.
(2) to determine redundant transmission shall be stopped if has been
activated.
NWDAF:
\- perform Redundant Transmission Experience statics and predictions.
\- Consume UL/DL packet drops and packet delay
\- Consume UL/DL packet drop and successful packet transmission on redundant
transmission
## 6.69 Solution #69: NWDAF associated to the User-plane
### 6.69.1 General
This solution address efficiency for data collection Key Issue #11 focused on
user plane analytics, and is part of the solutions for not only key Issue #2
but also Key Issue #1.
The TS 23.288 [5] in clauses 4.1 and 5.1 states that \"some of the NWDAF can
be specialized in providing certain types of analytics.\"
It is stated in the study item objectives that it shall not be studied how to
retrieve data from UPF.
#### 6.69.1.1 Principles of the Solution
The principles of the solution are:
This solution proposes to associate one NWDAF instance with one UPF or a
cluster of UPFs that are attending at least one DNN. Associated in the sense
that the NWDAF is assigned to specific UPF(s) and the interface between UPF
and NWDAF is not specified but the data from UPF is assumed to be available by
non-specified means.
This solution address scenarios of low latency, in clause 6.69.1.3 steps 5-9
is shown the Registration/Deregistration of the NWDAF serving a UE once a PDU
session is stablished into the NWDAF Service area even when the UE is not yet
a targeted device; it makes a significant difference in low latency response
capability.
In TS 23.288 [5] it is stated that NWDAF instance(s) can be collocated with a
5GS NF.
For cases that contains only user plane data the associated NWDAF may be
collocated with a UPF. For instance assuming an NWDAF on slice level that
shall calculate Analytics containing data from UPF, it may make sense to do
this calculation distributed near the UPF. Especially if the NWDAF is
collocated/associated with an UPF having data available from the UPF.
Some areas that do not expect either dense traffic, or real-time use cases,
such as residential areas or rural areas, could use at least one associated
NWDAF instance but in a centralized fashion. Thus completing the whole PLMN
coverage with this kind of associated NWDAF instances.
It allows putting into practice, for instance, the scheme where the system
performs local analytics close to the edge. Therefore the outcomes are used by
other NWDAFs as data input to process those analytics services with less time
sensitivity and much more complexity. This solution significantly reduces the
volume of information that the associated NWDAF may send to a central NWDAF.
It avoids the bulk, and sufficient information traversing the whole network
when it is collected and processed by a central NWDAF, in this case, using
information that is available in every involved UPF. It is possible, for
instance, that the associated NWDAF sends to the central NWDAF the calculated
QoEs; instead of the central NWDAF uses traffic samples that are available in
the UPFs to perform the QoE calculation at the central location.
For the associated NWDAF in this solution, it registers with the NRF and also
with the UDM and subscribes to certain SMF at PDU session events.
The NWDAF registers into the NRF attending a specific area of interest. The
design of NWDAF service area is fundamentally the way to associate a NWDAF
with a cluster of UPFs. When the associated NWDAF is collocated the service
area is the same as UPF service area.
Following the NRF registration, the NWDAF gets from the NRF information about
the Service Area of the SMF(s) at a slice level. Then the NWDAF selects the
SMFs that serves partially or totally their service area. The NWDAF Subscribes
to selected SMFs to PDU session establishment or modification exposure
service; with a proper filter to ensure that the exposed events are only those
which fall into the NWDAF\'s service area.
NWDAF service area design principle: The finest granularity for Service Area
is at TA level. NWDAF service area should not overlay in between them. For
instance if wanted, when adding all associated NWDAFs service areas coverage
results in a full overlay of PLMN coverage; if so every single TA shall be
part of one of the associated NWDAF service areas. The NWDAF service area
should contain at least one partial or total SMF service area.
#### 6.69.1.2 Registration of the NWDAF serving an area
In this solution, each NWDAF serves a specific geographical area with a set of
User plane analytics services. It registers with the NRF as a NWDAF. This
registration includes the data described in TS 23.501 [2] clause 6.2.6 and TS
23.288 [5] clause 5.1.
Following the NRF registration, the NWDAF invokes the
Nnrf_NFManagement_NFStatusSubscribe for two purposes. First to get from the
NRF information about the Service Area of the SMF(s) at slice level and second
to get registered and start receiving notifications of new SMFs instances
deployment. Then the NWDAF selects the SMFs that serves partially or totally
NWDAF service area. The NWDAF Subscribes to selected SMFs to PDU session
establishment or modification exposure service; with a proper filter to ensure
that exposed events are only those which fall into NWNAF\'s service area.
Figure 6.69.1.2-1 steps 1- 5 illustrates the procedure.
#### 6.69.1.3 Registration/Deregistration of the NWDAF serving a UE
Every SMF PDU session establishment or modification event notification
arriving to the NWDAF, via a Nsmf_EventExposure_Notify, may derive the
respective UE that has an active PDU session being managed in NWDAF service
area. If the case, that UE needs to be registered in the UDM. Therefore, the
NWDAFs registers in the UDM those UEs. This registration in the UDM includes
the UE ID, NWDAFs FQDN or IP address, NWDAF instance ID, and the Analytics IDs
it can produce for such UE. This registration may take place right after the
NWDAF receives an event notification from the SMFs of a PDU session
establishment or modification. Note that it is enough that the UE is camping
in NWDAF service area to make the NWDAF proceed to register the UE even if it
does not correspond yet to a target SUPI. The NWDAF deregisters the UE when it
receives the event notification of PDU session termination or relocation out
of NWDAF service area. Also, a UE using edge computing or mashup application
could be managed by two different NWDAFs due to the UE PDU sessions having two
different anchor UPFs in different NWDAF service areas. Figure 6.69.1.2-1
steps 6 - 9 illustrates the procedure.
#### 6.69.1.3 NWDAFs subscribes to a new SMF instance
The NWDAFs shall subscribe to every new deployed SMF instance that match the
Service area filter. New deployment of SMF instances can occur due to AMF
inserting an I-SMF, a SMF failover process, traffic increase and others. When
a new SMF instance is deployed by OAM, configured and registered in the NRF;
based on the subscription in clause 6.69.1.2 step 2, the NRF issues
Nnrf_NFManagement_NFStatusNotify generating an event notification to all the
NWDAFs with a subscription matching the SMF Provisioning Information of the
new SMF. The NWDAF validates the reported SMFs at slice level to check if it
attends partially or totally to NWDAF\'s service area. The criteria to define
if SMF is serving partially or totally NWDAF\'s service area is TA based.
Finally the NWDAF invokes Nsmf_EventExposure_Subscribe Service to subscribe to
the SMFs with target indicating that any UE is targeted (on the specific TAI
list present in the NWDAF service area) at PDU session establishment or
modification. As described in TS 23.502 [3], clause 5.2.8.3.3. Figure
6.69.1.2-1 steps 10 - 14 illustrates the procedure.
Figure 6.69.1.3-1
1\. The NWDAF registers with NRF. This registration includes the data
described in TS 23.501 [2] clause 6.2.6 and TS 23.288 [5] clause 5.1,
including the NWDAF service area.
2\. The NWDAF issues a Nnrf_NFManagement_NFStatusSubscribe Service Operation
providing the target SMF Provisioning Information that implies all SMF that at
least include in their Service Area one TA that is part of the NWDAF Service
Area as described in TS 23.502 [3] clause 5.2.7.2.5
3\. The NRF issues Nnrf_NFManagement_NFStatusNotify with the list of all SMFs
that currently meet the SMF subscription. As described in TS 23.502 [3] clause
5.2.7.2.5
4\. The NWDAF selects the SMFs at slice level that attends partial or total
the NWDAF\'s service area. TA is by default the criteria to define if SMF is
serving partially or totally the NWDAF\'s service area.
5\. The NWDAF invokes Nsmf_EventExposure_Subscribe Service to subscribes to
all selected SMFs with target indicating that any UE is targeted (on the
specific TAI list present in the NWDAF\'s service area) at PDU session
establishment or modification. As described in 23.502 [3] 5.2.8.3.3
The following takes place when any SMF invokes Nsmf_EventExposure_Notify
regarding PDU session changes:
6\. The SMF invokes the Nsmf_EventExposure_Notify service operation providing
to the NWDAF the SMF PDU session establishment or modification event report.
This events may derive in that the respective UE that has an active PDU
session in the NWDAF\'s serving area.
7\. The NWDAF selects the UE to either register or deregister with the UDM. If
the PDU session is managed in the NWDAF service area, the respective UE is
selected thus registered. The UE is deregistered in case of the event
correspond to a PDU session termination or relocation out of the NWDAF\'s
service area. TA is the criterion by default to define if the PDU session is
being managed in the NWDAF\'s service area.
8\. The NWDAF invokes Nudm_UECM_Registration (SUPI, NWDAF FQDN, NWDAF instance
ID, Analytics ID, S-NSSAI, Area of Interest).
9\. UDM acknowledges the registration.
The following takes place when a new SMF instance is deployed:
10 A new SMF instance is deployed by OAM
11 The new SMF instance is configured and registered in the NRF
12 Based on the subscription in step 2, the NRF issues
Nnrf_NFManagement_NFStatusNotify to all the NWDAFs with a subscription
matching the SMF Provisioning Information of the new SMF
13 The NWDAF validates the reported SMFs at slice level to check if it attend
partially or totally the NWDAF\'s service area. TA is by default the criteria
to define if SMF is serving partially or totally the NWDAF\'s service area.
14 The NWDAF invokes Nsmf_EventExposure_Subscribe Service to subscribes to the
SMFs with target indicating that any UE is targeted (on the specific TAI list
present in NWDAF service area) at PDU session establishment or modification.
As described in 23.502 [3] 5.2.8.3.3
#### 6.69.1.4 Discovery the NWDAF via the UDM when UE is camping in NWDAF
service area
When a service consumer, e.g. an NWDAF, on slice level, is instructed to
produce UE related Analytics; it shall leverage the optimized NWDAF associated
to the UPFs; and can receives KPIs optimally of such UE\'s PDU session. The
NWDAF service consumer first needs to discover the NWDAF that is associated to
the respective UPFs and has optimized features to process data available at
such UPFs. Figure 6.69.1.2-1 illustrates the procedure.
Figure 6.69.1.4-1
0\. The NWDAF could have received data available at the UPF that is managing
the target UE\'s PDU session due to a previous requirement from a different
consumer.
1a,b. Service consumer instructs the NWDAF to produce UE related Analytics
based on SUPI. NF invoke Nnwdaf_AnalyticsSubcription_Subscribe. The NWDAF
invoke Nnwdaf_AnalyticsSubcription_Subscribe_response
2\. The NWDAF services consumer discovers the UDM serving the target UE by
invoking the procedures specified in TS 23.501 [2] clause 6.3.8, e.g., making
a query to the NRF based on SUPI. As a result, the NWDAF services consumer
obtains the address of the UDM NFs that is serving this UE.
3\. The NWDAF services consumer discovers the NWDAF that may serve or is
serving the target UE invoking Nudm_UECM_Get request (NWDAF type, SUPI,
Analytics ID, S-NSSAI).
4\. The NWDAF services consumer obtains the address of the NWDAF that may
serve or is serving the target UE for that UE related Analytics.
5a,b. NWDAF-Service-consumer instructs the associated-NWDAF to produce UE
related Analytics based on SUPI. NWDAF-service consumer invokes
Nnwdaf_AnalyticsSubcription_Subscribe. The associated NWDAF invoke
Nnwdaf_AnalyticsSubcription_Subscribe_response
6\. If the data is not previously received, NWDAF receives the required data
available at UPFs.
7\. The Associated NWDAF provides the Analytics Outcome to the NWDAF-service-
consumer.
8\. Once the NWDAF service consumer is ready, it provides the Analytics
Outcome to the NF.
NOTE: How NWDAF receives data available at UPFs is not defined in this specs.
#### 6.69.1.5 Providing the information of the NWDAF serving the UE to
consumers
In the case the UPF (by configuration or other means) utilizes an associated
NWDAF, it sends NWDAF ID, Analytics ID via N4 to SMF using a N4 Session
Establishment/Modification Response.
Re-use procedure in solution #10, but using the SMF initiated SM Policy
Modification to forward the information to PCF.
### 6.69.2 Impacts on services, Existing Nodes and Functionality
The introduction of NWDAF concept is seamless and does not impact any existing
Rel16 procedures assuring back compatibility.
NRF:
\- Event notification to NWDAF when a new SMF instance is deployed.
SMF:
\- Event notification to the NWDAF at PDU session establishment or
modification.
\- Receive following information over N4:
\- Associated NWDAF ID.
\- Analytics IDs supported in the Associated NWDAF ID.
UPF:
\- The UPF sends to the SMF over N4 in an existing message the following
information
\- Associated NWDAF ID
\- Analytics IDs supported in the Associated NWDAF ID
UDM:
\- Enhanced Nudm_UECM procedure with new data set for storing NWDAF
registrations.
NF as NWDAF service consumer
\- Discovery of associated NWDAF serving the UE.
## 6.70 Solution #70: Persistent data collection
### 6.70.1 Description
#### 6.70.1.1 Overview
This is a solution for Key Issue #11, Increasing efficiency of data
collection.
TS 23.288 [5] defines a solution that enables NWDAF (standalone or supported
by DCCF, as described in Solution #9) to collect data from NFs for analytics
purposes. For collecting data from NFs via existing NF exposure services, the
NWDAF may subscribe/unsubscribe at the relevant NFs to be notified on related
events.
The NWDAF must interact with the relevant NFs (e.g., AMF, SMF) to request or
subscribe to the exposure services for data collection and, in order to
generate the requested analytic reports from the collected user data, the
NWDAF may need to collect relevant user data continuously, such as several
days, weeks, etc.
During this time, however, the UE may attach/detach from the network, PDU
sessions may be established/released, and NFs serving a UE may change due to
UE mobility, such that the subscriptions to the exposure services may get lost
over time.
Although 3GPP currently defines a procedure for AMF event exposure services to
allow that subscriptions to events in an AMF are transferred to a target AMF
in case the UE moves and gets reallocated to the target AMF, that procedure
only provides a solution for the mobility problem with respect to AMFs.
However, that solution does not allow maintaining event exposure subscriptions
if the UE deregisters and reregisters with the network, or if PDU sessions are
entirely released and re-established, in which case all event exposure
subscriptions will generally be lost. Also, such solution does not allow
maintaining event exposure subscriptions if an SMF and UPF allocated to a PDU
session are reassigned due to mobility of the UE to a closer SMF and UPF, for
example. In these cases, the NWDAF will no longer get any notifications for
data collection and it will not be able to provide accurate analytics reports
anymore.
With Release 16 procedures, an NWDAF could use the Nudm_UECM_Get operation
from time to time in order to interrogate UDM about the AMF and SMFs that are
serving a UE. But a subscription/notification operation is not even defined in
the Nudm_UECM service in Release 16, making, in this case, NWDAF to
periodically poll UDM in order to keep track of changes of AMF and SMF (and
indirectly, UPF). In case NWDAF is informed of a change in these NFs, NWDAF
should send a new event subscription to the newly selected network function.
This solution adds quite a substantial overhead to the NWDAF.
This solution extends the existing Release 16 mechanisms for creating
permanent event exposure subscriptions in AMF and SMF. The mechanism enables
UDM to receive event exposure subscriptions from NWDAF. UDM is enhanced by
keeping track of new AMF and SMF serving the UE, so that UDM can recreate
event exposure subscription in new NFs if needed This solution is applicable
to NFs that are dynamically selected at UE registration (AMF) or PDU Session
activation (SMF) or those which may be change due to, e.g., UE mobility. This
solution is applicable to individual SUPIs or a group of SUPIs. If NWDAF
includes an Area of Interest in the subscription to UDM, UDM passes it
transparently to the relevant network functions.
#### 6.70.1.2 Procedure for the creation or deletion of a persistent Event
Exposure subscription
Figure 6.70.1.2-1 illustrates the procedure for the creation or deletion of a
persistent Event Exposure subscription. The procedure is based on the existing
one in TS 23.502 [3] clause 4.15.3.2.3.
Figure 6.70.1.2-1: Persistent Event Exposure Subscription Creation/Deletion
1\. NWDAF, (or any other consumer of Event Exposure) creates an Event Exposure
subscription and sends an Nudm_EventExposure_Subscribe/Unsubscribe request to
UDM. If the NWDAF intends the subscription to be persistent across
registration/de-registration of the UE, and transfer of UE context to another
NF, the NWDAF includes a Persistent indicator flag.
2\. UDM examines the event type to determine whether an event exposure
subscription must be created in AMF or SMF. If an event exposure subscription
must be created in the AMF as one is currently allocated to the UE (e.g,
because the UE is currently registered), UDM sends an Namf_EventExposure
Subscribe/Unsubscribe to the AMF.
3\. The AMF sends a response. The AMF may decline the subscription if, e.g.,
an existing duplicated subscription for the same UE is in place. This might be
the case if the UE event exposure subscription was transferred from an old
AMF.
4\. If UDM determines that an event exposure subscription must be created in
SMF, UDM sends an Nsmf_EventExposure Subscribe/Unsubscribe request to the
relevant SMFs handling PDU sessions of the UE.
5\. SMF sends a response to UDM.
6\. UDM sends an Nudm_EventExposure Subscribe/Unsubscribe response to the
NWDAF.
#### 6.70.1.3 Procedure for restoring an existing Event Exposure Subscription
Figure 6.70.1.3-1 illustrates the procedure for the restoring a persistent
Event Exposure subscription when a new NF is elected to be serving a UE.
Figure 6.70.1.3-1: Event Exposure Subscription Restoration
1\. When AMF or SMF are elected to be serving a UE, they send an
Nudm_UECM_Registration request to UDM. This may be due to, e.g., a new
registration of the UE in AMF, the creation of a new PDU session, an AMF
transfer, an SMF transfer, etc.
2\. UDM sends a response to the NF.
3\. Then UDM determines if a persistent event exposure subscription is in
place for this UE and applicable to the type of NF which is registering in
UDM.
4\. If a persistent event subscription is applicable to the UE and type of NF,
UDM sends an Nnf_EventExposure Subscribe request to that NF.
5\. The NF sends a response.
### 6.70.2 Impacts on Existing Nodes and Functionality
NWDAF:
\- New flag in UDM Event Exposure subscription indicating persistence.
UDM:
\- Upon registration of a new NF for a UE, determination of whether an event
exposure subscription must be recreated.
## 6.71 Solution #71: Representative UEs sampling for data collection
### 6.71.1 Introduction
This solution addresses aspects of KI #11: Increasing efficiency of data
collection. The solution avoids that a non-representative sampling of UE
subsets is selected when NWDAF requests to apply a sampling ratio to reduce
signalling and data collection load.
### 6.71.2 Functional Description
This solution proposes to introduce partition criteria as a new Event
Reporting Information parameter in the Nnf_EventExposure_Subscribe message and
a new mechanism for UE selection when sampling ratio is applied by NWDAF.
When an NWDAF service consumer (e.g. Network Functions (NFs) or OAM) specifies
a group of UEs or any UE (i.e., all UEs) as target of the requested analytics,
the NWDAF subscribes at the service producer (NF) to collect events related to
the targeted group of UEs or all UEs. To alleviate the potential heavy
signalling and data collection load, sampling ratio is applicable as Event
reporting information. When sampling ratio is provided, the targeted NF
selects a random subset among the group of UEs targeted or among all the UEs,
according to the sampling ratio, and only the events related to this subset
are reported to the NWDAF.
Simple random sampling is a well-known probability sampling technique, to
retrieve statistics from a subset of individuals chosen from the total
population. Simple random sampling however does not guarantee that a
particular subset selected is a perfect representation of the entire
population. This, in a Machine Learning (ML) environment, could lead to the
following problems:
\- A misclassification could occur, i.e., an error in the inference leading to
wrong conclusion about all UEs (as an example the NWDAF could detect a false
abnormal behaviour, or wrong network performance analytics, or wrong observed
service experience information).
\- Training an ML model utilizing a non-representative subset could lead to
biased ML algorithms which learned wrong statistics and then provides biased
analytics.
With the partition criteria parameter, NWDAF informs the target NF (the one
managing the targeted UEs data) to create strata from all UEs, grouping the
UEs based on a-priori service or network data information (e.g. Application
ID, TAC, UE communication information such as traffic volume, and UE mobility
information such as geographical partitioning or roaming status or mobility
type). In this way, it is possible to obtain a representative sample of the
entire population.
When receiving a subscription message containing the partition criteria
parameter, the NF groups the targeted UEs (i.e., a group of UEs or any UE)
based on the partition criteria value (service or network information related
to UE such as TAC, Application ID, UE communication information or UE mobility
information), thus creating sub-populations/strata of UEs. From each stratum,
the NF selects a subset of UEs by sampling randomly from each sub-population
according to the sampling ratio specified. This means that each sub-
population/stratum has the same sampling ratio regardless of the size of the
sub-population/stratum. Thus, the number of UEs selected from each sub-
population is proportional to sub-population size. Only notifications
regarding selected UEs are sent to the NWDAF.
There can be multiple partition criteria in a single request from NWDAF.
### 6.71.3 Procedures
The procedure as per Figure 6.71.3-1 illustrates how partition criteria can be
used by NWDAF and the NF during data collection for a group of UEs or for any
UE.
Figure 6.71.3-1: Representative UEs sampling for data Collection from NF
1\. The NWDAF Service Consumer subscribes to / requests analytics information
by invoking the Nnwdaf_AnalyticsSubscription_Subscribe /
Nnwdaf_AnalyticsInfo_Request service operation. The NWDAF Service Consumer
provides among others input parameters (as detailed in TS 23.288 [5] clause
6.1.3) the Target of Analytics Reporting that indicates the objects for which
Analytics information is requested, such as a group of UE(s) or any UE (i.e.,
all UEs).
2\. The NWDAF sends a request to NRF/UDM/BSF to determine which NF(s) is/are
managing the UEs.
3\. The NWDAF subscribes to the NF (e.g. AMF or SMF) event exposure. To
alleviate the signalling and data collection load, the NWDAF provides as Event
Reporting Information in the Event Exposure service a sampling ratio to the
NF, together with the \"partition criteria\" parameter. This is to inform the
NF how to group the UEs before applying the sampling ratio. Depending on the
analytics required by the NWDAF Service Consumer and based on local
configuration, the NWDAF sets the value of the \"partition criteria\" to
service or network information related to UEs, and specifies a sampling ratio.
There can be multiple partition criteria in a single request from NWDAF.
NOTE 1: Some examples of \"partition criteria\" that can be used for AMF event
exposure:
\"partition with Type Allocation Code\" where AMF would group the UEs based on
their Type Allocation Code;
\"partition with PLMN code\" where the AMF would group the UEs based on their
home operator;
\"partition with geographical area\" where, for large areas, the AMF would
group the UEs in sub-areas;
\"partition with mobility type\" where the AMF would group the UEs based on
whether they are stationary or not.
NOTE 2: Some examples of \"partition criteria\" that can be used for SMF event
exposure:
\"partition with application\" where the SMF would group the UEs based on the
application ID, assuming the SMF has the information of all application IDs;
\"partition with S-NSSAI\" where the SMF would group the UEs based on the
network slice they are using.
NOTE 3: Some examples of \"partition criteria\" that can be used for AF event
exposure:
\"partition with Expected UE Behaviour parameters\" where AF would group the
UEs based on for example their traffic profile.
4\. The NF groups the targeted UEs (i.e., creates sub-populations/strata)
based on the partition criteria parameter.
NOTE 4: The NWDAF can also provide event filters during step 3, in which case
these filters need to be considered by the NF.
5\. From each sub-population/stratum, the NF selects a subset of UEs by
sampling randomly from each sub-population according to the sampling ratio.
This means that each sub-population/stratum has the same sampling ratio
regardless of the size of the sub-population/stratum.
6\. The NF sends only the notifications regarding the selected UEs to the
NWDAF.
7-8. Based on collected data, the NWDAF derives analytics and responds to the
request from the NWDAF service consumer.
NOTE 5: The procedure above can also be used if a data collection coordination
function is introduced between NWDAF and NFs acting as data sources for data
collection. The NWDAF provides partition criteria to the data collection
coordination function, and the data collection coordination function relays
the partition criteria to the NFs acting as data sources for data collection.
### 6.71.4 Impacts on services, entities and interfaces
Impacts to NF Event Exposure services: In order to enable the usage of
partition criteria together with sampling ratio, the Event Reporting
information parameters in Table 4.15.1-1 TS 23.502 [3] need to be extended to
include a \"partition criteria\".
## 6.72 Solution #72: Efficient Analytics Transfer in mixed Deployments
### 6.72.1 Description
This solution addresses aspects of Key Issue #11: increasing efficiency of
data collection.
In a mixed and multiple NWDAF deployment scenario where some NWDAFs are also
co-located with 5GC Network Functions such as AMF and SMF, it is beneficial to
share analytics data performed in one of the co-located NWDAF with other NFs,
so that the latter are relieved from contacting NWDAF again for collecting
data and, if needed, further computing analytics. Also, each NF interested in
analytics for a UE or a group of UEs requests analytics from NWDAF
specifically for its uses. However, once analytics for UE(s) are available to
an NF consumer (e.g. AMF), it would be useful that these are made common to
other entities, thus avoiding that several 5GC NFs request analytics to one or
several NWDAFs for the same UE or the same group of UEs.
For example, if a co-located NWDAF or an NF Consumer has a UE mobility related
analytics data either generated by itself or received using Nnwdaf services,
it can be re-used by other NFs which are interested in the same UE mobility
analytics data, e.g., those related to same PDU session and so on. With co-
located NWDAF, and in particular for the scenarios when UE is moving, the
analytics are lost for the UE as soon as the UE moves to a different AMF
unless it is uploaded or sent to some other network function(s).
In cases where a co-located NWDAF or NF which has received analytics data
using Nnwdaf services has analytics information (for example, UE mobility
Analytics, UE Communication pattern Analytics specific to a UE or a group of
UEs), then this Analytics ID and / or analytics information is shared along
with UE Context information with other interested 5GC NFs. Those NF(s) which
support receiving these analytics, e.g., along with UE Context information,
may explicitly request these analytics when they initiate the UE related
interaction with the NF that currently maintains these analytics. Therefore, a
source NF can use this information before transferring the analytics to
destination NFs.
### 6.72.2 Procedures
Figure 6.72.2-1 shows the procedure where a Network Function NF2 gets UE
context transfer message from NF1 which additionally includes UE analytics
information, e.g., mobility analytics or UE Communication pattern Analytics.
Figure 6.72.2-1: UE context transfer between 5GC Network Functions
1-2. A Network Function NF1 (e.g. AMF or SMF) has available UE Analytics Info,
e.g., UE Mobility analytics. This information could be based on
Nwdaf_AnalyticsInfo Request response with NWDAF and/or NF1 could be co-located
with the NWDAF.
3\. NF1 gets a trigger to UE Context transfer to another Network Function NF2,
for example, this could be triggered as part of Mobility registration
procedure or PDU session establishment procedure. Another example trigger is
NF2 sending a UE context transfer request message to NF1.
4\. NF1 transfers UE Context information, and it additionally includes UE
analytics information, e.g., mobility analytics, UE Communication pattern
Analytics, and/or other relevant analytics data that it already received from
NWDAF at step 2 or, if it is co-located with an NWDAF that it generated based
on the received UE data. For example, in case NF1 and NF2 being AMFs, then
this message would correspond to Namf_Communication_UEContextTransfer and in
case of NF1 being AMF and NF2 being SMF, it would correspond to using the
Nsmf_PDUSession_CreateSMContext message.
NOTE: NF1 and NF2 may be the same type, e.g., ­when UE context is transferred
between and \"old\" AMF and a \"new\" AMF. However, also the case of NF1 and
NF2 being different NF types is possible.
### 6.72.3 Impacts on services, entities and interfaces
5GC NF with UE context information:
\- Extend UE Context transfer (e.g. as specified for AMF in clause 5.2.2.2.2
of TS 23.502 [3] and for SMF in clause 5.2.8.2.5 of TS 23.502 [3]) to support
transferring UE analytics information along with the UE Context information.
## 6.73 Solution #73: Trigger configuration for data collection and analytics
### 6.73.1 Description
This solution addresses Key Issue #13 \"Triggering conditions for analytics\",
and also addresses Key Issue #18 \"Enhancement for real-time communication
with NWDAF\" with respect to whether and which enhancement for data collection
and/or analytics exposure framework is required to enable real-time or near
real-time NWDAF communication.
The triggers for consumer NF to request or subscribe to analytics vary for
different NF types, while the triggers for NWDAF to start collecting data or
building analytics may vary for different Analytics IDs and other factors.
One way to define or configure the triggers flexibly and effectively is that
the PCF provides the configuration of the triggers as network analytics
control information (or network analytics policy) in PCC rules to the consumer
NF (e.g. AMF, SMF) and the NWDAF.
The PCF provides the network analytics control information to the NF(s) (i.e.
AMF, SMF) via AM/SM Policy Association Establishment/Modification/Termination
procedures as specified in TS 23.502 [3] clause 4.16, where the network
analytics control information is provisioned as part of AM/SM Policy to the
AMF/SMF to trigger the AMF/SMF to request or subscribe for analytics
information related to access and mobility management / session management
from the NWDAF.
In addition, the PCF provides the network analytics control information to the
NWDAF as Network Analytics (NA) Policy, using NA Policy control procedures.
The network analytics control information may include:
a) Whether (real-time) data collection is required.
b) Whether (real-time) data analytics is required. Only applicable to the
NWDAF.
c) Whether analytics request needs to be initiated.
d) Target of data collection and/or analytics, which can be Analytics ID(s),
or a combination of Analytics ID(s) and other information (e.g. Target of
Analytics Reporting (i.e. UE ID, UE group ID or any UE), Analytics Filter
Information, as defined in TS 23.288 [5]).
e) Real-time/trigger setting, which can be:
\- Immediate. That is, the NF initiates the analytics request/subscription or
the NWDAF starts data collection/analytics as defined in d) immediately upon
receiving the network analytics control information.
\- Triggers for data collection. This may include time period, location and
other criteria for starting data collection. When the conditions meet, the
NWDAF starts data collection as defined in d).
\- Triggers for data analytics. This may include time period, location and
other criteria for starting data analytics. When the conditions meet, the
NWDAF starts data analytics as defined in d).
\- Triggers for analytics request. This may include time period, location and
other criteria, including network/NF status or performance (e.g. network
performance lower than a threshold, NF load higher than a threshold), UE
status or performance (e.g. frequent registration), application status or
performance (e.g. service experience lower than a threshold) and etc. When the
conditions meet, the NF initiates the analytics request/subscription as
defined in d) to the NWDAF.
f) data collection/analytics requirements, which may include:
\- Confidence for prediction in analytics information.
\- Sampling ratio, e.g. the percentage of UEs/PDU Sessions to be measured.
The provision of network analytics control information can be performed during
Registration, PDU Session Establishment/Modification, Service specific
parameter provisioning procedures, or initiated by the PCF based on other
triggers (e.g. analytics information from the NWDAF, local configuration),
etc.
The AF may provide the service specific analytics control information (i.e.
analytics and/or data collection control information for specific
applications/services) to the PCF via the service specific parameter
provisioning procedures as specified in TS 23.502 [3] clause 4.15.6.7. Based
on the service specific analytics control information, the PCF derives the
network analytics control information for the service/application, and
provides to the NF(s) and NWDAF. Also based on the service specific analytics
control information, the PCF decides for itself whether to request or
subscribe to analytics information from the NWDAF.
The service specific analytics control information may include, for specific
service(s)/application(s):
a) Whether (real-time) data collection is required.
b) Whether (real-time) data analytics is required.
c) Target of data collection and/or analytics, which can be Analytics ID(s),
or a combination of Analytics ID(s) and other information (e.g. Target of
Analytics Reporting (i.e. UE ID, UE group ID or any UE), Analytics Filter
Information as defined in TS 23.288 [5]).
d) Real-time/trigger setting, which can be:
\- Immediate. The data collection and/or analytics starts immediately upon the
start of the service(s)/application(s);
\- Triggers for data collection. This may include time period, location and
other criteria (e.g. service experience lower than a threshold) for data
collection of the service(s)/application(s).
\- Triggers for data analytics. This may include time period, location and
other criteria (e.g. service experience lower than a threshold) for data
analytics of the service(s)/application(s).
e) data collection/analytics requirements, which may include:
\- Confidence for prediction in analytics information.
\- Sampling ratio, e.g. the percentage of UEs/PDU Sessions to be measured.
Table 6.73.1-1 and Table 6.73.1-2 give examples as well as the usages of
network analytics control information and service specific analytics control
information, respectively.
Table 6.73.1-1: Examples and usages of network analytics control information
+----------------+----------------+----------------+----------------+ | Network | NFs receiving | How the NF use | How the NF use | | analytics | the network | the network | the analytics | | control | analytics | analytics | | | information | control | control | | | examples | information | information to | | | | | request | | | | | analytics | | +----------------+----------------+----------------+----------------+ | Example 1 | AMF | The AMF | The AMF tracks | | | | subscribes to | the UE | | analytics IDs | | analytics | mobility and | | = \"UE | | information on | reports UE | | mobility\", | | UE mobility | access and | | \"Abnormal | | and abnormal | mobility | | behaviour\"; | | behaviours in | related events | | | | AoI of TAI | as specified | | Analytics | | list 1, upon | in | | Filter | | receiving this | TS | | Information: | | network | 23.502 [3]. | | AoI = TAI | | analytics | | | list1; | | control | The AMF takes | | | | information | actions for | | Trigger | | from the PCF. | risk solving | | setting: | | | upon the | | \"Immediate\" | | | detected UE | | | | | abnormal | | | | | behaviours, as | | | | | specified in | | | | | TS | | | | | 23.288 [5]. | +----------------+----------------+----------------+----------------+ | Example 2 | AMF | The AMF | The AMF takes | | | | subscribes to | analytics for | | analytics IDs | | NF (i.e. SMF) | candidate | | = \"NF load | | load analytics | SMFs\' load | | information\"; | | information | into account | | | | from the NWDAF | when selecting | | Analytics | | for the time | SMF as | | Filter | | period of 7PM | specified in | | Information: | | to 10PM | TS | | NF type = SMF; | | everyday. | 23.501 [2]. | | | | | | | Trigger | | | | | setting: | | | | | Target period | | | | | = \"7PM to | | | | | 10PM\" | | | | +----------------+----------------+----------------+----------------+ | Example 3 | AMF | The AMF | The AMF | | | | subscribes to | decides, based | | analytics IDs | | service | on the slice | | = \"Service | | experience and | analytics | | Experience \", | | load analytics | provided by | | \"Load level | | information | NWDAF, to | | information\"; | | for S-NSSAI1 | trigger | | | | from the | actions e.g. | | Analytics | | NWDAF, upon | Network Slice | | Filter | | receiving this | (instance) | | Information: | | network | load | | S-NSSAI = | | analytics | distribution. | | S-NSSAI1; | | control | | | | | information | | | Trigger | | from the PCF. | | | setting: | | | | | \"Immediate\" | | | | +----------------+----------------+----------------+----------------+ | Example 4 | SMF | The SMF | The SMF tracks | | | | subscribes to | the UE | | analytics IDs | | analytics | communication | | = \"UE | | information on | and reports | | co | | UE | events related | | mmunication\", | | communication | to PDU | | \"Abnormal | | and abnormal | Sessions of | | behaviour\"; | | behaviours | the UE as | | | | from the | specified in | | Analytics | | NWDAF, when | TS | | Filter | | the SMF learns | 23.502 [3]. | | Information: | | (e.g. based on | | | AoI = TAI | | UE mobility | The SMF takes | | list1; | | event | actions for | | | | notification | risk solving | | Trigger | | from the AMF) | upon the | | setting: | | that the UE | detected UE | | Target period | | enters the | abnormal | | = \"2020-09-01 | | area of TAI | behaviours, as | | 7PM to 9PM\" | | list 1, for | specified in | | | | the time | TS | | | | period of 7PM | 23.288 [5]. | | | | to 9PM | | | | | 2020-09-01. | | +----------------+----------------+----------------+----------------+ | Example 5 | SMF | The SMF | The SMF takes | | | | subscribes to | analytics for | | analytics IDs | | NF (i.e. UPF) | UPF load into | | = \"NF load | | load analytics | account when | | information\"; | | information | selecting UPF | | | | from the | for a PDU | | Analytics | | NWDAF, for the | session, as | | Filter | | time period of | specified in | | Information: | | 7PM to 10PM | TS | | NF type = UPF; | | everyday. | 23.501 [2]. | | | | | | | Trigger | | | | | setting: | | | | | Target period | | | | | = \"7PM to | | | | | 10PM\" | | | | +----------------+----------------+----------------+----------------+ | Example 6 | SMF | The SMF | The SMF takes | | | | subscribes to | analytics for | | analytics IDs | | service | service | | = \"Service | | experience | experience of | | Experience\"; | | analytics | App1 into | | | | information | account when | | Analytics | | for App1 from | selecting the | | Filter | | the NWDAF, | DNAI and UPF | | Information: | | upon receiving | for edge | | Application | | this network | computing. | | IDs = App1; | | analytics | | | | | control | | | Trigger | | information | | | setting: | | from the PCF. | | | \"Immediate\" | | | | +----------------+----------------+----------------+----------------+ | Example 7 | NWDAF | The NWDAF | The NWDAF | | | | starts data | provides the | | Real-time | | collection and | analytics to | | analytics = | | analytics on | analytics | | True; | | service | consumers upon | | | | experience of | receiving | | analytics IDs | | App1 for the | analytics | | = \"Service | | UE group, upon | requests/ | | Experience\"; | | receiving this | subscriptions. | | | | network | | | Target of | | analytics | | | Analytics | | control | | | Reporting = UE | | information | | | group ID; | | from the PCF. | | | | | | | | Analytics | | | | | Filter | | | | | Information: | | | | | Application | | | | | IDs = App1 | | | | +----------------+----------------+----------------+----------------+
Table 6.73.1-2: Examples and usages of service specific analytics control
information
+----------------+----------------+----------------+----------------+ | service | Deduced | How the PCF | How the PCF | | specific | network | use the | use the | | analytics | analytics | service | analytics | | control | control | specific | | | information | information by | analytics | | | examples | the PCF | control | | | | | information to | | | | | request | | | | | analytics | | +----------------+----------------+----------------+----------------+ | Example 1 | analytics IDs | The PCF | See | | | = \"Service | subscribes to | T | | analytics IDs | Experience\"; | service | S 23.503 [4] | | = \"Service | | experience | c | | Experience\"; | Analytics | analytics | lause 6.1.1.3. | | | Filter | information | | | Analytics | Information: | for App1 from | | | Filter | Application | the NWDAF, | | | Information: | IDs = App1; | upon receiving | | | Application | | the service | | | IDs = App1; | Trigger | specific | | | | setting: | analytics | | | Trigger | \"Immediate\". | control | | | setting: | | information | | | \"Immediate\" | This is to be | from the AF. | | | | provided to | | | | | the SMF, when | | | | | the PCF | | | | | receives this | | | | | service | | | | | specific | | | | | analytics | | | | | control | | | | | information | | | | | from the AF. | | | +----------------+----------------+----------------+----------------+ | Example 2 | analytics IDs | NA | NA | | (e.g. for | = \"UE | | | | UAVs) | mobility\"; | | | | | | | | | analytics IDs | Target of | | | | = \"UE | Analytics | | | | mobility\"; | Reporting = UE | | | | | group ID; | | | | Target of | | | | | Analytics | Analytics | | | | Reporting = UE | Filter | | | | group ID; | Information: | | | | | AoI = TAI | | | | Analytics | list1; | | | | Filter | | | | | Information: | Trigger | | | | AoI = | setting: | | | | geographic | \"Immediate\" | | | | area1 (or TAI | | | | | list1 if the | This is to be | | | | AF is trusted | provided to | | | | AF); | the AMF, when | | | | | the PCF | | | | Trigger | receives this | | | | setting: | service | | | | \"Immediate\" | specific | | | | | analytics | | | | | control | | | | | information | | | | | from the AF. | | | +----------------+----------------+----------------+----------------+ | Example 3 | 1) analytics | The PCF | See | | | IDs = \"UE | subscribes to | T | | analytics IDs | mobility\", | service | S 23.503 [4] | | = \"Service | \"Abnormal | experience | c | | Experience\", | behaviour\"; | analytics | lause 6.1.1.3. | | \"UE | | information | | | mobility\", | Analytics | for App1 from | The PCF may | | \"UE | Filter | the NWDAF, for | decide to | | co | Information: | AoI=TAI list1 | provide | | mmunication\", | AoI = TAI | and time | network | | \"Abnormal | list1; | period of 7PM | analytics | | behaviour\"; | | to 10PM | control | | | Trigger | 2020-09-01. | information to | | Analytics | setting: | | the AMF/SMF | | Filter | \"Immediate\" | The PCF may | based on the | | Information: | or Target | also subscribe | analytics. | | Application | period = | to UE abnormal | | | IDs = App1, | \"2020-09-01 | behaviour | | | AoI = | 7PM to 9PM\". | analytics from | | | geographic | | the NWDAF, for | | | area1 (or TAI | 2) analytics | AoI=TAI list1 | | | list1 if the | IDs = \"UE | and time | | | AF is trusted | co | period of 7PM | | | AF); | mmunication\", | to 10PM | | | | \"Abnormal | 2020-09-01. | | | Trigger | behaviour\"; | | | | setting: | | | | | Target period | Analytics | | | | = \"2020-09-01 | Filter | | | | 7PM to 9PM\"; | Information: | | | | | AoI = TAI | | | | Trigger | list1; | | | | setting: | | | | | Service | Trigger | | | | Experience | setting: | | | | Threshold | \"Immediate\" | | | | value = SE1 | or Target | | | | | period = | | | | | \"2020-09-01 | | | | | 7PM to 9PM\". | | | | | | | | | | 1) and 2) are | | | | | to be provided | | | | | to the AMF and | | | | | SMF | | | | | respectively, | | | | | when the PCF | | | | | learns (e.g. | | | | | based on | | | | | analytics | | | | | information | | | | | from the | | | | | NWDAF) that | | | | | the Service | | | | | Experience | | | | | analytics for | | | | | App1 is across | | | | | SE1 (with | | | | | Trigger | | | | | setting set to | | | | | \ | | | | | "Immediate\"), | | | | | or when the | | | | | PCF receives | | | | | this service | | | | | specific | | | | | analytics | | | | | control | | | | | information | | | | | from the AF | | | | | (with Trigger | | | | | setting set to | | | | | Target | | | | | period). | | | +----------------+----------------+----------------+----------------+ | Example 4 | Real-time | NA | NA | | | analytics = | | | | Real-time | True; | | | | analytics = | | | | | True; | analytics IDs | | | | | = \"Service | | | | analytics IDs | Experience\"; | | | | = \"Service | | | | | Experience\"; | Target of | | | | | Analytics | | | | Target of | Reporting = UE | | | | Analytics | group ID; | | | | Reporting = UE | | | | | group ID; | Analytics | | | | | Filter | | | | Analytics | Information: | | | | Filter | Application | | | | Information: | IDs = App1. | | | | Application | | | | | IDs = App1 | This is to be | | | | | provided to | | | | | the NWDAF, | | | | | when the PCF | | | | | receives this | | | | | service | | | | | specific | | | | | analytics | | | | | control | | | | | information | | | | | from the AF. | | | +----------------+----------------+----------------+----------------+
Editor\'s note: It is FFS whether the PCF configure triggers for network
analytics (and the rest of the information part of network analytics control
information) or it can be done via OAM.
Editor\'s note: It is FFS whether the AF provides information to the PCF to
trigger the settings of triggers (and the rest of the information part of
network analytics control information) to the AMF/SMF.
Editor\'s note: It is FFS how to provide analytics triggers to NF if the
target for analytics is a group of UE or any UE.
### 6.73.2 Input Data
Void.
### 6.73.3 Output Analytics
Void.
### 6.73.4 Procedures
#### 6.73.4.1 Provisioning of network analytics control information
The procedure of network analytics control information provisioning by the PCF
to the NF (AMF, SMF) is shown in Figure 6.73.4.1-1.
Figure 6.73.4.1-1: Provisioning of network analytics control information
1\. The PCF provides the network analytics control information to the NF (AMF
or SMF) using policy control procedures as described in TS 23.502 [3] clause
4.16.
If the NF is AMF, the PCF sends the network analytics control information as
part of AM Policy in Npcf_AMPolicyControl_Create Response,
Npcf_AMPolicyControl_Update Response or Npcf_AMPolicyControl_UpdateNotify
Request, to trigger the AMF to request or subscribe for analytics information
related to access and mobility management from the NWDAF.
If the NF is SMF, the PCF sends the network analytics control information as
part of SM Policy in Npcf_SMPolicyControl_Create Response,
Npcf_SMPolicyControl_Update Response or Npcf_SMPolicyControl_UpdateNotify
Request, to trigger the SMF to request or subscribe for analytics information
related to session management from the NWDAF.
2\. Based on the network analytics control information, the NF (AMF or SMF)
subscribes to or requests the analytics information from the NWDAF as
specified in TS 23.288 [5].
The procedure of Network Analytics (NA) Policy provisioning by the PCF to the
NWDAF is shown in Figure 6.73.4.1-2.
Figure 6.73.4.1-2: Provisioning of Network Analytics (NA) Policy
1\. The NWDAF invokes Npcf_NAPolicyControl_Create or
Npcf_NAPolicyControl_Update service operation to the PCF, to request to
establish or update the NA Policy Association between the NWDAF and the PCF.
The NWDAF may initiate this procedure based on local configuration or
triggers, e.g. after registering to the NRF, upon change of its NF profile
(e.g. change of supported analytics types, serving area).
2\. The PCF provides the network analytics control information as Network
Analytics (NA) Policy to the NWDAF in the Npcf_NAPolicyControl_Create
Response, Npcf_NAPolicyControl_Update Response or
Npcf_NAPolicyControl_UpdateNotify Request.
3\. Based on the NA Policy, the NWDAF performs data collection and/or
analytics as specified in TS 23.288 [5]. If an updated NA policy is received,
the NWDAF may stop or modify the existing data collection/analytics, or
initiate new data collection/analytics, based on the new NA policy.
#### 6.73.4.2 Provisioning of service specific analytics control information
The procedure of service specific analytics control information provisioning
by the AF to the PCF is shown in Figure 6.73.4.2-1.
Figure 6.73.4.2-1: Provisioning of service specific analytics control
information
1\~5. Same as TS 23.502 [3] clause 4.15.6.7 step 1\~5, where the AF request
contains the service specific analytics control information, i.e. requirements
regarding analytics and/or data collection for specific
application(s)/service(s).
6\. Based on the service specific analytics control information, the PCF
derives the network analytics control information for the service/application
and the PCF also decides for itself whether to request or subscribe to
relevant analytics information from the NWDAF.
7\. The PCF provides the network analytics control information to the NF(s)
and/or the NWDAF as described in clause 6.73.4.1, and/or subscribes to or
requests the analytics information from the NWDAF as specified in TS 23.288
[5] if needed.
### 6.73.5 Impacts on services, entities and interfaces
PCF:
\- Provide network analytics control information to the NF(s) and/or the
NWDAF.
\- Derive the network analytics control information for the
service/application based on the service specific analytics control
information provided by the AF.
\- Subscribe to or request the analytics information from the NWDAF based on
the service specific analytics control information provided by the AF.
AMF/SMF:
\- Subscribe to or request the analytics information from the NWDAF based on
the network analytics control information provided by the PCF.
NWDAF:
\- Perform data collection and/or analytics based on the Network Analytics
(NA) Policy provided by the PCF.
AF:
\- Provide service specific analytics control information to the PCF via the
service specific parameter provisioning procedures.
## 6.74 Solution #74: Triggers for requesting analytics
### 6.74.1 Description
This solution addresses Key Issue #13 \"Triggering conditions for analytics\",
especially on the aspect of triggers which can be used by analytics consumers
to request for or subscribe to analytics from the NWDAF.
In general, particular procedures may trigger one or more than one requests
for analytics output from NWDAF. Specific trigger type can be named as:
1\. NF selection, when:
(1) In UE registration procedure, AMF may trigger \"NF load analytic\". With
the result of statistic or prediction load of candidates PCF from NRF, AMF
select a PCF instance for AM policy association and UE policy association.
The same logic may apply to NSSAAF selection, etc.:
(2) PDU Session Establishment procedure, SMF may trigger \"NF load analytic\"
and consider the load analytics result to select a PCF instance for SM policy
association from PCF candidate(s) from NRF.
(3) During the PDU session establishment or anchor UPF change procedure, the
SMF, as an analytics consumer, may trigger \"EC service experience/performance
analytics\", to find which UPF and DNAI can serve the UE with the best user
experience or service performance.
2\. Slice selection, when:
(1) Network Slice Selection procedure. NSSF may request for slice load
analytics based on data rate quota and/or amount of data volume dispersed
analytic, statistical or predictive, then the NSSF can decide when to stop
admitting heavy users into a particular slice. In case the NSSF is not
deployed, another 5GC NF (e.g. AMF and/or SMF) may subscribe to the slice
dispersion data analytics information to assist with load mitigation policy.
### 6.74.2 Input Data
Input data of mentioned Analytics should follow TS 23.288 [5].
### 6.74.3 Output Analytics
Output data of mentioned Analytics should follow TS 23.288 [5].
### 6.74.4 Procedures
Procedures of mentioned Analytics should follow TS 23.288 [5].
### 6.74.5 Impacts on services, entities and interfaces
AMF: consider NWDAF result when in selection of PCF, NSSAA, etc.
NSSF: consider NWDAF result when in selection of slice.
## 6.75 Solution #75: AF influencing NFs triggers for interactions with NWDAF
### 6.75.1 Description
This solution addresses Key Issue #13 \"Triggering conditions for analytics\"
with the specific focus on defining a solution for the following issues of
KI#13:
\- whether configuration for these triggers is needed;
\- whether changes to 5Gs architecture and services are needed to allow for
such configuration.
Recently, there has been an increase extension on the role of AFs influencing
different aspects of how 5GS controls the UEs and/or group of UEs related to
the AFs. Examples of the AF capabilities to influence 5GS for specific UEs
and/or group of UEs are providing: traffic and routing information, QoS
reference information for session management, specific charging requirements,
service parameters for UEs, among others. The main motivation is that AFs can
provide valuable information to 5GS, so that 5GS NFs can better make use of
its resources and provide adequate services to the UEs and/or group of UEs
related to such AFs. In this solution, we propose the same principle to be
applied for the selection of UEs and/or group of UEs to be considered during
the triggers for analytics IDs consumption by 5GS NFs.
This solution is applicable to scenario such as the one described below:
\- The scenario in which 5GS knows the behavior of the UE/group of UEs (e.g.,
UEs are a reduced range of mobility) while the AF knows why the UEs are
behaving like that due to its unique knowledge of the application level.
Therefore, AF can support 5GS to better use its resources when performing
analytics processes. For instance, the scenario considering 5G in a factory
service where robots (i.e., UEs) take certain (fixed) routes and some robots
may not be active for a long time or may be in standby to act as backups. From
a network perspective, all these UEs will be connected to the network
(eventually with minimal communication), but from an application perspective
AF knows about the UEs inactivity for the next few hours/days and can
therefore remove them from the generation of analytics IDs. This knowledge
allows AF to support 5GS to reduce data collection for UEs that have no major
role (are inactive from application perspective) on network utilization.
It is possible that NFs themselves can decide which UEs or group of UEs may be
used as target of analytics ID when such NFs subscribe/request analytics IDs
to NWDAF (e.g., as defined in Solution #45, in clause 6.45). Nevertheless, AF
may be the able to influence 5GS NFs triggering analytics subscription/request
on determining the specific UEs and/or group of UEs that should be included in
such request. When NFs decide to trigger analytics ID for a specific UE and/or
group of UE, such NF may take decisions on such UEs and/or group of UEs
treatment based on such analytics ID. As detailed in the scenario above, in
those case where the NFs might be able to select UEs to be included as target
of analytics reporting, but this selection does not consider the AF knowledge
about the reasons for the UE to behave in a certain observed way. Therefore,
this contribution aims at AF indicating to 5GS the UEs and/or group of UEs
that might not be useful to devote 5GS resources (such as data collection) to
include such UEs as target of analytics IDs.
We propose a new solution where AFs support NFs to select an appropriated set
of UEs and or group of UEs when triggering the subscription to analytics ID.
Such influence is related to AFs requesting to 5GS that certain UEs and/or
group of UEs should be removed or included on a request for analytics
information, when NFs trigger the request/subscription to NWDAF.
This solution may be used standalone or combined with other solutions already
defined in the present TR in order to refine the configuration information the
NFs require to trigger the proper subscription, request to analytics IDs.
The main principles of the solution are:
\- AFs provides the Analytics Subscription Information (ASI), which defines
the properties of analytics IDs for specific UES or group of UEs. The
properties are the request to include a restriction or to remove a restriction
for NFs to consume analytics IDs from NWDAF for the indicated UEs and/or group
of UEs controlled by the AF. The effect of removing a restriction is that NFs
are allowed once again to consume the analytics IDs for any UEs and/or group
of UEs that they determine as necessary.
\- AFs have no knowledge of which NFs should be associated with which ASI. The
AF has only the knowledge of which analytics IDs are associated with the
restricted and/or allowed UEs and/or group of UEs.
\- NFs have their own mechanisms to determine which analytics IDs they shall
request. The definition of such mechanisms is out of the scope of this
solution but is defined in other solutions in this TR.
\- NFs have their own mechanisms to determine the set of UEs or group of UEs
that should be included in the subscription to an analytics IDs.
\- The ASI information is a configuration information complementing the
internal logic of the NFs on the decision of which UEs and/or group of UEs
should be included in the subscription to analytics IDs of such NF.
\- The ASI information is independent of NFs. The ASI is associated to
analytics IDs. It contains a list of analytics ID and for each analytics IDs
it has the indication of the restrictions of UEs and/or group of UEs to be
used for such analytics IDs.
NOTE: An indication of a restricted analytics ID for a specific UE and/or
group of UE does not prevent a 5G NF to consume the same analytics ID for a
different set of UEs and/or group of UEs.
\- The analytics subscription information, is stored at UDM, and serve as
triggers for:
\- NFs to interact with NWDAF for analytics IDs when such NF is performing UE
registration, session management, UE mobility procedures as defined in TS
23.502 [3];
\- UDM to notify NFs about changes in the restrictions for analytics IDs for
specific UEs and/or group of UEs.
\- The UDM keeps the relationship of which NFs are related to which ASIs and
uses this information when it needs to provide a notification to NFs. This
relationship is established when NFs query UDM to check whether for a given
analytics ID there exist a related ASIs stored at UDM that should be taken
into consideration by the NF aiming at subscribing to such analytics ID.
### 6.75.2 Procedure
Figure 6.75.2-1: AF influencing consumption of analytics IDs for specific UEs
and/or group of UEs
NOTE 1: This procedure may need alignment with existing procedures for service
specific parameter provisioning from AF information to UDM.
There are two possible options for enabling the analytics subscription
information to be stored at UDM:
1a. (_Option 1: Via Configuration_) The analytics subscription information is
configured, stored, and maintained at UDM.
NOTE 2: If Step 1a is executed, the Steps 1b, 2 and 3 are skipped.
1b. (_Option 2: Via AF directly or indirectly with NEF support_) AFs provides
the analytics subscription information (ASI) to UDM, directly if AF is allowed
by operator to do so, or via NEF. UDM exposes services that can be invoked
with the following input parameters: identification of NF providing the ASI,
list of one or more restricted analytics IDs for specific UEs or group of UEs.
2\. UDM receives, stores, and maintains the analytics subscription information
based on interaction with AF (via NEF).
3\. UDM provides to AF (directly or via NEF) the identification of the ASI to
enable AF to change the properties of the analytics IDs or the list of UEs or
group of UEs associated with stored ASIs.
4\. One or more UEs are performing session establishment or UE registration or
UE mobility via interactions with 5GS.
5\. The NF (e.g., AMF if the UE is performing registration), or SMF when
performing PDU session setup for UEs), when selecting the list of UEs and/or
group of UEs to be included in the subscription to analytics IDs they are
configured to trigger, determines that there is an available ASI information
about the UE (or UEs, or groups of UEs). The NF invokes the service exposed by
UDM to retrieve the ASI associated with an analytics ID. The parameters
included in the request are a list of analytics IDs, identification of the UEs
and/or group of UEs, Notification Target Address and identification of the NF
requesting an ASI. The analytics ID is used to match to an existing ASI, while
the identification of the NF requesting an ASI is used by UDM in case steps 9
-- 11 need to be performed.
NOTE 3: AFs indicate to 5GS ASI per Analytics ID. Different NFs may be
configured by the operator to subscribe to different analytics IDs. When the
NFs are triggering subscription to their configured analytics ID, they check
with UDM whether there exist an ASI that can support them in the decision of
which UEs and/or group of UEs can be included as analytics target of the
analytics ID subscriptions to be triggered.
NOTE 4: Considering that the proposed procedure needs to be aligned with the
existing procedures for service provisioning AF information to UDM, the AM and
SM policy association procedures in TS 23.502 [3] need also to be aligned in
order to enable the ASI to reach AMF and SMF.
6\. UDM verifies if there exist ASIs related to the parameters included in the
received request from the NF.
7\. UDM provides a response to the NF based on the matching of the requested
fields and the maintained ASIs.
7a. If there is a match for to some or all of the fields in the request, UDM
sends to the NF the list of restricted analytics IDs for UEs and/or group of
UEs and the associated ASI.
7b. If there was not a match for any field, UDM sends to the NF an indication
of no applicable ASI for any of the requested fields.
NOTE 3: The NF might also receive the ASI in case of UE mobility from the
previous NF serving the UE or group of UEs, e.g., via UE context transfer. In
this case, the NF may not perform the steps 5 - 7.
8\. Based on the received information from UDM, the NF triggers interactions
with NWDAF.
8a. In case the NF receives an indication of no application ASI, the NF can
decide according to its internal logic or configuration to further request
analytics ID related to the UEs and/or group of UEs.
8b. In the case the NF receives one or more restricted analytics IDs for the
one or more UEs and/or group of UEs, the NF triggers subscriptions/request to
NWDAF taking into consideration the received restricted analytics IDs for
specific UEs and/or group of UEs.
NOTE 4: The operators may configure NFs with further mechanism to decide on
the enforcement (or not) of received restricted specific UEs and/or group of
UEs to be considered in the subscription to an analytics ID.
NOTE 5: The steps 9 - 11 may be executed in parallel to the steps 4 - 8.
9\. UDM receives updated ASI via configuration (9a) or via AF (9b). Examples
of updates on ASI are change the properties from imposed restriction to
removed restriction (or vice versa) on analytics IDs for a list of UEs and/or
group of UEs; or change the list of UEs and/or group of UEs for restricted
analytics IDs (i.e., include or remove UEs and/or group of UEs).
10\. UDM identifies the NF consumers of ASI that are affected by the updated
ASIs. UDM uses the Notification Target Address to interact with the identified
NF consumers of ASI to provide the updated restrictions.
11\. The one or more NFs that received the updated restrictions from UDM
further interact with NWDAF in order to comply with the updated restrictions
imposed or removed for its consumption to analytics IDs for UEs and/or group
of UEs.
### 6.75.3 Impacts on services, entities and interfaces
AF:
\- Provide analytics subscription information to 5GS
NEF:
\- New services to allow AF providing analytics subscription information to be
stored at UDM.
UDM:
\- New data structure for storing the analytics subscription information
\- New services or extension of existing services for interactions between UDM
and NFs to allow the analytics subscription information to serve as trigger
for NFs to consume analytics IDs from NWDAF for specific UEs and/or Group of
UEs.
AMF, SMF:
\- Retrieve or be notified about the requested or removed restrictions on
using specific UEs/ Group of UEs on the subscription to analytics ID, upon the
execution of session management procedures.
\- Extensions of the information exchanged between AMFs, SMFs, and PCFs to
support the exchange of the restriction to analytics IDs for specific UEs
and/or group of UEs during mobility procedures.
## 6.76 Solution #76: Revocation of user consent
### 6.76.1 Introduction
This solution addresses KI #15: User consent for UE data collection/analysis.
User consent may be required to process certain UE related data. User consent
may be collected and managed by the network operator and can be stored as part
of the subscription data in UDR. User consent can also be updated or revoked
at any time.
The proposed solution introduces a \"User consent Related Data Coordination
Functionality\" (URDCF) that is tracking the distribution and usage of any
user related information falling under the scope of user consent. If the user
consent is updated/revoked, the URDCF will take care to inform all entities
having received a copy of the UE/user related data and UE related Output
Analytics about the updated or revoked user consent and request them to delete
the data if the data is no longer covered by the user consent.
The URDCF logs Nnwdaf_AnalyticsInfo_Requests and
Nnwdaf_AnalyticsSubscription_Subscribe Request messages. If the URDCF becomes
aware of a revocation of user consent, the URDCF will check its logs to
identify past Data Consumers affected by this revocation. The URDCF will then
inform the identified Data Consumers about the revocation of the user consent
and will request them to delete the user related data as it is no longer
covered by a user consent.
The URDCF may be hosted by the NWDAF. Alternatively, the URDCF may be hosted
by a Data Collection Coordination Function (DCCF) or Data Collection NF (DCNF)
as described e.g. in solutions #9, #15, and #35 of the present document. The
following procedures show the URDCF as being hosted by the NWDAF(alternative
1) or by the DCCF (alternative 2).
### 6.76.2 Procedures
#### 6.76.2.1 Alternative 1: Data Request procedure with URDCF hosted by NWDAF
Figure 6.76.2.1-1 shows the Data Request procedure with URDCF hosted by NWDAF.
Figure 6.76.2.1-1: Data request procedure with URDCF hosted by NWDAF
1\. A Data Consumer / Analytics Consumer (e.g. NWDAF or NWDAF service
consumer) sends a Data / Analytics Request or Data / Analytics subscription
(e.g. Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe
Request) to the NWDAF with URDCF.
2\. If the requested Data is subject to user consent, the NWDAF with URDCF
needs to check whether user consent is available for this request. The NWDAF
with URDCF either already knows about the user consent (e.g. from a previous
request) or needs to check with the UDM to learn about the user consent
information available in the UDR subscription information. The NWDAF with
URDCF will further subscribe to UDM to receive notifications for the UE or
group of UEs related to changes on the user consent information.
3\. If the user consent is available and valid, the NWDAF sends Data
collection requests / Event subscriptions to one or multiple Data Source(s),
e.g. AF(s), NF(s), other NWDAF(s), depending on the Input Data required for
the requested Analytics ID.
4\. Data Source(s) provide the requested Data / Events to the NWDAF (e.g. as
Data response or as notifications related to the requested subscription). The
response / notify messages may also include a validity time indicating the
duration over which the Data may be stored / processed. At the expiry of this
validity time, any Data Consumer (including the NWDAF) needs to either delete
corresponding Data / Analytics, or needs to renegotiate a new validity time
with the Data Source.
5\. If the collected Data relates to UE related Data, where user consent had
not yet been checked in step 2, the NWDAF with URDCF needs to check whether
user consent is available for this request. The NWDAF either already knows
about the user consent (e.g. from a previous request) or needs to check with
the UDM to learn about the user consent information available in the UDR
subscription information.
6\. If the user consent is available, the NWDAF with URDCF keeps track of Data
/ Analytics Consumers that the NWDAF is providing UE related Data requiring
user consent. Therefore, the NWDAF with URDCF will keep a record of the Data
Consumer along with information to identify and contact the Data Consumer,
e.g. by a callback URI provided by the Data Consumer at step 1.
7\. If the user consent is available and valid, the Data Source provides the
requested Data to the Data Consumer (e.g. as Data response /
Nnwdaf_AnalyticsInfo_Request response or as notifications related to the
requested subscription). The response / notify message may also include a
validity time indicating the duration over which the user consent is valid. At
the expiry of this validity time, any Data Consumer needs to either delete
corresponding Data / Analytics, or needs to renegotiate a new validity time.
#### 6.76.2.2 Alternative 2: Data Request procedure with URDCF hosted by DCCF
Figure 6.76.2.2-1 shows the Data Request procedure with URDCF hosted by DCCF.
Figure 6.76.2.2-1: Data request procedure with URDCF hosted by DCCF
1\. A Data Consumer / Analytics Consumer (e.g. NWDAF or NWDAF service
consumer) sends a Data / Analytics Request or Data / Analytics subscription
(e.g. Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe
Request) to the Data Source via the DCCF with URDCF.
2\. If the requested Data is subject to user consent, the DCCF with URDCF
checks whether user consent is available for this request. The DCCF with URDCF
either already knows about the user consent (e.g. from a previous request) or
checks with the UDM to learn about the user consent information available in
the UDR subscription information. The DCCF with URDCF will further subscribe
to UDM to receive notifications for the UE or group of UEs related to changes
on the user consent information.
3\. If the user consent is available, the DCCF with URDCF keeps track of the
Data / Analytics Consumers that requested the UE related Data requiring user
consent. Therefore, the DCCF with URDCF will keep a record of the Data
Consumer along with information to identify and contact the Data Consumer,
e.g. by a callback URI provided by the Data Consumer at step 1.
4\. If user consent for the requested data / analytics is available and valid,
the DCCF sends the data collection requests / event subscriptions to a Data
Source (e.g. AF, NF, OAM and other NWDAF) that can provide the data /
analytics as requested in step 1.
5\. The Data Source provides the requested Data / Analytics / Events to the
Data Consumer / Analytics Consumer (e.g. as Data response or as notifications
related to the requested subscription). The response / notify messages may
also include a validity time indicating the duration over which the Data may
be stored / processed. At the expiry of this validity time, any Data Consumer
needs to either delete corresponding Data / Analytics, or needs to renegotiate
a new validity time with the Data Source.
#### 6.76.2.3 User consent revocation procedure
Figure 6.76.2.3-1 shows the procedure related to user consent revocation /
withdrawal for both alternative URDCF hosted by NWDAF (alternative 1) or URDCF
hosted by DCCF (alternative 2).
Figure 6.76.2.3-1: User consent revocation procedure
1\. NWDAF with URDCF (alternative 1) or DCCF with URDCF (alternative
2)receives Data / Analytic requests from the Data / Analytic Consumer. URDCF
checks the user consent for the requested/collected UE related Data. URDCF
registers with UDM to be notified about changes on the subscription
information related to user consent of the affected UE(s). URDCF keeps track
of Data / Analytics Consumers that requested/received UE related Data
requiring user consent. Step 1 is following the procedure as described in
clause 6.76.2.1 (alternative 1) or clause 6.7.2.2 (alternative 2) of the
present document.
2\. UDM determines that the user consent for a particular user has been
revoked.
3\. UDM notifies to the URDCF about the user consent revocation.
4\. Based on its historical records of Data / Analytics Consumers and the Data
provided to them, the URDCF will determine all Data Consumers to be notified
as they had requested some Data that is affected by the withdrawn user
consent.
5\. URDCF deletes any UE Data and/or Analytics related to the user that has
revoked his consent. The URDCF will also terminate any related subscriptions
with the Data Source(s) related to those Analytics.
6\. URDCF requests / notifies to all Data Consumers determined in step 5 to
delete any UE Data and/or Analytics related to the user that has revoked his
consent.
7\. Optionally, Data Consumers confirm to the URDCF that the UE related Data /
Analytics have been deleted.
### 6.76.3 Impacts on services, entities and interfaces
NWDAF:
\- For alternative 1: Hosts functionality (URDCF) to keep track of Data
requests / subscriptions and to notify Data Consumers about withdrawn user
consent.
DCCF:
\- For alternative 2: Hosts functionality (URDCF) to keep track of Data
requests / subscriptions and to notify Data Consumers about withdrawn user
consent.
Data Consumer (e.g. NWDAF, NF):
\- Delete user data if user consent validity time has expired or upon request
from URDCF if user consent was withdrawn.
## 6.77 Solution #77: NWDAF assisted Per Access Network Performance
### 6.77.1 Description
#### 6.77.1.1 Overview
This solution is for Key Issue #21 \"NWDAF assisting in user plane
performance\".
Steering mode in the ATSSS rules used by UE and Multi-Access Rule used by UPF
specified in TS 23.501 [2] identifies the steering mode that should be applied
for the matching traffic (\"Active-Standby\", \"Smallest Delay\", \"Load
Balancing\" or \"Priority-based\"). The ATSSS rules and Multi-Access Rule are
configured based on the MA PDU Session Control information in the PCC rules
that can be provided to the SMF by the PCF as specified in TS 23.503 [4].
Appropriate setting the Steering mode in the PCC rules can improve user plane
performance, e.g. the UL/DL throughput, the packet loss rate, the RTT, etc.
possibly per application.
For this, this solution proposes two alternatives:
\- Alternative#1: a new Analytics ID called \"Per Access Network
Performance\". NWDAF provides Per Access Network Performance (PANP) analytics
for 3GPP access and non-3GPP access, in the form of statistics or predictions,
to a service consumer.
\- Alternative#2: an extension of the existing Observed Service Experience
analytics defined in clause 6.4 of TS 23.288 [5].
The service consumer is PCF and based on the NWDAF analytics, the PCF can set
the Steering mode in the PCC rules.
#### 6.77.1.2 Alternative#1: a new \"Per Access Network Performance\"
analytics
The request by the service consumer includes mainly the following parameters:
\- Analytics ID = \"Per Access Network Performance\".
\- Target of Analytics Reporting: a single UE, a group of UEs or any UE.
\- Analytics Filter Information optionally containing:
\- S-NSSAI;
\- DNN;
\- Application ID;
\- Area of Interest (list of TA or Cells) which restricts the area in focus
(mandatory if Target of Analytics Reporting is set to \"any UE\", optional
otherwise);
\- Access Type(s), i.e. 3GPP access, non-3GPP access or both.
\- Analytics Target Period: the time period over which the statistics or
prediction are requested, either in the past or in the future.
Additionally, the input parameters described in clause 6.1.3 of TS 23.288 [5]
can be appropriately used for the request.
#### 6.77.1.3 Alternative#2: an extension of the existing Observed Service
Experience analytics
Regarding the parameters included in the request by the service consumer, the
parameters described in clause 6.4.1 of TS 23.288 [5] are used with the
following differences:
\- Area of Interest is mandatory if Target of Analytics Reporting is set to
\"any UE\".
\- Access Type(s) (i.e. 3GPP access, non-3GPP access or both) can be used as
the Analytics Filter Information.
### 6.77.2 Input Data
#### 6.77.2.1 Alternative#1: a new \"Per Access Network Performance\"
analytics
For the purpose of PANP analytics, the NWDAF collects the data as listed in
Table 6.77.2.1-1 and Table 6.77.2.1-2.
Table 6.77.2.1-1: Data collected from OAM by NWDAF for PANP analytics
* * *
Information Source Description Measurements OAM Performance Measurements that
will be used by the NWDAF to determine performance of 3GPP access and non-3GPP
access. Performance Measurements are related to data/information transfer over
the user plane and/or the control plane (e.g. Performance measurements for
gNB, N3IWF and UPF as defined in TS 28.552 [19]). The NWDAF may obtain
measurements by invoking management services that are defined in TS 28.532
[23] and TS 28.550 [24].
* * *
NWDAF subscribes the network data from OAM in the Table 6.77.2-1 by using the
services provided by OAM as described in clause 6.2.3 of TS 23.288 [5].
The data in Table 6.77.2.1-2 is based on existing ATSSS measurement framework
defined in TS 23.501 [2]. If UL measurements are needed UE needs to assist.
Table 6.77.2.1-2: Data collected from 5GC NFs by NWDAF for PANP analytics
* * *
Information Source Description UE ID SMF SUPI Group ID SMF Internal Group ID
S-NSSAI SMF Information to identify a Network Slice DNN SMF Data Network Name
where PDU connectivity service is provided Location AMF The UE location
information that NWDAF can use to derive the Area of Interest Communication
performance (1..max) UPF Communication performance per multi access PDU
session using periodical counters configured in the event subscription >
Access Type The Access Type that this communication is performed (i.e. 3GPP
access or non-3GPP access) > Round trip time measured at the UPF The observed
round trip time of this communication measured at UPF, when MPTCP or ATSSS low
level (only when smallest delay is enabled) NOTE: The NWDAF actions will not
activate the added measurement. The RTT data collected by the NWDAF from the
UPF will only re-use existing measurements activated by ATSSS measurement
framework.
* * *
#### 6.77.2.2 Alternative#2: an extension of the existing Observed Service
Experience analytics
The input data described in clause 6.4.2 of TS 23.288 [5] can be used with the
following extensions:
\- The data collected by the UPF described in Table 6.4.2-2 of TS 23.288 [5]
with addition for round trip time measured at UPF side, per Access Type (i.e.
for 3GPP access or for non-3GPP access).
NOTE 1: It is assumed that how NWDAF collects from UPF is not defined.
NOTE 2: The NWDAF actions will not activate the added measurement. The RTT
data collected by the NWDAF from the UPF will only re-use existing
measurements activated by ATSSS measurement framework.
### 6.77.3 Output Analytics
#### 6.77.3.1 Alternative#1: a new \"Per Access Network Performance\"
analytics
The NWDAF derives the PANP analytics, i.e. network performance level over each
access type for specific DNN, S-NSSAI, Application ID and/or area. Depending
on the Analytics Target Period, the output consists of statistics or
predictions. The detailed information provided by the NWDAF is defined in
Table 6.77.3.1-1 for statistics and Table 6.77.3.1-2 for predictions.
Table 6.77.3.1-1: Per Access Network Performance statistics
* * *
Information Description List of PANP Analytics (1..max)  
> Access Type Access Type that the analytics is applied (i.e. 3GPP access or
> non-3GPP access) > DNN DNN that the analytics is applied > S-NSSAI S-NSSAI
> that the analytics is applied > Applicable Area A list of TAIs or Cell IDs
> within the Location information that the analytics is applied > Applicable
> Time Period The time period that the analytics is applied > Network
> Performance Level Network Performance Level over the Access Type (e.g. 1 to
> 10 where the higher value indicates the better network performance) > Round
> trip time measured at UPF As measured on UPF side, according to input
* * *
Table 6.77.3.1-2: Per Access Network Performance predictions
* * *
Information Description List of PANP Analytics (1..max)  
> Access Type Access Type that the analytics is applied (i.e. 3GPP access or
> non-3GPP access) > DNN DNN that the analytics is applied > S-NSSAI S-NSSAI
> that the analytics is applied > Applicable Area A list of TAIs or Cell IDs
> within the Location information that the analytics is applied > Applicable
> Time Period The time period that the analytics is applied > Network
> Performance Level Network Performance Level over the Access Type (e.g. 1 to
> 10 where the higher value indicates the better network performance) > Round
> trip time measured at UPF As measured on UPF side, according to input >
> Confidence Confidence of the prediction.
* * *
#### 6.77.3.2 Alternative#2: an extension of the existing Observed Service
Experience analytics
The output analytics described in clause 6.4.3 of TS 23.288 [5] can be used
with the following extension:
\- Access Type information is added to indicate which access type the
analytics is applied to (i.e. 3GPP access or non-3GPP access).
### 6.77.4 Procedures
#### 6.77.4.1 Alternative#1: a new \"Per Access Network Performance\"
analytics
Figure 6.77.4.1-1 shows the procedure for Analytics for Per Access Network
Performance.
Figure 6.77.4.1-1: Analytics for Per Access Network Performance
1\. The PCF requests or subscribes to analytics information on \"Per Access
Network Performance\" provided by NWDAF.
The parameters included in the request are described in clause 6.77.1.2.
2\. The NWDAF collects the data specified in clause 6.77.2.1 from the OAM.
3\. The NWDAF collects the data specified in clause 6.77.2.1 from the 5GC NFs.
4\. With the data obtained in step 2 and step 4, the NWDAF derives requested
analytics.
5\. The NWDAF provides the analytics for Per Access Network Performance to the
PCF.
6-9. If the PCF subscribed to the analytics at step 1, when the NWDAF
generates new analytics, it provides the new generated analytics to the PCF.
In step 5 and step 9, when the PCF receives the analytics from the NWDAF, the
PCF can set the Steering mode in the PCC rules based on the analytics. As an
example, the following can be set by the PCF:
\- If the Network Performance Level over 3GPP access for App-1 is 6 and the
Network Performance Level over non 3GPP access for App-1 is 4, \"Steering
Mode: Load-Balancing, 3GPP=60%, non-3GPP=40%\" for App-1.
\- If the Network Performance Level over 3GPP access for App-1 is 3 and the
Network Performance Level over non 3GPP access for App-1 is 7, \"Steering
Mode: Active-Standby, Active=non 3GPP, Standby=3GPP\" for App-1.
\- If the Network Performance Level over 3GPP access for App-1 is 8 and the
Network Performance Level over non 3GPP access for App-1 is 2, \"Steering
Mode: Active-Standby, Active=3GPP, Standby=non 3GPP\" for App-1.
#### 6.77.4.2 Alternative#2: an extension of the existing Observed Service
Experience analytics
The procedures described in clause 6.4.4 and clause 6.4.5 of TS 23.288 [5] can
be used with PCF as a consumer NF.
The PCF may use the analytics provided by the NWDAF to set the Steering mode
in the MA PDU Session Control information in the PCC rules. As an example, the
following can be set by the PCF:
\- If the average observed service experience over 3GPP access for App-1 is
higher than the average observed service experience over non 3GPP access for
App-1, \"Steering Mode: Load-Balancing, 3GPP=xx%, non-3GPP=yy%\" for App-1
where xx can be set higher than yy.
\- If the average observed service experience over 3GPP access for App-1 is
lower than the average observed service experience over non 3GPP access for
App-1, \"Steering Mode: Active-Standby, Active=non 3GPP, Standby=3GPP\" for
App-1.
\- If the average observed service experience over 3GPP access for App-1 is
higher than the average observed service experience over non 3GPP access for
App-1, \"Steering Mode: Active-Standby, Active=3GPP, Standby=non 3GPP\" for
App-1.
### 6.77.5 Impacts on services, entities and interfaces
#### 6.77.5.1 Alternative#1: a new \"Per Access Network Performance\"
analytics
NWDAF:
\- supports a new Analytics ID = \"Per Access Network Performance\".
PCF:
\- supports service consumer functionality for a new Analytics ID = \"Per
Access Network Performance\".
UPF:
\- provides data related to communication performance per Access Type.
NOTE: It is assumed that how NWDAF collects the data from UPF is not defined.
#### 6.77.5.2 Alternative#2: an extension of the existing Observed Service
Experience analytics
NWDAF:
\- Enhancement to provide extended Observed Service Experience analytics per
access type.
PCF:
\- Enhancement to internally use the extended Observed Service Experience
analytics to set the Steering mode in the MA PDU Session Control information
in the PCC rules.
UPF:
\- provides some data per Access Type for the extended Observed Service
Experience analytics.
NOTE: It is assumed that how NWDAF collects the data from UPF is not defined.
# 7 Overall Evaluation
## 7.0 Summary of analytics provided by NWDAF
Various solutions proposed in the present document propose to enhance existing
Analytics as defined in TS 23.288 [5] or propose to define new Analytics to be
supported by NWDAF. Other solutions however propose to re-use existing
analytics as defined in TS 23.288 [5].
Table 7.0-1 is listing solutions proposing a new Analytics (which might be
based on some existing Analytics, but a new Analytics ID is proposed to be
defined):
Table 7.0-1: Solutions proposing new Analytics ID
+----------------------------------+----------------------------------+ | Solution | Proposed Analytics | +----------------------------------+----------------------------------+ | #4 | Service in use analytics | | | (Solution #43 is hereinto | | | merged) | +----------------------------------+----------------------------------+ | #28 | UE\'s usage of network slice | | | analytics | +----------------------------------+----------------------------------+ | #29 | Application status analytics | +----------------------------------+----------------------------------+ | #30 | Data dispersion analytics, | | | | | | Transaction dispersion | | | analytics, | | | | | | Transaction failure dispersion | | | analytics, | | | | | | Dropped sessions dispersion | | | analytics, | | | | | | Voice calls dispersion | | | analytics. | +----------------------------------+----------------------------------+ | #31 | Service experience analytics per | | | UP path (Solution #49 - | | | Alternative 2 is hereinto | | | merged). | +----------------------------------+----------------------------------+ | #41 | Radio/frequency usage analytics. | +----------------------------------+----------------------------------+ | #42 | RFSP index usage analytics (see | | | note 1). | +----------------------------------+----------------------------------+ | #44 | Session management congestion | | | control experience analytics. | +----------------------------------+----------------------------------+ | #46 | New application detection | | | analytics. | +----------------------------------+----------------------------------+ | #47 | UE presence pattern in LADN | | | service area analytics | | | (Alternative 1). | +----------------------------------+----------------------------------+ | #48 | DN performance analytics | | | (Solutions #49 -- Alternative | | | 1, #50 are hereinto merged) | +----------------------------------+----------------------------------+ | #49 | Application server performance | | | analytics (Alternative 1). | +----------------------------------+----------------------------------+ | #50 | Data network performance | | | analytics. | +----------------------------------+----------------------------------+ | #62 | WLAN performance and WLAN SP | | | analytics. | +----------------------------------+----------------------------------+ | #68 | Redundant transmission | | | experience analytics. | +----------------------------------+----------------------------------+ | #77 | Per access network performance | | | analytics (Alternative 1). | +----------------------------------+----------------------------------+ | NOTE 1: Solution #42 does not | | | list the input data and output | | | analytics as a table. | | +----------------------------------+----------------------------------+
Table 7.0-2 is listing solutions proposing to enhance an existing Analytics
(i.e. no new Analytics ID is proposed). The enhancement may be proposed for
input data and/or output analytics:
Table 7.0-2: Solutions proposing to enhance existing Analytics IDs
+----------------------------------+----------------------------------+ | Solution | Proposed Analytics | +----------------------------------+----------------------------------+ | #2 | Slice load level analytics (as | | | defined in clause 6.3, | | | TS 23.288 [5]). See note 1. | +----------------------------------+----------------------------------+ | #4 | Observed service experience | | | analytics -- extended input data | | | (subscriber category) and output | | | analytics to provide Service | | | Experience per RAT type and | | | Frequency (Solution #43 is | | | hereinto merged) | +----------------------------------+----------------------------------+ | #29 | NF load analytics (as defined in | | | clause 6.5, TS 23.288 [5]), | | | extended by UE input data and | | | providing load information for | | | each NF instance in the area of | | | interest. | +----------------------------------+----------------------------------+ | #43 | Observed service experience per | | | RAT type and frequency analytics | | | | | | (based on Observed service | | | experience analytics as defined | | | in clause 6.4, TS 23.288 [5]). | +----------------------------------+----------------------------------+ | #47 | UE Mobility analytics (as | | | defined in clause 6.7.2 of | | | TS 23.288 [5]),\ | | | extended with LADN DNN to | | | indicate Area of Interest as | | | Analytics Filter Information | | | (Alternative 2). | +----------------------------------+----------------------------------+ | #49 | Application server performance | | | analytics (Alternative 2): | | | Observed Service Experience | | | analytics extended by including | | | new input data from AF and | | | providing in the output | | | analytics service experience per | | | Application Server instance. | +----------------------------------+----------------------------------+ | #61 | QoS Sustainability analytics (as | | | defined in clause 6.9.2, | | | TS 23.288 [5]) extended by the | | | Application ID and respective | | | KPIs in the input data and | | | providing a list of top ten | | | applications contributing the | | | most traffic in the Output | | | Analytics. Observed service | | | experience (as defined in | | | clause 6.4, TS 23.288 [5]) is | | | extended with new input data and | | | analytics filter. | +----------------------------------+----------------------------------+ | #63 | Observed service experience | | | analytics (as defined in | | | clause 6.4, TS 23.288 [5]), | | | | | | extended by UE input data. | +----------------------------------+----------------------------------+ | #67 | UE communications analytics (as | | | defined in clause 6.7.3, | | | TS 23.288 [5]), | | | | | | extended by additional input | | | data and the session inactivity | | | timer associated to the user | | | plane connection as output | | | analytics. | +----------------------------------+----------------------------------+ | #77 | Observed service experience | | | analytics (as defined in | | | clause 6.4, TS 23.288 [5]) -- | | | Alternative 2; extended by the | | | data collected by the UPF | | | described in Table 6.4.2-2 of | | | TS 23.288 [5] with addition | | | for round trip time measured at | | | UPF per Access Type and the | | | output analytics with Access | | | Type information indicating | | | which access type the analytics | | | is applied to. | +----------------------------------+----------------------------------+ | NOTE 1: Input and output data | | | was not yet defined for the | | | slice load level analytics in | | | Rel-16. | | +----------------------------------+----------------------------------+
Table 7.0-3 is listing solutions proposing to re-use an existing Analytics.
Table 7.0-3: Solutions proposing to re-use existing Analytics IDs
* * *
Solution Proposed Analytics #2 Observed service experience analytics for a
Network Slice (as defined in clause 6.4, TS 23.288 [5]). #25 UE mobility
analytics (as defined in clause 6.7.2, TS 23.288 [5]) #36 Observed service
experience analytics (as defined in clause 6.4, TS 23.288 [5]). #40 User data
congestion analytics (as defined in clause 6.8, TS 23.288 [5]). #51 Observed
service experience analytics (as defined in clause 6.4, TS 23.288 [5]).
* * *
## 7.1 Key Issue #1: Logical decomposition of NWDAF and possible interactions
between logical functions
According to the Table 7.1-1, solution#5, #6, #7, #8, #9, #35, #39, #56 and
#69 are proposed for Key Issue 1.
The different solutions proposed for Key Issue #1 present alternatives for
NWDAF functional decomposition. A total of nine solutions address Key Issue
#1, but it is worth noting that some of these solutions also address other
closely related Key Issues, namely Key Issue #2, Key Issue #11 and Key Issue
#19.
Key aspects in the evaluation of Key Issue #1 are the following:
\- The number of entities decomposing NWDAF and their functionality.
\- The standardization effort required to provide new services offered by the
decomposed functionalities.
Hence, in performing the evaluation the above two aspects are determined for
all proposed solutions.
Table 7.1-1 proposes an evaluation framework for Key Issue #1 indicating NWDAF
decomposed functionality and required standardization support. The following
clarifications on Table 7.1-1 apply:
\- The table columns show all potentially decomposable NWDAF functionality
mentioned across the proposed solutions, but not all solutions necessarily
refer to all functionality mentioned in Table 7.1-1. When the functionality is
not mentioned in the solution description, \'-\' applies. In addition,
different solutions may propose different names for each functionality.
\- When a solution addresses other key issues in addition to Key Issue #1, it
is mentioned in the first column of Table 7.1-1.
\- Different understandings exist on whether the decomposed functionality is
still part of NWDAF. When the decomposed functionality is mentioned but it is
proposed to be part of NWDAF, the name of the corresponding functional entity
in NWDAF is shown by its acronym in parenthesis (e.g. NWDAF (AF)).
\- Some solutions do not explicitly refer to a model repository functionality,
but they assume pre-trained models (i.e. ML models that have not been trained
yet) can be stored in and retrieved from certain entity. If that is the case,
such entity is shown performing model repository functionality in Table 7.1-1.
\- The standardization impact of any decomposed functionality shown in Table
7.1-1 refers to the need to support new standardized services. Hence, for each
decomposable functionality it is shown whether new standardized services i)
are required (*), ii) are not required (**) or iii) are out of the scope of
3GPP (***). Data collection is not analysed in this respect as it should be
done in the scope of KI#11.
Table 7.1-1: Summary of NWDAF functional decomposition solutions
+---------+---------+---------+---------+---------+---------+---------+ | S | _Data | Model | T | In | An | | | olution | coll | rep | raining | ference | alytics | | | | ection_ | ository | | | e | | | | | | | | xposure | | | | _[KI | | | | | | | | #11]_ | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | 5 | _NWDAF_ | AIF* | AIF* | NW | NW | | | | | | | DAF** | DAF** | | | (KI | | | | | | | | #19) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | 6 | Opt. 1 | _NWDAF_ | ML | NWDAF | NWDAF | NWDAF | | | | | designe | ( | (AF)* | ( | | | | | r*** | MMTF)* | | AF)** | +---------+---------+---------+---------+---------+---------+---------+ | | Opt. 2 | _data | | MMTF: | AF: | AF: | | | | repo | | ML | An | An | | | | sitory_ | | Model | alytics | alytics | | | | | | T | F | F | | | | | | raining | unction | unction | | | | | | F | | | | | | | | unction | | | +---------+---------+---------+---------+---------+---------+---------+ | 7 | _NWDAF | - | NWDAF | NWDAF | NWDAF | | | | (DC)_ | | (TF)* | (IF)* | ( | | | | | | | | IF)** | | | | DC: | | TF: | IF: | | | | | Data | | T | In | IF: | | | | Col | | raining | ference | In | | | | lection | | F | F | ference | | | | | | unction | unction | F | | | | | | | | unction | | +---------+---------+---------+---------+---------+---------+---------+ | 8 | _DC/_ | - | MT*/ | AC*/ | AC*/ | | | | | | | | | | | | _NWDAF | | NWDAF | NWDAF | NWDAF | | | | (DC)_ | | (MT)* | ( | ( | | | | | | | AC)** | AC)** | | +---------+---------+---------+---------+---------+---------+---------+ | 9 | _DCCF,_ | - | - | - | NWDAF | | | | | | | | ( | | | (KIs | _Data | | | | AF)** | | | #2, | repo | | | | | | | #11) | sitory_ | | | | AF: | | | | | | | | An | | | | | | | | alytics | | | | | | | | F | | | | | | | | unction | | +---------+---------+---------+---------+---------+---------+---------+ | 35 | _DCNF_ | - | - | - | NW | | | | | | | | DAF** | | | (KIs | | | | | | | | #2, | | | | | | | | #11) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | 39 | _DRSF_ | - | - | - | NW | | | | | | | | DAF** | | | (KIs | | | | | | | | #2, | | | | | | | | #11) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | 56 | _-_ | - | NWDAF* | NWDAF* | - | | | | | | | | | | | (KIs | | | | | | | | #2, | | | | | | | | #19) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | 69 | _NWDAF_ | - | - | - | NW | | | | | | | | DAF** | | | (KIs | | | | | | | | #2 | | | | | | | | ,#11) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+
NOTE 1: The two options proposed by Solution #6 differ on how the Analytics
Function receives the provided trained ML models but the differentiation does
not affect Table 7.1-1.
Based on Table 7.1-1, the following statements can be made regarding NWDAF
functional decomposition:
\- Inference functionality and analytics exposure functionality are provided
by the same functional entity in all solutions proposing these
functionalities. All solutions allow NWDAF to host both functionalities. No
specific standardization support of new services is required for these
functionalities by any solution.
\- All solutions describing both training and inference functionality
(Solutions #5, #6, #7, #8, #56) allow for NWDAF to host it.
\- Three solutions describing both training and inference (Solution #6,
Solution #7 and Solution #8) propose separate functional entities within NWDAF
to carry out each functionality.
\- All solutions describing training functionality (Solutions #5, #6, #7, #8,
#56) assume standardization impact due to new services required for training
support.
\- All solutions describing inference functionality (Solutions #5, #6, #7, #8,
#56) assume no standardization impact due to inference support.
\- Two solutions describe functional entities for model repository (Solutions
#5, #6). Solution #5 assumes standardization impact and Solution #6 proposes
two options with both standardization impact and absence thereof.
NOTE 2: Whether a dedicated entity for data collection is required and whether
specific standardization support for that entity is required is in the scope
of KI#11.
NOTE 3: The sharing of trained models among NWDAF instances is in the scope of
KI#19, so any decision on training and inference decomposition needs to be
compatible with KI#19 conclusion and vice versa.
NOTE 4: Table 7.1-1 does not take into account impacts on NRF related services
resulting from the decomposition.
## 7.2 Key Issue #2: Multiple NWDAF instances
### 7.2.1 Solution categorisation
This clause lists all solutions mapped to solution #2 and provides an overview
of key aspects of the solutions. The solutions are thereby categorized into
different groups based on the aspects that they address.
Table 7.2.1.1 provides a list of key aspects described in the solutions,
identifies the main Key Issue related to this particular aspect, and lists
solutions that cover this aspect.
Table 7.2.1.1: Solutions introducing hierarchical NWDAF deployment
* * *
Key aspect of the solution Addressing KI Suggestive solution mapping
Data Collection / Data Collection Coordination Function, Data Storage Function
KI#11\ Sol. #9, #15, #22, #35, #39 (see clause 7.11)
Efficient data collection (without dedicated Function) KI#11 Sol. #16, #18,
#58
Hierarchical NWDAF architecture with focus on interaction of NWDAFs (see Table
7.2.2-1) K#2 Sol. #11, #16, #17, #18, #53
Hierarchical NWDAF architecture with focus on Analytics / data aggregation
(see Table 7.2.2-2) KI#2 Sol. #10, #12, #14, #19, #21, #23, #60, #69
Reselection Aspects (see Table 7.2.2-3) KI#2 Sol. #10 (clause 6.10.2.4), #26,
#57, #59
Specific aspects of NWDAF interactions (see Table 7.2.2-4):
NWDAF parameter coordination KI#2 Sol. #13, Sol. #19
Abnormal Behaviour interactions KI#2 Sol. #20
Federated Learning, Trained ML model sharing KI#2, KI#19 Sol. #24, #56
Exposing UE mobility analytics KI#2 Sol. #25
* * *
### 7.2.2 Solution evaluation per category
#### 7.2.2.1 Introduction
Solutions #9, #15, #22, #35, #39, and #58 assume a setup with multiple NWDAF
instances, therefore are marked as related to Key Issue #2, while the
solutions mainly concern introducing a functionality or new NF targeting
efficient data collection, storage, and/or coordination. These solutions can
be applied to any kind of multiple NWDAF deployment. The solutions should be
discussed in detail as part of evaluation on Key Issue #11, and therefore are
skipped in this evaluation on Key Issue #2 related aspects.
#### 7.2.2.2 Multiple NWDAF architecture and Analytics aggregation
Table 7.2.2-1 lists solutions focusing on the interaction of NWDAFs in a
hierarchical NWDAF architecture, in order to support collection and
aggregation of data and/or Analytics at higher layer / Central NWDAFs:
\- Column \"Architecture\" indicates whether the solution assumes a
distributed and/or hierarchical NWDAF architecture.
\- Column \"Data collection and/or Analytics aggregation\" indicates whether
the solution targets collection and/or aggregation of data and/or Analytics.
\- Column \"Impacts to NWDAF\" indicates changes required to the NWDAF as
specified in Rel-16.
\- Column \"Impacts to NWDAF registration\" indicates where the NWDAF
registers (e.g. in NRF, UDM) its capabilities. This is in addition to
\"regular\" NWDAF registration in NRF like any other NF. The column lists
additional information registered for the NWDAF besides the information
already specified in TS 23.288 [5].
\- Column \"Impacts to other entities\" lists impacts to other NFs than NWDAF
and NRF.
NOTE 1: The solutions use different terminology to indicate whether an NWDAF
is on a higher / top / upper / 1st layer vs. lower / bottom / 2^nd^ layer of
the hierarchy, while other solutions use \"central NWDAF\" vs \"distributed
NWDAF\". Table 7.2.2.2-1 tries to align the terminology used in the different
solutions.
Table 7.2.2.2-1: Solutions focusing on the NWDAF interactions in hierarchical
NWDAF architecture
+----------+----------+----------+----------+----------+----------+ | Sol# | Arch | Data | Impacts | Impacts | Impacts | | | itecture | co | to NWDAF | to NWDAF | to other | | | | llection | | regi | entities | | | | and/or | | stration | | | | | A | | | | | | | nalytics | | | | | | | Agg | | | | | | | regation | | | | +----------+----------+----------+----------+----------+----------+ | 11 | Hier | Top | Top | Top | | | | archical | layer | layer | layer | | | | (2 | NWDAF | NWDAF | NWDAF | | | | layers). | collects | r | r | | | | | and | egisters | egisters | | | | Low | ag | low | in NRF. | | | | layer | gregates | layer | | | | | NWDAFs | A | NWDAFs | Low | | | | serve | nalytics | and | layer | | | | specific | from | controls | NWDAF | | | | NFs. | dis | their | r | | | | | tributed | coop | egisters | | | | | NWDAFs. | eration. | with top | | | | | | | layer | | | | | | | NWDAF or | | | | | | | with | | | | | | | NRF. | | +----------+----------+----------+----------+----------+----------+ | 16 | Hier | Higher | Coor | NWDAFs | NWDAF | | | archical | layer | dination | query | service | | | with | NWDAF | for data | NRF to | c | | | dynamic | can | co | identify | onsumers | | | NWDAF to | perform | llection | other | s | | | h | data | using | NWDAFs | ubscribe | | | ierarchy | co | \"local | in upper | to | | | mapping. | llection | mapping | and | [lo | | | | on | mech | lower | wer]{.un | | | | behalf | anism\". | layers. | derline} | | | | of lower | | | layer | | | | layer | DCCF | | NWDAF. | | | | NWDAFs | functi | | | | | | if | onality. | | | | | | multiple | See Note | | | | | | NWDAF in | 1. | | | | | | lower | | | | | | | layer | Expose | | | | | | need the | c | | | | | | data. | ollected | | | | | | | data. | | | | | | | | | | | | | | Maintain | | | | | | | h | | | | | | | ierarchy | | | | | | | info | | | | | | | rmation. | | | +----------+----------+----------+----------+----------+----------+ | 17 | Hier | Higher | Expose | NRF is | | | | archical | layer | c | extended | | | | with | NWDAF | ollected | to | | | | dynamic | collects | data. | identify | | | | NWDAF to | plain | | the | | | | h | data | A | lowest | | | | ierarchy | (mode | ggregate | possible | | | | mapping. | #1), | An | NWDAF in | | | | | ag | alytics. | the | | | | | gregated | | h | | | | | data | | ierarchy | | | | | (mode | | matching | | | | | #2), | | the | | | | | A | | consumer | | | | | nalytics | | request. | | | | | Output | | | | | | | (mode | | | | | | | #3), or | | | | | | | a mix | | | | | | | (mode | | | | | | | #4). | | | | +----------+----------+----------+----------+----------+----------+ | 18 | Hier | Higher | Coor | NWDAFs | NWDAF | | | archical | layer | dination | query | service | | | with | NWDAF | for data | NRF to | c | | | dynamic | may | co | identify | onsumers | | | NWDAF to | obtain | llection | other | s | | | h | data | using | NWDAFs | ubscribe | | | ierarchy | from | \"local | in upper | to | | | mapping. | lower | mapping | and | [ | | | | layer | mech | lower | top]{.un | | | | NWDAFs | anism\". | levels. | derline} | | | | if data | | | layer | | | | is | DCCF | | NWDAF. | | | | already | functi | | | | | | c | onality. | | | | | | ollected | See Note | | | | | | in lower | 2. | | | | | | layer | | | | | | | NWDAFs. | Expose | | | | | | | c | | | | | | | ollected | | | | | | | data. | | | | | | | | | | | | | | Maintain | | | | | | | h | | | | | | | ierarchy | | | | | | | info | | | | | | | rmation. | | | +----------+----------+----------+----------+----------+----------+ | 53 | Dis | Option | Exchange | | | | | tributed | 1: | profile, | | | | | or | Central | load | | | | | hiera | NWDAF | inf | | | | | rchical. | collects | ormation | | | | | | a | with | | | | | | nalytics | other | | | | | | and/or | NWDAF. | | | | | | data | | | | | | | from | Transfer | | | | | | dis | a | | | | | | tributed | nalytics | | | | | | NWDAFs. | data and | | | | | | | c | | | | | | Option | ollected | | | | | | 2: | data. | | | | | | Dis | | | | | | | tributed | | | | | | | NWDAFs | | | | | | | c | | | | | | | ooperate | | | | | | | with | | | | | | | each | | | | | | | other. | | | | | | | | | | | | | | See note | | | | | | | y. | | | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | The | | | | | | | aspect | | | | | | | of | | | | | | | \"DCCF\" | | | | | | | is | | | | | | | proposed | | | | | | | to be | | | | | | | studied | | | | | | | in | | | | | | | clause | | | | | | | 7.11. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The | | | | | | | solution | | | | | | | in | | | | | | | troduces | | | | | | | a | | | | | | | hier | | | | | | | archical | | | | | | | vs. | | | | | | | dis | | | | | | | tributed | | | | | | | NWDAF | | | | | | | archi | | | | | | | tecture, | | | | | | | while it | | | | | | | does not | | | | | | | provide | | | | | | | details | | | | | | | on the | | | | | | | coor | | | | | | | dination | | | | | | | among | | | | | | | NWDAF | | | | | | | in | | | | | | | stances. | | | | | | +----------+----------+----------+----------+----------+----------+
Table 7.2.2.2-2 lists solutions that are focusing on the Analytics / data
aggregation in a hierarchical NWDAF architecture. In these solutions, some of
the NWDAFs in one network may be providing the same type of analytics, and so
may help each other for e.g. specific analytics for specific target UEs or
specific analytics for specific area of interest. Thereby, e.g., a Central/
Higher NWDAF may aggregate analytics per analytics ID from lower layer /
distributed NWDAFs, each covering specific TAs out of the area of interest for
the NWDAF service consumer.
NOTE 2: In the solutions referring to Central vs. distributed NWDAFs, a
Central NWDAF can be \"the distributed NWDAF\" in another Central NWDAF \-
distributed NWDAF relationship, therefore, the number of layers in the
hierarchy is not limited to 2 layers.
Table 7.2.2.2-2: Solutions focusing on Analytics / data aggregation in
hierarchical NWDAF architecture
+-------+----------+----------+----------+----------+----------+ | Sol# | Arch | Data | Impacts | Impacts | Impacts | | | itecture | co | to NWDAF | to NWDAF | to other | | | | llection | | regi | entities | | | | and/or | | stration | | | | | A | | | | | | | nalytics | | | | | | | Agg | | | | | | | regation | | | | +-------+----------+----------+----------+----------+----------+ | 10 | Dis | Cen | Add | Ad | NWDAF | | | tributed | tral/dis | A | ditional | service | | | or | tributed | nalytics | regi | c | | | hiera | NWDAF | ID | stration | onsumer: | | | rchical. | collects | /request | in UDM | discover | | | | and | for UE | for UE | NWDAF | | | | ag | related | related | serving | | | | gregates | A | An | a UE. | | | | A | nalytics | alytics\ | | | | | nalytics | in | (regi | PCF: | | | | and | request | stration | Extend | | | | related | to DCCF. | includes | Npcf_ | | | | metadata | | UE IDs | AMPolicy | | | | from | Distr. | it is | Control | | | | dis | NWDAF is | s | and | | | | tributed | close to | erving). | Npcf_ | | | | NWDAFs. | data | | SMPolicy | | | | | source | Enhanced | Control. | | | | Works | and may | Nu | | | | | with and | purge | dm_UECM | AMF + | | | | without | data/st | pr | SMF: | | | | DCCF. | atistics | ocedure. | Report | | | | | if | | NWDAF | | | | | subs | | serving | | | | | cription | | the UE | | | | | is | | to the | | | | | ter | | PCF. | | | | | minated. | | | | | | | | | | | | | | Central | | | | | | | NWDAF | | | | | | | may | | | | | | | collect | | | | | | | data/a | | | | | | | nalytics | | | | | | | for | | | | | | | longer | | | | | | | time. | | | +-------+----------+----------+----------+----------+----------+ | 12 | Hiera | Higher | Register | NWDAF | | | | rchical. | layer | capa | r | | | | | NWDAF | bilities | egisters | | | | Low | collects | and | its | | | | layer | and | co | capa | | | | NWDAFs | ag | -located | bilities | | | | are | gregates | NFs in | in NRF | | | | co | A | NRF. | (e.g. | | | | -located | nalytics | | data | | | | with NF. | from | A | col | | | | | lower | ggregate | lection, | | | | | layer | a | data | | | | | NWDAFs. | nalytics | storage, | | | | | | data. | t | | | | | | | raining, | | | | | | Expose | a | | | | | | c | nalytics | | | | | | ollected | gene | | | | | | data. | ration). | | +-------+----------+----------+----------+----------+----------+ | 14 | Dis | Option | A | NWDAF | NWDAF | | | tributed | A: NWDAF | ggregate | r | service | | | (option | consumer | A | egisters | consumer | | | A) or | ag | nalytics | its | does | | | hier | gregates | (except | capa | A | | | archical | An | option | bilities | nalytics | | | (other | alytics. | A). | in NRF | agg | | | o | | | (except | regation | | | ptions). | Other | | option | (options | | | | options: | | A). | A, F) or | | | | Central | | | provides | | | | NWDAF | | | list of | | | | collects | | | ap | | | | and | | | plicable | | | | ag | | | dis | | | | gregates | | | tributed | | | | A | | | NWDAFs | | | | nalytics | | | in | | | | from | | | request | | | | dis | | | to | | | | tributed | | | Central | | | | NWDAFs. | | | NWDAF | | | | | | | (options | | | | | | | B and | | | | | | | C). | +-------+----------+----------+----------+----------+----------+ | 19 | Hiera | Central | A | | NWDAF | | | rchical. | NWDAF | ggregate | | service | | | | collects | An | | c | | | | and | alytics. | | onsumers | | | | ag | | | (if | | | | gregates | Support | | capable | | | | A | A | | to | | | | nalytics | nalytics | | a | | | | from | agg | | ggregate | | | | dis | regation | | multiple | | | | tributed | with | | a | | | | NWDAFs. | dataset | | nalytics | | | | | sta | | outputs) | | | | | tistical | | may | | | | | pr | | s | | | | | operties | | ubscribe | | | | | and | | to | | | | | output | | multiple | | | | | s | | NWDAFs | | | | | trategy. | | with | | | | | | | baseline | | | | | | | par | | | | | | | ameters. | +-------+----------+----------+----------+----------+----------+ | 21 | Hiera | Higher | NWDAF | Add NF | | | | rchical. | layer | Profile | instance | | | | | NWDAF | includes | ID to | | | | Low | collects | NF ID | NWDAF | | | | layer | pre-p | when | Profile | | | | NWDAFs | rocessed | co | in NRF. | | | | are | data | -located | | | | | co | from | with a | | | | | -located | lower | NF. | | | | | with NF. | layer | | | | | | | NWDAFs. | Expose | | | | | | | c | | | | | | | ollected | | | | | | | and | | | | | | | pre-p | | | | | | | rocessed | | | | | | | data on | | | | | | | behalf | | | | | | | of | | | | | | | co | | | | | | | -located | | | | | | | NF. | | | +-------+----------+----------+----------+----------+----------+ | 23 | Hiera | Central | Expose | | | | | rchical. | NWDAF | c | | | | | | collects | ollected | | | | | | data | data. | | | | | | and/or | | | | | | | a | | | | | | | nalytics | | | | | | | from | | | | | | | dis | | | | | | | tributed | | | | | | | NWDAFs. | | | | +-------+----------+----------+----------+----------+----------+ | 60 | Hiera | Central | A | Register | | | | rchical. | NWDAF | ggregate | Agg | | | | | collects | A | regation | | | | | and | nalytics | and/or | | | | | ag | using | metadata | | | | | gregates | a | exposure | | | | | A | nalytics | cap | | | | | nalytics | m | ability. | | | | | and | etadata. | | | | | | related | | | | | | | metadata | Expose | | | | | | from | a | | | | | | dis | nalytics | | | | | | tributed | m | | | | | | NWDAFs. | etadata. | | | +-------+----------+----------+----------+----------+----------+ | 69 | Dis | Central | Support | Ad | NWDAF | | | tributed | NWDAF | 2-layer | ditional | service | | | or | collects | hi | regi | c | | | hiera | and | erarchy. | stration | onsumer: | | | rchical. | ag | | in UDM | discover | | | | gregates | Distr. | for UE | NWDAF | | | D | A | NWDAF is | related | serving | | | isallows | nalytics | close to | A | a UE. | | | ove | from | data | nalytics | | | | rlapping | dis | source, | (regi | PCF: | | | serving | tributed | focuses | stration | Extend | | | areas | NWDAFs. | on UPF, | includes | Npcf_ | | | for | | and may | UE IDs | AMPolicy | | | dis | Central | purge | it is | Control | | | tributed | NWDAF | data/st | s | and | | | NWDAFs. | may | atistics | erving). | Npcf_ | | | | collect | if the | | SMPolicy | | | | data/a | subs | Enhanced | Control. | | | | nalytics | cription | Nu | | | | | for | is | dm_UECM | SMF: | | | | non | ter | pr | Report | | | | -latency | minated. | ocedure. | the | | | | s | | | NWDAF | | | | ensitive | | | serving | | | | use | | | the UE | | | | cases. | | | to the | | | | | | | PCF. | +-------+----------+----------+----------+----------+----------+
From table 7.2.2.2-1 and table 7.2.2.2-2, the following observations are made:
\- Observation O1: Most solutions apply a hierarchical NWDAF architecture with
at least 2 layers. Solutions #14 (option A) and #53 also describe an option
allowing for a flat NWDAF architecture.
\- Observation O2: Most solutions support a dynamic NWDAF architecture.
Solutions #16, #17, #18 support a static NWDAF hierarchy with a dynamic NWDAF
to hierarchy mapping. Solutions #12, #14, #23, #53 explicitly mention about
the possibility to do some pre-configuration of the NWDAF instances, e.g.
based on operator\'s policy to serve a specific set of entities, while this is
assumed to also be possible for other solutions.
\- Observation O3: Solutions #10, #11, #12, #14, #17, #19, #23, #24, #53, #60
describe collection and aggregation of Analytics Output from other NWDAFs.
Solutions #10, #19 and #60 in addition describe the exchange of Aggregation
metadata (e.g. Dataset statistical properties, output strategy, for mobility
performance or time window) to support the aggregation of Analytics Output
obtained from multiple distributed / lower layer NWDAFs.
\- Observation O4: In solutions #11, #12, #14 (except option A), #19, #23, #
60, a Central (or higher layer) NWDAF may aggregate analytics per analytics ID
from Distributed (or lower layer) NWDAFs, each covering specific TAs from the
area of interest for the NWDAF service consumer.
\- Observation O5: All solutions, except one option in solution #11, use
existing NRF mechanisms to discover other NWDAFs.
\- Observation 06: Solution#10 adds the possibility to per UE re-use existing
data collection and Analytics Output already available in other NWDAFs in a
dynamic NWDAF architecture with overlapping NWDAF serving areas.
\- Observation O7: Solutions #12, #14 (except option A), #21 and #60 propose
to extend the NWDAF capabilities (e.g. analytics aggregation) registered in
the NWDAF NF Profile in NRF to include the new NWDAF capabilities. Solution#11
and solution #23 propose to extend the NWDAF NF Profile in NRF to include the
5GC NF ID(s) that the NWDAF can serve.
\- Observation O8: Solutions #10, #12, #21 propose lower layer NWDAFs (i.e.
Distributed NWDAFs) are close to data source or co-located with NFs. Other
solutions do not preclude this requirement.
\- Observation O9: Solution #16, describes a use case where the NWDAF service
consumer contacts a lower layer NWDAF, while the procedure in solution #18
shows the case where the NWDAF service consumer contacts the top layer NWDAF.
Solution #60 mentions that NF service consumer can be configured to give
preference to a distributed NWDAF over a Central NWDAF or vice versa, in case
multiple NWDAFs are returned by NRF.
\- Observation O10: Solution #17 mentions that \"NRF will return the best
matching NWDAF in the hierarchy that can support the requested Analytics\".
This implies a change to the existing NRF behaviour to determine \"the best
matching NWDAF\" and to know and understand the NWDAF hierarchy.
#### 7.2.2.3 Re-selection of NWDAF
Table 7.2.2.3-1 lists solutions that concern with the re-selection of NWDAFs,
e.g., in case of mobility. Those solutions assume a setup with multiple NWDAF
instances, therefore are marked as related to Key Issue #2, while the
solutions focus on NWDAF re-selection and context handover aspects, and
therefore can be applied to any kind of NWDAF architecture. Main differences
are in the services used for the re-selection and in which entity is
triggering the re-selection and informing the service consumer.
Table 7.2.2.3-1: Solutions concerning re-selection of NWDAF
+------+--------------+--------------+--------------+--------------+ | Sol. | Aspect | Impact to | Impact to | Additional | | | covered | NWDAF | other NFs | notes | +------+--------------+--------------+--------------+--------------+ | 10 | Without | Re-use | Without | Without | | | DCCF: | requ | DCCF: | DCCF: | | | | est/response | | | | | Re-selection | service | Extend AMF | Source AMF | | | of NWDAF | operations | services to | (as NWDAF | | | triggered by | to transfer | inform | service | | | AMF handover | UE related | target AMF | consumer) | | | (clause | statistics | about the | determines | | | 6.10.2.4). | | NWDAF ID | and triggers | | | | | used by the | NWDAF | | | With DCCF: | | source AMF | r | | | | | for UE | e-selection. | | | Re-selection | | related | | | | of NWDAF is | | Analytics. | Target NWDAF | | | using | | | requests UE | | | knowledge in | | Target AMF | related | | | DCCF. | | determines | statistics | | | | | whether to | from source | | | | | keep source | NWDAF. | | | | | NWDAF | | | | | | instance or | With DCCF: | | | | | select new | | | | | | target NWDAF | DCCF has | | | | | instance. | knowledge on | | | | | | what source | | | | | With DCCF: | NWDAF has | | | | | | been used | | | | | Extend to | for UE | | | | | inform DCCF | related | | | | | on what UE | Analytics | | | | | related | IDs. | | | | | Analytics ID | | | | | | is used in | | | | | | which NWDAF. | | | | | | | | | | | | Utilize | | | | | | knowledge | | | | | | DCCF has | | | | | | when | | | | | | switching | | | | | | NWDAFs. | | +------+--------------+--------------+--------------+--------------+ | 26 | Re-selection | Extend | NWDAF | Source NWDAF | | | of NWDAF. | A | service | determines | | | | nalyticsInfo | consumer: | and triggers | | | | service to: | support | NWDAF | | | | | subscription | re-location. | | | | - inform | renewal with | | | | | other NWDAF | new NWDAF | Target NWDAF | | | | about | instance. | informs the | | | | analytics | | NWDAF | | | | handover | New | service | | | | | parameter | consumer | | | | - transfer | for Notify | about | | | | subscription | message | updated | | | | data | indicating | s | | | | | reselection | ubscription. | | | | - transfer | of NWDAF | | | | | analytics | instance. | | | | | data and | | | | | | collected | | | | | | data | | | +------+--------------+--------------+--------------+--------------+ | 57 | Re-selection | New service | NWDAF | Source NWDAF | | | of NWDAF in | to: | service | triggers the | | | case of UE | | consumer: | re-location. | | | mobility. | - transfer | support | | | | | subscription | subscription | Target NWDAF | | | | data | renewal with | informs the | | | | | new NWDAF | NWDAF | | | | - transfer | instance. | service | | | | analytics | | consumer | | | | data and | | about the | | | | collected | | handover. | | | | data | | | +------+--------------+--------------+--------------+--------------+ | 59 | Re-selection | Extend | | Source NWDAF | | | of NWDAF | subscription | | determines | | | based on | service to: | | and triggers | | | trigger or | | | the | | | for handover | - inform | | analytics | | | preparation. | other NWDAF | | handover or | | | | about | | the prepared | | | | analytics | | analytics | | | | handover or | | handover. | | | | prepar | | | | | | ed/cancelled | | Target NWDAF | | | | handover | | informs the | | | | | | NWDAF | | | | Extend | | service | | | | A | | consumer | | | | nalyticsInfo | | about the | | | | service to: | | completed | | | | | | handover. | | | | - transfer | | | | | | subscription | | | | | | data | | | | | | | | | | | | - transfer | | | | | | analytics | | | | | | data and | | | | | | collected | | | | | | data | | | +------+--------------+--------------+--------------+--------------+
Solution #10, #26, #57 and #59 address the reselection aspect of KI #2 in the
multiple NWDAF deployment scenario:
\- Solution #10, clause 6.10.2.4: Handling of mixed and distributed NWDAF
deployments.
\- Solution #26: Reselection of NWDAF.
\- Solution #57: Reselection of NWDAF due to mobility change.
\- Solution #59: Analytics handover.
Clause 6.10.2.4 in Solution #10 defines a set of procedures to support change
of the serving NWDAF when the change of NWDAF is triggered by NF change.
Whether a new NWDAF is required or the old serving NWDAF can be reused is
decided by a target NF. When a new NWDAF is selected by a new target NF, the
new selected NWDAF may retrieve analytics context information (e.g., analytics
data and collected input data) from the old serving NWDAF using
Nnwdaf_AnalyticsInfo service operations. The solution without DCCF also
defines a procedure that supports updating NWDAF service consumers with
information of a new NWDAF instance by extending
Namf_Communication_UEContextTransfer. The new (target) serving NWDAF notifies
the NWDAF service consumer about the relocation.
Solution #57 defines a set of procedures to support change of the serving
NWDAF instance when the change of NWDAF instance is triggered by the mobility
of the UE. The serving NWDAF is informed of the UE mobility event by the old
(source) AMF or a new (target) AMF, and decides the NWDAF reselection. The
serving NWDAF may send analytics context information (e.g., stored analytics
data and collected input data) to the new NWADF during the reselection
procedure using a new Nnwdaf_AnalyticsRelocation service. The new (target)
serving NWDAF notifies the NWDAF service consumer about the reselection.
Solution #26 defines a procedure to support change of the serving NWDAF
instance when the change of NWDAF instance is triggered by the old serving
NWDAF. The old serving NWDAF may select a new NWDAF instance based on NF
profiles obtained from the NRF and the new serving NWDAF informs the consumer
NF of the change of the serving NWDAF after the reselection procedure is
finished. The new selected NWDAF may retrieve analytics context information
(e.g., analytics data and collected input data) from the old serving NWDAF
using an Nnwdaf_AnalyticsInfo service.
Solution #59 defines a set of procedures to support change of the serving
NWDAF when the change of NWDAF is triggered by the old serving NWDAF, as like
in Solution #26. The old serving NWDAF may select a new NWDAF instance based
on NF profile received from the NRF. In the procedure, the old serving NWDAF
inform the target NWDAF about the analytics handover, indicating to it/them
the availability of analytics context information (e.g., collected historic
data and stored analytics) using an extended Nnwdaf_AnalyticsSubscription
service operation. The solution also defines the option that the old serving
NWDAF sends a prepared analytics handover request to the potential candidate
NWDAFs and selecting a final target NWDAF when the actual handover is
triggered. The target NWDAF(s), when informed about the availability of
analytics context information (e.g., collected historic data and stored
analytics) available at the source NWDAF, will retrieve this information from
the source NWDAF using Nnwdaf_AnalyticsInfo service operations. Finally, the
new (target) serving NWDAF notifies the NWDAF service consumer about the
successful reselection.
All solutions have in common that analytics data and input data collected by
the old serving NWDAF can be transferred from the old serving NWDAF to the new
target NWDAF. Solution #10 and #57 are handling the scenario that the serving
NWDAF is changed due to change of the consumer NF which again is triggered by
UE mobility. Solution #26 is handling the scenarios that the serving NWDAF is
changed by the reselection of NWDAF instances to support, e.g., offloading,
load balancing and network resource configuration. Solution #59 is addressing
both cases. In solutions #10, #26, #57, #59 the NWDAF service consumer is
informed by the target NWDAF, which is inline with AMF relocation procedures
as specified in Release-16.
#### 7.2.2.4 Specific aspects of NWDAF interactions
Table 7.2.2.4-1 lists solutions describing another specific aspect of NWDAF
interactions and can be realized in both distributed and hierarchical NWDAF
deployments. Solutions in this table should be evaluated based on the specific
aspect that they are addressing.
Table 7.2.2.4-1: Solutions on specific aspects of NWDAF interactions
+------+-------------------+-------------------+-------------------+ | Sol. | Aspect described | Impact to NWDAF | Impact to other | | | in solution | | NFs | +------+-------------------+-------------------+-------------------+ | 13 | Time | Include revised | | | | coordination. | waiting time in | | | | | error response | | +------+-------------------+-------------------+-------------------+ | 20 | Abnormal | Provide observed | | | | behaviour | time window for | | | | Analytics | abnormal | | | | interactions. | behaviour. | | | | | | | | | | Obtain abnormal | | | | | UE list and | | | | | related | | | | | analytics. | | | | | | | | | | Determine when | | | | | abnormal | | | | | situation occurs | | | | | and when it is | | | | | resolved. | | | | | | | | | | Train a new model | | | | | and generate new | | | | | Analytics in case | | | | | of abnormal | | | | | behaviour | | | | | situation. | | +------+-------------------+-------------------+-------------------+ | 25 | UE mobility | Store UE mobility | NEF: Extend the | | | analytics | analytics for | filter | | | exposure. | certain time, | information of | | | | e.g. 2 weeks. | the existing | | | | | Nnef_AnalyticsEx | | | | For UE mobility | posure_Subscribe | | | | analytics, extend | service | | | | the filter | | | | | information of | | | | | the existing | | | | | Nnwdaf | | | | | _AnalyticsSubscr | | | | | iption_Subscribe | | | | | service or | | | | | Nnwdaf_Analy | | | | | ticsInfo_Request | | | | | service, by | | | | | including a new | | | | | analytic filter = | | | | | Source Area of | | | | | Interest and | | | | | Target Area of | | | | | Interest. | | | | | | | | | | Figure out a | | | | | candidate SUPI | | | | | list who | | | | | currently stay in | | | | | but may once left | | | | | Source Area of | | | | | Interest in | | | | | target period. | | +------+-------------------+-------------------+-------------------+ | 24 | Federated | Federated | NRF: Register | | | Learning. | Learning, incl. | NWDAF capability | | | | determining and | to support | | | | distributing the | Federated | | | | initial Federated | Learning. | | | | Learning | | | | | parameters. | | | | | | | | | | Expose/collect | | | | | and aggregate ML | | | | | model and local | | | | | ML model | | | | | information to | | | | | perform Federated | | | | | Learning among | | | | | the NWDAFs. | | +------+-------------------+-------------------+-------------------+ | 56 | Trained ML model | Expose/receive | | | | sharing. | trained | | | | | model/parameters. | | | | | | | | | | NWDAF Profile in | | | | | NRF includes | | | | | provided ML | | | | | models. | | +------+-------------------+-------------------+-------------------+
Solutions #24 proposes an NWDAF distributed in an area to share its machine
learning (ML) model or ML model parameters with other NWDAFs via Federated
Learning. It is difficult to centralize all the raw data that are distributed
in different areas, such as data privacy and security, however, Federated
Learning could handle these issues, in which there is no need for raw data
transferring.
The Client/Server NWDAF for Federated Learning are compatible with both
distributed and hierarchical NWDAF architecture.
The Solution #24 could be used to define the Client/Server NWDAF Federated
Learning capability registration and discovery, the Federated Learning
concept/architecture definition. The proposed licensing mechanism is unclear
and requires more work before it can be considered for the normative work.
While, the services and its parameters of ML model provisioning or ML model
update between the Server NWDAF and the Client NWDAF during the Federated
Learning model training procedure that can realize the ML model or ML model
parameters sharing between multiple NWDAF instances in phase of FL
initialization and FL iteration, are up to the conclusion of the Key Issue
#19.
Solutions #56 assumes a setup with multiple NWDAF instances, therefore is
marked as related to Key Issue #2, while the solution is mainly covering
aspects related to model sharing for trained ML models and can be applied to
any kind of multiple NWDAF deployment. The solutions should be discussed in
detail as part of evaluation on Key Issue #19, and therefore is skipped in
this evaluation on Key Issue #2 related aspects.
Solutions #25 proposes a solution of exposing UE mobility analytics for
multiple NWDAFs to NF/AF. To obtain UE mobility analytics in Source Area of
Interest and Target Area of Interest(s) in target period(s), or to obtain UE
mobility analytics in Source Area of Interest and not in Target Area of
Interest(s) in target period(s), NF/AF send subscription or request to the
NWDAF serving Source Area of Interest, which includes Source Area of Interest,
Target Area of Interest(s) and target period(s). It could trigger interaction
procedure between the NWDAF serving Target Area of Interest and the NWDAF
serving Target Area of Interest(s) to figure out the SUPI list and their
related mobility analytics, who once stayed in Target Area of Interest in
target period or not.
Solutions #13 and #19 focus on NWDAF parameter coordination across multiple
NWDAFs. Below observations can be made about those solutions:
Sol #13: Time Coordination for Multiple NWDAFs.
\- A tight relation may exist on an action taken by a NWDAF service consumer
and the timing of analytics collected from multiple NWDAFs (e.g. in order to
adopt a correct AM/ SM policy)
\- Without time coordination between multiple NWDAFs, an un-intended outcome
policy may be adopted for a given a NWDAF service consumer due to consuming
data analytics from each NWDAF independently.
\- It is compatible with both distributed and hierarchical NWDAF architecture.
\- The main impact is on error response from each NWDAF to include revised
waiting time.
Sol #19: **_Multiple NWDAFs interactions for analytics consumption and
composition related to large areas_**
\- NWDAFs are configured with the baseline parameters allowed per type of
analytics type (i.e. analytics IDs);
\- Baseline parameters are divided into two classes: dataset statistical
properties that defines requirements for the selection and preparation of the
collected data; and output strategy.
\- NWDAF may use the dataset statistical properties information in order to
influence the data selection mechanisms to be used for the generation of an
analytics IDs, assuring that the generated analytics ID reflects the
statistical characteristics of the data that are relevant for the consumer in
all different NWDAFs;
\- Consumers indicate the output strategy to coordinate the multiple NWDAFs
under the following criteria: if preferred level of accuracy is more important
than providing an output, the binary strategy shall be used by the consumer NF
in the request to guarantee that all analytics outputs have equivalent
confidence in the prediction; if having an analytics output is more important
than reaching the preferred level of accuracy, then the consumer should use
the gradient output strategy to guarantee that each NWDAF will timely provide
the output indicating the level of accuracy at the moment of the output
generation.
\- Sol#19 is compatible with both distributed and hierarchical NWDAF
architecture.
Solutions agreed focusing on UE abnormal behaviour analytics interaction
across multiple NWDAFs.
\- Sol #20: UE abnormal behaviour analytics interaction between multiple NWDAF
instances
Sol #20:
\- NWDAF in one network may provide the specific type of analytics e.g. UE
abnormal behaviour analytics to other NWDAF(s), which may not support this
certain type of analytics.
\- This UE abnormal behaviour analytics interaction can be used by other
NWDAF(s) to generate new statistics/predictions for certain Analytics ID
during the time of the abnormal situation and provide the updated analytics to
the analytics consumer.
\- Sol#20 is compatible with both distributed and hierarchical NWDAF
architecture.
## 7.4 Key Issue #4: Remaining aspects on how to ensure that slice SLA is
guaranteed
The following is a description of solution #2 and the aspects that are
covered, there are no evaluation of the different solutions, since only one
solution is defined. However, this clause evaluates some aspects of solution#2
as regards to:
\- How does NWDAF determine slice service experience and slice load
information and which entity or entities subscribe(s) to/request(s) the
analytics?
\- Using the above analytics, how is slice load distribution carried out to
assist with SLA?
For the first aspect: NWDAF determine the slice service experience and slice
load information as follows:
\- NWDAF performs input data collection for slice service experience analytics
as described in clause 6.4 of TS 23.288 [5].
\- NWDAF performs input data collection for slice load analytics as described
in clauses 6.2.1.3 and 6.2.1.4.3.
\- Based on the overall input data collection information, NWDAF determines
the slice service experience and slice load statistics and predictions.
\- NWDAF provides the output to the service consumer e.g. NSSF or AMF.
For the second aspects:
\- NWDAF provides statistics and predictions on Slice load or Observe Service
experience or both and then the consumer NF take actions if needed to help
maintaining the SLA as follows: Based on the NWDAF statistics and predictions
the service consumer (i.e. NSSF) may trigger an indication to the AMF for a
slice restriction for UE registrations and/or PDU sessions. AMF enforces the
slice restriction by accepting or rejecting new UE registrations and/or PDU
session establishments on the restricted slice following the procedures in TS
23.502 [3].
## 7.7 Key Issue #7 Adding Application attributes and KPIs as the Input data
in some services described in TS 23.288 [5]
This clause evaluates some aspects of solution#61 as regards to:
Two Analytics-ID are covered in this solution:
\- QoS Sustainability;
\- Observed Service Experience.
This clause mentions also solutions different than Solution #61 that uses or
proposes enhancement to the Observed Service Experience Analytics ID no
related to the solution #61.
**Enhancement of QoS Sustainability Analytics ID**
For QoS Sustainability the enhancement introduces the top ten Application
information and add Application-ID and their KPIs in the data input. In the
Rel-16 version of this Analytics-ID, in case of an Outcome results as a
prediction indicating that the QoS is not going to be sustained; the consumer
does not have any clue of what to do; therefore, for critical use cases such
as self-driving vehicles, this analytics ID is not indicated due to the lack
of alternatives in case of a negative outcome.
For Rel-17, the enhancement introduces the Top-Ten concept; in case of a
negative Outcome, the Service consumer receives the top-ten Application-IDs
that are causing the issue of QoS sustainability and can react in real-time to
request for the PCF actions to manage the traffic that is impacting the QoS
sustainability. In the case of the PCF being the service consumer, the
reaction is right forward performed with minimum disturbance in the QoS and
permanently assuring the SLAs for critical services. In this scenario, the AF
interacts (directly or through the NEF) with the PCF as described in _TS
23.503 [4] clause 5.3.1 Interactions between PCF and AF_ , in this case the
PCF is the service consumer of the QoS sustainability Analytic ID.
**Enhancement of Observed Service Experience Analytics ID**
There are two kind of enhancement in this solution for this Analytics ID, the
first enhancement aims that the observed Service experience includes
Application IDs that are present in the traffic mix and are not necessarily
linked to the AFs, also improving statistics reporting. The second enhancement
introduces the TopN concept as a parameter in the Analytic Filter and add
Application-ID and their KPIs that are present in the traffic as additional
data input. In the Rel-16 version of this Analytics-ID, it focuses only on
Application IDs served by AFs that could interact with the NEF and NWDAF. As a
reference in a typical 4G network in 2020, Application IDs served by AF are
less than 5% of the total Application-IDs present in the traffic. To have more
context, it is possible to find in the network 3000 different Application-ID
served from the internet.
As a conclusion is stated in clause 8.4, ensure that slice SLA is guaranteed
and leverage the Analytics Id on Observed Service Experience and Slice Load.
Enhancement of Observed Service experience for this purpose is critical;
otherwise, the usages of this Analytics ID will use less than 5% of the
application-IDs present in the traffic to assure that slice SLA is guaranteed;
therefore, the system would not offer SLA assurance for traffic served from
the Internet.
For Rel-17, the enhancement introduces the TopN concept; with this concept,
the service consumer can target the Top N Application-IDs that are
experiencing the poorest service experience among applications served from the
Internet and Applications served by local AFs. This mechanism is essential to
find straight forward the Applications experiencing QoE issues. In the Rel-16
version of this Analytics-ID, this mechanism is not present; how to target the
right applications that are experiencing QoE issues among 3000 Applications
when internet traffic is considered, it is an important challenge.
## 7.8 Key Issue #8: UE data as an input for analytics generation
According to Table7.8-1, solution #27, #28, #29, #62, #63, #64 and #65 are
proposed for Key Issue #8.
Table 7.8-1: Evaluation of solutions related to KI#8
+----------+-------------+-------------+-------------+-------------+ | Solution | Data | Parameters | Trigger of | Integrity | | | collection | collected | UE data | and Privacy | | | procedure | from UE | reporting | aspects | +----------+-------------+-------------+-------------+-------------+ | **27** | UP | Application | MNO AF | HTTPS, Data | | | Solution: | layer | Event | ano | | | | Information | Exposure | nymisation, | | | Application | | | ciphering, | | | client in | | | ASP-level | | | the UE | | | user | | | reports to | | | consent | | | MNO AF | | | | | | directly | | | | +----------+-------------+-------------+-------------+-------------+ | **28** | CP Solution | Policy | URSP | - | | | | enforcement | enforcement | | | | | related | update | | | | | i | | | | | | nformation: | | | | | | | | | | | | URSP | | | | | | enforcement | | | +----------+-------------+-------------+-------------+-------------+ | **29** | UP | Application | (MNO) AF | HTTPS, Data | | | Solution: | layer | Event | ano | | | | i | Exposure | nymisation, | | | Application | nformation: | | ASP-level | | | client in | | | user | | | the UE | Part of | | consent | | | reports to | collective | | | | | (MNO) AF | (UE | | | | | | behaviour) | | | | | | attributes | | | | | | | | | | | | Application | | | | | | Status | | | | | | information | | | +----------+-------------+-------------+-------------+-------------+ | **62** | - | Policy | Events | - | | | | enforcement | described | | | | | related | in the data | | | | | i | collection | | | | | nformation: | co | | | | | | nfiguration | | | | | Applied | provided by | | | | | WLANSP rule | PCF | | +----------+-------------+-------------+-------------+-------------+ | **63** | - | Application | Request | - | | | | layer | from AF | | | | | I | | | | | | nformation: | | | | | | Service | | | | | | experience | | | | | | c | | | | | | ontribution | | | +----------+-------------+-------------+-------------+-------------+ | **64** | UP | Application | DC AF Event | HTTPS | | | Solution: | layer | Exposure | | | | | Information | | | | | UE reports | | | | | | to DC AF | | | | | | indirectly | | | | | | (3rd party | | | | | | ASP | | | | | | collects | | | | | | data from | | | | | | UE and | | | | | | sends to DC | | | | | | AF, then DC | | | | | | AF sends | | | | | | the data to | | | | | | NWDAF) | | | | +----------+-------------+-------------+-------------+-------------+ | **65** | - | - | Existing or | - | | | | | new event | | | | | | triggers | | | | | | via AMF | | +----------+-------------+-------------+-------------+-------------+
For UE data collection procedure, there are two sets of solutions proposed.
User plane solution set:
\- Solution #27: UE Application establishes a user plane connection to MNO AF
which is the entity operated by operator. Application layer data request and
data report are performed between UE and MNO AF via user plane. The MNO AF
provides the data after possible processing like aggregation, normalization,
etc. to the NWDAF using Naf_EventExposure.
\- Solution #64: UE establishes a user plane connection to Application Server,
Application layer data request and data report are performed between UE and
Application Server via user plane. Application Server forwards the data after
possible processing to a DC AF owned by operator which in turn exposes it to
the NWDAF using Naf_EventExposure.
\- Solution #29 proposes a procedure similar to solution #27. The NWDAF may
subscribe to (MNO) AF based on policies agreed during the configuration phase
prior to the NWDAF collecting data from the AF. The (MNO) AF may anonymise,
normalise or aggregate the data before notifying the UE input data.
Control Plane solution set:
\- Solution #28: The data request message is encapsulated in a transparent
container sent from NWDAF to AMF and then AMF forwards the container to UE via
NAS message. UE data reporting is also encapsulated in a transparent container
sent to AMF via NAS message and AMF forwards the container to NWDAF.
Other solutions do not explicitly propose the data collection procedure.
For user plane solution, the data collection / report procedure is performed
in application layer and treated as data transmission in PDU session. For
control plane solution, it requires additional NAS signalling for data
transmission.
For the proposed parameters that collected from UE, there are several
different proposals.
\- Application layer information:
\- Solution #27 and solution #64, general solutions for application layer
parameters. The solutions may support both 3GPP defined service and non-3GPP
defined services but do not define specific parameters to be collected from
UE, the list of parameters to collect is part of the SLA between the ASP and
the MNO.
\- Solution # 63: Service experience contribution.
\- Solution # 29, Part of collective (UE behaviour) attributes: (when cannot
be collected via prior AF reporting and / or MDT) which include the route,
destination, average speed information, time interval spent per location. The
usage of this information is to enhance NF load analytics (e.g., for AMF load
balancing).
\- Solution #29, Application status information: which indicates whether flow
of the application is in a foreground status or background status. The usage
of this information is different than the NF load analytics (i.e. it is to
determine new QoS parameters for a new flow, e.g. by PCF). How Network
allocation of resources will be impacted based on the foreground status and
background status needs to be clarified as the procedure after UE data
collection is not covered.
\- Enforcement of policies in the UE, either URSP or WLANSP rules related
information:
\- Solution #28: UE reports the applied RSD information to NWDAF, and NWDAF
provides statistics and prediction about the usage of URSP rules. Then PCF can
use the analytics report to allocate a more proper RSD for UE.
\- Solution # 62: NWDAF collects data from the UE about which of several
WLANSP rules and groups of selection criteria is directly involved in the WLAN
selection. It also collects data that can measure the quality and performance
of the WLAN connection from other 5GC NFs. NWDAF reveals the correlation
between WLANSP that UE applied when selecting the WLAN and the resulting WLAN
performance. The PCF can use the analytics results to update the WLANSP to
improve WLAN performance.
> Solution #65 considers the trigger about UE data collection, UE reports the
> supported type of data to AMF during registration, NWDAF will collect the
> number of UEs that support a specific type of data collection, for a
> specific area or slice, and decide whether start or stop data collection
> from UEs. Solution is not applicable to application level mechanisms to
> collect data as defined by solutions #27, #29 or #64. NWDAF can still check
> the number of UEs in specific areas or specific slices before triggering
> data collection at application level for these specific areas or specific
> slices, but this can be achieved already in Rel-16 without additional
> standardization changes.
## 7.9 Key Issue #9: Dispersion Analytics output provided by NWDAF
For Key Issue #9 - \"Dispersion Analytics output provided by NWDAF\", two
complementary solutions have been proposed, candidate solutions #30 and #66.
Solution #30 describes the required input, delivered NWDAF output and provides
procedures that can use the Dispersion Analytics (DA).
Solution #30 provides a procedure for obtaining UE dispersion analytics by
consumers, a procedure for user data congestion mitigation, enabling the PCF
to update QoS e.g. UE-AMBR, update RFSP value, update service area
restrictions and a procedure to assist the AMF and NSSF with the evolving
slice load distribution procedures described in KI#4.
Solution #66 describes how the AF stores, in the UDM, the dispersion
information as an AMF-Associated Expected Behaviour and SMF-Associated
Expected Behaviour and be used by AMF and SMF.
## 7.10 Key Issue #10: NWDAF Assisted UP Optimization
Three solutions have been proposed addressing Key Issue 10, namely Solution
31, Solution 67, and Solution 68.
Solution 31 also addresses Key Issue 16 and similarly to other solutions to
Key Issue 16 it proposes to derive analytics of service experience per
UPF/DNAI path. It is proposed to conclude on this solution in the context of
Key Issue 16 where similar solutions and the rest of user plane solutions
related to edge computing are also evaluated.
Solution 67 proposes to perform user plane optimization by means of leveraging
and extending UE Communication analytics defined in TS 23.288 [5] so that the
value of the inactivity timer associated to each user plane connection set by
SMF is decided informed by analytics. Two alternatives are proposed for input
data collection based on SMF and UPF as data sources, respectively. Collecting
the new data from SMF requires standardization impact while from UPF does not
since data collection mechanisms from UPF are not specified by this Release of
the specification. Both alternatives require normative work to extend the
output analytics definition for UE Communication in TS 23.288 [5].
Solution 68 proposes to perform user plane optimization by means of a new
analytics type, namely Redundant Transmission Experience analytics, aimed at
supporting redundant transmission decisions for URLLC services. The solution
requires new input data from SMF as well as UPF or OAM. However, whether OAM
measurements are available (e.g. in TS 28.552 [19]) is not specified by SA
WG2.
## 7.11 Key Issue #11: Increasing efficiency of data collection
The solutions in KI#11 can be classified into four categories according to the
issues that they mainly address for achieving efficient data collection:
a) Signalling reduction via architectural changes (intersecting with KI#2):
Sol #1, #9, #10 (case considering DCCF), #12, #15, #16, #35, #39. The
solutions in category a address the problem of the load due to identical data
collection from multiple NWDAFs.
b) Signalling reduction via parametrization and services changes: #58, #70,
#72. The solutions in the categories b are addressing changes of entities and
discovery.
c) Signalling reduction on Tracking and Discovery of Entities: #10, #32, #36,
#69. The solutions in the categories c are addressing changes of entities and
discovery.
d) Signalling reduction via parametrization and services changes specific to
event exposure framework: 33, #34, #37, #38, #71. The solutions in category d
do address all situations of data collection.
Solutions in group \"b\" and \"c\" are independent (except from Sol #34) from
the architectural issues proposed in solutions from group \"a\". Therefore,
solutions in group \"b\" and \"c\" can co-exist with any decision taken
regarding solutions of group \"a\".
### 7.11.1 Evaluation for solutions based on parametrization and services
changes
The evaluation of the solutions in the category \"Signalling reduction via
parametrization and services changes\" is provided as follows:
\- Sol #58 provides three alternatives for the definition of services that are
able to provide bulked data collected for an analytics ID, the bulked data
being plain collected data, aggregated collected data, or analytics ID with
the collected data for generating such analytics output. The operation
principles of the alternative services can be applied in NWDAF-to-NWDAF
interactions for data collection as well as in NWDAF-to-Dedicated NF (e.g.,
DCCF). Alternatives #1 (when combined with sol#37) and #3 allow the
communication models: subscribe-notify; request-response; asynchronous
initiated by consumer. The alternatives can co-exist and allow different
alternatives for data collection during training or inference.
\- Sol #70 provides extensions to UDM Event exposure services, in the case of
persistent data collection, so that NWDAF can delegate to UDM the control of
lifecycle changes in event subscriptions at SMF and AMFs when changes in NFs
serving UEs happens in the system. This solution allows the management of
event subscription to serving NFs to be transparent to NWDAF.
\- Sol #72 proposes to extend the mechanisms of UE analytics context transfer
to allow analytics information generated for the UEs to be transferred from an
initial consumer of analytics ID for such UE to a new consumer NF. Such
mechanism eliminates the need for extra signalling between a new consumer NF
(acting as serving NF for the UE) and an NWDAF to retrieve previous generated
analytics IDs for such UE.
There have been no clear use cases brought forward for sending Analytics
between NFs and what the receiving NF shall use the Analytics for. No firm
statement on what is expected from the source NF is stated. This is also an
optimization that will be performed very rarely since the procedures mentioned
are done rarely. Therefore, this optimization is not deemed to be needed in
rel-17.
From the description of the above solutions, the following observations are
made:
\- Solution #58 reduces the signalling for data collection for an analytics ID
in cases of NWDAF to NWDAF interactions as well as NWDAF-to DCCF (if present
in the network). Additionally, the proposed analytics service extensions
(alternative 3) allow for transfer of analytics IDs and/or associated data of
such analytics IDs.
\- Solution #70 abstracts from the NF consumer the need for controlling the
event subscription for specific UEs in serving AMFs and SMFs. Such solution
can be applied either when NWDAF or DCCF (if present) are the entities
responsible to collect events about specific UEs from the source NFs. The
procedure automates the collection of data over UE(s) registering cycles and
PDU session cycles and also achieves signalling reduction since NWDAF doesn\'t
need to pull information regularly from UDM.
\- Solutions, #58 (Alternative #1) essentially support reduction on signalling
and/or volume of transmitted data for analytics processes (training and/or
inference).
\- In Solution #72, an NF, when triggered to perform UE Context transfer for
that UE to another NF can be configured to transfer analytics context related
to a particular UE as part of the UE context transfer message. While the
signalling reduction, compared to the target NF requesting this analytics
information from the NWDAF, is neglectable, the solution provides the
following benefits:
Information is immediately available at the target NF, whereas otherwise, the
target NF would first need to create a new subscription with the NWDAF to
collect the required Analytics.
NOTE 1: The trigger for an NF to perform UE context transfer, as well as the
corresponding service operations are already specified in Rel-16, and are
extended to support including the analytics context available at the source
NF. This analytics context had earlier been received from a (possibly co-
located) NWDAF.
NOTE 2: In case of UE context transfer between NFs of the same type, it can be
assumed that the target NF needs the same UE related Analytics as the source
NF.
Table 7.11.1-1
* * *
            Impact on consumer NF   Impact on NWDAF   Impact on producer NF   Impact on other NF   Reduction of signalling
Sol#58 Yes Yes Yes N/A FFS Sol#70 Yes (no subscription) Yes No Yes (UDM) No
Sol#72 Yes No Yes No No
* * *
### 7.11.2 Evaluation for solutions based on Tracking and Discovery of
Entities
The evaluation of the solutions in the category \"Signalling reduction on
Tracking and Discovery of Entities\" is provided as follows:
\- Sol #10 provides extensions to UDM services in order to allow NWDAFs to
register their serving UEs as well as consumers to discover the NWDAFs serving
UEs. The mechanism focus on reusing existing signalling exchanged among CP NFs
interacting using UE Context management services in case of SMF/AMF and via
AM/SM policy association in case of PCF in order to transfer analytics related
information (serving NWDAF, analytics subscriptions, analytics outputs).
Interactions with NWDAFs include mechanism such as in sol #37 or sol. #58 to
enable asynchronous communication initiated by consumer (e.g., suppression of
notifications is equivalent to deactivation-activation flags proposed in Sol
#37) at NWDAF interface for analytics generation. This solution is also
possible together with a DCCF (if deployed).
\- Sol #32 provides extensions for the reduction of signalling and data
transfer among NFs and NWDAF in order for NWDAF to keep a mapping of entities
(SMFs, AMFs), network properties (available S-NSSAIs, cells, access type), and
PDU session properties (Application, DNN, DNAI) serving or associated to an
area of interest. The extensions focus on enhancements to status information
exposed by NRF, to event exposure services exposed by AMF and SMF. The
proposed procedures can be invoked by NWDAF or by DCCF (if present in the
network) in order to control the map of sources of data related to an area of
interest.
\- Sol #36 provides a solution for determining the UPFs that are serving UE or
an area of interest. This solution allows consumer of the proposed SMF event
(e.g., NWDAF or DCCF, or UDM) to retrieve information about UPFs, which is
essential so to determine the UPFs that should be the sources of data in order
to train models, or calculated statistics analytics output of already defined
ID (TS 23.288 [5] clause 6.4.2, Clause 6.5.2, Clause 6.7.3.2).
\- Sol #69 proposes that NWDAFs co-located with UPF discover the UEs that they
serve in two steps, first discovering SMFs in the same NWDAF serving area, and
then by subscribing to SMF events to extract the UE information from each PDU
session event exposed by SMF with appropriated filter without defining the
appropriated filters. Sol #69 and Sol. #36 are complementary when it comes to
identifying the relationship of UPFs serving UEs or are of interest, as Sol
#69 is a sub-case with the assumption that identifying the UPF it is
equivalent to identify the co-located NWDAF serving such UE in the UP. NWDAF
register itself in UDM identifying the set of UEs that it serves so that NWDAF
consumers can identify the proper NWDAF to expose UPF data related to the UEs
by querying UDM, following the same principle from Sol #10. UPF registers at
NRF the identification of the co-located NWDAF.
From the description of the above solutions, the following observations are
made:
\- Solution #32 provides extensions to NRF, NFs capabilities and NF services
to expose new events or enhance existing events that allow the reduction of
the need for NWDAF (or DCCF if present) to subscribe to events with \"any UE\"
and then sort out the content and discard the unnecessary data (which leads to
waste on transmission of unnecessary data). The NRF service parametrization is
extended, AMF exposes a new event with available network slice information per
area of interest, and SMF allows \"any PDU session\" as target of event
reporting as well as further filters to be used in the event subscription.
\- Solution #36 provides the mechanisms for discovering the UPFs that were
serving PDU sessions of UEs and/or AoI. This information was missing in R16
but it is necessary for the proper calculation of analytics IDs such as
Service Experience, UE Communication; or for having the proper data about UPFs
for data used for training analytics models. This proposal is deemed to be
better to introduce when data collection from UPF is specified.
\- Solutions #10 and #69 propose the usage of UDM as the entity for
maintaining the information about NWDAF serving UEs, when NWDAFs are co-
located, respectively with CP Functions and UPF.
Table 7.11.2-1
* * *
            Impact on consumer NF   Impact on NWDAF   Impact on producer NF   Impact on other NF   Reduction of signalling
Sol#10 Yes Yes No UDM Yes Sol#32 No Yes Yes (AMF, SMF) NRF Yes Sol#36 No Yes
Yes (SMF) No FFS Sol#69 No Yes Yes (SMF) UDM FFS
* * *
### 7.11.3 Evaluation for solutions based on event exposure service
enhancement
Solution evaluation for the KI#11 - Reduce signalling load for data
collection.
The proposed solution #33, #34, #37, #38 and #71 enhance the event exposure
services that the NWDAF consumes to collect data in order to addressing the
KI#11, independently of whether there is an intermediate function or not
between the event exposure service producer NF and the NWDAF (as event
exposure service consumer NF).
\- Sol #33 proposes different changes in the Analytics service. New parameters
are added in Requests or Subscriptions to define a) which analytics subsets in
Event Notification b) additional Analytics filters c) time granularity and
ordering of results (to be used with maximum number or results) d) aggregation
of results versus detailed lists. Sol #33 also proposes additional filters in
the Event Exposure service for data collection.
\- Sol #34 proposes a change in the Event Exposure service for data collection
in order to check redundant subscriptions from different consumers, e.g. which
would produce identical Event Report Information. As a result of the check,
the producer NF shall avoid transmitting redundant information in the Event
Report to supplementary consumer NFs. It is the responsibility of
supplementary consumer NFs to retrieve the missing information from the
original consumer NF.
The efficiency of this solution appears dependant on the ability by an NF to
retrieve already collected data from another NF without signalling impact.
Solution #34 does not document such additional signalling nor coordination
between NWDAFs. Some configuration of the NWDAF is required to know and
maintain the data accessibility rules between NWDAFs.
\- Sol #37 proposes two changes in the Event Exposure service in order to
manage permanent data collection. A technique of signalling reduction, by the
storage of events in a queue with deletion of the oldest events; the retrieval
of remaining events is made by the consumer NF only when required (e.g.
analytics request). Sol #37 also proposes a technique of data volume reduction
by computing preliminary metrics incrementally per Event ID, in order to keep
the trace of historical trends on various time ranges.
\- Sol #38 proposes a change in the Event Exposure service for data collection
in order to avoid Event Reporting when the collected data to report has little
differences with the previous report. Hence, new parameters are defined in
Requests or Subscriptions to specify the value granularity and the type of
reports.
\- Sol #71 proposes a change in the Event Exposure service for data collection
in order to improve the fair representation of the sampled UEs, when using a
sampling ratio. Therefore, a new parameter \"partition criteria\" drives the
selection of UEs in order to obtain more representative samples. A better
fairness in sampling ratio may contribute to reduce the size of samples, hence
reducing signalling load.
The impacts of the proposed solution #33, #34, #37, #38, #71 on the event
exposure service producer and consumer NF are shown in the following table.
Table 7.11.3-1
* * *
            Impact on producer NF: Event Exposure Aspect   Impact on producer NF: Data Storage Aspect   Impact on producer NF: Data Processing Aspect   Impact on consumer NF (other than the request for event exposure)   Signalling reduction
Sol#34 Yes No No Yes No Sol#37 Yes Yes Yes but negligible No Yes Sol#38 Yes
Yes Yes Yes Yes Sol#33 Yes No No No Yes Sol#71 Yes No Yes No Yes
* * *
Some details about the impacts on the event exposure service producer and
consumer NF are provided in the following.
**Impact on event exposure service producer NF: Event Exposure Aspect**
The changes on the event exposure request transmitted from the consumer NF to
the producer NF are evaluated.
The impact on the interface indicates that the information will not be
provided in the Rel-16 NWDAF subscription request and these new solutions will
not be used by the Rel-16 NWDAF.
And on the other hand, since the proposed solutions do not remove any
parameter from the event exposure requests which are defined in the Rel-16,
the Rel-16 NWDAF can still use the event exposure service framework to collect
data.
\- Sol#34: the producer NF needs to check if the received event exposure
subscription request including the additional Accessible NF IDs parameter
meets the redundancy condition;
\- Sol#37: the producer NF needs to halt/resume the notification based on
additional parameters Deactivate notification flags and Activate-deactivate
notification flag;
\- Sol#38: the producer NF needs prepare the notification based on the
additional parameters Event Reporting Granularity and Reporting Type
\- Sol#33: the producer NF needs to support Additional filters for event
exposure service.
\- Sol#71: the producer NF needs to receive a subscription message containing
the additional partition criteria parameter to prepare the notification.
**Impact on event exposure service producer NF: Data Storage Aspect**
Considering that the total amount of the data needed to be stored may be
large, in order to support the proposed solution, more storage resource may be
required for the Rel-17 producer NFs comparing to the Rel-16 ones. This is an
additional requirement on the resource deployment and allocation. And this may
become an impact when the operators try to upgrade the NF to support Rel-17.
An appropriate trade-off must be found between the volume of data that needs
to be stored in NF and the volume and frequency of data collection.
\- Sol#34: No additional data storage is required.
\- Sol#37: the producer NF needs additional storage to store the past
collected events not already sent to the consumer NF and also to store
historical event data for the data aggregation performed at the producer NF.
Moreover, as the storage requirement may be varied for each of the
subscriptions, for example, the aggregation level is different in different
subscription request, the overall data storage requirement of a producer NF
may change dynamically. However, the list of past events may be bounded by a
maximum. The data storage requirements will have even more impacts on the NF
if the option from solution #37 that the event provider NF is configured to
store events for all the UEs it serves without a trigger from the NWDAF is
used.
\- Sol#38: If the Event Reporting Granularity is set: the producer NF need to
store the data of the first Notification. So that for each time there is new
notification, the producer NF can load/read/retrieve the stored notification
and compare it with the data for the difference.
\- Sol#33: No additional data storage is required for the event exposure
producer NF.
\- Sol#71: No additional data storage is required for the event exposure
producer NF.
**Impact on event exposure service producer NF: Data Processing Aspect**
In this part, it is evaluated that comparing to the Rel-16 solution (i.e.
based on the event exposure service requested without the additional
parameters introduced by these solutions), whether or not the producer NF
needs additional data process procedure to be applied on the event exposure
data, especially the data process procedure which is applied with respect to
every single piece of the data. The additional data process procedure may
require more computing resource to be allocated to the NF. The data processing
requires more computing resource when the amount of the generated event data
increases. Similar to the impact on the data storage aspect, the additional
data processing requirement of the proposed solution on data processing may
have impact on the producer NF deployment.
\- Sol#34: No additional data processing is required for the event exposure
producer NF.
\- Sol#37: Depending on the value of aggregation periods, the producer NF may
need additional data processing power (such as calculation power) to perform
the data aggregation. However, as the computation is incremental, the
additional load is negligible. And the aggregation level may have influence on
the data processing power required.
\- Sol#38: If the Event Reporting Granularity is set: when there is new
notification generated, the producer NF needs to calculate the difference
between the new notification and the stored (first) notification. And then,
the producer NF will also need to compare the calculation result with the
Event Reporting Granularity to see whether the calculation result exceeds the
Event Reporting Granularity or not.
\- Sol#33: No additional data processing is required for the event exposure
producer NF.
\- Sol#71: the producer NF need to evaluate each of the event data using the
partition criteria value provided, so that the data can be sorted into
different groups (sub-population/stratum) for further sampling procedures.
\- Within the solutions in this group, the solution #33 introduce minimum
impact on the deployment of the NF which acts as the event exposure service
producer.
**Impacts on Event Exposure Service Consumer NF**
In this part, the consumer NF is evaluated in the cases where the consumer NF
requests the service with and without the proposed additional parameters in
its request. We\'d like to see if there are any additional operations or
additional requirements needed in the consumer NF so that the data received
can be used.
As mentioned in the Impact on interface for subscription request, in all the
proposed solutions, the event exposure service consumer NF needs to support
the corresponding enhancement in the subscription request.
\- Sol#34: Multiple event exposure service consumer NFs, such as NWDAFs, need
accessibility to the same data. (For example, multiple NWDAFs connect to the
same data repository at the same time). In the case where the NWDAF needs to
retrieve the data via other NWDAF, additional signalling is needed with
necessary coordination between NWDAFs. Solution #34 does not document such
additional signalling nor coordination between NWDAFs. Some configuration of
the NWDAF is required to know and maintain the data accessibility rules
between NWDAFs.
\- Sol#37: From the perspective of the event exposure service, there is no
impact on the event exposure service consumer NF.
\- Sol#38: If the Event Reporting Granularity is set, the consumer NF needs to
identify and store the first notification received from the producer NF. And
if the Reporting Type indicates that the arrival notification uses a set of
data that has difference from the previous notification, the consumer NF needs
to calculate what the real data is based on the newly arrival notification and
the previous notification.
\- Sol#33: From the perspective of the event exposure service, there is no
impact on the event exposure service consumer NF. However, for the NWDAF who
acts as the event exposure service consumer NF, the additional filters
proposed in the solution should be supported in the first place.
\- Sol#71: From the perspective of the event exposure service, there is no
impact on the event exposure service consumer NF. However, the knowledge about
the partition criteria value is required especially when such partition
criteria may have a tight relationship with the analysing algorithm
implemented in NWDAF for providing analytic services.
**Evaluation of the range of applicable scenarios**
The proposed solution #33, #34, #37, #38 and #71 can be further separated into
two groups.
\- The solution #38, the data volume reduction part of the solution #37 and
the solution #71 are based on the data within the content of the notification.
\- On the other hand, the solution #33, #34 and the signalling reduction part
in the #37 can work regardless of the content included in the notification. In
other words, the solution #33, #34 and the signalling reduction part of
solution #37 can be applied in scenarios where some other solutions based on
the data within the content of the notification are also applied.
\- Solutions #37 (volume reduction part), #38, #71 can be used as tools for
supporting the quality of data being collected for analytics processes
(training, inference). This solution is introducing metrics on exposed data
from NF. It also introduces bulk data collection. The same is also to be
available in NWDAFs. Therefore, it possible to accomplish this by pre-
processing of data in an NWDAF, which is distributed (perhaps collocated to an
NF).
\- Since the Solution #33, #34 and #37(signalling reduction part) can work
regardless of the content included in the notification, they can be applied in
more scenarios.
\- Solution #34 applies only when NWDAFs have data accessibility between them.
**Evaluation of data collection reduction effect**
The reduction of data collection volume can be evaluated as follows:
\- Solution #33 (Efficiency mechanisms) provide extensions to NFs capabilities
and NF services to allow the reduction of the need for NWDAF (or DCCF if
present) to subscribe to events with \"any UE\" and then sort out the content
and discard the unnecessary data (which leads to waste on transmission of
unnecessary data).
\- Solution #33 (Sobriety) complements the efforts in R16 in order to limit
the amount of data traffic from NFs to NWDAF. Sol #33 introduces the
mechanisms to limit the data transfer from NWDAF to NFs, by enhancing the
subscription and output parameters of NWDAF services.
\- Solutions #37 (reduction of volume part) and #38 focus on enhancement at
the data source in order to process the data to be expose to the consumer.
Sol#37 (reduction of volume part) reduces volume of data by pre-processing
events (e.g., aggregation of data from generated events), while Sol#38
achieves volume reduction based on exclusion of data samples (if not relevant
according to criteria) to be notified in the exposed event. This can also be
done in a distributed NWDAF (perhaps collocated to an NF).
\- One of the benefits of solution #37 (signalling reduction part) is to
reduce signalling load of data collection when the timing to acquire such data
is not sensitive (e.g., training a model, or preparing data to handle future
requests of analytics IDs).
\- The effect of sol #71 is to ensure that relevant data for analytics
processes (training and/or inference) are exposed by the source NFs, therefore
reducing the waste of on collected data which is not representative, or the
need for massive data collection in order to create datasets with good quality
for analytics processes.
\- The partition criteria proposed in solution#71 introduces as stated above
heavy load on the NF performing the partitioning. The load is particular large
for criteria that are \"dynamic\" seen from a UE perspective. This is an
optimization that has little proven gain compared to already existing
mechanism. From this solution only \"static\" criteria shall be progressed. A
Static criteria is a criteria where a UE belongs to the same criteria as long
as it is served by the NF.
\- In Sol# 34, the redundancy among the event exposure notifications is
checked at the producer NF. The signalling caused by the redundant event
notification can be saved. Moreover, if the multiple NWDAFs have the
accessibility to the same data repository (e.g. the multiple NWDAFs are
collocated), the additional signalling for the NWDAF to retrieve data via
another NWDAF can be saved between the producer NF and the NWDAF. In the
scenario where the Rel-16 NWDAFs are also deployed, the Solution #34 can make
the Rel-16 NWDAFs the potential sources of the historical collected data so as
to save more signaling.Sol#34 introduces counter proposals to existing agreed
functionality under Architectural aspects that is making use of DCCF. Where
the DCCF is believed to be used to identify the redundancy. And the DCCF may
also be used to change the Filters accordingly.
### 7.11.4 Signalling reduction via architectural changes
Several solutions address Key Issue #11, some possibly covering additional
aspects of additional Key Issues. This evaluation focuses on solutions
proposing data collection coordination / data storage functionality (referred
to as e.g. DCCF, DCNF, DCC in the different solutions, and referred to as DCCF
in this evaluation), and provide a recap of the options provided by these
different solutions, as per Table 7.11.2-1.
Solutions that are evaluated are solutions #9, #15, #22, #35 and #39. It
should be noted that solution #10 leverages DCCF functionality for two
specific scenarios related to communication between NWDAFs: NWDAF requesting
data for analytics or requesting analytics via DCCF, and transfer of UE
specific statistics between source and target NWDAF with some help from DCCF.
Since solution #10 is using DCCF functionality but is not proposing specific
enhancements for data collection and storage, solution #10 is not included in
this evaluation.
Table 7.11.2-1: Overview for solutions proposing data collection coordination
functionality
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Sol. | Stand | Data | Data | Data | DCCF | Path | Histo | Other | | # | alone | cons | prod | s | pr | for | rical | data | | | NF or | umers | ucers | ource | ofile | not | data | colle | | | part | | | disc | in | ifica | st | ction | | | of | | | overy | NRF, | tions | orage | effic | | | NWDAF | | | | DCCF | from | and | iency | | | | | | | disc | NFs | retr | mecha | | | | | | | overy | | ieval | nisms | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | #9 | Stand | NWDAF | DCCF | By | Supp | Via | Coll | Reuse | | | alone | anal | can | con | orted | mess | ected | or | | | NF. | ytics | co | sumer | S-NS | aging | data | m | | | | func | llect | as | SAIs. | fram | can | odify | | | There | tion. | data | per | | ework | be | exi | | | can | | from | Re | S | (see | s | sting | | | be | NFs | 5GC | l-16, | ource | NOTE | tored | sub | | | mul | to | NFs, | | Types | 1). | in | scrip | | | tiple | re | AFs, | or | that | | sep | tions | | | DCCFs | quest | OAM. | | a | | arate | to | | | in a | analy | | by | DCCF | | data | NFs | | | net | tics. | DCCF | DCCF | co | | r | if | | | work, | | can | ( | ordin | | eposi | there | | | each | Data | co | using | ates. | | tory, | are | | | Data | repos | llect | NRF | | | upon | mul | | | S | itory | data | /UDM/ | Se | | DCCF | tiple | | | ource | can | from | BSF). | rving | | req | data | | | is | use | NWDAF | | area | | uest, | consu | | | assoc | the | when | | (e.g. | | or | mers. | | | iated | fram | data | | list | | upon | | | | with | ework | con | | of | | data | Allow | | | only | to | sumer | | TAIs) | | con | forma | | | one | co | NF | | conta | | sumer | tting | | | DCCF. | llect | req | | ining | | req | of | | | | data. | uests | | Data | | uest. | not | | | | | for | | So | | | ifica | | | | | analy | | urces | | Histo | tions | | | | | tics. | | that | | rical | acco | | | | | | | the | | data | rding | | | | | DCCF | | DCCF | | can | to | | | | | can | | co | | be | condi | | | | | also | | ordin | | retr | tions | | | | | be | | ates. | | ieved | spec | | | | | used | | | | via | ified | | | | | for | | | | DCCF, | by | | | | | anal | | | | e.g., | the | | | | | ytics | | | | when | cons | | | | | req | | | | an | umer, | | | | | uests | | | | NWDAF | to | | | | | by | | | | req | fu | | | | | N | | | | uests | rther | | | | | WDAF, | | | | anal | inc | | | | | with | | | | ytics | rease | | | | | anal | | | | to | effic | | | | | ytics | | | | an | iency | | | | | o | | | | other | for | | | | | utput | | | | N | data | | | | | pro | | | | WDAF. | c | | | | | vided | | | | | ollec | | | | | via | | | | | tion. | | | | | mess | | | | | | | | | | aging | | | | | | | | | | frame | | | | | | | | | | work. | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | #15 | DCCF | NWDAF | NFs. | By | Se | Via | Coll | Reuse | | | can | as | | NWDAF | rvice | DCCF | ected | or | | | be a | cons | | using | area. | or as | data | m | | | sep | umer. | | NRF, | | per | can | odify | | | arate | | | | Ne | Re | be | exi | | | NF or | Data | | or | twork | l-16, | s | sting | | | can | repos | | | s | be | tored | sub | | | be a | itory | | by | lices | tween | in | scrip | | | fun | can | | DCCF. | ( | NFs | stand | tions | | | ction | co | | | S-NSS | and | alone | to | | | ality | llect | | using | AIs). | N | DRF, | NFs | | | of | data | | NRF. | | WDAF. | or an | if | | | NWDAF | from | | | Data | | NWDAF | there | | | (see | DCCF | | | types | | with | are | | | NOTE | or | | | it | | DRF | mul | | | 2). | distr | | | can | | fea | tiple | | | | ibute | | | co | | ture. | data | | | There | NWDA | | | llect | | | consu | | | can | F(s). | | | ( | | Histo | mers. | | | be | | | | indiv | | rical | | | | mul | | | | idual | | data | D | | | tiple | | | | input | | can | istri | | | D | | | | data | | be | buted | | | CCFs. | | | | de | | retr | ne | | | | | | | fined | | ieved | twork | | | | | | | in | | by | ar | | | | | | | TS 23 | | DCCF. | chite | | | | | | | .288 | | | cture | | | | | | | [5] | | | and | | | | | | | for | | | avoid | | | | | | | each | | | s | | | | | | | anal | | | ingle | | | | | | | ytics | | | point | | | | | | | ID). | | | of | | | | | | | | | | fai | | | | | | | DNN | | | lure. | | | | | | | also | | | | | | | | | | l | | | | | | | | | | isted | | | | | | | | | | as a | | | | | | | | | | pos | | | | | | | | | | sible | | | | | | | | | | param | | | | | | | | | | eter. | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | #22 | Spe | NWDAF | Data | By | | Via | NWD | | | | cific | as | coll | N | | NWDA | AFdsf | | | | NWD | cons | ected | WDAF. | | Fdsf. | c | | | | AFdsf | umer. | from | | | | aches | | | | is | | 5GC | | | | the | | | | i | | NFs, | | | | coll | | | | ntrod | | AF. | | | | ected | | | | uced. | | | | | | data. | | | | | | | | | | | | | | There | | | | | | It is | | | | may | | | | | | up to | | | | be | | | | | | NWD | | | | mul | | | | | | AFdsf | | | | tiple | | | | | | impl | | | | NWD | | | | | | ement | | | | AFdsf | | | | | | ation | | | | dep | | | | | | to | | | | loyed | | | | | | h | | | | in a | | | | | | andle | | | | PLMN, | | | | | | the | | | | e.g. | | | | | | c | | | | each | | | | | | ached | | | | per | | | | | | data, | | | | data | | | | | | e.g. | | | | ce | | | | | | the | | | | ntre. | | | | | | NWD | | | | | | | | | | AFdsf | | | | | | | | | | drops | | | | | | | | | | the | | | | | | | | | | c | | | | | | | | | | ached | | | | | | | | | | data | | | | | | | | | | if it | | | | | | | | | | has | | | | | | | | | | not | | | | | | | | | | e | | | | | | | | | | nough | | | | | | | | | | st | | | | | | | | | | orage | | | | | | | | | | or | | | | | | | | | | the | | | | | | | | | | c | | | | | | | | | | ached | | | | | | | | | | data | | | | | | | | | | be | | | | | | | | | | comes | | | | | | | | | | inv | | | | | | | | | | alid. | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | #35 | DCNF | NWDAF | Data | By | The | Via | Data | Reuse | | | can | as a | coll | DCNF. | DCNF | DCNF. | s | or | | | be a | cons | ected | | may | | tored | m | | | fun | umer. | from | M | in | | lo | odify | | | ction | | 5GC | ethod | clude | | cally | exi | | | ality | | NFs, | 1: | in | | in | sting | | | of | | AF. | | the | | DCNF, | sub | | | NWDAF | | | DCNF | re | | tempo | scrip | | | or | | | deter | gistr | | rary. | tions | | | can | | | mines | ation | | | to | | | be a | | | from | re | | When | NFs | | | stand | | | the | quest | | the | if | | | alone | | | list | the | | DCNF | there | | | NF | | | of | Se | | deter | are | | | suppo | | | E | rvice | | mines | mul | | | rting | | | vents | Area | | that | tiple | | | a | | | the | supp | | a | data | | | dedi | | | NF | orted | | s | consu | | | cated | | | types | (e.g. | | econd | mers. | | | data | | | that | ge | | NWDAF | | | | colle | | | needs | ograp | | has | | | | ction | | | to be | hical | | subsc | | | | fun | | | conta | area, | | ribed | | | | ction | | | cted. | or | | to an | | | | ality | | | DCNF | cell | | exi | | | | (see | | | is | ID, | | sting | | | | NOT | | | confi | TAI) | | Event | | | | E 3). | | | gured | and a | | ID | | | | | | | with | list | | sub | | | | There | | | the | of | | scrip | | | | can | | | NF | S-NSS | | tion, | | | | be | | | types | AI(s) | | the | | | | mul | | | that | indic | | DCNF | | | | tiple | | | pr | ating | | for | | | | DCNFs | | | ovide | the | | wards | | | | (i.e. | | | the | ne | | not | | | | a | | | Event | twork | | ifica | | | | DCNF | | | ID. | s | | tions | | | | per | | | | lices | | of | | | | Se | | | M | suppo | | the | | | | rvice | | | ethod | rted. | | exi | | | | A | | | 2: | | | sting | | | | rea). | | | | | | su | | | | | | | DCNF | | | bscri | | | | | | | deter | | | ption | | | | | | | mines | | | for | | | | | | | the | | | this | | | | | | | NF | | | Event | | | | | | | se | | | and | | | | | | | rving | | | also | | | | | | | the | | | pro | | | | | | | UE as | | | vides | | | | | | | per | | | all | | | | | | | TS 23 | | | avai | | | | | | | .288 | | | lable | | | | | | | [5] | | | local | | | | | | | ( | | | data | | | | | | | using | | | for | | | | | | | NR | | | this | | | | | | | F/UDM | | | Event | | | | | | | /BSF) | | | to | | | | | | | | | | the | | | | | | | | | | s | | | | | | | | | | econd | | | | | | | | | | N | | | | | | | | | | WDAF. | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | #39 | N/A | NWDAF | Same | N/A | N/A | As | D | | | | | as | as | | | per | irect | | | | | cons | Re | | | Re | a | | | | | umer. | l-16. | | | l-16, | ccess | | | | | | | | | be | to | | | | | | | | | tween | Data | | | | | | | | | NFs | Repos | | | | | | | | | and | itory | | | | | | | | | N | and | | | | | | | | | WDAF. | St | | | | | | | | | | orage | | | | | | | | | | Fun | | | | | | | | | | ction | | | | | | | | | | ( | | | | | | | | | | DRSF) | | | | | | | | | | by | | | | | | | | | | NWDAF | | | | | | | | | | for | | | | | | | | | | st | | | | | | | | | | oring | | | | | | | | | | and | | | | | | | | | | for | | | | | | | | | | retri | | | | | | | | | | eving | | | | | | | | | | data. | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | NOTE | | | | | | | | | | 1: A | | | | | | | | | | mess | | | | | | | | | | aging | | | | | | | | | | fram | | | | | | | | | | ework | | | | | | | | | | is | | | | | | | | | | also | | | | | | | | | | pro | | | | | | | | | | posed | | | | | | | | | | in | | | | | | | | | | sol | | | | | | | | | | ution | | | | | | | | | | #1, | | | | | | | | | | but | | | | | | | | | | with | | | | | | | | | | no | | | | | | | | | | data | | | | | | | | | | colle | | | | | | | | | | ction | | | | | | | | | | co | | | | | | | | | | ordin | | | | | | | | | | ation | | | | | | | | | | func | | | | | | | | | | tion, | | | | | | | | | | i.e. | | | | | | | | | | N | | | | | | | | | | WDAFs | | | | | | | | | | dir | | | | | | | | | | ectly | | | | | | | | | | a | | | | | | | | | | ccess | | | | | | | | | | the | | | | | | | | | | mess | | | | | | | | | | aging | | | | | | | | | | fram | | | | | | | | | | ework | | | | | | | | | | (via | | | | | | | | | | 3GPP | | | | | | | | | | Con | | | | | | | | | | sumer | | | | | | | | | | Adap | | | | | | | | | | tor). | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: | | | | | | | | | | Sol | | | | | | | | | | ution | | | | | | | | | | #15 | | | | | | | | | | does | | | | | | | | | | not | | | | | | | | | | des | | | | | | | | | | cribe | | | | | | | | | | how | | | | | | | | | | this | | | | | | | | | | works | | | | | | | | | | when | | | | | | | | | | DCCF | | | | | | | | | | fun | | | | | | | | | | ction | | | | | | | | | | ality | | | | | | | | | | is | | | | | | | | | | part | | | | | | | | | | of | | | | | | | | | | N | | | | | | | | | | WDAF. | | | | | | | | | | Sol | | | | | | | | | | ution | | | | | | | | | | #16 | | | | | | | | | | (for | | | | | | | | | | bott | | | | | | | | | | om-up | | | | | | | | | | coo | | | | | | | | | | rdina | | | | | | | | | | tion) | | | | | | | | | | and | | | | | | | | | | sol | | | | | | | | | | ution | | | | | | | | | | #18 | | | | | | | | | | (for | | | | | | | | | | top | | | | | | | | | | -down | | | | | | | | | | appr | | | | | | | | | | oach) | | | | | | | | | | men | | | | | | | | | | tions | | | | | | | | | | NWDAF | | | | | | | | | | h | | | | | | | | | | aving | | | | | | | | | | DCC | | | | | | | | | | func | | | | | | | | | | tiona | | | | | | | | | | lity. | | | | | | | | | | Sol | | | | | | | | | | ution | | | | | | | | | | #18 | | | | | | | | | | does | | | | | | | | | | not | | | | | | | | | | expli | | | | | | | | | | citly | | | | | | | | | | list | | | | | | | | | | K | | | | | | | | | | I#11 | | | | | | | | | | as | | | | | | | | | | addr | | | | | | | | | | essed | | | | | | | | | | Key | | | | | | | | | | Issue | | | | | | | | | | (see | | | | | | | | | | c | | | | | | | | | | lause | | | | | | | | | | 6.1 | | | | | | | | | | 8.1). | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 3: No | | | | | | | | | | d | | | | | | | | | | escri | | | | | | | | | | ption | | | | | | | | | | avai | | | | | | | | | | lable | | | | | | | | | | for | | | | | | | | | | the | | | | | | | | | | sol | | | | | | | | | | ution | | | | | | | | | | when | | | | | | | | | | fun | | | | | | | | | | ction | | | | | | | | | | ality | | | | | | | | | | is | | | | | | | | | | part | | | | | | | | | | of | | | | | | | | | | N | | | | | | | | | | WDAF. | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
From Table 7.11.2-1 the following observations are made:
\- Observation 1: Solutions #9, #15, #22 and #35 have in common a dedicated
data collection coordination functionality. The functionality is mainly
proposed as a standalone NF. When the functionality is provided by an NWDAF it
may need further details. Whether DCCF is an NWDAF specific functionality or a
new NF might depend on which data consumers to provide this service to.
\- Observation 2: Solution #9 has a wider scope in terms of possible data
consumers than other solutions. It would be needed to define which consumers
can access services provided by data collection coordination functionality,
and for which type of data (e.g. event notifications, analytics outputs).
\- Observation 3: From data producer perspective, it is assumed that all
solutions allow collecting data from similar entities as per Rel-16, i.e. NFs,
AFs, OAM. Solution #9, in addition, explicitly proposes that data can be
collected from NWDAF. It would be needed to define which data sources can be
coordinated by the data collection coordination functionality.
\- Observation 4: There are some small variants between solutions regarding
which entity finds the right data source. Some solutions (#9, #15
(Alternative#1)) allow both the data consumer and the DCCF to find the right
data source, solution #15 (Alternative#2) and #22 leaves the functionality in
the data consumer, and solution #35 only allows DCCF to find the right data
source.
\- Observation 5: For DCCF registration and discovery via NRF: most solutions
propose that DCCF registers supported slices and area. Solution #9 proposes to
also register the NF type supported by DCCF, while solution #15 proposes to
register the supported data types.
\- Observation 6: For data notifications path, solutions #15 (Alternative#1),
#22 and #35 propose that DCCF receives and forwards all notifications, while
solution #9 and solution #15(Alternative#2) explicitly separates Data
Collection Coordination (by a DCCF) from Data Collection via a messaging
framework. Solution #9isolates the signalling / control functions to
subscribe/unsubscribe to notifications, discover Data Sources, and ensure
redundant data is not requested from a Data Source (all handled by the DCCF)
from the handling and processing of a potentially large number of
notifications sent by via a messaging framework. The difference between
solution #9 and solution #15(Alternative#2) is the path for notifications from
NFs to NWDAF, the notifications directly send between NFs to NWDAF (point to
point, As per Rel-16) rather than via a messaging framework.
\- Observation 7: For data storage, two different approaches are proposed:
local caching in DCCF for temporary usage (solutions #22 and solution #35), or
storage in a data repository for longer-term usage (solutions #9 and #39).
\- Observation 8: All solutions relying on DCCF leverage modification or reuse
of subscriptions from DCCF to NFs. In addition, solution #9 proposes some
further enhancement to efficient data collection via formatting options for
the notifications of data.
\- Observation 9: All solutions introducing DCCF functionality would need
review by SA WG3 to investigate possible additional authorization for
Consumers to access data from a Data Source via the DCCF.
\- Observation 10: for backward compatibility, although only solution #9
provides related information, it is assumed that all solutions from Table
7.11.2-1 provide the same level of compatibility. The consumer of new services
from DCCF will be Rel-17 consumers, and Rel-16 consumers will continue to
collect data directly from the NFs. Also, the solutions are compatible with
Rel-16 data producers as no enhancement has been identified for the interface
between DCCF and the data producer as part of these solutions.
\- Observation 11: All solutions introducing additional NFs (e.g. DCCF, DRF)
assume that several NWDAFs will request the same data from producer NFs.
Besides, introducing a new NF will inevitably result in two flows (NF to DCCF
to NWDAF, or NF to NWDAF via messaging framework) of data collection instead
of one (NF to NWDAF). Care needs to be taken so that the new NF (e.g. DCCF,
DRF) does not become the new signalling bottleneck. Existing solutions such as
set concept for DCCFs, or deploying several DCCF instances (e.g. per type of
data source) can be applied to mitigate such problems.
\- Observation 12: Solution #15(Alternative#2) introduces a different method
of DCCF compare with other solutions that used DCCF. Comparing with the
Observation 11, there is only one data flow transferred between the NFs and
NWDAF, which avoids additional data transfer steps with DCCF. The NWDAF can
register/update the data profile that contains the parameters of collected
data to the DCCF, the profile is used to help DCCF coordinate the signalling
of data collection.
## 7.12 Key Issue #12: NWDAF-assisted RFSP policy
For Key Issue #12 \"NWDAF-assisted RFSP policy\" six Candidate Solutions have
been proposed. Candidate solutions #4, #30, #40, #41, #42 and #43 all serve
the purpose of providing analytics information by NWDAF to support NFs to
assist on RAT and frequency selection. Solution #43 is merged into Solution
#4.
Candidate Solution #4 proposes that the RFSP index value is assigned by PCF,
as the consumer of NWDAF, using both the analytics result of \"Service in
use\" and \"Observed Service experience\".
The \"Service in use\" analytics is a new-defined analytics in which NWDAF
collects input data from the AF (possibly via NEF) to determine the
applications a UE consumes. The analytics \"Service in use\" appears partially
redundant with the analytics \"UE communication\", which is possible to
improve the last one rather than adding a new analytics.
The solution also proposes to enhance the input of \"Observed Service
Experience\" with \"subscriber category\" from UDR/PCF and RAT/Frequency
information from OAM.
Candidate Solution #30 proposes that the RFSP index is assigned by PCF, as
consumer of NWDAF using both the analytics result from \"User Data
Congestion\" as defined in solution #40, that provides a list of TAIs or Cell
Ids and their congestion level, and then using the analytics results from
\"Dispersion Analytics\" that provides the list of heavy users and the data
they dispersed. Then, the PCF can change the RFSP index value for some users
that are causing most of the traffic with the aim of mitigating the data
congestion in the area.
Candidate Solution #41 suggests NWDAF provides a new analytic,
\"Radio/Frequency usage\", on information about the current/future usage of
RAT/frequency for a specific area. Based on this analytics, PCF can decide to
assign the RFSP index value to serve the usage demand per RAT/frequency.
According to the solution description, the PCF or OAM can decide to manage
base stations or radio resources by figuring out the usage demand per
RAT/frequency. The data volume analytics from solution #41 is addressed by the
Data dispersion analytics proposed by solution #30.
Candidate Solution #42 contains a functional diagram on what information from
NFs and OAM could help NWDAF to perform analytics and generate
statistics/prediction outputs related to RFSP index to NF consumers. It is
proposing a high-level framework and it needs to provide more detailed
explanation before evaluation.
Based on the list of solutions described above the following functional
aspects are considered: the procedures that may require a change of the RFSP
value, the Analytics IDs that can be used in those procedures.
Regarding the procedures that may require a change of RFSP value:
\- A procedure to mitigate user data congestion includes the detection of
congested areas, and the users that dispersed most of the traffic at the areas
and the allocations of an RSFP value that moves the users to a different RAT
or a different frequency. Then both Analytics IDs for \"User Data congestion\"
and for \"Data dispersion\" can be used as input to RFSP value allocation at
the PCF.
\- A procedure to move users consuming services, like e.g. with large
bandwidth and low latency requirements from 4G E-UTRAN to 5G NR to have an
efficient use of radio resources. Similarly, users consuming services e.g.
without large bandwidth and low latency requirements can be moved to 4G
E-UTRAN when camping in 5G NR. Then both Analytics IDs for \"Service in use\"
and for \"Observed Service Experience\" can be used as input to the RFSP value
allocation decision at the PCF.
NOTE: The Analytics ID is one of the possible inputs for the PCF to allocate a
RFSP value, and other input data can be used as those listed in TS 23.503 [4],
including location, subscriber category or time of day.
Regarding the Analytics IDs that used in the procedures above:
Analytics IDs for \"User Data Congestion\", \"Dispersion Analytics\" (Data
dispersion), \"Service in use\" and \"Observed Service Experience\" can be
used.
Other aspects:
In relation to Solution #41, the solution description says: \"The solution
provides statistics/predictions to PCF to decide proper RFSP index to lead UEs
into desirable RAT/frequency by NWDAF. NWDAF provides analytics information
about the current/future usage of RAT/frequency for a specific area\" and then
Solution #41 provides the following example: \'in region A, 20 E-UTRA users
and 5 NR users, and 3 users are using low frequency NR and 2 users are using
high frequency NR. Based on this analytics, PCF or OAM can decide to manage
base stations or radio resources by figuring out the usage demand per
RAT/frequency\'\".
There are two aspects to take into account:
1\. The PCF does not manage base stations and OAM is not within the scope of
SA2 work. As such solution #41 is better addressed in SA WG5.
2\. Even if the statistics and predictions on the number of UEs per RAT and
Frequency can be made available, this solution does not describe how the PCF
can assign RFSP values based on that additional info.
## 7.13 Key Issue #13: Triggering conditions for analytics
For Key Issue #13 \"Triggering conditions for analytics\", there are solutions
mainly as follows:
\- Solution #10: Handling of mixed and distributed NWDAF deployments.
\- Solution #37: Reduction of Frequency from NFs.
\- Solution #44: Analytics for Session Management Congestion Control
Experience.
\- Solution #45: Triggers for requesting analytics.
\- Solution #65: Triggers for data collection from the UEs.
\- Solution #73: Trigger configuration for data collection and analytics.
\- Solution #74: Triggers for requesting analytics.
\- Solution #75: AF influencing NFs triggers for interactions with NWDAF.
Solution #10 proposes mixed and distributed NWDAF deployment when multiple
NWDAFs are deployed in a network. Solution #10 mainly addresses KI#2
\"Multiple NWDAF instances\" and KI#11\"Increasing efficiency of data
collection\", and therefore can be further evaluated and concluded under KI#2
and/or KI#11.
Solution #37 proposes that the NWDAF can activate or deactivate the reception
of notifications from the NFs, which allows NWDAF to collect data from NFs in
bulks and reduce the signalling for notifications between the NFs and NWDAF.
Solution #37 mainly addresses KI#11 \"Increasing efficiency of data
collection\" and therefore can be further evaluated and concluded under KI#11.
Solution #65 proposes that the NWDAF decides when to trigger data collection
from UEs based on the notification from the AMF on the ratio/number of UEs
supporting data for analytics in e.g. a given area or a slice. Solution #65
addresses also KI#8 \"UE data as an input for analytics generation\" and is
highly dependent on the assumption and conclusion of KI#8, so it can be
further evaluated and concluded under KI#8.
Solution #44 introduces a new Analytics ID \"Session Management Congestion
Control Experience (SMCCE)\", where the SMF uses potential congestion
condition as trigger to request for the SMCCE analytics to the NWDAF.
Solution #45 proposes that the analytics consumers (e.g. PCF, AMF, SMF)
request for or subscribe to analytics from the NWDAF, based on triggers (e.g.
event reports or requests) from other NF(s), local event, analytics
information received, and etc.
Solution #73 proposes that the PCF provides the configuration on triggering
conditions for data collection and analytics as network analytics control
information to the NWDAF and to analytics consumers (e.g. AMF, SMF), and the
AF may provide service specific analytics control information to the PCF for
setting the network analytics control information for specific
applications/services.
Solution #74 highlights that NF selection and Slice selection procedures may
trigger analytics consumers to request for or subscribe to analytics from the
NWDAF.
Solution #75 proposes that the AF provides the Analytics Subscription
Information (ASI), which defines the restriction and/or permission of
analytics IDs for specific UEs or group of UEs, to support the refinement of
the configuration of the target of analytics IDs by analytics consumers when
triggering analytics ID subscriptions or analytics ID requests.
Table 7.13-1 gives the comparison of candidate solutions for Key Issue#13.
Table 7.13-1: Comparison of solutions for Key Issue#13
+---------+---------+---------+---------+---------+---------+---------+ | So | Aspects | I | Other | | | | | lutions | ad | mpacted | c | | | | | | dressed | | omments | | | | | | for the | | | | | | | | Key | | | | | | | | Issue | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | T | T | T | Config | | | | | riggers | riggers | riggers | uration | | | | | for | for | for | for | | | | | req | data | an | t | | | | | uesting | col | alytics | riggers | | | | | or | lection | gen | | | | | | subs | by | eration | | | | | | cribing | NWDAF | by | | | | | | to | | NWDAF | | | | | | an | | | | | | | | alytics | | | | | | | | by | | | | | | | | an | | | | | | | | alytics | | | | | | | | co | | | | | | | | nsumers | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | 10 | √ | | | | NWDAF, | Mainly | | | | | | | an | add | | | | | | | alytics | ressing | | | | | | | c | KI#2 | | | | | | | onsumer | and | | | | | | | NFs. | #11. | | | | | | | | Can be | | | | | | | New | ev | | | | | | | par | aluated | | | | | | | ameters | and | | | | | | | defined | co | | | | | | | for | ncluded | | | | | | | e | under | | | | | | | xisting | KI# | | | | | | | se | 2/#11. | | | | | | | rvices. | | +---------+---------+---------+---------+---------+---------+---------+ | 37 | | √ | | | NWDAF, | Mainly | | | | | | | data | add | | | | | | | p | ressing | | | | | | | rovider | KI#11. | | | | | | | NFs. | Can be | | | | | | | | ev | | | | | | | New | aluated | | | | | | | par | and | | | | | | | ameters | co | | | | | | | defined | ncluded | | | | | | | for | under | | | | | | | e | KI#11. | | | | | | | xisting | | | | | | | | se | | | | | | | | rvices. | | +---------+---------+---------+---------+---------+---------+---------+ | 44 | √ | | | yes | SMF, | | | | | | | | NWDAF. | | | | | | | | | | | | | | | | New | | | | | | | | an | | | | | | | | alytics | | | | | | | | ID | | | | | | | | d | | | | | | | | efined. | | +---------+---------+---------+---------+---------+---------+---------+ | 45 | √ | i | i | yes | An | | | | | nternal | nternal | | alytics | | | | | | | | c | | | | | | | | onsumer | | | | | | | | NFs. | | | | | | | | | | | | | | | | No | | | | | | | | changes | | | | | | | | to | | | | | | | | e | | | | | | | | xisting | | | | | | | | se | | | | | | | | rvices. | | +---------+---------+---------+---------+---------+---------+---------+ | 65 | N/A | N/A | N/A | N/A | | Also | | | | | | | | add | | | | | | | | ressing | | | | | | | | and | | | | | | | | highly | | | | | | | | depends | | | | | | | | on | | | | | | | | KI#8. | | | | | | | | Can be | | | | | | | | ev | | | | | | | | aluated | | | | | | | | and | | | | | | | | co | | | | | | | | ncluded | | | | | | | | under | | | | | | | | KI#8. | +---------+---------+---------+---------+---------+---------+---------+ | 73 | √ | √ | √ | √ | PCF, | Add | | | | | | | NWDAF, | ressing | | | | | | Pr | an | also | | | | | | ovision | alytics | KI#18 | | | | | | of | c | on data | | | | | | an | onsumer | collec | | | | | | alytics | NFs, | tion/an | | | | | | control | AF. | alytics | | | | | | info | | enhan | | | | | | rmation | For | cements | | | | | | to | pr | of | | | | | | A | ovision | re | | | | | | MF/SMF, | of | al-time | | | | | | or | an | commun | | | | | | Network | alytics | ication | | | | | | An | control | with | | | | | | alytics | info | NWDAF | | | | | | policy | rmation | | | | | | | to | to | | | | | | | NWDAF, | A | | | | | | | by the | MF/SMF, | | | | | | | PCF. | new | | | | | | | | par | | | | | | | AF may | ameters | | | | | | | be | defined | | | | | | | in | for | | | | | | | volved. | e | | | | | | | | xisting | | | | | | | | se | | | | | | | | rvices. | | | | | | | | | | | | | | | | For | | | | | | | | pr | | | | | | | | ovision | | | | | | | | of | | | | | | | | Network | | | | | | | | An | | | | | | | | alytics | | | | | | | | policy | | | | | | | | to | | | | | | | | NWDAF, | | | | | | | | new | | | | | | | | s | | | | | | | | ervices | | | | | | | | d | | | | | | | | efined. | | +---------+---------+---------+---------+---------+---------+---------+ | 74 | √ | | | | An | | | | | | | | alytics | | | | | | | | c | | | | | | | | onsumer | | | | | | | | NFs. | | | | | | | | | | | | | | | | No | | | | | | | | changes | | | | | | | | to | | | | | | | | e | | | | | | | | xisting | | | | | | | | se | | | | | | | | rvices. | | +---------+---------+---------+---------+---------+---------+---------+ | 75 | | | | √ | AF, | Sup | | | | | | | UDM, | porting | | | | | | Pr | an | the | | | | | | ovision | alytics | config | | | | | | of | c | uration | | | | | | an | onsumer | of the | | | | | | alytics | NFs. | target | | | | | | subsc | | of | | | | | | ription | New | an | | | | | | info | s | alytics | | | | | | rmation | ervices | IDs | | | | | | (ASI) | d | used by | | | | | | via the | efined. | the NFs | | | | | | UDM. AF | | to | | | | | | in | | sub | | | | | | volved. | | scribe/ | | | | | | | | request | | | | | | | | an | | | | | | | | alytics | | | | | | | | IDs to | | | | | | | | NWDAF. | +---------+---------+---------+---------+---------+---------+---------+
## 7.14 Key Issue #14: NWDAF-assisted application detection
For KI #14, Solutions #46 has been proposed to address the following issues:
\- Study on how to detect applications assisted by the NWDAF.
\- What kind of data need to be collected for application detection?
\- What kind of analytics should be exposed?
The solution #46 defines the input and output parameters for generation of
analytics information that can be used to detect application traffic not
specified by PFDs at UPF. It also defines the related procedures for data
collection from NFs and AFs, and analytics exposure between NWDAF and its
consumers.
In the Solution #46, the NWDAF provides a consumer NF with a PFD information
that is generated for unspecified traffic based on analysis of input data from
the UPF, including packet\'s URL, packet\'s Domain Name, and IP 3-tuple etc.
The NWDAF also uses historical PFD information, which it receives from the NEF
(PFDF) for the known applications, to detect changed traffic characteristics
and provide an updated PDF information for those applications.
## 7.15 Key Issue #15: User consent for UE data collection/analysis
Key Issue 15 has two complementary solutions:
Solution 3 (User consent for UE data collection) introduces User consent for
the UE data collection. The User consent for UE data collection may be
provided by the service provider via the NEF or directly by the network
operator and stored in the UDM as a subscription information which can be
retrieved by the User consent for UE data collection may define the user
consent for UE level data collection from UE or application or NFs. Before
initiating UE data collection and reporting by the UE, data consumers (e.g.
NWDAF(s)) request for user consent from UDM. Solution 3 addresses all the
architectural requirements of Key Issue 15.
Solution 76 (Revocation of user consent) introduces a functionality (User
Consent Tracking Functionality, URDCF) tracking the distribution and usage of
any user related information subject to user consent. In case of a revocation
of the user consent, past data consumers affected by this revocation are
identified and informed about the revocation requesting them to delete any
user related data subject to the revoked user consent. The proposed
functionality may be provided by the NWDAF or a Data Collection Function (e.g.
DCCF, DCNF).
Solution #3 and Solution #76 are complementing each other. While Solution #3
defines the user consent provision in the UDM and its retrieval by the NWDAF
and the AMF, Solution #76 further defines the UE related data management
within the 3GPP system that is subject to user consent. Both solutions have no
UE impact.
## 7.16 Key Issue #16: UP optimization for edge computing
Solutions 31, 48, 49(alternative 2), 50 and 51 have similarities as they
propose the NWDAF to collect performance data from each SMF/AMF/UPF and AF
that is used by the NWDAF to derive analytics of service experience per
UPF/DNAI path. If the consumer NF is an SMF, the SMF may use the enhanced
service experience analytics to select the UPF/DNAI path for a PDU Session. If
the consumer NF is an AF, the AF can determine if DNAI relocation is required
and/or service parameters adjusting is required.
Solutions31 and 49 (alternative 2) propose to enhance the service experience
analytics defined in TS 23.288 [5] including in the Analytic Output the
Service Experience per DNAI/UPF path and/or per Application Server instance.
In addition, depending on the work carried out in edge computing a consumer NF
can use the enhanced analytics to select an application server instance that
has optimal performance at the UE location.
Sol#48, 49 (alternative 1), 50 also propose the NWDAF to derive a new
analytics of performance analytics per UPF&DNAI path to provide Bandwidth/RTT
per DNAI (as defined in solution 50) and Performance of Application Server per
DNAI (as defined in solution 49) and EC service performance analytics (as
defined in solution 48).
Solution 47 proposes the NWDAF to collect data related to UE mobility/presence
in an LADN area and derive UE Presence Pattern analytics in LADN service area
that is used by a consumer NF (e.g. SMF) to determine when to release a PDU
session or deactivate user plane resources for the PDU session.
## 7.17 Key issue #17: Definition of accuracy levels
The Key Issue #17 aims to define various mechanisms to be implemented by NWDAF
and NFs on the parameter Accuracy, in order to clarify the semantics and
refine the notion of accuracy for better control.
The solution #52 \"Accuracy levels and options\" proposes to define additional
values, and to be able to express different accuracy requirements for subsets
of the expected analytics set.
The principle of the solution is interesting, provided that the accuracy
constraints can be expressed simply in order to keep protocol efficiency.
## 7.18 Key Issue #18: Enhancement for real-time communication with NWDAF
There are three solutions proposed for the Key Issue#18: Solution#38, #54
(merged with solution#55) and #55.
**For solution #38:**
This solution is more focus on how to avoid duplicated data collection (i.e.
for Key Issue#11) and should be evaluated under Key Issue#11.
**For solution #54** (merged with solution#55)**:**
It proposes the NWDAF to register its Supported Analytics Delay per Analytics
ID in NRF during the NWDAF registration procedure.
The consumer NF discovers a candidate NWDAFs list via NRF. Each NWDAF in the
list supports to provide the network data analytics for the requested
Analytics ID within the Supported Analytics Delay registered in the NWDAF
profile. The consumer NF determines a suitable NWDAF by comparing its Expected
Analytics Delay with the Supported Analytics Delay of each candidate NWDAF.
The determination of Supported Analytics Delay, and how the NWDAF avoid
updating its Supported Analytics Delay in NRF frequently is NWDAF
implementation specific.
**For solution #55:**
The mechanism proposed by Solution#55 is similar to Solution#54. The target
NWDAF is determined by comparing the requirement of the consumer NF (required
analytics delay) and the capability of the NWDAF. The difference is: in
solution#55 the consumer NF needs to do extra interaction with the NWDAF to
aware whether it can perform real-time communication with the NWDAF.
## 7.19 Key Issue #19: Trained data model sharing between multiple NWDAF
instances
For Key Issue #19, there are multiple solutions such as solution #5, 6, 7, 8,
24, 56 but only the following solution #56 is closely related:
\- Solution #56: the mechanism for trained ML model discovery, provision,
update and consumption between NWDAF instances.
Solution #56 supports general ML model sharing between NWDAF instances with
optional online training data set sharing and also solutions developed in KI#1
(e.g., solution #5, 6, 7, 8) and KI#2 (e.g., solution #24) describe ML model
sharing between multiple NWDAF instances with the following aspects:
\- Key Issue 1:
\- Services and its parameters for initial or aggregated ML model provisioning
from the Model Training Functionality in a NWDAF to the Analytics
Functionality in another NWDAF or to another Model Training Functionality;
\- Key Issue 2:
\- Services and its parameters for initial or aggregated ML model provisioning
from a Server NWDAF to a Client NWDAF;
\- Services and its parameters for updated ML model parameters reporting from
a Client NWDAF to a Server NWDAF.
The model sharing scenarios in solution #5, 6, 7, 8, 24 and the services
defined in solution #56 are built upon the assumption that models can be
shared between different NWDAFs with optional online training data set sharing
in which the ML Model Producer NWDAF may use such training data information
from ML Model Consumer NWDAF to update its ML Model.
While this is true for NWDAFs from the same vendor , since NWDAF
implementation specifics is not specified nor shared in a multi-vendor
environment, models cannot be shared between NWDAFs from different vendors.
Sharing between vendors requires extensive standardization of model
technologies and model execution environment, which need to be decided and
agreed upon if it shall be specified in 3GPP. The TR specification of call
flows and interfaces allows NWDAF\'s to exchange information but doesn\'t
guarantee interoperability of models for multi-vendor.
## 7.20 Key Issue #20: NWDAF assisting in detecting anomaly events for the
user plane
For KI#20, no solution was provided.
## 7.21 Key Issue #21: NWDAF assisting in user plane performance
Key Issue #21 \"NWDAF assisting in user plane performance\" has only one
solution as below:
\- Solution #77 \"NWDAF assisted Per Access Network Performance\" proposes two
alternatives:
\- Alternative#1: a new Analytics ID \"Per Access Network Performance\" is
proposed to provide statistics and predictions about network performance over
3GPP access and non-3GPP access for specific DNN, S-NSSAI, Application ID
and/or area in a form of Network Performance Level over Access Type.
\- Alternative#2: an extension of the existing Observed Service Experience
analytics defined in clause 6.4 of TS 23.288 [5]. As extension to the output
analytics described in clause 6.4.3 of TS 23.288 [5], Access Type information
is added to indicate which access type the analytics is applied to (i.e. 3GPP
access or non-3GPP access).
In this solution, the NWDAF analytics are used by the PCF to set the ATSSS
Steering mode in the PCC rules resulting in improving user plane performance,
e.g. the UL/DL throughput, the packet loss rate, the RTT, etc. possibly per
application.
It is considered that Alternative#2 is the simpler approach than
Alternative#1.
# 8 Conclusions
## 8.1 Key Issue #1: Logical decomposition of NWDAF and possible interactions
between logical functions
An NWDAF can be decomposed into two logical functions:
> \- Model Training logical function: An NWDAF containing the Model Training
> logical function trains ML models and exposes new training services (e.g.
> providing trained model);
>
> \- Analytics logical function: An NWDAF containing the Analytics logical
> function can perform inference, derive analytics information (i.e. derives
> statistics and/or predictions based on Analytics Consumer request) and
> expose analytics service, reusing the Nnwdaf_AnalyticsSubscription or
> Nnwdaf_AnalyticsInfo as defined in clause 7, TS 23.288 [5]. No new services
> are required.
NOTE 1: Model Training logical function is not always required to be involved
to provide output analytics. In particular, delivery of statistics may not
require operation of the Model Training logical function.
NOTE 2: Analytics logical function is not always required to perform
inference, depending on analytics requested.
NOTE 3: Model Training logical function and Analytics logical function can be
deployed as standalone NWDAFs.
NOTE 4: It can also be possible to identify other standalone NF(s) based on
other KI results, e.g. Data Collection function. Conclusions for Key Issue #1
do not address possible NWDAF decomposition for data collection as this is
part of Key Issue #11: Increasing efficiency of data collection.
NOTE 5: Messaging framework can be used between the decomposed functions from
Key Issue #11: Increasing efficiency of data collection.
NOTE 6: The definition of services and their associated parameters provided by
the Model Training logical function needs to be aligned with the conclusion of
Key Issue #19: Trained data model sharing between multiple NWDAF instances.
Pre-trained ML model storage and provisioning to NWDAF is out of the scope of
3GPP.
Model Training logical function may register the supported ML model
information to NRF.
NOTE 7: The details of Model Training logical function registering ML model
information in NRF may also impact how the sharing of trained data model
between multiple NWDAF instances is performed so it needs to be aligned with
the conclusion of Key Issue #19.
## 8.2 Key Issue #2: Multiple NWDAF instances
### 8.2.1 Multiple NWDAF architecture and Analytics aggregation
A single option in normative phase is preferred. Solutions or parts of
solutions described in evaluation clause 7.2.2 shall be used to create one
such option with possible multiple deployment variants. The following
principles are proposed for the normative work on \"Multiple NWDAF
architecture\" and \"Analytics aggregation\":
a) The NWDAF architecture should allow for a hierarchy/tree with flexible
number of layers/branches. The number and organisation of the layers, as well
as the capabilities of each NWDAF instance remain deployment choices.
b) The NWDAF Profile in NRF is extended to support registering NWDAF
capabilities (e.g. Analytics aggregation) and information such that the NWDAF
service consumer can differentiate and select the preferred NWDAF in case
multiple NWDAFs are returned based on its implemented selection criteria
(possibly considering registered capabilities and information in NRF).
c) Specify the capability of NWDAF to support the aggregation of Analytics
(per analytics ID) received from other NWDAFs, possibly with Analytics
generated by itself.
d) The requesting and exchange of analytics metadata is supported between
NWDAFs when required for the aggregation of Output Analytics.
e) NWDAFs and NWDAF service consumers use the discovery mechanism from NRF as
defined in clause 6.3.13, TS 23.501 [2] to identify NWDAFs with certain
capabilities (e.g. Analytics aggregation), covering certain area of interest
(e.g. providing data / analytics for specific TAI(s)).
f) NWDAF register in UDM when it has subscriptions for Analytics related to a
UE. NWDAF deregisters from UDM when the subscription is released. NFs (e.g.
AMF, SMF and indirectly UPF) can indicate directly to PCF, which NWDAF and
Analytics ID is chosen for the UEs served.
NOTE: Whether bullet f) is to be specified in Rel-17 is determined in
normative phase.
g) Avoid changes on the NWDAF service consumer (other than another NWDAF)
beyond the change in principle b).
h) Maintain the NRF behaviour of Rel-16, e.g., do not change the discovery
mechanism provided by NRF.
i) As a deployment choice, NWDAFs can be co-located with a specific set of NFs
within 5GC, whereby the NWDAFs may collect data from that set of NFs or
generate analytics based on input data coming from that set of NFs. In this
case, registration and discovery mechanisms are the same as in bullet items #b
and #e.
### 8.2.2 Re-selection of NWDAF
Re-selection of a NWDAF is required in a limited number of cases, but should
be avoided as far as possible through appropriate deployment and
configuration, to avoid frequent comings and goings between NWDAFs instances,
with risks of inconsistency and additional signalling. The following
principles are proposed for the normative work on \"Re-selection of NWDAF\"
based on the evaluation in clause 7.2.2.3:
a) Extend or re-use existing Release-16 service operations, i.e. do not
introduce new AnalyticsRelocation service.
b) Support different configurable triggers for the NWDAF re-selection
corresponding to specific situations such as UE mobility, load balancing, and
graceful shutdown. Additional triggers will be decided during the normative
phase.
c) Support the handover of analytics subscriptions between NWDAFs.
If NWDAF re-selection is initiated by the source NWDAF, the source NWDAF will
make use of NRF to find candidate NWDAF(s) and the request(s) for handover of
analytics subscriptions in a Nnwdaf_Analytics message to the selected target
NWDAF(s). The request(s) include information related to the subscriptions to
be handed over, including for each subscription at least the subscribed
entity, the Analytics ID and corresponding parameters (as defined in clause
6.1.3 of TS 23.288 [5]), as well as an information about additional analytics
context available at the source NWDAF (see bullet e)).
d) Support the transfer of analytics context:
\- NF consumer was not changed, i.e. NWDAF re-selection was initiated by the
source NWDAF: the target NWDAF initiates the collection of information related
to the subscriptions handed over.
\- NF consumer is changed, i.e. NWDAF re-selection is initiated by the target
consumer NF: the analytics context is requested by the target NWDAF from the
source NWDAF. When AMF change happens, information (such as source NWDAF ID)
can be sent in extended existing message Namf_Communication_UEContextTransfer.
Further, when a DCCF is deployed it can be used to support the context
transfer at reselection of NWDAF when change of a consumer NF happens.
e) Analytics context can include the following information parts:
\- Analytics related:
Information related to entities that are subscribed to receive analytics.
Pending Analytics (i.e. not yet notified to the consumer) or historical
Analytics Output information - if available at the source NWDAF.
\- Historical data:
The target NWDAF may retrieve historical data that is available at the source
NWDAF and related to the Analytics to be handed over to the target NWDAF
(including not only the raw data collected from the data source(s), but also
\"analytics metadata\" such as the time period of the collected data,
information about the data source(s), etc.).
NOTE: If DRF and DCCF are deployed, the target NWDAF can retrieve historical
data from the DRF either directly or via a request to DCCF.
f) If no change of Analytics consumer is performed, the target NWDAF notifies
the NWDAF service consumer about the re-location. If change of Analytics
consumer is performed no notification is needed.
g) Support the prepared analytics handover to inform target NWDAF(s) about a
potential analytics handover. This message is to check the acceptability of
the analytics handover at the target NWDAF(s) and allows the target NWDAF(s)
to prepare to take over those Analytics subscriptions from the source NWDAF by
requesting the related analytics context from the source NWDAF, creating
subscriptions with the required data sources, etc. In case the source NWDAF
has contacted multiple target NWDAF(s) about such prepared analytics handover,
the source NWDAF has to confirm the handover to the selected target NWDAF and
cancel the prepared analytics handover to the other candidate NWDAF(s).
h) Purging of UE related data in combination with or shortly after a UE has
stopped being served by the source NWDAF is a good principle that shall be
possible.
### 8.2.3 Specific aspects of NWDAF interactions
As conclusion below recommendations are proposed to be adopted for normative
phase based on the evaluation in clause 7.2.2.4:
\- The error response to \"time when analytics is needed\" parameter (clause
6.1.3, TS 23.288 [5]) is revised such that when each NWDAF sends an error
response to the NWDAF Service Consumer, it may include a revised waiting time.
\- The existing parameter \"time when analytics is needed\" (clause 6.1.3, TS
23.288 [5]) can be extended for analytics subscription. If this parameter is
set for an Analytics subscription, it gives the flexibility for the NWDAF to
send analytics when feasible and/or needed besides other existing Analytics
Reporting Parameters as defined in Table 4.15.1-1, TS 23.502 [3].
\- The dataset statistical properties and output strategy parameters shall be
used by consumers of NWDAF services when multiple NWDAFs are involved in the
generation of single analytics output in order to prevent un-intended outcomes
due to consuming data analytics from each NWDAF independently.
\- An NWDAF can consume the UE abnormal behaviour analytics provided by
another NWDAF to trigger updating the applied ML model, and then based on the
updated model provide updated analytics to the analytics consumer if
necessary.
Regarding Exposing UE mobility analytics aspect, it is concluded that the
principles of clause 8.2.1 is adopted (with analytics ID=mobility analytics).
NOTE: Whether an extension to analytics filters provided by existing NWDAF
services is needed (e.g. regarding AOI) to support both trusted AFs and
untrusted AFs (via NEF) is determined during normative phase.
## 8.4 Key Issue #4: Remaining aspects on how to ensure that slice SLA is
guaranteed
For KI#4, it is proposed that the following aspects from Solution #2 are
considered for the normative work for slice load distribution mechanism based
on determination by NWDAF of slice service experience and slice load
analytics:
\- On how to leverage the Analytics on Observed Service Experience and Slice
Load level: existing Analytics on Observed Service Experience for a Network
Slice as defined in Rel-16 in clause 6.4 from TS 23.288 [5] are reused, and
Analytics on Slice load level need enhancements to define the resource usage
within the slice, the number of UE registrations in the slice and the number
of PDU sessions established in the slice.
\- The input data and output analytics for the Analytics Id on Observed
Service Experience remain unchanged. The input data and output analytics for
Slice Load Level analytics are defined as per Solution #2 clause 6.2.1.3.1 and
clause 6.2.1.3.2.
\- The NWDAF service consumers are NSSF, AMF; leveraging the analytics
information, NSSF and AMF can take actions as instructed in the Network Slice
Restrictions or Network Slice instance Restrictions for example not to accept
any more UE registrations, or not to accept PDU sessions establishment, until
this restriction is lifted.
\- The NWDAF subscribes to OAM to be informed on the creation or modification
of a slice or slice instance as described in clause 6.2.1.2. Feasibility of
the procedure needs to be checked with SA WG5.
## 8.7 Key Issue #7: Adding Application attributes and KPIs as the Input data
in some services described in TS 23.288 [5]
Solution #61 extends the User Data Congestion to provide the list of top N
applications causing peaks of throughput. The procedure for mitigation of data
congestion defined in solution #30 is reused and extended with the list of top
N applications causing peaks of throughput in the area reported as congested.
## 8.8 Key Issue #8: UE data as an input for analytics generation
The followings are agreed as conclusion for Key Issue #8.
For UE data reporting procedure:
> \- The user plane based solution is agreed for UE data collection. NWDAF
> interacts with an AF in the MNO domain or an AF external to MNO domain to
> collect UE data as an input for analytics generation. The data provided by
> the MNO AF or external AF to NWDAF is based on collected data from UE over
> user plane.
>
> \- The UE Application is configured with the address of the AF to contact.
> The UE Application may be configured to contact an AF in MNO domain (i.e. a
> trusted AF) or an AF external to the MNO domain (i.e. an untrusted AF). How
> the new UE data is collected by the AF may be developed by SA WG4 and
> feedback from SA WG4 will be considered if there is any SA WG2 work to be
> done.
>
> \- The NWDAF to (MNO) AF interface based on Naf_EventExposure is reused and
> should be extended if new input data from the UE based on user plane data
> collection as above is needed.
NOTE 1: For existing input data/ parameters supported for Naf_EventExposure,
NWDAF contacts a trusted AF (directly) or untrusted AF (via NEF) as defined in
Rel-16.
\- The user plane based solution can be applied to collect input data for both
3GPP defined services and non-3GPP defined services.
\- The AF in the MNO domain stores both the internal Application Id (or any
relevant Event ID) and external Application Id and provides it to NRF as part
of the NF profile. The NWDAF discovers the AF that can retrieve UE Application
input data via NRF, or local configuration. The AF in the MNO domain
correlates the external Application Id provided by the UE and the internal
Application Id (or any relevant Event ID) provided by the NWDAF.
\- For AF external to MNO domain, the above mapping between internal
Application Id (or any relevant Event ID) and external Application Id happens
via NEF.
\- If a SUPI is provided as the target of analytics reporting, the AF in the
MNO domain retrieves from UDM the UE context data, that includes the SMF
allocated for a PDU session and then it retrieves the UE IP address/prefix
allocated for a PDU session from the SMF using existing Event Exposure (and
relevant Event IDs) in the SMF per SUPI. The mapping of SUPI to UE IP address
can be stored for future use. The AF in the MNO domain based on the mapping
correlates the UE IP address/prefix provided by the UE and the SUPI provided
by the NWDAF.
\- If the target of analytics reporting is any UE, AF in the MNO domain
subscribes to NRF Discovery based on event filters provided on the area of
interest (as list of TAIs) to find matching AMF instances. The SUPIs are
retrieved from relevant AMF(s) based on the event filters and then the
procedure to interact with SMF as before is followed per individual SUPI or
list of SUPIs.
\- For AF external to MNO domain (untrusted AF), the above behaviour and
mapping between SUPIs to UE IP addresses happens via NEF.
> \- For the solutions that UE reports data to (MNO) AF:
\- An SLA between the MNO and ASP determines:
\- The (MNO) AF for the UE\'s Application to connect to.
\- The information that the UE\'s Application shares with the (MNO) AF,
subject to user consent.
\- The authentication info.
\- Possible Data Anonymization, Aggregation or Normalization, algorithms (if
used).
NOTE 2: The mutual authentication info that is used by the UE Application and
(MNO) AF and how user consent is obtained is in the scope of SA WG3.
> \- (MNO) AF is configured based on the SLA above.
>
> \- The UE Application client is configured /provisioned with the following
> information from Application Server (in addition to the address of the AF
> described above):
\- The parameters that are authorized to provide to the AF for UE data
collection.
\- The authentication information to enable the UE\'s Application to verify
the (MNO) AF that request data.
NOTE 3: The authentication and authorization info that is used for UE and
(MNO) AF is in the scope of SA3.
For UE data reporting parameters:
> \- SA WG2 shall define the input data for Naf_EventExposure between NWDAF
> and (MNO) AF.
>
> \- The input data from UE to (MNO) AF (including directly or indirectly i.e.
> via ASP server, data reporting) is out of SA WG2\'s scope.
>
> \- (MNO) AF may perform anonymization, aggregation or normalization of the
> input data provided by the UE before providing this to NWDAF.
>
> \- It is recommended to conclude the following input data for
> Naf_EventExposure in normative work:
>
> \- Collective (UE Behaviour) Attribute per list of UE IDs which includes
> Route, Destination, Average Speed, Time Interval spent per location. The NF
> load analytics will be enhanced based on this input data and/ or other
> existing input data from MDT.
>
> \- The Observed Service experience data collection that defined for
> Naf_EventExposure in Rel-16 will be extended.
NOTE 4: Whether to define new Event ID and Event Filter and how to extend the
Rel-16 Event ID and Event Filter for Naf_EventExposure will be discussed in
normative work.
New Analytics ID on WLAN Performance is defined in normative phase, Input data
is collected from OAM, SMF and UPF, i.e. no UE input data is needed as input
for this Analytics. NWDAF does not provide the list of WLAN SP rules as part
of this analytics.
## 8.9 Key Issue #9: Dispersion Analytics output provided by NWDAF
ANALYTICS:
Dispersion Analytic ID shall progress to the normative work and shall include
data volume dispersion analytics, data volume dispersion analytics per
application and transaction dispersion analytics.
The Dispersion Analytics Id for both Data and Transaction Dispersion, the
input and output data for the Analytics request or subscription is defined in
solution #30 and should form the basis of the follow up normative work
addressing KI #9.
The AF may update the Expected UE behaviour parameters in the UDM based on the
obtained dispersion analytics information, following existing procedures in TS
23.502 [3] clause 4.15.6 External Parameter Provisioning.
PROCEDURES:
The following procedures are considered for the normative work:
\- \"User Data Congestion Mitigation\" procedure that uses Data Dispersion
Analytics based on solution#30.
\- \"Assistance to slice load distribution\" procedure that also uses Data
Dispersion Analytics as defined in solution#30.
## 8.10 Key Issue #10: NWDAF Assisted UP Optimization
As shown in Solutions 67 and 68, NWDAF can assist with user plane optimization
as requested by Key Issue 10 by means of both extending existing data
analytics agreed in Rel-16 and delivering a new analytics type. Hence, it is
proposed to use both Solution 67 and Solution 68 as basis for normative work.
Normative work for Solution 67 should enable alternative 1 for input data
collection.
## 8.11 Key Issue #11: Increasing efficiency of data collection
### 8.11.1 Signalling reduction via parametrization and services changes
For service changes the following principles are proposed:
\- Make use of bulk data collection an option for data collection from NWDAF.
\- Persistent data collection:
\- Based on the NWDAF event subscription, UDM determines and recreates the
event subscription with the new NF to which the UE is attached.
### 8.11.2 Signalling reduction on Tracking and Discovery of Entities
For tracking and discovery of entities, the following principles are proposed:
\- Improve the NF profile stored in the NRF, as well as NRF services with
supplementary information in order to facilitate the discovery of relevant
NFs, in the case of data collection for any UE.
\- Improve AMF event exposure with supplementary information in order to
facilitate the discovery of available network slice information relevant in an
area of interest, in case of data collection for any UE.
\- Improve SMF event exposure with supplementary information in order to
facilitate the discovery of relevant PDU sessions, in case of data collection
for any UE.
NOTE: The last Event exposure is dependent on having location available in
SMF. UE Location parameter is still to be optional but may be switched on per
operator configuration.
\- Make use of UDM as a means to store relevant per UE information to find
serving NFs.
\- As having the possibility to mute the event reporting from NWDAF also
introduce for Analytics the notion of maximum duration for the storage of
analytics in an NWDAF in conjunction with appropriate parameters at NWDAF
service interface (e.g. time when analytics are needed, suppression of
notifications).
### 8.11.3 Signalling reduction via Event Exposure service enhancement
For Event Exposure enhancement, the following principles are agreed for
normative work.
Event Exposure for Analytics service:
> \- Additional Analytics filters shall be standardized on a per-analytics
> basis, in order to narrow down the scope of analytics, thus reducing
> signalling both for analytics provision and data collection.
>
> \- Additional parameters on Analytics service shall be standardized to
> reduce the amount of information in Analytics reports: time granularity,
> criteria for ordering of results (together with maximum number or results),
> aggregation for some analytics (e.g. load of an NF set).
Event Exposure for data collection:
> \- In case of permanent data collection (during model training or for other
> specific use cases), additional mechanisms shall be standardized in order to
> limit signalling while still enabling a relevant access to collected data
> and general trends. Therefore, the mute storage of events in the
> DCCF/messaging framework, the distributed NWDAF, or NFs (i.e. without event
> reporting) can be performed during periods where no analytics are requested,
> within a limited size. Because of the limited size of the data collection
> queue, basic metrics may be performed as a complement on Event-IDs and
> collected information, in order to gather historical trends.
>
> \- Additional parameters on Event Exposure service shall be standardized to
> reduce the amount of information per Event Report, e.g. value granularity.
>
> \- Because a better fairness in sampling contributes to reduce the size of
> samples, hence reducing signalling load, additional parameters may be added
> for this purpose, only static criteria is to be progressed. A Static
> criteria is a criteria where a UE belongs to the same criteria as long as it
> is served by the NF
### 8.11.4 Signalling reduction via architectural changes
For Data collection aspects, the following principles are agreed for normative
work:
> \- When a Data Collection Coordination Functionality (DCCF) is deployed, it
> is used to coordinate collection of data from one or more NF(s) based on
> data collection requests from one or more Consumer NF(s).
>
> \- A Data Repository Functionality (DRF) allows to store collected data and
> analytics.
>
> \- Data Collection Coordination Functionality (DCCF) and Data Repository
> Functionality (DRF) are to be standardized and exposes the standardized
> interfaces (services).
NOTE 1: DCCF and DRF can be implemented as standalone NFs, possibly co-located
with NWDAF, or can be hosted by NWDAF.
> \- Data Collection notification to one or more Consumer NF(s) may be
> supported via a Messaging Framework. Adaptors supporting 3GPP services allow
> NFs to interact with the Messaging Framework.
>
> \- Data Collection notifications may also be supported directly from data
> provider to one or more Consumer NF(s), or via DCCF and not via the
> Messaging Framework.
NOTE 2: The Messaging Framework is outside the scope of 3GPP. Adaptors are not
expected to be standardized by 3GPP, only the interface between 3GPP entities
and the adaptors is under 3GPP scope. This includes 3GPP services offered by
adaptors to allow NFs to interact with the Messaging Framework.
> \- A consumer NF (e.g. NWDAF) may request from the UDM to create a
> persistent Event Exposure subscription for cases where data collection is
> required from an AMF or SMF for a specific UE
>
> \- The NWDAF analytics function interacts directly with the DCCF to request
> the collection of data.
>
> \- The NFs interact directly with the DCCF to request analytics from an
> NWDAF.
NOTE 3: NFs are not precluded to directly interact with NWDAF to
request/subscribe to analytics IDs.
NOTE 4: Based on the outcome of KI#1, decomposed NWDAF functions can also use
the above new functionalities.
> \- The DCCF interacts with the NFs (including NWDAFs) to request data or may
> request from the UDM to create a persistent Event Exposure subscription when
> data is collected from an AMF or SMF for a specific UE.
>
> \- The DCCF coordinates data collection so the same data is not requested
> multiple times from the same Data Source.
>
> \- Data is requested and collected in a standardized manner from one or more
> NF(s) (including NWDAF) and OAM system.
>
> \- The DCCF provides the service for bulk data collection.
>
> \- For data collection from NWDAF following methods may be available:
\- Event Exposure from NWDAF only for runtime mode.
\- The DRF functionality shall be used to store data. When DRF is a standalone
or collocated NF, then no bulk data service is needed from the NWDAF, only
data retrieval from DRF is needed.
\- If DRF is hosted inside NWDAF, then bulk data collection may be supported
from NWDAF using a new data management service. All services handling bulk
data retrieval either from NWDAF, directly from DRF or via DCCF/messaging
framework mentioned in bullets below shall be aligned.
NOTE 5: The above need to be aligned with conclusions for Signalling reduction
via parametrization and services changes.
> \- The collected data and/or produced data can be stored in the DRF, which
> exposes the standardized interface for storage. In this case, DRF act as
> data source for the stored data.
>
> \- Consumers NF(s) (e.g. NWDAF) access the data from DRF either directly or
> via a request to DCCF. The data that the NWDAF obtains directly from the DRF
> will be determined in the normative phase.
>
> \- To act as data source for the stored data, and when the trigger for the
> data collection did not come from the DCCF, NWDAF or DRF can register/update
> information on collected data to the DCCF, then DCCF can interact with the
> NWDAF or DRF to collect the stored data based on consumer NF(s) request and
> information on collected data.
NOTE 6: Information on collected data will be detailed in the normative work.
> \- If a consumer NF makes a request for data via DCCF and that data are
> already available at the DRF or some NWDAF, the DCCF forwards the request to
> DRF or NWDAF instead of forwarding the request to NF.
>
> \- If the Consumer NF does not specify a Data Source in its request to the
> DCCF, the DCCF determines the Data Source that can provide the requested
> data.
NOTE 7: Additional authorization for Consumers to access data from a Data
Source via the DCCF and to access data from DRF (directly or via DCCF) needs
to be coordinated with SA WG3.
> \- If there is more than one DCCF / set of DCCFs, each Data Source (except
> for DRF) is associated with only one DCCF / set of DCCFs
>
> \- A Consumer NF may specify in requests to a DCCF that data provided by a
> Data Source needs to be stored in the DRF.
>
> \- A Consumer NF may specify formatting conditions and processing
> instructions in requests to a DCCF. Formatting conditions determine when a
> notification needs to be sent to the Consumer NF. Processing instructions
> allow summarizing of notifications to reduce the data volume reported to the
> Consumer NF.
NOTE 8: Formatting and processing instructions shall be aligned with
Conclusion for Signalling reduction via Event Exposure service enhancement.
> \- It is possible to use the NRF for discovery of DCCF and DRF. DCCF can
> register in NRF the supported slices, the Source Types that a DCCF
> coordinates, and the serving area (e.g. list of TAIs) containing Data
> Sources that the DCCF coordinates.
## 8.12 Key Issue #12: NWDAF-assisted RFSP policy
The following procedures and Analytics IDs shall be progressed to normative
work:
PROCEDURES:
\- A procedure to mitigate user data congestion includes the detection of
congested areas, the users that dispersed most of the traffic at the areas and
the allocations of an RSFP value that moves the users to a different RAT or a
different frequency. Both Analytics IDs for \"User Data congestion\" and for
\"Data dispersion\" can be used as input to RFSP value allocation at the PCF.
\- A procedure for PCF to allocate RFSP values by consuming analytics from
NWDAF, aiming to move users to a different RAT and/or a different frequency
for better experience in services with e.g. different bandwidth and latency
requirements. Both Analytics IDs for \"Service in use\" and for \"Observed
Service Experience\" can be used as input to the RFSP value allocation at the
PCF.
ANALYTICS: Both Analytics IDs for \"Service in use\" and for \"Observed
Service experience\" as defined in Solution #4, are proposed for the normative
work addressing KI#12.
> \- The input data for service experience analytics is to reuse the ones
> defined in clause 6.4, TS 23.288 [5] with exception that Table 6.4.2-3: UE
> level Network Data from OAM is extended to further retrieve RAT/Frequency
> information related to the service experience observation period from OAM in
> order to allow NWDAF to be able to provide Service Experience per RAT type
> and Frequency.
>
> \- The Analytics ID \"Service in use\" defined in Solution #4 shall be
> defined as an extension of UE Communication Analytics ID as defined in
> clause 6.7, TS 23.288 [5].
Both Analytics IDs for \"User Data congestion\" and for \"Data dispersion\" as
defined in Solution #30, are proposed for the normative work addressing KI#12.
The input data for User Data Congestion reuses the ones defined in clause 6.8,
TS 23.288 [5] and the Data dispersion Analytics input and output data is
defined in solution #30. The Data dispersion Analytics ID is a newly defined
Analytics ID separately from any other existing analytics.
NOTE: NWDAF does not collect subscriber category as input for Observed Service
Experience Analytics.
## 8.13 Key Issue #13: Triggering conditions for analytics
Regarding triggers used by analytics consumers to request for or subscribe to
analytics from the NWDAF, solution #45 and #74 are selected for the normative
work. Solution #44 is selected for the normative work with introduction of the
new Analytics ID \"Session Management Congestion Control Experience (SMCCE)\".
Regarding triggers used by the NWDAF for data collection from the UE, solution
#65 is to be discussed under Key issue#8.
## 8.15 Key Issue #15: User consent for UE data collection/analysis
It is recommended for Key Issue #15 to use the concepts and procedures
described in below as the bases for the normative work with further alignments
based on the SA WG3 feedback:
a) UDR (via UDM services) holds the user consent for user related data which
is provisioned by MNO as a user subscription information.
b) A service provider (external to MNO domain) may use NEF
parameterProvision_Update service to update or to revoke the user consent to
the UDM/ UDR (when applicable).
c) Alternatively, the user consent parameter may be configured by MNO in the
UDM/UDR (when applicable).
d) Another option is the ASP configures the ASP\'s Application in UE to
provide input data only if user consent is obtained.
e) A functionality to be provided to support tracking the distribution and
usage of any user related information that may be subject to user consent.
NOTE 1: Whether the functionality described in bullet item e) is hosted by
NWDAF, DCCF (and possible interactions with DRF) or as a standalone NF is
decided in normative phase in alignment with SA WG3 feedback.
f) The functionality described in bullet item e) subscribes to the UDM/UDR to
receive notifications for any changes in the user consent.
g) If a requested data is subject to user consent, the NWDAF and/or the
functionality described in e) may check the user consent from the UDM/UDR
before the data collection.
NOTE 2: This does not preclude that also other entities (e.g. AMF or SMF) to
check availability of user consent with UDM/UDR.
h) User consent for the user data provided by a data source to a data consumer
may have a validity time. On expiry of this validity time, the user data
should be either deleted or the user consent for this data to be renegotiated.
i) (Subject to applicability of Data Protection Regulations) in case of user
consent revocation at UDM/UDR, NWDAF deletes the related user data and
terminates the data collection from the corresponding source NF.
j) (Subject to applicability of Data Protection Regulations) in case of user
consent revocation (at UDM/UDR), the functionality described in bullet item e)
may send a request to NWDAF service consumer(s) to delete the related user
data/ analytics.
k) (Subject to applicability of Data Protection Regulations) in case of user
consent revocation (at UDM/UDR), NWDAF service consumer(s) may delete the
related user data/analytics on request (refer to bullet item j) or on expiry
of validity time (refer to bullet item h).
## 8.16 Key Issue #16: UP optimization for edge computing
It is concluded that the merged Solution#31 and merged Solution#48 are
selected as basis for further normative work.
It is also concludes that Alternative #2 of Solution #47 is selected to better
support LADN service.
## 8.17 Key issue #17: Definition of accuracy levels
It is recommended to use Solution #52 as basis for normative work.
## 8.18 Key Issue #18: Enhancement for real-time communication with NWDAF
For KI#18, it is proposed that the following aspects from Solution #54 are
considered for the normative work:
\- The NWDAF can register its Supported Analytics Delay per Analytics ID in
NRF during the NWDAF registration procedure.
\- The consumer NF discovers a candidate NWDAFs list via NRF. Each NWDAF in
the list supports to provide the network data analytics for the requested
Analytics ID within a time not exceeding the Supported Analytics Delay
registered in the NWDAF profile. The consumer NF determines a suitable NWDAF
by comparing its Expected Analytics Delay with the Supported Analytics Delay
of each candidate NWDAF.
\- The determination of Supported Analytics Delay, and how the NWDAF avoid
updating its Supported Analytics Delay in NRF frequently is NWDAF
implementation specific.
## 8.19 Key Issue #19: Trained data model sharing between multiple NWDAF
instances
For the Key Issue #19, the following services are proposed for the normative
work.
\- Nnwdaf_MLModelProvision is a new service introduced to share trained ML
models between NWDAF instances.
\- Nnwdaf_MLModelInfo is a new service introduced to request parameter(s)
related to a ML model.
\- Nnwdaf_MLModelUpdate is a new service introduced to let a ML Model Consumer
inform a ML Model Provider on further training that has been performed on the
ML model.
NOTE 1: Whether all the services listed above are needed will be confirmed
during normative work.
In addition, NWDAF instances can discover NWDAF instances providing ML models
via NRF.
NOTE 2: The selected services need to be aligned with Key Issue #1 to enable
ML model training and sharing in the context of multiple NWDAF instances.
NOTE 3: The complete list of parameters required for each new service needs to
be determined during normative work. The parameters introduced and their
definitions shall be held to a minimum enough for a single vendor environment.
3GPP standardized sharing of models across different vendor environments is
not deemed feasible in this release of the specifications. Sharing of models
or model meta data is limited to single vendor environments.
## 8.20 Key Issue #20: NWDAF assisting in detecting anomaly events for the
user plane
For KI#20, no normative work has been identified for Rel-17.
## 8.21 Key Issue #21: NWDAF assisting in user plane performance
For Key Issue #21 \"NWDAF assisting in user plane performance\", it is
concluded that no normative work is needed in Rel-17.
#