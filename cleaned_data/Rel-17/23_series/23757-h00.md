# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
This Technical Report studies and evaluates architectural enhancements to the
5G System to address the following objective.
**Objective A: Enabling general MBS services over 5GS.**
Support general multicast and broadcast communication services, e.g.
transparent IPv4/IPv6 multicast delivery, IPTV, software delivery over
wireless, group communications and IoT applications, V2X applications, public
safety.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System architecture for the 5G System (5GS)\".
[3] 3GPP TS 22.101: \"Service aspects; Service principles\".
[4] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description\".
[5] 3GPP TS 23.468: \"Group Communication System Enablers for LTE
(GCSE_LTE)\".
[6] 3GPP TS 26.348: \"Northbound Application Programming Interface (API) for
Multimedia Broadcast/Multicast Service (MBMS) at the xMB reference point\".
[7] 3GPP TS 23.316: \"Wireless and wireline convergence access support for the
5G System (5GS)\".
[8] 3GPP TS 23.502: \"Procedures for the 5G System (5GS)\".
[9] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services\".
[10] 3GPP TS 38.300: \"NR; Overall description; Stage-2\".
[11] 3GPP TR 23.748: \"Study on enhancement of support for Edge Computing in
5G Core network (5GC)\".
[12] RP-193248: \"New Work Item on NR support of Multicast and Broadcast
Services\", RAN#86.
[13] 3GPP TS 23.503: \"Policy and charging control framework for the 5G System
(5GS); Stage 2\".
[14] 3GPP TS 23.280: \"Common functional architecture to support mission
critical services; Stage 2\".
[15] 3GPP TS 24.379: \"Mission Critical Push To Talk (MCPTT) call control;
Protocol specification\".
[16] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[17] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
Nodes; Stage 3\".
[18] 3GPP TS 26.346: \"Multimedia Broadcast/Multicast Service (MBMS);
Protocols and codecs\".
[19] IETF RFC 4867: \"RTP Payload Format and File Storage Format for the
Adaptive Multi-Rate (AMR) and Adaptive Multi-Rate Wideband (AMR-WB) Audio
Codecs\".
[20] IETF RFC 5795: \"The RObust Header Compression (ROHC) Framework\".
[21] IETF RFC 3095: \"RObust Header Compression (ROHC): Framework and four
profiles: RTP, UDP, ESP, and uncompressed\".
[22] IETF RFC 6363: \"Forward Error Correction (FEC) Framework\".
[23] 3GPP TS 29.116: \"Representational state transfer over xMB reference
point between content provider and BM-SC\".
[24] IETF RFC 8777: \"DNS Reverse IP Automatic Multicast Tunneling (AMT)
Discovery\".
[25] IETF RFC 7450: \"Automatic Multicast Tunneling\".
[26] IETF RFC 3552: \"Guidelines for Writing RFC Text on Security
Considerations.\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
**Broadcast communication service:** A communication service in which the same
service and the same specific content data are provided simultaneously to all
UEs in a geographical area (i.e. all UEs in the broadcast coverage area are
authorized to receive the data).
NOTE 1: For the broadcast communication service, the content provider and
network may not be aware whether the authorized UEs are actually receiving the
data being delivered.
**Broadcast service area:** The area within which data of one or multiple
Broadcast session(s) are sent.
**Broadcast session:** A session to deliver the broadcast communication
service. A broadcast session is characterised by the content to send and the
geographical area where to distribute it.
**Service Announcement:** Mechanism to inform users about one or several
available MB services.
NOTE 2: Definition can be revisited in normative phase.
**Multicast service area:** The area within which data of one or multiple
Multicast session(s) are sent.
**MBS session:** A multicast session or a broadcast session.
**MBS QoS Flow** : The finest granularity for QoS forwarding treatment for MBS
data. Providing different QoS forwarding treatment requires separate MBS QoS
Flow in 5MBS system.
**transport only mode** : MBS system transports data/content from the content
provider to the content receiver in a transparent manner.
NOTE 3: Definition can be revisited in normative phase.
**Multicast communication service:** A communication service in which the same
service and the same specific content data are provided simultaneously to a
dedicated set of UEs (i.e. not all UEs in the multicast coverage are
authorized to receive the data).
NOTE 4: For multicast communication service, the content provider and network
can be aware whether the authorized UEs are actually receiving the data being
delivered.
NOTE 5: The transport in the 5GC for broadcast and multicast services will be
determined as part of this study. A multicast communication service could for
instance use a lower layer unicast or multicast transfer in the 5GC and the
access interfaces.
**Multicast session:** A session to deliver the multicast communication
service. A multicast session is characterised by the content to send, by the
list of UEs that may receive the service and optionally by a multicast area
where to distribute it.
**Receive Only Mode:** A UE configuration option that allows a UE to receive
only broadcast service without the need to access and register with the PLMN
offering the MBS service. Use of Receive Only Mode does not require USIM for
the UE.
**Shared MBS Network:** A network shared by multiple PLMNs that provides
multicast or broadcast services. At least the northbound data entrance point
in the 5GS is shared.
**5GC Individual** **MBS traffic delivery** : 5G CN receives a single copy of
MBS data packets and delivers separate copies of those MBS data packets to
individual UEs via per-UE PDU sessions, hence for each such UE one PDU session
is required to be associated with a multicast session.
**5GC shared MBS traffic delivery** : 5G CN receives a single copy of MBS data
packets and delivers a single copy of those MBS data packets to a RAN node.
NOTE 6: For 5GC shared MBS traffic delivery the RAN node either delivers a
single copy of MBS data packets over radio to a set of UEs (PTM) or delivers
separate copies of MBS data packets over radio to individual UEs (PTP).
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
**MBS** Multicast/Broadcast Service.
# 4 Architectural Assumptions and Principles
## 4.1 Common architectural requirements and principles
The following common architectural requirements and principles apply:
\- Solutions shall build on the 5G System architectural principles as in TS
23.501 [2], including flexibility and modularity for newly introduced
functionalities.
\- The system shall provide an efficient transport for a variety of multicast
and broadcast services.
\- Solutions shall minimize impact to existing external services.
\- Only NR of NG-RAN connected to 5GC is considered as RAT.
\- Architecture reference models defined in TS 23.501 [2] clause 4.2 are used
as the baseline architecture for supporting multicast and broadcast services
in this study. In particular, Figure 4.1-1 shows the MBS architecture with 5G
UE, NG-RAN and 5GC.
NOTE: Whether a solution supports IP traffic and/or other types of traffic
will be analysed in Evaluation and Conclusions stage.
Figure 4.1-1: High level MBS architecture
Editor\'s note: The impact on RAN is to be analysed by and coordinated with
the relevant RAN WGs.
## 4.2 Specific architectural requirements and principles
The following IPTV requirements and principles apply:
\- Solutions to IPTV shall minimize the impact to IPTV network and STB.
\- Solutions to IPTV STB shall reuse IGMP/MLD message via user plane to
join/leave an IPTV channel group.
\- Solutions to IPTV shall provide an efficient mechanism for the UE to
join/leave an IP channel group, including reducing latency and signalling.
## 4.3 Baseline functionality
The sequence to establish and deliver an MBS session is assumed as follows:
1\. Optional delivery of 5G MBS service info from application/service layer to
5GC.
NOTE 1: A framework to deliver 5G MBS service info to 5G CN is available.
However, this step may be replaced by pre-agreements without explicit
signalling.
2\. UEs participate in receiving MBS flow i.e. UE requests to join an MBS
session (for Multicast session).
3\. Establishment of MBS flow transport.
NOTE 2: Step 3 may happen before step 2 for individual UEs joining an MBS
session which is already started.
4\. MBS data delivery to UEs.
5\. UEs stop receiving MBS flow (for Multicast session).
6\. Release of MBS flow transport (what used to be session stop).
## 4.4 MBS Traffic delivery methods
MBS traffic needs to be delivered from a single data source (Application
Service Provider) to multiple UEs. Depending on many factors, multiple
delivery methods may be used to deliver MBS traffic in the 5GS. For clarity,
delivery methods are not referred to as unicast/multicast/broadcast but as
described below.
NOTE 1: The term \"unicast delivery\" refers to a mechanism by which
application data and signalling between the UE and the application server are
delivered using PDU Session within the 3GPP network and using individual UE
and application server addresses (e.g. IP addresses) between the 3GPP network
and the application server. It is not equivalent to 5GC Individual MBS traffic
delivery method defined in this clause.
From the view point of 5G CN, two **delivery methods** are possible for MBS
multicast service:
\- 5GC Individual MBS traffic delivery method: 5G CN receives a single copy of
MBS data packets and delivers separate copies of those MBS data packets to
individual UEs via per-UE PDU sessions, hence for each such UE one PDU session
is required to be associated with a multicast session.
\- 5GC Shared MBS traffic delivery method: 5G CN receives a single copy of MBS
data packets and delivers a single copy of those MBS packets packet to a RAN
node, which then delivers them to one or multiple UEs
If 5GC Individual MBS traffic delivery method is supported, a same received
single copy of MBS data packets by the CN may be delivered via both 5GC
Individual MBS traffic delivery method for some UE(s) and 5GC Shared MBS
traffic delivery method for other UEs.
From the viewpoint of RAN, (in the case of the shared delivery) two **delivery
methods** are available for the transmission of MBS packet flows over radio:
\- Point-to-Point (PTP) delivery method: a RAN node delivers separate copies
of MBS data packet over radio to individual UE.
\- Point-to-Multipoint (PTM) delivery method: a RAN node delivers a single
copy of MBS data packets over radio to a set of UEs.
A RAN node may use a combination of PTP/PTM to deliver an MBS packet to UEs.
NOTE 2: The PTP and PTM delivery methods are defined in RAN WGs and they are
listed here for reference only.
As depicted in the following figure, PTP or PTM delivery (with 5GC shared
delivery method) and 5GC Individual delivery method may be used at the same
time for a multicast MBS session.
Figure 4.4â€‘1: Schematic showing delivery methods
For MBS broadcast service, only 5GC Shared MBS traffic delivery method with
PTM delivery is applicable.
# 5 Key Issues
## 5.1 Key Issue #1: MBS session management
### 5.1.1 Description
To transfer the service data flow of multicast and broadcast communication
services, MBS sessions need to be established and maintained. This key issue
will study the following aspects:
\- When and how to trigger the establishment of an MBS session?
\- When and how to trigger deactivation of an MBS session?
\- Which network function(s) is/are responsible for establishing and
maintaining the MBS session (including interaction between 5GC and 3rd party)?
\- Which information/parameters are used to establish an MBS session (e.g.
session related IDs, QoS information, broadcast service area or multicast
service area, etc.)?
\- Which information is provided to the gNB when a UE joins a MBS multicast
Session? How does the gNB associate the UE with the established MBS multicast
session?
\- Which information/parameters can be updated for an established MBS session
(e.g. QoS information, broadcast service area or multicast service area,
etc.)?
\- Which network function(s) is/are responsible for determining the broadcast
service area or multicast service area used for MBS sessions? How is the
broadcast service area or the multicast service area determined (e.g. pre-
defined, determined during an on-going MBS session, etc.)?
## 5.2 Key Issue #2: Definition of Service Levels
### 5.2.1 Description
5G system is envisioned to address different use cases. In some of these use
cases, a complete 5G system becomes a part of another system, for instance the
support of IPTV where 5G system is integrated into an IPTV network from which
it receives multicast, where the role of the 5GS is primarily to provide an
efficient \"transparent\" transport of a broadcast/multicast service. Other
use cases offering for multicast or broadcast services are in vertical
domains, for which the \"transparent\" mode is not possible or feasible and a
full-service mode should be defined.
This key issue will study the service levels for the broadcast and multicast
support of the 5GS.
NOTE: For different service levels, different solution proposals can be
provided as part of other key issues.
## 5.3 Key Issue #3: Levels of authorization for Multicast communication
services
### 5.3.1 Description
The 5GS is expected to support different use cases of multicast services. The
mobile network operators (MNO) and/or application service providers (ASP) may
want to provide different levels of authorization (e.g. at session or service
level) for the UE to access multicast communication services.
This key issue will study the following aspects:
\- Define and study how to support the necessary level(s) of authorization for
UEs to access multicast communication services.
\- How can a UE join/leave (including authorised or revoked to access) a
multicast communication service?
NOTE: No separate solution will be developed for the key issue#3 as part of
this study, while the basic authorization procedures (i.e. UE is allowed to
join an MBS session) could be addressed in the associated solutions to KI#1.
## 5.4 Key Issue #4: QoS level support for Multicast and Broadcast
communication services
### 5.4.1 Description
Different multicast and broadcast communication services have potentially
different QoS requirements. For this key issue the QoS framework of TS 23.501
[2] clause 5.7 is taken as baseline. This key issue aims at studying:
\- QoS requirements, including packet error rate, delay budget, MBR or GBR;
\- If a need for different QoS levels is determined by the QoS requirement
analysis:
\- how to provide a means to support the identified QoS levels;
\- which NF determines the QoS levels of multicast and broadcast services;
\- which entity enforces the required QoS and how.
## 5.5 Key Issue #5: Support of Broadcast TV Video and Radio communication
services
### 5.5.1 Description
This key issue aims at addressing:
\- E-UTRA of NG-RAN based support of broadcast TV, video and radio
communication;
\- Allow Video/TV/Radio broadcast communication services to devices with no
MNO subscription (e.g. \"Free to air TV\").
A solution to this key issue shall provide means for MNO to enable this
service based on policy.
A solution for this key issue shall provide:
\- Support of Free-to-Air service via Receive Only Mode device support.
\- Support of Shared MBS functionality to allow dedicated MBS network.
\- Exposure of MBS service and transport (similar to support of xMB external
reference point).
NOTE: This key issue is not addressed within the Rel-17 timeframe.
## 5.6 Key Issue #6: Local MBS service
### 5.6.1 Description
For V2X, Public Safety and other service provided locally, there may be a
multicast or broadcast communication services only available in a local
service area (e.g. per cell, TA or other geographic metric) and for a specific
time (e.g. during event hours, emergency situation, or operation hours).
In this situation, it is also expected that different application servers can
be assigned to control the multicast or broadcast communication service(s) in
each service area. UEs may need to be configured to receive information about
available multicast or broadcast service in the area where they are residing.
Therefore, for supporting local multicast and broadcast communication
services, the following aspects will be studied:
\- Whether additional specific functionality and information (e.g.
geographical range for broadcast service area/multicast service area) is
required to provide local multicast and broadcast communication services in 5G
system in a resource efficient manner, and if so, how.
\- How to support UEs if necessary, to discover and receive multicast and
broadcast communication services which is available locally in 5G system in a
resource efficient manner.
## 5.7 Key Issue #7: Reliable delivery method switching between unicast and
multicast
### 5.7.1 Description
This key issue aims at providing support for dynamic delivery method switching
between unicast and multicast in the 5GS. Depending on the number of devices
receiving a specific content, their location, and RAN considerations, it may
be necessary to support reliable and efficient delivery method switching
between unicast and multicast. In addition, when a UE is receiving a multicast
session, it may move across NG-RAN nodes and it is possible that the UE moves
from a NG-RAN node that supports MBS to one that does not support MBS, or vice
versa.
The following aspects will be studied:
\- Triggers for delivery method switching between unicast and multicast.
\- How switching between unicast delivery method and multicast delivery method
is performed in the 5GS (including the UE) while supporting service
continuity.
NOTE 1: The terms unicast delivery and multicast delivery methods may have
different meaning depending on which part of the 5G system a solution is
referring to as defined in clause 4.4, e.g. over-the-air it may mean PTP vs.
PTM, between UPF and RAN it may mean shared tunnel vs unicast tunnel, etc.
NOTE 2: Towards application, the terms unicast delivery and multicast delivery
methods may also the application is using multicast session vs PDU session,
which is in SA WG6 scope.
NOTE 3: During the study of this key issue, RAN WGs, SA WG4 and SA WG6 will be
involved, if needed.
## 5.8 Key Issue #8: Reliable switching between unicast and broadcast delivery
methods
### 5.8.1 Description
When a UE is receiving a session, it may move from a NG-RAN node that supports
MBS to a NG-RAN node that does not support MBS, or vice versa.
The following aspect will be studied:
\- Triggers for switching between unicast and broadcast delivery methods.
\- How switching between unicast and broadcast delivery methods is performed
in the 5GS while supporting service continuity.
NOTE: This key issue is not addressed within Rel-17 timeframe.
## 5.9 Key Issue #9: Minimizing the interruption of public safety services
upon transition between NR/5GC and E-UTRAN/EPC
### 5.9.1 Description
The approved RAN WID on NR Multicast Broadcast and Multicast (RP-193248 [12])
states in the objectives: \"Architecture: it is the one in Figure 4.1-1 in TR
23.757 v0.2.0: High level MBS architecture, with the further restriction that
only NR in NG-RAN (i.e. connected to 5GC) is considered as RAT\". This means
that there is no planned support for MBS over E-UTRA connected to 5GC.
This KI applies to PLMNs that have E-UTRAN/EPC based eMBMS deployments and 5G
MBS over NR/5GC, with Public Safety services.
There may be UEs receiving a service subject to multicast delivery over NR/5GC
that move to E-UTRAN/EPC and use eMBMS, and vice versa. How to handle these
services via both EPC and 5GC, and how to handle mobility across RATs should
be considered.
Therefore, solutions that address this key issue focused on public safety
services only should:
\- Allow an AF (Public Safety GCS AS) to provide the same Multicast/Broadcast
service to UEs camping on E-UTRAN (eMBMS), and UEs over NR connected to 5GC
(via 5G MBS solution).
\- Define procedures for UEs performing inter-CN type mobility between EPC and
5GC during a multicast session.
The goal is to minimize service interruption and packet loss and achieve rapid
re-connection during transitions between various systems, as much as possible.
NOTE 1: For the impacts to Public Safety services, work is expected to be done
mainly in SA WG6.
NOTE 2: Scheduling time to discuss solutions for this key issue will take
place after concluding Key Issues #1, #2, and #7 that will define basic
architecture and procedures for MBS in 5GS.
# 6 Solutions
## 6.0 Mapping of solutions to key issues
Editor\'s note: This clause describes the mapping between solutions and key
issues.
Table 6.0-1: Mapping of solutions to key issues
| Key Issues |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
Solutions | 1 MBS session management | 2 Service levels definition | 3 Levels of authorization for MC | 4 QoS for MC and BC | 5 BC TV and Radio services | 6 Local MBS | 7 MC-UC delivery mode switch | 8 BC-UC delivery method switch | 9 IWK with EPC/eMBMS for Public Safety  
1 |  | x |  |  |  |  |  |  |   
2 | x |  |  | x |  |  |  |  |   
3 | x |  | x | x |  |  |  |  |   
4 | x |  | x | x |  |  |  |  |   
5 | x |  |  |  |  | x |  |  |   
6 | x |  |  |  |  |  |  |  |   
7 |  |  |  |  |  | x |  |  |   
8 | x |  |  |  |  |  |  |  |   
9 | x |  |  |  |  |  |  |  |   
10 | x |  |  |  |  |  |  |  |   
11 | x |  |  | x |  |  | x |  |   
12 | x |  |  | x |  |  | x |  |   
13 | x |  |  |  |  |  |  |  |   
14 | x |  | x |  |  |  |  |  |   
15 | x |  |  |  |  |  |  |  |   
16 | x |  | x |  |  |  |  |  |   
17 |  |  |  | x |  |  |  |  |   
18 |  |  |  |  |  |  | x |  |   
19 |  |  |  |  |  | x |  |  |   
20 |  |  |  |  |  | x |  |  |   
21 |  |  |  |  |  | x |  |  |   
22 |  |  |  |  |  |  | x |  |   
23 |  |  |  |  |  |  | x |  |   
24 |  |  |  |  |  |  | x |  |   
25 |  |  |  |  |  |  | x |  |   
26 |  |  |  |  |  |  | x |  |   
27 |  |  |  |  |  |  | x |  |   
28 |  |  |  |  |  |  | x |  |   
29 |  |  |  |  |  |  | x |  |   
30 |  |  |  |  |  |  | x |  |   
31 |  |  |  |  |  |  | x |  |   
32 | x |  |  |  |  |  |  |  |   
33 | x |  |  |  |  |  |  |  |   
34 |  |  | x |  |  |  |  |  |   
35 |  |  |  | x |  |  |  |  |   
36 |  |  |  | x |  |  |  |  |   
37 |  |  |  | x |  |  |  |  |   
38 |  |  |  |  |  | x |  |  |   
39 |  |  |  |  |  |  | x |  |   
40 |  |  |  |  |  |  | x |  |   
41 |  |  |  |  |  |  |  |  | x  
42 |  |  |  |  |  |  |  |  | x  
43 |  |  |  |  |  |  |  |  | X  
44 | x |  |  |  |  |  |  |  |   
45 | x |  |  |  |  |  |  |  |   
46 |  |  |  |  |  |  |  |  | x  
## 6.1 Solution #1: Multicast service levels
### 6.1.1 Functional description
The following service levels for the multicast communication service are
defined:
NOTE 1: Transport Only mode and Full-Service mode of operation as defined in
TS 23.246 [4] differ from the service levels defined here.
**Basic Service Level**
Requirements for the basic service level are mandatory to be supported. The
following requirements are defined:
\- Media are transported transparently through the 5GS;
\- Request to receive the multicast service;
\- Efficient packet distribution from the 5GS ingress to (R)AN node(s).
\- Efficient data delivery from (R)AN node(s) to the UE.
**Enhanced Service Level**
The requirements for the Basic service level also apply for the Enhanced
Service Level. Additional requirements for the Enhanced Service Level are
listed below. Different requirements out of this set may be necessary to
address specific use cases.
\- Local MBS service;
\- User authentication and authorization;
NOTE 2: User authentication and authorization can be done by 5GS or AF or
both, or even not needed for a multicast communication service.
\- Explicit configuration of multicast session by network function external to
the 5GS including:
\- Group member management;
\- Enhanced QoS support;
NOTE 3: 5G MBS can provide different QoS other than default QoS for different
multicast groups.
\- Content security protection.
**Support of 5GC Shared MBS traffic delivery method and 5GC Individual MBS
traffic delivery method.**
The 5GC Shared MBS traffic delivery method is required in all MBS deployments.
The 5GC Individual MBS traffic delivery method is required for mobility
to/from non-homogeneous support of MBS in NG-RAN.
NOTE 4: Whether there could be other cases using Individual delivery will
align with the conclusion of KI#1.
### 6.1.2 Procedures
It is expected that procedures to address the requirements for the service
levels defined in this solution proposal are proposed as part of other
solution proposals.
### 6.1.3 Impacts on services, entities and interfaces
It is expected that an impact analysis to address the requirements for the
service levels defined in this solution proposal are proposed as part of other
solution proposals.
## 6.2 Solution #2: MBS Session setup using flexible radio resources
### 6.2.1 Functional Description
This Solution assumes the architectural alternative 2 (see Annex A, clause
A.2). The solution works for both non-roaming and for inbound roaming. The
inbound roamers can join 5MBS service provided by visited network.
NOTE 1: For inbound roamers, the optional 5GC individual delivery is not
supported. If supported by the application, unicast delivery can be used if
5MBS is not supported in an area.
Editor\'s note: Roaming procedures require more checking, In particular, is it
acceptable not to provide 5GC individual delivery for roaming users?
This solution addresses Key Issue #1 and Key Issue #4. The solution focuses on
IP based communication.
NOTE 2: The solution assumes that the UE can notify the network of the MBS
Session it is interested in.
In this solution for Multicast:
\- When no MBS Session context exists in AMF for an MBS service:
\- If a UE is interested in an MBS service, the UE notifies AMF of the
interested MBS service. An AMF may also become aware of a new MBS service when
a UE using an MBS service is moved from an old serving AMF to a new serving
AMF;
\- For the first UE initiating the MBS service, the (new) AMF notifies the MB-
SMF for MBS service be able to later receive to initiation of the MBS Session.
\- When MBS Session context exists in NG-RAN for an MBS service:
\- NG-RAN detects that no UE is using the MBS service (e.g. due to UE moving
to a different NG-RAN), NG RAN releases its resources for the MBS service.
Based on the proposal above that NG-RAN can dynamically allocate the radio
resource for MBS service, when UE moves from one NG-RAN to another, the
multicast service can continue without switching to the unicast. Service,
which results in that radio resources being used dynamically moves from the
cells within the dotted circle to the cells within the solid circle.
Figure 6.2.1-1: Dynamic use of radio resources
NOTE 3: Further interaction with RAN WGs, and SA WG4 and SA WG6 will be
triggered, as needed.
The solution describes QoS handling aspects e.g. as part of Session Start
procedure in clause 6.2.2.2. Service requirements of AF are translated into 5G
QoS for MBS services. The MB-SMF may get QoS info from the AF (which may be
via NEF), or MB-SMF may get from PCF (if deployed). The QoS info in PCF may be
obtained from UDR if previsioned by the AF or locally configured. The MB-SMF
sends the QoS Profiles to NG-RAN via AMF and the MB-SMF sends the QoS
parameters to the MB-UPF for QoS enforcement. The AMF stores in the MBS
Session context the MBS QoS profile(s) which contains QoS parameters such as
5QI, ARP and MFBR/GFBR,
The figure below illustrates an architecture that the procedures in this
solution applies to.
Figure 6.2.1-2: Architecture
If the 5GC determines to apply _5GC Individual MBS traffic delivery_ , then:
\- the AMF will request the UE to establish PDU Session if not already
established towards the same DNN and slice;
\- then the AMF informs SMF of the LL MC and Source host addresses of MB-UPF
so that the PSA-UPF can join the multicast tree of MB-UPF (like NG-RAN) and
receive MBS session data from MB-UPF;
Figure 6.2.1-3 below illustrates the association between the PDU Session and
MBS Session to apply _5GC Individual MBS traffic delivery_ (note that not all
NFs are shown). The PSA-UPF in the figure invokes reception of MBS session
data similarly to an NG-RAN node.
Figure 6.2.1-3: MBS data injected into PDU Session
NOTE 4: HL MC address is not used by PSA-UPF for receiving MBS session data in
this solution.
### 6.2.2 Procedures
#### 6.2.2.0 General
NOTE: The message names in the procedures below are descriptive. It is assumed
that the names are updated with corresponding SBI based names where applicable
during the normative phase. N2, N3 messages are dependent on RAN WG3
decisions.
#### 6.2.2.1 Session Join
The Session Join procedure is used by UEs to inform the 3GPP network of the UE
interest in an MB Session. During the Session Join procedure, the distribution
area of the multicast session is adjusted if needed. As such, the Session Join
procedure together with other procedures, e.g. Session Leave procedure and
Handover procedure, enables the dynamic and efficient use of radio resources.
When the multicast transport is described below, source specific multicasting
is assumed. That is, the parameter \"LL MC Address\" is assumed to be
accompanied by a \"Source host address\" parameter in the descriptions below.
Figure 6.2.2.1-1: Session Join
0\. The UE registers and a PDU Session is established. The UE and the AF uses
the PDU Session e.g. to signal and establish a group on application level (see
TS 23.468 [5]).
NOTE 1: If a PDU session is used for application level signalling in steps 0
and 5, it is managed independently from the MB Session. That is, the PDU
Session does for example not need to be maintained while the UE is receiving
multicast content.
1\. AF sends Allocate TMGI Request () message to NEF/MBSF to request
allocation of a TMGI to identify a new group.
Optionally TMGIs may be pre-allocated in the AF and the 5GC. When a pre-
allocated TMGI is used, the pre-allocated TMGI shall be included in the
Allocate TMGI Request (TMGI) message.
NOTE 2: A combined TMGI allocation and Session start on an N33 API is assumed
to use Allocate TMGI Request/Response + MB Session Start messages on the N29
interface.
The AF may include a new indication DisableIndividualDelivery to indicate if
_5GC Individual MBS traffic delivery_ should not be applied for a specific MB
Session e.g. due to application characteristics.
2\. NEF/MBSF selects based on local configuration an MB-SMF (if there are
multiple) to handle the group and sends an Allocate TMGI Request () message to
the MB-SMF. Optionally, the MBSF makes the TMGI allocation, stores in the MB
Session Context and includes the allocated TMGI in the message to the MB-SMF.
The MBSF may have a pre-configured TMGI range for each MB-SMF. The TMGI range
should also be configured/registered in the NRF to allow AMFs to discover
which MB-SMF is controlling an MB Session identified by a TMGI.
Optionally TMGIs may be pre-allocated in the AF and the 5GC e.g. based on SLA.
When a pre-allocated TMGI is used, the pre-allocated TMGI shall be included in
the Allocate TMGI Request (TMGI) message. The MB SMF or optionally the MBSF
shall after local checks (e.g. that it is allowed for pre-allocation and has
not already been used) use the provided TMGI if present, and proceed as normal
(i.e. store it in the MB Session Context, etc.).
NEF/MBSF pass the indication DisableIndividualDelivery (if received) to the
MB-SMF.
3\. MB-SMF allocates a TMGI (optionally pre-allocated TMGI may be used, see
step 2), a Lower Layer Multicast IP Address (LL MC address) for N3, and N6
tunnel information and stores the information in a new MB Session Context set
to \'inactive\' state. MB-SMF returns the TMGI and the N6 tunnel information
to the NEF/MBSF. If MB-SMF makes the TMGI allocation, it may e.g. allocate a
TMGI from a pre-configured TMGI range.
NOTE 3: For large networks or for redundancy reasons, the NEF/MBSF might use
multiple MB-SMFs (and MB-UPFs).
NOTE 4: Since the N3 LL MC address is used for 5GS internal transport, it is
considered sufficient to allocate the N3 LL MC address at Session Start i.e.
when resources for the MB Session is allocated in different nodes. A one-to-
one relationship between N3 LL MC Address and MB Session is used.
4\. The NEF/MBSF establishes a new MB Session Context set to \'inactive\'
state, stores received information and responds to the AF by sending a
Allocate TMGI Response (TMGI) message.
5\. MB Session Announcement (see e.g. TS 23.468 [5]). The AF informs the
members in the group of various group info e.g. TMGI, HL MC Address. The HL MC
address may be allocated by the AF for the group/TMGI.
6\. UE indicates its interest to join an MB Session by sending an UL NAS MB
Session Join Request (TMGI) message. NG-RAN forwards the NAS message to the
AMF. The AMF stores the TMGI in its UE Context.
NOTE 5: The UE always joins the MB Session as such. For an MB Session (i.e. a
TMGI) that has several media streams, the UE may choose to process and present
all or a selected set of media streams.
NOTE 6: This solution does for the moment not use AF based authorization of UE
at Session Join (e.g. in step 7). Such authorization could potentially cause
heavy signalling in the system without being motivated from a security point
of view.
NOTE 7: For the moment, it is unclear whether authorization of UE to join the
MB session in 5GC is needed. Authorization on the application layer is
considered sufficient. If the requirement to have additional authorization in
5GC becomes clear in the future, then a solution can be proposed, e.g. the AF
provisions the UDR with the necessary info and UDR provides such info to the
UDM as subscription data for AMF to check. An alternative could be that the UE
authorization is performed at 5MBS feature level, and this can be achieved by
including a new authorization parameter for 5MBS in the subscription data.
7\. If the AMF does not already have a MB Session Context for the received
TMGI (in step 6), the AMF selects an MB SMF for the TMGI by querying the NRF.
A MB Session Request (TMGI, AMF ID) message is sent to the MB SMF to announce
the AMF\'s interest in the MB Session. When the MB-SMF has returned a MB
Session Response () message, the AMF creates a MB Session Context in
\'inactive\' state for the TMGI.
7a. If the AMF knows that the NG-RAN does not support 5MBS, and in step 2 the
MB-SMF has not received DisableIndividualDelivery from the AF, the AMF may
decide to apply _5GC Individual MBS traffic delivery_ when the MBS Session is
started later.
NOTE 8: The AMF can know if NG-RAN supports 5MBS based on the configuration.
If the AMF determines that 5GC Individual MBS traffic delivery should not be
applied to the MBS session, and NG-RAN does not support 5MBS, the AMF will
reject the UE Session Join request. In this case, N2 MB Session Join message
in step 8 will be skipped.
8\. The AMF stores the TMGI and the NG RAN ID of the originating node of the
N2 message in step 6 in the AMF MB Session Context. The AMF creates a DL NAS
MB Session Join Response () message and piggy backs that on an N2 MB Session
Join (NGAP ID, TMGI) message. The NG-RAN stores the TMGI in the UE context in
NG-RAN.
NOTE 9: NG-RAN does only keep active MB Session Contexts, i.e. created during
Session Start procedures.
NOTE 10: The primary purpose of the MB Session Context in the AMF is for the
AMF to be able to manage forwarding of Session Start messages to NG-RAN nodes
where members of the group are camping and to initiate Group paging for CM-
IDLE group members.
#### 6.2.2.2 Session Start
The Session Start procedure is used by the AF to activate an MB Session and
start transmission of multicast/broadcast data. During the Session Start
procedure, resources for the MB Session are setup in the MB-UPF and in the NG-
RAN.
When the multicast transport is described below, source specific multicasting
is assumed. That is, the parameter \"LL MC address\" is assumed to be
accompanied by a \"Source host address\" parameter in the descriptions below.
This clause assumes that 5MBS is supported by NG-RAN. For NG-RAN not
supporting 5MBS, _5GC Individual MBS traffic delivery_ may be applied for the
MBS session, please refer to clause 6.2.2.2a.
Figure 6.2.2.2-1: Session Start
1\. The AF requests activation of an MB Session by sending an Activate MBS
Bearer Request (TMGI, HL MC Address, Service Requirement) message to the
NEF/MBSF. AF has allocated a Higher Layer IP Multicast Address (HL MC
Address). Service Requirement for the MB Session may be included. If multiple
MBS QoS Flows are expected to be established, then the AF needs to provide
different packet filters and associated service requirement.
NOTE 1: A combined TMGI allocation and Session start on an N33 API is assumed
to use Allocate TMGI Request/Response + MB Session Start messages on the N29
interface.
2 The NEF/MBSF checks if the input parameters e.g. HL MC address are valid.
NEF/MBSF sets the MB Session Context to active. NEF/MBSF sends a MB Session
Start (TMGI, Service Requirement) message to the MB-SMF.
3\. MB-SMF sends the TMGI for the MB Session and the Service Requirement to
the PCF. The PCF returns a 5G QoS Profile, which the MB-SMF uses as the 5G
Authorized QoS Profile for the MB Session. If multiple MBS service
requirements are received, then PCF will provide multiple 5G Authorized QoS
Profiles,
4\. MB-SMF sets up the N6 resources for the MB Session in the MB-UPF and the
N3 resources for transport multicast tunnelling using the LL MC address
allocated for the TMGI.
Optionally Media reception in MB-UPF is un-tunnelled, in which case the MB-SMF
also provides the HL MC Address so that the MB-UPF can send IGMP/MLD join and
receive the (un-tunnelled) IP Multicast Media stream.
If N6 tunnelling is used, the MB-UPF allocates N6 tunnel information (e.g. UDP
port and IP address) and returns to the MB-SMF. MB-SMF stores the received
info in the MB Session Context.
If multiple MBS QoS Flows are established, the MB-UPF map the downlink MBS
data to the MBS QoS Flow based on the packet filters which could be HL MC
address and ports, or unicast UDP tunnel info.
5\. MB-SMF sets the MB Session Context to active and sends MB Session Start
(TMGI, LL MC Address and source host address, 5G Authorized QoS Profile)
messages to all AMFs that has earlier joined the MB Session.
When the AMF receives the MB Session Start message, AMF sets its MB Session
Context to active state. The AMF proceeds with step 6 and step 10 onwards in
parallel.
NOTE 2: LL MC Address and source host address of MB-UPF is provided if
multicast transport is configured to be used between the NG-RAN and MB-UPF
nodes. Otherwise N3 point-to-point transport is assumed.
6\. If the AMF has CM-IDLE UEs that have joined the MB Session (i.e. any CM-
IDLE UE with the specific TMGI of a MB Session in stored in the UE Context of
the AMF), the AMF performs group paging including the Group Paging Identity
(TMGI) in the Paging message in the registration areas of the CM-IDLE UEs. The
NG-RAN node triggers group paging. The AMF determines the group paging area by
combing the paging areas of the individual UE within the multicast group.
NOTE 3: How to handle group paging and how to efficiently listen for both
unicast paging and group paging etc. are to be studied by RAN WGs.
7-9. UEs respond to the Group paging e.g. by sending UL NAS MB Session Join
Request (TMGI) to AMF (see clause 6.2.2.1 step 6 to 8).
10\. The AMF sends a MB Session Resource Setup Request (TMGI, LL MC and source
host address, 5G Authorized QoS Profile) message to all RAN nodes where CM
CONNECTED UEs that has joined the TMGI resides. NG-RAN creates a MB Session
Context (if it not already exists), sets it to \'active\' state, stores the
TMGI, the QoS Profile and a list of AMF IDs in the MB Session Context. If a NG
RAN node receives multiple MB Session Resource Setup Request messages for the
same TMGI (e.g. from several AMFs the NG-RAN is connected to) (and even if the
LL MCs are different in the case of multiple MB-UPFs), NG-RAN stores each
sender AMF ID in the MB Session Context, but only performs step 11 once
(instead continues at step 12). The LL MC Address and Source Host Address are
optional parameters and only provided by AMF to NG-RAN if N3 multicast
transport is configured to be used in the 5GC.
11\. If NG-RAN prefers to use N3 multicast transport (and if LL MC Address is
available in NG-RAN), the NG-RAN joins the multicast group (i.e. LL MC
Address). NG-RAN establishes PTM or PTP DL resources for the MB Session, and
if there are UEs in CM-Connected with RRC_INACTIVE state with the TMGI in
their UE Contexts, NG-RAN performs the Network triggered transition from
RRC_INACTIVE to RRC_CONNECTED procedure for those UEs (see TS 38.300 [10]).
12\. The NG-RAN reports successful establishment of the MB Session resources
(which may include multiple MBS QoS Flows) by sending MB Session Resource
Setup Response (TMGI, Tunnel Info) message(s) to the AMF. NG-RAN provides its
Tunnel Info if NG-RAN prefers to use N3 point-to-point transport (or if the LL
MC Address is not available in NG-RAN) between the NG-RAN and MB-UPF.
13\. The AMF sends MB Session Start Ack (TMGI, Tunnel Info) to the MB-SMF.
NOTE 4: The AMF may send an Ack for each response it receives from NG-RAN
nodes (e.g. useful for small MCPTT areas). That is, steps 13 to 15 may be
repeated multiple times (once for each involved NGâ€‘RAN node). The AMF may also
use an upper limit for the number of Acks sent and fall-back to aggregated
Acks if the number of RAN Acks go beyond the limit (to reduce signalling
load). That is, collect status from all or a number of downstream nodes (with
time out) and then make an aggregated report. An MCPTT server may want to
start an MCPTT call (i.e. to transmit media) as soon as possible, e.g. already
when a few members of a group can successfully receive the media. In such
cases it is reasonable to be able to send intermediate and multiple
acknowledgements to the AF.
13b. If N3 point-to-point transport is to be used (i.e. Tunnel Info is present
in the MB Session Start Ack message from AMF), the MB-SMF sends an N4 request
to the MB-UPF to allocate the N3 point-to-point transport tunnel for a
replicated MBS stream for the MB Session.
14-15. The MB-SMF sends the MB Session Start Ack (TMGI) message to the
NEF/MBSF. N6 Tunnel info is included in the response if not already provided
to the AF. The NEF/MBSF sends an Activate MBS Bearer Response including the N6
Tunnel Info to the AF.
16\. The MB Session is now active. The AF starts transmitting the DL media
stream using the N6 Tunnel Info, or optionally un-tunnelled i.e. as an IP
multicast stream using the HL MC address.
17\. The NG-RAN transmits the received DL media stream using DL PTM or PTP
resources.
#### 6.2.2.2a Session Start with NG-RAN not supporting 5MBS and 5GC Individual
MBS traffic delivery applied to the MBS session
This clause assumes NG-RAN does not support 5MBS, and the AMF decides to apply
_5GC Individual MBS traffic delivery_ for the MBS session.
Figure 6.2.2.2a-1: Session Start with 5GC Individual MBS traffic delivery
applied
1\. MBS session is started as in steps 1-5 in clause 6.2.2.2.
2\. Either step 2a or step 2b applies below:
2a. This step applies if UE joins the MBS session before MBS session is
started. The AMF determines that 5GC Individual MBS traffic delivery is to be
applied as described in step 7a of clause 6.2.2.1.
2b. This step applies if the UE joins the MBS session after the MBS session is
started as in step 7 of clause 6.2.2.2 and the AMF determines that 5GC
Individual MBS traffic delivery is to be applied.
3\. The AMF completes the MBS Session start procedure as in steps 13-15 of
clause 6.2.2.2.
4\. Two options (i.e. 4a and 4b) are described how the MBS data stream can be
injected to the PSA UPF.
4a-1. AMF request the SMF to apply 5GC individual MBS traffic delivery by
providing MB-UPF the LL MC and Source host address and the MBS QoS profile.
4a-2. SMF instructs the PSA-UPF to join the multicast tree of MB-UPF (like NG-
RAN joining the multicast tree of MB-UPF). The PSA-UPF sends an IGMP/MLD Join
unless this has already been done (e.g. for other UE).
OR
4b-1. AMF request the SMF to apply 5GC individual MBS traffic delivery by
providing the MB-SMF info and MBS QoS profile.
4b-2. SMF request the PSA UPF to allocate tunnel for receiving MBS stream.
4b-3: SMF provides the allocated tunnel to MB-SMF;
4b-4: MB-SMF provides the UPF tunnel info to MB-UPF, and requests the MB-UPF
to allocate the tunnel for replicated MBS stream;
4b-5. MB-SMF provides SMF the tunnel info of MB-UPF. The SMF then provides the
tunnel info of MB-UPF to PSA UPF. Till now, the tunnel between PSA UPF and MB-
UPF is established.
Between PSA UPF and MB-UPF, only one tunnel for the replicated MBS stream is
necessary.
5\. Depending on the MBS QoS profile(s) received in step 4a-1 or 4b-1, the SMF
may trigger PDU Session modification to create additional QoS Flow(s) for the
MBS stream.
6\. MBS stream is sent to the MB-UPF.
7\. MBS stream is received by PSA-UPF and forwarded on PDU Session(s) as 5GC
Individual MBS traffic delivery.
#### 6.2.2.2b Session Join using user plane Join
Compared to Session Join using NAS signalling described in clauses 6.2.2.1 and
6.2.2.2, the difference is as follows:
\- UE establishes a PDU Session;
\- UE sends an IGMP/MLD JOIN in the user plane and the PSA-UPF detects it.
It\'s assumed that the SMF has provided proper packet detection rule based on
PCC rule to detect the IGMP/MLD JOIN message.
\- When the PSA-UPF detects a UE join, it notifies the SMF which then forward
the request to the AMF. The AMF then continues as in clause 6.2.2.1 and
6.2.2.2.
#### 6.2.2.3 MCPTT: New Group Call
This procedure is an example of the typical sequence when a new Mission
Critical Push-To-Talk call is established. It includes group affiliation and
session announcement using application level signalling, TMGI allocation,
first UE joining the group call, and the start of MBS session media
transmission by the application server (AF). Transport Only mode is used as an
example in the flows.
Figure 6.2.2.3-1: MCPTT: New Group Call
1-8. The upper part steps 1 to 8 corresponds to the steps in the Session Join
procedure clause 6.2.2.1.
1-17. The bottom part steps 1 to 17 corresponds to the steps in the Session
Start procedure clause 6.2.2.2.
#### 6.2.2.4 MCPTT: Ongoing Group Call
This procedure shows two figures, the first in figure 6.2.2.4-1 shows the
second (or subsequent) UE in a cell joining an ongoing group call. That is,
when another UE in the cell has already joined the same group call. This is
probably the most common sequence for mission critical group calls. The second
figure in 6.2.2.4-2 shows the sequence for the first UE in a cell, i.e. when
the MB Session resources has to be established in the cell before reception
can commence. This requires slightly more signalling, but is probably a bit
less frequent than the first for normal group calls.
See also the Session Join and Session Start procedures in clauses 6.2.2.1 and
6.2.2.2.
Figure 6.2.2.4-1: MCPTT: Ongoing Group Call -- Second UE in a cell
0\. A PTM or PTP transmission of media is ongoing to other UE in the cell.
1\. The new UE indicates its interest to join the MB Session by sending an UL
NAS MB Session Join Request (TMGI) message. The AMF stores the TMGI in its UE
Context.
2\. If the AMF does not already have a MB Session Context for the received
TMGI (the first UE in the cell for this group may be served by a different
AMF), the AMF selects an MB SMF for the TMGI by querying the NRF. A MB Session
Request (TMGI, AMF ID) message is sent to the MB SMF to announce the AMF\'s
interest in the MB Session. When the MB-SMF has returned a MB Session Response
(active) message, the AMF creates a MB Session Context in \'active\' state for
the TMGI.
3\. The AMF stores the TMGI and the NG RAN ID of the originating node of the
N2 message in step 6 in the AMF MB Session Context. The AMF creates a DL NAS
MB Session Join Response () message and piggy backs that on an N2 MB Session
Join (NGAP ID, TMGI) message. The NG-RAN stores the TMGI in the UE context in
NG RAN.
4\. NG-RAN determines that it has an MB Session Context in active state for
the TMGI. Therefore NG-RAN establishes PTM or PTP DL resources for the UE.
5\. The transmission of the DL media stream to the UE commences.
Figure 6.2.2.4-2: MCPTT: Ongoing Group Call -- First UE in a cell
0-3. Corresponds to step 0-3 in figure 6.2.2.4-1.
4\. When the NG-RAN has received the N2: MB Session Join (NGAP ID, TMGI)
message, the NG-RAN determines that it does not have any MB Session Context
(in active state) for the TMGI. However, after having sent the N2 MB Session
Join message to NG-RAN, the AMF determines that the MB Session is in active
state and that AMF has not already requested NG-RAN to setup resources for the
MB Session. Therefore, AMF sends an MB Session Resource Setup Request (TMGI,
LL MC, 5G Authorized QoS Profile) message to the NG-RAN node. If a NG RAN node
receives multiple MB Session Resource Setup Request messages for the same TMGI
(e.g. for an MB Session Context in active state), the NG-RAN only performs the
resource setup once.
5-6b. Corresponds to step 11, 12, 13 & 13b in Session Start procedure in
clause 6.2.2.2.
NOTE: After step 6, the AMF does not send any MB Session Start Ack to MB-SMF
(like in clause 6.2.2.2), except if N3 point-to-point transport tunnel is used
where an MB Session Start Ack is sent to MB-SMF but not propagated further to
NEF/MBSF.
7\. Corresponds to step 17 in Session Start procedure in clause 6.2.2.2.
#### 6.2.2.5 Session Leave
The Session Join procedure is used by UEs to inform the 3GPP network that the
UE interest in an MB Session has ceased. During the Session Leave procedure,
the distribution area of the multicast session is adjusted if needed. This
enables a dynamic and efficient use of radio resources.
Figure 6.2.2.5-1: Session Leave
0\. Potential decision on application level for UE to leave the group.
1\. There may be a media stream before the UE has left. UE receives the media
by PTM or PTP.
2\. The UE sends a UL NAS MB Session Leave Request (TMGI) message to the AMF.
The AMF removes the TMGI from the UE Context.
3\. The AMF creates a DL NAS MB Session Leave Response () message and piggy
backs that on an N2 MB Session Leave (NGAP ID, TMGI) message. The NG-RAN
removes the TMGI from the UE context in NG-RAN.
4\. The NG-RAN adjusts the PTM/PTP transmission if necessary.
5a. If this UE is the last UE in this NG-RAN using the MB Session (i.e. the
TMGI not stored in any more UE Context in the NG-RAN node) and N3 multicast
transport has been used, the NG-RAN sends a Leave message (LL MC Address) to
stop the media stream to this NG-RAN node and then deletes the MB Session
Context.
5b. If this UE is the last UE in this NG-RAN using the MB Session (i.e. the
TMGI not stored in any more UE Context in the NG-RAN node) and N3 point-to-
point transport has been used, the NG-RAN sends a RAN MB Session Release
Request (TMGI, N3 Tunnel Info) to AMF to stop the media stream to this NG-RAN
node. NG-RAN then deletes its MB Session Context. AMF responds to NG-RAN when
done.
5c. AMF forwards the RAN MB Session Release Request (TMGI, N3 Tunnel Info) to
MB-SMF to stop the media stream to this NG-RAN node. MB-SMF responds to AMF
when done.
5d. The MB-SMF sends an N4 request to the MB-UPF to deallocate the N3 point-
to-point transport tunnel for the replicated MBS stream to the NG-RAN node.
6\. If this UE is the last UE in this AMF being part of the MB Session, the
AMF sends an MB Session Release Request (TMGI, AMF ID) to the MB-SMF, for AMF
to unsubscribe to the MB Session. The MB-SMF removes the AMF in the MB-SMF MB
Session Context.
If _5GC Individual MBS traffic delivery_ is applied for the UE, the AMF
informs the SMF that _5GC Individual MBS traffic delivery_ for the MBS Session
shall be stopped on the PDU Session. The SMF instructs the PSA-UPF to stop
forwarding the MBS data stream onto the PDU Session. If this is the last UE
for which _5GC Individual MBS traffic delivery_ was applied in the PSA-UPF,
the SMF also instructs the PSA-UPF to leave the multicast tree of the MB-UPF.
7\. The MB-SMF sends an MB Session Release Response message to the AMF. AMF
deletes its MB Session Context.
#### 6.2.2.6 Session Stop
The Session Stop is used to stop media delivery for a MB Session i.e. to all
UEs in a group defined by a TMGI. Afterwards the MB Session will still remain,
and the Session can later be restarted again with limited amount of
signalling. The resources in the NG-RAN are however released and the NG-RAN MB
Session Context is deleted. The MB Session Context in AMF, MB-SMF and NEF/MBSF
are kept but set to inactive state. This preserves the MBS distribution tree,
and reduces the response time to restart the MB Session if needed. The Session
Stop procedure is intended for MB Sessions in active state, using it on an
inactive MB Session does not change anything.
Figure 6.2.2.6-1: Session Stop
0\. Decision on application level for the Session to be stopped.
1\. The AF may stop the media stream before sending the Deactivate MBS Bearer
Request (TMGI) message to the 3GPP network.
2\. The AF sends a Deactivate MBS Bearer Request (TMGI) message to the
NEF/MBSF.
3\. The NEF/MBSF sends a MB Session Stop Request (TMGI) message to the MB-
SMF(s) that has been involved in the MB Session. The NEF/MBSF sets its MB
Session Context to inactive state.
4\. MB-SMF sends a MB Session Stop Request (TMGI) message to the AMF(s) that
has been involved in the MB Session. The MB-SMF sets its MB Session Context to
inactive state. The N6 Tunnel is kept.
5\. The AMF sends a MB Session Resource Release Request (TMGI) message to all
RAN nodes where CM CONNECTED UEs that has joined the TMGI resides. If a NG RAN
node receives multiple MB Session Resource Release Request messages for the
same TMGI (e.g. from several AMFs the NG-RAN is connected to), NG-RAN only
performs step 6 once. The AMF sets its MB Session Context to inactive state.
6\. The NG-RAN stops the PTM/PTP transmission. If N3 multicast transport has
been used, the NG-RAN sends a Leave message (LL MC Address) to stop the media
stream to this NG-RAN node. NG-RAN deletes its MB Session Context.
7\. The NG-RAN reports successful release of resources for the MB Session by
sending MB Session Resource Release Response (TMGI) message(s) to the AMF(s).
8\. The AMF sends MB Session Stop Response (TMGI) to the MB-SMF.
NOTE: The AMF may send a response message for each response it receives from
NG-RAN nodes (e.g. useful for small MCPTT areas). That is, steps 8 to 10 may
be repeated multiple times (once for each involved NG RAN node). The AMF may
also use an upper limit for the number of Responses sent and fall-back to
aggregated responses if # RAN responses go beyond the limit (to reduce
signalling load). That is, collect status from all or a number of downstream
nodes (with time out) and then make an aggregated report.
If 5GC Individual MBS traffic delivery is applied for any UE in the AMF, the
AMF informs the SMF that MBS Session is stopped. The SMF instructs the PSA-UPF
to stop forwarding the MBS data stream onto any PDU Session and to leave the
multicast tree of the MB-UPF.
9\. The MB-SMF sends the MB Session Stop Response (TMGI) message to the
NEF/MBSF.
9b. If N3 point-to-point transport has been used for any NG-RAN node, and if
not already done for this MB Session, the MB-SMF repeats sending N4 requests
to the MBâ€‘UPF to deallocate all N3 point-to-point transport tunnels used for
the MB Session.
10\. The NEF/MBSF sends a Deactivate MBS Bearer Response (TMGI) to the AF.
#### 6.2.2.7 Session Delete
The Session Delete is used to stop media delivery for a MB Session and to
delete all resources including MB Session Contexts in NG-RAN and in 5GC for
the MB Session. The MB Session Contexts are deleted from all nodes, the
distribution tree removed and the TMGI is deallocated. The MB Session cannot
be restarted (i.e. using the Session Start procedure). The Session Delete
procedure can be used both on active (ongoing) Sessions and on inactive
(stopped) Sessions.
Figure 6.2.2.7-1: Session Delete
0\. Decision on application level to dissolve a group and deallocate the group
TMGI.
1\. The AF sends a Deallocate TMGI Request (TMGI) message to the NEF/MBSF.
2\. The NEF/MBSF sends a Deallocate TMGI Request (TMGI) message to the MB-
SMF(s) that has been involved in the MB Session. If it was MBSF that made the
TMGI allocation, MBMS releases the TMGI, otherwise MB SMF releases the TMGI.
The NEF/MBSF sets its MB Session Context to deleted state (for delayed
deletion to when procedure ought to be terminated).
3.-4. MB-SMF request the MB-UPF to release the resources allocated for the MB
Session (e.g. designated by the TMGI), including the N6 tunnel. The MB-UPF
responds to the MB-SMF when resources are released.
5\. MB-SMF sends a MB Session Delete Request (TMGI) message to the AMF(s) that
has been involved in the MB Session. The MB-SMF sets its MB Session Context to
deleted state.
6\. If the MB Session is still ongoing (i.e. if the MB Session Context in the
AMF is still in active state), the AMF sends a MB Session Resource Release
Request (TMGI) message to all RAN nodes where CM CONNECTED UEs that has joined
the TMGI resides. If a NG RAN node receives multiple MB Session Resource
Release Request messages for the same TMGI (e.g. from several AMFs the NG-RAN
is connected to), NG-RAN only performs step 7 once.
The AMF sets its MB Session Context to deleted state.
If the MB Session is not ongoing (i.e. if the MB Session Context in the AMF is
in inactive state), the procedure skips steps 6 to 8 and the AMF continues
with step 9.
7\. The NG-RAN stops the PTM/PTP transmission. If N3 multicast transport has
been used, the NG-RAN sends a Leave message (LL MC Address) to stop the media
stream to this NG-RAN node. NG-RAN deletes its MB Session Context.
8\. The NG-RAN reports successful release of resources for the MB Session by
sending MB Session Resource Release Response (TMGI) message(s) to the AMF(s).
9\. The AMF sends MB Session Delete Response (TMGI) to the MB-SMF.
NOTE: The AMF may send a response message for each response it receives from
NG-RAN nodes (e.g. useful for small MCPTT areas). That is, steps 9 to 11 may
be repeated multiple times (once for each involved NG RAN node). The AMF may
also use an upper limit for the number of Responses sent and fall-back to
aggregated responses if # RAN responses go beyond the limit (to reduce
signalling load). That is, collect status from all or a number of downstream
nodes (with time out) and then make an aggregated report.
If 5GC Individual MBS traffic delivery is applied for any UE in the AMF, the
AMF informs the SMF that MBS Session is deleted. The SMF instructs the PSA-UPF
to stop forwarding the MBS data stream onto any PDU Session and to leave the
multicast tree of the MB-UPF.
9b. If N3 point-to-point transport has been used for any NG-RAN node, and if
not already done for this MB Session, the MB-SMF repeats sending N4 requests
to the MBâ€‘UPF to deallocate all N3 point-to-point transport tunnels used for
the MB Session.
10\. The MB-SMF sends the Deallocate TMGI Response (TMGI) message to the
NEF/MBSF.
11\. The NEF/MBSF sends a Deallocate TMGI Response (TMGI) to the AF.
### 6.2.3 Impacts on services, entities and interfaces
UE:
\- Reception of multicast data using PTM /PTP in RRC Connected.
\- MBS control client which can exchange Session Join, and Session Leave
messages.
NG-RAN:
\- Support for MB Sessions and MBS related signalling on N2 with AMF and on N3
with UPF.
\- Transmission of multicast data using PTM /PTP in RRC Connected.
AMF:
\- MBS control function which can maintain the MBS signalling tree and control
MBS resources in NG-RAN.
\- Support selection of SMFs that have MBS capabilities using NRF.
\- AMF becomes aware of the NG-RAN\'s 5MBS capability if there is no
homogenous support of 5MBS in NG-RANs;
\- When NG-RAN does not support 5MBS, AMF determines if 5GC individual
delivery will be applied taking the information from the Application into
consideration. For 5GC Individual MBS traffic delivery, the AMF interacts with
SMF of PDU Session so that the PSAâ€‘UPF can start/stop receiving 5MBS data from
MB-UPF.
SMF:
\- MBS control function which can maintain the MBS signalling tree and respond
to session requests from the NEF/MBSF, PCF and AF including allocation of
TMGIs.
\- Optionally support deployments with SMFs dedicated to MBS services.
\- For 5GC Individual MBS traffic delivery, the SMF (for PDU Session) handles
the request from AMF to receive 5MBS data from MB-UPF.
NEF:
\- MBS control function (i.e. MBSF) which can maintain the MBS signalling tree
and respond to session requests from the AF.
\- Support selection of SMFs that have MBS capabilities and registering
selected SMF for an MB Session in NRF.
UPF:
\- MBS user plane function with southbound IP Multicast tunnelling/transport
interface and northbound interface with N6 tunnelling of MBS DL media streams.
\- On N3 interface, IP Multicast routing protocol for receiving IGMP/MLD
join/leave to the multicast transport IP address (\"LL MC\").
\- Support MBS operations on the N4 interface for MB Session setup and
release.
\- For 5GC Individual MBS traffic delivery, the (PSA-)UPF is requested by SMF
to forward MBS data stream onto PDU Session and to join or leave the MC tree
of the (MB-)UPF source host.
PCF:
\- MBS control function with 5G QoS Profiles for MB Sessions.
GCS Server:
\- Support for using the NEF/MBSF API. The API should be largely equivalent as
the eMBMS BM-SC API, but with some 5G enhancements.
N6:
\- Support for N6 tunnelling for AF to UPF transmission of DL MBS media.
Support for N6 IP Multicast in the un-tunnelled ditto.
## 6.3 Solution #3: Integrated Multicast and Unicast Transport
### 6.3.1 Functional Description
#### 6.3.1.1 System Architecture
This solution addresses Key Issue 1 and Key Issue 3 and proposes a system
architecture that reuses as much as possible the system architecture and
procedures of current 5GS unicast system architecture. The architecture
functional entities are described in clause A.1 \"5G MBS system architecture
based on unicast 5GC\". This solution also addresses some aspects of Key Issue
4.
For clarity, an MB-SMF that handles the multicast distribution session and an
SMF that handles the PDU session of a UE in the multicast session are depicted
separately. An MB-UPF controlled by the MB-SMF and an UPF controlled by the
SMF are also depicted separately. In addition, an MB-PCF that provides policy
control for the MB-SMF and an PCF that provides policy control for the SMF are
depicted separately.
#### 6.3.1.2 Multicast Session Context and Multicast flow characteristics
The proposed multicast communication service session management is an
extension of the existing solution for IPTV in TS 23.316 [7].
The Multicast Session context is identified by a Multicast Session context ID
and is used to represent information about the group of UEs receiving
Multicast flows with the same Multicast Session context ID. Multicast flows
represents QoS flows within a Multicast Session context.
In the case of IP PDU session type, the Multicast session context ID
represents one IP multicast group address (i.e. any source multicast or source
specific multicast). The packet filters for all Multicast flows within the
Multicast context shall have the same destination and, in the case of source
specific multicast, also source IP addresses. The default Multicast flow shall
allow for any source and destination ports and any protocols. An AF may
request the PCF/NEF to create policies for Multicast flows within the
Multicast Session context to meet the needs of application service flows that
use different ports and protocols.
NOTE: There may QOS flows unrelated to multicast data. The default QoS flow
may be used to transport multicast data and data unrelated to multicast.
Figure 6.3.1.2-1: Multicast Session Context, UE group and Multicast flow model
On N3 or MB-N3, the Multicast flows within one Multicast Session context use
the same shared tunnel.
At the NG-RAN, the Multicast flow identifier maps to radio bearer. If the QoS
characteristics of Multicast flows allow, NG-RAN can also map several
Multicast flows within a Multicast Session context to one radio bearer. The
characteristics of the radio bearer depends on RAN decision on whether to
deliver the Multicast flow content via unicast or point-to-multipoint (PTM)
transmission.
The 5G QoS model is extended to support Multicast flow. At Session Management
level for a particular UE the Multicast session context may exist in
association with one PDU session, and can be set-up during the PDU session
establishment or modification procedure. It may be modified at any point via
PDU session modification procedure.
NOTE: The Multicast session context is common to all UEs configured with the
Multicast session context, but the associated PDU session context is specific
to each UE.
The Multicast context ID and Multicast flow ID are assigned by the SMF. The
SMF provides the Multicast flow information (packet filters, etc.) to the UPF.
If point-to-point (PTP) tunnelling is used in N3, the SMF provides RAN with
Multicast context ID, Multicast flows and associated QoS information. The RAN
responds with downlink tunnel information for the Multicast context. The SMF
configures UPF with Multicast flows, associated QoS information and the
downlink tunnel information.
If point-to-multipoint tunnelling is used (MB-N3), the SMF provides the UPF
with MB-N3 tunnelling information. The SMF provides Multicast context ID,
Multicast flows and associated QoS information and MB-N3 tunnel information to
the RAN.
Point-to-point and point-to-multipoint tunnelling on N3/N9 have both their
merit. Point-to-point tunnelling provides more freedom in regard to the
deployment of UPF(s) and RAN (e.g. CU-UP) because the infrastructure
interconnecting these elements of 5G system does not need to support multicast
routing. On the other hand, point-to-multipoint tunnelling on N3/N9 can me
more resource efficient if the same content is delivered to a larger number of
RAN nodes. Noting that the user plane configuration is slightly different
depending on whether N3/N9 uses point-to-point (unicast) or point-to-
multipoint (multicast) tunnelling, it seems anyway beneficial at the cost of
additional standardization and implementation efforts to support both point-
to-point and point-to-multipoint tunnelling on N3/N9 by the specification
which allows to meet requirements of different deployments.
Figure 6.3.1.2-2 depicts the user plane path for a Multicast flow.
Figure 6.3.1.2-2: Multicast context / multicast flow user plane model
When multicast transport is established, there is no need for unicast
transport from the AF. In AS, when RAN decides to switch to PTM transmission,
the DRB previously allocated to the QoS Flow is not used anymore.
An UPF, based on configuration received from SMF, identifies a packet as
belonging to a Multicast flow, in which case it delivers it to one or multiple
RAN nodes via a shared tunnel identified by a shared TEID associated with the
Multicast session context to which the Multicast flow belongs to.
The AN delivers download data for the Multicast flow via PTM or PTP over the
air.
Each Multicast session context is managed by one MB-SMF that may be different
from the SMF controlling the PDU session of a user within the multicast group.
The identification of the MB-SMF handling Multicast session is stored in the
UDR as part of multicast group context information.
User plane establishment for a multicast group between the RAN node and the
ingress node is not required each time a user of the RAN node is added to a
multicast group. The user plane between the ingress node and the RAN node only
needs to be added when the first users served by the RAN node joins the
multicast group (of a user within the multiplex group is handed over to the
RAN node). The user plane between the ingress node and the RAN node only needs
to be terminated when the last users served by the RAN node leaves the
multicast group, terminates the PDU session, or is handed over to another RAN
node.
For each specific UE, based on operator policy the SMF may configure the
associated unicast PDU session information, which can be used to transport the
multicast data to the UE. The SMF generates the unicast QoS flow(s) matching
the multicast flow(s) for unicast fall-back when the UE requests to join the
multicast group. This unicast QoS flow(s) within the unicast PDU Session will
be used e.g. in the case of mobility to NG RAN node not supporting 5G MBS, or
when a UE does not support receiving multicast data over the radio according
to 5MBS. Such unicast QoS flow(s) could be the dedicated QoS flow(s). The
unicast QoS flows is not assumed to be used when NG RAN and UE support 5G MBS;
to avoid a resource reservation for those unicast QoS flows, the association
between multicast QoS flows and the corresponding unicast QoS flows is
indicated towards the RAN.
NOTE: RAN coordination may be required to verify the proposed solution for not
using the above unicast QoS Flows when NG RAN and UE support 5G MBS, and for
reserve resource when they are used.
### 6.3.2 Procedures
#### 6.3.2.1 Multicast context and Multicast flow setup/modification via PDU
Session Modification procedure
The Multicast context and Multicast flow setup/modification uses an enhanced
PDU session modification procedure for unicast traffic defined in TS 23.502
[8].
Figure 6.3.2.1-1: PDU Session modification for multicast
1\. The content provider may send a request to register and reserve resources
for a multicast group to the NEF and communicate the related multicast address
as detailed in clause 6.3.2.2.2.
The content provider may invoke the services provided by the NEF to provision
the multicast information. The multicast information is used to identify (e.g.
IP Address of multicast data) and reserve resources for the multicast. The NEF
selects MB-SMF controlling an MB-UPF serving as ingress point for the
multicast data and creates a multicast context and stores related information
including the SMF ID in the UDR. The MB-SMF may request the MB-UPF to allocate
an IP address and Port for ingress multicast traffic, which is then provided
to the content provider via NEF.
NOTE 1: The request to reserve resources for the corresponding multicast
session is optional and can be replaced by configured data based on commercial
agreements. If IP multicast is used in the external network, the content
provider does not require information where to send the multicast data.
NOTE 2: SMF and MB-SMF can be identical.
2\. The UE registers in the PLMN (see clause 4.2.2.2 of TS 23.502 [8]) and
request the establishment of a PDU session (see clause 4.3.2.2 of TS 23.502
[8]). The UE also indicates its capability to receive multicast data over the
radio. The AMF obtains information from the UDM whether the UE can join
multicast sessions as part of the SMF Selection Subscription data. If so, for
direct discovery, the AMF selects an SMF capable of handling multicast
sessions based on locally configured data or a corresponding SMF capability
stored in the NRF and also indicates the UE\'s capability to receive multicast
data over the radio to the SMF.
3\. The content provider announces the availability of multicast using higher
layers (e.g. application layer). The announcement includes at least the
multicast address of a multicast group that UE can join.
4\. Alternative 1: user plane signalling (can also be used with a legacy UE
not supporting the capability to receive multicast data over the radio):
4a. The UE joins the multicast group.
4b. The reception of the join message triggers the UPF to notify the SMF. The
UPF can be optimized to send the notification only when the UE\'s status with
regard to the multicast group the UE has joined changes, i.e. when the UE
joins or leaves a group. The SMF initiates PDU session modification procedure
upon the reception of the notification from the UPF.
5\. Alternative 2: control plane signalling:
5a. The UE sends the PDU Session Establishment/Modification Request either
upon a request from higher layers or upon a detection by lower layers of UE
joining a multicast group (i.e. detection of IGMP or MLR and detection of the
change of content of these messages). The PDU Session Modification Request
shall include information about multicast group, which UE wants to join, such
as multicast addresses listed in the IGMP and MLR messages. This information
is needed for configuration of the UPF with appropriate packet filters.
5b. The AMF invokes Nsmf_PDUSession_UpdateSMContext (SM Context ID, N1 SM
container (PDU Session Modification Request with the multicast information)).
6\. The SMF may interact with the PCF to check whether the UE is authorized to
join the multicast session as described in Figure 6.3.2.2.5-1.
7\. If SMF has no information about the multicast context for the indicated
multicast group, SMF checks at the UDR whether a multicast context for the
multicast group (address) exists in the system. If the multicast context for
the multicast group does not exist, then SMF creates it when the first UE
joins the multicast group, stores the multicast context including itself as
multicast controlling SMF in the UDR, and configures the UPF to handle the
multicast data distribution (SMF and MB-SMF, and UPF and MB-UPF in this flow
are then identical). If it is the first UE joining the multicast group, the
MB-UPF may also have to join the multicast tree towards the content provider;
the MB-SMF should request the MB-UPF to join the multicast tree when
configuring the MB-UPF, see e.g. Step 15 and 26. If a multicast context
already exists in the UDR, the SMF retrieves the related information,
including information related to MB-SMF controlling the multicast ingress
point.
8-9. If SMF has no information about the multicast context for the indicated
multicast group, SMF interacts with MB SMF to retrieve QoS information of the
multicast QoS flow(s).
If the UE supports the reception of multicast data and RAN supports MBS, steps
10 to 23 apply.
10\. SMF requests the AMF to transfer a message to the RAN node using the
Namf_N1N2MessageTransfer service (N2 SM information (PDU Session ID, Multicast
Context ID, MB-SMF ID, multicast QoS flow information), N1 SM container (PDU
Session Modification Command (PDU Session ID, multicast information (Multicast
Context ID, multicast QoS flow information, multicast address)) to:
\- create a multicast context in the RAN, if it does not exist already; and
\- inform about the relation between the multicast context and the UE\'s PDU
session.
Based on operator policy, if the SMF is configured to prepare for unicast
fall-back, the SMF maps the received QoS information of the multicast QoS flow
into unicast QoS flow information of the PDU Session, and includes the
information of the unicast QoS flows and the information about the association
between those unicast QoS flows and the multicast QoS flows in the N2 SM
information. If dedicated unicast QoS flows are required, the information
includes the one about those dedicated unicast QoS flows. SMF also includes
information about those unicast QoS flows in the N1 SM container.
11\. The N2 session modification request is sent to the RAN. The request is
sent in the UE context using the PDU Session Resource Modify Request message
enhanced with multicast related information, which includes a multicast group
identity (e.g. multicast address), Multicast Session context ID, and multicast
flow information such as multicast QoS Flow ID and associating QoS
information. The RAN uses the multicast group identity to determine that the
session modification procedures corresponds to one multicast group. In other
words, the RAN learns what UEs are receiving the same multicast data from the
multicast group identity. When the RAN receives a session modification request
for previously unknown multicast group identity, the RAN configures resources
to serve this multicast group.
12\. The N1 SM container (PDU Session Modification Command) is provided to the
UE.
13\. The RAN performs the necessary access network resource modification such
as configuration of PTP or PTM bearers. RAN node checks whether the user plane
for the multicast group/context distribution is already established towards
the RAN node. If RAN supports MBS, RAN configures the UE for receiving the
multicast data via multicast session.
NOTE 3: The details of access network resource modification should be studied
in the RAN WGs.
If RAN supports MBS, and if no user plane for multicast group distribution is
established towards the RAN node, steps 14 to 18 are executed.
14\. RAN nodes selects the AMF to reach MB-SMF and signals a request towards
AMF [MB-SMF ID, Multicast context/group ID]. If the RAN node is configured to
use a unicast transport for multicast distribution sessions, it allocates a
downlink tunnel ID (an IP address and a GTP-U TEID) for the reception of the
multicast distribution session and indicates the downlink tunnel information
in the request.
15\. AMF forwards the request towards the MB-SMF
16\. For unicast transport of the multicast distribution session, MB-SMF
configures MB-UPF to transmit the multicast distribution session towards RAN
(using the received IP address and a GTP-U TEID).
17\. MB-SMF sends a multicast distribution session response to AMF. For
multicast transport of the multicast distribution, it indicates in the
downlink tunnel information the transport multicast address for the multicast
session.
18\. AMF forwards multicast distribution session response to RAN node.
19\. The RAN sends the session modification response, which does not include
the unicast tunnel information.
20\. The AMF transfers the session modification response received in step 18
to the SMF. The SMF determines that the shared tunnel is used for multicast
packet transferring and the interaction with UPF is not needed.
21\. MB-UPF receives multicast PDUs.
22\. MB-UPF sends multicast PDUs in the N3/N9 tunnel associated to the
multicast distribution session to the RAN. There is only one tunnel per
multicast distribution session and RAN node, i.e. all associated PDU sessions
share this tunnel.
23\. The RAN selects PTM or PTP radio bearers to deliver the multicast PDUs to
UEs that joined the multicast group.
24\. The RAN performs the transmission using the selected bearer.
If the UE does not support the reception of multicast data and/or if RAN does
not support MBS, steps 25 to 38 apply
If user plane for multicast group distribution is not yet established towards
the SMF, steps 25 to 28 are executed.
25\. If unicast transport for the multicast data between UPF and MB-UPF is to
be used, SMF request UPF to allocate a downlink tunnel endpoint (an IP address
and a GTP-U TEID).
26\. SMF signals a request for the multicast session distribution towards MB-
SMF [Multicast context/group ID, downlink tunnel info].
27\. MB-SMF configures MB-UPF to transmit the multicast distribution session
towards UPF (using the received IP address and GTP-U TEID).
28\. MB-SMF sends a multicast distribution session response to SMF. For
multicast transport of the multicast distribution, it also indicates in the
downlink tunnel information the transport multicast address for the multicast
session.
NOTE 4: Steps 25 to 28 can also be triggered after the step 34, i.e. when the
SMF determines that RAN does not support MBS.
29\. SMF configures UPF to receive the multicast distribution session and
forward the data within unicast transport.
If SMF1 decides to establish dedicated QoS flow for the unicast transfer of
the multicast data, steps 30 to 34 apply.
30\. The SMF1 derives the QoS Rules for the unicast transfer of multicast data
based on QoS parameters for multicast transmission received in step 25. SMF1
maps the multicast QFI to a unicast QFI of the PDU Session; other QoS
parameters of unicast QoS Rules are same as the one for multicast
transmission. The SMF1 requests the AMF to transfer a message to the RAN node
using the Namf_N1N2MessageTransfer service (N1 SM container (PDU Session
Modification Command (PDU Session ID, unicast QoS rule(s)).
31\. The N2 session modification request is sent to the RAN.
32\. The N1 SM container (PDU Session Modification Command) is provided to the
UE.
33\. The RAN sends the session modification response.
34\. The AMF transfers the session modification response received in step 30
to the SMF1 via the Nsmf_PDUSession_UpdateSMContext service.
35\. MB-UPF receives multicast PDUs.
36\. MB-UPF sends multicast PDUs in the N3/N9 tunnel associated to the
multicast distribution session to UPF. There is only one tunnel per multicast
distribution session and destination UPF, i.e. all associated PDU sessions
share this tunnel.
37\. UPF forwards the multicast data via unicast.
38\. The RAN forwards the multicast data via unicast.
#### 6.3.2.2 Multicast group configuration
##### 6.3.2.2.1 General
Configuration of a multicast group in the 5GC can occur:
\- when the first UE joins the multicast group;
\- based on static configuration;
\- Triggered by an AF request via the NEF.
At service layer, the MSF can manage an MBS service, and apply related NEF
procedures to configure a multicast group.
##### 6.3.2.2.2 Initial Multicast group configuration via NEF
Figure 6.3.2.2.2-1: Initial Multicast group configuration via NEF
1\. AF of content provider may register at NEF that it provides contents for a
multicast group (identified by multicast group ID which may be IP multicast
address). Multicast information may further include media type information
(e.g. audio, video...), QoS requirements, UE authorization information (e.g. a
GPSI or an External Group Id or a UE ID to identify UEs authorized to join the
multicast service), service area identifying the service scope, and start and
end time of MBS. The AF may also request the allocation of an ingress
transport address where to send tunnelled multicast data.
2\. NEF checks authorization of content provider. NEF selects MB-SMF as
ingress control node, possibly based on location area.
3,4. NEF requests storage of multicast session context at UDR and provides
multicast group ID and selected MB-SMF ID.
5\. NEF requests MB-SMF to reserve ingress resources for a multicast
distribution session and provides Multicast group ID. It also indicates if the
allocation of an ingress transport address is requested.
6\. The MB-SMF sends SM MBS Policy Association Request to MB-PCF with the
Multicast group ID, AF Identifier, and the QoS requirements.
7\. The MB-PCF registers at the BSF that it handles the multicast session. It
provides an identifier that the policy association is for multicast and the
multicast group ID, it own PCF ID and optionally its PCF set ID.
8\. The MB-PCF may query the UDR for policy input related to the multicast
session.
9\. The MB-PCF responds with SM MBS Policy Association Response with policies
for the Multicast group ID.
In addition, determines whether the request is authorized and notifies the NEF
if the request is not authorized.
If the request is authorized, the PCF derives the required QoS parameters
based on the information provided by the NEF and determines whether this QoS
is allowed (according to the PCF configuration for this AF), and notifies the
result to the MB-SMF. The PCF notifies the MB-SMF whether the transmission
resources corresponding to the QoS request are established or not.
If the request is not authorized, the required QoS is not allowed, or
transmission resources are not established, MB-SMF responds to the NEF in step
12 with a Result value indicating the failure cause, and NEF further notifies
AF in step 13.
10\. MB-SMF selects the MB-UPF and requests it to reserve user plane ingress
resources. If multicast transport of the multicast data towards RAN nodes is
to be used, the MB-SMF also request the MB-UPF to reserve for the outgoing
data a tunnel endpoint and the related identifiers (source IP address, source
specific multicast address and GTP Tunnel ID) and to forward data received at
the user plane ingress resource using that tunnel endpoint.
11\. If requested, MB-UPF selects an ingress address (IP address and port) and
a tunnel endpoint for the outgoing data and provides it to MB-SMF
12\. MB-SMF indicates the possibly allocated ingress address to the NEF. It
also indicates the success or failure of reserving transmission resources.
13\. The NEF indicates the possibly allocated ingress address to the AF.
##### 6.3.2.2.2a Updated Multicast group configuration via NEF
Figure 6.3.2.2.2a-1: Updated Multicast group configuration via NEF
1\. AF of content provider may provide to a NEF updated information about for
a multicast group (identified by multicast group ID which may be IP multicast
address). Multicast information may further include media type information
(e.g. audio, video...), QoS requirements, UE authorization information,
service area identifying the service scope, and start and end time of MBS. The
AF may also request the allocation of an ingress transport address where to
send tunnelled multicast data.
2\. NEF checks authorization of content provider.
3\. NEF uses the BSF Discovery service to discover the MB-PCF serving the
multicast group. It indicates that it searches a PCF handling a multicast
session and provides the multicast group ID.
4\. The BSF provides the stored PCF ID and optional PCF set ID for the
multicast group ID. If the BSF provides no result the NEF either stores
information related to the multicast session in the UDR or proceeds as for the
initial group configuration according to Figure 6.3.2.2.2-1, otherwise it
proceeds as shown in the present Figure 6.3.2.2.2a-1.
5\. NEF establishes a multicast policy Association to a MB-PCF selected using
the PCF ID and PCF Set ID received in step4 and provides updates for the
multicast policy input as received from the AF. The NEF provides Multicast
group ID, and may provide AF Identifier, and updates QoS requirements.
6\. The MB-PCF replies to the NEF and indicates whether the received policy
input was accepted
8\. Based on the input received in step 5, the MB-PCF may provide updated
policy rules to the MB-SMF. The MB-SMF stores and enforces those updated
policies. It derives QoS rules for the multicast session and stores them for
subsequent inquiries by SMFs.
9\. The MB-SMF may provide updated configuration to the MB-UPF based on the
updated policy rules.
##### 6.3.2.2.3 Example of AF use of Multicast group configuration via NEF in
combination with SIP signalling
Figure 6.3.2.2.3-1: Use of MBS Transport activation via NEF and UE
configuration via SIP
1\. A SIP Invite (e.g. to join a conference) by a UE may trigger the AF to
perform a Multicast group configuration via NEF. An AF may also receive
similar SIP Invites by other UEs after it has configured the multicast group
in step 2.
2\. If a related multicast group is not yet configured, the AF initiates MBS
Multicast group configuration as described in clause 6.3.2.2.2.
3\. The AF includes in the SIP Invite response the multicast IP address
information allocated to the multicast group.
4\. The UE joins the Multicast group by initiating PDU session
establishment/modification procedure including the multicast IP address
information as described in clause 6.3.2.1.
##### 6.3.2.2.4 Example of mission critical service activation via MSF and MSF
interaction with MBS transport.
Figure 6.3.2.2.4-1 shows an example of MSF (service layer) and MBS transport
interaction to activate mission critical services as defined in TS 23.280 [14]
and TS 24.379 [15], and AF/MSF interaction when an AF establishes an MBS
service session via MSF, and configures UE e.g. via SIP signalling as defined
in TS 24.379 [15].
NOTE: AF and UE may interact using different application layer protocols.
MB2 interface procedures as defined in TS 23.468 [5] are used in this example;
using unchanged MB2 interface procedures and signalling between UE and AF
enables a smooth migration of mission critical services from LTE to 5MBS and
if MSF-C/MSF-U and BMSC are collocated even allows the same mission critical
sessions to use both LTE MBMS and 5MBS. TMGIs are used in the MB2 interface
and the mission critical signalling between AF and UE as identifier of the
multicast session. However, the in-band IGMP/MLR Join used in Alternative 1 of
Figure 6.3.2.1-1 uses IP multicast addresses as identifier of the multicast
session; to allow those different identifier formats to coexist, the MBMS
service identifier within the TMGI (see TS 23.003 [16]) is mapped in a
standardized way to a source specific IP multicast address, and MCC and MNC
are mapped to the source IP address.
Figure 6.3.2.2.4-1: Use of MBS service activation via MSF and MSF interaction
with MBS transport
1\. A UE is establishing or invited to a mission critical session (e.g. a
MCPTT session) using procedures in TS 23.280 [14] and TS 24.379 [15] (e.g. via
a SIP Invite to join a conference) This may trigger the AF to perform a
Multicast group configuration via NEF. An AF may also add other UEs to a
mission critical session after it has configured the multicast group.
If the AF decides to configure a related multicast group, steps 2 to 10 apply.
2-4. The AF may request the allocation of TMGIs via dedicated procedures or
include the request for TMGI allocation in step 5. The MSF-C is allocating
TMGIs and related expiry times and also terminates MBS services upon time
expiry.
5\. the AF sends Activate MBMS Request (TMGI, service area, optional: media
information (FEC/ROHC) , start time) to MSF-C.
6\. The MSF-C maps the TMGI to a source specific IP multicast address and
related source IP address and uses them in step 7. The MSF-C also allocates a
flow ID for the service area received in step 5.
7\. The MSF-C initiates MBS Multicast group configuration as described in
clause 6.3.2.2.2. It handles the service area as described for the location
area in solution 21.
8\. If the MSF-C decides to insert an MSF-U for media processing, the MSF-C
configures the MSF-U to handle the MBS session and provides the address
information received in step 7 as destination address and the media
information received in step 5.
9\. The MSF-U allocates a transport address to receive the multicast data and
reserves resources for media processing (e.g. FEC, ROHC) if instructed by the
MSF-C.
10\. The MSF-C responds to AF with Activate MBMS Bearer Response (TMGI, if
MSF-U was inserted MSF-U transport address information and otherwise transport
address information received in step 7)
11\. The AF sends a bearer announcement to the UE (e.g. a SIP Message request
according to TS 24.379 [15]) and includes the TMGI.
12\. The UE maps the TMGI to a source specific IP multicast address.
13\. The UE joins the Multicast group by initiating PDU session
establishment/modification procedure including the multicast IP address
information as described in clause 6.3.2.1.
14.-17. Multicast data are transmitted from the AF to the UE. If configured
accordingly, the MSF-U performs FEC and/or ROHC related processing of the
data.
##### 6.3.2.2.5 UE authorization check
Figure 6.3.2.2.5-1: UE authorization check
1\. Steps 1 to 4 in Figure 6.3.2.2.2-1 apply. In step 1 the AF may provide UE
authorization information (e.g. a GPSI or an External Group Id or a UE ID to
identify UEs authorized to join the multicast service). Alternatively, the AF
may request to be contacted for authorization check when a UE joins.
2\. If the AF provided authorization information, the NEF maps the UE
authorization information (e.g. a GPSI or an External Group Id or a UE ID to
identify UEs authorized to join the multicast service) into SUPIs or internal
group IDs and stores information about UEs allowed to join the multicast group
in the UDR. If the AF requested to be contacted for authorization check when a
UE joins, the NEF stores this info and an NEF contact point in the UDR. This
may be combined with step 3 in Figure 6.3.2.2.2-1 if the multicast session
context is used to store the information.
NOTE 1: Details of the UDR storage format will be determined during the
normative work.
NOTE 2: Steps 1 and 2 can be omitted if UE authorization information for
multicast sessions is configured in the UDR.
3\. A UE requests to join a multicast group. Steps 4 or 5 in Figure 6.3.2.1-1
are executed.
4\. The SMF queries at the UDR whether the UE is authorized to join the
multicast session.
If the AF requested to be contacted for authorization check when a UE joins,
steps 8 to 10 apply
5\. The SMF may request the NEF to request an authorization for the UE joining
from the AF, with the GPSI acquired in PDU session establishment procedure as
defined in clause 4.3.2 in TS 23.502 [8].
6\. The NEF sends an authorization request for the UE to join the multicast
session to the AF. The AF decides whether the UE is authorized to join the
multicast session and indicates that to the NEF.
7\. The NEF indicates the result to MB-SMF and MB-SMF returns the result to
SMF.
NOTE 3: If policy control for the UE joining authorization is required, the
PCF subscribes to notifications when a UE joins a multicast group and the SMF
sends a SM Policy Association Modification to PCF after step 3\. Steps 4 and
possibly 5 are then executed by the PCF. The PCF then indicates in the SM
Policy Association Modification Response to the SMF whether the UE is
authorized to join the multicast session.
#### 6.3.2.3 UE Leaves Multicast Service via PDU Session Modification
Procedure
Figure 6.3.2.3-1: PDU session modification for multicast leave
1\. The UE joins one or multiple multicast services as specified in clause
6.3.2.1.
At any time the UE can determine to leave the multicast service.
Alternative 1: user plane signalling:
2\. The UE sends the user plane message (e.g. the IGMP Leave) when the UE want
to leave one or multiple multicast services. The user plane message shall
include the related information about the multicast service to be leaving,
such as the multicast address.
3\. The reception of the leave message triggers the UPF to notify the SMF. The
SMF initiates PDU session modification procedure upon the reception of the
notification from the UPF.
Alternative 2: control plane signalling:
4\. The UE sends the PDU Session Modification Request when the UE wants to
leave one or multiple multicast services. The PDU Session Modification Request
shall include the related information about the multicast service to be
leaving, such as the multicast address.
5\. The AMF invokes Nsmf_PDUSession_UpdateSMContext (SM Context ID, N1 SM
container (PDU Session Modification Request with the associated multicast
service information (e.g. leave indication, multicast service identity,
etc.))).
If the UE is receiving multicast via unicast PDU session steps 6 to 14 apply:
If SMF and MB-SMF are different and the multicast data are not needed to be
distributed via unicast distribution within a PDU session to other UEs served
by UPF steps 6 to 8 apply, i.e. the shared tunnel between the UPF and MB-UPF
is not needed:
6\. The SMF sends a request to terminate the multicast distribution [Multicast
context/group ID] to MB-SMF.
7\. Based on the information received in step 6, MB-SMF updates the multicast
session context identified by the Multicast context/group ID and configures
the MB-UPF to no longer distribute multicast data towards UPF.
8\. The MB-SMF acknowledges the request to terminate the multicast
distribution to SMF as the response to step 6,
9\. SMF reconfigures UPF to terminate the distribution of multicast data via
the unicast PDU session and when steps 6 to 8 were executed also to release
the resources for the reception of the multicast data.
The SMF update the UE with the result of the leave handling. In addition if
dedicated QoS flow are used for the unicast transfer of the multicast data,
the SMF also update the RAN to remove the multicast QoS flow related
information, i.e. the mapped unicast QoS flow information, from the associated
unicast PDU Session.
10\. The SMF request the AMF to notify the RAN node to release the QoS flows
previously used to transport the multicast data using the
Namf_Communication_N1N2Message (N2 SM information) Transfer service. In the N2
SM information, it includes unicast QoS flow information.
11\. The session modification request is sent to the RAN. The N1 SM container
(PDU Session Modification Command) is provided to the UE.
12\. The RAN performs the necessary radio resource modification.
13\. The RAN sends the session modification response to AMF.
14\. The AMF transfers the session modification response received in step 13
to the SMF via the Nsmf_PDUSession_UpdateSMContext service
If the UE is receiving multicast via multicast distribution steps 15 to 25
apply:
15\. The SMF request the AMF to notify the RAN node that the UE left the
indicated multicast group using the Namf_Communication_N1N2Message (N1SM
container (PDU Session Modification Command (PDU Session ID , multicast
information ([Multicast Context ID], multicast address,)), N2 SM information)
Transfer service.
In the N2 SM information, it includes the multicast flow information
(multicast QoS Flow ID and associated QoS information), and multicast service
identity UE want to leave.
NOTE: If mapped unicast QoS flow information, association between the unicast
QoS flow and multicast QoS flow, and Unicast information (i.e. QoS rules for
Unicast flows) in the N1 SM container are added for multicast distribution,
then this information also needs to be deleted at this stage.
16\. The session modification request is sent to the RAN. The request include
a multicast service identity and multicast flow information. The N1 SM
container (PDU Session Modification Command) is provided to the UE.
The RAN use the multicast service identity to remove the UE from the multicast
session context. Also in the UE context the related multicast QoS flow and
associated unicast QoS flow information are removed.
17\. The RAN performs the necessary radio resource modification.
If the UE is the last one to leave the indicated multicast service, the RAN
release the associated shared downlink tunnel between RAN and MB-UPF and steps
18b to 22 apply.
18\. RAN node selects the AMF to reach MB-SMF and signals a request for the
Multicast user plane distribution release towards that AMF [MB-SMF ID,
Multicast context/group ID, downlink tunnel information].
19\. AMF forwards the request towards the MB-SMF
20\. For unicast transport of the multicast distribution session, MB-SMF
updates the multicast session context identified by the multicast context
identity and request the MB-UPF release the corresponding shard downlink
tunnel resource.
21\. SMF sends a multicast distribution session release response to AMF.
22\. AMF forwards multicast distribution session release response to RAN node
23\. For the multicast transport of the multicast distribution session, after
receive the multicast distribution release response, the RAN sends the leave
message (e.g. MLD/IGMP Leave ) to MB-UPF to stop the MBS data transmission
towards this RAN node.
24\. The RAN sends the session modification response to AMF.
25\. The AMF transfers the session modification response received in step 24
to the SMF via the Nsmf_PDUSession_UpdateSMContext service.
#### 6.3.2.4 Inter-RAN node MBS session Handover
For the Inter-RAN node MBS session Handover procedure, refer to Solution #27.
### 6.3.3 Impacts on services, entities and interfaces
SMF:
\- The SMF must handle enhanced PDU session procedures.
MB-SMF:
\- The MB-SMF must handle the multicast context
UPF:
\- If the UE joins multicast group via user plane, the UPF must support a new
capability to trigger a user plane event in a response to the reception of a
join message.
MB-UPF:
\- The MB-UPF should act as multicast capable router (but this functionality
was already introduced in TS 23.316 [7]).
RAN:
\- The RAN must support the PDU session procedures and store UEs\' association
with multicast group in a context as received from the SMF. The RAN should be
able to select PTP or PTM bearers that are used for multicast data
transmission to UEs.
N3:
\- A tunnel on this interface, which is configured when the first UE joins a
multicast group and PDU session modification is performed, should be used to
deliver multicast data from the UPF to the RAN.
NEF:
\- The NEF may interact with Content Provider reserve reception resources for
a multicast group and to receive QoS requirements, UE authorization
information, service area, and start and end time of MBS sessions. It may also
select the SMF handling multicast transmission. It stores information related
to the multicast session in the UDR.
UE:
\- It needs to indicate the MBS service information as part of the user plan
join message (e.g. IGMP join), or of the control plan message (e.g. PDU
Session modification request).
**UDR** :
\- Stores a multicast group context.
**MB-PCF** :
\- Handles policy control associations and policy authorization for multicast
groups.
**PCF** :
\- Determines whether a UE is authorized to join a multicast group.
**BSF** :
\- Stores PCF assigned to a multicast group ID.
## 6.4 Solution #4: Multicast operations with dedicated MBS network functions
### 6.4.1 Functional description
#### 6.4.1.1 General
This solution addresses KI#1 \"MBS session management\". This solution also
addresses some aspects of KI#3 and KI#4.
The architecture of this solution is based on architecture alternative 2 (see
Annex A, clause A.2).
This solution defines following procedures:
1\. The User Multicast Service Create / Update / Release are for multicast
service context create / update / release on UE, including user authentication
and authorization, service parameters provisioning (e.g. area restriction,
allowed TMGIs, session start time, etc.).
2\. The User Multicast Session Join / Leave are for transmission resource
reservation / release requested by user.
3\. The Multicast Session Start / Stop are for transmission resource
reservation / release controlled by network.
4\. The Multicast Session Shared Leg Release is for transmission resource
release controlled by RAN.
This solution is based on following assumptions:
1\. An ASP is identified by one or more IP multicast addresses and an ASP can
use one IP multicast address to deliver traffic of multiple content channels
represented by TMGIs distinguished by packet filters. This option benefits the
ASP to deliver traffic of multiple MB sessions towards the 5GS without
frequent maintenance of IP multicast routing. If this option is used, the UE
shall not use UP option for session join based on pre-configuration or
indication by ASP.
2\. User Multicast Service Create can be performed anywhere anytime to avoid
burst of signalling. If the MB session is not started, the 5GS rejects the
creation with provisioning of MB session information to the UE. The UE can
aggregate multiple requests for multiple MB sessions. The UE can use
application specific session join operation to join a MB session (e.g. for
non-IP multicast), the UE determines to use CP option based on the URSP.
3\. User Multicast Session Join can be triggered after User Multicast Service
Create or combined together for signalling efficiency. If the UE received
session start time or session start notification from 5GS, the UE initiates
the User Multicast Session Join after the session start time or to response
the session start notification.
4\. Establishment of PDU Session related to multicast session can be performed
before User Multicast Service Create or combined together.
5\. Multicast Session can have no related PDU Session, e.g. for IoT devices,
etc. (AMF enhancement is needed).
6\. User authentication can be done by 5GS, user authorization can be not
needed, e.g. targeted advertising to PLMN user, in this case, user can perform
Multicast Session Join without performing User Multicast Service Create.
7\. User authentication can be done by 5GS or both 5GS and AF, user
authorization can be done by 5GS or AF or both.
8\. User authentication and authorization can only be done by AF, AF assigned
UE ID without connection to SUPI/GPSI is needed, e.g. Mission Critical service
with group affiliation. (AMF enhancement is needed).
9\. User authentication and authorization can be not needed, e.g. public
safety application. (AMF enhancement is needed).
NOTE: Primary authentication procedure is used for user authentication by 5GS,
subscription data or service parameters can be used for user authorization by
5GS, user authentication and authorization by AF is out of scope.
10\. MBS USD may not include TMGIs, which is dynamically assigned during
Multicast Service Create / Update, e.g. ASPs frequently changes multicast
content channel.
11\. For non-IP multicast, N6 tunnel is needed, and one MB session for non-IP
multicast is represented by one N6 tunnel towards the MB-UPF/MBSU.
This solution addresses following aspects:
1\. Efficient multicast session resources reservation.
2\. Delivery method selection (individual / shared) per user.
3\. Support of QoS management per TMGI other than default QoS.
4\. User authentication and authorization as well as group user management.
5\. Support Mission Critical scenarios and public safety applications.
6\. Possibility of fine granularity for area restriction (i.e. based on TMGI).
7\. Possibility of dynamic assignment on operator parameters (e.g. TMGI,
frequency) in USD during user join.
#### 6.4.1.2 User plane
Besides supporting content delivery using IP unicast via PDU Session, the 5GS
network supports content delivery using IP multicast via following methods:
\- Shared delivery method: the IP multicast data are transmitted via a CN
tunnel between the MSA (i.e. Multicast Session Anchor, and in architecture
alternative 2, it is MB-UPF) and the RAN node (N3) or between the MSA and the
UPF (N9) shared by multiple UEs. The transport layer of the shared CN tunnel
may use IP multicast or IP unicast.
\- Individual delivery method: the IP multicast data are transmitted via a PDU
Session to a user.
Figure 6.4.1.2-1 shows the user plane for a multicast session of a multicast
communication service with a combination of shared delivery method and
individual delivery mode.
Figure 6.4.1.2-1: Overview of User plane for a multicast session
NOTE: The interface between MSA and UPF is N9. The DL forwarding tunnel may be
per PDU session or per MB session towards the UPF. If MB-UPF is collocated
with UPF, the DL forwarding tunnel between the MSA and the UPF is not needed.
The PTP and PTM are RAN specific methods for multicast data transmission.
A RAN node may serve multiple multicast communication services via individual
delivery method and shared delivery method.
If shared delivery method is used, the RAN node uses a shared N3tunnel with
one or more multicast QoS Flows shared by multiple UEs. If individual delivery
method is used, the RAN node serves PDU Session with one or more multicast QoS
Flows for a UE. Another option is combining multicast flows with unicast flows
into the same PDU session; with this option, RAN cannot distinguish whether
there is multicast flow in the PDU session.
Figure 6.4.1.2-2: QoS model for multicast session
#### 6.4.1.3 Multicast Service Context and Multicast Session Context
The Multicast Service Context is used to represent information about the
Anchor MB-SMF as well as the associated TMGIs, service requirements, and QoS
parameters, etc. Each multicast communication service may have multiple
content channel represented by TMGI. Each TMGI has a corresponding packet
filter and QoS profile. The Multicast Service Context is managed by UDR and
PCF depends of the type of information. The packet filter for a MBS session
also can be associated with, e.g. location, sub-group, etc.
The Multicast Session Context is used to represent information about the MSA
and (N3/N9) DL tunnel information of session legs as well as QFI and
associated TMGI within a session leg. The Multicast Session Context is managed
by MB-SMF.
A multicast session for a multicast communication service includes zero or
more session legs (inactive or active), which may be shared session leg or
individual session leg. A shared session leg is between a MSA and a UPF or
between a MSA and a RAN node. An individual session leg is between a MSA and a
UE (may be via a UPF).
Each session leg is represented by a DL tunnel information. For shared CN
(N3/N9) tunnel, one tunnel one MBS session is used.
Figure 6.4.1.3-1: Data model for multicast communication service
### 6.4.2 Procedures
#### 6.4.2.1 High-level procedures for multicast communication service
Figure 6.4.2.1-1 shows the high-level procedures for multicast communication
service. In this figure, the External Content Provider is legacy and only
supports xMB or MB2 interface.
Figure 6.4.2.1-1: High-level procedures for multicast communication service
\ Multicast communication service configuration:
1\. The External Content Provider performs TMGI management procedures over MB2
interface as described in clause 5.1.2.2 of TS 23.468 [5], or performs service
management procedures over xMB interface as described in clause 5.3 (except
5.3.6) of TS 26.348 [6]. The AF performs Service Provisioning procedures with
the NEF to provision the service requirement and get the associated TMGI. The
NEF shall invoking service operations of the MBSF for TMGI allocation and UDR
for service parameters storage accordingly, e.g. QoS requirements, area
restriction, protection information, etc. The UDR notifies service requirement
related to QoS and packet filters of TMGIs to the PCF.
2\. UE may interact with the application server of a Content Provider over
user plan for a multicast service. This can be used when the Content Provider
does not need service announcement as described in TS 23.246 [4].
3\. The External Content Provider performs MBMS Bearer management procedures
over MB2 interface as described in clause 5.1.2.3 and clause 5.1.2.4 of TS
23.468 [5], or performs session management procedures over xMB interface as
described in clause 5.4 of TS 26.348 [6] with MBSF, which interacts with
Anchor MB-SMF. The AF may perform Service Subscription procedures with the NEF
to subscribe event. The NEF shall support invoking service operations of the
MB-SMF for events subscription.
\ Multicast communication service operation:
4\. The UE, MB-SMF, or the AF initiates a User MBS Multicast operations with
AMF, MB-SMF, MB-UPF, PCF, UDR and MB-SMF. The MB-SMF interacts with the MB-UPF
to create and modify the QoS Flow for the multicast communication service
accordingly.
5\. If events have been subscribed by the External Content Provider or the
NEF, when condition of events are met, the MB-SMF triggers the MBSF to
performs MBMS Delivery Status Indication procedure with the External Content
Provider over MB2 interface as described in clause 5.1.2.5 of TS 23.468 [5],
or performs Service Notification procedure with the External Content Provider
over xMB interface as described in clause 5.3.6 of TS 26.348 [6], or MB-SMF
performs service notification with the NEF. The NEF shall support notifying
the event to the AF accordingly.
The following clauses use AF as an example in step 4 of Stage 2. For External
Content Provider, it can directly interact with MBSF without NEF involved.
#### 6.4.2.2 User Multicast Service Create
Figure 6.4.2.2-1 shows the procedure for User Multicast Service Create when
the UE decides to create a multicast service context for the user for, e.g.
authentication and authorization, service parameters provisioning, etc. The
procedure can combine with User Multicast Session Join.
If the PDU Session related to multicast service is involved, AMF can be
legacy.
Figure 6.4.2.2-1: User Multicast Service Create procedure
0\. [Conditional] The UE may have established a PDU Session for interaction
with the AF. During the PDU Session Establishment procedure, the AMF selects a
MB-SMF as a SMF for the PDU Session according to the DNN and/or S-NSSAI. The
MB-SMF does not allow IP multicast data transmission over the PDU Session
until the following steps are performed.
1\. (UP Option) After the PDU Session in step 0 has been established, the UE
sends an IGMP (IPv4) or MLD (IPv6) Join message over user plan of the PDU
session established in step 0. The UPF detects the IP data of IGMP or MLD, and
forwards the IP data to the MB-SMF according to the PDR installed in the UPF.
2\. (CP Option) UE to RAN: AN message (IP multicast address, N1 MB message
([Interest TMGIs / Interest Content Info], MB Container (IP multicast address,
List of Requested TMGI / Requested Content Info, [Interest TMGIs / Interest
Content Info], [UE ID], [PDU Session ID], [UE IP address]))).
The MB Container indicates User Multicast Service Create (e.g. enhanced PDU
Session Establishment / Modification Request).
If User Multicast Session Join is combined with User Multicast Service Create,
the Interest TMGI or Interest Content Info (if corresponding TMGI is not
known) is included.
The UE ID may be AF assigned (e.g. for Mission Critical scenarios), in this
case, if the RAN node and 5GS is not able to know the UE, the N1 MB message is
unprotected and PDU Session ID shall not be included (i.e. only shared
delivery method is allowed).
The MB Container may include the PDU Session ID to indicate individual
delivery method is acceptable. The PDU Session ID may be the same in step 0 or
may be a new one.
The UE may be provisioned with TMGIs by the multicast communication service
via application layer, UE Configuration Update method, or pre-configuration of
USD. If the UE does not know the TMGI, the Requested Content Info instead of
the List of Requested TMGI is included in the MB Container, same as the
Interest Content Info. The List of Requested TMGI / Requested Content Info may
be empty, in this case, the AF or 5GS decides the List of Allowed TMGI for the
user.
3\. RAN to AMF: N2 message (IP multicast address, [MB-SMF ID], N1 MB message).
If the RAN node is legacy, the extension on N2 interface does not exist, i.e.
the IP multicast address and MB-SMF ID are not included.
If MB-SMF ID associated with the multicast session corresponding to the IP
multicast address is stored previously, it is included.
The AMF selects a MB-SMF, e.g. based on local policy, subscription data, SMF
ID related to the PDU session ID, MB-SMF ID received in N2 message, DNN and/or
S-NSSAI, or UE location, etc. If AMF is not enhanced, UE can use a PDU Session
ID to trigger normal SMF selection procedure in AMF.
4\. AMF to MB-SMF: (MB/PDU)Session_CreateContext Request ([SUPI], AMF ID, UE
location, [Interest TMGIs / Interest Content Info], MB Container). If AMF is
legacy, the service operation is PDUSession_CreateContext Request with MB
Container.
The SUPI is included if the AMF knows the SUPI of the UE.
The UE location includes cell ID or TAI.
If PDU session ID is received, the MB-SMF determines whether it is a new PDU
session ID for the user or not.
5\. [Conditional] If the MB-SMF is not the Anchor MB-SMF for the IP multicast
address, the MB-SMF interacts with UDR to query the Multicast Service Context
including anchor MB-SMF related to the IP multicast address. If there\'s no
Anchor MB-SMF for the IP multicast address, the UDR sets the MB-SMF as the
Anchor MB-SMF and returns.
6\. [Conditional] The MB-SMF may invokes Nudm_SDM_Get service operator to
authorize the user for the multicast session based on subscription, or the MB-
SMF may notify the AF via NEF of user multicast service create based on the
event subscription. If Requested Content Info, Interest Content Info, or AF
assigned UE ID are received, they are also included in the notification to the
AF. If UE ID is not received and user authorization is needed for the
multicast communication service, the MB-SMF shall return error. If the group
member authorization is performed by the AF, the MB-SMF waits for the
authorization result after sending the session create event notification, and
the AF informs the MB-SMF whether it allows the user to create the session or
not after receiving the session create event notification.
If the Requested Content Info / Interest Content Info is received (CP option)
or the AF interacts with the UE over application layer for getting the
Requested Content Info / Interest Content Info (UP option), and TMGIs
corresponding to the Requested Content Info / Interest Content Info are not
assigned, the AF requests the MBSF to allocate TMGIs based on the Requested
Content Info / Interest Content Info. The AF informs the MB-SMF for the user
with the List of Allowed TMGI and/or Interest TMGIs, or the MB-SMF determines
the List of Allowed TMGI based on the List of Requested TMGI.
7\. [Conditional] MB-SMF to Anchor MB-SMF: MBSession_CreateContext Request
(AMF ID, UE location, List of Allowed TMGI, [N9 DL Tunnel Info], [SUPI], [PDU
Session ID], [Interest TMGIs], MB Container).
If Anchor MB-SMF is different from the MB-SMF, this step is performed,
otherwise the MB-SMF is the Anchor MB-SMF of the IP multicast address.
If the PDU Session ID is a new one, the MB-SMF selects a UPF for the PDU
Session. As an alternative, the N9 DL Tunnel Info may be included and used for
delivering the IP multicast data from MSA to the selected UPF or the UPF in
step 0. The N9 DL Tunnel Info is per MB session.
8\. The (Anchor) MB-SMF retrieves service parameters related to the List of
Allowed TMGI from the UDR, e.g. area restriction, session start time, re-
authentication and authorization interval, etc.
The (Anchor) MB-SMF checks the area restriction and session start time
according to the Interest TMGIs, which should be included in the List of
Allowed TMGI.
9\. [Conditional] MB-SMF to PCF: MBPolicy_Association (TMGI).
If the Interest TMGIs is received and default QoS is not used, the MB-SMF
interacts with PCF to get the MB QoS parameters with packet filters
information corresponding to the Interest TMGIs.
10\. [Conditional] If Interest TMGIs is received, the Anchor MB-SMF selects
delivery method for the user based on, e.g. whether N9 DL Tunnel Info is
received, currently used method of the user, multicast capability of the RAN
node, service requirements, number of users, or number of users in a location
area, etc. If N9 DL Tunnel Info is not received, individual delivery method is
not able to be used for the user.
11\. [Conditional] If the Anchor MB-SMF does not know the MSA address for the
IP multicast address, the MB-SMF selects a MSA address based on, e.g. the UE
location, UE IP address, etc.
12\. [Conditional] Anchor MB-SMF to MB-SMF: MBSession_CreateContext Response
([MSA address], [N9 DL Tunnel Info).
If individual delivery method is selected, the MSA address is included.
Alternatively the N9 DL Tunnel Info per MB session may be included if not
included in step 7, and the transport layer may use IP multicast with this
alternative. In this case, the Anchor MB-SMF interacts with MB-UPF to
establish a session leg with the UPF using the N9 DL Tunnel Info, the MB-SMF
interacts with the UPF to setup FAR for forwarding the IP multicast data
received in the N9 DL Tunnel via the PDU Session to the UE. The UPF associates
the N9 DL Tunnel or the transport layer IP multicast address with the PDU
Session associated with the N4 link (multiple PDU Sessions may associate with
one N9 DL Tunnel if the N9 DL Tunnel Info is per MB session).
The Anchor MB-SMF may use the IP multicast address of the received MB traffic
as the MSA address and does not require the N9 Tunnel. In this alternative,
the MB traffic replication is partially offloaded and the UPF associates the
IP multicast address with the PDU Session associated with the N4 link.
13\. MB-SMF to AMF: (MB/PDU)Session_CreateContext Response (success/failure,
[SUPI]). If AMF is legacy, the response is PDUSession_CreateContext Response.
If individual delivery method is selected, the MB-SMF activates the individual
delivery method, e.g. establish a PDU Session if new, or modify the PDU
Session if exists.
14\. Anchor MB-SMF to AMF: Namf_Communication_N1N2MessageTransfer (N1 MB
message, [N2 MB message]).
The Anchor MB-SMF generates a N1 MB message (List of Allowed TMGI, [PDU
Session ID], multicast parameters) to indicate the UE of parameters for the
multicast communication service, e.g. security information per TMGI, area
restriction per TMGI, session start time per TMGI, and other service
information.
The List of Allowed TMGI indicates the TMGIs that the UE is allowed to receive
service data.
If individual delivery method is selected, the PDU Session ID may be included.
The Anchor MB-SMF may generate a N2 MB message (Interest TMGIs, [MB QoS
profile], MB-SMF ID, MSA address) for shared CN tunnel reservation.
If the multicast session is activated, the MB QoS profile is included, which
corresponds to the Interest TMGIs.
The MB-SMF ID identifies the Anchor MB-SMF.
15\. The AMF forwards the N1 MB message to the UE. If the N2 MB message is
received, the AMF forwards the N2 MB message to the RAN node serving the UE,
in this case, RAN node performs AN specific procedure to reserve radio
resources.
16\. [Conditional] RAN to AMF: N2 MB message (MB-SMF ID, N2 MB Info). If AMF
is not enhanced, N2 MB Info will be forwarded to the MB-SMF selected in step 3
via PDUSession_Update Request, and the MB-SMF forwarded the N2 MB Info to the
Anchor MB-SMF via MBSession_UpdateContext Request.
18\. [Conditional] If AMF is legacy, the AMF invokes PDUSession_UpdateContext
with the MB-SMF and MB-SMF invokes MBSession_Update with Anchor MB-SMF, which
include N2 MB Info. If AMF is enhanced, the AMF invokes
MBSession_UpdateContext with Anchor MB-SMF including N2 MB Info.
19\. [Conditional] The Anchor MB-SMF may update the MB-UPF for the multicast
session according to the received N2 MB Info.
20\. [Conditional] If AMF is legacy, the Anchor MB-SMF response to the MB-SMF
and MB-SMF response to the AMF, otherwise the Anchor MB-SMF response to the
AMF directly.
#### 6.4.2.3 User Multicast Service Release
The User Multicast Service Release procedure is used when the UE decides to
release the multicast service context in UE and release corresponding
multicast session resources related to the user. The User Multicast Service
Release procedure is based on the User Multicast Service Create procedure with
following clarifications and differences:
\- In step 1a, it is an IGMP (IPv4) or MLD (IPv6) Leave message.
\- In step 2, the N1 MB message is User Multicast Service Release (e.g.
enhanced PDU Session Release / Modification). The N1 MB message does not
include the List of Requested TMGI / Requested Content Info / Interest TMGI /
Interest Content Info.
\- In step 6, the Anchor MB-SMF may notify the AF of user multicast service
release based on the event subscription. The Anchor MB-SMF removes the user
and associated List of Allowed TMGI.
\- Steps 8-11 are not performed.
\- In step 13, if individual delivery method is used, the PDU Session
Modification is performed. The PDU Session related to the multicast session
may be released.
#### 6.4.2.4 User Multicast Service Update
The User Multicast Service Update procedure is used for update multicast
service context on UE due to, e.g. requested TMGI update, interest TMGI change
(i.e. leave currently involved TMGIs and join to other TMGIs), etc. The User
Multicast Service Update procedure is based on the User Multicast Service
Create procedure with following clarifications and differences:
\- In step 2, the N1 MB message is User Multicast Service Update (e.g.
enhanced PDU Session Modification). The List of Requested TMGI / Requested
Content Info / Interest TMGIs / Interest Content Info may not be included.
\- In step 6, the MB-SMF may notify the AF of user multicast service update
based on the event subscription. The notification includes the List of
Requested TMGI / Requested Content Info / Interest Content Info if received.
The AF may query UE via application level for updated List of Requested TMGI /
Requested Content Info / Interest TMGIs / Interest Content Info. If List of
Requested TMGI / Requested Content Info is not received, then List of Allowed
TMGI is not changed. The MB-SMF then waits for instruction with user
information, e.g. List of Allowed TMGI and/or Interest TMGIs. The MB-SMF
checks whether new TMGI added in and/or old TMGI removed from the List of
Allowed TMGI of the user.
\- In step 7, if UP option is used, and the MB-SMF finds out that the UE has
send IGMP / MLD Join for the IP multicast address before, the MB-SMF invokes
MBSession_Update instead of MBSession_Create to the Anchor MB-SMF.
\- In step 13, PDU Session Modification is performed if needed.
\- In step 14, new List of Allowed TMGI may be sent to the UE. The Anchor MB-
SMF may additionally include a command of delivery method change in the N1 MB
message. The UE may wait for a while to switch from individual delivery method
to shared delivery method when receiving the command of method change.
#### 6.4.2.5 User Multicast Session Join via AN
Figure 6.4.2.5-1 shows the procedure for User Multicast Session Join when the
UE interests to receiving multicast data for a specific TMGI while the gNB has
not transmitted the multicast session data. The UE triggers the procedure when
the session will start soon or session has started, or triggered by session
start procedure. Individual delivery method cannot be selected in this
procedure.
The procedure needs RAN node and AMF to be enhanced.
Figure 6.4.2.5-1: User Multicast Session Join via AN
1\. UE to RAN: AN message (TMGIs).
2\. RAN to AMF: N2 message ([MB-SMF ID], N2 MB Info (TMGIs)).
If MB-SMF ID associated with the multicast session corresponding to the TMGIs
is stored previously, it is included.
The AMF selects a MB-SMF, e.g. based on local policy, subscription data, MB-
SMF ID received in N2 message, or UE location, etc.
3\. AMF to MB-SMF: MBSession_UpdateContext Request (AMF ID, N2 MB Info
(TMGIs)).
4\. [Conditional] If the MB-SMF is not the Anchor MB-SMF for the TMGIs, the
MB-SMF interacts with UDR to query the anchor MB-SMF related to the TMGIs.
5\. [Conditional] MB-SMF to Anchor MB-SMF: MBSession_Update Request (AMF ID,
TMGIs).
If the Anchor MB-SMF is different from the MB-SMF, this step is performed.
6\. The Anchor MB-SMF retrieves service parameters related to the TMGIs from
the UDR, e.g. area restriction, session start time.
The Anchor MB-SMF checks the area restriction according to the TMGIs.
7\. [Conditional] Anchor MB-SMF to PCF: MBPolicy_Association (TMGIs).
If the multicast session will start soon or has started, and default QoS is
not used, the Anchor MB-SMF interacts with PCF to get the MB QoS parameters
corresponding to the TMGIs.
8\. [Conditional] Anchor MB-SMF to MB-SMF: MBSession_Update Response ().
9\. MB-SMF to AMF: MBSession_UpdateContext Response (success/failure).
10\. Anchor MB-SMF to AMF: Namf_Communication_N1N2MessageTransfer (N2 MB
message):
\- The Anchor MB-SMF generates a N2 MB message (TMGIs, MB QoS profile, MB-SMF
ID, MSA address).
\- The MB QoS profile corresponding to the TMGI.
\- The MB-SMF ID identifies the Anchor MB-SMF.
11\. The AMF forwards the N2 MB message to the RAN node serving the UE.
12\. RAN to AMF: N2 MB message (MB-SMF ID, N2 MB Info).
13\. AMF to Anchor MB-SMF: MBSession_UpdateContext Request (N2 MB Info).
14\. The Anchor MB-SMF updates the MB-UPF for the multicast session according
to the received N2 MB Info.
15\. Anchor MB-SMF to AMF: MBSession_UpdateContext Response (success/failure).
#### 6.4.2.6 User Multicast Session Join via CN
Figure 6.4.2.6-1 shows the procedure for User Multicast Session Join when the
UE interests to receiving multicast data of a specific set of TMGI while the
gNB has not transmitted the multicast session data or UE wants to change
interest TMGIs. The UE triggers the procedure when the session will start soon
or session has started, or triggered by Multicast Session Start procedure. The
UE decide to perform this procedure based on, e.g. cell support MBS cannot be
found, individual delivery method is preferred, etc. Individual delivery
method can be selected in this procedure.
The procedure can be performed with legacy RAN node, if PDU Session related to
multicast service is involved, AMF can be legacy.
Figure 6.4.2.6-1: User Multicast Session Join via CN
1\. UE to AMF: Service Request (N1 MB Container ([TMGIs]), [PDU Session ID]).
If this procedure is triggered by Multicast Session Start procedure as
described in clause 6.4.2.8, the TMGIs are not included.
If the multicast session has corresponding PDU Session, the PDU Session ID is
indicated in the To Be Activated PDU Sessions. If UE only support user join
via UP, the TMGIs is not included, which means steps 1-3 are normal Service
Request procedure.
2\. If PDU Session ID is included and AMF is legacy, the AMF selects the MB-
SMF according to the SMF ID related to the PDU Session, and invokes
PDUSession_UpdateContext Request (N1 MB Container, PDU Session ID) to the MB-
SMF. If the AMF is enhanced, the AMF selects the MB-SMF as described in step 3
of clause 6.4.2.2.
3\. [Conditional] If TMGIs are not received, and TMGIs cannot be determined
from IP multicast address, and PDU Session is indicated and has not been
activated, the MB-SMF continues Service Request to activate the PDU Session.
If session start command is not delivered, the MB-SMF notifies the AF of user
join with UE IP without TMGI, the AF may interacts with the UE over
application layer for getting the Interest TMGIs. The AF informs the Interest
TMGIs to the MB-SMF.
4\. [Conditional] MB-SMF to Anchor MB-SMF: MBSession_Update Request ([N9 DL
Tunnel Info], SUPI, AMF ID, PDU Session ID, UE location, TMGIs).
If Anchor MB-SMF is different from the MB-SMF, this step is performed. As an
alternative, the N9 DL Tunnel Info is included, which may be per MB session.
5\. The Anchor MB-SMF retrieves service parameters related to the TMGIs from
the UDR, e.g. area restriction, session start time, etc.
The Anchor MB-SMF checks the area restriction and session start time according
to the TMGIs.
6\. [Conditional] Anchor MB-SMF to PCF: MBPolicy_Association (TMGIs).
If default QoS is not used, the Anchor MB-SMF interacts with PCF to get the MB
QoS parameters corresponding to the TMGIs.
7\. If allowed by area restriction and session will start soon or has started,
the Anchor MB-SMF selects mode for the user based on, e.g. multicast
capability of the RAN node, current used method of the user, service
requirements, number of users, or number of users in a location area, etc.
8\. [Conditional] Anchor MB-SMF to MB-SMF: MBSession_Update Response ([MSA
address], [N9 DL Tunnel Info]).
If individual delivery method is selected, MSA address is include.
Alternatively the N9 DL Tunnel Info per MB session is included if not included
in step 4, and the transport layer may use IP multicast with this alternative.
The Anchor MB-SMF interacts with MB-UPF to establish a session leg with the
UPF using the N9 DL Tunnel Info, the MB-SMF interacts with the UPF to setup
FAR for forwarding the IP multicast data received in the N9 DL Tunnel via the
PDU Session to the UE. The UPF associates the N9 DL Tunnel or the transport
layer IP multicast address with the PDU Session associated with the N4 link
(multiple PDU Sessions may associate with one N9 DL Tunnel if the N9 DL Tunnel
Info is per MB session).
The Anchor MB-SMF may use the IP multicast address of the received MB traffic
as the MSA address and does not require the N9 Tunnel. In this alternative,
the MB traffic replication is partially offloaded and the UPF associates the
IP multicast address with the PDU Session associated with the N4 link.
9\. If individual delivery method is selected, the MB-SMF continues the
Service Request procedure if PDU Session is not activated, or performs PDU
Session Modification according to the MB QoS parameters if PDU Session is
activated. If shared delivery method is selected, step 9-15 in clause 6.4.2.5
are performed.
#### 6.4.2.7 User Multicast Session Leave
Figure 6.4.2.7-1 shows the procedure for User Multicast Session Leave when the
UE no longer interests to receiving multicast data of a specific TMGI when
individual delivery method is used. If shared delivery method is used, the UE
does not need to do anything for leaving.
The procedure can be performed with legacy RAN node and AMF.
Figure 6.4.2.7-1: User Multicast Session Leave
1\. If individual delivery method is used, the UE initiates RRC Release to
transit into idle state, or initiates PDU Session Modification / Release
procedure to de-activate the individual leg of the TMGI, e.g. including the
removed packet filters corresponding to a TMGI in the PDU Session Modification
message.
NOTE: When shared delivery method is used and an UE is in idle or RRC-INACTIVE
state (hence PTM is used over the radio), the UE can silently leave a MBS
session, i.e. stop receiving the MBS traffic of a MBS session without
notifying the network. If network does not use legacy paging for notifying the
multicast data transmission, the UE can stop monitoring for notification as
well. When UE becomes connected again, the UE can indicate the leave via NAS.
Editor\'s note: It depends on RAN decisions whether the UE can receive
multicast data in RRC-INACTIVE state or paging of RRC-INACTIVE UEs is required
before multicast data transmission. If shared delivery method is used, how to
avoid considering the UE for multicast distribution after it silently left the
MBS session (e.g. how to avoid considering the UEÂ´s cell for multicast
distribution) is FFS.
2\. [Conditional] MB-SMF to Anchor MB-SMF: MBSession_Update Request (AMF ID,
Removed TMGIs).
3\. The Anchor MB-SMF interacts MB-UPF to stop delivering data to the UPF.
4\. [Conditional] Anchor MB-SMF to MB-SMF: MBSession_Update Response ().
#### 6.4.2.8 Multicast Session Start
Figure 6.4.2.8-1 shows the procedure for Multicast Session Start when AF does
not arrange the session start time in advance. If user authentication is
unhandled in 5GS for the group members, this procedure is not able to be
performed, i.e. in this case, session start time shall be provisioned to the
group members.
The procedure can be performed with legacy RAN node and AMF.
Figure 6.4.2.8-1: Multicast Session Start
1\. AF to NEF: Session Start (TMGI).
2\. NEF to Anchor MB-SMF: MBSession_Start (TMGI).
Following steps 3-6 are performed for each group member.
3\. Anchor MB-SMF to UDM: Nudm_UECM_Get (SUPI).
If an UE in the group member does not include a PDU Session ID in the User
Multicast Service Create procedure, the Anchor MB-SMF query the serving AMF
for the UE from the UDM.
4\. Anchor MB-SMF send a N1 message indicating session start to the UE. If the
UE has included a PDU Session ID in the User Multicast Service Create
procedure, the Anchor MB-SMF forwards the MBSession_Start to the MB-SMF
control the PSA of the PDU Session, and the MB-SMF sends a N1 message
indicating session start to the UE.
NOTE: The Anchor MB-SMF shall avoid signalling burst in step 6.
5\. If the UE is in idle, the AMF pages the UE. The AMF sends the Session
Start command to the UE.
6\. The UE initiates User Multicast Session Join procedure as described in
clause 6.4.2.5 or clause 6.4.2.6.
7-8. The Anchor MB-SMF responses to the NEF, and the NEF responses to the AF.
Another option is that the 5G network does not allow the UE to join a MBS
session before session start, e.g. according to the session start time
provisioned by AF, or whether session start request from AF is received, and
provides session start time to UEs. In this case, only steps 1, 2, 7, and 8
are performed. If the session start time is not provisioned, the Anchor MB-SMF
informs RAN nodes to broadcast session start notification as 4G MBMS does. If
the session start time is provisioned, the 5G network waits for the step 6 of
multicast session join initiated by UEs.
#### 6.4.2.9 Multicast Session Stop
Figure 6.4.2.9-1 shows the procedure for Multicast Session Stop when the
session stop time is arrived or AF instructs to stop.
The procedure can be performed with legacy RAN node and AMF.
Figure 6.4.2.9-1: Multicast Session Stop
1\. [Conditional] AF to NEF: Session Stop Request (TMGI).
2\. [Conditional] NEF to Anchor MB-SMF: Session Stop Request (TMGI).
The Anchor MB-SMF determines to stop the session based on AF instruction or
session stop time provisioned by the AF. Following steps 3-9 are performed for
each session leg.
3\. [Conditional] Anchor MB-SMF to MB-SMF: MBSession_Stop Request (SUPI,
TMGI).
If the session leg is individual session leg, the Anchor MB-SMF instructs the
MB-SMF control the UPF to de-activate the individual session leg.
4\. The MB-SMF performs PDU Session Modification procedure to de-activate the
PDU Session related to the TMGI.
5\. MB-SMF to Anchor MB-SMF: MBSession_Stop Response ().
6\. Anchor MB-SMF to AMF: N2 Message Transfer (Session stop (TMGI)).
If the session leg is shared session leg, the Anchor MB-SMF instructs the RAN
node via the AMF to release the corresponding resources.
7\. AMF to RAN node: Session stop (TMGI).
The RAN node releases the AN resources.
8\. RAN node to AMF: N2 Message (MB-SMF ID, [PDU Session ID], N2 MB Info
(TMGI)).
9\. If AMF is legacy, the AMF invokes PDUSession_UpdateContext (N2 MB Info) to
the MB-SMF and MB-SMF invokes MBSession_Update to the Anchor MB-SMF,
otherwise, the AMF invokes MBSession_UpdateContext (N2 MB Info).
10\. [Conditional] Anchor MB-SMF to NEF: MBSession_Stop Response (TMGI) or NEF
event notification (Session Stop (TMGI)).
If instructed by AF, then response is used, otherwise, Anchor MB-SMF may
notify the AF of session stop.
11\. [Conditional] NEF to AF: Session Stop Response (TMGI) or Session Stop
notification (TMGI).
#### 6.4.2.10 Multicast Session Shared Leg Release
Figure 6.4.2.10-1 shows the procedure for Shared Session Leg Release when RAN
node recognizes there\'s no user is interesting in a specific TMGI via the RAN
node.
The procedure needs RAN node and AMF to be enhanced.
Figure 6.4.2.9-1: Multicast Session Shared Leg Release procedure
1\. RAN performs accurate counting over the radio for a specific TMGI.
NOTE: This step needs coordination with RAN WG.
2\. RAN node to AMF: N2 message ([MB-SMF ID], Removed TMGI).
3\. AMF to MB-SMF: MBSession_Update Request ([MB-SMF ID], Removed TMGI).
The MB-SMF determines the Anchor MB-SMF based on the received MB-SMF ID or
information returned from UDR.
4\. [Conditional] MB-SMF to Anchor MB-SMF: MBSession_UpdateContext Request
(Removed TMGI).
5\. Anchor MB-SMF interacts with MB-UPF to remove the session leg from the
multicast session.
6\. [Conditional] Anchor MB-SMF to MB-SMF: MBSession_UpdateContext Response
().
7\. MB-SMF to AMF: MBSession_Update Response ().
7\. AMF to RAN node: Session stop (TMGI, MB-SMF ID).
### 6.4.3 Impacts on services, entities and interfaces
UE:
1\. Support multicast operation via control plane and user plane.
RAN node:
1\. Support shared CN tunnel reservation.
2\. Support mapping between TMGI and QoS Flow.
AMF:
1\. May support enhanced MB-SMF selection and signalling with MB-SMF (If PDU
Session is not involved).
MB-SMF:
1\. Manage Multicast Session Context per multicast communication service, and
possible per user.
2\. May support delivery method selection between \"individual\" and
\"shared\".
3\. Support interaction with RAN for multicast session data transmission
resource management and signalling with PCF / UE / UDR for multicast
operations.
4\. May support allocation of N9 DL Tunnel Info per MB session.
UDR:
1\. Manage Multicast Service Contexts including Anchor MB-SMF per service or
per TMGI, etc.
PCF:
1\. May support QoS parameters management per TMGI.
MBSF:
1\. Assign TMGIs.
2\. May support acting as proxy between legacy interface (i.e. MB2 and/or xMB)
and SBA interface.
MB-UPF:
1\. Support IP multicast data replication and transferring over DL N3/N9
tunnel controlled by MB-SMF.
UPF:
1\. May support allocation of N9 DL Tunnel Info per MB session.
2\. May support associating the N9 DL Tunnel Info or IP multicast address with
multiple PDU Sessions.
Nnef:
1\. Service operation, extended service parameter provisioning, and event
subscription for MBS AF.
Npcf:
1\. QoS parameters provisioning per TMGI.
Nudr:
1\. Service parameters provisioning per TMGI or per IP multicast address.
## 6.5 Solution #5: Broadcast Session Start
### 6.5.1 Functional description
This solution addresses key issues 1 and 5 and enhances the existing 5GC
architecture to provide broadcast communication services. The 5GC is
responsible to manage the broadcast session based on, e.g. broadcast
communication service information from AF. The baseline architecture 1 in
clause A.1 is assumed.
For the broadcast session the MSF-C in architecture 1 is required if the AF is
attached to 5GC via MB2 or xMB interface. MSF-C can be also be implemented
within the NEF. The presence of MSF-U in the architecture could be
conditional. If the goal is to provide User Services as defined in TS 26.346
[18] and offered to the AF via xMB then MSF-U is required. The 5GS could
provide more basic broadcast bearer services, for which the MSF-U may not be
required, to realize the broadcast communication services.
When the AF requests the 5GS to provide a broadcast communication service, the
AF provides to the MSF-C or NEF the broadcast communication service related
information, QoS requirement information, and broadcast service area which
could be a list of TAIs and a list of NR CGIs or an array of strings (e.g.
geographic area, civic addresses. The syntax is left to the business agreement
between content provider owning the AF and the operator), or a combination of
any of the above. The MSF-C shall determine a list of TAIs and a list of NR
CGIs from the broadcast service area information if an array of strings is
provided. The MSF-C or NEF discovers the involved MB-SMF using the NRF
services to support the requested service based on e.g. the service
identifier, DNN, slicing information, or MB-SMF capabilities. The MSF-C or NEF
uses the MB-SMF services to create the broadcast context for the broadcast
session start providing the service identifier, the list of TAIs, the list of
NR CGIs, QoS profiles etc. The involved MB-SMF creates broadcast policy
association and get authorization for the QoS profile from the PCF. The
involved MB-SMF queries the NRF for the AMF type instances to discover the
AMFs serving the TAIs from the list of TAIs. The query may include the TAIs
received from the MSF-C or the MB-SMF filters the result themselves and
selects the involved AMF(s). The MB-SMF invokes an AMF service (e.g. non-UE
specific N2 information transfer) to send a broadcast session resource setup
message including the TAIs to the involved NG RAN nodes. The MB-SMF subscribes
for non-UE specific N2 information notifications to receive notification about
success or failure of N2 operations. The AMF(s) select the involved NG RAN
nodes based on the received TAIs and initiates N2 procedure, BC session
resource setup, providing the NG RAN nodes with the TAIs, NR CGIs and QoS
flows. The MB-SMF selects the involved MB-UPF according to the service
identifier. The involved MB-UPF is configured with the IP multicast address
used by MSF-U, QoS Flows and, if unicast N3 tunnelling is used, DL TLN
information.
There is one MB-UPF targeting N6 for one broadcast service, and the MB-UPF is
responsible to distribute the broadcast traffic to multiple NG RANs within the
broadcast service area over N3 tunnels configured by the MB-SMF.
To receive the data of broadcast communication service, the UE is either
preconfigured with needed configuration (e.g. USD) for the UE to receive MB
service, or provisioned with the configuration of broadcast session which may
be performed using SIP signalling or methods described in TS 26.346 [18]
including announcement over a broadcast session for service announcements. If
the needed configuration is pre-configured, the UE does not need to interact
with 5GC and step 0 and 4 in clause 6.5.2 can be skipped.
### 6.5.2 Procedures
Figure 6.5.2-1: Broadcast Session Start procedure
0\. If a broadcast service is provided in association with a unicast service
from a service provider (e.g. GC AS) perspective, the UE reports NR CGI and
TAI to the AF.
1\. The AF requests the MSF (i.e. MSF-C) directly or via NEF to start one
specific broadcast communication service, providing assistance information,
MBS service identifier, a list of TAIs and a list of NR CGIs or a broadcast
area that is mapped to a list of TAIs and a list of NR CGIs by the MSF, QoS
requirements, DNN, NSSAI, etc.
2\. The BC Session ID and session parameters can be preconfigured based on
business agreement between content provider and the operator. Otherwise if MSF
is used, the MSF creates the broadcast service and selects broadcast session
parameters including BC Session ID, a global broadcast bearer identity (e.g.
TMGI) and, if User Services (e.g. File delivery) are requested by the AF, IP
multicast address(es) and other (e.g. FEC). If MSF is not used, the BC Session
ID could be allocated by NEF. The MSF or NEF initiates the start of broadcast
session.
NOTE: Other NF (e.g. MB-SMF) that may also be capable of allocating the BC
Session ID (e.g. in step 6), depending on the conclusion of KI#1.
3\. The MSF or NEF sends BC service start response to the AF informing the AF
about the determined broadcast session parameters. 4. If the UE is not
preconfigured with needed configuration (e.g. USD), the UE is provisioned with
the configuration of broadcast session which may be performed using SIP
signalling or methods described in TS 26.346 [18] including announcement over
a broadcast session for service announcements.
Editor\'s note: More information on radio-level broadcast session identifiers,
e.g. TMGIs, to be added in coordination with RAN.
5\. If the MSF is not preconfigured with the information about the involved
MB-SMF, the MSF uses the NRF services to discover the SMF based on provided
DNN, NSSAI, broadcast area and MB-SMF\'s capabilities stored in the NRF.
6\. The MSF requests Nsmf_BCSession_CreateBCContext (IP multicast address,
TAIs, NR CGIs, BC Session ID, S-NSSAI, [PCF ID]) service to create broadcast
context in the MB-SMF.
7\. The MB-SMF may establish BC Policy Association and get PCC rules for the
BC session which may be identified by multicast IP address.
8\. The MB-SMF invokes the discovery service of NRF and queries for AMF type
instances. The SMF may use TAI parameter for filtering.
9\. The NRF returns a search result with the AMF instances.
10\. Depending on the filtering criteria, the MB-SMF may further filter the
results and select the AMFs.
11\. The SMF uses the Namf_NonUEN2MessageTransfer (TAIs, N2InfoContainer)
service of the AMFs to transfer BC Session Resource Setup Request message to
the NG RAN nodes controlling the target cells where the broadcast
communication service should be provided.
If transport layer IP Multicast (i.e. multicast on N3) is used, the SMF
further allocates the DL tunnel information and includes the DL tunnel
information in Namf_NonUEN2MessageTransfer message.
12\. The MB-SMF subscribes for non-UE specific N2 information notifications to
receive notification about success or failure of N2 operations. A new
N2InformationClass may be created for broadcast related information.
13\. The AMF selects the involved NG RAN based on the TAIs.
14-15. The AMF sends BC Session Resource Setup Request (TAIs, NR CGIs, QoS
flows, a global broadcast bearer service identity (e.g. TMGI)) to the NG RAN
nodes. If the NG RAN accepts the request and if unicast tunnelling on N3 is
used, the NG RAN allocates the DL tunnel address information for the BC
session. The NG RAN then responds to the AMF.
If transport layer IP Multicast (i.e. multicast on N3) is used, the BC Session
Resource Setup Request includes the DL tunnel information. The NG RAN should
establish the DL tunnel by joining the IP Multicast (identified by the IP
multicast address and the IP address of the multicast source as described by
the DL tunnel information) to enable reception of broadcast communication
service data.
Editor\'s note: More information on possible radio-level announcement of
available broadcast service and related radio-level broadcast session
identifiers, e.g. TMGIs, to be added in coordination with RAN.
16\. The AMF notifies the SMF about N2 information including n2InfoContainer
carrying the BC Session Resource Setup Response.
17\. The MB-SMF establishes N4 session with the MB-UPF, including, if unicast
N3 is used, the DL tunnel information, QoS parameters. The MB-SMF indicates
that allocation of an ingress resources (i.e. ingress transport address and
port) is needed. The MB-UPF allocates the ingress resources. The multicast
data received at the ingress resources will be forward to the RAN in
corresponding QoS flows within the shared DL tunnel.
18\. The MB-SMF notifies the MSF-C about successful setup of broadcast session
resources. For User Services, the MSF-U is configured with the MB-UPF\'s
ingress resources (i.e. the ingress transport address and port).
19\. The MSF notifies to the AF the status of the broadcast communication
service. For Broadcast Bearer Services, the MSF-U is not used and the MSF
notifies the ingress transport address and port to the AF.
20\. For User Services, the data is delivered, e.g. using the user plane
procedures of xMB (TS 29.116 [23]), from the AF to the MSF (i.e. MSF-U) which
is configured for the User Service. In case the MSF-C and the MSF-U are not
collocated, PFCP is assumed to be used on the reference point between the
MSF-C and the MSF-U.
21\. For User Services, the MSF (i.e. MSF-U) sends User Service data to the
UPF(s) using the ingress transport address and port.
22\. For Broadcast Bearer Service, the AF sends broadcast service data using
the ingress transport address and port over N6 to the UPF.
23\. The MB-UPF forwards the received data in QoS flows of a shared N3 tunnels
according to the configuration received in step 17.
24\. The RAN transmit the multicast PDUs as a user payload of radio broadcast
bearer over the air.
### 6.5.3 Impacts on services, entities and interfaces
In order to support this solution, the involved network entities need to
support the following functionality.
MSF:
\- Receives the broadcast communication service information from AF, e.g.
service identifier, TAIs and NR CGIs or a service area (e.g. civic address or
geographic area) that can be mapped to TAIs and NR CGIs, DNN, NSSAI, and
service requirements.
\- Determines the broadcast area and the involved SMF for the target broadcast
service.
\- Selects broadcast session parameters including BC Session ID, a global
broadcast bearer service identity (e.g. TMGI) and, if User Services (e.g. File
delivery) are requested by the AF, may allocate IP multicast address(es) and
other (e.g. FEC).
PCF:
\- Determines the policy and QoS profile for the broadcast service.
\- Authorization management.
MB-SMF:
\- Receives the broadcast session information from the MSF, e.g. broadcast
session identifier (BC Session ID).
\- Establishes broadcast policy association to obtain QoS profile.
\- Determines the involved PSA UPF and other UPFs.
\- Determines the involved AMF(s).
\- Manage the N3/N9 tunnels for the broadcast service.
AMF:
\- Support the broadcast session information transfer between the SMF and the
NG RAN.
\- Determines the involved RAN nodes for the target broadcast communication
service based on TAIs.
MB-UPF:
\- The anchor UPF connects to broadcast service based DNN.
\- Distributes the broadcast traffic to the involved UPFs configured by SMF.
\- Enforce broadcast QoS rule.
\- Select the ingress resources (i.e. an ingress transport address and port).
NG RAN node:
\- Allocate the N3 tunnel address for the broadcast session.
\- Transmitting broadcast traffic with satisfying the QoS requirements.
## 6.6 Solution #6: Multicast service initiation
### 6.6.1 Functional description
This solution addresses Key Issue 1 and proposes a multicast service
initiation procedure based on the MBS reference architecture alternative 2
(see clause A.2).
When the AF requests the MBSF to provide a multicast service, the AF provides
the multicast service related information that may include service type,
target service area, target service UE group, QoS requirement information,
where the service type indicates which kinds of MBS services e.g. public
safety or V2X services, etc. and target service area indicate the area in
which the contents provider wants to provide service.
NOTE 1: Based on the service type, target service area etc., an appropriate
MBSF/MBSU can be selected.
The MBSF setup the MBS service session for the multicast service.
AF or MBSF announces the MBS services, which deliver the MBS service specific
parameters e.g. DNN info, MBS service session ID, target service UE group ID,
target service area, etc. to UEs. Then, the UE in MBS service area may join
the multicast service for the MBS service session via PDU session
establishment/modification procedure, the MB-SMF may verify the UE by its SM
subscription information and notify the UE\'s multicast joining request to the
MBSF.
NOTE 2: the PDU session used for joining is dedicated or supporting for MBS
services, which the MB-SMF selected e.g. by DNN info during PDU session
establishment controls. It is assumed that multiple MB-SMFs are deployed and
used for MBS services.
The MBSF requests the MB Session setup towards the MB-SMF(s) involved in the
MBS session, which may get authorization for the QoS profile from the PCF.
The MB-SMF sets up the MB Session based on the MBS service session ID, target
service UE group ID, etc. and associates with the PDU session. During the PDU
session establishment/modification procedure, the MB-SMF sets up the shared N3
tunnel between NG-RAN and MB-UPF if the UE is located within an MBS capable
RAN node and the UE obtains the radio resource information to receive the MBS
traffic. If the UE is served by a non-MBS capable RAN node, the UE may get the
multicast service traffic via individual delivery as a regular PDU session.
When an MB-SMF manages association of a MB Session and PDU session(s) of some
UEs, if the shared N3 tunnel is activated then the MB-SMF may deactivate or
release the associated PDU session(s) of the UEs per operator\'s policy.
### 6.6.2 Procedures
#### 6.6.2.1 MBS Session initiation procedure
Figure 6.6.2.1-1: MBS session initiation procedure for multicast service
The figure depicts MBS session initiation procedure for multicast service as
follows.
1\. Third party contents provider (or AF) requests MBS service(s) to an
appropriate MBSF (in case that AF is not in the trust domain, the MBSF is
selected via NEF) with service characteristics (e.g. service type, optional
target service area, target service UE group, etc.), where the service type
indicates which kinds of MBS services e.g. public safety or V2X services, etc.
and target service area indicate the area in which the contents provider wants
to provide service.
NOTE 1: Based on the service type, target service area etc., AF may select an
appropriate MBSF/MBSU.
2\. MBSF may check whether the AF is authorized to start the MBS service with
PCF.
3\. If the MBS service is authorized, an MBS service session is setup and its
information (e.g. MBS service session ID, address information of the MBSU,
etc.) is managed by the MBSF.
4\. The MBSF notifies the MBS service session information to the content
provider or AF.
5\. MBS service announcement can be delivered to UEs in the target service
area on application level, which includes the MBS service specific parameters
e.g. DNN, MBS service session ID, target service UE group ID, etc. by AF or
MBSF.
For UE joining the multicast group:
6\. If the UE belongs to target service UE group, the UE may join the
multicast group via control plane (i.e. PDU session establishment or
modification procedure, where an MB-SMF is selected during the PDU session
establishment procedure based on its DNN info, [if available MBS service
session ID], target service area, etc. which are obtained in step 5), which is
verified based on the UE SM subscription information. In addition, the SMF may
notify the MBSF of the UE joining in the multicast group.
NOTE 2: The PDU session for UE joining procedure is assumed as controlled by
MBS-capable SMF (i.e. MB-SMF), which can be achieved e.g. by DNN info etc.
obtained by MBS service announcement. For MB Session setup:
7\. MBSF requests an MB session setup to MB-SMF(s), which are selected based
on their coverage and the target service area.
8\. The MB-SMF may get service authorization including authorized QoS info
from PCF, which is authorized for the target service UE group.
9 - 10. The MB-SMF establishes a transport tunnel between MBSU and MB-UPF for
shared or individual delivery of the MBS data, and an MB session setup
notification is sent to MBSF along its delivery method.
NOTE 3: How the MBSF triggers the mode switch based on the delivery method
notified by MB-SMF at session establishment is addressed by KI#7 solutions
(i.e. Solution #24).
NOTE 4: Steps 9-10 may also follow the shared and/or individual tunnel setup
(i.e. step 12\~14) when MB-SMF determines that NG-RAN does not support MBS.
11\. If the UE has joined, the MB-SMF associates the PDU session with the
corresponding MB Session, based on the target service UE group, MBS service
session ID, etc.
In the case that shared N3 tunnel does not exist yet for the MBS service area:
12-14. For data transport of shared delivery, the MB-SMF establishes shared N3
tunnel with the NG-RAN(s) to the MB-UPF selected in the step 9 via the serving
AMF. NG-RAN decides delivery mode of the MBS data i.e. point-to-point delivery
or point-to-multipoint delivery e.g. based on the UE population sharing the
target service UE group ID, MBS service session ID, etc, which are sent from
the MB-SMF in the step 12. The remaining PDU session establishment or
modification procedure is similar as the one defined in TS 23.502 [8], with
the changes that the NG-RAN notifies the information on the RAN resources for
point-to multipoint mode to the UE via RRC signalling.
For data transport of individual delivery (e.g. for MBS traffic delivery
within a non-MBS capable RAN node), the MB-SMF establishes individual N3
tunnel with the NG-RAN to the MB-UPF selected in the step 9 via the serving
AMF. The remaining PDU session establishment or modification procedure follows
the one defined in TS 23.502 [8].
#### 6.6.2.2 MBS Session leave procedure
When UE is not using an MBS session anymore, UE notifies the network via the
MBS Session Leave procedure.
Figure 6.6.2.2-1: MBS session leave procedure for multicast service
1\. The UE has joined multicast service as specified in clause 6.6.2.1.
2\. The UE decides to leave the multicast service and sends the PDU Session
Modification Request which includes the information about the multicast
service to be leaving.
3\. The MB-SMF notifies the MBSF, the UE leave the multicast session. If the
UE is the last UE in this multicast session in the MB-SMF, the MB-SMF sends
MBS session release request to MBSF. If MBSF receives MBS session release
request, it requests the MBSU to release the tunnel between MBSU and MB-UPF.
NOTE 1: Subsequent UE joining procedure follows step 6\~14 in the clause
6.6.2.1.
4\. The MB-SMF initiates the PDU session modification procedure to release the
QoS flow of PDU session of UE corresponding to the MBS session which UE is
leaving.
5\. The MB-SMF initiates the MB session modification to NG-RAN. If the UE is
the last UE for the MB session, the MB-SMF sends MB session release request to
NG-RAN.
NOTE 2: Whether a separate message for releasing the MB Session can be
determined during the normative phase.
6\. The NG-RAN release the UE MBS context.
7\. The NG-RAN sends MB session modification response to MB-SMF. And if the UE
is the last UE for the MB session, the MB-SMF requests the MB-UPF to release
the tunnel for the MB session.
#### 6.6.2.3 MBS Session release procedure
The MBS Session release procedure is used to delete all the MBS session
context for media delivery of an multicast service.
Figure 6.6.2.3-1: MBS session release procedure for multicast service
1\. An multicast service is initiated and the UE has joined multicast service
as specified in clause 6.6.2.1.
2\. The Content provider/AF decides to terminate this multicast service. It
sends the MBS service release request to MBSF.
3\. The MBSF releases the MBS session and the tunnel between MBSU and MB-UPF,
and notifies the MBS session release to the Content provider/AF. Step 3 may
follow step 5.
4\. The MBSF requests the MB-SMF(s) the MB session release.
5\. The MB-SMF releases the MB session. Step 5 may follow step 9.
6\. The MB-SMF initiates the PDU session modification procedure to release the
QoS flow of PDU session of UE corresponding to the MBS session which UE has
joined.
7\. The MB-SMF initiates the MB session release to NG-RAN.
8\. The NG-RAN releases all the MBS context of this MB session.
9\. The NG-RAN sends MB session release response to MB-SMF, and the MB-SMF
releases the tunnel between MB-UPF and NG-RAN.
### 6.6.3 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to services, entities and
interfaces.
**MBSF:**
\- The MBSF generates and manages MBS service context and request an MB
session setup to the MB-SMF.
\- The MBSF controls the MBSU for user plane management, which is a media
anchor of MBS traffic in 5GS.
**MB-SMF** :
\- The MB-SMF setup the MB session, which is used for the transport of shared
delivery.
\- The MB-SMF manages the MB session context for shared delivery, and
associate & manages together the UE\'s PDU session context for individual
delivery.
\- The MB-SMF send the association information b/w shared delivery and
individual delivery to the NG-RAN.
**AMF** :
\- The AMF is enhanced to support MB session management b/w NG-RAN and MB-SMF.
**MB-UPF** :
\- It supports shared tunnel for shared delivery method.
**NG-RAN** :
\- It supports shared tunnel for shared delivery method.
\- The NG-RAN receives the **association** information from the MB-SMF and
stores it, which may identify the UEs to receive MBS data traffic via shared
delivery method.
\- The NG-RAN may decide RAN delivery mode for MBS data traffic from shared
delivery method i.e. PTP vs. PTM.
**N3** :
\- A shared tunnel on this interface is established for an MB session.
**UE** :
\- UE need to indicate its joining on the MBS service as part of the NAS
message (e.g. PDU Session establishment/modification request).
## 6.7 Solution #7: Local multicast service discovery and provisioning
### 6.7.1 Functional description
This solution addresses KI#6 \"Local MBS service\".
This solution proposes local MBS service discovery and provisioning
procedures. It is proposed to use NAS signalling or application level
interaction to provision local multicast service boundary information to the
UE, who is interested in the local multicast service. When the UE enters into
the multicast service boundary, it detects the broadcast signalling (i.e. SIB)
for local multicast service discovery. The architecture of this solution can
be based on the two architecture alternatives (see Annex A) or combined
network architecture alternatives.
### 6.7.2 Procedures
Figure 6.7.2-1 shows the procedure of local multicast service discovery and
provisioning for receiving multicast data:
Figure 6.7.2-1: Local multicast service discovery procedure
1\. The UE, who has interest in the local multicast service, may register to
the AF of the local MBS Content Provider and may get information for receiving
the local multicast service data from the Content Provider, e.g. application
layer security information, TMGI, service boundary (e.g. cell IDs, geo area
information), etc. If UE has obtained service boundary information at
application level from AF, step 2 to 3 can be skipped. Step 2 to 3 are needed
in case AF provides service boundary information to NEF and then deliver the
information to UE via NAS level signalling.
NOTE: Application level signalling is not specified.
2\. The AF may provide service parameters including service boundary (e.g.
cell IDs, geo area information) to NEF, the NEF may store the information in
the UDR (translation maybe needed).
3\. The UE may retrieve service parameters including service boundary at any
time anywhere in the PLMN via control plane, e.g. initiates User Multicast
Service Create procedure as described in solution 4. Or, the UDR may notify
the (MB-)SMF that subscribed event for multicast service context change of the
updated service parameters, the (MB-)SMF queries the UDM for each member of
the TMGI to get the serving AMF and notifies the UE of service boundary for
the TMGI, e.g. via Namf_Communication_N1N2MessageTransfer service operation.
Or, the UE may request service parameters update via control plane to get the
updated service boundary information, e.g. initiates User Multicast Service
Update procedure as described in solution 4.
4\. The UE starts to detect whether it is in the Service Boundary, e.g. based
on the TAI or cell ID received in the SIB1. If the UE does not entered into
the service boundary, the UE does not need to resolve SIB other.
5\. When the UE is in the local multicast service boundary, the UE starts to
discover the local multicast service based on SAI/TMGI detection, i.e. based
on SAI/TMGI received in SIB other.
6\. If the UE detects radio resource information for data transmission of the
local multicast service, it starts receiving the service data. If the UE does
not detects radio resource, the UE performs user multicast session join for
activate the data transmission via the RAN node, e.g. initiates User Multicast
Session Join procedure as described in Solution 4 specified in clause 6.4.
### 6.7.3 Impacts on services, entities and interfaces
UE:
\- Support multicast communication service detection triggered by service
boundary entering/leaving.
AF, NEF, PCF, AMF:
\- Support service boundary information configuration to 5GC and then to UE
## 6.8 Solution #8: Dynamic multicast/broadcast transmission
### 6.8.1 Functional Description
#### 6.8.1.1 General
This solution addresses KI#1, and compared with other solutions (e.g. Solution
#3) to KI#1, this solution mainly addresses the following aspects:
\- When and how to trigger the establishment of an MBS session?
The trigger may be based on network analysis result. The AF subscribes or
requests the network analytics information from the NWDAF as specified in TS
23.288 [9]. Based on the analytics information, e.g. Observed Service
Experience analytics defined in clause 6.4 of TS 23.288 [9], the AF
decides/updates multicast related service parameters. The AF may use service
specific parameter provision procedure as specified in TS 23.502 [8] to
provide multicast related service parameters, including the multicast
indication for different services/applications, to the PCF. Based on multicast
related service parameters, the PCF provides the multicast service related
policy in PCC rules to the SMF. Then the SMF decides when to establish an MBS
session for the services and UEs based on the multicast service related
policy. The following procedures for completion of the MBS session
establishment can refer to Solution #3.
#### 6.8.1.2 System Architecture
The architecture functional entities are described in clause A.1 \"5G MBS
system architecture based on unicast 5GC\". The functionalities of SMF/UPF in
Figure 6.8.2.1-1 are equal to the ones of SMF1/UPF1 respectively in Figure
6.3.2.1-1.
### 6.8.2 Procedures
#### 6.8.2.1 Dynamic multicast session setup/modification
Figure 6.8.2.1-1: multicast session/tunnel setup/modification
The key steps of the procedure for this solution are as follows:
1\. The step 1-3 specified in clause 6.3.2.1 are reused.
2\. The AF decides to update service parameters, including the multicast
indication for different services/ applications. For example, the AF may
subscribe or requests network analytics information to the NWDAF as specified
in TS 23.288 [9], e.g. Observed Service Experience defined in clause 6.4 in TS
23.288 [9], and based on the analytics information, the AF may decide to
update service parameters.
The AF provides update service parameters to the PCF (e.g. via the UDR as
specified in TS 23.502 [8] clause 4.15.6.7). The AF may further request UDR to
store the following information for the multicast service: UE number of
requesting the service as a threshold, the list of UE IDs (i.e. GPSIs), or UE
group ID for receiving multicast service, and other service information, such
as IP multicast address.
The AF can decide to subscribe or request network analytics information based
on local configuration, or triggered by e.g. event report from the NEF.
3\. The PCF provides to the SMF(s) the multicast service related policy based
on the service parameters, including multicast indication for specific service
(represented by Service Description).
4\. The step 6-34 specified in clause 6.3.2.1 is reused with the following
difference:
\- The SMF(s) initiates a PDU Session Modification procedure to include the
UE(s) listed in the list of UE IDs in multicast reception.
NOTE 1: This is not preventing other possible authorization methods.
\- The SMF(s) may configure the UPF(s) for not sending the data via unicast
PDU session any longer. It might be used for the case e.g. the external
network uses IP multicast.
NOTE 2: In application layer, the AF may indicate the UE that delivery mode is
changed from unicast to multicast.
### 6.8.3 Impacts on services, entities and interfaces
In addition to what is specified in clause 6.3.3, the impacts also include the
followings:
AF:
\- The AF needs to support the processing of multicast. The AF determines to
sends to 5GC the service parameters for multicast based on e.g. the network
analytics information provided by 5GC.
UDR:
\- The UDR is enhanced to store the multicast information, e.g. UE number of
requesting the service as a threshold, the list of UE IDs (i.e. GPSIs), or UE
group ID for receiving multicast service, and other service information, such
as IP multicast address.
PCF:
\- The PCF is enhanced to provide to the SMF(s) the multicast service related
policy.
SMF:
\- The SMF(s) may configure the UPF(s) for not sending the data via unicast
PDU session;
\- The SMF handling multicast transmission may authorize the UE\'s join
request based on the information provided by AF.
## 6.9 Solution #9: Broadcast service initiation
### 6.9.1 Functional description
This solution addresses Key Issue 1 and proposes a broadcast service
initiation procedure based on the MBS reference architecture alternative 2
(see clause A.2).
When the AF requests the MBSF to provide a broadcast service, the AF provides
the broadcast service related information, including service type, target
service area, QoS requirement information, where the service type indicates
which kinds of MBS services e.g. public safety or V2X services, etc. and
target service area indicate the area in which the contents provider wants to
provide service. In the case of broadcast service, the target service UE group
is set as Null or a dedicated value to indicate broadcast service.
NOTE: Based on the service type, target service area etc., an appropriate
MBSF/MBSU can selected by AF.
The MBSF derives the involved MB-SMF(s) to support the requested service based
on e.g. the service type, target service area. The MBSF sets up the MB Session
with the MB-SMF(s) selected based on the service type, the DNN info, slicing
information, QoS profiles etc. The MB-SMF gets authorization for the QoS
profile from the PCF
For broadcast services, the MB-SMF(s) select the involved AMF(s), which in
turn discovers and selects appropriate NG-RAN(s) for broadcast delivery of MBS
data based on the coverage of AMF, and the MB-SMF(s) set up the shared N3
tunnel between NG-RAN(s) and MB-UPF(s). AF or MBSF announces MBS services,
which deliver the MBS service specific parameters e.g. DNN info, MBS service
session ID, target service area, the radio resource information to receive the
MBS traffic in MBS area, etc. to UEs.
Later on, the UE may receive the MBS traffic in individual delivery manner via
an application-level mechanism.
### 6.9.2 Procedures
#### 6.9.2.1 MBS Session initiation procedure
Figure 6.9.2.1-1: MBS session initiation procedure (broadcast service)
The figure depicts MBS session initiation procedure for broadcast service as
follows.
1\. Third party contents provider (or AF) requests MBS service(s) to MBSF
(optionally via NEF) with service characteristics (e.g. service type, target
service area, target service UE group, etc.), where the service type indicates
which kinds of MBS services e.g. public safety or V2X services, etc. and
target service area indicate the area in which the contents provider wants to
provide service regardless of MBS area or not. In the case of broadcast
service, the target service UE group is set as Null or a dedicated value.
2\. MBSF may check whether the AF is authorized to start the MBS service with
PCF.
3\. If the MBS service session is authorized, MBS service session is setup and
its information (e.g. MBS service session ID, address information of the MBSU,
etc.) is selected by the MBSF.
4\. The MBSF notifies the MBS session information to the content provider or
AS.
For MB Session setup:
5\. MBSF initiates an MB Session setup to MB-SMF(s), which are selected based
on their coverage and the target service area.
6\. The MB-SMF may get service authorization including authorized QoS info
from PCF, which is authorized for the target service UE group.
7-8. The MBSF establishes a transport tunnel between MBSU and MB-UPF for
shared delivery of the MBS data.
For shared N3 tunnel setup:
9\. The MB-SMF selects AMF(s), which in turn discovers and selects NG-RAN(s)
for shared delivery of MBS data based on the coverage of AMF.
10-12. For data transport of shared delivery, the MB-SMF establishes shared N3
tunnel with the NG-RAN(s) to the MB-UPF selected in the step 7 and RAN
resources are setup.
13\. MBS service announcement is performed; MBS service announcement messages
can be delivered to UEs over the target service area, which includes the MBS
service specific parameters e.g. DNN, MBS service session ID, multicast IP
address, RAN related information for shared delivery, etc by AF or MBSF or NG-
RAN.
Editor\'s note: How to perform MBS service announcement for RAN related
information is FFS. RAN related information for shared delivery is decided by
RAN WGs.
#### 6.9.2.2 MBS Session leave procedure
If UE is not using a broadcast service anymore, NG-RAN and 5GC are not
notified of its leaving.
#### 6.9.2.3 MBS Session release procedure
The MBS Session release procedure is used to delete all the MBS session
context for media delivery of the broadcast service.
Figure 6.9.2.3-1: MBS session release procedure for broadcast service
1\. A broadcast service is initiated as specified in clause 6.9.2.1.
2\. The Content provider/AF decides to terminate this broadcast service. It
sends the MBS service release request to MBSF.
3\. The MBSF releases the MBS session and the tunnel between MBSU and MB-UPF,
and notifies the MBS session release to the Content provider/AF. Step 3 may
follow step 5.
4\. The MBSF requests the MB-SMF(s) the MB session release.
5\. The MB-SMF releases the MB session. Step 5 may follow step 8.
6\. The MB-SMF initiates the MB session release to NG-RAN.
7\. The NG-RAN releases all the MBS context of this MB session.
8\. The NG-RAN sends MB session release response to MB-SMF, and the MB-SMF
releases the tunnel between MB-UPF and NG-RAN.
### 6.9.3 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to services, entities and
interfaces.
**MBSF:**
\- The MBSF generates and manages MBS service context and request an MB
session setup to the MB-SMF.
\- The MBSF controls the MBSU for user plane management, which is a media
anchor of MBS traffic in 5GS.
**MB-SMF** :
\- The MB-SMF setup the MB session, which is used for the transport of shared
delivery.
\- The MB-SMF manages the MB session context for shared delivery, and may
manage the UE\'s PDU session context for individual delivery.
\- The MB-SMF selects appropriate AMF(s), which are used to find & select NG-
RAN nodes to cover the target service area.
**MB-UPF** :
\- It supports shared tunnel for shared delivery method.
**AMF** :
\- The AMF is enhanced to support MB session management b/w NG-RAN and MB-SMF.
**NG-RAN** :
\- It supports shared tunnel for shared delivery method.
**N3** :
\- A shared tunnel on this interface is established for an MB session.
## 6.10 Solution #10: Multicast MBS Session establishment linked with unicast
PDU session
### 6.10.1 Functional description
This solution addresses Key Issue#1 and architecture is described in clause
A.2.
The relation between multicast context, multicast flow and UE group model is
same with solution 3.
The enhancement on the top of solution 3 are:
\- There is MBSF/MBSU in the architecture.
\- There is an additional multicast MBS session signalling between MB-SMF and
NG-RAN. The multicast MBS session is terminated at the NG-RAN and a shared N3
tunnel is used for transfer the multicast service data for such MBS session.
One shared N3 tunnel from UPF to NG-RAN is used for all QoS Flow of MBS
session between the UPF and NG-RAN pair.
\- There is one or more MBS QoS Flows within one MBS session. The MBS QoS flow
within MBS session is identified by a MBS QoS flow identifier.
\- For each MBS QoS flow, there is one \"mapped\" QoS flow within related PDU
session(s). During the MBS session establishment or the user join procedure,
the correlation between the mapped QoS flow and MBS QoS flow is sent to the
RAN node.
NOTE 1: The mapped QoS Flow means the QoS Flow is established but the data is
not delivered over it if user data transmission is performed via a multicast
bearer. The mapped QoS Flow is a legacy QoS flow.
NOTE 2: The NG-RAN does not reserve the radio resource for the mapped QoS flow
until the 5GC request the switch.
\- The UPF is the U-plane anchor point to PDU session and MBS session. The MB-
SMF controls the transfer of multicast service data to the NG-RAN based on the
NG-RAN nodes ability to cope with multicast data. The MB-SMF informs the UPF
of proper PDR and FAR to perform the forwarding.
\- If the RAN node receives the multicast service data from the MBS QoS flow
in the shared tunnel for MBS session, the RAN node decide to transfer the
multicast data to the UE via PTP or PTM bearer.
Figure 6.10.1-1 shows an example for the C-plane and U-plane model. To
simplify, the NG-RAN node related with MB-SMF-2 and UPF-2 are not shown.
Figure 6.10.1-1: Multicast and unicast user and control plane model
The UE1 and UE-2 access the 5GS via NG-RAN 1 and there are UE1 PDU session and
UE2 PDU session (anchored in the MB-SMF-1/UPF-1).
The UE1 and UE-2 join the same multicast service X. There is dedicated MBS
session between MB-SMF-1/UPF-1 and NG-RAN 1. The C-plane is between MB-SMF-1
and NG-RAN 1, and U-plane is the shared N3 MBS tunnel between UPF-1 and NG-RAN
1.
In the shared N3 tunnel, there is MBS QoS Flow x which carries the multicast
MBS service X data. The mapped QoS Flow A is associated with MBS QoS Flow x in
the UE1 PDU session, and mapped QoS Flow B associated with MBS QoS Flow x in
the UE2 PDU session.
The NG-RAN 1 and MB-SMF-1 know the correlation between MBS QoS Flow x and (UE1
QoS Flow A, UE2 QoS Flow B). When the NG-RAN 1 receives the data from shared
N3 tunnel, it can decide using PTP radio bearer or PTM radio bearer to deliver
the data to UE-1 and UE-2. If the NG-RAN 1 receives the data from UE1 QoS Flow
A or UE2 QoS Flow B, it can schedules the DRB based on the QoS profile of the
mapped QoS Flow to deliver the data.
NOTE 3: After the mode switch (from multicast to unicast), the service data is
send from UPF to NG-RAN in the unicast QoS flow.
For the NG RAN 2 and UE3 and UE 4, it is similar.
### 6.10.2 Procedures
#### 6.10.2.1 Session Join
Figure 6.10.2-1: MBS session establishment
1\. The content provider informs the NEF/MBSF of the Multicast service
transmission start. The MBSF may retrieves the membership and the information
of the service data flow. The Content provider may also sends an identifier of
the multicast service, e.g. a multicast address of a multicast group that UE
can join, or a multicast service id, etc. to MBSF. The MBSF allocates the TMGI
and returns it to Content Provider.
The MBSF selects a MB-SMF handle this MBS session, and stores the multicast
context information including the MBSF address, MB-SMF address, TMGI and
multicast address in the UDR.
The above service information may be configured in the MBSF.
2\. The UE registers in the PLMN (see clause 4.2.2.2 of TS 23.502 [8]) and
request the establishment of a PDU session (see clause 4.3.2.2 of TS 23.502
[8]).
3\. The content provider announces the availability of multicast using higher
layers protocol (e.g. application layer). The announcement includes at least
an identifier of the multicast service, e.g. a multicast address of a
multicast group that UE can join, or a multicast service id or TMGI. The UE
may receive such announce via the PDU session established in step 2.
4-5. These two steps are same with step 3-4 in figure 6.3.2.1.
6a. Upon detection of UE join, the SMF checks whether a multicast context for
the multicast group (address) exists in the system, i.e. whether there is a UE
that already joined the multicast group. If there is no multicast context, the
SMF check UDR for MB-SMF address with TMGI/multicast address. The SMF
initiates an MBS session create procedure to the MB-SMF. If there is a
multicast context, the MB-SMF performs an MBS session update to inform the MB-
SMF that the UE joined. The MB-SMF sends the UE identity to the MB-SMF.
6b. If there is no tunnel between the UPF and MB-UPF for the MBS session, the
MB-SMF inform the MB-UPF the tunnel information. This step is optional.
6c. If there is no session between MB-SMF and MBSF, the MBS session between
MB-SMF and MBSF is established and the tunnel between MB-UPF and MBSU is
established to deliver the multicast service data.
The MBSF checks the membership of the UE based on the information received in
step1, or authorises the UE with the Content provider. If the UE is allowed to
join, the MBSF inform the MB-SMF of the result.
A MBS session can includes more than one MBS flow. The MBSF allocates a flow
identifier for the MBS QoS Flow. If there is no multicast context, the MB-SMF
creates the MBS context based on the response from the MBSF.
7\. The SMF requests the AMF to transfer a message to RAN node transparently
to add a mapped QoS flow in the existing PDU session. It also carry the
associated Multicast Session ID, MB-SMF ID to the NG-RAN. The NG-RAN transfers
a PDU session modification command message to the UE transparently for adding
a QoS flow in the existing PDU session.
9\. the NG-RAN can know the correlation between the mapped QoS flow in PDU
session and the MBS Context. The RAN stores such mapping information and
reserves the AN-specific resource.
There may be one common QoS profile for the mapped flow and MBS flow, or
separated QoS profiles depend on the operator\'s policy.
10\. The UE and NG-RAN response the requests from the MB-SMF.
11a. If there is no existing MBS session between NG-RAN and MB-SMF identified
by MBS session ID, the NG-RAN selects the AMF to sends MBS session request
(with MBS session ID, MBS UE ID) to MB-SMF via AMF. If there is existing MBS
session between NG-RAN and MB-SMF identified by MBS session ID, the NG-RAN
sends MBS session update to notify the MB-SMF with UE ID.
If the NG-RAN is configured to use a unicast transport for shared N3 delivery,
it allocates a downlink tunnel ID (an IP address and a GTP-U TEID) for the
reception of the multicast data and indicates it in the request.
11b. If the unicast transport for shared N3 delivery is used, the MB-SMF
indicate the MB-UPF with the downlink tunnel information of NG-RAN.
11c. MB-SMF sends a MBS session response to NG-RAN via AMF. If the multicast
transport is used, it indicates the transport multicast address for the
multicast session.
12-14. If there is no shared tunnel for such MBS session, the DL tunnels are
allocated and transferred to the next hop on the user plane. If the tunnel
between UPF and BMSU was already established, the step 13 and 14 are not
required.
#### 6.10.2.2 Session leave
The UE use the Session Leave procedure to inform the network of the UE
interest in an MBS Session.
Figure 6.10.2.2-1: UE leave multicast session procedure
1\. The UE has joined multicast service as specified in clause 6.10.2.1.
At any time the UE may determine to leave the multicast service.
2\. The UE sends the UE leave multicast request to the network.
In the U-plane alternative, the UE sends IGMP/MLD leave message. The UPF
detects the IGMP/MLD leave message, and notifies the SMF.
In the C-plane alternative, The UE sends the PDU Session Modification Request
which includes the information about the multicast service to be leaving.
3\. The SMF notify the MB-SMF, the UE leave the multicast session. If the UE
is the last UE in this multicast session in the SMF, the SMF sends MB-SMF
session release request to MB-SMF.
5\. The SMF initiate the PDU session modification procedure to release the
mapped QoS flow of PDU session of UE corresponding to the MBS flow of the MBS
session which UE is leaving.
7\. The NG-RAN releases the UE MBS context and modifies the AN-specific
resource.
8\. UE sends the PDU session modification ACK to SMF.
9\. The NG-RAN send MBS session modification request to MB-SMF. If the UE is
the last UE in the NG-RAN for this MBS session, the NG-RAN send MBS session
release request to MB-SMF. If the multicast transport for shared N3 delivery
is used and UE is the last UE in this MBS session, the NG-RAN sends the
IGNP/MLD leave message to the IP multicast address.
10\. If the UE is the last UE in this multicast session, and unicast transport
for shared N3 delivery is used, the MB-SMF request the MB-UPF to stop sending
packet to NG-RAN.
11\. If there is no UE in the MB-SMF for this MBS session, the MB-SMF request
the MBSF to release the tunnel between MBSU and MB-UPF.
#### 6.10.2.3 MBS session release
The MBS Session release is used to delete all the resource for the MBS session
context and media delivery.
Figure 6.10.2.3-1: Multicast session release procedure
1\. The UE has joined multicast service as specified in clause 6.10.2.1.
2\. The Content provider decides to terminate this MBS service. It send the
MBS service release to MBSF/NEF. The MBSF send the MBS session release to MB-
SMF to release the session between MBSF and MB-SMF, and the tunnel between
MBSU and MB-UPF.
3\. The MB-SMF send the MBS session release to SMF to release the session
between MB-SMF and SMF, and the tunnel between MB-UPF and UPF.
4\. The SMF initiate the PDU session modification procedure to release the QoS
flow of PDU session of UE corresponding to the MBS flow of the MBS session
which UE has joined.
5\. The MB-SMF initiate the MBS session release to NG-RAN.
6\. The NG-RAN release all the MBS context of this MBS session and modify the
AN resource.
7\. UE sends the PDU session modification ACK to SMF.
8\. The NG-RAN send MBS session release response to MB-SMF.
9\. MB-SMF sends the MBS session release response to MBSF.
10\. MBSF/NEF send the MBS service release response to Content Provider.
### 6.10.3 Impacts on services, entities and interfaces
**MBSF:**
\- The MBSF generates MBS context and send to the MB-SMF.
\- The MBSF manages the MBSU. It is similar with the relationship between the
MB-SMF and UPF.
**MB-SMF** :
\- The MB-SMF requests a MBS session **creation** to the NG-RAN.
**\- The MB-SMF allocates a dummy flow within a PDU session mapping to a MBS
QoS flow within a MBS session.**
**\- The MB-SMF sends the correlation information to the RAN node.**
**UPF** :
\- If the UE joins multicast group via user plane, the UPF must support a new
capability to trigger a user plane event in a response to the reception of a
join message.
**RAN** :
\- The RAN receives the **correlation** information from the MB-SMF and stores
it.
**N3** :
\- A share tunnel on this interface is established for a MBS session.
**UE** :
\- It needs to indicate the MBS service information as part of the user plan
join message (e.g. IGMP join), or of the control plan message (e.g. PDU
Session modification request).
**AMF** :
\- The AMF is enhanced to support MBS session.
## 6.11 Solution #11: Xn Handover of MB Sessions
### 6.11.1 Functional Description
This solution provides a solution to KI #1, and some aspects of KI#4 and KI
#7. The solution is based on solution 2 and architectural alternative 2.
It describes Xn Handover of MB Sessions for NR. Xn Handover between RATs is
not supported (e.g. between NR and E-UTRA). Instead session continuity assumed
to be handled on application level, e.g. as is described in TS 23.468 [5]
clause 5.3 \"Service Continuity\".
### 6.11.2 Procedures
#### 6.11.2.0 General
NOTE 1: The message names in the procedure below are descriptive. It is
assumed that the names are updated with corresponding SBI based names where
applicable during the normative phase. N2, N3 messages are dependent on RAN
WG3 decisions.
NOTE 2: How to support MBS data forwarding between S-NG-RAN and T-NG-RAN is
dependent on collaboration with RAN WG3 and RAN WG3 decisions on how to apply
5MBS UP on RAN architecture.
#### 6.11.2.1 Inter-gNB Xn Handover with 5MBS Session
The Target NG-RAN triggers 5GC to establish any MB Session resources that need
to be established (see option 1 below) in the course of Xn Handover
preparation phase, prior to handover execution phase. The UE would continue to
receive the media stream immediately when it has synchronized to the new cell.
This enables MB Session continuity.
Alternatively, the AMF may take responsibility for the MB Session resource
setup in Target NG-RAN (see option 2 below) after the UE was handed over to
the Target NG-RAN. Parameters in the Path Switch Request/Response messages may
provide some optimization. This option would result in a somewhat bigger gap
in the MB session continuity, assuming that UE-individual data forwarding is
not applied of MB Session user data.
NOTE: During an Xn Handover, the PDU Sessions of a UE are moved and connected
to the new NG-RAN node. Unlike PDU Session, MB Sessions are never moved and
connected to the Target NG-RAN node. Transfer of data associated with MB
Sessions is started on the Target NG-RAN node and if needed released on the
Source NG-RAN node.
The procedure supports _5GC Individual MBS Traffic Delivery_. Individual
delivery is only used when an NG-RAN node does not support 5MBS. Furthermore,
a UE is moved back to 5GC Shared MBS Traffic Delivery as soon as the MB
Session can be made present in a Target NG-RAN node. A precondition for
switching to 5GC Shared MBS Traffic Delivery is that the UE has already
earlier joined the MB Session and a precondition for switching to _5GC
Individual MBS Traffic Delivery_ is that there is a DRB present in Target NG-
RAN for the target PDU Session. A precondition is checked in the AMF or the
Target NG-RAN (see step 10). When _5GC Individual MBS Traffic Delivery_ is not
provided due to AMF local policies or potential presence of the AF
DisableIndividualDelivery indicator, the 5MBS service is not provided in NG-
RAN nodes that does not support 5MBS. Applications may in such cases switch to
unicast delivery at application level. When policies and network support
allow, applications may switch back to 5MBS service, e.g. based on the UE
monitoring of RAN level notifications (e.g. using MCCH or SIB) for presence of
a MB Session.
For the full sequence of the Xn Handover procedure, please refer to clause
4.9.1.2 in TS 23.502 [8] and clause 9.2.3. in TS 38.300 [10].
Figure 6.11.2.1-1: Inter-gNB Xn Handover with 5MBS Session
0\. A Media stream to the Source NG-RAN and PTM/PTP transmission to the UE is
ongoing. Source NG-RAN triggers a Handover (see step 0 to 2 in clause
9.2.3.2.1, TS 38.300 [10]).
1\. Source NG-RAN sends a Xn Handover Request () to Target NG-RAN. The UE
Context contains MB Session information.
2\. OPTION 1: Source NG-RAN informs Target NG-RAN of any MB Session resources
that need to be established. MB Session Info for the MB Sessions the UE has
joined is included in the Xn Handover Request message, with a list of {TMGI,
active/inactive indicator, LL MC address}.
If option 1 is used and Target NG-RAN does not already have an active MB
Session Context for any TMGIs in the list in step 1:
2a. The Target NG-RAN announces its interest in the MB Session by sending a MB
Session Command (TMGIs) to the AMF.
2b. If an MB Session is set to active state above, the AMF sends an MB Session
Resource Setup Request (TMGI, LL MC, 5G Authorized QoS Profile) message to the
NG-RAN node. The NG-RAN creates an MB Session Context (if it does not already
exist), sets it to active state, stores the TMGI, the 5G Authorized QoS
Profile and the AMF ID in the MB Session Context. The NG-RAN node returns an
MB Session Resource Setup Response (TMGI) message to the AMF when resources
have successfully been established. The AMF stores the NGâ€‘RAN ID of the Target
NG-RAN node in the AMF MB Session Context.
2c. If Target NG-RAN prefers to use N3 multicast transport, the Target NG-RAN
joins the multicast group (i.e. LL MC address) for new active MB Sessions.
If Target NG-RAN prefers to use N3 point-to-point transport (or if the LL MC
address is not available in Target NG-RAN), the Target NG-RAN sends a RAN MB
Session Setup Request (TMGI, N3 Tunnel Info) to the AMF. AMF responds to NG-
RAN when done.
2d. AMF forwards the RAN MB Session Setup Request (TMGI, Tunnel Info) to MB-
SMF to setup the media stream to the Target NG-RAN node. MB-SMF responds to
AMF when done.
2e. The MB-SMF sends an N4 request to the MB-UPF to allocate the N3 point-to-
point transport tunnel for the replicated MBS stream to the Target NG-RAN
node.
NOTE 1: If the Target NG-RAN supports 5MBS services and can determine that 5GC
Individual MBS traffic delivery has been used for the UE in Source NG-RAN,
Target NG-RAN may prepare for a switch to reception of MB Session data. For
further study and decision in RAN WG3.
3\. For active MB Sessions, resources may be configured for the UE that is
handed over from source to target to transmit media streams by the Target NG-
RAN. If there are already other UEs joined to the active MB Session in the
Target NG-RAN, PTM/PTP transmissions are also ongoing.
4\. The Target NG-RAN sends a Xn Handover Request Acknowledge () to Source NG-
RAN.
5\. The Source NG-RAN sends a Uu Handover Command () to the UE. The UE starts
to access and synchronizes to the new cell.
6\. The Target NG-RAN determines that the new UE in the cell should receive
media for one or more MB Sessions and provides PTM/PTP transmission(s) to the
new UE.
NOTE 2: Optionally the data transfer to the UE on PTM can be already started
in step 3, RAN to determine.
7\. SN Status is transferred to the Target NG-RAN, however not for MB
Sessions. Forwarding for PDU Sessions may be performed. Forwarding of MB
Session(s) data may optionally be performed (details are RAN dependent).
8\. [Conditional] If this UE was the last UE to leave a MB Session in the
Source NG-RAN, the Source NG-RAN releases its resources for the MB Session
(see Session Leave procedure).
9\. Target NG-RAN sends a Path Switch Request (TMGIs) message to the AMF. If
the Target NG-RAN is aware of TMGIs the UE has joined, they may be included in
the request message. The AMF responds with a Path Switch Request Acknowledge
() message.
NOTE 3: RAN may decide to introduce a TMGI list parameter in the Path Switch
Request Acknowledge () message to replace step 10a below.
10\. OPTION 2: AMF determines if MB Session resources need to be setup in
Target NG-RAN e.g. by checking if the NG-RAN ID of the Target NG-RAN node is
already stored in the AMF MB Session Context or not, and the state of the MB
Session Context. If active state and not stored, steps 10a to 10c are
executed. If the Target NGâ€‘RAN supports 5MBS, the AMF may also decide to
establish MB Session resources if _5GC Individual MBS traffic delivery_ has
been used for the UE in the Source NG-RAN.
10a. When AMF receives the Path Switch Request () message, the AMF sends a MB
Session Join (NGAP ID, TMGI) message to Target NG-RAN for each TMGI the AMF
has in its UE Context, unless the Target NG-RAN is already aware due to option
1 (as indicated by the presence of the TMGI in the Path Switch Request
message), then no MB Session Join message is sent.
10b. If any of the TMGIs in the AMF UE Context has a MB Session Context in
active state and the AMF has not already requested the Target NG-RAN node to
make resource setup, the AMF sends MB Session Resource Setup Request (TMGI, LL
MC, 5G Authorized QoS Profile) message to the Target NG-RAN.
10c. If a MB Session Context for the TMGI does not already exist in Target NG-
RAN, the NG-RAN creates a MB Session Context, sets it to active state, stores
the TMGI, the QoS Profile and a list of AMF IDs in the MB Session Context and
invokes reception of the MB data (see below). Otherwise Target NG-RAN just
stores the AMF ID in its MB Session Context.
Target NG-RAN may invoke reception of MB data, either, if Target NG-RAN
prefers to use N3 multicast transport, by joining the multicast group (i.e. LL
MC address) for the new active MB Sessions, or, if Target NG-RAN prefers to
use N3 point-to-point transport (or if the LL MC address is not available), by
sending a RAN MB Session Setup Request (TMGI, N3 Tunnel Info) to the AMF. In
the latter case, AMF responds to Target NG-RAN when done.
10d. AMF forwards the RAN MB Session Setup Request (TMGI, Tunnel Info) to MB-
SMF to setup the media stream to the Target NG-RAN node. MB-SMF responds to
AMF when done.
10e. The MB-SMF sends an N4 request to the MB-UPF to allocate the N3 point-to-
point transport tunnel for the replicated MBS stream to the Target NG-RAN
node.
If the Target NG-RAN supports and Source NG-RAN does not support 5MBS
services, and 5GC Individual MBS traffic delivery is being used for the UE,
the AMF may decide to switch to reception of MB Session data. The AMF then
activates a MB Session as described in steps 10a to 10c above and deactivates
the 5GC Individual MBS traffic delivery as described in step 6 of the Session
Leave procedure in clause 6.2.2.5.
If the Target NG-RAN does not support and Source NG-RAN supports 5MBS
services, and if the UE was receiving 5MBS Shared Delivery in the Source NG-
RAN (the AMF UE Context has a TMGI and the corresponding MB Session Context is
in active state in AMF), the AMF may decide to switch to 5GC Individual MBS
traffic delivery dependent on AMF local policies and potential presence of the
AF DisableIndividualDelivery indicator. The AMF activates 5GC Individual MBS
traffic delivery for a MB Session as described in the Session Start procedure
in clause 6.2.2.2a.
If the UE has joined multiple MB Sessions, all UE\'s MB Sessions should be
handled as above. The AMF may use the same or different PDU Session(s) for
multiple MB Sessions.
11\. If there is MB Session Context in active state for any of the TMGI(s) of
the new UE in the Target NG-RAN, the Target NG-RAN provides PTM/PTP
transmission(s) to the new UE if not already done (in step 6).
NOTE 4: Support for Option 1 above is a RAN decision. Option 1 may provide
much better session continuity characteristics at handover and reduce N2
signalling.
NOTE 5: Support for the TMGI parameter in the Path Switch Request message is a
RAN decision. It may reduce N2 Session Join signalling in step 10a when Option
1 is used.
NOTE 6: Support for TMGI-list parameter in the Path Switch Request Acknowledge
message is a RAN decision. It may reduce N2 Session Join signalling in step
10a. If RAN decides for this TMGI-list parameter, the parameter in the NOTE
above may not be required.
NOTE 7: Option 1 and Option 2 can be complementary and may both be
standardized depending on RAN decision.
### 6.11.3 Impacts on services, entities and interfaces
UE:
\- Reception of multicast data using PTM/PTP in RRC Connected.
\- Switch of reception from Source to Target NG-RAN when Xn Handover execution
phase commences.
NG-RAN:
\- Support for MB Session info in Xn Handover request (option 1).
\- MB Session resource setup during Xn Handover preparation phase (option 1).
\- MB Session resource setup during Xn Handover execution phase (option 2).
\- New parameters in Patch Switch messages.
AMF:
\- Support new message which triggers MB Session resource setup in NG-RAN
during Xn Handover preparation phase (option 1).
## 6.12 Solution #12: N2 Handover of MB Sessions
### 6.12.1 Functional Description
This solution provides a solution to KI #1, and some aspects of KI#4 and KI#7.
The solution is based on solution 2 and architectural alternative 2.
It describes N2 Handover of MB Sessions for NR. N2 Handover between RATs is
not supported (e.g. between NR and E-UTRA). Instead session continuity assumed
to be handled on application level, e.g. as is described in TS 23.468 [5]
clause 5.3 \"Service Continuity\".
The procedure supports _5GC Individual MBS Traffic Delivery_. Individual
delivery is only used when an NG-RAN node does not support 5MBS. Furthermore,
a UE is moved back to 5GC Shared MBS Traffic Delivery as soon as the MB
Session can be made present in a Target NG-RAN node. A precondition for
switching to 5GC Shared MBS Traffic Delivery is that the UE has already
earlier joined the MB Session and a precondition for switching to 5GC
Individual MBS Traffic Delivery is that there is a DRB present in Target NG-
RAN for the target PDU Session. A precondition is checked in the AMF or the
Target NG-RAN (see step 7d and 6d in the procedures below). When _5GC
Individual MBS Traffic Delivery_ is not provided due to AMF local policies,
potential presence of the AF DisableIndividualDelivery indicator, or due to
that Target AMF does not support 5MBS, the 5MBS service is not provided in NG-
RAN nodes and AMFs that does not support 5MBS. Applications may in such cases
switch to unicast delivery at application level. When policies and network
support allow, applications may switch back to 5MBS service, e.g. based on the
UE monitoring of RAN level notifications (e.g. using MCCH or SIB) for presence
of a MB Session.
### 6.12.2 Procedures
#### 6.12.2.0 General
NOTE 1: The message names in the procedure below may be descriptive. It is
assumed that the names are updated with corresponding SBI based names where
applicable during the normative phase. N2, N3 messages are dependent on RAN
WG3 decisions.
NOTE 2: The MB Session Context in the AMF is used and contains information to
manage the distribution tree. That is, it contains information in what NG-RAN
nodes the AMF has requested MB Session resources to be established. The MB
Session context in AMF does not contain info on what UEs has joined the MB
Session, that is maintained in respective AMF UE context.
NOTE 3: How to support MBS data forwarding between S-NG-RAN and T-NG-RAN is
dependent on collaboration with RAN WG3 and RAN WG3 decisions on how to apply
5MBS UP on RAN architecture.
#### 6.12.2.1 Inter-gNB N2 Handover
##### 6.12.2.1.0 Introduction
During the N2 Handover preparation phase, the Source NG-RAN triggers 5GC to
establish any MB Session resources that need to be established. The UE would
continue to receive the media stream immediately when it has synchronized to
the new cell. This enables MB Session continuity.
The N2 Handover solution is shown on top of the TS 23.502 [8] N2 Handover
procedure in clause 4.9.1.3. Proposed changes are shown below as **_italic_
bold text.**
##### 6.12.2.1.1 Inter NG-RAN node N2 based handover (based on TS 23.502 [8]
clause 4.9.1.3)
##### 6.12.2.1.1.1 Preparation phase {#preparation-phase .H6}
Figure 6.12.2.1.1.1-1: Inter NG-RAN node N2 based handover, Preparation phase
(based on Figure 4.9.1.3.2-1 of TS 23.502 [8])
NOTE: Original text from TS 23.502 [8] clause 4.9.1.3.2 in **bold text** (but
only text relevant for MB Sessions included). New text directly related to
handling of MB Sessions is in **[bold underlined text]{.underline}**.
**0\. MB Media stream and PTM/PTP transmission may be ongoing in the 5GS i.e.
from MB-UPF to S-RAN to UE.**
1-7. Steps same as in TS 23.502 [8] clause 4.9.1.3.2. If the T-AMF is
selected, the S-AMF includes TMGI(s) in Namf_Communication_CreateUEContext
Request message sending to the T-AMF.
**7a. [Conditional] If the AMF does not already have a MB Session Context for
the received TMGI, for each TMGI in the AMF UE Context: T-AMF to MB-SMF:
Nmbsmf_MBSession_UpdateMBContext (TMGI, T-AMF ID).**
**The MB-SMF stores the T-AMF ID in the list of AMF IDs in the MB-SMF MB
Session Context. If the T-AMF is new in the list, i.e. the T-AMF does not
already have the MB Session and the MB-SMF MB Session state is \'active\', the
MB-SMF prepares to send a MB Session Start notification to the AMF (step
7c).**
**7b. MB-SMF to T-AMF: Nmbsmf_MBSession_UpdateMBContext Response (TMGI).**
**The MB-SMF includes in the Nmbsmf_MBSession_UpdateMBContext response the N2
MB Information containing the Lower Layer Multicast Address (LL MC) assigned
for the MB Session and used by the MB-UPF and the 5G Authorized QoS Profile
indicating that the N2 SM Information is for the Target NG-RAN.**
**The T-AMF creates an MB Session Context at sets its state to \'inactive\'.**
**7c. If the T-AMF is new in the MB-SMF list in step 7a and the MB Session is
\'active\', the MB-SMF sends a Nmbsmf_MBSession_UpdateMBContext Start (i.e. MB
Session Start) to the AMF. T-AMF updates its MB Session Context and sets the
state to \'active\'.**
**7d-7f. [If the T-NG-RAN supports 5MBS, the]{.underline} T-AMF sends a MB
Session Resource Setup Request message to T-NG-RAN. See the MB Session Start
procedure. A Handover Incoming Indicator is included in the MB Session
Resource Setup Request message to avoid that NG-RAN releases resources as
there might be no UE interested in that TMGI at this point in time.**
**[If the T-NG-RAN does not support and S-NG-RAN supports 5MBS services, and
if the UE is receiving 5MBS Shared Delivery in the S-NG-RAN (the T-AMF UE
Context has a TMGI and the corresponding MB Session Context is in active state
in T-AMF), the T-AMF may decide to switch to 5GC Individual MBS traffic
delivery dependent on T-AMF local policies and potential presence of an AF
provided DisableIndividualDelivery indicator. The T-AMF prepares for 5GC
Individual MBS traffic delivery for an MB Session as described in the Session
Start procedure in clause 6.2.2.2a step 4 and 5, however in addition it is
indicated that the PSA-UPF shall not yet start to forward the media stream is
onto the PDU Session (only join the MC tree if not yet done for other
UE).]{.underline}**
**[If the UE has joined multiple MB Sessions, all UE\'s MB Sessions should be
handled as above. The T-AMF may use the same or different PDU Session(s) for
multiple MB Sessions.]{.underline}**
**8\. AMF supervises the Nsmf_PDUSession_UpdateSMContext Response messages
from the involved SMFs. The lowest value of the Max delay indications for the
PDU Sessions that are candidates for handover gives the maximum time AMF may
wait for Nsmf_PDUSession_UpdateSMContext Response messages before continuing
with the N2 Handover procedure. At expiry of the maximum wait time or when all
Nsmf_PDUSession_UpdateSMContext Response messages are received, AMF continues
with the N2 Handover procedure (Handover Request message in step 9). For UE
which has joined one or more MB Sessions, the T AMF does not need to wait for
the Nmbsmf_MBSession_UpdateMBContext Response, since these can be executed in
parallel with the N2 Handover procedure.**
NOTE: The delay value for each PDU Session is locally configured in the AMF
and implementation specific.
9-12. Steps same as in TS 23.502 [8] clause 4.9.1.3.2.
##### 6.12.2.1.1.2 Execution phase {#execution-phase .H6}
Figure 6.12.2.1.1.2-1: inter NG-RAN node N2 based handover, execution phase
(based on Figure 4.9.1.3.3-1 of TS 23.502 [8])
NOTE 1: Registration of serving AMF with the UDM is not shown in the figure
for brevity.
1-3. Steps same as in TS 23.502 [8] clause 4.9.1.3.3.
4\. UE to T-RAN: Handover Confirm.
After the UE has successfully synchronized to the target cell, it sends a
Handover Confirm message to the T-RAN. Handover is by this message considered
as successful by the UE.
**If there is MB Session Context in active state in T-NG-RAN for any of the
TMGI(s) of the new UE, the T-NG-RAN provides PTM/PTP transmission(s) to the
new UE.**
5-6c. Steps same as in TS 23.502 [8] clause 4.9.1.3.3.
**6d. If the T-NG-RAN supports and S-NG-RAN does not support 5MBS services,
and 5GC Individual MBS traffic delivery is being used for the UE, the T-AMF
deactivates 5GC Individual MBS traffic delivery and reception of MB Session
data started after step 4. The T-AMF deactivates the 5GC Individual MBS
traffic delivery as described in step 6 of the Session Leave procedure in
clause 6.2.2.5.**
**If the T-NG-RAN does not support and S-NG-RAN supports 5MBS services, and if
the UE were receiving 5MBS Shared Delivery in the S-NG-RAN (the T-AMF UE
Context has a TMGI and the corresponding MB Session Context is in active state
in T-AMF), the T-AMF may decide to switch to 5GC Individual MBS traffic
delivery dependent on T-AMF local policies and potential presence of an AF
provided DisableIndividualDelivery indicator. The T-AMF activates 5GC
Individual MBS traffic delivery for a MB Session as described in the Session
Start procedure clause 6.2.2.2a. Step 4 and onwards. The media stream may
already be present in the PSA-UPF after the preparation phase above (see step
7d in clause 6.12.2.1.1.1).**
**If the UE has joined multiple MB Sessions, all UE\'s MB Sessions should be
handled as above. The T-AMF may use the same or different PDU Session(s) for
multiple MB Sessions.**
7-14b. Steps same as in TS 23.502 [8] clause 4.9.1.3.3.
**14c. [Conditional] If this UE was the last UE to leave a MB Session in the
S-NG-RAN, the S-NG-RAN releases its resources for the MB Session (see Session
Leave procedure).**
15a-15b. Steps same as in TS 23.502 [8] clause 4.9.1.3.3.
### 6.12.3 Impacts on services, entities and interfaces
UE:
\- Reception of multicast data using PTM/PTP in RRC Connected.
\- Switch of reception from Source to Target NG-RAN when N2 Handover execution
phase commences.
NG-RAN:
\- MB Session resource setup during N2 Handover preparation phase.
\- Reception of MB Media streams.
\- Forwarding of MB Media streams using PTM/PTP transmission to UE when N2
Handover execution phase commences.
AMF:
\- Triggering MB Session Join and MB Session Start signalling for resource
setup during N2 Handover preparation phase.
## 6.13 Solution #13: MBS session deactivation and activation
### 6.13.1 Functional description
The solution is based on architectural option A.1 and Solution #3
The procedure for MBS session deactivation and activation is similar with
unicast PDU Session deactivation and activation.
**MBS Session deactivation:**
When the MBS Session is established, the PCF can provide the SMF the policy
based on e.g. local configuration or assistance information from MBS AF
whether the MBS Session can be deactivated. If the MBS Session can be
deactivated, SMF can determine the UP connection of the MBS Session will be
deactivated in the case of no downlink data to be transmitted. The UPF
notifies the SMF detection of MBS session inactivity. SMF sends N4 session
modification to UPF. SMF sends N2 message transfer to AMF requesting
deactivating the MBS session. If the N2 context is per UE configured, then the
SMF also needs to send the list of UE information associated with the MBS
session. The AMF sends N2 MBS Session release to release the AN context for
associated UEs for this MBS Session. And the NG-RAN releases AN resource for
this MBS Session. Alternatively, NG-RAN can also detect the MBS Session
inactivity based on the inactivity timer and initiates AN release for this MBS
Session and the AMF notifies the SMF deactivation of the MBS Session. The AN
release procedure can reuse the existing clause 4.2.6 of TS 23.502 [8].
**MBS Session activation:**
SMF can trigger MBS Session activation using procedure similar with the
procedure of Network Triggered Service Request in clause 4.2.3.3 of TS 23.502
[8].
When the downlink data arrives to the MBS anchor UPF, the MBS anchor UPF
notifies MBS anchor SMF the downlink data arriving for the MBS Session. The
anchor SMF notifies the involved SMF MBS data arriving. The involved SMF
determines the list of UEs associated with this MBS Session, and sends N2
message transfer to the AMF indicating the to be activated MBS Session and the
list of UE information.
The AMF determines the list of UE to be paged in one Registration Area, i.e.
the UEs which are in the UE list received from SMF and which are registered in
the Registration Area. The AMF send a paging request message to the NG-RAN
node(s) belonging to this Registration Area, including paging information (UE
ID, UE DRX cycle) of the determined list of UEs.
NG-RAN pages the UEs as existing paging mechanism.
When UE receives the paging message, the UE initiates Service Request
procedure and SMF activates the MBS session. During the deactivation
procedure. The NG-RAN establishes the AN resource/context for the MBS Session.
### 6.13.2 Procedures
#### 6.13.2.1 MBS session deactivation
In this procedure, SMF2 is the anchor SMF, UPF2 is the anchor UPF.
Figure 6.13.2.1-1: Call flow for MBS Session deactivation
1\. SMF determines to deactivate the MBS Session there is no data or no UE for
the MBS Session. The methods for SMF to determine to deactivate:
\- Receiving indication from the UPF there is no data receives for the MBS
Session; or
\- Receiving request from the RAN on deactivation of MBS Session.
2\. The SMF2 sends N2 message to the multicast-involved NG-RAN to notify the
release/deactivation of the MBS Session, involving MBS Session ID, N2 SM
Information.
3\. The AMF sends the N2 MBS Session Release Command including N2 SM
information received from the SMF2 via N2 to the NG-RAN.
4\. NG-RAN release AN resource for the MBS Session via RRC Reconfiguration or
Release procedure.
5\. NG-RAN acknowledges the N2 MBS Session Resource Release Command to the AMF
including N2 SM Resource Release Ack.
6\. The AMF invokes the MBS session context update service operation to
acknowledge the service for SMF2.
7\. (Optional) The SMF initiates an N4 Session Modification procedure
indicating the need to remove AN Tunnel Info for N3/N9 tunnel of the
corresponding MBS Session.
8\. The AMF invokes the MBS session context update service operation to SMF1.
The SMF1 initiates an N4 Session Modification procedure indicating the need to
remove AN Tunnel Info for N3/N9 tunnel of the corresponding MBS Session.
#### 6.13.2.2 MBS session activation
Figure 6.13.2.2-1: Call flow for MBS Session activation
0-1. When the anchor UPFUPF2 receives downlink data for a MBS session and
there is no AN/CN Tunnel Info stored in UPF for the MBS Session, UPF2 sends
data notification to the anchor SMF2, including N4 Session ID associated with
MBS session.
2\. SMF2 sends DL data notification to AMF with the MBS Session information
and N2 SM message (MBS Session identifier, associated QoS profiles).
3\. The AMF determines the list of UE involved in the MBS Session and to be
paged in one Registration Area, i.e. the UEs which are involved in the MBS
Session and which are registered in the Registration Area. The AMF send a
paging request message to the NG-RAN node(s) belonging to this Registration
Area, including paging information (UE ID, UE DRX cycle) of the determined
list of UEs. If these UEs are distributed in different Registration Areas, the
AMF pages the UEs within the associated Registration Area the UEs registered.
The AMF only page the UE in CM-IDLE state. If the UE is in CM-CONNECTED state,
the AMF does not page the UE.
4\. The NG-RAN pages the UEs according to the received paging information in
step 4 (i.e. list of UE ID and UE DRX cycle).
5\. The NG-RAN pages the UEs according to the received paging information in
step 4 (i.e. list of UE ID and UE DRX cycle).
6\. The UE in IDLE state triggers Service Request procedure, and the network
activates the MBS session. During this step, NG-RAN setup AN
resource/context/N3 Tunnel info, the procedure is same as solution #3; the
SMF1 triggers UPF1 to allocate N9 DL tunnel info and the SMF1 provides the N9
DL tunnel info to the AMF.
7\. AMF responds to SMF2 with the N9 DL tunnel info of UPF1.
8\. SMF2 sends Session modification to UPF2 with the N9 DL tunnel info of
UPF1.
### 6.13.3 Impacts on services, entities and interfaces
Anchor UPF:
\- Send DL notification including N4 MBS session information to the anchor SMF
when receiving downlink data.
Anchor SMF:
\- The anchor SMF notifies the involved SMF the DL notification.
SMF:
\- Derives list of UEs which has established PDU Sessions associated with the
MBS session and sends to the AMF.
AMF:
\- Determines the list of UEs to be paged in one Registration Area and send
the list of UEs information to the NG-RAN belonging to the Registration Area.
NG-RAN:
\- Receiving paging information for the list of to be paged UE in the paging
request message, and pages the UE.
UE:
\- No impact.
## 6.14 Solution #14: MBS Session Management without using UE IP address
### 6.14.1 Functional description
This solution addresses the Key Issue #1: MBS session management. This
solution also addresses some aspects of Key Issue #3.
New solutions for MBS Session Management without using UE IP address are
proposed.
#### 6.14.1.1 MBS UE Context Activation and Deactivation procedure for
Architecture Alternative 1 and 2
For the legacy MBMS Multicast Service, the UE needs to establish a PDN
Connection with an APN0 and gets an IP address, then the UE uses the IP
address to send an IGMP Join packet to the CN to request joining the MBMB
group and the UE is provided with a new APN1 by the CN. After that the UE uses
the CN provided APN1 to perform the MBMS UE Context activation to the MBMS
group identified by the IP multicast address. In this legacy procedure, the UE
firstly needs to get an IP address, and needs to use two APNs. For the 5G MBS
UEs that are static and do not move oftenly (e.g. the Multicast TV set in the
public area, such as airport station, Restaurant, Shopping Mall), in such case
, they do not need to support multicast and unicast switching and the 5G MBS
UE Context activation procedure can also be simplified.
We propose that:
1\. The UE Policy rules are used to provide MBS Service Announce to the UE.
2\. The UE needs to select an S-NSSAI and DNN for the MBS Multicast Service
identified by the IP multicast address from the URSP rules provided by PCF.
3\. The UE does not need establish a IP type PDU Session and does not need to
get an IP address for the MBS UE context Activation.
5\. The UE directly performs the MBS UE Context activation/deactivation for
the MBS Multicast service without IGMP join/leave procedure.
For the MBS UE Context Deactivation procedure, the UE, (MB-)SMF, MBSF can
trigered it. To be simple, only UE initiated MBS UE Context Deactivation
procedure is defined in this paper. Other MBS UE Context Deactivation
procedure can be defined with some minor changes with the UE initiated MBS UE
Context Deactivation procedure. During the MBS UE Context Deactivation
procedure, the user plane resource for the MBS service data delivery can be
allocated,i.e. the MBS Service has be started. If the MBS UE Context
deactivation UE is the last UE in the RAN/(MB-)SMF/MBSF, the RAN/(MB-)SMF/MBSF
needs to release the MBS Session Context and related RAN resource/N4 MBS
Session.
The MBS UE Context Activation procedure in clause 6.14.2.1 and MBS UE Context
Deactivation procedure in clause 6.14.2.3 are defined based on the MBS
architecture alternative 2, but the procedure can also be used to architecture
alternative 1, with the MBSF and MB-SMF are colocated and renamed as SMF, MBSU
and MB-UPF are colocated and renamed as UPF, and messages between the MB-SMF
and MBSF are skipped.
NOTE: UE joins/leaves the multicast group via the user plane signalling is not
supported in this solution.
#### 6.14.1.2 5G MBS Session Start procedure for Architecture alternative 1
and 2
The 5G MBS Session Start procedure establishes the User plane for an MBS
Session for a MBS Multicast/Broadcast service. There are two type of MBS
Session, one is the MBS Multicast Session for the MBS Multicast service,
anther is the MBS Broadcast Session for the MBS Broadcasgt service. For the
MBS Multicast Session, the MB-SMF, MBSF and MBS AF will create and store the
MBS UE Context for each UE during the MBS UE Context Activation procedure,
these MBS UE Contexts can be used to help to create the MBS Session Context
during the 5G MBS Session Start procedure. But for the MBS Broadcast Session,
there is no MBS UE Context Activation procedure and there is no MBS UE Context
for the MBS Session Start procedure, in such case, the network configureation
between the MBS Service Areas and the NF/Network node IDs are used to help to
create the MBS Session Context during the 5G MBS Session Start procedure.
For the MBS Session Stop procedure, the user plane resource for the MBS
service data delivery shall be released. For the MBS multicast service, the
MBS UE Context and MBS Session Context are still kept. i.e. the
RAN/(MB-)SMF/MBSF needs only to release the RAN resource/N4 MBS Session. For
the MBS broadcast service the whole MBS session and its related user plane and
control plane resources are released after the MBS Session Stop.
The MBS Session Start procedure is defined in clause 6.14.2.2 and the MBS
Session Stop procedure is defined in clause 6.14.2.4 for the MBS architecture
alternative 2, but the procedures can also be used to architecture alternative
1, with the MBSF and MB-SMF are colocated and renamed as SMF, MBSU and MB-UPF
are colocated and renamed as UPF, and messages between the MB-SMF and MBSF are
skipped.
### 6.14.2 Procedures
#### 6.14.2.1 5G MBS UE Context Activation procedure for Architecture 1 and 2
Figure 6.14.2.1-1 MBS Multicast UE Context Activation
1\. The UE performs the registration procedure to the 5G network. During the
registration update procedure, the AMF/UE and PCF establishes the AM/UE policy
association connection.
2\. The PCF provides the UE policies (including the URSP rules) to the UE. The
UE gets the MBS Service Announce information and determines the S-NSSAI and
DNN for the MBS Multicast session based on the Multicast IP address of the
Multicast Service information from the URSP rules.
3\. The UE sends the Activate MBS Context Request (MBS IP multicast address,
MBS UE Context ID) within an UL NAS message to an AMF, , the UE also includes
the S-NSSAI and DNN selected in step 2 in the UL NAS message to the AMF.
4\. The AMF selects a MB-SMF based on the S-NSSAI and DNN provided by the UE
and sends the Activate MBS Context Request to the selected MB-SMF via the
Nmbsmf_MBSContextCreate Request (N1 MBS SM Container, S-NSSAI, DNN, SUPI,
GPSI) message.
5\. The MB-SMF checks whether the UE is allowed to activate the MBS Multicast
service based on the UE subscription from the UDM. If the UE subscription is
allowed to use the MBS service identified by the MBS IP multicast address ,
the MB-SMF sends Nmbsf_MBSAuthorization(S-NSSAI, DNN, GPSI, MBS IP multicast
address, MBS UE Context ID,MB-SMF ID) Request message to the MBSF, the MB-SMF
selects the MBSF based on the S-NSSAI, DNN, MBS IP multicast address.
6\. The MBSF may check whether the UE is authorized to use the MBS multicast
service based on the UE subscription from the UDM. If the UE is allowed to use
the MBS Multicast service based on S-NSSAI, DNN, and MBS IP multicast address,
the MBSF sends Nmbsf_MBSAuthorization Notify (S-NSSAI, DNN, MBS IP multicast
address, MBSF ID) to the NEF or directly the MBS AF to request MBS Multicast
service authorisation.
7\. If the NEF receives the message from MBSF, it forwards the authorization
request to the MBS AF via the Nnef_MBSAuthorization Notify(S-NSSAI, DNN, MBS
IP multicast address, MBSF ID) to the MBS AF to request MBS Multicast service
authorization from the MBS AF.
8\. The MBS AF checks whether the MBSF is allowed to support MBS Multicast
Service based on SLA and MBSF provided information of S-NSSAI, DNN, MBS IP
multicast address and MBSF ID. If the MBSF is allowed to support MBS multicast
Service, the MBS AF responses with Nnef_MBSAuthorization Notify Response
(TMGI).
NOTE 1: The TMGI is allocated by the MBS AF in step 8 for Architecture 1, or
is allocated by the MBSF in step 10 for Architecture 2.
9\. The NEF responses to the MBSF with Nmbsf_MBSAuthorization Notify Response
(TMGI).
10\. The MBSF responses to the MB-SMF with Nmbsmf_MBSAuthorization Notify
Response (TMGI).
11\. The MB-SMF responses to the UE via the AMF with
Nmbsmf_MBSContextCreateResponse (N1 MBS SM Container (TMGI)).
12\. The AMF sends the Activate MBS Context Response(TMGI) message to the UE
to indicate the MBS UE Context is successfully activated in the core network.
NOTE 2: For the Architecture alternative 1, the above 5G MBS UE Context
Activation procedure can be defined to the architecture alternative 1, in such
case, the MBSF and MB-SMF are colocated and renamed to SMF, MBSU and MB-UPF
are colocated and renamed to UPF, and messages between the MB-SMF and MBSF
(i.e. steps 5 and 10) are skipped in the Figure 6.14.2.1-1.
#### 6.14.2.2 5G MBS Session Start procedure for Architecture Alternative 1
and 2
Figure 6.14.2.2-1 MBS Session Start Procedure
1\. The MBS AF sends Nnef_MBSSessionStart Request (TMGI, MBSF ID List, Service
Area, QoS Requirements(es), Stream Infor(s), estimated Session Duration,
Session ID, time to MBS data transfer) message to the NEF.
2\. The NEF sends Nmbsf_MBSSessionStart Request (TMGI, Service Area, QoS
Requirements(es), Stream Infor(s), estimated Session Duration, Session ID,
time to MBS data transfer) message to the each MBSF provided by the MBS AF in
step 1.
3\. The MBSF selects a MBSU and sends N4 MBS Session Establishment () to
request MBSU to allocate MBS Session user plane resources.
4\. The MBSF sends Npcf_MBSSessionStart Request (MB-SMF ID, QoS
Requirements(es), Stream Infor(s), estimated Session Duration, Session ID,
time to MBS data transfer) to the PCF, the MBSF selects the PCF based on the
MB-SMF ID in the MBSF MBS UE Context for the MBS Multicast Session or based on
the service area configuration for the MBS Broadcast Session.
5\. The PCF sends Nmbsmf_MBSSessionStart Request(TMGI, Service Area, QoS
Rules, estimated Session Duration, Session ID, time to MBS data transfer)
message to the MB-SMF, the PCF selects the MB-SMF based on the MB-SMF ID
provided by the MBSF in the step 4.
6\. The MBSF selects a MB-UPF and sends N4 MBS Session Establishment () to
request MB-UPF to allocate MBS Session user plane resources.
7\. The MB-SMF sends Namf_Communication_N2MBSMessageTransfer (RAN IDï¼ŒN2 MBS SM
Container(TMGI, QoS profile(s), MBS QFI(s)), etc.) to the AMF.
8\. The AMF sends N2 MBS Session Start Request(S-NSSAIï¼ŒTMGI, QoS Profile(s),
MBS QFI(s),...) message to the RAN.
9\. The RAN sends MBS Session Start Response() message to the AMF.
10\. The RAN allocates the radio resources for the MBS Session to support
different MBS QoS Flows with different QoS profiles.
11\. The AMF sends Namf_Communication_N2MBSMessageTransferNotify() to the MB-
SMF.
12\. The MB-SMF sends Nmbsmf_MBSSessionStart Response() message to the PCF.
13\. The PCF sends Npcf_MBSSessionStart Response() message to the MBSF.
14\. The MBSF sends Nmbsf_MBSSessionStart Response() message to the NEF.
15\. The NEF sends Nnef_MBSSessionStart Response() message to the MBS
Application.
After step 15, the MBS Application can start to send MBS data to MBSU, the MBS
application data is then forwarded to MB-UPF , RAN and finally to the UE.
NOTE: For the Architecture alternative 1, the 5G MBS Session Start procedure
can be used to the architecture alternative 1, in such case, he MBSF and MB-
SMF are colocated and renamed to SMF, MBSU and MB-UPF are colocated and
renamed to UPF, and messages between the MB-SMF and MBSF (i.e. steps 3, 4, 5,
12 and 13) are skipped in Figure 6.14.2.2-1.
#### 6.14.2.3 5G MBS UE Context Deactivation procedure for Architecture
Alternative 1 and 2
Figure 6.14.2.3-1 MBS Multicast UE Context Deactivation Procedure
1\. The MBS UE Context Activation is executed as described in clause 6.14.2.1.
2\. The UE starts the MBS UE Context Deactivation procedure by sending the NAS
message Deactivate MBS Context Request(MBS UE Context ID) to the AMF.
3\. The AMF sends Nmbsmf_MBSContextRelease Request(UE location information,
MBS UE Context ID) message to the MB-SMF.
4\. If the UE is last UE for the MBS Session in this MB-SMF, the MB-SMF sends
N4 MBS Session Release to the MB-UPF to release the MBS Session user plane
resources.
5\. If the UE is the last UE for the MBS Session in the RAN, the MB-SMF sends
Namf_Communication_N2MBSMessageTransfer (RAN IDï¼ŒN2 MBS SM Container(TMGI) to
the AMF.
6\. The AMF sends N2 MBS Session Stop Request(S-NSSAI, TMGI) message to the
RAN.
7\. The RAN sends MBS Session Stop Response() message to the AMF.
8\. The RAN release the radio resources for the MBS Session. All the resources
for the MBS QoS Flows are released.
9\. The AMF sends Namf_Communication_N2MBSMessageTransferNotify() to the MB-
SMF.
10\. If the UE is the last UE for the MBS Session in the MB-SMF, the MB-SMF
sends Nmbsf_MBSSessionRelease Request (MBS UE Context ID,TMGI) message to the
MBSF.
11\. If the UE is last UE for the MBS Session in this MBSF, the MBSF sends N4
MBS Session Release to the MBSU to release the MBS Session user plane
resources.
12\. If the UE is last UE for the MBS Session in this MBSF, the MBSF sends
Nmbsf_MBSSessionRelease Notify(TMGI) to the NEF. This step is skipped if the
MBS AF is located in trusted domain.
13\. The NEF sends Nnef_MBSSessionRelease Notify(TMGI) to the MBS AF.
14\. The MBS AF stops sending MBS Session data to the MBSU and sends
Nnef_MBSSessionRelease Notify Response() message to the NEF.
15\. The NEF sends Nmbsf_MBSSessionRelease Notify Response() message to the
MBSF.
16\. The MBSF sends Nmbsf_MBSSessionRelease Response() message to the MB-SMF.
17\. The MB-SMF sends Nmbsmf_MBSContextRelease Response() message to the AMF.
18\. The AMF sends NAS Deactivate MBS Context Response() message to the UE.
NOTE: For the Architecture alternative 1, the 5G MBS UE Context Deactivation
procedure can be used to the architecture alternative 1, in such case, the
MBSF and MB-SMF are colocated and renamed to SMF, MBSU and MB-UPF are
colocated and renamed to UPF, and messages between the MB-SMF and MBSF (i.e.
steps 10, 11 and 16) are skipped in Figure 6.14.2.3-1.
#### 6.14.2.4 5G MBS Session Stop procedure for Architecture Alternative 1 and
2
Figure 6.14.2.4-1 MBS Session Stop Procedure
1\. The MBS AF sends Nnef_MBSSessionStop Request (TMGI, Session ID,MBSF ID
List, Service Area) message to the NEF.
2\. The NEF sends Nmbsf_MBSSessionStart Request (TMGI, Session ID) message to
the each MBSF provided by the MBS AF in step 1.
3\. The MBSF sends N4 MBS Session Release () to request MBSU to release MBS
Session user plane resources.
4\. The MBSF sends Npcf_MBSSessionStop Request (TMGI, MB-SMF ID, Session ID)
to the PCF.
5\. The PCF sends Nmbsmf_MBSSessionStopt Request(TMGI, Service Area, Session
ID) message to the MB-SMF.
6\. The MBSF sends N4 MBS Session Release () to request MB-UPF to release MBS
Session user plane resources.
7\. The MB-SMF sends Namf_Communication_N2MBSMessageTransfer (RAN IDï¼ŒN2 MBS SM
Container(TMGI) to the AMF.
8\. The AMF sends N2 MBS Session Stop Request(S-NSSAIï¼ŒTMGI) message to the
RAN.
9\. The RAN sends MBS Session Stop Response() message to the AMF.
10\. The RAN releases all the radio resources for the MBS Session, the
resource for the different MBS QoS Flows are released.
11\. The AMF sends Namf_Communication_N2MBSMessageTransferNotify() to the MB-
SMF.
12\. The MB-SMF sends Nmbsmf_MBSSessionStop Response() message to the PCF.
13\. The PCF sends Npcf_MBSSessionStop Response() message to the MBSF.
14\. The MBSF sends Nmbsf_MBSSessionStop Response() message to the NEF.
15\. The NEF sends Nnef_MBSSessionStop Response() message to the MBS
Application.
NOTE: For the Architecture alternative 1, the 5G MBS Session Stop procedure
can be used to the architecture alternative 1, in such case, he MBSF and MB-
SMF are colocated and renamed to SMF, MBSU and MB-UPF are colocated and
renamed to UPF, and messages between the MB-SMF and MBSF (i.e. steps 3, 4, 5,
12 and 13) are skipped in Figure 6.14.2.4-1.
### 6.14.3 Impacts on services, entities and interfaces
In order to support this solution, the involved network entities need to
support the following functionality.
AMF:
\- (MB-)SMF Selection.
\- MBS Session Management routing between UE/NG-RAN and (MB-)SMF.
NG-RAN:
\- NGAP to support MBS Session Management.
\- Join/Leave the N3 shared transport multicast group.
PCF:
\- Receives the Multicast/Broadcast service information from MBSF.
\- Determines the policy and QoS profile for the Multicast/Broadcast service.
\- Provides DNN and S-NSSAI information to the UE for the Multicast service.
NEF:
\- Distributes the Multicast/Broadcast Start message to multiple DL SMFs.
(MB-)SMF:
\- Receives the Multicast/Broadcast policy Rules from the PCF.
\- Determines the involved PSA UPF and other UPFs.
\- Determines the involved AMF(s);
\- Manage the N3/N9 tunnels for the Multicast/Broadcast session.
\- Determines the involved RAN nodes for the Multicast/Broadcast session.
PSA UPF:
\- Enforce Multicast/Broadcast N4 QoS rule.
\- Distributes the Multicast/Broadcast service data to multiple DL nodes.
UE:
\- Selects the S-NSSAI and DNN for the Multicast Service.
\- New NAS to support MBS Session Management.
## 6.15 Solution #15: Multicast session leg addition due to UE mobility
### 6.15.1 Functional description
This solution addresses KI#1 \"MBS session management\". The architecture of
this solution can be based on the two architecture alternatives (see Annex A).
This solution is based on PDU Session for unicast fall-back may not have been
established or activated in advance.
This solution addresses the case when shared delivery method is used, as well
as source gNB and target gNB are enhanced to support 5G MBS.
The following procedures describes the method that, when UE has active PDU
Sessions (i.e. is in connected state), the UE hands over with MBS session
information for service continuity. If UE is in idle state, the UE needs to
initiate multicast session join via target cell, and lossless service
continuity is not supported, hence if lossless service continuity is required,
the UE shall keep some PDU Sessions active (i.e. stay in connected state).
### 6.15.2 Procedures
#### 6.15.2.1 Xn based leg addition
The following Figure 6.15.2.1-1 illustrates the Xn based procedure of
multicast session path addition due to UE mobility.
Figure 6.15.2.1-1: Xn based multicast session leg addition
1\. The source gNB is involved in the multicast session with shared delivery
method. The UE has active PDU Sessions (if the MBS session requests lossless
service continuity, the UE can keep any PDU session active). The PDU Session
for unicast fallback may be active but only serves unicast traffic, hence the
PDU Session for unicast fallback does not associate with any MBS session.
2\. The UE to source gNB: AN message (interest TMGIs/MBS Session IDs,
measurement report). The AN message could be an enhanced Measurement Report.
3\. Source gNB to target gNB: Xn message (List of \, SMF IDs).
The source gNB determines the target gNB based on the measurement report and
TMGIs received from the UE The source gNB determines to send the enhanced Xn
message to the target gNB when the target gNB is enhanced to support MBS (e.g.
determined based on pre-configuration).
If the source gNB stores the SMF ID of the SMF serves the multicast session
(e.g. provisioned by SMF during previous multicast operations), the SMF ID is
included.
The Xn message does not include any UE AS context if the source gNB cannot get
the UE AS context (e.g. UE moves to the source gNB in idle state without
suspend).
4\. Target gNB to source gNB: Xn message ([Direct Forwarding Tunnel Info],
[Forwarding TMGIs], Multicast Radio Transmission Resource Info).
The target gNB may include Direct Forwarding Tunnel Info in the response.
Besides the PDU Session radio transmission resource information, the target
gNB also includes Multicast Radio Transmission Resource Info in the Xn message
if some of the TMGIs are served with shared delivery method at target gNB. The
Multicast Radio Transmission Resource Info may indicate PTP or PTM will be
used by the target gNB.
If not all of the interest MBS sessions are served by the target gNB with
shared delivery method, as one alternative, the Multicast Radio Transmission
Resource Info will not include information for those TMGIs not served at
target gNB. In order to multiplex forwarded traffic of those TMGIs with the
PDU traffic, the target gNB may take into account of the QoS profile of those
TMGIs for reserving the PDU Session radio transmission resource.
As another alternative, the Multicast Radio Transmission Resource Info
includes information for all allowed TMGIs served and not served at target
gNB, and the target gNB sends N2 message to the AMF including the TMGIs not
served at the target gNB in order to add the target gNB into the corresponding
multicast sessions, e.g. uses steps 2-9 of \"User Multicast Session Join via
AN\" as described in solution 4. The target gNB reserves radio resources for
the TMGIs not served at the target gNB according to the received QoS profile
of those TMGIs from source gNB.
5\. Source gNB to UE: AN message (Multicast Radio Transmission Resource Info).
The source gNB may replicate multicast data corresponding to the Forwarding
TMGIs/MBS Session IDs and sends them to the target gNB via the Direct
Forwarding Tunnel, which is dedicated for the MBS sessions.
6\. UE to the target gNB: AN message ().
If multicast radio resource information related to all interest TMGIs is
received, the UE sends AN message to target gNB, otherwise, the UE sends AN
message as well as NAS Multicast Session Join message to the target gNB.
The NAS Multicast Session Join message (e.g. Service Request/PDU Session
Establishment Request) includes the interest TMGIs.
7\. If the forwarded MBS traffic belongs to a MBS session served by the target
gNB with shared delivery method, if the forwarded packets need to be delivered
to the UE, the target gNB forwards them to the UE via radio resource of a PDU
Session.
Editor\'s note: The need for MBS packet forwarding needs to be confirmed by
RAN. RAN also needs to decide if such forwarded packets can be delivered to
the UE.
8\. Target gNB to AMF: N2 message ().
9\. [Conditional] If the NAS Multicast Session Join message is received, the
AMF initiates multicast session join procedure with the (MB-)SMF and (MB-)UPF
to add the target gNB into the multicast session, e.g. uses step 2-9 of \"User
Multicast Session Join via CN\" as described in solution 4. The (MB-)SMF
selects delivery method for the UE. In case of shared delivery method is
selected, the (MB-)SMF instructs the (MB-)UPF to reserve resources for the
shared CN tunnel.
The target gNB stops forwarding MBS traffic received in the Direct Forwarding
Tunnel based on the NG UP SN matching.
10\. The AMF continues Path Switch procedure for PDU Sessions.
11\. The target gNB stops forwarding MBS data received in the Direct
Forwarding Tunnel based on the NG UP SN matching. If the target gNB stops
forwarding MBS data, it sends Xn message to the source gNB to indicate stop
forwarding.
#### 6.15.2.2 N2 based leg addition
The following Figure 6.15.2.2-1 illustrates the N2 based procedure of
multicast session path addition due to UE mobility.
Figure 6.15.2.2-1: N2 based multicast session leg addition
1\. The source gNB is involved in the multicast session with shared delivery
method. The UE has active PDU Sessions (if the MBS session requests lossless
service continuity, the UE can keep any PDU session active). The PDU Session
for unicast fallback may be active but only serves unicast traffic, hence the
PDU Session for unicast fallback does not associate with any MBS session.
2\. UE to source gNB: AN message (interest TMGIs/MBS Session IDs, measurement
report). The AN message could be an enhanced Measurement Report.
3\. Source gNB to AMF: N2 message (target info, Source to Target Transparent
Container (List of \, SMF IDs)).
The source gNB determines the target gNB based on the measurement report and
TMGIs received from the UE. The source gNB determines to send the enhanced N2
message to the target gNB when the target gNB is enhanced to support MBS (e.g.
determined based on pre-configuration).
If the source gNB stores the SMF IDs of the SMF serves the multicast session
(e.g. provisioned by SMF during previous multicast operations), the SMF IDs
are included.
The enhanced N2 message does not include any UE context if the source gNB
cannot get the UE AS context (e.g. UE moves to the source gNB in idle without
suspend state).
The AMF also performs step 4-8 of normal N2 based handover procedure for all
PDU Sessions as described in clause 4.9.1.3.2 of TS 23.502 [8].
4\. The AMF to target gNB: N2 message (Source to Target Transparent Container,
N2 SM Info).
5\. Target gNB to AMF: N2 message (Target to Source Transparent Container
([Forwarding TMGIs], Multicast Radio Transmission Resource Info), [SMF IDs],
N2 MB Info (Forwarding Tunnel Info)).
The target gNB may include Forwarding Tunnel Info dedicated for MBS sessions
in the response. Besides the PDU Session radio transmission resource
information, the target gNB also includes Multicast Radio Transmission
Resource Info in the Transparent Container if some of the TMGIs are served
with shared delivery method at target gNB. The Multicast Radio Transmission
Resource Info may indicate PTP or PTM will be used by the target gNB.
If not all of the interest MBS sessions are served by the target gNB with
shared delivery method, as one alternative, the Multicast Radio Transmission
Resource Info will not include information for those TMGIs not served at
target gNB. In order to multiplex forwarded traffic of those TMGIs with shared
delivery method with the PDU traffic, the target gNB may take into account of
the QoS profile of those TMGIs for reserving the PDU Session radio
transmission resource.
As another alternative, the Multicast Radio Transmission Resource Info
includes information for all allowed TMGIs served and not served at target
gNB, and the target gNB sends N2 message (separate N2 message or combined N2
message) to the AMF including the TMGIs not served at the target gNB in order
to add the target gNB into the corresponding multicast sessions, e.g. uses
steps 2-9 of \"User Multicast Session Join via AN\" as described in solution
4. The target gNB reserves radio resources for the TMGIs not served at the
target gNB according to the received QoS profile of those TMGIs from source
gNB or from 5GC in step 4.
6\. The AMF forwards the N2 MB Info to the (MB-)SMF according the SMF ID
received in step 5 for reserving forwarding resources, e.g. uses step 13-15 of
\"User Multicast Session Join via AN\" as described in solution 4.
The AMF also performs step 11 of normal N2 based handover procedure for all
PDU Sessions as described in clause 4.9.1.3.2 of TS 23.502 [8].
Editor\'s note: The need for MBS packet forwarding needs to be confirmed by
RAN. RAN also needs to decide if such forwarded packets can be delivered to
the UE.
7\. AMF to source gNB: N2 message (Target to Source Transparent Container, N2
SM Info, [N2 MB Info]).
8\. Source gNB to UE: AN message (Multicast Radio Transmission Resource Info)
The source gNB may replicate multicast data corresponding to the Forwarding
TMGIs/MBS Session IDs and sends them to the target gNB via the Direct/Indirect
Forwarding Tunnel, which is dedicated for the MBS sessions.
9\. UE to target gNB: AN message ().
If multicast radio resource information related to all interest TMGIs is
received, the UE sends AN message to target gNB, otherwise, the UE sends AN
message as well as NAS Multicast Session Join message to the target gNB.
The NAS Multicast Session Join message (e.g. Service Request/PDU Session
Establishment Request) includes the interest TMGIs.
10\. If the forwarded MBS traffic belongs to a MBS session served by the
target gNB with shared delivery method, if the forwarded packets need to be
delivered to the UE, the target gNB forwards them to the UE via radio resource
of a PDU Session.
11\. Target gNB to AMF: N2 message ().
12\. [Conditional] If the NAS Multicast Session Join message is received, the
AMF initiates multicast session join procedure with the (MB-)SMF and (MB-)UPF
to add the target gNB into the multicast session, e.g. uses step 2-9 of \"User
Multicast Session Join via CN\" as described in solution 4. The (MB-)SMF
selects delivery method for the UE. In case of shared delivery method is
selected, the (MB-)SMF instructs the (MB-)UPF to reserve resources for the
shared CN tunnel.
The target gNB stops forwarding MB data received in the Direct/Indirect
Forwarding Tunnel based on the NG UP SN matching. The source gNB stops data
forwarding after a specific time.
13\. The AMF continues handover execution procedure for PDU Sessions.
### 6.15.3 Impacts on services, entities and interfaces
UE:
\- Support sending Measurement Report including interest MBS Session IDs.
\- Support handling AN message including multicast radio resource information.
RAN node:
\- (Source) Support sending MBS Session ID and associated multicast QoS
profile to the target RAN node.
\- (Source) May support replicating multicast data via shared delivery method
and forwarding to target RAN node.
\- (Source) Support sending MBS Session ID to the 5G CN.
\- (Target) Support responding multicast radio resource information to the
source RAN node.
\- (Target) Support multiplexing forwarded multicast traffic with forwarded
PDU traffic over radio.
## 6.16 Solution #16: MBS session joining via PDU session establishment and
modification procedures
### 6.16.1 Functional description
This solution addresses Key Issue #1 \"MBS session management\" based on the
baseline architecture 1 in clause A.1. This solution also addresses some
aspects of Key Issue #3.
This solution is similar to Solution 3 in that the same concepts of integrated
unicast and multicast session management, MBS session context (Multicast
session context), etc. are used; while different from solution 3, this
solution also proposes the following procedures and mechanisms:
\- UE joining an MBS service via PDU session establishment procedure;
\- SMF selection for an MBS session, where the SMF registers/updates its
capability of supporting MBS as well as the information of MBS session(s)
currently served by the SMF to the NRF and the AMF/SMF queries the NRF for SMF
selection during PDU session establishment/modification procedure;
\- Policy control for the MBS session, where the PCF provides MBS related
policy in PCC rules to the SMF for MBS session management.
### 6.16.2 Procedures
#### 6.16.2.1 MBS session joining via PDU Session Establishment procedure
The UE has successfully registered to the PLMN and has the information of MBS
service based on pre-configuration (e.g. installed application(s)), SIB or
information from previous MBS sessions, etc. The UE may initiate MBS session
join procedure via the PDU Session Establishment procedure, e.g. triggered by
application layer request, as shown in Figure 6.16.2.1-1.
NOTE 1: In the procedure, instead of using the existing SMF services for PDU
Session, new SMF services for MBS Session may be defined and used, e.g.
Nsmf_MBSSession_CreateSMContext, Nsmf_MBSSession_UpdateSMContext,
Nsmf_MBSSession_Create, Nsmf_MBSSession_Update, as shown in Figure 6.16.2.1-1.
Figure 6.16.2.1-1: MBS session joining via PDU Session Establishment procedure
1\. The UE sends an UL NAS TRANSPORT (S-NSSAI(s), DNN, PDU Session ID, Request
type, MBS information, N1 SM container (PDU Session Establishment Request) )
message to the AMF. The MBS information identifies the MBS service that the UE
wants to join and can be a multicast address and/or TMGI.
2\. The AMF checks whether it has an MBS session context for the MBS service
requested by the UE (i.e. an MBS session may have been established via the AMF
for other UE(s) with the same MBS information) and if so, selects the SMF
according to the MBS session context. Otherwise, the AMF queries the NRF for
SMF discovery by issuing the Nnrf_NFDiscovery_Request including the MBS
information and possibly other information, i.e. the S-NSSAI and the
associated NSI ID (if available), DNN, service area information (TA(s)) based
on UE location, etc. Based on the SMF information in the
Nnrf_NFDiscovery_Request response from the NRF, the AMF selects the SMF
serving the requested MBS session if exists, or an MBS-capable SMF.
3a. If the service area of the selected SMF includes the location where the UE
camps, the AMF invokes the Nsmf_PDUSession_CreateSMContext Request (SUPI,
S-NSSAI(s), DNN, PDU Session ID, AMF ID, Request Type, MBS information, UE
location information, N1 SM container (PDU Session Establishment Request))
towards the selected SMF.
3b-1-3b-3. If the service area of the selected SMF does not include the
location where the UE camps, the AMF selects an I-SMF that serves the area
where UE camps. The AMF invokes the Nsmf_PDUSession_CreateSMContext Request
(SUPI, S-NSSAI(s), DNN, PDU Session ID, AMF ID, Request Type, MBS information,
UE location information, N1 SM container (PDU Session Establishment Request),
identity of the selected SMF) towards the I-SMF. The I-SMF selects an I-UPF
and performs N4 session establishment procedure. The I-SMF invokes the
Nsmf_PDUSession_Create Request with the MBS information towards the selected
SMF.
4\. The SMF retrieves the Session Management Subscription data including MBS
related subscription data from the UDM and also subscribes to be notified when
this subscription data is modified for MBS service.
The SMF checks the validity of the UE request for the MBS service, e.g. if the
requested MBS corresponds to an MBS service area, whether the UE is located in
the MBS service area based on UE location information.
If the UE\'s request for the MBS service is valid, the SMF checks whether an
MBS Session context exists for the MBS service requested by the UE based on
the multicast address or TMGI. If such an MBS Session context exists, the SMF
updates the MBS Session context and adds the UE as a member of the MBS
session; otherwise the SMF creates an MBS session context for the MBS service
requested by the UE and adds the UE as a member of the MBS session.
5\. The SMF may perform an SM Policy Association Establishment or Modification
procedure by invoking the Npcf_SMPolicyControl_Create or
Npcf_SMPolicyControl_Update Request towards the PCF and get the MBS related
PCC Rules.
6\. The SMF sends an N4 Session Establishment/Modification Request to the UPF,
to provide N4 rules (i.e. packet detection, QoS enforcement and reporting
rules) to the UPF and establish/modify the N3/N9 tunnel for the MBS session.
7a. If the SMF serves the UE directly, the SMF invokes the
Namf_Communication_N1N2MessageTransfer (PDU Session ID, MBS session context
information, N2 SM information (PDU Session ID, MBS session context
information, QFI(s), QoS Profile(s), CN Tunnel Info, S-NSSAI, PDU Session
Type), N1 SM container (PDU Session Establishment Accept)) to the AMF.
7b-1-7b-2. If the SMF serves the UE via the I-SMF, the SMF invokes the
Nsmf_PDUSession_Create Response (PDU Session ID, MBS session context
information, CN Tunnel Info, QFI(s), QoS profile(s)) to the I-SMF. The I-SMF
invokes the Namf_Communication_N1N2MessageTransfer (PDU Session ID, MBS
session context information, N2 SM information (PDU Session ID, MBS session
context information, QFI(s), QoS Profile(s), CN Tunnel Info, S-NSSAI, PDU
Session Type), N1 SM container (PDU Session Establishment Accept)) to the AMF.
8\. The AMF creates/updates the MBS session context and sends the N2 PDU
Session Request to the NG-RAN.
9\. The NG-RAN establishes/modifies the AN resources for the MBS session, i.e.
selecting/updating the multicast or unicast radio bearers towards the UE, and
also creates/updates the N3 tunnel information towards the UPF. The NG-RAN
also forwards the NAS message containing PDU Session Establishment Accept to
the UE.
10\. The NG-RAN sends the N2 PDU Session Response to the AMF.
11a-13a. If the SMF serves the UE directly, the AMF invokes the
Nsmf_PDUSession_UpdateSMContext Request to the SMF. The SMF initiates the N4
Session Modification procedure with the UPF to provide/update AN Tunnel Info
as well as N4 rules. The SMF sends the Nsmf_PDUSession_UpdateSMContext
Response to the AMF.
11b-13b. If the SMF serves the UE via the I-SMF, the AMF invokes the
Nsmf_PDUSession_UpdateSMContext Request to the I-SMF. The I-SMF initiates the
N4 Session Modification procedure with the I-UPF to provide/update AN Tunnel
Info, CN Tunnel Info as well as N4 rules. The I-SMF sends the
Nsmf_PDUSession_UpdateSMContext Response to the AMF.
#### 6.16.2.2 MBS session joining via PDU Session Modification procedure
The UE has successfully registered to the PLMN and established an PDU session.
The UE may get the information of MBS service based on pre-configuration (e.g.
installed application(s)), SIB, information from previous MBS sessions, or via
the application layer interactions over the user plane of the PDU session.
Then the UE may initiate MBS session joining procedure via the PDU Session
Modification procedure, as shown in Figure 6.16.2.2-1.
NOTE 1: In the procedure, compared with solution 3, the SMF serving the PDU
session (i.e. old SMF) is equivalent to SMF1, and the selected SMF for MBS
session is equivalent to SMF2.
NOTE 2: In the procedure, instead of using the existing SMF services for PDU
Session, new SMF services for MBS Session may be defined and used, e.g.
Nsmf_MBSSession_CreateSMContext, Nsmf_MBSSession_UpdateSMContext,
Nsmf_MBSSession_Create, Nsmf_MBSSession_Update, as shown in Figure 6.16.2.2-1.
Figure 6.16.2.2-1: MBS session joining via PDU Session Modification procedure
0\. The UE establishes a PDU session and may receive MBS service configuration
information in application layer via the user plane of the PDU session. Later
on, the UE requests to join an MBS session via the following Alternative 1
(User Plane signalling) or Alternative 2 (Control Plane signalling).
Steps 1a-2a for Alternative 1 (User Plane signalling)):
1a. The UE sends a multicast Join message (e.g. IGMP Join) via the User Plane
of the PDU session. Upon detection of the multicast Join message, the UPF
sends a notification including the information in the multicast Join message
(i.e. MBS information which identifies the MBS service that the UE wants to
join, e.g. a multicast address) to the SMF serving the PDU session.
2a. If the SMF serving the PDU session supports MBS service, the SMF checks
the validity of the UE request for the MBS service based on e.g. MBS related
subscription data of the UE, whether the UE is located in the MBS service area
for the request MBS service. If the request is valid, the SMF checks whether
it has an MBS session context for the MBS service requested by the UE (i.e. an
MBS session may have been established via the SMF for other UE(s) with the
same MBS information), and if so, the SMF updates the MBS Session context and
adds the UE to the MBS session, and continues with step 5 or step 6.
If the SMF serving the PDU session does not support MBS service or has no MBS
session context for the MBS service requested by the UE, the SMF queries the
NRF for SMF discovery by issuing the Nnrf_NFDiscovery_Request including the
MBS information and possibly other information, i.e. the S-NSSAI and the
associated NSI ID (if available), DNN, service area information (TA(s)) based
on UE location, etc. Based on the SMF information in the
Nnrf_NFDiscovery_Request response from the NRF, the SMF selects the SMF
serving the requested MBS session if exists, or an MBS-capable SMF if the SMF
serving the PDU session does not support MBS service. The SMF invokes
Nsmf_PDUSession_SMContextStatusNotify with the MBS Session ID and identity of
selected SMF towards the AMF. The procedure continues with step 3.
If the SMF serving the PDU session supports MBS service and no SMF serving the
requested MBS session exists, the SMF creates an MBS session context for the
MBS service requested by the UE and adds the UE to the MBS session, and
continues with step 5.
Steps 1b-2b for Alternative 2 (Control Plane signalling)):
1b. The UE sends an UL NAS TRANSPORT (S-NSSAI(s), DNN, PDU Session ID, Request
type, MBS information, N1 SM container (PDU Session Modification Request) )
message to the AMF. The MBS information identifies the MBS service that the UE
wants to join and can be a multicast address and/or TMGI.
2b. The AMF checks whether it has an MBS session context for the MBS service
requested by the UE (i.e. an MBS session may have been established via the AMF
for other UE(s) with the same MBS information) and if so, selects the SMF
serving the requested MBS session according to the MBS session context.
If the AMF has no MBS session context for the MBS service requested by the UE,
the AMF queries the NRF for SMF discovery by issuing the
Nnrf_NFDiscovery_Request including the MBS information and possibly other
information, i.e. the S-NSSAI and the associated NSI ID (if available), DNN,
service area information (TA(s)) based on UE location, etc. Based on the SMF
information in the Nnrf_NFDiscovery_Request response from the NRF, the AMF
selects the SMF serving the requested MBS session if exists, or an MBS-capable
SMF. If no SMF serving the requested MBS session exists and the SMF serving
the PDU session supports MBS service, then the SMF serving the PDU session is
selected.
If the selected SMF is the same as the SMF serving the PDU session, then the
procedure continues with step 5 or 6; otherwise, the procedure continues with
step 3.
The following steps are common for both Alternative 1 (User Plane) and
Alternative 2 (Control Plane):
3a-1. Same as step 3a in Figure 6.16.2.1-1.
3b-1-3b-3. If the service area of the selected SMF does not include the
location where the UE camps, the AMF selects the SMF serving the PDU session
as an I-SMF. The AMF invokes the Nsmf_PDUSession_UpdateSMContext Request (SM
Context ID, MBS information, UE location information, N1 SM container (PDU
Session Modification Request), identity of the selected SMF) towards the
I-SMF. The I-SMF reuses the existing UPF or selects a new I-UPF and performs
N4 session modification/establishment procedure. The I-SMF invokes the
Nsmf_PDUSession_Create Request with the MBS information towards the selected
SMF.
4-13. Same as steps 4-13 in Figure 6.16.2.1-1, with the differences that the
N1 SM container/NAS message to the UE contains PDU Session Modification
Command instead of PDU Session Establishment Accept, and the UE acknowledges
the PDU Session Modification Command by sending a NAS message containing PDU
Session Modification Command Ack.
#### 6.16.2.3 SMF selection
When an MBS session is established for an MBS service, the MBS session
contexts are created in the SMF, AMF, NG-RAN and UE. The SMF performs the MBS
session management, and each MBS session context is managed by one SMF (with
or without I-SMF).
To facilitate the SMF discovery/selection for one MBS session, the following
mechanism is proposed:
\- The SMF registers its capability of supporting MBS service as part of its
profile to the NRF. In addition, when the first UE joins an MBS service, the
SMF creates the MBS session context and registers the MBS session information,
i.e. information that uniquely identifies the MBS service (e.g. multicast
address and/or TMGI), towards the NRF.
\- When other UEs joins the MBS session via PDU session establishment or
modification procedures, the AMF or the SMF serving the PDU session invokes
the Nnrf_NFDiscovery_Request including the MBS session information provided by
the UE and possibly other information, i.e. the S-NSSAI and the associated NSI
ID (if available), DNN, service area information (TA(s)) based on UE location,
etc., to query the NRF for SMF information.
\- Based on the MBS information and other information for query, the NRF
decides whether an SMF serving the MBS session exists. If so, the NRF provides
in Nnrf_NFDiscovery_Request response the information of the SMF currently
serving the MBS session. Otherwise, the NRF provides in
Nnrf_NFDiscovery_Request response the information of one or more SMFs which
supports MBS service.
\- The AMF or the SMF serving the PDU session selects the SMF currently
serving the MBS session if exists, or an SMF which supports MBS service, based
on the SMF information provided by the NRF. If no SMF serving the requested
MBS session exists and the SMF serving the PDU session supports MBS service,
then the SMF serving the PDU session is selected.
\- When the MBS session context is deleted from the SMF, e.g. due to MBS
session release, the SMF updates the MBS session information it currently
serves towards the NRF, i.e. removing the MBS session information which is no
longer served by the SMF.
### 6.16.3 Impacts on services, entities and interfaces
UE:
\- The UE supports joining an MBS service/session via the PDU Session
Establishment/Modification procedures, by including the MBS information in UL
NAS TRANSPORT message or using an user plane multicast join message.
SMF:
\- The SMF supports MBS session management, including creating, maintaining
and releasing the MBS session context. The SMF registers/updates the
information of the MBS session(s) it currently serves as well as MBS
capability to the NRF. If the UE initiates MBS session joining via the User
Plane using the PDU Session Modification procedure, the SMF serving the PDU
session may query the NRF for the SMF currently serving the MBS session, and
indicate this new SMF (as the selected SMF for the MBS session) to the AMF.
AMF:
\- The AMF maintains an MBS session context including the information of
SMF(s) and NG-RAN(s) involved in the MBS session. The AMF supports SMF
selection for an MBS session by querying the NRF for the SMF currently serving
the MBS session.
NRF:
\- The NRF provides the information of the SMF currently serving an MBS
session (if exists) or an SMF with MBS capability upon the request from the
AMF/SMF.
PCF:
\- The PCF provides MBS related PCC Rules to the SMF.
UPF:
\- The UPF enforces the packet detection, QoS enforcement and reporting rules
for the MBS session, and establishes/modifies the N3/N9 tunnel to support
multicast transport.
NG-RAN:
\- The NG-RAN establishes/modifies the AN resources for the MBS session, i.e.
selecting/updating the multicast or unicast radio bearers towards the UE, and
also creates/updates the N3 tunnel information for multicast transport towards
the UPF.
## 6.17 Solution #17: QoS support for MBS service
### 6.17.1 Functional description
This solution addresses Key Issue #4 \"QoS level support for Multicast and
Broadcast communication services\" based on the baseline architecture 1 in
clause A.1. By addressing the aspects of KI#4, it is complementary to other
solutions to KI#1 and #7.
The 5G QoS model as defined in TS 23.501 [2] clause 5.7 also applies to MBS
service, with the following differences:
\- Reflective QoS is not applicable.
\- UPF transmits the PDUs of the MBS Session in a shared or individual tunnel
between 5GC and (R)AN.
\- Wireline access network specific 5G QoS parameters do not apply to MBS
services (See clause 4.1).
\- Alternative QoS Profile is not applicable.
\- Notification Control is not applicable.
NOTE 1: MBS services over non-3GPP access is not specified in this release
(See clause 4.1).
During MBS session establishment procedure, either triggered by the network
starting an MBS session or by the UE joining an MBS session, the AF provides
MBS session information to the PCF directly or via other NFs e.g. SMF serving
the MBS session, MB-SMF or others, including QoS requirements for the MBS
service data flows. Based on the MBS session information, the PCF determines
PCC rules for the MBS session, which includes QoS parameters for
multicast/broadcast mode and optionally QoS parameters for unicast mode to
e.g. facilitate delivery mode switching in the CN or the NG-RAN. The SMF,
based on PCC rules from the PCF for the MBS session (if dynamic PCC is
deployed) or local policy (if dynamic PCC is not deployed), determines the QoS
profiles and N4 rules for the MBS session with QoS parameters for
multicast/broadcast mode (e.g. IP Multicast Addressing Info, see TS 29.244
[17]), and provides to the RAN and the UPF respectively. Based on these, the
UPF adapts the existing mechanisms of user plane management (e.g. packet
detection, QoS enforcement and reporting) for the MBS session.
NOTE 2: The PCF provisions PCC rules to the SMF serving the MBS session and
the SMF serving the PDU session associated with the MBS session, which can be
the same SMF or different SMFs depending on the solution/conclusion to Key
Issue#1 \"MBS session management\".
NOTE 3: The actual NFs or only NG-RAN that triggers delivery mode switching
depends on the solution/conclusion to Key Issue #7 \"Reliable delivery method
switching between unicast and multicast\".
In the DL, the UPF performs QoS enforcement based on N4 rules for the MBS
session provided by the SMF. The AN binds the QoS Flows of the MBS session to
RAN resources (i.e. multicast/broadcast Radio Bearers or unicast Data Radio
Bearers). It is up to the RAN to establish the necessary RAN resources that
QoS Flows for MBS service can be mapped to, to dynamically switch between the
multicast/broadcast and unicast AN resources for QoS Flows of MBS service, and
to release them. The RAN shall indicate to the SMF when the AN resources onto
which a QoS Flow of MBS service is mapped are released.
NOTE 4: Depends on the solution/conclusion for key issue 7, RAN may indicate
to the SMF when the AN resources onto which a QoS Flow of MBS service is
mapped are switched from multicast/broadcast to unicast or vice versa, in
order to e.g. aid decisions on delivery mode switching in 5GC, indicate the
cases of AN resource release for MBS service, and/or facilitate the network
analytics on MBS services.
### 6.17.2 Procedures
Void.
### 6.17.3 Impacts Analysis
AF:
\- The AF provides the MBS session information including QoS requirements to
the 5GC.
PCF:
\- The PCF provides PCC rules for the MBS session, which includes QoS
parameters for multicast/broadcast mode and optionally QoS parameters for
unicast mode, to the SMF.
SMF:
\- The SMF determines the QoS profiles and N4 rules for the MBS session with
QoS parameters for multicast/broadcast mode and for unicast mode, and provides
to the RAN and the UPF respectively.
UPF:
\- The UPF performs QoS enforcement based on N4 rules for the MBS session.
NG-RAN:
\- The NG-RAN binds the QoS Flows of the MBS session to AN resources (i.e.
multicast/broadcast Radio Bearers or unicast Data Radio Bearers). Depends on
the solution/conclusion, the NG-RAN may indicate to the SMF when the AN
resources onto which a QoS Flow of MBS service is mapped are released or
switched from multicast to unicast (or vice versa).
## 6.18 Solution #18: MBS assistance information to RAN for delivery mode
switching
### 6.18.1 Functional description
This solution addresses Key Issue #7 \"Reliable delivery mode switching
between unicast and multicast\". This solution can be based on architecture
Alt.1, Alt. 2 or the adopted baseline architecture (clause A.3).
In the following functional descriptions, procedures and impacts analytics of
this solution, the SMF refers to the MB-SMF.
The NG-RAN needs to determine the delivery method of AN resources (i.e. PTP or
PTM delivery method) for the MBS service, and may dynamically switch the
delivery method between PTM and PTP.
To assist the NG-RAN in deciding the delivery mode of AN resources for MBS
services, the CN provides MBS assistance information to the NG-RAN. The MBS
assistance information may include:
\- suggested number of UEs for multicast delivery. When the number of UEs
receiving or interested in the MBS service in a cell or in the NG-RAN node
reaches this number, multicast delivery method is preferable;
\- number of UEs receiving or interested in the MBS service in a cell of the
NG-RAN node or in the NG-RAN node, based on the statistics or prediction by
the CN;
\- delivery method information for an MBS session or QoS flow, e.g. whether
PTP and/or PTM delivery method are allowed;
\- NG-RAN performance, e.g. congestion status, communication performance,
based on the statistics or prediction by the CN;
\- suggested delivery method based on NG-RAN performance;
\- information of MBS services/groups subscribed by the UE, e.g. TMGI;
\- UE capabilities, e.g. whether the UE supports multicast/broadcast delivery
method;
\- Indication of whether data forward is needed during mode switching from
5GC;
\- etc.
Editor\'s note: Whether the above information from the CN can assist in RAN
decision of switching between PTP and PTM needs to be confirmed by RAN group.
The MBS assistance information is determined by the CN based on MBS service
information, MBS related PCC policy, UE subscription and capabilities on MBS
services, etc. The AF provides MBS service parameters, which may include the
information of allowed/preferred delivery method(s) taking into account of the
MBS service/application requirements including whether lossless switching via
data forwarding is needed, to the PCF. The PCF, based on MBS service
information and other information (e.g. network performance, local
configuration), decides the MBS related PCC policy and provides to the SMF.
Based on the MBS related PCC policy or local policy, UE subscription data, UE
capabilities, data forwarding indication, etc., the SMF decides the MBS
assistance information.
The MBS assistance information can be determined and dynamically updated also
based on network analytics. That is, the AF, PCF and SMF can subscribe or
request from the NWDAF the analytics information on \"Service Experience\",
\"Network Performance\" and/or \"User Data Congestion Analytics\", etc., as
specified in TS 23.288 [9], and then determine/update the MBS service
parameters, MBS related PCC policy and MBS assistance information based on the
analytics information.
The MBS assistance information can be provided by the SMF to the RAN via the
AMF during the procedures of MBS service configuration, session start and/or
PDU session establishment/modification associated with MBS service, etc. Based
on the MBS assistance information, the NG-RAN determines for the MBS session
the delivery method of AN resources, or dynamically switches the delivery
method of AN resources from unicast to multicast (or vice versa).
Table 6.18.1-1 gives more information on MBS assistance information, including
NF(s) generating the MBS assistance information, descriptions and
recommendation for specification in Rel-17.
Table 6.18.1-1: MBS assistance information
+----------------+----------------+----------------+----------------+ | MBS assistance | NF(s) | Descriptions | Recommended | | information | generating | | for | | | this MBS | | specification | | | assistance | | in Rel-17 | | | information | | | +================+================+================+================+ | Suggested | PCF/SMF | When the | Y. Centralized | | number of UEs | | number of UEs | policy may | | for multicast | | receiving or | simplify | | delivery | | interested in | NG-RAN | | | | the MBS | i | | | | service in a | mplementation. | | | | cell or in the | | | | | NG-RAN node | | | | | reaches this | | | | | number, | | | | | multicast | | | | | delivery mode | | | | | is preferable. | | | | | | | | | | Decided by the | | | | | PCF based on | | | | | e.g. local | | | | | policy, | | | | | analytics | | | | | information, | | | | | and provided | | | | | to the SMF (if | | | | | dynamic PCC is | | | | | deployed); or | | | | | decided by the | | | | | SMF based on | | | | | local policy | | +----------------+----------------+----------------+----------------+ | Number of UEs | SMF | The statistics | N. Can be | | interested in | | or predicted | counted | | the MBS | | number of UEs | locally in | | s | | interested in | NG-RAN. | | ervice/session | | the MBS | | | | | s | | | | | ervice/session | | | | | in a cell or | | | | | in the NG-RAN | | | | | node. | | | | | | | | | | Decided by the | | | | | SMF based on | | | | | the report | | | | | from the AMF | | | | | or analytics | | | | | information | | | | | from the | | | | | NWDAF. | | +----------------+----------------+----------------+----------------+ | Delivery | PCF/SMF | Only allowed | Y. | | method | | delivery | Se | | information | | method can | rvice/operator | | for an MBS | | apply to the | specific | | session or QoS | | MBS Session or | requirements | | flow, e.g. | | QoS flow. | can be | | whether PTP | | | provided. | | and/or PTM | | Decided by the | | | delivery mode | | PCF based on | | | are allowed | | e.g. service | | | | | information | | | | | from the AF | | | | | and/or | | | | | operator | | | | | policy, and | | | | | provided to | | | | | the SMF (if | | | | | dynamic PCC is | | | | | deployed); or | | | | | decided by the | | | | | SMF based on | | | | | local policy. | | +----------------+----------------+----------------+----------------+ | NG-RAN | NWDAF | NG-RAN can | N. Can be | | performance, | | decide the | measured | | e.g. | | delivery mode | locally in | | congestion | | based on | NG-RAN. | | status, | | NG-RAN | (Prediction is | | communication | | performance | unavailable.) | | performance, | | (and other | | | based on the | | information). | | | statistics or | | | | | prediction by | | Generated by | | | the CN | | the NWDAF, | | | | | e.g. based on | | | | | the Network | | | | | Performance | | | | | analytics as | | | | | defined in TS | | | | | 23.288, and | | | | | provide to the | | | | | SMF and PCF. | | +----------------+----------------+----------------+----------------+ | Suggested | PCF/SMF | Recommended | N. Can be | | delivery mode | | delivery mode | decided by | | based on | | (PTP or PTM) | NG-RAN. | | NG-RAN | | based on | | | performance | | NG-RAN | | | | | performance. | | | | | | | | | | Decided by the | | | | | PCF based on | | | | | e.g. local | | | | | policy and | | | | | analytics | | | | | information, | | | | | and provided | | | | | to the SMF (if | | | | | dynamic PCC is | | | | | deployed); or | | | | | decided by the | | | | | SMF based on | | | | | local policy | | +----------------+----------------+----------------+----------------+ | Information of | SMF | Only allow the | Y. Related to | | MBS | | UE to join an | whether PTM | | s | | MBS Session of | delivery | | ervices/groups | | the subscribed | method can be | | subscribed by | | servic | used for the | | the UE, e.g. | | e(s)/group(s). | UE. | | TMGI | | | | | | | Decided by the | | | | | SMF based on | | | | | the UE MBS | | | | | group | | | | | affiliation | | | | | data from the | | | | | UDM/UDR or the | | | | | PCF. | | +----------------+----------------+----------------+----------------+ | UE | SMF | The PTM | Y. Related to | | capabilities, | | delivery mode | whether PTM | | e.g. whether | | can be used | delivery | | the UE | | only if the UE | method can be | | supports PTM | | supports it. | used for the | | delivery mode | | | UE. | | | | Decided by the | | | | | SMF, e.g. | | | | | based on the | | | | | UE MBS | | | | | capability | | | | | indicated in | | | | | the NAS | | | | | message which | | | | | is forwarded | | | | | to the SMF by | | | | | the AMF. | | +----------------+----------------+----------------+----------------+ | Indication of | PCF/SMF | Whether data | Y. Related to | | data | | forwarding is | whether data | | forwarding | | needed can be | forwarding is | | | | indicated by | needed during | | | | AF to PCF, and | switching and | | | | the SMF | NG-RAN AN | | | | receives this | source usage | | | | indication | | | | | from the PCF. | | +----------------+----------------+----------------+----------------+
NOTE 1: The suggested number of UEs for multicast delivery may be dynamically
adjusted based on the analytics information, e.g. network performance
analytics, from the NWDAF, to cope with e.g. different load conditions in
different RAN coverage.
NOTE 2: The suggested number of UEs for multicast delivery may not be
appropriate for all the cells, considering e.g. different radio and/or load
conditions in different cells. When selecting the PTP or PTM delivery method
using the assistance information, the RAN also takes into account of its local
condition (e.g. radio condition, load, etc.). How the RAN performs such
coordination is implementation dependent.
### **6.18**.2 Procedures
Figure 6.18.2-1: Provision of MBS assistance information to RAN
0\. The AF, PCF and/or SMF may subscribe or request network analytics
information on \"Service Experience\", \"Network Performance\" and/or \"User
Data Congestion Analytics\", etc., from the NWDAF as specified in TS 23.288
[9]. Based on the analytics information:
\- the AF may decide or update MBS service parameters, including the
allowed/preferred delivery method (s) for the MBS service/applications and
data forwarding indication, and provide to the PCF (e.g. via the UDR as
specified in TS 23.502 [8] clause 4.15.6.7).
\- the PCF may decide or update the MBS related PCC policy and provide to the
SMF.
\- the SMF may decide or update the MBS assistance information.
1\. During the MBS related procedures, e.g. MBS service configuration, session
start and/or session join, the SMF provides the MBS assistance information to
the NG-RAN via the AMF. The SMF decides the MBS assistance information based
on the MBS related PCC policy from the PCF (if dynamic PCC is deployed) or
local policy (if dynamic PCC is not deployed), UE MBS group affiliation data
from the UDM/UDR or the PCF, UE capabilities if indicated by the UE in the NAS
message which is forwarded to the SMF by the AMF, and/or network analytics
information provided by the NWDAF, data forwarding indication from the PCF,
etc. Then the SMF includes the MBS assistance information in the N2 SM
information of Namf_Communication_N1N2MessageTransfer request (or via other
service operation) to the AMF, and the AMF forwards it to the NG-RAN.
2\. Based on the MBS assistance information and other information (e.g. local
measurement), the NG-RAN determines the delivery method of AN resources for
the MBS session, or decides to switch the delivery method of AN resources from
unicast to multicast (or vice versa) for an ongoing MBS session.
3\. The NG-RAN establishes or modifies the AN resources for the MBS session
according to the selected delivery method.
### **6.18**.3 Impacts services, entities and interfaces
SMF:
\- The SMF generates the MBS assistance information and provides it to the NG-
RAN. The SMF may decide and update the MBS assistance information based on
analytics information from the NWDAF.
NG-RAN:
\- The NG-RAN decides the delivery method for AN resources of the MBS session
taking into account of the MBS assistance information provided by the CN.
## 6.19 Solution #19: Supporting local MBS service
### 6.19.1 Functional description
This solution addresses KI#6 \"Local MBS service\". This solution is built on
top of Solution#2 as described in clause 6.2 which assumes baseline
architecture 2 in clause A.2.
Local MBS service requires the service to be delivered in a local service area
for a specific period. All the relevant UEs in the local area can receive the
MBS service. When starting a local MBS service, the application function needs
to be able to provide the local service area to 5GC and NG-RAN to ensure the
local MB service can be delivered within some certain areas. The UEs outside
those areas should not be served for the local MBS service.
_\- How to support UEs if necessary, to discover and receive multicast and
broadcast communication services which is available locally in 5G system in a
resource efficient manner._
For the above requirement, it is assumed that how UE discovers the local
server will be addressed in TR 23.748 [11] \"Study on enhancement of support
for Edge Computing in 5G Core network (5GC)\", and application server is aware
of itself being local or not.
It is also assumed that local MBS service is only delivered towards NG-RAN
nodes where 5MBS is supported. In NG-RAN nodes where 5MBS is not supported,
the 5GC Individual MBS traffic delivery can serve the UE, but at the cost of
not taking advantage of 5MBS optimizations.
To offer local MBS service, the backhaul delay between 5GC and NG-RAN needs to
be minimized. To minimize the delivery latency, it is essential to have
localized user plane deployment to work together with localized application
function. In the deployment of baseline architecture 2, MB-UPF (and optionally
MBSU) and application function needs to be deployed locally (i.e. close to NG-
RAN). Figure 6.19.1-1 depicts the localized user plane in 5MBS architecture.
Figure 6.19.1-1: Localized User Plane in 5MBS Architecture
Location-dependent service can be regarded as a special local MBS service.
Multiple location-dependent services share the same TMGI but differentiated by
FlowID. 5GS provide different ingestion points for different location-
dependent services (different TMGI + FlowID). When UE is under the coverage of
local service areas of those location-dependent services, UE can request to
join the TMGI and it should get the content based on its location.
### 6.19.2 Procedures
To offer local MBS service, the Allocate TMGI procedure needs to include the
local service area information. Figure 6.19.2-0 depicts the Allocate TMGI
procedure as well as the Session Join procedure of a local MBS service.
Figure 6.19.2-0: Session Join for Local MBS Service
Steps 1-8 are from Solution #2 as described in the clause 6.2 with the
following differences:
1\. To allocate TMGI, AF includes additionally the local service area
information in the Allocate TMGI Request to NEF/MBSF. The local service area
information can be cellId list, gnodeBId list, tracking area list, geographic
area list and civic address list. Among them, cellId list, gnodeBId list and
tracking area list shall only be used by AFs who resides in trust domain, and
when they are aware of such information.
2\. NEF/MBSF translates the local service area to Location Criteria specified
in TS 23.503 [13]. It includes the Location Criteria in Allocate TMGI Request
message to MB-SMF.
3\. MB-SMF allocates TMGI and FlowID for the MB service. In step 1:
\- For the normal request (i.e request that is not location dependent), AF
will not provide TMGI and let MB-SMF decide. MB-SMF select an available TMGI
and FlowID (e.g. the default value of FlowID can be 0).
\- For location-dependent services, after getting TMGI from the response of
the first allocation, the AF will provide the TMGI to be used, so that MB-SMF
will reuse the TMGI and allocate a unique FlowID.5. AF includes the local
service area information in the MB Session announcement to the UE. For
location-dependent services, AF should not announce one service for each sub-
area. Instead, AF should announce one service for all relevant location-
dependent services which share the same TMGI, while the the local service area
should cover all sub-areas.
6\. UE sends MB Session Join Request to AMF. If UE can determine that it is
outside the local service area, it does not send the MB Session Join Request
to the AMF.
7\. In MB Session Response from MB-SMF to AMF, the Location Criteria
information is included for local MBS service. For location-dependent
services, MB-SMF should return the MBS service based on UE\'s location which
is passed by AMF.
8\. If AMF detects that the UE is inside the local service area, the AMF sends
an MB Session Join Accept message to the UE, along with an N2 message MB
Session Join message to NG-RAN.
9\. If AMF detects that the UE is outside the local service area, the AMF
sends an MB Session Reject message to the UE indicating that the MB Session
Join is rejected and including the reason (outside of local service area,
Location Criteria information).
To deliver a local MBS service, some actions need to be taken in the session
start procedure. Figure 6.19.2-1 depicts the session start procedure of local
MBS service delivery:
Figure 6.19.2-1: Session Start for Local MBS Service
Steps 1-16 are from Solution #2 as described in the clause 6.2 with the
following differences:
4\. The MB-SMF selects the localized MB-UPF based on the Location Criteria to
set up the resources.
5\. The MB-SMF includes Location Criteria in MB Session Start request to the
AMFs.
5a. After receiving MB Session Start request from MB-SMF, the AMF check
whether the joined UEs are within the local service area. For any UEs outside
the local service area, the AMF removes the associations between those UEs and
the MB Session Context. Furthermore, AMF sends a NAS MB Session Remove message
to those UEs, along with a N2 message MB Session Remove (NGAP ID, TMGI) to
inform NG-RAN. In the figure above, AMF detects UE2 to be outside the local
service area.
6\. AMF only sends the MB Session Resource Setup Request to the relevant RAN
nodes in the local service area to which it has earlier sent received an N2 MB
Session Join message. AMF also includes the Location Criteria in the MB
Session Resource Setup Request as an optional parameter.
7-10. RAN nodes follow the Location Criteria of the local MBS service to
establish the downlink resource to deliver contents to the joined UEs within
the local service area.
13a. If RAN, based on the Location Criteria it received from AMF, detects some
joined UEs that are outside the local service area, will remove those UEs from
the MB Session. To remove those UEs, the RAN sends an N2 MB Session Remove
message to AMF with NGAP ID list and TMGI. The AMF removes the associations
between those UEs and the MB Session Context in AMF.
13b. AMF sends NAS MB Session Remove messages to those UEs separately. For
example, in the figure above, RAN detects that UE3 is outside the local
service area, RAN informs AMF and AMF sends MB Session Remove to UE3.
17-18. Another UE (i.e. UE4 in this procedure) requests to join the MBS
session. The AMF checks whether the UE is located within the area of the local
service. If the UE is within the area, the AMF accepts the request and informs
NG-RAN of the newly joined UE, otherwise the AMF rejects the MB Session Join
from UE4.
In step 1-6 and step 9-13, TMGI and FlowID will work together to identify the
MB session.
For area restriction in step 5a and 13a, for location-dependent services, it
should be performed based on the coverage of the areas of multiple location-
dependent services. And for content distribution in step 6, 10 and 16, the
distribution area is decided by the area of a specific local MBs service. If a
UE moves out of a local service area, the AMF or NG-RAN may detect that during
a handover procedure. If the AMF detects it, the AMF will send a NAS MB
Session Remove message to the UE and a N2 MB Session Remove message to the NG-
RAN (as step 5a above). If the RAN detects it, the RAN node will send a MB
Session Remove message to AMF and the AMF will send a MB Session Remove
message to the UE (as step 13a and step 13b in Figure 6.19.2-1).
For location-dependent service handover, the handover procedure in Solution
#11 and Solution #12 need to be enhanced. For simplification, only Xn based
handover is addressed below. It can be extended to N2 based handover and other
handover solutions.
Figure 6.19.2-2 assumes Option.2 in Solution #11, which is executed after AMF
sends Path Switch Acknowledge. As an alternative solution, it is possible to
adopt Option.1 (i.e. embedding step 3 in handover procedure) to speed up user
plane establishment in Target NG-RAN side.
Figure 6.19.2-2: Inter-gNB Xn Handover for Location-Dependent Service
In the description below, compared with the Xn based handover, the differences
specific for location dependent services are shown in _Italic_.
1\. Inter-gNB Xn handover is triggered as in step 1 to step 9 in clause
6.11.2.1. AMF has sent Path Switch Request Ack to Target NG-RAN.
_2\. If UE moves to a new location area and AMF does not have MB Service for
the new location area, AMF will query MB-SMF via MB Session Request/Response
to get MB Service based on TMGI. AMF provides UE\'s location information, and
MB-SMF return the proper MB service to AMF._
3\. Target NG-RAN join the receiving of the MB session and the resources in
the Source NG-RAN may be released, if there are on other UEs receiving the
content of the MB session. Refer to step 10a. to 11. in clause 6.11.2.1 for
more details. Compared with non-location dependent service, there may be the
following differences, if UE\'s location belongs to a different location
dependent service from the original one:
_\- When shared delivery and multicast N3 applies, Target NG-RAN may join a
different SSM from the one joined by the source NG-RAN._
_\- When shared delivery and unicast MB-N3 applies, Target NG-RAN may
establish N3 tunnel to another MB-UPF endpoint._
_\- When individual delivery and multicast MB-N9 applies, UPF may join a
different SSM from the original one._
_\- When individual delivery and unicast MB-N9 applies, UPF may switch to
another MB-UPF endpoint._
### 6.19.3 Impacts on services, entities and interfaces
NEF/MBSF:
\- The MBS control function (MBSF) translates the received local service area
information (cellId list, gnodeBId list, tracking area list, geographic area
list or civic address list) to Location Criteria, and includes the Location
Criteria in Allocate TMGI Request for local MBS service.
MB-SMF:
\- The MB-SMF selects local MB-UPF based on Location Criteria
\- The MB-SMF includes the Location Criteria in MB Session Response to AMF for
local MBS service
\- The MB-SMF allocate FlowID AMF.
\- The AMF checks whether the UE is in the local service area, and
accept/reject MB Session Join Request from UE. For those joined UEs who are
out of a local service area when a session starts or UEs that move out from
the local service area with handover when a session is ongoing, the AMF sends
NAS MB Session Remove messages to the UEs, along with N2 MB Session Remove
messages to NG-RAN.
\- The AMF includes the Location Criteria in MB Session Resource Setup Request
to the relevant RAN nodes if needed.
\- The AMF sends a NAS MB Session Remove message to a UE, if it receives a N2
MB Session Remove message from NG-RAN.
\- The AMF performs area restriction in handover scenario.
\- The AMF request MB-SMF to select the MB service based on UE location.NG-
RAN:
\- NG-RAN checks whether joined UEs are in the local service area. If it
detects a UE outside the local service area when a session starts or a UE that
moves out from the local service area during an ongoing session, the NG-RAN
node sends an N2 MB Session Remove to AMF to remove the UE from the MB
session.
\- NG-RAN follows the Location Criteria of the local MBS service to establish
the downlink resources.
## 6.20 Solution #20: Local multicast service
### 6.20.1 Functional description
This is a solution for key issue #6 \"Local MBS service\".
This solution assumes the architectural alternative 2 (see Annex A, clause
A.2).
The outline of the proposed solution for local multicast service is as below:
1) The AF provides multicast service area information with cell information or
geographical area information when the AF requests TMGI allocation.
2) The AF can provide the updated multicast service area information when the
AF requests the multicast session start/activation.
3) The MB-SMF stores the latest multicast service area information, i.e. List
of Cell IDs for each multicast service/session identified by the TMGI.
4) The UE requests multicast service area information for a particular
multicast service identified by TMGI to the AMF.
5) The AMF provide the latest multicast service area information, i.e. List of
Cell IDs for multicast service identified by the TMGI to the UE. The AMF
acquires the latest multicast service area information for the TMGI from the
MB-SMF.
6) Whenever the multicast service area is updated, the updated multicast
service area information, i.e. updated List of Cell IDs is provided to the UE.
According to the solutions for Key Issue #1, if the MB-SMF or SMF interacts
with the UE for multicast session join (i.e. exchanges the NAS messages with
the UE related to multicast operations), the MB-SMF or SMF instead of the AMF
can provide the latest multicast service area information to the UE. In this
case, MB-SMF or SMF corresponds to AMF in 4) and 5) above. In this way, this
solution can be applied also to the architectural alternative 1 (see Annex A,
clause A.1). If the SMF exchanges the NAS messages with the UE related to
multicast operations and does not manage the multicast session which means the
MB-SMF manages the multicast session, the SMF can acquire the latest multicast
service area information for the TMGI from the MB-SMF or UDR depending on the
solution for Key Issue #1 and provide it to the UE.
### 6.20.2 Procedures
Figure 6.20.2-1 shows the procedure for local multicast service.
NOTE 1: The message names in the procedure below are descriptive. It is
assumed that SBI based names need to be used between NFs.
Figure 6.20.2-1: Procedure for local multicast service
0\. The UE performs registration and PDU Session Establishment.
1\. The AF sends an Allocate TMGI Request message to NEF to request allocation
of a TMGI for multicast service. The AF includes Multicast service area that
is List of Cell IDs or geographical area information in the message.
2\. The NEF sends an Allocate TMGI Request message to the MB-SMF.
If geographical area information was included as Multicast service area in the
Allocate TMGI Request message, the NEF converts the geographical area
information to List of Cell IDs and includes the List of Cell IDs in the
Allocate TMGI Request message. Or the MB-SMF can convert the geographical area
information to List of Cell IDs in step 3.
3\. The MB-SMF allocates a TMGI for the multicast service and stores the TMGI
and the List of Cell IDs as Multicast service area.
The MBâ€‘SMF registers the TMGI and its address in NRF to allow AMFs to discover
the MB-SMF for the TMGI.
The MB-SMF returns the allocated TMGI to the NEF.
4\. The NEF forwards the TMGI to the AF.
NOTE 2: TMGI can be allocated by the MBSF that is a function which may be part
of NEF or be deployed independently (not shown in Figure 6.20.2-1).5. The UE
and the AF can exchange application layer signalling. The AF provides
multicast service related information including TMGI. The AF may also include
information that this multicast service is local service.
NOTE 3: This solution assumes that not all AFs/Content Providers have
knowledge on cells in operator\'s network. Therefore, there may be the case
that the AF/Content Provider cannot provide cell list to the UE in the service
announcement.
6\. The multicast session is started. The AF may provide the updated multicast
service area that is List of Cell IDs or geographical area information. In
this case, the MB-SMF performs the multicast session start by using the
updated multicast service area and stores the updated multicast service area,
i.e. List of Cell IDs, for the TMGI.
NOTE 4: Solutions for Key Issue #1 can be used for Multicast session start.
If the cell list as the service area information was provided in step 5, steps
7 to 11 and steps 19 to 20 are skipped.
7\. The UE sends a Multicast Service Area Request message to the AMF to get
the multicast service area for a particular multicast service identified by
TMGI.
8\. If the AMF does not already have multicast service area information for
the received TMGI, the AMF selects an MB-SMF for the TMGI by querying the NRF.
Then, the AMF sends a Multicast Service Area Request message to the MB-SMF to
get the multicast service area for a particular multicast service identified
by TMGI.
9\. The MB-SMF sends a Multicast Service Area Response message. The MB-SMF
includes the List of Cell IDs stored for the TMGI in the message. The AMF
stores the TMGI, the List of Cell ID per TMGI received from the MB-SMF and the
MB-SMF information for the multicast session in the UE context.
10\. The AMF sends a Multicast Service Area Response message to the UE. The
AMF includes the List of Cell IDs as multicast service area for the TMGI in
the message. The AMF stores per TMGI the latest List of Cell ID delivered to
the UE in the UE context. During the mobility procedure this information need
be transferred between AMFs.
NOTE 5: The association between the TMGI and service area provided to the UE
(i.e. the latest List of Cell ID delivered to the UE) is not stored after the
UE is deregistered.
11\. If the AMF has not subscribed to the event of the multicast service area
change for the TMGI, the AMF sends a Multicast Event Subscribe message to the
MB-SMF to get notification on the multicast service area change for the TMGI.
12\. The UE detects that it is in the multicast service area based on the Cell
ID received in the SIB message.
13\. The UE sends a Multicast Join Request message to the AMF to indicate its
interest in receiving a particular multicast service identified by TMGI.
14\. If the AMF has not already joined the multicast session for the received
TMGI, the AMF sends a Multicast Join Request message to the MB-SMF for the
TMGI to indicate its interest for the multicast session identified by the
TMGI.
15\. The MB-SMF sends a Multicast Join Response message.
16\. The AMF sends a Multicast Join Accept message to the UE.
17\. If the multicast session has been started in step 6, the multicast
session setup is performed for the UE.
NOTE 6: Solutions for Key Issue #1 can be used for Multicast session setup for
the UE.
18\. The multicast session is started if the multicast session has not been
started yet (i.e. if step 6 was not performed). The AF may provide the updated
multicast service area that is List of Cell IDs or geographical area
information. In this case, the MB-SMF performs the multicast session start by
using the updated multicast service area and stores the updated multicast
service area, i.e. List of Cell IDs, for the TMGI.
NOTE 7: Solutions for Key Issue #1 can be used for Multicast session start.
19\. If the multicast service area is changed, the MB-SMF sends a Multicast
Event Notify message to the AMF to provide the updated List of Cell IDs for
the TMGI. The AMF stores the updated List of Cell ID received from the MB-SMF
in the UE context.
20\. If the AMF received the updated List of Cell IDs for the TMGI from the
MB-SMF in step 19, the AMF provides it to the UE by using the UE Configuration
Update procedure specified in clause 4.2.4.2 of TS 23.502 [8]. The AMF stores
the latest List of Cell ID delivered to the UE in the UE context. The AMF
provides the updated List of Cell IDs to all UEs that requested the multicast
service area for the TMGI. If the AMF has not successfully provided the
updated List of Cell IDs to the UE, the List of Cell ID received from the MB-
SMF and the latest List of Cell ID delivered to the UE stored in the UE
context are different. In this case, the AMF can re-try to deliver the List of
Cell IDs provided by the MB-SMF later.
NOTE 8: This solution assumes that area restriction information for multicast
session (e.g. List of Cell IDs) is provided to NG-RAN when the information for
multicast session setup/start is provided to NG-RAN. The AF can perform
multicast session update procedure to modify the multicast service area for
the ongoing multicast session. In this case, step 19 and step 20 are executed.
When the UE does not want to be informed the updated List of Cell IDs for the
TMGI, the UE cancels the Multicast Service Area Request to the AMF.
### 6.20.3 Impacts on services, entities and interfaces
AF:
\- requests TMGI allocation with Multicast service area.
MB-SMF:
\- stores the TMGI together with the List of Cell IDs as Multicast service
area.
\- supports operations to provide the latest List of Cell IDs for the TMGI to
the AMF.
AMF:
\- supports operations to acquire the latest List of Cell IDs for the TMGI
from the MB-SMF.
\- supports operations to provide the latest List of Cell IDs for the TMGI to
the UE.
UE:
\- supports operations to acquire the latest List of Cell IDs for the TMGI
from the AMF.
## 6.21 Solution #21: Global Multicast Group ID for local Multicast Contents
### 6.21.1 Functional Description
#### 6.21.1.1 System Architecture
This solution addresses Key Issue 6. The architecture functional entities are
described in clause A.1 \"5G MBS system architecture based on unicast 5GC\".
Solution 3 is extended to address specific requirements of local MBMS
services.
#### 6.21.1.2 Assumptions and principles for local MBS services
Similar as the MBMS implementation defined in TS 23.246 [4], it should be
possible to enable the system to keep the multicast session ID (or TMGI) when
UE moves across the local MBS session area.
NOTE: By implementation, it would be still possible to allocate different
multicast session IDs corresponding to different location areas, but in that
case it would be the application-level treatment and the 5GC/Application layer
may need to accommodate the location area provisioning to the UE(s), as
Solution #8 and Solution #21 demonstrate.
In this solution, it is assumed that a single MBS Session ID is used, while
the MBS content distributed by the 5GC could be different depending on the
location area where the UE is residing. And for each MBS service, its Location
Area(s) and the associating Location Area ID(s) are transparent to the UE(s)
of the MBS group.
It is also assumed that content in different location areas will be provided
in media flows with the same encoding. This avoids that the UE needs to be
receive different service announcements for the same service in different
location areas.
To better support local MBS scenario (i.e. reduce transmission latency of the
MBS data), 5GC could provide different multicast anchors for receiving
different MBS data for different location area of the same MBS service, as
clause 6.21.2.3 shows.
This also enables local service without location-dependent content: If a UE
tries to join a location dependent multicast session outside an area where
location dependent content for the multicast session is provided, or UE moves
out of an area with location dependent content for the multicast session, the
UE is removed from the multicast session.
#### 6.21.1.3 Specific additions to solution 3 for local MBMS services
It is desirable to avoid changing multicast session IDs depending on UE
location for services with different content depending on UE location, e.g.
for V2X. Otherwise constant updates of the UEs and complex detection
procedures or configuration with location dependent multiplex session IDs are
required.
**A single multicast Session ID is assigned for a multicast group, but the
contents distributed as part of the multicast group differ depending on the
location area where the UE is residing.**
**Only the multicast Session ID is announced to the UE and the network selects
the related contents depending on the UEs\' location. However, if the
multicast session is only available in certain location area(s), this can be
indicated to the UE.**
Content provisioning in proximity to the location area where the content is to
be distributed seems desirable to reduce transport delay, that is critical in
particular for V2X applications.
**It is possible to assign different ingress nodes for different location area
dependent content for a multicast group.**
To achieve those aims, the multicast group context in the UDR is extended with
location area dependent information:
\- A description of the location are, e.g. list of cells, TAIs.
\- A network-internal local area ID assigned to the location area that is
unique for the multicast session.
\- An ingress node assigned to the location area.
\- Possibly a multicast transport address assigned to the location area.
An AF may register at the NEF that it provides contents for a multicast group
for a specific location area. The NEF then selects an ingress node for the
multicast group in the specific location area and a local area identifier is
assigned. The information is stored in the UDR.
NOTE: The functionality of the local area identifier is comparable with the
MBMS Flow Id.
Alternatively, the UDR can contain configured information based on commercial
agreements with the content provider.
An SMF can provide a UE location to the UDR to query for location dependent
information within a multicast session context.
The SMF serving a UE provides information about the access to content for the
multicast session in the location area towards the RAN. The RAN contacts the
related ingress node to join the location area dependent distribution tree for
the multicast content.
The AMF notifies the SMF when the UE leaves the location area. The SMF obtains
multicast context information for the new UE location from the UDR and then
provides information about the access to content for the multicast session in
the new location area towards the RAN.
### 6.21.2 Procedures
#### 6.21.2.1 Multicast context and Multicast flow setup/modification via PDU
Session Modification procedure
The flow is the same as described in clause 6.3.2.1, with the differences
highlighted in the description of the steps.
Figure 6.21.2.1-1: PDU Session modification for multicast
1\. The content provider may send a request to register and reserve resources
for a multicast group in a specific location area to the NEF as detailed in
clause 6.21.2.2. The NEF select MB-SMF as ingress node for the location area
and stores related information in the UDR.
NOTE: The request to reserve resources for the corresponding multicast session
is optional and can be replaced by configured data based on commercial
agreements.
2\. Same as in clause 6.3.2.1.
3\. Same as in clause 6.3.2.1. If the multicast session is only available in
certain location area(s), this can be indicated. No information about the
local content is announced.
4\. Same as in clause 6.3.2.1.
5\. Same as in clause 6.3.2.1.
6\. The SMF queries the UDR for information about the multicast context. If
the UDR provides information about location areas stored within the multicast
context (including MB-SMF ID, location are and area session ID for each
location area), the SMF selects location dependent multicast context
information based on the location area where the UE is residing. The SMF
determines the applicable MB-SMF ID, area session ID, location area in that
manner. If the SMF determines that the multicast context is location dependent
but there is no local content (and MB-SMF ID, area session ID, location area)
for the UE\'s location, the SMF rejects the UE\'s request to join the
multicast session.
7-8.: If SMF has no information about the multicast context for the indicated
multicast group and area session ID, SMF interacts with MB SMF to retrieve QoS
information of the multicast QoS flow(s) for the multicast group and area
session ID.
9\. The SMF requests the AMF to transfer a message to the RAN node using the
Namf_N1N2MessageTransfer service (N2 SM information (PDU Session ID, Multicast
group ID, MB-SMF ID, location area, area session ID),
10\. The RAN is using the received multicast group ID and area session ID to
determine the localized multicast distribution context.
11\. Same as in clause 6.3.2.1.
12\. RAN node checks whether the user plane for the multicast group/context
and location area distribution is already established towards the RAN node.
If RAN supports MBS, and if no user plane for multicast group distribution for
the area session ID is established towards the RAN node, steps 13 to 17 are
executed.
13\. RAN signals a request for the user plane establishment towards that AMF
[MB-SMF ID, Multicast group ID, area session ID].
14\. Same as in clause 6.3.2.1. MB-SMF identifies media distribution session
based on Multicast group ID and area session ID
15-24: Same as in clause 6.3.2.1.
25\. SMF signals a request for the multicast session distribution towards MB-
SMF [Multicast context/group ID, area session ID, downlink tunnel info].
27-37: Same as in clause 6.3.2.1.
#### 6.21.2.2 Optional Multicast group registration
Figure 6.21.2.2-1: Optional Multicast group registration
1\. AF of content provider may register at the NEF that it provides contents
for a multicast session (identified by multicast group ID which may be IP
multicast address) for a certain location area (e.g. list of cells, TAIs,
geographical area, identifier agreed between content provider and network
operator). (Multiple AFs may register for the same multicast session but
different location areas.) NEF selects MB-SMF as ingress control node,
possibly based on location area.
2\. Same as in clause 6.3.2.2. The NEF maps possible external identifiers for
location areas to network-internal identifiers (e.g. list of cells, TAIs).
3-4. NEF requests storage of multicast session at UDR and provides multicast
session ID, selected MB-SMF ID and location area. The UDR allocates an area
session ID for the location area and stores all these data.
5\. NEF request MB-SMF to reserve ingress resources for a multicast
distribution session and provides Multicast session ID, location area, and
area session ID
6\. The MB-SMF sends SM MBS Policy Association Request to PCF with the
Multicast group ID, area session ID, and the QoS requirements.
7\. The PCF registers at the BSF that it handles the multicast session for the
location area. It provides an identifier that the policy association is for
multicast and the multicast group ID, area session ID, its own PCF ID and
optionally its PCF set ID.
8\. The PCF may query the UDR for policy input related to the multicast
session and area session ID
9-13. Same as in clause 6.3.2.2. The MB-SMF may select the MB-UPF based on the
location area received in step 5.
#### 6.21.2.3 Enhancement on Handover procedure
NOTE: For simplification, this figure is based on Solution #27 and only
address the Xn based Handover. It can be extended to N2 based Handover and
other Handover Solutions if needed.
Figure 6.21.2.3-1: Enhancement on Handover procedure.
Prerequisite: The UE is camping at Source RAN (S-RAN) and receiving multicast
data a corresponding to the multicast session ID and location area ID.
1\. Same as in clause 6.27.2.1
2\. Same as in clause 6.27.2.1: S-RAN sends Handover request to T-RAN with
including multicast session ID, location area ID and location area.
3-7. T-RAN determines whether to establish the forwarding resources and
multicast distribution for multicast session ID and location area ID provided
by S-RAN, based on multicast session ID, area session ID and location area. To
determine the forwarding resources for location-dependent contents delivery,
T-RAN may only check whether or not the location area ID is the same if T-RAN
already established the session context of the multicast session ID. If a
multicast distribution session needs to be established, T-RAN provides
multicast session ID and location ID in step 3
8\. T-RAN sends the Handover request Ack to S-RAN, with the accepted multicast
session ID and area session ID. When the T-RAN supports multicast but the UE
is no longer in the location area indicated in step 2, the T-RAN rejects to
handover that multicast session with a cause indication that the UE moved out
of the location area and the new UE location. Other info is same as step 8 in
clause 6.27.2.1.
Editor\'s note: The handling at source gNB from step 8 to step 14 require
confirmation from RAN WGs.
Editor\'s note: To minimize impact on the handover procedure, an alternative
whether steps 9-13 and steps 15-17 can be performed after handover is complete
is FFS.
Steps 9 to 20 only apply if the UE moved out of the location area and target
gNB supports multicast.
9-10. The S-RAN indicates the new UE location to the SMF via the AMF.
11\. The SMF determines the location area, area session ID and MB-SMF ID for
the new UE location. It may query the UDR for that information. If the SMF
determines that there is no local content (and MB-SMF ID, area session ID,
location area) for the UE\'s location, the SMF removes the UE from the
multicast session.
12-13. The SMF sends the new location area, area session ID and MB-SMF ID to
the S-RAN via the AMF.
14-20. Same as steps 2-7, but with new MB-SMF ID, area session ID and location
area.
21-42. Same as steps 9-29 in clause 6.27.2.1. In steps 29, 35 and 36, the area
session ID is indicated in addition to the multicast session ID.
### 6.21.3 Impacts on services, entities and interfaces
Same as in clause 6.3.3. In addition:
MB-SMF SMF, RAN, AMF, UDR, NEF:
\- Area session Identifier and location area needs to be stored and signalled.
RAN:
\- Inform SMF when UE leaves location area.
SMF:
\- Select location dependent MB-SMF and location area based on UE location and
information from UDR.
\- If UE joins a local multicast session outside a location area served by
that session, reject join.
\- Remove UE from local multicast session if it moves outside location area.
NEF:
\- Map external location area identifiers to internal identifiers.
\- Select MB-SMF based on location area.
\- Store related info in UDR.
MB-SMF:
\- Select MB-UPF based on location.
## 6.22 Solution #22: RAN based switching within NR coverage
### 6.22.1 Functional Description
This solution provides a solution to key issue 7. The solution can be used
with architecture option 1 or 2 (clause A.1 or clause A.2).
The solution is based on the fact that 5G NR has more possibilities to control
transmission and reception quality than LTE, and that RAN WGs intends to
enhance the 5MBS transmission with various mechanisms such as PTP, HARQ in PTM
etc., that should make 5MBS reception in NR better than LTE and probably on
par with or even better than unicast reception for large groups of receivers
in a cell. See further background in discussion part of S2-2003682).
The solution allows RAN to switch between Point to Point (PTP) and Point to
Multipoint (PTM) to most efficiently serve the UEs receiving the same
multicast data in a cell.
TSG RAN has already approved a RAN study which includes an objective to
develop a RAN function for dynamic change between PTM and PTP service delivery
for a given UE (see RAN SID in RP-193248 [12]).
Over N3 the same tunnel for the MBS flow is used regardless if the RAN is
using PTM or PTP (or both) in a specific cell. The N3 tunnel is assumed to be
a \"Multicast Transport Tunnel\" similarly to the M1 in LTE eMBMS. Optionally,
the N3 tunnel may also be a unidirectional Point-to-Point tunnel between UPF
and NG-RAN similarly to MBMS for UTRAN.
The solution uses Multicast and targets any applications/UEs that indicate its
interest (e.g. join/leave) to 5GS for receiving an MBS flow. This includes
MCPTT/MCX, V2X, etc.
Figure 6.22.1-1 depicts the user plane path for a multicast flow for RAN based
switching.
Figure 6.22.1-1: MBS user plane model
The figure above is a simplified example and a RAN node may of course use PTM
and PTP simultaneously for different MBS Sessions and possibly also for a
single MBS Session.
The switching between PTP and PTM happens entirely within RAN.
Interworking with RATs (e.g. E-UTRA) may be done at the application level e.g.
as is described in TS 23.468 [5] clause 5.3 \"Service Continuity\".
NOTE: Other potential solutions for interworking with RAN node not supporting
5G MBS are not prevented by this solution.
This solution applies to NG RAN nodes supporting 5G MBS. No 5GC involvement is
needed within 5G MBS supporting NG RAN nodes.
### 6.22.2 Procedures
This solution uses the session management procedures defined for key issue 2.
The more specific procedures for PTM/PTP control are RAN responsibility and
will be developed in RAN WGs.
### 6.22.3 Impacts on services, entities and interfaces
RAN:
\- The RAN should support shared PTM and per UE PTP downlink transmission of
multicast data. RAN may support switching between PTP and PTM based on RAN
internal decision such as if the number of UEs in the same group increases or
decreases in a cell.
UPF:
\- Transmission of 5MBS data to NG-RAN nodes.
N3:
\- Support of shared tunnels for 5MBS data and support IP multicast between
RAN and 5GC.
SMF:
\- No impact.
UE:
\- Support for reception of 5MBS data on PTM and PTP.
AMF:
\- No impact.
PCF:
\- No impact.
NEF:
\- No impact.
AF:
\- No impact.
## 6.23 Solution #23: Reliable delivery mode switching between unicast and
multicast based on threshold triggers
### 6.23.1 Functional Description
#### 6.23.1.1 Shared NFs with dedicated MSF
The solution is based on Baseline architecture 1 specified in clause A.1.
MSF (Multicast Session Function) with control plane and user plane instances
can be used to handle the application session function for MBS requirements.
This NF for MBS services may be a separate entity from 5GC or part of 5GC that
provides multicast session for efficient transmission of one to many MBS
session to UE in 5G Network. Further, RAN node may be used to start or stop
the multicast session to UE(s).
Editor\'s note: RAN impacts shall be studied in RAN WGs.
The control of content to be provided using unicast/multicast session and
enablement/disablement of services may reside with UE MBS application, which
may directly contact MSF for collecting information related to MBS Session.
The control plane part of the network enables SMF to create/modify/delete the
session for multicast services with the policies provided by PCF for the
session.
Multicast/Broadcast services might be provided to UE(s)/groups within a RAN
Notification Area, Tracking Area or Registration Area depending upon the count
of active UEs (as a trigger) on the application and/or request of the same
content or channels.
MSF-C is expected to behave as AF for content mode switching and delivery
requirements connected with NEF/PCF via N5/Nnef interface, thus enabling the
function to perform operation from TS 23.502 [8] clause 4.15.6.7.
Triggers to start multicast session may be aligned but not limited to
triggers/counters at MSF & SMF, UE policies for session and QoS requirements
for session delivery and UE subscription.
#### 6.23.1.2 High Level Description
\- Content can be delivered via unicast PDU session to UE(s) or multicast
using RAN as connection is active for content delivery from MSF to 5GC.
\- Multicast Start request: UE originated request to switch mode of delivery
from unicast session to multicast (as per active multicast session information
from MSF to MBS application).
\- Multicast Stop request: UE MBS application may be stopped or request access
to different content than that was available with multicast, and switches to
unicast delivery mode.
\- One of triggers at SMF and MSF may be when count of UE(s), within an area,
accessing the same content increases over threshold, the content is moved to
multicast delivery and vice versa. This ensures efficient content delivery by
switching mode of delivery.
#### 6.23.1.2.1 Overview of services, delivery method and bearer types
A brief description of content which might be using these services, delivery
method and bearer services are defined. Services and applications might
utilize different methods for content delivery and bearer services as unicast
or multicast for user plane content delivery.
Figure 6.23.1.2.1-1: Service, Delivery method and bearer type
##### 6.23.1.2.2 Multicast vs. Unicast as delivery modes from Content provider
till RAN node
Figure 6.23.1.2.2-1: Switching between Multicast and Unicast
\- Content provider may bundle the content together for efficient multicast
delivery, like bundling channels in IPTV, live TV, VR gaming application or
any other applications.
\- Continuous delivery of these multicast bundles to RAN areas, where there
are not enough UE(s) accessing the contents from this content provider or not
accessing any contents, might be utilizing the multicast bearer tunnel with no
consumption. Thus, to efficiently switch between unicast and multicast bearer
delivery of the contents, triggers and counters are required at SMF and MSF.
\- MSF triggers and counters: in order to ensure correct bundling contents for
multicast bearer delivery.
\- SMF triggers and counters: in order to ensure efficient use of unicast and
multicast bearer services with different UPF(s) for content delivery, where
UPF shall be routing traffic as per SMF notifications.
\- RAN may enable or disable broadcast depending upon N2 request from AMF.
Editor\'s note: Using broadcast is FFS. RAN handled the switch between PTP and
PTM.
### 6.23.2 Procedures
#### 6.23.2.1 Procedures with shared NFs
The triggers at UE, SMF and MSF can be used to initiate the switch between
unicast and multicast. Figure 6.23.2.1-1 describes the detailed procedure with
shared NFs:
Figure 6.23.2.1-1: Delivery mode switch between unicast & multicast with
shared NFs
Solid line messages are control plane messages and dashed line messages are
user plane messages over the current PDU session.
1\. Initially, either unicast or multicast session may be ongoing between UE
and Content provider. MBS application on UE is connected via user plane and
accessing contents.
2\. MBS Availability Information about the current ongoing multicast sessions
in the network, including session ID and other related information, is shared
with UE MBS application.
NOTE 1: MBS Availability Information when received on UE MBS application may
be used to trigger request to switch between multicast and unicast depending
upon the requirements and policies for the active session(s).
3\. UE checks whether any trigger conditions are met, to initiate delivery
mode switch request.
NOTE 2: The trigger conditions may be (but not limited to) UE MBS subscription
changes, application level trigger, coverage trigger, coverage changes,
network notifications, QoS requirements for multicast session, handover or
reselection to target RAN supporting or not supporting MBS, user switching MBS
application to view multicast channel/content, user switching off the MBS
application to stop multicast session, or any other policy exceptions.
4\. UE sends Multicast Session Start/Stop request to UPF for current TMGI,
Session ID and SUPI on user plane.
5\. UPF forwards the request over N4 interface to SMF.
6\. SMF has predefined threshold count for minimum count (as a trigger) of UE
in unicast session required to start delivery via multicast session and
similarly, if the count moves below a threshold, switch delivery mode to
unicast PDU session for content delivery.
NOTE 3: Thresholds can be part of initial policy created at PCF or updated by
AF-MSF-C by process similar to step 11. SMF forwards Session Start/Stop
request to MSF with session ID.
8\. MSF checks whether the count (as a trigger) of UE subscribed and utilizing
the same content is over a certain threshold. For efficient content delivery,
the triggers are predefined which may be changed in DNN.
9\. If the UE count is lower than a threshold, MSF may send Session Stop
Request, or else, if the count is higher than a threshold within a
Registration/Tracking/RAN area, it will forward the Session Start request to
respective SMF.
10a. SMF forwards the N2 message via AMF to RAN to Start/Stop the multicast
session for the current session ID in RNA.
10b. UE or network-initiated PDU Session Establishment request or PDU Session
Modification procedure, depending upon the entity initiating the request for
delivery mode switch between multicast and unicast.
NOTE 4: If the session status remains the same, steps 6 to 10a are skipped.
Editor\'s note: How to enhance PDU session modification message is FFS.
11\. MSF may initiate policy update depending upon the subscription and
content delivery using procedures from TS 23.502 [8] clause 4.15.6.7.
NOTE 5: Delivery mode switch requires timely trigger update and sync between
nodes to ensure that session count (triggers) and delivery nodes are kept
updated.
### 6.23.3 Impacts on existing entities and interfaces
AF:
\- MSF-C performs the operation of AF for efficient content delivery.
SMF/MSF:
\- Keeps trigger (count, as example) for current active UEs in multicast PDU
session within respective coverage area (RNA, TA, RA).
UPF:
\- Shall be able to send the Notification of user plane request from UE to
respective SMF over N4.
RAN:
\- Switching between broadcast/multicast session and unicast on SMF N2 request
forwarded from AMF.
Editor\'s note: Using broadcast is FFS.
## 6.24 Solution #24: Reliable delivery method switch between unicast and
multicast
### 6.24.1 Functional description
This solution addresses Key Issue #7 and assumes the baseline architecture
described in Annex 2 with dedicated NFs for MBS, namely MBSF for control plane
and MBSU for user plane.
The solution describes a delivery method switching method between unicast and
multicast. The goal of this solution is for the system to be able to
dynamically provide such a switch whenever the right triggers are given. Given
the variety of use cases that could benefit from 5MBS switching functionality
(e.g. for media, V2X, public safety, etc.), the triggers can be of a diverse
nature, and this solution tries to flexibly support a variety of them. For
example, the unicast to multicast switching trigger may differ if the switch
is performed to distribute the same content over multicast instead of unicast
for network resource efficiency purposes or if the switch is performed to
guarantee service continuity due to UE mobility across different NG-RAN nodes
with support of 5MBS and lack thereof.
Figure 6.24.1-1 shows an example scenario for this switching solution detailed
in clause 6.24.2. The figure shows the provisioning of a multicast
communication service, i.e. a service that can be delivered via multicast,
from an application/content server to one or more UEs. The content/application
server transmits the signalling to the MBSF and the data to the MBSU. A UE
establishes an MBS session, but at some point may be receiving the IP
multicast data from the 5GC encapsulated via individual delivery with point-
to-point (PTP) transmission from the NG-RAN. After a handover, the UE may be
served by a PTM-capable NG-RAN node, and a switching procedure from unicast to
multicast (encompassing individual to shared delivery switch and PTP to PTM
delivery switch) is performed. In addition, the PTM/PTP capable NG-RAN node
may also receive MBS data via individual delivery for PTP transmission, so the
same switching solution could be applied to a number of UEs receiving the same
content via individual delivery/PTP that are switched to shared delivery/PTM.
Figure 6.24.1-1: Switch scenario example
### 6.24.2 Procedures
NOTE: This solution focuses on 5GC MBS traffic delivery method switch (i.e.
individual and shared delivery methods) and the required 5GC signalling,
however other RAN-based solutions focusing on RAN delivery method switch (i.e.
PTP and PTM delivery methods) and their required signalling address a separate
problem.
#### 6.24.2.1 Unicast to multicast switch procedure
Figure 6.24.2.1-1: Unicast to multicast switch solution
0a. The availability of the multicast service is announced by the content
server e.g. via application layer signalling. The announcement may provide
information such as the multicast IP address and port number of the multicast
group that the UE can join, DNN, MBS session ID, etc.
0b. The UE and the 5GC establish an MBS session with 5GC individual traffic
delivery method following MBS session establishment procedures.
NOTE 1: How to initially establish an MBS session over 5GC Individual MBS
traffic delivery is in the scope of KI#1. Existing KI#1 procedures based on
architecture alternative 2 (e.g. session initiation in Solution #6) already
deal with this problem and the details of the solution can be found in their
corresponding clauses.
1\. MBS data transmission may start, and data may be exchanged between
content/application server and the UE. At some point, there is an MBS
transmission ongoing over a dedicated tunnel and PTP transmission at NG-RAN.
2\. A switch of individual to shared delivery method is triggered. The switch
may be optionally triggered by RAN and is decided by MBSF.
**[Optional]: RAN triggered switch (step 2.1)**
2.1. This alternative assumes the trigger for the switch is in the NG-RAN.
This means NG-RAN knows the MBS session over individual delivery may now be
switched to shared delivery because and decides to trigger the switch. This
may happen e.g. because the UE moves from a non-capable MBS node to an MBS
capable node prompting a PTP to PTM switch, or due to UE population change in
an NG-RAN node, etc. Steps 2.1.a - 2.1.c. show the set of request messages
originated by NG-RAN that need to be forwarded by the network with an
indication to modify the MBS session via individual delivery already
established. The forwarded messages may include the SUPI, TMGI/ MBS session
ID, etc.
NOTE 2: The potentially required inter NG-RAN node signalling before the 5GC
delivery method switch is performed is left for RAN WGs and/or other KI#7
solutions in this TR dealing with RAN delivery method switch and handover
procedures. Hence, this solution does not show inter-node signalling in NG-
RAN.
NOTE 3: This solution follows Sol#6 in that an MBS session can be initially
established using 5GC individual delivery method for MBS traffic. Hence, a non
MBS-capable NG-RAN node may exchange signalling, directly or indirectly, with
an MBS-capable NG-RAN node to perform a handover, and then trigger the switch
from individual to shared delivery.
2.1.a. N2 Session Modification Request is sent from NG-RAN to AMF.
2.1.b. Nsmf Session Modification Request is sent from AMF to MB-SMF, in
response to the AMF receiving the N2 Session Modification Request.
2.1.c. Nmbs Session Modification Request is sent from the MB-SMF to the MBSF,
in response to the MB-SMF receiving the Nsmf_Session_Modification Request.
2.1.d. [OPTIONAL] MBS Session Notification is optionally sent from the MBSF to
the content/application server; this only needs to take place if the content
server is required to be aware of the switch from individual to shared
delivery.
2.2. MBSF is the entity deciding to perform a switch from individual to shared
delivery once the MBS service has been initiated. This requires MBSF to be
aware of the 5GC delivery method being used, as proposed e.g. in Sol#6. The
decision may be based on different criteria (e.g. triggered by RAN, resource
efficiency due to multiple individual delivery transmissions ongoing carrying
the same MBS traffic, etc.).
3\. MBSF initiates switching steps. A precondition to switch to shared
delivery is that the MB Session exists in the same MB-SMF that manages the
individual PDU Session context. The MBSF update comprising:
3a. The MBSF requests the MB-SMF to update the MB Session Context, using Nsmf
Session Update Request. The MBSF may provide several parameters, e.g. SUPI,
S-NSSAI, MBS Session ID/TMGI, DNN, etc to the MB-SMF.
3b. The MB-SMF responds to acknowledge the update of the session and may
provide its multicast IP address and port number for NG-RAN, among other
parameters.
4\. [OPTIONAL] The MB-SMF may register the multicast session with the UDM,
using a Nudm_UECM_Update message, which may acknowledge.
5\. UPF session modification step, comprising (13a) the MB-SMF sending a N4
session modification request to the MB-UPF, and (13b) the MB-UPF then
acknowledges the session update.
6\. The MB-SMF transmits Namf_Communication_N1N2MessageTransfer message to the
AMF to request the transfer of the message to the NG-RAN nodes(s). The message
may contain parameters such as the multicast IP address, the port number, the
APN, the NSAPI, etc. of the multicast MB session. The AMF may acknowledge this
transmission.
7\. Step 7 comprising:
7a. The AMF sending to the NG-RAN an N2 Session request message; the NG-RAN
receives association information on individual and shared deliveries mapping
via UE\'s MB session context from the MB-SMF and stores it. This association
may identify the UE(s) to receive MBS data traffic via shared and individual
delivery methods.
7b. The MB session creation being later acknowledged (after step 8) by the NG-
RAN to the AMF with an N2 Session response message that may include downlink
tunnel information.
8\. The NG-RAN establishes the required resources for the UE by e.g. setting
up the relevant bearers.
9\. [OPTIONAL] The NG-RAN node may join the relevant multicast group.
10\. Step comprising:
10a. The AMF transmitting an Nsmf Session UpdateSMContext request to the MB-
SMF to update the multicast session management context with the information
from the NG-RAN including tunnel information.
10b. The MB-SMF confirming the reception with an Nsmf Session UpdateSMContext
response message.
11\. [OPTIONAL] Step comprising the following optional messages:
11a. The MB-SMF may request the MBSF to update the MBS service context (e.g.
the downlink tunnel information that was received in steps 7b, 10) with the
information from the NG-RAN.
11b. [OPTIONAL] Responding to 11a, the MBSF may acknowledge the context
update.
12\. [OPTIONAL] The MBSF may need to internally communicate with the MBSU
regarding the modification of the MBSF service context parameters.
NOTE 3: The MBSF-MBSU communication is out of the scope of SA WG2.
13\. MBS Session start message is sent by MBSF to AF.
14\. Data transmission step takes place comprising:
14a. Initially, the content is transmitted from the content provider to the
MBSU.
14b. The MBSU processes the received data (e.g. applies FEC, raptor codes,
etc.).
14c. The MBSU forwards the multicast data (i.e. the processed data) to the MB-
UPF.
14d. The MB-UPF sends the forwarded data using the associated tunnel to the
NG-RAN nodes.
14e. The NG-RAN node transmits the data over the air using over-the-air PTM
bearers, which is received by the UE.
#### 6.24.2.2 Multicast to unicast switch procedure
Figure 6.24.2.2-1a: Multicast to unicast switch solution
Figure 6.24.2.2-1b: Multicast to unicast switch solution
The switching process is as follows:
0\. An MBS session with shared traffic delivery is established via MBS session
establishment procedures (e.g. session initiation procedure in clause 6.6).
1\. Step 1 shows three potential alternatives to trigger the switch from
multicast to unicast in 5GS. Only one of them may trigger each switch, and the
subsequent steps of the solution are shared.
**Alternative 1: RAN triggered switch (step 1.1)**
While MBS traffic is delivered via shared delivery, NG-RAN may decide to
switch the RAN delivery method from PTM to PTP. This switch may be performed
independently of the 5GC, or depending on the reason to switch (e.g. handover
to non MBS-capable node), it may get the 5GC involved in the switch. Steps
1.1.a. to 1.1.d. show the set of request messages originated by NG-RAN that
need to be forwarded by the network to modify the MBS session via shared
delivery already established. The forwarded messages may include the SUPI,
TMGI/MBS session ID, etc.
1.1.a. N2_Session_Modification Request is sent from NG-RAN to AMF.
1.1.b. Nsmf_Session_Modification Request is sent from AMF to MB-SMF, in
response to the AMF receiving the N2_Session_Modification Request.
1.1.c. Nmbs Session Modification Request is sent from the MB-SMF to the MBSF,
in response to the MB-SMF receiving the Nsmf_Session_Modification Request.
1.1.d. MBS Session Notification is optionally sent from the MBSF to the NEF
which then forwards it to the content/application server - only needs to take
place in case the content server is required to be aware of the switch from
shared to individual delivery of the MBS session.
**Alternative 2: MBSF triggered switch (step 1.2)**
1.2 This alternative assumes MBSF is the entity deciding to perform a switch
from shared to individual MBS traffic delivery. The decision may be based on
different optimization criteria (e.g. UE population in certain areas).
**Alternative 3: Content/application server triggered switch (step 1.3)**
1.3 This alternative accounts for the possibility of the content/application
server deciding to switch from shared to individual MBS traffic delivery.
2\. MBSF initiates switching steps. A precondition to switch to individual
delivery is that a PDU Session for the switching UE exists in the same MB-SMF
that manages the MB Session context for shared delivery. Step 2 also
comprising:
a. The MBSF sends an Nsmf Session Update Request message to the MB-SMF to
request the switch for the UE from shared to individual delivery. The MBSF may
provide several parameters, e.g. SUPI, S-NSSAI, MBS ID/TMGI, DNN, etc. to
update the MB-SMF.
b. Once updated, the MB-SMF responds with an Nsmf Session Update Response.
3\. [OPTIONAL] The MB-SMF may update the UE context registration in the UDM,
using a Nudm_UECM_Update message, which may be acknowledged by the UDM.
4\. MB-SMF sets the individual MB Session context to active and associates it
to the UE\'s PDU session. A precondition for this association is that the PDU
session had previously been activated. Then, MB-SMF sends a session
modification request comprising:
4.a. The MB-SMF sends a N4 session modification request to the MB-UPF
including new tunnelling information.
4.b. The MB-UPF then acknowledges the session update.
5\. The MB-SMF transmits an Namf_Communication_N1N2MessageTransfer message to
the AMF to update AMF on the transfer of the messages to the NG-RAN nodes(s)
with the session association information.
6\. (6a) The AMF sends an N2 Session request message to NG-RAN containing
session association information to inform RAN of the delivery method switch.
The switch may also require NG-RAN to adjust its resources by e.g. switching
the PTM delivery to PTP. (6b) The message is later acknowledged by NG-RAN with
an N2 Session response message after the NG-RAN resources may be set up.
7\. [OPTIONAL] The NG-RAN may require to set up the required resources when
the delivery switch involves a switch in the RAN from PTM to PTP.
8\. The AMF updates the UE context. Then, (8a) The AMF transmits an Nsmf
Session Update SMContext request to the MB-SMF to update the MB session
context with the information from the NG-RAN, updating the tunnel information
for individual delivery; (8b) the MB-SMF confirms the reception with an Nsmf
Session Update SMContext response message.
9\. [OPTIONAL] The MB-SMF requests the MBSF to update the individual MBS
service context with the information from the NG-RAN with an Nmbs Session
Update SM Context request message, and the MBSF acknowledges the context
update with an Nmbs Session Update SM Context response.
10\. [OPTIONAL] MBSF and MBSU may exchange internal messages.
11\. MBS Session start message is sent by MBSF to AF.
12\. Data transmission takes place comprising:
12.a. The IP multicast data is transmitted from the content provider to the
MBSU.
12.b. The MBSU processes the received data (e.g. applies FEC, raptor codes,
etc.).
12.c. The MBSU forwards the MBS data (i.e. the processed data) to the MB-UPF
via 5GC individual traffic delivery.
12.d. The MB-UPF sends the forwarded data to the NG-RAN nodes via individual
delivery.
12.e. Finally, the NG-RAN nodes transmit the MBS data over the air using PTP
bearers, which is received by the UE.
If no additional UEs are left in the MBS session with shared delivery, the 5GC
may either suspend or release the MBS session. Suspending the MBS session does
not involve deleting the MB session context in 5GC NFs to facilitate UEs to
join the MBS session or switch to shared delivery in the future with reduced
signalling while MBSF keeps the MBS service context; releasing an MBS session
does delete all the MBS session contexts from all entities in 5GC. Outstanding
NG-RAN resources for PTM delivery of the shared MBS session are released in
both cases.
**Alternative A: Suspension of shared MBS session**
13.a. The MBSF transmits an Nsmf Session Suspend request to the MB-SMF to
request the suspension of the MB session for shared delivery.
14.a. The MB-SMF transmits an Namf Session Suspend request to the AMF to
forward the suspension request of the MB session for shared delivery.
15.a.1.The AMF transmits an N2 Session Suspend request to NG-RAN to release
any outstanding PTM resources.
15.a.2.The NG-RAN node transmits an N2 Session suspend response message to the
AMF to acknowledge the suspension of the shared MB session.
16.a. [OPTIONAL] The NG-RAN node(s) may release any outstanding allocated
resources to the shared MB session for PTM delivery.
17.a. The AMF transmits an Namf Session suspend response message to the MB-SMF
to acknowledge the suspension of the shared MB session.
18.a. The MB-SMF transmits an Nsmf Session suspend response message to the
MBSF to acknowledge the suspension of the shared MB session.
**Alternative B: Release of shared MBS session**
13.b. The MBSF transmits an Nsmf Session Release request to the MB-SMF to
request the release of the shared MBS session and deletion of associated
resources, which is then acknowledged by the MB-SMF.
14.b. The MB-SMF transmits an Namf Session Release request to the AMF to
request the release of the shared MBS session and deletion of associated
resources, which is then acknowledged by the AMF.
15.b.1. The AMF transmits an N2 Session Release request to the NG-RAN to
request the release of the resources allocated to the shared MB session.
15.b.2.The NG-RAN node transmits an N2 Session release response message to the
AMF to acknowledge the resources release associated to the shared MB session.
16.b. [OPTIONAL] The NG-RAN may release the outstanding allocated resources to
the shared MB session for PTM delivery.
17.b.1.The AMF transmits an Nsmf Release SMContext request message to the MB-
SMF to request the release of the MB session management context for the shared
MBS session.
17.b.2.The MB-SMF transmits an Nsmf Release SMContext response message to the
AMF to acknowledge the release of the MB session management context for the
shared MBS session.
18.b.1. [OPTIONAL] The MB-SMF transmits an Nmbs Release SMContext request to
the MBSF to request the release of the MBS service management context for the
shared MB session.
18.b.2. [OPTIONAL] The MBSF deletes the MBS service context and may transmit
an Nsmf Release SMContext response message to the MB-SMF to acknowledge the
release of the MBS service management context for the shared MB session.
19.b. The MB-SMF transmits an N4 Session release request tp the MB-UPF to
request the release of the shared MB session, which is the acknowledged by the
MB-UPF.
20\. [OPTIONAL] MBSF and MBSU may exchange internal messages.
21\. [OPTIONAL] MBSF may transmit an MBS session end message the
Content/Application Server, which may be first forwarded by the NEF before
reaching the Content/Application Server.
### 6.24.3 Impacts on services, entities and interfaces
This switching solution assumes that an MBS session establishment solution
exists. In addition, the following functionality is required.
**MBSF:**
\- MBSF may control the switching procedure by deciding when to trigger a
switch or by coordinating the decision to switch with NG-RAN and/or the
content server/AF.
**MB-SMF** :
\- MB-SMF stores and manages MBS session context for individual and shared
deliveries in the UE\'s MBS session context.
**NG-RAN** :
\- The NG-RAN may decide the RAN delivery mode (i.e. PTP vs. PTM), and this
may sometimes trigger a switch in the 5GC traffic delivery (i.e. from
individual to shared and vice versa).
\- The NG-RAN may receive the association/mapping information for individual
and shared deliveries from the MB-SMF and stores it.
## 6.25 Solution #25: mode switching between unicast and multicast
### 6.25.1 Functional description
This solution addresses KI #7 assuming the architectural alternative 2 (see
clause A.2).
Key points of the solution are:
\- Based on the MBS session model in the Solution 6.10.
\- There are two switch determining nodes between unicast and multicast. One
is the MB-SMF and another node is the NG-RAN.
\- Based on the number of the UEs receiving the multicast service in a certain
multicast group the MB-SMF decides to transfer the multicast service data via
the PDU session(s) or MBS session. If the PDU session is used, the MB-SMF
requests the MB-UPF to duplicate the data received from the MBSU and transfer
the data to UPF . The UPF send the packet in the mapped QoS flow within the
PDU session for each UE separately. If the MBS session is used, the SMF
requests the MB-UPF to transfer the data from the MBSU in the shared MBS N3
tunnel.
\- If the NG-RAN receives the multicast service data from the shared MBS N3
tunnel, the NG-RAN decides to transfer the multicast service data via a PTP or
PTM over the radio bearer based on the number of the UEs receiving the
multicast service in the NG-RAN.
### 6.25.2 Procedures
Figure 6.25.2-1: MBS mode switch
1\. Based on the amount of the UEs in a certain multicast group, the MB-SMF
decides to transfer the multicast service data via the PDU session(s) or MBS
session. If unicast PDU session is used, the MB-UPF duplicates the data from
the MBSU and send them in the tunnels to UPF for the PDU session(s), or
forward the data from the MBSU into a shared MBS N3 tunnel for MBS session.
2a. The MB-SMF requests SMF for the tunnel between MB-UPF and UPF for
delivering the data to UPF. The SMF may also update the PDU sessions
accordingly. The UPF duplicates the data from the MBSU and send it in the N3
tunnels of the PDU session(s).
2b. The MB-UPF forwards the data from the MBSU into a shared MBS N3 tunnel for
MBS session.
The step 3 to 4 are performed if the NG-RAN receives the service data from MBS
N3 tunnel.
3\. Based on the amount of the UEs camping in the NG-RAN, the NG-RAN decides
to transfer the multicast service data via a PTP or PTM radio bearer.
4a. If the PTM mode is selected, a broadcast DRB is scheduled.
4b. If the PTP mode is selected, the NG-RAN uses the PTP radio bearer to
deliver the data to UE.
NOTE: The NG-RAN node may decide to use the both mode, e.g. the PTM mode is
selected in one cell and the PTP mode is selected in another cell. The details
of step 4 is in the solution 6.22 RAN based switching within NR coverage.
### 6.25.3 Impacts on services, entities and interfaces
MB-SMF:
\- The SMF decides whether multicast service data is transferred via the MBS
session or the PDU sessions.
\- The SMF generates the PDR and FAR to the UPF based on the decision.
MB-UPF:
\- Based on the PDR and FAR from the SMF, the MB-UPF duplicates the data to
each PDU session.
RAN:
\- The NG-RAN decides to transfer the multicast service data via a PTP mode or
PTM mode on the radio bearer.
## 6.26 Solution #26: Reliable MBS session handover with Mapped QoS Flow
### 6.26.1 Functional description
This solution addresses KI #7 assuming the architectural alternative 2 (see
clause A.2).
Key points of the solution are:
\- Based on the MBS session model in the Solution 6.10.
\- The source RAN node has been pre-configured with target RAN node MBS
capability.
\- Upon HO decision, the Source RAN buffers multicast data for the UE.
\- The target RAN receives the context of the mapped QoS Flow of PDU session
via the existing HO mechanism.
\- The source RAN adds QFI of the mapped flow in the encapsulation header of
the buffered multicast data and then forwards them to the target RAN via
direct tunnel or indirect tunnel for the PDU session.
\- If there is no UE joining the multicast group in the target RAN, the MBS
session between MB-SMF and target NG-RAN is established during the HO
procedure.
\- The target RAN receives the correlation between unicast PDU session mapped
QoS Flow and MBS QoS flow and stores it.
\- When the target RAN receives the forwarding data with the QFI of the mapped
flow in the encapsulation header, the target RAN sends the data via radio
bearer for the unicast mapped QoS Flow.
### 6.26.2 Procedures
Figure 6.26.2-1: Xn Handover
0\. The multicast service data is delivered via the MBS session (PTP or PTM
mode).
1\. The source RAN decides to initiate the Xn Handover procedure for the UE
receiving a multicast service data delivered via the MBS session.
2\. The source RAN may buffer the multicast data for the UE.
3.The source RAN sends HO request to the target RAN. The context of the UE
includes the MBS session context and the PDU session context including the
mapped QoS flow context.
3a. If the target RAN is MBS capable, the target RAN checks whether there an
existing MBS session for the same multicast service. If there is no such MBS
session, the target RAN sends MBS session request to MB-SMF received in the
step 3.
3b. If the unicast transport for shared N3 delivery is used, the MB-SMF
indicate the MB-UPF with the downlink tunnel information of NG-RAN received in
the step 3a.
4\. The target RAN sends HO response to source RAN.
5\. The Source RAN sends the HO command message to the UE.
If the PDU session tunnel is used between Source RAN and target RAN, the
source RAN adds QFI of the mapped flow in the encapsulation header of the
buffered multicast data and then forwards them to the target RAN. Upon
reception of the forwarding data with the QFI of the mapped QoS flow, the
target RAN sends such data via a DRB scheduled based on the context for the
mapped QoS flow.
6-13. The unicast PDU session and mapped Qos flow of UE corresponding to the
MBS session is handed over to target RAN after path switch. If the target RAN
does not support MBS and there is no active MBS data from MB-UPF to UPF, the
SMF request MB-SMF to send the DL packet to UPF. When the UPF receives the MBS
data, it send to UE via unicast PDU session.
After step 8, the UPF sends the end marker packet(s) to Source RAN via unicast
PDU session or MBS session for the UE. If the end marker packet(s) is sent in
the shared tunnel, the UPF needs to identify the UE in the end marker
packet(s). The Source RAN sends the end marker to target RAN.
Another option is, there is a timer in the source RAN, after the timer
expires, the source RAN stop sending the forward data.
After step 13, multicast service data can be delivered to the UE in the target
side.
Figure 6.26.2-2: N2 Handover
0\. The multicast service data is delivered via the MBS session (PTP or PTM
mode).
1\. The source RAN decides to initiate the N2 Handover procedure for the UE
with a multicast service delivered via the MBS session.
2\. The source RAN may buffer the multicast data for the UE.
3-4.The source RAN sends HO Required to the AMF. The correlation between MBS
Qos Flow and unicast PDU session Qos Flow may be included in the Source to
Target transparent container or SM context. The AMF sends the HO Request
message to the target RAN.
4a. If the target RAN is MBS capable, the target RAN checks whether there an
existing MBS session for the same multicast service. If there is no such MBS
session, the target RAN sends MBS session request to MB-SMF received in the
step 4.
4b. If the unicast transport for shared N3 delivery is used, the MB-SMF
indicate the MB-UPF with the downlink tunnel information of NG-RAN received in
the step 4a.
5\. The target RAN sends the Handover Request Ack message to the AMF. In the
case of direct forwarding support, forwarding tunnel information is included.
6\. In the case of direct forwarding not support, the AMF requests the
indirect forwarding tunnel information from the SMF.
7\. The AMF sends Handover command message to the source RAN. The forwarding
tunnel information is included.
8\. The source RAN sends the HO command message to the UE.
The source RAN adds QFI of the mapped flow in the encapsulation header of the
buffered multicast data and then forwards them to the target RAN via direct
tunnel or indirect tunnel. Upon reception of the forwarding data with the QFI
of the mapped QoS flow, the target RAN sends such data via a DRB scheduled
based on the context for the mapped QoS flow after step 9.
9\. The UE sends the Handover Confirm message to the target RAN.
10\. The target RAN sends the Handover Notify message to the AMF. If there is
no tunnel for such MBS session, the target RAN provides a DL tunnel
information to the MB-SMF via the AMF.
11-12. The unicast PDU session and mapped Qos flow of UE corresponding to the
MBS session is handed over to target RAN after Handover. If the target RAN
does not support MBS and there is no active MBS data from MB-UPF to UPF, the
SMF request MB-SMF to send the DL packet to UPF. When the UPF receives the MBS
data, it send to UE via unicast PDU session.
After step 11, the UPF sends the end marker packet(s) to Source RAN via
unicast PDU session or MBS session for the UE. If the end marker packet(s) is
sent in the shared tunnel, the UPF needs to identify the UE in the end marker
packet(s). The Source RAN forwards the end marker packets) to target RAN.
Another option is, there is a timer in the source RAN, after the timer
expires, the source RAN stop sending the forward data.
After step 11, multicast service data can be delivered to the UE in the target
side.
For the Xn and N2 Handover from NG-RAN does not support MBS to NG-RAN support
MBS, the associated unicast PDU session is handover to target RAN as normal
HO. After HO, the SMF may switch the individual delivery to shared N3
delivery.
### 6.26.3 Impacts on services, entities and interfaces
RAN:
\- The RAN buffers multicast data for the UE upon decision of HO.
\- The RAN adds QFI of the mapped flow in the encapsulation header of the
buffered multicast data and then forwards them to the target RAN.
\- The RAN provides DL tunnel information for MBS session to CN during
handover procedure, if the first UE joining the multicast group moves in.
## 6.27 Solution #27: Inter-RAN node MBS session Handover
### 6.27.1 Functional description
This Solution addresses Key Issue 7 and is based on Solution 3: Integrated
Multicast and Unicast Transport (see clause 6.3). The solution principles are
as follows:
\- When establishing a Multicast session context with a UE via a unicast PDU
session, the SMF configures the UE and the NG RAN with associated unicast PDU
session information about unicast QoS flows associated with the multicast QoS
flows.
Alternatively, the NG RAN may request the SMF to configure unicast PDU session
with QoS flows associated with the Multicast session context when the NG RAN
expect that a handover to an NG RAN node not supporting 5G MBS might be
required. The NG RAN may also request the SMF to activate a forwarding of
multicast data to the associated QoS flows, e.g. the NG RAN may be using PTP
over the radio (see clause 6.27.2.5).
NOTE: whether this option is necessary can be determined at the normative
phase.
\- UEs camping in an NG RAN node supporting 5G MBS, receive MBS downlink
packets via (N3/MB-N3) shared tunnel and radio resources for the Multicast
session context. The NG RAN may not establish radio resources for the QoS
flows of the associated unicast PDU session (unless the unicast PDU session is
also used for additional unicast traffic)
\- UEs camping in an NG RAN node not supporting 5G MBS, receive MBS downlink
packets via unicast N3 tunnel and radio resources for the associated unicast
PDU session.
\- The MB-SMF may configure the UPF for a same multicast session with:
\- A shared tunnel configuration (serving UEs in 5G MBS supporting RAN nodes);
and
\- Separate individual tunnels for UEs camping in non 5G MBS supporting RAN
nodes.
\- The SMF detects when a UE is moving between supporting and non-supporting
NG RAN nodes, and reconfigures the UPF for that UE accordingly. The SMF may
also reconfigure the NG RAN node if needed.
\- There is no need for SM signalling to the UE during the handover events
since the UE receives the SM context information for both the multicast
session and associated unicast PDU session during PDU session
establishment/modification.
It is assumed that the following pieces of information are exchanged among UE,
NG-RAN and 5GC after the MBS Session has been established or in preparation of
a unicast fallback:
\- The UE can provide the UE\'s MBS capability to the SMF when the UE
establishes the PDU session.
\- For the same QoS flow the NG-RAN receives both the unicast part and
multicast part in the QoS profile information. The mapping from multicast QoS
flow to unicast QoS flow is a 1 to 1 mapping, i.e. one multicast QoS flow is
mapped to one unicast QoS flow. However, there may be unrelated additional
unicast QoS flows. Depending on whether the NG-RAN support MBS, the NG-RAN
uses either the unicast part profile or multicast part profile to establish
the related DRB and tunnel information allocation.
\- The SMF is aware of whether the data packet is transmitted via the
multicast path or unicast path from the response from NG-RAN, e.g. sharing
downlink tunnel or unicast downlink tunnel information.
The handover includes the following scenarios:
\- The source RAN support MBS, UE receives data via MBS Session in Source RAN:
a) Target RAN node does not support MBS:
The MBS Session is converted to the unicast PDU Session during handover.
b) Target RAN node supports MBS:
\- If the MBS Session is not established in Target RAN, the MBS Session can be
established during the HO procedure.
\- If the MBS Session is established in Target RAN, reuse the existing MBS
session in target RAN.
\- **Depending on 3GPP RAN WG decision** : The source RAN performs temporary
MBS data forwarding to the T-RAN. The MB-UPF in addition add sequence numbers
to MBS data it forwards. This enables the T-RAN to address potential data loss
or duplication for the UE being handed over, e.g. by a temporary unicast
transmission of MBS data to the UE entering the cell until it is in synch with
the multicast transmission in that cell.
\- The source RAN does not support MBS, the Target RAN supports MBS:
In source RAN, the MBS data is sent to UE via the unicast PDU Session. When UE
moves to Target RAN, the unicast PDU Session is handed over to the Target RAN
as normal PDU Session handling. After handover completion, the SMF triggers
the conversion from the unicast PDU Session to the MBS Session.
### 6.27.2 Procedures
#### 6.27.2.1 Xn based handover
To cover the scenarios defined in 6.27.1, the Xn based handover procedure is
shown below:
Figure 6.27.2.1-1: MBS Xn based HO towards a RAN
NOTE: For simplification in the figure and description the NG-RAN is shown as
the gNB. It can be extended to the other NG-RAN node.
Comparing to the existing Xn based handover procedure (see TS 23.502 [8] and
TS 38.300 [10]), the following enhancements apply:
2\. In the Handover Request sent to the target RAN.
Depending on whether the source gNB has established the MBS Session (i.e. the
shared MBS traffic delivery method for the UE) or not, in the request sent to
Target gNB the Source gNB includes:
a) both MBS Session information including the associated MBS Session
identifier and unicast PDU Session information (i.e. the shared MBS traffic
delivery method is configured for the UE); or
b) only unicast PDU Session information. The unicast PDU Session information
also includes the information of the QoS flows of the unicast PDU session
associated with the MBS session (i.e. the individual MBS traffic delivery
method is configured for the UE).
NOTE: For the case of source RAN not supporting 5G MBS, b) always applies.
For b), i.e. if the UE receives data via the unicast PDU Session (i.e. the
individual MBS traffic delivery method is used) in the Source gNB, the
procedure is the same as the existing Xn based handover procedure. After the
handover has been executed, step 29 is performed to join the MBS session.
For a):
\- the source gNB provides the information in a backward compatible manner,
i.e.:
\- A non-supporting target gNB will only understand the unicast PDU session
information and ignore the MBS session information, proceeding only with
unicast resources.
\- A supporting target gNB will understand the MBS session information and
proceed with resources for the MBS session as described in this procedure.
\- Depend on whether the Target gNB support MBS or not, the MBS Session
information is used to allocate resource or not. If the MBS Session
information is used, the corresponding QoS flow part information in the
unicast PDU Session information is not used.
\- If the MBS Session has already been established in Target gNB, clause
6.27.2.3 describe how to guarantee lossless data.
If Target gNB support MBS and the MBS delivery session for the indicated MBS
Session has not been established towards Target gNB, the Target gNB allocates
the shared downlink tunnel information for receiving the MBS data from 5GC and
step 3 to 7 applies:
3\. Target gNB selects the AMF to reach MB-SMF and signals a request towards
AMF [MB-SMF ID, Multicast context/group ID]. If the RAN node is configured to
use a unicast transport for multicast distribution sessions, it allocates a
downlink tunnel ID (an IP address and a GTP-U TEID) for the reception of the
multicast distribution session and indicates the downlink tunnel information
in the request.
4\. AMF forwards the request towards the MB-SMF.
5\. For unicast transport of the multicast distribution session, MB-SMF
configures MB-UPF to transmit the multicast distribution session towards
Target gNB (using the received IP address and a GTP-U TEID).
6\. MB-SMF sends a multicast distribution session response to AMF. For
multicast transport of the multicast distribution, it indicates in the
downlink tunnel information the transport multicast address for the multicast
session.
7\. AMF forwards multicast distribution session response to Target gNB.
8\. In the response message, the Target gNB includes the admitted unicast PDU
Session information, and, if the MBS Session has been accepted at the Target
gNB, also the MBS Session information. Based on the response message, the
source gNB knows whether the Target RAN supports MBS Session or not.
NOTE: If the Target gNB support MBS, the Target gNB allocates resources to
receive data based both on the shared downlink tunnel information and the
unicast PDU session downlink tunnel information.
9\. If the Target gNB does not support the MBS Session, the MBS Session
packets are forwarded to the Target gNB as QoS flow within the unicast PDU
Session. After UE successfully connected to the Target RAN, the target RAN
starts to send the forwarded data to UE.
10\. The source RAN sends the Handover Command to UE.
12\. The Target gNB sends Path Switch Request to AMF. The Path Switch Request
includes N2 SM message for each active PDU Session including the MBS Session
information if it is accepted in the Target gNB.
13\. The AMF invokes Nsmf_PDUSession_UpdateSMContext request towards SMF, the
message includes the received N2 SM message.
Based on the received N2 SM message, the SMF can differentiate two cases:
Case A) The Target gNB supports MBS. Step 14 applies and steps 15\~21 are
skipped.
14\. The SMF interact with the UPF only for unicast PDU Session. The SMF
instructs the UPF to send the end market packet towards the source gNB and to
send subsequent packets towards the target gNB within the unicast PDU Session.
Case B) The Target gNB does not support MBS and the UPF is not yet configured
to forward multicast data via unicast. Steps 15 to 21 apply.
15\. The SMF instructs the UPF to forward multicast data within the unicast
PDU. If delivery of the multicast data from MB-UPF to UPF needs to be
configured, and unicast transport is to be used, the SMF also instructs the
UPF to allocate a tunnel endpoint for reception of multicast data from the MB-
UPF.
If delivery of the multicast data from MB-UPF to UPF needs to be configured,
steps 16 to 18 apply.
16 The SMF sends a request to the MB-SMF to distribute multicast data toward
the UPF and provides the tunnel endpoint received in step 5.
17\. If multicast data are transported via unicast, the MB-SMF configures the
MB-UPF to send the multicast data to the received tunnel endpoint.
18\. The MB-SMF replies to the SMF. If multicast data are transported via
multicast, the MB-SMF provides endpoint information including the transport
multicast address.
19\. If multicast data are transported via multicast, the SMF provides
endpoint information including the transport multicast address to the UPF. The
SMF instructs the UPF to send the end marker packet towards the source gNB and
to send subsequent packets towards the target gNB within the unicast PDU
Session.
21\. The Source gNB forwards the end marker to Target gNB via the PDU session.
The target gNB starts to send the buffered packets for the PDU Session
including buffered MBS data if any to the UE.
If the Source gNB previously received the MBS session data from MB-UPF but
does no longer require them because no other served UEs participate in the MBS
session steps 22 to 26 apply:
22\. Source gNB signals a request to terminate multicast distribution towards
AMF [MB-SMF ID, Multicast context/group ID].
23\. AMF forwards the request towards the MB-SMF.
24\. For unicast transport of the multicast distribution session, MB-SMF
configures MB-UPF to terminate transmitting the multicast distribution session
towards the Source.
25\. MB-SMF sends a multicast distribution session termination response to
AMF.
26\. AMF forwards multicast distribution session response to Source gNB.
Step 29 is performed only for the case: if the source gNB does not support
MBS, but the Target gNB supports MBS:
29\. After handover completion, if the UE and Target RAN supports MBS per
received N2 SM information, the SMF triggers the MBS session establishment,
and request Target gNB to establish the MBS Session. Steps 6 to 23 of Solution
3 (see clause 6.3.2.1) are performed.
#### 6.27.2.2 N2 based handover
To cover the scenarios defined in 6.27.1, the N2 based handover procedure is
shown below:
Figure 6.27.2.2-1: MBS N2 based HO towards a RAN
Comparing to the existing N2 based handover procedure (see TS 23.502 [8]
clause 4.9.1.3), the following enhancements is added:
2\. The source RAN sends the handover required to S-AMF.
Depending on whether the source RAN has established the MBS Session (i.e. the
shared MBS traffic delivery method for the UE) or not, in the RAN container
the Source RAN includes:
a) both MBS Session information including the associated MBS Session
identifier and unicast PDU Session information (i.e. the shared MBS traffic
delivery method is configured for the UE); or
b) only unicast PDU Session information. The unicast PDU Session information
also includes the information of the QoS flows of the unicast PDU session
associated with the MBS session (i.e. the individual MBS traffic delivery
method is configured for the UE).
NOTE 1: For the case of source RAN not supporting 5G MBS, b) always applies.
Also the Source RAN indicates QoS flow(s) for which forwarding is needed.
4\. Based on whether the MBS Session is established at the source RAN side,
the SMF can differentiate two cases:
\- If MBS Session has been established at the source RAN, the SMF includes
both MBS Session information including the associated MBS Session identifier
and unicast PDU Session information to the Target RAN.
\- If MBS Session has not been established at Source RAN, the SMF only
includes the unicast PDU Session information to the Target gNB, i.e. the QoS
flows of the PDU Session include the QoS flows for MBS data packet.
\- An indication of whether forwarding is possible is also included in the N2
SM message.
5\. The Target RAN prepares the radio resource based on the received
information.
For the case that the Target RAN received MBS QoS profile with only unicast
PDU Session information:
\- Since the MBS data are transmitted via the unicast QoS flows of the PDU
Session, the Target RAN just allocates resource for the unicast PDU Session as
usual.
For the case that the Target RAN received both MBS Session information and
unicast PDU Session information:
\- If the Target RAN does not support MBS, the MBS Session information is not
used. The Target RAN uses the unicast PDU Session information to allocate
resource to deliver MBS data. The MBS data are transmitted as one of the QoS
flows in the unicast PDU Session.
\- If the Target RAN supports MBS, the Target RAN use the MBS Session
information allocate resource to deliver the MBS data. The corresponding QoS
flow part information in the unicast PDU Session information is not used.
NOTE 2: If the Target gNB support MBS, the Target gNB allocates resources to
receive data based both on the shared downlink tunnel information and the
unicast PDU session downlink tunnel information.
If Target RAN support MBS and the MBS delivery session for the indicated MBS
Session has not been established towards Target RAN, the Target RAN allocates
the shared downlink tunnel information for receiving the MBS data from 5GC and
steps 6 to 10 apply:
6\. Target RAN node selects the AMF to reach MB-SMF and signals a request
towards AMF [MB-SMF ID, Multicast context/group ID]. If the RAN node is
configured to use a unicast transport for multicast distribution sessions, it
allocates a downlink tunnel ID (an IP address and a GTP-U TEID) for the
reception of the multicast distribution session and indicates the downlink
tunnel information in the request.
7\. AMF forwards the request towards the MB-SMF.
8\. For unicast transport of the multicast distribution session, MB-SMF
configures MB-UPF to transmit the multicast distribution session towards
Target RAN node (using the received IP address and a GTP-U TEID).
9\. MB-SMF sends a multicast distribution session response to AMF. For
multicast transport of the multicast distribution, it indicates in the
downlink tunnel information the transport multicast address for the multicast
session.
10\. AMF forwards multicast distribution session response to Target RAN node.
11\. The Target RAN sends handover request Ack to T-AMF, includes N2 SM
message for each accepted PDU Session and MBS Session (if need and accept) as
allocated at the step 5.
12\. The T-AMF invokes Nsmf_PDUSession_UpdateSMContext request towards SMF,
the message includes the N2 SM message.
13\. If the target RAN does not support MBS, and indirect forwarding is
needed, the forwarding tunnel for unicast PDU Session is used for the MBS
data. The indirect forwarding tunnel is established as in existing N2 based
handover procedure in TS 23.502 [8].
17\. The source RAN sends the Handover Command to UE.
18\. The source RAN forwards data to the target RAN either directly or
indirectly via the UPF.
If the target RAN does not support MBS, the source RAN copies the MBS data
received from 5GC, and forwards the packet(s) via the unicast PDU session
forwarding tunnel to Target RAN.
21\. The AMF invokes Nsmf_PDUSession_UpdateSMContext request towards SMF, the
message includes the received N2 SM message.
Based on the received N2 SM message, the SMF can differentiate two cases:
**Case A)** The Target RAN supports MBS. Step 22 applies and steps 23\~29 are
skipped.
22\. The SMF interact with the UPF only for unicast PDU Session. The SMF
instructs the UPF to send the end marker packet towards the source gNB and to
send subsequent packets towards the target gNB within the unicast PDU Session.
**Case B)** The Target RAN does not support MBS. If the UPF is not yet
configured to forward multicast data via unicast, steps 23 to 29 apply.
23\. The SMF instructs the UPF to forward multicast data within the unicast
PDU. If delivery of the multicast data from MB-UPF to UPF needs to be
configured, and unicast transport is to be used, the SMF also instructs the
UPF to allocate a tunnel endpoint for reception of multicast data from the MB-
UPF.
If delivery of the multicast data from MB-UPF to UPF needs to be configured,
steps 24 to 27apply.
24\. The SMF sends a request to the MB-SMF to distribute multicast data toward
the UPF and provides the tunnel endpoint received in step 5.
25\. If multicast data are transported via unicast, the MB-SMF configures the
MB-UPF to send the multicast data to the received tunnel endpoint.
26\. The MB-SMF replies to the SMF. If multicast data are transported via
multicast, the MB-SMF provides endpoint information including the transport
multicast address.
27\. If multicast data are transported via multicast, the SMF provides
endpoint information including the transport multicast address to the UPF. The
SMF instructs the UPF to send the end market packet towards the source gNB and
to send subsequent packets towards the target gNB within the unicast PDU
Session.
28\. The UPF sends the end marker packet(s) for the specific UE via old path
of the PDU session to the Source RAN.
29\. The Source RAN forwards the end marker to Target RAN via the PDU session.
If the Source RAN node previously received the MBS session data from MB-UPF
but does no longer require them because no other served UEs participate in the
MBS session steps 30 to 34 apply:
30\. Source RAN node signals a request to terminate multicast distribution
towards AMF [MB-SMF ID, Multicast context/group ID].
31\. AMF forwards the request towards the MB-SMF.
32\. For unicast transport of the multicast distribution session, MB-SMF
configures MB-UPF to terminate transmitting the multicast distribution session
towards the Source RAN node.
33\. MB-SMF sends a multicast distribution session termination response to
AMF.
34\. AMF forwards multicast distribution session response to Source RAN node.
Step 36 is performed only if the source RAN does not support MBS, but the
Target RAN supports MBS:
36\. After handover completion, if the UE and Target RAN supports MBS per
received N2 SM information, the SMF triggers the MBS session establishment,
and request Target RAN to send MBS data to UE via the MBS Session. Steps 6 to
23 of clause 6.3.2.1 are performed.
#### 6.27.2.3 Lossless packet transferring
**Depending on 3GPP RAN WG decision** : If the Target RAN supports MBS, the
MBS Session packets are forwarded to the Target RAN. This enables the Target
RAN to address potential data loss or duplication for the UE being handed
over, e.g. by a temporary unicast transmission of MBS data to the UE entering
the cell until it is in synch with the multicast transmission in that cell. To
enable the Target RAN to behave accordingly, a sequence number is inserted in
for each data packet of the MBS session by MB-UPF and forwarded to NG-RAN.
During the handover procedure the Target NG-RAN compares the data packet
sequence number of the forwarded MBS data from Source NG-RAN and the data
packet sequence number of the MBS data received directly from 5GC. Based on
the comparison the Target NG-RAN determines when to sends the MBS data
received directly from 5GC to the UE. For example, when the data packet
sequence number of the forwarded MBS data from Source gNB is equal to the data
packet sequence number of the MBS data received directly from 5GC, the Target
NG-RAN switches from unicast to multicast, the Source RAN set starts a timer
when it starts to forward MBS packets to the Target RAN. When the timer
expires, the Source RAN terminates the data forwarding. It is assumed when
this timer is expired, the data packet gap of the MBS data between the two
different gNB has been filled via the forwarding data path.
If the target side does not support MBS, the MBS data is sent to Target gNB as
unicast PDU Session from MB-UPF via the UPF. SMF set a timer to hold the MBS
data packet at the UPF. When the timer expires, the SMF enable the MBS data
sent from UPF to Target gNB.
#### 6.27.2.4 Idle mode mobility between non-supporting NG RAN and supporting
NG-RAN node
During idle to connected mode transition the SMF detects whether the UE is
connecting via a supporting or non-supporting NG RAN node, and configures the
UPF and NG RAN accordingly.
For detail procedure refer to solution 32: MBS Session activation and,
deactivation
#### 6.27.2.5 Preparation for unicast fallback if PDU session does not yet
include required QoS flows to transport multicast data
When establishing a Multicast session context with a UE via a unicast PDU
session, the SMF may configure the NG RAN with unicast QoS flows associated
with the multicast QOS flows in preparation of a future unicast fallback.
Alternatively, the NG RAN may request the SMF to configure unicast PDU session
with QoS flows associated with the Multicast session context when the NG RAN
expect that a handover to an NG RAN node not supporting 5G MBS might be
required as shown in Figure 6.27.2.5-1.
Figure 6.27.2.5-1: Preparation for unicast fallback if PDU session does not
yet include required QoS flows to transport multicast data
NOTE: For simplification in the figure and description the NG-RAN is shown as
the gNB. It can be extended to the other NG-RAN node.
If the shared MBS traffic delivery method is used for the UE and the source
gNB is aware that neighbouring cells do not support MBS traffic delivery steps
1 to 14 can be applied.
1\. The source gNB may receive measurements reports from the UE that make a
future handover to another target gNB likely.
2\. The source gNB may detect, for example, based on pre-configured
information or stored information from previous handovers about neighboring
nodes that a handover to a target gNB not supporting MBS may happen.
3-4. The source gNB sends a Unicast Delivery Request to the SMF (e.g. using N2
procedure and Nsmf_PDUSession_UpdateSMContext_Request). If unicast QoS flows
corresponding to the multicast QoS flows are not yet established, the source
NG RAN may indicate to the SMF a downlink tunnel information for the
individual MBS traffic delivery method which the SMF can use to configure the
user plane and data forwarding for individual MBS traffic delivery method
(i.e. via unicast). The SMF decides whether to activate the unicast delivery
(as assumed in the subsequent steps).
5\. The SMF instructs the UPF to forward multicast data within the unicast PDU
session and may provide the received downlink tunnel information. If delivery
of the multicast data from MB-UPF to UPF needs to be configured, and unicast
transport is to be used, the SMF also instructs the UPF to allocate a tunnel
endpoint for reception of multicast data from the MB-UPF.
If delivery of the multicast data from MB-UPF to UPF needs to be configured,
steps 6 to 9 apply.
6\. The SMF sends a request to the MB-SMF to distribute multicast data toward
the UPF and provides the tunnel endpoint received in step 5.
7\. If multicast data are transported via unicast, the MB-SMF configures the
MB-UPF to send the multicast data to the received tunnel endpoint.
8\. The MB-SMF replies to the SMF. If multicast data are transported via
multicast, the MB-SMF provides endpoint information including the transport
multicast address.
9\. If multicast data are transported via multicast, the MB-SMF provides
endpoint information including the transport multicast address to the UPF.
If dedicated associated unicast QoS flows for multicast data are required and
have not been allocated before, steps 10 to14 apply.
10\. The SMF initiates the PDU session modification procedure to configure the
associated unicast QoS flows for multicast data in the source gNB and in the
UE.
11\. The source gNB sends the NAS PDU Session Modification command to the UE
and may decide to switch to unicast delivery and then also send related RRC
Reconfiguration to the UE.
12\. Any data received on the associated QoS flows are buffered by the source
NG RAN until the RRC reconfiguration is complete.
13\. The UE completes the RRC reconfiguration and informs the source NG RAN by
transmitting the RRC Reconfiguration Complete message.
14\. The source NR RAN completes successfully the PDU session modification and
sends PDU Session Modification Response.
### 6.27.3 Impacts on services, entities and interfaces
SMF
\- Maps the MBS into PDU Session or to MBS session depending on UE MBS
capability and RAN capability
\- Detection of mobility between supporting and non-supporting NG RAN nodes
and reconfiguration of UPF and NG RAN.
\- Set timer to hold/enable MBS data packet forwarding at the UPF to avoid
packet loss in the case target RAN does not support MBS
MB-UPF
\- **Depending on 3GPP RAN WG decision** : Add sequence number into MBS
packets
RAN
\- **Depending on 3GPP RAN WG decision** : Forward MBS data to Target RAN
supporting MBS.
\- **Depending on 3GPP RAN WG decision** : Handle sequence number of forwarded
MBS packets and MBS packets received from CN to reduce packet loss during
inter RAN node handover.
\- Forward MBS data to Target RAN not supporting MBS. This includes:
\- Copy the End Marker from the unicast PDU Session into the forwarding tunnel
of the MBS Session.
\- Optional: Support to request the SMF to reconfigure a UE from the share MBS
traffic delivery method to the individual MBS delivery method.
UE
\- Provide UE MBS capability to SMF to support the mode switch.
## 6.28 Solution #28: Mode switch between multicast and unicast
### 6.28.1 Functional description
#### 6.28.1.1 General
This solution addresses KI#7 \"Reliable delivery mode switching between
unicast and multicast\". The architecture of this solution is based on
architecture alternative-1 (see clause A.1).
The content delivery mode may be unicast instead of multicast due to the
number of the user is too limited or the multicast signalling is weak. When
users successively join into the service, the number of user may be above a
threshold for the service and trigger mode switch for the service, e.g. from
unicast mode to multicast mode or vice versa. When users successively leave
the service, it also may trigger mode switch for the service, e.g. from shared
mode to dedicated mode.
When the service data is transferred using multicast mode, individual or
shared delivery method may be used. There are some conditions for the 5GS to
determine mode switch based on, e.g. number of UEs, target RAN node capability
during mobility. The UE may choose to stay in multicast mode with delivery
method change between \"shared\" and \"individual\".
The following procedures assumes that SMF1 and SMF2 are the same, if
different, the SMF2 is involved, and the AMF determines to interact with the
SMF2 based on SMF ID received from RAN node.
NOTE: How the RAN and UE are expected to handle the MBS packets during the
switching is in RAN scope.
#### 6.28.1.2 Potential triggers for mode switch
The triggers for mode switch maybe include but not limited to the following
factors:
\- Number of devices receiving the specific content.
\- Number of devices in a specific location area related to the specific
content.
\- Measurement of multicast signalling strength.
The first factor may be collected and monitored by AF or by 5GC. The second
factor may be collected and monitored by 5GC or by RAN node. The last factor
is monitored by UE.
### 6.28.2 Procedures
#### 6.28.2.1 Multicast to unicast mode switch triggered by SMF
Figure 6.28.2.1-1 shows the procedure of switch from multicast mode to unicast
mode triggered by SMF, which has a precondition that the AF has used IP
multicast address to deliver multicast service data to users.
Figure 6.28.2.1-1: Multicast to unicast mode switch triggered by SMF
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The SMF decides to perform switch from
multicast mode to unicast mode based on, e.g. the service configuration
provisioned by the AF, the number of user for the multicast service, or the
number of user in a location area. The SMF identifies the users need to
perform mode switch.
The following steps 2-6 are performed for each identified user.
2\. The SMF may get the AMF ID from UDM for the identified user if needed.
3\. The SMF generates a N1 MB message (TMGI/IP multicast address) for mode
switch instruction and invokes Namf_Communication_N1N2MessageTransfer (SUPI,
N1 MB message) service operation towards the AMF.
4\. The AMF forwards the N1 MB message to the user.
5\. The UE decides to use unicast mode. The UE may initiate PDU Session
Establishment / Modification procedure or Service Request procedure to
activate the unicast path with the AF.
6\. The UE requests to receive data with unicast mode from the AF over
application layer, e.g. GC1 interface. The AF may update the service to
trigger the UE to activate a unicast path. The AF sends the service data to
the UE with unicast mode.
7\. The UE starts receiving service data via unicast mode with break-before-
make style or make-before-break style.
8\. The AF, after a specific time, may determine to stop service data delivery
using IP multicast address, e.g. when all user registered in the service have
changed to use unicast mode.
#### 6.28.2.2 Multicast to unicast mode switch triggered by RAN
Figure 6.28.2.2-1 shows the procedure of switch from multicast mode to unicast
mode triggered by RAN, which has a precondition that the AF has used IP
multicast address to deliver multicast service data to users.
Figure 6.28.2.2-1: Multicast to unicast mode switch triggered by RAN
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The RAN node decides to perform mode switch
based on, e.g. the number of interesting user for the multicast service.
2\. The UEs are in RRC_CONNECTED state, e.g. for counting. The RAN node sends
an AN message (List of TMGI) to the UE. The AN message may be the response to
the interest indication, or RRC release message.
3\. The UE decides to use unicast mode. The UE may initiate PDU Session
Establishment / Modification procedure or Service Request procedure to
activate the unicast path with the AF.
4\. The UE requests to receive data with unicast mode from the AF over
application layer, e.g. GC1 interface. The AF sends the service data to the UE
with unicast mode.
5\. The UE starts receiving service data via unicast mode with break-before-
make style or make-before-break style.
6\. The AF, after a specific time, may determine to stop service data delivery
using IP multicast address, e.g. when all user registered in the service have
changed to use unicast mode.
#### 6.28.2.3 Individual to shared delivery method change triggered by UE
Figure 6.28.2.3-1 shows the procedure of mode switch with delivery method
change from \"individual\" to \"shared\" triggered by UE.
Figure 6.28.2.3-1: Individual to shared delivery method triggered by UE
1\. The UE detects it has entered into multicast radio area, e.g. detects the
SAI/TMGI in the SIB. The individual leg may be handed over from other gNB to
the gNB. The UE decides to switch mode and chose to stay in multicast mode
with delivery method changed.
2\. If the transmission resource information for the TMGI cannot be detected,
e.g. in the SIB, the UE performs multicast operation to update the multicast
session for transmission resource reservation for the shared delivery method,
e.g. initiates User Multicast Session Join / User Multicast Context Update
procedure in solution 4 as described in clause 6.4. If different delivery
method is selected, the 5GS will update the PDU Session to de-activate the
individual leg.
3 If the UE detects transmission resource information for the TMGI, e.g. in
the SIB, the UE starts receiving multicast data using shared mode with break-
before-make style or make-before-break style.
4\. If step 2 is not performed, the UE updates the multicast session to de-
activate the individual leg, e.g. initiates User Multicast Context Update /
User Multicast Session Leave procedure in solution 4 as described in clause
6.4.
##### 6.28.2.4 Individual to shared delivery method change triggered by SMF
Figure 6.28.2.4-1 shows the procedure of mode switch with delivery method
change from \"individual\" to \"shared\" triggered by SMF.
Figure 6.28.2.4-1: Individual to shared delivery method triggered by SMF
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The 5GS is using individual delivery method to
deliver multicast service data. The SMF decides to perform mode switch based
on, e.g. the service configuration update provisioned by the AF, the number of
user for the multicast service, or the number of user in a location area. The
SMF identifies the member users that need to perform mode switch.
The following steps 2-6 are performed for each identified user.
2\. The SMF may get the AMF ID from UDM for the identified user if needed.
3\. The SMF generates a N1 MB message (TMGI/IP multicast address) for mode
switch instruction and invokes Namf_Communication_N1N2MessageTransfer (SUPI,
N1 MB message) service operation towards the AMF. The N1 MB message may
indicate delivery method.
4\. The AMF forwards the N1 MB message to the user.
5\. The UE decides to switch mode and chose to stay in multicast mode with
delivery method changed. If the transmission resource information for the TMGI
cannot be detected, e.g. in the SIB, the UE performs multicast operation to
update the multicast session for transmission resource reservation for the
shared delivery method, e.g. initiates User Multicast Session Join / User
Multicast Context Update procedure in solution 4 as described in clause 6.4.
The 5GS will update the PDU Session to de-activate the individual leg.
6\. The UE starts receiving multicast data using multicast radio technology
with break-before-make style or make-before-break style.
#### 6.28.2.5 Individual to shared delivery method change triggered by RAN
Figure 6.28.2.5-1 shows the procedure of mode switch with delivery method
change from \"individual\" to \"shared\" triggered by RAN, which has a
precondition that the serving RAN node knows the mapping between TMGI and the
individual path.
Figure 6.28.2.5-1: Individual to shared delivery method triggered by RAN
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The 5GS is using individual delivery method to
deliver multicast service data, and has provisioned the association between
PDU Session ID and TMGI to the serving RAN node, which is described in
solution #30. The serving RAN node decides to perform mode switch for some
multicast groups based on, e.g. the number of individual legs for a multicast
group.
2\. The RAN node may trigger multicast operation to reserve shared CN tunnel
resources for the multicast groups if not exists, e.g. performs steps 2-15 of
User Multicast Session Join via AN in solution 4 as described in clause 6.4.
The following steps 3-5 are performed for each UE.
3\. The serving RAN node sends an AN message (List of TMGI) to the UE
receiving the multicast service data for mode switch. The AN message may be
RRC release message.
4\. The UE starts receiving multicast data using shared delivery method with
break-before-make style or make-before-break style.
5\. The UE de-activate the individual leg, e.g. initiates User Multicast
Session Leave procedure in solution 4 as described in clause 6.4.
#### 6.28.2.6 Shared to individual delivery method change triggered by UE
Figure 6.28.2.6-1 shows the procedure of mode switch with delivery method
change from \"shared\" to \"individual\" triggered by UE.
Figure 6.28.2.6-1: Shared to individual delivery method triggered by UE
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The 5GS is using shared delivery method to
deliver multicast service data. The UE detects that it is about to move out
the multicast radio area.
2\. The UE decides to switch mode and chose to stay in multicast mode with
delivery method changed. The UE performs multicast operation to update the
multicast session for transmission resource reservation for the individual
delivery method, e.g. initiates User Multicast Session Join / User Multicast
Context Update procedure in solution 4 as described in clause 6.4. If
different delivery method is selected, the 5GS will update the PDU Session to
activate the individual leg.
3\. The UE starts receiving service data using individual delivery method with
break-before-make style or make-before-break style.
#### 6.28.2.7 Shared to individual delivery method change triggered by SMF
Figure 6.28.2.11-1 shows the procedure of mode switch with delivery method
change from \"shared\" to \"individual\" triggered by SMF.
Figure 6.28.2.7-1: Shared to individual delivery method triggered by SMF
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The 5GS is using shared delivery method to
deliver multicast service data. The SMF decides to perform mode switch based
on, e.g. the service configuration update provisioned by the AF, the number of
user for the multicast service, or the number of user in a location area. The
SMF identifies the member users need to perform mode switch.
The following steps 2-6 are performed for each identified user.
2\. The SMF may get the AMF ID from UDM for the identified user if needed.
3\. The SMF generates a N1 MB message (TMGI/IP multicast address) for mode
switch instruction and invokes Namf_Communication_N1N2MessageTransfer (SUPI,
N1 MB message) service operation towards the AMF. The N1 MB message may
indicate delivery method.
4\. The AMF forwards the N1 MB message to the user.
5\. The UE decides to switch mode and chose to stay in multicast mode with
delivery method changed. The UE performs multicast operation to update the
multicast session for transmission resource reservation for the shared
delivery method, e.g. initiates User Multicast Session Join / User Multicast
Context Update procedure in solution 4 as described in clause 6.4. The 5GS
will update the PDU Session to activate the individual leg.
6\. The UE starts receiving multicast data via PDU Session with break-before-
make style or make-before-break style. The SMF may command to stop multicast
service data forwarding via shared delivery method based on, e.g. the number
of UE that has initiated User Multicast Session Join / User Multicast Context
Update procedure.
#### 6.28.2.8 Shared to individual delivery method change triggered by RAN
Figure 6.28.2.8-1 shows the procedure of mode switch with delivery method
change from \"shared\" to \"individual\" triggered by RAN.
Figure 6.28.2.8-1: Shared to individual delivery method triggered by RAN
1\. The UE has on-going group communications with the AF and is receiving
service data by multicast mode. The 5GS is using shared delivery method to
deliver multicast service data. The serving RAN node decides to perform mode
switch based on, e.g. the number of interesting user for the multicast
service.
The following steps 2-4 are performed for each UE.
2\. The UEs are in RRC_CONNECTED state, e.g. for counting. The serving RAN
node sends an AN message (List of TMGI) to the UE for mode switch. The AN
message may be the response to the interest indication, or RRC release
message.
3\. The UE decides to stay in multicast mode with delivery method changed. The
UE performs multicast operation to update the multicast session for
transmission resource reservation for the individual delivery method, e.g.
initiates User Multicast Session Join via CN / User Multicast Context Update
procedure in solution 4 as described in clause 6.4. The 5GS will update the
PDU Session to activate the individual leg.
4\. The UE starts receiving multicast data using individual delivery method
with break-before-make style or make-before-break style.
### 6.28.3 Impacts on services, entities and interfaces
UE:
\- Support receiving mode switch command using NAS or AS message.
RAN node:
\- Support sending AS mode switch command message.
SMF:
\- Support sending NAS mode switch command message.
\- Support sending association between TMGI and PDU Session ID to the RAN
node.
## 6.29 Solution #29: Delivery method change due to UE mobility
### 6.29.1 Functional description
This solution addresses KI#7 \"Reliable delivery mode switching between
unicast and multicast\". The architecture of this solution can be based on the
architecture alternative-1 (see Annex A, clause A.1).
This solution is based on the PDU Session for unicast fallback may not have
been established or activated in advance.
This solution addresses the case when delivery method changed when UE moves.
The UE may use shared delivery method at source gNB enhanced to support
multicast and move to target gNB not enhanced, in this case, the source gNB is
enhanced to serve the UE with PTP method over the radio. Or the UE may use
individual delivery method at source gNB not support multicast and move to
target gNB enhanced.
### 6.29.2 Procedures
#### 6.29.2.1 Xn based shared to individual switch
The following Figure 6.29.2.1-1 illustrates the Xn based procedure of delivery
method change due to UE mobility when UE has active PDU Sessions as well as
source gNB is enhanced and target gNB is legacy. The SMF and UPF serve the
unicast PDU Sessions are not shown in the figure.
Figure 6.29.2.1-1: Xn based shared to individual switch
1\. The source gNB is involved in a multicast session with shared delivery
method. The UE has active PDU Sessions (if the MBS session requests lossless
service continuity, the UE can keep any PDU session active). The PDU Session
for unicast fallback may be active but only serves unicast traffic, hence the
PDU Session for unicast fallback does not associate with any MBS session.
2\. UE to source gNB: AN message (interested TMGIs, measurement report).
3\. Source gNB to target gNB (legacy): Xn Handover Request (Radio resource
info, QoS profile, PDU Session ID).
The source gNB determines the target gNB based on the measurement report and
received TMGIs. When target gNB is legacy, the source gNB performs normal Xn
handover procedure with the target gNB.
NOTE: Before switching happens, the source gNB may already be aware of MBS
related configurations in target side although it is not mandatory to make
such assumption. In this case, source gNB may not only reply on UE measurement
report to determine whether target side is enhanced or legacy.
4\. Target gNB (legacy) to source gNB: Xn Handover Response ().
5\. The source gNB multiplexes all the MBS traffic indicated by the received
TMGIs with the PDU Session traffic and forwards them to the target gNB in the
forwarding tunnel.
6\. Source gNB to UE: HO Command ().
7\. Due to no multicast resource information received, the UE sends Handover
Confirm to the target gNB (legacy) as well as sends NAS multicast session join
message with PDU Session ID (e.g. Service Request or PDU Session Establishment
Request) to the AMF via the target gNB, e.g. piggy-back with the Handover
Confirm. The NAS multicast session join message includes interest TMGIs.
8\. Target gNB (legacy) to AMF: N2 Path Switch (N2 SM Info).
9\. The AMF performs multicast session join procedure with the (MB-)SMF,
(MB-)UPF, target gNB (legacy), and the UE with individual delivery method
selected due to RAN node is legacy, e.g. performs step 2-9 of \"User Multicast
Session Join via CN\" as described in solution 4.
10\. For the sake of keeping the forwarding tunnel, delay the end-mark
delivery for the PDU Session not for unicast fallback is needed, the AMF may
perform Path Switch procedure with the SMF, UPF, and target gNB for the PDU
Sessions not for unicast fallback after the (MB-)UPF has been updated with the
AN tunnel information for the PDU Session for unicast fallback in step 9.
#### 6.29.2.2 N2 based shared to individual switch
The following Figure 6.29.2.2-1 illustrates the N2 based procedure of delivery
method change due to UE mobility when UE has active PDU Sessions as well as
source gNB is enhanced and target gNB is legacy. The SMF and UPF serve the
unicast PDU Sessions are not shown in the figure.
Figure 6.29.2.2-1: N2 based shared to individual switch
1\. The source gNB is involved in a multicast session with shared delivery
method. The UE has active PDU Sessions (if the MBS session requests lossless
service continuity, the UE can keep any PDU session active). The PDU Session
for unicast fallback may be active but only serves unicast traffic, hence the
PDU Session for unicast fallback does not associate with any MBS session.
2\. UE to source gNB: AN message (interest TMGIs, measurement report).
3\. Source gNB to AMF: N2 message (Source to Target Transparent Container, N2
SM Info).
The source gNB determines the target gNB based on the measurement report and
received TMGIs. When target gNB is legacy, the source gNB performs normal N2
handover procedure with the target gNB.
NOTE: Before switching happens, the source gNB may already be aware of MBS
related configurations in target side although it is not mandatory to make
such assumption. In this case, source gNB may not only reply on UE measurement
report to determine whether target side is enhanced or legacy.
4\. The AMF performs PDU Session resource update procedure for PDU Sessions.
5\. The AMF to target gNB (legacy): N2 message (Source to Target Transparent
Container, N2 SM Info).
6\. Target gNB (legacy) to AMF: N2 message (Target to Source Transparent
Container, N2 MB Info).
7\. The AMF performs PDU Session resource update procedure for PDU Sessions.
8\. AMF to source gNB: N2 message (Target to Source Transparent Container, N2
SM Info).
9\. The source gNB multiplexes the MB traffic indicated by the received TMGIs
with the PDU Session data and forwards them to the target gNB in the
forwarding tunnel.
10\. Source gNB to UE: HO Command ().
11\. Due to no multicast radio resource information received, the UE sends
Handover Confirm to the target gNB (legacy) as well as sends NAS multicast
session join message to the AMF, e.g. piggy-back with the Handover Confirm.
The NAS multicast session join message may be Service Request/PDU Session
Establishment Request that includes interest TMGIs for activating or
establishing the PDU Session for unicast fallback.
12\. Target gNB (legacy) to AMF: N2 message ().
13\. The AMF performs multicast session join procedure with the (MB-)SMF,
(MB-)UPF, target gNB (legacy), and the UE with individual delivery method
selected due to RAN node is legacy, e.g. performs step 2-9 of \"User Multicast
Session Join via CN\" as described in solution 4.
14\. For the sake of keeping the forwarding tunnel, delay the end-mark
delivery for the PDU Session not for unicast fallback is needed, the AMF may
perform Path Switch procedure with the SMF, UPF, and target gNB for the PDU
Sessions not for unicast fallback after the (MB-)UPF has been updated with the
AN tunnel information for the PDU Session for unicast fallback in step 13.
#### 6.29.2.3 Xn based individual to shared switch
The following Figure 6.29.2.3-1 illustrates the Xn based procedure of delivery
method change from \"individual\" to \"shared\" due to UE mobility and source
gNB may be legacy. The SMF and UPF serve the unicast PDU Sessions are not
shown in the figure. The UE is receiving the multicast session data
transmitted by the source gNB using PDU Session.
Figure 6.29.2.3-1: Xn based individual to shared switch
NOTE 1: As an option, the PDU Session serves the MBS Sessions can use
specified QoS information for MBS Sessions, e.g. a range of QFI are reserved
for MBS.
1\. UE to source gNB: Measurement Report ().
2\. Source gNB to target gNB (enhanced): Xn Handover Request (PDU Session
related information, [TMGIs]).
As an option, the PDU Session related information indicates which QoS flow is
used for MBS Session.
If the source gNB is enhanced, TMGIs and associated \ are
included too.
NOTE 2: Before switching happens, the source gNB may already be aware of MBS
related configurations in target side although it is not mandatory to make
such assumption. In this case, source gNB may not only reply on UE measurement
report to determine whether target side is enhanced or legacy.
3\. Target gNB (enhanced) to source gNB: Xn Handover Response (Handover
Command (Multicast Resource Info)).
The target gNB reserves multicast resources if multicast information (e.g. the
\, or the TMGIs and associated \) received
from the source gNB, e.g. reserves resources for PTP method. If TMGIs
received, the Multicast Resource Info includes the TMGIs.
As another alternative, the target gNB sends N2 message to the AMF including
the UE ID and may include TMGIs in order to add the target gNB into the
corresponding multicast sessions, e.g. uses step 2-9 of \"User Multicast
Session Join via AN\" as described in solution 4. The target gNB reserves
radio resources for the TMGIs according to the response from 5GC.4. Source gNB
to UE: Handover Command (Multicast Resource Info).
5\. If Multicast Resource Info does not include any multicast radio resource
information, the UE sends Handover Confirm to the target gNB as well as sends
NAS multicast session join message with interest TMGIs to the AMF, e.g. piggy-
back with the Handover Confirm.
NOTE 3: As an option, if not defining a range of QFI for MBS, when source gNB
is legacy, the target gNB cannot know whether the UE is involved in MBS
sessions. In this case, the target gNB indicates a Multicast Indication in the
Handover Command to the UE, and if UE is involved in MBS sessions, the UE
initiates session join along with the Handover Confirm.
6\. Target gNB (enhanced) to AMF: Path Switch ().
7\. The AMF may send PDU Session ID to (MB-)SMF for delivery method selection
if step 3b and 3c are not performed. In case of shared delivery method is
selected, the (MB-)SMF instructs the (MB-)UPF to reserve resources for the
shared CN tunnel and stops forwarding multicast traffic via the PDU Session,
e.g. uses step 3-15 of \"User Multicast Session Join via AN\" as described in
solution 4.
The AMF also continues the Path Switch procedure for PDU Sessions.
The (MB-)UPF stops forwarding the multicast traffic and sends end-mark via the
PDU Session after the shared CN tunnel is established.
#### 6.29.2.4 N2 based individual to shared switch
The following Figure 6.29.2.4-1 illustrates the N2 based procedure of delivery
method change from \"individual\" to \"shared\" due to UE mobility when source
gNB may be legacy. The SMF and UPF serve the unicast PDU Sessions are not
shown in the figure. The UE is receiving the multicast session data
transmitted by the source gNB using PDU Session.
Figure 6.29.2.4-1: N2 based individual to shared switch
1\. The UE to source gNB: Measurement Report ().
2\. Source gNB to AMF: N2 Handover Required ().
NOTE: Before switching happens, the source gNB may already be aware of MBS
related configurations in target side although it is not mandatory to make
such assumption. In this case, source gNB may not only reply on UE measurement
report to determine whether target side is enhanced or legacy.
3\. The AMF sends the PDU Session ID to the (MB-)SMF. The PDU Session for
unicast fallback serves multicast traffic, hence the PDU Session for unicast
fallback is associated with some MBS sessions. The (MB-)SMF knows the
association according to the UE context. The (MB-)SMF determines the delivery
method based on whether the target gNB has already joined into the MBS
sessions UE is interesting and the multicast capability of the target gNB. The
(MB-)SMF sends a N2 MB Info to the target gNB, e.g. uses step 3-10 of \"User
Multicast Session Join via AN\" as described in solution 4. If shared delivery
method is selected, the (MB-)SMF includes the TMGIs UE is interesting,
associated QoS profile, and the PDU Session ID for unicast fallback to the
target gNB. If N2 MB Info does not include any TMGI (individual delivery
method selected), then normal N2 handover procedure is continued.
4\. The AMF to target gNB (enhanced): N2 Handover Request (N2 MB Info (List of
\, SMF IDs)).
5\. Target gNB (enhanced) to AMF: N2 Handover Response (Transparent Container
(HO Command (Multicast Radio Transmission Resource Info)), N2 MB Info (Shared
DL Tunnel Info, SMF IDs).
The target gNB reserves multicast radio resources according to the received N2
MB Info. Besides the PDU Session radio transmission resource information, the
target gNB also includes Multicast Radio Transmission Resource Info in the
Transparent Container. The Multicast Radio Transmission Resource Info may
indicate PTP or PTM will be used by the target gNB.
6\. The AMF forwards the N2 MB Info received from target gNB to the (MB-)SMF
according the SMF ID received in step 5. The (MB-)SMF and (MB-)UPF reserve
shared tunnel transmission resources according to the received Shared DL
Tunnel Info, e.g. uses 13-15 of \"User Multicast Session Join via AN\" as
described in solution 4.
7\. AMF to source gNB: N2 Handover Command (Transparent Container).
8\. Source gNB to UE: HO Command (Multicast Radio Transmission Resource Info).
9\. UE to target gNB (enhanced): Handover Confirm ().
10\. Target gNB (enhanced) to AMF: N2 Handover Complete ().
11\. The AMF continues the N2 Handover Execution procedure for all PDU
Sessions.
### 6.29.3 Impacts on services, entities and interfaces
UE:
\- Support sending Measurement Report including target side information and
interest MBS Session IDs.
\- Support handling AN message including multicast radio resource information.
RAN node:
\- (Source) May support replicating multicast data via shared delivery method
and forwarding to target RAN node.
\- (Source) Support sending MBS Session ID and associated multicast QoS
profile to the target RAN node.
\- (Source) Support multiplexing multicast/broadcast traffic with PDU traffic
into forwarding tunnel.
\- (Target) Support responding multicast radio resource information to the
source RAN node.
\- (Source and Target) Optionally being aware of MBS related
configuration/capability before switching
AMF:
\- Support performing multicast session join procedure before path switch
procedure when handover to legacy RAN node.
## 6.30 Solution #30: Multiple individual legs detection for delivery method
switch
### 6.30.1 Functional description
This solution addresses KI#7 \"Reliable delivery mode switching between
unicast and multicast\". The architecture of this solution can be based on the
two architecture alternatives (see Annex A).
In order to make it possible for RAN node triggering method change from
\"individual\" to \"shared\", the RAN node shall be able to know there\'re
multiple individual legs for a same multicast session. This solution is based
on multicast session information in UE AS context.
### 6.30.2 Procedures
The following Figure 6.30.2-1 illustrates the multicast session information
transfer procedure if the individual delivery method is used.
Figure 6.30.2-1: Multiple individual legs detection procedure
1\. The UE1 performs multicast operation with PDU Session ID1 to join into a
multicast session for data receiving, e.g. uses User Multicast Session Join
procedure in solution 4 described in clause 6.4.
2-3. The SMF sends a mapping between the TMGI and PDU Session ID1 to the RAN
node via the serving AMF.
Step 2-3 may be part of the multicast operation in step 1, e.g. within the
session join operation.
4\. The UE2 performs multicast operation with PDU Session ID2 to join into a
multicast session for data receiving.
5-6. The SMF sends a mapping between the TMGI and PDU Session ID2 to the RAN
node via the serving AMF.
Step 5-6 may be part of the multicast operation in step 4, e.g. within the
session join operation.
7\. When a new PDU Session is activated on a RAN node, the RAN node determines
whether there\'re multiple PDU Sessions corresponding to the same TMGI
according to the multicast session information in all UE AS Context. Depends
on policy, the RAN node can initiate delivery method switching from individual
to shared. The multicast session information is transferred to the target as a
part of UE AS Context.
### 6.30.3 Impacts on services, entities and interfaces
RAN node:
\- Support handling multicast session information in UE AS context.
SMF:
\- Support indicating mapping between TMGI and PDU Session ID to RAN node.
## 6.31 Solution #31: Delivery method switching using PDU session modification
procedures
### 6.**31**.1 Functional description
Editor\'s note: This clause outlines solution principles and documents any
assumptions made.
This solution addresses Key Issue #7 \"Reliable delivery method switching
between unicast and multicast\" based on the baseline architecture 1 in clause
A.1.
The delivery method switching in 5GC may be triggered in the following
scenarios:
\- Triggered by MBS service related network policy, e.g. switching from
unicast mode to multicast mode when the traffic exceeds a certain threshold;
\- UE subscription for MBS service changes, e.g. subscribe or unsubscribe to
the MBS service;
\- UE moving in or out of the MBS Service Area;
\- Change of user preferences on delivery mode for some services/applications.
Also, the NG-RAN may dynamically switch the delivery method of AN resources
for the MBS service from PTM to PTP (or vice versa), based on e.g. number of
UEs receiving the same service simultaneously, radio resource availability,
NG-RAN capabilities.
### **6.31**.2 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
#### **6.31**.2.1 Delivery method switching with the same SMF for PDU session
and MBS session
To support delivery mode switching for an MBS session, the UE or network
requested PDU Session Modification procedures as specified in TS 23.502 [8]
clause 4.3.3 can be reused, with the enhancements to the NFs for triggering
and handling the delivery mode switching of an MBS session associated with the
PDU session. Taking the procedures for non-roaming and roaming with local
breakout scenarios as an example (see TS 23.502 [8] clause 4.3.3.2), the
enhancements are as follows:
Figure 6.31.2.1-1: UE or network requested PDU Session Modification for
delivery mode switching
1a. The UE sends an NAS message containing the PDU Session Modification
Request with indication/information of a new delivery mode to request delivery
mode switching of an MBS session, e.g. due to change of user preferences on
delivery mode for the services/applications.
1b. The PCF performs a PCF initiated SM Policy Association Modification
procedure to notify the SMF about the modified delivery mode for an MBS
session associated with the PDU session, i.e. invoking an
Npcf_SMPolicyControl_UpdateNotify service request with the PDU Session ID, MBS
session ID and an updated PCC rule for the MBS session which includes the
indication and/or information for the new delivery mode (e.g. multicast or
unicast QoS parameters if not already provisioned). This may be triggered e.g.
by a policy decision or upon AF requests.
1c. The UDM updates the MBS related subscription data to the SMF, which may
trigger the delivery mode switching of the MBS session, e.g. change of
delivery mode for the subscribed service associated with the MBS session.
1d. The SMF may decide to modify the delivery mode of an MBS session
associated with the PDU session, e.g. due to changes of network status or
performance.
1e. The NG-RAN indicates to the SMF when the AN resources onto which a QoS
Flow is mapped are switched from multicast to unicast (or vice versa). The NG-
RAN sends the MBS session ID and the indication/information of the new
delivery mode in the N2 SM information to the SMF via the AMF.
1f. The AMF may trigger a PDU session modification to the SMF with the MBS
session ID and indication/information of the new delivery mode, e.g. if the
AMF detects that the UE moves in or out of MBS service area.
2\. The SMF may perform an SM Policy Association Modification procedure by
invoking the Npcf_SMPolicyControl_Update Request towards the PCF to report
subscribed events and/or get the (updated) MBS related PCC Rules.
2a/2b. The SMF sends an N4 session modification request to the UPF for the MBS
session with indication/information for the new delivery mode (e.g. shared
tunnel information when the new delivery mode is multicast, N4 rules for the
new delivery mode; if not already provisioned). The UPF enforces the updated
N4 rules for packet detection, QoS enforcement and reporting and switches to
the tunnel for the new delivery mode.
3a/3b. The SMF sends the PDU Session ID, MBS session ID and the indication/
information for the new delivery mode (e.g. shared tunnel information when the
new delivery mode is multicast, multicast or unicast QoS profiles; if not
already provisioned) in the N2 SM information to the NG-RAN via the AMF
through Nsmf_PDUSession_UpdateSMContext Response or
Namf_Communication_N1N2MessageTransfer request.
3c. The SMF may provide the SMF derived CN assisted RAN parameters tuning,
which includes MBS assistance information to RAN, to the AMF by invoking the
Nsmf_PDUSession_SMContextStatusNotify towards the AMF.
4\. The AMF sends an N2 message to the NG-RAN, which includes the N2 SM
information provided by the SMF and optionally an NAS message containing PDU
Session Modification Command to the UE.
5\. Based on the indication/information of new delivery mode, the NG-RAN may
perform the AN resource modification for the MBS session with the appropriate
QoS profiles (i.e. multicast QoS profiles for multicast mode, or unicast QoS
profiles for unicast mode) and switches to the tunnel of the new delivery mode
for data transfer.
6\. The NG-RAN acknowledges N2 PDU Session Request by sending a N2 PDU Session
Ack Message to the AMF.
7\. The AMF forwards the N2 SM information and the UE location Information to
the SMF via Nsmf_PDUSession_UpdateSMContext service operation.
8\. The SMF may update N4 session of the UPF by sending N4 Session
Modification Request message to the UPF.
9\. The UE acknowledges the PDU Session Modification Command by sending a NAS
message containing PDU Session Modification Command Ack.
10\. The NG-RAN forwards the NAS message to the AMF.
11 The AMF forwards the N1 SM container and the UE location Information to the
SMF via Nsmf_PDUSession_UpdateSMContext service operation.
12\. The SMF may update N4 session of the UPF by sending N4 Session
Modification Request message to the UPF.
13\. If the SMF interacted with the PCF in step 1b or 2, the SMF notifies the
PCF whether the PCC decision could be enforced or not by performing an SMF
initiated SM Policy Association Modification procedure.
#### **6.31**.2.2 Delivery method switching with different SMFs for PDU
session and MBS session
##### **6.31**.2.2.1 Delivery method switching from unicast to multicast
For UE triggered delivery method switching from unicast to multicast, see the
procedure in Figure 6.3.2.1-1 step 3-21.
For other NFs triggered delivery method switching from unicast to multicast,
step 1b-1f of Figure 6.31.2.1-1 are performed with the new delivery method
being multicast, followed by step 6-21 of Figure 6.3.2.1-1.
##### **6.31**.2.2.2 Delivery method switching from multicast to unicast
For delivery method switching from multicast to unicast, step 1a-1f of Figure
6.31.2.1-1 are performed with the new delivery method being unicast, followed
by step 22-34 of Figure 6.3.2.1-1.
### **6.31**.3 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to services, entities and
interfaces.
SMF:
\- The SMF initiates the PDU session modification procedure to modify the
delivery mode of an MBS session, based on local policy or triggers from the
PCF/UDM/AMF/UE.
PCF:
\- The PCF triggers the delivery mode switching of an MBS session via the PCF
initiated SM Policy Association Modification procedure, based on a policy
decision or upon AF requests.
UDM:
\- The UDM updates the MBS related subscription data to the SMF, which may
trigger the delivery mode switching of an MBS session.
AMF:
\- The AMF may trigger a PDU session modification to the SMF for the delivery
mode switching of the MBS session, e.g. when the AMF detects that the UE moves
in or out of the MBS service area.
UE:
\- The UE may request a PDU session modification to the SMF for the delivery
mode switching of an MBS session, e.g. due to change of user preferences on
delivery mode for the services/applications.
NG-RAN:
\- The NG-RAN indicates to the SMF when the AN resources onto which a QoS Flow
of an MBS session is mapped are switched from multicast to unicast (or vice
versa). Upon reception of an N2 message for delivery mode switching of an MBS
session, the NG-RAN may perform the AN resource modification for the MBS
session with the appropriate QoS profiles and switches to the tunnel of the
new delivery mode for data transfer.
UPF:
\- The UPF, upon reception of an N4 session modification request from the SMF
for delivery mode switching of an MBS session, enforces the updated N4 rules
for packet detection, QoS enforcement and reporting and switches to the tunnel
for the new delivery mode.
## 6.32 Solution #32: MBS Session activation and deactivation
### 6.32.1 Functional description
This contribution proposes a solution for MBS session activation and
deactivation and based on solution #3 (see TR 23.757, clause 6.3).
NOTE 1: The initial MBS session activation is covered in solution 3. However,
the present solution adds the possibility to de-activate and re-activate the
MGS session.
This contribution also proposes a solution for re-activating an MBS sessions
after UEs within the MBS session transited to the IDLE state.
NOTE 2: It is assumed that UEs enter the IDLE state based on existing RAN
procedures, and not based on the MBS session deactivation procedure.
Confirmation from RAN that UEs participating in an MBS session can enter the
IDLE state is required.
NOTE 3: It is possible to use either the procedure for MBS sessions
activation, or the procedure for re-activating an MBS sessions after UEs
within the MBS session transited to the IDLE state. Also when the UE in any
state the MBS Session activation/deactivation can be used.
The SMF handling an associated PDU session subscribes to the MB-SMF based on
the multicast group ID for the MBS session activation/deactivation
notification when it retrieves the multicast QoS information from MB-SMF first
time.
The Multicast Session Context include the group membership (i.e. which UE is
belonged to this Multicast group) and multicast flow information. It is
possible that multicast flow is removed or added due to the session
deactivation and activation.
**MBS Session activation:**
The content provider initiates the MBS session activate procedure to activate
an MBS session. During this procedure, the MBS session related multicast flow
information in UE, RAN, SMF are added. The MBS session state in MB-SMF is set
to active state.
**MBS Session deactivation:**
The content provider initiates the MBS session deactivate procedure to
deactivate an MBS session. During this procedure, the MBS session related
multicast flow information in UE, RAN, SMF are removed. Except the multicast
flow information the MBS session related other information in SMF, MB-SMF are
kept and MBS session state in MB-SMF is set as inactive state. The inactive
MBS session can be reactivated by the MBS session activate procedure.
The MBS Session can also be activated due to the incoming MBS data packet, or
be deactivated based on an inactivity timer configured by the MB-SMF at the
MB-UPF.
**Re-activating an MBS sessions after UEs within the MBS session transited to
the IDLE state**
When no multicast data are transmitted within a multicast session for a
certain period, a UE subscribed to a multicast session may become idle. The UE
will then be released from the RAN node, and the RAN node may leave the
multicast data distribution tree. The AMF and SMF maintain information about
the UEs subscription to the multicast group and about multicast QoS flows.
When the MB-UPF detects that multicast data arrive, it notifies the MB-SMF,
and the MB-SMF notifies the SMFs that subscribed. For an idle UE within the
multicast session, the SMF requests the AMF to page the UE. When the UE
transitions to the connected state, a new RAN node may be assigned to the UE.
### 6.32.2 Procedures
#### 6.32.2.1 MBS session activate procedure
The content provider initiates the MBS session activate procedure to activate
an MBS session. During this procedure, the MBS session is changed to active
state in MB-SMF and multicast QoS flow related information in SMF and RAN are
added. The MBS session can also be activated from UP.
Figure 6.32.2.1-1: MBS session activate procedure
1\. A Multicast session is established and an MB-SMF is selected as described
for solution 3.
2\. As part of the multicast session establishment procedure of solution 3,
resources to handle the multicast data reception are reserved at the MB-UPF.
In preparation for Alternative 2, i.e. clause 6.32.2.1 step 8, the MB-UPF may
be configured to report when the first PDU of a Multicast session is received
after a configurable period.
3\. As described for solution 3, an SMF receives a join request for the
multicast session.
4\. As described for solution 3, an SMF retrieves information related to that
multicast session from the UDR including the MB-SMF ID.
5\. The SMF subscribes at the MB_SMF to notifications when multicast data are
being received, i.e. notifications when the first content of a multicast
session is received after a silence period or when the MBS session is to be
activated.
6\. The MBS session is deactivated as described in clause 6.32.2.2.
Either step 7 (alternative 1) or step 8 (alternative 2) is executed.
7\. The content provider want to activate an MBS session. The content provider
sends the multicast session Request to the 5GC via NEF as procedure defined in
clause 6.3.2.2.2a.The message includes an existing multicast group ID and also
an indication of MBS Session activation. As for the Multicast group
configuration procedure, the MB-SMF/MB-UPF allocate the related resource for
multicast flow delivery.
8\. The MBS Session activation can also be triggered from the user plane.
When the MB-UPF received an MBS Data packet and related MBS Session is in
inactivate state, i.e. no DL tunnel info, the MB-UPF notify the MB-SMF of
Session activation. Per that indication, the MB-SMF can activate the MBS
session.
The difference between the CP/UP MBS session activate is that:
\- In the UP session activate case, the multicast QoS flow information reuse
the previous multicast QoS flow information stored at the MB-SMF/MB-UPF.
\- In the CP session activate case, the multicast QoS flow information use the
information provided by the content provided in the step 1.
9\. Using the multicast group ID the MB-SMF determines the affected SMF(s)
(i.e. the serving SMFs for the group member UE associated PDU sessions).
The MB-SMF sends the MBS session activation request (multicast group ID, QoS
flow information) to all affected SMF(s).
10\. After receives the MBS session activate request, based on the multicast
group ID, the SMF identifies the related UE and its associated PDU session.
For each identified UE, if multicast resources were not allocated, the SMF
adds the mapped QoS flow to the associated unicast PDU session and invokes the
Namf_N1N2MessageTransfer service (N2 SM information (PDU Session ID, Multicast
Context ID), N1 SM container (PDU Session Modification Command (PDU Session
ID, multicast information ([Multicast Context ID], multicast address)). If the
associated PDU session is deactivated, the associated PDU session need to be
activated.
If the related UE is in CM-IDLE state, step 11 to step 13 apply.
11-12. As the UE is in CM-IDLE state, the AMF pages the UE via RAN within
Registration Area.
NOTE: Depending on paging procedures introduced in 3GPP RAN WGs: To save radio
resource usage, the SMF can indicate multicast group ID to AMF to enable it
triggers group paging. In that case RAN ignores duplicated group paging
request receives from AMF(s).
13\. Upon reception of paging request, the UE initiates the Service Request
procedure to change to CM-CONNECTED state.
14\. For each related UE, the 5GC handling is same as for the UE joining the
MBS Session defined in the clause 6.3.2.1. This includes the case multicast
flow is transferred via MBS session or via PDU Session.
#### 6.32.2.2 MBS session deactivation procedure
The content provider initiates the MBS session deactivate procedure to
deactivate a MBS session. During this procedure, the MBS session is changed to
inactive state and related multicast QoS flow information in UE and RAN, SMF
are removed. The multicast group membership information in SMF, MB-SMF, and
UDR are kept. The inactive MBS session can be reactivated by the MBS session
activate procedure later. The MBS session can also be triggered to deactivate
from UP.
Figure 6.32.2.2-1: MBS session deactivate procedure
1\. A Multicast session is established and an MB-SMF is selected as described
for solution 3.
2\. As part of the multicast session establishment procedure of solution 3,
resources to handle the multicast data reception are reserved at the MB-UPF.
In preparation for Alternative 2, i.e. clause 6.32.2.3 step 8, the MB-UPF may
be configured to report when the first PDU of a Multicast session is received
after a configurable period.
3\. As described for solution 3, an SMF receives a join request for then
multicast session.
4\. As described for solution 3, an SMF retrieves information related to that
multicast session from the UDR including the MB-SMF ID.
5\. The SMF subscribes at the MB_SMF to notifications when multicast data are
being received, i.e. notifications when the first content of a multicast
session is received after a silence period or when the MBS session is to be
deactivated.
Either step 6 (alternative 1) or step 7 (alternative 2) is executed.
6\. The content provider want to deactivate a MBS session. The content
provider sends the multicast session Request to the 5GC via NEF as procedure
defined in clause 6.3.2.2. The message includes an existing multicast group ID
and also an indication of MBS Session deactivation. Similar as the Multicast
group configuration procedure, the MB-SMF/MB-UPF release the allocated
resource for multicast flow delivery which includes the multicast QoS flow
information.
7\. The MBS Session deactivation can also be triggered to deactivate from the
user plane.
When the MB-UPF detects that the PDU Session has no data transfer for a
specified Inactivity period, the MB-UPF reports the session inactivity to the
MB-SMF.
The MB-SMF keeps the multicast QoS flow information stored at the MB-SMF/MB-
UPF.
8\. Using the multicast group ID the MB-SMF determines the affected SMF(s)
(i.e. the serving SMFs for the group member UE associated PDU sessions).
The MB-SMF sends MBS session deactivation request (multicast group ID) to all
affected SMF(s). The SMF removes the mapped QoS flow from the associated
unicast PDU session.
9\. For each related UE, the 5GC handling is similar as the UE leave the MBS
Session defined in the clause 6.3.2.3. This includes the case multicast flow
is transferred via MBS session or via PDU Session. The difference is that the
multicast group membership information is still kept in the SMF/MB-SMF MBS
Session context.
#### 6.32.2.3 MBS session Reactivation for IDLE UEs
When no multicast data are transmitted within a multicast session for a
certain period, a UE subscribed to a multicast session may become idle. Such a
UE needs to be paged when multicast data are again being transmitted and a new
RAN node may be assigned to the UE during the idle to connected mode
transition.
The reception of multicast data is observed at the MB-UPF and the information
that multicast data are received after a silence period is propagated via MB-
SMF to all SMFs that handle PDU sessions for UEs that joined the multicast
session. SMFs receiving that information request for all PDU sessions related
to UEs that joined the multicast session a paging of the UE (downlink data
notification).
Figure 6.32.2.4-1: Receiving multicast data while UE is idle
1\. A Mulicast session is established and an MB-SMF is selected as described
for solution 3.
2\. As part of the multicast session establishment procedure of solution 3,
resources to handle the multicast data reception are reserved at the MB-UPF.
The MB-UPF is configured to report when the first PDU of a Multicast session
is received after a configurable period,
3\. As described for solution 3, an SMF receives a join request for the
multicast session.
4\. As described for solution 3, an SMF retrieves information related to that
multicast session from the UDR including the MB-SMF ID
5\. The SMF subscribes at the MB_SMF to notifications when multicast data are
being received, i.e. notifications when the first content of a multicast
session is received after a silence period
6\. No Multicast date are received for some time. There is also no other UE
activity and UE transitions into IDLE state.
7\. Multicast data arrive after a silence period
8\. The MB-UPF reports the reception of multicast data to the MB-SMF.
9\. The MB-SMF notifies SMFs that have subscribed about the reception of
multicast data
10\. The SMF sends a Downlink Data Notification towards the AMF for each
identified UE within the multicast session.
11\. The AMFs receiving the Downlink Data Notification pages the related UE.
12\. When the UE becomes connected, a RAN node is selected and the SMF is
informed. The RAN node obtains from the AMF information related to the UE that
includes information about the multicast sessions that the UE joined. During
idle to connected mode transition the SMF detects whether the UE is connecting
via a supporting or non-supporting NG RAN node, and configures the UPF and NG
RAN accordingly.
13\. If the selected RAN node supports MBS and does not yet receive multicast
data for the multicast session, it request multicast data transmission from
the MB-SMF as described for solution 3.
### 6.32.3 Impacts on services, entities and interfaces
SMF:
\- The SMF support the MBS Session activate or deactivate procedure.
MB-SMF:
\- The MB-SMF support the MBS Session activate or deactivate procedure.
AMF:
\- Upon reception of the Namf_N1N2MessageTransfer service message, if the
group member UE in CM-IDLE and if the multicast group ID is included, the AMF
may support a new capability to trigger the group paging in a response to the
reception of a multicast group ID.
## 6.33 Solution #33: Defining interactions between MBSF-C and MBSF-U based on
N4 session management
### 6.33.1 Functional Description
#### 6.33.1.1 System Architecture
Baseline architectures Architecture 1 contains an MSF-U controlled by an
MSF-C, and architecture 2 contains a MBSU controlled by an MBSF for similar
tasks; the MBSF is integrated into the NEF. The converged architecture also
contains an MBSF-U controlled by an MBSF-C. It is expected that proposed
solution can be applied to baseline architecture 1, baseline architecture 2,
and the converged architecture.
The terms CP function and UP function will be used in what follows. A CP
function that could be MSF-C, NEF, or MBSF-C, and a UP function that could be
a MSF-U or MBSF-U.
Editor\'s note: It is FFS if N4 interface as specified in TS 29.244 [17] is
suitable for the interaction between MSF-C and MSF-U. Collaboration with SA
WG4 is needed.
#### 6.33.1.1 High Level Proposal
The procedures between UP function and CP function will be an based on
extension on N4 session management parameters in clause 5.8.2.11 of TS 23.501
[2]. N4 session management is used successfully in the 3GPP ecosystem and
provides capabilities e.g. for packet filtering, forwarding, repacketization
of PDUs (i.e. manipulation of transport layer), event notifications and
billing. It lacks media manipulation capabilities (for transcoding, FEC and
ROHC) and will require related extensions; solution 33 contains proposals for
such extensions.
This has the advantage that N4 session management is well known in the 3GPP
ecosystem and that implementations collocating the UPF (that is already
controlled using N4 session management) and the MBSU/MSF-U to minimize the
user plane processing resources could also become possible in that manner.
#### 6.33.1.2 Requirements
The UP function will need to support transcoding, Forward Error Correction
(FEC), and Robust Header Corrections (ROHC). It will also need to support
receiving data via HTTP streaming.
For FEC, two outgoing streams are created for one incoming stream: a main
stream and a repair stream. If several content streams are received, they will
be transmitted as several outgoing streams, but a single FEC repair stream can
be send for all those content streams.
For ROHC, several outgoing content or FEC repair streams may be combined in
one ROHC stream.
For HTTP streaming, an HTTP requests needs to be sent by the UPF before
obtaining content in HTTP replies.
For Transcoding:
\- it may be necessary to receive an incoming RTCP stream with feedback for an
outgoing RTP stream and adjust the transcoder accordingly.
\- it may be necessary to send an outgoing RTCP stream with feedback derived
by the transcoding for an incoming RTP stream.
Figure 6.33.1.2-1: Incoming ang outgoing data streams at the UP Function
#### 6.33.1.3 N4 session management extensions
It is suggested that the CP function supplies newly introduced \"Packet
Processing Rules\" (PPR), extended Packet Detection Rules (PDR), and
Forwarding action rules (FAR) to the UP Function as part of a PFCP session
establishment or modification.
The UP Function processes and modifies incoming media according to the
received instructions in the PPR:
\- It transcodes the media as requested by the CPF.
\- It applies Robust header compression to outgoing media when requested by
the CPF.
\- It applies Forward Error Correction to outgoing media and generates an
associated outgoing FEC repair stream when requested by the CPF.
\- It monitors the incoming media stream and generates an associated RTCP
feedback stream when requested by the CPF.
\- It receives an incoming RTCP feedback stream and may adjust the media
processing based on the RTCP feedback when requested by the CPF.
\- It provides Event notifications about media processing related Events to
the CPF when requested by the CPF.
\- For HTTP streaming, it generates HTTP requests to obtain streamed HTTP
contents.
A PPR contains:
\- An PPR identifier.
\- Information about the outgoing media format (e.g. CODEC, FEC, ROHC, and
possible parameters for the outgoing media format:
\- Type (e.g. CODEC, FEC, ROHC).
\- Codec specific parameter, e.g. for AMR parameters as defined in clause 8.1
of IETF RFC 4867 [19].
\- Transport, e.g. RTP profile.
\- For ROHC (see IETF RFC 5795 [20] and IETF RFC 3095 [21]): Either profile,
target periodicity for full header packets, MAX_CID parameter.
\- For FEC framework configuration information (see clause 5.5 of IETF RFC
6363 [22]).
\- optional FAR ID for the outgoing media stream.
\- optional subsequent PPR ID.
\- Optional information about the incoming media format:
\- Type (e.g. CODEC, FEC, ROHC).
\- Codec or type specific parameter(s), e.g. for AMR parameters as defined in
clause 8.1 of IETF RFC 4867 [19].
\- Transport, e.g. RTP profile, HTTP streaming.
\- Optional information about associated outgoing media stream:
\- An FAR identifier and/or an PPR ID.
\- Type (e.g. RTCP feedback for incoming media format, FEC repair flow, ROHC
flow, HTTP request).
\- Optional media format or type specific parameter(s).
\- Optional information about associated incoming stream:
\- Type (e.g. RTCP feedback for outgoing media format, ROHC feedback).
\- Optional media format specific parameter.
\- Events to be reported to CP function, e.g.:
\- Unexpected Input media.
\- Resource shortage.
\- For FEC and ROHC: Session establishment success or failure.
The Packet detection rule (PDR) is used as follows:
\- An optional IE to contain PPR ID to be applied for traffic matching the
PDR. Several PPR IDs may be provided and all related PPR shall then be applied
in consecution, in the order the PPR IDS are provided.
\- An indication of the usage of the traffic within the PPR (e.g. associated
stream, RTCP, ROHC, media), can be omitted for media usage.
\- The existing FAR ID in the PDR applies for the main output stream of the
PPR.
\- If the PDR contains an associated PPR ID or indicates that the traffic is
not to be used for media (but e.g for RTCP) within the PDR, it does not
contain a FAR ID.
Figure 6.33.1.2-1: Description of packet processing in the UPF using Packet
Detection Rules (PDRs), Packet Processing Rules (PPRs), and Forwarding Action
Rules (FARs)
### 6.33.2 Procedures
Figure 6.33.2-1: session management interactions to configure UP Function
packet processing
1\. CPF sends PFCP Session Establishment Request and includes PDRs (with PPR
ID, and possible PPR usage information), PPRs (with information about incoming
and outgoing encoding and a possible application of FEC ROHC or HTTP
streaming, about associated incoming streams, and about associated outgoing
streams with FAR IDs, and media processing related Events to be reported), and
FARs).
2\. UP Function is configured accordingly.
3\. UP Function may send an HTTP request for HTTP streaming
4\. UP Function receives an incoming packet.
5\. UP Function processes the incoming packet:
\- It searches a matching PDR.
\- It select PPR(s) according to PPR ID(s) in PDR.
\- It transcodes and applies ROHC and/or FEC according to PPR(s).
\- If sends outgoing packets as described by FARs.
6\. UP Function sends outgoing packet.
7\. UP Function generates RTCP feedback based on PPR instructions and sends it
in backward direction.
8\. UP Function may report media processing related events to CPF based on CPF
subscriptions.
9\. UP Function receives an incoming RTCP packet in backward direction.
10\. UP Function processes the incoming RTCP packet:
\- It searches a matching PDR.
\- It select PPR(s) according to PPR ID(s) in PDR and forwards the stream as
RTCP stream to PPR based on usage information in PDR.
\- It may adjust the media processing base4d on the received feedback.
To enable that several media streams are obtaining a single outgoing FEC
repair stream, several media streams point to the same PPR for FEC. The
pointer may be the PPR ID in the PDR of each media stream. A PPR for FEC may
thus have several input media streams and will then produce an output media
stream for each input media stream (and send this stream to the FAR ID in the
corresponding PDR), and in addition an FEC repair stream (to be sent to the
FAR ID for the outgoing media streams. The PPPR for FEC can be invoked after
other PPRs for transcoding.
Figure 6.33.2-2: Description of packet processing in the UP Function when
several media streams are obtaining a single outgoing FEC repair stream
To enable that several media streams are grouped together in a single ROHC
flow, several media streams point to the same PPR for ROHC. The pointer may be
the PPR ID in the PDR of each media stream and the PDR will then not contain a
FAR ID. A PPR for FEC may thus have several input media streams and will then
produce only a single ROHC stream (to be sent to the FAR ID for the outgoing
media stream in the ROHC PPR). The PPR for FEC can be invoked after other PPRs
for transcoding or FEC.
Figure 6.33.2-3: Description of packet processing in the UP Function when
several outgoing media streams are encapsulated together in a single outgoing
ROHC flow
### 6.33.3 Impacts on services, entities and interfaces
MBSF-C:
\- Support N4 session management extended by Packet Processing Rules.
MBSF-U:
\- Support N4 session management extended by Packet Processing Rules.
\- Support media processing such as transcoding, FEC and ROHC.
\- Support media reception using HTTP streaming.
## 6.34 Solution #34: ASP-handled UE request and authorization
This is ONE of the solutions for \"Key Issue #3: Levels of authorization for
Multicast communication services\".
With this solution, the ASP handles all requests from UEs to receive traffic
and then notifies the 5MBS system to deliver multicast traffic to the
requesting UE.
Consider that a content provider (CP, i.e. ASP) who currently delivers content
via IPv4/6 unicast. A subscriber of the CP clicks a link on a web portal to
request certain content. That request is typically handled by a CDN node
closest to the requesting subscriber. The CDN node starts delivering the
content via unicast after authorization. If the CDN node itself does not yet
have the requested content, it first requests the content from an upper level
node.
That model works transparently regardless of how the subscriber is connected
to the CDN node, e.g. whether it is via wireline or wireless (3GPP)
connection. Now if the requested content is real-time, popular, and high data
rate (e.g. World Cup Soccer matches, American Football games or Chinese Spring
Festival Gala), a huge number of viewers simultaneously watching will put a
huge burden on the network service providers (SPs). As more and more people
watch content on their UEs, this will also impact MNOs because many duplicate
copies of the same content will be delivered by the MNOs.
One way to relieve the burden is for the CP to use multicast for large scale
delivery of real-time high data rate content, coordinating with SPs. Using
IPTV infrastructure is one option and using transparent IPv4/v6 multicast
transport mode of 5MBS is another option in case of MNO. This is explained
further in the following clauses.
### 6.34.1 Functional description
One particular consideration the CP has is that it wants to keep its current
model of handling content request and authorization on its own. Once it
decides that a particular multicast content is to be delivered to a certain
subscriber, it will notify the network service provider to set up relevant
state.
Suppose that the CP/ASP has an agreement with an MNO to deliver IPv4/v6
multicast to UEs and the following approaches are taken:
\- The ASP does its own handling of subscriber requests and authorization, and
then notifies the MNO to start/stop delivery of certain IPv4/v6 multicast flow
to certain UEs. Notice that in this case the UEs don\'t interact with MNO
(e.g. sending IGMP joins) to request multicast data.
\- The MNO tries to set up multicast sessions to the specified UEs per
requests from the ASP. The success/failure status may be notified back to the
ASP so that both operators have the data for tracking charges.
This model works between CPs and SPs (both MNOs and wireline SPs). It will
facilitate the adoption of multicast for large scale real-time high data rate
content delivery, which benefits both the CPs and MNOs/SPs.
### 6.34.2 Procedures
The high level procedures for the ASP-MNO interactions are outlined in the
previous clause already. Once the MNO gets the notification from the ASP to
start/stop sending multicast traffic to a UE, it can be handled as if an
IGMP/MLD join/leave message was received from the UE in the PDU session.
The UE can be identified by any of the following methods:
\- If NAT is not used, UE\'s IP address that the ASP sees in the application
level requests from the UE.
\- Or, If NAT is used, the \ tuple that the
ASP sees in the application level requests from the UE.
NOTE 1: NEF needs to query the NAT device for the corresponding private
address of the UE. If this is not feasible, then GPSI needs to be used as
identification.
Editor\'s note: Whether the NAT device is a new NF or can use existing NF is
FFS.
\- Or, the 5GS assigned UE\'s GPSI that the ASP received in the application
level requests from the UE. The ASP uses the GPSI to identify the UE when it
interacts with 5GS.
NOTE 2: If External Identifier is used as GPSI, it implies that the such
identifier needs to be configured in 5GC for each user from every ASP.
NOTE 3: Use of GPSI should be avoided when possible, so that the ASP can use
the same procedure (that does not require GPSI) for both receivers connected
by wireless and receivers connected by other means that do not use GPSI (e.g.
receivers in a corporate network).
The procedures are integrated into session management solutions. At this time,
only integration with Solution #3 is specified but it is expected to be
integrated also with other selected solutions as appropriate.
Specifically, alternative 1a is added to clauses 6.3.2.1 and 6.3.2.3:
Alternative 1a: ASP (Application Service Provider) signalling (ASP requests
5GC to start/stop sending certain multicast session data to a certain UE).
4A. The ASP determines that a certain UE should start/stop receiving multicast
traffic identified as (multicast source, multicast group), and notifies 5GS
via NEF.
4B. The NEF notifies the SMF (via PCF) of (multicast source, multicast group,
UE identification, start/stop). This is as if the UE sent IGMP/MLD join/leave
to UPF and UPF in turn notified SMF as in Alternative 1.
4C. The SMF notifies session setup/deactivation result to ASP via NEF. If the
UE is not connected at this time, a failure result is sent for a \"start\"
request while a success result is sent for a \"stop\" request.
### 6.34.3 Impacts Analysis
To make this work, there need to be defined interfaces between ASP and MNO for
the following:
1\. ASP registers with MNO for IPv4/v6 multicast delivery with certain QoS
requirement.
2\. ASP notifies MNO of the IP addresses of UEs that should start/stop
receiving certain IPv4/v6 multicast flow.
3\. MNO notifies ASP of the success/failure status of corresponding
notifications from ASP.
The above are likely Nnef interfaces. Depending on how 5MBS is implemented,
Namf/Nsmf/N2/N4 interfaces may be impacted based on the Nnef signalling with
ASPs.
## 6.35 Solution #35: AF specific priority for 5MBS group member
### 6.35.1 Functional description
This solution addresses Key Issue #4 \"QoS level support for Multicast and
Broadcast communication services\". It is based on the baseline architecture 2
in Annex A.2, but might also be applied to architecture 1 in Annex A.1. By
addressing the aspects of KI#4, it is complementary to other solutions to KI#1
and #7 and possibly also to other solutions to KI#4.
Any time during an ongoing MBS session or any time after TMGI allocation, the
AF may provide QoS information to the PCF, including specific QoS requirements
for the MBS service data flows of a specific UE. In RAN this may (depending on
RAN decisions) result e.g. in applying HARQ for the PTM delivery to the UE
even in a loaded resource situation where RAN cannot do this to all UEs, or
other RAN NR specific handling. Note, the term \"QoS\" should in this solution
be interpreted more generally such as the term \"reliability\". Based on the
received information, the PCF determines provides PDU Session policy control
information to the SMF including the specific QoS requirements for the MBS
service data flows of the UE (but that information may be transparently
conveyed by the PCF and the 5GC to the RAN). The SMF provides the QoS
requirements for the MBS service data flows i.e. MBS session ID and MBS
session priority to the RAN. Note that the specific priority is set on bearer
level and not on flow level.
NOTE 1: The PCF provisions PDU Session policy control information to the SMF
of the PDU Session known by the AF (e.g. used for application level
signalling) and the SMF conveys the QoS information to the NR RAN.
NOTE 2: It is assumed that the AF indicates the priority for a multicast
session where a TMGI has been allocated and where the user is registered and
has a PDU session for communication with the AF. In all other cases, this
procedure does not apply.
NOTE 3: RAN coordination is required for special priority procedures.
### 6.35.2 Procedures
#### 6.35.2.1 AF session with required QoS update procedure
The below description specifies updates to TS 23.502 [8] clause 4.15.6.6a \"AF
session with required QoS update procedure\". Proposed changes are shown below
as **_italic bold text_**.
NOTE: The procedure \"Setting up an AF session with required QoS procedure\"
is also impacted with similar changes as defined below.
Figure 6.35.2.1-1: (TS 23.502 [8] figure 4.15.6.6a-1): AF session with
required QoS update procedure
1\. For an established AF session with required QoS, the AF may send a
Nnef_AFsessionWithQoS_Update request message (Transaction Reference ID,
**_[MBS Session Priority, MBS Session ID]_**) to NEF for requesting
prioritization of the MBS Session of a UE.
The MBS Session ID may be a list of MBS Session IDs with associated MBS
Session Priority for each MBS Session ID. A UE may be a member of multiple
groups and the AF may want to set priorities for all the UE\'s groups in a
single message.
2-7. Steps unchanged compared to TS 23.502 [8] clause 4.15.6.6a.
Subsequently, as a result of the above, a PDU Session modification is
triggered by update of the policy by the PCF using the PCF initiated SM policy
association modification.
\- PDU Modification procedure of the PDU Session associated with the MBS
Session provides the MBS Session Priority and the MBS Session ID (e.g. the
TMGI) to the RAN.
\- By reception of the MBS Session ID/TMGI RAN identifies that the QoS
profiles is applied on the handling of the MBS Session for that UE.
#### 6.35.2.2 UE or network requested PDU Session Modification (non-roaming
and roaming with local breakout)
The below description specifies updates to TS 23.502 [8] clause 4.3.3.2 \"UE
or network requested PDU Session Modification (non-roaming and roaming with
local breakout)\". Proposed changes are shown below as **_italic bold text_**.
The UE or network requested PDU Session Modification procedure (non-roaming
and roaming with local breakout scenario) is depicted in figure 4.3.3.2-1.
Figure: 6.35.2.2-1: (TS 23.502 [8] figure 4.3.3.2-1): UE or network requested
PDU Session Modification (for non-roaming and roaming with local breakout)
1\. The procedure may be triggered by following events:
1a. Step unchanged compared to TS 23.502 [8] clause 4.3.3.2.
1b. (SMF requested modification) The PCF performs a PCF initiated SM Policy
Association Modification procedure as defined in clause 4.16.5.2 to notify SMF
about the modification of policies.
**_If the UE specific QoS level for an MBS Session is requested, the PCF
generates the QoS policy for the corresponding MBS Session, and provides the
policy in the PDU session policy control information with the reference to the
MBS Session to the SMF in this step._**
1c-3a. Steps unchanged compared to TS 23.502 [8] clause 4.3.3.2.
3b. For SMF requested modification, the SMF invokes
Namf_Communication_N1N2MessageTransfer ([N2 SM information] (PDU Session ID,
QFI(s), QoS Profile(s), [Alternative QoS Profile(s)], Session-AMBR, [CN Tunnel
Info(s)], QoS Monitoring indication, QoS Monitoring reporting frequency,
[TSCAI(s)], **_MBS Session Priority, MBS Session ID_**), N1 SM container (PDU
Session Modification Command (PDU Session ID, QoS rule(s), QoS Flow level QoS
parameters if needed for the QoS Flow(s) associated with the QoS rule(s), QoS
rule operation and QoS Flow level QoS parameters operation, Session-AMBR))).
**_If the PCF generates a QoS policy for the corresponding MBS Session, and
provides the policy in PDU session policy control information with the
reference to the MBS Session to the SMF in step 1b, the SMF forwards the MBS
Session Priority and the associated MBS Session ID to the RAN._**
3c-4. Steps unchanged compared to TS 23.502 [8] clause 4.3.3.2.
5\. The (R)AN may issue AN specific signalling exchange with the UE that is
related with the information received from SMF. For example, in the case of a
NG-RAN, an RRC Connection Reconfiguration may take place with the UE modifying
the necessary (R)AN resources related to the PDU Session or if only N1 SM
container is received in step 4 from AMF, RAN transports only the N1 SM
container to the UE.
The (R)AN may consider the updated CN assisted RAN parameters tuning to
reconfigure the AS parameters.
As part of this, the N1 SM container is provided to the UE. If the N1 SM
container includes a Port Management Information Container then the UE
provides the container to DS-TT.
**_If RAN received MBS Session Priority associated with MBS Session ID, RAN
uses this information for local RRM policies to ensure for that UE the QoS
level for the respective MBS Session(s) is provided._**
6-13. Steps unchanged compared to TS 23.502 [8] clause 4.3.3.2.
### 6.35.3 Impacts Analysis
AF:
\- The AF provides specific QoS to the PCF. A new IE is added to the existing
procedure for PDU Session QoS update.
PCF:
\- The PCF provides PDU session policy control information including the MBS
Session ID and MBS priority that is propagated to NG-RAN using existing
procedure for PDU Session QoS update.
SMF:
\- The SMF determines the new QoS profiles and provides to the NG-RAN.
\- The new QoS profile is also stored in SMF to be conveyed at subsequent
transitions to CM-CONNECTED mode.
UPF:
\- No impact. The new QoS profile for specific QoS is only used in NG-RAN.
NG-RAN:
\- The NG-RAN links the new QoS profile to a specific MB Session based on a
TMGI in the QoS profile.
\- The NG-RAN uses the new QoS profile to control QoS of a MB Session for a
specific user or member of the MB Session.
## 6.36 Solution #36: QoS Control for MBS Session
### 6.36.1 Functional description
The solution provides a solution to KI#4.
If the MBS service is provided by a dedicated PDU to a UE (i.e. 5GC Individual
MBS traffic delivery method as defined in clause 4.4), the QoS Control is the
same the QoS control as defined in clause 5.7 in TS 23.501 [2].
This solution only focus on the MBS service provided by 5GC shared MBS traffic
delivery method.
The QoS Control (e.g. QoS Parameters, QoS Characteristics etc) for the MBS
Session is similar with PDU Session, so only the differences of the QoS
Control between the PDU session and MBS session control are listed here, the
same part are not listed here.
There are differences as below:
1) Uni-directional QoS Control for the MBS Session
Only DL direction QoS Control and all the MBS QoS Flow are DL only, and No UL
Packet filter sets is used in (MB-)UPF and UE in the MBS Session.
The QoS Control is per MBS Session, it is not per UE per MBS Session.
2) For the GBR QoS Flow, QNC and alternative QoS Profile is not used.
3) For the Non-GBR QoS Flow, Reflective QoS is not used.
4) MBS Session-AMBR.
Each MBS Session is associated with an MBS Session-AMBR. The MBS Session-AMBR
limits the aggregate bit rate that can be expected to be provided across all
Non-GBR QoS Flows for the MBS Session. The MBS Session-AMBR is measured over
an AMBR averaging window which is a standardized value. The MBS Session-AMBR
can be used by the (MB-)UPF to perform the traffic shaping as the Session-AMBR
for the PDU Session. The MBS Session-AMBR is not applicable to GBR QoS Flows
of the MBS Session.
Unlike the subscribed Session-AMBR in UE subscription data in UDM, there is no
per UE subscribed MBS Session-AMBR in a UE subscription. The MBS Session-AMBR
is provided by the MBS AF(or MBSF) to the PCF, the PCF can change the MBS
Session-AMBR based on the local operator\'s policy. The PCF provides the MBS
Session-AMBR to the (MB-)SMF via the PCC rules. The (MB-)SMF can change the
MBS Session-AMBR based on local policy. The MBS Session-AMBR is provided to
RAN and (MB-)UPF. The RAN and (MB-)UPF performance the MBS Session AMBR
enforcement.
During the switching from the shared MBS traffic delivery to the individual
MBS traffic delivery, the MBS Session-AMBR is used to update the Session AMBR
of the PDU Session for the individual MBS traffic delivery. If multiple MBS
multicast Sessions are switched to the same target PDU Session, the Session-
AMBR of the target PDU Session can be updated as the sum of the MBS Session-
AMBR of each source MBS multicast Session.
5) UE-AMBR
The UE-AMBR does not associate with any MBS Session-AMBR. The UE-AMBR limits
the aggregate bit rate that can be expected to be provided across all Non-GBR
QoS Flows excluding the MBS Session of a UE. Each (R)AN shall set its UE-AMBR
to the sum of the Session-AMBR of all PDU Sessions excluding the MBS Session.
There are some QoS-related functions need to TBD as below:
1) Whether Delay Critical resource type GBR QoS is supported in the MBS
Session ?
2) Whether new 5QI is defined for the MBS Session ? Whether new QoS
characteristic is defined for the MBS Session?
### 6.36.2 Procedures
It is expected that procedures to address the requirements QoS control defined
in this solution proposal are proposed as part of MBS session management
procedure.
### 6.36.3 Impacts on services, entities and interfaces
In order to support this solution, the involved network entities need to
support the following functionality.
## 6.37 Solution #37: QoS level support for Multicast and Broadcast
communication services
### 6.37.1 Functional description
This solution addresses Key Issue #4 \"QoS level support for Multicast and
Broadcast communication services\" based on the baseline architecture 1 in
Annex A.1(Figure 2). By addressing the aspects of KI#4, it is complementary to
other solutions to KI#1 and #7.
As described 5G QoS model as defined in TS 23.501 [2] clause 5.7, the 5GC and
NG-RAN ensure QoS by mapping the DL packets to appropriate QoS Flows and radio
bearer. There are two stages of QoS mapping in 23.501, the first stage is
mapping of service data flows (SDFs) to MBS QoS flows (i.e. each flow is
characterized by a QFIs and associated QoS profile) at NAS level. The second
stage is mapping QoS flows (i.e. the user plane traffic with the same QFI a
QoS profile within a PDU session) to the appropriate AN resources (i.e. radio
bearers), in a way that ensures that each QoS flow will receive the
appropriate forwarding treatment at AS level. We propose to classify and
associate the UEs (at one of the above mapping stages) with the QoS flows of
the MBS service(s) that they are interested to receive; and to achieve that:
we propose the following changes for NR MBS QoS enforcement.
\- An UPF or NG-RAN performs QoS enforcement ;
\- An AMF, SMF, UPF or NG-RAN performs the classification of UEs within MBS
service area according their MBS service interest into different MBS service
groups, and the association UEs with flows or QoS profiles;
\- In the case that, UPF performs QoS enforcement, the SMF conveys service
data flow (SDF) to MBS QoS flow QoS mapping. In this case, SMF may associate
UEs with the MBS QoS flows associated with the service they interest in (i.e.
based on the UE identity information received from AMF) and provide the QoS
flow and UE association information to UPF. Alternatively, SMF may may provide
the MBS QoS flow characteristics to AMF via N11; and AMF performs QoS flow and
UE association and provide the association information to NG-RAN -. In both
cases, additional information such as QoS Flow and UE association and QoS
flows information and/or QoS flows and UE identity are supposed to be provided
by SMF (e.g. via a UE MBS context message) to NG-RAN (via N11 and N2 )or to
UPF or SMF(via N4) or by AMF (via N4 and N11) . In case that SMF performs UEs
and MBS flow QoS association, the UEs identity information can be forwarded by
AMF to SMF via N11 (Figure 2). In this way, when UPF performs classification
of DL packets for QoS flow marking, it can easily associate the packets of the
QoS flow with the group of UEs that are interested in the service carried by
flow, so that such packets will get the same forwarding treatment at RAN
level.
\- In the case that, NG-RAN performs QoS enforcement: the UPF conveys the
classification of the user plane traffic belonging to a QoS flow via N3 (and
N9) user plane marking using the QFI. In this case, UPF may associate UEs with
QoS flows (i.e. based on UE identity information provided by AMF (via N11 and
N4)) and QoS information provided by SMF, and forward the QoS flow information
to NG-RAN. Alternatively, the NG-RAN itself may associate UEs with MBS QoS
flow i.e. based on the QoS profile provided by UPF to NG-RAN over N3 tunnel or
by SMF (via AMF over N11 and N2 reference points) and the UE identity
information provided by AMF overN2, or based on service interest (or QoS
requirement) indication and identity information provided by UE to NG-RAN. In
this way, the NG-RAN with knowledge of UEs channel quality condition in MBS
area can easily select to the appropriate radio bearers and forwarding
treatment for each MBS QoS flow.
Figure 6.37.1-1: 5G MBS Network Architecture
Editor\'s note: It is FFS and up to RAN WG2 whether to use an AS indication
(e.g.. within a SIB signalling, transport, logical or physical channels)
between UE and NG-RAN to indicate UEMBS service interest or the QoS of the
interested MBS service carried within the AS indication toward NG-RAN.
### 6.37.2 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
### 6.37.3 Impacts Analysis
**SMF:** The SMF may receive UEs MBS context message from AMF, and may
classify UEs within MBS service area based on their MBS service interest into
different MBS service groups and associate each group with a QoS profile.
**AMF:** The AMF may receive NAS indication from UE containing MBS TMGI
indication. The AMF may forward UEs MBS context message to NG-RAN or SMF. The
AMF may classify UEs within MBS service area based on their MBS service
interest into different MBS service group and associate each group with a QoS
profile.
**UPF:** The UPF may receive UE MBS context message form SMF or NG-RAN,
classify UEs based on their MBS service interest into different MBS service
groups, associate the packets of the QoS flow with the group of UEs that are
interested in the service carried by the QoS flow.
**NG-RAN:** The NG-RAN may classify UEs within MBS service area based on their
MBS service interest into different MBS service groups, associate each group
with a QoS profile and map the PDUs of MBS QoS flows received from UPF to the
appropriate AN radio bearers and MBS scheduling configurations based on the
QoS profile.
## 6.38 Solution #38: Move to Local Multicast services
### 6.38.1 Functional description
This solution addresses Key Issue #6 and proposes a local multicast service
procedures based on the MBS reference architecture alternative 2 (see clause
A.2) and solution #6.
When the AF requests the MBSF to provide a multicast service, the AF provides
the multicast service related information that may include service type,
target (local) service area, target service UE group, QoS requirement
information, and its local service availability (including e.g. local AF ID or
address), where the service type indicates which kinds of MBS services e.g.
V2X services, etc. and target service area indicate the area in which the
contents provider wants to provide service e.g. Cell ID list, TAI list,
geographical area information, etc.
The MBSF setup the MBS service session for the multicast service. AF or MBSF
announces the MBS services, which deliver the MBS service specific parameters
e.g. DNN info, MBS service session ID, target service UE group ID, target
service area, its local service availability (including e.g. local AF ID or
address, local MBSU address), etc. to UEs. Then, the UE in local MBS service
area may join the local multicast service for the MBS service session with
local MBS indication via PDU session establishment/modification procedure,
which the MB-SMF may verify by UE SM subscription information and notify the
UE\'s multicast joining request to the MBSF. In case of local MBS service, a
local MBSU is selected by the MBSF and the MBSF requests the MB Session setup
with the MB-SMF, which may get authorization for the QoS profile from the PCF.
The MB-SMF setup the MB Session based on the MBS service session ID, target
service UE group ID, etc. and associates with the PDU session. During the PDU
session establishment/modification procedure, the MB-SMF sets up the shared N3
tunnel between NG-RAN and local MB-UPF and the UE obtains the radio resource
information to receive the MBS traffic. The shared N3 tunnel for non-local MBS
service, if exists for the MBS service session ID and target service UE group,
should be replaced with the shared N3 tunnel for local MBS service to the NG-
RAN.
Based on the MBS capability of the NG-RAN in the local MBS service area,
individual N3 tunnel may be released or deactivated.
### 6.38.2 Procedures
#### 6.38.2.1 MBS Session initiation procedure for Local MBS services
Figure 6.38.2.1-1: MBS session initiation procedure for local multicast
service
The figure depicts MBS session initiation procedure for local multicast
service as follows.
For (both local and non-local) MBS service setup:
1\. Third party contents provider (or AF) requests MBS service(s) to MBSF
(optionally via NEF) with service characteristics (e.g. service type, optional
target (local) service area, DNAI corresponding to a target (local) service
area, target service UE group, etc.), where the service type indicates which
kinds of MBS services e.g. public safety or V2X services, etc. and target
service area indicate the area in which the contents provider wants to provide
service e.g. Cell ID list, TAI list, geographical area information, etc. For
the local MBS services, AF may provide target local service area.
If geographical area information was provided as target service area by the
third party contents provider (or AF), the NEF or MBSF converts the
geographical area information to Cell ID list or TAI list.
NOTE: Based on the service type, target service area etc., AF may select an
appropriate MBSF. The MBS service setup should be done for both local and non-
local MBS services.
2\. MBSF may check whether the AF is authorized to start the MBS service with
PCF. And DNAI(s) corresponding to local service area is delivered to the PCF.
If DNAI information has not come from AF, the MBSF provides the corresponding
DNAI information to the local service area, which may get from O&M.
3\. If the MBS service session is authorized, MBS service session is setup and
its information (e.g. MBS service session ID, address information of the MBSU,
etc.) is selected by the MBSF. For local MBS services, a local MBSU is
selected and notified to the local AF in the next step.
4\. The MBSF notifies the MBS service session information to the content
provider or AF, which may have information for both local and non-local MBS
services.
5\. MBS service announcement can be delivered to UEs on application level,
which includes the MBS service specific parameters e.g. DNN, MBS service
session ID, its local MBS service support indication, target service UE group
ID, target service area (e.g. Cell ID list, TAI list, geographical area
information, etc), etc. by AF or MBSF.
6\. The UE detects in the local service area based on the target service area
received in step 5.
For UE joining the local multicast services:
7\. If the UE belongs to target service UE group, the UE may join the
multicast services via control plane (i.e. PDU session establishment
procedure, where the same MB-SMF is selected based on its DNN info, MBS
service session ID, target service area, etc.) with local MBS indication,
which is verified based on the UE SM subscription information. In addition,
the MB-SMF may notify the MBSF of the UE joining for the local multicast
services.
There may be the case that the UE joins the multicast services outside the
local service area because the geographical area information was provided as
target service area to the UE in step 5. The MB-SMF checks whether the UE is
inside or outside the local service area. If the UE is outside the local
service area, the MB-SMF sends a Reject message to the UE indicating that the
multicast service join is rejected, and including the reason (outside of local
service area) and Cell ID list or TAI list as target service area.
8\. The MBSF takes an appropriate local MBSU for the local multicast services,
which may be selected by DNAI or target local service area, and may notify the
UE joining for the local multicast services to AF.
For MB Session setup:
9\. MBSF requests an MB session setup to MB-SMF
10\. The MB-SMF may get service authorization including authorized QoS info
and DNAI from PCF, which is authorized for the target service UE group.
11 & 12\. The MB-SMF selects a local MB-UPF and establishes a transport tunnel
between local MBSU and local MB-UPF for shared delivery of the MBS data.
13\. If the UE has joined, the MB-SMF associates the PDU session with the
corresponding MB Session, based on the target service UE group, MBS service
session ID, etc.
In the case that shared N3 tunnel does not exist yet for the local MBS service
area:
14-16. For data transport of shared delivery, the MB-SMF establishes shared N3
tunnel with the NG-RAN(s) to the local MB-UPF. NG-RAN decides delivery mode of
the MBS data i.e. point-to-point delivery or point-to-multipoint delivery e.g.
based on the UE population sharing the target service UE group, MBS service
session ID, etc. The remaining PDU session establishment procedure may be
performed together and the NG-RAN notifies the information on the RAN
resources for point-to multipoint mode to the UE via RRC signalling.
\- if shared N3 tunnel exists as non-local MBS service for the MBS service
session ID and target service UE group, the NG-RAN should not receive the
corresponding MBS data from the (non-local) MB-UPF. So the corresponding MB
session (dedicated to the non-local MBS service) should be deactivated to the
NG-RAN.
\- Individual N3 tunnel should not be setup or deactivated by step 14 - 16 if
the MB-SMF detects that the whole local MBS service area is coved by MBS-
capable NG-RANs, which are based on notification from the AMF based on N2
setup messages (e.g. NG-RAN\'s MBS-capability can be known to the AMF by its
Cell ID or capability indication).
### 6.38.3 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to services, entities and
interfaces.
**MBSF:**
\- The MBSF generates and manages MBS service context and request an MB
session setup to the MB-SMF
\- The MBSF controls the (local or/and non-local) MBSUs for user plane
management, which is a media anchor of MBS traffic in 5GS.
\- The MBSF may translate target MBS service area (e.g. Cell ID list or TAI
list) into DNAI info.
**MB-SMF** :
\- The MB-SMF setup the MB session, which is used for the transport of shared
delivery.
\- The MB-SMF manages the MB session context for shared delivery, and
associate & manages together the UE\'s PDU session context for individual
delivery.
\- The MB-SMF send the association information b/w shared delivery and
individual delivery to the NG-RAN.
\- may decide whether the N3 tunnel for individual delivery should be kept or
deactivate, which is based on whether MBS capability of NG-RANs in the local
service area.
**AMF** :
\- The AMF is enhanced to support MB session management b/w NG-RAN and MB-SMF.
\- may notify MBS capability of NG-RANs in the local service area to the MB-
SMF.
**MB-UPF** :
\- It supports shared tunnel for shared delivery method.
**NG-RAN** :
\- It supports shared tunnel for shared delivery method.
\- The NG-RAN receives the association information from the MB-SMF and stores
it, which may identify the UEs to receive MBS data traffic via shared delivery
method.
\- The NG-RAN may decide RAN delivery mode for MBS data traffic from shared
delivery method i.e. PTP vs PTM.
**N3** :
\- A shared tunnel on this interface is established for an MB session.
**UE** :
\- UE need to indicate its joining on the local MBS service as part of the NAS
message (e.g., PDU Session establishment/modification request).
## 6.39 Solution #39: Solution for multicast and unicast switching using make-
before-break
### 6.39.1 Functional description
The multicast service coverage may be smaller than unicast service coverage
due to different deployment stages. And the UE is moving out of multicast
bearer coverage, the UE needs to be switched from multicast bearer to unicast
bearer. Since the UE coverage is less than before, the normal handling is the
application layer switches to lower quality content. For example, the high
definition video is transmitted via multicast bearer and when the UE coverage
is worse, then switch to low definition video, and this requires end-to-end
switching.
This solution provides a mechanism of make-before-stop for switching from
multicast to unicast or from unicast to multicast.
For the opposite direction scenario, the UE may switch from unicast to
multicast in order to save the unicast resource.
### 6.39.2 Procedures
#### 6.39.2.1 Switching from multicast to unicast
Figure 6.39.2-1: Multicast to unicast switching
1: The UE is receiving multicast service using the multicast bearer.
2: The UE detects it is moving out of multicast service area. The UE detects
the multicast channel signal quality is lower than the preconfigured
threshold; or the UE is notified the MBS service is not supported in potential
targeting cells. The potential targeting cells can be determined by the UE via
e.g. the signal quality of the target cells is getting better and better. The
current serving cell can notify the UE whether the neighbouring cells supports
the multicast service via SIB message.
3: The UE initiates unicast bearer establishment. The UE initiates the PDU
Session establishment if there is no MBS associated PDU Session existing or
the UE activates the existing PDU Session. The AS layer can indicate to NAS
the multicast service information to be stopped, and then the NAS layer
initiates the PDU Session establishment according to the multicast service
information.
4: When the AN resource, e.g. DRB is established for the PDU Session, the UE
stops to receive multicast service via multicast channel.
5: (Optional) The network performs handover procedure if the UE moves to a
cell not supporting multicast service.
#### 6.39.2.2 Switching from unicast to multicast
Figure 6.39.2-2: Multicast to unicast switching
1: The UE is receiving the service via unicast bearer, e.g. there are DRB(s)
for the service.
2: The UE detects the multicast service over multicast channel and this
service is being transmitted over unicast bearer.
3: The UE AS layer provides the detected multicast services and forwards to
NAS layer, and the NAS layer initiates to release the AN resource via i.e.
release or de-activate the PDU Session targeting to the multicast service.
4: The UE starts to receive multicast traffic over multicast traffic.
NOTE: If the unicast traffic is more slowly transmitted than the multicast
service, there could be packets lost during switching from unicast to
multicast.
### 6.39.3 Impacts Analysis
Impact on UE:
\- Detects the multicast service is going to be loss or present.
\- AS indicates to the NAS layer the multicast service information to be loss
or present, NAS layer determines to establish/activate or release/deactivate
the unicast PDU Session.
Impact on NG-RAN:
\- Provide one method for the UE to detect the multicast service is going to
be loss or present.
## 6.40 Solution #40: Reliable delivery mode switching within single RAN/dual
RANs
### 6.40.1 Functional Description
This solution addresses KI#7 \"Reliable delivery method switching between
unicast and multicast\" based on the architecture 1in Annex A, clause A.1.
According to KI#7 note 1, unicast delivery and multicast delivery may have two
meanings depending on which part of the 5G system a solution is referring to.
In order to determine the delivery mode of the data obtained by UE, this
solution mainly discusses the delivery mode switching between RAN and UE.
There are two scenarios in regard to the switching between unicast and
multicast: single RAN and dual RANs. The former means the delivery mode
switching involves one RAN. The latter means the switching involves two RANs.
In the scenario of single RAN, the delivery mode switching may be triggered in
the following cases:
\- Triggered by UE, e.g. UE modifies the subscription. The details are
described in 6.40.2.1.1.
\- Triggered by SMF, e.g. the number of UEs requesting the same content in a
specific area exceeds the threshold. The details are described in clause
6.40.2.1.2.
In the scenario of dual RANs, the delivery mode switching is divided into two
cases according to the type of RAN handover:
\- Xn based handover. The details are described in clause 6.40.2.2.1.
\- N2 based handover. The details are described in clause 6.40.2.2.2.
RAN handover and delivery mode switching are achieved throughout the process.
The make-before-break style is used.
For clarity, the SMF for multicast session is written as (MB-)SMF and UPF for
multicast session is indicated by (MBâ€‘)UPF, the SMF and UPF are used
specifically for unicast sessions.
### 6.40.2 Procedure
#### 6.40.2.1 Delivery mode switching between unicast and multicast within
single RAN
When the RAN connected to the UE does not change, the switching may be
triggered by the UE or the SMF.
##### 6.40.2.1.1 Triggered by UE
Figure 6.40.2.1.1-1:Unicast to multicast mode switching triggered by UE within
single RAN
The figure depicts unicast to multicast switching procedure triggered by UE
within single RAN as follows.
0\. Initially, the UE has ongoing communications with the AF and is receiving
service data by unicast mode.
1\. The UE finds that the trigger condition is met, which decides to switch
mode to multicast, and generates PDU Session Modification Request.
NOTE: Trigger conditions include, but are not limited to UE moving into the
multicast area, users\' preference (because unicast and multicast traffic may
lead to different cost), subscription modification or QoS issue.
2\. The UE sends the PDU Session Modification Request to the AMF. The request
includes the reason for switching to multicast, unicast session ID and SUPI.
3\. The AMF receives the request from the UE and forwards it to the SMF by
invoking the Nsmf_PDUSession_UpdateSMContext.
4\. After receiving the request, the SMF provides the unicast session related
information to the (MB-)SMF.
5\. The SMF configures the UPF because the unicast session is about to end.
6a. Unicast and multicast have different charging rules. The (MB-)SMF informs
the PCF that the UE delivery mode will be switched by invoking the
Npcf_SMPolicyControl_Update Request(including SM Policy Association ID), so
that the PCF can update the policy.
6b. The PCF responds to the (MB-)SMF about the delivery mode switching
notification.
7\. The (MB-)SMF configures the (MB-)UPF.
8-9. The (MB-)SMF sends the unicast session ID, SUPI and the
indication/information about the new delivery mode(e.g. TMGI, (MB-)UPF) in the
N2 Message to the NG-RAN via the AMF through
Namf_Communication_N1N2MessageTransfer. The NG-RAN confirms to the AMF that
the switching can be made.
10\. Based on the N2 Message sent by the SMF, the NG-RAN establishes or
modifies the AN resources for the MBS session according to the selected
delivery mode.
11-12. The UE requests to receive data with multicast mode from the AF over
application layer. The AF updates the service and sends the service data to
the (MB-)UPF. The (MB-)UPF forwards the data to the NG-RAN. The Target NG-RAN
transmits data to the UE by multicast mode.
13\. The UE requests the UPF to stop transmitting the unicast data.
When the UE moves out of the multicast area, it may request to establish a
dedicated unicast session. Switching from multicast to unicast is easier to
guarantee service continuity than switching from unicast to multicast.
EditorÂ´s note: It is FFS how the applicable multicast session and related MB-
SMF are determined by SMF.
##### 6.40.2.1.2 Triggered by SMF
Figure 6.40.2.1.2-1:Unicast to multicast mode switching triggered by SMF
within single RAN
The figure depicts unicast to multicast switching procedure triggered by SMF
within single RAN as follows.
0\. Initially, the UE has ongoing communications with the AF and is receiving
service data by unicast mode.
1\. The AMF can obtain N1 Message such as the location of UE in RAN node;
obtain N2 Message such as the RAN\'s congestion status; send the information
to the SMF by invoking the Nsmf_PDUSession_UpdateSMContext.
NOTE: The information includes but is not limited to unicast session ID, SUPI,
the mapping relationship between UE and RAN node, the communication capability
of RAN, and the availability of wireless resources.
2\. The SMF is able to collect and predict the demand of each content.
According to the information sent by the AMF, if the number of unicast
sessions carrying the same content exceeds the transmission capacity of the
RAN or the predicted range of the SMF, the SMF triggers the switching from
unicast to multicast delivery mode.
EditorÂ´s note: It is ffs how the SMF determines that several UEs receive the
same contents via unicast. The case where users receiving the same contents
are served by different SMFs is also ffs.
3\. The SMF provides the unicast session related information to the (MB-)SMF.
4\. The SMF configures the UPF because the unicast session is about to end.
5\. The (MB-)SMF configures the (MB-)UPF.
6a-7a. The (MB-)SMF sends the unicast session ID, SUPI and the
indication/information about the new delivery mode(e.g. TMGI, (MB-)UPF) in the
N2 Message to the NG-RAN via the AMF through
Namf_Communication_N1N2MessageTransfer.
8\. Based on the N2 Message sent by the SMF, the NG-RAN establishes or
modifies the AN resources for the MBS session according to the selected
delivery mode.
7b-6b. The NG-RAN confirms to the AMF that the switching can be made and the
AMF also confirms to the (MB-)SMF.
Since the delivery mode switching is triggered by the SMF, it is important to
check the UEs\' intentions and count their numbers. If there are some new UEs
requesting for the same content, they can join the multicast session directly
and the number will increase.
9a-10a. The (MB-)SMF sends the information about the new delivery mode(e.g.
TMGI, (MB-)UPF) in the N1 Message to the UEs via the AMF through
Namf_Communication_N1N2MessageTransfer.
10b-9b. Some UEs would like to change the delivery mode and some may not. The
UEs respond to the (MB-)SMF.
11a. After checking the number of respective UEs, the (MB-)SMF informs the PCF
that the corresponding UEs\' delivery mode will be switched by invoking the
Npcf_SMPolicyControl_Update Request (including SM Policy Association ID), so
that the PCF can update the policy.
11b. The PCF responds to the (MB-)SMF about the delivery mode switching
notification.
12-13. The UE requests to receive data with multicast mode from the AF over
application layer. The AF updates the service and sends the service data to
the (MB-)UPF. The (MB-)UPF forwards the data to the NG-RAN. The Target NG-RAN
transmits data to the UE by multicast mode.
14\. The UE requests the UPF to stop transmitting the unicast data.
When the number of UEs requesting for the multicast service is small, and the
SMF may decide to transmit the content to the remaining UEs using unicast
sessions. Switching from multicast to unicast is easier to guarantee service
continuity than switching from unicast to multicast.
#### 6.40.2.2 Delivery mode switching between unicast and multicast within
dual RANs
There is also one possibility that unicast and multicast switching is achieved
through RAN handover. The reasons for the RAN handover include but are not
limited to: 1. The signal strength provided by the new RAN at the current UE
location is stronger than that of the original RAN. 2. The load of the
original RAN is high, so load balancing is needed. 3. The UE moves out of the
coverage of the original RAN. Because of the RAN handover, all services are
migrated from source RAN to target RAN. There are four possibilities in terms
of the delivery mode switching: unicast to multicast, multicast to unicast,
unicast to unicast and multicast to multicast. Only the first two of them fall
within our scope. For the sake of brevity, we only discuss the services that
meet the criteria. The RAN handover procedure is referenced to TS 23.502 [8].
##### 6.40.2.2.1 Xn based handover
Figure 6.40.2.2.1-1: Multicast to unicast mode switching based on Xn handover
within dual RANs
The figure depicts multicast to unicast switching procedure based on Xn
handover within dual RANs as follows.
0\. Initially, the UE has ongoing communications with the AF and is receiving
service data from the source NG-RAN by multicast mode.
1-5. Due to the UE\'s mobility or some other reasons, the RAN handover is
needed. Because there is a Xn connection between the Source NG-RAN and the
Target NG-RAN, the forward tunnel is available. The Target NG-RAN establishes
the associated AN resources for the UE\'s current PDU session. The Source NG-
RAN instructs the UE to access the Target NG-RAN. The Target NG-RAN transmit
the data by PTP mode.
6\. The Target NG-RAN sends N2 Path Switch Request to the AMF, including SUPI,
multicast session ID, TMGI, UE location information.
7\. The AMF forwards the request and the information of Target NG-RAN and
Source NG-RAN to the (MB-)SMF by invoking the Nsmf_PDUSession_UpdateSMContext.
8\. The (MB-)SMF finds that there is no multicast session transmitting the
same content in the Target NG-RAN, so it provides the multicast session
related information to the SMF.
9\. The SMF configures the UPF because the unicast session will start.
NOTE 1: Since the multicast session will continue, the (MB-)SMF does not need
to configure the (MB-)UPF.
10a. Unicast and multicast have different charging rules. The SMF informs the
PCF of the delivery mode switching by invoking the Npcf_SMPolicyControl_Update
Request (including SM Policy Association ID), so that the PCF can update the
policy.
10b. The PCF responds to the SMF about the delivery mode switching.
11-12. The SMF confirms to the Target NG-RAN and a unicast session will begin.
13-14. The UE requests to receive data with unicast mode from the AF over
application layer. The AF updates the service and sends the service data to
the UPF. The UPF forwards the data to the Target NG-RAN. The Target NG-RAN
transmits data to the UE by unicast mode.
15\. The Target NG-RAN releases the forwarding tunnel with the Source NG-RAN.
NOTE 2: If the Source NG-RAN uses unicast delivery mode and the Target NG-RAN
supports multicast service but without the multicast session of the same
content, the procedure conforms to the single RAN scenario. The UE will
firstly establish a unicast session in the Target NG-RAN. Whether to switch
the delivery mode in the target NG-RAN has no relation to the Source NG-RAN.
If the Target NG-RAN has established a multicast session, it merely needs to
append the UE to the user list of the multicast session.
##### 6.40.2.2.2 N2 based handover
Figure 6.40.2.2.2-1: Multicast to unicast mode switching based on N2 handover
within dual RANs
The figure depicts unicast to multicast switching procedure based on N2
handover within dual RANs as follows.
0\. Initially, the UE has ongoing communications with the AF and is receiving
service data from the source NG-RAN by multicast mode.
1\. Due to the UE may move out of the coverage of the Source NG-RAN or some
other reasons, the RAN handover is needed. The Source NG-RAN can collect some
information about the UE.
2\. Because there is no Xn connection between the Source NG-RAN and the Target
NG-RAN, the Source NG-RAN first sends Handover request to the Source AMF,
including Target ID, Source to Target transparent container, SM N2 info list,
multicast session ID.
3\. When the Source AMF can\'t serve the UE anymore, the Source AMF selects
the Target AMF as described in clause 6.3.5 on \"AMF Selection Function\" in
TS 23.501 [2].
4\. The Source AMF sends N2 information, UE context information (SUPI, Service
area restriction, UE Radio Capability Information and so on) to the Target AMF
by invoking the Namf_Communication_CreateUEContext Request.
5\. The Target AMF sends TMGI, multicast session ID, Target ID, Target AMF ID,
N2 SM Information to the (MB-) SMF by invoking the
Nsmf_PDUSession_UpdateSMContext.
6\. The (MB-)SMF finds that there is no multicast session transmitting the
same content through the Target NG-RAN, so it provides the multicast session
related information to the SMF.
7\. The SMF configures the UPF because the unicast session will start.
8\. The SMF responds to the (MB-)SMF with the UPF ID.
9\. According to the UPF ID, the (MB-)SMF configures the (MB-)UPF for indirect
data forwarding.
10\. The SMF confirms to the Target AMF that a unicast session will be made.
11\. The Target NG-RAN confirms to the Target AMF that the radio resource is
available. The signalling includes transparent container, N2 SM Information
list and so on.
12\. The Target AMF responds to the Source AMF that the RAN handover will be
made and sends related information about indirect data forwarding.
13\. The Source AMF sends the Handover Command (Target to Source transparent
container, the multicast session to be handed-over with N2 SM information
containing information received from the Target AMF and so on) to the Source
NG-RAN.
14\. The Source NG-RAN sends UE container to the UE.
Then an indirect data forwarding tunnel is built. The Target NG-RAN
establishes the associated AN resources for the UE\'s current PDU session. The
UE accesses the Target NG-RAN. The Target NG-RAN uses PTP mode to transmit the
data.
15\. When the UE has successfully accessed to the target cell, it sends a
Handover Confirm message to the Target NG-RAN.
16\. The handover is considered to be successful in the Target NG-RAN.
17\. The Target AMF sends Handover Complete indication for multicast session
ID, N2 SM information and so on to the SMF.
18a. Since unicast and multicast have different charging rules, the SMF
informs the PCF that the UE delivery mode has switched by invoking the
Npcf_SMPolicyControl_Update Request (including SM Policy Association ID), so
that the PCF can update the policy.
18b. The PCF responds to the SMF about the delivery mode switching.
19\. The SMF confirms reception of Handover Complete.
20-21. The UE requests to receive data with unicast mode from the AF over
application layer. The AF updates the service and sends the service data to
the UPF. The UPF forwards the data to the Target NG-RAN. The Target NG-RAN
transmits data to the UE by unicast mode.
22\. The original indirect data forwarding tunnel will be released.
In the case that the UE receiving a unicast session in the Source NG-RAN moves
to the Target NG-RAN that exists a multicast session with the same content, it
will switch the delivery mode from unicast to multicast, and the N3 End Marker
is necessary.
For some delay sensitive services like the live video, it is important to
improve the speed of processing and transmission. For some services that are
not sensitive to time delay like downloading files, there are many
technologies that can ensure data integrity like DASH.
### 6.40.3 Impacts on services, entities and interfaces
UE: Provide the context information to the CN to support the delivery mode
switching. Trigger the delivery mode switching due to e.g. the change of
user\'s service/application preference.
NG-RAN: Upload the NG-RAN information e.g. its capability to the AMF. Receive
signalling from the SMF. Execute unicast and multicast switching by
establishing or modifying AN resources.
UPF: Receive the configuration information from the SMF.
AMF: Detect the number and location of the UE in the NG-RAN coverage area.
Receive information from the UE and NG-RAN and send it to the SMF. Transfer
downlink N1 and/or N2 message to the UE and/or the NG-RAN.
SMF: Receive requests or information from the PCF/AMF/UE/NG-RAN/UPF. Trigger
delivery mode switching according to local policies, the number of active
users in the coverage area, etc. Send signalling to reconfigure the UPF and
NG-RAN. Notify the PCF to update the policy.
PCF: Charge the UE for receiving unicast or multicast session data.
## 6.41 Solution #41: Service continuity between 5G MBS and eMBMS
### 6.41.1 Functional description
The solution addresses Key Issue 9 and proposes a solution to maintain service
continuity when UE moves between NG-RAN that supports delivery of the service
via 5G MBS and E-UTRAN that supports to transport the service via eMBMS. This
solution is based on solution 3.
The relation between the TMGI and MBS Session ID is aware by the UE through
the application layer signalling. The principles for TMGI and MBS Session ID
mapping defined in Solution 3 are used.
**From eMBMS delivery to 5G MBS delivery**
It is assumed that the UE is configured with proper threshold for transport
mode change from MBMS to unicast EPS bearer when UE is about to moves out from
the MBMS coverage as defined in TS 23.468 [5]. The mechanism defined in TS
23.468 [5] is used for switching from MBMS bearer delivery to individual MBS
delivery. The switching can be happened before or after the IRAT mobility
depends on when the UE trigger the related unicast PDU Session establishment.
\- Switching to the individual MBS delivery before the IRAT mobility
After receiving UE report that it has moved to the border of MBMS coverage,
the AS sends a request to SMF (via PCF) to deliver the service via individual
MBS delivery. Unicast EPS bearer is then established for delivering the
service. In response to AS, the SMF indicates whether unicast UE IP address or
multicast IP address should be used for AS to send the service to UE. If 5G
MBS is supported at the network, the SMF indicate the AS to use multicast IP
address for delivery. Thus the PGW-U+UPF receives the service packets from the
MB-UPF, and maps it to corresponding EPS bearer for downlink delivery.
After the switching to unicast EPS bearer delivery, it can be handover to 5GS
as a PDU Session during EPS to 5GS handover procedure. Hence, the service
continuity is supported when UE moves from eMBMS coverage to 5GS.
\- Switching to the individual MBS delivery after the IRAT mobility,
The UE report to AS that it is to be out of MBMS coverage. AS triggers the
individual MBS delivery via the unicast PDU Session which is happened after
the UE handover to 5GS.
In both case the individual MBS delivery is established when the UE moves to
the NG-RAN. If the UE and NG-RAN support 5G MBS, PGW-C+SMF request NG-RAN to
transport the service to UE via MBS Session.
**From 5G MBS delivery to eMBMS delivery**
When UE joins the MBS session for delivery of the service, the PGW-C+SMF maps
the multicast flow into associated unicast PDU Session flow. Then for the
associated unicast PDU Session flow, the PGW-C+SMF request AMF to allocate EBI
for the related mapped EPS bearer(s).
In 5GS to EPS handover procedure with N26, the service is delivered via the
EPS bearer (unicast bearer) after handover.
After the handover procedure, if the service can be delivered via eMBMS, the
UE will detect the availability of the MBMS coverage for the corresponding
service based on MBMS Scheduling Information over MCH and the data from the
MBMS bearer corresponding to the TMGI over MTCH. The UE reports it to AS, and
the delivery mode can be switched from unicast EPS bearer to MBMS as defined
in TS 23.468 [5].
### 6.41.2 System architecture
Figure 6.41.2-1: Architecture to support mobility between MBMS and 5G MBS
(Transport only mode)
For Transport only mode, the destination IP address of the service packet sent
out from AS is always the multicast IP address used for multicast delivery.
This also includes the case in which the unicast EPS bearer is used for
multicast flow delivery when the UE moves from 5GS and camps in the EPS.
Figure 6.41.2-2: Architecture to support mobility between MBMS and 5G MBS
In this architecture, the BM-SC is collocated with MBSF. AS interfaces with
MBSF+BM-SC, and MBSF+BM-SC connects to MBMS-GW via SGimb/SGmb interface. For
user plane, the MBUF is optional, if the MBUF is not required, the AS connects
to MB-UPF via N6 directly. This architecture applies to both Transport only
mode and Full Service mode.
The N5 reference point between AS and PCF is used for AS to request individual
delivery of the service data. Multicast information is provided to 5GC (e.g.
PCF) by MBSF+BM-SC.
### 6.41.3 Procedures
#### 6.41.3.1 General
The procedures in 6.41.3 supports both Transport only mode and full service
mode.
#### 6.41.3.2 Delivery switching from MBMS to 5G MBS
Figure 6.41.3.2-1: Procedure to support delivery switching from MBMS to 5G MBS
Before the service has started, the AS provides Multicast information of the
service to core network as described in clause 6.3.2.2.2. The Multicast
information includes Traffic Description information of the service, e.g. the
multicast IP address used to deliver the service.
1\. UE establishes PDN connection. During PDN connection establishment
procedure, the UE provides 5G MBS capability via PCO to PGW-C+SMF. UE sends
service level signalling with AS via the PDN connection.
2\. When UE moves to the edge of the MBMS coverage for the service, the UE
sends a report to the AS as described in TS 23.468 [5].
3\. The AS indicates the core network to deliver the service to UE via unicast
bearer. If the service supports transmitted via 5MBS session, the AS includes
TMGI (or MBS Session ID) of the service in the service information.
4\. The PCF indicates the PGW-C+SMF to deliver the service to UE via unicast
bearer. The PCF provides the TMGI (or MBS Session ID) of the service in the
PCC rule to PGW-C+SMF.
If the UE support 5G MBS and the 5G MBS is supported at the network, the
PGW-C+SMF determines that individual MBS traffic delivery method is used, i.e.
the content is received from the MB-UPF not via the N6/SGi interface directly.
5\. If the PGW-C+SMF does not have QoS flow information of the service, the
PGW-C+SMF retrieves QoS flow information for the service from MB-SMF. If the
PGW-C+SMF does not have MB-SMF info, it retrieves the MB-SMF info from the UDR
based on the TMGI(or MBS Session ID) of the service.
6\. The PGW-C+SMF maps the service into EPS bearer(s) based on the QoS flow
information, and initiates the dedicated bearer modification/activation
procedure to modify or activate EPS bearer for the service.
7\. The PGW-C+SMF provides the mapping between the QFI and DL tunnel info of
the EPS bearer(s) corresponding to the service to PGW-U+UPF, and the PGW-U+UPF
maps packets received from the MB-UPF to the DL tunnel(s) of the EPS bearer(s)
according to the mapping. If the tunnel from MB-UPF to PGW-U+UPF for the
service has not been established yet, the PGW-C+SMF requests the PGW-U+UPF to
allocate the DL tunnel for the service, and the PGW-U+UPF provides the DL
tunnel info for the service to the PGW-C+SMF.
8\. The PGW-C+SMF invokes Nsmf_xxxx Request (DL Tunnel info for the service)
to the MB-SMF.
9\. The MB-SMF sends the DL Tunnel info for the service to the MB-UPF. The MB-
UPF starts to forward the DL packets to PGW-U+UPF.
The service is now transferred to UE via EPS bearer.
10\. The MB-SMF sends Nsmf_xxxx Response to PGW-C+SMF.
11\. The PGW-C+SMF sends response to PCF. In the response, the PGW-C+SMF
indicates that the individual MBS traffic delivery method is used.
12\. The PCF sends response to AF. The individual MBS traffic delivery method
is indicated in the response.
After receiving the response, if the AF has not started to deliver the service
using multicast address, the AF starts to send packets of the service using
multicast address.
13\. The UE moves to 5G NG-RAN cell, the handover procedure from EPS to 5GS is
triggered. After handover procedure, the service is delivered via unicast PDU
Session, i.e. individual delivery.
14\. If the UE and the gNB supports 5G MBS, the PGW-C+SMF adds the UE into the
MBS session as in steps 6 - 24 of figure 6.3.2-1.
15\. PGW-C+SMF releases the unicast resource allocated for the service.
If the UE moves to 5GS earlier than it report out of MBMS coverage to AS, i.e.
step 13 is earlier than step 2, the AS will indicate to 5GS to deliver the
service via individual MBS delivery after the UE has handover to 5GS. This is
similar as the step 3-12 with the difference that the EPS bearer is changed to
the QoS flow.
The PGW-C+SMF adds the UE into the MBS session as in steps 6 - 24 of figure
6.3.2-1 if the UE and the gNB supports 5G MBS, otherwise, the PGW-C+SMF maps
the service into PDU Session as in steps 25-38 of figure 6.3.2-1.
#### 6.41.3.3 Delivery switching from 5G MBS to MBMS
Figure 6.41.3.3-1 Procedure to support delivery switching from 5G MBS to MBMS
1\. The UE has established a PDU Session with the PGW-C+SMF. During PDU
session establishment procedure, the UE provides 5G MBS capability to
PGW-C+SMF. UE sends service level signalling with AS via the PDU Session.
2\. UE joins the 5G MBS Session to receive the service as in clause 6.3.2.
During the procedure, the PGW-C+SMF receives QoS flow information of the
service. If the service supports service continuity when interworking with
EPS, the PGW-C+SMF maps the service to EPS bearer(s) and request the related
EBI.
3\. When UE hand over to EPS, the EPS bearer(s) context is sent to MME, and
the EPS bearer(s) for the service is established in EPS as part of the
intersystem handover procedure.
4\. After UE has connected to the eNB, the PGW-C+SMF will receive Modify
bearer request message, which provides the DL tunnel info of the SGW to the
PGW-C+SMF. The PGW-C+SMF sends N4 modification request to the PGW-U+UPF and
provides the mapping between the QFI and DL tunnel info of the EPS bearer(s)
corresponding to the service to PGW-U+UPF, and the PGW-U+UPF maps packets
received from the MB-UPF to the DL tunnel(s) of the EPS bearer(s) according to
the mapping.
Based on the UE capability and the multicast group UE join, the PGW-C+SMF
determine that the individual MBS delivery is needed. If the DL tunnel from
MB-UPF to PGW-U+UPF for the service has not been established yet, the
PGW-C+UPF requests the PGW-U+UPF to allocate DL tunnel info. The PGW-U+UPF
provides the DL tunnel info for the service to the PGW-C+SMF.
5\. The PGW-C+SMF sends Nsmf_xxxx Request (DL Tunnel info for the service) to
the MB-SMF.
6\. The MB-SMF sends the DL tunnel info to the MB-UPF. The MB-UPF starts to
send packets to the PGW-U+UPF, and the PGW-U+UPF starts to send the DL packets
of the service to UE via corresponding EPS bearer(s).
7\. The MB-SMF sends Nsmf_xxxx Response to PGW-C+SMF.
8\. The UE detects detect the availability of the MBMS coverage for the
corresponding service based on MBMS Scheduling Information over MCH and the
data from the MBMS bearer corresponding to the TMGI over MTCH.
9\. The UE reports that MBMS coverage is available for the service to AS, and
the AS indicates the UE to receive the service via MBMS bearer.
10\. The AS indicates the core network to release unicast resources for the
indicated MBS service. To support this, the related TMGI (or MBS Session ID)
are also included in the request.
11\. Based on the received indication, the PCF indicates the PGW-C+SMF to
release unicast bearer associated with the indicated MBS Session..
12\. The PGW-C+SMF initiates bearer modification/release to delete the
resource allocated for the service. The PGW-C+SMF indicates the PGW-U+UPF stop
sending packets of the service via corresponding EPS bearer.
The PGW-C+SMF may release the tunnel from MB-UPF and PGW-U+UPF if there is no
other UE receives the service via EPS bearer via the PGW-U+UPF.
In future, if UE moves out of MBMS coverage for the service, the UE reports to
AS, and AS will indicate the core network to deliver the service via unicast
bearer as described in steps 3 - 12 of clause 6.41.2.2-1.
### **6.41**.4 Impacts on services, entities and interfaces
SMF:
\- The SMF supports to transfer the service data to UE via unicast bearer or
individual MBS delivery based on indication from AF.
\- The SMF supports to change the delivery of the service data from via shared
MBS delivery to via unicast bearer during the handover from 5GS to EPS.
\- The SMF supports to indicate AF multicast IP address is used for deliver
the service data via unicast bearer or individual MBS delivery.
\- The SMF supports to release resource for service delivery via unicast
bearer based on AF indication.
PCF:
\- The PCF supports to indicate the SMF to transfer the service data via
unicast bearer or individual MBS delivery based on request from AF, or
indicate the SMF to release resources for service delivery via unicast bearer
based on request from AF.
AF:
\- The AF supports to transfer the service data via multicast IP address or
unicast UE IP address based on SMF indication.
\- The AF supports to indicate the 5GC to release resource for service
delivery via unicast bearer.
\- The AF supports to indicate the 5GC to transfer the service data via
individual MBS delivery.
## 6.42 Solution #42: Switching to unicast transport for mobility to
E-UTRAN/EPC.
### 6.42.1 Functional Description
This solution addresses Key Issue 9 and proposes a solution based on Solution
3 overall system architecture, and Solution 27 concepts for mobility outside
of 5G MBS support, where in this case the area of non-support is another
RAT/CN type: E-UTRAN/EPC.
The solution has the following main characteristics:
\- For 5GC to EPC mobility, the MBS session context is moved to the associated
unicast PDU Session before executing inter-CN-type handover. Then regular 5GC
to EPC handover applies, where the MBS data will transported via PDN
connection corresponding to the unicast PDU Session. Handling of EBI for the
PDN connection corresponding to the unicast PDU session is as defined in TS
23.501 [2] clause 5.17.2 for regular interworking with EPC for unicast PDU
sessions. EBI is handled by the SMF serving the associated unicast PDU
Session.
\- For EPC to 5GC mobility, the SMF detects the UE has returned to an area
where MBS is supported, and reactivate the MBS session for the UE.
NOTE: The details of procedures described in this solution are representing
the main ideas of the interworking, details might need to be re-accommodated
depending on chosen architecture.
### 6.42.2 Procedures
#### 6.42.2.1 Connected mode mobility from NR 5GS to E-UTRAN/EPC with an
active MBS session.
Figure 6.42.2.1-1 shows the call flow for transitioning a MBS session context
into a unicast PDU session context before moving to E-UTRAN/EPC. The UE then
MBS data is transported over the PDN connection for the UE while it is in
E-UTRAN/EPC.
Figure 6.42.2-1: Connected mode mobility from 5GC to EPC
The procedure follows exactly the same message flow as 5GS to EPS handover as
defined in TS 23.502 [8] with the following modifications.
1\. When the NG-RAN decides to initiate 5GS to EPS handover, the NG-RAN first
creates a radio bearer context for the unicast PDU session associated with the
Multicast context if not already created. In handover required message the NG
RAN does not include any information related to the Multicast session context.
2\. The PGW-C+SMF detects that the UE is moving to E-UTRAN/EPC and includes
the configuration for only the associated PDU Session, and removes the
configuration for the Multicast session context for this UE in N4 Session
Modification message. The UPF then will use the unicast tunnel for this UE.
3-10: Regular procedure for unicast handover.
11b. In Handover command the UE releases the radio resources for the multicast
session and continues regular 5GS to EPS handover with the radio resources for
the unicast PDN connection.
Editor\'s note: The flow above assumes SMF and MB-SMF are the same. The
scenario of separate SMF and MB-SMF in 5GS is FFS.
#### 6.42.2.2 Connected mode mobility from E-UTRAN/EPC to NR 5GS
Connected mode mobility between non-supporting NG RAN to supporting NG-RAN
node follow regular EPS to 5GS handover procedure according to TS 23.502 [8].
Note that the UE and SMF already have SM context for the Multicast session,
but the UE is bring served by the associated unicast PDU session at the moment
of the handover initiation.
After connected mode mobility procedure has been completed then:
\- The PGW-C+SMF detects the UE is now in an NG-RAN that supports 5G MBS.
\- SMF reconfigures UPF to change from unicast tunnel to shared tunnel for
this UE.
\- SMF sends message to RAN to establish MBS context for this UE.
\- UPF sends over unicast GTP-U tunnel and end-marker with the associated
sequence number for the associated shared tunnel for next packet.
\- NG RAN starts RRC reconfiguration to move UE to MBS QoS flow, and provides
UE with information of the PDPC sequence number of the packet following the
last one received in the unicast QoS flows.
#### 6.42.2.3 Idle mode mobility between non-supporting NG RAN and supporting
NG-RAN node
During idle to connected mode transition the SMF detects whether the UE is
connecting via a supporting NG RAN node or E-UTRAN/EPC, and configures the
PGW-U+UPF and RAN accordingly with the unicast PDN connection (E-UTRAN/EPC) or
the Multicast session (NR/5GC).
### 6.42.3 Impacts on services, entities and interfaces
**PGW-C+SMF** : Support for detecting and moving the MBS transport to a
unicast PDN connection in E-UTRAN/EPC.
**PGW-U+UPF** : Switching tunnel between unicast PDN connection to shared
tunnel for multicast session.
**NG RAN** : Switching to radio resources for the unicast PDU Session before
handover to EPC.
**UE** : Support of switching between unicast PDU session/PDN connection and
multicast session.
## 6.43 Solution #43: Service layer continuity between E-UTRAN/EPC MBMS and
NR/5GC MBS
### 6.43.1 Functional Description
This solution addresses Key Issue #9 which aims at minimizing the interruption
of public safety services upon transition between NR/5GC and E-UTRAN/EPC.
Figure 6.43.1-1 shows the system architecture for interworking between
E-UTRAN/EPC MBMS and 5G MBS at service layer, by collocating the BM-SC and
MBSF functionalities.
Figure 6.43.1-1: System Architecture for interworking between 5G MBS and
E-UTRAN/EPC at service layer
The BM-SC+MBSF expose common xMB/MB2(-C and -U) reference points to the
Application Function. Towards the Application Function, the TMGI is used as
identifier. The TMGI is also used as identifier for transport over
E-UTRAN/EPC.
NOTE 1: In the case of 5G MBS-eMBMS interworking TMGI and 5G TMGI are
equivalent. The actual 5G TMGI structure depends on the conclusion of KI#1.
In the case of interworking support at service layer, the UE is always
configured with TMGI/MBS context ID regardless of whether the UE is
discovering and joining the MBMS/MBS service via E-UTRAN or NR.
When the UE camps on NR, the UE establishes an MBS session context using the
MBS context ID.
When the UE camps on E-UTRAN, the UE uses procedures as defined in TS 23.246
[4] for MBMS reception for the TMGI.
Packet loss in case of inter-system mobility is affected by the capabilities
of the RANs and the UE. Mechanisms to reduce, eliminate or recover from packet
losses would need to be performed at service layer between the UE and BM-
SC+MBSF (and/or at application level between the application client at the UE
and the AF).
NOTE 2: Repetitions at service layer do not affect repetitions at RAN level.
NOTE 3: The UE is instructed via application layer to switch to eMBMS. In the
case of mobility towards an EPS where eMBMS is not available, the procedure of
clause 6.42.2.1 is applied.
### 6.43.2 Procedures
Mobility procedures are not impacted by this solution. The UE is instructed
via application layer to switch to eMBMS.
When moving to E-UTRAN/EPC the UE initiates procedures as defined in TS 23.246
[4] to receive MBMS service for the TMGI(s).
In addition, the UE performs the procedure to leave the multicast service(s)
(see clause 6.3.2.3) before disconnecting from 5GS so that the source NG-RAN
can remove the UE from the multicast session context(s) if it exists. If the
UE is the last one in any multicast session context, the source NG-RAN
performs the Multicast user plane distribution release for the multicast
service (see step 17 to step 25 of clause 6.3.2.3).
NOTE 1: How the UE decides when to perform the procedure to leave the
multicast service is up to implementation.
NOTE 2: If the UE has one or more unicast PDU Sessions moving to EPS and if
the handover procedure from 5GS to EPS using N26 interface described in clause
4.11.1.2.1 of TS 23.502 [8] is used, the NG-RAN can use the UE Context Release
Command message sent by the AMF (i.e. step 21c) to trigger the removal of the
UE from the multicast session context(s), if it exists, or the removal of the
whole multicast session context (if the UE is the last one in the multicast
session).
Editor\'s note: The feasibility and details of the UE initiating the leave
operation, which removes or updates the MBS session context at the 5GC, before
disconnecting are FFS.
When the UE has moved to NR/5GC it triggers the multicast context and
multicast flow setup/modification via PDU Session Modification procedures as
defined in clause 6.3.2.1 to receive 5G MBS transport for the TMGI(s).
Mechanisms to reduce, eliminate or recover from packet losses would need to be
performed at service layer between the UE and BM-SC+MBSF and/or at the
application layer between the application function and the application client
at the UE.
### 6.43.3 Impacts on services, entities and interfaces
BM-SC+MBSF:
\- Handles TMGI across two separate systems.
\- Handles potential retransmissions at service layer.
UE:
\- Switches between MBMS reception in E-UTRAN and 5G MBS transport for a same
TMGI.
## 6.44 Solution #44: Support Broadcast Communication
### 6.44.1 Functional description
When the TMGI is known to the AF, interested UEs will be receiving broadcast
service announcement via unicast signalling.
Session Start procedure is performed from the AF all the way to MB-SMF,
broadcast area needs to be included;
MB-SMF proceed with MBS Session start towards the AMF(s) in the broadcast
area;
AMF further propagate the MBS Session towards the NG-RAN(s) in the broadcast
area.
NG-RAN broadcast the MBS service using TMGI over Uu so that the UE can receive
the MBS traffic.
The UE, even if it may have registered in the network and established PDU
Session, shall not perform UE join.
### 6.44.2 Procedures
#### 6.44.2.1 Session Start
Figure 6.44.2.1-1: Session Start high-level procedures and information flows
0 TMGI allocation and interested UEs receiving announcement from AF as
described in steps 0-5 of clause 6.2.2.1 with the difference that UE
interaction with AF using PDU Session is optional.
The UE needs to be aware if the service is broadcast or multicast in order to
decide if JOIN is to be performed. The 5GC needs to be aware if the service is
a broadcast or multicast so that the MB-SMF can decide whether to select the
AMF or wait for being selected by the AMF. The AF also needs to indicate to
the NEF/MBSF that broadcast is to be used.
Editor\'s note: How to include broadcast or multicast info in the service
announcements requires SA WG4 coordination.
1-4 Same as in clause 6.2.2.2 (for Sol#2) with the difference that broadcast
area is to be included.
The broadcast area can be of internal format (e.g. TAI) that is known by the
operator\'s network, or an external format that is to be mapped to an internal
format.
Below steps 5-10 (not including 9a &9b) are executed for multiple selected
AMFs and their associated NG-RANs.
5-9 MB-SMF discovers the AMF(s) based on the broadcast area and select the
appropriate one(s). Then the MB-SMF sends the MBS session start request
including broadcast area to the selected AMF(s). The AMF then sends the MBS
session resource setup request to all NG-RANs in the broadcast area. The AMF
may include the broadcast area.
NOTE 1: The exact message names can be decided in normative phase, considering
that different ways of NF selection, i.e. in multicast, it\'s the AMF that
selects the MB-SMF, while in broadcast it\'s the MB-SMF that selects the AMF.
Information that the messages relate to broadcast and that different AMF
procedures compared to multicast are required also needs to be conveyed.
9a-9b MB-SMF responds with the successful result of MBS Session setup in the
NG-RAN.
Editor\'s note: Whether additional info (e.g. area where RAN resource for
broadcast service is successfully allocated) should be included in the
response to the AF is FFS.
10 NG-RAN advertises the TMGI representing the MBS service over radio
interface.
NOTE 2: NG-RAN advertising TMGI over radio needs RAN confirmation.
11 The AF starts transmitting the DL media stream using the N6 Tunnel Info, or
optionally un-tunnelled i.e. as an IP multicast stream using the HL MC
address.
11a. The NG-RAN transmits the received DL media stream using DL PTM resources.
#### 6.44.2.2 Session Stop
The session stop procedure for broadcast is the same as the procedure for
multicast, which is described in clause 6.2.2.6.
#### 6.44.2.3 Session Delete
The session delete procedure for broadcast is the same as the procedure for
multicast, which is described in clause 6.2.2.7.
#### 6.44.2.4 Session Update
Figure 6.44.2.4-1: Session Update high-level procedures and information flows
1\. The AF sends Modify MBS Bearer Request to the NEF/MBSF with TMGI. The AF
may adjust service requirement and broadcast area.
2\. The NEF/MBSF sends MB Session Update to the MB-SMF. The NEF/MBSF may need
to translate the broadcast area if it is provided in external format.
3\. If there is service requirement update, the MB-SMF provides the service
requirement and get the updated 5G QoS Profile from the PCF.
4\. If there is service requirement update, MB-SMF sends the updated 5G QoS
Profile to the MB-UPF.
5\. If there is service requirement update, the MB-SMF sends MB Session Update
to the AMFs with TMGI, 5G QoS Profile and the updated broadcast area.
Depending on the broadcast area updates, the MB-SMF may send MB Session Start
to some AMFs in the new broadcast area and MB Session Stop to some other AMFs
in the old broadcast area.
6\. If there is service requirement update, the AMF sends MB Session Resource
Update to NG-RANs with TMGI, updated 5G QoS Profile and updated broadcast
area.
Depending on the broadcast area updates, the AMF may send MB Session Resource
Setup to some NG-RANs in new broadcast area and MB Session Resource Release to
some other NG-RANs in old broadcast area.
7\. The NG-RAN updates MB session Context.
8-9b. The response is passed along the path from the NG-RAN to the AMF, the
MB-SMF, NEF/MBSF and finally to the AF.
Editor\'s note: Whether the AMF and the MB-SMF need to aggregate the responses
from downstream nodes is FFS.
10\. The NG-RAN updates the MB Session.
#### 6.44.2.5 Delivery Status Indication
An MBS Delivery Status Indication may be sent from the MB-SMF to the AF via
NEF/MBSF, similar to clause 5.1.2.5 of TS 23.468 [5]. It allows the MB-SMF to
notify the AF of conditions affecting the delivery of service. The occurrence
of the indicated condition may have been detected at the MB-SMF or may have
been reported to the MB-SMF by other entities involved in the MBS delivery.
The MB-SMF sends the MBS Delivery Status Indication which includes condition,
TMGI and optional impacted area within the broadcast area.
### 6.44.3 Impacts Analysis
MB-SMF:
Aware of broadcast or multicast:
Discover and select appropriate AMF(s) based on the broadcast area;
MB-SMF proceeds the MBS session start/update/stop towards the AMF(s) in the
broadcast area;
Handle the MBS Delivery Status Indication.
AMF:
AMF handles the broadcast session start/update/stop/delete request including
pass the request to NG-RANs in the area.
NG-RAN:
After broadcast session is started, NG-RAN advertises the TMGI representing
the broadcast service over radio interface and broadcast the contents of the
broadcast service.
Handles Session update/stop/delete.
Editor\'s note: RAN impact depends on RAN WG.
UE:
Receiving data for MBS service represented by TMGI.
### 6.44.4 Evaluation
Session Start procedure from the AF all the way to MB-SMF in Sol#2 (for
multicast) is reused, with the difference that broadcast area needs to be
included, which could simplify the system.
## 6.45 Solution #45: Solution for Broadcast Service
### 6.45.1 Functional Description
This solution is related to Key issue #1 and provides mechanisms to establish
a broadcast session in the context of MBS.
The solution uses as a fundamental the need to have as much commonality
between the functionality and procedures for Multicast service and the
functionality and procedures for Broadcast service.
The solution is based on Solution #3, but for the parts that are common to
Multicast and Broadcast, if changes are made to Multicast, these can be
reflected in this solution by keeping only the new aspects.
It also allows to establish an MBS broadcast session with and without an MBS
Service Function, denoted MBSF in this solution.
Multicast and Broadcast have the following commonalities:
\- The procedure for an AF to request the establishment of a Multicast Session
and Broadcast session and the CN procedures should be common up to the MB-SMF.
The IEs may have different content.
\- An MBS session context needs to indicate if it\'s a broadcast or multicast
session context.
\- UE discovering a service should be common for multicast and broadcast
Multicast and Broadcast have the following commonalities:
\- The procedure for an AF to request the establishment of a Multicast Session
and Broadcast session and the CN procedures should be common up to the MB-SMF.
The IEs may have different content.
\- An MBS session context needs to indicate if it\'s a broadcast or multicast
session context.
Multicast and Broadcast may have commonalities or differences depending on if
local MBS applies:
\- Service area:
\- Multicast:
Service area is optional for multicast. It may be required for local multicast
service. This service area can determine the RAN nodes that need to join the
MBS session (as for broadcast).
NOTE: This is not meant as conclusion paper for multicast, some of these
descriptions are subject to change based on conclusions for multicast not
treated in this document.
For non-local multicast service, Multicast session can be established to RAN
nodes that join based on UE joining an already started Multicast session.
\- Broadcast requires a strict service area. This service area will determine
the RAN nodes that need to join the MBS session tunnel.
Multicast and Broadcast have the following fundamental differences:
\- AMF(s) selection:
\- Multicast: Solution dependent.
\- Broadcast: it is the MB-SMF that needs to perform AMF selection as there is
no UEs joining.
\- RAN joining:
\- Multicast: triggered by UE(s) joining an already started MBS Session
\- Broadcast: Triggered by AMF selecting RAN based on service area and
notifying RAN to join broadcast session.
\- UE join:
\- Multicast: UE joins e.g. with SM message or IGMP.
NOTE: How UE joins for multicast is not part of this solution.
\- Broadcast: UE does not do join.
### 6.45.2 Procedures
6.45.2.1 MBS session activation for Broadcast with no MBSF
Figure 6.45.2.1-1 shows the procedure to establish an MBS session for
Broadcast when no MBSF is present.
Figure 6.45.2.1-1: MBS session activation for Broadcast with NEF (no MBSF)
Steps 1-9 (Common with Multicast):
\- The Application Function request, MB-SMF selection and policy association
procedures are common to Multicast case with the following differences:
\- The AF provides a Broadcast service area and indicates that the MBS session
request is for Broadcast.
\- The service area may be based on TAI or CGI.
NOTE 1: Other values may be considered.
\- Steps 1-9 in the procedure correspond to steps 1-9 in Solution #3 Figure
6.3.2.2.2-1: Initial Multicast group configuration via NEF.
NOTE 2: If different or modified procedures between NEF, MB-SMF, PCF and/or
UDR are selected for multicast, they can still apply in this solution, by
replacing steps 1-9 with the agreed call flow for multicast.
Steps 10-15 (Specific to Broadcast):
10\. AMF to NRF: NF Discovery request:
\- The MB-SMF invokes the discovery service of NRF and queries for AMF type
instances. The MB-SMF may use the information in service area (e.g. TAI) for
filtering.
11\. NRF to AMF: NF Discovery response:
\- The NRF returns a search result with the AMF instances. The MB-SMF performs
AMF selection based on the NRF results.
12\. MB-SMF to AMF: Namf_MBS_SessionSetup (Broadcast, service area,
N2InfoContainer):
\- The MB-SMF uses the Namf_MBS_SessionSetup (Broadcast, service area,
N2InfoContainer service of the AMFs to transfer Broadcast Session Resource
Setup Request message to the NG RAN nodes controlling the target cells where
the broadcast communication service should be provided.
13\. AMF to NG-RAN: Broadcast Session Resource Setup Request (TAIs, NR CGIs,
MBS QoS flows information):
\- The AMF selects the involved NG RAN based on the service area (e.g. TAIs).
\- The AMF sends Broadcast Session Resource Setup Request (TAIs, NR CGIs, MBS
QoS flows information) to the NG RAN nodes.
14\. NG-RAN to AMF: Broadcast Session Resource Setup Response:
\- If the NG RAN accepts the request, the NG RAN configures the broadcast
resources and responds to the AMF.
NOTE 3: NG RAN details on radio resource configuration and management for
broadcast session are to be studied by RAN WG2 and RAN WG3. Also notification
towards UE.
15\. The AMF notifies the MB-SMF about N2 information including
n2InfoContainer carrying the Broadcast Session Resource Setup Response.
Steps 16-19 (Common with Multicast):
\- Steps 16 to 19 correspond to the MBS session configuration confirmation
towards the AF for multicast session, and should use the same procedure.
\- In particular, steps 16 to 19 correspond to steps 10-13 in Solution #3
Figure 6.3.2.2.2-1: Initial Multicast group configuration via NEF.
6.45.2.2 MBS session activation for Broadcast with MBSF
Figure 6.45.2.2-1 shows the Broadcast session activation procedure with MBSF.
NOTE 1: This call flow shows a collocated MBSF-C and NEF, but the procedure
can apply to NEF not collocated with MBSF-C, by making the NEF forward
messages between AF and MBSF-C.
Figure 6.45.2.2-1: MBS session activation for Broadcast with MBSF
1\. AF to NEF/MBSF-C: Allocate MBS Service Request (Broadcast):
\- The AF sends Allocate MBS service request to MBSF-C, indicating it is
Broadcast Service.
2\. NEF/MBSF-C to AF: Allocate MBS Service Response (TMGI):
\- The MBSF-C may perform authorization of the broadcast service, assign a
TMGI and provide to AF.
3\. AF to NEF/MBSF-C: MBS session request (TMGI, QoS request, Broadcast,
service layer configuration request, service area):
\- When the AF wants to activate an MBS session for broadcast for an already
assigned TMGI, it sends MBS session request for that TMGI. The AF includes the
service area, the requested QoS for the broadcast session, and service layer
configuration request.
NOTE 2: The service layer configuration needs to be specified by SA WG4.
4\. Steps 2 to 18 from 6.45.2.1-1 to configure the broadcast session in 5GC
and NG-RAN.
5\. MBSF-C to MBSF-U: MBS session request (UPF information, service layer
configuration)
\- Once the Broadcast session is configured in 5GC and NG-RAN, the MBSF-C
sends MBS session request to MBSF-U. The requests includes the MB-UPF
information, e.g. the MB-UPF address. The MBSF-C also includes any service
layer configuration for MBS service data handling.
6\. MBSF-U to MBSF-C: MBS session response (MBSF-U information):
\- MBSF-U responds with its own ser plane information, e.g. address, to be
provided to AF.
7\. NEF/MBSF-C to AF: MBS Session Response (TMGI, MBSF-U information, QoS
information, service layer configuration):
\- Once the broadcast session is configured in 5GC and MBSF-U the MBSF-C
responds to AF including the accepted QoS information, accepted service layer
configuration, and the MBSF-U information.
### 6.45.3 Impacts on services, entities and interfaces
MBSF:
\- Configuration of broadcast service. Impact is mostly common with multicast
support for multicast.
NG-RAN:
\- MB Session resource setup for broadcast.
AMF:
\- NG-RAN selection.
\- Forwarding of Broadcast session request/response between NG-RAN and MB-SMF.
MB-SMF:
\- AMF selection.
\- Broadcast session request towards NG-RAN (via AMF).
## 6.46 Solution #46: service continuity with eMBMS
### 6.46.1 Functional description
The solution addresses Key Issue 9 and proposes a solution to maintain service
continuity when UE moves between NG-RAN that supports MBS and E-UTRAN that
supports eMBMS. This solution is based on solution 10 and architecture A.2 and
requires the deployment of N26.
The solution has the following characteristics:
\- The BM-SC are co-allocated with MBSF/MBSU. The TMGI value are same for both
5G MBS and eMBMS.
\- The 5GS-EPS interworking with N26 is re-used. The SMF is co-located with
PGW-C, and UPF is co-located with PGW-U. PCF is co-located with PCRF. The EBI
and Qos are handled as defined in the TS 23.501 [2] clause 5.17.2.
\- When the UE moves between 5GS and EPS, the normal 5GS-EPS interworking is
applied. The PDU session is handed over to PDN connection and vice versa.
\- For 5GS to EPS mobility, the unicast PDU Session associated with MBS
session has been established before the mobility. The regular 5GS to EPS
handover applies, i.e. the MBS data will be transported via PDN connection
corresponding to the unicast PDU Session. After 5GS to EPS mobility, the UE
can trigger the switch from unicast delivery to eMBMS delivery as defined in
the TS 23.468 [5] clause 5.3.2
\- For EPS to 5GS mobility, the UE can trigger the switch from eMBMS delivery
to unicast delivery as defined in the TS 23.468 [5] clause 5.3.3 before the
EPS to 5GS mobility. Then the regular EPS to 5GS handover applies, i.e. the
MBS data will be transported via PDU session corresponding to the PDN
connection. After EPS to 5GS mobility, the 5GC can switch the individual
delivery to shared N3 delivery for the UE.
### 6.46.2 System architecture
NOTE: The BM-SC sends the user plane data to P-GW via the SGi interface not
shown in the figure.
Figure 6.46.2-1: Architecture to support mobility between MBMS and 5G MBS
The figure 6.46.2-1 show the interworking architecture. The BM-SC is
collocated with MBSF/MBSU. The SMF is co-located with PGW-C, and UPF is co-
located with PGW-U. PCF is co-located with PCRF. The N5 reference point
between AS and PCF is used for AS to request unicast delivery of the service
data.
### 6.46.3 Procedures
#### 6.46.3.1 Connected mode mobility from MBS to E-UTRAN/EPC
Figure 6.46.3.1-1 shows the call flow for connected mobility from MBS over 5GS
to EPS. The PDU session associated with MBS session has been established
before. The UE is handed over to EPS as normal 5GS to EPS mobility.
Figure 6.46.3.1-1: Procedure of Connected mode mobility from 5GS to EPS
1\. The MBS context and associated PDU session and Qos flow has been
established as per solution#10. The SM context of PDN connection corresponding
to the PDU session has been allocated according to TS 23.502 [8]. The MBS UE
is receiving the MBS data via shared N3 delivery mode.
2-3. The 5GS to EPS HO is triggered.
4\. The SMF+PGW-C send session request to MB-SMF, indicate the UE is using the
individual delivery. If there is no MBS data transferred from MB-UPF to UPF,
the MB-UPF send the MBS data to UPF.
5: Regular 5GS to EPS Handover according to TS 23.502 [8] clause 4.11.1.2.1
continue.
After 5GS to EPS mobility, the UE can trigger the switch from unicast delivery
to eMBMS delivery as defined in the TS 23.468 [5] clause 5.3.2.
#### 6.46.3.2 Connected mode mobility from E-UTRAN/EPC to MBS
Figure 6.46.3.2-1: Procedure of Connected mode mobility from EPS to 5GS
1\. The UE has established a PDN connection with the PGW-C+SMF, and the
corresponding PDU session context has been allocated. Before EPS to 5GS
mobility, the UE can trigger the switch from eMBMS delivery to unicast
delivery as defined in the TS 23.468 [5] clause 5.3.3.
2\. Normal EPS to 5GS Handover is applied. The MBS data is transported to UE
via PDU session.
3\. The PGW-C+SMF detects the UE is now in an NG-RAN that supports 5G MBS. The
PGW-C+SMF sends the MBS session request MB-SMF to establish the tunnel between
UPF and MB-UPF.
4\. SMF trigger the multicast session join procedure for the UE.
### **6.46**.4 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to services, entities and
interfaces.
**PGW-C+SMF** : inform the MB-SMF to send the MBS data from MB-UPF to UPF when
it receives the Context request for 5GS to EPS mobility.
# 7 Evaluation
## 7.1 Key Issue #2: Definition of Service Levels
There\'s only one candidate solution (solution #1 \"Multicast service
levels\") addressing the key issue, which defines basic service level and
enhanced service level by indicating the functionalities for these two kinds
of service levels.
Except \"Content security protection\", the other functionalities listed in
Solution#2 are described in other key issues, i.e. KI#1, KI#3, KI#4, KI#6,
KI#7 and KI#9.
For \"Content security protection\", it is assumed to be achieved on
application layer which is out of SA2 scope.
So the basic service level and enhanced service level cover supported
functionality.
## 7.2 Key Issue #5: Support of Broadcast TV Video and Radio communication
services
This key issue is not addressed within the Rel-17 timeframe.
## 7.3 Key Issue #8: Reliable switching between unicast and broadcast delivery
methods
This key issue is not addressed within the Rel-17 timeframe.
## 7.4 Key Issue #3: Levels of authorization for Multicast communication
services
Editor\'s note: More evaluations may be needed.
Following items are the summary of feature design opinions related to
authorization that are illustrated in candidate solutions:
A) No authorization in 5GC;
B) Network authorization on 5MBS feature level;
C) MB service level authorization.
Candidate solution #4 and #16 indicate to support network authorization during
service context operations, this way implies that 5GS manages the member group
for an MBS session and authorization for the MBS session is required, e.g. by
subscription or service requirement. This method can be applied when long term
MBS session is deployed or full mode is deployed, and no privacy issue for
group member between application server and MNO exists.
Candidate solution #4 and #14 indicate to support application level
authorization during service context operations, this way implies that
application server, instead of 5GS, manages the member group for a MBS
session, and authorization for the MBS session is required, especially for
temporarily deployed MBS session, e.g. live concert. This method can be
applied when transport only mode is deployed or temporary MBS session is
deployed.
Solution #2 and #3 describe authorization on 5MBS service level, and Sol#2
also describes authorization on 5MBS feature level (i.e. network authorization
per subscription as usual).
If the authorization is performed in 5GS on 5MBS feature level, this can be
achieved by including a new authorization parameter for 5MBS in the
subscription data, so that the UE joining to any MBS service can be rejected
if the UE is not authorized to use 5MBS feature.
If there is no concern from the AF to exposing the affiliation, and if the
authorization in 5GC is expected to be performed on MBS service level, this
requires the AF to explicitly provide the affiliation of UE and its group,
either by the AF provisioning such affiliation to the UDR (maybe via NEF)
(e.g. in Sol#2 and Sol#3), or by AF providing such affiliation info to the PCF
(e.g. in Sol#3).
Sol#3 also proposes that 5GC requests the AF to do run-time authorization when
UE joins a specific MB service with the intention of avoiding exposing the
affiliation of UE and its group to 5GC, however, this approach already exposes
the affiliation to 5GC to some extent thus there is no major difference from
the approach of AF pre-provisioning the affiliation of UE and its group to
5GC. Furthermore, the approach of 5GC requesting the AF to do run-time
authorization implies that the UE joining procedure will be delayed which may
result in timeout of NAS signalling. Therefore, it\'s proposed to adopt the
approach of AF pre-provisioning the affiliation of UE and its group to 5GC if
there is a need to do MB service level authorization.
If there is concern about exposing such info to MNO in some use cases, e.g.
public safety, the MBS service level authorization is assumed to be performed
at application layer, or MBS service level authorization may be implicitly
performed when UE is configured for a specific MBS service on application
layer, e.g. via Service Announcement for public safety, which is out of SA2
scope.
## 7.5 Key Issue #1: MBS session management
### 7.5.1 Overview over available solutions
For Key Issue #1 \"MBS session management\", there are 16 solutions in the TR:
\- #2,#3,#4,#5,#6, #8, #9, #10, #11, #12, #13, #14, #15, #16, #32, #33.
**1) General MBS Session Management (MBS Session configuration, join/leave,
release, etc.)**
A comparison of solutions covering general MBS Session Management procedures
is shown in Table 7.5.1-1.
Table 7.5.1-1: Comparison of multicast solutions for KI#1 MBS Session
Management (Part 1)
+-----+-------+-------+-------+-------+-------+-------+-------+ | | Proce | | | | | | | | | dures | | | | | | | +=====+=======+=======+=======+=======+=======+=======+=======+ | Sol | MBS | MBS | MBS | MBS | MBS | MBS | MBS | | | Se | Se | Se | Se | Se | Se | Se | | | ssion | ssion | ssion | ssion | ssion | ssion | ssion | | | | Join | Start | Modi | Leave | Stop | D | | | (/Ser | | | ficat | | | elete | | | vice) | | | ion/U | | | | | | con | | | pdate | | | (/Rel | | | figur | | | | | | ease) | | | ation | | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 2 | Y. | Y. | Y. | | Y. | Y. | Y. | | | Dedi | Dedi | Dedi | | Dedi | Dedi | | | | cated | cated | cated | | cated | cated | Dedi | | | MBS | MBS | MBS | | MBS | MBS | cated | | | se | se | se | | se | se | MBS | | | ssion | ssion | ssion | | ssion | ssion | se | | | signa | signa | signa | | signa | s | ssion | | | lling | lling | lling | | lling | ignal | s | | | proce | | | | | ling. | ignal | | | dures | | | | | | ling. | +-----+-------+-------+-------+-------+-------+-------+-------+ | 3 | Y. | Y. | Y. | | Y. | | | | | Dedi | Enh | See | | Enh | | | | | cated | anced | MBS | | anced | | | | | MBS | PDU | Se | | PDU | | | | | se | se | ssion | | se | | | | | ssion | ssion | Join. | | ssion | | | | | p | mod. | | | mo | | | | | roced | /est. | | | dific | | | | | ures. | proc | | | ation | | | | | | edure | | | proc | | | | | | | | | edure | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 4 | Y. | Y. | Y. | Y. | Y. | Y. | Only | | | Dedi | (MB | Dedi | (MB | (MB | Dedi | re | | | cated | /PDU) | cated | /PDU) | /PDU) | cated | lease | | | MBS | se | MBS | se | se | MBS | per | | | se | ssion | se | ssion | ssion | se | RAN | | | ssion | proc | ssion | proc | proc | ssion | node | | | p | edure | s | edure | edure | s | | | | roced | | ignal | | | ignal | | | | ures. | | ling. | | | ling. | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 6 | Y. | Y. | Y. | | | | | | | Dedi | Enh | See | | | | | | | cated | anced | MBS | | | | | | | MBS | PDU | Se | | | | | | | se | se | ssion | | | | | | | ssion | ssion | Join. | | | | | | | p | est. | | | | | | | | roced | /mod. | | | | | | | | ures. | proc | | | | | | | | | edure | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 10 | | Y. | | | Y. | | Y. | | | | | | | Enh | | Enh | | | | Enh | | | anced | | anced | | | | anced | | | PDU | | PDU | | | | PDU | | | se | | se | | | | se | | | ssion | | ssion | | | | ssion | | | mod. | | mod. | | | | mod. | | | proc | | proc | | | | /est. | | | edure | | edure | | | | proc | | | | | | | | | edure | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 14 | | Y. | Y. | | Y. | Y. | | | | | Dedi | Dedi | | Dedi | Dedi | | | | | cated | cated | | cated | cated | | | | | MBS | MBS | | MBS | MBS | | | | | se | se | | se | se | | | | | ssion | ssion | | ssion | ssion | | | | | signa | signa | | signa | signa | | | | | lling | lling | | lling | lling | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 16 | | Y. | | | | | | | | | Enh | | | | | | | | | anced | | | | | | | | | PDU | | | | | | | | | se | | | | | | | | | ssion | | | | | | | | | est. | | | | | | | | | /mod. | | | | | | | | | proc | | | | | | | | | edure | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+
NOTE: Dedicated MBS session signaling may also use existing message enhanced
with 5MBS functionality, e.g. in Sol#2, UL NAS TRANSPORT is enhanced to
support UE join.
**2) Solution addressing specific aspects**
**MBS Session activation/start and deactivation/stop**
Sol#13 and #32 propose procedures for MBS Session activation and deactivation,
which are both based on Sol#3 and share much similarity. Both solutions
suggest that MBS service activation is triggered via detection of UP activity
by MB-UPF. Sol#32 adds control plane (i.e. multicast group configuration
update by AF) triggered MBS Session activation and deactivation.
Sol#2 and #4 propose procedures for MBS Session start and stop, which are same
as the MBS Session activation and deactivation. Both solution suggest the MBS
session activation/deactivation is triggered by the AF.
Solution#13 also propose the NG-RAN can trigger MBS session deactivation.
Considering multi NG-RAN node and different timer implementation setting, this
will only cause inconsistent handling. As the MB-UPF can trigger the MBS
session deactivation, the NG-RAN node trigger MBS session deactivation is not
needed.
When the MB-SMF start the MBS session activation:
\- In solution#2, #4, #13, if the MBS session start is triggered by AF, the
MB-SMF get the related Multicast QoS flow information from the PCF.
\- In solution#13, #32, if the MBS session start is triggered by MB-UPF, the
MB-SMF get the related Multicast QoS flow information from the stored MBS
Session context.
When the MB-SMF is triggered to activate the MBS Session, the MB-SMF notifies
the related SMF per the MBS Session context information. Per the received
multicast session ID information, the SMF triggers the multicast session
establishment.
In solution #2, #4, #13, #32 after the MBS session deactivation, the MBS
session context information at the NG-RAN side is released, including the
shared tunnel.
In solution 32, all the Multicast QoS flow within the MBS session context are
removed from the SMF/MB-SMF, i.e. only the multicast group membership
information is still kept in the SMF/MB-SMF MBS Session context. In solution
#2, the MBS session context is still kept at the MB-SMF but set as inactivated
state. In solution #4, #13, the MBS session context is still kept at the MB-
SMF, but the MBS session context at the SMF is released.
For the MBS session activation the SMF/UE always trigger the MBS session
establishment procedure again, it is not needed to keep the multicast QoS flow
information at the UE/SMF.
For the MBS session deactivation triggered by the AF, the multicast QoS flow
information can be provisioned by the AF via PCF again, it is not needed to
keep the multicast QoS flow information at MB-SMF. For the MBS session
deactivation triggered by the MB-UPF, the multicast QoS flow need be kept to
support the following MBS session activation triggered by the MB-UPF.
NOTE 1: If \"For the MBS session deactivation triggered by the MB-UPF, the
multicast QoS flow need be kept to support the following MBS session
activation triggered by the MB-UPF\" implies that the shared N3 is released
and the SMFs need to update each PDU Session involved, there will be excessive
signalling towards the NG-RAN. Same amount of signalling will be generated
when the shared N3 is to be established again. The implication of such
behaviour needs coordination with RAN WGs.
Solution#2 propose AMF can perform group paging including the Group Paging
Identity (TMGI) in the Paging message. Then the NG-RAN node triggers group
paging. Solution #4, #13, and #32 propose the AMF can determines the list of
UEs to be paged. The AMF send a paging request message to the NG-RAN node(s).
NG-RAN pages the UEs using the existing paging method.
**Interactions between MBSF and MBSU**
Sol#33 proposes enhancements on N4/PFCP procedures to support interactions
between MBSF(MSF-C) and MBSU (MSF-U). This is related to the ongoing
discussion in S2-2007287 and LS S2-2006981 expected to be sent to SA WG4/SA
WG6.
Editor\'s note: Feedback from SA WG4 is required on proposed stage 2
procedures for media processing of MBS service data and related work split.
**multicast session parameters based on analytics**
**Solution 8:** AF derives multicast session parameters based on analytics and
provides them via NEF/UDR to PCF. PCF uses them to derive policies.
**3) Broadcast specific MBS Session Management**
Sol#5, and #9 propose Broadcast Session start/activation procedures, which are
similar though MSF-C and MBSF are used respectively based on different
baseline architectures.
Editor\'s note: Usage of names \"MBS-C\", \"MSF\" and \"MBSF\" needs to be
aligned.
**4) UE mobility / Inter-RAN Handover related MBS Session Management**
Related solutions are either assigned to key issue 1 or key issue 7
A comparison of solutions for UE mobility/Inter-RAN HO related MBS Session
Management procedures is shown in Table 7.5.1-2.
Most of these solutions have aspects dependent on the feedback from RAN WGs
and also the conclusion of solution(s) selected for general MBS Session
Management.
Table 7.5.1-2: Comparison of solutions for UE mobility/Inter-RAN handover
related MBS Session Management
+---------+---------+---------+---------+---------+---------+---------+ | | Sol# | Sol# | Sol#26 | Sol#27 | Sol#39 | Sol#40 | | | 11/#12 | 15/#29 | | | | | | | | | | | | (dual | | | | | | | | RANs | | | | | | | | case) | +=========+=========+=========+=========+=========+=========+=========+ | Pro | **E |** E | **E |** E | **Mult |** E | | cedures | nhanced | nhanced | nhanced | nhanced | icast-\ | nhanced | | for | Xn | Xn/N2 | Xn/N2 | Xn/N2 | >Uni-ca | Xn/N2 | | d | HO**: | HO | HO** : | HO**: | st:** UE | HO**: | | elivery | MB | with** | | | in | | | method | Session | | For | - | itiated | - | | sw | r | UE | warding | Mu | PDU | Mu | | itching | esource | in | mu | lticast | Session | lticast | | | setup | itiated | lticast | or | establ | or | | | during | NAS | data | unicast | ishment | unicast | | | Xn | mu | via | tr | or | tr | | | H | lticast | | ansport | acti | ansport | | | andover | session | mapped | esta | vation; | esta | | | prep | join. | QoS | blished | | blished | | | aration | | flow | in | **Un | in | | | or | | over | target | icast-\ | target | | | ex | | PDU | RAN, | >Multi- | RAN, | | | ecution | | session | de | cast:** | based | | | phase | | from | pending | UE | on UE | | | | | source | on | in | request | | | **E | | to | whether | itiated | of | | | nhanced | | target | target | PDU | unicast | | | N2 | | RAN | RAN | session | or | | | HO** : | | | s | release | mu | | | MB | | | upports | or | lticast | | | Session | | | MBS. | deacti | mode in | | | r | | | | vation. | appl | | | esource | | | - | | ication | | | setup | | | For | | layer. | | | during | | | warding | | | | | N2 | | | MBS | | - | | | H | | | data to | | For | | | andover | | | Target | | warding | | | prep | | | RAN | | mu | | | aration | | | sup | | lticast | | | phase | | | porting | | data | | | | | | MBS. | | over | | | | | | | | PDU | | | | | | | | session | +---------+---------+---------+---------+---------+---------+---------+ | Based | 2 | 4 | - | 3 | | | | on | | | | | | | | which | | | | | | | | s | | | | | | | | olution | | | | | | | +---------+---------+---------+---------+---------+---------+---------+
NOTE 2: Solutions for UE mobility/Inter-RAN HO related delivery method
switching, i.e. solutions #26, #27, #29, #39 and #40, are also listed here for
a common evaluation.
These solutions will be further evaluated as part of the KI#7 evaluation.
Following list illustrates alternatives per technical aspect for evaluation.
**Consideration on MB session network operations (e.g. start, stop, delete,
suspend, resume, configuration, etc.):**
Alternatives:
Alt 1: AMF triggers RAN for session start notification (Sol#2, 4, 5, 13, 32);
Editor\'s note: Session start notification needs RAN coordination.
Alt 2: UE initiates session join after session start time if known, no session
start notification (Sol#4)
Initial try of session join may be rejected by network with MB session
information provisioned
**Consideration on MB session user operations (e.g. join, leave, etc.):**
Alternatives:
Alt 1: Operation via CP using NAS message
> Alt 1.1: NAS message does not include associated PDU session information
> (Sol#2, 4, 14);
> Alt 1.2: NAS message includes associated PDU session information (Sol#3, 4,
> 6, 10, 16, 32);
> Alt 1.3: NAS message includes application layer container (Sol#4);
Allow application specific MB session join/leave operation
Alt 2: Operation via UP (Sol#2, 3, 4, 32)
Alt 3: Operation via CP using RRC message for UE in RRC-INACTIVE state (Sol#4)
Alt 4: Support aggregation of multiple session join/leave requests on UE
(Sol#4)
Uses multiple MB session IDs in NAS message
Alt 5: Support session leave silently (Sol#4)
Alt 6: Support AF initiated MB session user operations (Sol#3, 8)
AF provides information of UE and MB session to 5GS for transmission resource
setup to a user
**Consideration on MB-SMF selection for MB session user operations:**
Alternatives:
Alt 1: AMF queries NRF (Sol#2, 16);
Alt 2: AMF queries UDM/UDR if session join via CP without PDU session
information (Sol#4);
Alt 3: AMF selects MB-SMF based on S-NSSAI and DNN (Sol#6, 10, 14);
Alt 4: UPF notifies SMF of session join via UP, SMF informs AMF to select MB-
SMF (Sol#2, 16);
Alt 5: SMF selects MB-SMF (Sol#3, 4, 32)
UPF notifies SMF of session join via UP, SMF selects MB-SMF, or SMF receives
signalling of session join with PDU session information and selects MB-SMF
**Consideration on selection of 5GS Shared or Individual MBS traffic delivery
method:**
Alternatives:
Alt 1: AMF determines the delivery method (Sol#2);
Alt 2: SMF determines the delivery method (Sol#3)
Alt 3: MB-SMF determines the delivery method (Sol#4)
Alt 4: Criterial for delivery method determination
> Alt 4.1: RAN node 5MBS capability (Sol#2, 4)
> Alt 4.2: UE count under a RAN node (Sol#4)
> Alt 4.3: UE count of a MB session (Sol#4)
> Alt 4.4: AF indication of individual delivery disablement (Sol#2)
**Consideration on session context management in 5GC:**
Alternatives:
Alt 1: AMF stores the session context (Sol#2);
Alt 2: MB-SMF stores the session context (Sol#2, 4, 6, 9, 10);
Alt 3: SMF stores the session context (Sol#3);
Alt 4: MBSF stores the session context (Sol#2);
**Consideration on MB session ID (e.g. TMGI, HL MC address etc.) for MB
session identification:**
Alternatives:
Alt 1: 5GC internally assigned ID (Sol#2, 4)
> Alt 1.1: With 1-1 mapping to an IP multicast address or a source specific
> multicast address (Sol#2);
> Alt 1.2: With m-1 mapping to an IP multicast address or a source specific
> multicast address (Sol#4)
AF uses same IP multicast address for multiple MB sessions (e.g. distinguished
by source port) to avoid frequent maintenance of IP multicast routing over
internet
> Alt 1.3: With 1-1 mapping to N6 tunnel for non-IP multicast service (Sol#4);
Alt 2: AF assigned ID (Sol#3)
5GS does not assign internal ID, while uses IP multicast address or source
specific multicast address as MB session ID
**Consideration on N3 tunnel operation for 5GC Shared MBS traffic delivery
method:**
Alternatives:
Alt 1: AMF forwards signalling for shared N3 tunnel setup/release from RAN to
MB-SMF (Sol#2, 3, 4);
> Alt 1.1: RAN indicates MB-SMF ID to AMF for signalling forwarding (Sol#3, 4)
> Alt 1.2: RAN indicates MB session ID to AMF for signalling forwarding
> (Sol#2)
AMF manages MB session context and determines the MB-SMF accordingly (Sol#2)
Alt 2: Keep shared N3 tunnel when session stopped and release during session
delete (Sol#2)
Alt 3: Release shared N3 tunnel during session stop (Sol#4)
**Consideration on N9 tunnel operation if needed:**
Alternatives:
Alt 1: SMF gets N9 DL tunnel information (similar as C-TEID) from MB-SMF
(Sol#4)
SMF provides the N9 DL tunnel information to UPF, and UPF associates the PDU
sessions with the N9 DL tunnel information
Alt 2: SMF provides N9 DL tunnel information to MB-SMF for multicast flow
redirection (Sol#3, 4)
SMF provides the N9 DL tunnel information to UPF, and UPF associates the PDU
sessions with the N9 DL tunnel information
**Consideration on PSA-UPF joining into multicast tree for 5GC Individual MBS
traffic delivery method if needed:**
Alternatives:
Alt 1: SMF gets LL MC address from MB-SMF (Sol#2, 4)
Alt 2: SMF gets HL MC address from MB-SMF (Sol#2, 4)
**Consideration on service parameters provisioning:**
Alternatives:
Alt 1: UDR is the storage place (Sol#3, 4, 8);
Alt 2: MBSF is the storage place (Sol#6)
Alt 3: MB-SMF is the storage place (Sol#2)
**Consideration on UE mobility in CM-CONNECTED and RRC-CONNECTED state:**
Alternatives:
Alt 1: Support handover for MB session with forwarding option (Sol#15, 27)
Editor\'s note: Handover with forwarding option needs RAN coordination.
> Alt 1.1: Source gNB forwards data of MB session to target gNB if needed
> Alt 1.2: Uses SN number of packet assigned by CN for packet loss/duplication
> determination
Alt 2: Support handover for MB session without forwarding option (Sol#11, 12)
**Consideration on Xn handover:**
Alternatives:
Alt 1: Target gNB interacts with 5GC during handover preparation phase if
needed (Sol#11, 15)
> Alt 1.1: Target gNB responses to the source gNB after exchange messages with
> AMF for adding the target gNB into the MB session (Sol#11)
> Alt 1.2: Target gNB simultaneously responses to the source gNB and exchanges
> messages with AMF for adding the target gNB into the MB session (Sol#15)
Alt 2: Target gNB adds into the distribution tree during handover execution
phase if needed (Sol#11, 15)
**Consideration on N2 handover:**
Alternatives:
Alt 1: Target gNB adds into the distribution tree during handover preparation
phase if needed (Sol#12, 15)
> Alt 1.1: MB-SMF setups transmission resource to target gNB via AMF if needed
> (Sol#12)
> Alt 1.2: Target gNB sends N2 message to AMF after receiving the instruction
> from 5GC if needed (Sol#15)
Alt 2: Target gNB adds into the distribution tree during handover execution
phase if needed (Sol#15)
### 7.5.2. Discussion
#### 7.5.2.1 Multicast solutions
**Trigger for establishment of multicast sessions in the PLMN**
Many solutions (e.g. Solution 2, 3, 4, 6) suggest that a multicast session is
created in the PLMN when the AF requests a reservation of resources for a
multicast session. Some solutions also allow the creation of a multicast
session based on configuration. Some solutions (e.g. solution 3, 4) in
addition allows for a dynamic creation of multicast sessions in the PLMN
without any AF interaction and configuration when it is observed that a UEs
joins a multicast session in an external network (e.g. via IGMP join using a
source specific multicast address of the external network). All options seem
to offer advantages.
Regarding the dynamic trigger for a creation of multicast sessions without any
configuration:
\- It is not enough that clients activate the reception of a Multicast group,
there needs to be a sender. Thus, application level service announcement
and/or service negotiation is assumed. The Multicast sender may not be aware
whether there are zero or more receivers.
\- Support of IP Multicast on the public internet (external Data Network) is
not widespread since IGMP is not used between routers and PIM or other routing
protocols are used. IP Multicast is primarily used in private or enterprise
networks, i.e. within one autonomous domain where there is coordination
between Multicast sender and receiver, since IP Routing must be configured.
However, newer technology such as RFC 8777 [24] enables an automatic
establishment of tunnels for multicast traffic through the public internet;
the source address of the source-specific multicast address is used to
discover tunnel endpoints for the network domain where the multicast data
source is located.
NOTE: Different IP Multicast tunnelling solutions, e.g. GRE or AMT (see RFC
7450 [25] and RFC 8777 [24]), have been specified so that the IP packets of a
remote IP Multicast Server (e.g. IPTV Channel provider) can be forwarded via
not-IP-Multicast-enabled-networks. The MNO may make an agreement with the
remote tunnel end-point on the tunnelling solution and potentially on access
rights, but this is not required for AMT. Furthermore, agreements with transit
IP network are beneficial to ensure a well-defined connectivity performance
(IPTV streams require a certain bandwidth due to timing of the video and
audio). There is also security concern against RFC 7450 [25] that many of the
threats and vectors described in RFC 3552 [26] may be employed against the
protocol to launch various types of denial-of-service attacks that can affect
the functioning of gateways or their ability to locate and communicate with a
relay; RFC 8777 [24] addresses some of those concerns.
\- If AMT is not used, IP multicast between MNO and Content Provider requires
SLA and IP network configurations, thus the dynamic creation may not work as
expected.
\- RFC 8777 [24] uses a trusted DNS server and a secure connection. 5GC can
validate using that DNS server whether the SSM address is valid, and thus
check whether the UE joins a valid SSM and protect against DoS attack as well
as unexpected radio resource usage.
\- Without AF configuration, there is no possibility to provide QoS
differentiation to different MB service data flows.
**Join/Leave Operation:**
All solutions for multicast contain an operation where the UE indicates to the
network the desire to receive contents of a multicast session.
Most solutions suggest that control plane signalling can be used for that
purpose. In addition, many solutions (e.g. 2, 3 and 4) allow for a user plane
based join/leave operation. Solution 16 suggests using the control plane PDU
session establishment signalling. For control plane signalling, solution 4
suggests aggregation of multiple session join/leave requests on UE and allow
application specific MBS session join/leave operation. Solution 4 also
suggests that UE can leave an MBS session silently. Solution 3 and 8 suggest
AF can interact with 5GS for a user to join/leave an MBS session.
Table 7.5.2.1-1
How the UE join/leave the MBS session. Both CP and UP CP only
* * *
solution #2, #3, #4, #10, #16 #6, #8
For CP join, there are further differences in what signalling is used:
Table 7.5.2.1-2
CP join signalling PDU session related signalling Dedicated signalling
* * *
solution #3, #4, #10, #16 #2, #4, #8
Using control plane signalling offers the advantage that it works independent
of an established PDU session and is easily accessible in the AMF, and that is
more flexible.
Different view whether IGMP Join is really needed is expressed (e.g. in
S2-2007266):
\- Join/Leave operation via UP signalling can be avoided by means of the 5G-RG
snooping the UP Join/Leave from the STB and convert it to CP(NAS) signalling.
With this, the system impact for 5MBS can be minimized as far as join/Leave is
concerned.
\- For applications which expect to use IGMP/MLD Join to receive content, the
5MBS capable UE (including 5G RG) snoops the IGMP/MLD message and converts
IGMP/MLD Join/Leave to NAS Join/Leave.
Using user plane signalling (IP IGMP join) offers the advantage that it is
well aligned with IP technologies. It avoids double signalling if a UE wants
to join an external multicast session and is also well suited as dynamic
trigger for a creation of multicast sessions.
Using PDU session related signalling can achieve an integrated MBS and PDU
session management as well as an easier upgrade from unicast support to
multicast support, but always need a PDU session for the purpose.
Using dedicated signalling has advantage that does not mandate UE to have a
PDU session associated with MBS session if not required at the time of join.
**Multicast Session ID and selection**
Many solutions suggest reusing the TMGI allocated by the PLMN as multicast
session identifier. Other solutions (e.g. solution 3) suggest using a source
specific IP multicast address as identifier.
Table 7.5.2.1-3
MBS session ID TMGI IP multicast address unknown
* * *
solution #2, #4, #10, #11, #12, #14, #15, #16 #3, #13, #16, #32 #5, #6, #8,
#9,
The source specific IP multicast address is globally unique and a source
specific IP multicast address used as identifier for an external multicast
session and selected by an external network can also be used as identifier
within the PLMN. However, the identifier can also be allocated by the PLMN as
it is globally unique. There is also view whether it is suitable to use an
external source specific IP multicast address as an identifier within 5GC.
For UP (IP IGMP) join, only IP multicast address is supported.
As TMGI is used as identifier in existing MBMS applications e.g. for public
safety and may simplify migration of such applications to 5G as well as
dynamic fallback from 5MBS to 4G MBMS due to coverage restrictions which is
further clarified in the KI#9.
Solution 3 allows for usage of TMGIs in addition to multicast addresses by
mapping TMGIs to multicast addresses.
Solution 4 suggests an IP multicast address could have multiple TMGI
associated, which are distinguished by packet filters.
**Handling of multicast session context including knowledge about UE
participation in multicast session:**
Solution 2 and 16 proposes the AMF for that purpose.
Other solutions (e.g. 3, 4) suggest that the SMF used also for unrelated
unicast PDU sessions: is used for that purpose.
Table 7.5.2.1-4
+----------------------+----------------------+----------------------+ | NF that stores the | AMF | SMF | | multicast context | | | +======================+======================+======================+ | solution | #2, #16 | #3, #4, #6, #8, | | | | #10, #16 | +----------------------+----------------------+----------------------+ | Notes | - UE sends an UL | - UE sends PDU | | | NAS MB Session Join | Session | | | Request to AMF | establishment/ | | | including the MBS | modification request | | | group information. | to 5GC. | | | | | | | - AMF selects the | - SMF (i.e. | | | MB-SMF and/or | handling unicast PDU | | | further fetches the | session) fetches the | | | MB Session Context | MB Session Context | | | from MB-SMF if | from MB-SMF if | | | needed. | needed. | | | | | | | - AMF provides the | - SMF handling | | | MB Session Context | unicast PDU session | | | to RAN during | deals with the | | | session start | request and provides | | | procedure. | the unicast PDU | | | | session ID together | | | - 5GC Individual | with multicast | | | MBS traffic delivery | session info to RAN. | | | only used when RAN | | | | doesn\'t support MBS | | | | and application can | | | | apply 5GC individual | | | | MBS traffic | | | | delivery. | | +----------------------+----------------------+----------------------+
**Discussion of SMF to handle multicast context:**
\- Some solutions (e.g. #3, #10 and #16) assume QoS flow level association to
guarantee the network level lossless handover. For the related solutions, RAN
coordination may be required to verify the proposed solution for not using the
above unicast QoS Flows when NG RAN and UE support 5G MBS, and for reserve
resource when they are used. Such \"unicast QoS counterpart\" context will be
stored at RAN side, and in the Radio bearer level, some dynamic scheduling is
possible and there could be no radio resource wasted for the reservation (note
that such part depends on the output of RAN WGs).
\- Since the unicast PDU Session associates with multicast session, reusing
the unicast PDU Session resources when UE handovers from the MBS-capable RAN
to the RAN without MBS capability, to transmit/forward the MBS data from
M-UPF/S-RAN is possible, and the session continuity can be handled in the
network level.
**Discussion of AMF to handle multicast context:**
\- The AMF is enhanced to support the management of Multicast session,
including:
1) UE authorization for accessing MBS Session;
2) determining the delivery mode of MBS Session;
3) maintaining MBS Session Context;
4) controlling activation/deactivation of the MBS Session;
5) sending notification to UE to trigger unicast PDU Session establishment;
6) selecting (MB-)SMF for the MBS session; and so on.
Such design assumes AMF with the SM functionalities and is lack of separation
between MM and SM.
\- Using the AMF may have the advantage of allowing a participation in a
multicast session for a UE with no PDU session and to limit the number of
impacted network entity types for a basic multicast support. It may also allow
a UE to join a bit quicker and with less load on the network. However,
fallback to individual delivery and UP Join via IGMP still requires a PDU
session and also impacts the SMF. Further, if multicast support in a network
is not homogenous, the information about UEs participating in a multicast
session may be lost when a UE is handed over to an AMF not supporting MBS.
Also, checking the UE authorization to participate in a multicast session
based on policies may be more complicated compared to SMF controlling UE
participation in a multicast session.
\- For the UE that handovers from an MBS-capable RAN to the RAN only support
unicast, considerable latency could be experienced: Since the target RAN
cannot support MBS, unicast PDU Session is chosen to transmit the MBS data
(i.e. 5GC shared MBS traffic delivery mode), if the resources (e.g. unicast
PDU Session or QoS Flow) to transfer the MBS data has not been established
yet, network has to trigger the related SM procedures (e.g. PDU Session
Establishment/ Modification) to enable MBS data reception, but such SM
procedures have to be held on because of the ongoing MM procedure (i.e.
Handover), which may lead to a large latency.
During the inter-AMF mobility, the source AMF shall send the UE MBS context to
target AMF.
**Root of multicast distribution tree for shared delivery and ingress point
for multicast data**
All solutions assume that there is a multicast distribution tree for shared
delivery having a single root. Many solutions allocate the root in the MB-UPF
controlled by a MB-SMF (e.g. solution 2, solution 3, solution 4). The MB-SMF
may be a SMF also handling PDU sessions or a separate entity. Solution 6
suggest using the MBSF and thus requires that the MBSF is used for all
multicast sessions.
Table 7.5.2.1-5
Root of multicast distribution tree MB-UPF MBSF-U
* * *
solution #2 #3, #4, #6
Many solutions assume that there is a single ingress point towards an external
network for multicast data that can be collocated with the root of the
multicast distribution tree. However, to allow for an optional media
processing in a dedicated entity it is also proposed by many solutions that
use the MB-UPF as root of the multicast distribution tree that the ingress
point can optionally be allocated in a MBSF-U
Solution #6 and #10 assumes the SMF handling unicast PDU Session will be the
same as MB-SMF controlling MB-UPF However, other such as Solution #3 consider
separating the two SMFs and the unicast SMF finds MB-SMF (multicast SMF) when
UE joins.
It was agreed that the MBSF-U will only be deployed in certain configurations,
so an MBSF-U based solution will not address all scenarios.
**Selection of root of multicast distribution tree selection**
Most solutions suggest that the root of the multicast distribution tree for
shared delivery and ingress point are assigned when the multicast session is
established (see above)
There is a need to subsequently discover the root of the multicast
distribution tree (e.g. by an AMF when a UE joins). Solution 2 suggest that
TMGI ranges are assigned by configuration to specific roots of multicast
distribution trees for that purpose. Other solutions suggest storing the
multicast distribution tree root for a multicast session in a database (UDR
e.g. for solutions 3 and 4, and NRF e.g. for solution 16).
In Sol#3 and solutions based on Sol#3, the SMF interacts with UDR to retrieve
the MB-SMF info, however currently SMF does not interact with UDR, and example
consumers of UDR services are only UDM, PCF and NEF. It can be determined in
the normative phase whether the SMF uses the PCF to interact with the UDR.
As it is agreed to support also source specific multicast addresses, a
selection based on TMGI ranges is not sufficient to address all cases.
**MBMS session start:**
Many solutions suggest that an AF can request the start of an MBMS session
that would result in resource reservation and a possible paging of UEs within
a MBMS session. (e.g. solution 2, solution 32).
But it is also suggested that the MBMS session start can be combined with the
MBMS session establishment (e.g. solution 3) or that the MBMs session start
can be triggered by the reception of multicast data (e.g. solutions 13 and
32).
The need for a session start to trigger UE paging depends on whether the UE
can become CN IDLE while in a multicast session. Coordination with RAN is
necessary,
Some solutions suggest that there is a single AF request for reserving
resources for the multicast session and starting it (e.g. solution 3), whereas
other solutions suggest separate interactions. Solution 3 suggests that RAN
establishes the MB Session Context during the session join procedure triggered
by the UE.
A first interactions may be required prior to service announcements to request
TMGIs to be announced from the network that allocates them; this is not
required if a multicast session ID allocated by the AF is used instead. The
implication is that the UE join may be rejected if the MBS session is not yet
started and the UE needs to reattempt.
Solution 2 suggest a group-based RAN paging mechanism is used and additional
clarifications (e.g. how could the AMF figure out the group paging area) are
provided in S2-2008518. Moreover, after receiving the group paging, UE sends
MB Session join request to AMF. If such MB Session join message is not Service
Request, UE needs to be enhanced accordingly (i.e. triggering another
procedure rather than Service Request upon the reception of paging message),
if the message is Service Request, the NAS message needs to include TMGI
information.
It may also depend on the use case whether a UE join prior to the start of the
multicast transmission should be accepted. For instance, a constant
transmission of TV channels, service announcements only when the multicast
session has been established, or the ad-hoc establishment of multicast
distribution do not require a separate start of the multicast transmission;
for other use cases where the service is announced prior to the start the user
experience may be better if a join is accepted prior to the session start.
**Service announcements:**
Most solutions assume an application level service announcement from AF to UE.
However, Solution 14 suggest extending URSP for that purpose.
Announcement over application level may have impact on multicast application
client and OS layer on UE, announcement over 3GPP layer is also an alternative
that has less impact on UE.
However, application level service announcements offer large flexibility and
enable rich and human-readable description of the contents of a multicast
session in a customized user interface offered by the application provider
that could be rendered by an API or Webpage on the device. New multicast
sessions can be easily added without or with minimal network impact only, and
the user can actively select information sources for service announcements.
In contrast, for URSP only limited content could be provided in a service
announcement and selective download of service announcements based on user
preferences and interactions would hardly be possible.
Existing MBMS applications such as public safety also use application level
service announcements.
**5GC allowing AF to disable the usage of 5GC individual delivery**
Sol#2 allows the AF to disable the usage of 5GC individual delivery when 5MBS
capable UE camping on NG-RAN not supporting 5MBS joins a multicast session.
The main consideration is, compare 5GC individual delivery with unicast
delivery, the former has some drawbacks (e.g. 5GC individual delivery does not
provide the possibility of rate adaption), therefore such delivery method is
not suitable to be used as the norm for application that expects to use rate
adaptation for possible improvement of user experience.
On the other hand it is unclear how seamless an application level fallback to
unicast delivery can be and there is a risk of service loss.
7.5.2.2 Comparison between AMF centric vs SMF centric approach
AMF centric approach refers to the solution that AMF is responsible for
setting up the shared delivery (e.g. Sol#2), while the SMF centric approach
refers to the solution that SMF responsible for setting up the shared delivery
(e.g. Sol#3). Related evaluation is also provided under subheading \" Handling
of multicast session context including knowledge about UE participation in
multicast session\" in clause 7.5.2.1,
Both AMF-centric and SMF-centric approaches can fulfil the basic requirement
of shared delivery, and the optional requirement of Individual delivery.
For interworking with EPS, Individual delivery may be possible for SMF-centric
approach assuming the individual delivery resource can be properly released
when not needed.
The following potential issues are raised during SA2#142E CC#1 with respect to
the SMF centric approach:
\- How the SMF gets MB-SMF ID; It was commented that MB-SMF discovery with
similar issue also applies for the AMF in the AMF centric approach. Further,
allowing new consumers for a service based interface at the UDR would be in
line with overall SBA design principles, However, using the PCF to do the UDR
lookup can be considered as alternative to the direct SMF UDR interaction in
the normative phase.
\- For location dependent MB service: how the additional identifier (e.g. Area
Session identifier/Flow ID) will be obtained; It was commented that this
relates an insignificant detail of solution 21 for key issue 6 (that is based
on solution 3), where the UDR allocated the Area Session identifier, and it
could be assessed in the normative phase whether the NEF or MB-SMF could
instead allocate the identifier and store it in the UDR.
\- UE joining may get rejected due to MBS Session not configured yet in MB-
SMF, there is no way for the UE(s) to know when MB-SMF has been configured,
the UE(s) may keep trying causing denial of service attack type situation; It
was commented that this discussion is unrelated to the AMF vs SMF centric
approach. For instance, solution 32 based on solution 3 also provides a
separate session activation for the SMF centric approach.
\- 5MBS in Roaming: how the inbound roamer would not be able to join the
multicast service; It was commented that roaming requires more study for both
the AMF and SMF centric approach, where individual delivery deserves special
attention, and that using a LBU PDU session might be a possible solution.
\- Signalling increase unnecessarily due to MBS Session operation performed
via PDU Session signalling, examples are:
\- MBS Session Update will have to be performed \"per PDU Session per MBS
Session\" instead of \"per MBS Session\".
\- The proposal of MBS Session deactivation by releasing the MBS QoS Flow or
releasing the shared N3 tunnel will have to be performed via PDU Session as
well.
\- It was commented that this relates to setting up associated QoS flows for
multicast in the associated PDU session already when the UE joins in
preparation of a possible future fallback to individual delivery. This
procedure could again be applied in combination with AMF or SMF centric
approach and should thus be discussed separately.
#### 7.5.2.3 Broadcast solutions
There are 4 solutions for the Broadcast, i.e. solution #5, #9, #44 and #45.
Solution #5 defines the procedure for broadcast based on Architecture baseline
#1. The broadcast session is established based on the request from AF. The
receiving UEs are agnostic to the 5GC, and the UE itself could be either pre-
configured the needed configuration (e.g. USD), or provisioned with the
configuration of broadcast session which may be performed using SIP signalling
or methods described in TS 26.346 [18] including announcement over a broadcast
session for service announcements.
Solution #9 defines the procedure for broadcast based on Architecture baseline
#2. The different parts compared with Solution #5 are:
1) the DL broadcast data will be sent to UEs from AF via MBSU, MB-UPF and RAN;
and
2) the service announcement procedure is needed before UE receives the MBS
data.
Solution #44 defines the procedure for broadcast based on Architecture
baseline #3 and solution #2. The TMGI is used for both network and UE to
identify the Broadcast session. The UE receives TMGI in the broadcast service
announcement via unicast signalling. The AF requests the Broadcast session
with TMGI, Service information and broadcast area. The MBSF select the MB-SMF
which handle the Broadcast session. The MB-SMF selects the AMF, and AMF select
the NG-RAN for broadcast according to the broadcast area. The NG-RAN
advertises the TMGI representing the MBS service over radio interface.
Solution #44 also include Session Update and Delivery Status Indication in
S2-2008519 to fulfil the requirements from mission critical use cases.
Solution #45 defines the procedure for broadcast based on Architecture
baseline #3 and solution #3. This solution proposes to use as much commonality
between the functionality and procedures for Multicast service and the
functionality and procedures for Broadcast service. There are two methods to
establish the Broadcast MBS session, with MBSF and without MBSF.
A comparison of solutions covering Broadcast MBS Session Management procedures
is shown in Table 7.5.2.3-1.
Table 7.5.2.3-1: Comparison of solutions for KI#1 Broadcast MBS Session
Management
+----------+----------+----------+----------+----------+----------+ | | solution | | | | | +==========+==========+==========+==========+==========+==========+ | funct | 5 | 9 | 44 | 45 (with | 45 (w/o | | ionality | | | | MBSF) | MBSF) | +----------+----------+----------+----------+----------+----------+ | B | preco | | UE may | UE | UE | | roadcast | nfigured | | receive | dis | dis | | service | with | | b | covering | covering | | d | confi | | roadcast | a | a | | iscovery | guration | | service | service | service | | in UE | (e.g. | | anno | should | should | | | USD), or | | uncement | be | be | | | pro | | via | common | common | | | visioned | | unicast | for | for | | | with the | | from AF. | m | m | | | confi | | | ulticast | ulticast | | | guration | | | and | and | | | using | | | b | b | | | SIP | | | roadcast | roadcast | | | si | | | | | | | gnalling | | | | | | | or | | | | | | | method | | | | | | | in | | | | | | | 26.346 | | | | | +----------+----------+----------+----------+----------+----------+ | AF | MBS | service | TMGI, HL | B | TMGI, | | request | service | type, | MC | roadcast | | | info | ide | target | Address, | service | B | | | ntifier, | service | Service | area, | roadcast | | | B | area, | Requ | B | service | | | roadcast | target | irement, | roadcast | area, | | | area, | service | b | ind | B | | | QoS | UE | roadcast | ication, | roadcast | | | requi | group. | area | Qos | ind | | | rements, | | ( | request. | ication, | | | DNN, | (AF | internal | | Qos | | | NSSAI | select | format, | | request. | | | | MBSF | e.g. TAI | | | | | | a | or | | | | | | ccording | external | | | | | | to | format) | | | | | | service | | | | | | | type, | | | | | | | target | | | | | | | service | | | | | | | area | | | | | | | etc.) | | | | +----------+----------+----------+----------+----------+----------+ | B | NEF or | MBSF | TMGI. | ? | TMGI | | roadcast | MSF | allocate | | | | | Session | allocate | the | MBSF or | | | | ID | the | session | MB-SMF | | | | | session | ID. | allocate | | | | | ID | | the TMGI | | | +----------+----------+----------+----------+----------+----------+ | MB-SMF | NEF/MSF | MBSF | MBSF | Same | Same | | s | via NRF | select | select | with | with | | election | | the | MB-SMF | sol#3 | sol#3 | | | | MB-SMF | via NRF | | | | | | | or | | | | | | | a | | | | | | | ccording | | | | | | | to local | | | | | | | confi | | | | | | | guration | | | +----------+----------+----------+----------+----------+----------+ | AMF | MB-SMF | MB-SMF | MB-SMF | MB-SMF | MB-SMF | | s | select | select | d | select | select | | election | AMF via | AMF | iscovers | AMF via | AMF via | | | NRF | a | the | NRF | NRF | | | | ccording | AMF(s) | | | | | | to | based on | | | | | | coverage | the | | | | | | of AMF | b | | | | | | | roadcast | | | | | | | area | | | +----------+----------+----------+----------+----------+----------+ | NG-RAN | AMF | AMF | AMF | AMF | AMF | | s | select | select | select | selects | selects | | election | NG-RAN | NG-RAN | all | the NG | the NG | | | a | nodes to | NG-RAN | RAN | RAN | | | ccording | cover | nodes in | nodes | nodes | | | to | the | the | con | con | | | b | target | b | trolling | trolling | | | roadcast | service | roadcast | the | the | | | area. | area. | area | target | target | | | | | | cells | cells | +----------+----------+----------+----------+----------+----------+ | B | TAIs and | | internal | TAI or | TAI or | | roadcast | a list | | format, | CGI. | CGI. | | area | of NR | | e.g. TAI | | | | | CGIs | | or | | | | | | | external | | | | | | | format | | | | | | | that is | | | | | | | to be | | | | | | | mapped | | | | | | | to an | | | | | | | internal | | | | | | | format | | | +----------+----------+----------+----------+----------+----------+
## 7.6 Key Issue #4: QoS level support for Multicast and Broadcast
communication services
### 7.6.1 QoS level support for Multicast communication
Solutions #2, #3, #4, #17, #35, #36 and #37 are proposed to address Key Issue
#4.
Solution #3 and #4 mainly address KI#1 \"MBS session management\", but also
address the following aspects for KI#4:
\- Multicast QoS flow(s) management within a multicast session context, and
mapping to radio bearer.
\- Association between multicast QoS flows and unicast QoS flows for 5GC
individual delivery.
Solution #17 and #36 propose the QoS model and general handling (incl. policy
provision, QoS enforcement, etc.) for 5G MBS services based on the QoS
framework of TS 23.501 [2] clause 5.7. Both solutions propose that the PCF
performs policy control for MBS (e.g. QoS control per MBS session) if dynamic
PCC is deployed.
Solution #36 also introduces new QoS parameter (i.e. MBS Session-AMBR) for
MBS. however, MBS Session-AMBR is not needed to be communicated to the RAN due
to the following reason:
\- MBR policing for the MB service data flow (which is DL only) will be
enforced in the MB-UPF, therefore there is no need for NG-RAN to do MBR
policing again, therefore the bit rate for non-GBR MB QoS Flow does not need
to be sent to the NG-RAN.
Solution #35 proposes that the AF can set specific QoS requirements (e.g.
priority) for the MBS service data flows of a specific UE, which is sent to
the 5GC and then forwarded to the NG-RAN. This is motivated by the SA1
requirement in TS 22.280, e.g. clause 5.6 (MCX service priority requirements)
states \"The MCX Service Emergency Alert is initiated from an MCX UE to inform
the MCX Service of the MCX User\'s immediate need of assistance due to the MCX
User\'s personal, life-threatening situation _\",_ such requirement applies to
unicast delivery. While one company believes that this is equally applicable
for group member involved in an MBS Session, another company expressed the
opinion that this requirement applies to the entire group in which the MCX
user in emergency alert is participating.
Solution #37 proposes that 5GC and NG-RAN enforce MBS QoS by performing UEs
and MBS QoS flow association based on UE interests in MBS services.
Solution #2, #3 and #4 propose to use one MBS QoS Fow for an MBS session, and
can use multiple MBS QoS Flows for an MBS session, and if individual delivery
method is used, propose to use dedicated QoS Flow for multicast data in the
PDU session associated with the MBS session. Solution #4 also proposes that
shared QoS Flow for multicast and unicast can be used in the PDU session.
Support one QoS Flow for an MBS session is mandatory, while support multiple
QoS Flows for a MBS session has advantage that allows an MBS session has
multiple IP traffic with different QoS requirements
### 7.6.2 QoS level support for Broadcast communication
Sol#5, Sol#9, Sol#44 and Sol#45 address the broadcast communication. In these
solutions, the AF provides the QoS requirement when starting the MBS Session.
The MB-SMF can get the MBS QoS parameters for the QoS requirement from the MB-
PCF if deployed. If the AF would like to differentiate QoS requirements for
different MB service data flow of the MBS Session, AF needs to provide the
packet filters for the MB service data flow so that the MB-UPF can map the MBS
data to the proper MBS QoS Flow.
## 7.7 Key Issue #6: Local MBS service
Several solutions are documented in current TR for Key Issue #6 including
Solution #5, #7, #19, #20, #21 and #38.
Table 7.7-1: Summary of the solutions for KI #6
+-------------------------+---------------+-------------------------+ | Name | Solution | Note | +=========================+===============+=========================+ | Broadcast Session Start | Solution #5 | - The solution | | | | enhances the existing | | | | 5GC architecture to | | | | provide broadcast | | | | communication services. | | | | | | | | - AF provides | | | | broadcast service area | | | | to 5GC and may provide | | | | it to UE. | +-------------------------+---------------+-------------------------+ | Local multicast service | Solution #7 | - The solution | | discovery and | | proposes local MBS | | provisioning | | service discovery and | | | | provisioning | | | | procedures. | | | | | | | | - NAS signalling or | | | | application level | | | | interaction can be used | | | | to provision local | | | | multicast service | | | | boundary information to | | | | the UE. | +-------------------------+---------------+-------------------------+ | Supporting local MBS | Solution #19 | - Application function | | service | | needs to be able to | | | | provide the local | | | | service area to 5GC and | | | | NG-RAN to ensure the | | | | local MB service can be | | | | delivered within some | | | | certain areas. | | | | | | | | - The UEs outside | | | | those areas should not | | | | be served for the local | | | | MBS service. Local | | | | service area is | | | | provided to UE via | | | | application level | | | | interaction. | +-------------------------+---------------+-------------------------+ | Local multicast service | Solution #20 | - Application function | | | | provides the local | | | | service area to 5GC, | | | | and announce TMGI to | | | | the UEs. | | | | | | | | - UE sends NAS message | | | | to 5GC to acquire the | | | | local service area | | | | information if the cell | | | | list is not provided as | | | | the service area | | | | information in the MBS | | | | service announcement. | | | | | | | | - When needed, UE | | | | sends join request to | | | | the 5GC accordingly | | | | within the local | | | | service area. | +-------------------------+---------------+-------------------------+ | Global Multicast Group | Solution #21 | - Enable the system to | | ID for local Multicast | | keep the multicast | | Contents | | session ID (or TMGI) | | | | when UE moves across | | | | several local MBS | | | | session area(s) while | | | | multicast data and | | | | ingress node for | | | | multicast data can | | | | differ between local | | | | MBS session areas. | | | | | | | | - For each MB service, | | | | its Location Area(s) | | | | and the associating | | | | Location Area ID(s) are | | | | transparent to the | | | | UE(s). | | | | | | | | - UEs are not allowed | | | | to join a multicast | | | | session when outside of | | | | all local MBS session | | | | area(s) of that | | | | multicast session. | | | | | | | | Application function | | | | provides the local | | | | service area to 5GC, | | | | and announce multicast | | | | session ID to the UEs. | | | | It may also announce | | | | the overall area where | | | | the multicast session | | | | is available. | +-------------------------+---------------+-------------------------+ | Move to Local Multicast | Solution #38 | - AF provides target | | services | | (local) service area, | | | | local service | | | | availability to 5GC. | | | | | | | | - AF or MBSF announces | | | | the MBS services | | | | including target | | | | service area, its local | | | | service availability | | | | (including e.g. local | | | | AF ID or address, local | | | | MBSU address) etc. to | | | | UEs. | | | | | | | | - UE in local MBS | | | | service area may join | | | | the local multicast | | | | service for the MBS | | | | service session with | | | | local MBS indication. | +-------------------------+---------------+-------------------------+
\- Solution #5 enhances the existing 5GC architecture to provide broadcast
communication services. As such, the AF provides broadcast service area to
5GC.
\- Solution #5 considers only to enhance 5GC to provide broadcast
communication service, the UE could be provided the area information of the MB
Service.
\- Solution #7 proposes local MBS service discovery and provisioning
procedures. NAS signalling or application level interaction can be used to
provision local multicast service boundary information to the UE.
\- Compared with the NAS-level notification, the application level interaction
with UE has less system impact. However, such OTT-based solution requires the
application have the PLMN-level information, e.g. list of cell ID, TAs, etc.
Note that announcing MB service information in the SIB message needs RAN
cooperation and may not scale well when many MB services need to be announced.
\- Solution #19 assumes the Application function provide the local service
area to 5GC and NG-RAN to ensure the local MB service can be delivered within
some certain areas. In other words, UEs outside those areas should not be
served for the local MBS service. Local service area is provided to UE via
application level interaction.
\- Solution #19 assumes that how UE discovers the local server will be
addressed in TR 23.748 [11]..
\- Solution#19 also address location dependent MB service in S2-2008526
including mobility aspects
\- This solution is based on Solution #2.
\- In Solution #20 the application function provides the local service area to
5GC, and announce TMGI to the UEs, after that UE sends NAS message to 5GC to
acquire the local service area information if the cell list is not provided as
the service area information in the MBS service announcement. The UE could
send join request to the 5GC accordingly when needed within the local service
area.
\- This solution covers the case that the application function does not
understand the PLMN-level information, e.g. Cell ID, the AF only needs to
provide TMGI (MBS session ID) to the UE.
\- Solution #21 provides a way for the system to keep the multicast session ID
(or TMGI) when UE moves across the local MBS session area. For each MB
service, dependencies of contents on Location Area(s) and the associating
Location Area ID(s) are transparent to the UE(s).
\- One or several AFs may assign several service areas to a multicast service.
For each service area the 5GC assigns an MB-SMF and an area session ID and
stores this information in the UDR.
\- Unicast SMF fetches multicast context information from UDR, and SMF selects
location dependent multicast context information based on the location area
where the UE is residing. The SMF determines the applicable MB-SMF ID, area
session ID, location area in that manner. Specific treatment for the handover
case is also considered to avoid transfer the unnecessary MBS data.
\- This also enables local service without location-dependent content: If a UE
tries to join a location dependent multicast session outside an area where
location dependent content for the multicast session is provided, or UE moves
out of an area with location dependent content for the multicast session, the
UE is removed from the multicast session.
\- Application function announce multicast session ID to the UEs. It may also
announce the overall area where the multicast session is available.- This
solution is based on Solution #3.
\- Solution #38 requires the AF provide target (local) service area, local
service availability to 5GC, after that, the AF or MBSF announces the MBS
services including target service area, its local service availability
(including e.g. local AF ID or address, local MBSU address) to UEs, to enable
UE in local MBS service area join the local multicast service for the MBS
service session. UE uses PDU Session Modification/Establishment NAS signalling
with local MBS indication.
\- In order to let 5GC deal the UE\'s join request as the local MBS request,
extra indication in NAS join message is needed. In addition, it is assumed
that the UE location information is understandable of AF. More clarification
on why UE needs to be aware of Local MBS services is needed, since the
determination could be fully at 5GC side even if UE doesn\'t provide any
indication related to Local MBS.
\- This solution is based on Solution #6.
Following list illustrates the technical aspects from candidate solutions
addressing KI#6 Local MBS service.
**Consideration on service area management for a MB session:**
Proposal: Support service area management for a MB session, enabling both
alternative 1 and alternative 2.
Alternatives:
Alt 1: Use different MB session ID for different local MB service at neighbour
service area (Sol#5, 7,... also supported by solution 21).
Alt 2: Reuse same MB session ID for different local MB service at different
service area (Sol#21).
Uses different location area ID for different service area.
Discussion: It depends on the use case whether different local contents is
required as proposed by Alt-2. This possibility was already offered by LTE
MBMS and the MB2 interface via the \"flow ID\" and is thus required when a
reuse of the MB2 interface (e.g. for a smooth migration of public safety
deployments) is desired. It may also be beneficial e.g. for V2X use cases. On
the other hand, other use cases such as a MBS session to distribute local
contents in a factory or in a stadium may not require this capability.
**Consideration on UE\'s awareness of whether a MB session is able to be
served under certain area:**
Proposal: Support of awareness of UE on whether a MB session is able to be
served under certain area. This avoids signalling load when UE attempts to
join outside the area. Announcement of service area at application level is
supported. Announcement at NAS level is FFS and dependent on RAN feedback.
UE is aware of service area of a MB session (Sol#7, 19, 20, 21, 38)
UE acquires configuration and joins into a MB session when entering into the
service area
\- Service area is announced at application level (Sol#7, 19, 20, 21, 38)
\- Service area is provided at NAS level (Sol#7, 19, 20, 38)
\- Sol#7, 20: requested by the UE and updated to the UE
\- Sol#19, 38: included in a Join Reject message
**Consideration on RAN\'s awareness of whether a MB session is able to be
served under certain area:**
gNB is aware of area restriction information (Sol#5, 7, 19, 20, 21)
NOTE: How gNB enforce local service area restriction needs RAN coordination.
**Consideration on enforcement of service area restriction:**
Proposal: Network is able to enforce service area restriction.
**Consideration on 5GS ingress points for different service area:**
Proposal: Support different 5GS ingress points for different service area.
## 7.8 Key Issue #7: Reliable delivery method switching between unicast and
multicast
There are 15 candidate solutions proposed to address key issue#7, i.e.
solution#11/#12/#18/#22/#23/#24/#25/#26/#27/ #28/#29/#30/#31/#39/#40, these
solutions can be categorized as follows:
1) Switching between unicast and multicast: Solution #24, #28, #31, #39, and
#40 (single RAN).
2) Non inter-RAN handover / UE mobility related delivery method switching :
a) Switching between 5GC Shared and Individual MBS traffic delivery methods:
Solution #23, #24, #25, #27, #28, #31, and #40 (single RAN case).
b) Switching between PTP and PTM delivery methods: Solution #18, #22 ,#24,
#25, and #30.
3) Inter-RAN handover / UE mobility related delivery method switching:
Solution #11, #12, #26, #27, #29, and #40 (dual RANs case).
Following are the evaluations on the solutions for each category:
**1) Switching between end-to-end unicast and multicast**
Solution# (28, 31, 39, and 40) propose the UE can trigger the delivery method
switch.
From UE view it can only differentiate the multicast/unicast switch (or vice
versa). All the proposal is that UE receive the information from application
layer or RAN information, the delivery mode is triggered to be switched. This
is related to application logic.
For the AF involved method switch, it is the multicast /unicast switch. It
need involve UE, e.g. establish the related MBS session context at the UE
side. So it is same as the UE trigger mode switch, i.e. per application logic.
As all this is related to service logic, it is not need to be specified in
normative work.
**2) Non inter-RAN handover / UE mobility related delivery method switching**
**A) Switching between 5GC Shared and Individual MBS traffic delivery
methods**
A comparison between solutions for switching between 5GC Shared and Individual
MBS traffic delivery methods is shown in Table 7.8-1.
Table 7.8-1: Comparison of solutions for non-inter-RAT mobility related
switching between 5GC Shared and Individual MBS traffic delivery methods
+-------+-------+-------+-------+-------+-------+-------+-------+ | | So | So | So | So | So | So | So | | | l#23 | l#24 | l#25 | l#27 | l#28 | l#31 | l#40 | | | | | | | | | (s | | | | | | | | | ingle | | | | | | | | | RAN | | | | | | | | | case) | +=======+=======+=======+=======+=======+=======+=======+=======+ | Del | - | - | - | - | - | - | - UE | | ivery | A | Con | N | After | N | MBS | MBS | | m | pplic | tent/ | umber | Inte | umber | se | su | | ethod | ation | A | of | r-RAN | of | rvice | bscri | | swit | level | pplic | the | mobi | de | re | ption | | ching | tri | ation | UEs | lity. | vices | lated | cha | | trig | gger. | S | rece | When | rece | ne | nges. | | gers/ | | erver | iving | UE | iving | twork | | | cri | - | decis | the | move | the | po | - | | teria | QoS | ions. | mult | from | spe | licy, | N | | | req | | icast | one | cific | (e.g. | umber | | | uirem | - | se | gNB | con | prede | of | | | ents. | Hand | rvice | not | tent. | fined | UEs | | | | over. | in a | suppo | | tr | reque | | | - UE | | ce | rting | - | affic | sting | | | MBS | - UE | rtain | MBS | N | thres | the | | | su | p | mult | to a | umber | hold, | same | | | bscri | opula | icast | gNB | of | ne | co | | | ption | tion. | group | suppo | de | twork | ntent | | | cha | | | rting | vices | s | in a | | | nges. | | | MBS, | in a | tatus | spe | | | | | | the | spe | /p | cific | | | - | | | SMF | cific | erfor | area | | | Han | | | tr | loc | mance | | | | dover | | | igger | ation | chan | | | | or | | | the | area | ges); | | | | r | | | mode | re | | | | | esele | | | sw | lated | - UE | | | | ction | | | itch. | to | su | | | | to | | | | the | bscri | | | | t | | | | spe | ption | | | | arget | | | | cific | for | | | | RAN | | | | con | MBS | | | | suppo | | | | tent. | se | | | | rting | | | | | rvice | | | | or | | | | - | cha | | | | not | | | | M | nges. | | | | suppo | | | | easur | | | | | rting | | | | ement | - UE | | | | MBS. | | | | of | m | | | | | | | | mult | oving | | | | - | | | | icast | in or | | | | Prede | | | | signa | out | | | | fined | | | | lling | of | | | | thre | | | | str | MBS | | | | shold | | | | ength | Se | | | | (i.e. | | | | | rvice | | | | UE | | | | | Area; | | | | nu | | | | | | | | | mber) | | | | | - | | | | | | | | | C | | | | | | | | | hange | | | | | | | | | of | | | | | | | | | user | | | | | | | | | p | | | | | | | | | refer | | | | | | | | | ences | | +-------+-------+-------+-------+-------+-------+-------+-------+ | NFs | UE, | RAN, | (MB | SMF | UE, | UE, | UE, | | trigg | SMF, | MBSF, | -)SMF | | (MB | RAN, | SMF | | ering | MSF | Cont | | | -)SMF | AMF, | | | del | | ent/A | | | | SMF, | | | ivery | | pplic | | | | UDM, | | | m | | ation | | | | PCF, | | | ethod | | S | | | | AF | | | swit | | erver | | | | | | | ching | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | Proce | UE or | MBSF | SM | SMF | UE | PDU | - UE | | dures | ne | init | F/UPF | trig | init | Se | trig | | for | twork | iated | init | gered | iated | ssion | gered | | del | init | se | iated | MBS | User | Mo | PDU | | ivery | iated | ssion | new | se | Mult | dific | Se | | m | PDU | u | proc | ssion | icast | ation | ssion | | ethod | Se | pdate | edure | est | Se | proc | Mo | | swit | ssion | proc | | ablis | ssion | edure | dific | | ching | Est | edure | | hment | Join | | ation | | | ablis | | | proce | / | | proce | | | hment | | | dure. | User | | dure. | | | or | | | | Mult | | | | | PDU | | | | icast | | - | | | Se | | | | Co | | SMF | | | ssion | | | | ntext | | trig | | | Mo | | | | U | | gered | | | dific | | | | pdate | | new | | | ation | | | | proc | | proc | | | proc | | | | edure | | edure | | | edure | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | Bas | 1 | 2 | 2 | 1 | 1 | 1 | 1 | | eline | | | | | | | | | ar | | | | | | | | | chite | | | | | | | | | cture | | | | | | | | | used | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+
Solution# (23, 24, 2528, 31, and 40) propose the delivery method switch from
the 5GC, i.e. the shared delivery method to the individual delivery method
switch, or vice versa, based on other triggers than inter-RAN mobility.
Solution#23, #25, #27, #28, #31 and #40 propose that the (MB-)SMF, PCF, SMF,
UDM or AMF triggers the switching between 5GC Shared and Individual MBS
traffic delivery methods.
\- Solution #23, #25, #28 and #40 proposes that the (MB-)SMF triggers the
switching between 5GC Shared and Individual MBS traffic delivery methods based
on number of the UEs receiving the multicast service in a multicast group or
in a specific location area (i.e. a UE count threshold).
\- Solution#27 introduces the SMF triggered individual delivery method to
shared delivery method switch after Inter-RAN mobility. When UE move from one
gNB not supporting MBS to a gNB supporting MBS, the SMF trigger the mode
switch, i.e. change to the shared delivery method.
\- Solution #31 proposes that switching between 5GC Shared and Individual MBS
traffic delivery methods is done via (MB-)SMF initiated session modification
procedure, triggered by the (MB-)SMF\'s detection on changes of network status
or performance, by the PCF based on its policy decision or upon AF requests,
by the UDM based on change of delivery method for the subscribed service
associated with the MBS session, or by the AMF upon detecting that the UE
moves in or out of MBS service area.
**A) Triggered by the MSF/MBSF:**
\- Solution #23 proposes that the MSF can trigger the switching between 5GC
Shared and Individual MBS traffic delivery methods, based on the count of UE
subscribed and utilizing the same content
\- Solution #24 introduces the MBSF can do the delivery method switch based on
different optimization criteria (e.g. UE population in certain area, etc.).
From the 5GC view the mode switch means the switch between the shared tunnel
and unicast tunnel.
If the shared tunnel can be used, it is unclear why the delivery method need
be changed to the unicast tunnel?
When the UE move from a source gNB not supporting MBS to a target gNB
supporting MBS, after the mobility the MBS individual delivery is used. It is
benefit in this case to switch to shared delivery method, which can be
triggered by SMF.
**B) Switching between PTP and PTM delivery methods**
All the three solutions, i.e. Sol #18, #22, #24, #25, and #30 propose that the
NG-RAN decides on using PTP or PTM delivery method over radio interface for
MBS data, and may dynamically switch between these two delivery methods:
\- Solution#18 proposes the NG-RAN do the delivery method switch between PTP
and PTM based on the MBS assistance information from 5GC.
\- Solution#22 proposes the NG-RAN do the delivery method switch between PTP
and PTM totally based on RAN internal decision and no need 5GC involved. In
this case there are no change between the shared delivery and the individual
delivery.
\- Solution#24 propose the delivery method switch from RAN is performed with
5GC involved. In this case it also includes the change between the shared
delivery and the individual delivery.
\- Solution#25 propose when the 5GC decides the shared delivery method is
used, the RAN can do the PTP or PTM independently from 5GC which has the same
view with solution#22.
\- Solution#30 introduces RAN initiated 5GC delivery method switch. When the
RAN node detect multi same MBS session individual delivery, it trigger mode
switch to shared delivery.
NOTE 1: Solution#28 mention the mode switch triggered by RAN. However it
indeed is the UE trigger mode switch.
For solution#18, one LS (S2-2006044) has been sent to RAN. It is suggested to
wait the RAN feedback on whether this information is useful or not.
For solution#30, it is unclear that why the 5GC does not use the shared
delivery from the beginning, i.e. the 5GC shall try to use the shard tunnel if
possible. If that, it is unclear whether this scenario exist.
The difference between the solution#22/25 and solution#24 is on whether the
RAN trigger mode switch also includes the switch between the shared delivery
and the individual delivery. As the NG-RAN node is the MBS capable, there are
no reason why if the shared tunnel can be used, it still need switch to the
unicast tunnel?
**Discussion**
PTP-PTM switching controlled autonomously by the RAN allows for fast reaction
based on number of UEs in a cell, coverage conditions, etc. It is assumed to
occur frequently and avoids that the core network is flooded with related
signalling. There is agreement in RAN working groups to support this
procedure. Coordination with RAN groups is required to see if any core network
involvement apart from setting up multicast session and multicast distribution
towards RAN nodes is required.
PTP-PTM switching appears to be the best solution to address switching based
on number of the UEs receiving the multicast service in a cell. The benefit of
additional solutions to trigger switching based on number of UEs in the
multicast session in a larger area require further discussion.
The need of additional solutions to trigger switching based on other criteria
such as QoS requirements, UE preferences, subscription changes also requires
further discussion. In particular, is it expected that those criteria change
frequently during an ongoing session? Could they also be addressed by setting
up by application level switching to/from end-to-end unicast (see bullet 1)?
**3) Inter-RAN handover / UE mobility related delivery method switching**
A comparison between solutions for inter-RAN handover / UE mobility related
delivery method switching is shown in Table 7.8-2.
Table 7.8-2: Comparison of solutions for Inter-RAN handover / UE mobility
related delivery method switching
+----------+----------+----------+----------+----------+----------+ | | Sol\ | Sol#26 | Sol#27 | Sol#29 | Sol#40 | | | #11/#12 | | | | | | | | | | | (dual | | | | | | | RANs | | | | | | | case) | +==========+==========+==========+==========+==========+==========+ | Pr | Enhanced | Enhanced | Enhanced | Enhanced | Enhanced | | ocedures | Xn HO: | Xn/N2 | Xn/N2 | Xn/N2 HO | Xn/N2 | | for | MB | HO: | HO: | with | HO: | | delivery | Session | | | | | | method | resource | - | - | MB | - | | s | setup | Fo | Shared | Session | M | | witching | during | rwarding | delivery | resource | ulticast | | | Xn | m | or | setup | or | | | Handover | ulticast | In | during | unicast | | | pre | data via | dividual | Xn/N2 | t | | | paration | | delivery | Handover | ransport | | | or | mapped | est | co | est | | | co | QoS flow | ablished | mpletion | ablished | | | mpletion | over PDU | in | phase | in | | | phase | session | target | via UE | target | | | | from | RAN, | i | RAN, | | | Enhanced | source | d | nitiated | based on | | | N2 HO: | to | epending | NAS | UE | | | MB | target | on | m | request | | | Session | RAN. | whether | ulticast | of | | | resource | | target | session | unicast | | | setup | - | RAN | join. | or | | | during | As | supports | | m | | | N2 | sociated | MBS. | May | ulticast | | | Handover | PDU | | involve | mode in | | | pre | session | - | s | app | | | paration | is used | Support | witching | lication | | | phase | for | Fo | between | layer. | | | | lossless | rwarding | 5GC | | | | May | h | MBS data | Shared | | | | involve | andover. | to | and | | | | s | | Target | In | | | | witching | | RAN | dividual | | | | between | | | MBS | | | | 5GC | | - | traffic | | | | Shared | | As | delivery | | | | and | | sociated | methods | | | | In | | PDU | based on | | | | dividual | | session | 5MBS | | | | MBS | | is used | ca | | | | traffic | | for | pability | | | | delivery | | lossless | of | | | | methods | | handover | target | | | | based on | | or | gNB. | | | | 5MBS | | unicast | | | | | ca | | fallback | | | | | pability | | when | | | | | of | | source | | | | | target | | RAN or | | | | | gNB. | | target | | | | | | | RAN does | | | | | | | not | | | | | | | support | | | | | | | MBS. | | | | | | | | | | | | | | May | | | | | | | involve | | | | | | | s | | | | | | | witching | | | | | | | between | | | | | | | 5GC | | | | | | | Shared | | | | | | | and | | | | | | | In | | | | | | | dividual | | | | | | | MBS | | | | | | | traffic | | | | | | | delivery | | | | | | | methods | | | | | | | based on | | | | | | | 5MBS | | | | | | | ca | | | | | | | pability | | | | | | | of | | | | | | | target | | | | | | | gNB. | | | +----------+----------+----------+----------+----------+----------+ | Baseline | 2 | 2 | 1 | 1 | 1 | | arch | | | | | | | itecture | | | | | | | used | | | | | | +----------+----------+----------+----------+----------+----------+
NOTE 2: The evaluation may depend on the feedback from RAN WGs and the
conclusion of relevant solutions to other KIs (esp. KI#1).
Solution# (11, 12, 26, 27, 29, and 40) propose the delivery method switch from
the 5GC, i.e. the shared delivery method to the individual delivery method
switch, or vice versa, based on inter-RAN mobility.
\- Solution #26 and #27 propose to use previously activated PDU session
associated with the MB session for 5GC Shared to Individual MBS traffic
delivery method switching.
\- Solution #29 proposes to use any previously activated PDU session for MBS
traffic forwarding if needed for 5GC Shared to Individual MBS traffic delivery
method switching, UE establishes or activates the PDU session associated with
the MB session at target during handover execution phase.
\- Solution #29 also proposes to use MBS specific QoS information (e.g. range
of QFI specific to MBS) for the QoS flows for MBS sessions, so that for 5GC
Individual to Shared MBS traffic delivery method switching during Xn handover
when source gNB is legacy, the target gNB is aware of that user is interesting
in some MBS sessions. Target gNB according to the indication sends N2 message
to 5GC for pulling downlink MB traffic during handover preparation/execution
phase if needed. For 5GS Individual to Shared MBS traffic delivery method
switching during Xn handover when source gNB is legacy, solution #29 proposes
that target gNB indicates MBS capability to UE in handover command for
indicating UE to initiate session join via target gNB after handover.
**A) Whether the associated PDU Session needs to be activated and the UE and
NG-RAN need to be aware of the linkage between the MBS Session and the
associated PDU Session before mobility?**
\- Solution#11 and #12 propose the associated PDU session can be established
in the handover preparation phase or in the handover Execution phase. When the
AMF determines the individual delivery is needed, the AMF request UE to
establish the related unicast QoS flow within the associated PDU session, i.e.
PDU Session modification procedure is triggered. As while a handover is
ongoing the AMF always pause the non-MM related procedure, the PDU Session
modification procedure can only be executed after the handover procedure. Thus
the service interruption are introduced inevitably.
\- Solution#29 suggests the associated PDU session is established via the MBS
Session join procedure. Same as above this procedure can only be executed
after the handover procedure. To solve the service interruption issue, it is
proposed that the MBS traffic is first delivered via one active PDU Session.
However this introduce more question, e.g. if no other active unicast PDU
Session how to handle it? Whether MBS data packet can be transferred in any
active PDU session? How the RAN node map the related MBS QoS flow into DRB?
\- Solution #26 and #27 have the same view, they all suggest the associated
PDU session need to be established and keep as active before the handover
procedure triggered. By doing that the MBS traffic can be easily switched to
the QoS flow of the associated PDU Session, the service interruption mentioned
above does not exist.
If the associated PDU Session need be activated, it is naturally to let the UE
and RAN be aware the information of linkage between the Multicast QoS flow and
the corresponding mapped unicast QoS flow. This can also avoid unnecessary
service interruption due to UE/RAN is not aware that linkage.
**B) Which NF trigger the switch from 5GC Individual MBS traffic delivery
method to 5GC Shared MBS traffic delivery method?**
\- Solution#11 and #12 propose the AMF trigger the switch. These solution are
based on the session model defined in solution#2. The AMF is the NF select the
delivery method in solution 2.
\- Solution#29 propose the MB-SMF trigger the switch. This solution are based
on the session model defined in solution#4. The MB-SMF is the NF select the
delivery method in solution 4.
\- Solution#26 and #27 are based on the similar session models, which are
respectively based on solution#10 and solution#3. In those two different
session model all assume the SMF is the NF select the delivery method.
In solution#24, the MBSF can perform the 5GC delivery method switching.
Solution#24 depend on the session model defined in solution#6 which proposes
the MB-SMF performing the 5GC delivery method selection and notifying MBSF.
NG-RAN notifies the 5GC/MBSF when a handover requiring 5GC delivery mode
switch is performed.
**C) Whether the support for lossless handover with data forwarding from
source NG-RAN to the target NG-RAN is needed, which needs confirmation by
RAN.**
\- Solution#(11,12) does not support MBS data forwarding during handover. It
claims that how to support MBS data forwarding between S-NG-RAN and T-NG-RAN
is RAN dependent, i.e. wait the RAN feedback.
\- Solution#(26, 27, 29) support/imply the MBS data forwarding during
handover.
\- Solution#(26, 27, 29) also propose the lossless packet transferring to
alleviate/avoid the MBS data lost during handover.
\- Solution#26 proposes two alternatives to alleviate/avoid the MBS data lost.
The first alternative utilize the source RAN timer based mechanism, when the
timer expires, the source RAN stops the MBS data forwarding. This mechanism
has same view with solution#27 and assumes that when this timer is expired,
the MBS packet gap between the two different NG-RAN nodes has been filled via
the forwarding data path. The second alternative used the end marker based
mechanism. For the end marker sent via the shared tunnel, it is complexity to
let the NG-RAN node identify one specific MBS data packet all the time. So the
end Marker via the shared tunnel is not a good way forward. For the end Marker
via the PDU Session, it is the normal handling.
\- Solution#27 supports lossless handover, when the target NG-RAN supports
MBS, the target NG-RAN utilize the packet sequence number comparison to do the
synchronization between the forwarded MBS data and the MBS data directly from
5GC and the source RAN use a timer to terminate the MBS packets forwarding,
when the target MG-RAN does not support MBS, SMF set the timer to hold the MBS
data in PSA UPF and delay the associated PDU session switch to the target
side. The lossless packet transferring mechanism in solution#27 can fit both
the homogeneous NG-RAN case (i.e. both source NG-RAN and target NG-RAN support
MBS) or non-homogeneous NG-RAN case.
\- Solution#29 proposes the 5G CN delay the end marker delivery to keep the
forwarding tunnel exist and delay the AMF perform the path switch procedure
with the SMF until the shared tunnel between the NG-RAN and MB-UPF
established. It is unclear how the SMF and NG-RAN can select the same PDU
session for data forwarding and transfer the end Marker.
## 7.9 Key Issue #9: Minimizing the interruption of public safety services
upon transition between NR/5GC and E-UTRAN/EPC
For services that require interworking with LTE eMBMS the following
considerations are taken into account:
\- LTE eMBMS requires the use of a BM-SC. This includes the use of a TMGI to
identify the service and session on the LTE side.
\- For a UE to be able to identify the same service over LTE eMBMS and 5G MBS,
then one approach is to identify the 5G MBS service with the same TMGI.
\- A way to achieve this is by a joint BM-SC/MBSF which can activate the
transport in both LTE and 5GS.
There are 4 solutions for the KI#9, i.e. solution #41, #42, #43 and #46.
Solution #41 is based on solution #3 and interworking architecture with N26.
It supports seamless handover when UE moves between 5GS and EPS. This solution
does not use the same TMGI for both LTE eMBMS and 5G MBS. The relation between
the TMGI and MBS session ID is aware by the UE through the application layer
signalling. The mobility between EPS and 5GS re-use the 5GS-EPS interworking
with N26. Before the UE move into 5GS, similar as the mechanism in TS 23.468
[5] is used for switching from MBMS bearer delivery to individual delivery via
unicast EPS bearer. Before the UE move into EPS, the associated unicast PDU
Session flow for MBS service shall be prepared. After the mobility to EPS, the
delivery mode can be switched from individual delivery via unicast EPS bearer
to eMBMS as defined in TS 23.468 [5]. If the UE Joined via 5GS, the PGW-C+SMF
has already stored the MBS session context. If the UE first starts the service
via EPS, the PGW-C+SMF is indicated with the TMGI when the switching from
eMBMS to unicast bearer is triggered in EPS, and PGW-C+SMF retrieves MBS
session context at this stage.
Solution #42 is based on the solution #3 and #27. Similar with solution #41,
the mobility between EPS and 5GS re-use the 5GS-EPS interworking with N26. For
the 5GS to EPS mobility, the MBS session context is moved to the associated
unicast PDU Session before the handover. Solution #42 assumes that PGW-C+SMF
already has stored the MBS session context and individual delivery is used
when UE camps in EPS network.
Solution #46 is based on the solution #10. This solution is similar with
solution #41. The difference is the same TMGI value is used for both 5G MBS
and eMBMS. The BM-SC is always co-allocated with MBSF/MBSU.
Solution #43, the interworking between E-UTRAN/EPC MBMS and 5G MBS is at
service layer, by collocating the BM-SC and MBSF functionalities. The same
TMGI is used for both 5G MBS and LTE eMBMS. When the UE camps on NR, the UE
establishes an MBS session context using the MBS context ID. When the UE camps
on E-UTRAN, the UE uses TMGI for MBMS reception according to TS 23.246 [4].
The potential retransmissions is performed at service layer. This solution
assume the target network support eMBMS.The packet loss is handled at service
layer, either between UE and application server or between UE and MBSF+BM-SC.
Table 7.9-1: Comparison of solutions for KI#9
+-------------+-------------+-------------+-------------+-------------+ | | solution | | | | +=============+=============+=============+=============+=============+ | fu | 41 | 42 | 43 | 46 | | nctionality | | | | | +-------------+-------------+-------------+-------------+-------------+ | A | For the | | MB-SC and | MB-SC and | | rchitecture | transport | | MBSF/MBSU | MBSF/MBSU | | | mode, the | | are | are | | | BM-SC and | | co-located. | co-located. | | | MBSF are | | | | | | separated. | | | | | | | | | | | | For the | | | | | | full | | | | | | service | | | | | | mode, the | | | | | | MB-SC and | | | | | | MBSF/MBSU | | | | | | are | | | | | | co-located. | | | | +-------------+-------------+-------------+-------------+-------------+ | Session ID | TMGI in LTE | | The same | The same | | | eMBMS, MBS | | TMGI both | TMGI both | | | session ID | | in 4G and | in 4G and | | | in 5G. | | 5G | 5G | | | | | | | | | The UE is | | | | | | aware of | | | | | | the | | | | | | mapping. | | | | +-------------+-------------+-------------+-------------+-------------+ | Mobility | 5GS-EPS | 5GS-EPS | There is no | 5GS-EPS | | between 4G | I | I | r | I | | and 5G | nterworking | nterworking | estriction. | nterworking | | | with N26. | with N26. | | with N26. | | | | | The | | | | | | i | | | | | | nterworking | | | | | | is perform | | | | | | in the | | | | | | service | | | | | | layer. | | +-------------+-------------+-------------+-------------+-------------+ | Before | The | The | | The | | mobility to | associated | associated | | associated | | EPS | PDU session | PDU session | | PDU session | | | for MBS | for MBS | | for MBS | | | service | service | | service | | | shall be | shall be | | shall be | | | activated | activated | | activated | +-------------+-------------+-------------+-------------+-------------+ | After | Mode switch | Mode switch | | Mode switch | | mobility to | from | from | | from | | 5GS | individual | individual | | individual | | | delivery to | delivery to | | delivery to | | | shared MBS | shared MBS | | shared MBS | | | delivery | delivery | | delivery | +-------------+-------------+-------------+-------------+-------------+
# 8 Conclusions
8.0 General
Any solutions or other descriptions as far as not relevant for the conclusions
are not further updated. Also any Editor\'s notes not relevant for the
conclusions may remain in the TR.
## 8.1 Conclusions for architecture
Architecture option in Annex A.3 \"5G MBS converged system architecture\" is
chosen as the baseline architecture for 5G MBS.
## 8.2 Key Issue #1: MBS session management
### 8.2.1 Interim requirements for conclusions
Conclusions will take into account the following agreed system requirements:
\- For multicast solutions, signalling from the UE to the network to join a
multicast session shall be supported by UE and network. Join/leave operation
via CP (NAS) signalling shall be supported. IGMP/MLD join/leave scenarios are
supported by UE detecting and blocking IGMP/MLD join/leave but initiating the
corresponding CP based join/leave procedures.
\- For N3 transport of the shared delivery method, GTP-U tunnelling using a
transport layer IP multicast method and shared N3 (GTP-U) Point-to-Point
tunnel shall be supported with support for QoS.
\- Both 5GC Shared MBS traffic delivery method and 5GC Individual MBS traffic
delivery method shall be standardized for multicast data delivery.
\- The network shall be able to prepare and start the multicast traffic
transmission for a MBS session after MBS service is started.
\- The network shall support selection of MB-SMF or SMF (depending on
solution) at session join.
\- For N3 transport of the 5GC shared MBS delivery method, for unicast
transport there shall be 1-1 mapping between MBS Session and GTP-U tunnel
towards a RAN node, and for multicast transport there shall be 1-1 mapping
between MBS Session and the GTP-U tunnel.
### 8.2.2 Conclusions
8.2.2.1 General
\- For MBS session management the following conclusions are reached as
baseline for normative work:
\- The MBS session is identified throughout the 5G system transport on
external interface towards AF and between AF and UE, and towards the UE with
an MBS Session ID.
\- MBS Session ID may have the following types: TMGI (MBS broadcast and
multicast Session), source specific IP multicast address (MBS multicast
Session).
\- For MBS multicast Session, source specific IP multicast address can be
assigned by 5GC or external network.
\- If used, the TMGI identifies the MBS session when used for the Multicast
Session Context and to identify the MBS service when used for the Multicast
service context. (see Figure 8.2.2.2-1).
\- The UE shall be able to obtain at least one MBS Session ID via MBS service
announcement.
\- If a multicast session is provided within an SNPN, the multicast session
can still be identified by a (globally unique) source specific IP multicast
address or TMGI. In internal signalling the PLMN ID is complemented with the
NID to identify an SNPN.
\- Source specific IP multicast address or TMGI may be used as MBS Session ID
in NAS messages exchange between a UE and a CN when the UE requests to
join/leave a multicast session.
\- A TMGI is allocated also for MBS multicast sessions that the UE joined with
a source specific IP multicast address. The TMGI is sent to the UE and used in
other signalling messages between RAN, CN and UE.
NOTE: The roaming aspect is not addressed in the R17 normative phase.
8.2.2.2 Multicast session
\- The Multicast session model is depicted in Figure 8.2.2.2-1, with the
following conclusions:
\- The Multicast Service Context applies when the MBSF is used.
\- The SMF/MB-SMF based approach (i.e. SMF/MB-SMF handles session management
for the UE) for Multicast session is adopted.
\- MB-SMF is discovered by querying NRF using multicast session ID:
\- The MB-SMF registers its NF profile, which includes e.g. S-NSSAI, DNN and
MB-SMF service area, to the NRF. The NEF/MBSF discovers the MB-SMF, if not
locally configured, by querying the NRF using these information during
multicast/broadcast session configuration.
\- When a multicast/broadcast session is configured/established, the MB-SMF
updates its NF profile with the multicast session ID to the NRF.
\- During UE join procedure, if needed, the SMF retrieves the MB-SMF ID from
the NRF using the multicast session ID and, selects an MB-SMF based on the MB-
SMF information returned by the NRF. For local MBS services, the SMF takes MB-
SMF service area into account when selecting the MB-SMF.
NOTE 1: It needs to be verified in the normative phase whether the NRF is
suitable to store dynamically changing multicast session IDs and possible area
session IDs associated with the multicast session IDs.
NOTE 2: It needs to be decided in the normative phase whether a database to
hold information about the multicast session is required.
Editor\'s note: The following aspects need to be studied:
\- UE join MB service when involving ETSUN procedure
\- For support of 5GC Shared MBS traffic delivery method and 5GC Individual
MBS traffic delivery method:
\- Both 5GC Shared MBS traffic delivery method and 5GC Individual MBS traffic
delivery method shall be standardized for multicast data delivery. 5GC Shared
MBS traffic delivery method is always mandatory, and 5GC Individual MBS
traffic delivery is required to support UE mobility to/from non MBS-capable
NG-RAN nodes, but otherwise optional.
\- The network shall be able to support selection of 5GC Shared MBS traffic
delivery method or 5GC Individual MBS traffic delivery method based on
criteria of whether RAN node supports 5MBS or not.
\- 5GC Individual MBS traffic delivery method is used when the SMF realizes
that NG-RAN does not support 5GC Shared MBS traffic delivery method and QoS
flow information for 5GC Individual MBS traffic delivery has been provided.
\- MB-UPF acts as the MBS session anchor when 5GC shared MBS traffic delivery
method is used, and UPF acts as the unicast session anchor when 5GC individual
MBS traffic delivery method is used. MBSF-U acts as the media entry point for
the 5GS when MBSF is used.
\- The GTP tunnel is used between PSA-UPF and MB-UPF for 5GC Individual MBS
traffic delivery.
\- The associated PDU Session is a PDU Session that is used for sending
multicast join and leave, and can be used for 5GC Individual MBS traffic
delivery method.
\- Establishment of the associated QoS flow in the associated PDU Session for
5GC Individual MBS traffic delivery method is based on service requirements of
multicast service, networking configuration, local policy, etc.
\- When UE joins a multicast MBS session, the associated QoS Flow in the
associated PDU session is established if the MBS Session is established and
5GC Individual MBS traffic delivery needs to be supported for this MBS
service.
Figure 8.2.2.2-1: Merged MBMS session model
NOTE 3: The model above needs clarification for its application on UE, 5GC and
RAN side, this will be part of normative work.
NOTE 4: The terms \"stop\", \"release\", \"deactivated\" (as well as
\"establishment\", \"start\", \"activation\") used as MBS session actions need
clear definitions, this will be part of normative work.
NOTE 5: When the MBS Session is deactivated, whether the multicast flow need
be removed from the MBS Session context is to be decided in normative phase.
The following states are proposed:
**\- Configured multicast session** : No multicast data are transmitted. Some
information about the multicast session is configured, but no resources are
reserved. For instance, TMGIs can be allocated but no complete session
information be provided UEs may be allowed to join (subject to authorization
check and configuration), but the first accepted UE join request will trigger
the multicast session establishment.
\- **Active multicast session** : Established multicast session in active
state. Multicast data are transmitted to UEs that joined the multicast
session. 5GC resources for the multicast session are reserved. Corresponding
Radio resources are reserved depending on participating UE locations. UEs that
joined the multicast session are in CM CONNECTED state. UEs are allowed to
join the multicast session (subject to authorization check)
\- **Inactive multicast session** : Established multicast session in inactive
state. No multicast data are transmitted. UEs that joined the multicast
session may be in CM CONNECTED or CM IDLE state. UEs are allowed to join the
multicast session (subject to authorization check).
The following procedures are proposed:
\- **Multicast Session Configuration** : The AF can provide information about
the multicast session and/or request the allocation of a TMGI. Alternatively,
there is network-internal configuration of the multicast session. No resources
or only resources at MB-SMF, NEF and MB-UPF are reserved and no multicast data
are transmitted. The configuration may indicate whether or when the multicast
session may be established and whether a multicast session can become
inactive. The AF may provide configuration in several steps, e.g. to first
request TMGIs and then provide full information about the multicast session
and allow it to be established.
\- Multicast Session Establishment: When the join request of the first UE in
the multicast session is accepted, the multicast session is established either
in inactive or active state, depending on configuration. 5GC resources for the
multicast session are being reserved.
\- **Multicast Session Activation** : State transition from inactive to active
multicast session. CM IDLE UEs that joined the multicast session are paged.
Activation can be triggered by AF request or reception of multicast data.
\- **Multicast Session Deactivation** : State transition from active to
inactive multicast session. Deactivation can be triggered by AF request or no
reception of multicast data.
\- **Multicast Session Release** : All resources for the multicast session are
released in both 5GC nodes and RAN nodes, UEs that joined the multicast
session are notified. The release is possible for an active or inactive
multicast session. The release may be combined with the deconfiguration of a
multicast session.
\- **Multicast Session Deconfiguration** : All information about the multicast
session is removed from the 5GC and TMGIs are deallocated.
Figure 8.2.2.2-2: Multicast session states and state transitions
NOTE 6: The multicast session state machine describes the states in 5GC. It
needs to be revisited in the normative phase and decided whether it should be
included in technical specification.
\- For multicast session establishment/join/leave/release:
\- The UE may perform application level join/leave to a multicast session, the
5GC shall support multicast session join/leave operation for a user, e.g based
on AF request.
\- UE shall support multicast session join/leave operation via CP (NAS
signalling for SM procedure)
\- The UE shall indicate leaving an MBS session to 5GC via NAS signalling
regardless of its CM and RRC state..
\- The 5GC shall be able to reject UE joining to a multicast session with
cause value and/or back-off time when the multicast session will not start
soon or has not started.
NOTE 7: Depending on the duration of the back-off timer, the end user\'s
experience may be negatively impacted to due to waiting for the next attempt
at timeout.
\- ROHC for MBS traffic is supported by the NG RAN.
\- MBSF-C and MBSF-U functionality is supported based on A.3.
NOTE 8: Details of MBSF-C and MBSF-U functionality will be defined in
coordination with SA4.
\- The network shall support selection of MB-SMF or SMF at session join.
\- The (MB-)SMF decides whether to accept join requests, which may be based on
input from NEF/MBSF-C if MBSF is used, and stores that the served UE is
participating in a multicast session.
\- The PDU session which is used to send the join is the same as the
associated PDU Session which is for 5GC Individual MBS traffic delivery.
\- The AMF shall select an SMF that supports 5MBS for multicast session join
during PDU session establishment, which is used for sending join (i.e.
handling of join requests for 5MBS and/or fallback to individual delivery).
NOTE 9: Handling of the security for MBS traffic is determined by SA3. SA2
specifications will align with SA3 as needed.
\- For N3 transport of the 5GC Shared MBS traffic delivery method, GTP-U
tunnelling using a transport layer IP multicast method and shared N3 (GTP-U)
Point-to-Point tunnel shall be supported with support for QoS.
\- For N3 transport of the 5GC Shared MBS traffic delivery method, for unicast
transport there shall be 1-1 mapping between MBS Session and GTP-U tunnel
towards a RAN node, and for multicast transport there shall be 1-1 mapping
between MBS Session and the GTP-U tunnel.
\- For N9 transport of the 5GC Shared MBS traffic delivery method, GTP-U
tunnelling using a transport layer IP multicast method and shared N9 (GTP-U)
Point-to-Point tunnel shall be supported.
\- For N9 transport of the 5GC Shared MBS traffic delivery method, for unicast
transport there shall be 1-1 mapping between MBS Session and GTP-U tunnel
towards a UPF, and for multicast transport there shall be 1-1 mapping between
MBS Session and the GTP-U tunnel.
\- The network supports indicating of N6 tunnel information for receiving
traffic of a MBS session to the AF or MBSF(and to MBSF-U).
\- 5GC provides information of MBS sessions/groups (e.g. TMGI) and QoS
requirements of a MBS service to RAN for MBS AN resources handling.
\- For multicast service parameters storage, the UDR shall be able to store
the AF provisioned or preconfigured service parameters per MBS session.
\- The PCF shall be able to provide policy and QoS requirement per MBS session
to the MB-SMF
\- For UE receiving MBS traffic moving from one RAN node to another in CM-
CONNECTED and RRC-CONNECTED state, handover procedure with MBS session context
shall be supported by UE and network.
\- When MBS session is released, the N3 transport of the 5GC shared MBS
delivery method is released and the radio resource associated with the MBS QoS
Flows are released, or the N3/N9 transport of the 5GC Individual MBS traffic
delivery method is released and the radio resource associated with the QoS
Flows are released.
\- MB-UPF is used as the MBS Session anchor for the 5GC shared MBS delivery.
\- Interactions between the MBSF-C and MBSF-U will be defined in coordination
with 3GPP SA4.
\- The 5GC shall be able to trigger NG-RAN nodes to notify session activation
of an MBS session to UEs.
\- SA2 concludes that it is beneficial, e.g. for signalling efficiency, to
support 5GC requesting NG-RAN nodes to notify session activation of an MBS
session to UEs based on MBS session ID.
NOTE 10: Whether NG-RAN node notify session activation to UEs based on MBS
session ID requires confirmation from RAN2 and SA2 normative work will be
pending RAN2 conclusion.
NOTE 11: Whether UEs camping on non-supporting NG-RAN nodes can be notified
using MBS session ID or the 5GC requires to fallback to regular paging for UEs
that have not connected during MBS session activation requires RAN2/RAN3
confirmation and will be determined during normative work.
\- When an MBS session is established upon AF request, it may be immediately
activated (i.e. one AF request combining of session announcement and session
activation). If an application requires to allow UEs to join prior to the
activation of the multicast transmission, the AF may interact with the NEF
separately to announce the multicast service and subsequently to request
start/activation of the multicast service.
\- If a UE joins prior to the activation of the multicast session, the network
indicates to the UE that the session is not yet activated.
\- The MBS Session may be deactivated when the MB-UPF detects no multicast
data for a configurable period or upon AF request. When the MBS Session is
deactivated by 5GC, the MBS Session context is kept in 5GC, but changed to
Inactivate state. MBS QoS Flows are kept in 5GC. UEs that have joined that
multicast session can become IDLE. The N3 tunnel for 5GC Shared MBS delivery
method shall not be released as long as the RAN node serves CM CONNECTED UEs
within the multicast session:
NOTE 12: Whether MBS Session context and N3 tunnel for 5GC shared MBS delivery
method need be kept at the RAN node need be evaluated at the normative phase.
NOTE 13: Whether the MBS QoS flow need be removed from the MBS Session context
is to be decided in normative phase.
\- The MBS Session may be activated when the MB-UPF detects multicast data or
upon AF request. When the MBS Session needs to be activated, the AF/NEF or MB-
UPF sends a message to the MB-SMF. When the MB-SMF performs the MBS session
activation for establishing the transmission resources, the MB-SMF notifies
the session activation to NG-RANs via SMFs/AMFs serving UEs within the
multicast session. UEs are notified by NG-RAN about the session activation.
\- When UE join a inactivate MBS session, the MBS session context is created
at the 5GC and UE NAS-SM.
\- The MBS Session may be de-configured upon AF request. When the MBS Session
is de-configured, the NEF or MBSF sends message to the MB-SMF to release MBS
session and release MBS Session ID.
NOTE 14: The AF interactions (e.g. whether AF requests for
activation/deactivation are needed) require collaboration with SA WG4 and WG6.
8.2.2.3 Broadcast
Broadcast session management follows the conclusions and design for Multicast
session management with the following modifications, additions or
considerations:
\- UE join does not apply. To receive the data of broadcast communication
service, the UE is either preconfigured with needed configuration (e.g. USD)
for the UE to receive MB service, or provisioned with the configuration of
broadcast session on application level (the configuration may for instance be
performed using SIP signaling, or methods described in TS 26.346 [18]). If the
needed configuration is pre-configured, the UE does not need to interact with
network.
\- Interaction between AF and 5GC for MBS session establishment for multicast
and broadcast should be common whenever possible. In particular, the following
shall be common:
\- MBS session activation call flow in the core network between AF/AS,
MBSF-C/U and/or NEF, MB-UPF, MB-SMF, PCF, and any other relevant NFs not
including SMF handling PDU Session.
\- Call flow for MBS session establishment for broadcast is different from
that for multicast in the following aspects:
\- MB-SMF performs AMF selection with assistance from NRF.
\- MB-SMF initiates the Broadcast session establishment request towards the
selected AMF(s) including the service area.
\- AMF determines the NG-RAN nodes to send the Broadcast session establishment
request based on service area.
NOTE: NG-RAN MBS resources activation differences between Broadcast and
Multicast are to be determined with RAN WG2/RAN WG3.
8.2.3 Call flows
The call flow in this clause are for information to better understand the
principles in clause 8.2.2.
Editor\'s note: Call flow in this clause depends on the discussion in
S2-2008609 for KI#1 Conclusion of MBS Session Management. and need to be
aligned with clause 8.2.2.
Figure 8.2.3-1: PDU Session modification for multicast
1\. The content provider may send a request to register and reserve resources
for a multicast group to the NEF and communicate the related multicast address
as detailed in Figure 8.2.3-2.
The content provider may invoke the services provided by the NEF to provision
the multicast information. The multicast information is used to identify (e.g.
IP Address of multicast data) and reserve resources for the multicast. The NEF
selects MB-SMF controlling an MB-UPF serving as ingress point for the
multicast data and creates a multicast context and stores related information
including the SMF ID in the UDR. The MB-SMF may request the MB-UPF to allocate
an IP address and Port for ingress multicast traffic, which is then provided
to the content provider via NEF.
NOTE 1: The request to reserve resources for the corresponding multicast
session is optional and can be replaced by configured data based on commercial
agreements. If IP multicast is used in the external network, the content
provider does not require information where to send the multicast data.
NOTE 2: SMF and MB-SMF can be identical.
2\. The UE registers in the PLMN (see clause 4.2.2.2 of TS 23.502 [8]) and
request the establishment of a PDU session (see clause 4.3.2.2 of TS 23.502
[8]). The UE also indicates its capability to receive multicast data over the
radio. The AMF obtains information from the UDM whether the UE can join
multicast sessions as part of the SMF Selection Subscription data. If so, for
direct discovery, the AMF selects an SMF capable of handling multicast
sessions based on locally configured data or a corresponding SMF capability
stored in the NRF and also indicates the UE\'s capability to receive multicast
data over the radio to the SMF.
3\. The content provider announces the availability of multicast using higher
layers (e.g. application layer). The announcement includes at least the
multicast address of a multicast group that UE can join.
4\. To join the multicast group, the UE sends the PDU Session
Establishment/Modification Request either upon a request from higher layers or
upon a detection by lower layers of UE joining a multicast group (i.e.
detection of IGMP or MLR and detection of the change of content of these
messages). The PDU Session Modification Request shall include information
about multicast group, which UE wants to join, such as multicast addresses
listed in the IGMP and MLR messages. This information is needed for
configuration of the UPF with appropriate packet filters.
5\. The AMF invokes Nsmf_PDUSession_UpdateSMContext (SM Context ID, N1 SM
container (PDU Session Modification Request with the multicast information)).
6\. The SMF may check whether the UE is authorized to join the multicast
session. The SMF may interact with PCF, UDR or NEF for that purpose. See
Figure 8.2.3-3
7\. If SMF has no information about the multicast context for the indicated
multicast group, SMF checks at the UDR whether a multicast context for the
multicast group (address) exists in the system. If the multicast context for
the multicast group does not exist and information about multicast group in
the join request contains a source specific multicast address, then depending
on operator policy the SMF may create it when the first UE joins the multicast
group, store the multicast context including itself as multicast controlling
SMF in the NRF, and configure the UPF to handle the multicast data
distribution (SMF and MB-SMF, and UPF and MB-UPF in this flow are then
identical). If it is the first UE joining the multicast group, the MB-UPF may
also have to join the multicast tree towards the content provider; the MB-SMF
should request the MB-UPF to join the multicast tree when configuring the MB-
UPF, see e.g. Step 15 and 26. If a multicast context already exists in the
NRF, the SMF retrieves the related information, including information related
to MB-SMF controlling the multicast ingress point.
NOTE: If RFC 8777 [24] is used towards the content provider and the UE request
to join an unknown source specific multicast address, the SMF can check
whether the UE requests a valid source specific multicast address: RFC 8777
[24] uses a trusted DNS server and a secure connection. The SMF can validate
using that DNS server whether the SSM address is valid, and thus check whether
the UE joins a valid SSM and protect against DoS attack as well as unexpected
radio resource usage
8-9.: If SMF has no information about the multicast context for the indicated
multicast group, SMF interacts with MB SMF to retrieve QoS information of the
multicast QoS flow(s).
10\. SMF requests the AMF to transfer a message to the RAN node using the
Namf_N1N2MessageTransfer service (N2 SM information (PDU Session ID, Multicast
Context ID, MB-SMF ID, multicast QoS flow information), N1 SM container (PDU
Session Modification Command (PDU Session ID, multicast information (Multicast
Context ID, multicast QoS flow information, multicast address)) to:
\- create a multicast context in the RAN, if it does not exist already; and
\- inform about the relation between the multicast context and the UE\'s PDU
session.
Based on operator policy, if the SMF is configured to prepare for unicast
fall-back, the SMF maps the received QoS information of the multicast QoS flow
into unicast QoS flow information of the PDU Session, and includes the
information of the unicast QoS flows and the information about the association
between those unicast QoS flows and the multicast QoS flows in the N2 SM
information. If dedicated unicast QoS flows are required, the information
includes the one about those dedicated unicast QoS flows. SMF also includes
information about those unicast QoS flows in the N1 SM container.
Editor\'s note: Providing associated unicast QoS flows at this stage needs to
be confirmed.
11\. The N2 session modification request is sent to the RAN. The request is
sent in the UE context using the PDU Session Resource Modify Request message
enhanced with multicast related information, which includes a multicast group
identity (e.g. multicast address), Multicast Session context ID, and multicast
flow information such as multicast QoS Flow ID and associating QoS
information. The RAN uses the multicast group identity to determine that the
session modification procedures corresponds to one multicast group. In other
words, the RAN learns what UEs are receiving the same multicast data from the
multicast group identity. When the RAN receives a session modification request
for previously unknown multicast group identity, the RAN configures resources
to serve this multicast group.
12\. The N1 SM container (PDU Session Modification Command) is provided to the
UE.
13\. The RAN performs the necessary access network resource modification such
as configuration of PTP or PTM bearers. RAN node checks whether the user plane
for the multicast group/context distribution is already established towards
the RAN node. If RAN supports MBS, RAN configures the UE for receiving the
multicast data via multicast session.
NOTE 3: The details of access network resource modification should be studied
in the RAN WGs.
14\. RAN nodes selects the AMF to reach MB-SMF and signals a request towards
AMF [MB-SMF ID, Multicast context/group ID]. If the RAN node is configured to
use a unicast transport for multicast distribution sessions, it allocates a
downlink tunnel ID (an IP address and a GTP-U TEID) for the reception of the
multicast distribution session and indicates the downlink tunnel information
in the request.
15\. AMF forwards the request towards the MB-SMF
16\. For unicast transport of the multicast distribution session, MB-SMF
configures MB-UPF to transmit the multicast distribution session towards RAN
(using the received IP address and a GTP-U TEID).
17\. MB-SMF sends a multicast distribution session response to AMF. For
multicast transport of the multicast distribution, it indicates in the
downlink tunnel information the transport multicast address for the multicast
session.
18\. AMF forwards multicast distribution session response to RAN node.
19\. The RAN sends the session modification response, which does not include
the unicast tunnel information.
20\. The AMF transfers the session modification response received in step 18
to the SMF. The SMF determines that the shared tunnel is used for multicast
packet transferring and the interaction with UPF is not needed.
21\. MB-UPF receives multicast PDUs, either directly from the content provider
or via the MBSF-U that can manipulate the data.
22\. MB-UPF sends multicast PDUs in the N3/N9 tunnel associated to the
multicast distribution session to the RAN. There is only one tunnel per
multicast distribution session and RAN node, i.e. all associated PDU sessions
share this tunnel.
23\. The RAN selects PTM or PTP radio bearers to deliver the multicast PDUs to
UEs that joined the multicast group.
24\. The RAN performs the transmission using the selected bearer.
Configuration of a multicast group in the 5GC can occur:
\- when the first UE joins the multicast group;
\- based on static configuration;
\- Triggered by an AF request via the NEF.
At service layer, the MSF can manage an MBS service, and apply related NEF
procedures to configure a multicast group.
Figure 8.2.3-2: Initial Multicast group configuration via NEF
1\. AF of content provider may register at NEF that it provides contents for a
multicast. The AF may provide a source specific multicast address or it may
request that the network allocates a an identifier for the multicast group
(TMGI or source specific multicast address). Multicast information may further
include media type information (e.g. audio, video...), QoS requirements, UE
authorization information (e.g. a GPSI or an External Group Id or a UE ID to
identify UEs authorized to join the multicast service), service area
identifying the service scope, and start and end time of MBS. The AF may also
request the allocation of an ingress transport address where to send tunnelled
multicast data.
Editor\'s note: If an application desires to allow UEs to join prior to the
start of the multicast transmission, the AF may interact with the NEF
separately to announce the multicast service and to request activation of the
multicast service. A related call flow should be added.
2\. NEF/MBSF-C checks authorization of content provider. NEF/MBSF-C selects
MB-SMF as ingress control node, possibly based on location area.
Editor\'s note: The 5GC network entity for TMGI allocation needs to be
clarified.
3,4. NEF/MBSF-C requests storage of multicast session context at UDR and
provides multicast group ID and selected MB-SMF ID.
5\. NEF/MBSF-C requests MB-SMF to reserve ingress resources for a multicast
distribution session and provides Multicast group ID. It also indicates if the
allocation of an ingress transport address is requested.
6\. The MB-SMF sends SM MBS Policy Association Request to MB-PCF with the
Multicast group ID, AF Identifier, and the QoS requirements.
7\. The MB-PCF registers at the BSF that it handles the multicast session. It
provides an identifier that the policy association is for multicast and the
multicast group ID, it own PCF ID and optionally its PCF set ID.
8\. The MB-PCF may query the UDR for policy input related to the multicast
session.
9\. The MB-PCF responds with SM MBS Policy Association Response with policies
for the Multicast group ID.
In addition, determines whether the request is authorized and notifies the NEF
if the request is not authorized.
If the request is authorized, the PCF derives the required QoS parameters
based on the information provided by the NEF and determines whether this QoS
is allowed (according to the PCF configuration for this AF), and notifies the
result to the MB-SMF. The PCF notifies the MB-SMF whether the transmission
resources corresponding to the QoS request are established or not.
If the request is not authorized, the required QoS is not allowed, or
transmission resources are not established, MB-SMF responds to the NEF in step
12 with a Result value indicating the failure cause, and NEF further notifies
AF in step 13.
10\. MB-SMF selects the MB-UPF and requests it to reserve user plane ingress
resources. If multicast transport of the multicast data towards RAN nodes is
to be used, the MB-SMF also request the MB-UPF to reserve for the outgoing
data a tunnel endpoint and the related identifiers (source IP address, source
specific multicast address and GTP Tunnel ID) and to forward data received at
the user plane ingress resource using that tunnel endpoint.
11\. If requested, MB-UPF selects an ingress address (IP address and port) and
a tunnel endpoint for the outgoing data and provides it to MB-SMF
12\. MB-SMF indicates the possibly allocated ingress address to the
NEF/MBSF-C. It also indicates the success or failure of reserving transmission
resources.
13\. The NEF/MBSF-C indicates the possibly allocated ingress address to the
AF.
Figure 8.2.3-3: UE authorization check
1\. Steps 1 to 4 in Figure 8.2.3-2 apply. In step 1 the AF may provide UE
authorization information (e.g. a GPSI or an External Group Id or a UE ID to
identify UEs authorized to join the multicast service).
2\. If the AF provided authorization information, the NEF maps the UE
authorization information (e.g. a GPSI or an External Group Id or a UE ID to
identify UEs authorized to join the multicast service) into SUPIs or internal
group IDs and stores information about UEs allowed to join the multicast group
in the UDR. This may be combined with step 3 in Figure 8.2.3-2 if the
multicast session context is used to store the information.
NOTE 1: Details of the UDR storage format will be determined during the
normative work.
NOTE 2: Steps 1 and 2 can be omitted if UE authorization information for
multicast sessions is configured in the UDR.
3\. A UE requests to join a multicast group. Steps 4 and 5 in Figure 8.2.3-1
are executed.
4\. The SMF queries at the UDR whether the UE is authorized to join the
multicast session.
NOTE 3: If policy control for the UE joining authorization is required, the
PCF subscribes to notifications when a UE joins a multicast group and the SMF
sends a SM Policy Association Modification to PCF after step 3\. Steps 4 is
then executed by the PCF. The PCF then indicates in the SM Policy Association
Modification Response to the SMF whether the UE is authorized to join the
multicast session.
Editor\'s note: Possible AF interactions to authorize the join request are ffs
and depend on key issue 3 conclusions.
## 8.3 Key Issue #5: Support of Broadcast TV Video and Radio communication
services
This key issue is not addressed in Release 17.
## 8.4 Key Issue #8: Reliable switching between unicast and broadcast delivery
methods
This key issue is not addressed in Release 17.
## 8.5 Key Issue #4: QoS level support for Multicast and Broadcast
communication services
The following principles are applied for normative work for multicast and
broadcast communication services:
\- The network shall support QoS control per MBS session instead of per user.
\- The network shall support one or multiple QoS flow for an MBS session.
\- The network may use dedicated QoS flows for multicast sessions in a PDU
session if 5GC individually delivery is used to deliver the 5MBS data packet.
\- The 5G QoS model and parameters as defined in TS 23.501 [2] clause 5.7 also
apply to MBS service with the following differences:
\- Reflective QoS is not applicable;
\- Wireline access network specific 5G QoS parameters do not apply to MBS
services;
\- Alternative QoS Profile is not applicable;
\- QoS Notification Control is not applicable;
\- UE AMBR is not applicable;
\- Session-AMBR if provided is enforced at MB-UPF but not communicated to NG-
RAN.
Editor\'s note: Whether Session-AMBR is required in addition to the MBS
service data flow bit rate can be determined by operator policy and/agreement
with the service provider.
\- For the broadcast service, the QoS rule and associated QoS Flow level QoS
parameters are not provided to UE.
\- There is support for both GBR and non-GBR MBS flows.
\- Depending on the architecture configuration option used as per annex A.3,
the AF may provide the media description e.g. using SDP information that
includes IP filter information, Media/application bandwidth requirements,
codec info, support for FEC or not etc. to the NEF (using N33 in configuration
1 or 2) or MBSF (using xMB in configuration 3). The AF may alternatively
provide information required to setup an MBS session with required QoS
requirements to the NEF (using N33) only for the case of the architecture
option with configuration 1.
\- The MB-SMF obtains QoS information and configures the MB-UPF accordingly.
\- If dynamic PCC is used, the MB-SMF obtains QoS information for MBS session
in policy rules provided by the PCF, for MBS session QoS determination. The
QoS information includes QoS parameters for 5GC Shared MBS traffic delivery
method.
\- The MB-SMF may obtain MBS QoS information from the AF via the NEF/MBSF and
PCF.
\- Interactions between MB-SMF and SMF and signalling of QoS profile to NG-RAN
have dependencies with other Key Issues e.g. key issue #1 and the overall
architecture and will be determined based on conclusions for Key Issue #1 and
the overall architecture.
## 8.6 Key Issue #6: Local MBS service
The following agreements to support local MBS services apply as baseline for
normative work:
\- It shall be possible to support MBS session where the content is not
location-dependent, but the distribution is limited to a certain area, and MBS
sessions where the content is location-dependent.
\- It shall be possible to locate MBS CN functions in proximity to NG RAN
nodes serving the location area.
\- For the case that the multicast service is only available within a limited
area, the UE shall be able to obtain service area information of the multicast
service, to enable the UE to trigger the session join procedure only within
the location area.
\- The UE shall be able to obtain service area information of the local
multicast service via NAS signalling or via MBS service announcement.
\- For providing service area information of the local multicast service (i.e.
Cell ID list or TAI list) to the UE via NAS signalling, it shall be possible
to support the following operation.
\- Local multicast service area provided in a Join Reject message (e.g. PDU
Session Modification Reject) together with the reject reason (outside of local
service area).
\- For the case that the MB service content is location-dependent (The content
of the same MB service delivered to different sub-areas is different), it
shall be possible that the UE is not aware of each sub-area in the available
area information of the MB service.
\- It shall be possible to hide the internal PLMN topology from AF (e.g. AF is
not aware of cell or TA information).
\- The network shall be able to enforce the area restriction for accessing a
local MBS service.
\- If different location-dependent content is provided for an MBS session, the
network shall be able to support multiple MB-UPFs as ingress points for an MBS
session.
NOTE 1: The solution for different location-dependent content can also be
applied in a scenario where the same content is provided in distributed
islands of the network to enable distinct local distribution trees with local
ingress points.
\- To support different location-dependent content, an additional Area Session
Identifier shall be assigned for each location area and used in combination
with the multicast session ID in network internal signalling to identify a
location dependent part of the multicast session.
\- Information about the location dependent multicast service may be provided
by an AF, or may be configured.
NOTE 2: Alignment based on progress/decision in RAN WGs will be performed as
part of the normative phase.
\- For location dependent MB service, the MB-SMF allocates the Area Session
identifier. The Area Session identifiers allocated by different MB-SMFs shall
not overlap for a multicast session.
## 8.7 Key Issue #7: Reliable delivery method switching between unicast and
multicast
For delivery method switching due to mobility, the following principle are
agreed,
\- When the UE moves from a NG-RAN node that supports 5MBS to a RAN node that
does not support 5MBS, the network and UE shall support switch from 5GC Shared
MBS traffic delivery method to 5GC Individual MBS traffic delivery method.
\- When the UE moves from a RAN node that does not support 5MBS to a NG-RAN
node that supports 5MBS, the network and UE shall support switch from 5GC
Individual MBS traffic delivery method to 5GC Shared MBS traffic delivery
method.
\- When the UE joins an MBS session and handover to NG-RAN nodes not
supporting 5MBS is required, mapping information about unicast QoS flows and
the associated multicast QoS flows are provided to the NG-RAN node, which
enables data reception of the MBS session via 5GC Individual MBS traffic
delivery mode.
\- To support handover to an NG-RAN node not supporting 5MBS, the N3 tunnel of
the PDU Session, which is used for 5GC Individual MBS traffic delivery, need
to be activated.
\- During the handover from RAN not supporting 5MBS to NG-RAN supporting 5MBS,
PDU sessions, including the one associated with the MBS session and used for
5GC Individual MBS traffic delivery, are handed over to target RAN. After the
handover, 5GC terminates the 5GC Individual MBS traffic delivery method.
\- During the mobility from NG-RAN supporting 5MBS to NG-RAN not supporting
5MBS, the 5GC triggers the switching from 5GC Shared MBS traffic delivery
method to 5GC Individual MBS traffic delivery method. The SMF realizes that
the target NG-RAN node does not support 5GC Shared MBS traffic delivery
method.
\- During the inter supporting 5MBS NG-RAN node handover or the handover from
source NG-RAN supporting 5MBS to the target NG-RAN not supporting 5MBS,
minimization of data loss should be supported, details for RAN WGs to decide.
\- It is commonly understood that if service requirements result in applying
\'lossless handover\' (see TS 38.300 [10]), UEs receiving MBS traffic of that
MBS session need to be in CM-CONNECTED with RRC-CONNECTED state.
For delivery method switching not due to mobility, the following principle are
agreed,
\- Switching between PTP and PTM delivery methods for 5GC Shared MBS traffic
delivery shall be supported. NG-RAN is the decision point for of switching the
PTP and PTM delivery methods.
\- If the NG-RAN node supports 5MBS, the network shall use the 5GC Shared MBS
traffic delivery method for MBS Session packet transfer.
Switching between multicast delivery and unicast delivery using individual UE
and application server addresses is not specified in normative work.
## 8.8 Key Issue #2: Definition of Service Levels
Solution #1 is selected as basis for normative work, with the following
implications:
\- In 5G MBS, the concepts of basic service (or function) level and enhanced
service (or function) level as described in Solution #1 will be introduced.
\- On the support of 5GC Shared MBS traffic delivery method and 5GC Individual
MBS traffic delivery method, the assumption as described in Solution #1 will
be used during normative work.
NOTE: Content security protection is not supported.
8.9 Key Issue #3: Levels of authorization for Multicast communication services
The following functionality is agreed to be standardized:
\- 5GC Authorization of UE joining 5MBS multicast sessions on 5MBS feature
level.
\- 5GC Authorization of UE joining a specific multicast MBS Service.
\- For a multicast MBS Service, the AF can provide information about UEs or
groups of UEs entitled to join.
Editor\'s notes: Whether 5GC support of authorization for UE joining a
specific multicast MBS Service by application server is needed can be
determined in normative phase.
NOTE: MBS service level authorization could be performed at application layer.
MBS service level authorization can also be implicitly performed when UE is
configured for a specific MB service, e.g. via Service Announcement for public
safety use case, which is out of SA2 scope.
## 8.10 Key Issue #9: Minimizing the interruption of public safety services
upon transition between NR/5GC and E-UTRAN/EPC
For 5MBS multicast, in order to minimize the interruption of public safety
services upon transition between NR/5GC and E-UTRAN/EPC the following applies:
For a 5MBS multicast session two scenarios are considered:
\- the same service is provided via eMBMS and 5MBS. For this scenario Solution
43, which is a service based solution not needing the execution of an
intermediate unicast handover, is adopted as baseline for the normative phase.
This solution can be based on RRC release with redirection to redirect the UE
towards the appropriate cells/frequency range.
NOTE 1: If the UE has other DRBs/QoS flows established before switching to
EPS, the source RAN can also initiate handover.
NOTE 2: Solution 43 applies also to the 5MBS broadcast case.
\- the same service is not provided via eMBMS and 5MBS. In this case, for the
normative phase the following steps are adopted for 5MBS to EPS mobility:
\- the 5MBS data shared delivery is switched to individual delivery during
inter-system handover.
\- the 5GS-EPS interworking solution of TS 23.501 [2] clause 5.17.2 is
executed with an inter-system handover with MBS QoS flow(s) mapped to unicast
QoS flow(s) in its associated PDU Session.
\- After the inter-system handover has occurred, regular EPS procedures apply
as the same service is not provided via eMBMS.
NOTE: If some further update is needed, it can be done in the normative phase.
\- The PGW-C+SMF obtains the MBS session context when UE joins 5G MBS.
\- After a possible subsequent EPS to 5MBS mobility, the PGW-C+SMF can again
apply shared delivery to the UE.
For an eMBMS session started in EPS and subsequent EPS to 5MBS mobility, the
following steps are adopted for the normative phase:
\- Before EPS to 5MBS mobility, the application may trigger the switching the
multicast data receiving from eMBMS to unicast bearer as defined in TS 23.468
[5].
\- the 5GS-EPS interworking solution of TS 23.501 [2] clause 5.17.2 is
executed with an inter-system handover.
\- the UE can join the 5MBS multicast service after EPS to 5MBS mobility.
###### ### Annex A: Architecture alternatives
# A.1 Baseline architecture 1: 5G MBS system architecture based on unicast 5GC
## A.1.1 Transport aspects
It is assumed that the 5G MBS system architecture reuses as much as possible
the system architecture and procedures of current 5GS unicast system
architecture for Multicast Transport.
Figure A.1-1 shows the 5G system architecture for integrated Multicast
transport with unicast. The solution relies on enhancing the existing 5GS
network functions, NG-RAN and UE currently only supporting unicast transport,
to support Multicast transport.
Figure A.1.1-1: 5GS enhancement for Multicast support
The following new functionality is added to the current AF, 5GC NFs, NG-RAN
and UE:
\- AF:
\- Support MBS service functions, negotiation with NEF for service exposure.
\- NEF:
\- 5G MBS service exposure.
\- Negotiation of 5G MBS service with AF, including QoS, 5G MBS service area.
\- PCF:
\- Support policies for Multicast services, including QoS parameters like 5QI,
MBR, GBR.
\- Provide policy information regarding the MBS session to SMF.
\- Receive MBS service information from AF, directly (operator owned) or
indirectly via NEF.
NOTE 1: It is possible to establish multicast transport without interaction
with NEF.
\- SMF:
\- Control of MBS transport, based on received MBS policies from PCF.
\- Configuration of the UPF for MBS flows and for point to point or point-to-
multipoint transfer.
\- Configuration of the RAN for MBS flows and QoS information.
\- SM configuration at the UE for MBS flows.
\- An SMF may be used for both unicast and MBS.
\- UPF:
\- Support of packet filtering of MBS flows, and delivery of MBS flows to RAN
via point to point or point-to-multipoint N3.
\- Receive 5G MBS flow configuration from SMF.
\- Detection of IGMP packets and notification to SMF. (If UE joining is
performed via IGMP).
\- A UPF may receive both unicast and MBS flows.
\- I-UPF(s) may be used for the delivery of MBS flows from the UPF attached to
N6 to NG-RAN; the N9 interface can be used for MBS traffic delivery.
NOTE 2: I-UPF may be used for individual delivery, but not for shared
delivery.
\- NG-RAN:
\- Reception of MBS flows via N3 and delivery over-the-air.
\- Switch between multicast and unicast delivery of MBS flows.
\- UEs configuration for MBS flow reception at AS layer. (TBD how UE AS layer
configuration of 5G MBS works)
\- UE:
\- Support of UE policy configuration extension to MBS.
\- Support of SM extension for MBS flows.
\- Signalling for joining MBS flow (via SM signalling or user plane IGMP
Join).
\- MBS support at AS layer.
## A.1.2 Service Layer aspects
Orthogonal to the description of the multicast flow user plane model described
in clause A.1.1 a service layer can be supported on top.
The service layer is fully separate from the Multicast transport. This allows
for applications that do not require a service layer to establish a multicast
transport directly via Nnef (control plane and N6 (user plane data)
Figure A.1.2-1 shows an example for service layer support of
multicast/broadcast using xMB/MB2 as entry point. A new Network Function,
called Multicast Service Function (MSF) is introduced. The MSF provides only
Service layer functionality and requests the 5G system (via Npcf or Nnef) for
the underlying Multicast transport necessary for the Multicast service. The
MSF has the following functionality:
\- Entry point for both control plane service layer signalling and user plane
data, e.g. xMB/MB2. Interaction can happen directly with external AF or via
NEF.
\- MSF Control Plane (MSF-C):
\- Multicast service configuration.
\- MBS service level management.
\- xMB-C/MB2-C termination.
\- Codec configuration (if needed).
\- MSF User Plane (MSF-U):
\- xMB-U/MB2-U termination.
\- Encoding of data at service layer.
\- Multicast service layer data packets delivery via N6.
Editor\'s note: the need for any other service layer functionality is FFS.
Figure A.1.2-1: 5G MBS system architecture with Multicast Service Function
NOTE: An Application may not need any specific service layer functionality, in
which case the Application may use directly Nnef for Multicast session
configuration/negotiation and N6 for multicast data delivery, as depicted in
Figure A.1.2-2.
Figure A.1.2-2: MBS system with direct Application Server/Function interaction
# A.2 Baseline architecture 2: 5G MBS system architecture based on dedicated
MBS Function
## A.2.1 General
To support multicast/broadcast MBS user service delivery in 5GS, new
functional components and necessary enhancement to the existing entities are
described in this clause.
In addition, an AF engaged in MBS can also use 5GS unicast resources (i.e. PDU
Sessions) to deliver MBS media to UEs.
## A.2.2 Reference Architecture
NOTE 1: MB-SMF, MB-UPF, MBSF and MBSU are functional components, which can be
standalone or co-locate with existing Network function. If the MBSU is
deployed, the MBSU is aware of the content stream and is capable of
transforming the content stream required by the service requirement.
To support MBS in 5GS user service delivery, two variants modes of operation
exist: one for Transport Only Mode, and the other for Full Service Mode as
defined in TS 23.246 [4] clause 7.5.
\- For the Transport Only Mode, the MBS application data are transparent to
network function in figure A.2.2-1.
\- For the Full Service Mode, the MBSF/MBSU is aware of the content stream and
is capable of transforming the content stream into 3GPP compliant stream.
Editor\'s note: These two services modes need to be mapped to 5GS MBS context.
Figure A.2.2-1 illustrates single architecture for MBS in 5GS.
Figure A.2.2-1: 5GS Architecture supporting MBS
In this figure A.2.2-1 above, the SMF and UPF which have the roles to support
MB Sessions are named \"MB-SMF\" and \"MB-UPF\". Nothing prevents the MB-SMF
and MB-UPF to simultaneously support both PDU Sessions and MB Sessions, e.g.
PDU Sessions and MB Sessions to the same DNN. However, MB-SMF and MB-UPF can
also be deployed and configured to exclusively handle MB Sessions. It is
believed it may reduce signalling and in some cases be simpler and more cost
efficient to operate a limited number of MB-SMFs and MB-UPFs dedicated to MBS.
This architecture makes that possible if preferred.
Enhancement to existing entities and new functional components are as follows:
\- UE, NG-RAN, AMF, SMF, UPF, NEF and PCF are enhanced to support MBS.
\- UE is enhanced to support 5G MBS services.
\- NG-RAN is enhanced to support Point-to-Multipoint (PTM) and Point-to-Point
(PTP) delivery of MBS media. NG-RAN independently controls switching between
PTM and PTP for best service quality and resource efficiency.
\- AMF is enhanced to select MB-SMF and be part of the signalling distribution
tree.
\- MB-SMF is an SMF enhanced to control MB Sessions, signalling with AF (via
NEF/MBSF), QoS control using PCF, and provision of MB Session information on
request from AMF. The PDU session(s) the UE(s) maintain for individual
delivery of an MBS service may be associated with the MB Session managed by
the MB-SMF.
\- MB-UPF is a UPF enhanced with an MBS user plane function.
\- MBSF (Multicast/Broadcast Service Function) is a function which may be part
of NEF or be deployed independently. The MBSF may support TMGI allocation or
other MBS signalling for the service level management. The MBSF also provides
an interface to the Application Function or content provider and it has an
interface to the MBSU. MBSF may perform authorization of the UE to join the MB
session.
NOTE 2: It will be determined in the normative phase whether an MBSF sub-
function needs to be introduced for MBS related NEF enhancements, or such
enhancements can be directly described as NEF functions.
\- MBSU (Multicast/Broadcast Service User plane) is a new entity to handle the
payload part to cater for the service level functions and management.
\- NEF is an existing NF, which provides interface to the AF.
\- PCF is enhanced to handle QoS for MB Sessions, e.g. to authorize the QoS
profiles for shared delivery.
Enhancement to existing interfaces and new interfaces are as follows:
\- Uu interface enhancements will be studied and decided by RAN.
NOTE 3: Uu, N2 and N3 interface enhancements are subject to RAN evaluation and
decision.
\- N2 interface is enhanced to control MB Sessions including management of the
shared N3 tunnel between MBâ€‘UPF and NG-RAN(s).
\- N3 interface is enhanced to support shared N3 tunnel between MB-UPF and NG-
RAN.
\- N4 interface is enhanced with management of the shared N3 tunnel between
MB-UPF and NG-RAN(s) including establishment of the shared N3 tunnel.
\- N6 interface enhancement is solution dependent.
\- N7 and N30 interfaces are enhanced for policy control of MB Sessions.
\- N11 interface is enhanced with MBS control signalling including management
of the shared N3 tunnel between MB-UPF and NG-RAN(s).
\- N29 interface is enhanced with MBS control signalling.
\- N33 interface is enhanced with MBS control signalling.
\- Ny: new interface between the MBSF and MBSU to manage the MBSU functions.
The Ny interface in detail is elaborated by SA WG4.
\- NxMB-U new interface between the new MBSU and AF for MBS user plane
traffic.
# A.3 Adopted Baseline architecture: converged options
## A.3.1 General
This architecture provides all adopted options for the Architecture Baseline,
based in part on Architecture 1 (clause A.1) and Architecture 2 (clause A.2).
The reference architecture and functionalities do not prevent Solutions based
on Architecture 1 or Architecture 2. Those solutions should still be
considered on its own merits under the understanding that some slight
modifications to fit this reference model would be required.
## A.3.2 Reference Architecture
To support MBS in 5GS user service delivery, two variants modes of operation
exist: one for Transport Only Mode, and the other for Service Mode equivalent
to the definitions in TS 23.246 [4] clause 7.5.
This reference architecture model applies to both 5G Multicast and 5G
Broadcast services. Functionality may be different for these service types.
Figure A.3.2-1 provides the reference architecture with all configuration
variants.
NOTE 1: Whether some of the NFs in the figure are needed, it is dependent on
solution, and captured in clause 8.
NOTE 2: Regarding the interface between AF and MBSF, it\'s to be determined
with SA4 and/or SA6 if new gMB interface (which is an evolution of xMB/MB2) is
needed for AF adapted to 5G architecture.
NOTE 3: Whether MBSTF is involved in transport only mode service will be
determined with SA WG4 coordination.
Figure A.3.2-1: Reference Architecture
The Reference Architecture Network Functions at Transport consist of the
following:
\- Multicast Broadcast SMF -- MB-SMF.
\- Multicast Broadcast UPF -- MB-UPF.
\- Enhanced network functions e.g. SMF, AMF, PCF, etc.
The Reference Architecture provides the following Network Functions at Service
Layer and exposure to Application Function:
\- Multicast Broadcast Service Function -- MBSF.
\- Multicast Broadcast Service Transport Function -- MBSTF.
\- Network Exposure Function.
NOTE 4: This Annex captures high level functionality of each Network Function.
The detailed functionality of each network function is captured in clause 8.
NOTE 5: MB-SMF, MB-UPF, MBSF and MBSTF are functional components, which can be
standalone or co-locate with existing Network function. If the MBSTF is
deployed, the MBSTF is aware of the content stream and is capable of
transforming the content stream required by the service requirement.
NOTE 6: Different solutions may use different nomenclature for the Service
Functionality MBSF/MBSTF, e.g. both MBSF and MBSTF or MBSTF and the MB-UPF and
MB-SMF.
NOTE 7: Roaming architecture is not included in this Reference Architecture.
Roaming is dependent on clause 8.
Figure A.3.2-2 provides the reference architecture with all configuration
variants for Application Function interaction with 5G Core Network, usage of
NEF or MBSF in the control plane, and usage of N6, MB2-C or xMB-U in user
plane.
Figure A.3.2-2: Configuration options at Service and/or Application
The following characteristics describe each of the Configuration options:
\- Configuration Option 1: No MBSF:
\- This configuration may be used for Transport Only Mode, when the Multicast
service or Broadcast service does not require service layer interworking with
LTE MBMS.
\- The control plane entry point from the Application Function outside the
trust domain to request establishment of an MBS session is the NEF via N33.
\- An application function within the trust domain can directly use the Npcf
and Nmbsmf service based interfaces. In this case some NEF functionality
related to PCF and MB-SMF interaction is incorporated in AF.
NOTE 8: Application function within the trusted domain selects MB-SMF based on
e.g. its local configuration, or query NRF based on location, etc.
\- The user plane entry point for the Application Function is the MB-UPF via
N6.
\- Configuration Option 2: MBSF, N33 or /Nmbsf towards AF:
\- This configuration may be used for Service Mode, or when interworking with
LTE MBMS is required.
\- The control plane entry point from the Application Function to request
establishment of an MBS session is the NEF via N33 or the MBSF via Nmbsf.
\- The user plane entry point for the Application Function is the MBSTF via
MB2-U or xMB-U.
\- The NEF and MBSF may be collocated.
\- If the MBSF is not collocated with the NEF, the reference point between the
NEF and MBSF is Nmbsf or MB2-C or xMB-C.
\- An application function within the trusted domain may be collocated with
MBSF.
\- Configuration Option 3: MBSF, MB2-C/xMB-C towards AF:
\- This configuration may be used for Service Mode (xMB-C only), or when
interworking with LTE MBMS is required (MB2-C or xMB-C).
\- The control plane entry point from the Application Function to request
establishment of an MBS session is the MBSF via MB2-C or xMB-C.
\- The user plane entry point for the Application Function is the MBSTF via
MB2-U or xMB-U.
For service mode, MBSF shall be used, i.e. either Configuration 2 or
Configuration 3 shall be used.
For Transport Only mode:
\- If interworking with LTE MBMS is required for the service, MBSF and MBSTF
shall be used, i.e. either Configuration 2 or Configuration 3 shall be used.
\- If interworking with LTE MBMS is not required for the service, MBSF and
MBSTF are optional.
MBSTF shall be used when MBSF is used.
Any particular deployment may support any combination of these configurations.
The transport procedures, i.e. the procedures in Npcf, Nmbsmf, N2, N3, N4, N7,
N11, N15 are common with or without MBSF, with potential differences in the
information in the message.
## A.3.3 Functional entities
NOTE 1: The enhancements of network functions covers commonalities of this
converged architecture, and can be refined based on the selected solution.
NOTE 2: The Broadcast architecture does not include UE-specific NFs (i.e. SMF,
UPF), and the UE-specific functionalities of the NFs (e.g. PTP/PTM
determination) do not apply to broadcast. Functionalities needed for broadcast
are captured in clause 8.
### A.3.3.1 PCF
The PCF is used to provide policy rules for MB services, and receive MB
service information from AF, directly or indirectly. The PCF performs the
following functions to support MBS:
\- Support QoS handling for MBS Session, including QoS parameters like 5QI,
MBR, GBR
\- Provide policy information regarding the MBS session to MB-SMF for
authorizing the related QoS profiles.
\- Receive MB service information/QoS requirement.
NOTE: How the PCF provides policy for MB services to SMF is concluded in
clause 8.
### A.3.3.2 MB-SMF
The MB-SMF is used for MBS session management (including QoS control), and
control of MBS transport, including configuring the MB-UPF and RAN (via AMF)
for MBS flows transport based on the policy rules for MBS services from PCF or
local policy.
### A.3.3.3 MB-UPF
The MB-UPF is used for delivery of MBS flows to RAN (or UPF for individual
delivery) and QoS enforcement for MBS services. The MB-UPF performs the
following functions to support MBS:
\- Packet filtering of incoming downlink packets for MBS flows.
\- Distribution of MBS data packets to RAN nodes (or UPF nodes).
\- QoS enforcement (MFBR) and counting/reporting based on existing means.
NOTE: It is to be determined in normative work if there is a need for
additional enhancements to N6 terminating at MB-UPF for MBS. For example,
there might be a need for some special security if the MB-UPF is interacting
with an AS outside the trust domain.
### A.3.3.4 AMF
The AMF performs the following functions to support MBS:
\- Selection of SMFs that have MBS capabilities for multicast.
\- Signalling with SMF, NG-RAN and MB-SMF for MBS Session management.
\- Selection of NG-RANs for broadcast.
NOTE 3: Additional functionality may be captured in clause 8.
### A.3.3.5 NG-RAN
The NG-RAN is used to receive MBS data packets via shared N3 tunnel and
deliver MBS data packets to the UEs using PTP or PTM delivery method. The NG-
RAN performs the following functions:
\- Management of MBS QoS flows via N2.
\- Reception of MBS data via shared N3 tunnel.
\- Configuration of UE for MBS QoS flow reception at AS layer.
\- Delivery of MBS data using PTM or PTP.
\- Control switching between PTM and PTP delivery per UE.
\- Support for multicast sessions during Xn Handover and N2 Handovers.
### A.3.3.6 UE
The UE needs to support the MBS operations and receive MBS data packets from
NG-RAN. The UE performs the following functions:
\- Reception of multicast data using PTM /PTP.
\- Reception of broadcast data.
\- Handling of incoming MBS QoS flows.
\- Signalling for joining and leaving multicast session.
\- MBS support at AS layer.
NOTE: Further details of UE functionality are captured in clause 8.
### A.3.3.7 AF
The AF requests MBS service from the 5GC. The AF does so by:
\- providing MBS service information.
\- negotiating with NEF for MBS related service exposure.
\- instructing MBS session operation towards 5GC if needed.
NOTE 1: Instructing MBS session operation depends on clause 8.
NOTE 2: AF can also support the separation of control plane and user plane.
### A.3.3.8 NEF
The NEF supports 5MBS service exposure. The NEF does so by:
\- may select MB-SMF for multicast session.
\- providing an interface to AFs for 5MBS procedures including service
provisioning and MBS session and QoS management.
\- interacting with AF and MB-SMF for MBS session operations and transport.
### A.3.3.9 MBSF
The MBSF performs the following functions:
\- Service level functionality to support MBS, and interworking with LTE MBMS
NOTE 1: MBSF functionality related to service is to be determined with SA4.
\- Interacting with AF and MB-SMF for MBS session operations, and transport.
\- Selection of MB-SMF for MBS Session and interaction with MB-SMF for
determination of MBS session transport parameters.
NOTE 2: Conclusions for interaction between MB-SMF and MBSF are captured in
clause 8.
\- Controlling MBSTF if the MBSTF is used.
\- Determination of sender IP multicast address for the MBS session if IP
multicast address is sourced by MBSTF.
### A.3.3.10 MBSTF
The MBSTF performs the following functions:
\- Media anchor for MBS data traffic if needed.
\- Sourcing of IP Multicast if needed.
\- Generic packet transport functionalities available to any IP multicast
enabled application such as framing, multiple flows, packet FEC (encoding) and
ROHC.
\- Multicast/broadcast delivery of input files as objects or object flows.
NOTE 1: MBSF functionality related to MBS data handling (e.g. encoding) is to
be determined with SA4.
NOTE 2: The MBSF and the MBSTF may be collocated or deployed separately.
### A.3.3.11 NRF
The NRF performs the following MBS related functions:
\- Support discovery of MBS capable SMFs and MB-SMFs.
NOTE: Detailed roles of NRF for MBS are captured in clause 8.
### A.3.3.12 SMF
The SMF performs the following MBS related functions:
\- may select MB-SMF for multicast session.
\- Interacts with MB-SMF to obtain multicast data for individual delivery.
NOTE 1: SMF and MB-SMF may be co-located or deployed separately.
NOTE 2: Whether SMF is involved in MB-SMF selection and how SMF interacts with
MB-SMF is concluded in clause 8.
NOTE 3: Additional functionality may be captured in clause 8.
### A.3.3.13 UPF
The UPF performs the following MBS related functions:
\- Interacts with SMF for receiving multicast data from MB-UPF for individual
delivery.
\- Send multicast data to NG-RAN for Individual delivery.
NOTE 1: UPF and MB-UPF may be co-located or deployed separately.
NOTE 2: Additional functionality and whether UP-based joining and leaving is
supported is concluded in clause 8.
### A.3.3.14 UDM
The UDM performs the following MBS related functions:
\- Store information about multicast session (authorized user groups)
NOTE 3: Additional functionality may be captured in clause 8.
#