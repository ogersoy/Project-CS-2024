# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
Annex G of 3GPP TS 23.228 [2] gives out an IMS Application Level Gateway (IMS-
ALG) and IMS Access Media Gateway (IMS-AGW) based reference model to support
NAPT-PT, gate control and traffic policing between IP-CAN and IMS domain.
Figure 1.1: Scope of the specification
Figure 1.1 illustrates the reference model for Iq:
\- the dashed line represents the IP signalling-path with SIP (at Gm) as
call/session control protocol between the UE and the P-CSCF (IMS-ALG);
\- the bold, horizontal line represents the IP media-path (also known as (IP)
bearer-path or (IP) data-path; the notion \'media\' is used as generic term
for \"IP application data\"); and
\- the vertical line represents the Iq control-path with H.248 as
gateway/policy control protocol between the IMS-ALG and the IMS-AGW (H.248
messages are transported over IP).
The Iq reference point is between the P-CSCF (IMS-ALG) and the IMS-AGW. It
conveys the necessary information that is needed to allocate, modify and
release (IP) transport addresses.
The present document defines the stage 2 description for the Iq reference
point. The stage 2 shall cover the information flow between the P-CSCF (IMS-
ALG) and IMS-AGW. The protocol used over the Iq interface is the gateway
control protocol according ITU-T Recommendation H.248 (which is specified for
Iq by an H.248 profile according 3GPP TS 29.334 [3]).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS), stage 2\".
[3] 3GPP TS 29.334: \"IMS Application Level Gateway (IMS-ALG) -- IMS Access
Gateway (IMS-AGW) Iq interface, stage 3\".
[4] IETF RFC 2663: \"IP Network Address Translator (NAT) Terminology and
Considerations\".
[5] 3GPP TS 32.260: \"Telecommunication management; Charging management; IP
Multimedia Subsystem (IMS) charging\".
[6] IETF RFC 3556: \"Session Description Protocol (SDP) Bandwidth Modifiers
for RTP Control Protocol (RTCP) Bandwidth\".
[7] IETF RFC 3605: \"Real Time Control Protocol (RTCP) attribute in Session
Description Protocol (SDP)\".
[8] 3GPP TS 23.205: \"Bearer independent circuit-switched core network; Stage
2\".
[9] ITU-T Recommendation H.248.1 (05/2002): \"Gateway Control Protocol:
Version 2\" including the Corrigendum1 for Version 2 (03/04).
[10] IETF RFC 2216: \"Network Element Service Template\".
[11] 3GPP TS 24.229: \"IP Multimedia Call Control Protocol based on SIP and
SDP\".
[12] 3GPP TS 33.328: \"IMS Media Plane Security\".
[13] IETF RFC 4568: \"Session Description Protocol (SDP) Security Descriptions
for Media Streams\".
[14] IETF RFC 3711: \"The Secure Real-time Transport Protocol (SRTP)\".
[15] IETF RFC 5124: \"Extended Secure RTP Profile for Real-time Transport
Control Protocol (RTCP)-Based Feedback (RTP/SAVPF)\".
[16] IETF RFC 3168: \"The Addition of Explicit Congestion Notification (ECN)
to IP\".
[17] IETF RFC 6679: \"Explicit Congestion Notification (ECN) for RTP over
UDP\".
[18] 3GPP TS 23.237: \"IP Multimedia subsystem (IMS) Service Continuity; Stage
2\".
[19] 3GPP TS 24.237: \"IP Multimedia subsystem (IMS) Service Continuity; Stage
3\".
[20] 3GPP TS 29.162: \"Interworking between the IM CN subsystem and IP
networks\".
[21] 3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia Telephony;
Media handling and interaction\".
[22] 3GPP TS 22.153: \"Multimedia Priority Service\".
[23] IETF RFC 5285: \"A General Mechanism for RTP Header Extensions\".
[24] IETF RFC 6236: \"Negotiation of Generic Image Attributes in the Session
Description Protocol (SDP)\".
[25] IETF RFC 4975: \"The Message Session Relay Protocol (MSRP)\".
[26] IETF RFC 6714: \"Connection Establishment for Media Anchoring (CEMA) for
the Message Session Relay Protocol (MSRP)\".
[27] IETF RFC 4583: \"Session Description Protocol (SDP) Format for Binary
Floor Control Protocol (BFCP) Streams\".
[28] Void.
[29] IETF RFC 793: \"Transmission Control Protocol -- DARPA Internet Program
-- Protocol Specification\".
[30] IETF RFC 4145: \"TCP-Based Media Transport in the Session Description
Protocol (SDP)\".
[31] IETF RFC 4582: \"The Binary Floor Control Protocol (BFCP)\".
[32] Void.
[33] IETF RFC 7345: \"UDP Transport Layer (UDPTL) over Datagram Transport
Layer Security (DTLS)\".
[34] IETF draft-schwarz-mmusic-sdp-for-gw-05: \"SDP codepoints for gateway
control\".
Editor\'s note: The above document cannot be formally referenced until it is
published as an RFC.
[35] GSM Association RCC.07: \"Rich Communication Suite 5.1 Advanced
Communications Services and Client Specification, Version 2.0, 03 May 2013\".
[36] GSM Association RCC.07: \"Rich Communication Suite 5.1 Advanced
Communications Services and Client Specification, Version 3.0, 25 September
2013\".
[37] Void.
[38] ITU-T Recommendation H.248.84 (07/2012): \"Gateway control protocol: NAT-
traversal for peer-to-peer services\".
[39] Void.
[40] Void.
[41] Void.
[42] IETF RFC 5763: \"Framework for Establishing a Secure Real-time Transport
Protocol (SRTP) Security Context Using Datagram Transport Layer Security
(DTLS)\".
[43] IETF RFC 5764: \"Datagram Transport Layer Security (DTLS) Extension to
Establish Keys for the Secure Real-time Transport Protocol (SRTP)\".
[44] 3GPP TS 24.371: \"Web Real-Time Communications (WebRTC) client access to
the IP Multimedia (IM) Core Network (CN) subsystem; Protocol specification\".
[45] IETF RFC 6135: \"An Alternative Connection Model for the Message Session
Relay Protocol (MSRP)\".
[46] OMA-TS-CPM_Conversation_Function-V2_0-20150113-C: \"CPM Conversation
Functions, Candidate Version 2.0 -- 13 Jan 2015\".
[47] IETF RFC 5746: \"Transport Layer Security (TLS) Renegotiation Indication
Extension\".
[48] 3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework
(AF)\".
[49] IETF RFC 7675: \"Session Traversal Utilities for NAT (STUN) Usage for
Consent Freshness\".
[50] IETF RFC 6716: \"Definition of the Opus Audio Codec\".
[51] 3GPP TS 26.441: \"Codec for Enhanced Voice Services (EVS); General
Overview\".
[52] 3GPP TS 26.445: \"Codec for Enhanced Voice Services (EVS); Detailed
Algorithmic Description\".
[53] IETF RFC 4566: \"SDP: Session Description Protocol\".
[54] IETF RFC 4867: \"RTP Payload Format and File Storage Format for the
Adaptive Multi-Rate (AMR) and Adaptive Multi-Rate Wideband (AMR-WB) Audio
Codecs\".
[55] IETF RFC 4566: \"SDP: Session Description Protocol\".
[56] IETF RFC 7587: \"RTP Payload Format for the Opus Speech and Audio
Codec\".
[57] IETF RFC 6544: \"TCP Candidates with Interactive Connectivity
Establishment (ICE)\".
[58] IETF RFC 4571: \"Framing Real-time Transport Protocol (RTP) and RTP
Control Protocol (RTCP) Packets over Connection-Oriented Transport\".
[59] IETF RFC 6947: \"The Session Description Protocol (SDP) Alternate
Connectivity (ALTC) Attribute\".
[60] IETF RFC 5761: \"Multiplexing RTP Data and Control Packets on a Single
Port\".
[61] IETF RFC 8831: \"WebRTC Data Channels\".
[62] IETF RFC 8873: \"Message Session Relay Protocol (MSRP)\".
[63] IETF RFC 4960: \"Stream Control Transmission Protocol\".
[64] IETF RFC 8841: \"Session Description Protocol (SDP) Offer/Answer
Procedures for Stream Control Transmission Protocol (SCTP) over Datagram
Transport Layer Security (DTLS) Transport\".
[65] IETF RFC 8864: \"Negotiation Data Channels Using the Session Description
Protocol (SDP)\".
[66] IETF RFC 5939: \"Session Description Protocol (SDP) Capability
Negotiation\".
[67] IETF RFC 6871: \"Session Description Protocol (SDP) Media Capabilities
Negotiation\".
[68] IETF RFC 4573: \"MIME Type Registration for RTP Payload Format for
H.224\".
[69] ITU-T Recommendation H.224 (01/2005): \"A real time control protocol for
simplex applications using the H.221 LSD/HSD/MLP channels\".
[70] ITU-T Recommendation H.281 (11/1994): \"A far end camera control protocol
for videoconferences using H.224\".
[71] IETF RFC 8858: \"Indicating Exclusive Support of RTP and RTP Control
Protocol (RTCP) Multiplexing Using the Session Description Protocol (SDP)\".
[72] IETF RFC 8035: \"Session Description Protocol (SDP) Offer/Answer
Clarifications for RTP/RTCP Multiplexing\".
[73] ITUâ€‘T Recommendation T.140 (02/98): \"Text conversation presentation
protocol\".
[74] IETF RFC 4103: \"RTP Payload for Text Conversation\".
[75] IETF RFC 8865: \"T.140 Real-Time Text Conversation over WebRTC Data
Channels\".
[76] Void.
[77] IETF RFC 4585: \"Extended RTP Profile for Real-time Transport Control
Protocol (RTCP)-Based Feedback (RTP/AVPF)\".
[78] IETF RFC 5104: \"Codec Control Messages in the RTP Audio-Visual Profile
with Feedback (AVPF)\".
[79] IETF RFC 7728: \"RTP Stream Pause and Resume\".
[80] IETF RFC 8122: \"Connection-Oriented Media Transport over the Transport
Layer Security (TLS) Protocol in the Session Description Protocol (SDP)\".
[81] IETF RFC 8842: \"Session Description Protocol (SDP) Offer/Answer
Considerations for Datagram Transport Layer Security (DTLS) and Transport
Layer Security (TLS)\".
[82] IETF RFC 8445: \"Interactive Connectivity Establishment (ICE): A Protocol
for Network Address Translator (NAT) Traversal\".
[83] IETF RFC 8839: \"Session Description Protocol (SDP) Offer/Answer
Procedures for Interactive Connectivity Establishment (ICE)\".
[84] IETF RFC 8489: \"Session Traversal Utilities for NAT (STUN)\".
[85] IETF RFC 8656: \"Traversal Using Relays around NAT (TURN): Relay
Extensions to Session Traversal Utilities for NAT (STUN)\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**End-to-access edge security:** media protection extending between an IMS UE
and the first IMS core network node in the media path without being terminated
by any intermediary node.
**End-to-end security:** media protection between two IMS UEs without being
terminated by any intermediary node.
**Full ICE:** The full implementation of the Interactive Connectivity
Establishment (ICE) specified in IETF RFC 8445 [82].
**ICE lite:** The lite implementation of the Interactive Connectivity
Establishment (ICE) specified in IETF RFC 8445 [82].
**Local (near-end) NAPT control:** the operation of providing network address
mapping information and NAPT policy rules to a near-end NAT in the media flow.
**NAT-PT/NAPT-PT:** see definition in 3GPP TS 23.228 [2].
**NAPT control and NAT traversal** : controls network address translation for
both near-end NA(P)T and far-end NA(P)T
**Network Address Translation (NA(P)T):** see definition in 3GPP TS 23.228
[2].
**Remote (far-end) NAT traversal:** the operation of adapting the IP addresses
so that the packets in the media flow can pass through a far-end (remote) NAT.
**RTP / RTCP transport multiplexing** : a single IP transport (L4) port for
RTP and RTCP packets.
**TLS-client:** the entity that initiates a TLS session establishment to a
server.
**TLS-server** : the entity that responds to requests for TLS session
establishment from clients.
**TLS endpoint** : either a TLS-client or a TLS-server.
**Convention:**
Wherever the **term NAT** is used in this specification, it may be replaced by
**NA(P)T or NA(P)T-PT.**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.237 [18] apply:
**Access Leg**
**Access Transfer Control Function (ATCF)**
**Access Transfer Gateway (ATGW)**
**Remote Leg**
**Target Access Leg**
**Source Access Leg**
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
Iq Interface between the IMS Application Level Gateway and the IMS Access
Media Gateway
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
ALTC Alternate Connectivity
AMR Adaptive Multi-Rate
AMR-WB Adaptive Multi-Rate - WideBand
AMR-WB IO Adaptive Multi-Rate - WideBand Inter-operable Mode, included in the
EVS codec
APP APPlication-defined RTCP packet
ATCF Access Transfer Control Function
ATGW Access Transfer Gateway
BFCP Binary Floor Control Protocol
CCM Codec Control Messages
CVO Coordination of Video Orientation
DBI Delay Budget Information
DC Data Channel
DTLS Datagram Transport Layer Security
DTX Discontinuous Transmission
e2ae security End-to-access-edge security
e2e security End-to-end security
ECN Explicit Congestion Notification
ECN-CE ECN Congestion Experienced
eIMS-AGW IMS Access Gateway enhanced for WebRTC
eP-CSCF P-CSCF enhanced for WebRTC
EVS Enhanced Voice Services
FECC Far End Camera Control
FIR Full Intra Request
GTT Global Text Telephony
ICE Interactive Connectivity Establishment
IMS-AGW IMS Access Media Gateway
IMS-ALG IMS Application Level Gateway
IM CN IMS Core Network
MSRP Message Session Relay Protocol
MTSI Multimedia Telephony Service for IMS
NA(P)T Network Address and optional Port Translation
NAPT Network Address Port Translation
NAT Network Address Translation
NA(P)T-PT NAT Address (and optional Port-) Translation and Protocol
Translation
P-CSCF Proxy-CSCF
ROI Region of Interest
RTCP RTP Control Protocol
RTP Real-time Transport Protocol
SDPCapNeg SDP Capability Negotiation
SRTP Secure Real-time Transport Protocol
SRVCC Single Radio Voice Call Continuity
STUN Session Traversal Utilities for NAT
TLS Transport Layer Security
TMMBN Temporary Maximum Media Stream Bit Rate Notification
TMMBR Temporary Maximum Media Stream Bit Rate Request
TURN Traversal Using Relay NAT
UDPTL User Datagram Protocol Transport Layer
URN Uniform Resource Name
WebRTC Web Real-Time Communication
WIC WebRTC IMS Client
WWSF WebRTC Web Server Function
# 4 Architecture
## 4.1 Reference architecture
The reference architecture for the IMS-ALG and the IMS-AGW when NAT is invoked
between the UE and the IMS domain is shown in figure 4.1.1 below.
Figure 4.1.1: Reference Architecture with NAT invoked between the UE and the
IMS domain
See 3GPP TS 23.228 [2] Annexes G.1 and G.2 for a comprehensive description of
the reference models.
The reference architecture for the IMS-ALG and the IMS-AGW supporting the
ATCF/ATGW function is shown in figure 4.1.2 below.
Figure 4.1.2: Reference Architecture for IMS-ALG/IMS-AGW with ATCF/ATGW
function
See 3GPP TS 23.237 [18] clause 5.2 for a comprehensive description of the
reference model.
The reference architecture for the IMS-ALG and IMS-AGW supporting
I**nteractive Connectivity Establishment** (ICE) is shown in figure 4.1.3, for
the case when both the signalling and media traverses NAT devices. There might
be an ICE process towards access network domain and/or an ICE process towards
core network domain. Both ICE processes are independent of each other. The
network entities that support Session Traversal Utilities for NAT (STUN) and
Traversal Using Relays NAT (TURN) are described in IETF RFC 8489 [84] and IETF
RFC 8656 [85] respectively.
NOTE 1: If the IMS-AGW only supports ICE lite, it will only contain a STUN
server.
NOTE 2: The IMS-AGW and IMS-ALG may support ICE only towards the served UE,
and will then only contain a STUN client/server and ICE support on related
terminations.
NOTE 3: The TURN server is a deployment option but not required for all ICE
deployments.
NOTE 4: The separate STUN server is used by the served UE while it gathers ICE
candidates. The STUN server in the IMS-AGW is used to answer ICE connectivity
checks.
Figure 4.1.3: Reference architecture for ICE
The reference architecture for the P-CSCF enhanced for WebRTC (eP-CSCF) and
the IMS-AGW enhanced for WebRTC (eIMS-AGW) to support WebRTC client access to
IMS is shown in figure 4.1.4 as below, see Annex U in 3GPP TS 23.228 [2] for a
comprehensive description of the reference model.
Figure 4.1.4: Reference Architecture for eP-CSCF/eIMS-AGW supporting WebRTC
access to IMS
NOTE 1: The presence of dashed elements in the figure depends on the
configuration.
PCC functional elements are present only for EPC access with QoS.
The corresponding PCC elements for fixed access are also optionally supported
but not shown.
The NAT in figure 4.1.4 is meant for non-cellular access to IMS.
## 4.2 NAT Function
An operator may need NAT function between UE and IMS domain. Such function can
be provided by the IMS-AGW and can be called local (near-end) NAT or IM CN
hosted NAT (see clause 5.2). There can also be an independent NAT device
between UE and IMS domain (see clause 5.4), referred as remote (far end) NAT.
Thus the IMS-AGW shall support remote NA(P)T traversal.
Figure 4.1.1 illustrates the particular IP media-path scenario with both a
remote NAT and local NAT function. Each NAT function is partitioning an IP
domain into two address domains, or partitioning the used IP address space
(realm) into two realms.
The reference architecture of Figure 4.1.1 may be mapped on various network
scenarios, like e.g. to three IPv4 realms, indicated by a) IP-CAN
(connectivity access network), b) (Media) Access Domain and c) (Media) IM CN
domain. If there would not be any remote NAT device between the UE and IMS-
AGW, then there would be just two IP domains (a and c).
The two types of NATs are also typically different from control perspective:
local (near-end) NAT can be controlled by the operators directly, and remote
(far-end) NAT that cannot be controlled by the operators directly.
The support of local NAT is thus implicitly leading to the requirement for IP
realm indication at Iq (see clause 5.3).
The edge node of the IP-CAN may be a remote (far-end) NAT device (see Figure
4.1.1). This NAT device provides NAT or NAPT or NA(P)T-PT for IP traffic in
the media-path and signalling path (e.g. IP network addresses and possibly L4
transport port values may be translated of SIP Gm messages).
The remote NAT device cannot be directly controlled by the operators of the
(Media) Access and IP CN domain. The IMS-ALG is consequently lacking the
direct information with regards to the applied NAT bindings by the remote NAT
device.
## 4.3 ATCF/ATGW Function
The ATCF/ATGW functions may be supported by the IMS-ALG/IMS-AGW when SRVCC
enhanced with ATCF is used. In this case, the Iq reference point is used for
IMS sessions that the IMS-ALG (ATCF) decides to anchor at the IMS-AGW (ATGW)
to provide the following functions:
\- reservation and configuration of IMS-AGW (ATGW) resources for media
anchoring during PS session origination or termination;
\- reconfiguration of IMS-AGW (ATGW) resources during access transfer to the
CS domain;
\- release of IMS-AGW (ATGW) resources upon completion of the access transfer
or release of the session;
\- media transcoding if the media that was used prior to the access transfer
is not supported by the MSC server;
\- IP version interworking if different IP versions are used between the
access and the remote legs;
\- Indication of IP realm during allocation of transport addresses/resources
(the PS and CS accesses may be reachable via different IP realms);
\- the ability to configure ECN properties towards the transferred to Access
if ECN is supported/requested;
\- the ability to reconfigure the ECN mode e.g. from ECN transparent to ECN
endpoint towards the IMS CN if ECN transparent cannot be maintained after
access transfer to the CS domain;
\- provide priority treatment to calls identified as Multimedia Priority
Service (see 3GPP TS 22.153 [22]).
See 3GPP TS 23.237 [18] and 3GPP TS 24.237 [19] for a comprehensive
description of the ATCF and ATGW functions.
## 4.4 eP-CSCF/eIMS-AGW Function
The Iq reference point is used between the P-CSCF enhanced for WebRTC (eP-
CSCF) and the IMS-AGW enhanced for WebRTC (eIMS-AGW), with the following
additional functions:
\- media plane interworking extensions as needed for WICs;
\- media security of type \"e2ae\" (as specified in 3GPP TS 33.328 [12]) for
data channels using DTLS-SCTP.
\- NAT traversal support including ICE;
\- the ability to perform any transcoding needed for audio and video codecs
supported by the browser; and
\- transport level interworking between data channels and other transport
options supported by IMS.
See 3GPP TS 23.228 [2] Annex U for a comprehensive description of the eP-CSCF
and eIMS-AGW functions.
# 5 Functional Requirements
## 5.1 General
A single IMS-ALG may control one or multiple IMS-AGW(s).
## 5.2 Gate Control & Local NAT
The IMS-ALG shall provide the NAPT control function, i.e. obtain the address
binding information (according to IETF RFC 2663 [4]) and perform the NAPT
policy control along with gate control (i.e. instruct the opening/closing of a
gate).
The IMS-ALG shall request the IMS-AGW to allocate transport
addresses/resources to enable media to traverse the IMS-AGW. The IMS-ALG may
indicate the corresponding IP realm to the IMS-AGW -- see clause 5.3. The IMS-
AGW shall provide the corresponding external transport addresses to the IMS-
ALG.
Terminations for the Iq interface may be pre-defined with different levels of
granularity for specific IP ports, interfaces, or groups of interfaces. These
may then be defined as an IP realm (see clause 5.3) known by both the IMS-ALG
and the IMS-AGW, however IP Realms may also be defined for multiple physical
interfaces. In order to efficiently report a failure affecting a large number
of terminations associated to specific physical interfaces, the IMS-AGW shall,
when allocating a new termination, return to the IMS-ALG an associated
Interface ID.
An IMS-AGW not supporting this procedure may allocate the same Interface ID
for all IP terminations.
An IMS-AGW supporting the Termination Out-of-Service procedure (see clause
6.1.15) shall maintain a local mapping of Interface ID to its internal
resources.
The IMS-AGW shall provide the NAPT enforcement function, i.e. change the
address and port number of the media packets as they traverse the IMS-AGW,
along with gate control (i.e. open/close a gate under the control of the IMS-
ALG).
The IMS-AGW may provide IP version interworking. If the IP version
interworking is performed and the IMS-ALG passes an SDP offer or answer, the
IMS-ALG may adjust any SDP bandwidth information contained in the SDP offer or
answer in accordance with 3GPP TS 29.162 [20] clause 9.1.5.
The IMS-ALG shall request the IMS-AGW to release its transport resources at
the end of a session.
## 5.3 IP realm indication and availability
The IMS-ALG and the IMS-AGW shall support IP realm indication.
The IMS-ALG, when requesting the allocation of transport resources at the IMS-
AGW, may indicate the correspondent IP realm to the IMS-AGW. The IMS-AGW shall
assign the IP termination in the IP realm indicated. The same IP realm shall
be applied to all media streams associated with the termination. The IP realm
identifier cannot be changed after the initial assignment.
A default IP realm may be configured such that if the IMS-AGW has not received
the IP realm identifier and the IMS-AGW supports multiple IP realms then the
default IP realm shall be used.
In order to prevent the IMS-ALG requesting an unavailable IP Realm, the IMS-
ALG may audit the list of currently available realms on the IMS-AGW and may
request the IMS-AGW to report any changes to that list as they occur over
time.
The monitoring of IP realm availability is optional and if supported by IMS-
AGW may be requested by the IMS-ALG.
## 5.4 Remote NAT traversal support
The IMS-ALG and the IMS-AGW shall support remote NA(P)T traversal support
using procedures according to the present clause. In addition they may support
remote NA(P)T traversal support using Interactive Connectivity Establishment
(ICE) according to clause 5.17.
The IMS-ALG is responsible for determining whether there is a remote NAT
device (the mechanism by which this achieved is out of scope of the current
document).
If a remote NAT device is present, the IMS-ALG shall request the IMS-AGW to
perform latching or re-latching when requesting the IMS-AGW to reserve
transport addresses/resources.
If remote NAT is applicable, the IMS-AGW shall not use the remote media
address/port information (supplied by the IMS-ALG) as the destination address
for outgoing media. Instead, the IMS-AGW shall dynamically learn the required
destination address via the source address/port of incoming media. This
mechanism is known as \"latching\".
When remote NAT Traversal is applied to a stream associated with multiple
flows (e.g. RTP and RTCP), the IMS-AGW shall perform individual latching
and/or re-latching on the various flows. This means that an RTP and an RTCP
flow of a single stream can be latched to different remote addresses and/or
ports.
## 5.5 Remote Source Address/Port Filtering
The IMS-ALG may support and the IMS-AGW shall support policing of the remote
source address/port of incoming media flow(s).
The IMS-ALG may determine that the source address/port of received media
packets should be policed.
When the IMS-ALG requests the IMS-AGW to reserve transport
addresses/resources, the IMS-ALG may indicate to the IMS-AGW that policing of
source address and/or port of received media packets is required.
If such policing is applicable, the IMS-AGW shall check the source address
and/or port of all received media packets and silently discard any packets
that do not conform to the expected source address and/or port.
## 5.6 Traffic Policing
The IMS-ALG may support traffic policing of incoming media flows.
The IMS-AGW shall support traffic policing of the maximum average bitrate,
defined as sustainable data rate (see IETF RFC 2216 [10]) of incoming media
flows and may support traffic policing of the peak data rate of incoming media
flows.
The IMS-ALG may require the IMS-AGW to police the media flows to ensure that
they conform to the expected data rates.
When the IMS-ALG requests the IMS-AGW to reserve transport
addresses/resources, the IMS-ALG may indicate to the IMS-AGW that policing of
the related media streams is required and provide traffic policing related
parameters as detailed in clause 6.2.5.
If such policing is requested, the IMS-AGW shall police the corresponding
media streams as detailed in clause 6.2.5 by measuring the data rate for the
received packets within that media stream. If the permissible data rate
provided by the IMS-ALG is exceeded, the IMS-AGW shall discard packets to
reduce their data rate to the permissible data rate.
For RTP flows where RTCP resources are reserved together with the RTP
resources (see clause 5.9), the permissible data rate shall include the
bandwidth used by RTP and RTCP together.
## 5.7 Hanging Termination Detection
The IMS-ALG and the IMS-AGW shall support detection of hanging termination.
The IMS-ALG, when requesting the IMS-AGW to reserve an AGW connection point,
shall indicate to the IMS-AGW to perform detection of hanging terminations.
The IMS-AGW shall determine a termination to be hanging if there is no
signalling sent/received within a specified period.
On being informed of the hanging termination, the IMS-ALG shall
check/determine whether the cited termination is valid and initiate any
appropriate corrective action, e.g. release an invalid termination.
## 5.8 QoS Packet Marking
The IMS-ALG may support and the IMS-AGW shall support control via the Iq
interface of the setting of the DiffServ Code Point (DSCP) for media packets
sent on a termination.
When the IMS-ALG requests the IMS-AGW to reserve transport
addresses/resources, the IMS-ALG may indicate to the IMS-AGW that the DSCP of
outgoing media packets shall be explicitly set or copied from the DSCP of the
corresponding received packet.
If such modification of the DSCP is required by the IMS-ALG, the IMS-AGW shall
set the DSCP for outgoing packets on a termination.
## 5.9 Handling of RTCP streams
### 5.9.1 General
The IMS-ALG and the IMS-AGW shall support control via the Iq interface of the
specific RTCP behaviour associated to an RTP flow.
When the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources
for an RTP flow, the IMS-ALG should also request the IMS-AGW to reserve
resources for the corresponding RTCP flow, but may alternatively request the
IMS-AGW not to reserve resources for the corresponding RTCP flow. When the
IMS-ALG requests the IMS-AGW to reserve transport addresses/resources for a
non-RTP flow, the IMS-ALG shall not request the IMS-AGW to reserve resources
for an RTCP flow.
To request the IMS-AGW to reserve resources for an RTCP flow, the IMS ALG
shall provide the RTCP handling information element with a value indicating
that resources for RTCP shall be reserved.
To request the IMS-AGW not to reserve resources for an RTCP flow, the IMS ALG
shall either provide the RTCP handling information element with a value
indicating that resources for RTCP shall not be reserved or omit the RTCP
handling information element.
If the IMS-AGW receives the indication to reserve RTCP resources, the IMS-AGW
shall allocate a local port with even number for an RTP flow and shall
allocate the consecutive local port with odd number for the associated RTCP
flow, and it shall send and be prepared to receive RTCP packets.
If the IMS-AGW receives the indication to not reserve RTCP resources, or if it
does not receive any indication at all, it shall not allocate an RTCP port
when allocating a port for an RTP flow. The IMS-AGW shall not send any RTCP
packets and shall silently discard any received RTCP packets.
When RTCP resources are requested, the IMS-ALG may also specify:
\- the explicit RTCP transport address information element containing the
remote RTCP port, and optionally the remote address, where to send RTCP
packets; if not specified, the IMS-AGW shall send RCTP packets to the port
contiguous to the remote RTP port; and
\- bandwidth allocation requirements for RTCP, if the RTCP bandwidth level for
the session is different than the default RTCP bandwidth as specified in RFC
3556 [6].
The explicit RTCP transport address information element contains the
\"a=rtcp\" SDP attribute (as specified in IETF RFC 3605 [7]) received within
the SDP body. The explicit RTCP transport address information element is only
allowed for remote endpoints and shall not be used for the local endpoint.
When the IMS-ALG requests the IMS-AGW to reserve resources for an RTCP flow
and provides in addition the explicit RTCP port information element, then the
IMS-AGW shall use this network address and transport port as destination when
sending RTCP packets towards the remote endpoint.
The IMS-AGW shall return an error if it can not allocate the requested RTCP
resources.
### 5.9.2 RTP/RTCP transport multiplexing
The procedure in clause 5.9.1 describing the default case of RTP/RTCP
transport non-multiplexed scenarios may be extended for the transport
multiplexed mode by addition of the RTP/RTCP transport multiplexing
information element to indicate to the IMS-AGW that RTP and RTCP traffic shall
be multiplexed on a single port (as described in IETF RFC 5761 [60]). The
RTP/RTCP transport multiplexing information element may only be sent to the
IMS-AGW in combination with the RTCP handling information element with the
value indicating that resources for RTCP shall be reserved. The support of
these procedures is optional for the IMS ALG and the IMS-AGW. The IMS-ALG
shall only use these procedures when knowing support at IMS-AGW side (e.g.,
via configuration management).
The usage is conditional, given by following restrictions:
1) The transport multiplexed mode may be only supported for terminations at
the access network side of the IMS-AGW.
2) The transport multiplexed mode shall be only enabled for the local
connection endpoint if agreed via SIP SDP offer/answer negotiation with the
served UE using:
\- the \"a=rtcp-mux\" SDP attribute, see IETF RFC 5761 [60], as updated by
IETF RFC 8035 [72]; and/or
\- the \"a=rtcp-mux-only\" SDP attribute, see IETF RFC 8858 [71].
NOTE 1: Usage of an \"rtcp-mux-only\" attribute **in an SDP answer is
forbidden,** see IETF RFC 8858 [71]**. If** the associated SDP answer does not
contain an SDP \"rtcp-mux\" attribute, the offerer (the IMS ALG or the UE)
needs to disable the associated RTP based media by sending a new SDP offer:\
\- with a zero port value associated with the SDP media description (\"m=\"
line); or\ \- without associating an SDP \"rtcp-mux-only\" attribute with the
SDP media description (\"m=\" line).
3) When transport multiplexed mode is agreed with the served UE, then it may
be applied in both traffic directions.
NOTE 2: The last two conditions enforce a symmetrical usage of RTP/RTCP
transport multiplexing in the related network domain (here the access
network).
## 5.10 Media Inactivity Detection
The IMS-ALG and the IMS-AGW may support the detection of inactive media flows.
The IMS-ALG may require an IMS-AGW that supports media inactivity detection to
detect if a media flow is inactive.
NOTE: The decision to apply or not media inactivity is general for all
sessions with the same media characteristics (i.e. not user specific). It is
for further study under which conditions inactivity media detection may be
requested.
When the IMS-ALG requests the IMS-AGW to reserve transport
addresses/resources, the IMS-ALG may indicate to the IMS-AGW that detection of
an inactive media flow is required and may additional specify inactivity
detection time and inactivity detection direction.
The IMS-AGW shall determine a media flow on termination to be inactive if
there is no media sent and/or received within the inactivity detection time
period.
On being informed of the inactive media, the IMS-ALG shall initiate any
appropriate corrective action.
## 5.11 IMS Media Plane Security
### 5.11.1 General
The IMS-ALG and the IMS-AGW may support IMS media plane security as specified
in 3GPP TS 33.328 [12]. They may support end-to-access edge security, or end-
to-end security, or both, for
\- RTP based media (such as e.g. audio, video information) using SRTP
security, and/or
\- TCP based media (such as MSRP and BFCP) using TLS security; and/or
\- UDP based media (such as T.38 fax over UDPTL/UDP) using DTLS security.
If supported the IMS-ALG and the IMS-AGW shall use the procedures in the
following clauses.
NOTE: For the support of end-to-end security, the presence of an IMS-ALG is
not required.
Procedures for the IMS-ALG to determine if end-to-access edge security or end-
to-end security is applicable to a session are specified in 3GPP TS 33.328
[12] and 3GPP TS 24.229[11].
### 5.11.2 End-to-access-edge Security
#### 5.11.2.1 End-to-access-edge security for RTP based media using SDES
Procedures for the IMS-ALG to determine if end-to-access edge security is
applicable to RTP based media and to exchange cryptography related SDP
parameters with the served UE during the SIP session setup are specified in
3GPP TS 33.328 [12] and 3GPP TS 24.229[11].
For media lines that can be subject to e2ae security, the IMS-ALG will receive
\"RTP/AVP\" or \"RTP/AVPF\" as transport protocol in SDP from the core
network. When the IMS-ALG determines that e2ae security is applicable, it will
indicate \"RTP/SAVP\" (see IETF RFC 3711 [14]) or \"RTP/SAVPF\" (see IETF RFC
5124 [15]), respectively, as transport protocol in the corresponding SDP media
lines send towards the served UE. When e2ae security is applied, the IMS-ALG
will also receive \"RTP/SAVP\" or \"RTP/SAVPF\" in SDP from the served UE. The
IMS-ALG will then indicate \"RTP/AVP\" or \"RTP/AVPF\" respectively, as
transport protocol in the corresponding SDP media lines send towards the core
network. When the IMS-ALG requests the IMS-AGW to reserve transport
addresses/resources for media to which e2ae security is applicable, the IMS
ALG shall configure \"RTP/SAVP\" or \"RTP/SAVPF\" as transport protocol at the
access side termination. The IMS ALG shall configure \"RTP/AVP\" or
\"RTP/AVPF\" as transport protocol at the core network side termination for
media where e2ae security is applicable.
When the IMS-ALG determines that e2ae security is applicable, it will generate
appropriate cryptographic context parameters, in particular key(s), and will
transfer them to the served UE within SDES SDP \"crypto\" attribute(s)
according to IETF RFC 4568 [13]. The IMS-ALG will also receive cryptographic
context parameters, in particular key(s), from the served UE within SDES SDP
\"crypto\" attribute(s). When the IMS-ALG requests the IMS-AGW to reserve or
configure transport addresses/resources for media to which e2ae security is
applicable, the IMS-ALG shall provide cryptography related parameters as SDES
SDP \"crypto\" attributes applicable at the access side termination.
On the originating side of the SIP session setup, the IMS-ALG shall provide as
\"Remote cryptographic SDES attribute\" the SDES crypto attribute it selected
from the ones received from the IMS UE in the SDP Offer . The IMS-ALG shall
provide as \"Local cryptographic SDES attribute\" the SDES crypto attribute
the IMS-ALG generated and inserted in the SDP Answer sent to IMS UE.
On the terminating side of the SIP session setup, the IMS-ALG shall provide as
\"Remote cryptographic SDES attribute\" the SDES crypto attribute received
from the IMS UE in the SDP Answer. The IMS-ALG shall provide as \"Local
cryptographic SDES attribute\" the SDES crypto attribute selected by the UE
from the ones the IMS-ALG generated and inserted in the SDP Offer sent to UE.
If the IMS-ALG offers only one SDES crypto attribute to the UE, the IMS-ALG
may provide this attribute as \"Local cryptographic SDES attribute\" within
the Reserve AGW Connection Point Procedure before receiving the SDP answer
from the UE.In the present release, a modification of an established e2ae
crypto session is not supported. Thus, the IMS-ALG shall not modify any
previously provided \"Local cryptographic SDES attribute\" or \"Remote
cryptographic SDES attribute\".
If the IMS-ALG applies e2ae media security for a media stream and receives an
SDP bandwidth modifier related to that media stream in SIP/SDP signalling, it
should modify this bandwith modifier to adjust the bandwidth overhead due to
e2ae security before forwarding the SDP. The IMS-ALG should add the bandwidth
overhead caused by e2ae media security to the bandwidth information received
from the remote peer. The IMS-ALG should substract the bandwidth overhead
caused by e2ae media security from the bandwidth information received from the
served UE.
The IMS Access GW shall, upon reception of an SDES crypto attribute, establish
an SRTP security context (as described in RFC 4568 [13] and RFC 3711 [14]) and
be prepared to convert RTP packets to SRTP packets and vice versa, using the
corresponding SRTP security contexts.
#### 5.11.2.2 End-to-access-edge security for TCP based media using TLS
##### 5.11.2.2.1 General
E2ae security for TCP based media using TLS is applicable for MSRP (see IETF
RFC 4975 [25]; used in IMS session-based messaging) and BFCP (see IETF RFC
4582 [31]; used in IMS conferencing). The IMS-ALG and IMS-AGW may support e2ae
security for MSRP, BFCP, or both protocols.
E2ae protection of MSRP and BFCP media is based on TLS, according to the TLS
profile specified in Annex E of 3GPP TS 33.310 [48] and Annex M of 3GPP TS
33.328 [12]. TLS shall be supported over the TCP transport (see IETF RFC 793
[29]).
Key management for e2ae protection of MSRP and BFCP is based on the
ciphersuites and session keys negotiated via the TLS handshake protocol
between the UE and the IMS-AGW (see 3GPP TS 33.328 [12]).
Procedures for the IMS-ALG to determine if e2ae security for MSRP and/or BFCP
is applicable to a session and to exchange the cryptographic information (i.e.
certificate fingerprints, see IETF RFC 8122 [80]) over SDP with the served UE
during the SIP session setup are specified in 3GPP TS 33.328 [12] and 3GPP TS
24.229 [11]. If e2ae security is not required, the e2e security procedures may
apply, see clause 5.11.3.
According to the TLS profile specified in Annex E of 3GPP TS 33.310 [48], the
IMS-AGW shall accept TLS renegotiation only if it is secured according to IETF
RFC 5746 [47].
NOTE 1: IETF RFC 5746 [47] defines a \"TLS secure renegotiation\" procedure,
which leaves the definition of a basic TLS renegotiation still open. H.248
based support to enable the IMS-ALG to allow or not allow the IMS-AGW to
perform client initiated or server initiated TLS renegotiation is not
addressed in the present release. The behaviour of the IMS-AGW for \"TLS
session renegotiation\" procedure is hence not further defined in the present
release.
If the IMS-ALG applies e2ae media security for a media stream and receives an
SDP bandwidth modifier related to that media stream in SIP/SDP signalling, it
should modify this bandwith modifier to adjust the bandwidth overhead due to
e2ae security before forwarding the SDP. The IMS-ALG should add the bandwidth
overhead caused by e2ae media security to the bandwidth information received
from the remote peer. The IMS-ALG should substract the bandwidth overhead
caused by e2ae media security from the bandwidth information received from the
served UE.
For each MSRP or BFCP media stream to be set-up with e2ae security, the P-CSCF
(IMS-ALG) shall:
\- include the IMS-AGW in the media path and allocate the required resources
for the media stream in the IMS-AGW;
\- request a certificate fingerprint from the IMS-AGW;
\- include the certificate fingerprint received from the IMS-AGW in the SDP it
sends to the IMS UE;
\- send the certificate fingerprint(s) received in the SDP from the IMS UE to
the IMS-AGW;
\- instruct the IMS-AGW to perform state-aware TCP handling by including
information about the TCP setup direction;
\- for each termination determine via SDP negotiation as specified in IETF RFC
4145 [30] if the IMS-AGW needs to act as TCP client or server for the
terminations towards the core network and towards the access network;
\- indicate to the IMS-AGW how to perform the TCP connection establishment by:
a) either instructing the IMSâ€‘AGW to start a TCP connection establishment on
any terminations where it needs to act as TCP client; or
b) indicating to the IMSâ€‘AGW to use an incoming TCP connection establishment
request at one termination as a trigger to send a TCP connection establishment
request at the interconnected termination in the same context (support of this
alternative is optional for the IMS-AGW and IMSâ€‘ALG);
\- determine via SDP negotiation if the IMS-AGW needs to act as TLS client or
server as specified in the clauses below;
NOTE 2: The determination of the TLS client/server role relies on different
rules for MSRP and BFCP.
\- if the IMS-AGW needs to act as TLS client, request the IMS-AGW to start the
TLS session setup once the TCP connection is established towards the UE; and
\- apply additional specific procedures for MSRP in clause 5.11.2.2.2 or for
BFCP in clause 5.11.2.2.3.
For each MSRP or BFCP media stream to be set-up with e2ae security the IMS-AGW
shall:
\- upon request from the IMS-ALG, select an own certificate for the media
stream, uniquely associate own certificate with the media stream, and send the
fingerprint of the own certificate to the IMS-ALG;
\- uniquely associate the certificate fingerprint(s) received from the IMS-ALG
with the corresponding MSRP or BFCP media stream, and subsequently use the
certificate fingerprint(s) (as described in IETF RFC 4975 [25]) to verify the
establishment of the TLS session of the corresponding media stream to belong
to the served user;
\- if the verification of the remote certificate fingerprint(s) during the TLS
session establishment fails, regard the remote TLS endpoint as not
authenticated, terminate the TLS session and report the unsuccessful TLS
session setup to the IMS-ALG;
\- negotiate the TLS protocol configurations with the TLS peer based on
locally provisioned TLS profile parameters;
\- when the TLS session has been established, convert unprotected media
received from the network to protected media to send to the served UE and vice
versa;
\- be capable to support both the TLS server and TLS client roles;
\- when being instructed to start the TLS session setup, act as a TLS client
and establish the TLS session as soon as the underlying TCP bearer connection
is established;
\- upon instruction of the IMS-ALG to perform state-aware TCP handling, not
forward any TCP connection establishment request received on one termination
towards the interconnected termination;
\- upon corresponding instructions from the IMSâ€‘ALG, start a TCP connection
establishment on the indicated termination by sending a TCP SYN, or use an
incoming TCP connection establishment request received at one termination as a
trigger to send a TCP connection establishment request at the interconnected
termination in the same context;
\- release the underlying TCP bearer connection as soon as the TLS session is
released; and
\- apply additional specific procedures for MSRP in clause 5.11.2.2.2 or for
BFCP in clause 5.11.2.2.3.
##### 5.11.2.2.2 e2ae security for session based messaging (MSRP)
For each MSRP media stream outside WebRTC data channels requiring e2ae
security, the IMS-ALG shall indicate to the IMS-AGW as transport protocol:
a) for application-agnostic e2ae security support:
\- \"TCP\" at the termination towards the core network; and
\- \"TCP/TLS\" at the termination towards the access network; or
b) for application-aware e2ae security support:
\- \"TCP/MSRP\" at the termination towards the core network; and
\- \"TCP/TLS/MSRP\" at the termination towards the access network.
The IMS-ALG shall determine via SDP negotiation if the IMSâ€‘AGW needs to act as
TLS client or TLS server using the IETF RFC 4145 [30] \"a=setup\" SDP
attribute as follows:
\- if the IMSâ€‘ALG send an \"a=setup:active\" SDP attribute in an SDP answer
towards the UE, the IMSâ€‘AGW shall act as TLS client;
\- if the IMSâ€‘ALG send an \"a=setup:passive\" SDP attribute in an SDP answer
towards the UE, the IMSâ€‘AGW shall act as TLS server;
\- if the IMSâ€‘ALG receives an \"a=setup:active\" SDP attribute in an SDP
answer from the UE, the IMSâ€‘AGW shall act as TLS server; and
\- if the IMSâ€‘ALG receives an \"a=setup:passive\" SDP attribute in an SDP
answer from the UE, the IMSâ€‘AGW shall act as TLS client.
##### 5.11.2.2.3 e2ae security for conferencing (BFCP)
For each BFCP media stream requiring e2ae security, the IMS-ALG shall indicate
to the IMS-AGW as transport protocol:
\- \"TCP\" at the termination towards the core network; and
\- \"TCP/TLS\" at the termination towards the access network.
The IMS-ALG shall determine via SDP negotiation (see IETF RFC 4583 [27]) if
the IMSâ€‘AGW needs to act as TLS client or TLS server as follows:
\- if the IMSâ€‘ALG receives an initial SDP offer from the UE, the IMSâ€‘AGW shall
act as TLS server; and
\- if the IMSâ€‘ALG sends an initial SDP offer towards the UE, the IMSâ€‘AGW shall
act as TLS client.
#### 5.11.2.3 End-to-access-edge security for UDP based media using DTLS
##### 5.11.2.3.1 General
The IMS-ALG and the IMS-AGW may support end-to-access-edge (e2ae) security for
an UDP based media. The e2ae protection of the UDP based media relies on the
usage of DTLS, according to the DTLS profiles specified in Annex E of 3GPP TS
33.310 [48] and exchange of self-signed certificates as defined in 3GPP TS
33.328 [12].
Key management solution for the e2ae media security of UDP is based on the
cipher suites and session keys negotiated via the DTLS handshake protocol
between the served UE and the IMS-AGW as specified in 3GPP TS 33.328 [12].
Procedures for the IMS-ALG to determine if e2ae security is applicable to UDP
based media and to exchange the cryptographic information (i.e. certificate
fingerprints, see IETF RFC 8122 [80]) via SDP negotiation with the served UE
during the SIP session establishment are specified in 3GPP TS 33.328 [12] and
3GPP TS 24.229 [11].
If the IMS-ALG applies e2ae media security for a media stream and receives an
SDP bandwidth modifier related to that media stream in SIP/SDP signalling, it
should modify this bandwith modifier to adjust the bandwidth overhead due to
e2ae security before forwarding the SDP. The IMS-ALG should add the bandwidth
overhead caused by e2ae media security to the bandwidth information received
from the remote peer. The IMS-ALG should substract the bandwidth overhead
caused by e2ae media security from the bandwidth information received from the
served UE.
Clause 5.11.2.3.2 defines specific requirements for e2ae protection of T.38
fax media stream over UDPTL/UDP transport. The usage of UDPTL over DTLS is
defined in IETF RFC 7345 [33] and IETF RFC 8842 [81].
##### 5.11.2.3.2 e2ae security for T.38 fax over UDP/UDPTL transport
If the IMS-ALG and the IMS-AGW support e2ae security for the UDP based media
using DTLS and certificate fingerprints, then for each T.38 fax media stream
over UDPTL/UDP transport to be setup with e2ae security, the IMS-ALG shall:
\- include the IMS-AGW in the media path and allocate the required resources
for the media stream in the IMS-AGW;
\- determine via SDP negotiation with the served UE if the IMS-AGW needs to
act as DTLS client or DTLS server as specified in IETF RFC 7345 [33] and IETF
RFC 8842 [81];
\- when requesting resources towards the access network:
a) indicate to the IMS-AGW \"UDP/DTLS\" as transport protocol;
NOTE 1: For IANA registry of \"UDP/DTLS\" see IETF draft-schwarz-mmusic-sdp-
for-gw [34].
b) send the certificate fingerprint(s) received from the served UE to the IMS-
AGW; and
c) request from the IMS-AGW the certificate fingerprint;
\- include the certificate fingerprint received from the IMS-AGW in the SDP
body it sends to the served UE;
\- if the IMS-ALG received from the served UE an SDP offer with \"a=tls-id\"
media-level SDP attribute (as specified in IETF RFC 8842 [81]), create a new
DTLS association identity and include the \"a=tls-id\" SDP attribute with the
new DTLS association identity in the SDP answer which the IMS-ALG sends to the
served UE;
\- if the IMS-ALG sends to the served UE an SDP offer, create a new DTLS
association identity and include the \"a=tls-id\" SDP attribute with the new
DTLS association identity in the SDP offer;
NOTE 2: Already used certificate fingerprints can be assigned to a new DTLS
association. If the IMS-AGW uses the same set of fingerprints for a new DTLS
association then the IMS-ALG creates a new local \"tls-id\" attribute value so
that the combination of the \"tls-id\" attribute values of the IMS-ALG and the
served UE is unique across all DTLS associations that might be handled by the
IMS-ALG and the served UE, as specified in IETF RFC 8842 [81].
\- request the IMS-AGW to start the DTLS session setup if the IMS-AGW needs to
act as DTLS client; and
\- when requesting resources towards the core network:
a) indicate to the IMS-AGW \"UDP\" as transport protocol.
For each T.38 fax media stream over UDPTL/UDP transport to be setup with e2ae
security, the IMS-AGW shall:
\- be capable to support both the DTLS server and DTLS client roles;
\- upon request from the IMS-ALG, act as DTLS client and start DTLS session
establishment;
\- upon request from the IMS-ALG, select an own certificate for the T.38 fax
media stream, uniquely associate its own certificate with the media stream,
and send the fingerprint of the own certificate to the IMS-ALG;
\- uniquely associate the certificate fingerprint(s) received from the IMS-ALG
with the corresponding T.38 fax media stream; and
\- verify during the subsequent DTLS handshake with the served UE (as
described in IETF RFC 7345 [33] and IETF RFC 8842 [81]) that the fingerprint
of the certificate passed by the served UE during DTLS handshake matches the
certificate fingerprint received from the IMS-ALG:
a) if the verification fails, the IMS-AGW shall regard the remote DTLS
endpoint as not authenticated, terminate the DTLS session and report the
unsuccessful DTLS session setup to the IMS-ALG;
b) otherwise, the IMS-AGW shall continue with DTLS session setup and when the
DTLS session is established, the IMS-AGW shall be prepared to receive and
convert unprotected media from the core network to the protected media to be
sent to the served UE and vice versa.
#### 5.11.2.4 End-to-access-edge security for RTP based media using DTLS-SRTP
Support of end-to-access edge security for RTP based media using DTLS-SRTP is
mandatory for WebRTC sessions and optional for other SIP sessions.
The P-CSCF (IMS-ALG) and IMS-AGW provide end-to-access edge security by using
DTLS-SRTP, where DTLS is used to establish keys for SRTP according to IETF RFC
5763 [42], IETF RFC 8842 [81] and IETF RFC 5764 [43].
During the establishment of a WebRTC or SIP session, the IMS-ALG receives
\"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as the transport protocol in SDP
from the served UE (IMS UE or WebRTC IMS Client (WIC)). The IMS-ALG then shall
indicate \"RTP/AVP\" or \"RTP/AVPF\" over UDP, respectively, as the transport
protocol in the corresponding SDP media lines send towards the core network.
When an IMS-ALG receives \"RTP/AVP\" or \"RTP/AVPF\" in SDP from the core
network, the IMS-ALG shall indicate \"UDP/TLS/RTP/SAVP\" or
\"UDP/TLS/RTP/SAVPF\" as transport protocol in SDP send towards the served UE
(IMS UE or WIC). When the IMS-ALG requests the IMS-AGW to reserve transport
addresses/resources for e2ae media security, the IMS ALG shall configure
\"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as transport protocol at the
access side termination, and \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport
protocol at the core network side termination.
The IMS-ALG shall send the received UE (IMS UE or WIC) certificate
fingerprint(s) to the IMS-AGW that is then able to correlate the fingerprint
within the media stream uniquely. For each SRTP/SRTCP media stream to be
established with e2ae media security, the IMS-AGW shall send the fingerprint
of its certificate via Iq interface to the IMS-ALG.
If the IMS-ALG received from the UE (IMS UE or WIC) an SDP offer with \"a=tls-
id\" media-level SDP attribute (as specified in IETF RFC 8842 [81]), create a
new DTLS association identity and include the \"a=tls-id\" SDP attribute with
the new DTLS association identity in the SDP answer which the IMS-ALG sends to
the UE (IMS UE or WIC).
If the IMS-ALG sends to the UE (IMS UE or WIC) an SDP offer, create a new DTLS
association identity and include the \"a=tls-id\" SDP attribute with the new
DTLS association identity in the SDP offer.
NOTE: Already used certificate fingerprints can be assigned to a new DTLS
association. If the IMS-AGW uses the same set of fingerprints for a new DTLS
association then the IMS-ALG creates a new local \"tls-id\" attribute value so
that the combination of the \"tls-id\" attribute values of the IMS-ALG and the
UE (IMS UE or WIC) is unique across all DTLS associations that might be
handled by the IMS-ALG and the UE (IMS UE or WIC), as specified in IETF RFC
8842 [81].
According to procedures defined in 3GPP TS 24.229[11] and 3GPP TS 24.371 [44],
the IMS-AGW shall act as either a DTLS server or client in the DTLS session.
In DTLS-SRTP case, RTP and RTCP data are encrypted using SRTP and SRTCP as
defined in IETF RFC 3711 [14].
When the DTLS session is established between the UE (IMS UE or WIC) and the
IMS-AGW, the IMS-AGW shall be prepared to send and receive SRTP/SRTCP packets
of the incoming network side from the UE (IMS UE or WIC), and convert
SRTP/SRTCP packets to RTP/RTCP packets to the outgoing network side and vice
versa, if the media stream toward the IMS core network is using RTP/RTCP.
#### 5.11.2.5 End-to-access-edge security for RTP based voice and video media
using DTLS-SRTP over TCP
The eP-CSCF (IMS-ALG) and eIMS-AGW for WebRTC may support end-to-access-edge
security for RTP based voice and video media using DTLS-SRTP over TCP. If they
do so, they shall apply the procedures in the present clause.
NOTE 1: RTP over TCP may be used to traverse NAT/Firewalls that perform UDP
blocking.
TCP transport may be offered as an alternative to UDP transport using the ICE
procedures in clause 5.18. The eP-CSCF (IMS-ALG) and eIMS-AGW for WebRTC shall
then provide end-to-access edge security for voice and video by using DTLS-
SRTP over TCP, where DTLS is used to establish keys for SRTP according to IETF
RFC 5763 [42], IETF RFC 8842 [81] and IETF RFC 5764 [43]. Framing according to
RFC 4571 [58] shall be used for RTP streams transferred over TCP.
The IMS-ALG shall send the received WIC certificate fingerprint(s) to the
eIMS-AGW that is then able to correlate the fingerprint within the media
stream uniquely. For each SRTP/SRTCP media stream to be established with e2ae
media security, the eIMS-AGW shall send the fingerprint of its certificate via
Iq interface to the IMS-ALG.
NOTE 2: The same fingerprint also applies for End-to-access-edge security for
RTP based media using DTLS-SRTP, as described in clause 5.11.2.4.
If the IMS-ALG received from the WIC an SDP offer with \"a=tls-id\" media-
level SDP attribute (as specified in IETF RFC 8842 [81]) create a new DTLS
association identity and include the \"a=tls-id\" SDP attribute with the new
DTLS association identity in the SDP answer which the IMS-ALG sends to the
WIC.
If the IMS-ALG sends to the WIC an SDP offer, create a new DTLS association
identity and include the \"a=tls-id\" SDP attribute with the new DTLS
association identity in the SDP offer.
NOTE 3: Already used certificate fingerprints can be assigned to a new DTLS
association. If the IMS-AGW uses the same set of fingerprints for a new DTLS
association then the IMS-ALG creates a new local \"tls-id\" attribute value so
that the combination of the \"tls-id\" attribute values of the IMS-ALG and the
WIC is unique across all DTLS associations that might be handled by the IMS-
ALG and the WIC, as specified in IETF RFC 8842 [81].
According to procedures defined in 3GPP TS 24.371 [44], the eIMS-AGW shall act
as either a DTLS server or client in the DTLS session.
In DTLS-SRTP over TCP case, RTP and RTCP data are encrypted using SRTP and
SRTCP as defined in IETF RFC 3711 [14].
When the DTLS session is established between the WIC and the eIMS-AGW, the
eIMS-AGW shall be prepared to send and receive SRTP/SRTCP packets over TCP of
the incoming network side from the WIC, and convert SRTP/SRTCP packets to
RTP/RTCP packets over UDP to the outgoing network side and vice versa, if the
media stream towards the IMS core network is using RTP/RTCP over UDP.
#### 5.11.2.6 End-to-access-edge security for WebRTC data channels using
UDP/DTLS/SCTP transport
The procedures in clause 5.20.2 are applicable.
### 5.11.3 End-to-end Security
#### 5.11.3.1 End-to-end security for RTP based media
For the support of e2e-security, the IMS-ALG and the IMS-AGW shall support
\"RTP/SAVP\" (see IETF RFC 3711 [14]) and/or \"RTP/SAVPF\" (see IETF RFC 5124
[15]) as transport protocol.
If the IMS-ALG receives SDP containing media lines with \"RTP/SAVP\" (see IETF
RFC 3711 [14]) or \"RTP/SAVPF\" (see IETF RFC 5124 [15]) as transport
protocol, but did not receive any request for end-to-access-edge security, the
IMS-ALG shall:
\- forward the SDP with unmodified transport protocol for those media lines;
\- provide \"RTP/SAVP\" or \"RTP/SAVPF\", as received in the SDP, to the IMS-
AGW as transport protocol for all related terminations, and provide no media
related information to these terminations, to configure the IMS-AGW to pass
media transparently.
If the IMS-ALG receives SDP containing SDES SDP attribute(s) according to IETF
RFC 4568 [13], and did not receive any request for end-to-access-edge
security, it shall forward the SDP with unmodified SDES SDP attribute(s), but
shall not provide the SDES SDP attribute(s) to the IMS-AGW.
#### 5.11.3.2 End-to-end security for TCP-based media using TLS
End-to-end protection of MSRP (used in IMS session-based messaging) and BFCP
(used in IMS conferencing) media is based on TLS, according to the TLS profile
specified in Annex E of 3GPP TS 33.310 [48] and Annex M of 3GPP TS 33.328
[12].
If the IMS-ALG receives SDP containing media lines with \"TCP/TLS/MSRP\" (see
IETF RFC 4975 [25] and IETF RFC 6714 [26]) and/or \"TCP/TLS/BFCP\" (see IETF
RFC 4583 [27]) as transport protocol but did not receive any request for end-
to-access-edge security, the IMS-ALG shall:
\- forward the SDP with unmodified transport protocol for those media lines
and unmodified TLS related SDP attribute(s);
\- indicate \"TCP\" to the IMS-AGW as transport protocol for all related
terminations, and provide no media related information to these terminations,
to configure the IMS-AGW to pass media transparently.
NOTE: End-to-end security for TCP-based media using TLS is not supported
between two terminals being located behind firewalls/NATs.
## 5.12 Explicit Congestion Notification support
### 5.12.1 General
An IMS-ALG and IMS-AGW may support Explicit Congestion Notification (see IETF
RFC 3168 [16], IETF RFC 6679 [17] and 3GPP TS 26.114 [21]).
An IMS-ALG and IMS-AGW which supports ECN shall support the ECN transparent
procedure i.e. the transparent forwarding of ECN bits in the IP header (see
IETF RFC 3168 [16]). If the IMS-AGW does not support the transparent
forwarding of ECN bits then the IMS-ALG shall not permit ECN in the SDP
Offer/Answer negotiation.
The IMS-AGW shall treat RTCP for ECN as a RTP translator with no media
translation.
An IMS-ALG and IMS-AGW which supports ECN may then act as an ECN endpoint to
enable ECN towards the IMS access network or/and towards the IMS Core Network.
The subsequent clauses describe the general support for ECN, further details
on the support of ECN during PS to CS access transfer is described in clause
6.2.14.3.
NOTE: It is out of the scope of this profile to support interworking with a
non-3GPP ECN IP terminal.
An IMS-ALG and IMS-AGW that support ECN Transparent as well as transcoding
shall also support the ECN endpoint procedure.
An IMS-ALG/IMS-AGW supporting the ATCF/ATGW function and ECN shall support ECN
Endpoint (see clause 6.2.14).
When acting as an ECN endpoint, the IMS-AGW shall be capable of enabling end-
to-end rate adaptation between the local terminal and the remote entity by
performing the following towards the ECN-capable peer:
\- trigger rate adaptation request towards the ECN-capable peer when receiving
in the incoming IMS media flow IP packets marked with ECN-CE, regardless of
whether the IMS-AGW applies or does not apply transcoding;
\- forward adaptation requests between the local and the remote peer when the
IMS-AGW bridges compatible codec configurations between the interfaces without
applying a transcoding function;
\- perform media adaptation (e.g. reduce media bit-rate) towards the ECN-
capable peer when receiving from the latter an adaptation request. and the
IMS-AGW applies transcoding.
### 5.12.2 Incoming SDP offer with ECN
The IMS-ALG and IMS-AGW shall apply the requirements specified in clause
10.2.13.2 of 3GPP TS 29.162 [20] replacing the IBCF and TrGW with IMS-ALG and
IMS-AGW respectively.
### 5.12.3 Incoming SDP offer without ECN
The IMS-ALG and IMS-AGW shall apply the requirements specified in clause
10.2.13.3 of 3GPP TS 29.162 [20] replacing the IBCF and TrGW with IMS-ALG and
IMS-AGW respectively with the following additions:
\- if the IMS-ALG or IMS-AGW does not support the procedure to act as an ECN
endpoint, the IMS-ALG shall not include the \"a=ecn-capable-rtp\" attribute in
the SDP offer it forwards to the succeeding node.
### 5.12.4 Detection of ECN failures by IMS-AGW
An IMS-ALG and IMS-AGW that support the procedure to act as an ECN endpoint
shall support the requirements specified in clause 10.2.13.3a of 3GPP TS
29.162 [20] replacing the IBCF and TrGW with IMS-ALG and IMS-AGW respectively.
## 5.13 Transcoding
### 5.13.1 General
The transcoding functionality, where the IMS-AGW processes and possibly
converts media data (like e.g. RTP payload) is optional for the P-CSCF and
IMS-AGW to support. Transcoding should be supported if the IMS-ALG and IMS-AGW
support the ATCF and ATGW functions for use after an SRVCC handover if the
media that was used prior to the access transfer is not supported by the MSC
Server.
An IMS-ALG and IMS-AGW that support transcoding shall support the requirements
specified for Media Control in clause 10.2.5 of 3GPP TS 29.162 [20]
respectively for the IBCF and TrGW, with the following additions:
\- During an originating or terminating PS session establishment, the IMS-ALG
(ATCF) may remove codecs when passing SDP offers (e.g. codecs known not to be
supported by either the IMS-AGW (ATGW) or the MSC Server), but the IMS-ALG
(ATCF) should pass SDP offers without adding codecs to the SDP offer and pass
SDP answers without modification to the contained codecs to avoid the
potential need for transcoding in the IMS-AGW (ATGW) before the PS to CS
access transfer;
\- During the PS to CS access transfer procedure, the IMS-ALG (ATCF) shall
preferentially select from the SDP offer it receives from the MSC Server the
codec already configured on the corresponding remote leg, if available.
The procedures for the IMS-ALG (ATCF) and IMS-AGW (ATGW) are further detailed
in clause 6.2.14.
### 5.13.2 Handling of common codec parameters
When receiving an SDP offer, the IMS-ALG may add a payload type to offer
transcoding before forwarding the SDP offer (denoted as \"codec 3\" in figures
10.2.5.1 and 10.2.5.2 of 3GPP TS 29.162 [20]). If that payload type is
selected in the SDP answer, the IMS-ALG needs to transcode. Table 5.13.2.1
describes the IMS-ALG handling of codec related parameters applicable to
multiple codecs when the IMS-ALG adds the payload type to the SDP offer, and
that payload type is selected in the SDP answer.
Table 5.13.2.1: IMS-ALG handling of common codec parameters for transcoding.
+----------------------+----------------------+----------------------+ | Parameter | Handling of common | Handling of common | | | codec parameter in | codec parameter in | | | the sent SDP offer | the received SDP | | | | answer | +----------------------+----------------------+----------------------+ | ptime (NOTE) | If the ptime | If the ptime | | | parameter is | parameter is | | | included in the | included in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG shall | the IMS-ALG shall | | | supply the parameter | supply the parameter | | | to the IMS-AGW for | to the IMS-AGW for | | | the termination | the termination | | | towards the offerer | towards the SDP | | | in the remote | answerer in the | | | descriptor. | remote descriptor. | | | | | | | If the value is | If the value is | | | supported by the | supported by the | | | IMS-AGW for | IMS-AGW for | | | receiving media, the | receiving media, the | | | IMS-ALG should keep | IMS-ALG should keep | | | the value from the | the value from the | | | received SDP offer | received SDP answer | | | unchanged in the SDP | unchanged in the SDP | | | offer it sends. If | answer it sends. If | | | the IMS-AGW only | the IMS-AGW only | | | supports a lower | supports a lower | | | ptime value, the | ptime value, the | | | IMS-ALG shall supply | IMS-ALG shall supply | | | the ptime value | the ptime value | | | according to | according to | | | configured | configured | | | preferences in the | preferences in the | | | SDP offer it | SDP answer it | | | forwards. If no | forwards. If no | | | ptime value was | ptime value was | | | contained in the | contained in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG may add | the IMS-ALG may add | | | the parameter with a | the parameter with a | | | value according to | value according to | | | configured | configured | | | preferences to the | preferences to the | | | SDP offer. | SDP answer. | +----------------------+----------------------+----------------------+ | maxptime (NOTE) | If the maxptime | If the maxptime | | | parameter is | parameter is | | | included in the | included in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG shall | the IMS-ALG shall | | | supply the parameter | supply the parameter | | | to the IMS-AGW for | to the IMS-AGW for | | | the termination | the termination | | | towards the offerer | towards the SDP | | | in the remote | answerer in the | | | descriptor. | remote descriptor. | | | | | | | If the value is | If the value is | | | supported by the | supported by the | | | IMS-AGW for | IMS-AGW for | | | receiving media, the | receiving media, the | | | IMS-ALG should keep | IMS-ALG should keep | | | the value from the | the value from the | | | received SDP offer | received SDP answer | | | unchanged in the SDP | unchanged in the SDP | | | offer it sends. If | answer it sends. If | | | the IMS-AGW only | the IMS-AGW only | | | supports a lower | supports a lower | | | maxptime value, the | maxptime value, the | | | IMS-ALG shall supply | IMS-ALG shall supply | | | the maxptime value | the maxptime value | | | according to the | according to the | | | IMS-AGW capabilities | IMS-AGW capabilities | | | in the SDP offer it | in the SDP answer it | | | forwards. If no | forwards. If no | | | maxptime value was | maxptime value was | | | contained in the | contained in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG may add | the IMS-ALG may add | | | the parameter with a | the parameter with a | | | value according to | value according to | | | the IMS-AGW | the IMS-AGW | | | capabilities to the | capabilities to the | | | SDP offer. | SDP answer. | +----------------------+----------------------+----------------------+ | NOTE: This SDP | | | | attribute is defined | | | | in | | | | I | | | | ETF RFC 4566 [53]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | +----------------------+----------------------+----------------------+
Table 5.13.2.2 describes the IMS-AGW handling of codec related parameters
applicable to multiple codecs.
Table 5.13.2.2: IMS-AGW handling of common codec parameters
* * *
Parameter Handling in local descriptor Handling in remote descriptor ptime
(NOTE) The IMS-AGW should expect to receive packets with this ptime value and
may use this information when deciding upon the required resources. The IMS-
AGW should use this ptime value when sending packets. maxptime (NOTE) The IMS-
AGW should expect to receive packets with this maxptime value and may use this
information when deciding upon the required resources. The IMS-AGW shall use
this maxptime value when sending packets. NOTE: This SDP attribute is defined
in IETF RFC 4566 [53]. It applies to all codecs offered in an SDP media line.
* * *
### 5.13.3 Handling of the EVS speech codec
The Enhanced Voice Services (EVS) speech codec is defined in 3GPP TS 26.441
[51]. Its RTP payload type is defined in 3GPP TS 26.445 [52], and procedures
for its usage as IMS Multimedia Telephony speech codec are defined in 3GPP TS
26.114 [21].
The IMS-ALG and the IMS-AGW may support transcoding to and from the EVS speech
codec. If they do so, the procedures in the present clause apply.
When receiving an SDP offer, the IMS-ALG may add an EVS codec payload type
before forwarding the SDP offer (denoted as \"codec 3\" in figures 10.2.5.1
and 10.2.5.2 of 3GPP TS 29.162 [20]). If that EVS payload type is selected in
the SDP answer, the IMS-ALG needs to transcode the EVS codec. Table 5.13.3.1
describes the IMS-ALG handling of EVS codec parameters when the IMS-ALG adds
the EVS payload type to the SDP offer, and that EVS payload type is selected
in the SDP answer. In addition, rules for the parameter handling in 3GPP TS
26.445 [52] shall apply.
Table 5.13.3.1: IMS-ALG handling of EVS related SDP parameters when the IMS-
ALG adds the EVS payload type to the SDP offer.
+----------------------+----------------------+----------------------+ | Parameter | Handling for EVS | Handling if offered | | | payload type added | EVS payload type is | | | to the SDP offer to | accepted in the SDP | | | offer transcoding | answer | +----------------------+----------------------+----------------------+ | evs-mode-switch | If the IMS-ALG | If the | | (NOTE 1) | expects that | evs-mode-switch | | | interworking between | parameter is | | | AMR-WB and EVS is | contained in the SDP | | | required (e.g. | answer, the IMS-ALG | | | because AMR-WB was | shall forward this | | | the first payload | parameter to the | | | type in the received | IMS-AGW for the | | | SDP offer), it shall | termination towards | | | include the | the answerer in the | | | evs-mode-switch with | remote descriptor. | | | value 1. Otherwise | | | | the IMS-ALG shall | | | | not include the | | | | evs-mode-switch. | | +----------------------+----------------------+----------------------+ | hf-only (NOTE 1) | If the IMS-ALG is | If the hf-only | | | configured to | parameter is | | | negotiate using only | contained in the SDP | | | the header-full EVS | answer, the IMS-ALG | | | RTP payload format, | shall forward this | | | the IMS-ALG shall | parameter to the | | | include the hf-only | IMS-AGW in the | | | parameter with a | remote descriptor. | | | value 1. | | +----------------------+----------------------+----------------------+ | dtx (NOTE 1) | If the usage of DTX | If the dtx parameter | | | is not desired in | is contained in the | | | the sending and | SDP answer, the | | | receiving direction | IMS-ALG shall | | | (e.g. due to DTX | forward this | | | capabilities of | parameter to the | | | expected codecs to | IMS-AGW in the | | | transcode with, e.g. | remote descriptor. | | | other codecs in the | | | | received SDP offer), | | | | the IMS-ALG shall | | | | include the dtx | | | | parameter with a | | | | value 0. | | +----------------------+----------------------+----------------------+ | dtx-recv (NOTE 1) | If receiving DTX is | If the dtx-recv | | | not desired and the | parameter is | | | dtx parameter is not | contained in the SDP | | | included, the | answer, the IMS-ALG | | | IMS-ALG shall | shall forward this | | | include the dtx-recv | parameter to the | | | parameter with a | IMS-AGW in the | | | value 0. | remote descriptor. | | | | | | | If both the dtx and | | | | dtx-recv parameters | | | | are included, those | | | | parameters shall | | | | have the same value; | | | | however, inclusion | | | | of the dtx-recv | | | | parameter is not | | | | required if the dtx | | | | parameter is | | | | included. | | +----------------------+----------------------+----------------------+ | **br** (NOTE 1) | If the IMS-ALG | If the br parameter | | | desires the same bit | is contained in the | | | rate range for the | SDP answer, the | | | send and receive | IMS-ALG shall | | | direction in EVS | forward this | | | primary mode, and | parameter to the | | | wants to restrict | IMS-AGW in the | | | the bit rate range | remote descriptor. | | | to match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the br | | | | parameter in the SDP | | | | offer it sends. | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw, | | | | bw-send or bw-recv | | | | parameter, the value | | | | of the br parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | +----------------------+----------------------+----------------------+ | br-send (NOTE 1) | If the IMS-ALG | If the br-send | | | desires a different | parameter is | | | bit rate (range) for | contained in the SDP | | | the send and receive | answer, the IMS-ALG | | | direction in EVS | shall forward this | | | primary mode, and | parameter to the | | | wants to restrict | IMS-AGW in the | | | the bit rate range | remote descriptor. | | | for the send | | | | direction to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-send parameter in | | | | the SDP offer it | | | | sends. Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-send parameter, | | | | the value of the | | | | br-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | +----------------------+----------------------+----------------------+ | br-recv (NOTE 1) | If the IMS-ALG | If the br-recv | | | desires a different | parameter is | | | bit rate (range) for | contained in the SDP | | | the send and receive | answer, the IMS-ALG | | | direction in EVS | shall forward this | | | primary mode, and | parameter to the | | | wants to restrict | IMS-AGW in the | | | the bit rate range | remote descriptor. | | | for the receive | | | | direction to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-recv parameter in | | | | the SDP offer it | | | | sends. Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-recv parameter, | | | | the value of the | | | | br-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | +----------------------+----------------------+----------------------+ | bw (NOTE 1) | If the IMS-ALG | If the bw parameter | | | desires the same | is contained in the | | | sampling | SDP answer, the | | | bandwidth(s) for the | IMS-ALG shall | | | send and receive | forward this | | | direction in EVS | parameter to the | | | primary mode, and | IMS-AGW in the | | | wants to restrict | remote descriptor. | | | the sampling | | | | bandwidths to match | | | | IMS-AGW | | | | capabilities, | | | | sampling bandwidths | | | | of expected codecs | | | | EVS will be | | | | transcoded to (e.g. | | | | the first payload | | | | type in the received | | | | SDP offer), and | | | | possible configured | | | | policies, it shall | | | | supply the bw | | | | parameter in the SDP | | | | offer it sends. | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | +----------------------+----------------------+----------------------+ | bw-send (NOTE 1) | If the IMS-ALG | If the bw-send | | | desires different | parameter is | | | sampling bandwidths | contained in the SDP | | | for the send and | answer, the IMS-ALG | | | receive direction in | shall forward this | | | EVS primary mode, | parameter to the | | | and wants to | IMS-AGW in the | | | restrict the | remote descriptor. | | | sampling bandwidths | | | | in the send | | | | direction to match | | | | IMS-AGW | | | | capabilities, | | | | sampling bandwidths | | | | of expected codecs | | | | EVS will be | | | | transcoded to (e.g. | | | | the first payload | | | | type in the received | | | | SDP offer) and | | | | possible configured | | | | policies, it shall | | | | supply the bw-send | | | | parameter in the SDP | | | | offer it sends. | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | +----------------------+----------------------+----------------------+ | bw-recv (NOTE 1) | If the IMS-ALG | If the bw-recv | | | desires different | parameter is | | | sampling bandwidths | contained in the SDP | | | for the send and | answer, the IMS-ALG | | | receive direction in | shall forward this | | | EVS primary mode, | parameter to the | | | and wants to | IMS-AGW in the | | | restrict the | remote descriptor. | | | sampling bandwidths | | | | in the receive | | | | direction to match | | | | IMS-AGW | | | | capabilities, | | | | sampling bandwidths | | | | of expected codecs | | | | EVS will be | | | | transcoded to (e.g. | | | | the first payload | | | | type in the received | | | | SDP offer), and | | | | possible configured | | | | policies, it shall | | | | supply the bw-recv | | | | parameter in the SDP | | | | offer it sends. | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | +----------------------+----------------------+----------------------+ | cmr (NOTE 1) | If the IMS-ALG | If the cmr parameter | | | desires to disable | is contained in the | | | codec mode requests | SDP answer, the | | | within the RTP | IMS-ALG shall | | | payload of the EVS | forward this | | | primary mode (due to | parameter to the | | | the IMS-AGW | IMS-AGW in the | | | capabilities or | remote descriptor. | | | policies), it shall | | | | include the cmr | | | | parameter with value | | | | -1 in the SDP offer | | | | it sends. | | +----------------------+----------------------+----------------------+ | ch-aw-recv (NOTE 1) | The IMS-ALG shall | If the ch-aw-recv | | | include the | parameter is | | | ch-aw-recv parameter | contained in the SDP | | | in the SDP offer if | answer, the IMS-ALG | | | it desires to | shall forward this | | | control the | parameter to the | | | channel-aware mode | IMS-AGW in the | | | of EVS in the | remote descriptor. | | | receive direction, | | | | e.g. to disable it | | | | with value -1. The | | | | IMS-ALG shall | | | | consider the | | | | capabilities of the | | | | IMS-AGW when it | | | | chooses an | | | | appropriate value. | | +----------------------+----------------------+----------------------+ | number of channels | The IMS-ALG shall | If the \"number of | | (NOTE 2) | only include the | channels\" parameter | | | \"number of | is contained in the | | | channels\" parameter | SDP answer, the | | | in the SDP offer if | IMS-ALG shall | | | it desires to send | forward this | | | or receive multiple | parameter to the | | | channels. If the | IMS-AGW in the | | | desired number of | remote descriptor. | | | channels in the send | | | | and receive | | | | direction differs, | | | | the IMS-ALG shall | | | | include the higher | | | | value. The IMS-ALG | | | | should consider the | | | | number of channels | | | | of expected codecs | | | | EVS will be | | | | transcoded to (e.g. | | | | the first payload | | | | type in the received | | | | SDP offer). | | +----------------------+----------------------+----------------------+ | ch-send (NOTE 1) | The IMS-ALG shall | If the ch-send | | | only include the | parameter is | | | ch-send parameter in | contained in the SDP | | | the SDP offer if it | answer, the IMS-ALG | | | desires to send | shall forward this | | | multiple channels, | parameter to the | | | with different | IMS-AGW in the | | | numbers of channels | remote descriptor. | | | in the send and | | | | receive direction. | | | | The IMS-ALG should | | | | consider the number | | | | of channels of | | | | expected codecs EVS | | | | will be transcoded | | | | to (e.g. the first | | | | payload type in the | | | | received SDP offer). | | +----------------------+----------------------+----------------------+ | ch-recv (NOTE 1) | The IMS-ALG shall | If the ch-recv | | | only include the | parameter is | | | ch-recv parameter in | contained in the SDP | | | the SDP offer if it | answer, the IMS-ALG | | | desires to receive | shall forward this | | | multiple channels, | parameter to the | | | with different | IMS-AGW in the | | | numbers of channels | remote descriptor. | | | in the send and | | | | receive direction. | | | | The IMS-ALG should | | | | consider the number | | | | of channels of | | | | expected codecs EVS | | | | will be transcoded | | | | to (e.g. the first | | | | payload type in the | | | | received SDP offer). | | +----------------------+----------------------+----------------------+ | mode-set (NOTE 3) | The IMS-ALG shall | If the mode-set | | | only include the | parameter is | | | mode-set parameter | contained in the SDP | | | in the SDP offer if | answer, the IMS-ALG | | | it desires to | shall forward this | | | restrict the | parameter to the | | | mode-set of AMR-WB | IMS-AGW in the | | | IO mode. The IMS-ALG | remote descriptor. | | | should only restrict | | | | the mode-set if the | If the IMS-ALG | | | expected codec EVS | decides that EVS | | | will be interworked | will be transcoded | | | with (e.g. the first | to AMR-WB, the | | | payload type in the | IMS-ALG should | | | received SDP offer) | include the mode-set | | | is AMR-WB and has a | parameter for the | | | restricted mode-set. | AMR-WB payload in | | | | the SDP offer it | | | | forwards if this is | | | | permissible by | | | | AMR-WB offer answer | | | | rules in | | | | I | | | | ETF RFC 4867 [54]. | +----------------------+----------------------+----------------------+ | mode-change-period | The IMS-ALG shall | If the | | (NOTE 3) | only include the | mode-change-period | | | mode-change-period | parameter is | | | parameter with value | contained in the SDP | | | 2 in the SDP offer | answer, the IMS-ALG | | | if it desires to | shall forward this | | | restrict the | parameter to the | | | mode-change-period | IMS-AGW in the | | | of received packets | remote descriptor. | | | in AMR-WB IO mode. | | | | The IMS-ALG should | If the IMS-ALG | | | only restrict the | decides that EVS | | | mode-change-period | will be transcoded | | | if the expected | to AMR-WB, the | | | codec EVS will be | IMS-ALG should | | | interworked with | include the | | | (e.g. the first | mode-change-period | | | payload type in the | parameter for the | | | received SDP offer) | AMR-WB payload in | | | is AMR-WB and has | the SDP offer it | | | such a restriction. | forwards. | +----------------------+----------------------+----------------------+ | mo | The IMS-ALG shall | If the | | de-change-capability | include the | mo | | (NOTE 3) | mo | de-change-capability | | | de-change-capability | parameter is | | | parameter with value | contained in the SDP | | | 2 in the SDP offer | answer, the IMS-ALG | | | if it is capable of | may forward this | | | restricting the | parameter to the | | | mode-change-period | IMS-AGW in the | | | of packets it sends | remote descriptor. | | | in AMR-WB IO mode. | | | | The IMS-ALG should | If the IMS-ALG | | | consider the | decides that EVS | | | mode-change-period | will be transcoded | | | of the expected | to AMR-WB, the | | | codec EVS will be | IMS-ALG should | | | interworked with | include the | | | (e.g. the first | mo | | | payload type in the | de-change-capability | | | received SDP offer) | parameter for the | | | if this is AMR-WB. | AMR-WB payload in | | | | the SDP offer it | | | | forwards. | +----------------------+----------------------+----------------------+ | mode-change-neighbor | The IMS-ALG shall | If the | | (NOTE 3) | only include the | mode-change-neighbor | | | mode-change-neighbor | parameter is | | | parameter in the SDP | contained in the SDP | | | offer if it desires | answer, the IMS-ALG | | | to restrict the | shall forward this | | | mode-change within | parameter to the | | | received packets of | IMS-AGW in the | | | AMR-WB IO mode to | remote descriptor. | | | neighboring modes. | | | | The IMS-ALG should | If the IMS-ALG | | | consider the | decides that EVS | | | mode-change-neighbor | will be transcoded | | | parameter of the | to AMR-WB, the | | | expected codec EVS | IMS-ALG should | | | will be interworked | include the | | | with (e.g. the first | mode-change-neighbor | | | payload type in the | parameter for the | | | received SDP offer) | AMR-WB payload in | | | if this is AMR-WB. | the SDP offer it | | | | forwards. | +----------------------+----------------------+----------------------+ | max-red (NOTE 5) | The IMS-ALG shall | If the max-red | | | only include the | parameter is | | | max-red parameter in | contained in the SDP | | | the SDP offer if it | answer, the IMS-ALG | | | desires to restrict | shall forward this | | | the maximum | parameter to the | | | redundancy of | IMS-AGW in the | | | received packets. | remote descriptor. | | | IMS-ALG shall | | | | consider the | If the IMS-ALG | | | capabilities of the | decides that EVS | | | IMS-AGW, and should | will be interworked | | | consider the max-red | with AMR-WB, the | | | parameter of the | IMS-ALG should | | | expected codec EVS | include the max-red | | | will be interworked | parameter for the | | | with (e.g. the first | AMR-WB payload in | | | payload type in the | the SDP offer it | | | received SDP offer) | forwards. | | | if this is AMR-WB. | | +----------------------+----------------------+----------------------+ | 3g | If the IMS-AGW | If the | | pp_mtsi_app_adapt | supports RTCP APP | 3g | | (NOTE 4) | based adaptation | pp_mtsi_app_adapt | | | messages defined in | attribute is | | | 3G | contained in the SDP | | | PP TS 26.114 [21], | answer, the IMS-ALG | | | and the IMS-ALG has | shall forward this | | | a policy to | parameter to the | | | negotiate the usage | IMS-AGW in the | | | of those messages, | remote descriptor. | | | the IMS-ALG shall | | | | include the | | | | 3g | | | | pp_mtsi_app_adapt | | | | SDP attribute | | | | indicating the | | | | supported APP | | | | messages in the SDP | | | | offer. | | +----------------------+----------------------+----------------------+ | NOTE 1: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | 3G | | | | PP TS 26.445 [51]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 2: This number | | | | of channels are | | | | encoded as | | | | \"encoding | | | | parameters\" of the | | | | SDP \"a=rtpmap\" | | | | attribute defined in | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 3: This MIME | | | | parameter of the EVS | | | | RTP payload type | | | | relates to AMR-WB IO | | | | mode and is defined | | | | in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 4: This SDP | | | | attribute is defined | | | | in | | | | 3G | | | | PP TS 26.114 [21]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | | However, some values | | | | are specific to EVS. | | | | | | | | NOTE 5: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | +----------------------+----------------------+----------------------+
When receiving an SDP offer that contains an EVS codec payload type (denoted
as \"codec 1\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]), the IMS-ALG may add
other payload types before forwarding the SDP offer (denoted as \"codec 3\" in
figure 10.2.5.2 of 3GPP TS 29.162 [20]). If that added payload type is
selected in the SDP answer, the IMS-ALG needs to transcode, and may select to
transcode to the EVS codec. Table 5.13.3.2 describes the IMS-ALG handling of
EVS codec parameters when the IMS-ALG receives an EVS payload type in an SDP
offer, and selects to transcode between the EVS codec and some other codec. In
addition, rules for the parameter handling in 3GPP TS 26.445 [52] shall apply.
Table 5.13.3.2: IMS-ALG handling of EVS related SDP parameters when the IMS-
ALG receives the EVS payload type in the SDP offer and decides to transcode
between the EVS payload type and some other codec.
+----------------------+----------------------+----------------------+ | Parameter | Handling of EVS | EVS payload type | | | payload type | supplied in the SDP | | | parameter received | answer | | | in the SDP offer | | +----------------------+----------------------+----------------------+ | evs-mode-switch | If the | If the | | (NOTE 1) | evs-mode-switch | evs-mode-switch | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | offer, the IMS-ALG | | | IMS-ALG select the | shall include the | | | EVS payload type for | evs-mode-switch | | | transcoding, the | parameter with | | | IMS-ALG shall | unmodified value in | | | forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-ALG decides to | | | the offerer in the | interwork between | | | remote descriptor. | AMR-WB and EVS (e.g. | | | | because AMR-WB was | | | | selected in the | | | | received SDP | | | | answer), it shall | | | | include the | | | | evs-mode-switch with | | | | value 1. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the | | | | evs-mode-switch. | | | | | | | | If the IMS-ALG | | | | supplies the | | | | evs-mode-switch in | | | | the SDP answer, it | | | | shall also supply it | | | | to the IMS-AGW in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | hf-only (NOTE 1) | If the hf-only | If the hf-only | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | offer, the IMS-ALG | | | IMS-ALG select the | shall include the | | | EVS payload type for | hf-only parameter | | | transcoding, the | with unmodified | | | IMS-ALG shall | value in the SDP | | | forward this | answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-ALG is | | | the offerer in the | configured to | | | remote descriptor. | negotiate using only | | | | the header-full EVS | | | | RTP payload format, | | | | the IMS-ALG shall | | | | include the hf-only | | | | parameter with a | | | | value 1. | | | | | | | | If the IMS-ALG | | | | supplies the hf-only | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | dtx (NOTE 1) | If the dtx parameter | If the dtx parameter | | | is contained in the | is contained in the | | | SDP offer and the | SDP offer, the | | | IMS-ALG select the | IMS-ALG shall | | | EVS payload type for | include the dtx | | | transcoding, the | parameter with | | | IMS-ALG shall | unmodified value in | | | forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | If the dtx parameter | | | termination towards | is not contained in | | | the offerer in the | the SDP offer and if | | | remote descriptor. | a dtx-recv parameter | | | | is contained in the | | | | SDP offer, the | | | | IMS-ALG may include | | | | the dtx parameter in | | | | the SDP answer, and | | | | the value of the dtx | | | | parameter shall then | | | | be identical to that | | | | of the dtx-recv | | | | parameter in the SDP | | | | offer (e.g, if that | | | | value matches DTX | | | | capabilities of | | | | expected codecs to | | | | transcode with). | | | | | | | | If the dtx parameter | | | | is not contained in | | | | the SDP offer and if | | | | the dtx-recv | | | | parameter is not | | | | contained in the SDP | | | | offer, and if the | | | | usage of DTX is not | | | | desired (e.g. due to | | | | DTX capabilities of | | | | expected codecs to | | | | transcode with, e.g. | | | | other codecs in the | | | | received SDP | | | | answer), the IMS-ALG | | | | shall include in the | | | | SDP answer the dtx | | | | parameter with a | | | | value 0. | | | | | | | | If the IMS-ALG | | | | supplies the dtx | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | dtx-recv (NOTE 1) | If the dtx-recv | If no dtx parameter | | | parameter is | is included in the | | | contained in the SDP | SDP answer and if | | | offer and the | the reception of DTX | | | IMS-ALG select the | is not desired, the | | | EVS payload type for | IMS-ALG shall | | | transcoding, the | include in the SDP | | | IMS-ALG shall | answer the dtx-recv | | | forward this | parameter with a | | | parameter to the | value 0. | | | IMS-AGW for the | | | | termination towards | If both the dtx and | | | the offerer in the | dtx-recv parameters | | | remote descriptor. | are included, those | | | | parameters shall | | | | have the same value; | | | | however, inclusion | | | | of the dtx-recv | | | | parameter is not | | | | required if the dtx | | | | parameter is | | | | included. | | | | | | | | If the IMS-ALG | | | | supplies the | | | | dtx-recv parameter | | | | in the SDP answer, | | | | it should also | | | | supply it to the | | | | IMS-AGW in the local | | | | descriptor for the | | | | termination towards | | | | the offerer with the | | | | same value. | +----------------------+----------------------+----------------------+ | **br** (NOTE 1) | If the br parameter | If the br parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP offer, the | | | IMS-ALG shall check | IMS-ALG shall select | | | if the IMS-AGW | a bitrate value, | | | supports the | which is either the | | | indicated bitrates, | received br value or | | | or a subset of them, | a subset of it, | | | in EVS primary mode | based on IMS-AGW | | | in the send and | capabilities and | | | receive direction. | possible configured | | | If the indicated | policies, and shall | | | bitrates, and even | include the br | | | each subset of them, | parameter with the | | | are not supported, | selected value that | | | the IMS-ALG shall | is also supplied | | | not select the EVS | towards the IMS-AGW | | | payload type for | in the SDP answer. | | | transcoding. If the | | | | IMS-ALG selects the | Otherwise, if the | | | EVS payload type, it | IMS-ALG desires the | | | shall forward this | same bit rate range | | | parameter to the | for the send and | | | IMS-AGW for the | receive direction in | | | termination towards | EVS primary mode, | | | the offerer in the | and wants to | | | remote descriptor. | restrict the bit | | | | rate range to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br parameter in the | | | | SDP answer it sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw, | | | | bw-send or bw-recv | | | | parameter, the value | | | | of the br parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the br | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | br-send (NOTE 1) | If the br-send | If the br-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | bitrate value, which | | | indicated bitrates, | is either the | | | or a subset of them, | received br-recv | | | in EVS primary mode | value or a subset of | | | in the receive | it, based on IMS-AGW | | | direction. If the | capabilities and | | | indicated bitrates, | possible configured | | | and even each subset | policies, and shall | | | of them, are not | include the br-send | | | supported, the | parameter with the | | | IMS-ALG shall not | selected value that | | | select the EVS | is also supplied | | | payload type for | towards the IMS-AGW | | | transcoding. If the | in the SDP answer. | | | IMS-ALG selects the | | | | EVS payload type, it | Otherwise, if the | | | shall forward this | IMS-ALG desires a | | | parameter to the | different bit rate | | | IMS-AGW for the | (range) for the send | | | termination towards | and receive | | | the offerer in the | direction in EVS | | | remote descriptor. | primary mode, and | | | | wants to restrict | | | | the bit rate range | | | | for the send | | | | direction to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-send parameter in | | | | the SDP answer it | | | | sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the br-send | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-send parameter, | | | | the value of the | | | | br-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br-send | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the br-send | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | br-recv (NOTE 1) | If the br-recv | If the br-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | bitrate value, which | | | indicated bitrates, | is either the | | | or a subset of them, | received br-send | | | in EVS primary mode | value or a subset of | | | in the send | it, based on IMS-AGW | | | direction. If the | capabilities and | | | indicated bitrates, | possible configured | | | and even each subset | policies, and shall | | | of them, are not | include the br-recv | | | supported, the | parameter with the | | | IMS-ALG shall not | selected value that | | | select the EVS | is also supplied | | | payload type for | towards the IMS-AGW | | | transcoding. If the | in the SDP answer. | | | IMS-ALG selects the | | | | EVS payload type, it | Otherwise, if the | | | shall forward this | IMS-ALG desires a | | | parameter to the | different bit rate | | | IMS-AGW for the | (range) for the send | | | termination towards | and receive | | | the offerer in the | direction in EVS | | | remote descriptor. | primary mode, and | | | | wants to restrict | | | | the bit rate range | | | | for the receive | | | | direction to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-recv parameter in | | | | the SDP answer it | | | | sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the br-recv | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-recv parameter, | | | | the value of the | | | | br-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br-recv | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the br-recv | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | bw (NOTE 1) | If the bw parameter | If the bw parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP offer, the | | | IMS-ALG shall check | IMS-ALG shall select | | | if the IMS-AGW | a sampling bandwidth | | | supports the | value, which is | | | indicated sampling | either the received | | | bandwidth(s), or a | bw value or a subset | | | subset of them, in | of it, based on | | | EVS primary mode in | IMS-AGW capabilities | | | the send and receive | and possible | | | direction. If the | configured policies, | | | indicated sampling | and shall include | | | bandwidth(s), and | the bw parameter | | | even each subset of | with the selected | | | them, are not | value that is also | | | supported, the | supplied towards the | | | IMS-ALG shall not | IMS-AGW in the SDP | | | select the EVS | answer. | | | payload type for | | | | transcoding. If the | Otherwise, if the | | | IMS-ALG selects the | IMS-ALG desires the | | | EVS payload type, it | same sampling | | | shall forward this | bandwidth(s) for the | | | parameter to the | send and receive | | | IMS-AGW for the | direction in EVS | | | termination towards | primary mode, and | | | the offerer in the | wants to restrict | | | remote descriptor. | the sampling | | | | bandwidth(s) to | | | | match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the bw | | | | parameter in the SDP | | | | answer it sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the br, | | | | br-send or br-recv | | | | parameter, the value | | | | of the bw parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the bw | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | bw-send (NOTE 1) | If the bw-send | If the bw-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | sampling bandwidths | | | indicated sampling | value, which is | | | bandwidths, or a | either the received | | | subset of them, in | bw-recv value or a | | | EVS primary mode in | subset of it, based | | | the receive | on IMS-AGW | | | direction. If the | capabilities and | | | indicated sampling | possible configured | | | bandwidths, and even | policies, and shall | | | each subset of them, | include the bw-send | | | are not supported, | parameter with the | | | the IMS-ALG shall | selected value in | | | not select the EVS | the SDP answer. | | | payload type for | | | | transcoding. If the | Otherwise, if the | | | IMS-ALG selects the | IMS-ALG desires | | | EVS payload type, it | different sampling | | | shall forward this | bandwidths for the | | | parameter to the | send and receive | | | IMS-AGW for the | direction in EVS | | | termination towards | primary mode, and | | | the offerer in the | wants to restrict | | | remote descriptor. | the sampling | | | | bandwidths for the | | | | send direction to | | | | match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the bw-send | | | | parameter in the SDP | | | | answer it sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the br-send | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-send parameter, | | | | the value of the | | | | br-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw-send | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the bw-send | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | bw-recv (NOTE 1) | If the br-recv | If the bw-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | sampling bandwidths | | | indicated sampling | value, which is | | | bandwidths, or a | either the received | | | subset of them, in | bw-send value or a | | | EVS primary mode in | subset of it, based | | | the send direction. | on IMS-AGW | | | If the indicated | capabilities and | | | sampling bandwidths, | possible configured | | | and even each subset | policies, and shall | | | of them, are not | include the bw-recv | | | supported, the | parameter with the | | | IMS-ALG shall not | selected value in | | | select the EVS | the SDP answer. | | | payload type for | | | | transcoding. If the | Otherwise, if the | | | IMS-ALG selects the | IMS-ALG desires a | | | EVS payload type, it | different sampling | | | shall forward the | bandwidths for the | | | bw-recv parameter to | send and receive | | | the IMS-AGW for the | direction in EVS | | | termination towards | primary mode, and | | | the offerer in the | wants to restrict | | | remote descriptor. | the sampling | | | | bandwidths for the | | | | receive direction to | | | | match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the bw-recv | | | | parameter in the SDP | | | | answer it sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the bw-recv | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the br or | | | | br-recv parameter, | | | | the value of the | | | | bw-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw-send | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | cmr (NOTE 1) | If the cmr parameter | If the cmr parameter | | | is contained in the | is contained in the | | | SDP offer and the | SDP offer, the | | | IMS-ALG select the | IMS-ALG shall | | | EVS payload type for | include the cmr | | | transcoding, the | parameter with | | | IMS-ALG shall | unmodified value in | | | forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-AGW desires to | | | the offerer in the | disable codec mode | | | remote descriptor. | requests within the | | | | RTP payload of the | | | | EVS primary mode | | | | (due to the IMS-AGW | | | | capabilities or | | | | policies), it shall | | | | include the cmr | | | | parameter with value | | | | -1 in the SDP answer | | | | it sends | | | | | | | | If the IMS-ALG | | | | supplies the cmr | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | ch-aw-recv (NOTE 1) | If the ch-aw-recv | If the IMS-ALG it | | | parameter is | desires to control | | | contained in the SDP | the channel-aware | | | offer the IMS-ALG | mode of EVS in the | | | shall check if the | receive direction, | | | IMS-AGW supports the | e.g. to disable it | | | indicated mode in | with value -1, it | | | the send direction. | shall include the | | | If the indicated | ch-aw-recv parameter | | | mode is not | in the SDP offer and | | | supported, the | shall also supply | | | IMS-ALG shall not | the ch-aw-recv | | | select the EVS | parameter to the | | | payload type for | IMS-AGW in the local | | | transcoding. If the | descriptor for the | | | IMS-ALG selects the | termination towards | | | EVS payload type for | the offerer with the | | | transcoding, the | same value. The | | | IMS-ALG shall | IMS-ALG shall | | | forward this | consider the | | | parameter to the | capabilities of the | | | IMS-AGW for the | IMS-AGW when it | | | termination towards | chooses an | | | the offerer in the | appropriate value. | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | number of channels | If the \"number of | If the \"number of | | (NOTE 2) | channels\" parameter | channels\" parameter | | | is contained in the | is contained in the | | | SDP offer the | SDP offer, the | | | IMS-ALG shall check | IMS-ALG shall | | | if the IMS-AGW | include the \"number | | | supports the | of channels\" | | | indicated number of | parameter with | | | channels. If the | unmodified value in | | | indicated number of | the SDP answer and | | | channels is not | shall also supply it | | | supported, the | to the IMS-AGW in | | | IMS-ALG shall not | the local descriptor | | | select the EVS | for the termination | | | payload type for | towards the offerer | | | transcoding. If the | with the same value. | | | IMS-ALG selects the | | | | EVS payload type for | | | | transcoding, the | | | | IMS-ALG shall | | | | forward this | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | ch-send (NOTE 1) | If the ch-send | If the ch-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall include the | | | IMS-AGW supports the | ch-send parameter | | | indicated number of | with unmodified | | | channels in the | value in the SDP | | | receive direction. | answer and shall | | | If the indicated | also supply the | | | number of channels | ch-send parameter to | | | is not supported, | the IMS-AGW in the | | | the IMS-ALG shall | local descriptor for | | | not select the EVS | the termination | | | payload type for | towards the offerer | | | transcoding. If the | with the same value. | | | IMS-ALG selects the | | | | EVS payload type for | | | | transcoding, the | | | | IMS-ALG shall | | | | forward the ch-send | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | ch-recv (NOTE 1) | If the ch-recv | If the ch-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall include the | | | IMS-AGW supports the | ch-recv parameter | | | indicated number of | with unmodified | | | channels in the send | value in the SDP | | | direction. If the | answer and shall | | | indicated number of | also supply the | | | channels is not | ch-recv parameter to | | | supported, the | the IMS-AGW in the | | | IMS-ALG shall not | local descriptor for | | | select the EVS | the termination | | | payload type for | towards the offerer | | | transcoding. If the | with the same value. | | | IMS-ALG selects the | | | | EVS payload type for | | | | transcoding, the | | | | IMS-ALG shall | | | | forward the ch-recv | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | mode-set (NOTE 3) | If the mode-set | If the mode-set | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | offer, the IMS-ALG | | | IMS-ALG select the | shall include the | | | EVS payload type for | mode-set parameter | | | transcoding, the | with unmodified | | | IMS-ALG shall | value in the SDP | | | forward this | answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | mode-set parameter | | | the offerer in the | is contained in the | | | remote descriptor. | SDP answer for an | | | | AMR-WB payload type | | | If the mode-set | and the IMS-ALG | | | parameter is | decides that the EVS | | | contained in the SDP | codec will be | | | offer and the | interworked with | | | IMS-ALG expects that | that AMR-WB payload | | | EVS will be | type, the IMS-ALG | | | interworked with | should include that | | | AMR-WB (e.g. if EVS | mode-set parameter | | | is the first payload | for the EVS payload | | | type in the received | in the SDP offer it | | | SDP offer, and the | forwards. | | | IMS-ALG adds a | | | | AMR-WB payload | If the IMS-ALG | | | type), the IMS-ALG | supplies the | | | should include the | mode-set parameter | | | mode-set parameter | in the SDP answer, | | | with the same value | it shall also supply | | | for the AMR-WB | it to the IMS-AGW in | | | payload in the SDP | the local descriptor | | | offer it forwards. | for the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | mode-change-period | If the | If the | | (NOTE 3) | mode-change-period | mode-change-period | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | answer for the | | | IMS-ALG select the | AMR-WB payload type | | | EVS payload type for | and the IMS-ALG | | | transcoding, the | decides the EVS | | | IMS-ALG shall | codec will be | | | forward this | interworked with | | | parameter to the | that AMR-WB payload | | | IMS-AGW for the | type, the IMS-ALG | | | termination towards | should include the | | | the offerer in the | mode-change-period | | | remote descriptor. | parameter for the | | | | EVS payload in the | | | If the | SDP offer it | | | mode-change-period | forwards. | | | parameter is | | | | contained in the SDP | If the IMS-ALG | | | offer and the | supplies the | | | IMS-ALG expects that | mode-change-period | | | EVS will be | parameter in the SDP | | | interworked with | answer, it shall | | | AMR-WB (e.g. if EVS | also supply it to | | | is the first payload | the IMS-AGW in the | | | type in the received | local descriptor for | | | SDP offer, and the | the termination | | | IMS-ALG adds the | towards the offerer | | | AMR-WB payload | with the same value. | | | type), the IMS-ALG | | | | should include the | | | | mode-change-period | | | | parameter with the | | | | same value for the | | | | AMR-WB payload type | | | | in the SDP offer it | | | | forwards. | | +----------------------+----------------------+----------------------+ | mo | If the | If the IMS-ALG | | de-change-capability | mo | decides that the EVS | | (NOTE 3) | de-change-capability | codec is selected, | | | parameter is | the IMS-ALG shall | | | contained in the SDP | either include the | | | offer and the | mo | | | IMS-ALG select the | de-change-capability | | | EVS payload type for | parameter with value | | | transcoding, the | 2 or omit the | | | IMS-ALG may forward | parameter for the | | | this parameter to | EVS payload in the | | | the IMS-AGW for the | SDP offer it | | | termination towards | forwards. | | | the offerer in the | | | | remote descriptor. | If the IMS-ALG | | | | supplies the | | | If the IMS-ALG | mo | | | expects that EVS | de-change-capability | | | will be interworked | parameter in the SDP | | | with AMR-WB (e.g. if | answer, it may also | | | EVS is the first | supply it to the | | | payload type in the | IMS-AGW in the local | | | received SDP offer, | descriptor for the | | | and the IMS-ALG adds | termination towards | | | the AMR-WB payload | the offerer with the | | | type), the IMS-ALG | same value. | | | should include the | | | | mo | | | | de-change-capability | | | | parameter with value | | | | 2 for the AMR-WB | | | | payload in the SDP | | | | offer it forwards. | | +----------------------+----------------------+----------------------+ | mode-change-neighbor | If the | If the | | (NOTE 3) | mode-change-neighbor | mode-change-neighbor | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | answer for the | | | IMS-ALG select the | AMR-WB payload type | | | EVS payload type for | and the IMS-ALG | | | transcoding, the | decides that the EVS | | | IMS-ALG shall | codec will be | | | forward this | interworked with | | | parameter to the | that AMR-WB payload | | | IMS-AGW for the | type, the IMS-ALG | | | termination towards | should include the | | | the offerer in the | mode-change-neighbor | | | remote descriptor. | parameter for the | | | | EVS payload in the | | | If the | SDP offer it | | | mode-change-neighbor | forwards. | | | parameter is | | | | contained in the SDP | If the IMS-ALG | | | offer and the | supplies the | | | IMS-ALG expects that | mode-change-neighbor | | | EVS will be | parameter in the SDP | | | interworked with | answer, it shall | | | AMR-WB (e.g. if EVS | also supply it to | | | is the first payload | the IMS-AGW in the | | | type in the received | local descriptor for | | | SDP offer, and the | the termination | | | IMS-ALG adds the | towards the offerer | | | AMR-WB payload | with the same value. | | | type), the IMS-ALG | | | | should include the | | | | mode-change-neighbor | | | | with the same value | | | | for the AMR-WB | | | | payload in the SDP | | | | offer it forwards. | | +----------------------+----------------------+----------------------+ | max-red (NOTE 5) | If the max-red | The IMS-ALG shall | | | parameter is | only include the | | | contained in the SDP | max-red parameter in | | | offer and the | the SDP answer if it | | | IMS-ALG select the | desires to restrict | | | EVS payload type for | the maximum | | | transcoding, the | redundancy of | | | IMS-ALG shall | received packets. | | | forward this | When selecting the | | | parameter to the | value of the max-red | | | IMS-AGW for the | parameter, the | | | termination towards | IMS-ALG shall | | | the offerer in the | consider the | | | remote descriptor. | capabilities of the | | | | IMS-AGW and, if the | | | If the max-red | max-red parameter is | | | parameter is | contained in the SDP | | | contained in the SDP | answer for the | | | offer and the | AMR-WB payload type | | | IMS-ALG expects that | and the IMS-ALG | | | EVS will be | decides that the EVS | | | interworked with | codec will be | | | AMR-WB (e.g. if EVS | interworked with | | | is the first payload | that AMR-WB payload | | | type in the received | type, the received | | | SDP offer, and the | value. | | | IMS-ALG adds the | | | | AMR-WB payload | If the IMS-ALG | | | type), the IMS-ALG | supplies the max-red | | | should include the | parameter in the SDP | | | max-red parameter | answer, it shall | | | with the same value | also supply it to | | | for the AMR-WB | the IMS-AGW in the | | | payload in the SDP | local descriptor for | | | offer it forwards | the termination | | | with a value that | towards the offerer | | | considers the | with the same value. | | | received value and | | | | the capabilities of | | | | the IMS-AGW. | | +----------------------+----------------------+----------------------+ | 3g | If the | If the IMS-AGW | | pp_mtsi_app_adapt | 3g | supports RTCP APP | | (NOTE 4) | pp_mtsi_app_adapt | based adaptation | | | parameter is | messages defined in | | | contained in the SDP | 3G | | | answer, and the | PP TS 26.114 [21], | | | IMS-ALG select the | and the IMS-ALG has | | | EVS payload type for | a policy to | | | transcoding, the | negotiate the usage | | | IMS-ALG shall | of those messages, | | | forward this | the IMS-ALG shall | | | parameter to the | include the | | | IMS-AGW the IMS-ALG | 3g | | | shall forward this | pp_mtsi_app_adapt | | | parameter to the | SDP attribute | | | IMS-AGW in the | indicating the | | | remote descriptor. | supported APP | | | | messages in the SDP | | | | answer. | +----------------------+----------------------+----------------------+ | NOTE 1: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | 3G | | | | PP TS 26.445 [51]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 2: This number | | | | of channels are | | | | encoded as | | | | \"encoding | | | | parameters\" of the | | | | SDP \"a=rtpmap\" | | | | attribute defined in | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 3: This MIME | | | | parameter of the EVS | | | | RTP payload type | | | | relates to AMR-WB IO | | | | mode and is defined | | | | in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 4: This SDP | | | | attribute is defined | | | | in | | | | 3G | | | | PP TS 26.114 [21]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | | However, some values | | | | are specific to EVS. | | | | | | | | NOTE 5: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | +----------------------+----------------------+----------------------+
Table 5.13.3.3 describes the IMS-AGW handling of EVS codec parameters. The
IMS-AGW should support transcoding of EVS with bandwidths (sampling rates)
which are supported by codec the IMS-AGW is capable to transcode EVS to/from
(e.g. NB for AMR, and WB for AMR-WB).
Table 5.13.3.3: IMS-AGW handling of EVS codec parameters
+----------------------+----------------------+----------------------+ | Parameter | Handling in local | Handling in remote | | | descriptor | descriptor | +----------------------+----------------------+----------------------+ | evs-mode-switch | The IMS-AGW should | The IMS-AGW shall | | (NOTE 1) | expect to receive | use the indicated | | | packets with the | EVS mode (e.g. | | | indicated EVS mode | AMR-WB interoperable | | | and may use this | mode for value 1) | | | information when | when sending | | | deciding upon the | packets. | | | required resources. | | +----------------------+----------------------+----------------------+ | hf-only (NOTE 1) | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | use the indicated | | | packets with the | mode (e.g. | | | indicated mode and | header-full EVS RTP | | | may use this | payload format for | | | information when | value 1) when | | | deciding upon the | sending packets. | | | required resources. | | +----------------------+----------------------+----------------------+ | dtx (NOTE 1) | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | use this dtx mode | | | packets with this | (i.e. no usage of | | | dtx mode and may use | DTX for value 0) | | | this information | when sending | | | when deciding upon | packets. (NOTE 8) | | | the required | | | | resources. (NOTE 8) | | +----------------------+----------------------+----------------------+ | dtx-recv (NOTE 1) | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | use this dtx mode | | | packets with this | (i.e. no usage of | | | dtx mode and may use | DTX for value 0) | | | this information | when sending | | | when deciding upon | packets. (NOTE 8) | | | the required | | | | resources. (NOTE 8) | | +----------------------+----------------------+----------------------+ | **br** (NOTE 1) | If different values | If different values | | | for the br parameter | for the br parameter | | | are provided in the | are provided in the | | | local and remote | local and remote | | | descriptors, one | descriptors, one | | | will be a subset of | will be a subset of | | | the other, and the | the other, and the | | | smaller range shall | smaller range shall | | | apply. | apply. | | | | | | | The IMS-AGW should | The IMS-AGW should | | | expect to receive | expect to receive | | | packets with this | packets with this | | | bitrate range and | bitrate range and | | | may use this | may use this | | | information when | information when | | | deciding upon the | deciding upon the | | | required resources. | required resources. | | | | | | | The IMS-AGW shall | The IMS-AGW shall | | | use this bitrate | use this bitrate | | | range when sending | range when sending | | | packets. | packets. | +----------------------+----------------------+----------------------+ | br-send (NOTE 1) | If different values | If different values | | | for the br-send | for the br-send | | | parameter in the | parameter in the | | | local descriptor and | remote descriptor | | | for the br-recv | and for the br-recv | | | parameter in the | parameter in the | | | remote descriptor | local descriptor are | | | are provided, one | provided, one will | | | will be a subset of | be a subset of the | | | the other, and the | other, and the | | | smaller range shall | smaller range shall | | | apply. | apply. | | | | | | | The IMS-AGW shall | The IMS-AGW should | | | use this bitrate | expect to receive | | | range when sending | packets with this | | | packets. | bitrate range and | | | | may use this | | | | information when | | | | deciding upon the | | | | required resources. | +----------------------+----------------------+----------------------+ | br-recv (NOTE 1) | If different values | If different values | | | for the br-send | for the br-send | | | parameter in the | parameter in the | | | remote descriptor | local descriptor and | | | and for the br-recv | for the br-recv | | | parameter in the | parameter in the | | | local descriptor are | remote descriptor | | | provided, one will | are provided, one | | | be a subset of the | will be a subset of | | | other, and the | the other, and the | | | smaller range shall | smaller range shall | | | apply. | apply. | | | | | | | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | use this bitrate | | | packets with this | range when sending | | | bitrate range and | packets. | | | may use this | | | | information when | | | | deciding upon the | | | | required resources. | | +----------------------+----------------------+----------------------+ | bw (NOTE 1) | If different values | If different values | | | for the bw parameter | for the bw parameter | | | are provided in the | are provided in the | | | local and remote | local and remote | | | descriptors, one | descriptors, one | | | will be a subset of | will be a subset of | | | the other, and the | the other, and the | | | smaller range shall | smaller range shall | | | apply. | apply. | | | | | | | The IMS-AGW should | The IMS-AGW should | | | expect to receive | expect to receive | | | packets with these | packets with these | | | sampling | sampling | | | bandwidth(s) and may | bandwidth(s) and may | | | use this information | use this information | | | when deciding upon | when deciding upon | | | the required | the required | | | resources. | resources. | | | | | | | The IMS-AGW shall | The IMS-AGW shall | | | use these sampling | use these sampling | | | bandwidth(s) when | bandwidth(s) when | | | sending packets. | sending packets. | +----------------------+----------------------+----------------------+ | bw-send (NOTE 1) | If different values | If different values | | | for the bw-send | for the bw-send | | | parameter in the | parameter in the | | | local descriptor and | remote descriptor | | | for the bw-recv | and for the bw-recv | | | parameter in the | parameter in the | | | remote descriptor | local descriptor are | | | are provided, one | provided, one will | | | will be a subset of | be a subset of the | | | the other, and the | other, and the | | | smaller range shall | smaller range shall | | | apply. | apply. | | | | | | | The IMS-AGW shall | The IMS-AGW should | | | use these sampling | expect to receive | | | bandwidth(s) when | packets with these | | | sending packets. | sampling | | | | bandwidth(s) and may | | | | use this information | | | | when deciding upon | | | | the required | | | | resources. | +----------------------+----------------------+----------------------+ | bw-recv (NOTE 1) | If different values | If different values | | | for the bw-send | for the bw-send | | | parameter in the | parameter in the | | | remote descriptor | local descriptor and | | | and for the bw-recv | for the bw-recv | | | parameter in the | parameter in the | | | local descriptor are | remote descriptor | | | provided, one will | are provided, one | | | be a subset of the | will be a subset of | | | other, and the | the other, and the | | | smaller range shall | smaller range shall | | | apply. | apply. | | | | | | | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | use these sampling | | | packets with these | bandwidth(s) when | | | sampling | sending packets. | | | bandwidth(s) and may | | | | use this information | | | | when deciding upon | | | | the required | | | | resources. | | +----------------------+----------------------+----------------------+ | cmr (NOTE 1) | For cmr with value | For cmr with value | | | -1 or 0, the IMS-AGW | -1 or 0, the IMS-AGW | | | should expect to | should expect to | | | receive no RTP | receive no RTP | | | packets containing | packets containing | | | codec mode requests | codec mode requests | | | for EVS primary mode | for EVS primary mode | | | and may use this | and may use this | | | information when | information when | | | deciding upon the | deciding upon the | | | required resources. | required resources. | | | | | | | For cmr with value | For cmr with value | | | -1 or 0, the IMS-AGW | -1 or 0, the IMS-AGW | | | shall also send no | shall also send no | | | RTP packets | RTP packets | | | containing codec | containing codec | | | mode requests for | mode requests for | | | EVS primary mode. | EVS primary mode. | | | | | | | Different cmr values | Different cmr values | | | in the local and | in the local and | | | remote descriptors | remote descriptors | | | are an error | are an error | | | situation, but it is | situation, but it is | | | permissible that | permissible that | | | this parameter is | this parameter is | | | only supplied in one | only supplied in one | | | of those | of those | | | descriptors. | descriptors. | +----------------------+----------------------+----------------------+ | ch-aw-recv (NOTE 1, | The IMS-AGW should | The IMS-AGW shall | | NOTE 7) | expect to receive | send RTP packets | | | RTP packets | containing the | | | containing the | indicated partial | | | indicated partial | redundancy mode. | | | redundancy mode and | | | | may use this | | | | information when | | | | deciding upon the | | | | required resources. | | +----------------------+----------------------+----------------------+ | number of channels | If no ch-recv | If no ch-recv | | (NOTE 2) | parameter in the | parameter in the | | | local descriptor and | local descriptor and | | | no ch-send parameter | no ch-send parameter | | | in the remote | in the remote | | | descriptors are | descriptors are | | | received, the | received, the | | | IMS-AGW should | IMS-AGW should | | | expect to receive | expect to receive | | | RTP packets | RTP packets | | | containing the | containing the | | | indicated number of | indicated number of | | | channels and may use | channels and may use | | | this information | this information | | | when deciding upon | when deciding upon | | | the required | the required | | | resources. | resources. | | | | | | | If no ch-send | If no ch-send | | | parameter in the | parameter in the | | | local descriptor and | local descriptor and | | | no ch-recv parameter | no ch-recv parameter | | | in the remote | in the remote | | | descriptors are | descriptors are | | | received, the | received, the | | | IMS-AGW shall also | IMS-AGW shall also | | | send RTP packets | send RTP packets | | | containing the | containing the | | | indicated number of | indicated number of | | | channels. | channels. | | | | | | | Different number of | Different number of | | | channels values in | channels values in | | | the local and remote | the local and remote | | | descriptors is an | descriptors is an | | | error situation, but | error situation, but | | | it is permissible | it is permissible | | | that this parameter | that this parameter | | | is only supplied in | is only supplied in | | | one of those | one of those | | | descriptors. | descriptors. | +----------------------+----------------------+----------------------+ | ch-send (NOTE 1) | The IMS-AGW shall | The IMS-AGW should | | | send RTP packets | expect to receive | | | containing the | RTP packets | | | indicated number of | containing the | | | channels. | indicated number of | | | | channels and may use | | | Different number of | this information | | | channels in the | when deciding upon | | | ch-send parameter in | the required | | | the local descriptor | resources. | | | and the ch-recv | | | | parameter in the | Different number of | | | remote descriptors | channels in the | | | is an error | ch-send parameter in | | | situation, but it is | the local descriptor | | | permissible that | and the ch-recv | | | this parameter is | parameter in the | | | only supplied in one | remote descriptors | | | of those | is an error | | | descriptors. | situation, but it is | | | | permissible that | | | | this parameter is | | | | only supplied in one | | | | of those | | | | descriptors. | +----------------------+----------------------+----------------------+ | ch-recv (NOTE 1) | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | send RTP packets | | | RTP packets | containing the | | | containing the | indicated number of | | | indicated number of | channels. | | | channels and may use | | | | this information | Different number of | | | when deciding upon | channels in the | | | the required | ch-send parameter in | | | resources. | the local descriptor | | | | and the ch-recv | | | Different number of | parameter in the | | | channels in the | remote descriptors | | | ch-send parameter in | is an error | | | the local descriptor | situation, but it is | | | and the ch-recv | permissible that | | | parameter in the | this parameter is | | | remote descriptors | only supplied in one | | | is an error | of those | | | situation, but it is | descriptors. | | | permissible that | | | | this parameter is | | | | only supplied in one | | | | of those | | | | descriptors. | | +----------------------+----------------------+----------------------+ | mode-set (NOTE 4) | For AMR-WB IO mode, | For AMR-WB IO mode, | | | the IMS-AGW should | the IMS-AGW should | | | expect to receive | expect to receive | | | RTP packets using | RTP packets using | | | only the indicated | only the indicated | | | mode-set and may use | mode-set and may use | | | this information | this information | | | when deciding upon | when deciding upon | | | the required | the required | | | resources. | resources. | | | | | | | The IMS-AGW shall | The IMS-AGW shall | | | also send RTP | also send RTP | | | packets only using | packets only using | | | the indicated | the indicated | | | mode-set. | mode-set. | | | | | | | Different mode-set | Different mode-set | | | values in the local | values in the local | | | and remote | and remote | | | descriptors are an | descriptors are an | | | error situation, but | error situation, but | | | it is permissible | it is permissible | | | that this parameter | that this parameter | | | is only supplied in | is only supplied in | | | one of those | one of those | | | descriptors. | descriptors. | +----------------------+----------------------+----------------------+ | mode-change-period | For AMR-WB IO mode, | For AMR-WB IO mode, | | (NOTE 3) | the IMS-AGW should | the IMS-AGW shall | | | expect to receive | use this | | | packets with this | mode-change-period | | | mode-change-period | when sending | | | and may use this | packets. | | | information when | | | | deciding upon the | | | | required resources. | | +----------------------+----------------------+----------------------+ | mo | For AMR-WB IO mode, | No IMS-AGW handling | | de-change-capability | mo | of this parameter id | | (NOTE 6) | de-change-capability | defined. | | | with value 2 | | | | indicates that the | | | | IMS-AGW should | | | | expect to be | | | | requested to send | | | | packets with | | | | restricted | | | | mode-change-period | | | | and may use this | | | | information when | | | | deciding upon the | | | | required resources. | | +----------------------+----------------------+----------------------+ | mode-change-neighbor | The IMS-AGW should | The IMS-AGW shall | | (NOTE 3) | expect to receive | use this | | | packets with this | mode-change-period | | | mode-change-period | when sending | | | and may use this | packets. | | | information when | | | | deciding upon the | | | | required resources. | | +----------------------+----------------------+----------------------+ | max-red (NOTE 5) | The IMS-AGW should | The IMS-AGW shall | | | expect to receive | only send packet | | | packets with | with redundancy up | | | redundancy up to the | to the indicated | | | indicated max-red | max-red value. | | | value and may use | | | | this information | | | | when deciding upon | | | | the required | | | | resources. | | +----------------------+----------------------+----------------------+ | 3g | The IMS-AGW should | The IMS-AGW may send | | pp_mtsi_app_adapt | expect to receive | RTCP APP packets of | | (NOTE 4) | RTCP APP packets of | the indicated types. | | | the indicated types | The IMS-AGW shall | | | and may use this | not send other RTCP | | | information when | APP packets. If the | | | deciding upon the | parameter is not | | | required resources. | supplied, the | | | | IMS-AGW shall not | | | | send any RTCP APP | | | | packets. | +----------------------+----------------------+----------------------+ | NOTE 1: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | 3G | | | | PP TS 26.445 [51]. | | | | The values and the | | | | defaults if a | | | | parameter is | | | | omitted, as defined | | | | in | | | | 3 | | | | GPP TS 26.445 [51] | | | | shall apply. | | | | | | | | NOTE 2: This number | | | | of channels are | | | | encoded as | | | | \"encoding | | | | parameters\" of the | | | | SDP \"a=rtpmap\" | | | | attribute defined in | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 3: This MIME | | | | parameter of the EVS | | | | RTP payload type | | | | relates to AMR-WB IO | | | | mode and is defined | | | | in | | | | I | | | | ETF RFC 4867 [54]. | | | | The values and the | | | | defaults if a | | | | parameter is | | | | omitted, as defined | | | | in | | | | IETF RFC 4867 [54] | | | | shall apply. | | | | | | | | NOTE 4: This SDP | | | | attribute is defined | | | | in | | | | 3G | | | | PP TS 26.114 [21]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | | However, some values | | | | are specific to EVS. | | | | | | | | NOTE 5: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | I | | | | ETF RFC 4867 [54]. | | | | The values and the | | | | defaults if a | | | | parameter is | | | | omitted, as defined | | | | in | | | | IETF RFC 4867 [54] | | | | shall apply. | | | | | | | | NOTE 6: This MIME | | | | parameter of the EVS | | | | RTP payload type | | | | relates to AMR-WB IO | | | | mode and is defined | | | | in | | | | I | | | | ETF RFC 4867 [54]. | | | | The values and the | | | | defaults if a | | | | parameter is | | | | omitted, as defined | | | | in | | | | 3G | | | | PP TS 26.445 [51], | | | | shall apply. | | | | | | | | NOTE 7: The frame | | | | erasure rate | | | | indicator for the | | | | channel-aware mode | | | | has two permissible | | | | values (LO, HI) and | | | | this indicator has | | | | to be initialized to | | | | HI, as specified in | | | | clause 5.8.4 of | | | | 3G | | | | PP TS 26.445 [51]. | | | | | | | | NOTE 8: If both the | | | | dtx and the dtx-recv | | | | parameter are | | | | provided either in | | | | the local or in the | | | | remote descriptor, | | | | both parameters will | | | | have the same value | | | | within that | | | | descriptor. | | | +----------------------+----------------------+----------------------+
### 5.13.4 Handling of the OPUS speech and audio codec for WebRTC
The OPUS speech and audio codec is defined in IETF RFC 6716 [50]. Its RTP
payload type is defined in IETF RFC 7587 [56].
The eP-CSCF and the eIMS-AGW should support transcoding to and from the OPUS
speech codec. If they do so, the procedures in the present clause apply.
When receiving an SDP offer from the core network, the IMS-ALG may add an OPUS
codec payload type (as specified in IETF RFC 7587 [56]) before forwarding the
SDP offer towards the served WebRTC UE (denoted as \"codec 3\" in figure
10.2.5.2 of 3GPP TS 29.162 [20]). If that OPUS payload type is selected in the
SDP answer, the IMS-ALG needs to transcode the OPUS codec. Table 5.13.4.1
describes the IMS-ALG handling of the OPUS codec parameters when the IMS-ALG
adds an OPUS payload type to the SDP offer, and that OPUS payload type is
selected in the SDP answer. In addition, rules for the parameter handling in
IETF RFC 7587 [56] shall apply.
Table 5.13.4.1: IMS-ALG handling of OPUS related SDP parameters when the IMS-
ALG adds the OPUS payload type to the SDP offer.
* * *
Parameter Handling for OPUS payload type added to the SDP offer to offer
transcoding Handling if offered OPUS payload type is accepted in the SDP
answer **maxplaybackrate** (NOTE) Should be set according to IMS-AGW
capabilities and sampling rates of expected codecs to transcode with (E.g.
other codecs in the received SDP offer). If parameter is contained in the SDP
answer, the IMS-ALG should forward this parameter to the IMS-AGW for the
termination towards the answerer in the remote descriptor. **sprop-
maxcapturerate** (NOTE) Should be set according to IMS-AGW capabilities and
sampling rates of expected codecs to transcode with (E.g. other codecs in the
received SDP offer). If parameter is contained in the SDP answer, the IMS-ALG
should forward this parameter to the IMS-AGW for the termination towards the
answerer in the remote descriptor. **maxaveragebitrate** (NOTE) Should be set
according to IMS-AGW capabilities and sampling rates of expected codecs to
transcode with (E.g. other codecs in the received SDP offer), see IETF RFC
7587 [56]. If parameter is contained in the SDP answer, the IMS-ALG should
forward this parameter to the IMS-AGW for the termination towards the answerer
in the remote descriptor. **stereo** (NOTE) Should be set to 0 or omitted,
unless the expected codecs to transcode with (E.g. other codecs in the
received SDP offer) support stereo and the IMS-AGW supports stereo
transcoding. If parameter is contained in the SDP answer, the IMS-ALG should
forward this parameter to the IMS-AGW for the termination towards the answerer
in the remote descriptor. **sprop-stereo** (NOTE) Should be set to 0 or
omitted, unless the expected codecs to transcode with (E.g. other codecs in
the received SDP offer) support stereo and the IMS-AGW supports stereo
transcoding. If parameter is contained in the SDP answer, the IMS-ALG should
forward this parameter to the IMS-AGW for the termination towards the answerer
in the remote descriptor. **cbr** (NOTE) Should be set or omitted according to
IMS-AGW capabilities and used encryption. If parameter is contained in the SDP
answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the
termination towards the answerer in the remote descriptor. **useinbandfec**
(NOTE) Should be set or omitted according to IMS-AGW capabilities and delay
budget. If parameter is contained in the SDP answer, the IMS-ALG should
forward this parameter to the IMS-AGW for the termination towards the answerer
in the remote descriptor. **usedtx** (NOTE) Should be set according to IMS-AGW
preferences and DTX capabilities of expected codecs to transcode with (E.g.
other codecs in the received SDP offer). If parameter is contained in the SDP
answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the
termination towards the answerer in the remote descriptor. NOTE: This MIME
parameter of the OPUS RTP payload type is defined in IETF RFC 7587 [56]. It is
encapsulated within the SDP \"a=fmtp\" attribute defined in IETF RFC 4566
[55].
* * *
When receiving an SDP offer from the served WebRTC UE that contains an OPUS
codec payload type, the IMS-ALG may add other payload types before forwarding
the SDP offer (denoted as \"codec 3\" in figure 10.2.5.2 of 3GPP TS 29.162
[20]). If that added payload type is selected in the SDP answer, the IMS-ALG
needs to transcode, and may select to transcode to the OPUS codec. Table
5.13.4.2 describes the IMS-ALG handling of the OPUS codec parameters when the
IMS-ALG receives the OPUS payload type in the SDP offer, and selects to
transcode between the OPUS codec and some other codec. In addition, rules for
the parameter handling in IETF RFC 7587 [56] shall apply.
Table 5.13.4.2: IMS-ALG handling of OPUS related SDP parameters when the IMS-
ALG receives the OPUS payload type to the SDP offer and decides to transcode
between the OPUS payload type and some other codec.
* * *
Parameter Handling of OPUS payload type parameter received in the SDP offer
OPUS payload type supplied in the SDP answer **maxplaybackrate** (NOTE) If
parameter is contained in the SDP offer, the IMS-ALG should forward this
parameter to the IMS-AGW for the termination towards the offerer in the remote
descriptor. Should be set according to IMS-AGW capabilities and sampling rates
of expected codecs to transcode with (E.g. other codecs in the received SDP
offer). **sprop-maxcapturerate** (NOTE) If parameter is contained in the SDP
offer, the IMS-ALG should forward this parameter to the IMS-AGW for the
termination towards the offerer in the remote descriptor. Should be set
according to IMS-AGW capabilities and sampling rates of expected codecs to
transcode with (E.g. other codecs in the received SDP offer).
**maxaveragebitrate** (NOTE) If parameter is contained in the SDP offer, the
IMS-ALG should forward this parameter to the IMS-AGW for the termination
towards the offerer in the remote descriptor. Should be set according to IMS-
AGW capabilities and sampling rates of expected codecs to transcode with (E.g.
other codecs in the received SDP offer), see IETF RFC 7587 [56]. **stereo**
(NOTE) If parameter is contained in the SDP offer, the IMS-ALG should forward
this parameter to the IMS-AGW for the termination towards the offerer in the
remote descriptor. Should be set to 0 or omitted, unless the expected codecs
to transcode with (E.g. other codecs in the received SDP offer) support stereo
and the IMS-AGW supports stereo transcoding. **sprop-stereo** (NOTE) If
parameter is contained in the SDP offer, the IMS-ALG should forward this
parameter to the IMS-AGW for the termination towards the offerer in the remote
descriptor. Should be set to 0 or omitted, unless the expected codecs to
transcode with (E.g. other codecs in the received SDP offer) support stereo
and the IMS-AGW supports stereo transcoding. **cbr** (NOTE) If parameter is
contained in the SDP offer, the IMS-ALG shall forward this parameter to the
IMS-AGW for the termination towards the offerer in the remote descriptor.
Should be set or omitted according to IMS-AGW capabilities and used
encryption. **useinbandfec** (NOTE) If parameter is contained in the SDP
offer, the IMS-ALG should forward this parameter to the IMS-AGW for the
termination towards the offerer in the remote descriptor. Should be set or
omitted according to IMS-AGW capabilities and delay budget. **usedtx** (NOTE)
If parameter is contained in the SDP offer, the IMS-ALG shall forward this
parameter to the IMS-AGW for the termination towards the offerer in the remote
descriptor. Should be set according to IMS-AGW preferences and DTX
capabilities of expected codecs to transcode with (E.g. other codecs in the
received SDP offer). NOTE 1: This MIME parameter of the OPUS RTP payload type
is defined in IETF RFC 7587 [56]. It is encapsulated within the SDP \"a=fmtp\"
attribute defined in IETF RFC 4566 [55].
* * *
Table 5.13.4.3 describes the IMS-AGW handling of the OPUS codec parameters.
The IMS-AGW should support transcoding of OPUS with at least the bandwidths
(sampling rates) which are supported by codec the IMS-AGW is capable to
transcode OPUS to/from (e.g. NB for AMR, and WB for AMR-WB).
Table 15.3.4.3: IMS-AGW handling of OPUS codec parameters.
* * *
Parameter Handling in local descriptor Handling in remote descriptor
**maxplaybackrate** (NOTE) The IMS-AGW should expect to receive RTP packets
with sampling rates up to the indicated maximum and may use this information
when deciding upon the required resources. The IMS-AGW should send RTP packets
with the indicated sampling rate. **sprop-maxcapturerate** (NOTE) No IMS-AGW
handling of this parameter is defined. The IMS-AGW should expect to receive
RTP packets with sampling rates up to the indicated maximum and may use this
information when deciding upon the required resources. **maxaveragebitrate**
(NOTE) The IMS-AGW should expect to receive RTP packets with average bit rates
up to the indicated maximum and may use this information when deciding upon
the required resources. The IMS-AGW shall send RTP packets with average bit
rates up to the indicated maximum. **stereo** (NOTE) The IMS-AGW should expect
to receive RTP packets containing the indicated stereo mode and may use this
information when deciding upon the required resources. The IMS-AGW should send
RTP packets containing the indicated stereo mode. **sprop-stereo** (NOTE) No
IMS-AGW handling of this parameter is defined. The IMS-AGW should expect to
receive RTP packets containing the indicated stereo mode and may use this
information when deciding upon the required resources. **cbr** (NOTE) The IMS-
AGW should expect to receive RTP packets containing the indicated constant bit
rate mode and may use this information when deciding upon the required
resources. The IMS-AGW should send RTP packets containing the indicated
constant bit rate mode. **useinbandfec** (NOTE) The IMS-AGW should expect to
receive RTP packets containing the indicated forward error correction mode and
may use this information when deciding upon the required resources. The IMS-
AGW should send RTP packets containing the indicated forward error correction
mode. **usedtx** (NOTE) The IMS-AGW should expect to receive RTP packets
containing the indicated DTX mode and may use this information when deciding
upon the required resources. The IMS-AGW should send RTP packets using the
indicated DTX mode. NOTE 1: This MIME parameter of the OPUS RTP payload type
is defined in IETF RFC 7587 [56]. The default value if a parameter is omitted,
as defined in IETF RFC 7587 [56], shall apply.
* * *
## 5.14 Multimedia Priority Service (MPS) Support
The Multimedia Priority Service (MPS) is specified in 3GPP TS 22.153 [22]. The
IMS-ALG and IMS-AGW may support the priority treatment of a call/session
identified as an MPS call/session. If MPS is supported, the following
functional requirements apply:
\- Upon receipt of the MPS priority information in the call control
signalling:
\- The IMS-ALG shall recognise the call/session as having priority.
\- The IMS-ALG shall send the priority information for a context to the IMS-
AGW to enable the priority treatment described below related to the IMS-AGW.
\- The IMS-ALG shall apply priority handling to H.248 transactions related to
priority calls/sessions when network resources are congested , e.g.,
preferential treatment in any queues or buffers.
\- The IMS-ALG may send the updated priority information and, if DiffServ is
used, provision a suitable DSCP marking for the updated MPS priority level to
the IMS-AGW if it needs to change the priority information previously
communicated to the IMS-AGW for an MPS call/session.
\- If the H.248 control association utilises a transport with the possibility
for prioritisation, the IMS-ALG may apply priority using the appropriate
prioritisation procedures.
\- If the MPS Priority service requires a specific MPS DSCP setting the IMS-
ALG shall configure the IMS-AGW to apply a specific MPS DSCP marking to the
user data transport packets to indicate that the packets are of a higher
priority than those for normal calls.
\- If the IMS-AGW receives an indication to apply a specific MPS DSCP marking
to the user data transport packets, it shall apply this DSCP marking to the IP
headers.
NOTE 1: Support of Diffserv procedures by the IMS-AGW assumes an operator uses
Diffserv for prioritising user plane traffic related to an MPS call/session.
\- When the IMS-ALG marks a Context with priority information, the IMS-AGW may
use the priority information for selecting resources for the media and
signaling transport with priority. The following actions may be taken by the
IMS-AGW if it has reached a congested state:
i) seize priority reserved resources; or
ii) if resources are congested, indicate that in aCommand Response error code.
NOTE 2: The Priority information can be used to derive Layer 2 QoS marking and
trigger priority identification and priority treatment for other QoS
technologies than Diffserv.
## 5.15 Coordination of Video Orientation
The IMS-ALG and the IMS-AGW may support the Coordination of Video Orientation
(CVO) as defined in 3GPP TS 26.114 [21].
If the IMS-ALG receives an SDP body containing \"a=extmap\" attribute(s), as
defined in IETF RFC 5285 [23], and the \"a=extmap\" attribute(s) contain CVO
URN(s) (i.e. the CVO URN for a 2 bit granularity of rotation and/or the CVO
URN for a higher granularity of rotation) as defined in 3GPP TS 26.114 [21],
then:
a) if the IMS-ALG and the IMS-AGW support the CVO feature:
\- the IMS-ALG shall include the \"extended RTP header for CVO\" information
element when seizing resources in the IMS-AGW to indicate the IMS-AGW that it
shall allow the RTP header extension for CVO to pass; and
EditorÂ´s Note: It is ffs if the IMS-ALG needs to include the \"extended RTP
header for CVO\" information element when seizing terminations of a media
agnostic IMS-AGW, or if a media agnostic IMS-AGW always passes any RTP header
extension.
\- the IMS-ALG shall forward within SIP signalling, the SDP body received from
the preceding node with unmodified \"a=extmap\" attribute(s) to the succeeding
node; or
b) if the IMS-AGW does not support the CVO feature, the IMS-ALG shall forward
within SIP signalling, the SDP body received from the preceding node without
any \"a=extmap\" attributes to the succeeding node.
NOTE 1: The UE supporting the CVO feature will not send the extended RTP
headers for CVO if the UE did not receive any SDP body with the CVO related
\"a=extmap\" attribute.
If the IMS-AGW supports the CVO feature and has been instructed to pass on the
extended RTP header for CVO as described above for both incoming and outgoing
terminations then:
\- if the IMS AGW does not apply video transcoding, it shall pass any received
RTP CVO header extension to succeeding RTP streams; or
\- if the IMS-AGW applies video transcoding, it shall keep the video
orientation unchanged during the transcoding and copy the received RTP CVO
header extension to the succeeding outgoing RTP stream(s) after transcoding
the associated group of packets.
NOTE 2: IETF RFC 5285 [23] provides a framework for header extensions and can
also be used for non-CVO related purposes. It is an implementation decision of
the IMS-AGW if it only passes CVO related RTP header extensions, or if it
passes any RTP header extension when being instructed with the \"extended RTP
header for CVO\" information element.
NOTE 3: The behaviour of the IMS-AGW when being instructed with an \"extended
RTP header for CVO\" information element only at one termination is an
implementation decision.
NOTE 4: Unknown IETF RFC 5285 [23] RTP header extensions are ignored by the
destination RTP end system.
## 5.16 Generic image attributes
The IMS-ALG and the IMS-AGW may support a media-level SDP image attribute
\"a=imageattr\" defined in IETF RFC 6236 [24] to negotiate the image size for
sending and receiving video as required by 3GPP TS 26.114 [21].
NOTE: The image attribute may be used within the SDP capability negotiation
framework and its use is then specified using the \"a=acap\" parameter.
If the IMS-ALG:
\- supports the negotiation of the image size;
\- receives an SDP body containing the image attribute(s) \"imageattr\"
defined in IETF RFC 6236 [24]; and
\- does not support or does not apply the video transcoding procedure defined
in clause 5.13;
the IMS-ALG shall forward the SDP body with unmodified image attribute(s).
If the IMS-ALG and the IMS-AGW support the ATCF/ATGW functions then during the
access transfer procedures the IMS-ALG may apply the procedure described in
clause 6.2.14.6 to negotiate and adjust the image size for sending and
receiving video of the session.
## 5.17 TCP bearer connection control
### 5.17.1 Stateless TCP handling
An IMSâ€‘ALG and IMSâ€‘AGW that supports TCP as transport protocol (see IETF RFC
793 [29] and IETF RFC 4145 [30]) shall support the following procedures.
NOTE 1: It is assumed that pre-Release 12 IMSâ€‘ALGs and IMSâ€‘AGWs also apply
these procedures.
When receiving an SDP offer or answer containing a media line for a new TCP
based media stream (e.g. with \"TCP\", \"TCP/MSRP\" as transport protocol),
the IMSâ€‘ALG:
\- shall indicate \"TCP\" (for application-agnostic interworking) or
\"TCP/MSRP\" (for application-aware MSRP interworking) as transport protocol
to the IMSâ€‘AGW;
\- shall indicate the TCP port numbers received in the SDP from the remote
peer as destination port in the remote descriptor at the termination towards
the SDP sender;
\- shall request the IMSâ€‘AGW to allocate a TCP port number at the destination
towards the SDP receiver;
\- shall replace the TCP port in the received SDP with the TCP port number
allocated by the IMSâ€‘AGW and forward the SDP; and
\- shall indicate to the IMSâ€‘AGW to perform TCP stateless handling by not
including the TCP session setup direction attribute at the interconnected
terminations in the same context.
An IMSâ€‘AGW receiving an indication of \"TCP\", or \"TCP/MSRP\" as transport
protocol, but no indication to perform TCP state-aware handling (via
information about the directionality of the TCP session setup):
\- shall send a TCP SYN when receiving a TCP SYN at the interconnected
termination in the same context;
\- shall forward received TCP payload; and
\- shall use its own port number as TCP source port numbers and the remote
port number received from the IMSâ€‘ALG as TCP destination port numbers and
calculate a new TCP checksum for all TCP packets it sends.
NOTE 2: This mode of operation corresponds to the \"TCP Relay\" mode in ITU-T
Recommendation H.248.84 [38].
### 5.17.2 Stateâ€‘aware TCP handling
#### 5.17.2.1 General
An IMSâ€‘ALG and IMSâ€‘AGW that supports TCP as transport protocol (see IETF RFC
793 [29] and IETF RFC 4145 [30]) may support the procedures specified in
clause 5.17.2 for state-aware TCP handling.
NOTE 1: Stateâ€‘aware TCP handling enables modifications of TCP payloads by the
IMSâ€‘AGW such as changing the size of the payload and inserting extra protocol
layers, e.g. for e2ae media security.
An IMSâ€‘ALG and IMSâ€‘AGW that supports stateâ€‘aware TCP handling shall support
the procedures specified in clause 5.17.2.2 and may additionally support the
procedures specified in clause 5.17.2.3.
NOTE 2: The procedures in clause 5.17.2.3 enable TCP connections between two
peers behind **remote (far-end) NATs without any other intermediate server
capable of acting as a TCP B2BUA (such as a messaging server). However, they
are not possible if e2e security is applied for MSRP based media.**
#### 5.17.2.2 Stateâ€‘aware TCP handling without support of modifying the TCP
setup direction
When the IMSâ€‘ALG receives an SDP offer containing a media line for a new TCP
based media stream (e.g. with \"TCP\", \"TCP/MSRP\" as transport protocol),
for that TCP based media stream the IMSâ€‘ALG:
\- if no media security is applied, shall indicate \"TCP\" (for application-
agnostic interworking) or \"TCP/MSRP\" (for application-aware MSRP
interworking) as transport protocol to the IMSâ€‘AGW;
\- if media security is applied, shall indicate a transport protocol according
to clause 5.11 to the IMSâ€‘AGW;
\- shall request the IMSâ€‘AGW to allocate a TCP port at the destination towards
the SDP answerer;
\- shall request the IMSâ€‘AGW to allocate a TCP port at the destination towards
the SDP offerer;
\- shall indicate the TCP port numbers received in the SDP offer as
destination in the remote descriptor at the termination towards the SDP
offerer;
\- shall indicate to the IMSâ€‘AGW to perform TCP state-aware handling (by
indicating the \"actpass\" TCP session setup direction at both interconnected
terminations in the same context in the local descriptor);
\- if supported by the IMSâ€‘AGW, may indicate to the IMSâ€‘AGW for a given
termination to use an incoming TCP connection establishment request (TCP SYN)
at that termination as a trigger for sending a TCP connection establishment
request at the interconnected termination in the same context;
\- if supported by the IMSâ€‘AGW, may indicate to the IMSâ€‘AGW to discard
incoming TCP connection establishment requests; and
\- shall replace the TCP port in the received SDP offer with the TCP port
number allocated by the IMSâ€‘AGW at the termination towards the SDP answerer,
shall maintain a received \"a=setup:active\" or \"a=setup:passsive\" SDP
attribute (see IETF RFC 4145 [30]) in the SDP offer without modification, and
shall forward the SDP offer.
When the IMSâ€‘ALG then receives the SDP answer containing a media line for a
new TCP based media stream, for that TCP based media stream the IMSâ€‘ALG:
\- shall indicate the TCP port numbers received in the SDP answer as
destination in the remote descriptor at the termination towards the SDP
answerer;
\- if supported by the IMSâ€‘AGW, may indicate to the IMSâ€‘AGW for a given
termination to use an incoming TCP connection establishment request (TCP SYN)
at that termination as a trigger for sending a TCP connection establishment
request at the interconnected termination in the same context;
\- if the IMSâ€‘ALG did not indicate to the IMSâ€‘AGW to use the incoming TCP
connection establishment request (TCP SYN) at one termination as a trigger for
sending a TCP connection establishment request at the interconnected
termination in the same context,
\- if the SDP answer contains an \"a=setup:active\" SDP attribute (see IETF
RFC 4145 [30]), shall indicate to the IMSâ€‘AGW to start a TCP connection
establishment at the termination towards the SDP offerer; and
\- if the SDP answer contains an \"a=setup:passive\" SDP attribute, shall
indicate to the IMSâ€‘AGW to start a TCP connection establishment at the
termination towards the SDP answerer;
NOTE 1: Clients only supporting MSRP according to IETF RFC 4975 [25] will not
use the SDP \"a=setup\" attribute, but will assign the TCP client role to the
SDP offerer. However, in 3GPP (Release 8 onwards), OMA and GSMA the support of
IETF RFC 6135 [45] is mandated, and the \"a=setup\" attribute will thus be
used.
\- if the IMSâ€‘ALG previously indicated to the IMSâ€‘AGW to discard incoming TCP
connection establishment requests, shall indicate to the IMSâ€‘AGW to process
incoming TCP connection establishment requests; and
\- shall replace the destination TCP port in the received SDP answer with the
TCP port number allocated by the IMSâ€‘AGW at the termination towards the SDP
offerer, shall maintain the received \"a=setup\" SDP attribute (RFC 4145 [30])
in the SDP answer without modification, and shall forward the SDP answer.
An IMSâ€‘AGW receiving an indication of \"TCP\", or \"TCP/MSRP\" as transport
protocol and an indication to perform TCP state-aware handling (via
information about the directionality of the TCP session setup):
\- if the IMSâ€‘ALG indicated to start a TCP connection establishment at a given
termination, shall start the TCP connection establishment at that TCP
termination by sending a TCP SYN;
\- if the IMSâ€‘ALG indicated to discard incoming TCP connection establishment
requests, shall discard any incoming TCP connection establishment requests
(support optional for the IMSâ€‘AGW);
\- if
a) the IMSâ€‘ALG indicated to use the incoming TCP connection establishment
request (TCP SYN) at one termination as a trigger for sending a TCP connection
establishment request at the interconnected termination in the same context,
and
b) the IMSâ€‘ALG did not indicate to discard incoming TCP connection
establishment requests,
shall send a TCP SYN when receiving a TCP SYN at the interconnected
termination in the same context (support optional for the IMSâ€‘AGW);
\- if
a) the IMSâ€‘ALG did not indicate to use the incoming TCP connection
establishment request (TCP SYN) at one termination as a trigger for sending a
TCP connection establishment request at the interconnected termination in the
same context, and
b) the IMSâ€‘ALG did not indicate to discard incoming TCP connection
establishment requests, and
c) the IMSâ€‘ALG already configured the remote IP address and port or requested
latching,
shall answer any received TCP SYN at a given termination with appropriate
messages according to TCP procedures;
\- shall forward received TCP payload, performing any required modifications
on the TCP payload according to procedures in other parts of this
specification; and
\- shall use its own port number as TCP source port and the remote port number
indicated by the IMSâ€‘ALG as TCP destination port numbers and shall calculate a
new TCP checksum for all TCP packets it sends.
NOTE 2: This mode of operation corresponds to the \"TCP Proxy\" mode in ITU-T
Recommendation H.248.84 [38].
#### 5.17.2.3 Stateâ€‘aware TCP handling with support of modifying the TCP setup
direction
The IMSâ€‘ALG and IMSâ€‘AGW shall perform the same procedures as in clause
5.17.2.2 with modification according to the present clause.
When the IMSâ€‘ALG receives an SDP offer containing a media line for a new TCP
based media stream (e.g. with \"TCP\", \"TCP/MSRP\" as transport protocol),
for that TCP based media stream the IMSâ€‘ALG:
\- if an \"a=setup:active\" SDP attribute (see IETF RFC 4145 [30]) is received
in an SDP offer towards a served UE that is possibly behind a remote NAT, the
IMSâ€‘ALG
\- should replace this attribute with a \"a=setup:actpass\" or
\"a=setup:passive\" SDP attribute; and
\- shall then not indicate to the IMSâ€‘AGW to use the incoming TCP connection
establishment request (TCP SYN) at the termination towards the offerer as a
trigger for sending a TCP connection establishment request at the
interconnected termination in the same context towards the answerer;
\- if an \"a=setup:active\" SDP attribute (see IETF RFC 4145 [30]) is received
in an SDP offer from a served UE, the IMSâ€‘ALG
\- may replace this attribute with a \"a=setup:actpass\" SDP attribute; and
\- shall then not indicate to the IMSâ€‘AGW to use the incoming TCP connection
establishment request (TCP SYN) at the termination towards the answerer as a
trigger for sending a TCP connection establishment request at the
interconnected termination in the same context towards the offerer;
NOTE 1: Clients only supporting MSRP according to IETF RFC 4975 [25] will not
use the SDP \"a=setup\" attribute, but will assign the TCP client role to the
SDP offerer. However, in 3GPP (Release 8 onwards), OMA and GSMA the support of
IETF RFC 6135 [45] is mandated, and the \"a=setup\" attribute will thus be
used.
\- shall indicate to the IMSâ€‘AGW to perform TCP state-aware handling, either
by indicating the \"actpass\" TCP session setup direction at both
interconnected terminations in the same context in the local descriptors, or
by indicating the \"passive\" TCP session setup direction at both
interconnected terminations in the same context.
When the IMSâ€‘ALG then receives the SDP answer containing a media line for a
new TCP based media stream, for that TCP based media stream the IMSâ€‘ALG:
\- if
a) the IMSâ€‘ALG received an \"a=setup:active\" SDP attribute in the SDP offer,
and
b) the SDP answer containes an \"a=setup:active\" SDP attribute,
then
\- if the IMSâ€‘ALG previously indicated \"actpass\" TCP session setup direction
at both interconnected terminations to the IMSâ€‘AGW, shall indicate to the
IMSâ€‘AGW the \"passive\" TCP session setup direction at both interconnected
terminations in the same context in the local descriptors, and
\- shall replace the \"a=setup:active\" SDP attribute in the SDP answer with
an \"a=setup:passive\" SDP attribute before forwarding the answer.
\- if
a) the IMSâ€‘ALG received an \"a=setup:active\" SDP attribute in the SDP offer,
and
b) the SDP answer containes an \"a=setup:passive\" SDP attribute,
then
\- if the IMSâ€‘ALG previously indicated \"passive\" TCP session setup direction
at both interconnected terminations to the IMSâ€‘AGW, shall indicate to the
IMSâ€‘AGW the \"actpass\" TCP session setup direction at both interconnected
terminations in the same context in the local descriptors, and
\- shall retain the \"a=setup:passive\" SDP attribute in the forwarded SDP
answer;
\- if the IMSâ€‘ALG did not indicate to the IMSâ€‘AGW to use the incoming TCP
connection establishment request (TCP SYN) at one termination as a trigger for
sending a TCP connection establishment request at the interconnected
termination in the same context,
\- if the sent SDP answer towards the offerer contains an \"a=setup:active\"
SDP attribute (RFC 4145 [30]), indicate to the IMSâ€‘AGW to start a TCP
connection establishment at the termination towards the SDP offerer; and
\- if the received SDP answer contains an \"a=setup:passive\" SDP attribute,
indicate to the IMSâ€‘AGW to start a TCP connection establishment at the
termination towards the SDP answerer.
When the IMSâ€‘ALG indicated a \"passive\" TCP setup direction for a
termination, the IMS-AGW shall wait for an incoming TCP connection
establishment at that termination and shall not start a TCP connection
establishment on its own.
NOTE 2: If the \"passive\" TCP session setup direction has been indicated to
the IMSâ€‘AGW at both interconnected terminations, the mode of operation
corresponds to the \"TCP Merge\" mode in ITU-T Recommendation H.248.84 [38].
If the \"actpass\" TCP session setup direction has been indicated to the
IMSâ€‘AGW at both interconnected terminations, the mode of operation corresponds
to the \"TCP Proxy\" mode in ITU-T Recommendation H.248.84 [38].
## 5.18 Interactive Connectivity Establishment (ICE)
### 5.18.1 General
The IMS-ALG and the IMS-AGW may support ICE functionality as specified in IETF
RFC 8445 [82] and IETF RFC 8839 [83], and 3GPP TS 24.229 [11] to support a UE
residing behind a remote NAT. The present clause describes the requirements
for P-CSCF (IMS-ALG) and IMS-AGW when the ICE procedures are supported.
Support of full ICE functionality is optional, but if ICE is supported, the
IMS-ALG and IMS-AGW shall at least support ICE lite as specified in IETF RFC
8445 [82]_._
An IMS-ALG and IMS-AGW supporting ICE lite may in addition support ICE for TCP
according to IETF RFC 6544 [57].
NOTE 1: ICE for TCP can be used to offer an alternative transport for media
streams with default UDP transport to enable a traversal of UDP-blocking NATs
or firewalls. In the present release, the support of ICE for TCP is restricted
to media streams with default UDP transport, and to ICE lite.
The IMS-ALG and IMS-AGW shall only use host candidates as local ICE
candidates.
NOTE 2: IMS-ALG and IMS-AGW are not located behind a NAT (from perspective of
the ICE deployment model according to figure 1 in IETF RFC 8445 [82]).
The IMS-ALG with IMS-AGW inserted on the media plane shall perform separate
ICE negotiation and procedures with the offerer and the answerer and ICE may
be applied independently at either side. Furthermore, the IMS-ALG may be
configured to apply ICE procedures only towards the access network side.
When the P-CSCF (IMS-ALG) detects no ICE parameters in the received SDP, it
shall not configure the IMS-AGW to apply any ICE and STUN related procedures
toward the call leg from where the SDP has been received, and if applicable
may apply the remote NAT traversal using latching according to clause 5.4.
Any IMS-AGW supporting ICE shall advertise its support of incoming STUN
continuity check procedures. An IMS-AGW supporting full ICE procedures shall
in addition advertise its support for originating STUN connectivity check
procedures.
If the IMS-AGW does not indicate the support of STUN procedures, or if the
IMS-ALG is configured not to apply ICE toward a call leg, the IMS-ALG:
\- shall not configure the IMS-AGW to apply STUN procedures;
\- shall remove any received SDP candidate information from the SDP it
forwards; and
\- may apply remote NAT traversal using latching according to clause 5.4.
### 5.18.2 ICE lite
If the IMS-ALG is configured to use ICE lite, or supports only ICE lite, or
controls an IMS-AGW that only support ICE lite, the procedures in the present
clause apply.
If the IMS-ALG receives an initial SDP offer with ICE candidate information
but no \"a=ice-lite\" attribute, the IMS-ALG:
\- shall not forward the received candidate information in the SDP it sends
towards the answerer;
\- shall request the IMS-AGW for each media line with UDP as default transport
where it decides to use ICE to reserve an ICE host candidate and provide its
address information and a related ICE user name fragment and password;
NOTE 1: Requesting only one host candidate per m-line prevents that the IMS-
ALG will receive \"a=remote-candidates\" SDP attributes in a subsequent SDP.
Requesting separate ufrag and password for each media line simplifies H.248
encoding.
\- may request the IMS-AGW for each media line with UDP as default transport
where it decides to use ICE to reserve an additional passive TCP ICE host
candidate and provide its address information and a related ICE user name
fragment and password;
\- shall configure the IMS-AGW to act as STUN server at the host candidate
address, i.e. to answer STUN connectivity checks;
\- may provide received remote ICE candidates and the received related ICE
user name fragment and password to the IMS-AGW;
\- if an \"a=ice-options\" attribute with the value \"ice2\" was present in
the received SDP offer, shall include the \"a=ice-options\" attribute with the
value \"ice2\" in the SDP answer it forwards;
\- shall include the host candidate and related ICE user name fragment and
password received from the IMS-AGW in the SDP answer it forwards;
\- shall include the \"a=ice-lite\" attribute in the SDP answer it forwards;
and
\- shall not apply the remote NAT traversal using latching according to clause
5.4.
If the IMS-ALG receives SDP offer with ICE candidate information and an
\"a=ice-lite\" attribute, the IMS-ALG shall not apply ICE towards that call
leg and not include any ICE related SDP attributes in the SDP answer.
NOTE 2: This avoids that the ICE lite peer needs to send extra SDP offers to
complete ICE procedures.
If the IMS-ALG sends an SDP offer (or forwards a received SDP offer) towards a
call leg where ICE is to be applied, the IMS-ALG:
\- shall request the IMS-AGW to reserve a host candidate for each media line
with UDP as default transport where it decides to use ICE and provide its
address information, user name fragment and password;
\- may request the IMS-AGW for each media line with UDP as default transport
where it decides to use ICE to reserve an additional passive TCP ICE host
candidate and provide its address information and a related ICE user name
fragment and password;
\- shall configure the IMS-AGW to act as STUN server at the host candidate
address, i.e. to answer STUN connectivity checks;
\- shall include the \"a=ice-options\" attribute with the value \"ice2\" in
the SDP offer;
\- shall include the host candidate provided by the IMS-AGW and related ICE
user name fragment and password in the SDP offer; and
\- shall include the \"a=ice-lite\" attribute in the SDP offer.
If the IMS-ALG then receives an SDP answer with candidate information from the
call leg where ICE is to be applied, the IMS-ALG:
\- shall not forward the received candidate information in the SDP it sends
towards the offerer;
\- may provide received remote ICE candidates and the received related ICE
user name fragment and password to the IMS-AGW; and
\- shall not apply the remote NAT traversal using latching according to clause
5.4.
After the initial SDP offer-answer exchange, the IMS-ALG can receive a new
offer from the peer that includes updated address and port information in the
SDP \"c=\" line, \"m=\" line, or \"a=rtcp\" line SDP attributes. If the ICE
user name fragment and password in the SDP offer differ from the ones received
in the previous SDP (i.e. the peer restarts ICE), the IMS-ALG shall apply the
same procedures as for the initial SDP offer.
When receiving a request for a host candidate for a media line, the IMS-AGW
shall allocate one host candidate for that media line and send it to the IMS-
ALG within the reply. The IP address and port shall be the same as indicated
separately as Local IP Resources. The IMS-AGW shall also indicate that it
supports ICE lite in the reply.
For a passive TCP ICE host candidate, the IMS-AGW shall be prepared to receive
and answer the TCP connection establishment requests.
NOTE 3: The TCP connection control procedures in clause 5.17 do not apply to
TCP host candidates.
When receiving a request for an ICE user name fragment and password, the IMS-
AGW shall generate an ICE user name fragment and password and send it to the
IMS-ALG within the reply. The IMS-AGW shall store the password and user name
fragment to be able to authenticate incoming STUN binding request according to
clause 7.3 of IETF RFC 8445 [82].
When receiving a request to act as STUN server, the IMS-AGW shall be prepared
to answer STUN binding request according to clause 7.3 of IETF RFC 8445 [82].
Once a STUN binding request with the \"USE-CANDIDATE\" flag has been received,
the IMS-AGW may send media towards the source of the binding request.
### 5.18.3 Full ICE
If the IMS-ALG supports and is configured to use full ICE, and controls an
IMS-AGW that supports full ICE, the procedures in the present clause apply.
If the IMS-ALG receives an initial SDP offer with ICE candidate information,
the IMS-ALG:
\- shall not forward the received candidate information in the SDP it sends
towards the answerer;
\- shall request the IMS-AGW for each media line where it decides to use ICE
to reserve an ICE host candidate and provide its address information and a
related ICE user name fragment and password;
NOTE: Requesting only one host candidate per m-line prevents that the IMS-ALG
will receive \"a=remote-candidates\" SDP attributes in a subsequent SDP.
Requesting separate ufrag and password for each media line simplifies H.248
encoding.
\- shall request the IMS-AGW to provide the desired pacing value for
connectivity checks (Ta timer value);
\- shall configure the IMS-AGW to act as STUN server at the host candidate
address, i.e. to answer STUN connectivity checks;
\- shall provide received remote ICE candidates and the received related ICE
user name fragment and password to the IMS-AGW;
\- shall provide the remote pacing value to the IMS-AGW as follows:
a) if the \"a=ice-pacing\" attribute was present in the received SDP answer,
the received pacing value; or
b) otherwise the default pacing value of 50 ms;
\- if an \"a=ice-options\" attribute with the value \"ice2\" was present in
the received SDP offer, shall include the \"a=ice-options\" attribute with the
value \"ice2\" in the SDP answer it forwards;
\- shall include the \"a=ice-pacing\" attribute with the pacing value provided
by the IMS-AGW in the SDP answer it forwards;
\- shall include the host candidate and related ICE user name fragment and
password received from the IMS-AGW in the SDP answer it forwards;
\- shall determine the role of IMS-ALG in ICE (controlling or controlled)
according to clause 6.1.1 of IETF RFC 8445 [82];
\- shall configure the IMS-AGW to perform connectivity checks in accordance
with the determined ICE role;
\- shall configure the IMS-AGW to report connectivity check results;
\- shall configure the IMS-AGW to report a new peer reflexive candidate if
discovered during the connectivity check; and
\- shall not apply the remote NAT traversal using latching according to clause
5.4.
If the IMS-ALG sends an SDP offer (or forwards a received SDP offer) towards a
call leg where ICE is to be applied, the IMS-ALG:
\- shall request the IMS-AGW to reserve a host candidate for each media line
were it decides to use ICE and provide its address information, ICE user name
fragment and password;
\- shall request the IMS-AGW to provide the pacing value for connectivity
checks;
\- shall configure the IMS-AGW to act as STUN server at the host candidate
address, i.e. to answer STUN connectivity checks; and
\- shall include the \"a=ice-options\" attribute with the value \"ice2\" in
the SDP offer it sends;
\- shall include the \"a=ice-pacing\" attribute with the pacing value provided
by the IMS-AGW in the SDP offer it sends; and
\- shall include the host candidate provided by the IMS-AGW and related ICE
user name fragment and password in the SDP offer it sends.
If the IMS-ALG then receives an SDP answer with candidate information from the
call leg where ICE is to be applied, the IMS-ALG:
\- shall not forward the received candidate information in the SDP it sends
towards the offerer;
\- shall provide received remote ICE candidates and the received related ICE
user name fragment and password to the IMS-AGW;
\- shall provide the remote pacing value to the IMS-AGW as follows:
a) if the \"a=ice-pacing\" attribute was present in the received SDP answer,
the received pacing value; or
b) otherwise the default pacing value of 50 ms;
\- shall determine the role of IMS-ALG in ICE (controlling or controlled)
according to clause 6.1.1 of IETF RFC 8445 [82];
\- shall configure the IMS-AGW to perform connectivity checks in accordance
with the determined ICE role;
\- shall configure the IMS-AGW to report connectivity check results;
\- shall configure the IMS-AGW to report a new peer reflexive candidate if
discovered during the connectivity check; and
\- shall not apply the remote NAT traversal using latching according to clause
5.4.
When the IMS-ALG is informed by the IMS-AGW about new peer reflexive
candidate(s) discovered by the connectivity checks, it shall configure the
IMS-AGW to perform additional connectivity checks for those candidates.
When the IMS-ALG is informed by the IMS-AGW about successful candidate pairs
determined by the connectivity checks, the IMS-ALG shall send a new SDP offer
to its peer with contents according to clause 4.4.1 of IETF RFC 8839 [83] if
it has the controlling role and the highest-priority candidate pair differs
from the default candidates in previous SDP.
After the initial SDP offer-answer exchange, the IMS-ALG can receive a new
offer from the peer that includes updated address and port information in the
SDP \"c=\" line, \"m=\" line, or \"a=rtcp\" line SDP attributes. If the ICE
user name fragment and password in the SDP offer differ from the ones received
in the previous SDP (i.e. the peer restarts ICE), the IMS-ALG shall apply the
same procedures as for the initial SDP offer.
When receiving a request for a host candidate for a media line, the IMS-AGW
shall allocate one host candidate for that media line and send it to the IMS-
ALG within the reply. The IP address and port shall be the same as indicated
separately as Local IP Resources.
When receiving a request to provide a desired pacing value for connectivity
checks (Ta timer value), the IMS-AGW shall calculate Ta timer value based on
the characteristics of the associated data or shall use the default value of
50 ms and provide it as desired Ta timer value. The IMS-AGW shall compare the
own desired Ta timer value with the Ta timer value provided by the IMS-ALG and
shall use the higher value for connectivity checks (as specified in IETF RFC
8445 [82]).
When receiving a request for an ICE user name fragment and password, the IMS-
AGW shall generate an ICE user name fragment and password and send it to the
IMS-ALG within the reply. The IMS-AGW shall store the password and user name
fragment to be able to authenticate incoming STUN binding request according to
clause 7.3 of IETF RFC 8445 [82].
When receiving a request to act as STUN server, the IMS-AGW shall be prepared
to answer STUN binding request according to clause 7.3 of IETF RFC 8445 [82].
Once a STUN binding request with the \"USE-CANDIDATE\" flag has been received,
the IMS-AGW may send media towards the source of the binding request.
When receiving a request to perform connectivity checks and to report
connectivity check results, the IMS AGW:
\- shall compute ICE candidate pairs according to clause 6.1.2 of IETF RFC
8445 [82];
\- shall schedule checks for the ICE candidate pairs according to clause 6.1.4
of IETF RFC 8445 [82];
\- shall send STUN connectivity checks for the scheduled checks according to
clause 7.2 of IETF RFC 8445 [82];
\- shall inform the IMS-ALG about successful candidate pairs determined by the
connectivity checks;
\- shall inform the IMS-ALG about new peer reflexive candidate(s) discovered
by the connectivity checks; and
\- should send media using the highest priority candidate pair for which
connectivity checks have been completed.
### 5.18.4 STUN consent freshness for WebRTC
The eIMS-AGW, which implements ICE, shall support the STUN consent freshness
test defined in IETF RFC 7675 [49].
If the eP-CSCF supports and is configured to use full ICE, and controls an
eIMS-AGW that supports full ICE, to initiate the STUN consent freshness
procedures, the eP-CSCF shall request the eIMS-AGW to perform periodic STUN
consent tests towards the WIC (WebRTC IMS Client). On receipt of requesting
STUN consent test signal, the eIMS-AGW shall start sending STUN binding
requests in order to verify consent, based on the interval value indicated by
the eP-CSCF, after the tansport address has been selected via the ICE-related
connectivity check.
If the eP-CSCF is configured to use ICE lite, or supports only ICE lite, or
controls an IMS-AGW that only support ICE lite, the eIMS-AGW shall not send
STUN consent request checks. Instead, the IMS-AGW shall act as STUN server and
only respond to incoming STUN binding requests received from the WIC (WebRTC
IMS Client).
If STUN consent expires on a given transport address, the eIMS-AGW shall stop
forwarding media on that transport address, and inform the eP-CSCF about the
failure. In addition, the eIMS-AGW shall stop sending STUN consent request
checks on the transport address. Once upon an indicated test failure, the eP-
CSCF may request for appropriate action related to the H.248 stream, such as
the removal of the H.248 stream.
## 5.19 MSRP handling
### 5.19.1 General
The IMS-ALG and IMS-AGW may support MSRP handling. If they support MSRP
handling, they shall apply the procedures as specified in the present clause
5.19.
For WebRTC terminations, MSRP is transferred over data channels. For WebRTC
terminations the procedures in the present clause 5.19 shall apply with the
modifications described in clause 5.19.6.
The IMS-AGW shall support application-agnostic MSRP handling.
NOTE 1: Application-agnostic MSRP handling suffices when IETF RFC 6714 [26] or
IETF draft-ietf-simple-msrp-sessmatch is supported by both ends (e.g. between
Rel-8 onwards IMS UEs) and no MSRP relays are used.
NOTE 2: The expired IETF draft-ietf-simple-msrp-sessmatch modifies the session
matching procedure defined by IETF RFC 4975 [25]. A peer applying IETF draft-
ietf-simple-msrp-sessmatch will only compare the session-id part of the first
MSRP URI in the SDP \"a=path\" attribute with the session-id part of the first
MSRP URI in the \"To-Path\" header field of the received MSRP packets. This
draft is still used by OMA and GSMA as an alternative option to IETF RFC 6714
[26].
The IMS-AGW may in addition support application-aware MSRP interworking, as
described in clause 5.19.5..
NOTE 3: Application-aware MSRP interworking enables direct communication:
\- between an MSRP client applying IETF RFC 6714 [26] and an MSRP client
applying IETF RFC 4975 [25] without extensions by either IETF RFC 6714 [25] or
IETF draft-ietf-simple-msrp-sessmatch.
\- between an MSRP client applying IETF draft-ietf-simple-msrp-sessmatch and
an MSRP client applying IETF RFC 4975 [25] without extensions by either IETF
RFC 6714 [26] or IETF draft-ietf-simple-msrp-sessmatch.
\- between an MSRP client applying IETF RFC 6714 [26] and an MSRP client
applying IETF draft-ietf-simple-msrp-sessmatch.
\- between two MSRP clients applying IETF RFC 4975 [25] without extensions by
either IETF RFC 6714 [26] or IETF draft-ietf-simple-msrp-sessmatch.
However, to address these scenarios, application aware MSRP interworking can
also be applied in other network elements than the IMS-ALG and IMS-AGW, for
instance in an CPM Participating Function or CPM Interworking Function as
defined in OMA-TS-CPM_Conversation_Function-V2 [46].
NOTE 4: MSRP relays external to the IMS-AGW are not supported in the present
release.
The IMS-ALG procedures depend on whether the IMS-AGW applies application-
agnostic MSRP interworking or application-aware MSRP interworking, and on the
MSRP extensions applied on the interconnected call legs. The support of
related procedures in clauses 5.19.2 to 5.19.4 below are all optional, but the
IMS-ALG shall support at least one of them.
However the procedures in clauses 5.19.4 and 5.19.5 shall not be applied for
media with e2e media security.
Table 5.19.1-1: Behaviour of MSRP clients and related IMS-ALG and IMS-AGW
procedures for MSRP with different extensions.
+----------+----------+----------+----------+----------+----------+ | IETF | MSRP | Session | IMS-AGW | IMS-ALG | Support | | d | client | matching | needs to | needs to | of | | ocument: | takes | at MSRP | insert | modify | e | | | des | client | own | SDP path | xtension | | | tination | between | address | a | is | | | address | SDP path | into | ttribute | ne | | | for TCP | and | \"T | | gotiated | | | co | \"T | oâ€‘Path\" | | | | | nnection | o-Path\" | in MSRP | | | | | setup | in MSRP | messages | | | | | from | messages | | | | | | | includes | | | | | | | address | | | | | | | inf | | | | | | | ormation | | | | +==========+==========+==========+==========+==========+==========+ | **IETF | SDP MSRP | Yes | Yes | Yes | - | | RFC 4975 | path | | | | | | [25]** | a | | | | | | | ttribute | | | | | +----------+----------+----------+----------+----------+----------+ | * | SDP MSRP | No | No | Yes | No | | _Expired | path | | | | | | dr | a | | | | | | aft-ietf | ttribute | | | | | | -simple- | | | | | | | msrp-ses | | | | | | | smatch_ _| | | | | | +----------+----------+----------+----------+----------+----------+ |__IETF | SDP | Yes | No | No | Yes, via | | RFC 6714 | c-line | | | | SDP CEMA | | [26]_ * | and | | (Yes if | | a | | | m-line | | fallback | | ttribute | | | | | to IETF | | | | | | | RFC 4975 | | | | | | | [6] | | | | | | | occurs | | | | | | | and is | | | | | | | su | | | | | | | pported) | | | +----------+----------+----------+----------+----------+----------+
### 5.19.2 IMS-ALG procedures to support IETF RFC 6714 with application
agnostic MSRP handling by the IMS-AGW
A peer applying IETF RFC 6714 [26] will include the \"a=msrp-cema\" SDP
attribute in the first SDP offer it sends.
If the \"a=msrp-cema\" SDP attribute is contained in an SDP offer, the IMS-
ALG:
\- shall ensure that the IMS-AGW performs application agnostic MSRP handling
by not configuring the IMS-AGW to apply application-aware MSRP interworking;
\- shall indicate \"TCP\" or \"TCP/TLS\" (if e2ae media security is applied)
as transport protocol to the IMSâ€‘AGW;
\- shall forward the \"a=path\" attribute and the \"a=msrp-cema\" SDP
attribute in the SDP offer without modification; and
\- shall forward the \"a=path\" SDP attribute in the corresponding SDP answer
without modification (even if the \"a=msrp-cema\" SDP attribute is not
contained in the answer).
NOTE: If the \"a=msrp-cema\" SDP attribute is not contained in the SDP answer
and the \"a=path\" SDP attribute is not modified, the offerer will discover a
mismatch and send a new SDP offer without the \"a=msrp-cema\" SDP attribute
according to IETF RFC 6714 [26] procedures.
If the \"a=msrp-cema\" SDP attribute is not contained in an SDP offer, the IMS
ALG shall either apply the procedures in clause 5.19.3 or clause 5.19.4 (if
supported).
### 5.19.3 IMS-ALG procedures to support IETF draft-ietf-simple-msrp-sessmatch
with application agnostic MSRP handling by the IMS-AGW
A peer applying the expired IETF draft-ietf-simple-msrp-sessmatch will not
include the \"a=msrp-cema\" SDP attribute in the SDP it sends, and will only
compare the session-id part of the first MSRP URI in the SDP \"a=path\"
attribute with the session-id part of the first MSRP URI in the \"To-Path\"
header field of the first received MSRP packet.
If the \"a=msrp-cema\" SDP attribute is not contained in an SDP offer, the
IMS-ALG:
\- shall ensure that the IMS-AGW performs application agnostic MSRP handling
by not configuring the IMS-AGW to apply application-aware MSRP interworking;
\- shall indicate \"TCP\" or \"TCP/TLS\" (if e2ae media security is applied)
as transport protocol to the IMSâ€‘AGW; and
\- shall replace the IP address and TCP port in the only entry of the
\"a=path\" SDP attribute in received SDP offer or answer with the IP address
and TCP port allocated for the media stream at the IMS-AGW before forwarding
the SDP.
### 5.19.4 IMS-ALG procedures for application aware MSRP interworking by the
IMS-AGW
The IMS ALG:
\- shall provide the SDP \"a=path\" attribute, as received in SIP/SDP
signalling, to the IMSâ€‘AGW as \"MSRP Path\" with the remote descriptor of the
corresponding call leg;
\- shall ensure that the IMS-AGW performs application aware MSRP interworking
by configuring the IMS-AGW to apply application-aware MSRP interworking; and
\- shall indicate \"TCP/MSRP\" or \"TCP/TLS/MSRP\" (if e2ae media security is
applied) as transport protocol to the IMSâ€‘AGW.
If interworking between an MSRP client applying IETF RFC 6714 [26] and an MSRP
client applying IETF RFC 4975 [25] without extensions by either IETF RFC 6714
[26] or IETF draft-ietf-simple-msrp-sessmatch needs to be supported, the IMS
ALG should:
\- when receiving an SDP offer including the \"a=msrp-cema\" SDP attribute,
include the \"a=msrp-cema\" SDP attribute in the SDP answer on that call leg;
\- when sending an SDP offer, include the \"a=msrp-cema\" SDP attribute; and
\- if the \"a=msrp-cema\" SDP attribute is not contained in a received SDP
answer and the SDP c/m-line address information does not match the \"a=path\"
attribute, send a new SDP offer without the \"a=msrp-cema\" SDP attribute
according to IETF RFC 6714 [26] procedures.
NOTE: The second SDP offer can be omitted if the IMS-ALG knows that there is
no SBC in the path (e.g. between the IMS-ALG and the UE).
### 5.19.5 Application-aware MSRP interworking at the IMS-AGW
The IMSâ€‘AGW shall apply application-aware MSRP interworking either if being
statically configured to do so, or if being instructed from the IMS-ALG.
Support of dynamic instructions from the IMS-ALG is optional.
To apply application-aware MSRP interworking, the IMS-AGW:
\- shall modify the MSRP \"To-Path\" header field in application (i.e. MSRP)
data by replacing the IP address and TCP port of the only entry with the
corresponding information in the \"MSRP path\" provided by the IMS_ALG while
retaining the MSRP session ID part of the entry as received in the MSRP \"To-
Path\"; and
\- shall forward the MSRP data without further modification.
NOTE: MSRP session matching will be performed only be the MSRP clients.
### 5.19.6 MSRP data channels
MSRP signalling can be transferred over WebRTC data channels as a data channel
sub-protocol using the SDP offer/answer negotiation according to IETF RFC 8873
[62]. WebRTC data channels are described in clause 5.20.2. For WebRTC
terminations the procedures in clause 5.19 shall apply with the modifications
described in the present clause.
Within received SIP/SDP signalling related to a WebRTC termination MSRP
contents within a data channel will be marked with the
\"subprotocol=\"MSRP\"\" subfield in the \"a=dcmap\" SDP attribute according
to IETF RFC 8864 [65]. The MSRP related \"a=msrp-cema\", \"a=path\",
\"a=accept-types\" and \"a=setup\" SDP attributes will be encapsulated in
\"a=dcsa\" SDP attributes according to IETF RFC 8864 [65]. The \"a=msrp-cema\"
can be present or omitted in received SIP/SDP signalling related to a
termination where no WebRTC data channel is to be used, but IETF RFC 6714 [26]
is always applicable for MSRP within WebRTC data channels and the \"a=msrp-
cema\" shall be present in SIP/SDP signalling related to a WebRTC termination.
When receiving an SDP offer including such MSRP related information in SIP/SDP
signalling related to a WebRTC data channel, and forwarding the SDP offer
towards a termination where no WebRTC data channel is to be used, the IMS-ALG
shall:
\- describe each MSRP data channel in a separate SDP media line in the SDP
offer it forwards;
\- include \"a=msrp-cema\", \"a=path\", \"a=accept-types\" and \"a=setup\" SDP
attributes received encapsulated in \"a=dcsa\" SDP attributes in the forwarded
SDP offer for the corresponding MSRP media line(s) without the encapsulation;
and
\- execute the procedures in the clause 5.19 as if an \"a=msrp-cema\" SDP
attribute had been received.
\- execute the procedures in the clause 5.19 as if an \"a=msrp-cema\" SDP
attribute had been received.
When receiving an SDP offer including MSRP related information without an
indication of WebRTC data channel usage in SIP/SDP signalling, and forwarding
the SDP offer towards a termination where a WebRTC data channel is to be used,
the IMS-ALG shall:
\- describe each received MSRP media line as a separate data channel;
\- include any received \"a=msrp-cema\", \"a=path\", \"a=accept-types\" and
\"a=setup\" SDP attributes received for the MSRP media line(s) encapsulated in
\"a=dcsa\" SDP attributes in the forwarded SDP offer;
\- if the \"a=msrp-cema\" SDP attribute was not received for the MSRP media
line(s), include \"a=msrp-cema\" SDP attribute for the corresponding MSRP
media line(s) encapsulated in \"a=dcsa\" SDP attribute in the forwarded SDP
offer;
\- include an \"subprotocol=_\"_ MSRP _\"_ \" subfield in a \"a=dcmap\" SDP
attribute; and
\- not include the \"max-retr\", \"max-time\" and \"ordered\" parameters in
the \"a=dcmap\" SDP attribute.
For terminations with MSRP within a WebRTC data channel, the IMS-ALG shall:
\- indicate a transport protocol according to clause 5.20.2 to the eIMS-AGW;
and
\- for application aware MSRP interworking:
a) indicate that MSRP is used within the data channel to the eIMS-AGW; and
b) provide the SDP \"a=path\" attribute encapsulated in \"a=dcsa\" SDP
attribute, as received in SIP/SDP signalling, to the eIMSâ€‘AGW as
\"Encapsulated MSRP Path\" with the remote descriptor of the corresponding
call leg.
## 5.20 Web Real-Time Communication (WebRTC)
### 5.20.1 General
The following requirements apply for a \"P-CSCF enhanced for WebRTC (eP-
CSCF)\" and an \"IMS-AGW enhanced for WebRTC (eIMS-AGW)\":
\- End-to-access-edge security for RTP based media using DTLS-SRTP, clause
5.11.2.4, shall be supported.
\- End-to-access-edge security for RTP based media using DTLS-SRTP over TCP
transport, clause 5.11.2.5, may be supported.
\- Interactive Connectivity Establishment (ICE), clause 5.18, shall be
supported. ICE for TCP may be supported in addition to offer an alternative
transport for UDP based media as specified in clause 5.18.
\- STUN Consent Freshness, clause 5.18.4, shall be supported.
\- RTP/RTCP transport multiplexing, clause 5.9.2 shall be supported.
\- Audio transcoding, clause 5.13, shall be supported. Video transcoding may
be supported.
\- Transcoding to/from the Opus Audio Codec, IETF RFC 6716 [50], clause
5.13.4, should be supported.
\- Procedures for the eIMS-AGW to act as a data channel endpoint should be
supported according to IETF draft ietf-rtcweb-data-channel [61], see clause
5.20.2.
\- Data channels used for WebRTC to transport MSRP as a data channel sub-
protocol, i.e. MSRP data channels between the UE and the eIMS-AGW should be
supported according to IETF **RFC 8873** [62] and the procedures in clause
5.19.6. SCTP/DTLS/UDP should be transported as protocol stack for data
channels and SCTP/DTLS/TCP may be supported.
\- Data channels used for WebRTC to transport T.140 (used for Global Text
Telephony, GTT) as a data channel sub-protocol, i.e. T.140 data channels
between the UE and the eIMS-AGW may be supported according to IETF RFC 8865
[75] and the procedures in clause 5.20.2.6.
\- The media plane optimization procedures in clause 5.20.3 may be supported.
### 5.20.2 WebRTC data channel
#### 5.20.2.1 General
In the WebRTC framework, non-media data communication between UEs is handled
by using data channels according to IETF RFC 8831 [61]; within SCTP (see IETF
RFC 4960 [63]), encapsulated in DTLS. The related SDP signalling is described
in IETF RFC 8841 [64] and IETF RFC 8864 [65].
#### 5.20.2.2 Data Channel Establishment
Data channels can use either a SCTP/DTLS/UDP or SCTP/DTLS/TCP based transport.
If the eP-CSCF (IMS-ALG) and the eIMS-AGW support data channels, they shall
support the SCTP/DTLS/UDP based transport and may support the SCTP/DTLS/TCP
based transport.
NOTE 1: This clause assumes that the UDP based option is used as default ICE
candidate for WebRTC terminations. TCP based transport can be offered in
addition as alternative transport using ICE for TCP as specified in clause
5.18.
Upon receipt of an SDP offer containing SDP attributes for new SCTP
associations and/or new data channels according to IETF RFC 8841 [64] and IETF
RFC 8864 [65] from the WebRTC access network, the eP-CSCF (IMS-ALG):
\- shall check if a new DTLS association and SCTP association is to be set up
or an existing DTLS association and SCTP association are to be reused (NOTE 1)
according to IETF RFC 8842 [81] and IETF RFC 8841 [64];
NOTE 2: The present procedures assume that the DTLS association and SCTP
association are established together. A separate establishment of DTLS
association and SCTP association is not supported in the present release.
\- if a new DTLS connection and SCTP association are to be set up:
1) shall request a new H.248 stream group (see details below) on a new
termination towards the WebRTC access network from the eIMS-AGW;
2) shall request a deaggregation stream to handle the SCTP association and
DTLS association, and for the H.248 deaggregation stream:
a) shall send the remote UDP port and SCTP port to the eIMS-AGW;
b) shall request the local UDP port and SCTP port from the eIMS-AGW;
c) shall insert the local UDP port and SCTP port received from the eIMS-AGW
into the SDP answer towards the WebRTC access network;
d) shall provide the remote SCTP maximum message size, as received within the
\"a=max-message-size\" SDP attribute, to the eIMS-AGW;
e) shall request the eIMS-AGW to provide its own local SCTP maximum message
size;
f) shall insert the SCTP maximum message size received from the eIMS-AGW into
the SDP answer towards the WebRTC access network;
g) shall check the received value of the \"a=setup\" SDP attribute to
determine if the eIMS-AGW needs to act as DTLS client or DTLS server. When the
received value is equal to:
i) \"active\" the eIMS-AGW needs to act as DTLS server;
ii) \"passive\" the eIMS-AGW needs to act as DTLS client; or
iii) \"actpass\" the eP-CSCF (IMS-ALG) shall decide if the eIMS-AGW needs to
act as DTLS client or DTLS server;
h) if the eIMS-AGW needs to act as DTLS client;
i) shall provide the Establish (D)TLS session information element to request
the eIMS-AGW to start the DTLS session setup; and
ii) shall provide the Establish SCTP association information element to
request the eIMS-AGW to start the SCTP association setup as soon as DTLS
association is data transfer ready;
NOTE 3: Such an H.248 control leads to the emulation of \"simultaneous SCTP
association establishment\" (i.e., the eIMS-AGW behaves according to clause
5.2.1 of IETF RFC 4960 [63]).
i) if the eIMS-AGW needs to act as DTLS server, may include the Notify (D)TLS
session establishment information element to request the eIMS-AGW to notify
the eP-CSCF (IMS-ALG) about an incoming DTLS session setup;
j) shall indicate to the eIMS-AGW \"UDP/DTLS/SCTP\" as transport protocol;
k) shall provide to the eIMS-AGW the Remote certificate fingerprint
information element with the value of the received fingerprint SDP
attribute(s) from the WIC;
l) shall include the Local certificate fingerprint Request information element
to request the certificate fingerprint of the eIMS-AGW; and
m) shall indicate to the eIMS-AGW the SCTP stream identifiers of H.248
component stream(s) (i.e. SCTP streams corresponding to data channels) to be
de-multiplexed;
3) shall indicate the grouping of the H.248 deaggregation stream and the H.248
component stream(s) with SCTP semantics to the eIMS-AGW; and
4) shall request the eIMS-AGW to provide a notification when receiving an SCTP
stream reset request and to autonomously answer that SCTP stream reset
request;
\- if an existing DTLS association and SCTP association are to be reused,
shall modify the existing termination for that SCTP association by:
1) indicating to the eIMS-AGW the SCTP stream identifiers of H.248 component
stream(s) (i.e. SCTP streams corresponding to data channels) to be de-
multiplexed; and
2) indicating the H.248 stream grouping of the H.248 deaggregation stream and
the H.248 component stream(s) with SCTP semantics to the eIMS-AGW;
NOTE 4: The information element relates to an H.248 Stream Group (SG) which
allows:\ a) to separate the protocol stack in the levels of data channels (DC)
and the commonly shared lower transport, and\ b) to support multiple DCs. The
SG is part of the WebRTC termination.
\- for each data channel to be established:
1) shall reserve a separate H.248 stream at the termination towards the WebRTC
access network;
2) shall provide the SCTP stream identifier to the eIMS-AGW;
3) shall provide the information received in the SDP \"a=dcmap\" attribute to
the eIMS-AGW;
NOTE 5: For MSRP and T.140 within data channels, the default values of the
\"max-retr\" parameter, the \"max-time\" parameter and the \"ordered\"
parameter apply and those parameters are not included.
4) if application aware handling of the contents within the data channel is
required, may provide the information received in SDP \"a=dcsa\" attributes to
the eIMS-AGW as \"remote dcsa\" information elements, taking into account the
specific procedures defined for the subprotocols within the data channel;
5) if the first data channel is to be established, shall reserve a termination
towards the core network;
6) shall reserve a H.248 stream towards the core network;
7) shall indicate to the eIMS-AGW how to interwork the information send or
received in data channels with information send or received on streams towards
the IMS core network by using the same H.248 stream identifier for the H.248
stream towards the WebRTC access network and towards the core network;
8) shall indicate to the eIMS-AGW an appropriate transport protocol towards
the IMS core network (e.g. \"TCP\" for MSRP) for the media described in the
dcmap attribute for the data channel when reserving the transport
addresses/resources towards the IMS core network;
9) shall provide an appropriate media line for the media described in the
dcmap attribute in the SDP offer towards the IMS core network; and
10) should de-encapsulate SDP attributes within the received SDP \"a=dcsa\"
attributes in the SDP offer and include the de-encapsulated SDP attributes in
the SDP offer towards the IMS core network as media attributes for the media
line corresponding to the data channel, taking into account specific
procedures defined for the subprotocol within the data channel; and
\- shall remove the \"a=setup\", \"a=connection\" \"a=dcmap\" and possible
\"a=dcsa\" SDP attributes and fingerprint information from the SDP offer
towards the IMS core network.
Upon receipt of a corresponding SDP answer from the IMS core network, if the
SDP answer does not indicate that media plane optimization is to be applied
(see clause 5.20.3.2), the eP-CSCF (IMS-ALG):
\- instead of the media line(s) describing media that are to be transported
within data channel(s), shall provide an \"m=\" line with the transport
protocol \"UDP/DTLS/SCTP\";
\- shall insert the fingerprint SDP attribute with the value of the Local
certificate fingerprint information element received from the eIMS-AGW;
\- if the IMS-ALG received from the WIC an SDP offer with \"a=tls-id\" media-
level SDP attribute for the DTLS association:
1) if an existing DTLS association is reused, shall include the \"a=tls-id\"
SDP attribute with the value assigned to that DTLS association in the SDP
answer which the IMS-ALG sends to the WIC; and
2) if a new DTLS association is to be established, shall include the \"a=tls-
id\" SDP attribute with a new unique value in the SDP answer which the IMS-ALG
sends to the WIC;
\- shall insert the \"a=setup\" SDP attribute with the value:
1) \"active\" if the eP-CSCF (IMS-ALG) requested the eIMS-AGW to act as DTLS
client; or
2) \"passive\" if the eIMS-AGW shall take the DTLS server role; and
\- for each received media line describing media that are to be transported
within a data channel:
1) shall insert an \"a=dcmap\" attribute with the same values for the SCTP
stream identifier, \"subprotocol\" and \"label\" parameters as received in the
SDP offer, and with possible values for the \"max-retr\", \"max-time\", and
\"ordered\" parameters according to the requirements of the transported data
flow and capabilities of the eIMS-AGW;
NOTE 6: For MSRP and T.140 within data channels, the default values of the
\"max-retr\" parameter, the \"max-time\" parameter and the \"ordered\"
parameter apply and those parameters are not included.
2) should insert SDP \"a=dcsa\" attributes into the SDP answer towards the
WebRTC access network encapsulating subprotocol specific SDP attributes
received in the SDP answer, taking into account specific procedures defined
for the subprotocol within the data channel;
3) shall provide the information in the sent SDP \"a=dcmap\" attribute to the
eIMS-AGW; and
4) may provide the information within the sent SDP \"a=dcsa\" attributes to
the eIMS-AGW as \"local dcsa\" information elements, taking into account
specific procedures defined for the subprotocol within the data channel.
Upon receipt of an SDP offer from the IMS core network for new media streams
that need to be transported within a WebRTC data channel on the WebRTC access
network, if the SDP offer does not indicate that media plane optimization is
to be applied (see clause 5.20.3.3), the eP-CSCF (IMS-ALG):
\- shall determine if it can reuse an existing DTLS association and SCTP
association or if it needs to set up a new DTLS association and SCTP
association;
\- if a new DTLS association and SCTP association are to be set up:
1) shall request a new termination towards the WebRTC access network from the
eIMS-AGW;
2) shall request a deaggregation stream to handle the SCTP association and
DTLS association, and for the H.248 deaggregation stream:
a) shall request the local UDP port and SCTP port from the eIMS-AGW;
b) shall insert the local UDP port and SCTP port received from the eIMS-AGW
into the SDP offer towards the WebRTC access network;
c) shall request the eIMS-AGW to provide its own local SCTP maximum message
size;
d) shall insert the SCTP maximum message size received from the eIMS-AGW into
the SDP offer towards the WebRTC access network;
e) shall add an SDP \"a=setup\" attribute with value \"actpass\" into the SDP
offer;
f) shall indicate to the eIMS-AGW \"UDP/DTLS/SCTP\" as transport protocol;
g) shall include the Local certificate fingerprint Request information element
to request the certificate fingerprint of the eIMS-AGW;
h shall insert the fingerprint SDP attribute with the value of the Local
certificate fingerprint information element received from the eIMS-AGW into
the SDP offer towards the WebRTC access network; and
i) shall indicate to the eIMS-AGW the SCTP stream identifiers of H.248
component stream(s) (i.e. SCTP streams corresponding to data channels) to be
de-multiplexed;
3) shall indicate the H.248 stream grouping of the H.248 deaggregation stream
and the H.248 component stream(s) with SCTP semantics to the eIMS-AGW; and
4) shall request the eIMS-AGW to provide a notification when receiving an SCTP
stream reset request and to autonomously answer that SCTP stream reset
request;
\- if an existing DTLS association and SCTP association are to be reused,
shall modify the existing termination towards the WebRTC access network for
that SCTP association by:
1) indicating to the eIMS-AGW the SCTP stream identifiers of H.248 component
stream(s) (i.e. SCTP streams corresponding to data channels) to be de-
multiplexed; and
2) indicating the H.248 stream grouping of the H.248 deaggregation stream and
the H.248 component stream(s) with SCTP semantics to the eIMS-AGW;
\- instead of the media line(s) describing media that are to be transported
within data channel(s), shall provide an \"m=\" line with the transport
protocol \"UDP/DTLS/SCTP\";
\- shall insert an \"a=tls-id\" SDP attribute in the SDP offer with a new or
reused value (depending on whether an existing DTLS association is reused);
and
\- for each received media line describing media that are to be transported
within a data channel:
1) shall reserve a separate H.248 stream at the termination towards the WebRTC
access network;
2) shall insert an \"a=dcmap\" attribute with an unused SCTP stream
identifier, and with \"subprotocol\" and \"label\" parameters according to the
requirements of the transported data flow, and with possible values for the
\"max-retr\", \"max-time\", and \"ordered\" parameters according to the
requirements of the transported data flow and capabilities of the eIMS-AGW;
NOTE 7: For MSRP and T.140 within data channels, the default values of the
\"max-retr\" parameter, the \"max-time\" parameter and the \"ordered\"
parameter apply and those parameters are not included.
3) shall provide the SCTP stream identifier to the eIMS-AGW;
4) shall provide the information in the sent SDP \"a=dcmap\" attribute to the
eIMS-AGW;
5) should insert SDP \"a=dcsa\" attributes into the SDP offer towards the
WebRTC access network encapsulating any subprotocol specific SDP attributes
received in the SDP offer, taking into account specific procedures defined for
the subprotocol within the data channel;
6) if application aware handling of the contents within the data channel is
required, may provide the information within the sent SDP \"a=dcsa\"
attributes to the eIMS-AGW as \"local dcsa\" information elements, taking into
account specific procedures defined for the subprotocol within the data
channel;
7) if the first data channel is to be established, shall reserve a termination
towards the core network;
8) shall reserve a H.248 stream towards the core network; and
9) shall indicate to the eIMS-AGW how to interwork the information sent or
received in data channels with information sent or received on terminations
and/or streams towards the IMS core network by using the same H.248 stream
identifier for the stream towards the WebRTC access network and towards the
core network.
Upon receipt of a corresponding SDP answer from the WebRTC access network, the
eP-CSCF (IMS-ALG):
\- if a new DTLS association and SCTP association are to be set up, for the
H.248 deaggregation stream to handle the SCTP association and DTLS connection:
1) shall send the received remote UDP port and SCTP port to the eIMS-AGW;
2) shall include the Remote certificate fingerprint information element with
the value of the received fingerprint SDP attribute(s) from the WebRTC access
network;
3) shall check the received value of the \"a=setup\" SDP attribute to
determine if the eIMS-AGW needs to act as DTLS client or DTLS server. When the
received value is equal to:
a) \"active\" the eIMS-AGW needs to act as DTLS server; or
b) \"passive\" the eIMS-AGW needs to act as DTLS client;
4) if the eIMS-AGW needs to act as DTLS client:
a) shall include the Establish (D)TLS session information element to request
the eIMS-AGW to start the DTLS session setup; and
b) shall provide the Establish SCTP association information element to request
the eIMS-AGW to start the SCTP association setup as soon as DTLS connection is
data transfer ready;
5) if the eIMS-AGW needs to act as DTLS server, may include the Notify (D)TLS
session establishment information element to request the eIMS-AGW to notify
the eP-CSCF (IMS-ALG) about an incoming DTLS session setup; and
6) shall provide the remote SCTP maximum message size, as received within the
\"a=max-message-size\" SDP attribute, to the eIMS-AGW;
\- shall remove the \"a=setup\", \"a=connection\" \"a=dcmap\" and possible
\"a=dcsa\" SDP attributes and fingerprint information from the SDP answer and
indicate the transport protocol \"TCP\" in the SDP answer towards the IMS core
network; and
\- for each accepted data channel:
1) shall provide the information received in the SDP \"a=dcmap\" attribute to
the eIMS-AGW;
2) if application aware handling of the contents within the data channel is
required, may provide the information within the received SDP \"a=dcsa\"
attributes in the SDP answer to the eIMS-AGW as \"remote dcsa\" information
elements, taking into account specific procedures defined for the subprotocol
within the data channel; and
3) should de-encapsulate SDP attributes within the received SDP \"a=dcsa\"
attributes in the SDP answer and include the de- encapsulated SDP attributes
in the SDP answer towards the IMS core network, taking into account specific
procedures defined for the subprotocol within the data channel.
If requested to set up a new DTLS association and SCTP association, the eIMS-
AGW shall:
\- allocate the local UDP port and SCTP port, and send them to the eP-CSCF
(IMS-ALG);
\- when being instructed to start the DTLS bearer session setup, act as a DTLS
client and establish the DTLS bearer session;
\- upon request from the eP-CSCF (IMS-ALG), provide the SCTP maximum message
size;
\- upon request from the eP-CSCF (IMS-ALG), select an own certificate, and
send the fingerprint of the own certificate to the eP-CSCF (IMS-ALG);
\- uniquely associate the certificate fingerprint(s) received from the eP-CSCF
(IMS-ALG) with the corresponding DTLS association, and subsequently use the
certificate fingerprint(s) to verify the establishment of the DTLS bearer
session;
\- if the verification of the remote certificate fingerprint(s) during the
DTLS bearer session establishment fails, regard the remote DTLS endpoint as
not authenticated, terminate the DTLS bearer session and report the
unsuccessful DTLS bearer session setup to the eP-CSCF (IMS-ALG);
\- upon completion of the DTLS association establishment, set up the SCTP
association according to IETF RFC 4960 [63]; and
\- deaggregate H.248 component streams upon request from the eP-CSCF (IMS-
ALG).
If the eP-CSCF (IMS-ALG) requests that a termination with an existing SCTP
association is being modified, the eIMS-AGW shall reuse an existing DTLS
association and SCTP association.
If the eP-CSCF (IMS-ALG) requests that a new H.248 component stream with a
H.248 stream group related to an SCTP association is being reserved, the eIMS-
AGW shall set up the data channel according to IETF RFC 8831 [61] procedures.
The eIMS-AGW shall also interwork the information sent or received in data
channels with information sent or received on terminations and/or streams
towards the IMS core network according to the configuration received by the
eP-CSCF (IMS-ALG).
NOTE 8: The handling of priority information that is part of the dcmap
information received from the eP-CSCF (IMS-ALG) is left to the eIMS-AGW
implementation.
#### 5.20.2.3 Data Channel Release
##### 5.20.2.3.1 General
In the present Release, the closure of individual WebRTC data channels (clause
5.20.2.3.2) and the complete release of the entire WebRTC data service (clause
5.20.2.3.3) are supported.
NOTE 1: The hierarchical protocol stack for WebRTC data
(\"DC/SCTP/DTLS/(UDP\|TCP)/IP\") contains up to four levels of user plane
bearer control procedures, from top to bottom:\ 1) DC: SCTP Stream
reconfiguration procedures for resetting SCTP Streams;\ 2) SCTP Association:
shutdown procedure;\ 3) DTLS: DTLS connection release procedure (apart from
resumption and renegotiation procedures); and\ 4) TCP: TCP connection release
procedure. (However, TCP transport of WebRTC data channels is not supported in
the present Release).\ The present Release does not consider specific release
variations at levels 2 to 4, such as the shutdown of an SCTP Association
without a DTLS connection release.
A data channel can be closed before the end of the WebRTC call. In the present
Release, the H.248 Stream endpoint related to a data channel may be removed
after the closure of the data channel, but a subsequent reuse of the
corresponding SCTP Stream identifier is possible via an SDP offer-answer
exchange triggering the reservation of new H.248 Stream endpoint.
NOTE 2: There are multiple variations possible because the \"CLOSURE of a data
channel\" results in a reset of the SCTP Stream (see clause 6.7 of IETF RFC
8831 [61]), i.e. the concerned SCTP Stream still exists from protocol stack
perspective. Such a reset SCTP Stream could be reused again (for the same or
another WebRTC data application). There are consequently two options from the
eP-CSCF (IMS-ALG) perspective: the correspondent H.248 Stream endpoint remains
allocated and part of the H.248 Stream Group for a possible future reuse, or
the H.248 Stream endpoint is completely removed from the termination.
##### 5.20.2.3.2 Release of one WebRTC data channel
When the eP-CSCF (IMS-ALG) receives:
\- an SDP offer or answer from the WebRTC access network releasing a
particular WebRTC data channel while maintaining the corresponding SCTP
Association, encoded according to IETF RFC 8864 [65]; or
NOTE 1: Such an SDP offer or answer is characterized by the exclusion of the
\"a=dcmap:\" and \"a=dcsa:\" attribute lines for an existing data channel
(DC). See clause 5.2.4 of IETF RFC 8864 [65] related to the general closure of
an application-agnostic DC and clause 5.1.5 of IETF RFC 8873 [62] for an
example of an application-aware DC closure.
\- an SDP offer or answer from the IMS core network disabling media streams
that need to be transported within a WebRTC data channel on the WebRTC access
network (i.e. media line with port zero) while maintaining other media streams
that are transported within another data channel within the same SCTP
Association enabled; or
\- a notification from the eIMS-AGW that the peer has reset the incoming SCTP
Stream that corresponds to a data channel;
then the eP-CSCF (IMS-ALG):
1) shall provide the _Send SCTP Stream Reset Requests Indicator_ information
element to the eIMS-AGW to request the eIMS-AGW to start the SCTP Stream reset
for the corresponding outgoing SCTP Stream;
NOTE 2: This will trigger the peer to also reset the corresponding incoming
SCTP Stream, unless the peer has already done so before.
2) may provide the _Received SCTP Stream Reset Response_ information element
to the eIMS-AGW if the eP-CSCF (IMS-ALG) wants to receive an explicit
notification from the eIMS-AGW that the peer has reset the corresponding
incoming SCTP Stream;
3) upon the reception of a Notification from the eIMS-AGW that the peer has
reset the corresponding incoming SCTP Stream and the additional notification
from the eIMS-AGW about the result of the outgoing SCTP Stream (if requested),
may release the corresponding H.248 Stream endpoints at the terminations
towards the WebRTC access network and towards the IMS core network;
4) if an received SDP offer or answer from the WebRTC access network triggered
the release of the data channel, shall forward the SDP offer or answer to IMS
core network with the media line corresponding to the media stream in the data
channel disabled by port zero;
5) if an received SDP offer or answer from the IMS core network triggered the
release of the data channel, shall forward the SDP offer or answer to WebRTC
access network with the corresponding WebRTC data channel released with
encoding according to IETF RFC 8864 [65]; and
6) if all of the following conditions apply:
\- a notification from the eIMS-AGW that the peer has reset the incoming SCTP
Stream triggered the release of the data channel;
\- the application subprotocol does not mandate that the closing of a data
channel is also signalled via a new SDP offer/answer exchange; and
\- no corresponding SIP/SDP information is received in due time;
should send the appropriate SIP message with the SDP body to the IMS core
network with the media line corresponding to the media stream in the data
channel disabled by port zero.
NOTE 3: According to IETF RFC 8864 [65], it is specific to the subprotocol
whether this closing of a data channel MUST in addition the the SCTP SCTP SSN
reset also be signalled to the peer via a new SDP offer/answer exchange. For
MSRP, if the peer triggers a data channel release by resetting the incoming
SCTP Stream, it is also mandated to send corresponding SIP/SDP information.
##### 5.20.2.3.3 Release of all or last active WebRTC data channels within an
SCTP Association
When the eP-CSCF (IMS-ALG) receives:
\- an SDP offer or answer from the WebRTC access network requesting to release
the SCTP Association used to transport data channels, encoded according to
IETF RFC 8864 [65] (i.e. media line with port zero); or
\- an SDP offer or answer from the IMS core network disabling all media
stream(s) that need to be transported within a WebRTC data channel on the
WebRTC access network (i.e. media line(s) with port zero);
then the eP-CSCF (IMS-ALG):
1) shall release the corresponding H.248 Stream group or termination towards
the WebRTC access network;
NOTE 1: In the present release, a separate DTLS connection is used for each
for each SCTP Association and for each audio or video media stream (for their
DTLS-SRTP-based key exchange).
2) shall release the corresponding H.248 streamendpoint(s) or termination
towards the IMS core network;
NOTE 2: If a new SDP offer from the access network arrives that requests a new
data channel, then a stream end point and possibly a termination towards the
IMS core network has to be added again.
3) if an received SDP offer or answer from the WebRTC access network triggered
the release of the SCTP Association, shall forward the SDP offer or answer to
the IMS core network with all media line(s) corresponding to the media
stream(s) in the data channel(s) within that SCTP Association disabled by port
zero; and
4) if an received SDP offer or answer from the IMS core network triggered the
release of the SCTP Association, shall forward the SDP offer or answer to
WebRTC access network with the corresponding release of the SCTP Association
with encoding according to IETF RFC 8864 [65] (i.e. media line with port
zero).
When the eP-CSCF (IMS-ALG) requests the eIMS-AGW to release an entire H.248
Stream group or termination associated with an SCTP Association, then the
eIMS-AGW should execute appropriate bearer control procedures to release the
DTLS connection.
NOTE 3: If one DTLS connection endpoint closes the DTLS connection (e.g. sends
a DTLS fatal alert), then the other DTLS connection endpoint unambiguously
knows that also the SCTP association and all previously existing data channel
instances are implicitly closed.
NOTE 4: \'TCP\' as L4 protocol is supported for WebRTC audio and video, but
not for data in the present release.
#### 5.20.2.4 MSRP within WebRTC data channel
See clause 5.19.6.
#### 5.20.2.5 Void
#### 5.20.2.6 T.140 within WebRTC data channel
T.140 (see ITUâ€‘T Recommendation T.140 [73]) is used for Global Text Telephony
(GTT). T.140 signalling can be transferred over WebRTC data channels as a data
channel sub-protocol according to IETF RFC 8865 [75]. The WebRTC data channel
procedures in clause 5.20.2.2 shall apply with the modifications described in
the present clause.
T.140 within a data channel is identified via the \"t140\" value of the
\"subprotocol\" parameter of the SDP \"a=dcmap\" attribute.
T.140 transported outside the data channel in the IMS core network is
identified via the \"RTP/AVP\" or \"RTP/AVPF\" value of the \"proto\"
parameter and the \"text\" value of the \"media\" parameter of the SDP m-line,
and via the \"t140\" MIME subtype signalled in the SDP \"a=rtpmap\" attribute
(see IETF RFC 4103 [74]).
The eIMS-ALG shall apply the procedures in clause 5.20.2.2 to configure the
eIMS-AGW for an application-aware handling of the contents within the data
channel.
For the termination toward the IMS core network, the eIMS-ALG:
\- shall provision \"RTP/AVP\" or \"RTP/AVPF\" as transport and the \"t140\"
payload type;
\- shall de-encapsulate the SDP \"fmtp:t140 cps\" attributes, \"sendrecv\",
\"sendonly\", \"recvonly\", \"inactive\", \"hlang-send\" and \"hlang-recv\"
received within \"a=dcsa\" attributes from the served WIC;
\- shall forward those attributes within the SDP body in the corresponding SIP
message sent to the IMS core network; and
\- shall provision the SDP \"fmtp:t140 cps\" attributes to the eIMS-AGW.
For the termination towards the WebRTC access network, the eIMS-ALG:
\- shall not include the \"max-retr\", \"max-time\" and \"ordered\" parameters
in the \"a=dcmap\" SDP attribute;
\- shall encapsulate SDP \"fmtp:t140 cps\", \"sendrecv\", \"sendonly\",
\"recvonly\", \"inactive\", \"hlang-send\" and \"hlang-recv\" attributes
received from the IMS core network within \"a=dcsa\" attributes and forward
those attributes within the SDP body in the corresponding SIP message sent to
the served WIC; and
\- shall provision SDP \"fmtp:t140 cps\" attributes received from the IMS core
network to the eIMS-AGW.
The eIMS-AGW should handle T.140 protocol layer in the following application
specific manner:
\- the eIMS-AGW should detect inactivity of T.140 traffic from the served WIC
and then send empty RTP packets towards the IMS core network;
\- the eIMS-AGW should buffer the T.140 payload received within incoming RTP
packets from the IMS core network to correct out-of-order delivery; and
\- the eIMS-AGW should detect missing RTP packets from the IMS core network
and then send new T140 blocks with \"missing text marker\" information to the
served WIC.
### 5.20.3 Media Plane Optimization
#### 5.20.3.1 General
Media plane optimization procedures for WebRTC are described in 3GPP TS 23.228
[2], annex U.2.4, and in 3GPP TS 24.371 [44], sublause 7.4.5. The purpose of
media plane optimization procedures is to convey media between WebRTC clients
without bearer level protocol conversion. When both ends are WebRTC IMS
clients (WIC), the eIMS-AGWs remain allocated but media plane interworking is
disabled, except when LI is needed. Depending on configuration in the eP-CSCF
(IMS-ALG), the eIMS-AGW then forwards all protocol layers either including
DTLS, or on top of DTLS transparently.
NOTE 1: Terminating the DTLS protocol layer for all calls can improve the
transparency of LI.
NOTE 2: In Rel-13, the media plane optimization procedure only supports the
transparent forwarding of all protocol layers including DTLS, and no related
configuration in the eP-CSCF (IMS-ALG) is thus required. The configuration in
the eP-CSCF (IMS-ALG) needs to take into account if the eIMS-AGW supports the
media plane optimization procedures with DTLS layer termination added in
Rel-14.
The SDP attributes associated with WebRTC media plane optimization procedures
\"tra-contact\", \"tra-m-line\", \"tra-att\", \"tra-SCTP-association\", \"tra-
media-line-number\" and \"tra-bw\" are defined in 3GPP TS 24.229 [11], clause
7.5.4.
#### 5.20.3.2 WIC originating call
If an eP-CSCF (IMS-ALG) forwards an SDP offer from the WIC, and supports media
plane optimization, and does not need to perform legal interception, then the
eP-CSCF (IMS-ALG) will include media suitable for non-WebRTC IMS UEs, but also
encapsulate information about the media in the original encoding as received
in the SDP offer from the WIC in \"tra-m-line\", \"tra-att\" and \"tra-bw\"
SDP attributes, as described in 3GPP TS 24.371 [44]. The eP-CSCF (IMS-ALG)
shall:
\- configure the eIMS-AGW to reserve resources suitable for the media
described in the SDP offer outside the \"tra-m-line\", \"tra-att\" and \"tra-
bw\" SDP attributes;
\- include the IP address received from the eIMS-AGW for the termination
towards the IMS core network in the SDP contact line and also encapsulate the
address information provided by the eIMS-AGW into a \"tra-contact\" attribute;
\- if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
including the DTLS layer, for each media line in the SDP offer sent on the Mw
interface that does not relate to a data channel or that is the first media
line within the SDP offer that relates to a data channel, replace the UDP port
number with a port number provided by the eIMS-AGW and encapsulate the UDP
port number allocated by the eIMS-AGW in the \"tra-m-line\" SDP attribute; and
\- if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
excluding the DTLS layer, in addition for each media line in the SDP offer
sent on the Mw interface that does not relate to a data channel or that is the
first media line within the SDP offer that relates to a data channel within
one SCTP association:
a) reserve a stream endpoint or termination towards the IMS core network in
\"inactive\" mode with \"UDP/DTLS\" as transport protocol, and the same IP
address as allocated by the eIMS-AGW for the termination or stream endpoint
with resources suitable for the media described in the SDP offer outside the
\"tra-m-line\", \"tra-att\" and \"tra-bw\" SDP attributes;
b) request from the eIMS-AGW a certificate fingerprint for that stream
endpoint or termination;
c) encapsulate a \"fingerprint\" attribute as provided by the eIMS-AGW into an
\"tra-att\" attribute, and add this attribute as a media level attribute in
the SDP offer; and
d) for a DTLS association that will be established towards the IMS core
network create a DTLS association identity;
e) encapsulate an \"a=tls-id\" SDP attribute with the new DTLS association
identity into an \"tra-att\" attribute, and add this attribute as a media
level attribute in the SDP offer; and
f) replace the UDP port number with a port number provided by the eIMS-AGW and
encapsulate the UDP port number allocated by the eIMS-AGW for the stream
endpoint or termination towards the IMS core network with \"UDP/DTLS\"
transport in the \"tra-m-line\" SDP attribute.
If an ePCSCF (IMS-ALG) receives an SDP answer from the IMS core network and
the SDP answer includes \"tra-m-line\" media level SDP attributes, the eP-CSCF
(IMS-ALG) will de-encapsulate information to the optimized media from the
received SDP answer and construct the SDP answer towards the WIC based on that
de-encapsulated information as described in 3GPP TS 24.371 [44]. The eP-CSCF
(IMS-ALG) shall:
\- for each media line in the SDP answer, which is not marked with a \"tra-
SCTP-association\" SDP attribute or which is the first media line in the SDP
answer marked with a \"tra-SCTP-association\" SDP attribute that indicates an
SCTP association:
1\. if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
including the DTLS layer, reconfigure the terminations or stream endpoints
towards the IMS core network and towards the WIC related to that media line to
transport \"UDP\" and media format agnostic information; or
NOTE: If interconnected H.248 Stream endpoints or terminations at the eIMS-AGW
are configured with transport \"UDP\", they will pass the payload within UDP
without modifications, known as UDP transparent forwarding. For WebRTC media
plane optimization, the UDP payload will be either DTLS encapsulating SCTP and
data channel(s), DTLS-SRTP encapsulating key management information, or SRTP
encapsulating audio or video media. However, the eIMS-AGW will be configured
at terminations towards the WIC to apply ICE procedures according to clause
5.18.
2\. if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
excluding the DTLS layer:
a) configure the eIMS-AGW to release the termination or stream endpoint
towards the IMS core network with resources suitable for the media described
in the SDP offer outside the \"tra-m-line\", \"tra-att\" and \"tra-bw\" SDP
attributes;
b) configure the eIMS-AGW to through-connect the stream endpoint or
termination towards the IMS core network with \"UDP/DTLS\" as transport
protocol;
provide the fingerprint(s) received in the corresponding \"tra-att\" SDP
attribute(s) to the eIMS-AGW for the stream endpoint or termination towards
the IMS core network and do not provide those fingerprint attribute(s) towards
the WIC;
d) reserve a stream endpoint or termination towards the WIC with \"UDP/DTLS\"
as transport protocol;
e) provide the fingerprint(s) received in the corresponding \"fingerprint\"
SDP attribute(s) in the previous SDP offer from the WIC to the eIMS-AGW for
the stream endpoint or termination towards the WIC;
f) request from the eIMS-AGW a certificate fingerprint for the stream endpoint
or termination towards the WIC;
g) include fingerprint provided by the eIMS-AGW into an \"fingerprint\"
attribute, and add this attribute as a media level attribute in the SDP answer
sent towards the WIC;
h) for a DTLS association that will be established towards WIC create a DTLS
association identity and include an \"a=tls-id\" attribute with the new DTLS
association identity in the SDP answer sent towards the WIC;
i) determine via the SDP \"a=setup\" attribute (see IETF RFC 7345 [33])
encapsulated in \"tra-att\" SDP attribute if the eIMS-AGW needs to act as DTLS
client or DTLS server towards the IMS core network and towards the WIC; and
j) for the termination where the eIMS-AGW needs to act as DTLS server, provide
the Establish (D)TLS session information element to request the eIMS-AGW to
start the DTLS session setup; and
3\. include the UDP port number allocated by the eIMS-AGW for the termination
or stream endpoint towards the WIC in the SDP media line in the SDP answer to
the WIC;
\- include the IP address received from the eIMS-AGW for the termination
towards the WIC in the SDP contact line sent toward the WIC; and
\- if several media lines in the SDP answer are marked with \"tra-SCTP-
association\" SDP attributes indicating the same SCTP association, release the
stream endpoints related to the second and subsequent of those media lines (in
the order they appear in the SDP answer).
#### 5.20.3.3 WIC terminating call
If an eP-CSCF (IMS-ALG) receives an SDP offer from the IMS core network and
the eP-CSCF (IMS-ALG) supports media plane optimization, then the eP-CSCF
(IMS-ALG) will determine whether media plane optimization is to be applied as
described in 3GPP TS 24.371 [44]. If media plane optimization is to be
applied, then the eP-CSCF (IMS-ALG) will de-encapsulate information to the
optimized media from the received SDP offer and construct the SDP offer
towards the WIC based on that de-encapsulated information as described in 3GPP
TS 24.371 [44], and the eP-CSCF (IMS-ALG) shall:
\- for each media line in the SDP offer, which is not marked with a \"tra-
SCTP-association\" SDP attribute or which is the first media line in the SDP
answer marked with \"tra-SCTP-association\" SDP attribute that indicates an
SCTP association:
1\. reserve a termination or stream endpoint towards the WIC related to that
media line;
2\. if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
including the DTLS layer, provide transport \"UDP\" and media format agnostic
information for the termination or stream endpoint towards the WIC;
NOTE: If interconnected H.248 Stream endpoints or terminations at the eIMS-AGW
are configured with transport \"UDP\", they will pass the payload within UDP
without modifications, known as UDP transparent forwarding. For WebRTC media
plane optimization, the UDP payload will be either DTLS encapsulating SCTP and
data channel(s) or DTLS-SRTP encapsulating key management information, or SRTP
encapsulating audio or video media. However, the eIMS-AGW will be configured
at terminations towards the WIC to apply ICE procedures according to clause
5.18.
3\. if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
excluding the DTLS layer:
a) provide transport \"UDP/DTLS\" and media format agnostic information for
the termination or stream endpoints toward the WIC;
b) request from the eIMS-AGW a certificate fingerprint for the stream endpoint
or termination towards the WIC;
c) encapsulate fingerprint provided by the eIMS-AGW into an \"fingerprint\"
attribute, and add this attribute as a media level attribute in the SDP offer
sent towards the WIC; and
d) do not provide the fingerprint received in the SDP offer in the
corresponding \"tra-att\" SDP attributes towards the WIC;
e) for a DTLS association that will be established towards WIC create a DTLS
association identity, and add an \"a=tls-id\" SDP attribute with the new DTLS
association identity in the SDP offer sent towards the WIC; and
4\. include the UDP port number allocated by the eIMS-AGW for the stream
endpoint or termination towards the WIC in the SDP media line; and
\- include the IP address received from the eIMS-AGW for the termination
towards the WIC in the SDP contact line sent toward the WIC.
If the eP-CSCF (IMS-ALG) receives an SDP answer from the WIC and the eP-CSCF
(IMS-ALG) decided to apply media plane optimization when processing the
corresponding SDP offer, then the eP-CSCF (IMS-ALG) will construct the SDP
answer towards the IMS core network encapsulating received information as
described in 3GPP TS 24.371 [44], and the eP-CSCF (IMS-ALG) shall:
\- reserve a termination or stream endpoint towards the IMS core network;
\- for each media line in the received SDP answer:
1\. if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
including the DTLS layer, provide transport \"UDP\" and media format agnostic
information for the termination or stream endpoint towards the IMS core
network;
2\. if the eP-CSCF (IMS-ALG) is configured to apply media plane optimization
excluding the DTLS layer:
a) provide the fingerprint(s) received in the \"fingerprint\" SDP attribute
from the WIC to the eIMS-AGW for the stream endpoint or termination towards
the WIC;
b) provide transport \"UDP/DTLS\" and media format agnostic information for
the termination or stream endpoint towards the IMS core network;
c) request from the eIMS-AGW a certificate fingerprint for the stream endpoint
or termination towards the IMS core network;
d) encapsulate fingerprint provided by the eIMS-AGW for the termination or
stream endpoint towards the IMS core network into a \"tra-att\" SDP attribute,
and add this attribute as a media level attribute in the SDP answer sent
towards the IMS core network;
e) for a DTLS association that will be established towards the IMS core
network create a DTLS association identity;
f) encapsulate an \"a=tls-id\" SDP attribute with the new DTLS association
identity into an \"tra-att\" attribute, and add this attribute as a media
level attribute in the SDP answer sent towards the IMS core network;
g) determine via the SDP \"a=setup\" attribute (see IETF RFC 7345 [33]) if the
eIMS-AGW needs to act as DTLS client or DTLS server towards the IMS core
network and towards the WIC; and
h) for the termination where the eIMS-AGW needs to act as DTLS server, provide
the Establish (D)TLS session information element to request the eIMS-AGW to
start the DTLS session setup; and
3\. encapsulate the UDP port number allocated by the eIMS-AGW for the stream
endpoint or termination towards the IMS core network in the \"tra-m-line\" SDP
attribute; and
\- include the IP address received from the eIMS-AGW for the termination
towards the IMS core network in the SDP contact line.
## 5.21 Alternate Connection (ALTC) Addresses Management
### 5.21.1 General
The IMS-ALG and the IMS-AGW may support the functionalities related to the
support of the ALTC functionality as specified in IETF RFC 6947 [59] and 3GPP
TS 24.229 [11] to support dual stack UEs. The present clause describes the
requirements for P-CSCF (IMS-ALG) and IMS-AGW when the ALTC procedures are
supported.
If the IMS-ALG supports ALTC and, based on local policies, decides to insert
ALTC information in the SDP offer sent to the terminating side, the IMS-ALG
shall request the IMS-AGW to reserve two sets of transport addresses/resources
towards the access network to enable media to traverse the IMS-AGW, one for
each media line associated to ALTC information. The IMS-ALG shall request the
IMS-AGW to release the transport resources reserved for the address type
finally not used.
## 5.22 Video Region-of-Interest (ROI)
### 5.22.1 General
The IMS-ALG and the IMS-AGW may support the video Region-of-Interest (ROI) as
defined in 3GPP TS 26.114 [21]. Three modes are specified for supporting ROI,
including \"Far End Camera Control (FECC)\", \"Arbitrary ROI\" and
\"Predefined ROI\". The IMS-ALG and the IMS-AGW may independently support any
of these modes.
### 5.22.2 \"Far End Camera Control\" mode
The IMS-ALG and IMS-AGW may support the \"Far End Camera Control\" mode as
specified in 3GPP TS 26.114 [21]. If the IMS-ALG and IMS-AGW support the \"Far
End Camera Control\" mode, the IMS-ALG and IMS-AGW shall apply the procedures
in the present clause.
If the IMS-ALG receives an SDP body containing an \"m=\" line with a media
type \"application/h224\", as defined by IETF RFC 4573 [68] which indicates
support for FECC (ITU-T Recommendation H.281 [70]) using ITU-T Recommendation
H.224 [69], the IMS-ALG shall:
\- forward within SIP signalling the SDP body received from the preceding node
with unmodified SDP \"m=\" and \"a=\" lines related to the
\"application/h224\" media types (see the related SDP examples in annex A.4.2e
of 3GPP TS 26.114 [21]) to the succeeding node; and
NOTE 1: There may be one media type \"application/h224\" \"m=\" line for each
video \"m=\" line.
\- request the IMS-AGW to provide a separate IP/UDP/RTP transport for the
\"application/h224\" media stream by setting the \"m=\" line media type to
\"application\" and \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport protocol
when reserving the transport addresses/resources towards the MTSI client and
IMS core network.
NOTE 2: The use of FECC itself is internal to the H.224 frame and is
identified by the client ID field of the H.224 packet. The IMS-ALG only
indicates the use of IP/UDP/RTP. The use of FECC is signalled via H.224 by a
MTSI client.
The IMS-AGW shall then:
\- assign resources for the requested media stream, i.e., resources for a
media-format agnostic RTP flow; and
\- forward transparently RTP/UDP packets (with the transparent (H.224)-PDU)
between the incoming and outgoing network.
### 5.22.3 \"Predefined ROI\" mode
The IMS-ALG and IMS-AGW may support the \"Predefined ROI\" mode as specified
in 3GPP TS 26.114 [21]. If the IMS-ALG and IMS-AGW support the \"Predefined
ROI\", the IMS-ALG and IMS-AGW shall apply the procedures in the present
clause.
If the IMS-ALG receives an SDP body containing an \"a=rtcp-fb\" line with the
\"Predefined ROI\" type expressed by the parameter \"3gpp-roi-predefined\", as
described in 3GPP TS 26.114 [21], the IMS-ALG shall:
\- forward within SIP signalling the SDP body received from the preceding node
with unmodified SDP \"a=rtcp-fb\" lines related to the \"3gpp-roi-predefined\"
parameter to the succeeding node (see the related SDP examples in annex A.4.2e
of 3GPP TS 26.114 [21]); and
\- include the \"Predefined ROI\" information element when seizing resources
in the IMS-AGW to request the IMS-AGW to assign the resources for the
corresponding RTCP control flow to convey pre-defined ROI information.
The IMS-AGW shall then assign resources for the requested RTCP control flow
and forward transparently the RTCP \"FB ROI\" packets between the incoming and
outgoing network. The procedures described in clause 5.9 shall also apply.
NOTE 1: The RTCP control flow contains multiple RTCP packet types.
If the IMS-ALG receives an SDP body containing the predefined ROI attribute(s)
\"a=predefined_ROI\" defined in 3GPP TS 26.114 [21], the IMS-ALG shall forward
the SDP body with unmodified predefined ROI attribute(s) for the send and
receive directions when seizing or modifying resources in the IMS-AGW.
If the IMS-ALG receives an SDP body containing \"a=extmap\" attribute(s), as
defined in IETF RFC 5285 [23], and the \"a=extmap\" attribute(s) contain the
pre-defined ROI URN(s) (i.e. the ROI URN for carriage of pre-defined region of
interest information in the sent video stream is given by
\"urn:3gpp:predefined-roi-sent\") as defined in 3GPP TS 26.114 [21], then the
IMS-ALG shall:
\- include the \"Extended RTP header for Sent ROI\" information element when
seizing resources in the IMS-AGW to indicate to the IMS-AGW that it shall
allow the RTP header extension for predefined ROI to pass; and
\- forward within SIP signalling, the SDP body received from the preceding
node with unmodified \"a=extmap\" attribute(s) to the succeeding node (see the
related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]).
NOTE 2: The UE supporting the Predefined ROI feature will not send the
extended RTP headers for Sent ROI if the UE did not receive any SDP body with
the Predefined ROI related \"a=extmap\" attribute.
If the IMS-AGW has been instructed to pass on the extended RTP header for
predefined ROI as described above for both incoming and outgoing terminations
then:
\- if the IMS AGW does not apply video transcoding, it shall pass any received
RTP header extension for Predefined ROI to succeeding RTP streams; or
\- if the IMS-AGW applies video transcoding, it shall keep the predefined ROI
information unchanged during the transcoding and copy the received RTP header
extension for Predefined ROI to the succeeding outgoing RTP stream(s) after
transcoding the associated group of packets.
### 5.22.4 \"Arbitrary ROI\" mode
The IMS-ALG and IMS-AGW may support the \"Arbitrary ROI\" mode as specified in
3GPP TS 26.114 [21]. If the IMS-ALG and IMS-AGW support the \"Arbitray ROI\",
the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.
If the IMS-ALG receives an SDP body containing an \"a=rtcp-fb\" line with the
\"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-arbitrary\", as
described in 3GPP TS 26.114 [21], the IMS-ALG shall:
\- forward within SIP signalling the SDP body received from the preceding node
with unmodified SDP \"a=rtcp-fb\" lines related to the \"3gpp-roi-arbitrary\"
parameter to the succeeding node (see the related SDP examples in annex A.4.2e
of 3GPP TS 26.114 [21]); and
\- include the \"Arbitrary ROI\" information element when seizing resources in
the IMS-AGW to request the IMS-AGW to assign the resources for the
corresponding RTCP control flow to convey arbitrary ROI information.
The IMS-AGW shall then assign resources for the requested RTCP control flow
and forward transparently the RTCP \"FB ROI\" packets between the incoming and
outgoing network. The procedures described in clause 5.9 shall also apply.
NOTE 1: The RTCP control flow contains multiple RTCP packet types.
If the IMS-ALG receives an SDP body containing \"a=extmap\" attribute(s), as
defined in IETF RFC 5285 [23], and the \"a=extmap\" attribute(s) contain the
arbitrary ROI URN(s) (i.e. the ROI URN for carriage of arbitrary region of
interest information in the sent video stream is given by \"urn:3gpp:roi-
sent\") as defined in 3GPP TS 26.114 [21], then the IMS-ALG shall:
\- include the \"Extended RTP header for Sent ROI\" information element when
seizing resources in the IMS-AGW to indicate to the IMS-AGW that it shall
allow the RTP header extension for arbitrary ROI to pass; and
\- forward within SIP signalling, the SDP body received from the preceding
node with unmodified \"a=extmap\" attribute(s) to the succeeding node (see the
related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]).
NOTE 2: The UE supporting the Arbitrary ROI feature will not send the extended
RTP headers for Sent ROI if the UE did not receive any SDP body with the
Arbitrary ROI related \"a=extmap\" attribute.
If the IMS-AGW has been instructed to pass on the extended RTP header for
arbitrary ROI as described above for both incoming and outgoing terminations
then:
\- if the IMS AGW does not apply video transcoding, it shall pass any received
RTP header extension for Arbitrary ROI to succeeding RTP streams; or
\- if the IMS-AGW applies video transcoding, it shall keep the arbitrary ROI
information unchanged during the transcoding and copy the received RTP header
extension for Arbitrary ROI to the succeeding outgoing RTP stream(s) after
transcoding the associated group of packets.
## 5.23 SDP Capability Negotiation (SDPCapNeg)
The SDP Capability Negotiation (SDPCapNeg) as specified in IETF RFC 5939 [66]
is adopted as an optional functionality to negotiate capabilities and their
associated configurations according to 3GPP TS 24.229 [11]. If the ICS service
is supported then the IMS-ALG and the IMS-AGW may further optionally support
SDP Media Capability Negotiation as specified in IETF RFC 6871 [67] for
alternative CS configuration.
Upon receipt of an incoming SDP offer containing the attributes of SDP
capability negotiation, e.g. offer AVPF and AVP together for the RTP profile
negotiation using \"a=tcap\", \"a=pcfg\" and \"a=acfg\" attributes, the IMS-
ALG shall:
\- request the IMS-AGW to reserve resources only for the default configuration
without SDPCapNeg, and make the decision on support of the alternative
configurations based on the IMS-ALG/IMS-AGW capability as provisioned before
forwarding the SDP offer, i.e. handling SDPCapNeg at the controller level; or
\- request the IMS-AGW to reserve resources for all of these configurations by
signalling SDPCapNeg to the IMS-AGW, and update the SDP offer based on the
response from the IMS-AGW before forwarding.
NOTE: The additional benefit of signalling SDPCapNeg between the IMS-ALG and
the IMS-AGW is to check the resource availability for the corresponding
configurations and to avoid the further session failure in case of inadequate
resources for the configuration changes in the final confirmation. However,
due to the extra resources reserved only during the call establishment phase,
there is increased risk of call establishment failure.
In case the IMS-ALG decides to request the IMS-AGW to reserve resources for
all of those configurations, the IMS-ALG shall:
\- use legacy SDP attributes as specified in IETF RFC 4566 [53] to do the
mapping of actual and potential configurations with the H.248 ReserveGroup
concept; or
\- use SDP extensions for SDP capability negotiation as specified in IETF RFC
5939 [66], if supported by the IMS-AGW.
Before using SDP extensions for SDP capability negotiation as specified in
IETF RFC 5939 [66] towards the IMS-AGW, the IMS-ALG shall perform the
necessary checks (i.e. through auditing or via prior provisioning) to ensure
that the IMS-AGW supports the syntax and capabilities requested. For an
auditing the procedure in clause 6.1.8.1 is used with the \"SDPCapNeg
Supported Capabilities\" as the object.
When receiving a request from the IMS-ALG with information element \"SDPCapNeg
configuration\" indicating the potential use of multiple configurations, the
IMS-AGW shall reserve resources for all of those configurations that it
supports and shall send indicate the configurations for which it reserved
resources in an \"SDPCapNeg configuration\" information element in the
response. The IMS-ALG shall update the SDP offer with SDPCapNeg configurations
in the response from the IMS-AGW and shall forward the SDP offer to the next
hop.
The IMS-ALG may also provide SDP configurations to the IMS-AGW with no
dependency on the incoming SDP offer, e.g. the IMS-ALG may wildcard the
supported configurations in order to construct or update an SDP offer with the
addition of alternative configurations via SDPCapNeg attributes.
On receipt of an SDP answer with SDPCapNeg, the IMS-ALG shall request the IMS-
AGW to configure the resources for the selected configuration. If the IMS-AGW
previously reserved any temporary resources for configurations that were not
selected, the IMS-ALG shall also request the IMS-AGW to release those
resources.
## 5.24 RTP-level pause and resume
The IMS-ALG and the IMS-AGW may support the \"RTP-level pause and resume\"
signalling as defined in 3GPP TS 26.114 [21] and IETF RFC 7728 [79].
RTCP feedback messages to request for pause and resume of media streams can be
used by conference participants supporting Multi-stream Multiparty
Conferencing Media Handling feature, as specified in 3GPP TS 26.114 [21] annex
S. Usage of the RTCP feedback \"pause and resume\" messages is negotiated via
SDP offer/answer exchange through an extension of RTCP feedback capability
attribute \"a=rtcp-fb\" (defined in IETF RFC 4585 [77]).
If the IMS-ALG and IMS-AGW support the \"RTP-level pause and resume\"
signalling, the IMS-ALG and IMS-AGW shall apply the procedures in the present
clause.
If the IMS-ALG receives an SDP offer containing \"a=rtcp-fb\" line(s) with a
\"CCM\" parameter (as defined in IETF RFC 5104 [78]) and a \"pause\" CCM
parameter (as defined in IETF RFC 7728 [79]), and if the IMS-ALG does not
support or does not apply the transcoding procedure defined in clause 5.13,
the IMS-ALG shall forward within SIP signalling, the SDP offer received from
the preceding node with unmodified \"a=rtcp-fb\" line(s) with a \"pause\" CCM
parameter. Otherwise, if the IMS-ALG does insert any transcoding or if the
IMS-AGW does not support the \"RTP-level pause and resume\" signalling, the
IMS-ALG shall forward within SIP signalling, the SDP offer received from the
preceding node without any \"a=rtcp-fb\" line(s) with a \"pause\" CCM
parameter.
If the IMS-ALG forwarded the SDP offer containing the \"a=rtcp-fb\" line(s)
with a \"pause\" CCM parameter and receives an SDP answer also containing the
\"a=rtcp-fb\" line(s) with a \"pause\" CCM parameter (the reception of the
attribute indicates a successful \"RTP-level pause and resume\" negotiation)
then the IMS-ALG shall:
a) when requesting the IMS-AGW to configure resources towards the succeeding
node and towards the preceding node, include the \"CCM pause-resume\"
information element to indicate that the IMS-AGW shall forward RTCP feedback
\"CCM PAUSE-RESUME\" messages transparently; and
b) forward the SDP answer containing the \"a=rtcp-fb\" line(s) with a
\"pause\" CCM parameter to its preceding node.
The IMS-AGW shall then assign resources for the requested RTCP control flow
and shall transparently forward the RTCP \"CCM PAUSE\" packets between
incoming and outgoing networks.
## 5.25 RTCP Codec Control Commands and Indications
The IMS-ALG and the IMS-AGW may support signalling of \"RTCP Codec Control
Commands and Indications\", as defined in 3GPP TS 26.114 [21] and IETF RFC
5104 [78].
NOTE 1: 3GPP TS 26.114 [21] specifies support of the following RTCP feedback
codec control messages (CCM): \"Full Intra Request (FIR)\", \"Temporary
Maximum Media Stream Bit Rate Request (TMMBR)\" and \"Temporary Maximum Media
Stream Bit Rate Notification (TMMBN)\".
The RTCP feedback FIR message can be used both by point-to-point video calls,
and by conference participants supporting Multi-stream Multiparty Conferencing
Media Handling feature, as specified in 3GPP TS 26.114 [21] annex S, to
request the media sender to send a decoder refresh point.
The RTCP TMMBR and TMMBN feedback messages can also be used in reaction to the
Explicit Congestion Notification, as specified in clause 5.12.
Usage of the RTCP feedback \"CCM\" messages is negotiated via SDP offer/answer
exchange through an extension (defined in IETF RFC 5104 [78]) of the RTCP
feedback capability attribute \"a=rtcp-fb\" (defined in IETF RFC 4585 [77]).
NOTE 2: The SDP offer/answer negotiation is performed with a separate
\"a=rtcp-fb\" attribute line for each CCM message type.
If the IMS-ALG and IMS-AGW support the \"RTCP Codec Control Commands and
Indications\" signalling, the IMS-ALG and IMS-AGW shall apply the procedures
in the present clause.
If the IMS-ALG receives an SDP offer containing \"a=rtcp-fb\" line(s) with a
\"CCM\" parameter and with a \"fir\" and/or \"tmmbr\" CCM parameters (defined
in IETF RFC 5104 [78]) under video \"m=\" line(s), and if the IMS-ALG does not
configure the IMS-AGW to transcode the corresponding video media stream and/or
to act as ECN endpoint for the corresponding video media stream, the IMS-ALG
shall forward within SIP signalling, the SDP offer received from the preceding
node with unmodified \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and with
\"fir\" and/or \"tmmbr\" CCM parameters.
NOTE 3: If the IMS-ALG configures the IMS-AGW to transcode a video media
stream and/or to act as ECN endpoint for the corresponding video media stream,
the IMS-ALG can insert \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and
with \"fir\" and/or \"tmmbr\" CCM parameters within SDP offer irrespective of
whether they were received from the preceding node.
If the IMS-ALG does not configure the IMS-AGW to transcode the corresponding
video media stream and/or to act as ECN endpoint, and if the IMS-ALG received
an SDP answer also containing the \"a=rtcp-fb\" line(s) with the \"CCM\"
parameter and with the same \"fir\" and/or \"tmmbr\" CCM parameters (the
presence of the same \"a=rtcp-fb ccm\" line(s) in the SDP answer indicates a
successful negotiation of the particular CCM message), then the IMS-ALG shall:
\- when requesting the IMS-AGW to configure resources towards the succeeding
node and towards the preceding node, include the \"CCM BASE\" information
element with the \"fir\" and/or \"tmmbr\" CCM parameters to indicate that the
IMS-AGW shall be prepared to receive and is allowed to send the RTCP CCM
\"FIR\" and/or \"TMMBR/TMMBN\" feedback messages; and
\- forward the SDP answer containing the \"a=rtcp-fb\" line(s) with the
\"fir\" and/or \"tmmbr\" CCM parameters (from the received SDP answer) to its
preceding node.
If the IMS-ALG configures the IMS-AGW to transcode the corresponding video
media stream and/or to act as ECN endpoint:
\- if the IMS-ALG did not send towards the succeeding node the SDP offer
containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and the with
\"fir\" and/or \"tmmbr\" CCM parameters, then the IMS-ALG may:
a) when requesting the IMS-AGW to configure resources towards the preceding
node, include the \"CCM BASE\" information element with the \"fir\" and/or
\"tmmbr\" CCM parameters to indicate that the IMS-AGW shall be prepared to
receive and is allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\"
feedback messages; and
b) include in the SDP answer it sends to the preceding node the \"a=rtcp-fb\"
line(s) with the \"fir\" and/or \"tmmbr\" CCM parameters (as received SDP
offer); and
\- if the IMS-ALG sent towards the succeeding node the SDP offer containing
the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and the with \"fir\"
and/or \"tmmbr\" CCM parameters, and received an SDP answer also containing
the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and with the same \"fir\"
and/or \"tmmbr\" CCM parameters, then the IMS-ALG shall:
a) when requesting the IMS-AGW to configure resources towards the succeeding
node, include the \"CCM BASE\" information element with the \"fir\" and/or
\"tmmbr\" CCM parameters to indicate that the IMS-AGW shall be prepared to
receive and is allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\"
feedback messages; and
b) if the the IMS-ALG received from the preceding node the SDP offer
containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and the with
\"fir\" and/or \"tmmbr\" CCM parameters, include in the SDP answer it sends to
the preceding node the \"a=rtcp-fb\" line(s) with the \"fir\" and/or \"tmmbr\"
CCM parameters (as received SDP offer).
The IMS-AGW shall then assign resources for the requested RTCP control flow:
\- if the IMS-AGW acts as an ECN endpoint (as described in clause 5.12) or
applies the video transcoding procedure, the IMS-AGW:
a) may send the RTCP TMMBR feedback message with an \"IMS-AGW-generated\"
value in an \"SSRC of media sender\" field that is kept constant for the
duration of the session, different from any SSRC value in the active RTP
streams for the session, to request the media sender to limit the maximum bit
rate for a media stream to, or below, the provided value;
NOTE 4: Trigger for sending of the RTCP TMMBR feedback message can be
reception of RTP packets marked with ECN-CE, as described in clause 5.12. The
reason to use an \"IMS-AGW-generated\" value in \"SSRC of media sender\" and
to keep that value constant in the session is that the IMS-AGW must be
possible to identify as being a separate source of sending TMMBR messages, to
avoid TMMBR induced by ECN restrictions interfering with other TMMBR
restrictions set by other media receivers in the media path, as described in
clause 3.5.4 of IETF RFC 5104 [78].
b) upon reception of the RTCP TMMBR feedback message and if performing
transcoding, shall adjust the sent media rate to the requested rate or lower
and shall respond by sending the RTCP TMMBN feedback message; and
c) may send the RTCP FIR feedback message to request the media sender to send
a decoder refresh point; or
\- if the IMS-AGW does not act as an ECN endpoint and does not apply the video
transcoding procedure, the IMS-AGW shall transparently forward received RTCP
FIR feedback message, and received RTCP TMMBR and TMMBN feedback messages
between the incoming and outgoing networks.
## 5.26 Delay Budget Information (DBI)
The IMS-ALG and the IMS-AGW may support the \"DBI\" signalling as defined in
3GPP TS 26.114 [21].
RTCP feedback messages to report or request additional delay budget for voice
and video media streams (as defined in 3GPP TS 26.114 [21] clause 7.3.8) can
be used by participants in a point-to-point MTSI session, and by conference
participants, as specified in 3GPP TS 26.114 [21].
If the IMS-ALG and IMS-AGW support the \"DBI\" signalling, the IMS-ALG and
IMS-AGW shall apply the procedures in the present clause.
If the IMS-ALG receives an SDP offer containing an \"a=rtcp-fb\" line(s) with
a \"3GPP-delay-budget\" parameter as defined in 3GPP TS 26.114 [21], the IMS-
ALG shall forward within SIP signalling, the SDP offer received from the
preceding node with the unmodified \"a=rtcp-fb\" line(s) with \"3GPP-delay-
budget\" parameter. Otherwise, if the IMS-AGW does not support the \"DBI\"
signalling, the IMS-ALG shall forward within SIP signalling, the SDP offer
received from the preceding node without any \"a=rtcp-fb\" line(s) with a
\"3GPP-delay-budget\" parameter.
If the IMS-ALG forwarded the SDP offer containing the \"a=rtcp-fb\" line(s)
with a \"3GPP-delay-budget\" parameter and receives an SDP answer also
containing the \"a=rtcp-fb\" line(s) with a \"3GPP-delay-budget\" parameter
(the reception of the attribute indicates a successful \"3GPP-delay-budget\"
negotiation) then the IMS-ALG shall:
a) when requesting the IMS-AGW to configure resources towards the succeeding
node and towards the preceding node, include the \"DBI\" information element
to indicate that the IMS-AGW shall forward RTCP DBI feedback messages
transparently; and
b) forward the SDP answer containing the \"a=rtcp-fb\" line(s) with a \"3GPP-
delay-budget\" parameter to its preceding node.
The IMS-AGW shall then assign resources for the requested RTCP control flow
and shall transparently forward the RTCP DBI feedback messages between
incoming and outgoing networks.
# 6 IMS-ALG to IMS-AGW Procedures
## 6.1 Non-Call Related Procedures
### 6.1.1 General
The non-call related procedures are based on corresponding procedures of 3GPP
TS 23.205 [8] where the IMS-ALG takes the place of the MSC server and the IMS-
AGW takes the place of the MGW.
### 6.1.2 IMS-AGW Unavailable
The IMS-ALG server recognises that the IMS-AGW is unavailable in the following
4 cases:
1\. The signalling connection is unavailable
Figure 6.1.2.1: Signalling connection failure
2\. The IMS-AGW indicates the failure or the maintenance locking condition to
all connected IMS-ALG servers
Figure 6.1.2.2: IMS-AGW indicates the Failure/Maintenance locking
The failure or maintenance locking indication indicates that the IMS-AGW is
locked for new calls or will soon go out of service and that no new
connections should be established using this IMS-AGW. The IMS-AGW can choose
between the \"graceful\" and the \"forced\" method. In the graceful method the
connections are cleared when the corresponding calls are disconnected. In the
forced method all connection are cleared immediately.
3\. The IMS-ALG recognises that the IMS-AGW is not functioning correctly, e.g.
because there is no reply on periodic sending of Audits. The periodic sending
of Audits by IMS-ALG should go on.
In all of the above cases the IMS-ALG shall prevent the usage of the IMS-AGW
until the IMS-AGW has recovered or the communication with the IMS-AGW is
restored.
### 6.1.3 IMS-AGW Available
The IMS-ALG discovers that the IMS-AGW is available when it receives an IMS-
AGW Communication Up message or an IMS-AGW Restoration message. If the IMS-ALG
does not wish to sustain an association with the IMS-AGW, the response sent to
the IMS-AGW may indicate an alternative IMS-ALG signalling address, in which
case the IMS-AGW shall not consider itself registered and should preferably
attempt to re-register with this alternative IMS-ALG before any further
alternate IMS-ALGs. Otherwise, the response shall not indicate any alternative
IMS-ALG signalling address.
When the IMS-ALG discovers that the IMS-AGW is available the following shall
occur:
1\. Signalling recovery
The IMS-AGW indicates to all connected IMS-ALGs that the signalling connection
is restored.
Figure 6.1.3.1: Communication goes up
2\. IMS-AGW restoration/maintenance unlocking indication.
The IMS-AGW indicates to all connected IMS-ALGs that normal operation has
resumed.
Figure 6.1.3.2: IMS-AGW indicates recovery from a failure/or maintenance
unlocking
NOTE: This procedure may be used after recovery from a signalling failure.
3\. The IMS-ALG recognises that the IMS-AGW is now functioning correctly, e.g.
because there is a reply on periodic sending of Audits.
After this the IMS-ALG can use the IMS-AGW.
If none of 1, 2, and 3 happens the IMS-ALG server can initiate the IMS-ALG
Ordered Re-register procedure.
### 6.1.4 IMS-AGW Recovery
If the IMS-AGW recovers from a failure, is maintenance unlocked, or it has
been restarted, it registers to its known IMS-ALGs using the IMS-AGW
Restoration procedure or the IMS-AGW Registration procedure. The IMS-AGW can
indicate whether the Service has been restored or whether it has restarted
with a cold or warm boot. If the IMS-ALG does not wish to sustain an
association with the IMS-AGW, the response sent to the IMS-AGW may indicate an
alternative IMS-ALG signalling address, in which case the IMS-AGW shall not
consider itself registered and should preferably attempt to re-register with
this alternative IMS-ALG before any further alternate IMS-ALGs. Otherwise, the
response shall not indicate any alternative IMS-ALG signalling address.
Figure 6.1.4.1: IMS-AGW Restoration
Figure 6.1.4.2 IMS-AGW Registration
After the recovery the IMS-ALG can use the IMS-AGW.
### 6.1.5 IMS-ALG Recovery
#### 6.1.5.1 General
If an IMS-AGW-unavailable condition is provoked by a failure/recovery action,
the IMS-ALG recovery sequence will, from an information flow point of view,
look like IMS-AGW unavailable and then IMS-AGW available. If an IMS-AGW-
unavailable condition is not provoked, the IMS-ALG recovery sequence will look
like IMS-AGW available.
After the information flow, the terminations affected by the recovery action
are released.
#### 6.1.5.2 IMS-ALG Restoration
NOTE: Normal release procedure may also be initiated.
Figure 6.1.5.2.1: IMS-ALG Restoration
After the recovery action is complete and it is possible to signal to the IMS-
AGW the IMS-ALG starts a timer Tw. If recovery indications are not received
(IMS-AGW Communication Up or IMS-AGW Restoration) from the IMS-AGW during Tw
an Audit is sent. If the IMS-ALG receives a recovery indication or IMS-AGW
communication up indication, it shall acknowledge the indication before the
IMS-ALG Restoration may be sent or the release procedure is initiated.
### 6.1.6 IMS-AGW Re-register
When the IMS-ALG requests an IMS-AGW to perform a registration (see clauses
6.1.3, 6.1.4 and 6.1.7), the IMS-AGW performs a re-registration to the IMS-ALG
which is defined in the IMS-ALG address.
Figure 6.1.6.1: Re-registration of an IMS-AGW
### 6.1.7 IMS-AGW Re-registration Ordered by IMS-ALG
If the IMS-ALG knows that communication is possible, but the IMS-AGW has not
registered, the IMS-ALG can order re-registration of the IMS-AGW.
Figure 6.1.7.1: Re-registration ordered by the IMS-ALG
If the re-registration request is accepted the IMS-AGW uses the IMS-AGW Re-
register procedure to register with the IMS-ALG.
### 6.1.8 Audit of IMS-AGW
#### 6.1.8.1 Audit of Value
The IMS-ALG may request the IMS-AGW to report the current values assigned to
distinct objects in the IMS-AGW. This procedure may be used when a change has
occurred in the IMS-ALG such that the IMS-ALG is unsure of the current Service
State of Terminations.
Figure 6.1.8.1.1: Audit Value
#### 6.1.8.2 Audit of Capability
The IMS-ALG may request the IMS-AGW to report the capabilities of distinct
objects in the MGW.
Figure 6.1.8.2.1: Audit Capability
### 6.1.9 IMS-AGW Capability Change
The IMS-AGW reports a change of capability of distinct objects in the MGW.
Figure 6.1.9.1: Capability Update
The IMS-ALG may use the Audit Value and/or Audit Capability procedures to
obtain further information, about the objects whose capabilities have changed.
### 6.1.10 IMS-ALG Out of service
Figure 6.1.10.1: IMS-ALG Out of Service
If an IMS-ALG discovers that it wants to go out of service it may start an
IMS-ALG Out of Service procedure. The IMS-ALG can indicate whether it requires
the context to be cleared immediately (forced) or cleared as the bearer
control protocol clears the bearer (Graceful).
### 6.1.11 IMS-AGW Resource Congestion Handling - Activate
When the IMS-ALG requires that an IMS-AGW congestion notification mechanism be
applied in the MGW, the IMS-ALG shall use the IMS-AGW Resource Congestion
Handling - Activate procedure towards the IMS-AGW.
Figure 6.1.11.1: IMS-AGW Resource Congestion Handling - Activate
### 6.1.12 MGW Resource Congestion Handling -Indication
When the IMS-ALG receives a load reduction notification from the IMS-AGW via
the IMS-AGW Resource Congestion Handling - Indication procedure, the IMS-ALG
tries to reduce the processing load that the IMS-ALG creates on the IMS-AGW.
The IMS-AGW shall decide the actual level of traffic reduction.
Figure 6.1.12.1: IMS-AGW Resource Congestion Handling -- Indication
### 6.1.13 Control association monitoring
Monitoring of the H.248 control association may be performed by monitoring the
status of the transport link association where the transport protocol provides
sufficient coupling to the H.248.1 protocol, i.e. if the transport link
association is disconnected when no local H.248.1 protocol connection exists.
An alternative method for the IMS-AGW to detect loss of the IMS-ALG may be
achieved by requesting the IMS-AGW to poll the IMS-ALG periodically
Upon registration of an IMS-AGW, the IMS-ALG may use the Inactivity Timeout -
Activate procedure towards the IMS-AGW to request the IMS-AGW to monitor
incoming messages for periods of silence exceeding the maximum inactivity
timer value.
Figure 6.1.13.1: Inactivity Timeout - Activate
Upon receipt of an inactivity timeout notification from the IMS-AGW via the
Inactivity Timeout - Indication procedure, the IMS-ALG shall send a reply to
the IMS-AGW. If the IMS-ALG has failed, the IMS-AGW will not receive a reply.
Figure 6.1.13.2: Inactivity Timeout - Indication
If no Inactivity Timeout -- Indication Ack reply is received, the IMS-AGW
shall consider the IMS-ALG to have failed. The IMS-AGW may then attempt to re-
contact its controlling IMS-ALG by performing IMS-AGW Communication Up. If not
successful, the IMS-AGW may then attempt to register to a new IMS-ALG.
### 6.1.14 Realm Availability Monitoring
If the IMS-AGW supports IP Realm Availability monitoring, the IMS-ALG may
request the monitoring of the available IP Realms by the IMS-AGW; the IMS-AGW
shall inform the IMS-ALG of any changes in realm availability.
NOTE: The IMS-ALG can use the AuditValue procedure to determine which IP
realms are currently available.
The IMS-ALG may use the Realm Availability - Activate procedure towards the
IMS-AGW to request the IMS-AGW to monitor the status of its IP Realms.
Figure 6.1.14.1: Realm Availability - Activate
The IMS-AGW shall inform the IMS-ALG via the Realm Availability --
Notification procedure.
Figure 6.1.14.2: Realm Availability - Indication
On being informed of newly available/unavailable realms, IMS-ALG shall take
appropriate action (e.g. update its list of available realms etc.).
### 6.1.15 Failure of IP Port, Interface or Group of Interfaces
This procedure only applies when text encoding is used on the H.248 interface.
The IMS-ALG shall and the IMS-AGW may support the Termination Out-of-Service
procedure.
If the IMS AGW suffers a loss of physical IP device(s) that pertain to a whole
IP Realm it may report the IP Realm as unavailable (see clause 6.1.14).
However, it is possible that a failure affects a physical port or group of
ports that forms a subset of the IP Realm and therefore many terminations are
affected. In such cases the IMS-AGW may initiate a Termination Out of Service
procedure to inform the IMS-ALG that the set of terminations is out of
service. This is shown in Figure 6.1.15.1.
Figure 6.1.15.1: Termination Out of Service
On receipt of the Termination Out Of Service the IMS-ALG shall initiate the
appropriate actions, e.g. by subtracting the affected terminations and
releasing the affected calls.
NOTE: This procedure provides an alternative failure reporting to the IP
Bearer Released procedure (which allows reporting the failure of one IP Bearer
/ termination). The Termination Out-of-Service procedure avoids sending an
avalanche of notifications when the failure affects multiple ephemeral
terminations.
## 6.2 Call Related Procedures
### 6.2.1 Gate Control & Local NA(P)T procedure
The session establishment and session release procedures are specified in 3GPP
TS 23.228 [2] Annex G.4.3 and G.4.4.
Figure 6.2.1.2 depicts the signalling flow for a session setup from the IMS
access network towards the IMS core network when the Pâ€‘CSCF invokes the IMS-
ALG function for a session. The same signalling flow applies for a session
setup from the IMS core network towards the IMS access network with the
exception that terminations T1 and T2 are then exchanged.
Figure 6.2.1.1: H.248 Context Model
Figure 6.2.1.2: IMS-ALG and IMS-AGW interaction at session establishment
Upon receipt of a session initiation request, the IMS-ALG shall extract the
offerer\'s destination network address(es) and port number(s) from the
signalling message body received from the calling party endpoint. It shall
then request the IMS-AGW to allocate transport resources (T2) via the Reserve
AGW Connection Point procedure. Upon receipt of the response from the IMS-AGW,
the IMS-ALG shall modify the offerer\'s destination address(es) and/or port(s)
contained in the application signalling message body and propagate the session
establishment toward the terminating party.
On receipt of the terminating end SDP in the session establishment response,
the IMS-ALG shall pass the information to the IMS-AGW in the Configure AGW
Connection Point procedure and shall request the IMS-AGW to allocate transport
resources (T1) via the Reserve and Configure AGW Connection Point. Upon
receiving the response from the IMS-AGW, the IMS-ALG shall modify the
answerer\'s destination address(es) and/or port(s) contained in the
application signalling message body and pass the information to the
originating party.
On session termination, the IMS-ALG shall request the IMS-AGW to release its
transport resources via the Release AGW Termination procedure.
### 6.2.2 IP realm indication procedure
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally specifying the required IP Realm to the IMS-AGW when requesting the
allocation of transport resources on the IMS-AGW.
### 6.2.3 Remote NA(P)T traversal support procedure
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally indicating to the IMS-AGW that the remote media address/port
information (supplied by the IMS-ALG) shall not be used as the destination
address for outgoing media. Instead, the IMS-AGW shall \"latch\" or
\"relatch\" onto the required destination address via the source address/port
of the incoming media. The IMS-ALG may command the IMS-AGW to latch once (on
the first received packet) or to re-latch (i.e. to check for a change of
source address on the incoming media stream and latch once on this new
address).
### 6.2.4 Remote Source Address/Port Filtering
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally specifying the required IP address and/or port to be used to screen
received media packets on a termination.
This clause considers when the IMS-ALG is acting as an Entry point and remote
source transport address filtering is required towards the external network.
As a security related option, on request from the IMS-ALG, filtering may be
enabled to check/validate the source address or source address and port number
of incoming packets from the external network. If the IMS-ALG requests address
filtering, it may additionally provide an address specification, which may
identify either a single address or a range of addresses, against which
filtering is to be performed. The absence of such an address specification in
the request shall implicitly request filtering against the IP address of the
remote connection address. In addition to address filtering, the IMS-ALG may
also request port filtering. If the IMS-ALG requests port filtering, it may
additionally include either a port or a range of ports, against which
filtering is to be performed. The absence of a port specification in the
request shall implicitly request filtering against the port of the remote
connection address.
If the IMS-AGW is requested to apply source IP address and possibly source
port filtering, it shall only pass incoming IP packets from the identified
source, and discard IP packets from other sources.
If remote source address filtering is required for the created termination,
then the IMS-ALG shall include the information element \"Remote source address
filtering\" in the request sent to the IMS-AGW. In addition, it may also
include the information element \"Remote source address mask\" in order to
request filtering of a range of addresses.
If remote source port filtering is required for the created termination (in
addition to remote source address filtering), then the IMS-ALG shall include
the information element \"Remote source port filtering\" in the request sent
to the IMS-AGW. It may also include one of the information elements \"Remote
source port\" or \"Remote source port range\".
Subsequently, the IMS-AGW shall apply filtering as requested to the packets
arriving from the external network. Any packet arriving, which does not meet
the filtering requirement, shall be discarded.
### 6.2.5 Traffic Policing
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to police the media stream flow according to
one or more of the following media policing(s) through the IMS-AGW, in
accordance with IETF RFC 2216 [10].
NOTE 1: In order to support services that generate media with variable bitrate
(e.g. video), the policing function needs to provide sufficient buffer space.
The derivation of the correspondent token bucket size can be based on the
estimated traffic volume over the expected maximum burst length (supposed time
interval of the burst). For example, for MTSI media, 3GPP TS 26.114 [21]
clause 7.5.5 recommends a default period of 2 seconds for the derivation of
average bitrates and provides further considerations regarding suitable time
periods for speech and video.
NOTE 2: The decision to apply or not traffic policing is general for all
sessions with the same media characteristics (i.e. not user specific). The
conditions which media policing to apply are beyond the scope of this
specification. This can be based on the media characteristics of the session
(e.g. media type).
The following media policing shall be supported at the IMS-AGW:
\- **Sustainable Data Rate (SDR) Policing:** \ To request policing of the
sustainable data rate of a media stream, the IMS-ALG shall request media
policing for that media stream and shall provide the sustainable data rate,
and shall provide a maximum burst size (MBS) indicating the expected maximum
size of packet bursts for that media stream. The IMS-AGW shall then measure
the data rate for the received packets within that media stream as per IETF
RFC 2216 [10] for \"Token Bucket\", where r = SDR and b = MBS. If the
permissible sustainable data rate is exceeded, the IMS-AGW shall discard
packets to reduce the data rate to the permissible sustainable data rate.
NOTE 3: The IMS-ALG can derive the sustainable data rate from bandwidth
parameters if it receives them within an SDP media description. The IMS-ALG
can:\ \- use the \"b=AS\" bandwidth modifier if received within an SDP body;
or\ \- if the IMS-ALG supports the enhanced bandwidth negotiation mechanism,
use the \"maximum supported bandwidth for the receiving direction\" property
value from the \"a=bw-info\" SDP attribute received within an SDP answer.\ If
the value of the \"maximum supported bandwidth for the receiving direction\"
for the selected RTP payload type differs from the value of the \"b=AS\"
bandwidth modifier then the IMS-ALG can use \"maximum supported bandwidth for
the receiving direction\" property value from the \"a=bw-info\" SDP attribute
to determine the sustainable data rate for the selected RTP payload.
The following media policing may be supported in addition at the IMS-AGW ; if
supported then the following applies:
\- **Peak Data Rate Policing** :\ To request policing of the peak data rate of
a media stream, the IMS-ALG shall request media policing for that media stream
and shall provide the peak data rate, and may provide a Delay Variation
Tolerance indicating the expected maximum delay variation due to jitter for
that media stream. The IMS-AGW shall then measure the data rate for the
received packets within that media stream. If the permissible peak data rate
is exceeded, the IMS-AGW shall discard packets to reduce the data rate to the
permissible peak data rate. If both peak data rate and sustainable data rate
have been provided for the same media stream, the IMS-AGW shall discard
packets to reduce the data rate to the permissible peak data rate and should
discard packets to reduce the data rate to the permissible sustainable data
rate.
### 6.2.6 Hanging Termination Detection
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
requesting the IMS-AGW to periodically report termination heartbeat
indications to detect hanging context and termination in the IMS-AGW that may
result e.g. from a loss of communication between the IMS-ALG and the IMS-AGW.
When the IMS-ALG receives a termination heartbeat notification from the IMS-
AGW via the Termination heartbeat - Indication procedure, the IMS-ALG shall
return a Termination heartbeat --Indication Ack (without an error) if the
context id / termination identity combination exists in the IMS-ALG. If it
does not exist, the IMS-ALG shall return an error and shall correct the
mismatch, e.g. by requesting the IMS-AGW to subtract the indicated termination
and to clear any associated context.
Figure 6.2.6.1: Termination heartbeat -- Indication
### 6.2.7 QoS Packet Marking
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally specifying the setting of the DSCP for outgoing packets on a
termination. The DSCP value may be explicitly set by the IMS-AGW or else
copied from that received in the corresponding received packet.
If differentiated services are required for the created termination, then the
IMS-ALG shall include the information elements \"DiffServ Code Point\" and/or
\"DiffServ Tagging Behaviour\" in the request sent to the IMS-AGW.
Subsequently, for all egress packets, the IMS-AGW shall set the DiffServ Code
Point in the IP header as specified by the IMS-ALG:
\- If the DiffServ Tagging Behaviour information element was received with a
value to indicate that the DiffServ Code Point should be copied, then the
DiffServ Code Point in the IP header of the egress packet is copied from the
ingress packet.
\- If the Diffserv Tagging Behaviour information element was not received, or
was received with a value to indicate that the DiffServ Code Point should be
set to a specific value, then:
\- If the DiffServ Code Point information element was received, then the
DiffServ Code Point in the IP header of the egress packet shall be set to the
value received in the DiffServ Code Point information element.
\- If the DiffServ Code Point information element was not received, then the
DiffServ Code Point in the IP header of the egress packet shall be set to a
configured default value.
### 6.2.8 Media Inactivity Detection
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to detect inactive media.
If media inactivity detection is required for the created termination, the
IMS-ALG may include the information elements \"Inactivity detection time\" and
\"Inactivity detection direction\" in the request sent to the IMS-AGW. The
IMS-ALG may request the detection of media inactivity on a termination or a
stream basis.
When the IMS-ALG receives a notification of inactive media from the IMS-AGW
via the Media Inactivity Notification procedure, the IMS-ALG shall return a
Media Inactivity Notification Ack and shall take appropriate action (e.g.
release the termination).
Figure 6.2.8.1: Media Inactivity Notification
### 6.2.9 Handling of RTCP streams
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to allocate or not allocate RTCP resources.
Additionally if RTCP handling is requested, the IMS ALG may include:
\- the explicit RTCP transport address information element;
\- the RTP/RTCP transport multiplexing information element; and
\- the bandwidth allocation for RTCP,
as described in clause 5.9.
### 6.2.10 IMS end-to-access-edge Media Plane Security
#### 6.2.10.1 General
All message sequence charts in this clause are examples.
The H.248 context model is defined in Figure 6.2.1.1.
#### 6.2.10.2 End-to-access-edge security for RTP based media using SDES
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to provide IMS media plane security in
accordance with 3GPP TS 33.328 [12].
The IMS-ALG shall provide the following media plane security related
parameters to the IMS-AGW:
\- the SDES crypto attributes
#### 6.2.10.3 End-to-access-edge security for TCP-based media using TLS
##### 6.2.10.3.1 End-to-access-edge security for session based messaging
(MSRP)
##### 6.2.10.3.1.1 IMS UE originating procedures for e2ae {#ims-ue-
originating-procedures-for-e2ae .H6}
##### 6.2.10.3.1.1.1 Incoming TCP bearer establishment triggers an outgoing
TCP bearer establishment {#incoming-tcp-bearer-establishment-triggers-an-
outgoing-tcp-bearer-establishment .H6}
Figure 6.2.10.3.1.1.1.1 shows an example call flow for the originating session
set-up procedures for one MSRP media stream using e2ae security, where an
incoming TCP bearer establishment triggers an outgoing TCP bearer
establishment.
Figure 6.2.10.3.1.1.1.1: Originating example call flow for e2ae security for
MSRP where an incoming TCP bearer establishment triggers an outgoing TCP
bearer establishment
The IMS UE A performs an IMS originating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure for requesting e2ae security for a media
stream is described step-by-step with an emphasis on the additional aspects
for IMS-ALG and IMS-AGW of media protection using TLS.
1\. IMS UE A sends an SDP offer for a media stream containing cryptographic
information, together with an \"a=3ge2ae:requested\" SDP attribute for the
MSRP-related SDP m-line, to the Pâ€‘CSCF (IMSâ€‘ALG). For e2ae protection of MSRP
the cryptographic information contained in the SDP offer consists of the
fingerprint of the certificate of IMS UE A in accordance to IETF RFC 4975
[25]. For each media stream that uses transport \"TCP/TLS/MSRP\", the Pâ€‘CSCF
(IMSâ€‘ALG) checks for the presence of the \"a=3ge2ae:requested\" SDP attribute.
If that indication is present and the Pâ€‘CSCF (IMSâ€‘ALG) indicated support of
e2ae-security for MSRP during registration, the Pâ€‘CSCF (IMSâ€‘ALG) allocates the
required resources, includes the IMSâ€‘AGW in the media path and proceeds as
specified in this clause.
NOTE 1: An operator can choose to terminate TLS in the IMSâ€‘AGW according to
the following steps for all media streams that are signalled in SIP INVITE
messages with transport TCP/TLS/MSRP and a certificate fingerprint attribute,
even if the UE did not indicate support for e2ae security during registration
and did not indicate usage of e2ae security for the respective media streams
in the INVITE. This can lead to session failures for pre-Rel-12 IMS UEs or
non-IMS UEs due to a mismatch of security parameters sent by the network and
expected by the UE, but on the other hand, it will ensure compatibility with
GSMA RCS 5.1 [35, 36], which specifies that TLS for MSRP is always terminated
in the network.
2.-4. The IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to
request a termination for \"TCP\" media (for application-agnostic
interworking) or \"TCP/MSRP\" media (for application-aware interworking)
towards the core network. To indicate that the IMS-AGW shall operate in TCP
Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute. The IMS-ALG
sets the interlinkage topology on the termination T2 to configure the IMS-AGW
to use the TCP connection establishment request (TCP SYN) received at the
termination T2 as a trigger to send a TCP connection establishment on the
termination T1.
NOTE 2: If \"a=setup:passive\" is received in the SDP answer in step 12, the
IMS-ALG then needs to set the interlinkage topology on the termination T1 (not
depicted).
5.-7. The IMS-ALG uses the \"Reserve And Configure AGW Connection Point\"
procedure to request a termination for \"TCP/TLS\" media (for application-
agnostic interworking) or \"TCP/TLS/MSRP\" media (for application-aware
interworking) towards the access network. In the remote descriptor, it
provides the IP address, port and fingerprint attribute received from the UE
containing the fingerprint of the UEÂ´s certificate in accordance to IETF RFC
4975 [25]. This instructs the IMSâ€‘AGW to verify during the subsequent TLS
handshake with the IMS UE that the fingerprint of the certificate passed by
the IMS UE during this TLS handshake matches the fingerprint passed by the
Pâ€‘CSCF (IMSâ€‘ALG) to the IMSâ€‘AGW. In turn, the IMSâ€‘AGW communicates the
fingerprint of the certificate it is going to use for setting up protection
for this media stream to the Pâ€‘CSCF (IMSâ€‘ALG). To indicate that the IMS-AGW
shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\"
attribute.
NOTE 3: These steps could be combined with steps 16.-18. This saves H.248
signalling interactions but can delay the TCP connection setup.
8\. The Pâ€‘CSCF (IMSâ€‘ALG) changes the transport from \"TCP/TLS/MSRP\" to
\"TCP/MSRP\" in the SDP offer, removes the \"a=3ge2ae:requested\" SDP
attribute and the fingerprint SDP attribute, and inserts the address
information received from the IMS-AGW.
9\. The Pâ€‘CSCF (IMSâ€‘ALG) forwards the SDP offer.
10\. The remote peer chooses to become the active party in the TCP connection
establishment and sends a TCP SYN to establish the TCP connection. If the
P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any
incoming TCP connection establishment requests (TCP SYN), e.g. to enable a
remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not
indicate to the IMS-AGW at step 2 that it shall latch onto the required
destination address via the source address/port of the incoming media, the
IMS-AGW shall drop the TCP SYN received from the remote peer.\ If the TCP SYN
is not answered before a timer expiry, the remote peer will send the TCP SYN a
second time (step 10\'). The IMSâ€‘AGW will answer a repeated TCP SYN if it is
received after step 13 (step 10\').\ The IMS-AGW answers the TCP SYN and the
remote peer completes the TCP connection establishment.
11\. The IMS-AGW uses the TCP SYN received at the termination T2 (at step 10
or step 10\' if the TCP SYN is dropped at step 10) as a trigger to send a TCP
SYN towards the UE to establish a TCP connection (effectively making the IMS-
AGW acting as the TCP client towards the UE).. The UE answers the TCP SYN and
the IMS-AGW completes the TCP connection establishment.
12\. The Pâ€‘CSCF (IMSâ€‘ALG) receives the SDP answer.
13.-15. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the core network with remote address
information. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that
it shall ignore any incoming TCP connection establishment requests (TCP SYN),
the IMS-ALG indicates to the IMS-AGW to accept incoming TCP connection
establishment (TCP SYN) only from the indicated remote transport address.
NOTE 4: For \"a=setup:active\" in the SDP answer, these steps could possibly
be skipped if the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it
shall latch onto the required destination address via the source address/port
of the incoming media, as the IMS-AGW will then use the address information in
the TCP SYN when replying.
16.-18. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the access network with the request to
establish the TLS session once the TCP connection is established (effectively
making the IMS-AGW acting as the TLS client), in accordance with the
information in the \"a=setup\" attribute in the SDP answer.
19\. The Pâ€‘CSCF (IMSâ€‘ALG) modifies the SDP answer before sending it to the UE
A. The Pâ€‘CSCF (IMSâ€‘ALG) sets the transport to \"TCP/TLS/MSRP\" and includes
the fingerprint of the IMSâ€‘AGWÂ´s certificate in accordance to IETF RFC 4975
[25].
20\. The P-CSCF (IMA-ALG) then sends the updated SDP answer to IMS UE A. After
receiving this message IMS UE A completes the media security setup.
21\. Upon completion of the TCP connection establishment, the IMS-AGW starts
the establishment of the TLS session.
##### 6.2.10.3.1.1.2 IMS-ALG requests sending an outgoing TCP bearer
establishment {#ims-alg-requests-sending-an-outgoing-tcp-bearer-establishment
.H6}
Figure 6.2.10.3.1.1.2.1 shows an example call flow for the originating session
set-up procedures for one MSRP media stream using e2ae security, where the
IMS-ALG requests sending an outgoing TCP bearer establishment.
Figure 6.2.10.3.1.1.2.1: Originating example call flow for e2ae security for
MSRP where the IMS-ALG requests sending an outgoing TCP bearer establishment
The IMS UE A performs an IMS originating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure for requesting e2ae security for a media
stream is described step-by-step with an emphasis on the additional aspects
for IMS-ALG and IMS-AGW of media protection using TLS.
1\. As step 1 in figure 6.2.10.3.1.1.1.1.
2.-4. As steps 2-4 in figure 6.2.10.3.1.1.1.1 with the exception that the IMS-
ALG does not set the interlinkage topology on the termination T2.
5.-7. As steps 5-7 in figure 6.2.10.3.1.1.1.1.
8\. As step 8 in figure 6.2.10.3.1.1.1.1.
9\. As step 9 in figure 6.2.10.3.1.1.1.1.
10\. As step 10 in figure 6.2.10.3.1.1.1.1.
NOTE: The incoming TCP SYN does not trigger the sending of an outgoing TCP
SYN, and step 11 in figure 6.2.10.3.1.1.1.1thus does not apply.
11\. As step 12 in figure 6.2.10.3.1.1.1.1.
12.-14. As steps 13-15 in figure 6.2.10.3.1.1.1.1.
15.-17. As steps 16-18 in figure 6.2.10.3.1.1.1.1with the exception that the
IMS-ALG uses the \"Configure AGW Connection Point\" procedure also to
configure the termination towards the access network with the request to
establish the TCP connection (effectively making the IMS-AGW acting as the TCP
client), in accordance with the information in the \"a=setup\" attribute in
the SDP answer.
18\. The IMS-AGW sends a TCP SYN towards the UE to establish a TCP connection.
The UE answers with a TCP SYN ACK and the IMSâ€‘AGW replies with a TCP ACK,
completing the TCP connection establishment.
19\. As step 21 in figure 6.2.10.3.1.1.1.1.
20\. As step 19 in figure 6.2.10.3.1.1.1.1.
21\. As step 20 in figure 6.2.10.3.1.1.1.1.
##### 6.2.10.3.1.2 IMS UE terminating procedures for e2ae {#ims-ue-
terminating-procedures-for-e2ae .H6}
##### 6.2.10.3.1.2.1 Incoming TCP bearer establishment triggers an outgoing
TCP bearer establishment {#incoming-tcp-bearer-establishment-triggers-an-
outgoing-tcp-bearer-establishment-1 .H6}
Figure 6.2.10.3.1.2.1.1 shows an example call flow for the terminating session
set-up procedures for one MSRP media stream using e2ae security, where an
incoming TCP bearer establishment triggers an outgoing TCP bearer
establishment.
Figure 6.2.10.3.1.2.1.1: Terminating example call flow for e2ae security for
MSRP where an incoming TCP bearer establishment triggers an outgoing TCP
bearer establishment
The IMS UE B performs an IMS terminating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure for requesting e2ae security for a media
stream is described step-by-step with an emphasis on the additional aspects
for IMS-ALG and IMS-AGW of media protection using TLS.
1\. The Pâ€‘CSCF (IMSâ€‘ALG) receives an SDP offer for an MSRP media stream. For
each MSRP media stream offered with transport \"TCP/MSRP\", if both the IMS UE
and Pâ€‘CSCF (IMSâ€‘ALG) indicated support for e2ae-security for MSRP during
registration, the Pâ€‘CSCF (IMSâ€‘ALG) allocates the required resources, includes
the IMSâ€‘AGW in the media path and proceeds as specified in this clause.
NOTE 1: An operator can choose to terminate TLS in the IMSâ€‘AGW according to
the following steps for all media streams that are signalled in SIP INVITE
messages with transport TCP/MSRP, even if the UE did not indicate support for
e2ae security during registration. This can lead to session failures for pre-
Rel-12 IMS UEs or non-IMS UEs due to a mismatch of security parameters sent by
the network and expected by the UE, but on the other hand, it will ensure
compatibility with GSMA RCS 5.1 [35, 36], which recommends to always use e2ae
security for MSRP on the terminating leg.
2.-4. The IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to
request a termination for \"TCP/TLS\" media (for application-agnostic
interworking) or \"TCP/TLS/MSRP\" media (for application-aware interworking)
towards the access network. In turn, the IMSâ€‘AGW communicates the fingerprint
of the certificate it is going to use for setting up protection for this media
stream to the Pâ€‘CSCF (IMSâ€‘ALG). To indicate that the IMS-AGW shall operate in
TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute. The IMS-
ALG sets the interlinkage topology on the termination T1 to configure the IMS-
AGW to use the TCP connection establishment request (TCP SYN) received at the
termination T1 as a trigger to send a TCP connection establishment on the
termination T2.
NOTE 2: If \"a=setup:passive\" is received in the SDP answer in step 13, the
IMS-ALG then needs to sets the interlinkage topology on the termination T2
(not depicted)
5.-7. The IMS-ALG uses the \"Reserve And Configure AGW Connection Point\"
procedure to request a termination for \"TCP\" media (for application-agnostic
interworking) or \"TCP/ MSRP\" media (for application-aware interworking)
towards the core network. To indicate that the IMS-AGW shall operate in TCP
Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute.
8\. The Pâ€‘CSCF (IMSâ€‘ALG) changes the transport from \"TCP/ MSRP\" to
\"TCP/TLS/MSRP\" in the SDP offer, adds the \"a=3ge2ae:applied\" SDP attribute
and the fingerprint SDP attribute received from the IMS-AGW, and inserts the
address information received from the IMS-AGW.
9\. The Pâ€‘CSCF (IMSâ€‘ALG) forwards the SDP offer.
10\. The UE B chooses to become the active party in the TCP connection
establishment and sends a TCP SYN to establish the TCP connection. If the
P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any
incoming TCP connection establishment requests (TCP SYN), e.g. to enable a
remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not
indicate to the IMS-AGW at step 2 that it shall latch onto the required
destination address via the source address/port of the incoming media, the
IMS-AGW shall drop the TCP SYN received from the UE.\ If the TCP SYN is not
answered before a timer expiry, the UE will send the TCP SYN a second time
(step 10\'). The IMSâ€‘AGW will answer a repeated TCP SYN if it is received
after step 14 (step 10\').\ The IMS-AGW answers the TCP SYN and the remote
peer completes the TCP connection establishment.
11\. The IMS-AGW uses the TCP SYN received at the termination T1 (at step 10
or step 10\' if the TCP SYN is dropped at step 10) as a trigger to send a TCP
SYN towards the core network to establish a TCP connection (effectively making
the IMS-AGW acting as the TCP client towards the core network). The remote
peer answers the TCP SYN and the IMS-AGW completes the TCP connection
establishment.
12\. Upon completion of the TCP connection establishment, the UE B starts the
establishment of the TLS session. The IMS-AGW needs to wait until step 14 to
verify the received fingerprint.
13\. The Pâ€‘CSCF (IMSâ€‘ALG) receives the SDP answer. It contains the fingerprint
attribute with the UEÂ´s certificate in accordance to IETF RFC 4975 [25].
14.-16. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the UE B with remote address information. In
the remote descriptor, it also provides fingerprint attribute received from
the UE. This instructs the IMSâ€‘AGW to verify during the subsequent TLS
handshake with the IMS UE that the fingerprint of the certificate passed by
the IMS UE during this TLS handshake matches the fingerprint passed by the
Pâ€‘CSCF (IMSâ€‘ALG) to the IMSâ€‘AGW. If the P-CSCF (IMS-ALG) indicated to the IMS-
AGW at step 2 that it shall ignore any incoming TCP connection establishment
requests (TCP SYN), the IMS-ALG indicates to the IMS-AGW to accept incoming
TCP connection establishment (TCP SYN) only from the indicated remote
transport address.
17\. The Pâ€‘CSCF (IMSâ€‘ALG) modifies the SDP answer before sending it to the
core network. The Pâ€‘CSCF (IMSâ€‘ALG) sets the transport to \"TCP/ MSRP\" and
removes the SDP fingerprint attribute.
18\. The P-CSCF (IMA-ALG) then sends the updated SDP answer to core network.
##### 6.2.10.3.1.2.2 IMS-ALG requests sending an outgoing TCP bearer
establishment {#ims-alg-requests-sending-an-outgoing-tcp-bearer-
establishment-1 .H6}
Figure 6.2.10.3.1.2.2.1 shows an example call flow for the terminating session
set-up procedures for one MSRP media stream using e2ae security, where the
IMS-ALG requests sending an outgoing TCP bearer establishment.
Figure 6.2.10.3.1.2.2.1: Terminating example call flow for e2ae security for
MSRP where the IMS-ALG requests sending an outgoing TCP bearer establishment
The IMS UE B performs an IMS terminating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure for requesting e2ae security for a media
stream is described step-by-step with an emphasis on the additional aspects
for IMS-ALG and IMS-AGW of media protection using TLS.
1\. As step 1 in figure 6.2.10.3.1.2.1.1.
2.-4. As steps 2-4 in figure 6.2.10.3.1.2.1.1 with the exception that the IMS-
ALG does not set the interlinkage topology on the termination T1.
5.-7. As steps 7-7 in figure 6.2.10.3.1.2.1.1.
8\. As step 8 in figure 6.2.10.3.1.2.1.1.
9\. As step 9 in figure 6.2.10.3.1.2.1.1.
10\. As step 10 in figure 6.2.10.3.1.2.1.1.
NOTE: The incoming TCP SYN does not trigger the sending of an outgoing TCP
SYN, and step 11 in figure 6.2.10.3.1.2.1.1 thus does not apply.
11\. As step 12 in figure 6.2.10.3.1.2.1.1.
12\. As step 13 in figure 6.2.10.3.1.2.1.1.
13.-15. As steps 14-16 in figure 6.2.10.3.1.2.1.1.
16.-18. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the core network with the request to
establish the TCP connection, in accordance with the information in the
\"a=setup\" attribute in the SDP answer.
19\. The IMS-AGW sends a TCP SYN towards the core network to establish a TCP
connection. The remote peer answers with a TCP SYN ACK and the IMSâ€‘AGW replies
with a TCP ACK, completing the TCP connection establishment.
20\. As step 17 in figure 6.2.10.3.1.2.1.1.
21\. As step 18 in figure 6.2.10.3.1.2.1.1.
##### 6.2.10.3.2 End-to-access-edge security for conferencing (BFCP)
##### 6.2.10.3.2.1 IMS UE originating procedures for e2ae {#ims-ue-
originating-procedures-for-e2ae-1 .H6}
##### 6.2.10.3.2.1.1 Incoming TCP bearer establishment triggers an outgoing
TCP bearer establishment {#incoming-tcp-bearer-establishment-triggers-an-
outgoing-tcp-bearer-establishment-2 .H6}
Figure 6.2.10.3.2.1.1.1 shows the originating session set-up procedures for
one or more BFCP media stream(s) using e2ae security.
Figure 6.2.10.3.2.1.1.1: Originating example call flow for e2ae security for
BFCP where an incoming TCP bearer establishment triggers an outgoing TCP
bearer establishment
The IMS UE A performs an IMS originating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure for requesting e2ae security for a media
stream is described step-by-step with an emphasis on the additional aspects
for IMS-ALG and IMS-AGW of media protection using TLS.
1\. IMS UE A sends an SDP offer for a media stream containing cryptographic
information, together with an \"a=3ge2ae:requested\" SDP attribute for the
BFCP-related SDP m-line, to the Pâ€‘CSCF (IMSâ€‘ALG). For e2ae protection of BFCP
the cryptographic information contained in the SDP offer consists of the
fingerprint of the certificate of IMS UE A in accordance to IETF RFC 4975
[25]. For each media stream that uses transport \"TCP/TLS/BFCP\", the Pâ€‘CSCF
(IMSâ€‘ALG) checks for the presence of the \"a=3ge2ae:requested\" SDP attribute.
If that indication is present and the Pâ€‘CSCF (IMSâ€‘ALG) indicated support of
e2ae-security for BFCP during registration, the Pâ€‘CSCF (IMSâ€‘ALG) allocates the
required resources, includes the IMSâ€‘AGW in the media path and proceeds as
specified in this clause.
2.-4. The IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to
request a termination for \"TCP\" media towards the core network. To indicate
that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides
\"a=setup:actpass\" attribute. The IMS-ALG sets the interlinkage topology on
the termination T2 to configure the IMS-AGW to use the TCP connection
establishment request (TCP SYN) received at the termination T2 as a trigger to
send a TCP connection establishment on the termination T1.
NOTE 1: If \"a=setup:passive\" is received in the SDP answer in step 13, the
IMS-ALG then needs to set the interlinkage topology on the termination T1 (not
depicted).
5.-7. The IMS-ALG uses the \"Reserve And Configure AGW Connection Point\"
procedure to request a termination for \"TCP/TLS\" media towards the access
network. In the remote descriptor, it provides the IP address, port and
fingerprint attribute received from the UE containing the fingerprint of the
UEÂ´s certificate in accordance to IETF RFC 4975 [25]. This instructs the
IMSâ€‘AGW to verify during the subsequent TLS handshake with the IMS UE that the
fingerprint of the certificate passed by the IMS UE during this TLS handshake
matches the fingerprint passed by the Pâ€‘CSCF (IMSâ€‘ALG) to the IMSâ€‘AGW. In
turn, the IMSâ€‘AGW communicates the fingerprint of the certificate it is going
to use for setting up protection for this media stream to the Pâ€‘CSCF
(IMSâ€‘ALG). To indicate that the IMS-AGW shall operate in TCP Proxy mode, the
IMS-ALG provides \"a=setup:actpass\" attribute.
8\. The Pâ€‘CSCF (IMSâ€‘ALG) changes the transport from \"TCP/TLS/BFCP\" to
\"TCP/BFCP\" in the SDP offer, removes the \"a=3ge2ae:requested\" SDP
attribute and the fingerprint SDP attribute, and inserts the address
information received from the IMS-AGW.
9\. The Pâ€‘CSCF (IMSâ€‘ALG) forwards the SDP offer.
10\. The remote peer chooses to become the active party in the TCP connection
establishment and sends a TCP SYN to establish the TCP connection. If the
P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any
incoming TCP connection establishment requests (TCP SYN), e.g. to enable a
remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not
indicate to the IMS-AGW at step 2 that it shall latch onto the required
destination address via the source address/port of the incoming media, the
IMS-AGW shall drop the TCP SYN received from the remote peer.\ If the TCP SYN
is not answered before a timer expiry, the remote peer will send the TCP SYN a
second time (step 10\'). The IMSâ€‘AGW will answer a repeated TCP SYN if it is
received after step 14 (step 10\').\ The IMS-AGW answers the TCP SYN and the
remote peer completes the TCP connection establishment.
11\. The IMS-AGW uses the TCP SYN received at the termination T2 (at step 10
or step 10\' if the TCP SYN is dropped at step 10) as a trigger to send a TCP
SYN towards the UE to establish a TCP connection (effectively making the IMS-
AGW acting as the TCP client towards the UE). The UE answers the TCP SYN and
the IMS-AGW completes the TCP connection establishment.
12\. Upon completion of the TCP connection establishment, the UE B starts the
establishment of the TLS session. The IMS-AGW needs to wait until step 14 to
verify the received fingerprint.
13\. The Pâ€‘CSCF (IMSâ€‘ALG) receives the SDP answer.
14.-16. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the core network with remote address
information. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that
it shall ignore any incoming TCP connection establishment requests (TCP SYN),
the IMS-ALG indicates to the IMS-AGW to accept incoming TCP connection
establishment (TCP SYN) only from the indicated remote transport address.
NOTE 2: For \"a=setup:active\" in the SDP answer, these steps could possibly
be skipped if the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it
shall latch onto the required destination address via the source address/port
of the incoming media, as the IMS-AGW will then use the address information in
the TCP SYN when replying.
17\. The Pâ€‘CSCF (IMSâ€‘ALG) modifies the SDP answer before sending it to the UE
A. The Pâ€‘CSCF (IMSâ€‘ALG) sets the transport to \"TCP/TLS/BFCP\" and includes
the fingerprint of the IMSâ€‘AGWÂ´s certificate in accordance to IETF RFC 4975
[25].
18\. The P-CSCF (IMA-ALG) then sends the updated SDP answer to IMS UE A. After
receiving this message IMS UE A completes the media security setup.
##### 6.2.10.3.2.2 IMS UE terminating procedures for e2ae {#ims-ue-
terminating-procedures-for-e2ae-1 .H6}
##### 6.2.10.3.2.2.1 Incoming TCP bearer establishment triggers an outgoing
TCP bearer establishment {#incoming-tcp-bearer-establishment-triggers-an-
outgoing-tcp-bearer-establishment-3 .H6}
Figure 6.2.10.3.2.2.1.1 shows the terminating session set-up procedures for
one or more BFCP media stream(s) using e2ae security.
Figure 6.2.10.3.2.2.1.1: Terminating example call flow for e2ae security for
MSRP where an incoming TCP bearer establishment triggers an outgoing TCP
bearer establishment
The IMS UE B performs an IMS terminating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure for requesting e2ae security for a media
stream is described step-by-step with an emphasis on the additional aspects
for IMS-ALG and IMS-AGW of media protection using TLS.
1\. The Pâ€‘CSCF (IMSâ€‘ALG) receives an SDP offer for an MSRP media stream. For
each BFCP media stream offered with transport \"TCP/BFCP\", if both the IMS UE
and Pâ€‘CSCF (IMSâ€‘ALG) indicated support for e2ae-security for BFCP during
registration, the Pâ€‘CSCF (IMSâ€‘ALG) allocates the required resources, includes
the IMSâ€‘AGW in the media path and proceeds as specified in this clause.
2.-4. The IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to
request a termination for \"TCP/TLS\" media towards the access network. The
IMS-ALG configures the IMS-AGW with the request to start the establishment of
the TLS session once the TCP connection is established (effectively making the
IMS-AGW acting as the TLS client). . To indicate that the IMS-AGW shall
operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute.
The IMS-ALG sets the interlinkage topology on the termination T1 to configure
the IMS-AGW to use the TCP connection establishment request (TCP SYN) received
at the termination T1 as a trigger to send a TCP connection establishment on
the termination T2.\ The IMSâ€‘AGW communicates the fingerprint of the
certificate it is going to use for setting up protection for this media stream
to the Pâ€‘CSCF (IMSâ€‘ALG).
NOTE: If \"a=setup:passive\" is received in the SDP answer in step 13, the
IMS-ALG then needs to sets the interlinkage topology on the termination T2
(not depicted)
5.-7. The IMS-ALG uses the \"Reserve And Configure AGW Connection Point\"
procedure to request a termination for \"TCP\" media towards the core network.
To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG
provides \"a=setup:actpass\" attribute.
8\. The Pâ€‘CSCF (IMSâ€‘ALG) changes the transport from \"TCP/ BFCP\" to
\"TCP/TLS/BFCP\" in the SDP offer, adds the \"a=3ge2ae:applied\" SDP attribute
and the fingerprint SDP attribute received from the IMS-AGW, and inserts the
address information received from the IMS-AGW.
9\. The Pâ€‘CSCF (IMSâ€‘ALG) forwards the SDP offer.
10\. The UE B chooses to become the active party in the TCP connection
establishment and sends a TCP SYN to establish the TCP connection. If the
P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any
incoming TCP connection establishment requests (TCP SYN), e.g. to enable a
remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not
indicate to the IMS-AGW at step 2 that it shall latch onto the required
destination address via the source address/port of the incoming media, the
IMS-AGW shall drop the TCP SYN received from the UE.\ If the TCP SYN is not
answered before a timer expiry, the UE will send the TCP SYN a second time
(step 10\'). The IMSâ€‘AGW will answer a repeated TCP SYN if it is received
after step 14 (step 10\').\ The IMS-AGW answers the TCP SYN and the remote
peer completes the TCP connection establishment.
11\. The IMS-AGW sends a TCP SYN towards the core network to establish a TCP
connection. The remote peer answers the TCP SYN and the IMS-AGW completes the
TCP connection establishment.
12\. Upon completion of the TCP connection establishment, the IMS-AGW starts
the establishment of the TLS session. The IMS-AGW needs to wait until step 14
to verify the received fingerprint.
13\. The Pâ€‘CSCF (IMSâ€‘ALG) receives the SDP answer. It contains the fingerprint
attribute with the UEÂ´s certificate in accordance to IETF RFC 4975 [25].
14.-16. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the UE B with remote address information. In
the remote descriptor, it also provides fingerprint attribute received from
the UE. This instructs the IMSâ€‘AGW to verify during the TLS handshake with the
IMS UE (see step 12) that the fingerprint of the certificate passed by the IMS
UE during this TLS handshake matches the fingerprint passed by the Pâ€‘CSCF
(IMSâ€‘ALG) to the IMSâ€‘AGW. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at
step 2 that it shall ignore any incoming TCP connection establishment requests
(TCP SYN), the IMS-ALG indicates to the IMS-AGW to accept incoming TCP
connection establishment (TCP SYN) only from the indicated remote transport
address.
17\. The Pâ€‘CSCF (IMSâ€‘ALG) modifies the SDP answer before sending it to the
core network. The Pâ€‘CSCF (IMSâ€‘ALG) sets the transport to \"TCP/ BFCP\" and
removes the SDP fingerprint attribute.
18\. The Pâ€‘CSCF (IMSâ€‘ALG) then sends the updated SDP answer to core network.
#### 6.2.10.4 End-to-access-edge security for UDP based media using DTLS
##### 6.2.10.4.1 General
The IMS-ALG and the IMS-AGW may support e2ae security for the UDP based media
using DTLS and certificate fingerprints.
The following clauses describe extensions to the Iq signalling procedures and
their interactions with SIP signalling in the control plane and with user
plane procedures if the e2ae security for the UDP based media using DTLS and
certificate fingerprints is supported by the IMS-ALG and the IMS-AGW and if
the IMS-ALG indicated support of e2ae security for the UDPTL using DTLS and
certificate fingerprints during registration.
##### 6.2.10.4.2 Session establishment from IMS access network for T.38 fax
using \"UDP/TLS/UDPTL\"
Upon receipt of an SDP offer from the IMS access network containing T.38 fax
media using the \"UDP/TLS/UDPTL\" transport protocol with the associated:
\- 3ge2ae SDP attribute, as defined in 3GPP TS 24.229 [11], with a value
\"requested\";
\- fingerprint SDP attribute(s) as defined in IETF RFC 8122 [80];
\- DTLS association identity SDP attribute \"a=tls-id\" defined in IETF RFC
8842 [81]; and
\- setup SDP attribute as defined in IETF RFC 4145 [30];
the IMS-ALG shall:
\- check the received value of the setup SDP attribute to determine if the
IMS-AGW needs to act as DTLS client or DTLS server. When the received value is
equal to:
a) \"active\" the IMS-AGW needs to act as DTLS server;
b) \"passive\" the IMS-AGW needs to act as DTLS client; or
c) \"actpass\" the IMS-ALG shall decide if the IMS-AGW needs to act as DTLS
client or DTLS server;
\- when reserving the transport addresses/resources towards the IMS access
network:
a) indicate to the IMS-AGW \"UDP/DTLS\" as transport protocol;
b) if the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS
session information element to request the IMS-AGW to start the DTLS session
setup;
c) include the Notify (D)TLS session establishment Failure Event information
element to request the IMS-AGW to report the unsuccessful DTLS session setup;
d) include the Remote certificate fingerprint information element with the
value of the received fingerprint SDP attribute(s); and
e) include the Local certificate fingerprint Request information element to
request the certificate fingerprint of the IMS-AGW;
\- indicate to the IMS-AGW \"UDP\" as transport protocol when reserving the
transport addresses/resources towards the IMS core network; and
\- remove the setup SDP attribute and indicate the transport protocol
\"UDPTL\" in the SDP offer towards the IMS core network.
Upon receipt of an SDP answer from the IMS core network, the IMS-ALG shall:
\- in the \"m=\" line indicating T.38 fax using UDPTL, change the transport
protocol to \"UDP/TLS/UDPTL\";
\- insert the fingerprint SDP attribute with the value of the Local
certificate fingerprint information element received from the IMS-AGW;
\- insert the \"a=tls-id\" SDP attribute containing a new DTLS association
identity; and
\- insert the setup SDP attribute with the value:
a) \"active\" if the IMS-ALG requested the IMS-AGW to act as DTLS client; or
b) \"passive\" if the IMS-AGW shall take the DTLS server role.
The message sequence chart shown in the figure 6.2.10.4.2.1 gives an example
of a session establishment from the IMS access network with an emphasis on the
additional aspects for the IMS-ALG and the IMS-AGW for the e2ae protection of
the T.38 fax media using UDPTL over DTLS.
Figure 6.2.10.4.2.1: Session setup from the IMS access network with e2ae
protection of T.38 fax
##### 6.2.10.4.3 Session establishment towards IMS access network for T.38 fax
using \"UDP/TLS/UDPTL\"
Upon receipt of an SDP offer from the IMS core network containing T.38 fax
media using the \"UDPTL\" transport protocol the IMS-ALG shall:
\- when reserving the transport addresses/resources towards the IMS access
network:
a) indicate to the IMS-AGW \"UDP/DTLS\" as transport protocol;
b) include the Notify (D)TLS session establishment Failure Event information
element to request the IMS-AGW to report the unsuccessful DTLS session setup;
and
NOTE 1: The IMS-ALG may omit this information element when reserving resources
and instead send it to the IMS-AGW when modifying the resources towards the
IMS access network.
c) include the Local certificate fingerprint Request information element to
request the certificate fingerprint of the IMS-AGW; and
\- when reserving the transport addresses/resources towards the IMS core
network indicate to the IMS-AGW \"UDP\" as transport protocol.
\- modify the SDP offer that will be sent to the IMS access network by:
\- in the \"m=\" line indicating T.38 fax using UDPTL, changing the transport
protocol to \"UDP/TLS/UDPTL\";
\- inserting the 3ge2ae SDP attribute, as defined in 3GPP TS 24.229 [11], with
a value \"applied\";
\- inserting the fingerprint SDP attribute, as defined in IETF RFC 8122 [80],
with the value of the Local certificate fingerprint information element
received from the IMS-AGW;
\- inserting the \"tls-id\" SDP attribute with the new DTLS association
identity; and
\- inserting the setup SDP attribute, as defined in IETF RFC 4145 [30], e.g.
with the value \"actpass\".
NOTE 2: Alternatively, the IMS-ALG can set the value of the setup SDP
attribute to \"active\" if the IMS-ALG wants that the IMS-AGW provides the
DTLS client role or to \"passive\" if the IMS-ALG wants that the IMS-AGW
provides the DTLS server role e.g. for NAT traversal.
Upon receipt of an SDP answer from the IMS access network containing T.38 fax
media using the \"UDP/TLS/UDPTL\" transport protocol with the associated
fingerprint and setup SDP attributes, the IMS-ALG shall:
\- check the value of the received setup SDP attribute to determine if the
IMS-AGW needs to act as DTLS client or DTLS server. When the received value is
equal to:
a) \"active\" the IMS-AGW needs to act as DTLS server; or
b) \"passive\" the IMS-AGW needs to act as DTLS client;
\- when modifying the transport addresses/resources towards the IMS access
network:
a) if the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS
session information element to request the IMS-AGW to start the DTLS session
setup;
b) include the Remote certificate fingerprint information element with the
value of the received fingerprint SDP attribute(s); and
c) if not already provided, include the Notify (D)TLS session establishment
Failure Event information element to request the IMS-AGW to report the
unsuccessful DTLS session setup; and
\- remove the setup SDP attribute and indicate the transport protocol
\"UDPTL\" in the SDP answer sent towards the IMS core network.
The message sequence chart shown in the figure 6.2.10.4.3.1 gives an example
of a session establishment towards the IMS access network with an emphasis on
the additional aspects for the IMS-ALG and the IMS-AGW for the e2ae protection
of the T.38 fax media using UDPTL over DTLS.
NOTE 3: In the shown example it is assumed that the IMS-ALG requested the IMS-
AGW at step 2 to latch onto the address of the received media packets to
determine the corresponding destination address. Otherwise, the DTLS
ClientHello message received at the step 10 will be dropped until the IMS-AGW
receives a repeated DTLS ClientHello message after the step 13.
Figure 6.2.10.4.3.1: Session setup towards the IMS access network with e2ae
protection of T.38 fax
##### 6.2.10.4.4 IMS-AGW procedure for e2ae security of T.38 fax using
\"UDP/TLS/UDPTL\"
The IMS-AGW shall:
\- upon reception of the Local certificate fingerprint Request information
element, select an own certificate for the T.38 fax media stream, uniquely
associate the own certificate with the T.38 media stream, and send to the IMS-
ALG the Local certificate fingerprint information element with the fingerprint
of the own certificate;
\- uniquely associate the value of the Remote certificate fingerprint
information element, received from the IMS-ALG, with the corresponding T.38
fax media stream;
\- take a DTLS server role and be prepared to receive a DTLS ClientHello
message from the served UE;
\- upon reception of the Establish (D)TLS session information element, take a
DTLS client role and start DTLS session establishment by sending the DTLS
ClientHello message to the served UE; and
\- verify during the subsequent DTLS handshake with the served UE (as
described in IETF RFC 7345 [33] and IETF RFC 8842 [81]) that the fingerprint
of the certificate passed by the served UE during DTLS handshake matches the
value of the Remote certificate fingerprint information element received from
the IMS-ALG:
a) if the verification fails, the IMS-AGW shall regard the remote DTLS
endpoint as not authenticated, terminate the DTLS session and as specified in
clause 6.2.10.4.5, shall report the unsuccessful DTLS session setup to the
IMS-ALG; or
b) if the verification succeeds, the IMS-AGW shall continue with DTLS session
setup and when the DTLS session is established, the IMS-AGW shall be prepared
to receive and convert the protected media from the served UE to the
unprotected media to be sent to the core network and vice versa.
##### 6.2.10.4.5 DTLS session establishment failure indication
The IMS-AGW shall use a Notify (D)TLS session establishment Failure Indication
procedure to report DTLS session establishment related failures.
The figure 6.2.10.4.5.1 shows the message sequence chart example when the IMS-
AGW reports the unsuccessful DTLS session setup to the IMS-ALG.
Figure 6.2.10.4.5.1: DTLS session establishment failure indication
#### 6.2.10.5 End-to-access-edge security for RTP based media using DTLS-SRTP
The procedures are similar to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the eIMS-AGW to provide IMS media plane security using
DTLS.
Upon receipt of an SDP offer from the IMS access network, the IMS-ALG shall:
\- check the received value of the setup SDP attribute to determine if the
IMS-AGW needs to act as DTLS client or DTLS server. When the received value is
equal to:
a) \"active\" the IMS-AGW needs to act as DTLS server;
b) \"passive\" the IMS-AGW needs to act as DTLS client; or
c) \"actpass\" the IMS-ALG shall decide if the IMS-AGW needs to act as DTLS
client or DTLS server;
\- if the received SDP offer contains \"a=tls-id\" media-level SDP attribute
(as specified in IETF RFC 8842 [81]), create a new DTLS association identity;
\- when reserving the transport addresses/resources towards the IMS access
network:
a) indicate to the IMS-AGW \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as
transport protocol;
b) include the Remote certificate fingerprint information element with the
value of the received fingerprint SDP attribute from the UE (IMS UE or WIC);
c) include the Local certificate fingerprint Request information element to
request the certificate fingerprint of the IMS-AGW; and
d) if the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS
session information element to request the IMS-AGW to start the DTLS session
setup;
\- indicate to the IMS-AGW \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport
protocol when reserving the transport addresses/resources towards the IMS core
network; and
\- remove the setup SDP attribute and indicate the transport protocol
\"RTP/AVP\" in the offer towards the IMS core network.
Upon receipt of an SDP answer from the IMS core network, the IMS-ALG shall:
\- in the \"m=\" line indicating the use of SRTP, change the transport
protocol to \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\";
\- insert the fingerprint SDP attribute with the value of the Local
certificate fingerprint information element received from the IMS-AGW; and
\- insert the \"a=tls-id\" SDP attribute containing a new DTLS association
identity; and
\- insert the setup SDP attribute with the value:
a) \"active\" if the IMS-ALG requested the IMS-AGW to act as DTLS client; or
b) \"passive\" if the IMS-AGW shall take the DTLS server role.
Figure 6.2.10.5.1 shows the message sequence chart example of UE (IMS UE or
WIC) originated procedure using DTLS-SRTP.
NOTE 1: There are two served user instances of the DTLS service within WebRTC:
the data channel and the key exchange for SRTP. Thus, there are either two
DTLS connections behind a single DTLS session, or two separate DTLS sessions.
Below establishment procedures when applied for WebRTC are based on the
assumption that there wasn\'t yet any DTLS procedure triggered from WebRTC
data channel side.
Figure 6.2.10.5.1: UE originated procedure using DTLS-SRTP
NOTE 2: The UE (IMS UE or WIC) may receive the ClientHello prior the SDP
answer, thus the handshake might be initiated, but the handshake will not
complete until the SDP answer has been received by the UE (IMS UE or WIC).
Upon receipt of an SDP offer from the IMS core network using the \"RTP/AVP\"
or \"RTP/AVPF\" over UDP as transport protocol the IMS-ALG shall:
\- when reserving the transport addresses/resources towards the IMS access
network:
a) indicate to the IMS-AGW \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as
transport protocol; and
b) include the Local certificate fingerprint Request information element to
request the certificate fingerprint of the IMS-AGW;
\- when reserving the transport addresses/resources towards the IMS core
network indicate to the IMS-AGW \"RTP/AVP\" or \"RTP/AVPF\" over UDP as
transport protocol; and
\- modify the SDP offer that will be sent to the IMS access network by:
a) in the \"m=\" line that is indicating the use of SRTP, changing the
transport protocol to \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\";
b) inserting the fingerprint SDP attribute with the value of the Local
certificate fingerprint information element received from the IMS-AGW;
c) inserting the \"tls-id\" SDP attribute with the new DTLS association
identity; and
d) inserting the setup SDP attribute, as defined in IETF RFC 4145 [30], with
the value \"actpass\".
Upon receipt of an SDP answer from the IMS access network containing the use
of the \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" transport protocol with
the associated fingerprint and setup SDP attributes, the IMS-ALG shall:
\- check the value of the received setup SDP attribute to determine if the
IMS-AGW needs to act as DTLS client or DTLS server. When the received value is
equal to:
a) \"active\" the IMS-AGW needs to act as DTLS server; or
b) \"passive\" the IMS-AGW needs to act as DTLS client;
\- when modifying the transport addresses/resources towards the IMS access
network:
a) if the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS
session information element to request the IMS-AGW to start the DTLS session
setup;
b) include the Remote certificate fingerprint information element with the
value of the received fingerprint SDP attribute; and
c) if not already provided, include the Notify (D)TLS session establishment
Failure Event information element to request the IMS-AGW to report the
unsuccessful DTLS session setup; and
\- remove the setup SDP attribute and indicate the transport protocol
\"RTP/AVP\" in the SDP answer towards the IMS core network.
The message sequence chart shown in the figure 6.2.10.5.2 shows the message
sequence chart example of UE (IMS UE or WIC) terminated procedure using DTLS-
SRTP.
Figure 6.2.10.5.2: UE terminated procedure using DTLS-SRTP
NOTE 3: The IMS-AGW might receive the ClientHello prior receiving the MOD-
request, but the DTLS handshake will not finish before the MOD-request (more
specific: the fingerprint from UE (IMS UE-b or WIC-b) has been received.
#### 6.2.10.6 End-to-access-edge security for WebRTC data channels using SCTP-
over-DTLS transport
##### 6.2.10.6.1 General
The requirements on eP-CSCF (IMS-ALG) and eIMS-AGW for the procedures to
establish WebRTC data channels are specified in clause 5.20.2.
The following clauses describe extensions to the Iq signalling procedures and
their interactions with SIP signalling in the control plane and with user
plane procedures if the e2ae security for the WebRTC data channels using
\"SCTP over DTLS\" is supported by the eP-CSCF (IMS-ALG) and the eIMS-AGW.
All message sequence charts in this clause are examples. The example high-
level H.248 context model is defined in Figure 6.2.1.1 and further detailed
below.
##### 6.2.10.6.2 Call flow for data channel establishment from WIC towards IMS
access network and MSRP session establishment
Support of multiple WebRTC data channels per WebRTC calls implies support of
so called H.248 stream grouping. Figure 6.2.10.6.2.1 shows an example H.248
Context model for a WebRTC call with unbundled audio and video, and with
multiple data components.
Figure 6.2.10.6.2.1: eIMS-AGW -- H.248 Context model for WebRTC gateway
inclusive H.248 Stream Group for WebRTC data components
The example flow in this clause focuses on the WebRTC data channel part only.
Thus, only H.248 Streams S1 (for deaggregation of multiple data channels) and
S2 (for MSRP traffic) are indicated subsequently.
Figure 6.2.10.6.2.2 shows the message sequence chart example for the WIC
originated procedure to establish a WebRTC MSRP data channel using SCTP-over-
DTLS transport.
Figure 6.2.10.6.2.2: WIC originated procedure for WebRTC data channel
establishment and MSRP stream establishment
The IMS UE A embedded WIC-A performs an IMS originating session set-up
according to 3GPP TS 23.228 [2] with modifications for support of WebRTC
service control.
The procedure in the above figure for requesting an MSRP profiled WebRTC data
channel is described step-by-step with an emphasis on the additional aspects
for eP-CSCF (IMS-ALG) and eIMS-AGW with regards to the creation of an H.248
Context for interworking MSRP-over-DC to MSRP-over-TCP:
1\. IMS UE-A (WIC-A) sends an SDP offer for an MSRP WebRTC data channel. A new
\"SCTP association over DTLS association \" is requested.
2\. - 4. The eP-CSCF (IMS-ALG) uses the \"Reserve AGW Connection Point\"
procedure to request a termination and H.248 Stream \'2\' for \"MSRP-over-
TCP\" media towards the core network.
5\. The ePâ€‘CSCF (IMSâ€‘ALG) modifies the SDP offer to offers TCP transport for
MSRP, and to requests the remote peer to select the TCP setup direction.
6\. The ePâ€‘CSCF (IMSâ€‘ALG) forwards the SDP offer.
7\. -- 10. The configuration of core network side H.248 Stream endpoint
S~2~/T~2~ is completed based on the received SDP answer (7).
11\. The eP-CSCF (IMS-ALG) uses the \"Reserve and Configure AGW Connection
Point\" procedure to request a termination inclusive an H.248 Stream Group for
WebRTC DC traffic. The eP-CSCF (IMS-ALG) uses an H.248 Context model with
H.248 Stream grouping as required for WebRTC DC support. The Stream Group (SG)
configurations according to Figure 6.2.10.6.2.1 is applied: The eP-CSCF (IMS-
ALG) decides to assign H.248 StreamID value \'1\' to the H.248 deaggregation
stream and to use H.248 StreamID value \'2\' for the WebRTC data channel. The
following aspects should be emphasized:
a) H.248 deaggregation stream (S~1~):\ \- covers the protocol stack segment
\"SCTP Association over DTLS connection over L4/IP\";\ \- the \'UDP\' is
indicated as L4 protocol;\ \- the SDP information related to the underlying
ICE procedures is omitted in the abstracted ADD.req command;\ \- the
deaggregation stream embedded SDP covers the attributes for configuration of
the SCTP Association;
b) H.248 component stream (S~2~):\ \- covers the upper protocol levels of the
logical DC and the IP application layer (here \'MSRP\');
c) DTLS session/DTLS association establishment:\ \- an outgoing establishment
procedure is enabled (\"which will be executed by the eIMS-AGW after
successful L4 connectivity\");
d) SCTP association establishment:\ \- both, an incoming and outgoing
establishment procedure is enabled (\"in order to emulate \"SCTP simultaneous
open\" behaviour\");\ \- the eIMS-AGW would start to send an SCTP INIT chunk
as soon as the DTLS connection is \"data transfer ready\" (see step 16);
e) Preparation of DC release already in DC establishment phase:\ \-
Background: DC release is based on SCTP Association level SCTP Stream reset
procedures. Incoming reset requests could be either autonomously handled by
the eIMS-AGW or explicitly controlled by the eP-CSCF (IMS-ALG).\ \- The
activation of a notification mechanism is required in any case (indicating the
autonomous behaviour by the default value \'accept\' of the correspondent
event parameter).
12./13. The eIMS-AGW confirms the successful creation and configuration of the
requested H.248 Stream Group for WebRTC DC traffic.
14./15. The eP-CSCF (IMS-ALG) then sends the updated SDP answer to the IMS
UE-A embedded WIC-A.
NOTE: In figure 6.2.10.6.2.2. \"a=dcmap\" does not contain priority
information and the default priority thus applies.
### 6.2.10A IMS end-to-end Media Plane Security
#### 6.2.10A.1 End-to-end security for RTP based media using SDES
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
providing \"RTP/SAVP\" or \"RTP/SAVPF\", as received in the SDP, to the IMS-
AGW as transport protocol and not providing any other media related
information to the corresponding terminations, and configuring the IMS-AGW to
pass media transparently.
The IMS-ALG shall forward the SDP with unmodified transport protocol for those
media lines and unmodified SDES SDP attribute(s).
#### 6.2.10A.2 End-to-end security for TCP-based media using TLS
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
providing \"TCP\" to the IMS-AGW as transport protocol and not providing any
TLS related information nor any other media related information to the
corresponding terminations, and configuring the IMS-AGW to pass media
transparently.
The IMS-ALG shall forward the SDP with unmodified transport protocol for those
media lines and unmodified TLS related SDP attribute(s).
NOTE: End-to-end security for TCP-based media using TLS is not supported
between two terminals being located behind firewalls/NATs.
### 6.2.11 Change Through-Connection
The Change Through-Connection procedure is used for opening and closing of
gates and is mandatory for IMS-ALG and IMS-AGW to support. The IMS-ALG sets
the Stream mode parameter using the Change Through-Connection procedure to
request the IMS-AGW to one-way or both-way through-connect or block media
streams on a termination.
The IMS-ALG may combine the Change Through-Connection procedure with the
Reserve and Configure AGW Connection Point, Reserve AGW Connection Point or
Configure AGW Connection Point procedure as in Figure 6.2.1.2., or may apply
this procedure separately.
### 6.2.12 Emergency Calls
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
requesting the IMS-AGW to treat the call as emergency call with a preferential
handling by including the information element \"Emergency Call Indicator\"
within the \"Reserve and Configure AGW Connection Point\" or \"Reserve AGW
Connection Point procedure\".
### 6.2.13 Explicit Congestion Notification support
#### 6.2.13.1 General
An IMS-ALG may configure the IMS-AGW to transfer the ECN bits in the IP header
transparent (see clause 6.2.13.2) or to act as an ECN endpoint (see clause
6.2.13.3). See clause 5.12.
#### 6.2.13.2 ECN Active Indicated (ECN transparent)
Figure 6.2.13.2.1 shows the message sequence chart example for indicating ECN
transparent.
Figure 6.2.13.2.1: Procedure to indicate ECN transparent negotiated
Upon receipt of the indication that ECN transparent has been negotiated, the
IMS-AGW shall forward ECN bits within IP packets unmodified. Any RTCP feedback
received shall be passed unchanged.
#### 6.2.13.3 ECN support requested (ECN endpoint)
Figure 6.2.13.3.1 shows the message sequence chart example for requesting ECN
endpoint.
Figure 6.2.13.3.1: Procedure to Request ECN endpoint
Upon receipt of a request to apply ECN the IMS-AGW shall set the ECN field of
the IP header in accordance with 3GPP TS 26.114 [21] when sending any data
packets.
Upon receipt of any IP headers indicating ECN Congestion Experienced (ECN-CE)
the IMS-AGW shall trigger rate adaptation in accordance with 3GPP TS 26.114
[21].
NOTE: ECN endpoint requires the IMS-ALG to configure the IMS-AGW with all
media attributes to allow rate adaptation even if no transcoding is
required/supported in the IMS-AGW.
#### 6.2.13.4 ECN Failure Indication (ECN endpoint)
Figure 6.2.13.4.1 shows the message sequence chart example for an ECN Failure
Event.
Figure 6.2.13.4.1: Procedure to Report ECN Failure
When the IMS-ALG receives a Notification indicating that a failure has
occurred, the IMS-ALG may trigger a new SDP offer to disable ECN.
### 6.2.14 Access Transfer procedures with media anchored in IMS-AGW (ATGW)
#### 6.2.14.1 General
This clause describes extensions to the Iq signalling procedures and their
interactions with SIP signalling in the control plane and with user plane
procedures to support the \"SRVCC enhanced with ATCF\" procedures between the
IMS-ALG (ATCF) and IMS-AGW (ATGW) when the IMS-ALG and IMS-AGW support the
ATCF and ATGW functionality, as specified in 3GPP TS 23.237 [18] and 3GPP TS
24.237 [19].
The Access Transfer procedures are optional to support on the Iq reference
point. The requirements in this clause shall apply if these procedures are
supported.
All message sequence charts in this clause are examples.
#### 6.2.14.2 H.248 context model
Figure 6.2.14.2.1 shows the H.248 context model after the PS originating or
terminating session establishment and before the PS to CS access transfer
procedure. The \"squared\" line represents the call control signalling. The
\"dotted\" line represents the bearer. The bearer termination T1 is used for
the media path of the PS access leg, the bearer termination T2 is used for the
media path of the remote leg.
Figure 6.2.14.2.1: H.248 Context Model before Access Transfer
Figure 6.2.14.2.2 shows the H.248 context model during the PS to CS access
transfer procedure. The IMS-ALG (ATCF) may seize a new bearer termination T3
for the new media path of the CS access leg, e.g. if the PS and CS nodes
before and after the handover are reachable via different IP realms or use a
different IP version. The IMS-ALG (ATCF) may alternatively reconfigure the T1
termination with the new remote configuration (e.g. IP address and media)
instead of seizing a new termination; in that case, the H.248 context model
remains as before access transfer.
Bi-casting is not supported during access transfer, i.e. the IMS-AGW (ATGW)
does not duplicate downlink media packets received from the remote leg to the
source and target access legs simultaneously.
Figure 6.2.14.2.2: H.248 Context Model during Access Transfer
Figure 6.2.14.2.3 shows the H.248 context model after the PS to CS access
transfer procedure if the source access leg is released. If the UE chooses to
retain some media flow(s) in the transferred-out access, the H.248 context
model remains as during access transfer.
Figure 6.2.14.2.3: H.248 Context Model after Access Transfer
#### 6.2.14.3 PS session origination or termination with media anchoring in
IMS-AGW (ATGW) signaling procedures
If the IMS-ALG (ATCF) decides to anchor the media of a session in the IMS-AGW
(ATGW) the call related procedures shall follow the basic procedures for IMS
ALG (i.e. as specified in clause 6.2.1) with the following differences:
\- The IMS-ALG (ATCF) shall seize a termination towards the terminating user,
using the \"Reserve AGW Connection Point\" procedure before sending a SDP
offer to the terminating user. The IMS-ALG (ATCF) may signal media related
information to the IMS-AGW (ATGW) or omit media when adding the IP termination
at this stage.
NOTE : The signalling of media related information to a MGW requires that it
reserve the indicated resources before returning a positive response to the
H.248 command, by omitting media related information the IMS-AGW (ATGW) does
not need to reserve any associated resources at this stage.
\- When the IMS-ALG (ATCF) receives the SDP answer from the terminating user,
the IMS-ALG (ATCF) shall configure the IMS-AGW (ATGW) accordingly by either
supplying the same media related information for all interconnected
terminations or by omitting the media related information.
Figure 6.2.14.3.1: PS session establishment with media anchoring in IMS-AGW
(ATGW)
1\. The IMS-ALG (ATCF) receives an SDP offer in SIP signalling. The IMS-ALG
(ATCF) requires an IMS-AGW (ATGW) for media anchoring (or for another IMS-AGW
use case) but does not offer transcoding.
2\. The IMS-ALG (ATCF) sends a H.248 ADD request command to create the
outgoing termination and to request IP resources to execute ATGW function. As
no media transcoding is required this may be indicated by signalling \"-\".
Alternatively any codec (e.g. Codec 1) can be signalled. If the IMS-ALG (ATCF)
selects an IMS-AGW (ATGW) that does not support transcoding, the IMS-ALG
(ATCF) may signal media related sub-fields in the media descriptor to the IMS-
AGW (ATGW) if the IMS-AGW (ATGW) supports media encoding. The IMS-AGW (ATGW)
shall accept the ADD request even though it cannot reserve any transcoding
resources for the indicated media.
3\. The IMS-AGW (ATGW) creates the outgoing termination.
4\. The IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 ADD reply
command and provides the local address and port of the outgoing termination.
5\. The IMS-ALG (ATCF) replaces the IP address inside the SDP using the
information coming from IMS-AGW (ATGW).
6\. The IMS-ALG (ATCF) forwards the new offer to the succeeding node.
7\. The SDP answer is received by IMS-ALG (ATCF). In this example the codec1
received in the original SDP offer in step1 has been selected.
8\. The IMS-ALG (ATCF) sends a H.248 MOD request command to configure the
outgoing termination with address and port information. As no media
transcoding is needed this may be indicated by signalling \"-\" .Alternatively
the selected codec (Codec 1) can be signalled.
9\. The IMS-AGW (ATGW) configures the outgoing termination.
10\. The IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 MOD reply
command.
11\. The IMS-ALG (ATCF) sends a H.248 ADD command to create the incoming
termination to configure this termination with remote address and port
information and to request resources to execute ATGW function. As no media
transcoding is needed this may be indicated by signalling \"-\" .Alternatively
media related sub-fields in the media descriptor for the codec indicated to
the incoming termination may be signalled (e.g. the selected codec received in
step 7 (Codec 1).
12\. The IMS-AGW (ATGW) creates the incoming termination.
13\. The IMS-AGW (ATGW) replies to the IMS-ALG (ATCF) with a H.248 ADD reply
command and provides the local address and port of the incoming termination.
14\. The IMS-ALG (ATCF) replaces the IP address inside the SDP answer using
the information coming from IMS-AGW (ATGW).
15\. SDP answer is sent to the network at the incoming side.
Similar principles shall apply during the establishment of a mobile
terminating session.
#### 6.2.14.4 PS to CS Access Transfer procedure with media anchored in IMS-
AGW (ATGW)
The signalling flow shown in figure 6.2.14.4.1 gives an example for PS to CS
access transfer with media anchored in the IMS-AGW (ATGW). In this case, the
media has been anchored in IMS-AGW (ATGW) as specified in clause 6.2.14.3.
1\. The IMS-ALG (ATCF) receives an SDP offer in SIP signalling from the MSC
Server. The IMS-ALG (ATCF) checks whether transcoding is required.2. The IMS-
ALG (ATCF) sends a H.248 ADD request command to create the target access leg
termination and to request IP resources to execute ATGW function. Topology is
changed and media reconfigured to connect media between T2 and T3.\ If no
media transcoding is required this may be indicated by signalling \"-\" or by
signalling the same media information on T3 as is configured on T2, following
the principles specified in clause 6.2.14.3.\ If media transcoding is required
(as illustrated in this example), the IMS-ALG (ATCF) signals media related
sub-fields in the media descriptor to the IMS-AGW (ATGW). The IMS-AGW (ATGW)
determines from the media configuration whether transcoding is required on a
stream between two terminations between which data flow is permitted.
3\. The IMS-AGW (ATGW) creates the target access leg termination T3 and starts
to apply transcoding between T2 and T3 (if required).
4\. The IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 ADD reply
command and provides the local address and port of the outgoing termination.
5\. The IMS-ALG (ATCF) returns an SDP answer to the MSC Server; the IP address
inside the SDP uses the information coming from IMS-AGW (ATGW).
6\. Upon successful completion of the access transfer procedure, the IMS-ALG
(ATCF) receives a BYE request from the SCC AS if there is no more media flows
on the PS access.
7\. The IMS-ALG (ATCF) sends a H.248 SUB request command to subtract the
source access leg termination.
8\. The IMS-AGW (ATGW) releases the source access leg termination.
9\. The IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 SUB reply
command.
Figure 6.2.14.4.1: PS to CS Access Transfer with transcoding in IMS-AGW (ATGW)
#### 6.2.14.5 ECN support during PS to CS Access Transfer procedure with media
anchored in IMS-AGW (ATGW)
The signalling flow shown in figure 6.2.14.4.1 gives an example for PS to CS
access transfer with media anchored in the IMS-AGW (ATGW). The following
additional actions are required if ECN is supported by the IMS-ALG/IMS-AGW:
1.
a) If ECN was supported during the PS session transparently and the SDP offer
received from the MSC Server does not indicate ECN support, it is not possible
to maintain transparent ECN support to the IMS CN. The IMS-ALG (ATCF) shall
modify the Termination T2 to act as an ECN endpoint toward the IMS CN (see
Clause 5.12). Additionally the IMS-ALG (ATCF) shall disable ECN on the
termination T3 (or T1).
b) If ECN was supported during the PS session transparently and the SDP offer
received from the MSC Server does indicate ECN support and no transcoding is
required (codec types and modes are aligned between ICS side and IMS CN), then
the IMS-ALG (ATCF) shall request ECN transparent properties when seizing T3
and respond to the MSC Server with ECN supported in the SDP answer (step 5).
c) If ECN was supported during the PS session transparently and the SDP offer
received from the MSC Server does indicate ECN support and transcoding is
required between the CS leg and the IMS-CN, then the IMS-ALG (ATCF) shall
request ECN endpoint properties when seizing T3 (or modify the termination T1
with ECN endpoint properties) and respond to the MSC Server with ECN supported
in the SDP answer (step 5). Additionally the IMS-ALG (ATCF) shall modify the
Termination T2 to act as an ECN endpoint toward the IMS CN (see Clause 5.12).
d) If ECN was not supported during the PS session and the SDP Offer received
from the MSC Server indicates ECN support, the IMS-ALG (ATCF) shall not accept
ECN support in the SDP answer (step 5).
#### 6.2.14.6 Support of generic image attributes
##### 6.2.14.6.1 General
The IMS-ALG (ATCF) and the IMS-AGW (ATGW) may support a media-level SDP image
attribute \"a=imageattr\" defined in IETF RFC 6236 [24] to negotiate the image
size for sending and receiving video.
The list of image sizes per payload type supported by the IMS-AGW (ATGW) shall
be preconfigured in the IMS-ALG (ATCF). If the image sizes received within an
SDP body on the Mw/Mx interface are not all supported by the IMS-AGW (ATGW)
then the IMS-ALG (ATCF) shall only send the list of corresponding IMS-AGW
(ATGW) supported image sizes to the IMS-AGW (ATGW). If no image size is
supported by the IMS-AGW (ATGW), the IMS-ALG (ATCF) shall not send the generic
image attribute parameter to the IMS-AGW (ATGW).
The signalling flow shown in figure 6.2.14.3.1 gives an example for a PS
session establishment with media anchored in the IMS-AGW (ATGW). The following
additional actions may be performed if the negotiation of the image size is
supported by the IMS-ALG/IMS-AGW:
a) upon receipt of an SDP offer containing the image attribute(s) and if the
received image sizes are supported by the IMS-AGW (ATGW) then the IMS-ALG
(ATCF) may send the generic image attribute parameters for the send and
receive directions to the IMS-ALG (ATCF) (step 2 or step 8) when seizing or
modifying an outgoing termination;
NOTE 1: If the offered image attributes are not supported by the IMS-AGW
(ATGW) then the IMS-ALG (ATCF) will not send the generic image attribute
parameter to the IMS-AGW (ATGW).
b) the IMS-ALG (ATCF) shall include the SDP image attribute(s) \"a=imageattr\"
indicating the supported image sizes in the modified SDP offer (step 5);
c) upon receipt of an SDP answer containing the generic image attribute(s) and
if the received image sizes are supported by the IMS-AGW (ATGW) then the IMS-
ALG (ATCF) may include the generic image attribute parameter to the IMS-AGW
(ATGW) (step 11) when seizing an incoming termination; and
d) the IMS-ALG (ATCF) shall include the SDP image attribute(s) \"a=imageattr\"
indicating the supported image sizes in the modified SDP answer (step 14).
NOTE 2: The IMS-ALG (ATCF) not supporting the negotiation of generic image
attributes will ignore the SDP image attribute received in the SDP offer and
will send the SDP offer/answer without any associated SDP image attribute.
When sending the SDP body with image attribute(s) on the Mw/Mx interface the
IMS-ALG (ATCF) shall include in the \"a=imageattr\":
\- \"recv\" keyword and corresponding image sizes which the IMS-AGW (ATGW)
supports in the receiving direction; and
\- \"send\" keyword and corresponding image sizes which the IMS-AGW (ATGW)
supports in the sending direction.
The signalling flow shown in figure 6.2.14.4.1 gives an example for PS to CS
access transfer with media anchored in the IMS-AGW (ATGW). The following
additional actions may be performed if the negotiation of the image size is
supported by the IMS-ALG/IMS-AGW:
a) if the image sizes were negotiated during the PS session and if the IMS-AGW
(ATGW) applies the video transcoding (step 3) and if the IMS-AGW (ATGW) is
configured with different image sizes on the receive direction of one
termination and the send direction of another interconnected termination, then
it shall adjust the frame sizes accordingly when forwarding video media
streams and use the image size as described in 3GPP TS 26.114 [21] when
sending media.
NOTE 3: The relation between the negotiated image sizes and CVO are specified
in 3GPP TS 26.114 [21].
NOTE 4: The generic image attribute includes information related to the send
and receive capabilities of a single termination, and the adjustment of image
sizes is typically based on the setting of two connected terminations in a
single context.
##### 6.2.14.6.2 Indication of generic image attributes
The IMS-ALG (ATCF) may include the generic image attributes to the IMS-AGW
(ATGW). The example sequence is shown in figure 6.2.14.6.2.1.
Figure 6.2.14.6.2.1: Request to reserve AGW connection point with generic
image attribute
#### 6.2.14.7 Handling of common codec parameters
For PS session origination, figure 6.2.14.3.1 shall apply with the handling of
codec related parameters applicable to multiple codecs in table 6.2.14.7.1,
assuming that codec related information is signalled to the IMS-AGW(ATGW) at
this stage. If no codec related information is signalled to the IMS-AGW at
this stage, the common codec related parameters for the termination towards
the SDP answerer in table 6.2.14.7.1 shall be signalled towards the IMS-AGW
during a PS to CS Access Transfer procedure.
Table 6.2.14.7.1: IMS-ALG handling of common codec related SDP parameters
during PS session origination.
+----------------------+----------------------+----------------------+ | Parameter | Handling in SDP | Handling in the SDP | | | offer | answer | +----------------------+----------------------+----------------------+ | ptime (NOTE) | If the ptime | If the ptime | | | parameter is | parameter is | | | included in the | included in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG shall | the IMS-ALG shall | | | supply the parameter | supply the parameter | | | to the IMS-AGW for | to the IMS-AGW for | | | the termination | the termination | | | towards the offerer | towards the answerer | | | in the remote | in the remote | | | descriptor. | descriptor. | | | | | | | If the value is | If the value is | | | supported by the | supported by the | | | IMS-AGW for | IMS-AGW for | | | receiving media, the | receiving media, the | | | IMS-ALG should keep | IMS-ALG should keep | | | the value from the | the value from the | | | received SDP offer | received SDP answer | | | unchanged in the SDP | unchanged in the SDP | | | offer it sends. If | answer it sends. If | | | the IMS-AGW only | the IMS-AGW only | | | supports a lower | supports a lower | | | ptime value, the | ptime value, the | | | IMS-ALG shall supply | IMS-ALG shall supply | | | the ptime value | the ptime value | | | according to | according to | | | configured | configured | | | preferences in the | preferences in the | | | SDP offer it | SDP answer it | | | forwards. If no | forwards. If no | | | ptime value was | ptime value was | | | contained in the | contained in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG may add | the IMS-ALG may add | | | the parameter with a | the parameter with a | | | value according to | value according to | | | configured | configured | | | preferences to the | preferences to the | | | SDP offer. | SDP answer. | +----------------------+----------------------+----------------------+ | maxptime (NOTE) | If the maxptime | If the maxptime | | | parameter is | parameter is | | | included in the | included in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG shall | the IMS-ALG shall | | | supply the parameter | supply the parameter | | | to the IMS-AGW for | to the IMS-AGW for | | | the termination | the termination | | | towards the offerer | towards the answerer | | | in the remote | in the remote | | | descriptor. | descriptor. | | | | | | | If the value is | If the value is | | | supported by the | supported by the | | | IMS-AGW for | IMS-AGW for | | | receiving media, the | receiving media, the | | | IMS-ALG should keep | IMS-ALG should keep | | | the value from the | the value from the | | | received SDP offer | received SDP answer | | | unchanged in the SDP | unchanged in the SDP | | | offer it sends. If | answer it sends. If | | | the IMS-AGW only | the IMS-AGW only | | | supports a lower | supports a lower | | | maxptime value, the | maxptime value, the | | | IMS-ALG shall supply | IMS-ALG shall supply | | | the maxptime value | the maxptime value | | | according to the | according to the | | | IMS-AGW capabilities | IMS-AGW capabilities | | | in the SDP offer it | in the SDP answer it | | | forwards. If no | forwards. If no | | | maxptime value was | maxptime value was | | | contained in the | contained in the | | | received SDP offer, | received SDP answer, | | | the IMS-ALG may add | the IMS-ALG may add | | | the parameter with a | the parameter with a | | | value according to | value according to | | | the IMS-AGW | the IMS-AGW | | | capabilities to the | capabilities to the | | | SDP offer. | SDP answer. | +----------------------+----------------------+----------------------+ | NOTE: This SDP | | | | attribute is defined | | | | in | | | | I | | | | ETF RFC 4566 [53]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | +----------------------+----------------------+----------------------+
For PS to CS Access Transfer, figure 6.2.14.4.1 shall apply with the handling
of codec related parameters applicable to multiple codecs in in table
6.2.14.A.2.
Table 6.2.14.7.2: IMS-ALG handling of common codec related SDP parameters
during PS to CS Access Transfer.
* * *
Parameter Handling of common codec parameters received in the SDP offer Common
Codec parameters supplied in the SDP answer ptime (NOTE) If the ptime
parameter is included in the received SDP offer, the IMS-ALG shall supply the
parameter to the IMS-AGW for the termination towards the offerer in the remote
descriptor. The IMS-ALG may add the parameter with a value according to
configured preferences to the SDP answer. maxptime (NOTE) If the maxptime
parameter is included in the received SDP offer, the IMS-ALG shall supply the
parameter to the IMS-AGW for the termination towards the offerer in the remote
descriptor. The IMS-ALG may add the parameter with a value according to the
IMS-AGW capabilities to the SDP answer. NOTE: This SDP attribute is defined in
IETF RFC 4566 [53]. It applies to all codecs offered in an SDP media line.
* * *
#### 6.2.14.8 EVS speech codec support
For PS session origination, figure 6.2.14.3.1 shall apply with the EVS
parameter handling in table 6.2.14.8.1, assuming that EVS is \"codec 1\",
which is selected, and that \"codec 1\" related information is signalled to
the IMS-AGW(ATGW) at this stage. If no codec related information is signalled
to the IMS-AGW at this stage, the EVS related parameters for the termination
towards the SDP answerer in table 6.2.14.8.1 shall be signalled towards the
IMS-AGW during a PS to CS Access Transfer procedure.
Table 6.2.14.8.1: IMS-ALG handling of EVS related SDP parameters during PS
session origination.
+----------------------+----------------------+----------------------+ | Parameter | Handling for EVS | Handling if offered | | | payload type in SDP | EVS payload type is | | | offer | accepted in the SDP | | | | answer | +----------------------+----------------------+----------------------+ | evs-mode-switch | If the | If the | | (NOTE 1) | evs-mode-switch | evs-mode-switch | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW for the | | | remote descriptor | termination towards | | | for the termination | the answerer in the | | | towards the SDP | remote descriptor, | | | offerer and shall | and the IMS-ALG | | | retain the parameter | shall retain this | | | in the SDP offer it | parameter in the SDP | | | forwards. | answer it forwards. | +----------------------+----------------------+----------------------+ | hf-only (NOTE 1) | If the n hf-only | If the hf-only | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW in the | | | remote descriptor | remote descriptor | | | for the termination | for the termination | | | towards the SDP | towards the | | | offerer and shall | answerer, and the | | | retain the parameter | IMS-ALG shall retain | | | in the SDP offer it | this parameter in | | | forwards. | the SDP answer it | | | | forwards. | | | Otherwise, if the | | | | IMS-ALG is | | | | configured to | | | | negotiate using only | | | | the header-full EVS | | | | RTP payload format, | | | | the IMS-ALG shall | | | | provide the hf-only | | | | parameter with a | | | | value 1 to the | | | | IMS-AGW in the | | | | remote descriptor | | | | for the termination | | | | towards the SDP | | | | offerer, and within | | | | the SDP offer it | | | | forwards. | | +----------------------+----------------------+----------------------+ | dtx (NOTE 1) | If the dtx parameter | If the dtx parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP answer, the | | | IMS-ALG shall | IMS-ALG shall | | | forward this | forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW in the | | | remote descriptor | remote descriptor | | | for the termination | for the termination | | | towards the SDP | towards the | | | offerer and shall | answerer, and the | | | retain the parameter | IMS-ALG shall retain | | | in the SDP offer it | this parameter in | | | forwards. | the SDP answer it | | | | forwards. | | | Otherwise, if the | | | | dtx-recv parameter | | | | is contained in the | | | | SDP offer, the | | | | IMS-ALG may include | | | | the dtx parameter in | | | | the SDP offer it | | | | forwards with the | | | | same value as the | | | | dtx-recv parameter | | | | in the SDP offer. | | | | | | | | Otherwise, if the | | | | usage of DTX is not | | | | desired in the | | | | sending and | | | | receiving direction, | | | | the IMS-ALG shall | | | | include the dtx | | | | parameter with a | | | | value 0 to the | | | | IMS-AGW in the | | | | remote descriptor | | | | for the termination | | | | towards the SDP | | | | offerer, and within | | | | the SDP offer it | | | | forwards. | | +----------------------+----------------------+----------------------+ | dtx-recv (NOTE 1) | If the dtx-recv | If the dtx-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW in the | | | remote descriptor | remote descriptor | | | for the termination | for the termination | | | towards the SDP | towards the | | | offerer and shall | answerer, and the | | | retain the parameter | IMS-ALG shall retain | | | in the SDP offer it | this parameter in | | | forwards. | the SDP answer it | | | | forwards. | | | Otherwise, if the | | | | reception of DTX is | | | | not desired and the | | | | dtx parameter is not | | | | included in the | | | | forwarded SDP offer, | | | | the IMS-ALG shall | | | | include the dtx-recv | | | | parameter with a | | | | value 0 to the | | | | IMS-AGW in the | | | | remote descriptor | | | | for the termination | | | | towards the SDP | | | | offerer, and within | | | | the SDP offer it | | | | forwards. | | | | | | | | If both the dtx and | | | | dtx-recv parameters | | | | are included, those | | | | parameters shall | | | | have the same value; | | | | however, inclusion | | | | of the dtx-recv | | | | parameter is not | | | | required if the dtx | | | | parameter is | | | | included. | | +----------------------+----------------------+----------------------+ | **br** (NOTE 1) | If the br parameter | If the br parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP answer, the | | | IMS-ALG shall check | IMS-ALG shall | | | if the IMS-AGW | forward this | | | supports the | parameter to the | | | indicated bitrates, | IMS-AGW in the | | | or a subset of them, | remote descriptor | | | in EVS primary mode | for the termination | | | in the send and | towards the | | | receive direction. | answerer, and the | | | If the indicated | IMS-ALG shall retain | | | bitrates, and even | this parameter in | | | each subset of them, | the SDP answer it | | | are not supported, | forwards. | | | the IMS-ALG should | | | | remove the EVS | | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, If the br | | | | parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall select a | | | | bitrate value, which | | | | is either the | | | | received br value or | | | | a subset of it, | | | | based on IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, and shall | | | | include that br | | | | parameter with the | | | | selected value in | | | | the SDP offer if | | | | forwards. | | | | | | | | Otherwise, if the | | | | IMS-ALG desires the | | | | same bit rate range | | | | for the send and | | | | receive direction in | | | | EVS primary mode, | | | | and wants to | | | | restrict the bit | | | | rate range to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br parameter in the | | | | SDP offer it sends. | | | | | | | | If the IMS-ALG also | | | | supplies the bw, | | | | bw-send or bw-recv | | | | parameter, the value | | | | of the br parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br | | | | parameter in the SDP | | | | offer if forwards, | | | | it shall also supply | | | | to the IMS-AGW the | | | | br parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | | +----------------------+----------------------+----------------------+ | br-send (NOTE 1) | If the br-send | If the br-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated bitrates, | IMS-AGW in the | | | or a subset of them, | remote descriptor | | | in EVS primary mode | for the termination | | | in the send and | towards the | | | receive direction. | answerer, and the | | | If the indicated | IMS-ALG shall retain | | | bitrates, and even | this parameter in | | | each subset of them, | the SDP answer it | | | are not supported, | forwards. | | | the IMS-ALG should | | | | remove the EVS | | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, If the | | | | br-send parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall select a | | | | bitrate value, which | | | | is either the | | | | received br-send | | | | value or a subset of | | | | it, based on IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, and shall | | | | include that br-send | | | | parameter with the | | | | selected value in | | | | the SDP offer if | | | | forwards. | | | | | | | | Otherwise, if the | | | | IMS-ALG desires a | | | | different bit rate | | | | (range) for the send | | | | and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the bit rate range | | | | for the send | | | | direction towards | | | | the offerer to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-send parameter in | | | | the SDP offer it | | | | sends. Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-send parameter, | | | | the value of the | | | | br-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br-send | | | | parameter in the SDP | | | | offer if forwards, | | | | it shall also supply | | | | to the IMS-AGW the | | | | br-send parameter in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | | +----------------------+----------------------+----------------------+ | br-recv (NOTE 1) | If the br-recv | If the br-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated bitrates, | IMS-AGW in the | | | or a subset of them, | remote descriptor | | | in EVS primary mode | for the termination | | | in the send and | towards the | | | receive direction. | answerer, and the | | | If the indicated | IMS-ALG shall retain | | | bitrates, and even | this parameter in | | | each subset of them, | the SDP answer it | | | are not supported, | forwards. | | | the IMS-ALG should | | | | remove the EVS | | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, If the | | | | br-recv parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall select a | | | | bitrate value, which | | | | is either the | | | | received br-recv | | | | value or a subset of | | | | it, based on IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, and shall | | | | include that br-recv | | | | parameter with the | | | | selected value in | | | | the SDP offer if | | | | forwards. | | | | | | | | Otherwise, if the | | | | IMS-ALG desires a | | | | different bit rate | | | | (range) for the send | | | | and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the bit rate range | | | | for the recv | | | | direction towards | | | | the offerer to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-recv parameter in | | | | the SDP offer it | | | | sends. Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-recv parameter, | | | | the value of the | | | | br-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br-recv | | | | parameter in the SDP | | | | offer if forwards, | | | | it shall also supply | | | | to the IMS-AGW the | | | | br-recv parameter in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | | +----------------------+----------------------+----------------------+ | bw (NOTE 1) | If the bw parameter | If the bw parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP answer, the | | | IMS-ALG shall check | IMS-ALG shall | | | if the IMS-AGW | forward this | | | supports the | parameter to the | | | indicated sampling | IMS-AGW in the | | | bandwidth(s), or a | remote descriptor | | | subset of them, in | for the termination | | | EVS primary mode in | towards the | | | the send and receive | answerer, and the | | | direction. If the | IMS-ALG shall retain | | | indicated sampling | this parameter in | | | bandwidth(s), and | the SDP answer it | | | even each subset of | forwards. | | | them, are not | | | | supported, the | | | | IMS-ALG should | | | | remove the EVS | | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, If the bw | | | | parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall select a | | | | bitrate value, which | | | | is either the | | | | received bw value or | | | | a subset of it, | | | | based on IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, and shall | | | | include that bw | | | | parameter with the | | | | selected value in | | | | the SDP offer if | | | | forwards. | | | | | | | | Otherwise, if the | | | | IMS-ALG desires the | | | | same sampling | | | | bandwidth(s) for the | | | | send and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the sampling | | | | bandwidth(s) to | | | | match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the bw | | | | parameter in the SDP | | | | offer it sends. | | | | | | | | If the IMS-ALG also | | | | supplies the br, | | | | br-send or br-recv | | | | parameter, the value | | | | of the bw parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw | | | | parameter in the SDP | | | | offer if forwards, | | | | it shall also supply | | | | to the IMS-AGW the | | | | bw parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | | +----------------------+----------------------+----------------------+ | bw-send (NOTE 1) | If the bw-send | If the bw-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated sampling | IMS-AGW in the | | | bandwidth(s), or a | remote descriptor | | | subset of them, in | for the termination | | | EVS primary mode in | towards the | | | the send and receive | answerer, and the | | | direction. If the | IMS-ALG shall retain | | | indicated bitrates, | this parameter in | | | and even each subset | the SDP answer it | | | of them, are not | forwards. | | | supported, the | | | | IMS-ALG should | | | | remove the EVS | | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, If the | | | | bw-send parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall select a | | | | sampling bandwidth | | | | value, which is | | | | either the received | | | | bw-send value or a | | | | subset of it, based | | | | on IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, and shall | | | | include that bw-send | | | | parameter with the | | | | selected value in | | | | the SDP offer if | | | | forwards. | | | | | | | | Otherwise, if the | | | | IMS-ALG desires | | | | different sampling | | | | bandwidth(s) for the | | | | send and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the sampling | | | | bandwidth(s) for the | | | | send direction | | | | towards the offerer | | | | to match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the bw-send | | | | parameter in the SDP | | | | offer it sends. | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the br or | | | | br-send parameter, | | | | the value of the | | | | bw-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw-send | | | | parameter in the SDP | | | | offer if forwards, | | | | it shall also supply | | | | to the IMS-AGW the | | | | bw-send parameter in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | | +----------------------+----------------------+----------------------+ | bw-recv (NOTE 1) | If the bw-recv | If the bw-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated sampling | IMS-AGW in the | | | bandwidth(s), or a | remote descriptor | | | subset of them, in | for the termination | | | EVS primary mode in | towards the | | | the send and receive | answerer, and the | | | direction. If the | IMS-ALG shall retain | | | indicated sampling | this parameter in | | | bandwidth(s), and | the SDP answer it | | | even each subset of | forwards. | | | them, are not | | | | supported, the | | | | IMS-ALG should | | | | remove the EVS | | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, If the | | | | bw-recv parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall select a | | | | sampling | | | | bandwidth(s) value, | | | | which is either the | | | | received bw-recv | | | | value or a subset of | | | | it, based on IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, and shall | | | | include that bw-recv | | | | parameter with the | | | | selected value in | | | | the SDP offer if | | | | forwards. | | | | | | | | Otherwise, if the | | | | IMS-ALG desires | | | | different sampling | | | | bandwidth(s) for the | | | | send and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the sampling | | | | bandwidth(s) for the | | | | recv direction | | | | towards the offerer | | | | to match IMS-AGW | | | | capabilities and | | | | possible configured | | | | policies, it shall | | | | supply the bw-recv | | | | parameter in the SDP | | | | offer it sends. | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | offer. | | | | | | | | If the IMS-ALG also | | | | supplies the br or | | | | br-recv parameter, | | | | the value of the | | | | bw-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw-recv | | | | parameter in the SDP | | | | offer if forwards, | | | | it shall also supply | | | | to the IMS-AGW the | | | | bw-recv parameter in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | | +----------------------+----------------------+----------------------+ | cmr (NOTE 1) | If the cmr parameter | If the cmr parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP answer, the | | | IMS-ALG shall | IMS-ALG shall | | | forward this | forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW in the | | | remote descriptor | remote descriptor | | | for the termination | for the termination | | | towards the SDP | towards the | | | offerer and shall | answerer, and the | | | retain the parameter | IMS-ALG shall retain | | | in the SDP offer it | this parameter in | | | forwards. | the SDP answer it | | | | forwards. | | | Otherwise, if the | | | | IMS-ALG desires to | | | | dissable codec mode | | | | requests within the | | | | RTP payload of the | | | | EVS primary mode | | | | (due to the IMS-AGW | | | | capabilities or | | | | policies), it shall | | | | include the cmr | | | | parameter with value | | | | -1 to the IMS-AGW in | | | | the remote | | | | descriptor for the | | | | termination towards | | | | the SDP offerer, and | | | | within the SDP offer | | | | it forwards. | | +----------------------+----------------------+----------------------+ | ch-aw-recv (NOTE 1) | If the ch-aw-recv | If the ch-aw-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated mode in | IMS-AGW in the | | | the send direction. | remote descriptor | | | If the indicated | for the termination | | | mode is not | towards the | | | supported, the | answerer, and the | | | IMS-ALG shall remove | IMS-ALG shall retain | | | the payload type | this parameter in | | | from the SDP offer. | the SDP answer it | | | If the IMS-AGW | forwards. | | | supports the | | | | indicated mode in | | | | the send direction | | | | for transcoding, the | | | | IMS-ALG shall | | | | forward this | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor, | | | | and shall include | | | | the unmodified | | | | parameter within the | | | | SDP offer it | | | | forwards. Otherwise, | | | | if the IMS-ALG | | | | desires to disable | | | | partial redundancy | | | | mode, it shall | | | | include the | | | | ch-aw-send parameter | | | | with value -1 in the | | | | SDP offer it | | | | forwards. | | +----------------------+----------------------+----------------------+ | number of channels | If the \"number of | If the \"number of | | (NOTE 2) | channels\" parameter | channels\" parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP answer, the | | | IMS-ALG shall check | IMS-ALG shall | | | if the IMS-AGW | forward this | | | supports the | parameter to the | | | indicated number of | IMS-AGW in the | | | channels. If the | remote descriptor | | | indicated number of | for the termination | | | channels is not | towards the | | | supported, the | answerer, and the | | | IMS-ALG should | IMS-ALG shall retain | | | remove the EVS | this parameter in | | | payload from the SDP | the SDP answer it | | | offer. | forwards. | | | | | | | Otherwise, if the | | | | \"number of | | | | channels\" parameter | | | | is contained in the | | | | SDP offer, the | | | | IMS-ALG shall | | | | forward this | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor | | | | and shall retain the | | | | parameter in the SDP | | | | offer it forwards. | | +----------------------+----------------------+----------------------+ | ch-send (NOTE 1) | If the ch-send | If the ch-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated number of | IMS-AGW in the | | | channels in the send | remote descriptor | | | and receive | for the termination | | | direction. If the | towards the | | | indicated number of | answerer, and the | | | channels is not | IMS-ALG shall retain | | | supported, the | this parameter in | | | IMS-ALG should | the SDP answer it | | | remove the EVS | forwards. | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, if the | | | | ch-send parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall forward this | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor | | | | and shall retain the | | | | parameter in the SDP | | | | offer it forwards. | | +----------------------+----------------------+----------------------+ | ch-recv (NOTE 1) | If the ch-recv | If the ch-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall check if the | shall forward this | | | IMS-AGW supports the | parameter to the | | | indicated number of | IMS-AGW in the | | | channels in the send | remote descriptor | | | and receive | for the termination | | | direction. If the | towards the | | | indicated number of | answerer, and the | | | channels is not | IMS-ALG shall retain | | | supported, the | this parameter in | | | IMS-ALG should | the SDP answer it | | | remove the EVS | forwards. | | | payload from the SDP | | | | offer. | | | | | | | | Otherwise, if the | | | | ch-recv parameter is | | | | contained in the SDP | | | | offer, the IMS-ALG | | | | shall forward this | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor | | | | and shall retain the | | | | parameter in the SDP | | | | offer it forwards. | | +----------------------+----------------------+----------------------+ | mode-set (NOTE 3) | If the mode-set | If the mode-set | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW for the | | | remote descriptor | termination towards | | | for the termination | the answerer in the | | | towards the SDP | remote descriptor, | | | offerer and shall | and the IMS-ALG | | | retain the parameter | shall retain this | | | in the SDP offer it | parameter in the SDP | | | forwards. | answer it forwards. | +----------------------+----------------------+----------------------+ | mode-change-period | If the | If the | | (NOTE 3) | mode-change-period | mode-change-period | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW for the | | | remote descriptor | termination towards | | | for the termination | the answerer in the | | | towards the SDP | remote descriptor, | | | offerer and shall | and the IMS-ALG | | | retain the parameter | shall retain this | | | in the SDP offer it | parameter in the SDP | | | forwards. | answer it forwards. | +----------------------+----------------------+----------------------+ | mo | If the | If the | | de-change-capability | mo | mo | | (NOTE 3) | de-change-capability | de-change-capability | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | may forward this | may forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW for the | | | remote descriptor | termination towards | | | for the termination | the answerer in the | | | towards the SDP | remote descriptor, | | | offerer and shall | and the IMS-ALG | | | retain the parameter | shall retain this | | | in the SDP offer it | parameter in the SDP | | | forwards. | answer it forwards. | +----------------------+----------------------+----------------------+ | mode-change-neighbor | If the | If the | | (NOTE 3) | mode-change-neighbor | mode-change-neighbor | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW for the | | | remote descriptor | termination towards | | | for the termination | the answerer in the | | | towards the SDP | remote descriptor, | | | offerer and shall | and the IMS-ALG | | | retain the parameter | shall retain this | | | in the SDP offer it | parameter in the SDP | | | forwards. | answer it forwards. | +----------------------+----------------------+----------------------+ | max-red (NOTE 5) | If the max-red | If the max-red | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | answer, the IMS-ALG | | | shall forward this | shall forward this | | | parameter to the | parameter to the | | | IMS-AGW in the | IMS-AGW for the | | | remote descriptor | termination towards | | | for the termination | the answerer in the | | | towards the SDP | remote descriptor, | | | offerer and shall | and the IMS-ALG | | | retain the parameter | shall retain this | | | in the SDP offer it | parameter in the SDP | | | forwards with a | answer it forwards | | | value that considers | with a value that | | | the received value | considers the | | | and the capabilities | received value and | | | of the IMS-AGW. | the capabilities of | | | | the IMS-AGW. | +----------------------+----------------------+----------------------+ | 3g | If the IMS-AGW | If the | | pp_mtsi_app_adapt | supports RTCP APP | 3g | | (NOTE 4) | based adaptation | pp_mtsi_app_adapt | | | messages defined in | parameter is | | | 3G | contained in the SDP | | | PP TS 26.114 [21], | answer, the IMS-ALG | | | and the IMS-ALG has | shall forward this | | | a policy to | parameter to the | | | negotiate the usage | IMS-AGW in the | | | of those messages, | remote descriptor. | | | the IMS-ALG shall | | | | include the | | | | 3g | | | | pp_mtsi_app_adapt | | | | SDP attribute | | | | indicating the | | | | supported APP | | | | messages in the SDP | | | | offer. | | +----------------------+----------------------+----------------------+ | NOTE 1: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | 3G | | | | PP TS 26.445 [51]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 2: This number | | | | of channels are | | | | encoded as | | | | \"encoding | | | | parameters\" of the | | | | SDP \"a=rtpmap\" | | | | attribute defined in | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 3: This MIME | | | | parameter of the EVS | | | | RTP payload type | | | | relates to AMR-WB IO | | | | mode and is defined | | | | in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 4: This SDP | | | | attribute is defined | | | | in | | | | 3G | | | | PP TS 26.114 [21]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | | However, some values | | | | are specific to EVS. | | | | | | | | NOTE 5: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | +----------------------+----------------------+----------------------+
For PS to CS Access Transfer, figure 6.2.14.4.1 shall apply with the EVS
parameter handling in table 6.2.14.8.2, assuming that EVS is \"codec 3\",
which is selected.
Table 6.2.14.8.2: IMS-ALG handling of EVS related SDP parameters during PS to
CS Access Transfer.
+----------------------+----------------------+----------------------+ | Parameter | Handling of EVS | EVS payload type | | | payload type | supplied in the SDP | | | parameter received | answer | | | in the SDP offer | | +----------------------+----------------------+----------------------+ | evs-mode-switch | If the | If the | | (NOTE 1) | evs-mode-switch | evs-mode-switch | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | offer, the IMS-ALG | | | IMS-ALG select the | shall include the | | | EVS payload type for | evs-mode-switch | | | transcoding, the | parameter with | | | IMS-ALG shall | unmodified value in | | | forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if EVS | | | termination towards | was used before the | | | the offerer in the | access transfer, the | | | remote descriptor. | IMS-ALG should | | | | include the | | | | evs-mode-switch | | | | parameter with a | | | | value indicating the | | | | mode that was | | | | negotiated before | | | | the access transfer. | | | | | | | | Otherwise, if the | | | | IMS-ALG decides to | | | | transcode between | | | | AMR-WB and EVS (e.g. | | | | because AMR-WB was | | | | used before the | | | | access transfer), it | | | | shall include the | | | | evs-mode-switch with | | | | value 1. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the | | | | evs-mode-switch. | | | | | | | | If the IMS-ALG | | | | supplies the | | | | evs-mode-switch in | | | | the SDP answer, it | | | | shall also supply it | | | | to the IMS-AGW in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | hf-only (NOTE 1) | If the hf-only | If the hf-only | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | offer, the IMS-ALG | | | IMS-ALG select the | shall include the | | | EVS payload type for | hf-only parameter | | | transcoding, the | with unmodified | | | IMS-ALG shall | value in the SDP | | | forward this | answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-AGW is | | | the offerer in the | configured to | | | remote descriptor. | negotiate using only | | | | the header-full EVS | | | | RTP payload format, | | | | the IMS-ALG shall | | | | include the hf-only | | | | parameter with a | | | | value 1. | | | | | | | | Otherwise, if EVS | | | | was used before the | | | | access transfer, the | | | | IMS-ALG should | | | | include the hf-only | | | | parameter with a | | | | value indicating the | | | | mode that was | | | | negotiated before | | | | the access transfer. | | | | | | | | If the IMS-ALG | | | | supplies the hf-only | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | dtx (NOTE 1) | If the dtx parameter | If the dtx parameter | | | is contained in the | is contained in the | | | SDP offer and the | SDP offer, the | | | IMS-ALG select the | IMS-ALG shall | | | EVS payload type for | include the dtx | | | transcoding, the | parameter with | | | IMS-ALG shall | unmodified value in | | | forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | dtx-recv parameter | | | the offerer in the | is contained in the | | | remote descriptor. | SDP offer, the | | | | IMS-ALG may include | | | | the dtx parameter in | | | | the SDP answer with | | | | the same value as | | | | the dtx-recv | | | | parameter in the SDP | | | | offer. | | | | | | | | Otherwise, if the | | | | usage of DTX is not | | | | desired (e.g. due to | | | | DTX capabilities of | | | | expected codecs to | | | | transcode with), the | | | | IMS-ALG shall | | | | include the dtx | | | | parameter with a | | | | value 0. | | | | | | | | Otherwise, if EVS | | | | was used before the | | | | access transfer, the | | | | IMS-ALG should | | | | include the dtx | | | | parameter with a | | | | value indicating the | | | | mode that was | | | | negotiated before | | | | the access transfer. | | | | | | | | If the IMS-ALG | | | | supplies the dtx | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | dtx-recv (NOTE 1) | If the dtx-recv | If the reception of | | | parameter is | DTX is not desired | | | contained in the SDP | and the dtx | | | offer and the | parameter is not | | | IMS-ALG select the | included, the | | | EVS payload type for | IMS-ALG shall | | | transcoding, the | include the dtx-recv | | | IMS-ALG shall | parameter with a | | | forward this | value 0. | | | parameter to the | | | | IMS-AGW for the | If both the dtx and | | | termination towards | dtx-recv parameters | | | the offerer in the | are included, those | | | remote descriptor. | parameters shall | | | | have the same value; | | | | however, inclusion | | | | of the dtx-recv | | | | parameter is not | | | | required if the dtx | | | | parameter is | | | | included. | | | | | | | | If the IMS-ALG | | | | supplies the | | | | dtx-recv parameter | | | | in the SDP answer, | | | | it should also | | | | supply it to the | | | | IMS-AGW in the local | | | | descriptor for the | | | | termination towards | | | | the offerer with the | | | | same value. | +----------------------+----------------------+----------------------+ | **br** (NOTE 1) | If the br parameter | If the br parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP offer, the | | | IMS-ALG shall check | IMS-ALG shall select | | | if the IMS-AGW | a bitrate value, | | | supports the | which is either the | | | indicated bitrates, | received br value or | | | or a subset of them, | a subset of it, | | | in EVS primary mode | based on IMS-AGW | | | in the send and | capabilities, | | | receive direction. | possible configured | | | If the indicated | policies, and the | | | bitrates, and even | negotiated br range | | | each subset of them, | of an EVS codec used | | | are not supported, | before the access | | | the IMS-ALG shall | transfer, and shall | | | not select the EVS | include the br | | | payload type for | parameter with the | | | transcoding. If the | selected value that | | | IMS-ALG selects the | is also supplied | | | EVS payload type, it | towards the IMS-AGW | | | shall forward this | in the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-ALG desires the | | | the offerer in the | same bit rate range | | | remote descriptor. | for the send and | | | | receive direction in | | | | EVS primary mode, | | | | and wants to | | | | restrict the bit | | | | rate range to match | | | | IMS-AGW capabilities | | | | possible configured | | | | policies, and the | | | | negotiated br range | | | | of the EVS codec | | | | used before the | | | | access transfer, the | | | | IMS-ALG shall supply | | | | the br parameter in | | | | the SDP answer it | | | | sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw, | | | | bw-send or bw-recv | | | | parameter, the value | | | | of the br parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the br | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | br-send (NOTE 1) | If the br-send | If the br-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | bitrate value, which | | | indicated bitrates, | is either the | | | or a subset of them, | received br-recv | | | in EVS primary mode | value or a subset of | | | in the receive | it, based on IMS-AGW | | | direction. If the | capabilities | | | indicated bitrates, | possible configured | | | and even each subset | policies, and the | | | of them, are not | negotiated br range | | | supported, the | of an EVS codec used | | | IMS-ALG shall not | before the access | | | select the EVS | transfer, and the | | | payload type for | IMS-ALG shall | | | transcoding. If the | include the br-send | | | IMS-ALG selects the | parameter with the | | | EVS payload type, it | selected value that | | | shall forward this | is also supplied | | | parameter to the | towards the IMS-AGW | | | IMS-AGW for the | in the SDP answer. | | | termination towards | | | | the offerer in the | Otherwise, if the | | | remote descriptor. | IMS-ALG desires a | | | | different bit rate | | | | (range) for the send | | | | and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the bit rate range | | | | for the send | | | | direction to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-send parameter in | | | | the SDP answer it | | | | sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the br-send | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-send parameter, | | | | the value of the | | | | br-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br-send | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the br-send | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | br-recv (NOTE 1) | If the br-recv | If the br-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | bitrate value, which | | | indicated bitrates, | is either the | | | or a subset of them, | received br-send | | | in EVS primary mode | value or a subset of | | | in the send | it, based on IMS-AGW | | | direction. If the | capabilities, | | | indicated bitrates, | possible configured | | | and even each subset | policies, and the | | | of them, are not | negotiated br range | | | supported, the | of an EVS codec used | | | IMS-ALG shall not | before the access | | | select the EVS | transfer, and the | | | payload type for | IMS-ALG shall | | | transcoding. If the | include the br-recv | | | IMS-ALG selects the | parameter with the | | | EVS payload type, it | selected value that | | | shall forward this | is also supplied | | | parameter to the | towards the IMS-AGW | | | IMS-AGW for the | in the SDP answer. | | | termination towards | | | | the offerer in the | Otherwise, if the | | | remote descriptor. | IMS-ALG desires a | | | | different bit rate | | | | (range) for the send | | | | and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the bit rate range | | | | for the receive | | | | direction to match | | | | IMS-AGW capabilities | | | | and possible | | | | configured policies, | | | | it shall supply the | | | | br-recv parameter in | | | | the SDP answer it | | | | sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the br-recv | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-recv parameter, | | | | the value of the | | | | br-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the br-recv | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the br-recv | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | bw (NOTE 1) | If the bw parameter | If the bw parameter | | | is contained in the | is contained in the | | | SDP offer, the | SDP offer, the | | | IMS-ALG shall check | IMS-ALG shall select | | | if the IMS-AGW | a sampling bandwidth | | | supports the | value, which is | | | indicated sampling | either the received | | | bandwidth(s), or a | bw value or a subset | | | subset of them, in | of it, based on | | | EVS primary mode in | IMS-AGW | | | the send and receive | capabilities, | | | direction. If the | possible configured | | | indicated sampling | policies, and the | | | bandwidth(s), and | negotiated bw range | | | even each subset of | of an EVS codec used | | | them, are not | before the access | | | supported, the | transfer, and the | | | IMS-ALG shall not | IMS-ALG shall | | | select the EVS | include the bw | | | payload type for | parameter with the | | | transcoding. If the | selected value that | | | IMS-ALG selects the | is also supplied | | | EVS payload type, it | towards the IMS-AGW | | | shall forward this | in the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-ALG desires the | | | the offerer in the | same sampling | | | remote descriptor. | bandwidth(s) for the | | | | send and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the sampling | | | | bandwidth(s) to | | | | match IMS-AGW | | | | capabilities, | | | | possible configured | | | | policies, and the | | | | negotiated bw range | | | | of the EVS codec | | | | used before the | | | | access transfer, the | | | | IMS-ALG shall supply | | | | the bw parameter in | | | | the SDP answer it | | | | sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include this | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the br, | | | | br-send or br-recv | | | | parameter, the value | | | | of the bw parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the bw | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | bw-send (NOTE 1) | If the bw-send | If the bw-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | sampling bandwidths | | | indicated sampling | value, which is | | | bandwidths, or a | either the received | | | subset of them, in | bw-recv value or a | | | EVS primary mode in | subset of it, based | | | the receive | on IMS-AGW | | | direction. If the | capabilities, | | | indicated sampling | possible configured | | | bandwidths, and even | policies, and the | | | each subset of them, | negotiated bw range | | | are not supported, | of an EVS codec used | | | the IMS-ALG shall | before the access | | | not select the EVS | transfer, and the | | | payload type for | IMS-ALG shall | | | transcoding. If the | include the bw-send | | | IMS-ALG selects the | parameter with the | | | EVS payload type, it | selected value in | | | shall forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-ALG desires a | | | the offerer in the | different sampling | | | remote descriptor. | bandwidths for the | | | | send and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the sampling | | | | bandwidths for the | | | | send direction to | | | | match IMS-AGW | | | | capabilities, | | | | possible configured | | | | policies, and the | | | | negotiated bw range | | | | of the EVS codec | | | | used before the | | | | access transfer, the | | | | IMS-ALG shall supply | | | | the bw-send | | | | parameter in the SDP | | | | answer it sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the br-send | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the bw or | | | | bw-send parameter, | | | | the value of the | | | | br-send parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw-send | | | | parameter in the SDP | | | | answer, it shall | | | | also supply to the | | | | IMS-AGW the bw-send | | | | parameter in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | bw-recv (NOTE 1) | If the br-recv | If the bw-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer, the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall select a | | | IMS-AGW supports the | sampling bandwidths | | | indicated sampling | value, which is | | | bandwidths, or a | either the received | | | subset of them, in | bw-send value or a | | | EVS primary mode in | subset of it, based | | | the send direction. | on IMS-AGW | | | If the indicated | capabilities, | | | sampling bandwidths, | possible configured | | | and even each subset | policies, and the | | | of them, are not | negotiated bw range | | | supported, the | of an EVS codec used | | | IMS-ALG shall not | before the access | | | select the EVS | transfer, and the | | | payload type for | IMS-ALG shall | | | transcoding. If the | include the bw-recv | | | IMS-ALG selects the | parameter with the | | | EVS payload type, it | selected value in | | | shall forward the | the SDP answer. | | | bw-recv parameter to | | | | the IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-ALG desires a | | | the offerer in the | different sampling | | | remote descriptor. | bandwidths for the | | | | send and receive | | | | direction in EVS | | | | primary mode, and | | | | wants to restrict | | | | the sampling | | | | bandwidths for the | | | | receive direction to | | | | match IMS-AGW | | | | capabilities, | | | | possible configured | | | | policies, and the | | | | negotiated bw range | | | | of the EVS codec | | | | used before the | | | | access transfer, the | | | | IMS-ALG shall supply | | | | the bw-recv | | | | parameter in the SDP | | | | answer it sends. | | | | | | | | Otherwise the | | | | IMS-ALG shall not | | | | include the bw-recv | | | | parameter in the SDP | | | | answer. | | | | | | | | If the IMS-ALG also | | | | supplies the br or | | | | br-recv parameter, | | | | the value of the | | | | bw-recv parameter | | | | shall be compatible | | | | with the values of | | | | those parameters. | | | | | | | | If the IMS-ALG | | | | supplies the bw-send | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | cmr (NOTE 1) | If the cmr parameter | If the cmr parameter | | | is contained in the | is contained in the | | | SDP offer and the | SDP offer, the | | | IMS-ALG select the | IMS-ALG shall | | | EVS payload type for | include the cmr | | | transcoding, the | parameter with | | | IMS-ALG shall | unmodified value in | | | forward this | the SDP answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if the | | | termination towards | IMS-AGW desires to | | | the offerer in the | disable codec mode | | | remote descriptor. | requests within the | | | | RTP payload of the | | | | EVS primary mode | | | | (due to the IMS-AGW | | | | capabilities, | | | | possible configured | | | | policies, and the | | | | negotiated CMR mode | | | | of an EVS codec used | | | | before the access | | | | transfer), it shall | | | | include the cmr | | | | parameter with value | | | | -1 in the SDP answer | | | | it sends | | | | | | | | If the IMS-ALG | | | | supplies the cmr | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | ch-aw-recv (NOTE 1) | If the ch-aw-recv | If the IMS-ALG it | | | parameter is | desires to control | | | contained in the SDP | the channel-aware | | | offer the IMS-ALG | mode of EVS in the | | | shall check if the | receive direction, | | | IMS-AGW supports the | e.g. to disable it | | | indicated mode in | with value -1, it | | | the send direction. | shall include the | | | If the indicated | ch-aw-recv parameter | | | mode is not | in the SDP offer and | | | supported, the | shall also supply | | | IMS-ALG shall not | the ch-aw-recv | | | select the EVS | parameter to the | | | payload type for | IMS-AGW in the local | | | transcoding. If the | descriptor for the | | | IMS-ALG selects the | termination towards | | | EVS payload type for | the offerer with the | | | transcoding, the | same value. The | | | IMS-ALG shall | IMS-ALG shall | | | forward this | consider the | | | parameter to the | capabilities of the | | | IMS-AGW for the | IMS-AGW and the | | | termination towards | negotiated | | | the offerer in the | ch-aw-recv mode of | | | remote descriptor. | an EVS codec used | | | | before the access | | | | transfer when it | | | | chooses an | | | | appropriate value. | +----------------------+----------------------+----------------------+ | number of channels | If the \"number of | If the \"number of | | (NOTE 2) | channels\" parameter | channels\" parameter | | | is contained in the | is contained in the | | | SDP offer the | SDP offer, the | | | IMS-ALG shall check | IMS-ALG shall | | | if the IMS-AGW | include the \"number | | | supports the | of channels\" | | | indicated number of | parameter with | | | channels. If the | unmodified value in | | | indicated number of | the SDP answer and | | | channels is not | shall also supply it | | | supported, the | to the IMS-AGW in | | | IMS-ALG shall not | the local descriptor | | | select the EVS | for the termination | | | payload type for | towards the offerer | | | transcoding. If the | with the same value. | | | IMS-ALG selects the | | | | EVS payload type for | | | | transcoding, the | | | | IMS-ALG shall | | | | forward this | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | ch-send (NOTE 1) | If the ch-send | If the ch-recv | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall include the | | | IMS-AGW supports the | ch-send parameter | | | indicated number of | with unmodified | | | channels in the | value in the SDP | | | receive direction. | answer and shall | | | If the indicated | also supply the | | | number of channels | ch-send parameter to | | | is not supported, | the IMS-AGW in the | | | the IMS-ALG shall | local descriptor for | | | not select the EVS | the termination | | | payload type for | towards the offerer | | | transcoding. If the | with the same value. | | | IMS-ALG selects the | | | | EVS payload type for | | | | transcoding, the | | | | IMS-ALG shall | | | | forward the ch-send | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | ch-recv (NOTE 1) | If the ch-recv | If the ch-send | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer the IMS-ALG | offer, the IMS-ALG | | | shall check if the | shall include the | | | IMS-AGW supports the | ch-recv parameter | | | indicated number of | with unmodified | | | channels in the send | value in the SDP | | | direction. If the | answer and shall | | | indicated number of | also supply the | | | channels is not | ch-recv parameter to | | | supported, the | the IMS-AGW in the | | | IMS-ALG shall not | local descriptor for | | | select the EVS | the termination | | | payload type for | towards the offerer | | | transcoding. If the | with the same value. | | | IMS-ALG selects the | | | | EVS payload type for | | | | transcoding, the | | | | IMS-ALG shall | | | | forward the ch-recv | | | | parameter to the | | | | IMS-AGW for the | | | | termination towards | | | | the offerer in the | | | | remote descriptor. | | +----------------------+----------------------+----------------------+ | mode-set (NOTE 3) | If the mode-set | If the mode-set | | | parameter is | parameter is | | | contained in the SDP | contained in the SDP | | | offer and the | offer, the IMS-ALG | | | IMS-ALG select the | shall include the | | | EVS payload type for | mode-set parameter | | | transcoding, the | with unmodified | | | IMS-ALG shall | value in the SDP | | | forward this | answer. | | | parameter to the | | | | IMS-AGW for the | Otherwise, if EVS or | | | termination towards | AMR-WB was used | | | the offerer in the | before the access | | | remote descriptor. | transfer, the | | | | IMS-ALG should | | | | include the mode-set | | | | parameter with a | | | | value indicating the | | | | mode that was | | | | negotiated before | | | | the access transfer | | | | (or omit it if no | | | | restrictions applied | | | | before). | | | | | | | | If the IMS-ALG | | | | supplies the | | | | mode-set parameter | | | | in the SDP answer, | | | | it shall also supply | | | | it to the IMS-AGW in | | | | the local descriptor | | | | for the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | mode-change-period | If the | If EVS or AMR-WB was | | (NOTE 3) | mode-change-period | used before the | | | parameter is | access transfer, the | | | contained in the SDP | IMS-ALG should | | | offer and the | include the | | | IMS-ALG select the | mode-change-period | | | EVS payload type for | parameter with a | | | transcoding, the | value indicating the | | | IMS-ALG shall | mode that was | | | forward this | negotiated before | | | parameter to the | the access transfer | | | IMS-AGW for the | (or omit it if no | | | termination towards | restrictions applied | | | the offerer in the | before). | | | remote descriptor. | | | | | the IMS-ALG should | | | | include the | | | | mode-change-period | | | | parameter for the | | | | EVS payload in the | | | | SDP offer it | | | | forwards. | | | | | | | | If the IMS-ALG | | | | supplies the | | | | mode-change-period | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | mo | If the | The IMS-ALG shall | | de-change-capability | mo | either include the | | (NOTE 3) | de-change-capability | mo | | | parameter is | de-change-capability | | | contained in the SDP | parameter with a | | | offer and the | value 2 or omit the | | | IMS-ALG select the | parameter. | | | EVS payload type for | | | | transcoding, the | If the IMS-ALG | | | IMS-ALG may forward | supplies the | | | this parameter to | mo | | | the IMS-AGW for the | de-change-capability | | | termination towards | parameter in the SDP | | | the offerer in the | answer, it may also | | | remote descriptor. | supply it to the | | | | IMS-AGW in the local | | | | descriptor for the | | | | termination towards | | | | the offerer with the | | | | same value. | +----------------------+----------------------+----------------------+ | mode-change-neighbor | If the | If EVS or AMR-WB was | | (NOTE 3) | mode-change-neighbor | used before the | | | parameter is | access transfer, the | | | contained in the SDP | IMS-ALG should | | | offer and the | include the | | | IMS-ALG select the | mode-change-neighbor | | | EVS payload type for | parameter with a | | | transcoding, the | value indicating the | | | IMS-ALG shall | mode that was | | | forward this | negotiated before | | | parameter to the | the access transfer | | | IMS-AGW for the | (or omit it if no | | | termination towards | restrictions applied | | | the offerer in the | before). | | | remote descriptor. | | | | | If the IMS-ALG | | | | supplies the | | | | mode-change-neighbor | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | max-red (NOTE 5) | If the max-red | The IMS-ALG shall | | | parameter is | only include the | | | contained in the SDP | max-red parameter in | | | offer and the | the SDP answer if it | | | IMS-ALG select the | desires to restrict | | | EVS payload type for | the maximum | | | transcoding, the | redundancy of | | | IMS-ALG shall | received packets. | | | forward this | When selecting the | | | parameter to the | value of the max-red | | | IMS-AGW for the | parameter, the | | | termination towards | IMS-ALG shall | | | the offerer in the | consider the | | | remote descriptor. | capabilities of the | | | | IMS-AGW and, If EVS | | | | or AMR-WB was used | | | | before the access | | | | transfer, the | | | | redundancy that was | | | | negotiated before | | | | the access transfer. | | | | | | | | If the IMS-ALG | | | | supplies the max-red | | | | parameter in the SDP | | | | answer, it shall | | | | also supply it to | | | | the IMS-AGW in the | | | | local descriptor for | | | | the termination | | | | towards the offerer | | | | with the same value. | +----------------------+----------------------+----------------------+ | 3g | If the | If the IMS-AGW | | pp_mtsi_app_adapt | 3g | supports RTCP APP | | (NOTE 4) | pp_mtsi_app_adapt | based adaptation | | | parameter is | messages defined in | | | contained in the SDP | 3G | | | answer, and the | PP TS 26.114 [21], | | | IMS-ALG select the | and the IMS-ALG has | | | EVS payload type for | a policy to | | | transcoding, the | negotiate the usage | | | IMS-ALG shall | of those messages, | | | forward this | the IMS-ALG shall | | | parameter to the | include the | | | IMS-AGW the IMS-ALG | 3g | | | shall forward this | pp_mtsi_app_adapt | | | parameter to the | SDP attribute | | | IMS-AGW in the | indicating the | | | remote descriptor. | allowed APP messages | | | | in the SDP answer. | | | | If EVS was used | | | | before the access | | | | transfer, the | | | | IMS-ALG should | | | | consider the | | | | negotiated RTCP APP | | | | packet types the | | | | access transfer in | | | | addition to the IMS | | | | AGW capabilities | | | | when selecting the | | | | allowed RTCP APP | | | | messages. | +----------------------+----------------------+----------------------+ | NOTE 1: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | 3G | | | | PP TS 26.445 [51]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 2: This number | | | | of channels are | | | | encoded as | | | | \"encoding | | | | parameters\" of the | | | | SDP \"a=rtpmap\" | | | | attribute defined in | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 3: This MIME | | | | parameter of the EVS | | | | RTP payload type | | | | relates to AMR-WB IO | | | | mode and is defined | | | | in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | | | | | | NOTE 4: This SDP | | | | attribute is defined | | | | in | | | | 3G | | | | PP TS 26.114 [21]. | | | | It applies to all | | | | codecs offered in an | | | | SDP media line. | | | | However, some values | | | | are specific to EVS. | | | | | | | | NOTE 5: This MIME | | | | parameter of the EVS | | | | RTP payload type is | | | | defined in | | | | I | | | | ETF RFC 4867 [54]. | | | | It is encapsulated | | | | within the SDP | | | | \"a=fmtp\" attribute | | | | defined | | | | I | | | | ETF RFC 4566 [53]. | | | +----------------------+----------------------+----------------------+
### 6.2.15 Multimedia Priority Congestion Control Procedures
#### 6.2.15.1 General
The IMS-ALG and IMS-AGW may support the priority treatment of a call/session
identified as an MPS call/session. This clause describes the Iq signalling
procedures and their interactions with SIP signalling in the control plane and
with user plane procedures to support the requirements for Multimedia Priority
Service. These Iq signalling procedures may or may not apply depending on the
network configuration (e.g. whether the IMS-AGW is shared by multiple IMS-ALGs
or whether the IMS-ALG controls multiple IMS-AGWs for a given route -- Media
Gateway Group).
The IMS-ALG can receive a SIP INVITE with MPS priority information (see 3GPP
TS 23.228 [2], clause 5.21).
#### 6.2.15.2 IMS-AGW Resource Congestion in ADD response, request is queued
If the IMS-ALG requests a resource via the procedure Reserve and Configure AGW
Connection Point or Reserve AGW Connection Point and receives an error
indicating that the requested resource could not be seized (e.g. H.248 error
code #510 \"insufficient resources\") and the IMS-ALG does not have
alternative IMS-AGW through which it can route the call it queues the priority
session and gives it priority over any further Reserve and Configure AGW
Connection Point or Reserve AGW Connection Point procedures for lower priority
sessions towards this IMS-AGW until the requested resource for this queued
session is successful seized. The example sequence is shown in Figure
6.2.15.2.1.
Figure 6.2.15.2.1: Request to reserve IMS-AGW MPS Priority call resources when
IMS-AGW is congested
#### 6.2.15.3 IMS-AGW Resource Congestion in ADD response, IMS-ALG seizes new
IMS-AGW
If the IMS-ALG requests a resource via the procedure Reserve and Configure AGW
Connection Point or Reserve AGW Connection Point and receives an error
indicating that the requested resources could not be seized (e.g. H.248 error
code #510 \"insufficient resources\") and Media Gateway Groups are implemented
it should seize a new IMS-AGW from the same Media Gateway Group before
resorting to any queuing of the priority session (as described in 6.2.15.2) to
enable the MPS call/session to proceed as early as possible.
#### 6.2.15.4 IMS-AGW Priority Resource Allocation
If the IMS-AGW supports the Priority information (e.g. determined through
provisioning or package profile) the IMS-ALG requests a resource via the
procedure Reserve and Configure AGW Connection Point or Reserve AGW Connection
Point and includes the Priority information. The IMS-AGW may then provide
priority allocation of resources once a congestion threshold is reached. If
the IMS-AGW is completely congested it shall indicate this to the IMS-ALG as
described in 6.2.15.2. The example sequence is shown in Figure 6.2.15.4.1.
Figure 6.2.15.4.1: Request to reserve IMS-AGW MPS Priority call resources when
IMS-AGW is congested, priority resources are allocated
#### 6.2.15.5 IMS-AGW Priority User Data marking
The IMS-ALG may request the streams associated to an MPS Priority Call to be
marked with certain priority code point as described in clause 6.2.7. The IMS-
AGW shall then mark each IP packet header accordingly. The example sequence is
shown in Figure 6.2.15.5.1.
Figure 6.2.15.5.1: Request to reserve IMS-AGW call resources and apply DCSP
marking for MPS
The IMS-AGW may also provide priority allocation for resources requested via a
subsequent Configure AGW Connection Point procedure not including Priority
information if the related context has been marked with priority information
during the Reserve AGW Connection Point or Reserve and Configure AGW
Connection Point procedure.
#### 6.2.15.6 IMS-AGW Priority Modification
If the IMS-ALG seized an IP termination for a priority call/session with a
default priority and subsequently needs to modify the priority information
previously communicated to the IMS-AGW (e.g. subject to subsequent
authorisation by an authorisation point, see 3GPP TS 24.229 [11] clause 4.11),
the IMS-ALG may modify the existing IP termination for the MPS call/session
with the actual priority and, if DiffServ is used, provision a suitable DSCP
marking for the updated MPS priority level to the IMS-AGW via the Configure
AGW Connection Point Procedure.
NOTE: The specific Iq related call sequence which details the handling to
support the requirements defined in 3GPP TS 24.229 [11], clause 4.11 and 3GPP
TS 23.228 [2], clause 5.21 is not specified, and therefore implementations
might exist which fulfil these requirements but do not require modification of
the priority information across the Iq interface.
### 6.2.16 Coordination of Video Orientation
Figure 6.2.16.1 shows the message sequence chart example for indicating
extended RTP header for Coordination of Video Orientation.
Figure 6.2.16.1: Procedure to indicate RTP extension header for CVO
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to support the RTP Header Extension
capability as defined in IETF RFC 5285 [23].
NOTE: If the IMS-ALG receives an SDP answer, which includes the \"a=extmap\"
attribute with a CVO URN with a granularity that the IMS-AGW has not included
in its response, or if the SDP answer does not include any \"a=extmap\" CVO
related attribute, it is not necessary to modify the IMS-AGW settings for this
reason alone. Doing that would only add unnecessary signalling without
requiring any action or changes in the IMS-AGW. However, if the IMS-ALG needs
to modify the media attributes for other purposes, in particular due to
transcoding, then the IMS-AGW is updated in accordance with the received SDP
answer, that is, either with the received CVO related \"a=extmap\" attribute
if present in the received SDP answer or without it if not included in the
received SDP answer (thus removing the requirement for supporting \"a=extmap\"
and for sending the header and CVO bits for the transcoded stream).
### 6.2.17 Procedures for Interactive Connectivity Establishment (ICE)
#### 6.2.17.1 ICE lite
Figure 6.2.17.1.1 shows a message sequence chart example for performing the
ICE lite procedure towards the offerer.
Figure 6.2.17.1.1: Procedure for interactive connectivity establishment using
ICE lite towards the offerer
#### 6.2.17.2 Full ICE
Figure 6.2.17.2.1 shows a message sequence chart example for performing the
full ICE procedure towards the offerer.
Figure 6.2.17.2.1: Procedure for interactive connectivity establishment using
full ICE towards the offerer
#### 6.2.17.3 Connectivity check result notification (full ICE)
Figure 6.2.17.3.1 shows the message sequence chart example for an ICE
connectivity check result Event.
Figure 6.2.17.3.1: Procedure to report ICE connectivity check result
#### 6.2.17.4 New peer reflexive candidate notification (full ICE)
Figure 6.2.17.4.1 shows the message sequence chart example for additional
connectivity check when new peer reflexive candidate is discovered in full
ICE.
Figure 6.2.17.4.1: Procedure to perform additional connectivity check upon the
report of new peer reflexive candidate
#### 6.2.17.5 STUN consent freshness test
Figure 6.2.17.5.1 shows a message sequence chart example for requesting the
STUN consent freshness test procedure towards the offerer when full ICE is
supported by the eIMS-AGW.
Figure 6.2.17.5.1: Procedure for STUN consent freshness test towards the
offerer
#### 6.2.17.6 STUN Consent Freshness Test Failure Notification
Figure 6.2.17.6.1 shows the message sequence chart example for an ICE STUN
consent freshness test failure Event.
Figure 6.2.17.6.1: Procedure to report STUN consent freshness test failure
### 6.2.18 TCP bearer connection control
#### 6.2.18.1 General
All message sequence charts in this clause are examples. The H.248 context
model is defined in Figure 6.2.1.1.
#### 6.2.18.2 Stateless TCP handling
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG and
IMS-AGW applying the requirements specified in clause 5.16.1.
#### 6.2.18.3 State-aware TCP handling without support of modifying the TCP
setup direction
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG and
IMS-AGW applying the requirements specified in clause 5.16.2.2.
Clause 6.2.10.3.1 provides example call flows for TCP bearer connection
establishment without modyfing the TCP setup direction.
#### 6.2.18.4 State-aware TCP handling with support of modifying the TCP setup
direction
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG and
IMS-AGW applying the requirements specified in clause 5.16.2.3.
Figure 6.2.18.4.1 shows an example call flow for a terminating session set-up
procedure, where the IMS-ALG receives an incoming SDP offer containing media
line for a new MSRP media stream with an \"a=setup:active\" SDP attribute
towards a served UE located behind a remote NAT.
Figure 6.2.18.4.1: Terminating example call flow for MSRP between UEs located
behind NAT
The IMS UE B performs an IMS terminating session set-up according to 3GPP TS
23.228 [2], with modifications as described in 3GPP TS 33.328 [12].
The procedure in the above figure is described step-by-step with an emphasis
on the additional aspects for IMS-ALG and IMS-AGW of TCP bearer connection
control.
1\. The Pâ€‘CSCF (IMSâ€‘ALG) receives an SDP offer for an MSRP media stream with
an \"a=setup:active\" attribute. For the MSRP media stream offered with
transport \"TCP/MSRP\", the Pâ€‘CSCF (IMSâ€‘ALG) allocates the required resources,
includes the IMSâ€‘AGW in the media path and proceeds as specified in this
clause.
2.-4. The IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to
request a termination for \"TCP\" media (for application-agnostic
interworking) or \"TCP/MSRP\" media (for application-aware interworking)
towards the access network. The IMS-ALG preconfigures the IMS-AGW to operate
in TCP merge mode by providing the \"a=setup:passive\" attribute.
5.-7. The IMS-ALG uses the \"Reserve And Configure AGW Connection Point\"
procedure to request a termination for \"TCP\" media (for application-agnostic
interworking) or \"TCP/ MSRP\" media (for application-aware interworking)
towards the core network. The IMS-ALG preconfigures the IMS-AGW to operate in
TCP Merge mode by providing the \"a=setup:passive\" attribute.
8\. The Pâ€‘CSCF (IMSâ€‘ALG) changes the \"a=setup\" SDP attribute to \"actpass\"
in the SDP offer and inserts the address information received from the IMS-
AGW.
9\. The Pâ€‘CSCF (IMSâ€‘ALG) forwards the SDP offer.
10\. The UE B chooses to become the active party in the TCP connection
establishment and sends a TCP SYN to establish the TCP connection. If the
P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any
incoming TCP connection establishment requests (TCP SYN), e.g. to enable a
remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not
indicate to the IMS-AGW at step 2 that it shall latch onto the required
destination address via the source address/port of the incoming media, the
IMS-AGW shall drop the TCP SYN received from the UE.\ If the TCP SYN is not
answered before a timer expiry, the UE will send the TCP SYN a second time
(step 10\').
11\. The Pâ€‘CSCF (IMSâ€‘ALG) receives the SDP answer. It contains the SDP answer
with an \"a=setup:active\" attribute.
12.-14. The IMS-ALG uses the \"Configure AGW Connection Point\" procedure to
configure the termination towards the UE B with remote address information.
15\. The Pâ€‘CSCF (IMSâ€‘ALG) modifies the SDP answer before sending it to the
core network. The Pâ€‘CSCF (IMSâ€‘ALG) sets the \"a=setup:passive\" SDP attribute.
16\. The P-CSCF (IMA-ALG) then sends the updated SDP answer to core network.
17\. The IMS-AGW answers the TCP SYN and the remote peer completes the TCP
connection establishment.
18\. The IMS-AGW answers the TCP SYN and UE B completes the TCP connection
establishment.
### 6.2.19 Application-aware MSRP interworking at the IMS-AGW
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG:
\- indicating \"TCP/MSRP\" or \"TCP/TLS/MSRP\" (if e2ae media security is
applied) as transport protocol to the IMSâ€‘AGW;
\- configuring the IMS-AGW to apply application-aware MSRP interworking; and
\- providing the SDP \"a=path\" attribute, as received in SIP/SDP signalling,
to the IMSâ€‘AGW as \"MSRP Path\" with the remote descriptor of the
corresponding call leg.
The IMSâ€‘AGW applies application-aware MSRP interworking if being instructed
from the IMS-ALG. Support of dynamic instructions from the IMS-ALG is
optional.
If the IMS-AGW applies application-aware MSRP interworking, it modifies the
MSRP \"To-Path\" header field in MSRP packets by replacing the IP address and
TCP port of the only entry with the corresponding information in the \"MSRP
path\" provided by the IMS_ALG while retaining the MSRP session ID part of the
entry as received in the MSRP \"To-Path\" and then forward the MSRP data
without further modification.
### 6.2.20 Alternate Connection (ALTC) Addresses Management
Figure 6.2.20.1 shows a message sequence chart example for a terminating
session setup with a dual stack UE using the SDP attributes \"altc\" inserted
by the IMS-ALG in the SDP offer to indicate the IP addresses for potential
alternative connection addresses.
Figure 6.2.20.1: Terminating session setup with insertion of the SDP attribute
\"altc\" by the IMS-ALG
Upon receipt of a session initiation request, the IMS-ALG shall extract the
offerer\'s destination network address(es) and port number(s) from the SDP
offer received from the calling party endpoint. Based on local policies, the
IMS-ALG may decide to provide an alternative IP address and to insert then
\"altc\" attributes in the SDP offer sent to the terminating side. The IMS-ALG
shall then request the IMS-AGW to allocate transport resources for the
terminating side (e.g. terminations T2 for IPv6 and T3 for IPv4) via two
Reserve AGW Connection Point procedures, one per address type.
NOTE: The IMS-AGW is \"ALTC agnostic\" and does not have any awareness about
preferred and alternate IP connection resources as described in the in IETF
RFC 6947 [59]. Moreover, there is not any context-internal topology between
terminations T1, T2 and T3 (via the H.248 topology descriptor) defined: T1 is
either implicitly interlinked with T2 or T3 dependent on the used H.248 Stream
identifier values. However, such aspects are ignored due to the expected
short-term aspects of the temporary context configuration with three
terminations.
Based on the responses received from the IMS-AGW, the IMS-ALG shall modify the
offerer\'s destination addresses and/or ports initially contained in the SDP
offer, insert the \"altc\" SDP attributes carrying the preferred and alternate
IP addresses and propagate the session establishment toward the terminating
party.
On receipt of the SDP answer of the called party endpoint, the IMS-ALG shall
pass the IP address, port and address type chosen by the called party endpoint
for the session to the IMS-AGW in the Configure AGW Connection Point procedure
and shall request the IMS-AGW to allocate transport resources (T1) for the
calling party endpoint via the Reserve and Configure AGW Connection Point.
Upon receiving the response from the IMS-AGW, the IMS-ALG shall modify the
answerer\'s destination address(es) and/or port(s) contained in the
application SDP answer and pass the information to the calling party endpoint.
The IMS-ALG shall also request the IMS-AGW to release the transport resources
(e.g. termination T3 with IPv4) reserved for the unused address type via the
Release AGW Termination procedure.
### 6.2.21 Video Region-of-Interest (ROI)
#### 6.2.21.1 Video Region-of-Interest (ROI) using FECC
Figure 6.2.21.1.1 shows the message sequence chart example for indicating
Video Region-of-Interest (ROI) using FECC.
Figure 6.2.21.1.1: Procedure to indicate Video ROI using FECC
This procedure is identical to that of clause 6.2.1.
#### 6.2.21.2 \"Predefined ROI\" mode
Figure 6.2.21.2.1 shows the message sequence chart example for indicating
Predefined ROI mode.
Figure 6.2.21.2.1: Procedure to indicate Predefined ROI mode
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to support the RTCP feedback message
capability for \"Predefined ROI\" type expressed by the parameter \"3gpp-roi-
predefined\", as described in 3GPP TS 26.114 [21], and the RTP Header
Extension capability for carriage of predefined ROI information as defined in
IETF RFC 5285 [23] and 3GPP TS 26.114 [21].
#### 6.2.21.3 \"Arbitrary ROI\" mode
Figure 6.2.21.3.1 shows the message sequence chart example for indicating
Arbitrary ROI mode.
Figure 6.2.21.3.1: Procedure to indicate Arbitrary ROI mode
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to support the RTCP feedback message
capability for \"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-
arbitrary\", as described in 3GPP TS 26.114 [21], and the RTP Header Extension
capability for carriage of arbitrary ROI information as defined in IETF RFC
5285 [23] and 3GPP TS 26.114 [21].
### 6.2.22 WebRTC
#### 6.2.22.1 Establishment of a WebRTC data channel
See clause 6.2.10.6.2.
#### 6.2.22.2 Release of a WebRTC data channel
The H.248 Context model for a WebRTC call in figure 6.2.10.6.2.1 is assumed.
However, the example flow in this clause focuses on the WebRTC data channel
part only. Thus, only H.248 Streams S1 (for de-aggregation of multiple data
channels) and S2 (for MSRP traffic) are indicated subsequently.
Figure 6.2.22.2.1 shows the message sequence chart example for the WIC
originated procedure to release a WebRTC MSRP data channel following the
procedures in clause 5.20.2.3.2.
Figure 6.2.22.2.1: Call flow for the Release of a single WebRTC data channel
NOTE: Steps 9, 10, 13 and 14: A data channel is constituted by a pair of
unidirectional SCTP Streams (with the same SCTP Stream identifier value in
above flow). The SCTP Outgoing SSN Reset Request procedure does reset a single
SCTP Stream only (due to the configuration in this example), hence the
procedure will be executed twice (towards and from remote WIC).
#### 6.2.22.3 Media Plane Optimization
##### 6.2.22.3.1 Media Plane Optimization including DTLS layer for WIC
originating call
The H.248 Context model for a WebRTC call in figure 6.2.10.6.2.1 is assumed.
However, the example flow in this clause focuses on the WebRTC data channel
part only. Thus, only H.248 Streams S1 (for de-aggregation of multiple data
channels) and S2 (for MSRP traffic) are indicated subsequently.
Figure 6.2.22.3.1.1 shows the message sequence chart example for the WIC
originated procedure to establish a WebRTC data channel with media plane
optimization following the procedures in clause 5.20.3.2.
NOTE: Message 16 (DTLS ClientHello) can be received by the eIMS-AGW from the
remote peer before the eIMS-AGW is configured to pass it (in steps 8.-13.) and
will then be dropped by the eIMS-AGW. However, the remote peer will then
resend message 16 after a timeout while waiting for a response.
Figure 6.2.22.3.1.1: WIC originated procedure for WebRTC data channel
establishment with media plane optimization including DTLS layer
##### 6.2.22.3.2 Media Plane Optimization excluding DTLS layer for WIC
originating call
The H.248 Context model for a WebRTC call in figure 6.2.10.6.2.1 is assumed.
However, the example flow in this clause focuses on the WebRTC data channel
part only. Thus, only H.248 Streams S1 (for de-aggregation of multiple data
channels) and S2 (for MSRP traffic) are indicated subsequently. Furthermore,
there is an additional termination T3 towards the IMS core network to handle
DTLS.
Figure 6.2.22.3.2.1 shows the message sequence chart example for the WIC
originated procedure to establish a WebRTC data channel with media plane
optimization following the procedures in clause 5.20.3.2.
Figure 6.2.22.3.2.1: WIC originated procedure for WebRTC data channel
establishment with media plane optimization excluding DTLS layer
### 6.2.23 RTP-level pause and resume
Figure 6.2.23.1 shows the message sequence chart example for indicating RTP-
level pause and resume.
Figure 6.2.23.1: Procedure to indicate RTP-level pause and resume
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to transparently forward the RTCP \"CCM
PAUSE\" packets (as defined in IETF RFC 7728 [79]) between incoming and
outgoing network.
### 6.2.24 RTCP Codec Control Commands and Indications
Figure 6.2.24.1 shows the message sequence chart example for indicating \"RTCP
Codec Control Commands and Indications\".
Figure 6.2.24.1: Procedure to indicate RTCP Codec Control Commands and
Indications
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally indicates that the IMS-AGW shall be prepared to receive and is
allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\" feedback messages
(as defined in IETF RFC 5104 [78]).
### 6.2.25 Delay Budget Information (DBI)
Figure 6.2.25.1 shows a message sequence chart example for indicating DBI.
Figure 6.2.25.1: Procedure to indicate DBI
This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG
optionally requesting the IMS-AGW to transparently forward the RTCP feedback
DBI packets (as defined in 3GPP TS 26.114 [21]) between incoming and outgoing
network.
# 7 Charging
The charging is specified in 3GPP TS 32.260 [5]. No requirements are
identified for the Iq interface.
# 8 Messages/Procedures and Contents
## 8.1 General
This clause describes logical signalling procedures between the IMS-ALG and
IMS-AGW. The procedures within this clause are intended to be implemented
using the standard H.248 procedure as defined in ITU recommendation H.248.1
[9] with appropriate parameter combinations.
NOTE: Whenever the stage 2 description is referring to a \"(stage 2)
information element\", then there is the premise of a one-to-one mapping to a
stage 3 signalling element.
## 8.2 Reserve and Configure AGW Connection Point
This procedure is used to reserve multimedia-processing resources for the Iq
interface connection.
Table 8.2.1: Procedures between IMS-ALG and IMS-AGW: Reserve and Configure AGW
Connection Point
+-------------+-----------+-------------+-------------+-------------+ | Procedure | Initiated | Information | Information | Information | | | | element | element | element | | | | name | required | description | +-------------+-----------+-------------+-------------+-------------+ | Reserve and | IMS-ALG | Cont | M | This | | Configure | | ext/Context | | information | | AGW | | Request | | element | | Connection | | | | indicates | | Point | | | | the | | | | | | existing | | | | | | context or | | | | | | requests a | | | | | | new context | | | | | | for the | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | Emergency | O | This | | | | Call | | information | | | | Indicator | | element | | | | | | identifies | | | | | | the call as | | | | | | emergency | | | | | | call that | | | | | | requires a | | | | | | p | | | | | | referential | | | | | | handling. | +-------------+-----------+-------------+-------------+-------------+ | | | Priority | O | This | | | | information | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | priority | | | | | | treatment | | | | | | for the | | | | | | t | | | | | | erminations | | | | | | and bearer | | | | | | connections | | | | | | in the | | | | | | specified | | | | | | context. | +-------------+-----------+-------------+-------------+-------------+ | | | Bearer | M | This | | | | Termination | | information | | | | Request | | element | | | | | | indicates | | | | | | the | | | | | | existing | | | | | | bearer | | | | | | termination | | | | | | or requests | | | | | | a new | | | | | | bearer | | | | | | termination | | | | | | for the | | | | | | bearer to | | | | | | be | | | | | | e | | | | | | stablished. | +-------------+-----------+-------------+-------------+-------------+ | | | Local IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive | | | | | | user data. | | | | | | May be | | | | | | excluded | | | | | | (i.e. \"-\" | | | | | | is used in | | | | | | SDP m-line) | | | | | | if no | | | | | | transcoding | | | | | | or media | | | | | | related | | | | | | functions | | | | | | are | | | | | | required. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | +-------------+-----------+-------------+-------------+-------------+ | | | R | O | This | | | | eserveValue | | information | | | | | | element | | | | | | indicates | | | | | | if multiple | | | | | | local | | | | | | resources | | | | | | are to be | | | | | | reserved. | | | | | | | | | | | | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | included if | | | | | | a speech | | | | | | codec and | | | | | | auxiliary | | | | | | payload | | | | | | types are | | | | | | configured. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall send | | | | | | data. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | | | | | | | | | | | | May be | | | | | | excluded | | | | | | (i.e. \"-\" | | | | | | is used in | | | | | | SDP m-line) | | | | | | if no | | | | | | transcoding | | | | | | or media | | | | | | related | | | | | | functions | | | | | | are | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | M | This | | | | Connection | | information | | | | Address | | element | | | | Request | | requests an | | | | | | IP address | | | | | | and port | | | | | | number(s) | | | | | | on the | | | | | | IMS-AGW | | | | | | that the | | | | | | remote end | | | | | | can send | | | | | | user plane | | | | | | data to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | M | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the remote | | | | | | IP address | | | | | | and port | | | | | | number(s) | | | | | | that the | | | | | | IMS-AGW can | | | | | | send user | | | | | | plane data | | | | | | to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify | M | This | | | | termination | | information | | | | heartbeat | | element | | | | | | requests | | | | | | termination | | | | | | heartbeat | | | | | | i | | | | | | ndications. | | | | | | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | included | | | | | | when | | | | | | requesting | | | | | | a new | | | | | | bearer | | | | | | t | | | | | | ermination. | | | | | | Otherwise | | | | | | the | | | | | | information | | | | | | element is | | | | | | optional. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify | O | This | | | | Released | | information | | | | Bearer | | element | | | | | | requests a | | | | | | n | | | | | | otification | | | | | | of a | | | | | | released | | | | | | bearer. | +-------------+-----------+-------------+-------------+-------------+ | | | Latching | O | This | | | | Requirement | | information | | | | | | element | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | should | | | | | | (re)latch | | | | | | onto the | | | | | | address of | | | | | | received | | | | | | media | | | | | | packets to | | | | | | determine | | | | | | the | | | | | | co | | | | | | rresponding | | | | | | destination | | | | | | address. | +-------------+-----------+-------------+-------------+-------------+ | | | IP Realm | O | This | | | | Identifier | | information | | | | | | element | | | | | | indicates | | | | | | the IP | | | | | | realm of | | | | | | the bearer | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Source | | information | | | | Address | | element | | | | Filtering | | indicates | | | | | | that remote | | | | | | source | | | | | | address | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source | | information | | | | Address | | element | | | | Mask | | provides | | | | | | information | | | | | | on the | | | | | | valid | | | | | | remote | | | | | | source | | | | | | addresses. | | | | | | This is | | | | | | required if | | | | | | a range of | | | | | | remote | | | | | | source | | | | | | address | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Source Port | | information | | | | Filtering | | element | | | | | | indicates | | | | | | that remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source Port | | information | | | | | | element | | | | | | identifies | | | | | | the valid | | | | | | remote | | | | | | source | | | | | | port. This | | | | | | may be | | | | | | included if | | | | | | remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | included. | | | | | | (NOTE 1) | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source Port | | information | | | | Range | | element | | | | | | identifies | | | | | | a range of | | | | | | valid | | | | | | remote | | | | | | source | | | | | | ports. This | | | | | | may be | | | | | | included if | | | | | | remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | included. | | | | | | (NOTE 1) | +-------------+-----------+-------------+-------------+-------------+ | | | Traffic | O | This | | | | Policing | | information | | | | Required | | element | | | | | | indicates | | | | | | that | | | | | | policing of | | | | | | the media | | | | | | flow is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Peak Data | O | This | | | | Rate | | information | | | | | | element may | | | | | | be present | | | | | | if Policing | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | permissible | | | | | | peak data | | | | | | rate for a | | | | | | media | | | | | | stream. | | | | | | (NOTE 2).. | +-------------+-----------+-------------+-------------+-------------+ | | | Sustainable | O | This | | | | Data Rate | | information | | | | | | element may | | | | | | be present | | | | | | if Policing | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | permissible | | | | | | sustainable | | | | | | data rate | | | | | | for a media | | | | | | stream. | | | | | | (NOTE 2). | +-------------+-----------+-------------+-------------+-------------+ | | | Delay | O | This | | | | Variation | | information | | | | Tolerance | | element may | | | | | | be present | | | | | | if Policing | | | | | | on Peak | | | | | | Data Rate | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the maximum | | | | | | expected | | | | | | delay | | | | | | variation | | | | | | tolerance | | | | | | for the | | | | | | co | | | | | | rresponding | | | | | | media | | | | | | stream. | +-------------+-----------+-------------+-------------+-------------+ | | | Maximum | C | This | | | | Burst Size | | information | | | | | | element | | | | | | shall be | | | | | | present if | | | | | | Policing on | | | | | | Sustainable | | | | | | Data Rate | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the maximum | | | | | | expected | | | | | | burst size | | | | | | for the | | | | | | co | | | | | | rresponding | | | | | | media | | | | | | stream. | +-------------+-----------+-------------+-------------+-------------+ | | | DiffServ | O | This | | | | Code Point | | information | | | | | | element | | | | | | indicates a | | | | | | specific | | | | | | DiffServ | | | | | | code point | | | | | | to be used | | | | | | in the IP | | | | | | header in | | | | | | packets | | | | | | sent on the | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | DiffServ | O | This | | | | Tagging | | information | | | | Behaviour | | element | | | | | | indicates | | | | | | whether the | | | | | | Diffserv | | | | | | code point | | | | | | in the IP | | | | | | header in | | | | | | packets | | | | | | sent on the | | | | | | bearer | | | | | | termination | | | | | | shall be | | | | | | copied from | | | | | | the | | | | | | received | | | | | | value or | | | | | | set to a | | | | | | specific | | | | | | value. | +-------------+-----------+-------------+-------------+-------------+ | | | Media | O | This | | | | Inactivity | | information | | | | Detection | | element | | | | Required | | indicates | | | | | | that | | | | | | detection | | | | | | of inactive | | | | | | media flows | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Media | C | This | | | | Inactivity | | information | | | | Detection | | element may | | | | Time | | be present | | | | | | if Inactive | | | | | | Media | | | | | | Detection | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | Inactivity | | | | | | Detection | | | | | | time. | +-------------+-----------+-------------+-------------+-------------+ | | | Media | C | This | | | | Inactivity | | information | | | | Detection | | element may | | | | Direction | | be present | | | | | | if Inactive | | | | | | Media | | | | | | Detection | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | Inactivity | | | | | | Detection | | | | | | direction. | +-------------+-----------+-------------+-------------+-------------+ | | | RTCP | O | This | | | | handling | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | wants to | | | | | | explicitly | | | | | | control the | | | | | | reservation | | | | | | of RTCP | | | | | | resources | | | | | | (NOTE 4). | +-------------+-----------+-------------+-------------+-------------+ | | | RTP/RTCP | C | This | | | | transport | | information | | | | m | | element | | | | ultiplexing | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | the | | | | | | RTP/RTCP | | | | | | transport | | | | | | mu | | | | | | ltiplexing. | | | | | | This | | | | | | information | | | | | | element may | | | | | | only be | | | | | | present if | | | | | | RTCP | | | | | | handling is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Explicit | C | This | | | | RTCP | | information | | | | transport | | element | | | | address | | indicates | | | | | | the remote | | | | | | RTCP port | | | | | | and | | | | | | optionally | | | | | | the remote | | | | | | network | | | | | | address | | | | | | where to | | | | | | send RTCP | | | | | | packets. | | | | | | This | | | | | | information | | | | | | element may | | | | | | only be | | | | | | present if | | | | | | RTCP | | | | | | handling is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | C | This | | | | cr | | information | | | | yptographic | | element is | | | | SDES | | present if | | | | attribute | | IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | encrypted | | | | | | and/or | | | | | | integrity | | | | | | protected | | | | | | by the | | | | | | IMS-AGW | | | | | | (NOTE 3). | | | | | | It | | | | | | indicates | | | | | | the SDES | | | | | | local | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | cr | | information | | | | yptographic | | element is | | | | SDES | | present if | | | | attribute | | IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | decrypted, | | | | | | and/or | | | | | | integrity | | | | | | checked by | | | | | | the IMS-AGW | | | | | | (NOTE 3). | | | | | | It | | | | | | indicates | | | | | | the SDES | | | | | | remote | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-----------+-------------+-------------+-------------+ | | | ECN Enable | O | This | | | | | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | ECN | | | | | | procedures. | +-------------+-----------+-------------+-------------+-------------+ | | | ECN | C | This | | | | Initiation | | information | | | | Method | | element | | | | | | specifies | | | | | | the ECN | | | | | | Initiation | | | | | | method and | | | | | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | IP header | | | | | | settings as | | | | | | an ECN | | | | | | endpoint, | | | | | | or | | | | | | indicates | | | | | | that ECN | | | | | | bits shall | | | | | | be passed | | | | | | tra | | | | | | nsparently. | | | | | | It may be | | | | | | included | | | | | | only if ECN | | | | | | is enabled. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify ECN | C | This | | | | Failure | | information | | | | Event | | element | | | | | | requests a | | | | | | n | | | | | | otification | | | | | | if a ECN | | | | | | failure | | | | | | occurs due | | | | | | to ECN. It | | | | | | may only be | | | | | | supplied if | | | | | | ECN is | | | | | | enabled and | | | | | | the IMS-AGW | | | | | | acts as ECN | | | | | | endpoint. | +-------------+-----------+-------------+-------------+-------------+ | | | Extended | O | This | | | | RTP Header | | information | | | | for CVO | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to pass on | | | | | | the CVO | | | | | | extended | | | | | | RTP header | | | | | | as defined | | | | | | by | | | | | | IETF RFC 5 | | | | | | 285 [23]. | +-------------+-----------+-------------+-------------+-------------+ | | | Extended | O | This | | | | RTP Header | | information | | | | for Sent | | element | | | | ROI | | requests | | | | | | the IMS-AGW | | | | | | to pass on | | | | | | the ROI | | | | | | extended | | | | | | RTP header | | | | | | for | | | | | | carriage of | | | | | | predefined | | | | | | and/or | | | | | | arbitrary | | | | | | ROI | | | | | | information | | | | | | as defined | | | | | | by | | | | | | IETF RFC | | | | | | 5285 [23] | | | | | | and | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | Predefined | O | This | | | | ROI | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to support | | | | | | the RTCP | | | | | | feedback | | | | | | message | | | | | | capability | | | | | | for | | | | | | \ | | | | | | "Predefined | | | | | | ROI\" type | | | | | | expressed | | | | | | by the | | | | | | parameter | | | | | | \" | | | | | | 3gpp-roi-pr | | | | | | edefined\", | | | | | | as | | | | | | described | | | | | | in | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | Arbitrary | O | This | | | | ROI | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to support | | | | | | the RTCP | | | | | | feedback | | | | | | message | | | | | | capability | | | | | | for | | | | | | \"Arbitrary | | | | | | ROI\" type | | | | | | expressed | | | | | | by the | | | | | | parameter | | | | | | \ | | | | | | "3gpp-roi-a | | | | | | rbitrary\", | | | | | | as | | | | | | described | | | | | | in | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | Generic | O | This | | | | Image | | information | | | | Attributes | | element | | | | | | indicates | | | | | | image | | | | | | attributes | | | | | | (e.g. image | | | | | | size) as | | | | | | defined by | | | | | | IETF RFC 6 | | | | | | 236 [24]. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | O | This | | | | certificate | | information | | | | fingerprint | | element is | | | | Request | | present if | | | | | | the IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | decrypted, | | | | | | and/or | | | | | | integrity | | | | | | protected | | | | | | by the | | | | | | IMS-AGW | | | | | | (NOTE 3). | | | | | | It requests | | | | | | the IMS-AGW | | | | | | to provide | | | | | | a local | | | | | | certificate | | | | | | f | | | | | | ingerprint. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | certificate | | information | | | | fingerprint | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | decrypted, | | | | | | and/or | | | | | | integrity | | | | | | checked by | | | | | | the IMS-AGW | | | | | | (NOTE 3). | | | | | | It | | | | | | indicates | | | | | | the remote | | | | | | certificate | | | | | | f | | | | | | ingerprint. | +-------------+-----------+-------------+-------------+-------------+ | | | Establish | O | This | | | | (D)TLS | | information | | | | session | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to take the | | | | | | (D)TLS | | | | | | client role | | | | | | and to | | | | | | initiate | | | | | | the | | | | | | es | | | | | | tablishment | | | | | | of the | | | | | | (D)TLS | | | | | | session. | | | | | | (NOTE 3) | +-------------+-----------+-------------+-------------+-------------+ | | | Notify | O | This | | | | (D)TLS | | information | | | | session | | element | | | | es | | requests a | | | | tablishment | | n | | | | Failure | | otification | | | | Event | | if a (D)TLS | | | | | | session | | | | | | es | | | | | | tablishment | | | | | | failure | | | | | | occurs. | | | | | | (NOTE 3) | +-------------+-----------+-------------+-------------+-------------+ | | | TCP | C | This | | | | State-aware | | information | | | | Handling | | element | | | | Indicator | | indicates | | | | and Setup | | that TCP | | | | Direction | | state-aware | | | | | | handing is | | | | | | required | | | | | | and | | | | | | indicates | | | | | | the TCP | | | | | | setup | | | | | | direction. | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-----------+-------------+-------------+-------------+ | | | Discard | C | This | | | | Incoming | | information | | | | TCP | | element | | | | Connection | | indicates | | | | Es | | whether | | | | tablishment | | incoming | | | | Requests | | TCP | | | | Indicator | | connection | | | | | | es | | | | | | tablishment | | | | | | requests | | | | | | (TCP SYN) | | | | | | shall be | | | | | | discarded. | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling | | | | | | and | | | | | | discarding | | | | | | incoming | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | requests. | +-------------+-----------+-------------+-------------+-------------+ | | | Forward | C | This | | | | Incoming | | information | | | | TCP | | element | | | | Connection | | indicates | | | | Es | | for a given | | | | tablishment | | termination | | | | Requests | | to use the | | | | Indicator | | incoming | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request | | | | | | (TCP SYN) | | | | | | at that | | | | | | termination | | | | | | as a | | | | | | trigger for | | | | | | sending a | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request at | | | | | | the | | | | | | int | | | | | | erconnected | | | | | | termination | | | | | | in the same | | | | | | context. It | | | | | | may only be | | | | | | included if | | | | | | the IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling | | | | | | and the | | | | | | Forward | | | | | | Incoming | | | | | | TCP | | | | | | Connection | | | | | | Es | | | | | | tablishment | | | | | | Requests | | | | | | Indicator. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify TCP | C | This | | | | Connection | | information | | | | Es | | element | | | | tablishment | | requests a | | | | Failure | | n | | | | Event | | otification | | | | | | if a TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | failure | | | | | | occurs. It | | | | | | may only be | | | | | | included if | | | | | | the IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-----------+-------------+-------------+-------------+ | | | STUN server | O | This | | | | request | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to answer | | | | | | STUN | | | | | | c | | | | | | onnectivity | | | | | | checks for | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | C | This | | | | C | | information | | | | onnectivity | | element | | | | Check | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | ICE | | | | | | c | | | | | | onnectivity | | | | | | check as | | | | | | defined by | | | | | | IETF RFC 8 | | | | | | 445 [82]. | | | | | | It is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify ICE | C | This | | | | C | | information | | | | onnectivity | | element | | | | Check | | requests a | | | | Result | | n | | | | | | otification | | | | | | of ICE | | | | | | c | | | | | | onnectivity | | | | | | check | | | | | | result. It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify New | C | This | | | | Peer | | information | | | | Reflexive | | element | | | | Candidate | | requests a | | | | | | n | | | | | | otification | | | | | | of new peer | | | | | | reflexive | | | | | | candidate | | | | | | was | | | | | | discovered | | | | | | during a | | | | | | c | | | | | | onnectivity | | | | | | check. It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | O | This | | | | password | | information | | | | request | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests an | | | | | | ICE | | | | | | password. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE Ufrag | O | This | | | | request | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests an | | | | | | ICE ufrag. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE host | O | This | | | | candidate | | information | | | | request | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests an | | | | | | ICE host | | | | | | candidate. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE pacing | O | This | | | | request | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests a | | | | | | pacing | | | | | | value for | | | | | | c | | | | | | onnectivity | | | | | | checks (Ta | | | | | | timer | | | | | | value). It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | candidate | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | candidate | | | | | | for ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | password | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | password | | | | | | for ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | Ufrag | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | Ufrag for | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | pacing | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | pacing | | | | | | value for | | | | | | c | | | | | | onnectivity | | | | | | checks (Ta | | | | | | timer | | | | | | value). It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. It is | | | | | | only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | MSRP Path | O | This | | | | | | information | | | | | | element is | | | | | | present for | | | | | | applic | | | | | | ation-aware | | | | | | MSRP | | | | | | In | | | | | | terworking. | | | | | | It provides | | | | | | the path | | | | | | information | | | | | | that the | | | | | | IMS-AGW | | | | | | shall | | | | | | insert in | | | | | | the MSRP | | | | | | layer | | | | | | \"Toâ€‘Path\" | | | | | | Information | | | | | | element. | +-------------+-----------+-------------+-------------+-------------+ | | | Applic | O | This | | | | ation-aware | | information | | | | MSRP | | element is | | | | i | | present if | | | | nterworking | | IMS-ALG | | | | request | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | applic | | | | | | ation-aware | | | | | | MSRP | | | | | | In | | | | | | terworking. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify STUN | O | This | | | | consent | | information | | | | freshness | | element | | | | test | | requests a | | | | failure | | n | | | | Event | | otification | | | | | | if a STUN | | | | | | consent | | | | | | freshness | | | | | | test | | | | | | failure | | | | | | occurs | | | | | | (full ICE | | | | | | only). | +-------------+-----------+-------------+-------------+-------------+ | | | STUN | O | This | | | | consent | | information | | | | freshenss | | element is | | | | test | | present if | | | | request | | eP-CSCF | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | perform a | | | | | | STUN | | | | | | consent | | | | | | freshness | | | | | | test (full | | | | | | ICE only). | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | O | This | | | | Port | | information | | | | Request | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It requests | | | | | | the IMS-AGW | | | | | | to provide | | | | | | a local | | | | | | SCTP Port. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote SCTP | O | This | | | | Port | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the remote | | | | | | SCTP port. | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | O | This | | | | maximum | | information | | | | message | | element is | | | | size | | present if | | | | Request | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It requests | | | | | | the IMS-AGW | | | | | | to provide | | | | | | a local max | | | | | | message | | | | | | size. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote SCTP | O | This | | | | maximum | | information | | | | message | | element is | | | | size | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the remote | | | | | | max message | | | | | | size. | +-------------+-----------+-------------+-------------+-------------+ | | | SCTP Group | O | This | | | | Semantics | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the H.248 | | | | | | component | | | | | | streams | | | | | | that are | | | | | | grouped in | | | | | | the same | | | | | | SCTP | | | | | | a | | | | | | ssociation. | +-------------+-----------+-------------+-------------+-------------+ | | | SCTP stream | O | This | | | | de | | information | | | | aggregation | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the H.248 | | | | | | component | | | | | | streams | | | | | | that | | | | | | transport | | | | | | media that | | | | | | are to be | | | | | | d | | | | | | eaggregated | | | | | | from the | | | | | | H.248 | | | | | | de | | | | | | aggregation | | | | | | stream used | | | | | | to control | | | | | | the SCTP | | | | | | a | | | | | | ssociation. | +-------------+-----------+-------------+-------------+-------------+ | | | SCTP stream | O | This | | | | ID | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the SCTP | | | | | | stream ID | | | | | | to be used | | | | | | for that | | | | | | data | | | | | | channel. | +-------------+-----------+-------------+-------------+-------------+ | | | Local Dcmap | O | This | | | | | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcmap\" | | | | | | attribute | | | | | | sent | | | | | | towards the | | | | | | remote | | | | | | peer, | | | | | | including | | | | | | the | | | | | | Subprotocol | | | | | | to exchange | | | | | | via the | | | | | | data | | | | | | channel. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Dcmap | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcmap\" | | | | | | attribute | | | | | | received | | | | | | from the | | | | | | remote | | | | | | peer, | | | | | | including | | | | | | the | | | | | | Subprotocol | | | | | | to exchange | | | | | | via the | | | | | | data | | | | | | channel. | +-------------+-----------+-------------+-------------+-------------+ | | | Local Dcsa | O | This | | | | | | information | | | | | | element can | | | | | | be present | | | | | | if the | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel and | | | | | | to handle | | | | | | its | | | | | | contents in | | | | | | an | | | | | | applic | | | | | | ation-aware | | | | | | manner. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcsa\" | | | | | | attribute | | | | | | sent | | | | | | towards the | | | | | | remote | | | | | | peer, | | | | | | en | | | | | | capsulating | | | | | | a | | | | | | subprotocol | | | | | | specific | | | | | | SDP | | | | | | attribute. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote Dcsa | O | This | | | | | | information | | | | | | element can | | | | | | be present | | | | | | if the | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel and | | | | | | to handle | | | | | | its | | | | | | contents in | | | | | | an | | | | | | applic | | | | | | ation-aware | | | | | | manner. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcsa\" | | | | | | attribute | | | | | | received | | | | | | from the | | | | | | remote | | | | | | peer, | | | | | | en | | | | | | capsulating | | | | | | a | | | | | | subprotocol | | | | | | specific | | | | | | SDP | | | | | | attribute. | +-------------+-----------+-------------+-------------+-------------+ | | | Received | O | This | | | | SCTP Stream | | information | | | | Reset | | element is | | | | Request | | present if | | | | | | the eP-CSCF | | | | | | (IMS-ALG) | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | provide a | | | | | | n | | | | | | otification | | | | | | when | | | | | | receiving | | | | | | an SCTP | | | | | | Stream | | | | | | reset | | | | | | request and | | | | | | to | | | | | | a | | | | | | utonomously | | | | | | answer that | | | | | | SCTP Stream | | | | | | reset | | | | | | request | +-------------+-----------+-------------+-------------+-------------+ | | | Allowed | O | This | | | | RTCP APP | | information | | | | message | | element is | | | | types | | present if | | | | | | IMS-ALG | | | | | | allows the | | | | | | IMS-AGW to | | | | | | send RTCP | | | | | | APP packets | | | | | | of the | | | | | | indicated | | | | | | types. The | | | | | | IMS-AGW | | | | | | shall not | | | | | | send other | | | | | | RTCP APP | | | | | | packets. If | | | | | | the | | | | | | parameter | | | | | | is not | | | | | | supplied, | | | | | | the IMS-AGW | | | | | | shall not | | | | | | send any | | | | | | RTCP APP | | | | | | packets. | +-------------+-----------+-------------+-------------+-------------+ | | | SDPCapNeg | O | This | | | | co | | information | | | | nfiguration | | element | | | | | | provides | | | | | | SDPCapNeg | | | | | | confi | | | | | | guration(s) | | | | | | using as | | | | | | \"a=acap\", | | | | | | \"a=tcap\", | | | | | | \"a=pcfg\" | | | | | | and | | | | | | \"a=acfg\" | | | | | | SDP | | | | | | attributes. | +-------------+-----------+-------------+-------------+-------------+ | | | Additional | O | This | | | | Bandwidth | | information | | | | Properties | | element | | | | | | indicates | | | | | | additional | | | | | | bandwidth | | | | | | properties | | | | | | using | | | | | | \" | | | | | | a=bw-info\" | | | | | | SDP | | | | | | a | | | | | | ttribute(s) | | | | | | as defined | | | | | | by | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | CCM BASE | O | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive and | | | | | | is allowed | | | | | | to send, | | | | | | re | | | | | | spectively, | | | | | | the RTCP | | | | | | feedback | | | | | | \"CCM FIR\" | | | | | | and/or | | | | | | \"CCM | | | | | | TMMBR\" | | | | | | messages | | | | | | (defined in | | | | | | IETF RFC 51 | | | | | | 04 [78]). | +-------------+-----------+-------------+-------------+-------------+ | | | CCM | O | This | | | | p | | information | | | | ause-resume | | element | | | | | | indicates | | | | | | to the | | | | | | IMS-AGW | | | | | | that RTCP | | | | | | feedback | | | | | | \"CCM | | | | | | PAU | | | | | | SE-RESUME\" | | | | | | messages | | | | | | shall be | | | | | | passed | | | | | | tra | | | | | | nsparently. | +-------------+-----------+-------------+-------------+-------------+ | | | DBI | O | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | to the | | | | | | IMS-AGW | | | | | | that RTCP | | | | | | DBI | | | | | | feedback | | | | | | messages | | | | | | (as defined | | | | | | in | | | | | | 3GPP TS 26 | | | | | | .114 [21] | | | | | | cl | | | | | | ause 7.3.8) | | | | | | shall be | | | | | | passed | | | | | | tra | | | | | | nsparently. | +-------------+-----------+-------------+-------------+-------------+ | Reserve and | IMS-AGW | Context | M | This | | Configure | | | | information | | AGW | | | | element | | Connection | | | | indicates | | Point Ack | | | | the context | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Bearer | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the bearer | | | | | | termination | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Local IP | C | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive | | | | | | user data. | | | | | | This IE | | | | | | shall be | | | | | | present if | | | | | | it was | | | | | | contained | | | | | | in the | | | | | | request. If | | | | | | the IE was | | | | | | not | | | | | | contained | | | | | | in the | | | | | | request, it | | | | | | may be | | | | | | present in | | | | | | the reply. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall send | | | | | | data. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | M | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the IP | | | | | | address and | | | | | | port | | | | | | number(s) | | | | | | the IMS-AGW | | | | | | shall | | | | | | receive | | | | | | user plane | | | | | | data from | | | | | | IMS. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the remote | | | | | | IP address | | | | | | and port | | | | | | number(s) | | | | | | that the | | | | | | IMS-AGW can | | | | | | send user | | | | | | plane data | | | | | | to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | C | This | | | | cr | | information | | | | yptographic | | element may | | | | SDES | | be present | | | | attribute | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the SDES | | | | | | local | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | cr | | information | | | | yptographic | | element may | | | | SDES | | be present | | | | attribute | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the SDES | | | | | | remote | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-----------+-------------+-------------+-------------+ | | | Local | C | This | | | | certificate | | information | | | | fingerprint | | element may | | | | | | be present | | | | | | only if the | | | | | | Local | | | | | | certificate | | | | | | fingerprint | | | | | | Request was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the local | | | | | | certificate | | | | | | f | | | | | | ingerprint. | | | | | | (NOTE 3) | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | C | This | | | | password | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the ICE | | | | | | password | | | | | | assigned by | | | | | | the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE Ufrag | C | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the ICE | | | | | | Ufrag | | | | | | assigned by | | | | | | the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE host | C | This | | | | candidate | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the ICE | | | | | | host | | | | | | candidate | | | | | | assigned by | | | | | | the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE pacing | C | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates a | | | | | | desired | | | | | | pacing | | | | | | value for | | | | | | c | | | | | | onnectivity | | | | | | checks (Ta | | | | | | timer | | | | | | value). | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | C | This | | | | Port | | information | | | | | | element may | | | | | | be present | | | | | | only if the | | | | | | Local SCTP | | | | | | Port | | | | | | Request was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the local | | | | | | SCTP Port. | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | C | This | | | | maximum | | information | | | | message | | element may | | | | size | | be present | | | | | | only if the | | | | | | Local max | | | | | | message | | | | | | size | | | | | | Request was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the local | | | | | | max message | | | | | | size. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE lite | C | This | | | | indication | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if an | | | | | | ICE host | | | | | | candidate | | | | | | request was | | | | | | contained | | | | | | in the | | | | | | request, | | | | | | and the | | | | | | IMS-AGW | | | | | | supports | | | | | | ICE lite, | | | | | | but not | | | | | | full ICE. | | | | | | It | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | only | | | | | | supports | | | | | | ICE lite. | +-------------+-----------+-------------+-------------+-------------+ | | | SDPCapNeg | C | This | | | | co | | information | | | | nfiguration | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | provides | | | | | | SDPCapNeg | | | | | | confi | | | | | | guration(s) | | | | | | using as | | | | | | \"a=acap\", | | | | | | \"a=tcap\", | | | | | | \"a=pcfg\" | | | | | | and | | | | | | \"a=acfg\" | | | | | | SDP | | | | | | attributes. | +-------------+-----------+-------------+-------------+-------------+ | NOTE 1: | | | | | | Remote | | | | | | Source Port | | | | | | and Remote | | | | | | Source Port | | | | | | Range are | | | | | | mutually | | | | | | exclusive. | | | | | | | | | | | | NOTE 2: One | | | | | | of those | | | | | | IEs shall | | | | | | at least be | | | | | | present | | | | | | when | | | | | | policing is | | | | | | required. | | | | | | | | | | | | NOTE 3: | | | | | | This IE may | | | | | | only be | | | | | | present for | | | | | | access | | | | | | network | | | | | | te | | | | | | rminations. | | | | | | | | | | | | NOTE 4: The | | | | | | concerned | | | | | | RTCP | | | | | | resource | | | | | | component | | | | | | is related | | | | | | to the RTCP | | | | | | port value. | | | | | +-------------+-----------+-------------+-------------+-------------+
## 8.3 Reserve AGW Connection Point Procedure
This procedure is used to reserve local connection addresses and local
resources in IMS-AGW.
Table 8.3.1: Procedures between IMS-ALG and IMS-AGW: Reserve AGW Connection
Point
+-------------+-----------+-------------+-------------+-------------+ | Procedure | Initiated | Information | Information | ** | | | | element | element | Information | | | | name | required | element | | | | | | de | | | | | | scription** | +-------------+-----------+-------------+-------------+-------------+ | Reserve AGW | IMS-ALG | Context | M | This | | Connection | | /Context | | information | | Point | | Request | | element | | | | | | indicates | | | | | | the | | | | | | existing | | | | | | context or | | | | | | requests a | | | | | | new context | | | | | | for the | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | Emergency | O | This | | | | Call | | information | | | | Indicator | | element | | | | | | identifies | | | | | | the call as | | | | | | emergency | | | | | | call that | | | | | | requires a | | | | | | p | | | | | | referential | | | | | | handling. | +-------------+-----------+-------------+-------------+-------------+ | | | Priority | O | This | | | | information | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | priority | | | | | | treatment | | | | | | for the | | | | | | t | | | | | | erminations | | | | | | and bearer | | | | | | connections | | | | | | in the | | | | | | specified | | | | | | context. | +-------------+-----------+-------------+-------------+-------------+ | | | Bearer | M | This | | | | Termination | | information | | | | Request | | element | | | | | | requests a | | | | | | new bearer | | | | | | termination | +-------------+-----------+-------------+-------------+-------------+ | | | Local IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive | | | | | | user data. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | | | | | | | | | | | | May be | | | | | | excluded | | | | | | (i.e. \"-\" | | | | | | is used in | | | | | | SDP m-line) | | | | | | if no | | | | | | transcoding | | | | | | or media | | | | | | related | | | | | | functions | | | | | | are | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | R | O | This | | | | eserveValue | | information | | | | | | element | | | | | | indicates | | | | | | if multiple | | | | | | local | | | | | | resources | | | | | | are to be | | | | | | reserved. | | | | | | | | | | | | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | included if | | | | | | a speech | | | | | | codec and | | | | | | auxiliary | | | | | | payload | | | | | | types are | | | | | | configured. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | M | This | | | | Connection | | information | | | | Address | | element | | | | Request | | requests an | | | | | | IP address | | | | | | and port | | | | | | number(s) | | | | | | on the | | | | | | IMS-AGW | | | | | | that the | | | | | | remote end | | | | | | can send | | | | | | user plane | | | | | | data to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify | M | This | | | | termination | | information | | | | heartbeat | | element | | | | | | requests | | | | | | termination | | | | | | heartbeat | | | | | | i | | | | | | ndications. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify | O | This | | | | Released | | information | | | | Bearer | | element | | | | | | requests a | | | | | | n | | | | | | otification | | | | | | of a | | | | | | released | | | | | | bearer. | +-------------+-----------+-------------+-------------+-------------+ | | | Latching | O | This | | | | Requirement | | information | | | | | | element | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | should | | | | | | (re)latch | | | | | | onto the | | | | | | address of | | | | | | received | | | | | | media | | | | | | packets to | | | | | | determine | | | | | | the | | | | | | co | | | | | | rresponding | | | | | | destination | | | | | | address. | +-------------+-----------+-------------+-------------+-------------+ | | | IP Realm | O | This | | | | Identifier | | information | | | | | | element | | | | | | indicates | | | | | | the IP | | | | | | realm of | | | | | | the bearer | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Source | | information | | | | Address | | element | | | | Filtering | | indicates | | | | | | that remote | | | | | | source | | | | | | address | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source | | information | | | | Address | | element | | | | Mask | | provides | | | | | | information | | | | | | on the | | | | | | valid | | | | | | remote | | | | | | source | | | | | | addresses. | | | | | | This is | | | | | | required if | | | | | | a range of | | | | | | remote | | | | | | source | | | | | | address | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Source Port | | information | | | | Filtering | | element | | | | | | indicates | | | | | | that remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source Port | | information | | | | | | element | | | | | | identifies | | | | | | the valid | | | | | | remote | | | | | | source | | | | | | port. This | | | | | | may be | | | | | | included if | | | | | | remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | included. | | | | | | (NOTE 1) | +-------------+-----------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source Port | | information | | | | Range | | element | | | | | | identifies | | | | | | a range of | | | | | | valid | | | | | | remote | | | | | | source | | | | | | ports. This | | | | | | may be | | | | | | included if | | | | | | remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | included. | | | | | | (NOTE 1) | +-------------+-----------+-------------+-------------+-------------+ | | | Policing | O | This | | | | Required | | information | | | | | | element | | | | | | indicates | | | | | | that | | | | | | policing of | | | | | | the media | | | | | | flow is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Peak Data | O | This | | | | Rate | | information | | | | | | element may | | | | | | be present | | | | | | if Policing | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | permissible | | | | | | peak data | | | | | | rate for a | | | | | | media | | | | | | stream. | | | | | | (NOTE 2). | +-------------+-----------+-------------+-------------+-------------+ | | | Sustainable | O | This | | | | Data Rate | | information | | | | | | element may | | | | | | be present | | | | | | if Policing | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | permissible | | | | | | sustainable | | | | | | data rate | | | | | | for a media | | | | | | stream. | | | | | | (NOTE 2). | +-------------+-----------+-------------+-------------+-------------+ | | | Delay | O | This | | | | Variation | | information | | | | Tolerance | | element may | | | | | | be present | | | | | | if Policing | | | | | | on Peak | | | | | | Data Rate | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the maximum | | | | | | expected | | | | | | delay | | | | | | variation | | | | | | tolerance | | | | | | for the | | | | | | co | | | | | | rresponding | | | | | | media | | | | | | stream. | +-------------+-----------+-------------+-------------+-------------+ | | | Maximum | C | This | | | | Burst Size | | information | | | | | | element | | | | | | shall be | | | | | | present if | | | | | | Policing on | | | | | | Sustainable | | | | | | Data Rate | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the maximum | | | | | | expected | | | | | | burst size | | | | | | for the | | | | | | co | | | | | | rresponding | | | | | | media | | | | | | stream. | +-------------+-----------+-------------+-------------+-------------+ | | | DiffServ | O | This | | | | Code Point | | information | | | | | | element | | | | | | indicates a | | | | | | specific | | | | | | DiffServ | | | | | | code point | | | | | | to be used | | | | | | in the IP | | | | | | header in | | | | | | packets | | | | | | sent on the | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | DiffServ | O | This | | | | Tagging | | information | | | | Behaviour | | element | | | | | | indicates | | | | | | whether the | | | | | | Diffserv | | | | | | code point | | | | | | in the IP | | | | | | header in | | | | | | packets | | | | | | sent on the | | | | | | bearer | | | | | | termination | | | | | | should be | | | | | | copied from | | | | | | the | | | | | | received | | | | | | value or | | | | | | set to a | | | | | | specific | | | | | | value. | +-------------+-----------+-------------+-------------+-------------+ | | | Media | O | This | | | | Inactivity | | information | | | | Detection | | element | | | | Required | | indicates | | | | | | that | | | | | | detection | | | | | | of inactive | | | | | | media flows | | | | | | is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Media | C | This | | | | Inactivity | | information | | | | Detection | | element may | | | | Time | | be present | | | | | | if Inactive | | | | | | Media | | | | | | Detection | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | Inactivity | | | | | | Detection | | | | | | time. | +-------------+-----------+-------------+-------------+-------------+ | | | Media | C | This | | | | Inactivity | | information | | | | Detection | | element may | | | | Direction | | be present | | | | | | if Inactive | | | | | | Media | | | | | | Detection | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | Inactivity | | | | | | Detection | | | | | | direction. | +-------------+-----------+-------------+-------------+-------------+ | | | RTCP | O | This | | | | handling | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | wants | | | | | | explicitly | | | | | | control the | | | | | | reservation | | | | | | of RTCP | | | | | | resources | | | | | | by the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | RTP/RTCP | C | This | | | | transport | | information | | | | m | | element | | | | ultiplexing | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | the | | | | | | RTP/RTCP | | | | | | transport | | | | | | mu | | | | | | ltiplexing. | | | | | | This | | | | | | information | | | | | | element may | | | | | | only be | | | | | | present if | | | | | | RTCP | | | | | | handling is | | | | | | required. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | C | This | | | | cr | | information | | | | yptographic | | element is | | | | SDES | | present if | | | | attribute | | IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | encrypted | | | | | | and/or | | | | | | integrity | | | | | | protected | | | | | | by the | | | | | | IMS-AGW | | | | | | (NOTE 3). | | | | | | It | | | | | | indicates | | | | | | the SDES | | | | | | local | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s). | +-------------+-----------+-------------+-------------+-------------+ | | | ECN Enable | O | This | | | | | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | ECN | | | | | | procedures. | +-------------+-----------+-------------+-------------+-------------+ | | | ECN | C | This | | | | Initiation | | information | | | | Method | | element | | | | | | specifies | | | | | | the ECN | | | | | | Initiation | | | | | | method and | | | | | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | IP header | | | | | | settings as | | | | | | an ECN | | | | | | endpoint, | | | | | | or | | | | | | indicates | | | | | | that ECN | | | | | | bits shall | | | | | | be passed | | | | | | tra | | | | | | nsparently. | | | | | | It may be | | | | | | included | | | | | | only if ECN | | | | | | is enabled. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify ECN | C | This | | | | Failure | | information | | | | Event | | element | | | | | | requests a | | | | | | n | | | | | | otification | | | | | | if a ECN | | | | | | failure | | | | | | occurs due | | | | | | to ECN. It | | | | | | may only be | | | | | | supplied if | | | | | | ECN is | | | | | | enabled and | | | | | | the IMS-AGW | | | | | | acts as ECN | | | | | | endpoint. | +-------------+-----------+-------------+-------------+-------------+ | | | Extended | O | This | | | | RTP Header | | information | | | | for CVO | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to pass on | | | | | | the CVO | | | | | | extended | | | | | | RTP header | | | | | | as defined | | | | | | by | | | | | | IETF RFC 5 | | | | | | 285 [23]. | +-------------+-----------+-------------+-------------+-------------+ | | | Extended | O | This | | | | RTP Header | | information | | | | for Sent | | element | | | | ROI | | requests | | | | | | the IMS-AGW | | | | | | to pass on | | | | | | the ROI | | | | | | extended | | | | | | RTP header | | | | | | for | | | | | | carriage of | | | | | | predefined | | | | | | and/or | | | | | | arbitrary | | | | | | ROI | | | | | | information | | | | | | as defined | | | | | | by | | | | | | IETF RFC | | | | | | 5285 [23] | | | | | | and | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | Predefined | O | This | | | | ROI | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to support | | | | | | the RTCP | | | | | | feedback | | | | | | message | | | | | | capability | | | | | | for | | | | | | \ | | | | | | "Predefined | | | | | | ROI\" type | | | | | | expressed | | | | | | by the | | | | | | parameter | | | | | | \" | | | | | | 3gpp-roi-pr | | | | | | edefined\", | | | | | | as | | | | | | described | | | | | | in | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | Arbitrary | O | This | | | | ROI | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to support | | | | | | the RTCP | | | | | | feedback | | | | | | message | | | | | | capability | | | | | | for | | | | | | \"Arbitrary | | | | | | ROI\" type | | | | | | expressed | | | | | | by the | | | | | | parameter | | | | | | \ | | | | | | "3gpp-roi-a | | | | | | rbitrary\", | | | | | | as | | | | | | described | | | | | | in | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-----------+-------------+-------------+-------------+ | | | Generic | O | This | | | | Image | | information | | | | Attributes | | element | | | | | | indicates | | | | | | image | | | | | | attributes | | | | | | (e.g. image | | | | | | size) as | | | | | | defined by | | | | | | IETF RFC 6 | | | | | | 236 [24]. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | O | This | | | | certificate | | information | | | | fingerprint | | element is | | | | Request | | present if | | | | | | the IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | decrypted, | | | | | | and/or | | | | | | integrity | | | | | | protected | | | | | | by the | | | | | | IMS-AGW | | | | | | (NOTE 4). | | | | | | It requests | | | | | | the IMS-AGW | | | | | | to provide | | | | | | a local | | | | | | certificate | | | | | | f | | | | | | ingerprint. | +-------------+-----------+-------------+-------------+-------------+ | | | Establish | O | This | | | | (D)TLS | | information | | | | session | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to take the | | | | | | (D)TLS | | | | | | client role | | | | | | and to | | | | | | initiate | | | | | | the | | | | | | es | | | | | | tablishment | | | | | | of the | | | | | | (D)TLS | | | | | | session. | | | | | | (NOTE 4) | +-------------+-----------+-------------+-------------+-------------+ | | | Notify | O | This | | | | (D)TLS | | information | | | | session | | element | | | | es | | requests a | | | | tablishment | | n | | | | Failure | | otification | | | | Event | | if a (D)TLS | | | | | | session | | | | | | es | | | | | | tablishment | | | | | | failure | | | | | | occurs. | | | | | | (NOTE 4) | +-------------+-----------+-------------+-------------+-------------+ | | | TCP | C | This | | | | State-aware | | information | | | | Handling | | element | | | | Indicator | | indicates | | | | and Setup | | that TCP | | | | Direction | | state-aware | | | | | | handing is | | | | | | required | | | | | | and | | | | | | indicates | | | | | | the TCP | | | | | | setup | | | | | | direction. | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-----------+-------------+-------------+-------------+ | | | Discard | C | This | | | | Incoming | | information | | | | TCP | | element | | | | Connection | | indicates | | | | Es | | whether | | | | tablishment | | incoming | | | | Requests | | TCP | | | | Indicator | | connection | | | | | | es | | | | | | tablishment | | | | | | requests | | | | | | (TCP SYN) | | | | | | shall be | | | | | | discarded. | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling | | | | | | and | | | | | | discarding | | | | | | incoming | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | requests. | +-------------+-----------+-------------+-------------+-------------+ | | | Forward | C | This | | | | Incoming | | information | | | | TCP | | element | | | | Connection | | indicates | | | | Es | | for a given | | | | tablishment | | termination | | | | Requests | | to use the | | | | Indicator | | incoming | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request | | | | | | (TCP SYN) | | | | | | at that | | | | | | termination | | | | | | as a | | | | | | trigger for | | | | | | sending a | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request at | | | | | | the | | | | | | int | | | | | | erconnected | | | | | | termination | | | | | | in the same | | | | | | context. It | | | | | | may only be | | | | | | included if | | | | | | the IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling | | | | | | and the | | | | | | Forward | | | | | | Incoming | | | | | | TCP | | | | | | Connection | | | | | | Es | | | | | | tablishment | | | | | | Requests | | | | | | Indicator. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify TCP | C | This | | | | Connection | | information | | | | Es | | element | | | | tablishment | | requests a | | | | Failure | | n | | | | Event | | otification | | | | | | if a TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | failure | | | | | | occurs. It | | | | | | may only be | | | | | | included if | | | | | | the IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | O | This | | | | password | | information | | | | request | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests an | | | | | | ICE | | | | | | password. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE Ufrag | O | This | | | | request | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests an | | | | | | ICE ufrag. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE host | O | This | | | | candidate | | information | | | | request | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests an | | | | | | ICE host | | | | | | candidate. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE pacing | O | This | | | | request | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests a | | | | | | pacing | | | | | | value for | | | | | | c | | | | | | onnectivity | | | | | | checks (Ta | | | | | | timer | | | | | | value). It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | STUN server | O | This | | | | request | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to answer | | | | | | STUN | | | | | | c | | | | | | onnectivity | | | | | | checks for | | | | | | ICE. | +-------------+-----------+-------------+-------------+-------------+ | | | Applic | O | This | | | | ation-aware | | information | | | | MSRP | | element is | | | | i | | present if | | | | nterworking | | IMS-ALG | | | | request | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | applic | | | | | | ation-aware | | | | | | MSRP | | | | | | In | | | | | | terworking. | +-------------+-----------+-------------+-------------+-------------+ | | | Notify STUN | O | This | | | | consent | | information | | | | freshness | | element | | | | test | | requests a | | | | failure | | n | | | | Event | | otification | | | | | | if a STUN | | | | | | consent | | | | | | freshness | | | | | | test | | | | | | failure | | | | | | occurs | | | | | | (full ICE | | | | | | only). | +-------------+-----------+-------------+-------------+-------------+ | | | STUN | O | This | | | | consent | | information | | | | freshenss | | element is | | | | test | | present if | | | | request | | eP-CSCF | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | perform a | | | | | | STUN | | | | | | consent | | | | | | freshness | | | | | | test (full | | | | | | ICE only). | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | O | This | | | | Port | | information | | | | Request | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It requests | | | | | | the IMS-AGW | | | | | | to provide | | | | | | a local | | | | | | SCTP Port. | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | O | This | | | | maximum | | information | | | | message | | element is | | | | size | | present if | | | | Request | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It requests | | | | | | the IMS-AGW | | | | | | to provide | | | | | | a local max | | | | | | message | | | | | | size. | +-------------+-----------+-------------+-------------+-------------+ | | | Local Dcmap | O | This | | | | | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcmap\" | | | | | | attribute | | | | | | sent | | | | | | towards the | | | | | | remote | | | | | | peer, | | | | | | including | | | | | | the | | | | | | Subprotocol | | | | | | to exchange | | | | | | via the | | | | | | data | | | | | | channel. | +-------------+-----------+-------------+-------------+-------------+ | | | Local Dcsa | O | This | | | | | | information | | | | | | element can | | | | | | be present | | | | | | if the | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel and | | | | | | to handle | | | | | | its | | | | | | contents in | | | | | | an | | | | | | applic | | | | | | ation-aware | | | | | | manner. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcsa\" | | | | | | attribute | | | | | | sent | | | | | | towards the | | | | | | remote | | | | | | peer, | | | | | | en | | | | | | capsulating | | | | | | a | | | | | | subprotocol | | | | | | specific | | | | | | SDP | | | | | | attribute. | +-------------+-----------+-------------+-------------+-------------+ | | | SCTP Group | O | This | | | | Semantics | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the H.248 | | | | | | component | | | | | | streams | | | | | | that are | | | | | | grouped in | | | | | | the same | | | | | | SCTP | | | | | | a | | | | | | ssociation. | +-------------+-----------+-------------+-------------+-------------+ | | | SCTP stream | O | This | | | | de | | information | | | | aggregation | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the H.248 | | | | | | component | | | | | | streams | | | | | | that | | | | | | transport | | | | | | media that | | | | | | are to be | | | | | | d | | | | | | eaggregated | | | | | | from the | | | | | | H.248 | | | | | | de | | | | | | aggregation | | | | | | stream used | | | | | | to control | | | | | | the SCTP | | | | | | a | | | | | | ssociation. | +-------------+-----------+-------------+-------------+-------------+ | | | SCTP stream | O | This | | | | ID | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the SCTP | | | | | | stream ID | | | | | | to be used | | | | | | for that | | | | | | data | | | | | | channel. | +-------------+-----------+-------------+-------------+-------------+ | | | Received | O | This | | | | SCTP Stream | | information | | | | Reset | | element is | | | | Request | | present if | | | | | | the eP-CSCF | | | | | | (IMS-ALG) | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | provide a | | | | | | n | | | | | | otification | | | | | | when | | | | | | receiving | | | | | | an SCTP | | | | | | Stream | | | | | | reset | | | | | | request and | | | | | | to | | | | | | a | | | | | | utonomously | | | | | | answer that | | | | | | SCTP Stream | | | | | | reset | | | | | | request | +-------------+-----------+-------------+-------------+-------------+ | | | SDPCapNeg | O | This | | | | co | | information | | | | nfiguration | | element | | | | | | provides | | | | | | SDPCapNeg | | | | | | confi | | | | | | guration(s) | | | | | | using as | | | | | | \"a=acap\", | | | | | | \"a=tcap\", | | | | | | \"a=pcfg\" | | | | | | and | | | | | | \"a=acfg\" | | | | | | SDP | | | | | | attributes. | +-------------+-----------+-------------+-------------+-------------+ | Reserve AGW | IMS-AGW | Context | M | This | | Connection | | | | information | | Point Ack | | | | element | | | | | | indicates | | | | | | the context | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Bearer | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the bearer | | | | | | termination | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Local IP | C | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive | | | | | | user data. | | | | | | This IE | | | | | | shall be | | | | | | present if | | | | | | it was | | | | | | contained | | | | | | in the | | | | | | request. If | | | | | | the IE was | | | | | | not | | | | | | contained | | | | | | in the | | | | | | request, it | | | | | | may be | | | | | | present in | | | | | | the reply. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | M | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the IP | | | | | | address and | | | | | | port | | | | | | number(s) | | | | | | the IMS-AGW | | | | | | shall | | | | | | receive | | | | | | user plane | | | | | | data from | | | | | | IMS. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-----------+-------------+-------------+-------------+ | | | Local | C | This | | | | cr | | information | | | | yptographic | | element may | | | | SDES | | be present | | | | attribute | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the SDES | | | | | | local | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-----------+-------------+-------------+-------------+ | | | Local | C | This | | | | certificate | | information | | | | fingerprint | | element may | | | | | | be present | | | | | | only if the | | | | | | Local | | | | | | certificate | | | | | | fingerprint | | | | | | Request was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the local | | | | | | certificate | | | | | | f | | | | | | ingerprint. | | | | | | (NOTE 4) | +-------------+-----------+-------------+-------------+-------------+ | | | ICE | C | This | | | | password | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the ICE | | | | | | password | | | | | | assigned by | | | | | | the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE Ufrag | C | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the ICE | | | | | | Ufrag | | | | | | assigned by | | | | | | the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE host | C | This | | | | candidate | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the ICE | | | | | | host | | | | | | candidate | | | | | | assigned by | | | | | | the | | | | | | IMS-AGW. | +-------------+-----------+-------------+-------------+-------------+ | | | ICE pacing | C | This | | | | | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates a | | | | | | desired | | | | | | pacing | | | | | | value for | | | | | | c | | | | | | onnectivity | | | | | | checks (Ta | | | | | | timer | | | | | | value). | +-------------+-----------+-------------+-------------+-------------+ | | | ICE lite | C | This | | | | indication | | information | | | | | | element | | | | | | shall be | | | | | | present | | | | | | only if an | | | | | | ICE host | | | | | | candidate | | | | | | request was | | | | | | contained | | | | | | in the | | | | | | request, | | | | | | and the | | | | | | IMS-AGW | | | | | | supports | | | | | | ICE lite, | | | | | | but not | | | | | | full ICE. | | | | | | It | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | only | | | | | | supports | | | | | | ICE lite. | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | C | This | | | | Port | | information | | | | | | element may | | | | | | be present | | | | | | only if the | | | | | | Local SCTP | | | | | | Port | | | | | | Request was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the local | | | | | | SCTP Port. | +-------------+-----------+-------------+-------------+-------------+ | | | Local SCTP | C | This | | | | maximum | | information | | | | message | | element may | | | | size | | be present | | | | | | only if the | | | | | | Local max | | | | | | message | | | | | | size | | | | | | Request was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the local | | | | | | max message | | | | | | size. | +-------------+-----------+-------------+-------------+-------------+ | | | SDPCapNeg | C | This | | | | co | | information | | | | nfiguration | | element | | | | | | shall be | | | | | | present | | | | | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | provides | | | | | | SDPCapNeg | | | | | | confi | | | | | | guration(s) | | | | | | using as | | | | | | \"a=acap\", | | | | | | \"a=tcap\", | | | | | | \"a=pcfg\" | | | | | | and | | | | | | \"a=acfg\" | | | | | | SDP | | | | | | attributes. | +-------------+-----------+-------------+-------------+-------------+ | NOTE 1: | | | | | | Remote | | | | | | Source Port | | | | | | and Remote | | | | | | Source Port | | | | | | Range are | | | | | | mutually | | | | | | exclusive. | | | | | | | | | | | | NOTE 2: One | | | | | | of those | | | | | | IEs shall | | | | | | at least be | | | | | | present | | | | | | when | | | | | | policing is | | | | | | required. | | | | | | | | | | | | NOTE 3: | | | | | | This IE may | | | | | | only be | | | | | | present for | | | | | | access | | | | | | network | | | | | | te | | | | | | rminations, | | | | | | and only if | | | | | | the IMS-ALG | | | | | | includes | | | | | | only one | | | | | | SDES crypto | | | | | | attribute | | | | | | in the SDP | | | | | | sent | | | | | | towards the | | | | | | served UE. | | | | | | | | | | | | NOTE 4: | | | | | | This IE may | | | | | | only be | | | | | | present for | | | | | | access | | | | | | network | | | | | | te | | | | | | rminations. | | | | | +-------------+-----------+-------------+-------------+-------------+
## 8.4 Configure AGW Connection Point Procedure
This procedure is used to select or modify multimedia-processing resources for
the Iq interface connection.
Table 8.4.1: Procedures between IMS-ALG and IMS-AGW: Configure AGW Connection
Point
+-------------+-------------+-------------+-------------+-------------+ | ** | ** | ** | ** | ** | | Procedure**| Initiated** | Information | Information | Information | | | | element | element | element | | | | name**| required** | de | | | | | | scription** | +-------------+-------------+-------------+-------------+-------------+ | Configure | IMS-ALG | Context | M | This | | AGW | | | | information | | Connection | | | | element | | Point | | | | indicates | | | | | | the context | | | | | | for the | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-------------+-------------+-------------+-------------+ | | | Priority | O | This | | | | information | | information | | | | | | element | | | | | | shall be | | | | | | present if | | | | | | the | | | | | | priority | | | | | | information | | | | | | needs to be | | | | | | modified, | | | | | | it may be | | | | | | present | | | | | | otherwise. | +-------------+-------------+-------------+-------------+-------------+ | | | Bearer | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | existing | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-------------+-------------+-------------+-------------+ | | | Local IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive | | | | | | user data. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | | | | | | | | | | | | May be | | | | | | excluded | | | | | | (i.e. \"-\" | | | | | | is used in | | | | | | SDP m-line) | | | | | | if no | | | | | | transcoding | | | | | | or media | | | | | | related | | | | | | functions | | | | | | are | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall send | | | | | | data. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | | | | | | | | | | | | May be | | | | | | excluded | | | | | | (i.e. \"-\" | | | | | | is used in | | | | | | SDP m-line) | | | | | | if no | | | | | | transcoding | | | | | | or media | | | | | | related | | | | | | functions | | | | | | are | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Local | O | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the IP | | | | | | address and | | | | | | port | | | | | | number(s) | | | | | | on the | | | | | | IMS-AGW | | | | | | that the | | | | | | IMS user | | | | | | can send | | | | | | user plane | | | | | | data to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | video any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | may contain | | | | | | multiple | | | | | | addresses. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the remote | | | | | | IP address | | | | | | and port | | | | | | number(s) | | | | | | that the | | | | | | IMS-AGW can | | | | | | send user | | | | | | plane data | | | | | | to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-------------+-------------+-------------+-------------+ | | | Latching | O | This | | | | Requirement | | information | | | | | | element | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | should | | | | | | (re)latch | | | | | | onto the | | | | | | address of | | | | | | received | | | | | | media | | | | | | packets to | | | | | | determine | | | | | | the | | | | | | co | | | | | | rresponding | | | | | | destination | | | | | | address. | +-------------+-------------+-------------+-------------+-------------+ | | | IP Realm | O | This | | | | Identifier | | information | | | | | | element | | | | | | indicates | | | | | | the IP | | | | | | realm of | | | | | | the bearer | | | | | | t | | | | | | ermination. | | | | | | (NOTE 3) | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Source | | information | | | | Address | | element | | | | Filtering | | indicates | | | | | | that remote | | | | | | source | | | | | | address | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source | | information | | | | Address | | element | | | | Mask | | provides | | | | | | information | | | | | | on the | | | | | | valid | | | | | | remote | | | | | | source | | | | | | addresses. | | | | | | This is | | | | | | required if | | | | | | a range of | | | | | | remote | | | | | | source | | | | | | address | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Source Port | | information | | | | Filtering | | element | | | | | | indicates | | | | | | that remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source Port | | information | | | | | | element | | | | | | identifies | | | | | | the valid | | | | | | remote | | | | | | source | | | | | | port. This | | | | | | may be | | | | | | included if | | | | | | remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | included. | | | | | | (NOTE 1) | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | C | This | | | | Source Port | | information | | | | Range | | element | | | | | | identifies | | | | | | a range of | | | | | | valid | | | | | | remote | | | | | | source | | | | | | ports. This | | | | | | may be | | | | | | included if | | | | | | remote | | | | | | source port | | | | | | filtering | | | | | | is | | | | | | included. | | | | | | (NOTE 1) | +-------------+-------------+-------------+-------------+-------------+ | | | Policing | O | This | | | | Required | | information | | | | | | element | | | | | | indicates | | | | | | that | | | | | | policing of | | | | | | the media | | | | | | flow is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Peak Data | O | This | | | | Rate | | information | | | | | | element may | | | | | | be present | | | | | | if Policing | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | permissible | | | | | | peak data | | | | | | rate for a | | | | | | media | | | | | | stream. | | | | | | (NOTE 2). | +-------------+-------------+-------------+-------------+-------------+ | | | Sustainable | O | This | | | | Data Rate | | information | | | | | | element may | | | | | | be present | | | | | | if Policing | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | permissible | | | | | | sustainable | | | | | | data rate | | | | | | for a media | | | | | | stream. | | | | | | (NOTE 2). | +-------------+-------------+-------------+-------------+-------------+ | | | Delay | O | This | | | | Variation | | information | | | | Tolerance | | element may | | | | | | be present | | | | | | if Policing | | | | | | on Peak | | | | | | Data Rate | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the maximum | | | | | | expected | | | | | | delay | | | | | | variation | | | | | | tolerance | | | | | | for the | | | | | | co | | | | | | rresponding | | | | | | media | | | | | | stream. | +-------------+-------------+-------------+-------------+-------------+ | | | Maximum | C | This | | | | Burst Size | | information | | | | | | element | | | | | | shall be | | | | | | present if | | | | | | Policing on | | | | | | Sustainable | | | | | | Data Rate | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the maximum | | | | | | expected | | | | | | burst size | | | | | | for the | | | | | | co | | | | | | rresponding | | | | | | media | | | | | | stream. | +-------------+-------------+-------------+-------------+-------------+ | | | DiffServ | O | This | | | | Code Point | | information | | | | | | element | | | | | | indicates a | | | | | | specific | | | | | | DiffServ | | | | | | code point | | | | | | to be used | | | | | | in the IP | | | | | | header in | | | | | | packets | | | | | | sent on the | | | | | | bearer | | | | | | t | | | | | | ermination. | +-------------+-------------+-------------+-------------+-------------+ | | | DiffServ | O | This | | | | Tagging | | information | | | | Behaviour | | element | | | | | | indicates | | | | | | whether the | | | | | | Diffserv | | | | | | code point | | | | | | in the IP | | | | | | header in | | | | | | packets | | | | | | sent on the | | | | | | bearer | | | | | | termination | | | | | | should be | | | | | | copied from | | | | | | the | | | | | | received | | | | | | value or | | | | | | set to a | | | | | | specific | | | | | | value. | +-------------+-------------+-------------+-------------+-------------+ | | | Media | O | This | | | | Inactivity | | information | | | | Detection | | element | | | | Required | | indicates | | | | | | that | | | | | | detection | | | | | | of inactive | | | | | | media flows | | | | | | is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Media | C | This | | | | Inactivity | | information | | | | Detection | | element may | | | | Time | | be present | | | | | | if Inactive | | | | | | Media | | | | | | Detection | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | Inactivity | | | | | | Detection | | | | | | time. | +-------------+-------------+-------------+-------------+-------------+ | | | Media | C | This | | | | Inactivity | | information | | | | Detection | | element may | | | | Direction | | be present | | | | | | if Inactive | | | | | | Media | | | | | | Detection | | | | | | is required | | | | | | and | | | | | | specifies | | | | | | the | | | | | | Inactivity | | | | | | Detection | | | | | | direction. | +-------------+-------------+-------------+-------------+-------------+ | | | RTCP | O | This | | | | handling | | information | | | | | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | wants to | | | | | | explicitly | | | | | | control the | | | | | | reservation | | | | | | of RTCP | | | | | | resources | | | | | | (NOTE 5). | +-------------+-------------+-------------+-------------+-------------+ | | | RTP/RTCP | C | This | | | | transport | | information | | | | m | | element | | | | ultiplexing | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | the | | | | | | RTP/RTCP | | | | | | transport | | | | | | mu | | | | | | ltiplexing. | | | | | | This | | | | | | information | | | | | | element may | | | | | | only be | | | | | | present if | | | | | | RTCP | | | | | | handling is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Explicit | C | This | | | | RTCP | | information | | | | transport | | element | | | | address | | indicates | | | | | | the remote | | | | | | RTCP port | | | | | | and | | | | | | optionally | | | | | | the remote | | | | | | network | | | | | | address | | | | | | where to | | | | | | send RTCP | | | | | | packets. | | | | | | This | | | | | | information | | | | | | element may | | | | | | only be | | | | | | present if | | | | | | RTCP | | | | | | handling is | | | | | | required. | +-------------+-------------+-------------+-------------+-------------+ | | | Local | C | This | | | | cr | | information | | | | yptographic | | element is | | | | SDES | | present if | | | | attribute | | IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | encrypted | | | | | | and/or | | | | | | integrity | | | | | | protected | | | | | | by the | | | | | | IMS-AGW | | | | | | (NOTE 4). | | | | | | It | | | | | | indicates | | | | | | the SDES | | | | | | local | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s). | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | C | This | | | | cr | | information | | | | yptographic | | element is | | | | SDES | | present if | | | | attribute | | IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | decrypted, | | | | | | and/or | | | | | | integrity | | | | | | checked by | | | | | | the IMS-AGW | | | | | | (NOTE 4). | | | | | | It | | | | | | indicates | | | | | | the SDES | | | | | | remote | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s). | +-------------+-------------+-------------+-------------+-------------+ | | | ECN Enable | O | This | | | | | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to apply | | | | | | ECN | | | | | | procedures. | +-------------+-------------+-------------+-------------+-------------+ | | | ECN | C | This | | | | Initiation | | information | | | | Method | | element | | | | | | specifies | | | | | | the ECN | | | | | | Initiation | | | | | | method and | | | | | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | IP header | | | | | | settings as | | | | | | an ECN | | | | | | endpoint, | | | | | | or | | | | | | indicates | | | | | | that ECN | | | | | | bits shall | | | | | | be passed | | | | | | tra | | | | | | nsparently. | | | | | | It may be | | | | | | included | | | | | | only if ECN | | | | | | is enabled. | +-------------+-------------+-------------+-------------+-------------+ | | | Notify ECN | C | This | | | | Failure | | information | | | | Event | | element | | | | | | requests a | | | | | | n | | | | | | otification | | | | | | if a ECN | | | | | | failure | | | | | | occurs due | | | | | | to ECN. It | | | | | | may only be | | | | | | supplied if | | | | | | ECN is | | | | | | enabled and | | | | | | the IMS-AGW | | | | | | acts as ECN | | | | | | endpoint. | +-------------+-------------+-------------+-------------+-------------+ | | | Extended | O | This | | | | RTP Header | | information | | | | for CVO | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to pass on | | | | | | the CVO | | | | | | extended | | | | | | RTP header | | | | | | as defined | | | | | | by | | | | | | IETF RFC 5 | | | | | | 285 [23]. | +-------------+-------------+-------------+-------------+-------------+ | | | Extended | O | This | | | | RTP Header | | information | | | | for Sent | | element | | | | ROI | | requests | | | | | | the IMS-AGW | | | | | | to pass on | | | | | | the ROI | | | | | | extended | | | | | | RTP header | | | | | | for | | | | | | carriage of | | | | | | predefined | | | | | | and/or | | | | | | arbitrary | | | | | | ROI | | | | | | information | | | | | | as defined | | | | | | by | | | | | | IETF RFC | | | | | | 5285 [23] | | | | | | and | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-------------+-------------+-------------+-------------+ | | | Predefined | O | This | | | | ROI | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to support | | | | | | the RTCP | | | | | | feedback | | | | | | message | | | | | | capability | | | | | | for | | | | | | \ | | | | | | "Predefined | | | | | | ROI\" type | | | | | | expressed | | | | | | by the | | | | | | parameter | | | | | | \" | | | | | | 3gpp-roi-pr | | | | | | edefined\", | | | | | | as | | | | | | described | | | | | | in | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-------------+-------------+-------------+-------------+ | | | Arbitrary | O | This | | | | ROI | | information | | | | | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to support | | | | | | the RTCP | | | | | | feedback | | | | | | message | | | | | | capability | | | | | | for | | | | | | \"Arbitrary | | | | | | ROI\" type | | | | | | expressed | | | | | | by the | | | | | | parameter | | | | | | \ | | | | | | "3gpp-roi-a | | | | | | rbitrary\", | | | | | | as | | | | | | described | | | | | | in | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-------------+-------------+-------------+-------------+ | | | Generic | O | This | | | | Image | | information | | | | Attributes | | element | | | | | | indicates | | | | | | image | | | | | | attributes | | | | | | (e.g. image | | | | | | size) as | | | | | | defined by | | | | | | IETF RFC 6 | | | | | | 236 [24]. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | O | This | | | | certificate | | information | | | | fingerprint | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | wants that | | | | | | the media | | | | | | is | | | | | | decrypted, | | | | | | and/or | | | | | | integrity | | | | | | checked by | | | | | | the IMS-AGW | | | | | | (NOTE 4). | | | | | | It | | | | | | indicates | | | | | | the remote | | | | | | certificate | | | | | | f | | | | | | ingerprint. | +-------------+-------------+-------------+-------------+-------------+ | | | Establish | O | This | | | | (D)TLS | | information | | | | session | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to take the | | | | | | (D)TLS | | | | | | client role | | | | | | and to | | | | | | initiate | | | | | | the | | | | | | es | | | | | | tablishment | | | | | | of the | | | | | | (D)TLS | | | | | | session. | | | | | | (NOTE 4) | +-------------+-------------+-------------+-------------+-------------+ | | | Release | O | This | | | | (D)TLS | | information | | | | session | | element | | | | | | requests | | | | | | the IMS-AGW | | | | | | to release | | | | | | the (D)TLS | | | | | | session. | | | | | | (NOTE 4) | +-------------+-------------+-------------+-------------+-------------+ | | | Notify | O | This | | | | (D)TLS | | information | | | | session | | element | | | | es | | requests a | | | | tablishment | | n | | | | Failure | | otification | | | | Event | | if a TLS | | | | | | session | | | | | | es | | | | | | tablishment | | | | | | failure | | | | | | occurs. | | | | | | (NOTE 4) | +-------------+-------------+-------------+-------------+-------------+ | | | TCP | C | This | | | | State-aware | | information | | | | Handling | | element | | | | Indicator | | indicates | | | | and Setup | | that TCP | | | | Direction | | state-aware | | | | | | handing is | | | | | | required | | | | | | and | | | | | | indicates | | | | | | the TCP | | | | | | setup | | | | | | direction. | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-------------+-------------+-------------+-------------+ | | | Discard | C | This | | | | Incoming | | information | | | | TCP | | element | | | | Connection | | indicates | | | | Es | | whether | | | | tablishment | | incoming | | | | Requests | | TCP | | | | Indicator | | connection | | | | | | es | | | | | | tablishment | | | | | | requests | | | | | | (TCP SYN) | | | | | | shall be | | | | | | discarded. | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling | | | | | | and | | | | | | discarding | | | | | | incoming | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | requests. | +-------------+-------------+-------------+-------------+-------------+ | | | Forward | C | This | | | | Incoming | | information | | | | TCP | | element | | | | Connection | | indicates | | | | Es | | for a given | | | | tablishment | | termination | | | | Requests | | to use the | | | | Indicator | | incoming | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request | | | | | | (TCP SYN) | | | | | | at that | | | | | | termination | | | | | | as a | | | | | | trigger for | | | | | | sending a | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request at | | | | | | the | | | | | | int | | | | | | erconnected | | | | | | termination | | | | | | in the same | | | | | | context. It | | | | | | may only be | | | | | | included if | | | | | | the IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling | | | | | | and the | | | | | | Forward | | | | | | Incoming | | | | | | TCP | | | | | | Connection | | | | | | Es | | | | | | tablishment | | | | | | Requests | | | | | | Indicator. | +-------------+-------------+-------------+-------------+-------------+ | | | Send TCP | C | This | | | | Connection | | information | | | | Es | | element | | | | tablishment | | indicates | | | | Requests | | for a given | | | | Indicator | | termination | | | | | | to send a | | | | | | TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | request | | | | | | (TCP SYN). | | | | | | It may only | | | | | | be included | | | | | | if the | | | | | | IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-------------+-------------+-------------+-------------+ | | | Notify TCP | C | This | | | | Connection | | information | | | | Es | | element | | | | tablishment | | requests a | | | | Failure | | n | | | | Event | | otification | | | | | | if a TCP | | | | | | connection | | | | | | es | | | | | | tablishment | | | | | | failure | | | | | | occurs. It | | | | | | may only be | | | | | | included if | | | | | | the IMSâ€‘AGW | | | | | | supports | | | | | | TCP | | | | | | state-aware | | | | | | handling. | +-------------+-------------+-------------+-------------+-------------+ | | | ICE | C | This | | | | C | | information | | | | onnectivity | | element | | | | Check | | requests | | | | | | the IMS-AGW | | | | | | to perform | | | | | | ICE | | | | | | c | | | | | | onnectivity | | | | | | check as | | | | | | defined by | | | | | | IETF RFC 8 | | | | | | 445 [82]. | | | | | | It is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | Notify ICE | C | This | | | | C | | information | | | | onnectivity | | element | | | | Check | | requests a | | | | Result | | n | | | | | | otification | | | | | | of ICE | | | | | | c | | | | | | onnectivity | | | | | | check | | | | | | result. It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | Notify New | C | This | | | | Peer | | information | | | | Reflexive | | element | | | | Candidate | | requests a | | | | | | n | | | | | | otification | | | | | | of new peer | | | | | | reflexive | | | | | | candidate | | | | | | was | | | | | | discovered | | | | | | during a | | | | | | c | | | | | | onnectivity | | | | | | check. It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | Additional | C | This | | | | ICE | | information | | | | C | | element | | | | onnectivity | | requests | | | | Check | | the IMS-AGW | | | | | | to perform | | | | | | additional | | | | | | ICE | | | | | | c | | | | | | onnectivity | | | | | | check as | | | | | | defined by | | | | | | IETF RFC 8 | | | | | | 445 [82]. | | | | | | It is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | candidate | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | candidate | | | | | | for ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | password | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | password | | | | | | for ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | Ufrag | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | Ufrag for | | | | | | ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | ICE | O | This | | | | received | | information | | | | pacing | | element is | | | | | | present if | | | | | | IMS-ALG | | | | | | indicates a | | | | | | received | | | | | | pacing | | | | | | value for | | | | | | c | | | | | | onnectivity | | | | | | checks (Ta | | | | | | timer | | | | | | value). It | | | | | | is only | | | | | | applicable | | | | | | for full | | | | | | ICE. | +-------------+-------------+-------------+-------------+-------------+ | | | MSRP Path | O | This | | | | | | information | | | | | | element is | | | | | | present for | | | | | | applic | | | | | | ation-aware | | | | | | MSRP | | | | | | In | | | | | | terworking. | | | | | | It provides | | | | | | the path | | | | | | information | | | | | | that the | | | | | | IMS-AGW | | | | | | shall | | | | | | insert in | | | | | | the MSRP | | | | | | layer | | | | | | \"Toâ€‘Path\" | | | | | | Information | | | | | | element. | +-------------+-------------+-------------+-------------+-------------+ | | | Notify STUN | O | This | | | | consent | | information | | | | freshness | | element | | | | test | | requests a | | | | failure | | n | | | | Event | | otification | | | | | | if a STUN | | | | | | consent | | | | | | freshness | | | | | | test | | | | | | failure | | | | | | occurs | | | | | | (full ICE | | | | | | only). | +-------------+-------------+-------------+-------------+-------------+ | | | STUN | O | This | | | | consent | | information | | | | freshness | | element is | | | | test | | present if | | | | request | | eP-CSCF | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | perform a | | | | | | STUN | | | | | | consent | | | | | | freshness | | | | | | test (full | | | | | | ICE only). | +-------------+-------------+-------------+-------------+-------------+ | | | Allowed | O | This | | | | RTCP APP | | information | | | | message | | element is | | | | types | | present if | | | | | | IMS-ALG | | | | | | allows the | | | | | | IMS-AGW to | | | | | | send RTCP | | | | | | APP packets | | | | | | of the | | | | | | indicated | | | | | | types. The | | | | | | IMS-AGW | | | | | | shall not | | | | | | send other | | | | | | RTCP APP | | | | | | packets. If | | | | | | the | | | | | | parameter | | | | | | is not | | | | | | supplied, | | | | | | the IMS-AGW | | | | | | shall not | | | | | | send any | | | | | | RTCP APP | | | | | | packets. | +-------------+-------------+-------------+-------------+-------------+ | | | Local Dcmap | O | This | | | | | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcmap\" | | | | | | attribute | | | | | | sent | | | | | | towards the | | | | | | remote | | | | | | peer, | | | | | | including | | | | | | the | | | | | | Subprotocol | | | | | | to exchange | | | | | | via the | | | | | | data | | | | | | channel. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Dcmap | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcmap\" | | | | | | attribute | | | | | | received | | | | | | from the | | | | | | remote | | | | | | peer, | | | | | | including | | | | | | the | | | | | | Subprotocol | | | | | | to exchange | | | | | | via the | | | | | | data | | | | | | channel. | +-------------+-------------+-------------+-------------+-------------+ | | | Local Dcsa | O | This | | | | | | information | | | | | | element can | | | | | | be present | | | | | | if the | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel and | | | | | | to handle | | | | | | its | | | | | | contents in | | | | | | an | | | | | | applic | | | | | | ation-aware | | | | | | manner. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcsa\" | | | | | | attribute | | | | | | sent | | | | | | towards the | | | | | | remote | | | | | | peer, | | | | | | en | | | | | | capsulating | | | | | | a | | | | | | subprotocol | | | | | | specific | | | | | | SDP | | | | | | attribute. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote Dcsa | O | This | | | | | | information | | | | | | element can | | | | | | be present | | | | | | if the | | | | | | IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel and | | | | | | to handle | | | | | | its | | | | | | contents in | | | | | | an | | | | | | applic | | | | | | ation-aware | | | | | | manner. It | | | | | | indicates | | | | | | the | | | | | | information | | | | | | within an | | | | | | SDP | | | | | | \"dcsa\" | | | | | | attribute | | | | | | received | | | | | | from the | | | | | | remote | | | | | | peer, | | | | | | en | | | | | | capsulating | | | | | | a | | | | | | subprotocol | | | | | | specific | | | | | | SDP | | | | | | attribute. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote SCTP | O | This | | | | port | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the remote | | | | | | SCTP port. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote SCTP | O | This | | | | max message | | information | | | | size | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the remote | | | | | | max message | | | | | | size. | +-------------+-------------+-------------+-------------+-------------+ | | | SCTP Group | O | This | | | | Semantics | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to modify | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the H.248 | | | | | | component | | | | | | streams | | | | | | that are | | | | | | grouped in | | | | | | the same | | | | | | SCTP | | | | | | a | | | | | | ssociation. | +-------------+-------------+-------------+-------------+-------------+ | | | SCTP stream | O | This | | | | de | | information | | | | aggregation | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to modify | | | | | | an SCTP | | | | | | a | | | | | | ssociation. | | | | | | It | | | | | | indicates | | | | | | the H.248 | | | | | | component | | | | | | streams | | | | | | that | | | | | | transport | | | | | | media that | | | | | | are to be | | | | | | d | | | | | | eaggregated | | | | | | from the | | | | | | H.248 | | | | | | de | | | | | | aggregation | | | | | | stream used | | | | | | to control | | | | | | the SCTP | | | | | | a | | | | | | ssociation. | +-------------+-------------+-------------+-------------+-------------+ | | | SCTP stream | O | This | | | | ID | | information | | | | | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | establish | | | | | | an WEBRTC | | | | | | data | | | | | | channel. It | | | | | | indicates | | | | | | the SCTP | | | | | | stream ID | | | | | | to be used | | | | | | for that | | | | | | data | | | | | | channel. | +-------------+-------------+-------------+-------------+-------------+ | | | Received | O | This | | | | SCTP Stream | | information | | | | Reset | | element is | | | | Request | | present if | | | | | | the eP-CSCF | | | | | | (IMS-ALG) | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | establish | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | provide a | | | | | | n | | | | | | otification | | | | | | when | | | | | | receiving | | | | | | an SCTP | | | | | | Stream | | | | | | reset | | | | | | request and | | | | | | to | | | | | | a | | | | | | utonomously | | | | | | answer that | | | | | | SCTP Stream | | | | | | reset | | | | | | request. | +-------------+-------------+-------------+-------------+-------------+ | | | Send SCTP | O | This | | | | Stream | | information | | | | Reset | | element is | | | | Requests | | present if | | | | Indicator | | the eP-CSCF | | | | | | (IMS-ALG) | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | reset an | | | | | | SCTP Stream | | | | | | to release | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | send an | | | | | | SCTP Stream | | | | | | reset | | | | | | request. | +-------------+-------------+-------------+-------------+-------------+ | | | Received | O | This | | | | SCTP Stream | | information | | | | Reset | | element may | | | | Response | | be present | | | | | | if the | | | | | | eP-CSCF | | | | | | (IMS-ALG) | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | reset an | | | | | | SCTP Stream | | | | | | to release | | | | | | the WEBRTC | | | | | | data | | | | | | channel. It | | | | | | requests | | | | | | the | | | | | | eIMS-AGW to | | | | | | provide a | | | | | | n | | | | | | otification | | | | | | when | | | | | | receiving a | | | | | | response to | | | | | | an SCTP | | | | | | Stream | | | | | | reset | | | | | | request. | +-------------+-------------+-------------+-------------+-------------+ | | | Initiate | O | This | | | | Outgoing | | information | | | | SCTP Stream | | element is | | | | Reset | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to close an | | | | | | individual | | | | | | WEBRTC data | | | | | | channel. | +-------------+-------------+-------------+-------------+-------------+ | | | Outgoing | O | This | | | | SCTP Stream | | information | | | | Response | | element is | | | | | | present if | | | | | | the IMS-ALG | | | | | | requests | | | | | | the IMS-AGW | | | | | | to | | | | | | acknowledge | | | | | | the request | | | | | | to close an | | | | | | individual | | | | | | WEBRTC data | | | | | | channel. | +-------------+-------------+-------------+-------------+-------------+ | | | Notify | O | This | | | | Detect | | information | | | | Outgoing | | element | | | | SCTP Stream | | requests a | | | | Reset | | n | | | | | | otification | | | | | | of outgoing | | | | | | SCTP Stream | | | | | | reset | | | | | | requests | | | | | | from remote | | | | | | peers (here | | | | | | IMS WebRTC | | | | | | client). | +-------------+-------------+-------------+-------------+-------------+ | | | Notify | O | This | | | | Outgoing | | information | | | | SCTP Stream | | element | | | | Reset | | requests a | | | | Result | | n | | | | | | otification | | | | | | of the | | | | | | result of | | | | | | an outgoing | | | | | | SCTP Stream | | | | | | reset sent | | | | | | to the | | | | | | remote peer | | | | | | (here IMS | | | | | | WebRTC | | | | | | client). | +-------------+-------------+-------------+-------------+-------------+ | | | SDPCapNeg | O | This | | | | co | | information | | | | nfiguration | | element | | | | | | provides | | | | | | SDPCapNeg | | | | | | confi | | | | | | guration(s) | | | | | | using as | | | | | | \"a=acap\", | | | | | | \"a=tcap\", | | | | | | \"a=pcfg\" | | | | | | and | | | | | | \"a=acfg\" | | | | | | SDP | | | | | | attributes. | +-------------+-------------+-------------+-------------+-------------+ | | | Additional | O | This | | | | Bandwidth | | information | | | | Properties | | element | | | | | | indicates | | | | | | additional | | | | | | bandwidth | | | | | | properties | | | | | | using | | | | | | \" | | | | | | a=bw-info\" | | | | | | SDP | | | | | | a | | | | | | ttribute(s) | | | | | | as defined | | | | | | by | | | | | | 3GPP TS 26. | | | | | | 114 [21]. | +-------------+-------------+-------------+-------------+-------------+ | | | CCM BASE | O | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | that the | | | | | | IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive and | | | | | | is allowed | | | | | | to send, | | | | | | re | | | | | | spectively, | | | | | | the RTCP | | | | | | feedback | | | | | | \"CCM FIR\" | | | | | | and/or | | | | | | \"CCM | | | | | | TMMBR\" | | | | | | messages | | | | | | (defined in | | | | | | IETF RFC 51 | | | | | | 04 [78]). | +-------------+-------------+-------------+-------------+-------------+ | | | CCM | O | This | | | | p | | information | | | | ause-resume | | element | | | | | | indicates | | | | | | to the | | | | | | IMS-AGW | | | | | | that RTCP | | | | | | feedback | | | | | | \"CCM | | | | | | PAU | | | | | | SE-RESUME\" | | | | | | messages | | | | | | shall be | | | | | | passed | | | | | | tra | | | | | | nsparently. | +-------------+-------------+-------------+-------------+-------------+ | | | DBI | O | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | to the | | | | | | IMS-AGW | | | | | | that RTCP | | | | | | DBI | | | | | | feedback | | | | | | messages | | | | | | (as defined | | | | | | in | | | | | | 3GPP TS 26 | | | | | | .114 [21] | | | | | | cl | | | | | | ause 7.3.8) | | | | | | shall be | | | | | | passed | | | | | | tra | | | | | | nsparently. | +-------------+-------------+-------------+-------------+-------------+ | Configure | IMS-AGW | Context | M | This | | AGW | | | | information | | Connection | | | | element | | Point Ack | | | | indicates | | | | | | the context | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-------------+-------------+-------------+-------------+ | | | Bearer | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the bearer | | | | | | termination | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-------------+-------------+-------------+-------------+ | | | Local IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall be | | | | | | prepared to | | | | | | receive | | | | | | user data | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote IP | O | This | | | | Resources | | information | | | | | | element | | | | | | indicates | | | | | | the | | | | | | resource(s) | | | | | | for which | | | | | | the IMS-AGW | | | | | | shall send | | | | | | data. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this IE | | | | | | shall | | | | | | contain | | | | | | separate | | | | | | resources | | | | | | per stream. | +-------------+-------------+-------------+-------------+-------------+ | | | Local | O | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the IP | | | | | | address and | | | | | | port | | | | | | number(s) | | | | | | on the | | | | | | IMS-AGW | | | | | | that the | | | | | | IMS user | | | | | | can send | | | | | | user plane | | | | | | data to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | O | This | | | | Connection | | information | | | | Address | | element | | | | | | indicates | | | | | | the remote | | | | | | IP address | | | | | | and port | | | | | | number(s) | | | | | | that the | | | | | | IMS-AGW can | | | | | | send user | | | | | | plane data | | | | | | to. | | | | | | | | | | | | For | | | | | | t | | | | | | erminations | | | | | | supporting | | | | | | any | | | | | | combination | | | | | | of video, | | | | | | audio and | | | | | | messaging | | | | | | this may | | | | | | contain | | | | | | multiple | | | | | | addresses. | +-------------+-------------+-------------+-------------+-------------+ | | | Local | C | This | | | | cr | | information | | | | yptographic | | element may | | | | SDES | | be present | | | | attribute | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the SDES | | | | | | local | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-------------+-------------+-------------+-------------+ | | | Remote | C | This | | | | cr | | information | | | | yptographic | | element may | | | | SDES | | be present | | | | attribute | | only if it | | | | | | was | | | | | | contained | | | | | | in the | | | | | | request. It | | | | | | indicates | | | | | | the SDES | | | | | | remote | | | | | | cr | | | | | | yptographic | | | | | | parameters | | | | | | such as | | | | | | key(s) | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1: | | | | | | Remote | | | | | | Source Port | | | | | | and Remote | | | | | | Source Port | | | | | | Range are | | | | | | mutually | | | | | | exclusive. | | | | | | | | | | | | NOTE 2: One | | | | | | of those | | | | | | IEs shall | | | | | | at least be | | | | | | present | | | | | | when | | | | | | policing is | | | | | | required. | | | | | | | | | | | | NOTE 3: | | | | | | Additional | | | | | | streams may | | | | | | be added by | | | | | | the | | | | | | Configure | | | | | | AGW | | | | | | Connection | | | | | | Point | | | | | | procedure. | | | | | | The | | | | | | additional | | | | | | streams | | | | | | shall then | | | | | | carry the | | | | | | same IP | | | | | | Realm | | | | | | Identifier | | | | | | as the very | | | | | | first | | | | | | Stream. | | | | | | | | | | | | NOTE 4: | | | | | | This IE may | | | | | | only be | | | | | | present for | | | | | | access | | | | | | network | | | | | | te | | | | | | rminations. | | | | | | | | | | | | NOTE 5: The | | | | | | concerned | | | | | | RTCP | | | | | | resource | | | | | | component | | | | | | is related | | | | | | to the RTCP | | | | | | port value. | | | | | +-------------+-------------+-------------+-------------+-------------+
Editor\'s Note : The details of how the transparent indication included in ECN
Control is subject of stage 3 specification. It also needs to be determined if
this indication is needed on both incoming and outgoing terminations.
## 8.5 Release AGW Termination
This procedure is used to release a termination towards the IMS and free all
related resources.
Table 8.5.1: Procedures between IMS-ALG and IMS-AGW: Release AGW Termination
* * *
**Procedure** **Initiated** **Information element name** **Information element
required** **Information element description** **Release AGW Termination**
IMS-ALG Context M This information element indicates the existing context for
the bearer termination. Bearer Termination M This information element
indicates the bearer termination to be released. **Release AGW Termination**
Ack IMS-AGW Context M This information element indicates the context where the
command was executed. Bearer Termination M This information element indicates
the bearer termination where the command was executed.
* * *
## 8.6 Termination heartbeat indication
This procedure is used to report a termination heartbeat.
Table 8.6.1: Procedures between IMS-ALG and IMS-AGW: Termination heartbeat
indication
* * *
Procedure Initiated Information element name Information element required
Information element description Termination heartbeat indication IMS-AGW
Context M This information element indicates the context for the bearer
termination. Bearer Termination M This information element indicates the
bearer termination for which the termination heartbeat is reported.
Termination heartbeat M Hanging Termination event, as defined in 3GPP TS
29.334 [3]. Termination heartbeat indication Ack IMS-ALG Context M This
information element indicates the context where the command was executed.
Bearer Termination M This information element indicates the bearer termination
where the command was executed.
* * *
## 8.7 IMS-AGW Out-of-Service
This procedure is used to indicate that the IMS-AGW will go out of service or
is maintenance locked.
Table 8.7.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Out-of-Service
* * *
Procedure Initiated Information element name Information element required
Information element description IMS-AGW Out-of-Service IMS-AGW Context M This
information element indicates the context for the command. Root Termination M
This information element indicates the root termination for the command.
Reason M This information element indicates the reason for service change.
Method M This information element indicates the method for service change.
IMS-AGW Out-of-Service Ack IMS-ALG Context M This information element
indicates the context where the command was executed. Root Termination M This
information element indicates the root termination where the command was
executed.
* * *
## 8.8 IMS-AGW Communication Up
This procedure is used to indicate that the IMS-AGW is back in service using
an existing control association.
Table 8.8.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Communication Up
+-------------+-----------+-------------+-------------+-------------+ | Procedure | Initiated | Information | Information | Information | | | | element | element | element | | | | name | required | description | +-------------+-----------+-------------+-------------+-------------+ | IMS-AGW | IMS-AGW | Context | M | This | | Co | | | | information | | mmunication | | | | element | | | | | | indicates | | Up | | | | the context | | | | | | for the | | | | | | command. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the root | | | | | | termination | | | | | | for the | | | | | | command. | +-------------+-----------+-------------+-------------+-------------+ | | | Reason | M | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | the reason | | | | | | for service | | | | | | change. | +-------------+-----------+-------------+-------------+-------------+ | | | Method | M | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | the method | | | | | | for service | | | | | | change. | +-------------+-----------+-------------+-------------+-------------+ | IMS-AGW | IMS-ALG | Context | M | This | | Co | | | | information | | mmunication | | | | element | | | | | | indicates | | Up Ack | | | | the context | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the root | | | | | | termination | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | IMS-ALG | O | This | | | | Address | | information | | | | | | element | | | | | | indicates | | | | | | the IMS-ALG | | | | | | signalling | | | | | | address to | | | | | | which the | | | | | | IMS-AGW | | | | | | should | | | | | | preferably | | | | | | attempt to | | | | | | r | | | | | | e-register. | +-------------+-----------+-------------+-------------+-------------+
## 8.9 IMS-AGW Restoration
This procedure is used to indicate the IMS-AGW has recovered from a failure.
Table 8.9.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Restoration
* * *
Procedure Initiated Information element name Information element required
Information element description IMS-AGW Restoration IMS-AGW Context M This
information element indicates the context for the command. Root Termination M
This information element indicates the root termination for the command.
Reason M This information element indicates the reason for the service change.
Method M This information element indicates the method for service change.
IMS-AGW Restoration Ack IMS-ALG Context M This information element indicates
the context where the command was executed. Root Termination M This
information element indicates the root termination where the command was
executed. IMS-ALG Address O This information element indicates the IMS-ALG
signalling address to which the IMS-AGW should preferably attempt to re-
register.
* * *
## 8.10 IMS-AGW Register
This procedure is used to register the IMS-AGW after a cold/warm boot.
Table 8.10.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Register
* * *
Procedure Initiated Information element name Information element required
Information element description IMS-AGW Register IMS-AGW Context M This
information element indicates the context for the command. Root Termination M
This information element indicates the root termination for the command.
Reason M This information element indicates the reason for the service change.
Method M This information element indicates the method for service change.
Protocol Version M This information element indicates the protocol version for
Iq interface requested by the IMS-AGW. Service Change Profile M This
information element indicates the profile for the Iq interface requested by
the IMS-AGW. IMS-AGW Register Ack IMS-ALG Context M This information element
indicates the context where the command was executed. Root Termination M This
information element indicates the root termination where the command was
executed. Protocol Version O This information element indicates the protocol
version for Iq interface supported by the IMS-ALG. Service Change Profile O
This information element indicates the profile for the Iq interface supported
by the IMS-ALG. IMS-ALG Address O This information element indicates the IMS-
ALG signalling address to which the IMS-AGW should preferably attempt to re-
register.
* * *
## 8.11 IMS-ALG Restoration
This procedure is used to indicate the IMS-ALG has recovered from a failure.
Table 8.11.1: Procedures between IMS-ALG and IMS-AGW: IMS-ALG Restoration
* * *
Procedure Initiated Information element name Information element required
Information element description IMS-ALG Restoration IMS-ALG Context M This
information element indicates the context for the command. Root Termination M
This information element indicates the root termination for the command.
Reason M This information element indicates the reason for the service change.
Method M This information element indicates the method for service change.
IMS-ALG Restoration Ack IMS-AGW Context M This information element indicates
the context where the command was executed. Root Termination M This
information element indicates the root termination where the command was
executed.
* * *
## 8.12 IMS-AGW Re-register
This procedure is used to re-register the IMS-AGW (having been requested to do
so by the IMS-ALG).
Table 8.12.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Re-register
* * *
Procedure Initiated Information element name Information element required
Information element description IMS-AGW Re-register IMS-AGW Context M This
information element indicates the context for the command. Root Termination M
This information element indicates the root termination for the command.
Reason M This information element indicates the reason for the service change.
Method M This information element indicates the method for service change.
Protocol Version M This information element indicates the protocol version for
Iq interface requested by the IMS-AGW. Service Change Profile M This
information element indicates the profile for the Iq interface requested by
the IMS-AGW. IMS-AGW Re-register Ack IMS-ALG Context M This information
element indicates the context where the command was executed. Root Termination
M This information element indicates the root termination where the command
was executed. Protocol Version O This information element indicates the
protocol version for Iq interface supported by the IMS-ALG. Service Change
Profile O This information element indicates the profile for the Iq interface
supported by the IMS-ALG. IMS-ALG Address O This information element indicates
the IMS-ALG signalling address to which the IMS-AGW should preferably attempt
to re-register.
* * *
## 8.13 IMS-ALG Ordered Re-registration
This procedure is used by the IMS-ALG to request the IMS-AGW to re-register.
Table 8.13.1: Procedures between IMS-ALG and IMS-AGW: IMS-ALG Ordered Re-
register
+-------------+-----------+-------------+-------------+-------------+ | Procedure | Initiated | Information | Information | Information | | | | element | element | element | | | | name | required | description | +-------------+-----------+-------------+-------------+-------------+ | IMS-ALG | IMS-ALG | Context | M | This | | Ordered Re- | | | | information | | | | | | element | | register | | | | indicates | | | | | | the context | | | | | | for the | | | | | | command. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the root | | | | | | termination | | | | | | for the | | | | | | command. | +-------------+-----------+-------------+-------------+-------------+ | | | Reason | M | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | the reason | | | | | | for the | | | | | | service | | | | | | change. | +-------------+-----------+-------------+-------------+-------------+ | | | IMS-ALG | O | This | | | | Address | | information | | | | | | element | | | | | | indicates | | | | | | the IMS-ALG | | | | | | signalling | | | | | | address. | +-------------+-----------+-------------+-------------+-------------+ | IMS-ALG | IMS-AGW | Context | M | This | | Ordered Re- | | | | information | | | | | | element | | register | | | | indicates | | Ack | | | | the context | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the root | | | | | | termination | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+
## 8.14 Audit Value
This procedure is used to audit values of different object(s).
Table 8.14.1: Procedures between IMS-ALG and IMS-AGW: Audit Value
* * *
Procedure Initiated Information element name Information element required
Information element description Audit Value IMS-ALG Context M This information
element indicates the context for the command. Bearer Termination M This
information element indicates the bearer termination(s) for the command.
Object(s) M This information element indicates the object(s) to be audited.
Audit Value Ack IMS-AGW Context M This information element indicates the
context where the command was executed. Bearer Termination M This information
element indicates the bearer termination where the command was executed.
Value(s) M This information element indicates the value(s) of the object(s).
* * *
## 8.15 Audit Capability
This procedure is used to audit capabilities of different object(s).
Table 8.15.1: Procedures between IMS-ALG and IMS-AGW: Audit Capability
* * *
Procedure Initiated Information element name Information element required
Information element description Audit Capability IMS-ALG Context M This
information element indicates the context for the command. Bearer Termination
M This information element indicates the bearer termination(s) for the
command. Object(s) M This information element indicates the object(s) which
capability is requested. Audit Capability Ack IMS-AGW Context M This
information element indicates the context where the command was executed.
Bearer Termination M This information element indicates the bearer termination
where the command was executed. Capabilities(s) M This information element
indicates the capabilities of the object(s).
* * *
## 8.16 Capability Update
This procedure is used to indicate update of an object capability.
Table 8.16.1: Procedures between IMS-ALG and IMS-AGW: Capability Update
* * *
Procedure Initiated Information element name Information element required
Information element description Capability Update IMS-AGW Context M This
information element indicates the context for the command. Bearer Termination
M This information element indicates the bearer termination(s) for the
command. Reason M This information element indicates the reason for service
change. Method M This information element indicates the method for service
change. Capability Update Ack IMS-ALG Context M This information element
indicates the context where the command was executed. Bearer Termination M
This information element indicates the bearer termination where the command
was executed.
* * *
## 8.17 IMS-ALG Out of Service
This procedure is used to indicate that IMS-ALG has gone out of service.
Table 8.17.1: Procedures between IMS-ALG and IMS-AGW: IMS-ALG Out of Service
+-------------+-----------+-------------+-------------+-------------+ | Procedure | Initiated | Information | Information | Information | | | | element | element | element | | | | name | required | description | +-------------+-----------+-------------+-------------+-------------+ | IMS-ALG Out | IMS-ALG | Context | M | This | | of Service | | | | information | | | | | | element | | | | | | indicates | | | | | | the context | | | | | | for the | | | | | | command. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the root | | | | | | termination | | | | | | for the | | | | | | command. | +-------------+-----------+-------------+-------------+-------------+ | | | Reason | M | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | the reason | | | | | | for the | | | | | | service | | | | | | change. | +-------------+-----------+-------------+-------------+-------------+ | | | Method | M | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | the method | | | | | | for service | | | | | | change. | +-------------+-----------+-------------+-------------+-------------+ | IMS-ALG Out | IMS-AGW | Context | M | This | | of Service | | | | information | | | | | | element | | Ack | | | | indicates | | | | | | the context | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | the root | | | | | | termination | | | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+
## 8.18 IMS-AGW Resource Congestion Handling - Activate
This procedure is used to activate the congestion handling mechanism.
Table 8.18.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Resource
Congestion Handling - Activate
+-------------+-----------+-------------+-------------+-------------+ | Procedure | Initiated | Information | Information | Information | | | | element | element | element | | | | name | required | description | +-------------+-----------+-------------+-------------+-------------+ | IMS-AGW | IMS-ALG | Context | M | This | | Resource | | | | information | | Congestion | | | | element | | Handling -- | | | | indicates | | | | | | that all | | Activate | | | | context are | | | | | | applicable | | | | | | for the | | | | | | root | | | | | | t | | | | | | ermination. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | that root | | | | | | termination | | | | | | is where | | | | | | the | | | | | | congestion | | | | | | mechanism | | | | | | is | | | | | | activated. | +-------------+-----------+-------------+-------------+-------------+ | | | Congestion | M | This | | | | Activate | | information | | | | | | element | | | | | | requests to | | | | | | activate | | | | | | the | | | | | | congestion | | | | | | mechanism. | +-------------+-----------+-------------+-------------+-------------+ | IMS-AGW | IMS-AGW | Context | M | This | | Resource | | | | information | | Congestion | | | | element | | Handling - | | | | indicates | | | | | | that all | | Activate | | | | context are | | Ack | | | | where the | | | | | | command was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | that root | | | | | | termination | | | | | | is where | | | | | | the command | | | | | | was | | | | | | executed. | +-------------+-----------+-------------+-------------+-------------+
## 8.19 IMS-AGW Resource Congestion Handling - Indication
This procedure is used to inform the IMS-ALG that traffic restriction is
advised.
Table 8.19.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Resource
Congestion Handling -Indication
+-------------+-------------+-------------+-------------+-------------+ | ** | ** | Information | ** | ** | | Procedure**| Initiated** | element | Information | Information | | | | name | element | element | | | | | required**| de | | | | | | scription** | +-------------+-------------+-------------+-------------+-------------+ | IMS-AGW | IMS-AGW | Context | M | This | | Resource | | | | information | | Congestion | | | | element | | Handling - | | | | indicates | | | | | | all context | | Indication | | | | are | | | | | | applicable | | | | | | for the | | | | | | root | | | | | | t | | | | | | ermination. | +-------------+-------------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | that root | | | | | | termination | | | | | | is where | | | | | | the | | | | | | congestion | | | | | | mechanism | | | | | | was | | | | | | activated. | +-------------+-------------+-------------+-------------+-------------+ | | | Reduction | M | This | | | | | | information | | | | | | element | | | | | | indicates | | | | | | the load | | | | | | percentage | | | | | | to be | | | | | | reduced. | +-------------+-------------+-------------+-------------+-------------+ | IMS-AGW | IMS-ALG | Context | M | This | | Resource | | | | information | | Congestion | | | | element | | Handling - | | | | indicates | | | | | | all context | | Indication | | | | are where | | Ack | | | | the command | | | | | | was | | | | | | executed. | +-------------+-------------+-------------+-------------+-------------+ | | | Root | M | This | | | | Termination | | information | | | | | | element | | | | | | indicates | | | | | | that root | | | | | | termination | | | | | | is where | | | | | | the command | | | | | | was | | | | | | executed. | +-------------+-------------+-------------+-------------+-------------+
## 8.20 Inactivity Timeout Activate
This procedure is used to activate the inactivity timeout mechanism.
Table 8.20.1: Procedures between IMS-ALG and IMS-AGW: Inactivity Timeout
Activate
* * *
**Procedure** **Initiated** Information element name **Information element
required** **Information element description** Inactivity Timeout Activate
IMS-ALG Context M This information element indicates all context are
applicable for the root termination. Root Termination M This information
element indicates that root termination is where inactivity timeout mechanism
was activated. Inactivity Timeout Activate M This information element
activates the Inactivity Timeout request. Inactivity Timeout O This
information element indicates the maximum length of time before triggering the
related notification. Inactivity Timeout Activate Ack IMS-AGW Context M This
information element indicates all context are where the command was executed.
Root Termination M This information element indicates that root termination is
where the command was executed.
* * *
## 8.21 Inactivity Timeout Notification
This command is used to notify the IMS-ALG of an inactive control association.
Table 8.21.1: Procedures between IMS-AGW and IMS-ALG: Inactivity Timeout
Notification
* * *
**Procedure** **Initiated** Information element name **Information element
required** **Information element description** Inactivity Timeout Notification
IMS-AGW Context M This information element indicates all context are
applicable for the root termination. Root Termination M This information
element indicates that root termination is where the inactivity timeout
mechanism was activated. Inactivity Timeout Notification M This information
element notifies the IMS-ALG of an inactivity time period. Inactivity Timeout
Notifcation Ack IMS-ALG Context M This information element indicates all
context are where the command was executed. Root Termination M This
information element indicates that root termination is where the command was
executed.
* * *
## 8.22 Command Reject
This command is used to reject the received command request. It may be used as
response to any of the procedures.
Table 8.22.1: Procedures between IMS-ALG and IMS-AGW: Command Reject
* * *
Procedure Initiated Information element name Information element required
Information element description Command Reject Both Context O This information
element indicates the context where the command was rejected. Bearer
Termination O This information element indicates the bearer termination where
the command was rejected. Error M This information element indicates the error
that caused command rejection.
* * *
## 8.23 Realm Availability Activate
This command is used to request the IMS-AGW to monitor the status of its IP
Realms and to report any changes to the IMS-ALG.
Table 8.23.1: Procedures between IMS-ALG and IMS-AGW: Realm Availability
Activate
* * *
Procedure Initiated Information element name Information element required
Information element description Realm Availability Activate IMS-ALG Context M
This information element indicates all context are applicable for the root
termination. Root Termination M This information element indicates that root
termination is where the realm availability monitoring was activated. Realm
Availability Activate M This information element activates the monitoring of
the availability of IP Realms on the IMS-AGW. Realm Availability Activate Ack
IMS-AGW Context M This information element indicates all context are where the
command was executed. Root Termination M This information element indicates
that root termination is where the command was executed.
* * *
## 8.24 Realm Availability Notification
This command is used to notify the IMS-ALG of any changes in the availability
of IP Realms on the IMS-AGW.
Table 8.24.1: Procedures between IMS-ALG and IMS-AGW: Realm Availability
Notification
* * *
Procedure Initiated Information element name Information element required
Information element description Realm Availability Notification IMS-AGW
Context M This information element indicates all context are applicable for
the root termination. Root Termination M This information element indicates
that root termination is where the realm availability monitoring was
activated. Realm Availability Changes M This information element notifies the
IMS-ALG of newly available/unavailable IP Realms. Realm Availability
Notifcation Ack IMS-ALG Context M This information element indicates all
context are where the command was executed. Root Termination M This
information element indicates that root termination is where the command was
executed.
* * *
## 8.25 IP Bearer Released
Table 8.25.1: Procedures between IMS-ALG and IMS-AGW: IP Bearer Released
* * *
Procedure Initiated Information element name Information element required
Information element description IP Bearer Released IMS-AGW Context M This
information element indicates the context for the bearer termination. Bearer
Termination M This information element indicates the bearer termination where
the bearer was released. Bearer Released M This information element notifies a
bearer release. Release Cause M This information element indicates the cause
of a bearer release. IP Bearer Released Ack IMS-ALG Context M This information
element indicates all context are where the command was executed. Bearer
Termination M This information element indicates that Bearer termination is
where the command was executed.
* * *
## 8.26 Media Inactivity Notification
This command is used to notify the IMS-ALG of media inactivity on the IMS-AGW.
Table 8.26.1: Procedures between IMS-ALG and IMS-AGW: Media Inactivity
Notification
* * *
Procedure Initiated Information element name Information element required
Information element description Media Inactivity Notification IMS-AGW Context
M This information element indicates the existing context for the bearer
termination. Bearer Termination M This information element indicates that
bearer termination is where the media inactivity detection was activated.
Media Inactivity M This information element notifies the IMS-ALG of Media
inactivity detection on the bearer termination. Media Inactivity Notification
Ack IMS-ALG Context M This information element indicates the context where the
command was executed. Bearer Termination M This information element indicates
the bearer termination where the command was executed.
* * *
## 8.27 Termination Out-of-Service
This procedure is used to indicate that a termination on the IMS-AGW has gone
out of service
Table 8.27.1: Procedures between IMS-ALG and IMS-AGW: Termination Out-of-
Service
* * *
Procedure Initiated Information element name Information element required
Information element description Termination Out-of-Service IMS-AGW Context M
This information element indicates the context for the command. Bearer
Termination M This information element indicates the bearer termination(s) for
the command. Reason M This information element indicates the reason for
service change. Method M This information element indicates the method for
service change. Termination Out-of-Service Ack IMS-ALG Context M This
information element indicates the context where the command was executed.
Bearer Termination M This information element indicates the bearer
termination(s) where the command was executed.
* * *
## 8.28 Change Through-Connection
This procedure is used to change the through-connection in the bearer
termination
Table 8.28.1: Procedures between IMS-ALG and IMS-AGW: Change Through-
Connection
* * *
Procedure Initiated Information element name Information element required
Information element description Change Through-Connection IMS-ALG
Context/Context Request M This information element indicates the existing
context or requests a new context for the bearer termination. Bearer
Termination/Bearer Termination Request M This information element indicates
the existing bearer termination or requests a new bearer termination where the
through-connection is changed. Through-Connection M This information element
indicates the through-connection of the bearer termination Change Through-
Connection Ack IMS-AGW Context M This information element indicates the
context where the command was executed. Bearer Termination M This information
element indicates the bearer termination where the command was executed.
* * *
NOTE: This procedure may be combined with Reserve and Configure AGW Connection
Point, Reserve AGW Connection Point or Configure AGW Connection Point
procedure. This list of procedures is not exhaustive.
## 8.29 Change Flow Direction
This procedure is used to change the flow direction between bearer
terminations within the context.
Table 8.29: Procedures between IMS-ALG and IMS-AGW: Configure AGW Connection
Point
* * *
Procedure Initiated Information element name Information element required
Information element description Change Flow Direction IMS-ALG Context/Context
Request M This information element indicates the existing context or a new
context where the flow direction is changed. Bearer Termination 1/ Bearer
Termination 1 Request M This information element indicates the existing bearer
termination or a new bearer termination from where the new flow direction is
applied. Bearer Termination 2/ Bearer Termination 2 Request M This information
element indicates the existing bearer termination or a new bearer termination
where to the new flow direction is applied. Flow Direction M This information
element indicates the flow direction from the bearer termination 1 to bearer
termination 2 within the context. Change Flow Direction Ack IMS-AGW Context M
This information element indicates the context where the command was executed.
* * *
## 8.30 ECN Failure Indication
This procedure is used to report ECN related failures (see clause 6.2.13.4).
Table 8.30.1: Procedures between IMS-ALG and IMS-AGW: ECN Failure Indication
* * *
Procedure Initiated Information element name Information element required
Information element description ECN Failure Indication IMS-AGW Context M This
information element indicates the context for the bearer termination. Bearer
Termination M This information element indicates the bearer termination for
which the ECN failure is reported. ECN Error Indication M This information
element indicates an ECN failure event. ECN Failure Indication Ack IMS-ALG
Context M This information element indicates the context where the command was
executed. Bearer Termination M This information element indicates the bearer
termination where the command was executed.
* * *
## 8.31 Notify (D)TLS session establishment Failure Indication
This procedure is used to report (D)TLS session establishment failures.
Table 8.31.1: Procedures between IMS-ALG and IMS-AGW: (D)TLS session
establishment Failure Indication
* * *
Procedure Initiated Information element name Information element required
Information element description (D)TLS session establishment Failure
Indication IMS-AGW Context M This information element indicates the context
for the bearer termination. Bearer Termination M This information element
indicates the bearer termination for which the (D)TLS session establishment
failure is reported. (D)TLS session establishment Error Indication M This
information element indicates a (D)TLS session establishment failure event.
(D)TLS session establishment Failure Indication Ack IMS-ALG Context M This
information element indicates the context where the command was executed.
Bearer Termination M This information element indicates the bearer termination
where the command was executed.
* * *
## 8.32 Notify TCP connection establishment Failure Indication
This procedure is used to report TCP connection establishment failures.
Table 8.32.1: Procedures between IMS-ALG and IMS-AGW: TCP connection
establishment Failure Indication
* * *
Procedure Initiated Information element name Information element required
Information element description TCP connection establishment Failure
Indication IMS-AGW Context M This information element indicates the context
for the bearer termination. Bearer Termination M This information element
indicates the bearer termination for which the TCP connection establishment
failure is reported. TCP connection establishment Error Indication M This
information element indicates a TCP connection establishment failure event.
TCP connection establishment Failure Indication Ack IMS-ALG Context M This
information element indicates the context where the command was executed.
Bearer Termination M This information element indicates the bearer termination
where the command was executed.
* * *
## 8.33 ICE Connectivity Check Result Notification
This procedure is used to report ICE connectivity check result for Full ICE
(see clause 6.2.17.3).
Table 8.33.1: Procedures between IMS-ALG and IMS-AGW: ICE Connectivity Check
Result Notification
* * *
Procedure Initiated Information element name Information element required
Information element description ICE Connectivity Check Result Notification
IMS-AGW Context M This information element indicates the context for the
bearer termination. Bearer Termination M This information element indicates
the bearer termination for which the ICE Connectivity Check Result is
reported. ICE Connectivity Check Result M This information element indicates
an ICE Connectivity Check Result event. ICE Connectivity Check Result
Notification Ack IMS-ALG Context M This information element indicates the
context where the command was executed. Bearer Termination M This information
element indicates the bearer termination where the command was executed.
* * *
## 8.34 ICE New Peer Reflexive Candidate Notification
This procedure is used to report ICE new peer reflexive candidate for Full ICE
(see clause 6.2.17.4).
Table 8.34.1: Procedures between IMS-ALG and IMS-AGW: ICE New Peer Reflexive
Candidate Notification
* * *
Procedure Initiated Information element name Information element required
Information element description ICE New Peer Reflexive Candidate Notification
IMS-AGW Context M This information element indicates the context for the
bearer termination. Bearer Termination M This information element indicates
the bearer termination for which the ICE New Peer Reflexive Candidate is
reported. ICE New Peer Reflexive Candidate M This information element
indicates an ICE New Peer Reflexive Candidate event. ICE New Peer Reflexive
Candidate Notification Ack IMS-ALG Context M This information element
indicates the context where the command was executed. Bearer Termination M
This information element indicates the bearer termination where the command
was executed.
* * *
## 8.35 STUN Consent Freshness Test Failure Notification
This procedure is used to report STUN consent freshness test failures.
Table 8.35.1: Procedures between eP-CSCF and eIMS-AGW: STUN Consent Freshness
Test Failure Notification
* * *
Procedure Initiated Information element name Information element required
Information element description STUN consent freshness test Failure
Notification eIMS-AGW Context M This information element indicates the context
for the bearer termination. Bearer Termination M This information element
indicates the bearer termination for which the STUN consent freshness test
failure is reported. STUN consent freshness test failure M This information
indicates a STUN consent freshness failure event. STUN consent freshness test
Failure Notification eP-CSCF Context M This information element indicates the
context where the command was executed. Bearer Termination M This information
element indicates the bearer termination where the command was executed.
* * *
## 8.36 Notify SCTP Stream Reset
Table 8.36.1: Procedures between IMS-ALG and IMS-AGW: Notify SCTP Stream Reset
* * *
Procedure Initiated Information element name Information element required
Information element description Notify SCTP Stream Reset IMS-AGW Context M
This information element indicates the context for the bearer termination.
Bearer Termination M This information element indicates the bearer termination
where the bearer was released. Received SCTP Stream Reset Request M This
information element indicates that an SCTP Stream reset request has been
received SCTP Stream ID M This information element indicates the SCTP Stream
ID of the related SCTP Stream. Notify SCTP Stream Reset Ack IMS-ALG Context M
This information element indicates all context are where the command was
executed. Bearer Termination M This information element indicates that Bearer
termination is where the command was executed.
* * *
## 8.37 Notify SCTP Stream Reset Result
Table 8.37.1: Procedures between IMS-ALG and IMS-AGW: Notify SCTP Stream Reset
Result
* * *
Procedure Initiated Information element name Information element required
Information element description Notify SCTP Stream Reset Result IMS-AGW
Context M This information element indicates the context for the bearer
termination. Bearer Termination M This information element indicates the
bearer termination where the bearer was released. Received SCTP Stream Reset
Result M This information element indicates that an SCTP Stream reset result
has been received and the received result. SCTP Stream ID M This information
element indicates the SCTP Stream ID of the related SCTP Stream. Notify SCTP
Stream Reset Result Ack IMS-ALG Context M This information element indicates
all context are where the command was executed. Bearer Termination M This
information element indicates that Bearer termination is where the command was
executed.
* * *
#