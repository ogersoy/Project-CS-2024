# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies detailed call flows of Network Data Analytics
over the Nnwdaf, Nsmf, Npcf, Nnsacf, Namf, Nnrf, Nnssf, Nnef, Naf, Ndccf,
Nadrf, Nmfaf and Nudm service-based interfaces and their relationship with the
flow level signalling in 5G system.
NOTE: The call flows depicted in this Technical Specification do not cover all
traffic cases.
The stage 2 definition and procedures of Network Data Analytics are contained
in 3GPP TS 23.288 [2] and 3GPP TS 23.502 [3]. The 5G System Architecture is
defined in 3GPP TS 23.501 [4].
Detailed definitions of the involved services are provided in 3GPP TS 29.520
[5], 3GPP TS 29.508 [6], 3GPP TS 29.523 [7], 3GPP TS 29.554 [8], 3GPP TS
29.521 [9], 3GPP TS 29.522 [10], 3GPP TS 29.591 [11], 3GPP TS 29.517 [12],
3GPP TS 29.574 [15], 3GPP TS 29.575 [16], 3GPP TS 29.576 [17], 3GPP TS 29.503
[22], 3GPP TS 29.510 [23], 3GPP TS 29.507 [24] and 3GPP TS 29.512 [25].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition of the 5G System are specified in 3GPP
TS 29.500 [13] and 3GPP TS 29.501 [14].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[5] 3GPP TS 29.520: \"5G System; Network Data Analytics Services; Stage 3\".
[6] 3GPP TS 29.508: \"5G System; Session Management Event Exposure Service;
Stage 3\".
[7] 3GPP TS 29.523: \"5G System; Policy Control Event Exposure Service; Stage
3\".
[8] 3GPP TS 29.554: \"5G System; Background Data Transfer Policy Control
Service; Stage 3\".
[9] 3GPP TS 29.521: \"5G System; Binding Support Management Service; Stage
3\".
[10] 3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs;
Stage 3\".
[11] 3GPP TS 29.591: \"5G System; Network Exposure Function Southbound
Services; Stage 3\".
[12] 3GPP TS 29.517: \"5G System; Application Function Event Exposure Service;
Stage 3\".
[13] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[14] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[15] 3GPP TS 29.574: \"5G System; Data Collection Coordination Services; Stage
3\".
[16] 3GPP TS 29.575: \"5G System; Analytics Data Repository Services; Stage
3\".
[17] 3GPP TS 29.576: \"5G System; Messaging Framework Adaptor Services; Stage
3\".
[18] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[19] 3GPP TS 28.532: \"Management and orchestration; Generic management
services\".
[20] 3GPP TS 29.536: \"5G System: Network Slice Admission Control Services;
Stage 3\".
[21] 3GPP TS 29.531: \"5G System: Network Slice Selection Services; Stage 3\".
[22] 3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".
[23] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[24] 3GPP TS 29.507: \"5G System; Access and Mobility Policy Control Service;
Stage 3\".
[25] 3GPP TS 29.512: \"5G System; Session Management Policy Control Service;
Stage 3\".
[26] 3GPP TS 29.510: \"5G System: Network function repository services; Stage
3\".
[27] 3GPP TS 28.552: \"Management and orchestration; 5G performance
measurements\".
[28] 3GPP TS 28.533: \"Management and orchestration; Architecture framework\".
[29] 3GPP TS 37.320: \" Radio measurement collection for Minimization of Drive
Tests (MDT); Overall description\".
[30] 3GPP TS 28.554: \" Management and orchestration; 5G end to end Key
Performance Indicators (KPI)\".
[31] 3GPP TS 28.550: \"Management and orchestration; Performance assurance\".
[32] 3GPP TS 37.320: \"Radio measurement collection for Minimization of Drive
Tests (MDT); Overall description; stage 2\".
[33] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol
specification\".
[34] 3GPP TS 36.331: \"Radio Resource Control (RRC); Protocol specification\".
[35] 3GPP TS 38.215: \"NR; Physical layer measurements\".
[36] 3GPP TS 28.310: \"Management and orchestration; Energy efficiency of
5G\".
[37] 3GPP TS 28.545: \"Management and orchestration; Fault Supervision (FS)\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
## 3.2 Symbols
None.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
ADRF Analytics Data Repository Function
AF Application Function
AMF Access and Mobility Management Function
AnLF Analytics Logical Function
DCCF Data Collection Coordination Function
MFAF Messaging Framework Adaptor Function
MDT Minimization of Drive Tests
ML Machine Learning
MTLF Model Training Logical Function
NEF Network Exposure Function
NRF Network Repository Function
NSACF Network Slice Admission Control Function
NWDAF Network Data Analytics Function
PCF Policy Control Function
SMF Session Management Function
UDM Unified Data Management
# 4 Reference Architecture for Data Analytics
## 4.1 General
For the enablement of network data analytics services, the NWDAF interacts
with different entities for different purposes:
\- Data Collection:
a) collecting Data from OAM and/or 5GC NFs (e.g. AMF);
b) collecting Data from untrusted AF via NEF; and/or
c) collecting Analytics and/or Data from 5GC NFs via DCCF or via DCCF together
with ADRF and/or MFAF or via NWDAF hosting DCCF i.e. an NWDAF that implements
DCCF functionality internally and supports the Nnwdaf_DataManagement API;
\- Analytics Exposure:
a) Exposing Analytics to 5GC NFs;
b) Exposing Analytics to untrusted AF via NEF; and/or
c) Exposing Analytics to 5GC NFs via DCCF or via DCCF together with ADRF
and/or MFAF or via NWDAF hosting DCCF and/or ADRF i.e. an NWDAF that
implements DCCF and/or ADRF functionality internally and supports the
Nnwdaf_DataManagement API;
\- Storing and Retrieving data in ADRF.
The entities mentioned above interact also with each other as described in the
procedures of clause 5.
## 4.2 Data Collection
As depicted in Figure 4.2-1, the 5G System architecture allows NWDAF to
collect data from any 5GC NF (e.g. AMF, SMF) and/or OAM directly or via DCCF,
DCCF together with ADRF and/or MFAF, or via NWDAF.
Figure 4.2-1: Data Collection Architecture
When DCCF, ADRF, MFAF or NWDAF hosting DCCF are present in the network,
whether the NWDAF directly contacts the Data Source NF or goes via the DCCF,
or NWDAF hosting DCCF is based on configuration of the NWDAF.
The Data Source NF may be AMF, SMF, UDM, AF, NSACF, NRF and/or NEF with the
related data collection procedures described in clause 5.5. The Data Source NF
may also be UPF while how to collect data from UPF is not defined in this
release of the specification. If the Data Source is OAM, The NWDAF may collect
relevant management data from the services in the OAM as configured by the
PLMN operator. The NWDAF may use the OAM services e.g. generic performance
assurance and fault supervision management services as defined in TS 28.532
[19], PM (Performance Management) services as defined in TS 28.550 [31] and/or
FS (Fault Supervision) services as defined in TS 28.545 [37].
For the specific analytics event, the applicable Data Source NF(s) and the
related data collection procedures and scope are descibed in the corresponding
analytics event subcluase within clause 5.7.
## 4.3 Analytics Exposure
As depicted in Figure 4.3-1, the 5G System architecture allows NWDAF to expose
data to any 5GC NF (e.g. AMF) directly or via DCCF/MFAF.
Figure 4.3-1: Analytics Exposing Architecture
When DCCF, ADRF, MFAF or NWDAF are present in the network, whether the
Analytics consumer directly contacts the NWDAF or goes via the DCCF or via the
NWDAF hosting DCCF and/or ADRF is based on configuration of the Analytics
consumer.
The Analytics consumer may be AMF, SMF, NSSF, PCF, AF, NEF, OAM and/or CEF
when directly contacts NWDAF with the related analytics exposure procedures
described in clause 5.2.2 and clause 5.2.3. The Analytics consumers may be
AMF, SMF, NSSF, PCF AF and/or NEF when contacts via the DCCF with the related
analytics exposure procedures described in clause 5.2.4 and clause 5.2.5.
For the specific analytics event, the applicable Analytics consumer(s) and the
related analytics exposure procedures and scope are descibed in the
corresponding analytics event subcluase within clause 5.7.
## 4.4 Data Storage and Retrieval
As depicted in Figure 4.4-1, the 5G System architecture allows the consumer to
store and retrieve the collected data in the ADRF directly or via DCCF/MFAF.
Figure 4.4-1: Data Storage and Retrieval Architecture
# 5 Signalling Flows for the Network Data Analytics Framework
## 5.1 General
This clause describes the Network Data Analytics related Signalling Flows,
including the procedures for analytics exposure, analytics aggregation from
multiple NWDAFs, analytics context and analytics subscription transferring
between different NWDAFs, ML model provisioning, data collection, specified
Network Data Analytics generation and the NWDAF discovery and selection. The
specific NF service operations which are used in these procedures are also
provided in the procedure descriptions.
## 5.2 Analytics Exposure Procedures
### 5.2.1 General
The analytics exposure procedures allow the NF service consumers (i.e. NFs,
OAM and AFs) to obtain the analytics information from the NWDAF.
### 5.2.2 Network data analytics Subscribe/Unsubscribe/Notify
#### 5.2.2.1 Analytics Subscribe/Unsubscribe/Notify initiated by 5GC NFs, OAM
or AFs
This procedure is used by the NF service consumers (i.e. NFs, OAM and AFs) to
subscribe to/unsubscribe from analytics information directly from the NWDAF,
it is also used by the NWDAF to notify the observed analytics event(s) to the
NF service consumer if subscribed before.
Figure 5.2.2.1-1: Analytics Subscribe/Unsubscribe/Notify initiated by 5GC NFs,
OAM or AFs
1\. In order to subscribe to notification(s) of analytics information from the
NWDAF, the NF service consumer invokes Nnwdaf_EventsSubscription_Subscribe
service operation by sending an HTTP POST request targeting the resource
\"NWDAF Events Subscriptions\". The request includes the subscribed events and
may include event filter information.
In order to update the existing subscription, the NF service consumer invokes
Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP PUT
request with Resource URI of the resource \"Individual NWDAF Event
Subscription\".
2\. The NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service
operation. Upon receipt of the HTTP POST request, if the subscription is
accepted to be created, the NWDAF responds to the NF service consumer with
\"201 Created\", and the URI of the created subscription is included in the
Location header field.
Upon receipt of the HTTP PUT request, if the subscription is accepted to be
updated, the NWDAF responds to the NF service consumer with \"200 OK\" or
\"204 No Content\"
3\. If the NWDAF observes the subscribed event(s), the NWDAF invokes
Nnwdaf_EventsSubscription_Notify service operation to report the event(s) by
sending an HTTP POST request with {notificationURI} as Notification URI.
4\. The NF service consumer sends an HTTP \"204 No Content\" response to the
NWDAF.
5\. In order to unsubscribe to the notification(s) of analytics information
from the NWDAF, the NF service consumer invokes
Nnwdaf_EventsSubscription_Unsubscribe service operation by sending an HTTP
DELETE request targeting the resource \"Individual NWDAF Event Subscription\",
to the NWDAF to unsubscribe from analytics information. The request includes
the event subscriptionId of the existing subscription that is to be deleted.
6\. The NWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service
operation. If the unsubscription is accepted, the NWDAF responds with \"204 No
Content\".
NOTE: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
service operations refer to 3GPP TS 29.520 [5].
#### 5.2.2.2 Analytics Subscribe/Unsubscribe/Notify initiated by AFs via the
NEF
This procedure is used by the AF to subscribe to/unsubscribe from analytics
information from the NWDAF via the NEF, it is also used by the NWDAF to notify
the analytics event(s) to the AF via the NEF, if subscribed before.
Figure 5.2.2.2-1: Analytics Subscribe/Unsubscribe/Notify initiated by AFs via
the NEF
1\. In order to subscribe to notification(s) of analytics exposure via the
NEF, the AF invokes the Nnef_AnalyticsExposure_Subscribe request by sending an
HTTP POST request message targeting the resource \"Analytics Exposure
Subscriptions\" as defined in clause 4.4.14.1 of 3GPP TS 29.522 [10].
In order to update an existing analytics exposure subscription, the AF shall
send an HTTP PUT request message to the NEF to the resource \"Individual
Analytics Exposure Subscription\" requesting to change the subscription.
2\. Upon receipt of the HTTP request from the AF, if the AF is authorized with
the requested analytics event(s) and the requested parameters comply with the
inbound restriction in the analytics exposure mapping, the NEF shall invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in step 1
in clause 5.2.2.1.
3\. The NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service
operation as described in step 2 in clause 5.2.2.1.
4\. Upon receipt of the HTTP request response from the NWDAF, the NEF shall
invoke the Nnef_AnalyticsExposure_Subscribe response message by mapping and
forwarding the response to the AF.
5\. If the NWDAF observes the subscribed event(s), the NWDAF invokes
Nnwdaf_EventsSubscription_Notify service operation as described in step 3 in
clause 5.2.2.1 to the NEF.
6\. If the NEF receives an analytics information notification from the NWDAF
indicating that the subscribed analytics event has been detected, the NEF
shall invoke the Nnef_AnalyticsExposure_Notify request by sending HTTP POST
request message provide a notification to the AF request including the
AnalyticsEventNotification data structure at least with the detected analytics
event identified by the notification URI together with the notification
correlation identifier received during creation of the Individual Analytics
Exposure Subscription.
7\. Upon receipt of the analytics event notification, the AF shall respond the
NEF with a \"204 No Content\" status code to confirm the received notification
in Nnef_AnalyticsExposure_Notify response message.
8\. The NEF shall forward the HTTP \"204 No Content\" response to the NWDAF.
9\. In order to delete an existing analytics exposure subscription, the AF
shall invoke the Nnef_AnalyticsExposure_Unsubscribe request by sending an HTTP
DELETE request message to the NEF to the resource \"Individual Analytics
Exposure Subscription\".
10\. If the NEF receives an HTTP DELETE request from the AF, the NEF shall
invoke the Nnwdaf_EventsSubscription_Unsubscribe service operation as
described in step 5 in clause 5.2.2.1.
11\. The NWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service
operation as described in step 6 in clause 5.2.2.1.
12\. The NEF shall forward the HTTP \"204 No Content\" response to the AF.
NOTE: Details of AnalyticsExposure API refer to clause 4.4.14 and clause 5.6
of 3GPP TS 29.522 [4].
### 5.2.3 Network data analytics information request
#### 5.2.3.1 Analytics information request initiated by 5GC NFs, OAM or AFs
This procedure is used by the NF service consumers (i.e. 5GC NFs, OAM and AFs)
to retrieve analytics information directly from the NWDAF.
Figure 5.2.3.1-1: Network data analytics info request procedure
1\. The NF Service Consumer invokes Nnwdaf_AnalyticsInfo_Request service
operation by sending an HTTP GET request targeting the resource \"NWDAF
Analytics\", to the NWDAF to request the analytics information. The request
includes analytics identifier and related event filter information.
2\. The NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation.
If the request is accepted, the response includes the requested analytics
information with \"200 OK\".
NOTE: For details of Nnwdaf_AnalyticsInfo_Request service operation refer to
3GPP TS 29.520 [5].
#### 5.2.3.2 Analytics information request initiated by AFs via the NEF
This procedure is used by the AFs to retrieve analytics information from the
NWDAF via the NEF.
Figure 5.2.3.2-1: Analytics Request initiated by AFs via the NEF
1\. In order to fetch analytics information, the AF invoke the
Nnef_AnalyticsExposure_Fetch request by sending an HTTP POST request message
to the NEF to the customized operation URI \"{apiRoot}/3gpp-
analyticsexposure/v1/fetch\" as defined in clause 4.4.14.2 of 3GPP TS 29.522
[10].
2\. Upon receipt of the HTTP request from the AF, if the AF is authorized with
the requested analytics event(s) and the requested parameters comply with the
inbound restriction in the analytics exposure mapping, the NEF shall invoke
the Nnwdaf_AnalyticsInfo_Request service operation as described in step 1 in
clause 5.2.3.1.
3\. The NWDAF responds with the analytics information as described in step 2
in clause 5.2.3.1 to the NEF.
4\. The NEF responds with the analytics information to the AF.
NOTE: Details of AnalyticsExposure API refer to clause 4.4.14 and clause 5.6
of 3GPP TS 29.522 [4].
### 5.2.4 Analytics Exposure via DCCF
This procedure is used by NF service consumer(s) based on local configuration,
to subscribe/unsubscribe to NWDAF analytics event(s) via the DCCF, and upon
the delivery option \"Delivery via DCCF\" configured on the DCCF, also used by
DCCF to notify the NF service consumer(s) of the analytics information via the
DCCF if subscribed before.
Figure 5.2.4-1: Analytics Exposure via DCCF
1\. In order to subscribe to notification(s) of analytics exposure via the
DCCF based on local configuration, the NF service consumer invokes the
Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST
request message targeting the resource \"DCCF Analytics Subscriptions\", the
HTTP POST message shall include the NdccfAnalyticsSubscription data structure
as request body with parameters as defined in clause 5.1.6.2.2 of 3GPP TS
29.574 [15].
2\. The DCCF keeps track of the analytics actively being collected for the
Analytics Subscription it is coordinating. The NWDAF or ADRF may register the
analytics data profile (may include the analytics data related service
operation, Analytics Specification, NWDAF ID or ADRF ID) with the DCCF. The
DCCF may then determine whether certain historical analytics data may be
available in the NWDAF or ADRF based on the analytics data profile and the
request time window.
If the historical analytics data handling is not applicable or not supported,
the DCCF shall proceed step 3a, skip step 3b, step 4b, step 5b, step 3c, step
4c and step 5c.
If the historical analytics data is available in an ADRF, the DCCF shall
proceed step 3a and step 3b, skip step 3c, step 4c and step 5c.
If the historical analytics data is available in an NWDAF, the DCCF shall
proceed step 3a and step 3c, skip step 3b, step 4b and step 5b.
3a. The DCCF shall determine whether the analytics requested are already being
collected.
If the requested analytics are already being collected by an NF service
consumer, the DCCF adds the new NF service consumer to the list of NF service
consumers that are subscribed for these analytics.
If the DCCF cannot handle the subscription request, shall take the error
handling as defined in clause 4.2.2.2.2 of 3GPP TS 29.574 [15]
If the DCCF determines that no subscriptions need to be created or modified
(e.g. because all the data can be made available either via pre-existing
subscriptions or because of the historical data handling) then step 4a and
step 5a are skipped.
3aa. The DCCF may respond to the Ndccf_DataManagement_Subscribe service
operation with HTTP \"201 Created\" status code with the message body
containing a representation of the created subscription if the DCCF add the
new NF service consumer to the list of NF service consumers that are
subscribed, or if error case happened may respond with corresponding error
information.
4a If the analytics requested at step 1 are not already available yet, the
DCCF shall invoke the Nnwdaf_EventsSubscription_Subscribe service operation by
sending an HTTP POST request message request to the NWDAF targeting the
resource \"NWDAF Events Subscriptions\" to subscribe to a new analytics
exposure subscription, or if the analytics subscribed in step 1 partially
matches an analytics that is already being collected by the DCCF from an
NWDAF, and a modification of this subscription to the NWDAF would satisfy both
the existing analytics subscriptions as well as the newly requested analytics,
by sending an HTTP PUT request to the resource \"Individual Analytics Exposure
Subscription\" to replace an existing analytics exposure subscription. The
request includes the subscribed event(s) and event filter information received
from the NF service consumer, mapping to the parameters as defined in clause
5.1 of 3GPP TS 29.520 [5].
NOTE: If the NWDAF instance or NWDAF Set is not identified by the NF service
consumer, the DCCF determines the NWDAF instances that can provide analytics.
If the consumer requested storage of analytics in an ADRF but an ADRF ID is
not provided by the NF service consumer, or the collected analytics is to be
stored in an ADRF according to configuration on the DCCF, the DCCF selects an
ADRF to store the collected analytics data.
5a The NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service
operation.
Upon receipt of the HTTP POST request, if the subscription is accepted to be
created, the NWDAF responds to the DCCF with \"201 Created\" status code, and
the URI of the created subscription is included in the Location header field.
Upon receipt of the HTTP PUT request, if the subscription is accepted to be
updated, the NWDAF responds to the DCCF with \"200 OK\" or \"204 No Content\"
status code.
3b If the historical analytics data handling is applicable, and the DCCF
determine to retrieve analytics data from the ADRF, the DCCF shall determine
which ADRF instances might provide the analytics.
4b In order to retrieve the historical analytics data from the ADRF, the DCCF
shall invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by
sending an HTTP POST request message targeting the resource \"ADRF Data
Retrieval Subscriptions\", the HTTP POST message shall include the
NadrfDataRetrievalSubscription data structure as request body with parameters
as defined in clause 5.1.6 of 3GPP TS 29.575 [16].
5b The ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service
operation.
Upon receipt of the HTTP POST request, if the subscription is accepted to be
created, the ADRF responds to the DCCF with \"201 Created\" status code, and
the URI of the created subscription is included in the Location header field.
3c If the historical analytics data handling is applicable, and the DCCF
determine to retrieve analytics data from the NWDAF, the DCCF shall determine
which NWDAF instances might provide the analytics as described and proceed
step 4c.
4c In order to retrieve the historical analytics data from the NWDAF, the DCCF
may invoke the Nnwdaf_EventsSubscription_Subscribe service operation by
sending an HTTP POST request message targeting the resource \"NWDAF Events
Subscriptions\", the HTTP POST message shall include the
NnwdafEventsSubscription data structure as request body with parameters as
defined in clause 5.1.6 of 3GPP TS 29.520 [5] or Nnwdaf_AnalyticsInfo_Request
request by sending an HTTP GET request message targeting the resource \"NWDAF
Analytics\" with parameters as defined in clause 5.2.3.2.3.1 of 3GPP TS 29.520
[5].
5c The NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request service operation.
> Upon receipt of the HTTP POST request, if the subscription is accepted to be
> created, the NWDAF responds to the DCCF with \"201 Created\" status code,
> and the URI of the created subscription is included in the Location header
> field.
6\. The DCCF responds to the Ndccf_DataManagement_Subscribe service operation
with HTTP \"201 Created\" status code with the message body containing a
representation of the created subscription.
7a. (conditional)When the analytics are available, the NWDAF invokes the
Nnwdaf_EventsSubscription_Notify service operation by sending an HTTP POST
request message to notify the analytics information to the DCCF.
8a. The DCCF responds to the Nnwdaf_EventsSubscription_Notify service
operation with HTTP \"204 No Content\" status code.
7b. (conditional)When the historical analytics data are available in the ADRF,
the ADRF shall invoke the Nadrf_DataManagement_RetrievalNotify service
operation by sending an HTTP POST request message to notify the historical
analytics or Fetch Instructions to the DCCF.
8b. The DCCF responds to the Nadrf_DataManagement_RetrievalNotify service
operation with HTTP \"204 No Content\" status code.
7c. (conditional)When the historical analytics data are available in the
NWDAF, the NWDAF may invoke the Nnwdaf_EventsSubscription_Notify service
operation by sending an HTTP POST request message to notify the historical
analytics data to the DCCF.
8c. The DCCF responds to the Nnwdaf_EventsSubscription_Notify service
operation with HTTP \"204 No Content\" status code.
9\. Upon the delivery option \"Delivery via DCCF\" configured on the DCCF. the
DCCF invokes the Ndccf_DataManagement_Notify service operation by sending HTTP
POST request message(s) to send the analytics data to all notification
endpoints indicated in step 1. Analytics sent to notification endpoints may be
processed and formatted by the DCCF so they conform to delivery requirements
for each NF service consumer or notification endpoint.
NOTE: According to Formatting Instructions provided by the NF service
consumer, multiple notifications from a NWDAF can be combined in a single
Ndccf_DataManagement_Notify so many notifications from an NWDAF results in
fewer notifications (or one notification) to the NF service consumer.
Alternatively, a notification can instruct the analytics notification endpoint
to fetch the analytics from the DCCF.
10\. The NF service consumer responds to the Ndccf_DataManagement_Notify
service operation with HTTP \"204 No Content\" status code.
11\. (conditional) The NF service consumer invokes the
Ndccf_DataManagement_Fetch service operation by sending an HTTP GET request
message to fetch the analytics from the DCCF before an expiry time, if
received the fetch instruction in NdccfDataManagement_Notify service operation
in step 9.
12\. The NF service consumer responds to the Ndccf_DataManagement_Fetch
service operation with HTTP \"204 No Content\" status code.
13\. When the NF service consumer no longer need the subscription to the
analytics requested in step 1, shall invoke the
Ndccf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE
request message with \"{xxx}\" as Resource URI, where \"{subscriptionId}\" is
the event subscriptionId of the existing subscription that is to be deleted.,
using the Subscription Correlation Id received in response to its subscription
in step 1. The DCCF removes the NF service consumer from the list of NF
service consumers that are subscribed for these analytics.
14\. The DCCF responds to the Ndccf_DataManagement_Unsubscribe service
operation with HTTP \"204 No Content\" status code, upon removed the NF
service consumer from the list of NF service consumers that are subscribed for
these analytics
15a. If there are no other NF service consumers subscribed to the analytics,
the DCCF invokes the Nnwdaf_EventsSubscription_Unsubscribe service operation
by sending an HTTP DELETE request message to the NWDAF.
16a. The NWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service
operation with HTTP \"204 No Content\" status code, upon the analytics
event(s) subscription is removed.
15b. If DCCF determines that no other NF service consumers requiring the
historical analytics data from the ADRF, the DCCF may invoke the
Nadrf_DataManagement_RetrievalUnSubscribe service operation by sending an HTTP
DELETE request message to the ADRF.
16b. The ADRF responds to the Nadrf_DataManagement_RetrievalUnSubscribe
service operation with HTTP \"204 No Content\" status code, upon the analytics
data retrieval subscription is removed.
### 5.2.5 Analytics Exposure via DCCF and MFAF
This procedure is used by NF service consumer(s) based on local configuration,
to subscribe/unsubscribe to NWDAF analytics event(s) via the DCCF, and upon
the delivery option \"Delivery via Messaging Framework \" configured on the
DCCF, the 3GPP DCCF Adaptor (3da) Data Management service and 3GPP Consumer
Adaptor (3ca) Data Management service of the Messaging Framework Adaptor
Function (MFAF) are used to interact with the 3GPP Network and the Messaging
Framework for analytics information delivery to the NF service consumer(s)
subscribed notification endpoint(s).
Figure 5.2.5-1: Analytics Exposure via DCCF and Messaging Framework
1\. In order to subscribe to notification(s) of analytics exposure via the
DCCF based on local configuration, the NF service consumer invokes the
Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST
request message targeting the resource \"DCCF Analytics Subscriptions\", the
HTTP POST message shall include the NdccfAnalyticsSubscription data structure
as request body with parameters as defined in clause 5.1.6.2.2 of 3GPP TS
29.574 [15].
2\. Upon the delivery option \"Delivery via MFAF\" configured on the DCCF, in
order to create configuration of mapping data in the MFAF, the DCCF shall
invoke the Nmfaf_3daDataManagement_Configure service operation by sending an
HTTP POST request message targeting the resource \"MFAF Configurations\", the
HTTP POST message shall include the MfafConfiguration data structure as
request body with parameters as defined in clause 5.1.6 of 3GPP TS 29.576
[17].
3\. The MFAF responds to the Nmfaf_3daDataManagement_Configure service
operation.
Upon receipt of the HTTP POST request, if the configuration is accepted to be
created, the MFAF responds to the DCCF with \"201 Created\", and the URI of
the created configuration is included in the Location header field.
4\. The DCCF keeps track of the analytics actively being collected for the
Analytics Subscription it is coordinating. The NWDAF or ADRF may register the
analytics data profile (may include the analytics data collection related
service operation, Analytics Specification, NWDAF ID or ADRF ID) with the
DCCF. The DCCF may then determine whether certain historical analytics data
may be available in the NWDAF or ADRF based on the analytics data profile and
the request time window.
If the historical analytics data handling is not applicable or not supported,
the DCCF shall proceed step 5a, skip step 5b step 6b, step 7b, step 5c step 6c
and step 7c.
If the historical analytics data is available in an ADRF, the DCCF shall
proceed step 5a and step 5b, skip step 5c, step 6c and step 7c.
If the historical data is available in an NWDAF, the DCCF shall proceed step
5a and step 5c, skip step 5b, step 6b and step 7b.
5a. The DCCF shall determine whether the analytics data requested in step 1
are already being collected.
If the analytics data requested are already being collected by an NF service
consumer, the DCCF adds the NF service consumer to the list of analytics
consumers that are subscribed for these data.
If the DCCF cannot handle the subscription request, shall take the error
handling as defined in clause 4.2.2.2.2 of 3GPP TS 29.574 [15]
If the DCCF determines that no subscriptions need to be created or modified
(e.g. because all the data can be made available either via pre-existing
subscriptions or because of the historical data handling) then step 6a and
step 7a are skipped.
5aa. The DCCF may respond to the Ndccf_DataManagement_Subscribe service
operation with HTTP \"201 Created\" status code with the message body
containing a representation of the created subscription if the DCCF adds the
new NF service consumer to the list of NF service consumers that are
subscribed, or if error case happened may respond with corresponding error
information.
6a If the requested data at step 1 are not already available yet, the DCCF
shall invoke the Nnwdaf_EventsSubscription_Subscribe service operation by
sending an HTTP POST request message request to the NWDAF targeting the
resource \"NWDAF Events Subscriptions\" to subscribe to a new analytics
exposure subscription, or if the analytics subscribed in step 1 partially
matches an analytics that is already being collected by the DCCF from an
NWDAF, and a modification of this subscription to the NWDAF would satisfy both
the existing analytics subscriptions as well as the newly requested analytics,
by sending an HTTP PUT request to the resource \"Individual Analytics Exposure
Subscription\" to replace an existing analytics exposure subscription. The
request includes the subscribed event(s) and event filter information received
from the NF service consumer, mapping to the parameters as defined in clause
5.1 of 3GPP TS 29.520 [5].
NOTE 1: If the NWDAF instance or NWDAF Set is not identified by the NF service
consumer, the DCCF determines the NWDAF instances that can provide analytics.
If the consumer requested storage of analytics in an ADRF but an ADRF ID is
not provided by the NF service consumer, or the collected analytics is to be
stored in an ADRF according to configuration on the DCCF, the DCCF selects an
ADRF to store the collected data.
7a The NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service
operation.
Upon receipt of the HTTP POST request, if the subscription is accepted to be
created, the NWDAF responds to the DCCF with \"201 Created\" status code, and
the URI of the created subscription is included in the Location header field.
Upon receipt of the HTTP PUT request, if the subscription is accepted to be
updated, the NWDAF responds to the DCCF with \"200 OK\" or \"204 No Content\"
status code.
5b If the historical analytics data handling is applicable, and the DCCF
determine to retrieve analytics data from the ADRF, the DCCF shall determine
which ADRF instances might provide the analytics.
6b In order to retrieve the historical analytics data from the ADRF, the DCCF
shall invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by
sending an HTTP POST request message targeting the resource \"ADRF Data
Retrieval Subscriptions\", the HTTP POST message shall include the
NadrfDataRetrievalSubscription data structure as request body with parameters
as defined in clause 5.1.6 of 3GPP TS 29.575 [16].
7b The ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service
operation.
Upon receipt of the HTTP POST request, if the subscription is accepted to be
created, the ADRF responds to the DCCF with \"201 Created\" status code, and
the URI of the created subscription is included in the Location header field.
5c If the historical data handling is applicable, and the DCCF determines to
retrieve analytics data from the NWDAF, the DCCF shall determine which NWDAF
instances might provide the analytics as described and proceed step 6c.
6c In order to retrieve the historical analytics data from the NWDAF, the DCCF
may invoke the Nnwdaf_EventsSubscription_Subscribe service operation by
sending an HTTP POST request message targeting the resource \"NWDAF Events
Subscriptions\", the HTTP POST message shall include the
NnwdafEventsSubscription data structure as request body with parameters as
defined in clause 5.1.6 of 3GPP TS 29.520 [5] or Nnwdaf_AnalyticsInfo_Request
request by sending an HTTP GET request message targeting the resource \"NWDAF
Analytics\" with parameters as defined in clause 5.2.3.2.3.1 of 3GPP TS 29.520
[5].
7c The NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe or
Nnwdaf_AnalyticsInfo_Request service operation.
Upon receipt of the HTTP POST request, if the subscription is accepted to be
created, the NWDAF responds to the DCCF with \"201 Created\", and the URI of
the created subscription is included in the Location header field.
8\. The DCCF responds to the Ndccf_DataManagement_Subscribe service operation
with HTTP \"201 Created\" status code with the message body containing a
representation of the created subscription.
9a. (conditional)When the analytics are available, the NWDAF invokes the
Nnwdaf_EventsSubscription_Notify service operation by sending an HTTP POST
request message to notify the analytics information to the MFAF.
10a. The MFAF responds to the Nnwdaf_EventsSubscription_Notify service
operation with HTTP \"204 No Content\" status code.
11a. The MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by
sending HTTP POST request message(s) to send the analytics data to all
notification endpoints indicated in step 1. Analytics data sent to
notification endpoints may be processed and formatted by the MFAF so that they
conform to delivery requirements for each NF service consumer and/or
notification endpoint.
NOTE 2: According to Formatting Instructions provided by the NF service
consumer, multiple notifications from the NWDAF can be combined in a single
Nmfaf_3caDataManagement_Notify so that many notifications from an NWDAF result
in fewer notifications (or one notification) to the NF service consumer and/or
the subscribed notification endpoint(s). Alternatively, a notification can
instruct the analytics data notification endpoint to fetch the analytics data
from the MFAF.
12a.The NF service consumer responds to the Nmfaf_3caDataManagement_Notify
service operation with HTTP \"204 No Content\" status code.
9b. (conditional)When the historical analytics data are available in the ADRF,
the ADRF shall invoke the Nadrf_DataManagement_RetrievalNotify service
operation by sending an HTTP POST request message to notify the historical
analytics or Fetch Instructions to the MFAF.
10b. The MFAF responds to the Nadrf_DataManagement_RetrievalNotify service
operation with HTTP \"204 No Content\" status code.
11b. The MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by
sending HTTP POST request message(s) to send the analytics data to all
notification endpoints indicated in step 1. Analytics data sent to
notification endpoints may be processed and formatted by the MFAF so that they
conform to delivery requirements for each NF service consumer or notification
endpoint.
NOTE 3: According to Formatting Instructions provided by the NF service
consumer, multiple notifications from an ADRF can be combined in a single
Nmfaf_3caDataManagement_Notify so many notifications from an ADRF results in
fewer notifications (or one notification) to the NF service consumer and/or
the subscribed notification endpoint(s). Alternatively, a notification can
instruct the analytics data notification endpoint to fetch the analytics data
from the MFAF.
12b.The NF service consumer responds to the Nmfaf_3caDataManagement_Notify
service operation with HTTP \"204 No Content\" status code.
9c. (conditional)When the historical analytics data are available in the
NWDAF, the NWDAF may invoke the Nnwdaf_EventsSubscription_Notify service
operation by sending an HTTP POST request message to notify the historical
analytics data to the MFAF.
10c. The MFAF responds to the Nnwdaf_EventsSubscription_Notify service
operation with HTTP \"204 No Content\" status code.
11c. The MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by
sending HTTP POST request message(s) to send the analytics data to all
notification endpoints indicated in step 1. Analytics data sent to
notification endpoints may be processed and formatted by the MFAF so they
conform to delivery requirements for each NF service consumer or notification
endpoint.
NOTE 4: According to Formatting Instructions provided by the NF service
consumer, multiple notifications from a NWDAF can be combined in a single
Nmfaf_3caDataManagement_Notify so many notifications from an NWDAF results in
fewer notifications (or one notification) to the NF service consumer and/or
the subscribed notification endpoint(s). Alternatively, a notification can
instruct the analytics data notification endpoint to fetch the analytics data
from the MFAF.
12c.The NF service consumer responds to the Nmfaf_3caDataManagement_Notify
service operation with HTTP \"204 No Content\" status code.
13\. (conditional) The NF service consumer invoke the
Nmfaf_3caDataManagement_Fetch service operation by sending an HTTP GET request
message to fetch the data from the MFAF before an expiry time, if received the
fetch instruction in Nmfaf_3caDataManagement_Notify service operation in step
11a, step 11b or step 11c.
14\. The MFAF responds to the Nmfaf_3caDataManagement_Fetch service operation
with HTTP \"200 OK\" status code with the message body containing the
NmfafResourceRecord data structure.
15\. When the NF service consumer no longer need the subscription to the
requested data in step 1, shall invoke the Ndccf_DataManagement_Unsubscribe
service operation by sending an HTTP DELETE request message with
\"{apiRoot}/nnwdaf-datamanagement/v1/subscriptions/{subscriptionId}\" as
Resource URI, where \"{subscriptionId}\" is the event subscriptionId of the
existing subscription that is to be deleted., using the Subscription
Correlation Id received in response to its subscription in step 1. The DCCF
removes the NF service consumer from the list of NF service consumers that are
subscribed for these analytics data.
16\. The DCCF responds to the Ndccf_DataManagement_Unsubscribe service
operation with HTTP \"204 No Content\" status code, upon removed the NF
service consumer from the list of NF service consumers that are subscribed for
these analytics data.
17a. If there are no other NF service consumers subscribed to the analytics
data, the DCCF invoke the Nnwdaf_EventsSubscription_Unsubscribe service
operation by sending an HTTP DELETE request message to the NWDAF.
18a. The DWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service
operation with HTTP \"204 No Content\" status code, upon the analytics
event(s) subscription is removed.
17b. If DCCF determines that no other NF service consumers requiring the
historical analytics data from the ADRF, the DCCF may invoke the
Nadrf_DataManagement_RetrievalUnSubscribe service operation by sending an HTTP
DELETE request message to the ADRF.
18b. The ADRF responds to the Nadrf_DataManagement_RetrievalUnSubscribe
service operation with HTTP \"204 No Content\" status code, upon the data
retrieval subscription is removed.
17c. When DCCF determines that NF service consumer mapping has to be removed
from MFAF, the DCCF may invoke the Nmfaf_3daDataManagement_Deconfigure service
operation by sending an HTTP DELETE request message to the MFAF.
18c. The MFAF responds to the Nmfaf_3daDataManagement_Deconfigure service
operation with HTTP \"204 No Content\" status code, upon removing the
individual resource linked to the delete request.
## 5.3 Analytics Aggregation from Multiple NWDAFs
### 5.3.1 General
Analytics Aggregation refers to the case in which an NWDAF with respective
capabilities aggregates the analytics provided by other NWDAFs to serve a
request from an NF service consumer.
If multiple NWDAFs are deployed, an NWDAF instance may be specialized to
provide Analytics for one or more Analytics event(s). Each NWDAF instance may
serve a certain Area of Interest or TAI(s) and multiple NWDAFs may be needed
to serve a particular Analytics event collectively. An NWDAF may have the
capability to aggregate the Analytics (per Analytics event) received from the
other NWDAFs and/or the Analytics generated by itself. Analytics aggregation
applies to scenarios where NWDAF service consumer requests or subscribes to
analytics with or without provisioning of Area of Interest.
### 5.3.2 Analytics aggregation with provisioning of Area of Interest
This procedure is used by the service consumer to request Analytics event(s)
for an Area of Interest, in which multiple NWDAFs are required to serve the
request collectively.
Figure 5.3.2-1: Analytics aggregation with provisioning of Area of Interest
1a-1c. In order to obtain the specific network data analytics, the NF service
consumer selects an NWDAF (e.g. NWDAF1) with aggregation capability according
to the results returned by NRF or available information obtained by other
means. The NWDAF service consumer invokes Nnwdaf_AnalyticsInfo_Request or
Nnwdaf_EventsSubscription_Subscribe service operations as described in clause
5.2.3.1 and clause 5.2.2.1 to the selected NWDAF.
> In the request message, the analytics event, analytics filter information
> including the Area of Interest (e.g. TAI-1, TAI-2, TAI-n, if available) and
> the Target of Analytics Reporting are provided. The NWDAF service consumer
> may indicate the time when the analytics is needed in \"timeAnaNeeded\"
> attribute, which needs to be equal or greater than the supported Analytics
> Delay per Analytics event of the Aggregator NWDAF.
2-5b. The Aggregator NWDAF selects the other NWDAF instances, which
collectively can cover the area of interest indicated in the request,
according to the results returned by the NRF and/or the UDM, or available
information obtained by other means. The Aggregator NWDAF invokes
Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service
operations to each selected NWDAF (e.g. NWDAF2, NWDAF3) as described in clause
4.2.2.2 or clause 4.3.2.2 of 3GPP TS 29.520 [5].
6-9b. The selected NWDAFs send response or notification containing the
requested analytics to the Aggregator NWDAF. If the selected NWDAFs (e.g.
NWDAF 2 and/or NWDAF 3) cannot reply or notify the requested analytics before
the expiry of the time that the Aggregator NWDAF has indicated, they may send
an error response or error notification to the Aggregator NWDAF including a
\"revised waiting time\" in \"rvWaitTime\" attribute.
10\. The Aggregator NWDAF aggregates the analytics received from the selected
NWDAFs and the analytics of its own.
11a-11c. The Aggregator NWDAF sends a response or notification containing the
aggregated output analytics for the requested Analytics event(s) to the NWDAF
service consumer.
If the Aggregator NWDAF cannot reply or notify the requested analytics before
the expiry of the time that the consumer has indicated in \"timeAnaNeeded\"
attribute, it may sends an error response or error notification to the
consumer including a \"revised waiting time\" in \"rvWaitTime\" attribute.
### 5.3.3 Analytics aggregation without provisioning of Area of Interest
This procedure is used by the service consumer to request Analytics event(s)
without providing an Area of Interest, in which multiple NWDAFs are required
to serve the request collectively.
Figure 5.3.3-1: Analytics aggregation without provisioning of Area of Interest
1a-1c. In order to obtain the specific network data analytics, the NF service
consumer selects an NWDAF (e.g. NWDAF1) with aggregation capability according
to the results returned by NRF or available information obtained by other
means. The NWDAF service consumer invokes Nnwdaf_AnalyticsInfo_Request or
Nnwdaf_EventsSubscription_Subscribe service operations as described in clause
5.2.3.1 and clause 5.2.2.1 to the selected NWDAF. If not, the NWDAF service
consumer should select a NWDAF with large serving area from the candidate
NWDAFs which supports analytics aggregation, e.g. NWDAF1.
2a-4b. If the requested analytics requires UE location information, e.g. for
the Analytics events \"UE_MOBILITY\", \"ABNORMAL_BEHAVIOUR\", or
\"USER_DATA_CONGESTION\", then:
\- 2a-2b: The Aggregator NWDAF may query UDM to discover the NWDAF serving the
UE by invoking Nudm_UECM_Get service operation as described in clause
5.3.2.5.12 of 3GPP TS 29.503 [23], if it is supported.
\- 3a-4b: The Aggregator NWDAF may determine the AMF serving the UE, then
requests UE location information from the AMF by invoking
Namf_EventExposure_Subscribe service operation as described in clause
5.3.2.2.2 of 3GPP TS 29.518 [18]. The AMF notifies the UE location information
by invoking Namf_EventExposure_Notify service operation as described in 3GPP
TS 29.518 [18] clause 5.3.2.4.
5\. If the requested analytics does not require UE location information, e.g.
for the Analytics events \"SERVICE_EXPERIENCE\", \"NF_LOAD\", or \"UE_COMM\",
the Aggregator NWDAF can determine the NFs to be contacted for data
collection.
6\. With the data obtained in step 3a-5, the Aggregator NWDAF may query the
NRF for discovering the required NWDAF, by sending an NF discovery request
including UE location or NF serving area as a filter to NRF, and obtains
candidates target NWDAF(s) that can provide the required analytics.
7\. If a single target NWDAF (e.g. NWDAF2) can provide the requested analytics
data, the Aggregator NWDAF can redirect the Nnwdaf_AnalyticsInfo_Request to
that target NWDAF or request an analytics subscription transfer to that target
NWDAF.
8\. If the Aggregator NWDAF decides to request analytics from one or more
target NWDAFs, the steps 2-9b of the analytics aggregation procedure in clause
5.3.2 are executed.
## 5.4 Procedures for Analytics Transferring
### 5.4.1 Analytics context transfer initiated by target NWDAF selected by the
NWDAF service consumer
The procedure in below figure is used when an NWDAF service consumer decides
to select a new NWDAF instance due to internal or external triggers, e.g. the
NWDAF service consumer starts serving a UE with analytics subscription
information received upon UE context transfer procedure as described in 3GPP
TS 23.502 [3], or the NWDAF service consumer starts to request NF related
analytics, or the NWDAF service consumer receives a \"Termination Request\"
for an existing analytics subscription from an NWDAF. The NWDAF service
consumer sends to the target NWDAF information about the NWDAF previously used
for analytics subscription, if available, in
Nnwdaf_EventsSubscription_Subscribe service operation. The target NWDAF may
initiate the transfer of the analytics context, using the
Nnwdaf_AnalyticsInfo_ContextTransfer.
The procedure in below figure is also used when an Aggregator NWDAF, as the
NWDAF service consumer, decides to select a new NWDAF to request output
analytics for analytics aggregation. For example, upon receiving a Termination
Request from one of the NWDAFs that are collectively serving a request for
analytics subscription, the Aggregator NWDAF queries the NRF or UDM to select
a target NWDAF using information e.g. the UE location, the 5GC NFs (identified
by their NF Set IDs or NF types) serving the UE or to be contacted for data
collection (if Area of Interest is not provisioned for the requested
analytics), or the subset of AoI (if Area of Interest is provisioned for the
requested analytics). Then, the Aggregator NWDAF sends information about the
NWDAF previously used for analytics subscription, if available, in
Nnwdaf_EventsSubscription_Subscribe service operation towards the selected
target NWDAF.
Figure 5.4.1-1: Analytics context transfer initiated by target NWDAF selected
by the NWDAF service consumer
0\. When the NWDAF service consumer (e.g. AMF) changes, the new NWDAF service
consumer may receive the old subscription information from the old NWDAF
service consumer.
1\. The NWDAF service consumer determines to select an NWDAF instance. The
NWDAF service consumer discovers and selects the target NWDAF as specified in
clause 5.8.
2\. To send a request for analytics subscription to the target NWDAF, the
NWDAF service consumer invokes Nnwdaf_EventsSubscription_Subscribe service
operation by sending the HTTP POST request message targeting the resource
\"NWDAF Events Subscriptions\" to the target NWDAF. The NWDAF service consumer
includes information on the previous analytics subscription (e.g., NWDAF ID
and Subscription ID) which relates to the requested analytics subscription, if
available. If the target NWDAF accepts the analytics subscription request, it
responds with HTTP \"201 Created\" to the NWDAF service consumer. Details are
described in clause 4.2.2.2 of 3GPP TS 29.520 [5].
If the target NWDAF does not receive information of previous analytics
subscription in step 2, for UE related Analytics, the target NWDAF may
discover previously used NWDAF in UDM as specified in clause 5.8.
NOTE: If the selected target NWDAF instance is the same as the source NWDAF
instance (as received from the other consumer in step 0), the new NWDAF
service consumer invokes Nnwdaf_EventsSubscription_Subscribe service operation
by sending the HTTP PUT request message targeting the resource \"Individual
NWDAF Event Subscription\" to the target NWDAF, and the target NWDAF will
update the existing analytics subscription to the new NWDAF service consumer.
Following steps are skipped.
3\. If the target NWDAF decides to request an analytics context transfer from
the previously used NWDAF, it invokes the Nnwdaf_AnalyticsInfo_ContextTransfer
service operation by sending the HTTP GET request message targeting the
resource \"NWDAF Context\" to the source NWDAF as described in clause 4.3.2.3
of 3GPP TS 29.520 [5].
Target NWDAF is now ready to generate analytics information by taking into
account the information received in step 3.
4\. [Optional] Source NWDAF may purge analytics context after completion of
step 3a, if performed, and if not already done, unsubscribes from the data
source(s) and/or model source(s) that are no longer needed for the remaining
analytics subscriptions.
5\. [Optional] Target NWDAF may subscribe to relevant data source(s) and/or
model source(s), if it is not yet subscribed to the data source(s) and/or
model source(s).
### 5.4.2 Analytics Subscription Transfer initiated by source NWDAF
The procedure in below figure is used by a source NWDAF instance to request
the transfer of analytics subscription(s) to another target NWDAF instance,
using the Nnwdaf_EventsSubscription_Transfer service operation.
If the source NWDAF discovers that the NWDAF service consumer may change
concurrently to this procedure, the source NWDAF should not perform the
procedure. In such a case, the source NWDAF may send a message to indicate to
the NWDAF service consumer that it will not serve this subscription anymore.
NOTE 1: To discover the possible change of NWDAF service consumer, if the
Analytics Event is UE related, the source NWDAF takes actions responding to
external trigger (such as UE mobility), for example, checking if the Target of
Analytics Reporting is still within the serving area of the analytics
consumer, if the serving area information is available.
NOTE 2: Handling of overload situation or preparation for a graceful shutdown
are preferably executed inside an NWDAF Set, when available, therefore, not
requiring an analytics subscription transfer as described in this clause.
Below procedure is applicable for analytics subscription transfer across NF
Sets or if the NWDAF is not deployed in a Set.
Figure 5.4.2-1: Analytics subscription transfer initiated by source NWDAF
0\. The NWDAF service consumer subscribes to analytics from source NWDAF. The
NWDAF service consumer may send its NF ID or serving area, enabling the source
NWDAF to determine whether the following analytics subscription transfer
procedure is applicable. Optionally the source NWDAF subscribes to UE mobility
events.
1\. [Optional] Source NWDAF determines, e.g. triggered by a UE mobility event
notification, to prepare an analytics subscription transfer to target NWDAF(s)
as described in clause 5.4.3 with steps 0-1, 5- 6 will be followed.
2\. Source NWDAF determines, e.g. based on the UE location information
received and the analytics consumer\'s serving area either directly received
in step 0 or indirectly received via NRF, to perform an analytics subscription
transfer to target NWDAF(s). Therefore, the source NWDAF determines the
analytics subscription(s) to be transferred to a target NWDAF.
3\. Source NWDAF performs an NWDAF discovery and selects the target NWDAF.
NWDAF discovery may be skipped if the target NWDAF had already been discovered
as part of a prepared analytics subscription transfer. In the case of
aggregated analytics from multiple NWDAFs, the source NWDAF may use the set of
NWDAF identifiers related to aggregated analytics to preferably select a
target NWDAF that is already serving the consumer.
4\. Source NWDAF requests, using Nnwdaf_EventsSubscription_Transfer service
operation, a transfer of the analytics subscription(s) determined in step 2 to
the target NWDAF as described in clause 4.2.2.5 of 3GPP TS 29.520 [5], the
response message in step 4b is optional.
5\. Target NWDAF accepts the analytics subscription transfer and takes over
the analytics generation based on the information received from the source
NWDAF.
The ML model related information namely ModelInfo may be provided by the
source NWDAF in the Nnwdaf_EventsSubscription_Transfer request message.
\- If the instance ID or set ID of NWDAF(s) containing MTLF carried in
\"modelProvIds\" attribute is provided in the
Nnwdaf_EventsSubscription_Transfer, target NWDAF may request or subscribe to
the ML model(s) from the indicated NWDAF(s).
NOTE 3: If the provided ID(s) of NWDAF(s) containing MTLF carried in
\"modelProvIds\" attribute are not part of the locally configured ID(s) of
NWDAFs containing MTLF, the target NWDAF discovers the NWDAF(s) containing
MTLF as described in clause 5.8.2.3.
\- When the source NWDAF itself provides the ML models, the address of ML
model files may be provided, and the target NWDAF retrieves the ML model(s)
from the indicated address.
Target NWDAF may use the above retrieved ML models and the ML models retrieved
from the locally configured NWDAFs containing MTLF for the transferred
analytics subscription.
NOTE 4: If not yet done during a prepared analytics subscription transfer, the
target NWDAF allocates a new Subscription ID to the received analytics
subscriptions.
NOTE 5: The target NWDAF might already have received information on some/all
of the analytics subscriptions as part of the prepared analytics subscription
transfer request received in step 1 and, thus, might already have started to
prepare for the analytics generation, e.g. by having already subscribed to
relevant event notifications.
6\. Target NWDAF informs the NWDAF service consumer about the successful
analytics subscription transfer using a Nnwdaf_EventsSubscription_Notify
request message. A new Subscription ID, which was assigned by the target
NWDAF, is provided in the Subscription ID and the old Subscription Id, which
was allocated by the source NWDAF, is provided in the Old Subscription ID
parameter of this message.
NOTE 6: Notification correlation information in the
Nnwdaf_EventsSubscription_Notify message allows the NWDAF service consumer to
correlate the notifications to the initial subscription request made with the
source NWDAF in step 0.
NOTE 7: The existing Analytics context in the source NWDAF is not deleted
directly but will be purged first when it was collected by the target NWDAF.
NOTE 8: If this subscription is used as input for analytics aggregation by the
NWDAF service consumer, the NWDAF service consumer may inform the other NWDAFs
instance participating in this analytics aggregation that the Set of NWDAF
identifiers of NWDAF instances used by the NWDAF service consumer for this
analytics aggregation has changed using the
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
4.2.2.2 of 3GPP TS 29.520 [5].
7\. [Conditional] If \"analytics context identifier(s)\" had been included in
the Nnwdaf_EventsSubscription_Transfer Request received in step 4, the target
NWDAF requests the \"analytics context\" by invoking the
Nnwdaf_AnalyticsInfo_ContextTransfer service operation as described in clause
4.3.2.3 of 3GPP TS 29.520 [5].
8\. [Optional] Target NWDAF subscribes to relevant data source(s), if it is
not yet subscribed to the data source(s) for the data required for the
Analytics.
9\. [Optional] Target NWDAF confirms the analytics subscription transfer to
the source NWDAF by sending Nnwdaf_EventsSubscription_Transfer response
message as described in clause 4.2.2.5 of 3GPP TS 29.520 [5], if the response
has not been sent in step 4b.
10\. [Optional] Source NWDAF unsubscribes with the data source(s) that are no
longer needed for the remaining analytics subscriptions. In addition, Source
NWDAF unsubscribes with the NWDAF(s) containing MTLF, if exist, which are no
longer needed for the remaining analytics subscriptions.
NOTE 9: At this point, the analytics subscription transfer is deemed
completed, i.e. the source NWDAF can delete all information related to the
successfully transferred analytics subscription.
11-12. Target NWDAF at some point derives new output analytics based on new
input data and notifies the NWDAF service consumer about the new analytics
using a Nnwdaf_EventsSubscription_Notify message as described in clause
4.2.2.4 of 3GPP TS 29.520 [5].
### 5.4.3 Prepared analytics subscription transfer
The procedure in below figure is used by a NWDAF instance to request another
NWDAF instance for a prepared analytics subscription transfer from the source
NWDAF instance, using the Nnwdaf_EventsSubscription_Transfer service
operation.
NOTE 1: The source NWDAF might determine that it needs to prepare to transfer
analytics to another NWDAF instance, e.g. when the source NWDAF estimates for
UE related analytics subscription that the UE might enter an area which is not
covered by the source NWDAF (e.g., by subscribing to AMF event exposure
service for UE mobility event notifications, by performing UE mobility
analytics, or by subscribing to another NWDAF providing UE mobility
analytics). If the source NWDAF discovers that the analytics consumer may
change concurrently to this procedure, the source NWDAF does not perform the
procedure. If the procedure makes use of predictions to determine the
candidate NWDAFs, care must be taken with regards to load and signalling cost
when sending data to an NWDAF that will not eventually start serving the UE.
NOTE 2: The source NWDAF might also determine that it needs to prepare to
transfer analytics subscriptions to another NWDAF instance, as the source
NWDAF wants to resolve an internal load situation or prepare for a graceful
shutdown.
NOTE 3: Handling of overload situation or preparation for a graceful shutdown
are preferably executed inside an NWDAF Set, when available.
Figure 5.4.3-1: Prepared analytics subscription transfer
1a-1b. The NWDAF service consumer subscribes to analytics from source NWDAF by
invoking Nnwdaf_EventsSubscription_Subscribe service operation. The source
NWDAF responses to Nnwdaf_EventsSusbcription_Subscribe service operation.
2a-2b. The source NWDAF generates the requested analytics and notify the NWDAF
service consumer by invoking the Nnwdaf_EventsSusbcription_Notify service
operation. The NWDAF service consumer responses to the
Nnwdaf_EventsSusbcription_Notify service operation.
3\. The source NWDAF determines that it needs to prepare to transfer the
analytics subscription to another NWDAF instance.
4\. The source NWDAF discovers and selects the target NWDAF as described in
clause 5.8.2.3.
5a-5b. The source NWDAF invokes Nnwdaf_EventsSubscription_Transfer service
operation by sending an HTTP POST request to the target NWDAF and the
\"transReqType\" attribute in the request message is set to \"PREPARE\". The
target NWDAF sends an HTTP \"201 Created\" to the source NWDAF.
6a-6b. If analytics context identifier information had been included in the
Nnwdaf_EventsSubscription_Transfer request message, the target NWDAF requests
the analytics context information from the source NWDAF by invoking the
Nnwdaf_AnalyticsInfo_ContextTransfer service operation by sending the HTTP GET
request message targeting the resource \"NWDAF Context\" to the source NWDAF.
7\. The target NWDAF collect the data required for the analytics from the
relevant data source(s), if it is not yet collected.
8a-8b. The source NWDAF invokes the Nnwdaf_EventsSubscription_Transfer service
operation by sending an HTTP DELETE request to cancel the prepared analytics
subscritpiton transfer. The target NWDAF sends response to the source NWDAF
and deletes the analytics data that is no longer needed. If the target NWDAF
had already subscribed to entities to collect data or ML models during the
analytics subscription preparation, it unsubscribes from those entities if the
subscriptions are not needed for other active analytics subscriptions.
## 5.5 Data Collection
### 5.5.1 Procedure for Data Collection from NFs
#### 5.5.1.1 Data Collection from NFs
The procedure in Figure 5.5.1-1 is used by NWDAF to subscribe/unsubscribe at
NFs in order to be notified for data collection on related event(s), using
Event Exposure Services as listed in Table 6.2.2.1-1 defined in TS 23.288 [2]
clause 6.2.2.
Figure 5.5.1.1-1: Event Exposure Subscribe/Unsubscribe for NFs
1a. If data is to be collected for a user, i.e. for a SUPI or GPSI, the user
consent has not been checked by the data consumer, and local policy and
regulations require to check user consent, the NWDAF invokes Nudm_SDM_Get
service operation by sending an HTTP GET request targeting the resource
\"AccessAndMobilitySubscriptionData\" to the UDM to request the data type
\"User consent\" as described in clause 5.2.2.2 of 3GPP TS 29.503 [22].
Otherwise the procedure begins with step 3.
2a. The UDM responds to the Nudm_SDM_Get service operation. If the request is
accepted, the response includes the requested data with \"200 OK\". In
subsequent steps, the NWDAF excludes the SUPI or GPSI from requests to collect
data for users for whom the user consent is not granted.
1b. For the users for which the user consent is granted, the NWDAF subscribes
to notifications of changes of the user consent by invoking the
Nudm_SDM_Subscribe service operation by sending an HTTP POST request targeting
the resource \"SdmSubscriptions\" to the UDM as described in clause 5.2.2.3 of
3GPP TS 29.503 [22].
2b. The UDM responds to the Nudm_SDM_Subscribe service operation. If the
request is accepted, the UDM responds with \"201 Created\".
3\. In order to subscribe to notifications (or to modify subscriptions to
notifications) of data events from the data source NF (e.g. UDM, AMF, SMF,
NEF, AF), the NWDAF invokes the Nnf_EventExposure_Subscribe service operation
by sending an HTTP POST (or PUT, for modification) request targeting the
resource representing event exposure subscriptions of that NF, e.g. as
described in clause 5.5.2.2 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.2
of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3 of 3GPP TS 29.508 [6] for the
SMF, clause 4.2.2.2 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.2 of
3GPP TS 29.517 [12] for the AF.
4\. The NF responds to the Nnf_EventExposure_Subscribe service operation. Upon
receipt of the HTTP POST request, if the subscription is accepted to be
created, the NF responds to the NWDAF with \"201 Created\", and the URI of the
created subscription is included in the Location header field.
5\. If the NF observes the subscribed event(s), the NF invokes
Nnf_EventExposure_Notify service operation to report the event(s) by sending
an HTTP POST request, e.g. as described in clause 5.5.2.4 of 3GPP TS 29.503
[22] for the UDM, clause 5.3.2.4 of 3GPP TS 29.518 [18] for the AMF, clause
4.2.2 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.4 of 3GPP TS 29.591 [11]
for the NEF, or clause 4.2.4 of 3GPP TS 29.517 [12] for the AF.
6\. The NWDAF sends an HTTP \"204 No Content\" response to the NF.
7\. In order to unsubscribe to the notifications of data events from the
NWDAF, the NWDAF invokes Nnf_ EventExposure_Unsubscribe service operation by
sending an HTTP DELETE request targeting the resource that represents the
previously created individual event exposure subscription, e.g. as described
in clause 5.5.2.3 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.3 of 3GPP
TS 29.518 [18] for the AMF, clause 4.2.4 of 3GPP TS 29.508 [6] for the SMF,
clause 4.2.2.3 of 3GPP TS 29.591 [11] for the NEF, clause 4.2.3 of 3GPP TS
29.517 [12] for the AF. The request includes the event subscriptionId of the
existing subscription that is to be deleted.
8\. The NF responds to the Nnf_EventExposure_Unsubscribe service operation. If
the subscription deletion is accepted, the NF responds with \"204 No
Content\".
### 5.5.2 Data collection profile registration
This procedure depicted in Figure 5.5.2-1 is used by NWDAF or ADRF to
register/update a data collection profile to the DCCF during/after the
procedure of data collection.
Figure 5.5.2-1: Procedure for the NWDAF or ADRF to register data profile to
DCCF
1\. An ADRF or NWDAF instance is collecting or has collected data directly,
e.g. from collocated NF.
2\. In order to register a data collection profile, the ADRF or NWDAF invokes
the Ndccf_ContextManagement_Register service operation by sending an HTTP POST
request targeting the resource \"DCCF Data Collection Profiles\" as described
in clause 4.3.2.2 of 3GPP TS 29.574 [15].
3\. The DCCF responds to the Ndccf_ContextManagement_Register service
operation. Upon receipt of the HTTP POST request, if the data profile is
accepted to be created, the DCCF responds to the ADRF or NWDAF with \"201
Created\", and the URI of the created profile is included in the Location
header field.
4\. In order to update a data collection profile, the Data Consumer invokes
the Ndccf_ContextManagement_Update service operation by sending an HTTP PUT
request targeting the resource \"Individual DCCF Data Collection Profile\" as
described in clause 4.3.2.3 of 3GPP TS 29.574 [15].
5\. The DCCF responds to the Ndccf_ContextManagement_Update service operation.
Upon receipt of the HTTP PUT request, if the data profile is accepted to be
updated, the DCCF responds to the ADRF or NWDAF with \"200 OK\" with a
response body containing a representation of the updated data profile or \"204
No Content\".
6\. To obtain historical data and if the data consumer is configured to
collect data via the DCCF using the Ndccf_DataManagement_Subscribe service
operation, the data consumer uses the procedures described in clause 5.5.3.
7\. The ADRF or NWDAF requests to delete a registered data collection profile
at the DCCF invoking the Ndccf_ContextManagement_Deregister service operation
by sending a HTTP DELETE request targeting the \"Individual DCCF Data
Collection Profile\" resource of the DCCF as described in clause 4.3.2.4 of
3GPP TS 29.574 [15].
8\. The DCCF responds to the Ndccf_ContextManagement_Deregister service
operation with HTTP \"204 No Content\" status code, if the data collection
profile is successfully removed.
### 5.5.3 Procedure for Data Collection using DCCF
#### 5.5.3.1 Data Collection via DCCF
The procedure depicted in Figure 5.5.3.1-1 is used by a data consumer (e.g.
NWDAF) to obtain data and be notified of events via the DCCF using the
Ndccf_DataManagement_Subscribe service operation. Whether the data consumer
directly contacts the Data Source or goes via the DCCF is based on
configuration of the data consumer.
Figure 5.5.3.1-1: Data Collection via DCCF
1\. In order to subscribe to notification(s) of events exposure via the DCCF
based on local configuration, the Data Consumer invokes the
Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST
request targeting the resource \"DCCF Data Subscriptions\" as described in
clause 4.2.2.2.4 of 3GPP TS 29.574 [15].
2a. If data is to be collected for a user, i.e. for a SUPI or GPSI, the user
consent has not been checked by the data consumer, and local policy and
regulations require to check user consent, the DCCF invokes the Nudm_SDM_Get
service operation by sending an HTTP GET request targeting the resource
\"AccessAndMobilitySubscriptionData\" at the UDM to request the data type
\"User consent\" as described in clause 5.2.2.2 of 3GPP TS 29.503 [22].
Otherwise the procedure continues with step 4.
3a. The UDM responds to the Nudm_SDM_Get service operation. If the request is
accepted, the response includes the requested data with \"200 OK\". In
subsequent steps, the DCCF excludes the SUPI or GPSI from requests to collect
data for users for whom the user consent is not granted.
2b. For the users for which the user consent is granted, the DCCF subscribes
to notifications of changes of the user consent by invoking the
Nudm_SDM_Subscribe service operation by sending an HTTP POST request targeting
the resource \"SdmSubscriptions\" at the UDM as described in clause 5.2.2.3 of
3GPP TS 29.503 [22].
3b. The UDM responds to the Nudm_SDM_Subscribe service operation. If the
request is accepted, the UDM responds with \"201 Created\" status code.
4\. The DCCF determines the NF type(s) and/or OAM to retrieve the data based
on the Service Operation requested in step 1. If the NF instance or NF Set ID
is not provided by the data consumer. The DCCF determines the NF instances
that can provide data as described in TS 23.288 [2] clause 5A.2 and clause
6.2.2.2. If the consumer requested storage of data in an ADRF but the ADRF ID
is not provided by the data consumer, or the collected data is to be stored in
an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to
store the collected data.
The DCCF keeps track of the data actively being collected from the Data
Sources it is coordinating. The NWDAF or ADRF may register the data collection
profile (including the data collection related Service Operation,
Analytics/Data Specification, NWDAF ID or ADRF ID) with the DCCF. The DCCF may
then determine whether certain historical data may be available in the NWDAF
or ADRF based on the data collection profile and the request time window.
If the historical data handling is not applicable or not supported, the DCCF
shall proceed with step 5a and skip step 5b, step 6b, step 7b, step 5c, step
6c, and step 7c.
If the historical data is available in an ADRF, the DCCF shall proceed with
step 5a and step 5b, and skip step 5c, step 6c, and step 7c.
If the historical data is available in an NWDAF, the DCCF shall proceed with
step 5a and step 5c, and skip step 5b, step 6b, and step 7b.
5a. The DCCF shall determine whether the data requested in step 1 are already
being collected.
If the data requested are already being collected by a data consumer, the DCCF
adds the data consumer to the list of data consumers that are subscribed for
these data.
If the DCCF determines that no subscriptions need to be created or modified
(e.g. because all the data can be made available either via pre-existing
subscriptions or because of the historical data handling) then step 6a and
step 7a are skipped.
6a. If the data requested in step 1 are not yet available, the DCCF shall
invoke the Nnf_EventExposure_Subscribe service operation by sending an HTTP
POST request message request to the NF targeting the resource representing
event exposure subscriptions to subscribe to a new event exposure
subscription, e.g. as described in clause 5.5.2.2 of 3GPP TS 29.503 [22] for
the UDM, clause 5.3.2.2 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3 of
3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2 of 3GPP TS 29.591 [11] for the
NEF, or clause 4.2.2 of 3GPP TS 29.517 [12] for the AF.
Otherwise, if the requested data subscribed in step 1 partially matches data
that is already being collected by the DCCF from an NF, and a modification of
this subscription to the NF would satisfy both the existing data subscriptions
as well as the newly requested data, the DCCF shall send a request to the
individual event exposure subscription resource to update an existing event
exposure subscription, e.g. as described in clause 5.5.2.5 of 3GPP TS 29.503
[22] for the UDM, clause 5.3.2.2.3 of 3GPP TS 29.518 [18] for the AMF, clause
4.2.3.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2.3 of 3GPP TS 29.591
[11] for the NEF, or clause 4.2.2.3 of 3GPP TS 29.517 [12] for the AF.
7a. The NF responds to the Nnf_EventExposure_Subscribe service operation.
> Upon receipt of an HTTP POST request, if the subscription is accepted to be
> created, the NF responds to the DCCF with \"201 Created\" status code, and
> the URI of the created subscription is included in the Location header
> field.
>
> Upon receipt of an HTTP PUT request, if the subscription is accepted to be
> updated, the NF responds to the DCCF with \"200 OK\" or \"204 No Content\"
> status code.
5b. If the historical data handling is applicable, and the DCCF determines to
retrieve data from the ADRF, the DCCF shall determine which ADRF instances
might provide the data.
6b. In order to retrieve the historical data from the ADRF, the DCCF shall
invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by
sending an HTTP POST request message targeting the resource \"ADRF Data
Retrieval Subscriptions\" as described in clause 4.2.2.6 of 3GPP TS 29.575
[16].
7b. The ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service
operation.
> Upon receipt of the HTTP POST request, if the subscription is accepted to be
> created, the ADRF responds to the DCCF with \"201 Created\" status code, and
> the URI of the created subscription is included in the Location header
> field.
5c. If the historical data handling is applicable, and the DCCF determines to
retrieve data from the NWDAF, the DCCF shall determine which NWDAF instances
might provide the requested data.
6c. In order to retrieve the historical data from the NWDAF, the DCCF shall
invoke the Nnwdaf_DataManagement_Subscribe service operation by sending an
HTTP POST request message targeting the resource \"NWDAF Data Management
Subscriptions\", as described in clause 4.4.2.2 of 3GPP TS 29.520 [5].
7c. The NWDAF responds to the Nnwdaf_DataManagement_Subscribe service
operation.
> Upon receipt of the HTTP POST request, if the subscription is accepted to be
> created, the NWDAF responds to the DCCF with \"201 Created\" status code,
> and the URI of the created subscription is included in the Location header
> field.
8\. The DCCF responds to the Ndccf_DataManagement_Subscribe service operation
with HTTP \"204 No Content\" status code.
9a. When the data are available, the NF invokes the Nnf_EventExposure_Notify
service operation by sending an HTTP POST request message to notify the data
events to the DCCF, e.g. as described in clause 5.5.2.4 of 3GPP TS 29.503 [22]
for the UDM, clause 5.3.2.4 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.2
of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.4 of 3GPP TS 29.591 [11] for
the NEF, or clause 4.2.4 of 3GPP TS 29.517 [12] for the AF.
10a. The DCCF responds to the Nnf_EventExposure_Notify service operation with
HTTP \"204 No Content\" status code.
9b. When the historical data are available in the ADRF, the ADRF shall invoke
the Nadrf_DataManagement_RetrievalNotify service operation by sending an HTTP
POST request message to notify the historical data or Fetch Instructions to
the DCCF as described in clause 4.2.2.8 of 3GPP TS 29.575 [16].
10b. The DCCF responds to the Nadrf_DataManagement_RetrievalNotify service
operation with HTTP \"204 No Content\" status code.
9c. When the historical data are available in the NWDAF, the NWDAF shall
invoke the Nnwdaf_DataManagement_Notify service operation by sending an HTTP
POST request message to notify the historical data to the DCCF as described in
clause 4.4.2.4 of 3GPP TS 29.520 [5].
10c. The DCCF responds to the Nnwdaf_DataManagement_Notify service operation
with HTTP \"204 No Content\" status code.
11\. If the DCCF is configured to deliver the data itself (and not via the
MFAF), the DCCF invokes the Ndccf_DataManagement_Notify service operation by
sending HTTP POST request message(s) to send the data to all notification
endpoints indicated in step 1. Data sent to notification endpoints may be
processed and formatted by the DCCF, so they conform to delivery requirements
for each NF service consumer or notification endpoint.
NOTE: According to Formatting Instructions provided by the NF service
consumer, multiple notifications from a NF can be combined in a single
Ndccf_DataManagement_Notify so that many notifications from an NF result in
fewer notifications (or one notification) to the Data Consumer. Alternatively,
a notification can instruct the data notification endpoint to fetch the data
from the DCCF.
12\. The NF service consumer responds to the Ndccf_DataManagement_Notify
service operation with HTTP \"204 No Content\" status code.
13\. The Data Consumer invokes the Ndccf_DataManagement_Fetch service
operation by sending an HTTP GET request message as described in clause
4.2.2.5 of 3GPP TS 29.574 [15] to fetch the data from the DCCF before an
expiry time, if the fetch instruction was previously received via the
NdccfDataManagement_Notify service operation in step 11.
14\. The DCCF responds to the Ndccf_DataManagement_Fetch service operation
with HTTP \"200 OK\" status code with the message body containing the data
received earlier from the data source.
15\. When the NF service consumer no longer needs the subscription to the
requested data in step 1, it shall invoke the Ndccf_DataManagement_Unsubscribe
service operation by sending an HTTP DELETE request message as described in
clause 4.2.2.3.3 of 3GPP TS 29.574 [15]. The DCCF removes the NF service
consumer from the list of NF service consumers that are subscribed for these
data.
16\. The DCCF responds to the Ndccf_DataManagement_Unsubscribe service
operation with HTTP \"204 No Content\" status code, if the NF service consumer
is successfully removed from the list of NF service consumers that are
subscribed for these data.
17a. If there are no other NF service consumers subscribed to the data, the
DCCF invokes the Nnf_EventExposure_Unsubscribe service operation by sending an
HTTP DELETE request message to the Data Source, e.g. as described in clause
5.5.2.3 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.3 of 3GPP TS 29.518
[18] for the AMF, clause 4.2.4 of 3GPP TS 29.508 [6] for the SMF, clause
4.2.2.3 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.3 in 3GPP TS 29.517
[12] for the AF.
18a. The Data Source responds to the Nnf_EventExposure_Unsubscribe service
operation with HTTP \"204 No Content\" status code, if the data event(s)
subscription is successfully removed.
17b. If the DCCF determines that no other NF service consumers require the
historical data from the ADRF, the DCCF invokes the
Nadrf_DataManagement_RetrievalUnsubscribe service operation by sending an HTTP
DELETE request message to the ADRF as described in clause 4.2.2.7 of 3GPP TS
29.575 [16].
18b. The ADRF responds to the Nadrf_DataManagement_RetrievalUnsubscribe
service operation with HTTP \"204 No Content\" status code, if the data
retrieval subscription is successfully removed.
17c. If DCCF determines that no other NF service consumers require the
historical data from the NWDAF, the DCCF invokes the
Nnwdaf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE
request message to the NWDAF as described in clause 4.4.2.3 of 3GPP TS 29.520
[5].
18c. The NWDAF responds to the Nnwdaf_DataManagement_Unsubscribe service
operation with HTTP \"204 No Content\" status code, if the data subscription
is successfully removed.
#### 5.5.3.2 Data Collection via Messaging Framework
This procedure depicted in Figure 5.5.3.2-1 is used by a data consumer (e.g.
NWDAF) to obtain data and be notified of events using the DCCF and a Messaging
Framework. The 3GPP DCCF Adaptor (3da) Data Management service and 3GPP
Consumer Adaptor (3ca) Data Management service of the Messaging Framework
Adaptor Function (MFAF) are used to interact with the Messaging Framework.
Whether the data consumer directly contacts the Data Source or goes via the
DCCF is based on configuration.
Figure 5.5.3.2-1: Data Collection via DCCF and via Messaging Framework
1\. In order to subscribe to notification(s) of events exposure via the DCCF
based on local configuration, the Data Consumer invokes the
Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST
request message targeting the resource \"DCCF Data Subscriptions\", as
described in clause 4.2.2.2.4 of 3GPP TS 29.574 [15].
2a. If data is to be collected for a user, i.e. for a SUPI or GPSI, the user
consent has not been checked by the data consumer, and local policy and
regulations require to check user consent, the DCCF invokes Nudm_SDM_Get
service operation by sending an HTTP GET request message targeting the
resource \"AccessAndMobilitySubscriptionData\" at the UDM to request the data
type \"User consent\" as described in clause 5.2.2.2 of 3GPP TS 29.503 [22].
Otherwise the procedure continues with step 4.
3a. The UDM responds to the Nudm_SDM_Get service operation. If the request is
accepted, the response includes the requested data with \"200 OK\" status
code. In subsequent steps, the DCCF excludes the SUPI or GPSI from requests to
collect data for users for whom the user consent is not granted.
2b. For the users for which the user consent is granted, the DCCF subscribes
to notifications of changes of the user consent by invoking the
Nudm_SDM_Subscribe service operation by sending an HTTP POST request message
targeting the resource \"SdmSubscriptions\" at the UDM as described in clause
5.2.2.3 of 3GPP TS 29.503 [22].
3b. The UDM responds to the Nudm_SDM_Subscribe service operation. If the
request is accepted, the UDM responds with \"201 Created\" status code.
4\. If the DCCF is configured to perform data delivery via the MFAF, in order
to create configuration of mapping data in the MFAF, the DCCF shall invoke the
Nmfaf_3daDataManagement_Configure service operation by sending an HTTP POST
request message targeting the resource \"MFAF Configurations\", as described
in clause 4.2.2.2.2 of 3GPP TS 29.576 [17].
In order to update configuration of mapping data in the MFAF, the DCCF shall
invoke the Nmfaf_3daDataManagement_Configure service operation by sending an
HTTP PUT request message targeting the resource \"Individual MFAF
Configuration\", as described in clause 4.2.2.2.3 of 3GPP TS 29.576 [17].
5\. The MFAF responds to the Nmfaf_3daDataManagement_Configure service
operation.
> Upon receipt of the HTTP POST request message, if the configuration is
> accepted to be created, the MFAF responds to the DCCF with \"201 Created\"
> status code, and the URI of the created configuration is included in the
> Location header field.
>
> Upon receipt of the HTTP PUT request message, if the configuration is
> accepted to be updated, the MFAF responds to the DCCF with \"200 OK\" or
> \"204 No Content\" status code.
6\. The DCCF determines the NF type(s) and/or OAM to retrieve the data based
on the Service Operation requested in step 1. If the NF instance or NF Set ID
is not provided by the data consumer. the DCCF determines the NF instances
that can provide data as described in TS 23.288 [2] clause 5A.2 and clause
6.2.2.2. If the consumer requested storage of data in an ADRF but the ADRF ID
is not provided by the data consumer, or the collected data is to be stored in
an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to
store the collected data.
The DCCF keeps track of the data actively being collected from the Data
Sources it is coordinating. The NWDAF or ADRF may register the data collection
profile (including the data collection related Service Operation,
Analytics/Data Specification, NWDAF ID or ADRF ID) with the DCCF. The DCCF may
then determine whether certain historical data may be available in the NWDAF
or ADRF based on the data collection profile and the request time window.
If the historical data handling is not applicable or not supported, the DCCF
shall proceed with step 7a, and skip step 7b, step 8b, step 9b, step 7c, step
8c, and step 9c.
If the historical data is available in an ADRF, the DCCF shall proceed with
step 7a and step 7b, and skip step 7c, step 8c, and step 9c.
If the historical data is available in an NWDAF, the DCCF shall proceed with
step 7a and step 7c, and skip step 7b, step 8b, and step 9b.
7a. The DCCF shall determine whether the data requested in step 1 are already
being collected.
If the data requested are already being collected by a data consumer, the DCCF
adds the data consumer to the list of data consumers that are subscribed for
these data.
If the DCCF determines that no subscriptions need to be created or modified
(e.g. because all the data can be made available either via pre-existing
subscriptions or because of the historical data handling) then step 8a and
step 9a are skipped.
8a. If data requested in step 1 are not available yet, the DCCF shall invoke
the Nnf_EventExposure_Subscribe service operation by sending an HTTP POST
request message request to the NF targeting the resource representing event
exposure subscriptions to subscribe to a new event exposure subscription, e.g.
as described in clause 5.5.2.2 of 3GPP TS 29.503 [22] for the UDM, clause
5.3.2.2 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3 of 3GPP TS 29.508 [6]
for the SMF, clause 4.2.2.2 of 3GPP TS 29.591 [11] for the NEF, or clause
4.2.2 of 3GPP TS 29.517 [12] for the AF.
Otherwise, if the requested data subscribed in step 1 partially matches data
that is already being collected by the DCCF from an NF, and a modification of
this subscription to the NF would satisfy both the existing data subscriptions
as well as the newly requested data, the DCCF shall send a request to the
individual event exposure subscription resource to update an existing event
exposure subscription, e.g. as described in clause 5.5.2.5 of 3GPP TS 29.503
[22] for the UDM, clause 5.3.2.2.3 of 3GPP TS 29.518 [18] for the AMF, clause
4.2.3.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2.3 of 3GPP TS 29.591
[11] for the NEF, or clause 4.2.2.3 of 3GPP TS 29.517 [12] for the AF.
9a. The NF responds to the Nnf_EventExposure_Subscribe service operation.
> Upon receipt of the HTTP POST request message, if the subscription is
> accepted to be created, the NF responds to the DCCF with \"201 Created\"
> status code, and the URI of the created subscription is included in the
> Location header field.
>
> Upon receipt of the HTTP PUT request message, if the subscription is
> accepted to be updated, the NF responds to the DCCF with \"200 OK\" or \"204
> No Content\" status code.
7b. If the historical data handling is applicable, and the DCCF determines to
retrieve data from the ADRF, the DCCF shall determine which ADRF instances
might provide the data.
8b. In order to retrieve the historical data from the ADRF, the DCCF shall
invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by
sending an HTTP POST request message targeting the resource \"ADRF Data
Retrieval Subscriptions\", as described in clause 4.2.2.6 of 3GPP TS 29.575
[16].
9b. The ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service
operation.
> Upon receipt of the HTTP POST request message, if the subscription is
> accepted to be created, the ADRF responds to the DCCF with \"201 Created\"
> status code, and the URI of the created subscription is included in the
> Location header field.
7c. If the historical data handling is applicable, and the DCCF determines to
retrieve data from the NWDAF, the DCCF shall determine which NWDAF instances
might provide the data.
8c. In order to retrieve the historical data from the NWDAF, the DCCF shall
invoke the Nnwdaf_DataManagement_Subscribe service operation by sending an
HTTP POST request message targeting the resource \"NWDAF Data Management
Subscriptions\", as described in clause 4.4.2.2 of 3GPP TS 29.520 [5].
9c. The NWDAF responds to the Nnwdaf_DataManagement_Subscribe service
operation.
> Upon receipt of the HTTP POST request message, if the subscription is
> accepted to be created, the NWDAF responds to the DCCF with \"201 Created\"
> status code, and the URI of the created subscription is included in the
> Location header field.
10\. The DCCF responds to the Ndccf_DataManagement_Subscribe service operation
with HTTP \"204 No Content\" status code.
11a. When the data are available, the NF invokes the Nnf_EventExposure_Notify
service operation by sending an HTTP POST request message to notify the data
events to the MFAF, e.g. as described in clause 5.5.2.4 of 3GPP TS 29.503 [22]
for the UDM, clause 5.3.2.4 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.2
of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.4 of 3GPP TS 29.591 [11] for
the NEF, or clause 4.2.4 of 3GPP TS 29.517 [12] for the AF.
12a. The MFAF responds to the Nnf_EventExposure_Notify service operation with
HTTP \"204 No Content\" status code.
11b. When the historical data are available in the ADRF, the ADRF shall invoke
the Nadrf_DataManagement_RetrievalNotify service operation by sending an HTTP
POST request message to notify the historical data or Fetch Instructions to
the MFAF as described in clause 4.2.2.8 of 3GPP TS 29.575 [16].
12b. The MFAF responds to the Nadrf_DataManagement_RetrievalNotify service
operation with HTTP \"204 No Content\" status code.
11c. When the historical data are available in the NWDAF, the NWDAF shall
invoke the Nnwdaf_DataManagement_Notify service operation by sending an HTTP
POST request message to notify the historical data to the MFAF as described in
clause 4.4.2.4 of 3GPP TS 29.520 [5].
12c. The MFAF responds to the Nnwdaf_DataManagement_Notify service operation
with HTTP \"204 No Content\" status code.
13\. The MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by
sending HTTP POST request message(s) to send the data to all notification
endpoints indicated in step 1. Data sent to notification endpoints may be
processed and formatted by the MFAF so they conform to delivery requirements
for each NF service consumer or notification endpoint.
NOTE: According to Formatting Instructions provided by the NF service
consumer, multiple notifications from a NF can be combined in a single
Nmfaf_3caDataManagement_Notify so that many notifications from an NF results
in fewer notifications (or one notification) to the Data Consumer.
Alternatively, a notification can instruct the data notification endpoint to
fetch the data from the MFAF.
14\. The NF service consumer responds to the Nmfaf_3caDataManagement_Notify
service operation with HTTP \"204 No Content\" status code.
15\. The Data Consumer invokes the Nmfaf_3caDataManagement_Fetch service
operation by sending an HTTP GET request message as described in clause
4.2.2.5 of 3GPP TS 29.574 [15] to fetch the data from the DCCF before an
expiry time, if the fetch instruction was received in
Nmfaf_3caDataManagement_Notify service operation in step 13.
16\. The MFAF responds to the Nmfaf_3caDataManagement_Fetch service operation
with HTTP \"200 OK\" status code with the message body containing the
NmfafResourceRecord data structure.
17\. When the NF service consumer no longer needs the subscription to the
requested data in step 1, it shall invoke the Ndccf_DataManagement_Unsubscribe
service operation by sending an HTTP DELETE request message as described in
clause 4.2.2.3.3 of 3GPP TS 29.574 [15]. The DCCF removes the NF service
consumer from the list of NF service consumers that are subscribed for these
data.
18\. The DCCF responds to the Ndccf_DataManagement_Unsubscribe service
operation with HTTP \"204 No Content\" status code, if the NF service consumer
is successfully from the list of NF service consumers that are subscribed for
these data.
19a. If there are no other NF service consumers subscribed to the data, the
DCCF invokes the Nnf_EventExposure_Unsubscribe service operation by sending an
HTTP DELETE request message to the Data Source, e.g. as described in clause
5.5.2.3 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.3 of 3GPP TS 29.518
[18] for the AMF, clause 4.2.4 of 3GPP TS 29.508 [6] for the SMF, clause
4.2.2.3 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.3 in 3GPP TS 29.517
[12] for the AF.
20a. The Data Source responds to the Nnf_EventExposure_Unsubscribe service
operation with HTTP \"204 No Content\" status code, if the data event(s)
subscription is successfully removed.
19b. If DCCF determines that no other NF service consumers requiring the
historical data from the ADRF, the DCCF may invoke the
Nadrf_DataManagement_RetrievalUnsubscribe service operation by sending an HTTP
DELETE request message to the ADRF as described in clause 4.2.2.7 of 3GPP TS
29.575 [16].
20b. The ADRF responds to the Nadrf_DataManagement_RetrievalUnsubscribe
service operation with HTTP \"204 No Content\" status code, upon the data
retrieval subscription is removed.
19c. If DCCF determines that no other NF service consumers require the
historical data from the NWDAF, the DCCF may invoke the
Nnwdaf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE
request message to the NWDAF as described in clause 4.4.2.3 of 3GPP TS 29.520
[5].
20c. The NWDAF responds to the Nnwdaf_DataManagement_Unsubscribe service
operation with HTTP \"204 No Content\" status code, upon the data subscription
is removed.
19d. When the DCCF determines that an NF service consumer mapping has to be
removed from MFAF, the DCCF invokes the Nmfaf_3daDataManagement_Deconfigure
service operation by sending an HTTP DELETE request message to the MFAF as
described in clause 4.2.2.3 of 3GPP TS 29.576 [17].
20d. The MFAF responds to the Nmfaf_3daDataManagement_Deconfigure service
operation with HTTP \"204 No Content\" status code, if the individual resource
linked to the delete request is successfully removed.
## 5.6 ML Model provisioning procedures
### 5.6.1 General
The ML Model provisioning procedures allow the NF service consumers (i.e.
NWDAF (MTLF+AnLF), NWDAF (AnLF)) to obtain the ML model information on the
related Analytics from another NWDAF (i.e. an NWDAF containing MTLF).
### 5.6.2 ML Model Subscribe/Unsubscribe/Notify procedure
The procedure is used by an NF service consumer to subscribe to/unsubscribe
from the ML model information on the related Analytics on NWDAF containing
MTLF, and also used by the NWDAF containing MTLF to notify the ML model
information to the NF service consumer if it subscribed to the ML model
information previously.
Figure 5.6.2-1: ML Model Subscribe/Unsubscribe/Notify procedure
1\. In order to subscribe to ML model information, the NF service consumer
invokes Nnwdaf_MLModelProvision_Subscribe service operation by sending an HTTP
POST request targeting the resource \"NWDAF ML Model Provision
Subscriptions\". The request shall include the event ID(s) and the
notification URI, and may include the event filter information, the target UE
information, the expected time interval during which the ML model shall be
reported and the expiry time.
In order to modify the existing subscription, the NF service consumer invokes
Nnwdaf_MLModelProvision_Subscribe service operation by sending an HTTP PUT
request with Resource URI of the resource \"Individual NWDAF ML Model
Provision Subscription\".
2\. The NWDAF containing MTLF responds to the
Nnwdaf_MLModelProvision_Subscribe service operation. Upon receipt of the HTTP
POST request, if the subscription is accepted to be created, the NWDAF
containing MTLF responds to the NF service consumer with \"201 Created\", and
the URI of the created subscription is included in the Location header field.
Upon receipt of the HTTP PUT request, if the subscription is accepted to be
updated, the NWDAF containing MTLF responds to the NF service consumer an HTTP
\"200 OK\" with a response body containing a representation of the updated
subscription or \"204 No Content\".
3\. If the NWDAF containing MTLF determines that the subscribed ML model
information is available, the NWDAF containing MTLF invokes
MLModelProvision_Notify service operation to report the ML model information
by sending an HTTP POST request to the NF service consumer identified by the
notification URI received during the creation/modification of the
subscriptions. The request shall include the event ID, the subscriptionId and
the address (e.g. URL or FQDN) of ML Model file, and may include the period of
validity that indicates the time period when the provided ML model applies and
spatial validity that indicates the area where the provided ML model applies.
4\. The NF service consumer responds to the NWDAF containing MTLF with an HTTP
\"204 No Content\" message.
5\. In order to unsubscribe from the notification(s) of the ML model
information, the NF service consumer invokes
Nnwdaf_MLModelProvision_Unsubscribe service operation by sending an HTTP
DELETE request, which targets the resource \"Individual NWDAF ML Model
Provision Subscription\", to the NWDAF containing MTLF.
6\. If the request is accepted, the NWDAF containing MTLF deletes the
subscription and responds to the NF service consumer with an HTTP \"204 No
Content\" message.
NOTE: For details of Nnwdaf_MLModelProvision_Subscribe /Unsubscribe/Notify
service operations refer to 3GPP TS 29.520 [5].
## 5.7 Procedures for Specific Network Data Analytics
### 5.7.1 General
### 5.7.2 Network Slice (Instance) load level Analytics
This procedure is used by the NF to obtain the network slice (instance) load
level analytics which are calculated by the NWDAF based on the information
collected from the NSACF, NRF, AMF, SMF and/or OAM. If the NF is an AF which
is untrusted, the AF will request analytics via the NEF as described in clause
5.2.3.2.
Figure 5.7.2-1: Procedure for Network Slice (Instance) load level Analytics
1a. In order to obtain the network slice (instance) load level analytics, the
NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in
clause 5.2.3.1.
1b-1c. In order to obtain the network slice (instance) load level analytics,
the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as
described in clause 5.2.2.1.
2a-2b. If the event is set to \"LOAD_LEVEL_INFORMATION\" or
\"NSI_LOAD_LEVEL\", the NWDAF invokes Nnrf_NFDiscovery_Request service
operation as described in clause 5.3.2.2 of 3GPP TS 29.510 [26] to discover
the AMF, SMF and NSSF instance(s) relevant to the analytics filters provided
in the subscription request. The NRF responds to the NWDAF an HTTP \"201
Created\" response.
3a-3b. (Only for \"NSI_LOAD_LEVEL\")The NWDAF may invoke Nnssf_NSSelection_Get
service operation as described in clause 5.2.2.2 of 3GPP TS 29.531 [21] to
obtain the NSI ID(s) corresponding to the S-NSSAI in the subscription request.
The NRF responds to the NWDAF an HTTP \"201 Created\" response.
4a-4b. (Only for \"NSI_LOAD_LEVEL\")The NWDAF may invoke
Nnrf_NFManagement_NFStatusSubscribe service operation as described in clause
5.2.2.5 of 3GPP TS 29.510 [26] to subscribe to the resource usage information
of a network slice instance obtained from its constituent NF instances. The
NRF responds to the NWDAF an HTTP \"201 Created\" response.
5a-5b. (Only for \"NSI_LOAD_LEVEL\") If step 4a and step 4b are performed, the
NRF may invoke Nnrf_NFManagement_NFStatusNotify service operation as described
in clause 5.2.2.6 of 3GPP TS 29.510 [26]. The NWDAF responds to the NRF an
HTTP \"204 No Content\" response.
6a-6b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to subscribe to the
notification of individual UE registration/deregistration registered to an
S-NSSAI or to an S-NSSAI and NSI ID, or request the total number of UEs served
by the AMF per S-NSSAI or per S-NSSAI and NSI ID. The AMF responds to the
NWDAF an HTTP \"201 Created\" response.
7a-7b. If step 6a and step 6b are performed, the AMF invokes
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
8a-8b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to subscribe to the notification of individual PDU session
established or PDU session released in an S-NSSAI or request the total number
of PDU Sessions established in an S-NSSAI. The SMF responds to the NWDAF an
HTTP \"201 Created\" response.
9a-9b. If step 8a and step 8b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 8a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
10\. The NWDAF may invoke \"Data collection service\" to the OAM to get the
mean number of UEs registered as described in clause 5.2.1 of TS 28.552 [27],
mean number of PDU sessions established as described in clause 5.3.1 of TS
28.552 [27] and/or the resource usage information of a network slice instance
obtained from its constituent NF instances as described in clause 6.2 of TS
28.552 [27]. (Obtaining the resource usage information of a network slice
instance is only applicable for \"NSI_LOAD_LEVEL\" event).
11a-11b. The NWDAF may invoke Nnsacf_SliceEventExposure_Subscribe service
operation as described in clause 5.3.2.2 of 3GPP TS 29.536 [20] to request the
number of UEs registered to the network slice and/or the number of PDU
sessions established to the network slice.
12a-12b. The NSACF may invoke Nnsacf_SliceEventExposure_Notify service
operation as described in clause 5.3.2.4 of 3GPP TS 29.536 [20]. The NWDAF
responds to the NSACF an HTTP \"204 No Content\" response.
13\. The NWDAF calculates the network slice (instance) load level analytics
based on the data collected from AMF, SMF, NRF, NSACF and/or OAM.
14a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
14b-14c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
15a-15b. The same as step 5a and step 5b.
16a-16b. The same as step 7a and step 7b.
17a-17b. The same as step 9a and step 9b.
18\. The same as step 10.
19a-19b. The same as step 12a and step 12b.
20\. The same as step 13.
21a-21b. The same as step 14b and step 14c.
NOTE 1: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 2: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.3 Observed Service Experience Analytics
This procedure is used by the NF to obtain the Service Experience analytics
which are calculated by the NWDAF based on the information collected from the
AMF, SMF, UPF, AF and/or OAM. If the NF is an AF which is untrusted, the AF
will request analytics via the NEF as described in clause 5.2.3.2.
Figure 5.7.3-1: Procedure for Service Experience Analytics
1a. In order to obtain the Service Experience analytics, the NF may invoke
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
1b-1c. In order to obtain the Service Experience analytics, the NF may invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
5.2.2.1.
2a-2b. If the event is set to \"SERVICE_EXPERIENCE\", the NWDAF may invoke
Namf_EventExposure_Subscribe service operation as described in clause
5.3.2.2.2 of 3GPP TS 29.518 [18] to subscribe to the notification of UE ID and
UE location. The AMF responds to the NWDAF an HTTP \"201 Created\" response.
3a-3b. If step 2a and step 2b are performed, the AMF invokes
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4a-4b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to subscribe to the notification of QFI, IP filter
information, DNAI, UPF information, Application ID, DNN and S-NSSAI. The SMF
responds to the NWDAF an HTTP \"201 Created\" response.
5a-5b. If step 4a and step 4b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 4a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
6a-6b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation by sending an HTTP POST request targeting the resource
\"Application Event Subscriptions\" to request the service data and
performance data from AF directly. The AF responds to the NWDAF an HTTP \"201
Created\" response.
7a-7b. If step 6a and step 6b are performed, the AF may invoke
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 6a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
8a-8d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response
and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.
9a-9d. If step 8a to step 8d are performed, the AF may invoke
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 8b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 8a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
10\. The NWDAF may collect QoS flow bit rate, QoS flow packet delay, packet
transmission and packet retransmission information from UPF.
NOTE 1: How NWDAF collects UE communication related data from UPF is not
defined in this Release of the specification.
11\. The NWDAF may collect Reference Signal Received Powerand Reference Signal
Received Quality as specified in clause 5.5 of TS 38.331 [33] and clause 5.5.5
of TS 36.331 [34], Signal-to-noise and interference ratio as specified in
clause 5.1 of TS 38.215 [35], the mapping information between cell ID and
frequency and/or Cell Energy Saving State data as specified in clauses 3.1 and
6.2 of TS 28.310 [36] from OAM.
12\. The NWDAF calculates the Service Experience analytics based on the data
collected from AMF, SMF, UPF, AF and/or OAM.
13a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
13b-13c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
14a-14b. The same as step 3a and step 3b.
15a-15b. The same as step 5a and step 5b.
16a-16b. The same as step 7a and step 7b.
17a-17d. The same as step 9a and step 9b.
18\. The same as step 12.
19a-19b. The same as step 13b and step 13c.
NOTE 2: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 3: For details of Nnef_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.591 [11].
NOTE 4: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
### 5.7.4 NF load Analytics
This procedure is used by the NWDAF service consumer (may be an NF, or the
OAM) to obtain the NF load analytics which are calculated by the NWDAF based
on the information collected from the NRF and/or the OAM, may also collect UE
input data via the AF (for the untrusted AF via the NEF). If target NF type is
UPF, the NWDA may collect the information from UPF.
Figure 5.7.4-1: Procedure for NF load Analytics
1a. In order to obtain the NF load analytics, the NWDAF service consumer may
invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause
5.2.3.1, the requested event is set to \"NF_LOAD\" with the supported feature
\"NfLoad\".
1b-1c. In order to obtain the NF load analytics, the NWDAF service consumer
may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described
in clause 5.2.2.1, the subscribed event is set to \"NF_LOAD\" with the
supported feature \"NfLoad\".
2a-2b. The NWDAF may invoke Nnrf_NFDiscovery_Request service operation as
described in clause 5.3.2.2 of 3GPP TS 29.510 [26] for each NF, to obtain the
initial NF profile which contains NF status and may contains NF load
information. The NRF responds to the NWDAF an HTTP \"201 Created\" response.
3\. The NWDAF may invoke \"Data collection service\" to the OAM to get the NF
resource usage information as described in clause 5.7 of 3GPP TS 28.552 [27]
and/or the NF resource configuration information as described in clause 5.2 of
3GPP TS 28.533 [28]. The NWDAF may also collect the MDT data information for
UE as described in 3GPP TS 37.320 [29].
4a-4b. The NWDAF may invoke Nnrf_NFManagement_NFStatusSubscribe service
operation as described in clause 5.2.2.5 of 3GPP TS 29.510 [26] to subscribe
to the NF status and/or NF load information. The NRF responds to the NWDAF an
HTTP \"201 Created\" response.
5a-5b. If step 4a and step 4b are performed, the NRF may invoke
Nnrf_NFManagement_NFStatusNotify service operation as described in clause
5.2.2.6 of 3GPP TS 29.510 [26]. The NWDAF responds to the NRF an HTTP \"204 No
Content\" response.
6\. If the target NF type is UPF, the NWDAF may collect traffic usage report
information from UPF.
NOTE 1: How the NWDAF collects UPF information is not defined in this release
of the specification.
7a-7b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation to the AF directly by sending an HTTP POST request targeting
the resource \"Application Event Subscriptions\" to collect the Collective
Behaviour of UEs. The AF responds to the NWDAF an HTTP \"201 Created\"
response.
8a-8b. If step 7a and step 7b are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 7a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
9a-9d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\" to collect the Collective Behaviour of UEs. The AF responds to
the NEF an HTTP \"201 Created\" response and then the NEF responds to the
NWDAF an HTTP \"201 Created\" response.
10a-10d. If step 9a to step 9d are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 9b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 9a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
11\. The NWDAF calculates the NF load analytics based on the data collected
from NRF, OAM, UPF and/or AF.
12a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
12b-12c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
13\. The same as step 3.
14a-14b. The same as step 5a and step 5b.
15\. The same as step 6.
16a-16b. The same as step 8a and step 8b.
17a-17d. The same as step 10a to step 10d.
18\. The same as step 11.
19a-19b. The same as step 12b and step 12c.
NOTE 2: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
NOTE 3: For details of Nnef_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.591 [11].
NOTE 4: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.5 Network Performance Analytics
This procedure is used by the NF to obtain the network performance analytics
which are calculated by the NWDAF based on the information collected from the
AMF, NRF and/or OAM. If the NF is an AF which is untrusted, the AF will
request analytics via the NEF as described in clause 5.2.3.2.
Figure 5.7.5-1: Procedure for Network Performance Analytics
1a. In order to obtain the network performance analytics, the NF may invoke
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
1b-1c. In order to obtain the network performance analytics, the NF may invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
5.2.2.1.
2a-2b. If the event is set to \"NETWORK_PERFORMANCE\", the NWDAF may invoke
Nnrf_NFManagement_NFStatusSubscribe service operation as described in clause
5.2.2.5 of 3GPP TS 29.510 [26] to subscribe to NF (e.g. SMF, UPF) load and
status information. The NRF responds to the NWDAF an HTTP \"201 Created\"
response.
3a-3b. If step 2a and step 2b are performed, the NRF may invoke
Nnrf_NFManagement_NFStatusNotify service operation as described in clause
5.2.2.6 of 3GPP TS 29.510 [26]. The NWDAF responds to the NRF an HTTP \"204 No
Content\" response.
4a-4b. If the event is set to \"NETWORK_PERFORMANCE\" and the type of network
performance is set to \"NUM_OF_UE\", the NWDAF invokes
Nnrf_NFDiscovery_Request service operation as described in clause 5.3.2.2 of
3GPP TS 29.510 [26] to discover the AMF(s) belonging to the AMF Region(s) that
include(s) the Area of Interest. The NRF responds to the NWDAF an HTTP \"201
Created\" response.
5a-5b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to collect the number of
UEs located in the Area of Interest from AMF. The AMF responds to the NWDAF an
HTTP \"201 Created\" response.
6a-6b. If step 5a and step 5b are performed, the AMF invokes
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
7\. The NWDAF may invoke \"Data collection service\" to the OAM to get the
status and load information and the performance per Cell Id in the Area of
Interest as described in clause 5.1 of TS 28.552 [27].
8\. The NWDAF calculates the network performance analytics based on the data
collected from AMF, NRF and/or OAM.
9a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
9b-9c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
10a-10b. The same as step 3a and step 3b.
11a-11b. The same as step 6a and step 6b.
12\. The same as step 7.
13\. The same as step 8.
14a-14b. The same as step 9b and step 9c.
NOTE: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or
Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].
### 5.7.6 UE Mobility Analytics
This procedure is used by the NF to obtain UE mobility analytics, which is
calculated by the NWDAF based on the information collected from the AMF, AF
and/or OAM. If the NF is an AF which is untrusted, the AF will request
analytics via the NEF as described in clause 5.2.3.2.
Figure 5.7.6-1: Procedure for UE Mobility analytics
1a. In order to obtain the UE mobility analytics, the NF may invoke
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
1b-1c. In order to obtain the UE mobility analytics, the NF may invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
5.2.2.1.
2a-2b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18]. This step may be skipped
when e.g. the UE mobility information is available. The AMF responds to the
NWDAF an HTTP \"201 Created\" response.
3a-3b. If step 2a and step 2b are performed, the AMF invokes
Namf_EventExposure_Notify service operation as described in clause 5.3.2.4 of
3GPP TS 29.518 [18]. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4a-4b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation to the AF directly by sending an HTTP POST request targeting
the resource \"Application Event Subscriptions\". The AF responds to the NWDAF
an HTTP \"201 Created\" response.
5a-5b. If step 4a and step 4b are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 4a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
6a-6d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response
and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.
7a-7d. If step 6a to step 6d are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 6b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 6a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
8\. The NWDAF may invoke \"streaming data reporting service reportStreamData\"
service operation to the OAM as described in clause 12.5.1.1.5 of 3GPP TS
28.532 [19].
9\. The NWDAF may invoke the \"File data reporting service subscribe\" service
operation to the OAM as described in clause 12.6.1.1.3 of 3GPP TS 28.532 [19]
or invoke \"File data reporting service listAvailableFiles\" service operation
to the OAM as described in clause 12.6.1.1.2 of 3GPP TS 28.532 [19].
10\. The NWDAF calculates the requested UE mobility analytics based on the
data collected from AMF, AF and/or OAM.
11a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
11b-11c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
12a-12b. The same as step 3a and step 3b.
13a-13b. The same as step 5a and step 5b.
14a-14d. The same as step 7a and step 7d.
15\. The same as step 9.
16\. The same as step 10.
17a-17b. The same as step 11b and step 11c.
NOTE 1: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
NOTE 2: For details of Nnef_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.591 [11].
NOTE 3: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.7 UE Communication Analytics
This procedure is used by the NF to obtain UE communication analytics, which
is calculated by the NWDAF based on the information collected from the AMF,
SMF and/or AF. If the NF is an AF which is untrusted, the AF will request
analytics via the NEF as described in clause 5.2.3.2.
Figure 5.7.7-1: Procedure for UE Communication analytics
1a. In order to obtain the UE communication analytics, the NF may invoke
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
1b-1c. In order to obtain the UE communication analytics, the NF may invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
5.2.2.1.
2a-2b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve one or more
Type Allocation codes, UE connection management state, UE access behaviour
trends and UE location trends from AMF. The AMF responds to the NWDAF an HTTP
\"201 Created\" response.
3a-3b. If step 2a and step 2b are performed, the AMF may invoke
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4a-4b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to request the information of the UE and/or N4 session related
data to calculate the analytics. The SMF responds to the NWDAF an HTTP \"201
Created\" response.
5a-5b. If step 4a and step 4b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 4a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
6a-6b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation by sending an HTTP POST request targeting the resource
\"Application Event Subscriptions\" to request the service data from AF
directly. The AF responds to the NWDAF an HTTP \"201 Created\" response.
7a-7b. If step 6a and step 6b are performed, the AF may invoke
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 6a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
8a-8d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response
and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.
9a-9d. If step 8a to step 8d are performed, the AF may invoke
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 8b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 8a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
10\. The NWDAF calculates the requested UE communication analytics based on
the data collected from AMF, SMF and/or AF.
11a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
11b-11c. If step 1b and step 1c are performed, the NWDAF may invoke
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
12a-12b. The same as step 3a and step 3b.
13a-13b. The same as step 5a and step 5b.
14a-14b. The same as step 7a and step 7b.
15a-15d. The same as step 9a and step 9d.
16\. The same as step 10.
17a-17b. The same as step 11b and step 11c.
NOTE 1: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 2: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
NOTE 3: For details of Nnef_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.591 [11].
NOTE 4: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.8 Expected UE behavioural Analytics
This procedure is used by the NF to obtain the expected UE behavioural
parameters, which are calculated by the NWDAF based on the information
collected from the AMF, SMF, AF and/or OAM. If the NF is an AF which is
untrusted, the AF will request analytics via the NEF as described in clause
5.2.3.2.
Figure 5.7.8-1: Procedure for Expected behavioural Analytics
1a. In order to obtain the expected UE behavioural parameters, the NF may
invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause
5.2.3.1.
1b-1c. In order to obtain expected UE behavioural parameters, the NF may
invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in
clause 5.2.2.1.
2a. If the event is set to \"UE_MOBILITY\", the NWDAF collects data from AMF,
AF and/or OAM as described in clause 5.7.6 from step 2a to step 9.
2b. If the event is set to \"UE_COMM\", the NWDAF collects data from AMF, SMF
and/or AF as described in clause 5.7.7 from step 2a to step 9d.
3\. The NWDAF calculates the expected UE behavioural parameters based on the
collected data from AMF, SMF, AF and/or OAM.
4a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
4b-4c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
5a-5b. The AMF, SMF, AF and/or OAM send the notifications to the NWDAF if it
has subscribed to the related events in step 2a or step 2b.
6\. The same as step 3.
7a-7b. The same as step 4b and step 4c.
NOTE: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or
Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].
### 5.7.9 Abnormal UE behavioural Analytics
This procedure is used by the NF to obtain the abnormal UE behavioural
analytics which are calculated by the NWDAF based on the information collected
from the AMF, SMF, AF and/or OAM. If the NF is an AF which is untrusted, the
AF will request analytics via the NEF as described in clause 5.2.3.2.
Figure 5.7.9-1: Procedure for Abnormal UE behavioural Analytics
1a. In order to obtain the abnormal UE behavioural parameters, the NF may
invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause
5.2.3.1.
1b-1c. In order to obtain abnormal UE behavioural parameters, the NF may
invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in
clause 5.2.2.1.
2a. If the event is set to \"ABNORMAL_BEHAVIOUR\" and the expected UE
analytics type is set to \"MOBILITY\" or \"MOBILITY_AND_COMMUN\", or the list
of exception IDs includes \"UNEXPECTED_UE_LOCATION\",
\"PING_PONG_ACROSS_CELLS\", \"UNEXPECTED_RADIO_LINK_FAILURES\", or
\"UNEXPECTED_WAKEUP\", the NWDAF collects data from AMF, AF and/or OAM as
described in clause 5.7.6 from step 2a to step 9.
2b. If the event is set to \"ABNORMAL_BEHAVIOUR\" and the expected UE
analytics type is set to \"COMMUN\" or \"MOBILITY_AND_COMMUN\", or the list of
exception IDs includes \"SUSPICION_OF_DDOS_ATTACK\",
\"UNEXPECTED_LONG_LIVE_FLOW\", \"UNEXPECTED_LARGE_RATE_FLOW\",
\"WRONG_DESTINATION_ADDRESS\", \"TOO_FREQUENT_SERVICE_ACCESS\" or
\"UNEXPECTED_WAKEUP\", the NWDAF collects data from AMF, SMF and/or AF as
described in clause 5.7.7 from step 2a to step 9d.
3\. The NWDAF calculates the abnormal UE behavioural parameters based on the
collected data from AMF, SMF, AF and/or OAM.
4a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
4b-4c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
5a-5b. The AMF, SMF, AF and/or OAM send the notifications to the NWDAF if it
has subscribed to the related events in step 2a or step 2b.
6\. The same as step 3.
7a-7b. The same as step 4b and step 4c.
NOTE: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or
Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].
### 5.7.10 User Data Congestion Analytics
This procedure is used by the NWDAF service consumer (may be an NF e.g. NEF,
AF, or PCF) to obtain the User Data Congestion analytics which are calculated
by the NWDAF based on the information collected from the AMF, OAM, UPF and/or
AF.
Figure 5.7.10-1: Procedure for User Data Congestion Analytics
1a. In order to obtain the User Data Congestion analytics, the NWDAF service
consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as
described in clause 5.2.3.1, the requested event is set to
\"USER_DATA_CONGESTION\" with the supported feature \"UserDataCongestion\".
1b-1c. In order to obtain the User Data Congestion analytics, the NWDAF
service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service
operation as described in clause 5.2.2.1, the subscribed event is set to
\"USER_DATA_CONGESTION\" with the supported feature \"UserDataCongestion\".
2a-2b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE
location information. The AMF responds to the NWDAF an HTTP \"201 Created\"
response.
3a-3b. If step 2a and step 2b are performed, the AMF may invoke
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4\. The NWDAF may invoke \"Data collection service\" to the OAM to get the
Performance Measurements that will be used by the NWDAF to determine
congestion levels. Performance Measurements are related to information
transfer over the user plane and/or the control plane (e.g. UE Throughput, DRB
Setup Management, RRC Connection Number, PDU Session Management, and Radio
Resource Utilization as defined in 3GPP TS 28.552 [27]). The NWDAF may obtain
measurements by invoking management services that are defined in 3GPP TS
28.532 [19] and 3GPP TS 28.550 [31].
5\. The NWDAF may collect data related to User Data Congestion analytics
information from UPF.
NOTE 1: How the NWDAF collects UPF information is not defined in this release
of the specification.
6a-6b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation to the AF directly by sending an HTTP POST request targeting
the resource \"Application Event Subscriptions\" to collect the data related
to User Data Congestion analytics information. The AF responds to the NWDAF an
HTTP \"201 Created\" response.
7a-7b. If step 6a and step 6b are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 6a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
8a-8d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\" to collect the data related to User Data Congestion analytics
information. The AF responds to the NEF an HTTP \"201 Created\" response and
then the NEF responds to the NWDAF an HTTP \"201 Created\" response.
9a-9d. If step 8a to step 8d are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 8b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 8a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
10\. The NWDAF calculates the User Data Congestion analytics based on the data
collected from AMF, OAM, UPF and/or AF.
11a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
11b-11c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
12a-12b. The same as step 3a and step 3b.
13\. The same as step 4.
14\. The same as step 5.
15a-15b. The same as step 7a and step 7b.
16a-16d. The same as step 9a to step 9d.
17\. The same as step 10.
18a-18b. The same as step 11b and step 11c.
NOTE 2: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
NOTE 3: For details of Nnef_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.591 [11].
NOTE 4: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.11 QoS Sustainability Analytics
This procedure is used by the NWDAF service consumer (maybe an NF, e.g. AF) to
obtain the QoS Sustainability analtics which are calculated by the NWDAF based
on the information collected from the OAM.
Figure 5.7.11-1: Procedure for QoS Sustainability Analytics
1a. In order to obtain the QoS sustainability analytics, the NWDAF service
consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as
described in clause 5.2.3.1, the requested event is sent to
\"QOS_SUSTAINABILITY\" with the supported feature \"QoSSustainability\".
1b-1c. In order to obtain the QoS sustainability analytics, the NWDAF service
consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as
described in clause 5.2.2.1, the subscribed event is set to
\"QOS_SUSTAINABILITY\" with the supported feature \"QoSSustainability\".
2\. The NWDAF may invoke \"Data collection service\" to the OAM to get the RAN
UE Throughput in clause 6.3.6 of 3GPP TS 28.554 [30] and/or QoS flow
Retainability information as described in clause 6.5.1 of 3GPP TS 28.554 [30].
3\. The NWDAF calculates the QoS sustainability analytics based on the data
collected from OAM.
4a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
4b-4c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
5\. The same as step 2.
6\. The same as step 3.
7a-7b. The same as step 4b and step 4c.
NOTE: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or
Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].
### 5.7.12 Dispersion Analytics
This procedure is used by the NWDAF service consumer to obtain the dispersion
analytics which are calculated by the NWDAF based on the information collected
from the AMF, SMF, UPF and/or AF.
Figure 5.7.12-1: Procedure for Dispersion Analytics
1a. In order to obtain the Dispersion analytics, the NWDAF service consumer
may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in
clause 5.2.3.1, the requested event is set to \"DISPERSION\" with the
supported feature \"Dispersion\".
1b-1c. In order to obtain the Dispersion analytics, the NWDAF service consumer
may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described
in clause 5.2.2.1, the subscribed event is set to \"DISPERSION\" with the
supported feature \"Dispersion\".
2a-2b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the location
and/or slice based UE transactions dispersion information. The AMF responds to
the NWDAF an HTTP \"201 Created\" response.
3a-3b. If step 2a and step 2b are performed, the AMF may invoke
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4a-4b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to subscribe to the notification of UE transactions dispersion
information which may be slice based. The SMF responds to the NWDAF an HTTP
\"201 Created\" response.
5a-5b. If step 4a and step 4b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 4a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
6\. The NWDAF may collect UE data volume dispersion information from the
serving UPF.
NOTE 1: How the NWDAF collects UPF information is not defined in this release
of the specification.
7a-7b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation to the AF directly by sending an HTTP POST request targeting
the resource \"Application Event Subscriptions\" to collect the UE data volume
dispersion information. The AF responds to the NWDAF an HTTP \"201 Created\"
response.
8a-8b. If step 7a and step 7b are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 7a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
9a-9d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\" to collect the UE data volume dispersion information. The AF
responds to the NEF an HTTP \"201 Created\" response and then the NEF responds
to the NWDAF an HTTP \"201 Created\" response.
10a-10d. If step 9a to step 9d are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 8b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 9a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
11\. The NWDAF calculates the Dispersion analytics based on the data collected
from AMF, SMF, UPF and/or AF.
12a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
12b-12c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
13a-13b. The same as step 3a and step 3b.
14a-14b. The same as step 5a and step 5b.
15\. The same as step 6.
16a-16b. The same as step 8a and step 8b.
17a-17d. The same as step 10a to step 10d.
18\. The same as step 11.
19a-19b. The same as step 12b and step 12c.
NOTE 2: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 3: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
NOTE 4: For details of Nnef_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.591 [11].
NOTE 5: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.13 WLAN Performance Analytics
This procedure is used by the NWDAF service consumer to obtain the WLAN
performance analytics which are calculated by the NWDAF based on the
information collected from the SMF, UPF and/or OAM. If the NF is an AF which
is untrusted, the AF will request analytics via the NEF as described in clause
5.2.3.2.
Figure 5.7.13-1: Procedure for WLAN Performance Analytics
1a. In order to obtain the WLAN performance analytics, the NWDAF service
consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as
described in clause 5.2.3.1, the requested event is set to
\"WLAN_PERFORMANCE\" with the supported feature \"WlanPerformance\".
1b-1c. In order to obtain the WLAN performance analytics, the NWDAF service
consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as
described in clause 5.2.2.1, the subscribed event is set to
\"WLAN_PERFORMANCE\" with the supported feature \"WlanPerformance\".
2a-2b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to subscribe to the notification of Information on PDU Session
for WLAN. The SMF responds to the NWDAF an HTTP \"201 Created\" response.
3a-3b. If step 2a and step 2b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 2a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
4\. The NWDAF may collect UE communications information for WLAN from the UPF.
NOTE 1: How the NWDAF collects UPF information is not defined in this release
of the specification.
5\. The NWDAF may collect WLAN measurement results from the OAM. The WLAN
measurement data from OAM is collected via MDT and aligned with the WLAN
measurement reporting list described in clause 5.1.1.3.3 of TS 37.320 [32].
6\. The NWDAF calculates the WLAN performance analytics based on the data
collected from SMF, UPF and/or OAM.
7a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
7b-7c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
8a-8b. The same as step 3a and step 3b.
9\. The same as step 4.
10\. The same as step 5.
11\. The same as step 6.
12a-12b. The same as step 7b and step 7c.
NOTE 2: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 3: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.14 Session Management Congestion Control Experience Analytics
This procedure is used by the NWDAF service consumer e.g. SMF to obtain the
Session Management Congestion Control Experience Analytics which are
calculated by the NWDAF based on the information collected from the SMF.
Figure 5.7.14-1: Procedure for Session Management Congestion Control
Experience Analytics
1a. In order to obtain the SMCCE (Session Management Congestion Control
Experience) analytics, the NWDAF service consumer may invoke
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1,
the requested event is set to \"SM_CONGESTION\" with the supported feature
\"SMCCE\".
1b-1c. In order to obtain the SMCCE (Session Management Congestion Control
Experience) analytics, the NWDAF service consumer may invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
5.2.2.1, the subscribed event is set to \"SM_CONGESTION\" with the supported
feature \"SMCCE\".
2a-2b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to subscribe to the notification of Information on UE ID and
SMCC experience for PDU Session. The SMF responds to the NWDAF an HTTP \"201
Created\" response.
3a-3b. If step 2a and step 2b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 2a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
4\. The NWDAF calculates the Session Management Congestion Control Experience
analytics based on the data collected from SMF.
5a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
5b-5c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
NOTE 1: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 2: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
and Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.15 Redundant Transmission Experience Analytics
This procedure is used by the NWDAF service consumer (may be an NF e.g. SMF)
to obtain the Redundant Transmission Experience Analytics which are calculated
by the NWDAF based on the information collected from the AMF, AF, SMF, UPF
and/or OAM.
Figure 5.7.15-1: Procedure for Redundant Transmission Experience Analytics
1a. In order to obtain the Redundant Transmission Experience Analytics, the
NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service
operation as described in clause 5.2.3.1, the requested event is set to
\"RED_TRANS_EXP\" with the supported feature \"RedundantTransmissionExp\".
1b-1c. In order to obtain the Redundant Transmission Experience Analytics, the
NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service
operation as described in clause 5.2.2.1, the subscribed event is set to
\"RED_TRANS_EXP\" with the supported feature \"RedundantTransmissionExp\".
2a-2b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE
Mobility information. The AMF responds to the NWDAF an HTTP \"201 Created\"
response.
3a-3b. If step 2a and step 2b are performed, the AMF may invoke
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4a-4b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to subscribe to the notification of Information related to PDU
Session established with redundant transmission. The SMF responds to the NWDAF
an HTTP \"201 Created\" response.
5a-5b. If step 4a and step 4b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 4a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
6\. The NWDAF may collect data related to packet delay measurement information
from UPF, refer to clause 5.4 1 of TS 28.552 [27] for the performance
measurement in UPF.
NOTE 1: How the NWDAF collects UPF information is not defined in this release
of the specification.
7\. The NWDAF may invoke \"Data collection service\" to the OAM to get the
packet drop and/or packet delay measurement refer to clause 5.1 of TS 28.552
[27] for the performance measurement in NG-RAN.
8a-8b. If the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe
service operation to the AF directly by sending an HTTP POST request targeting
the resource \"Application Event Subscriptions\" to collect the service data
related to UE mobility information. The AF responds to the NWDAF an HTTP \"201
Created\" response.
9a-9b. If step 8a and step 8b are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 8a. The NWDAF
responds to the AF an HTTP \"204 No Content\" response.
10a-10d. If the AF is untrusted, the NWDAF may invoke
Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP
POST request targeting the resource \"Network Exposure Event Subscriptions\"
and then the NEF invokes Naf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"Application Event
Subscriptions\" to collect the service data related to UE mobility
information. The AF responds to the NEF an HTTP \"201 Created\" response and
then the NEF responds to the NWDAF an HTTP \"201 Created\" response.
11a-11d. If step 10a to step 10d are performed, the AF invokes
Naf_EventExposure_Notify service operation by sending an HTTP POST request to
the NEF identified by the notification URI received in step 10b and the NEF
invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST
request to the NWDAF identified by the notification URI received in step 10a.
The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the
NEF responds to the AF an HTTP \"204 No Content\" response.
12\. The NWDAF calculates the Redundant Transmission Experience Analytics
based on the data collected from AMF, AF SMF, UPF and/or OAM.
13a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
13b-13c. If step 1b and step 1c are performed, the NWDAF invokes
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
14a-14b. The same as step 3a and step 3b.
15a-15b. The same as step 5a and step 5b.
16\. The same as step 6.
17\. The same as step 7.
18a-18b. The same as step 9a and step 9b.
19a-18d. The same as step 11a and step 11d.
20\. The same as step 12.
21a-21b. The same as step 13b and step 13c.
NOTE 2: For details of Naf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.517 [12].
NOTE 3: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 4: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
### 5.7.16 DN Performance Analytics
This procedure is used by the NF to obtain DN performance analytics, which is
calculated by the NWDAF based on the information collected from the AMF, SMF,
AF, UPF and/or OAM. If the NF is an AF which is untrusted, the AF will request
analytics via the NEF as described in clause 5.2.3.2.
Figure 5.7.16-1: Procedure for DN Performance Analytics
1a. In order to obtain the DN performance analytics, the NF may invoke
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
1b-1c. In order to obtain the DN performance analytics, the NF may invoke
Nnwdaf_EventsSubscription_Subscribe service operation as described in clause
5.2.2.1.
2a-2b. The NWDAF may invoke Namf_EventExposure_Subscribe service operation as
described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE
location information and SUPI(s) from AMF. The AMF responds to the NWDAF an
HTTP \"201 Created\" response.
3a-3b. If step 2a and step 2b are performed, the AMF may invoke
Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518
[18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\"
response.
4a-4b. The NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by
sending an HTTP POST request targeting the resource \"SMF Notification
Subscriptions\" to request DNN, S-NSSAI, application ID, UPF info, DNAI, IP
filter information and QFI. The SMF responds to the NWDAF an HTTP \"201
Created\" response.
5a-5b. If step 4a and step 4b are performed, the SMF may invoke
Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to
the NWDAF identified by the notification URI received in step 4a. The NWDAF
responds to the SMF an HTTP \"204 No Content\" response.
6\. The NWDAF may collect performance data from AF as described in clause
5.7.7 from step 6a to step 9d.
7\. The NWDAF may collect QoS flow bit rate, QoS flow packet delay, packet
transmission and packet retransmission information from UPF.
NOTE 1: How NWDAF collects UE communication related data from UPF is not
defined in this Release of the specification.
8\. The NWDAF may collect Reference Signal Received Power and Reference Signal
Received Quality as specified in clause 5.5 of TS 38.331 [33] and clause 5.5.5
of TS 36.331 [34], Signal-to-noise and interference ratio as specified in
clause 5.1 of TS 38.215 [35], the mapping information between cell ID and
frequency and Cell Energy Saving State data as specified in clauses 3.1 and
6.2 of TS 28.310 [36] from OAM.
9\. The NWDAF calculates the DN performance analytics based on the data
collected from AMF, SMF, AF, UPF and/or OAM.
10a. If step 1a is performed, the NWDAF responds to the
Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.
10b-10c. If step 1b and step 1c are performed, the NWDAF may invoke
Nnwdaf_EventsSusbcription_Notify service operation as described in clause
5.2.2.1.
11a-11b. The same as step 3a and step 3b.
12a-12b. The same as step 5a and step 5b.
13\. The same as step 6.
14\. The same as step 9.
15a-15b. The same as step 10b and step 10c.
NOTE 2: For details of Nsmf_EventExposure_Subscribe/Notify service operations
refer to 3GPP TS 29.508 [6].
NOTE 3: For details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify
or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520
[5].
## 5.8 Procedures for NWDAF Discovery and Selection
### 5.8.1 General
NWDAF may be deployed in multiple configuration options. Not all these
configurations require the same registration, discovery and selection
procedures. The discovery and selection may depend on the NWDAF deployment
option and the types of analytics it procedures, (i.e., whether it is related
to Network Functions or to UEs) or the data that is able to collect from NFs.
### 5.8.2 Procedures related to NRF
#### 5.8.2.1 General
#### 5.8.2.2 NWDAF Registration in NRF
NWDAF registers in NRF as a regular network function. See TS 29.510 [23] for
details.
#### 5.8.2.3 Consumer discovery and selection of NWDAF in NRF
A consumer of analytics services may use the NRF for discovering an NWDAF
containing AnLF.
If the NWDAF service consumer needs to discover an NWDAF containing AnLF that
is able to collect data from particular data sources identified by their NF
Set IDs or NF types, the consumer may query NRF with the
Nnrf_NFDiscovery_NFDiscover service operation, providing the NF Set IDs
(serving-nf-set-id attribute) or NF types (serving-nf-type attribute) in the
discovery request. See TS 29.510 [23] for details.
### 5.8.3 Procedures related to UDM
#### 5.8.3.1 General
#### 5.8.3.2 NWDAF containing AnLF Registration/Deregistration in UDM
##### 5.8.3.2.1 NWDAF containing AnLF Registration in UDM
For UE-related analytics, an NWDAF containing AnLF may register in UDM using
the Nudm_UECM_Register service operation (see TS 29.503 [22] clause
5.3.2.2.8). This is useful especially in scenarios of co-location of the NWDAF
containing AnLF with other network functions (e.g., AMF, SMF) and in certain
deployment models. Figure 5.8.3.2.1-1 illustrates the signalling flow.
Figure 5.8.3.2.1-1: NWDAF containing AnLF registration in UDM
1\. NWDAF containing AnLF triggers a registration in UDM, e.g. based on local
configuration in the NWDAF containing AnLF, the reception of a new Analytics
subscription request, start of collection of UE related data or an OAM
configuration action.
2\. The NWDAF containing AnLF registers into UDM for the served UE, by sending
Nudm_UECM_Registration request (UE ID of the served user, NWDAF Instance ID,
NF Set ID, Analytics ID(s)).
3\. UDM sends a response to NWDAF containing AnLF. A successful response
consists of a \"200 OK\" or \"201 Created\". If the operation is unsuccessful,
UDM responds with proper error response code. See TS 29.503 [22] for details.
##### 5.8.3.2.2 NWDAF containing AnLF Update of Registration in UDM
If an NWDAF containing AnLF has previously registered in UDM for one or more
analytics IDs for a given UE, the NWDAF containing AnLF may modify the
registration at any time. This may be due to, e.g., the NWDAF containing AnLF
adds one or more Analytic IDs for the UE, or the NWDAF containing AnLF removes
one or more Analytics IDs, but keep registered in UDM for at least one
Analytic ID. The NWDAF containing AnLF sends an Nudm_UECM_Update service
operation (NWDAF registration ID, added or removed Analytics ID(s)), see TS
29.503 [22] clause 5.3.2.6.4. Figure 5.8.3.2.2-1 illustrates the signalling
flow.
Figure 5.8.3.2.2-1: NWDAF containing AnLF registration update in UDM
1\. If an NWDAF containing AnLF has previously registered one or more
Analytics IDs for a UE in UDM, the NWDAF containing AnLF triggers an update of
the registration in UDM, e.g. based on the NWDAF containing AnLF serving the
UE of one or more additional Analytic ID(s) or based on the NWDAF containing
AnLF not serving the UE for one or more Analytic ID(s) but serving the UE for
at least one Analytic ID.
2\. The NWDAF containing AnLF updates its registration in UDM for the served
UE, by sending Nudm_UECM_Update request (NWDAF Registration Id, added or
removed Analytic ID(s)).
3\. Upon success UDM sends a \"204 No Content\" response to the NWDAF
containing AnLF. If the operation is unsuccessful, UDM responds with proper
error response code. See TS 29.503 [22] for details.
##### 5.8.3.2.3 NWDAF containing AnLF De-Registration in UDM
If an NWDAF containing AnLF has previously registered in UDM for one or more
analytics ID for a given UE, when the NWDAF containing AnLF no longer serves
the UE, e.g., it does not collect data for the UE for that Analytics ID or
does no keep produce analytic reports or does not keep any data related to the
UE, the NWDAF containing AnLF should de-register from UDM by invoking the
Nudm_UECM_Deregistration service operation (NWDAF registration ID, Analytics
ID(s)), see TS 29.503 [22] clause 5.3.2.4.8). Figure 5.8.3.2.3-1 illustrates
the signalling flow.
Figure 5.8.3.2.3-1: NWDAF containing AnLF deregistration from UDM
1\. If an NWDAF containing AnLF has previously registered one or more
Analytics IDs for a UE in UDM, the NWDAF containing AnLF triggers a complete
deregistration from UDM, e.g. based on the NWDAF containing AnLF not
collecting data any longer for the UE, or the NWDAF containing AnLF not
producing analytics reports for the UE, or the NWDAF containing AnLF not
keeping analytics data for the UE.
2\. The NWDAF containing AnLF deregisters from UDM for the served UE, by
sending Nudm_UECM_Deregistration request (NWDAF Registration Id).
3\. UDM sends a \"204 No Content\" response to the NWDAF containing AnLF. See
TS 29.503 [22] for details.
#### 5.8.3.3 Consumer discovery and selection of NWDAF containing AnLF in UDM
For UE related analytics, if the NWDAF service consumer needs to discover an
NWDAF containing AnLF that is serving or holds data for a UE, the NWDAF
serving consumer may query UDM with the target SUPI and the Analytics ID. If
the response from UDM indicates multiple candidate NWDAFs, the NWDAF service
consumer may, e.g., determine an instance of an NWDAF containing AnLF that has
registered in UDM (registrationTime attribute) around the time of interest of
the data or analytics, and may also query NRF, as specified in clause 5.8.2.3
in order to determine the capabilities of these NWDAFs and select the most
appropriate one. Figure 5.8.3.3-1 illustrates the signalling flow.
Figure 5.8.3.3-1: Discovery of NWDAF containing AnLF in UDM
1\. The NWDAF service consumer sends an Nudm_UECM_Get request to the UDM (UE
ID, Analytics ID(s), NF type = NWDAF).
2\. Upon success, UDM sends a \"200 OK\" response to the service consumer
including the NWDAF information registered for the UE ID. If the operation is
unsuccessful, UDM responds with proper error response code. See TS 29.503 [22]
for details.
### 5.8.4 Procedures for PCF learning NWDAF IDs for served UEs
PCF may receive from AMF and SMF the IDs of the NWDAFs containing AnLF that
are used by AMF, SMF, and UPF, so that the PCF may select the same NWDAF
containing AnLF being used for a specific UE.
When the AMF creates or updates an Access and Mobility Policy Association for
a UE, the AMF may include the IDs of the NWDAF containing AnLF that are used
by the AMF, along with their Analytic ID(s), in the
Npcf_AMPolicyControl_Create/Update service operations, as illustrated in
Figure 5.8.4-1. See details in TS 29.507 [24].
Figure 5.8.4-1: PCF leaning from AMF NWDAFs containing AnLF
The PCF may select those NWDAF instances discovered through the
Npcf_AMPolicyControl_Create/Update request as the ones to use for their
associated analytic ID(s) for the UE for which those AM Policy Associations
are related to.
When the SMF creates or updates a Session Management Policy Association for a
UE, the SMF may include the IDs of the NWDAF containing AnLF that are used by
the SMF and UPF, along with their Analytic ID(s), in the
Npcf_SMPolicyControl_Create/Update service operations, as illustrated in
Figure 5.8.4-2. See details in TS 29.512 [25].
Figure 5.8.4-2: PCF leaning from SMF and UPF NWDAFs containing AnLF
The PCF may select those NWDAF instances discovered through the
Npcf_SMPoliycControl_Create/Update request as the ones to subscribe for their
associated analytic ID(s) for the UE for which those SM Policy Associations
are related to.
## 5.9 Analytics Data Repository procedures
### 5.9.1 General
The Analytics Data Repository procedures allow the NF service consumers (e.g.
NWDAF, DCCF or MFAF) to store, retrieve or delete collected data and analytics
in the ADRF.
### 5.9.2 Historical Data and Analytics Storage/Retrieval/Deletion procedure
The procedure is used by an NF service consumer (e.g. NWDAF, DCCF or MFAF) to
store, retrieve or delete historical data and/or analytics, i.e. data and/or
analytics related to past time period that has been obtained by the consumer.
Figure 5.9.2-1: Historical Data and Analytics storage/deletion procedure
1\. In order to store data or analytics, the NF service consumer invokes
Nadrf_DataManagement_StorageRequest service operation by sending an HTTP POST
request targeting the resource \"ADRF Data Store Records\" in clause 4.2.2.2
of 3GPP TS 29.575 [16]. The request shall include one of the analytics
subscription notification(s), network exposure function event exposure
subscription notification(s), application function event exposure subscription
notification(s), access and mobility function event exposure subscription
notification(s), session management function event exposure subscription
notification(s), or unified data management event exposure subscription
notification(s).
2\. The ADRF stores the data or analytics sent by the consumer. The ADRF may,
based on implementation, determines whether the same data or analytics is
already stored or being stored based on the information sent in step 1 by the
consumer and, if the data or analytics is already stored or being stored in
the ADRF, the ADRF decides to not store again the data or analytics sent by
the consumer.
3\. If the data or analytics is stored, the ADRF sends
Nadrf_DataManagement_StorageRequest Response message to the consumer with HTTP
\"201 Created\" status code including a representation of the created record.
4\. In order to retrieve the stored data or analytics from the ADRF, the NF
service consumer shall invoke the Nadrf_DataManagement_RetrievalRequest
service operation by sending an HTTP GET request targeting the resource \"ADRF
Data Store Records\" as described in clause 4.2.2.5 of 3GPP TS 29.575 [16].
The request shall include fetch correlation identifier(s), or the query
parameter value of subscription information. In addition, the start time and
stop time during which requested data is collected or is to be collected shall
be provided if the request has been performed based on subscription
information.
5\. If the requested data is found, the ADRF sends
Nadrf_DataManagement_RetrievalRequest Response message to the consumer with
HTTP \"200 OK\" status code including a representation of the matched record.
6\. In order to deleted the specified data or analytics from the ADRF, the NF
service consumer shall invoke the Nadrf_DataManagement_Delete service
operation by sending an HTTP DELETE request targeting the resource
\"Individual ADRF Data Store Record\" as described in clause 4.2.2.9 of 3GPP
TS 29.575 [16] if the NF service consumer delete the resource including the
transaction identifier, or by sending an HTTP POST request including the time
window in which the data to be deleted was collected and data or analytics
specification.
7\. The ADRF deletes the specified stored data or analytics requested by the
consumer.
8\. If the deletion is successful processed, the ADRF sends
Nadrf_DataManagement_Delete Response message to the consumer with HTTP \"204
No Content\" status code.
### 5.9.3 Historical Data and Analytics Storage via Notifications
The procedure is used by an NF service consumer (e.g. NWDAF, DCCF) to store
received notifications in the ADRF.
Figure 5.9.3-1: Historical Data and Analytics storage/deletion procedure
1-2. Based on provisioning or based on reception of a DataManagement
subscription request (e.g. see clause 5.5.3.1), the NF service consumer (e.g.
DCCF or NWDAF) determines that notifications are to be stored in the ADRF.
3\. The NF service consumer invokes
Nadrf_DataManagement_StorageSubscriptionRequest service operation by sending
an HTTP POST request in clause 4.2.2.3 of 3GPP TS 29.575 [16]. The request
shall include one of the analytics subscription information, network exposure
function event exposure subscription information, application function event
exposure subscription information, access and mobility function event exposure
subscription information, session management function event exposure
subscription information, or unified data management event exposure
subscription information, and one of the target identifiers, and may include
the formatting instructions and/or processing instructions.
4\. The ADRF may, based on implementation, determines whether the same data or
analytics is already stored or being stored based on the information sent in
step 3 by the consumer.
5\. If the request is successfully processed and accepted, the ADRF sends
Nadrf_DataManagement_StorageSubscriptionRequest Response message to the
consumer with HTTP \"200 OK \" status code including a transaction reference
identifier. If the data and/or analytics is already stored or being stored in
the ADRF, the ADRF sends Nadrf_DataManagement_StorageSubscriptionRequest
Response message to the consumer indicating that data or analytics is stored.
6a. ADRF invokes Ndccf_DataManagement_Subscribe service operation to subscribe
to the DCCF to receive notifications by sending an HTTP POST request message
targeting the resource \"DCCF Analytics Subscriptions\", the HTTP POST message
shall include notification endpoint address and a notification correlation ID
as defined in clause 5.1.6.2.2 of 3GPP TS 29.574 [15].
6b. ADRF invokes Nnwdaf_DataManagement_Subscribe service operation to
subscribe to the NWDAF to receive notifications by sending an HTTP POST
request message targeting the resource \"NWDAF Data Management
Subscriptions\", the HTTP POST message shall include notification endpoint
address and a notification correlation ID as defined in clause 4.4.2.2 of 3GPP
TS 29.520 [5].
7a If the Subscription is successfully processed and accepted, the DCCF sends
Ndccf_DataManagement_Subscribe Response message to the consumer with HTTP
\"201 Created\" status code with the message body containing a representation
of the created subscription.
7b If the Subscription is successfully processed and accepted, the NWDAF sends
Nnwdaf_DataManagement_Subscribe Response message to the consumer with HTTP
\"201 Created\" status code with the message body containing a representation
of the created subscription.
8\. The NF service consumer (e.g. DCCF, MFAF or NWDAF) sends Analytics or Data
notifications containing the notification correlation ID provided by the ADRF
to ADRF notification endpoint address when the historical analytics data are
available.
If the NWDAF is the service consumer in step 7, the NWDAF invokes
Nnwdaf_DataManagement_Notify service operation as defined in clause 4.4.2.4 of
3GPP TS 29.520 [5]. The ADRF stores the notifications and responses to the
Nnwdaf_DataManagement_Notify service operation with HTTP \"204 No Content\"
status code.
If the DCCF is used for data collection in step 7, the DCCF invokes
Ndccf_DataManagement_Notify service operation as defined in clause 4.2.2.4 of
3GPP TS 29.574 [15]. The ADRF stores the notifications and responses to the
Ndccf_DataManagement_Notify service operation with HTTP \"204 No Content\"
status code.
If the Messaging Framework is used for data collection in step 7, the
procedure defined in clause 5.5.3.2 is applicable.
9\. The NF service consumer determines that notifications no longer need to be
stored in the ADRF.
10\. In order to request the ADRF to delete the specified data or analytics
subscription, the NF service consumer shall invoke the
Nadrf_DataManagement_StorageSubscriptionRemoval service operation by sending
an HTTP POST request as described in clause 4.2.2.4 of 3GPP TS 29.575 [16],
including the transaction reference identifier.
11\. If the deletion is successful processed, the ADRF sends
Nadrf_DataManagement_StorageSubscriptionRemoval Response message with HTTP
\"204 No Content\" status code to the consumer.
12a. ADRF invokes Ndccf_DataManagement_Unsubscribe service operation to
subscribe to the DCCF to receive notifications by sending an HTTP DELETE
request message targeting the resource \"Individual DCCF Analytics
Subscription\", the HTTP URI shall include identifier of the existing
analytics subscription that is to be deleted as defined in clause 4.2.2.3.2 of
3GPP TS 29.574 [15].
12b. ADRF invokes Nnwdaf_DataManagement_Unsubscribe service operation to
subscribe to the NWDAF to receive notifications by sending an HTTP DELETE
request message targeting the resource \"Individual NWDAF Data Management
Subscription\", the HTTP DELETE URI shall include identifier of the existing
analytics subscription that is to be deleted as defined in clause 4.4.2.3.2 of
3GPP TS 29.520 [5].
13a If the removal of the corresponding subscription is successfully processed
and accepted, the DCCF sends Ndccf_DataManagement_Unsubscribe Response message
to the consumer with HTTP \"204 No Content\" status code.
13b If the removal of the corresponding subscription is successfully processed
and accepted, the NWDAF sends Nnwdaf_DataManagement_Unsubscribe Response
message to the consumer with HTTP \"204 No Content\" status code.
#