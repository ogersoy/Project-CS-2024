# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
This document defines the protocol for Nt reference point. The Nt reference
point includes Nt application and Nta application.
The functional requirements and the stage 2 specifications of the Nt
application are contained in 3GPP TS 23.203 [2]. The Nt application of Nt
reference point lies between Service Capability Exposure Function (SCEF) and
Policy and Charging Rules Function (PCRF), it supports the negotiation of
background data transfer policy and is documented in the main body of this
document.
The functional requirements and the stage 2 specifications of the Nta
application are contained in clause 5.6.4.1a of 3GPP TS 23.682 [x5]. The Nta
application of Nt reference point lies between SCEF and PCRF, it supports the
event monitoring configuration for a group of UEs and the corresponding event
reporting. The Nta application is documented in Annex A.
NOTE: Nta is a stage 3 name of Diameter Application due to extensibility rule
mentioned in IETF RFC 6733 [15].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.203: \"Policy and charging control architecture\".
[3] IETF RFC 3588: \"Diameter Base Protocol\".
[4] IETF RFC 4006: \"Diameter Credit Control Application\".
[5] 3GPP TS 29.214: \"Policy and Charging Control over Rx reference point\".
[6] 3GPP TS 29.274: \"3GPP Evolved Packet System. Evolved GPRS Tunnelling
Protocol for EPS (GTPv2)\".
[7] IETF RFC 5719: \"Updated IANA Considerations for Diameter Command Code
Allocations \".
[8] IETF RFC 2234: \"Augmented BNF for syntax specifications \".
[9] 3GPP TS 29.213: \"Policy and charging control signalling flows and Quality
of Service (QoS) parameter mapping\".
[10] IETF RFC 7683: \"Diameter Overload Indication Conveyance\".
[11] 3GPP TS 29.229: \"Cx and Dx interfaces based on Diameter protocol;
Protocol details\".
[12] IETF RFC 7944: \"Diameter Routing Message Priority\".
[13] 3GPP TS 29.215: \"Policy and Charging Control (PCC) over S9 reference
point; Stage 3\".
[14] IETF RFC 8583: \"Diameter Load Information Conveyance\".
[15] IETF RFC 6733: \"Diameter Base Protocol\".
[16] 3GPP TS 29.329: \"Sh Interface based on the Diameter protocol\".
[17] 3GPP TS 29.336: \"Home Subscriber Server (HSS) diameter interfaces for
interworking with packet data networks and applications\".
[18] 3GPP TS 29.061: \"Interworking between the Public Land Mobile Network
(PLMN) supporting packet based services and Packet Data Networks (PDN)\".
[19] 3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".
[20] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in 3GPP
TR 21.905 [1].
ASP Application Service Provider
BBERF Bearer Binding and Event Reporting Function
BTA Background Data Transfer Answer
BTR Background Data Transfer Request
ECA Event Configuration Answer
ECR Event Configuration Request
ERA Event Reporting Answer
ERR Event Reporting Request
DRA Diameter Routing Agent
DRMP Diameter Routing Message Priority
PCEF Policy and Charging Enforcement Function
PCRF Policy and Charging Rules Function
SCEF Service Capability Exposure Function
SPR Subscription Profile Repository
# 4 Nt application
## 4.1 Overview
The Nt application of Nt reference point is located between the PCRF and the
SCEF. It is used for reporting the transfer policies from the PCRF to the
SCEF.
The stage 2 requirements for Nt application are defined in TS 23.203 [2].
Refer to Annex G of 3GPP TS 29.213 [9] for Diameter overload control
procedures for the Nt application.
Refer to Annex J of 3GPP TS 29.213 [9] for Diameter message priority mechanism
procedures for the Nt application.
Refer to Annex K of 3GPP TS 29.213 [9] for Diameter load control procedures
for the Nt application.
## 4.2 Nt Reference Model
The Nt application of Nt reference point resides between the SCEF and PCRF.
The relationship between the two functional entities is depicted in figure
4.2-1. The overall PCC architecture is depicted in clause 3a of 3GPP TS 29.213
[9].
Figure 4.2-1: Reference model for Nt application of Nt interface
NOTE: For roaming case, the SCEF is always in the H-PLMN and always contact
the H-PCRF.
## 4.3 Functional elements
### 4.3.1 PCRF
The PCRF is a functional element that encompasses policy control decision and
flow based charging control functionalities.
The PCRF uses the information received from SCEF and other available
information to determine one or more transfer policies for background data to
the application service provider. The PCRF provides the selected transfer
policies with a reference ID to the SPR for storage.
### 4.3.2 SCEF
The SCEF is a functional element which provides a means to securely expose the
services and capabilities provided by 3GPP network interfaces.
The SCEF is triggered by an SCS/AS which requests for the negotiation with the
PCRF for providing necessary policy to transfer background data.
## 4.4 Procedures over the Nt reference point
### 4.4.1 Negotiation for future background data transfer
Based on the SCS/AS request, the SCEF shall send the Background-Data-Transfer-
Request (BTR) command to the PCRF including the Transfer-Request-Type AVP with
the value TRANSFER_POLICY_REQUEST(0), it shall also include the ASP identifier
within the Application-Service-Provider-Identity AVP, volume of data per UE
within the CC-Output-Octets AVP for downlink volume and/or the CC-Input-Octets
AVP for uplink volume, or the CC-Total-Octets AVP for total volume regardless
direction, expected number of UEs within the Number-Of-UEs AVP and desired
time window within the Time-Window AVP.\ The Time-Window AVP shall include
desired start time within the Transfer-Start-Time AVP and desired end time
within the Transfer-End-Time AVP.\ The SCEF may also provide network area
information within Network-Area-Info-List AVP.
Once the PCRF receives the BTR command, the PCRF shall retrieve all existing
transfer policies stored for any ASP from the SPR.\ When all existing transfer
policies are retrieved, the PCRF shall determine one or more transfer policies
based on the information received from the SCEF and other available
information (e.g. network policy, congestion level (if available), load status
estimation for the required time window and network area, existing transfer
policies) and respond with a Background-Data-Transfer-Answer (BTA) command
including the possible transfer policies within Transfer-Policy AVP (s) and a
reference ID within Reference-Id AVP.\ The Transfer-Policy AVP(s) shall
include the Transfer-Policy-Id AVP, the Time-Window AVP, the Rating-Group AVP,
and may also include an Max-Requested-Bandwidth-DL AVP and/or an Max-
Requested-Bandwidth-UL AVP.
If more than one transfer policies are included in the BTA command, the PCRF
shall also include the PCRF Id within the PCRF-Address AVP in the BTA command.
NOTE 1: If only one Transfer-Policy AVP is included in the BTA command, the
PCRF sends a request to the SPR to store the reference ID together with the
transfer policy and corresponding network area information(if available).\ If
there is more than one Transfer-Policy AVP included in the BTA command, the
PCRF waits for the transfer policy selected by the SCS/AS before communicating
with the SPR.
If there is more than one transfer policy provided from the PCRF to the SCEF
in the BTA command, when the SCEF receives the selected transfer policy from
the SCS/AS, the SCEF shall send Background-Data-Transfer-Request (BTR) command
to the PCRF including the Transfer-Request-Type AVP set to the value
TRANSFER_POLICY_NOTIFICATION (1). The SCEF shall also include the reference ID
in the Reference-Id AVP, the identity of the selected transfer policy within
the Transfer-Policy-Id AVP and the destination PCRF Id within the Destination-
Host AVP.
NOTE 2: When receiving the BTA command from the PCRF, if there is only one
transfer policy included, the SCEF forwards the transfer policy to SCS/AS.\ If
there is more than the one transfer policy included, the SCEF forwards these
transfer policies to the SCS/AS and waits for the answer including the
identity of the transfer policy selected by the SCS/AS.
The PCRF shall acknowledge the BTR command by sending Background-Data-
Transfer-Answer (BTA) command.
NOTE 3: The PCRF sends a request to the SPR to store the reference ID together
with the transfer policy and corresponding network area information (if
available).
## 4.5 PCRF selection
The SCEF or DRA (if deployed) may select a PCRF in the HPLMN based on operator
policy (e.g. pre-configured PCRF identities or routing strategy, etc).
# 5 Nt protocol
## 5.1 Protocol support
The Diameter Base Protocol as specified in IETF RFC 6733 [15] shall apply
except as modified by the defined support of the methods and the defined
support of the commands and AVPs, result and error codes as specified in this
specification. Unless otherwise specified, the procedures specified in IETF
RFC 6733 [15] (including error handling and unrecognised information handling)
shall be used unmodified.
The Nt application is defined as vendor specific Diameter application, where
the vendor is 3GPP and the Application-ID for the Nt application in the
present release is 16777348. The vendor identifier assigned by IANA to 3GPP
(http://www.iana.org/assignments/enterprise-numbers) is 10415.
With regard to the Diameter protocol defined for the Nt application, the PCRF
acts as a Diameter server, in the sense that it is the network element that
handles background data transfer request. The SCEF acts as the Diameter
client, in the sense that it is the network element requesting background data
transfer.
## 5.2 Initialization, maintenance and termination of connection and session
The initialization and maintenance of the connection between each SCEF and
PCRF pair is defined by the underlying protocol. Establishment and maintenance
of connections between Diameter nodes is described in IETF RFC 6733 [15].After
establishing the transport connection, the SCEF and the PCRF shall advertise
the support of the Nt specific Application by including the value of the
application identifier in the Auth-Application-Id AVP and the value of the
3GPP (10415) in the Vendor-Id AVP of the Vendor-Specific-Application-Id AVP
contained in the Capabilitiesâ€‘Exchange-Request and Capabilities-Exchange-
Answer commands. The Capabilities-Exchange-Request and Capabilities-Exchange-
Answer commands are specified in the Diameter Base Protocol (IETF RFC 6733
[15]).
An Nt Diameter session shall consist of a single request and answer pair. The
Nt Diameter session is terminated after each request and answer pair
interaction. In order to indicate that the session state is not to be
maintained, the Diameter client and server shall include the Auth-Session-
State AVP with the value set to NO_STATE_MAINTAINED (1), in the request and in
the answer messages (see IETF RFC 6733 [15]).
## 5.3 Nt specific AVPs
### 5.3.1 General
Table 5.3.1.1 describes the Diameter AVPs defined for the Nt application,
their AVP Code values, types, possible flag values, whether or not the AVP may
be encrypted and which supported features the AVP is applicable to. The
Vendor-Id header of all AVPs defined in the present document shall be set to
3GPP (10415).
Table 5.3.1.1: Nt specific Diameter AVPs
+-------+-------+-------+-------+-------+-------+-------+-------+---+ | | | | | AVP | App | | | | | | | | | Flag | licab | | | | | | | | | rules | ility | | | | | | | | | (Note | | | | | | | | | | 1) | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Attr | AVP | C | Value | Must | May | S | Must | | | ibute | Code | lause | Type | | | hould | not | | | Name | | de | | | | not | | | | | | fined | (Note | | | | | | | | | | 2) | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Ne | 4201 | 5.3.2 | O | M,V | P | | | | | twork | | | ctetS | | | | | | | -Area | | | tring | | | | | | | -Info | | | | | | | | | | -List | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Num | 4209 | 5 | Unsig | M,V | P | | | | | ber-O | | .3.10 | ned32 | | | | | | | f-UEs | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Re | 4202 | 5.3.3 | O | M,V | P | | | | | feren | | | ctetS | | | | | | | ce-Id | | | tring | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | T | 4203 | 5.3.4 | Unsig | M,V | P | | | | | ransf | | | ned32 | | | | | | | er-Re | | | | | | | | | | quest | | | | | | | | | | -Type | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | T | 4204 | 5.3.5 | Gr | M,V | P | | | | | ime-W | | | ouped | | | | | | | indow | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Tr | 4205 | 5.3.6 | Time | M,V | P | | | | | ansfe | | | | | | | | | | r-End | | | | | | | | | | -Time | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Trans | 4207 | 5.3.8 | Gr | M,V | P | | | | | fer-P | | | ouped | | | | | | | olicy | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Tra | 4208 | 5.3.9 | Unsig | M,V | P | | | | | nsfer | | | ned32 | | | | | | | -Poli | | | | | | | | | | cy-Id | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Tran | 4206 | 5.3.7 | Time | M,V | P | | | | | sfer- | | | | | | | | | | Start | | | | | | | | | | -Time | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | NOTE | | | | | | | | | | 1: | | | | | | | | | | The | | | | | | | | | | AVP | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | bit | | | | | | | | | | de | | | | | | | | | | noted | | | | | | | | | | as | | | | | | | | | | \ | | | | | | | | | | 'M\', | | | | | | | | | | indi | | | | | | | | | | cates | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | su | | | | | | | | | | pport | | | | | | | | | | of | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | is | | | | | | | | | | requ | | | | | | | | | | ired. | | | | | | | | | | The | | | | | | | | | | AVP | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | bit | | | | | | | | | | de | | | | | | | | | | noted | | | | | | | | | | as | | | | | | | | | | \ | | | | | | | | | | 'V\', | | | | | | | | | | indi | | | | | | | | | | cates | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | the | | | | | | | | | | opt | | | | | | | | | | ional | | | | | | | | | | Vend | | | | | | | | | | or-ID | | | | | | | | | | field | | | | | | | | | | is | | | | | | | | | | pr | | | | | | | | | | esent | | | | | | | | | | in | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | he | | | | | | | | | | ader. | | | | | | | | | | For | | | | | | | | | | fu | | | | | | | | | | rther | | | | | | | | | | det | | | | | | | | | | ails, | | | | | | | | | | see | | | | | | | | | | I | | | | | | | | | | ETF R | | | | | | | | | | FC 67 | | | | | | | | | | 33 [ | | | | | | | | | | 15]. | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: | | | | | | | | | | The | | | | | | | | | | value | | | | | | | | | | types | | | | | | | | | | are | | | | | | | | | | de | | | | | | | | | | fined | | | | | | | | | | in | | | | | | | | | | I | | | | | | | | | | ETF R | | | | | | | | | | FC 67 | | | | | | | | | | 33 [ | | | | | | | | | | 15]. | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+
### 5.3.2 Network-Area-Info-List AVP
The Network-Area-Info-List AVP (AVP code 4201) is of type OctetString, it
contains the network area information which is coded as specified in 3GPP TS
29.274 [6] in Presence Reporting Area Action IE, starting from octet 9.
### 5.3.3 Reference-Id AVP
The Reference-Id AVP (AVP code 4202) is of type OctetString. It is used by the
PCRF to correlate an SCS/AS request with the transfer policy retrieved from
the SPR. It is assigned by the PCRF and shall be globally unique per PLMN.
NOTE: To guarantee the uniqueness of the Reference Id, the Reference Id can
follow the definition of Session Id in IETF RFC 6733 [15].
### 5.3.4 Transfer-Request-Type AVP
The Transfer-Request-Type AVP (AVP code 4203) is of type Unsigned32, it
contains the reason for sending the BT-Request message.
The following values are defined:
0 (TRANSFER_POLICY_REQUEST)
The BT-Request message is sent to initiate a transfer policy request
procedure.
1 (TRANSFER_POLICY_NOTIFICATION)
The BT-Request message is sent to initiate a transfer policy notification
procedure.
### 5.3.5 Time-Window AVP
The Time-Window AVP (AVP code 4204) is of type Grouped. It contains a
Transfer-Start-Time and a Transfer-End-Time. It describes the time interval
during which the SCS/AS may realize the background data transfer.
Time-window ::= \
{ Transfer-Start-Time }
{ Transfer-End-Time }
*[ AVP ]
### 5.3.6 Transfer-End-Time AVP
The Transfer-End-Time AVP (AVP code 4205) is of type Time. It indicates the
NTP time at which the SCS/AS shall stop the background data transfer.
### 5.3.7 Transfer-Start-Time AVP
The Transfer-Start-Time AVP (AVP code 4206) is of type Time. It indicates the
NTP time when the SCS/AS may start the background data transfer.
### 5.3.8 Transfer-Policy AVP
The Transfer-Policy AVP (AVP code 4207) is of type Grouped. It indicates the
transfer policy determined by the PCRF.
Transfer-Policy ::= \
{ Transfer-Policy-Id }
[ Time-Window ]
[ Rating-Group ]
[ Max-Requested-Bandwidth-DL ]
[ Max-Requested-Bandwidth-UL ]
*[ AVP ]
### 5.3.9 Transfer-Policy-Id AVP
The Transfer-Policy-Id AVP (AVP code 4208) is of type Unsigned32. It indicates
the identity of the transfer policy. It is assigned by the PCRF and is unique
per Reference-Id.
### 5.3.10 Number-Of-UEs AVP
The Number-Of-UEs AVP (AVP code 4209) is of type Unsigned32. It indicates the
expected number of UEs.
## 5.4 Nt re-used AVPs
### 5.4.1 General
Table 5.4.1 lists the Diameter AVPs re-used by the Nt application from other
existing Diameter Applications, reference to their respective specifications,
short description of their usage within the Nt application. Other AVPs from
existing Diameter Applications, except for the AVPs from Diameter base
protocol, do not need to be supported. The AVPs from Diameter base protocol
are not included in table 5.4.1, but they are re-used for the Nt application.
Unless otherwise stated, re-used AVPs shall maintain their \'M\', \'P\' and
\'V\' flag settings.
Table 5.4.1: Nt re-used Diameter AVPs
+----------------+----------------+----------------+---------------+ | Attribute Name | Reference | Description | Applicability | | | | | | | | | | (NOTE) | +----------------+----------------+----------------+---------------+ | Applicati | 3GPP T | The identity | | | on-Service-Pro | S 29.214 [5] | of the | | | vider-Identity | | application | | | | | service | | | | | provider that | | | | | is delivering | | | | | a service to | | | | | an end user. | | +----------------+----------------+----------------+---------------+ | CC | IETF | It contains | | | -Output-Octets | RFC 4006 [4] | the number of | | | | | requested, | | | | | octets that | | | | | may be sent to | | | | | involved | | | | | users. | | +----------------+----------------+----------------+---------------+ | C | IETF | It contains | | | C-Input-Octets | RFC 4006 [4] | the number of | | | | | requested | | | | | octets that | | | | | may be | | | | | received from | | | | | the involved | | | | | users. | | +----------------+----------------+----------------+---------------+ | CC-Total- | IETF | It contains | | | Octets | RFC 4006 [4] | the total | | | | | number of | | | | | requested | | | | | octets | | | | | regardless of | | | | | the direction | | | | | (sent or | | | | | received). | | +----------------+----------------+----------------+---------------+ | DRMP | IETF R | Allows | | | | FC 7944 [12] | Diameter | | | | | endpoints to | | | | | indicate the | | | | | relative | | | | | priority of | | | | | Diameter | | | | | transactions. | | +----------------+----------------+----------------+---------------+ | Load | IETF R | The AVP used | | | | FC 8583 [14] | to convey load | | | | | information | | | | | between | | | | | Diameter | | | | | nodes. | | | | | | | | | | This AVP and | | | | | all AVPs | | | | | within this | | | | | grouped AVP | | | | | shall have the | | | | | \'M\' bit | | | | | cleared. | | +----------------+----------------+----------------+---------------+ | Max-Requeste | 3GPP T | Defines the | | | d-Bandwidth-DL | S 29.214 [5] | maximum | | | | | aggregated | | | | | authorized | | | | | bandwidth for | | | | | downlink by | | | | | the PCRF. | | +----------------+----------------+----------------+---------------+ | Max-Requeste | 3GPP T | Defines the | | | d-Bandwidth-UL | S 29.214 [5] | maximum | | | | | aggregated | | | | | authorized | | | | | bandwidth for | | | | | uplink by the | | | | | PCRF. | | +----------------+----------------+----------------+---------------+ | OC-OLR | IETF R | Contains the | | | | FC 7683 [10] | necessary | | | | | information to | | | | | convey an | | | | | overload | | | | | report. | | +----------------+----------------+----------------+---------------+ | OC-Supp | IETF R | Defines the | | | orted-Features | FC 7683 [10] | support for | | | | | the Diameter | | | | | overload | | | | | indication | | | | | conveyence by | | | | | the sending | | | | | node. | | +----------------+----------------+----------------+---------------+ | PCRF-Address | 3GPP TS | The identity, | | | | 29.215 [13] | which | | | | | indicates the | | | | | destination | | | | | PCRF. | | +----------------+----------------+----------------+---------------+ | Rating-Group | IETF | The charging | | | | RFC 4006 [4] | key for the | | | | | aggregated | | | | | traffic of all | | | | | involved UEs | | | | | used for | | | | | rating | | | | | purpose. | | +----------------+----------------+----------------+---------------+ | Supp | 3GPP TS | If present, | | | orted-Features | 29.229 [11] | this AVP | | | | | informs the | | | | | destination | | | | | host about the | | | | | features that | | | | | the origin | | | | | host requires | | | | | to | | | | | successfully | | | | | complete this | | | | | command | | | | | exchange. | | +----------------+----------------+----------------+---------------+ | > NOTE: AVPs | | | | | > marked with | | | | | > a supported | | | | | > feature are | | | | | > applicable | | | | | > as described | | | | | > in | | | | | > | | | | | clause 5.4.2. | | | | +----------------+----------------+----------------+---------------+
### 5.4.2 Use of the Supported-Features AVP for the Nt application
When new functionality is introduced for the Nt application, it should be
defined as optional. If backwards incompatible changes cannot be avoided, the
new functionality shall be introduced as a new feature and support advertised
with the Supported-Features AVP. Unless otherwise stated, the use of the
Supported-Features AVP for the Nt application shall be compliant to the usage
of the Supported-Features AVP on the Cx reference point and consistent with
the procedures for the dynamic discovery of supported features as defined in
clause 7.2 of 3GPP TS 29.229 [11].
The base functionality for the Nt application is the 3GPP Rel-13 standard and
a feature is an extension to that functionality. If the origin host does not
support any features beyond the base functionality, the Supported-Features AVP
may be absent from the Nt commands.
As defined in clause 7.1.1 of 3GPP TS 29.229 [11], when extending the
application by adding new AVPs for a feature, the new AVPs shall have the M
bit cleared and the AVP shall not be defined mandatory in the command ABNF.
As defined in 3GPP TS 29.229 [11], the Supported-Features AVP is of type
grouped and contains the Vendor-Id, Feature-List-ID and Feature-List AVPs. On
the all reference points as specified in this specification, the Supported-
Features AVP is used to identify features that have been defined by 3GPP and
hence, for features defined in this document, the Vendor-Id AVP shall contain
the vendor ID of 3GPP (10415). If there are multiple feature lists defined for
the reference point, the Feature-List-ID AVP shall differentiate those lists
from one another.
The Supported-Features AVP shall be included in every BTR and BTA commands if
supported by the SCEF and PCRF respectively.
The table 5.4.2.1 defines the features applicable to the Nt application for
the feature list with a Feature-List-ID of 1.
Table 5.4.2.1: Features of Feature-List-ID 1 used in Nt
+-------------------------------------+---------+-----+-------------+ | Feature bit | Feature | M/O | Description | +-------------------------------------+---------+-----+-------------+ | | | | | +-------------------------------------+---------+-----+-------------+ | **Feature bit:** The order number | | | | | of the bit within the Feature-List | | | | | AVP where the least significant bit | | | | | is assigned number \"0\". | | | | | | | | | | **Feature:** A short name that can | | | | | be used to refer to the bit and to | | | | | the feature, e.g. \"EPS\". | | | | | | | | | | **M/O:** Defines if the | | | | | implementation of the feature is | | | | | mandatory (\"M\") or optional | | | | | (\"O\") in this 3GPP Release. | | | | | | | | | | **Description:** A clear textual | | | | | description of the feature. | | | | +-------------------------------------+---------+-----+-------------+
NOTE: This table is a placeholder for when any supported features are added to
Nt. There are no supported features in this release.
## 5.5 Nt specific Experimental-Result-Code AVP values
### 5.5.1 General
This clause defines result code values that shall be supported by Diameter
implementations that conform to this specification.
### 5.5.2 Success
Result Codes that fall into the Success category are used to inform a peer
that a request has been successfully completed. The Result-Code AVP values
defined in Diameter base protocol IETF RFC 6733 [15] are applied.
### 5.5.3 Permanent Failures
Errors that fall into the Permanent Failures category shall be used to inform
the peer that the request has failed, and should not be attempted again.
The Result-Code AVP values defined in Diameter base protocol IETF RFC 6733
[15] are applied.
### 5.5.4 Transient Failures
Errors that fall within the Transient Failures category are used to inform a
peer that the request could not be satisfied at the time it was received, but
may be able to satisfy the request in the future.
The Result-Code AVP values defined in Diameter base protocol IETF RFC 6733
[15] are applied.
## 5.6 Nt messages
### 5.6.1 Command-Code Values
This clause defines the Command-Code values for the Nt application as
allocated by IANA from the vendor-specific namespace defined in IETF RFC 5719
[7]. Every command is defined by means of the ABNF syntax in IETF RFC 2234
[8], and according to the rules in IETF RFC 6733 [15].
NOTE: As the commands in the present specification have originally been
defined based on the former specification of the Diameter Base Protocol (IETF
RFC 3588 [3]), the Vendor-Specific-Application-Id AVP is still assumed as a
required AVP (an AVP indicated as {AVP}) in the command code format to avoid
backward compatibility issues, even if the use of this AVP has been deprecated
in the new specification of the Diameter Base Protocol (IETF RFC 6733 [15]).
The Nt application identifier shall be included in the Auth-Application-Id AVP
within the Vendor-Specific-Application-Id grouped AVP contained in the BT-
Request/Answer commands.
The following Command Codes are defined in this specification:
Table 5.6.1: Command-Code values for Nt
* * *
Command-Name Abbreviation Code Section Background-Data-Transfer-Request BTR
8388723 5.6.2 Background-Data-Transfer-Answer BTA 8388723 5.6.3
* * *
### 5.6.2 Background-Data-Transfer-Request (BTR) command
The BTR command, indicated by the Command-Code field set to 8388723 and the
\'R\' bit set in the Command Flags field, is sent by the SCEF to the PCRF as
part of Negotiation for future background data transfer procedure.
Message Format:
\ ::= \
\
[ DRMP ]
{ Vendor-Specific-Application-Id }
{ Auth-Session-State }
{ Origin-Host }
{ Origin-Realm }
{ Destination-Realm }
**{** Transfer-Request-Type **}**
[ Destination-Host ]
**[ OC-Supported-Features ]**
[ Application-Service-Provider-Identity ]
[ CC-Output-Octets ]
[ CC-Input-Octets ]
[ CC-Total-Octets ]
[ Number-Of-UEs ]
[ Time-Window ]
[ Network-Area-Info-List ]
[ Reference-Id ]
[ Transfer-Policy-Id ]
*[ Proxy-Info ]
*[ Route-Record ]
*[ Supported-Features ]
*[ AVP ]
### 5.6.3 Background-Data-Transfer-Answer (BTA) command
The BTA command, indicated by the Command-Code field set to 8388723 and the
\'R\' bit cleared in the Command Flags field, is sent by the PCRF to the SCEF
as part of Negotiation for future background data transfer procedure.
Message Format:
\ ::= \
\
[ DRMP ]
{ Vendor-Specific-Application-Id }
{ Auth-Session-State }
{ Origin-Host }
{ Origin-Realm}
[ Result-Code ]
[ Experimental-Result ]
[ Error-Message ]
[ Error-Reporting-Host ]
[ Failed-AVP ]
*[ Redirect-Host ]
[ Redirect-Host-Usage ]
[ Redirect-Max-Cache-Time ]
[ Reference-Id ]
**[ OC-Supported-Features ]**
**[ OC-OLR ]**
*[ Transfer-Policy ]
[ PCRF-Address ]
*[ Proxy-Info ]
*[ Route-Record ]
*[ Supported-Features ]
*[ Load ]
*[ AVP ]
###### ### Annex A (normative): Nta application
# A.1 Overview
The Nta application of Nt reference point is located between the PCRF and the
SCEF. It is used for configuring event monitoring for a group of UEs and
reporting the event.
The stage 2 requirements for Nta application are defined in TS 23.682 [x5].
Refer to Annex G of 3GPP TS 29.213 [9] for Diameter overload control
procedures for the Nta application.
Refer to Annex J of 3GPP TS 29.213 [9] for Diameter message priority mechanism
procedures for the Nta application.
Refer to Annex K of 3GPP TS 29.213 [9] for Diameter load control procedures
for the Nta application.
# A.2 Reference Model
The Nta application of Nt reference point resides between the SCEF and PCRF.
The relationship between the two functional entities is depicted in figure
A.2-1. The overall PCC architecture is depicted in clause 3a of 3GPP TS 29.213
[9].
Figure A.2-1: Reference model for Nta application of Nt interface
NOTE: For roaming case, the SCEF is always in the H-PLMN and always contact
the H-PCRF.
# A.3 Functional elements
## A.3.1 PCRF
The PCRF is a functional element that encompasses policy control decision and
flow based charging control functionalities.
The PCRF receives event monitoring configuration (e.g. location request) from
the SCEF and applies corresponding procedure over IP-CAN session. The PCRF
reports the subscribed event to the SCEF after receiving report of the IP-CAN
session.
## A.3.2 SCEF
The SCEF is a functional element which provides a means to securely expose the
services and capabilities provided by 3GPP network interfaces.
The SCEF receives event monitoring configuration from an SCS/AS which requests
for the information (e.g. location) for a group of UEs, and reports such
information to the SCS/AS.
# A.4 Procedures over the Nta application
## A.4.1 Event Monitoring Configuration
Based on the SCS/AS request to retrieve the location information for a group
of UEs, the SCEF shall send an Event-Configuration-Request (ECR) command to
the PCRF including the Event-Configuration AVP and the External-Group-
Identifier AVP. The Event-Configuration AVP shall include Monitoring-Type AVP
with the value LOCATION_REPORTING (2), SCEF-ID AVP, Extended-SCEF-Reference-ID
AVP and MONTE-Location-Type AVP within Location-Information-Configuration AVP.
The SCEF may also send the Group-Reporting-Guard-Timer AVP to indicate how
often the event monitoring report shall be sent.
Once the PCRF receives the ECR command, the PCRF shall retrieve UE identities
(MSISDN and optionally UE external identifier) for all UEs in the group
associated with the External-Group-Identifier AVP from the SPR and respond
with an Event-Configuration-Answer (ECA) command including the Event-
Configuration-Status AVP. If the PCRF has at least one active IP-CAN session
for received UE identities and for such IP-CAN session the PCEF/BBERF supports
the NetLoc feature as defined in clause 5.4.1 of 3GPP TS 29.212 [aa], the
Event-Configuration-State AVP within the Event-Configuration-Status AVP shall
indicate this is not a final report with bit 0 not set. For those UEs having
active IP-CAN sessions but without the support of the NetLoc feature in the
PCEF/BBERF, the PCRF shall also send Event-Reports AVP with NetLoc-Access-
Support AVP set to the value NETLOC_ACCESS_NOT_SUPPORTED (0).
NOTE 1: The details associated with the Sp reference point are not specified
in this Release. The SPR\'s relation to existing subscriber databases is not
specified in this Release.
For location reporting, the PCRF shall trigger an IP-CAN session modification
procedure including the Access Network information report request as defined
in 3GPP TS 29.212 [aa] for each UE having active IP-CAN session(s).
If a UE has multiple IP-CAN sessions established in the PCRF, only one IP-CAN
session shall be selected to trigger a PCRF initiated IP-CAN session
modification.
NOTE 2: If a UE has multiple IP-CAN sessions over both 3GPP and non-3GPP
access, the PCRF can prioritize multi access IP-CAN session(s) or 3GPP access
IP-CAN session(s) in the selection among multiple IP-CAN sessions. Then how
the PCRF selects the final IP-CAN session is implementation specific and not
standardized in this specification.
After receiving the ECA command, if the result indicates that it is a final
report, the SCEF does not need to wait for further reporting from such PCRF.
## A.4.2 Event Monitoring Reporting
For location reporting, the PCRF may wait and aggregate (according to Group-
Reporting-Guard-Timer AVP received in the ECR command) the access network
information reported from the PCEF/BBERF for UE(s) that were requested
previously, the PCRF shall send an Event-Reporting-Request (ERR) command to
the SCEF including Event-Reports AVP. The Event-Reports AVP shall include
Extended-SCEF-Reference-ID AVP and the following information for each UE:
MSISDN AVP or External-Identifier AVP (if available and local policy allows
it) and Access-Network-Reports AVP (if available). The PCRF may send the User-
Location-Info-Time AVP within the Access-Network-Reports AVP to indicate that
it is the last known location for a UE. If the PCRF receives NetLoc-Access-
Support AVP with the value NETLOC_ACCESS_NOT_SUPPORTED (0) from the
PCEF/BBERF, it shall relay such AVP to the SCEF within the Access-Network-
Reports AVP. The PCRF shall also indicate whether it is a final reporting for
the group within the Event-Reporting-Results AVP within the Event-Reports AVP.
After receiving the ERR command, the SCEF shall respond with an Event-
Reporting-Answer (ERA) command. If the SCEF receives the Event-Reports AVP
from the PCRF with an Extended-SCEF-Reference-ID not known by the SCEF, it
shall reply with DIAMETER_ERROR_SCEF_REFERENCE_ID_UNKNOWN (5515).
# A.5 PCRF selection
For location reporting, the SCEF shall select all PCRFs and send ECR command
to each PCRF in the same PLMN.
# A.6 Nta protocol
## A.6.1 Protocol support
The Diameter Base Protocol as specified in IETF RFC 6733 [15] shall apply
except as modified by the defined support of the methods and the defined
support of the commands and AVPs, result and error codes as specified in this
specification. Unless otherwise specified, the procedures specified in IETF
RFC 6733 [15] (including error handling and unrecognised information handling)
shall be used unmodified.
The Nta application is defined as vendor specific Diameter application, where
the vendor is 3GPP and the Application-ID for the Nta application in the
present release is 16777358. The vendor identifier assigned by IANA to 3GPP
(http://www.iana.org/assignments/enterprise-numbers) is 10415.
With regard to the Diameter protocol defined for the Nta application, the PCRF
acts as a Diameter server, in the sense that it is the network element that
handles event monitoring request. The SCEF acts as the Diameter client, in the
sense that it is the network element requesting event monitoring report.
## A.6.2 Initialization, maintenance and termination of connection and session
The initialization and maintenance of the connection between each SCEF and
PCRF pair is defined by the underlying protocol. Establishment and maintenance
of connections between Diameter nodes is described in IETF RFC 6733 [15].
After establishing the transport connection, the SCEF and the PCRF shall
advertise the support of the Nta specific Application by including the value
of the application identifier in the Auth-Application-Id AVP and the value of
the 3GPP (10415) in the Vendor-Id AVP of the Vendor-Specific-Application-Id
AVP contained in the Capabilitiesâ€‘Exchange-Request and Capabilities-Exchange-
Answer commands. The Capabilities-Exchange-Request and Capabilities-Exchange-
Answer commands are specified in the Diameter Base Protocol (IETF RFC 6733
[15]).
An Nta Diameter session shall consist of a single request and answer pair. The
Nta Diameter session is terminated after each request and answer pair
interaction. In order to indicate that the session state is not to be
maintained, the Diameter client and server shall include the Auth-Session-
State AVP with the value set to NO_STATE_MAINTAINED (1), in the request and in
the answer messages (see IETF RFC 6733 [15]).
## A.6.3 Nta specific AVPs
### A.6.3.1 General
Table A.6.3.1-1 describes the Diameter AVPs defined for the Nta application,
their AVP Code values, types, possible flag values, whether or not the AVP may
be encrypted and which supported features the AVP is applicable to. The
Vendor-Id header of all AVPs defined in the present document shall be set to
3GPP (10415).
Table A.6.3.1-1: Nta specific Diameter AVPs
+-------+-------+-------+-------+-------+-------+-------+-------+---+ | | | | | AVP | App | | | | | | | | | Flag | licab | | | | | | | | | rules | ility | | | | | | | | | (Note | | | | | | | | | | 1) | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Attr | AVP | C | Value | Must | May | S | Must | | | ibute | Code | lause | Type | | | hould | not | | | Name | | de | | | | not | | | | | | fined | (Note | | | | | | | | | | 2) | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Ac | 4210 | A. | Gr | M,V | P | | | | | cess- | | 6.3.2 | ouped | | | | | | | Netwo | | | | | | | | | | rk-Re | | | | | | | | | | ports | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Even | 4211 | A. | Gr | M,V | P | | | | | t-Con | | 6.3.3 | ouped | | | | | | | figur | | | | | | | | | | ation | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Event | 4212 | A. | Unsig | M,V | P | | | | | -Conf | | 6.3.4 | ned32 | | | | | | | igura | | | | | | | | | | tion- | | | | | | | | | | State | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | E | 4213 | A. | Gr | M,V | P | | | | | vent- | | 6.3.5 | ouped | | | | | | | Confi | | | | | | | | | | gurat | | | | | | | | | | ion-S | | | | | | | | | | tatus | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Eve | 4214 | A. | Unsig | M,V | P | | | | | nt-Re | | 6.3.6 | ned32 | | | | | | | porti | | | | | | | | | | ng-Re | | | | | | | | | | sults | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | Eve | 4215 | A. | Gr | M,V | P | | | | | nt-Re | | 6.3.7 | ouped | | | | | | | ports | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | E | 4216 | A. | Unsig | M,V | P | | | | | xtend | | 6.3.8 | ned64 | | | | | | | ed-SC | | | | | | | | | | EF-Re | | | | | | | | | | feren | | | | | | | | | | ce-ID | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+ | NOTE | | | | | | | | | | 1: | | | | | | | | | | The | | | | | | | | | | AVP | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | bit | | | | | | | | | | de | | | | | | | | | | noted | | | | | | | | | | as | | | | | | | | | | \ | | | | | | | | | | 'M\', | | | | | | | | | | indi | | | | | | | | | | cates | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | su | | | | | | | | | | pport | | | | | | | | | | of | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | is | | | | | | | | | | requ | | | | | | | | | | ired. | | | | | | | | | | The | | | | | | | | | | AVP | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | bit | | | | | | | | | | de | | | | | | | | | | noted | | | | | | | | | | as | | | | | | | | | | \ | | | | | | | | | | 'V\', | | | | | | | | | | indi | | | | | | | | | | cates | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | the | | | | | | | | | | opt | | | | | | | | | | ional | | | | | | | | | | Vend | | | | | | | | | | or-ID | | | | | | | | | | field | | | | | | | | | | is | | | | | | | | | | pr | | | | | | | | | | esent | | | | | | | | | | in | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | he | | | | | | | | | | ader. | | | | | | | | | | For | | | | | | | | | | fu | | | | | | | | | | rther | | | | | | | | | | det | | | | | | | | | | ails, | | | | | | | | | | see | | | | | | | | | | I | | | | | | | | | | ETF R | | | | | | | | | | FC 67 | | | | | | | | | | 33 [ | | | | | | | | | | 15]. | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: | | | | | | | | | | The | | | | | | | | | | value | | | | | | | | | | types | | | | | | | | | | are | | | | | | | | | | de | | | | | | | | | | fined | | | | | | | | | | in | | | | | | | | | | I | | | | | | | | | | ETF R | | | | | | | | | | FC 67 | | | | | | | | | | 33 [ | | | | | | | | | | 15]. | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+---+
### A.6.3.2 Access-Network-Reports AVP
The Access-Network-Reports AVP (AVP code 4210) is of type Grouped. It
indicates the access network information for a UE.
Access-Network-Reports ::= \
[ MSISDN ]
[ External-Identifier ]
[ 3GPP-User-Location-Info ]
[ User-Location-Info-Time ]
[ 3GPP-SGSN-MCC-MNC ]
[ 3GPP-MS-TimeZone ]
[ UE-Local-IP-Address ]
[ TCP-Source-Port ]
[ UDP-Source-Port ]
[ NetLoc-Access-Support ]
*[ AVP ]
### A.6.3.3 Event-Configuration
The Event-Configuration AVP (AVP code 4211) is of type Grouped, and it
contains the details of the monitoring event configuration from the SCEF.
Event-Configuration ::= \
{ Extended-SCEF-Reference-ID }
{ SCEF-ID }
{ Monitoring-Type }
[ Location-Information-Configuration ]
*[ AVP ]
### A.6.3.4 Event-Configuration-State AVP
The Event-Configuration-State AVP (AVP code 4212) is of type Unsigned32, it
shall contain a bit mask. The bit 0 shall be the least significant bit. For
example, to get the value of bit 0, a bit mask of 0x0001 should be used. The
meaning of the bits shall be as defined below:
Table A.6.3.4-1: Event-Configuration-State
* * *
Bit Name Description 0 Final report This bit, when set, indicates that this is
the final report for the UE group; when not set, indicates that there are more
reports pending for the UE group.
* * *
### A.6.3.5 Event-Configuration-Status AVP
The Event-Configuration-Status AVP (AVP code 4213) is of type Grouped. It
indicates the status for the monitoring event configuration.
Event-Configuration-Status ::= \
{ Event-Configuration-State }
{ Extended-SCEF-Reference-ID }
*[ AVP ]
### A.6.3.6 Event-Reporting-Results AVP
The Event-Reporting-Results AVP (AVP code 4214) is of type Unsigned32, it
shall contain a bit mask. The bit 0 shall be the least significant bit. For
example, to get the value of bit 0, a bit mask of 0x0001 should be used. The
meaning of the bits shall be as defined below:
Table A.6.3.6-1: Event-Reporting-Results
* * *
Bit Name Description 0 Final report This bit, when set, indicates that this is
the final report for the UE group; when not set, indicates that there are more
reports pending for the UE group.
* * *
### A.6.3.7 Event-Reports AVP
The Event-Reports AVP (AVP code 4215) is of type Grouped. It indicates the
event reports for a UE group.
Event-Reports ::= \
{ Event-Reporting-Results }
{ Extended-SCEF-Reference-ID }
*[ Access-Network-Reports ]
*[ AVP ]
### A.6.3.8 Extended-SCEF-Reference-ID
The Extended-SCEF-Reference-ID AVP (AVP code 4216) is of type Unsigned64 and
it shall contain the identifier provided by the SCEF.
## A.6.4 Nta re-used AVPs
### A.6.4.1 General
Table A.6.4.1-1 lists the Diameter AVPs re-used by the Nta application from
other existing Diameter Applications, reference to their respective
specifications, short description of their usage within the Nta application.
Other AVPs from existing Diameter Applications, except for the AVPs from
Diameter base protocol, do not need to be supported. The AVPs from Diameter
base protocol are not included in table A.6.4.1-1, but they are re-used for
the Nta application. Unless otherwise stated, re-used AVPs shall maintain
their \'M\', \'P\' and \'V\' flag settings.
Table A.6.4.1-1: Nta re-used Diameter AVPs
+----------------+----------------+----------------+---------------+ | Attribute Name | Reference | Description | Applicability | | | | | | | | | | (NOTE) | +----------------+----------------+----------------+---------------+ | 3G | 3GPP TS | Indicate the | | | PP-MS-TimeZone | 29.061 [18] | offset between | | | | | universal time | | | | | and local time | | | | | in steps of 15 | | | | | minutes of | | | | | where the MS | | | | | currently | | | | | resides. | | +----------------+----------------+----------------+---------------+ | 3GP | 3GPP TS | For GPRS the | | | P-SGSN-MCC-MNC | 29.061 [18] | MCC and the | | | | | MNC of the | | | | | SGSN. | | | | | | | | | | For | | | | | 3GPP/non-3GPP | | | | | accesses the | | | | | MCC and the | | | | | MNC provided | | | | | by the serving | | | | | gateway (SGW, | | | | | or AGW or | | | | | TWAG). | | +----------------+----------------+----------------+---------------+ | 3GPP-User | 3GPP TS | Indicates | | | -Location-Info | 29.061 [18] | details of | | | | | where the UE | | | | | is currently | | | | | located (e.g. | | | | | SAI, CGI or | | | | | eNodeB ID) | | +----------------+----------------+----------------+---------------+ | DRMP | IETF R | Allows | | | | FC 7944 [12] | Diameter | | | | | endpoints to | | | | | indicate the | | | | | relative | | | | | priority of | | | | | Diameter | | | | | transactions. | | +----------------+----------------+----------------+---------------+ | Exter | 3GPP TS | External | | | nal-Identifier | 29.336 [17] | Identifier of | | | | | the UE | | +----------------+----------------+----------------+---------------+ | **G | 3GPP TS | It is used by | | | roup-Reporting | 29.336 [17] | the PCRF to | | | -Guard-Timer** | | aggregate the | | | | | reports. | | +----------------+----------------+----------------+---------------+ | Load | IETF R | The AVP used | | | | FC 8583 [14] | to convey load | | | | | information | | | | | between | | | | | Diameter | | | | | nodes. | | | | | | | | | | This AVP and | | | | | all AVPs | | | | | within this | | | | | grouped AVP | | | | | shall have the | | | | | \'M\' bit | | | | | cleared. | | +----------------+----------------+----------------+---------------+ | Locati | 3GPP TS | Only | | | on-Information | 29.336 [17] | MONTE | | | -Configuration | | -Location-Type | | | | | AVP is | | | | | applicable for | | | | | the Nta | | | | | application. | | +----------------+----------------+----------------+---------------+ | M | 3GPP TS | Only | | | onitoring-Type | 29.336 [17] | LOCAT | | | | | ION_REPORTING | | | | | (2) is | | | | | applicable for | | | | | the Nta | | | | | application. | | +----------------+----------------+----------------+---------------+ | MONTE | 3GPP TS | Indicates the | | | -Location-Type | 29.336 [17] | current | | | | | location or | | | | | the last known | | | | | location. | | +----------------+----------------+----------------+---------------+ | MSISDN | 3GPP TS | MSISDN of the | | | | 29.329 [16] | UE | | +----------------+----------------+----------------+---------------+ | NetLoc- | 3GPP TS | Indicates the | | | Access-Support | 29.212 [19] | level of | | | | | support for | | | | | NetLoc | | | | | procedures | | | | | provided by | | | | | the current | | | | | access | | | | | network. | | +----------------+----------------+----------------+---------------+ | OC-OLR | IETF R | Contains the | | | | FC 7683 [10] | necessary | | | | | information to | | | | | convey an | | | | | overload | | | | | report. | | +----------------+----------------+----------------+---------------+ | OC-Supp | IETF R | Defines the | | | orted-Features | FC 7683 [10] | support for | | | | | the Diameter | | | | | overload | | | | | indication | | | | | conveyence by | | | | | the sending | | | | | node. | | +----------------+----------------+----------------+---------------+ | SCEF-ID | 3GPP TS | The diameter | | | | 29.336 [17] | identifier | | | | | provided by | | | | | the SCEF which | | | | | has originated | | | | | the request | | | | | towards the | | | | | PCRF. | | +----------------+----------------+----------------+---------------+ | Supp | 3GPP TS | If present, | | | orted-Features | 29.229 [11] | this AVP | | | | | informs the | | | | | destination | | | | | host about the | | | | | features that | | | | | the origin | | | | | host requires | | | | | to | | | | | successfully | | | | | complete this | | | | | command | | | | | exchange. | | +----------------+----------------+----------------+---------------+ | T | 3GPP TS | TCP source | | | CP-Source-Port | 29.212 [19] | port number | | +----------------+----------------+----------------+---------------+ | U | 3GPP TS | UDP source | | | DP-Source-Port | 29.212 [19] | port number | | +----------------+----------------+----------------+---------------+ | UE-Lo | 3GPP TS | Contains the | | | cal-IP-Address | 29.212 [19] | UE local IP | | | | | address. | | +----------------+----------------+----------------+---------------+ | User-Loca | 3GPP TS | The time at | | | tion-Info-Time | 29.212 [19] | which the UE | | | | | was last known | | | | | to be in the | | | | | location. | | +----------------+----------------+----------------+---------------+ | NOTE: AVPs | | | | | marked with a | | | | | supported | | | | | feature are | | | | | applicable as | | | | | described in | | | | | c | | | | | lause A.6.4.2. | | | | +----------------+----------------+----------------+---------------+
### A.6.4.2 Use of the Supported-Features AVP for the Nt application
When new functionality is introduced for the Nt application, it should be
defined as optional. If backwards incompatible changes cannot be avoided, the
new functionality shall be introduced as a new feature and support advertised
with the Supported-Features AVP. Unless otherwise stated, the use of the
Supported-Features AVP for the Nt application shall be compliant to the usage
of the Supported-Features AVP on the Cx reference point and consistent with
the procedures for the dynamic discovery of supported features as defined in
clause 7.2 of 3GPP TS 29.229 [11].
The base functionality for the Nta application is the 3GPP Rel-15 standard and
a feature is an extension to that functionality. If the origin host does not
support any features beyond the base functionality, the Supported-Features AVP
may be absent from the Nta commands.
As defined in clause 7.1.1 of 3GPP TS 29.229 [11], when extending the
application by adding new AVPs for a feature, the new AVPs shall have the M
bit cleared and the AVP shall not be defined mandatory in the command ABNF.
As defined in 3GPP TS 29.229 [11], the Supported-Features AVP is of type
grouped and contains the Vendor-Id, Feature-List-ID and Feature-List AVPs. On
the all reference points as specified in this specification, the Supported-
Features AVP is used to identify features that have been defined by 3GPP and
hence, for features defined in this document, the Vendor-Id AVP shall contain
the vendor ID of 3GPP (10415). If there are multiple feature lists defined for
the reference point, the Feature-List-ID AVP shall differentiate those lists
from one another.
The Supported-Features AVP shall be included in every ECR and ECA commands if
supported by the SCEF and PCRF respectively.
The table A.6.4.2-1 defines the features applicable to the Nta application for
the feature list with a Feature-List-ID of 1.
Table A.6.4.2-1: Features of Feature-List-ID 1 used in Nta
+-------------------------------------+---------+-----+-------------+ | Feature bit | Feature | M/O | Description | +-------------------------------------+---------+-----+-------------+ | | | | | +-------------------------------------+---------+-----+-------------+ | **Feature bit:** The order number | | | | | of the bit within the Feature-List | | | | | AVP where the least significant bit | | | | | is assigned number \"0\". | | | | | | | | | | **Feature:** A short name that can | | | | | be used to refer to the bit and to | | | | | the feature, e.g. \"EPS\". | | | | | | | | | | **M/O:** Defines if the | | | | | implementation of the feature is | | | | | mandatory (\"M\") or optional | | | | | (\"O\") in this 3GPP Release. | | | | | | | | | | **Description:** A clear textual | | | | | description of the feature. | | | | +-------------------------------------+---------+-----+-------------+
NOTE: This table is a placeholder for when any supported features are added to
Nta. There are no supported features in this release.
## A.6.5 Nta specific Experimental-Result-Code AVP values
Clause 5.5 is applicable for Nta specific Experimental-Result-Code AVP values.
## A.6.6 Nta messages
### A.6.6.1 Command-Code Values
This clause defines the Command-Code values for the Nta application as
allocated by IANA from the vendor-specific namespace defined in IETF RFC 5719
[7]. Every command is defined by means of the ABNF syntax in IETF RFC 2234
[8], and according to the rules in IETF RFC 6733 [15].
The Vendor-Specific-Application-Id AVP shall not be included in any command
sent by Diameter nodes supporting applications defined in this specification.
If the Vendor-Specific-Application-Id AVP is received in any of the commands
defined in this specification, it shall be ignored by the receiving node.
NOTE: The Vendor-Specific-Application-Id is included as an optional AVP in all
Command Code Format specifications defined in this specification in order to
overcome potential interoperability issues with intermediate Diameter agents
non-compliant with the IETF RFC 6733 [15].
The following Command Codes are defined in this specification:
Table A.6.6-1: Command-Code values for Nta
* * *
Command-Name Abbreviation Code Section Event-Configuration-Request ECR 8388735
A.6.6.2 Event-Configuration-Answer ECA 8388735 A.6.6.3 Event-Reporting-Request
ERR 8388736 A.6.6.4 Event-Reporting-Answer ERA 8388736 A.6.6.5
* * *
### A.6.6.2 Event-Configuration-Request (ECR) command
The ECR command, indicated by the Command-Code field set to 8388735 and the
\'R\' bit set in the Command Flags field, is sent by the SCEF to the PCRF as
part of event monitoring configuration procedure.
Message Format:
\ ::= \
\
[ DRMP ]
{ Auth-Session-State }
{ Origin-Host }
{ Origin-Realm }
{ Destination-Realm }
[ Destination-Host ]
**[ OC-Supported-Features ]**
{ External-Group-Identifier }
[ Event-Configuration ]
[ Group-Reporting-Guard-Timer ]
*[ Proxy-Info ]
*[ Route-Record ]
*[ Supported-Features ]
*[ AVP ]
### A.6.6.3 Event-Configuration-Answer (ECA) command
The ECA command, indicated by the Command-Code field set to 8388735 and the
\'R\' bit cleared in the Command Flags field, is sent by the PCRF to the SCEF
as part of event monitoring configuration procedure.
Message Format:
\ ::= \
\
[ DRMP ]
{ Auth-Session-State }
{ Origin-Host }
{ Origin-Realm}
[ Result-Code ]
[ Experimental-Result ]
[ Error-Message ]
[ Error-Reporting-Host ]
[ Failed-AVP ]
*[ Redirect-Host ]
[ Redirect-Host-Usage ]
[ Redirect-Max-Cache-Time ]
**[ OC-Supported-Features ]**
**[ OC-OLR ]**
[ Event-Reports ]
[ Event-Configuration-Status ]
*[ Proxy-Info ]
*[ Route-Record ]
*[ Supported-Features ]
*[ Load ]
*[ AVP ]
### A.6.6.4 Event-Reporting-Request (ERR) command
The ERR command, indicated by the Command-Code field set to 8388736 and the
\'R\' bit set in the Command Flags field, is sent by the PCRF to the SCEF as
part of event monitoring report procedure.
Message Format:
\ ::= \
\
[ DRMP ]
{ Auth-Session-State }
{ Origin-Host }
{ Origin-Realm }
{ Destination-Realm }
{ Destination-Host }
**[ OC-Supported-Features ]**
[ Event-Reports ]
*[ Proxy-Info ]
*[ Route-Record ]
*[ AVP ]
### A.6.6.5 Event-Reporting-Answer (ERA) command
The ERA command, indicated by the Command-Code field set to 8388736 and the
\'R\' bit cleared in the Command Flags field, is sent by the SCEF to the PCRF
as part of event monitoring report procedure
Message Format:
\ ::= \
\
[ DRMP ]
{ Auth-Session-State }
{ Origin-Host }
{ Origin-Realm}
[ Result-Code ]
[ Experimental-Result ]
[ Error-Message ]
[ Error-Reporting-Host ]
[ Failed-AVP ]
*[ Redirect-Host ]
[ Redirect-Host-Usage ]
[ Redirect-Max-Cache-Time ]
**[ OC-Supported-Features ]**
**[ OC-OLR ]**
*[ Proxy-Info ]
*[ Route-Record ]
*[ Load ]
*[ AVP ]
#