# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# Introduction
IANA maintains the list of the assigned port numbers, which are allocated for
specific applications, like the well-known ports from the System Port number
range [0-1023], or from the User Port number range [1024-49151] for the
private networks such as 3GPP. Dynamic/Private Port number range [49152 -
65535] is not restricted by IANA and may be used by applications without any
restrictions. For the IANA port number range definitions see clause 6 in IEFT
RFC 6335 [2].
3GPP interface applications typically also utilize fixed port numbers at which
they are expecting to receive (are listening to) the application specific
traffic. Therefore, when necessary 3GPP requests IANA to assign a port number
and allocate it to a specific interface application, e.g. GTP. 3GPP specific
port numbers are assigned from the User Port number range [1024-49151]. 3GPP
interface applications are required to use the allocated ports only for the
given interface traffic.
Recently however IANA became reluctant to assign new port numbers for
protocols only used for network internal services, i.e. when the protocol is
only used in a single network with no interconnection with other networks or
the public Internet, and this applies to some of the protocols newly defined
by 3GPP. As a consequence, 3GPP was forced to find a temporary solution (e.g.
for S17 interface) to utilize port number allocation from the Dynamic/Private
Port number range [49152 - 65535], where it became operator responsibility to
configure network elements and avoid port clashes. Annex A provides more
information on IANA port allocation policy.
The purpose of this study is to find a long lasting and forward compatible
solution for the future protocols for 3GPP interfaces. This study will analyse
alternative solutions and provide guidelines on the port numbers allocation
method, which will not require IANA action every time a need arises for a new
port number allocation.
# 1 Scope
The present document studies alternative proposals for the port number
allocations to the new 3GPP interfaces and applications. The study will focus
on, but is not limited to following three alternatives:
\- 3GPP allocating port numbers from the Dynamic/Private Port number range
[49152 - 65535]. See clause 6 in IETF RFC 6335 [2];
\- Operators allocating port numbers from either the User Port number range
[1024-49151] or the Dynamic/Private Port number range [49152 - 65535]. See
clause 6 in IETF RFC 6335 [2];
\- DNS based solution, where port numbers are allocated from the User Port
number range [1024-49151] or the Dynamic/Private Port number range [49152 -
65535]. See clause 6 in IETF RFC 6335 [2].
The primary focus of this study is on protocols only used for network internal
services, i.e. when the protocol is only used in a single network with no
interconnection with other networks or the public Internet. The solutions
proposed in the study however could also be used in scenarios in which the
protocol is used across multiple networks, e.g. in roaming case or between the
RAN and the core network supported by different operator networks.
# 2 References {#references-1}
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] IETF RFC 6335: \"Internet Assigned Numbers Authority (IANA) Procedures for
the Management of the Service Name and Transport Protocol Port Number
Registry\".
[3] IETF RFC 7605: \"Recommendations on Using Assigned Transport Port
Numbers\".
[4] IETF RFC 4960: \"Stream Control Transmission Protocol\".
[5] ORAN-WG3.E2GAP, \"O-RAN Working Group 3 Near-Real-time RAN Intelligent
Controller Architecture & E2 General Aspects and Principles\".
[6] IETF RFC 6763: \"DNS-Based Service Discovery\".
[7] IETF RFC 2782: \"A DNS RR for specifying the location of services (DNS
SRV)\".
[8] IETF RFC 6762: \"Multicast DNS\".
[9] IETF RFC 8126: \"Guidelines for Writing an IANA Considerations Clause in
RFCs\".
[10] IETF RFC 1078: \"TCP Port Service Multiplexer (TCPMUX)\"
[11] 3GPP TR 29.941: \"Guidelines on Port Allocation for New 3GPP
Interfaces\".
[12] IETF RFC 7805: \"Moving Outdated TCP Extensions and TCP-Related Documents
to Historic or Informational Status\".
[13] IETF RFC 793: \"Transmission Control Protocol\".
[14] IETF RFC 5226: \"Guidelines for Writing an IANA Considerations clause in
RFCs\".
[15] IETF RFC 7301: \"Transport Layer Security (TLS) Application-Layer
Protocol Negotiation Extension\".
[16] IETF RFC 8446: \"The Transport Layer Security (TLS) Protocol Version
1.3\".
[17] IETF RFC 6347: \"Datagram Transport Layer Security Version 1.2\".
[18] IETF RFC 6066: \"Transport Layer Security (TLS) Extensions: Extension
Definitions\".
[19] IETF RFC 1035: \"Domain Names -- Implementation and specification\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
**Port allocation mechanisms:** There are two main port allocation mechanisms,
static and dynamic. With static allocation, server port number is known to the
clients and can be used during the implantation phase. With dynamic
allocation, server port number is allocated runtime and therefore the clients
need to discover the server port number by one of the well-defined procedures.
**Server port number:** A number of a transport layer port (UDP, TCP, SCTP,
DCCP), which is allocated to an application server. Server listens to certain
port, which means clients can send messages to this port. Ports may be either
statically or dynamically assigned to certain 3GPP interface applications.
**Server port number assignment methods:** This TR refers to the following two
methods.
> (a) Fixed: this port allocation method implies there is no need for a client
> to discover a server port number. That is, the server port number is well-
> known (not to be confused with IANA well-known ports from the System Port
> number range [0-1023]).
>
> (b) Unassigned: this port allocation method implies a client must discover a
> server port number. The server port number may be pre-configured or may be
> dynamically assigned at runtime.
## 3.2 Void
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
IANA Internet Assigned Numbers Authority
IESG Internet Engineering Steering Group
IETF Internet Engineering Task Force
OAM Operation And Maintenance
RAN Radio Access Network
RFC Request For Comments
# 4 Requirements
## 4.1 General
3GPP working groups need a way for allocating and reserving port numbers for
the new interfaces and applications (this includes potential solutions when
operators allocate port numbers). The objective is to specify future proof
guidelines, i.e. when a new port number is required to be allocated to a new
interface, its selection method needs to be consistent and compatible with
other port number allocations for 3GPP Rel-17 and onwards.
NOTE: Many applications are dynamically selecting port numbers when populating
source port field in UDP/TCP header, e.g. for load balancing. These
applications are aware of the IANA reserved port numbers and therefore avoid
using these numbers when populating source port field to avert unwanted
traffic coming to these reserved ports. Point is, in a request-response type
of communication, the remote peer typically sends the response message to the
port number, which is populating the source port field of the received request
message.
## 4.2 Requirement #1: At least either the port number or the Payload Protocol
Identifier value shall be standardized for new SCTP interfaces
### 4.2.1 Problem Statement
Currently in 3GPP networks, each SCTP interface/application uses standardized
well-known port for communication. Having a standardized port for the
application is beneficial in many ways. For example, it is extremely useful
during analysis of issues found at product testing, field deployments and
customer support and for packet analysis using protocol analyser tools. The
SCTP protocol stacks in protocol analyser tools use port number and/or SCTP
Payload Protocol Identifier (PPI) to decide which transported protocol to
apply. For example, in Wireshark, if there is a protocol registered based on
the SCTP PPI, then this registration takes precedence and if there is only a
registration based on the SCTP port number, then this one is used.
Given the current situation that we are in, due to the extremely restrictive
stand taken by IANA in port number assignment, 3GPP is looking at alternative
solutions for the port number allocations, which includes possibility of
dynamically allocating the port numbers through OAM or DNS based solution.
Using dynamic port numbers while defining new SCTP interfaces will directly
impact and create significant problems for product test, field deployments and
customer support engineers in performing protocol analysis and troubleshooting
of interface related issues. For example, the port number shall be now
manually configured in the protocol analyser tool, for it to be able to decode
the protocol dump. This will become an even bigger issue if there are multiple
instances of the interface/application deployed in the network and each
instance is using a different dynamic port number.
One way to address the problem created by dynamic allocation of port numbers
is to standardize the SCTP Payload Protocol Identifier value for each new SCTP
interface defined by 3GPP.The Payload Protocol Identifier can be used to
easily identify the interface/application when the interface/application is
not using a standardized or well-known SCTP port.
Standardizing the SCTP Payload Protocol Identifier for each new 3GPP defined
SCTP interfaces will ensure that we are able to use a solution to dynamically
allocate port numbers for an interface while still protecting the best
interests of product testers, field deployment engineers and customer support
engineers.
### 4.2.2 Requirement
The selected solution shall ensure that a newly defined SCTP
interface/application has at least either the port number or the SCTP Payload
Protocol Identifier value standardized.
## 4.3 Requirement #2: Criteria for selecting preferred solutions
This TR collects more than a dozen solution proposals. Each solution has own
merits and drawbacks. The following criteria should be applied when evaluating
the solutions:
a. Whether the proposed solution requires the impacted Network Element (NE) to
interact with another specific NE or not. For example, DNS-based and NRF-based
solution would require interaction with a DNS server or an NRF, which may not
be currently supported by existing NE (e.g. RAN NE).
b. Whether the proposed solution can be used in both intra-domain and inter-
domain scenarios, i.e. if the proposed solution is limited to one of these or
not. This criterion also has a certain dependency to the above criterion.
NOTE: Apparently, all solutions will impact new 3GPP interface applications
and therefore such criterion should not be applied.
In addition to the above criteria, the solutions should be grouped in several
solution categories:
1\. Fixed vs. Unassigned port allocation method (see clause 3.1 for the term
definitions).
2\. Is transport layer protocol specific vs generic (protocol agnostic).
The above provisions are illustrated in Table 2-1, which illustrates
characteristics of various imaginary solutions.
Table 2-1: Characteristics of various possible solutions
                                                                Solution\#A   Solution\#B   ...   Solution\#X
* * *
Does not require new feature support by the NE Yes No No Can be used in both
intra-domain and inter-domain scenarios Yes No Yes Belongs to Fixed category
Yes No Yes Belongs to Unassigned category No Yes No Is transport layer
protocol agnostic Yes Yes No
# 5 Key Issues
## 5.1 General
This clause describes key issues. Each clause will describe one key issue.
## 5.2 Key Issue #1: Roaming/inter-domain scenario
### 5.2.1 Description of the use case
Key Issue #1 is to avert port number clashes in a roaming scenario and also
non-roaming scenario when network elements are operated by different network
administrations. Therefore, selected solution shall ensure that only the
intended traffic will be received at the newly defined application ports
across the inter-domain interfaces. The inter-domain scenarios cover the below
interfaces:
\- Roaming interfaces
\- Any Inter PLMN interface
\- RAN to CN interfaces, as for supporting RAN sharing use cases (single RAN
shared by multiple PLMN\'s CN), the RAN to CN interface also falls into the
category of inter-domain scenario.
### 5.2.2 Key issue definition
The IETF RFC 7605 [3] provides recommendations to designers of application and
service protocols on how to use the transport protocol port number space and
when to request a port assignment from IANA.
In this document, it is reminded that:
IANA assigns port numbers so that Internet endpoints do not need pairwise,
explicit coordination of the meaning of their port numbers. This is the
primary reason for requesting port number assignment by IANA: to have a common
agreement between all endpoints on the Internet as to the default meaning of a
port number, which provides the endpoints with a default port number for a
particular protocol or service.
It is also clarified that:
Port numbers can also be used for other purposes. Assigned port numbers can
simplify end-system configuration, so that individual installations do not
need to coordinate their use of arbitrary port numbers. Such assignments may
also have the effect of simplifying firewall management, so that a single,
fixed firewall configuration can either permit or deny a service that uses the
assigned ports.
In typical roaming scenarios, three or more administrative domains can be
crossed: visited and home PLMN, one or more IPX providers connecting together
via an IPX peering point for traffic exchange between PLMNs. Operators and
service providers may even decide to rely on the global connectivity provided
by the public Internet for interconnection.
As roaming implies the need for a global configuration of the port to use for
a particular protocol, it is strongly recommended for 3GPP to apply to IANA
for assigned service name and port number for any protocol potentially
supported by roaming interfaces when DNS-based solutions are not applicable.
In non-roaming scenarios, a given interface can still cross multiple domains.
For instance, RAN can be supported by an IP-based network distinct from the
one supporting the core network even if both are under the same PLMN, or in a
RAN sharing case (i.e. same RAN is used by multiple PLMN\'s CN) the interface
between RAN and CN also crosses multiple administrative domains. In such a
case, it is also strongly recommended for 3GPP to apply to IANA for assigned
service name and port number for any protocol potentially supported by inter-
domain interfaces when DNS-based solutions are not applicable.
The study should also evaluate whether Dynamic/Private Port numbers range
[49152 - 65535] and/or User Port number range [1024-49151] can be used for new
3GPP interfaces.
## 5.3 Key Issue #2: Intra-domain scenario
### 5.3.1 Description of the use case
Key Issue #2 is to avert port number clashes in intra-domain scenarios.
Therefore, selected solution shall ensure that only the intended traffic will
be received at the newly defined application ports within a given domain.
### 5.3.2 Key issue definition
In intra-domain scenarios, it needs to be ensured that newly defined
application port number will not clash with the port numbers that are already
in use (legacy 3GPP applications and also non-3GPP applications), or at least
the solution should specify how to mitigate the problem. In other words, the
solution needs to ensure that a newly introduced application entity that sends
traffic to a certain port will always arrive at the intended application.
The study should also evaluate whether Dynamic/Private Port numbers range
[49152 - 65535] and/or User Port number range [1024-49151] can be used for new
3GPP interfaces.
# 6 Solutions
## 6.1 General
This clause describes potential solutions to address the key issues described
in clause 5. Each clause will describe one solution which may address one or
more key issues.
## 6.2 Solution#1: 3GPP allocating port numbers
### 6.2.1 General
In scenarios, when IANA allocated default port numbers cannot be used, while a
new 3GPP interface application may require a pre-defined specific server port
number, 3GPP becomes responsible for allocating a server port number. Such
port numbers will be assigned from a sub-range of the Dynamic/Private Port
range [49152 - 65535].
NOTE: Clause 4 in IETF RFC 6335 [2] specifies that the term \"assignment\" is
used to refer to the procedure by which IANA provides service names and/or
port numbers to requesting parties and that other RFCs refer to this as
\"allocation\" or \"registration\". IANA does not assign port numbers from
Dynamic/Private Port range [49152 - 65535] and therefore any application
designer is free to use any of these ports at will.
### 6.2.2 Detailed description
#### 6.2.2.1 General
3GPP should document the future port allocations to specific 3GPP interface
applications in an annex to 3GPP TR 29.941 [11].
The proposed solution is based on the following assumptions:
1\. Dynamic/Private Port number range [49152 - 65535] is not restricted by
IANA and may be used by 3GPP or non-3GPP applications without any
restrictions.
2\. Many existing interface applications are dynamically selecting port
numbers from range [49152 - 65535] when populating source port field in
UDP/TCP/SCTP header, e.g. for load balancing. In a request-response type of
communication, the remote peer typically sends the response message to the
port number, which is populating the source port field of the received request
message.
3\. Let\'s assume, 3GPP specifies in Rel-17 or onwards that the port number of
some new application \'X\' is e.g. 50000.
4\. When sending a request message, the new application X will populate the
port numbers as follows:
\- Destination port: e.g. 50000
\- Source port: e.g. 60000
5\. When the application peer sends a response, the new remote application X
will populate the port numbers in a reverse order:
\- Destination port: 60000
\- Source port: 50000
6\. Now, in the network there will be other, legacy interface applications
that were taken into use before application X is specified. Let\'s look into
how the traffic for these applications would be handled.
7\. Application X sends a request to the destination port 50000.
a. If the application X peer receives such legit message, it will correctly
handle the message.
b. If a legacy application receives such message at port 50000, then the
following scenarios should be checked. Note, that legacy application may
expect only a response message at port 50000. If the application does not
listen to port 50000, the message will be discarded. Even if the application
listens to port 50000, it obviously cannot correctly parse the X application
request and therefore an application/protocol specific error handling will be
triggered. The legacy application will discard the message also in this case
and may either log an error or may resend the request. For resending the
request, the sequence numbers in the outstanding request and in the received
erroneous message shall match. The latter case is highly hypothetical, because
it is unlikely the legacy application can correctly extract a sequence number
from the erroneous message, in the first place. Even less likely would be
finding the match.
8\. Legacy application sends a response to the destination port 50000, because
it received a request from this port.
a. If the legacy application peer receives such legit message, it will
correctly handle the message.
b. If an application X receives such message at port 50000, then the following
scenarios should be checked. Note, that application X may expect only a
request message at port 50000. The application X obviously cannot correctly
parse the legacy application request and therefore an application/protocol
specific error handling will be triggered. In order to optimize the error
handling, the application X should be able to detect the legacy application
type. In such case, the message shall be silently discarded. There will be
only a handful of legacy applications running on the given NF, i.e. the NF
will be connected only to a handful of 3GPP interfaces. Therefore, such
additional, but trivial feature will not cause any considerable extra efforts.
The following use case needs to be considered:
\- A legacy application client already runs on a network entity and a new 3GPP
Rel-17 app is initializing;
\- Both apps share the same IP address;
\- The new 3GPP Rel-17 app shall listen to e.g. port 50000 for incoming
requests;
\- There is a small, but non-zero probability that the legacy app has sent a
request to another server and is expecting a response to port 50000;
\- The system will not allow new 3GPP Rel-17 app to run, because port 50000 is
already in use;
\- Implementation needs to find a way to somehow remove port 50000 from the
legacy app usage, which will enable new 3GPP Rel-17 app to start;
\- Once the new 3GPP Rel-17 app is up and running, the system will ensure the
legacy app will always select another port from the dynamic range. No more
clashes will happen on this network entity.
#### 6.2.2.2 Summary of the solution
When a new 3GPP Rel-17 and onwards application requires static server port
number, during initialization the new application shall check if the port is
already in use or not. If the port is in use by another, legacy application,
the new application or operating system shall ensure that the legacy
application stops using the port. It is up to the implementation to decide if
the legacy application will be forced to stop using the port immediately, or
if the legacy application will be granted some period of time for graciously
removing the port from usage.
Any sub-range from [49152 - 65535] range would be good. It is proposed to set
aside the range of 101 ports from 65400 to 65500.
### 6.2.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications, but only in case they require static port. The solution will
have no impact on legacy applications.
### 6.2.4 Pros and cons
Pros:
\- The solution will have no impact on legacy applications.
Cons:
\- If a legacy application client already runs on a network entity and a new
3GPP Rel-17 app is initializing on the same entity while both applications
share the same IP address and port, then the system will not permit the new
app to start (see clause 6.2.2). Implementation will need to find a way to
free up the port in usage by the legacy application client, which will enable
new 3GPP Rel-17 application to start.
## 6.3 Solution#2: Allocating port numbers via OAM
### 6.3.1 General
Each operator becomes responsible for allocating a port number to each new
3GPP application from either the User Port number range [1024-49151] or from
the Dynamic/Private Port range [49152 - 65535].
### 6.3.2 Detailed description
The proposed solution is based on the following assumptions:
1\. An operator determines which port numbers are not used as default ones in
their network (either from the User Port number range [1024-49151] or from the
Dynamic/Private Port range [49152 - 65535]).
2\. The operator selects certain unused port number as a default one for the
new 3GPP interface application and configures all relevant network entities
with OAM.
3\. Many existing interface applications are dynamically selecting port
numbers from range [49152 - 65535] when populating source port field in
UDP/TCP/SCTP header, e.g. for load balancing. In a request-response type of
communication, the remote peer typically sends the response message to the
port number, which is populating the source port field of the received request
message. If the new port number is selected from the Dynamic/Private Port
range [49152 - 65535], then the solution will be similar to the one, which is
described in clause 6.2.2 for Solution#1.
4\. If the new port number is selected from the User Port number range
[1024-49151], then the drawbacks described in the above bullet point 3 will be
eliminated.
The following use case needs to be considered, if Dynamic/Private Port range
[49152 - 65535] is used:
\- A legacy application client already runs on a network entity and a new 3GPP
Rel-17 app is initializing;
\- Both apps share the same IP address;
\- The new 3GPP Rel-17 app shall listen to e.g. port 50000 for incoming
requests;
\- There is a small, but non-zero probability that the legacy app has sent a
request to another server and is expecting a response to port 50000;
\- The system will not allow new 3GPP Rel-17 app to run, because port 50000 is
already in use;
\- OAM needs to find a way to somehow remove port 50000 from the legacy app
usage, which will enable new 3GPP Rel-17 app to start;
\- Once the new 3GPP Rel-17 app is up and running, the system will ensure the
legacy app will always select another port from the dynamic range. No more
clashes will happen on this network entity.
### 6.3.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications, i.e. the solution will have no impact on legacy applications.
### 6.3.4 Pros and cons
Pros:
\- Gives full control and flexibility to operators when selecting default port
numbers for new 3GPP interfaces.
Cons:
\- The new application cannot have hard-coded default port number. That is, it
will learn the default port number after successful configuration action.
\- Makes the default port setting logic more complex in a new application.
\- If a legacy application client already runs on a network entity and a new
3GPP Rel-17 app is initializing on the same entity while both applications
share the same IP address and port, then the system will not permit the new
app to start (see clause 6.2.2). OAM will need to find a way to free up the
port in usage by the legacy application client, which will enable new 3GPP
Rel-17 application to start.
## 6.4 Solution#3: DNS-SD based solution
### 6.4.1 General
The DNS-based Service Discovery (DNS-SD) (see IETF RFC 6763 [6]) allows
clients to discover one or multiple nodes in the network supporting a specific
service, the application protocol and the transport protocol used for
accessing the service, using standard DNS queries sent to a conventional
unicast DNS server available in the network.
In 3GPP networks, any IP-based interface can been considered as a specific
service provided by a node on a given IP address and an IP port number. By
identifying an interface with a unique service name, the DNS-based Service
Discovery (DNS-SD) can be used by clients to discover the IP port number used
by a remote node for a given interface.
In this proposed solution, it is assumed that a conventional unicast DNS
server is available in the network. When a node is activated in the network,
the service application is assigned with any available port from either the
User Port number range [1024-49151] or the Dynamic/Private Port range [49152 -
65535]. The DNS server of the domain needs to be updated with the node\'s DNS
records (configured hostnames, IP addresses, locally assigned port numbers,
service names supported, etc.). This update can be done manually by the
network administrator or done automatically by the node with mechanisms such
as Dynamic DNS (DDNS).
The name of the service supported by a given 3GPP interface is registered to
IANA. It consists of a pair of DNS labels separated by a dot, following the
convention already established for SRV records (IETF RFC 2782 [7]).
\- The first label of the pair is an underscore character followed by an IANA
registered Service Name (IETF RFC 6335 [2]).
\- The second label is either \"_tcp\" (for application protocols that run
over TCP) or \"_udp\" (for application protocols that run over any transport
protocol other than TCP).
Service names are assigned by IANA on a \"first come, first served\" basis, as
described in Clause 8.1 of IETF RFC 6335 [2]. There is no substantive review
of the request, other than to ensure that it is well-formed and doesn\'t
duplicate an existing assignment. The assignment of a standard service name is
therefore straightforward.
For new service names registered by 3GPP, the Service Name will start with
\"3gpp-\", followed by a name identifying the application protocol defined by
3GPP. This name will likely be the acronym used to identify the protocol in
3GPP specifications.
### 6.4.2 Detailed description
The proposed solution is based on the following assumptions:
1- The client is configured with an IANA registered service name \
identifying a specific service and the application protocol used to support
the service.
2- To discover the list of available service instances supporting the service
\ in the domain \, the client performs a DNS-SD PTR lookup
(see IETF RFC 6763 [6] and for PTR type see IETF RFC 1035 [19]) for the name:
\.\
3- The DNS query is sent to the conventional unicast DNS server.
4- The result of the DNS-SD\'s PTR lookup is a set of zero or more PTR records
giving the list of available instances in the form of Service Instance Names:
Service Instance Name = \.\.\
In which the \ portion is a user-friendly name, consisting of
arbitrary Net-Unicode text, as defined in IETF RFC 6763 [6].
When at least one PTR record is present in the DNS response, the following
additional records are included in the DNS response:
\- The SRV record(s) for each Service Instance Name listed in the PTR
record(s), providing the port number and target host name of the Service
Instance Name.
\- All address records (type \"A\" and \"AAAA\") for the target host name
listed in the SRV record(s).
\- The TXT record(s) containing a single zero octet (i.e., a single empty
string.) for each Service Instance Name named in the PTR record(s).
NOTE 1: DNS clients are able of functioning correctly with DNS servers (and
Multicast DNS Responders) that fail to generate these additional records
automatically, by issuing subsequent queries for any further record(s) they
require.
NOTE 2: As described in IETF RFC 6763 [6], TXT record(s) containing a single
zero octet indicate that there is no additional data for the given Service
Instance
5- In the event that more than one SRV is returned, the client shall correctly
interpret the priority and weight fields to select the target node i.e.,:
\- lower-numbered priority instances should be used in preference to higher-
numbered priority instances, and
\- instances with equal priority should be selected randomly in proportion to
their relative weights.
NOTE 3: It is recommended to give the same weight to all the instances with
the same priority.
6- The client can set up connection(s) with the remote node(s) using the IP
address(es) and port number(s) retrieved from the DNS server and then
application data can be exchanged between the client and the server.
### 6.4.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.4.4 Pros and cons
Pros:
\- Port numbers are locally assigned in the node supporting the interface
applications.
\- Limit the need for manual configuration.
\- leveraging on a proven DNS infrastructure and mature technology.
\- the \"_tcp\" and \"_udp\" subdomains can be delegated to a dedicated DNS
server.
Cons:
\- Rely on the availability of a DNS infrastructure.
\- 3GPP nodes need to implement a DNS resolver in order to discover interfaces
supported by other nodes.
\- The discovery mechanism implies additional signalling before setting up the
connection between nodes.
## 6.5 Solution#4: Service discovery using DNS SRV records
### 6.5.1 General
This is an alternative to solution#3 in which there is only one logical
instance of service \ and all clients are expected to use that one
logical instance. Of course, the logical instance can be load-shared across
multiple nodes, but all the nodes provide an equivalent service.
In this proposed solution, to discover the list of available service
instances, the client performs a simple SRV lookup (see IETF RFC 2782 [7])
instead of a PTR lookup in solution#3:
The result of the SRV lookup is SRV record(s) providing the port number and
target host name of the nodes supporting the service. All address records
(type \"A\" and \"AAAA\") for the target host name listed in the SRV record
are also provided.
### 6.5.2 Detailed description
The proposed solution is based on the following assumptions:
1- The client is configured with an IANA registered service name \
identifying a specific service and the application protocol used to support
the service.
2- To discover the list of available service instances supporting the service
\ in the domain \, the client performs a DNS SRV lookup (see
IETF RFC 6763 [6]) for the name:
\.\
3- The DNS query is sent to the conventional unicast DNS server.
4- The result of the DNS SRV lookup is a set of zero or more SRV records
providing the port number and host name of the target nodes supporting the
service. All address records (type \"A\" and \"AAAA\") for the target host
name listed in the SRV record are also provided:
NOTE 1: DNS clients are able of functioning correctly with DNS servers that
fail to generate these additional A/AAAA records automatically, by issuing
subsequent queries for any further record(s) they require.
5- In the event that more than one SRV is returned, the client shall correctly
interpret the priority and weight fields to select the target node i.e.,:
\- lower-numbered priority instances should be used in preference to higher-
numbered priority instances, and
\- instances with equal priority should be selected randomly in proportion to
their relative weights.
NOTE 3: It is recommended to give the same weight to all the instances with
the same priority.
6- The client can set up connection(s) with the remote node(s) using the IP
address(es) and port number(s) retrieved from the DNS server and then
application data can be exchanged between the client and the server.
### 6.5.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.5.4 Pros and cons
Pros:
\- Port numbers are locally assigned in the node supporting the interface
applications.
\- Limit the need for manual configuration.
\- leveraging on a proven DNS infrastructure and mature technology.
\- the \"_tcp\" and \"_udp\" subdomains can be delegated to a dedicated DNS
server.
Cons:
\- Rely on the availability of a DNS infrastructure.
\- 3GPP nodes need to implement a DNS resolver in order to discover interfaces
supported by other nodes.
\- The discovery mechanism implies additional signalling before setting up the
connection between nodes.
## 6.6 Solution#5: Use of multicast address on local link
### 6.6.1 General
This is an alternative to solution#3 and #4 in the absence of DNS server in
the domain.
Multicast DNS (mDNS) (see IETF RFC 6762 [8]) provides the ability to perform
DNS-like operations on the local link in the absence of any conventional
Unicast DNS server. DNS queries are multicasted on a local link and any node
receiving the query responds with a unicast packet directed back to the
querier if it supports the service requested by the querier. The response can
also be multicasted on local link, all the nodes on this local link being
updated at the same time.
Multicast DNS can provide zero-configuration operation -- just connect a DNS-
SD/mDNS device, and its services are advertised on the local link with no
further user interaction.
### 6.6.2 Detailed description
The proposed solution is based on the following assumptions:
1- The client is configured with an IANA registered service name \
identifying a specific service and the application protocol used to support
the service.
2- To discover the list of available service instances supporting the service
\ on the local link, the client performs a DNS PRT lookup
(solution#3, see clause 6.4.2) or SRV lookup (solution#4, see clause 6.5.2)
for the name:
\.local.
3- DNS queries are sent to the mDNS IPv4 link-local multicast address
224.0.0.251 or mDNS IPv6 link-local multicast address FF02::FB, to UDP
destination port 5353 and using as UDP source port either:
\- port 5353 if the client supports a fully compliant mDNS resolver; or
\- a high-numbered ephemeral UDP source port other than port 5353, if the
client supports minimal Multicast DNS resolver
NOTE 1: It is recommended to use the mDNS IPv4 link-local multicast address
only if IPv6 is not not avalaible.
4- A node receiving the mDNS request and supporting the desired service shall
provide in the response its own DNS records as described in clauses 6.4.2
(solution#3) and 6.5.2 (solution#4).
5- The DNS response is either unicast to the source IP address of the DNS
querier or multicast on the local link.
NOTE 2: DNS querier can asked for unicast response by setting the unicast-
response bit, the top bit in the class field of a DNS question.
6- The client can set up connection(s) with the remote node(s) using the IP
address(es) and port number(s) retrieved from the DNS server and then
application data can be exchanged between the client and the server.
### 6.6.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
mDNS implies the support of IP Multicast services in the network. In
particular, on local networks, Internet Group Management Protocol (IGMP) has
to be used on IPv4 networks and Multicast Listener Discovery (MLD) on IPv6
networks, which is a part of ICMPv6.
### 6.6.4 Pros and cons
Pros:
\- Port numbers are locally assigned in the node supporting the interface
applications.
\- Little or no administration or configuration to set the nodes up
\- work when no DNS infrastructure is present
\- can be used also during DNS infrastructure failures
Cons:
_-_ All the nodes have to be on the same logical local network.
\- (Minimal) Multicast DNS resolvers and Multicast DNS responders have to be
implemented in the nodes.
\- Additional traffic with multicast queries and responses.
\- The discovery mechanism implies additional signalling before setting up the
connection between nodes.
## 6.7 Solution#6: Direct unicast DNS queries to the target node
### 6.7.1 General
This is an alternative to solution#5 when there is no DNS server and the
target node can be outside the local link.
In this proposed solution, instead of relying on Multicast DNS queries sent on
the local link, the client sends its DNS query via unicast directly to the
node, using the destination port 5353. The IP address of the target node is
discovered by configuration.
The node receiving the unicast DNS query and supporting the desired service
answers via with a unicast packet directed back to the client, using the
source IP address and port of the received DNS query.
### 6.7.2 Detailed description
The proposed solution is based on the following assumptions:
> 1- The client is configured with:
\- an IANA registered service name \ identifying a specific service
and the application protocol used to support the service;
\- the IP address of the target node.
2- To discover the list of available service instances supporting the service
\ on the local link, the client performs a DNS PRT lookup
(solution#3, see clause 6.4.2) or SRV lookup (solution#4, see clause 6.5.2)
for the name:
\.local.
3- DNS queries are sent to the unicast IP address of the target node
configured in the client, to UDP destination port 5353 and using as UDP source
port either:
\- port 5353 if the client supports a fully compliant mDNS resolver; or
\- a high-numbered ephemeral UDP source port other than port 5353, if the
client supports minimal Multicast DNS resolver
NOTE: It is recommended to use the mDNS IPv4 link-local multicast address only
if IPv6 is not not avalaible.
4- A node receiving the mDNS request and supporting the desired service will
provide in the response its own DNS records as described in clause 6.4.2
(solution#3) and 6.5.2 (solution#4).
5- The DNS response is either unicast to the source IP address of the DNS
querier.
6- The client can set up connection(s) with the remote node(s) using the IP
address(es) and port number(s) retrieved from the DNS server and then
application data can be exchanged between the client and the server.
### 6.7.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.7.4 Pros and cons
Pros:
\- Port numbers are locally assigned in the node supporting the interface
applications.
\- Minimal administration or configuration to set the nodes up
\- work when no DNS infrastructure is present
\- can be used also during DNS infrastructure failures
Cons:
\- (Minimal) Multicast DNS resolvers and Multicast DNS responders have to be
implemented in the nodes.
\- The discovery mechanism implies additional signalling before setting up the
connection between nodes.
\- The signalling between the client and the target node outside the local
link shall be protected with confidentiality, integrity and replay protection,
using for instance IPsec.
## 6.8 Solution#7: SCTP Multiplexer (Port)
### 6.8.1 General
The TCP Port Service Multiplexer (TCPMUX) is defined in IETF RFC 1078 [10].
The specification describes a multiplexing service that may be accessed with a
network protocol to contact any one of a number of available TCP services of a
host on a single, well-known port number.
The same principle is applied to SCTP applications.
An SCTP (IETF RFC 4960 [4]) packet is composed of a common header and chunks.
The SCTP common header contains:
\- The SCTP Source Port Number that can be used by the receiver in combination
with the source IP address, the SCTP destination port, and possibly the
destination IP address to identify the association to which this packet
belongs.
\- The SCTP Destination Port Number that can be used by the receiving host to
de-multiplex the SCTP packet to the correct receiving endpoint/application.
A SCTP chunk represents a protocol message, which can be used by the protocol
itself or can contain user data. User data are contained in DATA chunks that
include a Payload Protocol Identifier. The Payload Protocol Identifier is used
to identify the application which uses the services of SCTP.
As it is contained in each DATA chunk, the Payload Protocol Identifier
identifies the protocol being carried over SCTP independently of the port
numbers being used. The Payload Protocol Identifier can be used therefore to
de-multiplex the SCTP packet to the correct receiving endpoint/application
above SCTP instead of the SCTP Destination Port Number.
The proposed solution based on the Payload Protocol Identifier parsing would
then allow to contact multiple applications on a single well-known STCP port
using the SCTP Payload Protocol Identifier instead of requesting IANA for
allocation of a new well-known SCTP number each time a new application is
defined.
The SCTP multiplexer is implemented as a stand-alone process above the SCTP
layer, listening at the well-known SCTP port, used to initiate and manage
associations with remote SCTP endpoints and distribute received SCTP messages
to upper-layer applications based on the Payload Protocol Identifier. From the
SCTP layer, the SCTP multiplexer is seen as a regular SCTP user. There is no
impact on the SCTP stack.
The well-known port can be:
\- The port already allocated for TCPMUX (port 1);
\- A port already allocated for another SCTP application defined by 3GPP;
\- A new port dedicated to SCTP multiplexing allocated in a port range locally
administrated by 3GPP.
\- A new port dedicated to SCTP multiplexing allocated by IANA.
In the figure below, a single SCTP host is supporting 4 new applications in
addition of an existing W1 application. The port number used to identify the
multiplexer is 47002 (given only as possible unassigned User Port that can be
used).
Figure 6.8.1-1: SCTP server-side illustration for SCTP Multiplexer (port)
When DTLS over SCTP, as described in IETF RFC 6083 [x], is used to provide
mutual authentication, integrity protection, replay protection and
confidentiality protection, only SCTP user data are integrity protected and
encrypted using DTLS. The Payload Data (DATA) header, in which the SCTP
Payload Protocol Identifier is indicated, is therefore sent as clear text. The
SCTP Multiplexer can still use the SCTP Payload Protocol Identifier to
distribute SCTP messages to upper-layer applications. Moreover, the SCTP
associations being managed by the SCTP Multiplexer and the DTLS connections
being handled by the applications (identified by the SCTP Payload Protocol
Identifier) above the SCTP Multiplexer, it is possible to have multiple DTLS
connections over a the same SCTP association, one DTLS connection per
application (or per SCTP Payload Protocol Identifier).
In the figure below, a single SCTP host is supporting 4 new applications in
addition of an existing W1 application. The port number used to identify the
multiplexer is 47002 (given only as possible unassigned User Port that can be
used). DTLS over SCTP is used to provide communications privacy for
applications above the SCTP Multiplexer.
Figure 6.8.1-2: SCTP server-side illustration for SCTP Multiplexer (port) with
used of DTLS over SCTP
### 6.8.2 Detailed description
The proposed solution is based on the following assumptions:
The server implements an SCTP multiplexer that can serve multiple applications
on a single well-known STCP port.
The client is configured with the IP address of the server to contact and use
the well-known STCP port associated to the SCTP multiplexer.
1- The client sends an INIT signal to the SCTP multiplexer on the dedicated
port to initiate an association.
2- On receipt of the INIT signal, the SCTP multiplexer sends an INIT-ACK
response to the client. This INIT-ACK signal contains a state cookie.
3- On receipt of this INIT-ACK signal, the client sends a COOKIE-ECHO
response, which just echoes the state cookie.
4- After verifying the authenticity of the state cookie, the SCTP multiplexer
then allocates the resources for the association, sends a COOKIE-ACK response
acknowledging the COOKIE-ECHO signal, and the association is said ESTABLISHED.
5- The client can send to the SCTP multiplexer user data encapsulated within
SCTP DATA chunks, each DATA chunk including a Payload Protocol Identifier
identifying the requested application.
6- The SCTP multiplexer checks the Payload Protocol Identifier.
a- If the Payload Protocol Identifier is supported i.e., there is an internal
process that supports the requested application, the SCTP multiplexer delivers
the user data to the correct receiving application. The reception of the DATA
chunk is then acknowledged by a SACK chunks and protocol data exchange between
the client and the application behind the SCTP multiplexer can continue.
b- If the Payload Identifier is not supported i.e., there is no internal
process that supports the requested application, the SCTP multiplexer will
abort the created SCTP association, sending an ABORT chunk to the client that
contains a User-Initiated Abort cause code (12). A specific Upper Layer Abort
Reason (e.g. \"Unsupported Payload Protocol Identifier\") can also be included
and be delivered to the upper-layer protocol at the peer.
### 6.8.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
If an SCTP port assigned to an existing SCTP application defined by 3GPP is
reused as SCTP multiplexer, existing implementation relying on this SCTP port
will not be impacted. New SCTP clients relying on the SCTP multiplexing will
only be in contact with endpoints supporting this functionality by
configuration.
### 6.8.4 Pros and cons
Pros:
\- Multiple SCTP applications can be run on the same port.
\- Minimal administration or configuration to set the nodes up.
\- Does not rely on DNS infrastructure.
Cons:
\- An SCTP multiplexer process needs to be implemented in servers.
\- Only applicable to protocols carried over SCTP.
\- Need for IANA port number allocation if the one assigned to TCPMUX is not
reused.
\- Need for a 3GPP-managed port allocation if the port used for SCTP
multiplexer is neither the one for TCPMUX nor one allocated by IANA.
\- Not possible to use the port number to distinguish SCTP applications.
## 6.9 Solution#8: SCTP Multiplexer Application
### 6.9.1 General
This is an alternative to the solution#7.
A new SCTP application (see IETF RFC 4960 [4]) is specified by 3GPP and a new
well-known SCTP port is allocated by IANA for this SCTP application. As an
alternative, the SCTP port for this new application could be managed by 3GPP.
This SCTP application is used to:
\- Advertise the list of SCTP application required by a client
\- Retrieve the list of SCTP application supported by a server
\- Multiplex and de-multiplex SCTP applications over a single well-known port
The following SCTP messages are defined:
\- Required Payload Protocol ID list: This DATA chunk provides the SCTP
application identifier required by the client.
\- Supported Payload Protocol ID list: This DATA chunk indicates if the
required SCTP application identifier is supported and may provide the list of
SCTP application identifiers supported by the server.
The messages above are used to negotiation the SCTP application that can be
used between peers over SCTP.
If there is at least one application supported by both the client and the
server, the SCTP peers can exchange user data related to the supported
application(s).
If there is no application in common, the SCTP association is aborted.
The SCTP Multiplexer Application is seen as a regular SCTP user by the SCTP
user. There is no impact on the SCTP stack.
In the figure below, a single SCTP host is supporting the new SCTP Multiplexer
Application of an existing W1 application. The SCTP Multiplexer Application
supports 4 different applications. The port number used to identify the SCTP
Multiplexer Application is 47002 (given only as possible unassigned User Port
that can be used).
Figure 6.9.1-1: SCTP server-side illustration for SCTP Multiplexer Application
### 6.9.2 Detailed description
The proposed solution is based on the following assumptions:
The server implements an SCTP multiplexer application that can serve multiple
applications on a single well-known STCP port (allocated by IANA or managed by
3GPP).
The client is configured with the IP address of the server to contact and use
the well-known STCP port associated to the SCTP multiplexer application to set
up the SCTP association.
1- The client sends an INIT signal to the SCTP server to initiate an
association on the well-known STCP port associated to the SCTP multiplexer
application.
2- On receipt of the INIT signal, the SCTP server sends an INIT-ACK response
to the client. This INIT-ACK signal contains a state cookie.
3- On receipt of this INIT-ACK signal, the client sends a COOKIE-ECHO
response, which just echoes the state cookie.
4- After verifying the authenticity of the state cookie, the SCTP server then
allocates the resources for the association, sends a COOKIE-ACK response
acknowledging the COOKIE-ECHO signal, and the association is said ESTABLISHED.
5- The client sends send the \"Required Payload Protocol ID list\" message to
the SCTP server to indicate the SCTP application that it would like to carry
over this SCTP association.
6- The SCTP server checks the requested Payload Protocol Identifier.
a- If there is the Payload Protocol Identifier is supported i.e., there is an
internal process that supports the requested application, the SCTP server
answers with a \"Supported Payload Protocol ID list\" message, including a
Cause value \"Success\". The full list of supported Payload Protocol
Identifiers may also be provided, for future use. After reception, the client
can send DATA chunks to the SCTP server, each DATA chunk including the Payload
Protocol Identifier of negotiated SCTP application. User data are delivered to
the correct application according to the Payload Protocol Identifier.
b- If the Payload Identifier is not supported i.e., there is no internal
process that supports the requested application, the SCTP server answers with
a \"Supported Payload Protocol ID list\" message, including a Cause value
\"Failure\" and an ABORT chunk to close the association. The ABORT chunk may
contain a User-Initiated Abort cause code (12) and a specific Upper Layer
Abort Reason (e.g. \"Unsupported Payload Protocol Identifier\").
### 6.9.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.9.4 Pros and cons
Pros:
\- Multiple SCTP applications can be run on the same port.
\- The SCTP multiplexing is done a dedicated port.
\- The SCTP multiplexing functionality is supported by a dedicated application
above SCTP, transparent to the SCTP layer.
\- Minimal administration or configuration to set the nodes up.
\- Does not rely on DNS infrastructure.
Cons:
\- An SCTP multiplexer process needs to be implemented in servers.
\- Only applicable to protocols carried over SCTP.
\- Need for IANA port number allocation for the new SCTP application if the
use of a 3GPP-managed port is not applicable.
## 6.10 Solution#9: TCP Port Service Multiplexer (TCPMUX)
### 6.10.1 General
The TCP Port Service Multiplexer (TCPMUX) is defined in IETF RFC 1078 [10].
The specification describes a multiplexing service that may be accessed with a
network protocol to contact any one of a number of available TCP services of a
host on a single, well-known port number.
The specification of TCPMUX, IETF RFC 1078 [10], was deprecated in 2016 by
IETF RFC 7805 [12] mainly because there were very limited deployments, all of
them none in an Internet context. However, as it is a solution that would be
used in a private (3GPP) networks, it is a solution that can be considered
when developing new TCP-based protocols.
### 6.10.2 Detailed description
The detailed description of the use of TCPMUX is provided in IETF RFC 1078
[10].
A TCP client connects to a foreign host on TCP port 1. It sends the service
name followed by a carriage-return line-feed \.
The server replies with a single character indicating positive (\"+\") or
negative (\"-\") acknowledgment, immediately followed by an optional message
of explanation, terminated with a \.
If the reply was positive, the selected protocol begins; otherwise the
connection is closed.
The names listed in the \"Service Name and Transport Protocol Port Number
Registry\" https://www.iana.org/assignments/service-names-port-
numbers/service-names-port-numbers.xhtml are reserved to have exactly the
definitions specified there. Services with distinct assigned ports must be
available on those ports and may optionally be available via this port service
multiplexer on port 1.
Private protocols can use a service name that has a high chance of being
unique. A good practice is to prefix the protocol name with the name of your
organization.
The service name \"HELP\" can be sent to the client to remote host. If
received, the server will output a multi-line message and then close the
connection. The reply to the name \"HELP\" must be a list of the service names
of the supported services, one name per line.
### 6.10.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.10.4 Pros and cons
Pros:
\- Multiple TCP applications can be run on the same port.
\- Minimal administration or configuration to set the nodes up.
\- Does not rely on DNS infrastructure.
Cons:
\- A TCP multiplexer process needs to be implemented in servers.
\- Only applicable to protocols carried over TCP.
\- Usage of the TCPMUX port has been deprecated
## 6.11 Solution#10: Standardized and common port for all new SCTP based
interfaces with a standardized Payload Protocol Identifier for each interface
### 6.11.1 General
This is an alternative solution proposed specifically for SCTP interfaces.
The proposal is to use a standardized and common SCTP port number for all new
interfaces, with a standardized SCTP Payload Protocol Identifier (assigned by
IANA), as defined in clause 14.4 of IETF RFC 4960 [4], for every new
interface. The SCTP port number can be chosen by any of the below
alternatives:
\- IANA assigning the port number from the User Port number range
[1024-49151].
\- 3GPP allocating the port number from the Dynamic/Private Port number range
[49152 - 65535].
When there are multiple applications running on a single node, that are using
the same common SCTP port number, the proposal is to use unique IP address(es)
for each application, so that the SCTP traffic will be delivered to the
applications identified by the IP address(es). Using a standardized Payload
Protocol Identifier additionally helps to uniquely identify the traffic at the
application level (e.g. in protocol analyser tools) and addresses the
requirement in clause 4.2 of this TR.
### 6.11.2 Detailed description
From an interface/application end point perspective, each
interface/application can be distinguished by the individual SCTP Payload
Protocol Identifier. Which means any new interface/application defined by 3GPP
shall be able listen to a pre-defined common port number for creating the SCTP
association, while still allowing to identify the interface/application based
on the SCTP Payload Protocol Identifier value.
When multiple interfaces/applications are needed to be supported on a single
node, separate IP addresses shall be used for creating separate SCTP
associations for each interface/application. This allows
interfaces/applications running on a single node to avoid sharing the SCTP
association and thereby also avoid the need for an additional
multiplexer/demultiplexer layer to distribute the SCTP traffic to the correct
application.
The SCTP port number can be allocated by 3GPP from the Dynamic/Private Port
number range [49152-65535]. However, the Dynamic/Private Port number range is
not restricted by IANA and may be used by other applications also, thereby
making it an operators\' responsibility to configure the network in a way to
avoid any other application port clashing with this port.
The second alternative (recommended) for the port number allocation is to get
a new port number from the User Port number range [1024-49151] assigned by
IANA that can be used for all new SCTP based interfaces/applications to be
defined by the 3GPP.
For defining a new SCTP interface/application, 3GPP shall request IANA for
assignment of a Payload Protocol Identifier value that shall be used by SCTP
for the application layer protocol. The common SCTP port number and the
interface/application specific SCTP Payload Protocol Identifier value shall be
used for all deployment configurations of the interface/application.
### 6.11.3 Impacts
The solution impacts only newly defined SCTP interfaces (Rel-17 and onwards).
3GPP shall get a new port assigned from IANA (for one last time) to be used as
a common well-known port for all newly defined 3GPP interfaces/applications.
When defining a new SCTP based interface/application, 3GPP shall request IANA
for assignment of a new SCTP Payload Protocol Identifier value.
The solution does not have any impact on legacy applications/interfaces.
### 6.11.4 Pros and cons
Pros:
\- Only 73 out of 4294967295 PPI values are currently assigned by IANA. The
Payload Protocol Identifier assignment is based on the \"First Come First
Served\" policy. Assignments are made to anyone on a first come, first served
basis. There is no substantive review of the request, other than to ensure
that the PPI is well-formatted and doesn\'t duplicate an existing assignment.
So, there is no restriction is assigning a standardized PPI for every new 3GPP
application. In the past 3GPP has reserved many Payload Protocol Identifier
values from IANA e.g. for interfaces/applications like NGAP, XnAP, F1AP and
E1AP etc. Most recently O-RAN alliance has also reserved 3 Payload Protocol
Identifier values (70, 71 & 72) for E2 interface [5].
\- All 3GPP interfaces/applications can use a well-known port number, instead
of a dynamically assigned port number. Using a well-known/standardized port is
the simplest approach we could provide from an operation and implementation
point, as there is no product impact (e.g. no need to support DNS based
solutions) and also there is no operational overhead of configuring port
numbers.
\- Using a standardized Payload Protocol Identifier value for a new SCTP based
interface will also address the requirements defined in clause 4.2 to ensure
that either the port or the Payload Protocol Identifier value is standardized.
\- No dependency on IANA for port allocation for any new 3GPP
interface/application definition, except for getting a new port assigned for
one last time that shall be used for all new 3GPP interfaces/applications.
Cons:
\- Many operators currently use a single pair of IP address(es) for all SCTP
applications (e.g. X2, Xn, Ng) as each application uses unique port numbers.
With this solution the operators will now need unique IP address (or a unique
pair of IP addresses if SCTP multi-homing is used) for each application.
## 6.12 Solution#11: Form a work group to look at port number requirements
from 3GPP and work towards relaxing the IETF port allocation policies
### 6.12.1 General
It is proposed to form a work group with representatives from telecom industry
(ITU-T, 3GPP, ETSI, TTC, ATIS, etc.) and IETF/IANA to discuss further the port
number allocation requirements from telecom network and agree on allocating
some minimum number of ports every year (or for every generation of mobile
technology) or draft an RFC to relax the rules and policies for IANA port
allocation, so that 3GPP can continue using a standardized port for newly
defined applications/interfaces.
### 6.12.2 Detailed description
According to the data collected on January 2020 from IANA, the current
estimation of usage in the allocated zone [0-49151] is about 26%.
Figure 6.12.2-1: Usage by port number range in the allocated zone (in blocks
of 1000)
Figure 6.12.2-2: Yearly trend of port numbers assignment done by IANA
Figure 6.12.2-1 above shows a graph (from the data collected in January 2020),
with the usage of port numbers in various ranges (blocks of 1000) that are
assigned by IANA from the System Ports [0-1023] and User Ports [1024-49151]
ranges. Figure 6.12.2-2 shows the yearly trend of amount of port numbers
assigned by IANA since the year 2001 until 2019. Clearly, most of these
allocations are very old, falling under the lower end of the range (less than
9999) and are essentially allocated for private usage. Many of the higher
blocks are almost empty and the annual allocation rate is also very low, which
means the possibility of a port number exhaustion is quite far off in the
future.
The 3GPP typically requires somewhere in the range of 10-20 new port numbers
per generation of mobile communication network technology. Considering that
one generation of mobile communication technology spans about a decade, this
brings us to a requirement of roughly 1-2 new ports per year on an average.
Considering this, the decision from IANA to NOT allocate any new port numbers
to 3GPP seems quite restrictive and overly conservative. One possible way to
continue allocating port numbers through IANA for new 3GPP defined interfaces
would be e.g. to draft an IETF RFC to relax/change the rules and policies
documented in BPC 165 (RFC6335 [2] and RFC7605 [3]). While 3GPP continues to
study alternatives for port number allocation, it is proposed to also consider
forming a work group with representatives from telecom industry (ITU-T, 3GPP,
ETSI, TTC, ATIS, etc.) and IETF/IANA to look into the various port number
allocation requirements from telecom networks and try to reach a common ground
that is acceptable and in the best of the interests of both parties, for
example:
\- agree on allocating some minimum number of ports every year (or for every
generation of mobile technology) so that 3GPP can continue using a
standardized port for newly defined applications/interfaces;
\- agree on reserving a range of port numbers (consisting of \~100 ports) from
the User Ports [1024-49151] for 3GPP use;
\- Work on an RFC to relax/change the rules and policies documented in BPC 165
to simplify the process of port number assignment by IANA for new 3GPP defined
interface/applications.
### 6.12.3 Impacts
No impact on applications/interfaces. 3GPP can continue using standardized
port numbers for new applications/interfaces.
### 6.12.4 Pros and Cons
Pros:
\- No impact on applications. 3GPP can continue using standardized port
numbers for new applications/interfaces.
Cons:
\- The solution requires IETF to agree on allocating a sub-range to 3GPP or
agree on allocating some port numbers for every generation of mobile
technology or agree on the new IETF RFC submitted by 3GPP.
\- It is unlikely the solution can reach its objectives within the agreed
timeframe for this study. Therefore, finding common ground with IETF/IANA
should be pursued as an independent activity.
## 6.13 Solution#12: Port Registration and Retrieval via NRF
### 6.13.1 General
This is an alternative solution which allows port information registration to
the NRF and port information retrieval from the NRF. This solution is
applicable for those NFs have entry in the NRF and provide specific protocols
for non-SBI interfaces.
This solution is mostly used to register port numbers for 3GPP interface
applications whose port numbers are not allocated by IANA. It is recommended
that the port number for 3GPP interface applications should be allocated from
User Port number range [1024-49151] or from Dynamic/Private Port range [49152
- 65535].
To avoid potential port clash, an operator shall investigate the port numbers
used by existing interfaces/applications hosted by an NF before deploying that
NF, and thus determine one port number to be used and registered. Other
mechanisms to detect and remove the port clash (e.g. described in clause
6.2/6.3) may also be used if necessary.
### 6.13.2 Detailed description
Normally, same port number is allocated to a group of NFs hosting the same
protocol. However, different port numbers may be allocated for same protocol
per NF Types, NF Sets, or even per NF instance.
To configure port numbers in the NRF, a data type of PortInfo is defined to
carry a list of port record, and each port record indicates the port number
and related protocol type. A PortInfo is included in the NF Profile to
register the protocol and associated port numbers used by the NF. One PortInfo
instance can be shared by multiple NFs which have the same NF type or belong
to same NF Set. If one NF needs to be configured with different port number
than other NFs using the same protocol, the NF can be configured with its own
PortInfo.
Requesting NF thus can use the NF Discovery service to retrieve the port
number of a specific protocol, by indicating the protocol type. Other
parameters such as NF type, NF Set ID, or NF Instance ID may also be provided
as discovery parameter.
### 6.13.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.13.4 Pros and cons
Pros:
\- Reuse NRF mechanism for port configuration and retrieval.
\- Port number for a protocol can be configured at granularity of NF type, NF
Set, or individual NF instance.
Cons:
\- This solution relies on NRF mechanism, and is more applicable to non-SBI
interfaces hosted by core network NFs.
\- If this solution is used for RAN interfaces, the RAN node may need to
support SBI interface to a localized NRF.
\- The use cases for the NRF based solution will be reduced to non-roaming
core network interfaces.
## 6.14 Solution#13: Port information retrieval directly from an NF
### 6.14.1 General
This is an alternative solution which allows a requesting NF retrieves port
information directly from an NF acting as the server of a specific protocol.
An NF knows the protocol and port number used for communication, thus it can
directly expose the port number to other NFs initiating communication towards
it, e.g. by a simple HTTP service. As vendors normally implement an internal
web server in an NF e.g. for configuration, such mechanism can reduce the port
number configuration to a central server such as DNS server.
This solution is mostly used to configure port numbers for 3GPP interface
applications whose port numbers are not allocated by IANA. It is recommended
that the port number for 3GPP interface applications should be allocated from
User Port number range [1024-49151] or from Dynamic/Private Port range [49152
- 65535].
To avoid potential port clash, an operator shall investigate the port numbers
used by existing interfaces/applications hosted by an NF before deploying that
NF, and thus determine one port number to be used and configured. Other
mechanisms to detect and remove the port clash (e.g. described in clause
6.2/6.3) may also be used if necessary.
### 6.14.2 Detailed description
The proposed solution is based on the following assumptions:
1) An NF acting as the server of a specific protocol is configured with the
port number it shall listen to. A simple internal web server is integrated in
the NF to expose HTTP service for port information retrieval. A well-known URI
structure can be defined for port information exposure, e.g. http://{ip-of-
target-nf}/PortInfo.
2) To discover the port number of a specific protocol used by the target NF,
the requesting NF sends HTTP GET request to the URI representing the port
information exposure service, carrying the query parameter indicating the
protocol type. For example:
> http://{ip-of-target-nf}/PortInfo?protocol-type={protocol-type}
>
> Upon receiving the HTTP GET request, the message receiving NF (i.e. target
> NF) shall return the port information of the indicated protocol, which may
> be present in a record of \.
3) The requesting NF may directly send HTTP GET to the URI representing the
port information retrieval service, without any query parameter. In such case,
the message receiving NF (i.e. target NF) shall return a list of records
containing all supported protocols and the associated port numbers.
### 6.14.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.14.4 Pros and cons
Pros:
\- A requesting NF can directly retrieve port number from the target NF acting
as message server utilizing a specific protocol.
Cons:
\- An NF has to implement integrated HTTP service to expose the protocol
information (e.g. protocol type, associated port number).
## 6.15 Solution#14: application-layer protocol negotiation over (D)TLS
### 6.15.1 General
The IETF RFC 7301 [15] specifies an extension to Transport Layer Security
(TLS, see IETF RFC 8446 [16]) for application-layer protocol negotiation
within the TLS handshake when multiple application protocols can be supported
on a single server-side port number, such as port 443 for HTTPS. This relies
on the application-layer protocol negotiation (ALPN) labels exchanged between
the client and the server to select the application protocol to be used over
the secure connection. The application protocol negotiation can thus be
accomplished within the TLS handshake, without additional network round-trips,
and allows the server to associate a different certificate with each
application protocol, if desired.
Reusing the same handshake messages and flows as TLS, this application-layer
protocol negotiation is intrinsically supported in DTLS.
With ALPN, a new extension type \"application_layer_protocol_negotiation(16)\"
is defined that can be used in TLS Client/Server Hello message. The
\"extension_data\" field of ALPN extension contains a \"ProtocolNameList\"
value, the ALPN protocol IDs being byte strings that could be the UTF-8
encoding of the protocol name.
In the TLS ClientHello message sent to the server, the \"ProtocolNameList\"
value provides the list of ALPN protocol IDs advertised by the client, in
descending order of preference. This list can be limited to one preferred
protocol when initiated the (D)TLS connection.
In the TLS ServerHello message sent back to the client, the
\"ProtocolNameList\" value indicates the ALPN protocol ID selected by the
server. If the server does not support any of the protocols advertised by the
client the server responds respond with a \"no_application_protocol\" alert
that aborts the handshake.
ALPN protocol IDs can be registered through IANA under the \"Expert Review\"
policy as defined in IETF RFC 8126 [9]. A reference to a permanent and readily
available specification is requested but this documentation does not have to
be an IETF RFC and could be a specification provided by an external
organization.
If the protocol is only used inside a given organization, global
interoperability is not required and there is no need for IANA-registered ALPN
protocol IDs. Private ALPN protocol IDs can be created by the organization. It
is only required that the servers and clients are correctly configured to
ensure that any ALPN protocol ID advertised by clients is part of the ALPN
policy maintained by the servers.
With ALPN, it is assumed that multiple application protocols are supported on
a single server-side port number. A specific port can be used as a protocol
demultiplexer for multiple application protocols. A typical use case would be
to allow serving multiple non-HTTP based services on port 443 while still
serving HTTPS on that port. If required, another port can be selected to
support application protocol multiplexing over (D)TLS. This port can be fixed
for the entire system, selected par application type, specific per node, etc.
This solution can used in addition to the solution#16.
### 6.15.2 Detailed description
The proposed solution is based on the following assumptions:
1- The client is configured with a single ALPN protocol ID to be used for the
application X (e.g. \"ALPNx\"). The IP address of the server supporting the
application X is either configured in the client or discovered using DNS. The
destination port is by default the port 443.
2- The server is configured to listen to port 443 and the ALPN policy is
configured with the value \"ALPNx\". It may also accept traffic related to
other application if need.
3- The client initiates the TLS handshake with the server on the port 443,
including the ALPN protocol ID \"ALPNx\" in the TLS ClientHello message sent
to the server.
4- In the TLS ServerHello message sent back to the client, the server
indicates the ALPN protocol ID \"ALPNx\" to confirmed that the application X
is supported.
5- The TLS handshake is completed, the connection is established and the first
application data can be exchanged between the client and the server
### 6.15.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.15.4 Pros and cons
Pros:
\- Multiple applications can be run on the same port.
\- Minimal administration or configuration to set the nodes up.
\- Does not rely on DNS infrastructure.
Cons:
\- Only works for protocols/applications running over (D)TLS.
\- An ALPN multiplexer process needs to be implemented in servers.
\- Need for IANA registration if standard ALPN protocol IDs are required
\- Not possible to use the port number to distinguish multiple applications
used over (D)TLS.
## 6.16 Solution#15: Multiplexing based on Service Name Indication
### 6.16.1 General
The IETF RFC 6066 [18] specifies an extension to Transport Layer Security
(TLS, see IETF RFC 8446 [16]) for server name negotiation within the TLS
handshake when multiple servers run on the same IP address/port number.
Reusing the same handshake messages and flows as TLS, this server name
negotiation is intrinsically supported in DTLS.
The clients can include an extension of type \"server_name\" in the TLS
ClientHello message sent to the server. The \"extension_data\" field of this
extension contains \"ServerNameList\" that includes the fully qualified DNS
hostname of the server that the client would like to contact.
NOTE 1: Currently, the only server name types supported are DNS hostnames;
however, this does not imply any dependency of TLS on DNS.
NOTE 2: The notion of list given by \"ServerNameList\" is due to the fact that
earlier versions of the RFC permitted multiple hostnames. Multiple hostnames
are now prohibited
Initially developed to guide in the selection of the appropriate certificate
to return to the client (and/or other aspects of security policy) when
multiple web servers are supported on the same IP address, this mechanism also
allows multiplexing incoming connections by inspecting the SNI extension data
and appropriately forwarding the connection to the appropriate upstream
server. And this multiplexing can be done for any protocol running on top of
(D)TLS.
With SNI, it is assumed that multiple servers/applications can be reached
using a single server-side port number. A typical use case would be to allow
hosting multiple non-HTTP based services on port 443 while still serving HTTPS
on that port. If required, another port can be selected and this port can be
fixed for the entire system, selected par application type, specific per node,
etc.
This solution can used in addition to the solution#14.
### 6.16.2 Detailed description
The proposed solution is based on the following assumptions:
1- The client is configured with the hostname of the server to contact for a
specific application X e.g. \"applicationx.3gppnetwork.org\". The IP address
of the server supporting the application X is either configured in the client
or discovered using DNS. The destination port is by default the port 443.
2- The server is configured to be able to compare the server name in the SNI
received from the client to the allowed host names configured in the local
traffic policy and decide which requests to allow. Incoming traffic is
listened to to port 443.
3- The client initiates the TLS handshake with the server on the port 443,
including the SNI \"applicationx.3gppnetwork.org\" in the TLS ClientHello
message sent to the server.
4- If the hostname is allowed, the server selects the appropriate TLS
certificate and completes the TLS handshake.
5- The connection is established and the first application data can be
exchanged between the client and the server.
### 6.16.3 Impacts
The solution will impact only newly defined (Rel-17 and onwards) interface
applications. The solution will have no impact on legacy applications.
### 6.16.4 Pros and cons
Pros:
\- Multiple applications can be run on the same port.
\- Minimal administration or configuration to set the nodes up.
\- Does not rely on DNS infrastructure.
\- No need for any IANA assignment procedure
Cons:
\- Only works for protocols/applications running over (D)TLS.
\- An SNI multiplexer process needs to be implemented in servers.
\- Not possible to use the port number to distinguish multiple applications
used over (D)TLS.
# 7 Comparison, Evaluations and Conclusions
## 7.1 General
This clause evaluates the potential solutions described in clause 6 and
provides conclusions. Each clause will evaluate the solutions for one key
issue, and concludes on the solution for that key issue.
Some of the proposed solutions may address only one key issue, while some may
address more than one key issues. The evaluation and conclusion is further
grouped by each key issues in the following clauses. For conclusion all the
solutions that are addressing a particular key issue are compared based on the
pros and cons documented in each solution.
NOTE: It may be possible that a 3GPP working group specifies a new intra-
domain interface/application, the scope of which may be further extended to
inter-domain interface. While defining a new interface/application 3GPP WGs
shall take extra care to study if there is such possibility of extending the
scope of an interface from intra-domain to inter-domain, and based on that
select the relevant solution from this TR in order to avoid any issues due to
such scope extension.
## 7.2 Evaluation of Solutions for Key Issue #1 (inter-PLMN or inter-domain)
and Conclusions
### 7.2.1 Evaluation
Key Issue #1 addresses inter-domain scenarios.
### 7.2.2 Conclusions for Key Issue #1 solutions (inter-domain)
The inter-domain scenarios cover the below interfaces:
\- Roaming interfaces
\- Any Inter PLMN interface
\- RAN to CN interfaces, as for supporting RAN sharing use cases (single RAN
shared by multiple PLMN\'s CN), the RAN to CN interface also falls into the
category of inter-domain scenario.
Server port type requirements may wary across the spectrum of 3GPP interface
applications, which cross operator domain boundaries. Some of these
applications may utilize dynamic port allocation and discovery, while others
will require static port allocation.
Table 7.4â€‘1 summarizes all the conclusions in the TR 29.835 with additional
comments on each solution.
## 7.3 Evaluation of Solutions for Key Issue #2 (Intra-PLMN or Intra-domain)
and Conclusions
### 7.3.1 Evaluation
#### 7.3.1.1 Solutions Overview
There are different solutions proposed for addressing Key Issue #2. The
solutions can be largely grouped into following categories:
\- 3GPP Standardizes port number from dynamic/private range [49152 - 65535].
\- OAM based port allocation, by operator
\- DNS based resolution of port number
\- Multiplexer based solution
\- Standardized SCTP PPID without Multiplexer
\- Form work group with members from telecom industry (ITU-T, 3GPP, ETSI, TTC,
ATIS, etc.) and IETF/IANA to look into the port number requirement
\- HTTP(s) web server query for port discovery
Table 7.3.1.1-1: Summary of solutions
+--------------+----------------+----------------+----------------+ | Solution | Overview | Type/category | Transport | | | | | protocol(s) | | | | | supported | +==============+================+================+================+ | Solution#1 | Proposes to | 3GPP | UDP, TCP, SCTP | | | standardize | Standardize | | | | port number | port number | | | | for new | from dynamic | | | | interfa | range. | | | | ce/application | | | | | from a | | | | | sub-range | | | | | reserved by | | | | | 3GPP from the | | | | | d | | | | | ynamic/private | | | | | port number | | | | | range [49152 | | | | | - 65535]. | | | | | | | | | | IANA does not | | | | | assign any | | | | | port number | | | | | from the | | | | | d | | | | | ynamic/private | | | | | range [49152 | | | | | - 65535]. | | | | | 3GPP | | | | | reserving | | | | | /standardizing | | | | | port number | | | | | from | | | | | d | | | | | ynamic/private | | | | | range [49152 | | | | | - 65535] may | | | | | cause port | | | | | number clash | | | | | during | | | | | deployment. | | | +--------------+----------------+----------------+----------------+ | Solution#2 | Proposes to | OAM based port | UDP, TCP, SCTP | | | use OAM based | allocation | | | | approach for | | | | | allocating | | | | | port numbers | | | | | for an | | | | | interfac | | | | | e/application. | | | | | The operator | | | | | becomes | | | | | responsible | | | | | for allocating | | | | | the port | | | | | number for an | | | | | interfa | | | | | ce/application | | | | | in a | | | | | deployment, | | | | | from either | | | | | User range | | | | | [1024-49151] | | | | | or from the | | | | | D | | | | | ynamic/Private | | | | | range [49152 | | | | | - 65535] and | | | | | also takes | | | | | necessary | | | | | measures to | | | | | avoid port | | | | | number clash. | | | +--------------+----------------+----------------+----------------+ | Solution#3 | The port | DNS | UDP, TCP, SCTP | | | number can be | infras | | | | selected | tructure-based | | | | dynam | solution. | | | | ically/locally | | | | | by the | | | | | interfa | | | | | ce/application | | | | | node. A DNS | | | | | server is | | | | | available in | | | | | the deployment | | | | | and is updated | | | | | with the | | | | | records like | | | | | hostnames, IP | | | | | addresses, | | | | | locally | | | | | assigned port | | | | | numbers, | | | | | service names | | | | | supported, | | | | | etc. for | | | | | application | | | | | clients to | | | | | discover using | | | | | DNS PTR query | | | +--------------+----------------+----------------+----------------+ | Solution#4 | This is an | | UDP, TCP, SCTP | | | alternative to | | | | | solution#3 in | | | | | which there is | | | | | only one | | | | | logical | | | | | instance of | | | | | service | | | | | \ | | | | | and all | | | | | clients are | | | | | expected to | | | | | use that one | | | | | logical | | | | | instance. | | | | | Application | | | | | clients to | | | | | discover the | | | | | server end | | | | | point details | | | | | using DNS SRV | | | | | query. | | | +--------------+----------------+----------------+----------------+ | Solution#5 | This is also | Multicast DNS | UDP, TCP, SCTP | | | DNS based | | | | | solution. But | | | | | instead of | | | | | sending the | | | | | DNS query to a | | | | | unicast DNS | | | | | server, it is | | | | | sent to a | | | | | link-local | | | | | multicast | | | | | address. The | | | | | nodes are | | | | | implemented | | | | | with mDNS | | | | | resolver and | | | | | responder. The | | | | | node | | | | | supporting the | | | | | service | | | | | responds to | | | | | the mDNS | | | | | query. | | | +--------------+----------------+----------------+----------------+ | Solution#6 | Solution#6 is | | UDP, TCP, SCTP | | | similar to | | | | | Solution#5 | | | | | with only | | | | | difference | | | | | that the mDNS | | | | | query is sent | | | | | to a | | | | | pre-configured | | | | | IP address | | | | | instead of the | | | | | link-local | | | | | multicast | | | | | address. | | | +--------------+----------------+----------------+----------------+ | Solution#7 | All new | MUX based | SCTP | | | interface | solution | | | | s/applications | | | | | use a common | (For SCTP use | | | | standardized | standardized | | | | port number | PPID) | | | | and unique | | | | | standardized | | | | | SCTP Payload | | | | | Protocol | | | | | Identifier | | | | | (PPID). The | | | | | server side | | | | | implements an | | | | | SCTP | | | | | multiplexer | | | | | that | | | | | distributes | | | | | the traffic to | | | | | intended | | | | | applications | | | | | based on PPID | | | | | value. | | | +--------------+----------------+----------------+----------------+ | Solution#8 | All new | | SCTP | | | interface | | | | | s/applications | | | | | use a common | | | | | standardized | | | | | port number | | | | | and unique | | | | | standardized | | | | | SCTP Payload | | | | | Protocol | | | | | Identifier | | | | | (PPID). The | | | | | server side | | | | | implements an | | | | | SCTP | | | | | application | | | | | layer | | | | | multiplexer | | | | | solution that | | | | | is used to | | | | | negotiate with | | | | | the client on | | | | | the | | | | | applications | | | | | the client | | | | | intends to | | | | | access with | | | | | the SCTP | | | | | connection and | | | | | then further | | | | | distribute the | | | | | traffic to the | | | | | intended | | | | | applications | | | | | based on the | | | | | PPID. | | | +--------------+----------------+----------------+----------------+ | Solution#9 | This solution | | TCP | | | is proposed | | | | | for TCP based | | | | | applications. | | | | | The proposal | | | | | is to use TCP | | | | | Port Service | | | | | Multiplexer | | | | | (TCPMUX) as | | | | | defined in | | | | | IETF RF | | | | | C 1078 [10], | | | | | that is | | | | | already | | | | | deprecated by | | | | | IETF | | | | | RFC 7805 [4] | | | +--------------+----------------+----------------+----------------+ | Solution#10 | This is an | Standardized | SCTP | | | alternative to | SCTP PPID | | | | Solution#7 | without MUX | | | | and | | | | | Solution#8. | | | | | It also | | | | | proposes to | | | | | use a common | | | | | SCTP port and | | | | | a standardized | | | | | SCTP Payload | | | | | Protocol | | | | | Identifier | | | | | (PPID) value | | | | | for each new | | | | | interfac | | | | | e/application. | | | | | If there are | | | | | multiple | | | | | applications | | | | | running on a | | | | | single node, | | | | | the proposal | | | | | is to use | | | | | different IP | | | | | address for | | | | | each | | | | | application. | | | +--------------+----------------+----------------+----------------+ | Solution#11 | The proposal | Form a Work | UDP, TCP, SCTP | | | here is to | Group | | | | form a work | | | | | group with | (Continue | | | | members from | using | | | | telecom | standardized | | | | industry | port allocated | | | | (ITU-T, 3GPP, | by IANA) | | | | ETSI, TTC, | | | | | ATIS, etc.) | | | | | and IETF/IANA | | | | | to discuss the | | | | | port number | | | | | requirement | | | | | from telecom | | | | | networks. | | | | | Looking at the | | | | | available port | | | | | numbers, past | | | | | port | | | | | allocation | | | | | history from | | | | | IANA and | | | | | number of | | | | | ports required | | | | | typically by | | | | | telecom | | | | | networks(\~1-2 | | | | | on an average | | | | | per year), it | | | | | may be | | | | | possible to | | | | | reserve a | | | | | sub-range from | | | | | user port | | | | | number range | | | | | [1024-49151] | | | | | for | | | | | standardized | | | | | telecom | | | | | industry use. | | | +--------------+----------------+----------------+----------------+ | Solution#12 | This solution | HTTP(s) web | UDP, TCP, SCTP | | | proposes to | server query | | | | enhance NRF to | for port | | | | support | discovery | | | | registration | | | | | of port number | | | | | information | | | | | and retrieval | | | | | of the port | | | | | number by an | | | | | application | | | | | client. An | | | | | application | | | | | client can use | | | | | the NF | | | | | Discovery | | | | | service to | | | | | retrieve the | | | | | port number of | | | | | a specific | | | | | protocol, by | | | | | indicating the | | | | | protocol type. | | | | | After | | | | | retrieval of | | | | | the port | | | | | number the | | | | | application | | | | | client goes | | | | | ahead with the | | | | | transport | | | | | layer | | | | | connection | | | | | setup. | | | +--------------+----------------+----------------+----------------+ | Solution#13 | Solution#13 | | UDP, TCP, SCTP | | | is similar to | | | | | Solution#12, | | | | | with the | | | | | following | | | | | differences: | | | | | | | | | | - The server | | | | | side | | | | | implements an | | | | | HTTP web | | | | | service and is | | | | | configured | | | | | with the | | | | | IP/Port number | | | | | of the | | | | | supported | | | | | applications. | | | | | | | | | | - The client | | | | | side is | | | | | configured to | | | | | query the HTTP | | | | | web server | | | | | first to fetch | | | | | the IP/port | | | | | number details | | | | | supported by | | | | | the | | | | | application. | | | +--------------+----------------+----------------+----------------+
The Table 7.3.1.1â€‘1 above summarizes all the solutions incorporated in the TR
29.835 and groups the solutions into different type of solutions along with
the transport protocols supported by the solutions. The following clauses
provide detailed evaluation on each type of solutions.
#### 7.3.1.2 Evaluation of 3GPP standardizing port from dynamic range
(Solution#1)
Solution#1 proposes that 3GPP shall reserve a sub-range of port numbers from
the dynamic/private range [49152 - 65535]. 3GPP will standardize a port number
from this sub-range for every new interface/application defined by it going
forward. The dynamic range [49152 -- 65535] is not assigned by IANA as this
range has been specifically set aside for local and dynamic use case. So, even
if we (3GPP) reserve a sub-range from the dynamic/private port number range,
it is unlikely that IETF will agree on recommending to internet community to
avoid such port range reserved by 3GPP. This will leave a finite possibility
of a port number clash as described in the solution in clause 6.2.2. However,
since this solution will be used only for intra-domain uses cases (because
IETF/IANA will continue port number allocation for 3GPP inter-domain
interfaces) within a 3GPP network, the possibility of a port clash with other
application client would be very less and it should be possible to easily
avoid/overcome any such port number clash scenarios.
#### 7.3.1.3 Evaluation of OAM based solution (Solution#2)
Solution#2 on the other hand proposes that the port number is not standardized
by 3GPP. Instead each operator becomes responsible for assigning a port number
for each new interface/application. Such port number can be assigned either
from the user port number range [1024-49151] or from the Dynamic/Private Port
number range [49152 - 65535]. The operator also becomes responsible for
avoiding any port number clash. Not using a standardized port number will
introduce other problems as described in clause 4.2.1. So, when defining a new
SCTP based interface/application, if Solution#2 is used, an SCTP Payload
Protocol Identifier (PPID) shall also be defined/standardized for the new
application. Generally, the application clients use port numbers from the
dynamic/private port number range [49152 - 65535] as the source port while
initiating a connection. Many applications use the dynamic/private port number
range [49152 - 65535] for internal communications as well. Since in
Solution#2, the operator\'s OAM allocates the port number, the operator is
aware of port numbers from the user port number range [1024-49151] being used
in the network. So, it may be beneficial if for Solution#2 the operator
allocates free ports from the user port number range [1024-49151] for the new
3GPP interfaces/applications.
Both Solution#1 and Solution#2 avoids larger impacts on the infrastructure
(e.g. introducing/managing DNS) and keeps the impact on the application side
also to a minimum e.g. no need for implementing support for DNS, mDNS, HTTP
based Web server/client or multiplexer etc. Both Solution#1 and Solution#2
have a finite risk of running into port number clash. However, Solution#2 has
an advantage over Solution#1, that the port number is not standardized (or
fixed) and is managed by the operator\'s OAM. Solution#2 provides a further
flexibility to the operator to also use free ports from the user port number
range [1024-49151] which will ensure that there will be no port number clash
with any other application clients (both 3GPP and non-3GPP) as the application
clients will use port numbers from the dynamic range [49152 \- 65535] as a
source port.
#### 7.3.1.4 Evaluation of DNS based solutions (solutions #3, #4, #5, #6)
Solution#3 and Solution#4 makes use of the proven DNS infrastructure, which is
a very matured technology, for discovering the port number by the application
clients. On the application server side, the port number could be
locally/dynamically assigned. These 2 solutions limit the need for manual
configuration on the application client side as the clients only need to be
configured with the DNS server IP address, through which it can discover the
IP address and port numbers to be used for setting up connections to a
specific interface/application. However, these 2 solutions also come with a
number of other challenges. All 3GPP nodes must implement a DNS resolver to
discover the interface end point IP address and port numbers. This discovery
mechanism additionally implies more signalling before the connection is setup
between 2 nodes. On the server side, if the port number assigned to the
application is changed, the DNS server needs to be updated. This DNS server
update can be done manually or dynamically using Dynamic DNS (DDNS) kind of
solutions for updating DNS records on the run. Although DDNS eliminates
considerable time required to manually update the DNS records in the DNS
server when network configuration changes, it will not enable to automatically
update the clients with this information: on the client side the DNS resolver
generally caches the response received from the DNS server for a certain
duration (Time-To-Live or TTL). Now, if the DNS records is updated in the DNS
server before the expiration of the TTL in the DNS resolver cache, the client
remains unaware of the change until the timer is expired and it does a fresh
DNS query (assuming here that the DNS records are updated). However,
experiencing connection attempt failures due to the outdated DNS information,
the client can force a refresh of the DNS cache (DNS flush) and then retrieve
the updated DNS records from the authoritative DNS server. Another way to
improve the DNS update propagation in the network would be to use TTL of few
minutes instead of hours. From an operator\'s point of view, these solutions
also introduce additional costs and complexity of deploying and maintaining
the DNS infrastructure and timely update of DNS records. This also introduces
dependency on DNS infrastructure for availability.
Solution#5 and Solution#6 also uses DNS based discovery of the server IP
address and port, however, instead of using a DNS infrastructure it relies on
the concept of multicast DNS (mDNS) for discovery. Both Solution#5 and
Solution#6 needs the application nodes to implement an DNS resolver (mDNS or
legacy DNS) on the client side and mDNS responder on the server side. They can
work without any DNS infrastructure and avoids all the challenges highlighted
above w.r.t. Solution#3 and Solution#4. There are however some differences
between Solution#5 and Solution#6. For example: in the former case the DNS
query is sent to a link-local multicast address whereas in the latter one the
DNS query is sent to a pre-configured IP address of the node hosting the
server side of the application. Which means Solution#5 can only be used if
both the application client and server are located in the same logical
network, whereas Solution#6 is not restricted by such logical network
boundaries. On the other hand, multicast updates sent on the local link can be
received by all the node on that network; therefore, all the nodes in the
local link network can be always up-to-date whenever there is a port change,
which is not possible with unicast based solution.
#### 7.3.1.5 Evaluation of Multiplexer based solutions (solutions #7, #8 and
#9)
Both Solution#7 & Solution#8 allow to run multiple applications on the same
SCTP connection (i.e. same IP address and port number) and also avoid impacts
on the network and infrastructure (e.g. introducing/managing DNS).
Solution#8 also has a significant impact on both the application server and
client implementations for all newly defined interfaces. On the server side,
an application layer multiplexer has to be designed as explained in the
solution (see clause 6.9.2). Similarly, on the client-side necessary
adaptations have to be done to discover the applications that are supported by
the remote SCTP end point by sending new application messages, containing list
of application ids (SCTP Payload Protocol Identifier values) for negotiations
as explained in the solution in clause 6.9.2.
Solution#9 is proposed for TCP based applications and uses an already
deprecated solution. Some of the reasons for deprecation as mentioned in the
IETF RFC 7805 [12] that are relevant for 3GPP applications are listed below:
\- It requires all new connections to be received on a single port, which
limits the number of connections between two machines.
\- It complicates firewall implementation and management because all services
share the same port number.
At 3GPP we should avoid using a solution that is already deprecated by IETF.
Also, since TCPMUX is deprecated by IETF, it may impact the TCP stacks on the
application side, e.g. TCPMUX may not be supported by the stack layer at all
or the support may be removed.
#### 7.3.1.6 Evaluation of solution with Standardized PPID without multiplexer
(solution#10)
There are 3 solutions that propose to use a common SCTP port for all newly
defined 3GPP interfaces/applications that use SCTP as the transport layer,
namely Solution#7, #8 and #10.Both solutions #7 and #8 allow multiple
application servers to run on a common SCTP connection (i.e. same IP address
and port number) with traffic distributed based on PPID. Solution#10 on the
other hand proposes to use separate IP address for each application, if there
are multiple applications running on a single node.
Solution#10 avoids all impacts on the SCTP stack layer or on the application
layer (see evaluation of Solution#7 & #8 in clause 7.3.1.5). But the
disadvantage is that it needs more number of IP addresses when compared with
solutions #7 and #8. If SCTP multi-homing is used, with solution#10 we would
need 1 pair of unique IP addresses for each (newly defined) application
running on a node.
One common disadvantage or challenge with all these 3 solutions is that it
needs IANA to allocate a port number for one final time. If IANA does not
allocate the common port to be used by all newly defined 3GPP
interfaces/applications, then 3GPP has to manage and reserve one port in some
other way (e.g. using an existing application port, which means impacts on
that particular existing application).
#### 7.3.1.7 Evaluation of solution to form work group (Solution#11)
The proposal in this solution is that, 3GPP continues to use standardized port
number, assigned by IANA, for all newly defined interfaces/applications. The
solution provides arguments on why the decision from IETF to not allocate any
new port number for 3GPP use is considered as overly conservative, by pointing
to historical data on port allocation done by IETF in last 20 years, the
number of ports available currently and the number of ports required by 3GPP
on an average per year.
By forming a working group it may be possible to convince IETF or influence
their decision and continue allocating port numbers for new 3GPP defined
interfaces or can agree on reserving a sub-range from the User port number
range [1024-49151] for 3GPP use, that would be the most preferred solution
from 3GPP point of view. There will be no impact on any existing or newly
defined interfaces. 3GPP can continue assigning/standardizing port numbers
while defining new interfaces/applications.
The work group has to be formed before concluding on the TR 29.835. If the
outcome of the work group is positive, i.e. IETF decides to continue
allocating port number or reserve a range of port numbers from user port
number range for 3GPP, then there is no need for any other solution and also
the TR 29.941 [11] is not needed.
#### 7.3.1.8 HTTP(s) web server query for port discovery (solutions #12 and
#13)
Both Solutions #12 and #13 need HTTP(s) based web server/client
implementations on the application nodes. This will complicate the application
design, specifically from RAN point of view. Additional (HTTP) signalling is
also needed before the application connection is setup. Both these solutions
are more suitable for core network NFs that are using SBI based interface and
already have HTTP(s) based implementations available.
Solution#12 requires applications using the non-SBI interfaces to support NRF
APIs to discover the port number of a non-SBI interface. This would cause NRF
impacts (new NF profile properties, new query parameters), and more
importantly impacts to the clients (especially those not implementing SBI).
The solutions require network entity / network function to have HTTP query
capability. It can be applied to non-SBI core network interfaces and RAN
interfaces only if they introduce HTTP capability. For core network SBI
interfaces this is not needed since the service discovery procedure in NRF
already supports SBI service consumers to discover the Host/IP address and
port number of the SBI service producer.
### 7.3.2 Conclusions for Key Issue #2 solutions (intra-domain)
There is not a single solution for port allocation that will fit all
requirements from different 3GPP WGs. It is therefore agreed that the study
will conclude on different solutions for different types of interfaces and
applications (e.g. RAN SCTP interfaces, UDP based interface in CN etc.).
The study will only provide recommendation on solutions for port allocation in
TR 29.941 [11]. It is then up to each 3GPP WG to decide which solution is used
for a new interface defined by that WG.
If a port number is not standardized by IANA for the new interface/application
defined by a 3GPP WG (i.e. the port is either statically assigned through OAM
or dynamically selected by the node or 3GPP assigns a port from the dynamic
range), an SCTP Payload Protocol Identifier (PPID) value shall be standardized
for any new SCTP interface/application. This is applicable to all solutions
incorporated into the TR 29.941 for interface/application using SCTP
transport.
Table 7.4â€‘1 summarizes all the conclusions on Key Issue #2 that are
incorporated in the TR 29.835 and with additional comments on each solution.
## 7.4 Conclusion summary
This clause summarizes conclusions for all Key Issues by listing the candidate
solutions that need be incorporated into TR 29.941 [11]. Table 7.4-1
summarizes for each of the proposed solutions, its port allocation method, for
which transport protocols the solution can be used and with additional remarks
on its applicability to each Key Issue.
Table 7.4-1: Summary of conclusions
+----------+----------+----------+----------+----------+----------+ | Solution | Port | Ap | Ap | Co | | | | al | plicable | plicable | nclusion | | | | location | t | for | & | | | | method | ransport | | ad | | | | | layer | | ditional | | | | | protocol | | comments | | +==========+==========+==========+==========+==========+==========+ | | | | KI#1 | KI#2 | | | | | | (Inter | (intra | | | | | | -domain) | -domain) | | | | | | (NOTE 2) | | | +----------+----------+----------+----------+----------+----------+ | **Solut | * |** All**|** YES**|** YES**|** DNS | | ion#1**| *Fixed** | | | | infras | | | | **(NOTE | | | tructure | | | | 1)** | | | based | | | | | | | solution | | | | | | | (D | | | | | | | NS-SD)**| | | | | | | | | | | | | |** Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941**| | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | is | | | | | | | suitable | | | | | | | for | | | | | | | KI#2 | | | | | | | and with | | | | | | | some | | | | | | | li | | | | | | | mitation | | | | | | | for | | | | | | | KI#1. | +----------+----------+----------+----------+----------+----------+ |** Solut | * | **All** | **NO** | **YES** | **DNS | | ion#2** | _Fixed_ _| | | | infras | | | |__(NOTE | | | tructure | | | | 1)__| | | based | | | | | | | solution | | | | | | | (DNS | | | | | | | SRV)__| | | | | | | | | | | | | |__Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941_ _| | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | is | | | | | | | suitable | | | | | | | for only | | | | | | | KI#2 | | | | | | | (intra | | | | | | | -domain) | | | | | | | but not | | | | | | | suitable | | | | | | | for | | | | | | | KI#1 | | | | | | | (inter- | | | | | | | domain). | +----------+----------+----------+----------+----------+----------+ |__Solut |__Unas |__All_ _|__YES_ _|__YES_ _|__M | | ion#3_ _| signed_ _| | | | ulticast | | | |__(NOTE | | | DNS | | | | 1)__| | | based | | | | | | | solution | | | | | | | (mDNS)__| | | | | | | | | | | | | |__Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941_ _| | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | is | | | | | | | suitable | | | | | | | for | | | | | | | KI#2 | | | | | | | (intra- | | | | | | | domain). | | | | | | | | | | | | | | Further | | | | | | | study is | | | | | | | needed | | | | | | | to | | | | | | | assess | | | | | | | if this | | | | | | | is | | | | | | | suitable | | | | | | | for | | | | | | | KI#1 | | | | | | | (Inter | | | | | | | -domain) | | | | | | | also. If | | | | | | | both | | | | | | | domains | | | | | | | rely on | | | | | | | the DNS | | | | | | | infras | | | | | | | tructure | | | | | | | and the | | | | | | | targeted | | | | | | | domain | | | | | | | name | | | | | | | under | | | | | | | 3gppnet | | | | | | | work.org | | | | | | | can be | | | | | | | di | | | | | | | scovered | | | | | | | using | | | | | | | confi | | | | | | | guration | | | | | | | or based | | | | | | | on other | | | | | | | inf | | | | | | | ormation | | | | | | | (e.g. | | | | | | | SUPI, | | | | | | | IMSI), | | | | | | | this | | | | | | | solution | | | | | | | may be | | | | | | | co | | | | | | | nsidered | | | | | | | for | | | | | | | KI#1. | | | | | | | But if | | | | | | | the | | | | | | | traffic | | | | | | | related | | | | | | | to the | | | | | | | di | | | | | | | scovered | | | | | | | appli | | | | | | | cation/i | | | | | | | nterface | | | | | | | needs to | | | | | | | be | | | | | | | con | | | | | | | trolled, | | | | | | | this | | | | | | | will not | | | | | | | work as | | | | | | | the | | | | | | | des | | | | | | | tination | | | | | | | port is | | | | | | | unknown | | | | | | | for | | | | | | | security | | | | | | | g | | | | | | | ateway/f | | | | | | | irewall. | +----------+----------+----------+----------+----------+----------+ |__Solut |__Unas |__All_ _|__YES_ _|__YES_ _| * | | ion#4_ _| signed_ _| | | |_ Unicast | | | | **(NOTE | | | DNS | | | | 1)** | | | based | | | | | | | solution | | | | | | | (uDNS)**| | | | | | | | | | | | | |** Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941**| | | | | | | [11]. | | | | | | | | | | | | | | See | | | | | | | comments | | | | | | | for | | | | | | | Solu | | | | | | | tion#3. | | | | | | | | | | | | | | RAN3 | | | | | | | c | | | | | | | onsiders | | | | | | | sol | | | | | | | ution#4 | | | | | | | not | | | | | | | de | | | | | | | sirable. | +----------+----------+----------+----------+----------+----------+ |** Solut | **Unas |** All**|** NO**|** YES**|** SCTP | | ion#5**| signed** | | | | MUX | | | | **(NOTE | | | based | | | | 1)** | | | solution | | | | | | | using | | | | | | | stan | | | | | | | dardized | | | | | | | PPID | | | | | | | (SCTP | | | | | | | MUX)**| | | | | | | | | | | | | |** Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941**| | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | is | | | | | | | suitable | | | | | | | for | | | | | | | KI#2 | | | | | | | (intra | | | | | | | -domain) | | | | | | | but not | | | | | | | suitable | | | | | | | for | | | | | | | KI#1 | | | | | | | (inter- | | | | | | | domain), | | | | | | | because | | | | | | | m | | | | | | | ulticast | | | | | | | is | | | | | | | re | | | | | | | stricted | | | | | | | to local | | | | | | | link. | +----------+----------+----------+----------+----------+----------+ |** Solut | **Unas |** All**|** YES**|** YES**|** 3GPP | | ion#6**| signed** | | | | a | | | | **(NOTE | | | llocated | | | | 1)** | | | port | | | | | | | number | | | | | | | solution | | | | | | | (3GPP)**| | | | | | | | | | | | | |** Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941**| | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | is | | | | | | | suitable | | | | | | | for | | | | | | | KI#2 | | | | | | | (intra- | | | | | | | domain). | | | | | | | | | | | | | | If the | | | | | | | IP | | | | | | | address | | | | | | | can be | | | | | | | dyn | | | | | | | amically | | | | | | | r | | | | | | | esolved, | | | | | | | e.g. | | | | | | | using an | | | | | | | FQDN to | | | | | | | retrieve | | | | | | | an IP | | | | | | | from the | | | | | | | DNS and | | | | | | | inte | | | | | | | r-domain | | | | | | | i | | | | | | | nterface | | | | | | | is | | | | | | | secured | | | | | | | it can | | | | | | | be used | | | | | | | for | | | | | | | KI#1 | | | | | | | (inter- | | | | | | | domain). | | | | | | | But if | | | | | | | DNS has | | | | | | | to be | | | | | | | used, | | | | | | | this | | | | | | | solution | | | | | | | has less | | | | | | | value | | | | | | | than the | | | | | | | Sol | | | | | | | ution#3 | | | | | | | and the | | | | | | | Solu | | | | | | | tion#4. | | | | | | | | | | | | | | Also see | | | | | | | comments | | | | | | | on | | | | | | | Sol | | | | | | | ution#3 | | | | | | | for | | | | | | | KI#1. | +----------+----------+----------+----------+----------+----------+ |** Solut | * | **SCTP** | **YES** | **YES** | **OAM | | ion#7** | _Fixed_ _| | | | a | | | | | | | llocated | | | | | | | port | | | | | | | number | | | | | | | solution | | | | | | | (OAM)__| | | | | | | | | | | | | |__Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941_ _| | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | is | | | | | | | suitable | | | | | | | for both | | | | | | | KI#1 | | | | | | | (if the | | | | | | | port | | | | | | | number | | | | | | | is | | | | | | | assigned | | | | | | | by IANA | | | | | | | or 3GPP) | | | | | | | and | | | | | | | KI#2 | | | | | | | for SCTP | | | | | | | int | | | | | | | erfaces. | +----------+----------+----------+----------+----------+----------+ | Sol | Un | SCTP | YES | YES | This | | ution#8 | assigned | | | | solution | | | | | | | is not | | | | | | | pursued | | | | | | | further | | | | | | | due to | | | | | | | the | | | | | | | impact | | | | | | | on | | | | | | | app | | | | | | | lication | | | | | | | nodes as | | | | | | | e | | | | | | | xplained | | | | | | | in | | | | | | | 7.3.1.5 | +----------+----------+----------+----------+----------+----------+ | Sol | Fixed | SCTP | NO | YES | This | | ution#9 | | | | | solution | | | | | | | is not | | | | | | | pursued | | | | | | | further | | | | | | | as | | | | | | | TCPMUX | | | | | | | is | | | | | | | already | | | | | | | de | | | | | | | precated | | | | | | | by IETF. | +----------+----------+----------+----------+----------+----------+ | Solu | Fixed | SCTP | YES | YES | This | | tion#10 | | | | | solution | | | | | | | is not | | | | | | | pursued | | | | | | | further. | | | | | | | Ge | | | | | | | nerally, | | | | | | | o | | | | | | | perators | | | | | | | prefer | | | | | | | to use | | | | | | | single | | | | | | | pair of | | | | | | | IP | | | | | | | a | | | | | | | ddresses | | | | | | | for | | | | | | | multiple | | | | | | | SCTP | | | | | | | appl | | | | | | | ications | | | | | | | running | | | | | | | on a | | | | | | | single | | | | | | | node | | | | | | | (e.g. | | | | | | | Xn, X2, | | | | | | | Ng etc). | | | | | | | Solu | | | | | | | tion#10 | | | | | | | has | | | | | | | ad | | | | | | | ditional | | | | | | | IP | | | | | | | address | | | | | | | req | | | | | | | uirement | | | | | | | (one | | | | | | | pair for | | | | | | | each | | | | | | | appli | | | | | | | cation/i | | | | | | | nterface | | | | | | | running | | | | | | | on a | | | | | | | node). | +----------+----------+----------+----------+----------+----------+ |__Soluti | * |__All_ _|__YES_ _|__YES_ _|__IETF | | on#11_ _|_ Fixed**| | | | a | | | |**(NOTE | | | llocated | | | | 1)**| | | port | | | | | | | number | | | | | | | solution | | | | | | | (IETF)** | | | | | | | | | | | | | | Suitable | | | | | | | for both | | | | | | | KI#1 | | | | | | | and | | | | | | | KI#2, | | | | | | | but this | | | | | | | solution | | | | | | | requires | | | | | | | regular | | | | | | | IETF | | | | | | | endo | | | | | | | rsement. | | | | | | | This | | | | | | | solution | | | | | | | is out | | | | | | | of | | | | | | | direct | | | | | | | 3GPP | | | | | | | control | | | | | | | and | | | | | | | t | | | | | | | herefore | | | | | | | should | | | | | | | be | | | | | | | pursued | | | | | | | as an | | | | | | | ind | | | | | | | ependent | | | | | | | a | | | | | | | ctivity. | | | | | | | | | | | | | | The | | | | | | | p | | | | | | | rinciple | | | | | | | of | | | | | | | drafting | | | | | | | an IETF | | | | | | | RFC to | | | | | | | modify | | | | | | | the | | | | | | | rules | | | | | | | and | | | | | | | policies | | | | | | | of IETF | | | | | | | port | | | | | | | al | | | | | | | location | | | | | | | is | | | | | | | ag | | | | | | | reeable, | | | | | | | however | | | | | | | it needs | | | | | | | further | | | | | | | study on | | | | | | | the | | | | | | | exact | | | | | | | changes | | | | | | | that | | | | | | | 3GPP | | | | | | | should | | | | | | | propose | | | | | | | in the | | | | | | | RFC. | +----------+----------+----------+----------+----------+----------+ | **Soluti |** Unas | **All** | **YES** | **YES** | **Port | | on#12** | signed**| | | | Regi | | | |**(NOTE | | | stration | | | | 1)**| | | and | | | | | | | R | | | | | | | etrieval | | | | | | | via NRF | | | | | | | based | | | | | | | solution | | | | | | | (NRF)** | | | | | | | | | | | | | | **Agreed | | | | | | | to be | | | | | | | inco | | | | | | | rporated | | | | | | | into the | | | | | | | TR | | | | | | | 29.941** | | | | | | | [11]. | | | | | | | | | | | | | | This | | | | | | | solution | | | | | | | requires | | | | | | | support | | | | | | | of SBI | | | | | | | if not | | | | | | | s | | | | | | | upported | | | | | | | already, | | | | | | | for port | | | | | | | number | | | | | | | regi | | | | | | | stration | | | | | | | and | | | | | | | di | | | | | | | scovery. | | | | | | | Also, | | | | | | | this | | | | | | | solution | | | | | | | will | | | | | | | have | | | | | | | impact | | | | | | | on NRF | | | | | | | to | | | | | | | support | | | | | | | port | | | | | | | number | | | | | | | regi | | | | | | | stration | | | | | | | and | | | | | | | d | | | | | | | iscovery | | | | | | | of | | | | | | | d | | | | | | | ifferent | | | | | | | non SBI | | | | | | | interfac | | | | | | | es/appli | | | | | | | cations. | | | | | | | If the | | | | | | | traffic | | | | | | | related | | | | | | | to the | | | | | | | di | | | | | | | scovered | | | | | | | appli | | | | | | | cation/i | | | | | | | nterface | | | | | | | needs to | | | | | | | be | | | | | | | con | | | | | | | trolled, | | | | | | | this | | | | | | | will not | | | | | | | work as | | | | | | | the | | | | | | | des | | | | | | | tination | | | | | | | port is | | | | | | | unknown | | | | | | | for | | | | | | | security | | | | | | | g | | | | | | | ateway/f | | | | | | | irewall. | +----------+----------+----------+----------+----------+----------+ | Solu | Un | All | YES | YES | This | | tion#13 | assigned | (NOTE 1) | | | solution | | | | | | | is not | | | | | | | pursued | | | | | | | further | | | | | | | as it is | | | | | | | not | | | | | | | suitable | | | | | | | for RAN | | | | | | | NEs. For | | | | | | | core NEs | | | | | | | SBA can | | | | | | | be used | | | | | | | instead | | | | | | | of the | | | | | | | HTTP(s) | | | | | | | web | | | | | | | serve | | | | | | | r/client | | | | | | | implem | | | | | | | entation | | | | | | | proposed | | | | | | | in this | | | | | | | s | | | | | | | olution. | +----------+----------+----------+----------+----------+----------+ | Solu | Fixed | All | NO | YES | This | | tion#14 | | (NOTE 1) | | | solution | | | | | | | is not | | | | | | | pursued | | | | | | | further. | | | | | | | | | | | | | | May not | | | | | | | be | | | | | | | suitable | | | | | | | for | | | | | | | KI#1 | | | | | | | (inter- | | | | | | | domain), | | | | | | | as | | | | | | | (D)TLS | | | | | | | h | | | | | | | andshake | | | | | | | cannot | | | | | | | be done | | | | | | | E2E | | | | | | | between | | | | | | | e | | | | | | | ndpoints | | | | | | | due to | | | | | | | the | | | | | | | presence | | | | | | | of | | | | | | | security | | | | | | | gateway/ | | | | | | | Firewall | | | | | | | in the | | | | | | | path. | +----------+----------+----------+----------+----------+----------+ | Solu | Fixed | All | NO | YES | This | | tion#15 | | (NOTE 1) | | | solution | | | | | | | is not | | | | | | | pursued | | | | | | | further. | | | | | | | | | | | | | | May not | | | | | | | be | | | | | | | suitable | | | | | | | for | | | | | | | KI#1 | | | | | | | (inter- | | | | | | | domain), | | | | | | | as | | | | | | | (D)TLS | | | | | | | h | | | | | | | andshake | | | | | | | cannot | | | | | | | be done | | | | | | | E2E | | | | | | | between | | | | | | | e | | | | | | | ndpoints | | | | | | | due to | | | | | | | the | | | | | | | presence | | | | | | | of | | | | | | | security | | | | | | | gateway/ | | | | | | | Firewall | | | | | | | in the | | | | | | | path. | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | The | | | | | | | solution | | | | | | | is | | | | | | | ap | | | | | | | plicable | | | | | | | to TCP, | | | | | | | UDP, | | | | | | | SCTP and | | | | | | | DCCP | | | | | | | t | | | | | | | ransport | | | | | | | layer | | | | | | | p | | | | | | | rotocols | | | | | | | (c | | | | | | | urrently | | | | | | | 3GPP | | | | | | | apps do | | | | | | | not use | | | | | | | DCCP). | | | | | | | | | | | | | | NOTE 2: | | | | | | | S | | | | | | | olutions | | | | | | | that are | | | | | | | marked | | | | | | | as | | | | | | | ap | | | | | | | plicable | | | | | | | for | | | | | | | inte | | | | | | | r-domain | | | | | | | in | | | | | | | terfaces | | | | | | | may not | | | | | | | nec | | | | | | | essarily | | | | | | | imply | | | | | | | that it | | | | | | | is | | | | | | | suitable | | | | | | | for any | | | | | | | new | | | | | | | inte | | | | | | | r-domain | | | | | | | i | | | | | | | nterface | | | | | | | defined | | | | | | | by 3GPP, | | | | | | | due to | | | | | | | lim | | | | | | | itations | | | | | | | and | | | | | | | ad | | | | | | | ditional | | | | | | | constrai | | | | | | | nts/requ | | | | | | | irements | | | | | | | id | | | | | | | entified | | | | | | | during | | | | | | | the | | | | | | | i | | | | | | | nterface | | | | | | | design. | | | | | | +----------+----------+----------+----------+----------+----------+
###### ### Annex A: IANA port allocation policy
IANA maintains the list of service names and port numbers used to distinguish
between different services that run over transport protocols such as TCP, UDP,
DCCP and SCTP. The IANA registration procedures for service names and port
numbers are described in IEFT RFC 6335 [2].
\- Service names are assigned on a first-come, first-served process.
Assignments are made to anyone on a \"first come, first served\" basis. There
is no substantive review of the request, other than to ensure that it is well-
formed and doesn\'t duplicate an existing assignment.
\- Port numbers are assigned in various ways, based on three ranges: System
Ports [0-1023], User Ports [1024-49151], and the Dynamic and/or Private Ports
[49152 - 65535].
According to Clause 8.1.2 of IEFT RFC 6335 [2], IANA follows one the following
procedures for port number value allocation defined in IEFT RFC 8126 [9]:
> \- IETF Review:
New values are assigned only through IETF RFCs in the IETF Stream, i.e.,
documents that has been approved by the IESG as having IETF consensus.
\- IESG Approval:
New value assignment is directly approved by the IESG without the need for
approved IETF RFCs.
\- Expert Review:
New values are assigned after review and approval by a designated expert. An
approved IETF RFC is not required but information needs to be provided with
the request for the designated expert to evaluate.
System Ports are assigned by IANA using the \"IETF Review\" or \"IESG
Approval\" procedures.
User Ports are assigned by IANA using the \"IETF Review\" process or the
\"IESG Approval\" process or the \"Expert Review\" process.
Dynamic Ports are not assigned. The Dynamic Ports range has been specifically
set aside for local and dynamic use. Application software may simply use any
dynamic port that is available on the local host, without any sort of
assignment, assuming that the port used by applications are discovered by
clients dynamically at run-time.
System and User ports should not be used without or prior to IANA
registration. The registration procedures for service names and port numbers
are described in IEFT RFC 6335 [2].
Recently, however, IANA became more restrictive to reserving new port numbers
to private networks. IANA experts are now following the recommendations given
in Clause 6 of IETF RFC 7605 [3]. Each port number assignment request must be
now strongly justified by the applicants as independently useful service. This
was done on purpose, as the range of port number that can be allocated by IANA
is fixed and IANA does not want to run out of available port numbers in
future, due to uncontrolled requests as it was done in the past (e.g. range of
port numbers allocated to a single company etc.).
###### ### Annex B: Port number use
## B.1 General
In IP networking, the destination or origination IP address of a message is
completed by a port number. If the IP address identifies the device e.g.
computer, the port number is used to identify an application or service
running on the device.
The current use of ports was clearly established in the Transmission Control
Protocol [13]
Multiplexing:
To allow for many processes within a single Host to use TCP communication
facilities simultaneously, the TCP provides a set of addresses or ports within
each host. Concatenated with the network and host addresses from the internet
communication layer, this forms a socket. A pair of sockets uniquely
identifies each connection.
That is, a socket may be simultaneously used in multiple connections.
The binding of ports to processes is handled independently by each Host.
However, it proves useful to attach frequently used processes (e.g., a
\"logger\" or timesharing service) to fixed sockets which are made known to
the public. These services can then be accessed through the known addresses.
Establishing and learning the port addresses of other processes may involve
more dynamic mechanisms.
The port number is a 16-bit unsigned number, ranging then from 0 to 65535.
As indicated in the IETF RFC 6335 [2], this range [0-65535] is subdivided as
follows:
\- 0-1023: the System Ports, also known as the Well Known Ports, assigned by
IANA
\- 1024-49151: the User Ports, also known as the Registered Ports, assigned by
IANA
\- 49152-65535: the Dynamic Ports, also known as the Private or Ephemeral
Ports, not assigned, controlled, nor registered.
### B.2 Port number ranges
System ports [0-1023] are assigned by IANA and were initially reserved to
services that required privileged/root access to the operating system. They
have been reserved for common applications, typically server applications. The
port numbers assigned to these server applications have to be known by the
client\'s transport layer and are used by the client as destination port
number in message requests sent to the server applications. Clients know that
servers will be listening for their requests at these reserved port numbers.
B.2-1: Example of Well-Known port numbers used by servers.
User ports [1024-49151] are assigned by IANA and also used to identify server
applications as for System port except that they were reserved for services
that did not require privileged access.
NOTE: Today, the distinction between System and User ports is not any more
obvious. Operating systems may allow access to System port numbers to non-
privileged services and well-known services are usually replicated on User
ports (e.g. HTTP on port 8080).
Dynamic ports [49152-65535] are not assigned/allocated by IANA. They are
automatically allocated by the IP stack software to be used as source port of
an outgoing IP message. These port numbers are used by clients to identify the
internal process sending the message and the receiver can simply reply to the
client by using the received source port number as destination port number in
the reply sent to the client. The port allocations are temporary and only
valid for the duration of the communication session. After completion (or
timeout) of the communication session, the ports become available for reuse,
although most IP stacks will usually not reuse that port number until the
entire pool of ephemeral ports have been used. So, if the client program
reconnects, it will be assigned a different ephemeral port number for its side
of the new connection.
B2-2: Dynamic port numbers used by clients.
Even if not recommended, Dynamic Port numbers may also be used to temporary
identify a server application in a node. This implies that:
\- The client has a mean to discover the port allocated to the server at run-
time.
\- The dynamic port assigned to the service cannot be reused by a client
program in the same node as long as the port needs to be used as listening
port by the service.
## B.3 Service identified by port number not assigned by IANA
Not all the services need assigned port numbers. Any service can use:
\- any unassigned port in the System and User port ranges
\- any port number from the Dynamic port range.
\- port numbers assigned to another protocol if this protocol is not used e.g.
ports assigned to the Service Location Protocol (SLP) can be reused by any
service if this service is not deployed in a private network and there is then
no risk of conflict.
Services assigned with System/User ports by IANA may also use unassigned ports
to reduce the impact of potential attacks on the well-known ports and then be
more securely operated. For instance, a node that provides an HTTP interface
for internal management will likely use another port that the port 80.
For port numbers picked in the Dynamic port range to identify a service
application, there is a need to ensure that this port will not be re-allocated
to another client program in the same node to avoid conflict. Mechanisms to
achieve such a \"long-lived\" port assignment of dynamic port include:
\- Configure the range of dynamic ports that can be dynamically assigned by
the IP stack: the range defined by IANA is [49152-65535] but IP stacks can
usually be tuned to use another range, e.g. [32768-60999]. This implies that
port numbers outside this range can be used as listening ports by servers,
including ports normally considered as \"dynamic ports\" by IANA.
\- When booting the node, start all services before any other process start
and begin establishing connections. Therefore, all the servers can be assigned
with any available port from the unassigned ports in System/User port range or
any port from the Dynamic port range. Then a client program will only be able
to use remaining port numbers in the dynamic port range and no conflict will
happen.
When the port used to identify a service is not assigned by IANA, the clients
have to discover the destination port to use when sending a request. As
indicated in the IETF RFC 6335 [2], possible discovery mechanisms include:
\- Explicit configuration of both endpoints;
\- Internal mechanisms within the same host (e.g. a configuration file,
indicated within a URI or using interprocess communication);
\- Information provided by another service e.g. FTP, SIP, etc.;
\- Relying on specific service names and use of existing port discovery
services defined by IETF: mDNS as defined in IETF RFC 6762 [8], DNS-based
Service Discovery defined in IETF RFC 6763 [6], etc. Service names can be
simply registered by IANA on a \"first-come, first-served\" basis in a
namespace much larger than the port number range.
###### ### Annex C: IANA procedures for Service Name and Port Number registry
management
## C.1 General principles
IANA is responsible for the management and maintenance of service name and
port number registry. Because assigned port numbers are a limited resource
that is globally shared by the entire Internet community, the conservation of
the port space is the key priority of IANA when addressing port number
assignment request. IANA strives to limit assigned port number consumption and
promotes the use of alternate solutions for service identification, such as
explicit configuration of both endpoints, the use of service names and dynamic
ports along with service discovery mechanism, in-band port negotiation and/or
application layer service multiplexing.
Another priority is to allocate port primarily to applications used on the
Internet.
IANA assigns port numbers so that **Internet** endpoints do not need pairwise,
explicit coordination of the meaning of their port numbers. This is the
primary reason for requesting port number assignment by IANA \-- to have a
common agreement between all endpoints on the **Internet** as to the default
meaning of a port number, which provides the endpoints with a default port
number for a particular protocol or service.
## C.2 Assignment Procedure
As described in the IETFC RFC 6335 [2], a service name or port number
assignment request sent to IANA contains the following information:
Table C.2-1: Service Name/port number assignment request form
Field Required/optional Description
* * *
Service Name Required Unique service name for the service associated with the
assignment request. The name MUST be compliant with the syntax defined in
clause 5.1 of IETF RFC 6335 [2] (NOTE) Transport Protocol(s) Required TCP,
UDP, SCTP, and/or DCCP. It is required even if the request is only for service
name assignment Assignee Required Name and email address of the organization,
company or individual person responsible for the initial assignment. Contact
Required Name and email address of the Contact person for the assignment
Description Required Short description of the service associated with the
assignment request Reference Required A description of (or a reference to a
document describing) the protocol or application using this port. Port Number
Optional Suggested port number or port range (user or system) Service Code
Optional Required only for DCCP Known Unauthorized Uses Optional
Known/reported unauthorized uses by applications or organizations who are not
the Assignee Assignment Notes Optional Indications of owner/name change, or
any other assignment process issue NOTE: For 3GPP defined service names, the
name shall be prefixed by \"3gpp-\"
When receiving the assignment request, IANA will follow the one of the
procedures described in the following clause.
## C.3 IANA Policies for Port Number assignment
When IANA receives an assignment request that is only requesting service name,
IANA will usually assign the service name under a simple \"First Come First
Served\" policy defined in IETF RFC 5226 [14]
When IANA receives an assignment request that is requesting a port number,
IANA will initiate an \"IETF Review\" or \"IESG Approval\" procedures or an
\"Expert Review\" procedure defined in IETF RFC 5226 [14], depending on the
requested port range:
\- Ports in the Dynamic Ports range (49152-65535) cannot be assigned through
IANA. **A port number in that range MUST NOT be used as a service
identifier**.
\- Ports in the User Ports range (1024-49151) will be assigned under the
\"IETF Review\" or \"IESG Approval\" procedures defined in IETF RFC 5226 [14]
for IETF protocol. In other cases, the requester must input the documentation
to the \"Expert Review\" procedure defined in IETF RFC 5226 [14], by which
IANA will have a technical expert review the request to determine whether to
grant the assignment. The submitted documentation **MUST explain why using a
port number in the Dynamic Ports range is unsuitable** for the given
application.
\- Ports in the System Ports range (0-1023) will only be assigned under the
\"IETF Review\" or \"IESG Approval\" procedures defined in IETF RFC 5226 [14].
A request for a System Port number **MUST document *both* why using a port
number from the Dynamic Ports range is unsuitable *and* why using a port
number from the User Ports range is unsuitable** for that application.
## C.4 Recommendations to designers of application and service protocols
Used as companion document of the IETF RFC 6335 [2], the IETF RFC 7605 [3]
provides recommendations to designers of application and service protocols on
how to use the transport protocol port number space and when to request a port
assignment from IANA.
First, a set of questions is given to help designers to check whether a port
number assignment is deemed required for a given service application. These
questions are listed hereafter:
\- Is this really a new service or could an existing service suffice?
\- Is this an experimental service [RFC3692]? If so, consider using the
current experimental ports [RFC2780].
\- Is this service independently useful? Some systems are composed from
collections of different service capabilities, but not all component functions
are useful as independent services. Port numbers are typically shared among
the smallest independently useful set of functions. Different service uses or
properties can be supported in separate pairwise endpoint associations after
an initial negotiation, e.g., to support software decomposition.
\- Can this service use a Dynamic port number that is coordinated out-of-band?
For example:
\- By explicit configuration of both endpoints.
\- By internal mechanisms within the same host (e.g., a configuration file,
indicated within a URI or using interprocess communication).
\- Using information exchanged on a related service: FTP [RFC959], SIP
[RFC3261], etc.
\- Using an existing port discovery service: portmapper [RFC1833], mDNS
[RFC6762] [RFC6763], etc.
Moreover, a set of recommendations and requirements for registration and use
of port is provided to help designers to determine whether a port number
assignment is required. These recommendations and requirements are provided
for information hereafter:
\- Each assigned port requested MUST be justified by the applicant as an
independently useful service.
\- Developers SHOULD NOT apply for System port number assignments because the
increased privilege they are intended to provide is not always enforced.
\- System implementers SHOULD enforce the need for privilege for processes to
listen on System port numbers.
\- New services SHOULD support security capabilities, either directly or via a
content protection such as TLS [RFC5246] or Datagram TLS (DTLS) [RFC6347], or
transport protection such as the TCP-AO [RFC5925]. Insecure versions of new or
existing secure services SHOULD be avoided because of the new vulnerability
they create.
\- When requesting both secure and insecure port assignments for the same
service, justification is expected for the utility and safety of each port as
an independent service (clause 6). Precedent (e.g., citing other protocols
that use a separate insecure port) is inadequate justification by itself.
\- Security SHOULD NOT rely on assigned port number distinctions alone; every
service, whether secure or not, is likely to be attacked.
\- Version support SHOULD be included in new services rather than relying on
different port number assignments for different versions.
\- Version numbers SHOULD NOT be included in either the service name or
service description, to avoid the need to make additional port number
assignments for future variants of a service.
\- Service names and descriptions for multiple transport port number
assignments SHOULD match only when they describe the same service, excepting
only enhancements for each supported transport.
\- Names of discovery services SHOULD use an identifiable suffix; the
suggestion is \"-disc\".
\- UDP over IPv4 multi-host services SHOULD use multicast rather than
broadcast.
\- Services that use multipoint communication SHOULD be scalable and SHOULD
NOT rely solely on the efficiency of multicast transmission for scalability.
\- Services SHOULD NOT use UDP as a performance enhancement over TCP, e.g., to
circumnavigate TCP\'s congestion control.
\- Users MUST NOT deploy implementations that use assigned port numbers prior
their assignment by IANA.
\- Users MUST NOT deploy implementations that default to using the
experimental System port numbers (1021 and 1022 [RFC4727]) outside a
controlled environment where they can be updated with a subsequent assigned
port [RFC3692].
\- Users writing specifications SHOULD use symbolic names for port numbers and
service names until an IANA assignment has been completed. Implementations
SHOULD use experimental port numbers during this time, but those numbers MUST
NOT be cited in documentation except as interim.
## C.5 3GPP port assignment applications since 2009
IETF RFC 6335 [2] was published in 2011 to update IANA\'s procedures by
obsoleting the previous UDP and TCP port assignment procedures. Before that,
the principles for service name and port number management were based on a set
of informal guidelines developed based on the review experience from previous
assignment request and never publicly documented. Port numbers were managed
informally, and sometimes inconsistently and arbitrarily e.g., some services
were assigned ranges of many port numbers even where not strictly necessary.
Published in 2015, IETF RFC 7605 [3] provides additional information to
designers on how to use assigned port numbers that complements the IANA
process described in IETF RFC 6335 [2].
Whereas the conditions of port assignment have been further clarified and
reinforced based on the conservation principle, it seems that 3GPP did not
really appraise the policy change and did not modify accordingly their use of
port numbers in 3GPP systems. The port number assignment was recently still
considered as a by default solution for service identification even if other
solutions were applicable.
Table C.5-1 hereafter lists the port numbers assigned to 3GPP since 2009\. In
this table, it can be noticed that most of the applications were for SCTP and
protocols only inside 3GPP networks, without inter-domain interfaces.
Table C.5-1: Service Name/port number assigned to 3GPP since 2009
Service Name Port Number Transport Protocol Description Registration Date
Intra/Inter
* * *
sgsap 29118 sctp SGsAP 11/06/2009 Intra (MME/MSC) sbcap 29168 sctp SBcAP
11/06/2009 Intra (MME/CBC) s102 23272 udp S102 application 26/08/2009 Intra
(1xCS IWS/MME) s1-control 36412 sctp S1-Control Plane 01/09/2009 Intra
(MME/eNB) x2-control 36422 sctp X2-Control Plane 01/09/2009 Intra (eNB/eNB)
iuhsctpassoc 29169 sctp HNBAP and RUA Common Association 08/09/2009 Inter
(HNB/HNB-GW) 3gpp-cbsp 48049 tcp Cell Broadcast Service Protocol 07/12/2009
Intra (BSC/CBC) lcs-ap 9082 sctp LCS Application Protocol 04/06/2010 Intra
(MME/E-SMLC) wlcp 36411 udp Wireless LAN Control plane Protocol (WLCP)
14/11/2014 Intra (UE/TWAG) slmap 36423 sctp SLm Interface Application Protocol
18/06/2015 Intra (E-SMLC/LMU) nq-ap 36424 sctp Nq/Nq\' Application Protocol
18/06/2015 Intra (the RCAF/MME or SGSN) xw-control 36462 sctp Xw-Control Plane
13/11/2015 Intra (eNB/WT) pfcp 8805 udp Destination Port number for PFCP
08/05/2017 Intra (CU/UP) ng-control 38412 sctp NG Control Plane 18/05/2017
Intra (gNB/ng-eNB-AMF) xn-control 38422 sctp Xn Control Plane 18/05/2017 Intra
(gNB-gNB/ng-eNB) f1-control 38472 sctp F1 Control Plane 23/06/2017 Intra
(gNBCU/gNBDU) e1-interface 38462 sctp E1 signalling transport 06/11/2018 Intra
(gNB-CU-CP/gNB-CU-UP) 3gpp-monp 8809 udp MCPTT Off-Network Protocol (MONP)
15/04/2019 Intra (MCPTT client/MCPTT client) 3gpp-w1ap 37472 sctp W1
signalling transport 16/07/2020 Intra (ng-eNB-DU/ng-eNB-CU
Since 2015, IANA had gradually warned 3GPP that a solution should be found to
avoid port assignments for protocols only used in 3GPP. Exceptions were made
at the beginning and the last requests were granted by IESG only at the
conditions that it was the last one(s). Now, it is clear that application for
a new port will not be granted without a strong justification for it, only if
the recommendations given in IETF RFC 7605 [3] have been carefully followed
and it is proved that there is no other solution than port assignment for
service port discovery.
###### ### Annex D: How future port number allocations from IETF/IANA could be
addressed
## D.1 General
LS from IETF on \"LS on port allocation for the W1 interface\" (C4-210144)
clarifies that IETF/IANA will assign only one port number per transport layer
protocol. That is, 3GPP may be granted only 4 port numbers altogether, i.e. a
single port number per/via UDP, TCP, SCTP and DCCP. All new 3GPP application
running on top of e.g. UDP must share this last single port allocated to 3GPP.
The provisions in the LS are challenged, but it will take some time to sort
out the problem.
In order to address the problem, 3GPP members may need to contribute directly
to IETF Transport and Services Area (TSV) WG. There may be a need for
clarifying certain requirements in BCP 165 (RFC6335 [2] and RFC7605 [3]), or
even drafting a new RFC could be considered.
This informative annex could be used as an input for future work on this
problem.
## D.2 Key provisions for the draft RFC
### D.2.1 Introduction
Client-server model relies on two types of server port allocations for various
types of applications:
\- A server is statically assigned a default port number in advance. Both the
server and the client applications implement such default port number, which
means the server is listening to this port. Once a client discovers server\'s
IP address, the client can immediately send the initial message to the server.
\- A server is not assigned statically a default port number at all. Both the
server and the client applications implement specific type of the dynamic port
allocation and discovery. Once the server is up, port number is assigned and
the server starts listening to such port. Once a client discovers server\'s IP
address, the client may also discover also the server\'s dynamically assigned
port. Of not, a separate server port discovery procedure is executed. After
discovering server\'s port, the client can send the initial message to the
server.
It should be noted that for security reasons it is a commonplace operator
practice to use dynamically allocated ports also in cases where the servers do
have default ports assigned. This mitigates possible e.g. DOS attacks.
### D.2.2 Background
There are hundreds of private enterprise entities that are asking IANA/IETF to
assign default server port numbers from the User Port number range
[1024-49151] to the applications, which are specific to the given enterprise.
IANA/IETF apparently needs to carefully consider each case of such requests,
because there is a finite numbers if unassigned port numbers.
3GPP however is one of the largest players in e-communications domain.
Globally, around 80% of the 6.8 billion mobile end users were utilizing 3GPP
networks in 2020, i.e. 5.44 billion. This puts 3GPP users on par with IETF end
users. Around 3.4 billion end users utilized fixed internet access globally in
2020.
For the past 11 years (2009 -- 2020), 3GPP has requested only 19 new port
numbers from IETF/IANA. Therefore, on average 3GPP needs around 2 new ports
per year.
Currently, in the User Port number range [1024-49151] there are more than 36
000 unassigned port numbers, i.e. around 74% of the range is still available.
In addition to that, RFC6335 [2] provides for extending the current port
number range to a much larger space.
Quote from clause 6 in RFC6335 [2]:
Reserved port numbers are not available for regular assignment; they are
\"assigned to IANA\" for special purposes. Reserved port numbers include
values at the edges of each range, e.g., 0, 1023, 1024, etc., which may be
used to extend these ranges or the overall port number space in the future.
### D.2.3 Objectives
Applications that run on top of transport layer protocols, TCP/UDP/SCTP/DCCP
utilize ports to enable IP address sharing. Such applications can be grouped
into two key categories:
A. Dynamically allocated server port numbers meet the requirements of the
applications.
B. Dynamically allocated server port numbers do not meet the requirements of
the applications.
The applications falling into category (B) do require statically allocating
server\'s default port number. Historically, 3GPP is self-constraint and
modest in requesting default port numbers for such applications (2 ports per
year). Therefore, it is reasonable to delegate the allocation of a very small
number of ports to 3GPP. This should decrease administrative work for both
IETF and 3GPP. If IANA/IETF would delegate the management of around 100 ports
to 3GPP from the User Port number range [1024-49151], this would decrease the
overall number of unassigned, i.e. currently available port numbers from this
range by less than 0,3%.
Alternatively, 3GPP should work with IETF/IANA on drafting clear cut rules for
future static port allocations. It is relevant to highlight that RFC6335 [2]
and RFC7605 [3] (BCP 165) already contain guidelines on how to meet port
allocation requirements, but these guidelines are not always completely clear.
### D.2.4 Clarifying BCP 165 guidelines
Annex A, based on the provisions in RFC6335 [2], describes IETF procedures for
port number assignments (\"IETF Review\", \"IESG Approval\" or \"Expert
Review\" processes). 3GPP members should engage more actively in these
processes.
Annex B, based on the provisions in RFC6335 [2] and RFC7605 [3], elaborates
further on the possible solutions that reduce the need for the static port
allocations (see clause B.3).
Below are few conditions that were derived from BCP 165. If either of the blow
conditions are met, 3GPP should not apply for a static port number:
\- If the client can be configured in advance with the server\'s default port
number from any range. This can be achieved and looks feasible in a small
network, which is under a single operator control.
\- If the client already uses dynamic server discovery mechanism via DNS. An
SRV records can be enhanced to also contain the server port number. In this
scenario however it should be carefully studied if the related latency will
impact the end user experience or not.
\- If the client already uses port discovery mechanism, like mDNS.
Considerations for the above DNS solution applies also to mDNS one.
#