# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present specification provides the stage 3 definition of the UE Policy
Control Service (Npcf_UEPolicyControl) of the 5G System.
The stage 2 definition and procedures of UE Policy Control Service are
contained in 3GPP TS 23.502 [3] and 3GPP TS 23.503 [4]. The 5G System
Architecture is defined in 3GPP TS 23.501 [2].
Stage 3 call flows are provided in 3GPP TS 29.513 [7].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition of the 5G System are specified in 3GPP
TS 29.500 [5] and 3GPP TS 29.501 [6].
The UE Policy Control Service is provided by the Policy Control Function
(PCF). This service provides UE policies and N2 PC5 policy.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System;
Stage 2\".
[5] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[6] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[7] 3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows
and QoS parameter mapping; Stage 3\".
[8] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[9] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
Format\".
[10] OpenAPI: \"OpenAPI Specification Version 3.0.0\",
https://spec.openapis.org/oas/v3.0.0.
[11] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces; Stage 3\".
[12] 3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".
[13] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[14] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[15] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[16] 3GPP TS 24.526: \"UE policies for 5G System (5GS); Stage 3\".
[17] 3GPP TS 29.519: \"5G System; Usage of the Unified Data Repository service
for Policy Data, Application Data and Structured Data for Exposure; Stage 3\".
[18] 3GPP TS 32.422: \"Telecommunication management; Subscriber and equipment
trace; Trace control and configuration management\".
[19] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[20] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[21] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[22] 3GPP TR 21.900: \"Technical Specification Group working methods\".
[23] 3GPP TS 23.316: \"Wireless and wireline convergence access support for
the 5G System (5GS)\".
[24] 3GPP TS 24.587: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); Stage 3\".
[25] 3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); User Equipment (UE) policies; Stage 3\".
[26] 3GPP TS 29.505: \"5G System; Usage of the Unified Data Repository service
for Subscription Data; Stage 3\".
[27] 3GPP TS 29.504:\"5G System; Unified Data Repository Services; Stage 3\".
> [28] 3GPP TS 24.554: \"Proximity based services (ProSe) in 5G system (5GS)
> protocol aspects; Stage 3\".
[29] 3GPP TS 24.555: \"Proximity based services (ProSe) in 5G system (5GS);
User Equipment (UE) policies; Stage 3\".
[30] 3GPP TS 29.523: \"5G System; Policy Control Event Exposure Service; Stage
3\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5G-BRG 5G Broadband Residential Gateway
5G-CRG 5G Cable Residential Gateway
5G-RG 5G Residential Gateway
5G-VN 5G Virtual Network
AMF Access and Mobility Management Function
ANDSP Access Network Discovery and Selection Policy
API Application Programming Interface
DNN Data Network Name
FN-RG Fixed Network Residential Gateway
FN-BRG Fixed Network Broadband Residential Gateway
FN-CRG Fixed Network Cable Residential Gateway
FQDN Fully Qualified Domain Name
GPSI Generic Public Subscription Identifier
GUAMI Globally Unique AMF Identifier
HFC Hybrid Fiber-Coaxial
HTTP Hypertext Transfer Protocol
H-PCF Home Policy Control Function
JSON JavaScript Object Notation
N3AN Non-3GPP access network
NID Network Identifier
NF Network Function
NRF Network Repository Function
NSWO Non-Seamless WLAN Offload
OS Operating System
OSId Operating System Identity
PCF Policy Control Function
PEI Permanent Equipment Identifier
PRA Presence Reporting Area
> ProSeP 5G ProSe Policy
PTI Procedure Transaction Identity.
RSN Redundancy Sequence Number
SNPN Stand-alone Non-Public Network
SUPI Subscription Permanent Identifier
UDR Unified Data Repository
UPSC UE policy section code
UPSI UE policy section identifier
URSP UE Route Selection Policy
V2X Vehicle-to-Everything
V2XP Vehicle-to-Everything Policy
V-PCF Visited Policy Control Function
W-5GAN Wireline 5G Access Network
W-5GCAN Wireline 5G Cable Access Network
W-AGF Wireline Access Gateway Function
# 4 UE Policy Control Service
## 4.1 Service Description
### 4.1.1 Overview
The UE Policy Control Service, as defined in 3GPP TS 23.502 [3] and 3GPP TS
23.503 [4], is provided by the Policy Control Function (PCF).
This service is used as part of the provisioning of UE policies (e.g. ANDSP,
URSP, V2XP, ProSeP) determined by the PCF to the UE via the AMF and as part of
the provisioning of N2 PC5 policy for V2X communications and/or 5G ProSe
determined by the PCF to the NG-RAN via the AMF. This service hence offers the
following functionalities:
\- creation of a UE Policy Association as requested by the NF service consumer
(e.g. AMF);
\- provisioning of policy control request trigger(s) to the NF service
consumer (e.g. AMF);
\- provisioning of the UE policy (e.g. ANDSP, URSP, V2XP, ProSeP) to the V-PCF
by the H-PCF in the roaming case;
\- provisioning of the N2 PC5 policy for V2X communications and/or 5G ProSe to
the V-PCF by the H-PCF in the roaming case;
\- update of a UE Policy Association as requested by the NF service consumer
(e.g. AMF);
\- reporting of the met policy control request trigger(s) by the NF service
consumer;
\- update of policy control request trigger(s) by the PCF to the NF service
consumer (e.g. AMF);
\- deletion of a UE Policy Association as requested by the NF service consumer
(e.g. AMF); and
\- enable the PCF to request the termination of a UE Policy Association to the
NF service consumer (e.g. AMF).
### 4.1.2 Service Architecture
The 5G System Architecture is defined in 3GPP TS 23.501 [2]. The Policy and
Charging related 5G architecture is also described in 3GPP TS 29.513 [7].
The UE Policy Control Service (Npcf_UEPolicyControl) is part of the Npcf
service-based interface exhibited by the Policy Control Function (PCF).
The known NF service consumers of the Npcf_UEPolicyControl service are the
Access and Mobility Management Function (AMF) and the Visited Policy Control
Function (V-PCF).
The AMF accesses the UE Policy Control Service at the PCF via the N15
Reference point. In the roaming scenario, the N15 reference point is located
between the V-PCF in the visited network and the AMF. The V-PCF accesses the
UE Policy Control Service at the Home Policy Control Function (H-PCF) via the
N24 Reference point.
Figure 4.1.2-1: Reference Architecture for the Npcf_UEPolicyControl Service;
SBI representation
Figure 4.1.2-2: Non-roaming Reference Architecture for the
Npcf_UEPolicyControlService; reference point representation
Figure 4.1.3-2: Roaming reference Architecture for the
Npcf_UEPolicyControlService; reference point representation
### 4.1.3 Network Functions
#### 4.1.3.1 Policy Control Function (PCF)
For non-roaming scenarios, the Policy Control Function (PCF):
\- supports unified policy framework to govern network behaviour;
\- provides UE policy, including Access Network Discovery and Selection Policy
(ANDSP), UE Route Selection Policy (URSP), V2XP (Vehicle-to-Everything Policy)
and/or 5G ProSe Policy (ProSeP) via the AMF transparently to the UE;
\- provides policy control request trigger(s) to the AMF; and
NOTE 1: The PCF invokes the Namf_Communication service specified in 3GPP TS
29.518 [14] to provide the UE Policy.
\- provides N2 PC5 policy, containing the PC5 QoS parameters used by NG-RAN
for V2X communications and/or 5G ProSe via the AMF to the NG-RAN.
NOTE 2: The PCF invokes the Namf_Communication service specified in 3GPP TS
29.518 [14] to provide the N2 PC5 Policy for V2X communications and/or 5G
ProSe.
For roaming scenarios, the Visited Policy Control Function (V-PCF):
\- provides policy control request trigger(s) to the AMF;
\- provides the ANDSP of the VPLMN via the AMF transparently to the UE;
\- forwards the ANDSP, URSP, V2XP and/or ProSeP received from the H-PCF via
the AMF to the UE; and
NOTE 3: The V-PCF invokes the Namf_Communication service specified in 3GPP TS
29.518 [14] to provide the UE Policy.
\- forwards the N2 PC5 policy for V2X communications and/or 5G ProSe received
from the H-PCF via the AMF to the NG-RAN.
NOTE 4: The V-PCF invokes the Namf_Communication service specified in 3GPP TS
29.518 [14] to provide the N2 PC5 Policy for V2X communications and/or 5G
ProSe.
For roaming scenarios, the Home Policy Control Function (H-PCF):
\- provides policy control request trigger(s) to the V-PCF;
\- provides the UE policy (e.g. ANDSP, URSP, V2XP, or ProSeP) of the HPLMN to
the V-PCF for forwarding to the UE via the the AMF; and
\- provides the N2 PC5 policy for V2X communications and/or 5G ProSe to the
V-PCF for forwarding to the NG-RAN via the AMF.
#### 4.1.3.2 NF Service Consumers
The known NF service consumers of the Npcf_UEPolicyControl are the AMF, and in
the roaming case, the V-PCF.
The Access and Mobility Management function (AMF) performs:
\- registration management;
\- connection management;
\- reachability management;
\- mobility Management;
\- forwarding of UE Policy towards the served UE;
\- reporting of the UE state to the (V-)PCF;
\- forwarding of the UE policy enforcement result received from the UE to the
(V-)PCF; and
NOTE: The AMF invokes the Namf_Communication service specified in 3GPP TS
29.518 [14] to report the UE policy enforcement result.
\- forwarding of the N2 PC5 policy for V2X communications and/or 5G ProSe
towards the NG-RAN.
The Visited Policy Control Function (V-PCF) provides the functions described
in clause 4.1.3.1 towards the visited network as NF service producer and acts
as NF Service consumer toward the H-PCF, performing the following functions:
\- receiving policy control request trigger(s) and/or UE policy (e.g. ANDSP,
URSP, V2XP, ProSeP) from the H-PCF;
\- receiving the N2 PC5 policy for V2X communications and/or 5G ProSe from the
H-PCF; and
\- reporting of the UE state and UE policy enforcement result to the H-PCF.
## 4.2 Service Operations
### 4.2.1 Introduction
Table 4.2.1-1: Operations of the Npcf_UEPolicyControl Service
+----------------------+----------------------+----------------------+ | Service operation | Description | Initiated by | | name | | | +----------------------+----------------------+----------------------+ | Npcf_UEP | Creates a UE Policy | NF service consumer | | olicyControl_Create | Association. | (e.g. AMF, V-PCF in | | | | roaming case) | +----------------------+----------------------+----------------------+ | Npcf_UEP | Updates a UE Policy | NF service consumer | | olicyControl_Update | Association and | (e.g. AMF, V-PCF in | | | provides the | roaming case) | | | corresponding | | | | policies to the NF | | | | service consumer | | | | when policy control | | | | request trigger(s) | | | | is/are met or the | | | | AMF is relocated due | | | | to the UE mobility | | | | and the old PCF is | | | | selected. | | +----------------------+----------------------+----------------------+ | Npcf_UEPolicyC | > \- Provides the | PCF (H-PCF and V-PCF | | ontrol_UpdateNotify | > updated policy | in roaming case) | | | > control request | | | | > trigger(s) to the | | | | > AMF by the (V-)PCF | | | | > in the non-roaming | | | | > or roaming case; | | | | > | | | | > \- Provides the | | | | > updated UE policy | | | | > and/or policy | | | | > control request | | | | > trigger(s) to the | | | | > V-PCF by the | | | | > H-PCF; or | | | | > | | | | > \- Initiates the | | | | > UE Policy | | | | > association | | | | > termination | | | | > towards the NF | | | | > service consumer | | | | > by the NF service | | | | > producer. | | +----------------------+----------------------+----------------------+ | Npcf_UEP | Provides means for | NF service consumer | | olicyControl_Delete | the NF service | (e.g. AMF, V-PCF in | | | consumer to delete a | roaming case) | | | UE Policy | | | | Association. | | +----------------------+----------------------+----------------------+
### 4.2.2 Npcf_UEPolicyControl_Create Service Operation
#### 4.2.2.1 General
The procedure in the present clause is applicable when the NF service consumer
creates a UE policy association in the following cases:
\- UE performs initial registration to the network, as defined in clause
5.5.1.2.2 of 3GPP TS 24.501 [15];
\- UE performs a mobility registration, if the UE operating in single-
registration mode performs inter-system change from S1 mode to N1 mode, as
defined in clause 5.5.1.3.2 of 3GPP TS 24.501 [15], and there is no existing
UE Policy Association between AMF and PCF for this UE; and
\- the AMF is relocated (between the different AMF sets) and the new AMF
selects a new PCF. The procedure for the case where the AMF is relocated and
the new AMF selects the old PCF is defined in clause 4.2.3.1.
The creation of a UE policy association only applies for normally registered
UEs, i.e. it does not apply for emergency-registered UEs.
Figure 4.2.2.1-1 illustrates the procedure used for the creation of a policy
association.
Figure 4.2.2.1-1: Creation of a UE policy association
NOTE 1: For the roaming scenario, the PCF represents the V-PCF, if the NF
service consumer is an AMF, and the PCF represents the H-PCF, if the NF
service consumer is a V-PCF.
When a UE registers to the network and a UE context is being established, if
the AMF obtains from the UE a UE policy delivery protocol message as defined
in Annex D of 3GPP TS 24.501 [15] and/or the authorized PC5 capability for 5G
ProSe, and/or the authorized PC5 capability for V2X communications, the AMF
shall establish a UE policy association with the (V-)PCF, in case there is no
existing UE policy association for the UE; otherwise, the AMF may establish a
UE Policy Association with the (V-)PCF based on AMF local configuration.
NOTE 2: In the roaming scenario, the visited AMF\'s local configuration can
indicate whether UE Policy delivery is needed based on the roaming agreement
with the home PLMN of the UE.
To establish a UE policy association with the PCF, the NF service consumer
(e.g. AMF) shall send an HTTP POST request with \"{apiRoot}/npcf-ue-policy-
control/v1/policies\" as Resource URI and the PolicyAssociationRequest data
structure as request body, which shall include:
\- the Notification URI encoded as \"notificationUri\" attribute;
\- the SUPI encoded as \"supi\" attribute; and
\- the features supported by the NF service consumer encoded as \"suppFeat\"
attribute,
shall also include, when available:
\- the GPSI encoded as \"gpsi\" attribute;
\- the Access type encoded as \"accessType\" attribute;
NOTE 3: In this Release, for SNPN-enabled UE registered in the SNPN, direct
access to the SNPN is specified for 3GPP access only.
\- the Permanent Equipment Identifier (PEI) encoded as \"pei\" attribute;
\- the User Location Information encoded as \"userLoc\" attribute;
\- the UE Time Zone encoded as \"timeZone\" attribute;
\- the identifier of the serving network (the PLMN Identifier or the SNPN
Identifier), encoded as \"servingPlmn\" attribute;
NOTE 4: The SNPN Identifier consists of the PLMN Identifier and the NID.
\- the RAT type encoded as \"ratType\" attribute;
\- the received UE policy delivery protocol message defined in Annex D of 3GPP
TS 24.501 [15] encoded as \"uePolReq\" attribute;
\- for the roaming scenario, if the NF service consumer is an AMF, the H-PCF
ID encoded as \"hPcfId\" attribute;
\- the Internal Group Identifier(s) encoded as \"groupIds\" attribute;
> \- the PC5 capability for V2X encoded as \"pc5Capab\" attribute if the
> \"V2X\" feature defined in clause 5.8 is supported;
\- the 5G ProSe capability within the \"proSeCapab\" attribute, if the
\"ProSe\" feature defined in clause 5.8 is supported;
\- if the NF service consumer is an AMF, the GUAMI encoded as \"guami\"
attribute; and
\- if the NF service consumer is an AMF, the serving AMF Id encoded as
\"servingNfId\" attribute.
and may include:
\- if the NF service consumer is an AMF, the name of a service produced by the
AMF that expects to receive information via the
Npcf_UEPolicyControl_UpdateNotify service operation encoded as \"serviceName\"
attribute;
\- if the NF service consumer is an AMF, the alternate or backup IPv4
Address(es) where to send Notifications encoded as \"altNotifIpv4Addrs\"
attribute;
\- if the NF service consumer is an AMF, the alternate or backup IPv6
Address(es) where to send Notifications encoded as \"altNotifIpv6Addrs\"
attribute; and
\- if the NF service consumer is an AMF, the alternate or backup FQDN(s) where
to send Notifications encoded as \"altNotifFqdns\" attribute.
Upon the reception of the HTTP POST request,
\- the (V-)(H-)PCF shall assign a UE policy association ID;
\- for the roaming scenario and based on operator policy, the V-PCF (as the NF
service consumer) should send to the H-PCF a request for the Creation of a UE
policy association as described in the present clause;
\- the (V-)(H-)PCF shall determine the applicable UE policy as detailed in
clause 4.2.2.2. For the V-PCF, any policy received from the H-PCF in the reply
to the possible request for the Creation of a policy association should be
taken into consideration;
\- if the (V-)PCF determines that UE policy needs to be provisioned, it shall
use the Namf_Communication service specified in 3GPP TS 29.518 [14] to
provision the UE policy according to clause 4.2.2.2 and as follows:
(i) the (V-)PCF shall subscribe to the AMF to notifications on N1 messages for
UE Policy Delivery Results using the Namf_Communication_N1N2MessageSubscribe
service operation;
(ii) the (V-)PCF shall send the determined UE policy (e.g. ANDSP, URSP, V2XP,
ProSeP) using Namf_Communication_N1N2MessageTransfer service operation(s); and
(iii) the (V-)PCF shall be prepared to receive UE Policy Delivery Results from
the AMF and/or subsequent UE policy requests (e.g. for V2XP and/or ProSeP)
within the Namf_Communication_N1MessageNotify service operation. For the
V-PCF, if the received UE Policy Delivery results relate to UE policy sections
provided by the H-PCF, the V-PCF shall use the Npcf_UEPolicyControl_Update
Service Operation defined in clause 4.2.3 to send those UE Policy Delivery
results to the H-PCF;
\- if the UE indicates the support of V2X communications over PC5 reference
point and the \"V2X\" feature is supported, the (H-)PCF shall determine the
applicable V2XP, as detailed in clause 4.2.2.2.1.2, and V2X N2 PC5 policy, as
detailed in clause 4.2.2.3 and based on the operator\'s policy;
\- if the UE indicates the support of 5G ProSe and the \"ProSe\" feature is
supported, the (H-)PCF shall determine the applicable ProSeP, as detailed in
clause 4.2.2.2.1.3, and 5G ProSe N2 PC5 policy, as detailed in clause 4.2.2.4
and based on the operator\'s policy;
\- if the PCF determines that N2 PC5 policy (e.g. for V2X communications, for
5G ProSe) needs to be provisioned, including the case of the V-PCF when
receiving the N2 PC5 policy from the H-PCF, the PCF shall use the
Namf_Communication service specified in 3GPP TS 29.518 [14] to provision the
N2 PC5 policy according to clause 4.2.2.3 and/or clause 4.2.2.4;
\- for the successfull case, the (V-)(H-)PCF shall send a HTTP \"201 Created\"
response with the URI for the created resource in the \"Location\" header
field.
NOTE 5: The assigned policy association ID is part of the URI for the created
resource and is thus associated with the SUPI.
and the PolicyAssociation data type as response body, including:
\- mandatorilly, the negotiated supported features encoded as \"suppFeat\"
attribute;
\- optionally, the information provided by the NF service consumer when
requesting the creation of this policy association encoded as \"request\"
attribute;
\- optionally, for the H-PCF as service producer communicating with the V-PCF,
UE policy (see clause 4.2.2.2) encoded as \"uePolicy\" attribute;
\- optionally, for the H-PCF as service producer communicating with the V-PCF,
N2 PC5 policy (see clause 4.2.2.3 and/or clause 4.2.2.4) encoded as
\"n2Pc5Pol\" attribute (for V2X communications) and/or \"n2Pc5ProSePol\"
attribute (for 5G ProSe);
\- optionally, one or several of the following Policy Control Request
Trigger(s) encoded as \"triggers\" attribute (see clause 4.2.3.2):
a) Location change (tracking area);
b) Change of UE presence in PRA;
c) Change of PLMN, if the \"PlmnChange\" feature is supported; and
d) Change of UE connectivity state, if the \"ConnectivityStateChange\" feature
is supported; and
\- if the Policy Control Request Trigger \"Change of UE presence in PRA\" is
provided, the presence reporting areas for which reporting is required encoded
as \"pras\" attribute; and
NOTE 4: If the PCF uses a Presence Reporting Area identifier referring to a
Set of Core Network predefined Presence Reporting Areas as defined in 3GPP TS
23.501 [2], the PCF includes the identifier of this Presence Reporting Area
set within the \"praId\" attribute.
\- if errors occur when processing the HTTP POST request, the (V-)(H-)PCF
shall apply error handling procedures as specified in clause 5.7 and according
to the following provisions:
\- if the user information received within the \"supi\" attribute is unknown,
the (V-)(H-)PCF shall reject the request and include in an HTTP \"400 Bad
Request\" response message the \"cause\" attribute of the ProblemDetails data
structure set to \"USER_UNKNOWN\"; and
\- if the (V-)(H-)PCF is, due to incomplete, erroneous or missing information
in the request, not able to provision a UE policy decision, the (V-)(H-)PCF
may reject the request and include in an HTTP \"400 Bad Request\" response
message the \"cause\" attribute of the ProblemDetails data structure set to
\"ERROR_REQUEST_PARAMETERS\".
If the (V-)PCF received a GUAMI, the (V-)PCF may subscribe to GUAMI changes
using the AMFStatusChange service operation of the Namf_Communication service
specified in 3GPP TS 29.518 [14], and it may use the Nnrf_NFDiscovery Service
specified in 3GPP TS 29.510 [13] (using the obtained GUAMI and possibly
service name) to query the other AMFs within the AMF (service) set.
#### 4.2.2.2 UE Policy
##### 4.2.2.2.1 Overview
##### 4.2.2.2.1.0 General {#general-1 .H6}
The UE policy consists of
\- UE Access Network discovery and selection policies (ANDSP). It is used by
the UE for selecting non-3GPP accesses networks. The encoding of ANDSP is
defined in 3GPP TS 24.526 [16];
\- UE Route Selection Policy (URSP). This UE policy is used by the UE to
determine how to route outgoing traffic. Traffic can be routed to an
established PDU Session, offloaded to non-3GPP access outside a PDU Session,
can be routed via a ProSe Layer-3 UE-to-Network Relay outside a PDU session or
trigger the establishment of a new PDU Session. The encoding of URSP is
defined in 3GPP TS 24.526 [16];
> \- UE Vehicle-to-Everything Policy (V2XP). This UE policy provides
> configuration information to the UE for V2X communications over PC5
> reference point or over Uu reference point or both. The encoding of V2XP is
> defined in 3GPP TS 24.588 [25]; and
\- UE 5G Proximity based Services Policy (ProSeP). This UE policy provides
configuration information to the UE for 5G ProSe direct discovery, 5G ProSe
direct communications, 5G ProSe UE-to-network relay and/or 5G ProSe usage
reporting configuration and rules.
The UE Policy is transferred to the UE using the UE policy delivery protocol
defined in Annex D of 3GPP TS 24.501 [15]. The (V-)(H-)PCF shall send UE
policy using the \"MANAGE UE POLICY COMMAND\" message and will receive the
\"MANAGE UE POLICY COMPLETE\"or the \"MANAGE UE POLICY COMMAND REJECT\"
messages in the response. Those messages are transparently forwarded by the
AMF.
The (V-)PCF shall use the Namf_Communication_N1N2MessageTransfer service
operation defined in clause 5.2.2.3.1 of 3GPP TS 29.518 [14] to send \"MANAGE
UE POLICY COMMAND\" messages to the UE and use the
Namf_Communication_N1MessageNotify service operation defined in clause
5.2.2.3.5 of 3GPP TS 29.518 [14] to receive \"MANAGE UE POLICY COMPLETE\" and
\"MANAGE UE POLICY COMMAND REJECT\" messages from the UE. The (V-)PCF shall
only send \"MANAGE UE POLICY COMMAND\" messages below a predefined size limit.
The H-PCF shall use service operations as defined in the present specification
to receive \"MANAGE UE POLICY COMPLETE\" and \"MANAGE UE POLICY COMMAND
REJECT\" messages from the V-PCF and to send MANAGE UE POLICY COMMAND\"
messages to the V-PCF. The H-PCF shall encode the \"MANAGE UE POLICY COMMAND\"
message in a \"uePolicy\" attribute. The H-PCF shall only send \"MANAGE UE
POLICY COMMAND\" messages below a predefined size limit.
The (V-)(H-)PCF may deliver the UE policy to the UE in several \"MANAGE UE
POLICY COMMAND\" messages.
For the purpose of such fragmented delivery and subsequent partial updates of
UE policies, the UE policy is divided into policy sections. Such policy
sections may be predefined in the (V-)(H-)PCF, may be retrieved by the
(V-)(H-)PCF from the UDR as specified in 3GPP TS 29.519 [17], or may be
dynamically generated by the (V-)(H-)PCF, but shall comply to the rules
detailed below. The (V-)(H-)PCF may combine several policy sections into one
\"MANAGE UE POLICY COMMAND\" message, if the predefined size limit is
observed.
The following rules apply to policy sections:
\- The size shall be below the predefined size limit.
\- The policy section shall only contain complete URSP rule(s), WLANSP
rule(s), N3AN node configuration information, V2XP and/or ProSeP info content,
but no fractions of such rules, configuration information, or info contents.
\- To ease a subsequent partial update of UE policies, policy sections should
only contain a small number of policies, e.g. URSP rule(s), and/or WLANSP
rule(s).
\- The entire content of a policy section shall be provided by a single PLMN.
A PCF shall only determine policy sections of its own PLMN. However, a V-PCF
may forward UE policy sections received from the H-PCF to the UE.
Each UE policy section is identified by a UE policy section identifier (UPSI).
The UPSI is composed of two parts:
a) a PLMN ID part containing the PLMN ID of the PLMN or SNPN of the PCF which
provides the UE policies; and
b) a UE policy section code (UPSC) containing a unique value within the PLMN
or SNPN selected by the PCF.
NOTE 1: When the UE is operating in SNPN access operation mode, the UE
associates the PLMN ID with the NID of the SNPN to differentiate between PLMN
UPSI(s) and SNPN UPSI(s).
The (V-)(H-)PCF provides an UPSI when providing a new UE policy section and
may then identify that policy section using that UPSI when requesting that
that UE policy section is modified or deleted, as specified in Annex D of 3GPP
TS 24.501 [15].
If the (V-)(H-)PCF determines that changes are required and/or the V-PCF
receives possible new or modified policy sections determined by the H-PCF in
the roaming case, it shall send the determined new, updated or deleted policy
sections using one or several \"MANAGE UE POLICY COMMAND\" messages towards
the NF service consumer. In the roaming case, the V-PCF may either combine
policy sections received from the H-PCF and policy sections the V-PCF selected
in the same \"MANAGE UE POLICY COMMAND\" (as long as the predefined size limit
is observed), or use separate \"MANAGE UE POLICY COMMAND\" messages; however,
the V-PCF shall not distribute the policy sections received in one \"MANAGE UE
POLICY COMMAND\" from the H-PCF into several \"MANAGE UE POLICY COMMAND\"
messages as long as the predefined size limit is observed for the policy
sections received from the H-PCF. The V-PCF shall allocate a new PTI for the
\"MANAGE UE POLICY COMMAND\" sent by the V-PCF and store the mapping between
the new PTI and the PTI within the \"MANAGE UE POLICY COMMAND\" received from
the H-PCF.
After sending a \"MANAGE UE POLICY COMMAND\" messages, the (V-)(H-)PCF shall
wait for a related confirmation in a \"MANAGE UE POLICY COMPLETE\" messages or
failure indication in a \"MANAGE UE POLICY COMMAND REJECT\" message. When
receiving no such message until the expiry of a supervision timer specified in
Annex D of 3GPP TS 24.501 [15], or when receiving a failure indication, the
PCF should re-send related instructions for the policy sections. In the
roaming case, the H-PCF and the V-PCF shall each be responsible for resending
those policy sections that it originally supplied. In the case that the V-PCF
combined policy sections received from the H-PCF and policy sections the V-PCF
selected in the same \"MANAGE UE POLICY COMMAND\" described below, the V-PCF
shall wait for the H-PCF to resend the policy sections of HPLMN, and then
resend the combined policy sections. The (V-)(H-)PCF shall always include the
initially supplied policy sections when resending the UE policy.
The (V-)(H-)PCF shall determine that a received \"MANAGE UE POLICY COMPLETE\"
message or \"MANAGE UE POLICY COMMAND REJECT\" message is related to the
result of a \"MANAGE UE POLICY COMMAND\" based on the PTI within that message.
In the roaming case, the V-PCF shall determine that the received message is
related to the result of the UE policy provided by the H-PCF if the PTI within
the message belongs to one of the stored PTI mapping(s).
If the V-PCF combined policy sections received from the H-PCF and policy
sections the V-PCF selected in the same \"MANAGE UE POLICY COMMAND\", upon
reception of a \"MANAGE UE POLICY COMPLETE\" message or \"MANAGE UE POLICY
COMMAND REJECT\" message the V-PCF shall:
\- forward the corresponding \"MANAGE UE POLICY COMPLETE\" message to the
H-PCF;
\- if a \"MANAGE UE POLICY COMMAND REJECT\" message with UPSI(s) of the HPLMN
is received, forward the parts of the \"MANAGE UE POLICY COMMAND REJECT\"
message that relate to the UPSI(s) of the HPLMN to the H-PCF;
\- if a \"MANAGE UE POLICY COMMAND REJECT\" message without UPSI(s) of the
HPLMN is received, send a \"MANAGE UE POLICY COMPLETE\" message to the H-PCF;
and
\- provide the stored PTI received from the HPLMN in the corresponding
\"MANAGE UE POLICY COMMAND\" within the \"MANAGE UE POLICY COMPLETE\" message
or \"MANAGE UE POLICY COMMAND REJECT\" message towards the H-PCF.
If the V-PCF sent a separate \"MANAGE UE POLICY COMMAND\" containing only the
policy sections received from the H-PCF, the V-PCF shall forward the
corresponding \"MANAGE UE POLICY COMPLETE\" or \"MANAGE UE POLICY COMMAND
REJECT\" message to the H-PCF and provide the stored PTI received from the
HPLMN in the corresponding \"MANAGE UE POLICY COMMAND\" within the \"MANAGE UE
POLICY COMPLETE\" message or \"MANAGE UE POLICY COMMAND REJECT\" message
towards the H-PCF.If the V-PCF distributed the policy sections received in one
\"MANAGE UE POLICY COMMAND\" from the H-PCF into several \"MANAGE UE POLICY
COMMAND\" messages to the UE (because the predefined size limit of the VPLMN
was exceeded), the V-PCF shall aggregate all corresponding \"MANAGE UE POLICY
COMPLETE\" or \"MANAGE UE POLICY COMMAND REJECT\" messages received from the
UE into one \"MANAGE UE POLICY COMPLETE\" or \"MANAGE UE POLICY COMMAND
REJECT\" message towards the H-PCF.
When the (V-)PCF receives an Namf_Communication_N1N2MessageTransfer failure
response as defined in clause 5.2.2.3.1.2 of 3GPP TS 29.518 [14], or an N1N2
Transfer Failure Notification as defined in clause 5.2.2.3.2 of 3GPP TS 29.518
[14], the (V-)PCF shall stop the supervision timer specified in Annex D of
3GPP TS 24.501 [15] corresponding to the affected PTIs. For the N1N2 Transfer
Failure Notification case, the (V-)PCF determines the affected PTIs allocated
by the V-PCF based on the resource URI within the \"n1n2MsgDataUri\" attribute
of the N1N2MsgTxfrFailureNotification data structure as defined in clause
6.1.6.2.30 of 3GPP TS 29.518 [14].
NOTE 2: The (V-)PCF correlates the Namf_Communication_N1N2MessageTransfer
request and the corresponding N1N2 Transfer Failure Notification based on the
resource URI within the \"Location\" header included in the response HTTP
status code \"202 Accepted\" of the Namf_Communication_N1N2MessageTransfer
response and the resource URI within the \"n1n2MsgDataUri\" attribute of and
N1N2 Transfer Failure Notification. And then the V-PCF determines the affected
PTIs related with the resource URI.
For the roaming case and if the V-PCF determines that the affected UE policy
is related with the UE policy delivered by the H-PCF, the V-PCF shall send a
POST message as defined in clause 4.2.3.1 to notify the H-PCF of the failure
of UE policy transfer by including the \"uePolTransFailNotif\" attribute
within the PolicyAssociationUpdateRequest data structure. Within the
UePolicyTransferFailureNotification data structure, the V-PCF shall include
the cause of the UE Policy Transfer Failure within the \"cause\" attribute and
the PTI(s) allocated by the H-PCF corresponding to the PTI(s) allocated by the
V-PCF within the \"ptis\" attribute. The H-PCF shall stop the supervision
timer corresponding to the affected PTIs.
In the failure case described above, the (H-)(V-)PCF may provision the policy
control request trigger \"CON_STATE_CH\" if not provisioned yet. Upon
receiving the notification of UE connectivity state change indicating that the
UE enters the CM-Connected state, the (H-)(V-)PCF may retry to deliver the UE
Policy.
When the (H-)PCF receives the \"MANAGE UE POLICY COMPLETE\" or the \"MANAGE UE
POLICY COMMAND REJECT\" message and determines that this message indicates a
UE Policy Delivery outcome to which an NF service consumer has subscribed via
a request for service specific parameters, the (H-)PCF shall invoke the
Npcf_EventExposure_Notify service operation as defined in clause 4.2.4.2 of
3GPP TS 29.523 [30].
###### 4.2.2.2.1.1 Provisioning of the UE Access Network discovery and
selection policies and UE Route Selection Policy
During Initial Registration and 5GS Registration during UE mobility from EPS
to 5GS, and when the UE has one or more stored UE policy sections
corresponding to the serving PLMN/SNPN or HPLMN, the UE includes the \"UE
STATE INDICATION\" message as defined in clause D.5.4.1 of 3GPP TS 24.501 [15]
, whichis transferred transparently by the AMF within the \"uePolReq\"
attribute during the creation of a policy association, as described in clause
4.2.2.1.
The (H-)PCF, or the PCF of the SNPN for the UEs subscribed to the SNPN, may
store in the UDR, as specified in 3GPP TS 29.519 [17]:
a) UPSCs and related UE policy sections of the own PLMN or SNPN it provided to
a UE;
b) the PEI received from the NF service consumer (e.g. AMF), if available;
c) the OSId(s) received from the UE within the \"UE STATE INDICATION\" message
as described in the Annex D of 3GPP TS 24.501 [15], if available; and
d) the indication of UE\'s support for ANDSP included in the \"UE STATE
INDICATION\" message as described in the Annex D of 3GPP TS 24.501 [15], if
available.
The PCF shall retrieve from UDR the information previously stored in UDR, if
not locally available, for URSP/ANDSP rule determination as specified in 3GPP
TS 29.519 [17].
The V-PCF may retrieve UPSCs and related UE policy sections applicable for all
UEs from a HPLMN from the V-UDR, using the HPLMN ID as key as specified in
3GPP TS 29.519 [17]. The PCF of the serving SNPN has locally configured the
UPSCs and related UE policy sections applicable for all UEs other than the UEs
subscribed to the SNPN.
When receiving the \"UE STATE INDICATION\" message, the (V-)(H-)PCF or the PCF
of the serving SNPN, shall determine, based on the UPSIs, the ANDSP support
indication and the OSId(s) indicated in that message, if available, the UE
Policy Sections and UPSCs stored in the UDR, if available, the policy
subscription data, if available, application data, if available, and local
policy, as specified in clauses 4.2.2.2.2 and 4.2.2.2.3, whether any new UE
policy section(s) need to be installed and whether any existing UE policy
section(s) need to be updated or deleted.
###### 4.2.2.2.1.2 Provisioning of Vehicle-to-Everything Policy
When the UE registers to the network, if the AMF receives from the UE the PC5
capability for V2X communications in the Registration Request message, the UE
is authorized to use V2X service based on the UE\'s subscription information
and the \"V2X\" feature is supported, the AMF further reports to the PCF the
PC5 capability for V2X communications within the \"pc5Capab\" attribute as
defined in clause 4.2.2.1. The PCF may determine the V2XP over PC5 interface
based on the received UE\'s PC5 capability for V2X, the Service specific
parameter information retrieved from UE\'s Application Data in the UDR as
defined in clause 6.2.15 of 3GPP TS 29.519 [17] and the operator\'s policy.
After UE registration, if the UE supports V2X communication and it does not
have valid V2XP, the UE includes the \"UE POLICY PROVISIONING REQUEST\"
message as defined in 3GPP TS 24.587 [24] during the NAS transport procedure.
The PCF may reject the request by sending back a \"UE POLICY PROVISIONING
REJECT\" message as defined in clause 7.2.2 of 3GPP TS 24.587 [24] or
provision the policy, as defined in clause 4.2.2.2.1, based on the service
specific parameter information retrieved from UE\'s Application Data in the
UDR as defined in clause 6.2.15 of 3GPP TS 29.519 [17] and the operator\'s
policy.
For both scenarios mentioned above, in the roaming case, the H-PCF may include
the V2XP within the \"uePolicy\" attribute in the policy association create or
update response to the V-PCF and in the policy association update request
initiated by the H-PCF.
In the roaming or non-roaming case, the (V-)PCF shall use the
Namf_Communication_N1N2MessageTransfer service operation defined in clause
5.2.2.3.1 of 3GPP TS 29.518 [14] to send the V2XP to the UE.
###### 4.2.2.2.1.3 Provisioning of ProSe Policy
When the UE registers to the network and the UE supports 5G ProSe, if the AMF
receives from the UE the 5G ProSe Capability in the Registration Request
message, the UE is authorized to use 5G ProSe service based on the UE\'s
subscription information and the \"ProSe\" feature defined in clause 5.8 is
supported, the AMF further reports to the PCF this 5G ProSe Capability of the
UE within the \"proSeCapab\" attribute, as per the procedures defined in
clause 4.2.2.1. When the UE disables/enables a 5G ProSe capability, the AMF
further reports to the PCF the updated 5G ProSe capabilities of the UE within
the \"proSeCapab\" attribute, as per the procedures defined in clause 4.2.3.1.
The PCF may determine the support of 5G ProSe based on the received UE\'s 5G
ProSe Capability, the service specific parameter information retrieved from
the UE\'s Application Data in the UDR as defined in clause 6.2.15 of 3GPP TS
29.519 [17] and the operator\'s policy.
After UE registration, if the UE does not have valid ProSeP, the UE includes a
\"UE POLICY PROVISIONING REQUEST\" message defined in clause 7.2.1.1 of 3GPP
TS 24.554 [28] during theNAS transport procedure. The PCF may either reject
the request by sending back a \"UE POLICY PROVISIONING REJECT\" message
defined in clause 7.2.2.1 of 3GPP TS 24.587 [24] or provision the policy, as
defined in clause 4.2.2.2.1, based on the service specific parameter
information retrieved from the UE\'s Application Data in the UDR as defined in
clause 6.2.15 of 3GPP TS 29.519 [17] and the operator\'s policy.
For both scenarios mentioned above, in the roaming case, the H-PCF may include
the ProSeP within the \"uePolicy\" attribute in the policy association create
and update response to the V-PCF and in the policy association update request
initiated by the H-PCF.
In the roaming or non-roaming case, the (V-)PCF shall use the
Namf_Communication_N1N2MessageTransfer service operation defined in clause
5.2.2.3.1 of 3GPP TS 29.518 [14] to send the ProSeP to the UE.
##### 4.2.2.2.2 UE Access Network discovery and selection policies (ANDSP)
UE Access Network discovery and selection policies are used by the UE to
select non-3GPP accesses and to decide how to route traffic between the
selected 3GPP and non 3GPP accesses.
In this release of the specification, the Access Network Discovery & Selection
policy shall contain only rules that aid the UE in selecting a WLAN access
network. Rules for selecting other types of non-3GPP access networks are not
specified.
The WLAN access network selected by the UE with the use of Access Network
Discovery & Selection policy may be used for direct traffic offload (i.e.
sending traffic to the WLAN outside of a PDU Session) and for registering to
5GC using the non-3GPP access network selection information.
The Access Network Discovery & Selection policy shall contain one or more WLAN
Selection Policy (WLANSP) rules and and may contain Non-3GPP access network
(N3AN) node selection information and configuration information.
N3AN node selection information and configuration information is used to
control UE behaviour related to selection of either N3IWF or ePDG for
accessing 5GC via non-3GPP access.
UE Access Network discovery and selection policies are encoded as defined in
3GPP TS 24.526 [16].
UE Access Network discovery and selection policies may be provided by a V-PCF
and/or a H-PCF.
If the UE has indicated in the \"UE STATE INDICATION\" message it does not
support ANDSP, i.e. the UE does not support non-3GPP access, the PCF shall not
send any Access Network discovery and selection policies to the UE.
##### 4.2.2.2.3 UE Route Selection Policy (URSP)
The UE Route Selection Policy is used by the UE to determine how to route
outgoing traffic.
The UE Route Selection Policy shall consist of one or several URSP rules.
URSP rules are encoded as defined in 3GPP TS 24.526 [16].
UE Route Selection Policy may only be provided by a H-PCF or the PCF of the
SNPN, but shall not be provided by a V-PCF. However, UE Route Selection Policy
determined and provided by the H-PCF may be retrieved by a V-PCF from the
H-PCF and forwarded to a UE.
The (H-)PCF shall use the UE policy subscription data stored in UDR as
specified in 3GPP TS 29.519 [17] to ensure the values included in the Route
Selection Descriptor of the generated URSP rules are always supported by
subscription.
For the received list of internal group Ids, the (H-)PCF retrieves the
corresponding 5G VN group configuration data stored from the UDR as specified
in 3GPP TS 29.504[27] and 3GPP TS 29.505 [26], if available. For each
available 5G VN group, the (H-)PCF may use the retrieved 5G VN group
configuration values to encode the values for the Route Selection Descriptor
and the values for the Traffic Descriptor of the generated URSP rules.
If the \"EnhancedBackgroundDataTransfer\" feature is supported, the (H-)PCF
may retrieve the Background Data Transfer Reference ID(s) by retrieving the
UE\'s Application Data from the UDR as defined in clause 6.2.9 of 3GPP TS
29.519 [17]. In this case, the PCF shall retrieve the transfer policy
corresponding to the Background Data Transfer Reference ID(s) as defined in
clause 5.2.8 of 3GPP TS 29.519 [17] and then may create the URSP rules
including the Route Selection Validation Criteria for the UE as defined in
clause 6.6.2.1 of 3GPP TS 23.503 [4]. If the (H-)PCF provisions the URSP rules
including the Route Selection Validation Criteria for the UE, it shall use the
associated S-NSSAI and DNN to store in the UDR the Background Data Transfer
Reference ID(s) in the UE\'s session management policy data as specified in
3GPP TS 29.519 [17].
If the (H-)PCF retrieves the BDT policy and corresponding related information
(e.g. network area information, the volume of data to be transferred per UE,
etc.) within the BdtData data type, and the \"bdtpStatus\" attribute within
the BdtData data type is set to value \"INVALID\", the (H-)PCF shall not
provision the URSP rules based on the invalid BDT policy. When the BDT policy
re-negotiation is completed the PCF may:
\- if the new BDT Policy is determined, create or update the applicable URSP
rules based on the new BDT policy; or
\- if the invalid BDT policy is removed, remove applicable URSP rules.
If the \"AfGuideURSP\" feature is supported by the Nudr_DataRepository
service, the (H-)PCF may receive Service specific parameter information that
contains data for AF guidance information on the URSP determination as defined
in clause 6.4.2.15 of 3GPP TS 29.519 [17]. In this case, the (H-)PCF may also
use this AF guidance information as input to determine the URSP that will be
provisioned to the UE. If the received AF guidance information is not
consistent with the UE subscription data, or the local operator policy does
not allow the specific S-NSSAI and DNN provided by the AF guidance
information, the corresponding AF guidance information shall not be used to
determine the URSP rules.
When the (H-)PCF decides to provide URSP rules based on the AF guidance
information, it shall derive the information as follows:
\- Application traffic descriptor within the \"trafficDesc\" attribute is used
to set the Traffic Descriptor of URSP rule (defined in Figure 5.2.2 of 3GPP TS
24.526 [16]).
\- Each route selection parameter set within the \"routeSelParamSets\"
attribute of the UrspRuleRequest data type is used to determine a Route
selection descriptor (defined in Figure 5.2.2 of 3GPP TS 24.526 [16]) as
follows:
\- DNN (within the \"dnn\" attribute of the RouteSelectionParameterSet data
type) and S-NSSAI (within the \"snssai\" attribute of the
RouteSelectionParameterSet data type) from the route selection parameter set
are used to set the Route selection descriptor contents (defined in Figure
5.2.4 of 3GPP TS 24.526 [16]);
\- Route selection precedence (within the \"precedence\" attribute of the
RouteSelectionParameterSet data type) is used to set the Precedence value of
route selection descriptor (defined in Figure 5.2.4 of 3GPP TS 24.526 [16]);
and
\- the spatial validity condition (within the \"spatialValidityTais\"
attribute of the RouteSelectionParameterSet data type) is used to set the
Location criteria of the route selection descriptor (defined in Figure 5.2.5
of 3GPP TS 24.526 [16]).
\- The precedence for the generated URSP rule is determined by the (H-)PCF.
The (H-)PCF may use the \"relatPrecedence\" attribute within the
\"UrspRuleRequest\" data type to derive the relative precedence of the URSP
rule for a request coming from the same AF.
URSP rules based on AF guidance should not be set as the URSP rules with the
\"match all\" application traffic descriptor.
The (H-)PCF may obtain the information about the UE\'s OS from the UE as
described in the Annex D of 3GPP TS 24.501 [15] or it may derive the
information about the UE\'s OS from the PEI provided by the NF service
consumer (e.g. AMF).
If the (H-)PCF is required to provide UE policies to the UE that includes
application descriptors then:
a) If the (H-)PCF has been provided with one UE\'s OS Id by the UE, the
(H-)PCF shall use either the traffic descriptor \"OS App Id type\" or the
traffic descriptor \"OS Id + OS App Id type\" as defined in 3GPP TS 24.526
[16].
NOTE 1: The (H-)PCF uses the traffic descriptor \"OS Id + OS App Id type\"
when the (H-)PCF does not take the received UE\'s OS Id into account.
b) If the (H-)PCF has been provided with more than one UE\'s OS Id by the UE,
\- the (H-)PCF shall use the traffic descriptor \"OS Id + OS App Id type\" for
the UE\'s OS Id provided by the UE as defined in 3GPP TS 24.526 [16]; and
\- the (H-)PCF shall not use the traffic descriptor \"OS App Id type\" as
defined in 3GPP TS 24.526 [16].
c) If the (H-)PCF has not been provided with the UE\'s OS Id by the UE,
\- the (H-)PCF shall use the traffic descriptor \"OS Id + OS App Id type\" as
defined in 3GPP TS 24.526 [16]; and
\- the (H-)PCF shall not use the traffic descriptor \"OS App Id type\" as
defined in 3GPP TS 24.526 [16].
d) If the (H-)PCF has been provided with the UE\'s OS Id by the UE and the
(H-)PCF has derived the UE\'s OS Id from the PEI and if there is an
inconsistency between the OS Id provided by the UE and the OS Id derived from
the PEI, the (H-)PCF shall use the OS Id provided by the UE for providing UE
policies to the UE that include application descriptors.
URSP rules may be used to support end to end redundant user plane paths by
establishing two redundant PDU sessions. PCF configuration based on e.g.
deployment, terminal implementation or policies per group of UE(s) may be used
by the PCF to determine whether the URSP Rules shall include PDU Session Pair
ID and RSN to indicate that they refer to redundant PDU sessions or whether
the UE will determine these values instead.
NOTE 2: The PCF can provide two distinct URSP rules to support end to end
redundant user plane paths using Dual Connectivity for the duplicated traffic
of an application. Duplicated traffic from the UE application is
differentiated by two distinct traffic descriptors (different DNNs, and for IP
traffic, different IP descriptors or non-IP descriptors), each one defined in
a different URSP rule, so that the two redundant PDU sessions are matched to
the specific Route Selection Descriptors of distinct URSP rules. These Route
Selection Descriptors of distinct URSP rules may include corresponding RSNs
and PDU Session Pair IDs as defined in 3GPP TS 24.526 [16]. The Route
Selection Descriptors share the same PDU Session Pair ID, if included, to
denote the two traffic are redundant with each other.
NOTE 3: For backward compatibility, PCF can provide a Route Selection
Descriptor with PDU Session Pair ID and RSN and a Route Selection Descriptor
without PDU Session Pair ID and RSN in the URSP rule. In this case, the Route
Selection Descriptor with PDU Session Pair ID and RSN has a lower precedence
value (i.e. higher prioritised) than the one without PDU Session Pair ID. It
allows that if a non-supporting UE receives the Route Selection Descriptor
containing PDU Session Pair ID, it ignores this Route Selection Descriptor.
##### 4.2.2.2.4 Vehicle-to-Everything Policy (V2XP)
V2XP includes the V2XP over PC5 and over Uu interfaces.
The V2XP over PC5 are defined in clause 5.2.3 of 3GPP TS 24.587 [24] and the
corresponding encoding is defined in clause 5.3.1 of 3GPP TS 24.588 [25].
The V2XP over Uu are defined in clause 5.2.4 of 3GPP TS 24.587 [24] and the
corresponding encoding is defined in clause 5.3.2 of 3GPP TS 24.588 [25].
##### 4.2.2.2.5 Proximity based Services Policy (ProSeP)
The ProSeP includes:
\- ProSeP for 5G ProSe direct discovery defined in clause 5.3 of 3GPP TS
24.555 [29];
\- ProSeP for 5G ProSe direct communications defined in clause 5.4 of 3GPP TS
24.555 [29];
\- ProSeP for 5G ProSe UE-to-network relay, including:
\- ProSeP for 5G ProSe UE-to-network relay UE defined in clause 5.5 of 3GPP TS
24.555 [29]; and/or
\- ProSeP for 5G ProSe Remote UE defined in clause 5.6 of 3GPP TS 24.555 [29];
and/or
\- ProSeP for 5G ProSe usage reporting configuration and rules defined in
clause 5.7 of 3GPP TS 24.555 [29].
#### 4.2.2.3 V2X N2 PC5 Policy
The V2X N2 PC5 policy consists of V2X PC5 QoS parameters used by the NG-RAN.
When the (H-)PCF derives the UE policy for V2X communications over PC5
reference point as defined in clause 4.2.2.2.4, the (H-)PCF shall derive the
corresponding V2X PC5 QoS parameters used by the NG-RAN.
In the roaming case, the H-PCF:
\- if PC5 UE capabilities and UE Policy Provisioning request messages are
received, and V2X policies are derived, shall include the V2X N2 PC5 Policy
within the \"n2Pc5Pol\" attribute in the policy association creation response
towards the V-PCF; or
\- shall include the V2X N2 PC5 Policy within the \"n2Pc5Pol\" attribute, if
changes apply, in the policy association update response towards the V-PCF; or
\- may include the V2X N2 PC5 Policy within the \"n2Pc5Pol\" attribute in the
the policy association update request initiated by the H-PCF.
In the roaming or non-roaming case, the (V-)PCF shall use the
Namf_Communication_N1N2MessageTransfer service operation defined in clause
5.2.2.3.1 of 3GPP TS 29.518 [14] to send V2X N2 PC5 policy to the NG-RAN.
#### 4.2.2.4 5G ProSe N2 PC5 Policy
The 5G ProSe N2 PC5 policy consists of 5G ProSe PC5 QoS parameters used by the
NG-RAN.
When the (H-)PCF derives the UE policy for 5G ProSe as defined in clause
4.2.2.2.5, the (H-)PCF shall derive the corresponding 5G ProSe N2 PC5 QoS
parameters used by the NG-RAN.
In the roaming case, the H-PCF:
\- if the 5G ProSe capabilities and the UE Policy Provisioning request message
are received, and 5G ProSe policies are derived, shall include the N2 PC5
Policy for 5G ProSe within the \"n2Pc5ProSePol\" attribute in the of policy
association creation response towards the V-PCF; or
\- shall include the N2 PC5 Policy for 5G ProSe within the \"n2Pc5ProSePol\"
attribute, if changes apply, in the response of the policy association update
response towards the V-PCF; or
\- may include the N2 PC5 Policy for 5G ProSe within the \"n2Pc5ProSePol\"
attribute in the policy association update request initiated by the H-PCF.
In the roaming or non-roaming case, the (V-)PCF shall use the
Namf_Communication_N1N2MessageTransfer service operation defined in clause
5.2.2.3.1 of 3GPP TS 29.518 [14] to send 5G ProSe N2 PC5 policy to the NG-RAN.
### 4.2.3 Npcf_UEPolicyControl_Update Service Operation
#### 4.2.3.1 General
The procedure in the present clause is applicable when the NF service consumer
modifies an existing UE policy association (including the case where the AMF
is relocated and the new AMF selects to maintain the policy association with
the old PCF and to update the Notification URI).
Figure 4.2.3.1-1 illustrates the update of a policy association.
Figure 4.2.3.1-1: Update of a UE policy association
NOTE 1: For the roaming case, the PCF represents the V-PCF if the NF service
consumer is an AMF and the PCF represents the H-PCF if the NF service consumer
is a V-PCF.
The AMF, as NF service consumer, invokes this procedure when a subscribed
policy control request trigger (see clause 4.2.3.2) occurs. When a policy
control request trigger that requires the subscription as defined in table
5.6.3.3-1 (e.g. LOC_CH trigger) occurs, the NF service consumer (AMF) shall
only invoke this procedure if the PCF has explicitly subscribed to that event
trigger. When a policy control request trigger that does not require the
subscription as defined in table 5.6.3.3-1 (e.g. GROUP_ID_LIST_CHG trigger)
occurs, the NF service consumer (AMF) shall always invoke the procedure.
NOTE 2: The AMF uses the Namf_Communication_N1MessageNotify service operation
specified in 3GPP TS 29.518 [14] to send to the V-PCF a \"MANAGE UE POLICY
COMPLETE\" message or a \"MANAGE UE POLICY COMMAND REJECT\" message, as
defined in Annex D.5 of 3GPP TS 24.501 [15] or a \"UE POLICY PROVISIONING
REQUEST\" message as defined in clause 7.2.1.1 of 3GPP TS 24.587 [24].
If an AMF as NF service consumer knows by implementation specific means that
the UE context has been transferred to an AMF with another GUAMI within the
AMF set, it may also invoke this procedure to update the Notification URI.
NOTE 3: Either the old or the new AMF can invoke this procedure.
During the AMF relocation, if the new AMF received the resource URI of the
individual UE Policy from the old AMF and selects the old PCF, the new AMF
shall also invoke this procedure to update the Notification URI. The new AMF
may also update the alternate or backup IP addresses.
The V-PCF, as NF service consumer, invokes this procedure when a policy
control request trigger (see clause 4.2.3.2) occurs. When a policy control
request trigger that does not require the subscription as defined in table
5.6.3.3-1 (e.g. UE_POLICY trigger) occurs, the V-PCF shall always invoke the
procedure. When a policy control request trigger that requires the
subscription as defined in table 5.6.3.3-1 (e.g. LOC_CH trigger) occurs, the
V-PCF shall only invoke this procedure if the Hâ€‘PCF has subscribed to that
event trigger.
To request policies (e.g. policy control request trigger(s) is/are met) from
the PCF, to update the Notification URI, to update the trace control
configuration or to request the termination of trace, the NF Service Consumer
shall request the update of the associated UE Policy Association by providing
the relevant parameters about the UE context in an HTTP POST request with
\"{apiRoot}/npcf-ue-policy-control/v1/policies/{polAssoId}/update\" as
Resource URI and the PolicyAssociationUpdateRequest data structure as request
body that shall include:
\- at least one of the following:
1\. a new Notification URI encoded in the \"notificationUri\" attribute;
2\. observed Policy Control Request Trigger(s) (see clause 4.2.3.2) encoded as
\"triggers\" attribute;
3\. if a UE location change occurred, the UE location encoded as \"userLoc\"
attribute;
4\. if a \"MANAGE UE POLICY COMPLETE\" message or a \"MANAGE UE POLICY COMMAND
REJECT\" message of the UE policy delivery protocol defined in Annex D of 3GPP
TS 24.501 [15] has been received by the V-PCF as NF service consumer, and at
least parts of the contents relate to UPSIs of the HPLMN, the parts of that
message that relate to UPSIs of the HPLMN encoded as \"uePolDelResult\"
attribute;
5\. if the Policy Control Request Trigger \"Change of UE presence in PRA\" is
provided, the current presence status of the UE for the presence reporting
areas for which reporting was requested, if not previously provided, or the
presence reporting areas for which reporting was requested and the status has
changed encoded as \"praStatuses\" attribute;
NOTE 4: If the PCF included the identifer of a Core Network predefined
Presence Reporting Area Set within the \"praId\" attribute during the
subscription to changes of UE presence in PRA, the AMF only provides the
presence reporting area information corresponding to the concerned individual
Presence Reporting Area Identifier(s) within the Set. The \"praId\" attribute
within each returned \"PresenceInfo\" data type hence includes the identifier
of the concerned individual Presence Reporting Area.
6\. if the NF service consumer is an AMF, for AMF relocation scenarios, if
available, alternate or backup IPv4 Address(es) where to send Notifications
encoded as \"altNotifIpv4Addrs\" attribute;
7\. if the NF service consumer is an AMF, for AMF relocation scenarios, if
available, alternate or backup IPv6 Address(es) where to send Notifications
encoded as \"altNotifIpv6Addrs\" attribute;
8\. if the NF service consumer is an AMF, for AMF relocation scenarios, if
available, alternate or backup FQDN(s) where to send Notifications encoded as
\"altNotifFqdns\" attribute;
9\. for AMF relocation scenarios, the GUAMI encoded as \"guami\" attribute;
NOTE 5: An alternate NF service consumer than the one that requested the
generation of the subscription resource can send the request. For instance, an
AMF as service consumer can change.
10\. if the NF service consumer is an AMF, for AMF relocation scenarios, the
new serving AMF Id encoded in the \"servingNfId\" attribute;
11\. if a UE PLMN change occurred and the \"PlmnChange\" feature defined in
clause 5.8 is supported, the PLMN Identifier or the SNPN Identifier of the new
serving network encoded as \"plmnId\" attribute;
NOTE 6: The SNPN Identifier consists of the PLMN Identifier and the NID.
NOTE 7: When the UE moves between PLMNs, the trigger reports changes of
equivalent PLMNs.
> 12\. if a \"UE POLICY PROVISIONING REQUEST\" message defined in clause
> 7.2.1.1 of 3GPP TS 24.587 [24] has been received by the V-PCF as NF service
> consumer and respectively the \"V2X\" feature and/or the \"ProSe\" feature
> defined in clause 5.8 is/are supported, the message encoded as \"uePolReq\"
> attribute;
13\. if a UE Internal Group Identifier(s) change occurred and the
\"GroupIdListChange\" feature defined in clause 5.8 is supported, the Internal
Group Identifier(s) of the served UE encoded as \"groupIds\" attribute; and/or
14\. if a change of PC5 capablity for 5G ProSe occurred and the \"ProSe\"
feature defined in clause 5.8 is supported, the PC5 capability for 5G ProSe
encoded as \"proSeCapab\" attribute.
15\. if a change of the connectivity state of the UE occurred and the
\"ConnectivityStateChange\" feature defined in clause 5.8 is supported, the
connectivity state of the served UE encoded as \"connectState\" attribute;
and/or
16\. when a response with HTTP status code 4xx or 5xx as defined in clause
5.2.2.3.1.2 of 3GPP TS 29.518 [14] or a N1N2 Transfer Failure Notification as
defined in clause 5.2.2.3.2 of 3GPP TS 29.518 [14] is received by the V-PCF
after provisioning the UE policy by invoking the
Namf_Communication_N1N2MessageTransfer service operation to the AMF, this UE
policy transfer failure notification encoded as \"uePolTransFailNotif\"
attribute.
Upon the reception of the HTTP POST request:
\- if the PCF is a V-PCF and the V-PCF has an established policy association
with the H-PCF, the V-PCF shall determine based on the contents of a
potentially \"uePolDelResult\" attribute to be sent to the H-PCF (see above)
and requested event triggers of the H-PCF whether to send as the NF service
consumer towards the H-PCF a request for the update of the policy association
as described in the present clause;
\- the (V-)(H-)PCF shall determine the applicable UE policy based on the UE
Policy Sections stored in UDR, UE local policy and, for the H-PCF, taking into
consideration the information received within the UE policy delivery protocol
encoded in the \"uePolReq\" attribute, if available, and for the V-PCF, taking
into consideration any policy received from the H-PCF encoded in the
\"uePolicy\" attribute in the reply to the possible request for the update of
the associated policy association. When the \"ProSe\" feature is supported,
the H-PCF shall determine the applicable ProSeP based on the received PC5
capability for 5G ProSe. When the UE disables a 5G ProSe capability the PCF
may stop updating the corresponding ProSeP, and when the UE enables a 5G ProSe
capability the PCF may update the corresponding ProSeP;
\- if the UE indicates the support of 5G ProSe communications over PC5
reference point, the \"ProSe\" feature is supported, and for the H-PCF, if the
UE POLICY PROVISIONING REQUEST message with the requested 5G ProSe policies
was included in the \"uePolReq\" attribute, the (H-)PCF shall determine the
applicable ProSeP and 5G ProSe N2 PC5 policy, as detailed in clauses
4.2.2.2.1.3 and 4.2.2.4, based on the operator\'s policy;
\- if the UE indicated the support of V2X communications over PC5 reference
point, \"V2X\" feature is supported, and for the H-PCF, if the UE POLICY
PROVISIONING REQUEST message was included in the \"uePolReq\" attribute, the
(H-)PCF shall determine the applicable V2XP and V2X N2 PC5 policy as detailed
in clauses 4.2.2.2.1.2 and 4.2.2.3, based on the operator\'s policy;
\- for the succesfull case, the (V-)(H-)PCF shall send a HTTP \"200 OK\"
response with the PolicyUpdate data type as response body with the possibly
updated of UE policy (for the H-PCF), and/or ProSe N2 PC5 policy (for the
H-PCF) as specified in clause 4.2.2.4, N2 PC5 policy for V2X communications
and/or 5G ProSe (for the H-PCF) as specified in clause 4.2.2.3 and/or Policy
Control Request Trigger(s) encoded as described in clause 4.2.3.3;
\- if the (V-)PCF determines that UE policy needs to be updated, it shall use
the Namf_Communication service specified in 3GPP TS 29.518 [14] to provision
the UE policy according to clause 4.2.2.2 and as follows:
(i) the (V-)PCF shall send the determined UE policy using
Namf_Communication_N1N2MessageTransfer service operation(s); and
(ii) the (V-)PCF shall be prepared to receive UE Policy Delivery Results from
the AMF within the Namf_Communication_N1MessageNotify service operation, and
for the V-PCF, if the received UE Policy Delivery results relate to UE policy
sections provided by the H-PCF, the V-PCF shall use the
Npcf_UEPolicyControl_Update Service Operation to send those UE Policy Delivery
results to the H-PCF; and
NOTE 8: A PolicyUpdate data structure with only mandatory attribute(s) is
included in the \"200 OK\" response when the PCF decides not to update the
policies.
\- if the PCF determines that the V2XP and N2 PC5 policy (e.g. for V2X
communications, for 5G ProSe) for V2X communications need to be updated, and
for the V-PCF when receiving the updated V2XP and N2 PC5 policy for V2X
communications from the H-PCF, it shall use the Namf_Communication service
specified in 3GPP TS 29.518 [14] to provision the V2XP to the UE and the V2X
N2 PC5 policy to NG-RAN according to clauses 4.2.2.2.1.2 and 4.2.2.3;
\- if the PCF determines that ProSeP and 5G ProSe N2 PC5 policy needs to be
updated, and for the V-PCF when receiving the updated ProSeP and 5G ProSe N2
PC5 policy from the H-PCF, it shall use the Namf_Communication service
specified in 3GPP TS 29.518 [14] to provision the ProSeP to the UE and 5G
ProSe N2 PC5 policy to NG-RAN according to clauses 4.2.2.2.1.3 and 4.2.2.4;
\- if errors occur when processing the HTTP POST request, the (V-)(H-)PCF
shall:
\- send an HTTP error response as specified in clause 5.7; or
\- if the feature \"ES3XX\" is supported, and the (V-)(H-)PCF determines the
received HTTP POST request needs to be redirected, send an HTTP redirect
response as specified in clause 6.10.9 of 3GPP TS 29.500 [5];
according to the following provisions:
\- if the (V-)(H-)PCF is, due to incomplete, erroneous or missing information
in the request not able to provision a UE policy decision, the PCF may reject
the request and include in an HTTP \"400 Bad Request\" response message the
\"cause\" attribute of the ProblemDetails data structure set to
\"ERROR_REQUEST_PARAMETERS\".
If the PCF received a new GUAMI, the PCF may subscribe to GUAMI changes using
the AMFStatusChange service operation of the Namf_Communication service
specified in 3GPP TS 29.518 [14], and it may use the Nnrf_NFDiscovery Service
specified in 3GPP TS 29.510 [13] (using the obtained GUAMI and possibly
service name) to query the other AMFs within the AMF set.
#### 4.2.3.2 Policy Control Request Triggers
The following Policy Control Request Triggers are defined (see clause 6.1.2.5
of 3GPP TS 23.503 [4]):
\- \"LOC_CH\", i.e. location change (tracking area): the tracking area of the
UE has changed;
\- \"PRA_CH\", i.e. change of UE presence in PRA: the UE is entering/leaving a
Presence Reporting Area. This includes reporting the initial status at the
time the request for this reporting is initiated;
\- \"UE_POLICY\", i.e. a \"MANAGE UE POLICY COMPLETE\" message or a \"MANAGE
UE POLICY COMMAND REJECT\" message, as defined in Annex D.5 of 3GPP TS 24.501
[15] has been received by the V-PCF and is being forwarded to the H-PCF, or a
\"UE POLICY PROVISIONING REQUEST\" message, as defined in clause 7.2.1.1 of
3GPP TS 24.587 [24] has been received by the V-PCF and is being forwarded to
the H-PCF;
\- \"PLMN_CH\", i.e. PLMN change: the serving network (PLMN or SNPN) of the UE
has changed;
NOTE 1: The \"PLMN_CH\" trigger only applies if the \"PlmnChange\" feature is
supported.
NOTE 2: When the UE is moving between PLMNs, the trigger reports changes of
equivalent PLMNs.
\- \"CON_STATE_CH\", i.e. connectivity state change: the connectivity state of
the UE has changed;
NOTE 3: The \"CON_STATE_CH\" trigger only applies if the
\"ConnectivityStateChange\" feature is supported.
> \- \"GROUP_ID_LIST_CHG\", i.e. UE Internal Group Identifier(s) change: the
> UDM provided list of group Ids has changed; and
NOTE 4: The \"GROUP_ID_LIST_CHG\" trigger only applies if the
\"GroupIdListChange\" feature is supported. This Policy Control Request
Trigger does not require an explicit subscription from the PCF.
\- \"UE_CAP_CH\", i.e. UE Capabilities change: the UE provided 5G ProSe
capabilities have changed.
NOTE 5: The \"UE_CAP_CH\" trigger only applies if the \"ProSe\" feature is
supported. This Policy Control Request Trigger does not require a
subscription.
#### 4.2.3.3 Encoding of updated policy
Updated policies shall be encoded within the PolicyUpdate data type that may
include:
\- only when the updated policy is supplied by the H-PCF in the roaming
scenario, UE policy (see clause 4.2.2.2) encoded as \"uePolicy\" attribute,
and N2 PC5 policy for V2X communications (see clause 4.2.2.3) encoded as
\"n2Pc5Pol\" attribute and/or the N2 PC5 policy for 5G ProSe (see clause
4.2.2.4) encoded as \"n2Pc5ProSePo\" attribute;
\- updated Policy Control Request Trigger(s) (see clause 4.2.3.2) encoded as
\"triggers\" attribute, i.e.:
1) either a new complete list of applicable Policy Control Request Trigger(s)
including one or several of the following:
a) Location change (tracking area); or
b) Change of UE presence in PRA;
c) Change of PLMN, if the \"PlmnChange\" feature is supported; or
d) Change of UE connectivity state, if the \"ConnectivityStateChange\" feature
is supported; or
2) a \"NULL\" value to request the removal of all previously installed Policy
Control Request Trigger(s); and
\- if the Policy Control Request Trigger \"Change of UE presence in PRA\" is
provided or if that trigger was already set but the requested presence
reporting areas need to be changed, the presence reporting areas for which
reporting is required encoded as \"pras\" attribute encoded as follows:
a) A new entry shall be added by supplying a new identifier as key and the
corresponding PresenceInfo data type instance with complete contents as value
as an entry within the map.
b) An existing entry shall be modified by supplying the existing identifier as
key and the PresenceInfo data type instance with complete contents as value as
an entry within the map.
c) An existing entry shall be deleted by supplying the existing identifier as
key and \"NULL\" as value as an entry within the map.
d) For an unmodified entry, no entry needs to be provided within the map.
### 4.2.4 Npcf_UEPolicyControl_UpdateNotify Service Operation
#### 4.2.4.1 General
The (V-)(H)-PCF may decide to update policy control request triggers, and in
the roaming case, the H-PCF may decide to update the UE Policy, the V2X N2 PC5
policy, if the \"V2X\" feature is supported, and/or the 5G ProSe N2 PC5
policy, if the \"ProSe\" feature is supported. The PCF (H-PCF in the roaming
case) may decide to request the termination of the policy association.
The(V-)(H-)PCF shall then use an Npcf_UEPolicyControl_UpdateNotify service
operation.
The following procedures using the Npcf_UEPolicyControl_UpdateNotify service
operation are supported:
\- Policy update notification.
\- Request the termination of the UE policy association.
\- URSP provisioning for background Data Transfer policy.
> \- UE policy provisioning for V2X communications over PC5 and Uu reference
> points.
>
> \- UE policy provisioning for 5G ProSe.
\- N2 PC5 Policy (e.g. for V2X communications, for 5G ProSe) provisioning.
NOTE: The PCF derives the URSP and invokes the
Namf_Communication_N1N2MessageTransfer service operation to provision it to
the UE.
#### 4.2.4.2 Policy update notification
Figure 4.2.4.2-1 illustrates the policy update notification.
Figure 4.2.4.2-1: policy update notification
NOTE: For the roaming case, the PCF represents the V-PCF if the NF service
consumer is an AMF and the PCF represents the H-PCF if the NF service consumer
is a V-PCF.
The (V-)(H)-PCF may decide to update policy control request trigger(s) and in
the roaming case, the H-PCF may also decide to update the UE Policy, the N2
PC5 policy for V2X communications if the \"V2X\" feature is supported and/or
the N2 PC5 policy for 5G ProSe if the \"ProSe\" feature is supported. The
(V-)(H-)PCF shall then send an HTTP POST request with
\"{notificationUri}/update\" as URI (where the Notification URI was previously
supplied by the NF service consumer) to the NF service consumer and the
PolicyUpdate data structure as request body encoded as described in clause
4.2.3.3.
Upon the reception of the HTTP POST request, the NF service consumer:
\- if the V-PCF is the NF service consumer, shall use the Namf_Communication
Service defined in 3GPP TS 29.518 [14] to send \"MANAGE UE POLICY COMMAND\"
message(s) with the received UE policy to the UE via the AMF and/or with the
received N2 PC5 policy for V2X communications and/or 5G ProSe to the NG-RAN
via the AMF;
\- if the V-PCF is the NF service consumer, shall provision the received
policy control requested trigger(s) to the AMF using the
Npcf_UEPolicyControl_UpdateNotify service operation according to the present
clause;
\- if the AMF is the NF service consumer, shall enforce the received policy
control request trigger(s);
\- shall either send a successful response indicating the success of the
enforcement or an appropriate failure response, for the V-PCF as the NF
service consumer taking into consideration a reply received from the possible
Namf_Communication Service service operation and from the possible
Npcf_UEPolicyControl_UpdateNotify service operation according to the previous
bullets. In case of a successful response:
\- if the feature \"ImmediateReport\" is supported and the PCF provisioned the
policy control request triggers related to PLMN change, PRA change,
connectivity state change or location change, a \"200 OK\" response code and a
response body with the corresponding available information in the
\"UeRequestedValueRep\" data structure shall be returned in the response;
\- otherwise, a \"204 No Content\" response code shall be returned in the
response; and
\- if errors occur when processing the HTTP POST request, shall send an HTTP
error response as specified in clause 5.7; or
\- if the feature \"ES3XX\" is supported, and the NF service consumer
determines the received HTTP POST request needs to be redirected, the NF
service consumer shall send an HTTP redirect response as specified in clause
6.10.9 of 3GPP TS 29.500 [5].
If the feature \"ErrorResponse\" is supported and if the AMF as NF service
consumer is not able to handle the notification but another unknown AMF could
possibly handle the notification, it shall reply with an HTTP \"404 Not
found\" error response.
If the (V-)PCF receives a \"307 Temporary Redirect\" response, the (V-)PCF
shall resend the failed policy update notification request using the received
URI in the Location header field as Notification URI. Subsequent policy update
notifications, triggered after the failed one, shall be sent to the
Notification URI provided by the NF service consumer during the corresponding
policy association creation/update.
If the (V-)PCF becomes aware that a new AMF is requiring notifications (e.g.
via the \"404 Not found\" response or via Namf_Communication service
AMFStatusChange Notifications, see 3GPP TS 29.518 [14], or via link level
failures), and the (V-)PCF knows alternate or backup IPv4, Ipv6 Addess(es) or
FQDN(s) where to send Notifications (e.g. via \"altNotifIpv4Addrs\",
\"altNotifIpv6Addrs\" or \"altNotifFqdns\" attributes received when the policy
association was created or via AMFStatusChange Notifications, or via the
Nnrf_NFDiscovery Service specified in 3GPP TS 29.510 [13] (using the service
name and GUAMI obtained during the creation of the subscription) to query the
other AMFs within the AMF set), the (V-)PCF shall exchange the authority part
of the corresponding Notification URI with one of those addresses and shall
use that URI in any subsequent communication.
If the (V-)PCF received a \"404 Not found\" response, the (V-)PCF should
resend the failed policy update notification request to that URI.
#### 4.2.4.3 Request for termination of the policy association
Figure 4.2.4.3-1 illustrates the request for a termination of the policy
association.
Figure 4.2.4.3-1: request for a termination of theUE policy association
NOTE: For the roaming case, the PCF represents the V-PCF if the NF service
consumer is an AMF and the PCF represents the H-PCF if the NF service consumer
is a V-PCF.
The (V-)(H-)PCF may request the termination of the UE policy association and
shall then send an HTTP POST request with \"{notificationUri}/terminate\" as
URI (where the Notification URI was previously supplied by the NF service
consumer) and the TerminationNotification data structure as request body that
shall include:
\- the resource URI of the concerned individual UE policy association
(including the policy association ID) encoded as \"resourceUri\" attribute;
and
\- the cause why the (V-)(H-)PCF requests the termination of the policy
association encoded as \"cause\" attribute.
Upon the reception of the HTTP POST request, the NF service consumer:
\- if the V-PCF is the NF service consumer, shall send as NF service producer
for the corresponding policy association (towards the AMF as NF service
consumer) a request for a termination of the policy association according to
the present clause;
\- shall either send an HTTP \"204 No Content\" response for the succesfull
processing of the HTTP POST request or an appropriate failure response, for
the V-PCF as the NF service consumer taking into consideration a reply
received for the possible corresponding policy association termination request
according to the previous bullet; and
\- if errors occur when processing the HTTP POST request, shall send an HTTP
error response as specified in clause 5.7; or
\- if the feature \"ES3XX\" is supported, and the NF service consumer
determines that the received HTTP POST request needs to be redirected, the NF
service consumer shall send an HTTP redirect response as specified in clause
6.10.9 of 3GPP TS 29.500 [5].
After the succesfull processing of the HTTP POST request, any NF service
consumer except for the V-PCF shall invoke the Npcf_UEPolicyControl_Delete
Service Operation defined in clause 4.2.5 to terminate the policy association.
If the AMF as NF service consumer is not able to handle the notification but
knows by implementation specific means that another AMF is able to handle the
notification, it shall reply with an HTTP \"307 Temporary Redirect\" response
pointing to the URI of the new AMF. If the AMF as NF service consumer is not
able to handle the notification but another unknown AMF could possibly handle
the notification, it shall reply with an HTTP \"404 Not found\" error
response.
If the (V-)PCF receives a \"307 Temporary Redirect\" response, the PCF shall
resend the failed request for termination of the policy association using the
received URI in the Location header field as Notification URI.
If the (V-)PCF becomes aware that a new NF service consumer (AMF) is requiring
notifications (e.g. via the \"404 Not found\" response or via
Namf_Communication service AMFStatusChange Notifications, see 3GPP TS TS
29.518 [14], or via link level failures), and the (V-)PCF knows alternate or
backup Ipv4, Ipv6 Addess(es) or FQDN(s) where to send Notifications (e.g. via
\"altNotifIpv4Addrs\", \"altNotifIpv6Addrs\" or \"altNotifFqdns\" attributes
received when the policy association was created or via AMFStatusChange
Notifications, or via the Nnrf_NFDiscovery Service specified in 3GPP TS 29.510
[13] (using the service name and GUAMI obtained during the creation of the
subscription) to query the other AMFs within the AMF set), the (V-)PCF shall
exchange the authority part of the corresponding Notification URI with one of
those addresses and shall resend the failed request for termination of the
policy association to that URI.
If the (V-)PCF received a \"404 Not found\" response, the (V-)PCF should
resend the failed request for termination of the policy association to that
URI.
#### 4.2.4.4 URSP provisioning for Background Data Transfer policy
If the \"EnhancedBackgroundDataTransfer\" feature is supported, after the UE
policy association establishment, the (Hâ€‘)PCF may receive the Background Data
Transfer Reference ID(s) notified by the UDR for the change of UE\'s
Application Data as defined in clause 6.3.4 of 3GPP TS 29.519 [17]. In this
case, the (H-)PCF shall retrieve the transfer policy corresponding to the
Background Data Transfer Reference ID(s) as defined in clause 5.2.8 of 3GPP TS
29.519 [17] and derive the URSP including the Route Selection Validation
Criteria for the UE as defined in clause 6.2.2.1 of 3GPP TS 23.503 [40]. The
H-PCF shall provision the URSP to the V-PCF as defined in clause 4.2.4.2 and
then the V-PCF shall invoke the Namf_Communication_N1N2MessageTransfer service
operation to provision it to the UE. The (H-)PCF shall use the associated
S-NSSAI and DNN to store in the UDR the Background Data Transfer Reference
ID(s) in the UE\'s session management policy data as specified in 3GPP TS
29.519 [17].
#### 4.2.4.5 UE policy provisioning for V2X communication over PC5 and Uu
reference points
After the UE policy association establishment and if the \"V2X\" feature is
supported, the (H-)PCF may receive the service specific parameter information
notified by the UDR for the change of UE\'s Application Data as defined in
clause 6.3.4 of 3GPP TS 29.519 [17]. In this case:
\- for the roaming case, the H-PCF shall derive the V2XP and provision it to
the V-PCF as defined in clause 4.2.4.2; and/or
\- for the roaming and non-roaming case, the (V-)PCF shall use the
Namf_Communication Service defined in 3GPP TS 29.518 [14] to send \"MANAGE UE
POLICY COMMAND\" message(s) with the V2XP to the UE via the AMF.
#### 4.2.4.6 UE policy provisioning for 5G ProSe
After the UE policy association establishment and if the \"ProSe\" feature is
supported, the (H-)PCF may receive the service specific parameter information
via a notification on the change of UE\'s Application Data from the UDR, as
defined in clause 6.3.4 of 3GPP TS 29.519 [17]. In this case:
\- for the roaming case, the H-PCF shall derive the ProSeP and provision it to
the V-PCF as defined in clause 4.2.4.2; and/or
\- for the roaming and non-roaming case, the (H-)PCF shall derive the ProSeP
and the (V-)PCF shall use the Namf_Communication Service defined in 3GPP TS
29.518 [14] to convey it to the UE via the AMF by sending \"MANAGE UE POLICY
COMMAND\" message(s) as defined in 3GPP TS 24.554 [28].
#### 4.2.4.7 UE policy provisioning for AF-influenced URSP
If the \"AfGuideURSP\" feature is supported by the Nudr_DataRepository
service, after the UE policy association establishment, the (H-)PCF may be
informed that service specific parameter information that contains data for AF
guidance on the URSP determination has been created, modified or removed via a
notification by the UDR for the change or removal of UE\'s Application Data as
defined in clause 6.3.4 of 3GPP TS 29.519 [17]. In this case, the H-PCF may
derive new URSP(s), modify existing URSP(s) or remove existing URSP(s) by
using the information received from the UDR (see clause 4.2.2.2.1.1 and
4.2.2.2.3 for the description of how the (H-)PCF may use this information,
stored UPSC(s), policy subscription information and local operator policy to
determine the URSP that will be provisioned to the UE), and it shall:
\- for the roaming case, provision the derived new UE Policy Sections, and/or
update and/or remove existing UE Policy Sections to the V-PCF as defined in
clause 4.2.4.2 and then the V-PCF shall invoke the
Namf_Communication_N1N2MessageTransfer service operation to provision the
received UE Policy Sections to the UE; or
\- for the non-roaming case, use the Namf_Communication Service defined in
3GPP TS 29.518 [14] to convey the derived new UE Policy Sections and/or to
update and/or remove existing UE Policy Sections to the UE via the AMF within
\"MANAGE UE POLICY COMMAND\" message(s).
When the (H-)PCF receives the \"MANAGE UE POLICY COMPLETE\" or the \"MANAGE UE
POLICY COMMAND REJECT\" message and determines that this message indicates a
UE Policy Delivery outcome to which an NF service consumer has subscribed via
a request for service specific parameters, the (H-)PCF shall invoke the
Npcf_EventExposure_Notify service operation as defined in clause 4.2.4.2 of
3GPP TS 29.523 [30].
### 4.2.5 Npcf_UEPolicyControl_Delete Service Operation
Figure 4.2.5-1 illustrates the deletion of a policy association.
Figure 4.2.5-1: Deletion of a policy association
NOTE: For the roaming case, the PCF represents the V-PCF if the NF service
consumer is an AMF and the PCF represents the H-PCF if the NF service consumer
is a V-PCF.
The AMF as NF service consumer requests that the policy association is deleted
when the corresponding UE context is terminated, e.g. during UE de-
registration from the network.
During the AMF relocation, the old AMF shall invoke this procedure when:
\- the resource URI of the individual UE Policy Association resource is not
transferred to the new AMF; or
\- the new AMF informs the old AMF that the individual UE Policy Association
resource is not being reused.
To request that the UE policy association is deleted, the NF service consumer
(e.g. AMF) shall send an HTTP DELETE request with \"{apiRoot}/npcf-ue-policy-
control/v1/policies/{polAssoId}\" as Resource URI.
Upon the reception of the HTTP DELETE request,
\- the (V-)(H-)PCF shall delete the policy association;
\- if the PCF is a V-PCF and has an established corresponding policy
association towards the H-PCF, the V-PCF shall send as the NF service consumer
towards the H-PCF a request for the deletion of that policy association as
described in the present clause;
\- the (V-)(H-)PCF shall send either an HTTP \"204 No Content\" response
indicating the success of the deletion or an appropriate failure response, for
the V-PCF as PCF taking into consideration a reply received for the possible
policy association deletion request according to the previous bullet; and
\- the (V-)(H-)PCF shall if errors occur when processing the HTTP DELETE
request, send an HTTP error response as specified in clause 5.7; or
\- if the feature ES3XX is supported, and the (V-)(H-)PCF determines the
received HTTP DELETE request needs to be redirected, the (V-)(H-)PCF shall
send an HTTP redirect response as specified in clause 6.10.9 of 3GPP TS 29.500
[5].
# 5 Npcf_UEPolicyControl API
## 5.1 Introduction
The Access and Mobility Policy Control Service shall use the
Npcf_UEPolicyControl API.
The API URI of the Npcf_UEPolicyControl API shall be:
**{apiRoot}/\ /\**
The request URIs used in HTTP requests from the NF service consumer towards
the PCF shall have the Resource URI structure defined in clause 4.4.1 of 3GPP
TS 29.501 [6], i.e.:
**{apiRoot}/\ /\/\**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [6].
\- The \ shall be \"npcf-ue-policy-control\".
\- The \ shall be \"v1\".
\- The \ shall be set as described in clause 5.3.
## 5.2 Usage of HTTP
### 5.2.1 General
HTTP/2, IETF RFC 7540 [8], shall be used as specified in clause 5 of 3GPP TS
29.500 [5].
HTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [5].
The OpenAPI [10] specification of HTTP messages and content bodies for the
Npcf_UEPolicyControl is contained in Annex A.
### 5.2.2 HTTP standard headers
#### 5.2.2.1 General
See clause 5.2.2 of 3GPP TS 29.500 [5] for the usage of HTTP standard headers.
#### 5.2.2.2 Content type
JSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies
specified in the present specification as specified in clause 5.4 of 3GPP TS
29.500 [5]. The use of the JSON format shall be signalled by the content type
\"application/json\".
\"Problem Details\" JSON object shall be used to indicate additional details
of the error in a HTTP response body and shall be signalled by the content
type \"application/problem+json\", as defined in IETF RFC 7807 [21].
### 5.2.3 HTTP custom headers
The Npcf_UEPolicyControl API shall support HTTP custom header fields specified
in clause 5.2.3.2 of 3GPP TS 29.500 [5] and may support HTTP custom header
fields specified in clause 5.2.3.3 of 3GPP TS 29.500 [5].
In this Release of the specification, no specific custom headers are defined
for the Npcf_UEPolicyControl API.
## 5.3 Resources
### 5.3.1 Resource Structure
This clause describes the structure for the Resource URIs and the resources
and methods used for the service.
Figure 5.3.1-1 depicts the resource URIs structure for the
Npcf_UEPolicyControl API.
Figure 5.3.1-1: Resource URI structure of the Npcf_UEPolicyControl API
Table 5.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 5.3.1-1: Resources and methods overview
* * *
Resource name Resource URI HTTP method or custom operation Description UE
Policy Associations /policies POST Create a new Individual UE policy
association resource. Individual UE Policy Association /policies/{polAssoId}
GET Read an Individual UE Policy Association resource. DELETE Delete an
Individual UE Policy Association resource. /policies/{polAssoId}/update update
(POST) Report observed event trigger and obtain updated UE policies.
* * *
### 5.3.2 Resource:UE Policy Associations
#### 5.3.2.1 Description
This resource represents a collection of UE policy associations.
#### 5.3.2.2 Resource definition
Resource URI: **{apiRoot}/npcf-ue-policy-control/v1/policies**
This resource shall support the resource URI variables defined in table
5.3.2.2-1.
Table 5.3.2.2-1: Resource URI variables for this resource
* * *
Name Data type Definition apiRoot string See clause 5.1
* * *
#### 5.3.2.3 Resource Standard Methods
##### 5.3.2.3.1 POST
This method shall support the URI query parameters specified in table
5.3.2.3.1-1.
Table 5.3.2.3.1-1: URI query parameters supported by the POST method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.2.3.1-2 and the response data structures and response codes specified in
table 5.3.2.3.1-3.
Table 5.3.2.3.1-2: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description PolicyAssociationRequest M 1 Input
parameters for the creation of a policy association.
* * *
Table 5.3.2.3.1-3: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Poli | M | 1 | 201 Created | Policy | | cyAssociation | | | | association | | | | | | was created | | | | | | and policies | | | | | | are being | | | | | | provided. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 400 Bad | (NOTE 2) | | roblemDetails | | | Request | | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | clause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.2.3.1-4: Headers supported by the 201 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 Contains the URI
of the newly created resource, according to the structure: {apiRoot}/npcf-ue-
policy-control/v1/policies/{polAssoId}
* * *
### 5.3.3 Resource: Individual UE Policy Association
#### 5.3.3.1 Description
This resource represents an individual UE policy association.
#### 5.3.3.2 Resource definition
Resource URI: **{apiRoot}/npcf-ue-policy-control/v1/policies/{polAssoId}**
This resource shall support the resource URI variables defined in table
5.3.2.2-1.
Table 5.3.2.2-1: Resource URI variables for this resource
* * *
Name Data type Definition apiRoot string See clause 5.1. polAssoId string
Identifier of a policy association.
* * *
#### 5.3.3.3 Resource Standard Methods
##### 5.3.3.3.1 GET
This method shall support the URI query parameters specified in table
5.3.2.3.1-1.
Table 5.3.3.3.1-1: URI query parameters supported by the GET method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.2.3.1-2 and the response data structures and response codes specified in
table 5.3.2.3.1-3.
Table 5.3.3.3.1-2: Data structures supported by the GET Request Body on this
resource
* * *
Data type P Cardinality Description n/a
* * *
Table 5.3.3.3.1-3: Data structures supported by the GET Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Poli | M | 1 | 200 OK | | | cyAssociation | | | | | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual UE | | | | | | policy | | | | | | retrieval. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PCF (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual UE | | | | | | policy | | | | | | retrieval. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PCF (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | NOTE: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the GET | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | also apply. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.3.3.1-4: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PCF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
Table 5.3.3.3.1-5: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PCF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
##### 5.3.3.3.2 DELETE
This method shall support the URI query parameters specified in table
5.3.3.3.2-1.
Table 5.3.3.3.2-1: URI query parameters supported by the DELETE method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.3.3.2-2 and the response data structures and response codes specified in
table 5.3.3.3.2-3.
Table 5.3.3.3.2-2: Data structures supported by the DELETE Request Body on
this resource
* * *
Data type P Cardinality Description n/a
* * *
Table 5.3.3.3.2-3: Data structures supported by the DELETE Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | The policy | | | | | Content | association | | | | | | was | | | | | | successfully | | | | | | deleted. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual UE | | | | | | policy | | | | | | deletion. The | | | | | | response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PCF (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual UE | | | | | | policy | | | | | | deletion. The | | | | | | response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PCF (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | NOTE: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the | | | | | | DELETE method | | | | | | listed in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | also apply. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.3.3.2-4: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PCF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
Table 5.3.3.3.2-5: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PCF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
#### 5.3.3.4 Resource Custom Operations
##### 5.3.3.4.1 Overview
Table 5.3.3.4.1-1: Custom operations
* * *
Operation name Custom operation URI Mapped HTTP method Description Update
/policies/{polAssoId}/update POST Report observed event trigger and obtain
updated policies.
* * *
##### 5.3.3.4.2 Operation: Update
###### 5.3.3.4.2.1 Description
The update custom operation allows an NF service consumer to report the
occurrence on one or more policy request trigger(s) and to obtain related
updated policies.
###### 5.3.3.4.2.2 Operation Definition
This operation shall support the request data structures specified in table
5.3.3.4.2.2-1 and the response data structure and response codes specified in
table 5.3.3.4.2.2-2.
Table 5.3.3.4.2.2-1: Data structures supported by the POST Request Body on
this resource
* * *
Data type P Cardinality Description PolicyAssociationUpdateRequest M 1
Describes the observed policy control request trigger(s).
* * *
Table 5.3.3.4.2.2-2: Data structures supported by the POST Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | PolicyUpdate | M | 1 | 200 OK | Describes | | | | | | updated | | | | | | policies. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual UE | | | | | | policy | | | | | | modification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PCF (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual UE | | | | | | policy | | | | | | modification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PCF (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 400 Bad | (NOTE 2) | | roblemDetails | | | Request | | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 404 Not Found | (NOTE 2) | | roblemDetails | | | | | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | clause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.3.4.2.2-3: Headers supported by the 307 Response Code on this
resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PCF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
Table 5.3.3.4.2.2-4: Headers supported by the 308 Response Code on this
resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PCF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
## 5.4 Custom Operations without associated resources
None.
## 5.5 Notifications
### 5.5.1 General
Table 5.5.1-1: Notifications overview
* * *
Notification Callback URI HTTP method or custom operation Description (service
operation) Policy Update Notification {notificationUri}/update update (POST)
Policy Update Notification. Request for termination of the UE policy
association {notificationUri}/terminate termminate (POST) Request for
termination of the policy association.
* * *
### 5.5.2 Policy Update Notification
#### 5.5.2.1 Description
This notification is used by the H-PCF to provide updates of UE policies to
the V-PCF as NF service consumer, and used by the V-PCF to provide updates of
policy control request triggers to the AMF as NF service consumer.
#### 5.5.2.2 Operation Definition
This operation shall support the request data structures specified in table
5.5.2.2-1 and the response data structure and response codes specified in
table 5.5.2.2-2.
Table 5.5.2.2-1: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description PolicyUpdate M 1 Updated policies.
* * *
Table 5.5.2.2-2: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | UeRequ | O | 0..1 | 200 OK | The current | | estedValueRep | | | | applicable | | | | | | values | | | | | | corresponding | | | | | | to the policy | | | | | | control | | | | | | request | | | | | | trigger are | | | | | | reported. | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | The policies | | | | | Content | were | | | | | | successfully | | | | | | updated. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | The NF | | irectResponse | | | Redirect | service | | | | | | consumer | | | | | | shall | | | | | | generate a | | | | | | Location | | | | | | header field | | | | | | containing a | | | | | | URI pointing | | | | | | to another NF | | | | | | service | | | | | | consumer to | | | | | | which the | | | | | | notification | | | | | | should be | | | | | | sent. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during UE | | | | | | policy | | | | | | notification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI | | | | | | representing | | | | | | the end point | | | | | | of an | | | | | | alternative | | | | | | NF consumer | | | | | | (service) | | | | | | instance | | | | | | where the | | | | | | notification | | | | | | should be | | | | | | sent. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 404 Not Found | The NF | | roblemDetails | | | | service | | | | | | consumer can | | | | | | use this | | | | | | response when | | | | | | the | | | | | | notification | | | | | | can be sent | | | | | | to another | | | | | | unknown host. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"Er | | | | | | rorResponse\" | | | | | | is supported. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 400 Bad | (NOTE 2) | | roblemDetails | | | Request | | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | clause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.5.2.2-3: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI representing the end point of an alternative NF service consumer (service)
instance towards which the notification should be redirected. 3gpp-Sbi-Target-
Nf-Id string O 0..1 Identifier of the target NF (service) instance towards
which the notification request is redirected. May be included if the feature
\"ES3XX\" is supported.
* * *
Table 5.5.2.2-4: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI representing the end point of an alternative NF consumer (service)
instance towards which the notification should be redirected. 3gpp-Sbi-Target-
Nf-Id string O 0..1 Identifier of the target NF (service) instance towards
which the notification request is redirected
* * *
### 5.5.3 Request for termination of the UE policy association
#### 5.5.3.1 Description
This notification is used by the PCF to request the termination of a UE policy
association.
#### 5.5.3.2 Operation Definition
This operation shall support the request data structures specified in table
5.5.3.2-1 and the response data structure and response codes specified in
table 5.5.3.2-2.
Table 5.5.3.2-1: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description TerminationNotification M 1 Request to
terminate the policy association.
* * *
Table 5.5.3.2-2: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | The request | | | | | Content | for policy | | | | | | association | | | | | | termination | | | | | | was received. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during UE | | | | | | policy | | | | | | notification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI | | | | | | representing | | | | | | the end point | | | | | | of an | | | | | | alternative | | | | | | NF consumer | | | | | | (service) | | | | | | instance | | | | | | where the | | | | | | notification | | | | | | should be | | | | | | sent as | | | | | | defined in | | | | | | c | | | | | | lause 6.5.3.2 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5]. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during UE | | | | | | policy | | | | | | notification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI | | | | | | representing | | | | | | the end point | | | | | | of an | | | | | | alternative | | | | | | NF consumer | | | | | | (service) | | | | | | instance | | | | | | where the | | | | | | notification | | | | | | should be | | | | | | sent as | | | | | | defined in | | | | | | c | | | | | | lause 6.5.3.2 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5]. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 404 Not Found | The NF | | roblemDetails | | | | service | | | | | | consumer can | | | | | | use this | | | | | | response when | | | | | | the | | | | | | notification | | | | | | can be sent | | | | | | to another | | | | | | unknown host. | +---------------+---+-------------+---------------+---------------+ | NOTE: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | also apply. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.5.3.2-3: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 A URI pointing to
the endpoint of another NF service consumer to which the notification should
be sent 3gpp-Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF
(service) instance towards which the notification request is redirected. It
may be included if the feature \"ES3XX\" is supported.
* * *
Table 5.5.3.2-4: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI representing the end point of an alternative NF consumer (service)
instance towards which the notification should be redirected. 3gpp-Sbi-Target-
Nf-Id string O 0..1 Identifier of the target NF (service) instance towards
which the notification request is redirected
* * *
## 5.6 Data Model
### 5.6.1 General
This clause specifies the application data model supported by the API.
Table 5.6.1-1 specifies the data types defined for the Npcf_UEPolicyControl
service based interface protocol.
Table 5.6.1-1: Npcf_UEPolicyControl specific Data Types
* * *
Data type Section defined Description Applicability Pc5Capability 5.6.3.5
Indicates the specific PC5 RAT(s) which the UE supports for V2X communications
over PC5 reference point. V2X ProSeCapability 5.6.3.6 Indicates the 5G ProSe
capabilities. ProSe PolicyAssociation 5.6.2.2 Description of a policy
association that is returned by the PCF when a policy Association is created,
updated, or read.  
PolicyAssociationReleaseCause 5.6.3.4 The cause why the PCF requests the
termination of the policy association.  
PolicyAssociationRequest 5.6.2.3 Information that NF service consumer provides
when requesting the creation of a policy association.  
PolicyAssociationUpdateRequest 5.6.2.4 Information that NF service consumer
provides when requesting the update of a policy association.  
PolicyUpdate 5.6.2.5 Updated policies that the PCF provides in a notification
or in the reply to an Update Request.  
RequestTrigger 5.6.3.3 Enumeration of possible Request Triggers.  
TerminationNotification 5.6.2.6 Request to terminate a policy Association that
the PCF provides in a notification.  
UeRequestedValueRep 5.6.2.8 Contains the current applicable values
corresponding to the policy control request triggers. ImmediateReport UePolicy
5.6.3.2 UE Policies  
UePolicyDeliveryResult 5.6.3.2 UE Policy delivery Result  
UePolicyRequest 5.6.3.2 Request for UE Policies  
UePolicyTransferFailureNotification 5.6.2.7 Information that the UE policy is
failure to be transferred to the UE because the UE is not reachable.
* * *
Table 5.6.1-2 specifies data types re-used by the Npcf_UEPolicyControl service
based interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of their
use within the Npcf_UEPolicyControl service based interface.
Table 5.6.1-2: Npcf_UEPolicyControl re-used Data Types
* * *
Data type Reference Comments Applicability AccessType 3GPP TS 29.571 [11]  
Bytes 3GPP TS 29.571 [11] String with format \"byte\".  
CmState 3GPP TS 29.518 [14] Connectivity state of UE ConnectivityStateChange
Fqdn 3GPP TS 29.571 [11] FQDN  
Gpsi 3GPP TS 29.571 [11] Generic Public Subscription Identifier  
GroupId 3GPP TS 29.571 [11]  
Guami 3GPP TS 29.571 [11] Globally Unique AMF Identifier  
Ipv4Addr 3GPP TS 29.571 [11]  
Ipv6Addr 3GPP TS 29.571 [11]  
N1N2MessageTransferCause 3GPP TS 29.518 [14]  
N2InfoContent 3GPP TS 29.518 [14] Represents a transparent N2 information
content to be relayed by AMF. V2X, ProSe NfInstanceId 3GPP TS 29.571 [11]  
Pei 3GPP TS 29.571 [11] Permanent Equipment Identifier  
PlmnId 3GPP TS 29.571 [11]  
PlmnIdNid 3GPP TS 29.571 [11] Identifies the network: PLMN Identifier or the
SNPN Identifier (the PLMN Identifier and the NID).  
PresenceInfo 3GPP TS 29.571 [11] Presence reporting area information  
ProblemDetails 3GPP TS 29.571 [11]  
RatType 3GPP TS 29.571 [11]  
RedirectResponse 3GPP TS 29.571 [11] Contains redirection related information.
ES3XX ServiceName 3GPP TS 29.510 [13] Name of the service instance.  
Supi 3GPP TS 29.571 [11] Subscription Permanent Identifier  
SupportedFeatures 3GPP TS 29.571 [11] Used to negotiate the applicability of
the optional features defined in table 5.8-1.  
TimeZone 3GPP TS 29.571 [11]  
Uinteger 3GPP TS 29.571 [11]  
Uri 3GPP TS 29.571 [11]  
UserLocation 3GPP TS 29.571 [11]
* * *
### 5.6.2 Structured data types
#### 5.6.2.1 Introduction
This clause defines the structures to be used in resource representations.
#### 5.6.2.2 Type PolicyAssociation
Table 5.6.2.2-1: Definition of type PolicyAssociation
* * *
Attribute name Data type P Cardinality Description Applicability request
PolicyAssociationRequest O 0..1 The information provided by the NF service
consumer when requesting the creation of a policy association  
uePolicy UePolicy O 0..1 The UE policy as determined by the H-PCF (for the
H-PCF as NF service producer).  
n2Pc5Pol N2InfoContent O 0..1 The N2 PC5 policy for V2X communications as
determined by the H-PCF. V2X n2Pc5ProSePol N2InfoContent O 0..1 The N2 PC5
policy for 5G ProSe as determined by the PCF. ProSe triggers
array(RequestTrigger) O 1..N Request Triggers to which the PCF subscribes.
Only the values \"LOC_CH\", \"PRA_CH\", \"PLMN_CH\" and \"CON_STATE_CH\" are
permitted. (NOTE) pras map(PresenceInfo) C 1..N If the Request Trigger
\"PRA_CH\" is provided, the presence reporting area(s) for which reporting is
requested shall be provided. The \"praId\" attribute within the PresenceInfo
data type shall also be the key of the map. The \"presenceState\" and the
\"additionalPraId\" attributes within the PresenceInfo data type shall not be
supplied. The \"praId\" attribute within the PresenceInfo data type shall
include the identifier of either a presence reporting area or a presence
reporting area set.  
suppFeat SupportedFeatures M 1 Indicates the negotiated supported features.  
NOTE: The \"PLMN_CH\" and \"CON_STATE_CH\" values in the \"triggers\"
attribute apply under feature control as described in clause 4.2.3.2.
* * *
#### 5.6.2.3 Type PolicyAssociationRequest
Table 5.6.2.3-1: Definition of type PolicyAssociationRequest
* * *
Attribute name Data type P Cardinality Description Applicability
notificationUri Uri M 1 Identifies the recipient of Notifications sent by the
PCF.  
altNotifIpv4Addrs array(Ipv4Addr) O 1..N Alternate or backup IPv4 Addess(es)
where to send Notifications.  
altNotifIpv6Addrs array(Ipv6Addr) O 1..N Alternate or backup IPv6 Addess(es)
where to send Notifications.  
altNotifFqdns array(Fqdn) O 1..N Alternate or backup FQDN(s) where to send
Notifications.  
supi Supi M 1 Subscription Permanent Identifier.  
gpsi Gpsi C 0..1 Generic Public Subscription Identifier. Shall be provided
when available.  
accessType AccessType C 0..1 The Access Type where the served UE is camping.
Shall be provided when available.  
pei Pei C 0..1 The Permanent Equipment Identifier of the served UE. Shall be
provided when available.  
userLoc UserLocation C 0..1 The location of the served UE. Shall be provided
when available.  
timeZone TimeZone C 0..1 The time zone where the served UE is camping. Shall
be provided when available.  
servingPlmn PlmnIdNid C 0..1 The serving network (a PLMN or an SNPN) where the
served UE is camping. For the SNPN the NID together with the PLMN ID
identifies the SNPN. Shall be provided when available.  
ratType RatType C 0..1 The RAT Type where the served UE is camping. Shall be
provided when available.  
groupIds array(GroupId) C 1..N Internal Group Identifier(s) of the served UE.
Shall be provided when available.  
hPcfId NfInstanceId C 0..1 H-PCF Identifier. Shall be provided when available.  
uePolReq UePolicyRequest C 0..1 A request for UE Policies. Shall be provided
when the AMF receives an \"UE STATE INDICATION\" message, as defined in Annex
D.5.4 of 3GPP TS 24.501 [15].  
guami Guami C 0..1 The Globally Unique AMF Identifier (GUAMI) shall be
provided by an AMF as NF service consumer.  
serviceName ServiceName O 0..1 If the NF service consumer is an AMF, it should
provide the name of a service produced by the AMF that makes use of
information received within the Npcf_UEPolicyControl_UpdateNotify service
operation.  
servingNfId NfInstanceId C 0..1 If the NF service consumer is an AMF, it shall
contain the identifier of the serving AMF.  
pc5Capab Pc5Capability C 0..1 Indicates the PC5 Capability for V2X
communications supported by the UE. It shall be provided when available at the
NF service consumer. V2X proSeCapab array(ProSeCapability) C 1..N Indicates
whether the UE is capable of one or more of the the following 5G ProSe
Capabilities: 5G ProSe Direct Discovery, 5G ProSe Direct Communication,
Layer-2 and/or Layer 3 5G ProSe UE-to-Network Relay and Layer-2 and/or Layer 3
5G ProSe Remote UE. It shall be provided when available at the NF service
consumer. ProSe suppFeat SupportedFeatures M 1 Indicates the features
supported by the service consumer.
* * *
#### 5.6.2.4 Type PolicyAssociationUpdateRequest
Table 5.6.2.4-1: Definition of type PolicyAssociationUpdateRequest
* * *
Attribute name Data type P Cardinality Description Applicability  
notificationUri Uri O 0..1 Identifies the recipient of Notifications sent by
the PCF.  
altNotifIpv4Addrs array(Ipv4Addr) O 1..N Alternate or backup IPv4 Address(es)
where to send Notifications.  
altNotifIpv6Addrs array(Ipv6Addr) O 1..N Alternate or backup IPv6 Address(es)
where to send Notifications.  
altNotifFqdns array(Fqdn) O 1..N Alternate or backup FQDN(s) where to send
Notifications.  
triggers array(RequestTrigger) C 1..N Request Triggers that the NF service
consumer observes.  
praStatuses map(PresenceInfo) C 1..N If the Trigger \"PRA_CH\" is reported,
the UE presence status for tracking area for which changes of the UE presence
occurred shall be provided. The \"praId\" attribute within the PresenceInfo
data type shall also be the key of the map. The \"presenceState\" attribute
within the PresenceInfo data type shall be supplied. The \"additionalPraId\"
attribute within the PresenceInfo data type shall not be supplied. The
\"praId\" attribute within the PresenceInfo data type shall include the
identifier of an individual presence reporting area.  
userLoc UserLocation C 0..1 The location of the served UE shall be provided
for trigger \"LOC_CH\".  
uePolDelResult UePolicyDeliveryResult C 0..1 UE Policy Delivery Result. Shall
be provided together with trigger \"UE_POLICY\" when a \"MANAGE UE POLICY
COMPLETE\" message or a \"MANAGE UE POLICY COMMAND REJECT\" message, as
defined in Annex D.5 of 3GPP TS 24.501 [15], has been received by the V-PCF
and is being forwarded to the H-PCF.  
uePolTransFailNotif UePolicyTransferFailureNotification C 0..1 The UE policy
transfer failure notification. Shall be the provided together with trigger
\"UE_POLICY\" when a response with HTTP status code 4xx or 5xx as defined in
clause 5.2.2.3.1.2 of 3GPP TS 29.518 [14] or a N1N2 Transfer Failure
Notification as defined in clause 5.2.2.3.2 of 3GPP TS 29.518 [14] is received
after the V-PCF provisioned the UE policy by invoking the
Namf_Communication_N1N2MessageTransfer service operation to the AMF and is
notifying the H-PCF.  
uePolReq UePolicyRequest C 0..1 A request for UE Policies. Shall be provided
together with trigger \"UE_POLICY\" when the V-PCF receives an \"UE POLICY
PROVISIONING REQUEST\" message, as defined in clause 7.2.1.1 of 3GPP TS 24.587
[24], if the \"V2X\" feature is supported, and/or when the V-PCF receives an
\"UE POLICY PROVISIONING REQUEST\" message for 5G ProSe, as defined in clause
10.4.1 of 3GPP TS 24.554 [28], if the \"ProSe\" feature is supported. V2X,
ProSe  
guami Guami C 0..1 The Globally Unique AMF Identifier (GUAMI) shall be
provided by an AMF as NF service consumer during the AMF relocation.  
servingNfId NfInstanceId C 0..1 It shall contain the identifier of the new AMF
during the AMF relocation.  
plmnId PlmnIdNid C 0..1 The serving network identity (a PLMN or an SNPN) of
the served UE shall be provided for trigger \"PLMN_CH\". PlmnChange  
connectState CmState C 0..1 The connectivity state of the served UE shall be
provided for trigger \"CON_STATE_CH\". ConnectivityStateChange  
groupIds array(GroupId) C 1..N Internal Group Identifier(s) of the served UE.
Shall be provided for trigger \"GROUP_ID_LIST_CHG\". GroupIdListChange  
proSeCapab array(ProSeCapability) O 1..N Indicates whether the UE is capable
of one or more of the the following 5G ProSe Capabilities: 5G ProSe Direct
Discovery, 5G ProSe Direct Communication, Layer-2 and/or Layer 3 5G ProSe UE-
to-Network Relay and Layer-2 and/or Layer 3 5G ProSe Remote UE. ProSe
* * *
#### 5.6.2.5 Type PolicyUpdate
Table 5.6.2.5-1: Definition of type PolicyUpdate
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | re | Uri | M | 1 | The | | | sourceUri | | | | resource | | | | | | | URI of | | | | | | | the | | | | | | | i | | | | | | | ndividual | | | | | | | UE policy | | | | | | | as | | | | | | | sociation | | | | | | | related | | | | | | | to the | | | | | | | noti | | | | | | | fication. | | | | | | | | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | uePolicy | UePolicy | O | 0..1 | The UE | | | | | | | policy as | | | | | | | d | | | | | | | etermined | | | | | | | by the | | | | | | | H-PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | n2Pc5Pol | N2In | O | 0..1 | The N2 | V2X | | | foContent | | | PC5 | | | | | | | policy | | | | | | | for V2X | | | | | | | commu | | | | | | | nications | | | | | | | as | | | | | | | d | | | | | | | etermined | | | | | | | by the | | | | | | | H-PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | n2Pc | N2In | O | 0..1 | The N2 | ProSe | | 5ProSePol | foContent | | | PC5 | | | | | | | policy | | | | | | | for 5G | | | | | | | ProSe as | | | | | | | d | | | | | | | etermined | | | | | | | by the | | | | | | | PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | triggers | arr | O | 1..N | Request | (NOTE 1) | | | ay(Reques | | | Triggers | | | | tTrigger) | | | that the | | | | | | | PCF | | | | | | | su | | | | | | | bscribes. | | | | | | | Only | | | | | | | values | | | | | | | \"L | | | | | | | OC_CH\", | | | | | | | \"P | | | | | | | RA_CH\", | | | | | | | \"P | | | | | | | LMN_CH\" | | | | | | | and | | | | | | | \"CON_ST | | | | | | | ATE_CH\" | | | | | | | are | | | | | | | p | | | | | | | ermitted. | | +-----------+-----------+---+-----------+-----------+-----------+ | pras | map(Pres | C | 1..N | If the | | | | enceInfo) | | | Trigger | | | | | | | \" | | | | | | | PRA_CH\" | | | | | | | is | | | | | | | provided | | | | | | | or if | | | | | | | that | | | | | | | trigger | | | | | | | was | | | | | | | already | | | | | | | set but | | | | | | | the | | | | | | | requested | | | | | | | presence | | | | | | | reporting | | | | | | | areas | | | | | | | need to | | | | | | | be | | | | | | | changed, | | | | | | | the | | | | | | | presence | | | | | | | reporting | | | | | | | area(s) | | | | | | | for which | | | | | | | reporting | | | | | | | is | | | | | | | requested | | | | | | | shall be | | | | | | | provided. | | | | | | | The | | | | | | | \"praId\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall | | | | | | | also be | | | | | | | the key | | | | | | | of the | | | | | | | map. The | | | | | | | \"presen | | | | | | | ceState\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall not | | | | | | | be | | | | | | | supplied. | | | | | | | The | | | | | | | \"praId\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall | | | | | | | include | | | | | | | the | | | | | | | i | | | | | | | dentifier | | | | | | | of either | | | | | | | a | | | | | | | presence | | | | | | | reporting | | | | | | | area or a | | | | | | | presence | | | | | | | reporting | | | | | | | area set. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | The | | | | | | | \"P | | | | | | | LMN_CH\" | | | | | | | and | | | | | | | \"CON_ST | | | | | | | ATE_CH\" | | | | | | | values in | | | | | | | the | | | | | | | \"t | | | | | | | riggers\" | | | | | | | attribute | | | | | | | apply | | | | | | | under | | | | | | | feature | | | | | | | control | | | | | | | as | | | | | | | described | | | | | | | in | | | | | | | clause | | | | | | | 4.2.3.2. | | | | | | | | | | | | | | NOTE 2: | | | | | | | When the | | | | | | | Pol | | | | | | | icyUpdate | | | | | | | data type | | | | | | | is used | | | | | | | in a | | | | | | | policy | | | | | | | update | | | | | | | notify | | | | | | | service | | | | | | | o | | | | | | | peration, | | | | | | | either | | | | | | | the | | | | | | | complete | | | | | | | resource | | | | | | | URI | | | | | | | included | | | | | | | in the | | | | | | | \"reso | | | | | | | urceUri\" | | | | | | | attribute | | | | | | | or the | | | | | | | \"a | | | | | | | piSpecifi | | | | | | | cResource | | | | | | | UriPart\" | | | | | | | component | | | | | | | (see | | | | | | | cl | | | | | | | ause 5.1) | | | | | | | of the | | | | | | | resource | | | | | | | URI | | | | | | | included | | | | | | | in the | | | | | | | \"reso | | | | | | | urceUri\" | | | | | | | attribute | | | | | | | may be | | | | | | | used by | | | | | | | the NF | | | | | | | service | | | | | | | consumer | | | | | | | (e.g. | | | | | | | AMF) for | | | | | | | the | | | | | | | ident | | | | | | | ification | | | | | | | of the | | | | | | | I | | | | | | | ndividual | | | | | | | UE Policy | | | | | | | As | | | | | | | sociation | | | | | | | resource | | | | | | | related | | | | | | | to the | | | | | | | noti | | | | | | | fication. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.6 Type TerminationNotification
Table 5.6.2.6-1: Definition of type TerminationNotification
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | re | Uri | M | 1 | The | | | sourceUri | | | | resource | | | | | | | URI of | | | | | | | the | | | | | | | i | | | | | | | ndividual | | | | | | | UE policy | | | | | | | as | | | | | | | sociation | | | | | | | related | | | | | | | to the | | | | | | | noti | | | | | | | fication. | | | | | | | | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | cause | Po | M | 1 | The cause | | | | licyAssoc | | | why the | | | | iationRel | | | PCF | | | | easeCause | | | requests | | | | | | | the | | | | | | | te | | | | | | | rmination | | | | | | | of the | | | | | | | policy | | | | | | | ass | | | | | | | ociation. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: | | | | | | | Either | | | | | | | the | | | | | | | complete | | | | | | | resource | | | | | | | URI | | | | | | | included | | | | | | | in the | | | | | | | \"reso | | | | | | | urceUri\" | | | | | | | attribute | | | | | | | or the | | | | | | | \"a | | | | | | | piSpecifi | | | | | | | cResource | | | | | | | UriPart\" | | | | | | | component | | | | | | | (see | | | | | | | cl | | | | | | | ause 5.1) | | | | | | | of the | | | | | | | resource | | | | | | | URI | | | | | | | included | | | | | | | in the | | | | | | | \"reso | | | | | | | urceUri\" | | | | | | | attribute | | | | | | | may be | | | | | | | used by | | | | | | | the NF | | | | | | | service | | | | | | | consumer | | | | | | | (e.g. | | | | | | | AMF) for | | | | | | | the | | | | | | | ident | | | | | | | ification | | | | | | | of the | | | | | | | I | | | | | | | ndividual | | | | | | | UE Policy | | | | | | | As | | | | | | | sociation | | | | | | | resource | | | | | | | related | | | | | | | to the | | | | | | | te | | | | | | | rmination | | | | | | | noti | | | | | | | fication. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.7 Type UePolicyTransferFailureNotification
Table 5.6.2.7-1: UEPolicyTransferFailureNotification
* * *
Attribute name Data type P Cardinality Description Applicability cause
N1N2MessageTransferCause M 1 Indicates the reason why the UE policy could not
be transferred by the AMF.  
ptis array(Uinteger) M 1..N Contains a list of PTI assigned by the H-PCF
corresponding to the UE policy(s) which could not be transferred by the AMF.
* * *
#### 5.6.2.8 Type UeRequestedValueRep
Table 5.6.2.8-1: Definition of type UeRequestedValueRep
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | userLoc | Use | O | 0..1 | The | | | | rLocation | | | location | | | | | | | of the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | pr | map(Pres | O | 1..N | The UE | | | aStatuses | enceInfo) | | | presence | | | | | | | statuses | | | | | | | for | | | | | | | tracking | | | | | | | areas. | | | | | | | | | | | | | | The | | | | | | | \"praId\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall | | | | | | | also be | | | | | | | the key | | | | | | | of the | | | | | | | map. | | +-----------+-----------+---+-----------+-----------+-----------+ | plmnId | PlmnIdNid | C | 0..1 | The | P | | | | | | serving | lmnChange | | | | | | network | | | | | | | identity | | | | | | | (a PLMN | | | | | | | or an | | | | | | | SNPN) of | | | | | | | the | | | | | | | served UE | | | | | | | shall be | | | | | | | provided | | | | | | | for | | | | | | | trigger | | | | | | | \"PL | | | | | | | MN_CH\". | | +-----------+-----------+---+-----------+-----------+-----------+ | con | CmState | O | 0..1 | The | Conne | | nectState | | | | con | ctivitySt | | | | | | nectivity | ateChange | | | | | | state of | | | | | | | the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+
### 5.6.3 Simple data types and enumerations
#### 5.6.3.1 Introduction
This clause defines simple data types and enumerations that can be referenced
from data structures defined in the previous clauses.
#### 5.6.3.2 Simple data types
The simple data types defined in table 5.6.3.2-1 shall be supported.
Table 5.6.3.2-1: Simple data types
* * *
Type Name Type Definition Description Applicability UePolicy Bytes \"MANAGE UE
POLICY COMMAND\" message content, as defined in Table D.5.1.1.1 of 3GPP TS
24.501 [15]  
UePolicyDeliveryResult Bytes \"MANAGE UE POLICY COMPLETE\" message content, as
defined in Table D.5.2.1.1 of 3GPP TS 24.501 [15], or \"MANAGE UE POLICY
COMMAND REJECT\" message content, as defined in Table D.5.3.1.1 of 3GPP TS
24.501 [15]  
UePolicyRequest Bytes \"UE STATE INDICATION\" message content, as defined in
Table D.5.4.1.1 of 3GPP TS 24.501 [15] or \"UE POLICY PROVISIONING REQUEST\"
message content, as defined in clause 7.2.1.1 of 3GPP TS 24.587 [24].
* * *
#### 5.6.3.3 Enumeration: RequestTrigger
The enumeration RequestTrigger represents the possible Policy Control Request
Triggers.. It shall comply with the provisions defined in table 5.6.3.3-1.
Table 5.6.3.3-1: Enumeration RequestTrigger
+----------------------+----------------------+----------------------+ | Enumeration value | Description | Applicability | +----------------------+----------------------+----------------------+ | LOC_CH | Location change | | | | (tracking area): the | | | | tracking area of the | | | | UE has changed. | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | PRA_CH | Change of UE | | | | presence in PRA: the | | | | AMF reports the | | | | current presence | | | | status of the UE in | | | | a Presence Reporting | | | | Area, and notifies | | | | that the UE | | | | enters/leaves the | | | | Presence Reporting | | | | Area. (NOTE) | | +----------------------+----------------------+----------------------+ | UE_POLICY | A \"MANAGE UE POLICY | | | | COMPLETE\" message, | | | | a \"MANAGE UE POLICY | | | | COMMAND REJECT\" | | | | message, as defined | | | | in Annex D.5 of | | | | 3 | | | | GPP TS 24.501 [15] | | | | has been received by | | | | the V-PCF and is | | | | being forwarded to | | | | the H-PCF. A | | | | Namf_Communication\ | | | | _N1N2MessageTransfer | | | | failure response as | | | | defined in | | | | clause 5.2.2.3.1.2 | | | | of | | | | 3G | | | | PP TS 29.518 [14], | | | | or an N1N2 Transfer | | | | Failure Notification | | | | as defined in | | | | clause 5.2.2.3.2 of | | | | 3G | | | | PP TS 29.518 [14], | | | | a UE Policy transfer | | | | failure is notifying | | | | to the H-PCF. | | | | | | | | When the \"ProSe\" | | | | feature is supported | | | | it indicates that a | | | | \"UE POLICY | | | | PROVISIONING | | | | REQUEST\" message, | | | | as defined in | | | | clause 10.4 of | | | | 3 | | | | GPP TS 24.554 [28] | | | | has been received by | | | | the V-PCF and is | | | | being forwarded to | | | | the H-PCF. | | | | | | | | When the \"V2X\" | | | | feature is supported | | | | it indicates that a | | | | \"UE POLICY | | | | PROVISIONING | | | | REQUEST\" message, | | | | as defined in | | | | clause 7.2 of | | | | 3 | | | | GPP TS 24.587 [24] | | | | has been received by | | | | the V-PCF and is | | | | being forwarded to | | | | the H-PCF. | | | | | | | | This event does not | | | | require a | | | | subscription and is | | | | only applicable for | | | | the Vâ€‘PCF as NF | | | | service consumer and | | | | the Hâ€‘PCF as NF | | | | service producer. | | +----------------------+----------------------+----------------------+ | PLMN_CH | PLMN change: the | PlmnChange | | | serving network (a | | | | PLMN or an SNPN) of | | | | UE has changed. | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | CON_STATE_CH | Connectivity state | Con | | | change: the | nectivityStateChange | | | connectivity state | | | | of UE has changed. | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | GROUP_ID_LIST_CHG | UE Internal Group | GroupIdListChange | | | Identifier(s) has | | | | changed: the AMF | | | | reports that UDM | | | | provided list of | | | | group Ids has | | | | changed. This policy | | | | control request | | | | trigger does not | | | | require a | | | | subscription. | | +----------------------+----------------------+----------------------+ | UE_CAP_CH | UE Capabilities | ProSe | | | change: the UE | | | | provided 5G ProSe | | | | capabilities have | | | | changed. This policy | | | | control request | | | | trigger does not | | | | require | | | | subscription. | | +----------------------+----------------------+----------------------+ | NOTE: The report of | | | | this trigger | | | | includes reporting | | | | the current value at | | | | the time the trigger | | | | is provisioned | | | | during the update or | | | | update notification | | | | of the policy | | | | association. | | | +----------------------+----------------------+----------------------+
#### 5.6.3.4 Enumeration: PolicyAssociationReleaseCause
The enumeration PolicyAssociationReleaseCause represents the cause why the PCF
requests the termination of the policy association. It shall comply with the
provisions defined in table 5.6.3.4-1.
Table 5.6.3.4-1: Enumeration PolicyAssociationReleaseCause
* * *
Enumeration value Description Applicability UNSPECIFIED This value is used for
unspecified reasons.  
UE_SUBSCRIPTION This value is used to indicate that the policy association
needs to be terminated because the subscription of UE has changed (e.g. was
removed).  
INSUFFICIENT_RES This value is used to indicate that the server is overloaded
and needs to abort the policy association.
* * *
#### 5.6.3.5 Enumeration: Pc5Capability
The enumeration Pc5Capability indicates the specific PC5 RAT(s) which the UE
supports for V2X communication over PC5 reference point. It shall comply with
the provisions defined in table 5.6.3.5-1.
Table 5.6.3.5-1: Enumeration Pc5Capability
* * *
Enumeration value Description Applicability LTE_PC5 This value is used to
indicate that UE supports PC5 LTE RAT for V2X communication over PC5 reference
point.  
NR_PC5 This value is used to indicate that UE supports PC5 NR RAT for V2X
communication over PC5 reference point.  
LTE_NR_PC5 This value is used to indicate that UE supports both PC5 LTE and NR
RAT for V2X communication over PC5 reference point.
* * *
#### 5.6.3.6 Enumeration: ProSeCapability
This enumeration indicates the 5G ProSe capabilities. It shall comply with the
provisions defined in table 5.6.3.6-1.
Table 5.6.3.6-1: Enumeration ProSeCapability
* * *
Enumeration value Description Applicability PROSE_DD This value is used to
indicate that 5G ProSe Direct Discovery is supported by the UE.  
PROSE_DC This value is used to indicate that 5G ProSe Direct Communication is
supported by the UE.  
PROSE_L2_U2N_RELAY This value is used to indicate that Layer-2 5G ProSe UE-to-
Network Relay is supported by the UE.  
PROSE_L3_U2N_RELAY This value is used to indicate that Layer-3 5G ProSe UE-to-
Network Relay is supported by the UE.  
PROSE_L2_REMOTE_UE This value is used to indicate that Layer-2 5G ProSe Remote
UE is supported by the UE.  
PROSE_L3_REMOTE_UE This value is used to indicate that Layer-3 5G ProSe Remote
UE is supported by the UE.
* * *
## 5.7 Error handling
### 5.7.1 General
For the Npcf_UEPolicyControl API, HTTP error responses shall be supported as
specified in clause 4.8 of 3GPP TS 29.501 [6].
Protocol errors and application errors specified in table 5.2.7.2-1 of 3GPP TS
29.500 [5] shall be supported for an HTTP method if the corresponding HTTP
status codes are specified as mandatory for that HTTP method in table
5.2.7.1-1 of 3GPP TS 29.500 [5].
In addition, the requirements in the following clauses are applicable for the
Npcf_UEPolicyControl API.
### 5.7.2 Protocol Errors
No specific protocol errorsfor the Npcf_UEPolicyControl API are specified.
### 5.7.3 Application Errors
The application errors defined for the Npcf_UEPolicyControl service are listed
in Table 5.7.3-1 and Table 5.7.3-2.
Table 5.7.3-1: Application errors when PCF acts as a server
* * *
Application Error HTTP status code Description USER_UNKNOWN 400 Bad Request
The HTTP request is rejected because the end user specified in the request is
unknown to the PCF. ERROR_REQUEST_PARAMETERS 400 Bad Request The HTTP request
is rejected because the set of information needed by the PCF for UE Policy
selection is incomplete or erroneous or not available for the decision to be
made. PENDING_TRANSACTION 400 Bad Request This error shall be used when the
PendingTransaction feature is supported and the PCF receives an incoming
request on a policy association while it has an ongoing transaction on the
same policy association and cannot handle the request as described in clause
9.2 of 3GPP TS 29.513 [7]. POLICY_ASSOCIATION_NOT_FOUND 404 Not Found The HTTP
request is rejected because no UE policy association corresponding to the
request exists in the PCF. NOTE: Including a \"ProblemDetails\" data structure
with the \"cause\" attribute in the HTTP response is optional unless
explicitly mandated in the service operation clauses.
* * *
Table 5.7.3-2: Application errors when NF service consumer acts as a server to
receive a notification
+------------------------+------------------+------------------------+ | Application Error | HTTP status code | Description | +------------------------+------------------+------------------------+ | PENDING_TRANSACTION | 400 Bad Request | This error shall be | | | | used when the | | | | PendingTransaction | | | | feature is supported | | | | and the NF service | | | | consumer receives an | | | | incoming request on a | | | | policy association | | | | while it has an | | | | ongoing transaction on | | | | the same policy | | | | association and cannot | | | | handle the request as | | | | described in | | | | clause 9.2 of | | | | 3GPP TS 29.513 [7]. | | | | (NOTE 1) | +------------------------+------------------+------------------------+ | NOTE 1: This | | | | application error is | | | | included in the | | | | response to the Policy | | | | Update Notification | | | | HTTP POST request. | | | | | | | | NOTE 2: Including a | | | | \"ProblemDetails\" | | | | data structure with | | | | the \"cause\" | | | | attribute in the HTTP | | | | response is optional | | | | unless explicitly | | | | mandated in the | | | | service operation | | | | clauses. | | | +------------------------+------------------+------------------------+
## 5.8 Feature negotiation
The optional features in table 5.8-1 are defined for the Npcf_UEPolicyControl
API. They shall be negotiated using the extensibility mechanism defined in
clause 6.6 of 3GPP TS 29.500 [5].
Table 5.8-1: Supported Features
* * *
Feature number Feature Name Description 1 PendingTransaction This feature
indicates support for the race condition handling as defined in 3GPP TS 29.513
[7]. 2 PlmnChange This feature indicates support for the change of PLMN
trigger handling. 3 ConnectivityStateChange This feature indicates support for
the UE connectivity state change trigger handling. 4 V2X This feature
indicates support for the UE policy provisioning and N2 information
provisioning for V2X communications. 5 GroupIdListChange This feature
indicates the support for the notification of changes in the list of internal
group identifiers. 6 ImmediateReport This feature indicates the support of the
current applicable values report corresponding to the policy control request
triggers for policy update notification. 7 ErrorResponse This feature
indicates support for \"404 Not Found\" error response code for policy update
notification between AMF and (V-)PCF. 8 ES3XX Extended Support for 3xx
redirections. This feature indicates the support of redirection for any
service operation, according to Stateless NF procedures as specified in
clauses 6.5.3.2 and 6.5.3.3 of 3GPP TS 29.500 [5] and according to HTTP
redirection principles for indirect communication, as specified in clause
6.10.9 of 3GPP TS 29.500 [5]. 9 ProSe This feature indicates support of UE
policy and N2 information provisioning for 5G ProSe.
* * *
## 5.9 Security
As indicated in 3GPP TS 33.501 [19] and 3GPP TS 29.500 [5], the access to the
Npcf_UEPolicyControl API may be authorized by means of the OAuth2 protocol
(see IETF RFC 6749 [20]), based on local configuration, using the \"Client
Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [13])
plays the role of the authorization server.
If OAuth2 is used, an NF service consumer, prior to consuming services offered
by the Npcf_UEPolicyControl API, shall obtain a \"token\" from the
authorization server, by invoking the Access Token Request service, as
described in 3GPP TS 29.510 [13], clause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF service consumer used for
discovering the Npcf_UEPolicyControl service.
The Npcf_UEPolicyControl API defines a single scope \"npcf-ue-policy-control\"
for the entire service, and it does not define any additional scopes at
resource or operation level.
###### ## Annex A (normative): OpenAPI specification
# A.1 General
The present Annex contains an OpenAPI [10] specification of HTTP messages and
content bodies used by the Npcf_UEPolicyControl API.
This Annex shall take precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API.
NOTE: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification file contained in this 3GPP
Technical Specification are available on a Git-based repository that uses the
GitLab software version control system (see clause 5B of the 3GPP TR 21.900
[22] and clause 5.3.1 of the 3GPP TS 29.501 [6] for further information).
# A.2 Npcf_UEPolicyControl API
openapi: 3.0.0
info:
version: 1.2.1
title: Npcf_UEPolicyControl
description: \|
UE Policy Control Service.
Â© 2022, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.525 V17.9.0; 5G System; UE Policy Control Service.
url: \'https://www.3gpp.org/ftp/Specs/archive/29_series/29.525/\'
servers:
\- url: \'{apiRoot}/npcf-ue-policy-control/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in clause 4.4 of 3GPP TS 29.501
security:
\- {}
\- oAuth2ClientCredentials:
\- npcf-ue-policy-control
paths:
/policies:
post:
operationId: CreateIndividualUEPolicyAssociation
summary: Create individual UE policy association.
tags:
\- UE Policy Associations (Collection)
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/PolicyAssociationRequest\'
responses:
\'201\':
description: Created
content:
application/json:
schema:
\$ref: \'#/components/schemas/PolicyAssociation\'
headers:
Location:
description: >
Contains the URI of the newly created resource, according to the structure
{apiRoot}/npcf-ue-policy-control/v1/policies/{polAssoId}\'
required: true
schema:
type: string
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
callbacks:
policyUpdateNotification:
\'{\$request.body#/notificationUri}/update\':
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/PolicyUpdate\'
responses:
\'200\':
description: >
OK. The current applicable values corresponding to the policy control request
trigger is reported
content:
application/json:
schema:
\$ref: \'#/components/schemas/UeRequestedValueRep\'
\'204\':
description: No Content, Notification was successful
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
policyAssocitionTerminationRequestNotification:
\'{\$request.body#/notificationUri}/terminate\':
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/TerminationNotification\'
responses:
\'204\':
description: No Content, Notification was successful
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/policies/{polAssoId}:
get:
operationId: ReadIndividualUEPolicyAssociation
summary: Read individual UE policy association.
tags:
\- Individual UE Policy Association (Document)
parameters:
\- name: polAssoId
in: path
description: Identifier of a policy association
required: true
schema:
type: string
responses:
\'200\':
description: OK. Resource representation is returned
content:
application/json:
schema:
\$ref: \'#/components/schemas/PolicyAssociation\'
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'406\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/406\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
delete:
operationId: DeleteIndividualUEPolicyAssociation
summary: Delete individual UE policy association.
tags:
\- Individual UE Policy Association (Document)
parameters:
\- name: polAssoId
in: path
description: Identifier of a policy association
required: true
schema:
type: string
responses:
\'204\':
description: No Content. Resource was successfully deleted
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/policies/{polAssoId}/update:
post:
operationId: ReportObservedEventTriggersForIndividualUEPolicyAssociation
summary: >
Report observed event triggers and possibly obtain updated policies for an
individual UE
policy association.
tags:
\- Individual UE Policy Association (Document)
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/PolicyAssociationUpdateRequest\'
parameters:
\- name: polAssoId
in: path
description: Identifier of a policy association
required: true
schema:
type: string
responses:
\'200\':
description: OK. Updated policies are returned
content:
application/json:
schema:
\$ref: \'#/components/schemas/PolicyUpdate\'
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
npcf-ue-policy-control: Access to the Npcf_UEPolicyControl API
schemas:
PolicyAssociation:
description: >
Contains the description of a policy association that is returned by the PCF
when a policy
Association is created, updated, or read.
type: object
properties:
request:
\$ref: \'#/components/schemas/PolicyAssociationRequest\'
uePolicy:
\$ref: \'#/components/schemas/UePolicy\'
n2Pc5Pol:
\$ref: \'TS29518_Namf_Communication.yaml#/components/schemas/N2InfoContent\'
n2Pc5ProSePol:
\$ref: \'TS29518_Namf_Communication.yaml#/components/schemas/N2InfoContent\'
triggers:
type: array
items:
\$ref: \'#/components/schemas/RequestTrigger\'
minItems: 1
description: >
Request Triggers that the PCF subscribes. Only values \"LOC_CH\" and
\"PRA_CH\" are permitted.
pras:
type: object
additionalProperties:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PresenceInfo\'
minProperties: 1
description: >
Contains the presence reporting area(s) for which reporting was requested.
The praId attribute within the PresenceInfo data type is the key of the map.
suppFeat:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
required:
\- suppFeat
PolicyAssociationRequest:
description: >
Represents information that the NF service consumer provides when requesting
the creation of
a policy association.
type: object
properties:
notificationUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
altNotifIpv4Addrs:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
minItems: 1
description: Alternate or backup IPv4 Address(es) where to send Notifications.
altNotifIpv6Addrs:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr\'
minItems: 1
description: Alternate or backup IPv6 Address(es) where to send Notifications.
altNotifFqdns:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Fqdn\'
minItems: 1
description: Alternate or backup FQDN(s) where to send Notifications.
supi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Supi\'
gpsi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Gpsi\'
accessType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AccessType\'
pei:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Pei\'
userLoc:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
timeZone:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TimeZone\'
servingPlmn:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid\'
ratType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RatType\'
groupIds:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/GroupId\'
minItems: 1
hPcfId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
uePolReq:
\$ref: \'#/components/schemas/UePolicyRequest\'
guami:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Guami\'
serviceName:
\$ref: \'TS29510_Nnrf_NFManagement.yaml#/components/schemas/ServiceName\'
servingNfId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
pc5Capab:
\$ref: \'#/components/schemas/Pc5Capability\'
proSeCapab:
type: array
items:
\$ref: \'#/components/schemas/ProSeCapability\'
minItems: 1
suppFeat:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
required:
\- notificationUri
\- suppFeat
\- supi
PolicyAssociationUpdateRequest:
description: >
Represents Information that the NF service consumer provides when requesting
the update of
a policy association.
type: object
properties:
notificationUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
altNotifIpv4Addrs:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
minItems: 1
description: Alternate or backup IPv4 Address(es) where to send Notifications.
altNotifIpv6Addrs:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr\'
minItems: 1
description: Alternate or backup IPv6 Address(es) where to send Notifications.
altNotifFqdns:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Fqdn\'
minItems: 1
description: Alternate or backup FQDN(s) where to send Notifications.
triggers:
type: array
items:
\$ref: \'#/components/schemas/RequestTrigger\'
minItems: 1
description: Request Triggers that the NF service consumer observes.
praStatuses:
type: object
additionalProperties:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PresenceInfo\'
description: >
Contains the UE presence status for tracking area for which changes of the UE
presence
occurred. The praId attribute within the PresenceInfo data type is the key of
the map.
minProperties: 1
userLoc:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
uePolDelResult:
\$ref: \'#/components/schemas/UePolicyDeliveryResult\'
uePolTransFailNotif:
\$ref: \'#/components/schemas/UePolicyTransferFailureNotification\'
uePolReq:
\$ref: \'#/components/schemas/UePolicyRequest\'
guami:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Guami\'
servingNfId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
plmnId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid\'
connectState:
\$ref: \'TS29518_Namf_EventExposure.yaml#/components/schemas/CmState\'
groupIds:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/GroupId\'
minItems: 1
proSeCapab:
type: array
items:
\$ref: \'#/components/schemas/ProSeCapability\'
minItems: 1
PolicyUpdate:
description: >
Represents updated policies that the PCF provides in a notification or in the
reply to an
Update Request.
type: object
properties:
resourceUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
uePolicy:
\$ref: \'#/components/schemas/UePolicy\'
n2Pc5Pol:
\$ref: \'TS29518_Namf_Communication.yaml#/components/schemas/N2InfoContent\'
n2Pc5ProSePol:
\$ref: \'TS29518_Namf_Communication.yaml#/components/schemas/N2InfoContent\'
triggers:
type: array
items:
\$ref: \'#/components/schemas/RequestTrigger\'
minItems: 1
nullable: true
description: >
Request Triggers that the PCF subscribes. Only values \"LOC_CH\" and
\"PRA_CH\" are permitted.
pras:
type: object
additionalProperties:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PresenceInfo\'
description: >
Contains the presence reporting area(s) for which reporting was requested.
The praId attribute within the PresenceInfo data type is the key of the map.
minProperties: 1
nullable: true
required:
\- resourceUri
TerminationNotification:
description: >
Represents a request to terminate a policy association that the PCF provides
in a
notification.
type: object
properties:
resourceUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
cause:
\$ref: \'#/components/schemas/PolicyAssociationReleaseCause\'
required:
\- resourceUri
\- cause
UePolicyTransferFailureNotification:
description: >
Represents information on the failure of a UE policy transfer to the UE
because the UE is not
reachable.
type: object
properties:
cause:
\$ref:
\'TS29518_Namf_Communication.yaml#/components/schemas/N1N2MessageTransferCause\'
ptis:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uinteger\'
minItems: 1
required:
\- cause
\- ptis
UeRequestedValueRep:
description: >
Contains the current applicable values corresponding to the policy control
request triggers.
type: object
properties:
userLoc:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
praStatuses:
type: object
additionalProperties:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PresenceInfo\'
minProperties: 1
description: >
Contains the UE presence statuses for tracking areas. The praId attribute
within the
PresenceInfo data type is the key of the map.
plmnId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid\'
connectState:
\$ref: \'TS29518_Namf_EventExposure.yaml#/components/schemas/CmState\'
UePolicy:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Bytes\'
UePolicyDeliveryResult:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Bytes\'
UePolicyRequest:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Bytes\'
RequestTrigger:
anyOf:
\- type: string
enum:
\- LOC_CH
\- PRA_CH
\- UE_POLICY
\- PLMN_CH
\- CON_STATE_CH
\- GROUP_ID_LIST_CHG
\- UE_CAP_CH
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: \|
Possible values are:
\- LOC_CH: Location change (tracking area). The tracking area of the UE has
changed.
\- PRA_CH: Change of UE presence in PRA. The AMF reports the current presence
status of the UE
in a Presence Reporting Area, and notifies that the UE enters/leaves the
Presence Reporting
Area.
\- UE_POLICY: A MANAGE UE POLICY COMPLETE message or a MANAGE UE POLICY
COMMAND REJECT
message, as defined in Annex D.5 of 3GPP TS 24.501 or a \"UE POLICY
PROVISIONING REQUEST\"
message, as defined in clause 7.2.1.1 of 3GPP TS 24.587 , has been received by
the AMF
and is being forwarded.
\- PLMN_CH: PLMN change. the serving PLMN of UE has changed.
\- CON_STATE_CH: Connectivity state change: the connectivity state of UE has
changed.
\- GROUP_ID_LIST_CHG: UE Internal Group Identifier(s) has changed. This policy
control request
trigger does not require a subscription
\- UE_CAP_CH: UE Capabilities change: the UE provided 5G ProSe capabilities
have changed.
This policy control request trigger does not require subscription.
PolicyAssociationReleaseCause:
anyOf:
\- type: string
enum:
\- UNSPECIFIED
\- UE_SUBSCRIPTION
\- INSUFFICIENT_RES
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: \|
Possible values are:
\- UNSPECIFIED: This value is used for unspecified reasons.
\- UE_SUBSCRIPTION: This value is used to indicate that the policy association
needs to be
terminated because the subscription of UE has changed (e.g. was removed).
\- INSUFFICIENT_RES: This value is used to indicate that the server is
overloaded and needs
to abort the policy association.
Pc5Capability:
anyOf:
\- type: string
enum:
\- LTE_PC5
\- NR_PC5
\- LTE_NR_PC5
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: \|
Possible values are:
\- LTE_PC5: This value is used to indicate that UE supports PC5 LTE RAT for
V2X communications
over the PC5 reference point.
\- NR_PC5: This value is used to indicate that UE supports PC5 NR RAT for V2X
communications
over the PC5 reference point.
\- LTE_NR_PC5: This value is used to indicate that UE supports both PC5 LTE
and NR RAT for
V2X communications over the PC5 reference point.
ProSeCapability:
anyOf:
\- type: string
enum:
\- PROSE_DD
\- PROSE_DC
\- PROSE_L2_U2N_RELAY
\- PROSE_L3_U2N_RELAY
\- PROSE_L2_REMOTE_UE
\- PROSE_L3_REMOTE_UE
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
the content defined in the present version of this API.
description: \|
Possible values are:
\- PROSE_DD: This value is used to indicate that 5G ProSe Direct Discovery is
supported
by the UE.
\- PROSE_DC: This value is used to indicate that 5G ProSe Direct Communication
is supported
by the UE.
\- PROSE_L2_U2N_RELAY: This value is used to indicate that Layer-2 5G ProSe
UE-to-Network
Relay is supported by the UE.
\- PROSE_L3_U2N_RELAY: This value is used to indicate that Layer-3 5G ProSe
UE-to-Network
Relay is supported by the UE.
\- PROSE_L2_REMOTE_UE: This value is used to indicate that Layer-2 5G ProSe
Remote UE is
supported by the UE.
\- PROSE_L3_REMOTE_UE: This value is used to indicate that Layer-3 5G ProSe
Remote UE is
supported by the UE.
###### ## Annex B (normative): Wireless and wireline convergence access
support
# B.1 Scope
This annex provides the stage 3 definition of the UE Policy Control Service
for wireless and wireline convergence access support for 5GS.
The stage 2 definition and procedures of the UE Policy Control Service for
wireless and wireline convergence access support for 5GS are contained in 3GPP
TS 23.316 [23].
# B.2 Npcf_UEPolicyControl Service
## B.2.1 Service Description
### B.2.1.1 Overview
Clause 4.1.1 applies with the modification that the 5G-RG and FN-RG replace
the UE.
NOTE: The URSPs related to the FN-RG are delivered to the W-AGF, which is
acting as a UE towards the 5GC on behalf of the FN-RG.
### B.2.1.2 Service Architecture
Clause 4.1.1 applies with the exception that roaming functionality (V-PCF and
H-PCF specific functionality) shall not apply in this Release of the
specification for UE policy control for 5G-RG connecting via W-5GAN and FN-RG.
Roaming architecture is only applicable to a 5G-RG connecting to the 5GC via
NG RAN.
### B.2.1.3 Network Functions
#### B.2.1.3.1 Policy Control Function (PCF)
The PCF functionality defined in clause 4.1.3.1 shall apply with the following
differences:
\- The PCF should not provide Access Network Discovery and Selection Policy
(ANDSP) for a 5G-RG connected via wireline access.
\- The Visited Policy Control Function (V-PCF) shall not apply for 5G-RG
connecting via wireline access and FN-RG.
\- The PCF provides the UE access selection and PDU session selection policy
control as described in this Annex.
#### B.2.1.3.2 NF Service Consumers
The NF service consumer functionality shall apply as defined in clause 4.1.3.2
with the differences described in this Annex.
# B.3 Service Operations
## B.3.1 Introduction
Clause 4.2.1 is applied with the following differences:
\- UE is replaced by the 5G-RG or or FN-RG.
\- Update of an UE Policy Association for the case that the AMF is relocated
due to the UE mobility and the old PCF is selected is not applicable when the
5G-RG or FN-RG connects the 5GC via wireline access.
\- Roaming scenario is not applicable when the 5G-RG or FN-RG connects the 5GC
via wireline access in this release of specification.
## B.3.2 Npcf_UEPolicyControl_Create Service Operation
### B.3.2.1 General
Clause 4.2.2.1 is applied with the following differences:
\- UE is replaced by the 5G-RG or FN-RG.
\- The PEI that may be included within the \"pei\" attribute shall have one of
the following representations:
i. If the 5G-BRG supports only wireline access, the PEI shall be the 5G-BRG
MAC address.
ii. If the 5G-CRG supports only wireline access, the PEI shall be the cable
modem MAC address.
iii. If the 5G-RG supports at least one 3GPP access technology, the PEI shall
be the allocated IMEI or IMEISV.
iv. For the FN-BRG and FN-CRG, the PEI shall be the FN-RG MAC address.
NOTE: When the PEI includes an indication that the MAC address cannot be used
as Equipment identifier of the of the FN-RG, the PEI cannot be trusted for
regulatory purposes and cannot be used for equipment based policy evaluation.
\- When the 5G-BRG or FN-BRG connects the 5GC via W-5GBAN, the
\"n3gaLocation\" attribute shall be included in the \"ueLoc\" attribute and:
\- the Global Line Identifier shall be included in the \"gli\" attribute; and
\- the \"w5gbanLineType\" attribute to indicate whether the W-5GBAN access is
DSL or PON may be included.
\- The HFC Node Identifier is encoded in the \"hfcNodeId\" attribute of the
\"n3gaLocation\" attribute included in the \"userLoc\" attribute within the
PolicyAssociationRequest data structure when the 5G-CRG or FN-CRG connects to
the 5GC via W-5GCAN.
\- Roaming scenario is not applicable when the 5G-RG or FN-RG connects the 5GC
via wireline access in this release of specification.
\- The PCF should neither include NSWO indication nor any ANDSP policies in
the UE Policy.
## B.3.3 Npcf_UEPolicyControl_Update Service Operation
### B.3.3.1 General
Clause 4.2.3.1 is applied with the following differences:
\- UE is replaced by the 5G-RG or FN-RG.
\- Roaming scenario is not applicable when the 5G-RG or FN-RG connects the 5GC
via wireline access in this release of specification.
\- The PCF should neither include NSWO indication nor any ANDSP policies in
the UE Policy.
## B.3.4 Npcf_UEPolicyControl_UpdateNotify Service
### B.3.4.1 General
Clause 4.2.4.1 is applied with the following differences:
\- UE is replaced by the 5G-RG or FN-RG.
\- Roaming scenario is not applicable when the 5G-RG or FN-RG connects the 5GC
via wireline access in this release of specification.
\- The PCF should neither include NSWO indication nor any ANDSP policies in
the UE Policy.
## B.3.5 Npcf_UEPolicyControl_Delete Service Operation
### B.3.5.1 General
Clause 4.2.5.1 is applied with the following differences:
\- UE is replaced by the 5G-RG or FN-RG.
\- Roaming scenario is not applicable when the 5G-RG or FN-RG connects the 5GC
via wireline access in this release of specification.
###### ## Annex C (informative): Withdrawn API versions
This Annex list withdrawn API versions of the Npcf_UEPolicyControl API defined
in the present specification. 3GPP TS 3GPP TS 29.501 [6] clause 4.3.1.6
describes the withdrawal of API versions.
The API versions listed in table B-1 are withdrawn for the
Npcf_UEPolicyControl API.
Table B-1: Withdrawn API versions of the Npcf_UEPolicyControl service
+--------------------+------------------------------------------------+ | API version number | Remarks | +--------------------+------------------------------------------------+ | 1.0.0 | Deficits in: | | | | | | - SUPI not mandatory (Unnecessary support of | | | Emergency registration). | | | | | | - Missing AMF instance id in Policy | | | Association request | +--------------------+------------------------------------------------+
#